From jukka.rahkonen at mmmtike.fi  Sun Nov  2 03:16:15 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Sun, 2 Nov 2014 11:16:15 +0000 (UTC)
Subject: [gdal-dev] Import gpx files into Postgis db (windows)?
References: <1414777402227-5170662.post@n6.nabble.com>
Message-ID: <loom.20141102T121030-901@post.gmane.org>

dandrigo <lcelati <at> latitude-geosystems.com> writes:

> 
> Dear all, 
> 
> I'm working with windows 8 & postgis 2.1. 
> 
> I have several gps (gpx) files. I would like to import directly those gpx
> files into my postgis database. 
> 
> What would be the easiest way? (ogr provided by OGR?)
> 
> In advance, thank you to throw light for me. 

The easiest way to import one gpx file is to use ogr2ogr

ogr2ogr -f PostgreSQL PG:"dbname='db' host='localhost' port='5432'
user='user' password='passwd'" gpx_file.gpx

You must read documentation about ogr2ogr utility and GDAL PostgreSQL and
GPX drivers for learning how to control which layer from GPX files are
imported, name the target tables, and append more data to existing tables.

-Jukka Rahkonen-







From robert.coup at koordinates.com  Sun Nov  2 15:38:09 2014
From: robert.coup at koordinates.com (Robert Coup)
Date: Mon, 3 Nov 2014 12:38:09 +1300
Subject: [gdal-dev] Improving usage of GDAL in Mapnik
In-Reply-To: <201410310101.45521.even.rouault@spatialys.com>
References: <CAFLLRpKs159=46JtAa-CQs_eEXS_DaCf0+QZRayRi=TN0eAsuA@mail.gmail.com>
	<201410310101.45521.even.rouault@spatialys.com>
Message-ID: <CAFLLRpKAzjxnLW-oJHOK=GGLy81j2xZhq+6KNUUG9oUN8B4Y9A@mail.gmail.com>

Hi Even,

On Fri, Oct 31, 2014 at 1:01 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> > * Favouring dataset.RasterIO() over band.RasterIO() to prevent up to 4x
> > raster reads
>
> If the size of the image (or your requested window) is below the GDAL block
> cache maximum size (default is 40 MB), then most drivers should cache the
> data
> for other bands when reading one band (particularly if decompression is
> involved), if the storage on disk is pixel interleaved (i.e
> R1,G1,B1,R2,G2,B2,
> etc...), which is generally the case for GeoTIFF. So reading in one call
> or 4
> calls will probably not make a lot of difference.
>

Good, that's what I suspected.


> But if you know that you have to read the 4 bands, there's no reason not to
> use dataset.RasterIO() in all situations. GDAL, either in its generic
> implementation or in the driver specific one, will look at the declared
> interleaving and will/should select the most appropriate reading strategy,
> ie.
> potentially operating block by block if the data is pixel interleaved, or
> band
> by band otherwise.
>

Okay, thanks.


>
> > * Use of GetBlockSize() to read on block boundaries, then cropping data
> > later.
>
> I've not looked closely at the code you point to, but that depends on what
> you
> do. If you have allocated a big buffer to contain the whole requested
> window,
> then just issue a single RasterIO() and let GDAL do its job to filling it
> the
> best way.
> If you just allocate small chunks of memory and process chunk by chunk,
> then
> it is indeed better to call RasterIO() on the block boundaries (or
> multiple of
> block boundaries).
>

In this case it's the former, so I guess GetBlockSize isn't relevant.


>
> > * Use GetMaskBand()/GetMaskFlags() to simplify nodata/alpha handling
> > (probably won't impact performance but might get rid of a bunch of code)
>
> Yes that can be convenient to avoid having to deal both with nodata and
> alpha
> band in a unified way. Plus some formats can really have a mask band that
> is
> neither of the two. For example you can create a JPEG-compressed YCbCr TIFF
> and use an internal mask band to encode transparency (although this is
> admitedly quite an exotic TIFF formulation because most readers will ignore
> the transparency mask)
>

That's what I thought (currently I use VRTs to re-alpha-ize mask bands if
necessary)


Thanks for your guidance,

Rob :)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141103/6dc13fbc/attachment.html>

From cavallini at faunalia.it  Sun Nov  2 23:46:15 2014
From: cavallini at faunalia.it (Paolo Cavallini)
Date: Mon, 03 Nov 2014 08:46:15 +0100
Subject: [gdal-dev] Sample script idea: gdal_srsguess
In-Reply-To: <080B6132-569E-4E72-B252-5D24DF5A2CC1@z-pulley.com>
References: <080B6132-569E-4E72-B252-5D24DF5A2CC1@z-pulley.com>
Message-ID: <545732C7.4050605@faunalia.it>

Il 31/10/2014 17:54, Aaron Racicot ha scritto:
> We played with something just like this last year (called projfinder):
> 
> http://projfinder.com/
> 
> That is just a simple demo application that was a proof of concept.  Center the map where you think your data is from, enter in a sample X,Y from your dataset and it tries to guess what projection your data is in.  Nothing fancy like parsing arbitrary file formats etc? just simple X,Y from your data.
> 
> I gave a presentation on it at FOSS4G-NA 2013 (you can reference it here):
> 
> http://reprojected.com/blog/2013/05/28/foss4g-na-2013-was-a-home-run/
> 
> If you are interested in the code I can point you to it.  In the end it is basically a simple web-service built around a PostGIS SQL query that does the distance calculations to percolate up likely projections against the EPSG database.

Thanks Aaron for this. IMHO an even better option would be to explicitly add to
EPSG/proj.4 db the bounding boxes of validity for each projection: in this way,
client GIS could show only valid projections for a given map area, and this would be
a major usability improvement for all.
All the best.

-- 
Paolo Cavallini - www.faunalia.eu
Corsi QGIS e PostGIS: http://www.faunalia.eu/training.html

From jukka.rahkonen at mmmtike.fi  Mon Nov  3 03:10:17 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Mon, 3 Nov 2014 11:10:17 +0000 (UTC)
Subject: [gdal-dev] =?utf-8?q?Sample_script_idea=3A_gdal=5Fsrsguess?=
References: <080B6132-569E-4E72-B252-5D24DF5A2CC1@z-pulley.com>
Message-ID: <loom.20141103T120336-693@post.gmane.org>

Aaron Racicot <aaronr <at> z-pulley.com> writes:

> 
> We played with something just like this last year (called projfinder):
> 
> http://projfinder.com/
> 
> That is just a simple demo application that was a proof of concept. 
Center the map where you think your data is
> from, enter in a sample X,Y from your dataset and it tries to guess what
projection your data is in.  Nothing
> fancy like parsing arbitrary file formats etc? just simple X,Y from your data.
> 
> I gave a presentation on it at FOSS4G-NA 2013 (you can reference it here):
> 
> http://reprojected.com/blog/2013/05/28/foss4g-na-2013-was-a-home-run/
> 
> If you are interested in the code I can point you to it.  In the end it is
basically a simple web-service built
> around a PostGIS SQL query that does the distance calculations to
percolate up likely projections
> against the EPSG database.
> 
> Aaron
> 

Thanks Aaron,

I can't do anything with code but this service would deserve publicity or if
it is just a proof of concept, spatialreference.org could have a new tab for
projfinder http://spatialreference.org/.

-Jukka-



From andre+joost at nurfuerspam.de  Mon Nov  3 08:02:54 2014
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Mon, 03 Nov 2014 17:02:54 +0100
Subject: [gdal-dev] Sample script idea: gdal_srsguess
In-Reply-To: <545732C7.4050605@faunalia.it>
References: <080B6132-569E-4E72-B252-5D24DF5A2CC1@z-pulley.com>
	<545732C7.4050605@faunalia.it>
Message-ID: <m389g8$i06$2@ger.gmane.org>

Am 03.11.2014 um 08:46 schrieb Paolo Cavallini:


>
> Thanks Aaron for this. IMHO an even better option would be to
> explicitly add to EPSG/proj.4 db the bounding boxes of validity for
> each projection: in this way, client GIS could show only valid
> projections for a given map area, and this would be a major usability
> improvement for all.

The "AREA_OF_USE_CODE" is already in /gdal-data/gdal_datum.csv.

The bounding boxes can be extracted from the EPSG database "Area" table 
as well.

Greetings,
Andr? Joost


From xenon at alphapixel.com  Mon Nov  3 08:15:58 2014
From: xenon at alphapixel.com (Chris Hanson)
Date: Mon, 3 Nov 2014 09:15:58 -0700
Subject: [gdal-dev] Compiling GDAL (and PROJ4) via Emscripten?
Message-ID: <CAGoufma5Hr3pW1N4FA+U-ytDhMVkgMs7dboV-mxjnTXyBKcSWw@mail.gmail.com>

  I'm wondering if anyone here has succeeded, attempted, or just
investigated compiling GDAL (and PROJ4) via Emscripten into Javascript
asm.js dialect to run in a browser? We're looking at some web/client side
code that would be best if it could do its job (data access and display)
client-side in a browser, and GDAL and Emscripten seem to be the likely
best way to accomplish it.

  I'd rather not reinvent the wheel if anyone has already tried this.

-- 
Chris 'Xenon' Hanson, omo sanza lettere. Xenon at AlphaPixel.com
http://www.alphapixel.com/
Training ? Consulting ? Contracting
3D ? Scene Graphs (Open Scene Graph/OSG) ? OpenGL 2 ? OpenGL 3 ? OpenGL 4 ?
GLSL ? OpenGL ES 1 ? OpenGL ES 2 ? OpenCL
Digital Imaging ? GIS ? GPS ? osgEarth ? Terrain ? Telemetry ? Cryptography
? Digital Audio ? LIDAR ? Kinect ? Embedded ? Mobile ? iPhone/iPad/iOS ?
Android
@alphapixel <https://twitter.com/alphapixel> facebook.com/alphapixel (775)
623-PIXL [7495]
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141103/d05e2e1a/attachment.html>

From mohammedrashadkm at gmail.com  Mon Nov  3 08:57:18 2014
From: mohammedrashadkm at gmail.com (Rashad M)
Date: Mon, 3 Nov 2014 22:27:18 +0530
Subject: [gdal-dev] Compiling GDAL (and PROJ4) via Emscripten?
In-Reply-To: <CAGoufma5Hr3pW1N4FA+U-ytDhMVkgMs7dboV-mxjnTXyBKcSWw@mail.gmail.com>
References: <CAGoufma5Hr3pW1N4FA+U-ytDhMVkgMs7dboV-mxjnTXyBKcSWw@mail.gmail.com>
Message-ID: <CANNqv9dOZt8X1opRfn=bm0fPhFLRw5yWsw1khZq0RezJCxB1hw@mail.gmail.com>

Hello Chris,

On Mon, Nov 3, 2014 at 9:45 PM, Chris Hanson <xenon at alphapixel.com> wrote:

>   I'm wondering if anyone here has succeeded, attempted, or just
> investigated compiling GDAL (and PROJ4) via Emscripten into Javascript
> asm.js dialect to run in a browser? We're looking at some web/client side
> code that would be best if it could do its job (data access and display)
> client-side in a browser, and GDAL and Emscripten seem to be the likely
> best way to accomplish it.
>

Not the same way. But we did similar thing using (Wt webtoolkit) and GDAL.
Using Wt, we were able to code in c++ and link with GDAL without any help
from bindings.  Wt also supports javascript and uses jquery heavily.

The code which we is under Apache license is out dated. I had made lots of
changes in the internal version. This includes rendering, styling, and
making an reusable API.

The plan is to release new code under open source soon as soon as I get
approval from my lab.(professor in CC'ed. Please feel free to discuss).

I can provide you a demo video of new version of lsiviewer -
https://www.youtube.com/watch?v=v7jtsJXPhXU
Here is a temporary live link if you would like to try it. -
http://lsi.iiit.ac.in:8080/
This shows a shapefile(GDAL through Wt) rendered(HTML5) on top of OSM tiles


>   I'd rather not reinvent the wheel if anyone has already tried this.
>
> --
> Chris 'Xenon' Hanson, omo sanza lettere. Xenon at AlphaPixel.com
> http://www.alphapixel.com/
> Training ? Consulting ? Contracting
> 3D ? Scene Graphs (Open Scene Graph/OSG) ? OpenGL 2 ? OpenGL 3 ? OpenGL 4
> ? GLSL ? OpenGL ES 1 ? OpenGL ES 2 ? OpenCL
> Digital Imaging ? GIS ? GPS ? osgEarth ? Terrain ? Telemetry ?
> Cryptography ? Digital Audio ? LIDAR ? Kinect ? Embedded ? Mobile ?
> iPhone/iPad/iOS ? Android
> @alphapixel <https://twitter.com/alphapixel> facebook.com/alphapixel (775)
> 623-PIXL [7495]
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
Regards,
   Rashad
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141103/ad729f37/attachment-0001.html>

From cavallini at faunalia.it  Mon Nov  3 10:09:26 2014
From: cavallini at faunalia.it (Paolo Cavallini)
Date: Mon, 03 Nov 2014 19:09:26 +0100
Subject: [gdal-dev] Sample script idea: gdal_srsguess
In-Reply-To: <m389g8$i06$2@ger.gmane.org>
References: <080B6132-569E-4E72-B252-5D24DF5A2CC1@z-pulley.com>	<545732C7.4050605@faunalia.it>
	<m389g8$i06$2@ger.gmane.org>
Message-ID: <5457C4D6.4040704@faunalia.it>

Il 03/11/2014 17:02, Andre Joost ha scritto:

> The "AREA_OF_USE_CODE" is already in /gdal-data/gdal_datum.csv.
> 
> The bounding boxes can be extracted from the EPSG database "Area" table as well.

That's great news, thanks.
All the best.

-- 
Paolo Cavallini - www.faunalia.eu
Corsi QGIS e PostGIS: http://www.faunalia.eu/training.html

From aaronr at z-pulley.com  Mon Nov  3 10:34:04 2014
From: aaronr at z-pulley.com (Aaron Racicot)
Date: Mon, 3 Nov 2014 10:34:04 -0800
Subject: [gdal-dev] Sample script idea: gdal_srsguess
In-Reply-To: <545732C7.4050605@faunalia.it>
References: <080B6132-569E-4E72-B252-5D24DF5A2CC1@z-pulley.com>
	<545732C7.4050605@faunalia.it>
Message-ID: <1352752C-4EB8-4C28-B4F8-4123C5C57E6F@z-pulley.com>

The bounding boxes (from EPSG) are in our database (at projfinder) and the SQL query checks the map center point against those boxes to then only do the distance calculation against those valid candidates.

A


On Nov 2, 2014, at 11:46 PM, Paolo Cavallini <cavallini at faunalia.it> wrote:

> Il 31/10/2014 17:54, Aaron Racicot ha scritto:
>> We played with something just like this last year (called projfinder):
>> 
>> http://projfinder.com/
>> 
>> That is just a simple demo application that was a proof of concept.  Center the map where you think your data is from, enter in a sample X,Y from your dataset and it tries to guess what projection your data is in.  Nothing fancy like parsing arbitrary file formats etc? just simple X,Y from your data.
>> 
>> I gave a presentation on it at FOSS4G-NA 2013 (you can reference it here):
>> 
>> http://reprojected.com/blog/2013/05/28/foss4g-na-2013-was-a-home-run/
>> 
>> If you are interested in the code I can point you to it.  In the end it is basically a simple web-service built around a PostGIS SQL query that does the distance calculations to percolate up likely projections against the EPSG database.
> 
> Thanks Aaron for this. IMHO an even better option would be to explicitly add to
> EPSG/proj.4 db the bounding boxes of validity for each projection: in this way,
> client GIS could show only valid projections for a given map area, and this would be
> a major usability improvement for all.
> All the best.
> 
> -- 
> Paolo Cavallini - www.faunalia.eu
> Corsi QGIS e PostGIS: http://www.faunalia.eu/training.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Aaron Racicot
Z-Pulley Inc.
aaronr at z-pulley.com
360-221-2441

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141103/51fd1c6b/attachment.html>

From guillaume.allee at gmail.com  Mon Nov  3 14:07:46 2014
From: guillaume.allee at gmail.com (Guillaume ALLEE)
Date: Mon, 3 Nov 2014 23:07:46 +0100
Subject: [gdal-dev] [Elasticsearch driver] Map coordinates from geo_point to
	geo_shape
Message-ID: <CABEdK7xd3e8O+qf6AsJWtKHMUDgh_Hsg-vVNGLE3em2kpsKQ+g@mail.gmail.com>

Hello,

I am trying to map the coordinates from my shp files to geo_shape,
geo_point being the default

So the default mapping file is :

            "geometry": {
                "properties": {
                    "type": {
                        "store": "yes",
                        "type": "string"
                    },
                    "coordinates": {
                        "store": "yes",
                        "type": "geo_point"
                    }
                }
            }

And the update I have done is in the mapping is

            "geometry": {
                "properties": {
                    "type": {
                        "store": "yes",
                        "type": "string"
                    },
                    "coordinates": {
                        "store": "yes",
                        "type": "geo_shape",
                         "tree": "quadtree",
                        "precision": "1m"
                    }
                }
            }

My import is working with geopoint and I did check with ES API that my
updated mapping is OK.

However, when I run my import line ogr2ogr -progress --config
ES_OVERWRITE 1 --config ES_META ./map_geoshape.json -f "ElasticSearch"
http://localhost:9200/ my_shp.shp
I have lot of ERROR 1: HTTP error code : 400.

I have looked at the code and it seems that the driver is storing in
ES a point whatever geometry it receives input and that you cannot
change the mapping on that field.

By any chance has someone a patch to change the behaviour to store the
"real" geometry in ES :-D ?

BR,

Guillaume

From even.rouault at spatialys.com  Wed Nov  5 07:01:58 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 5 Nov 2014 16:01:58 +0100
Subject: [gdal-dev] Call for discussion on RFC 49: Curve geometries
Message-ID: <201411051601.58553.even.rouault@spatialys.com>

Hi,

This is a call for discussion on RFC 49: Curve geometries

http://trac.osgeo.org/gdal/wiki/rfc49_curve_geometries

Below the summary :
"""
The current geometry model in GDAL 1.X makes use of points, lines, polygons 
and aggregations of them (multipoints, multilines, multipolygons and geometry 
collections). It was modeled from the geometry class hierarchy of the
"OpenGIS Simple Feature Access Part 1 : Common Architecture" (in its 1.1.0 
version).

This RFC covers the addition of new geometry types that have been added in
ISO/IEC 13249 Part 3 Spatial (abreviated as ISO SQL/MM Part 3):
  * circular string: a circular arc, or a sequence of connected circular arcs,
    each of them describe by 3 points: the first point of the arc, an
    intermediate point and the final point
  * compound curve: a sequence of connected curves, either line strings or
    circular strings
  * curve polygon: polygon consisting of one outer ring, and zero or more
    inner ring. Each ring can be one of the curve implementations: line
    strings, circular strings, compound curves.
  * multicurve: a collection of curves (line strings, circular strings,
    compound curves)
  * multisurface: a collection of surfaces (polygons, curve polygons)

The scope of this RFC consists in :
  * adding the new geometry classes to the existing geometry class hierarchy,
    with the corresponding importer and exporter of WKT (Well Known Text) and
    WKB (Well Known Binary) encodings
  * adding methods to convert those curve geometries into their approximated
    linear version, and to do the reverse operation
  * upgrading some of the drivers that can support such geometries : GML (and
    indirectly NAS, WFS), PostGIS/PGDump, GeoPackage, SQLite, CSV, VRT.
"""

Have a good reading,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From pramsey at cleverelephant.ca  Wed Nov  5 09:40:38 2014
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Wed, 5 Nov 2014 09:40:38 -0800
Subject: [gdal-dev] Call for discussion on RFC 49: Curve geometries
In-Reply-To: <201411051601.58553.even.rouault@spatialys.com>
References: <201411051601.58553.even.rouault@spatialys.com>
Message-ID: <etPan.545a6116.643c9869.13feb@Butterfly.local>

My only concern/note here is with regard to the WKB type numbers for features with a Z. The RFC seems to say that the numbers for the curve types will be ISO numbers, while the numbers for the old SFS types will be the backwards compatible ones. This puts OGR into an ugly snaggletooth situation, where the WKB emitted is not really consistent. In some ways it?s worse than PostGIS??

I feel like the best bet is to be consistent, but provide two consistent modes

- ISO mode, using the ISO defined type numbers for *all* types/dimensionalities
- Backwards/OGC mode, using the old wkb25DBit mask for all types.

Of course, I could be wrong, maybe a snaggletooth is better, but it doesn?t pass the smell test for me

P.

--?
Paul Ramsey
http://cleverelephant.ca
http://postgis.net

On November 5, 2014 at 7:01:32 AM, Even Rouault (even.rouault at spatialys.com) wrote:

Hi,  

This is a call for discussion on RFC 49: Curve geometries  

http://trac.osgeo.org/gdal/wiki/rfc49_curve_geometries  

Below the summary :  
"""  
The current geometry model in GDAL 1.X makes use of points, lines, polygons  
and aggregations of them (multipoints, multilines, multipolygons and geometry  
collections). It was modeled from the geometry class hierarchy of the  
"OpenGIS Simple Feature Access Part 1 : Common Architecture" (in its 1.1.0  
version).  

This RFC covers the addition of new geometry types that have been added in  
ISO/IEC 13249 Part 3 Spatial (abreviated as ISO SQL/MM Part 3):  
* circular string: a circular arc, or a sequence of connected circular arcs,  
each of them describe by 3 points: the first point of the arc, an  
intermediate point and the final point  
* compound curve: a sequence of connected curves, either line strings or  
circular strings  
* curve polygon: polygon consisting of one outer ring, and zero or more  
inner ring. Each ring can be one of the curve implementations: line  
strings, circular strings, compound curves.  
* multicurve: a collection of curves (line strings, circular strings,  
compound curves)  
* multisurface: a collection of surfaces (polygons, curve polygons)  

The scope of this RFC consists in :  
* adding the new geometry classes to the existing geometry class hierarchy,  
with the corresponding importer and exporter of WKT (Well Known Text) and  
WKB (Well Known Binary) encodings  
* adding methods to convert those curve geometries into their approximated  
linear version, and to do the reverse operation  
* upgrading some of the drivers that can support such geometries : GML (and  
indirectly NAS, WFS), PostGIS/PGDump, GeoPackage, SQLite, CSV, VRT.  
"""  

Have a good reading,  

Even  

--  
Spatialys - Geospatial professional services  
http://www.spatialys.com  
_______________________________________________  
gdal-dev mailing list  
gdal-dev at lists.osgeo.org  
http://lists.osgeo.org/mailman/listinfo/gdal-dev  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141105/10113848/attachment.html>

From even.rouault at spatialys.com  Wed Nov  5 09:58:38 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 5 Nov 2014 18:58:38 +0100
Subject: [gdal-dev] Call for discussion on RFC 49: Curve geometries
In-Reply-To: <etPan.545a6116.643c9869.13feb@Butterfly.local>
References: <201411051601.58553.even.rouault@spatialys.com>
	<etPan.545a6116.643c9869.13feb@Butterfly.local>
Message-ID: <201411051858.38838.even.rouault@spatialys.com>

Paul,

Thanks for your remarks

> My only concern/note here is with regard to the WKB type numbers for
> features with a Z. The RFC seems to say that the numbers for the curve
> types will be ISO numbers, while the numbers for the old SFS types will be
> the backwards compatible ones. This puts OGR into an ugly snaggletooth
> situation, where the WKB emitted is not really consistent. In some ways
> it?s worse than PostGIS? 

The RFC text might be not clear enough. Actually this is just for the OGR 
enumeration. When emitting WKB with wbkIsoVariant, fully compliant ISO SQL/MM 
Part3 / SFA 1.2.1 is emitted. That's how I can be compatible with PostGIS 2 
WKB/EWKB.
Said otherwise, there's a decoupling between the values used in the OGR 
enumeration and what is emitted by exportToWkb()

> 
> I feel like the best bet is to be consistent, but provide two consistent
> modes
> 
> - ISO mode, using the ISO defined type numbers for *all*
> types/dimensionalities - Backwards/OGC mode, using the old wkb25DBit mask
> for all types.

- exportToWkb(wkbIsoVariant) emits compliant ISO SQL/MM Part3 / SFA 1.2.1 for 
all geometries
- exportToWkb(wkbVariantOldOgc) use the wkb25DBit for the "old" geometries, 
and ISO SQL/MM Part3 / SFA 1.2.1 for the new one. This is admitedly a bit odd. 
We could use the wkb25Dbit trick for the new geometries, but I didn't see the 
point. Although that wouldn't be a huge deal to continue using th wkb25DBit 
for them too. Would be perhaps clearer.
- exportToWkb(wkbVariantPostGIS1) uses the wkb25DBit for all geometry types, 
and uses PostGIS 1.X codes for CurvePolygon, MultiCurve and MultiSurface.

Even

> 
> -- 
> Paul Ramsey
> http://cleverelephant.ca
> http://postgis.net
> 
> On November 5, 2014 at 7:01:32 AM, Even Rouault
> (even.rouault at spatialys.com) wrote:
> 
> Hi,
> 
> This is a call for discussion on RFC 49: Curve geometries
> 
> http://trac.osgeo.org/gdal/wiki/rfc49_curve_geometries
> 
> Below the summary :
> """
> The current geometry model in GDAL 1.X makes use of points, lines, polygons
> and aggregations of them (multipoints, multilines, multipolygons and
> geometry collections). It was modeled from the geometry class hierarchy of
> the "OpenGIS Simple Feature Access Part 1 : Common Architecture" (in its
> 1.1.0 version).
> 
> This RFC covers the addition of new geometry types that have been added in
> ISO/IEC 13249 Part 3 Spatial (abreviated as ISO SQL/MM Part 3):
> * circular string: a circular arc, or a sequence of connected circular
> arcs, each of them describe by 3 points: the first point of the arc, an
> intermediate point and the final point
> * compound curve: a sequence of connected curves, either line strings or
> circular strings
> * curve polygon: polygon consisting of one outer ring, and zero or more
> inner ring. Each ring can be one of the curve implementations: line
> strings, circular strings, compound curves.
> * multicurve: a collection of curves (line strings, circular strings,
> compound curves)
> * multisurface: a collection of surfaces (polygons, curve polygons)
> 
> The scope of this RFC consists in :
> * adding the new geometry classes to the existing geometry class hierarchy,
> with the corresponding importer and exporter of WKT (Well Known Text) and
> WKB (Well Known Binary) encodings
> * adding methods to convert those curve geometries into their approximated
> linear version, and to do the reverse operation
> * upgrading some of the drivers that can support such geometries : GML (and
> indirectly NAS, WFS), PostGIS/PGDump, GeoPackage, SQLite, CSV, VRT.
> """
> 
> Have a good reading,
> 
> Even
> 
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From pramsey at cleverelephant.ca  Wed Nov  5 10:04:09 2014
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Wed, 5 Nov 2014 10:04:09 -0800
Subject: [gdal-dev] Call for discussion on RFC 49: Curve geometries
In-Reply-To: <201411051858.38838.even.rouault@spatialys.com>
References: <201411051601.58553.even.rouault@spatialys.com>
	<etPan.545a6116.643c9869.13feb@Butterfly.local>
	<201411051858.38838.even.rouault@spatialys.com>
Message-ID: <etPan.545a6699.79e2a9e3.13feb@Butterfly.local>

Super!

--?
Paul Ramsey
http://cleverelephant.ca
http://postgis.net

On November 5, 2014 at 9:57:44 AM, Even Rouault (even.rouault at spatialys.com) wrote:

Paul,  

Thanks for your remarks  

> My only concern/note here is with regard to the WKB type numbers for  
> features with a Z. The RFC seems to say that the numbers for the curve  
> types will be ISO numbers, while the numbers for the old SFS types will be  
> the backwards compatible ones. This puts OGR into an ugly snaggletooth  
> situation, where the WKB emitted is not really consistent. In some ways  
> it?s worse than PostGIS?  

The RFC text might be not clear enough. Actually this is just for the OGR  
enumeration. When emitting WKB with wbkIsoVariant, fully compliant ISO SQL/MM  
Part3 / SFA 1.2.1 is emitted. That's how I can be compatible with PostGIS 2  
WKB/EWKB.  
Said otherwise, there's a decoupling between the values used in the OGR  
enumeration and what is emitted by exportToWkb()  

>  
> I feel like the best bet is to be consistent, but provide two consistent  
> modes  
>  
> - ISO mode, using the ISO defined type numbers for *all*  
> types/dimensionalities - Backwards/OGC mode, using the old wkb25DBit mask  
> for all types.  

- exportToWkb(wkbIsoVariant) emits compliant ISO SQL/MM Part3 / SFA 1.2.1 for  
all geometries  
- exportToWkb(wkbVariantOldOgc) use the wkb25DBit for the "old" geometries,  
and ISO SQL/MM Part3 / SFA 1.2.1 for the new one. This is admitedly a bit odd.  
We could use the wkb25Dbit trick for the new geometries, but I didn't see the  
point. Although that wouldn't be a huge deal to continue using th wkb25DBit  
for them too. Would be perhaps clearer.  
- exportToWkb(wkbVariantPostGIS1) uses the wkb25DBit for all geometry types,  
and uses PostGIS 1.X codes for CurvePolygon, MultiCurve and MultiSurface.  

Even  

>  
> --  
> Paul Ramsey  
> http://cleverelephant.ca  
> http://postgis.net  
>  
> On November 5, 2014 at 7:01:32 AM, Even Rouault  
> (even.rouault at spatialys.com) wrote:  
>  
> Hi,  
>  
> This is a call for discussion on RFC 49: Curve geometries  
>  
> http://trac.osgeo.org/gdal/wiki/rfc49_curve_geometries  
>  
> Below the summary :  
> """  
> The current geometry model in GDAL 1.X makes use of points, lines, polygons  
> and aggregations of them (multipoints, multilines, multipolygons and  
> geometry collections). It was modeled from the geometry class hierarchy of  
> the "OpenGIS Simple Feature Access Part 1 : Common Architecture" (in its  
> 1.1.0 version).  
>  
> This RFC covers the addition of new geometry types that have been added in  
> ISO/IEC 13249 Part 3 Spatial (abreviated as ISO SQL/MM Part 3):  
> * circular string: a circular arc, or a sequence of connected circular  
> arcs, each of them describe by 3 points: the first point of the arc, an  
> intermediate point and the final point  
> * compound curve: a sequence of connected curves, either line strings or  
> circular strings  
> * curve polygon: polygon consisting of one outer ring, and zero or more  
> inner ring. Each ring can be one of the curve implementations: line  
> strings, circular strings, compound curves.  
> * multicurve: a collection of curves (line strings, circular strings,  
> compound curves)  
> * multisurface: a collection of surfaces (polygons, curve polygons)  
>  
> The scope of this RFC consists in :  
> * adding the new geometry classes to the existing geometry class hierarchy,  
> with the corresponding importer and exporter of WKT (Well Known Text) and  
> WKB (Well Known Binary) encodings  
> * adding methods to convert those curve geometries into their approximated  
> linear version, and to do the reverse operation  
> * upgrading some of the drivers that can support such geometries : GML (and  
> indirectly NAS, WFS), PostGIS/PGDump, GeoPackage, SQLite, CSV, VRT.  
> """  
>  
> Have a good reading,  
>  
> Even  
>  
> --  
> Spatialys - Geospatial professional services  
> http://www.spatialys.com  
> _______________________________________________  
> gdal-dev mailing list  
> gdal-dev at lists.osgeo.org  
> http://lists.osgeo.org/mailman/listinfo/gdal-dev  

--  
Spatialys - Geospatial professional services  
http://www.spatialys.com  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141105/19a7e409/attachment-0001.html>

From jmckenna at gatewaygeomatics.com  Thu Nov  6 07:35:18 2014
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Thu, 06 Nov 2014 11:35:18 -0400
Subject: [gdal-dev] OSM driver with z_order values
Message-ID: <545B9536.8010106@gatewaygeomatics.com>

Hi all,

I've successfully used the OSM driver[1] to convert from the OSM pbf 
binary format into another (in my case Postgres/PostGIS, and testing 
with Japan dataset).  The time to do this is much much faster than other 
tools such as osm2pgsql (once I learned the "PG_USE_COPY YES" parameter 
the time went from more than 3 hours down to minutes).

That is the good news.  The bad news is that I am stuck now because the 
OSM driver does not set z_order (rendering order) values, which are 
important for display in MapServer (and Mapnik etc.).  Tools like 
osm2pgsql and imposm do set those values[2].

Now I realize that I could go through the osm2pgsql/imposm code and set 
those myself manually somehow, once I figure out the exact logic used by 
those tools, but, I am wondering if this could be added to the OGR/OSM 
driver itself, as it is so useful for many mapping projects (?).

Call this a wishlist email then, but I just thought I'd file the request :)

-jeff


[1] http://www.gdal.org/drv_osm.html
[2] https://github.com/omniscale/imposm/blob/master/imposm/mapping.py#L684



-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/






From jemabingham at gmail.com  Thu Nov  6 08:34:02 2014
From: jemabingham at gmail.com (Jema)
Date: Thu, 6 Nov 2014 08:34:02 -0800 (PST)
Subject: [gdal-dev] Can GDAL Access Raster File Stored as Blob in SQLite3
	Database?
Message-ID: <CANcXNv3SV3CFQCstK+L-srwKEZdsYaDHjSMUiDPhyf3bTxUtOw@mail.gmail.com>

Hello all,

After evaluating the Rasterlite driver and database, I've found it to be
able to support everything I need except store projections for multiple
rasters.  I've seen hints of a Rasterlite2 driver in the works, but as of
yet it's not available.  I would prefer to stick with sqlite3 rather than a
more complex solution using PostGIS or another server database.  The
rasters I'm working with are sized a few megabytes and order in the hundred
of thousands to millions.  In the meantime, I've stored each raster file
(tiff format) as a blob in a table, which can be efficiently queried and
accessed.  Now to my question:  is there a way to pass the sqlite3 handle
to GDAL to read a given band and block from the data?  Also, if there is an
easier solution, please tell me.

I'm using a recent build of GDAL C# bindings on Windows 7.

Thanks.




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Can-GDAL-Access-Raster-File-Stored-as-Blob-in-SQLite3-Database-tp5171697.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141106/96bf13b2/attachment.html>

From even.rouault at spatialys.com  Thu Nov  6 08:41:12 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 6 Nov 2014 17:41:12 +0100
Subject: [gdal-dev] Can GDAL Access Raster File Stored as Blob in
	SQLite3 Database?
In-Reply-To: <CANcXNv3SV3CFQCstK+L-srwKEZdsYaDHjSMUiDPhyf3bTxUtOw@mail.gmail.com>
References: <CANcXNv3SV3CFQCstK+L-srwKEZdsYaDHjSMUiDPhyf3bTxUtOw@mail.gmail.com>
Message-ID: <201411061741.12514.even.rouault@spatialys.com>

Le jeudi 06 novembre 2014 17:34:02, Jema a ?crit :
> Hello all,
> 
> After evaluating the Rasterlite driver and database, I've found it to be
> able to support everything I need except store projections for multiple
> rasters.  I've seen hints of a Rasterlite2 driver in the works, but as of
> yet it's not available.  I would prefer to stick with sqlite3 rather than a
> more complex solution using PostGIS or another server database.  The
> rasters I'm working with are sized a few megabytes and order in the hundred
> of thousands to millions.  In the meantime, I've stored each raster file
> (tiff format) as a blob in a table, which can be efficiently queried and
> accessed.  Now to my question:  is there a way to pass the sqlite3 handle
> to GDAL to read a given band and block from the data?  Also, if there is an
> easier solution, please tell me.

Jema,

If you get the blob yourself from C# with the sqlite C# API (assuming that 
exists), then you can use gdal.FileFromMemBuffer('/vsimem/bla.tif', the_blob) 
to create a virtual file in memory and gdal.Open('/vsimem/bla.tif'). At least 
that's how to do it in Python. Not sure if the C# bindings have the typemap 
necessary for FileFromMemBuffer() to work.

Even

> 
> I'm using a recent build of GDAL C# bindings on Windows 7.
> 
> Thanks.
> 
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/Can-GDAL-Access-Raster-File-Stored-as-
> Blob-in-SQLite3-Database-tp5171697.html Sent from the GDAL - Dev mailing
> list archive at Nabble.com.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jemabingham at gmail.com  Thu Nov  6 08:53:37 2014
From: jemabingham at gmail.com (Jema Bingham)
Date: Thu, 6 Nov 2014 09:53:37 -0700
Subject: [gdal-dev] Can GDAL Access Raster File Stored as Blob in
	SQLite3 Database?
In-Reply-To: <201411061741.12514.even.rouault@spatialys.com>
References: <CANcXNv3SV3CFQCstK+L-srwKEZdsYaDHjSMUiDPhyf3bTxUtOw@mail.gmail.com>
	<201411061741.12514.even.rouault@spatialys.com>
Message-ID: <CANcXNv21ARBp0xsEn=nXjcCz8WU_js0WzFYTrfcPF+uWURfpYA@mail.gmail.com>

Even,

I can load the file to memory and then create a virtual file via C#.
However, that is expensive to do for many rasters if the data I need is for
a handful of pixels or even a single pixel per image.  Is there a way to
link to the object on disk?

Thanks for that quick reply.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141106/0139c092/attachment.html>

From even.rouault at spatialys.com  Thu Nov  6 09:05:11 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 6 Nov 2014 18:05:11 +0100
Subject: [gdal-dev] Can GDAL Access Raster File Stored as Blob in
	SQLite3 Database?
In-Reply-To: <CANcXNv21ARBp0xsEn=nXjcCz8WU_js0WzFYTrfcPF+uWURfpYA@mail.gmail.com>
References: <CANcXNv3SV3CFQCstK+L-srwKEZdsYaDHjSMUiDPhyf3bTxUtOw@mail.gmail.com>
	<201411061741.12514.even.rouault@spatialys.com>
	<CANcXNv21ARBp0xsEn=nXjcCz8WU_js0WzFYTrfcPF+uWURfpYA@mail.gmail.com>
Message-ID: <201411061805.12002.even.rouault@spatialys.com>

Le jeudi 06 novembre 2014 17:53:37, Jema Bingham a ?crit :
> Even,
> 
> I can load the file to memory and then create a virtual file via C#.
> However, that is expensive to do for many rasters if the data I need is for
> a handful of pixels or even a single pixel per image.  Is there a way to
> link to the object on disk?

You would have to figure out the offset in the sqlite file, but that would assume 
that a blob is strictly contiguous. I'm not sure if sqlite offers such 
guarantee, and I'm afraid there's no way to know at which offset the blob is 
stored.
The only alternative is to tile your raster into reasonably small tiles (say 
256x256 pixels) so that fetching a blob is fast. That's basically what 
Rasterlite does.

I didn't react to your initial statement that Rasterlite cannot store different 
projections for each raster table, but I'm surprised that would be the case. 
And the below experiment actually would confirm that you can store different 
projections

$ gdal_translate foo.tif rasterlite:foo.sqlite,table=foo -a_srs EPSG:3857 -of 
rasterlite

$ gdal_translate foo.tif rasterlite:foo.sqlite,table=foo2 -a_srs EPSG:32631 -
of rasterlite

$ gdalinfo rasterlite:foo.sqlite,table=foo

Coordinate System is:
PROJCS["WGS 84 / Pseudo-Mercator",
    GEOGCS["WGS 84",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.257223563,
                AUTHORITY["EPSG","7030"]],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0,
            AUTHORITY["EPSG","8901"]],
        UNIT["degree",0.0174532925199433,
            AUTHORITY["EPSG","9122"]],
        AUTHORITY["EPSG","4326"]],
    PROJECTION["Mercator_1SP"],
    PARAMETER["central_meridian",0],
    PARAMETER["scale_factor",1],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AXIS["X",EAST],
    AXIS["Y",NORTH],
    EXTENSION["PROJ4","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 
+x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs"],
    AUTHORITY["EPSG","3857"]]


$ gdalinfo rasterlite:foo.sqlite,table=foo2

Coordinate System is:
PROJCS["WGS 84 / UTM zone 31N",
    GEOGCS["WGS 84",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.257223563,
                AUTHORITY["EPSG","7030"]],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0,
            AUTHORITY["EPSG","8901"]],
        UNIT["degree",0.0174532925199433,
            AUTHORITY["EPSG","9122"]],
        AUTHORITY["EPSG","4326"]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",3],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AXIS["Easting",EAST],
    AXIS["Northing",NORTH],
    AUTHORITY["EPSG","32631"]]


> 
> Thanks for that quick reply.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jemabingham at gmail.com  Thu Nov  6 09:14:03 2014
From: jemabingham at gmail.com (Jema Bingham)
Date: Thu, 6 Nov 2014 10:14:03 -0700
Subject: [gdal-dev] Can GDAL Access Raster File Stored as Blob in
	SQLite3 Database?
In-Reply-To: <201411061805.12002.even.rouault@spatialys.com>
References: <CANcXNv3SV3CFQCstK+L-srwKEZdsYaDHjSMUiDPhyf3bTxUtOw@mail.gmail.com>
	<201411061741.12514.even.rouault@spatialys.com>
	<CANcXNv21ARBp0xsEn=nXjcCz8WU_js0WzFYTrfcPF+uWURfpYA@mail.gmail.com>
	<201411061805.12002.even.rouault@spatialys.com>
Message-ID: <CANcXNv2JTWx_OhRwiKhgOr_rmOuXYgsX5Kn2FieBeJAfD2t2ww@mail.gmail.com>

Ahah!  You have to add the raster table name then to the command.  The
Rasterlite documentation should be updated to reflect this example as it
now misleadingly does not.  See below...

Thank you much!
Examples:

   - Accessing a rasterlite DB with a single raster table :

   $ gdalinfo rasterlitedb.sqlite -noct

   Output:

   Driver: Rasterlite/Rasterlite
   Files: rasterlitedb.sqlite
   Size is 7200, 7200
   Coordinate System is:
   GEOGCS["WGS 84",
       DATUM["WGS_1984",
           SPHEROID["WGS 84",6378137,298.257223563,
               AUTHORITY["EPSG","7030"]],
           AUTHORITY["EPSG","6326"]],
       PRIMEM["Greenwich",0,
           AUTHORITY["EPSG","8901"]],
       UNIT["degree",0.01745329251994328,
           AUTHORITY["EPSG","9122"]],
       AUTHORITY["EPSG","4326"]]
   Origin = (-5.000000000000000,55.000000000000000)
   Pixel Size = (0.002083333333333,-0.002083333333333)
   Metadata:
     TILE_FORMAT=GIF
   Image Structure Metadata:
     INTERLEAVE=PIXEL
   Corner Coordinates:
   Upper Left  (  -5.0000000,  55.0000000) (  5d 0'0.00"W, 55d 0'0.00"N)
   Lower Left  (  -5.0000000,  40.0000000) (  5d 0'0.00"W, 40d 0'0.00"N)
   Upper Right (  10.0000000,  55.0000000) ( 10d 0'0.00"E, 55d 0'0.00"N)
   Lower Right (  10.0000000,  40.0000000) ( 10d 0'0.00"E, 40d 0'0.00"N)
   Center      (   2.5000000,  47.5000000) (  2d30'0.00"E, 47d30'0.00"N)
   Band 1 Block=480x480 Type=Byte, ColorInterp=Palette
     Color Table (RGB with 256 entries)


   - Listing a multi-raster table DB :

   $ gdalinfo multirasterdb.sqlite

   Output:

   Driver: Rasterlite/Rasterlite
   Files:
   Size is 512, 512
   Coordinate System is `'
   Subdatasets:
     SUBDATASET_1_NAME=RASTERLITE:multirasterdb.sqlite,table=raster1
     SUBDATASET_1_DESC=RASTERLITE:multirasterdb.sqlite,table=raster1
     SUBDATASET_2_NAME=RASTERLITE:multirasterdb.sqlite,table=raster2
     SUBDATASET_2_DESC=RASTERLITE:multirasterdb.sqlite,table=raster2
   Corner Coordinates:
   Upper Left  (    0.0,    0.0)
   Lower Left  (    0.0,  512.0)
   Upper Right (  512.0,    0.0)
   Lower Right (  512.0,  512.0)
   Center      (  256.0,  256.0)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141106/ded1ce59/attachment.html>

From jukka.rahkonen at mmmtike.fi  Thu Nov  6 14:48:08 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Thu, 6 Nov 2014 22:48:08 +0000 (UTC)
Subject: [gdal-dev] =?utf-8?q?OSM_driver_with_z=5Forder_values?=
References: <545B9536.8010106@gatewaygeomatics.com>
Message-ID: <loom.20141106T230823-240@post.gmane.org>

Jeff McKenna <jmckenna <at> gatewaygeomatics.com> writes:

> 
> Hi all,
> 
> I've successfully used the OSM driver[1] to convert from the OSM pbf 
> binary format into another (in my case Postgres/PostGIS, and testing 
> with Japan dataset).  The time to do this is much much faster than other 
> tools such as osm2pgsql (once I learned the "PG_USE_COPY YES" parameter 
> the time went from more than 3 hours down to minutes).
> 
> That is the good news.  The bad news is that I am stuck now because the 
> OSM driver does not set z_order (rendering order) values, which are 
> important for display in MapServer (and Mapnik etc.).  Tools like 
> osm2pgsql and imposm do set those values[2].
> 
> Now I realize that I could go through the osm2pgsql/imposm code and set 
> those myself manually somehow, once I figure out the exact logic used by 
> those tools, but, I am wondering if this could be added to the OGR/OSM 
> driver itself, as it is so useful for many mapping projects (?).
> 
> Call this a wishlist email then, but I just thought I'd file the request :)


Hi Jeff,

Imposm and osm2pgsql utilities are more or less made to one purpose that is
to generate database for rendering with more or less standard styles and
therefore they can have fixes rules for creating z_orders. I am not sure if
the GDAL OSM driver has such a strong same-for-all use case.

I would make a little test first:
- add column "z_order"
- create indexes for highway, tunnel, and bridge which is probably a good
idea anyway (consider also the other fields used in SELECTs during rendering
time)
- udpdate z_order by your rules with CASE...WHEN...THEN...ELSE it should be
one or a couple SQL statements and thus fast.
http://www.sqlite.org/lang_expr.html speaks about short-circuit which may
mean that the indexes above are not even needed for making populating
z_order faster but at rendering time they are anyway good to have
- create index for z_order


All the SQL post-process commands can be run with GDAL as well from a script
as ogrinfo commands with -sql parameter. If you still aim to something
better, create also simplified geometries for the most heavy geometries and
save them as additional geometry fields which saves space because there is
no need to copy the attributes. A few more lines of SQL will be needed for
creating spatial indexes and adding new geometries into geometry_columns.

Finally you just need to publish the rendering rules (mapfile I guess),
osmconf.ini and   post-process SQL all together and you should have an
easily deliverable package with optimized data access which you probably
would like to name as "MS4OSM". I volunteer to test the package. Actually I
have done some tests myself but been too lazy for putting everything
together into a single executable script.

-Jukka Rahkonen-



From jmckenna at gatewaygeomatics.com  Thu Nov  6 15:49:55 2014
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Thu, 06 Nov 2014 19:49:55 -0400
Subject: [gdal-dev] OSM driver with z_order values
In-Reply-To: <loom.20141106T230823-240@post.gmane.org>
References: <545B9536.8010106@gatewaygeomatics.com>
	<loom.20141106T230823-240@post.gmane.org>
Message-ID: <545C0923.3020309@gatewaygeomatics.com>

On 2014-11-06 6:48 PM, Jukka Rahkonen wrote:
>
>
> Hi Jeff,
>
> Imposm and osm2pgsql utilities are more or less made to one purpose that is
> to generate database for rendering with more or less standard styles and
> therefore they can have fixes rules for creating z_orders. I am not sure if
> the GDAL OSM driver has such a strong same-for-all use case.
>
> I would make a little test first:
> - add column "z_order"
> - create indexes for highway, tunnel, and bridge which is probably a good
> idea anyway (consider also the other fields used in SELECTs during rendering
> time)
> - udpdate z_order by your rules with CASE...WHEN...THEN...ELSE it should be
> one or a couple SQL statements and thus fast.
> http://www.sqlite.org/lang_expr.html speaks about short-circuit which may
> mean that the indexes above are not even needed for making populating
> z_order faster but at rendering time they are anyway good to have
> - create index for z_order
>
>
> All the SQL post-process commands can be run with GDAL as well from a script
> as ogrinfo commands with -sql parameter. If you still aim to something
> better, create also simplified geometries for the most heavy geometries and
> save them as additional geometry fields which saves space because there is
> no need to copy the attributes. A few more lines of SQL will be needed for
> creating spatial indexes and adding new geometries into geometry_columns.
>
> Finally you just need to publish the rendering rules (mapfile I guess),
> osmconf.ini and   post-process SQL all together and you should have an
> easily deliverable package with optimized data access which you probably
> would like to name as "MS4OSM". I volunteer to test the package. Actually I
> have done some tests myself but been too lazy for putting everything
> together into a single executable script.
>
> -Jukka Rahkonen-
>
>

Hi Jukka,

I think you are saying what I was thinking (but trying to avoid): 
modifying my osm2pgsql-to-imposm-schema.sql script[1] to something like 
"ogr-to-imposm-schema-script.sql".  I already started that but got stuck 
at the z_order calculation.  But before traveling down that path I 
thought I'd see if others were interested in having that calculation 
directly in the OSM driver, since it is so useful to many mapping 
projects.  It was just a thought.

I agree with your general plan, although I find it easier to just modify 
the existing schema script (once we figure out the logic used by 
osm2pgsql/imposm used for z_order).

[1] 
https://github.com/mapserver/basemaps/blob/master/contrib/osm2pgsql-to-imposm-schema.sql

-jeff


-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/






From vincent.mora at oslandia.com  Fri Nov  7 00:14:21 2014
From: vincent.mora at oslandia.com (Vincent Mora)
Date: Fri, 07 Nov 2014 09:14:21 +0100
Subject: [gdal-dev] how do I get the traits for Polygon_with_holes_2
Message-ID: <545C7F5D.1000201@oslandia.com>

Hi,

I need to call are_holes_and_boundary_pairwise_disjoint(pwh, traits) to 
check an instance pwh of CGAL::Polygon_with_holes_2<Kernel>.

I can't figure out how to obtain the traits parameter. Can someone tell me ?

Thanks,

V.


template <class Traits_2>
bool are_holes_and_boundary_pairwise_disjoint
(const typename Traits_2::Polygon_with_holes_2& pwh, Traits_2& traits)
{
...
}



From even.rouault at spatialys.com  Fri Nov  7 00:49:45 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 7 Nov 2014 09:49:45 +0100
Subject: [gdal-dev] OSM driver with z_order values
In-Reply-To: <545B9536.8010106@gatewaygeomatics.com>
References: <545B9536.8010106@gatewaygeomatics.com>
Message-ID: <201411070949.45542.even.rouault@spatialys.com>

Jeff,

> 
> I've successfully used the OSM driver[1] to convert from the OSM pbf
> binary format into another (in my case Postgres/PostGIS, and testing
> with Japan dataset).  The time to do this is much much faster than other
> tools 

Mostly due to the optimized custom node indexing and the local temporary 
sqlite DB I think

> such as osm2pgsql (once I learned the "PG_USE_COPY YES" parameter
> the time went from more than 3 hours down to minutes).

This is now the default in trunk.

> 
> That is the good news.  The bad news is that I am stuck now because the
> OSM driver does not set z_order (rendering order) values, which are
> important for display in MapServer (and Mapnik etc.).  Tools like
> osm2pgsql and imposm do set those values[2].
> 
> Now I realize that I could go through the osm2pgsql/imposm code and set
> those myself manually somehow, once I figure out the exact logic used by
> those tools, but, I am wondering if this could be added to the OGR/OSM
> driver itself, as it is so useful for many mapping projects (?).
> 
> Call this a wishlist email then, but I just thought I'd file the request :)

That could be usefull I guess. The difficulty is to code that. Well, hard-coding 
that in the driver would not be too hard, but it wouldn't be pretty to put 
those empirical rules burried into C++ code (if new tags or tag values appear, 
etc..)

The osm2pgsql folks apparently have decided to code such parts in LUA : 
https://github.com/openstreetmap/osm2pgsql/blob/master/style.lua. Not sure we 
would want to link GDAL against the LUA interpreter. Although MapServer does 
JavaScript nowadays...
Actually digging more, I see they have also a C++ version probably used if LUA 
isn't available: 
https://github.com/openstreetmap/osm2pgsql/blob/master/tagtransform.cpp

The ideal would to find some syntax to do this in osmconf.ini. Actually, 
Jukka's mention of sqlite makes me think that the syntax could be SQL 
evaluated by SQLite.
Something like :

computed_fields = z_order
z_order_type = Integer
z_order_sql = "SELECT (CASE [highway] WHEN 'minor' THEN 3 WHEN 'road' THEN 3 
WHEN 'tertiary_link' THEN 4 ... ELSE 0) + (CASE WHEN [bridge] IS IN ('yes', 
'true', '1') THEN 10 ELSE 0 END) + (CASE WHEN [layer] IS NOT NULL THEN 10 * 
CAST([layer) AS INTEGER) ELSE 0 END) + ..."

And stuff in [] would be replaced by the corresponding field value.

That's something that could also potentially be done as the ogr2ogr level, 
since there's hardly anything driver specific in that, but finding the right U.I 
to specify per-layer computed fields isn't obvious.


Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From landa.martin at gmail.com  Fri Nov  7 02:00:00 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Fri, 7 Nov 2014 11:00:00 +0100
Subject: [gdal-dev] Call for discussion on RFC 49: Curve geometries
In-Reply-To: <201411051601.58553.even.rouault@spatialys.com>
References: <201411051601.58553.even.rouault@spatialys.com>
Message-ID: <CA+Ei1OcZ+uavJdice9iXiXAZSuqfPHoSOdHuFDRiEvAEEgEiuA@mail.gmail.com>

Hi Even,

2014-11-05 16:01 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:

> http://trac.osgeo.org/gdal/wiki/rfc49_curve_geometries

this is absolutely great news for me! I wanted to extended VFK driver
[1] to support circles and curves, so it nicely fits into my plan so I
am very interested to collaborate on this RFC!

Martin

[1] http://trac.osgeo.org/gdal/browser/trunk/gdal/ogr/ogrsf_frmts/vfk/vfkdatablocksqlite.cpp#L130

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.eu/mentors/landa

From jmckenna at gatewaygeomatics.com  Fri Nov  7 05:48:57 2014
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Fri, 07 Nov 2014 09:48:57 -0400
Subject: [gdal-dev] OSM driver with z_order values
In-Reply-To: <201411070949.45542.even.rouault@spatialys.com>
References: <545B9536.8010106@gatewaygeomatics.com>
	<201411070949.45542.even.rouault@spatialys.com>
Message-ID: <545CCDC9.1030109@gatewaygeomatics.com>

On 2014-11-07 4:49 AM, Even Rouault wrote:
>
> The ideal would to find some syntax to do this in osmconf.ini. Actually,
> Jukka's mention of sqlite makes me think that the syntax could be SQL
> evaluated by SQLite.
> Something like :
>
> computed_fields = z_order
> z_order_type = Integer
> z_order_sql = "SELECT (CASE [highway] WHEN 'minor' THEN 3 WHEN 'road' THEN 3
> WHEN 'tertiary_link' THEN 4 ... ELSE 0) + (CASE WHEN [bridge] IS IN ('yes',
> 'true', '1') THEN 10 ELSE 0 END) + (CASE WHEN [layer] IS NOT NULL THEN 10 *
> CAST([layer) AS INTEGER) ELSE 0 END) + ..."
>
> And stuff in [] would be replaced by the corresponding field value.
>
> That's something that could also potentially be done as the ogr2ogr level,
> since there's hardly anything driver specific in that, but finding the right U.I
> to specify per-layer computed fields isn't obvious.
>
>

I agree, it would be very cool to be able to configure the z_order field 
in osmconf.ini !!!! I'm not sure what else to add to this discussion, 
other than that I really want this :)

-jeff




-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/






From bobc at bluemarblegeo.com  Fri Nov  7 13:29:34 2014
From: bobc at bluemarblegeo.com (Bob Cave)
Date: Fri, 7 Nov 2014 13:29:34 -0800 (PST)
Subject: [gdal-dev] Arcinfo Binary Grid Format Specification
Message-ID: <1415395774188-5171954.post@n6.nabble.com>

Hello,

The description of the Arcinfo Binary Grid format on the GDAL web site links
to the format specification at the following URL:
http://home.gdal.org/projects/aigrid/index.html

Unfortunately, that address seems to be unreachable, and all of the web
search results I got linked back to the same URL.  Does anyone know a
current URL for that specification?

Thank you.

Cheers,

Bob




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Arcinfo-Binary-Grid-Format-Specification-tp5171954.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From pepijn at vaneeckhoudt.net  Fri Nov  7 14:13:28 2014
From: pepijn at vaneeckhoudt.net (Pepijn Van Eeckhoudt)
Date: Fri, 7 Nov 2014 23:13:28 +0100
Subject: [gdal-dev] Arcinfo Binary Grid Format Specification
In-Reply-To: <1415395774188-5171954.post@n6.nabble.com>
References: <1415395774188-5171954.post@n6.nabble.com>
Message-ID: <3D28BE35-EFB6-4758-BEBB-BE97CA12F0E4@vaneeckhoudt.net>

Internet archive to the rescue...
https://web.archive.org/web/20130625124859/http://home.gdal.org/projects/aigrid/index.html <https://web.archive.org/web/20130625124859/http://home.gdal.org/projects/aigrid/index.html>
https://web.archive.org/web/20121124091208/http://home.gdal.org/projects/aigrid/aigrid_format.html <https://web.archive.org/web/20121124091208/http://home.gdal.org/projects/aigrid/aigrid_format.html>

Pepijn

> On 07 Nov 2014, at 22:29, Bob Cave <bobc at bluemarblegeo.com> wrote:
> 
> Hello,
> 
> The description of the Arcinfo Binary Grid format on the GDAL web site links
> to the format specification at the following URL:
> http://home.gdal.org/projects/aigrid/index.html
> 
> Unfortunately, that address seems to be unreachable, and all of the web
> search results I got linked back to the same URL.  Does anyone know a
> current URL for that specification?
> 
> Thank you.
> 
> Cheers,
> 
> Bob
> 
> 
> 
> 
> --
> View this message in context: http://osgeo-org.1560.x6.nabble.com/Arcinfo-Binary-Grid-Format-Specification-tp5171954.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141107/ae8995e7/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4151 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141107/ae8995e7/attachment.bin>

From randre at gmail.com  Fri Nov  7 14:53:09 2014
From: randre at gmail.com (=?UTF-8?B?Um9nZXIgQW5kcsOp?=)
Date: Fri, 7 Nov 2014 14:53:09 -0800
Subject: [gdal-dev] What's up with the 8859 encoding?
Message-ID: <CAOL+ROEm=17mPG6Mgypuwi7LLTk3jxc3YT1Z=wapec7E32bF_g@mail.gmail.com>

Hello List,

I am very curious why after installing GDAL 1.11, I now need to use the
-lco ENCODING=UTF-8 option when using ogr2ogr on any of my already UTF-8
encoded shapefiles?  Failure to do so results in this error,

Warning 1: One or several characters couldn't be converted correctly from
UTF-8 to ISO-8859-1.

What gives?

Thanks,

Roger
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141107/7d79d506/attachment.html>

From even.rouault at spatialys.com  Fri Nov  7 15:00:56 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 8 Nov 2014 00:00:56 +0100
Subject: [gdal-dev] What's up with the 8859 encoding?
In-Reply-To: <CAOL+ROEm=17mPG6Mgypuwi7LLTk3jxc3YT1Z=wapec7E32bF_g@mail.gmail.com>
References: <CAOL+ROEm=17mPG6Mgypuwi7LLTk3jxc3YT1Z=wapec7E32bF_g@mail.gmail.com>
Message-ID: <201411080000.58066.even.rouault@spatialys.com>

Le vendredi 07 novembre 2014 23:53:09, Roger Andr? a ?crit :
> Hello List,
> 
> I am very curious why after installing GDAL 1.11, I now need to use the
> -lco ENCODING=UTF-8 option when using ogr2ogr on any of my already UTF-8
> encoded shapefiles?  Failure to do so results in this error,
> 
> Warning 1: One or several characters couldn't be converted correctly from
> UTF-8 to ISO-8859-1.

Roger,

The default encoding of shapefiles is ISO-8859-1. So if you don't specify  -lco 
ENCODING=UTF-8, the shapefile driver will attempt to recode from UTF-8 to 
ISO-8859-1. This behaviour has been introduced in GDAL 1.9. Previously no 
transcoding was done, and there could be mismatch between the actual encoding 
of the content and the declared encoding of the DBF.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From randre at gmail.com  Fri Nov  7 15:03:22 2014
From: randre at gmail.com (=?UTF-8?B?Um9nZXIgQW5kcsOp?=)
Date: Fri, 7 Nov 2014 15:03:22 -0800
Subject: [gdal-dev] What's up with the 8859 encoding?
In-Reply-To: <201411080000.58066.even.rouault@spatialys.com>
References: <CAOL+ROEm=17mPG6Mgypuwi7LLTk3jxc3YT1Z=wapec7E32bF_g@mail.gmail.com>
	<201411080000.58066.even.rouault@spatialys.com>
Message-ID: <CAOL+ROFpPxjWbie8xVFL4=4fQciTZGJKvWe47rqmDrwbOZzNGg@mail.gmail.com>

Even,

Thank you for the quick reply.   And it appears that using a .CPG file does
not make a difference in this.  Is that correct?

Roger

On Fri, Nov 7, 2014 at 3:00 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le vendredi 07 novembre 2014 23:53:09, Roger Andr? a ?crit :
> > Hello List,
> >
> > I am very curious why after installing GDAL 1.11, I now need to use the
> > -lco ENCODING=UTF-8 option when using ogr2ogr on any of my already UTF-8
> > encoded shapefiles?  Failure to do so results in this error,
> >
> > Warning 1: One or several characters couldn't be converted correctly from
> > UTF-8 to ISO-8859-1.
>
> Roger,
>
> The default encoding of shapefiles is ISO-8859-1. So if you don't specify
> -lco
> ENCODING=UTF-8, the shapefile driver will attempt to recode from UTF-8 to
> ISO-8859-1. This behaviour has been introduced in GDAL 1.9. Previously no
> transcoding was done, and there could be mismatch between the actual
> encoding
> of the content and the declared encoding of the DBF.
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141107/8610a838/attachment.html>

From even.rouault at spatialys.com  Fri Nov  7 15:08:18 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 8 Nov 2014 00:08:18 +0100
Subject: [gdal-dev] What's up with the 8859 encoding?
In-Reply-To: <CAOL+ROFpPxjWbie8xVFL4=4fQciTZGJKvWe47rqmDrwbOZzNGg@mail.gmail.com>
References: <CAOL+ROEm=17mPG6Mgypuwi7LLTk3jxc3YT1Z=wapec7E32bF_g@mail.gmail.com>
	<201411080000.58066.even.rouault@spatialys.com>
	<CAOL+ROFpPxjWbie8xVFL4=4fQciTZGJKvWe47rqmDrwbOZzNGg@mail.gmail.com>
Message-ID: <201411080008.18440.even.rouault@spatialys.com>

Le samedi 08 novembre 2014 00:03:22, Roger Andr? a ?crit :
> Even,
> 
> Thank you for the quick reply.   And it appears that using a .CPG file does
> not make a difference in this.  Is that correct?

You have to realize that the input and output side of ogr2ogr are completely 
isolated from each other.

So if your input shapefile has a .cpg,  the shapefile driver will use it to 
recode from the input dbf encoding mentionned in the .cpf to UTF-8 which is 
the pivot encoding of OGR (if the .cpg indicates UTF-8 then no recoding 
occurs)
If the output is a shapefile and you specify -lco ENCODING=UTF-8, as the pivot 
encoding of OGR is UTF-8, no recoding will occur and an output .cpg file 
indicating UTF-8 will be generated.

> 
> Roger
> 
> On Fri, Nov 7, 2014 at 3:00 PM, Even Rouault <even.rouault at spatialys.com>
> 
> wrote:
> > Le vendredi 07 novembre 2014 23:53:09, Roger Andr? a ?crit :
> > > Hello List,
> > > 
> > > I am very curious why after installing GDAL 1.11, I now need to use the
> > > -lco ENCODING=UTF-8 option when using ogr2ogr on any of my already
> > > UTF-8 encoded shapefiles?  Failure to do so results in this error,
> > > 
> > > Warning 1: One or several characters couldn't be converted correctly
> > > from UTF-8 to ISO-8859-1.
> > 
> > Roger,
> > 
> > The default encoding of shapefiles is ISO-8859-1. So if you don't specify
> > -lco
> > ENCODING=UTF-8, the shapefile driver will attempt to recode from UTF-8 to
> > ISO-8859-1. This behaviour has been introduced in GDAL 1.9. Previously no
> > transcoding was done, and there could be mismatch between the actual
> > encoding
> > of the content and the declared encoding of the DBF.
> > 
> > Even
> > 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From randre at gmail.com  Fri Nov  7 15:10:42 2014
From: randre at gmail.com (=?UTF-8?B?Um9nZXIgQW5kcsOp?=)
Date: Fri, 7 Nov 2014 15:10:42 -0800
Subject: [gdal-dev] What's up with the 8859 encoding?
In-Reply-To: <201411080008.18440.even.rouault@spatialys.com>
References: <CAOL+ROEm=17mPG6Mgypuwi7LLTk3jxc3YT1Z=wapec7E32bF_g@mail.gmail.com>
	<201411080000.58066.even.rouault@spatialys.com>
	<CAOL+ROFpPxjWbie8xVFL4=4fQciTZGJKvWe47rqmDrwbOZzNGg@mail.gmail.com>
	<201411080008.18440.even.rouault@spatialys.com>
Message-ID: <CAOL+ROFov+u0RRMCcpURuiGaGZ4CNpV=qdy3S55y+mVdrq6cGw@mail.gmail.com>

I see.  So the output will default to ISO-8859-1 - regardless of the input
.CPG - if the ENCODING flag isn't used.

On Fri, Nov 7, 2014 at 3:08 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le samedi 08 novembre 2014 00:03:22, Roger Andr? a ?crit :
> > Even,
> >
> > Thank you for the quick reply.   And it appears that using a .CPG file
> does
> > not make a difference in this.  Is that correct?
>
> You have to realize that the input and output side of ogr2ogr are
> completely
> isolated from each other.
>
> So if your input shapefile has a .cpg,  the shapefile driver will use it to
> recode from the input dbf encoding mentionned in the .cpf to UTF-8 which is
> the pivot encoding of OGR (if the .cpg indicates UTF-8 then no recoding
> occurs)
> If the output is a shapefile and you specify -lco ENCODING=UTF-8, as the
> pivot
> encoding of OGR is UTF-8, no recoding will occur and an output .cpg file
> indicating UTF-8 will be generated.
>
> >
> > Roger
> >
> > On Fri, Nov 7, 2014 at 3:00 PM, Even Rouault <even.rouault at spatialys.com
> >
> >
> > wrote:
> > > Le vendredi 07 novembre 2014 23:53:09, Roger Andr? a ?crit :
> > > > Hello List,
> > > >
> > > > I am very curious why after installing GDAL 1.11, I now need to use
> the
> > > > -lco ENCODING=UTF-8 option when using ogr2ogr on any of my already
> > > > UTF-8 encoded shapefiles?  Failure to do so results in this error,
> > > >
> > > > Warning 1: One or several characters couldn't be converted correctly
> > > > from UTF-8 to ISO-8859-1.
> > >
> > > Roger,
> > >
> > > The default encoding of shapefiles is ISO-8859-1. So if you don't
> specify
> > > -lco
> > > ENCODING=UTF-8, the shapefile driver will attempt to recode from UTF-8
> to
> > > ISO-8859-1. This behaviour has been introduced in GDAL 1.9. Previously
> no
> > > transcoding was done, and there could be mismatch between the actual
> > > encoding
> > > of the content and the declared encoding of the DBF.
> > >
> > > Even
> > >
> > > --
> > > Spatialys - Geospatial professional services
> > > http://www.spatialys.com
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141107/c17f2e71/attachment-0001.html>

From even.rouault at spatialys.com  Sat Nov  8 12:00:26 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 8 Nov 2014 21:00:26 +0100
Subject: [gdal-dev] OSM driver with z_order values
In-Reply-To: <545CCDC9.1030109@gatewaygeomatics.com>
References: <545B9536.8010106@gatewaygeomatics.com>
	<201411070949.45542.even.rouault@spatialys.com>
	<545CCDC9.1030109@gatewaygeomatics.com>
Message-ID: <201411082100.27194.even.rouault@spatialys.com>

Le vendredi 07 novembre 2014 14:48:57, Jeff McKenna a ?crit :
> On 2014-11-07 4:49 AM, Even Rouault wrote:
> > The ideal would to find some syntax to do this in osmconf.ini. Actually,
> > Jukka's mention of sqlite makes me think that the syntax could be SQL
> > evaluated by SQLite.
> > Something like :
> > 
> > computed_fields = z_order
> > z_order_type = Integer
> > z_order_sql = "SELECT (CASE [highway] WHEN 'minor' THEN 3 WHEN 'road'
> > THEN 3 WHEN 'tertiary_link' THEN 4 ... ELSE 0) + (CASE WHEN [bridge] IS
> > IN ('yes', 'true', '1') THEN 10 ELSE 0 END) + (CASE WHEN [layer] IS NOT
> > NULL THEN 10 * CAST([layer) AS INTEGER) ELSE 0 END) + ..."
> > 
> > And stuff in [] would be replaced by the corresponding field value.
> > 
> > That's something that could also potentially be done as the ogr2ogr
> > level, since there's hardly anything driver specific in that, but
> > finding the right U.I to specify per-layer computed fields isn't
> > obvious.
> 
> I agree, it would be very cool to be able to configure the z_order field
> in osmconf.ini !!!! I'm not sure what else to add to this discussion,
> other than that I really want this :)

Jeff,

I've implemented the above idea in latest trunk. I've translated the osm2pgsql 
rules (*) for the lines layer. Let me know if that works OK. The 
implementation of the mechanism is rather generic, so it could potentially be 
used to do many other things.

That would be cool if folks could share a link to their "operational" 
osmconf.ini so that we can link to it from the driver documentation page. The 
default one is probably too simple for some uses.

Even

(*) when you compare osm2pgsql and imposm rules, there are differences. 
osm2pgsql uses z_order = 5 for railway, whereas it is 7 for imposm. For 
highway = xxx_link, osm2pgsql uses the z_order of highway = xxx, whereas 
imposm uses 3. And the values of secondary and primary are differents (due to 
the difference for railway likely)

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From pekka.sarkola at gispo.fi  Sun Nov  9 09:28:13 2014
From: pekka.sarkola at gispo.fi (Pekka Sarkola)
Date: Sun, 9 Nov 2014 19:28:13 +0200
Subject: [gdal-dev] Error with using GML with Python
Message-ID: <002d01cffc42$8a630520$9f290f60$@gispo.fi>

Hi,

I might have newbie problem with OGR?s GML driver in Python.

I try to read GML files with Python script, but won?t get access to
features. I tried this on Window (ogr version 1.11.1), unfortunately I
couldn?t check this in other enviroments, yet.

So my sample testing script result is
---
Loop aita layer...              
 Count of features: 181         
None                            
None                            
Start Loop...                   
End of Loop                     
---

And sample script is very simple:
--- 
#!/usr/bin/python

# -- Start of test script ---
import sys;
from osgeo import ogr;

driver = ogr.GetDriverByName('GML');

if driver is None:
  print "Error with driver"
  sys.exit(1)

fn = '<your path>/L4131R.xml'
#fn = '/data/nlsfi/MTK-GML/L34131R.xml'
datasrc=driver.Open(fn,0);

if datasrc is None:
  print "Error opening " + fn;
  sys.exit(1);

print "Loop aita layer..."

myLayer=datasrc.GetLayer("Aita")
print " Count of features: "+str(myLayer.GetFeatureCount())

print myLayer.GetNextFeature();

print myLayer.GetFeature(2);

print "Start Loop..."
for feat in myLayer:
  print "a"
  
print "End of Loop"

# -- End of test script ---
---

GML file is National Land Survey of Finland's special GML. I can access with
ogrinfo and other command line tools, but not from Python (version 2.7.3).
You can download sample datasets from Kapsi, example
http://kartat.kapsi.fi/files/maastotietokanta/kaikki/etrs89/gml/L4/L41/

Any help is appreciated. I try to check this also in Ubuntu, but currently I
don't have working environment for GDAL 1.11.1. So if somebody can test this
on Ubuntu 14.04 (or any other version above 12.04)

Rgs,

Pekka

--
Pekka Sarkola
Gispo Oy
pekka.sarkola at gispo.fi?? - GSM +358 40?725 2042
www.gispo.fi ? www.paikkatieto.com 



From even.rouault at spatialys.com  Sun Nov  9 11:27:25 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 9 Nov 2014 20:27:25 +0100
Subject: [gdal-dev] Error with using GML with Python
In-Reply-To: <002d01cffc42$8a630520$9f290f60$@gispo.fi>
References: <002d01cffc42$8a630520$9f290f60$@gispo.fi>
Message-ID: <201411092027.25773.even.rouault@spatialys.com>

Le dimanche 09 novembre 2014 18:28:13, Pekka Sarkola a ?crit :
> Hi,
> 
> I might have newbie problem with OGR?s GML driver in Python.
> 
> I try to read GML files with Python script, but won?t get access to
> features. I tried this on Window (ogr version 1.11.1), unfortunately I
> couldn?t check this in other enviroments, yet.
> 
> So my sample testing script result is
> ---
> Loop aita layer...
>  Count of features: 181
> None
> None
> Start Loop...
> End of Loop
> ---
> 
> And sample script is very simple:
> ---
> #!/usr/bin/python
> 
> # -- Start of test script ---
> import sys;
> from osgeo import ogr;
> 
> driver = ogr.GetDriverByName('GML');
> 
> if driver is None:
>   print "Error with driver"
>   sys.exit(1)
> 
> fn = '<your path>/L4131R.xml'
> #fn = '/data/nlsfi/MTK-GML/L34131R.xml'
> datasrc=driver.Open(fn,0);
> 
> if datasrc is None:
>   print "Error opening " + fn;
>   sys.exit(1);
> 
> print "Loop aita layer..."
> 
> myLayer=datasrc.GetLayer("Aita")
> print " Count of features: "+str(myLayer.GetFeatureCount())
> 
> print myLayer.GetNextFeature();
> 
> print myLayer.GetFeature(2);
> 
> print "Start Loop..."
> for feat in myLayer:
>   print "a"
> 
> print "End of Loop"
> 
> # -- End of test script ---
> ---
> 
> GML file is National Land Survey of Finland's special GML. I can access
> with ogrinfo and other command line tools, but not from Python (version
> 2.7.3). You can download sample datasets from Kapsi, example
> http://kartat.kapsi.fi/files/maastotietokanta/kaikki/etrs89/gml/L4/L41/

Pekka,

I cannot reproduce such a behaviour neither on Linux nor on Windows. Are you 
sure that the GDAL Python bindings you use are GDAL 1.11.1 ?

Try:

from osgeo import gdal
gdal.VersionInfo('')

You could also try with another datasource, like shapefile, etc.. to see if you 
see a similar issue.

Even

> 
> Any help is appreciated. I try to check this also in Ubuntu, but currently
> I don't have working environment for GDAL 1.11.1. So if somebody can test
> this on Ubuntu 14.04 (or any other version above 12.04)
> 
> Rgs,
> 
> Pekka
> 
> --
> Pekka Sarkola
> Gispo Oy
> pekka.sarkola at gispo.fi   - GSM +358 40 725 2042
> www.gispo.fi ? www.paikkatieto.com
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From pekka.sarkola at gispo.fi  Sun Nov  9 11:55:09 2014
From: pekka.sarkola at gispo.fi (Pekka Sarkola)
Date: Sun, 9 Nov 2014 21:55:09 +0200
Subject: [gdal-dev] Error with using GML with Python
In-Reply-To: <201411092027.25773.even.rouault@spatialys.com>
References: <002d01cffc42$8a630520$9f290f60$@gispo.fi>
	<201411092027.25773.even.rouault@spatialys.com>
Message-ID: <000001cffc57$111d2230$33576690$@gispo.fi>

Hi Even,

Thanks about help!

 Yes, it seems that my python script use older version of GDAL (1.10.1). I
didn't check that: I thought that even FeatureCount won't work in older
version.

So I need check how to be sure that right version of ogr is loaded. PATH
settings etc. boring ;-)

Rgs,

Pekka

---?? Pekka Sarkola? -? pekka.sarkola at gispo.fi  -  www.paikkatieto.com?? ---

-----Alkuper?inen viesti-----
L?hett?j?: Even Rouault [mailto:even.rouault at spatialys.com] 
L?hetetty: 9. marraskuuta 2014 21:27
Vastaanottaja: gdal-dev at lists.osgeo.org; Pekka.Sarkola at gispo.fi
Aihe: Re: [gdal-dev] Error with using GML with Python

Le dimanche 09 novembre 2014 18:28:13, Pekka Sarkola a ?crit :
> Hi,
> 
> I might have newbie problem with OGR?s GML driver in Python.
> 
> I try to read GML files with Python script, but won?t get access to 
> features. I tried this on Window (ogr version 1.11.1), unfortunately I 
> couldn?t check this in other enviroments, yet.
> 
> So my sample testing script result is
> ---
> Loop aita layer...
>  Count of features: 181
> None
> None
> Start Loop...
> End of Loop
> ---
> 
> And sample script is very simple:
> ---
> #!/usr/bin/python
> 
> # -- Start of test script ---
> import sys;
> from osgeo import ogr;
> 
> driver = ogr.GetDriverByName('GML');
> 
> if driver is None:
>   print "Error with driver"
>   sys.exit(1)
> 
> fn = '<your path>/L4131R.xml'
> #fn = '/data/nlsfi/MTK-GML/L34131R.xml'
> datasrc=driver.Open(fn,0);
> 
> if datasrc is None:
>   print "Error opening " + fn;
>   sys.exit(1);
> 
> print "Loop aita layer..."
> 
> myLayer=datasrc.GetLayer("Aita")
> print " Count of features: "+str(myLayer.GetFeatureCount())
> 
> print myLayer.GetNextFeature();
> 
> print myLayer.GetFeature(2);
> 
> print "Start Loop..."
> for feat in myLayer:
>   print "a"
> 
> print "End of Loop"
> 
> # -- End of test script ---
> ---
> 
> GML file is National Land Survey of Finland's special GML. I can 
> access with ogrinfo and other command line tools, but not from Python 
> (version 2.7.3). You can download sample datasets from Kapsi, example 
> http://kartat.kapsi.fi/files/maastotietokanta/kaikki/etrs89/gml/L4/L41
> /

Pekka,

I cannot reproduce such a behaviour neither on Linux nor on Windows. Are you
sure that the GDAL Python bindings you use are GDAL 1.11.1 ?

Try:

from osgeo import gdal
gdal.VersionInfo('')

You could also try with another datasource, like shapefile, etc.. to see if
you see a similar issue.

Even

> 
> Any help is appreciated. I try to check this also in Ubuntu, but 
> currently I don't have working environment for GDAL 1.11.1. So if 
> somebody can test this on Ubuntu 14.04 (or any other version above 
> 12.04)
> 
> Rgs,
> 
> Pekka
> 
> --
> Pekka Sarkola
> Gispo Oy
> pekka.sarkola at gispo.fi   - GSM +358 40 725 2042
> www.gispo.fi ? www.paikkatieto.com
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

--
Spatialys - Geospatial professional services http://www.spatialys.com


From even.rouault at spatialys.com  Sun Nov  9 12:45:13 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 9 Nov 2014 21:45:13 +0100
Subject: [gdal-dev] Error with using GML with Python
In-Reply-To: <000001cffc57$111d2230$33576690$@gispo.fi>
References: <002d01cffc42$8a630520$9f290f60$@gispo.fi>
	<201411092027.25773.even.rouault@spatialys.com>
	<000001cffc57$111d2230$33576690$@gispo.fi>
Message-ID: <201411092145.13387.even.rouault@spatialys.com>

Le dimanche 09 novembre 2014 20:55:09, Pekka Sarkola a ?crit :
> Hi Even,
> 
> Thanks about help!
> 
>  Yes, it seems that my python script use older version of GDAL (1.10.1). I
> didn't check that: I thought that even FeatureCount won't work in older
> version.

MTK files are quite close to ""standard"" GML files, so older versions of GDAL 
can open them but will miss some attributes and geometries.
Make sure you delete the .gfs files that may have been generated with GDAL 1.10 
before trying with GDAL 1.11, or you might miss some attributes.

> 
> So I need check how to be sure that right version of ogr is loaded. PATH
> settings etc. boring ;-)
> 
> Rgs,
> 
> Pekka
> 
> ---   Pekka Sarkola  -  pekka.sarkola at gispo.fi  -  www.paikkatieto.com  
> ---
> 
> -----Alkuper?inen viesti-----
> L?hett?j?: Even Rouault [mailto:even.rouault at spatialys.com]
> L?hetetty: 9. marraskuuta 2014 21:27
> Vastaanottaja: gdal-dev at lists.osgeo.org; Pekka.Sarkola at gispo.fi
> Aihe: Re: [gdal-dev] Error with using GML with Python
> 
> Le dimanche 09 novembre 2014 18:28:13, Pekka Sarkola a ?crit :
> > Hi,
> > 
> > I might have newbie problem with OGR?s GML driver in Python.
> > 
> > I try to read GML files with Python script, but won?t get access to
> > features. I tried this on Window (ogr version 1.11.1), unfortunately I
> > couldn?t check this in other enviroments, yet.
> > 
> > So my sample testing script result is
> > ---
> > Loop aita layer...
> > 
> >  Count of features: 181
> > 
> > None
> > None
> > Start Loop...
> > End of Loop
> > ---
> > 
> > And sample script is very simple:
> > ---
> > #!/usr/bin/python
> > 
> > # -- Start of test script ---
> > import sys;
> > from osgeo import ogr;
> > 
> > driver = ogr.GetDriverByName('GML');
> > 
> > if driver is None:
> >   print "Error with driver"
> >   sys.exit(1)
> > 
> > fn = '<your path>/L4131R.xml'
> > #fn = '/data/nlsfi/MTK-GML/L34131R.xml'
> > datasrc=driver.Open(fn,0);
> > 
> > if datasrc is None:
> >   print "Error opening " + fn;
> >   sys.exit(1);
> > 
> > print "Loop aita layer..."
> > 
> > myLayer=datasrc.GetLayer("Aita")
> > print " Count of features: "+str(myLayer.GetFeatureCount())
> > 
> > print myLayer.GetNextFeature();
> > 
> > print myLayer.GetFeature(2);
> > 
> > print "Start Loop..."
> > 
> > for feat in myLayer:
> >   print "a"
> > 
> > print "End of Loop"
> > 
> > # -- End of test script ---
> > ---
> > 
> > GML file is National Land Survey of Finland's special GML. I can
> > access with ogrinfo and other command line tools, but not from Python
> > (version 2.7.3). You can download sample datasets from Kapsi, example
> > http://kartat.kapsi.fi/files/maastotietokanta/kaikki/etrs89/gml/L4/L41
> > /
> 
> Pekka,
> 
> I cannot reproduce such a behaviour neither on Linux nor on Windows. Are
> you sure that the GDAL Python bindings you use are GDAL 1.11.1 ?
> 
> Try:
> 
> from osgeo import gdal
> gdal.VersionInfo('')
> 
> You could also try with another datasource, like shapefile, etc.. to see if
> you see a similar issue.
> 
> Even
> 
> > Any help is appreciated. I try to check this also in Ubuntu, but
> > currently I don't have working environment for GDAL 1.11.1. So if
> > somebody can test this on Ubuntu 14.04 (or any other version above
> > 12.04)
> > 
> > Rgs,
> > 
> > Pekka
> > 
> > --
> > Pekka Sarkola
> > Gispo Oy
> > pekka.sarkola at gispo.fi   - GSM +358 40 725 2042
> > www.gispo.fi ? www.paikkatieto.com
> > 
> > 
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> --
> Spatialys - Geospatial professional services http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From thanghps at gmail.com  Sun Nov  9 17:59:22 2014
From: thanghps at gmail.com (Dao Thang)
Date: Mon, 10 Nov 2014 08:59:22 +0700
Subject: [gdal-dev] How to get value of Spatial Attributes Ogr Provider
Message-ID: <CANh0ZVRHwb9F3wAMNL2WqEa-iBSBj+sakZaSmx=6Cnh9pMdyRg@mail.gmail.com>

Hi All,

I used sharpmap with ogr provider to read S57 file.

But i don't see the spatial attributes example: QUAPOS attribute in the
DEPCNT layer.

Does anyone help me get it.

Thanks

[image: Inline image 1]

?????????????????????????????????????????????

*??o Tr?ng Th?ng*
*Mobile:* 0919 262 988
T?ng 11 - Handi Resco Building
 521 Kim M? - H? N?i
*Email: thanghps at gmail.com <thanghps at gmail.com>*
*YM    **:** daothang2004*
?????????????????????????????????????????????

Google Talk: thanghps Skype: thanghps
Contact Me [image: Facebook] <http://facebook.com/thanghps>[image: Twitter]
<http://twitter.com/thanghps>


<http://my.wisestamp.com/link?u=mjd9tz39tqz5jn9m&site=www.wisestamp.com/email-install>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141110/db95c043/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image.png
Type: image/png
Size: 26890 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141110/db95c043/attachment-0001.png>

From chaitanya.ch at gmail.com  Sun Nov  9 20:22:32 2014
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Mon, 10 Nov 2014 09:52:32 +0530
Subject: [gdal-dev] How to get value of Spatial Attributes Ogr Provider
In-Reply-To: <CANh0ZVRHwb9F3wAMNL2WqEa-iBSBj+sakZaSmx=6Cnh9pMdyRg@mail.gmail.com>
References: <CANh0ZVRHwb9F3wAMNL2WqEa-iBSBj+sakZaSmx=6Cnh9pMdyRg@mail.gmail.com>
Message-ID: <CAMKgpOY6uYF1ijJUWa82rbAeZBLF3meeXeqxT9=3rxGnARCCyQ@mail.gmail.com>

??o,

Refer to http://www.s-57.com/
Depth contour features don't have a Quality of position attribute.

On Mon, Nov 10, 2014 at 7:29 AM, Dao Thang <thanghps at gmail.com> wrote:

> Hi All,
>
> I used sharpmap with ogr provider to read S57 file.
>
> But i don't see the spatial attributes example: QUAPOS attribute in the
> DEPCNT layer.
>
> Does anyone help me get it.
>
> Thanks
>
> [image: Inline image 1]
>
> ?????????????????????????????????????????????
>
> *??o Tr?ng Th?ng*
> *Mobile:* 0919 262 988
> T?ng 11 - Handi Resco Building
>  521 Kim M? - H? N?i
> *Email: thanghps at gmail.com <thanghps at gmail.com>*
> *YM    **:** daothang2004*
> ?????????????????????????????????????????????
>
> Google Talk: thanghps Skype: thanghps
> Contact Me [image: Facebook] <http://facebook.com/thanghps>[image:
> Twitter] <http://twitter.com/thanghps>
>
>
>
> <http://my.wisestamp.com/link?u=mjd9tz39tqz5jn9m&site=www.wisestamp.com/email-install>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
Best regards,
Chaitanya kumar CH.

+91-9494447584
17.2416N 80.1426E
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141110/0e8a1b90/attachment.html>

From thanghps at gmail.com  Sun Nov  9 20:33:29 2014
From: thanghps at gmail.com (Dao Thang)
Date: Mon, 10 Nov 2014 11:33:29 +0700
Subject: [gdal-dev] How to get value of Spatial Attributes Ogr Provider
In-Reply-To: <CAMKgpOY6uYF1ijJUWa82rbAeZBLF3meeXeqxT9=3rxGnARCCyQ@mail.gmail.com>
References: <CANh0ZVRHwb9F3wAMNL2WqEa-iBSBj+sakZaSmx=6Cnh9pMdyRg@mail.gmail.com>
	<CAMKgpOY6uYF1ijJUWa82rbAeZBLF3meeXeqxT9=3rxGnARCCyQ@mail.gmail.com>
Message-ID: <CANh0ZVQFSv12VMH5WQeYz_x_MvUdY5aOn2X0yBQCfYqT_Y3Qzg@mail.gmail.com>

Hi Chaitanya,

QUAPOS is not attribute of feature object of Depth contour. I know that.

But QUAPOS that i searching is spatial attribute of Spatial object. You can
read S57 specification to know Spatial Attribute.

Thanks


?????????????????????????????????????????????

*??o Tr?ng Th?ng*
*Mobile:* 0919 262 988
T?ng 11 - Handi Resco Building
 521 Kim M? - H? N?i
*Email: thanghps at gmail.com <thanghps at gmail.com>*
*YM    **:** daothang2004*
?????????????????????????????????????????????

Google Talk: thanghps Skype: thanghps
Contact Me [image: Facebook] <http://facebook.com/thanghps>[image: Twitter]
<http://twitter.com/thanghps>


<http://my.wisestamp.com/link?u=mjd9tz39tqz5jn9m&site=www.wisestamp.com/email-install>


On Mon, Nov 10, 2014 at 11:22 AM, Chaitanya kumar CH <chaitanya.ch at gmail.com
> wrote:

> ??o,
>
> Refer to http://www.s-57.com/
> Depth contour features don't have a Quality of position attribute.
>
> On Mon, Nov 10, 2014 at 7:29 AM, Dao Thang <thanghps at gmail.com> wrote:
>
>> Hi All,
>>
>> I used sharpmap with ogr provider to read S57 file.
>>
>> But i don't see the spatial attributes example: QUAPOS attribute in the
>> DEPCNT layer.
>>
>> Does anyone help me get it.
>>
>> Thanks
>>
>> [image: Inline image 1]
>>
>> ?????????????????????????????????????????????
>>
>> *??o Tr?ng Th?ng*
>> *Mobile:* 0919 262 988
>> T?ng 11 - Handi Resco Building
>>  521 Kim M? - H? N?i
>> *Email: thanghps at gmail.com <thanghps at gmail.com>*
>> *YM    **:** daothang2004*
>> ?????????????????????????????????????????????
>>
>> Google Talk: thanghps Skype: thanghps
>> Contact Me [image: Facebook] <http://facebook.com/thanghps>[image:
>> Twitter] <http://twitter.com/thanghps>
>>
>>
>>
>> <http://my.wisestamp.com/link?u=mjd9tz39tqz5jn9m&site=www.wisestamp.com/email-install>
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>
> --
> Best regards,
> Chaitanya kumar CH.
>
> +91-9494447584
> 17.2416N 80.1426E
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141110/c25bea01/attachment-0001.html>

From chaitanya.ch at gmail.com  Sun Nov  9 20:50:20 2014
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Mon, 10 Nov 2014 10:20:20 +0530
Subject: [gdal-dev] How to get value of Spatial Attributes Ogr Provider
In-Reply-To: <CANh0ZVQFSv12VMH5WQeYz_x_MvUdY5aOn2X0yBQCfYqT_Y3Qzg@mail.gmail.com>
References: <CANh0ZVRHwb9F3wAMNL2WqEa-iBSBj+sakZaSmx=6Cnh9pMdyRg@mail.gmail.com>
	<CAMKgpOY6uYF1ijJUWa82rbAeZBLF3meeXeqxT9=3rxGnARCCyQ@mail.gmail.com>
	<CANh0ZVQFSv12VMH5WQeYz_x_MvUdY5aOn2X0yBQCfYqT_Y3Qzg@mail.gmail.com>
Message-ID: <CAMKgpOb3BZZqFqFvsm-z=oNx1=rJ+X2q2PXE1_v-TvQ+AGf2pw@mail.gmail.com>

??o,

You can look for the M_SREL feature in the required area and read it's
attributes.

You can apply a spatial filter on the M_SREL layer with the particular
DEPCNT feature.

Also, note that the DEPCNT features are often not very accurate.


On Mon, Nov 10, 2014 at 10:03 AM, Dao Thang <thanghps at gmail.com> wrote:

> Hi Chaitanya,
>
> QUAPOS is not attribute of feature object of Depth contour. I know that.
>
> But QUAPOS that i searching is spatial attribute of Spatial object. You
> can read S57 specification to know Spatial Attribute.
>
> Thanks
>
>
> ?????????????????????????????????????????????
>
> *??o Tr?ng Th?ng*
> *Mobile:* 0919 262 988
> T?ng 11 - Handi Resco Building
>  521 Kim M? - H? N?i
> *Email: thanghps at gmail.com <thanghps at gmail.com>*
> *YM    **:** daothang2004*
> ?????????????????????????????????????????????
>
> Google Talk: thanghps Skype: thanghps
> Contact Me [image: Facebook] <http://facebook.com/thanghps>[image:
> Twitter] <http://twitter.com/thanghps>
>
>
>
> <http://my.wisestamp.com/link?u=mjd9tz39tqz5jn9m&site=www.wisestamp.com/email-install>
>
>
> On Mon, Nov 10, 2014 at 11:22 AM, Chaitanya kumar CH <
> chaitanya.ch at gmail.com> wrote:
>
>> ??o,
>>
>> Refer to http://www.s-57.com/
>> Depth contour features don't have a Quality of position attribute.
>>
>> On Mon, Nov 10, 2014 at 7:29 AM, Dao Thang <thanghps at gmail.com> wrote:
>>
>>> Hi All,
>>>
>>> I used sharpmap with ogr provider to read S57 file.
>>>
>>> But i don't see the spatial attributes example: QUAPOS attribute in the
>>> DEPCNT layer.
>>>
>>> Does anyone help me get it.
>>>
>>> Thanks
>>>
>>> [image: Inline image 1]
>>>
>>> ?????????????????????????????????????????????
>>>
>>> *??o Tr?ng Th?ng*
>>> *Mobile:* 0919 262 988
>>> T?ng 11 - Handi Resco Building
>>>  521 Kim M? - H? N?i
>>> *Email: thanghps at gmail.com <thanghps at gmail.com>*
>>> *YM    **:** daothang2004*
>>> ?????????????????????????????????????????????
>>>
>>> Google Talk: thanghps Skype: thanghps
>>> Contact Me [image: Facebook] <http://facebook.com/thanghps>[image:
>>> Twitter] <http://twitter.com/thanghps>
>>>
>>>
>>>
>>> <http://my.wisestamp.com/link?u=mjd9tz39tqz5jn9m&site=www.wisestamp.com/email-install>
>>>
>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>
>>
>>
>> --
>> Best regards,
>> Chaitanya kumar CH.
>>
>> +91-9494447584
>> 17.2416N 80.1426E
>>
>
>


-- 
Best regards,
Chaitanya kumar CH.

+91-9494447584
17.2416N 80.1426E
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141110/c9b6bad5/attachment.html>

From jukka.rahkonen at mmmtike.fi  Mon Nov 10 01:10:56 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Mon, 10 Nov 2014 09:10:56 +0000 (UTC)
Subject: [gdal-dev] Spatialite and UPDATE triggers
Message-ID: <loom.20141110T095621-488@post.gmane.org>

Even,

I noticed that you have worked with INSERT triggers in
http://trac.osgeo.org/gdal/changeset/27936.

What would you say about the discussion in
https://groups.google.com/forum/#!searchin/spatialite-users/
trigger/spatialite-users/A6gR--y2dr4/pkXg4nSdP2IJ

I suppose that the new generation triggers will be created automatically if
GDAL is built with the next-to-come Spatialite 4.2.1 but it may take some
time before majority of GDAL users will have it. However, new triggers
should be backward compatible for all Spatialite 4.x versions. I wonder if
it would make sense to make GDAL to do something similar than SELECT
UpgradeGeometryTriggers that is mentioned in the thread. Ten times more
speed when doing UPDATE of non-geometry attributes for each row is quite a
lot. Of coarse if Spatialite v. >=4.2.1 will be soon a standard for building
GDAL with Spatialite the unnecessary slow update trigger issue will be
solved automatically.

-Jukka Rahkonen-


From daniel.teske at web.de  Mon Nov 10 01:28:25 2014
From: daniel.teske at web.de (teeschke)
Date: Mon, 10 Nov 2014 01:28:25 -0800 (PST)
Subject: [gdal-dev] Implement Mapservers Smooth-SIA algorithm
Message-ID: <1415611705914-5172151.post@n6.nabble.com>

Hi all

Do you think it's possible to apply the smoothsia-algorithm from mapserver
to OGR and GDAL tool? This algorithm is absolutely missing in the tools
gdal_contour and ogr2ogr.
http://mapserver.org/development/rfc/ms-rfc-94.html

Because the most of all geodata filetypes don't support curves, the smoothed
geometries would have more vertices. But I'm sure that the users will accept
this behavior for the new functionality.

Thanks and regards
teeschke



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Implement-Mapservers-Smooth-SIA-algorithm-tp5172151.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Mon Nov 10 02:30:32 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 10 Nov 2014 11:30:32 +0100
Subject: [gdal-dev] Spatialite and UPDATE triggers
In-Reply-To: <loom.20141110T095621-488@post.gmane.org>
References: <loom.20141110T095621-488@post.gmane.org>
Message-ID: <201411101130.33016.even.rouault@spatialys.com>

Hi Jukka,

> 
> I noticed that you have worked with INSERT triggers in
> http://trac.osgeo.org/gdal/changeset/27936.

Don't mention it to Sandro: he will yell at me for possibly corrupting 
spatialite DBs ;-) I hope that what I've done is safe however, even if there's 
still some slight risk, in case what the triggers do evolve over time. Perhaps 
I should inspect a bit more the definitions of the trigger to be sure they are 
really safe to drop them temporarily.

> 
> What would you say about the discussion in
> https://groups.google.com/forum/#!searchin/spatialite-users/
> trigger/spatialite-users/A6gR--y2dr4/pkXg4nSdP2IJ
> 
> I suppose that the new generation triggers will be created automatically if
> GDAL is built with the next-to-come Spatialite 4.2.1 but it may take some
> time before majority of GDAL users will have it. However, new triggers
> should be backward compatible for all Spatialite 4.x versions. I wonder if
> it would make sense to make GDAL to do something similar than SELECT
> UpgradeGeometryTriggers that is mentioned in the thread. 

Perhaps, but that means incorporating the definition of the triggers inside 
OGR, which is risky since their definition might be spatialite version 
dependant.

> Ten times more
> speed when doing UPDATE of non-geometry attributes for each row is quite a
> lot. Of coarse if Spatialite v. >=4.2.1 will be soon a standard for
> building GDAL with Spatialite the unnecessary slow update trigger issue
> will be solved automatically.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Mon Nov 10 02:36:53 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 10 Nov 2014 11:36:53 +0100
Subject: [gdal-dev] Implement Mapservers Smooth-SIA algorithm
In-Reply-To: <1415611705914-5172151.post@n6.nabble.com>
References: <1415611705914-5172151.post@n6.nabble.com>
Message-ID: <201411101136.53484.even.rouault@spatialys.com>

teeschke,

> 
> Do you think it's possible to apply the smoothsia-algorithm from mapserver
> to OGR and GDAL tool? 

From a very quick look, there's nothing MapServer specific in it. But as 
licences of both projects are compatible, an OGR implementation could reuse 
MapServer code if practical.

> This algorithm is absolutely missing in the tools
> gdal_contour and ogr2ogr.
> http://mapserver.org/development/rfc/ms-rfc-94.html

I would rather see as an option of ogr2ogr. A -smooth option that would a  -
segmentize "++".

> 
> Because the most of all geodata filetypes don't support curves, the
> smoothed geometries would have more vertices. But I'm sure that the users
> will accept this behavior for the new functionality.

As said above, can be implemented as new optional step.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Mon Nov 10 04:40:18 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 10 Nov 2014 13:40:18 +0100
Subject: [gdal-dev] Call for discussion on RFC 49: Curve geometries
In-Reply-To: <201411051601.58553.even.rouault@spatialys.com>
References: <201411051601.58553.even.rouault@spatialys.com>
Message-ID: <201411101340.18502.even.rouault@spatialys.com>

Le mercredi 05 novembre 2014 16:01:58, Even Rouault a ?crit :
> Hi,
> 
> This is a call for discussion on RFC 49: Curve geometries
> 
> http://trac.osgeo.org/gdal/wiki/rfc49_curve_geometries
> 

Hi,

Is there any other comment on this, before I call for a vote on it ? Since my 
initial email, I've taken into account Paul's comment to make things hopefully 
clearer ( 
http://trac.osgeo.org/gdal/wiki/rfc49_curve_geometries?action=diff&version=5 ) 
and also made the OGR_GT_* functions available to SWIG ( 
http://trac.osgeo.org/gdal/wiki/rfc49_curve_geometries?action=diff&version=7 )

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Mon Nov 10 05:38:28 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 10 Nov 2014 14:38:28 +0100
Subject: [gdal-dev] Spatialite and UPDATE triggers
In-Reply-To: <201411101130.33016.even.rouault@spatialys.com>
References: <loom.20141110T095621-488@post.gmane.org>
	<201411101130.33016.even.rouault@spatialys.com>
Message-ID: <201411101438.29001.even.rouault@spatialys.com>

Le lundi 10 novembre 2014 11:30:32, Even Rouault a ?crit :
> Hi Jukka,
> 
> > I noticed that you have worked with INSERT triggers in
> > http://trac.osgeo.org/gdal/changeset/27936.
> 
> Don't mention it to Sandro: he will yell at me for possibly corrupting
> spatialite DBs ;-) I hope that what I've done is safe however, even if
> there's still some slight risk, in case what the triggers do evolve over
> time. Perhaps I should inspect a bit more the definitions of the trigger
> to be sure they are really safe to drop them temporarily.

Strict validation implementation now. Small changes in the trigger definition 
will cause the optimization to not drop the trigger. Better be safe than 
sorry.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jmckenna at gatewaygeomatics.com  Mon Nov 10 07:21:22 2014
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Mon, 10 Nov 2014 11:21:22 -0400
Subject: [gdal-dev] OSM driver with z_order values
In-Reply-To: <201411082100.27194.even.rouault@spatialys.com>
References: <545B9536.8010106@gatewaygeomatics.com>
	<201411070949.45542.even.rouault@spatialys.com>
	<545CCDC9.1030109@gatewaygeomatics.com>
	<201411082100.27194.even.rouault@spatialys.com>
Message-ID: <5460D7F2.1010408@gatewaygeomatics.com>

On 2014-11-08 4:00 PM, Even Rouault wrote:
> Le vendredi 07 novembre 2014 14:48:57, Jeff McKenna a ?crit :
>> On 2014-11-07 4:49 AM, Even Rouault wrote:
>>> The ideal would to find some syntax to do this in osmconf.ini. Actually,
>>> Jukka's mention of sqlite makes me think that the syntax could be SQL
>>> evaluated by SQLite.
>>> Something like :
>>>
>>> computed_fields = z_order
>>> z_order_type = Integer
>>> z_order_sql = "SELECT (CASE [highway] WHEN 'minor' THEN 3 WHEN 'road'
>>> THEN 3 WHEN 'tertiary_link' THEN 4 ... ELSE 0) + (CASE WHEN [bridge] IS
>>> IN ('yes', 'true', '1') THEN 10 ELSE 0 END) + (CASE WHEN [layer] IS NOT
>>> NULL THEN 10 * CAST([layer) AS INTEGER) ELSE 0 END) + ..."
>>>
>>> And stuff in [] would be replaced by the corresponding field value.
>>>
>>> That's something that could also potentially be done as the ogr2ogr
>>> level, since there's hardly anything driver specific in that, but
>>> finding the right U.I to specify per-layer computed fields isn't
>>> obvious.
>>
>> I agree, it would be very cool to be able to configure the z_order field
>> in osmconf.ini !!!! I'm not sure what else to add to this discussion,
>> other than that I really want this :)
>
> Jeff,
>
> I've implemented the above idea in latest trunk. I've translated the osm2pgsql
> rules (*) for the lines layer. Let me know if that works OK. The
> implementation of the mechanism is rather generic, so it could potentially be
> used to do many other things.
>
> That would be cool if folks could share a link to their "operational"
> osmconf.ini so that we can link to it from the driver documentation page. The
> default one is probably too simple for some uses.
>
> Even
>
> (*) when you compare osm2pgsql and imposm rules, there are differences.
> osm2pgsql uses z_order = 5 for railway, whereas it is 7 for imposm. For
> highway = xxx_link, osm2pgsql uses the z_order of highway = xxx, whereas
> imposm uses 3. And the values of secondary and primary are differents (due to
> the difference for railway likely)
>

Hi Even,

I've updated my GDAL version and am ready to test this change.  I am 
wondering though if this "computed_attributes=z_order" can be applied to 
not only lines, but also points and multipolygons.  I will add that into 
my osmconf.ini and test to see.  I will update this thread with my 
results soon.

PS. thanks for the z_order addition!!!!!!

-jeff





From jmckenna at gatewaygeomatics.com  Mon Nov 10 07:30:44 2014
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Mon, 10 Nov 2014 11:30:44 -0400
Subject: [gdal-dev] OSM driver with z_order values
In-Reply-To: <5460D7F2.1010408@gatewaygeomatics.com>
References: <545B9536.8010106@gatewaygeomatics.com>	<201411070949.45542.even.rouault@spatialys.com>	<545CCDC9.1030109@gatewaygeomatics.com>	<201411082100.27194.even.rouault@spatialys.com>
	<5460D7F2.1010408@gatewaygeomatics.com>
Message-ID: <5460DA24.6000203@gatewaygeomatics.com>

On 2014-11-10 11:21 AM, Jeff McKenna wrote:
> On 2014-11-08 4:00 PM, Even Rouault wrote:
>> Le vendredi 07 novembre 2014 14:48:57, Jeff McKenna a ?crit :
>>> On 2014-11-07 4:49 AM, Even Rouault wrote:
>>>> The ideal would to find some syntax to do this in osmconf.ini.
>>>> Actually,
>>>> Jukka's mention of sqlite makes me think that the syntax could be SQL
>>>> evaluated by SQLite.
>>>> Something like :
>>>>
>>>> computed_fields = z_order
>>>> z_order_type = Integer
>>>> z_order_sql = "SELECT (CASE [highway] WHEN 'minor' THEN 3 WHEN 'road'
>>>> THEN 3 WHEN 'tertiary_link' THEN 4 ... ELSE 0) + (CASE WHEN [bridge] IS
>>>> IN ('yes', 'true', '1') THEN 10 ELSE 0 END) + (CASE WHEN [layer] IS NOT
>>>> NULL THEN 10 * CAST([layer) AS INTEGER) ELSE 0 END) + ..."
>>>>
>>>> And stuff in [] would be replaced by the corresponding field value.
>>>>
>>>> That's something that could also potentially be done as the ogr2ogr
>>>> level, since there's hardly anything driver specific in that, but
>>>> finding the right U.I to specify per-layer computed fields isn't
>>>> obvious.
>>>
>>> I agree, it would be very cool to be able to configure the z_order field
>>> in osmconf.ini !!!! I'm not sure what else to add to this discussion,
>>> other than that I really want this :)
>>
>> Jeff,
>>
>> I've implemented the above idea in latest trunk. I've translated the
>> osm2pgsql
>> rules (*) for the lines layer. Let me know if that works OK. The
>> implementation of the mechanism is rather generic, so it could
>> potentially be
>> used to do many other things.
>>
>> That would be cool if folks could share a link to their "operational"
>> osmconf.ini so that we can link to it from the driver documentation
>> page. The
>> default one is probably too simple for some uses.
>>
>> Even
>>
>> (*) when you compare osm2pgsql and imposm rules, there are differences.
>> osm2pgsql uses z_order = 5 for railway, whereas it is 7 for imposm. For
>> highway = xxx_link, osm2pgsql uses the z_order of highway = xxx, whereas
>> imposm uses 3. And the values of secondary and primary are differents
>> (due to
>> the difference for railway likely)
>>
>
> Hi Even,
>
> I've updated my GDAL version and am ready to test this change.  I am
> wondering though if this "computed_attributes=z_order" can be applied to
> not only lines, but also points and multipolygons.  I will add that into
> my osmconf.ini and test to see.  I will update this thread with my
> results soon.
>
> PS. thanks for the z_order addition!!!!!!
>
> -jeff
>
>
>

Ah I think I must figure out the necessary 'z_order_sql' SELECT for 
points and multipolygons.  Ok understood.  Will get back to you soon :)

-jeff




-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/





From jukka.rahkonen at mmmtike.fi  Mon Nov 10 07:35:04 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Mon, 10 Nov 2014 15:35:04 +0000 (UTC)
Subject: [gdal-dev] =?utf-8?q?OSM_driver_with_z=5Forder_values?=
References: <545B9536.8010106@gatewaygeomatics.com>
	<201411070949.45542.even.rouault@spatialys.com>
	<545CCDC9.1030109@gatewaygeomatics.com>
	<201411082100.27194.even.rouault@spatialys.com>
Message-ID: <loom.20141110T143153-379@post.gmane.org>

Even Rouault <even.rouault <at> spatialys.com> writes:


> Jeff,
> 
> I've implemented the above idea in latest trunk. I've translated the
osm2pgsql 
> rules (*) for the lines layer. Let me know if that works OK. The 
> implementation of the mechanism is rather generic, so it could potentially be 
> used to do many other things.


Hi,

I made some quick test for seeing the effects of disabling insert triggers
and the creation of the new derived z_order field.

Environment: Windows 7 64-bit, Intel Core i7-3770 3.4 GHz, rotational disks
Test data: Finland-latest.osm.pbf 2014-11-10 (184 MB)
Command:
ogr2ogr -f sqlite -dsco spatialite=yes finland.sqlite finland-latest.osm.pbf
--config OGR_SQLITE_SYNCHRONOUS OFF --config OSM_COMPRESS_NODES YES -lco
SPATIAL_INDEX=NO -progress

GDAL before r27936: 99 seconds
GDAL with r27936: 74 seconds
GDAL with r27936 + create z_order: 86 seconds
Same as above + SPATIAL_INDEX=YES: 197 seconds

Extra test:
GDAL with r27936, no z_order, OSM_MAX_TMPFILE_SIZE 2500 MB: 66 seconds

Heap memory usage with default OSM_MAX_TMPFILE_SIZE: 280 MB
Heap CPU usage: task manager showed 12 % for 8 threads but the i7
"hyperthreads" seemed to be all idle. Still only 25% CPU load if counted by
the 4 real cores.

Conclusions:

- Disabling the insert triggers was a good thing to do
- Creating z_order for linestrings is pretty fast
- 56% of the total time with Spatialite is spent for creating spatial
indexes it they are needed (as they usually are)
- Is is hard to believe in huge improvements in the speed of
PBF->SQLite/Spatialite/GeoPackage conversion with GDAL any more because 
SQLite begins to be the slowest part.
- Compared to the speed of what GDAL is doing the creation of spatial index
inside Spatialite db starts to feel, if not sluggish, but still like
something that could perhaps be faster. However, indexes are created only
once and spending 10 seconds more or less time for that is not of big
importance.

Ideas:

- It is irritating to know that CPU runs 75% idle. I must try to find a
computer with SSD for some further tests.
- For saving a few more seconds when there is free RAM available, could it
be possible to tell GDAL to use SQLite memory db as a target and move it on
disk as the very last step after running the slow CreateSpatialIndex
requests which probably need to do both reads and writes from disk? I could
save 8 seconds by increasing the size of the internal SQLite db from the
default 100 MB to 2500 MB and I somehow feel that there is more to save from
the 111 seconds which are now spent for creating spatial indexes.

-Jukka Rahkonen-






From even.rouault at spatialys.com  Mon Nov 10 07:51:42 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 10 Nov 2014 16:51:42 +0100
Subject: [gdal-dev] OSM driver with z_order values
In-Reply-To: <loom.20141110T143153-379@post.gmane.org>
References: <545B9536.8010106@gatewaygeomatics.com>
	<201411082100.27194.even.rouault@spatialys.com>
	<loom.20141110T143153-379@post.gmane.org>
Message-ID: <201411101651.42880.even.rouault@spatialys.com>

Le lundi 10 novembre 2014 16:35:04, Jukka Rahkonen a ?crit :
> Even Rouault <even.rouault <at> spatialys.com> writes:
> > Jeff,
> > 
> > I've implemented the above idea in latest trunk. I've translated the
> 
> osm2pgsql
> 
> > rules (*) for the lines layer. Let me know if that works OK. The
> > implementation of the mechanism is rather generic, so it could
> > potentially be used to do many other things.
> 
> Hi,
> 
> I made some quick test for seeing the effects of disabling insert triggers
> and the creation of the new derived z_order field.
> 
> Environment: Windows 7 64-bit, Intel Core i7-3770 3.4 GHz, rotational disks
> Test data: Finland-latest.osm.pbf 2014-11-10 (184 MB)
> Command:
> ogr2ogr -f sqlite -dsco spatialite=yes finland.sqlite
> finland-latest.osm.pbf --config OGR_SQLITE_SYNCHRONOUS OFF --config
> OSM_COMPRESS_NODES YES -lco SPATIAL_INDEX=NO -progress
> 
> GDAL before r27936: 99 seconds
> GDAL with r27936: 74 seconds
> GDAL with r27936 + create z_order: 86 seconds
> Same as above + SPATIAL_INDEX=YES: 197 seconds
> 
> Extra test:
> GDAL with r27936, no z_order, OSM_MAX_TMPFILE_SIZE 2500 MB: 66 seconds
> 
> Heap memory usage with default OSM_MAX_TMPFILE_SIZE: 280 MB
> Heap CPU usage: task manager showed 12 % for 8 threads but the i7
> "hyperthreads" seemed to be all idle. Still only 25% CPU load if counted by
> the 4 real cores.

Yes all the processing is single-threaded. Making the OSM driver multi-
threaded would be a non-trivial effort, and only worth with very fast storage.
A less complicated possibility could be to make the reading part and writing 
part into dedicated threads in ogr2ogr.

> 
> Conclusions:
> 
> - Disabling the insert triggers was a good thing to do
> - Creating z_order for linestrings is pretty fast
> - 56% of the total time with Spatialite is spent for creating spatial
> indexes it they are needed (as they usually are)
> - Is is hard to believe in huge improvements in the speed of
> PBF->SQLite/Spatialite/GeoPackage conversion with GDAL any more because
> SQLite begins to be the slowest part.
> - Compared to the speed of what GDAL is doing the creation of spatial index
> inside Spatialite db starts to feel, if not sluggish, but still like
> something that could perhaps be faster. However, indexes are created only
> once and spending 10 seconds more or less time for that is not of big
> importance.
> 
> Ideas:
> 
> - It is irritating to know that CPU runs 75% idle. I must try to find a
> computer with SSD for some further tests.
> - For saving a few more seconds when there is free RAM available, could it
> be possible to tell GDAL to use SQLite memory db as a target and move it on
> disk as the very last step after running the slow CreateSpatialIndex
> requests which probably need to do both reads and writes from disk? I could
> save 8 seconds by increasing the size of the internal SQLite db from the
> default 100 MB to 2500 MB and I somehow feel that there is more to save
> from the 111 seconds which are now spent for creating spatial indexes.

Instead of outputing to finland.sqlite, try /vsimem/finland.sqlite. Of course 
you will have no file at the end, but it would be a good simulation of the 
potential performance gains (you should add to that number the time to copy a 
file from memory to disk).

> 
> -Jukka Rahkonen-
> 
> 
> 
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at mmmtike.fi  Mon Nov 10 08:16:41 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Mon, 10 Nov 2014 16:16:41 +0000 (UTC)
Subject: [gdal-dev] =?utf-8?q?OSM_driver_with_z=5Forder_values?=
References: <545B9536.8010106@gatewaygeomatics.com>
	<201411082100.27194.even.rouault@spatialys.com>
	<loom.20141110T143153-379@post.gmane.org>
	<201411101651.42880.even.rouault@spatialys.com>
Message-ID: <loom.20141110T165756-964@post.gmane.org>

Even Rouault <even.rouault <at> spatialys.com> writes:


> Instead of outputing to finland.sqlite, try /vsimem/finland.sqlite. Of course 
> you will have no file at the end, but it would be a good simulation of the 
> potential performance gains (you should add to that number the time to copy a 
> file from memory to disk).


Output to /vsimem without spatial indexes: 60 sec (vs. 66 sec when written
to disk file)
Output to /vsimem with spatial indexes: 141 sec (vs. 197 sec when written to
disk file)

Hmm, feels like the net difference with my data (file sizes: source 184 MB
PBF and target 830 MB SQLite) could be 30-40 seconds. Half a minute is not
much in desktop usage but for a busy web service it could make a difference
that counts.

-Jukka-



From jed.kaplan at unil.ch  Mon Nov 10 09:37:53 2014
From: jed.kaplan at unil.ch (Jed O. Kaplan)
Date: Mon, 10 Nov 2014 18:37:53 +0100
Subject: [gdal-dev] Support for QSC in GDAL (was: Warp API / gdalwarp: using
	projection supported by PROJ4, but not explicitly by GDAL?)
Message-ID: <88055E43-85F7-4DF9-BD50-0B87C3CA230D@unil.ch>

Dear GDAL developers,

I would like to resurrect this thread from a couple of years ago regarding GDAL support for the Quadrilateralized Spherical Cube (QSC) projection in GDAL.

Now that the QSC projection is supported by proj4 and works well, would it be possible to have the projection fully supported in GDAL, i.e., identifiable in a WKT string?

The QSC projection has many potential uses whenever working with global data and would be a valuable additional feature for GDAL.

Thanks in advance for your help!

Best regards,

Jed Kaplan

On Fri, 13 Jul 2012 12:01:21 +0200, Even Rouault wrote: 
> > I could certainly do that, but with the '+wktext' mechanism, there 
> > is no reason to add this patch anymore, is there? 
> 
> Your patch is a cleaner solution than the +wktext mechanism, which 
> remains something a bit hacky (although I must admit I had never 
> heard before of that QSC projection ! and it is probably some niche 
> projection). The advantage of having it properly recognized is that 
> you can then embed its WKT representation in a .aux.xml file and all 
> tools using GDAL will be able to deal properly with it. 

Yes, QSC is very limited in scope and absolutely not widely used. It is 
a perfect fit for my use case (planetary-scale terrain rendering using 
quadtree hierarchies for data management), but I'm not sure it is worth 
adding general support for it to GDAL. For me, the '+wktext' solution 
already works fine since the transformation of data to the quadtree 
hierarchies is typically one way only: the resulting files are only 
ever used by the renderer. 

> But reading again your initial email, I didn't realize that it is not 
> yet supported in proj, only proposed. So we will wait for it to be 
> committed in PROJ first before committing its support in GDAL. 

OK, if QSC is accepted into PROJ and full support for it in GDAL is 
considered worthwhile, I can update the patch and create a ticket. 

Best regards 
Martin 

From even.rouault at spatialys.com  Mon Nov 10 10:39:47 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 10 Nov 2014 19:39:47 +0100
Subject: [gdal-dev] Support for QSC in GDAL (was: Warp API / gdalwarp:
	using projection supported by PROJ4, but not explicitly by GDAL?)
In-Reply-To: <88055E43-85F7-4DF9-BD50-0B87C3CA230D@unil.ch>
References: <88055E43-85F7-4DF9-BD50-0B87C3CA230D@unil.ch>
Message-ID: <201411101939.47933.even.rouault@spatialys.com>

Le lundi 10 novembre 2014 18:37:53, Jed O. Kaplan a ?crit :
> Dear GDAL developers,
> 
> I would like to resurrect this thread from a couple of years ago regarding
> GDAL support for the Quadrilateralized Spherical Cube (QSC) projection in
> GDAL.
> 
> Now that the QSC projection is supported by proj4 and works well, would it
> be possible to have the projection fully supported in GDAL, i.e.,
> identifiable in a WKT string?
> 
> The QSC projection has many potential uses whenever working with global
> data and would be a valuable additional feature for GDAL.

Jed,

I've committed Martin Lambers' patch from 13/07/2012 with the modification I 
suggested, i.e. add _ instead of space in  #define SRS_PT_QSC              
"Quadrilateralized_Spherical_Cube"

Even

> 
> Thanks in advance for your help!
> 
> Best regards,
> 
> Jed Kaplan
> 
> On Fri, 13 Jul 2012 12:01:21 +0200, Even Rouault wrote:
> > > I could certainly do that, but with the '+wktext' mechanism, there
> > > is no reason to add this patch anymore, is there?
> > 
> > Your patch is a cleaner solution than the +wktext mechanism, which
> > remains something a bit hacky (although I must admit I had never
> > heard before of that QSC projection ! and it is probably some niche
> > projection). The advantage of having it properly recognized is that
> > you can then embed its WKT representation in a .aux.xml file and all
> > tools using GDAL will be able to deal properly with it.
> 
> Yes, QSC is very limited in scope and absolutely not widely used. It is
> a perfect fit for my use case (planetary-scale terrain rendering using
> quadtree hierarchies for data management), but I'm not sure it is worth
> adding general support for it to GDAL. For me, the '+wktext' solution
> already works fine since the transformation of data to the quadtree
> hierarchies is typically one way only: the resulting files are only
> ever used by the renderer.
> 
> > But reading again your initial email, I didn't realize that it is not
> > yet supported in proj, only proposed. So we will wait for it to be
> > committed in PROJ first before committing its support in GDAL.
> 
> OK, if QSC is accepted into PROJ and full support for it in GDAL is
> considered worthwhile, I can update the patch and create a ticket.
> 
> Best regards
> Martin
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From robert.coup at koordinates.com  Mon Nov 10 11:20:25 2014
From: robert.coup at koordinates.com (Robert Coup)
Date: Tue, 11 Nov 2014 08:20:25 +1300
Subject: [gdal-dev] Call for discussion on RFC 49: Curve geometries
In-Reply-To: <201411101340.18502.even.rouault@spatialys.com>
References: <201411051601.58553.even.rouault@spatialys.com>
	<201411101340.18502.even.rouault@spatialys.com>
Message-ID: <CAFLLRpLjZMqOz1-Jc2g0_ivZimULBAZP_vLgUdpRcc0OSwsUgw@mail.gmail.com>

On Tue, Nov 11, 2014 at 1:40 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

>
> Is there any other comment on this, before I call for a vote on it ?


FWIW, sounds great to me. :)

I presume that the concept is to add curve-specific geometry functions
(rather than their linear equivalents) over time, as eg.
GEOS/PostGIS/whatever support them? In that case, should it be made clear
in the RFC "that non-linear geometries are first converted to their linear
approximation." is a "for now/worst case" thing?

Rob :)
-- 

*Koordinates*PO Box 1604, Shortland St, Auckland 1140, New Zealand
Phone +64-9-966 0433 koordinates.com <https://koordinates.com/about>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141111/2aea8ede/attachment.html>

From even.rouault at spatialys.com  Mon Nov 10 11:29:22 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 10 Nov 2014 20:29:22 +0100
Subject: [gdal-dev] Call for discussion on RFC 49: Curve geometries
In-Reply-To: <CAFLLRpLjZMqOz1-Jc2g0_ivZimULBAZP_vLgUdpRcc0OSwsUgw@mail.gmail.com>
References: <201411051601.58553.even.rouault@spatialys.com>
	<201411101340.18502.even.rouault@spatialys.com>
	<CAFLLRpLjZMqOz1-Jc2g0_ivZimULBAZP_vLgUdpRcc0OSwsUgw@mail.gmail.com>
Message-ID: <201411102029.22776.even.rouault@spatialys.com>

Le lundi 10 novembre 2014 20:20:25, Robert Coup a ?crit :
> On Tue, Nov 11, 2014 at 1:40 AM, Even Rouault <even.rouault at spatialys.com>
> 
> wrote:
> > Is there any other comment on this, before I call for a vote on it ?
> 
> FWIW, sounds great to me. :)
> 
> I presume that the concept is to add curve-specific geometry functions
> (rather than their linear equivalents) over time, as eg.
> GEOS/PostGIS/whatever support them?

Well, this is really for GEOS operations. Not sure if GEOS has a plan to 
support operations on curves one day. Would likely be a lot of work and 
probably depends on if JTS does such a move.

Regarding PostGIS, the conversion between OGR curve geometries and PostGIS 
curve geometries is 100% operationnal with the RFC.

> In that case, should it be made clear
> in the RFC "that non-linear geometries are first converted to their linear
> approximation." is a "for now/worst case" thing?

Precision added. Thanks

> 
> Rob :)

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From thanghps at gmail.com  Mon Nov 10 19:28:12 2014
From: thanghps at gmail.com (Dao Thang)
Date: Tue, 11 Nov 2014 10:28:12 +0700
Subject: [gdal-dev] How to get value of Spatial Attributes Ogr Provider
In-Reply-To: <CAMKgpOYPi1rFBhanV9rcGP+NwHEkThFtaiV9ytQgkxXDNFDqxg@mail.gmail.com>
References: <CANh0ZVRHwb9F3wAMNL2WqEa-iBSBj+sakZaSmx=6Cnh9pMdyRg@mail.gmail.com>
	<CAMKgpOY6uYF1ijJUWa82rbAeZBLF3meeXeqxT9=3rxGnARCCyQ@mail.gmail.com>
	<CANh0ZVQFSv12VMH5WQeYz_x_MvUdY5aOn2X0yBQCfYqT_Y3Qzg@mail.gmail.com>
	<CAMKgpOb3BZZqFqFvsm-z=oNx1=rJ+X2q2PXE1_v-TvQ+AGf2pw@mail.gmail.com>
	<CANh0ZVSgR_jT2H_innGeTTz_3TAeXewkdwQvw6c4UjXoo1WOhg@mail.gmail.com>
	<CAMKgpOYPi1rFBhanV9rcGP+NwHEkThFtaiV9ytQgkxXDNFDqxg@mail.gmail.com>
Message-ID: <CANh0ZVTWLHoXDMTfUiuTYr4w3ux9mzTGRrYNbPceLtsuGQe3zQ@mail.gmail.com>

Hi Chaitanya,

Thanks again.

As i told, my data don't have layer M_SREL. But other application can read
my data and show the QUAPOS attribute.

So this attribute is not in that layer as you told.




?????????????????????????????????????????????

*??o Tr?ng Th?ng*
*Mobile:* 0919 262 988
T?ng 11 - Handi Resco Building
 521 Kim M? - H? N?i
*Email: thanghps at gmail.com <thanghps at gmail.com>*
*YM    **:** daothang2004*
?????????????????????????????????????????????

Google Talk: thanghps Skype: thanghps
Contact Me [image: Facebook] <http://facebook.com/thanghps>[image: Twitter]
<http://twitter.com/thanghps>


<http://my.wisestamp.com/link?u=mjd9tz39tqz5jn9m&site=www.wisestamp.com/email-install>


On Mon, Nov 10, 2014 at 8:02 PM, Chaitanya kumar CH <chaitanya.ch at gmail.com>
wrote:

> Thang,
>
> I don't have access to any ENC viewer now. However, AFAIK, M_SREL is a
> special layer. So, you might be getting attributes from that layer. If you
> do need that data, you can get the feature from that location and use it.
> On 10 Nov 2014 11:58, "Dao Thang" <thanghps at gmail.com> wrote:
>
>> Hi Chaitanya,
>>
>> My s57 file don't have M_SREL layer.
>> Note: If i open it with EasyViewer App of Caris, i can see QUAPOS
>> atrribute.
>>
>> Please check it again.
>>
>> Thanks for your time!
>>
>> Thang
>>
>>
>> ?????????????????????????????????????????????
>>
>> *??o Tr?ng Th?ng*
>> *Mobile:* 0919 262 988
>> T?ng 11 - Handi Resco Building
>>  521 Kim M? - H? N?i
>> *Email: thanghps at gmail.com <thanghps at gmail.com>*
>> *YM    **:** daothang2004*
>> ?????????????????????????????????????????????
>>
>> Google Talk: thanghps Skype: thanghps
>> Contact Me [image: Facebook] <http://facebook.com/thanghps>[image:
>> Twitter] <http://twitter.com/thanghps>
>>
>>
>>
>> <http://my.wisestamp.com/link?u=mjd9tz39tqz5jn9m&site=www.wisestamp.com/email-install>
>>
>>
>> On Mon, Nov 10, 2014 at 11:50 AM, Chaitanya kumar CH <
>> chaitanya.ch at gmail.com> wrote:
>>
>>> ??o,
>>>
>>> You can look for the M_SREL feature in the required area and read it's
>>> attributes.
>>>
>>> You can apply a spatial filter on the M_SREL layer with the particular
>>> DEPCNT feature.
>>>
>>> Also, note that the DEPCNT features are often not very accurate.
>>>
>>>
>>> On Mon, Nov 10, 2014 at 10:03 AM, Dao Thang <thanghps at gmail.com> wrote:
>>>
>>>> Hi Chaitanya,
>>>>
>>>> QUAPOS is not attribute of feature object of Depth contour. I know that.
>>>>
>>>> But QUAPOS that i searching is spatial attribute of Spatial object. You
>>>> can read S57 specification to know Spatial Attribute.
>>>>
>>>> Thanks
>>>>
>>>>
>>>> ?????????????????????????????????????????????
>>>>
>>>> *??o Tr?ng Th?ng*
>>>> *Mobile:* 0919 262 988
>>>> T?ng 11 - Handi Resco Building
>>>>  521 Kim M? - H? N?i
>>>> *Email: thanghps at gmail.com <thanghps at gmail.com>*
>>>> *YM    **:** daothang2004*
>>>> ?????????????????????????????????????????????
>>>>
>>>> Google Talk: thanghps Skype: thanghps
>>>> Contact Me [image: Facebook] <http://facebook.com/thanghps>[image:
>>>> Twitter] <http://twitter.com/thanghps>
>>>>
>>>>
>>>>
>>>> <http://my.wisestamp.com/link?u=mjd9tz39tqz5jn9m&site=www.wisestamp.com/email-install>
>>>>
>>>>
>>>> On Mon, Nov 10, 2014 at 11:22 AM, Chaitanya kumar CH <
>>>> chaitanya.ch at gmail.com> wrote:
>>>>
>>>>> ??o,
>>>>>
>>>>> Refer to http://www.s-57.com/
>>>>> Depth contour features don't have a Quality of position attribute.
>>>>>
>>>>> On Mon, Nov 10, 2014 at 7:29 AM, Dao Thang <thanghps at gmail.com> wrote:
>>>>>
>>>>>> Hi All,
>>>>>>
>>>>>> I used sharpmap with ogr provider to read S57 file.
>>>>>>
>>>>>> But i don't see the spatial attributes example: QUAPOS attribute in
>>>>>> the DEPCNT layer.
>>>>>>
>>>>>> Does anyone help me get it.
>>>>>>
>>>>>> Thanks
>>>>>>
>>>>>> [image: Inline image 1]
>>>>>>
>>>>>> ?????????????????????????????????????????????
>>>>>>
>>>>>> *??o Tr?ng Th?ng*
>>>>>> *Mobile:* 0919 262 988
>>>>>> T?ng 11 - Handi Resco Building
>>>>>>  521 Kim M? - H? N?i
>>>>>> *Email: thanghps at gmail.com <thanghps at gmail.com>*
>>>>>> *YM    **:** daothang2004*
>>>>>> ?????????????????????????????????????????????
>>>>>>
>>>>>> Google Talk: thanghps Skype: thanghps
>>>>>> Contact Me [image: Facebook] <http://facebook.com/thanghps>[image:
>>>>>> Twitter] <http://twitter.com/thanghps>
>>>>>>
>>>>>>
>>>>>>
>>>>>> <http://my.wisestamp.com/link?u=mjd9tz39tqz5jn9m&site=www.wisestamp.com/email-install>
>>>>>>
>>>>>>
>>>>>> _______________________________________________
>>>>>> gdal-dev mailing list
>>>>>> gdal-dev at lists.osgeo.org
>>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>>>
>>>>>
>>>>>
>>>>>
>>>>> --
>>>>> Best regards,
>>>>> Chaitanya kumar CH.
>>>>>
>>>>> +91-9494447584
>>>>> 17.2416N 80.1426E
>>>>>
>>>>
>>>>
>>>
>>>
>>> --
>>> Best regards,
>>> Chaitanya kumar CH.
>>>
>>> +91-9494447584
>>> 17.2416N 80.1426E
>>>
>>
>>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141111/42526a37/attachment-0001.html>

From hema.yeedunuri at amigooptima.in  Mon Nov 10 23:26:44 2014
From: hema.yeedunuri at amigooptima.in (yhema)
Date: Mon, 10 Nov 2014 23:26:44 -0800 (PST)
Subject: [gdal-dev] creating graph for single line shape layer using gdal gnm
Message-ID: <1415690804698-5172326.post@n6.nabble.com>

Hello all,

I am trying to create a graph for network analysis using gdalgnm.The feature
auto connect is working if we provide more than one layer.How can we connect
features of a single layer so that graph is created automatically. We can
connect features using connect features but automatically it is not
conncting using auto connect .Here is the code.

 char **options = NULL;
    options = CSLAddNameValue(options,GNM_INIT_OPTIONPAIR_NAME,
"roads_network");
   
   
    GNMGdalNetwork *poNet;
   
    poNet =
GNMManager::GdalCreateNetwork("/home/shiva/Desktop/network/network_data",
"ESRI Shapefile", "EPSG:4326", options);
    CSLDestroy(options);
    if (poNet == NULL)
    {
        printf("Failed to create network\n");
        exit(1);
    }
   
    GDALDataset *poSrcDS = (GDALDataset*)
GDALOpenEx("/home/shiva/Desktop/network/data",
                                                     GDAL_OF_VECTOR |
GDAL_OF_READONLY, NULL, NULL, NULL );
    if(poSrcDS == NULL)
    {
        printf("Can not open source dataset at\n");
        exit(1);
    }
   
    OGRLayer *poSrcLayer2 = poSrcDS->GetLayerByName("roads");
    if (poSrcLayer2 == NULL)
    {
        printf("layer is null\n");
        printf("Can not process layers of source dataset\n");
        exit(1);
    }
   
    GNMErr err2 = poNet->CopyLayer(poSrcLayer2, "roads");
    if (err2 != GNMERR_NONE)
    {
        printf("Can not import layers from source dataset\n");
        exit(1);
    }
   
    GDALClose(poSrcDS);
   
   
    if (poNet->CreateRule("CLASS gnm_roads_line COSTS TIGER_ID") !=
GNMERR_NONE)
    {
        printf("Can not create rule\n");
    }
   
    if (poNet->CreateRule("NETWORK CONNECTS gnm_roads_line WITH
gnm_roads_line  ") != GNMERR_NONE)
    {
        printf("Can not create rule\n");
    }
   
   
    printf("\nBuilding network topology ...\n");
    GDALDataset *poNetDS = poNet->GetDataset();
    OGRLayer **layers = new OGRLayer*[3];
   
    layers[0] = poNetDS->GetLayerByName("gnm_roads_line");
    layers[2] = NULL;
    layers[1] = NULL;
   
   
    if (poNet->AutoConnect(layers,0.05, NULL) != GNMERR_NONE)
    {
        printf("Building topology failed\n");
        exit(1);
    }
    else
    {
        printf("Topology has been built successfully\n");
    }
   
    delete[] layers;
   
   
        GNMManager::GdalCloseNetwork(poNet);




thanks,
hema



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/creating-graph-for-single-line-shape-layer-using-gdal-gnm-tp5172326.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From gusevmihs at gmail.com  Tue Nov 11 02:29:48 2014
From: gusevmihs at gmail.com (Mikhail Gusev)
Date: Tue, 11 Nov 2014 14:29:48 +0400
Subject: [gdal-dev] creating graph for single line shape layer using
	gdal gnm
In-Reply-To: <1415690804698-5172326.post@n6.nabble.com>
References: <1415690804698-5172326.post@n6.nabble.com>
Message-ID: <CAJB43VovDJdoB1Lp_Yai9a33ZJd3eFFZ6+o33yPsNqPfUuQQ9Q@mail.gmail.com>

Hello, hema.
The current default implementation of GNMNetwork::AutoConnect() can work
only if the passing array of layers contains at least one point and one
line layer (i.e. GetGeomType() for the layers equals wkbPoint and
wkbLineString accordingly). For each line feature the algorithm takes the
start and end snapping area formed around the start and end point of the
line and searches the points from point layers which are situated inside
these two areas. So there is no way for now to connect features of only one
line layer automatically. You can use ConnectFeatures() to connect
manually, but you will need the features (with any geometry!) to be the
source and the target for the connection, while the gnm_roads_line feature
will be the connector.

2014-11-11 11:26 GMT+04:00 yhema <hema.yeedunuri at amigooptima.in>:

> Hello all,
>
> I am trying to create a graph for network analysis using gdalgnm.The
> feature
> auto connect is working if we provide more than one layer.How can we
> connect
> features of a single layer so that graph is created automatically. We can
> connect features using connect features but automatically it is not
> conncting using auto connect .Here is the code.
>
>  char **options = NULL;
>     options = CSLAddNameValue(options,GNM_INIT_OPTIONPAIR_NAME,
> "roads_network");
>
>
>     GNMGdalNetwork *poNet;
>
>     poNet =
> GNMManager::GdalCreateNetwork("/home/shiva/Desktop/network/network_data",
> "ESRI Shapefile", "EPSG:4326", options);
>     CSLDestroy(options);
>     if (poNet == NULL)
>     {
>         printf("Failed to create network\n");
>         exit(1);
>     }
>
>     GDALDataset *poSrcDS = (GDALDataset*)
> GDALOpenEx("/home/shiva/Desktop/network/data",
>                                                      GDAL_OF_VECTOR |
> GDAL_OF_READONLY, NULL, NULL, NULL );
>     if(poSrcDS == NULL)
>     {
>         printf("Can not open source dataset at\n");
>         exit(1);
>     }
>
>     OGRLayer *poSrcLayer2 = poSrcDS->GetLayerByName("roads");
>     if (poSrcLayer2 == NULL)
>     {
>         printf("layer is null\n");
>         printf("Can not process layers of source dataset\n");
>         exit(1);
>     }
>
>     GNMErr err2 = poNet->CopyLayer(poSrcLayer2, "roads");
>     if (err2 != GNMERR_NONE)
>     {
>         printf("Can not import layers from source dataset\n");
>         exit(1);
>     }
>
>     GDALClose(poSrcDS);
>
>
>     if (poNet->CreateRule("CLASS gnm_roads_line COSTS TIGER_ID") !=
> GNMERR_NONE)
>     {
>         printf("Can not create rule\n");
>     }
>
>     if (poNet->CreateRule("NETWORK CONNECTS gnm_roads_line WITH
> gnm_roads_line  ") != GNMERR_NONE)
>     {
>         printf("Can not create rule\n");
>     }
>
>
>     printf("\nBuilding network topology ...\n");
>     GDALDataset *poNetDS = poNet->GetDataset();
>     OGRLayer **layers = new OGRLayer*[3];
>
>     layers[0] = poNetDS->GetLayerByName("gnm_roads_line");
>     layers[2] = NULL;
>     layers[1] = NULL;
>
>
>     if (poNet->AutoConnect(layers,0.05, NULL) != GNMERR_NONE)
>     {
>         printf("Building topology failed\n");
>         exit(1);
>     }
>     else
>     {
>         printf("Topology has been built successfully\n");
>     }
>
>     delete[] layers;
>
>
>         GNMManager::GdalCloseNetwork(poNet);
>
>
>
>
> thanks,
> hema
>
>
>
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/creating-graph-for-single-line-shape-layer-using-gdal-gnm-tp5172326.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141111/24bcb372/attachment.html>

From hema.yeedunuri at amigooptima.in  Tue Nov 11 02:48:32 2014
From: hema.yeedunuri at amigooptima.in (Hema Yeedunuri)
Date: Tue, 11 Nov 2014 16:18:32 +0530
Subject: [gdal-dev] creating graph for single line shape layer using
	gdal gnm
In-Reply-To: <CAJB43VovDJdoB1Lp_Yai9a33ZJd3eFFZ6+o33yPsNqPfUuQQ9Q@mail.gmail.com>
References: <1415690804698-5172326.post@n6.nabble.com>
	<CAJB43VovDJdoB1Lp_Yai9a33ZJd3eFFZ6+o33yPsNqPfUuQQ9Q@mail.gmail.com>
Message-ID: <CA+8Q=fBCL1Qz2Jv4yqCza+1FLk6DzK9O1E2KqsmjrpWGTqR_jw@mail.gmail.com>

hello Mikhail Gusev ,

Thank u for the reply .I want to find  the shortest distance between
features .But the road layer I am using is having 10055 features. without
creating graph it is not possible to find shortest distance.And to my
understanding I think it is difficult to manually connect features to
create graph. The algorithm is using only the features that are connected
manually and that are present in _gnm_graph.dbf file.Is there any other
simple solution to solve this.

thanks,
hema

On Tue, Nov 11, 2014 at 3:59 PM, Mikhail Gusev <gusevmihs at gmail.com> wrote:

> Hello, hema.
> The current default implementation of GNMNetwork::AutoConnect() can work
> only if the passing array of layers contains at least one point and one
> line layer (i.e. GetGeomType() for the layers equals wkbPoint and
> wkbLineString accordingly). For each line feature the algorithm takes the
> start and end snapping area formed around the start and end point of the
> line and searches the points from point layers which are situated inside
> these two areas. So there is no way for now to connect features of only one
> line layer automatically. You can use ConnectFeatures() to connect
> manually, but you will need the features (with any geometry!) to be the
> source and the target for the connection, while the gnm_roads_line feature
> will be the connector.
>
> 2014-11-11 11:26 GMT+04:00 yhema <hema.yeedunuri at amigooptima.in>:
>
>> Hello all,
>>
>> I am trying to create a graph for network analysis using gdalgnm.The
>> feature
>> auto connect is working if we provide more than one layer.How can we
>> connect
>> features of a single layer so that graph is created automatically. We can
>> connect features using connect features but automatically it is not
>> conncting using auto connect .Here is the code.
>>
>>  char **options = NULL;
>>     options = CSLAddNameValue(options,GNM_INIT_OPTIONPAIR_NAME,
>> "roads_network");
>>
>>
>>     GNMGdalNetwork *poNet;
>>
>>     poNet =
>> GNMManager::GdalCreateNetwork("/home/shiva/Desktop/network/network_data",
>> "ESRI Shapefile", "EPSG:4326", options);
>>     CSLDestroy(options);
>>     if (poNet == NULL)
>>     {
>>         printf("Failed to create network\n");
>>         exit(1);
>>     }
>>
>>     GDALDataset *poSrcDS = (GDALDataset*)
>> GDALOpenEx("/home/shiva/Desktop/network/data",
>>                                                      GDAL_OF_VECTOR |
>> GDAL_OF_READONLY, NULL, NULL, NULL );
>>     if(poSrcDS == NULL)
>>     {
>>         printf("Can not open source dataset at\n");
>>         exit(1);
>>     }
>>
>>     OGRLayer *poSrcLayer2 = poSrcDS->GetLayerByName("roads");
>>     if (poSrcLayer2 == NULL)
>>     {
>>         printf("layer is null\n");
>>         printf("Can not process layers of source dataset\n");
>>         exit(1);
>>     }
>>
>>     GNMErr err2 = poNet->CopyLayer(poSrcLayer2, "roads");
>>     if (err2 != GNMERR_NONE)
>>     {
>>         printf("Can not import layers from source dataset\n");
>>         exit(1);
>>     }
>>
>>     GDALClose(poSrcDS);
>>
>>
>>     if (poNet->CreateRule("CLASS gnm_roads_line COSTS TIGER_ID") !=
>> GNMERR_NONE)
>>     {
>>         printf("Can not create rule\n");
>>     }
>>
>>     if (poNet->CreateRule("NETWORK CONNECTS gnm_roads_line WITH
>> gnm_roads_line  ") != GNMERR_NONE)
>>     {
>>         printf("Can not create rule\n");
>>     }
>>
>>
>>     printf("\nBuilding network topology ...\n");
>>     GDALDataset *poNetDS = poNet->GetDataset();
>>     OGRLayer **layers = new OGRLayer*[3];
>>
>>     layers[0] = poNetDS->GetLayerByName("gnm_roads_line");
>>     layers[2] = NULL;
>>     layers[1] = NULL;
>>
>>
>>     if (poNet->AutoConnect(layers,0.05, NULL) != GNMERR_NONE)
>>     {
>>         printf("Building topology failed\n");
>>         exit(1);
>>     }
>>     else
>>     {
>>         printf("Topology has been built successfully\n");
>>     }
>>
>>     delete[] layers;
>>
>>
>>         GNMManager::GdalCloseNetwork(poNet);
>>
>>
>>
>>
>> thanks,
>> hema
>>
>>
>>
>> --
>> View this message in context:
>> http://osgeo-org.1560.x6.nabble.com/creating-graph-for-single-line-shape-layer-using-gdal-gnm-tp5172326.html
>> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141111/ca5a8959/attachment.html>

From strk at keybit.net  Tue Nov 11 07:46:34 2014
From: strk at keybit.net (Sandro Santilli)
Date: Tue, 11 Nov 2014 16:46:34 +0100
Subject: [gdal-dev] Call for discussion on RFC 49: Curve geometries
In-Reply-To: <201411102029.22776.even.rouault@spatialys.com>
References: <201411051601.58553.even.rouault@spatialys.com>
	<201411101340.18502.even.rouault@spatialys.com>
	<CAFLLRpLjZMqOz1-Jc2g0_ivZimULBAZP_vLgUdpRcc0OSwsUgw@mail.gmail.com>
	<201411102029.22776.even.rouault@spatialys.com>
Message-ID: <20141111154634.GD23899@localhost>

On Mon, Nov 10, 2014 at 08:29:22PM +0100, Even Rouault wrote:
> Le lundi 10 novembre 2014 20:20:25, Robert Coup a ?crit :

> > I presume that the concept is to add curve-specific geometry functions
> > (rather than their linear equivalents) over time, as eg.
> > GEOS/PostGIS/whatever support them?
> 
> Well, this is really for GEOS operations. Not sure if GEOS has a plan to 
> support operations on curves one day. Would likely be a lot of work and 
> probably depends on if JTS does such a move.

No plan on the GEOS side and I haven't heard of a plan on the JTS side
either. Adding Dr.JTS in Cc, just in case he has anything cooking.

--strk; 

  ()   Free GIS & Flash consultant/developer
  /\   http://strk.keybit.net/services.html

From even.rouault at spatialys.com  Tue Nov 11 09:37:02 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 11 Nov 2014 18:37:02 +0100
Subject: [gdal-dev] Global pass to fix issues related to floating point <-->
	string conversions sensitive to locale / LC_NUMERIC
Message-ID: <201411111837.03272.even.rouault@spatialys.com>

Hi,

Just to notify you that with http://trac.osgeo.org/gdal/ticket/5731 I've done 
a global pass on the whole source tree to hopefully address most issues 
related to floating-point <--> string conversions that were sensitive in a lot 
of places to the LC_NUMERIC setting, when it was comma instead of point. Which 
could cause issues when GDAL is integrated into locale-enabled programs like 
QGIS.

There are now variants of standards functions of the printf() family, 
CPLsprintf(), CPLsnprintf(), CPLvsnprintf(), that will output decimal point 
whatever the current locale is.
The already existing similar functions like CPLSPrintf(), 
CPLString::Printf(),vPrintf(), etc... now use those new locale-insensitive 
functions.
There's also a CPLsscanf(), which is currently limited to formatting strings 
with "%lf" in them.
So use of the CPL variants is strongly encouraged when dealing with floating 
point numbers in drivers.

Consequently, I've been able to remove most uses of CPLLocaleC in the source 
tree, which is something that cause issues in multi-threaded context, 
particularly on Windows. The remaining ones are in the interface with proj.4 
(recent proj.4 versions change LC_NUMERIC to C if necessary, but without the 
locking that seems to be needed with recent MSVC, so if we do it from GDAL 
hopefully it should improve things) and the LIBKML driver. The most criticals 
uses of CPLLocaleC were the ones that have been removed in the Open(), 
Create(), CreateCopy(), Identify() methods of the generic driver code. It 
might be necessary to reintroduce it in the few drivers that would need them.

I won't pretend this solves all issues, but hopefully it should solve most. 
Now the autotest suite passes with non-English locale set. Note that this is 
not an absolute guarantee that we consistently write decimal points, since 
outputting floating point numbers with comma and reading them back works OK, 
and will remain undetected, unless tests really check file contents at low-
level. Issues with shapefiles, mapinfo, etc for example were undetected (but 
are now fixed).

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Tue Nov 11 14:07:02 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 11 Nov 2014 23:07:02 +0100
Subject: [gdal-dev] Motion: Adopt RFC 49: Curve geometries
Message-ID: <201411112307.02422.even.rouault@spatialys.com>

Hi,

I think that the points raised in the discussion have been answered.

So:

Motion : I move to adopt RFC 49: Curve geometries

    http://trac.osgeo.org/gdal/wiki/rfc49_curve_geometries

Starting with my +1

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From szekerest at gmail.com  Tue Nov 11 14:18:44 2014
From: szekerest at gmail.com (Tamas Szekeres)
Date: Tue, 11 Nov 2014 23:18:44 +0100
Subject: [gdal-dev] Motion: Adopt RFC 49: Curve geometries
In-Reply-To: <201411112307.02422.even.rouault@spatialys.com>
References: <201411112307.02422.even.rouault@spatialys.com>
Message-ID: <CACALY+SQ_7Ftsm4aEhnN-j+k4O9PvFmL5X4QWkjj9yuOB0x4vQ@mail.gmail.com>

+1

Tamas


2014-11-11 23:07 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:

> Hi,
>
> I think that the points raised in the discussion have been answered.
>
> So:
>
> Motion : I move to adopt RFC 49: Curve geometries
>
>     http://trac.osgeo.org/gdal/wiki/rfc49_curve_geometries
>
> Starting with my +1
>
> Best regards,
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141111/cf94f42f/attachment.html>

From gusevmihs at gmail.com  Wed Nov 12 01:32:38 2014
From: gusevmihs at gmail.com (Mikhail Gusev)
Date: Wed, 12 Nov 2014 13:32:38 +0400
Subject: [gdal-dev] creating graph for single line shape layer using
	gdal gnm
In-Reply-To: <CA+8Q=fBCL1Qz2Jv4yqCza+1FLk6DzK9O1E2KqsmjrpWGTqR_jw@mail.gmail.com>
References: <1415690804698-5172326.post@n6.nabble.com>
	<CAJB43VovDJdoB1Lp_Yai9a33ZJd3eFFZ6+o33yPsNqPfUuQQ9Q@mail.gmail.com>
	<CA+8Q=fBCL1Qz2Jv4yqCza+1FLk6DzK9O1E2KqsmjrpWGTqR_jw@mail.gmail.com>
Message-ID: <CAJB43VqCBQMwjAG=qjtJhvA_dtmrWOD3f2Wdz-FO+O9qtydJcA@mail.gmail.com>

>
> The algorithm is using only the features that are connected manually and
> that are present in _gnm_graph.


No, if you use automatic connection the  _gnm_graph is also formed
automatically because it internally calls ConnectFeatures().

Is there any other simple solution to solve this.
>

It is no other solution for now to solve this. I think in the nearest
future the new algorithm of automatic connection can be written (which
regards only line layers and determines the start and end point of the
lines automatically), I'm working on this now.

2014-11-11 14:48 GMT+04:00 Hema Yeedunuri <hema.yeedunuri at amigooptima.in>:

> hello Mikhail Gusev ,
>
> Thank u for the reply .I want to find  the shortest distance between
> features .But the road layer I am using is having 10055 features. without
> creating graph it is not possible to find shortest distance.And to my
> understanding I think it is difficult to manually connect features to
> create graph. The algorithm is using only the features that are connected
> manually and that are present in _gnm_graph.dbf file.Is there any other
> simple solution to solve this.
>
> thanks,
> hema
>
> On Tue, Nov 11, 2014 at 3:59 PM, Mikhail Gusev <gusevmihs at gmail.com>
> wrote:
>
>> Hello, hema.
>> The current default implementation of GNMNetwork::AutoConnect() can work
>> only if the passing array of layers contains at least one point and one
>> line layer (i.e. GetGeomType() for the layers equals wkbPoint and
>> wkbLineString accordingly). For each line feature the algorithm takes the
>> start and end snapping area formed around the start and end point of the
>> line and searches the points from point layers which are situated inside
>> these two areas. So there is no way for now to connect features of only one
>> line layer automatically. You can use ConnectFeatures() to connect
>> manually, but you will need the features (with any geometry!) to be the
>> source and the target for the connection, while the gnm_roads_line feature
>> will be the connector.
>>
>> 2014-11-11 11:26 GMT+04:00 yhema <hema.yeedunuri at amigooptima.in>:
>>
>>> Hello all,
>>>
>>> I am trying to create a graph for network analysis using gdalgnm.The
>>> feature
>>> auto connect is working if we provide more than one layer.How can we
>>> connect
>>> features of a single layer so that graph is created automatically. We can
>>> connect features using connect features but automatically it is not
>>> conncting using auto connect .Here is the code.
>>>
>>>  char **options = NULL;
>>>     options = CSLAddNameValue(options,GNM_INIT_OPTIONPAIR_NAME,
>>> "roads_network");
>>>
>>>
>>>     GNMGdalNetwork *poNet;
>>>
>>>     poNet =
>>> GNMManager::GdalCreateNetwork("/home/shiva/Desktop/network/network_data",
>>> "ESRI Shapefile", "EPSG:4326", options);
>>>     CSLDestroy(options);
>>>     if (poNet == NULL)
>>>     {
>>>         printf("Failed to create network\n");
>>>         exit(1);
>>>     }
>>>
>>>     GDALDataset *poSrcDS = (GDALDataset*)
>>> GDALOpenEx("/home/shiva/Desktop/network/data",
>>>                                                      GDAL_OF_VECTOR |
>>> GDAL_OF_READONLY, NULL, NULL, NULL );
>>>     if(poSrcDS == NULL)
>>>     {
>>>         printf("Can not open source dataset at\n");
>>>         exit(1);
>>>     }
>>>
>>>     OGRLayer *poSrcLayer2 = poSrcDS->GetLayerByName("roads");
>>>     if (poSrcLayer2 == NULL)
>>>     {
>>>         printf("layer is null\n");
>>>         printf("Can not process layers of source dataset\n");
>>>         exit(1);
>>>     }
>>>
>>>     GNMErr err2 = poNet->CopyLayer(poSrcLayer2, "roads");
>>>     if (err2 != GNMERR_NONE)
>>>     {
>>>         printf("Can not import layers from source dataset\n");
>>>         exit(1);
>>>     }
>>>
>>>     GDALClose(poSrcDS);
>>>
>>>
>>>     if (poNet->CreateRule("CLASS gnm_roads_line COSTS TIGER_ID") !=
>>> GNMERR_NONE)
>>>     {
>>>         printf("Can not create rule\n");
>>>     }
>>>
>>>     if (poNet->CreateRule("NETWORK CONNECTS gnm_roads_line WITH
>>> gnm_roads_line  ") != GNMERR_NONE)
>>>     {
>>>         printf("Can not create rule\n");
>>>     }
>>>
>>>
>>>     printf("\nBuilding network topology ...\n");
>>>     GDALDataset *poNetDS = poNet->GetDataset();
>>>     OGRLayer **layers = new OGRLayer*[3];
>>>
>>>     layers[0] = poNetDS->GetLayerByName("gnm_roads_line");
>>>     layers[2] = NULL;
>>>     layers[1] = NULL;
>>>
>>>
>>>     if (poNet->AutoConnect(layers,0.05, NULL) != GNMERR_NONE)
>>>     {
>>>         printf("Building topology failed\n");
>>>         exit(1);
>>>     }
>>>     else
>>>     {
>>>         printf("Topology has been built successfully\n");
>>>     }
>>>
>>>     delete[] layers;
>>>
>>>
>>>         GNMManager::GdalCloseNetwork(poNet);
>>>
>>>
>>>
>>>
>>> thanks,
>>> hema
>>>
>>>
>>>
>>> --
>>> View this message in context:
>>> http://osgeo-org.1560.x6.nabble.com/creating-graph-for-single-line-shape-layer-using-gdal-gnm-tp5172326.html
>>> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141112/332556e5/attachment.html>

From jukka.rahkonen at mmmtike.fi  Wed Nov 12 01:44:21 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Wed, 12 Nov 2014 09:44:21 +0000 (UTC)
Subject: [gdal-dev] Motion: Adopt RFC 49: Curve geometries
References: <201411112307.02422.even.rouault@spatialys.com>
Message-ID: <loom.20141112T095212-31@post.gmane.org>

Even Rouault <even.rouault <at> spatialys.com> writes:

> 
> Hi,
> 
> I think that the points raised in the discussion have been answered.
> 
> So:
> 
> Motion : I move to adopt RFC 49: Curve geometries
> 
>     http://trac.osgeo.org/gdal/wiki/rfc49_curve_geometries
> 
> Starting with my +1


+1 

-Jukka-


From jukka.rahkonen at mmmtike.fi  Wed Nov 12 02:08:07 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Wed, 12 Nov 2014 10:08:07 +0000 (UTC)
Subject: [gdal-dev]
	=?utf-8?q?Global_pass_to_fix_issues_related_to_floatin?=
	=?utf-8?q?g_point_=3C--=3E=09string_conversions_sensitive_to_local?=
	=?utf-8?q?e_/_LC=5FNUMERIC?=
References: <201411111837.03272.even.rouault@spatialys.com>
Message-ID: <loom.20141112T110550-425@post.gmane.org>

Even Rouault <even.rouault <at> spatialys.com> writes:

> 
> Hi,
> 
> Just to notify you that with http://trac.osgeo.org/gdal/ticket/5731 I've done 
> a global pass on the whole source tree to hopefully address most issues 
> related to floating-point <--> string conversions that were sensitive in a
lot 
> of places to the LC_NUMERIC setting, when it was comma instead of point.
Which 
> could cause issues when GDAL is integrated into locale-enabled programs like 
> QGIS.

Huge work, much appreciated.

-Jukka with Finnish locale


From hema.yeedunuri at amigooptima.in  Wed Nov 12 02:28:19 2014
From: hema.yeedunuri at amigooptima.in (yhema)
Date: Wed, 12 Nov 2014 02:28:19 -0800 (PST)
Subject: [gdal-dev] creating graph for single line shape layer using
	gdal gnm
In-Reply-To: <CAJB43VqCBQMwjAG=qjtJhvA_dtmrWOD3f2Wdz-FO+O9qtydJcA@mail.gmail.com>
References: <1415690804698-5172326.post@n6.nabble.com>
	<CAJB43VovDJdoB1Lp_Yai9a33ZJd3eFFZ6+o33yPsNqPfUuQQ9Q@mail.gmail.com>
	<CA+8Q=fBCL1Qz2Jv4yqCza+1FLk6DzK9O1E2KqsmjrpWGTqR_jw@mail.gmail.com>
	<CAJB43VqCBQMwjAG=qjtJhvA_dtmrWOD3f2Wdz-FO+O9qtydJcA@mail.gmail.com>
Message-ID: <CA+8Q=fCtbMkwNVWnFyQoVGVwVyeSq=DtvWA+89MfJqy5dn5q5w@mail.gmail.com>

hello Mikhail Gusev ,

Is it correct to do this way?First I will save point layer using start and
end points of line  layer.Again then connect the two layers using
autoconnect method . So that I can find shortest path between features of
the line layer.

thanks,
hema

On Wed, Nov 12, 2014 at 3:03 PM, ?????? ????? [via OSGeo.org] <
ml-node+s1560n5172509h97 at n6.nabble.com> wrote:

> The algorithm is using only the features that are connected manually and
>> that are present in _gnm_graph.
>
>
> No, if you use automatic connection the  _gnm_graph is also formed
> automatically because it internally calls ConnectFeatures().
>
> Is there any other simple solution to solve this.
>>
>
> It is no other solution for now to solve this. I think in the nearest
> future the new algorithm of automatic connection can be written (which
> regards only line layers and determines the start and end point of the
> lines automatically), I'm working on this now.
>
> 2014-11-11 14:48 GMT+04:00 Hema Yeedunuri <[hidden email]
> <http://user/SendEmail.jtp?type=node&node=5172509&i=0>>:
>
>> hello Mikhail Gusev ,
>>
>> Thank u for the reply .I want to find  the shortest distance between
>> features .But the road layer I am using is having 10055 features. without
>> creating graph it is not possible to find shortest distance.And to my
>> understanding I think it is difficult to manually connect features to
>> create graph. The algorithm is using only the features that are connected
>> manually and that are present in _gnm_graph.dbf file.Is there any other
>> simple solution to solve this.
>>
>> thanks,
>> hema
>>
>> On Tue, Nov 11, 2014 at 3:59 PM, Mikhail Gusev <[hidden email]
>> <http://user/SendEmail.jtp?type=node&node=5172509&i=1>> wrote:
>>
>>> Hello, hema.
>>> The current default implementation of GNMNetwork::AutoConnect() can work
>>> only if the passing array of layers contains at least one point and one
>>> line layer (i.e. GetGeomType() for the layers equals wkbPoint and
>>> wkbLineString accordingly). For each line feature the algorithm takes the
>>> start and end snapping area formed around the start and end point of the
>>> line and searches the points from point layers which are situated inside
>>> these two areas. So there is no way for now to connect features of only one
>>> line layer automatically. You can use ConnectFeatures() to connect
>>> manually, but you will need the features (with any geometry!) to be the
>>> source and the target for the connection, while the gnm_roads_line feature
>>> will be the connector.
>>>
>>> 2014-11-11 11:26 GMT+04:00 yhema <[hidden email]
>>> <http://user/SendEmail.jtp?type=node&node=5172509&i=2>>:
>>>
>>>> Hello all,
>>>>
>>>> I am trying to create a graph for network analysis using gdalgnm.The
>>>> feature
>>>> auto connect is working if we provide more than one layer.How can we
>>>> connect
>>>> features of a single layer so that graph is created automatically. We
>>>> can
>>>> connect features using connect features but automatically it is not
>>>> conncting using auto connect .Here is the code.
>>>>
>>>>  char **options = NULL;
>>>>     options = CSLAddNameValue(options,GNM_INIT_OPTIONPAIR_NAME,
>>>> "roads_network");
>>>>
>>>>
>>>>     GNMGdalNetwork *poNet;
>>>>
>>>>     poNet =
>>>>
>>>> GNMManager::GdalCreateNetwork("/home/shiva/Desktop/network/network_data",
>>>> "ESRI Shapefile", "EPSG:4326", options);
>>>>     CSLDestroy(options);
>>>>     if (poNet == NULL)
>>>>     {
>>>>         printf("Failed to create network\n");
>>>>         exit(1);
>>>>     }
>>>>
>>>>     GDALDataset *poSrcDS = (GDALDataset*)
>>>> GDALOpenEx("/home/shiva/Desktop/network/data",
>>>>                                                      GDAL_OF_VECTOR |
>>>> GDAL_OF_READONLY, NULL, NULL, NULL );
>>>>     if(poSrcDS == NULL)
>>>>     {
>>>>         printf("Can not open source dataset at\n");
>>>>         exit(1);
>>>>     }
>>>>
>>>>     OGRLayer *poSrcLayer2 = poSrcDS->GetLayerByName("roads");
>>>>     if (poSrcLayer2 == NULL)
>>>>     {
>>>>         printf("layer is null\n");
>>>>         printf("Can not process layers of source dataset\n");
>>>>         exit(1);
>>>>     }
>>>>
>>>>     GNMErr err2 = poNet->CopyLayer(poSrcLayer2, "roads");
>>>>     if (err2 != GNMERR_NONE)
>>>>     {
>>>>         printf("Can not import layers from source dataset\n");
>>>>         exit(1);
>>>>     }
>>>>
>>>>     GDALClose(poSrcDS);
>>>>
>>>>
>>>>     if (poNet->CreateRule("CLASS gnm_roads_line COSTS TIGER_ID") !=
>>>> GNMERR_NONE)
>>>>     {
>>>>         printf("Can not create rule\n");
>>>>     }
>>>>
>>>>     if (poNet->CreateRule("NETWORK CONNECTS gnm_roads_line WITH
>>>> gnm_roads_line  ") != GNMERR_NONE)
>>>>     {
>>>>         printf("Can not create rule\n");
>>>>     }
>>>>
>>>>
>>>>     printf("\nBuilding network topology ...\n");
>>>>     GDALDataset *poNetDS = poNet->GetDataset();
>>>>     OGRLayer **layers = new OGRLayer*[3];
>>>>
>>>>     layers[0] = poNetDS->GetLayerByName("gnm_roads_line");
>>>>     layers[2] = NULL;
>>>>     layers[1] = NULL;
>>>>
>>>>
>>>>     if (poNet->AutoConnect(layers,0.05, NULL) != GNMERR_NONE)
>>>>     {
>>>>         printf("Building topology failed\n");
>>>>         exit(1);
>>>>     }
>>>>     else
>>>>     {
>>>>         printf("Topology has been built successfully\n");
>>>>     }
>>>>
>>>>     delete[] layers;
>>>>
>>>>
>>>>         GNMManager::GdalCloseNetwork(poNet);
>>>>
>>>>
>>>>
>>>>
>>>> thanks,
>>>> hema
>>>>
>>>>
>>>>
>>>> --
>>>> View this message in context:
>>>> http://osgeo-org.1560.x6.nabble.com/creating-graph-for-single-line-shape-layer-using-gdal-gnm-tp5172326.html
>>>> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> [hidden email] <http://user/SendEmail.jtp?type=node&node=5172509&i=3>
>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>
>>>
>>>
>>
>
> _______________________________________________
> gdal-dev mailing list
> [hidden email] <http://user/SendEmail.jtp?type=node&node=5172509&i=4>
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> ------------------------------
>  If you reply to this email, your message will be added to the discussion
> below:
>
> http://osgeo-org.1560.x6.nabble.com/creating-graph-for-single-line-shape-layer-using-gdal-gnm-tp5172326p5172509.html
>  To unsubscribe from creating graph for single line shape layer using gdal
> gnm, click here
> <http://osgeo-org.1560.x6.nabble.com/template/NamlServlet.jtp?macro=unsubscribe_by_code&node=5172326&code=aGVtYS55ZWVkdW51cmlAYW1pZ29vcHRpbWEuaW58NTE3MjMyNnwtMTkzNTEyNzE5Nw==>
> .
> NAML
> <http://osgeo-org.1560.x6.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&id=instant_html%21nabble%3Aemail.naml&base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.NodeNamespace&breadcrumbs=notify_subscribers%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml>
>




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/creating-graph-for-single-line-shape-layer-using-gdal-gnm-tp5172326p5172529.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141112/d5cb5e70/attachment-0001.html>

From alami.samy at gmail.com  Wed Nov 12 08:53:47 2014
From: alami.samy at gmail.com (Samy Alami)
Date: Wed, 12 Nov 2014 17:53:47 +0100
Subject: [gdal-dev] cannot unsubscribe the mailing list
Message-ID: <CAJBL701wCwoakxsYXjTjW0N-b3KOw+4QgBeR1SERVCjput9uew@mail.gmail.com>

Hello,

I tried to unsubscribe the mailing list but I never received the email to
physically unsubscribe.

Any help ?

-- 
*Samy*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141112/647c3e48/attachment.html>

From gusevmihs at gmail.com  Wed Nov 12 13:52:23 2014
From: gusevmihs at gmail.com (Mikhail Gusev)
Date: Thu, 13 Nov 2014 01:52:23 +0400
Subject: [gdal-dev] creating graph for single line shape layer using
	gdal gnm
In-Reply-To: <CA+8Q=fCtbMkwNVWnFyQoVGVwVyeSq=DtvWA+89MfJqy5dn5q5w@mail.gmail.com>
References: <1415690804698-5172326.post@n6.nabble.com>
	<CAJB43VovDJdoB1Lp_Yai9a33ZJd3eFFZ6+o33yPsNqPfUuQQ9Q@mail.gmail.com>
	<CA+8Q=fBCL1Qz2Jv4yqCza+1FLk6DzK9O1E2KqsmjrpWGTqR_jw@mail.gmail.com>
	<CAJB43VqCBQMwjAG=qjtJhvA_dtmrWOD3f2Wdz-FO+O9qtydJcA@mail.gmail.com>
	<CA+8Q=fCtbMkwNVWnFyQoVGVwVyeSq=DtvWA+89MfJqy5dn5q5w@mail.gmail.com>
Message-ID: <CAJB43VqvypVjQZuhBhFL+Jz--7KHubRu91zAQgWTzXGQ7pKNRA@mail.gmail.com>

>
> Is it correct to do this way?First I will save point layer using start and
> end points of line  layer.Again then connect the two layers using
> autoconnect method . So that I can find shortest path between features of
> the line layer.
>

hema,
yes it's correct, but note, that there must be only one point in a junction
of two line ends in order the connection will be made correct.

2014-11-12 14:28 GMT+04:00 yhema <hema.yeedunuri at amigooptima.in>:

> hello Mikhail Gusev ,
>
> Is it correct to do this way?First I will save point layer using start and
> end points of line  layer.Again then connect the two layers using
> autoconnect method . So that I can find shortest path between features of
> the line layer.
>
> thanks,
> hema
>
> On Wed, Nov 12, 2014 at 3:03 PM, ?????? ????? [via OSGeo.org] <[hidden
> email] <http://user/SendEmail.jtp?type=node&node=5172529&i=0>> wrote:
>
>> The algorithm is using only the features that are connected manually and
>>> that are present in _gnm_graph.
>>
>>
>> No, if you use automatic connection the  _gnm_graph is also formed
>> automatically because it internally calls ConnectFeatures().
>>
>> Is there any other simple solution to solve this.
>>>
>>
>> It is no other solution for now to solve this. I think in the nearest
>> future the new algorithm of automatic connection can be written (which
>> regards only line layers and determines the start and end point of the
>> lines automatically), I'm working on this now.
>>
>> 2014-11-11 14:48 GMT+04:00 Hema Yeedunuri <[hidden email]
>> <http://user/SendEmail.jtp?type=node&node=5172509&i=0>>:
>>
>>> hello Mikhail Gusev ,
>>>
>>> Thank u for the reply .I want to find  the shortest distance between
>>> features .But the road layer I am using is having 10055 features. without
>>> creating graph it is not possible to find shortest distance.And to my
>>> understanding I think it is difficult to manually connect features to
>>> create graph. The algorithm is using only the features that are connected
>>> manually and that are present in _gnm_graph.dbf file.Is there any other
>>> simple solution to solve this.
>>>
>>> thanks,
>>> hema
>>>
>>> On Tue, Nov 11, 2014 at 3:59 PM, Mikhail Gusev <[hidden email]
>>> <http://user/SendEmail.jtp?type=node&node=5172509&i=1>> wrote:
>>>
>>>> Hello, hema.
>>>> The current default implementation of GNMNetwork::AutoConnect() can
>>>> work only if the passing array of layers contains at least one point and
>>>> one line layer (i.e. GetGeomType() for the layers equals wkbPoint and
>>>> wkbLineString accordingly). For each line feature the algorithm takes the
>>>> start and end snapping area formed around the start and end point of the
>>>> line and searches the points from point layers which are situated inside
>>>> these two areas. So there is no way for now to connect features of only one
>>>> line layer automatically. You can use ConnectFeatures() to connect
>>>> manually, but you will need the features (with any geometry!) to be the
>>>> source and the target for the connection, while the gnm_roads_line feature
>>>> will be the connector.
>>>>
>>>> 2014-11-11 11:26 GMT+04:00 yhema <[hidden email]
>>>> <http://user/SendEmail.jtp?type=node&node=5172509&i=2>>:
>>>>
>>>>> Hello all,
>>>>>
>>>>> I am trying to create a graph for network analysis using gdalgnm.The
>>>>> feature
>>>>> auto connect is working if we provide more than one layer.How can we
>>>>> connect
>>>>> features of a single layer so that graph is created automatically. We
>>>>> can
>>>>> connect features using connect features but automatically it is not
>>>>> conncting using auto connect .Here is the code.
>>>>>
>>>>>  char **options = NULL;
>>>>>     options = CSLAddNameValue(options,GNM_INIT_OPTIONPAIR_NAME,
>>>>> "roads_network");
>>>>>
>>>>>
>>>>>     GNMGdalNetwork *poNet;
>>>>>
>>>>>     poNet =
>>>>>
>>>>> GNMManager::GdalCreateNetwork("/home/shiva/Desktop/network/network_data",
>>>>> "ESRI Shapefile", "EPSG:4326", options);
>>>>>     CSLDestroy(options);
>>>>>     if (poNet == NULL)
>>>>>     {
>>>>>         printf("Failed to create network\n");
>>>>>         exit(1);
>>>>>     }
>>>>>
>>>>>     GDALDataset *poSrcDS = (GDALDataset*)
>>>>> GDALOpenEx("/home/shiva/Desktop/network/data",
>>>>>                                                      GDAL_OF_VECTOR |
>>>>> GDAL_OF_READONLY, NULL, NULL, NULL );
>>>>>     if(poSrcDS == NULL)
>>>>>     {
>>>>>         printf("Can not open source dataset at\n");
>>>>>         exit(1);
>>>>>     }
>>>>>
>>>>>     OGRLayer *poSrcLayer2 = poSrcDS->GetLayerByName("roads");
>>>>>     if (poSrcLayer2 == NULL)
>>>>>     {
>>>>>         printf("layer is null\n");
>>>>>         printf("Can not process layers of source dataset\n");
>>>>>         exit(1);
>>>>>     }
>>>>>
>>>>>     GNMErr err2 = poNet->CopyLayer(poSrcLayer2, "roads");
>>>>>     if (err2 != GNMERR_NONE)
>>>>>     {
>>>>>         printf("Can not import layers from source dataset\n");
>>>>>         exit(1);
>>>>>     }
>>>>>
>>>>>     GDALClose(poSrcDS);
>>>>>
>>>>>
>>>>>     if (poNet->CreateRule("CLASS gnm_roads_line COSTS TIGER_ID") !=
>>>>> GNMERR_NONE)
>>>>>     {
>>>>>         printf("Can not create rule\n");
>>>>>     }
>>>>>
>>>>>     if (poNet->CreateRule("NETWORK CONNECTS gnm_roads_line WITH
>>>>> gnm_roads_line  ") != GNMERR_NONE)
>>>>>     {
>>>>>         printf("Can not create rule\n");
>>>>>     }
>>>>>
>>>>>
>>>>>     printf("\nBuilding network topology ...\n");
>>>>>     GDALDataset *poNetDS = poNet->GetDataset();
>>>>>     OGRLayer **layers = new OGRLayer*[3];
>>>>>
>>>>>     layers[0] = poNetDS->GetLayerByName("gnm_roads_line");
>>>>>     layers[2] = NULL;
>>>>>     layers[1] = NULL;
>>>>>
>>>>>
>>>>>     if (poNet->AutoConnect(layers,0.05, NULL) != GNMERR_NONE)
>>>>>     {
>>>>>         printf("Building topology failed\n");
>>>>>         exit(1);
>>>>>     }
>>>>>     else
>>>>>     {
>>>>>         printf("Topology has been built successfully\n");
>>>>>     }
>>>>>
>>>>>     delete[] layers;
>>>>>
>>>>>
>>>>>         GNMManager::GdalCloseNetwork(poNet);
>>>>>
>>>>>
>>>>>
>>>>>
>>>>> thanks,
>>>>> hema
>>>>>
>>>>>
>>>>>
>>>>> --
>>>>> View this message in context:
>>>>> http://osgeo-org.1560.x6.nabble.com/creating-graph-for-single-line-shape-layer-using-gdal-gnm-tp5172326.html
>>>>> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>>>>> _______________________________________________
>>>>> gdal-dev mailing list
>>>>> [hidden email] <http://user/SendEmail.jtp?type=node&node=5172509&i=3>
>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>>
>>>>
>>>>
>>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> [hidden email] <http://user/SendEmail.jtp?type=node&node=5172509&i=4>
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>> ------------------------------
>>  If you reply to this email, your message will be added to the
>> discussion below:
>>
>> http://osgeo-org.1560.x6.nabble.com/creating-graph-for-single-line-shape-layer-using-gdal-gnm-tp5172326p5172509.html
>>  To unsubscribe from creating graph for single line shape layer using
>> gdal gnm, click here.
>> NAML
>> <http://osgeo-org.1560.x6.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&id=instant_html%21nabble%3Aemail.naml&base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.NodeNamespace&breadcrumbs=notify_subscribers%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml>
>>
>
>
> ------------------------------
> View this message in context: Re: creating graph for single line shape
> layer using gdal gnm
> <http://osgeo-org.1560.x6.nabble.com/creating-graph-for-single-line-shape-layer-using-gdal-gnm-tp5172326p5172529.html>
>
> Sent from the GDAL - Dev mailing list archive
> <http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html> at
> Nabble.com.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141113/b6c2f9a6/attachment.html>

From jukka.rahkonen at mmmtike.fi  Thu Nov 13 00:26:53 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Thu, 13 Nov 2014 08:26:53 +0000 (UTC)
Subject: [gdal-dev]
	=?utf-8?q?creating_graph_for_single_line_shape_layer_u?=
	=?utf-8?q?sing=09gdal_gnm?=
References: <1415690804698-5172326.post@n6.nabble.com>
	<CAJB43VovDJdoB1Lp_Yai9a33ZJd3eFFZ6+o33yPsNqPfUuQQ9Q@mail.gmail.com>
	<CA+8Q=fBCL1Qz2Jv4yqCza+1FLk6DzK9O1E2KqsmjrpWGTqR_jw@mail.gmail.com>
	<CAJB43VqCBQMwjAG=qjtJhvA_dtmrWOD3f2Wdz-FO+O9qtydJcA@mail.gmail.com>
	<CA+8Q=fCtbMkwNVWnFyQoVGVwVyeSq=DtvWA+89MfJqy5dn5q5w@mail.gmail.com>
	<CAJB43VqvypVjQZuhBhFL+Jz--7KHubRu91zAQgWTzXGQ7pKNRA@mail.gmail.com>
Message-ID: <loom.20141113T092419-46@post.gmane.org>

Mikhail Gusev <gusevmihs <at> gmail.com> writes:


> 
> Is it correct to do this way?First I will save point layer using 
> start and end points of line? layer.Again then connect the two layers 
> using autoconnect method . So that I can find shortest path between 
> features of the line layer.
> 
> hema,
> yes it's correct, but note, that there must be only one point in a
junction of two line ends in order the connection will be made correct. 


Hi,

You can create such point shapefile from a line shapefile with ogr2ogr by
utilizing Spatialite:

ogr2ogr -f "ESRI Shapefile" nodes.shp lines.shp -dialect sqlite -sql "SELECT
ST_StartPoint(geometry) AS node_geometry FROM lines UNION SELECT
ST_EndPoint(geometry) AS node_geometry FROM lines"

-Jukka Rahkonen-


From gdal at zeidlers.de  Thu Nov 13 08:47:26 2014
From: gdal at zeidlers.de (Julian Zeidler)
Date: Thu, 13 Nov 2014 17:47:26 +0100
Subject: [gdal-dev] Filelimit /vsizip
Message-ID: <5464E09E.3080401@zeidlers.de>

Hi all,
I am wondering if there is an inherent Filelimit in the /vsizip virtual 
Interface (or potentially ENVI Format)
I am trying to concurrently open a lot (>600) ENVI Files, which are 
inside single image zip Files via the /vsizip interface.
Whenever i hit the Limit of exactly 510 images I get an:
"ERROR 4: Failed to re-open 
/vsizip//mnt/data1/download_asar/ASA_WSM_1PNPDE20110731_205400_000002143105_00100_49252_3499.zip/ASA_WSM_1PNPDE20110731_205400_000002143105_00100_49252_3499.data/Sigma0_VV.img 
within ENVI driver."
I am running gdal 1.9.0 on a Debian Linux from within a c++ Programm

Is there any way to increase this Limit? Preferably without having to 
recompile gdal, as i do not have Admin rights on the servers it runs on?

Thanks
Julian

From even.rouault at spatialys.com  Thu Nov 13 09:30:29 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 13 Nov 2014 18:30:29 +0100
Subject: [gdal-dev] Filelimit /vsizip
In-Reply-To: <5464E09E.3080401@zeidlers.de>
References: <5464E09E.3080401@zeidlers.de>
Message-ID: <201411131830.29572.even.rouault@spatialys.com>

Le jeudi 13 novembre 2014 17:47:26, Julian Zeidler a ?crit :
> Hi all,
> I am wondering if there is an inherent Filelimit in the /vsizip virtual
> Interface (or potentially ENVI Format)
> I am trying to concurrently open a lot (>600) ENVI Files, which are
> inside single image zip Files via the /vsizip interface.
> Whenever i hit the Limit of exactly 510 images I get an:

Julian,

2 * 510 = 1020 < 1024, the default maximum number of files that can be opened 
simultaneously by a Linux process. The 2 factor comes from the fact that a 
ENVI dataset is made of an .img and .hdr file.
So nothing GDAL can do about that.
If you had admin rights, you could raise the limit with ulimit -n
Otherwise you will just have to avoid opening so many files at the same time.

An optimization in the ENVI driver could likely be done to close the .hdr file 
once we have read it. But that would raise the limit "just" up to 1000 
datasets.

Well, one option would be to use the GDALProxyPoolDataset mechanism, but this 
is a rather advanced/internal/undocumented feature used by the VRT driver to 
be able to deal with an arbitrary number of sources. If you badly need it, you 
may study gcore/gdal_proxy.h and look how it used by frmts/vrt/vrtsources.cpp.

Even

> "ERROR 4: Failed to re-open
> /vsizip//mnt/data1/download_asar/ASA_WSM_1PNPDE20110731_205400_000002143105
> _00100_49252_3499.zip/ASA_WSM_1PNPDE20110731_205400_000002143105_00100_4925
> 2_3499.data/Sigma0_VV.img within ENVI driver."
> I am running gdal 1.9.0 on a Debian Linux from within a c++ Programm
> 
> Is there any way to increase this Limit? Preferably without having to
> recompile gdal, as i do not have Admin rights on the servers it runs on?
> 
> Thanks
> Julian
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gdal at zeidlers.de  Fri Nov 14 02:06:35 2014
From: gdal at zeidlers.de (Julian Zeidler)
Date: Fri, 14 Nov 2014 11:06:35 +0100
Subject: [gdal-dev] Filelimit /vsizip
In-Reply-To: <201411131830.29572.even.rouault@spatialys.com>
References: <5464E09E.3080401@zeidlers.de>
	<201411131830.29572.even.rouault@spatialys.com>
Message-ID: <5465D42B.1010703@zeidlers.de>

Hi Even,

Thanks to the reply.
I did not consider it an underlying Linux Problem, as I was opening 
vrts. with 6000+ Files without a Problem.
Thanks for the Info. I will look into having the Limit increased or in 
the Long run using the GDALProxyPoolDataset mechanism .
Julian

Am 13.11.2014 18:30, schrieb Even Rouault:
> Le jeudi 13 novembre 2014 17:47:26, Julian Zeidler a ?crit :
>> Hi all,
>> I am wondering if there is an inherent Filelimit in the /vsizip virtual
>> Interface (or potentially ENVI Format)
>> I am trying to concurrently open a lot (>600) ENVI Files, which are
>> inside single image zip Files via the /vsizip interface.
>> Whenever i hit the Limit of exactly 510 images I get an:
> Julian,
>
> 2 * 510 = 1020 < 1024, the default maximum number of files that can be opened
> simultaneously by a Linux process. The 2 factor comes from the fact that a
> ENVI dataset is made of an .img and .hdr file.
> So nothing GDAL can do about that.
> If you had admin rights, you could raise the limit with ulimit -n
> Otherwise you will just have to avoid opening so many files at the same time.
>
> An optimization in the ENVI driver could likely be done to close the .hdr file
> once we have read it. But that would raise the limit "just" up to 1000
> datasets.
>
> Well, one option would be to use the GDALProxyPoolDataset mechanism, but this
> is a rather advanced/internal/undocumented feature used by the VRT driver to
> be able to deal with an arbitrary number of sources. If you badly need it, you
> may study gcore/gdal_proxy.h and look how it used by frmts/vrt/vrtsources.cpp.
>
> Even
>
>> "ERROR 4: Failed to re-open
>> /vsizip//mnt/data1/download_asar/ASA_WSM_1PNPDE20110731_205400_000002143105
>> _00100_49252_3499.zip/ASA_WSM_1PNPDE20110731_205400_000002143105_00100_4925
>> 2_3499.data/Sigma0_VV.img within ENVI driver."
>> I am running gdal 1.9.0 on a Debian Linux from within a c++ Programm
>>
>> Is there any way to increase this Limit? Preferably without having to
>> recompile gdal, as i do not have Admin rights on the servers it runs on?
>>
>> Thanks
>> Julian
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From orante.tucceri at exprivia.it  Fri Nov 14 02:20:04 2014
From: orante.tucceri at exprivia.it (deve)
Date: Fri, 14 Nov 2014 02:20:04 -0800 (PST)
Subject: [gdal-dev] Associate single point coordinates to image.
Message-ID: <1415960404844-5172985.post@n6.nabble.com>

Is possible to georefence a single point in image?E.g. Action Diagram: 1)
central point (center <-> X,Y) is georeferenced (center <-> lat,lon);  2) an
image loader read center coordinates (lat,lon) 3) the loader place image in
map point (lat,lon).4) result: tag a location with involved screenshot Tnx



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Associate-single-point-coordinates-to-image-tp5172985.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141114/edf57889/attachment.html>

From even.rouault at spatialys.com  Fri Nov 14 02:56:09 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 14 Nov 2014 11:56:09 +0100
Subject: [gdal-dev] Motion: Adopt RFC 49: Curve geometries
In-Reply-To: <201411112307.02422.even.rouault@spatialys.com>
References: <201411112307.02422.even.rouault@spatialys.com>
Message-ID: <201411141156.09844.even.rouault@spatialys.com>

> Motion : I move to adopt RFC 49: Curve geometries
> 
>     http://trac.osgeo.org/gdal/wiki/rfc49_curve_geometries
> 
> Starting with my +1

I declare this motion passed with support from TamasS, JukkaR and myself. I 
will proceed soon in merging the implementation into trunk.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at mmmtike.fi  Fri Nov 14 03:32:35 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Fri, 14 Nov 2014 11:32:35 +0000 (UTC)
Subject: [gdal-dev] Associate single point coordinates to image.
References: <1415960404844-5172985.post@n6.nabble.com>
Message-ID: <loom.20141114T123013-783@post.gmane.org>

deve <orante.tucceri <at> exprivia.it> writes:

> 
> 
> Is possible to georefence a single point in image?
> 
> E.g. Action Diagram:
>  1) central point (center  X,Y) is georeferenced (center  lat,lon); 
>  2) an image loader read center coordinates (lat,lon)
>  3) the loader place image in map point (lat,lon).
> 4) result: tag a location with involved screenshot 

Hi,

How about using standard EXIF latitude and longitude tags and tools like in
http://readexifdata.com/?

-Jukka Rahkonen-




From orante.tucceri at exprivia.it  Fri Nov 14 03:38:51 2014
From: orante.tucceri at exprivia.it (deve)
Date: Fri, 14 Nov 2014 03:38:51 -0800 (PST)
Subject: [gdal-dev] Associate single point coordinates to image.
In-Reply-To: <loom.20141114T123013-783@post.gmane.org>
References: <1415960404844-5172985.post@n6.nabble.com>
	<loom.20141114T123013-783@post.gmane.org>
Message-ID: <1415965131621-5173000.post@n6.nabble.com>

Yes. The final effect is the same: photo--> location-->image over the map.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Associate-single-point-coordinates-to-image-tp5172985p5173000.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From stefan.ziegler.de at gmail.com  Fri Nov 14 06:10:10 2014
From: stefan.ziegler.de at gmail.com (Stefan Ziegler)
Date: Fri, 14 Nov 2014 15:10:10 +0100
Subject: [gdal-dev] Interlis driver does not polygonize anymore
Message-ID: <CAJvo+198nz1Wmq69v7pNuziJeFtGbwMUqOczh=6Be-QnNQOKhg@mail.gmail.com>

Hi

I've got some problems with the interlis driver. When I try to convert an
interlis 1 file to shapefiles with the following command:

ogr2ogr shpdir/ 254900/254900.itf,dm01avso24.imd

There are no polygon shapes created. It seems that the point coordinates -
which are stored in two separate columns - are shifted.

Column "Geometrie_" contains a small double value. Column "Geometrie_1"
contains one coordinate. Column "Qualitaet" contains the second coordinate.

Same behaviour with gdal 1.11 and some older master.

regards
Stefan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141114/fae30e3c/attachment.html>

From even.rouault at spatialys.com  Fri Nov 14 06:23:59 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 14 Nov 2014 15:23:59 +0100
Subject: [gdal-dev] Interlis driver does not polygonize anymore
In-Reply-To: <CAJvo+198nz1Wmq69v7pNuziJeFtGbwMUqOczh=6Be-QnNQOKhg@mail.gmail.com>
References: <CAJvo+198nz1Wmq69v7pNuziJeFtGbwMUqOczh=6Be-QnNQOKhg@mail.gmail.com>
Message-ID: <201411141523.59514.even.rouault@spatialys.com>

Stefan,

> 
> I've got some problems with the interlis driver. When I try to convert an
> interlis 1 file to shapefiles with the following command:
> 
> ogr2ogr shpdir/ 254900/254900.itf,dm01avso24.imd
> 
> There are no polygon shapes created. It seems that the point coordinates -
> which are stored in two separate columns - are shifted.

The driver now supports multiple geometry columns since GDAL 1.11. On the example in the GDAL autotest, it appears that the point geometry column is declared before the second geometry column, so 
you'll get only the point when translating to shapefile, unless you explicitely specify the polygon geometry column (look at its name with ogrinfo)

With the sample in autotest :
ogr2ogr out.shp data/ili/Beispiel.itf,data/ili/Beispiel.imd Bodenbedeckung__BoFlaechen -overwrite -select Form

> 
> Column "Geometrie_" contains a small double value. Column "Geometrie_1"
> contains one coordinate. Column "Qualitaet" contains the second coordinate.

Not sure about that. Maybe Pirmin has an idea. A sample dataset of yours might be needed.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From andre.vautour at caris.com  Fri Nov 14 07:57:03 2014
From: andre.vautour at caris.com (Andre Vautour)
Date: Fri, 14 Nov 2014 11:57:03 -0400
Subject: [gdal-dev] Original FID for SQLite dialect
Message-ID: <5466264F.6060400@caris.com>

Hi all,

I was wondering if there is a way to get at the original feature id when 
executing an SQL query for the SQLite dialect. Something similar to what 
is described in http://www.gdal.org/ogr_sql.html for FID for the OGR 
dialect.

That is, is there something equivalent to the following for the SQLite 
dialect:
ogrinfo -sql "SELECT FID, * from SomeLayerName where ..." someFile.ext

Keep in mind that what I am after is the original feature id of the 
layer of the data source, not the id in the resulting SQL layer.

Thanks,
Andr?

From mccorb at cox.net  Fri Nov 14 08:26:07 2014
From: mccorb at cox.net (mccorb)
Date: Fri, 14 Nov 2014 08:26:07 -0800 (PST)
Subject: [gdal-dev] shapefile polygon/multipolygon ordering
Message-ID: <1415982367141-5173074.post@n6.nabble.com>

I used GDAL to create a new shapefile of polygons. 

The polygons (multi-polygons) were land areas. Some of the land areas had
holes defined which were lakes within the land area. Within the lakes there
were some islands of land...so I had a polygon with a hole with more
polygons.

When I created the shapefile and saved it, it re-ordered the polygons so
that all the land polygons preceded all the hole polygons (within a single
multi-polygon). Although it worked ok for the computations I was doing, it
drew the polygons in the wrong order so that it drew the main land polygon,
then the islands, then the lakes which then obscured the islands.

I don't really know what the shapefile specification says about this but it
seems as though whoever did the shapefile writer for GDAL actually had to
expend extra effort to rearrange the polygons in this manner. 

Two questions:
1. Is it within the shapefile specification to have polygons that have holes
that have polygons?
2. Does GDAL provide any options to coerce it to not re-order the polygons?

thanks



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/shapefile-polygon-multipolygon-ordering-tp5173074.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Fri Nov 14 08:30:46 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 14 Nov 2014 17:30:46 +0100
Subject: [gdal-dev] Original FID for SQLite dialect
In-Reply-To: <5466264F.6060400@caris.com>
References: <5466264F.6060400@caris.com>
Message-ID: <201411141730.46967.even.rouault@spatialys.com>

Le vendredi 14 novembre 2014 16:57:03, Andre Vautour a ?crit :
> Hi all,
> 
> I was wondering if there is a way to get at the original feature id when
> executing an SQL query for the SQLite dialect. Something similar to what
> is described in http://www.gdal.org/ogr_sql.html for FID for the OGR
> dialect.
> 
> That is, is there something equivalent to the following for the SQLite
> dialect:
> ogrinfo -sql "SELECT FID, * from SomeLayerName where ..." someFile.ext

Yes, it is called ROWID.

> 
> Keep in mind that what I am after is the original feature id of the
> layer of the data source, not the id in the resulting SQL layer.
> 
> Thanks,
> Andr?
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From eadam at co.lincoln.or.us  Fri Nov 14 09:03:44 2014
From: eadam at co.lincoln.or.us (Eli Adam)
Date: Fri, 14 Nov 2014 09:03:44 -0800
Subject: [gdal-dev] Associate single point coordinates to image.
In-Reply-To: <1415965131621-5173000.post@n6.nabble.com>
References: <1415960404844-5172985.post@n6.nabble.com>
	<loom.20141114T123013-783@post.gmane.org>
	<1415965131621-5173000.post@n6.nabble.com>
Message-ID: <CACqBkM-OhFYuuTQ3Hmo+WmfkrB8oYfkkekd-PvZEkht7kMA47g@mail.gmail.com>

GDAL reads EXIF data and you can grab that output and then send it
into an OGR output.  I used to have a bash script that did that, but
then I found there were some tricky things to overcome and found that
GpsPrune is really good at this.

GpsPrune can also correlate a GPS track and time stamped photos
lacking EXIF location data.  It exports KML points for the photos.

ExifTool has lots of EXIF data manipulation capacity,
http://www.sno.phy.queensu.ca/~phil/exiftool/


Best regards, Eli

On Fri, Nov 14, 2014 at 3:38 AM, deve <orante.tucceri at exprivia.it> wrote:
> Yes. The final effect is the same: photo--> location-->image over the map.
>
>
>
> --
> View this message in context: http://osgeo-org.1560.x6.nabble.com/Associate-single-point-coordinates-to-image-tp5172985p5173000.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From eadam at co.lincoln.or.us  Fri Nov 14 09:06:58 2014
From: eadam at co.lincoln.or.us (Eli Adam)
Date: Fri, 14 Nov 2014 09:06:58 -0800
Subject: [gdal-dev] Associate single point coordinates to image.
In-Reply-To: <CACqBkM-OhFYuuTQ3Hmo+WmfkrB8oYfkkekd-PvZEkht7kMA47g@mail.gmail.com>
References: <1415960404844-5172985.post@n6.nabble.com>
	<loom.20141114T123013-783@post.gmane.org>
	<1415965131621-5173000.post@n6.nabble.com>
	<CACqBkM-OhFYuuTQ3Hmo+WmfkrB8oYfkkekd-PvZEkht7kMA47g@mail.gmail.com>
Message-ID: <CACqBkM85mVh5tzJ5vojvZk3skbwfntCZYJA1mZC7a0C701-G1A@mail.gmail.com>

I think that this is generally call "geotagging" which might help
while looking for options.

Eli

On Fri, Nov 14, 2014 at 9:03 AM, Eli Adam <eadam at co.lincoln.or.us> wrote:
> GDAL reads EXIF data and you can grab that output and then send it
> into an OGR output.  I used to have a bash script that did that, but
> then I found there were some tricky things to overcome and found that
> GpsPrune is really good at this.
>
> GpsPrune can also correlate a GPS track and time stamped photos
> lacking EXIF location data.  It exports KML points for the photos.
>
> ExifTool has lots of EXIF data manipulation capacity,
> http://www.sno.phy.queensu.ca/~phil/exiftool/
>
>
> Best regards, Eli
>
> On Fri, Nov 14, 2014 at 3:38 AM, deve <orante.tucceri at exprivia.it> wrote:
>> Yes. The final effect is the same: photo--> location-->image over the map.
>>
>>
>>
>> --
>> View this message in context: http://osgeo-org.1560.x6.nabble.com/Associate-single-point-coordinates-to-image-tp5172985p5173000.html
>> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From gdal at stripfamily.net  Fri Nov 14 17:47:12 2014
From: gdal at stripfamily.net (David Strip)
Date: Fri, 14 Nov 2014 18:47:12 -0700
Subject: [gdal-dev] shapefile polygon/multipolygon ordering
In-Reply-To: <1415982367141-5173074.post@n6.nabble.com>
References: <1415982367141-5173074.post@n6.nabble.com>
Message-ID: <5466B0A0.90209@stripfamily.net>

On 11/14/2014 9:26 AM, mccorb wrote:
> Two questions:
> 1. Is it within the shapefile specification to have polygons that have holes
> that have polygons?
> 2. Does GDAL provide any options to coerce it to not re-order the polygons?
>
> thanks
>

Yes, polygons can have holes.
I have no idea about question 2, but in fact this raises a different
question:
Does the shapefile spec say anything about rendering order?

My quick read of the ESRI whitepaper suggests the answer is no.

In general, I would suggest the solution is to have one shapefile for
land masses, one for lakes, and one for islands. Rendering order can
then be controlled by application. The one drawback of this approach is
islands with lakes on them, which is a bit pathological, but does occur.
In his book "Maphead", Ken Jennings (yes, the Jeopardy guy) cites some
place where the nesting of water/island/water... goes three layers deep.

From michael.katz at noaa.gov  Fri Nov 14 18:52:38 2014
From: michael.katz at noaa.gov (Michael Katz - NOAA Affiliate)
Date: Fri, 14 Nov 2014 18:52:38 -0800
Subject: [gdal-dev] shapefile polygon/multipolygon ordering
In-Reply-To: <5466B0A0.90209@stripfamily.net>
References: <1415982367141-5173074.post@n6.nabble.com>
	<5466B0A0.90209@stripfamily.net>
Message-ID: <CALx5KqZc5RRu9EtPTqj3uh2-vTE3eRZ_99fT6vqMDHSkdQcmWg@mail.gmail.com>

I am working on an application that uses shapefiles as its native data
type. The application supports polygons with holes (for the purpose of
drawing, computing area, finding inside/outside, etc.), but not polygons
with holes with islands, or deeper levels of nesting. This convention of
one-deep holes corresponds to the topology model in GEOS, which my
application uses for a lot of geometry computations.

Shapefiles do not indicate inside outside topology. The just allow a
polygon to have multiple parts (multiple rings), some of which may lie
inside of others. My experience in using shapefiles from many sources is
that many data sets out there do include polygons with holes, but there is
no reliable convention for knowing that, say, the order of the rings will
be an outer ring followed by all its holes, and then another outer ring
followed by all its holes, etc.

So, my code keeps a separate "inside/outside" record for each shapefile
polygon object, which might look something like:

1
-1
1
1
-1
5

This says, for each ring index, which ring it's inside of. For instance
this list means that rings 0, 2, and 3 are inside (i.e., are a hole in)
ring 1 (which itself is not inside any ring, indicated by -1), and ring 6
is inside (i.e., is a hole in) ring 5 (which itself is not inside any ring,
indicated by -1).

So I figure out that relationship when I first see the polygon, and
whenever its points change. And then for any other operation I have those
inside/outside relationships cached and ready to go.

I figure the relationships using GEOS inside polygon check. This code is a
little subtle because it's not enough to check, for instance, that a single
point of one ring is inside another ring, because typically it's allowed
(e.g., it's allowed by GEOS) for one point to be shared between a "shell"
and its "hole". So you need to check that a point in the inner ring which
is *not* shared with the outer ring is inside the outer ring.

Also, I have had some data sets where there *are* instances of a ring
inside a ring inside a ring. In this case, it's necessary to recognize this
and make that innermost ring a shell, not a hole.


On Fri, Nov 14, 2014 at 5:47 PM, David Strip <gdal at stripfamily.net> wrote:

> On 11/14/2014 9:26 AM, mccorb wrote:
> > Two questions:
> > 1. Is it within the shapefile specification to have polygons that have
> holes
> > that have polygons?
> > 2. Does GDAL provide any options to coerce it to not re-order the
> polygons?
> >
> > thanks
> >
>
> Yes, polygons can have holes.
> I have no idea about question 2, but in fact this raises a different
> question:
> Does the shapefile spec say anything about rendering order?
>
> My quick read of the ESRI whitepaper suggests the answer is no.
>
> In general, I would suggest the solution is to have one shapefile for
> land masses, one for lakes, and one for islands. Rendering order can
> then be controlled by application. The one drawback of this approach is
> islands with lakes on them, which is a bit pathological, but does occur.
> In his book "Maphead", Ken Jennings (yes, the Jeopardy guy) cites some
> place where the nesting of water/island/water... goes three layers deep.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141114/7505d1cf/attachment.html>

From even.rouault at spatialys.com  Sat Nov 15 02:06:57 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 15 Nov 2014 11:06:57 +0100
Subject: [gdal-dev] shapefile polygon/multipolygon ordering
In-Reply-To: <1415982367141-5173074.post@n6.nabble.com>
References: <1415982367141-5173074.post@n6.nabble.com>
Message-ID: <201411151106.58063.even.rouault@spatialys.com>

Le vendredi 14 novembre 2014 17:26:07, vous avez ?crit :
> I used GDAL to create a new shapefile of polygons.
> 
> The polygons (multi-polygons) were land areas. Some of the land areas had
> holes defined which were lakes within the land area. Within the lakes there
> were some islands of land...so I had a polygon with a hole with more
> polygons.

In OpenGIS specs, an island inside a lake inside a land area is described as a 
multipolygon :
- first polygon:
        - outer ring: land area
        - inner ring: lake outline
- second polygon:
        - outer ring: island
(The order of both polygons might be random)

> 
> When I created the shapefile and saved it, it re-ordered the polygons so
> that all the land polygons preceded all the hole polygons (within a single
> multi-polygon). Although it worked ok for the computations I was doing, it
> drew the polygons in the wrong order so that it drew the main land polygon,
> then the islands, then the lakes which then obscured the islands.
> 
> I don't really know what the shapefile specification says about this but it
> seems as though whoever did the shapefile writer for GDAL actually had to
> expend extra effort to rearrange the polygons in this manner.
> 
> Two questions:
> 1. Is it within the shapefile specification to have polygons that have
> holes that have polygons?

The OpenGIS specification states that a polygon must first list its outer ring 
and then its inner rings (holes)
The Shapefile specification doesn't say much about this, but outer and inner 
rings are distinguished by their winding order (counterclockwise vc 
clockwise).
When writing a shapefile, GDAL does OpenGIS --> Shapefile convention conversion. 
AFAICS in the code, it will write the rings in the order they were specified in 
the OpenGIS geometry, just fixing the winding order if needed.
When reading a shapefile, the opposite conversion is done, and it tries to 
preserve the order in which outer rings appeared in the shapefile (but in the 
shapefile holes can potentially appear before land area), inserting their inner 
rings in-between.

> 2. Does GDAL provide any options to coerce it to not re-order the polygons?

It should limit the re-ordering to what is strictly needed to form a valid 
OpenGIS geometry.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Sat Nov 15 04:32:12 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 15 Nov 2014 13:32:12 +0100
Subject: [gdal-dev] Motion: Adopt RFC 49: Curve geometries
In-Reply-To: <201411141156.09844.even.rouault@spatialys.com>
References: <201411112307.02422.even.rouault@spatialys.com>
	<201411141156.09844.even.rouault@spatialys.com>
Message-ID: <201411151332.12352.even.rouault@spatialys.com>

Le vendredi 14 novembre 2014 11:56:09, Even Rouault a ?crit :
> > Motion : I move to adopt RFC 49: Curve geometries
> > 
> >     http://trac.osgeo.org/gdal/wiki/rfc49_curve_geometries
> > 
> > Starting with my +1
> 
> I declare this motion passed with support from TamasS, JukkaR and myself. I
> will proceed soon in merging the implementation into trunk.

Code has now been merged into trunk. Full rebuild necessary for those 
updating.
I also wanted to mention that folks that have checkout a revision >= r27942 
(the big pass to address locale issues with floating point numbers) should 
update since there was an issue causing various runtime failures, generation 
of corrupted data files, etc.. on Windows builds.

> 
> Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ahmettemiz88 at gmail.com  Sun Nov 16 05:01:57 2014
From: ahmettemiz88 at gmail.com (Ahmet Temiz)
Date: Sun, 16 Nov 2014 15:01:57 +0200
Subject: [gdal-dev] a postgis table to another
Message-ID: <CAJKO1Yu+kCwx+ZEqGxLBhFXcpfJcb8on8-KEre-36vmgdeveDQ@mail.gmail.com>

Hello

Is it possible to export (CREATE  )a postgis table to another in different
projection?
regards


-- 
Ahmet Temiz
Jeoloji M?h.
Afet ve Acil Durum Y?netimi Ba?kanl???
Planlama ve Zarar Azaltma Dairesi Ba?kanl???


________________________

Ahmet Temiz
Geological Eng.
Information Systems - GIS Group
Disaster and Emergency Management
of Presidency
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141116/ec80346f/attachment.html>

From woodbri at swoodbridge.com  Sun Nov 16 06:32:24 2014
From: woodbri at swoodbridge.com (Stephen Woodbridge)
Date: Sun, 16 Nov 2014 09:32:24 -0500
Subject: [gdal-dev] a postgis table to another
In-Reply-To: <CAJKO1Yu+kCwx+ZEqGxLBhFXcpfJcb8on8-KEre-36vmgdeveDQ@mail.gmail.com>
References: <CAJKO1Yu+kCwx+ZEqGxLBhFXcpfJcb8on8-KEre-36vmgdeveDQ@mail.gmail.com>
Message-ID: <5468B578.4030808@swoodbridge.com>

On 11/16/2014 8:01 AM, Ahmet Temiz wrote:
> Hello
>
> Is it possible to export (CREATE  )a postgis table to another in
> different projection?
> regards

There are a few ways that I can think of to do this:

1. add another column to the table with the project you want. Then 
export using that column, maybe using a view.

2. just define a view the does the reprojection to what you want and 
export that.

select st_addgeometrycolumn("mytable", "geom_4326", 2, 
"MULTILINESTRING", 4326);
update mytable set geom_4326=st_transform(geom, 4325);

pgsql2shp ... -g geom_4326 mydb mytable -f outfile.shp

create view table_4326 as select ..., st_transform(geom, 4326) as geom;
pgsql2shp ... -f outfile.shp table_4326

3. you can export a table using a SQL command and you couls do the 
reprojection using that.

pgsql2shp ... -f outfile.shp  "select ..., st_transform(geom, 4326) as geom"

-Steve

From stefan.ziegler.de at gmail.com  Sun Nov 16 22:34:42 2014
From: stefan.ziegler.de at gmail.com (Stefan Ziegler)
Date: Mon, 17 Nov 2014 07:34:42 +0100
Subject: [gdal-dev] Interlis driver does not polygonize anymore
In-Reply-To: <201411141523.59514.even.rouault@spatialys.com>
References: <CAJvo+198nz1Wmq69v7pNuziJeFtGbwMUqOczh=6Be-QnNQOKhg@mail.gmail.com>
	<201411141523.59514.even.rouault@spatialys.com>
Message-ID: <CAJvo+18QWzn=Ku3M7jgw9r2CtiMmg7u=1jSksi6MHYbyfjEwSQ@mail.gmail.com>

I think my answer is still on hold because of the attachements. Now the
answer w/o attachements:

Ok, the autotest example runs smoothly. It seems a problem with the order
of the relation attribute "Entstehung" in the table
Bodenbedeckung__BoFlaeche in my data (link see below). It is added as the
last attribute in the table but actually it's the second one (after TID).

I remember that the order of these relation attributes are a bit nasty to
handle. Pirmin, can you confirm this behaviour/bug? I guess this was
introduced with the change from ili (java) to imd?

http://catais.org/tmp/ili.zip

regards
Stefan


On Fri, Nov 14, 2014 at 3:23 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Stefan,
>
> >
> > I've got some problems with the interlis driver. When I try to convert an
> > interlis 1 file to shapefiles with the following command:
> >
> > ogr2ogr shpdir/ 254900/254900.itf,dm01avso24.imd
> >
> > There are no polygon shapes created. It seems that the point coordinates
> -
> > which are stored in two separate columns - are shifted.
>
> The driver now supports multiple geometry columns since GDAL 1.11. On the
> example in the GDAL autotest, it appears that the point geometry column is
> declared before the second geometry column, so
> you'll get only the point when translating to shapefile, unless you
> explicitely specify the polygon geometry column (look at its name with
> ogrinfo)
>
> With the sample in autotest :
> ogr2ogr out.shp data/ili/Beispiel.itf,data/ili/Beispiel.imd
> Bodenbedeckung__BoFlaechen -overwrite -select Form
>
> >
> > Column "Geometrie_" contains a small double value. Column "Geometrie_1"
> > contains one coordinate. Column "Qualitaet" contains the second
> coordinate.
>
> Not sure about that. Maybe Pirmin has an idea. A sample dataset of yours
> might be needed.
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141117/03e9491a/attachment.html>

From pi_ml at sourcepole.com  Sun Nov 16 23:52:32 2014
From: pi_ml at sourcepole.com (Pirmin Kalberer)
Date: Mon, 17 Nov 2014 08:52:32 +0100
Subject: [gdal-dev] Interlis driver does not polygonize anymore
In-Reply-To: <CAJvo+19WhzJ0fsS02akpE7oi8BaeMKhW4ayW3zzqKuVVqmUNsg@mail.gmail.com>
References: <CAJvo+198nz1Wmq69v7pNuziJeFtGbwMUqOczh=6Be-QnNQOKhg@mail.gmail.com>
	<201411141523.59514.even.rouault@spatialys.com>
	<CAJvo+19WhzJ0fsS02akpE7oi8BaeMKhW4ayW3zzqKuVVqmUNsg@mail.gmail.com>
Message-ID: <1647586.2T8zX5j8d6@robbe2>

Hi Stefan,

Am Freitag, 14. November 2014, 17.09:12 schrieb Stefan Ziegler:
> Ok, the autotest example runs smoothly. It seems a problem with the order
> of the relation attribute "Entstehung" in the table
> Bodenbedeckung__BoFlaeche in my data (find it attached). It is added as the
> last attribute in the table but actually it's the second one (after TID).
> 
> I remember that the order of these relation attributes are a bit nasty to
> handle. Pirmin, can you confirm this behaviour/bug? I guess this was
> introduced with the change from ili (java) to imd?

This bug has been fixed in trunk about 3 weeks ago. The imd file has to be 
generated with ili2c.jar >=4.5.5 from the sourceforge site (not available on 
interlis.ch).

Regards
Pirmin

> 
> On Fri, Nov 14, 2014 at 3:23 PM, Even Rouault <even.rouault at spatialys.com>
> 
> wrote:
> > Stefan,
> > 
> > > I've got some problems with the interlis driver. When I try to convert
> > > an
> > > interlis 1 file to shapefiles with the following command:
> > > 
> > > ogr2ogr shpdir/ 254900/254900.itf,dm01avso24.imd
> > > 
> > > There are no polygon shapes created. It seems that the point coordinates
> > 
> > -
> > 
> > > which are stored in two separate columns - are shifted.
> > 
> > The driver now supports multiple geometry columns since GDAL 1.11. On the
> > example in the GDAL autotest, it appears that the point geometry column is
> > declared before the second geometry column, so
> > you'll get only the point when translating to shapefile, unless you
> > explicitely specify the polygon geometry column (look at its name with
> > ogrinfo)
> > 
> > With the sample in autotest :
> > ogr2ogr out.shp data/ili/Beispiel.itf,data/ili/Beispiel.imd
> > Bodenbedeckung__BoFlaechen -overwrite -select Form
> > 
> > > Column "Geometrie_" contains a small double value. Column "Geometrie_1"
> > > contains one coordinate. Column "Qualitaet" contains the second
> > 
> > coordinate.
> > 
> > Not sure about that. Maybe Pirmin has an idea. A sample dataset of yours
> > might be needed.
> > 
> > Even
> > 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com

-- 
Pirmin Kalberer
Sourcepole  -  Linux & Open Source Solutions
http://www.sourcepole.com


From stefan.ziegler.de at gmail.com  Mon Nov 17 05:31:23 2014
From: stefan.ziegler.de at gmail.com (Stefan Ziegler)
Date: Mon, 17 Nov 2014 14:31:23 +0100
Subject: [gdal-dev] Interlis driver does not polygonize anymore
In-Reply-To: <1647586.2T8zX5j8d6@robbe2>
References: <CAJvo+198nz1Wmq69v7pNuziJeFtGbwMUqOczh=6Be-QnNQOKhg@mail.gmail.com>
	<201411141523.59514.even.rouault@spatialys.com>
	<CAJvo+19WhzJ0fsS02akpE7oi8BaeMKhW4ayW3zzqKuVVqmUNsg@mail.gmail.com>
	<1647586.2T8zX5j8d6@robbe2>
Message-ID: <CAJvo+1_CVOg5GSMjNeYVPq0j8Ry3RggUn0oKEd1DTYsfVEAGBQ@mail.gmail.com>

Perfect! Thanks.

Did I get it right: If I want the polygon from an "AREA"-table I need to
explicit request the polygon geometry? From my point of view the point
geometry from an "AREA"-table is only there to join the attributes to the
polygons.

regards
Stefan

On Mon, Nov 17, 2014 at 8:52 AM, Pirmin Kalberer <pi_ml at sourcepole.com>
wrote:

> Hi Stefan,
>
> Am Freitag, 14. November 2014, 17.09:12 schrieb Stefan Ziegler:
> > Ok, the autotest example runs smoothly. It seems a problem with the order
> > of the relation attribute "Entstehung" in the table
> > Bodenbedeckung__BoFlaeche in my data (find it attached). It is added as
> the
> > last attribute in the table but actually it's the second one (after TID).
> >
> > I remember that the order of these relation attributes are a bit nasty to
> > handle. Pirmin, can you confirm this behaviour/bug? I guess this was
> > introduced with the change from ili (java) to imd?
>
> This bug has been fixed in trunk about 3 weeks ago. The imd file has to be
> generated with ili2c.jar >=4.5.5 from the sourceforge site (not available
> on
> interlis.ch).
>
> Regards
> Pirmin
>
> >
> > On Fri, Nov 14, 2014 at 3:23 PM, Even Rouault <
> even.rouault at spatialys.com>
> >
> > wrote:
> > > Stefan,
> > >
> > > > I've got some problems with the interlis driver. When I try to
> convert
> > > > an
> > > > interlis 1 file to shapefiles with the following command:
> > > >
> > > > ogr2ogr shpdir/ 254900/254900.itf,dm01avso24.imd
> > > >
> > > > There are no polygon shapes created. It seems that the point
> coordinates
> > >
> > > -
> > >
> > > > which are stored in two separate columns - are shifted.
> > >
> > > The driver now supports multiple geometry columns since GDAL 1.11. On
> the
> > > example in the GDAL autotest, it appears that the point geometry
> column is
> > > declared before the second geometry column, so
> > > you'll get only the point when translating to shapefile, unless you
> > > explicitely specify the polygon geometry column (look at its name with
> > > ogrinfo)
> > >
> > > With the sample in autotest :
> > > ogr2ogr out.shp data/ili/Beispiel.itf,data/ili/Beispiel.imd
> > > Bodenbedeckung__BoFlaechen -overwrite -select Form
> > >
> > > > Column "Geometrie_" contains a small double value. Column
> "Geometrie_1"
> > > > contains one coordinate. Column "Qualitaet" contains the second
> > >
> > > coordinate.
> > >
> > > Not sure about that. Maybe Pirmin has an idea. A sample dataset of
> yours
> > > might be needed.
> > >
> > > Even
> > >
> > > --
> > > Spatialys - Geospatial professional services
> > > http://www.spatialys.com
>
> --
> Pirmin Kalberer
> Sourcepole  -  Linux & Open Source Solutions
> http://www.sourcepole.com
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141117/776f88df/attachment.html>

From cnieman at dmsolutions.ca  Mon Nov 17 06:23:54 2014
From: cnieman at dmsolutions.ca (cnieman at dmsolutions.ca)
Date: Mon, 17 Nov 2014 09:23:54 -0500 (EST)
Subject: [gdal-dev] GDAL 1.11.1 OpenFileGDB driver with non-spatial tables
Message-ID: <1416234234.733121804@apps.rackspace.com>


Hi all,
 
 I did a little looking around, but was unable to find anything about this.  I have a File Geodatabase that I can read with the OpenFileGDB driver, and see all of the layers containing spatial data.  However, I seem to not be able to see non-spatial tables.  Is this expected?
 
 Thanks,
 
 Christy
-- 
 Christy Nieman
 GIS Technician
 DM Solutions Group, Inc.
 Email: [ cnieman at dmsolutions.ca ]( mailto:cnieman at dmsolutions.ca )
 Web: [ http://dmsolutions.ca ]( http://dmsolutions.ca )
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141117/71be7440/attachment.html>

From a.neumann at carto.net  Mon Nov 17 06:35:22 2014
From: a.neumann at carto.net (Andreas Neumann)
Date: Mon, 17 Nov 2014 15:35:22 +0100
Subject: [gdal-dev] Problem with nearblack
Message-ID: <e0639b1f07b7080921412b68bfece0ea@carto.net>

Hi,

I have a grayscale tiff file and would like to remap a grayscale value 
of 249 to white (255).

I used the following command:

nearblack -white -color 249 -near 0 -of GTIFF -o temp_white.tif temp.tif

and also tried

nearblack -white -color 249 -near 1 -of GTIFF -o temp_white.tif temp.tif

But nothing changed. 249 stays as 249. Is there another way to remap my 
specific grayscale value 249 to white with gdal?

Thank you for any hints,
Andreas

From even.rouault at spatialys.com  Mon Nov 17 06:36:51 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 17 Nov 2014 15:36:51 +0100
Subject: [gdal-dev] GDAL 1.11.1 OpenFileGDB driver with non-spatial
	tables
In-Reply-To: <1416234234.733121804@apps.rackspace.com>
References: <1416234234.733121804@apps.rackspace.com>
Message-ID: <201411171536.51244.even.rouault@spatialys.com>

Le lundi 17 novembre 2014 15:23:54, cnieman at dmsolutions.ca a ?crit :
> Hi all,
> 
>  I did a little looking around, but was unable to find anything about this.
>  I have a File Geodatabase that I can read with the OpenFileGDB driver,
> and see all of the layers containing spatial data.  However, I seem to not
> be able to see non-spatial tables.  Is this expected?

Christy,

If the FGDB has been created by ArcGIS 9.X, this issue has been fixed recently:
http://trac.osgeo.org/gdal/ticket/5673

Even

> 
>  Thanks,
> 
>  Christy

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From cnieman at dmsolutions.ca  Mon Nov 17 06:38:54 2014
From: cnieman at dmsolutions.ca (Christy Nieman)
Date: Mon, 17 Nov 2014 09:38:54 -0500
Subject: [gdal-dev] GDAL 1.11.1 OpenFileGDB driver with non-spatial
	tables
In-Reply-To: <201411171536.51244.even.rouault@spatialys.com>
References: <1416234234.733121804@apps.rackspace.com>
	<201411171536.51244.even.rouault@spatialys.com>
Message-ID: <546A087E.9080706@dmsolutions.ca>

Thanks Even.  I'm not sure which version of ArcGIS created the FGDB, but 
I'll try building master and see if it works.

Christy

On 17/11/14 09:36 AM, Even Rouault wrote:
> Le lundi 17 novembre 2014 15:23:54, cnieman at dmsolutions.ca a ?crit :
>> Hi all,
>>
>>   I did a little looking around, but was unable to find anything about this.
>>   I have a File Geodatabase that I can read with the OpenFileGDB driver,
>> and see all of the layers containing spatial data.  However, I seem to not
>> be able to see non-spatial tables.  Is this expected?
> Christy,
>
> If the FGDB has been created by ArcGIS 9.X, this issue has been fixed recently:
> http://trac.osgeo.org/gdal/ticket/5673
>
> Even
>
>>   Thanks,
>>
>>   Christy


From cnieman at dmsolutions.ca  Mon Nov 17 07:15:39 2014
From: cnieman at dmsolutions.ca (Christy Nieman)
Date: Mon, 17 Nov 2014 10:15:39 -0500
Subject: [gdal-dev] GDAL 1.11.1 OpenFileGDB driver with non-spatial
	tables
In-Reply-To: <546A087E.9080706@dmsolutions.ca>
References: <1416234234.733121804@apps.rackspace.com>	<201411171536.51244.even.rouault@spatialys.com>
	<546A087E.9080706@dmsolutions.ca>
Message-ID: <546A111B.8010809@dmsolutions.ca>

That worked.  Building trunk allows me to see the non-spatial tables.  I 
guess the FGDB was made with ArcGIS 9.x then.

Thanks again,
Christy

On 17/11/14 09:38 AM, Christy Nieman wrote:
> Thanks Even.  I'm not sure which version of ArcGIS created the FGDB, 
> but I'll try building master and see if it works.
>
> Christy
>
> On 17/11/14 09:36 AM, Even Rouault wrote:
>> Le lundi 17 novembre 2014 15:23:54, cnieman at dmsolutions.ca a ?crit :
>>> Hi all,
>>>
>>>   I did a little looking around, but was unable to find anything 
>>> about this.
>>>   I have a File Geodatabase that I can read with the OpenFileGDB 
>>> driver,
>>> and see all of the layers containing spatial data.  However, I seem 
>>> to not
>>> be able to see non-spatial tables.  Is this expected?
>> Christy,
>>
>> If the FGDB has been created by ArcGIS 9.X, this issue has been fixed 
>> recently:
>> http://trac.osgeo.org/gdal/ticket/5673
>>
>> Even
>>
>>>   Thanks,
>>>
>>>   Christy
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From even.rouault at spatialys.com  Mon Nov 17 12:25:53 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 17 Nov 2014 21:25:53 +0100
Subject: [gdal-dev] GDAL 1.11, official reference implementation of KML 2.2
Message-ID: <201411172125.53917.even.rouault@spatialys.com>

Hi,

This is not completely fresh news, but I just discovered it today while 
looking at what was the current state of this: GDAL 1.11 has been acknowledged 
as an official reference implementation of KML 2.2 by OGC for the 3 compliance 
levels :
http://www.opengeospatial.org/resource/products/details/?pid=1218

The KML test suite has been announced a bit more recently :
http://www.opengeospatial.org/pressroom/pressreleases/2122

I'm mentionned in the above link, but of course the original authors of the 
below drivers should be credited for having done most of the initial work:
- Christopher Condit and Jens Oberender for the KML driver
- Brian Case for the LIBKML driver, and the authors of libkml itself
- Harsh Govind for the KMLSuperOverlay driver.
And also Mateusz ?oskot for integrating the KML&LIBKML drivers, and all other 
contributors.

The script that generates the files that were submitted for compliance testing 
can be found at :
http://svn.osgeo.org/gdal/trunk/autotest/kml_generate_test_files.py

For the sake of clarity, the scope of the KML compliance tests is to check 
that an implementation generates compliant KML files. The reading side isn't 
tested at all.

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From johan.vandewauw at gmail.com  Mon Nov 17 13:45:05 2014
From: johan.vandewauw at gmail.com (Johan Van de Wauw)
Date: Mon, 17 Nov 2014 22:45:05 +0100
Subject: [gdal-dev] Missing licenses for projection definitions
Message-ID: <CAJOp35nB+9nnfFWAn_S5Uw232=taWC9UOqBA5K1HukzL=RG=BA@mail.gmail.com>

Hello,

A number of files is currenlty excluded from distribution by debian
because their license is unclear:
* gdal/data/cubewerx_extra.wkt: derived from definitions distributed
by Cubewerx, rights unclear. See
http://trac.osgeo.org/gdal/ticket/2165
* gdal/data/ecw_cs.dat: Derived via much processing from ERMapper GDT
definitions, rights unclear.  See
http://trac.osgeo.org/gdal/ticket/2162
* gdal/data/esri_extra.wkt: Derived with some processing from
projections definitions in ArcGIS, rights unclear. See
http://trac.osgeo.org/gdal/ticket/2163

Has anyone contacted these projects to get some sort of license
clearence? Is there another possibility to get files for these
projections  which do have a valid copyright/license?

Johan

From simlangen at gmail.com  Tue Nov 18 10:29:47 2014
From: simlangen at gmail.com (Simen Langseth)
Date: Wed, 19 Nov 2014 03:29:47 +0900
Subject: [gdal-dev] Aligning Raster Over the Polygon
Message-ID: <CAHOqc_qBV7o=4WPrGR4LgtqHzX0=7sjF0-CWsAdFDV0_uXEFUA@mail.gmail.com>

Dear GDAL Users:

I have a raster image which have to be aligned over the polygon.
Both the raster and polygon have the same coordinate system.

The figure shows the raster image which has to be fitted over the RED
polygon.

https://drive.google.com/file/d/0B2RqG9tSAAIUc3J5ZDN6V01IcG8/view?usp=sharing

How can I do it guys?

Thanks.

Simen
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141119/98db5442/attachment.html>

From randre at gmail.com  Tue Nov 18 12:49:52 2014
From: randre at gmail.com (=?UTF-8?B?Um9nZXIgQW5kcsOp?=)
Date: Tue, 18 Nov 2014 12:49:52 -0800
Subject: [gdal-dev] Aligning Raster Over the Polygon
In-Reply-To: <CAHOqc_qBV7o=4WPrGR4LgtqHzX0=7sjF0-CWsAdFDV0_uXEFUA@mail.gmail.com>
References: <CAHOqc_qBV7o=4WPrGR4LgtqHzX0=7sjF0-CWsAdFDV0_uXEFUA@mail.gmail.com>
Message-ID: <CAOL+ROEan9H-pN6KstFpKC+4Nha-kMQW7Zb4NbSUVrhr-BzXkw@mail.gmail.com>

Have you tried using a World File?  http://en.wikipedia.org/wiki/World_file

Roger

On Tue, Nov 18, 2014 at 10:29 AM, Simen Langseth <simlangen at gmail.com>
wrote:

> Dear GDAL Users:
>
> I have a raster image which have to be aligned over the polygon.
> Both the raster and polygon have the same coordinate system.
>
> The figure shows the raster image which has to be fitted over the RED
> polygon.
>
>
> https://drive.google.com/file/d/0B2RqG9tSAAIUc3J5ZDN6V01IcG8/view?usp=sharing
>
> How can I do it guys?
>
> Thanks.
>
> Simen
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141118/d9817a93/attachment.html>

From gdal at stripfamily.net  Tue Nov 18 13:45:46 2014
From: gdal at stripfamily.net (David Strip)
Date: Tue, 18 Nov 2014 14:45:46 -0700
Subject: [gdal-dev] Aligning Raster Over the Polygon
In-Reply-To: <CAHOqc_qBV7o=4WPrGR4LgtqHzX0=7sjF0-CWsAdFDV0_uXEFUA@mail.gmail.com>
References: <CAHOqc_qBV7o=4WPrGR4LgtqHzX0=7sjF0-CWsAdFDV0_uXEFUA@mail.gmail.com>
Message-ID: <546BBE0A.1080307@stripfamily.net>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141118/284c3577/attachment.html>

From simlangen at gmail.com  Tue Nov 18 19:13:33 2014
From: simlangen at gmail.com (Simen Langseth)
Date: Wed, 19 Nov 2014 12:13:33 +0900
Subject: [gdal-dev] Aligning Raster Over the Polygon
In-Reply-To: <546BBE0A.1080307@stripfamily.net>
References: <CAHOqc_qBV7o=4WPrGR4LgtqHzX0=7sjF0-CWsAdFDV0_uXEFUA@mail.gmail.com>
	<546BBE0A.1080307@stripfamily.net>
Message-ID: <CAHOqc_qweoQZ=aXSuzDtKiKEkMGD+PgPx-QW4a2CRd8LX_Qdww@mail.gmail.com>

Is not it possible to do it using gdalwarp?

On Wed, Nov 19, 2014 at 6:45 AM, David Strip <gdal at stripfamily.net> wrote:

>  This is a pretty straightforward task in qgis. Just load the image and
> treat the four corners as ground control points, using the corresponding
> corners of the polygon.
> There's an tutorial here.
> <http://www.digital-geography.com/qgis-tutorial-i-how-to-georeference-a-map/#.VGu9qslNf7U>
>
>
> On 11/18/2014 11:29 AM, Simen Langseth wrote:
>
> Dear GDAL Users:
>
> I have a raster image which have to be aligned over the polygon.
> Both the raster and polygon have the same coordinate system.
>
> The figure shows the raster image which has to be fitted over the RED
> polygon.
>
>
> https://drive.google.com/file/d/0B2RqG9tSAAIUc3J5ZDN6V01IcG8/view?usp=sharing
>
> How can I do it guys?
>
> Thanks.
>
> Simen
>
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttp://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141119/ec376551/attachment.html>

From simlangen at gmail.com  Wed Nov 19 01:16:13 2014
From: simlangen at gmail.com (Simen Langseth)
Date: Wed, 19 Nov 2014 18:16:13 +0900
Subject: [gdal-dev] georeferencing raster data using vector polygon
Message-ID: <CAHOqc_oKJOqfPf=x67996mjMBXxZc2Zb7KDnwgL5j_zndZWqVA@mail.gmail.com>

 I wanted to georeference the raster image in UTM coordinates into the
boundry of red polygon with geographic coordinate system.

https://drive.google.com/file/d/0B2RqG9tSAAIUc3J5ZDN6V01IcG8/view?usp=sharing

I tried as follows:

gdalwarp,-t_srs wgs84 -srcnodata 0 -dstnodata 0 -r near -te -96.75234
54.93479 -92.90071 56.91041 i

What parameters should I provide for that?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141119/5bfdff11/attachment.html>

From a.neumann at carto.net  Wed Nov 19 02:13:29 2014
From: a.neumann at carto.net (Andreas Neumann)
Date: Wed, 19 Nov 2014 11:13:29 +0100
Subject: [gdal-dev] gdalnumeric issue
Message-ID: <def56c2ab441e92828a0f306e721cc17@carto.net>

Hi,

I wanted to run gdal_calc.py

When I run it, it complains about an import error:

-----------------
Traceback (most recent call last):
   File "/usr/local/bin/gdal_calc.py", line 50, in <module>
     from gdalnumeric import *
ImportError: No module named gdalnumeric
-----------------

However, it seems to present on my system at the path 
/usr/local/lib/python2.7/dist-packages/osgeo/gdalnumeric.py

How can I tell gdal_calc.py where to find gdalnumeric?

Thank you for any hints!

Andreas

From even.rouault at spatialys.com  Wed Nov 19 02:15:49 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 19 Nov 2014 11:15:49 +0100
Subject: [gdal-dev] gdalnumeric issue
In-Reply-To: <def56c2ab441e92828a0f306e721cc17@carto.net>
References: <def56c2ab441e92828a0f306e721cc17@carto.net>
Message-ID: <201411191115.50233.even.rouault@spatialys.com>

Andreas,

try setting PYTHONPATH=/usr/local/lib/python2.7/dist-packages as environment 
variable.

Even

> Hi,
> 
> I wanted to run gdal_calc.py
> 
> When I run it, it complains about an import error:
> 
> -----------------
> Traceback (most recent call last):
>    File "/usr/local/bin/gdal_calc.py", line 50, in <module>
>      from gdalnumeric import *
> ImportError: No module named gdalnumeric
> -----------------
> 
> However, it seems to present on my system at the path
> /usr/local/lib/python2.7/dist-packages/osgeo/gdalnumeric.py
> 
> How can I tell gdal_calc.py where to find gdalnumeric?
> 
> Thank you for any hints!
> 
> Andreas
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From aborruso at gmail.com  Wed Nov 19 03:40:03 2014
From: aborruso at gmail.com (aborruso)
Date: Wed, 19 Nov 2014 03:40:03 -0800 (PST)
Subject: [gdal-dev] Define Virtual Format for a remote GeoJSON file
Message-ID: <1416397203332-5173766.post@n6.nabble.com>

Hi all,
is it possible to define a Virtual Format of a remote GeoJSON file?

I would like to built a VRT file in example using this GeoJSON remote URL:
"http://www.provincia.caltanissetta.sitr.it/ArcGIS/rest/services/Immobili/MapServer/0/query?where=objectid+%3D+objectid&outfields=*&f=json" 


Thank you,

Andrea



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Define-Virtual-Format-for-a-remote-GeoJSON-file-tp5173766.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Wed Nov 19 03:44:34 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 19 Nov 2014 12:44:34 +0100
Subject: [gdal-dev] Define Virtual Format for a remote GeoJSON file
In-Reply-To: <1416397203332-5173766.post@n6.nabble.com>
References: <1416397203332-5173766.post@n6.nabble.com>
Message-ID: <201411191244.34466.even.rouault@spatialys.com>

Le mercredi 19 novembre 2014 12:40:03, aborruso a ?crit :
> Hi all,
> is it possible to define a Virtual Format of a remote GeoJSON file?
> 
> I would like to built a VRT file in example using this GeoJSON remote URL:
> "http://www.provincia.caltanissetta.sitr.it/ArcGIS/rest/services/Immobili/M
> apServer/0/query?where=objectid+%3D+objectid&outfields=*&f=json"
> 

Andrea,

Yes, you can use the URL as the datasource name expected by the VRT format.

Even

> 
> Thank you,
> 
> Andrea
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/Define-Virtual-Format-for-a-remote-Geo
> JSON-file-tp5173766.html Sent from the GDAL - Dev mailing list archive at
> Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From a.neumann at carto.net  Wed Nov 19 04:49:48 2014
From: a.neumann at carto.net (Andreas Neumann)
Date: Wed, 19 Nov 2014 13:49:48 +0100
Subject: [gdal-dev] =?utf-8?q?gdal=5Fcalc=2Epy_and_NoData_issues?=
Message-ID: <97cd6b516242b630afff11df5cb1ffd6@carto.net>

Hi,

I have an issue with gdal_calc.py and nodata values.

My input data contains a lot of white pixels. After running gdal_calc.py 
with the following parameters

gdal_calc.py -A test.tif --outfile=testcalc.tif 
--calc="(A==249)*255+(A<>249)*A"

it turns out that all pixel values with 255 are now nodata values ;-( Is 
there an option so that my 255 values are not turned into nodata? I 
tested with the --NoDataValue option (e.g. 99 - which I don't use in the 
image), but it seems to be ignored. For me it is important that black 
and white pixels are preserved.

Thanks for any hints,
Andreas

From even.rouault at spatialys.com  Wed Nov 19 04:58:00 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 19 Nov 2014 13:58:00 +0100
Subject: [gdal-dev] gdal_calc.py and NoData issues
In-Reply-To: <97cd6b516242b630afff11df5cb1ffd6@carto.net>
References: <97cd6b516242b630afff11df5cb1ffd6@carto.net>
Message-ID: <201411191358.01037.even.rouault@spatialys.com>

Le mercredi 19 novembre 2014 13:49:48, Andreas Neumann a ?crit :
> Hi,
> 
> I have an issue with gdal_calc.py and nodata values.
> 
> My input data contains a lot of white pixels. After running gdal_calc.py
> with the following parameters
> 
> gdal_calc.py -A test.tif --outfile=testcalc.tif
> --calc="(A==249)*255+(A<>249)*A"
> 
> it turns out that all pixel values with 255 are now nodata values ;-( Is
> there an option so that my 255 values are not turned into nodata? I
> tested with the --NoDataValue option (e.g. 99 - which I don't use in the
> image), but it seems to be ignored. For me it is important that black
> and white pixels are preserved.

Use --overwrite as well, since otherwise the existing output file will be used 
to be just updated and not recreated.
It would be appropriate that the utility warns that --NoDataValue has no effect 
when the output file exists.

> 
> Thanks for any hints,
> Andreas
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From a.neumann at carto.net  Wed Nov 19 05:16:56 2014
From: a.neumann at carto.net (Andreas Neumann)
Date: Wed, 19 Nov 2014 14:16:56 +0100
Subject: [gdal-dev] =?utf-8?q?Fwd=3A_Re=3A__gdal=5Fcalc=2Epy_and_NoData_is?=
 =?utf-8?q?sues?=
Message-ID: <079367116ac1274179492e477e4990d3@carto.net>

forgot to send this to the list. Sorry.

see below:

-------- Originalnachricht --------
Betreff: Re: [gdal-dev] gdal_calc.py and NoData issues
Datum: 2014-11-19 14:16
Von: Andreas Neumann <a.neumann at carto.net>
An: Even Rouault <even.rouault at spatialys.com>

Hi Even,

Thank you for trying to help. Unfortunately, the --overwrite option does 
not help.

I have a very small test file at http://webgis.uster.ch/temp/test.tif

I used the following options:

gdal_calc.py -A test.tif --overwrite --outfile=testcalc.tif 
--calc="(A==249)*255+(A<>249)*A"

All pixels with values of "255" are now "nodata" after running gdal_calc 
;-(

May I please ask you to test/verify this?

Thanks a lot!

Andreas

Am 2014-11-19 13:58, schrieb Even Rouault:
> Le mercredi 19 novembre 2014 13:49:48, Andreas Neumann a ?crit :
>> Hi,
>> 
>> I have an issue with gdal_calc.py and nodata values.
>> 
>> My input data contains a lot of white pixels. After running 
>> gdal_calc.py
>> with the following parameters
>> 
>> gdal_calc.py -A test.tif --outfile=testcalc.tif
>> --calc="(A==249)*255+(A<>249)*A"
>> 
>> it turns out that all pixel values with 255 are now nodata values ;-( 
>> Is
>> there an option so that my 255 values are not turned into nodata? I
>> tested with the --NoDataValue option (e.g. 99 - which I don't use in 
>> the
>> image), but it seems to be ignored. For me it is important that black
>> and white pixels are preserved.
> 
> Use --overwrite as well, since otherwise the existing output file will 
> be used
> to be just updated and not recreated.
> It would be appropriate that the utility warns that --NoDataValue has 
> no effect
> when the output file exists.
> 
>> 
>> Thanks for any hints,
>> Andreas
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From aborruso at gmail.com  Wed Nov 19 05:22:02 2014
From: aborruso at gmail.com (aborruso)
Date: Wed, 19 Nov 2014 05:22:02 -0800 (PST)
Subject: [gdal-dev] Define Virtual Format for a remote GeoJSON file
In-Reply-To: <201411191244.34466.even.rouault@spatialys.com>
References: <1416397203332-5173766.post@n6.nabble.com>
	<201411191244.34466.even.rouault@spatialys.com>
Message-ID: <1416403322132-5173799.post@n6.nabble.com>

Hi Even,
thank you.


Even Rouault-2 wrote
> Yes, you can use the URL as the datasource name expected by the VRT
> format.

I have tried with:
<OGRVRTDataSource>
	<OGRVRTLayer name="OGRGeoJSON">
	
<SrcDataSource>http://www.provincia.caltanissetta.sitr.it/ArcGIS/rest/services/Immobili/MapServer/0/query?where=objectid+%3D+objectid&outfields=*&f=json</SrcDataSource>
		<LayerSRS>EPSG:3004</LayerSRS>
		<SrcLayer>OGRGeoJSON</SrcLayer> 
	</OGRVRTLayer>
</OGRVRTDataSource>

But if I run "ogrinfo -ro my_virtual_format_file.vrt" I have:
INFO: Open of `my_virtual_format_file.vrt'
      using driver `VRT' successful.
1: OGRGeoJSONERROR 4: Failed to read GeoJSON data

If I run:
ogrinfo -ro 
"http://www.provincia.caltanissetta.sitr.it/ArcGIS/rest/services/Immobili/MapServer/0/query?where=objectid+%3D+objectid&outfields=*&f=json"
OGRGeoJSON -summary

It's all OK.

What's wrong in my VRT definition?

Thank you again,

a




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Define-Virtual-Format-for-a-remote-GeoJSON-file-tp5173766p5173799.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Wed Nov 19 05:21:42 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 19 Nov 2014 14:21:42 +0100
Subject: [gdal-dev] gdal_calc.py and NoData issues
In-Reply-To: <0c9bc18d0e546f1b5ed2e1654deb8460@carto.net>
References: <97cd6b516242b630afff11df5cb1ffd6@carto.net>
	<201411191358.01037.even.rouault@spatialys.com>
	<0c9bc18d0e546f1b5ed2e1654deb8460@carto.net>
Message-ID: <201411191421.42629.even.rouault@spatialys.com>

Le mercredi 19 novembre 2014 14:16:05, Andreas Neumann a ?crit :
> Hi Even,
> 
> Thank you for trying to help. Unfortunately, the --overwrite option does
> not help.
> 
> I have a very small test file at http://webgis.uster.ch/temp/test.tif
> 
> I used the following options:
> 
> gdal_calc.py -A test.tif --overwrite --outfile=testcalc.tif
> --calc="(A==249)*255+(A<>249)*A"
> 
> All pixels with values of "255" are now "nodata" after running gdal_calc
> ;-(

I wrote "as well", so try with "--overwrite --nodata 99".

> 
> May I please ask you to test/verify this?
> 
> Thanks a lot!
> 
> Andreas
> 
> Am 2014-11-19 13:58, schrieb Even Rouault:
> > Le mercredi 19 novembre 2014 13:49:48, Andreas Neumann a ?crit :
> >> Hi,
> >> 
> >> I have an issue with gdal_calc.py and nodata values.
> >> 
> >> My input data contains a lot of white pixels. After running
> >> gdal_calc.py
> >> with the following parameters
> >> 
> >> gdal_calc.py -A test.tif --outfile=testcalc.tif
> >> --calc="(A==249)*255+(A<>249)*A"
> >> 
> >> it turns out that all pixel values with 255 are now nodata values ;-(
> >> Is
> >> there an option so that my 255 values are not turned into nodata? I
> >> tested with the --NoDataValue option (e.g. 99 - which I don't use in
> >> the
> >> image), but it seems to be ignored. For me it is important that black
> >> and white pixels are preserved.
> > 
> > Use --overwrite as well, since otherwise the existing output file will
> > be used
> > to be just updated and not recreated.
> > It would be appropriate that the utility warns that --NoDataValue has
> > no effect
> > when the output file exists.
> > 
> >> Thanks for any hints,
> >> Andreas
> >> _______________________________________________
> >> gdal-dev mailing list
> >> gdal-dev at lists.osgeo.org
> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From a.neumann at carto.net  Wed Nov 19 05:25:07 2014
From: a.neumann at carto.net (Andreas Neumann)
Date: Wed, 19 Nov 2014 14:25:07 +0100
Subject: [gdal-dev] =?utf-8?q?gdal=5Fcalc=2Epy_and_NoData_issues?=
In-Reply-To: <201411191421.42629.even.rouault@spatialys.com>
References: <97cd6b516242b630afff11df5cb1ffd6@carto.net>
	<201411191358.01037.even.rouault@spatialys.com>
	<0c9bc18d0e546f1b5ed2e1654deb8460@carto.net>
	<201411191421.42629.even.rouault@spatialys.com>
Message-ID: <9600758ea16dadde66c7683339c3ad58@carto.net>

oh - sorry. This helps.

Correct syntax is:
gdal_calc.py -A test.tif --overwrite --NoDataValue=99 
--outfile=testcalc.tif --calc="(A==249)*255+(A<>249)*A"

Thanks a lot!

Andreas

Am 2014-11-19 14:21, schrieb Even Rouault:
> Le mercredi 19 novembre 2014 14:16:05, Andreas Neumann a ?crit :
>> Hi Even,
>> 
>> Thank you for trying to help. Unfortunately, the --overwrite option 
>> does
>> not help.
>> 
>> I have a very small test file at http://webgis.uster.ch/temp/test.tif
>> 
>> I used the following options:
>> 
>> gdal_calc.py -A test.tif --overwrite --outfile=testcalc.tif
>> --calc="(A==249)*255+(A<>249)*A"
>> 
>> All pixels with values of "255" are now "nodata" after running 
>> gdal_calc
>> ;-(
> 
> I wrote "as well", so try with "--overwrite --nodata 99".
> 
>> 
>> May I please ask you to test/verify this?
>> 
>> Thanks a lot!
>> 
>> Andreas
>> 
>> Am 2014-11-19 13:58, schrieb Even Rouault:
>> > Le mercredi 19 novembre 2014 13:49:48, Andreas Neumann a ?crit :
>> >> Hi,
>> >>
>> >> I have an issue with gdal_calc.py and nodata values.
>> >>
>> >> My input data contains a lot of white pixels. After running
>> >> gdal_calc.py
>> >> with the following parameters
>> >>
>> >> gdal_calc.py -A test.tif --outfile=testcalc.tif
>> >> --calc="(A==249)*255+(A<>249)*A"
>> >>
>> >> it turns out that all pixel values with 255 are now nodata values ;-(
>> >> Is
>> >> there an option so that my 255 values are not turned into nodata? I
>> >> tested with the --NoDataValue option (e.g. 99 - which I don't use in
>> >> the
>> >> image), but it seems to be ignored. For me it is important that black
>> >> and white pixels are preserved.
>> >
>> > Use --overwrite as well, since otherwise the existing output file will
>> > be used
>> > to be just updated and not recreated.
>> > It would be appropriate that the utility warns that --NoDataValue has
>> > no effect
>> > when the output file exists.
>> >
>> >> Thanks for any hints,
>> >> Andreas
>> >> _______________________________________________
>> >> gdal-dev mailing list
>> >> gdal-dev at lists.osgeo.org
>> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From simlangen at gmail.com  Wed Nov 19 06:09:34 2014
From: simlangen at gmail.com (Simen Langseth)
Date: Wed, 19 Nov 2014 23:09:34 +0900
Subject: [gdal-dev] gdal_calc.py and NoData issues
In-Reply-To: <201411191421.42629.even.rouault@spatialys.com>
References: <97cd6b516242b630afff11df5cb1ffd6@carto.net>
	<201411191358.01037.even.rouault@spatialys.com>
	<0c9bc18d0e546f1b5ed2e1654deb8460@carto.net>
	<201411191421.42629.even.rouault@spatialys.com>
Message-ID: <CAHOqc_pjswcbNxB__HCHkXOsfFNngnSY8J0UnUL67jJBqNbLTA@mail.gmail.com>

I saw the symbol <> first time in gdal calc what is meaning of it?

Thanks

On Wed, Nov 19, 2014 at 10:21 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le mercredi 19 novembre 2014 14:16:05, Andreas Neumann a ?crit :
> > Hi Even,
> >
> > Thank you for trying to help. Unfortunately, the --overwrite option does
> > not help.
> >
> > I have a very small test file at http://webgis.uster.ch/temp/test.tif
> >
> > I used the following options:
> >
> > gdal_calc.py -A test.tif --overwrite --outfile=testcalc.tif
> > --calc="(A==249)*255+(A<>249)*A"
> >
> > All pixels with values of "255" are now "nodata" after running gdal_calc
> > ;-(
>
> I wrote "as well", so try with "--overwrite --nodata 99".
>
> >
> > May I please ask you to test/verify this?
> >
> > Thanks a lot!
> >
> > Andreas
> >
> > Am 2014-11-19 13:58, schrieb Even Rouault:
> > > Le mercredi 19 novembre 2014 13:49:48, Andreas Neumann a ?crit :
> > >> Hi,
> > >>
> > >> I have an issue with gdal_calc.py and nodata values.
> > >>
> > >> My input data contains a lot of white pixels. After running
> > >> gdal_calc.py
> > >> with the following parameters
> > >>
> > >> gdal_calc.py -A test.tif --outfile=testcalc.tif
> > >> --calc="(A==249)*255+(A<>249)*A"
> > >>
> > >> it turns out that all pixel values with 255 are now nodata values ;-(
> > >> Is
> > >> there an option so that my 255 values are not turned into nodata? I
> > >> tested with the --NoDataValue option (e.g. 99 - which I don't use in
> > >> the
> > >> image), but it seems to be ignored. For me it is important that black
> > >> and white pixels are preserved.
> > >
> > > Use --overwrite as well, since otherwise the existing output file will
> > > be used
> > > to be just updated and not recreated.
> > > It would be appropriate that the utility warns that --NoDataValue has
> > > no effect
> > > when the output file exists.
> > >
> > >> Thanks for any hints,
> > >> Andreas
> > >> _______________________________________________
> > >> gdal-dev mailing list
> > >> gdal-dev at lists.osgeo.org
> > >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141119/904910b1/attachment.html>

From a.neumann at carto.net  Wed Nov 19 06:13:15 2014
From: a.neumann at carto.net (Andreas Neumann)
Date: Wed, 19 Nov 2014 15:13:15 +0100
Subject: [gdal-dev] =?utf-8?q?gdal=5Fcalc=2Epy_and_NoData_issues?=
In-Reply-To: <CAHOqc_pjswcbNxB__HCHkXOsfFNngnSY8J0UnUL67jJBqNbLTA@mail.gmail.com>
References: <97cd6b516242b630afff11df5cb1ffd6@carto.net>
	<201411191358.01037.even.rouault@spatialys.com>
	<0c9bc18d0e546f1b5ed2e1654deb8460@carto.net>
	<201411191421.42629.even.rouault@spatialys.com>
	<CAHOqc_pjswcbNxB__HCHkXOsfFNngnSY8J0UnUL67jJBqNbLTA@mail.gmail.com>
Message-ID: <4349f687248d2c93ca1dcbc99a68dc26@carto.net>

Hi Simen,

<> means not - same as !=

Andreas

Am 2014-11-19 15:09, schrieb Simen Langseth:
> I saw the symbol <> first time in gdal calc what is meaning of it?
> 
> Thanks
> 
> On Wed, Nov 19, 2014 at 10:21 PM, Even Rouault
> <even.rouault at spatialys.com> wrote:
> 
>> Le mercredi 19 novembre 2014 14:16:05, Andreas Neumann a ?crit :
>>> Hi Even,
>>> 
>>> Thank you for trying to help. Unfortunately, the --overwrite
>> option does
>>> not help.
>>> 
>>> I have a very small test file at
>> http://webgis.uster.ch/temp/test.tif [1]
>>> 
>>> I used the following options:
>>> 
>>> gdal_calc.py -A test.tif --overwrite --outfile=testcalc.tif
>>> --calc="(A==249)*255+(A<>249)*A"
>>> 
>>> All pixels with values of "255" are now "nodata" after running
>> gdal_calc
>>> ;-(
>> 
>> I wrote "as well", so try with "--overwrite --nodata 99".
>> 
>>> 
>>> May I please ask you to test/verify this?
>>> 
>>> Thanks a lot!
>>> 
>>> Andreas
>>> 
>>> Am 2014-11-19 13:58, schrieb Even Rouault:
>> 
>>>> Le mercredi 19 novembre 2014 13:49:48, Andreas Neumann a ?crit
>> :
>>> >> Hi,
>>> >>
>>> >> I have an issue with gdal_calc.py and nodata values.
>>> >>
>>> >> My input data contains a lot of white pixels. After running
>>> >> gdal_calc.py
>>> >> with the following parameters
>>> >>
>>> >> gdal_calc.py -A test.tif --outfile=testcalc.tif
>>> >> --calc="(A==249)*255+(A<>249)*A"
>>> >>
>>> >> it turns out that all pixel values with 255 are now nodata
>> values ;-(
>>> >> Is
>>> >> there an option so that my 255 values are not turned into
>> nodata? I
>>> >> tested with the --NoDataValue option (e.g. 99 - which I don't
>> use in
>>> >> the
>>> >> image), but it seems to be ignored. For me it is important
>> that black
>>> >> and white pixels are preserved.
>>> >
>>> > Use --overwrite as well, since otherwise the existing output
>> file will
>>> > be used
>>> > to be just updated and not recreated.
>>> > It would be appropriate that the utility warns that
>> --NoDataValue has
>>> > no effect
>>> > when the output file exists.
>>> >
>>> >> Thanks for any hints,
>>> >> Andreas
>>> >> _______________________________________________
>>> >> gdal-dev mailing list
>>> >> gdal-dev at lists.osgeo.org
>>> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev [2]
>> 
>> --
>> Spatialys - Geospatial professional services
>> http://www.spatialys.com [3]
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev [2]
> 
> 
> 
> Links:
> ------
> [1] http://webgis.uster.ch/temp/test.tif
> [2] http://lists.osgeo.org/mailman/listinfo/gdal-dev
> [3] http://www.spatialys.com

From hrz at geodata.soton.ac.uk  Wed Nov 19 09:14:19 2014
From: hrz at geodata.soton.ac.uk (Homme Zwaagstra)
Date: Wed, 19 Nov 2014 17:14:19 +0000
Subject: [gdal-dev] Define Virtual Format for a remote GeoJSON file
In-Reply-To: <1416403322132-5173799.post@n6.nabble.com>
References: <1416397203332-5173766.post@n6.nabble.com>	<201411191244.34466.even.rouault@spatialys.com>
	<1416403322132-5173799.post@n6.nabble.com>
Message-ID: <546CCFEB.90808@geodata.soton.ac.uk>

Hi Andrea,

The VRT is an XML format and hence you need to ensure the content is XML 
compliant: your URL contained `&` characters that need to be escaped to 
`&amp;`.  The following VRT works for me:

<OGRVRTDataSource>
   <OGRVRTLayer name="OGRGeoJSON">
<SrcDataSource>http://www.provincia.caltanissetta.sitr.it/ArcGIS/rest/services/Immobili/MapServer/0/query?where=objectid+%3D+objectid&amp;outfields=*&amp;f=json</SrcDataSource>
     <LayerSRS>EPSG:3004</LayerSRS>
     <SrcLayer>OGRGeoJSON</SrcLayer>
   </OGRVRTLayer>
</OGRVRTDataSource>

Best regards,

Homme

On 19/11/14 13:22, aborruso wrote:
> Hi Even,
 > thank you.
 >
 >
 > Even Rouault-2 wrote
 >> Yes, you can use the URL as the datasource name expected by the VRT
 >> format.
 >
 > I have tried with:
 > <OGRVRTDataSource>
 >     <OGRVRTLayer name="OGRGeoJSON">
 >
 > 
<SrcDataSource>http://www.provincia.caltanissetta.sitr.it/ArcGIS/rest/services/Immobili/MapServer/0/query?where=objectid+%3D+objectid&outfields=*&f=json</SrcDataSource>
 >         <LayerSRS>EPSG:3004</LayerSRS>
 >         <SrcLayer>OGRGeoJSON</SrcLayer>
 >     </OGRVRTLayer>
 > </OGRVRTDataSource>
 >
 > But if I run "ogrinfo -ro my_virtual_format_file.vrt" I have:
 > INFO: Open of `my_virtual_format_file.vrt'
 >       using driver `VRT' successful.
 > 1: OGRGeoJSONERROR 4: Failed to read GeoJSON data
 >
 > If I run:
 > ogrinfo -ro
 > 
"http://www.provincia.caltanissetta.sitr.it/ArcGIS/rest/services/Immobili/MapServer/0/query?where=objectid+%3D+objectid&outfields=*&f=json"
 > OGRGeoJSON -summary
 >
 > It's all OK.
 >
 > What's wrong in my VRT definition?
 >
 > Thank you again,
 >
 > a
 >
 >
 >
 >
 > --
 > View this message in context: 
http://osgeo-org.1560.x6.nabble.com/Define-Virtual-Format-for-a-remote-GeoJSON-file-tp5173766p5173799.html
 > Sent from the GDAL - Dev mailing list archive at Nabble.com.
 > _______________________________________________
 > gdal-dev mailing list
 > gdal-dev at lists.osgeo.org
 > http://lists.osgeo.org/mailman/listinfo/gdal-dev


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141119/46673e1b/attachment-0001.html>

From aborruso at gmail.com  Wed Nov 19 09:21:36 2014
From: aborruso at gmail.com (aborruso)
Date: Wed, 19 Nov 2014 09:21:36 -0800 (PST)
Subject: [gdal-dev] Define Virtual Format for a remote GeoJSON file
In-Reply-To: <546CCFEB.90808@geodata.soton.ac.uk>
References: <1416397203332-5173766.post@n6.nabble.com>
	<201411191244.34466.even.rouault@spatialys.com>
	<1416403322132-5173799.post@n6.nabble.com>
	<546CCFEB.90808@geodata.soton.ac.uk>
Message-ID: <1416417696429-5173849.post@n6.nabble.com>

Hi hrz,


hrz wrote
> The VRT is an XML format and hence you need to ensure the content is XML 
> compliant: your URL contained `&` characters that need to be escaped to 
> `&amp;`.  The following VRT works for me:

I'm stupid :)

It works good.

Thank you very much,

Andrea



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Define-Virtual-Format-for-a-remote-GeoJSON-file-tp5173766p5173849.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Wed Nov 19 14:14:18 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 19 Nov 2014 23:14:18 +0100
Subject: [gdal-dev] Call for discussion on RFC 50: OGR field subtypes
Message-ID: <201411192314.19033.even.rouault@spatialys.com>

Hi,

This is a call for discussion on RFC 50: OGR field subtypes

http://trac.osgeo.org/gdal/wiki/rfc50_ogr_field_subtype

Below the summary :
"""
This RFC aims at adding the capability of specifying sub-types to OGR fields, 
like boolean, 16 bit integers or 32 bit floating point values. The sub-type of 
a field definition is an additional attribute that specifies a hint or a 
restriction to the main type. The subtype can be used by applications and 
drivers that know how to handle it, and can generally be safely ignored by 
applications and drivers that do not. 
"""

Even
-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From bishop.dev at gmail.com  Wed Nov 19 16:27:32 2014
From: bishop.dev at gmail.com (Dmitriy Baryshnikov)
Date: Thu, 20 Nov 2014 03:27:32 +0300
Subject: [gdal-dev] Call for discussion on RFC 50: OGR field subtypes
In-Reply-To: <201411192314.19033.even.rouault@spatialys.com>
References: <201411192314.19033.even.rouault@spatialys.com>
Message-ID: <546D3574.8020109@gmail.com>

Hi Even,

And what about string list field subtype?
I.e. I need restricted String field to accept only predefined strings 
from the list?
Also for integer or dates fields the value range(s) or time period(s) 
set will be worth adding. I.e. the tube_width (Integer) can only be in  
range 100-183 and etc.
And finally I think the default field value is the subtype 
responsibility too.

Best regards,
     Dmitry

20.11.2014 01:14, Even Rouault ?????:
> Hi,
>
> This is a call for discussion on RFC 50: OGR field subtypes
>
> http://trac.osgeo.org/gdal/wiki/rfc50_ogr_field_subtype
>
> Below the summary :
> """
> This RFC aims at adding the capability of specifying sub-types to OGR fields,
> like boolean, 16 bit integers or 32 bit floating point values. The sub-type of
> a field definition is an additional attribute that specifies a hint or a
> restriction to the main type. The subtype can be used by applications and
> drivers that know how to handle it, and can generally be safely ignored by
> applications and drivers that do not.
> """
>
> Even


From grb at skogoglandskap.no  Thu Nov 20 03:47:03 2014
From: grb at skogoglandskap.no (Graeme B. Bell)
Date: Thu, 20 Nov 2014 11:47:03 +0000
Subject: [gdal-dev] gdal_calc.py and NoData issues
Message-ID: <84281B0E-B3DA-4E11-9CD9-4CE5831523BA@skogoglandskap.no>

Andreas,

>it turns out that all pixel values with 255 are now nodata values ;-( Is 
>there an option so that my 255 values are not turned into nodata? I 
>tested with the --NoDataValue option (e.g. 99 - which I don't use in the 
>image), but it seems to be ignored. For me it is important that black 
>and white pixels are preserved.

I submitted a patch to help with this sort of thing to the GDAL team 17 months ago which is unfortunately being blocked/ignored longterm for (what I consider to be) very unwise reasons.

https://trac.osgeo.org/gdal/ticket/5130

In the meantime I suggest you can download this alternative version that will give you full control over how nodata in controlled across multiple rasters. It's only a couple of lines patched from the original version. We use it on national scale rasters here with very complex functions, but it works just as well for easy functions.

https://github.com/gbb/gbb_gdal_calc

Graeme.

From even.rouault at spatialys.com  Thu Nov 20 05:38:39 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 20 Nov 2014 14:38:39 +0100
Subject: [gdal-dev] Call for discussion on RFC 50: OGR field subtypes
In-Reply-To: <546D3574.8020109@gmail.com>
References: <201411192314.19033.even.rouault@spatialys.com>
	<546D3574.8020109@gmail.com>
Message-ID: <201411201438.39949.even.rouault@spatialys.com>

Hi Dmitriy,

> And what about string list field subtype?
> I.e. I need restricted String field to accept only predefined strings
> from the list?

That could potentially be modeled with a OFSTEnumeration subtype, and an extra 
member variable of OGRFieldDefn with the list of accepted strings. A similar 
idea could be used to model coded values, OFSTCodedEnumeration? + a map, found 
for example in some FileGDB tables, as explained recently in 
http://trac.osgeo.org/gdal/ticket/5741. 

> Also for integer or dates fields the value range(s) or time period(s)
> set will be worth adding. I.e. the tube_width (Integer) can only be in
> range 100-183 and etc.

I'm not sure how drivers would get those constraints though ? From SQL CHECK 
constraints ?  Or would it be something that would be set by the application ?

> And finally I think the default field value is the subtype
> responsibility too.

Not sure what you mean. There's already an embryonic default field value 
mechanism, but AFAIK, it is not used anywhere in the code base except in 
ogrfielddefn.cpp, and there's this comment whose rationale I don't have 
knowledge above.

/**
 * \brief Set default field value.
 *
 * Currently use of OGRFieldDefn "defaults" is discouraged.  This feature
 * may be fleshed out in the future.
 *
 */

void OGRFieldDefn::SetDefault( const OGRField * puDefaultIn )


Anyway, I believe there's potential for further enhancements in that area, but 
I'd like to keep this RFC focused on the subtypes already mentionned in it.

Best regards,

Even

> 
> Best regards,
>      Dmitry
> 
> 20.11.2014 01:14, Even Rouault ?????:
> > Hi,
> > 
> > This is a call for discussion on RFC 50: OGR field subtypes
> > 
> > http://trac.osgeo.org/gdal/wiki/rfc50_ogr_field_subtype
> > 
> > Below the summary :
> > """
> > This RFC aims at adding the capability of specifying sub-types to OGR
> > fields, like boolean, 16 bit integers or 32 bit floating point values.
> > The sub-type of a field definition is an additional attribute that
> > specifies a hint or a restriction to the main type. The subtype can be
> > used by applications and drivers that know how to handle it, and can
> > generally be safely ignored by applications and drivers that do not.
> > """
> > 
> > Even
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From pepijn at vaneeckhoudt.net  Thu Nov 20 10:30:47 2014
From: pepijn at vaneeckhoudt.net (Pepijn Van Eeckhoudt)
Date: Thu, 20 Nov 2014 19:30:47 +0100
Subject: [gdal-dev] Call for discussion on RFC 50: OGR field subtypes
In-Reply-To: <201411201438.39949.even.rouault@spatialys.com>
References: <201411192314.19033.even.rouault@spatialys.com>
	<546D3574.8020109@gmail.com>
	<201411201438.39949.even.rouault@spatialys.com>
Message-ID: <EE448008-A04B-4016-AEA9-F324A26136FF@vaneeckhoudt.net>

Hi Even,

For geopackage specifically, enumerations and ranges for primitive values can be encoded in gpkg_data_columns. These may or may not be enforced by check constraints, so it?s informative information. The idea is to make it easy for code to extract that meta information rather than having to parse and interpret SQL expressions.

Pepijn

> On 20 Nov 2014, at 14:38, Even Rouault <even.rouault at spatialys.com> wrote:
> 
> Hi Dmitriy,
> 
>> And what about string list field subtype?
>> I.e. I need restricted String field to accept only predefined strings
>> from the list?
> 
> That could potentially be modeled with a OFSTEnumeration subtype, and an extra 
> member variable of OGRFieldDefn with the list of accepted strings. A similar 
> idea could be used to model coded values, OFSTCodedEnumeration? + a map, found 
> for example in some FileGDB tables, as explained recently in 
> http://trac.osgeo.org/gdal/ticket/5741. 
> 
>> Also for integer or dates fields the value range(s) or time period(s)
>> set will be worth adding. I.e. the tube_width (Integer) can only be in
>> range 100-183 and etc.
> 
> I'm not sure how drivers would get those constraints though ? From SQL CHECK 
> constraints ?  Or would it be something that would be set by the application ?
> 
>> And finally I think the default field value is the subtype
>> responsibility too.
> 
> Not sure what you mean. There's already an embryonic default field value 
> mechanism, but AFAIK, it is not used anywhere in the code base except in 
> ogrfielddefn.cpp, and there's this comment whose rationale I don't have 
> knowledge above.
> 
> /**
> * \brief Set default field value.
> *
> * Currently use of OGRFieldDefn "defaults" is discouraged.  This feature
> * may be fleshed out in the future.
> *
> */
> 
> void OGRFieldDefn::SetDefault( const OGRField * puDefaultIn )
> 
> 
> Anyway, I believe there's potential for further enhancements in that area, but 
> I'd like to keep this RFC focused on the subtypes already mentionned in it.
> 
> Best regards,
> 
> Even
> 
>> 
>> Best regards,
>>     Dmitry
>> 
>> 20.11.2014 01:14, Even Rouault ?????:
>>> Hi,
>>> 
>>> This is a call for discussion on RFC 50: OGR field subtypes
>>> 
>>> http://trac.osgeo.org/gdal/wiki/rfc50_ogr_field_subtype
>>> 
>>> Below the summary :
>>> """
>>> This RFC aims at adding the capability of specifying sub-types to OGR
>>> fields, like boolean, 16 bit integers or 32 bit floating point values.
>>> The sub-type of a field definition is an additional attribute that
>>> specifies a hint or a restriction to the main type. The subtype can be
>>> used by applications and drivers that know how to handle it, and can
>>> generally be safely ignored by applications and drivers that do not.
>>> """
>>> 
>>> Even
>> 
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4151 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141120/f7eacb5a/attachment.bin>

From jukka.rahkonen at mmmtike.fi  Fri Nov 21 04:55:16 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Fri, 21 Nov 2014 12:55:16 +0000 (UTC)
Subject: [gdal-dev] Simple schema support for GeoJSON
Message-ID: <loom.20141121T131321-831@post.gmane.org>

Hi,

I wonder if GDAL could have some simple and relatively user friendly way for
defining a schema for GeoJSON data. The GeoJSON driver seems to guess the
data types of attributes with some undocumented way but users could have
better knowledge about the desired schema.

I know I can control the data type by using OGR SQL and CAST as in
ogrinfo -sql "select cast(EMPLOYED as float) from OGRGeojson" states.json -so

However, perhaps GeoJSON is enough popular for deserving an easier way for
writing a schema. First I thought that it would be enough to copy the "csvt"
text file mechanism from the GDAL CSV driver
http://www.gdal.org/drv_csv.html. However, the csvt file is a plain list of
types which will be applied to the attributes in the same order than they
appear in the text file 
"Integer(5)","Real(10.7)","String(15)" 

For GeoJSON it would feel more user friendly to include the attribute names
in the list somehow like
 "population;Integer(5)","area;Real(10.7)","name;String(15)".

This would make it easier for users to write a valid "jsont" file. A list
with attribute names could perhaps also help GDAL as well because the
features in GeoJSON file do not necessarily have same attributes.

As an example this is the right schema for a WFS feature type which is
captured from
http://demo.opengeo.org/geoserver/wfs?service=wfs&version=1.0.0&request=describefeaturetype&typename=topp:states


name="the_geom" type="gml:MultiPolygonPropertyType"/> 
name="STATE_NAME" type="xsd:string"/> 
name="STATE_FIPS" type="xsd:string"/> 
name="SUB_REGION" type="xsd:string"/> 
name="STATE_ABBR" type="xsd:string"/> 
name="LAND_KM" type="xsd:double"/> 
name="WATER_KM" type="xsd:double"/> 
name="PERSONS" type="xsd:double"/> 
name="FAMILIES" type="xsd:double"/> 
name="HOUSHOLD" type="xsd:double"/> 
name="MALE" type="xsd:double"/> 
name="FEMALE" type="xsd:double"/> 
name="WORKERS" type="xsd:double"/> 
name="DRVALONE" type="xsd:double"/> 
name="CARPOOL" type="xsd:double"/> 
name="PUBTRANS" type="xsd:double"/> 
name="EMPLOYED" type="xsd:double"/> 
name="UNEMPLOY" type="xsd:double"/> 
name="SERVICE" type="xsd:double"/> 
name="MANUAL" type="xsd:double"/> 
name="P_MALE" type="xsd:double"/> 
name="P_FEMALE" type="xsd:double"/> 
name="SAMP_POP" type="xsd:double"/> 


This is what GDAL is guessing:
STATE_NAME: String (0.0)
STATE_FIPS: String (0.0)
SUB_REGION: String (0.0)
STATE_ABBR: String (0.0)
LAND_KM: Real (0.0)
WATER_KM: Real (0.0)
PERSONS: Real (0.0)
FAMILIES: Integer (0.0)
HOUSHOLD: Real (0.0)
MALE: Real (0.0)
FEMALE: Real (0.0)
WORKERS: Real (0.0)
DRVALONE: Integer (0.0)
CARPOOL: Integer (0.0)
PUBTRANS: Integer (0.0)
EMPLOYED: Real (0.0)
UNEMPLOY: Integer (0.0)
SERVICE: Integer (0.0)
MANUAL: Integer (0.0)
P_MALE: Real (0.0)
P_FEMALE: Real (0.0)
SAMP_POP: Integer (0.0)
bbox: RealList (0.0)

-Jukka Rahkonen-


From even.rouault at spatialys.com  Fri Nov 21 05:28:33 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 21 Nov 2014 14:28:33 +0100
Subject: [gdal-dev] Simple schema support for GeoJSON
In-Reply-To: <loom.20141121T131321-831@post.gmane.org>
References: <loom.20141121T131321-831@post.gmane.org>
Message-ID: <201411211428.33722.even.rouault@spatialys.com>

Jukka,

Data type guessing implemented in the OGR GeoJSON driver is quite natural hopefully.
A whole scan of the GeoJSON file is made and the following rules are applied :
- if an attribute has integer-only content --> Integer
- if an attribute has an array of integer-only content  --> IntegerList
- if an attribute has integer or floating point content --> Real
- if an attribute has an array of integer or floating point content --> RealList
- if an attribute has an array of anything else content --> StringList
- otherwise --> String

With RFC 50 and other pending improvements in the driver:
- if an attribute has boolean-only content --> Integer(Boolean)
- if an attribute has an array of boolean-only content --> IntegerList(Boolean)
- if an attribute has date-only content --> Date
- if an attribute has time-only content --> Time
- if an attribute has datetime or date content --> DateTime

I'm not sure we want to invent a .jsont format, but if you download
http://svn.osgeo.org/gdal/trunk/gdal/swig/python/samples/ogr2vrt.py

and run  :

python ogr2vrt.py "http://demo.opengeo.org/geoserver/wfs?service=wfs&version=1.0.0&request=getfeature&typename=topp:states&outputformat=json" test.vrt

This will create you a VRT with the default schema, that you can easily edit.
Note: as with OGR SQL CAST, this is post processing. So if the guess done by the GeoJSON driver
leads to a loss of information, you cannot recover it. Hopefully the implemented rules will not
lead to information loss.

A better approach would be to have the schema embedded in a JSON way in the GeoJSON file itself.
That could be an evolution of the format, but I'm not sure this would be really popular,
given JSON/GeoJSON is heavily used by NoSQL approaches...

Hum, doing a quick search, I just found http://json-schema.org/ that appears to be an IETF draft.
It doesn't look that the schema is embedded in the data file itself.

There's also GeoJSON-LD that might be a bit related : https://github.com/geojson/geojson-ld

CC'ing Sean in case he has thoughts on this.

Even

> Hi,
> 
> I wonder if GDAL could have some simple and relatively user friendly way
> for defining a schema for GeoJSON data. The GeoJSON driver seems to guess
> the data types of attributes with some undocumented way but users could
> have better knowledge about the desired schema.
> 
> I know I can control the data type by using OGR SQL and CAST as in
> ogrinfo -sql "select cast(EMPLOYED as float) from OGRGeojson" states.json
> -so
> 
> However, perhaps GeoJSON is enough popular for deserving an easier way for
> writing a schema. First I thought that it would be enough to copy the
> "csvt" text file mechanism from the GDAL CSV driver
> http://www.gdal.org/drv_csv.html. However, the csvt file is a plain list of
> types which will be applied to the attributes in the same order than they
> appear in the text file
> "Integer(5)","Real(10.7)","String(15)"
> 
> For GeoJSON it would feel more user friendly to include the attribute names
> in the list somehow like
>  "population;Integer(5)","area;Real(10.7)","name;String(15)".
> 
> This would make it easier for users to write a valid "jsont" file. A list
> with attribute names could perhaps also help GDAL as well because the
> features in GeoJSON file do not necessarily have same attributes.
> 
> As an example this is the right schema for a WFS feature type which is
> captured from
> http://demo.opengeo.org/geoserver/wfs?service=wfs&version=1.0.0&request=des
> cribefeaturetype&typename=topp:states
> 
> 
> name="the_geom" type="gml:MultiPolygonPropertyType"/>
> name="STATE_NAME" type="xsd:string"/>
> name="STATE_FIPS" type="xsd:string"/>
> name="SUB_REGION" type="xsd:string"/>
> name="STATE_ABBR" type="xsd:string"/>
> name="LAND_KM" type="xsd:double"/>
> name="WATER_KM" type="xsd:double"/>
> name="PERSONS" type="xsd:double"/>
> name="FAMILIES" type="xsd:double"/>
> name="HOUSHOLD" type="xsd:double"/>
> name="MALE" type="xsd:double"/>
> name="FEMALE" type="xsd:double"/>
> name="WORKERS" type="xsd:double"/>
> name="DRVALONE" type="xsd:double"/>
> name="CARPOOL" type="xsd:double"/>
> name="PUBTRANS" type="xsd:double"/>
> name="EMPLOYED" type="xsd:double"/>
> name="UNEMPLOY" type="xsd:double"/>
> name="SERVICE" type="xsd:double"/>
> name="MANUAL" type="xsd:double"/>
> name="P_MALE" type="xsd:double"/>
> name="P_FEMALE" type="xsd:double"/>
> name="SAMP_POP" type="xsd:double"/>
> 
> 
> This is what GDAL is guessing:
> STATE_NAME: String (0.0)
> STATE_FIPS: String (0.0)
> SUB_REGION: String (0.0)
> STATE_ABBR: String (0.0)
> LAND_KM: Real (0.0)
> WATER_KM: Real (0.0)
> PERSONS: Real (0.0)
> FAMILIES: Integer (0.0)
> HOUSHOLD: Real (0.0)
> MALE: Real (0.0)
> FEMALE: Real (0.0)
> WORKERS: Real (0.0)
> DRVALONE: Integer (0.0)
> CARPOOL: Integer (0.0)
> PUBTRANS: Integer (0.0)
> EMPLOYED: Real (0.0)
> UNEMPLOY: Integer (0.0)
> SERVICE: Integer (0.0)
> MANUAL: Integer (0.0)
> P_MALE: Real (0.0)
> P_FEMALE: Real (0.0)
> SAMP_POP: Integer (0.0)
> bbox: RealList (0.0)
> 
> -Jukka Rahkonen-
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at mmmtike.fi  Fri Nov 21 06:35:43 2014
From: jukka.rahkonen at mmmtike.fi (Rahkonen Jukka (Tike))
Date: Fri, 21 Nov 2014 14:35:43 +0000
Subject: [gdal-dev] Simple schema support for GeoJSON
Message-ID: <77c9adae32d14d259ae09a151fa9a16c@C119S212VM017.msvyvi.vaha.local>

Hi,

I have no use for this feature myself but by reading various mailing lists and forums I have learned that many people consider it is always a good idea to read data for example from WFS services as GeoJSON instead of GML. I can easily imagine that there will be troubles with guess-by-data method if they are making subsequent requests from the service. For example strings which are all numbers but which may contain leading zeroes are saved either to integers or strings  if leading zeroes are interpreted right at all. Or floats which do not always contain decimals, or list attributes which sometimes have only zero or one member.

Embedded schema feels optimal because then it would always travel together with the data and we all have probably lost .tfw or .prj files sometimes.

-Jukka-

Even Rouault wrote:

> Jukka,
> 
> Data type guessing implemented in the OGR GeoJSON driver is quite natural
> hopefully.
> A whole scan of the GeoJSON file is made and the following rules are applied :
> - if an attribute has integer-only content --> Integer
> - if an attribute has an array of integer-only content  --> IntegerList
> - if an attribute has integer or floating point content --> Real
> - if an attribute has an array of integer or floating point content --> RealList
> - if an attribute has an array of anything else content --> StringList
> - otherwise --> String
> 
> With RFC 50 and other pending improvements in the driver:
> - if an attribute has boolean-only content --> Integer(Boolean)
> - if an attribute has an array of boolean-only content --> IntegerList(Boolean)
> - if an attribute has date-only content --> Date
> - if an attribute has time-only content --> Time
> - if an attribute has datetime or date content --> DateTime
> 
> I'm not sure we want to invent a .jsont format, but if you download
> http://svn.osgeo.org/gdal/trunk/gdal/swig/python/samples/ogr2vrt.py
> 
> and run  :
> 
> python ogr2vrt.py
> "http://demo.opengeo.org/geoserver/wfs?service=wfs&version=1.0.0&request
> =getfeature&typename=topp:states&outputformat=json" test.vrt
> 
> This will create you a VRT with the default schema, that you can easily edit.
> Note: as with OGR SQL CAST, this is post processing. So if the guess done by the
> GeoJSON driver leads to a loss of information, you cannot recover it. Hopefully
> the implemented rules will not lead to information loss.
> 
> A better approach would be to have the schema embedded in a JSON way in the
> GeoJSON file itself.
> That could be an evolution of the format, but I'm not sure this would be really
> popular, given JSON/GeoJSON is heavily used by NoSQL approaches...
> 
> Hum, doing a quick search, I just found http://json-schema.org/ that appears to
> be an IETF draft.
> It doesn't look that the schema is embedded in the data file itself.
> 
> There's also GeoJSON-LD that might be a bit related :
> https://github.com/geojson/geojson-ld
> 
> CC'ing Sean in case he has thoughts on this.
> 
> Even
> 
> > Hi,
> >
> > I wonder if GDAL could have some simple and relatively user friendly
> > way for defining a schema for GeoJSON data. The GeoJSON driver seems
> > to guess the data types of attributes with some undocumented way but
> > users could have better knowledge about the desired schema.
> >
> > I know I can control the data type by using OGR SQL and CAST as in
> > ogrinfo -sql "select cast(EMPLOYED as float) from OGRGeojson"
> > states.json -so
> >
> > However, perhaps GeoJSON is enough popular for deserving an easier way
> > for writing a schema. First I thought that it would be enough to copy
> > the "csvt" text file mechanism from the GDAL CSV driver
> > http://www.gdal.org/drv_csv.html. However, the csvt file is a plain
> > list of types which will be applied to the attributes in the same
> > order than they appear in the text file
> > "Integer(5)","Real(10.7)","String(15)"
> >
> > For GeoJSON it would feel more user friendly to include the attribute
> > names in the list somehow like
> > "population;Integer(5)","area;Real(10.7)","name;String(15)".
> >
> > This would make it easier for users to write a valid "jsont" file. A
> > list with attribute names could perhaps also help GDAL as well because
> > the features in GeoJSON file do not necessarily have same attributes.
> >
> > As an example this is the right schema for a WFS feature type which is
> > captured from
> > http://demo.opengeo.org/geoserver/wfs?service=wfs&version=1.0.0&reques
> > t=des
> > cribefeaturetype&typename=topp:states
> >
> >
> > name="the_geom" type="gml:MultiPolygonPropertyType"/>
> > name="STATE_NAME" type="xsd:string"/>
> > name="STATE_FIPS" type="xsd:string"/>
> > name="SUB_REGION" type="xsd:string"/>
> > name="STATE_ABBR" type="xsd:string"/>
> > name="LAND_KM" type="xsd:double"/>
> > name="WATER_KM" type="xsd:double"/>
> > name="PERSONS" type="xsd:double"/>
> > name="FAMILIES" type="xsd:double"/>
> > name="HOUSHOLD" type="xsd:double"/>
> > name="MALE" type="xsd:double"/>
> > name="FEMALE" type="xsd:double"/>
> > name="WORKERS" type="xsd:double"/>
> > name="DRVALONE" type="xsd:double"/>
> > name="CARPOOL" type="xsd:double"/>
> > name="PUBTRANS" type="xsd:double"/>
> > name="EMPLOYED" type="xsd:double"/>
> > name="UNEMPLOY" type="xsd:double"/>
> > name="SERVICE" type="xsd:double"/>
> > name="MANUAL" type="xsd:double"/>
> > name="P_MALE" type="xsd:double"/>
> > name="P_FEMALE" type="xsd:double"/>
> > name="SAMP_POP" type="xsd:double"/>
> >
> >
> > This is what GDAL is guessing:
> > STATE_NAME: String (0.0)
> > STATE_FIPS: String (0.0)
> > SUB_REGION: String (0.0)
> > STATE_ABBR: String (0.0)
> > LAND_KM: Real (0.0)
> > WATER_KM: Real (0.0)
> > PERSONS: Real (0.0)
> > FAMILIES: Integer (0.0)
> > HOUSHOLD: Real (0.0)
> > MALE: Real (0.0)
> > FEMALE: Real (0.0)
> > WORKERS: Real (0.0)
> > DRVALONE: Integer (0.0)
> > CARPOOL: Integer (0.0)
> > PUBTRANS: Integer (0.0)
> > EMPLOYED: Real (0.0)
> > UNEMPLOY: Integer (0.0)
> > SERVICE: Integer (0.0)
> > MANUAL: Integer (0.0)
> > P_MALE: Real (0.0)
> > P_FEMALE: Real (0.0)
> > SAMP_POP: Integer (0.0)
> > bbox: RealList (0.0)
> >
> > -Jukka Rahkonen-
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> --
> Spatialys - Geospatial professional services http://www.spatialys.com

From even.rouault at spatialys.com  Fri Nov 21 07:02:55 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 21 Nov 2014 16:02:55 +0100
Subject: [gdal-dev] Simple schema support for GeoJSON
In-Reply-To: <77c9adae32d14d259ae09a151fa9a16c@C119S212VM017.msvyvi.vaha.local>
References: <77c9adae32d14d259ae09a151fa9a16c@C119S212VM017.msvyvi.vaha.local>
Message-ID: <201411211602.56199.even.rouault@spatialys.com>

Le vendredi 21 novembre 2014 15:35:43, Rahkonen Jukka (Tike) a ?crit :
> Hi,
> 
> I have no use for this feature myself but by reading various mailing lists
> and forums I have learned that many people consider it is always a good
> idea to read data for example from WFS services as GeoJSON instead of GML.

Because it consumes less bandwidth ?

For the record, if you try the following, it will use the GML schema for the user
exposed layer and will do a on-the-fly transform from the hidden GeoJSON layer schema
to the GML schema, similarly to the one you could do with a CAST/VRT.

$ ogrinfo "WFS:http://demo.opengeo.org/geoserver/wfs?service=wfs&version=1.0.0&request=getfeature&typename=topp:states&outputformat=json" -ro -al -where "STATE_NAME = 'California'"

Layer name: topp:states
Geometry: Multi Polygon
Feature Count: 1
Extent: (-124.391472, 32.535725) - (-114.124451, 42.002346)
Layer SRS WKT:
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563,
            AUTHORITY["EPSG","7030"]],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0,
        AUTHORITY["EPSG","8901"]],
    UNIT["degree",0.0174532925199433,
        AUTHORITY["EPSG","9122"]],
    AUTHORITY["EPSG","4326"]]
gml_id: String (0.0)
STATE_NAME: String (0.0)
STATE_FIPS: String (0.0)
SUB_REGION: String (0.0)
STATE_ABBR: String (0.0)
LAND_KM: Real (0.0)
WATER_KM: Real (0.0)
PERSONS: Real (0.0)
FAMILIES: Real (0.0)
HOUSHOLD: Real (0.0)
MALE: Real (0.0)
FEMALE: Real (0.0)
WORKERS: Real (0.0)
DRVALONE: Real (0.0)
CARPOOL: Real (0.0)
PUBTRANS: Real (0.0)
EMPLOYED: Real (0.0)
UNEMPLOY: Real (0.0)
SERVICE: Real (0.0)
MANUAL: Real (0.0)
P_MALE: Real (0.0)
P_FEMALE: Real (0.0)
SAMP_POP: Real (0.0)
OGRFeature(topp:states):0
  gml_id (String) = (null)
  STATE_NAME (String) = California
  STATE_FIPS (String) = 06
  SUB_REGION (String) = Pacific
  STATE_ABBR (String) = CA
  LAND_KM (Real) = 403970.143
  WATER_KM (Real) = 20023.368
  PERSONS (Real) = 29760021
  FAMILIES (Real) = 7139394
  HOUSHOLD (Real) = 10381206
  MALE (Real) = 14897627
  FEMALE (Real) = 14862394
  WORKERS (Real) = 11306576
  DRVALONE (Real) = 9982242
  CARPOOL (Real) = 2036025
  PUBTRANS (Real) = 685797
  EMPLOYED (Real) = 13996309
  UNEMPLOY (Real) = 996502
  SERVICE (Real) = 3664771
  MANUAL (Real) = 1798201
  P_MALE (Real) = 0.501
  P_FEMALE (Real) = 0.499
  SAMP_POP (Real) = 3792553
  MULTIPOLYGON (((....)))

> I can easily imagine that there will be troubles with guess-by-data method
> if they are making subsequent requests from the service. For example
> strings which are all numbers but which may contain leading zeroes are
> saved either to integers or strings  if leading zeroes are interpreted
> right at all. 

In JSON, "00123" and 00123 are different objects. So a string with leading zeros should be serialized as "00123" and not 00123. If it is serialized as "00123", the GeoJSON driver will interpret it as a 
string.

> Or floats which do not always contain decimals, or list
> attributes which sometimes have only zero or one member.

Yes, those cases could cause issues.

> 
> Embedded schema feels optimal because then it would always travel together
> with the data and we all have probably lost .tfw or .prj files sometimes.
> 
> -Jukka-
> 
> Even Rouault wrote:
> > Jukka,
> > 
> > Data type guessing implemented in the OGR GeoJSON driver is quite natural
> > hopefully.
> > A whole scan of the GeoJSON file is made and the following rules are
> > applied : - if an attribute has integer-only content --> Integer
> > - if an attribute has an array of integer-only content  --> IntegerList
> > - if an attribute has integer or floating point content --> Real
> > - if an attribute has an array of integer or floating point content -->
> > RealList - if an attribute has an array of anything else content -->
> > StringList - otherwise --> String
> > 
> > With RFC 50 and other pending improvements in the driver:
> > - if an attribute has boolean-only content --> Integer(Boolean)
> > - if an attribute has an array of boolean-only content -->
> > IntegerList(Boolean) - if an attribute has date-only content --> Date
> > - if an attribute has time-only content --> Time
> > - if an attribute has datetime or date content --> DateTime
> > 
> > I'm not sure we want to invent a .jsont format, but if you download
> > http://svn.osgeo.org/gdal/trunk/gdal/swig/python/samples/ogr2vrt.py
> > 
> > and run  :
> > 
> > python ogr2vrt.py
> > "http://demo.opengeo.org/geoserver/wfs?service=wfs&version=1.0.0&request
> > =getfeature&typename=topp:states&outputformat=json" test.vrt
> > 
> > This will create you a VRT with the default schema, that you can easily
> > edit. Note: as with OGR SQL CAST, this is post processing. So if the
> > guess done by the GeoJSON driver leads to a loss of information, you
> > cannot recover it. Hopefully the implemented rules will not lead to
> > information loss.
> > 
> > A better approach would be to have the schema embedded in a JSON way in
> > the GeoJSON file itself.
> > That could be an evolution of the format, but I'm not sure this would be
> > really popular, given JSON/GeoJSON is heavily used by NoSQL
> > approaches...
> > 
> > Hum, doing a quick search, I just found http://json-schema.org/ that
> > appears to be an IETF draft.
> > It doesn't look that the schema is embedded in the data file itself.
> > 
> > There's also GeoJSON-LD that might be a bit related :
> > https://github.com/geojson/geojson-ld
> > 
> > CC'ing Sean in case he has thoughts on this.
> > 
> > Even
> > 
> > > Hi,
> > > 
> > > I wonder if GDAL could have some simple and relatively user friendly
> > > way for defining a schema for GeoJSON data. The GeoJSON driver seems
> > > to guess the data types of attributes with some undocumented way but
> > > users could have better knowledge about the desired schema.
> > > 
> > > I know I can control the data type by using OGR SQL and CAST as in
> > > ogrinfo -sql "select cast(EMPLOYED as float) from OGRGeojson"
> > > states.json -so
> > > 
> > > However, perhaps GeoJSON is enough popular for deserving an easier way
> > > for writing a schema. First I thought that it would be enough to copy
> > > the "csvt" text file mechanism from the GDAL CSV driver
> > > http://www.gdal.org/drv_csv.html. However, the csvt file is a plain
> > > list of types which will be applied to the attributes in the same
> > > order than they appear in the text file
> > > "Integer(5)","Real(10.7)","String(15)"
> > > 
> > > For GeoJSON it would feel more user friendly to include the attribute
> > > names in the list somehow like
> > > "population;Integer(5)","area;Real(10.7)","name;String(15)".
> > > 
> > > This would make it easier for users to write a valid "jsont" file. A
> > > list with attribute names could perhaps also help GDAL as well because
> > > the features in GeoJSON file do not necessarily have same attributes.
> > > 
> > > As an example this is the right schema for a WFS feature type which is
> > > captured from
> > > http://demo.opengeo.org/geoserver/wfs?service=wfs&version=1.0.0&reques
> > > t=des
> > > cribefeaturetype&typename=topp:states
> > > 
> > > 
> > > name="the_geom" type="gml:MultiPolygonPropertyType"/>
> > > name="STATE_NAME" type="xsd:string"/>
> > > name="STATE_FIPS" type="xsd:string"/>
> > > name="SUB_REGION" type="xsd:string"/>
> > > name="STATE_ABBR" type="xsd:string"/>
> > > name="LAND_KM" type="xsd:double"/>
> > > name="WATER_KM" type="xsd:double"/>
> > > name="PERSONS" type="xsd:double"/>
> > > name="FAMILIES" type="xsd:double"/>
> > > name="HOUSHOLD" type="xsd:double"/>
> > > name="MALE" type="xsd:double"/>
> > > name="FEMALE" type="xsd:double"/>
> > > name="WORKERS" type="xsd:double"/>
> > > name="DRVALONE" type="xsd:double"/>
> > > name="CARPOOL" type="xsd:double"/>
> > > name="PUBTRANS" type="xsd:double"/>
> > > name="EMPLOYED" type="xsd:double"/>
> > > name="UNEMPLOY" type="xsd:double"/>
> > > name="SERVICE" type="xsd:double"/>
> > > name="MANUAL" type="xsd:double"/>
> > > name="P_MALE" type="xsd:double"/>
> > > name="P_FEMALE" type="xsd:double"/>
> > > name="SAMP_POP" type="xsd:double"/>
> > > 
> > > 
> > > This is what GDAL is guessing:
> > > STATE_NAME: String (0.0)
> > > STATE_FIPS: String (0.0)
> > > SUB_REGION: String (0.0)
> > > STATE_ABBR: String (0.0)
> > > LAND_KM: Real (0.0)
> > > WATER_KM: Real (0.0)
> > > PERSONS: Real (0.0)
> > > FAMILIES: Integer (0.0)
> > > HOUSHOLD: Real (0.0)
> > > MALE: Real (0.0)
> > > FEMALE: Real (0.0)
> > > WORKERS: Real (0.0)
> > > DRVALONE: Integer (0.0)
> > > CARPOOL: Integer (0.0)
> > > PUBTRANS: Integer (0.0)
> > > EMPLOYED: Real (0.0)
> > > UNEMPLOY: Integer (0.0)
> > > SERVICE: Integer (0.0)
> > > MANUAL: Integer (0.0)
> > > P_MALE: Real (0.0)
> > > P_FEMALE: Real (0.0)
> > > SAMP_POP: Integer (0.0)
> > > bbox: RealList (0.0)
> > > 
> > > -Jukka Rahkonen-
> > > 
> > > _______________________________________________
> > > gdal-dev mailing list
> > > gdal-dev at lists.osgeo.org
> > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > 
> > --
> > Spatialys - Geospatial professional services http://www.spatialys.com
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ao at t-kartor.se  Fri Nov 21 07:17:49 2014
From: ao at t-kartor.se (Andreas Oxenstierna)
Date: Fri, 21 Nov 2014 16:17:49 +0100
Subject: [gdal-dev] Simple schema support for GeoJSON
In-Reply-To: <201411211602.56199.even.rouault@spatialys.com>
References: <77c9adae32d14d259ae09a151fa9a16c@C119S212VM017.msvyvi.vaha.local>
	<201411211602.56199.even.rouault@spatialys.com>
Message-ID: <546F579D.80801@t-kartor.se>

Hi

The normal reason to select GeoJSON for geoweb applications is that JSON 
is parsed directly by the web browser, i.e. you get JavaScript objects
directly digestable by your JavaScript code. This may be also 
considerable faster than parsing XML.
Bandwidth is more or less irrelevant in comparison.

> Le vendredi 21 novembre 2014 15:35:43, Rahkonen Jukka (Tike) a ?crit :
>> Hi,
>>
>> I have no use for this feature myself but by reading various mailing lists
>> and forums I have learned that many people consider it is always a good
>> idea to read data for example from WFS services as GeoJSON instead of GML.
> Because it consumes less bandwidth ?
>
> For the record, if you try the following, it will use the GML schema for the user
> exposed layer and will do a on-the-fly transform from the hidden GeoJSON layer schema
> to the GML schema, similarly to the one you could do with a CAST/VRT.
>
> $ ogrinfo "WFS:http://demo.opengeo.org/geoserver/wfs?service=wfs&version=1.0.0&request=getfeature&typename=topp:states&outputformat=json" -ro -al -where "STATE_NAME = 'California'"
>
> Layer name: topp:states
> Geometry: Multi Polygon
> Feature Count: 1
> Extent: (-124.391472, 32.535725) - (-114.124451, 42.002346)
> Layer SRS WKT:
> GEOGCS["WGS 84",
>      DATUM["WGS_1984",
>          SPHEROID["WGS 84",6378137,298.257223563,
>              AUTHORITY["EPSG","7030"]],
>          AUTHORITY["EPSG","6326"]],
>      PRIMEM["Greenwich",0,
>          AUTHORITY["EPSG","8901"]],
>      UNIT["degree",0.0174532925199433,
>          AUTHORITY["EPSG","9122"]],
>      AUTHORITY["EPSG","4326"]]
> gml_id: String (0.0)
> STATE_NAME: String (0.0)
> STATE_FIPS: String (0.0)
> SUB_REGION: String (0.0)
> STATE_ABBR: String (0.0)
> LAND_KM: Real (0.0)
> WATER_KM: Real (0.0)
> PERSONS: Real (0.0)
> FAMILIES: Real (0.0)
> HOUSHOLD: Real (0.0)
> MALE: Real (0.0)
> FEMALE: Real (0.0)
> WORKERS: Real (0.0)
> DRVALONE: Real (0.0)
> CARPOOL: Real (0.0)
> PUBTRANS: Real (0.0)
> EMPLOYED: Real (0.0)
> UNEMPLOY: Real (0.0)
> SERVICE: Real (0.0)
> MANUAL: Real (0.0)
> P_MALE: Real (0.0)
> P_FEMALE: Real (0.0)
> SAMP_POP: Real (0.0)
> OGRFeature(topp:states):0
>    gml_id (String) = (null)
>    STATE_NAME (String) = California
>    STATE_FIPS (String) = 06
>    SUB_REGION (String) = Pacific
>    STATE_ABBR (String) = CA
>    LAND_KM (Real) = 403970.143
>    WATER_KM (Real) = 20023.368
>    PERSONS (Real) = 29760021
>    FAMILIES (Real) = 7139394
>    HOUSHOLD (Real) = 10381206
>    MALE (Real) = 14897627
>    FEMALE (Real) = 14862394
>    WORKERS (Real) = 11306576
>    DRVALONE (Real) = 9982242
>    CARPOOL (Real) = 2036025
>    PUBTRANS (Real) = 685797
>    EMPLOYED (Real) = 13996309
>    UNEMPLOY (Real) = 996502
>    SERVICE (Real) = 3664771
>    MANUAL (Real) = 1798201
>    P_MALE (Real) = 0.501
>    P_FEMALE (Real) = 0.499
>    SAMP_POP (Real) = 3792553
>    MULTIPOLYGON (((....)))
>
>> I can easily imagine that there will be troubles with guess-by-data method
>> if they are making subsequent requests from the service. For example
>> strings which are all numbers but which may contain leading zeroes are
>> saved either to integers or strings  if leading zeroes are interpreted
>> right at all.
> In JSON, "00123" and 00123 are different objects. So a string with leading zeros should be serialized as "00123" and not 00123. If it is serialized as "00123", the GeoJSON driver will interpret it as a
> string.
>
>> Or floats which do not always contain decimals, or list
>> attributes which sometimes have only zero or one member.
> Yes, those cases could cause issues.
>
>> Embedded schema feels optimal because then it would always travel together
>> with the data and we all have probably lost .tfw or .prj files sometimes.
>>
>> -Jukka-
>>
>> Even Rouault wrote:
>>> Jukka,
>>>
>>> Data type guessing implemented in the OGR GeoJSON driver is quite natural
>>> hopefully.
>>> A whole scan of the GeoJSON file is made and the following rules are
>>> applied : - if an attribute has integer-only content --> Integer
>>> - if an attribute has an array of integer-only content  --> IntegerList
>>> - if an attribute has integer or floating point content --> Real
>>> - if an attribute has an array of integer or floating point content -->
>>> RealList - if an attribute has an array of anything else content -->
>>> StringList - otherwise --> String
>>>
>>> With RFC 50 and other pending improvements in the driver:
>>> - if an attribute has boolean-only content --> Integer(Boolean)
>>> - if an attribute has an array of boolean-only content -->
>>> IntegerList(Boolean) - if an attribute has date-only content --> Date
>>> - if an attribute has time-only content --> Time
>>> - if an attribute has datetime or date content --> DateTime
>>>
>>> I'm not sure we want to invent a .jsont format, but if you download
>>> http://svn.osgeo.org/gdal/trunk/gdal/swig/python/samples/ogr2vrt.py
>>>
>>> and run  :
>>>
>>> python ogr2vrt.py
>>> "http://demo.opengeo.org/geoserver/wfs?service=wfs&version=1.0.0&request
>>> =getfeature&typename=topp:states&outputformat=json" test.vrt
>>>
>>> This will create you a VRT with the default schema, that you can easily
>>> edit. Note: as with OGR SQL CAST, this is post processing. So if the
>>> guess done by the GeoJSON driver leads to a loss of information, you
>>> cannot recover it. Hopefully the implemented rules will not lead to
>>> information loss.
>>>
>>> A better approach would be to have the schema embedded in a JSON way in
>>> the GeoJSON file itself.
>>> That could be an evolution of the format, but I'm not sure this would be
>>> really popular, given JSON/GeoJSON is heavily used by NoSQL
>>> approaches...
>>>
>>> Hum, doing a quick search, I just found http://json-schema.org/ that
>>> appears to be an IETF draft.
>>> It doesn't look that the schema is embedded in the data file itself.
>>>
>>> There's also GeoJSON-LD that might be a bit related :
>>> https://github.com/geojson/geojson-ld
>>>
>>> CC'ing Sean in case he has thoughts on this.
>>>
>>> Even
>>>
>>>> Hi,
>>>>
>>>> I wonder if GDAL could have some simple and relatively user friendly
>>>> way for defining a schema for GeoJSON data. The GeoJSON driver seems
>>>> to guess the data types of attributes with some undocumented way but
>>>> users could have better knowledge about the desired schema.
>>>>
>>>> I know I can control the data type by using OGR SQL and CAST as in
>>>> ogrinfo -sql "select cast(EMPLOYED as float) from OGRGeojson"
>>>> states.json -so
>>>>
>>>> However, perhaps GeoJSON is enough popular for deserving an easier way
>>>> for writing a schema. First I thought that it would be enough to copy
>>>> the "csvt" text file mechanism from the GDAL CSV driver
>>>> http://www.gdal.org/drv_csv.html. However, the csvt file is a plain
>>>> list of types which will be applied to the attributes in the same
>>>> order than they appear in the text file
>>>> "Integer(5)","Real(10.7)","String(15)"
>>>>
>>>> For GeoJSON it would feel more user friendly to include the attribute
>>>> names in the list somehow like
>>>> "population;Integer(5)","area;Real(10.7)","name;String(15)".
>>>>
>>>> This would make it easier for users to write a valid "jsont" file. A
>>>> list with attribute names could perhaps also help GDAL as well because
>>>> the features in GeoJSON file do not necessarily have same attributes.
>>>>
>>>> As an example this is the right schema for a WFS feature type which is
>>>> captured from
>>>> http://demo.opengeo.org/geoserver/wfs?service=wfs&version=1.0.0&reques
>>>> t=des
>>>> cribefeaturetype&typename=topp:states
>>>>
>>>>
>>>> name="the_geom" type="gml:MultiPolygonPropertyType"/>
>>>> name="STATE_NAME" type="xsd:string"/>
>>>> name="STATE_FIPS" type="xsd:string"/>
>>>> name="SUB_REGION" type="xsd:string"/>
>>>> name="STATE_ABBR" type="xsd:string"/>
>>>> name="LAND_KM" type="xsd:double"/>
>>>> name="WATER_KM" type="xsd:double"/>
>>>> name="PERSONS" type="xsd:double"/>
>>>> name="FAMILIES" type="xsd:double"/>
>>>> name="HOUSHOLD" type="xsd:double"/>
>>>> name="MALE" type="xsd:double"/>
>>>> name="FEMALE" type="xsd:double"/>
>>>> name="WORKERS" type="xsd:double"/>
>>>> name="DRVALONE" type="xsd:double"/>
>>>> name="CARPOOL" type="xsd:double"/>
>>>> name="PUBTRANS" type="xsd:double"/>
>>>> name="EMPLOYED" type="xsd:double"/>
>>>> name="UNEMPLOY" type="xsd:double"/>
>>>> name="SERVICE" type="xsd:double"/>
>>>> name="MANUAL" type="xsd:double"/>
>>>> name="P_MALE" type="xsd:double"/>
>>>> name="P_FEMALE" type="xsd:double"/>
>>>> name="SAMP_POP" type="xsd:double"/>
>>>>
>>>>
>>>> This is what GDAL is guessing:
>>>> STATE_NAME: String (0.0)
>>>> STATE_FIPS: String (0.0)
>>>> SUB_REGION: String (0.0)
>>>> STATE_ABBR: String (0.0)
>>>> LAND_KM: Real (0.0)
>>>> WATER_KM: Real (0.0)
>>>> PERSONS: Real (0.0)
>>>> FAMILIES: Integer (0.0)
>>>> HOUSHOLD: Real (0.0)
>>>> MALE: Real (0.0)
>>>> FEMALE: Real (0.0)
>>>> WORKERS: Real (0.0)
>>>> DRVALONE: Integer (0.0)
>>>> CARPOOL: Integer (0.0)
>>>> PUBTRANS: Integer (0.0)
>>>> EMPLOYED: Real (0.0)
>>>> UNEMPLOY: Integer (0.0)
>>>> SERVICE: Integer (0.0)
>>>> MANUAL: Integer (0.0)
>>>> P_MALE: Real (0.0)
>>>> P_FEMALE: Real (0.0)
>>>> SAMP_POP: Integer (0.0)
>>>> bbox: RealList (0.0)
>>>>
>>>> -Jukka Rahkonen-
>>>>
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev at lists.osgeo.org
>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>> --
>>> Spatialys - Geospatial professional services http://www.spatialys.com
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
H?lsningar

Andreas Oxenstierna
T-Kartan Produkt AB
mobile: +46 733 206831
mailto: ao at t-kartor.se
http://www.t-kartor.com


From jukka.rahkonen at mmmtike.fi  Fri Nov 21 07:43:18 2014
From: jukka.rahkonen at mmmtike.fi (Rahkonen Jukka (Tike))
Date: Fri, 21 Nov 2014 15:43:18 +0000
Subject: [gdal-dev] Simple schema support for GeoJSON
Message-ID: <7eb740171bc046d3a377596eababd746@C119S212VM017.msvyvi.vaha.local>

Even Rouault 

> Le vendredi 21 novembre 2014 15:35:43, Rahkonen Jukka (Tike) a ?crit :
> > Hi,
> >
> > I have no use for this feature myself but by reading various mailing
> > lists and forums I have learned that many people consider it is always
> > a good idea to read data for example from WFS services as GeoJSON instead
> of GML.
> 
> Because it consumes less bandwidth ?


I suppose rather that they generalize the good experiences about GeoJSON on browsers to mean that GML is poor for everything.  I found an interesting site http://jsperf.com/openlayers-format-reading-speed/2

I imagine that I can see a meaningful speed difference there indeed.

-Jukka-


From giantchen2010 at gmail.com  Fri Nov 21 07:55:43 2014
From: giantchen2010 at gmail.com (Jhon Chin)
Date: Fri, 21 Nov 2014 23:55:43 +0800
Subject: [gdal-dev] 0xc0000005 exception on loading pam.aux.xml when open
	gtiff
Message-ID: <CAKKorMnLJ1F4ZbMYhkqQPxCHUscnedkcGfvigNQ=rV=k53_gLA@mail.gmail.com>

Hi,everyone,






*I'm using gdal to open a gtiff with auxilary xml file,but the process is
crashed in CPLFree in Line 1208 @ cpl_minixml.cpp. *
*There is also another weird phenomenon , if i build my gdal dll without
dds driver, it works fine.As long as I add dds format support to my gdal
build, it will crash in the right place metioned above.*
*Hope anyone have ever encoutered such a situation offer me some
suggestion.*









Thanks in advace,
happy weekend.

                     Jhon Chin
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141121/9cd1774e/attachment.html>

From sean at mapbox.com  Fri Nov 21 08:25:06 2014
From: sean at mapbox.com (Sean Gillies)
Date: Fri, 21 Nov 2014 09:25:06 -0700
Subject: [gdal-dev] Simple schema support for GeoJSON
In-Reply-To: <201411211428.33722.even.rouault@spatialys.com>
References: <loom.20141121T131321-831@post.gmane.org>
	<201411211428.33722.even.rouault@spatialys.com>
Message-ID: <CADPhZXxYT1jNbbHB_OaNmy31t+XyrBm8b0X8FuKgZ0ZPoGm1LA@mail.gmail.com>

Hi Even, Jukka,

While the OGC service architecture is heavily dependent on schemas, OGR
type schemas are not *generally* useful for GeoJSON. Consider the following
abbreviated feature collection:

  "features": [
    {"properties": {"a": 0, "b": "lol"}, ...},
    {"properties": {"c": "2014-11-21", "d": "wut"}, ...}
  ]

It has two features and they are distinctly different types. A schema that
says these features have 4 fields would be nonsensical.

There are a bunch of different JSON schema approaches and none of them seem
to have any traction. https://github.com/json-schema/json-schema for
example looks to be stalled. I think the lack of traction reflects some
deeper reality: that XML and JSON have very different strengths and use
cases and that attempts to XML-ize JSON by adding schemas will always
eventually run out of steam.

For OGR to write schemas into GeoJSON would be a mistake. They could be
misleading and because there will never (as far as I can tell) be consensus
in the JSON community on the right form of schema, anything OGR implemented
would end up being a "loser".


On Fri, Nov 21, 2014 at 6:28 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Jukka,
>
> Data type guessing implemented in the OGR GeoJSON driver is quite natural
> hopefully.
> A whole scan of the GeoJSON file is made and the following rules are
> applied :
> - if an attribute has integer-only content --> Integer
> - if an attribute has an array of integer-only content  --> IntegerList
> - if an attribute has integer or floating point content --> Real
> - if an attribute has an array of integer or floating point content -->
> RealList
> - if an attribute has an array of anything else content --> StringList
> - otherwise --> String
>
> With RFC 50 and other pending improvements in the driver:
> - if an attribute has boolean-only content --> Integer(Boolean)
> - if an attribute has an array of boolean-only content -->
> IntegerList(Boolean)
> - if an attribute has date-only content --> Date
> - if an attribute has time-only content --> Time
> - if an attribute has datetime or date content --> DateTime
>
> I'm not sure we want to invent a .jsont format, but if you download
> http://svn.osgeo.org/gdal/trunk/gdal/swig/python/samples/ogr2vrt.py
>
> and run  :
>
> python ogr2vrt.py "
> http://demo.opengeo.org/geoserver/wfs?service=wfs&version=1.0.0&request=getfeature&typename=topp:states&outputformat=json"
> test.vrt
>
> This will create you a VRT with the default schema, that you can easily
> edit.
> Note: as with OGR SQL CAST, this is post processing. So if the guess done
> by the GeoJSON driver
> leads to a loss of information, you cannot recover it. Hopefully the
> implemented rules will not
> lead to information loss.
>
> A better approach would be to have the schema embedded in a JSON way in
> the GeoJSON file itself.
> That could be an evolution of the format, but I'm not sure this would be
> really popular,
> given JSON/GeoJSON is heavily used by NoSQL approaches...
>
> Hum, doing a quick search, I just found http://json-schema.org/ that
> appears to be an IETF draft.
> It doesn't look that the schema is embedded in the data file itself.
>
> There's also GeoJSON-LD that might be a bit related :
> https://github.com/geojson/geojson-ld
>
> CC'ing Sean in case he has thoughts on this.
>
> Even
>
> > Hi,
> >
> > I wonder if GDAL could have some simple and relatively user friendly way
> > for defining a schema for GeoJSON data. The GeoJSON driver seems to guess
> > the data types of attributes with some undocumented way but users could
> > have better knowledge about the desired schema.
> >
> > I know I can control the data type by using OGR SQL and CAST as in
> > ogrinfo -sql "select cast(EMPLOYED as float) from OGRGeojson" states.json
> > -so
> >
> > However, perhaps GeoJSON is enough popular for deserving an easier way
> for
> > writing a schema. First I thought that it would be enough to copy the
> > "csvt" text file mechanism from the GDAL CSV driver
> > http://www.gdal.org/drv_csv.html. However, the csvt file is a plain
> list of
> > types which will be applied to the attributes in the same order than they
> > appear in the text file
> > "Integer(5)","Real(10.7)","String(15)"
> >
> > For GeoJSON it would feel more user friendly to include the attribute
> names
> > in the list somehow like
> >  "population;Integer(5)","area;Real(10.7)","name;String(15)".
> >
> > This would make it easier for users to write a valid "jsont" file. A list
> > with attribute names could perhaps also help GDAL as well because the
> > features in GeoJSON file do not necessarily have same attributes.
> >
> > As an example this is the right schema for a WFS feature type which is
> > captured from
> >
> http://demo.opengeo.org/geoserver/wfs?service=wfs&version=1.0.0&request=des
> > cribefeaturetype&typename=topp:states
> >
> >
> > name="the_geom" type="gml:MultiPolygonPropertyType"/>
> > name="STATE_NAME" type="xsd:string"/>
> > name="STATE_FIPS" type="xsd:string"/>
> > name="SUB_REGION" type="xsd:string"/>
> > name="STATE_ABBR" type="xsd:string"/>
> > name="LAND_KM" type="xsd:double"/>
> > name="WATER_KM" type="xsd:double"/>
> > name="PERSONS" type="xsd:double"/>
> > name="FAMILIES" type="xsd:double"/>
> > name="HOUSHOLD" type="xsd:double"/>
> > name="MALE" type="xsd:double"/>
> > name="FEMALE" type="xsd:double"/>
> > name="WORKERS" type="xsd:double"/>
> > name="DRVALONE" type="xsd:double"/>
> > name="CARPOOL" type="xsd:double"/>
> > name="PUBTRANS" type="xsd:double"/>
> > name="EMPLOYED" type="xsd:double"/>
> > name="UNEMPLOY" type="xsd:double"/>
> > name="SERVICE" type="xsd:double"/>
> > name="MANUAL" type="xsd:double"/>
> > name="P_MALE" type="xsd:double"/>
> > name="P_FEMALE" type="xsd:double"/>
> > name="SAMP_POP" type="xsd:double"/>
> >
> >
> > This is what GDAL is guessing:
> > STATE_NAME: String (0.0)
> > STATE_FIPS: String (0.0)
> > SUB_REGION: String (0.0)
> > STATE_ABBR: String (0.0)
> > LAND_KM: Real (0.0)
> > WATER_KM: Real (0.0)
> > PERSONS: Real (0.0)
> > FAMILIES: Integer (0.0)
> > HOUSHOLD: Real (0.0)
> > MALE: Real (0.0)
> > FEMALE: Real (0.0)
> > WORKERS: Real (0.0)
> > DRVALONE: Integer (0.0)
> > CARPOOL: Integer (0.0)
> > PUBTRANS: Integer (0.0)
> > EMPLOYED: Real (0.0)
> > UNEMPLOY: Integer (0.0)
> > SERVICE: Integer (0.0)
> > MANUAL: Integer (0.0)
> > P_MALE: Real (0.0)
> > P_FEMALE: Real (0.0)
> > SAMP_POP: Integer (0.0)
> > bbox: RealList (0.0)
> >
> > -Jukka Rahkonen-
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141121/26343e73/attachment-0001.html>

From randre at gmail.com  Fri Nov 21 09:20:02 2014
From: randre at gmail.com (=?UTF-8?B?Um9nZXIgQW5kcsOp?=)
Date: Fri, 21 Nov 2014 09:20:02 -0800
Subject: [gdal-dev] georeferencing raster data using vector polygon
In-Reply-To: <CAHOqc_oKJOqfPf=x67996mjMBXxZc2Zb7KDnwgL5j_zndZWqVA@mail.gmail.com>
References: <CAHOqc_oKJOqfPf=x67996mjMBXxZc2Zb7KDnwgL5j_zndZWqVA@mail.gmail.com>
Message-ID: <CAOL+ROFmPJUrVuATQCeh2oWSmdtAUDmJwFb1TM=VqPaZ=pbo=w@mail.gmail.com>

Hi Simen,

Ok, here is how to implement the suggestion I gave, which was to create a
new worldfile and shift the image so that it fit the footprint vector
better.

1. Use gdal_edit.py with the "-unsetgt" option to remove the georeferencing
from the .tif
2. Then copy the attached .tfw file into the same dir as the .tif and view
it in relation to the KML footprint.
3.  You can tweak the alignment further by modifiying the bottom 2
coordinate values in the .tfw file.

Why do I advocate this method over warping the image using GCP's or QGis?
Because those are "lossy" processes.  In other words, the warping will
force a re-write of the pixel values using some sort of interpolation.  You
might still want to do that at the very end, like if you need  perfect
point-to-point matching against the footprint corners, but I still would
shift the image first.

Hope this helps,

Roger

On Wed, Nov 19, 2014 at 1:16 AM, Simen Langseth <simlangen at gmail.com> wrote:

>  I wanted to georeference the raster image in UTM coordinates into the
> boundry of red polygon with geographic coordinate system.
>
>
> https://drive.google.com/file/d/0B2RqG9tSAAIUc3J5ZDN6V01IcG8/view?usp=sharing
>
> I tried as follows:
>
> gdalwarp,-t_srs wgs84 -srcnodata 0 -dstnodata 0 -r near -te -96.75234
> 54.93479 -92.90071 56.91041 i
>
> What parameters should I provide for that?
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141121/c3d34c8b/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: p031r021.tfw
Type: application/octet-stream
Size: 91 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141121/c3d34c8b/attachment.obj>

From jukka.rahkonen at mmmtike.fi  Fri Nov 21 09:54:33 2014
From: jukka.rahkonen at mmmtike.fi (Rahkonen Jukka (Tike))
Date: Fri, 21 Nov 2014 17:54:33 +0000
Subject: [gdal-dev] Simple schema support for GeoJSON
In-Reply-To: <CADPhZXxYT1jNbbHB_OaNmy31t+XyrBm8b0X8FuKgZ0ZPoGm1LA@mail.gmail.com>
References: <loom.20141121T131321-831@post.gmane.org>
	<201411211428.33722.even.rouault@spatialys.com>,
	<CADPhZXxYT1jNbbHB_OaNmy31t+XyrBm8b0X8FuKgZ0ZPoGm1LA@mail.gmail.com>
Message-ID: <cc293df99f7f407d8a1d1e8dddcbf665@C119S212VM017.msvyvi.vaha.local>

Hi,


As I wrote, I got a motivation for my first mail because I have seen that people are quite often using GeoJSON for delivering geospatial data as data, to be saved on disk and used like shapefiles, GML etc. As a result you get stuff like this:

http://demo.opengeo.org/geoserver/wfs?service=wfs&version=1.0.0&request=getfeature&typename=topp:states&outputformat=application/json


You wrote and I agree with it "that XML and JSON have very different strengths and use cases ". However, people do what they want and I do feel that GeoJSON will be used for use cases where XML could be stronger like as the only supported format in some download services.


About the nonsensical 4-field schema, it is a little bit violent but just what about everybody who is using OpenStreetMap data is doing all the time. OSM features are pushed into traditional simple feature model and a set of tags are converted to attributes in a fixed schema. There are lots of null fields in the data and even that is in a way  nonsensical, it is also practical because it makes it possible to use osm2pgsql and PostGIS and Mapnik for rendering.


I am so fixated to consume data that I was not thinking at all about how to write GeoJSON with GDAL. I was just thinking that if some data are only available as GeoJSON, how users could convert it to PostGIS etc. so that the data types of the attributes will be the same as in the original data.


Because GeoJSON will not carry the data types as a payload I suppose that the current guess-the-datatype approach is the best starting point. Workaround by using VRT as Even suggested is good for fine tuning and cast with SQL works as well. The correct datatypes may still be somehow uncertain but perhaps those who maintain such services will announce the structure of their data on their web pages if they feel that it is important and they for example are awaiting data updates from users. When it comes to WFS, it seems to be an easy case because the XML schema can be reused as "GeoJSON schema".


-Jukka Rahkonen-



________________________________
Sean Gillies <sean at mapbox.com>

> Hi Even, Jukka,

> While the OGC service architecture is heavily dependent on schemas, OGR type schemas are not *generally* useful for GeoJSON. Consider the following abbreviated feature collection:

  "features": [
    {"properties": {"a": 0, "b": "lol"}, ...},
    {"properties": {"c": "2014-11-21", "d": "wut"}, ...}
  ]

> It has two features and they are distinctly different types. A schema that says these features have 4 fields would be nonsensical.

> There are a bunch of different JSON schema approaches and none of them seem to have any traction. https://github.com/json-schema/json-schema for example looks to be stalled. I think the lack of traction reflects some deeper reality: that XML and JSON have very different strengths and use cases and that attempts to XML-ize JSON by adding schemas will always eventually run out of steam.

> For OGR to write schemas into GeoJSON would be a mistake. They could be misleading and because there will never (as far as I can tell) be consensus in the JSON community on the right form of schema, anything OGR implemented would end up being a "loser".


On Fri, Nov 21, 2014 at 6:28 AM, Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>> wrote:
Jukka,

Data type guessing implemented in the OGR GeoJSON driver is quite natural hopefully.
A whole scan of the GeoJSON file is made and the following rules are applied :
- if an attribute has integer-only content --> Integer
- if an attribute has an array of integer-only content  --> IntegerList
- if an attribute has integer or floating point content --> Real
- if an attribute has an array of integer or floating point content --> RealList
- if an attribute has an array of anything else content --> StringList
- otherwise --> String

With RFC 50 and other pending improvements in the driver:
- if an attribute has boolean-only content --> Integer(Boolean)
- if an attribute has an array of boolean-only content --> IntegerList(Boolean)
- if an attribute has date-only content --> Date
- if an attribute has time-only content --> Time
- if an attribute has datetime or date content --> DateTime

I'm not sure we want to invent a .jsont format, but if you download
http://svn.osgeo.org/gdal/trunk/gdal/swig/python/samples/ogr2vrt.py

and run  :

python ogr2vrt.py "http://demo.opengeo.org/geoserver/wfs?service=wfs&version=1.0.0&request=getfeature&typename=topp:states&outputformat=json" test.vrt

This will create you a VRT with the default schema, that you can easily edit.
Note: as with OGR SQL CAST, this is post processing. So if the guess done by the GeoJSON driver
leads to a loss of information, you cannot recover it. Hopefully the implemented rules will not
lead to information loss.

A better approach would be to have the schema embedded in a JSON way in the GeoJSON file itself.
That could be an evolution of the format, but I'm not sure this would be really popular,
given JSON/GeoJSON is heavily used by NoSQL approaches...

Hum, doing a quick search, I just found http://json-schema.org/ that appears to be an IETF draft.
It doesn't look that the schema is embedded in the data file itself.

There's also GeoJSON-LD that might be a bit related : https://github.com/geojson/geojson-ld

CC'ing Sean in case he has thoughts on this.

Even

> Hi,
>
> I wonder if GDAL could have some simple and relatively user friendly way
> for defining a schema for GeoJSON data. The GeoJSON driver seems to guess
> the data types of attributes with some undocumented way but users could
> have better knowledge about the desired schema.
>
> I know I can control the data type by using OGR SQL and CAST as in
> ogrinfo -sql "select cast(EMPLOYED as float) from OGRGeojson" states.json
> -so
>
> However, perhaps GeoJSON is enough popular for deserving an easier way for
> writing a schema. First I thought that it would be enough to copy the
> "csvt" text file mechanism from the GDAL CSV driver
> http://www.gdal.org/drv_csv.html. However, the csvt file is a plain list of
> types which will be applied to the attributes in the same order than they
> appear in the text file
> "Integer(5)","Real(10.7)","String(15)"
>
> For GeoJSON it would feel more user friendly to include the attribute names
> in the list somehow like
>  "population;Integer(5)","area;Real(10.7)","name;String(15)".
>
> This would make it easier for users to write a valid "jsont" file. A list
> with attribute names could perhaps also help GDAL as well because the
> features in GeoJSON file do not necessarily have same attributes.
>
> As an example this is the right schema for a WFS feature type which is
> captured from
> http://demo.opengeo.org/geoserver/wfs?service=wfs&version=1.0.0&request=des
> cribefeaturetype&typename=topp:states
>
>
> name="the_geom" type="gml:MultiPolygonPropertyType"/>
> name="STATE_NAME" type="xsd:string"/>
> name="STATE_FIPS" type="xsd:string"/>
> name="SUB_REGION" type="xsd:string"/>
> name="STATE_ABBR" type="xsd:string"/>
> name="LAND_KM" type="xsd:double"/>
> name="WATER_KM" type="xsd:double"/>
> name="PERSONS" type="xsd:double"/>
> name="FAMILIES" type="xsd:double"/>
> name="HOUSHOLD" type="xsd:double"/>
> name="MALE" type="xsd:double"/>
> name="FEMALE" type="xsd:double"/>
> name="WORKERS" type="xsd:double"/>
> name="DRVALONE" type="xsd:double"/>
> name="CARPOOL" type="xsd:double"/>
> name="PUBTRANS" type="xsd:double"/>
> name="EMPLOYED" type="xsd:double"/>
> name="UNEMPLOY" type="xsd:double"/>
> name="SERVICE" type="xsd:double"/>
> name="MANUAL" type="xsd:double"/>
> name="P_MALE" type="xsd:double"/>
> name="P_FEMALE" type="xsd:double"/>
> name="SAMP_POP" type="xsd:double"/>
>
>
> This is what GDAL is guessing:
> STATE_NAME: String (0.0)
> STATE_FIPS: String (0.0)
> SUB_REGION: String (0.0)
> STATE_ABBR: String (0.0)
> LAND_KM: Real (0.0)
> WATER_KM: Real (0.0)
> PERSONS: Real (0.0)
> FAMILIES: Integer (0.0)
> HOUSHOLD: Real (0.0)
> MALE: Real (0.0)
> FEMALE: Real (0.0)
> WORKERS: Real (0.0)
> DRVALONE: Integer (0.0)
> CARPOOL: Integer (0.0)
> PUBTRANS: Integer (0.0)
> EMPLOYED: Real (0.0)
> UNEMPLOY: Integer (0.0)
> SERVICE: Integer (0.0)
> MANUAL: Integer (0.0)
> P_MALE: Real (0.0)
> P_FEMALE: Real (0.0)
> SAMP_POP: Integer (0.0)
> bbox: RealList (0.0)
>
> -Jukka Rahkonen-
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

--
Spatialys - Geospatial professional services
http://www.spatialys.com<http://www.spatialys.com/>
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141121/7d43929f/attachment-0001.html>

From wong.hua at gmail.com  Fri Nov 21 11:33:56 2014
From: wong.hua at gmail.com (Wong Hua)
Date: Fri, 21 Nov 2014 19:33:56 +0000
Subject: [gdal-dev] Trying to write a gridded XYZ from an cloud of points...
Message-ID: <CAA4Cqm71xXztvMJk7JiFJ=zz6DbGw1Pvp5JhpeWMYJNeCaWGQA@mail.gmail.com>

Hello, I am a osgeo4w user and very green in the field of geo data.

I am using gdal_grid to grid and ungridded set of points (a CSV file).

I ultimately want to use it with gdaltransform to change the projection
type and gdaltransform does not work with ungridded files from my
understanding.

The problem I have is that when I use gdal_grid, I get :
ERROR 6: GDALDriver::Create() ... no create method implemented for this
format
Unable to create target dataset "newgrid".
GDALDriver::Create() ... no create method implemented for this format

Here is the command line :
gdal_grid -zfield field_3 -of xyz -l grid grid.vrt newgrid

Is there anything I have to install to be able to write gridded XYZ files?

Thanks for any help.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141121/a5bc7c42/attachment.html>

From simlangen at gmail.com  Sat Nov 22 23:39:08 2014
From: simlangen at gmail.com (Simen Langseth)
Date: Sun, 23 Nov 2014 16:39:08 +0900
Subject: [gdal-dev] Unable to Mosaic Rasters Using Maximum Values
Message-ID: <CAHOqc_p=4MKOgNukbZjvs31xtQZJTnBEU68c4uUuqoykUYkbpQ@mail.gmail.com>

Dear GDAL Developers:

I want to mosaic several geo-refereced rasters using maximum value for the
overlapping areas. I looked for buildvrt and gdaltranslate but could not
find the way to use maximum values.
Is not it possible to modify the buildvrt method to do so or any other
means for it?
I can't use layerstacking because the extent of each raster to be mosaiced
are different.
Any ideas is highly appreciated.

Thanks.

Simen
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141123/2f97b379/attachment.html>

From simlangen at gmail.com  Sun Nov 23 08:04:05 2014
From: simlangen at gmail.com (Simen Langseth)
Date: Mon, 24 Nov 2014 01:04:05 +0900
Subject: [gdal-dev] Value Error While Writing the File in Chunks
Message-ID: <CAHOqc_qMzLkkQ3AAmW8Y08pDA66VXZThaKXyz3yGhg1xHT37Ow@mail.gmail.com>

import gdal, numpy as np
from gdalconst import *

infile = r"D:\given.tif"
inraster = gdal.Open(infile, GA_ReadOnly)
x_total,y_total=refraster.RasterXSize,refraster.RasterYSize
n_chunks=10
x_offsets=np.linspace(0,x_total,n_chunks).astype(int)
x_offsets=zip(x_offsets[:-1],x_offsets[1:])
y_offsets=np.linspace(0,y_total,n_chunks).astype(int)
y_offsets=zip(y_offsets[:-1],y_offsets[1:])

outfile =  r"D:\result.tif"
outraster =
gdal.GetDriverByName('GTiff').Create(outfile,y_total,x_total,1,gdal.GDT_Float32)
for x1,x2 in x_offsets:
    for y1,y2 in y_offsets:
        values = refraster.GetRasterBand(1).ReadAsArray(x1,y1,x2-x1,y2-y1)
        outraster.GetRasterBand(1).WriteArray(values, x1, y1)
inraster, outraster = None, None

I got the following error:

Traceback (most recent call last):
  File "D:\test.py", line 20, in <module>
    outraster.GetRasterBand(1).WriteArray(values, x1, y1)
  File "C:\Python27\lib\site-packages\osgeo\gdal.py", line 1167, in
WriteArray
    return gdalnumeric.BandWriteArray( self, array, xoff, yoff )
  File "C:\Python27\lib\site-packages\osgeo\gdal_array.py", line 304, in
BandWriteArray
    raise ValueError("array larger than output file, or offset off edge")
ValueError: array larger than output file, or offset off edge

How can I correct the writeArray?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141124/4b110a82/attachment.html>

From kyle at pobox.com  Sun Nov 23 08:41:41 2014
From: kyle at pobox.com (Kyle Shannon)
Date: Sun, 23 Nov 2014 09:41:41 -0700
Subject: [gdal-dev] Trying to write a gridded XYZ from an cloud of
	points...
In-Reply-To: <CAA4Cqm71xXztvMJk7JiFJ=zz6DbGw1Pvp5JhpeWMYJNeCaWGQA@mail.gmail.com>
References: <CAA4Cqm71xXztvMJk7JiFJ=zz6DbGw1Pvp5JhpeWMYJNeCaWGQA@mail.gmail.com>
Message-ID: <CAJ0mEz2gogpgo+bsxZJnLjMKp_KB7xNPJ+jUxJexu779D6Hutw@mail.gmail.com>

Wong,

On Fri, Nov 21, 2014 at 12:33 PM, Wong Hua <wong.hua at gmail.com> wrote:
> Hello, I am a osgeo4w user and very green in the field of geo data.
>
> I am using gdal_grid to grid and ungridded set of points (a CSV file).
>
> I ultimately want to use it with gdaltransform to change the projection type
> and gdaltransform does not work with ungridded files from my understanding.
>
> The problem I have is that when I use gdal_grid, I get :
> ERROR 6: GDALDriver::Create() ... no create method implemented for this
> format
> Unable to create target dataset "newgrid".
> GDALDriver::Create() ... no create method implemented for this format
>
> Here is the command line :
> gdal_grid -zfield field_3 -of xyz -l grid grid.vrt newgrid
>
> Is there anything I have to install to be able to write gridded XYZ files?
>
> Thanks for any help.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

The gdalgrid utility needs to write to a format that supports Create().  Try:

gdal_grid -zfield field_3 -of gtiff -l grid grid.vrt newgrid.tif
gdal_translate -of xyz newgrid.tif newgrid.xyz

-- 
Kyle

From even.rouault at spatialys.com  Sun Nov 23 09:15:14 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 23 Nov 2014 18:15:14 +0100
Subject: [gdal-dev] Value Error While Writing the File in Chunks
In-Reply-To: <CAHOqc_qMzLkkQ3AAmW8Y08pDA66VXZThaKXyz3yGhg1xHT37Ow@mail.gmail.com>
References: <CAHOqc_qMzLkkQ3AAmW8Y08pDA66VXZThaKXyz3yGhg1xHT37Ow@mail.gmail.com>
Message-ID: <201411231815.14673.even.rouault@spatialys.com>

Le dimanche 23 novembre 2014 17:04:05, Simen Langseth a ?crit :
> import gdal, numpy as np
> from gdalconst import *
> 
> infile = r"D:\given.tif"
> inraster = gdal.Open(infile, GA_ReadOnly)
> x_total,y_total=refraster.RasterXSize,refraster.RasterYSize
> n_chunks=10
> x_offsets=np.linspace(0,x_total,n_chunks).astype(int)
> x_offsets=zip(x_offsets[:-1],x_offsets[1:])
> y_offsets=np.linspace(0,y_total,n_chunks).astype(int)
> y_offsets=zip(y_offsets[:-1],y_offsets[1:])
> 
> outfile =  r"D:\result.tif"
> outraster =
> gdal.GetDriverByName('GTiff').Create(outfile,y_total,x_total,1,gdal.GDT_Flo
> at32) for x1,x2 in x_offsets:
>     for y1,y2 in y_offsets:
>         values = refraster.GetRasterBand(1).ReadAsArray(x1,y1,x2-x1,y2-y1)
>         outraster.GetRasterBand(1).WriteArray(values, x1, y1)
> inraster, outraster = None, None
> 
> I got the following error:
> 
> Traceback (most recent call last):
>   File "D:\test.py", line 20, in <module>
>     outraster.GetRasterBand(1).WriteArray(values, x1, y1)
>   File "C:\Python27\lib\site-packages\osgeo\gdal.py", line 1167, in
> WriteArray
>     return gdalnumeric.BandWriteArray( self, array, xoff, yoff )
>   File "C:\Python27\lib\site-packages\osgeo\gdal_array.py", line 304, in
> BandWriteArray
>     raise ValueError("array larger than output file, or offset off edge")
> ValueError: array larger than output file, or offset off edge
> 
> How can I correct the writeArray?

Presumably outraster dimensions are not big enough. 
Create(outfile,y_total,x_total,....) is wrong. That should rather be 
Create(outfile,x_total,y_total,....)

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From simlangen at gmail.com  Sun Nov 23 09:37:57 2014
From: simlangen at gmail.com (Simen Langseth)
Date: Mon, 24 Nov 2014 02:37:57 +0900
Subject: [gdal-dev] Value Error While Writing the File in Chunks
In-Reply-To: <201411231815.14673.even.rouault@spatialys.com>
References: <CAHOqc_qMzLkkQ3AAmW8Y08pDA66VXZThaKXyz3yGhg1xHT37Ow@mail.gmail.com>
	<201411231815.14673.even.rouault@spatialys.com>
Message-ID: <CAHOqc_pt3VmTpobuPT+6ubS-3Jx4v-enCiZQwJS1eA_-ijVVPw@mail.gmail.com>

Even Rouault, Thank you! Now the program is working.

On Mon, Nov 24, 2014 at 2:15 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le dimanche 23 novembre 2014 17:04:05, Simen Langseth a ?crit :
> > import gdal, numpy as np
> > from gdalconst import *
> >
> > infile = r"D:\given.tif"
> > inraster = gdal.Open(infile, GA_ReadOnly)
> > x_total,y_total=refraster.RasterXSize,refraster.RasterYSize
> > n_chunks=10
> > x_offsets=np.linspace(0,x_total,n_chunks).astype(int)
> > x_offsets=zip(x_offsets[:-1],x_offsets[1:])
> > y_offsets=np.linspace(0,y_total,n_chunks).astype(int)
> > y_offsets=zip(y_offsets[:-1],y_offsets[1:])
> >
> > outfile =  r"D:\result.tif"
> > outraster =
> >
> gdal.GetDriverByName('GTiff').Create(outfile,y_total,x_total,1,gdal.GDT_Flo
> > at32) for x1,x2 in x_offsets:
> >     for y1,y2 in y_offsets:
> >         values =
> refraster.GetRasterBand(1).ReadAsArray(x1,y1,x2-x1,y2-y1)
> >         outraster.GetRasterBand(1).WriteArray(values, x1, y1)
> > inraster, outraster = None, None
> >
> > I got the following error:
> >
> > Traceback (most recent call last):
> >   File "D:\test.py", line 20, in <module>
> >     outraster.GetRasterBand(1).WriteArray(values, x1, y1)
> >   File "C:\Python27\lib\site-packages\osgeo\gdal.py", line 1167, in
> > WriteArray
> >     return gdalnumeric.BandWriteArray( self, array, xoff, yoff )
> >   File "C:\Python27\lib\site-packages\osgeo\gdal_array.py", line 304, in
> > BandWriteArray
> >     raise ValueError("array larger than output file, or offset off edge")
> > ValueError: array larger than output file, or offset off edge
> >
> > How can I correct the writeArray?
>
> Presumably outraster dimensions are not big enough.
> Create(outfile,y_total,x_total,....) is wrong. That should rather be
> Create(outfile,x_total,y_total,....)
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141124/84626c9e/attachment.html>

From even.rouault at spatialys.com  Mon Nov 24 00:38:04 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 24 Nov 2014 09:38:04 +0100
Subject: [gdal-dev] Motion: Adopt RFC 50: OGR field subtypes
Message-ID: <201411240938.05032.even.rouault@spatialys.com>

Hi,

I think that the points raised in the discussion have been answered.

So:

Motion : I move to adopt RFC 50: OGR field subtypes

http://trac.osgeo.org/gdal/wiki/rfc50_ogr_field_subtype

Starting with my +1

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From simlangen at gmail.com  Mon Nov 24 02:14:06 2014
From: simlangen at gmail.com (Simen Langseth)
Date: Mon, 24 Nov 2014 19:14:06 +0900
Subject: [gdal-dev] gdal_calc.py: produce median raster
Message-ID: <CAHOqc_qrjBYH=aAYBe79=C9HWeCTuevavomwM5Jywg=s0jUL2Q@mail.gmail.com>

I have one GeoTiff file with 3 bands. I want to produce a raster file
computing pixel wise median value for the three raster bands. How can I do
that?

I tried as follows:

gdal_calc.py -A infile --allBands --outfile outfile --calc median(A)

But could not get any out file.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141124/0bb087d5/attachment.html>

From jukka.rahkonen at mmmtike.fi  Mon Nov 24 03:22:39 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Mon, 24 Nov 2014 11:22:39 +0000 (UTC)
Subject: [gdal-dev] Motion: Adopt RFC 50: OGR field subtypes
References: <201411240938.05032.even.rouault@spatialys.com>
Message-ID: <loom.20141124T122209-527@post.gmane.org>

Even Rouault <even.rouault <at> spatialys.com> writes:

> I think that the points raised in the discussion have been answered.
> 
> So:
> 
> Motion : I move to adopt RFC 50: OGR field subtypes
> 
> http://trac.osgeo.org/gdal/wiki/rfc50_ogr_field_subtype
> 
> Starting with my +1

+1

-Jukka Rahkonen-


From alami.samy at gmail.com  Mon Nov 24 03:44:30 2014
From: alami.samy at gmail.com (Samy Alami)
Date: Mon, 24 Nov 2014 12:44:30 +0100
Subject: [gdal-dev] cannot unsubscribe the mailing list
In-Reply-To: <CAJBL701wCwoakxsYXjTjW0N-b3KOw+4QgBeR1SERVCjput9uew@mail.gmail.com>
References: <CAJBL701wCwoakxsYXjTjW0N-b3KOw+4QgBeR1SERVCjput9uew@mail.gmail.com>
Message-ID: <CAJBL700da59S98po6U3mW2d=hRTNQakpUHn_+mHbyoVFobAAGQ@mail.gmail.com>

Hello,

I alert that I still can't unsubscribe the mailing list. I already sent my
email adress to get a reminder password in order to unsubscribe but I never
receive the reminder. I checked the spam too.

Thanks

2014-11-12 17:53 GMT+01:00 Samy Alami <alami.samy at gmail.com>:

> Hello,
>
> I tried to unsubscribe the mailing list but I never received the email to
> physically unsubscribe.
>
> Any help ?
>
> --
> *Samy*
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141124/2ffd579f/attachment.html>

From even.rouault at spatialys.com  Mon Nov 24 07:00:11 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 24 Nov 2014 16:00:11 +0100
Subject: [gdal-dev] Call for discussion on RFC 51: RasterIO() improvements :
	resampling and progress callback
Message-ID: <201411241600.12253.even.rouault@spatialys.com>

Hi,

This is a call for discussion on a new RFC :
RFC 51 RasterIO() improvements : resampling and progress callback

http://trac.osgeo.org/gdal/wiki/rfc51_rasterio_resampling_progress

Below the summary :
"""
This RFC aims at extending the RasterIO() API to allow specifying a resampling 
algorithm when doing requests involving subsampling or oversampling. A 
progress callback can also be specified to be notified of progression and allow 
the user to interrupt the operation. 
"""

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at mmmtike.fi  Mon Nov 24 07:45:48 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Mon, 24 Nov 2014 15:45:48 +0000 (UTC)
Subject: [gdal-dev]
	=?utf-8?q?Call_for_discussion_on_RFC_51=3A_RasterIO=28?=
	=?utf-8?q?=29_improvements_=3A=09resampling_and_progress_callback?=
References: <201411241600.12253.even.rouault@spatialys.com>
Message-ID: <loom.20141124T161019-137@post.gmane.org>

Even Rouault <even.rouault <at> spatialys.com> writes:

> 
> Hi,
> 
> This is a call for discussion on a new RFC :
> RFC 51 RasterIO() improvements : resampling and progress callback
> 
> http://trac.osgeo.org/gdal/wiki/rfc51_rasterio_resampling_progress
> 
> Below the summary :
> """
> This RFC aims at extending the RasterIO() API to allow specifying a
resampling 
> algorithm when doing requests involving subsampling or oversampling. A 
> progress callback can also be specified to be notified of progression and
allow 
> the user to interrupt the operation. 
> """

Hi,

Gdaladdo seems to lose some resampling algorithms. The damage with
average_mp can't be big by reading the comment from the gdaladdo manual page
"average_mp is unsuitable for use. Average_magphase averages complex data in
mag/phase space."

Gdaladdo now:
-r {nearest (default),average,gauss,cubic,average_mp,average_magphase,mode}
Gdaladdo once RFC 51 is implemented:
-r parameter now accepts bilinear, cubicspline and lanczos as algorithms.

Otherwise I have not much to say about this RFC. "Blurring" has two r's, and
I think that it is good that gdal_translate will be able to use different
resampling methods and there will be no need to use gdalwarp if warping is
really not needed.

If you will touch gdal_translate anyway and it will do good job with
resampling I would like to see the same -tr option than in gdalwarp for
setting target resolution simply without a need to play with -outsize plus
-srcwin or -projwin.

-Jukka Rahkonen-

> 
> Even
> 





From even.rouault at spatialys.com  Mon Nov 24 08:34:44 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 24 Nov 2014 17:34:44 +0100
Subject: [gdal-dev]
 =?iso-8859-1?q?Call_for_discussion_on_RFC_51=3A_Raster?=
 =?iso-8859-1?q?IO=28=29_improvements_=3A=09resampling_and_progress_callba?=
 =?iso-8859-1?q?ck?=
In-Reply-To: <loom.20141124T161019-137@post.gmane.org>
References: <201411241600.12253.even.rouault@spatialys.com>
	<loom.20141124T161019-137@post.gmane.org>
Message-ID: <201411241734.44967.even.rouault@spatialys.com>

Jukka,

> 
> Gdaladdo seems to lose some resampling algorithms.

Ah, the text of the RFC wasn't clear enough. Bilinear, cubicspline and lanczos 
are *additional* algorithms to the existing ones.

> The damage with
> average_mp can't be big by reading the comment from the gdaladdo manual
> page "average_mp is unsuitable for use. Average_magphase averages complex
> data in mag/phase space."
> 
> Gdaladdo now:
> -r {nearest (default),average,gauss,cubic,average_mp,average_magphase,mode}
> Gdaladdo once RFC 51 is implemented:
> -r parameter now accepts bilinear, cubicspline and lanczos as algorithms.
> 
> Otherwise I have not much to say about this RFC. "Blurring" has two r's,

Fixed

> and I think that it is good that gdal_translate will be able to use
> different resampling methods and there will be no need to use gdalwarp if
> warping is really not needed.

Yes, this can be significantly faster with gdal_translate -r since the 
resampling algorithms of overview computation that are used can use more 
optimizations than the general purpose ones of warping.

> 
> If you will touch gdal_translate anyway and it will do good job with
> resampling I would like to see the same -tr option than in gdalwarp for
> setting target resolution simply without a need to play with -outsize plus
> -srcwin or -projwin.

That's not technically correlated with the RFC, but I see your point. I'll see 
to add this. Note that this will not allow changing alignment of the origin as 
you can do with gdalwarp -te/-tap: that would require VRT offsets to be 
specified as floating point values.

Even

> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From szekerest at gmail.com  Mon Nov 24 11:49:44 2014
From: szekerest at gmail.com (Tamas Szekeres)
Date: Mon, 24 Nov 2014 20:49:44 +0100
Subject: [gdal-dev] Motion: Adopt RFC 50: OGR field subtypes
In-Reply-To: <201411240938.05032.even.rouault@spatialys.com>
References: <201411240938.05032.even.rouault@spatialys.com>
Message-ID: <CACALY+T5b=XAaOy8j=t-mUjdbZZDRn6Kag8oyb8icH2P9syF0g@mail.gmail.com>

+1

Tamas


2014-11-24 9:38 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:

> Hi,
>
> I think that the points raised in the discussion have been answered.
>
> So:
>
> Motion : I move to adopt RFC 50: OGR field subtypes
>
> http://trac.osgeo.org/gdal/wiki/rfc50_ogr_field_subtype
>
> Starting with my +1
>
> Best regards,
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141124/5c8853b9/attachment.html>

From warmerdam at pobox.com  Mon Nov 24 11:54:22 2014
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon, 24 Nov 2014 11:54:22 -0800
Subject: [gdal-dev] Motion: Adopt RFC 50: OGR field subtypes
In-Reply-To: <201411240938.05032.even.rouault@spatialys.com>
References: <201411240938.05032.even.rouault@spatialys.com>
Message-ID: <CA+YzLBeYDgmUcAgTE3y5J0Qoa8c-R89g0FDJUM4zdfpz5X2zYw@mail.gmail.com>

+1 Frank

On Mon, Nov 24, 2014 at 12:38 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
> I think that the points raised in the discussion have been answered.
>
> So:
>
> Motion : I move to adopt RFC 50: OGR field subtypes
>
> http://trac.osgeo.org/gdal/wiki/rfc50_ogr_field_subtype
>
> Starting with my +1
>
> Best regards,
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141124/5fe709a2/attachment.html>

From mariusjigmond at hotmail.com  Mon Nov 24 19:09:16 2014
From: mariusjigmond at hotmail.com (Marius Jigmond)
Date: Mon, 24 Nov 2014 21:09:16 -0600
Subject: [gdal-dev] gdal_calc.py: produce median raster
In-Reply-To: <CAHOqc_qrjBYH=aAYBe79=C9HWeCTuevavomwM5Jywg=s0jUL2Q@mail.gmail.com>
References: <CAHOqc_qrjBYH=aAYBe79=C9HWeCTuevavomwM5Jywg=s0jUL2Q@mail.gmail.com>
Message-ID: <BLU181-W4027CB8261C06ADBA0D5ABB2730@phx.gbl>

Does the following work:
gdal_calc.py -A infile --allBands=A --outfile=outfile --calc="median(A)"

Date: Mon, 24 Nov 2014 19:14:06 +0900
From: simlangen at gmail.com
To: gdal-dev at lists.osgeo.org
Subject: [gdal-dev] gdal_calc.py: produce median raster

I have one GeoTiff file with 3 bands. I want to produce a raster file computing pixel wise median value for the three raster bands. How can I do that?
I tried as follows:
gdal_calc.py -A infile --allBands --outfile outfile --calc median(A)
But could not get any out file.
 

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141124/0567bc41/attachment.html>

From simlangen at gmail.com  Mon Nov 24 23:33:07 2014
From: simlangen at gmail.com (Simen Langseth)
Date: Tue, 25 Nov 2014 16:33:07 +0900
Subject: [gdal-dev] gdal_calc.py: produce median raster
In-Reply-To: <BLU181-W4027CB8261C06ADBA0D5ABB2730@phx.gbl>
References: <CAHOqc_qrjBYH=aAYBe79=C9HWeCTuevavomwM5Jywg=s0jUL2Q@mail.gmail.com>
	<BLU181-W4027CB8261C06ADBA0D5ABB2730@phx.gbl>
Message-ID: <CAHOqc_png7Tf5t+aO1KSTvy68ZgVfkmKyv2Ky_qoeH6cGyvayA@mail.gmail.com>

Dear Marius Jigmond:

Thanks for your attempt.

Unfortunately, it is producing 3 band outfile, rather than 1 band median
image.

I could not figure out what this code computed, all the resulted 3 bands
images are also different.

I hope someone can help me.

On Tue, Nov 25, 2014 at 12:09 PM, Marius Jigmond <mariusjigmond at hotmail.com>
wrote:

> Does the following work:
>
> gdal_calc.py -A infile --allBands=A --outfile=outfile --calc="median(A)"
>
>
> ------------------------------
> Date: Mon, 24 Nov 2014 19:14:06 +0900
> From: simlangen at gmail.com
> To: gdal-dev at lists.osgeo.org
> Subject: [gdal-dev] gdal_calc.py: produce median raster
>
>
> I have one GeoTiff file with 3 bands. I want to produce a raster file
> computing pixel wise median value for the three raster bands. How can I do
> that?
>
> I tried as follows:
>
> gdal_calc.py -A infile --allBands --outfile outfile --calc median(A)
>
> But could not get any out file.
>
>
>
> _______________________________________________ gdal-dev mailing list
> gdal-dev at lists.osgeo.org http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141125/e6035205/attachment.html>

From simlangen at gmail.com  Mon Nov 24 23:44:07 2014
From: simlangen at gmail.com (Simen Langseth)
Date: Tue, 25 Nov 2014 16:44:07 +0900
Subject: [gdal-dev] gdal_calc.py: produce median raster
In-Reply-To: <CAHOqc_png7Tf5t+aO1KSTvy68ZgVfkmKyv2Ky_qoeH6cGyvayA@mail.gmail.com>
References: <CAHOqc_qrjBYH=aAYBe79=C9HWeCTuevavomwM5Jywg=s0jUL2Q@mail.gmail.com>
	<BLU181-W4027CB8261C06ADBA0D5ABB2730@phx.gbl>
	<CAHOqc_png7Tf5t+aO1KSTvy68ZgVfkmKyv2Ky_qoeH6cGyvayA@mail.gmail.com>
Message-ID: <CAHOqc_qNrp9aH_DHqZMZ57_zq17-2iHp4S-VpopAhX3YhrYGrg@mail.gmail.com>

Dear Respected Authors:

I would be grateful if you could share any hints on it.


On Tue, Nov 25, 2014 at 4:33 PM, Simen Langseth <simlangen at gmail.com> wrote:

> Dear Marius Jigmond:
>
> Thanks for your attempt.
>
> Unfortunately, it is producing 3 band outfile, rather than 1 band median
> image.
>
> I could not figure out what this code computed, all the resulted 3 bands
> images are also different.
>
> I hope someone can help me.
>
> On Tue, Nov 25, 2014 at 12:09 PM, Marius Jigmond <
> mariusjigmond at hotmail.com> wrote:
>
>> Does the following work:
>>
>> gdal_calc.py -A infile --allBands=A --outfile=outfile --calc="median(A)"
>>
>>
>> ------------------------------
>> Date: Mon, 24 Nov 2014 19:14:06 +0900
>> From: simlangen at gmail.com
>> To: gdal-dev at lists.osgeo.org
>> Subject: [gdal-dev] gdal_calc.py: produce median raster
>>
>>
>> I have one GeoTiff file with 3 bands. I want to produce a raster file
>> computing pixel wise median value for the three raster bands. How can I do
>> that?
>>
>> I tried as follows:
>>
>> gdal_calc.py -A infile --allBands --outfile outfile --calc median(A)
>>
>> But could not get any out file.
>>
>>
>>
>> _______________________________________________ gdal-dev mailing list
>> gdal-dev at lists.osgeo.org http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141125/e140db1c/attachment.html>

From chris.yesson.phd at gmail.com  Mon Nov 24 23:59:40 2014
From: chris.yesson.phd at gmail.com (Chris Yesson)
Date: Tue, 25 Nov 2014 07:59:40 +0000
Subject: [gdal-dev] gdal_calc.py: produce median raster
In-Reply-To: <CAHOqc_qNrp9aH_DHqZMZ57_zq17-2iHp4S-VpopAhX3YhrYGrg@mail.gmail.com>
References: <CAHOqc_qrjBYH=aAYBe79=C9HWeCTuevavomwM5Jywg=s0jUL2Q@mail.gmail.com>
	<BLU181-W4027CB8261C06ADBA0D5ABB2730@phx.gbl>
	<CAHOqc_png7Tf5t+aO1KSTvy68ZgVfkmKyv2Ky_qoeH6cGyvayA@mail.gmail.com>
	<CAHOqc_qNrp9aH_DHqZMZ57_zq17-2iHp4S-VpopAhX3YhrYGrg@mail.gmail.com>
Message-ID: <CAPCaUxzS_sXtE4gWKzk6EGotyi0+J8iBtZh-fddOQt42NCU0+Q@mail.gmail.com>

Dear Simen,

You can refer to each band explicitly using the --A_band option.
Try something like this

gdal_calc.py -A infile --A_band 1 -B infile --B_band 2 -C infile --C_band 3
 --outfile outfile --calc median(A,B,C)

- Chris

*Dr Chris Yesson*
*Institute of Zoology, Zoological Society of London*
*Tel: 020 7449 6267*

*email: chris.yesson at ioz.ac.uk <chris.yesson at ioz.ac.uk>**web:
http://www.zsl.org/chrisyesson/
<http://www.zsl.org/chrisyesson/>*
*Note: I work Mon-Thurs and do not check email on Fri*

On 25 November 2014 at 07:44, Simen Langseth <simlangen at gmail.com> wrote:

> Dear Respected Authors:
>
> I would be grateful if you could share any hints on it.
>
>
> On Tue, Nov 25, 2014 at 4:33 PM, Simen Langseth <simlangen at gmail.com>
> wrote:
>
>> Dear Marius Jigmond:
>>
>> Thanks for your attempt.
>>
>> Unfortunately, it is producing 3 band outfile, rather than 1 band median
>> image.
>>
>> I could not figure out what this code computed, all the resulted 3 bands
>> images are also different.
>>
>> I hope someone can help me.
>>
>> On Tue, Nov 25, 2014 at 12:09 PM, Marius Jigmond <
>> mariusjigmond at hotmail.com> wrote:
>>
>>> Does the following work:
>>>
>>> gdal_calc.py -A infile --allBands=A --outfile=outfile --calc="median(A)"
>>>
>>>
>>> ------------------------------
>>> Date: Mon, 24 Nov 2014 19:14:06 +0900
>>> From: simlangen at gmail.com
>>> To: gdal-dev at lists.osgeo.org
>>> Subject: [gdal-dev] gdal_calc.py: produce median raster
>>>
>>>
>>> I have one GeoTiff file with 3 bands. I want to produce a raster file
>>> computing pixel wise median value for the three raster bands. How can I do
>>> that?
>>>
>>> I tried as follows:
>>>
>>> gdal_calc.py -A infile --allBands --outfile outfile --calc median(A)
>>>
>>> But could not get any out file.
>>>
>>>
>>>
>>> _______________________________________________ gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>
>>
>
>
> This message has been scanned for viruses by MailControl
> <http://www.mailcontrol.com/>, a service from BlackSpider Technologies
> <http://www.blackspider.com/>.
>
> Click here <https://www.mailcontrol.com/sr/MZbqvYs5QwJvpeaetUwhCQ==> to
> report this email as spam.
>
>
> The Zoological Society of London is incorporated by Royal Charter
> Principal Office England. Company Number RC000749
> Registered address:
> Regent's Park, London, England NW1 4RY
> Registered Charity in England and Wales no. 208728
>
> _________________________________________________________________________
> This e-mail has been sent in confidence to the named addressee(s).
> If you are not the intended recipient, you must not disclose or distribute
> it in any form, and you are asked to contact the sender immediately.
> Views or opinions expressed in this communication may not be those
> of The Zoological Society of London and, therefore, The Zoological
> Society of London does not accept legal responsibility for the contents
> of this message. The recipient(s) must be aware that e-mail is not a
> secure communication medium and that the contents of this mail may
> have been altered by a third party in transit.
> If you have any issues regarding this mail please contact:
> administrator at zsl.org.
> ___________________________________________________________________________
>
> This message has been scanned for viruses by MailControl
> <http://www.mailcontrol.com/>, a service from BlackSpider Technologies
> <http://www.blackspider.com/>.
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141125/617ab36c/attachment.html>

From simlangen at gmail.com  Tue Nov 25 00:56:46 2014
From: simlangen at gmail.com (Simen Langseth)
Date: Tue, 25 Nov 2014 17:56:46 +0900
Subject: [gdal-dev] gdal_calc.py: produce median raster
In-Reply-To: <CAPCaUxzS_sXtE4gWKzk6EGotyi0+J8iBtZh-fddOQt42NCU0+Q@mail.gmail.com>
References: <CAHOqc_qrjBYH=aAYBe79=C9HWeCTuevavomwM5Jywg=s0jUL2Q@mail.gmail.com>
	<BLU181-W4027CB8261C06ADBA0D5ABB2730@phx.gbl>
	<CAHOqc_png7Tf5t+aO1KSTvy68ZgVfkmKyv2Ky_qoeH6cGyvayA@mail.gmail.com>
	<CAHOqc_qNrp9aH_DHqZMZ57_zq17-2iHp4S-VpopAhX3YhrYGrg@mail.gmail.com>
	<CAPCaUxzS_sXtE4gWKzk6EGotyi0+J8iBtZh-fddOQt42NCU0+Q@mail.gmail.com>
Message-ID: <CAHOqc_oU0F6nAz4rrZUj-kytCP-4LhdKXOq=jne5gC5fZVMKAA@mail.gmail.com>

Dear Dr Chris Yesson

Thanks for your quick response.

I got the following error:

ValueError: The truth value of an array with more than one element is
ambiguous.
Use a.any() or a.all()`

Perhaps the expression for calc seems to be revised...


On Tue, Nov 25, 2014 at 4:59 PM, Chris Yesson <chris.yesson.phd at gmail.com>
wrote:

> Dear Simen,
>
> You can refer to each band explicitly using the --A_band option.
> Try something like this
>
> gdal_calc.py -A infile --A_band 1 -B infile --B_band 2 -C infile --C_band
> 3  --outfile outfile --calc median(A,B,C)
>
> - Chris
>
> *Dr Chris Yesson*
> *Institute of Zoology, Zoological Society of London*
> *Tel: 020 7449 6267*
>
> *email: chris.yesson at ioz.ac.uk <chris.yesson at ioz.ac.uk>**web: http://www.zsl.org/chrisyesson/
> <http://www.zsl.org/chrisyesson/>*
> *Note: I work Mon-Thurs and do not check email on Fri*
>
> On 25 November 2014 at 07:44, Simen Langseth <simlangen at gmail.com> wrote:
>
>> Dear Respected Authors:
>>
>> I would be grateful if you could share any hints on it.
>>
>>
>> On Tue, Nov 25, 2014 at 4:33 PM, Simen Langseth <simlangen at gmail.com>
>> wrote:
>>
>>> Dear Marius Jigmond:
>>>
>>> Thanks for your attempt.
>>>
>>> Unfortunately, it is producing 3 band outfile, rather than 1 band median
>>> image.
>>>
>>> I could not figure out what this code computed, all the resulted 3 bands
>>> images are also different.
>>>
>>> I hope someone can help me.
>>>
>>> On Tue, Nov 25, 2014 at 12:09 PM, Marius Jigmond <
>>> mariusjigmond at hotmail.com> wrote:
>>>
>>>> Does the following work:
>>>>
>>>> gdal_calc.py -A infile --allBands=A --outfile=outfile --calc="median(A)"
>>>>
>>>>
>>>> ------------------------------
>>>> Date: Mon, 24 Nov 2014 19:14:06 +0900
>>>> From: simlangen at gmail.com
>>>> To: gdal-dev at lists.osgeo.org
>>>> Subject: [gdal-dev] gdal_calc.py: produce median raster
>>>>
>>>>
>>>> I have one GeoTiff file with 3 bands. I want to produce a raster file
>>>> computing pixel wise median value for the three raster bands. How can I do
>>>> that?
>>>>
>>>> I tried as follows:
>>>>
>>>> gdal_calc.py -A infile --allBands --outfile outfile --calc median(A)
>>>>
>>>> But could not get any out file.
>>>>
>>>>
>>>>
>>>> _______________________________________________ gdal-dev mailing list
>>>> gdal-dev at lists.osgeo.org
>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>
>>>
>>>
>>
>>
>> This message has been scanned for viruses by MailControl
>> <http://www.mailcontrol.com/>, a service from BlackSpider Technologies
>> <http://www.blackspider.com/>.
>>
>> Click here <https://www.mailcontrol.com/sr/MZbqvYs5QwJvpeaetUwhCQ==> to
>> report this email as spam.
>>
>>
>> The Zoological Society of London is incorporated by Royal Charter
>> Principal Office England. Company Number RC000749
>> Registered address:
>> Regent's Park, London, England NW1 4RY
>> Registered Charity in England and Wales no. 208728
>>
>> _________________________________________________________________________
>> This e-mail has been sent in confidence to the named addressee(s).
>> If you are not the intended recipient, you must not disclose or distribute
>> it in any form, and you are asked to contact the sender immediately.
>> Views or opinions expressed in this communication may not be those
>> of The Zoological Society of London and, therefore, The Zoological
>> Society of London does not accept legal responsibility for the contents
>> of this message. The recipient(s) must be aware that e-mail is not a
>> secure communication medium and that the contents of this mail may
>> have been altered by a third party in transit.
>> If you have any issues regarding this mail please contact:
>> administrator at zsl.org.
>>
>> ___________________________________________________________________________
>>
>> This message has been scanned for viruses by MailControl
>> <http://www.mailcontrol.com/>, a service from BlackSpider Technologies
>> <http://www.blackspider.com/>.
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141125/3535a487/attachment-0001.html>

From mwtoews at gmail.com  Tue Nov 25 02:17:10 2014
From: mwtoews at gmail.com (Mike Toews)
Date: Tue, 25 Nov 2014 23:17:10 +1300
Subject: [gdal-dev] Call for discussion on RFC 51: RasterIO()
 improvements : resampling and progress callback
In-Reply-To: <201411241734.44967.even.rouault@spatialys.com>
References: <201411241600.12253.even.rouault@spatialys.com>
	<loom.20141124T161019-137@post.gmane.org>
	<201411241734.44967.even.rouault@spatialys.com>
Message-ID: <CAM2FmMqxLNKS6YE=fOHo3j22KKdURCRMtCUm5ppH27AyohE5Nw@mail.gmail.com>

On 25 November 2014 at 05:34, Even Rouault <even.rouault at spatialys.com> wrote:
>> Otherwise I have not much to say about this RFC. "Blurring" has two r's,
>
> Fixed

Gaussian blur also has another complexity, since it's output
dimensions depend on the fftconvolve mode (using scipy.signal docs
http://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.signal.fftconvolve.html).

For example, to "blur" a DTM and maintain the same output dimensions
and geotransform, the mode would need to use a 'valid' convolution
with a padded input array. This padded array would also have a mode
(similarly from numpy docs
http://docs.scipy.org/doc/numpy/reference/generated/numpy.pad.html),
such as 'symmetric'.
http://gis.stackexchange.com/a/10467/1872

Someone else may want to blur a DTM without using a padded array, and
just return a smaller array with modified geotransform.

And a different "blur" would expand the output dimension and modify
the geotransform using a 'full' fftconvolve mode, using a 'constant'=0
padded array. An example of this is to "blur" a polygon that barely
extends to the shape's extent, but maintain the blur beyond the
initial extent. The constant value would also need to be supplied, as
a value of 0 for numpy is default.
http://gis.stackexchange.com/a/104338/1872

So in summary, I'm not sure how GDAL could best cover all combinations
of padding and convolution modes, except to offer a few prepared
use-cases, or somehow provide extra parameters. Or just provide a
single use case, similar to Gaussian blur routines in various raster
editing software.

-Mike

From even.rouault at spatialys.com  Tue Nov 25 02:19:26 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 25 Nov 2014 11:19:26 +0100
Subject: [gdal-dev] GDAL Driver for MongoDB
In-Reply-To: <2DAEBB32799F494EBE504E1247CC5E8220ED7BCC@CITESMBX6.ad.uillinois.edu>
References: <2DAEBB32799F494EBE504E1247CC5E8220ED7BCC@CITESMBX6.ad.uillinois.edu>
Message-ID: <201411251119.27072.even.rouault@spatialys.com>

Shuai,

I may have the opportunity to integrate your driver in the future. I just 
wanted to make sure you had the right to contribute this work under the X/MIT 
license. From some headers like in https://github.com/mongogis/mongodb-gdal-
driver/blob/master/mongo/ogr_mongo.h, I see Nanjing University mentionned, 
and/but you above email is @illinois.edu. If this work was done for your 
studies, you'd likely check with your supervisor if it can be released under 
the X/MIT license. See the "Legal" section of 
https://trac.osgeo.org/gdal/wiki/rfc3_commiters

If you confirm that everything is OK, please answer back to the list stating 
so.

Thanks,

Even

> Hi there,
> 
> I wrote a GDAL driver for mongodb, and uploaded it in the
> github<https://github.com/mongogis/mongodb-gdal-driver>. Feel free to grab
> and use the driver.
> 
> Just let me know if you have any questions or suggestions.
> Thanks,
> shuai

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Tue Nov 25 02:47:20 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 25 Nov 2014 11:47:20 +0100
Subject: [gdal-dev] Call for discussion on RFC 51: RasterIO()
	improvements : resampling and progress callback
In-Reply-To: <CAM2FmMqxLNKS6YE=fOHo3j22KKdURCRMtCUm5ppH27AyohE5Nw@mail.gmail.com>
References: <201411241600.12253.even.rouault@spatialys.com>
	<201411241734.44967.even.rouault@spatialys.com>
	<CAM2FmMqxLNKS6YE=fOHo3j22KKdURCRMtCUm5ppH27AyohE5Nw@mail.gmail.com>
Message-ID: <201411251147.21017.even.rouault@spatialys.com>

Mike,

The gaussian resampling is the one already available for gdaladdo, that was 
added per
http://trac.osgeo.org/gdal/ticket/2137
and
http://trac.osgeo.org/gdal/changeset/15323

Basically :
- for a downscaling of factor between 1 and 2 (and for upscaling as well), it 
will use a 3x3 kernel
- for a downscaling of factor between 2 and 4, it will use a 5x5 kernel
- beyond it will use a 7x7 kernel.

I understand that gaussian blur can/could be parametrized in more complex 
ways. If there are improvements in that area, additional parameters could 
likely be passed through the GDALRasterIOExtraArg structure.

I've also wondered if the resampling algorithm couldn't be specified as a 
string instead of an enumerated value. In which case you could have had things 
like "gauss_x_y" with x and y as parameters. I don't have strong preference 
for one way or the other one. And both already exist in GDAL : the GDAL 
warping API uses an enumerated value, the GDAL overview API uses a string...

Even

> On 25 November 2014 at 05:34, Even Rouault <even.rouault at spatialys.com> 
wrote:
> >> Otherwise I have not much to say about this RFC. "Blurring" has two r's,
> > 
> > Fixed
> 
> Gaussian blur also has another complexity, since it's output
> dimensions depend on the fftconvolve mode (using scipy.signal docs
> http://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.signal.fft
> convolve.html).
> 
> For example, to "blur" a DTM and maintain the same output dimensions
> and geotransform, the mode would need to use a 'valid' convolution
> with a padded input array. This padded array would also have a mode
> (similarly from numpy docs
> http://docs.scipy.org/doc/numpy/reference/generated/numpy.pad.html),
> such as 'symmetric'.
> http://gis.stackexchange.com/a/10467/1872
> 
> Someone else may want to blur a DTM without using a padded array, and
> just return a smaller array with modified geotransform.
> 
> And a different "blur" would expand the output dimension and modify
> the geotransform using a 'full' fftconvolve mode, using a 'constant'=0
> padded array. An example of this is to "blur" a polygon that barely
> extends to the shape's extent, but maintain the blur beyond the
> initial extent. The constant value would also need to be supplied, as
> a value of 0 for numpy is default.
> http://gis.stackexchange.com/a/104338/1872
> 
> So in summary, I'm not sure how GDAL could best cover all combinations
> of padding and convolution modes, except to offer a few prepared
> use-cases, or somehow provide extra parameters. Or just provide a
> single use case, similar to Gaussian blur routines in various raster
> editing software.
> 
> -Mike

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From mariusjigmond at hotmail.com  Tue Nov 25 18:29:26 2014
From: mariusjigmond at hotmail.com (Marius Jigmond)
Date: Tue, 25 Nov 2014 20:29:26 -0600
Subject: [gdal-dev] gdal_calc.py: produce median raster
In-Reply-To: <CAHOqc_oU0F6nAz4rrZUj-kytCP-4LhdKXOq=jne5gC5fZVMKAA@mail.gmail.com>
References: <CAHOqc_qrjBYH=aAYBe79=C9HWeCTuevavomwM5Jywg=s0jUL2Q@mail.gmail.com>,
	<BLU181-W4027CB8261C06ADBA0D5ABB2730@phx.gbl>,
	<CAHOqc_png7Tf5t+aO1KSTvy68ZgVfkmKyv2Ky_qoeH6cGyvayA@mail.gmail.com>,
	<CAHOqc_qNrp9aH_DHqZMZ57_zq17-2iHp4S-VpopAhX3YhrYGrg@mail.gmail.com>,
	<CAPCaUxzS_sXtE4gWKzk6EGotyi0+J8iBtZh-fddOQt42NCU0+Q@mail.gmail.com>,
	<CAHOqc_oU0F6nAz4rrZUj-kytCP-4LhdKXOq=jne5gC5fZVMKAA@mail.gmail.com>
Message-ID: <BLU181-W67B68CA80601B5EC7FD2E2B2700@phx.gbl>

That's because numpy.median expects one array and keyword arguments, not three arrays. It's unclear to me what gdal_calc.py does under the hood (I admit I did not read it) but the correct way to get the median of the three bands would be:
--calc median([A,B,C], 0)
The strange part is that--calc median([A,B,C])works as well and generates a different output. When axis is not specified median should return a single value. At this point I suggest you take three 2D arrays, calculate their median as a 2D array, convert the three arrays to rasters, run gdal_calc.py and compare results.
-marius

Date: Tue, 25 Nov 2014 17:56:46 +0900
From: simlangen at gmail.com
To: chris.yesson at ioz.ac.uk
CC: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] gdal_calc.py: produce median raster

Dear Dr Chris Yesson

Thanks for your quick response.

I got the following error:

ValueError: The truth value of an array with more than one element is ambiguous. 
Use a.any() or a.all()`

Perhaps the expression for calc seems to be revised...

On Tue, Nov 25, 2014 at 4:59 PM, Chris Yesson <chris.yesson.phd at gmail.com> wrote:
Dear Simen,
You can refer to each band explicitly using the --A_band option.Try something like this
gdal_calc.py -A infile --A_band 1 -B infile --B_band 2 -C infile --C_band 3  --outfile outfile --calc median(A,B,C)
- ChrisDr Chris Yesson
Institute of Zoology, Zoological Society of LondonTel: 020 7449 6267
email: chris.yesson at ioz.ac.uk
web: http://www.zsl.org/chrisyesson/

Note: I work Mon-Thurs and do not check email on Fri


On 25 November 2014 at 07:44, Simen Langseth <simlangen at gmail.com> wrote:
Dear Respected Authors:
I would be grateful if you could share any hints on it.

On Tue, Nov 25, 2014 at 4:33 PM, Simen Langseth <simlangen at gmail.com> wrote:
Dear Marius Jigmond:

Thanks for your attempt.

Unfortunately, it is producing 3 band outfile, rather than 1 band median image.

I could not figure out what this code computed, all the resulted 3 bands images are also different.

I hope someone can help me.

On Tue, Nov 25, 2014 at 12:09 PM, Marius Jigmond <mariusjigmond at hotmail.com> wrote:



Does the following work:
gdal_calc.py -A infile --allBands=A --outfile=outfile --calc="median(A)"

Date: Mon, 24 Nov 2014 19:14:06 +0900
From: simlangen at gmail.com
To: gdal-dev at lists.osgeo.org
Subject: [gdal-dev] gdal_calc.py: produce median raster

I have one GeoTiff file with 3 bands. I want to produce a raster file computing pixel wise median value for the three raster bands. How can I do that?
I tried as follows:
gdal_calc.py -A infile --allBands --outfile outfile --calc median(A)
But could not get any out file.
 

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev 		 	   		  







This message has been scanned for viruses by MailControl, a service from BlackSpider Technologies.
Click here to report this email as spam.



The Zoological Society of London is incorporated by Royal Charter
Principal Office England. Company Number RC000749
Registered address: 
Regent's Park, London, England NW1 4RY
Registered Charity in England and Wales no. 208728 

_________________________________________________________________________
This e-mail has been sent in confidence to the named addressee(s).
If you are not the intended recipient, you must not disclose or distribute
it in any form, and you are asked to contact the sender immediately.
Views or opinions expressed in this communication may not be those
of The Zoological Society of London and, therefore, The Zoological
Society of London does not accept legal responsibility for the contents
of this message. The recipient(s) must be aware that e-mail is not a
secure communication medium and that the contents of this mail may
have been altered by a third party in transit.
If you have any issues regarding this mail please contact:
administrator at zsl.org.
___________________________________________________________________________


This message has been scanned for viruses by MailControl, a service from BlackSpider Technologies.





_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141125/08b0c16d/attachment.html>

From mwtoews at gmail.com  Wed Nov 26 01:38:38 2014
From: mwtoews at gmail.com (Mike Toews)
Date: Wed, 26 Nov 2014 22:38:38 +1300
Subject: [gdal-dev] gdal_calc.py: produce median raster
In-Reply-To: <CAHOqc_qrjBYH=aAYBe79=C9HWeCTuevavomwM5Jywg=s0jUL2Q@mail.gmail.com>
References: <CAHOqc_qrjBYH=aAYBe79=C9HWeCTuevavomwM5Jywg=s0jUL2Q@mail.gmail.com>
Message-ID: <CAM2FmMrzYPJogp5mjtgohCHRzjBaCimkEjcv8KPCYvMG3+6YgQ@mail.gmail.com>

Hi Simen,

Try this:

gdal_calc.py -A rgb.tif --outfile ouput.tif --calc "median(A, axis=0)"

The "axis=0" parameter is to perform a median calculation along the
first dimension, which is the band dimension. Lean more here:
http://docs.scipy.org/doc/numpy/reference/generated/numpy.median.html

-Mike

On 24 November 2014 at 23:14, Simen Langseth <simlangen at gmail.com> wrote:
> I have one GeoTiff file with 3 bands. I want to produce a raster file
> computing pixel wise median value for the three raster bands. How can I do
> that?
>
> I tried as follows:
>
> gdal_calc.py -A infile --allBands --outfile outfile --calc median(A)
>
> But could not get any out file.

From knutfrodesoppel at hotmail.com  Wed Nov 26 01:42:04 2014
From: knutfrodesoppel at hotmail.com (Knut-Frode Dagestad)
Date: Wed, 26 Nov 2014 10:42:04 +0100
Subject: [gdal-dev] Warping with +proj=ob_tran
In-Reply-To: <DUB125-W496D96FA567A2F20D48FD6A4700@phx.gbl>
References: <DUB125-W134E8AD4F0763FA811F473A4700@phx.gbl>,
	<DUB125-W496D96FA567A2F20D48FD6A4700@phx.gbl>
Message-ID: <DUB125-W754B1723198BB95941399CA4700@phx.gbl>

Hi,



I have some NetCDF files tagged with this proj4 string:

proj4=+proj=ob_tran +o_proj=longlat +lon_0=-40 +o_lat_p=22 +R=6.371e+06 +no_defs



As ob_tran seems not supported, is there any way I can warp this onto

a regular (unrotated) lonlat-grid?



There is a long, 3 yr old discussion on this in [1], but the

conclusion is not clear to me.



[1] https://trac.osgeo.org/gdal/ticket/4285



Best regards from Knut-Frode

 		 	   		   		 	   		   		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141126/9c8f5a31/attachment.html>

From even.rouault at spatialys.com  Wed Nov 26 02:06:52 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 26 Nov 2014 11:06:52 +0100
Subject: [gdal-dev] Motion: Adopt RFC 50: OGR field subtypes
In-Reply-To: <201411240938.05032.even.rouault@spatialys.com>
References: <201411240938.05032.even.rouault@spatialys.com>
Message-ID: <201411261106.52801.even.rouault@spatialys.com>

Hi,

> So:
> 
> Motion : I move to adopt RFC 50: OGR field subtypes
> 
> http://trac.osgeo.org/gdal/wiki/rfc50_ogr_field_subtype
> 
> Starting with my +1

I declare this motion passed with support from JukkaR, TamasS, FrankW and 
myself.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From landa.martin at gmail.com  Wed Nov 26 03:17:38 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Wed, 26 Nov 2014 12:17:38 +0100
Subject: [gdal-dev] curved polygon -> polygon
Message-ID: <CA+Ei1OcAAJ8MppK-=1USM4G-K6-ZYbTjjLgEndLfs9odKOrLsw@mail.gmail.com>

Hi,

I wonder why curved polygons are not approximated to polygons somehow
automatically. Eg. conversion such data fails

$ ogr2ogr -f PostgreSQL PG:dbname=ruian_test
/vsicurl/http://vdp.cuzk.cz/vymenny_format/soucasna/20141031_OB_564567_UKSH.xml.gz
Parcely -overwrite
Warning 1: Geometry to be inserted is of type Curve Polygon, whereas
the layer geometry type is Polygon.
Insertion is likely to fail
ERROR 1: COPY statement failed.
ERROR:  Geometry type (CurvePolygon) does not match column type (Polygon)
CONTEXT:  COPY parcely, line 18, column originalnihranice:
"010A00002032BF0D000100000001090000000300000001020000000B0000008FC2F528750A27C11F85EB51933C2EC114AE47..."

because some features are curved polygons even geometry column is `polygon`:

$ ogrinfo /vsicurl/http://vdp.cuzk.cz/vymenny_format/soucasna/20141031_OB_564567_UKSH.xml.gz
Parcely -fid 2815 | grep OriginalniHranice
Geometry (OriginalniHranice): Polygon
  OriginalniHranice = CURVEPOLYGON (CIRCULARSTRING (-755129.01
-990678.86,-755126.27 -990676.99,-755123.39 -990678.25,-755123.18
-990678.53,-755123.14 -990682.18,-755125.92 -990683.76,-755128.53
-990682.62,-755129.22 -990679.38,-755129.01 -990678.86))

Thanks for clarification in advance, Martin

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.eu/mentors/landa

From even.rouault at spatialys.com  Wed Nov 26 03:43:07 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 26 Nov 2014 12:43:07 +0100
Subject: [gdal-dev] curved polygon -> polygon
In-Reply-To: <CA+Ei1OcAAJ8MppK-=1USM4G-K6-ZYbTjjLgEndLfs9odKOrLsw@mail.gmail.com>
References: <CA+Ei1OcAAJ8MppK-=1USM4G-K6-ZYbTjjLgEndLfs9odKOrLsw@mail.gmail.com>
Message-ID: <201411261243.07247.even.rouault@spatialys.com>

Le mercredi 26 novembre 2014 12:17:38, Martin Landa a ?crit :
> Hi,
> 
> I wonder why curved polygons are not approximated to polygons somehow
> automatically. Eg. conversion such data fails
> 
> $ ogr2ogr -f PostgreSQL PG:dbname=ruian_test
> /vsicurl/http://vdp.cuzk.cz/vymenny_format/soucasna/20141031_OB_564567_UKSH
> .xml.gz Parcely -overwrite
> Warning 1: Geometry to be inserted is of type Curve Polygon, whereas
> the layer geometry type is Polygon.
> Insertion is likely to fail
> ERROR 1: COPY statement failed.
> ERROR:  Geometry type (CurvePolygon) does not match column type (Polygon)
> CONTEXT:  COPY parcely, line 18, column originalnihranice:
> "010A00002032BF0D000100000001090000000300000001020000000B0000008FC2F528750A
> 27C11F85EB51933C2EC114AE47..."
> 
> because some features are curved polygons even geometry column is
> `polygon`:

Martin,

The PostGIS driver doesn't do automatic conversion of geometry types as it can 
support all (you would get similar errors if inserting polygons into a 
multipolygon layer, or the reverse). This is kind of historic behaviour.
You can fix the error by specifying either -nlt CONVERT_TO_LINEAR (or -nlt 
POLYGON), or -nlt CURVEPOLYGON

Actually digging more, I was convinced that in my work related to curve 
geometries, I had make sure that the GML reader does its best to convert each 
geometry to the layer declared geometry type. This indeed worked for single 
geometry column layers, but not for multiple geometry such as yours. I've just 
fixed that.
So, with your current  data/ruian_vf_ob_v1.gfs, the curve polygons will be 
converted/approximated to polygons. You can also change 
data/ruian_vf_ob_v1.gfs to declare OriginalniHranice as curvepolygon. And 
polygons will be converted to curvepolygons (lossless conversion of course).
In both cases, PostGIS should be happy.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From tomerlieber at gmail.com  Wed Nov 26 06:58:21 2014
From: tomerlieber at gmail.com (Tomer)
Date: Wed, 26 Nov 2014 06:58:21 -0800 (PST)
Subject: [gdal-dev] How to get additional information about JPEG 2000 using
 GDAL + ECW/JPG2 Intergraph SDK
Message-ID: <1417013901000-5175081.post@n6.nabble.com>

I want to be able to display additional properties of JPEG 2000 that are
normally not available in programs like GDALINFO (with the SDK integrated).

Those properties are for example:
PROGRESSION=LRCP/RLCP/RPCL: 
CODESTREAM_ONLY=YES/NO: 
LEVELS=n: 
LAYERS=n:
PRECINCT_WIDTH=n:
PRECINCT_HEIGHT=n: 
TILE_WIDTH=n:
TILE_HEIGHT=n: 
INCLUDE_SOP=YES/NO:
INCLUDE_EPH=YES/NO: 
DECOMPRESS_LAYERS=n: 

Best regards,
Tomer




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/How-to-get-additional-information-about-JPEG-2000-using-GDAL-ECW-JPG2-Intergraph-SDK-tp5175081.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From jim.lacy at gmail.com  Wed Nov 26 08:31:34 2014
From: jim.lacy at gmail.com (jplacy2)
Date: Wed, 26 Nov 2014 08:31:34 -0800 (PST)
Subject: [gdal-dev] Multi-band JPEG2000 support?
Message-ID: <1417019494337-5175104.post@n6.nabble.com>

Hi Folks-

I'm attempting to generate some 4-band JP2 files using the GDAL 1.11 Win64
binary acquired from gisinternals.com.

I quickly ran into a problem... JP2 driver doesn't like four bands:

gdal_translate --debug on -of JP2OpenJPEG test.tif test.jp2
GDAL: GDALOpen(test.tif, this=000000000061CB70) succeeds as GTiff.
Input file size is 5920, 7700
ERROR 6: Unable to export files with 4 bands
GDAL: GDALClose(test.tif, this=000000000061CB70)

So my question is simple: what options are there for creating multi-band
jpeg2000's with GDAL on the Windows platform?  I understand there are other
driver options, but from what I have read, they all require a license and/or
a recompile of GDAL from the source... the latter is not really in my skill
set.

Thanks for any guidance,
Jim




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Multi-band-JPEG2000-support-tp5175104.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Wed Nov 26 08:36:42 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 26 Nov 2014 17:36:42 +0100
Subject: [gdal-dev] How to get additional information about JPEG 2000
	using GDAL + ECW/JPG2 Intergraph SDK
In-Reply-To: <1417013901000-5175081.post@n6.nabble.com>
References: <1417013901000-5175081.post@n6.nabble.com>
Message-ID: <201411261736.42102.even.rouault@spatialys.com>

Le mercredi 26 novembre 2014 15:58:21, Tomer a ?crit :
> I want to be able to display additional properties of JPEG 2000 that are
> normally not available in programs like GDALINFO (with the SDK integrated).
> 
> Those properties are for example:
> PROGRESSION=LRCP/RLCP/RPCL:
> CODESTREAM_ONLY=YES/NO:
> LEVELS=n:
> LAYERS=n:
> PRECINCT_WIDTH=n:
> PRECINCT_HEIGHT=n:
> TILE_WIDTH=n:
> TILE_HEIGHT=n:
> INCLUDE_SOP=YES/NO:
> INCLUDE_EPH=YES/NO:
> DECOMPRESS_LAYERS=n:

Tomer,

You can get some of them with the opj_dump utility of OpenJPEG.

$ ~/install-openjpeg-2.1.0/bin/opj_dump -i byte.jp2

[INFO] Start to read j2k main header (2233).
[INFO] Main header has been correctly decoded.
Image info {
	 x0=0, y0=0
	 x1=20, y1=20
	 numcomps=1
		 component 0 {
		 dx=1, dy=1
		 prec=8
		 sgnd=0
	}
}
Codestream info from main header: {
	 tx0=0, ty0=0
	 tdx=20, tdy=20
	 tw=1, th=1
	 default tile {
		 csty=0x1
		 prg=0x3
		 numlayers=12
		 mct=0
		 comp 0 {
			 csty=0x1
			 numresolutions=6
			 cblkw=2^6
			 cblkh=2^6
			 cblksty=0
			 qmfbid=0
			 preccintsize (w,h)=(9,4) (9,5) (9,6) (9,7) (9,8) (9,9) 
			 qntsty=2
			 numgbits=1
			 stepsizes (m,e)=(1822,14) (1770,14) (1770,14) (1724,14) 
(1792,13) (1792,13) (1762,13) (1868,12) (1868,12) (1892,12) (3,10) (3,10) 
(69,10) (2002,10) (2002,10) (1889,10) 
			 roishift=0
		 }
	 }
}
Codestream index from main header: {
	 Main header start position=2233
	 Main header end position=2633
	 Marker list: {
		 type=0xff4f, pos=2233, len=2
		 type=0xff51, pos=2235, len=43
		 type=0xff52, pos=2278, len=20
		 type=0xff5c, pos=2298, len=37
		 type=0xff64, pos=2335, len=17
		 type=0xff64, pos=2352, len=281
	 }
}



Kakadu's kdu_jp2info should also do it.

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Nov 26 08:41:59 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 26 Nov 2014 17:41:59 +0100
Subject: [gdal-dev] Multi-band JPEG2000 support?
In-Reply-To: <1417019494337-5175104.post@n6.nabble.com>
References: <1417019494337-5175104.post@n6.nabble.com>
Message-ID: <201411261741.59454.even.rouault@spatialys.com>

Le mercredi 26 novembre 2014 17:31:34, jplacy2 a ?crit :
> Hi Folks-
> 
> I'm attempting to generate some 4-band JP2 files using the GDAL 1.11 Win64
> binary acquired from gisinternals.com.
> 
> I quickly ran into a problem... JP2 driver doesn't like four bands:
> 
> gdal_translate --debug on -of JP2OpenJPEG test.tif test.jp2
> GDAL: GDALOpen(test.tif, this=000000000061CB70) succeeds as GTiff.
> Input file size is 5920, 7700
> ERROR 6: Unable to export files with 4 bands
> GDAL: GDALClose(test.tif, this=000000000061CB70)
> 
> So my question is simple: what options are there for creating multi-band
> jpeg2000's with GDAL on the Windows platform?  I understand there are other
> driver options, but from what I have read, they all require a license
> and/or a recompile of GDAL from the source... the latter is not really in
> my skill set.

Jim,

This is known as http://trac.osgeo.org/gdal/ticket/5695. The restriction has 
been put, because currently the driver couldn't not produce correct RGBA files 
with the alpha band correctly marked as such. I may have the opportunity to 
work on that in a medium term.

In the meantime, you could perhaps try the opj_compress utility of openjpeg ( 
https://code.google.com/p/openjpeg/wiki/Downloads?tm=2 ), but it will likely 
has the same flow as indicated above if you're interested in RGBA images.

Even

> 
> Thanks for any guidance,
> Jim
> 
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/Multi-band-JPEG2000-support-tp5175104.
> html Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From kempenep at gmail.com  Wed Nov 26 09:17:09 2014
From: kempenep at gmail.com (Pieter Kempeneers)
Date: Wed, 26 Nov 2014 18:17:09 +0100
Subject: [gdal-dev] gdal_calc.py: produce median raster
Message-ID: <CAPa4Yv5FH2eux1tZ82oyvRV3DWAdWR-AGmjqZtCies5Sag2Vog@mail.gmail.com>

Simen,

In case you can not find a solution with gdal_calc.py, you could try to use
pkfilter from pktools (http://pktools.nongnu.org). Once installed
(currently under Linux only), you can produce your median raster as follows:

pkfilter -i infile -o outfile -dz 1 -f median

The option -dz 1 indicates a filter in the spectral/time domain (instead of
space domain). You can also check the examples on
http://pktools.nongnu.org/html/md_doc_examples_pkfilter.html#examples_pkfilter

Please don't hesitate to mail if you have any problems installing or
running the command.

Pieter.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141126/e4cab4c4/attachment.html>

From jim.lacy at gmail.com  Wed Nov 26 13:08:43 2014
From: jim.lacy at gmail.com (jplacy2)
Date: Wed, 26 Nov 2014 13:08:43 -0800 (PST)
Subject: [gdal-dev] Multi-band JPEG2000 support?
In-Reply-To: <201411261741.59454.even.rouault@spatialys.com>
References: <1417019494337-5175104.post@n6.nabble.com>
	<201411261741.59454.even.rouault@spatialys.com>
Message-ID: <DAC9363E-6B25-4582-8562-7DA3100393D9@gmail.com>

Thanks Even. Is it true that a recompile from source is necessary to support other drivers, namely the JasPer JP2 option? I haven't been able to find any windows binaries that make that driver available. But perhaps that option only supports three bands as well? I haven't been able to find a definitive answer.

Thanks again.



> On Nov 26, 2014, at 10:42 AM, Even Rouault-2 [via OSGeo.org] <ml-node+s1560n5175106h69 at n6.nabble.com> wrote:
> 
> Le mercredi 26 novembre 2014 17:31:34, jplacy2 a ?crit :
> 
> > Hi Folks- 
> > 
> > I'm attempting to generate some 4-band JP2 files using the GDAL 1.11 Win64 
> > binary acquired from gisinternals.com. 
> > 
> > I quickly ran into a problem... JP2 driver doesn't like four bands: 
> > 
> > gdal_translate --debug on -of JP2OpenJPEG test.tif test.jp2 
> > GDAL: GDALOpen(test.tif, this=000000000061CB70) succeeds as GTiff. 
> > Input file size is 5920, 7700 
> > ERROR 6: Unable to export files with 4 bands 
> > GDAL: GDALClose(test.tif, this=000000000061CB70) 
> > 
> > So my question is simple: what options are there for creating multi-band 
> > jpeg2000's with GDAL on the Windows platform?  I understand there are other 
> > driver options, but from what I have read, they all require a license 
> > and/or a recompile of GDAL from the source... the latter is not really in 
> > my skill set.
> 
> Jim, 
> 
> This is known as http://trac.osgeo.org/gdal/ticket/5695. The restriction has 
> been put, because currently the driver couldn't not produce correct RGBA files 
> with the alpha band correctly marked as such. I may have the opportunity to 
> work on that in a medium term. 
> 
> In the meantime, you could perhaps try the opj_compress utility of openjpeg ( 
> https://code.google.com/p/openjpeg/wiki/Downloads?tm=2 ), but it will likely 
> has the same flow as indicated above if you're interested in RGBA images. 
> 
> Even 
> 
> > 
> > Thanks for any guidance, 
> > Jim 
> > 
> > 
> > 
> > 
> > -- 
> > View this message in context: 
> > http://osgeo-org.1560.x6.nabble.com/Multi-band-JPEG2000-support-tp5175104. 
> > html Sent from the GDAL - Dev mailing list archive at Nabble.com. 
> > _______________________________________________ 
> > gdal-dev mailing list 
> > [hidden email] 
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> -- 
> Spatialys - Geospatial professional services 
> http://www.spatialys.com
> _______________________________________________ 
> gdal-dev mailing list 
> [hidden email] 
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 
> If you reply to this email, your message will be added to the discussion below:
> http://osgeo-org.1560.x6.nabble.com/Multi-band-JPEG2000-support-tp5175104p5175106.html
> To unsubscribe from Multi-band JPEG2000 support?, click here.
> NAML




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Multi-band-JPEG2000-support-tp5175104p5175169.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141126/f0865518/attachment.html>

From even.rouault at spatialys.com  Wed Nov 26 13:20:01 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 26 Nov 2014 22:20:01 +0100
Subject: [gdal-dev] Multi-band JPEG2000 support?
In-Reply-To: <DAC9363E-6B25-4582-8562-7DA3100393D9@gmail.com>
References: <1417019494337-5175104.post@n6.nabble.com>
	<201411261741.59454.even.rouault@spatialys.com>
	<DAC9363E-6B25-4582-8562-7DA3100393D9@gmail.com>
Message-ID: <201411262220.01188.even.rouault@spatialys.com>

Le mercredi 26 novembre 2014 22:08:43, jplacy2 a ?crit :
> Thanks Even. Is it true that a recompile from source is necessary to
> support other drivers, namely the JasPer JP2 option? I haven't been able
> to find any windows binaries that make that driver available. But perhaps
> that option only supports three bands as well? I haven't been able to find
> a definitive answer.

Yes, you would need to convert from source. Jasper can create a 4-band 
JPEG2000, but the alpha band will not be tagged as such. And Jasper can have 
problems converting big images. But that should be OK for a 5920x7700 image.

Using OpenJPEG binaries might be easier.

> 
> Thanks again.
> 
> > On Nov 26, 2014, at 10:42 AM, Even Rouault-2 [via OSGeo.org]
> > <ml-node+s1560n5175106h69 at n6.nabble.com> wrote:
> > 
> > Le mercredi 26 novembre 2014 17:31:34, jplacy2 a ?crit :
> > > Hi Folks-
> > > 
> > > I'm attempting to generate some 4-band JP2 files using the GDAL 1.11
> > > Win64 binary acquired from gisinternals.com.
> > > 
> > > I quickly ran into a problem... JP2 driver doesn't like four bands:
> > > 
> > > gdal_translate --debug on -of JP2OpenJPEG test.tif test.jp2
> > > GDAL: GDALOpen(test.tif, this=000000000061CB70) succeeds as GTiff.
> > > Input file size is 5920, 7700
> > > ERROR 6: Unable to export files with 4 bands
> > > GDAL: GDALClose(test.tif, this=000000000061CB70)
> > > 
> > > So my question is simple: what options are there for creating
> > > multi-band jpeg2000's with GDAL on the Windows platform?  I understand
> > > there are other driver options, but from what I have read, they all
> > > require a license and/or a recompile of GDAL from the source... the
> > > latter is not really in my skill set.
> > 
> > Jim,
> > 
> > This is known as http://trac.osgeo.org/gdal/ticket/5695. The restriction
> > has been put, because currently the driver couldn't not produce correct
> > RGBA files with the alpha band correctly marked as such. I may have the
> > opportunity to work on that in a medium term.
> > 
> > In the meantime, you could perhaps try the opj_compress utility of
> > openjpeg ( https://code.google.com/p/openjpeg/wiki/Downloads?tm=2 ), but
> > it will likely has the same flow as indicated above if you're interested
> > in RGBA images.
> > 
> > Even
> > 
> > > Thanks for any guidance,
> > > Jim
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/Multi-band-JPEG2000-support-tp5175104p
> 5175169.html Sent from the GDAL - Dev mailing list archive at Nabble.com.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From Permafacture at gmail.com  Wed Nov 26 22:33:21 2014
From: Permafacture at gmail.com (Elliot Hallmark)
Date: Thu, 27 Nov 2014 00:33:21 -0600
Subject: [gdal-dev] Numpy and ogr
In-Reply-To: <CAHedU1StCHoczgviZFsu2NWvFMtg6Yc3=WsMKOQj4uTuN_Q-tA@mail.gmail.com>
References: <CAHedU1StCHoczgviZFsu2NWvFMtg6Yc3=WsMKOQj4uTuN_Q-tA@mail.gmail.com>
Message-ID: <CAHedU1Q2JBpDWU+OBG3ADWegcMG=xyieN8bp9FHmcOEsrUrq-Q@mail.gmail.com>

Hello,

I was wondering if the python api allows for vectorizing functions over
arrays of geometry object (ogr objects?) through numpy.

Like can I call overlaps on two (N,1) geomtry arrays and get an array of
bools? Is it using python loops to iterate through, or is it applying it as
a ufunc?

Thanks,
  Elliot
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141127/0bf68a69/attachment.html>

From vincent.mora at oslandia.com  Fri Nov 28 01:34:15 2014
From: vincent.mora at oslandia.com (Vincent Mora)
Date: Fri, 28 Nov 2014 10:34:15 +0100
Subject: [gdal-dev] SIG Mesh format
Message-ID: <54784197.2050501@oslandia.com>

Hi,

I'd like to read/write unstructured mesh informations in a "standard" 
sig format: mesh geometry and computation values at nodes, one result 
set per computation time step.

Is anyone aware of such a format that would support georeferencing and 
whould be a candidate for an ogr driver ?

Thanks,

V.


If this problem rings a bell, read on..

I'm aware of the HDF5 and netcdf, they can be used for unstructured mesh 
but gdal-drivers seem to be for raster data only. hdf5 and netcdf are 
more "metaformat" and libraries for file io than a file format per-se.

AFAIK:
* there is a lot of standard mesh formats, at least for visualization 
there are some that are de-facto standard (.obj, collada...)
* georeferencing in usually not a concern (except openfoam, others ?).

Conceptually, such a format would have:
* a point layer, with a spatial ref sys
* a connectivity table to define the elements (could be associated with 
a geometry, but the geometry needs update when points are moved around)
* computation results table(s) for results at points and results at 
elements (gauss points)

Postgis topology seems to be close to what I need, butpgdump is not the 
easiest data exchange format.

I could use a spatialite database to fit the bill, the good thing with 
this approach is to be able to load/edit the point layer with any 
standard SIG stuff (qgis, ogr2ogr...). The bad thing is that spatialite 
is not the most compact file format known to man. Another bad think is 
that I feel like I'm in this case: http://xkcd.com/927/ ... re-inventing 
the wheel.

I'll be gratefull for your insight.






From Steve.Toutant at inspq.qc.ca  Fri Nov 28 07:54:37 2014
From: Steve.Toutant at inspq.qc.ca (Steve.Toutant at inspq.qc.ca)
Date: Fri, 28 Nov 2014 10:54:37 -0500
Subject: [gdal-dev] fatal errr compiling gdal 1.11.0
Message-ID: <OFAD6392E1.E7004CF3-ON85257D9E.005708EA-85257D9E.005765DE@isn.rtss.qc.ca>

I already compiled gdal 1.11.0 on centos6 and I need to install on a 
fedora 20. Using the same method I get this eror

libtool: compile:  g++ -g -O2 -DHAVE_SSE_AT_COMPILE_TIME 
-fvisibility=hidden -Wall -I.. -I/opt/geomatique/src/gdal-1.11.0/port 
-I/opt/geomatique/src/gdal-1.11.0/gcore 
-I/opt/geomatique/src/gdal-1.11.0/alg 
-I/opt/geomatique/src/gdal-1.11.0/ogr 
-I/opt/geomatique/src/gdal-1.11.0/ogr/ogrsf_frmts -DOGR_ENABLED 
-I/opt/geomatique/src/gdal-1.11.0/port -I/usr/include 
-I/usr/include/libdap -I/usr/include/dap -DLIBDAP_39 -c ogrdodsdriver.cpp 
-fPIC -DPIC -o ../o/.libs/ogrdodsdriver.o
In file included from ogrdodsdriver.cpp:30:0:
ogr_dods.h:47:19: fatal error: debug.h: No such file or directory
 #include <debug.h>
                   ^
compilation terminated.

I don't know much about compiling. Anyone see why it is trying to include 
debug.h since it is commented? or what can I do about that?
thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141128/3f2723e3/attachment.html>

From jacek.tomaka at hexagongeospatial.com  Fri Nov 28 08:51:09 2014
From: jacek.tomaka at hexagongeospatial.com (Tomaka, Jacek)
Date: Fri, 28 Nov 2014 16:51:09 +0000
Subject: [gdal-dev] RFC 47 and Threading
In-Reply-To: <CAPxHBh8y6NyeYVUGHNudkpYnQf8=XgpwRy-YiTgcL0Et8x-wkQ@mail.gmail.com>
References: <CAPxHBh9szm_RmMhNMgTTQFTjc_x=dAndVFPvFXzK+F6nn0nXfg@mail.gmail.com>
	<201408222155.34437.even.rouault@spatialys.com>
	<CAPxHBh-FEjRwtGE9FXZmBmDBGdRcS6LfUtvbPRfRL_pgZhg6SQ@mail.gmail.com>
	<201408222246.45872.even.rouault@spatialys.com>
	<CAPxHBh_-239t2mwDaZCyxs2jQbPNLY-P+p-paxH5M-QuvxjcnA@mail.gmail.com>,
	<CAPxHBh8y6NyeYVUGHNudkpYnQf8=XgpwRy-YiTgcL0Et8x-wkQ@mail.gmail.com>
Message-ID: <3ED562F633B1AE46BF141E903F9813075851EC8B@ap-mbx2.ingrnet.com>

Blake, Even,
I played a bit with pull request #39. I enabled per dataset cache by setting GDAL_DATASET_CACHING to YES. Awesome work!
Our application code opens file in GDAL and holds GDALDataset per thread. Different threads can request same blocks but because cache should be per dataset i expected to see very little contention at the expense of some of the blocks being read multiple times.

To my surprise i saw that nothing changed in terms of time spent sleeping. After some investigation i realized that the contention point is static mutex hCOAMutex. Having noticed that i saw MUTEX_NONE ifdef there so i decided to define it to effectively get rid of mutexes in GDAL.
Guess what happened after recompilation. Because we only ever access GDALDataset from single dataset and the new GDALBlockManager is now per GDALDataset everything so far* (with the exception of PAMDataset destruction because it does not like null mutexes) works fine and scales so much better with the number of threads.

*Tested reading only using GTiff driver 4 threads reading tiles smaller than blocks, sometimes two threads can read data from the same block .

Do you see the same problem with hCOAMutex?
It would be good if i could say: give me per dataset cache, open this dataset with no locking. Unless the global cache provides its operations with less sleeping.

Regards.
Jacek Tomaka
________________________________
Od: gdal-dev-bounces at lists.osgeo.org [gdal-dev-bounces at lists.osgeo.org] w imieniu Blake Thompson [flippmoke at gmail.com]
Wys?ano: 29 sierpnia 2014 02:35
Do: Even Rouault
DW: gdal-dev at lists.osgeo.org
Temat: Re: [gdal-dev] RFC 47 and Threading

Even and Andre,

> I want to start off by saying a big thanks to Blake for taking his time
> to tackle what can only be a very difficult problem.
>  From what I can observe, the current discussion seems to be around the
> boundary of who should be responsible for ensuring thread safety around
> the block cache. The core of GDAL versus the individual drivers.

The core will necessarily have to know about thread-safety because the block
cache is there. The discussion is more whether the drivers must also necessary
be thread aware, or if core mechanisms are sufficient to hide this detail to the
drivers. And potentially offering to drivers a mechanism to deal themselves with
thread-safety if they can have a more optimized implementation than the default
one.

Agreed, most specifically how to hide the detail of the protection of the pointer to the block cache's data that is passed through IReadBlock, IWriteBlock, and IRasterIO.


> While I
> see why such a conversation is important, as far as I am concerned, the
> most important part should be how it affects users of GDAL at the
> interface level.

Agreed.

> That is, if an application that is threaded is trying
> to use GDAL, how does it ensure thread-safety? What you have to keep in
> mind is that having some parts of the library not thread-safe basically
> just pushes the mutexing/locking to the calling applications.

Not necessarily. That's what I suggested in my previous email : if the costs of
the mutex are not too expensive for non-threaded usage, then the API could
systematically return thread-safe versions, that are potentially wrapped by
GDALDatasetThreadSafe

So in the scope of my RFC, I am not certain how we could have a thread safe cache and a non-threadsafe cache in any simple manner. I know that you are specifically talking about the possiblity of thread safe datasets, which I feel is necessarily part of this discussion but wanted to separate the two. If the thread-safe cache is too expensive I feel like that is a major issue however, and I am doing my best to avoid any performance hits for this change.


>
> Also, while it is important to document thread-safety limitations, might
> I suggest adding thread-safe related capabilities (TestCapability),
> especially if all drivers do not end-up having the same thread-safety
> constraints.

That might be a solution, although not ideal from a usability point of view (if
we come with something more complex that non-thread-safe vs thread-safe, that
might be difficult to understand by users of GDAL API), and from a
GDAL-developer point of view as well (need to assess thread-safety for each
driver).
There can have subtelties : imagine that the VRT driver is made to be thread
safe, but uses sources of drivers that might be not thread safe...

>
> I personally do not see a GDALDatasetThreadSafe wrapper as adding much
> complexity. For instance, if you were to add a capability that indicates
> if a driver is inherently thread-safe, you could add a new open method
> to open a dataset in a thread-safe way with something like the following
> pseudocode:
>
> DataSet OpenThreadSafe(GDALOpenInfo openInfo)
> {
>      DataSet dataSet = Open(openInfo);
>
>      if (!dataSet.TestCapability(THREAD_SAFE))
>      {
>           dataSet = wrapWithThreadSafeWrapper(dataSet);
>      }
>
>      return dataSet;
> }

Yes, that's similar to what I imagined with my idea of GDAL_OF_THREADSAFE open
flag.

On the topic of the thread safe wrapper, I have spent more time thinking about it and I think this is probably the best solution to the problem of making all Datasets read safe, and I am willing to champion another RFC to implement this. However, the scope of this is even larger because it should be required to work with the OGR datasets as well.

Thanks,

Blake
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141128/584cef89/attachment.html>

From even.rouault at spatialys.com  Fri Nov 28 09:05:26 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 28 Nov 2014 18:05:26 +0100
Subject: [gdal-dev] fatal errr compiling gdal 1.11.0
In-Reply-To: <OFAD6392E1.E7004CF3-ON85257D9E.005708EA-85257D9E.005765DE@isn.rtss.qc.ca>
References: <OFAD6392E1.E7004CF3-ON85257D9E.005708EA-85257D9E.005765DE@isn.rtss.qc.ca>
Message-ID: <1417194326.5478ab56f1779@imp.free.fr>

Selon Steve.Toutant at inspq.qc.ca:

> I already compiled gdal 1.11.0 on centos6 and I need to install on a
> fedora 20. Using the same method I get this eror
>
> libtool: compile:  g++ -g -O2 -DHAVE_SSE_AT_COMPILE_TIME
> -fvisibility=hidden -Wall -I.. -I/opt/geomatique/src/gdal-1.11.0/port
> -I/opt/geomatique/src/gdal-1.11.0/gcore
> -I/opt/geomatique/src/gdal-1.11.0/alg
> -I/opt/geomatique/src/gdal-1.11.0/ogr
> -I/opt/geomatique/src/gdal-1.11.0/ogr/ogrsf_frmts -DOGR_ENABLED
> -I/opt/geomatique/src/gdal-1.11.0/port -I/usr/include
> -I/usr/include/libdap -I/usr/include/dap -DLIBDAP_39 -c ogrdodsdriver.cpp
> -fPIC -DPIC -o ../o/.libs/ogrdodsdriver.o
> In file included from ogrdodsdriver.cpp:30:0:
> ogr_dods.h:47:19: fatal error: debug.h: No such file or directory
>  #include <debug.h>
>                    ^
> compilation terminated.
>
> I don't know much about compiling. Anyone see why it is trying to include
> debug.h since it is commented? or what can I do about that?

Steve,

Try adding --with-dods-root=no to the configure line.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Nov 28 09:49:28 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 28 Nov 2014 18:49:28 +0100
Subject: [gdal-dev] RFC 47 and Threading
In-Reply-To: <3ED562F633B1AE46BF141E903F9813075851EC8B@ap-mbx2.ingrnet.com>
References: <CAPxHBh9szm_RmMhNMgTTQFTjc_x=dAndVFPvFXzK+F6nn0nXfg@mail.gmail.com>
	<201408222155.34437.even.rouault@spatialys.com>
	<CAPxHBh-FEjRwtGE9FXZmBmDBGdRcS6LfUtvbPRfRL_pgZhg6SQ@mail.gmail.com>
	<201408222246.45872.even.rouault@spatialys.com>
	<CAPxHBh_-239t2mwDaZCyxs2jQbPNLY-P+p-paxH5M-QuvxjcnA@mail.gmail.com>,
	<CAPxHBh8y6NyeYVUGHNudkpYnQf8=XgpwRy-YiTgcL0Et8x-wkQ@mail.gmail.com>
	<3ED562F633B1AE46BF141E903F9813075851EC8B@ap-mbx2.ingrnet.com>
Message-ID: <1417196968.5478b5a8248a6@imp.free.fr>

Jacek,

Did you identify which call sites triggered hCOAMutex to be taken ? Ideally we
should try to minimize them.
For the sake of my curiosity, which method did you try to evaluate time spend
in mutex sleeping ?
Another improvement would be that instead of dynamically created mutexes, we
could use statically created mutexes ( PTHREAD_RECURSIVE_MUTEX_INITIALIZER ).
That would avoid that hCOAMutex to become the "BGL" (Big GDAL Lock :
http://en.wikipedia.org/wiki/Giant_lock)
Building GDAL with MUTEX_NONE and using it in a multi-threaded case is a
potential risky game. This might work for some particular workloads & drivers,
but not in the general case. For example even the GTiff driver needs a mutex to
initialize libtiff/libgeotiff. See GTiffOneTimeInit() and there might be more
subtle stuff elsewhere.
But yes, I agree that an open flag to indicate per-dataset cache is an
interesting track to explore.

Even

> Blake, Even,
> I played a bit with pull request #39. I enabled per dataset cache by setting
> GDAL_DATASET_CACHING to YES. Awesome work!
> Our application code opens file in GDAL and holds GDALDataset per thread.
> Different threads can request same blocks but because cache should be per
> dataset i expected to see very little contention at the expense of some of
> the blocks being read multiple times.
>
> To my surprise i saw that nothing changed in terms of time spent sleeping.
> After some investigation i realized that the contention point is static mutex
> hCOAMutex. Having noticed that i saw MUTEX_NONE ifdef there so i decided to
> define it to effectively get rid of mutexes in GDAL.
> Guess what happened after recompilation. Because we only ever access
> GDALDataset from single dataset and the new GDALBlockManager is now per
> GDALDataset everything so far* (with the exception of PAMDataset destruction
> because it does not like null mutexes) works fine and scales so much better
> with the number of threads.
>
> *Tested reading only using GTiff driver 4 threads reading tiles smaller than
> blocks, sometimes two threads can read data from the same block .
>
> Do you see the same problem with hCOAMutex?
> It would be good if i could say: give me per dataset cache, open this dataset
> with no locking. Unless the global cache provides its operations with less
> sleeping.
>
> Regards.
> Jacek Tomaka
> ________________________________
> Od: gdal-dev-bounces at lists.osgeo.org [gdal-dev-bounces at lists.osgeo.org] w
> imieniu Blake Thompson [flippmoke at gmail.com]
> Wys?ano: 29 sierpnia 2014 02:35
> Do: Even Rouault
> DW: gdal-dev at lists.osgeo.org
> Temat: Re: [gdal-dev] RFC 47 and Threading
>
> Even and Andre,
>
> > I want to start off by saying a big thanks to Blake for taking his time
> > to tackle what can only be a very difficult problem.
> >  From what I can observe, the current discussion seems to be around the
> > boundary of who should be responsible for ensuring thread safety around
> > the block cache. The core of GDAL versus the individual drivers.
>
> The core will necessarily have to know about thread-safety because the block
> cache is there. The discussion is more whether the drivers must also
> necessary
> be thread aware, or if core mechanisms are sufficient to hide this detail to
> the
> drivers. And potentially offering to drivers a mechanism to deal themselves
> with
> thread-safety if they can have a more optimized implementation than the
> default
> one.
>
> Agreed, most specifically how to hide the detail of the protection of the
> pointer to the block cache's data that is passed through IReadBlock,
> IWriteBlock, and IRasterIO.
>
>
> > While I
> > see why such a conversation is important, as far as I am concerned, the
> > most important part should be how it affects users of GDAL at the
> > interface level.
>
> Agreed.
>
> > That is, if an application that is threaded is trying
> > to use GDAL, how does it ensure thread-safety? What you have to keep in
> > mind is that having some parts of the library not thread-safe basically
> > just pushes the mutexing/locking to the calling applications.
>
> Not necessarily. That's what I suggested in my previous email : if the costs
> of
> the mutex are not too expensive for non-threaded usage, then the API could
> systematically return thread-safe versions, that are potentially wrapped by
> GDALDatasetThreadSafe
>
> So in the scope of my RFC, I am not certain how we could have a thread safe
> cache and a non-threadsafe cache in any simple manner. I know that you are
> specifically talking about the possiblity of thread safe datasets, which I
> feel is necessarily part of this discussion but wanted to separate the two.
> If the thread-safe cache is too expensive I feel like that is a major issue
> however, and I am doing my best to avoid any performance hits for this
> change.
>
>
> >
> > Also, while it is important to document thread-safety limitations, might
> > I suggest adding thread-safe related capabilities (TestCapability),
> > especially if all drivers do not end-up having the same thread-safety
> > constraints.
>
> That might be a solution, although not ideal from a usability point of view
> (if
> we come with something more complex that non-thread-safe vs thread-safe, that
> might be difficult to understand by users of GDAL API), and from a
> GDAL-developer point of view as well (need to assess thread-safety for each
> driver).
> There can have subtelties : imagine that the VRT driver is made to be thread
> safe, but uses sources of drivers that might be not thread safe...
>
> >
> > I personally do not see a GDALDatasetThreadSafe wrapper as adding much
> > complexity. For instance, if you were to add a capability that indicates
> > if a driver is inherently thread-safe, you could add a new open method
> > to open a dataset in a thread-safe way with something like the following
> > pseudocode:
> >
> > DataSet OpenThreadSafe(GDALOpenInfo openInfo)
> > {
> >      DataSet dataSet = Open(openInfo);
> >
> >      if (!dataSet.TestCapability(THREAD_SAFE))
> >      {
> >           dataSet = wrapWithThreadSafeWrapper(dataSet);
> >      }
> >
> >      return dataSet;
> > }
>
> Yes, that's similar to what I imagined with my idea of GDAL_OF_THREADSAFE
> open
> flag.
>
> On the topic of the thread safe wrapper, I have spent more time thinking
> about it and I think this is probably the best solution to the problem of
> making all Datasets read safe, and I am willing to champion another RFC to
> implement this. However, the scope of this is even larger because it should
> be required to work with the OGR datasets as well.
>
> Thanks,
>
> Blake
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From flippmoke at gmail.com  Fri Nov 28 10:12:18 2014
From: flippmoke at gmail.com (Blake Thompson)
Date: Fri, 28 Nov 2014 12:12:18 -0600
Subject: [gdal-dev] RFC 47 and Threading
In-Reply-To: <1417196968.5478b5a8248a6@imp.free.fr>
References: <CAPxHBh9szm_RmMhNMgTTQFTjc_x=dAndVFPvFXzK+F6nn0nXfg@mail.gmail.com>
	<201408222155.34437.even.rouault@spatialys.com>
	<CAPxHBh-FEjRwtGE9FXZmBmDBGdRcS6LfUtvbPRfRL_pgZhg6SQ@mail.gmail.com>
	<201408222246.45872.even.rouault@spatialys.com>
	<CAPxHBh_-239t2mwDaZCyxs2jQbPNLY-P+p-paxH5M-QuvxjcnA@mail.gmail.com>
	<CAPxHBh8y6NyeYVUGHNudkpYnQf8=XgpwRy-YiTgcL0Et8x-wkQ@mail.gmail.com>
	<3ED562F633B1AE46BF141E903F9813075851EC8B@ap-mbx2.ingrnet.com>
	<1417196968.5478b5a8248a6@imp.free.fr>
Message-ID: <CAPxHBh9Q-GY78Zexr8_30WcB18rnY4M-zn97-JyOeqOwm2T0Yw@mail.gmail.com>

Jacek and Even,

I already made an improvement on the pthread version of this:

https://github.com/flippmoke/gdal/blob/trunk/gdal/port/cpl_multiproc.cpp#L1135

I am sure we could do something similar to it to make an improvement in the
non pthread version.

Adding at line:

https://github.com/flippmoke/gdal/blob/trunk/gdal/port/cpl_multiproc.cpp#L165

We could do something like this:

https://gist.github.com/flippmoke/16cd26a0247422f25840

Thanks,

Blake

On Fri, Nov 28, 2014 at 11:49 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Jacek,
>
> Did you identify which call sites triggered hCOAMutex to be taken ?
> Ideally we
> should try to minimize them.
> For the sake of my curiosity, which method did you try to evaluate time
> spend
> in mutex sleeping ?
> Another improvement would be that instead of dynamically created mutexes,
> we
> could use statically created mutexes ( PTHREAD_RECURSIVE_MUTEX_INITIALIZER
> ).
> That would avoid that hCOAMutex to become the "BGL" (Big GDAL Lock :
> http://en.wikipedia.org/wiki/Giant_lock)
> Building GDAL with MUTEX_NONE and using it in a multi-threaded case is a
> potential risky game. This might work for some particular workloads &
> drivers,
> but not in the general case. For example even the GTiff driver needs a
> mutex to
> initialize libtiff/libgeotiff. See GTiffOneTimeInit() and there might be
> more
> subtle stuff elsewhere.
> But yes, I agree that an open flag to indicate per-dataset cache is an
> interesting track to explore.
>
> Even
>
> > Blake, Even,
> > I played a bit with pull request #39. I enabled per dataset cache by
> setting
> > GDAL_DATASET_CACHING to YES. Awesome work!
> > Our application code opens file in GDAL and holds GDALDataset per thread.
> > Different threads can request same blocks but because cache should be per
> > dataset i expected to see very little contention at the expense of some
> of
> > the blocks being read multiple times.
> >
> > To my surprise i saw that nothing changed in terms of time spent
> sleeping.
> > After some investigation i realized that the contention point is static
> mutex
> > hCOAMutex. Having noticed that i saw MUTEX_NONE ifdef there so i decided
> to
> > define it to effectively get rid of mutexes in GDAL.
> > Guess what happened after recompilation. Because we only ever access
> > GDALDataset from single dataset and the new GDALBlockManager is now per
> > GDALDataset everything so far* (with the exception of PAMDataset
> destruction
> > because it does not like null mutexes) works fine and scales so much
> better
> > with the number of threads.
> >
> > *Tested reading only using GTiff driver 4 threads reading tiles smaller
> than
> > blocks, sometimes two threads can read data from the same block .
> >
> > Do you see the same problem with hCOAMutex?
> > It would be good if i could say: give me per dataset cache, open this
> dataset
> > with no locking. Unless the global cache provides its operations with
> less
> > sleeping.
> >
> > Regards.
> > Jacek Tomaka
> > ________________________________
> > Od: gdal-dev-bounces at lists.osgeo.org [gdal-dev-bounces at lists.osgeo.org]
> w
> > imieniu Blake Thompson [flippmoke at gmail.com]
> > Wys?ano: 29 sierpnia 2014 02:35
> > Do: Even Rouault
> > DW: gdal-dev at lists.osgeo.org
> > Temat: Re: [gdal-dev] RFC 47 and Threading
> >
> > Even and Andre,
> >
> > > I want to start off by saying a big thanks to Blake for taking his time
> > > to tackle what can only be a very difficult problem.
> > >  From what I can observe, the current discussion seems to be around the
> > > boundary of who should be responsible for ensuring thread safety around
> > > the block cache. The core of GDAL versus the individual drivers.
> >
> > The core will necessarily have to know about thread-safety because the
> block
> > cache is there. The discussion is more whether the drivers must also
> > necessary
> > be thread aware, or if core mechanisms are sufficient to hide this
> detail to
> > the
> > drivers. And potentially offering to drivers a mechanism to deal
> themselves
> > with
> > thread-safety if they can have a more optimized implementation than the
> > default
> > one.
> >
> > Agreed, most specifically how to hide the detail of the protection of the
> > pointer to the block cache's data that is passed through IReadBlock,
> > IWriteBlock, and IRasterIO.
> >
> >
> > > While I
> > > see why such a conversation is important, as far as I am concerned, the
> > > most important part should be how it affects users of GDAL at the
> > > interface level.
> >
> > Agreed.
> >
> > > That is, if an application that is threaded is trying
> > > to use GDAL, how does it ensure thread-safety? What you have to keep in
> > > mind is that having some parts of the library not thread-safe basically
> > > just pushes the mutexing/locking to the calling applications.
> >
> > Not necessarily. That's what I suggested in my previous email : if the
> costs
> > of
> > the mutex are not too expensive for non-threaded usage, then the API
> could
> > systematically return thread-safe versions, that are potentially wrapped
> by
> > GDALDatasetThreadSafe
> >
> > So in the scope of my RFC, I am not certain how we could have a thread
> safe
> > cache and a non-threadsafe cache in any simple manner. I know that you
> are
> > specifically talking about the possiblity of thread safe datasets, which
> I
> > feel is necessarily part of this discussion but wanted to separate the
> two.
> > If the thread-safe cache is too expensive I feel like that is a major
> issue
> > however, and I am doing my best to avoid any performance hits for this
> > change.
> >
> >
> > >
> > > Also, while it is important to document thread-safety limitations,
> might
> > > I suggest adding thread-safe related capabilities (TestCapability),
> > > especially if all drivers do not end-up having the same thread-safety
> > > constraints.
> >
> > That might be a solution, although not ideal from a usability point of
> view
> > (if
> > we come with something more complex that non-thread-safe vs thread-safe,
> that
> > might be difficult to understand by users of GDAL API), and from a
> > GDAL-developer point of view as well (need to assess thread-safety for
> each
> > driver).
> > There can have subtelties : imagine that the VRT driver is made to be
> thread
> > safe, but uses sources of drivers that might be not thread safe...
> >
> > >
> > > I personally do not see a GDALDatasetThreadSafe wrapper as adding much
> > > complexity. For instance, if you were to add a capability that
> indicates
> > > if a driver is inherently thread-safe, you could add a new open method
> > > to open a dataset in a thread-safe way with something like the
> following
> > > pseudocode:
> > >
> > > DataSet OpenThreadSafe(GDALOpenInfo openInfo)
> > > {
> > >      DataSet dataSet = Open(openInfo);
> > >
> > >      if (!dataSet.TestCapability(THREAD_SAFE))
> > >      {
> > >           dataSet = wrapWithThreadSafeWrapper(dataSet);
> > >      }
> > >
> > >      return dataSet;
> > > }
> >
> > Yes, that's similar to what I imagined with my idea of GDAL_OF_THREADSAFE
> > open
> > flag.
> >
> > On the topic of the thread safe wrapper, I have spent more time thinking
> > about it and I think this is probably the best solution to the problem of
> > making all Datasets read safe, and I am willing to champion another RFC
> to
> > implement this. However, the scope of this is even larger because it
> should
> > be required to work with the OGR datasets as well.
> >
> > Thanks,
> >
> > Blake
> >
>
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141128/a5d8af18/attachment.html>

From jacek.tomaka at hexagongeospatial.com  Sun Nov 30 20:58:45 2014
From: jacek.tomaka at hexagongeospatial.com (Tomaka, Jacek)
Date: Mon, 1 Dec 2014 04:58:45 +0000
Subject: [gdal-dev] RFC 47 and Threading
References: <CAPxHBh9szm_RmMhNMgTTQFTjc_x=dAndVFPvFXzK+F6nn0nXfg@mail.gmail.com>
	<201408222155.34437.even.rouault@spatialys.com>
	<CAPxHBh-FEjRwtGE9FXZmBmDBGdRcS6LfUtvbPRfRL_pgZhg6SQ@mail.gmail.com>
	<201408222246.45872.even.rouault@spatialys.com>
	<CAPxHBh_-239t2mwDaZCyxs2jQbPNLY-P+p-paxH5M-QuvxjcnA@mail.gmail.com>
	<CAPxHBh8y6NyeYVUGHNudkpYnQf8=XgpwRy-YiTgcL0Et8x-wkQ@mail.gmail.com>
	<3ED562F633B1AE46BF141E903F9813075851EC8B@ap-mbx2.ingrnet.com>
	<1417196968.5478b5a8248a6@imp.free.fr>
	<CAPxHBh9Q-GY78Zexr8_30WcB18rnY4M-zn97-JyOeqOwm2T0Yw@mail.gmail.com>
Message-ID: <3ED562F633B1AE46BF141E903F9813075851F345@ap-mbx2.ingrnet.com>

Blake, Even,
It looks like https://gist.github.com/flippmoke/16cd26a0247422f25840 improves multi threaded access even in GDAL 1.11.
But as mentioned before I believe it is not thread safe ;) At least that is what purists would say.
Regards.
Jacek Tomaka

From: Tomaka, Jacek
Sent: Sunday, 30 November 2014 6:00 PM
To: 'Blake Thompson'; Even Rouault
Cc: gdal-dev at lists.osgeo.org
Subject: RE: [gdal-dev] RFC 47 and Threading

Blake,
I tested your proposed change. It is better but sleeps are still visible. BTW:  isn?t it an example of double checked locking?
Even,
I am using Intel VTune Amplifier 2013?s Locks and Waits analysis. Please find attached screenshots. The bottommost four threads are performing GDAL workload. Light green waits can be seen 99% of them is in quanta of 0.125s.    Having seen that I set up a breakpoint on sleep in CPLAcquireMutex to identify which mutex it was.

Regards.
Jacek Tomaka

From: Blake Thompson [mailto:flippmoke at gmail.com]
Sent: Saturday, 29 November 2014 2:12 AM
To: Even Rouault
Cc: Tomaka, Jacek; gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] RFC 47 and Threading

Jacek and Even,
I already made an improvement on the pthread version of this:

https://github.com/flippmoke/gdal/blob/trunk/gdal/port/cpl_multiproc.cpp#L1135
I am sure we could do something similar to it to make an improvement in the non pthread version.
Adding at line:

https://github.com/flippmoke/gdal/blob/trunk/gdal/port/cpl_multiproc.cpp#L165
We could do something like this:
https://gist.github.com/flippmoke/16cd26a0247422f25840
Thanks,

Blake

On Fri, Nov 28, 2014 at 11:49 AM, Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>> wrote:
Jacek,

Did you identify which call sites triggered hCOAMutex to be taken ? Ideally we
should try to minimize them.
For the sake of my curiosity, which method did you try to evaluate time spend
in mutex sleeping ?
Another improvement would be that instead of dynamically created mutexes, we
could use statically created mutexes ( PTHREAD_RECURSIVE_MUTEX_INITIALIZER ).
That would avoid that hCOAMutex to become the "BGL" (Big GDAL Lock :
http://en.wikipedia.org/wiki/Giant_lock)
Building GDAL with MUTEX_NONE and using it in a multi-threaded case is a
potential risky game. This might work for some particular workloads & drivers,
but not in the general case. For example even the GTiff driver needs a mutex to
initialize libtiff/libgeotiff. See GTiffOneTimeInit() and there might be more
subtle stuff elsewhere.
But yes, I agree that an open flag to indicate per-dataset cache is an
interesting track to explore.

Even
> Blake, Even,
> I played a bit with pull request #39. I enabled per dataset cache by setting
> GDAL_DATASET_CACHING to YES. Awesome work!
> Our application code opens file in GDAL and holds GDALDataset per thread.
> Different threads can request same blocks but because cache should be per
> dataset i expected to see very little contention at the expense of some of
> the blocks being read multiple times.
>
> To my surprise i saw that nothing changed in terms of time spent sleeping.
> After some investigation i realized that the contention point is static mutex
> hCOAMutex. Having noticed that i saw MUTEX_NONE ifdef there so i decided to
> define it to effectively get rid of mutexes in GDAL.
> Guess what happened after recompilation. Because we only ever access
> GDALDataset from single dataset and the new GDALBlockManager is now per
> GDALDataset everything so far* (with the exception of PAMDataset destruction
> because it does not like null mutexes) works fine and scales so much better
> with the number of threads.
>
> *Tested reading only using GTiff driver 4 threads reading tiles smaller than
> blocks, sometimes two threads can read data from the same block .
>
> Do you see the same problem with hCOAMutex?
> It would be good if i could say: give me per dataset cache, open this dataset
> with no locking. Unless the global cache provides its operations with less
> sleeping.
>
> Regards.
> Jacek Tomaka
> ________________________________
> Od: gdal-dev-bounces at lists.osgeo.org<mailto:gdal-dev-bounces at lists.osgeo.org> [gdal-dev-bounces at lists.osgeo.org<mailto:gdal-dev-bounces at lists.osgeo.org>] w
> imieniu Blake Thompson [flippmoke at gmail.com<mailto:flippmoke at gmail.com>]
> Wys?ano: 29 sierpnia 2014 02:35
> Do: Even Rouault
> DW: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
> Temat: Re: [gdal-dev] RFC 47 and Threading
>
> Even and Andre,
>
> > I want to start off by saying a big thanks to Blake for taking his time
> > to tackle what can only be a very difficult problem.
> >  From what I can observe, the current discussion seems to be around the
> > boundary of who should be responsible for ensuring thread safety around
> > the block cache. The core of GDAL versus the individual drivers.
>
> The core will necessarily have to know about thread-safety because the block
> cache is there. The discussion is more whether the drivers must also
> necessary
> be thread aware, or if core mechanisms are sufficient to hide this detail to
> the
> drivers. And potentially offering to drivers a mechanism to deal themselves
> with
> thread-safety if they can have a more optimized implementation than the
> default
> one.
>
> Agreed, most specifically how to hide the detail of the protection of the
> pointer to the block cache's data that is passed through IReadBlock,
> IWriteBlock, and IRasterIO.
>
>
> > While I
> > see why such a conversation is important, as far as I am concerned, the
> > most important part should be how it affects users of GDAL at the
> > interface level.
>
> Agreed.
>
> > That is, if an application that is threaded is trying
> > to use GDAL, how does it ensure thread-safety? What you have to keep in
> > mind is that having some parts of the library not thread-safe basically
> > just pushes the mutexing/locking to the calling applications.
>
> Not necessarily. That's what I suggested in my previous email : if the costs
> of
> the mutex are not too expensive for non-threaded usage, then the API could
> systematically return thread-safe versions, that are potentially wrapped by
> GDALDatasetThreadSafe
>
> So in the scope of my RFC, I am not certain how we could have a thread safe
> cache and a non-threadsafe cache in any simple manner. I know that you are
> specifically talking about the possiblity of thread safe datasets, which I
> feel is necessarily part of this discussion but wanted to separate the two.
> If the thread-safe cache is too expensive I feel like that is a major issue
> however, and I am doing my best to avoid any performance hits for this
> change.
>
>
> >
> > Also, while it is important to document thread-safety limitations, might
> > I suggest adding thread-safe related capabilities (TestCapability),
> > especially if all drivers do not end-up having the same thread-safety
> > constraints.
>
> That might be a solution, although not ideal from a usability point of view
> (if
> we come with something more complex that non-thread-safe vs thread-safe, that
> might be difficult to understand by users of GDAL API), and from a
> GDAL-developer point of view as well (need to assess thread-safety for each
> driver).
> There can have subtelties : imagine that the VRT driver is made to be thread
> safe, but uses sources of drivers that might be not thread safe...
>
> >
> > I personally do not see a GDALDatasetThreadSafe wrapper as adding much
> > complexity. For instance, if you were to add a capability that indicates
> > if a driver is inherently thread-safe, you could add a new open method
> > to open a dataset in a thread-safe way with something like the following
> > pseudocode:
> >
> > DataSet OpenThreadSafe(GDALOpenInfo openInfo)
> > {
> >      DataSet dataSet = Open(openInfo);
> >
> >      if (!dataSet.TestCapability(THREAD_SAFE))
> >      {
> >           dataSet = wrapWithThreadSafeWrapper(dataSet);
> >      }
> >
> >      return dataSet;
> > }
>
> Yes, that's similar to what I imagined with my idea of GDAL_OF_THREADSAFE
> open
> flag.
>
> On the topic of the thread safe wrapper, I have spent more time thinking
> about it and I think this is probably the best solution to the problem of
> making all Datasets read safe, and I am willing to champion another RFC to
> implement this. However, the scope of this is even larger because it should
> be required to work with the OGR datasets as well.
>
> Thanks,
>
> Blake
>
--
Spatialys - Geospatial professional services
http://www.spatialys.com

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141201/5bca6e1a/attachment-0001.html>

