From robert.coup at koordinates.com  Wed Sep  1 00:29:42 2021
From: robert.coup at koordinates.com (Robert Coup)
Date: Wed, 1 Sep 2021 08:29:42 +0100
Subject: [gdal-dev] autotest questions/issues
In-Reply-To: <rmieea916ds.fsf@s1.lexort.com>
References: <rmieea916ds.fsf@s1.lexort.com>
Message-ID: <CAFLLRpKu7MLedCbGDfweSJMqGQVy9Z94FjwRtDM4zrqYB7ESMg@mail.gmail.com>

Hi Greg,

On Wed, 1 Sept 2021 at 01:33, Greg Troxel <gdt at lexort.com> wrote:

> A few comments from the perspective of a gdal test newbie, which I hope
> are helpful:
>
> * autotest is not in the distribution tarball
>

Yeah, it's never been in the release tarballs. And the release tarballs
start one folder level down (gdal/) as well.

TBH I think the release tarballs should just match/be an archive of the git
tag. But that's above my pay grade :-)

@Debian and other package maintainers ? are you just getting the Git tags
these days or do you actually use the release tarballs?


>
>   + Does it test the gdal that is installed in one's PATH (and
>   PYTHONPATH), or is is testing the gdal that is in the source tree?
>

CONTRIBUTING.md has a guide to run `scripts/setdevenv.sh` which sets up
in-tree execution for utilities/libraries and the tests.


>
>   + Is one supposed to check out the corresponding branch (or really
>   tag), or is it ok to test 3.3.2rc2 with master?
>

The tests should match the code, so 3.3.2rc2 tests run against 3.3.2rc2
code.



> * no clear path to test a not-yet-installed gdal
>
> When building a new gdal, it seems a good idea to run tests before
> installing it.  autoconf has done this for year with make check.  I see
> no obvious way to do this.
>

setdevenv.sh? Adding some sort of `make test` might be a cleaner approach
though.


>
> * puzzling test dependencies
>
>   It's not really clear if a missing dependency (vs requirements.txt)
>   will cause problems (assuming pytest and lxml are there), in terms of
>   just skipping some things, bad output, or perhaps some missing pretty
>   printing.
>

a mixture. Is there some particular reason installing everything in
requirements.txt from PyPi is a problem?


>   I think pytest-env is
>     https://pypi.org/project/pytest-env/#history
>   but that appears unmaintained, with a last release in 2017.   Perhaps
>   there are no outstanding bugs and no changes and it is actually
>   maintained but there is no reason to change -- but that is highly
>   implausible.   It seems boutique, based on not being in pkgsrc, which
>   means no one else has needed it, even though we have 20K packages.
>

It's about 45 lines of code. Pytest plugins are often fairly minimal, and
just do One Thing.


>   [Now I see that osr tests fail with a warning about env if this is
>   missing, but really the test should be skipped or hard fail and not
>   run without the env.]
>

Yes, I think it should hard-fail


> * I'm guessing the expectation is that all the tests pass.  With
>   autotest from master and 3.3.2rc2 installed (base lib and python
>   bindings), I get:
>

In general all the tests pass. There's skips/xfails for particular known
issues, but maybe you've found a bug? Maybe BSD-specific, BSD isn't part of
CI.


>
> * skipping tests after a failure.


> It would be nice to have hints in README.md about skipping tests, but it
> seems easy enough to run osr and then the following ones.
>

you mean, stopping on the first failure? `pytest -x ...`
autotest/README.md has some docs on running specific tests / modules / etc

GDAL has some odd test layouts with particular inter-test dependencies from
when the test suite was bulk-ported via automation to work under pytest ?
this made it a lot saner, but some of the "test 18 depends on test 17
passing" issues remain.

Rob :)

>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210901/5a3b2a4c/attachment.html>

From even.rouault at spatialys.com  Wed Sep  1 03:30:10 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 1 Sep 2021 12:30:10 +0200
Subject: [gdal-dev] GDAL 3.3.2 RC3 is available [was Re: GDAL 3.3.2 RC2
 available]
In-Reply-To: <a7a99b3c-07e7-30fd-7765-d68c63b195c0@spatialys.com>
References: <ec4c304f-7a78-f922-ed97-4313d3d8a1b0@spatialys.com>
 <a7a99b3c-07e7-30fd-7765-d68c63b195c0@spatialys.com>
Message-ID: <0e8d7eb6-b2ce-9e77-ebea-255ca9d2e26b@spatialys.com>

Hi,

a last minute 3.3.0 regression (#4404) in OpenCL warping showed up this 
morning, so I've decided to go for a RC3 (hopefully the last RC) with 
that only change since RC2.

Updated download links following Sean's proposed directory naming 
convention:

 ? https://download.osgeo.org/gdal/3.3.2rc3/gdal-3.3.2rc3.tar.xz
 ? https://download.osgeo.org/gdal/3.3.2rc3/gdal-3.3.2rc3.tar.gz
 ? https://download.osgeo.org/gdal/3.3.2rc3/gdal332rc3.zip

https://download.osgeo.org/gdal/3.3.2rc3/gdalautotest-3.3.2rc3.tar.gz
https://download.osgeo.org/gdal/3.3.2rc3/gdalautotest-3.3.2rc3.zip

Even

Le 31/08/2021 ? 11:05, Even Rouault a ?crit?:
> Hi,
>
> Here's a RC2 with 2 additional changes w.r.t RC1:
>
> - NEWS file to correctly mention 3.3.2
>
> - gdal_viewshed: Fix incorrect progress reporting (fixes #4390)
>
> Updated download links:
>
> ? https://download.osgeo.org/gdal/3.3.2/gdal-3.3.2rc2.tar.xz
> ? https://download.osgeo.org/gdal/3.3.2/gdal-3.3.2rc2.tar.gz
> ? https://download.osgeo.org/gdal/3.3.2/gdal332rc2.zip
>
> https://download.osgeo.org/gdal/3.3.2/gdalautotest-3.3.2rc2.tar.gz
> ? https://download.osgeo.org/gdal/3.3.2/gdalautotest-3.3.2rc2.zip
>
> Even
>
> Le 30/08/2021 ? 14:27, Even Rouault a ?crit?:
>> Hi,
>>
>> I have prepared a GDAL/OGR 3.3.2 release candidate.
>>
>> Pick up an archive among the following ones (by ascending size):
>>
>> ? https://download.osgeo.org/gdal/3.3.2/gdal-3.3.2rc1.tar.xz
>> ? https://download.osgeo.org/gdal/3.3.2/gdal-3.3.2rc1.tar.gz
>> ? https://download.osgeo.org/gdal/3.3.2/gdal332rc1.zip
>>
>> A snapshot of the gdalautotest suite is also available :
>>
>> https://download.osgeo.org/gdal/3.3.2/gdalautotest-3.3.2rc1.tar.gz
>> https://download.osgeo.org/gdal/3.3.2/gdalautotest-3.3.2rc1.zip
>>
>> GDAL-GRASS plugin:
>>
>> ? https://download.osgeo.org/gdal/3.3.2/gdal-grass-3.3.2.tar.gz
>>
>> The NEWS file is here :
>>
>> ? https://github.com/OSGeo/gdal/blob/v3.3.2RC1/gdal/NEWS
>>
>> I'll call for a vote promoting it to final later this week if no
>> serious problems are reported before.
>>
>> Best regards,
>>
>> Even
>>
-- 
http://www.spatialys.com
My software is free, but my time generally not.


From gdt at lexort.com  Wed Sep  1 06:54:27 2021
From: gdt at lexort.com (Greg Troxel)
Date: Wed, 01 Sep 2021 09:54:27 -0400
Subject: [gdal-dev] autotest questions/issues
In-Reply-To: <CAFLLRpKu7MLedCbGDfweSJMqGQVy9Z94FjwRtDM4zrqYB7ESMg@mail.gmail.com>
 (Robert Coup's message of "Wed, 1 Sep 2021 08:29:42 +0100")
References: <rmieea916ds.fsf@s1.lexort.com>
 <CAFLLRpKu7MLedCbGDfweSJMqGQVy9Z94FjwRtDM4zrqYB7ESMg@mail.gmail.com>
Message-ID: <rmi7dg0z9ik.fsf@s1.lexort.com>


Robert Coup <robert.coup at koordinates.com> writes:

Thanks for taking the time to respond to me.  It's becoming a lot clearer.

I should be clear that these issues are of course minor and mostly doc
issues and are not meant to be about whether the RC before us is
suitable.

>> * autotest is not in the distribution tarball
>
> Yeah, it's never been in the release tarballs. And the release tarballs
> start one folder level down (gdal/) as well.

I had no idea about that, and was just looking for autotest in the repo
since it wasn't in the tarball.  I see it now of course.  Certainly it
makes sense to have code and tests in the same repo.

> TBH I think the release tarballs should just match/be an archive of the git
> tag. But that's above my pay grade :-)

That's not quite the traditional view with autotools, but it is the
github way.  But it is traditional to have the tarball match the repo in
structure.

> @Debian and other package maintainers ? are you just getting the Git tags
> these days or do you actually use the release tarballs?

I am the maintainer for gdal in pkgsrc and I use release tarballs.  That
has been the traditional approach since the beginning of packaging, and
avoids the packaging system having to deal with N different VC backend
systems (not just "git", but various git hosting), and allows
distributed tarballs to be cache and easily moved around on CD/DVD.  As
I see it, the release tarballs are in fact the released products
intended for users, and that is therefore the proper ting to use.
Packaging in general is encapulating the standard user build and adding
metadata, within a system that keeps track of everything.

Good question of course also for Debian, RH, FreeBSD, OpenBSD, macports,
homebrew, etc.

>>   + Does it test the gdal that is installed in one's PATH (and
>>   PYTHONPATH), or is is testing the gdal that is in the source tree?
>
> CONTRIBUTING.md has a guide to run `scripts/setdevenv.sh` which sets up
> in-tree execution for utilities/libraries and the tests.

I see that now.  I expected to be able to read the README in autotest
and understand the big view of testing.  It feels like autotest is sort
of a separable part of gdal not being in the tarball.

(That script uses bash rather POSIX sh; with any luck that's just the #!
line.  It does use [[ in test, which isn't specified by POSIX shell.  It
might be nice to set POSIXLY_CORRECT in the environment to find these
issues.)

It's mostly obvious and entirely understandble with slight effort how to
set env vars to point to the built-but-not-installed version, so there's
no real problem -- and for now I am wanting to test releases.

>>   + Is one supposed to check out the corresponding branch (or really
>>   tag), or is it ok to test 3.3.2rc2 with master?
>>
>
> The tests should match the code, so 3.3.2rc2 tests run against 3.3.2rc2
> code.

So is it helpful to file a doc bug, or are you inclined (since you
actually understand the test plan) to adjust the README.md?

>> * no clear path to test a not-yet-installed gdal
>>
>> When building a new gdal, it seems a good idea to run tests before
>> installing it.  autoconf has done this for year with make check.  I see
>> no obvious way to do this.
>
> setdevenv.sh? Adding some sort of `make test` might be a cleaner approach
> though.

Yes, in general I take the view that it's good if a project meets the
standard interfaces so that people don't have to understand anything
about the project's test setup to run it.

It might also be nice to have a scheme uses variables set during the
build, perhaps in an created test_env.sh (that just has "export
GDAL_FOO=/bar" lines) instead of reaching in to figure them out again.
The main build already knows all these paths and it would be easy to
write such a file.

>> * puzzling test dependencies
>>
>>   It's not really clear if a missing dependency (vs requirements.txt)
>>   will cause problems (assuming pytest and lxml are there), in terms of
>>   just skipping some things, bad output, or perhaps some missing pretty
>>   printing.
>
> a mixture. Is there some particular reason installing everything in
> requirements.txt from PyPi is a problem?

In pkgsrc, we don't install from PyPi because that results in bits on
the system that are not managed by the packaging system.  Their presence
is unrecorded, and hence they won't get updated, won't be on the list of
needed packages when doing a bulk build on another system, and their
files will show up as spurious as a violation of the mostly-true "all
files in the packaging prefix are recorded as being part of some
package" invariant.

However, what we do is to create a package for that, which does the
equivalent download/install, which amounts to the same thing but staying
without the packaging system, ensuring system-wide options are followed
and the files are recorded as belonging to the package.  That's not a
big deal, especially for pure python using normal setuptools/distutils,
and I'll get around to it.

I expect that other packaging systems have a similar approach.

I was really coming at this from the point of view that normally a
package lists required dependencies and optional dependencies, and I had
no idea what would happen if one were missing.

>>   I think pytest-env is
>>     https://pypi.org/project/pytest-env/#history
>>   but that appears unmaintained, with a last release in 2017.   Perhaps
>>   there are no outstanding bugs and no changes and it is actually
>>   maintained but there is no reason to change -- but that is highly
>>   implausible.   It seems boutique, based on not being in pkgsrc, which
>>   means no one else has needed it, even though we have 20K packages.
>
> It's about 45 lines of code. Pytest plugins are often fairly minimal, and
> just do One Thing.

Perhaps a link to PyPi in the README and a statement that something that
appears unmaintained really is the intended dependency.  It just came
across to me that it was more likely I have failed to find the right
code, than that the last release really is 4 years ago.  I had a similar
experience a few days ago for something totally unrelated, and in that
case the homepage with code from 2017 was out of data and there were
more recent releases someplace else.

>>   [Now I see that osr tests fail with a warning about env if this is
>>   missing, but really the test should be skipped or hard fail and not
>>   run without the env.]
>
> Yes, I think it should hard-fail

Should I file a bug?  What I got was

/home/n0/gdt/SOFTWARE/GEO/GDAL/gdal/autotest/osr/osr_pci.py:200: AssertionError
=============================== warnings summary ===============================
../../../../../../../../usr/pkg/lib/python3.8/site-packages/_pytest/config/__init__.py:1233
  /usr/pkg/lib/python3.8/site-packages/_pytest/config/__init__.py:1233: PytestConfigWarning: Unknown config option: env
  
    self._warn_or_fail_if_strict(f"Unknown config option: {key}\n")

-- Docs: https://docs.pytest.org/en/stable/warnings.html

which I think led to testing without the env var.

>> * I'm guessing the expectation is that all the tests pass.  With
>>   autotest from master and 3.3.2rc2 installed (base lib and python
>>   bindings), I get:
>
> In general all the tests pass. There's skips/xfails for particular known
> issues, but maybe you've found a bug? Maybe BSD-specific, BSD isn't part of
> CI.

It would be really nice to add one.  I do see there is macOS, which is
at least !Linux.  In packaging it is fairly typical to see problems from
code that makes beyond-POSIX assumptions that of course worked in the
development environment, but so far I have no hint of that here.

>> * skipping tests after a failure.
>
>> It would be nice to have hints in README.md about skipping tests, but it
>> seems easy enough to run osr and then the following ones.
>
> you mean, stopping on the first failure? `pytest -x ...`
> autotest/README.md has some docs on running specific tests / modules / etc

It does, but I didn't understand how to solve my issue, which is a
python segfault (likely in gdal binary code loaded in a module, I
speculate without basis) that ended the entire test run.   I worked
around that my removing ogr/ogr_mitab.py and rerunning.

> GDAL has some odd test layouts with particular inter-test dependencies from
> when the test suite was bulk-ported via automation to work under pytest ?
> this made it a lot saner, but some of the "test 18 depends on test 17
> passing" issues remain.

Yes, I did see that caution and was trying to avoid doing anything
non-standard.


At this point I think I've run into something else, that might need
explaining in README or perhaps somethihng else.   When we build gdal
for pkgsrc, we have most drivers and most dependencies, but I suspect
some are missing, mostly because the dependencies aren't packaged and
nobody is complaiming about a missing format.  I wonder how much of my
test problems are about that.   Without ogr_mitab, there are a lot of
tests that end up

  E       AttributeError: 'NoneType' object has no attribute 'ExecuteSQL'

which isn't the real problem.


I also saw things like

  ERROR 1: Driver GTM is considered for removal in GDAL 3.5. You are
  invited to convert any dataset in that format to another more common one
  .If you need this driver in fut ure GDAL versions, create a ticket at
  https://github.com/OSGeo/gdal (look first for an existing one first) to
  explain how critical it is for you (but the GDAL project may still
  remove it), and to enable it now, set the
  GDAL_ENABLE_DEPRECATED_DRIVER_GTM configuration option / environment
  variable to YES ERROR 1: GPSTrackMaker driver failed to create
  tmp/testogr2ogr21.gtm

and I wonder if the tests should be setting
GDAL_ENABLE_DEPRECATED_DRIVER_FOO.
Alternatively those tests could be in a separate driver file and not
normally invoked.






I looked into the ogr_mitab.py failure, and it looks like the crash
might be just a secondary failure, sort of using a NULL pointer that
wasn't expected, or code written in C missing input validation.

Test session starts (platform: netbsd9, Python 3.8.11, pytest 6.2.4, pytest-sugar 0.9.4)
cachedir: .pytest_cache
rootdir: /home/n0/gdt/SOFTWARE/GEO/GDAL/gdal/autotest, configfile: pytest.ini
plugins: sugar-0.9.4
collecting ...
 ogr/ogr_mitab.py::test_ogr_mitab_2 ?                                                                                                                         2% ?

??????????????????????????????????????????????????? test_ogr_mitab_3 ?????????????????????????????????????????????????????????????????????????????

    def test_ogr_mitab_3():

        gdaltest.mapinfo_ds = ogr.Open('tmp')
>       gdaltest.mapinfo_lyr = gdaltest.mapinfo_ds.GetLayer(0)
E       AttributeError: 'NoneType' object has no attribute 'GetLayer'

/home/n0/gdt/SOFTWARE/GEO/GDAL/gdal/autotest/ogr/ogr_mitab.py:124: AttributeError

 ogr/ogr_mitab.py::test_ogr_mitab_3 ?                                                                                                                         3% ?

?????????????????????????????????????????????????????? test_ogr_mitab_4 ?????????????????????????????????????????????????????????????????????????????

    def test_ogr_mitab_4():

>       sql_lyr = gdaltest.mapinfo_ds.ExecuteSQL(
            "select * from tpoly where prfedea = '35043413'")
E       AttributeError: 'NoneType' object has no attribute 'ExecuteSQL'

/home/n0/gdt/SOFTWARE/GEO/GDAL/gdal/autotest/ogr/ogr_mitab.py:157: AttributeError

 ogr/ogr_mitab.py::test_ogr_mitab_4 ?       5%

Fatal Python error: Segmentation fault
 
Current thread 0x000078c2de374800 (most recent call first):
  File "/usr/pkg/lib/python3.8/site-packages/osgeo/ogr.py", line 1143 in SetAttributeFilter
  File "/home/n0/gdt/SOFTWARE/GEO/GDAL/gdal/autotest/ogr/ogr_mitab.py", line 177 in test_ogr_mitab_5
  File "/usr/pkg/lib/python3.8/site-packages/_pytest/python.py", line 183 in pytest_pyfunc_call
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210901/77516bac/attachment-0001.sig>

From gdt at lexort.com  Wed Sep  1 07:14:01 2021
From: gdt at lexort.com (Greg Troxel)
Date: Wed, 01 Sep 2021 10:14:01 -0400
Subject: [gdal-dev] GDAL 3.3.2 RC3 is available [was Re: GDAL 3.3.2 RC2
 available]
In-Reply-To: <0e8d7eb6-b2ce-9e77-ebea-255ca9d2e26b@spatialys.com> (Even
 Rouault's message of "Wed, 1 Sep 2021 12:30:10 +0200")
References: <ec4c304f-7a78-f922-ed97-4313d3d8a1b0@spatialys.com>
 <a7a99b3c-07e7-30fd-7765-d68c63b195c0@spatialys.com>
 <0e8d7eb6-b2ce-9e77-ebea-255ca9d2e26b@spatialys.com>
Message-ID: <rmio89cxu1i.fsf@s1.lexort.com>


Even Rouault <even.rouault at spatialys.com> writes:

> Updated download links following Sean's proposed directory naming
> convention:
>
> ? https://download.osgeo.org/gdal/3.3.2rc3/gdal-3.3.2rc3.tar.xz
> ? https://download.osgeo.org/gdal/3.3.2rc3/gdal-3.3.2rc3.tar.gz
> ? https://download.osgeo.org/gdal/3.3.2rc3/gdal332rc3.zip

This surprised me - I thought the comment was about the directory name
in the unpacked set of files, not the URL.  From my viewpoint not having
the rc in the dirname was good, because the rc is not in the unpacked
dirname.  (It also surprised me to be happening at rcN stage, but that's
not important.)

(I realize the point of the rc is to promote it unchanged, but that
means the convention that foo-${VERSION} unpacks to
foo-${VERSION}/README and so on is violated, and that requires working
around at least in pkgsrc.  However I have that workaround already,
basically seting two VERSION variables, version and rcsuffix, and using
one or both in various places.  So from my viewpoint, it's better to let
things be.)


> https://download.osgeo.org/gdal/3.3.2rc3/gdalautotest-3.3.2rc3.tar.gz
> https://download.osgeo.org/gdal/3.3.2rc3/gdalautotest-3.3.2rc3.zip

I had managed to miss that autotest had tarballs, but I'm glad to see
it.  I suppose I should create a gdal-autotest package that either
installs nothing and can run tests at package creation time, or installs
the tests so that they can be run on the system.  For now I have a git
checkout.

(test build in process)
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210901/170e3d16/attachment.sig>

From even.rouault at spatialys.com  Wed Sep  1 07:19:51 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 1 Sep 2021 16:19:51 +0200
Subject: [gdal-dev] GDAL 3.3.2 RC3 is available [was Re: GDAL 3.3.2 RC2
 available]
In-Reply-To: <rmio89cxu1i.fsf@s1.lexort.com>
References: <ec4c304f-7a78-f922-ed97-4313d3d8a1b0@spatialys.com>
 <a7a99b3c-07e7-30fd-7765-d68c63b195c0@spatialys.com>
 <0e8d7eb6-b2ce-9e77-ebea-255ca9d2e26b@spatialys.com>
 <rmio89cxu1i.fsf@s1.lexort.com>
Message-ID: <a5e0467e-35de-5c18-8c27-e0500cf86377@spatialys.com>


>> Updated download links following Sean's proposed directory naming
>> convention:
>>
>>  ? https://download.osgeo.org/gdal/3.3.2rc3/gdal-3.3.2rc3.tar.xz
>>  ? https://download.osgeo.org/gdal/3.3.2rc3/gdal-3.3.2rc3.tar.gz
>>  ? https://download.osgeo.org/gdal/3.3.2rc3/gdal332rc3.zip
> This surprised me - I thought the comment was about the directory name
> in the unpacked set of files, not the URL.  From my viewpoint not having
> the rc in the dirname was good, because the rc is not in the unpacked
> dirname.  (It also surprised me to be happening at rcN stage, but that's
> not important.)
Ah I missed that part of Sean's message. Well, yes, we can't change the 
directory name in the RC, since the RC packages are supposed to be 
candidates for final ones. And actually when promotting a RC to final, 
we just rename the .zip / .tar.gz, so its content is bit-to-bit 
identical to the RC.

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From even.rouault at spatialys.com  Wed Sep  1 07:25:51 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 1 Sep 2021 16:25:51 +0200
Subject: [gdal-dev] autotest questions/issues
In-Reply-To: <rmi7dg0z9ik.fsf@s1.lexort.com>
References: <rmieea916ds.fsf@s1.lexort.com>
 <CAFLLRpKu7MLedCbGDfweSJMqGQVy9Z94FjwRtDM4zrqYB7ESMg@mail.gmail.com>
 <rmi7dg0z9ik.fsf@s1.lexort.com>
Message-ID: <1f418bea-1932-adea-1379-2b38a6c98727@spatialys.com>

Greg,
> I see that now.  I expected to be able to read the README in autotest
> and understand the big view of testing.  It feels like autotest is sort
> of a separable part of gdal not being in the tarball.
People who build GDAL from sources in scripts (Docker images etc) just 
need the sources. So a tarball with tests included is much larger than 
needed for their purposes
>>
>> The tests should match the code, so 3.3.2rc2 tests run against 3.3.2rc2
>> code.
> So is it helpful to file a doc bug, or are you inclined (since you
> actually understand the test plan) to adjust the README.md?
Seemed pretty obvious to me that you should use the gdalautotest-X 
version that matches the gdal-X one :-) Feel free to submit pull 
request(s) with documentation improvement that makes sense.
>> setdevenv.sh? Adding some sort of `make test` might be a cleaner approach
>> though.
> Yes, in general I take the view that it's good if a project meets the
> standard interfaces so that people don't have to understand anything
> about the project's test setup to run it.
When we'll switch to cmake, hopefully people will just have to run ctest 
. I don't think we want to invest more currently in improving the 
current GNUmakefile based infrastructure with a make check target
>
> I was really coming at this from the point of view that normally a
> package lists required dependencies and optional dependencies, and I had
> no idea what would happen if one were missing.
As its name suggests, whatever is in autotest/requirements.txt is 
required. If some components are missing, anything can happen at runtime.
>
>>>    [Now I see that osr tests fail with a warning about env if this is
>>>    missing, but really the test should be skipped or hard fail and not
>>>    run without the env.]
>> Yes, I think it should hard-fail
> Should I file a bug?  What I got was
>
> /home/n0/gdt/SOFTWARE/GEO/GDAL/gdal/autotest/osr/osr_pci.py:200: AssertionError
> =============================== warnings summary ===============================
> ../../../../../../../../usr/pkg/lib/python3.8/site-packages/_pytest/config/__init__.py:1233
>    /usr/pkg/lib/python3.8/site-packages/_pytest/config/__init__.py:1233: PytestConfigWarning: Unknown config option: env
>    
>      self._warn_or_fail_if_strict(f"Unknown config option: {key}\n")
>
> -- Docs: https://docs.pytest.org/en/stable/warnings.html
>
> which I think led to testing without the env var.
It's just that you didn't install pytest-env.
>
> It does, but I didn't understand how to solve my issue, which is a
> python segfault (likely in gdal binary code loaded in a module, I
> speculate without basis) that ended the entire test run.   I worked
> around that my removing ogr/ogr_mitab.py and rerunning.
Once you've installed all requirements, would be interesting to retry 
again. In some cases, Python failures can become segfaults due to 
unexpected bad use of C API, particular for tests that are 
interdependent as Robert mentioned. What can happen sometimes is that 
when unexpected test failures happen, some temporary files in the 
autotest/xxxx/tmp files remain, and cause subsequent test runs to fail. 
Some manual cleaning might be needed.
>
> I also saw things like
>
>    ERROR 1: Driver GTM is considered for removal in GDAL 3.5. You are
>    invited to convert any dataset in that format to another more common one
>    .If you need this driver in fut ure GDAL versions, create a ticket at
>    https://github.com/OSGeo/gdal (look first for an existing one first) to
>    explain how critical it is for you (but the GDAL project may still
>    remove it), and to enable it now, set the
>    GDAL_ENABLE_DEPRECATED_DRIVER_GTM configuration option / environment
>    variable to YES ERROR 1: GPSTrackMaker driver failed to create
>    tmp/testogr2ogr21.gtm
>
> and I wonder if the tests should be setting
> GDAL_ENABLE_DEPRECATED_DRIVER_FOO.
> Alternatively those tests could be in a separate driver file and not
> normally invoked.

Will not happen once pytest-env is installed, since autotest/pytest.ini 
does set those environment variables

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From sebastic at xs4all.nl  Wed Sep  1 07:20:06 2021
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Wed, 1 Sep 2021 16:20:06 +0200
Subject: [gdal-dev] GDAL 3.3.2 RC3 is available [was Re: GDAL 3.3.2 RC2
 available]
In-Reply-To: <rmio89cxu1i.fsf@s1.lexort.com>
References: <ec4c304f-7a78-f922-ed97-4313d3d8a1b0@spatialys.com>
 <a7a99b3c-07e7-30fd-7765-d68c63b195c0@spatialys.com>
 <0e8d7eb6-b2ce-9e77-ebea-255ca9d2e26b@spatialys.com>
 <rmio89cxu1i.fsf@s1.lexort.com>
Message-ID: <02311ed9-8baf-6963-f634-7f4de5c5aa53@xs4all.nl>

On 9/1/21 4:14 PM, Greg Troxel wrote:
> Even Rouault <even.rouault at spatialys.com> writes:
> 
>> Updated download links following Sean's proposed directory naming
>> convention:
>>
>> ? https://download.osgeo.org/gdal/3.3.2rc3/gdal-3.3.2rc3.tar.xz
>> ? https://download.osgeo.org/gdal/3.3.2rc3/gdal-3.3.2rc3.tar.gz
>> ? https://download.osgeo.org/gdal/3.3.2rc3/gdal332rc3.zip
> 
> This surprised me - I thought the comment was about the directory name
> in the unpacked set of files, not the URL.

>From a Debian packaging point of view I'm also not a fan of the rc
subdirectories, it was much better to have the RCs and final release in
the same directory.

3.3.2rc3 sorts after 3.3.2, 3.3.2~rc3 sorts before 3.3.2 but that
directory has the older rc2 release. If all future releases use the
pre-release suffix for the directory the watch file in the Debian
package can be adapted, otherwise we'll have the change to work with
whatever is use for the most recent release.

Kind Regards,

Bas

-- 
 GPG Key ID: 4096R/6750F10AE88D4AF1
Fingerprint: 8182 DE41 7056 408D 6146  50D1 6750 F10A E88D 4AF1

From jmckenna at gatewaygeomatics.com  Wed Sep  1 07:38:06 2021
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Wed, 1 Sep 2021 11:38:06 -0300
Subject: [gdal-dev] GDAL 3.3.2 RC3 is available [was Re: GDAL 3.3.2 RC2
 available]
In-Reply-To: <02311ed9-8baf-6963-f634-7f4de5c5aa53@xs4all.nl>
References: <ec4c304f-7a78-f922-ed97-4313d3d8a1b0@spatialys.com>
 <a7a99b3c-07e7-30fd-7765-d68c63b195c0@spatialys.com>
 <0e8d7eb6-b2ce-9e77-ebea-255ca9d2e26b@spatialys.com>
 <rmio89cxu1i.fsf@s1.lexort.com>
 <02311ed9-8baf-6963-f634-7f4de5c5aa53@xs4all.nl>
Message-ID: <7ef34ddc-030c-2169-e103-812ef87492db@gatewaygeomatics.com>

 From the Windows packaging point of view I'm also not a fan of the rc 
subdirectories.  (my 2 cents)

-jeff




-- 
Jeff McKenna
GatewayGeo: Developers of MS4W, MapServer Consulting and Training
co-founder of FOSS4G
http://gatewaygeo.com/



On 2021-09-01 11:20 a.m., Sebastiaan Couwenberg wrote:
> On 9/1/21 4:14 PM, Greg Troxel wrote:
>> Even Rouault <even.rouault at spatialys.com> writes:
>>
>>> Updated download links following Sean's proposed directory naming
>>> convention:
>>>
>>>  ? https://download.osgeo.org/gdal/3.3.2rc3/gdal-3.3.2rc3.tar.xz
>>>  ? https://download.osgeo.org/gdal/3.3.2rc3/gdal-3.3.2rc3.tar.gz
>>>  ? https://download.osgeo.org/gdal/3.3.2rc3/gdal332rc3.zip
>>
>> This surprised me - I thought the comment was about the directory name
>> in the unpacked set of files, not the URL.
> 
>  From a Debian packaging point of view I'm also not a fan of the rc
> subdirectories, it was much better to have the RCs and final release in
> the same directory.
> 
> 3.3.2rc3 sorts after 3.3.2, 3.3.2~rc3 sorts before 3.3.2 but that
> directory has the older rc2 release. If all future releases use the
> pre-release suffix for the directory the watch file in the Debian
> package can be adapted, otherwise we'll have the change to work with
> whatever is use for the most recent release.
> 
> Kind Regards,
> 
> Bas
> 


From loridigia at gmail.com  Wed Sep  1 07:40:19 2021
From: loridigia at gmail.com (Lorenzo Di Giacomo)
Date: Wed, 1 Sep 2021 16:40:19 +0200
Subject: [gdal-dev] Java bindings on debian
Message-ID: <CAERmyNRO5WJqFJoxYSp7pwcX1gou_E6Q4c_73aqniXv7_pPmug@mail.gmail.com>

Hi, i saw that Debian now has GDAL 3.2.2 available.
I can install it and also the python3 bindings, but they doesn't have the
java bindings.
I download GDAL-3.2.2 and do "./configure", then "make" and later i go on
"/swig/java" and do "make" but i get:



*cannot find the library '/gdal-3.2.2/libgdal.la <http://libgdal.la>' or
unhandled argument '/gdal-3.2.2/libgdal.la <http://libgdal.la>'*

How can i get libgdal.la?
I must build GDAL from the source in order to have java bindings? Can i
only build from the sources the bindings? Thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210901/86d1d1b6/attachment.html>

From even.rouault at spatialys.com  Wed Sep  1 07:46:40 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 1 Sep 2021 16:46:40 +0200
Subject: [gdal-dev] Java bindings on debian
In-Reply-To: <CAERmyNRO5WJqFJoxYSp7pwcX1gou_E6Q4c_73aqniXv7_pPmug@mail.gmail.com>
References: <CAERmyNRO5WJqFJoxYSp7pwcX1gou_E6Q4c_73aqniXv7_pPmug@mail.gmail.com>
Message-ID: <d65cd781-53b8-e46e-23c7-25c01987501b@spatialys.com>


Le 01/09/2021 ? 16:40, Lorenzo Di Giacomo a ?crit?:
> Hi, i saw that Debian now has GDAL 3.2.2 available.
> I can install it and also the python3 bindings, but they doesn't have 
> the java bindings.
> I download GDAL-3.2.2 and do "./configure", then "make" and later i go 
> on "/swig/java" and do "make" but i get:
>
> *cannot find the library '/gdal-3.2.2/libgdal.la <http://libgdal.la>' 
> or unhandled argument '/gdal-3.2.2/libgdal.la <http://libgdal.la>'
>
> *
>
> How can i get libgdal.la <http://libgdal.la>?
> I must build GDAL from the source in order to have java bindings? Can 
> i only build from the sources the bindings? Thanks
>
Yes you'll have to build the native lib from the sources. You could 
potentially make the Java bindings build against the installed native 
lib, but that would require tweaking the build recipees

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210901/3299eb1b/attachment.html>

From sean at mapbox.com  Wed Sep  1 08:49:58 2021
From: sean at mapbox.com (Sean Gillies)
Date: Wed, 1 Sep 2021 09:49:58 -0600
Subject: [gdal-dev] autotest questions/issues
In-Reply-To: <CAFLLRpKu7MLedCbGDfweSJMqGQVy9Z94FjwRtDM4zrqYB7ESMg@mail.gmail.com>
References: <rmieea916ds.fsf@s1.lexort.com>
 <CAFLLRpKu7MLedCbGDfweSJMqGQVy9Z94FjwRtDM4zrqYB7ESMg@mail.gmail.com>
Message-ID: <CADPhZXynq3R=17DS9J2WevYBp7v5jOsC2j21=1E66PxEhmfTcA@mail.gmail.com>

Hi Robert,

On Wed, Sep 1, 2021 at 1:30 AM Robert Coup <robert.coup at koordinates.com>
wrote:

> ...
>
> GDAL has some odd test layouts with particular inter-test dependencies
> from when the test suite was bulk-ported via automation to work under
> pytest ? this made it a lot saner, but some of the "test 18 depends on test
> 17 passing" issues remain.
>
> Rob :)
>

The test runner upgrades that you mentioned were a huge help. Now that GDAL
has a real maintenance budget we should be able to pay someone to tackle
the remaining issues in a methodical way. Run the tests in a random order,
say using https://pypi.org/project/pytest-random-order/, and fix the
setup/teardown so that tests are properly isolated.

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210901/db6ae9e3/attachment-0001.html>

From gdt at lexort.com  Wed Sep  1 09:27:10 2021
From: gdt at lexort.com (Greg Troxel)
Date: Wed, 01 Sep 2021 12:27:10 -0400
Subject: [gdal-dev] test failures on pkgsrc build of 3.3.2rc3
Message-ID: <rmi5yvkxnvl.fsf@s1.lexort.com>


This message is not a request to hold 3.3.2.  At this point, I don't
have any basis to believe that there's anything wrong with gdal, and I
haven't previously run the tests.

Thanks to Robert and Even for explaining about the test infrastructure.
I've addressed a few things
 - packaging pytest-env
 - work around tests possibly failing due to stale files by manual cleaning
   (but that appears not to make any difference)
 - temporarily removed the ogr_mitab test that leads to a python crash
   which aborts the entire test run

and now have a test run that shows:

  = 312 failed, 6939 passed, 1489 skipped, 2 xfailed, 2 warnings in 746.96s (0:12:26) =

which seems quite good overall.

Note that this my gdal was built with proj 6.3.2, partly old to avoid a
version with removed interfaces that other software needs, and partly
because I haven't gotten to dealing (in packaging) with the new proj
data layout.  As I understand it, though, that's a supported version for
gdal, and the gdal build succeeds.  I suspect if this does matter, it's
only for a few tests.

pkgsrc build log (showing configue output), driver list (from ogrinfo
failure), and test output at:

  http://www.lexort.com/GDAL/

Looking into the avc failure, I find

$ ogrinfo ogr/data/avc/testavc/testavc/
INFO: Open of `ogr/data/avc/testavc/testavc/'
      using driver `AVCBin' successful.
1: ARC (Line String)
2: LAB (Point)

But if I leave off the trailing / I get a failure to find a driver.  A
trailing slash on a directrory name seems odd to me, and usually the
result of completion.  I don't know if the slash mattering is right or
not and if it relates the test problems, but I see in the logs:

        avc_ds = ogr.Open('data/avc/testavc/testavc')
>       assert avc_ds.GetLayer(0).GetSpatialRef() is not None, 'expected SRS'
E       AttributeError: 'NoneType' object has no attribute 'GetLayer'

where the open does not have  trailing slash.

I do see AVCBin in my list of drivers.

Greg
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210901/2710111e/attachment.sig>

From loridigia at gmail.com  Wed Sep  1 09:30:44 2021
From: loridigia at gmail.com (Lorenzo Di Giacomo)
Date: Wed, 1 Sep 2021 18:30:44 +0200
Subject: [gdal-dev] GDAL_RETILE levels
Message-ID: <CAERmyNQPsCiONSQe1VRyLnR__ea1MM=J0eOFVyJW-VGPkXtkhA@mail.gmail.com>

Hi, i'd like have 18 levels in my pyramid in order to have a better control
of the cache.
The problem is that GDAL_RETILE when arrives at about 10th level, gave
error:

'NoneType' object has no attribute 'SetGeoTransform'

Do you know why is this happening? Is allowed to have all this levels in
the pyramid? Thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210901/2f0a5c76/attachment.html>

From even.rouault at spatialys.com  Wed Sep  1 09:46:16 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 1 Sep 2021 18:46:16 +0200
Subject: [gdal-dev] test failures on pkgsrc build of 3.3.2rc3
In-Reply-To: <rmi5yvkxnvl.fsf@s1.lexort.com>
References: <rmi5yvkxnvl.fsf@s1.lexort.com>
Message-ID: <b688e570-3585-e8ec-e74d-577c34452848@spatialys.com>


> and now have a test run that shows:
>
>    = 312 failed, 6939 passed, 1489 skipped, 2 xfailed, 2 warnings in 746.96s (0:12:26) =
>
> which seems quite good overall.

For a reasonably well setup environment, you should not get more than a 
handful of failures. 312 definitely indicates something wrong. Looking a 
bit at the logs you provide, they are explicit and implicit complaints 
about GDAL_DATA not being set. I'm not sure if you're running agains an 
installed GDAL lib (in which case, there's something wrong in your build 
if it can't find /usr/share/gdal/ or whatever similar dir in which GDAL 
data is installed), or if it a in-build GDAL (in which case GDAL_DATA 
env var must be explicitly set as done in setdevenv.sh)

A number of PROJ related failures can be caused by some grids being 
missing. The 'conus' grid from 
http://download.osgeo.org/proj/proj-datumgrid-1.8.tar.gz (there might be 
others from that package. at least this is the one used for our CI) must 
in particular be installed in /usr/share/proj (or 'us_noaa_conus.tif' in 
PROJ 7 or later)

>
> Note that this my gdal was built with proj 6.3.2, partly old to avoid a
> version with removed interfaces that other software needs, and partly
> because I haven't gotten to dealing (in packaging) with the new proj
> data layout.  As I understand it, though, that's a supported version for
> gdal, and the gdal build succeeds.  I suspect if this does matter, it's
> only for a few tests.
It is possible to get a few PROJ related failures from time to time 
given which version you use. Our CI covers a number of versions, but not 
all obviously.
>
> pkgsrc build log (showing configue output), driver list (from ogrinfo
> failure), and test output at:
>
>    http://www.lexort.com/GDAL/
>
> Looking into the avc failure, I find
>
> $ ogrinfo ogr/data/avc/testavc/testavc/
> INFO: Open of `ogr/data/avc/testavc/testavc/'
>        using driver `AVCBin' successful.
> 1: ARC (Line String)
> 2: LAB (Point)
>
> But if I leave off the trailing / I get a failure to find a driver.  A
> trailing slash on a directrory name seems odd to me, and usually the
> result of completion.

Hum, I suspect you might hit a similar issue as the one for FreeBSD in 
https://github.com/OSGeo/gdal/blob/a95e796f65b26379b0e5c699bacef29f7684f79f/gdal/gcore/gdalopeninfo.cpp#L216 
where fopen("/some/dir", "rb") succeeds.

Can you test changing that with whatever define is appropriate to test 
for your OS and submit the resulting patch ?

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From gdt at lexort.com  Wed Sep  1 12:15:09 2021
From: gdt at lexort.com (Greg Troxel)
Date: Wed, 01 Sep 2021 15:15:09 -0400
Subject: [gdal-dev] test failures on pkgsrc build of 3.3.2rc3
References: <rmi5yvkxnvl.fsf@s1.lexort.com>
 <b688e570-3585-e8ec-e74d-577c34452848@spatialys.com>
Message-ID: <rmik0k0umyq.fsf@s1.lexort.com>


Even Rouault <even.rouault at spatialys.com> writes:

>> and now have a test run that shows:
>>
>>    = 312 failed, 6939 passed, 1489 skipped, 2 xfailed, 2 warnings in 746.96s (0:12:26) =
>>
>> which seems quite good overall.
>
> For a reasonably well setup environment, you should not get more than
> a handful of failures. 312 definitely indicates something
> wrong. Looking a bit at the logs you provide, they are explicit and

I meant that for a system where test issues were not yet debugged it
didn't seem too bad.  But we are rapidly reducing the count: now down to
20.

> implicit complaints about GDAL_DATA not being set. I'm not sure if
> you're running agains an installed GDAL lib (in which case, there's
> something wrong in your build if it can't find /usr/share/gdal/ or
> whatever similar dir in which GDAL data is installed), or if it a
> in-build GDAL (in which case GDAL_DATA env var must be explicitly set
> as done in setdevenv.sh)

I am running against installed gdal, which was built with configure
fairly normally.  There's a lot of stuff in /usr/pkg/share/gdal.  But,
from trying to look at the dev env setup, I had a bad GDAL_DATA
variable, and that was the problem.

> A number of PROJ related failures can be caused by some grids being
> missing. The 'conus' grid from
> http://download.osgeo.org/proj/proj-datumgrid-1.8.tar.gz (there might
> be others from that package. at least this is the one used for our CI)
> must in particular be installed in /usr/share/proj (or
> 'us_noaa_conus.tif' in PROJ 7 or later)

OK - I have the grids intalled, but it is interesting to note that proj
tests require them not to be installed while gdal tests require them to
be installed.

> It is possible to get a few PROJ related failures from time to time
> given which version you use. Our CI covers a number of versions, but
> not all obviously.

I would hope 6.3.2 is still on the ok list.  Lots of systems are a bit
behind.

> Hum, I suspect you might hit a similar issue as the one for FreeBSD in
> https://github.com/OSGeo/gdal/blob/a95e796f65b26379b0e5c699bacef29f7684f79f/gdal/gcore/gdalopeninfo.cpp#L216
> where fopen("/some/dir", "rb") succeeds.

Separate reply coming about this.  Thanks very much for the pointer,
which saved me a really long time looking into this.



New test log at

http://www.lexort.com/GDAL/

Looks like a lot of this the rtree module in sqlite3, which seems to
think telling you to go back and rebuild something with different
non-default options is a reasonable approach :-(  

I had not previously grasped that rtree was required, and configure
seems not to test for it.   Or perhaps it's not required and the tests
should skip?

But it looks like adjusting sqlite to have rtree will resolve more than
half the remaining errors.

(Thus, the test suite is being highly useful.)
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210901/1f742705/attachment.sig>

From gdt at lexort.com  Wed Sep  1 12:22:30 2021
From: gdt at lexort.com (Greg Troxel)
Date: Wed, 01 Sep 2021 15:22:30 -0400
Subject: [gdal-dev] test failures on pkgsrc build of 3.3.2rc3
References: <rmi5yvkxnvl.fsf@s1.lexort.com>
 <b688e570-3585-e8ec-e74d-577c34452848@spatialys.com>
Message-ID: <rmibl5cummh.fsf@s1.lexort.com>


>> Looking into the avc failure, I find
>>
>> $ ogrinfo ogr/data/avc/testavc/testavc/
>> INFO: Open of `ogr/data/avc/testavc/testavc/'
>>        using driver `AVCBin' successful.
>> 1: ARC (Line String)
>> 2: LAB (Point)
>>
>> But if I leave off the trailing / I get a failure to find a driver.  A
>> trailing slash on a directrory name seems odd to me, and usually the
>> result of completion.
>
> Hum, I suspect you might hit a similar issue as the one for FreeBSD in
> https://github.com/OSGeo/gdal/blob/a95e796f65b26379b0e5c699bacef29f7684f79f/gdal/gcore/gdalopeninfo.cpp#L216
> where fopen("/some/dir", "rb") succeeds.
>
> Can you test changing that with whatever define is appropriate to test
> for your OS and submit the resulting patch ?

The comment about FreeBSD being odd seems strange to me, as POSIX has no
notion that fopen must fail when opening a directory for reading.

  https://pubs.opengroup.org/onlinepubs/9699919799/functions/fopen.html
  https://pubs.opengroup.org/onlinepubs/9699919799/functions/open.html

As I read the spec, it is a violation to return NULL when the first
argument is a directory and the second is r or rb.  A test program
succeeds in calling fopen on . with rb, on both NetBSD and macOS 10.13.

Perhaps I am misreading the POSIX spec.

I applied a patch to always do the directory check, and now ogrinfo
works with or without the trailing /.   Patch looks more complicated
than it is....

--- gcore/gdalopeninfo.cpp.orig	2021-09-01 09:48:45.000000000 +0000
+++ gcore/gdalopeninfo.cpp
@@ -213,12 +213,8 @@ retry:  // TODO(schwehr): Stop using got
 
 #endif  // HAVE_READLINK
 
-#ifdef __FreeBSD__
-    /* FreeBSD 8 oddity: fopen(a_directory, "rb") returns non NULL */
+    /* fopen(dir, "r") is required to succeed, per POSIX */
     bool bPotentialDirectory = (eAccess == GA_ReadOnly);
-#else
-    bool bPotentialDirectory = false;
-#endif  // __FreeBDS__
 
     /* Check if the filename might be a directory of a special virtual file system */
     if( STARTS_WITH(pszFilename, "/vsizip/") ||


A test run with this fix and GDAL_DATA unset got to only 20 failures.

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: test_fopen.c
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210901/0ddc7e95/attachment.c>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210901/0ddc7e95/attachment.sig>

From even.rouault at spatialys.com  Wed Sep  1 12:36:31 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 1 Sep 2021 21:36:31 +0200
Subject: [gdal-dev] test failures on pkgsrc build of 3.3.2rc3
In-Reply-To: <rmik0k0umyq.fsf@s1.lexort.com>
References: <rmi5yvkxnvl.fsf@s1.lexort.com>
 <b688e570-3585-e8ec-e74d-577c34452848@spatialys.com>
 <rmik0k0umyq.fsf@s1.lexort.com>
Message-ID: <65b5c9fe-7403-7d78-b83d-7f224f9f5dd1@spatialys.com>


> Looks like a lot of this the rtree module in sqlite3, which seems to
> think telling you to go back and rebuild something with different
> non-default options is a reasonable approach :-(

sqlite3 with rtree support is a requirement for GeoPackage and Spatialite.

> I had not previously grasped that rtree was required, and configure
> seems not to test for it.
No rtree isn't tested by GDAL's configure. Looking at sqlite3 own 
configure, I see rtree is supposed to be built-in by default

 ?./configure --help | grep rtree
 ? --enable-rtree????????? include rtree support [default=yes]

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From even.rouault at spatialys.com  Wed Sep  1 12:50:24 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 1 Sep 2021 21:50:24 +0200
Subject: [gdal-dev] test failures on pkgsrc build of 3.3.2rc3
In-Reply-To: <rmibl5cummh.fsf@s1.lexort.com>
References: <rmi5yvkxnvl.fsf@s1.lexort.com>
 <b688e570-3585-e8ec-e74d-577c34452848@spatialys.com>
 <rmibl5cummh.fsf@s1.lexort.com>
Message-ID: <2557bc79-0259-1c81-0a73-cae201c4dd77@spatialys.com>


Le 01/09/2021 ? 21:22, Greg Troxel a ?crit?:
>>> Looking into the avc failure, I find
>>>
>>> $ ogrinfo ogr/data/avc/testavc/testavc/
>>> INFO: Open of `ogr/data/avc/testavc/testavc/'
>>>         using driver `AVCBin' successful.
>>> 1: ARC (Line String)
>>> 2: LAB (Point)
>>>
>>> But if I leave off the trailing / I get a failure to find a driver.  A
>>> trailing slash on a directrory name seems odd to me, and usually the
>>> result of completion.
>> Hum, I suspect you might hit a similar issue as the one for FreeBSD in
>> https://github.com/OSGeo/gdal/blob/a95e796f65b26379b0e5c699bacef29f7684f79f/gdal/gcore/gdalopeninfo.cpp#L216
>> where fopen("/some/dir", "rb") succeeds.
>>
>> Can you test changing that with whatever define is appropriate to test
>> for your OS and submit the resulting patch ?
> The comment about FreeBSD being odd seems strange to me, as POSIX has no
> notion that fopen must fail when opening a directory for reading.
>
>    https://pubs.opengroup.org/onlinepubs/9699919799/functions/fopen.html
>    https://pubs.opengroup.org/onlinepubs/9699919799/functions/open.html
>
> As I read the spec, it is a violation to return NULL when the first
> argument is a directory and the second is r or rb.  A test program
> succeeds in calling fopen on . with rb, on both NetBSD and macOS 10.13.
>
> Perhaps I am misreading the POSIX spec.

It is not clear for me. There's a mention that opening a directory in 
update mode should fail. But I can't see the point of succeeding in 
read-only mode. You can't read anything.

But actually I do see that on my current Linux system too fopen(somedir, 
"rb") works, but later in that function, we try to read some bytes from 
it. If we don't manage to read a single byte, then we fallback

to a stat() to check the nature of the file. So I suspect that on your 
OS and FreeBSD, the fread() does return some bytes, whereas the other OS 
on which we regularly test, return 0.

I guess we might want to change the current test as #if 
!(defined(_WIN32) || defined(__linux__) || defined(__ANDROID__)) so as 
to match all the BSDs, and do the stat() before trying to fopen() the file.

Trying that in https://github.com/OSGeo/gdal/pull/4411

This will be post 3.3.2 material as it is not a new issue.


-- 
http://www.spatialys.com
My software is free, but my time generally not.


From gdt at lexort.com  Wed Sep  1 13:37:08 2021
From: gdt at lexort.com (Greg Troxel)
Date: Wed, 01 Sep 2021 16:37:08 -0400
Subject: [gdal-dev] test failures on pkgsrc build of 3.3.2rc3
In-Reply-To: <2557bc79-0259-1c81-0a73-cae201c4dd77@spatialys.com> (Even
 Rouault's message of "Wed, 1 Sep 2021 21:50:24 +0200")
References: <rmi5yvkxnvl.fsf@s1.lexort.com>
 <b688e570-3585-e8ec-e74d-577c34452848@spatialys.com>
 <rmibl5cummh.fsf@s1.lexort.com>
 <2557bc79-0259-1c81-0a73-cae201c4dd77@spatialys.com>
Message-ID: <rmilf4gt4ln.fsf@s1.lexort.com>


Even Rouault <even.rouault at spatialys.com> writes:

>> As I read the spec, it is a violation to return NULL when the first
>> argument is a directory and the second is r or rb.  A test program
>> succeeds in calling fopen on . with rb, on both NetBSD and macOS 10.13.
>
> It is not clear for me. There's a mention that opening a directory in
> update mode should fail.

Directories are not writable as files, even if they have the w bit.
That's been true since at least Sixth Edition.  To me, that text
prohibiting opening directories for write is clear evidence of intent
not to prohibit opening them for reading.

> But I can't see the point of succeeding in read-only mode. You can't
> read anything.

Directories have names and inode numbers, in some data structure.  There
is something to read -- it's just something that usually one does not
want to do.

I agree that in the modern world trying to read a directory is not
really a sensible thing to do under almost all circumstances.  But it's
a huge leap from that observation to assuming that attempts must fail.

> But actually I do see that on my current Linux system too
> fopen(somedir, "rb") works, but later in that function, we try to read
> some bytes from it. If we don't manage to read a single byte, then we
> fallback to a stat() to check the nature of the file. So I suspect
> that on your OS and FreeBSD, the fread() does return some bytes,
> whereas the other OS on which we regularly test, return 0.

Interesting that this is even more subtle than I thought.  Still, I
don't think POSIX says that fread on a directory can't return bytes.  In
fact I can't find anything in fread or fgetc that allows it to fail on
directories.  I suppose though that a system can define a directory to
have zero bytes of content when viewed as a file.

On NetBSD, bytes are returned, and I see filenames.  The output from
fread matches "od -c .".

> I guess we might want to change the current test as #if
> !(defined(_WIN32) || defined(__linux__) || defined(__ANDROID__)) so as
> to match all the BSDs, and do the stat() before trying to fopen() the
> file.
>
> Trying that in https://github.com/OSGeo/gdal/pull/4411

I don't understand why there should be an explicit list of systems when
the basic issue is code relying on behavior that is not specified by
POSIX.  From a traditional UNIX perspective, I find fread refusing to
read a directory to be strange -- but at the same time it's a reasonable
choice from an abstraction viewpoint.

It seems far safer to just not make assumptions about what fopen/fread
will do, when one can't say a system that doesn't meet the assumptions
is defective.

What's wrong with just always doing the stat?

Or, if it's really important to avoid the stat, put the code that makes
beyond-POSIX assumptions under #ifdef linux.   Then we'd have code that
is in general correct, and avoids a stat on systems known to not return
any bytes on a directory.

> This will be post 3.3.2 material as it is not a new issue.

Sure, that's fine.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210901/cdb72852/attachment.sig>

From even.rouault at spatialys.com  Wed Sep  1 13:53:57 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 1 Sep 2021 22:53:57 +0200
Subject: [gdal-dev] test failures on pkgsrc build of 3.3.2rc3
In-Reply-To: <rmilf4gt4ln.fsf@s1.lexort.com>
References: <rmi5yvkxnvl.fsf@s1.lexort.com>
 <b688e570-3585-e8ec-e74d-577c34452848@spatialys.com>
 <rmibl5cummh.fsf@s1.lexort.com>
 <2557bc79-0259-1c81-0a73-cae201c4dd77@spatialys.com>
 <rmilf4gt4ln.fsf@s1.lexort.com>
Message-ID: <5c642ead-c864-adce-6f12-b7e20d42c355@spatialys.com>


> What's wrong with just always doing the stat?
Nothing, but just one extra system call in a performance critical path.
> Or, if it's really important to avoid the stat, put the code that makes
> beyond-POSIX assumptions under #ifdef linux.   Then we'd have code that
> is in general correct, and avoids a stat on systems known to not return
> any bytes on a directory.
>
I basically whitelisted OSs that are tested by our CI and for which 
fread() on a directory FILE* returns 0 and where we can save the stat() 
when it is a non-empty file, which is the nominal case for most GDAL usage.

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From even.rouault at spatialys.com  Wed Sep  1 23:54:29 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 2 Sep 2021 08:54:29 +0200
Subject: [gdal-dev] Motion: promote GDAL 3.3.2 RC3
Message-ID: <4450042e-e087-214c-0d4e-f1cb197276f6@spatialys.com>

Hi,

Having heard no issues being reported regarding RC3

Motion:

Adopt GDAL 3.3.2 RC3 as final 3.3.2 release

Starting with my +1

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From jukka.rahkonen at maanmittauslaitos.fi  Thu Sep  2 00:50:51 2021
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Thu, 2 Sep 2021 07:50:51 +0000
Subject: [gdal-dev] Re  Motion: promote GDAL 3.3.2 RC3
Message-ID: <b18eae07a47741c7a01f6f5c6eb4ac70@maanmittauslaitos.fi>

+1

-Jukka Rahkonen-

-----Alkuper?inen viesti-----
L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Even Rouault
L?hetetty: torstai 2. syyskuuta 2021 9.54
Vastaanottaja: gdal-dev at lists.osgeo.org
Aihe: [gdal-dev] Motion: promote GDAL 3.3.2 RC3

Hi,

Having heard no issues being reported regarding RC3

Motion:

Adopt GDAL 3.3.2 RC3 as final 3.3.2 release

Starting with my +1

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev

From howard at hobu.co  Thu Sep  2 05:19:26 2021
From: howard at hobu.co (Howard Butler)
Date: Thu, 2 Sep 2021 07:19:26 -0500
Subject: [gdal-dev] Motion: promote GDAL 3.3.2 RC3
In-Reply-To: <4450042e-e087-214c-0d4e-f1cb197276f6@spatialys.com>
References: <4450042e-e087-214c-0d4e-f1cb197276f6@spatialys.com>
Message-ID: <FE4CD8C3-B39A-4E7C-9267-89EF893318F7@hobu.co>



> On Sep 2, 2021, at 1:54 AM, Even Rouault <even.rouault at spatialys.com> wrote:
> 
> Hi,
> 
> Having heard no issues being reported regarding RC3
> 
> Motion:
> 
> Adopt GDAL 3.3.2 RC3 as final 3.3.2 release
> 
> Starting with my +1

+1

Howard

From sean at mapbox.com  Thu Sep  2 08:19:00 2021
From: sean at mapbox.com (Sean Gillies)
Date: Thu, 2 Sep 2021 09:19:00 -0600
Subject: [gdal-dev] Motion: promote GDAL 3.3.2 RC3
In-Reply-To: <CADPhZXwPDUfJLAX=U5LryqLSAtkXTBK+ERcShgtnCP=Od0hiLg@mail.gmail.com>
References: <4450042e-e087-214c-0d4e-f1cb197276f6@spatialys.com>
 <CADPhZXwPDUfJLAX=U5LryqLSAtkXTBK+ERcShgtnCP=Od0hiLg@mail.gmail.com>
Message-ID: <CADPhZXyVERY27=eSXaQ75MxXEY+9jw01CchSsxx+bG2OyTQUPQ@mail.gmail.com>

Oops, forgot to reply to the list. Also, to be more specific, could we hold
3.3.2 until Monday, September 6?

On Thu, Sep 2, 2021 at 9:10 AM Sean Gillies <sean at mapbox.com> wrote:

> I wish I'd noticed the change around EPSG:4326 sooner. I didn't see a
> particular announcement, but the breakage was obvious in rasterio's CI
> builds with GDAL master and I should have been watching more closely.
>
> If people update GDAL to 3.3.2 they may break their applications that use
> rasterio. We'll probably be able to get a new version out by the end of the
> week or beginning of next week. Could we hold the release a few more days?
>
> On Thu, Sep 2, 2021 at 12:54 AM Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> Hi,
>>
>> Having heard no issues being reported regarding RC3
>>
>> Motion:
>>
>> Adopt GDAL 3.3.2 RC3 as final 3.3.2 release
>>
>> Starting with my +1
>>
>> Even
>>
>
> --
> Sean Gillies
>


-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210902/cb9a35b1/attachment.html>

From even.rouault at spatialys.com  Thu Sep  2 08:21:04 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 2 Sep 2021 17:21:04 +0200
Subject: [gdal-dev] Motion: promote GDAL 3.3.2 RC3
In-Reply-To: <CADPhZXyVERY27=eSXaQ75MxXEY+9jw01CchSsxx+bG2OyTQUPQ@mail.gmail.com>
References: <4450042e-e087-214c-0d4e-f1cb197276f6@spatialys.com>
 <CADPhZXwPDUfJLAX=U5LryqLSAtkXTBK+ERcShgtnCP=Od0hiLg@mail.gmail.com>
 <CADPhZXyVERY27=eSXaQ75MxXEY+9jw01CchSsxx+bG2OyTQUPQ@mail.gmail.com>
Message-ID: <9fba6d4a-3738-04c8-f6ff-1d26560b0845@spatialys.com>

Hi Sean,

sure we can delay a bit the release of the final tarballs. Anyway as we 
have the minimum 2 business day rule to pass a motion, this won't be 
before Monday. Those issues with axis order seem to be a never ending 
source of annoyance. Were existing before I got into the geo-business 
and will probably be still there when I retire...

I didn't anticipate that change to break rasterio, although those type 
of changes tend to have tricky consequences, but at the same time having 
AutoIdentifyEPSG() putting EPSG:4326 on a CRS with "wrong" axis order 
caused other issues.

Even


Le 02/09/2021 ? 17:19, Sean Gillies a ?crit?:
> Oops, forgot to reply to the list. Also, to be more specific, could we 
> hold 3.3.2 until Monday, September 6?
>
> On Thu, Sep 2, 2021 at 9:10 AM Sean Gillies <sean at mapbox.com 
> <mailto:sean at mapbox.com>> wrote:
>
>     I wish I'd noticed the change around EPSG:4326 sooner. I didn't
>     see a particular announcement, but the breakage was obvious in
>     rasterio's CI builds with?GDAL master and I should have been
>     watching more closely.
>
>     If people update GDAL to 3.3.2 they may break their applications
>     that use rasterio. We'll probably be able to get a new version out
>     by the end of the week or beginning of next week. Could we hold
>     the release a few more days?
>
>     On Thu, Sep 2, 2021 at 12:54 AM Even Rouault
>     <even.rouault at spatialys.com <mailto:even.rouault at spatialys.com>>
>     wrote:
>
>         Hi,
>
>         Having heard no issues being reported regarding RC3
>
>         Motion:
>
>         Adopt GDAL 3.3.2 RC3 as final 3.3.2 release
>
>         Starting with my +1
>
>         Even
>
>
>     -- 
>     Sean Gillies
>
>
>
> -- 
> Sean Gillies

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210902/9d3762e7/attachment.html>

From szekerest at gmail.com  Thu Sep  2 09:00:58 2021
From: szekerest at gmail.com (Tamas Szekeres)
Date: Thu, 2 Sep 2021 18:00:58 +0200
Subject: [gdal-dev] Motion: promote GDAL 3.3.2 RC3
In-Reply-To: <4450042e-e087-214c-0d4e-f1cb197276f6@spatialys.com>
References: <4450042e-e087-214c-0d4e-f1cb197276f6@spatialys.com>
Message-ID: <9FCE155A-EB1E-437D-9809-217481E1F7E1@gmail.com>

+1

Tamas

Sent from my iPhone

> 2021. szept. 2. d?tummal, 8:56 id?pontban Even Rouault <even.rouault at spatialys.com> ?rta:
> 
> ?Hi,
> 
> Having heard no issues being reported regarding RC3
> 
> Motion:
> 
> Adopt GDAL 3.3.2 RC3 as final 3.3.2 release
> 
> Starting with my +1
> 
> Even
> 
> -- 
> http://www.spatialys.com
> My software is free, but my time generally not.
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From gdt at lexort.com  Thu Sep  2 09:30:20 2021
From: gdt at lexort.com (Greg Troxel)
Date: Thu, 02 Sep 2021 12:30:20 -0400
Subject: [gdal-dev] test failures on pkgsrc build of 3.3.2rc3
In-Reply-To: <5c642ead-c864-adce-6f12-b7e20d42c355@spatialys.com> (Even
 Rouault's message of "Wed, 1 Sep 2021 22:53:57 +0200")
References: <rmi5yvkxnvl.fsf@s1.lexort.com>
 <b688e570-3585-e8ec-e74d-577c34452848@spatialys.com>
 <rmibl5cummh.fsf@s1.lexort.com>
 <2557bc79-0259-1c81-0a73-cae201c4dd77@spatialys.com>
 <rmilf4gt4ln.fsf@s1.lexort.com>
 <5c642ead-c864-adce-6f12-b7e20d42c355@spatialys.com>
Message-ID: <rmir1e7lz37.fsf@s1.lexort.com>


Even Rouault <even.rouault at spatialys.com> writes:

>> What's wrong with just always doing the stat?
> Nothing, but just one extra system call in a performance critical path.

OK - but do you really think that in an entire sequence of
fopen/fread/prcoess-data that one more stat (which will be cached w.r.t
the inode read in open) is going to even be measurable?  (No, I haven't
benchmarked it either.)   But I'm not the one maintaining the more
complicated code...

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210902/10fc7144/attachment.sig>

From dmorissette at mapgears.com  Thu Sep  2 09:58:01 2021
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Thu, 2 Sep 2021 12:58:01 -0400
Subject: [gdal-dev] Motion: promote GDAL 3.3.2 RC3
In-Reply-To: <4450042e-e087-214c-0d4e-f1cb197276f6@spatialys.com>
References: <4450042e-e087-214c-0d4e-f1cb197276f6@spatialys.com>
Message-ID: <0dfdeddf-4dae-75d5-e7a6-3be6efed5b82@mapgears.com>

+1

Daniel


On 2021-09-02 02:54, Even Rouault wrote:
> Hi,
> 
> Having heard no issues being reported regarding RC3
> 
> Motion:
> 
> Adopt GDAL 3.3.2 RC3 as final 3.3.2 release
> 
> Starting with my +1
> 
> Even
> 


-- 
Daniel Morissette
Mapgears Inc
T: +1 418-696-5056 #201

From momtchil at momtchev.com  Thu Sep  2 10:18:16 2021
From: momtchil at momtchev.com (Momtchil Momtchev)
Date: Thu, 2 Sep 2021 19:18:16 +0200
Subject: [gdal-dev] Motion: promote GDAL 3.3.2 RC3
In-Reply-To: <4450042e-e087-214c-0d4e-f1cb197276f6@spatialys.com>
References: <4450042e-e087-214c-0d4e-f1cb197276f6@spatialys.com>
Message-ID: <94046d14-0168-7eb1-a39a-ec5187e2ded6@momtchev.com>


 ??? +1 from Node.js

 ??? (fixed an issue with a few unit tests for AutoIdentifyEPSG)


On 02/09/2021 08:54, Even Rouault wrote:
> Hi,
>
> Having heard no issues being reported regarding RC3
>
> Motion:
>
> Adopt GDAL 3.3.2 RC3 as final 3.3.2 release
>
> Starting with my +1
>
> Even
>
-- 
Momtchil Momtchev <momtchil at momtchev.com>


From hghklly at gmail.com  Thu Sep  2 10:30:02 2021
From: hghklly at gmail.com (Hugh Kelley)
Date: Thu, 2 Sep 2021 13:30:02 -0400
Subject: [gdal-dev] read ESRIJSON with ogr2ogr
Message-ID: <CAOrcXHFT2=oSi27AWadmQ35Ruvm8aOaXxU4kTqALbbxG+q3JiQ@mail.gmail.com>

Hi all,

I'd like to load some data directly from an arcgis REST feature service
using ogr2ogr.

The command that follows collects exactly 5000 features, which i assume is
the server limit mentioned in the ESRIJSON driver documentation

 ogr2ogr "streets.shp" ESRIJSON:"
https://services1.arcgis.com/dLpFH5mwVvxSN4OE/arcgis/rest/services/Street_Centerlines/FeatureServer/0/query?where=objectid+%3D+objectid&outfields=*&f=json&orderByFields=OBJECTID+ASC"
-overwrite -oo FEATURE_SERVER_PAGING=YES

Reading the documentation though, it sounds as though ogr2ogr should be
paging through the feature service to collect the full set of features,
which ogrinfo says number 10,954.  Setting resultOffeset parameter to 5000
results in a new set of 5000 features. I have a lot of feature services to
pull data from though so I'd like to be able to set ogr2ogr to page through
the full feature set for each service rather than calculating the offsets
and running multiple queries each time.

Thanks for any suggestions.

As a note, in case it makes a difference, I'm using shp here for simplicity
but the actual destination will be a postgres db.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210902/b917f3fd/attachment-0001.html>

From even.rouault at spatialys.com  Thu Sep  2 11:12:43 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 2 Sep 2021 20:12:43 +0200
Subject: [gdal-dev] read ESRIJSON with ogr2ogr
In-Reply-To: <CAOrcXHFT2=oSi27AWadmQ35Ruvm8aOaXxU4kTqALbbxG+q3JiQ@mail.gmail.com>
References: <CAOrcXHFT2=oSi27AWadmQ35Ruvm8aOaXxU4kTqALbbxG+q3JiQ@mail.gmail.com>
Message-ID: <3afb2cdd-3502-19cd-c6e8-757c210dac09@spatialys.com>

Hugh,

I've queued in https://github.com/OSGeo/gdal/pull/4418 a fix for that.

But there's a simple workaround. Just remove the ESRIJSON: prefix in the 
connection string. In that instance, the driver will be automatically 
detected

Even

Le 02/09/2021 ? 19:30, Hugh Kelley a ?crit?:
> Hi all,
>
> I'd like to load some data directly from an arcgis REST feature 
> service using ogr2ogr.
>
> The command that follows collects exactly 5000 features, which i 
> assume is the server limit mentioned in the ESRIJSON driver documentation
>
> ?ogr2ogr "streets.shp" 
> ESRIJSON:"https://services1.arcgis.com/dLpFH5mwVvxSN4OE/arcgis/rest/services/Street_Centerlines/FeatureServer/0/query?where=objectid+%3D+objectid&outfields=*&f=json&orderByFields=OBJECTID+ASC 
> <https://services1.arcgis.com/dLpFH5mwVvxSN4OE/arcgis/rest/services/Street_Centerlines/FeatureServer/0/query?where=objectid+%3D+objectid&outfields=*&f=json&orderByFields=OBJECTID+ASC>" 
> -overwrite -oo FEATURE_SERVER_PAGING=YES
>
> Reading the documentation though, it sounds as though ogr2ogr should 
> be paging through the feature service to collect the full set of 
> features, which ogrinfo says number 10,954.? Setting resultOffeset 
> parameter to 5000 results in a new set of 5000 features. I have a lot 
> of feature services to pull data from though so I'd like to be able to 
> set ogr2ogr to page through the full feature set for each service 
> rather than calculating the offsets and running multiple queries each 
> time.
>
> Thanks for any suggestions.
>
> As a note, in case it makes a difference, I'm using shp here for 
> simplicity but the actual destination will be a postgres db.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210902/b17f1bf2/attachment.html>

From hghklly at gmail.com  Thu Sep  2 11:28:13 2021
From: hghklly at gmail.com (Hugh Kelley)
Date: Thu, 2 Sep 2021 14:28:13 -0400
Subject: [gdal-dev] read ESRIJSON with ogr2ogr
In-Reply-To: <3afb2cdd-3502-19cd-c6e8-757c210dac09@spatialys.com>
References: <CAOrcXHFT2=oSi27AWadmQ35Ruvm8aOaXxU4kTqALbbxG+q3JiQ@mail.gmail.com>
 <3afb2cdd-3502-19cd-c6e8-757c210dac09@spatialys.com>
Message-ID: <CAOrcXHE-XK-Cz8ZZg-wntJeCpRBTNFErY3MJrkArA0P1F3NMrQ@mail.gmail.com>

worked like a charm, thanks very much!

On Thu, Sep 2, 2021 at 2:13 PM Even Rouault <even.rouault at spatialys.com>
wrote:

> Hugh,
>
> I've queued in https://github.com/OSGeo/gdal/pull/4418 a fix for that.
>
> But there's a simple workaround. Just remove the ESRIJSON: prefix in the
> connection string. In that instance, the driver will be automatically
> detected
>
> Even
> Le 02/09/2021 ? 19:30, Hugh Kelley a ?crit :
>
> Hi all,
>
> I'd like to load some data directly from an arcgis REST feature service
> using ogr2ogr.
>
> The command that follows collects exactly 5000 features, which i assume is
> the server limit mentioned in the ESRIJSON driver documentation
>
>  ogr2ogr "streets.shp" ESRIJSON:"
> https://services1.arcgis.com/dLpFH5mwVvxSN4OE/arcgis/rest/services/Street_Centerlines/FeatureServer/0/query?where=objectid+%3D+objectid&outfields=*&f=json&orderByFields=OBJECTID+ASC"
> -overwrite -oo FEATURE_SERVER_PAGING=YES
>
> Reading the documentation though, it sounds as though ogr2ogr should be
> paging through the feature service to collect the full set of features,
> which ogrinfo says number 10,954.  Setting resultOffeset parameter to 5000
> results in a new set of 5000 features. I have a lot of feature services to
> pull data from though so I'd like to be able to set ogr2ogr to page through
> the full feature set for each service rather than calculating the offsets
> and running multiple queries each time.
>
> Thanks for any suggestions.
>
> As a note, in case it makes a difference, I'm using shp here for
> simplicity but the actual destination will be a postgres db.
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
Hugh Kelley
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210902/1f68cef2/attachment.html>

From kbmeinstein at rothwellgroup.com  Thu Sep  2 13:03:10 2021
From: kbmeinstein at rothwellgroup.com (Karen M)
Date: Thu, 2 Sep 2021 14:03:10 -0600
Subject: [gdal-dev] XY Tolerance = 0 when creating layer in region settings
 with comma decimal separator
Message-ID: <CAJTCXAs7SVyt0mR7e3tnvXJD8-8X45K30NKi9P0o8GONRuCXHg@mail.gmail.com>

Hi All,

I'm using the C# bindings in gdal version
release-1900-x64-gdal-2-4-3-mapserver-7-4-2.  When the operating system
region settings are set to regions that uses a comma as the decimal
separator and I use datasource.CreateLayer() to create a new file
geodatabase layer, the resulting feature class has XY Tolerance = 0 when I
use the layer in ArcGIS Pro.  When I use a region that uses decimal points,
the XY Tolerance is non-zero (which is correct).

I've tried using the option "XYTOLERANCE=0.000000008983153" in
CreateLayer(), but I still get XY Tolerance = 0.  This is causing some
editing problems in ArcGIS Pro, and I need the software to work with
various region settings, not just ones that use decimal points.  Anyone
have any suggestions how to fix this?

Thanks,

*Karen Meinstein*
Product Support
kbmeinstein at rothwellgroup.com | 303-261-8107 x 15

<http://www.rothwellgroup.com/>[image: The Rothwell Group, L.P.]
<http://www.rothwellgroup.com/>

RothwellGroup.com <http://rothwellgroup.com/> | PaleoGIS.com
<http://paleogis.com/> | BizRun.com <http://www.bizrun.com/>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210902/e1ddcf24/attachment.html>

From even.rouault at spatialys.com  Thu Sep  2 13:57:09 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 2 Sep 2021 22:57:09 +0200
Subject: [gdal-dev] XY Tolerance = 0 when creating layer in region
 settings with comma decimal separator
In-Reply-To: <CAJTCXAs7SVyt0mR7e3tnvXJD8-8X45K30NKi9P0o8GONRuCXHg@mail.gmail.com>
References: <CAJTCXAs7SVyt0mR7e3tnvXJD8-8X45K30NKi9P0o8GONRuCXHg@mail.gmail.com>
Message-ID: <a6c20089-1f57-98cc-3daa-d959cdad1be1@spatialys.com>

Karen,

I've done some experiments on Linux, by forcing the locale of the 
process to a locale with comma as decimal separator and I can't 
reproduce an issue. What I see in the code is that we pass the tolerance 
as a string to the binary FileGDB SDK, but there's clearly at least 
validation from it of numeric values. Although I can see that passing 
XYTOLERANCE=1.23 or 1.230 results in different things in the XML, so it 
doesn't seem that it is rewritten. So I'm not sure what happens. It 
might behave differently on Windows, but hard to say what happens as we 
don't have the sources. Perhaps you have a way of programmatically 
changing the locale (or equivalent concept) in your code, at least 
temporarily, to force dot as decimal separator ?

Even

Le 02/09/2021 ? 22:03, Karen M via gdal-dev a ?crit?:
> Hi All,
>
> I'm using the C# bindings in gdal version 
> release-1900-x64-gdal-2-4-3-mapserver-7-4-2.? When the operating 
> system region settings are set to regions that uses a comma as the 
> decimal separator and?I use datasource.CreateLayer() to create a new 
> file geodatabase layer, the resulting feature class has XY Tolerance = 
> 0 when I use the layer in ArcGIS Pro.? When I use a region that uses 
> decimal points, the XY Tolerance is non-zero (which is correct).
>
> I've tried using the option?"XYTOLERANCE=0.000000008983153" in 
> CreateLayer(), but I still get XY Tolerance = 0.? This is causing some 
> editing problems in ArcGIS Pro, and I need the software to work with 
> various region settings, not just ones that use decimal points.? 
> Anyone have any suggestions how to fix this?
>
> Thanks,
>
> *Karen?Meinstein*
> Product Support
> kbmeinstein at rothwellgroup.com <mailto:kbmeinstein at rothwellgroup.com>?| 
> 303-261-8107 x 15
>
> The Rothwell Group, L.P. <http://www.rothwellgroup.com/>
>
> RothwellGroup.com <http://rothwellgroup.com/>?| PaleoGIS.com 
> <http://paleogis.com/>?| BizRun.com <http://www.bizrun.com/>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210902/a7fc3dee/attachment.html>

From andrew at aitchison.me.uk  Fri Sep  3 00:06:53 2021
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Fri, 3 Sep 2021 08:06:53 +0100 (BST)
Subject: [gdal-dev] XY Tolerance = 0 when creating layer in region
 settings with comma decimal separator
In-Reply-To: <CAJTCXAs7SVyt0mR7e3tnvXJD8-8X45K30NKi9P0o8GONRuCXHg@mail.gmail.com>
References: <CAJTCXAs7SVyt0mR7e3tnvXJD8-8X45K30NKi9P0o8GONRuCXHg@mail.gmail.com>
Message-ID: <879f27e3-ea3-1dae-7184-6ee453350eb@aitchison.me.uk>

On Thu, 2 Sep 2021, Karen M via gdal-dev wrote:

> Hi All,
>
> I'm using the C# bindings in gdal version
> release-1900-x64-gdal-2-4-3-mapserver-7-4-2.  When the operating system
> region settings are set to regions that uses a comma as the decimal
> separator and I use datasource.CreateLayer() to create a new file
> geodatabase layer, the resulting feature class has XY Tolerance = 0 when I
> use the layer in ArcGIS Pro.  When I use a region that uses decimal points,
> the XY Tolerance is non-zero (which is correct).
>
> I've tried using the option "XYTOLERANCE=0.000000008983153" in
> CreateLayer(), but I still get XY Tolerance = 0.

Stupid suggestions; have you tried
   XYTOLERANCE=0,000000008983153
   XYTOLERANCE=8,983153e-10
or
   XYTOLERANCE=8983153e-16
(please double check the values 10 and 16) ?

-- 
Andrew C. Aitchison					Kendal, UK
 			andrew at aitchison.me.uk

From gdt at lexort.com  Fri Sep  3 06:49:13 2021
From: gdt at lexort.com (Greg Troxel)
Date: Fri, 03 Sep 2021 09:49:13 -0400
Subject: [gdal-dev] test failures on pkgsrc build of 3.3.2rc3
In-Reply-To: <b688e570-3585-e8ec-e74d-577c34452848@spatialys.com> (Even
 Rouault's message of "Wed, 1 Sep 2021 18:46:16 +0200")
References: <rmi5yvkxnvl.fsf@s1.lexort.com>
 <b688e570-3585-e8ec-e74d-577c34452848@spatialys.com>
Message-ID: <rmiy28dhiqu.fsf@s1.lexort.com>


Thanks for all the hints so far about tests.  With the fopen/fread fix
(locally applied to 3.3.2rc3), and rtree added in to sqlite3 (which I'm
calling a bug in my world), I am down to:

FAILED ogr/ogr_gmt.py::test_ogr_gmt_2 - AssertionError: assert 1 == 0
FAILED gcore/cog.py::test_cog_small_world_to_web_mercator - assert [26228, 22...
FAILED gdrivers/aigrid.py::test_aigrid_broken - FileExistsError: [Errno 17] F...
FAILED gdrivers/eedai.py::test_eedai_GOOGLE_APPLICATION_CREDENTIALS - assert ...
FAILED osr/osr_metacrs.py::TestMetaCRS::test_metacrs[WGS84 Geogrpahic 2D to CSPC Z3 USFT NAD83]
FAILED alg/warp.py::test_warp_53[cubic-generalCase-Byte] - assert 3965 in [39...
FAILED alg/warp.py::test_warp_53[cubic-generalCase-UInt16] - assert 3965 in [...
FAILED alg/warp.py::test_warp_53[cubic-generalCase-Int16] - assert 3965 in [3...
FAILED alg/warp.py::test_warp_53[cubic-default-Byte] - assert 3965 in [3942, ...
FAILED alg/warp.py::test_warp_53[cubic-default-UInt16] - assert 3965 in [3942...
FAILED alg/warp.py::test_warp_53[cubic-default-Int16] - assert 3965 in [3942,...
FAILED utilities/test_gdalwarp.py::test_gdalwarp_15 - AssertionError: Bad che...
= 12 failed, 7249 passed, 1479 skipped, 2 xfailed, 2 warnings in 713.86s (0:11:53) =

And now, the ogr_mitab test passes without crashing.  So there's
probably some error checking missing someplace and I'm no longer hitting
the case that triggers it.

Full log (minus ogr_mitab):

  http://www.lexort.com/GDAL/gdal-tests.no-mitab.txt

if anybody wants to look a it.

I will start to dig through these, but it smells like the warp ones are
the same problem, and this is now down to a non-scary number.  A few may
be due to proj 6.3.2 (with grids installed), but I haven't figured that
out yet.

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210903/e17e9e18/attachment.sig>

From even.rouault at spatialys.com  Fri Sep  3 08:07:43 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 3 Sep 2021 17:07:43 +0200
Subject: [gdal-dev] test failures on pkgsrc build of 3.3.2rc3
In-Reply-To: <rmiy28dhiqu.fsf@s1.lexort.com>
References: <rmi5yvkxnvl.fsf@s1.lexort.com>
 <b688e570-3585-e8ec-e74d-577c34452848@spatialys.com>
 <rmiy28dhiqu.fsf@s1.lexort.com>
Message-ID: <098cdff1-7a59-2357-6efb-b6ac7f66838b@spatialys.com>

Greg,
> FAILED ogr/ogr_gmt.py::test_ogr_gmt_2 - AssertionError: assert 1 == 0
Hopefully https://github.com/OSGeo/gdal/pull/4424 might help
> FAILED gcore/cog.py::test_cog_small_world_to_web_mercator - assert [26228, 22...
Was fixed in master 3.4.0 dev per 
https://github.com/OSGeo/gdal/commit/7816b68130cc7a79e5477a47dc6eb0227f2ae47d
> FAILED gdrivers/aigrid.py::test_aigrid_broken - FileExistsError: [Errno 17] F...
Probably result of a previous failure in that test. Hopefully 
https://github.com/OSGeo/gdal/pull/4424 might help
> FAILED gdrivers/eedai.py::test_eedai_GOOGLE_APPLICATION_CREDENTIALS - assert ...
Not sure what happens here. Probably some harden configuration of 
openssl that rejects the private key ? Apparently it fails on Mac too 
from 
https://github.com/OSGeo/gdal/commit/7816b68130cc7a79e5477a47dc6eb0227f2ae47d 

> FAILED alg/warp.py::test_warp_53[cubic-generalCase-Byte] - assert 3965 in [39...
> FAILED alg/warp.py::test_warp_53[cubic-generalCase-UInt16] - assert 3965 in [...
> FAILED alg/warp.py::test_warp_53[cubic-generalCase-Int16] - assert 3965 in [3...
> FAILED alg/warp.py::test_warp_53[cubic-default-Byte] - assert 3965 in [3942, ...
> FAILED alg/warp.py::test_warp_53[cubic-default-UInt16] - assert 3965 in [3942...
> FAILED alg/warp.py::test_warp_53[cubic-default-Int16] - assert 3965 in [3942,...
There's NAD27 to WGS 84 involved. Actually I see I get your results when 
the HPGN grids are installed (compared to having only 
proj-datumgrid-1.8). I've rewritten the tests to be PROJ independent in 
https://github.com/OSGeo/gdal/pull/4424
> FAILED utilities/test_gdalwarp.py::test_gdalwarp_15 - AssertionError: Bad che...
> = 12 failed, 7249 passed, 1479 skipped, 2 xfailed, 2 warnings in 713.86s (0:11:53) =

Same issue with HPGN grids. PR 4424 updated to remove that test as 
redundant with another one


> FAILED osr/osr_metacrs.py::TestMetaCRS::test_metacrs[WGS84 Geogrpahic 2D to CSPC Z3 USFT NAD83]
Also I can see this is still related to the HPGN grids. I've completely 
removed that test in the PR as it tests more PROJ behaviour than GDAL one

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From kbmeinstein at rothwellgroup.com  Fri Sep  3 08:55:17 2021
From: kbmeinstein at rothwellgroup.com (Karen M)
Date: Fri, 3 Sep 2021 09:55:17 -0600
Subject: [gdal-dev] XY Tolerance = 0 when creating layer in region
 settings with comma decimal separator
In-Reply-To: <879f27e3-ea3-1dae-7184-6ee453350eb@aitchison.me.uk>
References: <CAJTCXAs7SVyt0mR7e3tnvXJD8-8X45K30NKi9P0o8GONRuCXHg@mail.gmail.com>
 <879f27e3-ea3-1dae-7184-6ee453350eb@aitchison.me.uk>
Message-ID: <CAJTCXAvPRkiaass4j=WvJ7rPdG1jYazG77o-jncxZkbrRvu5pQ@mail.gmail.com>

Hi Andrew,

That's brilliant (not stupid at all)!  Option 3 ( XYTOLERANCE=8983153e-16)
worked!!!!  Thank you so much!  I had already tried option 1 (using a
comma), but that threw an error, and it never occurred to me to try
scientific notation.  Thank you, thank you, thank you!

Karen

*Karen Meinstein*
Product Support
kbmeinstein at rothwellgroup.com | 303-261-8107 x 15

<http://www.rothwellgroup.com/>[image: The Rothwell Group, L.P.]
<http://www.rothwellgroup.com/>

RothwellGroup.com <http://rothwellgroup.com> | PaleoGIS.com
<http://paleogis.com> | BizRun.com <http://www.bizrun.com/>


On Fri, Sep 3, 2021 at 1:07 AM Andrew C Aitchison <andrew at aitchison.me.uk>
wrote:

> On Thu, 2 Sep 2021, Karen M via gdal-dev wrote:
>
> > Hi All,
> >
> > I'm using the C# bindings in gdal version
> > release-1900-x64-gdal-2-4-3-mapserver-7-4-2.  When the operating system
> > region settings are set to regions that uses a comma as the decimal
> > separator and I use datasource.CreateLayer() to create a new file
> > geodatabase layer, the resulting feature class has XY Tolerance = 0 when
> I
> > use the layer in ArcGIS Pro.  When I use a region that uses decimal
> points,
> > the XY Tolerance is non-zero (which is correct).
> >
> > I've tried using the option "XYTOLERANCE=0.000000008983153" in
> > CreateLayer(), but I still get XY Tolerance = 0.
>
> Stupid suggestions; have you tried
>    XYTOLERANCE=0,000000008983153
>    XYTOLERANCE=8,983153e-10
> or
>    XYTOLERANCE=8983153e-16
> (please double check the values 10 and 16) ?
>
> --
> Andrew C. Aitchison                                     Kendal, UK
>                         andrew at aitchison.me.uk
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210903/c60adf9e/attachment-0001.html>

From j1 at jimenezshaw.com  Fri Sep  3 09:39:52 2021
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Fri, 3 Sep 2021 18:39:52 +0200
Subject: [gdal-dev] XY Tolerance = 0 when creating layer in region
 settings with comma decimal separator
In-Reply-To: <CAJTCXAvPRkiaass4j=WvJ7rPdG1jYazG77o-jncxZkbrRvu5pQ@mail.gmail.com>
References: <CAJTCXAs7SVyt0mR7e3tnvXJD8-8X45K30NKi9P0o8GONRuCXHg@mail.gmail.com>
 <879f27e3-ea3-1dae-7184-6ee453350eb@aitchison.me.uk>
 <CAJTCXAvPRkiaass4j=WvJ7rPdG1jYazG77o-jncxZkbrRvu5pQ@mail.gmail.com>
Message-ID: <CADRrdKsgqWAHy1b0jJPA2_4=NxLHq3gy+tM09+H=Z=EdQews4w@mail.gmail.com>

As Andrew suggested, I guess the proper value is 8983153e-15
.___ ._ ..._ .. . ._.  .___ .. __ . _. . __..  ... .... ._ .__
Entre dos pensamientos racionales
hay infinitos pensamientos irracionales.



On Fri, 3 Sept 2021 at 17:55, Karen M via gdal-dev <gdal-dev at lists.osgeo.org>
wrote:

> Hi Andrew,
>
> That's brilliant (not stupid at all)!  Option 3 ( XYTOLERANCE=8983153e-16)
> worked!!!!  Thank you so much!  I had already tried option 1 (using a
> comma), but that threw an error, and it never occurred to me to try
> scientific notation.  Thank you, thank you, thank you!
>
> Karen
>
> *Karen Meinstein*
> Product Support
> kbmeinstein at rothwellgroup.com | 303-261-8107 x 15
>
> <http://www.rothwellgroup.com/>[image: The Rothwell Group, L.P.]
> <http://www.rothwellgroup.com/>
>
> RothwellGroup.com <http://rothwellgroup.com> | PaleoGIS.com
> <http://paleogis.com> | BizRun.com <http://www.bizrun.com/>
>
>
> On Fri, Sep 3, 2021 at 1:07 AM Andrew C Aitchison <andrew at aitchison.me.uk>
> wrote:
>
>> On Thu, 2 Sep 2021, Karen M via gdal-dev wrote:
>>
>> > Hi All,
>> >
>> > I'm using the C# bindings in gdal version
>> > release-1900-x64-gdal-2-4-3-mapserver-7-4-2.  When the operating system
>> > region settings are set to regions that uses a comma as the decimal
>> > separator and I use datasource.CreateLayer() to create a new file
>> > geodatabase layer, the resulting feature class has XY Tolerance = 0
>> when I
>> > use the layer in ArcGIS Pro.  When I use a region that uses decimal
>> points,
>> > the XY Tolerance is non-zero (which is correct).
>> >
>> > I've tried using the option "XYTOLERANCE=0.000000008983153" in
>> > CreateLayer(), but I still get XY Tolerance = 0.
>>
>> Stupid suggestions; have you tried
>>    XYTOLERANCE=0,000000008983153
>>    XYTOLERANCE=8,983153e-10
>> or
>>    XYTOLERANCE=8983153e-16
>> (please double check the values 10 and 16) ?
>>
>> --
>> Andrew C. Aitchison                                     Kendal, UK
>>                         andrew at aitchison.me.uk
>>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210903/81db4c16/attachment.html>

From gdt at lexort.com  Fri Sep  3 17:28:08 2021
From: gdt at lexort.com (Greg Troxel)
Date: Fri, 03 Sep 2021 20:28:08 -0400
Subject: [gdal-dev] test failures on pkgsrc build of 3.3.2rc3
In-Reply-To: <098cdff1-7a59-2357-6efb-b6ac7f66838b@spatialys.com> (Even
 Rouault's message of "Fri, 3 Sep 2021 17:07:43 +0200")
References: <rmi5yvkxnvl.fsf@s1.lexort.com>
 <b688e570-3585-e8ec-e74d-577c34452848@spatialys.com>
 <rmiy28dhiqu.fsf@s1.lexort.com>
 <098cdff1-7a59-2357-6efb-b6ac7f66838b@spatialys.com>
Message-ID: <rmieea5dw13.fsf@s1.lexort.com>


Even Rouault <even.rouault at spatialys.com> writes:

>> FAILED gdrivers/eedai.py::test_eedai_GOOGLE_APPLICATION_CREDENTIALS - assert ...
> Not sure what happens here. Probably some harden configuration of
> openssl that rejects the private key ? Apparently it fails on Mac too
> from
> https://github.com/OSGeo/gdal/commit/7816b68130cc7a79e5477a47dc6eb0227f2ae47d 

This is pure speculation, but I see in the code:

   gdal.FileFromMemBuffer('/vsimem/my.json', """{
      "private_key":"-----BEGIN PRIVATE KEY-----

an I wonder if this file (in some VFS?) has an associated mode?  I would
sort of expect openssl to error if the private key file were readable by
group or other, and I don't understand this filefromstring big.  (I get
the concept; I just have no idea how it works.)

This may or may not be a more detailed run log:


============================= test session starts ==============================
platform netbsd9 -- Python 3.8.11, pytest-6.2.4, py-1.10.0, pluggy-0.13.1
rootdir: /home/n0/gdt/SOFTWARE/GEO/GDAL/gdal/autotest, configfile: pytest.ini
plugins: sugar-0.9.4, env-0.6.2
collected 9 items

gdrivers/eedai.py ...Fs...s                                              [100%]

=================================== FAILURES ===================================
__________________ test_eedai_GOOGLE_APPLICATION_CREDENTIALS ___________________

    def test_eedai_GOOGLE_APPLICATION_CREDENTIALS():
    
        if gdaltest.eedai_drv is None:
            pytest.skip()
    
        gdal.FileFromMemBuffer('/vsimem/my.json', """{
    "private_key":"-----BEGIN PRIVATE KEY-----
    MIICeAIBADANBgkqhkiG9w0BAQEFAASCAmIwggJeAgEAAoGBAOlwJQLLDG1HeLrk\n
    VNcFR5Qptto/rJE5emRuy0YmkVINT4uHb1be7OOo44C2Ev8QPVtNHHS2XwCY5gTm\n
    i2RfIBLv+VDMoVQPqqE0LHb0WeqGmM5V1tHbmVnIkCcKMn3HpK30grccuBc472LQ\n
    DVkkGqIiGu0qLAQ89JP/r0LWWySRAgMBAAECgYAWjsS00WRBByAOh1P/dz4kfidy\n
    TabiXbiLDf3MqJtwX2Lpa8wBjAc+NKrPXEjXpv0W3ou6Z4kkqKHJpXGg4GRb4N5I\n
    2FA+7T1lA0FCXa7dT2jvgJLgpBepJu5b//tqFqORb4A4gMZw0CiPN3sUsWsSw5Hd\n
    DrRXwp6sarzG77kvZQJBAPgysAmmXIIp9j1hrFSkctk4GPkOzZ3bxKt2Nl4GFrb+\n
    bpKSon6OIhP1edrxTz1SMD1k5FiAAVUrMDKSarbh5osCQQDwxq4Tvf/HiYz79JBg\n
    Wz5D51ySkbg01dOVgFW3eaYAdB6ta/o4vpHhnbrfl6VO9oUb3QR4hcrruwnDHsw3\n
    4mDTAkEA9FPZjbZSTOSH/cbgAXbdhE4/7zWOXj7Q7UVyob52r+/p46osAk9i5qj5\n
    Kvnv2lrFGDrwutpP9YqNaMtP9/aLnwJBALLWf9n+GAv3qRZD0zEe1KLPKD1dqvrj\n
    j+LNjd1Xp+tSVK7vMs4PDoAMDg+hrZF3HetSQM3cYpqxNFEPgRRJOy0CQQDQlZHI\n
    yzpSgEiyx8O3EK1iTidvnLXbtWabvjZFfIE/0OhfBmN225MtKG3YLV2HoUvpajLq\n
    gwE6fxOLyJDxuWRf\n
    -----END PRIVATE KEY-----",
    "client_email":"my at email.com"
    }""")
    
        gdal.SetConfigOption('EEDA_URL', '/vsimem/ee/')
        gdal.SetConfigOption('GOOGLE_APPLICATION_CREDENTIALS', '/vsimem/my.json')
        gdal.SetConfigOption('EEDA_PRIVATE_KEY', None)
        gdal.SetConfigOption('EEDA_CLIENT_EMAIL', None)
        gdal.SetConfigOption('GO2A_AUD', '/vsimem/oauth2/v4/token')
        gdal.SetConfigOption('GOA2_NOW', '123456')
        gdal.FileFromMemBuffer('/vsimem/oauth2/v4/token&POSTFIELDS=grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Ajwt-bearer&assertion=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiAibXlAZW1haWwuY29tIiwgInNjb3BlIjogImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2F1dGgvZWFydGhlbmdpbmUucmVhZG9ubHkiLCAiYXVkIjogIi92c2ltZW0vb2F1dGgyL3Y0L3Rva2VuIiwgImlhdCI6IDEyMzQ1NiwgImV4cCI6IDEyNzA1Nn0%3D.1W564xcQESVsqZmBEIMzj4rr0RuGa4RiUPZp5H%2FNENN9V9oPSTdacw%2BMiu3pcFf9AJv8wj0ajUeRsgTmvSicAftER49xeCQYUrs6uV122FGVsxml26kMFacNsCgRad%2Fy7xCAhMPfRJsqxS2%2BB392ssBeEzTGCSI6W3AsJg64OfA%3D',
                               '{ "access_token": "my_token", "token_type": "Bearer", "expires_in": 3600 }')
    
        ds = gdal.Open('EEDAI:image')
    
        gdal.Unlink('/vsimem/my.json')
    
        gdal.SetConfigOption('EEDA_URL', None)
        gdal.SetConfigOption('GOOGLE_APPLICATION_CREDENTIALS', None)
        gdal.SetConfigOption('EEDA_PRIVATE_KEY', None)
        gdal.SetConfigOption('EEDA_CLIENT_EMAIL', None)
    
        if gdal.GetLastErrorMsg().find('CPLRSASHA256Sign() not implemented') >= 0:
            pytest.skip()
    
        if ds is None and gdaltest.is_github_workflow_mac():
            print(gdal.GetLastErrorMsg())
            pytest.xfail('Failure. See https://github.com/rouault/gdal/runs/1329425333?check_suite_focus=true')
    
>       assert ds is not None
E       assert None is not None

/home/n0/gdt/SOFTWARE/GEO/GDAL/gdal/autotest/gdrivers/eedai.py:439: AssertionError
----------------------------- Captured stderr call -----------------------------
ERROR 1: PEM_read_bio_PrivateKey() failed
=========================== short test summary info ============================
FAILED gdrivers/eedai.py::test_eedai_GOOGLE_APPLICATION_CREDENTIALS - assert ...
==================== 1 failed, 6 passed, 2 skipped in 0.59s ====================
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210903/497e716b/attachment.sig>

From even.rouault at spatialys.com  Sat Sep  4 03:25:17 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 4 Sep 2021 12:25:17 +0200
Subject: [gdal-dev] test failures on pkgsrc build of 3.3.2rc3
In-Reply-To: <rmieea5dw13.fsf@s1.lexort.com>
References: <rmi5yvkxnvl.fsf@s1.lexort.com>
 <b688e570-3585-e8ec-e74d-577c34452848@spatialys.com>
 <rmiy28dhiqu.fsf@s1.lexort.com>
 <098cdff1-7a59-2357-6efb-b6ac7f66838b@spatialys.com>
 <rmieea5dw13.fsf@s1.lexort.com>
Message-ID: <1e5253cd-e376-f4fc-503e-83bb85a73bd2@spatialys.com>

Greg,

> an I wonder if this file (in some VFS?) has an associated mode?  I would
> sort of expect openssl to error if the private key file were readable by
> group or other, and I don't understand this filefromstring big.  (I get
> the concept; I just have no idea how it works.)

The file is indeed created in a VFS specific to GDAL, but GDAL then 
reads that file, extracts the private key from it and passes it as a 
string to the openssl API. What I notice now is that the test just 
before in that file, test_eedai_3, uses the same key, with a slightly 
different way of specifying credentials but ultimately this goes to the 
same function that invokes openssl API. One difference is that in 
test_eedai_GOOGLE_APPLICATION_CREDENTIALS there are explicit \n at the 
end of each Base64 encoded line.

Could you try removing those explicit \n (I'm really talking about the 2 
characters \ and n, not the line ending)

and/or apply that patch

diff --git a/gdal/port/cpl_google_cloud.cpp b/gdal/port/cpl_google_cloud.cpp
index 7cbe945ffe..6043f363b2 100644
--- a/gdal/port/cpl_google_cloud.cpp
+++ b/gdal/port/cpl_google_cloud.cpp
@@ -476,7 +476,7 @@ bool 
VSIGSHandleHelper::GetConfiguration(CSLConstList papszOptions,
 ???????????? return false;
 ???????? }
 ???????? CPLString osPrivateKey = oDoc.GetRoot().GetString("private_key");
-??????? osPrivateKey.replaceAll("\\n", "\n");
+??????? osPrivateKey.replaceAll("\\n", "\n").replaceAll("\n\n", "\n");
 ???????? CPLString osClientEmail = 
oDoc.GetRoot().GetString("client_email");
 ???????? const char* pszScope =
 ???????????? CSLFetchNameValueDef( papszOptions, "GS_OAUTH2_SCOPE",
@@ -518,7 +518,7 @@ bool 
VSIGSHandleHelper::GetConfiguration(CSLConstList papszOptions,
 ???????????????? CPLFree(pabyBuffer);
 ???????????? }
 ???????? }
-??????? osPrivateKey.replaceAll("\\n", "\n");
+??????? osPrivateKey.replaceAll("\\n", "\n").replaceAll("\n\n", "\n");

 ???????? CPLString osClientEmail = CSLFetchNameValueDef(papszOptions,
 ???????????? "GS_OAUTH2_CLIENT_EMAIL",


My suspicion is that some openssl versions might not like 2 consecutive 
line endings.

Hum, I've actually tried that on our CI MacOSX instance and that doesn't 
help, so I'm not optimistic above my above suggestion.

Even


-- 
http://www.spatialys.com
My software is free, but my time generally not.


From even.rouault at spatialys.com  Mon Sep  6 10:30:14 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 6 Sep 2021 19:30:14 +0200
Subject: [gdal-dev] Motion: promote GDAL 3.3.2 RC3
In-Reply-To: <9fba6d4a-3738-04c8-f6ff-1d26560b0845@spatialys.com>
References: <4450042e-e087-214c-0d4e-f1cb197276f6@spatialys.com>
 <CADPhZXwPDUfJLAX=U5LryqLSAtkXTBK+ERcShgtnCP=Od0hiLg@mail.gmail.com>
 <CADPhZXyVERY27=eSXaQ75MxXEY+9jw01CchSsxx+bG2OyTQUPQ@mail.gmail.com>
 <9fba6d4a-3738-04c8-f6ff-1d26560b0845@spatialys.com>
Message-ID: <54948375-de30-0b7a-b6ee-0ecd454b89a1@spatialys.com>

Hi Sean,

did you manage to adapt rasterio / can we promote the release ?

Even

Le 02/09/2021 ? 17:21, Even Rouault a ?crit?:
>
> Hi Sean,
>
> sure we can delay a bit the release of the final tarballs. Anyway as 
> we have the minimum 2 business day rule to pass a motion, this won't 
> be before Monday. Those issues with axis order seem to be a never 
> ending source of annoyance. Were existing before I got into the 
> geo-business and will probably be still there when I retire...
>
> I didn't anticipate that change to break rasterio, although those type 
> of changes tend to have tricky consequences, but at the same time 
> having AutoIdentifyEPSG() putting EPSG:4326 on a CRS with "wrong" axis 
> order caused other issues.
>
> Even
>
>
> Le 02/09/2021 ? 17:19, Sean Gillies a ?crit?:
>> Oops, forgot to reply to the list. Also, to be more specific, could 
>> we hold 3.3.2 until Monday, September 6?
>>
>> On Thu, Sep 2, 2021 at 9:10 AM Sean Gillies <sean at mapbox.com 
>> <mailto:sean at mapbox.com>> wrote:
>>
>>     I wish I'd noticed the change around EPSG:4326 sooner. I didn't
>>     see a particular announcement, but the breakage was obvious in
>>     rasterio's CI builds with?GDAL master and I should have been
>>     watching more closely.
>>
>>     If people update GDAL to 3.3.2 they may break their applications
>>     that use rasterio. We'll probably be able to get a new version
>>     out by the end of the week or beginning of next week. Could we
>>     hold the release a few more days?
>>
>>     On Thu, Sep 2, 2021 at 12:54 AM Even Rouault
>>     <even.rouault at spatialys.com <mailto:even.rouault at spatialys.com>>
>>     wrote:
>>
>>         Hi,
>>
>>         Having heard no issues being reported regarding RC3
>>
>>         Motion:
>>
>>         Adopt GDAL 3.3.2 RC3 as final 3.3.2 release
>>
>>         Starting with my +1
>>
>>         Even
>>
>>
>>     -- 
>>     Sean Gillies
>>
>>
>>
>> -- 
>> Sean Gillies
> -- 
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210906/7c79fbaf/attachment.html>

From sean.gillies at gmail.com  Mon Sep  6 10:52:27 2021
From: sean.gillies at gmail.com (Sean Gillies)
Date: Mon, 6 Sep 2021 11:52:27 -0600
Subject: [gdal-dev] Motion: promote GDAL 3.3.2 RC3
In-Reply-To: <54948375-de30-0b7a-b6ee-0ecd454b89a1@spatialys.com>
References: <4450042e-e087-214c-0d4e-f1cb197276f6@spatialys.com>
 <CADPhZXwPDUfJLAX=U5LryqLSAtkXTBK+ERcShgtnCP=Od0hiLg@mail.gmail.com>
 <CADPhZXyVERY27=eSXaQ75MxXEY+9jw01CchSsxx+bG2OyTQUPQ@mail.gmail.com>
 <9fba6d4a-3738-04c8-f6ff-1d26560b0845@spatialys.com>
 <54948375-de30-0b7a-b6ee-0ecd454b89a1@spatialys.com>
Message-ID: <CAOodmJq=1O_pQbz4Htov+GYFnYuM0A9Rf4G-ZCOqQgLjLnXJEw@mail.gmail.com>

Yes, rasterio will be ready today. Please go ahead. Thanks for waiting!

On Mon, Sep 6, 2021 at 11:30 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi Sean,
>
> did you manage to adapt rasterio / can we promote the release ?
>
> Even
> Le 02/09/2021 ? 17:21, Even Rouault a ?crit :
>
> Hi Sean,
>
> sure we can delay a bit the release of the final tarballs. Anyway as we
> have the minimum 2 business day rule to pass a motion, this won't be before
> Monday. Those issues with axis order seem to be a never ending source of
> annoyance. Were existing before I got into the geo-business and will
> probably be still there when I retire...
>
> I didn't anticipate that change to break rasterio, although those type of
> changes tend to have tricky consequences, but at the same time having
> AutoIdentifyEPSG() putting EPSG:4326 on a CRS with "wrong" axis order
> caused other issues.
>
> Even
>
>
> Le 02/09/2021 ? 17:19, Sean Gillies a ?crit :
>
> Oops, forgot to reply to the list. Also, to be more specific, could we
> hold 3.3.2 until Monday, September 6?
>
> On Thu, Sep 2, 2021 at 9:10 AM Sean Gillies <sean at mapbox.com> wrote:
>
>> I wish I'd noticed the change around EPSG:4326 sooner. I didn't see a
>> particular announcement, but the breakage was obvious in rasterio's CI
>> builds with GDAL master and I should have been watching more closely.
>>
>> If people update GDAL to 3.3.2 they may break their applications that use
>> rasterio. We'll probably be able to get a new version out by the end of the
>> week or beginning of next week. Could we hold the release a few more days?
>>
>> On Thu, Sep 2, 2021 at 12:54 AM Even Rouault <even.rouault at spatialys.com>
>> wrote:
>>
>>> Hi,
>>>
>>> Having heard no issues being reported regarding RC3
>>>
>>> Motion:
>>>
>>> Adopt GDAL 3.3.2 RC3 as final 3.3.2 release
>>>
>>> Starting with my +1
>>>
>>> Even
>>>
>> --
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210906/edfdf2ad/attachment.html>

From momtchil at momtchev.com  Mon Sep  6 14:09:04 2021
From: momtchil at momtchev.com (Momtchil Momtchev)
Date: Mon, 6 Sep 2021 23:09:04 +0200
Subject: [gdal-dev] Official IRC channel
Message-ID: <7c07f699-fd37-de7a-e0bc-a87083e35bad@momtchev.com>


Hello,


Now that Freenode has officially been declared dead, are there any plans 
for a new official #gdal?


-- 
Momtchil Momtchev <momtchil at momtchev.com>


From even.rouault at spatialys.com  Tue Sep  7 02:06:28 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 7 Sep 2021 11:06:28 +0200
Subject: [gdal-dev] Motion: promote GDAL 3.3.2 RC3
In-Reply-To: <4450042e-e087-214c-0d4e-f1cb197276f6@spatialys.com>
References: <4450042e-e087-214c-0d4e-f1cb197276f6@spatialys.com>
Message-ID: <32625997-2abc-17e7-b077-a971c9aa6403@spatialys.com>

Hi,

I declare this motion passed with +1 from PSC members HowardB, SeanG, 
TamasS, DanielM and myself

Even

Le 02/09/2021 ? 08:54, Even Rouault a ?crit?:
> Hi,
>
> Having heard no issues being reported regarding RC3
>
> Motion:
>
> Adopt GDAL 3.3.2 RC3 as final 3.3.2 release
>
> Starting with my +1
>
> Even
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.


From even.rouault at spatialys.com  Tue Sep  7 02:50:37 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 7 Sep 2021 11:50:37 +0200
Subject: [gdal-dev] GDAL 3.3.2 is released
Message-ID: <44c49954-d16d-d42a-e26a-d0cad715277b@spatialys.com>

Hi,

On behalf of the GDAL/OGR development team, I am pleased to announce the
release of the GDAL/OGR 3.3.2 bug fix version.

Consult the release notes for the list of issues addressed :

 ? https://github.com/OSGeo/gdal/blob/v3.3.2/gdal/NEWS

The sources are available at:

 ??? https://download.osgeo.org/gdal/3.3.2/gdal-3.3.2.tar.xz
 ??? https://download.osgeo.org/gdal/3.3.2/gdal-3.3.2.tar.gz
 ??? https://download.osgeo.org/gdal/3.3.2/gdal332.zip
 ??? https://download.osgeo.org/gdal/3.3.2/gdal-grass-3.3.2.tar.gz

Best regards,

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From even.rouault at spatialys.com  Tue Sep  7 05:52:02 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 7 Sep 2021 14:52:02 +0200
Subject: [gdal-dev] Official IRC channel
In-Reply-To: <7c07f699-fd37-de7a-e0bc-a87083e35bad@momtchev.com>
References: <7c07f699-fd37-de7a-e0bc-a87083e35bad@momtchev.com>
Message-ID: <ea043abf-fac4-d293-d6d9-88f5cceeba8d@spatialys.com>

Hi,

I've just updated the doc to point to https://web.libera.chat/#gdal

There was a previous mention of a bridging between a GDAL Matrix room 
and freenode #gdal, but I'm not sure if that was ported to libera.chat 
so I've removed that mention for now

Even

Le 06/09/2021 ? 23:09, Momtchil Momtchev a ?crit?:
>
> Hello,
>
>
> Now that Freenode has officially been declared dead, are there any 
> plans for a new official #gdal?
>
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.


From albertoparadisllop at gmail.com  Wed Sep  8 01:14:26 2021
From: albertoparadisllop at gmail.com (=?UTF-8?Q?Alberto_Parad=C3=ADs_Llop?=)
Date: Wed, 8 Sep 2021 10:14:26 +0200
Subject: [gdal-dev] WCS Driver - Wrong request when
Message-ID: <CACsMQcxji6hc-yo6jH4=o1t0zb8QwNyGKaZzqhGCMvv0cuXSrw@mail.gmail.com>

Hi,

I've been having some issues getting the WCS driver to behave correctly.
However, I am new to GIS so it's very likely I'm doing something wrong.

When performing a request on a coverage whose CRS is EPSG:4326, if the
projWin contains a negative longitude, the driver requests instead the
coverage extent's minimum longitude. For example, when requesting projWin
[-0.15, 39.5, 0.15, 39.2], the driver instead performs a request on [-6.5 ,
39.5, 0.15, 39.33], where -6.5 is the requested coverage's minimum
longitude. I have not been able to test if this is also the case for the
other axis. It results in the following error:

ERROR 1: Returned tile does not match expected configuration.
Got 6015x163 instead of 263x163.


I've been performing my requests through Python:

target_area = [-0.15, 39.5, 0.15, 39.2]
global url, layername
ds = gdal.OpenEx(f"WCS:{url}&coverage={layername}",
open_options=["NoGridAxisSwap=TRUE"])
outfile = "outputRaster.tif"
gdal.Translate(outfile, ds, projWin=target_area)

The performed request is:

https://URL/geoserver/wcs?SERVICE=WCS&REQUEST=GetCoverage&VERSION=2.0.1&COVERAGEID=geonode__F4_2020fromASC&SUBSET=Long%28-6.37708333,0.15000002403500634%29&SUBSET=Lat%2839.200000020966016,39.500000021936252%29&Format=image/tiff


This approach works when target_area does not contain a negative longitude,
like for projWin [0.1, 39.5, 0.4, 39.2]

Is there something wrong with this approach? What would the correct way to
request this area be?

Thanks,
Alberto Parad?s
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210908/158a63b1/attachment.html>

From strk at kbt.io  Wed Sep  8 08:21:25 2021
From: strk at kbt.io (Sandro Santilli)
Date: Wed, 8 Sep 2021 17:21:25 +0200
Subject: [gdal-dev] Official IRC channel
In-Reply-To: <ea043abf-fac4-d293-d6d9-88f5cceeba8d@spatialys.com>
References: <7c07f699-fd37-de7a-e0bc-a87083e35bad@momtchev.com>
 <ea043abf-fac4-d293-d6d9-88f5cceeba8d@spatialys.com>
Message-ID: <20210908152125.GC11045@c19>

On Tue, Sep 07, 2021 at 02:52:02PM +0200, Even Rouault wrote:
> Hi,
> 
> I've just updated the doc to point to https://web.libera.chat/#gdal
> 
> There was a previous mention of a bridging between a GDAL Matrix room and
> freenode #gdal, but I'm not sure if that was ported to libera.chat so I've
> removed that mention for now

Hi Even, we registered on libera.chat network as OSGeo, covering a few
namespaces, but "gdal" namespace was left out. Would you agree on
adding it under the OSGeo project umbrella and to be part of the
contact list for the OSGeo project ?

The current list of contacts is here:
  https://wiki.osgeo.org/wiki/IRC#Libera

The GDAL IRC channel line on the wiki was also already
updated to point to libera:
  https://wiki.osgeo.org/wiki/IRC#Libera

Note that in order to setup the bridge with the Matrix room we need
an Administrator of the Matrix room (I'm Administrator, and will
happily grant it to you if you give me a matrix UserID which you
consider "safe" - @rouault:osgeo.org is ok?) and also an IRC channel
*operator*, which can't be obtained at the moment if we don't register
it somehow.

--strk;

From even.rouault at spatialys.com  Wed Sep  8 08:30:44 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 8 Sep 2021 17:30:44 +0200
Subject: [gdal-dev] Official IRC channel
In-Reply-To: <20210908152125.GC11045@c19>
References: <7c07f699-fd37-de7a-e0bc-a87083e35bad@momtchev.com>
 <ea043abf-fac4-d293-d6d9-88f5cceeba8d@spatialys.com>
 <20210908152125.GC11045@c19>
Message-ID: <3fe172f9-e085-3aa5-13ca-7edf8a2ca775@spatialys.com>


> Hi Even, we registered on libera.chat network as OSGeo, covering a few
> namespaces, but "gdal" namespace was left out. Would you agree on
> adding it under the OSGeo project umbrella and to be part of the
> contact list for the OSGeo project ?
I've actually sent yesterday an email to libera admins to register 
#gdal, but didn't mention anything related to linking it to OSGeo. I got 
an automated reply from them to acknowledge the request. I'll add you in 
CC of that, so you can specify the right technical terms to them to link 
that to OSGeo.
>
> The current list of contacts is here:
>    https://wiki.osgeo.org/wiki/IRC#Libera
>
> The GDAL IRC channel line on the wiki was also already
> updated to point to libera:
>    https://wiki.osgeo.org/wiki/IRC#Libera
>
> Note that in order to setup the bridge with the Matrix room we need
> an Administrator of the Matrix room (I'm Administrator, and will
> happily grant it to you if you give me a matrix UserID which you
> consider "safe" - @rouault:osgeo.org is ok?) and also an IRC channel
> *operator*, which can't be obtained at the moment if we don't register
> it somehow.
I'm illiterate in Matrix and not really willing to learn it. Feel free 
to take care of that part.
>
> --strk;

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From Felix.Laframboise at ec.gc.ca  Wed Sep  8 13:21:02 2021
From: Felix.Laframboise at ec.gc.ca (Laframboise,Felix (ECCC))
Date: Wed, 8 Sep 2021 20:21:02 +0000
Subject: [gdal-dev] Handling NetCDF using UGRID Convention
Message-ID: <YQXPR01MB5172A5EC4D18123915A98E69CDD49@YQXPR01MB5172.CANPRD01.PROD.OUTLOOK.COM>

Hi,

I am currently using GDAL 3.1.3 on a Ubuntu machine. I am trying to work with NetCDF files using the UGRID convention (described here: https://ugrid-conventions.github.io/ugrid-conventions/).

I am having difficulty working with this kind of NetCDF file. Here is the output of  `gdalinfo` against one subdataset of a NetCDF file using the UGRID convention.


`$ gdalinfo -mm -proj4 NETCDF:"PATH_TO_NETCDF/CMC_shop_slfeav200n_surface_sfc_0_2019080706_P040.nc":St_Lawrence_River_face_nodes
Warning 1: No UNIDATA NC_GLOBAL:Conventions attribute
Driver: netCDF/Network Common Data Format
Files: PATH_TO_NETCDF/CMC_shop_slfeav200n_surface_sfc_0_2019080706_P040.nc
Size is 3, 87396
Metadata:
  St_Lawrence_River_face_nodes#cf_role=face_node_connectivity
  St_Lawrence_River_face_nodes#long_name=Maps every triangular face to its three corner nodes.
  St_Lawrence_River_face_nodes#start_index=0
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0,87396.0)
Upper Right (    3.0,    0.0)
Lower Right (    3.0,87396.0)
Center      (    1.5,43698.0)
Band 1 Block=3x1 Type=Int32, ColorInterp=Undefined
    Computed Min/Max=0.000,53331.000
  NoData Value=-2147483647
  Metadata:
    cf_role=face_node_connectivity
    long_name=Maps every triangular face to its three corner nodes.
    NETCDF_VARNAME=St_Lawrence_River_face_nodes
    start_index=0
`


Following this output, I can confirm that the size and the extent (Corner Coordinates) are not right for example.

Is there anyone who has worked with NetCDF files using the UGRID convention? Is GDAL capable of handling or manipulating this kind of NetCDF file?


Thanks a lot in advance for your answer(s)!


F?lix Laframboise
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210908/1d93474e/attachment.html>

From even.rouault at spatialys.com  Wed Sep  8 14:31:23 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 8 Sep 2021 23:31:23 +0200
Subject: [gdal-dev] Handling NetCDF using UGRID Convention
In-Reply-To: <YQXPR01MB5172A5EC4D18123915A98E69CDD49@YQXPR01MB5172.CANPRD01.PROD.OUTLOOK.COM>
References: <YQXPR01MB5172A5EC4D18123915A98E69CDD49@YQXPR01MB5172.CANPRD01.PROD.OUTLOOK.COM>
Message-ID: <a88bcb19-df4b-910e-64ab-66783447bfcf@spatialys.com>

Hi,

no the GDAL raster driver has no support for the UGRIB convention. You 
could likely use the multidimensional API 
(https://gdal.org/user/multidim_raster_data_model.html) and tools to 
access such files at a lower level, but you'd probably be better uses 
MDAL which has apparently a UGRIB reader: 
https://www.mdal.xyz/drivers/ugrid.html and should be able to expose meshes.

Even

Le 08/09/2021 ? 22:21, Laframboise,Felix (ECCC) a ?crit?:
>
> Hi,
>
> I am currently using GDAL 3.1.3 on a Ubuntu machine. I am trying to 
> work with NetCDF files using the UGRID convention (described here: 
> https://ugrid-conventions.github.io/ugrid-conventions/ 
> <https://ugrid-conventions.github.io/ugrid-conventions/>).
>
> I am having difficulty working with this kind of NetCDF file. Here is 
> the output of ?`gdalinfo` against one subdataset of a NetCDF file 
> using the UGRID convention.
>
> `$ gdalinfo -mm -proj4 
> NETCDF:"PATH_TO_NETCDF/CMC_shop_slfeav200n_surface_sfc_0_2019080706_P040.nc":St_Lawrence_River_face_nodes
>
> Warning 1: No UNIDATA NC_GLOBAL:Conventions attribute
>
> Driver: netCDF/Network Common Data Format
>
> Files: PATH_TO_NETCDF/CMC_shop_slfeav200n_surface_sfc_0_2019080706_P040.nc
>
> Size is 3, 87396
>
> Metadata:
>
> St_Lawrence_River_face_nodes#cf_role=face_node_connectivity
>
> St_Lawrence_River_face_nodes#long_name=Maps every triangular face to 
> its three corner nodes.
>
> St_Lawrence_River_face_nodes#start_index=0
>
> Corner Coordinates:
>
> Upper Left? (??? 0.0,??? 0.0)
>
> Lower Left? (??? 0.0,87396.0)
>
> Upper Right (??? 3.0,??? 0.0)
>
> Lower Right (??? 3.0,87396.0)
>
> Center????? (??? 1.5,43698.0)
>
> Band 1 Block=3x1 Type=Int32, ColorInterp=Undefined
>
> ??? Computed Min/Max=0.000,53331.000
>
> ? NoData Value=-2147483647
>
> ? Metadata:
>
> ??? cf_role=face_node_connectivity
>
> ??? long_name=Maps every triangular face to its three corner nodes.
>
> NETCDF_VARNAME=St_Lawrence_River_face_nodes
>
> ??? start_index=0
>
> `
>
> Following this output, I can confirm that the size and the extent 
> (Corner Coordinates) are not right for example.
>
> Is there anyone who has worked with NetCDF files using the UGRID 
> convention? Is GDAL capable of handling or manipulating this kind of 
> NetCDF file?
>
> Thanks a lot in advance for your answer(s)!
>
> F?lix Laframboise
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210908/bcdb63e4/attachment.html>

From eruiz at aplitop.com  Thu Sep  9 02:54:04 2021
From: eruiz at aplitop.com (Elena Ruiz)
Date: Thu, 9 Sep 2021 09:54:04 +0000
Subject: [gdal-dev] WMTS error with EPSG:3857
References: <3d652b5c-aa92-4a2a-85be-25316f1f7b0b.ba94d704-e79f-4907-b4e6-7c540f2b307c.43e7113b-3022-496b-8984-71a3c808bd7c@emailsignatures365.codetwo.com>
Message-ID: <AM0P192MB04984A1F077D28BF39AFD0AEBBD59@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>

Hello, I do not understand the error that I get now when making a call to a WMTS service, before it worked correctly, also the EPSG: 3857 is supported by that service. Could someone tell me what this error is due to?

>gdalinfo "WMTS:http://www.ign.es/wmts/pnoa-ma?request=GetCapabilities&service=WMTS&username=&password=,layer=OI.OrthoimageCoverage,tilematrixset=EPSG:3857"
ERROR 1: Cannot find TileMatrixSet 'EPSG:3857'
gdalinfo failed - unable to open 'WMTS:http://www.ign.es/wmts/pnoa-ma?request=GetCapabilities&service=WMTS&username=&password=,layer=OI.OrthoimageCoverage,tilematrixset=EPSG:3857'.


Thank you and regards

________________________________

[https://www.aplitop.com/descargas/firma1.jpg]


Elena Ruiz
Sofware Development & Technical Support
Tel. +34 952 43 97 71
eruiz at aplitop.com
Sumatra, 9 - 29190 M?laga (Spain)
www.aplitop.com

[cid:SocialLink_Facebook_32x32_a745adb8-c250-4372-8480-e77f503dad3d.png]<https://www.facebook.com/AplitopSL/>   [cid:SocialLink_Twitter_32x32_858247f6-9d4a-4740-a6b3-9b5ebfd98a97.png] <https://twitter.com/aplitop>    [cid:SocialLink_Linkedin_32x32_154d63de-bf68-468f-9eb0-ffed102fac77.png] <https://www.linkedin.com/company/aplitop>    [cid:SocialLink_Youtube_32x32_0dea15dd-3774-4086-be9d-f62560b70c86.png] <https://www.youtube.com/user/aplitop>


In accordance with the provisions of the European Regulation of Data Protection 2016/679 (Reglamento Europeo de Protecci?n de Datos 2016/679), we inform you that the data and the information you provide us through this medium will be used by APLITOP, S.L., with C.I.F. B-92543396 and with address at C / Sumatra, 9, Malaga, 29190, in order to answer your questions and inform you about our products. The data provided will be kept as long as it does not request its cessation and will not be transferred to third parties except in cases where there is a legal obligation. You have the right to access your personal data, correct inaccurate data or request its deletion when the data is no longer necessary for the purposes that were collected, as well as any rights recognized in the RGPD 2016/679

<https://www.aplitop.com/Event/en/358/intergeo-2019>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210909/b36a9954/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Facebook_32x32_a745adb8-c250-4372-8480-e77f503dad3d.png
Type: image/png
Size: 365 bytes
Desc: SocialLink_Facebook_32x32_a745adb8-c250-4372-8480-e77f503dad3d.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210909/b36a9954/attachment-0004.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Twitter_32x32_858247f6-9d4a-4740-a6b3-9b5ebfd98a97.png
Type: image/png
Size: 619 bytes
Desc: SocialLink_Twitter_32x32_858247f6-9d4a-4740-a6b3-9b5ebfd98a97.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210909/b36a9954/attachment-0005.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Linkedin_32x32_154d63de-bf68-468f-9eb0-ffed102fac77.png
Type: image/png
Size: 468 bytes
Desc: SocialLink_Linkedin_32x32_154d63de-bf68-468f-9eb0-ffed102fac77.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210909/b36a9954/attachment-0006.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Youtube_32x32_0dea15dd-3774-4086-be9d-f62560b70c86.png
Type: image/png
Size: 817 bytes
Desc: SocialLink_Youtube_32x32_0dea15dd-3774-4086-be9d-f62560b70c86.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210909/b36a9954/attachment-0007.png>

From even.rouault at spatialys.com  Thu Sep  9 03:27:37 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 9 Sep 2021 12:27:37 +0200
Subject: [gdal-dev] WMTS error with EPSG:3857
In-Reply-To: <AM0P192MB04984A1F077D28BF39AFD0AEBBD59@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
References: <3d652b5c-aa92-4a2a-85be-25316f1f7b0b.ba94d704-e79f-4907-b4e6-7c540f2b307c.43e7113b-3022-496b-8984-71a3c808bd7c@emailsignatures365.codetwo.com>
 <AM0P192MB04984A1F077D28BF39AFD0AEBBD59@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
Message-ID: <c8f0c7f7-dd67-c814-4143-b7e21450afe6@spatialys.com>

Elena,

I believe the GetCapabilities response of this service is not fully 
valid. The layer has a <TileMatrixSetLink> that points to a EPSG:3857 
tileMatrix, but there's no <TileMatrixSet> definition with a 
<ows:Identifier> with this value. You can presumably use the 
GoogleMapsCompatible tilematrixset, which should be an alias of EPSG:3857

I've submitted in https://github.com/OSGeo/gdal/pull/4457 a fix to not 
list that tilematrixset.

Even

Le 09/09/2021 ? 11:54, Elena Ruiz a ?crit?:
>
> Hello, I do not understand the error that I get now when making a call 
> to a WMTS service, before it worked correctly, also the EPSG: 3857 is 
> supported by that service. Could someone tell me what this error is 
> due to?
>
> >*gdalinfo 
> "WMTS:http://www.ign.es/wmts/pnoa-ma?request=GetCapabilities&service=WMTS&username=&password=,layer=OI.OrthoimageCoverage,tilematrixset=EPSG:3857"*
>
> ERROR 1: Cannot find TileMatrixSet 'EPSG:3857'
>
> gdalinfo failed - unable to open 
> 'WMTS:http://www.ign.es/wmts/pnoa-ma?request=GetCapabilities&service=WMTS&username=&password=,layer=OI.OrthoimageCoverage,tilematrixset=EPSG:3857'.
>
> Thank you and regards
>
> ------------------------------------------------------------------------
>
> 	
> *Elena Ruiz *
> Sofware Development & Technical Support
> Tel. +34 952 43 97 71
> eruiz at aplitop.com
> Sumatra, 9 - 29190 M?laga (Spain)
> *www.aplitop.com
>
> <https://www.facebook.com/AplitopSL/> <https://twitter.com/aplitop> 
> <https://www.linkedin.com/company/aplitop> 
> <https://www.youtube.com/user/aplitop>*
>
> In accordance with the provisions of the European Regulation of Data 
> Protection 2016/679 (Reglamento Europeo de Protecci?n de Datos 
> 2016/679), we inform you that the data and the information you provide 
> us through this medium will be used by APLITOP, S.L., with C.I.F. 
> B-92543396 and with address at C / Sumatra, 9, Malaga, 29190, in order 
> to answer your questions and inform you about our products. The data 
> provided will be kept as long as it does not request its cessation and 
> will not be transferred to third parties except in cases where there 
> is a legal obligation. You have the right to access your personal 
> data, correct inaccurate data or request its deletion when the data is 
> no longer necessary for the purposes that were collected, as well as 
> any rights recognized in the RGPD 2016/679
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210909/b772719c/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Facebook_32x32_a745adb8-c250-4372-8480-e77f503dad3d.png
Type: image/png
Size: 365 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210909/b772719c/attachment.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Twitter_32x32_858247f6-9d4a-4740-a6b3-9b5ebfd98a97.png
Type: image/png
Size: 619 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210909/b772719c/attachment-0001.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Linkedin_32x32_154d63de-bf68-468f-9eb0-ffed102fac77.png
Type: image/png
Size: 468 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210909/b772719c/attachment-0002.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Youtube_32x32_0dea15dd-3774-4086-be9d-f62560b70c86.png
Type: image/png
Size: 817 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210909/b772719c/attachment-0003.png>

From eruiz at aplitop.com  Thu Sep  9 09:03:57 2021
From: eruiz at aplitop.com (Elena Ruiz)
Date: Thu, 9 Sep 2021 16:03:57 +0000
Subject: [gdal-dev] WMTS error with gdal2.4.4
References: <3d652b5c-aa92-4a2a-85be-25316f1f7b0b.ba94d704-e79f-4907-b4e6-7c540f2b307c.7be69243-ffac-4282-aeb0-b565b413c1c7@emailsignatures365.codetwo.com>
Message-ID: <AM0P192MB0498D4288FBBBF0B017FE4F8BBD59@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>

Hello, I have two versions of GDAL 2.4.4 with the dll gdal204.dll dated 2020/01/08, but one is 17.4Mb and the other 20.3 Mb, with Gdal.VersionInfo I get the version of both files and is the same, but they give different results with the following command:

DLL gdal204.dll (20,3 MB)
>gdalinfo "WMTS:http://www.ign.es/wmts/pnoa-ma?request=GetCapabilities&service=WMTS&username=&password=,layer=OI.OrthoimageCoverage,tilematrixset=EPSG:25830"
ERROR 1: latitude or longitude exceeded limits
Driver: WMTS/OGC Web Map Tile Service
Files: none associated
Size is 20616192, 28663296
Coordinate System is:
PROJCS["ETRS89 / UTM zone 30N",
    GEOGCS["ETRS89",
        DATUM["European_Terrestrial_Reference_System_1989",
            SPHEROID["GRS 1980",6378137,298.257222101,
                AUTHORITY["EPSG","7019"]],
            TOWGS84[0,0,0,0,0,0,0],
            AUTHORITY["EPSG","6258"]],
        PRIMEM["Greenwich",0,
            AUTHORITY["EPSG","8901"]],
        UNIT["degree",0.0174532925199433,
            AUTHORITY["EPSG","9122"]],
        AUTHORITY["EPSG","4258"]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",-3],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AXIS["Easting",EAST],
    AXIS["Northing",NORTH],
    AUTHORITY["EPSG","25830"]]
Origin = (-1968157.094999999972060,7271532.000000000000000)
Pixel Size = (0.149291070899963,-0.149291070899963)
Metadata:
  ABSTRACT=Imagen de sat??lite Sentinel2 a escalas menores de 1:70.000 y las ortofotograf??as PNOA de m??xima actualidad para escalas mayores, para toda Espa??a. Las teselas se pregeneran en formato JPEG y hasta el nivel 19 (correspondiente con una escala aproximada 1:1.000) en el Sistema de Referencia por Coordenadas WGS84 Web Mercator (EPSG:3857).
  TITLE=Im??genes de sat??lite Sentinel y ortofotos PNOA
Image Structure Metadata:
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (-1968157.095, 7271532.000) ( 45d 9'51.15"W, 57d59'16.66"N)
Lower Left  (-1968157.095, 2992357.845) ( 27d 0' 0.04"W, 24d59'58.98"N)
Upper Right ( 1109656.287, 7271532.000) ( 10d 0' 2.21"E, 65d 0' 0.77"N)
Lower Right ( 1109656.287, 2992357.845) (  3d 8' 0.50"E, 26d55'11.11"N)
Center      ( -429250.404, 5131944.922) ( 14d56'30.30"W, 45d42'45.53"N)

DLL gdal204.dll (17,4 MB)
>gdalinfo "WMTS:http://www.ign.es/wmts/pnoa-ma?request=GetCapabilities&service=WMTS&username=&password=,layer=OI.OrthoimageCoverage,tilematrixset=EPSG:25830"
Driver: WMTS/OGC Web Map Tile Service
Files: none associated
Size is 432948, 28663296
Coordinate System is:
PROJCS["ETRS89 / UTM zone 30N",
    GEOGCS["ETRS89",
        DATUM["European_Terrestrial_Reference_System_1989",
            SPHEROID["GRS 1980",6378137,298.257222101,
                AUTHORITY["EPSG","7019"]],
            TOWGS84[0,0,0,0,0,0,0],
            AUTHORITY["EPSG","6258"]],
        PRIMEM["Greenwich",0,
            AUTHORITY["EPSG","8901"]],
        UNIT["degree",0.0174532925199433,
            AUTHORITY["EPSG","9122"]],
        AUTHORITY["EPSG","4258"]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",-3],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AXIS["Easting",EAST],
    AXIS["Northing",NORTH],
    AUTHORITY["EPSG","25830"]]
Origin = (404318.828097780002281,7271532.000000000000000)
Pixel Size = (0.149291070899963,-0.149291070899963)
Metadata:
  ABSTRACT=Imagen de sat??lite Sentinel2 a escalas menores de 1:70.000 y las ortofotograf??as PNOA de m??xima actualidad para escalas mayores, para toda Espa??a. Las teselas se pregeneran en formato JPEG y hasta el nivel 19 (correspondiente con una escala aproximada 1:1.000) en el Sistema de Referencia por Coordenadas WGS84 Web Mercator (EPSG:3857).
  TITLE=Im??genes de sat??lite Sentinel y ortofotos PNOA
Image Structure Metadata:
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (  404318.828, 7271532.000) (  5d 4'19.71"W, 65d33' 6.57"N)
Lower Left  (  404318.828, 2992357.845) (  3d57'53.21"W, 27d 3' 0.59"N)
Upper Right (  468954.099, 7271532.000) (  3d40'21.33"W, 65d33'52.09"N)
Lower Right (  468954.099, 2992357.845) (  3d18'47.02"W, 27d 3'11.25"N)
Center      (  436636.463, 5131944.922) (  3d49'24.02"W, 46d20'17.22"N)

As you can see, the command is exactly the same but in the first case an ERROR1 appears and also the coordinates are not the same as in the second case. What could the error be due to? Thanks and regards
________________________________

[https://www.aplitop.com/descargas/firma1.jpg]


Elena Ruiz
Sofware Development & Technical Support
Tel. +34 952 43 97 71
eruiz at aplitop.com
Sumatra, 9 - 29190 M?laga (Spain)
www.aplitop.com

[cid:SocialLink_Facebook_32x32_a745adb8-c250-4372-8480-e77f503dad3d.png]<https://www.facebook.com/AplitopSL/>   [cid:SocialLink_Twitter_32x32_858247f6-9d4a-4740-a6b3-9b5ebfd98a97.png] <https://twitter.com/aplitop>    [cid:SocialLink_Linkedin_32x32_154d63de-bf68-468f-9eb0-ffed102fac77.png] <https://www.linkedin.com/company/aplitop>    [cid:SocialLink_Youtube_32x32_0dea15dd-3774-4086-be9d-f62560b70c86.png] <https://www.youtube.com/user/aplitop>


In accordance with the provisions of the European Regulation of Data Protection 2016/679 (Reglamento Europeo de Protecci?n de Datos 2016/679), we inform you that the data and the information you provide us through this medium will be used by APLITOP, S.L., with C.I.F. B-92543396 and with address at C / Sumatra, 9, Malaga, 29190, in order to answer your questions and inform you about our products. The data provided will be kept as long as it does not request its cessation and will not be transferred to third parties except in cases where there is a legal obligation. You have the right to access your personal data, correct inaccurate data or request its deletion when the data is no longer necessary for the purposes that were collected, as well as any rights recognized in the RGPD 2016/679

<https://www.aplitop.com/Event/en/358/intergeo-2019>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210909/2e911906/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Facebook_32x32_a745adb8-c250-4372-8480-e77f503dad3d.png
Type: image/png
Size: 365 bytes
Desc: SocialLink_Facebook_32x32_a745adb8-c250-4372-8480-e77f503dad3d.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210909/2e911906/attachment-0004.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Twitter_32x32_858247f6-9d4a-4740-a6b3-9b5ebfd98a97.png
Type: image/png
Size: 619 bytes
Desc: SocialLink_Twitter_32x32_858247f6-9d4a-4740-a6b3-9b5ebfd98a97.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210909/2e911906/attachment-0005.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Linkedin_32x32_154d63de-bf68-468f-9eb0-ffed102fac77.png
Type: image/png
Size: 468 bytes
Desc: SocialLink_Linkedin_32x32_154d63de-bf68-468f-9eb0-ffed102fac77.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210909/2e911906/attachment-0006.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Youtube_32x32_0dea15dd-3774-4086-be9d-f62560b70c86.png
Type: image/png
Size: 817 bytes
Desc: SocialLink_Youtube_32x32_0dea15dd-3774-4086-be9d-f62560b70c86.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210909/2e911906/attachment-0007.png>

From even.rouault at spatialys.com  Thu Sep  9 09:25:37 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 9 Sep 2021 18:25:37 +0200
Subject: [gdal-dev] WMTS error with gdal2.4.4
In-Reply-To: <AM0P192MB0498D4288FBBBF0B017FE4F8BBD59@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
References: <3d652b5c-aa92-4a2a-85be-25316f1f7b0b.ba94d704-e79f-4907-b4e6-7c540f2b307c.7be69243-ffac-4282-aeb0-b565b413c1c7@emailsignatures365.codetwo.com>
 <AM0P192MB0498D4288FBBBF0B017FE4F8BBD59@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
Message-ID: <e9ffd23b-3964-c90b-ddfa-17088851394f@spatialys.com>

Elena,

the difference is likely due to the PROJ version used. I'd assume in the 
first case to be PROJ < 4.9.3 and in the second PROJ >= 4.9.3

You actually get a better result in the first case. If you add -oo 
EXTENT_METHOD=MOST_PRECISE_TILE_MATRIX, you should get the best result 
in any case

I've filed an issue https://github.com/OSGeo/gdal/issues/4461 about that

Even

Le 09/09/2021 ? 18:03, Elena Ruiz a ?crit?:
>
> Hello, I have two versions of GDAL 2.4.4 with the dll gdal204.dll 
> dated 2020/01/08, but one is 17.4Mb and the other 20.3 Mb, with 
> Gdal.VersionInfo I get the version of both files and is the same, but 
> they give different results with the following command:
>
> DLL gdal204.dll (20,3 MB)
>
> >*gdalinfo 
> "WMTS:http://www.ign.es/wmts/pnoa-ma?request=GetCapabilities&service=WMTS&username=&password=,layer=OI.OrthoimageCoverage,tilematrixset=EPSG:25830"*
>
> ERROR 1: latitude or longitude exceeded limits
>
> Driver: WMTS/OGC Web Map Tile Service
>
> Files: none associated
>
> Size is 20616192, 28663296
>
> Coordinate System is:
>
> PROJCS["ETRS89 / UTM zone 30N",
>
> GEOGCS["ETRS89",
>
> DATUM["European_Terrestrial_Reference_System_1989",
>
> SPHEROID["GRS 1980",6378137,298.257222101,
>
> AUTHORITY["EPSG","7019"]],
>
> TOWGS84[0,0,0,0,0,0,0],
>
> AUTHORITY["EPSG","6258"]],
>
> PRIMEM["Greenwich",0,
>
> AUTHORITY["EPSG","8901"]],
>
> UNIT["degree",0.0174532925199433,
>
> AUTHORITY["EPSG","9122"]],
>
> AUTHORITY["EPSG","4258"]],
>
> PROJECTION["Transverse_Mercator"],
>
> PARAMETER["latitude_of_origin",0],
>
> PARAMETER["central_meridian",-3],
>
> PARAMETER["scale_factor",0.9996],
>
> PARAMETER["false_easting",500000],
>
> PARAMETER["false_northing",0],
>
> UNIT["metre",1,
>
> AUTHORITY["EPSG","9001"]],
>
> AXIS["Easting",EAST],
>
> AXIS["Northing",NORTH],
>
> AUTHORITY["EPSG","25830"]]
>
> Origin = (-1968157.094999999972060,7271532.000000000000000)
>
> Pixel Size = (0.149291070899963,-0.149291070899963)
>
> Metadata:
>
> ABSTRACT=Imagen de sat??lite Sentinel2 a escalas menores de 1:70.000 y 
> las ortofotograf??as PNOA de m??xima actualidad para escalas mayores, 
> para toda Espa??a. Las teselas se pregeneran en formato JPEG y hasta 
> el nivel 19 (correspondiente con una escala aproximada 1:1.000) en el 
> Sistema de Referencia por Coordenadas WGS84 Web Mercator (EPSG:3857).
>
> ? TITLE=Im??genes de sat??lite Sentinel y ortofotos PNOA
>
> Image Structure Metadata:
>
> INTERLEAVE=PIXEL
>
> Corner Coordinates:
>
> Upper Left? (-1968157.095, 7271532.000) ( 45d 9'51.15"W, 57d59'16.66"N)
>
> Lower Left? (-1968157.095, 2992357.845) ( 27d 0' 0.04"W, 24d59'58.98"N)
>
> Upper Right ( 1109656.287, 7271532.000) ( 10d 0' 2.21"E, 65d 0' 0.77"N)
>
> Lower Right ( 1109656.287, 2992357.845) (? 3d 8' 0.50"E, 26d55'11.11"N)
>
> Center????? ( -429250.404, 5131944.922) ( 14d56'30.30"W, 45d42'45.53"N)
>
> DLL gdal204.dll (17,4 MB)
>
> >*gdalinfo 
> "WMTS:http://www.ign.es/wmts/pnoa-ma?request=GetCapabilities&service=WMTS&username=&password=,layer=OI.OrthoimageCoverage,tilematrixset=EPSG:25830"*
>
> Driver: WMTS/OGC Web Map Tile Service
>
> Files: none associated
>
> Size is 432948, 28663296
>
> Coordinate System is:
>
> PROJCS["ETRS89 / UTM zone 30N",
>
> GEOGCS["ETRS89",
>
> DATUM["European_Terrestrial_Reference_System_1989",
>
> SPHEROID["GRS 1980",6378137,298.257222101,
>
> AUTHORITY["EPSG","7019"]],
>
> TOWGS84[0,0,0,0,0,0,0],
>
> AUTHORITY["EPSG","6258"]],
>
> PRIMEM["Greenwich",0,
>
> AUTHORITY["EPSG","8901"]],
>
> UNIT["degree",0.0174532925199433,
>
> ?????AUTHORITY["EPSG","9122"]],
>
> AUTHORITY["EPSG","4258"]],
>
> PROJECTION["Transverse_Mercator"],
>
> PARAMETER["latitude_of_origin",0],
>
> PARAMETER["central_meridian",-3],
>
> PARAMETER["scale_factor",0.9996],
>
> PARAMETER["false_easting",500000],
>
> PARAMETER["false_northing",0],
>
> UNIT["metre",1,
>
> AUTHORITY["EPSG","9001"]],
>
> AXIS["Easting",EAST],
>
> AXIS["Northing",NORTH],
>
> AUTHORITY["EPSG","25830"]]
>
> Origin = (404318.828097780002281,7271532.000000000000000)
>
> Pixel Size = (0.149291070899963,-0.149291070899963)
>
> Metadata:
>
> ABSTRACT=Imagen de sat??lite Sentinel2 a escalas menores de 1:70.000 y 
> las ortofotograf??as PNOA de m??xima actualidad para escalas mayores, 
> para toda Espa??a. Las teselas se pregeneran en formato JPEG y hasta 
> el nivel 19 (correspondiente con una escala aproximada 1:1.000) en el 
> Sistema de Referencia por Coordenadas WGS84 Web Mercator (EPSG:3857).
>
> ? TITLE=Im??genes de sat??lite Sentinel y ortofotos PNOA
>
> Image Structure Metadata:
>
> INTERLEAVE=PIXEL
>
> Corner Coordinates:
>
> Upper Left? (? 404318.828, 7271532.000) (? 5d 4'19.71"W, 65d33' 6.57"N)
>
> Lower Left? (? 404318.828, 2992357.845) ( 3d57'53.21"W, 27d 3' 0.59"N)
>
> Upper Right (? 468954.099, 7271532.000) ( 3d40'21.33"W, 65d33'52.09"N)
>
> Lower Right (? 468954.099, 2992357.845) ( 3d18'47.02"W, 27d 3'11.25"N)
>
> Center????? (? 436636.463, 5131944.922) ( 3d49'24.02"W, 46d20'17.22"N)
>
> As you can see, the command is exactly the same but in the first case 
> an ERROR1 appears and also the coordinates are not the same as in the 
> second case. What could the error be due to? Thanks and regards
>
> ------------------------------------------------------------------------
>
> 	
> *Elena Ruiz *
> Sofware Development & Technical Support
> Tel. +34 952 43 97 71
> eruiz at aplitop.com
> Sumatra, 9 - 29190 M?laga (Spain)
> *www.aplitop.com
>
> <https://www.facebook.com/AplitopSL/> <https://twitter.com/aplitop> 
> <https://www.linkedin.com/company/aplitop> 
> <https://www.youtube.com/user/aplitop>*
>
> In accordance with the provisions of the European Regulation of Data 
> Protection 2016/679 (Reglamento Europeo de Protecci?n de Datos 
> 2016/679), we inform you that the data and the information you provide 
> us through this medium will be used by APLITOP, S.L., with C.I.F. 
> B-92543396 and with address at C / Sumatra, 9, Malaga, 29190, in order 
> to answer your questions and inform you about our products. The data 
> provided will be kept as long as it does not request its cessation and 
> will not be transferred to third parties except in cases where there 
> is a legal obligation. You have the right to access your personal 
> data, correct inaccurate data or request its deletion when the data is 
> no longer necessary for the purposes that were collected, as well as 
> any rights recognized in the RGPD 2016/679
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210909/92fbf275/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Facebook_32x32_a745adb8-c250-4372-8480-e77f503dad3d.png
Type: image/png
Size: 365 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210909/92fbf275/attachment-0004.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Twitter_32x32_858247f6-9d4a-4740-a6b3-9b5ebfd98a97.png
Type: image/png
Size: 619 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210909/92fbf275/attachment-0005.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Linkedin_32x32_154d63de-bf68-468f-9eb0-ffed102fac77.png
Type: image/png
Size: 468 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210909/92fbf275/attachment-0006.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Youtube_32x32_0dea15dd-3774-4086-be9d-f62560b70c86.png
Type: image/png
Size: 817 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210909/92fbf275/attachment-0007.png>

From eruiz at aplitop.com  Thu Sep  9 09:34:02 2021
From: eruiz at aplitop.com (Elena Ruiz)
Date: Thu, 9 Sep 2021 16:34:02 +0000
Subject: [gdal-dev] gdal-dev Digest, Vol 208, Issue 15
In-Reply-To: <mailman.14146.1631204742.1889.gdal-dev@lists.osgeo.org>
References: <mailman.14146.1631204742.1889.gdal-dev@lists.osgeo.org>
 <3d652b5c-aa92-4a2a-85be-25316f1f7b0b.ba94d704-e79f-4907-b4e6-7c540f2b307c.0165ae24-964e-44ea-a70b-c1d8d1cdf154@emailsignatures365.codetwo.com>
Message-ID: <AM0P192MB0498E4AD39B5BAC2AE5B3779BBD59@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>

Thank you very much for your answer, indeed when I add -oo EXTENT_METHOD = MOST_PRECISE_TILE_MATRIX to the gdalinfo command, it now works the same in both cases. But I have one more doubt, what would the correct syntax for Gdal.Open in c # look like? Thanks and regards

-----Mensaje original-----
De: gdal-dev <gdal-dev-bounces at lists.osgeo.org> En nombre de gdal-dev-request at lists.osgeo.org
Enviado el: jueves, 9 de septiembre de 2021 18:26
Para: gdal-dev at lists.osgeo.org
Asunto: gdal-dev Digest, Vol 208, Issue 15

Send gdal-dev mailing list submissions to
	gdal-dev at lists.osgeo.org

To subscribe or unsubscribe via the World Wide Web, visit
	https://lists.osgeo.org/mailman/listinfo/gdal-dev
or, via email, send a message with subject or body 'help' to
	gdal-dev-request at lists.osgeo.org

You can reach the person managing the list at
	gdal-dev-owner at lists.osgeo.org

When replying, please edit your Subject line so it is more specific than "Re: Contents of gdal-dev digest..."


Today's Topics:

   1. Re: WMTS error with gdal2.4.4 (Even Rouault)


----------------------------------------------------------------------

Message: 1
Date: Thu, 9 Sep 2021 18:25:37 +0200
From: Even Rouault <even.rouault at spatialys.com>
To: Elena Ruiz <eruiz at aplitop.com>, "gdal-dev at lists.osgeo.org"
	<gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] WMTS error with gdal2.4.4
Message-ID: <e9ffd23b-3964-c90b-ddfa-17088851394f at spatialys.com>
Content-Type: text/plain; charset="utf-8"; Format="flowed"

Elena,

the difference is likely due to the PROJ version used. I'd assume in the first case to be PROJ < 4.9.3 and in the second PROJ >= 4.9.3

You actually get a better result in the first case. If you add -oo EXTENT_METHOD=MOST_PRECISE_TILE_MATRIX, you should get the best result in any case

I've filed an issue https://github.com/OSGeo/gdal/issues/4461 about that

Even

Le 09/09/2021 ? 18:03, Elena Ruiz a ?crit?:
>
> Hello, I have two versions of GDAL 2.4.4 with the dll gdal204.dll 
> dated 2020/01/08, but one is 17.4Mb and the other 20.3 Mb, with 
> Gdal.VersionInfo I get the version of both files and is the same, but 
> they give different results with the following command:
>
> DLL gdal204.dll (20,3 MB)
>
> >*gdalinfo
> "WMTS:http://www.ign.es/wmts/pnoa-ma?request=GetCapabilities&service=W
> MTS&username=&password=,layer=OI.OrthoimageCoverage,tilematrixset=EPSG
> :25830"*
>
> ERROR 1: latitude or longitude exceeded limits
>
> Driver: WMTS/OGC Web Map Tile Service
>
> Files: none associated
>
> Size is 20616192, 28663296
>
> Coordinate System is:
>
> PROJCS["ETRS89 / UTM zone 30N",
>
> GEOGCS["ETRS89",
>
> DATUM["European_Terrestrial_Reference_System_1989",
>
> SPHEROID["GRS 1980",6378137,298.257222101,
>
> AUTHORITY["EPSG","7019"]],
>
> TOWGS84[0,0,0,0,0,0,0],
>
> AUTHORITY["EPSG","6258"]],
>
> PRIMEM["Greenwich",0,
>
> AUTHORITY["EPSG","8901"]],
>
> UNIT["degree",0.0174532925199433,
>
> AUTHORITY["EPSG","9122"]],
>
> AUTHORITY["EPSG","4258"]],
>
> PROJECTION["Transverse_Mercator"],
>
> PARAMETER["latitude_of_origin",0],
>
> PARAMETER["central_meridian",-3],
>
> PARAMETER["scale_factor",0.9996],
>
> PARAMETER["false_easting",500000],
>
> PARAMETER["false_northing",0],
>
> UNIT["metre",1,
>
> AUTHORITY["EPSG","9001"]],
>
> AXIS["Easting",EAST],
>
> AXIS["Northing",NORTH],
>
> AUTHORITY["EPSG","25830"]]
>
> Origin = (-1968157.094999999972060,7271532.000000000000000)
>
> Pixel Size = (0.149291070899963,-0.149291070899963)
>
> Metadata:
>
> ABSTRACT=Imagen de sat??lite Sentinel2 a escalas menores de 1:70.000 y 
> las ortofotograf??as PNOA de m??xima actualidad para escalas mayores, 
> para toda Espa??a. Las teselas se pregeneran en formato JPEG y hasta 
> el nivel 19 (correspondiente con una escala aproximada 1:1.000) en el 
> Sistema de Referencia por Coordenadas WGS84 Web Mercator (EPSG:3857).
>
> ? TITLE=Im??genes de sat??lite Sentinel y ortofotos PNOA
>
> Image Structure Metadata:
>
> INTERLEAVE=PIXEL
>
> Corner Coordinates:
>
> Upper Left? (-1968157.095, 7271532.000) ( 45d 9'51.15"W, 
> 57d59'16.66"N)
>
> Lower Left? (-1968157.095, 2992357.845) ( 27d 0' 0.04"W, 
> 24d59'58.98"N)
>
> Upper Right ( 1109656.287, 7271532.000) ( 10d 0' 2.21"E, 65d 0' 
> 0.77"N)
>
> Lower Right ( 1109656.287, 2992357.845) (? 3d 8' 0.50"E, 
> 26d55'11.11"N)
>
> Center????? ( -429250.404, 5131944.922) ( 14d56'30.30"W, 
> 45d42'45.53"N)
>
> DLL gdal204.dll (17,4 MB)
>
> >*gdalinfo
> "WMTS:http://www.ign.es/wmts/pnoa-ma?request=GetCapabilities&service=W
> MTS&username=&password=,layer=OI.OrthoimageCoverage,tilematrixset=EPSG
> :25830"*
>
> Driver: WMTS/OGC Web Map Tile Service
>
> Files: none associated
>
> Size is 432948, 28663296
>
> Coordinate System is:
>
> PROJCS["ETRS89 / UTM zone 30N",
>
> GEOGCS["ETRS89",
>
> DATUM["European_Terrestrial_Reference_System_1989",
>
> SPHEROID["GRS 1980",6378137,298.257222101,
>
> AUTHORITY["EPSG","7019"]],
>
> TOWGS84[0,0,0,0,0,0,0],
>
> AUTHORITY["EPSG","6258"]],
>
> PRIMEM["Greenwich",0,
>
> AUTHORITY["EPSG","8901"]],
>
> UNIT["degree",0.0174532925199433,
>
> ?????AUTHORITY["EPSG","9122"]],
>
> AUTHORITY["EPSG","4258"]],
>
> PROJECTION["Transverse_Mercator"],
>
> PARAMETER["latitude_of_origin",0],
>
> PARAMETER["central_meridian",-3],
>
> PARAMETER["scale_factor",0.9996],
>
> PARAMETER["false_easting",500000],
>
> PARAMETER["false_northing",0],
>
> UNIT["metre",1,
>
> AUTHORITY["EPSG","9001"]],
>
> AXIS["Easting",EAST],
>
> AXIS["Northing",NORTH],
>
> AUTHORITY["EPSG","25830"]]
>
> Origin = (404318.828097780002281,7271532.000000000000000)
>
> Pixel Size = (0.149291070899963,-0.149291070899963)
>
> Metadata:
>
> ABSTRACT=Imagen de sat??lite Sentinel2 a escalas menores de 1:70.000 y 
> las ortofotograf??as PNOA de m??xima actualidad para escalas mayores, 
> para toda Espa??a. Las teselas se pregeneran en formato JPEG y hasta 
> el nivel 19 (correspondiente con una escala aproximada 1:1.000) en el 
> Sistema de Referencia por Coordenadas WGS84 Web Mercator (EPSG:3857).
>
> ? TITLE=Im??genes de sat??lite Sentinel y ortofotos PNOA
>
> Image Structure Metadata:
>
> INTERLEAVE=PIXEL
>
> Corner Coordinates:
>
> Upper Left? (? 404318.828, 7271532.000) (? 5d 4'19.71"W, 65d33' 
> 6.57"N)
>
> Lower Left? (? 404318.828, 2992357.845) ( 3d57'53.21"W, 27d 3' 0.59"N)
>
> Upper Right (? 468954.099, 7271532.000) ( 3d40'21.33"W, 65d33'52.09"N)
>
> Lower Right (? 468954.099, 2992357.845) ( 3d18'47.02"W, 27d 3'11.25"N)
>
> Center????? (? 436636.463, 5131944.922) ( 3d49'24.02"W, 46d20'17.22"N)
>
> As you can see, the command is exactly the same but in the first case 
> an ERROR1 appears and also the coordinates are not the same as in the 
> second case. What could the error be due to? Thanks and regards
>
> ----------------------------------------------------------------------
> --
>
> 	
> *Elena Ruiz *
> Sofware Development & Technical Support Tel. +34 952 43 97 71 
> eruiz at aplitop.com Sumatra, 9 - 29190 M?laga (Spain) *www.aplitop.com
>
> <https://www.facebook.com/AplitopSL/> <https://twitter.com/aplitop> 
> <https://www.linkedin.com/company/aplitop>
> <https://www.youtube.com/user/aplitop>*
>
> In accordance with the provisions of the European Regulation of Data 
> Protection 2016/679 (Reglamento Europeo de Protecci?n de Datos 
> 2016/679), we inform you that the data and the information you provide 
> us through this medium will be used by APLITOP, S.L., with C.I.F.
> B-92543396 and with address at C / Sumatra, 9, Malaga, 29190, in order 
> to answer your questions and inform you about our products. The data 
> provided will be kept as long as it does not request its cessation and 
> will not be transferred to third parties except in cases where there 
> is a legal obligation. You have the right to access your personal 
> data, correct inaccurate data or request its deletion when the data is 
> no longer necessary for the purposes that were collected, as well as 
> any rights recognized in the RGPD 2016/679
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

--
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210909/92fbf275/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Facebook_32x32_a745adb8-c250-4372-8480-e77f503dad3d.png
Type: image/png
Size: 365 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210909/92fbf275/attachment.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Twitter_32x32_858247f6-9d4a-4740-a6b3-9b5ebfd98a97.png
Type: image/png
Size: 619 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210909/92fbf275/attachment-0001.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Linkedin_32x32_154d63de-bf68-468f-9eb0-ffed102fac77.png
Type: image/png
Size: 468 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210909/92fbf275/attachment-0002.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Youtube_32x32_0dea15dd-3774-4086-be9d-f62560b70c86.png
Type: image/png
Size: 817 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210909/92fbf275/attachment-0003.png>

------------------------------

Subject: Digest Footer

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev


------------------------------

End of gdal-dev Digest, Vol 208, Issue 15
*****************************************

From rajsekar at gmail.com  Sun Sep 12 07:03:10 2021
From: rajsekar at gmail.com (Rajsekar Manokaran)
Date: Sun, 12 Sep 2021 19:33:10 +0530
Subject: [gdal-dev] Get error handler user data when removing CPL Error
 Handler
Message-ID: <CA+4CNMGZsOaKZi_oVe9K7sKBrUkpWSkciapAG0NdL5j-zpbB2w@mail.gmail.com>

Hi,

In the gdal rust bindings (https://github.com/georust/gdal), we're trying
to facilitate the use of CPLSetErrorHandlerEx and related APIs.  While
setting a handler, we may pass a heap allocated data pointer to the second
argument, which is then read via the CPLGetErrorHandlerUserData in the
handler and passed to the user.

However, while removing or setting another handler, we're unable to find a
race-free method to get the associated user data of the previous handler.
This is needed to properly deallocate the memory.

Is there an atomic way to get both the previous handler (as returned by
CPLSetErrorHandler), along with the associated user data?  The issue with
making two calls, is that another thread might make changes in between the
two calls.

We could synchronize in our API, but it still has the same issue if the
user parallely used the C APIs directly or via a different interface.

Relevant PR in rust gdal bindings: https://github.com/georust/gdal/pull/215

-
Regards
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210912/695f9a37/attachment.html>

From even.rouault at spatialys.com  Sun Sep 12 07:12:19 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 12 Sep 2021 16:12:19 +0200
Subject: [gdal-dev] Get error handler user data when removing CPL Error
 Handler
In-Reply-To: <CA+4CNMGZsOaKZi_oVe9K7sKBrUkpWSkciapAG0NdL5j-zpbB2w@mail.gmail.com>
References: <CA+4CNMGZsOaKZi_oVe9K7sKBrUkpWSkciapAG0NdL5j-zpbB2w@mail.gmail.com>
Message-ID: <0637288e-2945-443c-5f02-39f318003644@spatialys.com>

Hi,

no there's no thread safe API to do what you want. You'd need a new function

CPLErrorHandler CPLSetErrorHandlerEx2( CPLErrorHandler 
pfnErrorHandlerNew, void* pUserData, void** ppOldUserData )

to do that.

But as you mention threads that might compete to set an error handler, 
using CPLSetErrorHandlerEx() is probably not the best strategy. You'd be 
better with CPLPushErrorHandler() / CPLPopErrorHandler() that only 
affects the current thread.

Even

Le 12/09/2021 ? 16:03, Rajsekar Manokaran a ?crit?:
> Hi,
>
> In the gdal rust bindings (https://github.com/georust/gdal 
> <https://github.com/georust/gdal>), we're trying to facilitate the use 
> of CPLSetErrorHandlerEx and related APIs.? While setting a handler, we 
> may pass a heap allocated data pointer to the second argument, which 
> is then read via the CPLGetErrorHandlerUserData in the handler and 
> passed to the user.
>
> However, while removing or setting another handler, we're unable to 
> find a race-free method to get the associated user data of the 
> previous handler.?? This is needed to properly deallocate the memory.
>
> Is there an atomic way to get both the previous handler (as returned 
> by CPLSetErrorHandler), along with the associated user data?? The 
> issue with making two calls, is that another thread might make changes 
> in between the two calls.
>
> We could synchronize in our API, but it still has the same issue if 
> the user parallely used the C APIs directly or via a different interface.
>
> Relevant PR in rust gdal bindings: 
> https://github.com/georust/gdal/pull/215 
> <https://github.com/georust/gdal/pull/215>
>
> -
> Regards
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210912/a1407600/attachment.html>

From rajsekar at gmail.com  Sun Sep 12 08:04:26 2021
From: rajsekar at gmail.com (Rajsekar Manokaran)
Date: Sun, 12 Sep 2021 20:34:26 +0530
Subject: [gdal-dev] Get error handler user data when removing CPL Error
 Handler
In-Reply-To: <0637288e-2945-443c-5f02-39f318003644@spatialys.com>
References: <CA+4CNMGZsOaKZi_oVe9K7sKBrUkpWSkciapAG0NdL5j-zpbB2w@mail.gmail.com>
 <0637288e-2945-443c-5f02-39f318003644@spatialys.com>
Message-ID: <CA+4CNMFrAFBr+xg-JhAnPde6Am9d7pknL87zNYzEt-TuVa_eRQ@mail.gmail.com>

Thanks for the clarification! The API you suggest would indeed be quite
convenient.

We do intend to support the thread local variants too, but wanted to see
how much we can support the global one.

-
Regards

On Sun, Sep 12, 2021 at 7:42 PM Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
> no there's no thread safe API to do what you want. You'd need a new
> function
>
> CPLErrorHandler CPLSetErrorHandlerEx2( CPLErrorHandler pfnErrorHandlerNew,
> void* pUserData, void** ppOldUserData )
>
> to do that.
>
> But as you mention threads that might compete to set an error handler,
> using CPLSetErrorHandlerEx() is probably not the best strategy. You'd be
> better with CPLPushErrorHandler() / CPLPopErrorHandler() that only affects
> the current thread.
>
> Even
> Le 12/09/2021 ? 16:03, Rajsekar Manokaran a ?crit :
>
> Hi,
>
> In the gdal rust bindings (https://github.com/georust/gdal), we're trying
> to facilitate the use of CPLSetErrorHandlerEx and related APIs.  While
> setting a handler, we may pass a heap allocated data pointer to the second
> argument, which is then read via the CPLGetErrorHandlerUserData in the
> handler and passed to the user.
>
> However, while removing or setting another handler, we're unable to find a
> race-free method to get the associated user data of the previous handler.
> This is needed to properly deallocate the memory.
>
> Is there an atomic way to get both the previous handler (as returned by
> CPLSetErrorHandler), along with the associated user data?  The issue with
> making two calls, is that another thread might make changes in between the
> two calls.
>
> We could synchronize in our API, but it still has the same issue if the
> user parallely used the C APIs directly or via a different interface.
>
> Relevant PR in rust gdal bindings:
> https://github.com/georust/gdal/pull/215
>
> -
> Regards
>
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210912/6a64af4d/attachment.html>

From sean at mapbox.com  Sun Sep 12 09:23:15 2021
From: sean at mapbox.com (Sean Gillies)
Date: Sun, 12 Sep 2021 10:23:15 -0600
Subject: [gdal-dev] Get error handler user data when removing CPL Error
 Handler
In-Reply-To: <0637288e-2945-443c-5f02-39f318003644@spatialys.com>
References: <CA+4CNMGZsOaKZi_oVe9K7sKBrUkpWSkciapAG0NdL5j-zpbB2w@mail.gmail.com>
 <0637288e-2945-443c-5f02-39f318003644@spatialys.com>
Message-ID: <CADPhZXzuZFJ4kg+nBRh_+jKi9aUAHUEbjM2Ee8RUiS4tTc5NeA@mail.gmail.com>

Hi,

For what it's worth, In the Python package named rasterio we're using the
push/pop API:
https://github.com/mapbox/rasterio/blob/master/rasterio/_env.pyx#L336.
While Rust's needs may differ, a single handler without any support for
user data works well for Python: everything goes to the logging
infrastructure, one of the kind of globals that Howard refers to in
https://github.com/OSGeo/gdal/blob/master/gdal/doc/source/development/rfc/rfc37_cplerror_userdata.rst#rationale,
and Python developers extend the logger if they want behavior that is
different from the basic defaults.

On Sun, Sep 12, 2021 at 8:12 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
> no there's no thread safe API to do what you want. You'd need a new
> function
>
> CPLErrorHandler CPLSetErrorHandlerEx2( CPLErrorHandler pfnErrorHandlerNew,
> void* pUserData, void** ppOldUserData )
>
> to do that.
>
> But as you mention threads that might compete to set an error handler,
> using CPLSetErrorHandlerEx() is probably not the best strategy. You'd be
> better with CPLPushErrorHandler() / CPLPopErrorHandler() that only affects
> the current thread.
>
> Even
> Le 12/09/2021 ? 16:03, Rajsekar Manokaran a ?crit :
>
> Hi,
>
> In the gdal rust bindings (https://github.com/georust/gdal), we're trying
> to facilitate the use of CPLSetErrorHandlerEx and related APIs.  While
> setting a handler, we may pass a heap allocated data pointer to the second
> argument, which is then read via the CPLGetErrorHandlerUserData in the
> handler and passed to the user.
>
> However, while removing or setting another handler, we're unable to find a
> race-free method to get the associated user data of the previous handler.
> This is needed to properly deallocate the memory.
>
> Is there an atomic way to get both the previous handler (as returned by
> CPLSetErrorHandler), along with the associated user data?  The issue with
> making two calls, is that another thread might make changes in between the
> two calls.
>
> We could synchronize in our API, but it still has the same issue if the
> user parallely used the C APIs directly or via a different interface.
>
> Relevant PR in rust gdal bindings:
> https://github.com/georust/gdal/pull/215
>
> -
> Regards
>
>

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210912/cef13953/attachment-0001.html>

From rajsekar at gmail.com  Sun Sep 12 10:52:26 2021
From: rajsekar at gmail.com (Rajsekar Manokaran)
Date: Sun, 12 Sep 2021 23:22:26 +0530
Subject: [gdal-dev] Get error handler user data when removing CPL Error
 Handler
In-Reply-To: <CADPhZXzuZFJ4kg+nBRh_+jKi9aUAHUEbjM2Ee8RUiS4tTc5NeA@mail.gmail.com>
References: <CA+4CNMGZsOaKZi_oVe9K7sKBrUkpWSkciapAG0NdL5j-zpbB2w@mail.gmail.com>
 <0637288e-2945-443c-5f02-39f318003644@spatialys.com>
 <CADPhZXzuZFJ4kg+nBRh_+jKi9aUAHUEbjM2Ee8RUiS4tTc5NeA@mail.gmail.com>
Message-ID: <CA+4CNMGTS6zJ_8eM0HaLYwPSzMc3m_JNNrG9teeSF+m_FCqGxQ@mail.gmail.com>

Thanks, that does make sense.  Fortunately, like py, Rust also has
closures, so user data could be handled directly by the caller.  We're also
pushing for an impl. without user-data support.  The thread local APIs
should also be supported (not done yet though); should be much simpler as
it doesn't involve concurrency.



On Sun, Sep 12, 2021 at 9:53 PM Sean Gillies <sean at mapbox.com> wrote:

> Hi,
>
> For what it's worth, In the Python package named rasterio we're using the
> push/pop API:
> https://github.com/mapbox/rasterio/blob/master/rasterio/_env.pyx#L336.
> While Rust's needs may differ, a single handler without any support for
> user data works well for Python: everything goes to the logging
> infrastructure, one of the kind of globals that Howard refers to in
> https://github.com/OSGeo/gdal/blob/master/gdal/doc/source/development/rfc/rfc37_cplerror_userdata.rst#rationale,
> and Python developers extend the logger if they want behavior that is
> different from the basic defaults.
>
> On Sun, Sep 12, 2021 at 8:12 AM Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> Hi,
>>
>> no there's no thread safe API to do what you want. You'd need a new
>> function
>>
>> CPLErrorHandler CPLSetErrorHandlerEx2( CPLErrorHandler
>> pfnErrorHandlerNew, void* pUserData, void** ppOldUserData )
>>
>> to do that.
>>
>> But as you mention threads that might compete to set an error handler,
>> using CPLSetErrorHandlerEx() is probably not the best strategy. You'd be
>> better with CPLPushErrorHandler() / CPLPopErrorHandler() that only affects
>> the current thread.
>>
>> Even
>> Le 12/09/2021 ? 16:03, Rajsekar Manokaran a ?crit :
>>
>> Hi,
>>
>> In the gdal rust bindings (https://github.com/georust/gdal), we're
>> trying to facilitate the use of CPLSetErrorHandlerEx and related APIs.
>> While setting a handler, we may pass a heap allocated data pointer to the
>> second argument, which is then read via the CPLGetErrorHandlerUserData in
>> the handler and passed to the user.
>>
>> However, while removing or setting another handler, we're unable to find
>> a race-free method to get the associated user data of the previous
>> handler.   This is needed to properly deallocate the memory.
>>
>> Is there an atomic way to get both the previous handler (as returned by
>> CPLSetErrorHandler), along with the associated user data?  The issue with
>> making two calls, is that another thread might make changes in between the
>> two calls.
>>
>> We could synchronize in our API, but it still has the same issue if the
>> user parallely used the C APIs directly or via a different interface.
>>
>> Relevant PR in rust gdal bindings:
>> https://github.com/georust/gdal/pull/215
>>
>> -
>> Regards
>>
>>
>
> --
> Sean Gillies
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210912/c80209e4/attachment.html>

From eric.r.patton at protonmail.com  Mon Sep 13 06:58:45 2021
From: eric.r.patton at protonmail.com (Eric Patton)
Date: Mon, 13 Sep 2021 13:58:45 +0000
Subject: [gdal-dev] Maximum writable GDAL raster size (rows x columns and/or
 filesize in bytes)
Message-ID: <eX6T9ac-uF1XP-5aaT9MdhzcrUxsYXfB-pYl_-OH2BuUJy_IpZ9KwdWr60LikxhOYy7un2ml8Ec1Fjk53QB_50888Fsl1QKTVVaLN-N1gL8=@protonmail.com>

Hi,

I'm using MB-System to write very large GMT netCDF 4-byte float format rasters, and I need to know what is the maximum raster size I can write (rows x columns and/or filesize in bytes).

I had a large gdalwarp process running that was killed, probably on the order of several tens of thousands of rows and columns, but I can't tell if it was my operating system (Linux Mint 20.2) or GDAL that kiiled it.

Does GDAL impose any limits, and if so, what are they? How can I calculate what my operating system filesize limit would be?

Thanks,

--
Eric
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210913/775dddef/attachment.html>

From even.rouault at spatialys.com  Mon Sep 13 09:14:46 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 13 Sep 2021 18:14:46 +0200
Subject: [gdal-dev] Maximum writable GDAL raster size (rows x columns
 and/or filesize in bytes)
In-Reply-To: <eX6T9ac-uF1XP-5aaT9MdhzcrUxsYXfB-pYl_-OH2BuUJy_IpZ9KwdWr60LikxhOYy7un2ml8Ec1Fjk53QB_50888Fsl1QKTVVaLN-N1gL8=@protonmail.com>
References: <eX6T9ac-uF1XP-5aaT9MdhzcrUxsYXfB-pYl_-OH2BuUJy_IpZ9KwdWr60LikxhOYy7un2ml8Ec1Fjk53QB_50888Fsl1QKTVVaLN-N1gL8=@protonmail.com>
Message-ID: <974e4ba4-44fc-fa92-0bc4-bc2766db935c@spatialys.com>

Eric,

I would expect the limits to be beyond the capacity of any conceivable 
hard disk. If you've a reproducer (you can possibly use the gdal_create 
utility to create a dummy input file), please file a ticket about that

Even

Le 13/09/2021 ? 15:58, Eric Patton via gdal-dev a ?crit?:
> Hi,
>
> I'm using MB-System to write very large?GMT netCDF 4-byte float format 
> rasters, and I need to know what is the maximum raster size I can 
> write?(rows x columns and/or filesize in bytes).
>
> I had a large gdalwarp process running that was killed, probably on 
> the order of several tens of thousands of rows and columns, but I 
> can't tell if it was my operating system (Linux Mint 20.2) or GDAL 
> that kiiled it.
>
> Does GDAL impose any limits, and if so, what are they? How can I 
> calculate what my operating system filesize limit would be?
>
> Thanks,
>
> --
> Eric
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210913/53ff303b/attachment.html>

From maxim.rylov at sap.com  Tue Sep 14 00:37:25 2021
From: maxim.rylov at sap.com (Rylov, Maxim)
Date: Tue, 14 Sep 2021 07:37:25 +0000
Subject: [gdal-dev] HANA driver proposal
Message-ID: <AM4PR02MB31237E1328F4D1F08D47C66BF7DA9@AM4PR02MB3123.eurprd02.prod.outlook.com>

Dear Even,

We haven?t received any reply on our last e-mail from 17th of August regarding the HANA driver.
We would be grateful if you could answer our questions.

Thank you and kind regards,
Maxim Rylov on behalf of the HANA Spatial Team
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210914/d55f2726/attachment.html>

From even.rouault at spatialys.com  Tue Sep 14 02:15:47 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 14 Sep 2021 11:15:47 +0200
Subject: [gdal-dev] HANA driver proposal
In-Reply-To: <AM0PR02MB5777368BAAABDE84DC38EF9493FE9@AM0PR02MB5777.eurprd02.prod.outlook.com>
References: <AM4PR02MB3123A11FB595552D31089E84F7E19@AM4PR02MB3123.eurprd02.prod.outlook.com>
 <b44320cb-6af8-fd1f-f220-22547d5ff071@spatialys.com>
 <AM4PR02MB3123930CA96402ACE6F9CB6FF7E89@AM4PR02MB3123.eurprd02.prod.outlook.com>
 <1c76d86b-c775-567a-1553-a93fc935c052@spatialys.com>
 <AM0PR02MB5777368BAAABDE84DC38EF9493FE9@AM0PR02MB5777.eurprd02.prod.outlook.com>
Message-ID: <86132d80-d195-dd8e-ae76-a67c240240b8@spatialys.com>

Hi,
>
> ?Can you point us to an example of a GDAL plugin that is offered as 
> download from a GDAL external website?
>
See https://github.com/OSGeo/gdal/pull/3447#issuecomment-776819142
>
> This might be an option, but we would prefer contributing directly to 
> GDAL, of course. Maintaining binary plugin versions externally for all 
> the relevant versions/platforms/compilers will probably be difficult.
>
For the platforms/compilers part, you already need to do that to provide 
the binaries of the ODBC driver. Adding GDAL versions (GDAL driver ABI 
generally changes at feature versions) of course would add an extra 
dimension to this.
>
> ?Would it be sufficient if the OGR SAP HANA driver is reviewed by 
> members of our team? And if that?s not sufficient, what options do we 
> have to find someone who is qualified to do the final review?
>
Ultimately you need to find someone who has merge rights to be 
enthusiastic enough to press the merge button. Either because he/she has 
reviewed itself the code (because he/she's interested naturally in the 
work, or you find compelling ways of making him/her interested in it) 
and is happy to see his name in the merge commit, or he/she trusts 
someone else who has done the review.

I'm interested if other PSC members have an opinion if this should 
rather be proposed as a in-tree driver or out-of-tree one.

Even

> Thanks, and best regards,
>
> Stefan
>
> *From:*gdal-dev <gdal-dev-bounces at lists.osgeo.org> *On Behalf Of *Even 
> Rouault
> *Sent:* Friday, August 13, 2021 7:31 PM
> *To:* Rylov, Maxim <maxim.rylov at sap.com>; gdal-dev at lists.osgeo.org
> *Subject:* Re: [gdal-dev] HANA driver proposal
>
> Maxim,
>
> > ?I assume the driver would depend on the ODBC library, and would require users to 
> build https://github.com/SAP/odbc-cpp-wrapper 
> <https://github.com/SAP/odbc-cpp-wrapper>as the corresponding ODBC 
> driver ??
>
>     The odbc-cpp-wrapper library is going to be used only during the
>     compilation phase and linked statically, thus end users will get
>     only one dynamic/shared library of the HANA driver.? Hence, no
>     additional actions are required from end users. For those who want
>     to compile the GDAL sources with HANA support on their own, the
>     sources of the odbc-cpp-wrapper are needed. However, this step can
>     be omitted if we store a copy of the library in
>     https://github.com/OSGeo/gdal/tree/master/gdal/third_party
>     <https://github.com/OSGeo/gdal/tree/master/gdal/third_party>like
>     we did in QGIS (see
>     https://github.com/qgis/QGIS/tree/master/external/odbccpp
>     <https://github.com/qgis/QGIS/tree/master/external/odbccpp>).
>
> I can anticipate potential issues if both GDAL and QGIS have a odbcpp 
> vendorized copy, and that for some reason they differ in versions. 
> That could cause symbol clashes at runtime. Putting the vendorized 
> copy in a dedicated namespace prefix (GDAL::) could avoid that.
>
> Otherwise, isn't the cpl_odbc.h abstraction good enough ?
>
> Side note: are you aware of https://github.com/nanodbc/nanodbc 
> <https://github.com/nanodbc/nanodbc> that is also a C++ wrapper for 
> ODBC ? (Mateusz one of our PSC members was the main developer of it, 
> although I believe he has retired from it)
>
>     Note, that any HANA plugin (GDAL/QGIS) also requires the SAP HANA
>     Client (https://tools.hana.ondemand.com/#hanatools
>     <https://tools.hana.ondemand.com/#hanatools>) to be able to
>     connect an SAP HANA database.
>
> Is that the ODBC driver for SAP HANA ?
>
>     ?Unfortunately, we are not able to answer the remaining raised
>     pointsas they are beyond our expertise.
>
>     Perhaps they should be addressed in a separate dedicated discussion.
>
> Well, if you contribute to GDAL, then that should be in your area of 
> interest and concern :-)
>
> I think the main practical issue for this to go forward is for you to 
> find someone who would want to review your contribution.
>
> Another option is to propose the OGR SAP HANA driver as a plugin for 
> download from your website.
>
> Even
>
> -- 
> http://www.spatialys.com  <http://www.spatialys.com>
> My software is free, but my time generally not.

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210914/90719f54/attachment.html>

From howard at hobu.co  Tue Sep 14 07:59:29 2021
From: howard at hobu.co (Howard Butler)
Date: Tue, 14 Sep 2021 09:59:29 -0500
Subject: [gdal-dev] Motion: Approve Nyall Dawson as a contracted GDAL
 maintainer
Message-ID: <DF43E85F-B1F2-4C65-B4A0-0A97A269864D@hobu.co>

Dear PSC,

As a result of our fundraising activity and development of NumFOCUS as a financial conduit, it is my pleasure to put forward a motion to approve Nyall Dawson as a contracted GDAL maintainer for the year 2021-2022 beginning on October 1st, 2021 and ending September 30th, 2022.

Details of the maintenance tasking and duties can be found at the previously approved RFC 83 https://gdal.org/development/rfc/rfc83_use_of_project_sponsorship.html

The terms of the contract are for a maximum of 500 hours at 90 ?/hr.

Howard

PS I will coordinating the contracting activity in my role as the GDAL NumFOCUS contracting liaison, with Frank Warmerdam acting as the secondary. Please contact us directly with any comments or concerns.

From warmerdam at pobox.com  Tue Sep 14 08:15:30 2021
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue, 14 Sep 2021 22:15:30 +0700
Subject: [gdal-dev] Motion: Approve Nyall Dawson as a contracted GDAL
 maintainer
In-Reply-To: <DF43E85F-B1F2-4C65-B4A0-0A97A269864D@hobu.co>
References: <DF43E85F-B1F2-4C65-B4A0-0A97A269864D@hobu.co>
Message-ID: <CA+YzLBf_EDvsbXzy-H84o7CO+3GwMXsdiCt5SqyRd=fzPum7Ng@mail.gmail.com>

+1 FrankW

On Tue, Sep 14, 2021 at 9:59 PM Howard Butler <howard at hobu.co> wrote:

> Dear PSC,
>
> As a result of our fundraising activity and development of NumFOCUS as a
> financial conduit, it is my pleasure to put forward a motion to approve
> Nyall Dawson as a contracted GDAL maintainer for the year 2021-2022
> beginning on October 1st, 2021 and ending September 30th, 2022.
>
> Details of the maintenance tasking and duties can be found at the
> previously approved RFC 83
> https://gdal.org/development/rfc/rfc83_use_of_project_sponsorship.html
>
> The terms of the contract are for a maximum of 500 hours at 90 ?/hr.
>
> Howard
>
> PS I will coordinating the contracting activity in my role as the GDAL
> NumFOCUS contracting liaison, with Frank Warmerdam acting as the secondary.
> Please contact us directly with any comments or concerns.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | +1 650-701-7823
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210914/0c23d18f/attachment.html>

From dmorissette at mapgears.com  Tue Sep 14 08:46:56 2021
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Tue, 14 Sep 2021 11:46:56 -0400
Subject: [gdal-dev] Motion: Approve Nyall Dawson as a contracted GDAL
 maintainer
In-Reply-To: <DF43E85F-B1F2-4C65-B4A0-0A97A269864D@hobu.co>
References: <DF43E85F-B1F2-4C65-B4A0-0A97A269864D@hobu.co>
Message-ID: <d7dff30b-31ed-2d9e-7453-66918e25052f@mapgears.com>

+1

Daniel


On 2021-09-14 10:59, Howard Butler wrote:
> Dear PSC,
> 
> As a result of our fundraising activity and development of NumFOCUS as a financial conduit, it is my pleasure to put forward a motion to approve Nyall Dawson as a contracted GDAL maintainer for the year 2021-2022 beginning on October 1st, 2021 and ending September 30th, 2022.
> 
> Details of the maintenance tasking and duties can be found at the previously approved RFC 83 https://gdal.org/development/rfc/rfc83_use_of_project_sponsorship.html
> 
> The terms of the contract are for a maximum of 500 hours at 90 ?/hr.
> 
> Howard
> 
> PS I will coordinating the contracting activity in my role as the GDAL NumFOCUS contracting liaison, with Frank Warmerdam acting as the secondary. Please contact us directly with any comments or concerns.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 


-- 
Daniel Morissette
Mapgears Inc
T: +1 418-696-5056 #201

From even.rouault at spatialys.com  Tue Sep 14 08:55:41 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 14 Sep 2021 17:55:41 +0200
Subject: [gdal-dev] Motion: Approve Nyall Dawson as a contracted GDAL
 maintainer
In-Reply-To: <DF43E85F-B1F2-4C65-B4A0-0A97A269864D@hobu.co>
References: <DF43E85F-B1F2-4C65-B4A0-0A97A269864D@hobu.co>
Message-ID: <a38cbfc5-146d-8eeb-d699-d28973c4609f@spatialys.com>

+1 Even

Le 14/09/2021 ? 16:59, Howard Butler a ?crit?:
> Dear PSC,
>
> As a result of our fundraising activity and development of NumFOCUS as a financial conduit, it is my pleasure to put forward a motion to approve Nyall Dawson as a contracted GDAL maintainer for the year 2021-2022 beginning on October 1st, 2021 and ending September 30th, 2022.
>
> Details of the maintenance tasking and duties can be found at the previously approved RFC 83 https://gdal.org/development/rfc/rfc83_use_of_project_sponsorship.html
>
> The terms of the contract are for a maximum of 500 hours at 90 ?/hr.
>
> Howard
>
> PS I will coordinating the contracting activity in my role as the GDAL NumFOCUS contracting liaison, with Frank Warmerdam acting as the secondary. Please contact us directly with any comments or concerns.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From schwehr at gmail.com  Tue Sep 14 09:21:22 2021
From: schwehr at gmail.com (Kurt Schwehr)
Date: Tue, 14 Sep 2021 09:21:22 -0700
Subject: [gdal-dev] Motion: Approve Nyall Dawson as a contracted GDAL
 maintainer
In-Reply-To: <DF43E85F-B1F2-4C65-B4A0-0A97A269864D@hobu.co>
References: <DF43E85F-B1F2-4C65-B4A0-0A97A269864D@hobu.co>
Message-ID: <CACmBxyuJRqpgJHOpeshghv0tZ7fOy5ZzMVXMq88fQYLs-QE1sA@mail.gmail.com>

+1 KurtS

On Tue, Sep 14, 2021 at 7:59 AM Howard Butler <howard at hobu.co> wrote:

> Dear PSC,
>
> As a result of our fundraising activity and development of NumFOCUS as a
> financial conduit, it is my pleasure to put forward a motion to approve
> Nyall Dawson as a contracted GDAL maintainer for the year 2021-2022
> beginning on October 1st, 2021 and ending September 30th, 2022.
>
> Details of the maintenance tasking and duties can be found at the
> previously approved RFC 83
> https://gdal.org/development/rfc/rfc83_use_of_project_sponsorship.html
>
> The terms of the contract are for a maximum of 500 hours at 90 ?/hr.
>
> Howard
>
> PS I will coordinating the contracting activity in my role as the GDAL
> NumFOCUS contracting liaison, with Frank Warmerdam acting as the secondary.
> Please contact us directly with any comments or concerns.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210914/35b51b4e/attachment.html>

From mateusz at loskot.net  Tue Sep 14 09:28:21 2021
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue, 14 Sep 2021 18:28:21 +0200
Subject: [gdal-dev] Motion: Approve Nyall Dawson as a contracted GDAL
 maintainer
In-Reply-To: <DF43E85F-B1F2-4C65-B4A0-0A97A269864D@hobu.co>
References: <DF43E85F-B1F2-4C65-B4A0-0A97A269864D@hobu.co>
Message-ID: <CABUeae8LwY0p7LjfKnQzskKyfa70xeFutB=seuTcwi2+kTKw5A@mail.gmail.com>

+1   Mateusz

On Tue, 14 Sept 2021 at 16:59, Howard Butler <howard at hobu.co> wrote:
>
> Dear PSC,
>
> As a result of our fundraising activity and development of NumFOCUS as a financial conduit, it is my pleasure to put forward a motion to approve Nyall Dawson as a contracted GDAL maintainer for the year 2021-2022 beginning on October 1st, 2021 and ending September 30th, 2022.
>
> Details of the maintenance tasking and duties can be found at the previously approved RFC 83 https://gdal.org/development/rfc/rfc83_use_of_project_sponsorship.html
>
> The terms of the contract are for a maximum of 500 hours at 90 ?/hr.
>
> Howard
>
> PS I will coordinating the contracting activity in my role as the GDAL NumFOCUS contracting liaison, with Frank Warmerdam acting as the secondary. Please contact us directly with any comments or concerns.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Mateusz Loskot, http://mateusz.loskot.net

From jukka.rahkonen at maanmittauslaitos.fi  Tue Sep 14 11:16:33 2021
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Tue, 14 Sep 2021 18:16:33 +0000
Subject: [gdal-dev] Motion: Approve Nyall Dawson as a contracted GDAL
 maintainer
Message-ID: <2f35e814fc60410cbfc460cb4d50b405@maanmittauslaitos.fi>

+1

-Jukka Rahkonen-

-----Alkuper?inen viesti-----
L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Howard Butler
L?hetetty: tiistai 14. syyskuuta 2021 17.59
Vastaanottaja: gdal dev <gdal-dev at lists.osgeo.org>
Aihe: [gdal-dev] Motion: Approve Nyall Dawson as a contracted GDAL maintainer

Dear PSC,

As a result of our fundraising activity and development of NumFOCUS as a financial conduit, it is my pleasure to put forward a motion to approve Nyall Dawson as a contracted GDAL maintainer for the year 2021-2022 beginning on October 1st, 2021 and ending September 30th, 2022.

Details of the maintenance tasking and duties can be found at the previously approved RFC 83 https://gdal.org/development/rfc/rfc83_use_of_project_sponsorship.html

The terms of the contract are for a maximum of 500 hours at 90 ?/hr.

Howard

PS I will coordinating the contracting activity in my role as the GDAL NumFOCUS contracting liaison, with Frank Warmerdam acting as the secondary. Please contact us directly with any comments or concerns.
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev

From norman.barker at gmail.com  Tue Sep 14 12:54:18 2021
From: norman.barker at gmail.com (Norman Barker)
Date: Tue, 14 Sep 2021 14:54:18 -0500
Subject: [gdal-dev] Motion: Approve Nyall Dawson as a contracted GDAL
 maintainer
In-Reply-To: <CABUeae8LwY0p7LjfKnQzskKyfa70xeFutB=seuTcwi2+kTKw5A@mail.gmail.com>
References: <DF43E85F-B1F2-4C65-B4A0-0A97A269864D@hobu.co>
 <CABUeae8LwY0p7LjfKnQzskKyfa70xeFutB=seuTcwi2+kTKw5A@mail.gmail.com>
Message-ID: <CAN_Dn-FmtdX4cynwvwhwbpi4ZqXEh8S6YL8a-PWg63uFB5xPgA@mail.gmail.com>

+1 Norman

On Tue, Sep 14, 2021 at 11:28 AM Mateusz Loskot <mateusz at loskot.net> wrote:

> +1   Mateusz
>
> On Tue, 14 Sept 2021 at 16:59, Howard Butler <howard at hobu.co> wrote:
> >
> > Dear PSC,
> >
> > As a result of our fundraising activity and development of NumFOCUS as a
> financial conduit, it is my pleasure to put forward a motion to approve
> Nyall Dawson as a contracted GDAL maintainer for the year 2021-2022
> beginning on October 1st, 2021 and ending September 30th, 2022.
> >
> > Details of the maintenance tasking and duties can be found at the
> previously approved RFC 83
> https://gdal.org/development/rfc/rfc83_use_of_project_sponsorship.html
> >
> > The terms of the contract are for a maximum of 500 hours at 90 ?/hr.
> >
> > Howard
> >
> > PS I will coordinating the contracting activity in my role as the GDAL
> NumFOCUS contracting liaison, with Frank Warmerdam acting as the secondary.
> Please contact us directly with any comments or concerns.
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
> --
> Mateusz Loskot, http://mateusz.loskot.net
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210914/14fd3dc3/attachment.html>

From szekerest at gmail.com  Tue Sep 14 14:03:35 2021
From: szekerest at gmail.com (Tamas Szekeres)
Date: Tue, 14 Sep 2021 23:03:35 +0200
Subject: [gdal-dev] Motion: Approve Nyall Dawson as a contracted GDAL
 maintainer
In-Reply-To: <DF43E85F-B1F2-4C65-B4A0-0A97A269864D@hobu.co>
References: <DF43E85F-B1F2-4C65-B4A0-0A97A269864D@hobu.co>
Message-ID: <CACALY+TiPV+bVjQXVs4sX0kkaZQQGNmEFQ5Dmsff2E1Md7G0nQ@mail.gmail.com>

+1

Tamas

Howard Butler <howard at hobu.co> ezt ?rta (id?pont: 2021. szept. 14., K,
16:59):

> Dear PSC,
>
> As a result of our fundraising activity and development of NumFOCUS as a
> financial conduit, it is my pleasure to put forward a motion to approve
> Nyall Dawson as a contracted GDAL maintainer for the year 2021-2022
> beginning on October 1st, 2021 and ending September 30th, 2022.
>
> Details of the maintenance tasking and duties can be found at the
> previously approved RFC 83
> https://gdal.org/development/rfc/rfc83_use_of_project_sponsorship.html
>
> The terms of the contract are for a maximum of 500 hours at 90 ?/hr.
>
> Howard
>
> PS I will coordinating the contracting activity in my role as the GDAL
> NumFOCUS contracting liaison, with Frank Warmerdam acting as the secondary.
> Please contact us directly with any comments or concerns.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210914/70e9a784/attachment.html>

From sean at mapbox.com  Tue Sep 14 14:57:36 2021
From: sean at mapbox.com (Sean Gillies)
Date: Tue, 14 Sep 2021 15:57:36 -0600
Subject: [gdal-dev] Motion: Approve Nyall Dawson as a contracted GDAL
 maintainer
In-Reply-To: <DF43E85F-B1F2-4C65-B4A0-0A97A269864D@hobu.co>
References: <DF43E85F-B1F2-4C65-B4A0-0A97A269864D@hobu.co>
Message-ID: <CADPhZXzES4kRd+0cS97dCrgFYiJUoD1CGA4Pufp+2jEDE=QR2A@mail.gmail.com>

On Tue, Sep 14, 2021 at 8:59 AM Howard Butler <howard at hobu.co> wrote:

> Dear PSC,
>
> As a result of our fundraising activity and development of NumFOCUS as a
> financial conduit, it is my pleasure to put forward a motion to approve
> Nyall Dawson as a contracted GDAL maintainer for the year 2021-2022
> beginning on October 1st, 2021 and ending September 30th, 2022.
>
> Details of the maintenance tasking and duties can be found at the
> previously approved RFC 83
> https://gdal.org/development/rfc/rfc83_use_of_project_sponsorship.html
>
> The terms of the contract are for a maximum of 500 hours at 90 ?/hr.
>
> Howard
>
> PS I will coordinating the contracting activity in my role as the GDAL
> NumFOCUS contracting liaison, with Frank Warmerdam acting as the secondary.
> Please contact us directly with any comments or concerns.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>

Excellent!

+1

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210914/fed7192e/attachment.html>

From Gaelle.Usseglio at cnes.fr  Wed Sep 15 06:45:07 2021
From: Gaelle.Usseglio at cnes.fr (Usseglio Gaelle (THALES SERVICES NUMERIQUES))
Date: Wed, 15 Sep 2021 13:45:07 +0000
Subject: [gdal-dev] [GDAL TerraSAR-X] TDX products
Message-ID: <E3A75CABE280ED498E9834103AC37285193393F0@TW-MBX-P01.cnesnet.ad.cnes.fr>

Hello,

I am using GDAL through OTB (the Orfeo Toolbox) to process TSX/TDX products with the specific driver: COSAR/COSAR Annotated Binary Matrix (TerraSAR-X).

With TSX products, the driver works fine.
I have also tried to read CoSAR files from TDX products. Data have a huge difference with a floating point data format instead of integer values. This floating format is a specific format called "Half Precision Floating Point" for each of the complex values. Thus, TDX products are not well-interpreted. Further information are available in TD-GS-PS-3028_TanDEM-X-Experimental-Product-Description_1.2. The annotations seem to be the same than TSX products.

I need your help to include this new format in GDAL and so in OTB.

As far as I can understand, the specific driver for CoSAR binaries is implemented in https://github.com/OSGeo/gdal/blob/master/gdal/frmts/cosar/cosar_dataset.cpp. The data type is set to GDT_CInt16. I think that explains why TDX are not well-interpreted. In my opinion, in order to include TDX products a conversion has to be made before assigning the buffer. I have found an algorithm to convert "half float" to single float : http://blog.schmorp.de/data/binary16/fasthalffloatconversion.pdf

Do you think, is it possible to implement this feature in GDAL?

Regards,
Ga?lle.

--------------------------------------------------------------------------------------------------------------
Ga?lle Usseglio -Thales Services
Responsable de prestation : Support HPC (Portages, Optimisations, Audits, Expertises, etc.)

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210915/5860f96b/attachment-0001.html>

From even.rouault at spatialys.com  Wed Sep 15 07:25:20 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 15 Sep 2021 16:25:20 +0200
Subject: [gdal-dev] [GDAL TerraSAR-X] TDX products
In-Reply-To: <E3A75CABE280ED498E9834103AC37285193393F0@TW-MBX-P01.cnesnet.ad.cnes.fr>
References: <E3A75CABE280ED498E9834103AC37285193393F0@TW-MBX-P01.cnesnet.ad.cnes.fr>
Message-ID: <f30e1c26-2cc1-6eed-a4b3-5a86de548db9@spatialys.com>

Ga?lle,
>
> Do you think, is it possible to implement this feature in GDAL?
>
Quite certainly. There are already routines to convert HalfFloat <--> 
Float32 in 
https://github.com/OSGeo/gdal/blob/master/gdal/frmts/gtiff/tif_float.h 
used by the GeoTIFF driver (quite esoteric feature in TIFF) and the new 
ZARR driver.

Even


-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210915/06c79e4b/attachment.html>

From stephane.brunner at camptocamp.com  Thu Sep 16 01:34:15 2021
From: stephane.brunner at camptocamp.com (=?UTF-8?Q?St=C3=A9phane_Brunner?=)
Date: Thu, 16 Sep 2021 10:34:15 +0200
Subject: [gdal-dev] Motion: Approve Nyall Dawson as a contracted GDAL
 maintainer
In-Reply-To: <CADPhZXzES4kRd+0cS97dCrgFYiJUoD1CGA4Pufp+2jEDE=QR2A@mail.gmail.com>
References: <DF43E85F-B1F2-4C65-B4A0-0A97A269864D@hobu.co>
 <CADPhZXzES4kRd+0cS97dCrgFYiJUoD1CGA4Pufp+2jEDE=QR2A@mail.gmail.com>
Message-ID: <CAChDcoQ_21XPa1DZT-2_=q+0epvkr7-N_KvDJXX-Z1ZR6Ep2nw@mail.gmail.com>

+1 :-)

Le mar. 14 sept. 2021 ? 23:58, Sean Gillies via gdal-dev <
gdal-dev at lists.osgeo.org> a ?crit :

> On Tue, Sep 14, 2021 at 8:59 AM Howard Butler <howard at hobu.co> wrote:
>
>> Dear PSC,
>>
>> As a result of our fundraising activity and development of NumFOCUS as a
>> financial conduit, it is my pleasure to put forward a motion to approve
>> Nyall Dawson as a contracted GDAL maintainer for the year 2021-2022
>> beginning on October 1st, 2021 and ending September 30th, 2022.
>>
>> Details of the maintenance tasking and duties can be found at the
>> previously approved RFC 83
>> https://gdal.org/development/rfc/rfc83_use_of_project_sponsorship.html
>>
>> The terms of the contract are for a maximum of 500 hours at 90 ?/hr.
>>
>> Howard
>>
>> PS I will coordinating the contracting activity in my role as the GDAL
>> NumFOCUS contracting liaison, with Frank Warmerdam acting as the secondary.
>> Please contact us directly with any comments or concerns.
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
> Excellent!
>
> +1
>
> --
> Sean Gillies
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 

*St?phane Brunner*
Geospatial Solutions
Software Developer

*camptocamp*
INNOVATIVE SOLUTIONS
BY OPEN SOURCE EXPERTS

camptocamp.com
mapfish.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210916/9b3f43a9/attachment.html>

From howard at hobu.co  Thu Sep 16 09:07:20 2021
From: howard at hobu.co (Howard Butler)
Date: Thu, 16 Sep 2021 11:07:20 -0500
Subject: [gdal-dev] Motion: Approve Nyall Dawson as a contracted GDAL
 maintainer
In-Reply-To: <DF43E85F-B1F2-4C65-B4A0-0A97A269864D@hobu.co>
References: <DF43E85F-B1F2-4C65-B4A0-0A97A269864D@hobu.co>
Message-ID: <6AF43695-34CE-47A4-A4E2-BA580D28B4F9@hobu.co>



> On Sep 14, 2021, at 9:59 AM, Howard Butler <howard at hobu.co> wrote:
> 
> Dear PSC,
> 
> As a result of our fundraising activity and development of NumFOCUS as a financial conduit, it is my pleasure to put forward a motion to approve Nyall Dawson as a contracted GDAL maintainer for the year 2021-2022 beginning on October 1st, 2021 and ending September 30th, 2022.
> 
> Details of the maintenance tasking and duties can be found at the previously approved RFC 83 https://gdal.org/development/rfc/rfc83_use_of_project_sponsorship.html
> 
> The terms of the contract are for a maximum of 500 hours at 90 ?/hr.
> 
> Howard
> 
> PS I will coordinating the contracting activity in my role as the GDAL NumFOCUS contracting liaison, with Frank Warmerdam acting as the secondary. Please contact us directly with any comments or concerns.

Declaring this one passed with what I think is all PSC members' affirmatives. I will start the NumFOCUS process to let the contract to Nyall.

Howard

From luipir at gmail.com  Thu Sep 16 09:24:25 2021
From: luipir at gmail.com (Luigi Pirelli)
Date: Thu, 16 Sep 2021 18:24:25 +0200
Subject: [gdal-dev] Motion: Approve Nyall Dawson as a contracted GDAL
 maintainer
In-Reply-To: <6AF43695-34CE-47A4-A4E2-BA580D28B4F9@hobu.co>
References: <DF43E85F-B1F2-4C65-B4A0-0A97A269864D@hobu.co>
 <6AF43695-34CE-47A4-A4E2-BA580D28B4F9@hobu.co>
Message-ID: <CAFO80_qMDH_FyWihcF8Zbnje3vFGy=tRceZK+M0BQBnjk0yPMg@mail.gmail.com>

congrat Nyall and GDAL to have a so qualified maintainer :)

Luigi Pirelli

**************************************************************************************************
* LinkedIn: https://www.linkedin.com/in/luigipirelli
* Stackexchange: http://gis.stackexchange.com/users/19667/luigi-pirelli
* GitHub: https://github.com/luipir
* Book: Mastering QGIS3 - 3rd Edition
<https://www.packtpub.com/eu/application-development/mastering-geospatial-development-qgis-3x-third-edition>
* Hire a team: http://www.qcooperative.net
**************************************************************************************************


On Thu, 16 Sept 2021 at 18:07, Howard Butler <howard at hobu.co> wrote:

>
>
> > On Sep 14, 2021, at 9:59 AM, Howard Butler <howard at hobu.co> wrote:
> >
> > Dear PSC,
> >
> > As a result of our fundraising activity and development of NumFOCUS as a
> financial conduit, it is my pleasure to put forward a motion to approve
> Nyall Dawson as a contracted GDAL maintainer for the year 2021-2022
> beginning on October 1st, 2021 and ending September 30th, 2022.
> >
> > Details of the maintenance tasking and duties can be found at the
> previously approved RFC 83
> https://gdal.org/development/rfc/rfc83_use_of_project_sponsorship.html
> >
> > The terms of the contract are for a maximum of 500 hours at 90 ?/hr.
> >
> > Howard
> >
> > PS I will coordinating the contracting activity in my role as the GDAL
> NumFOCUS contracting liaison, with Frank Warmerdam acting as the secondary.
> Please contact us directly with any comments or concerns.
>
> Declaring this one passed with what I think is all PSC members'
> affirmatives. I will start the NumFOCUS process to let the contract to
> Nyall.
>
> Howard
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210916/1f4846b4/attachment.html>

From me at komzpa.net  Thu Sep 16 09:35:24 2021
From: me at komzpa.net (=?UTF-8?Q?Darafei_=22Kom=D1=8Fpa=22_Praliaskouski?=)
Date: Thu, 16 Sep 2021 19:35:24 +0300
Subject: [gdal-dev] HANA driver proposal
In-Reply-To: <AM4PR02MB31237E1328F4D1F08D47C66BF7DA9@AM4PR02MB3123.eurprd02.prod.outlook.com>
References: <AM4PR02MB31237E1328F4D1F08D47C66BF7DA9@AM4PR02MB3123.eurprd02.prod.outlook.com>
Message-ID: <CAC8Q8tJxO5QSkYsP3cP=kGGzXFD4iRD5sqembMOnwdHdrrnsaA@mail.gmail.com>

Dear Maxim,

This is a mailing list. A lot of people read your emails. The emails are
threaded here.
There is no obligation for anyone to reply the emails, if the thing you're
doing is not fun for them.

Can HANA support Postgres wire protocol instead? This will enable a lot
more compatibility for stuff out of the box, just like it did for Amazon's
databases.

On Tue, Sep 14, 2021 at 10:44 AM Rylov, Maxim via gdal-dev <
gdal-dev at lists.osgeo.org> wrote:

> Dear Even,
>
> We haven?t received any reply on our last e-mail from 17th of August
> regarding the HANA driver.
>
> We would be grateful if you could answer our questions.
>
> Thank you and kind regards,
>
> Maxim Rylov on behalf of the HANA Spatial Team
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210916/b128e4e9/attachment.html>

From nyall.dawson at gmail.com  Thu Sep 16 21:06:08 2021
From: nyall.dawson at gmail.com (Nyall Dawson)
Date: Fri, 17 Sep 2021 14:06:08 +1000
Subject: [gdal-dev] Motion: Approve Nyall Dawson as a contracted GDAL
 maintainer
In-Reply-To: <6AF43695-34CE-47A4-A4E2-BA580D28B4F9@hobu.co>
References: <DF43E85F-B1F2-4C65-B4A0-0A97A269864D@hobu.co>
 <6AF43695-34CE-47A4-A4E2-BA580D28B4F9@hobu.co>
Message-ID: <CAB28Asi11hFKqR+L35bicQE+RTXGGJ81qkX_35cQnRmXiegkUA@mail.gmail.com>

On Fri, 17 Sept 2021 at 02:07, Howard Butler <howard at hobu.co> wrote:
>
>
>
> > On Sep 14, 2021, at 9:59 AM, Howard Butler <howard at hobu.co> wrote:
> >
> > Dear PSC,
> >
> > As a result of our fundraising activity and development of NumFOCUS as a financial conduit, it is my pleasure to put forward a motion to approve Nyall Dawson as a contracted GDAL maintainer for the year 2021-2022 beginning on October 1st, 2021 and ending September 30th, 2022.
> >
> > Details of the maintenance tasking and duties can be found at the previously approved RFC 83 https://gdal.org/development/rfc/rfc83_use_of_project_sponsorship.html
> >
> > The terms of the contract are for a maximum of 500 hours at 90 ?/hr.
> >
> > Howard
> >
> > PS I will coordinating the contracting activity in my role as the GDAL NumFOCUS contracting liaison, with Frank Warmerdam acting as the secondary. Please contact us directly with any comments or concerns.
>
> Declaring this one passed with what I think is all PSC members' affirmatives. I will start the NumFOCUS process to let the contract to Nyall.

Thank you all for considering me for this work -- I'm seriously
honored to be a part of something as important and well respected as
this GDAL team!

Nyall

From jukka.rahkonen at maanmittauslaitos.fi  Thu Sep 16 23:28:53 2021
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Fri, 17 Sep 2021 06:28:53 +0000
Subject: [gdal-dev] Geoserver 2.20.RC generating high CPU load
Message-ID: <8bcf10251fdd46fdaf9ec25b9691db5f@maanmittauslaitos.fi>

Hi,

I installed and started GS 2.20 yesterday on Windows and now the corresponding OpenJDK 11 process shows constant high CPU usage (12-17%). Service is started at localhost:8080 and I do not generate any requests for the service. I do not understand what happens and how to investigate the situation. Any suggestions?

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210917/5c9be16c/attachment.html>

From andrea.aime at geo-solutions.it  Thu Sep 16 23:40:50 2021
From: andrea.aime at geo-solutions.it (Andrea Aime)
Date: Fri, 17 Sep 2021 08:40:50 +0200
Subject: [gdal-dev] Geoserver 2.20.RC generating high CPU load
In-Reply-To: <8bcf10251fdd46fdaf9ec25b9691db5f@maanmittauslaitos.fi>
References: <8bcf10251fdd46fdaf9ec25b9691db5f@maanmittauslaitos.fi>
Message-ID: <CALHQADWjJQLmtKVrrN5Yy+_hFvtEQX8eps49ucVbf6C6+M9=OA@mail.gmail.com>

Hi Jukka,
try to get the pid of the process and run a "jstack <pid>", let's see what
happens.
Btw, wrong mailing list :-D

Cheers
Andrea

On Fri, Sep 17, 2021 at 8:29 AM Rahkonen Jukka (MML) <
jukka.rahkonen at maanmittauslaitos.fi> wrote:

> Hi,
>
>
>
> I installed and started GS 2.20 yesterday on Windows and now the
> corresponding OpenJDK 11 process shows constant high CPU usage (12-17%).
> Service is started at localhost:8080 and I do not generate any requests for
> the service. I do not understand what happens and how to investigate the
> situation. Any suggestions?
>
>
>
> -Jukka Rahkonen-
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210917/0314a8fd/attachment.html>

From bfraser at geoanalytic.com  Fri Sep 17 14:03:26 2021
From: bfraser at geoanalytic.com (Brent Fraser)
Date: Fri, 17 Sep 2021 15:03:26 -0600
Subject: [gdal-dev] profiles in gdal2tiles.py
Message-ID: <a87f2830d8e44cbbbb577e2a1fd0becd@geoanalytic.com>

Hi All,

I'm interested in experimenting with creating tile sets in various coordinate systems (other than the usual EPSG:3857 and EPSG:4326).  The good news is that it looks like as of GDAL v3.2 gdal2tiles.py supports a "profile" option for defining the tile set including the coordinate system.

The profile is in JSON with all the detail gdal2tiles would require to create tiles (example: https://github.com/OSGeo/gdal/blob/master/gdal/data/tms_MapML_APSTILE.json)

I suppose I could create a profile JSON file by hand (or do some coding) but I thought I would ask if there was an existing tool?

Thanks!
Brent Fraser

 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210917/2e8bcc0d/attachment.html>

From even.rouault at spatialys.com  Fri Sep 17 14:57:42 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 17 Sep 2021 23:57:42 +0200
Subject: [gdal-dev] profiles in gdal2tiles.py
In-Reply-To: <a87f2830d8e44cbbbb577e2a1fd0becd@geoanalytic.com>
References: <a87f2830d8e44cbbbb577e2a1fd0becd@geoanalytic.com>
Message-ID: <0a59b312-f7e1-45ba-ae58-e0e86321a0ec@spatialys.com>


Le 17/09/2021 ? 23:03, Brent Fraser a ?crit?:
> Hi All,
>
> I'm interested in experimenting with creating tile sets in various 
> coordinate systems (other than the usual EPSG:3857 and EPSG:4326). 
> ?The good news is that it looks like as of GDAL v3.2 gdal2tiles.py 
> supports a "profile" option for defining the tile set including the 
> coordinate system.
>
> The profile is in JSON with all the detail gdal2tiles would require to 
> create tiles (example: 
> https://github.com/OSGeo/gdal/blob/master/gdal/data/tms_MapML_APSTILE.json 
> <https://github.com/OSGeo/gdal/blob/master/gdal/data/tms_MapML_APSTILE.json>)
This follows the JSON encoding of the OGC Two Dimensional Tile Matrix 
Set? specification: 
https://docs.opengeospatial.org/is/17-083r2/17-083r2.html
>
> I suppose I could create a profile JSON file by hand (or do some 
> coding) but I thought I would ask if there was an existing tool?
Not that I'm aware of. A few lines of Python should be enough to create 
a profile with zoom levels varying by a factor of 2 for the resolution, 
which is currently a constraint for the profile to be accepted by 
gdal2tiles.
>
> Thanks!
> Brent Fraser
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210917/a53d234d/attachment.html>

From patrick.mckendree.young at gmail.com  Fri Sep 17 16:06:36 2021
From: patrick.mckendree.young at gmail.com (Patrick Young)
Date: Fri, 17 Sep 2021 17:06:36 -0600
Subject: [gdal-dev] gdalwarp alpha band resampling bug
Message-ID: <CADXYQQ7=8+i-CCUjwX_pTLC3g_ECfMV7RtAR7ULwbsd+fQhGGA@mail.gmail.com>

Hello,

I've found behavior in gdalwarp related to compositing an image with a
variable alpha band.  Under bilinear resampling, the alpha compositing in
areas where the alpha band is between 0 and 255 results in completely white
pixels.

To reproduce, I've first grabbed a rgba image from the test suite, e.g.:

wget
https://github.com/OSGeo/gdal/raw/a2db646d1c34905e47eb21657284b529b7478d66/autotest/gcore/data/stefan_full_rgba.tif

Then,

gdal_create -ot Byte -bands 3 -burn 71 147 240 -outsize 162 150 -a_srs
EPSG:3857 -a_ullr 0 162 150 0 background.tif
gdal_translate -a_srs EPSG:3857 -a_ullr 0 162 150 0 stefan_full_rgba.tif
foreground.tif
gdalwarp -r bilinear background.tif foreground.tif composite-bl.tif

In this case, composite-bl.tif is white wherever the alpha is in [1, 254].
Trying

gdalwarp background.tif foreground.tif composite-nn.tif

produces a reasonable image, although it is blocker than when I overlay
background.tif and foreground.tif in qgis.

Thanks for any tips about what I'm seeing, happy to file a bug if it is
one!  I've tested this on gdal 3.2.2 on macos (from brew).
Patrick
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210917/e0dd692e/attachment.html>

From even.rouault at spatialys.com  Fri Sep 17 16:18:40 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 18 Sep 2021 01:18:40 +0200
Subject: [gdal-dev] gdalwarp alpha band resampling bug
In-Reply-To: <CADXYQQ7=8+i-CCUjwX_pTLC3g_ECfMV7RtAR7ULwbsd+fQhGGA@mail.gmail.com>
References: <CADXYQQ7=8+i-CCUjwX_pTLC3g_ECfMV7RtAR7ULwbsd+fQhGGA@mail.gmail.com>
Message-ID: <1313d4a1-b611-d122-06b5-6e5897e42124@spatialys.com>

I can't reproduce the issue you describe. There's not a single white 
pixel in the output image (the max of the green and blue bands is < 
255). But I suspect this could be related to a pre-existing 
composite-bl.tif file you might have. gdalwarp doesn't overwrite by 
default the output image. It blends into it. If you add -overwrite, you 
should get a reasonable output.

Le 18/09/2021 ? 01:06, Patrick Young a ?crit?:
> Hello,
>
> I've found behavior in gdalwarp related to compositing an image with a 
> variable alpha band.? Under bilinear resampling, the alpha compositing 
> in areas where the alpha band is between 0 and 255 results in 
> completely white pixels.
>
> To reproduce, I've first grabbed a rgba image from the test suite, e.g.:
>
> wget 
> https://github.com/OSGeo/gdal/raw/a2db646d1c34905e47eb21657284b529b7478d66/autotest/gcore/data/stefan_full_rgba.tif 
> <https://github.com/OSGeo/gdal/raw/a2db646d1c34905e47eb21657284b529b7478d66/autotest/gcore/data/stefan_full_rgba.tif>
>
> Then,
>
> gdal_create -ot Byte -bands 3 -burn 71 147 240 -outsize 162 150 -a_srs 
> EPSG:3857 -a_ullr 0 162 150 0 background.tif
> gdal_translate -a_srs EPSG:3857 -a_ullr 0 162 150 0 
> stefan_full_rgba.tif foreground.tif
> gdalwarp -r bilinear background.tif foreground.tif composite-bl.tif
>
> In this case, composite-bl.tif is white wherever the alpha is in [1, 
> 254].? Trying
>
> gdalwarp background.tif foreground.tif composite-nn.tif
>
> produces a reasonable image, although it is blocker than when I 
> overlay background.tif and foreground.tif in qgis.
>
> Thanks for any tips about what I'm seeing, happy to file a bug if it 
> is one!? I've tested this on gdal 3.2.2 on macos (from brew).
> Patrick
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210918/dd894a3f/attachment.html>

From patrick.mckendree.young at gmail.com  Fri Sep 17 19:51:04 2021
From: patrick.mckendree.young at gmail.com (Patrick Young)
Date: Fri, 17 Sep 2021 20:51:04 -0600
Subject: [gdal-dev] gdalwarp alpha band resampling bug
In-Reply-To: <1313d4a1-b611-d122-06b5-6e5897e42124@spatialys.com>
References: <CADXYQQ7=8+i-CCUjwX_pTLC3g_ECfMV7RtAR7ULwbsd+fQhGGA@mail.gmail.com>
 <1313d4a1-b611-d122-06b5-6e5897e42124@spatialys.com>
Message-ID: <CADXYQQ7R5fkfq=c8pfZip2T9Rk18zA_s8CwUqDE+BmKo-V8Lvw@mail.gmail.com>

Hi Even,

Thanks for checking!  I tried this in a docker container (osgeo/gdal) and
sure enough, the output looks fine there.

It reproduces for me with my brew installed gdal (3.3.2) and I was careful
to do everything in a clean directory.  I tried a few other outputs as well
(png, jpeg) and the toucan remains surrounded by white.  I also had a
colleague check (he is also on a mac, using a brew installed GDAL 3.3.0)
and he sees the same artifact that I see.

I have no idea what could be causing it!  Interestingly, if the background
raster is (255, 0, 0), you don't get the white everywhere, but instead you
get solid red wherever the alpha is in [1,254].  I wonder what it could be!

Best,
Patrick



On Fri, Sep 17, 2021 at 5:18 PM Even Rouault <even.rouault at spatialys.com>
wrote:

> I can't reproduce the issue you describe. There's not a single white pixel
> in the output image (the max of the green and blue bands is < 255). But I
> suspect this could be related to a pre-existing composite-bl.tif file you
> might have. gdalwarp doesn't overwrite by default the output image. It
> blends into it. If you add -overwrite, you should get a reasonable output.
> Le 18/09/2021 ? 01:06, Patrick Young a ?crit :
>
> Hello,
>
> I've found behavior in gdalwarp related to compositing an image with a
> variable alpha band.  Under bilinear resampling, the alpha compositing in
> areas where the alpha band is between 0 and 255 results in completely white
> pixels.
>
> To reproduce, I've first grabbed a rgba image from the test suite, e.g.:
>
> wget
> https://github.com/OSGeo/gdal/raw/a2db646d1c34905e47eb21657284b529b7478d66/autotest/gcore/data/stefan_full_rgba.tif
>
> Then,
>
> gdal_create -ot Byte -bands 3 -burn 71 147 240 -outsize 162 150 -a_srs
> EPSG:3857 -a_ullr 0 162 150 0 background.tif
> gdal_translate -a_srs EPSG:3857 -a_ullr 0 162 150 0 stefan_full_rgba.tif
> foreground.tif
> gdalwarp -r bilinear background.tif foreground.tif composite-bl.tif
>
> In this case, composite-bl.tif is white wherever the alpha is in [1,
> 254].  Trying
>
> gdalwarp background.tif foreground.tif composite-nn.tif
>
> produces a reasonable image, although it is blocker than when I overlay
> background.tif and foreground.tif in qgis.
>
> Thanks for any tips about what I'm seeing, happy to file a bug if it is
> one!  I've tested this on gdal 3.2.2 on macos (from brew).
> Patrick
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210917/ae0acc3f/attachment-0001.html>

From patrick.mckendree.young at gmail.com  Fri Sep 17 20:08:38 2021
From: patrick.mckendree.young at gmail.com (Patrick Young)
Date: Fri, 17 Sep 2021 21:08:38 -0600
Subject: [gdal-dev] gdalwarp alpha band resampling bug
In-Reply-To: <CADXYQQ7R5fkfq=c8pfZip2T9Rk18zA_s8CwUqDE+BmKo-V8Lvw@mail.gmail.com>
References: <CADXYQQ7=8+i-CCUjwX_pTLC3g_ECfMV7RtAR7ULwbsd+fQhGGA@mail.gmail.com>
 <1313d4a1-b611-d122-06b5-6e5897e42124@spatialys.com>
 <CADXYQQ7R5fkfq=c8pfZip2T9Rk18zA_s8CwUqDE+BmKo-V8Lvw@mail.gmail.com>
Message-ID: <CADXYQQ4tQW77u2j93g_idm_ajzzYB6EtEeh9dGR2TEO9bpMroQ@mail.gmail.com>

One more data point; another colleague who is on a mac but built gdal
himself instead of using brew does not see the artifact, so I suppose the
lesson is, build your own gdal!

Best,
P

On Fri, Sep 17, 2021 at 8:51 PM Patrick Young <
patrick.mckendree.young at gmail.com> wrote:

> Hi Even,
>
> Thanks for checking!  I tried this in a docker container (osgeo/gdal) and
> sure enough, the output looks fine there.
>
> It reproduces for me with my brew installed gdal (3.3.2) and I was careful
> to do everything in a clean directory.  I tried a few other outputs as well
> (png, jpeg) and the toucan remains surrounded by white.  I also had a
> colleague check (he is also on a mac, using a brew installed GDAL 3.3.0)
> and he sees the same artifact that I see.
>
> I have no idea what could be causing it!  Interestingly, if the background
> raster is (255, 0, 0), you don't get the white everywhere, but instead you
> get solid red wherever the alpha is in [1,254].  I wonder what it could be!
>
> Best,
> Patrick
>
>
>
> On Fri, Sep 17, 2021 at 5:18 PM Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> I can't reproduce the issue you describe. There's not a single white
>> pixel in the output image (the max of the green and blue bands is < 255).
>> But I suspect this could be related to a pre-existing composite-bl.tif file
>> you might have. gdalwarp doesn't overwrite by default the output image. It
>> blends into it. If you add -overwrite, you should get a reasonable output.
>> Le 18/09/2021 ? 01:06, Patrick Young a ?crit :
>>
>> Hello,
>>
>> I've found behavior in gdalwarp related to compositing an image with a
>> variable alpha band.  Under bilinear resampling, the alpha compositing in
>> areas where the alpha band is between 0 and 255 results in completely white
>> pixels.
>>
>> To reproduce, I've first grabbed a rgba image from the test suite, e.g.:
>>
>> wget
>> https://github.com/OSGeo/gdal/raw/a2db646d1c34905e47eb21657284b529b7478d66/autotest/gcore/data/stefan_full_rgba.tif
>>
>> Then,
>>
>> gdal_create -ot Byte -bands 3 -burn 71 147 240 -outsize 162 150 -a_srs
>> EPSG:3857 -a_ullr 0 162 150 0 background.tif
>> gdal_translate -a_srs EPSG:3857 -a_ullr 0 162 150 0 stefan_full_rgba.tif
>> foreground.tif
>> gdalwarp -r bilinear background.tif foreground.tif composite-bl.tif
>>
>> In this case, composite-bl.tif is white wherever the alpha is in [1,
>> 254].  Trying
>>
>> gdalwarp background.tif foreground.tif composite-nn.tif
>>
>> produces a reasonable image, although it is blocker than when I overlay
>> background.tif and foreground.tif in qgis.
>>
>> Thanks for any tips about what I'm seeing, happy to file a bug if it is
>> one!  I've tested this on gdal 3.2.2 on macos (from brew).
>> Patrick
>>
>> _______________________________________________
>> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>> -- http://www.spatialys.com
>> My software is free, but my time generally not.
>>
>>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210917/c1bf1540/attachment.html>

From andreaerdna at libero.it  Mon Sep 20 02:11:14 2021
From: andreaerdna at libero.it (Andrea Giudiceandrea)
Date: Mon, 20 Sep 2021 11:11:14 +0200
Subject: [gdal-dev] TIF + TFW to GeoTIFF without decompression/recompression
Message-ID: <19a9d354-44ee-0151-5949-8ba1d861c26e@libero.it>

Hi devs,
gdal_transalte has an "hidden" feature (not mentioned in the docs [1]), 
introduced since GDAL 1.10 [2], which allows to convert .JPG + .JPW 
raster layer to GeoTIFF without decompressing and recompressing the 
raster image (a so called "lossless conversion of JPEG into 
JPEG-in-TIFF" [3]).

It seem to me the same is not possible if the source is a .TIF (e.g. a 
JPEG-in-TIFF) + .TFW raster layer. In this case the image is always 
decompressed and then recompressed if a compression method is specified, 
thus adding another unnecessary lossy step.

I think the decompression / recompression cycle should obviously not be 
needed converting a TIFF file to a GeoTIFF file (unless image 
manipulation options are specified) and gdal_transalte should just copy 
the source TIF file and add the proper GeoTIFF metadata tags taken from 
the TFW file and from the -a_srs parameter.

Maybe is there any other "hidden" feature I haven't been able to find yet?

Best regards.

Andrea Giudiceandrea


[1] https://github.com/OSGeo/gdal/issues/4510
[2] 
https://github.com/OSGeo/gdal/commit/a77c726484d508f1ffff2b9f5a9a869313092687
[3] 
https://erouault.blogspot.com/2014/04/advanced-jpeg-in-tiff-uses-in-gdal.html


Side notes:

I know gdal_edit could also be used, but it cannot automatically take 
the georeferencing parameters from the TFW file.

It could also be possible to use the geotifcp cli tool from libgeotiff, 
but it seems it (the one shipped by OSGeo4W) has some issues handling 
JPEG-in-TIFF files (while it works well with other compression formats): 
the "Warning, fractional scanline discarded." and "JPEGLib: Application 
transferred too few scanlines." errors are reported unsuccessfully 
trying to convert a JPEG-in-TIFF + TFW to a GeoTIFF.

Instead, the very old and almost nowhere to be found GeoTiffExamin gui 
tool can just add the proper GeoTIFF metadata tags, taken from the TFW 
file, to a TIFF file without modifying the raster image. Anyway the gui 
tool cannot be used for batch conversion.

From jukka.rahkonen at maanmittauslaitos.fi  Mon Sep 20 02:23:38 2021
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Mon, 20 Sep 2021 09:23:38 +0000
Subject: [gdal-dev] TIF + TFW to GeoTIFF without
 decompression/recompression
Message-ID: <3b0fc66453454544b92b82d83f64708b@maanmittauslaitos.fi>

Hi,

Have you considered to use https://gdal.org/programs/gdal_edit.html?

-Jukka Rahkonen-

-----Alkuper?inen viesti-----
L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Andrea Giudiceandrea via gdal-dev
L?hetetty: maanantai 20. syyskuuta 2021 12.11
Vastaanottaja: gdal-dev at lists.osgeo.org
Aihe: [gdal-dev] TIF + TFW to GeoTIFF without decompression/recompression

Hi devs,
gdal_transalte has an "hidden" feature (not mentioned in the docs [1]), introduced since GDAL 1.10 [2], which allows to convert .JPG + .JPW raster layer to GeoTIFF without decompressing and recompressing the raster image (a so called "lossless conversion of JPEG into JPEG-in-TIFF" [3]).

It seem to me the same is not possible if the source is a .TIF (e.g. a
JPEG-in-TIFF) + .TFW raster layer. In this case the image is always decompressed and then recompressed if a compression method is specified, thus adding another unnecessary lossy step.

I think the decompression / recompression cycle should obviously not be needed converting a TIFF file to a GeoTIFF file (unless image manipulation options are specified) and gdal_transalte should just copy the source TIF file and add the proper GeoTIFF metadata tags taken from the TFW file and from the -a_srs parameter.

Maybe is there any other "hidden" feature I haven't been able to find yet?

Best regards.

Andrea Giudiceandrea


[1] https://github.com/OSGeo/gdal/issues/4510
[2]
https://github.com/OSGeo/gdal/commit/a77c726484d508f1ffff2b9f5a9a869313092687
[3]
https://erouault.blogspot.com/2014/04/advanced-jpeg-in-tiff-uses-in-gdal.html


Side notes:

I know gdal_edit could also be used, but it cannot automatically take the georeferencing parameters from the TFW file.

It could also be possible to use the geotifcp cli tool from libgeotiff, but it seems it (the one shipped by OSGeo4W) has some issues handling JPEG-in-TIFF files (while it works well with other compression formats): 
the "Warning, fractional scanline discarded." and "JPEGLib: Application transferred too few scanlines." errors are reported unsuccessfully trying to convert a JPEG-in-TIFF + TFW to a GeoTIFF.

Instead, the very old and almost nowhere to be found GeoTiffExamin gui tool can just add the proper GeoTIFF metadata tags, taken from the TFW file, to a TIFF file without modifying the raster image. Anyway the gui tool cannot be used for batch conversion.
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at spatialys.com  Mon Sep 20 02:28:26 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 20 Sep 2021 11:28:26 +0200
Subject: [gdal-dev] TIF + TFW to GeoTIFF without
 decompression/recompression
In-Reply-To: <19a9d354-44ee-0151-5949-8ba1d861c26e@libero.it>
References: <19a9d354-44ee-0151-5949-8ba1d861c26e@libero.it>
Message-ID: <4a1e5713-6ad4-1366-539e-ae4ea22896ac@spatialys.com>

Andrea,

Le 20/09/2021 ? 11:11, Andrea Giudiceandrea via gdal-dev a ?crit?:
> Hi devs,
> gdal_transalte has an "hidden" feature (not mentioned in the docs 
> [1]), introduced since GDAL 1.10 [2], which allows to convert .JPG + 
> .JPW raster layer to GeoTIFF without decompressing and recompressing 
> the raster image (a so called "lossless conversion of JPEG into 
> JPEG-in-TIFF" [3]).
>
> It seem to me the same is not possible if the source is a .TIF (e.g. a 
> JPEG-in-TIFF) + .TFW raster layer. In this case the image is always 
> decompressed and then recompressed if a compression method is 
> specified, thus adding another unnecessary lossy step.
>
> I think the decompression / recompression cycle should obviously not 
> be needed converting a TIFF file to a GeoTIFF file (unless image 
> manipulation options are specified) and gdal_transalte should just 
> copy the source TIF file and add the proper GeoTIFF metadata tags 
> taken from the TFW file and from the -a_srs parameter.
>
> Maybe is there any other "hidden" feature I haven't been able to find 
> yet?
No, this is not implemented.? As you mention below gdal_edit, you could 
likely do a small script (or an enhancement of gdal_edit that has a 
-worldfile {filename} option)) to call SetGeoTransform() with a 
geotransform computed from the worldfile content
>
> Best regards.
>
> Andrea Giudiceandrea
>
>
> [1] https://github.com/OSGeo/gdal/issues/4510
> [2] 
> https://github.com/OSGeo/gdal/commit/a77c726484d508f1ffff2b9f5a9a869313092687
> [3] 
> https://erouault.blogspot.com/2014/04/advanced-jpeg-in-tiff-uses-in-gdal.html
>
>
> Side notes:
>
> I know gdal_edit could also be used, but it cannot automatically take 
> the georeferencing parameters from the TFW file.
>
> It could also be possible to use the geotifcp cli tool from 
> libgeotiff, but it seems it (the one shipped by OSGeo4W) has some 
> issues handling JPEG-in-TIFF files (while it works well with other 
> compression formats): the "Warning, fractional scanline discarded." 
> and "JPEGLib: Application transferred too few scanlines." errors are 
> reported unsuccessfully trying to convert a JPEG-in-TIFF + TFW to a 
> GeoTIFF.
>
> Instead, the very old and almost nowhere to be found GeoTiffExamin gui 
> tool can just add the proper GeoTIFF metadata tags, taken from the TFW 
> file, to a TIFF file without modifying the raster image. Anyway the 
> gui tool cannot be used for batch conversion.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From jukka.rahkonen at maanmittauslaitos.fi  Mon Sep 20 04:20:36 2021
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Mon, 20 Sep 2021 11:20:36 +0000
Subject: [gdal-dev] TIF + TFW to GeoTIFF without
 decompression/recompression
Message-ID: <d48017915895474f81169f5064ef0f04@maanmittauslaitos.fi>

Hi,

Sorry for not reading your mail till the end after the signature.

I was wondering now if gdal_merge.py with the -createonly option could be useful for a user like me who can't program can use workarounds. However, for some reason the final step with geotifcp fails.

I first checked that combining baseline.tif and baseline.tfw succeeds and it did.
geotifcp  -e baseline.tfw baseline.tif baseline_plus_geo.tif

Creating an empty geotif with gdal_merge is fast
gdal_merge -o mergetest.tif -createonly geotiff.tif

Copying GeoTIFF tags with the -g option fails always. I tried also non-empty GeoTIFFs as the source for the metadata.
geotifcp  -g mergetest.tif baseline.tif baseline_plus_merge.tif
mode=w
geo_print.c DefaultRead failed to read anything.
Failure in GTIFImport

-Jukka Rahkonen-




-----Alkuper?inen viesti-----
L?hett?j?: Rahkonen Jukka (MML) 
L?hetetty: maanantai 20. syyskuuta 2021 12.24
Vastaanottaja: 'Andrea Giudiceandrea' <andreaerdna at libero.it>
Kopio: 'gdal-dev at lists.osgeo.org' <gdal-dev at lists.osgeo.org>
Aihe: Re: [gdal-dev] TIF + TFW to GeoTIFF without decompression/recompression

Hi,

Have you considered to use https://gdal.org/programs/gdal_edit.html?

-Jukka Rahkonen-

-----Alkuper?inen viesti-----
L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Andrea Giudiceandrea via gdal-dev
L?hetetty: maanantai 20. syyskuuta 2021 12.11
Vastaanottaja: gdal-dev at lists.osgeo.org
Aihe: [gdal-dev] TIF + TFW to GeoTIFF without decompression/recompression

Hi devs,
gdal_transalte has an "hidden" feature (not mentioned in the docs [1]), introduced since GDAL 1.10 [2], which allows to convert .JPG + .JPW raster layer to GeoTIFF without decompressing and recompressing the raster image (a so called "lossless conversion of JPEG into JPEG-in-TIFF" [3]).

It seem to me the same is not possible if the source is a .TIF (e.g. a
JPEG-in-TIFF) + .TFW raster layer. In this case the image is always decompressed and then recompressed if a compression method is specified, thus adding another unnecessary lossy step.

I think the decompression / recompression cycle should obviously not be needed converting a TIFF file to a GeoTIFF file (unless image manipulation options are specified) and gdal_transalte should just copy the source TIF file and add the proper GeoTIFF metadata tags taken from the TFW file and from the -a_srs parameter.

Maybe is there any other "hidden" feature I haven't been able to find yet?

Best regards.

Andrea Giudiceandrea


[1] https://github.com/OSGeo/gdal/issues/4510
[2]
https://github.com/OSGeo/gdal/commit/a77c726484d508f1ffff2b9f5a9a869313092687
[3]
https://erouault.blogspot.com/2014/04/advanced-jpeg-in-tiff-uses-in-gdal.html


Side notes:

I know gdal_edit could also be used, but it cannot automatically take the georeferencing parameters from the TFW file.

It could also be possible to use the geotifcp cli tool from libgeotiff, but it seems it (the one shipped by OSGeo4W) has some issues handling JPEG-in-TIFF files (while it works well with other compression formats): 
the "Warning, fractional scanline discarded." and "JPEGLib: Application transferred too few scanlines." errors are reported unsuccessfully trying to convert a JPEG-in-TIFF + TFW to a GeoTIFF.

Instead, the very old and almost nowhere to be found GeoTiffExamin gui tool can just add the proper GeoTIFF metadata tags, taken from the TFW file, to a TIFF file without modifying the raster image. Anyway the gui tool cannot be used for batch conversion.
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev

From craig.leat at gmail.com  Mon Sep 20 12:44:13 2021
From: craig.leat at gmail.com (Craig Leat)
Date: Mon, 20 Sep 2021 21:44:13 +0200
Subject: [gdal-dev] Building mrsid autoload driver
Message-ID: <CAAPVWe5HC0Gpve-CNdXmUXTNyxmXoQzpQROKt9wY7LFEzO4smg@mail.gmail.com>

Hi,

I have gdal-3.0.4 installed on ubuntu 20.04. I require support for mrsid
format.
I wish to build the mrsid driver plugin only and hopefully avoid building
gdal.

I tried:
$ cd src/gdal-3.0.4+dfsg/frmts/mrsid/pkg
$ ./configure --with-gdal=/usr/bin/gdal-config
--with-mrsid=/opt/MrSID_DSDK-9.5.4.4709-rhel6.x86-64.gcc531/Raster_DSDK
--with-jp2mrsid=no --with-geotiff=../../gtiff/libgeotiff
...
checking for lt_base.h in
/opt/MrSID_DSDK-9.5.4.4709-rhel6.x86-64.gcc531/Raster_DSDK/include... found
MrSID DSDK version 7.x or newer.
checking for MG3ImageWriter.h in
/opt/MrSID_DSDK-9.5.4.4709-rhel6.x86-64.gcc531/Raster_DSDK/include/mrsid_writers...
no encoding support.
checking for MrSID JPEG2000 support... disabled
checking for XTIFFClientOpen in -lgeotiff... no
checking for XTIFFClientOpen in -lgeotiff... (cached) no
configure: error: libgeotiff is required to build GDAL MrSID driver

Should this work?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210920/10911bd2/attachment.html>

From even.rouault at spatialys.com  Mon Sep 20 12:48:06 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 20 Sep 2021 21:48:06 +0200
Subject: [gdal-dev] Building mrsid autoload driver
In-Reply-To: <CAAPVWe5HC0Gpve-CNdXmUXTNyxmXoQzpQROKt9wY7LFEzO4smg@mail.gmail.com>
References: <CAAPVWe5HC0Gpve-CNdXmUXTNyxmXoQzpQROKt9wY7LFEzO4smg@mail.gmail.com>
Message-ID: <6b558517-a016-5d52-bbed-9ef206ce7c30@spatialys.com>

untested: If not already done, "apt install libgeotiff-dev"? and drop 
the --with-geotiff switch

Le 20/09/2021 ? 21:44, Craig Leat a ?crit?:
> Hi,
>
> I have gdal-3.0.4 installed on ubuntu 20.04. I require support for 
> mrsid format.
> I wish to build the mrsid driver plugin only and hopefully avoid 
> building gdal.
>
> I tried:
> $ cd src/gdal-3.0.4+dfsg/frmts/mrsid/pkg
> $ ./configure --with-gdal=/usr/bin/gdal-config 
> --with-mrsid=/opt/MrSID_DSDK-9.5.4.4709-rhel6.x86-64.gcc531/Raster_DSDK 
> --with-jp2mrsid=no --with-geotiff=../../gtiff/libgeotiff
> ...
> checking for lt_base.h in 
> /opt/MrSID_DSDK-9.5.4.4709-rhel6.x86-64.gcc531/Raster_DSDK/include... 
> found MrSID DSDK version 7.x or newer.
> checking for MG3ImageWriter.h in 
> /opt/MrSID_DSDK-9.5.4.4709-rhel6.x86-64.gcc531/Raster_DSDK/include/mrsid_writers... 
> no encoding support.
> checking for MrSID JPEG2000 support... disabled
> checking for XTIFFClientOpen in -lgeotiff... no
> checking for XTIFFClientOpen in -lgeotiff... (cached) no
> configure: error: libgeotiff is required to build GDAL MrSID driver
>
> Should this work?
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210920/77619cc4/attachment.html>

From even.rouault at spatialys.com  Tue Sep 21 04:12:35 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 21 Sep 2021 13:12:35 +0200
Subject: [gdal-dev] TIF + TFW to GeoTIFF without
 decompression/recompression
In-Reply-To: <319e8839-3099-7c39-be38-30c32d024ee8@libero.it>
References: <19a9d354-44ee-0151-5949-8ba1d861c26e@libero.it>
 <4a1e5713-6ad4-1366-539e-ae4ea22896ac@spatialys.com>
 <319e8839-3099-7c39-be38-30c32d024ee8@libero.it>
Message-ID: <ee1b973c-f86f-88a4-1ea6-84b5b116bdf8@spatialys.com>

(Re-adding gdal-dev)

Le 21/09/2021 ? 13:04, Andrea Giudiceandrea a ?crit?:
> Il 20/09/2021 11:28, Even Rouault ha scritto:
>> No, this is not implemented.? As you mention below gdal_edit, you 
>> could likely do a small script (or an enhancement of gdal_edit that 
>> has a -worldfile {filename} option)) to call SetGeoTransform() with a 
>> geotransform computed from the worldfile content
>
> Hi Even,
> thank you for your suggestion.
>
> Having a -worldfile option for gdal_edit would be good, it would also 
> good to have also an option to use the georeferencing parameters from 
> a PAM sidecar file.
>
> I still think the right thing would be to make sure gdal_translate 
> don't do a decompression/recompression cycle if not needed (i.e. when 
> the src raster is a TIFF ad the dst raster is GeoTIFF and no image 
> manipulation options are specified), maybe adding a special option for 
> this case (or a special value for the COMPRESSION option), so the 
> current default behaviour would be preserved.
I can't think of any major theoretical or practical obstacle in doing 
that, apart from actually coding it, as it will be a completely new code 
path in the GeoTIFF driver, which is a non-trivial one.
>
> Anyway, the following minimal Python script (complete code at [1]) 
> just do what I need (i.e. copy the src tif file to a new dst one and 
> copy the georeference information from src to dst):
> **
> shutil.copyfile(src, dst)
>
> src = gdal.Open(src)
>
> spatialref = src.GetSpatialRef()
> geotransform = src.GetGeoTransform()
> src = None
>
> dst = gdal.Open(dst,1)
> dst.SetSpatialRef(spatialref)
> dst.SetGeoTransform(geotransform)
> dst = None
> **
>
> or using GetGCPSpatialRef() / GetGCPs() and SetGCPs() for a 
> georeference with GCPs and not a geotransform.
>
> How can I reliably check if the src raster has a georeference with 
> GCPs or with a geotransform so I can appply the correct georeference 
> to the dst raster?
GCPs and geotransform will generally be exclusive (in GeoTIFF they are), 
so you can for example test if GetGCPs() returns something and use 
SetGCPs() then, and otherwise do the above
>
> Thank you again.
>
> Andrea Giudiceandrea
>
>
> [1] 
> https://gist.github.com/agiudiceandrea/2f0ef1e65858de1a35ef4b27b674c4ce

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From craig.leat at gmail.com  Tue Sep 21 08:03:32 2021
From: craig.leat at gmail.com (Craig Leat)
Date: Tue, 21 Sep 2021 17:03:32 +0200
Subject: [gdal-dev] Building mrsid autoload driver
In-Reply-To: <6b558517-a016-5d52-bbed-9ef206ce7c30@spatialys.com>
References: <CAAPVWe5HC0Gpve-CNdXmUXTNyxmXoQzpQROKt9wY7LFEzO4smg@mail.gmail.com>
 <6b558517-a016-5d52-bbed-9ef206ce7c30@spatialys.com>
Message-ID: <CAAPVWe5ASNFnw95W7axkQxwayFBA=eO0QZ23o9uD5tuj9rSpVA@mail.gmail.com>

Thanks. I tried as suggested, but mrsid plugin configure is still unable to
find the geotiff library.

Comparing configure scripts in
  src/gdal-3.0.4+dfsg, and
  src/gdal-3.0.4+dfsg/frmts/mrsid/pkg
I see substantial changes in mrsid and geotiff library detection.
Unfortunately the mrsid plugin appears too old to work on my system
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210921/49f0ba45/attachment.html>

From even.rouault at spatialys.com  Wed Sep 22 00:24:40 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 22 Sep 2021 09:24:40 +0200
Subject: [gdal-dev] configure file no longer in git
Message-ID: <80e6f6fb-4310-9733-9ae1-253f7b50d814@spatialys.com>

Hi,

since yesterday, the generated 'configure' file, from configure.ac, is 
no longer in git. If you've scripts building GDAL from git, you'll need 
to add a "./autogen.sh" step

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From matheuschidalgo at gmail.com  Thu Sep 23 09:40:35 2021
From: matheuschidalgo at gmail.com (Matheus Cammarosano Hidalgo)
Date: Thu, 23 Sep 2021 13:40:35 -0300
Subject: [gdal-dev] GDAL installation on Docker not working anymore
Message-ID: <CAJtzTOCXNPqf8BG04r26UkzACQBZbSPuqkK4OJaPOp_0eMwGdQ@mail.gmail.com>

I made a Dockerfile two years ago with a GDAL 2.2.3 install that was
working fine ultil three weeks ago, when I made a change in my Python code
(not Dockerfile), but when I tried to build the image I got an
error installing GDAL.
I am using a python:3.7 default image from Docker and I have the following
lines to install GDAL:
# Install GDAL dependencies
RUN apt-get install -y python3-pip libgdal-dev locales

# Ensure locales configured correctly
RUN locale-gen en_US.UTF-8
ENV LC_ALL='en_US.utf8'

# Set python aliases for python3
RUN echo 'alias python=python3' >> ~/.bashrc
RUN echo 'alias pip=pip3' >> ~/.bashrc

# Update C env vars so compiler can find gdal
ENV CPLUS_INCLUDE_PATH=/usr/include/gdal
ENV C_INCLUDE_PATH=/usr/include/gdal

RUN pip3 install GDAL==2.2.3

When I try to build the image, I get the following error message:
ERROR: Command errored out with exit status 1: /usr/local/bin/python -u -c
'import io, os, sys, setuptools, tokenize; sys.argv[0] =
'"'"'/tmp/pip-install-9sbmiien/gdal_b1debd2d108d43f38c9919e931126904/setup.py'"'"';
__file__='"'"'/tmp/pip-install-9sbmiien/gdal_b1debd2d108d43f38c9919e931126904/setup.py'"'"';f
= getattr(tokenize, '"'"'open'"'"', open)(__file__) if
os.path.exists(__file__) else io.StringIO('"'"'from setuptools import
setup; setup()'"'"');code = f.read().replace('"'"'\r\n'"'"',
'"'"'\n'"'"');f.close();exec(compile(code, __file__, '"'"'exec'"'"'))'
install --record /tmp/pip-record-sp2ip9vm/install-record.txt
--single-version-externally-managed --compile --install-headers
/usr/local/include/python3.7m/GDAL Check the logs for full command output.

Does anyone know what is happening and some way to make the installation
work? Thank you!

Best regards,
Matheus
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210923/60a09906/attachment.html>

From even.rouault at spatialys.com  Thu Sep 23 09:56:48 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 23 Sep 2021 18:56:48 +0200
Subject: [gdal-dev] GDAL installation on Docker not working anymore
In-Reply-To: <CAJtzTOCXNPqf8BG04r26UkzACQBZbSPuqkK4OJaPOp_0eMwGdQ@mail.gmail.com>
References: <CAJtzTOCXNPqf8BG04r26UkzACQBZbSPuqkK4OJaPOp_0eMwGdQ@mail.gmail.com>
Message-ID: <8aec5f3e-94c5-7f2e-d02e-549538e41cbe@spatialys.com>

Perhaps related to https://github.com/OSGeo/gdal/issues/4467 ? where 
upgrading setuptools was suggested

Le 23/09/2021 ? 18:40, Matheus Cammarosano Hidalgo a ?crit?:
> I made a Dockerfile two years ago with a GDAL 2.2.3 install that was 
> working fine?ultil three weeks ago, when I made a change in my Python 
> code (not Dockerfile), but when I tried to build the image I got an 
> error?installing GDAL.
> I am using a python:3.7 default image from Docker and I have the 
> following lines to install GDAL:
> # Install GDAL dependencies
> RUN apt-get install -y python3-pip libgdal-dev locales
>
> # Ensure locales configured correctly
> RUN locale-gen en_US.UTF-8
> ENV LC_ALL='en_US.utf8'
>
> # Set python aliases for python3
> RUN echo 'alias python=python3' >> ~/.bashrc
> RUN echo 'alias pip=pip3' >> ~/.bashrc
>
> # Update C env vars so compiler can find gdal
> ENV CPLUS_INCLUDE_PATH=/usr/include/gdal
> ENV C_INCLUDE_PATH=/usr/include/gdal
>
> RUN pip3 install GDAL==2.2.3
>
> When I try to build the image, I get the following error message:
> ERROR: Command errored out with exit status 1: /usr/local/bin/python 
> -u -c 'import io, os, sys, setuptools, tokenize; sys.argv[0] = 
> '"'"'/tmp/pip-install-9sbmiien/gdal_b1debd2d108d43f38c9919e931126904/setup.py'"'"'; 
> __file__='"'"'/tmp/pip-install-9sbmiien/gdal_b1debd2d108d43f38c9919e931126904/setup.py'"'"';f 
> = getattr(tokenize, '"'"'open'"'"', open)(__file__) if 
> os.path.exists(__file__) else io.StringIO('"'"'from setuptools import 
> setup; setup()'"'"');code = f.read().replace('"'"'\r\n'"'"', 
> '"'"'\n'"'"');f.close();exec(compile(code, __file__, '"'"'exec'"'"'))' 
> install --record /tmp/pip-record-sp2ip9vm/install-record.txt 
> --single-version-externally-managed --compile --install-headers 
> /usr/local/include/python3.7m/GDAL Check the logs for full command output.
>
> Does anyone know what is happening and some way to make the 
> installation work? Thank you!
>
> Best regards,
> Matheus
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210923/a851ec9b/attachment.html>

From scott.stanie at gmail.com  Thu Sep 23 16:45:56 2021
From: scott.stanie at gmail.com (Scott Staniewicz)
Date: Thu, 23 Sep 2021 18:45:56 -0500
Subject: [gdal-dev] ISCE raster changes from BIL to BIP after gdal_translate
Message-ID: <CAN4_TO9Ev7G+mHsyPoMy3Wob9=91HRU8tu1FLfKNrpSzufj=eQ@mail.gmail.com>

I've got a 2 band, band-interleaved-line file gendered from the ISCE
software. I was doing some subsetting of it with gdal_translate, and I
noticed that the format got changed to BIP:



$ ls
20130719_20150427.unw  20130719_20150427.unw.vrt  20130719_20150427.unw.xml

$ grep -i -n3 scheme 20130719_20150427.unw.xml
96-        <value>2</value>
97-        <doc>Number of image bands.</doc>
98-    </property>
99:    <property name="scheme">
100-        <value>BIL</value>
101:        <doc>Interleaving scheme of the image.</doc>
102-    </property>
103-    <property name="width">
104-        <value>586</value>

After running gdal_translate, the format has changed to BIP:

$ gdal_translate 20130719_20150427.unw test.unw -of ISCE
Input file size is 586, 882
0...10...20...30...40...50...60...70...80...90...100 - done.
(mapping) [scott at grace gdal-translate-bug]$ grep -i -n3 scheme test.unw.xml
11-  <property name="DATA_TYPE">
12-    <value>FLOAT</value>
13-  </property>
14:  <property name="SCHEME">
15-    <value>BIP</value>
16-  </property>
17-  <property name="BYTE_ORDER">


I'm assuming it's related to this line for creating a dataset with default
BIP:

https://github.com/OSGeo/gdal/blob/master/gdal/frmts/raw/iscedataset.cpp#L839

But I'm not familiar enough with the gdal_translate code to know where the
options are getting generated and passed here.
Any advice on where might be a good place to fix the ISCE raster generation?

Thanks,
Scott
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210923/d0db06e0/attachment.html>

From even.rouault at spatialys.com  Thu Sep 23 17:05:27 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 24 Sep 2021 02:05:27 +0200
Subject: [gdal-dev] ISCE raster changes from BIL to BIP after
 gdal_translate
In-Reply-To: <CAN4_TO9Ev7G+mHsyPoMy3Wob9=91HRU8tu1FLfKNrpSzufj=eQ@mail.gmail.com>
References: <CAN4_TO9Ev7G+mHsyPoMy3Wob9=91HRU8tu1FLfKNrpSzufj=eQ@mail.gmail.com>
Message-ID: <243a4019-efb6-f510-f60e-a7b3326c7fe0@spatialys.com>

Scott,

due to the Abstraction word in GDAL , doing a gdal_translate in the same 
format doesn't automatically applies the characteristics from the input 
dataset to the output one, because in general you translate into a 
different format, or if it is in the same format, you may apply options 
to gdal_translate that could invalidate the characteristics of the input 
dataset. So to do what you want, you need to write a specialized code.

You would need to create a CreateCopy() implementation in the ISCE 
driver that fetches from the source dataset the original scheme (it 
would have to be expose as a INTERLEAVING metadata item in the ISCE 
metadata domain for example), and uses that to force the SCHEME creation 
option.

https://github.com/OSGeo/gdal/blob/master/gdal/frmts/raw/ehdrdataset.cpp#L1811 
would probably be the closest starting point.

But you may also need the logic at 
https://github.com/OSGeo/gdal/blob/master/gdal/frmts/pds/pds4dataset.cpp#L4477 
to extract the source dataset from the in-memory VRT created by 
gdal_translate if applying for example a subsetting option.

Even


Le 24/09/2021 ? 01:45, Scott Staniewicz a ?crit?:
> I've got a 2 band, band-interleaved-line file gendered from the ISCE 
> software. I was doing some subsetting of it with gdal_translate, and I 
> noticed that the format got changed to BIP:
>
>
>
> $ ls
> 20130719_20150427.unw ?20130719_20150427.unw.vrt 
> ?20130719_20150427.unw.xml
>
> $ grep -i -n3 scheme 20130719_20150427.unw.xml
> 96- ? ? ? ?<value>2</value>
> 97- ? ? ? ?<doc>Number of image bands.</doc>
> 98- ? ?</property>
> 99: ? ?<property name="scheme">
> 100- ? ? ? ?<value>BIL</value>
> 101: ? ? ? ?<doc>Interleaving scheme of the image.</doc>
> 102- ? ?</property>
> 103- ? ?<property name="width">
> 104- ? ? ? ?<value>586</value>
>
> After running gdal_translate, the format has changed to BIP:
>
> $ gdal_translate 20130719_20150427.unw test.unw -of ISCE
> Input file size is 586, 882
> 0...10...20...30...40...50...60...70...80...90...100 - done.
> (mapping) [scott at grace gdal-translate-bug]$ grep -i -n3 scheme 
> test.unw.xml
> 11- ?<property name="DATA_TYPE">
> 12- ? ?<value>FLOAT</value>
> 13- ?</property>
> 14: ?<property name="SCHEME">
> 15- ? ?<value>BIP</value>
> 16- ?</property>
> 17- ?<property name="BYTE_ORDER">
>
>
> I'm assuming it's related to this line for creating a dataset with 
> default BIP:
>
> https://github.com/OSGeo/gdal/blob/master/gdal/frmts/raw/iscedataset.cpp#L839 
> <https://github.com/OSGeo/gdal/blob/master/gdal/frmts/raw/iscedataset.cpp#L839>
>
> But I'm not familiar enough with the gdal_translate code to know where 
> the options are getting generated and passed here.
> Any advice on where might be a good place to fix the ISCE raster 
> generation?
>
> Thanks,
> Scott
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210924/c171e51b/attachment.html>

From loridigia at gmail.com  Fri Sep 24 05:53:05 2021
From: loridigia at gmail.com (Lorenzo Di Giacomo)
Date: Fri, 24 Sep 2021 14:53:05 +0200
Subject: [gdal-dev] ModuleNotFoundError: No module named 'osgeo._gdal_array'
Message-ID: <CAERmyNQTiQ62gJonNYbPcysZ9XVNXZ25SajXV_KfT+NGBCgF8g@mail.gmail.com>

Hi everyone, basically i build from source GDAL 3.2.2 and install the
python bindings via pip3 install gdal==3.2.2

Later i install numpy, i have read online that the numpy must be installed
before GDAL python bindings.
So i tried to uninstall python gdal and than reinstall it, but the problem
still persists.

Do you have any suggestions about it?

Python3 libraries:
GDAL 3.2.2
NUMPY 1.21.2

SWIG 4.0.2

LOG:

ModuleNotFoundError: No module named 'osgeo._gdal_array'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "temp-1544239507789228725main.py", line 98, in <module>
    SSRD,gtSSRD = tiff2array(path_to_tiff, band_SSRD)
  File "/hadoop/yarn/local/usercache/dispatcher/appcache/application_1628674283442_0030/container_e33_1628674283442_0030_01_000001/61a5101c-d78d-494d-b0d6-ef16719143719035222534140350861632485975806.zip/utility/rasterutils.py",
line 58, in tiff2array
  File "/usr/local/lib/python3.7/site-packages/osgeo/gdal.py", line
3832, in ReadAsArray
    from osgeo import gdalnumeric
  File "/usr/local/lib/python3.7/site-packages/osgeo/gdalnumeric.py",
line 2, in <module>
    from osgeo.gdal_array import *
  File "/usr/local/lib/python3.7/site-packages/osgeo/gdal_array.py",
line 17, in <module>
    _gdal_array = swig_import_helper()
  File "/usr/local/lib/python3.7/site-packages/osgeo/gdal_array.py",
line 16, in swig_import_helper
    return importlib.import_module('_gdal_array')
  File "/usr/local/lib/python3.7/importlib/__init__.py", line 127, in
import_module
    return _bootstrap._gcd_import(name[level:], package, level)
ModuleNotFoundError: No module named '_gdal_array'
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210924/14362d28/attachment.html>

From even.rouault at spatialys.com  Fri Sep 24 06:14:24 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 24 Sep 2021 15:14:24 +0200
Subject: [gdal-dev] ModuleNotFoundError: No module named
 'osgeo._gdal_array'
In-Reply-To: <CAERmyNQTiQ62gJonNYbPcysZ9XVNXZ25SajXV_KfT+NGBCgF8g@mail.gmail.com>
References: <CAERmyNQTiQ62gJonNYbPcysZ9XVNXZ25SajXV_KfT+NGBCgF8g@mail.gmail.com>
Message-ID: <582e979d-3ba4-6649-4865-1d868569ab5f@spatialys.com>

Lorenzo,

you didn't mention which Linux distro you used and how you installed numpy

I'm aware at least that on Alpine Linux, you need to install an 
additional py3-numpy-dev package with the headers & lib needed to use 
the C API of numpy, which is needed by the GDAL Python bindings

Check that the following returns something sensible

python3 -c "import numpy; print(numpy.get_include())"

when you build the GDAL python bindings look for the following messages 
in the output that will indicate that the gdal_array module can't be built

"WARNING: numpy headers were not found!? Array support will not be enabled"

or

'WARNING: numpy not available!? Array support will not be enabled'

Even

Le 24/09/2021 ? 14:53, Lorenzo Di Giacomo a ?crit?:
> Hi everyone, basically i build from source GDAL 3.2.2 and install the 
> python bindings via pip3 install gdal==3.2.2
>
> Later i install numpy, i have read online that the numpy must be 
> installed before GDAL python bindings.
> So i tried to uninstall python gdal and than reinstall it, but the 
> problem still?persists.
>
> Do you have any suggestions about it?
>
> Python3 libraries:
> GDAL 3.2.2
> NUMPY 1.21.2
>
> SWIG 4.0.2
>
> LOG:
> ModuleNotFoundError: No module named 'osgeo._gdal_array'
>
> During handling of the above exception, another exception occurred:
>
> Traceback (most recent call last):
>    File "temp-1544239507789228725main.py", line 98, in <module>
>      SSRD,gtSSRD = tiff2array(path_to_tiff, band_SSRD)
>    File "/hadoop/yarn/local/usercache/dispatcher/appcache/application_1628674283442_0030/container_e33_1628674283442_0030_01_000001/61a5101c-d78d-494d-b0d6-ef16719143719035222534140350861632485975806.zip/utility/rasterutils.py", line 58, in tiff2array
>    File "/usr/local/lib/python3.7/site-packages/osgeo/gdal.py", line 3832, in ReadAsArray
>      from osgeo import gdalnumeric
>    File "/usr/local/lib/python3.7/site-packages/osgeo/gdalnumeric.py", line 2, in <module>
>      from osgeo.gdal_array import *
>    File "/usr/local/lib/python3.7/site-packages/osgeo/gdal_array.py", line 17, in <module>
>      _gdal_array = swig_import_helper()
>    File "/usr/local/lib/python3.7/site-packages/osgeo/gdal_array.py", line 16, in swig_import_helper
>      return importlib.import_module('_gdal_array')
>    File "/usr/local/lib/python3.7/importlib/__init__.py", line 127, in import_module
>      return _bootstrap._gcd_import(name[level:], package, level)
> ModuleNotFoundError: No module named '_gdal_array'
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210924/3d166120/attachment-0001.html>

From loridigia at gmail.com  Fri Sep 24 06:56:55 2021
From: loridigia at gmail.com (Lorenzo Di Giacomo)
Date: Fri, 24 Sep 2021 15:56:55 +0200
Subject: [gdal-dev] ModuleNotFoundError: No module named
 'osgeo._gdal_array'
In-Reply-To: <582e979d-3ba4-6649-4865-1d868569ab5f@spatialys.com>
References: <CAERmyNQTiQ62gJonNYbPcysZ9XVNXZ25SajXV_KfT+NGBCgF8g@mail.gmail.com>
 <582e979d-3ba4-6649-4865-1d868569ab5f@spatialys.com>
Message-ID: <CAERmyNQZzH3sQuR5W6q=MPguyobjXhCCErD+FQcqApqeHkhvTA@mail.gmail.com>

Hi Even, my distro is:  Debian GNU/Linux 11 (bullseye)
Btw using pip3 install --force-reinstall gdal==3.2.2 --no-cache-dir works
fine.

Il giorno ven 24 set 2021 alle ore 15:14 Even Rouault <
even.rouault at spatialys.com> ha scritto:

> Lorenzo,
>
> you didn't mention which Linux distro you used and how you installed numpy
>
> I'm aware at least that on Alpine Linux, you need to install an additional
> py3-numpy-dev package with the headers & lib needed to use the C API of
> numpy, which is needed by the GDAL Python bindings
>
> Check that the following returns something sensible
>
> python3 -c "import numpy; print(numpy.get_include())"
>
> when you build the GDAL python bindings look for the following messages in
> the output that will indicate that the gdal_array module can't be built
>
> "WARNING: numpy headers were not found!  Array support will not be enabled"
>
> or
>
> 'WARNING: numpy not available!  Array support will not be enabled'
>
> Even
> Le 24/09/2021 ? 14:53, Lorenzo Di Giacomo a ?crit :
>
> Hi everyone, basically i build from source GDAL 3.2.2 and install the
> python bindings via pip3 install gdal==3.2.2
>
> Later i install numpy, i have read online that the numpy must be installed
> before GDAL python bindings.
> So i tried to uninstall python gdal and than reinstall it, but the problem
> still persists.
>
> Do you have any suggestions about it?
>
> Python3 libraries:
> GDAL 3.2.2
> NUMPY 1.21.2
>
> SWIG 4.0.2
>
> LOG:
>
> ModuleNotFoundError: No module named 'osgeo._gdal_array'
>
> During handling of the above exception, another exception occurred:
>
> Traceback (most recent call last):
>   File "temp-1544239507789228725main.py", line 98, in <module>
>     SSRD,gtSSRD = tiff2array(path_to_tiff, band_SSRD)
>   File "/hadoop/yarn/local/usercache/dispatcher/appcache/application_1628674283442_0030/container_e33_1628674283442_0030_01_000001/61a5101c-d78d-494d-b0d6-ef16719143719035222534140350861632485975806.zip/utility/rasterutils.py", line 58, in tiff2array
>   File "/usr/local/lib/python3.7/site-packages/osgeo/gdal.py", line 3832, in ReadAsArray
>     from osgeo import gdalnumeric
>   File "/usr/local/lib/python3.7/site-packages/osgeo/gdalnumeric.py", line 2, in <module>
>     from osgeo.gdal_array import *
>   File "/usr/local/lib/python3.7/site-packages/osgeo/gdal_array.py", line 17, in <module>
>     _gdal_array = swig_import_helper()
>   File "/usr/local/lib/python3.7/site-packages/osgeo/gdal_array.py", line 16, in swig_import_helper
>     return importlib.import_module('_gdal_array')
>   File "/usr/local/lib/python3.7/importlib/__init__.py", line 127, in import_module
>     return _bootstrap._gcd_import(name[level:], package, level)
> ModuleNotFoundError: No module named '_gdal_array'
>
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210924/97a29a42/attachment.html>

From even.rouault at spatialys.com  Sat Sep 25 04:52:41 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 25 Sep 2021 13:52:41 +0200
Subject: [gdal-dev] HTJ2K decoding available in openjpeg master
In-Reply-To: <7b7269ed-bc64-36a1-92e1-997e150978b5@spatialys.com>
References: <7b7269ed-bc64-36a1-92e1-997e150978b5@spatialys.com>
Message-ID: <71abd8c8-791d-614b-4bd1-131e89454428@spatialys.com>

Hi,

below is of potential interest for GDAL. We had related discussions when 
a Grok GDAL driver was proposed. HTJ2K (ITU-T.814 
https://www.itu.int/rec/T-REC-T.814-201906-I/en or JPEG2000 Part 15) is 
an extension of regular JPEG2000 were the code block encoding, which is 
the slowest part of JPEG2000, has been replaced by an alternative that 
has the potential for being 10 times or more faster (could apparently be 
30 times faster for lossless), with an increased file size of ~ 7%. 
Current implementation in OpenJPEG is "only" twice faster.

I've verified that the current JP2OpenJPEG driver, when linked to 
openjpeg master 2.5.0dev, can decode HTJ2K codestreams. This also works 
when they are embedded in JP2 boxes (files with .jph extensions that are 
similar to .jp2), which is in particular where georeferencing is encoded 
(GMLJP2 boxes or GeoJP2 boxes), so theoretically we should be ready for 
geospatial imagery using HTJ2K coding, if such a beast ever emerges...

This is a decode-only implementation. To play with the encoding side, 
you'll have to use https://github.com/aous72/OpenJPH, 
https://github.com/osamu620/OpenHTJ2K, 
https://github.com/GrokImageCompression/grok or Kakadu

Even

-------- Message transf?r? --------
Sujet?: 	[OpenJPEG] HTJ2K decoding + github action workflows
Date?: 	Sat, 25 Sep 2021 13:36:22 +0200
De?: 	Even Rouault <even.rouault at spatialys.com>
R?pondre ??: 	openjpeg at googlegroups.com
Pour?: 	OpenJPEG <openjpeg at googlegroups.com>



Hi,

some good news to share about latest developments in OpenJPEG master branch:

- Aous Naman has made a great contribution by adding a HTJ2K (High 
Throughput / Part-15) decoder. See 
https://github.com/uclouvain/openjpeg/pull/1381 for details and 
limitations. My quick experiment (see 
https://github.com/uclouvain/openjpeg/pull/1374#issuecomment-926894225) 
shows a ~ x2 speed improvement in mono-threaded decompression compared 
to regular Part-1 code block style.

- I've migrated most of the continuous integration target to github 
action workflows. The driver for this is that Travis-CI is no longer 
friendly to open source projects due to a limited small quota that was 
exhausted for our project. github action workflows are naturally 
inherited in forks, so you can potentially work on a branch for some 
time, push in your clone, check CI results and just issue a pull request 
when you're done.

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-- 
You are subscribed to the mailing-list of the OpenJPEG project (www.openjpeg.org)
To post: email to openjpeg at googlegroups.com
To unsubscribe: email to openjpeg+unsubscribe at googlegroups.com
For more options: visit http://groups.google.com/group/openjpeg
OpenJPEG is mainly supported by : * UCL Image and Signal Processing Group (http://sites.uclouvain.be/ispgroup) * IntoPIX (www.intopix.com)
--- You received this message because you are subscribed to the Google Groups "OpenJPEG" group.
To unsubscribe from this group and stop receiving emails from it, send an email to openjpeg+unsubscribe at googlegroups.com.
To view this discussion on the web visit https://groups.google.com/d/msgid/openjpeg/7b7269ed-bc64-36a1-92e1-997e150978b5%40spatialys.com.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210925/63dbada5/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Mon Sep 27 06:21:31 2021
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Mon, 27 Sep 2021 13:21:31 +0000
Subject: [gdal-dev] Does OAPIF paging work as supposed?
Message-ID: <4d8879ba99dd4d21a4806c34b0b03b9e@maanmittauslaitos.fi>

Hi,

I tried to read a relatively small BBOX from an OAPIF server but the process feels rather slow and I do not quite understand what I am seeing in the log.

ogr2ogr -f GPKG test.gpkg OAPIF:https://avoin-paikkatieto.maanmittauslaitos.fi/maastotiedot/features/v1/?api-key=xxxx -spat 25 65 25.1 65.1 -oo PAGE_SIZE=10000 --debug on --config cpl_curl_verbose yes

Excerpts from the log:

HTTP: Fetch(https://avoin-paikkatieto.maanmittauslaitos.fi/maastotiedot/features/v1/collections/osoitepiste/items?api-key=xxxx&f=json&limit=10000)
HTTP: These HTTP headers were set: Accept: application/geo+json, application/json
...
> GET /maastotiedot/features/v1/collections/osoitepiste/items?api-key=xxxx&f=json&limit=10000 HTTP/1.1
Host: avoin-paikkatieto.maanmittauslaitos.fi
Accept-Encoding: gzip
Accept: application/geo+json, application/json

* Mark bundle as not supporting multiuse
< HTTP/1.1 200 OK
...
GeoJSON: First pass: 56.54 %
GeoJSON: First pass: 100.00 %
HTTP: Fetch(https://avoin-paikkatieto.maanmittauslaitos.fi/maastotiedot/features/v1/collections/osoitepiste/items?api-key=xxxx&f=json&limit=10000&bbox=25,65,25.1000000000000014,65.0999999999999943)
...
> GET /maastotiedot/features/v1/collections/osoitepiste/items?api-key=xxxx&f=json&limit=10000&bbox=25,65,25.1000000000000014,65.0999999999999943 HTTP/1.1
...
< Content-Length: 309
GDALVectorTranslate: 0 features written in layer 'osoitepiste'

Do I read right that GDAL is first reading one page, in this time 10000 features without BBOX, perhaps for resolving the schema, and then makes a new query with BBOX? In this case the BBOX query finds nothing. Reading 10000 features on the first round and then discarding everything feels too expensive. Could it be enough to read for example 10 features that is the default page size on the first round instead of the full page?

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210927/59f6b470/attachment.html>

From even.rouault at spatialys.com  Mon Sep 27 06:47:17 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 27 Sep 2021 15:47:17 +0200
Subject: [gdal-dev] Does OAPIF paging work as supposed?
In-Reply-To: <4d8879ba99dd4d21a4806c34b0b03b9e@maanmittauslaitos.fi>
References: <4d8879ba99dd4d21a4806c34b0b03b9e@maanmittauslaitos.fi>
Message-ID: <fba5b6f7-69ea-2570-8187-3282f27aa03b@spatialys.com>

Jukka,

your analysis is completely correct. Whether this is expected or not 
probably depends on situations. Should we have a 
INITIAL_REQUEST_PAGE_SIZE=number open option to overload the number of 
features to retrieve specifically in the first request... ??

Regarding the spatial filter, it is passed through the OGR API generally 
after having queried the schema, and for most OGR datasources it 
wouldn't influence the schema, so there isn't much that can be done 
here, except maybe adding a BBOX=west,south,east,north open option.

One option to avoid both issues would be for the service to publish 
DescribedBy links at the collection level that would point to a XML 
schema (using a GML Simple Feature schema profile, such as the one 
understood by the GML driver) or a JSON schema (not "too" complicated 
too). Both are handled by the driver.

Even

Le 27/09/2021 ? 15:21, Rahkonen Jukka (MML) a ?crit?:
>
> Hi,
>
> I tried to read a relatively small BBOX from an OAPIF server but the 
> process feels rather slow and I do not quite understand what I am 
> seeing in the log.
>
> ogr2ogr -f GPKG test.gpkg 
> OAPIF:https://avoin-paikkatieto.maanmittauslaitos.fi/maastotiedot/features/v1/?api-key=xxxx 
> <https://avoin-paikkatieto.maanmittauslaitos.fi/maastotiedot/features/v1/?api-key=xxxx> 
> -spat 25 65 25.1 65.1 -oo PAGE_SIZE=10000 --debug on --config 
> cpl_curl_verbose yes
>
> Excerpts from the log:
>
> HTTP: 
> Fetch(https://avoin-paikkatieto.maanmittauslaitos.fi/maastotiedot/features/v1/collections/osoitepiste/items?api-key=xxxx&f=json&limit=10000 
> <https://avoin-paikkatieto.maanmittauslaitos.fi/maastotiedot/features/v1/collections/osoitepiste/items?api-key=xxxx&f=json&limit=10000>)
>
> HTTP: These HTTP headers were set: Accept: application/geo+json, 
> application/json
>
> ?
>
> > GET /maastotiedot/features/v1/collections/osoitepiste/items?api-key=xxxx&f=json&limit=10000 HTTP/1.1
>
> Host: avoin-paikkatieto.maanmittauslaitos.fi
>
> Accept-Encoding: gzip
>
> Accept: application/geo+json, application/json
>
> * Mark bundle as not supporting multiuse
>
> < HTTP/1.1 200 OK
>
> ?
>
> GeoJSON: First pass: 56.54 %
>
> GeoJSON: First pass: 100.00 %
>
> HTTP: 
> Fetch(https://avoin-paikkatieto.maanmittauslaitos.fi/maastotiedot/features/v1/collections/osoitepiste/items?api-key=xxxx&f=json&limit=10000&bbox=25,65,25.1000000000000014,65.0999999999999943 
> <https://avoin-paikkatieto.maanmittauslaitos.fi/maastotiedot/features/v1/collections/osoitepiste/items?api-key=xxxx&f=json&limit=10000&bbox=25,65,25.1000000000000014,65.0999999999999943>)
>
> ?
>
> > GET /maastotiedot/features/v1/collections/osoitepiste/items?api-key=xxxx&f=json&limit=10000&bbox=25,65,25.1000000000000014,65.0999999999999943 HTTP/1.1
>
> ?
>
> < Content-Length: 309
>
> GDALVectorTranslate: 0 features written in layer 'osoitepiste'
>
> Do I read right that GDAL is first reading one page, in this time 
> 10000 features without BBOX, perhaps for resolving the schema, and 
> then makes a new query with BBOX? In this case the BBOX query finds 
> nothing. Reading 10000 features on the first round and then discarding 
> everything feels too expensive. Could it be enough to read for example 
> 10 features that is the default page size on the first round instead 
> of the full page?
>
> -Jukka Rahkonen-
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210927/0f8bb511/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Mon Sep 27 07:09:57 2021
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Mon, 27 Sep 2021 14:09:57 +0000
Subject: [gdal-dev] Does OAPIF paging work as supposed?
Message-ID: <b5c894037c444002b59a4be70c541fd7@maanmittauslaitos.fi>

Hi,

At least in this case having INITIAL_REQUEST_PAGE_SIZE=number option would resolve the practical problem. We have collections with millions of features and therefore large page size is essential when downloading the whole collection. On the other hand we have complicated geometries like lake polygons and reading 10000 large geometries for resolving the schema is pretty heavy. And we have 126 collections in the service that makes 126 x 10000 features read for resolving the schemas if the aim is to clip a small area from all collections into GeoPackage.

-Jukka Rahkonen-

L?hett?j?: Even Rouault <even.rouault at spatialys.com>
L?hetetty: maanantai 27. syyskuuta 2021 16.47
Vastaanottaja: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>; 'gdal-dev at lists.osgeo.org' <gdal-dev at lists.osgeo.org>
Aihe: Re: [gdal-dev] Does OAPIF paging work as supposed?


Jukka,

your analysis is completely correct. Whether this is expected or not probably depends on situations. Should we have a INITIAL_REQUEST_PAGE_SIZE=number open option to overload the number of features to retrieve specifically in the first request... ??

Regarding the spatial filter, it is passed through the OGR API generally after having queried the schema, and for most OGR datasources it wouldn't influence the schema, so there isn't much that can be done here, except maybe adding a BBOX=west,south,east,north open option.

One option to avoid both issues would be for the service to publish DescribedBy links at the collection level that would point to a XML schema (using a GML Simple Feature schema profile, such as the one understood by the GML driver) or a JSON schema (not "too" complicated too). Both are handled by the driver.

Even
Le 27/09/2021 ? 15:21, Rahkonen Jukka (MML) a ?crit :
Hi,

I tried to read a relatively small BBOX from an OAPIF server but the process feels rather slow and I do not quite understand what I am seeing in the log.

ogr2ogr -f GPKG test.gpkg OAPIF:https://avoin-paikkatieto.maanmittauslaitos.fi/maastotiedot/features/v1/?api-key=xxxx -spat 25 65 25.1 65.1 -oo PAGE_SIZE=10000 --debug on --config cpl_curl_verbose yes

Excerpts from the log:

HTTP: Fetch(https://avoin-paikkatieto.maanmittauslaitos.fi/maastotiedot/features/v1/collections/osoitepiste/items?api-key=xxxx&f=json&limit=10000)
HTTP: These HTTP headers were set: Accept: application/geo+json, application/json
...
> GET /maastotiedot/features/v1/collections/osoitepiste/items?api-key=xxxx&f=json&limit=10000 HTTP/1.1
Host: avoin-paikkatieto.maanmittauslaitos.fi
Accept-Encoding: gzip
Accept: application/geo+json, application/json

* Mark bundle as not supporting multiuse
< HTTP/1.1 200 OK
...
GeoJSON: First pass: 56.54 %
GeoJSON: First pass: 100.00 %
HTTP: Fetch(https://avoin-paikkatieto.maanmittauslaitos.fi/maastotiedot/features/v1/collections/osoitepiste/items?api-key=xxxx&f=json&limit=10000&bbox=25,65,25.1000000000000014,65.0999999999999943)
...
> GET /maastotiedot/features/v1/collections/osoitepiste/items?api-key=xxxx&f=json&limit=10000&bbox=25,65,25.1000000000000014,65.0999999999999943 HTTP/1.1
...
< Content-Length: 309
GDALVectorTranslate: 0 features written in layer 'osoitepiste'

Do I read right that GDAL is first reading one page, in this time 10000 features without BBOX, perhaps for resolving the schema, and then makes a new query with BBOX? In this case the BBOX query finds nothing. Reading 10000 features on the first round and then discarding everything feels too expensive. Could it be enough to read for example 10 features that is the default page size on the first round instead of the full page?

-Jukka Rahkonen-



_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

https://lists.osgeo.org/mailman/listinfo/gdal-dev

--

http://www.spatialys.com

My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210927/63028a63/attachment-0001.html>

From matheuschidalgo at gmail.com  Mon Sep 27 07:38:08 2021
From: matheuschidalgo at gmail.com (Matheus Cammarosano Hidalgo)
Date: Mon, 27 Sep 2021 11:38:08 -0300
Subject: [gdal-dev] GDAL installation on Docker not working anymore
In-Reply-To: <8aec5f3e-94c5-7f2e-d02e-549538e41cbe@spatialys.com>
References: <CAJtzTOCXNPqf8BG04r26UkzACQBZbSPuqkK4OJaPOp_0eMwGdQ@mail.gmail.com>
 <8aec5f3e-94c5-7f2e-d02e-549538e41cbe@spatialys.com>
Message-ID: <CAJtzTOBQ8iySALeq_WirCvwo=5rphM0N9Ro__kdLz3v79T_gpg@mail.gmail.com>

The proposed solution applies to GDAL 3.0.4 going forward and I am working
with 2.2.3. It is weird because I haven't changed anything in my
Dockerfile...

Em qui., 23 de set. de 2021 ?s 13:56, Even Rouault <
even.rouault at spatialys.com> escreveu:

> Perhaps related to https://github.com/OSGeo/gdal/issues/4467 ? where
> upgrading setuptools was suggested
> Le 23/09/2021 ? 18:40, Matheus Cammarosano Hidalgo a ?crit :
>
> I made a Dockerfile two years ago with a GDAL 2.2.3 install that was
> working fine ultil three weeks ago, when I made a change in my Python code
> (not Dockerfile), but when I tried to build the image I got an
> error installing GDAL.
> I am using a python:3.7 default image from Docker and I have the following
> lines to install GDAL:
> # Install GDAL dependencies
> RUN apt-get install -y python3-pip libgdal-dev locales
>
> # Ensure locales configured correctly
> RUN locale-gen en_US.UTF-8
> ENV LC_ALL='en_US.utf8'
>
> # Set python aliases for python3
> RUN echo 'alias python=python3' >> ~/.bashrc
> RUN echo 'alias pip=pip3' >> ~/.bashrc
>
> # Update C env vars so compiler can find gdal
> ENV CPLUS_INCLUDE_PATH=/usr/include/gdal
> ENV C_INCLUDE_PATH=/usr/include/gdal
>
> RUN pip3 install GDAL==2.2.3
>
> When I try to build the image, I get the following error message:
> ERROR: Command errored out with exit status 1: /usr/local/bin/python -u -c
> 'import io, os, sys, setuptools, tokenize; sys.argv[0] =
> '"'"'/tmp/pip-install-9sbmiien/gdal_b1debd2d108d43f38c9919e931126904/setup.py'"'"';
> __file__='"'"'/tmp/pip-install-9sbmiien/gdal_b1debd2d108d43f38c9919e931126904/setup.py'"'"';f
> = getattr(tokenize, '"'"'open'"'"', open)(__file__) if
> os.path.exists(__file__) else io.StringIO('"'"'from setuptools import
> setup; setup()'"'"');code = f.read().replace('"'"'\r\n'"'"',
> '"'"'\n'"'"');f.close();exec(compile(code, __file__, '"'"'exec'"'"'))'
> install --record /tmp/pip-record-sp2ip9vm/install-record.txt
> --single-version-externally-managed --compile --install-headers
> /usr/local/include/python3.7m/GDAL Check the logs for full command output.
>
> Does anyone know what is happening and some way to make the installation
> work? Thank you!
>
> Best regards,
> Matheus
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210927/11c8d7f8/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Tue Sep 28 00:04:51 2021
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Tue, 28 Sep 2021 07:04:51 +0000
Subject: [gdal-dev] Does OAPIF paging work as supposed?
Message-ID: <b9e3a8ec8d99454795dc288ac58b2ad6@maanmittauslaitos.fi>

Hi,

Even Rouault wrote:

> One option to avoid both issues would be for the service to publish
> DescribedBy links at the collection level that would point to a XML
> schema (using a GML Simple Feature schema profile, such as the one
> understood by the GML driver) or a JSON schema (not "too" complicated too).
> Both are handled by the driver.

We added JSON schema and ogrinfo seems to read it, but it still wants to read one page of data:

ogrinfo OAPIF:http://some.internal.service/features/collections/PalstanSijaintitiedot/ -al -so -oo PAGE_SIZE=10000 -nocount -noextent -nogeomtype --debug on

HTTP: Fetch(http:// some.internal.service /features/collections/PalstanSijaintitiedot/schema)
HTTP: These HTTP headers were set: Accept: application/schema+json
OAPIF: Using JSON schema
HTTP: Fetch(http:// some.internal.service /features/collections/PalstanSijaintitiedot/items?f=json&limit=10000)

I wonder if there is still something in ogrinfo that I cannot turn off and what triggers the need to read some features, perhaps the coordinate system.


-Jukka Rahkonen-

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210928/f3ba13c2/attachment.html>

From even.rouault at spatialys.com  Tue Sep 28 02:38:00 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 28 Sep 2021 11:38:00 +0200
Subject: [gdal-dev] Does OAPIF paging work as supposed?
In-Reply-To: <b9e3a8ec8d99454795dc288ac58b2ad6@maanmittauslaitos.fi>
References: <b9e3a8ec8d99454795dc288ac58b2ad6@maanmittauslaitos.fi>
Message-ID: <79135fec-0cf2-9a44-da2e-4a13280ce891@spatialys.com>


Le 28/09/2021 ? 09:04, Rahkonen Jukka (MML) a ?crit?:
>
> Hi,
>
> Even Rouault wrote:
>
> > One option to avoid both issues would be for the service to publish
>
> > DescribedBy links at the collection level that would point to a XML
>
> > schema (using a GML Simple Feature schema profile, such as the one
>
> > understood by the GML driver) or a JSON schema (not "too" complicated too).
>
> > Both are handled by the driver.
>
> We added JSON schema and ogrinfo seems to read it, but it still wants 
> to read one page of data:
>
ah you're right. Yes, looking at the code it will always read one page. 
There might be missing information in the schema, in particular for the 
layer geometry type (not always filled in XML schema, and most likely 
never in JSON schema, or at least the logic for that isn't implemented). 
It also takes the opportunity to look at other things such as the 
numberMatched information to be able to response to GetFeatureCount(), 
although that could potentially be skipped and defered when it is invoked.
>
> ogrinfo 
> OAPIF:http://some.internal.service/features/collections/PalstanSijaintitiedot/ 
> -al -so -oo PAGE_SIZE=10000 -nocount -noextent -nogeomtype --debug on
>
> HTTP: Fetch(http://some.internal.service 
> /features/collections/PalstanSijaintitiedot/schema)
>
> HTTP: These HTTP headers were set: Accept: application/schema+json
>
> OAPIF: Using JSON schema
>
> HTTP: Fetch(http://some.internal.service 
> /features/collections/PalstanSijaintitiedot/items?f=json&limit=10000)
>
> I wonder if there is still something in ogrinfo that I cannot turn off 
> and what triggers the need to read some features, perhaps the 
> coordinate system.
>
> -Jukka Rahkonen-
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210928/30cac38b/attachment.html>

From matheuschidalgo at gmail.com  Tue Sep 28 05:39:52 2021
From: matheuschidalgo at gmail.com (Matheus Cammarosano Hidalgo)
Date: Tue, 28 Sep 2021 09:39:52 -0300
Subject: [gdal-dev] GDAL installation on Docker not working anymore
In-Reply-To: <CAJtzTOBQ8iySALeq_WirCvwo=5rphM0N9Ro__kdLz3v79T_gpg@mail.gmail.com>
References: <CAJtzTOCXNPqf8BG04r26UkzACQBZbSPuqkK4OJaPOp_0eMwGdQ@mail.gmail.com>
 <8aec5f3e-94c5-7f2e-d02e-549538e41cbe@spatialys.com>
 <CAJtzTOBQ8iySALeq_WirCvwo=5rphM0N9Ro__kdLz3v79T_gpg@mail.gmail.com>
Message-ID: <CAJtzTOBUmpKJz8A3vF1gf16UUENUsedEB_njcAT7R1T_GP6NvQ@mail.gmail.com>

I changed the Dockerfile following the same steps as the author of this
post (https://github.com/OSGeo/gdal/issues/4467) did to install GDAL (but
using version 2.2.3) and it worked fine. Still don't know why the way I did
previously is not working anymore but now everything is ok. Thank you!

Em seg., 27 de set. de 2021 ?s 11:38, Matheus Cammarosano Hidalgo <
matheuschidalgo at gmail.com> escreveu:

> The proposed solution applies to GDAL 3.0.4 going forward and I am working
> with 2.2.3. It is weird because I haven't changed anything in my
> Dockerfile...
>
> Em qui., 23 de set. de 2021 ?s 13:56, Even Rouault <
> even.rouault at spatialys.com> escreveu:
>
>> Perhaps related to https://github.com/OSGeo/gdal/issues/4467 ? where
>> upgrading setuptools was suggested
>> Le 23/09/2021 ? 18:40, Matheus Cammarosano Hidalgo a ?crit :
>>
>> I made a Dockerfile two years ago with a GDAL 2.2.3 install that was
>> working fine ultil three weeks ago, when I made a change in my Python code
>> (not Dockerfile), but when I tried to build the image I got an
>> error installing GDAL.
>> I am using a python:3.7 default image from Docker and I have the
>> following lines to install GDAL:
>> # Install GDAL dependencies
>> RUN apt-get install -y python3-pip libgdal-dev locales
>>
>> # Ensure locales configured correctly
>> RUN locale-gen en_US.UTF-8
>> ENV LC_ALL='en_US.utf8'
>>
>> # Set python aliases for python3
>> RUN echo 'alias python=python3' >> ~/.bashrc
>> RUN echo 'alias pip=pip3' >> ~/.bashrc
>>
>> # Update C env vars so compiler can find gdal
>> ENV CPLUS_INCLUDE_PATH=/usr/include/gdal
>> ENV C_INCLUDE_PATH=/usr/include/gdal
>>
>> RUN pip3 install GDAL==2.2.3
>>
>> When I try to build the image, I get the following error message:
>> ERROR: Command errored out with exit status 1: /usr/local/bin/python -u
>> -c 'import io, os, sys, setuptools, tokenize; sys.argv[0] =
>> '"'"'/tmp/pip-install-9sbmiien/gdal_b1debd2d108d43f38c9919e931126904/setup.py'"'"';
>> __file__='"'"'/tmp/pip-install-9sbmiien/gdal_b1debd2d108d43f38c9919e931126904/setup.py'"'"';f
>> = getattr(tokenize, '"'"'open'"'"', open)(__file__) if
>> os.path.exists(__file__) else io.StringIO('"'"'from setuptools import
>> setup; setup()'"'"');code = f.read().replace('"'"'\r\n'"'"',
>> '"'"'\n'"'"');f.close();exec(compile(code, __file__, '"'"'exec'"'"'))'
>> install --record /tmp/pip-record-sp2ip9vm/install-record.txt
>> --single-version-externally-managed --compile --install-headers
>> /usr/local/include/python3.7m/GDAL Check the logs for full command output.
>>
>> Does anyone know what is happening and some way to make the installation
>> work? Thank you!
>>
>> Best regards,
>> Matheus
>>
>> _______________________________________________
>> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>> -- http://www.spatialys.com
>> My software is free, but my time generally not.
>>
>>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210928/963a91ae/attachment.html>

From rlc5m8 at mail.missouri.edu  Tue Sep 28 16:37:57 2021
From: rlc5m8 at mail.missouri.edu (Chastain, Raymond Lee (MU-Student))
Date: Tue, 28 Sep 2021 23:37:57 +0000
Subject: [gdal-dev] Blue artifact dots in shadows when using GDAL to create
 mosaics
Message-ID: <CY4PR01MB24712E0E26884A7C826F0F479FA89@CY4PR01MB2471.prod.exchangelabs.com>

Process is very simple

  1.  Take our tiles and build a virtual raster:
gdalbuildvrt -r lanczos -resolution HIGHEST output.vrt -input_file_list input_file_list.txt
  2.  Convert our virtual raster to a GeoTIFF:
  3.  gdal_translate -of GTIFF ./output.vrt ./output.tif

The artifacts occur with all resolution methods (nearest, bilinear, cubic, cubicspline, lanczos, average, mode) to varying degrees.

It appears to worsen when more and more tiles overlay a location and when more scaling is needed.

I can provide a sample case that reproduces this:

Public Drive Link to archive: https://drive.google.com/file/d/1Tu4_A5NLiG0CQytuIQeeqr6JOVdAZDqu/view?usp=sharing

Archive contains 6 files:

img_1.tif - A low resolution (1m) GTIFF image to be rendered behind the second image.
img_2.tif - A high resolution (0.3m) GTIFF image to be rendered above the first image.
output.vrt - The VRT we generated using the above command from Step 1.
our_output.tif - The GTIFF mosaic generated using the above gdal_translate command from Step 2.
blue_dots_in_our_output.png - A zoomed in screenshot of some of the blue dots in the sample (the blue dots in this sample are unfortunately minor compared to what we have seen in our un-shareable data)
more_blue_dots_from_other_samples.png - A screenshot of some of the blue/yellow dots we see in some of our other samples which we cannot share.

Other relevant information:

  *   Attempted on GDAL 3.0.4, GDAL 3.2.1, and GDAL 3.2.3

Any help would be greatly appreciated,
Raymond
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210928/93d71ea3/attachment.html>

From bradh at frogmouth.net  Tue Sep 28 17:21:05 2021
From: bradh at frogmouth.net (Brad Hards)
Date: Wed, 29 Sep 2021 10:21:05 +1000
Subject: [gdal-dev] Blue artifact dots in shadows when using GDAL to
 create mosaics
In-Reply-To: <CY4PR01MB24712E0E26884A7C826F0F479FA89@CY4PR01MB2471.prod.exchangelabs.com>
References: <CY4PR01MB24712E0E26884A7C826F0F479FA89@CY4PR01MB2471.prod.exchangelabs.com>
Message-ID: <29691311.5BNXpCuWgq@audax>

On Wednesday, 29 September 2021 9:37:57 AM AEST Chastain, Raymond Lee (MU-
Student) wrote:
> Process is very simple
> 
>   1.  Take our tiles and build a virtual raster:
> gdalbuildvrt -r lanczos -resolution HIGHEST output.vrt -input_file_list
> input_file_list.txt 2.  Convert our virtual raster to a GeoTIFF:
>   3.  gdal_translate -of GTIFF ./output.vrt ./output.tif
I manually removed the NODATA part from the vrt, and it looks better. Possibly 
the nodata value in the source is bad? Or you need to put something more 
meaningful behind the images...

Brad





From even.rouault at spatialys.com  Thu Sep 30 06:46:02 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 30 Sep 2021 15:46:02 +0200
Subject: [gdal-dev] Enabling default compression for COG ?
Message-ID: <fa605624-b2cc-742b-f884-f577059e341f@spatialys.com>

Hi,

should we enable a default compression scheme for the COG driver ? I've 
heard people "complaining" about that, or people just not realizing that 
specifying a compression method was something reasonable to do. Likely a 
lossless one to be conservative. ZSTD is probably not reasonable as it's 
too non-standard outside of the GDAL/libtiff world. So the choice would 
go basically between LZW or DEFLATE. LZW has probably the best 
compatibility profile (but the less efficient). I guess that most 
browser based solutions would handle it ? Thoughts ?

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From vincent.sarago at gmail.com  Thu Sep 30 06:52:41 2021
From: vincent.sarago at gmail.com (Vincent Sarago)
Date: Thu, 30 Sep 2021 15:52:41 +0200
Subject: [gdal-dev] Enabling default compression for COG ?
In-Reply-To: <fa605624-b2cc-742b-f884-f577059e341f@spatialys.com>
References: <fa605624-b2cc-742b-f884-f577059e341f@spatialys.com>
Message-ID: <FE757135-5086-4800-B866-52450B48A354@gmail.com>

+1 
I think it?s reasonable to have a default compression. In rio-cogeo I?ve set the default to `DEFLATE` but that?s was a personal preference. 

Vincent

> On Sep 30, 2021, at 3:46 PM, Even Rouault <even.rouault at spatialys.com> wrote:
> 
> Hi,
> 
> should we enable a default compression scheme for the COG driver ? I've heard people "complaining" about that, or people just not realizing that specifying a compression method was something reasonable to do. Likely a lossless one to be conservative. ZSTD is probably not reasonable as it's too non-standard outside of the GDAL/libtiff world. So the choice would go basically between LZW or DEFLATE. LZW has probably the best compatibility profile (but the less efficient). I guess that most browser based solutions would handle it ? Thoughts ?
> 
> Even
> 
> -- 
> http://www.spatialys.com
> My software is free, but my time generally not.
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


From patrick.mckendree.young at gmail.com  Thu Sep 30 07:39:29 2021
From: patrick.mckendree.young at gmail.com (Patrick Young)
Date: Thu, 30 Sep 2021 08:39:29 -0600
Subject: [gdal-dev] Enabling default compression for COG ?
In-Reply-To: <FE757135-5086-4800-B866-52450B48A354@gmail.com>
References: <fa605624-b2cc-742b-f884-f577059e341f@spatialys.com>
 <FE757135-5086-4800-B866-52450B48A354@gmail.com>
Message-ID: <CADXYQQ7nsBBSwz36RanDT3G6c7jQFod3O+pSmSLffareRgchSg@mail.gmail.com>

Another option would be to emit a warning/suggestion when left unset.  An
added benefit would be that folks possibly self discover that they can
control the compression scheme.

P

On Thu, Sep 30, 2021, 7:53 AM Vincent Sarago <vincent.sarago at gmail.com>
wrote:

> +1
> I think it?s reasonable to have a default compression. In rio-cogeo I?ve
> set the default to `DEFLATE` but that?s was a personal preference.
>
> Vincent
>
> > On Sep 30, 2021, at 3:46 PM, Even Rouault <even.rouault at spatialys.com>
> wrote:
> >
> > Hi,
> >
> > should we enable a default compression scheme for the COG driver ? I've
> heard people "complaining" about that, or people just not realizing that
> specifying a compression method was something reasonable to do. Likely a
> lossless one to be conservative. ZSTD is probably not reasonable as it's
> too non-standard outside of the GDAL/libtiff world. So the choice would go
> basically between LZW or DEFLATE. LZW has probably the best compatibility
> profile (but the less efficient). I guess that most browser based solutions
> would handle it ? Thoughts ?
> >
> > Even
> >
> > --
> > http://www.spatialys.com
> > My software is free, but my time generally not.
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210930/a603dea0/attachment.html>

From patrick.mckendree.young at gmail.com  Thu Sep 30 09:59:59 2021
From: patrick.mckendree.young at gmail.com (Patrick Young)
Date: Thu, 30 Sep 2021 10:59:59 -0600
Subject: [gdal-dev] arm64 Impressions?
Message-ID: <CADXYQQ7Lue8RLkpF2mujSdavnPJ1cB8pDkkXOZQiJnSjdDg9wA@mail.gmail.com>

Hi,

I was curious if anyone had any thoughts about GDAL and arm64.  I saw that
Even had been playing with arm64 a bit

https://lists.osgeo.org/pipermail/gdal-dev/2021-July/054418.html

and AWS talks a lot about the efficiency of their Gravitron stuff.  Does
anyone have thoughts about arm64 and GDAL?

Best,
Patrick
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210930/55ac34b9/attachment.html>

From tobias.wendorff at tu-dortmund.de  Thu Sep 30 09:58:28 2021
From: tobias.wendorff at tu-dortmund.de (Tobias Wendorff)
Date: Thu, 30 Sep 2021 18:58:28 +0200
Subject: [gdal-dev] Enabling default compression for COG ?
In-Reply-To: <fa605624-b2cc-742b-f884-f577059e341f@spatialys.com>
References: <fa605624-b2cc-742b-f884-f577059e341f@spatialys.com>
Message-ID: <4f796631-5727-1804-533a-3558486bf913@tu-dortmund.de>

I'd give LZW a go. I've got very good experience with that, in terms of 
performance on weaker or embedded systems. However, some people still 
think that the algorithm has a protection by patents.


Am 30.09.2021 um 15:46 schrieb Even Rouault:
> should we enable a default compression scheme for the COG driver ? I've 
> heard people "complaining" about that, or people just not realizing that 
> specifying a compression method was something reasonable to do. Likely a 
> lossless one to be conservative. ZSTD is probably not reasonable as it's 
> too non-standard outside of the GDAL/libtiff world. So the choice would 
> go basically between LZW or DEFLATE. LZW has probably the best 
> compatibility profile (but the less efficient). I guess that most 
> browser based solutions would handle it ? Thoughts ?
> 
> Even
> 

From marty.sullivan at cornell.edu  Thu Sep 30 10:38:02 2021
From: marty.sullivan at cornell.edu (Marty J. Sullivan)
Date: Thu, 30 Sep 2021 17:38:02 +0000
Subject: [gdal-dev] arm64 Impressions?
In-Reply-To: <CADXYQQ7Lue8RLkpF2mujSdavnPJ1cB8pDkkXOZQiJnSjdDg9wA@mail.gmail.com>
References: <CADXYQQ7Lue8RLkpF2mujSdavnPJ1cB8pDkkXOZQiJnSjdDg9wA@mail.gmail.com>
Message-ID: <F60815F4-95D6-4C12-9108-D3ED36E8E06A@cornell.edu>

I?ve compiled and used it on the aarch64 architecture on AWS Graviton2. Works as expected and price/performance is better (as it is for pretty much everything). Highly recommended if the rest of your code can be built for arm.

From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of Patrick Young <patrick.mckendree.young at gmail.com>
Date: Thursday, September 30, 2021 at 1:00 PM
To: gdal dev <gdal-dev at lists.osgeo.org>
Subject: [gdal-dev] arm64 Impressions?

Hi,

I was curious if anyone had any thoughts about GDAL and arm64.  I saw that Even had been playing with arm64 a bit

https://lists.osgeo.org/pipermail/gdal-dev/2021-July/054418.html

and AWS talks a lot about the efficiency of their Gravitron stuff.  Does anyone have thoughts about arm64 and GDAL?

Best,
Patrick
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210930/f28250a5/attachment-0001.html>

From daniel.fred.evans at gmail.com  Thu Sep 30 10:38:52 2021
From: daniel.fred.evans at gmail.com (Daniel Evans)
Date: Thu, 30 Sep 2021 18:38:52 +0100
Subject: [gdal-dev] Enabling default compression for COG ?
In-Reply-To: <4f796631-5727-1804-533a-3558486bf913@tu-dortmund.de>
References: <fa605624-b2cc-742b-f884-f577059e341f@spatialys.com>
 <4f796631-5727-1804-533a-3558486bf913@tu-dortmund.de>
Message-ID: <CANnaQaYERBK3z71H+aZhtoqJ7Mkechn9qLfhzF2uoK6k8FhSJA@mail.gmail.com>

Another +1 here. As far as I understand, the only real point of the COG
driver is to be a quick way to get some sensible defaults for GeoTIFF
format, and compression is definitely one such sensible default.

Also, the COG spec's example GDAL command includes `-co COMPRESS=LZW`,
which might be another reason why some are surprised that the dedicated COG
driver doesn't do the same.
https://github.com/cogeotiff/cog-spec/blob/master/spec.md

Daniel

On Thu, 30 Sept 2021 at 18:30, Tobias Wendorff <
tobias.wendorff at tu-dortmund.de> wrote:

> I'd give LZW a go. I've got very good experience with that, in terms of
> performance on weaker or embedded systems. However, some people still
> think that the algorithm has a protection by patents.
>
>
> Am 30.09.2021 um 15:46 schrieb Even Rouault:
> > should we enable a default compression scheme for the COG driver ? I've
> > heard people "complaining" about that, or people just not realizing that
> > specifying a compression method was something reasonable to do. Likely a
> > lossless one to be conservative. ZSTD is probably not reasonable as it's
> > too non-standard outside of the GDAL/libtiff world. So the choice would
> > go basically between LZW or DEFLATE. LZW has probably the best
> > compatibility profile (but the less efficient). I guess that most
> > browser based solutions would handle it ? Thoughts ?
> >
> > Even
> >
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210930/5a19f239/attachment.html>

From amfriesz at gmail.com  Thu Sep 30 14:20:40 2021
From: amfriesz at gmail.com (Aaron Friesz)
Date: Thu, 30 Sep 2021 17:20:40 -0400
Subject: [gdal-dev] Problem accessing NASA Cloud Optimized GeoTIFF data
Message-ID: <CAHAWBU4hERm-CGoN47ZPDaM6AT6D+eZMXq7rOLKLwdiyq+6L9A@mail.gmail.com>

Hi,

I was recently updating the HLS tutorial to access version 2.0 and
discovered that the tutorial is no longer able to access the HLS data in
the cloud from a local Python environment. I've been trying to troubleshoot
for a couple days now with no positive results. The failure can be boiled
down to just accessing an HLS COG file using rasterio in Python (note, a
.netrc file with Earthdata login credentials is needed to access data).

```
import rasterio as rio
import os

s30_url = '
https://data.lpdaac.earthdatacloud.nasa.gov/lp-prod-protected/HLSS30.020/HLS.S30.T13TEK.2021261T175011.v2.0/HLS.S30.T13TEK.2021261T175011.v2.0.B04.tif
'

rio_env = rio.Env(GDAL_DISABLE_READDIR_ON_OPEN='EMPTY_DIR',
                  #CPL_VSIL_CURL_ALLOWED_EXTENSIONS='tif',
                  #CPL_VSIL_CURL_USE_HEAD='FALSE',
                  CPL_DEBUG='ON',
                  CPL_CURL_VERBOSE='ON',
                  GDAL_HTTP_UNSAFESSL='YES',
                  GDAL_HTTP_COOKIEFILE=os.path.expanduser('~/.edl_cookies'),
                  GDAL_HTTP_COOKIEJAR=os.path.expanduser('~/.edl_cookies'))

rio_env.__enter__()

ds = rio.open(s30_url)

```
While running a local python env (via conda) the result of the rio.open()
is a '206 status', which essentially fails the command. If I add
CPL_VSIL_CURL_USE_HEAD='FALSE' to the rio environment, I get a 'file format
not supported' error, which seems to be a red herring. I'm curious if
you've run into this type of thing before with COGs in the cloud.

The same behavior can be observed when just using the gdal command line
utilities.
```
#without --config CPL_VSIL_CURL_USE_HEAD FALSE
> gdalinfo /vsicurl/
https://data.lpdaac.earthdatacloud.nasa.gov/lp-prod-protected/HLSL30.020/HLS.L30.T10TEK.2021192T184511.v2.0/HLS.L30.T10TEK.2021192T184511.v2.0.B04.tif
--config GDAL_HTTP_COOKIEFILE ~/cookies.txt --config GDAL_HTTP_COOKIEJAR
~/cookies.txt --config GDAL_DISABLE_READDIR_ON_OPEN EMPTY_DIR --config
CPL_CURL_VERBOSE ON

...
#output
* Mark bundle as not supporting multiuse
< HTTP/1.1 206 Partial Content
< Content-Type: image/tiff
< Content-Length: 1
< Connection: keep-alive
< Date: Thu, 30 Sep 2021 20:52:14 GMT
< Last-Modified: Tue, 20 Jul 2021 20:27:33 GMT
< ETag: "85d0b4b089083135d26188a51e187788-1"
< x-amz-server-side-encryption: AES256
< Accept-Ranges: bytes
< Content-Range: bytes 0-0/14178318
< Server: AmazonS3
< X-Edge-Origin-Shield-Skipped: 0
< X-Cache: Miss from cloudfront
< Via: 1.1 130ce7c752c5865952ded89032560b33.cloudfront.net (CloudFront)
< X-Amz-Cf-Pop: MIA3-C3
< X-Amz-Cf-Id: qEq_2x3pF25dN5YMclkgRwhyTozXDexPdaQwOyJaI2VvIKhNnajozQ==
<
* Connection #1 to host d1nklfio7vscoe.cloudfront.net left intact
ERROR 11: HTTP response code: 206
gdalinfo failed - unable to open '/vsicurl/
https://data.lpdaac.earthdatacloud.nasa.gov/lp-prod-protected/HLSL30.020/HLS.L30.T10TEK.2021192T184511.v2.0/HLS.L30.T10TEK.2021192T184511.v2.0.B04.tif
'.
```

```
#with --config CPL_VSIL_CURL_USE_HEAD FALSE
> gdalinfo /vsicurl/
https://data.lpdaac.earthdatacloud.nasa.gov/lp-prod-protected/HLSL30.020/HLS.L30.T10TEK.2021192T184511.v2.0/HLS.L30.T10TEK.2021192T184511.v2.0.B04.tif
--config GDAL_HTTP_COOKIEFILE ~/cookies.txt --config GDAL_HTTP_COOKIEJAR
~/cookies.txt --config GDAL_DISABLE_READDIR_ON_OPEN EMPTY_DIR  --config
CPL_VSIL_CURL_USE_HEAD FALSE --config CPL_CURL_VERBOSE ON

...
#output
* Mark bundle as not supporting multiuse
< HTTP/1.1 200 OK
< Content-Type: image/tiff
< Content-Length: 14178318
< Connection: keep-alive
< Date: Thu, 30 Sep 2021 21:12:52 GMT
< Last-Modified: Tue, 20 Jul 2021 20:27:33 GMT
< ETag: "85d0b4b089083135d26188a51e187788-1"
< x-amz-server-side-encryption: AES256
< Accept-Ranges: bytes
< Server: AmazonS3
< X-Edge-Origin-Shield-Skipped: 0
< X-Cache: Miss from cloudfront
< Via: 1.1 8a771ca27e5a3c9e06b12b7af5d25aa4.cloudfront.net (CloudFront)
< X-Amz-Cf-Pop: MIA3-C3
< X-Amz-Cf-Id: Xzv3KWP6glYk68odo5d4KAPnzxsNUFjHRHe90EFXOKNGeYL3ea7jiA==
* Failed writing header
* Closing connection 2
* schannel: shutting down SSL/TLS connection with
d1nklfio7vscoe.cloudfront.net port 443
* WARNING: failed to save cookies in ~/cookies.txt: Failed writing received
data to disk/application
ERROR 4: `/vsicurl/
https://data.lpdaac.earthdatacloud.nasa.gov/lp-prod-protected/HLSL30.020/HLS.L30.T10TEK.2021192T184511.v2.0/HLS.L30.T10TEK.2021192T184511.v2.0.B04.tif'
not recognized as a supported file format.
gdalinfo failed - unable to open '/vsicurl/
https://data.lpdaac.earthdatacloud.nasa.gov/lp-prod-protected/HLSL30.020/HLS.L30.T10TEK.2021192T184511.v2.0/HLS.L30.T10TEK.2021192T184511.v2.0.B04.tif
'.
```

Strangely, I'm able to use the original rio/gdal configuration options if
I'm running the code in a cloud environment, that is:

> gdalinfo /vsicurl/
https://data.lpdaac.earthdatacloud.nasa.gov/lp-prod-protected/HLSL30.020/HLS.L30.T10TEK.2021192T184511.v2.0/HLS.L30.T10TEK.2021192T184511.v2.0.B04.tif
--config GDAL_HTTP_COOKIEFILE ~/cookies.txt --config GDAL_HTTP_COOKIEJAR
~/cookies.txt --config GDAL_DISABLE_READDIR_ON_OPEN EMPTY_DIR --config
CPL_CURL_VERBOSE ON

...works fine in the USGS Pangeo and Openscapes 2i2c instance in us-west2.
I get the failures on both Windows and MacOS, but my colleagues seem to be
able to run the code just fine from linux within a Docker container.

I've tried the gdalinfo commands using the gdal versions 3.1.4 through
3.2.2. Oddly, v3.2.0 succeeds in printing out the gdalinfo content, but
I've been unable to create a conda environment with that version of gdal.

I'm talking to our NASA cloud team as well to see if there was anything on
the backend that changed recently just to cover that angle. I'm hoping,
though, that I'm missing something obvious in the local configurations.

Any guidance would be appreciated.

-Aaron
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210930/cf0b3621/attachment.html>

