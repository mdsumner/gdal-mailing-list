From eruiz at aplitop.com  Wed Feb  1 07:44:33 2023
From: eruiz at aplitop.com (Elena Ruiz)
Date: Wed, 1 Feb 2023 15:44:33 +0000
Subject: [gdal-dev] Image reprojection with GDALWARP
In-Reply-To: <AM0P192MB04986E736FA34AA356973692BBD19@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
References: <AM0P192MB0498C45EB7F17306A5A21085BBD19@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
 <AM0P192MB04986E736FA34AA356973692BBD19@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
 <3d652b5c-aa92-4a2a-85be-25316f1f7b0b.ba94d704-e79f-4907-b4e6-7c540f2b307c.b3add752-1439-4835-8a5b-0c9c6ecf0177@emailsignatures365.codetwo.com>
Message-ID: <AM0P192MB049863B2586099DFEF6FFA78BBD19@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>


Hi, I'm trying to reproject images from WGS 84 / Pseudo-Mercator EPSG:3857 to ED50 / UTM zone 30N EPSG:23030, but the resulting image doesn't adapt well to drawing. I will explain it in more detail so that you understand:

I have an image in EPSG:3857, the result of a WMTS service, and a drawing in the same SRS, as you can see in the image the drawing matches the image perfectly.
Image source with drawing: https://aplitop.sharefile.com/d-s4d6dcf6d8ff34023a8b6e95277519c56

I want to convert the previous image to EPSG:23030 and I have used gdalwarp command with different parameters and I get the same result :

1.gdalwarp -s_srs EPSG:3857 -t_srs EPSG:23030 -co "TFW=YES" -overwrite "C:\Users\elena\Downloads\Nueva carpeta\imagen_t.tif" "C:\Users\elena\Downloads\Nueva carpeta\nueva_6.tif"
2.gdalwarp -s_srs EPSG:3857 -t_srs EPSG:23030 -te 335000 4084501.25 335550 4084848.75 -co "TFW=YES" -overwrite "C:\Users\elena\Downloads\Nueva carpeta\imagen_t.tif" "C:\Users\elena\Downloads\Nueva carpeta\nueva_6.tif"

And the resulting image, in addition to noticing that the road is distorted (like a staircase effect), does not match the drawing.
Image destination with drawing: https://aplitop.sharefile.com/d-s98f76513feb34c268764c0492ccb40d3
Zoom of image destination: https://aplitop.sharefile.com/d-sf9a270a9300e4ac796eddeac7131a058

I have also done the test from EPSG:23030 to EPSG:25830 and it does not do well either.
I am using the version of gdal 2.4.4 for x64, this is the link to download the source and destination image: https://aplitop.sharefile.com/d-sdae2552bd2054fdf8cc29ce5b559e278 , I hope someone can help me and tell me if there is something wrong. Regards
________________________________

[https://www.aplitop.com/descargas/firma1.jpg]


Elena Ruiz
Sofware Development & Technical Support
Tel. +34 952 43 97 71
eruiz at aplitop.com
Sumatra, 9 - 29190 M?laga (Spain)
www.aplitop.com

[cid:SocialLink_Facebook_32x32_a745adb8-c250-4372-8480-e77f503dad3d.png]<https://www.facebook.com/AplitopSL/>   [cid:SocialLink_Twitter_32x32_858247f6-9d4a-4740-a6b3-9b5ebfd98a97.png] <https://twitter.com/aplitop>    [cid:SocialLink_Linkedin_32x32_154d63de-bf68-468f-9eb0-ffed102fac77.png] <https://www.linkedin.com/company/aplitop>    [cid:SocialLink_Youtube_32x32_0dea15dd-3774-4086-be9d-f62560b70c86.png] <https://www.youtube.com/user/aplitop>


In accordance with the provisions of the European Regulation of Data Protection 2016/679 (Reglamento Europeo de Protecci?n de Datos 2016/679), we inform you that the data and the information you provide us through this medium will be used by APLITOP, S.L., with C.I.F. B-92543396 and with address at C / Sumatra, 9, Malaga, 29190, in order to answer your questions and inform you about our products. The data provided will be kept as long as it does not request its cessation and will not be transferred to third parties except in cases where there is a legal obligation. You have the right to access your personal data, correct inaccurate data or request its deletion when the data is no longer necessary for the purposes that were collected, as well as any rights recognized in the RGPD 2016/679
<https://www.aplitop.com/New/en/443/publication-of-point-clouds-on-web>

<https://www.aplitop.com/New/en/438/tcpmdt-v9-is-here><https://www.aplitop.com/Event/en/429/aplitop-at-intergeo-2022-essen>

<https://www.aplitop.com/Event/en/358/intergeo-2019>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230201/41c8d943/attachment.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Facebook_32x32_a745adb8-c250-4372-8480-e77f503dad3d.png
Type: image/png
Size: 365 bytes
Desc: SocialLink_Facebook_32x32_a745adb8-c250-4372-8480-e77f503dad3d.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230201/41c8d943/attachment.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Twitter_32x32_858247f6-9d4a-4740-a6b3-9b5ebfd98a97.png
Type: image/png
Size: 619 bytes
Desc: SocialLink_Twitter_32x32_858247f6-9d4a-4740-a6b3-9b5ebfd98a97.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230201/41c8d943/attachment-0001.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Linkedin_32x32_154d63de-bf68-468f-9eb0-ffed102fac77.png
Type: image/png
Size: 468 bytes
Desc: SocialLink_Linkedin_32x32_154d63de-bf68-468f-9eb0-ffed102fac77.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230201/41c8d943/attachment-0002.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Youtube_32x32_0dea15dd-3774-4086-be9d-f62560b70c86.png
Type: image/png
Size: 817 bytes
Desc: SocialLink_Youtube_32x32_0dea15dd-3774-4086-be9d-f62560b70c86.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230201/41c8d943/attachment-0003.png>

From even.rouault at spatialys.com  Wed Feb  1 07:58:16 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 1 Feb 2023 16:58:16 +0100
Subject: [gdal-dev] Image reprojection with GDALWARP
In-Reply-To: <AM0P192MB049863B2586099DFEF6FFA78BBD19@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
References: <AM0P192MB0498C45EB7F17306A5A21085BBD19@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
 <AM0P192MB04986E736FA34AA356973692BBD19@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
 <3d652b5c-aa92-4a2a-85be-25316f1f7b0b.ba94d704-e79f-4907-b4e6-7c540f2b307c.b3add752-1439-4835-8a5b-0c9c6ecf0177@emailsignatures365.codetwo.com>
 <AM0P192MB049863B2586099DFEF6FFA78BBD19@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
Message-ID: <81ae2229-ce2c-a644-9d9f-3fca66ab8c1b@spatialys.com>

Try adding -r bilinear or -r bicubic. By default gdalwarp performs 
nearest resampling which is rarely what you need for high quality results

Le 01/02/2023 ? 16:44, Elena Ruiz a ?crit?:
>
> Hi, I'm trying to reproject images from WGS 84 / Pseudo-Mercator 
> EPSG:3857 to ED50 / UTM zone 30N EPSG:23030, but the resulting image 
> doesn't adapt well to drawing. I will explain it in more detail so 
> that you understand:
>
> I have an image in EPSG:3857, the result of a WMTS service, and a 
> drawing in the same SRS, as you can see in the image the drawing 
> matches the image perfectly.
>
> Image source with drawing: 
> https://aplitop.sharefile.com/d-s4d6dcf6d8ff34023a8b6e95277519c56
>
> I want to convert the previous image to EPSG:23030 and I have used 
> gdalwarp command with different parameters and I get the same result :
>
> 1/.gdalwarp -s_srs EPSG:3857 -t_srs EPSG:23030 -co "TFW=YES" 
> -overwrite "C:\Users\elena\Downloads\Nueva carpeta\imagen_t.tif" 
> "C:\Users\elena\Downloads\Nueva carpeta\nueva_6.tif"/
>
> 2./gdalwarp -s_srs EPSG:3857 -t_srs EPSG:23030 -te 335000 4084501.25 
> 335550 4084848.75 -co "TFW=YES" -overwrite 
> "C:\Users\elena\Downloads\Nueva carpeta\imagen_t.tif" 
> "C:\Users\elena\Downloads\Nueva carpeta\nueva_6.tif"/
>
> //
>
> And the resulting image, in addition to noticing that the road is 
> distorted (like a staircase effect), does not match the drawing.
>
> Image destination with drawing: 
> https://aplitop.sharefile.com/d-s98f76513feb34c268764c0492ccb40d3 
> <https://aplitop.sharefile.com/d-s98f76513feb34c268764c0492ccb40d3>
>
> Zoom of image destination: 
> https://aplitop.sharefile.com/d-sf9a270a9300e4ac796eddeac7131a058 
> <https://aplitop.sharefile.com/d-sf9a270a9300e4ac796eddeac7131a058>
>
> I have also done the test from EPSG:23030 to EPSG:25830 and it does 
> not do well either.
>
> I am using the version of gdal 2.4.4 for x64, this is the link to 
> download the source and destination image: 
> https://aplitop.sharefile.com/d-sdae2552bd2054fdf8cc29ce5b559e278 , I 
> hope someone can help me and tell me if there is something wrong. Regards
>
> ------------------------------------------------------------------------
>
> 	
> *Elena Ruiz *
> Sofware Development & Technical Support
> Tel. +34 952 43 97 71
> eruiz at aplitop.com
> Sumatra, 9 - 29190 M?laga (Spain)
> *www.aplitop.com
>
> <https://www.facebook.com/AplitopSL/> <https://twitter.com/aplitop> 
> <https://www.linkedin.com/company/aplitop> 
> <https://www.youtube.com/user/aplitop>*
>
> In accordance with the provisions of the European Regulation of Data 
> Protection 2016/679 (Reglamento Europeo de Protecci?n de Datos 
> 2016/679), we inform you that the data and the information you provide 
> us through this medium will be used by APLITOP, S.L., with C.I.F. 
> B-92543396 and with address at C / Sumatra, 9, Malaga, 29190, in order 
> to answer your questions and inform you about our products. The data 
> provided will be kept as long as it does not request its cessation and 
> will not be transferred to third parties except in cases where there 
> is a legal obligation. You have the right to access your personal 
> data, correct inaccurate data or request its deletion when the data is 
> no longer necessary for the purposes that were collected, as well as 
> any rights recognized in the RGPD 2016/679
>
>
>
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230201/05d92112/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Facebook_32x32_a745adb8-c250-4372-8480-e77f503dad3d.png
Type: image/png
Size: 365 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230201/05d92112/attachment-0004.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Twitter_32x32_858247f6-9d4a-4740-a6b3-9b5ebfd98a97.png
Type: image/png
Size: 619 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230201/05d92112/attachment-0005.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Linkedin_32x32_154d63de-bf68-468f-9eb0-ffed102fac77.png
Type: image/png
Size: 468 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230201/05d92112/attachment-0006.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Youtube_32x32_0dea15dd-3774-4086-be9d-f62560b70c86.png
Type: image/png
Size: 817 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230201/05d92112/attachment-0007.png>

From eruiz at aplitop.com  Wed Feb  1 09:06:22 2023
From: eruiz at aplitop.com (Elena Ruiz)
Date: Wed, 1 Feb 2023 17:06:22 +0000
Subject: [gdal-dev] Image reprojection with GDALWARP
In-Reply-To: <81ae2229-ce2c-a644-9d9f-3fca66ab8c1b@spatialys.com>
References: <AM0P192MB0498C45EB7F17306A5A21085BBD19@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
 <AM0P192MB04986E736FA34AA356973692BBD19@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
 <3d652b5c-aa92-4a2a-85be-25316f1f7b0b.ba94d704-e79f-4907-b4e6-7c540f2b307c.b3add752-1439-4835-8a5b-0c9c6ecf0177@emailsignatures365.codetwo.com>
 <AM0P192MB049863B2586099DFEF6FFA78BBD19@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
 <81ae2229-ce2c-a644-9d9f-3fca66ab8c1b@spatialys.com>
Message-ID: <AM0P192MB04988780954BDC4B03062251BBD19@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>

Hello, thank you very much for answering, I have added the "-r bilinear" option to the gdalwarp command and this solves the distortion problem, but the reprojection is still wrong with the coordinates of the drawing matching those of the image, and the drawing does not fit the image as it does the original image. How do I have to call gdalwarp so that it does the reprojection correctly, that is, in addition to modifying the image that changes the coordinates and the image projection system? Regards




________________________________


Elena Ruiz

[https://www.aplitop.com/descargas/logo.png]
Sofware Development & Technical Support
Tel.: +34 952 43 97 71
eruiz at aplitop.com
www.aplitop.com




<http://www.aplitop.com/Product/es/6/5/tcptunnel>


<http://www.aplitop.com/New/es/281/mdt-75-a-la-venta>




De: Even Rouault <even.rouault at spatialys.com>
Enviado el: mi?rcoles, 1 de febrero de 2023 16:58
Para: Elena Ruiz <eruiz at aplitop.com>; gdal-dev at lists.osgeo.org
Asunto: Re: [gdal-dev] Image reprojection with GDALWARP


Try adding -r bilinear or -r bicubic. By default gdalwarp performs nearest resampling which is rarely what you need for high quality results
Le 01/02/2023 ? 16:44, Elena Ruiz a ?crit :

Hi, I'm trying to reproject images from WGS 84 / Pseudo-Mercator EPSG:3857 to ED50 / UTM zone 30N EPSG:23030, but the resulting image doesn't adapt well to drawing. I will explain it in more detail so that you understand:

I have an image in EPSG:3857, the result of a WMTS service, and a drawing in the same SRS, as you can see in the image the drawing matches the image perfectly.
Image source with drawing: https://aplitop.sharefile.com/d-s4d6dcf6d8ff34023a8b6e95277519c56

I want to convert the previous image to EPSG:23030 and I have used gdalwarp command with different parameters and I get the same result :

1.gdalwarp -s_srs EPSG:3857 -t_srs EPSG:23030 -co "TFW=YES" -overwrite "C:\Users\elena\Downloads\Nueva carpeta\imagen_t.tif" "C:\Users\elena\Downloads\Nueva carpeta\nueva_6.tif"
2.gdalwarp -s_srs EPSG:3857 -t_srs EPSG:23030 -te 335000 4084501.25 335550 4084848.75 -co "TFW=YES" -overwrite "C:\Users\elena\Downloads\Nueva carpeta\imagen_t.tif" "C:\Users\elena\Downloads\Nueva carpeta\nueva_6.tif"

And the resulting image, in addition to noticing that the road is distorted (like a staircase effect), does not match the drawing.
Image destination with drawing: https://aplitop.sharefile.com/d-s98f76513feb34c268764c0492ccb40d3
Zoom of image destination: https://aplitop.sharefile.com/d-sf9a270a9300e4ac796eddeac7131a058

I have also done the test from EPSG:23030 to EPSG:25830 and it does not do well either.
I am using the version of gdal 2.4.4 for x64, this is the link to download the source and destination image: https://aplitop.sharefile.com/d-sdae2552bd2054fdf8cc29ce5b559e278 , I hope someone can help me and tell me if there is something wrong. Regards
________________________________

[https://www.aplitop.com/descargas/firma1.jpg]

Elena Ruiz
Sofware Development & Technical Support
Tel. +34 952 43 97 71
eruiz at aplitop.com<mailto:eruiz at aplitop.com>
Sumatra, 9 - 29190 M?laga (Spain)
www.aplitop.com<http://www.aplitop.com>

[cid:image001.png at 01D93667.DFD85B50]<https://www.facebook.com/AplitopSL/>   [cid:image002.png at 01D93667.DFD85B50] <https://twitter.com/aplitop>    [cid:image003.png at 01D93667.DFD85B50] <https://www.linkedin.com/company/aplitop>    [cid:image004.png at 01D93667.DFD85B50] <https://www.youtube.com/user/aplitop>


In accordance with the provisions of the European Regulation of Data Protection 2016/679 (Reglamento Europeo de Protecci?n de Datos 2016/679), we inform you that the data and the information you provide us through this medium will be used by APLITOP, S.L., with C.I.F. B-92543396 and with address at C / Sumatra, 9, Malaga, 29190, in order to answer your questions and inform you about our products. The data provided will be kept as long as it does not request its cessation and will not be transferred to third parties except in cases where there is a legal obligation. You have the right to access your personal data, correct inaccurate data or request its deletion when the data is no longer necessary for the purposes that were collected, as well as any rights recognized in the RGPD 2016/679







_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

https://lists.osgeo.org/mailman/listinfo/gdal-dev

--

http://www.spatialys.com

My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230201/2a6928df/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 365 bytes
Desc: image001.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230201/2a6928df/attachment-0004.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image002.png
Type: image/png
Size: 619 bytes
Desc: image002.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230201/2a6928df/attachment-0005.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image003.png
Type: image/png
Size: 468 bytes
Desc: image003.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230201/2a6928df/attachment-0006.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image004.png
Type: image/png
Size: 817 bytes
Desc: image004.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230201/2a6928df/attachment-0007.png>

From j1 at jimenezshaw.com  Wed Feb  1 09:56:55 2023
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Wed, 1 Feb 2023 18:56:55 +0100
Subject: [gdal-dev] Image reprojection with GDALWARP
In-Reply-To: <AM0P192MB04988780954BDC4B03062251BBD19@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
References: <AM0P192MB0498C45EB7F17306A5A21085BBD19@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
 <AM0P192MB04986E736FA34AA356973692BBD19@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
 <3d652b5c-aa92-4a2a-85be-25316f1f7b0b.ba94d704-e79f-4907-b4e6-7c540f2b307c.b3add752-1439-4835-8a5b-0c9c6ecf0177@emailsignatures365.codetwo.com>
 <AM0P192MB049863B2586099DFEF6FFA78BBD19@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
 <81ae2229-ce2c-a644-9d9f-3fca66ab8c1b@spatialys.com>
 <AM0P192MB04988780954BDC4B03062251BBD19@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
Message-ID: <CADRrdKvpYrxcUUEys2WT++weVj1t==R_Jks08CaUGexXTWzrLA@mail.gmail.com>

Hi Elena

I see that you are converting to ED50, a very old system. I assume
that you *have
to* do it, instead of ETRS89 (I'm sorry about that).
How big is the reprojection error? I do not find that in your previous
email. To get a proper transformation you need a grid file (
es_ign_SPED2ETV2.tif <https://cdn.proj.org/es_ign_SPED2ETV2.tif>). I do not
know if it is supported in gdal 2.4.4
The transformation from ED50 to ETRS89 is defined in different ways in
different locations.

Cheers,
Javier
.___ ._ ..._ .. . ._.  .___ .. __ . _. . __..  ... .... ._ .__
Entre dos pensamientos racionales
hay infinitos pensamientos irracionales.



On Wed, 1 Feb 2023 at 18:06, Elena Ruiz <eruiz at aplitop.com> wrote:

> Hello, thank you very much for answering, I have added the "-r bilinear"
> option to the gdalwarp command and this solves the distortion problem, but
> the reprojection is still wrong with the coordinates of the drawing
> matching those of the image, and the drawing does not fit the image as it
> does the original image. How do I have to call gdalwarp so that it does the
> reprojection correctly, that is, in addition to modifying the image that
> changes the coordinates and the image projection system? Regards
>
>
>
>
>
> ------------------------------
>
> *Elena Ruiz*
>
>
> Sofware Development & Technical Support
> Tel.: +34 952 43 97 71
> eruiz at aplitop.com
> *www.aplitop.com <http://www.aplitop.com>*
>
>
>
> <http://www.aplitop.com/Product/es/6/5/tcptunnel>
>
> <http://www.aplitop.com/New/es/281/mdt-75-a-la-venta>
>
>
>
>
>
> *De:* Even Rouault <even.rouault at spatialys.com>
> *Enviado el:* mi?rcoles, 1 de febrero de 2023 16:58
> *Para:* Elena Ruiz <eruiz at aplitop.com>; gdal-dev at lists.osgeo.org
> *Asunto:* Re: [gdal-dev] Image reprojection with GDALWARP
>
>
>
> Try adding -r bilinear or -r bicubic. By default gdalwarp performs nearest
> resampling which is rarely what you need for high quality results
>
> Le 01/02/2023 ? 16:44, Elena Ruiz a ?crit :
>
>
>
> Hi, I'm trying to reproject images from WGS 84 / Pseudo-Mercator EPSG:3857
> to ED50 / UTM zone 30N EPSG:23030, but the resulting image doesn't adapt
> well to drawing. I will explain it in more detail so that you understand:
>
>
>
> I have an image in EPSG:3857, the result of a WMTS service, and a drawing
> in the same SRS, as you can see in the image the drawing matches the image
> perfectly.
>
> Image source with drawing:
> https://aplitop.sharefile.com/d-s4d6dcf6d8ff34023a8b6e95277519c56
>
>
>
> I want to convert the previous image to EPSG:23030 and I have used
> gdalwarp command with different parameters and I get the same result :
>
>
>
> 1*.gdalwarp -s_srs EPSG:3857 -t_srs EPSG:23030 -co "TFW=YES" -overwrite
> "C:\Users\elena\Downloads\Nueva carpeta\imagen_t.tif"
> "C:\Users\elena\Downloads\Nueva carpeta\nueva_6.tif"*
>
> 2.*gdalwarp -s_srs EPSG:3857 -t_srs EPSG:23030 -te 335000 4084501.25
> 335550 4084848.75 -co "TFW=YES" -overwrite "C:\Users\elena\Downloads\Nueva
> carpeta\imagen_t.tif" "C:\Users\elena\Downloads\Nueva carpeta\nueva_6.tif"*
>
>
>
> And the resulting image, in addition to noticing that the road is
> distorted (like a staircase effect), does not match the drawing.
>
> Image destination with drawing:
> https://aplitop.sharefile.com/d-s98f76513feb34c268764c0492ccb40d3
>
> Zoom of image destination:
> https://aplitop.sharefile.com/d-sf9a270a9300e4ac796eddeac7131a058
>
>
>
> I have also done the test from EPSG:23030 to EPSG:25830 and it does not do
> well either.
>
> I am using the version of gdal 2.4.4 for x64, this is the link to download
> the source and destination image:
> https://aplitop.sharefile.com/d-sdae2552bd2054fdf8cc29ce5b559e278 , I
> hope someone can help me and tell me if there is something wrong. Regards
> ------------------------------
>
> *Elena Ruiz *
> Sofware Development & Technical Support
> Tel. +34 952 43 97 71
> eruiz at aplitop.com
> Sumatra, 9 - 29190 M?laga (Spain)
> *www.aplitop.com <http://www.aplitop.com>*
>
> <https://www.facebook.com/AplitopSL/>   <https://twitter.com/aplitop>
> <https://www.linkedin.com/company/aplitop>
> <https://www.youtube.com/user/aplitop>
>
> In accordance with the provisions of the European Regulation of Data
> Protection 2016/679 (Reglamento Europeo de Protecci?n de Datos 2016/679),
> we inform you that the data and the information you provide us through this
> medium will be used by APLITOP, S.L., with C.I.F. B-92543396 and with
> address at C / Sumatra, 9, Malaga, 29190, in order to answer your questions
> and inform you about our products. The data provided will be kept as long
> as it does not request its cessation and will not be transferred to third
> parties except in cases where there is a legal obligation. You have the
> right to access your personal data, correct inaccurate data or request its
> deletion when the data is no longer necessary for the purposes that were
> collected, as well as any rights recognized in the RGPD 2016/679
>
>
>
>
>
>
>
> _______________________________________________
>
> gdal-dev mailing list
>
> gdal-dev at lists.osgeo.org
>
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
>
> http://www.spatialys.com
>
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230201/c295e45f/attachment.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 365 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230201/c295e45f/attachment.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image002.png
Type: image/png
Size: 619 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230201/c295e45f/attachment-0001.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image003.png
Type: image/png
Size: 468 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230201/c295e45f/attachment-0002.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image004.png
Type: image/png
Size: 817 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230201/c295e45f/attachment-0003.png>

From eruiz at aplitop.com  Thu Feb  2 01:43:53 2023
From: eruiz at aplitop.com (Elena Ruiz)
Date: Thu, 2 Feb 2023 09:43:53 +0000
Subject: [gdal-dev] Image reprojection with GDALWARP
In-Reply-To: <CADRrdKvpYrxcUUEys2WT++weVj1t==R_Jks08CaUGexXTWzrLA@mail.gmail.com>
References: <AM0P192MB0498C45EB7F17306A5A21085BBD19@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
 <AM0P192MB04986E736FA34AA356973692BBD19@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
 <3d652b5c-aa92-4a2a-85be-25316f1f7b0b.ba94d704-e79f-4907-b4e6-7c540f2b307c.b3add752-1439-4835-8a5b-0c9c6ecf0177@emailsignatures365.codetwo.com>
 <AM0P192MB049863B2586099DFEF6FFA78BBD19@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
 <81ae2229-ce2c-a644-9d9f-3fca66ab8c1b@spatialys.com>
 <AM0P192MB04988780954BDC4B03062251BBD19@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
 <CADRrdKvpYrxcUUEys2WT++weVj1t==R_Jks08CaUGexXTWzrLA@mail.gmail.com>
Message-ID: <AM0P192MB0498CDD3DF7D6546D02DDF04BBD69@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>

Hi Javier,
It is true that the ED50 is a very old system, and that it is hardly used, but I came across this case and the lack of precision shocked me (they are more than 9 m), I know the grid that you suggest ((es_ign_SPED2ETV2.tif)) and it is the one that is currently used with everything related to ED50, but I assumed that this was already taken into account by GDAL when indicating the EPSG:23030 system. Is there an option in the GDAL configuration where you can indicate where to get those grids from? If it happens with ED50, it will also happen with other systems, right? How to tell GDAl or the gdalwarp command to choose the most correct or precise coordinate transformation? Greetings and thank you




________________________________


Elena Ruiz

[https://www.aplitop.com/descargas/logo.png]
Sofware Development & Technical Support
Tel.: +34 952 43 97 71
eruiz at aplitop.com
www.aplitop.com




<http://www.aplitop.com/Product/es/6/5/tcptunnel>


<http://www.aplitop.com/New/es/281/mdt-75-a-la-venta>




De: Javier Jimenez Shaw <j1 at jimenezshaw.com>
Enviado el: mi?rcoles, 1 de febrero de 2023 18:57
Para: Elena Ruiz <eruiz at aplitop.com>
CC: Even Rouault <even.rouault at spatialys.com>; gdal-dev at lists.osgeo.org
Asunto: Re: [gdal-dev] Image reprojection with GDALWARP

Hi Elena

I see that you are converting to ED50, a very old system. I assume that you have to do it, instead of ETRS89 (I'm sorry about that).
How big is the reprojection error? I do not find that in your previous email. To get a proper transformation you need a grid file (es_ign_SPED2ETV2.tif<https://cdn.proj.org/es_ign_SPED2ETV2.tif>). I do not know if it is supported in gdal 2.4.4
The transformation from ED50 to ETRS89 is defined in different ways in different locations.

Cheers,
Javier
.___ ._ ..._ .. . ._.  .___ .. __ . _. . __..  ... .... ._ .__
Entre dos pensamientos racionales
hay infinitos pensamientos irracionales.


On Wed, 1 Feb 2023 at 18:06, Elena Ruiz <eruiz at aplitop.com<mailto:eruiz at aplitop.com>> wrote:
Hello, thank you very much for answering, I have added the "-r bilinear" option to the gdalwarp command and this solves the distortion problem, but the reprojection is still wrong with the coordinates of the drawing matching those of the image, and the drawing does not fit the image as it does the original image. How do I have to call gdalwarp so that it does the reprojection correctly, that is, in addition to modifying the image that changes the coordinates and the image projection system? Regards






________________________________


Elena Ruiz


Sofware Development & Technical Support
Tel.: +34 952 43 97 71
eruiz at aplitop.com<mailto:eruiz at aplitop.com>
www.aplitop.com<http://www.aplitop.com>















De: Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>>
Enviado el: mi?rcoles, 1 de febrero de 2023 16:58
Para: Elena Ruiz <eruiz at aplitop.com<mailto:eruiz at aplitop.com>>; gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Asunto: Re: [gdal-dev] Image reprojection with GDALWARP


Try adding -r bilinear or -r bicubic. By default gdalwarp performs nearest resampling which is rarely what you need for high quality results
Le 01/02/2023 ? 16:44, Elena Ruiz a ?crit :

Hi, I'm trying to reproject images from WGS 84 / Pseudo-Mercator EPSG:3857 to ED50 / UTM zone 30N EPSG:23030, but the resulting image doesn't adapt well to drawing. I will explain it in more detail so that you understand:

I have an image in EPSG:3857, the result of a WMTS service, and a drawing in the same SRS, as you can see in the image the drawing matches the image perfectly.
Image source with drawing: https://aplitop.sharefile.com/d-s4d6dcf6d8ff34023a8b6e95277519c56

I want to convert the previous image to EPSG:23030 and I have used gdalwarp command with different parameters and I get the same result :

1.gdalwarp -s_srs EPSG:3857 -t_srs EPSG:23030 -co "TFW=YES" -overwrite "C:\Users\elena\Downloads\Nueva carpeta\imagen_t.tif" "C:\Users\elena\Downloads\Nueva carpeta\nueva_6.tif"
2.gdalwarp -s_srs EPSG:3857 -t_srs EPSG:23030 -te 335000 4084501.25 335550 4084848.75 -co "TFW=YES" -overwrite "C:\Users\elena\Downloads\Nueva carpeta\imagen_t.tif" "C:\Users\elena\Downloads\Nueva carpeta\nueva_6.tif"

And the resulting image, in addition to noticing that the road is distorted (like a staircase effect), does not match the drawing.
Image destination with drawing: https://aplitop.sharefile.com/d-s98f76513feb34c268764c0492ccb40d3
Zoom of image destination: https://aplitop.sharefile.com/d-sf9a270a9300e4ac796eddeac7131a058

I have also done the test from EPSG:23030 to EPSG:25830 and it does not do well either.
I am using the version of gdal 2.4.4 for x64, this is the link to download the source and destination image: https://aplitop.sharefile.com/d-sdae2552bd2054fdf8cc29ce5b559e278 , I hope someone can help me and tell me if there is something wrong. Regards
________________________________

Elena Ruiz
Sofware Development & Technical Support
Tel. +34 952 43 97 71
eruiz at aplitop.com<mailto:eruiz at aplitop.com>
Sumatra, 9 - 29190 M?laga (Spain)
www.aplitop.com<http://www.aplitop.com>

[cid:image001.png at 01D936F1.23CFCEE0]<https://www.facebook.com/AplitopSL/>   [cid:image002.png at 01D936F1.23CFCEE0] <https://twitter.com/aplitop>    [cid:image003.png at 01D936F1.23CFCEE0] <https://www.linkedin.com/company/aplitop>    [cid:image004.png at 01D936F1.23CFCEE0] <https://www.youtube.com/user/aplitop>


In accordance with the provisions of the European Regulation of Data Protection 2016/679 (Reglamento Europeo de Protecci?n de Datos 2016/679), we inform you that the data and the information you provide us through this medium will be used by APLITOP, S.L., with C.I.F. B-92543396 and with address at C / Sumatra, 9, Malaga, 29190, in order to answer your questions and inform you about our products. The data provided will be kept as long as it does not request its cessation and will not be transferred to third parties except in cases where there is a legal obligation. You have the right to access your personal data, correct inaccurate data or request its deletion when the data is no longer necessary for the purposes that were collected, as well as any rights recognized in the RGPD 2016/679





_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

https://lists.osgeo.org/mailman/listinfo/gdal-dev

--

http://www.spatialys.com

My software is free, but my time generally not.
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230202/f0f0fd84/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 365 bytes
Desc: image001.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230202/f0f0fd84/attachment-0004.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image002.png
Type: image/png
Size: 619 bytes
Desc: image002.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230202/f0f0fd84/attachment-0005.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image003.png
Type: image/png
Size: 468 bytes
Desc: image003.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230202/f0f0fd84/attachment-0006.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image004.png
Type: image/png
Size: 817 bytes
Desc: image004.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230202/f0f0fd84/attachment-0007.png>

From jukka.rahkonen at maanmittauslaitos.fi  Thu Feb  2 02:26:33 2023
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Thu, 2 Feb 2023 10:26:33 +0000
Subject: [gdal-dev] Image reprojection with GDALWARP
In-Reply-To: <AM0P192MB0498CDD3DF7D6546D02DDF04BBD69@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
References: <AM0P192MB0498C45EB7F17306A5A21085BBD19@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
 <AM0P192MB04986E736FA34AA356973692BBD19@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
 <3d652b5c-aa92-4a2a-85be-25316f1f7b0b.ba94d704-e79f-4907-b4e6-7c540f2b307c.b3add752-1439-4835-8a5b-0c9c6ecf0177@emailsignatures365.codetwo.com>
 <AM0P192MB049863B2586099DFEF6FFA78BBD19@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
 <81ae2229-ce2c-a644-9d9f-3fca66ab8c1b@spatialys.com>
 <AM0P192MB04988780954BDC4B03062251BBD19@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
 <CADRrdKvpYrxcUUEys2WT++weVj1t==R_Jks08CaUGexXTWzrLA@mail.gmail.com>
 <AM0P192MB0498CDD3DF7D6546D02DDF04BBD69@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
Message-ID: <AM0PR09MB321963224839930D70363679FDD69@AM0PR09MB3219.eurprd09.prod.outlook.com>

Hi,

There is a PROJ-data repository https://github.com/OSGeo/PROJ-data/ that contains lots of public grid-shift files, including https://github.com/OSGeo/PROJ-data/blob/master/es_ign/es_ign_SPED2ETV2.tif.

You can check from your local Proj data directory if the grid shift file is installed or not. For example OSGeo4W puts they info ...OSGeo4W\share\proj. But grid shift file is used automatically only when Proj thinks that it is used in the most suitable operation that it knows. In this case the operation is placed into 6th place as can be checked with the Proj utility "projinfo". It is possible to force the use of a preferred operation by using the Proj pipeline string.

projinfo -s EPSG:3857 -t EPSG:23030 --spatial-test intersects
...
Operation No. 6:

unknown id, Inverse of Popular Visualisation Pseudo-Mercator + Inverse of ED50 to WGS 84 (41) + UTM zone 30N, 1 m, Spain - mainland, Balearic Islands, Ceuta and Melila - onshore.

PROJ string:
+proj=pipeline
  +step +inv +proj=webmerc +lat_0=0 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84
  +step +inv +proj=hgridshift +grids=es_ign_SPED2ETV2.tif
  +step +proj=utm +zone=30 +ellps=intl

WKT2:2019 string:
CONCATENATEDOPERATION["Inverse of Popular Visualisation Pseudo-Mercator + Inverse of ED50 to WGS 84 (41) + UTM zone 30N",
    SOURCECRS[
        PROJCRS["WGS 84 / Pseudo-Mercator",
            BASEGEOGCRS["WGS 84",
                ENSEMBLE["World Geodetic System 1984 ensemble",
                    MEMBER["World Geodetic System 1984 (Transit)"],
                    MEMBER["World Geodetic System 1984 (G730)"],
                    MEMBER["World Geodetic System 1984 (G873)"],
                    MEMBER["World Geodetic System 1984 (G1150)"],
                    MEMBER["World Geodetic System 1984 (G1674)"],
                    MEMBER["World Geodetic System 1984 (G1762)"],
                    MEMBER["World Geodetic System 1984 (G2139)"],
                    ELLIPSOID["WGS 84",6378137,298.257223563,
                        LENGTHUNIT["metre",1]],
                    ENSEMBLEACCURACY[2.0]],
                PRIMEM["Greenwich",0,
                    ANGLEUNIT["degree",0.0174532925199433]],
                ID["EPSG",4326]],
            CONVERSION["Popular Visualisation Pseudo-Mercator",
                METHOD["Popular Visualisation Pseudo Mercator",
                    ID["EPSG",1024]],
                PARAMETER["Latitude of natural origin",0,
                    ANGLEUNIT["degree",0.0174532925199433],
                    ID["EPSG",8801]],
                PARAMETER["Longitude of natural origin",0,
                    ANGLEUNIT["degree",0.0174532925199433],
                    ID["EPSG",8802]],
                PARAMETER["False easting",0,
                    LENGTHUNIT["metre",1],
                    ID["EPSG",8806]],
                PARAMETER["False northing",0,
                    LENGTHUNIT["metre",1],
                    ID["EPSG",8807]]],
            CS[Cartesian,2],
                AXIS["easting (X)",east,
                    ORDER[1],
                    LENGTHUNIT["metre",1]],
                AXIS["northing (Y)",north,
                    ORDER[2],
                    LENGTHUNIT["metre",1]],
            ID["EPSG",3857]]],
    TARGETCRS[
        PROJCRS["ED50 / UTM zone 30N",
            BASEGEOGCRS["ED50",
                DATUM["European Datum 1950",
                    ELLIPSOID["International 1924",6378388,297,
                        LENGTHUNIT["metre",1]]],
                PRIMEM["Greenwich",0,
                    ANGLEUNIT["degree",0.0174532925199433]],
                ID["EPSG",4230]],
            CONVERSION["UTM zone 30N",
                METHOD["Transverse Mercator",
                    ID["EPSG",9807]],
                PARAMETER["Latitude of natural origin",0,
                    ANGLEUNIT["degree",0.0174532925199433],
                    ID["EPSG",8801]],
                PARAMETER["Longitude of natural origin",-3,
                    ANGLEUNIT["degree",0.0174532925199433],
                    ID["EPSG",8802]],
                PARAMETER["Scale factor at natural origin",0.9996,
                    SCALEUNIT["unity",1],
                    ID["EPSG",8805]],
                PARAMETER["False easting",500000,
                   LENGTHUNIT["metre",1],
                    ID["EPSG",8806]],
                PARAMETER["False northing",0,
                    LENGTHUNIT["metre",1],
                    ID["EPSG",8807]]],
            CS[Cartesian,2],
                AXIS["(E)",east,
                    ORDER[1],
                    LENGTHUNIT["metre",1]],
                AXIS["(N)",north,
                    ORDER[2],
                    LENGTHUNIT["metre",1]],
            ID["EPSG",23030]]],
    STEP[
        CONVERSION["Inverse of Popular Visualisation Pseudo-Mercator",
            METHOD["Inverse of Popular Visualisation Pseudo Mercator",
                ID["INVERSE(EPSG)",1024]],
            PARAMETER["Latitude of natural origin",0,
                ANGLEUNIT["degree",0.0174532925199433],
                ID["EPSG",8801]],
            PARAMETER["Longitude of natural origin",0,
                ANGLEUNIT["degree",0.0174532925199433],
                ID["EPSG",8802]],
            PARAMETER["False easting",0,
                LENGTHUNIT["metre",1],
                ID["EPSG",8806]],
            PARAMETER["False northing",0,
                LENGTHUNIT["metre",1],
                ID["EPSG",8807]],
            ID["INVERSE(EPSG)",3856]]],
    STEP[
        COORDINATEOPERATION["Inverse of ED50 to WGS 84 (41)",
            SOURCECRS[
                GEOGCRS["WGS 84",
                    ENSEMBLE["World Geodetic System 1984 ensemble",
                        MEMBER["World Geodetic System 1984 (Transit)"],
                        MEMBER["World Geodetic System 1984 (G730)"],
                        MEMBER["World Geodetic System 1984 (G873)"],
                        MEMBER["World Geodetic System 1984 (G1150)"],
                        MEMBER["World Geodetic System 1984 (G1674)"],
                        MEMBER["World Geodetic System 1984 (G1762)"],
                        MEMBER["World Geodetic System 1984 (G2139)"],
                        ELLIPSOID["WGS 84",6378137,298.257223563,
                            LENGTHUNIT["metre",1]],
                        ENSEMBLEACCURACY[2.0]],
                    PRIMEM["Greenwich",0,
                        ANGLEUNIT["degree",0.0174532925199433]],
                    CS[ellipsoidal,2],
                        AXIS["geodetic latitude (Lat)",north,
                            ORDER[1],
                            ANGLEUNIT["degree",0.0174532925199433]],
                        AXIS["geodetic longitude (Lon)",east,
                            ORDER[2],
                            ANGLEUNIT["degree",0.0174532925199433]],
                    ID["EPSG",4326]]],
            TARGETCRS[
                GEOGCRS["ED50",
                    DATUM["European Datum 1950",
                        ELLIPSOID["International 1924",6378388,297,
                            LENGTHUNIT["metre",1]]],
                    PRIMEM["Greenwich",0,
                        ANGLEUNIT["degree",0.0174532925199433]],
                    CS[ellipsoidal,2],
                        AXIS["geodetic latitude (Lat)",north,
                            ORDER[1],
                            ANGLEUNIT["degree",0.0174532925199433]],
                        AXIS["geodetic longitude (Lon)",east,
                            ORDER[2],
                            ANGLEUNIT["degree",0.0174532925199433]],
                    ID["EPSG",4230]]],
            METHOD["Inverse of HORIZONTAL_SHIFT_GTIFF"],
            PARAMETERFILE["Latitude and longitude difference file","es_ign_SPED2ETV2.tif"],
            OPERATIONACCURACY[1.0],
            ID["INVERSE(DERIVED_FROM(EPSG))",15933],
            REMARK["Parameter values from ED50 to ETRS89 (12) (code 15932). Assumes ETRS89 and WGS 84 can be considered the same to within the accuracy of the transformation. Replaces ED50 to WGS 84 (40) - see supersession record."]]],
    STEP[
        CONVERSION["UTM zone 30N",
            METHOD["Transverse Mercator",
                ID["EPSG",9807]],
            PARAMETER["Latitude of natural origin",0,
                ANGLEUNIT["degree",0.0174532925199433],
                ID["EPSG",8801]],
            PARAMETER["Longitude of natural origin",-3,
                ANGLEUNIT["degree",0.0174532925199433],
                ID["EPSG",8802]],
            PARAMETER["Scale factor at natural origin",0.9996,
                SCALEUNIT["unity",1],
                ID["EPSG",8805]],
            PARAMETER["False easting",500000,
                LENGTHUNIT["metre",1],
                ID["EPSG",8806]],
            PARAMETER["False northing",0,
                LENGTHUNIT["metre",1],
                ID["EPSG",8807]],
            ID["EPSG",16030]]],
    USAGE[
        SCOPE["unknown"],
        AREA["Spain - mainland, Balearic Islands, Ceuta and Melila - onshore."],
        BBOX[35.26,-9.37,43.82,4.39]]]

-Jukka Rahkonen-

L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Elena Ruiz
L?hetetty: torstai 2. helmikuuta 2023 11.44
Vastaanottaja: Javier Jimenez Shaw <j1 at jimenezshaw.com>
Kopio: gdal-dev at lists.osgeo.org
Aihe: Re: [gdal-dev] Image reprojection with GDALWARP

Hi Javier,
It is true that the ED50 is a very old system, and that it is hardly used, but I came across this case and the lack of precision shocked me (they are more than 9 m), I know the grid that you suggest ((es_ign_SPED2ETV2.tif)) and it is the one that is currently used with everything related to ED50, but I assumed that this was already taken into account by GDAL when indicating the EPSG:23030 system. Is there an option in the GDAL configuration where you can indicate where to get those grids from? If it happens with ED50, it will also happen with other systems, right? How to tell GDAl or the gdalwarp command to choose the most correct or precise coordinate transformation? Greetings and thank you




________________________________

Elena Ruiz

[https://www.aplitop.com/descargas/logo.png]
Sofware Development & Technical Support
Tel.: +34 952 43 97 71
eruiz at aplitop.com<mailto:eruiz at aplitop.com>
www.aplitop.com<http://www.aplitop.com>










De: Javier Jimenez Shaw <j1 at jimenezshaw.com<mailto:j1 at jimenezshaw.com>>
Enviado el: mi?rcoles, 1 de febrero de 2023 18:57
Para: Elena Ruiz <eruiz at aplitop.com<mailto:eruiz at aplitop.com>>
CC: Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>>; gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Asunto: Re: [gdal-dev] Image reprojection with GDALWARP

Hi Elena

I see that you are converting to ED50, a very old system. I assume that you have to do it, instead of ETRS89 (I'm sorry about that).
How big is the reprojection error? I do not find that in your previous email. To get a proper transformation you need a grid file (es_ign_SPED2ETV2.tif<https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fcdn.proj.org%2Fes_ign_SPED2ETV2.tif&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C2da75d97da044846b7fb08db050212f9%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638109278711733097%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000%7C%7C%7C&sdata=%2FeauKHkk8tMTyV5FLvTMqSj7KHmDEvjQRR9QNjc3l24%3D&reserved=0>). I do not know if it is supported in gdal 2.4.4
The transformation from ED50 to ETRS89 is defined in different ways in different locations.

Cheers,
Javier
.___ ._ ..._ .. . ._.  .___ .. __ . _. . __..  ... .... ._ .__
Entre dos pensamientos racionales
hay infinitos pensamientos irracionales.


On Wed, 1 Feb 2023 at 18:06, Elena Ruiz <eruiz at aplitop.com<mailto:eruiz at aplitop.com>> wrote:
Hello, thank you very much for answering, I have added the "-r bilinear" option to the gdalwarp command and this solves the distortion problem, but the reprojection is still wrong with the coordinates of the drawing matching those of the image, and the drawing does not fit the image as it does the original image. How do I have to call gdalwarp so that it does the reprojection correctly, that is, in addition to modifying the image that changes the coordinates and the image projection system? Regards




________________________________

Elena Ruiz


Sofware Development & Technical Support
Tel.: +34 952 43 97 71
eruiz at aplitop.com<mailto:eruiz at aplitop.com>
www.aplitop.com<https://eur06.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.aplitop.com%2F&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C2da75d97da044846b7fb08db050212f9%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638109278711733097%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000%7C%7C%7C&sdata=dPSweDSS2VuoGGcPQjP4nNEI3gL0AItdPZMUsPJeF%2Bw%3D&reserved=0>










De: Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>>
Enviado el: mi?rcoles, 1 de febrero de 2023 16:58
Para: Elena Ruiz <eruiz at aplitop.com<mailto:eruiz at aplitop.com>>; gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Asunto: Re: [gdal-dev] Image reprojection with GDALWARP


Try adding -r bilinear or -r bicubic. By default gdalwarp performs nearest resampling which is rarely what you need for high quality results
Le 01/02/2023 ? 16:44, Elena Ruiz a ?crit :

Hi, I'm trying to reproject images from WGS 84 / Pseudo-Mercator EPSG:3857 to ED50 / UTM zone 30N EPSG:23030, but the resulting image doesn't adapt well to drawing. I will explain it in more detail so that you understand:

I have an image in EPSG:3857, the result of a WMTS service, and a drawing in the same SRS, as you can see in the image the drawing matches the image perfectly.
Image source with drawing: https://aplitop.sharefile.com/d-s4d6dcf6d8ff34023a8b6e95277519c56<https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Faplitop.sharefile.com%2Fd-s4d6dcf6d8ff34023a8b6e95277519c56&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C2da75d97da044846b7fb08db050212f9%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638109278711733097%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000%7C%7C%7C&sdata=9HlbKtVRg8lkgeXRjWF2yrQMFeVCYlxY1Ktdg1h164A%3D&reserved=0>

I want to convert the previous image to EPSG:23030 and I have used gdalwarp command with different parameters and I get the same result :

1.gdalwarp -s_srs EPSG:3857 -t_srs EPSG:23030 -co "TFW=YES" -overwrite "C:\Users\elena\Downloads\Nueva carpeta\imagen_t.tif" "C:\Users\elena\Downloads\Nueva carpeta\nueva_6.tif"
2.gdalwarp -s_srs EPSG:3857 -t_srs EPSG:23030 -te 335000 4084501.25 335550 4084848.75 -co "TFW=YES" -overwrite "C:\Users\elena\Downloads\Nueva carpeta\imagen_t.tif" "C:\Users\elena\Downloads\Nueva carpeta\nueva_6.tif"

And the resulting image, in addition to noticing that the road is distorted (like a staircase effect), does not match the drawing.
Image destination with drawing: https://aplitop.sharefile.com/d-s98f76513feb34c268764c0492ccb40d3<https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Faplitop.sharefile.com%2Fd-s98f76513feb34c268764c0492ccb40d3&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C2da75d97da044846b7fb08db050212f9%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638109278711733097%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000%7C%7C%7C&sdata=0SEHZyxLt3BCju9dsOGb1Wkf0Zg8UPRB1RH1q1bDGj0%3D&reserved=0>
Zoom of image destination: https://aplitop.sharefile.com/d-sf9a270a9300e4ac796eddeac7131a058<https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Faplitop.sharefile.com%2Fd-sf9a270a9300e4ac796eddeac7131a058&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C2da75d97da044846b7fb08db050212f9%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638109278711889331%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000%7C%7C%7C&sdata=KWIdNuSi8aKeWfZm4p6%2B8ZDNd3I9xc1zj%2FIqI9nA%2B2c%3D&reserved=0>

I have also done the test from EPSG:23030 to EPSG:25830 and it does not do well either.
I am using the version of gdal 2.4.4 for x64, this is the link to download the source and destination image: https://aplitop.sharefile.com/d-sdae2552bd2054fdf8cc29ce5b559e278<https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Faplitop.sharefile.com%2Fd-sdae2552bd2054fdf8cc29ce5b559e278&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C2da75d97da044846b7fb08db050212f9%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638109278711889331%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000%7C%7C%7C&sdata=aYb5Wig9wrJ13soJaCSfCDR0Kaz4nT5h3zzGTrw%2F%2F%2Bs%3D&reserved=0> , I hope someone can help me and tell me if there is something wrong. Regards
________________________________
Elena Ruiz
Sofware Development & Technical Support
Tel. +34 952 43 97 71
eruiz at aplitop.com<mailto:eruiz at aplitop.com>
Sumatra, 9 - 29190 M?laga (Spain)
www.aplitop.com<https://eur06.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.aplitop.com%2F&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C2da75d97da044846b7fb08db050212f9%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638109278711889331%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000%7C%7C%7C&sdata=i%2BPF%2F84lMX0pYl06w0BXcpP%2BTQhh4diWuSqbGXPnmUA%3D&reserved=0>

[cid:image001.png at 01D936FF.CB24B080]<https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.facebook.com%2FAplitopSL%2F&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C2da75d97da044846b7fb08db050212f9%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638109278711889331%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000%7C%7C%7C&sdata=IQ4ftCJ2MBnpe9Qf1jPthGWLVEmp9fEIeoF2uxaaAe4%3D&reserved=0>   [cid:image002.png at 01D936FF.CB24B080] <https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Ftwitter.com%2Faplitop&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C2da75d97da044846b7fb08db050212f9%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638109278711889331%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000%7C%7C%7C&sdata=Ad%2F3FdKYOcbNN8Uz4zNl3VOGDhwPyV4AEy0Ata2HORw%3D&reserved=0>    [cid:image003.png at 01D936FF.CB24B080] <https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.linkedin.com%2Fcompany%2Faplitop&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C2da75d97da044846b7fb08db050212f9%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638109278711889331%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000%7C%7C%7C&sdata=MUf7Gvq8nC23izMzbD2U1tSnL10ygIAiOrG7hcyjxz8%3D&reserved=0>    [cid:image004.png at 01D936FF.CB24B080] <https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.youtube.com%2Fuser%2Faplitop&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C2da75d97da044846b7fb08db050212f9%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638109278711889331%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000%7C%7C%7C&sdata=xLPilUsHQJOXoIy1Im54sBE2QV5DSKyZH9MAlybbFng%3D&reserved=0>

In accordance with the provisions of the European Regulation of Data Protection 2016/679 (Reglamento Europeo de Protecci?n de Datos 2016/679), we inform you that the data and the information you provide us through this medium will be used by APLITOP, S.L., with C.I.F. B-92543396 and with address at C / Sumatra, 9, Malaga, 29190, in order to answer your questions and inform you about our products. The data provided will be kept as long as it does not request its cessation and will not be transferred to third parties except in cases where there is a legal obligation. You have the right to access your personal data, correct inaccurate data or request its deletion when the data is no longer necessary for the purposes that were collected, as well as any rights recognized in the RGPD 2016/679




_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

https://lists.osgeo.org/mailman/listinfo/gdal-dev<https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C2da75d97da044846b7fb08db050212f9%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638109278711889331%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000%7C%7C%7C&sdata=zW8FiL6InBqWhIGEnWNxe99276NlbG8CT0uPCLs8r10%3D&reserved=0>

--

http://www.spatialys.com<https://eur06.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.spatialys.com%2F&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C2da75d97da044846b7fb08db050212f9%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638109278711889331%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000%7C%7C%7C&sdata=wvxE%2FRf21QBgmBUWlKxRf3%2BMOS3%2FaNqL2d1XuVhcRkU%3D&reserved=0>

My software is free, but my time generally not.
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev<https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C2da75d97da044846b7fb08db050212f9%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638109278711889331%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000%7C%7C%7C&sdata=zW8FiL6InBqWhIGEnWNxe99276NlbG8CT0uPCLs8r10%3D&reserved=0>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230202/01a7cea9/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 365 bytes
Desc: image001.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230202/01a7cea9/attachment-0004.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image002.png
Type: image/png
Size: 619 bytes
Desc: image002.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230202/01a7cea9/attachment-0005.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image003.png
Type: image/png
Size: 468 bytes
Desc: image003.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230202/01a7cea9/attachment-0006.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image004.png
Type: image/png
Size: 817 bytes
Desc: image004.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230202/01a7cea9/attachment-0007.png>

From sean.gillies at gmail.com  Sat Feb  4 08:51:30 2023
From: sean.gillies at gmail.com (Sean Gillies)
Date: Sat, 4 Feb 2023 09:51:30 -0700
Subject: [gdal-dev] Call for discussion on RFC 92 text: WKB Only
 geometries
In-Reply-To: <9dced7b2-f806-9309-d6f1-f2b02a18f656@spatialys.com>
References: <9dced7b2-f806-9309-d6f1-f2b02a18f656@spatialys.com>
Message-ID: <CAOodmJp8gLQTmcb0BPYatz_F4tPXx8zrMU=M6n2fMhaFcRz8-A@mail.gmail.com>

Hi Even,

I'm not much of a C++ programmer, but wouldn't it be possible for all
OGRFeatures to carry WKB data by default and add a method to provide it to
callers? And only construct an OGRGeometry when it's asked for? Such as
when GetGeometryRef is called?

On Tue, Jan 31, 2023 at 4:27 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
> Please find for review "RFC 92 text: WKB Only geometries" at
> https://github.com/OSGeo/gdal/pull/7149
>
> This RFC provides shortcuts to avoid instantiation of full OGRGeometry
> instances
> in scenarios where only the WKB representation of geometries is needed. The
> hope is to save CPU time.
>
> This is something I wanted to at least experiment. I've mixed feelings
> if it's something we actually want to adopt.
>
> Even
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230204/300e9506/attachment.htm>

From even.rouault at spatialys.com  Sat Feb  4 10:55:37 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 4 Feb 2023 19:55:37 +0100
Subject: [gdal-dev] Call for discussion on RFC 92 text: WKB Only
 geometries
In-Reply-To: <CAOodmJp8gLQTmcb0BPYatz_F4tPXx8zrMU=M6n2fMhaFcRz8-A@mail.gmail.com>
References: <9dced7b2-f806-9309-d6f1-f2b02a18f656@spatialys.com>
 <CAOodmJp8gLQTmcb0BPYatz_F4tPXx8zrMU=M6n2fMhaFcRz8-A@mail.gmail.com>
Message-ID: <1690afd1-8779-297b-c883-9ac39691a5a7@spatialys.com>

Hi Sean,


> but wouldn't it be possible for all OGRFeatures to carry WKB data by 
> default and add a method to provide it to callers?

My understanding of what you propose would involve massive code rewrites 
in all drivers and wouldn't be desirable from a performance point of 
view, because most drivers can't generate WKB easily (PostGIS and GPKG 
are the exceptions rather the norm). So either all other drivers should 
be modified to compose WKB at hand (massive coding effort. Probably 
several weeks of effort and significant risk of regressions). Or get it 
from the ExportToWkb() method of the OGRGeometry instance they currently 
build, but then you pay the price in memory and CPU time to generate WKB 
that might not be consumed by users.

| And only construct an OGRGeometry when it's asked for? Such as when 
GetGeometryRef is called?

Good point, we could both make GetGeometryRef() and GetGeomFieldRef() 
virtual methods whose default implementation would be the same as 
currently, ie. return the value of the corresponding member variable in 
the base OGRFeature class stored with 
SetGeometry[Directly]()/SetGeomField[Directly]()

And add a new virtual method:

virtual GByte* OGRFeature::GetWKBGeometry(int iGeomField, size_t* 
pnOutSize) const

whose default implementation would just use 
GetGeomFieldRef(iGeomField)->ExportToWkb().

The few drivers that can provide a more efficient implementation (GPKG 
typically) would create a derived class OGRFeatureGPKG with a specific 
implementation of those new virtual methods to avoid systematic 
OGRGeometry instantiation. The only drawback I see is that making 
GetGeometryRef() and GetGeomFieldRef() virtual would have a slight 
performance impact, but probably small enough.


But fundamentally I'm wondering if RFC 92 hasn't been made mostly out 
fashioned now that we have RFC 86. RFC 86 generally leads to 2x speed-up 
or more on real-world datasets compared to OGRFeature iteration (as 
measured by the bench_ogr_c_api vs bench_ogr_batch utilities) on drivers 
that have implemented it (currently Arrow, Parquet, FlatGeoBuf, GPKG), 
whereas RFC 92 only applies to GPKG & PostGIS and in the best - 
artificial - case only lead to 30% speed-up.

Of course, adopting RFC 86 requires significant effort from GDAL users, 
but the benefit is really measurable whereas with RFC 92 it would be 
marginal in most scenarios. As far as I can tell, the performance boost 
of RFC 86 comes mostly from saving creation & destruction of millions of 
OGRFeature instances, its array members, string attributes, geometries 
objects, more than the columnar organization of the ArrowArray data 
structures. In the GeoPackage driver, I've also shown that it makes it 
possible for efficient multi-threading pre-fetching, totally transparent 
for the user.

But to avoid selling false hopes, the benefit of RFC 86 in end-to-end 
scenarios would probably drop significantly (at least if looking at 
performance gain in percentage. The absolute performance savings on the 
GDAL side would remain) if you need to recreate individual features 
(QGIS' QgsFeature or MapServer' msShape objects) from the content of 
ArrowArray. So this is likely a complete shift of concepts that would be 
required.

Even


>
> On Tue, Jan 31, 2023 at 4:27 AM Even Rouault 
> <even.rouault at spatialys.com> wrote:
>
>     Hi,
>
>     Please find for review "RFC 92 text: WKB Only geometries" at
>     https://github.com/OSGeo/gdal/pull/7149
>
>     This RFC provides shortcuts to avoid instantiation of full
>     OGRGeometry
>     instances
>     in scenarios where only the WKB representation of geometries is
>     needed. The
>     hope is to save CPU time.
>
>     This is something I wanted to at least experiment. I've mixed
>     feelings
>     if it's something we actually want to adopt.
>
>     Even
>
>     -- 
>     http://www.spatialys.com
>     My software is free, but my time generally not.
>
>     _______________________________________________
>     gdal-dev mailing list
>     gdal-dev at lists.osgeo.org
>     https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
> -- 
> Sean Gillies
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230204/3f2cc0ed/attachment.htm>

From Tim.Martin at os.uk  Mon Feb  6 03:03:37 2023
From: Tim.Martin at os.uk (Tim Martin)
Date: Mon, 6 Feb 2023 11:03:37 +0000
Subject: [gdal-dev] Writing concurrent indexes to a FileGDB
Message-ID: <LO4P123MB6563B435652CCA64F8D65A0685DA9@LO4P123MB6563.GBRP123.PROD.OUTLOOK.COM>

Hi GDAL Devs

I posted this question on GIS Stack Exchange and someone recommended I contact this group (https://gis.stackexchange.com/questions/451331/adding-multiple-attribute-indexes-to-filegdb-using-ogrinfo/451336#451336)

I have the unfortunate task of creating some very large FileGDB and need to add multiple indexes to several attributes on each Feature Type.

I saw that the OpenFileGDB driver under Dev is now able to Write, so am using that version, which by my testing is 3 or 4 times faster than the original FielGDB driver - which is amazing!!!

Now I need to index these columns and it has taken 26hrs to add 5 attribute indexes due to the sheer number of features (200mill or so).

So am wondering if there is a way to use ogrinfo and write indexes concurrently?

With thanks Tim


This email and any attachments are intended only for the intended recipient and may contain sensitive information. If you are not the intended recipient, please immediately delete this email and inform the sender.

OS email communications may be monitored to ensure the secure and effective operation of our systems and for other lawful purposes. Subject to contract: No rights are to be derived from any proposal contained in this email until a written agreement containing all necessary terms is executed between the relevant parties.

Thank you for your cooperation.

Ordnance Survey Limited (Company Registration number 09121572)
Registered Office: Explorer House
Adanac Drive
Southampton SO16 0AS
Tel: 03456 050505
http://www.os.uk
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230206/0b014518/attachment.htm>

From even.rouault at spatialys.com  Mon Feb  6 04:01:20 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 6 Feb 2023 13:01:20 +0100
Subject: [gdal-dev] Writing concurrent indexes to a FileGDB
In-Reply-To: <LO4P123MB6563B435652CCA64F8D65A0685DA9@LO4P123MB6563.GBRP123.PROD.OUTLOOK.COM>
References: <LO4P123MB6563B435652CCA64F8D65A0685DA9@LO4P123MB6563.GBRP123.PROD.OUTLOOK.COM>
Message-ID: <94c774e3-fba8-9d1b-8bfe-2b4ca429b491@spatialys.com>

Tim,

Currently there is no guarantee that concurrent updates to the same 
FileGDB database, either from the same process or from different 
process, are safe, as no locks are set, and the driver might cache in 
memory things assuming that nothing else changes them behind its back.

That said, I *believe* (but definitely doesn't guarantee) that you could 
create indexes on different layers/tables of a FileGDB from concurrent 
ogrinfo instances. It is probably not safe however to create indexes on 
different columns of the same table concurrently, because the 
.gdbindexes file might be written concurrently

Even

Le 06/02/2023 ? 12:03, Tim Martin via gdal-dev a ?crit?:
>
> Hi GDAL Devs
>
> I posted this question on GIS Stack Exchange and someone recommended I 
> contact this group 
> (https://gis.stackexchange.com/questions/451331/adding-multiple-attribute-indexes-to-filegdb-using-ogrinfo/451336#451336)
>
> I have the unfortunate task of creating some very large FileGDB and 
> need to add multiple indexes to several attributes on each Feature Type.
>
> I saw that the OpenFileGDB driver under Dev is now able to Write, so 
> am using that version, which by my testing is 3 or 4 times faster than 
> the original FielGDB driver ? which is amazing!!!
>
> Now I need to index these columns and it has taken 26hrs to add 5 
> attribute indexes due to the sheer number of features (200mill or so).
>
> So am wondering if there is a way to use ogrinfo and write indexes 
> concurrently?
>
> With thanks Tim
>
>
>
> This email and any attachments are intended only for the intended 
> recipient and may contain sensitive information. If you are not the 
> intended recipient, please immediately delete this email and inform 
> the sender.
>
> OS email communications may be monitored to ensure the secure and 
> effective operation of our systems and for other lawful purposes. 
> Subject to contract: No rights are to be derived from any proposal 
> contained in this email until a written agreement containing all 
> necessary terms is executed between the relevant parties.
>
> Thank you for your cooperation.
>
> Ordnance Survey Limited (Company Registration number 09121572)
> Registered Office: Explorer House
> Adanac Drive
> Southampton SO16 0AS
> Tel: 03456 050505
> http://www.os.uk
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230206/b15c1f6f/attachment.htm>

From Tim.Martin at os.uk  Mon Feb  6 04:06:50 2023
From: Tim.Martin at os.uk (Tim Martin)
Date: Mon, 6 Feb 2023 12:06:50 +0000
Subject: [gdal-dev] Writing concurrent indexes to a FileGDB
In-Reply-To: <94c774e3-fba8-9d1b-8bfe-2b4ca429b491@spatialys.com>
References: <LO4P123MB6563B435652CCA64F8D65A0685DA9@LO4P123MB6563.GBRP123.PROD.OUTLOOK.COM>
 <94c774e3-fba8-9d1b-8bfe-2b4ca429b491@spatialys.com>
Message-ID: <LO4P123MB656318E942434339950C224485DA9@LO4P123MB6563.GBRP123.PROD.OUTLOOK.COM>

Hi Even

Many thanks for your response and its great to get confirmation that I wasn't doing something wrong or missing something in the docs.

I can definitely run multiple processes that write an index on different tables in a single FileGDB at the same time and it seems "ok" - ie I haven't seen any errors.

But my tests definitely show you cannot write multiple indexes concurrently on the same table which seems to fit with the issue of the .gdbindexes file you mention.

Thanks again

Tim




From: Even Rouault <even.rouault at spatialys.com>
Sent: 06 February 2023 12:01
To: Tim Martin <Tim.Martin at os.uk>; gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Writing concurrent indexes to a FileGDB

External Email: Take care with attachments & links.


Tim,

Currently there is no guarantee that concurrent updates to the same FileGDB database, either from the same process or from different process, are safe, as no locks are set, and the driver might cache in memory things assuming that nothing else changes them behind its back.

That said, I *believe* (but definitely doesn't guarantee) that you could create indexes on different layers/tables of a FileGDB from concurrent ogrinfo instances. It is probably not safe however to create indexes on different columns of the same table concurrently, because the .gdbindexes file might be written concurrently

Even
Le 06/02/2023 ? 12:03, Tim Martin via gdal-dev a ?crit :
Hi GDAL Devs

I posted this question on GIS Stack Exchange and someone recommended I contact this group (https://gis.stackexchange.com/questions/451331/adding-multiple-attribute-indexes-to-filegdb-using-ogrinfo/451336#451336<https://eur01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgis.stackexchange.com%2Fquestions%2F451331%2Fadding-multiple-attribute-indexes-to-filegdb-using-ogrinfo%2F451336%23451336&data=05%7C01%7CTim.Martin%40os.uk%7C4ab8822f4294480dbbbf08db0839dd47%7C7988742dc5434b9a87a910a7b354d289%7C0%7C0%7C638112816847475257%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=QQPsbRNKS9SnnDeMJXYvq07Uy%2Fe2h4IGt%2Fzd53hRApQ%3D&reserved=0>)

I have the unfortunate task of creating some very large FileGDB and need to add multiple indexes to several attributes on each Feature Type.

I saw that the OpenFileGDB driver under Dev is now able to Write, so am using that version, which by my testing is 3 or 4 times faster than the original FielGDB driver - which is amazing!!!

Now I need to index these columns and it has taken 26hrs to add 5 attribute indexes due to the sheer number of features (200mill or so).

So am wondering if there is a way to use ogrinfo and write indexes concurrently?

With thanks Tim


This email and any attachments are intended only for the intended recipient and may contain sensitive information. If you are not the intended recipient, please immediately delete this email and inform the sender.

OS email communications may be monitored to ensure the secure and effective operation of our systems and for other lawful purposes. Subject to contract: No rights are to be derived from any proposal contained in this email until a written agreement containing all necessary terms is executed between the relevant parties.

Thank you for your cooperation.

Ordnance Survey Limited (Company Registration number 09121572)
Registered Office: Explorer House
Adanac Drive
Southampton SO16 0AS
Tel: 03456 050505
http://www.os.uk<https://eur01.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.os.uk%2F&data=05%7C01%7CTim.Martin%40os.uk%7C4ab8822f4294480dbbbf08db0839dd47%7C7988742dc5434b9a87a910a7b354d289%7C0%7C0%7C638112816847475257%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=ep6unLvZ8F7RJ8uIq2rSLXt4X0WlcOdZnKsR259FngQ%3D&reserved=0>


_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

https://lists.osgeo.org/mailman/listinfo/gdal-dev<https://eur01.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&data=05%7C01%7CTim.Martin%40os.uk%7C4ab8822f4294480dbbbf08db0839dd47%7C7988742dc5434b9a87a910a7b354d289%7C0%7C0%7C638112816847631480%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=slNtsriM%2Bd%2FIuMOOZlROtgj4LOiELXh3QHiAsWdNBU4%3D&reserved=0>

--

http://www.spatialys.com<https://eur01.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.spatialys.com%2F&data=05%7C01%7CTim.Martin%40os.uk%7C4ab8822f4294480dbbbf08db0839dd47%7C7988742dc5434b9a87a910a7b354d289%7C0%7C0%7C638112816847631480%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=AmRBIbuSyjqnkz3pyZ3V0qwtZFxjp2SV1xZcWJ4RJtY%3D&reserved=0>

My software is free, but my time generally not.


This email and any attachments are intended only for the intended recipient and may contain sensitive information. If you are not the intended recipient, please immediately delete this email and inform the sender.

OS email communications may be monitored to ensure the secure and effective operation of our systems and for other lawful purposes. Subject to contract: No rights are to be derived from any proposal contained in this email until a written agreement containing all necessary terms is executed between the relevant parties.

Thank you for your cooperation.

Ordnance Survey Limited (Company Registration number 09121572)
Registered Office: Explorer House
Adanac Drive
Southampton SO16 0AS
Tel: 03456 050505
http://www.os.uk
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230206/d903f759/attachment-0001.htm>

From szekerest at gmail.com  Mon Feb  6 11:44:03 2023
From: szekerest at gmail.com (Tamas Szekeres)
Date: Mon, 6 Feb 2023 20:44:03 +0100
Subject: [gdal-dev] MSSQLSpatial driver cmake build issues
Message-ID: <CACALY+QT1U6m3SOh=Y4p5t9AjPcA+MHSE7HVEYbtbU54MXpW2Q@mail.gmail.com>

Hi GDAL Devs,

The GISInternals build SDK has been changed to use GDAL 3.6.x and therefore
it has completely switched to the cmake build. We noticed that this change
caused to break the appveyor builds for MapServer (with the error: Unable
to find driver `MSSQLSpatial' ).
Formerly the MSQLSpatial driver has been built into GDAL by default using
the legacy ODBC driver, but we could also compile plugin builds
against the *SQL
Server Native Client* and the new *SQL Server ODBC 17* driver, too. If
either of the plugins was installed with GDAL, the plugin driver (with the
same name) superseded the functionality of the built in driver.
With the cmake build - however - if we compile a plugin build (and only one
driver is supported) the built in driver is not compiled anymore.

The problem with the current solution is that neither the native client nor
the ODBC 17 drivers are installed on Windows by default and these drivers
require additional installations. When we install these plugins with GDAL,
it may cause a failure when the driver is loaded that the the related ODBC
driver dll-s couldn't be found on the system.

Would that be possible somehow to restore the original behavior for example
by modifying the cmake build setup for MSSQLSpatial, so that we could
create a built-in driver as well as one or more plugin drivers (against
different ODBC drivers) within the same cmake configuration? I guess it
would somewhat require to add multiple *add_library* entries in the cmake
setup, but I'm not sure how that fits into the current *add_gdal_driver*
ecosystem.


Thanks,

Tamas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230206/e130899b/attachment.htm>

From even.rouault at spatialys.com  Mon Feb  6 12:13:05 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 6 Feb 2023 21:13:05 +0100
Subject: [gdal-dev] MSSQLSpatial driver cmake build issues
In-Reply-To: <CACALY+QT1U6m3SOh=Y4p5t9AjPcA+MHSE7HVEYbtbU54MXpW2Q@mail.gmail.com>
References: <CACALY+QT1U6m3SOh=Y4p5t9AjPcA+MHSE7HVEYbtbU54MXpW2Q@mail.gmail.com>
Message-ID: <ea0a240e-c026-862c-51bc-97d2d6fabd7d@spatialys.com>

Tamas,

I would just do:

- do a GDAL build with the MSSQLSpatial driver built-in with the generic 
ODBC driver: -DOGR_ENABLE_DRIVER_MSSQLSPATIAL_PLUGIN=OFF 
-DGDAL_USE_MSSQL_ODBC=OFF -DGDAL_USE_MSSQL_NCLI=OFF

- build it as plugin with MSSQL_ODBC: run cmake again with 
-DOGR_ENABLE_DRIVER_MSSQLSPATIAL_PLUGIN=ON -DGDAL_USE_MSSQL_ODBC=ON 
-DGDAL_USE_MSSQL_NCLI=OFF

- build it as plugin with MSSQL_NCLI: run cmake again with 
-DOGR_ENABLE_DRIVER_MSSQLSPATIAL_PLUGIN=ON -DGDAL_USE_MSSQL_ODBC=OFF 
-DGDAL_USE_MSSQL_NCLI=ON

Even

Le 06/02/2023 ? 20:44, Tamas Szekeres a ?crit?:
> Hi GDAL Devs,
>
> The GISInternals build SDK has been changed to use GDAL 3.6.x and 
> therefore it has completely switched to the cmake build. We noticed 
> that this change caused to break the appveyor builds for MapServer 
> (with the error: Unable to find driver `MSSQLSpatial' ).
> Formerly the MSQLSpatial driver has been built into GDAL by default 
> using the legacy ODBC driver, but we could also compile plugin builds 
> against the *SQL Server Native Client* and the new *SQL Server ODBC 
> 17* driver, too. If either of the plugins was installed with GDAL, the 
> plugin driver (with the same name) superseded the functionality of the 
> built in driver.
> With the cmake build - however - if we compile a plugin build (and 
> only one driver is supported) the built in driver is not compiled anymore.
>
> The problem with the current solution is that neither the native 
> client nor the ODBC 17 drivers are installed on Windows by default and 
> these drivers require additional installations. When we install these 
> plugins with GDAL, it may cause a failure when the driver is loaded 
> that the the related ODBC driver dll-s couldn't be found on the system.
>
> Would that be possible somehow to restore the original behavior for 
> example by modifying the cmake build setup for MSSQLSpatial, so that 
> we could create a built-in driver as well as one or more plugin 
> drivers (against different ODBC drivers) within the same cmake 
> configuration? I guess it would somewhat require to add multiple 
> *add_library* entries in the cmake setup, but I'm not sure how that 
> fits into the current *add_gdal_driver* ecosystem.
>
>
> Thanks,
>
> Tamas
>
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230206/7d0ca7b7/attachment.htm>

From szekerest at gmail.com  Mon Feb  6 14:55:56 2023
From: szekerest at gmail.com (Tamas Szekeres)
Date: Mon, 6 Feb 2023 23:55:56 +0100
Subject: [gdal-dev] MSSQLSpatial driver cmake build issues
In-Reply-To: <ea0a240e-c026-862c-51bc-97d2d6fabd7d@spatialys.com>
References: <CACALY+QT1U6m3SOh=Y4p5t9AjPcA+MHSE7HVEYbtbU54MXpW2Q@mail.gmail.com>
 <ea0a240e-c026-862c-51bc-97d2d6fabd7d@spatialys.com>
Message-ID: <CACALY+Tn2FF8gn=dKUQPpUyEd+YcQTH5GvZR8UqWNJAo2Mm0Zw@mail.gmail.com>

Even,

It looks like a good idea.

Thanks,

Tamas



Even Rouault <even.rouault at spatialys.com> ezt ?rta (id?pont: 2023. febr.
6., H, 21:13):

> Tamas,
>
> I would just do:
>
> - do a GDAL build with the MSSQLSpatial driver built-in with the generic
> ODBC driver: -DOGR_ENABLE_DRIVER_MSSQLSPATIAL_PLUGIN=OFF
> -DGDAL_USE_MSSQL_ODBC=OFF -DGDAL_USE_MSSQL_NCLI=OFF
>
> - build it as plugin with MSSQL_ODBC: run cmake again with
> -DOGR_ENABLE_DRIVER_MSSQLSPATIAL_PLUGIN=ON -DGDAL_USE_MSSQL_ODBC=ON
> -DGDAL_USE_MSSQL_NCLI=OFF
>
> - build it as plugin with MSSQL_NCLI: run cmake again with
> -DOGR_ENABLE_DRIVER_MSSQLSPATIAL_PLUGIN=ON -DGDAL_USE_MSSQL_ODBC=OFF
> -DGDAL_USE_MSSQL_NCLI=ON
>
> Even
> Le 06/02/2023 ? 20:44, Tamas Szekeres a ?crit :
>
> Hi GDAL Devs,
>
> The GISInternals build SDK has been changed to use GDAL 3.6.x and
> therefore it has completely switched to the cmake build. We noticed that
> this change caused to break the appveyor builds for MapServer (with the
> error: Unable to find driver `MSSQLSpatial' ).
> Formerly the MSQLSpatial driver has been built into GDAL by default using
> the legacy ODBC driver, but we could also compile plugin builds against the *SQL
> Server Native Client* and the new *SQL Server ODBC 17* driver, too. If
> either of the plugins was installed with GDAL, the plugin driver (with the
> same name) superseded the functionality of the built in driver.
> With the cmake build - however - if we compile a plugin build (and only
> one driver is supported) the built in driver is not compiled anymore.
>
> The problem with the current solution is that neither the native client
> nor the ODBC 17 drivers are installed on Windows by default and these
> drivers require additional installations. When we install these plugins
> with GDAL, it may cause a failure when the driver is loaded that the the
> related ODBC driver dll-s couldn't be found on the system.
>
> Would that be possible somehow to restore the original behavior for
> example by modifying the cmake build setup for MSSQLSpatial, so that we
> could create a built-in driver as well as one or more plugin drivers
> (against different ODBC drivers) within the same cmake configuration? I
> guess it would somewhat require to add multiple *add_library* entries in
> the cmake setup, but I'm not sure how that fits into the current
> *add_gdal_driver* ecosystem.
>
>
> Thanks,
>
> Tamas
>
>
>
>
>
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230206/d5d0005e/attachment.htm>

From dbaston at gmail.com  Mon Feb  6 16:58:32 2023
From: dbaston at gmail.com (Daniel Baston)
Date: Mon, 6 Feb 2023 19:58:32 -0500
Subject: [gdal-dev] Call for discussion on RFC 92 text: WKB Only
 geometries
In-Reply-To: <1690afd1-8779-297b-c883-9ac39691a5a7@spatialys.com>
References: <9dced7b2-f806-9309-d6f1-f2b02a18f656@spatialys.com>
 <CAOodmJp8gLQTmcb0BPYatz_F4tPXx8zrMU=M6n2fMhaFcRz8-A@mail.gmail.com>
 <1690afd1-8779-297b-c883-9ac39691a5a7@spatialys.com>
Message-ID: <CA+K_q_pMfACCNf7yqY8xjhb7zJ6+PftxxpGp1NEDK-qkyH0JAA@mail.gmail.com>

| And only construct an OGRGeometry when it's asked for? Such as when
GetGeometryRef is called?
I'm wondering about a more broad application of this. Would it be helpful
to have the ability to lazy-initialize an OGRGeometry from multiple source
types such as WKB and GEOS, initially storing only a reference to the
external data in WKB/GEOS/etc and actually materializing the geometry when
required? Then methods such as OGRGeometry::exportToWkb and
OGRGeometry::exportToGEOS could check the external data type and use it
directly if it is compatible, avoiding materialization. This would avoid
multiple conversions to/from GEOS in cases where operations are chained, as
well as allowing WKB to pass directly between input and output drivers that
support it. Relatedly, this ability could be used to cache external-format
data when it is generated for an OGRGeometry, avoiding inefficiencies such
as two conversions to GEOS when checking to see if two geometries intersect
before calculating their intersection.

Dan




On Sat, Feb 4, 2023 at 1:55 PM Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi Sean,
>
> but wouldn't it be possible for all OGRFeatures to carry WKB data by
> default and add a method to provide it to callers?
>
> My understanding of what you propose would involve massive code rewrites
> in all drivers and wouldn't be desirable from a performance point of view,
> because most drivers can't generate WKB easily (PostGIS and GPKG are the
> exceptions rather the norm). So either all other drivers should be modified
> to compose WKB at hand (massive coding effort. Probably several weeks of
> effort and significant risk of regressions). Or get it from the
> ExportToWkb() method of the OGRGeometry instance they currently build, but
> then you pay the price in memory and CPU time to generate WKB that might
> not be consumed by users.
>
> | And only construct an OGRGeometry when it's asked for? Such as when
> GetGeometryRef is called?
>
> Good point, we could both make GetGeometryRef() and GetGeomFieldRef()
> virtual methods whose default implementation would be the same as
> currently, ie. return the value of the corresponding member variable in the
> base OGRFeature class stored with
> SetGeometry[Directly]()/SetGeomField[Directly]()
>
> And add a new virtual method:
>
> virtual GByte* OGRFeature::GetWKBGeometry(int iGeomField, size_t*
> pnOutSize) const
>
> whose default implementation would just use
> GetGeomFieldRef(iGeomField)->ExportToWkb().
>
> The few drivers that can provide a more efficient implementation (GPKG
> typically) would create a derived class OGRFeatureGPKG with a specific
> implementation of those new virtual methods to avoid systematic OGRGeometry
> instantiation. The only drawback I see is that making GetGeometryRef() and
> GetGeomFieldRef() virtual would have a slight performance impact, but
> probably small enough.
>
>
> But fundamentally I'm wondering if RFC 92 hasn't been made mostly out
> fashioned now that we have RFC 86. RFC 86 generally leads to 2x speed-up or
> more on real-world datasets compared to OGRFeature iteration (as measured
> by the bench_ogr_c_api vs bench_ogr_batch utilities) on drivers that have
> implemented it (currently Arrow, Parquet, FlatGeoBuf, GPKG), whereas RFC 92
> only applies to GPKG & PostGIS and in the best - artificial - case only
> lead to 30% speed-up.
>
> Of course, adopting RFC 86 requires significant effort from GDAL users,
> but the benefit is really measurable whereas with RFC 92 it would be
> marginal in most scenarios. As far as I can tell, the performance boost of
> RFC 86 comes mostly from saving creation & destruction of millions of
> OGRFeature instances, its array members, string attributes, geometries
> objects, more than the columnar organization of the ArrowArray data
> structures. In the GeoPackage driver, I've also shown that it makes it
> possible for efficient multi-threading pre-fetching, totally transparent
> for the user.
>
> But to avoid selling false hopes, the benefit of RFC 86 in end-to-end
> scenarios would probably drop significantly (at least if looking at
> performance gain in percentage. The absolute performance savings on the
> GDAL side would remain) if you need to recreate individual features (QGIS'
> QgsFeature or MapServer' msShape objects) from the content of ArrowArray.
> So this is likely a complete shift of concepts that would be required.
>
> Even
>
>
>
> On Tue, Jan 31, 2023 at 4:27 AM Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> Hi,
>>
>> Please find for review "RFC 92 text: WKB Only geometries" at
>> https://github.com/OSGeo/gdal/pull/7149
>>
>> This RFC provides shortcuts to avoid instantiation of full OGRGeometry
>> instances
>> in scenarios where only the WKB representation of geometries is needed.
>> The
>> hope is to save CPU time.
>>
>> This is something I wanted to at least experiment. I've mixed feelings
>> if it's something we actually want to adopt.
>>
>> Even
>>
>> --
>> http://www.spatialys.com
>> My software is free, but my time generally not.
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
> --
> Sean Gillies
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230206/27f82958/attachment-0001.htm>

From even.rouault at spatialys.com  Mon Feb  6 17:25:57 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 7 Feb 2023 02:25:57 +0100
Subject: [gdal-dev] Call for discussion on RFC 92 text: WKB Only
 geometries
In-Reply-To: <CA+K_q_pMfACCNf7yqY8xjhb7zJ6+PftxxpGp1NEDK-qkyH0JAA@mail.gmail.com>
References: <9dced7b2-f806-9309-d6f1-f2b02a18f656@spatialys.com>
 <CAOodmJp8gLQTmcb0BPYatz_F4tPXx8zrMU=M6n2fMhaFcRz8-A@mail.gmail.com>
 <1690afd1-8779-297b-c883-9ac39691a5a7@spatialys.com>
 <CA+K_q_pMfACCNf7yqY8xjhb7zJ6+PftxxpGp1NEDK-qkyH0JAA@mail.gmail.com>
Message-ID: <97035b92-7b9d-bedf-9e27-0d24f878c39b@spatialys.com>

Hi Dan,

| And only construct an OGRGeometry when it's asked for? Such as when 
GetGeometryRef is called?

> I'm wondering about a more broad application of this. Would it be 
> helpful to have the ability to lazy-initialize an OGRGeometry from 
> multiple source types such as WKB and GEOS, initially storing only a 
> reference to the external data in WKB/GEOS/etc and actually 
> materializing the geometry when required?

That's definitely something doable. At a minimum, you would have to 
inspect the top geometry type to instantiate the appropriate OGRGeometry 
subclass, and then its members could be lazy initialized, but that means 
that all methods of OGRGeometry and its subclasses would have to do a 
check whether the object has been fully initialized. There might be 
performance implications for people doing for example 
lineString->getX(idx) to iterate on big geometries, although branch 
predictors of modern CPUs are probably very good at repeatedly 
evaluating stuff like "if (!materialized) materialize();". The main 
drawback is that is a substantial & risky change that requires to 
revisit *all* methods of the geometry classes. For setters, you would 
also have to make sure to invalidate the potentially initial WKB / GEOS 
source.

PS: I believe I joked some time ago that it was a pity that GDAL, GEOS, 
QGIS, PostGIS, ... didn't share the same geometry classes given that 
they all implement the same Single Features/ ISO SQL MM Part 3 model (it 
is kind of crazy that we have all to implement WKB, WKT, etc etc), but 
it really looks like this is completely what the RFC works around. But 
I'm afraid this "libgeom" is a pipe dream

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230207/3535a0fa/attachment.htm>

From nyall.dawson at gmail.com  Mon Feb  6 17:50:12 2023
From: nyall.dawson at gmail.com (Nyall Dawson)
Date: Tue, 7 Feb 2023 11:50:12 +1000
Subject: [gdal-dev] Call for discussion on RFC 92 text: WKB Only
 geometries
In-Reply-To: <97035b92-7b9d-bedf-9e27-0d24f878c39b@spatialys.com>
References: <9dced7b2-f806-9309-d6f1-f2b02a18f656@spatialys.com>
 <CAOodmJp8gLQTmcb0BPYatz_F4tPXx8zrMU=M6n2fMhaFcRz8-A@mail.gmail.com>
 <1690afd1-8779-297b-c883-9ac39691a5a7@spatialys.com>
 <CA+K_q_pMfACCNf7yqY8xjhb7zJ6+PftxxpGp1NEDK-qkyH0JAA@mail.gmail.com>
 <97035b92-7b9d-bedf-9e27-0d24f878c39b@spatialys.com>
Message-ID: <CAB28AsjiiQZCoCneRxs1yCay2s6gzmScDVeE=EPtru2LyrJ8aQ@mail.gmail.com>

> PS: I believe I joked some time ago that it was a pity that GDAL, GEOS, QGIS, PostGIS, ... didn't share the same geometry classes given that they all implement the same Single Features/ ISO SQL MM Part 3 model (it is kind of crazy that we have all to implement WKB, WKT, etc etc), but it really looks like this is completely what the RFC works around. But I'm afraid this "libgeom" is a pipe dream

100% agree, but GEOS gets some exemption from this list because it
doesn't have curved geometry support.

Honestly I'd be totally behind a modern "libgeom" library. Not as a
replacement for GEOS, but just to provide a common "geometry
representation" container with support for ALL the geometry types. It
could even be written in rust :)

Nyall

>
> Even
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From jukka.rahkonen at maanmittauslaitos.fi  Tue Feb  7 08:03:02 2023
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Tue, 7 Feb 2023 16:03:02 +0000
Subject: [gdal-dev] Option -te_srs disappeared from gdalwarp usage message
Message-ID: <AM0PR09MB32193224C8A23DA14B9DA18EFDDB9@AM0PR09MB3219.eurprd09.prod.outlook.com>

Hi,

The -te_srs option has disappeared from the gdalwarp usage message (Usage: gdalwarp [--help-general] [--formats] [-s_srs srs_def] ...).
It is in place in https://github.com/OSGeo/gdal/commit/df9184ef2a299967b0700ffbddd350b7bfeaa5aa but not any more in https://github.com/OSGeo/gdal/commit/bcaeb975a703bdec49aff267a1a7a8f0c35ab5f2. Could it be gone with this big commit https://github.com/OSGeo/gdal/commit/a6fc25e7ef5372f6634d0ecb787e36655b728441?

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230207/9eb22009/attachment.htm>

From even.rouault at spatialys.com  Tue Feb  7 08:13:09 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 7 Feb 2023 17:13:09 +0100
Subject: [gdal-dev] Option -te_srs disappeared from gdalwarp usage
 message
In-Reply-To: <AM0PR09MB32193224C8A23DA14B9DA18EFDDB9@AM0PR09MB3219.eurprd09.prod.outlook.com>
References: <AM0PR09MB32193224C8A23DA14B9DA18EFDDB9@AM0PR09MB3219.eurprd09.prod.outlook.com>
Message-ID: <90967b17-7c80-d5d1-1147-29e9231b7658@spatialys.com>

Fixed per 
https://github.com/OSGeo/gdal/commit/c51c827af481f6fd12c74ef611a0def475235d31

Le 07/02/2023 ? 17:03, Rahkonen Jukka a ?crit?:
>
> Hi,
>
> The -te_srs option has disappeared from the gdalwarp usage message 
> (Usage: gdalwarp [--help-general] [--formats] [-s_srs srs_def] ?).
>
> It is in place in 
> https://github.com/OSGeo/gdal/commit/df9184ef2a299967b0700ffbddd350b7bfeaa5aa 
> but not any more in 
> https://github.com/OSGeo/gdal/commit/bcaeb975a703bdec49aff267a1a7a8f0c35ab5f2. 
> Could it be gone with this big commit 
> https://github.com/OSGeo/gdal/commit/a6fc25e7ef5372f6634d0ecb787e36655b728441?
>
> -Jukka Rahkonen-
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230207/9a962e78/attachment.htm>

From mdsumner at gmail.com  Tue Feb  7 15:35:23 2023
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 8 Feb 2023 10:35:23 +1100
Subject: [gdal-dev] why padfExtent/s in gdal_alg.h ?
Message-ID: <CAAcGz9_S6A+L=ZJNm4Sf2Kgn5qrmPF5OsmCd1nOcsFtRXVev9w@mail.gmail.com>

This is not causing any problems afaict, but I happened to notice the
plural for 'padfExtents' in the gdal_alg.h signature for
GDALSuggestedWarpOutput2 compared to gdaltransformer.cpp

https://github.com/OSGeo/gdal/blob/579693c2975cda414af75239e09b8b7b952029ca/alg/gdal_alg.h#L264

https://github.com/OSGeo/gdal/blob/579693c2975cda414af75239e09b8b7b952029ca/alg/gdaltransformer.cpp#L412


The discrepancy is visible in the doc here:

https://gdal.org/api/gdal_alg.html#_CPPv424GDALSuggestedWarpOutput212GDALDatasetH19GDALTransformerFuncPvPdPiPiPdi

Cheers, Mike



-- 
Michael Sumner
Software and Database Engineer
Australian Antarctic Division
Hobart, Australia
e-mail: mdsumner at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/a34b9384/attachment.htm>

From even.rouault at spatialys.com  Tue Feb  7 15:44:44 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 8 Feb 2023 00:44:44 +0100
Subject: [gdal-dev] why padfExtent/s in gdal_alg.h ?
In-Reply-To: <CAAcGz9_S6A+L=ZJNm4Sf2Kgn5qrmPF5OsmCd1nOcsFtRXVev9w@mail.gmail.com>
References: <CAAcGz9_S6A+L=ZJNm4Sf2Kgn5qrmPF5OsmCd1nOcsFtRXVev9w@mail.gmail.com>
Message-ID: <e4c09f93-f418-6d25-1b2f-85ebc93d4aaa@spatialys.com>

Michael,

Feel free to submit a fix as there's obviously no justification for the 
discrepancy other than just being accidental.

There are likely hundreds of similar occurrences in the code base.? I 
believe there's a compiler warning (or at least cppcheck) to detect 
this, but it is not activated.

Even

Le 08/02/2023 ? 00:35, Michael Sumner a ?crit?:
> This is not causing any problems afaict, but I happened to notice the 
> plural for 'padfExtents' in the gdal_alg.h signature for 
> GDALSuggestedWarpOutput2 compared to gdaltransformer.cpp
>
> https://github.com/OSGeo/gdal/blob/579693c2975cda414af75239e09b8b7b952029ca/alg/gdal_alg.h#L264
>
> https://github.com/OSGeo/gdal/blob/579693c2975cda414af75239e09b8b7b952029ca/alg/gdaltransformer.cpp#L412
>
>
> The discrepancy is visible in the doc here:
>
> https://gdal.org/api/gdal_alg.html#_CPPv424GDALSuggestedWarpOutput212GDALDatasetH19GDALTransformerFuncPvPdPiPiPdi
>
> Cheers, Mike
>
>
>
> -- 
> Michael Sumner
> Software and Database Engineer
> Australian Antarctic Division
> Hobart, Australia
> e-mail: mdsumner at gmail.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/e7de0a0b/attachment.htm>

From mdsumner at gmail.com  Tue Feb  7 15:47:37 2023
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 8 Feb 2023 10:47:37 +1100
Subject: [gdal-dev] why padfExtent/s in gdal_alg.h ?
In-Reply-To: <e4c09f93-f418-6d25-1b2f-85ebc93d4aaa@spatialys.com>
References: <CAAcGz9_S6A+L=ZJNm4Sf2Kgn5qrmPF5OsmCd1nOcsFtRXVev9w@mail.gmail.com>
 <e4c09f93-f418-6d25-1b2f-85ebc93d4aaa@spatialys.com>
Message-ID: <CAAcGz99TaEiv_hAMPoSX7gSC8nZ=tOOQNGQ8kxv+Fcfo2qt0TQ@mail.gmail.com>

On Wed, Feb 8, 2023 at 10:44 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> Michael,
>
> Feel free to submit a fix as there's obviously no justification for the
> discrepancy other than just being accidental.
>

Ah ok, mostly I was just confused why it's not an error for the compiler
... but I'm getting used to surprises learning C++ :)

PR incoming, thanks!

Cheers, Mike



> There are likely hundreds of similar occurrences in the code base.  I
> believe there's a compiler warning (or at least cppcheck) to detect this,
> but it is not activated.
>
> Even
> Le 08/02/2023 ? 00:35, Michael Sumner a ?crit :
>
> This is not causing any problems afaict, but I happened to notice the
> plural for 'padfExtents' in the gdal_alg.h signature for
> GDALSuggestedWarpOutput2 compared to gdaltransformer.cpp
>
>
> https://github.com/OSGeo/gdal/blob/579693c2975cda414af75239e09b8b7b952029ca/alg/gdal_alg.h#L264
>
>
> https://github.com/OSGeo/gdal/blob/579693c2975cda414af75239e09b8b7b952029ca/alg/gdaltransformer.cpp#L412
>
>
> The discrepancy is visible in the doc here:
>
>
> https://gdal.org/api/gdal_alg.html#_CPPv424GDALSuggestedWarpOutput212GDALDatasetH19GDALTransformerFuncPvPdPiPiPdi
>
> Cheers, Mike
>
>
>
> --
> Michael Sumner
> Software and Database Engineer
> Australian Antarctic Division
> Hobart, Australia
> e-mail: mdsumner at gmail.com
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>

-- 
Michael Sumner
Software and Database Engineer
Australian Antarctic Division
Hobart, Australia
e-mail: mdsumner at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/6f6f4876/attachment.htm>

From ari.jolma at gmail.com  Tue Feb  7 23:42:16 2023
From: ari.jolma at gmail.com (Ari Jolma)
Date: Wed, 8 Feb 2023 09:42:16 +0200
Subject: [gdal-dev] AWS Lambda layer with GDAL python bindings
Message-ID: <8f712ee6-fa4d-bd0e-d1aa-c8bb5dc172e0@gmail.com>

Hi,

I need an AWS Lambda layer with GDAL python bindings, for "from osgeo 
import gdal", but it seems difficult to make such a layer.

In fact all I need is gdal.Open and gdal.BuildVRT - I have not dug 
deeper into rasterio, can it do those?

Anyway, I installed GDAL on a machine with python 3.8 as that's what to 
lambda runtime will be, and from there copied files to a zip with /lib 
and /python. The /lib is for the shared objects. I have now 94 libraries 
there. The error I now get from

try

 ??? from osgeo import gdal

except

in the lambda is

ImportError: /lib64/libm.so.6: version `GLIBC_2.27' not found (required 
by /opt/lib/libgdal.so.29)

this seems to be a problem as that's the lambda's libm and not the libm 
in /lib, which I assume should work.

Anybody know a solution? I tried some recipes I found from the net howto 
build such a layer but they did not work for me out of the box, so I 
tried myself.

Best,

Ari



From eruiz at aplitop.com  Wed Feb  8 01:40:15 2023
From: eruiz at aplitop.com (Elena Ruiz)
Date: Wed, 8 Feb 2023 09:40:15 +0000
Subject: [gdal-dev] Set axis order with ogr2ogr
References: <3d652b5c-aa92-4a2a-85be-25316f1f7b0b.ba94d704-e79f-4907-b4e6-7c540f2b307c.b2b8c765-dc5b-449e-9320-f9b2cd25daf6@emailsignatures365.codetwo.com>
Message-ID: <AM0P192MB0498136166FF16E7B599B3C9BBD89@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>

Hello, I need to do a conversion between GML to SHP vector files with the app ogr2ogr.exe, and be able to set the order of the axes TRADITIONAL_GIS_ORDER / AUTHORITY_COMPLIANT, in the OGR API documentation (ogr_srs_api.h), I found the following:

"This will honor the axis order advertised by the source and target SRS, as well as their "data axis to SRS axis mapping". To have a behavior similar to GDAL < 3.0, the OGR_CT_FORCE_TRADITIONAL_GIS_ORDER configuration option can be set to YES."

And from here I have deduced that I could use the OGR_CT_FORCE_TRADITIONAL_GIS_ORDER tag to establish the order of the axes and I have used the following command line:

ogr2ogr -f "ESRI Shapefile" "C:\Users\elena\Downloads\Recinto.shp" "C:\Users\elena\Downloads\Recinto.gml" -co OGR_CT_FORCE_TRADITIONAL_GIS_ORDER YES

I am using GDAL 1.1.1 on x86, for this version of GDAL it does create the SHP file, it does not give an error when executed, but it does not make any change in the order of the axes of the destination file.
But I have also tried it with version 2.4.4 for x64 and in this case it gives me the following errors:

ERROR 1: Field gml_id has a NULL content which is not allowed
ERROR 1: Unable to write feature 0 from layer LandCoverUnit.
ERROR 1: Terminating translation prematurely after failed
translation of layer LandCoverUnit (use -skipfailures to skip errors)

I attach an example file in the following link: https://aplitop.sharefile.com/d-scfcb397f54a649598913d6ae00d0d398

I hope someone can tell me how I can do what I need, thanks and regards.
________________________________

[https://www.aplitop.com/descargas/firma1.jpg]


Elena Ruiz
Sofware Development & Technical Support
Tel. +34 952 43 97 71
eruiz at aplitop.com
Sumatra, 9 - 29190 M?laga (Spain)
www.aplitop.com

[cid:SocialLink_Facebook_32x32_a745adb8-c250-4372-8480-e77f503dad3d.png]<https://www.facebook.com/AplitopSL/>   [cid:SocialLink_Twitter_32x32_858247f6-9d4a-4740-a6b3-9b5ebfd98a97.png] <https://twitter.com/aplitop>    [cid:SocialLink_Linkedin_32x32_154d63de-bf68-468f-9eb0-ffed102fac77.png] <https://www.linkedin.com/company/aplitop>    [cid:SocialLink_Youtube_32x32_0dea15dd-3774-4086-be9d-f62560b70c86.png] <https://www.youtube.com/user/aplitop>


In accordance with the provisions of the European Regulation of Data Protection 2016/679 (Reglamento Europeo de Protecci?n de Datos 2016/679), we inform you that the data and the information you provide us through this medium will be used by APLITOP, S.L., with C.I.F. B-92543396 and with address at C / Sumatra, 9, Malaga, 29190, in order to answer your questions and inform you about our products. The data provided will be kept as long as it does not request its cessation and will not be transferred to third parties except in cases where there is a legal obligation. You have the right to access your personal data, correct inaccurate data or request its deletion when the data is no longer necessary for the purposes that were collected, as well as any rights recognized in the RGPD 2016/679
<https://www.aplitop.com/New/en/443/publication-of-point-clouds-on-web>

<https://www.aplitop.com/New/en/438/tcpmdt-v9-is-here><https://www.aplitop.com/Event/en/429/aplitop-at-intergeo-2022-essen>

<https://www.aplitop.com/Event/en/358/intergeo-2019>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/31bb9470/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Facebook_32x32_a745adb8-c250-4372-8480-e77f503dad3d.png
Type: image/png
Size: 365 bytes
Desc: SocialLink_Facebook_32x32_a745adb8-c250-4372-8480-e77f503dad3d.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/31bb9470/attachment-0004.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Twitter_32x32_858247f6-9d4a-4740-a6b3-9b5ebfd98a97.png
Type: image/png
Size: 619 bytes
Desc: SocialLink_Twitter_32x32_858247f6-9d4a-4740-a6b3-9b5ebfd98a97.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/31bb9470/attachment-0005.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Linkedin_32x32_154d63de-bf68-468f-9eb0-ffed102fac77.png
Type: image/png
Size: 468 bytes
Desc: SocialLink_Linkedin_32x32_154d63de-bf68-468f-9eb0-ffed102fac77.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/31bb9470/attachment-0006.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Youtube_32x32_0dea15dd-3774-4086-be9d-f62560b70c86.png
Type: image/png
Size: 817 bytes
Desc: SocialLink_Youtube_32x32_0dea15dd-3774-4086-be9d-f62560b70c86.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/31bb9470/attachment-0007.png>

From even.rouault at spatialys.com  Wed Feb  8 02:09:49 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 8 Feb 2023 11:09:49 +0100
Subject: [gdal-dev] Set axis order with ogr2ogr
In-Reply-To: <AM0P192MB0498136166FF16E7B599B3C9BBD89@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
References: <3d652b5c-aa92-4a2a-85be-25316f1f7b0b.ba94d704-e79f-4907-b4e6-7c540f2b307c.b2b8c765-dc5b-449e-9320-f9b2cd25daf6@emailsignatures365.codetwo.com>
 <AM0P192MB0498136166FF16E7B599B3C9BBD89@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
Message-ID: <0a90bd59-7cd9-f59d-987d-0537efaab953@spatialys.com>

Elena,

I almost choked when reading "I'm using GDAL 1.1.1". Do you realize this 
version was released 16 years ago ? Even GDAL 2.4.4 is antiquated. 
Nobody longer support those versions. Please upgrade to a recent (< 2 
years) version first. I've just verified that ogr2ogr works just fine on 
our file with a recent version

Even

Le 08/02/2023 ? 10:40, Elena Ruiz a ?crit?:
>
> Hello, I need to do a conversion between GML to SHP vector files with 
> the app ogr2ogr.exe, and be able to set the order of the axes 
> TRADITIONAL_GIS_ORDER / AUTHORITY_COMPLIANT, in the OGR API 
> documentation (ogr_srs_api.h), I found the following:
>
> /"This will honor the axis order advertised by the source and target 
> SRS, as well as their ?data axis to SRS axis mapping?. To have a 
> behavior similar to GDAL < 3.0, the OGR_CT_FORCE_TRADITIONAL_GIS_ORDER 
> configuration option can be set to YES."/
>
> //
>
> And from here I have deduced that I could use the 
> OGR_CT_FORCE_TRADITIONAL_GIS_ORDER tag to establish the order of the 
> axes and I have used the following command line:
>
> /ogr2ogr -f "ESRI Shapefile" "C:\Users\elena\Downloads\Recinto.shp" 
> "C:\Users\elena\Downloads\Recinto.gml" -co 
> OGR_CT_FORCE_TRADITIONAL_GIS_ORDER YES/
>
> //
>
> I am using GDAL 1.1.1 on x86, for this version of GDAL it does create 
> the SHP file, it does not give an error when executed, but it does not 
> make any change in the order of the axes of the destination file.
>
> But I have also tried it with version 2.4.4 for x64 and in this case 
> it gives me the following errors:
>
> /ERROR 1: Field gml_id has a NULL content which is not allowed/
>
> /ERROR 1: Unable to write feature 0 from layer LandCoverUnit./
>
> /ERROR 1: Terminating translation prematurely after failed/
>
> /translation of layer LandCoverUnit (use -skipfailures to skip errors)/
>
> //
>
> I attach an example file in the following link: 
> https://aplitop.sharefile.com/d-scfcb397f54a649598913d6ae00d0d398
>
> I hope someone can tell me how I can do what I need, thanks and regards.
>
> ------------------------------------------------------------------------
>
> 	
> *Elena Ruiz *
> Sofware Development & Technical Support
> Tel. +34 952 43 97 71
> eruiz at aplitop.com
> Sumatra, 9 - 29190 M?laga (Spain)
> *www.aplitop.com
>
> <https://www.facebook.com/AplitopSL/> <https://twitter.com/aplitop> 
> <https://www.linkedin.com/company/aplitop> 
> <https://www.youtube.com/user/aplitop>*
>
> In accordance with the provisions of the European Regulation of Data 
> Protection 2016/679 (Reglamento Europeo de Protecci?n de Datos 
> 2016/679), we inform you that the data and the information you provide 
> us through this medium will be used by APLITOP, S.L., with C.I.F. 
> B-92543396 and with address at C / Sumatra, 9, Malaga, 29190, in order 
> to answer your questions and inform you about our products. The data 
> provided will be kept as long as it does not request its cessation and 
> will not be transferred to third parties except in cases where there 
> is a legal obligation. You have the right to access your personal 
> data, correct inaccurate data or request its deletion when the data is 
> no longer necessary for the purposes that were collected, as well as 
> any rights recognized in the RGPD 2016/679
>
>
>
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/82e04551/attachment.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Facebook_32x32_a745adb8-c250-4372-8480-e77f503dad3d.png
Type: image/png
Size: 365 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/82e04551/attachment.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Twitter_32x32_858247f6-9d4a-4740-a6b3-9b5ebfd98a97.png
Type: image/png
Size: 619 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/82e04551/attachment-0001.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Linkedin_32x32_154d63de-bf68-468f-9eb0-ffed102fac77.png
Type: image/png
Size: 468 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/82e04551/attachment-0002.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SocialLink_Youtube_32x32_0dea15dd-3774-4086-be9d-f62560b70c86.png
Type: image/png
Size: 817 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/82e04551/attachment-0003.png>

From knudsen.thomas at gmail.com  Wed Feb  8 02:42:14 2023
From: knudsen.thomas at gmail.com (Thomas Knudsen)
Date: Wed, 8 Feb 2023 11:42:14 +0100
Subject: [gdal-dev] why padfExtent/s in gdal_alg.h ?
In-Reply-To: <CAAcGz99TaEiv_hAMPoSX7gSC8nZ=tOOQNGQ8kxv+Fcfo2qt0TQ@mail.gmail.com>
References: <CAAcGz9_S6A+L=ZJNm4Sf2Kgn5qrmPF5OsmCd1nOcsFtRXVev9w@mail.gmail.com>
 <e4c09f93-f418-6d25-1b2f-85ebc93d4aaa@spatialys.com>
 <CAAcGz99TaEiv_hAMPoSX7gSC8nZ=tOOQNGQ8kxv+Fcfo2qt0TQ@mail.gmail.com>
Message-ID: <CAH0YoEOJP3RbKtMtbHkYRuLFDMR5fxQKhc9i7gSWV0DfzakE5A@mail.gmail.com>

>  Ah ok, mostly I was just confused why it's not an error for the compiler

The compiler only needs to know the type of the argument - in a header
file, the identifier name following
the type is for human information only

Den ons. 8. feb. 2023 kl. 00.49 skrev Michael Sumner <mdsumner at gmail.com>:

>
>
> On Wed, Feb 8, 2023 at 10:44 AM Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> Michael,
>>
>> Feel free to submit a fix as there's obviously no justification for the
>> discrepancy other than just being accidental.
>>
>
> Ah ok, mostly I was just confused why it's not an error for the compiler
> ... but I'm getting used to surprises learning C++ :)
>
> PR incoming, thanks!
>
> Cheers, Mike
>
>
>
>> There are likely hundreds of similar occurrences in the code base.  I
>> believe there's a compiler warning (or at least cppcheck) to detect this,
>> but it is not activated.
>>
>> Even
>> Le 08/02/2023 ? 00:35, Michael Sumner a ?crit :
>>
>> This is not causing any problems afaict, but I happened to notice the
>> plural for 'padfExtents' in the gdal_alg.h signature for
>> GDALSuggestedWarpOutput2 compared to gdaltransformer.cpp
>>
>>
>> https://github.com/OSGeo/gdal/blob/579693c2975cda414af75239e09b8b7b952029ca/alg/gdal_alg.h#L264
>>
>>
>> https://github.com/OSGeo/gdal/blob/579693c2975cda414af75239e09b8b7b952029ca/alg/gdaltransformer.cpp#L412
>>
>>
>> The discrepancy is visible in the doc here:
>>
>>
>> https://gdal.org/api/gdal_alg.html#_CPPv424GDALSuggestedWarpOutput212GDALDatasetH19GDALTransformerFuncPvPdPiPiPdi
>>
>> Cheers, Mike
>>
>>
>>
>> --
>> Michael Sumner
>> Software and Database Engineer
>> Australian Antarctic Division
>> Hobart, Australia
>> e-mail: mdsumner at gmail.com
>>
>> _______________________________________________
>> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>> -- http://www.spatialys.com
>> My software is free, but my time generally not.
>>
>>
>
> --
> Michael Sumner
> Software and Database Engineer
> Australian Antarctic Division
> Hobart, Australia
> e-mail: mdsumner at gmail.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/b37abd6c/attachment-0001.htm>

From eruiz at aplitop.com  Wed Feb  8 02:45:45 2023
From: eruiz at aplitop.com (Elena Ruiz)
Date: Wed, 8 Feb 2023 10:45:45 +0000
Subject: [gdal-dev] Set axis order with ogr2ogr
In-Reply-To: <0a90bd59-7cd9-f59d-987d-0537efaab953@spatialys.com>
References: <3d652b5c-aa92-4a2a-85be-25316f1f7b0b.ba94d704-e79f-4907-b4e6-7c540f2b307c.b2b8c765-dc5b-449e-9320-f9b2cd25daf6@emailsignatures365.codetwo.com>
 <AM0P192MB0498136166FF16E7B599B3C9BBD89@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
 <0a90bd59-7cd9-f59d-987d-0537efaab953@spatialys.com>
Message-ID: <AM0P192MB04984041DA3E026CF84B711BBBD89@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>

Hello, actually we use several versions of gdal and among them I have also tried it with the latest one, 3.6.2 in x64, but it gives me these errors:

ogr2ogr -f "ESRI Shapefile" "C:\Users\elena\Downloads\Recinto.shp"  "C:\Users\elena\Downloads\Recinto.gml" --config OGR_CT_FORCE_TRADITIONAL_GIS_ORDER YES --config PROJ_LIB "D:\MDT\V9\bin\gdal\gdal_latest\share"
ERROR 1: PROJ: proj_create: no database context specified
ERROR 1: PROJ: proj_create: no database context specified
ERROR 1: PROJ: proj_create: no database context specified
ERROR 1: Field gml_id has a NULL content which is not allowed
ERROR 1: Unable to write feature 0 from layer LandCoverUnit.
ERROR 1: Terminating translation prematurely after failed
translation of layer LandCoverUnit (use -skipfailures to skip errors)

But several things happen, it does not establish the PROJ_LIB directory, I am indicating the directory where the proj.db is, but it ignores it, I don't know if it needs something else. It is not recognizing the OGR_CT_FORCE_TRADITIONAL_GIS_ORDER label either, because the destination file has not modified the order of the axes, and finally it detects some errors in the GML file, and the example file is a correct GML (https://aplitop.sharefile.com/d-scfcb397f54a649598913d6ae00d0d398 ). Thank you and I hope someone can help me, regards





________________________________


Elena Ruiz

[https://www.aplitop.com/descargas/logo.png]
Sofware Development & Technical Support
Tel.: +34 952 43 97 71
eruiz at aplitop.com
www.aplitop.com




<http://www.aplitop.com/Product/es/6/5/tcptunnel>


<http://www.aplitop.com/New/es/281/mdt-75-a-la-venta>




De: Even Rouault <even.rouault at spatialys.com>
Enviado el: mi?rcoles, 8 de febrero de 2023 11:10
Para: Elena Ruiz <eruiz at aplitop.com>; gdal-dev at lists.osgeo.org
Asunto: Re: [gdal-dev] Set axis order with ogr2ogr


Elena,

I almost choked when reading "I'm using GDAL 1.1.1". Do you realize this version was released 16 years ago ? Even GDAL 2.4.4 is antiquated. Nobody longer support those versions. Please upgrade to a recent (< 2 years) version first. I've just verified that ogr2ogr works just fine on our file with a recent version

Even
Le 08/02/2023 ? 10:40, Elena Ruiz a ?crit :
Hello, I need to do a conversion between GML to SHP vector files with the app ogr2ogr.exe, and be able to set the order of the axes TRADITIONAL_GIS_ORDER / AUTHORITY_COMPLIANT, in the OGR API documentation (ogr_srs_api.h), I found the following:

"This will honor the axis order advertised by the source and target SRS, as well as their ?data axis to SRS axis mapping?. To have a behavior similar to GDAL < 3.0, the OGR_CT_FORCE_TRADITIONAL_GIS_ORDER configuration option can be set to YES."

And from here I have deduced that I could use the OGR_CT_FORCE_TRADITIONAL_GIS_ORDER tag to establish the order of the axes and I have used the following command line:

ogr2ogr -f "ESRI Shapefile" "C:\Users\elena\Downloads\Recinto.shp" "C:\Users\elena\Downloads\Recinto.gml" -co OGR_CT_FORCE_TRADITIONAL_GIS_ORDER YES

I am using GDAL 1.1.1 on x86, for this version of GDAL it does create the SHP file, it does not give an error when executed, but it does not make any change in the order of the axes of the destination file.
But I have also tried it with version 2.4.4 for x64 and in this case it gives me the following errors:

ERROR 1: Field gml_id has a NULL content which is not allowed
ERROR 1: Unable to write feature 0 from layer LandCoverUnit.
ERROR 1: Terminating translation prematurely after failed
translation of layer LandCoverUnit (use -skipfailures to skip errors)

I attach an example file in the following link: https://aplitop.sharefile.com/d-scfcb397f54a649598913d6ae00d0d398

I hope someone can tell me how I can do what I need, thanks and regards.
________________________________

[https://www.aplitop.com/descargas/firma1.jpg]

Elena Ruiz
Sofware Development & Technical Support
Tel. +34 952 43 97 71
eruiz at aplitop.com<mailto:eruiz at aplitop.com>
Sumatra, 9 - 29190 M?laga (Spain)
www.aplitop.com<http://www.aplitop.com>

[cid:image001.png at 01D93BB1.E83974B0]<https://www.facebook.com/AplitopSL/>   [cid:image002.png at 01D93BB1.E83974B0] <https://twitter.com/aplitop>    [cid:image003.png at 01D93BB1.E83974B0] <https://www.linkedin.com/company/aplitop>    [cid:image004.png at 01D93BB1.E83974B0] <https://www.youtube.com/user/aplitop>


In accordance with the provisions of the European Regulation of Data Protection 2016/679 (Reglamento Europeo de Protecci?n de Datos 2016/679), we inform you that the data and the information you provide us through this medium will be used by APLITOP, S.L., with C.I.F. B-92543396 and with address at C / Sumatra, 9, Malaga, 29190, in order to answer your questions and inform you about our products. The data provided will be kept as long as it does not request its cessation and will not be transferred to third parties except in cases where there is a legal obligation. You have the right to access your personal data, correct inaccurate data or request its deletion when the data is no longer necessary for the purposes that were collected, as well as any rights recognized in the RGPD 2016/679







_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

https://lists.osgeo.org/mailman/listinfo/gdal-dev

--

http://www.spatialys.com

My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/fd719cd1/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 365 bytes
Desc: image001.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/fd719cd1/attachment-0004.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image002.png
Type: image/png
Size: 619 bytes
Desc: image002.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/fd719cd1/attachment-0005.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image003.png
Type: image/png
Size: 468 bytes
Desc: image003.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/fd719cd1/attachment-0006.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image004.png
Type: image/png
Size: 817 bytes
Desc: image004.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/fd719cd1/attachment-0007.png>

From even.rouault at spatialys.com  Wed Feb  8 02:58:24 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 8 Feb 2023 11:58:24 +0100
Subject: [gdal-dev] Set axis order with ogr2ogr
In-Reply-To: <AM0P192MB04984041DA3E026CF84B711BBBD89@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
References: <3d652b5c-aa92-4a2a-85be-25316f1f7b0b.ba94d704-e79f-4907-b4e6-7c540f2b307c.b2b8c765-dc5b-449e-9320-f9b2cd25daf6@emailsignatures365.codetwo.com>
 <AM0P192MB0498136166FF16E7B599B3C9BBD89@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
 <0a90bd59-7cd9-f59d-987d-0537efaab953@spatialys.com>
 <AM0P192MB04984041DA3E026CF84B711BBBD89@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
Message-ID: <25e16046-7396-b6ce-8384-61c00f5447f8@spatialys.com>

Set PROJ_LIB as an environment variable (with set 
PROJ_LIB="D:\MDT\V9\bin\gdal\gdal_latest\share") rather than with 
--config, as --config is only for GDAL configuration options, and 
PROJ_LIB is only read by PROJ which reads environment variable.

And don't set OGR_CT_FORCE_TRADITIONAL_GIS_ORDER=YES. It is not needed here.

Le 08/02/2023 ? 11:45, Elena Ruiz a ?crit?:
>
> Hello, actually we use several versions of gdal and among them I have 
> also tried it with the latest one, 3.6.2 in x64, but it gives me these 
> errors:
>
> /ogr2ogr -f "ESRI Shapefile" "C:\Users\elena\Downloads\Recinto.shp" 
> ?"C:\Users\elena\Downloads\Recinto.gml" --config 
> OGR_CT_FORCE_TRADITIONAL_GIS_ORDER YES --config PROJ_LIB 
> "D:\MDT\V9\bin\gdal\gdal_latest\share"/
>
> /ERROR 1: PROJ: proj_create: no database context specified/
>
> /ERROR 1: PROJ: proj_create: no database context specified/
>
> /ERROR 1: PROJ: proj_create: no database context specified/
>
> /ERROR 1: Field gml_id has a NULL content which is not allowed/
>
> /ERROR 1: Unable to write feature 0 from layer LandCoverUnit./
>
> /ERROR 1: Terminating translation prematurely after failed/
>
> /translation of layer LandCoverUnit (use -skipfailures to skip errors)/
>
> But several things happen, it does not establish the PROJ_LIB 
> directory, I am indicating the directory where the proj.db is, but it 
> ignores it, I don't know if it needs something else. It is not 
> recognizing the OGR_CT_FORCE_TRADITIONAL_GIS_ORDER label either, 
> because the destination file has not modified the order of the axes, 
> and finally it detects some errors in the GML file, and the example 
> file is a correct GML 
> (https://aplitop.sharefile.com/d-scfcb397f54a649598913d6ae00d0d398 ). 
> Thank you and I hope someone can help me, regards
>
> ------------------------------------------------------------------------
>
> *Elena Ruiz*
>
>
> Sofware Development & Technical Support
> Tel.: +34 952 43 97 71
> eruiz at aplitop.com
> *www.aplitop.com*
>
>
>
> *De:*Even Rouault <even.rouault at spatialys.com>
> *Enviado el:* mi?rcoles, 8 de febrero de 2023 11:10
> *Para:* Elena Ruiz <eruiz at aplitop.com>; gdal-dev at lists.osgeo.org
> *Asunto:* Re: [gdal-dev] Set axis order with ogr2ogr
>
> Elena,
>
> I almost choked when reading "I'm using GDAL 1.1.1". Do you realize 
> this version was released 16 years ago ? Even GDAL 2.4.4 is 
> antiquated. Nobody longer support those versions. Please upgrade to a 
> recent (< 2 years) version first. I've just verified that ogr2ogr 
> works just fine on our file with a recent version
>
> Even
>
> Le 08/02/2023 ? 10:40, Elena Ruiz a ?crit?:
>
>     Hello, I need to do a conversion between GML to SHP vector files
>     with the app ogr2ogr.exe, and be able to set the order of the axes
>     TRADITIONAL_GIS_ORDER / AUTHORITY_COMPLIANT, in the OGR API
>     documentation (ogr_srs_api.h), I found the following:
>
>     /"This will honor the axis order advertised by the source and
>     target SRS, as well as their ?data axis to SRS axis mapping?. To
>     have a behavior similar to GDAL < 3.0, the
>     OGR_CT_FORCE_TRADITIONAL_GIS_ORDER configuration option can be set
>     to YES."/
>
>     //
>
>     And from here I have deduced that I could use the
>     OGR_CT_FORCE_TRADITIONAL_GIS_ORDER tag to establish the order of
>     the axes and I have used the following command line:
>
>     /ogr2ogr -f "ESRI Shapefile"
>     "C:\Users\elena\Downloads\Recinto.shp"
>     "C:\Users\elena\Downloads\Recinto.gml" -co
>     OGR_CT_FORCE_TRADITIONAL_GIS_ORDER YES/
>
>     //
>
>     I am using GDAL 1.1.1 on x86, for this version of GDAL it does
>     create the SHP file, it does not give an error when executed, but
>     it does not make any change in the order of the axes of the
>     destination file.
>
>     But I have also tried it with version 2.4.4 for x64 and in this
>     case it gives me the following errors:
>
>     /ERROR 1: Field gml_id has a NULL content which is not allowed/
>
>     /ERROR 1: Unable to write feature 0 from layer LandCoverUnit./
>
>     /ERROR 1: Terminating translation prematurely after failed/
>
>     /translation of layer LandCoverUnit (use -skipfailures to skip
>     errors)/
>
>     //
>
>     I attach an example file in the following link:
>     https://aplitop.sharefile.com/d-scfcb397f54a649598913d6ae00d0d398
>
>     I hope someone can tell me how I can do what I need, thanks and
>     regards.
>
>     ------------------------------------------------------------------------
>
>     	
>
>     *Elena Ruiz *
>     Sofware Development & Technical Support
>     Tel. +34 952 43 97 71
>     eruiz at aplitop.com
>     Sumatra, 9 - 29190 M?laga (Spain)
>     *www.aplitop.com <http://www.aplitop.com>**
>
>     *** <https://www.facebook.com/AplitopSL/>****
>     <https://twitter.com/aplitop>****
>     <https://www.linkedin.com/company/aplitop>****
>     <https://www.youtube.com/user/aplitop>
>
>     In accordance with the provisions of the European Regulation of
>     Data Protection 2016/679 (Reglamento Europeo de Protecci?n de
>     Datos 2016/679), we inform you that the data and the information
>     you provide us through this medium will be used by APLITOP, S.L.,
>     with C.I.F. B-92543396 and with address at C / Sumatra, 9, Malaga,
>     29190, in order to answer your questions and inform you about our
>     products. The data provided will be kept as long as it does not
>     request its cessation and will not be transferred to third parties
>     except in cases where there is a legal obligation. You have the
>     right to access your personal data, correct inaccurate data or
>     request its deletion when the data is no longer necessary for the
>     purposes that were collected, as well as any rights recognized in
>     the RGPD 2016/679
>
>
>
>
>
>
>
>     _______________________________________________
>
>     gdal-dev mailing list
>
>     gdal-dev at lists.osgeo.org
>
>     https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- 
> http://www.spatialys.com
> My software is free, but my time generally not.

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/4af93440/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 365 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/4af93440/attachment-0004.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image002.png
Type: image/png
Size: 619 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/4af93440/attachment-0005.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image003.png
Type: image/png
Size: 468 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/4af93440/attachment-0006.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image004.png
Type: image/png
Size: 817 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/4af93440/attachment-0007.png>

From eruiz at aplitop.com  Wed Feb  8 03:28:54 2023
From: eruiz at aplitop.com (Elena Ruiz)
Date: Wed, 8 Feb 2023 11:28:54 +0000
Subject: [gdal-dev] Set axis order with ogr2ogr
In-Reply-To: <25e16046-7396-b6ce-8384-61c00f5447f8@spatialys.com>
References: <3d652b5c-aa92-4a2a-85be-25316f1f7b0b.ba94d704-e79f-4907-b4e6-7c540f2b307c.b2b8c765-dc5b-449e-9320-f9b2cd25daf6@emailsignatures365.codetwo.com>
 <AM0P192MB0498136166FF16E7B599B3C9BBD89@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
 <0a90bd59-7cd9-f59d-987d-0537efaab953@spatialys.com>
 <AM0P192MB04984041DA3E026CF84B711BBBD89@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
 <25e16046-7396-b6ce-8384-61c00f5447f8@spatialys.com>
Message-ID: <AM0P192MB0498631835243830C6590C51BBD89@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>

Ok, it works thank you very much




________________________________


Elena Ruiz

[https://www.aplitop.com/descargas/logo.png]
Sofware Development & Technical Support
Tel.: +34 952 43 97 71
eruiz at aplitop.com
www.aplitop.com




<http://www.aplitop.com/Product/es/6/5/tcptunnel>


<http://www.aplitop.com/New/es/281/mdt-75-a-la-venta>




De: Even Rouault <even.rouault at spatialys.com>
Enviado el: mi?rcoles, 8 de febrero de 2023 11:58
Para: Elena Ruiz <eruiz at aplitop.com>; gdal-dev at lists.osgeo.org
Asunto: Re: [gdal-dev] Set axis order with ogr2ogr


Set PROJ_LIB as an environment variable (with set PROJ_LIB="D:\MDT\V9\bin\gdal\gdal_latest\share") rather than with --config, as --config is only for GDAL configuration options, and PROJ_LIB is only read by PROJ which reads environment variable.

And don't set OGR_CT_FORCE_TRADITIONAL_GIS_ORDER=YES. It is not needed here.
Le 08/02/2023 ? 11:45, Elena Ruiz a ?crit :
Hello, actually we use several versions of gdal and among them I have also tried it with the latest one, 3.6.2 in x64, but it gives me these errors:

ogr2ogr -f "ESRI Shapefile" "C:\Users\elena\Downloads\Recinto.shp"  "C:\Users\elena\Downloads\Recinto.gml" --config OGR_CT_FORCE_TRADITIONAL_GIS_ORDER YES --config PROJ_LIB "D:\MDT\V9\bin\gdal\gdal_latest\share"
ERROR 1: PROJ: proj_create: no database context specified
ERROR 1: PROJ: proj_create: no database context specified
ERROR 1: PROJ: proj_create: no database context specified
ERROR 1: Field gml_id has a NULL content which is not allowed
ERROR 1: Unable to write feature 0 from layer LandCoverUnit.
ERROR 1: Terminating translation prematurely after failed
translation of layer LandCoverUnit (use -skipfailures to skip errors)

But several things happen, it does not establish the PROJ_LIB directory, I am indicating the directory where the proj.db is, but it ignores it, I don't know if it needs something else. It is not recognizing the OGR_CT_FORCE_TRADITIONAL_GIS_ORDER label either, because the destination file has not modified the order of the axes, and finally it detects some errors in the GML file, and the example file is a correct GML (https://aplitop.sharefile.com/d-scfcb397f54a649598913d6ae00d0d398 ). Thank you and I hope someone can help me, regards






________________________________


Elena Ruiz

[https://www.aplitop.com/descargas/logo.png]
Sofware Development & Technical Support
Tel.: +34 952 43 97 71
eruiz at aplitop.com<mailto:eruiz at aplitop.com>
www.aplitop.com<http://www.aplitop.com>















De: Even Rouault <even.rouault at spatialys.com><mailto:even.rouault at spatialys.com>
Enviado el: mi?rcoles, 8 de febrero de 2023 11:10
Para: Elena Ruiz <eruiz at aplitop.com><mailto:eruiz at aplitop.com>; gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Asunto: Re: [gdal-dev] Set axis order with ogr2ogr


Elena,

I almost choked when reading "I'm using GDAL 1.1.1". Do you realize this version was released 16 years ago ? Even GDAL 2.4.4 is antiquated. Nobody longer support those versions. Please upgrade to a recent (< 2 years) version first. I've just verified that ogr2ogr works just fine on our file with a recent version

Even
Le 08/02/2023 ? 10:40, Elena Ruiz a ?crit :
Hello, I need to do a conversion between GML to SHP vector files with the app ogr2ogr.exe, and be able to set the order of the axes TRADITIONAL_GIS_ORDER / AUTHORITY_COMPLIANT, in the OGR API documentation (ogr_srs_api.h), I found the following:

"This will honor the axis order advertised by the source and target SRS, as well as their ?data axis to SRS axis mapping?. To have a behavior similar to GDAL < 3.0, the OGR_CT_FORCE_TRADITIONAL_GIS_ORDER configuration option can be set to YES."

And from here I have deduced that I could use the OGR_CT_FORCE_TRADITIONAL_GIS_ORDER tag to establish the order of the axes and I have used the following command line:

ogr2ogr -f "ESRI Shapefile" "C:\Users\elena\Downloads\Recinto.shp" "C:\Users\elena\Downloads\Recinto.gml" -co OGR_CT_FORCE_TRADITIONAL_GIS_ORDER YES

I am using GDAL 1.1.1 on x86, for this version of GDAL it does create the SHP file, it does not give an error when executed, but it does not make any change in the order of the axes of the destination file.
But I have also tried it with version 2.4.4 for x64 and in this case it gives me the following errors:

ERROR 1: Field gml_id has a NULL content which is not allowed
ERROR 1: Unable to write feature 0 from layer LandCoverUnit.
ERROR 1: Terminating translation prematurely after failed
translation of layer LandCoverUnit (use -skipfailures to skip errors)

I attach an example file in the following link: https://aplitop.sharefile.com/d-scfcb397f54a649598913d6ae00d0d398

I hope someone can tell me how I can do what I need, thanks and regards.
________________________________

[https://www.aplitop.com/descargas/firma1.jpg]

Elena Ruiz
Sofware Development & Technical Support
Tel. +34 952 43 97 71
eruiz at aplitop.com<mailto:eruiz at aplitop.com>
Sumatra, 9 - 29190 M?laga (Spain)
www.aplitop.com<http://www.aplitop.com>

[cid:image001.png at 01D93BB8.E4A06B40]<https://www.facebook.com/AplitopSL/>   [cid:image002.png at 01D93BB8.E4A06B40] <https://twitter.com/aplitop>    [cid:image003.png at 01D93BB8.E4A06B40] <https://www.linkedin.com/company/aplitop>    [cid:image004.png at 01D93BB8.E4A06B40] <https://www.youtube.com/user/aplitop>


In accordance with the provisions of the European Regulation of Data Protection 2016/679 (Reglamento Europeo de Protecci?n de Datos 2016/679), we inform you that the data and the information you provide us through this medium will be used by APLITOP, S.L., with C.I.F. B-92543396 and with address at C / Sumatra, 9, Malaga, 29190, in order to answer your questions and inform you about our products. The data provided will be kept as long as it does not request its cessation and will not be transferred to third parties except in cases where there is a legal obligation. You have the right to access your personal data, correct inaccurate data or request its deletion when the data is no longer necessary for the purposes that were collected, as well as any rights recognized in the RGPD 2016/679









_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

https://lists.osgeo.org/mailman/listinfo/gdal-dev

--

http://www.spatialys.com

My software is free, but my time generally not.

--

http://www.spatialys.com

My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/8c12aed8/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 365 bytes
Desc: image001.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/8c12aed8/attachment-0004.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image002.png
Type: image/png
Size: 619 bytes
Desc: image002.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/8c12aed8/attachment-0005.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image003.png
Type: image/png
Size: 468 bytes
Desc: image003.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/8c12aed8/attachment-0006.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image004.png
Type: image/png
Size: 817 bytes
Desc: image004.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/8c12aed8/attachment-0007.png>

From cliveswan at gmail.com  Wed Feb  8 03:28:59 2023
From: cliveswan at gmail.com (Clive Swan)
Date: Wed, 8 Feb 2023 11:28:59 +0000
Subject: [gdal-dev] Pixel shift
Message-ID: <CWXP123MB39597E8589514BE494B2253BA0D89@CWXP123MB3959.GBRP123.PROD.OUTLOOK.COM>

Greetings
We use gdal_warp to create pyramids and tile really big Tif files (satellite imagery).
The Pyramids are created and tiled Zoom 1 to 15

We noticed a pixel shift in the tile imagery??
You can move an image X,Y, but you cannot shit folders of tiled imagery.

Any suggestions how to prevent the tile shift??

Thanks
Clive
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/1edee0d2/attachment.htm>

From jukka.rahkonen at maanmittauslaitos.fi  Wed Feb  8 04:08:51 2023
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Wed, 8 Feb 2023 12:08:51 +0000
Subject: [gdal-dev] Pixel shift
In-Reply-To: <CWXP123MB39597E8589514BE494B2253BA0D89@CWXP123MB3959.GBRP123.PROD.OUTLOOK.COM>
References: <CWXP123MB39597E8589514BE494B2253BA0D89@CWXP123MB3959.GBRP123.PROD.OUTLOOK.COM>
Message-ID: <AM0PR09MB3219D6D11FBD2E42FE844B10FDD89@AM0PR09MB3219.eurprd09.prod.outlook.com>

Hi,

I apologize but I must ask you more details. If I happen to have a really big tiff image, what exactly should I do for re-producing the shift that you experience? Write all the commands that you have used so that others can re-use them by simple copy-paste-adjust method. Also small image that shows the shift would be appreciated.

-Jukka Rahkonen-

L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Clive Swan
L?hetetty: keskiviikko 8. helmikuuta 2023 13.29
Vastaanottaja: gdal-dev at lists.osgeo.org
Aihe: [gdal-dev] Pixel shift

Greetings
We use gdal_warp to create pyramids and tile really big Tif files (satellite imagery).
The Pyramids are created and tiled Zoom 1 to 15

We noticed a pixel shift in the tile imagery??
You can move an image X,Y, but you cannot shit folders of tiled imagery.

Any suggestions how to prevent the tile shift??

Thanks
Clive
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/5b5a452d/attachment.htm>

From howard at hobu.co  Wed Feb  8 06:27:04 2023
From: howard at hobu.co (Howard Butler)
Date: Wed, 8 Feb 2023 08:27:04 -0600
Subject: [gdal-dev] AWS Lambda layer with GDAL python bindings
In-Reply-To: <8f712ee6-fa4d-bd0e-d1aa-c8bb5dc172e0@gmail.com>
References: <8f712ee6-fa4d-bd0e-d1aa-c8bb5dc172e0@gmail.com>
Message-ID: <6A7B0D00-6F8F-43C1-972A-381C725E1437@hobu.co>



> On Feb 8, 2023, at 1:42 AM, Ari Jolma <ari.jolma at gmail.com> wrote:
> 
> Hi,
> 
> I need an AWS Lambda layer with GDAL python bindings, for "from osgeo import gdal", but it seems difficult to make such a layer.
> 
> In fact all I need is gdal.Open and gdal.BuildVRT - I have not dug deeper into rasterio, can it do those?
> 
> Anyway, I installed GDAL on a machine with python 3.8 as that's what to lambda runtime will be, and from there copied files to a zip with /lib and /python. The /lib is for the shared objects. I have now 94 libraries there. The error I now get from
> 
> try
> 
>     from osgeo import gdal
> 
> except
> 
> in the lambda is
> 
> ImportError: /lib64/libm.so.6: version `GLIBC_2.27' not found (required by /opt/lib/libgdal.so.29)
> 
> this seems to be a problem as that's the lambda's libm and not the libm in /lib, which I assume should work.
> 
> Anybody know a solution? I tried some recipes I found from the net howto build such a layer but they did not work for me out of the box, so I tried myself.

I have had the best success making AWS Lambda Layers using the combo of docker containers and conda forge. See https://github.com/pdal/lambda for some inspiration.

Howard

From ari.jolma at gmail.com  Wed Feb  8 06:29:39 2023
From: ari.jolma at gmail.com (Ari Jolma)
Date: Wed, 8 Feb 2023 16:29:39 +0200
Subject: [gdal-dev] AWS Lambda layer with GDAL python bindings
In-Reply-To: <6A7B0D00-6F8F-43C1-972A-381C725E1437@hobu.co>
References: <8f712ee6-fa4d-bd0e-d1aa-c8bb5dc172e0@gmail.com>
 <6A7B0D00-6F8F-43C1-972A-381C725E1437@hobu.co>
Message-ID: <467934ce-adc8-f131-886c-ddeab4d5fc3e@gmail.com>

I'm giving up for now and will move the task into an EC2, where it is 
really easy to set up the required python environment.

Ari

Howard Butler kirjoitti 8.2.2023 klo 16.27:
>
>> On Feb 8, 2023, at 1:42 AM, Ari Jolma <ari.jolma at gmail.com> wrote:
>>
>> Hi,
>>
>> I need an AWS Lambda layer with GDAL python bindings, for "from osgeo import gdal", but it seems difficult to make such a layer.
>>
>> In fact all I need is gdal.Open and gdal.BuildVRT - I have not dug deeper into rasterio, can it do those?
>>
>> Anyway, I installed GDAL on a machine with python 3.8 as that's what to lambda runtime will be, and from there copied files to a zip with /lib and /python. The /lib is for the shared objects. I have now 94 libraries there. The error I now get from
>>
>> try
>>
>>      from osgeo import gdal
>>
>> except
>>
>> in the lambda is
>>
>> ImportError: /lib64/libm.so.6: version `GLIBC_2.27' not found (required by /opt/lib/libgdal.so.29)
>>
>> this seems to be a problem as that's the lambda's libm and not the libm in /lib, which I assume should work.
>>
>> Anybody know a solution? I tried some recipes I found from the net howto build such a layer but they did not work for me out of the box, so I tried myself.
> I have had the best success making AWS Lambda Layers using the combo of docker containers and conda forge. See https://github.com/pdal/lambda for some inspiration.
>
> Howard

From hyoklee at hdfgroup.org  Wed Feb  8 06:35:57 2023
From: hyoklee at hdfgroup.org (Joe Lee)
Date: Wed, 8 Feb 2023 14:35:57 +0000
Subject: [gdal-dev] AWS Lambda layer with GDAL python bindings
In-Reply-To: <8f712ee6-fa4d-bd0e-d1aa-c8bb5dc172e0@gmail.com>
References: <8f712ee6-fa4d-bd0e-d1aa-c8bb5dc172e0@gmail.com>
Message-ID: <DM6PR17MB2396F1A7DF886FDDF842D6E4C2D89@DM6PR17MB2396.namprd17.prod.outlook.com>

This worked quite well in 2019 with a few hacks:

https://github.com/developmentseed/geolambda


From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of Ari Jolma <ari.jolma at gmail.com>
Date: Wednesday, February 8, 2023 at 1:42 AM
To: gdal-dev at lists.osgeo.org <gdal-dev at lists.osgeo.org>
Subject: [gdal-dev] AWS Lambda layer with GDAL python bindings
Hi,

I need an AWS Lambda layer with GDAL python bindings, for "from osgeo
import gdal", but it seems difficult to make such a layer.

In fact all I need is gdal.Open and gdal.BuildVRT - I have not dug
deeper into rasterio, can it do those?

Anyway, I installed GDAL on a machine with python 3.8 as that's what to
lambda runtime will be, and from there copied files to a zip with /lib
and /python. The /lib is for the shared objects. I have now 94 libraries
there. The error I now get from

try

     from osgeo import gdal

except

in the lambda is

ImportError: /lib64/libm.so.6: version `GLIBC_2.27' not found (required
by /opt/lib/libgdal.so.29)

this seems to be a problem as that's the lambda's libm and not the libm
in /lib, which I assume should work.

Anybody know a solution? I tried some recipes I found from the net howto
build such a layer but they did not work for me out of the box, so I
tried myself.

Best,

Ari


_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/0f24543d/attachment-0001.htm>

From vincent.sarago at gmail.com  Wed Feb  8 06:37:20 2023
From: vincent.sarago at gmail.com (Vincent Sarago)
Date: Wed, 8 Feb 2023 15:37:20 +0100
Subject: [gdal-dev] AWS Lambda layer with GDAL python bindings
In-Reply-To: <DM6PR17MB2396F1A7DF886FDDF842D6E4C2D89@DM6PR17MB2396.namprd17.prod.outlook.com>
References: <8f712ee6-fa4d-bd0e-d1aa-c8bb5dc172e0@gmail.com>
 <DM6PR17MB2396F1A7DF886FDDF842D6E4C2D89@DM6PR17MB2396.namprd17.prod.outlook.com>
Message-ID: <4BBE7BF7-8D34-4BF8-9D5D-A6C5D5DD116F@gmail.com>

Sharing what I sent to Ari directly (forgot to anser to all) 

Hi Ari,

You can have a look at https://github.com/lambgeo/docker-lambda 
It doesn?t provide any python bindings but if you follow https://github.com/lambgeo/docker-lambda#2-advanced-need-other-dependencies you can create a lambda package with all the deps you need.

Vincent 


> On Feb 8, 2023, at 3:35 PM, Joe Lee <hyoklee at hdfgroup.org> wrote:
> 
> This worked quite well in 2019 with a few hacks:
>  
> https://github.com/developmentseed/geolambda
>  
>  
> From: gdal-dev <gdal-dev-bounces at lists.osgeo.org <mailto:gdal-dev-bounces at lists.osgeo.org>> on behalf of Ari Jolma <ari.jolma at gmail.com <mailto:ari.jolma at gmail.com>>
> Date: Wednesday, February 8, 2023 at 1:42 AM
> To: gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org> <gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>>
> Subject: [gdal-dev] AWS Lambda layer with GDAL python bindings
> 
> Hi,
> 
> I need an AWS Lambda layer with GDAL python bindings, for "from osgeo 
> import gdal", but it seems difficult to make such a layer.
> 
> In fact all I need is gdal.Open and gdal.BuildVRT - I have not dug 
> deeper into rasterio, can it do those?
> 
> Anyway, I installed GDAL on a machine with python 3.8 as that's what to 
> lambda runtime will be, and from there copied files to a zip with /lib 
> and /python. The /lib is for the shared objects. I have now 94 libraries 
> there. The error I now get from
> 
> try
> 
>      from osgeo import gdal
> 
> except
> 
> in the lambda is
> 
> ImportError: /lib64/libm.so.6: version `GLIBC_2.27' not found (required 
> by /opt/lib/libgdal.so.29)
> 
> this seems to be a problem as that's the lambda's libm and not the libm 
> in /lib, which I assume should work.
> 
> Anybody know a solution? I tried some recipes I found from the net howto 
> build such a layer but they did not work for me out of the box, so I 
> tried myself.
> 
> Best,
> 
> Ari
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/33b0bdc4/attachment.htm>

From ari.jolma at gmail.com  Wed Feb  8 07:44:54 2023
From: ari.jolma at gmail.com (Ari Jolma)
Date: Wed, 8 Feb 2023 17:44:54 +0200
Subject: [gdal-dev] AWS Lambda layer with GDAL python bindings
In-Reply-To: <DM6PR17MB2396F1A7DF886FDDF842D6E4C2D89@DM6PR17MB2396.namprd17.prod.outlook.com>
References: <8f712ee6-fa4d-bd0e-d1aa-c8bb5dc172e0@gmail.com>
 <DM6PR17MB2396F1A7DF886FDDF842D6E4C2D89@DM6PR17MB2396.namprd17.prod.outlook.com>
Message-ID: <4bf6a201-0c89-abce-79a6-68a0def20bf1@gmail.com>

On that page there are a number of arns for lambda layers, but when I 
try to get the http location of those I get from

aws lambda get-layer-version-by-arn --arn 
arn:aws:lambda:us-east-1:552188055668:layer:geolambda-python:3 --query 
Content.Location --output text

An error occurred (AccessDeniedException) when calling the 
GetLayerVersionByArn operation: User: <removed> is not authorized to 
perform: lambda:GetLayerVersion on resource: 
arn:aws:lambda:us-east-1:552188055668:layer:geolambda-python:3 because 
no resource-based policy allows the lambda:GetLayerVersion action

And I have an admin access to one AWS account.

How do I get those layers?

Ari

Joe Lee kirjoitti 8.2.2023 klo 16.35:
>
> This worked quite well in 2019 with a few hacks:
>
> https://github.com/developmentseed/geolambda
>
> *From: *gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of Ari 
> Jolma <ari.jolma at gmail.com>
> *Date: *Wednesday, February 8, 2023 at 1:42 AM
> *To: *gdal-dev at lists.osgeo.org <gdal-dev at lists.osgeo.org>
> *Subject: *[gdal-dev] AWS Lambda layer with GDAL python bindings
>
> Hi,
>
> I need an AWS Lambda layer with GDAL python bindings, for "from osgeo
> import gdal", but it seems difficult to make such a layer.
>
> In fact all I need is gdal.Open and gdal.BuildVRT - I have not dug
> deeper into rasterio, can it do those?
>
> Anyway, I installed GDAL on a machine with python 3.8 as that's what to
> lambda runtime will be, and from there copied files to a zip with /lib
> and /python. The /lib is for the shared objects. I have now 94 libraries
> there. The error I now get from
>
> try
>
> ???? from osgeo import gdal
>
> except
>
> in the lambda is
>
> ImportError: /lib64/libm.so.6: version `GLIBC_2.27' not found (required
> by /opt/lib/libgdal.so.29)
>
> this seems to be a problem as that's the lambda's libm and not the libm
> in /lib, which I assume should work.
>
> Anybody know a solution? I tried some recipes I found from the net howto
> build such a layer but they did not work for me out of the box, so I
> tried myself.
>
> Best,
>
> Ari
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/b69d8921/attachment.htm>

From ari.jolma at gmail.com  Wed Feb  8 10:04:05 2023
From: ari.jolma at gmail.com (Ari Jolma)
Date: Wed, 8 Feb 2023 20:04:05 +0200
Subject: [gdal-dev] AWS Lambda layer with GDAL python bindings
In-Reply-To: <4BBE7BF7-8D34-4BF8-9D5D-A6C5D5DD116F@gmail.com>
References: <8f712ee6-fa4d-bd0e-d1aa-c8bb5dc172e0@gmail.com>
 <DM6PR17MB2396F1A7DF886FDDF842D6E4C2D89@DM6PR17MB2396.namprd17.prod.outlook.com>
 <4BBE7BF7-8D34-4BF8-9D5D-A6C5D5DD116F@gmail.com>
Message-ID: <21f2d853-a5b9-2737-d1f0-8d5b219bd964@gmail.com>

Could not let this go without a last try.

I finally managed to create a working lambda layer using the Dockerfile 
from https://github.com/developmentseed/geolambda as a starting point 
and with a more than a few hacks got GDAL to compile within the docker 
and then compile the swig bindings and then create a working layer zip 
using the package.sh from within the docker image as a starting point.

Thanks for the help!

Best,

Ari

Vincent Sarago kirjoitti 8.2.2023 klo 16.37:
> Sharing what I sent to Ari directly (forgot to anser to all)
>
> Hi Ari,
>
> You can have a look at https://github.com/lambgeo/docker-lambda
> It doesn?t provide any python bindings but if you follow 
> https://github.com/lambgeo/docker-lambda#2-advanced-need-other-dependencies?you 
> can create a lambda package with all the deps you need.
>
> Vincent
>
>
>> On Feb 8, 2023, at 3:35 PM, Joe Lee <hyoklee at hdfgroup.org> wrote:
>>
>> This worked quite well in 2019 with a few hacks:
>> https://github.com/developmentseed/geolambda
>>
>> *From:*gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of Ari 
>> Jolma <ari.jolma at gmail.com>
>> *Date:*Wednesday, February 8, 2023 at 1:42 AM
>> *To:*gdal-dev at lists.osgeo.org<gdal-dev at lists.osgeo.org>
>> *Subject:*[gdal-dev] AWS Lambda layer with GDAL python bindings
>>
>> Hi,
>>
>> I need an AWS Lambda layer with GDAL python bindings, for "from osgeo
>> import gdal", but it seems difficult to make such a layer.
>>
>> In fact all I need is gdal.Open and gdal.BuildVRT - I have not dug
>> deeper into rasterio, can it do those?
>>
>> Anyway, I installed GDAL on a machine with python 3.8 as that's what to
>> lambda runtime will be, and from there copied files to a zip with /lib
>> and /python. The /lib is for the shared objects. I have now 94 libraries
>> there. The error I now get from
>>
>> try
>>
>> ???? from osgeo import gdal
>>
>> except
>>
>> in the lambda is
>>
>> ImportError: /lib64/libm.so.6: version `GLIBC_2.27' not found (required
>> by /opt/lib/libgdal.so.29)
>>
>> this seems to be a problem as that's the lambda's libm and not the libm
>> in /lib, which I assume should work.
>>
>> Anybody know a solution? I tried some recipes I found from the net howto
>> build such a layer but they did not work for me out of the box, so I
>> tried myself.
>>
>> Best,
>>
>> Ari
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/63c327de/attachment-0001.htm>

From mdsumner at gmail.com  Wed Feb  8 11:45:17 2023
From: mdsumner at gmail.com (Michael Sumner)
Date: Thu, 9 Feb 2023 06:45:17 +1100
Subject: [gdal-dev] why padfExtent/s in gdal_alg.h ?
In-Reply-To: <CAH0YoEOJP3RbKtMtbHkYRuLFDMR5fxQKhc9i7gSWV0DfzakE5A@mail.gmail.com>
References: <CAAcGz9_S6A+L=ZJNm4Sf2Kgn5qrmPF5OsmCd1nOcsFtRXVev9w@mail.gmail.com>
 <e4c09f93-f418-6d25-1b2f-85ebc93d4aaa@spatialys.com>
 <CAAcGz99TaEiv_hAMPoSX7gSC8nZ=tOOQNGQ8kxv+Fcfo2qt0TQ@mail.gmail.com>
 <CAH0YoEOJP3RbKtMtbHkYRuLFDMR5fxQKhc9i7gSWV0DfzakE5A@mail.gmail.com>
Message-ID: <CAAcGz9-0gYDEshnwBfZDzOGRRV95wdZHxfdYw18ogVpQod6+9Q@mail.gmail.com>

Thank you, gosh that does help explain a lot.

Cheers, Mike

On Wed, 8 Feb 2023, 21:42 Thomas Knudsen, <knudsen.thomas at gmail.com> wrote:

> >  Ah ok, mostly I was just confused why it's not an error for the compiler
>
> The compiler only needs to know the type of the argument - in a header
> file, the identifier name following
> the type is for human information only
>
>>
>>
> Den ons. 8. feb. 2023 kl. 00.49 skrev Michael Sumner <mdsumner at gmail.com>:
>
>>
>>
>> On Wed, Feb 8, 2023 at 10:44 AM Even Rouault <even.rouault at spatialys.com>
>> wrote:
>>
>>> Michael,
>>>
>>> Feel free to submit a fix as there's obviously no justification for the
>>> discrepancy other than just being accidental.
>>>
>>
>> Ah ok, mostly I was just confused why it's not an error for the compiler
>> ... but I'm getting used to surprises learning C++ :)
>>
>> PR incoming, thanks!
>>
>> Cheers, Mike
>>
>>
>>
>>> There are likely hundreds of similar occurrences in the code base.  I
>>> believe there's a compiler warning (or at least cppcheck) to detect this,
>>> but it is not activated.
>>>
>>> Even
>>> Le 08/02/2023 ? 00:35, Michael Sumner a ?crit :
>>>
>>> This is not causing any problems afaict, but I happened to notice the
>>> plural for 'padfExtents' in the gdal_alg.h signature for
>>> GDALSuggestedWarpOutput2 compared to gdaltransformer.cpp
>>>
>>>
>>> https://github.com/OSGeo/gdal/blob/579693c2975cda414af75239e09b8b7b952029ca/alg/gdal_alg.h#L264
>>>
>>>
>>> https://github.com/OSGeo/gdal/blob/579693c2975cda414af75239e09b8b7b952029ca/alg/gdaltransformer.cpp#L412
>>>
>>>
>>> The discrepancy is visible in the doc here:
>>>
>>>
>>> https://gdal.org/api/gdal_alg.html#_CPPv424GDALSuggestedWarpOutput212GDALDatasetH19GDALTransformerFuncPvPdPiPiPdi
>>>
>>> Cheers, Mike
>>>
>>>
>>>
>>> --
>>> Michael Sumner
>>> Software and Database Engineer
>>> Australian Antarctic Division
>>> Hobart, Australia
>>> e-mail: mdsumner at gmail.com
>>>
>>> _______________________________________________
>>> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>> -- http://www.spatialys.com
>>> My software is free, but my time generally not.
>>>
>>>
>>
>> --
>> Michael Sumner
>> Software and Database Engineer
>> Australian Antarctic Division
>> Hobart, Australia
>> e-mail: mdsumner at gmail.com
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230209/3c118aaa/attachment.htm>

From scottcarnold2 at gmail.com  Wed Feb  8 13:43:15 2023
From: scottcarnold2 at gmail.com (Scott Arnold)
Date: Wed, 8 Feb 2023 15:43:15 -0600
Subject: [gdal-dev] PROJ Data
Message-ID: <CANXBawQfkvSSdxs98EdTBb0UiBXggx0_RgGqKsvECuK0d2gapQ@mail.gmail.com>

 Greetings GDAL Community,

I've been working with GDAL lately, and I have a question for more
experienced GDAL users or developers.  GDAL has a dependency on PROJ.  I
know some GDAL functions, for example, will respond with an error message
if the proj.db cannot be found, and there is a dependency on PROJ during
the GDAL build.  PROJ has a rather large collection of data packaged
separately from the PROJ source code (described in PROJ-data readme as
containing shift grids for horizontal and vertical coordinate
transformations.). You can build both PROJ and GDAL without PROJ data, and
the GDAL functions I've used (albeit I've only used a few) seem unaffected
by not having PROJ data.  Can any of you provide any insights into what the
implications are of having PROJ data installed vs. not installed?

Thank you,

Scott Arnold
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/d00375d3/attachment.htm>

From alansnow21 at gmail.com  Wed Feb  8 13:50:02 2023
From: alansnow21 at gmail.com (Alan Snow)
Date: Wed, 8 Feb 2023 15:50:02 -0600
Subject: [gdal-dev] PROJ Data
In-Reply-To: <CANXBawQfkvSSdxs98EdTBb0UiBXggx0_RgGqKsvECuK0d2gapQ@mail.gmail.com>
References: <CANXBawQfkvSSdxs98EdTBb0UiBXggx0_RgGqKsvECuK0d2gapQ@mail.gmail.com>
Message-ID: <CAGybdFQiXTbSKDL00=+EkJkCcayqPUXw=2URVqYuP=KOmeqWNw@mail.gmail.com>

Here is a helpful reference:
https://proj.org/resource_files.html#transformation-grids

On Wed, Feb 8, 2023, 3:43 PM Scott Arnold <scottcarnold2 at gmail.com> wrote:

>  Greetings GDAL Community,
>
> I've been working with GDAL lately, and I have a question for more
> experienced GDAL users or developers.  GDAL has a dependency on PROJ.  I
> know some GDAL functions, for example, will respond with an error message
> if the proj.db cannot be found, and there is a dependency on PROJ during
> the GDAL build.  PROJ has a rather large collection of data packaged
> separately from the PROJ source code (described in PROJ-data readme as
> containing shift grids for horizontal and vertical coordinate
> transformations.). You can build both PROJ and GDAL without PROJ data, and
> the GDAL functions I've used (albeit I've only used a few) seem unaffected
> by not having PROJ data.  Can any of you provide any insights into what the
> implications are of having PROJ data installed vs. not installed?
>
> Thank you,
>
> Scott Arnold
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/18fda472/attachment.htm>

From runette at gmail.com  Wed Feb  8 13:50:41 2023
From: runette at gmail.com (Paul Harwood)
Date: Wed, 8 Feb 2023 21:50:41 +0000
Subject: [gdal-dev] PROJ Data
In-Reply-To: <CANXBawQfkvSSdxs98EdTBb0UiBXggx0_RgGqKsvECuK0d2gapQ@mail.gmail.com>
References: <CANXBawQfkvSSdxs98EdTBb0UiBXggx0_RgGqKsvECuK0d2gapQ@mail.gmail.com>
Message-ID: <CAE8nN5O9WykNkTpGwG+C+gZj8gMVvns+Fkyvvm8hWBP=Mr2qBQ@mail.gmail.com>

If you don't have access to the PROJ data then there are Spatial
References(CRS) and Spatial Transformations that it will not know about.

However - you can set GDAL up to use the PROJ CDN - so that it pulls down
just the data it needs when it needs it.

On Wed, 8 Feb 2023 at 21:44, Scott Arnold <scottcarnold2 at gmail.com> wrote:

>  Greetings GDAL Community,
>
> I've been working with GDAL lately, and I have a question for more
> experienced GDAL users or developers.  GDAL has a dependency on PROJ.  I
> know some GDAL functions, for example, will respond with an error message
> if the proj.db cannot be found, and there is a dependency on PROJ during
> the GDAL build.  PROJ has a rather large collection of data packaged
> separately from the PROJ source code (described in PROJ-data readme as
> containing shift grids for horizontal and vertical coordinate
> transformations.). You can build both PROJ and GDAL without PROJ data, and
> the GDAL functions I've used (albeit I've only used a few) seem unaffected
> by not having PROJ data.  Can any of you provide any insights into what the
> implications are of having PROJ data installed vs. not installed?
>
> Thank you,
>
> Scott Arnold
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230208/dc8e471c/attachment.htm>

From mniemyjski at cloudferro.com  Thu Feb  9 04:07:54 2023
From: mniemyjski at cloudferro.com (Marcin Niemyjski)
Date: Thu, 9 Feb 2023 12:07:54 +0000
Subject: [gdal-dev] optimal way of storing COG within the S3 bucket
 connected to CEPH backend?
Message-ID: <AS1PR03MB8149EABB114ADA6EF1F178B9A8D99@AS1PR03MB8149.eurprd03.prod.outlook.com>

Hello,

curently I'm investigating the optimal way of storing COG within the S3 bucket connected to CEPH backend. I came up with solution below:

VSIS3_CHUNK_SIZE=19 CPL_VSIL_USE_TEMP_FILE_FOR_RANDOM_WRITE=YES gdal_translate -of COG -a_nodata 0 -co OVERVIEW_COUNT=6 -co BLOCKSIZE=1024 -co BIGTIFF=YES -co OVERVIEW_RESAMPLING=average -co COMPRESS=DEFLATE -co NUM_THREADS=ALL_CPUS /tmp/T34UDC_20230206T095201_TCI_10m.jp2 /vsis3/CHUNK/test.tif

Do you have any reccomendtion/sugstion about the s3 chunk size, deflate chunk size, etc.?

Thanks,

Marcin





[cid:9817fb5d-5e3d-4679-b37b-69298b10eaaf]<https://outlook.office.com/bookwithme/user/6347c7def05a478ba013ae948648789d at cloudferro.com?anonymous&ep=signature>           Book time to meet with me<https://outlook.office.com/bookwithme/user/6347c7def05a478ba013ae948648789d at cloudferro.com?anonymous&ep=signature>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230209/5e656160/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Outlook-lhmbll1h.png
Type: image/png
Size: 528 bytes
Desc: Outlook-lhmbll1h.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230209/5e656160/attachment-0001.png>

From zedrdave at gmail.com  Fri Feb 10 02:20:55 2023
From: zedrdave at gmail.com (Dave)
Date: Fri, 10 Feb 2023 11:20:55 +0100
Subject: [gdal-dev] Merging a large number of non-overlapping rasters with
 PixelFunctionType
Message-ID: <D083F8D6-604E-4883-97E5-8BB69BB0B89A@gmail.com>

As part of our processing pipeline, we are trying to use GDAL to merge a large (potentially >2000) number of rasters.
In most cases, the rasters are processed from large sources split into tiles of arbitrary coordinates and are mostly non-overlapping, but because of reprojection etc, some small overlap could be expected. In other cases, some tiles might generate more than one product, and we would have some significant overlap.

In order to control the way these overlaps are handled (we potentially need to apply our own mean/stdev/etc functions), we are trying to use a VRTDataset with a Python PixelFunctionType (using Numba).

Things generally work OK, when the number of tiles is ?low? (< 1000), however, we ran into an issue where Numba will crash above 1000 tiles, as GDAL tries to pass a 1000+ long tuple as `in_arr` argument to the PixelFunctionType function.

What I do not understand, is why the tuple passed to the Python function, contains *all* the sources, when only a fraction (most of the time: 1) overlap with DstRect.
This happens regardless of whether I try processing the VRT file with gdalwarp or gdal_translate.

I guess I am missing something in the way VRT/VRTDerivedRasterBand/ComplexSource are supposed to work, but can?t figure out why from the VRT documentation page. Is there a better way to achieve this?

Below is a small excerpt from a typical VRT file. When run through gdalwarp (/gdal_translate), the `in_arr` argument sent to the python function invariably contains as many arrays as there are ComplexSource, regardless of whether they overlap (non-overlapping one will contain all nodata/0):

<VRTDataset rasterXSize="58786" rasterYSize="9222">
  <SRS dataAxisToSRSAxisMapping="1,2?>[?]</SRS>
  <GeoTransform> -7.9902911092382642e+06,  4.6331271652776735e+02,  0.0000000000000000e+00,  2.2618926820882889e+06,  0.0000000000000000e+00, -4.6331271652773665e+02</GeoTransform>
  <VRTRasterBand subClass="VRTDerivedRasterBand" dataType="Float32" band="1" NoDataValue="0" blockXSize="128" blockYSize="128">
    <PixelFunctionType>test.test</PixelFunctionType><PixelFunctionArguments nodata="0" /><PixelFunctionLanguage>Python</PixelFunctionLanguage>
    <NoDataValue>0</NoDataValue>
    <HideNoDataValue>1</HideNoDataValue>
    <ColorInterp>Gray</ColorInterp>
    <ComplexSource>
      <SourceFilename relativeToVRT="1">././test_vrt/0a06211d1ceccd06aff9a5a50f5e70b5.tif</SourceFilename>
      <SourceBand>1</SourceBand>
      <SourceProperties RasterXSize="568" RasterYSize="544" DataType="Float32" BlockXSize="256" BlockYSize="256" />
      <SrcRect xOff="0" yOff="0" xSize="568" ySize="544" />
      <DstRect xOff="52791" yOff="4881" xSize="568" ySize="544" />
      <NODATA>0</NODATA>
    </ComplexSource>
    <ComplexSource>
      <SourceFilename relativeToVRT="1">././test_vrt/0a120c177147927bc0bd8c766907e65f.tif</SourceFilename>
      <SourceBand>1</SourceBand>
      <SourceProperties RasterXSize="556" RasterYSize="544" DataType="Float32" BlockXSize="256" BlockYSize="256" />
      <SrcRect xOff="0" yOff="0" xSize="556" ySize="544" />
      <DstRect xOff="24236" yOff="3796" xSize="556" ySize="544" />
      <NODATA>0</NODATA>
    </ComplexSource>
[?]

Thanks in advance!
? 
Dave dV

From even.rouault at spatialys.com  Fri Feb 10 03:18:21 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 10 Feb 2023 12:18:21 +0100
Subject: [gdal-dev] Merging a large number of non-overlapping rasters
 with PixelFunctionType
In-Reply-To: <D083F8D6-604E-4883-97E5-8BB69BB0B89A@gmail.com>
References: <D083F8D6-604E-4883-97E5-8BB69BB0B89A@gmail.com>
Message-ID: <541884cb-c4a8-db99-04ba-2686dd5e0e9a@spatialys.com>

Dave,

Most use cases of VRTDerivedRasterBand I'm aware of involve 
non-mosaicing scenarios where all sources have the same extent, which is 
the one of the VRT, and thus are all used. So there's no optimization to 
remove sources that don't intersect to the requested area. But that is 
something definitely reasonable to fix/optimize. Please file a ticket 
about that at https://github.com/OSGeo/gdal/issues

Even

Le 10/02/2023 ? 11:20, Dave a ?crit?:
> As part of our processing pipeline, we are trying to use GDAL to merge a large (potentially >2000) number of rasters.
> In most cases, the rasters are processed from large sources split into tiles of arbitrary coordinates and are mostly non-overlapping, but because of reprojection etc, some small overlap could be expected. In other cases, some tiles might generate more than one product, and we would have some significant overlap.
>
> In order to control the way these overlaps are handled (we potentially need to apply our own mean/stdev/etc functions), we are trying to use a VRTDataset with a Python PixelFunctionType (using Numba).
>
> Things generally work OK, when the number of tiles is ?low? (< 1000), however, we ran into an issue where Numba will crash above 1000 tiles, as GDAL tries to pass a 1000+ long tuple as `in_arr` argument to the PixelFunctionType function.
>
> What I do not understand, is why the tuple passed to the Python function, contains *all* the sources, when only a fraction (most of the time: 1) overlap with DstRect.
> This happens regardless of whether I try processing the VRT file with gdalwarp or gdal_translate.
>
> I guess I am missing something in the way VRT/VRTDerivedRasterBand/ComplexSource are supposed to work, but can?t figure out why from the VRT documentation page. Is there a better way to achieve this?
>
> Below is a small excerpt from a typical VRT file. When run through gdalwarp (/gdal_translate), the `in_arr` argument sent to the python function invariably contains as many arrays as there are ComplexSource, regardless of whether they overlap (non-overlapping one will contain all nodata/0):
>
> <VRTDataset rasterXSize="58786" rasterYSize="9222">
>    <SRS dataAxisToSRSAxisMapping="1,2?>[?]</SRS>
>    <GeoTransform> -7.9902911092382642e+06,  4.6331271652776735e+02,  0.0000000000000000e+00,  2.2618926820882889e+06,  0.0000000000000000e+00, -4.6331271652773665e+02</GeoTransform>
>    <VRTRasterBand subClass="VRTDerivedRasterBand" dataType="Float32" band="1" NoDataValue="0" blockXSize="128" blockYSize="128">
>      <PixelFunctionType>test.test</PixelFunctionType><PixelFunctionArguments nodata="0" /><PixelFunctionLanguage>Python</PixelFunctionLanguage>
>      <NoDataValue>0</NoDataValue>
>      <HideNoDataValue>1</HideNoDataValue>
>      <ColorInterp>Gray</ColorInterp>
>      <ComplexSource>
>        <SourceFilename relativeToVRT="1">././test_vrt/0a06211d1ceccd06aff9a5a50f5e70b5.tif</SourceFilename>
>        <SourceBand>1</SourceBand>
>        <SourceProperties RasterXSize="568" RasterYSize="544" DataType="Float32" BlockXSize="256" BlockYSize="256" />
>        <SrcRect xOff="0" yOff="0" xSize="568" ySize="544" />
>        <DstRect xOff="52791" yOff="4881" xSize="568" ySize="544" />
>        <NODATA>0</NODATA>
>      </ComplexSource>
>      <ComplexSource>
>        <SourceFilename relativeToVRT="1">././test_vrt/0a120c177147927bc0bd8c766907e65f.tif</SourceFilename>
>        <SourceBand>1</SourceBand>
>        <SourceProperties RasterXSize="556" RasterYSize="544" DataType="Float32" BlockXSize="256" BlockYSize="256" />
>        <SrcRect xOff="0" yOff="0" xSize="556" ySize="544" />
>        <DstRect xOff="24236" yOff="3796" xSize="556" ySize="544" />
>        <NODATA>0</NODATA>
>      </ComplexSource>
> [?]
>
> Thanks in advance!
> ?
> Dave dV
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From zedrdave at gmail.com  Fri Feb 10 03:21:08 2023
From: zedrdave at gmail.com (Dave)
Date: Fri, 10 Feb 2023 12:21:08 +0100
Subject: [gdal-dev] Merging a large number of non-overlapping rasters
 with PixelFunctionType
In-Reply-To: <541884cb-c4a8-db99-04ba-2686dd5e0e9a@spatialys.com>
References: <D083F8D6-604E-4883-97E5-8BB69BB0B89A@gmail.com>
 <541884cb-c4a8-db99-04ba-2686dd5e0e9a@spatialys.com>
Message-ID: <09F6BAA8-3A13-4C26-944E-CB8F873082D7@gmail.com>

Hi Even,

Thanks, that seems fair enough.
But then am I missing a more straightforward way to do mosaicing *with* custom handling of overlaps?

FWIW, after a bit of tinkering, I was able to fix it for us, by adding a non-Numba wrapper, that filters the input (removing all-nodata layers). But that?s obviously sub-optimal.

I will file a ticket.

? 
Dave

> On 10 Feb 2023, at 12:18, Even Rouault <even.rouault at spatialys.com> wrote:
> 
> Dave,
> 
> Most use cases of VRTDerivedRasterBand I'm aware of involve non-mosaicing scenarios where all sources have the same extent, which is the one of the VRT, and thus are all used. So there's no optimization to remove sources that don't intersect to the requested area. But that is something definitely reasonable to fix/optimize. Please file a ticket about that at https://github.com/OSGeo/gdal/issues
> 
> Even
> 
> Le 10/02/2023 ? 11:20, Dave a ?crit :
>> As part of our processing pipeline, we are trying to use GDAL to merge a large (potentially >2000) number of rasters.
>> In most cases, the rasters are processed from large sources split into tiles of arbitrary coordinates and are mostly non-overlapping, but because of reprojection etc, some small overlap could be expected. In other cases, some tiles might generate more than one product, and we would have some significant overlap.
>> 
>> In order to control the way these overlaps are handled (we potentially need to apply our own mean/stdev/etc functions), we are trying to use a VRTDataset with a Python PixelFunctionType (using Numba).
>> 
>> Things generally work OK, when the number of tiles is ?low? (< 1000), however, we ran into an issue where Numba will crash above 1000 tiles, as GDAL tries to pass a 1000+ long tuple as `in_arr` argument to the PixelFunctionType function.
>> 
>> What I do not understand, is why the tuple passed to the Python function, contains *all* the sources, when only a fraction (most of the time: 1) overlap with DstRect.
>> This happens regardless of whether I try processing the VRT file with gdalwarp or gdal_translate.
>> 
>> I guess I am missing something in the way VRT/VRTDerivedRasterBand/ComplexSource are supposed to work, but can?t figure out why from the VRT documentation page. Is there a better way to achieve this?
>> 
>> Below is a small excerpt from a typical VRT file. When run through gdalwarp (/gdal_translate), the `in_arr` argument sent to the python function invariably contains as many arrays as there are ComplexSource, regardless of whether they overlap (non-overlapping one will contain all nodata/0):
>> 
>> <VRTDataset rasterXSize="58786" rasterYSize="9222">
>>   <SRS dataAxisToSRSAxisMapping="1,2?>[?]</SRS>
>>   <GeoTransform> -7.9902911092382642e+06,  4.6331271652776735e+02,  0.0000000000000000e+00,  2.2618926820882889e+06,  0.0000000000000000e+00, -4.6331271652773665e+02</GeoTransform>
>>   <VRTRasterBand subClass="VRTDerivedRasterBand" dataType="Float32" band="1" NoDataValue="0" blockXSize="128" blockYSize="128">
>>     <PixelFunctionType>test.test</PixelFunctionType><PixelFunctionArguments nodata="0" /><PixelFunctionLanguage>Python</PixelFunctionLanguage>
>>     <NoDataValue>0</NoDataValue>
>>     <HideNoDataValue>1</HideNoDataValue>
>>     <ColorInterp>Gray</ColorInterp>
>>     <ComplexSource>
>>       <SourceFilename relativeToVRT="1">././test_vrt/0a06211d1ceccd06aff9a5a50f5e70b5.tif</SourceFilename>
>>       <SourceBand>1</SourceBand>
>>       <SourceProperties RasterXSize="568" RasterYSize="544" DataType="Float32" BlockXSize="256" BlockYSize="256" />
>>       <SrcRect xOff="0" yOff="0" xSize="568" ySize="544" />
>>       <DstRect xOff="52791" yOff="4881" xSize="568" ySize="544" />
>>       <NODATA>0</NODATA>
>>     </ComplexSource>
>>     <ComplexSource>
>>       <SourceFilename relativeToVRT="1">././test_vrt/0a120c177147927bc0bd8c766907e65f.tif</SourceFilename>
>>       <SourceBand>1</SourceBand>
>>       <SourceProperties RasterXSize="556" RasterYSize="544" DataType="Float32" BlockXSize="256" BlockYSize="256" />
>>       <SrcRect xOff="0" yOff="0" xSize="556" ySize="544" />
>>       <DstRect xOff="24236" yOff="3796" xSize="556" ySize="544" />
>>       <NODATA>0</NODATA>
>>     </ComplexSource>
>> [?]
>> 
>> Thanks in advance!
>> ?
>> Dave dV
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> -- 
> http://www.spatialys.com
> My software is free, but my time generally not.
> 


From br at forstware.de  Fri Feb 10 04:28:54 2023
From: br at forstware.de (=?UTF-8?Q?Bj=c3=b8rn_Ruff?=)
Date: Fri, 10 Feb 2023 13:28:54 +0100
Subject: [gdal-dev] building gdal problems
Message-ID: <b906a767-476f-0576-ed53-4f6368af8261@forstware.de>

Hello,

I have following problem building gdal with cmake under Windows (having 
newest version of all)

Can someone tell me what i am doing wrong?

C:\externLibs\gdal\build>cmake -G "Visual Studio 17 2022" ..
-- Selecting Windows SDK version 10.0.22000.0 to target Windows 10.0.19044.
-- GDAL_VERSION????????? = 3.7.0dev
-- GDAL_ABI_FULL_VERSION = 37
-- GDAL_SOVERSION??????? =
-- Could NOT find ODBCCPP (missing: ODBCCPP_LIBRARY ODBCCPP_INCLUDE_DIR)
-- Could NOT find MSSQL_NCLI (missing: MSSQL_NCLI_LIBRARY 
MSSQL_NCLI_INCLUDE_DIR) (found version "11")
-- Could NOT find MySQL (missing: MYSQL_LIBRARY MYSQL_INCLUDE_DIR)
-- Could NOT find Iconv (missing: Iconv_LIBRARY Iconv_CHARSET_LIBRARY)
-- Could NOT find LibXml2 (missing: LIBXML2_INCLUDE_DIR)
-- Could NOT find EXPAT (missing: EXPAT_DIR)
-- Could NOT find EXPAT (missing: EXPAT_LIBRARY EXPAT_INCLUDE_DIR)
-- Failed to find XercesC (missing: XercesC_LIBRARY XercesC_INCLUDE_DIR 
XercesC_VERSION)
-- Could NOT find Deflate (missing: Deflate_LIBRARY Deflate_INCLUDE_DIR)
-- Could NOT find CryptoPP (missing: CRYPTOPP_LIBRARY 
CRYPTOPP_TEST_KNOWNBUG CRYPTOPP_INCLUDE_DIR)
CMake Error at C:/Program 
Files/CMake/share/cmake-3.26/Modules/FindPackageHandleStandardArgs.cmake:230 
(message):
 ? Could NOT find PROJ (missing: PROJ_INCLUDE_DIR) (Required is at least
 ? version "6.0")
Call Stack (most recent call first):
 ? C:/Program 
Files/CMake/share/cmake-3.26/Modules/FindPackageHandleStandardArgs.cmake:600 
(_FPHSA_FAILURE_MESSAGE)
 ? cmake/modules/packages/FindPROJ.cmake:57 
(find_package_handle_standard_args)
 ? cmake/helpers/CheckDependentLibraries.cmake:356 (find_package)
 ? gdal.cmake:265 (include)
 ? CMakeLists.txt:224 (include)

Thanks,
Bj?rn Ruff
Forstware Informationssysteme
Von Lassbergstr. 35
D 88709 Meersburg

From jluis at ualg.pt  Fri Feb 10 05:24:44 2023
From: jluis at ualg.pt (=?utf-8?B?Sm9hcXVpbSBNYW51ZWwgRnJlaXJlIEx1w61z?=)
Date: Fri, 10 Feb 2023 13:24:44 +0000
Subject: [gdal-dev] building gdal problems
In-Reply-To: <b906a767-476f-0576-ed53-4f6368af8261@forstware.de>
References: <b906a767-476f-0576-ed53-4f6368af8261@forstware.de>
Message-ID: <HE1PR0402MB2780A0EA7F58425BBB555A1AA6DE9@HE1PR0402MB2780.eurprd04.prod.outlook.com>

> Could NOT find PROJ (missing: PROJ_INCLUDE_DIR) (Required is at least
   version "6.0")


Linking to PROJ lib is mandatory.

All other dependencies are optional (though many are strongly recommended).

Joaquim

-----Original Message-----
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Bj?rn Ruff
Sent: Friday, February 10, 2023 12:29 PM
To: gdal-dev at lists.osgeo.org
Subject: [gdal-dev] building gdal problems

[N?o costuma receber e-mails de br at forstware.de. Saiba por que motivo isto ? importante em https://aka.ms/LearnAboutSenderIdentification. ]

Hello,

I have following problem building gdal with cmake under Windows (having newest version of all)

Can someone tell me what i am doing wrong?

C:\externLibs\gdal\build>cmake -G "Visual Studio 17 2022" ..
-- Selecting Windows SDK version 10.0.22000.0 to target Windows 10.0.19044.
-- GDAL_VERSION          = 3.7.0dev
-- GDAL_ABI_FULL_VERSION = 37
-- GDAL_SOVERSION        =
-- Could NOT find ODBCCPP (missing: ODBCCPP_LIBRARY ODBCCPP_INCLUDE_DIR)
-- Could NOT find MSSQL_NCLI (missing: MSSQL_NCLI_LIBRARY
MSSQL_NCLI_INCLUDE_DIR) (found version "11")
-- Could NOT find MySQL (missing: MYSQL_LIBRARY MYSQL_INCLUDE_DIR)
-- Could NOT find Iconv (missing: Iconv_LIBRARY Iconv_CHARSET_LIBRARY)
-- Could NOT find LibXml2 (missing: LIBXML2_INCLUDE_DIR)
-- Could NOT find EXPAT (missing: EXPAT_DIR)
-- Could NOT find EXPAT (missing: EXPAT_LIBRARY EXPAT_INCLUDE_DIR)
-- Failed to find XercesC (missing: XercesC_LIBRARY XercesC_INCLUDE_DIR
XercesC_VERSION)
-- Could NOT find Deflate (missing: Deflate_LIBRARY Deflate_INCLUDE_DIR)
-- Could NOT find CryptoPP (missing: CRYPTOPP_LIBRARY CRYPTOPP_TEST_KNOWNBUG CRYPTOPP_INCLUDE_DIR) CMake Error at C:/Program
Files/CMake/share/cmake-3.26/Modules/FindPackageHandleStandardArgs.cmake:230
(message):
   Could NOT find PROJ (missing: PROJ_INCLUDE_DIR) (Required is at least
   version "6.0")
Call Stack (most recent call first):
   C:/Program
Files/CMake/share/cmake-3.26/Modules/FindPackageHandleStandardArgs.cmake:600
(_FPHSA_FAILURE_MESSAGE)
   cmake/modules/packages/FindPROJ.cmake:57
(find_package_handle_standard_args)
   cmake/helpers/CheckDependentLibraries.cmake:356 (find_package)
   gdal.cmake:265 (include)
   CMakeLists.txt:224 (include)

Thanks,
Bj?rn Ruff
Forstware Informationssysteme
Von Lassbergstr. 35
D 88709 Meersburg
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at spatialys.com  Fri Feb 10 05:31:15 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 10 Feb 2023 14:31:15 +0100
Subject: [gdal-dev] building gdal problems
In-Reply-To: <b906a767-476f-0576-ed53-4f6368af8261@forstware.de>
References: <b906a767-476f-0576-ed53-4f6368af8261@forstware.de>
Message-ID: <e94448e9-3ed3-0fa7-63f4-3cc5cea7f730@spatialys.com>

Bj?rn,

cf https://gdal.org/development/dev_environment.html . PROJ 
(https://proj.org) is a required build dependency for GDAL

Even

Le 10/02/2023 ? 13:28, Bj?rn Ruff a ?crit?:
> Hello,
>
> I have following problem building gdal with cmake under Windows 
> (having newest version of all)
>
> Can someone tell me what i am doing wrong?
>
> C:\externLibs\gdal\build>cmake -G "Visual Studio 17 2022" ..
> -- Selecting Windows SDK version 10.0.22000.0 to target Windows 
> 10.0.19044.
> -- GDAL_VERSION????????? = 3.7.0dev
> -- GDAL_ABI_FULL_VERSION = 37
> -- GDAL_SOVERSION??????? =
> -- Could NOT find ODBCCPP (missing: ODBCCPP_LIBRARY ODBCCPP_INCLUDE_DIR)
> -- Could NOT find MSSQL_NCLI (missing: MSSQL_NCLI_LIBRARY 
> MSSQL_NCLI_INCLUDE_DIR) (found version "11")
> -- Could NOT find MySQL (missing: MYSQL_LIBRARY MYSQL_INCLUDE_DIR)
> -- Could NOT find Iconv (missing: Iconv_LIBRARY Iconv_CHARSET_LIBRARY)
> -- Could NOT find LibXml2 (missing: LIBXML2_INCLUDE_DIR)
> -- Could NOT find EXPAT (missing: EXPAT_DIR)
> -- Could NOT find EXPAT (missing: EXPAT_LIBRARY EXPAT_INCLUDE_DIR)
> -- Failed to find XercesC (missing: XercesC_LIBRARY 
> XercesC_INCLUDE_DIR XercesC_VERSION)
> -- Could NOT find Deflate (missing: Deflate_LIBRARY Deflate_INCLUDE_DIR)
> -- Could NOT find CryptoPP (missing: CRYPTOPP_LIBRARY 
> CRYPTOPP_TEST_KNOWNBUG CRYPTOPP_INCLUDE_DIR)
> CMake Error at C:/Program 
> Files/CMake/share/cmake-3.26/Modules/FindPackageHandleStandardArgs.cmake:230 
> (message):
> ? Could NOT find PROJ (missing: PROJ_INCLUDE_DIR) (Required is at least
> ? version "6.0")
> Call Stack (most recent call first):
> ? C:/Program 
> Files/CMake/share/cmake-3.26/Modules/FindPackageHandleStandardArgs.cmake:600 
> (_FPHSA_FAILURE_MESSAGE)
> ? cmake/modules/packages/FindPROJ.cmake:57 
> (find_package_handle_standard_args)
> ? cmake/helpers/CheckDependentLibraries.cmake:356 (find_package)
> ? gdal.cmake:265 (include)
> ? CMakeLists.txt:224 (include)
>
> Thanks,
> Bj?rn Ruff
> Forstware Informationssysteme
> Von Lassbergstr. 35
> D 88709 Meersburg
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From public at postholer.com  Sat Feb 11 13:14:59 2023
From: public at postholer.com (Scott)
Date: Sat, 11 Feb 2023 13:14:59 -0800
Subject: [gdal-dev] -sql switch in gdal_rasterize
Message-ID: <ecceb2db-9224-d353-3ec7-526b9d9b2bda@postholer.com>

Other gdal utilities that use the -sql switch allow you to specify a 
path to an sql file preceded with the @ symbol, such as:

-sql @/path/to/source.sql

Is there a way to do this with gdal_rasterize? Adding the above to an 
--optfile returns the same error as doing it on the command line.

TIA

-- 
www.postholer.com

From jukka.rahkonen at maanmittauslaitos.fi  Sun Feb 12 03:34:32 2023
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Sun, 12 Feb 2023 11:34:32 +0000
Subject: [gdal-dev] -sql switch in gdal_rasterize
In-Reply-To: <ecceb2db-9224-d353-3ec7-526b9d9b2bda@postholer.com>
References: <ecceb2db-9224-d353-3ec7-526b9d9b2bda@postholer.com>
Message-ID: <AM0PR09MB3219B2C7AFEFEC2517A93FCFFDDC9@AM0PR09MB3219.eurprd09.prod.outlook.com>

Hi,

Optfile will work if you use it right. Optfile is flexible and it can be used for anything, not only for saving a SQL query into a file. Therefore optfile must have the same literal content that user would write by hand to the command. With optfile

optfile.txt
========
-sql "select * from rakennus"

this command works fine for me

gdal_rasterize --optfile optfile.txt helsinki_city_region.gpkg test.tif -burn 10 -tr 10 10

-Jukka Rahkonen-



-----Alkuper?inen viesti-----
L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Scott
L?hetetty: lauantai 11. helmikuuta 2023 23.15
Vastaanottaja: gdal-dev at lists.osgeo.org
Aihe: [gdal-dev] -sql switch in gdal_rasterize

Other gdal utilities that use the -sql switch allow you to specify a path to an sql file preceded with the @ symbol, such as:

-sql @/path/to/source.sql

Is there a way to do this with gdal_rasterize? Adding the above to an --optfile returns the same error as doing it on the command line.

TIA

--
https://eur06.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.postholer.com%2F&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C914b668d0a674f638f6f08db0c7cddb2%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638117502675505065%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=dRgnBYMNwxd109bxxKlNEoda9BcBz6p8r1%2FSkgB8zSw%3D&reserved=0
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C914b668d0a674f638f6f08db0c7cddb2%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638117502675505065%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=iwBy%2F9rMMB67K969yfqpz9YowN7mfxIm21I4VMjOkUQ%3D&reserved=0

From public at postholer.com  Sun Feb 12 08:16:25 2023
From: public at postholer.com (Scott)
Date: Sun, 12 Feb 2023 08:16:25 -0800
Subject: [gdal-dev] -sql switch in gdal_rasterize
In-Reply-To: <AM0PR09MB3219B2C7AFEFEC2517A93FCFFDDC9@AM0PR09MB3219.eurprd09.prod.outlook.com>
References: <ecceb2db-9224-d353-3ec7-526b9d9b2bda@postholer.com>
 <AM0PR09MB3219B2C7AFEFEC2517A93FCFFDDC9@AM0PR09MB3219.eurprd09.prod.outlook.com>
Message-ID: <94da0316-80f7-9d98-7d64-8812be72ff16@postholer.com>

The hope was to have the gdal_rasterize -sql switch work like it does in 
the other gdal utilities, ie, -sql @/path/to/source.sql. That 
consistency would be really nice.

All my .sql files live in a single directory and things are structured 
around the @ syntax. Further, these .sql quieries can be used 
independently of gdal.

Having an optfile bloated with sql is a hack, not really a solution.


On 2/12/23 03:34, Rahkonen Jukka wrote:
> Hi,
> 
> Optfile will work if you use it right. Optfile is flexible and it can be used for anything, not only for saving a SQL query into a file. Therefore optfile must have the same literal content that user would write by hand to the command. With optfile
> 
> optfile.txt
> ========
> -sql "select * from rakennus"
> 
> this command works fine for me
> 
> gdal_rasterize --optfile optfile.txt helsinki_city_region.gpkg test.tif -burn 10 -tr 10 10
> 
> -Jukka Rahkonen-
> 
> 
> 
> -----Alkuper?inen viesti-----
> L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Scott
> L?hetetty: lauantai 11. helmikuuta 2023 23.15
> Vastaanottaja: gdal-dev at lists.osgeo.org
> Aihe: [gdal-dev] -sql switch in gdal_rasterize
> 
> Other gdal utilities that use the -sql switch allow you to specify a path to an sql file preceded with the @ symbol, such as:
> 
> -sql @/path/to/source.sql
> 
> Is there a way to do this with gdal_rasterize? Adding the above to an --optfile returns the same error as doing it on the command line.
> 
> TIA
> 
> --
> https://eur06.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.postholer.com%2F&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C914b668d0a674f638f6f08db0c7cddb2%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638117502675505065%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=dRgnBYMNwxd109bxxKlNEoda9BcBz6p8r1%2FSkgB8zSw%3D&reserved=0
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C914b668d0a674f638f6f08db0c7cddb2%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638117502675505065%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=iwBy%2F9rMMB67K969yfqpz9YowN7mfxIm21I4VMjOkUQ%3D&reserved=0

From even.rouault at spatialys.com  Sun Feb 12 08:36:20 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 12 Feb 2023 17:36:20 +0100
Subject: [gdal-dev] -sql switch in gdal_rasterize
In-Reply-To: <94da0316-80f7-9d98-7d64-8812be72ff16@postholer.com>
References: <ecceb2db-9224-d353-3ec7-526b9d9b2bda@postholer.com>
 <AM0PR09MB3219B2C7AFEFEC2517A93FCFFDDC9@AM0PR09MB3219.eurprd09.prod.outlook.com>
 <94da0316-80f7-9d98-7d64-8812be72ff16@postholer.com>
Message-ID: <2407cb0e-abb8-64a3-0d29-9beb4872e8f0@spatialys.com>

Implemented in https://github.com/OSGeo/gdal/pull/7235

Le 12/02/2023 ? 17:16, Scott a ?crit?:
> The hope was to have the gdal_rasterize -sql switch work like it does 
> in the other gdal utilities, ie, -sql @/path/to/source.sql. That 
> consistency would be really nice.
>
> All my .sql files live in a single directory and things are structured 
> around the @ syntax. Further, these .sql quieries can be used 
> independently of gdal.
>
> Having an optfile bloated with sql is a hack, not really a solution.
>
>
> On 2/12/23 03:34, Rahkonen Jukka wrote:
>> Hi,
>>
>> Optfile will work if you use it right. Optfile is flexible and it can 
>> be used for anything, not only for saving a SQL query into a file. 
>> Therefore optfile must have the same literal content that user would 
>> write by hand to the command. With optfile
>>
>> optfile.txt
>> ========
>> -sql "select * from rakennus"
>>
>> this command works fine for me
>>
>> gdal_rasterize --optfile optfile.txt helsinki_city_region.gpkg 
>> test.tif -burn 10 -tr 10 10
>>
>> -Jukka Rahkonen-
>>
>>
>>
>> -----Alkuper?inen viesti-----
>> L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Scott
>> L?hetetty: lauantai 11. helmikuuta 2023 23.15
>> Vastaanottaja: gdal-dev at lists.osgeo.org
>> Aihe: [gdal-dev] -sql switch in gdal_rasterize
>>
>> Other gdal utilities that use the -sql switch allow you to specify a 
>> path to an sql file preceded with the @ symbol, such as:
>>
>> -sql @/path/to/source.sql
>>
>> Is there a way to do this with gdal_rasterize? Adding the above to an 
>> --optfile returns the same error as doing it on the command line.
>>
>> TIA
>>
>> -- 
>> https://eur06.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.postholer.com%2F&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C914b668d0a674f638f6f08db0c7cddb2%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638117502675505065%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=dRgnBYMNwxd109bxxKlNEoda9BcBz6p8r1%2FSkgB8zSw%3D&reserved=0 
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C914b668d0a674f638f6f08db0c7cddb2%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638117502675505065%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=iwBy%2F9rMMB67K969yfqpz9YowN7mfxIm21I4VMjOkUQ%3D&reserved=0 
>>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From public at postholer.com  Sun Feb 12 08:39:23 2023
From: public at postholer.com (Scott)
Date: Sun, 12 Feb 2023 08:39:23 -0800
Subject: [gdal-dev] -sql switch in gdal_rasterize
In-Reply-To: <2407cb0e-abb8-64a3-0d29-9beb4872e8f0@spatialys.com>
References: <ecceb2db-9224-d353-3ec7-526b9d9b2bda@postholer.com>
 <AM0PR09MB3219B2C7AFEFEC2517A93FCFFDDC9@AM0PR09MB3219.eurprd09.prod.outlook.com>
 <94da0316-80f7-9d98-7d64-8812be72ff16@postholer.com>
 <2407cb0e-abb8-64a3-0d29-9beb4872e8f0@spatialys.com>
Message-ID: <321ab81a-12b3-1698-9df7-25f84bc4782d@postholer.com>

Thanks Even!


On 2/12/23 08:36, Even Rouault wrote:
> Implemented in https://github.com/OSGeo/gdal/pull/7235
> 
> Le 12/02/2023 ? 17:16, Scott a ?crit?:
>> The hope was to have the gdal_rasterize -sql switch work like it does 
>> in the other gdal utilities, ie, -sql @/path/to/source.sql. That 
>> consistency would be really nice.
>>
>> All my .sql files live in a single directory and things are structured 
>> around the @ syntax. Further, these .sql quieries can be used 
>> independently of gdal.
>>
>> Having an optfile bloated with sql is a hack, not really a solution.
>>
>>
>> On 2/12/23 03:34, Rahkonen Jukka wrote:
>>> Hi,
>>>
>>> Optfile will work if you use it right. Optfile is flexible and it can 
>>> be used for anything, not only for saving a SQL query into a file. 
>>> Therefore optfile must have the same literal content that user would 
>>> write by hand to the command. With optfile
>>>
>>> optfile.txt
>>> ========
>>> -sql "select * from rakennus"
>>>
>>> this command works fine for me
>>>
>>> gdal_rasterize --optfile optfile.txt helsinki_city_region.gpkg 
>>> test.tif -burn 10 -tr 10 10
>>>
>>> -Jukka Rahkonen-
>>>
>>>
>>>
>>> -----Alkuper?inen viesti-----
>>> L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Scott
>>> L?hetetty: lauantai 11. helmikuuta 2023 23.15
>>> Vastaanottaja: gdal-dev at lists.osgeo.org
>>> Aihe: [gdal-dev] -sql switch in gdal_rasterize
>>>
>>> Other gdal utilities that use the -sql switch allow you to specify a 
>>> path to an sql file preceded with the @ symbol, such as:
>>>
>>> -sql @/path/to/source.sql
>>>
>>> Is there a way to do this with gdal_rasterize? Adding the above to an 
>>> --optfile returns the same error as doing it on the command line.
>>>
>>> TIA
>>>
>>> -- 
>>> https://eur06.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.postholer.com%2F&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C914b668d0a674f638f6f08db0c7cddb2%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638117502675505065%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=dRgnBYMNwxd109bxxKlNEoda9BcBz6p8r1%2FSkgB8zSw%3D&reserved=0
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C914b668d0a674f638f6f08db0c7cddb2%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638117502675505065%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=iwBy%2F9rMMB67K969yfqpz9YowN7mfxIm21I4VMjOkUQ%3D&reserved=0
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 

From even.rouault at spatialys.com  Sun Feb 12 10:39:40 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 12 Feb 2023 19:39:40 +0100
Subject: [gdal-dev] Call for discussion on RFC 92 text: WKB Only
 geometries
In-Reply-To: <9dced7b2-f806-9309-d6f1-f2b02a18f656@spatialys.com>
References: <9dced7b2-f806-9309-d6f1-f2b02a18f656@spatialys.com>
Message-ID: <0e5f9400-7fc8-6822-4abc-cbfe1248a42b@spatialys.com>

Hi,

I've captured in the RFC text the interesting discussion points. As I 
don't see a clear way forward for this RFC that offers a good balance 
between usefulness, efficiency, elegance and level of effort to 
implement, I'll commit the RFC text with a "on hold" status.

Even

Le 31/01/2023 ? 12:27, Even Rouault a ?crit?:
> Hi,
>
> Please find for review "RFC 92 text: WKB Only geometries" at 
> https://github.com/OSGeo/gdal/pull/7149
>
> This RFC provides shortcuts to avoid instantiation of full OGRGeometry 
> instances
> in scenarios where only the WKB representation of geometries is 
> needed. The
> hope is to save CPU time.
>
> This is something I wanted to at least experiment. I've mixed feelings 
> if it's something we actually want to adopt.
>
> Even
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.


From sean.gillies at gmail.com  Sun Feb 12 14:46:13 2023
From: sean.gillies at gmail.com (Sean Gillies)
Date: Sun, 12 Feb 2023 15:46:13 -0700
Subject: [gdal-dev] Call for discussion on RFC 92 text: WKB Only
 geometries
In-Reply-To: <1690afd1-8779-297b-c883-9ac39691a5a7@spatialys.com>
References: <9dced7b2-f806-9309-d6f1-f2b02a18f656@spatialys.com>
 <CAOodmJp8gLQTmcb0BPYatz_F4tPXx8zrMU=M6n2fMhaFcRz8-A@mail.gmail.com>
 <1690afd1-8779-297b-c883-9ac39691a5a7@spatialys.com>
Message-ID: <CAOodmJrmdv0rFM+eFWrxGzeGNOMB3pK8F_4Srk8pfKRwZRQJ+g@mail.gmail.com>

Hi Even,

I'm glad you mentioned a shift of concepts. The older Feature API and new
Arrow API are really quite different. I actually don't know how often I
will ever combine them in one program, for example to turn shapefiles into
a huge Parquet file or the reverse. If anybody is doing this kind of thing
I'd be interested to read about it.

This RFC seems to have some things in common with the direct access to
compressed raster blocks. Both by-pass the older raster and vector data
models, yes? And they're quite specific to certain formats. Do you
anticipate that GDAL and OGR will continue to develop more specialty APIs
in addition to the general ones?

On Sat, Feb 4, 2023, 11:55 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi Sean,
>
> but wouldn't it be possible for all OGRFeatures to carry WKB data by
> default and add a method to provide it to callers?
>
> My understanding of what you propose would involve massive code rewrites
> in all drivers and wouldn't be desirable from a performance point of view,
> because most drivers can't generate WKB easily (PostGIS and GPKG are the
> exceptions rather the norm). So either all other drivers should be modified
> to compose WKB at hand (massive coding effort. Probably several weeks of
> effort and significant risk of regressions). Or get it from the
> ExportToWkb() method of the OGRGeometry instance they currently build, but
> then you pay the price in memory and CPU time to generate WKB that might
> not be consumed by users.
>
> | And only construct an OGRGeometry when it's asked for? Such as when
> GetGeometryRef is called?
>
> Good point, we could both make GetGeometryRef() and GetGeomFieldRef()
> virtual methods whose default implementation would be the same as
> currently, ie. return the value of the corresponding member variable in the
> base OGRFeature class stored with
> SetGeometry[Directly]()/SetGeomField[Directly]()
>
> And add a new virtual method:
>
> virtual GByte* OGRFeature::GetWKBGeometry(int iGeomField, size_t*
> pnOutSize) const
>
> whose default implementation would just use
> GetGeomFieldRef(iGeomField)->ExportToWkb().
>
> The few drivers that can provide a more efficient implementation (GPKG
> typically) would create a derived class OGRFeatureGPKG with a specific
> implementation of those new virtual methods to avoid systematic OGRGeometry
> instantiation. The only drawback I see is that making GetGeometryRef() and
> GetGeomFieldRef() virtual would have a slight performance impact, but
> probably small enough.
>
>
> But fundamentally I'm wondering if RFC 92 hasn't been made mostly out
> fashioned now that we have RFC 86. RFC 86 generally leads to 2x speed-up or
> more on real-world datasets compared to OGRFeature iteration (as measured
> by the bench_ogr_c_api vs bench_ogr_batch utilities) on drivers that have
> implemented it (currently Arrow, Parquet, FlatGeoBuf, GPKG), whereas RFC 92
> only applies to GPKG & PostGIS and in the best - artificial - case only
> lead to 30% speed-up.
>
> Of course, adopting RFC 86 requires significant effort from GDAL users,
> but the benefit is really measurable whereas with RFC 92 it would be
> marginal in most scenarios. As far as I can tell, the performance boost of
> RFC 86 comes mostly from saving creation & destruction of millions of
> OGRFeature instances, its array members, string attributes, geometries
> objects, more than the columnar organization of the ArrowArray data
> structures. In the GeoPackage driver, I've also shown that it makes it
> possible for efficient multi-threading pre-fetching, totally transparent
> for the user.
>
> But to avoid selling false hopes, the benefit of RFC 86 in end-to-end
> scenarios would probably drop significantly (at least if looking at
> performance gain in percentage. The absolute performance savings on the
> GDAL side would remain) if you need to recreate individual features (QGIS'
> QgsFeature or MapServer' msShape objects) from the content of ArrowArray.
> So this is likely a complete shift of concepts that would be required.
>
> Even
>
>
>
> On Tue, Jan 31, 2023 at 4:27 AM Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> Hi,
>>
>> Please find for review "RFC 92 text: WKB Only geometries" at
>> https://github.com/OSGeo/gdal/pull/7149
>>
>> This RFC provides shortcuts to avoid instantiation of full OGRGeometry
>> instances
>> in scenarios where only the WKB representation of geometries is needed.
>> The
>> hope is to save CPU time.
>>
>> This is something I wanted to at least experiment. I've mixed feelings
>> if it's something we actually want to adopt.
>>
>> Even
>>
>> --
>> http://www.spatialys.com
>> My software is free, but my time generally not.
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
> --
> Sean Gillies
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230212/0165395e/attachment.htm>

From even.rouault at spatialys.com  Sun Feb 12 15:00:55 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 13 Feb 2023 00:00:55 +0100
Subject: [gdal-dev] Call for discussion on RFC 92 text: WKB Only
 geometries
In-Reply-To: <CAOodmJrmdv0rFM+eFWrxGzeGNOMB3pK8F_4Srk8pfKRwZRQJ+g@mail.gmail.com>
References: <9dced7b2-f806-9309-d6f1-f2b02a18f656@spatialys.com>
 <CAOodmJp8gLQTmcb0BPYatz_F4tPXx8zrMU=M6n2fMhaFcRz8-A@mail.gmail.com>
 <1690afd1-8779-297b-c883-9ac39691a5a7@spatialys.com>
 <CAOodmJrmdv0rFM+eFWrxGzeGNOMB3pK8F_4Srk8pfKRwZRQJ+g@mail.gmail.com>
Message-ID: <5804ed11-0ecf-fb18-d5cf-d74643e436e3@spatialys.com>


>
> This RFC seems to have some things in common with the direct access to 
> compressed raster blocks. Both by-pass the older raster and vector 
> data models, yes? And they're quite specific to certain formats. Do 
> you anticipate that GDAL and OGR will continue to develop more 
> specialty APIs in addition to the general ones?

I have no preconceived ideas. I'd say that specialized API have their 
place when they bring enough value, and don't do that at the cost of 
complicating things that don't benefit from them. RFC 92 just doesn't 
pass my own criteria (my vote for it would be 0 in its current state, 
but maybe someone will want to restart from it and give it a second life).

Even
>
> On Sat, Feb 4, 2023, 11:55 AM Even Rouault 
> <even.rouault at spatialys.com> wrote:
>
>     Hi Sean,
>
>
>>     but wouldn't it be possible for all OGRFeatures to carry WKB data
>>     by default and add a method to provide it to callers?
>
>     My understanding of what you propose would involve massive code
>     rewrites in all drivers and wouldn't be desirable from a
>     performance point of view, because most drivers can't generate WKB
>     easily (PostGIS and GPKG are the exceptions rather the norm). So
>     either all other drivers should be modified to compose WKB at hand
>     (massive coding effort. Probably several weeks of effort and
>     significant risk of regressions). Or get it from the ExportToWkb()
>     method of the OGRGeometry instance they currently build, but then
>     you pay the price in memory and CPU time to generate WKB that
>     might not be consumed by users.
>
>     | And only construct an OGRGeometry when it's asked for? Such as
>     when GetGeometryRef is called?
>
>     Good point, we could both make GetGeometryRef() and
>     GetGeomFieldRef() virtual methods whose default implementation
>     would be the same as currently, ie. return the value of the
>     corresponding member variable in the base OGRFeature class stored
>     with SetGeometry[Directly]()/SetGeomField[Directly]()
>
>     And add a new virtual method:
>
>     virtual GByte* OGRFeature::GetWKBGeometry(int iGeomField, size_t*
>     pnOutSize) const
>
>     whose default implementation would just use
>     GetGeomFieldRef(iGeomField)->ExportToWkb().
>
>     The few drivers that can provide a more efficient implementation
>     (GPKG typically) would create a derived class OGRFeatureGPKG with
>     a specific implementation of those new virtual methods to avoid
>     systematic OGRGeometry instantiation. The only drawback I see is
>     that making GetGeometryRef() and GetGeomFieldRef() virtual would
>     have a slight performance impact, but probably small enough.
>
>
>     But fundamentally I'm wondering if RFC 92 hasn't been made mostly
>     out fashioned now that we have RFC 86. RFC 86 generally leads to
>     2x speed-up or more on real-world datasets compared to OGRFeature
>     iteration (as measured by the bench_ogr_c_api vs bench_ogr_batch
>     utilities) on drivers that have implemented it (currently Arrow,
>     Parquet, FlatGeoBuf, GPKG), whereas RFC 92 only applies to GPKG &
>     PostGIS and in the best - artificial - case only lead to 30% speed-up.
>
>     Of course, adopting RFC 86 requires significant effort from GDAL
>     users, but the benefit is really measurable whereas with RFC 92 it
>     would be marginal in most scenarios. As far as I can tell, the
>     performance boost of RFC 86 comes mostly from saving creation &
>     destruction of millions of OGRFeature instances, its array
>     members, string attributes, geometries objects, more than the
>     columnar organization of the ArrowArray data structures. In the
>     GeoPackage driver, I've also shown that it makes it possible for
>     efficient multi-threading pre-fetching, totally transparent for
>     the user.
>
>     But to avoid selling false hopes, the benefit of RFC 86 in
>     end-to-end scenarios would probably drop significantly (at least
>     if looking at performance gain in percentage. The absolute
>     performance savings on the GDAL side would remain) if you need to
>     recreate individual features (QGIS' QgsFeature or MapServer'
>     msShape objects) from the content of ArrowArray. So this is likely
>     a complete shift of concepts that would be required.
>
>     Even
>
>
>>
>>     On Tue, Jan 31, 2023 at 4:27 AM Even Rouault
>>     <even.rouault at spatialys.com> wrote:
>>
>>         Hi,
>>
>>         Please find for review "RFC 92 text: WKB Only geometries" at
>>         https://github.com/OSGeo/gdal/pull/7149
>>
>>         This RFC provides shortcuts to avoid instantiation of full
>>         OGRGeometry
>>         instances
>>         in scenarios where only the WKB representation of geometries
>>         is needed. The
>>         hope is to save CPU time.
>>
>>         This is something I wanted to at least experiment. I've mixed
>>         feelings
>>         if it's something we actually want to adopt.
>>
>>         Even
>>
>>         -- 
>>         http://www.spatialys.com
>>         My software is free, but my time generally not.
>>
>>         _______________________________________________
>>         gdal-dev mailing list
>>         gdal-dev at lists.osgeo.org
>>         https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>
>>
>>     -- 
>>     Sean Gillies
>>
>>     _______________________________________________
>>     gdal-dev mailing list
>>     gdal-dev at lists.osgeo.org
>>     https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>     -- 
>     http://www.spatialys.com
>     My software is free, but my time generally not.
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230213/999fc1b7/attachment-0001.htm>

From simon.eves at heavy.ai  Sun Feb 12 18:44:08 2023
From: simon.eves at heavy.ai (Simon Eves)
Date: Sun, 12 Feb 2023 18:44:08 -0800
Subject: [gdal-dev] OpenJPEG JPEG2000 Driver
Message-ID: <CAJf0KTQLWnqEMb7yYn9LB_BN6XZ3+xDfxeqk-CibHSYXMWkjcA@mail.gmail.com>

Is there some trick to enabling this driver with the old non-CMake build
env...? :)

I am building OpenJPEG 2.5.0 (from source) and it's building and installing
fine into the same include/lib tree as everything else, and then GDAL
configure (just adding *--with-openjpeg*, no path, right?) sees it and
tests it, but the compile test of *opj_setup_decoder()* apparently fails,
so *HAVE_OPENJPEG* gets disabled again.

I see that function in *openjpeg.h* and (with *nm*) in *libopenjp2.a*, so
I'm not sure why it's failing.

I tried some other CMake option variations for OpenJPEG but nothing fixed
it.

Ubuntu 20.04, GCC 9.4, GDAL 3.4.1, all-static build

I have tried GDAL 3.6.2 (and PROJ 9.2.1) building them with CMake and I
think the OpenJPEG part is working, then but our dependencies build falls
over later with something else that doesn't like the newer PROJ, and I'd
rather not bump the GDAL & PROJ and data files versions at this time
anyway, as we're very close to a release.

I just wanna minimally add JPEG2000 to what we have...

TIA

-- 
Simon Eves
Senior Rendering Engineer
+1 (415) 902-1996
simon.eves at heavy.ai

<http://www.heavy.ai>

(formerly OmniSci)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230212/599e7d42/attachment.htm>

From Matt.Wilkie at yukon.ca  Mon Feb 13 11:57:20 2023
From: Matt.Wilkie at yukon.ca (Matt.Wilkie)
Date: Mon, 13 Feb 2023 19:57:20 +0000
Subject: [gdal-dev] How to build STAC of local raster files?
Message-ID: <YT3PR01MB55905495B32AFC9E112E10B187DD9@YT3PR01MB5590.CANPRD01.PROD.OUTLOOK.COM>

Hi,

I'm looking for tutorial/guide/info on how to build SpatioTemporal Asset Catalog for resources like geotiff on local file systems and Windows server shares. It would later be consumed by something like stac-browser<https://github.com/radiantearth/stac-browser> (I think, I'm not clear on this part yet).

Also asked at https://gis.stackexchange.com/questions/451951/how-to-build-stac-of-local-raster-files in order to catch more eyeballs.

Thanks!
Matt Wilkie
Geomatics Developer & Administrator
Environment | Technology, Innovation and Mapping
T 867-667-8133 | Yukon.ca<http://yukon.ca/>
Hours: 08:30-16:30, Mon-Wed: Office, Thu: Remote, Fri: Away.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230213/1e09b64d/attachment.htm>

From vincent.sarago at gmail.com  Mon Feb 13 12:03:14 2023
From: vincent.sarago at gmail.com (Vincent Sarago)
Date: Mon, 13 Feb 2023 21:03:14 +0100
Subject: [gdal-dev] How to build STAC of local raster files?
In-Reply-To: <YT3PR01MB55905495B32AFC9E112E10B187DD9@YT3PR01MB5590.CANPRD01.PROD.OUTLOOK.COM>
References: <YT3PR01MB55905495B32AFC9E112E10B187DD9@YT3PR01MB5590.CANPRD01.PROD.OUTLOOK.COM>
Message-ID: <7B5DD174-147E-4A14-AC1A-7082F6E11741@gmail.com>

For creating STAC Items you can look at https://github.com/developmentseed/rio-stac (disclaimer I?m the author), you can also have a look at https://github.com/stac-utils/pystac for creating items and catalog

Here is a quick how to about how to create items and collection and ingesting them to pgstac https://github.com/developmentseed/eoAPI/tree/master/demo/noaa

Vincent 

> On Feb 13, 2023, at 8:57 PM, Matt.Wilkie <Matt.Wilkie at yukon.ca> wrote:
> 
> Hi,
> 
> I?m looking for tutorial/guide/info on how to build SpatioTemporal Asset Catalog for resources like geotiff on local file systems and Windows server shares. It would later be consumed by something like stac-browser <https://github.com/radiantearth/stac-browser> (I think, I?m not clear on this part yet).
> 
> Also asked at https://gis.stackexchange.com/questions/451951/how-to-build-stac-of-local-raster-files in order to catch more eyeballs.
> 
> Thanks!
> 
> Matt Wilkie
> Geomatics Developer & Administrator
> Environment | Technology, Innovation and Mapping
> T 867-667-8133 | Yukon.ca <http://yukon.ca/>
> Hours: 08:30-16:30, Mon-Wed: Office, Thu: Remote, Fri: Away.
>  
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230213/f3b28003/attachment.htm>

From Matt.Wilkie at yukon.ca  Mon Feb 13 12:25:26 2023
From: Matt.Wilkie at yukon.ca (Matt.Wilkie)
Date: Mon, 13 Feb 2023 20:25:26 +0000
Subject: [gdal-dev] [EXT] Re:  How to build STAC of local raster files?
In-Reply-To: <7B5DD174-147E-4A14-AC1A-7082F6E11741@gmail.com>
References: <YT3PR01MB55905495B32AFC9E112E10B187DD9@YT3PR01MB5590.CANPRD01.PROD.OUTLOOK.COM>
 <7B5DD174-147E-4A14-AC1A-7082F6E11741@gmail.com>
Message-ID: <YT3PR01MB55904403D5A3D24CAE32D1F287DD9@YT3PR01MB5590.CANPRD01.PROD.OUTLOOK.COM>

Thanks Vincent!

If I'm reading those right: rio stac is for adding individual entries in a catalog, but the process of locating the items to feed it is a homework exercise. Does it know to check if the record exists already? Can it create a catalog from scratch, or does that have to exist already?

Matt

From: Vincent Sarago <vincent.sarago at gmail.com>
Sent: February 13, 2023 1:03 PM
To: Matt.Wilkie <Matt.Wilkie at yukon.ca>
Cc: gdal-dev at lists.osgeo.org
Subject: [EXT] Re: [gdal-dev] How to build STAC of local raster files?

You don't often get email from vincent.sarago at gmail.com<mailto:vincent.sarago at gmail.com>. Learn why this is important<https://aka.ms/LearnAboutSenderIdentification>
For creating STAC Items you can look at https://github.com/developmentseed/rio-stac<https://can01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fdevelopmentseed%2Frio-stac&data=05%7C01%7CMatt.Wilkie%40yukon.ca%7Cfbaf365c2fc04e7785e508db0dfd5ea5%7C98f515313973490abb70195aa264a2bc%7C0%7C0%7C638119154534363528%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C2000%7C%7C%7C&sdata=Fku5b4FdCPo0koQINGqFcsA4rFD4eXVWQMv3gUDiQbo%3D&reserved=0> (disclaimer I'm the author), you can also have a look at https://github.com/stac-utils/pystac<https://can01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fstac-utils%2Fpystac&data=05%7C01%7CMatt.Wilkie%40yukon.ca%7Cfbaf365c2fc04e7785e508db0dfd5ea5%7C98f515313973490abb70195aa264a2bc%7C0%7C0%7C638119154534519723%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C2000%7C%7C%7C&sdata=FPoHfpVP%2FY9m%2FwL5mu2ubj3xiOIftwQ0Qp%2F605%2FZQmY%3D&reserved=0> for creating items and catalog

Here is a quick how to about how to create items and collection and ingesting them to pgstac https://github.com/developmentseed/eoAPI/tree/master/demo/noaa<https://can01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fdevelopmentseed%2FeoAPI%2Ftree%2Fmaster%2Fdemo%2Fnoaa&data=05%7C01%7CMatt.Wilkie%40yukon.ca%7Cfbaf365c2fc04e7785e508db0dfd5ea5%7C98f515313973490abb70195aa264a2bc%7C0%7C0%7C638119154534519723%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C2000%7C%7C%7C&sdata=9xvFOaO6fHnEHjixnhzrLHBS2akWp78QBaweV5I6veo%3D&reserved=0>

Vincent


On Feb 13, 2023, at 8:57 PM, Matt.Wilkie <Matt.Wilkie at yukon.ca<mailto:Matt.Wilkie at yukon.ca>> wrote:


Hi,

I'm looking for tutorial/guide/info on how to build SpatioTemporal Asset Catalog for resources like geotiff on local file systems and Windows server shares. It would later be consumed by something like stac-browser<https://can01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fradiantearth%2Fstac-browser&data=05%7C01%7CMatt.Wilkie%40yukon.ca%7Cfbaf365c2fc04e7785e508db0dfd5ea5%7C98f515313973490abb70195aa264a2bc%7C0%7C0%7C638119154534519723%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C2000%7C%7C%7C&sdata=DDLTGzK70wkuozHxsv6o2h2CkPWv1ejfrGtzBg2qL4s%3D&reserved=0> (I think, I'm not clear on this part yet).

Also asked at https://gis.stackexchange.com/questions/451951/how-to-build-stac-of-local-raster-files<https://can01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgis.stackexchange.com%2Fquestions%2F451951%2Fhow-to-build-stac-of-local-raster-files&data=05%7C01%7CMatt.Wilkie%40yukon.ca%7Cfbaf365c2fc04e7785e508db0dfd5ea5%7C98f515313973490abb70195aa264a2bc%7C0%7C0%7C638119154534519723%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C2000%7C%7C%7C&sdata=hUnYEUHVXhmMzWXT126fGBru9GW0bsgcrQMvU6QyJQg%3D&reserved=0> in order to catch more eyeballs.

Thanks!
Matt Wilkie
Geomatics Developer & Administrator
Environment | Technology, Innovation and Mapping
T 867-667-8133 | Yukon.ca<https://can01.safelinks.protection.outlook.com/?url=http%3A%2F%2Fyukon.ca%2F&data=05%7C01%7CMatt.Wilkie%40yukon.ca%7Cfbaf365c2fc04e7785e508db0dfd5ea5%7C98f515313973490abb70195aa264a2bc%7C0%7C0%7C638119154534519723%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C2000%7C%7C%7C&sdata=CPlnciUt2DDl4%2Bim9RPThOM52dWCulOe1oxSgBiMSEE%3D&reserved=0>
Hours: 08:30-16:30, Mon-Wed: Office, Thu: Remote, Fri: Away.

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev<https://can01.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&data=05%7C01%7CMatt.Wilkie%40yukon.ca%7Cfbaf365c2fc04e7785e508db0dfd5ea5%7C98f515313973490abb70195aa264a2bc%7C0%7C0%7C638119154534519723%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C2000%7C%7C%7C&sdata=bLBlgnCvxOBPBg%2FGoSAaC1U%2B8mN02W9VpZgvA8jZbx0%3D&reserved=0>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230213/18742a4c/attachment-0001.htm>

From vincent.sarago at gmail.com  Mon Feb 13 12:31:21 2023
From: vincent.sarago at gmail.com (Vincent Sarago)
Date: Mon, 13 Feb 2023 21:31:21 +0100
Subject: [gdal-dev] [EXT]  How to build STAC of local raster files?
In-Reply-To: <YT3PR01MB55904403D5A3D24CAE32D1F287DD9@YT3PR01MB5590.CANPRD01.PROD.OUTLOOK.COM>
References: <YT3PR01MB55905495B32AFC9E112E10B187DD9@YT3PR01MB5590.CANPRD01.PROD.OUTLOOK.COM>
 <7B5DD174-147E-4A14-AC1A-7082F6E11741@gmail.com>
 <YT3PR01MB55904403D5A3D24CAE32D1F287DD9@YT3PR01MB5590.CANPRD01.PROD.OUTLOOK.COM>
Message-ID: <DBF1955C-8F2D-41C6-8388-5A8B755162FA@gmail.com>

rio-stac will just create a STAC Item (a json file locally), if you want to put it in a database (like pgstac) you?ll have to do it using other tools (like pypgstac) 

> Does it know to check if the record exists already?
Depends on the tool and database you?re using

> Can it create a catalog from scratch, or does that have to exist already?

Check pystac 

Feel free to ask more question about STAC over https://matrix.to/#/#SpatioTemporal-Asset-Catalog_Lobby:gitter.im

Vincent 

> On Feb 13, 2023, at 9:25 PM, Matt.Wilkie <Matt.Wilkie at yukon.ca> wrote:
> 
> Thanks Vincent!
>  
> If I?m reading those right: rio stac is for adding individual entries in a catalog, but the process of locating the items to feed it is a homework exercise. Does it know to check if the record exists already? Can it create a catalog from scratch, or does that have to exist already?
>  
> Matt
>  
> From: Vincent Sarago <vincent.sarago at gmail.com <mailto:vincent.sarago at gmail.com>> 
> Sent: February 13, 2023 1:03 PM
> To: Matt.Wilkie <Matt.Wilkie at yukon.ca <mailto:Matt.Wilkie at yukon.ca>>
> Cc: gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
> Subject: [EXT] Re: [gdal-dev] How to build STAC of local raster files?
>  
> You don't often get email from vincent.sarago at gmail.com <mailto:vincent.sarago at gmail.com>. Learn why this is important <https://aka.ms/LearnAboutSenderIdentification>	
> For creating STAC Items you can look at https://github.com/developmentseed/rio-stac <https://can01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fdevelopmentseed%2Frio-stac&data=05%7C01%7CMatt.Wilkie%40yukon.ca%7Cfbaf365c2fc04e7785e508db0dfd5ea5%7C98f515313973490abb70195aa264a2bc%7C0%7C0%7C638119154534363528%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C2000%7C%7C%7C&sdata=Fku5b4FdCPo0koQINGqFcsA4rFD4eXVWQMv3gUDiQbo%3D&reserved=0> (disclaimer I?m the author), you can also have a look at https://github.com/stac-utils/pystac <https://can01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fstac-utils%2Fpystac&data=05%7C01%7CMatt.Wilkie%40yukon.ca%7Cfbaf365c2fc04e7785e508db0dfd5ea5%7C98f515313973490abb70195aa264a2bc%7C0%7C0%7C638119154534519723%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C2000%7C%7C%7C&sdata=FPoHfpVP%2FY9m%2FwL5mu2ubj3xiOIftwQ0Qp%2F605%2FZQmY%3D&reserved=0> for creating items and catalog 
>  
> Here is a quick how to about how to create items and collection and ingesting them to pgstac https://github.com/developmentseed/eoAPI/tree/master/demo/noaa <https://can01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fdevelopmentseed%2FeoAPI%2Ftree%2Fmaster%2Fdemo%2Fnoaa&data=05%7C01%7CMatt.Wilkie%40yukon.ca%7Cfbaf365c2fc04e7785e508db0dfd5ea5%7C98f515313973490abb70195aa264a2bc%7C0%7C0%7C638119154534519723%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C2000%7C%7C%7C&sdata=9xvFOaO6fHnEHjixnhzrLHBS2akWp78QBaweV5I6veo%3D&reserved=0>
>  
> Vincent 
> 
> 
> On Feb 13, 2023, at 8:57 PM, Matt.Wilkie <Matt.Wilkie at yukon.ca <mailto:Matt.Wilkie at yukon.ca>> wrote:
>  
> Hi,
> 
> I?m looking for tutorial/guide/info on how to build SpatioTemporal Asset Catalog for resources like geotiff on local file systems and Windows server shares. It would later be consumed by something like stac-browser <https://can01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fradiantearth%2Fstac-browser&data=05%7C01%7CMatt.Wilkie%40yukon.ca%7Cfbaf365c2fc04e7785e508db0dfd5ea5%7C98f515313973490abb70195aa264a2bc%7C0%7C0%7C638119154534519723%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C2000%7C%7C%7C&sdata=DDLTGzK70wkuozHxsv6o2h2CkPWv1ejfrGtzBg2qL4s%3D&reserved=0> (I think, I?m not clear on this part yet).
> 
> Also asked at https://gis.stackexchange.com/questions/451951/how-to-build-stac-of-local-raster-files <https://can01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgis.stackexchange.com%2Fquestions%2F451951%2Fhow-to-build-stac-of-local-raster-files&data=05%7C01%7CMatt.Wilkie%40yukon.ca%7Cfbaf365c2fc04e7785e508db0dfd5ea5%7C98f515313973490abb70195aa264a2bc%7C0%7C0%7C638119154534519723%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C2000%7C%7C%7C&sdata=hUnYEUHVXhmMzWXT126fGBru9GW0bsgcrQMvU6QyJQg%3D&reserved=0> in order to catch more eyeballs.
> 
> Thanks!
> 
> Matt Wilkie
> Geomatics Developer & Administrator
> Environment | Technology, Innovation and Mapping
> T 867-667-8133 | Yukon.ca <https://can01.safelinks.protection.outlook.com/?url=http%3A%2F%2Fyukon.ca%2F&data=05%7C01%7CMatt.Wilkie%40yukon.ca%7Cfbaf365c2fc04e7785e508db0dfd5ea5%7C98f515313973490abb70195aa264a2bc%7C0%7C0%7C638119154534519723%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C2000%7C%7C%7C&sdata=CPlnciUt2DDl4%2Bim9RPThOM52dWCulOe1oxSgBiMSEE%3D&reserved=0>
> Hours: 08:30-16:30, Mon-Wed: Office, Thu: Remote, Fri: Away.
>  
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
> https://lists.osgeo.org/mailman/listinfo/gdal-dev <https://can01.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&data=05%7C01%7CMatt.Wilkie%40yukon.ca%7Cfbaf365c2fc04e7785e508db0dfd5ea5%7C98f515313973490abb70195aa264a2bc%7C0%7C0%7C638119154534519723%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C2000%7C%7C%7C&sdata=bLBlgnCvxOBPBg%2FGoSAaC1U%2B8mN02W9VpZgvA8jZbx0%3D&reserved=0>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230213/3d9164a2/attachment.htm>

From traviskirstine at gmail.com  Mon Feb 13 12:32:26 2023
From: traviskirstine at gmail.com (Travis Kirstine)
Date: Mon, 13 Feb 2023 15:32:26 -0500
Subject: [gdal-dev] How to build STAC of local raster files?
In-Reply-To: <7B5DD174-147E-4A14-AC1A-7082F6E11741@gmail.com>
References: <YT3PR01MB55905495B32AFC9E112E10B187DD9@YT3PR01MB5590.CANPRD01.PROD.OUTLOOK.COM>
 <7B5DD174-147E-4A14-AC1A-7082F6E11741@gmail.com>
Message-ID: <CALtm4h3+oVjfer+8ppc1114CQWKEHZ8=VmEeASCz21tR_8jd9Q@mail.gmail.com>

The pystac tutorial helped me.

https://pystac.readthedocs.io/en/latest/tutorials.html



On Mon, 13 Feb 2023 at 15:03, Vincent Sarago <vincent.sarago at gmail.com>
wrote:

> For creating STAC Items you can look at
> https://github.com/developmentseed/rio-stac (disclaimer I?m the author),
> you can also have a look at https://github.com/stac-utils/pystac for
> creating items and catalog
>
> Here is a quick how to about how to create items and collection and
> ingesting them to pgstac
> https://github.com/developmentseed/eoAPI/tree/master/demo/noaa
>
> Vincent
>
> On Feb 13, 2023, at 8:57 PM, Matt.Wilkie <Matt.Wilkie at yukon.ca> wrote:
>
> Hi,
>
> I?m looking for tutorial/guide/info on how to build SpatioTemporal Asset
> Catalog for resources like geotiff on local file systems and Windows server
> shares. It would later be consumed by something like stac-browser
> <https://github.com/radiantearth/stac-browser> (I think, I?m not clear on
> this part yet).
>
> Also asked at
> https://gis.stackexchange.com/questions/451951/how-to-build-stac-of-local-raster-files
>  in order to catch more eyeballs.
>
> Thanks!
>
> *Matt Wilkie*
> Geomatics Developer & Administrator
> Environment | Technology, Innovation and Mapping
> T 867-667-8133 | *Yukon.ca <http://yukon.ca/>*
> *Hours: 08:30-16:30, Mon-Wed: Office, Thu: Remote, Fri: Away.*
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230213/90fad9c8/attachment-0001.htm>

From afernandez at odyhpc.com  Tue Feb 14 08:25:36 2023
From: afernandez at odyhpc.com (afernandez)
Date: Tue, 14 Feb 2023 16:25:36 +0000
Subject: [gdal-dev] Issues with SetColorTable() and multi-sample TIFF
Message-ID: <cf35d819b16e3.4ed0e9f08beef@odyhpc.com>

Hello,
I'm using the GDAL Tools plugin within QGIS to plot some raster layers. The 
snippet reads:
driver_name = 'GTIFF'
driver = gdal.GetDriverByName(driver_name) 
...
gdal_ds = driver.Create("my_arguments") 
gdal_ds.SetProjection("my_projection")
gdal_ds.SetGeoTransform("my_geo_transform")
for band_idx in range(1, times + 1):
band = gdal_ds.GetRasterBand(band_idx) 
band.SetNoDataValue(no_data)
band.SetDescription(time_step)
data = var[band_idx - 1]
data = ma.getdata(data)
band.WriteArray(data.astype(np_dtype, copy=False))
gdal_ds.FlushCache()
This works without any problem and plots the raster in greys. However, I 
need the plot to be colored so I modified the code based on some posts, 
which now reads: 
gdal_ds = driver.Create(out_path, cols, rows, times, gdal.GDT_UInt16) 
gdal_ds.SetProjection("my_projection")
gdal_ds.SetGeoTransform("my_geo_transform")
for band_idx in range(1, times + 1):
band = gdal_ds.GetRasterBand(band_idx) 
band.SetNoDataValue(no_data)
band.SetDescription(time_step)
data = var[band_idx - 1]
data = ma.getdata(data)
data_scaled = np.interp(data, (data.min(), data.max()), (0, 255))
data_scaled2 = data_scaled.astype(int)
colors = gdal.ColorTable()
colors.CreateColorRamp(0, (229, 245, 249), 127, (153, 216, 201))
colors.CreateColorRamp(127, (153, 216, 201), 254, (44, 162, 95))
band.SetRasterColorTable(colors)
band.SetRasterColorInterpretation(gdal.GCI_PaletteIndex)
band.WriteArray(data_scaled2)
gdal_ds.FlushCache()
The problem is that this produces a RunTimeError: SetColorTable() not 
supported for multi-sample TIFF. I simplified this for a single band and 
QGIS did plot the colored raster. However, this is not a solution because 
production runs will generate dozens (or even hundreds) of time step bands. 
I'm pretty new to GDAL so I'm unsure if this is a feature under current 
development or if there are other alternatives so any suggestion on how to 
proceed would be appreciated.
Thank you in advance.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230214/cd419fc2/attachment.htm>

From even.rouault at spatialys.com  Tue Feb 14 09:07:14 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 14 Feb 2023 18:07:14 +0100
Subject: [gdal-dev] Issues with SetColorTable() and multi-sample TIFF
In-Reply-To: <cf35d819b16e3.4ed0e9f08beef@odyhpc.com>
References: <cf35d819b16e3.4ed0e9f08beef@odyhpc.com>
Message-ID: <c95e84f0-04c3-4533-6be5-34e07c4744e6@spatialys.com>

Hi,

The TIFF format only supports only single color table per TIFF image, 
and it only makes sense for a single-sample TIFF. An alternative would 
be for you to create multiple TIFF image file directories in the same 
file (mapped as GDAL subdatasets), with one band per subdataset, by 
using the APPEND_SUBDATASET=YES creation option.

Another option is to use the KEA format (specialization of HDF5) which 
supports all the possibilities of the GDAL abstract data model.

Even

Le 14/02/2023 ? 17:25, afernandez a ?crit?:
> Hello,
> I'm using the GDAL Tools plugin within QGIS to plot some raster 
> layers. The snippet reads:
> /? ? ? ? driver_name = 'GTIFF'/
> /? ? ? ? driver = gdal.GetDriverByName(driver_name) /
> /? ? ? ? .../
> /? ? ? ? gdal_ds = driver.Create("my_arguments") /
> /gdal_ds.SetProjection("my_projection")/
> /gdal_ds.SetGeoTransform("my_geo_transform")/
> /? ? ? ? for band_idx in range(1, times + 1):/
> /? ? ? ? ? ? band = gdal_ds.GetRasterBand(band_idx) /
> /? ? ? ? ? ? band.SetNoDataValue(no_data)/
> /band.SetDescription(time_step)/
> /? ? ? ? ? ? data = var[band_idx - 1]/
> /? ? ? ? ? ? data = ma.getdata(data)/
> /band.WriteArray(data.astype(np_dtype, copy=False))/
> /? ? ? ?gdal_ds.FlushCache()/
> This works without any problem and plots the raster in greys. However, 
> I need the plot to be colored so I modified the code based on some 
> posts, which now reads:
> /? ? ? ? gdal_ds = driver.Create(out_path, cols, rows, times, 
> gdal.GDT_UInt16) /
> /gdal_ds.SetProjection("my_projection")/
> /gdal_ds.SetGeoTransform("my_geo_transform")/
> /? ? ? ? for band_idx in range(1, times + 1):/
> /? ? ? ? ? ? band = gdal_ds.GetRasterBand(band_idx) /
> /? ? ? ? ? ? band.SetNoDataValue(no_data)/
> /band.SetDescription(time_step)/
> /? ? ? ? ? ? data = var[band_idx - 1]/
> /? ? ? ? ? ? data = ma.getdata(data)/
> /? ? ? ? ? ? data_scaled = np.interp(data, (data.min(), data.max()), 
> (0, 255))/
> /? ? ? ? ? ? data_scaled2 = data_scaled.astype(int)/
> /? ? ? ? ? ? colors = gdal.ColorTable()/
> /? ? ? ? ? ? colors.CreateColorRamp(0, (229, 245, 249), 127, (153, 
> 216, 201))/
> /? ? ? ? ? ? colors.CreateColorRamp(127, (153, 216, 201), 254, (44, 
> 162, 95))/
> /band.SetRasterColorTable(colors)/
> /band.SetRasterColorInterpretation(gdal.GCI_PaletteIndex)/
> /? ? ? ? ? ? band.WriteArray(data_scaled2)/
> /? ? ? ?gdal_ds.FlushCache()/
> The problem is that this produces a RunTimeError: SetColorTable() not 
> supported for multi-sample TIFF. I simplified this for a single band 
> and QGIS did plot the colored raster. However, this is not a solution 
> because production runs will generate dozens (or even hundreds) of 
> time step bands. I'm pretty new to GDAL so I'm unsure if this is a 
> feature under current development or if there are other alternatives 
> so any suggestion on how to proceed would be appreciated.
> Thank you in advance.
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230214/d1aaae3e/attachment.htm>

From even.rouault at spatialys.com  Tue Feb 14 09:38:56 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 14 Feb 2023 18:38:56 +0100
Subject: [gdal-dev] [Board] Travis usage of GRASS
In-Reply-To: <DA9057D1-4DA8-42A4-A11D-00537BE1A411@gmail.com>
References: <DA9057D1-4DA8-42A4-A11D-00537BE1A411@gmail.com>
Message-ID: <7cfc5be3-5e26-3add-390d-f17a0dcf5ab5@spatialys.com>

Hi,

just reacting to "We were considering cancelling OSGeo?s subscription". 
For GDAL, our current use of Travis-CI is to test portability on the 
Graviton2 ARM64 and s390x big-endian platforms (we use github CI for x64 
Linux/Win/Mac). For Graviton2, this is more the ARM64 side of things 
than the Graviton2 specific one, as ARM64 is the architecture of recent 
Apple hardware and there's no corresponding workers for github CI (not 
sure if there free CI solutions that can be integrated with github and 
offer ARM64 support?). s390x/big-endian use cases have probably little 
market relevance nowadays.

Even

Le 14/02/2023 ? 18:26, Michael Smith via Board a ?crit?:
>
> After not seeing any builds for a while in Travis from Grass, I just 
> saw one recently.
>
> We were considering cancelling OSGeo?s subscription but if this is 
> something GRASS is actively using/depending on, we can maintain. We 
> might scale back the subscription if its only lightly used those. I 
> have to renew on Feb 19 so if you could let me know before then.
>
> Thanks,
>
> Mike
>
> -
>
> Michael Smith
>
> OSGeo Treasurer
>
>
> _______________________________________________
> Board mailing list
> Board at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/board

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230214/dc8a065c/attachment.htm>

From afernandez at odyhpc.com  Tue Feb 14 09:46:20 2023
From: afernandez at odyhpc.com (afernandez)
Date: Tue, 14 Feb 2023 17:46:20 +0000
Subject: [gdal-dev] Issues with SetColorTable() and multi-sample TIFF
References: <cf35d819b16e3.4ed0e9f08beef@odyhpc.com>
 <c95e84f0-04c3-4533-6be5-34e07c4744e6@spatialys.com>
Message-ID: <abe1081ad06a8.9a366de92553e@odyhpc.com>

Hello Even,
Thank you for the quick reply. I'll try using GDAL subdatasets later this afternoon (although I'm not sure if this solution would become a bit messy for hundreds of files). The format KEA is completely new to me. I was able to install KEALib but found only one source of information online (https://gdal.org/drivers/raster/kea.html). To start somewhere, I simply modified the first 2 lines of the script to:
driver_name = 'KEA'
driver = gdal.GetDriverByName(driver_name)
However, it doesn't pick it up (driver returns 'None'). Ideally there would be some example that I could follow but I might have to do this piecewise in the meantime. 
Even Rouault wrote:
Hi,
The TIFF format only supports only single color table per TIFF image, and it only makes sense for a single-sample TIFF. An alternative would be for you to create multiple TIFF image file directories in the same file (mapped as GDAL subdatasets), with one band per subdataset, by using the APPEND_SUBDATASET=YES creation option.
Another option is to use the KEA format (specialization of HDF5) which supports all the possibilities of the GDAL abstract data model.
Even
Le 14/02/2023 ? 17:25, afernandez a ?crit :
Hello,
I'm using the GDAL Tools plugin within QGIS to plot some raster layers. The snippet reads:
driver_name = 'GTIFF'
driver = gdal.GetDriverByName(driver_name) 
...
gdal_ds = driver.Create("my_arguments") 
gdal_ds.SetProjection("my_projection")
gdal_ds.SetGeoTransform("my_geo_transform")
for band_idx in range(1, times + 1):
band = gdal_ds.GetRasterBand(band_idx) 
band.SetNoDataValue(no_data)
band.SetDescription(time_step)
data = var[band_idx - 1]
data = ma.getdata(data)
band.WriteArray(data.astype(np_dtype, copy=False))
gdal_ds.FlushCache()
This works without any problem and plots the raster in greys. However, I need the plot to be colored so I modified the code based on some posts, which now reads: 
gdal_ds = driver.Create(out_path, cols, rows, times, gdal.GDT_UInt16) 
gdal_ds.SetProjection("my_projection")
gdal_ds.SetGeoTransform("my_geo_transform")
for band_idx in range(1, times + 1):
band = gdal_ds.GetRasterBand(band_idx) 
band.SetNoDataValue(no_data)
band.SetDescription(time_step)
data = var[band_idx - 1]
data = ma.getdata(data)
data_scaled = np.interp(data, (data.min(), data.max()), (0, 255))
data_scaled2 = data_scaled.astype(int)
colors = gdal.ColorTable()
colors.CreateColorRamp(0, (229, 245, 249), 127, (153, 216, 201))
colors.CreateColorRamp(127, (153, 216, 201), 254, (44, 162, 95))
band.SetRasterColorTable(colors)
band.SetRasterColorInterpretation(gdal.GCI_PaletteIndex)
band.WriteArray(data_scaled2)
gdal_ds.FlushCache()
The problem is that this produces a RunTimeError: SetColorTable() not supported for multi-sample TIFF. I simplified this for a single band and QGIS did plot the colored raster. However, this is not a solution because production runs will generate dozens (or even hundreds) of time step bands. I'm pretty new to GDAL so I'm unsure if this is a feature under current development or if there are other alternatives so any suggestion on how to proceed would be appreciated.
Thank you in advance.
_______________________________________________ gdal-dev mailing list gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org> https://lists.osgeo.org/mailman/listinfo/gdal-dev <https://lists.osgeo.org/mailman/listinfo/gdal-dev> -- http://www.spatialys.com <http://www.spatialys.com> My software is free, but my time generally not. 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230214/10928f6e/attachment-0001.htm>

From michael.smith.erdc at gmail.com  Tue Feb 14 09:50:05 2023
From: michael.smith.erdc at gmail.com (Michael Smith)
Date: Tue, 14 Feb 2023 10:50:05 -0700
Subject: [gdal-dev] [Board] Travis usage of GRASS
In-Reply-To: <7cfc5be3-5e26-3add-390d-f17a0dcf5ab5@spatialys.com>
References: <DA9057D1-4DA8-42A4-A11D-00537BE1A411@gmail.com>
 <7cfc5be3-5e26-3add-390d-f17a0dcf5ab5@spatialys.com>
Message-ID: <7EFA0723-4255-49FF-8D51-C194011F9CD4@gmail.com>

Even,

If its actively being used, that?s fine. Was just re-evaluating after talking with Howard. Could we drop the concurrency down without impacting GDAL, GRASS and other projects?
And looks like I got the renewal dates swapped with mapserver. The OSGeo plan doesn?t renew until June. Right now we are on the:

Premium plan 10 concurrent jobs with 30% discount. 

So if we do need to maintain, could we drop to 5 or 2 concurrent builds?


- 
Michael Smith 
OSGeo Treasurer 



From: Even Rouault <even.rouault at spatialys.com>
Date: Tuesday, February 14, 2023 at 10:38 AM
To: Michael Smith <michael.smith.erdc at gmail.com>, <wenzeslaus at gmail.com>, Markus Neteler <neteler at osgeo.org>, Veronica Andreo <veroandreo at gmail.com>
Cc: <board at lists.osgeo.org>, "gdal-dev at lists.osgeo.org" <gdal-dev at lists.osgeo.org>
Subject: Re: [Board] Travis usage of GRASS

Hi,
just reacting to "We were considering cancelling OSGeo?s subscription". For GDAL, our current use of Travis-CI is to test portability on the Graviton2 ARM64 and s390x big-endian platforms (we use github CI for x64 Linux/Win/Mac). For Graviton2, this is more the ARM64 side of things than the Graviton2 specific one, as ARM64 is the architecture of recent Apple hardware and there's no corresponding workers for github CI (not sure if there free CI solutions that can be integrated with github and offer ARM64 support?). s390x/big-endian use cases have probably little market relevance nowadays.
Even
Le 14/02/2023 ? 18:26, Michael Smith via Board a ?crit?:
After not seeing any builds for a while in Travis from Grass, I just saw one recently. 
?
We were considering cancelling OSGeo?s subscription but if this is something GRASS is actively using/depending on, we can maintain. We might scale back the subscription if its only lightly used those. I have to renew on Feb 19 so if you could let me know before then.
?
Thanks,
?
Mike
?
?
-
Michael Smith
OSGeo Treasurer
?
?
?


_______________________________________________
Board mailing list
mailto:Board at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/board
-- 
http://www.spatialys.com
My software is free, but my time generally not.



From alansnow21 at gmail.com  Tue Feb 14 09:52:07 2023
From: alansnow21 at gmail.com (Alan Snow)
Date: Tue, 14 Feb 2023 11:52:07 -0600
Subject: [gdal-dev] [Board] Travis usage of GRASS
In-Reply-To: <7EFA0723-4255-49FF-8D51-C194011F9CD4@gmail.com>
References: <DA9057D1-4DA8-42A4-A11D-00537BE1A411@gmail.com>
 <7cfc5be3-5e26-3add-390d-f17a0dcf5ab5@spatialys.com>
 <7EFA0723-4255-49FF-8D51-C194011F9CD4@gmail.com>
Message-ID: <CAGybdFR3+bO=GQ9LFv_S3T3Kze5n4Rm7j7_fMou0CcbgeWWTBw@mail.gmail.com>

Pyproj uses Cirrus CI for osx arm64. It is currently free.

On Tue, Feb 14, 2023, 11:50 AM Michael Smith <michael.smith.erdc at gmail.com>
wrote:

> Even,
>
> If its actively being used, that?s fine. Was just re-evaluating after
> talking with Howard. Could we drop the concurrency down without impacting
> GDAL, GRASS and other projects?
> And looks like I got the renewal dates swapped with mapserver. The OSGeo
> plan doesn?t renew until June. Right now we are on the:
>
> Premium plan 10 concurrent jobs with 30% discount.
>
> So if we do need to maintain, could we drop to 5 or 2 concurrent builds?
>
>
> -
> Michael Smith
> OSGeo Treasurer
>
>
>
> From: Even Rouault <even.rouault at spatialys.com>
> Date: Tuesday, February 14, 2023 at 10:38 AM
> To: Michael Smith <michael.smith.erdc at gmail.com>, <wenzeslaus at gmail.com>,
> Markus Neteler <neteler at osgeo.org>, Veronica Andreo <veroandreo at gmail.com>
> Cc: <board at lists.osgeo.org>, "gdal-dev at lists.osgeo.org" <
> gdal-dev at lists.osgeo.org>
> Subject: Re: [Board] Travis usage of GRASS
>
> Hi,
> just reacting to "We were considering cancelling OSGeo?s subscription".
> For GDAL, our current use of Travis-CI is to test portability on the
> Graviton2 ARM64 and s390x big-endian platforms (we use github CI for x64
> Linux/Win/Mac). For Graviton2, this is more the ARM64 side of things than
> the Graviton2 specific one, as ARM64 is the architecture of recent Apple
> hardware and there's no corresponding workers for github CI (not sure if
> there free CI solutions that can be integrated with github and offer ARM64
> support?). s390x/big-endian use cases have probably little market relevance
> nowadays.
> Even
> Le 14/02/2023 ? 18:26, Michael Smith via Board a ?crit :
> After not seeing any builds for a while in Travis from Grass, I just saw
> one recently.
>
> We were considering cancelling OSGeo?s subscription but if this is
> something GRASS is actively using/depending on, we can maintain. We might
> scale back the subscription if its only lightly used those. I have to renew
> on Feb 19 so if you could let me know before then.
>
> Thanks,
>
> Mike
>
>
> -
> Michael Smith
> OSGeo Treasurer
>
>
>
>
>
> _______________________________________________
> Board mailing list
> mailto:Board at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/board
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230214/8f193094/attachment.htm>

From even.rouault at spatialys.com  Tue Feb 14 09:59:06 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 14 Feb 2023 18:59:06 +0100
Subject: [gdal-dev] Issues with SetColorTable() and multi-sample TIFF
In-Reply-To: <abe1081ad06a8.9a366de92553e@odyhpc.com>
References: <cf35d819b16e3.4ed0e9f08beef@odyhpc.com>
 <c95e84f0-04c3-4533-6be5-34e07c4744e6@spatialys.com>
 <abe1081ad06a8.9a366de92553e@odyhpc.com>
Message-ID: <c085d0c2-f103-3db8-519a-0d8dae0676f3@spatialys.com>


Le 14/02/2023 ? 18:46, afernandez a ?crit?:
> Hello Even,
> Thank you for the quick reply. I'll try using GDAL subdatasets later 
> this afternoon (although I'm not sure if this solution would become a 
> bit messy for hundreds of files). The format KEA is completely new to 
> me. I was able to install KEALib but found only one source of 
> information online (https://gdal.org/drivers/raster/kea.html). To 
> start somewhere, I simply modified the first 2 lines of the script to:
> ? ? ? ? driver_name = 'KEA'
> ? ? ? ? driver = gdal.GetDriverByName(driver_name)
> However, it doesn't pick it up (driver returns 'None'). Ideally there 
> would be some example that I could follow but I might have to do this 
> piecewise in the meantime.

You need to tune your build so it finds KEALib. See 
https://gdal.org/development/building_from_source.html#kea for related 
CMake options. "grep GDAL_USE_KEACMakeCache.txt" should report ON if 
things are proprerly configured. Once the driver is available in your 
GDAL build, just changing the name of the driver should be sufficient

See also 
https://github.com/OSGeo/gdal/blob/master/.github/workflows/ubuntu_20.04/build-deps.sh#L30 
for an example of a CI configuration that builds with libkea support 
(not much to do if you install it in a standard location looked for by 
cmake)

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230214/7b2f0335/attachment.htm>

From stenger at lat-lon.de  Tue Feb 14 10:00:23 2023
From: stenger at lat-lon.de (Dirk Stenger)
Date: Tue, 14 Feb 2023 19:00:23 +0100
Subject: [gdal-dev] Error when trying to build Docker Images
Message-ID: <debb10fa-a080-61bf-a974-45062b0b08d8@lat-lon.de>

All,

Unfortunately, when trying to build the GDAL Docker Image on a local 
machine (Ubuntu 22.04), the build fails with an error:

Executed commands and logging:

~/git/gdal/docker/ubuntu-small$ ./build.sh
...
debconf: delayingpackage  configuration, since apt-utils is not installed
Fetched 70.5 MB in 39s (1795 kB/s)
Selecting previously unselectedpackage  libpython3.10-minimal:arm64.
(Reading database ... 19054 files and directories currently installed.)
Preparing to unpack .../libpython3.10-minimal_3.10.6-1~22.04.2_arm64.deb ...
Unpacking libpython3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
Selecting previously unselectedpackage  libexpat1:arm64.
Preparing to unpack .../libexpat1_2.4.7-1ubuntu0.2_arm64.deb ...
Unpacking libexpat1:arm64 (2.4.7-1ubuntu0.2) ...
Selecting previously unselectedpackage  python3.10-minimal:arm64.
Preparing to unpack .../python3.10-minimal_3.10.6-1~22.04.2_arm64.deb ...
Unpacking python3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
Setting up libpython3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
Setting up libexpat1:arm64 (2.4.7-1ubuntu0.2) ...
Setting up python3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
/var/lib/dpkg/info/python3.10-minimal.postinst: 51: /usr/bin/python3.10: Exec format error
dpkg: error processingpackage  python3.10-minimal:arm64 (--configure):
 ?installed python3.10-minimal:arm64package  post-installation script subprocess returned error exit status 126
Errors were encounteredwhile  processing:
 ?python3.10-minimal:arm64
E: Sub-process /usr/bin/dpkg returned an error code (1)
The command'/bin/sh -c . /buildscripts/bh-set-envvars.sh ? ? && apt-get update -y ? 
 ? && DEBIAN_FRONTEND=noninteractive apt-get install -y --fix-missing 
--no-install-recommends ? ? ? ?python3-dev${APT_ARCH_SUFFIX} 
python3-numpy${APT_ARCH_SUFFIX} python3-setuptools${APT_ARCH_SUFFIX} ? ? 
 ? ?libjpeg-dev${APT_ARCH_SUFFIX} libgeos-dev${APT_ARCH_SUFFIX} ? ? ? 
 ?libexpat-dev${APT_ARCH_SUFFIX} libxerces-c-dev${APT_ARCH_SUFFIX} ? ? ? 
 ?libwebp-dev${APT_ARCH_SUFFIX} libpng-dev${APT_ARCH_SUFFIX} ? ? ? 
 ?libzstd-dev${APT_ARCH_SUFFIX} bash zip curl ? ? ? 
 ?libpq-dev${APT_ARCH_SUFFIX} libssl-dev${APT_ARCH_SUFFIX} 
libopenjp2-7-dev${APT_ARCH_SUFFIX} ? ? ? 
 ?libspatialite-dev${APT_ARCH_SUFFIX} ? ? ? ?autoconf automake sqlite3 
bash-completion'  returned a non-zero code: 100

The same behavior occurs with ubuntu-full:

~/git/gdal/docker/ubuntu-full$ ./build.sh
...
debconf: delayingpackage  configuration, since apt-utils is not installed
Fetched 466 MB in 3min 39s (2128 kB/s)
Selecting previously unselectedpackage  libcap2:arm64.
(Reading database ... 19051 files and directories currently installed.)
Preparing to unpack .../libcap2_1%3a2.44-1build3_arm64.deb ...
Unpacking libcap2:arm64 (1:2.44-1build3) ...
Selecting previously unselectedpackage  libgpg-error0:arm64.
Preparing to unpack .../libgpg-error0_1.43-3_arm64.deb ...
Unpacking libgpg-error0:arm64 (1.43-3) ...
Selecting previously unselectedpackage  libgcrypt20:arm64.
Preparing to unpack .../libgcrypt20_1.9.4-3ubuntu3_arm64.deb ...
Unpacking libgcrypt20:arm64 (1.9.4-3ubuntu3) ...
Selecting previously unselectedpackage  liblz4-1:arm64.
Preparing to unpack .../liblz4-1_1.9.3-2build2_arm64.deb ...
Unpacking liblz4-1:arm64 (1.9.3-2build2) ...
Setting up libcap2:arm64 (1:2.44-1build3) ...
Setting up libgpg-error0:arm64 (1.43-3) ...
Setting up libgcrypt20:arm64 (1.9.4-3ubuntu3) ...
Setting up liblz4-1:arm64 (1.9.3-2build2) ...
Selecting previously unselectedpackage  libsystemd0:arm64.
(Reading database ... 19059 files and directories currently installed.)
Preparing to unpack .../libsystemd0_249.11-0ubuntu3.6_arm64.deb ...
Unpacking libsystemd0:arm64 (249.11-0ubuntu3.6) ...
Selecting previously unselectedpackage  libpython3.10-minimal:arm64.
Preparing to unpack .../libpython3.10-minimal_3.10.6-1~22.04.2_arm64.deb ...
Unpacking libpython3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
Selecting previously unselectedpackage  libexpat1:arm64.
Preparing to unpack .../libexpat1_2.4.7-1ubuntu0.2_arm64.deb ...
Unpacking libexpat1:arm64 (2.4.7-1ubuntu0.2) ...
Selecting previously unselectedpackage  python3.10-minimal:arm64.
Preparing to unpack .../python3.10-minimal_3.10.6-1~22.04.2_arm64.deb ...
Unpacking python3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
Setting up libpython3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
Setting up libexpat1:arm64 (2.4.7-1ubuntu0.2) ...
Setting up python3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
/var/lib/dpkg/info/python3.10-minimal.postinst: 51: /usr/bin/python3.10: Exec format error
dpkg: error processingpackage  python3.10-minimal:arm64 (--configure):
 ?installed python3.10-minimal:arm64package  post-installation script subprocess returned error exit status 126
Errors were encounteredwhile  processing:
 ?python3.10-minimal:arm64
E: Sub-process /usr/bin/dpkg returned an error code (1)
The command'/bin/sh -c . /buildscripts/bh-set-envvars.sh ? ? && apt-get update -y ? 
 ? && DEBIAN_FRONTEND=noninteractive apt-get install -y --fix-missing 
--no-install-recommends ? ? ? ?libopenjp2-7-dev${APT_ARCH_SUFFIX} 
libcairo2-dev${APT_ARCH_SUFFIX} ? ? ? ?python3-dev${APT_ARCH_SUFFIX} 
python3-numpy${APT_ARCH_SUFFIX} python3-setuptools${APT_ARCH_SUFFIX} ? ? 
 ? ?libpng-dev${APT_ARCH_SUFFIX} libjpeg-dev${APT_ARCH_SUFFIX} 
libgif-dev${APT_ARCH_SUFFIX} liblzma-dev${APT_ARCH_SUFFIX} 
libgeos-dev${APT_ARCH_SUFFIX} ? ? ? ?curl libxml2-dev${APT_ARCH_SUFFIX} 
libexpat-dev${APT_ARCH_SUFFIX} libxerces-c-dev${APT_ARCH_SUFFIX} ? ? ? 
 ?libnetcdf-dev${APT_ARCH_SUFFIX} libpoppler-dev${APT_ARCH_SUFFIX} 
libpoppler-private-dev${APT_ARCH_SUFFIX} ? ? ? 
 ?libspatialite-dev${APT_ARCH_SUFFIX} 
librasterlite2-dev${APT_ARCH_SUFFIX} swig ant 
libhdf4-alt-dev${APT_ARCH_SUFFIX} libhdf5-serial-dev${APT_ARCH_SUFFIX} ? 
 ? ? ?libfreexl-dev${APT_ARCH_SUFFIX} unixodbc-dev${APT_ARCH_SUFFIX} 
 ?mdbtools-dev${APT_ARCH_SUFFIX} libwebp-dev${APT_ARCH_SUFFIX} ? ? ? 
 ?liblcms2-2 libpcre3-dev${APT_ARCH_SUFFIX} 
libcrypto++-dev${APT_ARCH_SUFFIX} libfyba-dev${APT_ARCH_SUFFIX} ? ? ? 
 ?libkml-dev${APT_ARCH_SUFFIX} libmysqlclient-dev${APT_ARCH_SUFFIX} 
libogdi-dev${APT_ARCH_SUFFIX} ? ? ? ?libcfitsio-dev${APT_ARCH_SUFFIX} 
openjdk-"$JAVA_VERSION"-jdk${APT_ARCH_SUFFIX} 
libzstd-dev${APT_ARCH_SUFFIX} ? ? ? ?libpq-dev${APT_ARCH_SUFFIX} 
libssl-dev${APT_ARCH_SUFFIX} libboost-dev${APT_ARCH_SUFFIX} ? ? ? 
 ?autoconf automake bash-completion libarmadillo-dev${APT_ARCH_SUFFIX} ? 
 ? ? ?libopenexr-dev${APT_ARCH_SUFFIX} libheif-dev${APT_ARCH_SUFFIX} ? ? 
 ? ?libdeflate-dev${APT_ARCH_SUFFIX} libblosc-dev${APT_ARCH_SUFFIX} 
liblz4-dev${APT_ARCH_SUFFIX} libbz2-dev${APT_ARCH_SUFFIX} ? ? ? 
 ?libbrotli-dev${APT_ARCH_SUFFIX} ? ? ? 
 ?libarchive-dev${APT_ARCH_SUFFIX} ? ? && rm -rf /var/lib/apt/lists/*'  returned a non-zero code: 100

This is the used Docker version:

docker --version
Docker version 20.10.17, build 100c701

I tried to build the /master/ branch and /release/3.5/ branch.

Can anyone help why the build is failing?

Kind regards,

Dirk Stenger
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230214/704e322d/attachment-0001.htm>

From lnicola at dend.ro  Tue Feb 14 10:03:01 2023
From: lnicola at dend.ro (=?UTF-8?Q?Lauren=C8=9Biu_Nicola?=)
Date: Tue, 14 Feb 2023 20:03:01 +0200
Subject: [gdal-dev] Error when trying to build Docker Images
In-Reply-To: <debb10fa-a080-61bf-a974-45062b0b08d8@lat-lon.de>
References: <debb10fa-a080-61bf-a974-45062b0b08d8@lat-lon.de>
Message-ID: <53e9c0ea-f456-4c72-b106-21a40644bae9@app.fastmail.com>

Hi,

Is that an arm64 system?

Laurentiu

On Tue, Feb 14, 2023, at 20:00, Dirk Stenger wrote:
> All,
> 
> Unfortunately, when trying to build the GDAL Docker Image on a local machine (Ubuntu 22.04), the build fails with an error:
> 
> Executed commands and logging:
> 
> ~/git/gdal/docker/ubuntu-small$ ./build.sh
> ...
> debconf: delaying package configuration, since apt-utils is not installed
> Fetched 70.5 MB in 39s (1795 kB/s)
> Selecting previously unselected package libpython3.10-minimal:arm64.
> (Reading database ... 19054 files and directories currently installed.)
> Preparing to unpack .../libpython3.10-minimal_3.10.6-1~22.04.2_arm64.deb ...
> Unpacking libpython3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
> Selecting previously unselected package libexpat1:arm64.
> Preparing to unpack .../libexpat1_2.4.7-1ubuntu0.2_arm64.deb ...
> Unpacking libexpat1:arm64 (2.4.7-1ubuntu0.2) ...
> Selecting previously unselected package python3.10-minimal:arm64.
> Preparing to unpack .../python3.10-minimal_3.10.6-1~22.04.2_arm64.deb ...
> Unpacking python3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
> Setting up libpython3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
> Setting up libexpat1:arm64 (2.4.7-1ubuntu0.2) ...
> Setting up python3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
> /var/lib/dpkg/info/python3.10-minimal.postinst: 51: /usr/bin/python3.10: Exec format error
> dpkg: error processing package python3.10-minimal:arm64 (--configure):
>  installed python3.10-minimal:arm64 package post-installation script subprocess returned error exit status 126
> Errors were encountered while processing:
>  python3.10-minimal:arm64
> E: Sub-process /usr/bin/dpkg returned an error code (1)
> The command '/bin/sh -c . /buildscripts/bh-set-envvars.sh     && apt-get update -y     && DEBIAN_FRONTEND=noninteractive apt-get install -y --fix-missing --no-install-recommends        python3-dev${APT_ARCH_SUFFIX} python3-numpy${APT_ARCH_SUFFIX} python3-setuptools${APT_ARCH_SUFFIX}        libjpeg-dev${APT_ARCH_SUFFIX} libgeos-dev${APT_ARCH_SUFFIX}        libexpat-dev${APT_ARCH_SUFFIX} libxerces-c-dev${APT_ARCH_SUFFIX}        libwebp-dev${APT_ARCH_SUFFIX} libpng-dev${APT_ARCH_SUFFIX}        libzstd-dev${APT_ARCH_SUFFIX} bash zip curl        libpq-dev${APT_ARCH_SUFFIX} libssl-dev${APT_ARCH_SUFFIX} libopenjp2-7-dev${APT_ARCH_SUFFIX}        libspatialite-dev${APT_ARCH_SUFFIX}        autoconf automake sqlite3 bash-completion' returned a non-zero code: 100
> 
> The same behavior occurs with ubuntu-full:
> 
> ~/git/gdal/docker/ubuntu-full$ ./build.sh
> ...
> debconf: delaying package configuration, since apt-utils is not installed
> Fetched 466 MB in 3min 39s (2128 kB/s)
> Selecting previously unselected package libcap2:arm64.
> (Reading database ... 19051 files and directories currently installed.)
> Preparing to unpack .../libcap2_1%3a2.44-1build3_arm64.deb ...
> Unpacking libcap2:arm64 (1:2.44-1build3) ...
> Selecting previously unselected package libgpg-error0:arm64.
> Preparing to unpack .../libgpg-error0_1.43-3_arm64.deb ...
> Unpacking libgpg-error0:arm64 (1.43-3) ...
> Selecting previously unselected package libgcrypt20:arm64.
> Preparing to unpack .../libgcrypt20_1.9.4-3ubuntu3_arm64.deb ...
> Unpacking libgcrypt20:arm64 (1.9.4-3ubuntu3) ...
> Selecting previously unselected package liblz4-1:arm64.
> Preparing to unpack .../liblz4-1_1.9.3-2build2_arm64.deb ...
> Unpacking liblz4-1:arm64 (1.9.3-2build2) ...
> Setting up libcap2:arm64 (1:2.44-1build3) ...
> Setting up libgpg-error0:arm64 (1.43-3) ...
> Setting up libgcrypt20:arm64 (1.9.4-3ubuntu3) ...
> Setting up liblz4-1:arm64 (1.9.3-2build2) ...
> Selecting previously unselected package libsystemd0:arm64.
> (Reading database ... 19059 files and directories currently installed.)
> Preparing to unpack .../libsystemd0_249.11-0ubuntu3.6_arm64.deb ...
> Unpacking libsystemd0:arm64 (249.11-0ubuntu3.6) ...
> Selecting previously unselected package libpython3.10-minimal:arm64.
> Preparing to unpack .../libpython3.10-minimal_3.10.6-1~22.04.2_arm64.deb ...
> Unpacking libpython3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
> Selecting previously unselected package libexpat1:arm64.
> Preparing to unpack .../libexpat1_2.4.7-1ubuntu0.2_arm64.deb ...
> Unpacking libexpat1:arm64 (2.4.7-1ubuntu0.2) ...
> Selecting previously unselected package python3.10-minimal:arm64.
> Preparing to unpack .../python3.10-minimal_3.10.6-1~22.04.2_arm64.deb ...
> Unpacking python3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
> Setting up libpython3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
> Setting up libexpat1:arm64 (2.4.7-1ubuntu0.2) ...
> Setting up python3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
> /var/lib/dpkg/info/python3.10-minimal.postinst: 51: /usr/bin/python3.10: Exec format error
> dpkg: error processing package python3.10-minimal:arm64 (--configure):
>  installed python3.10-minimal:arm64 package post-installation script subprocess returned error exit status 126
> Errors were encountered while processing:
>  python3.10-minimal:arm64
> E: Sub-process /usr/bin/dpkg returned an error code (1)
> The command '/bin/sh -c . /buildscripts/bh-set-envvars.sh     && apt-get update -y     && DEBIAN_FRONTEND=noninteractive apt-get install -y --fix-missing --no-install-recommends        libopenjp2-7-dev${APT_ARCH_SUFFIX} libcairo2-dev${APT_ARCH_SUFFIX}        python3-dev${APT_ARCH_SUFFIX} python3-numpy${APT_ARCH_SUFFIX} python3-setuptools${APT_ARCH_SUFFIX}        libpng-dev${APT_ARCH_SUFFIX} libjpeg-dev${APT_ARCH_SUFFIX} libgif-dev${APT_ARCH_SUFFIX} liblzma-dev${APT_ARCH_SUFFIX} libgeos-dev${APT_ARCH_SUFFIX}        curl libxml2-dev${APT_ARCH_SUFFIX} libexpat-dev${APT_ARCH_SUFFIX} libxerces-c-dev${APT_ARCH_SUFFIX}        libnetcdf-dev${APT_ARCH_SUFFIX} libpoppler-dev${APT_ARCH_SUFFIX} libpoppler-private-dev${APT_ARCH_SUFFIX}        libspatialite-dev${APT_ARCH_SUFFIX} librasterlite2-dev${APT_ARCH_SUFFIX} swig ant libhdf4-alt-dev${APT_ARCH_SUFFIX} libhdf5-serial-dev${APT_ARCH_SUFFIX}        libfreexl-dev${APT_ARCH_SUFFIX} unixodbc-dev${APT_ARCH_SUFFIX}  mdbtools-dev${APT_ARCH_SUFFIX} libwebp-dev${APT_ARCH_SUFFIX}        liblcms2-2 libpcre3-dev${APT_ARCH_SUFFIX} libcrypto++-dev${APT_ARCH_SUFFIX} libfyba-dev${APT_ARCH_SUFFIX}        libkml-dev${APT_ARCH_SUFFIX} libmysqlclient-dev${APT_ARCH_SUFFIX} libogdi-dev${APT_ARCH_SUFFIX}        libcfitsio-dev${APT_ARCH_SUFFIX} openjdk-"$JAVA_VERSION"-jdk${APT_ARCH_SUFFIX} libzstd-dev${APT_ARCH_SUFFIX}        libpq-dev${APT_ARCH_SUFFIX} libssl-dev${APT_ARCH_SUFFIX} libboost-dev${APT_ARCH_SUFFIX}        autoconf automake bash-completion libarmadillo-dev${APT_ARCH_SUFFIX}        libopenexr-dev${APT_ARCH_SUFFIX} libheif-dev${APT_ARCH_SUFFIX}        libdeflate-dev${APT_ARCH_SUFFIX} libblosc-dev${APT_ARCH_SUFFIX} liblz4-dev${APT_ARCH_SUFFIX} libbz2-dev${APT_ARCH_SUFFIX}        libbrotli-dev${APT_ARCH_SUFFIX}        libarchive-dev${APT_ARCH_SUFFIX}     && rm -rf /var/lib/apt/lists/*' returned a non-zero code: 100
> 
> This is the used Docker version:
> 
> docker --version 
> Docker version 20.10.17, build 100c701 
> 
> I tried to build the *master* branch and *release/3.5* branch.
> 
> Can anyone help why the build is failing?
> 
> Kind regards,
> 
> Dirk Stenger
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230214/5e540e98/attachment.htm>

From even.rouault at spatialys.com  Tue Feb 14 10:05:33 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 14 Feb 2023 19:05:33 +0100
Subject: [gdal-dev] [Board] Travis usage of GRASS
In-Reply-To: <7EFA0723-4255-49FF-8D51-C194011F9CD4@gmail.com>
References: <DA9057D1-4DA8-42A4-A11D-00537BE1A411@gmail.com>
 <7cfc5be3-5e26-3add-390d-f17a0dcf5ab5@spatialys.com>
 <7EFA0723-4255-49FF-8D51-C194011F9CD4@gmail.com>
Message-ID: <521419f1-a3d9-2b15-a521-81f0a0061dac@spatialys.com>

2 concurrent builds would probably be fine.

(I also see we use s390x and Graviton2 for PROJ. It is sometimes useful 
because of subtle floating point differences that pop up and make the 
regression test suite fail. Easier to catch them at the time they are 
introduced rather that after release when the maintainer of a Linux 
distro which builds for all possible architectures reports a test 
failure in one of those archs to which you don't have easy access to)

Le 14/02/2023 ? 18:50, Michael Smith a ?crit?:
> Even,
>
> If its actively being used, that?s fine. Was just re-evaluating after talking with Howard. Could we drop the concurrency down without impacting GDAL, GRASS and other projects?
> And looks like I got the renewal dates swapped with mapserver. The OSGeo plan doesn?t renew until June. Right now we are on the:
>
> Premium plan 10 concurrent jobs with 30% discount.
>
> So if we do need to maintain, could we drop to 5 or 2 concurrent builds?
>
>
> -
> Michael Smith
> OSGeo Treasurer
>
>
>
> From: Even Rouault <even.rouault at spatialys.com>
> Date: Tuesday, February 14, 2023 at 10:38 AM
> To: Michael Smith <michael.smith.erdc at gmail.com>, <wenzeslaus at gmail.com>, Markus Neteler <neteler at osgeo.org>, Veronica Andreo <veroandreo at gmail.com>
> Cc: <board at lists.osgeo.org>, "gdal-dev at lists.osgeo.org" <gdal-dev at lists.osgeo.org>
> Subject: Re: [Board] Travis usage of GRASS
>
> Hi,
> just reacting to "We were considering cancelling OSGeo?s subscription". For GDAL, our current use of Travis-CI is to test portability on the Graviton2 ARM64 and s390x big-endian platforms (we use github CI for x64 Linux/Win/Mac). For Graviton2, this is more the ARM64 side of things than the Graviton2 specific one, as ARM64 is the architecture of recent Apple hardware and there's no corresponding workers for github CI (not sure if there free CI solutions that can be integrated with github and offer ARM64 support?). s390x/big-endian use cases have probably little market relevance nowadays.
> Even
> Le 14/02/2023 ? 18:26, Michael Smith via Board a ?crit?:
> After not seeing any builds for a while in Travis from Grass, I just saw one recently.
>   
> We were considering cancelling OSGeo?s subscription but if this is something GRASS is actively using/depending on, we can maintain. We might scale back the subscription if its only lightly used those. I have to renew on Feb 19 so if you could let me know before then.
>   
> Thanks,
>   
> Mike
>   
>   
> -
> Michael Smith
> OSGeo Treasurer
>   
>   
>   
>
>
> _______________________________________________
> Board mailing list
> mailto:Board at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/board

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From tirengarfio at gmail.com  Tue Feb 14 10:11:40 2023
From: tirengarfio at gmail.com (Javier Garcia)
Date: Tue, 14 Feb 2023 19:11:40 +0100
Subject: [gdal-dev] Convert NetCDF to GeoTIFF WGS 84
Message-ID: <CABtaONRAqYU8txhSGuwgQWkquyix4vJGdHt=brC2rVEpKLjHvw@mail.gmail.com>

Hi,

I would like to convert the next NetCDF file to a GeoTIFF WGS 84.

NetCDF file `gdalinfo` output:

Driver: netCDF/Network Common Data Format
Files: /home/me/netcdf_file.nc
Size is 512, 512
Metadata:
  NC_GLOBAL#altimetry=altiCERSAT
  NC_GLOBAL#altitude_resolution=n/a
  NC_GLOBAL#area=Ireland 2 min wave grid
  NC_GLOBAL#BETAMAX=1.52
  NC_GLOBAL#CICE0=0.25
  NC_GLOBAL#CICEN=0.75
  NC_GLOBAL#comment=
  NC_GLOBAL#contact=waves at mycompany.com
  NC_GLOBAL#Conventions=CF-1.5
  NC_GLOBAL#creation_date=2017-07-27T12:20:30Z
  NC_GLOBAL#data_type=SWASH straight grid
  NC_GLOBAL#easternmost_longitude=-1.0333328
  NC_GLOBAL#easting=longitude
  NC_GLOBAL#field_type=hourly
  NC_GLOBAL#FLAGTR=4
  NC_GLOBAL#forcing_ice=iceCFSR
  NC_GLOBAL#forcing_wind=wndCFSR
  NC_GLOBAL#forecast_range=analysis
  NC_GLOBAL#forecast_type=hindcast
  NC_GLOBAL#grid=irluk-2m
  NC_GLOBAL#grid_projection=n/a
  NC_GLOBAL#history=2017-07-27T12:20:30Z : Creation
  NC_GLOBAL#institution=My Company
  NC_GLOBAL#institution_references=http://www.mycompany.com/
  NC_GLOBAL#latitude_resolution=   0.0333333
  NC_GLOBAL#longitude_resolution=   0.0333333
  NC_GLOBAL#maximum_altitude=9000 m
  NC_GLOBAL#minimum_altitude=-12000 m
  NC_GLOBAL#netcdf_version=netCDF 4.3.0
  NC_GLOBAL#northernmost_latitude=59.5000000
  NC_GLOBAL#northing=latitude
  NC_GLOBAL#product_name=ww3.irluk-2m.199501_hs.nc
  NC_GLOBAL#product_version=1.0
  NC_GLOBAL#REFCOAST=0.05
  NC_GLOBAL#references=http://www.mycompany.com/waves/
  NC_GLOBAL#REFICEBERG=0.3
  NC_GLOBAL#REFSUBGRID=0.05
  NC_GLOBAL#run_time=2017-07-27T12:20:30Z
  NC_GLOBAL#SDS4 namelist parameter WHITECAPWIDTH=0.30000001
  NC_GLOBAL#source=TWM WAVEWATCH III (R) v4.18
  NC_GLOBAL#southernmost_latitude=49.5000000
  NC_GLOBAL#start_date=1995-01-01T00:00:00Z
  NC_GLOBAL#stop_date=1995-01-31T23:00:00Z
  NC_GLOBAL#title=TWM SWASH HINDCAST
  NC_GLOBAL#WAVEWATCH_III_switches=F90 NOGRB NOPA LRB4 SHRD PR3 UQ FLX0 LN1
ST4 STAB0 NL1 BT4 DB1 MLIM TR0 BS0 IC0 REF1 XX0 WNT1 WNX1 CRT1 CRX1 O0 O1
O2 O3 O4 O5 O6 O7 011 NC4 TRKNC IS0
  NC_GLOBAL#WAVEWATCH_III_version_number=4.18b
  NC_GLOBAL#westernmost_longitude=-12.0000000
Subdatasets:
  SUBDATASET_1_NAME=NETCDF:"/home/me/netcdf_file.nc":MAPSTA
  SUBDATASET_1_DESC=[301x330] status map (16-bit integer)
  SUBDATASET_2_NAME=NETCDF:"/home/me/netcdf_file.nc":hs
  SUBDATASET_2_DESC=[744x301x330] sea_surface_wave_significant_height
(32-bit floating-point)
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0,  512.0)
Upper Right (  512.0,    0.0)
Lower Right (  512.0,  512.0)
Center      (  256.0,  256.0)


I'm expecting as output a file with WGS 84 projection like this:

`gdalinfo` output:


Driver: GTiff/GeoTIFF
Files: tiff_file.tif
Size is 4000, 4000
Coordinate System is:
PROJCRS["WGS 84 / Pseudo-Mercator",
    BASEGEOGCRS["WGS 84",
        DATUM["World Geodetic System 1984",
            ELLIPSOID["WGS 84",6378137,298.257223563,
                LENGTHUNIT["metre",1]]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["degree",0.0174532925199433]],
        ID["EPSG",4326]],
    CONVERSION["Popular Visualisation Pseudo-Mercator",
        METHOD["Popular Visualisation Pseudo Mercator",
            ID["EPSG",1024]],
        PARAMETER["Latitude of natural origin",0,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",0,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["False easting",0,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",0,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["easting (X)",east,
            ORDER[1],
            LENGTHUNIT["metre",1]],
        AXIS["northing (Y)",north,
            ORDER[2],
            LENGTHUNIT["metre",1]],
    USAGE[
        SCOPE["unknown"],
        AREA["World - 85?S to 85?N"],
        BBOX[-85.06,-180,85.06,180]],
    ID["EPSG",3857]]
Data axis to CRS axis mapping: 1,2
Origin = (-1160000.000000000000000,7799999.999999998137355)
Pixel Size = (300.000000000000000,-300.000000000000000)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  COMPRESSION=LZW
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (-1160000.000, 7800000.000) ( 10d25'13.65"W, 57d11'40.60"N)
Lower Left  (-1160000.000, 6600000.000) ( 10d25'13.65"W, 50d52'46.07"N)
Upper Right (   40000.000, 7800000.000) (  0d21'33.57"E, 57d11'40.60"N)
Lower Right (   40000.000, 6600000.000) (  0d21'33.57"E, 50d52'46.07"N)
Center      ( -560000.000, 7200000.000) (  5d 1'50.04"W, 54d 9'26.21"N)
Band 1 Block=4000x1 Type=Byte, ColorInterp=Red
  Mask Flags: PER_DATASET ALPHA
Band 2 Block=4000x1 Type=Byte, ColorInterp=Green
  Mask Flags: PER_DATASET ALPHA
Band 3 Block=4000x1 Type=Byte, ColorInterp=Blue
  Mask Flags: PER_DATASET ALPHA
Band 4 Block=4000x1 Type=Byte, ColorInterp=Alpha


Any help will be appreciated.

Javier
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230214/ecc90301/attachment-0001.htm>

From stenger at lat-lon.de  Tue Feb 14 10:13:30 2023
From: stenger at lat-lon.de (Dirk Stenger)
Date: Tue, 14 Feb 2023 19:13:30 +0100
Subject: [gdal-dev] Error when trying to build Docker Images
In-Reply-To: <debb10fa-a080-61bf-a974-45062b0b08d8@lat-lon.de>
References: <debb10fa-a080-61bf-a974-45062b0b08d8@lat-lon.de>
Message-ID: <7fa815db-0564-1283-8fa2-c4d6e670fdb4@lat-lon.de>

Hi,

No, it is an amd64 system.

Regards,

Dirk



Am 14.02.23 um 19:00 schrieb Dirk Stenger:
>
> All,
>
> Unfortunately, when trying to build the GDAL Docker Image on a local 
> machine (Ubuntu 22.04), the build fails with an error:
>
> Executed commands and logging:
>
> ~/git/gdal/docker/ubuntu-small$ ./build.sh
> ...
> debconf: delayingpackage  configuration, since apt-utils is not installed
> Fetched 70.5 MB in 39s (1795 kB/s)
> Selecting previously unselectedpackage  libpython3.10-minimal:arm64.
> (Reading database ... 19054 files and directories currently installed.)
> Preparing to unpack .../libpython3.10-minimal_3.10.6-1~22.04.2_arm64.deb ...
> Unpacking libpython3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
> Selecting previously unselectedpackage  libexpat1:arm64.
> Preparing to unpack .../libexpat1_2.4.7-1ubuntu0.2_arm64.deb ...
> Unpacking libexpat1:arm64 (2.4.7-1ubuntu0.2) ...
> Selecting previously unselectedpackage  python3.10-minimal:arm64.
> Preparing to unpack .../python3.10-minimal_3.10.6-1~22.04.2_arm64.deb ...
> Unpacking python3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
> Setting up libpython3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
> Setting up libexpat1:arm64 (2.4.7-1ubuntu0.2) ...
> Setting up python3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
> /var/lib/dpkg/info/python3.10-minimal.postinst: 51: /usr/bin/python3.10: Exec format error
> dpkg: error processingpackage  python3.10-minimal:arm64 (--configure):
>  ?installed python3.10-minimal:arm64package  post-installation script subprocess returned error exit status 126
> Errors were encounteredwhile  processing:
>  ?python3.10-minimal:arm64
> E: Sub-process /usr/bin/dpkg returned an error code (1)
> The command'/bin/sh -c . /buildscripts/bh-set-envvars.sh ? ? && apt-get update -y 
> ? ? && DEBIAN_FRONTEND=noninteractive apt-get install -y --fix-missing 
> --no-install-recommends ? ? ? ?python3-dev${APT_ARCH_SUFFIX} 
> python3-numpy${APT_ARCH_SUFFIX} python3-setuptools${APT_ARCH_SUFFIX} ? 
> ? ? ?libjpeg-dev${APT_ARCH_SUFFIX} libgeos-dev${APT_ARCH_SUFFIX} ? ? ? 
> ?libexpat-dev${APT_ARCH_SUFFIX} libxerces-c-dev${APT_ARCH_SUFFIX} ? ? 
> ? ?libwebp-dev${APT_ARCH_SUFFIX} libpng-dev${APT_ARCH_SUFFIX} ? ? ? 
> ?libzstd-dev${APT_ARCH_SUFFIX} bash zip curl ? ? ? 
> ?libpq-dev${APT_ARCH_SUFFIX} libssl-dev${APT_ARCH_SUFFIX} 
> libopenjp2-7-dev${APT_ARCH_SUFFIX} ? ? ? 
> ?libspatialite-dev${APT_ARCH_SUFFIX} ? ? ? ?autoconf automake sqlite3 
> bash-completion'  returned a non-zero code: 100
>
> The same behavior occurs with ubuntu-full:
>
> ~/git/gdal/docker/ubuntu-full$ ./build.sh
> ...
> debconf: delayingpackage  configuration, since apt-utils is not installed
> Fetched 466 MB in 3min 39s (2128 kB/s)
> Selecting previously unselectedpackage  libcap2:arm64.
> (Reading database ... 19051 files and directories currently installed.)
> Preparing to unpack .../libcap2_1%3a2.44-1build3_arm64.deb ...
> Unpacking libcap2:arm64 (1:2.44-1build3) ...
> Selecting previously unselectedpackage  libgpg-error0:arm64.
> Preparing to unpack .../libgpg-error0_1.43-3_arm64.deb ...
> Unpacking libgpg-error0:arm64 (1.43-3) ...
> Selecting previously unselectedpackage  libgcrypt20:arm64.
> Preparing to unpack .../libgcrypt20_1.9.4-3ubuntu3_arm64.deb ...
> Unpacking libgcrypt20:arm64 (1.9.4-3ubuntu3) ...
> Selecting previously unselectedpackage  liblz4-1:arm64.
> Preparing to unpack .../liblz4-1_1.9.3-2build2_arm64.deb ...
> Unpacking liblz4-1:arm64 (1.9.3-2build2) ...
> Setting up libcap2:arm64 (1:2.44-1build3) ...
> Setting up libgpg-error0:arm64 (1.43-3) ...
> Setting up libgcrypt20:arm64 (1.9.4-3ubuntu3) ...
> Setting up liblz4-1:arm64 (1.9.3-2build2) ...
> Selecting previously unselectedpackage  libsystemd0:arm64.
> (Reading database ... 19059 files and directories currently installed.)
> Preparing to unpack .../libsystemd0_249.11-0ubuntu3.6_arm64.deb ...
> Unpacking libsystemd0:arm64 (249.11-0ubuntu3.6) ...
> Selecting previously unselectedpackage  libpython3.10-minimal:arm64.
> Preparing to unpack .../libpython3.10-minimal_3.10.6-1~22.04.2_arm64.deb ...
> Unpacking libpython3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
> Selecting previously unselectedpackage  libexpat1:arm64.
> Preparing to unpack .../libexpat1_2.4.7-1ubuntu0.2_arm64.deb ...
> Unpacking libexpat1:arm64 (2.4.7-1ubuntu0.2) ...
> Selecting previously unselectedpackage  python3.10-minimal:arm64.
> Preparing to unpack .../python3.10-minimal_3.10.6-1~22.04.2_arm64.deb ...
> Unpacking python3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
> Setting up libpython3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
> Setting up libexpat1:arm64 (2.4.7-1ubuntu0.2) ...
> Setting up python3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
> /var/lib/dpkg/info/python3.10-minimal.postinst: 51: /usr/bin/python3.10: Exec format error
> dpkg: error processingpackage  python3.10-minimal:arm64 (--configure):
>  ?installed python3.10-minimal:arm64package  post-installation script subprocess returned error exit status 126
> Errors were encounteredwhile  processing:
>  ?python3.10-minimal:arm64
> E: Sub-process /usr/bin/dpkg returned an error code (1)
> The command'/bin/sh -c . /buildscripts/bh-set-envvars.sh ? ? && apt-get update -y 
> ? ? && DEBIAN_FRONTEND=noninteractive apt-get install -y --fix-missing 
> --no-install-recommends ? ? ? ?libopenjp2-7-dev${APT_ARCH_SUFFIX} 
> libcairo2-dev${APT_ARCH_SUFFIX} ? ? ? ?python3-dev${APT_ARCH_SUFFIX} 
> python3-numpy${APT_ARCH_SUFFIX} python3-setuptools${APT_ARCH_SUFFIX} ? 
> ? ? ?libpng-dev${APT_ARCH_SUFFIX} libjpeg-dev${APT_ARCH_SUFFIX} 
> libgif-dev${APT_ARCH_SUFFIX} liblzma-dev${APT_ARCH_SUFFIX} 
> libgeos-dev${APT_ARCH_SUFFIX} ? ? ? ?curl 
> libxml2-dev${APT_ARCH_SUFFIX} libexpat-dev${APT_ARCH_SUFFIX} 
> libxerces-c-dev${APT_ARCH_SUFFIX} ? ? ? 
> ?libnetcdf-dev${APT_ARCH_SUFFIX} libpoppler-dev${APT_ARCH_SUFFIX} 
> libpoppler-private-dev${APT_ARCH_SUFFIX} ? ? ? 
> ?libspatialite-dev${APT_ARCH_SUFFIX} 
> librasterlite2-dev${APT_ARCH_SUFFIX} swig ant 
> libhdf4-alt-dev${APT_ARCH_SUFFIX} libhdf5-serial-dev${APT_ARCH_SUFFIX} 
> ? ? ? ?libfreexl-dev${APT_ARCH_SUFFIX} unixodbc-dev${APT_ARCH_SUFFIX} 
> ?mdbtools-dev${APT_ARCH_SUFFIX} libwebp-dev${APT_ARCH_SUFFIX} ? ? ? 
> ?liblcms2-2 libpcre3-dev${APT_ARCH_SUFFIX} 
> libcrypto++-dev${APT_ARCH_SUFFIX} libfyba-dev${APT_ARCH_SUFFIX} ? ? ? 
> ?libkml-dev${APT_ARCH_SUFFIX} libmysqlclient-dev${APT_ARCH_SUFFIX} 
> libogdi-dev${APT_ARCH_SUFFIX} ? ? ? ?libcfitsio-dev${APT_ARCH_SUFFIX} 
> openjdk-"$JAVA_VERSION"-jdk${APT_ARCH_SUFFIX} 
> libzstd-dev${APT_ARCH_SUFFIX} ? ? ? ?libpq-dev${APT_ARCH_SUFFIX} 
> libssl-dev${APT_ARCH_SUFFIX} libboost-dev${APT_ARCH_SUFFIX} ? ? ? 
> ?autoconf automake bash-completion libarmadillo-dev${APT_ARCH_SUFFIX} 
> ? ? ? ?libopenexr-dev${APT_ARCH_SUFFIX} libheif-dev${APT_ARCH_SUFFIX} 
> ? ? ? ?libdeflate-dev${APT_ARCH_SUFFIX} libblosc-dev${APT_ARCH_SUFFIX} 
> liblz4-dev${APT_ARCH_SUFFIX} libbz2-dev${APT_ARCH_SUFFIX} ? ? ? 
> ?libbrotli-dev${APT_ARCH_SUFFIX} ? ? ? 
> ?libarchive-dev${APT_ARCH_SUFFIX} ? ? && rm -rf /var/lib/apt/lists/*'  returned a non-zero code: 100
>
> This is the used Docker version:
>
> docker --version
> Docker version 20.10.17, build 100c701
>
> I tried to build the /master/ branch and /release/3.5/ branch.
>
> Can anyone help why the build is failing?
>
> Kind regards,
>
> Dirk Stenger 

-- 
l a t / l o n  GmbH
Im Ellig 1                           53343 Wachtberg, Germany
phone ++49 +228 24 333 784
http://www.lat-lon.de                   http://www.deegree.org

lat/lon gesellschaft f?r raumbezogene informationssysteme mbH
Registergericht: Amtsgericht Bonn, HRB 13042
Gesch?ftsf?hrer: Jens Fitzke und Torsten Friebe
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230214/05c5804e/attachment.htm>

From even.rouault at spatialys.com  Tue Feb 14 10:15:10 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 14 Feb 2023 19:15:10 +0100
Subject: [gdal-dev] Error when trying to build Docker Images
In-Reply-To: <debb10fa-a080-61bf-a974-45062b0b08d8@lat-lon.de>
References: <debb10fa-a080-61bf-a974-45062b0b08d8@lat-lon.de>
Message-ID: <5b6f7e99-6f5d-772c-1f88-dbc1b148bd5e@spatialys.com>

Dual architecture amd64+arm64 builds are attempted by default (see 
https://github.com/OSGeo/gdal/tree/master/docker#multi-arch-images), 
which requires docker buildx to be setup|, or perhaps just ||binfmt to 
support arm64 through qemu|||

If you just need amd64 builds, add "--platform linux/amd64" after ./build.sh

Le 14/02/2023 ? 19:00, Dirk Stenger a ?crit?:
>
> All,
>
> Unfortunately, when trying to build the GDAL Docker Image on a local 
> machine (Ubuntu 22.04), the build fails with an error:
>
> Executed commands and logging:
>
> ~/git/gdal/docker/ubuntu-small$ ./build.sh
> ...
> debconf: delayingpackage  configuration, since apt-utils is not installed
> Fetched 70.5 MB in 39s (1795 kB/s)
> Selecting previously unselectedpackage  libpython3.10-minimal:arm64.
> (Reading database ... 19054 files and directories currently installed.)
> Preparing to unpack .../libpython3.10-minimal_3.10.6-1~22.04.2_arm64.deb ...
> Unpacking libpython3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
> Selecting previously unselectedpackage  libexpat1:arm64.
> Preparing to unpack .../libexpat1_2.4.7-1ubuntu0.2_arm64.deb ...
> Unpacking libexpat1:arm64 (2.4.7-1ubuntu0.2) ...
> Selecting previously unselectedpackage  python3.10-minimal:arm64.
> Preparing to unpack .../python3.10-minimal_3.10.6-1~22.04.2_arm64.deb ...
> Unpacking python3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
> Setting up libpython3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
> Setting up libexpat1:arm64 (2.4.7-1ubuntu0.2) ...
> Setting up python3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
> /var/lib/dpkg/info/python3.10-minimal.postinst: 51: /usr/bin/python3.10: Exec format error
> dpkg: error processingpackage  python3.10-minimal:arm64 (--configure):
>  ?installed python3.10-minimal:arm64package  post-installation script subprocess returned error exit status 126
> Errors were encounteredwhile  processing:
>  ?python3.10-minimal:arm64
> E: Sub-process /usr/bin/dpkg returned an error code (1)
> The command'/bin/sh -c . /buildscripts/bh-set-envvars.sh ? ? && apt-get update -y 
> ? ? && DEBIAN_FRONTEND=noninteractive apt-get install -y --fix-missing 
> --no-install-recommends ? ? ? ?python3-dev${APT_ARCH_SUFFIX} 
> python3-numpy${APT_ARCH_SUFFIX} python3-setuptools${APT_ARCH_SUFFIX} ? 
> ? ? ?libjpeg-dev${APT_ARCH_SUFFIX} libgeos-dev${APT_ARCH_SUFFIX} ? ? ? 
> ?libexpat-dev${APT_ARCH_SUFFIX} libxerces-c-dev${APT_ARCH_SUFFIX} ? ? 
> ? ?libwebp-dev${APT_ARCH_SUFFIX} libpng-dev${APT_ARCH_SUFFIX} ? ? ? 
> ?libzstd-dev${APT_ARCH_SUFFIX} bash zip curl ? ? ? 
> ?libpq-dev${APT_ARCH_SUFFIX} libssl-dev${APT_ARCH_SUFFIX} 
> libopenjp2-7-dev${APT_ARCH_SUFFIX} ? ? ? 
> ?libspatialite-dev${APT_ARCH_SUFFIX} ? ? ? ?autoconf automake sqlite3 
> bash-completion'  returned a non-zero code: 100
>
> The same behavior occurs with ubuntu-full:
>
> ~/git/gdal/docker/ubuntu-full$ ./build.sh
> ...
> debconf: delayingpackage  configuration, since apt-utils is not installed
> Fetched 466 MB in 3min 39s (2128 kB/s)
> Selecting previously unselectedpackage  libcap2:arm64.
> (Reading database ... 19051 files and directories currently installed.)
> Preparing to unpack .../libcap2_1%3a2.44-1build3_arm64.deb ...
> Unpacking libcap2:arm64 (1:2.44-1build3) ...
> Selecting previously unselectedpackage  libgpg-error0:arm64.
> Preparing to unpack .../libgpg-error0_1.43-3_arm64.deb ...
> Unpacking libgpg-error0:arm64 (1.43-3) ...
> Selecting previously unselectedpackage  libgcrypt20:arm64.
> Preparing to unpack .../libgcrypt20_1.9.4-3ubuntu3_arm64.deb ...
> Unpacking libgcrypt20:arm64 (1.9.4-3ubuntu3) ...
> Selecting previously unselectedpackage  liblz4-1:arm64.
> Preparing to unpack .../liblz4-1_1.9.3-2build2_arm64.deb ...
> Unpacking liblz4-1:arm64 (1.9.3-2build2) ...
> Setting up libcap2:arm64 (1:2.44-1build3) ...
> Setting up libgpg-error0:arm64 (1.43-3) ...
> Setting up libgcrypt20:arm64 (1.9.4-3ubuntu3) ...
> Setting up liblz4-1:arm64 (1.9.3-2build2) ...
> Selecting previously unselectedpackage  libsystemd0:arm64.
> (Reading database ... 19059 files and directories currently installed.)
> Preparing to unpack .../libsystemd0_249.11-0ubuntu3.6_arm64.deb ...
> Unpacking libsystemd0:arm64 (249.11-0ubuntu3.6) ...
> Selecting previously unselectedpackage  libpython3.10-minimal:arm64.
> Preparing to unpack .../libpython3.10-minimal_3.10.6-1~22.04.2_arm64.deb ...
> Unpacking libpython3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
> Selecting previously unselectedpackage  libexpat1:arm64.
> Preparing to unpack .../libexpat1_2.4.7-1ubuntu0.2_arm64.deb ...
> Unpacking libexpat1:arm64 (2.4.7-1ubuntu0.2) ...
> Selecting previously unselectedpackage  python3.10-minimal:arm64.
> Preparing to unpack .../python3.10-minimal_3.10.6-1~22.04.2_arm64.deb ...
> Unpacking python3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
> Setting up libpython3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
> Setting up libexpat1:arm64 (2.4.7-1ubuntu0.2) ...
> Setting up python3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
> /var/lib/dpkg/info/python3.10-minimal.postinst: 51: /usr/bin/python3.10: Exec format error
> dpkg: error processingpackage  python3.10-minimal:arm64 (--configure):
>  ?installed python3.10-minimal:arm64package  post-installation script subprocess returned error exit status 126
> Errors were encounteredwhile  processing:
>  ?python3.10-minimal:arm64
> E: Sub-process /usr/bin/dpkg returned an error code (1)
> The command'/bin/sh -c . /buildscripts/bh-set-envvars.sh ? ? && apt-get update -y 
> ? ? && DEBIAN_FRONTEND=noninteractive apt-get install -y --fix-missing 
> --no-install-recommends ? ? ? ?libopenjp2-7-dev${APT_ARCH_SUFFIX} 
> libcairo2-dev${APT_ARCH_SUFFIX} ? ? ? ?python3-dev${APT_ARCH_SUFFIX} 
> python3-numpy${APT_ARCH_SUFFIX} python3-setuptools${APT_ARCH_SUFFIX} ? 
> ? ? ?libpng-dev${APT_ARCH_SUFFIX} libjpeg-dev${APT_ARCH_SUFFIX} 
> libgif-dev${APT_ARCH_SUFFIX} liblzma-dev${APT_ARCH_SUFFIX} 
> libgeos-dev${APT_ARCH_SUFFIX} ? ? ? ?curl 
> libxml2-dev${APT_ARCH_SUFFIX} libexpat-dev${APT_ARCH_SUFFIX} 
> libxerces-c-dev${APT_ARCH_SUFFIX} ? ? ? 
> ?libnetcdf-dev${APT_ARCH_SUFFIX} libpoppler-dev${APT_ARCH_SUFFIX} 
> libpoppler-private-dev${APT_ARCH_SUFFIX} ? ? ? 
> ?libspatialite-dev${APT_ARCH_SUFFIX} 
> librasterlite2-dev${APT_ARCH_SUFFIX} swig ant 
> libhdf4-alt-dev${APT_ARCH_SUFFIX} libhdf5-serial-dev${APT_ARCH_SUFFIX} 
> ? ? ? ?libfreexl-dev${APT_ARCH_SUFFIX} unixodbc-dev${APT_ARCH_SUFFIX} 
> ?mdbtools-dev${APT_ARCH_SUFFIX} libwebp-dev${APT_ARCH_SUFFIX} ? ? ? 
> ?liblcms2-2 libpcre3-dev${APT_ARCH_SUFFIX} 
> libcrypto++-dev${APT_ARCH_SUFFIX} libfyba-dev${APT_ARCH_SUFFIX} ? ? ? 
> ?libkml-dev${APT_ARCH_SUFFIX} libmysqlclient-dev${APT_ARCH_SUFFIX} 
> libogdi-dev${APT_ARCH_SUFFIX} ? ? ? ?libcfitsio-dev${APT_ARCH_SUFFIX} 
> openjdk-"$JAVA_VERSION"-jdk${APT_ARCH_SUFFIX} 
> libzstd-dev${APT_ARCH_SUFFIX} ? ? ? ?libpq-dev${APT_ARCH_SUFFIX} 
> libssl-dev${APT_ARCH_SUFFIX} libboost-dev${APT_ARCH_SUFFIX} ? ? ? 
> ?autoconf automake bash-completion libarmadillo-dev${APT_ARCH_SUFFIX} 
> ? ? ? ?libopenexr-dev${APT_ARCH_SUFFIX} libheif-dev${APT_ARCH_SUFFIX} 
> ? ? ? ?libdeflate-dev${APT_ARCH_SUFFIX} libblosc-dev${APT_ARCH_SUFFIX} 
> liblz4-dev${APT_ARCH_SUFFIX} libbz2-dev${APT_ARCH_SUFFIX} ? ? ? 
> ?libbrotli-dev${APT_ARCH_SUFFIX} ? ? ? 
> ?libarchive-dev${APT_ARCH_SUFFIX} ? ? && rm -rf /var/lib/apt/lists/*'  returned a non-zero code: 100
>
> This is the used Docker version:
>
> docker --version
> Docker version 20.10.17, build 100c701
>
> I tried to build the /master/ branch and /release/3.5/ branch.
>
> Can anyone help why the build is failing?
>
> Kind regards,
>
> Dirk Stenger
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230214/14a5fe32/attachment-0001.htm>

From stenger at lat-lon.de  Tue Feb 14 14:45:15 2023
From: stenger at lat-lon.de (Dirk Stenger)
Date: Tue, 14 Feb 2023 23:45:15 +0100
Subject: [gdal-dev] Error when trying to build Docker Images
In-Reply-To: <5b6f7e99-6f5d-772c-1f88-dbc1b148bd5e@spatialys.com>
References: <debb10fa-a080-61bf-a974-45062b0b08d8@lat-lon.de>
 <5b6f7e99-6f5d-772c-1f88-dbc1b148bd5e@spatialys.com>
Message-ID: <c6e43990-f1f3-5d96-29f1-e80d11dfd472@lat-lon.de>

Thank you for the help.

Your proposed solution works for ubuntu-small.

However, when I am trying to build ubuntu-full, I get a new error:

~/git/gdal/docker$ ubuntu-full/build.sh --platform linux/amd64
...
/gdal/frmts/pdf/pdfdataset.cpp: In function'int LoadPdfiumDocumentPage(const char*, const char*, int, 
TPdfiumDocumentStruct**, TPdfiumPageStruct**, int*)':
/gdal/frmts/pdf/pdfdataset.cpp:1263:68: error: requestfor  member'Get'  in'pDict', which is of pointer type'CPDF_Dictionary*'  (maybe you meant to use'->'  ?)
 ?1263 | ? ? ? ? ? ? pdfium::WrapRetain(const_cast<CPDF_Dictionary *>(pDict.Get())));
 ? ? ? | ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?^~~
/gdal/frmts/pdf/pdfdataset.cpp: At global scope:
/gdal/frmts/pdf/pdfdataset.cpp:1453:5: error:'virtual bool GDALPDFiumOCContext::CheckOCGDictVisible(const 
CPDF_Dictionary*) const'  marked'override', but does not override
 ?1453 | ? ? CheckOCGDictVisible(const  CPDF_Dictionary *pOCGDict)const  override
 ? ? ? | ? ? ^~~~~~~~~~~~~~~~~~~
/gdal/frmts/pdf/pdfdataset.cpp: In member function'virtual bool GDALPDFiumOCContext::CheckOCGDictVisible(const 
CPDF_Dictionary*) const':
/gdal/frmts/pdf/pdfdataset.cpp:1464:36: error:'class CPDF_OCContext'  has no member named'CheckOCGDictVisible'; did you mean'CheckOCGVisible'?
 ?1464 |return  m_DefaultOCContext->CheckOCGDictVisible(pOCGDict);
 ? ? ? | ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?^~~~~~~~~~~~~~~~~~~
 ? ? ? | ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?CheckOCGVisible
/gdal/frmts/pdf/pdfdataset.cpp: At global scope:
/gdal/frmts/pdf/pdfdataset.cpp:1638:18: error:'virtual bool GDALPDFiumRenderDeviceDriver::DrawDeviceText(const 
pdfium::span<const TextCharPos>&, CFX_Font*, const CFX_Matrix&, float, 
uint32_t, const CFX_TextRenderOptions&)'  marked'override', but does not override
 ?1638 | ? ? virtual bool DrawDeviceText(const  pdfium::span<const  TextCharPos> &pCharPos,
 ? ? ? | ? ? ? ? ? ? ? ? ?^~~~~~~~~~~~~~
/gdal/frmts/pdf/pdfdataset.cpp:1638:18: warning: ? by'virtual bool GDALPDFiumRenderDeviceDriver::DrawDeviceText(const 
pdfium::span<const TextCharPos>&, CFX_Font*, const CFX_Matrix&, float, 
uint32_t, const CFX_TextRenderOptions&)'  [-Woverloaded-virtual]
/gdal/frmts/pdf/pdfdataset.cpp: In function'void myRenderPageImpl(PDFDataset*, CPDF_PageRenderContext*, CPDF_Page*, 
const CFX_Matrix&, const FX_RECT&, int, const FPDF_COLORSCHEME*, bool, 
CPDFSDK_PauseAdapter*)':
/gdal/frmts/pdf/pdfdataset.cpp:1776:38: error:'class CPDF_Page'  has no member named'GetMutablePageResources'; did you mean'GetPageResources'?
 ?1776 | ? ? ? ? pPage->GetDocument(), pPage->GetMutablePageResources(),
 ? ? ? | ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?^~~~~~~~~~~~~~~~~~~~~~~
 ? ? ? | ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?GetPageResources
/gdal/frmts/pdf/pdfdataset.cpp:1777:16: error:'class CPDF_Page'  has no member named'GetPageImageCache'
 ?1777 | ? ? ? ? pPage->GetPageImageCache());
 ? ? ? | ? ? ? ? ? ? ? ?^~~~~~~~~~~~~~~~~
/gdal/frmts/pdf/pdfdataset.cpp: Instatic  member function'static PDFDataset* PDFDataset::Open(GDALOpenInfo*)':
/gdal/frmts/pdf/pdfdataset.cpp:4831:48: error: cannot convert'CPDF_Dictionary* const'  to'fxcrt::RetainPtr<const CPDF_Object>'
 ?4831 | ? ? ? ? poPageObj = GDALPDFObjectPdfium::Build(pageObj);
 ? ? ? | ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?^~~~~~~
 ? ? ? | ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?|
 ? ? ? | ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?CPDF_Dictionary*const
In file included from /gdal/frmts/pdf/gdal_pdf.h:60,
 ? ? ? ? ? ? ? ? ?from /gdal/frmts/pdf/pdfdataset.cpp:36:
/gdal/frmts/pdf/pdfobject.h:442:68: note: ? initializing argument 1 of'static GDALPDFObjectPdfium* 
GDALPDFObjectPdfium::Build(fxcrt::RetainPtr<const CPDF_Object>)'
 ? 442 |static  GDALPDFObjectPdfium *Build(RetainPtr<const  CPDF_Object> obj);
 ? ? ? | ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~
/gdal/frmts/pdf/pdfdataset.cpp:5424:65: error: cannot convert'CPDF_Dictionary*'  to'fxcrt::RetainPtr<const CPDF_Object>'
 ?5424 | ? ? ? ? ? ? GDALPDFObjectPdfium::Build(poDocPdfium->doc->GetInfo());
 ? ? ? | ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?~~~~~~~~~~~~~~~~~~~~~~~~~^~
 ? ? ? | ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? |
 ? ? ? | ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? CPDF_Dictionary*
In file included from /gdal/frmts/pdf/gdal_pdf.h:60,
 ? ? ? ? ? ? ? ? ?from /gdal/frmts/pdf/pdfdataset.cpp:36:
/gdal/frmts/pdf/pdfobject.h:442:68: note: ? initializing argument 1 of'static GDALPDFObjectPdfium* 
GDALPDFObjectPdfium::Build(fxcrt::RetainPtr<const CPDF_Object>)'
 ? 442 |static  GDALPDFObjectPdfium *Build(RetainPtr<const  CPDF_Object> obj);
 ? ? ? | ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~
In file included from /usr/include/pdfium/core/fxcrt/bytestring.h:21,
 ? ? ? ? ? ? ? ? ?from /usr/include/pdfium/core/fxcrt/fx_string.h:14,
 ? ? ? ? ? ? ? ? ?from /usr/include/pdfium/core/fpdfapi/parser/cpdf_object.h:15,
 ? ? ? ? ? ? ? ? ?from /usr/include/pdfium/core/fpdfapi/parser/cpdf_dictionary.h:15,
 ? ? ? ? ? ? ? ? ?from /usr/include/pdfium/core/fpdfapi/page/cpdf_pageobjectholder.h:20,
 ? ? ? ? ? ? ? ? ?from /usr/include/pdfium/core/fpdfapi/page/cpdf_page.h:13,
 ? ? ? ? ? ? ? ? ?from /gdal/frmts/pdf/pdfsdk_headers.h:131,
 ? ? ? ? ? ? ? ? ?from /gdal/frmts/pdf/gdal_pdf.h:54,
 ? ? ? ? ? ? ? ? ?from /gdal/frmts/pdf/pdfdataset.cpp:36:
/usr/include/pdfium/core/fxcrt/retain_ptr.h: In instantiation of'fxcrt::RetainPtr<T> pdfium::MakeRetain(Args&& ...) [with T = 
GDALPDFiumOCContext; Args = {PDFDataset*&, CPDF_Document*, const 
CPDF_OCContext::UsageType&}]':
/gdal/frmts/pdf/pdfdataset.cpp:1770:42: ? required from here
/usr/include/pdfium/core/fxcrt/retain_ptr.h:164:23: error: invalidnew-expression ofabstract  class type'GDALPDFiumOCContext'
 ? 164 |return  RetainPtr<T>(new  T(std::forward<Args>(args)...));
 ? ? ? | ? ? ? ? ? ? ? ? ? ? ? ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/gdal/frmts/pdf/pdfdataset.cpp:1439:7: note: ? because the following virtual functions are pure within'GDALPDFiumOCContext':
 ?1439 |class GDALPDFiumOCContext :public  CPDF_OCContextInterface
 ? ? ? | ? ? ? ^~~~~~~~~~~~~~~~~~~
In file included from /gdal/frmts/pdf/pdfsdk_headers.h:132,
 ? ? ? ? ? ? ? ? ?from /gdal/frmts/pdf/gdal_pdf.h:54,
 ? ? ? ? ? ? ? ? ?from /gdal/frmts/pdf/pdfdataset.cpp:36:
/usr/include/pdfium/core/fpdfapi/page/cpdf_occontext.h:24:16: note:'virtual bool CPDF_OCContextInterface::CheckOCGVisible(const 
CPDF_Dictionary*) const'
 ? ?24 | ? virtual bool CheckOCGVisible(const  CPDF_Dictionary* pOCGDict)const  = 0;
 ? ? ? | ? ? ? ? ? ? ? ?^~~~~~~~~~~~~~~
make[2]: *** [frmts/pdf/CMakeFiles/gdal_PDF.dir/build.make:89: frmts/pdf/CMakeFiles/gdal_PDF.dir/pdfdataset.cpp.o] Error 1
make[2]: *** Waitingfor  unfinished jobs....
...
make[1]: *** [CMakeFiles/Makefile2:8549: frmts/pdf/CMakeFiles/gdal_PDF.dir/all] Error 2
make[1]: *** Waitingfor  unfinished jobs....
...
make: *** [Makefile:141: all] Error 2
The command'/bin/sh -c . /buildscripts/bh-set-envvars.sh ? ? && 
/buildscripts/bh-gdal.sh'  returned a non-zero code: 2




Am 14.02.23 um 19:15 schrieb Even Rouault:
>
> Dual architecture amd64+arm64 builds are attempted by default (see 
> https://github.com/OSGeo/gdal/tree/master/docker#multi-arch-images), 
> which requires docker buildx to be setup|, or perhaps just ||binfmt to 
> support arm64 through qemu|||
>
> If you just need amd64 builds, add "--platform linux/amd64" after 
> ./build.sh
>
> Le 14/02/2023 ? 19:00, Dirk Stenger a ?crit?:
>>
>> All,
>>
>> Unfortunately, when trying to build the GDAL Docker Image on a local 
>> machine (Ubuntu 22.04), the build fails with an error:
>>
>> Executed commands and logging:
>>
>> ~/git/gdal/docker/ubuntu-small$ ./build.sh
>> ...
>> debconf: delayingpackage  configuration, since apt-utils is not installed
>> Fetched 70.5 MB in 39s (1795 kB/s)
>> Selecting previously unselectedpackage  libpython3.10-minimal:arm64.
>> (Reading database ... 19054 files and directories currently installed.)
>> Preparing to unpack .../libpython3.10-minimal_3.10.6-1~22.04.2_arm64.deb ...
>> Unpacking libpython3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
>> Selecting previously unselectedpackage  libexpat1:arm64.
>> Preparing to unpack .../libexpat1_2.4.7-1ubuntu0.2_arm64.deb ...
>> Unpacking libexpat1:arm64 (2.4.7-1ubuntu0.2) ...
>> Selecting previously unselectedpackage  python3.10-minimal:arm64.
>> Preparing to unpack .../python3.10-minimal_3.10.6-1~22.04.2_arm64.deb ...
>> Unpacking python3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
>> Setting up libpython3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
>> Setting up libexpat1:arm64 (2.4.7-1ubuntu0.2) ...
>> Setting up python3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
>> /var/lib/dpkg/info/python3.10-minimal.postinst: 51: /usr/bin/python3.10: Exec format error
>> dpkg: error processingpackage  python3.10-minimal:arm64 (--configure):
>>  ?installed python3.10-minimal:arm64package  post-installation script subprocess returned error exit status 126
>> Errors were encounteredwhile  processing:
>>  ?python3.10-minimal:arm64
>> E: Sub-process /usr/bin/dpkg returned an error code (1)
>> The command'/bin/sh -c . /buildscripts/bh-set-envvars.sh ? ? && apt-get update 
>> -y ? ? && DEBIAN_FRONTEND=noninteractive apt-get install -y 
>> --fix-missing --no-install-recommends ? ? ? 
>> ?python3-dev${APT_ARCH_SUFFIX} python3-numpy${APT_ARCH_SUFFIX} 
>> python3-setuptools${APT_ARCH_SUFFIX} ? ? ? 
>> ?libjpeg-dev${APT_ARCH_SUFFIX} libgeos-dev${APT_ARCH_SUFFIX} ? ? ? 
>> ?libexpat-dev${APT_ARCH_SUFFIX} libxerces-c-dev${APT_ARCH_SUFFIX} ? ? 
>> ? ?libwebp-dev${APT_ARCH_SUFFIX} libpng-dev${APT_ARCH_SUFFIX} ? ? ? 
>> ?libzstd-dev${APT_ARCH_SUFFIX} bash zip curl ? ? ? 
>> ?libpq-dev${APT_ARCH_SUFFIX} libssl-dev${APT_ARCH_SUFFIX} 
>> libopenjp2-7-dev${APT_ARCH_SUFFIX} ? ? ? 
>> ?libspatialite-dev${APT_ARCH_SUFFIX} ? ? ? ?autoconf automake sqlite3 
>> bash-completion'  returned a non-zero code: 100
>>
>> The same behavior occurs with ubuntu-full:
>>
>> ~/git/gdal/docker/ubuntu-full$ ./build.sh
>> ...
>> debconf: delayingpackage  configuration, since apt-utils is not installed
>> Fetched 466 MB in 3min 39s (2128 kB/s)
>> Selecting previously unselectedpackage  libcap2:arm64.
>> (Reading database ... 19051 files and directories currently installed.)
>> Preparing to unpack .../libcap2_1%3a2.44-1build3_arm64.deb ...
>> Unpacking libcap2:arm64 (1:2.44-1build3) ...
>> Selecting previously unselectedpackage  libgpg-error0:arm64.
>> Preparing to unpack .../libgpg-error0_1.43-3_arm64.deb ...
>> Unpacking libgpg-error0:arm64 (1.43-3) ...
>> Selecting previously unselectedpackage  libgcrypt20:arm64.
>> Preparing to unpack .../libgcrypt20_1.9.4-3ubuntu3_arm64.deb ...
>> Unpacking libgcrypt20:arm64 (1.9.4-3ubuntu3) ...
>> Selecting previously unselectedpackage  liblz4-1:arm64.
>> Preparing to unpack .../liblz4-1_1.9.3-2build2_arm64.deb ...
>> Unpacking liblz4-1:arm64 (1.9.3-2build2) ...
>> Setting up libcap2:arm64 (1:2.44-1build3) ...
>> Setting up libgpg-error0:arm64 (1.43-3) ...
>> Setting up libgcrypt20:arm64 (1.9.4-3ubuntu3) ...
>> Setting up liblz4-1:arm64 (1.9.3-2build2) ...
>> Selecting previously unselectedpackage  libsystemd0:arm64.
>> (Reading database ... 19059 files and directories currently installed.)
>> Preparing to unpack .../libsystemd0_249.11-0ubuntu3.6_arm64.deb ...
>> Unpacking libsystemd0:arm64 (249.11-0ubuntu3.6) ...
>> Selecting previously unselectedpackage  libpython3.10-minimal:arm64.
>> Preparing to unpack .../libpython3.10-minimal_3.10.6-1~22.04.2_arm64.deb ...
>> Unpacking libpython3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
>> Selecting previously unselectedpackage  libexpat1:arm64.
>> Preparing to unpack .../libexpat1_2.4.7-1ubuntu0.2_arm64.deb ...
>> Unpacking libexpat1:arm64 (2.4.7-1ubuntu0.2) ...
>> Selecting previously unselectedpackage  python3.10-minimal:arm64.
>> Preparing to unpack .../python3.10-minimal_3.10.6-1~22.04.2_arm64.deb ...
>> Unpacking python3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
>> Setting up libpython3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
>> Setting up libexpat1:arm64 (2.4.7-1ubuntu0.2) ...
>> Setting up python3.10-minimal:arm64 (3.10.6-1~22.04.2) ...
>> /var/lib/dpkg/info/python3.10-minimal.postinst: 51: /usr/bin/python3.10: Exec format error
>> dpkg: error processingpackage  python3.10-minimal:arm64 (--configure):
>>  ?installed python3.10-minimal:arm64package  post-installation script subprocess returned error exit status 126
>> Errors were encounteredwhile  processing:
>>  ?python3.10-minimal:arm64
>> E: Sub-process /usr/bin/dpkg returned an error code (1)
>> The command'/bin/sh -c . /buildscripts/bh-set-envvars.sh ? ? && apt-get update 
>> -y ? ? && DEBIAN_FRONTEND=noninteractive apt-get install -y 
>> --fix-missing --no-install-recommends ? ? ? 
>> ?libopenjp2-7-dev${APT_ARCH_SUFFIX} libcairo2-dev${APT_ARCH_SUFFIX} ? 
>> ? ? ?python3-dev${APT_ARCH_SUFFIX} python3-numpy${APT_ARCH_SUFFIX} 
>> python3-setuptools${APT_ARCH_SUFFIX} ? ? ? 
>> ?libpng-dev${APT_ARCH_SUFFIX} libjpeg-dev${APT_ARCH_SUFFIX} 
>> libgif-dev${APT_ARCH_SUFFIX} liblzma-dev${APT_ARCH_SUFFIX} 
>> libgeos-dev${APT_ARCH_SUFFIX} ? ? ? ?curl 
>> libxml2-dev${APT_ARCH_SUFFIX} libexpat-dev${APT_ARCH_SUFFIX} 
>> libxerces-c-dev${APT_ARCH_SUFFIX} ? ? ? 
>> ?libnetcdf-dev${APT_ARCH_SUFFIX} libpoppler-dev${APT_ARCH_SUFFIX} 
>> libpoppler-private-dev${APT_ARCH_SUFFIX} ? ? ? 
>> ?libspatialite-dev${APT_ARCH_SUFFIX} 
>> librasterlite2-dev${APT_ARCH_SUFFIX} swig ant 
>> libhdf4-alt-dev${APT_ARCH_SUFFIX} 
>> libhdf5-serial-dev${APT_ARCH_SUFFIX} ? ? ? 
>> ?libfreexl-dev${APT_ARCH_SUFFIX} unixodbc-dev${APT_ARCH_SUFFIX} 
>> ?mdbtools-dev${APT_ARCH_SUFFIX} libwebp-dev${APT_ARCH_SUFFIX} ? ? ? 
>> ?liblcms2-2 libpcre3-dev${APT_ARCH_SUFFIX} 
>> libcrypto++-dev${APT_ARCH_SUFFIX} libfyba-dev${APT_ARCH_SUFFIX} ? ? ? 
>> ?libkml-dev${APT_ARCH_SUFFIX} libmysqlclient-dev${APT_ARCH_SUFFIX} 
>> libogdi-dev${APT_ARCH_SUFFIX} ? ? ? ?libcfitsio-dev${APT_ARCH_SUFFIX} 
>> openjdk-"$JAVA_VERSION"-jdk${APT_ARCH_SUFFIX} 
>> libzstd-dev${APT_ARCH_SUFFIX} ? ? ? ?libpq-dev${APT_ARCH_SUFFIX} 
>> libssl-dev${APT_ARCH_SUFFIX} libboost-dev${APT_ARCH_SUFFIX} ? ? ? 
>> ?autoconf automake bash-completion libarmadillo-dev${APT_ARCH_SUFFIX} 
>> ? ? ? ?libopenexr-dev${APT_ARCH_SUFFIX} libheif-dev${APT_ARCH_SUFFIX} 
>> ? ? ? ?libdeflate-dev${APT_ARCH_SUFFIX} 
>> libblosc-dev${APT_ARCH_SUFFIX} liblz4-dev${APT_ARCH_SUFFIX} 
>> libbz2-dev${APT_ARCH_SUFFIX} ? ? ? ?libbrotli-dev${APT_ARCH_SUFFIX} ? 
>> ? ? ?libarchive-dev${APT_ARCH_SUFFIX} ? ? && rm -rf /var/lib/apt/lists/*'  returned a non-zero code: 100
>>
>> This is the used Docker version:
>>
>> docker --version
>> Docker version 20.10.17, build 100c701
>>
>> I tried to build the /master/ branch and /release/3.5/ branch.
>>
>> Can anyone help why the build is failing?
>>
>> Kind regards,
>>
>> Dirk Stenger
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> -- 
> http://www.spatialys.com
> My software is free, but my time generally not.

-- 
l a t / l o n  GmbH
Im Ellig 1                           53343 Wachtberg, Germany
phone ++49 +228 24 333 784
http://www.lat-lon.de                   http://www.deegree.org

lat/lon gesellschaft f?r raumbezogene informationssysteme mbH
Registergericht: Amtsgericht Bonn, HRB 13042
Gesch?ftsf?hrer: Jens Fitzke und Torsten Friebe
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230214/9da227ca/attachment-0001.htm>

From even.rouault at spatialys.com  Tue Feb 14 14:53:30 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 14 Feb 2023 23:53:30 +0100
Subject: [gdal-dev] Error when trying to build Docker Images
In-Reply-To: <c6e43990-f1f3-5d96-29f1-e80d11dfd472@lat-lon.de>
References: <debb10fa-a080-61bf-a974-45062b0b08d8@lat-lon.de>
 <5b6f7e99-6f5d-772c-1f88-dbc1b148bd5e@spatialys.com>
 <c6e43990-f1f3-5d96-29f1-e80d11dfd472@lat-lon.de>
Message-ID: <a5dc3a99-8cb1-d837-6995-d49130af8512@spatialys.com>


Le 14/02/2023 ? 23:45, Dirk Stenger a ?crit?:
>
> Thank you for the help.
>
> Your proposed solution works for ubuntu-small.
>
> However, when I am trying to build ubuntu-full, I get a new error:
>
Did you "git pull" to get the latest state of the repository ? The error 
you get might come from the fact that you run a Docker build based on an 
outdated recipee which drags the new state of master, as the Docker 
build scripts do not use the GDAL sources of the working copy but from 
the latest master (yeah, quite unusual). There has been an update 
regarding pdfium beginning of December.


-- 
http://www.spatialys.com
My software is free, but my time generally not.


From afernandez at odyhpc.com  Tue Feb 14 15:06:24 2023
From: afernandez at odyhpc.com (afernandez)
Date: Tue, 14 Feb 2023 23:06:24 +0000
Subject: [gdal-dev] Issues with SetColorTable() and multi-sample TIFF
References: <cf35d819b16e3.4ed0e9f08beef@odyhpc.com>
 <c95e84f0-04c3-4533-6be5-34e07c4744e6@spatialys.com>
 <abe1081ad06a8.9a366de92553e@odyhpc.com>
 <c085d0c2-f103-3db8-519a-0d8dae0676f3@spatialys.com>
Message-ID: <0dde091715624.14d4e5344804b@odyhpc.com>

Hi Even,
I checked and it doesn't seem that GDAL was built with KEA support. I built it with aptitude so my input was minimal. The installation included:
$ sudo apt install gdal-bin libgdal-dev python3-gdal 
Should I install any other package or would the solution involve installing GDAL from source?
[Info: the system is running Ubuntu 20.04 and it returns: 
$ gdalinfo --version
GDAL 3.0.4, released 2020/01/28]
Thanks,
AFernandez
Even Rouault wrote:
Le 14/02/2023 ? 18:46, afernandez a ?crit :
Hello Even,
Thank you for the quick reply. I'll try using GDAL subdatasets later this afternoon (although I'm not sure if this solution would become a bit messy for hundreds of files). The format KEA is completely new to me. I was able to install KEALib but found only one source of information online (https://gdal.org/drivers/raster/kea.html <https://gdal.org/drivers/raster/kea.html> ). To start somewhere, I simply modified the first 2 lines of the script to:
driver_name = 'KEA'
driver = gdal.GetDriverByName(driver_name)
However, it doesn't pick it up (driver returns 'None'). Ideally there would be some example that I could follow but I might have to do this piecewise in the meantime. 
You need to tune your build so it finds KEALib. See https://gdal.org/development/building_from_source.html#kea <https://gdal.org/development/building_from_source.html#kea> for related CMake options. "grep GDAL_USE_KEA CMakeCache.txt" should report ON if things are proprerly configured. Once the driver is available in your GDAL build, just changing the name of the driver should be sufficient
See also https://github.com/OSGeo/gdal/blob/master/.github/workflows/ubuntu_20.04/build-deps.sh#L30 <https://github.com/OSGeo/gdal/blob/master/.github/workflows/ubuntu_20.04/build-deps.sh#L30> for an example of a CI configuration that builds with libkea support (not much to do if you install it in a standard location looked for by cmake)
-- http://www.spatialys.com <http://www.spatialys.com> My software is free, but my time generally not. 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230214/611ccc15/attachment.htm>

From even.rouault at spatialys.com  Tue Feb 14 15:30:22 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 15 Feb 2023 00:30:22 +0100
Subject: [gdal-dev] Issues with SetColorTable() and multi-sample TIFF
In-Reply-To: <0dde091715624.14d4e5344804b@odyhpc.com>
References: <cf35d819b16e3.4ed0e9f08beef@odyhpc.com>
 <c95e84f0-04c3-4533-6be5-34e07c4744e6@spatialys.com>
 <abe1081ad06a8.9a366de92553e@odyhpc.com>
 <c085d0c2-f103-3db8-519a-0d8dae0676f3@spatialys.com>
 <0dde091715624.14d4e5344804b@odyhpc.com>
Message-ID: <771bf823-f15b-e5aa-222b-a5f5d80be1c6@spatialys.com>


> ?would the solution involve installing GDAL from source?

Yes, Ubuntu packages don't have the libkea dependency.

FYI, GDAL from conda-forge has KEA support: 
https://gdal.org/download.html#conda

-- 

http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230215/df7a7bf2/attachment.htm>

From simon.eves at heavy.ai  Tue Feb 14 16:33:48 2023
From: simon.eves at heavy.ai (Simon Eves)
Date: Tue, 14 Feb 2023 16:33:48 -0800
Subject: [gdal-dev] OpenJPEG JPEG2000 Driver
In-Reply-To: <CAJf0KTQLWnqEMb7yYn9LB_BN6XZ3+xDfxeqk-CibHSYXMWkjcA@mail.gmail.com>
References: <CAJf0KTQLWnqEMb7yYn9LB_BN6XZ3+xDfxeqk-CibHSYXMWkjcA@mail.gmail.com>
Message-ID: <CAJf0KTQJfYwyJK+J7e4hZpTbpktGX79x7vgLCiPS6P8nL19uXg@mail.gmail.com>

I recreated the compile/link test that *configure* is doing, and it also
fails outside.

I then determined I could make it work by also adding *-lm* and *-lpthread*
to the link.

I hacked GDAL *configure* script to also add those two to *$LIBS* when it
does the OpenJPEG link test, and now that passes, and then *configure*
reports OpenJPEG is enabled.

However, when I then compile GDAL, it fails in the final huge link of
*libgdal.la
<http://libgdal.la>* with


*/usr/bin/ld: /usr/local/mapd-deps/lib/libopenjp2.a(cio.c.o): relocation
R_X86_64_PC32 against symbol `opj_stream_write_skip' can not be used when
making a shared object; recompile with -fPIC/usr/bin/ld: final link failed:
bad value*

I assume this is because it's trying to make a shared GDAL lib, but
including the static OpenJPEG lib.

I tried adding * -DCMAKE_CPP_FLAGS="-fPIC" -DCMAKE_CXX_FLAGS="-fPIC"* to
the OpenJPEG build CMake invocation, but that made no difference.

Any help with this would be greatly appreciated, as we're code-freezing end
of this week and I'd really like to get this in.



On Sun, Feb 12, 2023 at 6:44 PM Simon Eves <simon.eves at heavy.ai> wrote:

> Is there some trick to enabling this driver with the old non-CMake build
> env...? :)
>
> I am building OpenJPEG 2.5.0 (from source) and it's building and
> installing fine into the same include/lib tree as everything else, and then
> GDAL configure (just adding *--with-openjpeg*, no path, right?) sees it
> and tests it, but the compile test of *opj_setup_decoder()* apparently
> fails, so *HAVE_OPENJPEG* gets disabled again.
>
> I see that function in *openjpeg.h* and (with *nm*) in *libopenjp2.a*, so
> I'm not sure why it's failing.
>
> I tried some other CMake option variations for OpenJPEG but nothing fixed
> it.
>
> Ubuntu 20.04, GCC 9.4, GDAL 3.4.1, all-static build
>
> I have tried GDAL 3.6.2 (and PROJ 9.2.1) building them with CMake and I
> think the OpenJPEG part is working, then but our dependencies build falls
> over later with something else that doesn't like the newer PROJ, and I'd
> rather not bump the GDAL & PROJ and data files versions at this time
> anyway, as we're very close to a release.
>
> I just wanna minimally add JPEG2000 to what we have...
>
> TIA
>
> --
> Simon Eves
> Senior Rendering Engineer
> +1 (415) 902-1996
> simon.eves at heavy.ai
>
> <http://www.heavy.ai>
>
> (formerly OmniSci)
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230214/57e78d95/attachment.htm>

From simon.eves at heavy.ai  Tue Feb 14 16:40:32 2023
From: simon.eves at heavy.ai (Simon Eves)
Date: Tue, 14 Feb 2023 16:40:32 -0800
Subject: [gdal-dev] OpenJPEG JPEG2000 Driver
In-Reply-To: <CAJf0KTQJfYwyJK+J7e4hZpTbpktGX79x7vgLCiPS6P8nL19uXg@mail.gmail.com>
References: <CAJf0KTQLWnqEMb7yYn9LB_BN6XZ3+xDfxeqk-CibHSYXMWkjcA@mail.gmail.com>
 <CAJf0KTQJfYwyJK+J7e4hZpTbpktGX79x7vgLCiPS6P8nL19uXg@mail.gmail.com>
Message-ID: <CAJf0KTQ-nfdVf4U7S_hEMncn=YQ0Y-ELsXSyuD+vx+__QGC4kg@mail.gmail.com>

OK, I'm an idiot. It's *CMAKE_C_FLAGS* not *CMAKE_CPP_FLAGS*. It works now.

However, I am still surprised at the need to hack the *configure* script to
make the test work.


On Tue, Feb 14, 2023 at 4:33 PM Simon Eves <simon.eves at heavy.ai> wrote:

> I recreated the compile/link test that *configure* is doing, and it also
> fails outside.
>
> I then determined I could make it work by also adding *-lm* and
> *-lpthread* to the link.
>
> I hacked GDAL *configure* script to also add those two to *$LIBS* when it
> does the OpenJPEG link test, and now that passes, and then *configure*
> reports OpenJPEG is enabled.
>
> However, when I then compile GDAL, it fails in the final huge link of *libgdal.la
> <http://libgdal.la>* with
>
>
> */usr/bin/ld: /usr/local/mapd-deps/lib/libopenjp2.a(cio.c.o): relocation
> R_X86_64_PC32 against symbol `opj_stream_write_skip' can not be used when
> making a shared object; recompile with -fPIC/usr/bin/ld: final link failed:
> bad value*
>
> I assume this is because it's trying to make a shared GDAL lib, but
> including the static OpenJPEG lib.
>
> I tried adding * -DCMAKE_CPP_FLAGS="-fPIC" -DCMAKE_CXX_FLAGS="-fPIC"* to
> the OpenJPEG build CMake invocation, but that made no difference.
>
> Any help with this would be greatly appreciated, as we're code-freezing
> end of this week and I'd really like to get this in.
>
>
>
> On Sun, Feb 12, 2023 at 6:44 PM Simon Eves <simon.eves at heavy.ai> wrote:
>
>> Is there some trick to enabling this driver with the old non-CMake build
>> env...? :)
>>
>> I am building OpenJPEG 2.5.0 (from source) and it's building and
>> installing fine into the same include/lib tree as everything else, and then
>> GDAL configure (just adding *--with-openjpeg*, no path, right?) sees it
>> and tests it, but the compile test of *opj_setup_decoder()* apparently
>> fails, so *HAVE_OPENJPEG* gets disabled again.
>>
>> I see that function in *openjpeg.h* and (with *nm*) in *libopenjp2.a*,
>> so I'm not sure why it's failing.
>>
>> I tried some other CMake option variations for OpenJPEG but nothing fixed
>> it.
>>
>> Ubuntu 20.04, GCC 9.4, GDAL 3.4.1, all-static build
>>
>> I have tried GDAL 3.6.2 (and PROJ 9.2.1) building them with CMake and I
>> think the OpenJPEG part is working, then but our dependencies build falls
>> over later with something else that doesn't like the newer PROJ, and I'd
>> rather not bump the GDAL & PROJ and data files versions at this time
>> anyway, as we're very close to a release.
>>
>> I just wanna minimally add JPEG2000 to what we have...
>>
>> TIA
>>
>> --
>> Simon Eves
>> Senior Rendering Engineer
>> +1 (415) 902-1996
>> simon.eves at heavy.ai
>>
>> <http://www.heavy.ai>
>>
>> (formerly OmniSci)
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230214/421319aa/attachment-0001.htm>

From fengting.chen at oracle.com  Tue Feb 14 16:57:18 2023
From: fengting.chen at oracle.com (Fengting Chen)
Date: Wed, 15 Feb 2023 00:57:18 +0000
Subject: [gdal-dev] How to build GDAL without dependency on libtiff.so or
 libjpeg.so
Message-ID: <BYAPR10MB336632274D94E74439E9D78093A39@BYAPR10MB3366.namprd10.prod.outlook.com>

Hi,

In the old build system, I was able to build GDAL 3.4 using ??with-libtiff=internal? and ??with-jpeg=internal? . However, ldd on libgdal.so shows that it still depends on libtiff.so and libjpeg.so. How to build GDAL without this dependency?

Thanks!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230215/33695819/attachment.htm>

From mateusz at loskot.net  Tue Feb 14 22:25:08 2023
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed, 15 Feb 2023 07:25:08 +0100
Subject: [gdal-dev] OpenJPEG JPEG2000 Driver
In-Reply-To: <CAJf0KTQJfYwyJK+J7e4hZpTbpktGX79x7vgLCiPS6P8nL19uXg@mail.gmail.com>
References: <CAJf0KTQLWnqEMb7yYn9LB_BN6XZ3+xDfxeqk-CibHSYXMWkjcA@mail.gmail.com>
 <CAJf0KTQJfYwyJK+J7e4hZpTbpktGX79x7vgLCiPS6P8nL19uXg@mail.gmail.com>
Message-ID: <CABUeae9uMps1TpXoRMxBxKckTnbLLL8KXvnT5KdrMjBP3KSOMA@mail.gmail.com>

On Wed, 15 Feb 2023 at 01:34, Simon Eves <simon.eves at heavy.ai> wrote:
>
> I tried adding  -DCMAKE_CPP_FLAGS="-fPIC" -DCMAKE_CXX_FLAGS="-fPIC" to the OpenJPEG build CMake invocation, but that made no difference.
>

More CMake-idiomatic way is to use -DCMAKE_POSITION_INDEPENDENT_CODE=ON instead.

It used to be there
https://github.com/OSGeo/gdal/commit/a0128debca5dd77a64188cc7ac3ba60866a70e89
until https://github.com/OSGeo/gdal/issues/5649

and there is GDAL-specific variable now
-DGDAL_OBJECT_LIBRARIES_POSITION_INDEPENDENT_CODE=ON
https://github.com/OSGeo/gdal/blob/master/gdal.cmake#L42-L43

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From stenger at lat-lon.de  Wed Feb 15 02:51:45 2023
From: stenger at lat-lon.de (Dirk Stenger)
Date: Wed, 15 Feb 2023 11:51:45 +0100
Subject: [gdal-dev] Error when trying to build Docker Images
In-Reply-To: <a5dc3a99-8cb1-d837-6995-d49130af8512@spatialys.com>
References: <debb10fa-a080-61bf-a974-45062b0b08d8@lat-lon.de>
 <5b6f7e99-6f5d-772c-1f88-dbc1b148bd5e@spatialys.com>
 <c6e43990-f1f3-5d96-29f1-e80d11dfd472@lat-lon.de>
 <a5dc3a99-8cb1-d837-6995-d49130af8512@spatialys.com>
Message-ID: <47f34df9-2bd6-1622-0518-147b4d6de645@lat-lon.de>

Thanks for all the help. Now, the build of ubuntu-full also works.

The reason that I am trying to build it is that I need a Debian GDAL Image.

Unfortunately, the command which is derived from the readme, leads to an 
error:

~/git/gdal/docker$ BASE_IMAGE="debian:11"  ubuntu-full/build.sh --platform linux/amd64 --gdal v3.5.0
...
E: Package'libmysqlclient-dev'  has no installation candidate
The command'/bin/sh -c . /buildscripts/bh-set-envvars.sh ? ? && apt-get update -y ? 
 ? && DEBIAN_FRONTEND=noninteractive apt-get install -y --fix-missing 
--no-install-recommends ? ? ? ?libopenjp2-7-dev${APT_ARCH_SUFFIX} 
libcairo2-dev${APT_ARCH_SUFFIX} ? ? ? ?python3-dev${APT_ARCH_SUFFIX} 
python3-numpy${APT_ARCH_SUFFIX} python3-setuptools${APT_ARCH_SUFFIX} ? ? 
 ? ?libpng-dev${APT_ARCH_SUFFIX} libjpeg-dev${APT_ARCH_SUFFIX} 
libgif-dev${APT_ARCH_SUFFIX} liblzma-dev${APT_ARCH_SUFFIX} 
libgeos-dev${APT_ARCH_SUFFIX} ? ? ? ?curl libxml2-dev${APT_ARCH_SUFFIX} 
libexpat-dev${APT_ARCH_SUFFIX} libxerces-c-dev${APT_ARCH_SUFFIX} ? ? ? 
 ?libnetcdf-dev${APT_ARCH_SUFFIX} libpoppler-dev${APT_ARCH_SUFFIX} 
libpoppler-private-dev${APT_ARCH_SUFFIX} ? ? ? 
 ?libspatialite-dev${APT_ARCH_SUFFIX} 
librasterlite2-dev${APT_ARCH_SUFFIX} swig ant 
libhdf4-alt-dev${APT_ARCH_SUFFIX} libhdf5-serial-dev${APT_ARCH_SUFFIX} ? 
 ? ? ?libfreexl-dev${APT_ARCH_SUFFIX} unixodbc-dev${APT_ARCH_SUFFIX} 
 ?mdbtools-dev${APT_ARCH_SUFFIX} libwebp-dev${APT_ARCH_SUFFIX} ? ? ? 
 ?liblcms2-2 libpcre3-dev${APT_ARCH_SUFFIX} 
libcrypto++-dev${APT_ARCH_SUFFIX} libfyba-dev${APT_ARCH_SUFFIX} ? ? ? 
 ?libkml-dev${APT_ARCH_SUFFIX} libmysqlclient-dev${APT_ARCH_SUFFIX} 
libogdi-dev${APT_ARCH_SUFFIX} ? ? ? ?libcfitsio-dev${APT_ARCH_SUFFIX} 
openjdk-"$JAVA_VERSION"-jdk${APT_ARCH_SUFFIX} 
libzstd-dev${APT_ARCH_SUFFIX} ? ? ? ?libpq-dev${APT_ARCH_SUFFIX} 
libssl-dev${APT_ARCH_SUFFIX} libboost-dev${APT_ARCH_SUFFIX} ? ? ? 
 ?autoconf automake bash-completion libarmadillo-dev${APT_ARCH_SUFFIX} ? 
 ? ? ?libopenexr-dev${APT_ARCH_SUFFIX} libheif-dev${APT_ARCH_SUFFIX} ? ? 
 ? ?libdeflate-dev${APT_ARCH_SUFFIX} libblosc-dev${APT_ARCH_SUFFIX} 
liblz4-dev${APT_ARCH_SUFFIX} libbz2-dev${APT_ARCH_SUFFIX} ? ? ? 
 ?libbrotli-dev${APT_ARCH_SUFFIX} ? ? ? 
 ?libarchive-dev${APT_ARCH_SUFFIX} ? ? && rm -rf /var/lib/apt/lists/*'  returned a non-zero code: 100

I assume that is the case because the Dockerfile references Ubuntu apt 
repos?

Is there currently a way to build Debian based Images or do I have to 
adjust the apt repos in the Dockerfile?

Kind regards,

Dirk



Am 14.02.23 um 23:53 schrieb Even Rouault:
>
> Le 14/02/2023 ? 23:45, Dirk Stenger a ?crit?:
>>
>> Thank you for the help.
>>
>> Your proposed solution works for ubuntu-small.
>>
>> However, when I am trying to build ubuntu-full, I get a new error:
>>
> Did you "git pull" to get the latest state of the repository ? The 
> error you get might come from the fact that you run a Docker build 
> based on an outdated recipee which drags the new state of master, as 
> the Docker build scripts do not use the GDAL sources of the working 
> copy but from the latest master (yeah, quite unusual). There has been 
> an update regarding pdfium beginning of December.
>
>
-- 
l a t / l o n  GmbH
Im Ellig 1                           53343 Wachtberg, Germany
phone ++49 +228 24 333 784
http://www.lat-lon.de                   http://www.deegree.org

lat/lon gesellschaft f?r raumbezogene informationssysteme mbH
Registergericht: Amtsgericht Bonn, HRB 13042
Gesch?ftsf?hrer: Jens Fitzke und Torsten Friebe
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230215/a09142e0/attachment.htm>

From lnicola at dend.ro  Wed Feb 15 02:59:06 2023
From: lnicola at dend.ro (=?UTF-8?Q?Lauren=C8=9Biu_Nicola?=)
Date: Wed, 15 Feb 2023 12:59:06 +0200
Subject: [gdal-dev] Error when trying to build Docker Images
In-Reply-To: <47f34df9-2bd6-1622-0518-147b4d6de645@lat-lon.de>
References: <debb10fa-a080-61bf-a974-45062b0b08d8@lat-lon.de>
 <5b6f7e99-6f5d-772c-1f88-dbc1b148bd5e@spatialys.com>
 <c6e43990-f1f3-5d96-29f1-e80d11dfd472@lat-lon.de>
 <a5dc3a99-8cb1-d837-6995-d49130af8512@spatialys.com>
 <47f34df9-2bd6-1622-0518-147b4d6de645@lat-lon.de>
Message-ID: <69ec8dd8-2495-4856-8d64-deb01b1275b2@betaapp.fastmail.com>

Hi,

I think libmysqlclient-dev is called default-libmysqlclient-dev on Debian. Unfortunately, you might have to experiment a little with the package names and repository lists.

Laurentiu

On Wed, Feb 15, 2023, at 12:51, Dirk Stenger wrote:
> Thanks for all the help. Now, the build of ubuntu-full also works.
> 
> The reason that I am trying to build it is that I need a Debian GDAL Image.
> 
> Unfortunately, the command which is derived from the readme, leads to an error:
> 
> ~/git/gdal/docker$ BASE_IMAGE="debian:11" ubuntu-full/build.sh --platform linux/amd64 --gdal v3.5.0
> ...
> E: Package 'libmysqlclient-dev' has no installation candidate
> The command '/bin/sh -c . /buildscripts/bh-set-envvars.sh     && apt-get update -y     && DEBIAN_FRONTEND=noninteractive apt-get install -y --fix-missing --no-install-recommends        libopenjp2-7-dev${APT_ARCH_SUFFIX} libcairo2-dev${APT_ARCH_SUFFIX}        python3-dev${APT_ARCH_SUFFIX} python3-numpy${APT_ARCH_SUFFIX} python3-setuptools${APT_ARCH_SUFFIX}        libpng-dev${APT_ARCH_SUFFIX} libjpeg-dev${APT_ARCH_SUFFIX} libgif-dev${APT_ARCH_SUFFIX} liblzma-dev${APT_ARCH_SUFFIX} libgeos-dev${APT_ARCH_SUFFIX}        curl libxml2-dev${APT_ARCH_SUFFIX} libexpat-dev${APT_ARCH_SUFFIX} libxerces-c-dev${APT_ARCH_SUFFIX}        libnetcdf-dev${APT_ARCH_SUFFIX} libpoppler-dev${APT_ARCH_SUFFIX} libpoppler-private-dev${APT_ARCH_SUFFIX}        libspatialite-dev${APT_ARCH_SUFFIX} librasterlite2-dev${APT_ARCH_SUFFIX} swig ant libhdf4-alt-dev${APT_ARCH_SUFFIX} libhdf5-serial-dev${APT_ARCH_SUFFIX}        libfreexl-dev${APT_ARCH_SUFFIX} unixodbc-dev${APT_ARCH_SUFFIX}  mdbtools-dev${APT_ARCH_SUFFIX} libwebp-dev${APT_ARCH_SUFFIX}        liblcms2-2 libpcre3-dev${APT_ARCH_SUFFIX} libcrypto++-dev${APT_ARCH_SUFFIX} libfyba-dev${APT_ARCH_SUFFIX}        libkml-dev${APT_ARCH_SUFFIX} libmysqlclient-dev${APT_ARCH_SUFFIX} libogdi-dev${APT_ARCH_SUFFIX}        libcfitsio-dev${APT_ARCH_SUFFIX} openjdk-"$JAVA_VERSION"-jdk${APT_ARCH_SUFFIX} libzstd-dev${APT_ARCH_SUFFIX}        libpq-dev${APT_ARCH_SUFFIX} libssl-dev${APT_ARCH_SUFFIX} libboost-dev${APT_ARCH_SUFFIX}        autoconf automake bash-completion libarmadillo-dev${APT_ARCH_SUFFIX}        libopenexr-dev${APT_ARCH_SUFFIX} libheif-dev${APT_ARCH_SUFFIX}        libdeflate-dev${APT_ARCH_SUFFIX} libblosc-dev${APT_ARCH_SUFFIX} liblz4-dev${APT_ARCH_SUFFIX} libbz2-dev${APT_ARCH_SUFFIX}        libbrotli-dev${APT_ARCH_SUFFIX}        libarchive-dev${APT_ARCH_SUFFIX}     && rm -rf /var/lib/apt/lists/*' returned a non-zero code: 100
> 
> I assume that is the case because the Dockerfile references Ubuntu apt repos?
> 
> Is there currently a way to build Debian based Images or do I have to adjust the apt repos in the Dockerfile?
> 
> Kind regards,
> 
> Dirk
> 
> 
> 
> 
> 
> 
> 
> Am 14.02.23 um 23:53 schrieb Even Rouault:
>> 
>> Le 14/02/2023 ? 23:45, Dirk Stenger a ?crit :
>>> 
>>> Thank you for the help. 
>>> 
>>> Your proposed solution works for ubuntu-small. 
>>> 
>>> However, when I am trying to build ubuntu-full, I get a new error:
>> Did you "git pull" to get the latest state of the repository ? The error you get might come from the fact that you run a Docker build based on an outdated recipee which drags the new state of master, as the Docker build scripts do not use the GDAL sources of the working copy but from the latest master (yeah, quite unusual). There has been an update regarding pdfium beginning of December.
>> 
> -- 
> l a t / l o n  GmbH
> Im Ellig 1                           53343 Wachtberg, Germany
> phone ++49 +228 24 333 784
> http://www.lat-lon.de                  http://www.deegree.org
> 
> lat/lon gesellschaft f?r raumbezogene informationssysteme mbH
> Registergericht: Amtsgericht Bonn, HRB 13042
> Gesch?ftsf?hrer: Jens Fitzke und Torsten Friebe
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230215/9639f9a7/attachment-0001.htm>

From even.rouault at spatialys.com  Wed Feb 15 04:17:59 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 15 Feb 2023 13:17:59 +0100
Subject: [gdal-dev] How to build GDAL without dependency on libtiff.so
 or libjpeg.so
In-Reply-To: <BYAPR10MB336632274D94E74439E9D78093A39@BYAPR10MB3366.namprd10.prod.outlook.com>
References: <BYAPR10MB336632274D94E74439E9D78093A39@BYAPR10MB3366.namprd10.prod.outlook.com>
Message-ID: <1208a67e-9da3-99d9-9ab2-1b9d51a15abf@spatialys.com>

Hi,

Assuming you're speaking about how to link against internal copy with 
CMake builds, cf GDAL_USE_TIFF_INTERNAL and GDAL_USE_JPEG_INTERNAL at 
https://gdal.org/development/building_from_source.html#tiff and 
https://gdal.org/development/building_from_source.html#jpeg

Even if you set those, you can still get external libtiff or libjpeg 
dependency, if you also link to a GDAL dependency that links against 
those, like libgeotiff, librasterlite2, ...

Even

Le 15/02/2023 ? 01:57, Fengting Chen a ?crit?:
>
> Hi,
>
> In the old build system, I was able to build GDAL 3.4 using 
> ??with-libtiff=internal? and ??with-jpeg=internal? . However, ldd on 
> libgdal.so shows that it still depends on libtiff.so and libjpeg.so. 
> How to build GDAL without this dependency?
>
> Thanks!
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230215/476347f6/attachment.htm>

From robert.coup at koordinates.com  Wed Feb 15 06:32:21 2023
From: robert.coup at koordinates.com (Robert Coup)
Date: Wed, 15 Feb 2023 14:32:21 +0000
Subject: [gdal-dev] [Board] Travis usage of GRASS
In-Reply-To: <521419f1-a3d9-2b15-a521-81f0a0061dac@spatialys.com>
References: <DA9057D1-4DA8-42A4-A11D-00537BE1A411@gmail.com>
 <7cfc5be3-5e26-3add-390d-f17a0dcf5ab5@spatialys.com>
 <7EFA0723-4255-49FF-8D51-C194011F9CD4@gmail.com>
 <521419f1-a3d9-2b15-a521-81f0a0061dac@spatialys.com>
Message-ID: <CAFLLRpKcjg7t3YeZSM8awb_DYCQBiK2ZZs=K2_VwXL+f9Ovx4g@mail.gmail.com>

Hi,

For arm support, BuildJet hosts Github Actions arm64 runners
https://buildjet.com/for-github-actions/docs/runners ? works well IME, and
doesn't require yet another CI system configuration. I don't know whether
there's any discounts/support for OSS projects.

Rob :)

On Tue, 14 Feb 2023 at 18:05, Even Rouault <even.rouault at spatialys.com>
wrote:

> 2 concurrent builds would probably be fine.
>
> (I also see we use s390x and Graviton2 for PROJ. It is sometimes useful
> because of subtle floating point differences that pop up and make the
> regression test suite fail. Easier to catch them at the time they are
> introduced rather that after release when the maintainer of a Linux
> distro which builds for all possible architectures reports a test
> failure in one of those archs to which you don't have easy access to)
>
> Le 14/02/2023 ? 18:50, Michael Smith a ?crit :
> > Even,
> >
> > If its actively being used, that?s fine. Was just re-evaluating after
> talking with Howard. Could we drop the concurrency down without impacting
> GDAL, GRASS and other projects?
> > And looks like I got the renewal dates swapped with mapserver. The OSGeo
> plan doesn?t renew until June. Right now we are on the:
> >
> > Premium plan 10 concurrent jobs with 30% discount.
> >
> > So if we do need to maintain, could we drop to 5 or 2 concurrent builds?
> >
> >
> > -
> > Michael Smith
> > OSGeo Treasurer
> >
> >
> >
> > From: Even Rouault <even.rouault at spatialys.com>
> > Date: Tuesday, February 14, 2023 at 10:38 AM
> > To: Michael Smith <michael.smith.erdc at gmail.com>, <wenzeslaus at gmail.com>,
> Markus Neteler <neteler at osgeo.org>, Veronica Andreo <veroandreo at gmail.com>
> > Cc: <board at lists.osgeo.org>, "gdal-dev at lists.osgeo.org" <
> gdal-dev at lists.osgeo.org>
> > Subject: Re: [Board] Travis usage of GRASS
> >
> > Hi,
> > just reacting to "We were considering cancelling OSGeo?s subscription".
> For GDAL, our current use of Travis-CI is to test portability on the
> Graviton2 ARM64 and s390x big-endian platforms (we use github CI for x64
> Linux/Win/Mac). For Graviton2, this is more the ARM64 side of things than
> the Graviton2 specific one, as ARM64 is the architecture of recent Apple
> hardware and there's no corresponding workers for github CI (not sure if
> there free CI solutions that can be integrated with github and offer ARM64
> support?). s390x/big-endian use cases have probably little market relevance
> nowadays.
> > Even
> > Le 14/02/2023 ? 18:26, Michael Smith via Board a ?crit :
> > After not seeing any builds for a while in Travis from Grass, I just saw
> one recently.
> >
> > We were considering cancelling OSGeo?s subscription but if this is
> something GRASS is actively using/depending on, we can maintain. We might
> scale back the subscription if its only lightly used those. I have to renew
> on Feb 19 so if you could let me know before then.
> >
> > Thanks,
> >
> > Mike
> >
> >
> > -
> > Michael Smith
> > OSGeo Treasurer
> >
> >
> >
> >
> >
> > _______________________________________________
> > Board mailing list
> > mailto:Board at lists.osgeo.org
> > https://lists.osgeo.org/mailman/listinfo/board
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230215/8f9ca328/attachment.htm>

From simon.eves at heavy.ai  Wed Feb 15 10:14:03 2023
From: simon.eves at heavy.ai (Simon Eves)
Date: Wed, 15 Feb 2023 10:14:03 -0800
Subject: [gdal-dev] OpenJPEG JPEG2000 Driver
In-Reply-To: <CABUeae9uMps1TpXoRMxBxKckTnbLLL8KXvnT5KdrMjBP3KSOMA@mail.gmail.com>
References: <CAJf0KTQLWnqEMb7yYn9LB_BN6XZ3+xDfxeqk-CibHSYXMWkjcA@mail.gmail.com>
 <CAJf0KTQJfYwyJK+J7e4hZpTbpktGX79x7vgLCiPS6P8nL19uXg@mail.gmail.com>
 <CABUeae9uMps1TpXoRMxBxKckTnbLLL8KXvnT5KdrMjBP3KSOMA@mail.gmail.com>
Message-ID: <CAJf0KTQtSh9hihU_M6axt83iN3cCOPF6PV4t+kp3OdrjWK9Dqg@mail.gmail.com>

Interesting. Thank you for that.

Note that it was OpenJPEG that I added fPIC to, not GDAL itself. I am
building OpenJPEG with SHARED_LIBS off, as we only need the static version
for GDAL. GDAL itself builds default (SHARED_LIBS on) as we need static for
our main product build, but also DSOs for the GDAL command-line apps. We
don't need to link GDAL statically into any higher-level shared libs, just
the main monolithic executable.

I will certainly change to use the idiomatic option for the OpenJPEG build,
though.

My main concern remains the need to hack the configure script to get the
GDAL build to agree that OpenJPEG is usable, but since my hack only affects
the configure test and not the actual GDAL build itself, I guess it's fine.

Perhaps it was just a bug, although it seems unlikely that nobody hit it. I
believe the behavior to be fine in CMake-based builds, but obv that's not
an option for now on 3.4.1.




On Tue, Feb 14, 2023 at 10:25 PM Mateusz Loskot <mateusz at loskot.net> wrote:

> On Wed, 15 Feb 2023 at 01:34, Simon Eves <simon.eves at heavy.ai> wrote:
> >
> > I tried adding  -DCMAKE_CPP_FLAGS="-fPIC" -DCMAKE_CXX_FLAGS="-fPIC" to
> the OpenJPEG build CMake invocation, but that made no difference.
> >
>
> More CMake-idiomatic way is to use -DCMAKE_POSITION_INDEPENDENT_CODE=ON
> instead.
>
> It used to be there
>
> https://github.com/OSGeo/gdal/commit/a0128debca5dd77a64188cc7ac3ba60866a70e89
> until https://github.com/OSGeo/gdal/issues/5649
>
> and there is GDAL-specific variable now
> -DGDAL_OBJECT_LIBRARIES_POSITION_INDEPENDENT_CODE=ON
> https://github.com/OSGeo/gdal/blob/master/gdal.cmake#L42-L43
>
> Best regards,
> --
> Mateusz Loskot, http://mateusz.loskot.net
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230215/d9d4bf0b/attachment.htm>

From mateusz at loskot.net  Wed Feb 15 10:30:39 2023
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed, 15 Feb 2023 19:30:39 +0100
Subject: [gdal-dev] OpenJPEG JPEG2000 Driver
In-Reply-To: <CAJf0KTQtSh9hihU_M6axt83iN3cCOPF6PV4t+kp3OdrjWK9Dqg@mail.gmail.com>
References: <CAJf0KTQLWnqEMb7yYn9LB_BN6XZ3+xDfxeqk-CibHSYXMWkjcA@mail.gmail.com>
 <CAJf0KTQJfYwyJK+J7e4hZpTbpktGX79x7vgLCiPS6P8nL19uXg@mail.gmail.com>
 <CABUeae9uMps1TpXoRMxBxKckTnbLLL8KXvnT5KdrMjBP3KSOMA@mail.gmail.com>
 <CAJf0KTQtSh9hihU_M6axt83iN3cCOPF6PV4t+kp3OdrjWK9Dqg@mail.gmail.com>
Message-ID: <CABUeae9myvpXO5MSGXBF2_nyfBtBcfnhBy8Og2pYqbuju82iGQ@mail.gmail.com>

On Wed, 15 Feb 2023 at 19:14, Simon Eves <simon.eves at heavy.ai> wrote:
>
> I am building OpenJPEG with SHARED_LIBS off, as we only need the static version for GDAL.
> GDAL itself builds default (SHARED_LIBS on) as we need static for our main product build,

I know nothing about OpenJPEG build configuration, but GDAL uses CMake's native
BUILD_SHARED_LIBS to control the shared/static library build

> We don't need to link GDAL statically into any higher-level shared libs, just the main monolithic executable.
> [...]
> My main concern remains the need to hack the configure script to get the GDAL build to agree that OpenJPEG is usable,

In theory, BUILD_SHARED_LIBS=ON could/should cascade to all dependencies
- you want static GDAL, good, we will assume you link it against
static OpenJPEG, etc.

However, I remember, I had to modify the old NMAKE makefile to make
GDAL link against
static curl and a few others I did build as static libraries, e.g.
forcing those deps as static-s
and adding list of dependencies of those dependencies, etc.
So, I'd say hacking build config for uncommon builds nothing buggy or
unexpected.

Best regards.
-- 
Mateusz Loskot, http://mateusz.loskot.net

From even.rouault at spatialys.com  Wed Feb 15 10:44:30 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 15 Feb 2023 19:44:30 +0100
Subject: [gdal-dev] OpenJPEG JPEG2000 Driver
In-Reply-To: <CABUeae9myvpXO5MSGXBF2_nyfBtBcfnhBy8Og2pYqbuju82iGQ@mail.gmail.com>
References: <CAJf0KTQLWnqEMb7yYn9LB_BN6XZ3+xDfxeqk-CibHSYXMWkjcA@mail.gmail.com>
 <CAJf0KTQJfYwyJK+J7e4hZpTbpktGX79x7vgLCiPS6P8nL19uXg@mail.gmail.com>
 <CABUeae9uMps1TpXoRMxBxKckTnbLLL8KXvnT5KdrMjBP3KSOMA@mail.gmail.com>
 <CAJf0KTQtSh9hihU_M6axt83iN3cCOPF6PV4t+kp3OdrjWK9Dqg@mail.gmail.com>
 <CABUeae9myvpXO5MSGXBF2_nyfBtBcfnhBy8Og2pYqbuju82iGQ@mail.gmail.com>
Message-ID: <152a99bc-08b4-aee0-b647-478c02fdcf6f@spatialys.com>


> In theory, BUILD_SHARED_LIBS=ON could/should cascade to all dependencies
> - you want static GDAL, good, we will assume you link it against
> static OpenJPEG, etc.

That's indeed just theory. No such thing is implemented (if that was 
implemented, it should probably be more a CMake functionality than GDAL 
doing that itself). Static linking has always a complicated story, 
especially for GDAL whose dependencies may have other dependencies in 
cascade, whatever build system you use. For some of the dependencies 
that are detected through CMake config files, the cascaded dependencies 
may be found. But that tends to be complicated & fragile, and require 
upstream of those dependencies to generate clean CMake config files. Kai 
Pastor & the vcpkg team have done great work to improve this on select 
dependencies, but that's still a in-progress area.

>
> However, I remember, I had to modify the old NMAKE makefile to make
> GDAL link against
> static curl and a few others I did build as static libraries, e.g.
> forcing those deps as static-s
> and adding list of dependencies of those dependencies, etc.
> So, I'd say hacking build config for uncommon builds nothing buggy or
> unexpected.
Yep
>
> Best regards.

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From simon.eves at heavy.ai  Wed Feb 15 11:22:32 2023
From: simon.eves at heavy.ai (Simon Eves)
Date: Wed, 15 Feb 2023 11:22:32 -0800
Subject: [gdal-dev] OpenJPEG JPEG2000 Driver
In-Reply-To: <152a99bc-08b4-aee0-b647-478c02fdcf6f@spatialys.com>
References: <CAJf0KTQLWnqEMb7yYn9LB_BN6XZ3+xDfxeqk-CibHSYXMWkjcA@mail.gmail.com>
 <CAJf0KTQJfYwyJK+J7e4hZpTbpktGX79x7vgLCiPS6P8nL19uXg@mail.gmail.com>
 <CABUeae9uMps1TpXoRMxBxKckTnbLLL8KXvnT5KdrMjBP3KSOMA@mail.gmail.com>
 <CAJf0KTQtSh9hihU_M6axt83iN3cCOPF6PV4t+kp3OdrjWK9Dqg@mail.gmail.com>
 <CABUeae9myvpXO5MSGXBF2_nyfBtBcfnhBy8Og2pYqbuju82iGQ@mail.gmail.com>
 <152a99bc-08b4-aee0-b647-478c02fdcf6f@spatialys.com>
Message-ID: <CAJf0KTTqQ558+FAmagDqcVRvWbd0LgdXix2kdR_2YO3vJc2qtA@mail.gmail.com>

Thanks, everyone.

On Wed, Feb 15, 2023 at 10:44 AM Even Rouault <even.rouault at spatialys.com>
wrote:

>
> > In theory, BUILD_SHARED_LIBS=ON could/should cascade to all dependencies
> > - you want static GDAL, good, we will assume you link it against
> > static OpenJPEG, etc.
>
> That's indeed just theory. No such thing is implemented (if that was
> implemented, it should probably be more a CMake functionality than GDAL
> doing that itself). Static linking has always a complicated story,
> especially for GDAL whose dependencies may have other dependencies in
> cascade, whatever build system you use. For some of the dependencies
> that are detected through CMake config files, the cascaded dependencies
> may be found. But that tends to be complicated & fragile, and require
> upstream of those dependencies to generate clean CMake config files. Kai
> Pastor & the vcpkg team have done great work to improve this on select
> dependencies, but that's still a in-progress area.
>
> >
> > However, I remember, I had to modify the old NMAKE makefile to make
> > GDAL link against
> > static curl and a few others I did build as static libraries, e.g.
> > forcing those deps as static-s
> > and adding list of dependencies of those dependencies, etc.
> > So, I'd say hacking build config for uncommon builds nothing buggy or
> > unexpected.
> Yep
> >
> > Best regards.
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230215/8f6aa30f/attachment.htm>

From even.rouault at spatialys.com  Wed Feb 15 12:01:30 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 15 Feb 2023 21:01:30 +0100
Subject: [gdal-dev] Call for review: RFC 93: OGRLayer::UpdateFeature() method
Message-ID: <9495ce3e-1aa8-b620-a20e-a7c6a25c6399@spatialys.com>

Hi,

Please find in https://github.com/OSGeo/gdal/pull/7249: RFC 93: 
OGRLayer::UpdateFeature() method

This RFC adds a new method in the OGRLayer class, UpdateFeature(), to be
able to update a subset of the attributes and geometry fields of a feature.

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From fengting.chen at oracle.com  Wed Feb 15 13:36:07 2023
From: fengting.chen at oracle.com (Fengting Chen)
Date: Wed, 15 Feb 2023 21:36:07 +0000
Subject: [gdal-dev] [External] : Re: How to build GDAL without
 dependency on libtiff.so or libjpeg.so
In-Reply-To: <1208a67e-9da3-99d9-9ab2-1b9d51a15abf@spatialys.com>
References: <BYAPR10MB336632274D94E74439E9D78093A39@BYAPR10MB3366.namprd10.prod.outlook.com>
 <1208a67e-9da3-99d9-9ab2-1b9d51a15abf@spatialys.com>
Message-ID: <BYAPR10MB336645A8D5561FA56C416C3D93A39@BYAPR10MB3366.namprd10.prod.outlook.com>

Thanks. I later found out that libproj has dependency on libtiff. And since libproj is required by GDAL, basically GDAL indirectly depends on external libtiff.

From: Even Rouault <even.rouault at spatialys.com>
Date: Wednesday, February 15, 2023 at 7:18 AM
To: Fengting Chen <fengting.chen at oracle.com>, gdal-dev at lists.osgeo.org <gdal-dev at lists.osgeo.org>
Subject: [External] : Re: [gdal-dev] How to build GDAL without dependency on libtiff.so or libjpeg.so

Hi,

Assuming you're speaking about how to link against internal copy with CMake builds, cf GDAL_USE_TIFF_INTERNAL and GDAL_USE_JPEG_INTERNAL at https://gdal.org/development/building_from_source.html#tiff<https://urldefense.com/v3/__https:/gdal.org/development/building_from_source.html*tiff__;Iw!!ACWV5N9M2RV99hQ!J4ZpckslhF-pMKh63wut6u59ulUGlFppObpXHbYwyIrsz-5l72L9XzCYGVOfvJFFFQuMCVW88PwKz_ECg1Ih6_xMPa-T$> and https://gdal.org/development/building_from_source.html#jpeg<https://urldefense.com/v3/__https:/gdal.org/development/building_from_source.html*jpeg__;Iw!!ACWV5N9M2RV99hQ!J4ZpckslhF-pMKh63wut6u59ulUGlFppObpXHbYwyIrsz-5l72L9XzCYGVOfvJFFFQuMCVW88PwKz_ECg1Ih62IxHq7c$>

Even if you set those, you can still get external libtiff or libjpeg dependency, if you also link to a GDAL dependency that links against those, like libgeotiff, librasterlite2, ...

Even
Le 15/02/2023 ? 01:57, Fengting Chen a ?crit :
Hi,

In the old build system, I was able to build GDAL 3.4 using ??with-libtiff=internal? and ??with-jpeg=internal? . However, ldd on libgdal.so shows that it still depends on libtiff.so and libjpeg.so. How to build GDAL without this dependency?

Thanks!



_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

https://lists.osgeo.org/mailman/listinfo/gdal-dev<https://urldefense.com/v3/__https:/lists.osgeo.org/mailman/listinfo/gdal-dev__;!!ACWV5N9M2RV99hQ!J4ZpckslhF-pMKh63wut6u59ulUGlFppObpXHbYwyIrsz-5l72L9XzCYGVOfvJFFFQuMCVW88PwKz_ECg1Ih68ySfDAV$>

--

http://www.spatialys.com<https://urldefense.com/v3/__http:/www.spatialys.com__;!!ACWV5N9M2RV99hQ!J4ZpckslhF-pMKh63wut6u59ulUGlFppObpXHbYwyIrsz-5l72L9XzCYGVOfvJFFFQuMCVW88PwKz_ECg1Ih63zwy5xD$>

My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230215/f363cbf9/attachment.htm>

From afernandez at odyhpc.com  Wed Feb 15 15:20:23 2023
From: afernandez at odyhpc.com (afernandez)
Date: Wed, 15 Feb 2023 23:20:23 +0000
Subject: [gdal-dev] Segmentation fault while compiling
Message-ID: <ac3d715ae053.777fa1f843dc7@odyhpc.com>

Hello,
I'm trying to compile GDAL from source in order to include the KEA 
components. My attempt at compiling (configured simply with cmake .. 
-DCMAKE_INSTALL_PREFIX=/usr) failed towards the end with a segmentation 
fault error, which I cannot figure out 
...
[ 98%] Built target testlog
[ 98%] Building CXX object 
autotest/cpp/CMakeFiles/test_osr_set_proj_search_paths.dir/test_osr_set_proj_search_paths.cpp.o

[ 98%] Building CXX object 
autotest/cpp/CMakeFiles/test_osr_set_proj_search_paths.dir/main_gtest.cpp.o
[ 98%] Linking CXX executable test_osr_set_proj_search_paths
[ 98%] Built target test_osr_set_proj_search_paths
[ 98%] Building CXX object 
autotest/cpp/CMakeFiles/proj_with_fork.dir/proj_with_fork.cpp.o
[ 98%] Building CXX object 
autotest/cpp/CMakeFiles/proj_with_fork.dir/main_gtest.cpp.o
[ 98%] Linking CXX executable proj_with_fork
[ 98%] Built target proj_with_fork
[ 98%] Building CXX object 
autotest/CMakeFiles/pytest_runner.dir/pytest_runner.cpp.o
[ 98%] Linking CXX executable pytest_runner
[ 98%] Built target pytest_runner
Segmentation fault
make[2]: *** 
[autotest/CMakeFiles/run_setup_proj_db_tmpdir.dir/build.make:70: 
autotest/CMakeFiles/run_setup_proj_db_tmpdir] Error 1
make[1]: *** [CMakeFiles/Makefile2:12792: 
autotest/CMakeFiles/run_setup_proj_db_tmpdir.dir/all] Error 2
make: *** [Makefile:146: all] Error 2
Thanks.
P.S. OS is Ubuntu22.04 and architecture is aarch64; GDAL is cloned from 
Github
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230215/ac35d82e/attachment-0001.htm>

From even.rouault at spatialys.com  Wed Feb 15 15:44:15 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 16 Feb 2023 00:44:15 +0100
Subject: [gdal-dev] Segmentation fault while compiling
In-Reply-To: <ac3d715ae053.777fa1f843dc7@odyhpc.com>
References: <ac3d715ae053.777fa1f843dc7@odyhpc.com>
Message-ID: <090e9fae-2e01-740f-9648-0b5e87a6b1e2@spatialys.com>

This is a new Python script that runs the Python bindings and use PROJ 
functionality. Aren't you running into the issue of having 2 PROJ 
versions described in https://github.com/OSGeo/gdal/pull/7250?

If you don't need to run GDAL tests, you can add -DBUILD_TESTING=OFF to 
your CMake invokation and that will avoid running this script. But the 
crash indicates something fishy that might hit you at execution of your 
GDAL build

Le 16/02/2023 ? 00:20, afernandez a ?crit?:
> Hello,
> I'm trying to compile GDAL from source in order to include the KEA 
> components. My attempt at compiling (configured simply with /cmake .. 
> -DCMAKE_INSTALL_PREFIX=/usr/) failed towards the end with a 
> segmentation fault error, which I cannot figure out
> /.../
> /[ 98%] Built target testlog/
> /[ 98%] Building CXX object 
> autotest/cpp/CMakeFiles/test_osr_set_proj_search_paths.dir/test_osr_set_proj_search_paths.cpp.o/
> /[ 98%] Building CXX object 
> autotest/cpp/CMakeFiles/test_osr_set_proj_search_paths.dir/main_gtest.cpp.o/
> /[ 98%] Linking CXX executable test_osr_set_proj_search_paths/
> /[ 98%] Built target test_osr_set_proj_search_paths/
> /[ 98%] Building CXX object 
> autotest/cpp/CMakeFiles/proj_with_fork.dir/proj_with_fork.cpp.o/
> /[ 98%] Building CXX object 
> autotest/cpp/CMakeFiles/proj_with_fork.dir/main_gtest.cpp.o/
> /[ 98%] Linking CXX executable proj_with_fork/
> /[ 98%] Built target proj_with_fork/
> /[ 98%] Building CXX object 
> autotest/CMakeFiles/pytest_runner.dir/pytest_runner.cpp.o/
> /[ 98%] Linking CXX executable pytest_runner/
> /[ 98%] Built target pytest_runner/
> /Segmentation fault/
> /make[2]: *** 
> [autotest/CMakeFiles/run_setup_proj_db_tmpdir.dir/build.make:70: 
> autotest/CMakeFiles/run_setup_proj_db_tmpdir] Error 1/
> /make[1]: *** [CMakeFiles/Makefile2:12792: 
> autotest/CMakeFiles/run_setup_proj_db_tmpdir.dir/all] Error 2/
> /make: *** [Makefile:146: all] Error 2/
> Thanks.
> P.S. OS is Ubuntu22.04 and architecture is aarch64; GDAL is cloned 
> from Github
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230216/8d40a729/attachment.htm>

From jluis at ualg.pt  Wed Feb 15 16:06:20 2023
From: jluis at ualg.pt (=?utf-8?B?Sm9hcXVpbSBNYW51ZWwgRnJlaXJlIEx1w61z?=)
Date: Thu, 16 Feb 2023 00:06:20 +0000
Subject: [gdal-dev] Segmentation fault while compiling
In-Reply-To: <090e9fae-2e01-740f-9648-0b5e87a6b1e2@spatialys.com>
References: <ac3d715ae053.777fa1f843dc7@odyhpc.com>
 <090e9fae-2e01-740f-9648-0b5e87a6b1e2@spatialys.com>
Message-ID: <HE1PR0402MB2780BA57C9ECAEC185EA3EDEA6A09@HE1PR0402MB2780.eurprd04.prod.outlook.com>

Funny, I just got that same error (Windows). Apparently not fatal as I could do
ninja install
and all apparently went well

From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Even Rouault
Sent: Wednesday, February 15, 2023 11:44 PM
To: afernandez <afernandez at odyhpc.com>; gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Segmentation fault while compiling


This is a new Python script that runs the Python bindings and use PROJ functionality. Aren't you running into the issue of having 2 PROJ versions described in https://github.com/OSGeo/gdal/pull/7250?

If you don't need to run GDAL tests, you can add -DBUILD_TESTING=OFF to your CMake invokation and that will avoid running this script. But the crash indicates something fishy that might hit you at execution of your GDAL build
Le 16/02/2023 ? 00:20, afernandez a ?crit :
Hello,
I'm trying to compile GDAL from source in order to include the KEA components. My attempt at compiling (configured simply with cmake .. -DCMAKE_INSTALL_PREFIX=/usr) failed towards the end with a segmentation fault error, which I cannot figure out
...
[ 98%] Built target testlog
[ 98%] Building CXX object autotest/cpp/CMakeFiles/test_osr_set_proj_search_paths.dir/test_osr_set_proj_search_paths.cpp.o
[ 98%] Building CXX object autotest/cpp/CMakeFiles/test_osr_set_proj_search_paths.dir/main_gtest.cpp.o
[ 98%] Linking CXX executable test_osr_set_proj_search_paths
[ 98%] Built target test_osr_set_proj_search_paths
[ 98%] Building CXX object autotest/cpp/CMakeFiles/proj_with_fork.dir/proj_with_fork.cpp.o
[ 98%] Building CXX object autotest/cpp/CMakeFiles/proj_with_fork.dir/main_gtest.cpp.o
[ 98%] Linking CXX executable proj_with_fork
[ 98%] Built target proj_with_fork
[ 98%] Building CXX object autotest/CMakeFiles/pytest_runner.dir/pytest_runner.cpp.o
[ 98%] Linking CXX executable pytest_runner
[ 98%] Built target pytest_runner
Segmentation fault
make[2]: *** [autotest/CMakeFiles/run_setup_proj_db_tmpdir.dir/build.make:70: autotest/CMakeFiles/run_setup_proj_db_tmpdir] Error 1
make[1]: *** [CMakeFiles/Makefile2:12792: autotest/CMakeFiles/run_setup_proj_db_tmpdir.dir/all] Error 2
make: *** [Makefile:146: all] Error 2
Thanks.
P.S. OS is Ubuntu22.04 and architecture is aarch64; GDAL is cloned from Github




_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

https://lists.osgeo.org/mailman/listinfo/gdal-dev

--

http://www.spatialys.com

My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230216/305a422f/attachment-0001.htm>

From afernandez at odyhpc.com  Wed Feb 15 18:04:40 2023
From: afernandez at odyhpc.com (afernandez)
Date: Thu, 16 Feb 2023 02:04:40 +0000
Subject: [gdal-dev] Segmentation fault while compiling
References: <ac3d715ae053.777fa1f843dc7@odyhpc.com>
 <090e9fae-2e01-740f-9648-0b5e87a6b1e2@spatialys.com>
Message-ID: <5493bbb54a01f.4c7ba9914a99b@odyhpc.com>

The problem doesn't seem to be about having 2 copies of PROJ as I checked. I was able to compile v3.6.2 w/o this issue so it might be something in the master branch (maybe the python script that you mention).
Even Rouault wrote:
This is a new Python script that runs the Python bindings and use PROJ functionality. Aren't you running into the issue of having 2 PROJ versions described in https://github.com/OSGeo/gdal/pull/7250 <https://github.com/OSGeo/gdal/pull/7250> ?
If you don't need to run GDAL tests, you can add -DBUILD_TESTING=OFF to your CMake invokation and that will avoid running this script. But the crash indicates something fishy that might hit you at execution of your GDAL build
Le 16/02/2023 ? 00:20, afernandez a ?crit :
Hello,
I'm trying to compile GDAL from source in order to include the KEA components. My attempt at compiling (configured simply with cmake .. -DCMAKE_INSTALL_PREFIX=/usr) failed towards the end with a segmentation fault error, which I cannot figure out 
...
[ 98%] Built target testlog
[ 98%] Building CXX object autotest/cpp/CMakeFiles/test_osr_set_proj_search_paths.dir/test_osr_set_proj_search_paths.cpp.o
[ 98%] Building CXX object autotest/cpp/CMakeFiles/test_osr_set_proj_search_paths.dir/main_gtest.cpp.o
[ 98%] Linking CXX executable test_osr_set_proj_search_paths
[ 98%] Built target test_osr_set_proj_search_paths
[ 98%] Building CXX object autotest/cpp/CMakeFiles/proj_with_fork.dir/proj_with_fork.cpp.o
[ 98%] Building CXX object autotest/cpp/CMakeFiles/proj_with_fork.dir/main_gtest.cpp.o
[ 98%] Linking CXX executable proj_with_fork
[ 98%] Built target proj_with_fork
[ 98%] Building CXX object autotest/CMakeFiles/pytest_runner.dir/pytest_runner.cpp.o
[ 98%] Linking CXX executable pytest_runner
[ 98%] Built target pytest_runner
Segmentation fault
make[2]: *** [autotest/CMakeFiles/run_setup_proj_db_tmpdir.dir/build.make:70: autotest/CMakeFiles/run_setup_proj_db_tmpdir] Error 1
make[1]: *** [CMakeFiles/Makefile2:12792: autotest/CMakeFiles/run_setup_proj_db_tmpdir.dir/all] Error 2
make: *** [Makefile:146: all] Error 2
Thanks.
P.S. OS is Ubuntu22.04 and architecture is aarch64; GDAL is cloned from Github
_______________________________________________ gdal-dev mailing list gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org> https://lists.osgeo.org/mailman/listinfo/gdal-dev <https://lists.osgeo.org/mailman/listinfo/gdal-dev> -- http://www.spatialys.com <http://www.spatialys.com> My software is free, but my time generally not. 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230216/f6b05037/attachment.htm>

From even.rouault at spatialys.com  Wed Feb 15 18:24:45 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 16 Feb 2023 03:24:45 +0100
Subject: [gdal-dev] Segmentation fault while compiling
In-Reply-To: <5493bbb54a01f.4c7ba9914a99b@odyhpc.com>
References: <ac3d715ae053.777fa1f843dc7@odyhpc.com>
 <090e9fae-2e01-740f-9648-0b5e87a6b1e2@spatialys.com>
 <5493bbb54a01f.4c7ba9914a99b@odyhpc.com>
Message-ID: <627c6879-9ba0-d5ad-2ba1-d7ad1d805f51@spatialys.com>


Le 16/02/2023 ? 03:04, afernandez a ?crit?:
> The problem doesn't seem to be about having 2 copies of PROJ as I 
> checked. I was able to compile v3.6.2 w/o this issue so it might be 
> something in the master branch (maybe the python script that you mention).

Yes this is something recent in the master branch. I've filed an issue 
about that https://github.com/OSGeo/gdal/issues/7252. Not sure how to 
fix it at this point though


-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230216/fda0a751/attachment.htm>

From afernandez at odyhpc.com  Thu Feb 16 04:37:11 2023
From: afernandez at odyhpc.com (afernandez)
Date: Thu, 16 Feb 2023 12:37:11 +0000
Subject: [gdal-dev] Segmentation fault while compiling
References: <ac3d715ae053.777fa1f843dc7@odyhpc.com>
 <090e9fae-2e01-740f-9648-0b5e87a6b1e2@spatialys.com>
 <5493bbb54a01f.4c7ba9914a99b@odyhpc.com>
 <627c6879-9ba0-d5ad-2ba1-d7ad1d805f51@spatialys.com>
Message-ID: <105c5d0c8dee2.bda835465464a@odyhpc.com>

v3.6.2. suffices for my purposes but it's obviously something to check. Thanks.
Even Rouault wrote:
Le 16/02/2023 ? 03:04, afernandez a ?crit :
The problem doesn't seem to be about having 2 copies of PROJ as I checked. I was able to compile v3.6.2 w/o this issue so it might be something in the master branch (maybe the python script that you mention).
Yes this is something recent in the master branch. I've filed an issue about that https://github.com/OSGeo/gdal/issues/7252 <https://github.com/OSGeo/gdal/issues/7252> . Not sure how to fix it at this point though
-- http://www.spatialys.com <http://www.spatialys.com> My software is free, but my time generally not. 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230216/532d97d1/attachment.htm>

From dg0yt at darc.de  Thu Feb 16 08:53:32 2023
From: dg0yt at darc.de (Kai Pastor, DG0YT)
Date: Thu, 16 Feb 2023 17:53:32 +0100
Subject: [gdal-dev] [External] : Re: How to build GDAL without
 dependency on libtiff.so or libjpeg.so
In-Reply-To: <BYAPR10MB336645A8D5561FA56C416C3D93A39@BYAPR10MB3366.namprd10.prod.outlook.com>
References: <BYAPR10MB336632274D94E74439E9D78093A39@BYAPR10MB3366.namprd10.prod.outlook.com>
 <1208a67e-9da3-99d9-9ab2-1b9d51a15abf@spatialys.com>
 <BYAPR10MB336645A8D5561FA56C416C3D93A39@BYAPR10MB3366.namprd10.prod.outlook.com>
Message-ID: <3bec4006-405f-e6b0-963b-b97c60230ad5@darc.de>

The dependency in PROJ is optional. If you build PROJ from source, it is 
under your control.

Am 15.02.23 um 22:36 schrieb Fengting Chen:
>
> Thanks. I later found out that libproj has dependency on libtiff. And 
> since libproj is required by GDAL, basically GDAL indirectly depends 
> on external libtiff.
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230216/51bb4765/attachment.htm>

From even.rouault at spatialys.com  Thu Feb 16 09:47:28 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 16 Feb 2023 18:47:28 +0100
Subject: [gdal-dev] filelock Python dependency now required for Python
 autotest [was Re: Segmentation fault while compiling]
In-Reply-To: <627c6879-9ba0-d5ad-2ba1-d7ad1d805f51@spatialys.com>
References: <ac3d715ae053.777fa1f843dc7@odyhpc.com>
 <090e9fae-2e01-740f-9648-0b5e87a6b1e2@spatialys.com>
 <5493bbb54a01f.4c7ba9914a99b@odyhpc.com>
 <627c6879-9ba0-d5ad-2ba1-d7ad1d805f51@spatialys.com>
Message-ID: <54d84514-c72e-75c1-91a4-0bf60a00b655@spatialys.com>

The issue mentioned below is solved per 
https://github.com/OSGeo/gdal/pull/7257. The solution requires the 
"filelock" Python module to be installed. It has been added to the list 
in autotest/requirements.txt

Le 16/02/2023 ? 03:24, Even Rouault a ?crit?:
>
>
> Le 16/02/2023 ? 03:04, afernandez a ?crit?:
>> The problem doesn't seem to be about having 2 copies of PROJ as I 
>> checked. I was able to compile v3.6.2 w/o this issue so it might be 
>> something in the master branch (maybe the python script that you 
>> mention).
>
> Yes this is something recent in the master branch. I've filed an issue 
> about that https://github.com/OSGeo/gdal/issues/7252. Not sure how to 
> fix it at this point though
>
>
> -- 
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230216/ab706301/attachment-0001.htm>

From pigrecoinfinito at gmail.com  Sun Feb 19 04:05:14 2023
From: pigrecoinfinito at gmail.com (=?UTF-8?Q?Tot=C3=B2_Fiandaca?=)
Date: Sun, 19 Feb 2023 13:05:14 +0100
Subject: [gdal-dev] how to export all the definitions of the relationships
 present in a FileGDB?
Message-ID: <CADk2tEQEv0tpAA=MPtvt216bTbKb0UvZ4yobL0hMBCRa=Njk4Q@mail.gmail.com>

Is it possible to export all the relationship definitions present in a
FileGDB or a GPKG?

with $ ogrinfo -json autotest/ogr/data/filegdb/Domains.gdb I can extract
all the domains, but for the relationships?

A thousand thanks

-- 
*Ing. Salvatore Fiandaca*
*mobile*.:+39 327.493.8955
*m*: *pigrecoinfinito at gmail.com <pigrecoinfinito at gmail.com>*
*C.F*.: FNDSVT71E29Z103G
*P.IVA*: 06597870820
*membro QGIS Italia - http://qgis.it/ <http://qgis.it/>*
*socio GFOSS.it - *http://gfoss.it/
*member OSGeo* - *https://www.osgeo.org/member/fiandaca/*
<https://www.osgeo.org/member/fiandaca/>
*blog:*
* https://pigrecoinfinito.com/ <https://pigrecoinfinito.com/> FB: Co-admin
- https://www.facebook.com/qgis.it/ <https://www.facebook.com/qgis.it/>**
<https://www.facebook.com/qgis.it/> *
*TW:  <http://goog_95411464>**https://twitter.com/totofiandaca
<https://twitter.com/totofiandaca>*

43?51'0.54"N  10?34'27.62"E - EPSG:4326

?Se la conoscenza deve essere aperta a tutti,
perch? mai limitarne l?accesso??
R. Stallman

Questo documento, allegati inclusi, contiene informazioni di propriet? di
FIANDACA SALVATORE e deve essere utilizzato esclusivamente dal destinatario
in relazione alle finalit? per le quali ? stato ricevuto. E' vietata
qualsiasi forma di riproduzione o divulgazione senza l'esplicito consenso
di FIANDACA SALVATORE. Qualora fosse stato ricevuto per errore si prega di
informare tempestivamente il mittente e distruggere la copia in proprio
possesso.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230219/4567624e/attachment.htm>

From jan.heckman at gmail.com  Sun Feb 19 05:10:13 2023
From: jan.heckman at gmail.com (Jan Heckman)
Date: Sun, 19 Feb 2023 14:10:13 +0100
Subject: [gdal-dev] how to export all the definitions of the
 relationships present in a FileGDB?
In-Reply-To: <CADk2tEQEv0tpAA=MPtvt216bTbKb0UvZ4yobL0hMBCRa=Njk4Q@mail.gmail.com>
References: <CADk2tEQEv0tpAA=MPtvt216bTbKb0UvZ4yobL0hMBCRa=Njk4Q@mail.gmail.com>
Message-ID: <CAKMUAtDegYdb6rbLm+_7jBupmuO3FTUeav4A1LwKzXi3PL8Lvw@mail.gmail.com>

I seem to remember that the n:m relationships can be retrieved as a table.
Look in the TOC.
1:n relationships are not stored in GDB as a table, but as a simple foreign
key relationship as far as I remember.
If you were import an n:m relationship(table) into say postgresql,
you would then have to add the needed (primary and foreign key) constraints
manually or programmatically.
With json, I have no clue how to make the relationship table(s) operational
again. Not quite my turf.
Hope this puts you in the right direction,
Jan

On Sun, Feb 19, 2023 at 1:06 PM Tot? Fiandaca <pigrecoinfinito at gmail.com>
wrote:

> Is it possible to export all the relationship definitions present in a
> FileGDB or a GPKG?
>
> with $ ogrinfo -json autotest/ogr/data/filegdb/Domains.gdb I can extract
> all the domains, but for the relationships?
>
> A thousand thanks
>
> --
> *Ing. Salvatore Fiandaca*
> *mobile*.:+39 327.493.8955
> *m*: *pigrecoinfinito at gmail.com <pigrecoinfinito at gmail.com>*
> *C.F*.: FNDSVT71E29Z103G
> *P.IVA*: 06597870820
> *membro QGIS Italia - http://qgis.it/ <http://qgis.it/>*
> *socio GFOSS.it - *http://gfoss.it/
> *member OSGeo* - *https://www.osgeo.org/member/fiandaca/*
> <https://www.osgeo.org/member/fiandaca/>
> *blog:*
> * https://pigrecoinfinito.com/ <https://pigrecoinfinito.com/> FB: Co-admin
> - https://www.facebook.com/qgis.it/ <https://www.facebook.com/qgis.it/>**
> <https://www.facebook.com/qgis.it/> *
> *TW:  <http://goog_95411464>**https://twitter.com/totofiandaca
> <https://twitter.com/totofiandaca>*
>
> 43?51'0.54"N  10?34'27.62"E - EPSG:4326
>
> ?Se la conoscenza deve essere aperta a tutti,
> perch? mai limitarne l?accesso??
> R. Stallman
>
> Questo documento, allegati inclusi, contiene informazioni di propriet? di
> FIANDACA SALVATORE e deve essere utilizzato esclusivamente dal destinatario
> in relazione alle finalit? per le quali ? stato ricevuto. E' vietata
> qualsiasi forma di riproduzione o divulgazione senza l'esplicito consenso
> di FIANDACA SALVATORE. Qualora fosse stato ricevuto per errore si prega
> di informare tempestivamente il mittente e distruggere la copia in proprio
> possesso.
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230219/1bfa1380/attachment.htm>

From even.rouault at spatialys.com  Sun Feb 19 05:47:23 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 19 Feb 2023 14:47:23 +0100
Subject: [gdal-dev] how to export all the definitions of the
 relationships present in a FileGDB?
In-Reply-To: <CADk2tEQEv0tpAA=MPtvt216bTbKb0UvZ4yobL0hMBCRa=Njk4Q@mail.gmail.com>
References: <CADk2tEQEv0tpAA=MPtvt216bTbKb0UvZ4yobL0hMBCRa=Njk4Q@mail.gmail.com>
Message-ID: <02d726a6-6b5e-bdf0-cc64-e2acb55e9b8f@spatialys.com>

Hi,

I've just added support for them in ogrinfo: 
https://github.com/OSGeo/gdal/pull/7271

Even

Le 19/02/2023 ? 13:05, Tot? Fiandaca a ?crit?:
> Is it possible to export all the relationship definitions present in a 
> FileGDB or a GPKG?
>
> with $ ogrinfo -json autotest/ogr/data/filegdb/Domains.gdb I can 
> extract all the domains, but for the relationships?
>
> A thousand thanks
>
> -- 
> *Ing. Salvatore Fiandaca*
> *mobile*.:+39 327.493.8955
> *m*: *pigrecoinfinito at gmail.com <mailto:pigrecoinfinito at gmail.com>*
> *C.F*.: FNDSVT71E29Z103G
> *P.IVA*: 06597870820
> *membro QGIS Italia - http://qgis.it/*
> *socio GFOSS.it - *http://gfoss.it/
> *member OSGeo* - *https://www.osgeo.org/member/fiandaca/* 
> <https://www.osgeo.org/member/fiandaca/>
> *blog:**?https://pigrecoinfinito.com/ <https://pigrecoinfinito.com/>
> FB: Co-admin - 
> https://www.facebook.com/qgis.it/**<https://www.facebook.com/qgis.it/> *
> *TW:<http://goog_95411464>**https://twitter.com/totofiandaca*
>
> 43?51'0.54"N??10?34'27.62"E - EPSG:4326
>
> ?Se la conoscenza deve essere aperta a tutti,
> perch? mai limitarne l?accesso??
> R. Stallman
>
> Questo documento, allegati inclusi, contiene informazioni di propriet? 
> di FIANDACA SALVATORE e deve essere utilizzato esclusivamente dal 
> destinatario in relazione alle finalit? per le quali ? stato ricevuto. 
> E' vietata qualsiasi forma di riproduzione o divulgazione senza 
> l'esplicito consenso di FIANDACA SALVATORE.?Qualora fosse stato 
> ricevuto per errore si prega di informare tempestivamente il mittente 
> e distruggere la copia in proprio possesso.
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230219/cbfef2ec/attachment-0001.htm>

From pigrecoinfinito at gmail.com  Sun Feb 19 07:58:14 2023
From: pigrecoinfinito at gmail.com (=?UTF-8?Q?Tot=C3=B2_Fiandaca?=)
Date: Sun, 19 Feb 2023 16:58:14 +0100
Subject: [gdal-dev] how to export all the definitions of the
 relationships present in a FileGDB?
In-Reply-To: <02d726a6-6b5e-bdf0-cc64-e2acb55e9b8f@spatialys.com>
References: <CADk2tEQEv0tpAA=MPtvt216bTbKb0UvZ4yobL0hMBCRa=Njk4Q@mail.gmail.com>
 <02d726a6-6b5e-bdf0-cc64-e2acb55e9b8f@spatialys.com>
Message-ID: <CADk2tEQZE==fW-F2bCJx0iGET5QsUogDLo28Ddk+UfJVjX0P-A@mail.gmail.com>

Great, thanks!

Il giorno dom 19 feb 2023 alle ore 14:47 Even Rouault <
even.rouault at spatialys.com> ha scritto:

> Hi,
>
> I've just added support for them in ogrinfo:
> https://github.com/OSGeo/gdal/pull/7271
>
> Even
> Le 19/02/2023 ? 13:05, Tot? Fiandaca a ?crit :
>
> Is it possible to export all the relationship definitions present in a
> FileGDB or a GPKG?
>
> with $ ogrinfo -json autotest/ogr/data/filegdb/Domains.gdb I can extract
> all the domains, but for the relationships?
>
> A thousand thanks
>
> --
> *Ing. Salvatore Fiandaca*
> *mobile*.:+39 327.493.8955
> *m*: *pigrecoinfinito at gmail.com <pigrecoinfinito at gmail.com>*
> *C.F*.: FNDSVT71E29Z103G
> *P.IVA*: 06597870820
> *membro QGIS Italia - http://qgis.it/ <http://qgis.it/>*
> *socio GFOSS.it - *http://gfoss.it/
> *member OSGeo* - *https://www.osgeo.org/member/fiandaca/*
> <https://www.osgeo.org/member/fiandaca/>
> *blog:*
> * https://pigrecoinfinito.com/ <https://pigrecoinfinito.com/>  FB:
> Co-admin - https://www.facebook.com/qgis.it/
> <https://www.facebook.com/qgis.it/>**
> <https://www.facebook.com/qgis.it/> *
> *TW:  <http://goog_95411464>**https://twitter.com/totofiandaca
> <https://twitter.com/totofiandaca>*
>
> 43?51'0.54"N  10?34'27.62"E - EPSG:4326
>
> ?Se la conoscenza deve essere aperta a tutti,
> perch? mai limitarne l?accesso??
> R. Stallman
>
> Questo documento, allegati inclusi, contiene informazioni di propriet? di
> FIANDACA SALVATORE e deve essere utilizzato esclusivamente dal destinatario
> in relazione alle finalit? per le quali ? stato ricevuto. E' vietata
> qualsiasi forma di riproduzione o divulgazione senza l'esplicito consenso
> di FIANDACA SALVATORE. Qualora fosse stato ricevuto per errore si prega
> di informare tempestivamente il mittente e distruggere la copia in proprio
> possesso.
>
>
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>

-- 
*Ing. Salvatore Fiandaca*
*mobile*.:+39 327.493.8955
*m*: *pigrecoinfinito at gmail.com <pigrecoinfinito at gmail.com>*
*C.F*.: FNDSVT71E29Z103G
*P.IVA*: 06597870820
*membro QGIS Italia - http://qgis.it/ <http://qgis.it/>*
*socio GFOSS.it - *http://gfoss.it/
*member OSGeo* - *https://www.osgeo.org/member/fiandaca/*
<https://www.osgeo.org/member/fiandaca/>
*blog:*
* https://pigrecoinfinito.com/ <https://pigrecoinfinito.com/> FB: Co-admin
- https://www.facebook.com/qgis.it/ <https://www.facebook.com/qgis.it/>**
<https://www.facebook.com/qgis.it/> *
*TW:  <http://goog_95411464>**https://twitter.com/totofiandaca
<https://twitter.com/totofiandaca>*

43?51'0.54"N  10?34'27.62"E - EPSG:4326

?Se la conoscenza deve essere aperta a tutti,
perch? mai limitarne l?accesso??
R. Stallman

Questo documento, allegati inclusi, contiene informazioni di propriet? di
FIANDACA SALVATORE e deve essere utilizzato esclusivamente dal destinatario
in relazione alle finalit? per le quali ? stato ricevuto. E' vietata
qualsiasi forma di riproduzione o divulgazione senza l'esplicito consenso
di FIANDACA SALVATORE. Qualora fosse stato ricevuto per errore si prega di
informare tempestivamente il mittente e distruggere la copia in proprio
possesso.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230219/a588013b/attachment.htm>

From mdsumner at gmail.com  Sun Feb 19 10:08:01 2023
From: mdsumner at gmail.com (Michael Sumner)
Date: Mon, 20 Feb 2023 05:08:01 +1100
Subject: [gdal-dev] help with (docker) build workflow
Message-ID: <CAAcGz9_QWFavuJ=PhENLYxW_c1qRfPTNSa=wm3NS52ugj5q8cw@mail.gmail.com>

I would like to build GDAL in an image on the basis of a dockerfile used
for CI, I'm confused by the layer process that copies the build outputs for
the final steps

https://github.com/OSGeo/gdal/blob/master/docker/ubuntu-small/Dockerfile#L231

I want to be able to run that image and then do my own builds with cmake -
but the layer COPY process doesn't include cmake or the other prereqs used
above (to save space in the image).

Is it easy to include the build capability as a layer-copy step?

Or is this perhaps a bad idea, I'm looking for the easiest way to get a
build system running with docker - I can unpick the builder/COPY process,
but maybe I'm missing something easy.

Thank you

-- 
Michael Sumner
Software and Database Engineer
Australian Antarctic Division
Hobart, Australia
e-mail: mdsumner at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230220/fdc635ee/attachment.htm>

From daniel.fred.evans at gmail.com  Sun Feb 19 10:36:20 2023
From: daniel.fred.evans at gmail.com (Daniel Evans)
Date: Sun, 19 Feb 2023 18:36:20 +0000
Subject: [gdal-dev] help with (docker) build workflow
In-Reply-To: <CAAcGz9_QWFavuJ=PhENLYxW_c1qRfPTNSa=wm3NS52ugj5q8cw@mail.gmail.com>
References: <CAAcGz9_QWFavuJ=PhENLYxW_c1qRfPTNSa=wm3NS52ugj5q8cw@mail.gmail.com>
Message-ID: <CANnaQaZUu3tU7io7SpDNw7z1kKwRmDiH_3KRG4O5QZCtLbqNdw@mail.gmail.com>

Hi Michael,

The idea of a two-image build like this is explicitly to create a Runner
without all the compile dependencies, reducing the amount of baggage that
users of the Docker image end up having. That's why it doesn't copy over
all the dependencies for compilation, as you note! One of the downsides of
Docker is that everything that occurred in a previous layer is contained
forever, and starting with a fresh image and using COPY gets around that.

Without knowing your aim in detail, I'd say it sounds like you want to be
changing the builder step, modifying it to include whatever extras you need.

Alternatively, if you really do want to be building one or more new images
that include absolutely everything in the builder image, you probably want
to be using Docker's `FROM builder AS xyz` syntax.

Cheers,
Daniel

On Sun, 19 Feb 2023, 18:10 Michael Sumner, <mdsumner at gmail.com> wrote:

> I would like to build GDAL in an image on the basis of a dockerfile used
> for CI, I'm confused by the layer process that copies the build outputs for
> the final steps
>
>
> https://github.com/OSGeo/gdal/blob/master/docker/ubuntu-small/Dockerfile#L231
>
> I want to be able to run that image and then do my own builds with cmake -
> but the layer COPY process doesn't include cmake or the other prereqs used
> above (to save space in the image).
>
> Is it easy to include the build capability as a layer-copy step?
>
> Or is this perhaps a bad idea, I'm looking for the easiest way to get a
> build system running with docker - I can unpick the builder/COPY process,
> but maybe I'm missing something easy.
>
> Thank you
>
> --
> Michael Sumner
> Software and Database Engineer
> Australian Antarctic Division
> Hobart, Australia
> e-mail: mdsumner at gmail.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230219/1d17bb0a/attachment-0001.htm>

From even.rouault at spatialys.com  Sun Feb 19 10:36:46 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 19 Feb 2023 19:36:46 +0100
Subject: [gdal-dev] help with (docker) build workflow
In-Reply-To: <CAAcGz9_QWFavuJ=PhENLYxW_c1qRfPTNSa=wm3NS52ugj5q8cw@mail.gmail.com>
References: <CAAcGz9_QWFavuJ=PhENLYxW_c1qRfPTNSa=wm3NS52ugj5q8cw@mail.gmail.com>
Message-ID: <a9e0b70e-abe2-cd30-d629-cb3737960260@spatialys.com>

Michael,

for your use case, you are only interested in the "builder" image, not 
the "runner" one.

So just build it with something like: docker build . --target builder -t 
whatever_tag_name_you_want

Even

Le 19/02/2023 ? 19:08, Michael Sumner a ?crit?:
> I would like to build GDAL in an image on the basis of a dockerfile 
> used for CI, I'm confused by the layer process that copies the build 
> outputs for the final steps
>
> https://github.com/OSGeo/gdal/blob/master/docker/ubuntu-small/Dockerfile#L231
>
> I want to be able to run that image and then do my own builds with 
> cmake - but the layer COPY process doesn't include cmake or the other 
> prereqs used above (to save space in the image).
>
> Is it easy to include the build capability as a layer-copy step?
>
> Or is this perhaps a bad idea, I'm looking for the easiest way to get 
> a build system running with docker - I can unpick the builder/COPY 
> process, but maybe I'm missing something easy.
>
> Thank you
>
> -- 
> Michael Sumner
> Software and Database Engineer
> Australian Antarctic Division
> Hobart, Australia
> e-mail: mdsumner at gmail.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230219/d9b71bcc/attachment.htm>

From mdsumner at gmail.com  Sun Feb 19 10:48:18 2023
From: mdsumner at gmail.com (Michael Sumner)
Date: Mon, 20 Feb 2023 05:48:18 +1100
Subject: [gdal-dev] help with (docker) build workflow
In-Reply-To: <a9e0b70e-abe2-cd30-d629-cb3737960260@spatialys.com>
References: <CAAcGz9_QWFavuJ=PhENLYxW_c1qRfPTNSa=wm3NS52ugj5q8cw@mail.gmail.com>
 <a9e0b70e-abe2-cd30-d629-cb3737960260@spatialys.com>
Message-ID: <CAAcGz9_Kf5HCJ=q0xwVMXEN9FQE35UbwnP0wf0RaReDe286D2A@mail.gmail.com>

Ah, awesome - thanks Even and Daniel, both very helpful.

Cheers, Mike



On Mon, Feb 20, 2023 at 5:36 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> Michael,
>
> for your use case, you are only interested in the "builder" image, not the
> "runner" one.
>
> So just build it with something like: docker build . --target builder -t
> whatever_tag_name_you_want
>
> Even
> Le 19/02/2023 ? 19:08, Michael Sumner a ?crit :
>
> I would like to build GDAL in an image on the basis of a dockerfile used
> for CI, I'm confused by the layer process that copies the build outputs for
> the final steps
>
>
> https://github.com/OSGeo/gdal/blob/master/docker/ubuntu-small/Dockerfile#L231
>
> I want to be able to run that image and then do my own builds with cmake -
> but the layer COPY process doesn't include cmake or the other prereqs used
> above (to save space in the image).
>
> Is it easy to include the build capability as a layer-copy step?
>
> Or is this perhaps a bad idea, I'm looking for the easiest way to get a
> build system running with docker - I can unpick the builder/COPY process,
> but maybe I'm missing something easy.
>
> Thank you
>
> --
> Michael Sumner
> Software and Database Engineer
> Australian Antarctic Division
> Hobart, Australia
> e-mail: mdsumner at gmail.com
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>

-- 
Michael Sumner
Software and Database Engineer
Australian Antarctic Division
Hobart, Australia
e-mail: mdsumner at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230220/c9c00bed/attachment.htm>

From michael.smith.erdc at gmail.com  Mon Feb 20 03:56:18 2023
From: michael.smith.erdc at gmail.com (michael.smith.erdc at gmail.com)
Date: Mon, 20 Feb 2023 06:56:18 -0500
Subject: [gdal-dev] Is there a way to put config options in a vrt?
Message-ID: <7B4DE729-5FF2-4202-953B-F86CC590F8DE@gmail.com>


Is there a method to add gdal configuration options to a VRT so that they are carried around with it?

For example:
gdalbuildvrt openlandmap_dtm.vrt /vsis3/openlandmap/dtm/dtm.bareearth_ensemble_p10_30m_s_2018_go_epsg4326_v20230210.tif --config AWS_NO_SIGN_REQUEST YES --config AWS_S3_ENDPOINT s3.eu-central-1.wasabisys.com

works as those config options can be set at the command line or an env variables. But when the vrt is separated, it doesn?t. Is there a way to get them added to the vrt so those are applied at runtime?

Mike

Michael Smith
US Army Corps

From afernandez at odyhpc.com  Mon Feb 20 04:43:49 2023
From: afernandez at odyhpc.com (afernandez)
Date: Mon, 20 Feb 2023 12:43:49 +0000
Subject: [gdal-dev] Is there any incompatibility between KEA and HDF5?
Message-ID: <62a1c328c78bc.49deb35585c5c@odyhpc.com>

Hello,
I've been trying to build GDAL from source to add KEA support. The 
configuration goes well and the compilation doesn't report any issue. 
However, gdalinfo keeps outputting the following message:
~/gdal-3.4.3$ gdalinfo --version
GDAL 3.4.3, released 2022/04/22
HDF5-DIAG: Error detected in HDF5 (1.14.0) thread 0:
#000: H5P.c line 1486 in H5Pclose(): not a property list
major: Invalid arguments to routine
minor: Inappropriate type
PropList::~PropList - H5Pclose failed
HDF5-DIAG: Error detected in HDF5 (1.14.0) thread 0:
#000: H5P.c line 1486 in H5Pclose(): not a property list
major: Invalid arguments to routine
minor: Inappropriate type
PropList::~PropList - H5Pclose failed
HDF5-DIAG: Error detected in HDF5 (1.14.0) thread 0:
#000: H5P.c line 1486 in H5Pclose(): not a property list
major: Invalid arguments to routine
minor: Inappropriate type
PropList::~PropList - H5Pclose failed
HDF5-DIAG: Error detected in HDF5 (1.14.0) thread 0:
#000: H5P.c line 1486 in H5Pclose(): not a property list
major: Invalid arguments to routine
minor: Inappropriate type
PropList::~PropList - H5Pclose failed
HDF5-DIAG: Error detected in HDF5 (1.14.0) thread 0:
#000: H5P.c line 1486 in H5Pclose(): not a property list
major: Invalid arguments to routine
minor: Inappropriate type
PropList::~PropList - H5Pclose failed
HDF5-DIAG: Error detected in HDF5 (1.14.0) thread 0:
#000: H5P.c line 1486 in H5Pclose(): not a property list
major: Invalid arguments to routine
minor: Inappropriate type
PropList::~PropList - H5Pclose failed
HDF5-DIAG: Error detected in HDF5 (1.14.0) thread 0:
#000: H5P.c line 1486 in H5Pclose(): not a property list
major: Invalid arguments to routine
minor: Inappropriate type
PropList::~PropList - H5Pclose failed
HDF5-DIAG: Error detected in HDF5 (1.14.0) thread 0:
#000: H5P.c line 1486 in H5Pclose(): not a property list
major: Invalid arguments to routine
minor: Inappropriate type
PropList::~PropList - H5Pclose failed
I have tried several combinations varying GDAL versions (3.4.1, 3.4.3, 
3.6.2), HDF5 (1.14 1.12) or whether the KEA lib is built with or without 
GDAL support. However, it always ends up with the same problem. The error 
message suggests an invalid argument, but I just don't know why this would 
happen when KEA is loaded versus when it's not. [Info: the system is 
running Ubuntu 22.04]
Thanks,
AFernandez
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230220/59d59a36/attachment.htm>

From even.rouault at spatialys.com  Mon Feb 20 05:36:01 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 20 Feb 2023 14:36:01 +0100
Subject: [gdal-dev] Is there a way to put config options in a vrt?
In-Reply-To: <7B4DE729-5FF2-4202-953B-F86CC590F8DE@gmail.com>
References: <7B4DE729-5FF2-4202-953B-F86CC590F8DE@gmail.com>
Message-ID: <ac6ce696-3ac6-305d-2f14-e42368dda1f1@spatialys.com>

Hi Mike,

no you can't specify configuration options in a VRT, since some of them 
have security implications (particularly the GDAL_VRT_ENABLE_PYTHON one 
that could lead to arbitrary code execution, but other ones might also 
have impacts).

One possibility would be to have a syntax like the following where we'd 
embed relevant parameters similarly to what is allowed for /vsicurl/:

/vsis3?no_sign_request=yes&s3_endpoint=s3.eu-central-1.wasabisys.com&object=/openlandmap/dtm/dtm.bareearth_ensemble_p10_30m_s_2018_go_epsg4326_v20230210.tif

But for that particular use case, you can probably just use the existing 
/vsicurl syntax, with a empty_dir=yes option (I realize this particular 
one isn't documented yet in 
https://gdal.org/user/virtual_file_systems.html#vsicurl-http-https-ftp-files-random-access. 
Cf https://github.com/OSGeo/gdal/issues/7163 for a related discussion), 
to avoid probing unexisting side car files:

/vsicurl/empty_dir=yes&url=https://s3.eu-central-1.wasabisys.com/openlandmap/dtm/dtm.bareearth_ensemble_p10_30m_s_2018_go_epsg4326_v20230210.tif

Even

Le 20/02/2023 ? 12:56, michael.smith.erdc at gmail.com a ?crit?:
> Is there a method to add gdal configuration options to a VRT so that they are carried around with it?
>
> For example:
> gdalbuildvrt openlandmap_dtm.vrt /vsis3/openlandmap/dtm/dtm.bareearth_ensemble_p10_30m_s_2018_go_epsg4326_v20230210.tif --config AWS_NO_SIGN_REQUEST YES --config AWS_S3_ENDPOINT s3.eu-central-1.wasabisys.com
>
> works as those config options can be set at the command line or an env variables. But when the vrt is separated, it doesn?t. Is there a way to get them added to the vrt so those are applied at runtime?
>
> Mike
>
> Michael Smith
> US Army Corps
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From sean.gillies at gmail.com  Mon Feb 20 07:42:45 2023
From: sean.gillies at gmail.com (Sean Gillies)
Date: Mon, 20 Feb 2023 08:42:45 -0700
Subject: [gdal-dev] More consistent use of pytest's parameterization in
 autotests
Message-ID: <CAOodmJqJQr0oHkpPK=jsDgfu6S3kQVDsqM298S2Ei31zq+Ka1g@mail.gmail.com>

Hi all,

I just saw a maintainer recommend to a contributor that the contributor
loop over test cases from within a test function and it prompted me to
speak up about a better practice: using pytest parameterization
https://docs.pytest.org/en/6.2.x/parametrize.html#pytest-mark-parametrize-parametrizing-test-functions
.

Using a loop, like at
https://github.com/OSGeo/gdal/blob/master/autotest/gcore/gdal_stats.py#L660,
can hide bugs and add friction to development. In that particular case,
there are 5 different fill values to be checked. If there are different
code paths for each of these values (a worst case scenario) and each has a
small bug, you will have to run the whole test suite 5 times to expose the
5 bugs one at a time. Additionally, these loops fix the order that the
checks are made, and bugs can hide in test order dependency. Ideally,
GDAL's tests run in random order.

In a nutshell, you hoist the loop and list out into a test function
decorator and then pytest discovers and runs all the separate cases. Pytest
doesn't stop on the first failure in the list unless you explicitly tell it
to do so.

# Original GDAL test code
def test_fill_value():
    for fill_val in [0, 1, 32767, 32768, 65535]:
        func(fill_val)
        assert something

# With pytest parameterization
@pytest.mark.parametrize("fill_val", [0, 1, 32767, 32768, 65535])
def test_fill_value(fill_val):
        func(fill_val)
        assert something

I'm not proposing rewrites of old tests, but I think it is worth adopting a
better practice for tests now and in the future.

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230220/06c925fd/attachment.htm>

From daniel.fred.evans at gmail.com  Mon Feb 20 07:57:09 2023
From: daniel.fred.evans at gmail.com (Daniel Evans)
Date: Mon, 20 Feb 2023 15:57:09 +0000
Subject: [gdal-dev] More consistent use of pytest's parameterization in
 autotests
In-Reply-To: <CAOodmJqJQr0oHkpPK=jsDgfu6S3kQVDsqM298S2Ei31zq+Ka1g@mail.gmail.com>
References: <CAOodmJqJQr0oHkpPK=jsDgfu6S3kQVDsqM298S2Ei31zq+Ka1g@mail.gmail.com>
Message-ID: <CANnaQabRXRmVbrv6JK6MztzKNuuRUtpPNy=5z+DN0HVySdqHsA@mail.gmail.com>

> Additionally, these loops fix the order that the checks are made, and bugs can hide in test order dependency.

As we're on the topic of pytest, I'll mention fixtures as a handy
feature for test setup: https://docs.pytest.org/en/6.2.x/fixture.html

I discovered a while back that some parts of the GDAL test suite break
if test order changes, because Test B relies implicitly some state
being left over from Test A. This prevents some possible improvements
like parallelising the test suite for speed (at least, without careful
manual organisation of what can be done in parallel). It was also a
little annoying trying to debug tests that started segfaulting when
the order changed!

Regards,
Daniel

On Mon, 20 Feb 2023 at 15:43, Sean Gillies <sean.gillies at gmail.com> wrote:
>
> Hi all,
>
> I just saw a maintainer recommend to a contributor that the contributor loop over test cases from within a test function and it prompted me to speak up about a better practice: using pytest parameterization https://docs.pytest.org/en/6.2.x/parametrize.html#pytest-mark-parametrize-parametrizing-test-functions.
>
> Using a loop, like at https://github.com/OSGeo/gdal/blob/master/autotest/gcore/gdal_stats.py#L660, can hide bugs and add friction to development. In that particular case, there are 5 different fill values to be checked. If there are different code paths for each of these values (a worst case scenario) and each has a small bug, you will have to run the whole test suite 5 times to expose the 5 bugs one at a time. Additionally, these loops fix the order that the checks are made, and bugs can hide in test order dependency. Ideally, GDAL's tests run in random order.
>
> In a nutshell, you hoist the loop and list out into a test function decorator and then pytest discovers and runs all the separate cases. Pytest doesn't stop on the first failure in the list unless you explicitly tell it to do so.
>
> # Original GDAL test code
> def test_fill_value():
>     for fill_val in [0, 1, 32767, 32768, 65535]:
>         func(fill_val)
>         assert something
>
> # With pytest parameterization
> @pytest.mark.parametrize("fill_val", [0, 1, 32767, 32768, 65535])
> def test_fill_value(fill_val):
>         func(fill_val)
>         assert something
>
> I'm not proposing rewrites of old tests, but I think it is worth adopting a better practice for tests now and in the future.
>
> --
> Sean Gillies
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at spatialys.com  Mon Feb 20 09:52:03 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 20 Feb 2023 18:52:03 +0100
Subject: [gdal-dev] More consistent use of pytest's parameterization in
 autotests
In-Reply-To: <CAOodmJqJQr0oHkpPK=jsDgfu6S3kQVDsqM298S2Ei31zq+Ka1g@mail.gmail.com>
References: <CAOodmJqJQr0oHkpPK=jsDgfu6S3kQVDsqM298S2Ei31zq+Ka1g@mail.gmail.com>
Message-ID: <b00b6325-1d15-41ec-59b2-4cc546fe7586@spatialys.com>

Hi Sean,

I fully agree that pytest.mark.parametrize() is cleaner and the way to 
go, and I use it extensively in new tests. For what you were referring 
too, this was a change in an existing test that used the old for looping 
habits, so I felt it was a bit too much to ask the contributor to 
refactor it.

I've tried to enhance the existing documentation page related to tests 
with recommendations from this email thread and other things from 
related RFCs: https://github.com/OSGeo/gdal/pull/7277

Even

Le 20/02/2023 ? 16:42, Sean Gillies a ?crit?:
> Hi all,
>
> I just saw a maintainer recommend to a contributor that the 
> contributor loop over test cases from within a test function and it 
> prompted me to speak up about a better practice: using pytest 
> parameterization 
> https://docs.pytest.org/en/6.2.x/parametrize.html#pytest-mark-parametrize-parametrizing-test-functions.
>
> Using a loop, like at 
> https://github.com/OSGeo/gdal/blob/master/autotest/gcore/gdal_stats.py#L660, 
> can hide bugs and add friction to development. In that particular 
> case, there are 5 different fill values to be checked. If there are 
> different code paths for each of these values (a worst case scenario) 
> and each has a small bug, you will have to run the whole test suite 5 
> times to expose the 5 bugs one at a time. Additionally, these loops 
> fix the order that the checks are made, and bugs can hide in test 
> order dependency. Ideally, GDAL's tests run in random order.
>
> In a nutshell, you hoist the loop and list out into a test function 
> decorator and then pytest discovers and runs all the separate cases. 
> Pytest doesn't stop on the first failure in the list unless you 
> explicitly tell it to do so.
>
> # Original GDAL test code
> def test_fill_value():
> ??? for fill_val in [0, 1, 32767, 32768, 65535]:
> ??????? func(fill_val)
> ??????? assert something
>
> # With pytest parameterization
> @pytest.mark.parametrize("fill_val", [0, 1, 32767, 32768, 65535])
> def test_fill_value(fill_val):
> ??????? func(fill_val)
> ??????? assert something
>
> I'm not proposing rewrites of old tests, but I think it is worth 
> adopting a better practice for tests now and in the future.
>
> -- 
> Sean Gillies
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230220/3a5082c0/attachment.htm>

From sean.gillies at gmail.com  Mon Feb 20 11:13:37 2023
From: sean.gillies at gmail.com (Sean Gillies)
Date: Mon, 20 Feb 2023 12:13:37 -0700
Subject: [gdal-dev] More consistent use of pytest's parameterization in
 autotests
In-Reply-To: <b00b6325-1d15-41ec-59b2-4cc546fe7586@spatialys.com>
References: <CAOodmJqJQr0oHkpPK=jsDgfu6S3kQVDsqM298S2Ei31zq+Ka1g@mail.gmail.com>
 <b00b6325-1d15-41ec-59b2-4cc546fe7586@spatialys.com>
Message-ID: <CAOodmJrWXHiCupmjtqbGPJOw-ofoWvC2EkAO3Q7i=RB5eU1M=g@mail.gmail.com>

I thought about writing something down, too, but didn't see anything about
writing tests at https://gdal.org/development/testing.html and I decided I
wasn't qualified to start a new section about testing standards.

On Mon, Feb 20, 2023, 10:52 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi Sean,
>
> I fully agree that pytest.mark.parametrize() is cleaner and the way to go,
> and I use it extensively in new tests. For what you were referring too,
> this was a change in an existing test that used the old for looping habits,
> so I felt it was a bit too much to ask the contributor to refactor it.
>
> I've tried to enhance the existing documentation page related to tests
> with recommendations from this email thread and other things from related
> RFCs: https://github.com/OSGeo/gdal/pull/7277
>
> Even
> Le 20/02/2023 ? 16:42, Sean Gillies a ?crit :
>
> Hi all,
>
> I just saw a maintainer recommend to a contributor that the contributor
> loop over test cases from within a test function and it prompted me to
> speak up about a better practice: using pytest parameterization
> https://docs.pytest.org/en/6.2.x/parametrize.html#pytest-mark-parametrize-parametrizing-test-functions
> .
>
> Using a loop, like at
> https://github.com/OSGeo/gdal/blob/master/autotest/gcore/gdal_stats.py#L660,
> can hide bugs and add friction to development. In that particular case,
> there are 5 different fill values to be checked. If there are different
> code paths for each of these values (a worst case scenario) and each has a
> small bug, you will have to run the whole test suite 5 times to expose the
> 5 bugs one at a time. Additionally, these loops fix the order that the
> checks are made, and bugs can hide in test order dependency. Ideally,
> GDAL's tests run in random order.
>
> In a nutshell, you hoist the loop and list out into a test function
> decorator and then pytest discovers and runs all the separate cases. Pytest
> doesn't stop on the first failure in the list unless you explicitly tell it
> to do so.
>
> # Original GDAL test code
> def test_fill_value():
>     for fill_val in [0, 1, 32767, 32768, 65535]:
>         func(fill_val)
>         assert something
>
> # With pytest parameterization
> @pytest.mark.parametrize("fill_val", [0, 1, 32767, 32768, 65535])
> def test_fill_value(fill_val):
>         func(fill_val)
>         assert something
>
> I'm not proposing rewrites of old tests, but I think it is worth adopting
> a better practice for tests now and in the future.
>
> --
> Sean Gillies
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230220/13dcdc08/attachment.htm>

From schwehr at gmail.com  Mon Feb 20 12:15:54 2023
From: schwehr at gmail.com (Kurt Schwehr)
Date: Mon, 20 Feb 2023 12:15:54 -0800
Subject: [gdal-dev] More consistent use of pytest's parameterization in
 autotests
In-Reply-To: <CANnaQabRXRmVbrv6JK6MztzKNuuRUtpPNy=5z+DN0HVySdqHsA@mail.gmail.com>
References: <CAOodmJqJQr0oHkpPK=jsDgfu6S3kQVDsqM298S2Ei31zq+Ka1g@mail.gmail.com>
 <CANnaQabRXRmVbrv6JK6MztzKNuuRUtpPNy=5z+DN0HVySdqHsA@mail.gmail.com>
Message-ID: <CACmBxyvs9xpABrK7z4fR=+KAv8SHhj9f-q5AP5f1v-5oy5MtEg@mail.gmail.com>

Agreed about test interdependency being rough. Internally at work, we have
a test runner that intentionally does not run tests in order.  All the
autotest2 stuff I did should all be order independent.  Sadly, my old tests
are using pythons normal test setup, not pytest.

On Mon, Feb 20, 2023, 7:57 AM Daniel Evans <daniel.fred.evans at gmail.com>
wrote:

> > Additionally, these loops fix the order that the checks are made, and
> bugs can hide in test order dependency.
>
> As we're on the topic of pytest, I'll mention fixtures as a handy
> feature for test setup: https://docs.pytest.org/en/6.2.x/fixture.html
>
> I discovered a while back that some parts of the GDAL test suite break
> if test order changes, because Test B relies implicitly some state
> being left over from Test A. This prevents some possible improvements
> like parallelising the test suite for speed (at least, without careful
> manual organisation of what can be done in parallel). It was also a
> little annoying trying to debug tests that started segfaulting when
> the order changed!
>
> Regards,
> Daniel
>
> On Mon, 20 Feb 2023 at 15:43, Sean Gillies <sean.gillies at gmail.com> wrote:
> >
> > Hi all,
> >
> > I just saw a maintainer recommend to a contributor that the contributor
> loop over test cases from within a test function and it prompted me to
> speak up about a better practice: using pytest parameterization
> https://docs.pytest.org/en/6.2.x/parametrize.html#pytest-mark-parametrize-parametrizing-test-functions
> .
> >
> > Using a loop, like at
> https://github.com/OSGeo/gdal/blob/master/autotest/gcore/gdal_stats.py#L660,
> can hide bugs and add friction to development. In that particular case,
> there are 5 different fill values to be checked. If there are different
> code paths for each of these values (a worst case scenario) and each has a
> small bug, you will have to run the whole test suite 5 times to expose the
> 5 bugs one at a time. Additionally, these loops fix the order that the
> checks are made, and bugs can hide in test order dependency. Ideally,
> GDAL's tests run in random order.
> >
> > In a nutshell, you hoist the loop and list out into a test function
> decorator and then pytest discovers and runs all the separate cases. Pytest
> doesn't stop on the first failure in the list unless you explicitly tell it
> to do so.
> >
> > # Original GDAL test code
> > def test_fill_value():
> >     for fill_val in [0, 1, 32767, 32768, 65535]:
> >         func(fill_val)
> >         assert something
> >
> > # With pytest parameterization
> > @pytest.mark.parametrize("fill_val", [0, 1, 32767, 32768, 65535])
> > def test_fill_value(fill_val):
> >         func(fill_val)
> >         assert something
> >
> > I'm not proposing rewrites of old tests, but I think it is worth
> adopting a better practice for tests now and in the future.
> >
> > --
> > Sean Gillies
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230220/d257dfeb/attachment.htm>

From vijay.kurhade at gmail.com  Tue Feb 21 07:15:07 2023
From: vijay.kurhade at gmail.com (Vijay Kurhade)
Date: Tue, 21 Feb 2023 20:45:07 +0530
Subject: [gdal-dev] OGR2OGR for ungeoreferenced shapefile to geolocated with
 3 points
Message-ID: <CAEcx6ha-F7EMc7Y-CvDuRjWd_gehS9Nn5+U4ScvbohuOyYzNzQ@mail.gmail.com>

Hello,

I have a ungeoreferenced shapefile; 3 geo-cordinates for the area on which
I want to have this file geo-referenced.

Any examples or guidance on how I can use the OGR2OGR library to get this
file geo-referenced with those 3 points.

If required will share the shapefile, 3 points.

Thanks in advance.

Regards-
Vijay
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230221/439b0952/attachment.htm>

From even.rouault at spatialys.com  Tue Feb 21 07:36:34 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 21 Feb 2023 16:36:34 +0100
Subject: [gdal-dev] OGR2OGR for ungeoreferenced shapefile to geolocated
 with 3 points
In-Reply-To: <CAEcx6ha-F7EMc7Y-CvDuRjWd_gehS9Nn5+U4ScvbohuOyYzNzQ@mail.gmail.com>
References: <CAEcx6ha-F7EMc7Y-CvDuRjWd_gehS9Nn5+U4ScvbohuOyYzNzQ@mail.gmail.com>
Message-ID: <ea7f842d-d987-85e2-a885-256cfd2fb850@spatialys.com>

Cf the -gcp, -order and -tps options of 
https://gdal.org/programs/ogr2ogr.html. And -a_srs to assign a CRS.

Le 21/02/2023 ? 16:15, Vijay Kurhade a ?crit?:
> Hello,
>
> I have a ungeoreferenced shapefile; 3 geo-cordinates for the area on 
> which I want to have this file geo-referenced.
>
> Any examples or guidance on how I can use the OGR2OGR library to get 
> this file geo-referenced with those 3 points.
>
> If required will share the shapefile, 3 points.
>
> Thanks in advance.
>
> Regards-
> Vijay
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From mroa at vols.utk.edu  Tue Feb 21 08:38:58 2023
From: mroa at vols.utk.edu (Roa Carvajal, Camila)
Date: Tue, 21 Feb 2023 11:38:58 -0500
Subject: [gdal-dev] Terrain Analysis
Message-ID: <CAPCXYyiAk7s6DADwS=M9Ra2H4z_xmoFL7CoRafqQBzwTgfmgig@mail.gmail.com>

Hi,

Recently I used gdaldem to compute slope and aspect from a Digital
Elevation Model. In the past I've used SAGA GIS to compute a more extensive
list of terrain parameters but it uses a large amount of memory for heavy
raster files. So I'm looking for a program (or scripts) that does the
computation with GDAL or an associated project. So far I found some of the
computations are implemented in Grass Gis.

I would appreciate any information you can provide.

This is the list of terrain parameters that SAGA computes (
https://saga-gis.sourceforge.io/saga_tool_doc/2.1.3/ta_compound_0.html):


   - Analytical Hillshading
   - Slope
   - Aspect
   - Plan Curvature
   - Profile Curvature
   - Convergence Index
   - Closed Depressions
   - Catchment Area
   - Topographic Wetness Index
   - LS-Factor
   - Channel Network Base Level
   - Channel Network Distance
   - Valley Depth
   - Relative Slope Position

Thanks,

Camila Roa
Graduate Research Assistant @ GCLab
University of Tennessee
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230221/a1c6018c/attachment.htm>

From lnicola at dend.ro  Tue Feb 21 08:54:07 2023
From: lnicola at dend.ro (=?UTF-8?Q?Lauren=C8=9Biu_Nicola?=)
Date: Tue, 21 Feb 2023 18:54:07 +0200
Subject: [gdal-dev] Terrain Analysis
In-Reply-To: <CAPCXYyiAk7s6DADwS=M9Ra2H4z_xmoFL7CoRafqQBzwTgfmgig@mail.gmail.com>
References: <CAPCXYyiAk7s6DADwS=M9Ra2H4z_xmoFL7CoRafqQBzwTgfmgig@mail.gmail.com>
Message-ID: <690032ae-da47-4997-a2a1-88a9050eab8b@betaapp.fastmail.com>

Hi,

For the first three you can look into gdaldem (https://linux.die.net/man/1/gdaldem).

Regards,
Laurentiu

On Tue, Feb 21, 2023, at 18:38, Roa Carvajal, Camila via gdal-dev wrote:
> Hi, 
> 
> Recently I used gdaldem to compute slope and aspect from a Digital Elevation Model. In the past I've used SAGA GIS to compute a more extensive list of terrain parameters but it uses a large amount of memory for heavy raster files. So I'm looking for a program (or scripts) that does the computation with GDAL or an associated project. So far I found some of the computations are implemented in Grass Gis.
> 
> I would appreciate any information you can provide.
> 
> This is the list of terrain parameters that SAGA computes (https://saga-gis.sourceforge.io/saga_tool_doc/2.1.3/ta_compound_0.html):
> 
> 
>  ? Analytical Hillshading
>  ? Slope
>  ? Aspect
>  ? Plan Curvature
>  ? Profile Curvature
>  ? Convergence Index
>  ? Closed Depressions
>  ? Catchment Area
>  ? Topographic Wetness Index
>  ? LS-Factor
>  ? Channel Network Base Level
>  ? Channel Network Distance
>  ? Valley Depth
>  ? Relative Slope Position
> Thanks,
> 
> Camila Roa
> Graduate Research Assistant @ GCLab
> University of Tennessee
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230221/ca93e51c/attachment-0001.htm>

From public at postholer.com  Tue Feb 21 09:00:57 2023
From: public at postholer.com (Scott)
Date: Tue, 21 Feb 2023 09:00:57 -0800
Subject: [gdal-dev] Terrain Analysis
In-Reply-To: <CAPCXYyiAk7s6DADwS=M9Ra2H4z_xmoFL7CoRafqQBzwTgfmgig@mail.gmail.com>
References: <CAPCXYyiAk7s6DADwS=M9Ra2H4z_xmoFL7CoRafqQBzwTgfmgig@mail.gmail.com>
Message-ID: <b255bd16-1ec3-80bf-102f-2b700c90b4fb@postholer.com>

You can also create a .vrt of your raster(s) and embed python (or C) to 
do the analysis. Any pip package you can find to do analysis can be 
used. VRT also allows for JIT compiling. See the VRT docs for details:

https://gdal.org/drivers/raster/vrt.html

On 2/21/23 08:38, Roa Carvajal, Camila via gdal-dev wrote:
> Hi,
> 
> Recently I used gdaldem to?compute slope and aspect from a Digital 
> Elevation Model. In the past I've used SAGA GIS to compute a more 
> extensive list of terrain parameters but it uses a large amount of 
> memory for heavy raster files. So I'm looking for a program (or scripts) 
> that does the computation with GDAL or an associated project. So far I 
> found some of the computations are implemented in Grass Gis.
> 
> I would appreciate any information you can provide.
> 
> This is the list of terrain parameters that SAGA computes 
> (https://saga-gis.sourceforge.io/saga_tool_doc/2.1.3/ta_compound_0.html 
> <https://saga-gis.sourceforge.io/saga_tool_doc/2.1.3/ta_compound_0.html>):
> 
>   * Analytical Hillshading
>   * Slope
>   * Aspect
>   * Plan Curvature
>   * Profile Curvature
>   * Convergence Index
>   * Closed Depressions
>   * Catchment Area
>   * Topographic Wetness Index
>   * LS-Factor
>   * Channel Network Base Level
>   * Channel Network Distance
>   * Valley Depth
>   * Relative Slope Position
> 
> Thanks,
> 
> Camila Roa
> Graduate Research Assistant @ GCLab
> University of Tennessee
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From neteler at osgeo.org  Tue Feb 21 12:29:14 2023
From: neteler at osgeo.org (Markus Neteler)
Date: Tue, 21 Feb 2023 21:29:14 +0100
Subject: [gdal-dev] Terrain Analysis
In-Reply-To: <CAPCXYyiAk7s6DADwS=M9Ra2H4z_xmoFL7CoRafqQBzwTgfmgig@mail.gmail.com>
References: <CAPCXYyiAk7s6DADwS=M9Ra2H4z_xmoFL7CoRafqQBzwTgfmgig@mail.gmail.com>
Message-ID: <CALFmHhu_kjpc+jY9QWT4CJD5nSKQzWVy9Wd3hEsUZivY=OWQKA@mail.gmail.com>

Hi Camila,

On Tue, Feb 21, 2023 at 5:39 PM Roa Carvajal, Camila via gdal-dev
<gdal-dev at lists.osgeo.org> wrote:
>
> Hi,
>
> Recently I used gdaldem to compute slope and aspect from a Digital Elevation Model. In the past I've used SAGA GIS to compute a more extensive list of terrain parameters but it uses a large amount of memory for heavy raster files. So I'm looking for a program (or scripts) that does the computation with GDAL or an associated project. So far I found some of the computations are implemented in Grass Gis.

FYI:
I have turned your list below into a new overview related to your list
below and what else is possible with GRASS GIS:

https://grasswiki.osgeo.org/wiki/Terrain_analysis

Maybe useful in addition to gdaldem (https://gdal.org/programs/gdaldem.html).

Best,
Markus

-- 
Markus Neteler, PhD
https://www.mundialis.de - free data with free software
https://grass.osgeo.org
https://courses.neteler.org/blog

> I would appreciate any information you can provide.
>
> This is the list of terrain parameters that SAGA computes (https://saga-gis.sourceforge.io/saga_tool_doc/2.1.3/ta_compound_0.html):
>
> Analytical Hillshading
> Slope
> Aspect
> Plan Curvature
> Profile Curvature
> Convergence Index
> Closed Depressions
> Catchment Area
> Topographic Wetness Index
> LS-Factor
> Channel Network Base Level
> Channel Network Distance
> Valley Depth
> Relative Slope Position
>
> Thanks,
>
> Camila Roa
> Graduate Research Assistant @ GCLab
> University of Tennessee
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at spatialys.com  Wed Feb 22 01:19:58 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 22 Feb 2023 10:19:58 +0100
Subject: [gdal-dev] Motion: adopt RFC 93: OGRLayer::UpdateFeature() method
Message-ID: <42b36369-2622-a1e1-4e68-b1e31949d1cf@spatialys.com>

Hi,

Motion: adopt RFC 93: OGRLayer::UpdateFeature() method

https://github.com/OSGeo/gdal/pull/7249

Starting with my +1

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From jukka.rahkonen at maanmittauslaitos.fi  Wed Feb 22 01:47:33 2023
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Wed, 22 Feb 2023 09:47:33 +0000
Subject: [gdal-dev] Motion: adopt RFC 93: OGRLayer::UpdateFeature()
 method
In-Reply-To: <42b36369-2622-a1e1-4e68-b1e31949d1cf@spatialys.com>
References: <42b36369-2622-a1e1-4e68-b1e31949d1cf@spatialys.com>
Message-ID: <AM0PR09MB321996170B9AE57295D3C394FDAA9@AM0PR09MB3219.eurprd09.prod.outlook.com>

+1

-Jukka Rahkonen-

-----Alkuper?inen viesti-----
L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Even Rouault
L?hetetty: keskiviikko 22. helmikuuta 2023 11.20
Vastaanottaja: gdal-dev at lists.osgeo.org
Aihe: [gdal-dev] Motion: adopt RFC 93: OGRLayer::UpdateFeature() method

Hi,

Motion: adopt RFC 93: OGRLayer::UpdateFeature() method



Starting with my +1

Even

-- 
https://eur06.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.spatialys.com%2F&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7Cc550a9b60823465040ba08db14b60aca%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C0%7C638126544320978348%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=1AJqr89vSikHbbuVMoGhrEi9HjRaZoHEK3BgcdnuiPs%3D&reserved=0
My software is free, but my time generally not.

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7Cc550a9b60823465040ba08db14b60aca%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C0%7C638126544321134584%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=HbTFkCjHfrasnoMPX0zjFUxVM1sDqq7jcE3%2FTy8MrCo%3D&reserved=0

From mateusz at loskot.net  Wed Feb 22 06:23:08 2023
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed, 22 Feb 2023 15:23:08 +0100
Subject: [gdal-dev] Motion: adopt RFC 93: OGRLayer::UpdateFeature()
 method
In-Reply-To: <42b36369-2622-a1e1-4e68-b1e31949d1cf@spatialys.com>
References: <42b36369-2622-a1e1-4e68-b1e31949d1cf@spatialys.com>
Message-ID: <CABUeae_+HTBG=_yyQopkFDw0EZPocWBXeuwqTmDAbpGBBmhPfg@mail.gmail.com>

+1 Mateusz

On Wed, 22 Feb 2023 at 10:20, Even Rouault <even.rouault at spatialys.com> wrote:
>
> Hi,
>
> Motion: adopt RFC 93: OGRLayer::UpdateFeature() method
>
> https://github.com/OSGeo/gdal/pull/7249
>
> Starting with my +1
>
> Even
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Mateusz Loskot, http://mateusz.loskot.net

From rob.hewy at gmail.com  Wed Feb 22 10:55:28 2023
From: rob.hewy at gmail.com (Robert Hewlett)
Date: Wed, 22 Feb 2023 10:55:28 -0800
Subject: [gdal-dev] CSV driver option to set the quote character for
 input -oo
Message-ID: <CAG_Q50SDAchdu=Nqry512o8YhhMccOZa52zmHP632+Dw2D-DRw@mail.gmail.com>

Hi,

Ran into a problem with a CSV driver where I need more control over setting
the quote character. It may already be there but I cannot find it on the
-oo side. It is there on the writer side -co.

The data is real-world data so it is a mess; unpaired single and double
quotes within a field.

When I use the copy for postgresql at the command line and use '\b' as the
quote character, I can get all the data in. However, the ogr2ogr CSV driver
really wants to pair up the quotes.

Is there a no quote option or a way to set '\b' as the quote character?

Thanks,

Rob
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230222/628a7820/attachment.htm>

From even.rouault at spatialys.com  Wed Feb 22 11:19:18 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 22 Feb 2023 20:19:18 +0100
Subject: [gdal-dev] CSV driver option to set the quote character for
 input -oo
In-Reply-To: <CAG_Q50SDAchdu=Nqry512o8YhhMccOZa52zmHP632+Dw2D-DRw@mail.gmail.com>
References: <CAG_Q50SDAchdu=Nqry512o8YhhMccOZa52zmHP632+Dw2D-DRw@mail.gmail.com>
Message-ID: <bb57acfb-4cd2-e88b-0835-f96a52dd3c15@spatialys.com>

Hi,

Without examples I've some trouble understanding really your issue, but 
there's currently no open option along what you are looking for.

Even

Le 22/02/2023 ? 19:55, Robert Hewlett a ?crit?:
> Hi,
>
> Ran into a problem with a CSV driver where I need more control over 
> setting the quote character. It may already be there but I cannot find 
> it on the -oo side. It is there on the writer side -co.
>
> The data is real-world data so it is a mess; unpaired single and 
> double quotes within a field.
>
> When I use the copy for postgresql at the command line and use '\b' as 
> the quote character, I?can get all the data in. However, the ogr2ogr 
> CSV driver really wants to pair up the quotes.
>
> Is there a no quote option or a way to set '\b' as the quote character?
>
> Thanks,
>
> Rob
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From mdsumner at gmail.com  Wed Feb 22 23:35:23 2023
From: mdsumner at gmail.com (Michael Sumner)
Date: Thu, 23 Feb 2023 18:35:23 +1100
Subject: [gdal-dev] Convert NetCDF to GeoTIFF WGS 84
In-Reply-To: <CABtaONRAqYU8txhSGuwgQWkquyix4vJGdHt=brC2rVEpKLjHvw@mail.gmail.com>
References: <CABtaONRAqYU8txhSGuwgQWkquyix4vJGdHt=brC2rVEpKLjHvw@mail.gmail.com>
Message-ID: <CAAcGz9_ML+59gipghi-kopEANTEecd4JT8uK2or7R7Xy-ukd=g@mail.gmail.com>

in short, take the grid specification you want and pass it to gdalwarp, you
need the subdataset syntax of the particular variable

you need target extent "-te xmin ymin xmax ymax" and  target size "-ts
width height" (or use target resolution "-tr ...."  for a given pixel size)
and -t_srs "EPSG:3857" (a compressed lookup syntax of the full srs string,
see it at the bottom of the WKT)

First check you have a fully fledged srs string in the source "Coordinate
System is:"

gdalinfo NETCDF:"/home/me/netcdf_file.nc":hs

if not you can add it with -a_srs in the gdal_translate step below.

Always a good idea to do a quick test first (take away the -b argument once
you're satisfied to write all bands to the final tif).

gdal_translate NETCDF:"/home/me/netcdf_file.nc":hs -b 1 band1.vrt
gdalwarp band1.vrt  tiff_test.tif -ts 4000 4000 -te -1160000.000
6600000.000 40000.000  7800000.000 -t_srs

We can't advise on the right -a_srs if the "Coordinate System is:" element
is missing in the source gdalinfo, please share that output if you have
follow up questions.  For deeper investigation having the actual file can
be necessary.

Consider the -r argument for resampling by gdalwarp, nearest neighbour is
the default.

Finally, you say "WGS84" but provide Pseudo Mercator world grid - sometimes
"WGS84" means "latitude/longitude ..." - but I've just taken your request
as given. The principle always applies, good extent and srs info for the
input, provide any extent, dimension, srs request for the output and the
warper sorts it out.

HTH, Mike



On Wed, Feb 15, 2023 at 5:12 AM Javier Garcia <tirengarfio at gmail.com> wrote:

> Hi,
>
> I would like to convert the next NetCDF file to a GeoTIFF WGS 84.
>
> NetCDF file `gdalinfo` output:
>
> Driver: netCDF/Network Common Data Format
> Files: /home/me/netcdf_file.nc
> Size is 512, 512
> Metadata:
>   NC_GLOBAL#altimetry=altiCERSAT
>   NC_GLOBAL#altitude_resolution=n/a
>   NC_GLOBAL#area=Ireland 2 min wave grid
>   NC_GLOBAL#BETAMAX=1.52
>   NC_GLOBAL#CICE0=0.25
>   NC_GLOBAL#CICEN=0.75
>   NC_GLOBAL#comment=
>   NC_GLOBAL#contact=waves at mycompany.com
>   NC_GLOBAL#Conventions=CF-1.5
>   NC_GLOBAL#creation_date=2017-07-27T12:20:30Z
>   NC_GLOBAL#data_type=SWASH straight grid
>   NC_GLOBAL#easternmost_longitude=-1.0333328
>   NC_GLOBAL#easting=longitude
>   NC_GLOBAL#field_type=hourly
>   NC_GLOBAL#FLAGTR=4
>   NC_GLOBAL#forcing_ice=iceCFSR
>   NC_GLOBAL#forcing_wind=wndCFSR
>   NC_GLOBAL#forecast_range=analysis
>   NC_GLOBAL#forecast_type=hindcast
>   NC_GLOBAL#grid=irluk-2m
>   NC_GLOBAL#grid_projection=n/a
>   NC_GLOBAL#history=2017-07-27T12:20:30Z : Creation
>   NC_GLOBAL#institution=My Company
>   NC_GLOBAL#institution_references=http://www.mycompany.com/
>   NC_GLOBAL#latitude_resolution=   0.0333333
>   NC_GLOBAL#longitude_resolution=   0.0333333
>   NC_GLOBAL#maximum_altitude=9000 m
>   NC_GLOBAL#minimum_altitude=-12000 m
>   NC_GLOBAL#netcdf_version=netCDF 4.3.0
>   NC_GLOBAL#northernmost_latitude=59.5000000
>   NC_GLOBAL#northing=latitude
>   NC_GLOBAL#product_name=ww3.irluk-2m.199501_hs.nc
>   NC_GLOBAL#product_version=1.0
>   NC_GLOBAL#REFCOAST=0.05
>   NC_GLOBAL#references=http://www.mycompany.com/waves/
>   NC_GLOBAL#REFICEBERG=0.3
>   NC_GLOBAL#REFSUBGRID=0.05
>   NC_GLOBAL#run_time=2017-07-27T12:20:30Z
>   NC_GLOBAL#SDS4 namelist parameter WHITECAPWIDTH=0.30000001
>   NC_GLOBAL#source=TWM WAVEWATCH III (R) v4.18
>   NC_GLOBAL#southernmost_latitude=49.5000000
>   NC_GLOBAL#start_date=1995-01-01T00:00:00Z
>   NC_GLOBAL#stop_date=1995-01-31T23:00:00Z
>   NC_GLOBAL#title=TWM SWASH HINDCAST
>   NC_GLOBAL#WAVEWATCH_III_switches=F90 NOGRB NOPA LRB4 SHRD PR3 UQ FLX0
> LN1 ST4 STAB0 NL1 BT4 DB1 MLIM TR0 BS0 IC0 REF1 XX0 WNT1 WNX1 CRT1 CRX1 O0
> O1 O2 O3 O4 O5 O6 O7 011 NC4 TRKNC IS0
>   NC_GLOBAL#WAVEWATCH_III_version_number=4.18b
>   NC_GLOBAL#westernmost_longitude=-12.0000000
> Subdatasets:
>   SUBDATASET_1_NAME=NETCDF:"/home/me/netcdf_file.nc":MAPSTA
>   SUBDATASET_1_DESC=[301x330] status map (16-bit integer)
>   SUBDATASET_2_NAME=NETCDF:"/home/me/netcdf_file.nc":hs
>   SUBDATASET_2_DESC=[744x301x330] sea_surface_wave_significant_height
> (32-bit floating-point)
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0,  512.0)
> Upper Right (  512.0,    0.0)
> Lower Right (  512.0,  512.0)
> Center      (  256.0,  256.0)
>
>
> I'm expecting as output a file with WGS 84 projection like this:
>
> `gdalinfo` output:
>
>
> Driver: GTiff/GeoTIFF
> Files: tiff_file.tif
> Size is 4000, 4000
> Coordinate System is:
> PROJCRS["WGS 84 / Pseudo-Mercator",
>     BASEGEOGCRS["WGS 84",
>         DATUM["World Geodetic System 1984",
>             ELLIPSOID["WGS 84",6378137,298.257223563,
>                 LENGTHUNIT["metre",1]]],
>         PRIMEM["Greenwich",0,
>             ANGLEUNIT["degree",0.0174532925199433]],
>         ID["EPSG",4326]],
>     CONVERSION["Popular Visualisation Pseudo-Mercator",
>         METHOD["Popular Visualisation Pseudo Mercator",
>             ID["EPSG",1024]],
>         PARAMETER["Latitude of natural origin",0,
>             ANGLEUNIT["degree",0.0174532925199433],
>             ID["EPSG",8801]],
>         PARAMETER["Longitude of natural origin",0,
>             ANGLEUNIT["degree",0.0174532925199433],
>             ID["EPSG",8802]],
>         PARAMETER["False easting",0,
>             LENGTHUNIT["metre",1],
>             ID["EPSG",8806]],
>         PARAMETER["False northing",0,
>             LENGTHUNIT["metre",1],
>             ID["EPSG",8807]]],
>     CS[Cartesian,2],
>         AXIS["easting (X)",east,
>             ORDER[1],
>             LENGTHUNIT["metre",1]],
>         AXIS["northing (Y)",north,
>             ORDER[2],
>             LENGTHUNIT["metre",1]],
>     USAGE[
>         SCOPE["unknown"],
>         AREA["World - 85?S to 85?N"],
>         BBOX[-85.06,-180,85.06,180]],
>     ID["EPSG",3857]]
> Data axis to CRS axis mapping: 1,2
> Origin = (-1160000.000000000000000,7799999.999999998137355)
> Pixel Size = (300.000000000000000,-300.000000000000000)
> Metadata:
>   AREA_OR_POINT=Area
> Image Structure Metadata:
>   COMPRESSION=LZW
>   INTERLEAVE=PIXEL
> Corner Coordinates:
> Upper Left  (-1160000.000, 7800000.000) ( 10d25'13.65"W, 57d11'40.60"N)
> Lower Left  (-1160000.000, 6600000.000) ( 10d25'13.65"W, 50d52'46.07"N)
> Upper Right (   40000.000, 7800000.000) (  0d21'33.57"E, 57d11'40.60"N)
> Lower Right (   40000.000, 6600000.000) (  0d21'33.57"E, 50d52'46.07"N)
> Center      ( -560000.000, 7200000.000) (  5d 1'50.04"W, 54d 9'26.21"N)
> Band 1 Block=4000x1 Type=Byte, ColorInterp=Red
>   Mask Flags: PER_DATASET ALPHA
> Band 2 Block=4000x1 Type=Byte, ColorInterp=Green
>   Mask Flags: PER_DATASET ALPHA
> Band 3 Block=4000x1 Type=Byte, ColorInterp=Blue
>   Mask Flags: PER_DATASET ALPHA
> Band 4 Block=4000x1 Type=Byte, ColorInterp=Alpha
>
>
> Any help will be appreciated.
>
> Javier
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
Michael Sumner
Software and Database Engineer
Australian Antarctic Division
Hobart, Australia
e-mail: mdsumner at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230223/f19044fb/attachment.htm>

From mdsumner at gmail.com  Wed Feb 22 23:36:52 2023
From: mdsumner at gmail.com (Michael Sumner)
Date: Thu, 23 Feb 2023 18:36:52 +1100
Subject: [gdal-dev] Convert NetCDF to GeoTIFF WGS 84
In-Reply-To: <CAAcGz9_ML+59gipghi-kopEANTEecd4JT8uK2or7R7Xy-ukd=g@mail.gmail.com>
References: <CABtaONRAqYU8txhSGuwgQWkquyix4vJGdHt=brC2rVEpKLjHvw@mail.gmail.com>
 <CAAcGz9_ML+59gipghi-kopEANTEecd4JT8uK2or7R7Xy-ukd=g@mail.gmail.com>
Message-ID: <CAAcGz9-6H0iC8XBLGaOS32PKzMXMUFzVeGS6jCUEgvbP6UsM3A@mail.gmail.com>

oh dear I missed a key element in the actual command:

gdalwarp band1.vrt  tiff_test.tif -ts 4000 4000 -te -1160000.000
6600000.000 40000.000  7800000.000 -t_srs "EPSG:3857"

Best

On Thu, Feb 23, 2023 at 6:35 PM Michael Sumner <mdsumner at gmail.com> wrote:

> in short, take the grid specification you want and pass it to gdalwarp,
> you need the subdataset syntax of the particular variable
>
> you need target extent "-te xmin ymin xmax ymax" and  target size "-ts
> width height" (or use target resolution "-tr ...."  for a given pixel size)
> and -t_srs "EPSG:3857" (a compressed lookup syntax of the full srs string,
> see it at the bottom of the WKT)
>
> First check you have a fully fledged srs string in the source "Coordinate
> System is:"
>
> gdalinfo NETCDF:"/home/me/netcdf_file.nc":hs
>
> if not you can add it with -a_srs in the gdal_translate step below.
>
> Always a good idea to do a quick test first (take away the -b argument
> once you're satisfied to write all bands to the final tif).
>
> gdal_translate NETCDF:"/home/me/netcdf_file.nc":hs -b 1 band1.vrt
> gdalwarp band1.vrt  tiff_test.tif -ts 4000 4000 -te -1160000.000
> 6600000.000 40000.000  7800000.000 -t_srs
>
> We can't advise on the right -a_srs if the "Coordinate System is:" element
> is missing in the source gdalinfo, please share that output if you have
> follow up questions.  For deeper investigation having the actual file can
> be necessary.
>
> Consider the -r argument for resampling by gdalwarp, nearest neighbour is
> the default.
>
> Finally, you say "WGS84" but provide Pseudo Mercator world grid -
> sometimes "WGS84" means "latitude/longitude ..." - but I've just taken your
> request as given. The principle always applies, good extent and srs info
> for the input, provide any extent, dimension, srs request for the output
> and the warper sorts it out.
>
> HTH, Mike
>
>
>
> On Wed, Feb 15, 2023 at 5:12 AM Javier Garcia <tirengarfio at gmail.com>
> wrote:
>
>> Hi,
>>
>> I would like to convert the next NetCDF file to a GeoTIFF WGS 84.
>>
>> NetCDF file `gdalinfo` output:
>>
>> Driver: netCDF/Network Common Data Format
>> Files: /home/me/netcdf_file.nc
>> Size is 512, 512
>> Metadata:
>>   NC_GLOBAL#altimetry=altiCERSAT
>>   NC_GLOBAL#altitude_resolution=n/a
>>   NC_GLOBAL#area=Ireland 2 min wave grid
>>   NC_GLOBAL#BETAMAX=1.52
>>   NC_GLOBAL#CICE0=0.25
>>   NC_GLOBAL#CICEN=0.75
>>   NC_GLOBAL#comment=
>>   NC_GLOBAL#contact=waves at mycompany.com
>>   NC_GLOBAL#Conventions=CF-1.5
>>   NC_GLOBAL#creation_date=2017-07-27T12:20:30Z
>>   NC_GLOBAL#data_type=SWASH straight grid
>>   NC_GLOBAL#easternmost_longitude=-1.0333328
>>   NC_GLOBAL#easting=longitude
>>   NC_GLOBAL#field_type=hourly
>>   NC_GLOBAL#FLAGTR=4
>>   NC_GLOBAL#forcing_ice=iceCFSR
>>   NC_GLOBAL#forcing_wind=wndCFSR
>>   NC_GLOBAL#forecast_range=analysis
>>   NC_GLOBAL#forecast_type=hindcast
>>   NC_GLOBAL#grid=irluk-2m
>>   NC_GLOBAL#grid_projection=n/a
>>   NC_GLOBAL#history=2017-07-27T12:20:30Z : Creation
>>   NC_GLOBAL#institution=My Company
>>   NC_GLOBAL#institution_references=http://www.mycompany.com/
>>   NC_GLOBAL#latitude_resolution=   0.0333333
>>   NC_GLOBAL#longitude_resolution=   0.0333333
>>   NC_GLOBAL#maximum_altitude=9000 m
>>   NC_GLOBAL#minimum_altitude=-12000 m
>>   NC_GLOBAL#netcdf_version=netCDF 4.3.0
>>   NC_GLOBAL#northernmost_latitude=59.5000000
>>   NC_GLOBAL#northing=latitude
>>   NC_GLOBAL#product_name=ww3.irluk-2m.199501_hs.nc
>>   NC_GLOBAL#product_version=1.0
>>   NC_GLOBAL#REFCOAST=0.05
>>   NC_GLOBAL#references=http://www.mycompany.com/waves/
>>   NC_GLOBAL#REFICEBERG=0.3
>>   NC_GLOBAL#REFSUBGRID=0.05
>>   NC_GLOBAL#run_time=2017-07-27T12:20:30Z
>>   NC_GLOBAL#SDS4 namelist parameter WHITECAPWIDTH=0.30000001
>>   NC_GLOBAL#source=TWM WAVEWATCH III (R) v4.18
>>   NC_GLOBAL#southernmost_latitude=49.5000000
>>   NC_GLOBAL#start_date=1995-01-01T00:00:00Z
>>   NC_GLOBAL#stop_date=1995-01-31T23:00:00Z
>>   NC_GLOBAL#title=TWM SWASH HINDCAST
>>   NC_GLOBAL#WAVEWATCH_III_switches=F90 NOGRB NOPA LRB4 SHRD PR3 UQ FLX0
>> LN1 ST4 STAB0 NL1 BT4 DB1 MLIM TR0 BS0 IC0 REF1 XX0 WNT1 WNX1 CRT1 CRX1 O0
>> O1 O2 O3 O4 O5 O6 O7 011 NC4 TRKNC IS0
>>   NC_GLOBAL#WAVEWATCH_III_version_number=4.18b
>>   NC_GLOBAL#westernmost_longitude=-12.0000000
>> Subdatasets:
>>   SUBDATASET_1_NAME=NETCDF:"/home/me/netcdf_file.nc":MAPSTA
>>   SUBDATASET_1_DESC=[301x330] status map (16-bit integer)
>>   SUBDATASET_2_NAME=NETCDF:"/home/me/netcdf_file.nc":hs
>>   SUBDATASET_2_DESC=[744x301x330] sea_surface_wave_significant_height
>> (32-bit floating-point)
>> Corner Coordinates:
>> Upper Left  (    0.0,    0.0)
>> Lower Left  (    0.0,  512.0)
>> Upper Right (  512.0,    0.0)
>> Lower Right (  512.0,  512.0)
>> Center      (  256.0,  256.0)
>>
>>
>> I'm expecting as output a file with WGS 84 projection like this:
>>
>> `gdalinfo` output:
>>
>>
>> Driver: GTiff/GeoTIFF
>> Files: tiff_file.tif
>> Size is 4000, 4000
>> Coordinate System is:
>> PROJCRS["WGS 84 / Pseudo-Mercator",
>>     BASEGEOGCRS["WGS 84",
>>         DATUM["World Geodetic System 1984",
>>             ELLIPSOID["WGS 84",6378137,298.257223563,
>>                 LENGTHUNIT["metre",1]]],
>>         PRIMEM["Greenwich",0,
>>             ANGLEUNIT["degree",0.0174532925199433]],
>>         ID["EPSG",4326]],
>>     CONVERSION["Popular Visualisation Pseudo-Mercator",
>>         METHOD["Popular Visualisation Pseudo Mercator",
>>             ID["EPSG",1024]],
>>         PARAMETER["Latitude of natural origin",0,
>>             ANGLEUNIT["degree",0.0174532925199433],
>>             ID["EPSG",8801]],
>>         PARAMETER["Longitude of natural origin",0,
>>             ANGLEUNIT["degree",0.0174532925199433],
>>             ID["EPSG",8802]],
>>         PARAMETER["False easting",0,
>>             LENGTHUNIT["metre",1],
>>             ID["EPSG",8806]],
>>         PARAMETER["False northing",0,
>>             LENGTHUNIT["metre",1],
>>             ID["EPSG",8807]]],
>>     CS[Cartesian,2],
>>         AXIS["easting (X)",east,
>>             ORDER[1],
>>             LENGTHUNIT["metre",1]],
>>         AXIS["northing (Y)",north,
>>             ORDER[2],
>>             LENGTHUNIT["metre",1]],
>>     USAGE[
>>         SCOPE["unknown"],
>>         AREA["World - 85?S to 85?N"],
>>         BBOX[-85.06,-180,85.06,180]],
>>     ID["EPSG",3857]]
>> Data axis to CRS axis mapping: 1,2
>> Origin = (-1160000.000000000000000,7799999.999999998137355)
>> Pixel Size = (300.000000000000000,-300.000000000000000)
>> Metadata:
>>   AREA_OR_POINT=Area
>> Image Structure Metadata:
>>   COMPRESSION=LZW
>>   INTERLEAVE=PIXEL
>> Corner Coordinates:
>> Upper Left  (-1160000.000, 7800000.000) ( 10d25'13.65"W, 57d11'40.60"N)
>> Lower Left  (-1160000.000, 6600000.000) ( 10d25'13.65"W, 50d52'46.07"N)
>> Upper Right (   40000.000, 7800000.000) (  0d21'33.57"E, 57d11'40.60"N)
>> Lower Right (   40000.000, 6600000.000) (  0d21'33.57"E, 50d52'46.07"N)
>> Center      ( -560000.000, 7200000.000) (  5d 1'50.04"W, 54d 9'26.21"N)
>> Band 1 Block=4000x1 Type=Byte, ColorInterp=Red
>>   Mask Flags: PER_DATASET ALPHA
>> Band 2 Block=4000x1 Type=Byte, ColorInterp=Green
>>   Mask Flags: PER_DATASET ALPHA
>> Band 3 Block=4000x1 Type=Byte, ColorInterp=Blue
>>   Mask Flags: PER_DATASET ALPHA
>> Band 4 Block=4000x1 Type=Byte, ColorInterp=Alpha
>>
>>
>> Any help will be appreciated.
>>
>> Javier
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
> --
> Michael Sumner
> Software and Database Engineer
> Australian Antarctic Division
> Hobart, Australia
> e-mail: mdsumner at gmail.com
>


-- 
Michael Sumner
Software and Database Engineer
Australian Antarctic Division
Hobart, Australia
e-mail: mdsumner at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230223/f33f8201/attachment-0001.htm>

From mniemyjski at cloudferro.com  Thu Feb 23 02:39:37 2023
From: mniemyjski at cloudferro.com (Marcin Niemyjski)
Date: Thu, 23 Feb 2023 10:39:37 +0000
Subject: [gdal-dev] How to store files in GDAL cache?
Message-ID: <AS1PR03MB814977C59C22D8F1D6DD62A7A8AB9@AS1PR03MB8149.eurprd03.prod.outlook.com>


Hello,

how to set up folder for VSI cached files?

I'm using this command:

GDAL_CACHEMAX=500 CPL_TMPDIR=/tmp/cache VSI_CACHE=TRUE VSI_CACHE_SIZE=500000000 CPL_VSIL_CURL_CACHE_SIZE=500000000 gdalinfo -checksum /vsicurl/https://s3.waw3-1.cloudferro.com/swift/v1/Cyprus-Test/cog_512.tif

but unfortunatly no files appears in /tmp/cache folder.

Any suggestions?

Thanks,
Marcin




[cid:4b9cc479-04f5-4124-87df-07810f022336]<https://outlook.office.com/bookwithme/user/6347c7def05a478ba013ae948648789d at cloudferro.com?anonymous&ep=signature>           Book time to meet with me<https://outlook.office.com/bookwithme/user/6347c7def05a478ba013ae948648789d at cloudferro.com?anonymous&ep=signature>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230223/b2095121/attachment.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Outlook-dynk2et2.png
Type: image/png
Size: 528 bytes
Desc: Outlook-dynk2et2.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230223/b2095121/attachment.png>

From even.rouault at spatialys.com  Thu Feb 23 05:58:30 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 23 Feb 2023 14:58:30 +0100
Subject: [gdal-dev] How to store files in GDAL cache?
In-Reply-To: <AS1PR03MB814977C59C22D8F1D6DD62A7A8AB9@AS1PR03MB8149.eurprd03.prod.outlook.com>
References: <AS1PR03MB814977C59C22D8F1D6DD62A7A8AB9@AS1PR03MB8149.eurprd03.prod.outlook.com>
Message-ID: <01092f8e-0dc9-27ef-be15-33b279f9f034@spatialys.com>

Marcin,


Le 23/02/2023 ? 11:39, Marcin Niemyjski via gdal-dev a ?crit?:
>
> Hello,
>
> how to set up folder for VSI cached files?

You can't. It's only cached in RAM for the lifetime of the process.


Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230223/eb1bbf57/attachment.htm>

From even.rouault at spatialys.com  Thu Feb 23 07:29:36 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 23 Feb 2023 16:29:36 +0100
Subject: [gdal-dev] CSV driver option to set the quote character for
 input -oo
In-Reply-To: <CAG_Q50SDAchdu=Nqry512o8YhhMccOZa52zmHP632+Dw2D-DRw@mail.gmail.com>
References: <CAG_Q50SDAchdu=Nqry512o8YhhMccOZa52zmHP632+Dw2D-DRw@mail.gmail.com>
Message-ID: <d94e63ee-3994-48f9-b74f-a4e934fc594f@spatialys.com>

Should be fixed per https://github.com/OSGeo/gdal/pull/7305

Even

Le 22/02/2023 ? 19:55, Robert Hewlett a ?crit?:
> Hi,
>
> Ran into a problem with a CSV driver where I need more control over 
> setting the quote character. It may already be there but I cannot find 
> it on the -oo side. It is there on the writer side -co.
>
> The data is real-world data so it is a mess; unpaired single and 
> double quotes within a field.
>
> When I use the copy for postgresql at the command line and use '\b' as 
> the quote character, I?can get all the data in. However, the ogr2ogr 
> CSV driver really wants to pair up the quotes.
>
> Is there a no quote option or a way to set '\b' as the quote character?
>
> Thanks,
>
> Rob
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From Jon.Morris at jbarisk.com  Fri Feb 24 08:37:29 2023
From: Jon.Morris at jbarisk.com (Jon Morris)
Date: Fri, 24 Feb 2023 16:37:29 +0000
Subject: [gdal-dev] FileGDB_COMPILE fails during CMake
Message-ID: <LO2P123MB48614EA5849119B88395E7A582A89@LO2P123MB4861.GBRP123.PROD.OUTLOOK.COM>

Hi all,

I've been upgrading our build script from autotools to CMake and I've almost got it working, except for FileGDB. I've added the cmake parameters  -DFileGDB_ROOT=/usr/local/FileGDB_API -DFileGDB_INCLUDE_DIR=/usr/local/FileGDB_API/include and the paths are correct. The earlier FileGDB install stage is the same as in https://github.com/OSGeo/gdal/blob/release/3.6/.github/workflows/ubuntu_20.04/build-deps.sh.
(I've also tried /usr/include for the include path with the same result).

When I run CMake, I get the following lines in the log (irrelevant lines have been removed):

-- Performing Test TEST_FileGDB_COMPILE
-- Performing Test TEST_FileGDB_COMPILE - Failed
-- Found FileGDB: /usr/local/FileGDB_API/lib/libFileGDBAPI.so

-- Enabled drivers and features and found dependency packages
-- The following features have been enabled:

* ogr_FILEGDB, FileGDB

-- The following OPTIONAL packages have been found:

* FileGDB
   Enable FileGDB (based on closed-source SDK) driver

[ 82%] Building CXX object ogr/ogrsf_frmts/filegdb/CMakeFiles/ogr_FileGDB.dir/FGdbDatasource.cpp.o
[ 82%] Building CXX object ogr/ogrsf_frmts/filegdb/CMakeFiles/ogr_FileGDB.dir/FGdbDriver.cpp.o
[ 82%] Building CXX object ogr/ogrsf_frmts/filegdb/CMakeFiles/ogr_FileGDB.dir/FGdbLayer.cpp.o
[ 82%] Building CXX object ogr/ogrsf_frmts/filegdb/CMakeFiles/ogr_FileGDB.dir/FGdbResultLayer.cpp.o
[ 82%] Building CXX object ogr/ogrsf_frmts/filegdb/CMakeFiles/ogr_FileGDB.dir/FGdbUtils.cpp.o
[ 82%] Built target ogr_FileGDB

[ 94%] Linking CXX shared library libgdal.so
/opt/rh/devtoolset-10/root/usr/libexec/gcc/x86_64-redhat-linux/10/ld: ogr/ogrsf_frmts/filegdb/CMakeFiles/ogr_FileGDB.dir/FGdbDatasource.cpp.o: in function FGdbDataSource::DeleteLayer(int)':
FGdbDatasource.cpp:(.text+0x12b0): undefined reference to `FileGDBAPI::Geodatabase::Delete(std::basic_string<wchar_t, std::char_traits<wchar_t>, std::allocator<wchar_t> > const&, std::basic_string<wchar_t, std::char_traits<wchar_t>, std::allocator<wchar_t> > const&)'

Many more undefined reference errors follow.

Does anyone know what could be going wrong here and what else I can try to debug it? I'm all out of ideas.

Many thanks,

Jon

e: Jon.Morris at jbarisk.com
d:+44 (0)1756 587229
t: +44 (0)1756 799919
www.jbarisk.com
All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system. 
JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, England.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230224/71ec8850/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image913050.png
Type: image/png
Size: 9321 bytes
Desc: image913050.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230224/71ec8850/attachment-0005.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image698461.png
Type: image/png
Size: 651 bytes
Desc: image698461.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230224/71ec8850/attachment-0006.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image868662.png
Type: image/png
Size: 715 bytes
Desc: image868662.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230224/71ec8850/attachment-0007.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image762809.png
Type: image/png
Size: 966 bytes
Desc: image762809.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230224/71ec8850/attachment-0008.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image658687.png
Type: image/png
Size: 784 bytes
Desc: image658687.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230224/71ec8850/attachment-0009.png>

From public at postholer.com  Fri Feb 24 08:44:05 2023
From: public at postholer.com (Scott)
Date: Fri, 24 Feb 2023 08:44:05 -0800
Subject: [gdal-dev] FileGDB_COMPILE fails during CMake
In-Reply-To: <LO2P123MB48614EA5849119B88395E7A582A89@LO2P123MB4861.GBRP123.PROD.OUTLOOK.COM>
References: <LO2P123MB48614EA5849119B88395E7A582A89@LO2P123MB4861.GBRP123.PROD.OUTLOOK.COM>
Message-ID: <cdf2a89f-e541-6df1-3acd-1ea9975041a5@postholer.com>

With gdal >= 3.6 OpenFileGDB is built in by default, no need for 
external API.



On 2/24/23 08:37, Jon Morris wrote:
> Hi all,
> 
> I?ve been upgrading our build script from autotools to CMake and I?ve 
> almost got it working, except for FileGDB. I?ve added the cmake 
> parameters ?-DFileGDB_ROOT=/usr/local/FileGDB_API 
> -DFileGDB_INCLUDE_DIR=/usr/local/FileGDB_API/include and the paths are 
> correct. The earlier FileGDB install stage is the same as in 
> https://github.com/OSGeo/gdal/blob/release/3.6/.github/workflows/ubuntu_20.04/build-deps.sh <https://github.com/OSGeo/gdal/blob/release/3.6/.github/workflows/ubuntu_20.04/build-deps.sh>.
> 
> (I?ve also tried /usr/include for the include path with the same result).
> 
> When I run CMake, I get the following lines in the log (irrelevant lines 
> have been removed):
> 
> -- Performing Test TEST_FileGDB_COMPILE
> 
> -- Performing Test TEST_FileGDB_COMPILE - Failed
> 
> -- Found FileGDB: /usr/local/FileGDB_API/lib/libFileGDBAPI.so
> 
> -- Enabled drivers and features and found dependency packages
> 
> -- The following features have been enabled:
> 
> * ogr_FILEGDB, FileGDB
> 
> -- The following OPTIONAL packages have been found:
> 
> * FileGDB
> 
>  ?? Enable FileGDB (based on closed-source SDK) driver
> 
> [ 82%] Building CXX object 
> ogr/ogrsf_frmts/filegdb/CMakeFiles/ogr_FileGDB.dir/FGdbDatasource.cpp.o
> 
> [ 82%] Building CXX object 
> ogr/ogrsf_frmts/filegdb/CMakeFiles/ogr_FileGDB.dir/FGdbDriver.cpp.o
> 
> [ 82%] Building CXX object 
> ogr/ogrsf_frmts/filegdb/CMakeFiles/ogr_FileGDB.dir/FGdbLayer.cpp.o
> 
> [ 82%] Building CXX object 
> ogr/ogrsf_frmts/filegdb/CMakeFiles/ogr_FileGDB.dir/FGdbResultLayer.cpp.o
> 
> [ 82%] Building CXX object 
> ogr/ogrsf_frmts/filegdb/CMakeFiles/ogr_FileGDB.dir/FGdbUtils.cpp.o
> 
> [ 82%] Built target ogr_FileGDB
> 
> [ 94%] Linking CXX shared library libgdal.so
> 
> /opt/rh/devtoolset-10/root/usr/libexec/gcc/x86_64-redhat-linux/10/ld: 
> ogr/ogrsf_frmts/filegdb/CMakeFiles/ogr_FileGDB.dir/FGdbDatasource.cpp.o: 
> in function FGdbDataSource::DeleteLayer(int)':
> 
> FGdbDatasource.cpp:(.text+0x12b0): undefined reference to 
> `FileGDBAPI::Geodatabase::Delete(std::basic_string<wchar_t, 
> std::char_traits<wchar_t>, std::allocator<wchar_t> > const&, 
> std::basic_string<wchar_t, std::char_traits<wchar_t>, 
> std::allocator<wchar_t> > const&)'
> 
> Many more undefined reference errors follow.
> 
> Does anyone know what could be going wrong here and what else I can try 
> to debug it? I?m all out of ideas.
> 
> Many thanks,
> 
> Jon
> 
> e: ?	*Jon.Morris at jbarisk.com* <mailto:Jon.Morris at jbarisk.com>
> d:	+44?(0)1756?587229
> t: 	*+44?(0)1756?799919* <tel:+44%20(0)1756%20799919>
> 	
> 
> *www.jbarisk.com* <http://www.jbarisk.com/>
> 
> Facebook <https://www.facebook.com/TheFloodPeople>
> 
> 	
> LinkedIn <https://www.linkedin.com/company/jba-risk-management/>
> 
> 	
> Twitter <https://twitter.com/JBARisk>
> 
> 	
> YouTube <https://www.youtube.com/channel/UC0iatom2jYbW96voW0rlpCw>
> 
> 	
> 
> All JBA Risk Management's email messages contain confidential 
> information and are intended only for the individual(s) named. If you 
> are not the named addressee you should not disseminate, distribute or 
> copy this e-mail.
> Please notify the sender immediately by email if you have received this 
> email by mistake and delete this email from your system.
> JBA Risk Management Limited is registered in England, company number 
> 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North 
> Yorkshire, BD23 3FD, England.
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From amadeus84 at verizon.net  Fri Feb 24 21:44:10 2023
From: amadeus84 at verizon.net (Amadeus WM)
Date: Sat, 25 Feb 2023 00:44:10 -0500
Subject: [gdal-dev] create ntif file with NITF_IGEOLO field set
References: <20230225004410.44b13f2f.ref@alpha>
Message-ID: <20230225004410.44b13f2f@alpha>

Hello everyone,

I'm new to GDAL and I'm trying to figure out how to create a NITF file
given the raw data, that also has the NITF_IGEOLO field set. With a
little help from chatGPT I came up with the c++ program below (it has
to be in c++). It writes the file, but it does not contain the
NITF_IGEOLO field. I do set it in the code with
GDALDataset::SetMetadataItem() and it does appear to be set in the
metadata. It just does not show up in the output file, when I inspect
it with gdalinfo -mdd all. 

Can anyone help please? Thank you!

Here is the code

//
// g++ -g -Wall -o nitf nitf.cpp -lgdal
//

#include <gdal/gdal.h>
#include <gdal/gdal_priv.h>

#include <iostream>
#include <cstdlib>

using namespace std;

int main(int argc, char* argv[])
{
    const size_t rows=512, cols=512;
    uint16_t data[rows*cols];

    GDALAllRegister();

    GDALDriver* driver=GetGDALDriverManager()->GetDriverByName("NITF");
    GDALDataset* dataset=driver->Create("out.ntf", rows, cols, 1, GDT_UInt16, 0);

    // We want to add and set NITF_IGEOLO
    dataset->SetMetadataItem("NITF_IGEOLO", "1234");

    // It does get set in the metadata
    auto md=dataset->GetMetadata();
    for (size_t i=0; md[i]!=nullptr; i++)
	cout << md[i] << endl;

    // but does not get written to file
    GDALRasterBand* band=dataset->GetRasterBand(1);
    if (band->RasterIO(GF_Write, 0, 0, rows, cols, (void*)data, rows, cols, GDT_UInt16, 0, 0)==CE_Failure)
	throw "Error";

    GDALClose((GDALDatasetH)dataset);

    return 0;
}

From bradh at frogmouth.net  Fri Feb 24 21:55:54 2023
From: bradh at frogmouth.net (Brad Hards)
Date: Sat, 25 Feb 2023 16:55:54 +1100
Subject: [gdal-dev] create ntif file with NITF_IGEOLO field set
In-Reply-To: <20230225004410.44b13f2f@alpha>
References: <20230225004410.44b13f2f.ref@alpha> <20230225004410.44b13f2f@alpha>
Message-ID: <5651150.DvuYhMxLoT@audax>

On Saturday, 25 February 2023 4:44:10 PM AEDT Amadeus WM via gdal-dev wrote:
> Hello everyone,
> 
> I'm new to GDAL and I'm trying to figure out how to create a NITF file
> given the raw data, that also has the NITF_IGEOLO field set. With a
> little help from chatGPT I came up with the c++ program below (it has
> to be in c++). It writes the file, but it does not contain the
> NITF_IGEOLO field. I do set it in the code with
> GDALDataset::SetMetadataItem() and it does appear to be set in the
> metadata. It just does not show up in the output file, when I inspect
> it with gdalinfo -mdd all.

Probably you need to set it to a real value, and also set the ICORDS value 
that corresponds.

I'm not doing it in C++, but a snippet in python:

    dst_ds = driver.CreateCopy("out.nitf", dataset, strict=0,
                               options=["IC=C8", "FDT=20221129010203", 
"FSCLSY=AS", "ISCLSY=AS", "IDATIM=20210617160900", "ICORDS=D", 
"IGEOLO=+28.563-080.578+28.563-080.577+28.562-080.577+28.562-080.578",  
"ICOM=...."])
    dst_ds = None

Brad





From amadeus84 at verizon.net  Sat Feb 25 14:26:57 2023
From: amadeus84 at verizon.net (Amadeus WM)
Date: Sat, 25 Feb 2023 22:26:57 -0000 (UTC)
Subject: [gdal-dev] create ntif file with NITF_IGEOLO field set
References: <20230225004410.44b13f2f.ref@alpha>
 <20230225004410.44b13f2f@alpha> <5651150.DvuYhMxLoT@audax>
Message-ID: <tte1vh$so3$1@ciao.gmane.io>

Yes, I tried it in python and it works, but it needs to be in C++. 

Following your suggestion, I changed my code like so:

    dataset->SetMetadataItem("NITF_ICORDS", "D");
    dataset->SetMetadataItem("NITF_IGEOLO", 
"+28.563-080.578+28.563-080.577+28.562-080.577+28.562-080.578");

Again, NITF_ICORDS and NITF_GEOLO do get printed in the loop in the code, 
but don't make it in the output file, so no joy yet.




On Sat, 25 Feb 2023 16:55:54 +1100, Brad Hards wrote:

> On Saturday, 25 February 2023 4:44:10 PM AEDT Amadeus WM via gdal-dev
> wrote:
>> Hello everyone,
>> 
>> I'm new to GDAL and I'm trying to figure out how to create a NITF file
>> given the raw data, that also has the NITF_IGEOLO field set. With a
>> little help from chatGPT I came up with the c++ program below (it has
>> to be in c++). It writes the file, but it does not contain the
>> NITF_IGEOLO field. I do set it in the code with
>> GDALDataset::SetMetadataItem() and it does appear to be set in the
>> metadata. It just does not show up in the output file, when I inspect
>> it with gdalinfo -mdd all.
> 
> Probably you need to set it to a real value, and also set the ICORDS
> value that corresponds.
> 
> I'm not doing it in C++, but a snippet in python:
> 
>     dst_ds = driver.CreateCopy("out.nitf", dataset, strict=0,
>                                options=["IC=C8", "FDT=20221129010203",
> "FSCLSY=AS", "ISCLSY=AS", "IDATIM=20210617160900", "ICORDS=D",
> "IGEOLO=+28.563-080.578+28.563-080.577+28.562-080.577+28.562-080.578",
> "ICOM=...."])
>     dst_ds = None
> 
> Brad



From amadeus84 at verizon.net  Sat Feb 25 19:33:31 2023
From: amadeus84 at verizon.net (Amadeus WM)
Date: Sun, 26 Feb 2023 03:33:31 -0000 (UTC)
Subject: [gdal-dev] create ntif file with NITF_IGEOLO field set
References: <20230225004410.44b13f2f.ref@alpha>
 <20230225004410.44b13f2f@alpha> <5651150.DvuYhMxLoT@audax>
Message-ID: <ttejub$j5j$1@ciao.gmane.io>

So I just noticed that if I call 

dataset->SetMetadataItem();

then it creates a file out.ntf.aux.xml and whatever fields I set go in 
there. Both NITF_ICORDS and NITF_IGEOLO are there, and IGEOLO need not be 
a real value, it gets set to whatever I set it to.

Is there any way to put those fields in out.ntf and not in 
out.ntf.aux.xml? What determines where they go?




On Sat, 25 Feb 2023 16:55:54 +1100, Brad Hards wrote:

> On Saturday, 25 February 2023 4:44:10 PM AEDT Amadeus WM via gdal-dev
> wrote:
>> Hello everyone,
>> 
>> I'm new to GDAL and I'm trying to figure out how to create a NITF file
>> given the raw data, that also has the NITF_IGEOLO field set. With a
>> little help from chatGPT I came up with the c++ program below (it has
>> to be in c++). It writes the file, but it does not contain the
>> NITF_IGEOLO field. I do set it in the code with
>> GDALDataset::SetMetadataItem() and it does appear to be set in the
>> metadata. It just does not show up in the output file, when I inspect
>> it with gdalinfo -mdd all.
> 
> Probably you need to set it to a real value, and also set the ICORDS
> value that corresponds.
> 
> I'm not doing it in C++, but a snippet in python:
> 
>     dst_ds = driver.CreateCopy("out.nitf", dataset, strict=0,
>                                options=["IC=C8", "FDT=20221129010203",
> "FSCLSY=AS", "ISCLSY=AS", "IDATIM=20210617160900", "ICORDS=D",
> "IGEOLO=+28.563-080.578+28.563-080.577+28.562-080.577+28.562-080.578",
> "ICOM=...."])
>     dst_ds = None
> 
> Brad



From bradh at frogmouth.net  Sat Feb 25 21:04:16 2023
From: bradh at frogmouth.net (Brad Hards)
Date: Sun, 26 Feb 2023 16:04:16 +1100
Subject: [gdal-dev] create ntif file with NITF_IGEOLO field set
In-Reply-To: <ttejub$j5j$1@ciao.gmane.io>
References: <20230225004410.44b13f2f.ref@alpha> <5651150.DvuYhMxLoT@audax>
 <ttejub$j5j$1@ciao.gmane.io>
Message-ID: <1845898.tdWV9SEqCh@audax>

On Sunday, 26 February 2023 2:33:31 PM AEDT Amadeus WM via gdal-dev wrote:
> So I just noticed that if I call
> 
> dataset->SetMetadataItem();
> 
> then it creates a file out.ntf.aux.xml and whatever fields I set go in
> there. Both NITF_ICORDS and NITF_IGEOLO are there, and IGEOLO need not be
> a real value, it gets set to whatever I set it to.
> 
> Is there any way to put those fields in out.ntf and not in
> out.ntf.aux.xml? What determines where they go?

See https://gdal.org/drivers/raster/nitf.html#creation-issues
in particular, where it says
Most file header, imagery header metadata and security fields can be set with 
appropriate creation options (although they are reported as metadata item, but 
must not be set as metadata). For instance setting ?FTITLE=Image of abandoned 
missile silo south west of Karsk? in the creation option list would result in 
setting of the FTITLE field in the NITF file header. Use the official field names 
from the NITF specification document; do not put the ?NITF_? prefix that is 
reported when asking the metadata list.


Try:
char **papszOptions = NULL;
papszOptions = CSLSetNameValue( papszOptions, "ICORDS", "D" );
papszOptions = CSLSetNameValue( papszOptions, "IGEOLO", 
"+28.563-080.578+28.563-080.577+28.562-080.577+28.562-080.578" );

and pass those options to your Create() call.

I'll say it again: creation options, not metadata.

Brad



From amadeus84 at verizon.net  Sun Feb 26 05:17:11 2023
From: amadeus84 at verizon.net (Amadeus WM)
Date: Sun, 26 Feb 2023 13:17:11 -0000 (UTC)
Subject: [gdal-dev] create ntif file with NITF_IGEOLO field set
References: <20230225004410.44b13f2f.ref@alpha> <5651150.DvuYhMxLoT@audax>
 <ttejub$j5j$1@ciao.gmane.io> <1845898.tdWV9SEqCh@audax>
Message-ID: <ttfm4n$vs4$1@ciao.gmane.io>

Thank you so much, it worked! It's a life saver!


I have read the nitf creation issues before even posting here, and I also 
tried to set the options at creation time like this:

    char** opt=nullptr;
    opt=CSLSetNameValue(opt, "NITF_ICORDS", "D");
    opt=CSLSetNameValue(opt, "NITF_IGEOLO", 
"+28.563-080.578+28.563-080.577+28.562-080.577+28.562-080.578");

    GDALDataset* dataset=driver->Create("out.ntf", rows, cols, 1, 
GDT_UInt16, opt);


but I was getting warnings:

Warning 6: driver NITF does not support creation option NITF_ICORDS
Warning 6: driver NITF does not support creation option NITF_IGEOLO


The one thing I had not payed attention to was the "do not put the NITF_ 
prefix" part. That should be written in bold, huge font size and in red.

Again, thank you very much! Problem solved.





On Sun, 26 Feb 2023 16:04:16 +1100, Brad Hards wrote:

> On Sunday, 26 February 2023 2:33:31 PM AEDT Amadeus WM via gdal-dev
> wrote:
>> So I just noticed that if I call
>> 
>> dataset->SetMetadataItem();
>> 
>> then it creates a file out.ntf.aux.xml and whatever fields I set go in
>> there. Both NITF_ICORDS and NITF_IGEOLO are there, and IGEOLO need not
>> be a real value, it gets set to whatever I set it to.
>> 
>> Is there any way to put those fields in out.ntf and not in
>> out.ntf.aux.xml? What determines where they go?
> 
> See https://gdal.org/drivers/raster/nitf.html#creation-issues in
> particular, where it says Most file header, imagery header metadata and
> security fields can be set with appropriate creation options (although
> they are reported as metadata item, but must not be set as metadata).
> For instance setting ?FTITLE=Image of abandoned missile silo south west
> of Karsk? in the creation option list would result in setting of the
> FTITLE field in the NITF file header. Use the official field names from
> the NITF specification document; do not put the ?NITF_? prefix that is
> reported when asking the metadata list.
> 
> 
> Try:
> char **papszOptions = NULL;
> papszOptions = CSLSetNameValue( papszOptions, "ICORDS", "D" );
> papszOptions = CSLSetNameValue( papszOptions, "IGEOLO",
> "+28.563-080.578+28.563-080.577+28.562-080.577+28.562-080.578" );
> 
> and pass those options to your Create() call.
> 
> I'll say it again: creation options, not metadata.
> 
> Brad
> 
> 
> _______________________________________________
> gdal-dev mailing list gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev



From adamgutonski at protonmail.com  Sun Feb 26 06:12:21 2023
From: adamgutonski at protonmail.com (adamgutonski)
Date: Sun, 26 Feb 2023 14:12:21 +0000
Subject: [gdal-dev] Building distributable files and bindings with CMake
Message-ID: <BuyGaOfI1RQg3HGzDgN_t5iJtmt0z1w5OXl2upYSld9Djja40P9ewh4fFjSTJdl5Gn9pS6SF_QVsBdt4bR3HLq14m0hBGq-4tDuyP0_hoys=@protonmail.com>

Hello,

I am having trouble with CMake and creating the GDAL configuration that I desire. My goal is to be able to distribute GDAL to a few colleagues so they can immediately use the GDAL bindings in Java code without them having to build and install GDAL directly. The GDAL build should be minimal and only include the OpenFileGDB driver.

I run the following CMake configuration and build:

cmake -DCMAKE_BUILD_TYPE=Release -DBUILD_JAVA_BINDINGS=ON -DGDAL_BUILD_OPTIONAL_DRIVERS:BOOL=OFF -DOGR_BUILD_OPTIONAL_DRIVERS:BOOL=OFF -DOGR_ENABLE_DRIVER_OPENFILEGDB:BOOL=ON -DBUILD_PYTHON_BINDINGS=OFF -DBUILD_APPS=NO -DGDAL_USE_EXTERNAL_LIBS=OFF

cmake --build .

After this, I am able to add the Java bindings (.jar) to my Java project on my machine without installing GDAL. After setting java.library.path to the gdalalljni directory (gdal-version/build/swig/java) the bindings work. I want my colleagues to be able to do the same by simply sending them a folder of the build I create. Currently when I send my build to a colleague and they set up their Java project to include the bindings, they get this error:

java.lang.UnsatisfiedLinkError: no gdalalljni in java.library.path

Is it even possible to distribute GDAL this way on MacOS/Ubuntu? Especially given PROJ as a runtime dependency? I would be grateful for any advice about how I can get close to be able to distributing GDAL in this manner. Perhaps using a docker container is the way to go? However I have been unable to find any documentation about how to use the Java bindings with docker since it does not look like they are included in the latest alpine release.

Kind regards,
Adam Gutonski
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230226/a9115612/attachment.htm>

From amadeus84 at verizon.net  Sun Feb 26 06:27:54 2023
From: amadeus84 at verizon.net (Amadeus WM)
Date: Sun, 26 Feb 2023 14:27:54 -0000 (UTC)
Subject: [gdal-dev] create ntif file with NITF_IGEOLO field set
References: <20230225004410.44b13f2f.ref@alpha> <5651150.DvuYhMxLoT@audax>
 <ttejub$j5j$1@ciao.gmane.io> <1845898.tdWV9SEqCh@audax>
Message-ID: <ttfq9a$vs4$2@ciao.gmane.io>

Oh, wait, it does put IGEOLO in the output nitf, but I also get the 
warning:

Warning 6: driver NITF does not support creation option IGEOLO



On Sun, 26 Feb 2023 16:04:16 +1100, Brad Hards wrote:

> On Sunday, 26 February 2023 2:33:31 PM AEDT Amadeus WM via gdal-dev
> wrote:
>> So I just noticed that if I call
>> 
>> dataset->SetMetadataItem();
>> 
>> then it creates a file out.ntf.aux.xml and whatever fields I set go in
>> there. Both NITF_ICORDS and NITF_IGEOLO are there, and IGEOLO need not
>> be a real value, it gets set to whatever I set it to.
>> 
>> Is there any way to put those fields in out.ntf and not in
>> out.ntf.aux.xml? What determines where they go?
> 
> See https://gdal.org/drivers/raster/nitf.html#creation-issues in
> particular, where it says Most file header, imagery header metadata and
> security fields can be set with appropriate creation options (although
> they are reported as metadata item, but must not be set as metadata).
> For instance setting ?FTITLE=Image of abandoned missile silo south west
> of Karsk? in the creation option list would result in setting of the
> FTITLE field in the NITF file header. Use the official field names from
> the NITF specification document; do not put the ?NITF_? prefix that is
> reported when asking the metadata list.
> 
> 
> Try:
> char **papszOptions = NULL;
> papszOptions = CSLSetNameValue( papszOptions, "ICORDS", "D" );
> papszOptions = CSLSetNameValue( papszOptions, "IGEOLO",
> "+28.563-080.578+28.563-080.577+28.562-080.577+28.562-080.578" );
> 
> and pass those options to your Create() call.
> 
> I'll say it again: creation options, not metadata.
> 
> Brad
> 
> 
> _______________________________________________
> gdal-dev mailing list gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev



From bradh at frogmouth.net  Sun Feb 26 22:36:22 2023
From: bradh at frogmouth.net (Brad Hards)
Date: Mon, 27 Feb 2023 17:36:22 +1100
Subject: [gdal-dev] create ntif file with NITF_IGEOLO field set
In-Reply-To: <ttfq9a$vs4$2@ciao.gmane.io>
References: <20230225004410.44b13f2f.ref@alpha> <1845898.tdWV9SEqCh@audax>
 <ttfq9a$vs4$2@ciao.gmane.io>
Message-ID: <4813555.31r3eYUQgx@audax>

On Monday, 27 February 2023 1:27:54 AM AEDT Amadeus WM via gdal-dev wrote:
> Oh, wait, it does put IGEOLO in the output nitf, but I also get the
> warning:
> 
> Warning 6: driver NITF does not support creation option IGEOLO

Clearly it does support it, since it works correctly. The message is a false 
alarm in the version (perhaps Ubuntu packages?) that you are using.

I would recommend:

1. ignoring it.

If Option 1 isn't practical (e.g. it fills your logs), there are two more 
options:

2.  Upgrade gdal to at least 3.5.1. This may require also upgrading cascading 
dependencies depending on your environment.

or 

3. Patch your packages to include the IGEOLO creation option in the list of 
those supported. That looks like:

https://github.com/OSGeo/gdal/blob/master/frmts/nitf/nitfdataset.cpp#L7132-L7135

(although if you're just patching that part in, the "Normally automatically 
set." part isn't true.)

HTH

Brad






From Jon.Morris at jbarisk.com  Mon Feb 27 00:37:05 2023
From: Jon.Morris at jbarisk.com (Jon Morris)
Date: Mon, 27 Feb 2023 08:37:05 +0000
Subject: [gdal-dev] FileGDB_COMPILE fails during CMake
In-Reply-To: <cdf2a89f-e541-6df1-3acd-1ea9975041a5@postholer.com>
References: <LO2P123MB48614EA5849119B88395E7A582A89@LO2P123MB4861.GBRP123.PROD.OUTLOOK.COM>
 <cdf2a89f-e541-6df1-3acd-1ea9975041a5@postholer.com>
Message-ID: <LO2P123MB4861BBD079DA8819B9F1920382AF9@LO2P123MB4861.GBRP123.PROD.OUTLOOK.COM>

Does that mean we should no longer attempt to use the FileGDB API? Our tool makes quite heavy use of FileGDB so we'd have to do something like this every time a user wants to use it:

if GDAL_VERSION >= (3, 6):
    driver = 'OpenFileGDB'
else:
    driver = 'FileGDB'

Jon


e: Jon.Morris at jbarisk.com
d:+44 (0)1756 587229
t: +44 (0)1756 799919
www.jbarisk.com
All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system. 
JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, England.
-----Original Message-----
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Scott
Sent: 24 February 2023 16:44
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] FileGDB_COMPILE fails during CMake

CAUTION: This email originated from outside of JBA and contains one or more links. DO NOT click links unless you recognise the sender's email address and are absolutely certain that the content is safe.
See the Phishing page on IMS on SP for more information about how to spot and report suspicious messages.

With gdal >= 3.6 OpenFileGDB is built in by default, no need for external API.



On 2/24/23 08:37, Jon Morris wrote:
> Hi all,
>
> I?ve been upgrading our build script from autotools to CMake and I?ve 
> almost got it working, except for FileGDB. I?ve added the cmake 
> parameters  -DFileGDB_ROOT=/usr/local/FileGDB_API
> -DFileGDB_INCLUDE_DIR=/usr/local/FileGDB_API/include and the paths are 
> correct. The earlier FileGDB install stage is the same as in 
> https://github.com/OSGeo/gdal/blob/release/3.6/.github/workflows/ubuntu_20.04/build-deps.sh <https://github.com/OSGeo/gdal/blob/release/3.6/.github/workflows/ubuntu_20.04/build-deps.sh>.
>
> (I?ve also tried /usr/include for the include path with the same result).
>
> When I run CMake, I get the following lines in the log (irrelevant 
> lines have been removed):
>
> -- Performing Test TEST_FileGDB_COMPILE
>
> -- Performing Test TEST_FileGDB_COMPILE - Failed
>
> -- Found FileGDB: /usr/local/FileGDB_API/lib/libFileGDBAPI.so
>
> -- Enabled drivers and features and found dependency packages
>
> -- The following features have been enabled:
>
> * ogr_FILEGDB, FileGDB
>
> -- The following OPTIONAL packages have been found:
>
> * FileGDB
>
>     Enable FileGDB (based on closed-source SDK) driver
>
> [ 82%] Building CXX object
> ogr/ogrsf_frmts/filegdb/CMakeFiles/ogr_FileGDB.dir/FGdbDatasource.cpp.
> o
>
> [ 82%] Building CXX object
> ogr/ogrsf_frmts/filegdb/CMakeFiles/ogr_FileGDB.dir/FGdbDriver.cpp.o
>
> [ 82%] Building CXX object
> ogr/ogrsf_frmts/filegdb/CMakeFiles/ogr_FileGDB.dir/FGdbLayer.cpp.o
>
> [ 82%] Building CXX object
> ogr/ogrsf_frmts/filegdb/CMakeFiles/ogr_FileGDB.dir/FGdbResultLayer.cpp
> .o
>
> [ 82%] Building CXX object
> ogr/ogrsf_frmts/filegdb/CMakeFiles/ogr_FileGDB.dir/FGdbUtils.cpp.o
>
> [ 82%] Built target ogr_FileGDB
>
> [ 94%] Linking CXX shared library libgdal.so
>
> /opt/rh/devtoolset-10/root/usr/libexec/gcc/x86_64-redhat-linux/10/ld:
> ogr/ogrsf_frmts/filegdb/CMakeFiles/ogr_FileGDB.dir/FGdbDatasource.cpp.o:
> in function FGdbDataSource::DeleteLayer(int)':
>
> FGdbDatasource.cpp:(.text+0x12b0): undefined reference to 
> `FileGDBAPI::Geodatabase::Delete(std::basic_string<wchar_t,
> std::char_traits<wchar_t>, std::allocator<wchar_t> > const&, 
> std::basic_string<wchar_t, std::char_traits<wchar_t>, 
> std::allocator<wchar_t> > const&)'
>
> Many more undefined reference errors follow.
>
> Does anyone know what could be going wrong here and what else I can 
> try to debug it? I?m all out of ideas.
>
> Many thanks,
>
> Jon
>
> e: ?  *Jon.Morris at jbarisk.com* <mailto:Jon.Morris at jbarisk.com>
> d:    +44 (0)1756 587229
> t:    *+44 (0)1756 799919* <tel:+44%20(0)1756%20799919>
>
>
> *www.jbarisk.com* <http://www.jbarisk.com/>
>
> Facebook <https://www.facebook.com/TheFloodPeople>
>
>
> LinkedIn <https://www.linkedin.com/company/jba-risk-management/>
>
>
> Twitter <https://twitter.com/JBARisk>
>
>
> YouTube <https://www.youtube.com/channel/UC0iatom2jYbW96voW0rlpCw>
>
>
>
> All JBA Risk Management's email messages contain confidential 
> information and are intended only for the individual(s) named. If you 
> are not the named addressee you should not disseminate, distribute or 
> copy this e-mail.
> Please notify the sender immediately by email if you have received 
> this email by mistake and delete this email from your system.
> JBA Risk Management Limited is registered in England, company number 
> 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North 
> Yorkshire, BD23 3FD, England.
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230227/6fe01bfc/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image921419.png
Type: image/png
Size: 9321 bytes
Desc: image921419.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230227/6fe01bfc/attachment-0005.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image602514.png
Type: image/png
Size: 651 bytes
Desc: image602514.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230227/6fe01bfc/attachment-0006.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image354811.png
Type: image/png
Size: 715 bytes
Desc: image354811.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230227/6fe01bfc/attachment-0007.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image392918.png
Type: image/png
Size: 966 bytes
Desc: image392918.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230227/6fe01bfc/attachment-0008.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image898252.png
Type: image/png
Size: 784 bytes
Desc: image898252.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230227/6fe01bfc/attachment-0009.png>

From maria.kallbach at gmail.com  Mon Feb 27 05:43:32 2023
From: maria.kallbach at gmail.com (Maria Kallbach)
Date: Mon, 27 Feb 2023 14:43:32 +0100
Subject: [gdal-dev] RGBA to RGB
Message-ID: <CAAux0EyUNU90pgg5Wo6FpYmwbDZ=TwDkB=h09YL4Kdac0OrwZw@mail.gmail.com>

Hey y'all, can anybody help me with calculating raster cell values? I have
an RGBA raster. I want cell values with 0,0,0,0 to be 255,8,255 (RGB, no
more Alpha).
Cheers, Maria
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230227/79aa7d11/attachment.htm>

From dbaston at gmail.com  Mon Feb 27 06:32:58 2023
From: dbaston at gmail.com (Daniel Baston)
Date: Mon, 27 Feb 2023 09:32:58 -0500
Subject: [gdal-dev] Report on GEOS maintenance grant
Message-ID: <CA+K_q_q67yNR_9aSvD4dX0t1Yj4yiR+auW8T76on7=LDBagEqQ@mail.gmail.com>

Hi All,

As February comes to a close, I?m winding down the GEOS maintenance work
that the GDAL PSC funded in 2022 [1]. I appreciate the opportunity to do
this work and am especially thankful to those who reported issues, reviewed
pull requests, or participated in discussions about this work.

For anyone who?s interested, I wanted to share a few of the highlights from
my perspective.

New functionality: GEOS now supports reading, writing, and overlay of
geometries with an M dimension. I added a number of C API utility functions
requested by client library developers: GEOSLineSubstring,
GEOSEqualsIdentical, and thread/context-specific interrupt handlers. I also
brought in clustering algorithms such as DBSCAN that were previously only
available in PostGIS.

Performance enhancements: I found some nice performance wins in key GEOS
algorithms such as geometry intersection testing (GEOSIntersects and
GEOSPreparedIntersects), distance (GEOSPreparedDistance and
GEOSPreparedDistanceWithin) and buffering complex geometries. There are
also some gains in core internal classes such as CoordinateSequence and
STRtree that deliver across-the-board gains.

Project maintenance. I was able to simplify our CI setup by removing the
use of Azure and AppVeyor services and bringing the associated environments
into GitHub Actions, write a harness for performance testing and
visualization, and perform code cleanup such as migrating from raw to
managed pointers in key classes. I resolved a number of long-standing bug
reports with WKT input/output, geometry simplification, and
crashes/incorrect results from multiple algorithms in edge cases such as
empty geometry inputs.

Not everything panned out, or at least not yet. Something we?ve wanted in
GEOS for a long time is the ability to create a GEOS geometry directly from
an external memory buffer, such as a PostGIS LWGEOM or a GDAL OGRGeometry
(?zero-copy?). I added experimental support for this, but so far I haven?t
found a case where it offers much performance benefit.

Dan

[1] https://lists.osgeo.org/pipermail/gdal-dev/2022-February/055433.html
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230227/224ff931/attachment.htm>

From mateusz at loskot.net  Mon Feb 27 07:33:34 2023
From: mateusz at loskot.net (Mateusz Loskot)
Date: Mon, 27 Feb 2023 16:33:34 +0100
Subject: [gdal-dev] Report on GEOS maintenance grant
In-Reply-To: <CA+K_q_q67yNR_9aSvD4dX0t1Yj4yiR+auW8T76on7=LDBagEqQ@mail.gmail.com>
References: <CA+K_q_q67yNR_9aSvD4dX0t1Yj4yiR+auW8T76on7=LDBagEqQ@mail.gmail.com>
Message-ID: <CABUeae8xotGtB63tKW5g9Jhz=wfX3SCvM4dgBZnjO9Joy+qvAQ@mail.gmail.com>

On Mon, 27 Feb 2023 at 15:34, Daniel Baston <dbaston at gmail.com> wrote:
>
> As February comes to a close, I?m winding down the GEOS maintenance work that the GDAL PSC funded in 2022 [1].

Dan, this is a great list of efforts, thank you.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From public at postholer.com  Mon Feb 27 08:02:35 2023
From: public at postholer.com (Scott)
Date: Mon, 27 Feb 2023 08:02:35 -0800
Subject: [gdal-dev] FileGDB_COMPILE fails during CMake
In-Reply-To: <LO2P123MB4861BBD079DA8819B9F1920382AF9@LO2P123MB4861.GBRP123.PROD.OUTLOOK.COM>
References: <LO2P123MB48614EA5849119B88395E7A582A89@LO2P123MB4861.GBRP123.PROD.OUTLOOK.COM>
 <cdf2a89f-e541-6df1-3acd-1ea9975041a5@postholer.com>
 <LO2P123MB4861BBD079DA8819B9F1920382AF9@LO2P123MB4861.GBRP123.PROD.OUTLOOK.COM>
Message-ID: <14ea91d4-bfea-8de6-1d62-7c2b10c24fe6@postholer.com>

3.6 has read, write, update and create abilities using the builtin 
OpenFIleGDB. Building from source on linux I don't specify anything.

On 2/27/23 00:37, Jon Morris wrote:
> Does that mean we should no longer attempt to use the FileGDB API? Our 
> tool makes quite heavy use of FileGDB so we'd have to do something like 
> this every time a user wants to use it:
> 
> if GDAL_VERSION >= (3, 6):
> driver = 'OpenFileGDB'
> else:
> driver = 'FileGDB'
> 
> Jon
> 
> e: ?	*Jon.Morris at jbarisk.com* <mailto:Jon.Morris at jbarisk.com>
> d:	+44?(0)1756?587229
> t: 	*+44?(0)1756?799919* <tel:+44%20(0)1756%20799919>
> 	
> 
> *www.jbarisk.com* <http://www.jbarisk.com/>
> 
> Facebook <https://www.facebook.com/TheFloodPeople>
> 
> 	
> LinkedIn <https://www.linkedin.com/company/jba-risk-management/>
> 
> 	
> Twitter <https://twitter.com/JBARisk>
> 
> 	
> YouTube <https://www.youtube.com/channel/UC0iatom2jYbW96voW0rlpCw>
> 
> 	
> 
> All JBA Risk Management's email messages contain confidential 
> information and are intended only for the individual(s) named. If you 
> are not the named addressee you should not disseminate, distribute or 
> copy this e-mail.
> Please notify the sender immediately by email if you have received this 
> email by mistake and delete this email from your system.
> JBA Risk Management Limited is registered in England, company number 
> 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North 
> Yorkshire, BD23 3FD, England.
> 
> -----Original Message-----
> From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Scott
> Sent: 24 February 2023 16:44
> To: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] FileGDB_COMPILE fails during CMake
> 
> CAUTION: This email originated from outside of JBA and contains one or 
> more links. DO NOT click links unless you recognise the sender's email 
> address and are absolutely certain that the content is safe.
> See the Phishing page on IMS on SP for more information about how to 
> spot and report suspicious messages.
> 
> With gdal >= 3.6 OpenFileGDB is built in by default, no need for 
> external API.
> 
> 
> 
> On 2/24/23 08:37, Jon Morris wrote:
>  > Hi all,
>  >
>  > I?ve been upgrading our build script from autotools to CMake and I?ve
>  > almost got it working, except for FileGDB. I?ve added the cmake
>  > parameters -DFileGDB_ROOT=/usr/local/FileGDB_API
>  > -DFileGDB_INCLUDE_DIR=/usr/local/FileGDB_API/include and the paths are
>  > correct. The earlier FileGDB install stage is the same as in
>  > 
> https://github.com/OSGeo/gdal/blob/release/3.6/.github/workflows/ubuntu_20.04/build-deps.sh <https://github.com/OSGeo/gdal/blob/release/3.6/.github/workflows/ubuntu_20.04/build-deps.sh>.
>  >
>  > (I?ve also tried /usr/include for the include path with the same result).
>  >
>  > When I run CMake, I get the following lines in the log (irrelevant
>  > lines have been removed):
>  >
>  > -- Performing Test TEST_FileGDB_COMPILE
>  >
>  > -- Performing Test TEST_FileGDB_COMPILE - Failed
>  >
>  > -- Found FileGDB: /usr/local/FileGDB_API/lib/libFileGDBAPI.so
>  >
>  > -- Enabled drivers and features and found dependency packages
>  >
>  > -- The following features have been enabled:
>  >
>  > * ogr_FILEGDB, FileGDB
>  >
>  > -- The following OPTIONAL packages have been found:
>  >
>  > * FileGDB
>  >
>  > Enable FileGDB (based on closed-source SDK) driver
>  >
>  > [ 82%] Building CXX object
>  > ogr/ogrsf_frmts/filegdb/CMakeFiles/ogr_FileGDB.dir/FGdbDatasource.cpp.
>  > o
>  >
>  > [ 82%] Building CXX object
>  > ogr/ogrsf_frmts/filegdb/CMakeFiles/ogr_FileGDB.dir/FGdbDriver.cpp.o
>  >
>  > [ 82%] Building CXX object
>  > ogr/ogrsf_frmts/filegdb/CMakeFiles/ogr_FileGDB.dir/FGdbLayer.cpp.o
>  >
>  > [ 82%] Building CXX object
>  > ogr/ogrsf_frmts/filegdb/CMakeFiles/ogr_FileGDB.dir/FGdbResultLayer.cpp
>  > .o
>  >
>  > [ 82%] Building CXX object
>  > ogr/ogrsf_frmts/filegdb/CMakeFiles/ogr_FileGDB.dir/FGdbUtils.cpp.o
>  >
>  > [ 82%] Built target ogr_FileGDB
>  >
>  > [ 94%] Linking CXX shared library libgdal.so
>  >
>  > /opt/rh/devtoolset-10/root/usr/libexec/gcc/x86_64-redhat-linux/10/ld:
>  > ogr/ogrsf_frmts/filegdb/CMakeFiles/ogr_FileGDB.dir/FGdbDatasource.cpp.o:
>  > in function FGdbDataSource::DeleteLayer(int)':
>  >
>  > FGdbDatasource.cpp:(.text+0x12b0): undefined reference to
>  > `FileGDBAPI::Geodatabase::Delete(std::basic_string<wchar_t,
>  > std::char_traits<wchar_t>, std::allocator<wchar_t> > const&,
>  > std::basic_string<wchar_t, std::char_traits<wchar_t>,
>  > std::allocator<wchar_t> > const&)'
>  >
>  > Many more undefined reference errors follow.
>  >
>  > Does anyone know what could be going wrong here and what else I can
>  > try to debug it? I?m all out of ideas.
>  >
>  > Many thanks,
>  >
>  > Jon
>  >
>  > e: ? *Jon.Morris at jbarisk.com* <mailto:Jon.Morris at jbarisk.com>
>  > d: +44 (0)1756 587229
>  > t: *+44 (0)1756 799919* <tel:+44%20(0)1756%20799919>
>  >
>  >
>  > *www.jbarisk.com* <http://www.jbarisk.com/>
>  >
>  > Facebook <https://www.facebook.com/TheFloodPeople>
>  >
>  >
>  > LinkedIn <https://www.linkedin.com/company/jba-risk-management/>
>  >
>  >
>  > Twitter <https://twitter.com/JBARisk>
>  >
>  >
>  > YouTube <https://www.youtube.com/channel/UC0iatom2jYbW96voW0rlpCw>
>  >
>  >
>  >
>  > All JBA Risk Management's email messages contain confidential
>  > information and are intended only for the individual(s) named. If you
>  > are not the named addressee you should not disseminate, distribute or
>  > copy this e-mail.
>  > Please notify the sender immediately by email if you have received
>  > this email by mistake and delete this email from your system.
>  > JBA Risk Management Limited is registered in England, company number
>  > 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North
>  > Yorkshire, BD23 3FD, England.
>  >
>  >
>  > _______________________________________________
>  > gdal-dev mailing list
>  > gdal-dev at lists.osgeo.org
>  > https://lists.osgeo.org/mailman/listinfo/gdal-dev
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From schwehr at gmail.com  Mon Feb 27 08:27:56 2023
From: schwehr at gmail.com (Kurt Schwehr)
Date: Mon, 27 Feb 2023 08:27:56 -0800
Subject: [gdal-dev] Report on GEOS maintenance grant
In-Reply-To: <CABUeae8xotGtB63tKW5g9Jhz=wfX3SCvM4dgBZnjO9Joy+qvAQ@mail.gmail.com>
References: <CA+K_q_q67yNR_9aSvD4dX0t1Yj4yiR+auW8T76on7=LDBagEqQ@mail.gmail.com>
 <CABUeae8xotGtB63tKW5g9Jhz=wfX3SCvM4dgBZnjO9Joy+qvAQ@mail.gmail.com>
Message-ID: <CACmBxysYqi=Qh-HHKJbSH70hD632nNZ=cWw42xMmDcKOQ-T=mw@mail.gmail.com>

+1 Awesome accomplishments and a great summary.

Thank you!

On Mon, Feb 27, 2023 at 7:34?AM Mateusz Loskot <mateusz at loskot.net> wrote:

> On Mon, 27 Feb 2023 at 15:34, Daniel Baston <dbaston at gmail.com> wrote:
> >
> > As February comes to a close, I?m winding down the GEOS maintenance work
> that the GDAL PSC funded in 2022 [1].
>
> Dan, this is a great list of efforts, thank you.
>
> Best regards,
> --
> Mateusz Loskot, http://mateusz.loskot.net
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230227/016957d3/attachment-0001.htm>

From howard at hobu.co  Mon Feb 27 09:02:30 2023
From: howard at hobu.co (Howard Butler)
Date: Mon, 27 Feb 2023 11:02:30 -0600
Subject: [gdal-dev] Report on GEOS maintenance grant
In-Reply-To: <CA+K_q_q67yNR_9aSvD4dX0t1Yj4yiR+auW8T76on7=LDBagEqQ@mail.gmail.com>
References: <CA+K_q_q67yNR_9aSvD4dX0t1Yj4yiR+auW8T76on7=LDBagEqQ@mail.gmail.com>
Message-ID: <84AFE21A-43CD-429C-A003-D18B69C12F65@hobu.co>



> On Feb 27, 2023, at 8:32 AM, Daniel Baston <dbaston at gmail.com> wrote:
> 
> Hi All,
> 
> As February comes to a close, I?m winding down the GEOS maintenance work that the GDAL PSC funded in 2022 [1]. I appreciate the opportunity to do this work and am especially thankful to those who reported issues, reviewed pull requests, or participated in discussions about this work.
> 
> For anyone who?s interested, I wanted to share a few of the highlights from my perspective.
> 
> New functionality: GEOS now supports reading, writing, and overlay of geometries with an M dimension. I added a number of C API utility functions requested by client library developers: GEOSLineSubstring, GEOSEqualsIdentical, and thread/context-specific interrupt handlers. I also brought in clustering algorithms such as DBSCAN that were previously only available in PostGIS.
> 
> Performance enhancements: I found some nice performance wins in key GEOS algorithms such as geometry intersection testing (GEOSIntersects and GEOSPreparedIntersects), distance (GEOSPreparedDistance and GEOSPreparedDistanceWithin) and buffering complex geometries. There are also some gains in core internal classes such as CoordinateSequence and STRtree that deliver across-the-board gains.
> 
> Project maintenance. I was able to simplify our CI setup by removing the use of Azure and AppVeyor services and bringing the associated environments into GitHub Actions, write a harness for performance testing and visualization, and perform code cleanup such as migrating from raw to managed pointers in key classes. I resolved a number of long-standing bug reports with WKT input/output, geometry simplification, and crashes/incorrect results from multiple algorithms in edge cases such as empty geometry inputs.
> 
> Not everything panned out, or at least not yet. Something we?ve wanted in GEOS for a long time is the ability to create a GEOS geometry directly from an external memory buffer, such as a PostGIS LWGEOM or a GDAL OGRGeometry (?zero-copy?). I added experimental support for this, but so far I haven?t found a case where it offers much performance benefit.
> 
> Dan
> 
> [1] https://lists.osgeo.org/pipermail/gdal-dev/2022-February/055433.html

Dan,

Thank you so much for taking on these efforts in a way that was both reactive to the community and aligned with the stated goals of the project. The project was to move GEOS forward on topics that do not achieve outside contribution, and you took on some tough topics that reached up and down the codebase to provide easier to use APIs and performance wins that will be fun to show off in other contexts like OGR, Shapely, and PostGIS usages.

Thanks,

Howard


From pramsey at cleverelephant.ca  Mon Feb 27 09:12:28 2023
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Mon, 27 Feb 2023 09:12:28 -0800
Subject: [gdal-dev] Report on GEOS maintenance grant
In-Reply-To: <84AFE21A-43CD-429C-A003-D18B69C12F65@hobu.co>
References: <CA+K_q_q67yNR_9aSvD4dX0t1Yj4yiR+auW8T76on7=LDBagEqQ@mail.gmail.com>
 <84AFE21A-43CD-429C-A003-D18B69C12F65@hobu.co>
Message-ID: <D50A69DA-C027-4D6D-9A0B-E6B29C60049D@cleverelephant.ca>

Thanks so much Dan, it?s been great having you on patrol these last few months, and the big changes you got through lay a nice foundation for the future of the library. 

P

> On Feb 27, 2023, at 9:02 AM, Howard Butler <howard at hobu.co> wrote:
> 
> 
> 
>> On Feb 27, 2023, at 8:32 AM, Daniel Baston <dbaston at gmail.com> wrote:
>> 
>> Hi All,
>> 
>> As February comes to a close, I?m winding down the GEOS maintenance work that the GDAL PSC funded in 2022 [1]. I appreciate the opportunity to do this work and am especially thankful to those who reported issues, reviewed pull requests, or participated in discussions about this work.
>> 
>> For anyone who?s interested, I wanted to share a few of the highlights from my perspective.
>> 
>> New functionality: GEOS now supports reading, writing, and overlay of geometries with an M dimension. I added a number of C API utility functions requested by client library developers: GEOSLineSubstring, GEOSEqualsIdentical, and thread/context-specific interrupt handlers. I also brought in clustering algorithms such as DBSCAN that were previously only available in PostGIS.
>> 
>> Performance enhancements: I found some nice performance wins in key GEOS algorithms such as geometry intersection testing (GEOSIntersects and GEOSPreparedIntersects), distance (GEOSPreparedDistance and GEOSPreparedDistanceWithin) and buffering complex geometries. There are also some gains in core internal classes such as CoordinateSequence and STRtree that deliver across-the-board gains.
>> 
>> Project maintenance. I was able to simplify our CI setup by removing the use of Azure and AppVeyor services and bringing the associated environments into GitHub Actions, write a harness for performance testing and visualization, and perform code cleanup such as migrating from raw to managed pointers in key classes. I resolved a number of long-standing bug reports with WKT input/output, geometry simplification, and crashes/incorrect results from multiple algorithms in edge cases such as empty geometry inputs.
>> 
>> Not everything panned out, or at least not yet. Something we?ve wanted in GEOS for a long time is the ability to create a GEOS geometry directly from an external memory buffer, such as a PostGIS LWGEOM or a GDAL OGRGeometry (?zero-copy?). I added experimental support for this, but so far I haven?t found a case where it offers much performance benefit.
>> 
>> Dan
>> 
>> [1] https://lists.osgeo.org/pipermail/gdal-dev/2022-February/055433.html
> 
> Dan,
> 
> Thank you so much for taking on these efforts in a way that was both reactive to the community and aligned with the stated goals of the project. The project was to move GEOS forward on topics that do not achieve outside contribution, and you took on some tough topics that reached up and down the codebase to provide easier to use APIs and performance wins that will be fun to show off in other contexts like OGR, Shapely, and PostGIS usages.
> 
> Thanks,
> 
> Howard
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


From sean.gillies at gmail.com  Mon Feb 27 10:19:43 2023
From: sean.gillies at gmail.com (Sean Gillies)
Date: Mon, 27 Feb 2023 11:19:43 -0700
Subject: [gdal-dev] Report on GEOS maintenance grant
In-Reply-To: <CA+K_q_q67yNR_9aSvD4dX0t1Yj4yiR+auW8T76on7=LDBagEqQ@mail.gmail.com>
References: <CA+K_q_q67yNR_9aSvD4dX0t1Yj4yiR+auW8T76on7=LDBagEqQ@mail.gmail.com>
Message-ID: <CAOodmJrSFXdxwDL0knhnkWwS3zzqvX7LY+nRQdTD+vnZR2c9Ww@mail.gmail.com>

Thank you for the write up, Dan! I appreciate what you've done for the
project and community. The outcome of the grant is beyond my expectations,
for sure.

On Mon, Feb 27, 2023 at 7:35 AM Daniel Baston <dbaston at gmail.com> wrote:

> Hi All,
>
> As February comes to a close, I?m winding down the GEOS maintenance work
> that the GDAL PSC funded in 2022 [1]. I appreciate the opportunity to do
> this work and am especially thankful to those who reported issues, reviewed
> pull requests, or participated in discussions about this work.
>
> For anyone who?s interested, I wanted to share a few of the highlights
> from my perspective.
>
> New functionality: GEOS now supports reading, writing, and overlay of
> geometries with an M dimension. I added a number of C API utility functions
> requested by client library developers: GEOSLineSubstring,
> GEOSEqualsIdentical, and thread/context-specific interrupt handlers. I also
> brought in clustering algorithms such as DBSCAN that were previously only
> available in PostGIS.
>
> Performance enhancements: I found some nice performance wins in key GEOS
> algorithms such as geometry intersection testing (GEOSIntersects and
> GEOSPreparedIntersects), distance (GEOSPreparedDistance and
> GEOSPreparedDistanceWithin) and buffering complex geometries. There are
> also some gains in core internal classes such as CoordinateSequence and
> STRtree that deliver across-the-board gains.
>
> Project maintenance. I was able to simplify our CI setup by removing the
> use of Azure and AppVeyor services and bringing the associated environments
> into GitHub Actions, write a harness for performance testing and
> visualization, and perform code cleanup such as migrating from raw to
> managed pointers in key classes. I resolved a number of long-standing bug
> reports with WKT input/output, geometry simplification, and
> crashes/incorrect results from multiple algorithms in edge cases such as
> empty geometry inputs.
>
> Not everything panned out, or at least not yet. Something we?ve wanted in
> GEOS for a long time is the ability to create a GEOS geometry directly from
> an external memory buffer, such as a PostGIS LWGEOM or a GDAL OGRGeometry
> (?zero-copy?). I added experimental support for this, but so far I
> haven?t found a case where it offers much performance benefit.
>
> Dan
>
> [1] https://lists.osgeo.org/pipermail/gdal-dev/2022-February/055433.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230227/f45280ec/attachment.htm>

From lr at pcorp.us  Mon Feb 27 10:50:12 2023
From: lr at pcorp.us (Regina Obe)
Date: Mon, 27 Feb 2023 13:50:12 -0500
Subject: [gdal-dev] [geos-devel]  Report on GEOS maintenance grant
In-Reply-To: <D50A69DA-C027-4D6D-9A0B-E6B29C60049D@cleverelephant.ca>
References: <CA+K_q_q67yNR_9aSvD4dX0t1Yj4yiR+auW8T76on7=LDBagEqQ@mail.gmail.com>
 <84AFE21A-43CD-429C-A003-D18B69C12F65@hobu.co>
 <D50A69DA-C027-4D6D-9A0B-E6B29C60049D@cleverelephant.ca>
Message-ID: <000001d94adc$535a7d00$fa0f7700$@pcorp.us>

I concur.  Great work Dan :)


> -----Original Message-----
> From: geos-devel [mailto:geos-devel-bounces at lists.osgeo.org] On Behalf Of
> Paul Ramsey
> Sent: Monday, February 27, 2023 12:12 PM
> To: Howard Butler <howard at hobu.co>
> Cc: gdal dev <gdal-dev at lists.osgeo.org>; GEOS Development List <geos-
> devel at lists.osgeo.org>
> Subject: Re: [geos-devel] [gdal-dev] Report on GEOS maintenance grant
> 
> Thanks so much Dan, it?s been great having you on patrol these last few
> months, and the big changes you got through lay a nice foundation for the
> future of the library.
> 
> P
> 
> > On Feb 27, 2023, at 9:02 AM, Howard Butler <howard at hobu.co> wrote:
> >
> >
> >
> >> On Feb 27, 2023, at 8:32 AM, Daniel Baston <dbaston at gmail.com> wrote:
> >>
> >> Hi All,
> >>
> >> As February comes to a close, I?m winding down the GEOS maintenance
> work that the GDAL PSC funded in 2022 [1]. I appreciate the opportunity to do
> this work and am especially thankful to those who reported issues, reviewed
> pull requests, or participated in discussions about this work.
> >>
> >> For anyone who?s interested, I wanted to share a few of the highlights from
> my perspective.
> >>
> >> New functionality: GEOS now supports reading, writing, and overlay of
> geometries with an M dimension. I added a number of C API utility functions
> requested by client library developers: GEOSLineSubstring,
> GEOSEqualsIdentical, and thread/context-specific interrupt handlers. I also
> brought in clustering algorithms such as DBSCAN that were previously only
> available in PostGIS.
> >>
> >> Performance enhancements: I found some nice performance wins in key
> GEOS algorithms such as geometry intersection testing (GEOSIntersects and
> GEOSPreparedIntersects), distance (GEOSPreparedDistance and
> GEOSPreparedDistanceWithin) and buffering complex geometries. There are
> also some gains in core internal classes such as CoordinateSequence and
> STRtree that deliver across-the-board gains.
> >>
> >> Project maintenance. I was able to simplify our CI setup by removing the
> use of Azure and AppVeyor services and bringing the associated environments
> into GitHub Actions, write a harness for performance testing and
> visualization, and perform code cleanup such as migrating from raw to
> managed pointers in key classes. I resolved a number of long-standing bug
> reports with WKT input/output, geometry simplification, and
> crashes/incorrect results from multiple algorithms in edge cases such as
> empty geometry inputs.
> >>
> >> Not everything panned out, or at least not yet. Something we?ve wanted in
> GEOS for a long time is the ability to create a GEOS geometry directly from an
> external memory buffer, such as a PostGIS LWGEOM or a GDAL
> OGRGeometry (?zero-copy?). I added experimental support for this, but so far
> I haven?t found a case where it offers much performance benefit.
> >>
> >> Dan
> >>
> >> [1] https://lists.osgeo.org/pipermail/gdal-dev/2022-February/055433.html
> >
> > Dan,
> >
> > Thank you so much for taking on these efforts in a way that was both
> reactive to the community and aligned with the stated goals of the project.
> The project was to move GEOS forward on topics that do not achieve outside
> contribution, and you took on some tough topics that reached up and down
> the codebase to provide easier to use APIs and performance wins that will be
> fun to show off in other contexts like OGR, Shapely, and PostGIS usages.
> >
> > Thanks,
> >
> > Howard
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> _______________________________________________
> geos-devel mailing list
> geos-devel at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/geos-devel


