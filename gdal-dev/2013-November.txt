From jukka.rahkonen at mmmtike.fi  Fri Nov  1 07:32:21 2013
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Fri, 1 Nov 2013 14:32:21 +0000 (UTC)
Subject: [gdal-dev] Skipping PHOTOMETRIC=YCBCR when not reasonable
Message-ID: <loom.20131101T151133-257@post.gmane.org>

Hi,

Gdal_translate throws 
ERROR 6: PHOTOMETRIC=YCBCR requires a source raster with only 3 bands (RGB)
if user tries to apply YCBCR to non-RGB image. It means that when I have a
mixture of RGB and B/W images I must separate them before making batch jobs.

I think that nothing bad would happen if gdal_translate in such case just
throws a warning and continues by compressing black and white image with the
default photometric settings.

-Jukka Rahkonen-


From even.rouault at mines-paris.org  Fri Nov  1 07:40:34 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 1 Nov 2013 15:40:34 +0100
Subject: [gdal-dev] Skipping PHOTOMETRIC=YCBCR when not reasonable
In-Reply-To: <loom.20131101T151133-257@post.gmane.org>
References: <loom.20131101T151133-257@post.gmane.org>
Message-ID: <201311011540.35201.even.rouault@mines-paris.org>

Jukka,

It is difficult to guess if the option specified by the user is something that he 
wants absolutely to be honoured (and in case it is not possible, an error is 
expected), or if it is just a hint that can be ignored if necessary. So the 
current behaviour seems OK to me.

Your script could just test the return code of gdal_translate and, in case of 
error, try again without -co PHOTOMETRYC=YCBCR. Or check before if the input 
dataset is 3 bands or not.

Even

> Hi,
> 
> Gdal_translate throws
> ERROR 6: PHOTOMETRIC=YCBCR requires a source raster with only 3 bands (RGB)
> if user tries to apply YCBCR to non-RGB image. It means that when I have a
> mixture of RGB and B/W images I must separate them before making batch
> jobs.
> 
> I think that nothing bad would happen if gdal_translate in such case just
> throws a warning and continues by compressing black and white image with
> the default photometric settings.
> 
> -Jukka Rahkonen-
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From jukka.rahkonen at mmmtike.fi  Fri Nov  1 07:56:39 2013
From: jukka.rahkonen at mmmtike.fi (Rahkonen Jukka)
Date: Fri, 1 Nov 2013 14:56:39 +0000
Subject: [gdal-dev] Skipping PHOTOMETRIC=YCBCR when not reasonable
Message-ID: <84446DEF76453C439E9E97E438E13A63127D1F0A@suutari.haapa.mmm.fi>

Hi,

Yes, it is understandable because there are so many parameters which may be wrong. I still don't write any other scripts than Windows batch files and testing the return codes is not my business. I will continue by sorting the source files as well as I can and running the batch a second time without YCBCR for the images which were not converted with the first run. Not a big problem for me really.

-Jukka-

Even Rouault wrote:

> Jukka,
> 
> It is difficult to guess if the option specified by the user is something that he
> wants absolutely to be honoured (and in case it is not possible, an error is
> expected), or if it is just a hint that can be ignored if necessary. So the current
> behaviour seems OK to me.
> 
> Your script could just test the return code of gdal_translate and, in case of error,
> try again without -co PHOTOMETRYC=YCBCR. Or check before if the input
> dataset is 3 bands or not.
> 
> Even
> 
> > Hi,
> >
> > Gdal_translate throws
> > ERROR 6: PHOTOMETRIC=YCBCR requires a source raster with only 3 bands
> > (RGB) if user tries to apply YCBCR to non-RGB image. It means that
> > when I have a mixture of RGB and B/W images I must separate them
> > before making batch jobs.
> >
> > I think that nothing bad would happen if gdal_translate in such case
> > just throws a warning and continues by compressing black and white
> > image with the default photometric settings.
> >
> > -Jukka Rahkonen-
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Fri Nov  1 08:06:04 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 1 Nov 2013 16:06:04 +0100
Subject: [gdal-dev] Skipping PHOTOMETRIC=YCBCR when not reasonable
In-Reply-To: <84446DEF76453C439E9E97E438E13A63127D1F0A@suutari.haapa.mmm.fi>
References: <84446DEF76453C439E9E97E438E13A63127D1F0A@suutari.haapa.mmm.fi>
Message-ID: <201311011606.04289.even.rouault@mines-paris.org>

Le vendredi 01 novembre 2013 15:56:39, Rahkonen Jukka a ?crit :
> Hi,
> 
> Yes, it is understandable because there are so many parameters which may be
> wrong. I still don't write any other scripts than Windows batch files and
> testing the return codes is not my business. I will continue by sorting
> the source files as well as I can and running the batch a second time
> without YCBCR for the images which were not converted with the first run.
> Not a big problem for me really.

Should be something like the following (untested)

gdal_translate src.tif out.tif -co PHOTOMETRIC=YCBCR
if %ERRORLEVEL% == 0 (
   echo Conversion successfull
) else (
   echo Retrying without YCBCR
   gdal_translate src.tif out.tif
)

> 
> -Jukka-
> 
> Even Rouault wrote:
> > Jukka,
> > 
> > It is difficult to guess if the option specified by the user is something
> > that he wants absolutely to be honoured (and in case it is not possible,
> > an error is expected), or if it is just a hint that can be ignored if
> > necessary. So the current behaviour seems OK to me.
> > 
> > Your script could just test the return code of gdal_translate and, in
> > case of error, try again without -co PHOTOMETRYC=YCBCR. Or check before
> > if the input dataset is 3 bands or not.
> > 
> > Even
> > 
> > > Hi,
> > > 
> > > Gdal_translate throws
> > > ERROR 6: PHOTOMETRIC=YCBCR requires a source raster with only 3 bands
> > > (RGB) if user tries to apply YCBCR to non-RGB image. It means that
> > > when I have a mixture of RGB and B/W images I must separate them
> > > before making batch jobs.
> > > 
> > > I think that nothing bad would happen if gdal_translate in such case
> > > just throws a warning and continues by compressing black and white
> > > image with the default photometric settings.
> > > 
> > > -Jukka Rahkonen-
> > > 
> > > _______________________________________________
> > > gdal-dev mailing list
> > > gdal-dev at lists.osgeo.org
> > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > 
> > --
> > Geospatial professional services
> > http://even.rouault.free.fr/services.html
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From tylermitchell at shaw.ca  Fri Nov  1 12:55:38 2013
From: tylermitchell at shaw.ca (TYLER MITCHELL)
Date: Fri, 1 Nov 2013 13:55:38 -0600 (MDT)
Subject: [gdal-dev] Docs attribution for upcoming book!
In-Reply-To: <324018442.47146467.1383335177828.JavaMail.root@cds052>
Message-ID: <2112659339.47152754.1383335738410.JavaMail.root@cds052>

Hi all,

I'm working with Gary Sherman via Locate Press to (finally) publish the GDAL reference manual, along with some more examples and other GDAL/OGR related material I've written over the past year.  It will be in a book entitle Geospatial Power Tools.

I just wanted to let you know about it and to confirm the attribution approach we took for the GDAL docs portion.  I've included the main licensing text, with copyright Frank Warmerdam, but for authors I put "GDAL Developers".  Does that make sense?  

We will likely have a preview version out for sale today or tomorrow at http://locatepress.com/gpt

Best wishes,
Tyler

From warmerdam at pobox.com  Fri Nov  1 13:08:19 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri, 1 Nov 2013 13:08:19 -0700
Subject: [gdal-dev] Docs attribution for upcoming book!
In-Reply-To: <2112659339.47152754.1383335738410.JavaMail.root@cds052>
References: <324018442.47146467.1383335177828.JavaMail.root@cds052>
	<2112659339.47152754.1383335738410.JavaMail.root@cds052>
Message-ID: <CA+YzLBfqBMG1D3hCooidBWNoLArVWSggJLoasU4COD-cs6EdTw@mail.gmail.com>

Tyler,

That approach sounds good to me.  I look forward to seeing the book.

Best regards,
Frank


On Fri, Nov 1, 2013 at 12:55 PM, TYLER MITCHELL <tylermitchell at shaw.ca>wrote:

> Hi all,
>
> I'm working with Gary Sherman via Locate Press to (finally) publish the
> GDAL reference manual, along with some more examples and other GDAL/OGR
> related material I've written over the past year.  It will be in a book
> entitle Geospatial Power Tools.
>
> I just wanted to let you know about it and to confirm the attribution
> approach we took for the GDAL docs portion.  I've included the main
> licensing text, with copyright Frank Warmerdam, but for authors I put "GDAL
> Developers".  Does that make sense?
>
> We will likely have a preview version out for sale today or tomorrow at
> http://locatepress.com/gpt
>
> Best wishes,
> Tyler
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131101/dbb4efb4/attachment.html>

From radim.blazek at gmail.com  Sat Nov  2 10:37:04 2013
From: radim.blazek at gmail.com (Radim Blazek)
Date: Sat, 2 Nov 2013 18:37:04 +0100
Subject: [gdal-dev] GDALGetCategoryNames
Message-ID: <CAEMrtYoMfhFCW5pU+rS5LO5sNmzpnzBaU5VyiETfhF-e7oUhXg@mail.gmail.com>

Is there any reason why there is no C function GDALGetCategoryNames
for GDALRasterBand::GetCategoryNames()?

Could it be added?

Radim

From tylermitchell at shaw.ca  Sat Nov  2 11:03:31 2013
From: tylermitchell at shaw.ca (TYLER MITCHELL)
Date: Sat, 2 Nov 2013 12:03:31 -0600 (MDT)
Subject: [gdal-dev] Docs attribution for upcoming book!
In-Reply-To: <CA+YzLBfqBMG1D3hCooidBWNoLArVWSggJLoasU4COD-cs6EdTw@mail.gmail.com>
References: <324018442.47146467.1383335177828.JavaMail.root@cds052>
	<2112659339.47152754.1383335738410.JavaMail.root@cds052>
	<CA+YzLBfqBMG1D3hCooidBWNoLArVWSggJLoasU4COD-cs6EdTw@mail.gmail.com>
Message-ID: <0EF95431-9EEF-4800-91DD-6D760D14BF50@shaw.ca>

The GDAL book is now live now at http://locatepress.com/gpt

Thanks Frank and all contributors!

> On Nov 1, 2013, at 13:08, Frank Warmerdam <warmerdam at pobox.com> wrote:
> 
> Tyler,
> 
> That approach sounds good to me.  I look forward to seeing the book.
> 
> Best regards,
> Frank
> 
> 
>> On Fri, Nov 1, 2013 at 12:55 PM, TYLER MITCHELL <tylermitchell at shaw.ca> wrote:
>> Hi all,
>> 
>> I'm working with Gary Sherman via Locate Press to (finally) publish the GDAL reference manual, along with some more examples and other GDAL/OGR related material I've written over the past year.  It will be in a book entitle Geospatial Power Tools.
>> 
>> I just wanted to let you know about it and to confirm the attribution approach we took for the GDAL docs portion.  I've included the main licensing text, with copyright Frank Warmerdam, but for authors I put "GDAL Developers".  Does that make sense?
>> 
>> We will likely have a preview version out for sale today or tomorrow at http://locatepress.com/gpt
>> 
>> Best wishes,
>> Tyler
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 
> 
> -- 
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131102/fc2312d1/attachment.html>

From even.rouault at mines-paris.org  Sat Nov  2 14:25:58 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 2 Nov 2013 22:25:58 +0100
Subject: [gdal-dev] GDALGetCategoryNames
In-Reply-To: <CAEMrtYoMfhFCW5pU+rS5LO5sNmzpnzBaU5VyiETfhF-e7oUhXg@mail.gmail.com>
References: <CAEMrtYoMfhFCW5pU+rS5LO5sNmzpnzBaU5VyiETfhF-e7oUhXg@mail.gmail.com>
Message-ID: <201311022225.58803.even.rouault@mines-paris.org>

Le samedi 02 novembre 2013 18:37:04, Radim Blazek a ?crit :
> Is there any reason why there is no C function GDALGetCategoryNames
> for GDALRasterBand::GetCategoryNames()?
> 
> Could it be added?

Already exists under the name GDALGetRasterCategoryNames()

Even

> 
> Radim
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From radim.blazek at gmail.com  Sun Nov  3 01:06:04 2013
From: radim.blazek at gmail.com (Radim Blazek)
Date: Sun, 3 Nov 2013 10:06:04 +0100
Subject: [gdal-dev] GDALGetCategoryNames
In-Reply-To: <201311022225.58803.even.rouault@mines-paris.org>
References: <CAEMrtYoMfhFCW5pU+rS5LO5sNmzpnzBaU5VyiETfhF-e7oUhXg@mail.gmail.com>
	<201311022225.58803.even.rouault@mines-paris.org>
Message-ID: <CAEMrtYoNE+nokJxHwBM4feZnXuSk7-h4_v96m8pTVRDmufErPA@mail.gmail.com>

On Sat, Nov 2, 2013 at 10:25 PM, Even Rouault
<even.rouault at mines-paris.org> wrote:
> Le samedi 02 novembre 2013 18:37:04, Radim Blazek a ?crit :
>> Is there any reason why there is no C function GDALGetCategoryNames
>> for GDALRasterBand::GetCategoryNames()?
>>
>> Could it be added?
>
> Already exists under the name GDALGetRasterCategoryNames()

Good, thanks.

It is missing in GDALRasterBand::GetCategoryNames() doc
http://www.gdal.org/classGDALRasterBand.html#a9602a34799a8a9d72f0a7b99e06864a5

Radim

> Even
>
>>
>> Radim
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Sun Nov  3 04:50:18 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sun, 3 Nov 2013 13:50:18 +0100
Subject: [gdal-dev] Add "all_tags" option into OSM driver
In-Reply-To: <loom.20130915T163021-206@post.gmane.org>
References: <loom.20130915T163021-206@post.gmane.org>
Message-ID: <201311031350.18751.even.rouault@mines-paris.org>

Le dimanche 15 septembre 2013 16:48:34, Jukka Rahkonen a ?crit :
> Hi,
> 
> Currently it is possible to select which OSM tags are converted into normal
> OGR fiels and select that the rest will be written into "other_tags" field,
> except the ones from the ignore list.
> 
> In case of PostGIS and hstore it would be sometimes good to have all the
> tags written into the hstore fiels, also those which are converted into OGR
> fields.
> 
> I suggest to add an "all_tags" option which would concatenate all the tags
> into a common field except those which are in the ingore list.
> Alternatively there could be switch to change the "other_tags" behavious
> between "all tags which are not OGR tags of ignored" vs. "all tags which
> are not ignored"
> 
> Adding a new "all_tags" option feels easier to implement but I can not
> really imagine why any user would like to select both "other_tags" and
> "all_tags" options at the same time.
> 
> Osmconf.ini which would support the easy but perhaps stupid alternative
> would then look like this:
> 
> # keys to report as OGR fields
> attributes=[list]
> # keys that should NOT be reported in the "other_tags" and "all_tags"
> fields ignore=[list]
> # uncomment to avoid creation of "other_tags" field
> #other_tags=no
> # uncomment to avoid creation of "all_tags" field
> all_tags=no
> 
> 
> The "all_tags" option is how osm2pgsql works with the -k parameter and
> having that in GDAL would help in using those two programs side by side.

Hi,

I've just added a "all_tags=yes" option. It is disabled by default. When 
enabled, it replaces "other_tags" if it is also enabled.

Even


> 
> -Jukka Rahkonen-
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From tpiepho at gmail.com  Sun Nov  3 17:11:45 2013
From: tpiepho at gmail.com (Trent Piepho)
Date: Sun, 3 Nov 2013 17:11:45 -0800
Subject: [gdal-dev] Mercator_2SP support in GeoTiff
Message-ID: <CA+7tXijW79KR+LfVVHi3NtVQkrjFmez-WA_0FXpaMNCM3JDqvQ@mail.gmail.com>

I'm trying to improve GDAL's support for BSB nautical charts, most of
which use the Mercator_2SP projection.

When converting to GeoTIFF with GDAL, the Mercator_2SP project is
converted into Mercator_1SP without correctly adjusting the
parameters.

For example, my source KAP file has a projection (uninteresting
parameters elided) and center of:
    PROJECTION["Mercator_2SP"],
    PARAMETER["standard_parallel_1",47.667],
    PARAMETER["central_meridian",0],
Center      (-9222211.302, 4063849.585) (122d47'31.25"W, 47d41'15.45"N)

Convert to a GeoTiff, and one gets:
    PROJECTION["Mercator_1SP"],
    PARAMETER["central_meridian",0],
    PARAMETER["scale_factor",1],
Center      (-9222211.302, 4063849.585) ( 82d50'40.32"W, 34d26'23.38"N)

Not the same thing at all!

As I understand it, both the 1SP and 2SP forms are the same projection
and the only difference is how the scale is specified.  In 1SP the
scale at the latitude of origin is specified, while in 2SP a latitude
of true scale, where the scale is 1.0, is specified instead.  Either
of those parameters can be calculated from the other.

It seems that GeoTIFF uses just one coordinate transform key for both
the 1SP and 2SP forms and allows for any or all of the parameters
named ProjNatOriginLatGeoKey,  ProjScaleAtNatOriginGeoKey, and
ProjStdParallel1GeoKey. It also seems that the GeoTIFF spec does not
define how to interpret those parameters.

What GDAL does is ignore ProjStdParallel1GeoKey when reading a geotiff
and not set it when creating one.  A Mercator_2SP projection will get
a default ProjScaleAtNatOriginGeoKey value of 1.0, which of course
changes the projection.

It seems the logical thing to do is use 1SP when only ScaleAtNatOrigin
is specified and to use 2SP when only StdParallel1 is specified.  If
both are specified then it's not clear what to do.  Either the
projection is over specified or the ScaleAtNatOrigin should be
interpreted as the scale at StdParallel1, as opposed to the scale at
NatOriginLat.  The latter would seem to contradict the "at natural
origin" part of ScaleAtNatOrigin and I can't find any reference to
someone wanting to do this.  It seems better to me to consider such a
geotiff to be flawed.

I've made a patch that produces this behavior.  It allows Mercator_2SP
projections to be saved and loaded as GTiffs.

I found a reference to a similar bug in GeoTools and it appears their
fix is the same as mine:
http://jira.codehaus.org/browse/GEOT-2163
http://osgeo-org.1560.x6.nabble.com/svn-r31885-branches-2-5-x-modules-library-coverage-src-main-java-org-geotools-coverage-grid-io-imagef-td4248652.html

After my patch GDAL should be able to inter-operate with GeoTools.  I
can't say about other software, but clearly what GDAL does now is not
correct in any way.

From tpiepho at gmail.com  Sun Nov  3 17:48:26 2013
From: tpiepho at gmail.com (Trent Piepho)
Date: Sun,  3 Nov 2013 17:48:26 -0800
Subject: [gdal-dev] [PATCH] Support Mercator_2SP in GeoTIFF
In-Reply-To: <CA+7tXijW79KR+LfVVHi3NtVQkrjFmez-WA_0FXpaMNCM3JDqvQ@mail.gmail.com>
References: <CA+7tXijW79KR+LfVVHi3NtVQkrjFmez-WA_0FXpaMNCM3JDqvQ@mail.gmail.com>
Message-ID: <1383529706-26601-1-git-send-email-tpiepho@gmail.com>

Mercator_[12]SP are both the same projection in GeoTIFF.  Lacking a
definition in the official specification, the intention appears to be that
for Mercator_2SP the latitude of true scale (lat_ts) should be specified in
ProjStdParallel1GeoKey and for Mercator_2SP the scale at origin (k) should
be specified in ProjScaleAtNatOriginGeoKey.

Current behavior when creating a GTiff with 2SP is to drop lat_ts and create
a default k value of 1.0, which will product an incorrect projection.  When
reading, a default k of 1.0 is used and lat_ts is ignored, also changing the
projection.

This patches changes the behavior to supply ProjScaleAtNatOriginGeoKey for
Mercator_1SP or ProjStdParallel1GeoKey for Mercator_2SP when writing.

For reading either or both values are supplied when present by libgeotiff's
normalization code.  If neither is present, a default k of 1.0 is created.

GDAL's GTiff driver is changed to create a 2SP projection is lat_ts is
present, 1SP otherwise.  It emits a warning of both last_ts and scale are
present (and ignores scale).
---
 gdal/frmts/gtiff/gt_wkt_srs.cpp             |   28 ++++++++++---
 gdal/frmts/gtiff/libgeotiff/geo_normalize.c |   59 ++++++++++++++++++++++++++-
 2 files changed, 80 insertions(+), 7 deletions(-)

diff --git a/gdal/frmts/gtiff/gt_wkt_srs.cpp b/gdal/frmts/gtiff/gt_wkt_srs.cpp
index 5934df5..0afb101 100644
--- a/gdal/frmts/gtiff/gt_wkt_srs.cpp
+++ b/gdal/frmts/gtiff/gt_wkt_srs.cpp
@@ -737,9 +737,21 @@ char *GTIFGetOGISDefn( GTIF *hGTIF, GTIFDefn * psDefn )
             break;
 
           case CT_Mercator:
-            oSRS.SetMercator( adfParm[0], adfParm[1],
-                              adfParm[4],
-                              adfParm[5], adfParm[6] );
+            /* If a lat_ts was specified use 2SP, otherwise use 1SP */
+            if (psDefn->ProjParmId[2] == ProjStdParallel1GeoKey)
+            {
+                if (psDefn->ProjParmId[4] == ProjScaleAtNatOriginGeoKey)
+                    CPLError( CE_Warning, CPLE_AppDefined,
+                              "Mercator projection should not define both StdParallel1 and ScaleAtNatOrigin.\n"
+                              "Using StdParallel1 and ignoring ScaleAtNatOrigin.\n" );
+                oSRS.SetMercator2SP( adfParm[2],
+                                     adfParm[0], adfParm[1],
+                                     adfParm[5], adfParm[6]);
+            }
+            else
+                oSRS.SetMercator( adfParm[0], adfParm[1],
+                                  adfParm[4],
+                                  adfParm[5], adfParm[6] );
                               
             if (psDefn->Projection == 1024 || psDefn->Projection == 9841) // override hack for google mercator. 
             {
@@ -1510,14 +1522,18 @@ int GTIFSetFromOGISDefn( GTIF * psGTIF, const char *pszOGCWKT )
         GTIFKeySet(psGTIF, ProjNatOriginLongGeoKey, TYPE_DOUBLE, 1,
                    poSRS->GetNormProjParm( SRS_PP_CENTRAL_MERIDIAN, 0.0 ) );
         
-        GTIFKeySet(psGTIF, ProjScaleAtNatOriginGeoKey, TYPE_DOUBLE, 1,
-                   poSRS->GetNormProjParm( SRS_PP_SCALE_FACTOR, 1.0 ) );
-        
         GTIFKeySet(psGTIF, ProjFalseEastingGeoKey, TYPE_DOUBLE, 1,
                    poSRS->GetProjParm( SRS_PP_FALSE_EASTING, 0.0 ) );
         
         GTIFKeySet(psGTIF, ProjFalseNorthingGeoKey, TYPE_DOUBLE, 1,
                    poSRS->GetProjParm( SRS_PP_FALSE_NORTHING, 0.0 ) );
+
+        if( EQUAL(pszProjection,SRS_PT_MERCATOR_2SP) )
+            GTIFKeySet(psGTIF, ProjStdParallel1GeoKey, TYPE_DOUBLE, 1,
+                       poSRS->GetNormProjParm( SRS_PP_STANDARD_PARALLEL_1, 0.0 ) );
+        else
+            GTIFKeySet(psGTIF, ProjScaleAtNatOriginGeoKey, TYPE_DOUBLE, 1,
+                       poSRS->GetNormProjParm( SRS_PP_SCALE_FACTOR, 1.0 ) );
     }
     
     else if( EQUAL(pszProjection,SRS_PT_OBLIQUE_STEREOGRAPHIC) )
diff --git a/gdal/frmts/gtiff/libgeotiff/geo_normalize.c b/gdal/frmts/gtiff/libgeotiff/geo_normalize.c
index 4761ea0..75705ee 100644
--- a/gdal/frmts/gtiff/libgeotiff/geo_normalize.c
+++ b/gdal/frmts/gtiff/libgeotiff/geo_normalize.c
@@ -1495,8 +1495,65 @@ static void GTIFFetchProjParms( GTIF * psGTIF, GTIFDefn * psDefn )
         break;
 
 /* -------------------------------------------------------------------- */
-      case CT_LambertConfConic_1SP:
       case CT_Mercator:
+/* -------------------------------------------------------------------- */
+        if( GTIFKeyGet(psGTIF, ProjNatOriginLongGeoKey,
+                       &dfNatOriginLong, 0, 1 ) == 0
+            && GTIFKeyGet(psGTIF, ProjFalseOriginLongGeoKey,
+                          &dfNatOriginLong, 0, 1 ) == 0
+            && GTIFKeyGet(psGTIF, ProjCenterLongGeoKey,
+                          &dfNatOriginLong, 0, 1 ) == 0 )
+            dfNatOriginLong = 0.0;
+
+        if( GTIFKeyGet(psGTIF, ProjNatOriginLatGeoKey,
+                       &dfNatOriginLat, 0, 1 ) == 0
+            && GTIFKeyGet(psGTIF, ProjFalseOriginLatGeoKey,
+                          &dfNatOriginLat, 0, 1 ) == 0
+            && GTIFKeyGet(psGTIF, ProjCenterLatGeoKey,
+                          &dfNatOriginLat, 0, 1 ) == 0 )
+            dfNatOriginLat = 0.0;
+
+
+        if( GTIFKeyGet(psGTIF, ProjStdParallel1GeoKey,
+                       &dfStdParallel1, 0, 1 ) == 0 )
+            dfStdParallel1 = NAN;
+
+        if( GTIFKeyGet(psGTIF, ProjScaleAtNatOriginGeoKey,
+                       &dfNatOriginScale, 0, 1 ) == 0 )
+        {
+            /* Default only if dfStdParallel1 isn't defined */
+            if( isnan(dfStdParallel1) )
+                dfNatOriginScale = 1.0;
+            else
+                dfNatOriginScale = NAN;
+        }
+
+        /* notdef: should transform to decimal degrees at this point */
+
+        psDefn->ProjParm[0] = dfNatOriginLat;
+        psDefn->ProjParmId[0] = ProjNatOriginLatGeoKey;
+        psDefn->ProjParm[1] = dfNatOriginLong;
+        psDefn->ProjParmId[1] = ProjNatOriginLongGeoKey;
+        if( !isnan(dfStdParallel1) )
+        {
+            psDefn->ProjParm[2] = dfStdParallel1;
+            psDefn->ProjParmId[2] = ProjStdParallel1GeoKey;
+        }
+        if( !isnan(dfNatOriginScale) )
+        {
+            psDefn->ProjParm[4] = dfNatOriginScale;
+            psDefn->ProjParmId[4] = ProjScaleAtNatOriginGeoKey;
+        }
+        psDefn->ProjParm[5] = dfFalseEasting;
+        psDefn->ProjParmId[5] = ProjFalseEastingGeoKey;
+        psDefn->ProjParm[6] = dfFalseNorthing;
+        psDefn->ProjParmId[6] = ProjFalseNorthingGeoKey;
+
+        psDefn->nParms = 7;
+        break;
+
+/* -------------------------------------------------------------------- */
+      case CT_LambertConfConic_1SP:
       case CT_ObliqueStereographic:
       case CT_TransverseMercator:
       case CT_TransvMercator_SouthOriented:
-- 
1.7.10.4


From Bruno.Ledoux at astrium.eads.net  Mon Nov  4 03:13:41 2013
From: Bruno.Ledoux at astrium.eads.net (Ledoux, Bruno)
Date: Mon, 4 Nov 2013 11:13:41 +0000
Subject: [gdal-dev] Unable to decode ADS100 images
Message-ID: <8F25D7B9D78147488B5CCD8C6D299B429BBB4934@tlswinmbx01.toulouse.spotimage.int>

Hi All,

I am trying to decode ADS100 raw images (.lov files) but gdal is failing with the following error message : "ERROR 1: Cannot open TIFF file due to missing codec."
The tiffdump utility from the TIFF library indicates that the Compression codec code is 65100 which is undefined by the TIFF specifications.

I am aware this is not an issue with GDAL but am wondering if someone has ever managed to open images compressed with the same codec.

Best Regards,

Bruno

PS : This question was initially posted on trac.osgeo.org but as suggested by Rouault the gdal-dev mailing list may have more traffic.



[cid:image60e3cf.JPG at b4f94a80.46a363fa] Please consider the environment before printing this email message.

________________________________

Ce courriel (incluant ses ?ventuelles pi?ces jointes) peut contenir des informations confidentielles et/ou prot?g?es ou dont la diffusion est restreinte. Si vous avez re?u ce courriel par erreur, vous ne devez ni le copier, ni l'utiliser, ni en divulguer le contenu ? quiconque. Merci d'en avertir imm?diatement l'exp?diteur et d'effacer ce courriel de votre syst?me. Spot Image d?cline toute responsabilit? en cas de corruption par virus, d'alt?ration ou de falsification de ce courriel lors de sa transmission par voie ?lectronique.

This email (including any attachments) may contain confidential and/or privileged information or information otherwise protected from disclosure. If you are not the intended recipient, please notify the sender immediately, do not copy this message or any attachments and do not use it for any purpose or disclose its content to any person, but delete this message and any attachments from your system. Spot Image disclaims any and all liability if this email transmission was virus corrupted, altered or falsified.

________________________________

Spot Image SA (325 089 589 RCS Toulouse) - Siege social: 5, rue des Satellites, 31400 Toulouse, France.


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131104/a83f080a/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image60e3cf.JPG
Type: image/jpeg
Size: 625 bytes
Desc: image60e3cf.JPG
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131104/a83f080a/attachment.jpe>

From even.rouault at mines-paris.org  Mon Nov  4 11:12:56 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 4 Nov 2013 20:12:56 +0100
Subject: [gdal-dev] [PATCH] Support Mercator_2SP in GeoTIFF
In-Reply-To: <1383529706-26601-1-git-send-email-tpiepho@gmail.com>
References: <CA+7tXijW79KR+LfVVHi3NtVQkrjFmez-WA_0FXpaMNCM3JDqvQ@mail.gmail.com>
	<1383529706-26601-1-git-send-email-tpiepho@gmail.com>
Message-ID: <201311042012.56445.even.rouault@mines-paris.org>

Trent / others,

Although your patch comes with a detailed analysis, I find myself a bit light 
on the topic to blindly apply it.

A few observations :

* I found an old ticket that might be related 
http://trac.osgeo.org/gdal/ticket/1797. Would your patch solve the issue 
raised in that ticket ?

* You mention that you followed what Geotools did. Did you actually check the 
interoperability of generated files ? 

* Do people have knowledge of other software (not based on GDAL) that would 
read / produce GeoTIFFs with a Mercator_2SP projection, and could provide 
samples ?

* Now on the patch itself, there's a GDAL part (gt_wkt_srs.cpp) and a 
libgeotiff one (libgeotiff/geo_normalize.c). The later should be submitted in 
GeoTIFF trac http://trac.osgeo.org/geotiff/newticket and approved there, before 
being downstreamed into GDAL

* Concerning the patch geo_normalize.c, the use of NAN / isnan() could cause 
portability issues on some platforms. I'd suggest using boolean flags instead.

I've added geotiff mailing list in CC, in the hope of broadening the target 
audience. And Daniele too if he has some memories of his experience with fixing 
http://jira.codehaus.org/browse/GEOT-2163 (particularly if he had the 
opportunity to check interoperability with other software)

Best regards,

Even

Le lundi 04 novembre 2013 02:48:26, Trent Piepho a ?crit :
> Mercator_[12]SP are both the same projection in GeoTIFF.  Lacking a
> definition in the official specification, the intention appears to be that
> for Mercator_2SP the latitude of true scale (lat_ts) should be specified in
> ProjStdParallel1GeoKey and for Mercator_2SP the scale at origin (k) should
> be specified in ProjScaleAtNatOriginGeoKey.
> 
> Current behavior when creating a GTiff with 2SP is to drop lat_ts and
> create a default k value of 1.0, which will product an incorrect
> projection.  When reading, a default k of 1.0 is used and lat_ts is
> ignored, also changing the projection.
> 
> This patches changes the behavior to supply ProjScaleAtNatOriginGeoKey for
> Mercator_1SP or ProjStdParallel1GeoKey for Mercator_2SP when writing.
> 
> For reading either or both values are supplied when present by libgeotiff's
> normalization code.  If neither is present, a default k of 1.0 is created.
> 
> GDAL's GTiff driver is changed to create a 2SP projection is lat_ts is
> present, 1SP otherwise.  It emits a warning of both last_ts and scale are
> present (and ignores scale).
> ---
>  gdal/frmts/gtiff/gt_wkt_srs.cpp             |   28 ++++++++++---
>  gdal/frmts/gtiff/libgeotiff/geo_normalize.c |   59
> ++++++++++++++++++++++++++- 2 files changed, 80 insertions(+), 7
> deletions(-)
> 
> diff --git a/gdal/frmts/gtiff/gt_wkt_srs.cpp
> b/gdal/frmts/gtiff/gt_wkt_srs.cpp index 5934df5..0afb101 100644
> --- a/gdal/frmts/gtiff/gt_wkt_srs.cpp
> +++ b/gdal/frmts/gtiff/gt_wkt_srs.cpp
> @@ -737,9 +737,21 @@ char *GTIFGetOGISDefn( GTIF *hGTIF, GTIFDefn * psDefn
> ) break;
> 
>            case CT_Mercator:
> -            oSRS.SetMercator( adfParm[0], adfParm[1],
> -                              adfParm[4],
> -                              adfParm[5], adfParm[6] );
> +            /* If a lat_ts was specified use 2SP, otherwise use 1SP */
> +            if (psDefn->ProjParmId[2] == ProjStdParallel1GeoKey)
> +            {
> +                if (psDefn->ProjParmId[4] == ProjScaleAtNatOriginGeoKey)
> +                    CPLError( CE_Warning, CPLE_AppDefined,
> +                              "Mercator projection should not define both
> StdParallel1 and ScaleAtNatOrigin.\n" +                             
> "Using StdParallel1 and ignoring ScaleAtNatOrigin.\n" ); +               
> oSRS.SetMercator2SP( adfParm[2],
> +                                     adfParm[0], adfParm[1],
> +                                     adfParm[5], adfParm[6]);
> +            }
> +            else
> +                oSRS.SetMercator( adfParm[0], adfParm[1],
> +                                  adfParm[4],
> +                                  adfParm[5], adfParm[6] );
> 
>              if (psDefn->Projection == 1024 || psDefn->Projection == 9841)
> // override hack for google mercator. {
> @@ -1510,14 +1522,18 @@ int GTIFSetFromOGISDefn( GTIF * psGTIF, const char
> *pszOGCWKT ) GTIFKeySet(psGTIF, ProjNatOriginLongGeoKey, TYPE_DOUBLE, 1,
> poSRS->GetNormProjParm( SRS_PP_CENTRAL_MERIDIAN, 0.0 ) );
> 
> -        GTIFKeySet(psGTIF, ProjScaleAtNatOriginGeoKey, TYPE_DOUBLE, 1,
> -                   poSRS->GetNormProjParm( SRS_PP_SCALE_FACTOR, 1.0 ) );
> -
>          GTIFKeySet(psGTIF, ProjFalseEastingGeoKey, TYPE_DOUBLE, 1,
>                     poSRS->GetProjParm( SRS_PP_FALSE_EASTING, 0.0 ) );
> 
>          GTIFKeySet(psGTIF, ProjFalseNorthingGeoKey, TYPE_DOUBLE, 1,
>                     poSRS->GetProjParm( SRS_PP_FALSE_NORTHING, 0.0 ) );
> +
> +        if( EQUAL(pszProjection,SRS_PT_MERCATOR_2SP) )
> +            GTIFKeySet(psGTIF, ProjStdParallel1GeoKey, TYPE_DOUBLE, 1,
> +                       poSRS->GetNormProjParm( SRS_PP_STANDARD_PARALLEL_1,
> 0.0 ) ); +        else
> +            GTIFKeySet(psGTIF, ProjScaleAtNatOriginGeoKey, TYPE_DOUBLE, 1,
> +                       poSRS->GetNormProjParm( SRS_PP_SCALE_FACTOR, 1.0 )
> ); }
> 
>      else if( EQUAL(pszProjection,SRS_PT_OBLIQUE_STEREOGRAPHIC) )
> diff --git a/gdal/frmts/gtiff/libgeotiff/geo_normalize.c
> b/gdal/frmts/gtiff/libgeotiff/geo_normalize.c index 4761ea0..75705ee
> 100644
> --- a/gdal/frmts/gtiff/libgeotiff/geo_normalize.c
> +++ b/gdal/frmts/gtiff/libgeotiff/geo_normalize.c
> @@ -1495,8 +1495,65 @@ static void GTIFFetchProjParms( GTIF * psGTIF,
> GTIFDefn * psDefn ) break;
> 
>  /* -------------------------------------------------------------------- */
> -      case CT_LambertConfConic_1SP:
>        case CT_Mercator:
> +/* -------------------------------------------------------------------- */
> +        if( GTIFKeyGet(psGTIF, ProjNatOriginLongGeoKey,
> +                       &dfNatOriginLong, 0, 1 ) == 0
> +            && GTIFKeyGet(psGTIF, ProjFalseOriginLongGeoKey,
> +                          &dfNatOriginLong, 0, 1 ) == 0
> +            && GTIFKeyGet(psGTIF, ProjCenterLongGeoKey,
> +                          &dfNatOriginLong, 0, 1 ) == 0 )
> +            dfNatOriginLong = 0.0;
> +
> +        if( GTIFKeyGet(psGTIF, ProjNatOriginLatGeoKey,
> +                       &dfNatOriginLat, 0, 1 ) == 0
> +            && GTIFKeyGet(psGTIF, ProjFalseOriginLatGeoKey,
> +                          &dfNatOriginLat, 0, 1 ) == 0
> +            && GTIFKeyGet(psGTIF, ProjCenterLatGeoKey,
> +                          &dfNatOriginLat, 0, 1 ) == 0 )
> +            dfNatOriginLat = 0.0;
> +
> +
> +        if( GTIFKeyGet(psGTIF, ProjStdParallel1GeoKey,
> +                       &dfStdParallel1, 0, 1 ) == 0 )
> +            dfStdParallel1 = NAN;
> +
> +        if( GTIFKeyGet(psGTIF, ProjScaleAtNatOriginGeoKey,
> +                       &dfNatOriginScale, 0, 1 ) == 0 )
> +        {
> +            /* Default only if dfStdParallel1 isn't defined */
> +            if( isnan(dfStdParallel1) )
> +                dfNatOriginScale = 1.0;
> +            else
> +                dfNatOriginScale = NAN;
> +        }
> +
> +        /* notdef: should transform to decimal degrees at this point */
> +
> +        psDefn->ProjParm[0] = dfNatOriginLat;
> +        psDefn->ProjParmId[0] = ProjNatOriginLatGeoKey;
> +        psDefn->ProjParm[1] = dfNatOriginLong;
> +        psDefn->ProjParmId[1] = ProjNatOriginLongGeoKey;
> +        if( !isnan(dfStdParallel1) )
> +        {
> +            psDefn->ProjParm[2] = dfStdParallel1;
> +            psDefn->ProjParmId[2] = ProjStdParallel1GeoKey;
> +        }
> +        if( !isnan(dfNatOriginScale) )
> +        {
> +            psDefn->ProjParm[4] = dfNatOriginScale;
> +            psDefn->ProjParmId[4] = ProjScaleAtNatOriginGeoKey;
> +        }
> +        psDefn->ProjParm[5] = dfFalseEasting;
> +        psDefn->ProjParmId[5] = ProjFalseEastingGeoKey;
> +        psDefn->ProjParm[6] = dfFalseNorthing;
> +        psDefn->ProjParmId[6] = ProjFalseNorthingGeoKey;
> +
> +        psDefn->nParms = 7;
> +        break;
> +
> +/* -------------------------------------------------------------------- */
> +      case CT_LambertConfConic_1SP:
>        case CT_ObliqueStereographic:
>        case CT_TransverseMercator:
>        case CT_TransvMercator_SouthOriented:

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From sfkeller at gmail.com  Mon Nov  4 11:30:08 2013
From: sfkeller at gmail.com (Stefan Keller)
Date: Mon, 4 Nov 2013 20:30:08 +0100
Subject: [gdal-dev] [pdal] Building PDAL using pramsey-config.sh
In-Reply-To: <CADBC8F358BE2845B978CF56956066AF04F58740@SID00202.hsr.ch>
References: <CADBC8F358BE2845B978CF56956066AF04F58740@SID00202.hsr.ch>
Message-ID: <CAFcOn28FiUTrG=erd0GJE17nRN135w_u2JicknghYhOoL5-VWw@mail.gmail.com>

Hi PDAL and GDAL list

I'm referring to the error reported above when (still) trying to compile
PDAL with pointcloud support.

What I'm really wondering is why GDAL developpers are calling function
gtCPLRealloc
the same as in GeoTIFF lib but with different declaration?

See
/usr/include/gdal/cpl_port.h:533:89: => ?void* gtCPLRealloc(void*, size_t)?
and
/usr/include/geotiff/cpl_serv.h:144:20 => ?void* gtCPLRealloc(void*, int)?

-S.



2013/10/29 Heng Zhi Feng (zheng at hsr.ch) <zheng at hsr.ch>

>  Hello,
>
>
>
> We are having issues building PDAL on Ubuntu 13.10, following the guide on
> *[1].*
>
>
>
> Initially, PDAL successfully compiles with using the ?cmake ?G ?Unix
> Makefiles? ../? command. However, when trying to import a sample .LAS file
> into PostgreSQL 9.1 using the PDAL Pipeline application. The following
> error occurred ?Caught PDAL exception: Unable to create writer for type
> ?drivers.pgpointcloud.writer?.?.
>
>
>
> Our next approach was to use the script ?pramsey-config.sh? from github
> and was thrown the following errors:
>
>
>
> 1.       In file included from /usr/include/gdal/cpl_conv.h:34:0,
>
>                  from
> /home/zheng/Downloads/PDAL/src/drivers/las/GeotiffSupport.hpp:42,
>
>                  from
> /home/zheng/Downloads/PDAL/src/drivers/las/GeotiffSupport.cpp:35:
>
> /usr/include/gdal/cpl_port.h:533:89: error: declaration of C function
> ?void* gtCPLRealloc(void*, size_t)? conflicts with
>
> #define CPL_WARN_UNUSED_RESULT
> __attribute__((warn_unused_result))
>
>
> ^
>
> /usr/include/gdal/cpl_conv.h:65:44: note: in expansion of macro
> ?_WARN_UNUSED_RESULT?
>
> void CPL_DLL *CPLRealloc( void *, size_t ) CPL_WARN_UNUSED_RESULT;
>
>
>
> 2.       In file included from /usr/include/geotiff/geo_simpletags.h:34:0,
>
>                  from
> /home/zheng/Downloads/PDAL/src/drivers/las/GeotiffSupport.hpp:41,
>
>                  from
> /home/zheng/Downloads/PDAL/src/drivers/las/GeotiffSupport.cpp:35:
>
> /usr/include/geotiff/cpl_serv.h:144:20: error: previous declaration ?void*
> gtCPLRealloc(void*, int)? here
>
> #define CPLRealloc gtCPLRealloc
>
>
>
> ** We had adapted the path for the dependencies to our system in the
> script.
>
>
>
> Would greatly appreciate if someone could advise on how to proceed.
>
>
>
> Thank you.
>
> Regards,
>
> Zhi Feng
>
>
>
> *[1]* http://www.pointcloud.org/compilation/unix.html
>
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/pdal
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131104/00719c77/attachment.html>

From even.rouault at mines-paris.org  Mon Nov  4 11:44:27 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 4 Nov 2013 20:44:27 +0100
Subject: [gdal-dev] [pdal] Building PDAL using pramsey-config.sh
In-Reply-To: <CAFcOn28FiUTrG=erd0GJE17nRN135w_u2JicknghYhOoL5-VWw@mail.gmail.com>
References: <CADBC8F358BE2845B978CF56956066AF04F58740@SID00202.hsr.ch>
	<CAFcOn28FiUTrG=erd0GJE17nRN135w_u2JicknghYhOoL5-VWw@mail.gmail.com>
Message-ID: <201311042044.27734.even.rouault@mines-paris.org>

Le lundi 04 novembre 2013 20:30:08, Stefan Keller a ?crit :
> Hi PDAL and GDAL list
> 
> I'm referring to the error reported above when (still) trying to compile
> PDAL with pointcloud support.
> 
> What I'm really wondering is why GDAL developpers are calling function
> gtCPLRealloc
> the same as in GeoTIFF lib but with different declaration?
> 
> See
> /usr/include/gdal/cpl_port.h:533:89: => ?void* gtCPLRealloc(void*, size_t)?
> and
> /usr/include/geotiff/cpl_serv.h:144:20 => ?void* gtCPLRealloc(void*, int)?
> 
> -S.

Not sure if the issue comes from GDAL. Looks a bit more like a bad interaction 
between libgeotiff "simplified" CPL library ( 
http://trac.osgeo.org/geotiff/browser/trunk/libgeotiff/cpl_serv.h ) when mixed 
with GDAL headers. Perhaps libgeotiff should be updated to use size_t instead 
of int ?

If doable, the best thing would be for PDAL to avoid including in the same 
.cpp file both geotiff/cpl_serv.h and gdal/cpl_port.h. Or cheating by #define 
CPL_SERV_H_INCLUDED before including libgeotiff headers.

This reminds me of a similar discussion : 
http://trac.osgeo.org/gdal/ticket/4374

Even

> 
> 
> 
> 2013/10/29 Heng Zhi Feng (zheng at hsr.ch) <zheng at hsr.ch>
> 
> >  Hello,
> > 
> > We are having issues building PDAL on Ubuntu 13.10, following the guide
> > on *[1].*
> > 
> > 
> > 
> > Initially, PDAL successfully compiles with using the ?cmake ?G ?Unix
> > Makefiles? ../? command. However, when trying to import a sample .LAS
> > file into PostgreSQL 9.1 using the PDAL Pipeline application. The
> > following error occurred ?Caught PDAL exception: Unable to create writer
> > for type ?drivers.pgpointcloud.writer?.?.
> > 
> > 
> > 
> > Our next approach was to use the script ?pramsey-config.sh? from github
> > and was thrown the following errors:
> > 
> > 
> > 
> > 1.       In file included from /usr/include/gdal/cpl_conv.h:34:0,
> > 
> >                  from
> > 
> > /home/zheng/Downloads/PDAL/src/drivers/las/GeotiffSupport.hpp:42,
> > 
> >                  from
> > 
> > /home/zheng/Downloads/PDAL/src/drivers/las/GeotiffSupport.cpp:35:
> > 
> > /usr/include/gdal/cpl_port.h:533:89: error: declaration of C function
> > ?void* gtCPLRealloc(void*, size_t)? conflicts with
> > 
> > #define CPL_WARN_UNUSED_RESULT
> > __attribute__((warn_unused_result))
> > 
> > 
> > ^
> > 
> > /usr/include/gdal/cpl_conv.h:65:44: note: in expansion of macro
> > ?_WARN_UNUSED_RESULT?
> > 
> > void CPL_DLL *CPLRealloc( void *, size_t ) CPL_WARN_UNUSED_RESULT;
> > 
> > 
> > 
> > 2.       In file included from
> > /usr/include/geotiff/geo_simpletags.h:34:0,
> > 
> >                  from
> > 
> > /home/zheng/Downloads/PDAL/src/drivers/las/GeotiffSupport.hpp:41,
> > 
> >                  from
> > 
> > /home/zheng/Downloads/PDAL/src/drivers/las/GeotiffSupport.cpp:35:
> > 
> > /usr/include/geotiff/cpl_serv.h:144:20: error: previous declaration
> > ?void* gtCPLRealloc(void*, int)? here
> > 
> > #define CPLRealloc gtCPLRealloc
> > 
> > 
> > 
> > ** We had adapted the path for the dependencies to our system in the
> > script.
> > 
> > 
> > 
> > Would greatly appreciate if someone could advise on how to proceed.
> > 
> > 
> > 
> > Thank you.
> > 
> > Regards,
> > 
> > Zhi Feng
> > 
> > 
> > 
> > *[1]* http://www.pointcloud.org/compilation/unix.html
> > 
> > _______________________________________________
> > pdal mailing list
> > pdal at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/pdal

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From sfkeller at gmail.com  Mon Nov  4 14:01:03 2013
From: sfkeller at gmail.com (Stefan Keller)
Date: Mon, 4 Nov 2013 23:01:03 +0100
Subject: [gdal-dev] [pdal] Building PDAL using pramsey-config.sh
In-Reply-To: <201311042044.27734.even.rouault@mines-paris.org>
References: <CADBC8F358BE2845B978CF56956066AF04F58740@SID00202.hsr.ch>
	<CAFcOn28FiUTrG=erd0GJE17nRN135w_u2JicknghYhOoL5-VWw@mail.gmail.com>
	<201311042044.27734.even.rouault@mines-paris.org>
Message-ID: <CAFcOn2_HCqkjUZhffdc3o_BvQV_Z5T9RkipO1J1s4Pyv+VnK_Q@mail.gmail.com>

Hi Even

2013/11/4 Even Rouault <even.rouault at mines-paris.org> wrote:
> If doable, the best thing would be for PDAL to avoid including in the same
> .cpp file both geotiff/cpl_serv.h and gdal/cpl_port.h. Or cheating by
#define
> CPL_SERV_H_INCLUDED before including libgeotiff headers.

Merci beaucoups, Even.
I'll try to forward this hint to PDAL devs.

Yours, Stefan


2013/11/4 Even Rouault <even.rouault at mines-paris.org>

> Le lundi 04 novembre 2013 20:30:08, Stefan Keller a ?crit :
> > Hi PDAL and GDAL list
> >
> > I'm referring to the error reported above when (still) trying to compile
> > PDAL with pointcloud support.
> >
> > What I'm really wondering is why GDAL developpers are calling function
> > gtCPLRealloc
> > the same as in GeoTIFF lib but with different declaration?
> >
> > See
> > /usr/include/gdal/cpl_port.h:533:89: => ?void* gtCPLRealloc(void*,
> size_t)?
> > and
> > /usr/include/geotiff/cpl_serv.h:144:20 => ?void* gtCPLRealloc(void*,
> int)?
> >
> > -S.
>
> Not sure if the issue comes from GDAL. Looks a bit more like a bad
> interaction
> between libgeotiff "simplified" CPL library (
> http://trac.osgeo.org/geotiff/browser/trunk/libgeotiff/cpl_serv.h ) when
> mixed
> with GDAL headers. Perhaps libgeotiff should be updated to use size_t
> instead
> of int ?
>
> If doable, the best thing would be for PDAL to avoid including in the same
> .cpp file both geotiff/cpl_serv.h and gdal/cpl_port.h. Or cheating by
> #define
> CPL_SERV_H_INCLUDED before including libgeotiff headers.
>
> This reminds me of a similar discussion :
> http://trac.osgeo.org/gdal/ticket/4374
>
> Even
>
> >
> >
> >
> > 2013/10/29 Heng Zhi Feng (zheng at hsr.ch) <zheng at hsr.ch>
> >
> > >  Hello,
> > >
> > > We are having issues building PDAL on Ubuntu 13.10, following the guide
> > > on *[1].*
> > >
> > >
> > >
> > > Initially, PDAL successfully compiles with using the ?cmake ?G ?Unix
> > > Makefiles? ../? command. However, when trying to import a sample .LAS
> > > file into PostgreSQL 9.1 using the PDAL Pipeline application. The
> > > following error occurred ?Caught PDAL exception: Unable to create
> writer
> > > for type ?drivers.pgpointcloud.writer?.?.
> > >
> > >
> > >
> > > Our next approach was to use the script ?pramsey-config.sh? from github
> > > and was thrown the following errors:
> > >
> > >
> > >
> > > 1.       In file included from /usr/include/gdal/cpl_conv.h:34:0,
> > >
> > >                  from
> > >
> > > /home/zheng/Downloads/PDAL/src/drivers/las/GeotiffSupport.hpp:42,
> > >
> > >                  from
> > >
> > > /home/zheng/Downloads/PDAL/src/drivers/las/GeotiffSupport.cpp:35:
> > >
> > > /usr/include/gdal/cpl_port.h:533:89: error: declaration of C function
> > > ?void* gtCPLRealloc(void*, size_t)? conflicts with
> > >
> > > #define CPL_WARN_UNUSED_RESULT
> > > __attribute__((warn_unused_result))
> > >
> > >
> > > ^
> > >
> > > /usr/include/gdal/cpl_conv.h:65:44: note: in expansion of macro
> > > ?_WARN_UNUSED_RESULT?
> > >
> > > void CPL_DLL *CPLRealloc( void *, size_t ) CPL_WARN_UNUSED_RESULT;
> > >
> > >
> > >
> > > 2.       In file included from
> > > /usr/include/geotiff/geo_simpletags.h:34:0,
> > >
> > >                  from
> > >
> > > /home/zheng/Downloads/PDAL/src/drivers/las/GeotiffSupport.hpp:41,
> > >
> > >                  from
> > >
> > > /home/zheng/Downloads/PDAL/src/drivers/las/GeotiffSupport.cpp:35:
> > >
> > > /usr/include/geotiff/cpl_serv.h:144:20: error: previous declaration
> > > ?void* gtCPLRealloc(void*, int)? here
> > >
> > > #define CPLRealloc gtCPLRealloc
> > >
> > >
> > >
> > > ** We had adapted the path for the dependencies to our system in the
> > > script.
> > >
> > >
> > >
> > > Would greatly appreciate if someone could advise on how to proceed.
> > >
> > >
> > >
> > > Thank you.
> > >
> > > Regards,
> > >
> > > Zhi Feng
> > >
> > >
> > >
> > > *[1]* http://www.pointcloud.org/compilation/unix.html
> > >
> > > _______________________________________________
> > > pdal mailing list
> > > pdal at lists.osgeo.org
> > > http://lists.osgeo.org/mailman/listinfo/pdal
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131104/f026a929/attachment.html>

From tpiepho at gmail.com  Mon Nov  4 15:04:55 2013
From: tpiepho at gmail.com (Trent Piepho)
Date: Mon, 4 Nov 2013 15:04:55 -0800
Subject: [gdal-dev] [PATCH] Support Mercator_2SP in GeoTIFF
In-Reply-To: <201311042012.56445.even.rouault@mines-paris.org>
References: <CA+7tXijW79KR+LfVVHi3NtVQkrjFmez-WA_0FXpaMNCM3JDqvQ@mail.gmail.com>
	<1383529706-26601-1-git-send-email-tpiepho@gmail.com>
	<201311042012.56445.even.rouault@mines-paris.org>
Message-ID: <CA+7tXij1gFBOdrn6Mp0urD_UKFtXLHW6AoB9cKW0TnhRpd+sdA@mail.gmail.com>

I've never used or built GeoTools, so I didn't actually run the
software to test it.  I did examine the code for geotools and am
fairly confident they are handling 1SP/2SP in geotiff the same way I
am.  If anyone uses geotools, I can provide a geotiff in 2sp.

The ticket is the same issue and I think I've resolved it in the
manner proposed by Frank Warmerdam in
http://trac.osgeo.org/gdal/ticket/1797#comment:4

The issue with the file in the ticket is that it specifies a latitude
of origin other than the equator and does not specify a standard
latitude 1.  Does the latitude in the file refer to the origin, i.e.
where y = 0, or the latitude of true scale, e.g. where k=1?

Given the keys available in geotiff, it seems to clearly be the best
that ProjNatOriginLatGeoKey should be the origin and
ProjStdParallel1GeoKey should be lat_ts.

However, proj4 doesn't support a latitude of origin other than 0 for
Mercator, or even have a way to specify it for that matter.  Thus one
might consider it to not be a parameter for the projection.  This
leaves lat_ts as the sole latitude to be specified.  One might then
place it in ProjNatOriginLatGeoKey, as that is usually the first
latitude parameter used in a projection.  IMHO, this is clearly wrong
and the result of a careless programmer just copying a pattern from
another projection without considering exactly what they were doing.

Another possibility when reading GeoTIFFs that specify lat_ts, is to
normalize them to 1SP, i.e. lat_ts=0, and a k other than 1.  However,
calculating k from lat_ts requires some non-trivial math that involves
the eccentricity of the ellipsoid and it seems far more appropriate to
do that in proj4/ogr than in libgeotiff.  It also seem like a bad idea
for maintaining accuracy.  For instance, NOAA chart 18440 says on the
chart, "Scale 1:150,000 at Lat 47o 40'" and I produce WKT projection
with, PARAMETER["standard_parallel_1",47.667] for that chart.  The
same number as in the chart.  If that's converted to a scale factor
it's not going to have the same parameter anymore.  And while
theoretically exact, floating point math and ASCII decimal numbers are
going to result in converting lat_ts -> k -> lat_ts not producing the
same value as input.


On Mon, Nov 4, 2013 at 11:12 AM, Even Rouault
<even.rouault at mines-paris.org> wrote:
> Trent / others,
>
> Although your patch comes with a detailed analysis, I find myself a bit light
> on the topic to blindly apply it.
>
> A few observations :
>
> * I found an old ticket that might be related
> http://trac.osgeo.org/gdal/ticket/1797. Would your patch solve the issue
> raised in that ticket ?
>
> * You mention that you followed what Geotools did. Did you actually check the
> interoperability of generated files ?
>
> * Do people have knowledge of other software (not based on GDAL) that would
> read / produce GeoTIFFs with a Mercator_2SP projection, and could provide
> samples ?
>
> * Now on the patch itself, there's a GDAL part (gt_wkt_srs.cpp) and a
> libgeotiff one (libgeotiff/geo_normalize.c). The later should be submitted in
> GeoTIFF trac http://trac.osgeo.org/geotiff/newticket and approved there, before
> being downstreamed into GDAL
>
> * Concerning the patch geo_normalize.c, the use of NAN / isnan() could cause
> portability issues on some platforms. I'd suggest using boolean flags instead.
>
> I've added geotiff mailing list in CC, in the hope of broadening the target
> audience. And Daniele too if he has some memories of his experience with fixing
> http://jira.codehaus.org/browse/GEOT-2163 (particularly if he had the
> opportunity to check interoperability with other software)
>
> Best regards,
>
> Even
>
> Le lundi 04 novembre 2013 02:48:26, Trent Piepho a ?crit :
>> Mercator_[12]SP are both the same projection in GeoTIFF.  Lacking a
>> definition in the official specification, the intention appears to be that
>> for Mercator_2SP the latitude of true scale (lat_ts) should be specified in
>> ProjStdParallel1GeoKey and for Mercator_2SP the scale at origin (k) should
>> be specified in ProjScaleAtNatOriginGeoKey.
>>
>> Current behavior when creating a GTiff with 2SP is to drop lat_ts and
>> create a default k value of 1.0, which will product an incorrect
>> projection.  When reading, a default k of 1.0 is used and lat_ts is
>> ignored, also changing the projection.
>>
>> This patches changes the behavior to supply ProjScaleAtNatOriginGeoKey for
>> Mercator_1SP or ProjStdParallel1GeoKey for Mercator_2SP when writing.
>>
>> For reading either or both values are supplied when present by libgeotiff's
>> normalization code.  If neither is present, a default k of 1.0 is created.
>>
>> GDAL's GTiff driver is changed to create a 2SP projection is lat_ts is
>> present, 1SP otherwise.  It emits a warning of both last_ts and scale are
>> present (and ignores scale).
>> ---
>>  gdal/frmts/gtiff/gt_wkt_srs.cpp             |   28 ++++++++++---
>>  gdal/frmts/gtiff/libgeotiff/geo_normalize.c |   59
>> ++++++++++++++++++++++++++- 2 files changed, 80 insertions(+), 7
>> deletions(-)
>>
>> diff --git a/gdal/frmts/gtiff/gt_wkt_srs.cpp
>> b/gdal/frmts/gtiff/gt_wkt_srs.cpp index 5934df5..0afb101 100644
>> --- a/gdal/frmts/gtiff/gt_wkt_srs.cpp
>> +++ b/gdal/frmts/gtiff/gt_wkt_srs.cpp
>> @@ -737,9 +737,21 @@ char *GTIFGetOGISDefn( GTIF *hGTIF, GTIFDefn * psDefn
>> ) break;
>>
>>            case CT_Mercator:
>> -            oSRS.SetMercator( adfParm[0], adfParm[1],
>> -                              adfParm[4],
>> -                              adfParm[5], adfParm[6] );
>> +            /* If a lat_ts was specified use 2SP, otherwise use 1SP */
>> +            if (psDefn->ProjParmId[2] == ProjStdParallel1GeoKey)
>> +            {
>> +                if (psDefn->ProjParmId[4] == ProjScaleAtNatOriginGeoKey)
>> +                    CPLError( CE_Warning, CPLE_AppDefined,
>> +                              "Mercator projection should not define both
>> StdParallel1 and ScaleAtNatOrigin.\n" +
>> "Using StdParallel1 and ignoring ScaleAtNatOrigin.\n" ); +
>> oSRS.SetMercator2SP( adfParm[2],
>> +                                     adfParm[0], adfParm[1],
>> +                                     adfParm[5], adfParm[6]);
>> +            }
>> +            else
>> +                oSRS.SetMercator( adfParm[0], adfParm[1],
>> +                                  adfParm[4],
>> +                                  adfParm[5], adfParm[6] );
>>
>>              if (psDefn->Projection == 1024 || psDefn->Projection == 9841)
>> // override hack for google mercator. {
>> @@ -1510,14 +1522,18 @@ int GTIFSetFromOGISDefn( GTIF * psGTIF, const char
>> *pszOGCWKT ) GTIFKeySet(psGTIF, ProjNatOriginLongGeoKey, TYPE_DOUBLE, 1,
>> poSRS->GetNormProjParm( SRS_PP_CENTRAL_MERIDIAN, 0.0 ) );
>>
>> -        GTIFKeySet(psGTIF, ProjScaleAtNatOriginGeoKey, TYPE_DOUBLE, 1,
>> -                   poSRS->GetNormProjParm( SRS_PP_SCALE_FACTOR, 1.0 ) );
>> -
>>          GTIFKeySet(psGTIF, ProjFalseEastingGeoKey, TYPE_DOUBLE, 1,
>>                     poSRS->GetProjParm( SRS_PP_FALSE_EASTING, 0.0 ) );
>>
>>          GTIFKeySet(psGTIF, ProjFalseNorthingGeoKey, TYPE_DOUBLE, 1,
>>                     poSRS->GetProjParm( SRS_PP_FALSE_NORTHING, 0.0 ) );
>> +
>> +        if( EQUAL(pszProjection,SRS_PT_MERCATOR_2SP) )
>> +            GTIFKeySet(psGTIF, ProjStdParallel1GeoKey, TYPE_DOUBLE, 1,
>> +                       poSRS->GetNormProjParm( SRS_PP_STANDARD_PARALLEL_1,
>> 0.0 ) ); +        else
>> +            GTIFKeySet(psGTIF, ProjScaleAtNatOriginGeoKey, TYPE_DOUBLE, 1,
>> +                       poSRS->GetNormProjParm( SRS_PP_SCALE_FACTOR, 1.0 )
>> ); }
>>
>>      else if( EQUAL(pszProjection,SRS_PT_OBLIQUE_STEREOGRAPHIC) )
>> diff --git a/gdal/frmts/gtiff/libgeotiff/geo_normalize.c
>> b/gdal/frmts/gtiff/libgeotiff/geo_normalize.c index 4761ea0..75705ee
>> 100644
>> --- a/gdal/frmts/gtiff/libgeotiff/geo_normalize.c
>> +++ b/gdal/frmts/gtiff/libgeotiff/geo_normalize.c
>> @@ -1495,8 +1495,65 @@ static void GTIFFetchProjParms( GTIF * psGTIF,
>> GTIFDefn * psDefn ) break;
>>
>>  /* -------------------------------------------------------------------- */
>> -      case CT_LambertConfConic_1SP:
>>        case CT_Mercator:
>> +/* -------------------------------------------------------------------- */
>> +        if( GTIFKeyGet(psGTIF, ProjNatOriginLongGeoKey,
>> +                       &dfNatOriginLong, 0, 1 ) == 0
>> +            && GTIFKeyGet(psGTIF, ProjFalseOriginLongGeoKey,
>> +                          &dfNatOriginLong, 0, 1 ) == 0
>> +            && GTIFKeyGet(psGTIF, ProjCenterLongGeoKey,
>> +                          &dfNatOriginLong, 0, 1 ) == 0 )
>> +            dfNatOriginLong = 0.0;
>> +
>> +        if( GTIFKeyGet(psGTIF, ProjNatOriginLatGeoKey,
>> +                       &dfNatOriginLat, 0, 1 ) == 0
>> +            && GTIFKeyGet(psGTIF, ProjFalseOriginLatGeoKey,
>> +                          &dfNatOriginLat, 0, 1 ) == 0
>> +            && GTIFKeyGet(psGTIF, ProjCenterLatGeoKey,
>> +                          &dfNatOriginLat, 0, 1 ) == 0 )
>> +            dfNatOriginLat = 0.0;
>> +
>> +
>> +        if( GTIFKeyGet(psGTIF, ProjStdParallel1GeoKey,
>> +                       &dfStdParallel1, 0, 1 ) == 0 )
>> +            dfStdParallel1 = NAN;
>> +
>> +        if( GTIFKeyGet(psGTIF, ProjScaleAtNatOriginGeoKey,
>> +                       &dfNatOriginScale, 0, 1 ) == 0 )
>> +        {
>> +            /* Default only if dfStdParallel1 isn't defined */
>> +            if( isnan(dfStdParallel1) )
>> +                dfNatOriginScale = 1.0;
>> +            else
>> +                dfNatOriginScale = NAN;
>> +        }
>> +
>> +        /* notdef: should transform to decimal degrees at this point */
>> +
>> +        psDefn->ProjParm[0] = dfNatOriginLat;
>> +        psDefn->ProjParmId[0] = ProjNatOriginLatGeoKey;
>> +        psDefn->ProjParm[1] = dfNatOriginLong;
>> +        psDefn->ProjParmId[1] = ProjNatOriginLongGeoKey;
>> +        if( !isnan(dfStdParallel1) )
>> +        {
>> +            psDefn->ProjParm[2] = dfStdParallel1;
>> +            psDefn->ProjParmId[2] = ProjStdParallel1GeoKey;
>> +        }
>> +        if( !isnan(dfNatOriginScale) )
>> +        {
>> +            psDefn->ProjParm[4] = dfNatOriginScale;
>> +            psDefn->ProjParmId[4] = ProjScaleAtNatOriginGeoKey;
>> +        }
>> +        psDefn->ProjParm[5] = dfFalseEasting;
>> +        psDefn->ProjParmId[5] = ProjFalseEastingGeoKey;
>> +        psDefn->ProjParm[6] = dfFalseNorthing;
>> +        psDefn->ProjParmId[6] = ProjFalseNorthingGeoKey;
>> +
>> +        psDefn->nParms = 7;
>> +        break;
>> +
>> +/* -------------------------------------------------------------------- */
>> +      case CT_LambertConfConic_1SP:
>>        case CT_ObliqueStereographic:
>>        case CT_TransverseMercator:
>>        case CT_TransvMercator_SouthOriented:
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html

From Roger.Bivand at nhh.no  Tue Nov  5 07:25:11 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 5 Nov 2013 16:25:11 +0100
Subject: [gdal-dev] Locked files under Windows
Message-ID: <alpine.LRH.2.03.1311051606520.949@reclus.nhh.no>

Hi,

This is probably my muddle, but we have an unresolved problem in rgdal on 
Windows:

https://stat.ethz.ch/pipermail/r-sig-geo/2013-October/019667.html
https://stat.ethz.ch/pipermail/r-sig-geo/2013-November/019701.html

where temporary files created with pDriver->Create() are open and locked 
under Windows in rgdal/src/gdal-bindings.cpp line 556.

Under Linux (and possibly OSX, untested by me), unlink() works even though 
lsof shows them to be open. Because rgdal loads GDAL into a running R 
session, the undeleted temporary files can accumulate. This is in contrast 
to use in GRASS or GDAL utilities, where the "owning" process itself 
terminates quickly, freeing the lock. In gcore/gdaldriver.cpp, I don't see 
platform-specific fixes; we've been trying mainly with GTiff, but other 
drivers seem to show the same behaviour.

Grateful for any input,

Roger

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From even.rouault at mines-paris.org  Tue Nov  5 07:43:01 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 05 Nov 2013 16:43:01 +0100
Subject: [gdal-dev] Locked files under Windows
In-Reply-To: <alpine.LRH.2.03.1311051606520.949@reclus.nhh.no>
References: <alpine.LRH.2.03.1311051606520.949@reclus.nhh.no>
Message-ID: <1383666181.527912059b1e4@imp.free.fr>

Selon Roger Bivand <Roger.Bivand at nhh.no>:

> Hi,
>
> This is probably my muddle, but we have an unresolved problem in rgdal on
> Windows:
>
> https://stat.ethz.ch/pipermail/r-sig-geo/2013-October/019667.html
> https://stat.ethz.ch/pipermail/r-sig-geo/2013-November/019701.html
>
> where temporary files created with pDriver->Create() are open and locked
> under Windows in rgdal/src/gdal-bindings.cpp line 556.

Roger,

The file handle will be released when you destroy the datasource object returned
by GDALDriver::Create() (that you should call for other good reasons, such as to
free other memory ressources, and to properly flush all data to file). Then you
can call unlink(). The fact that Unix system can unlink() a still opened file is
a POSIX specific behaviour (I think), whereas Windows doesn't allow that.
Nothing to do with GDAL code. So for portable code, file closing should be done
before file unlinking.

Even

>
> Under Linux (and possibly OSX, untested by me), unlink() works even though
> lsof shows them to be open. Because rgdal loads GDAL into a running R
> session, the undeleted temporary files can accumulate. This is in contrast
> to use in GRASS or GDAL utilities, where the "owning" process itself
> terminates quickly, freeing the lock. In gcore/gdaldriver.cpp, I don't see
> platform-specific fixes; we've been trying mainly with GTiff, but other
> drivers seem to show the same behaviour.
>
> Grateful for any input,
>
> Roger
>
> --
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>

From Roger.Bivand at nhh.no  Tue Nov  5 09:33:21 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 5 Nov 2013 18:33:21 +0100
Subject: [gdal-dev] Locked files under Windows
In-Reply-To: <1383666181.527912059b1e4@imp.free.fr>
References: <alpine.LRH.2.03.1311051606520.949@reclus.nhh.no>
	<1383666181.527912059b1e4@imp.free.fr>
Message-ID: <alpine.LRH.2.03.1311051824230.1536@reclus.nhh.no>

On Tue, 5 Nov 2013, Even Rouault wrote:

> Selon Roger Bivand <Roger.Bivand at nhh.no>:
>
>> Hi,
>>
>> This is probably my muddle, but we have an unresolved problem in rgdal on
>> Windows:
>>
>> https://stat.ethz.ch/pipermail/r-sig-geo/2013-October/019667.html
>> https://stat.ethz.ch/pipermail/r-sig-geo/2013-November/019701.html
>>
>> where temporary files created with pDriver->Create() are open and locked
>> under Windows in rgdal/src/gdal-bindings.cpp line 556.
>
> Roger,
>
> The file handle will be released when you destroy the datasource object 
> returned by GDALDriver::Create() (that you should call for other good 
> reasons, such as to free other memory ressources, and to properly flush 
> all data to file). Then you can call unlink(). The fact that Unix system 
> can unlink() a still opened file is a POSIX specific behaviour (I 
> think), whereas Windows doesn't allow that. Nothing to do with GDAL 
> code. So for portable code, file closing should be done before file 
> unlinking.

Even,

Thanks as always for getting back quickly! Yes, the relevant code is (line 
475 in rgdal/src/gdal-bindings.cpp):

   GDALDataset *pDataset =
     (GDALDataset *) R_ExternalPtrAddr(sxpHandle);

   if (pDataset == NULL) return(R_NilValue);

   installErrorHandler();

   GDALDriver *pDriver = pDataset->GetDriver();

   const char *filename = pDataset->GetDescription();

   GDALDeleteDataset((GDALDriverH) pDriver, filename);

   R_ClearExternalPtr(sxpHandle);

   uninstallErrorHandlerAndTriggerError();

but after this is run, the file remains open. Is GDALDeleteDataset() 
inappropriate? Should we say GDALClose((GDALDatasetH)pDataset); first; you 
suggested this instead of pDataset->~GDALDataset(); last year? The file 
pointers are inside the Dataset objects, so obviously they should be 
closed. We have tried putting things in various orders, without success so 
far, I'm afraid.

Best wishes,

Roger

>
> Even
>
>>
>> Under Linux (and possibly OSX, untested by me), unlink() works even though
>> lsof shows them to be open. Because rgdal loads GDAL into a running R
>> session, the undeleted temporary files can accumulate. This is in contrast
>> to use in GRASS or GDAL utilities, where the "owning" process itself
>> terminates quickly, freeing the lock. In gcore/gdaldriver.cpp, I don't see
>> platform-specific fixes; we've been trying mainly with GTiff, but other
>> drivers seem to show the same behaviour.
>>
>> Grateful for any input,
>>
>> Roger
>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From even.rouault at mines-paris.org  Tue Nov  5 10:59:54 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 5 Nov 2013 19:59:54 +0100
Subject: [gdal-dev] Locked files under Windows
In-Reply-To: <alpine.LRH.2.03.1311051824230.1536@reclus.nhh.no>
References: <alpine.LRH.2.03.1311051606520.949@reclus.nhh.no>
	<1383666181.527912059b1e4@imp.free.fr>
	<alpine.LRH.2.03.1311051824230.1536@reclus.nhh.no>
Message-ID: <201311051959.54351.even.rouault@mines-paris.org>

> Even,
> 
> Thanks as always for getting back quickly! Yes, the relevant code is (line
> 475 in rgdal/src/gdal-bindings.cpp):
> 
>    GDALDataset *pDataset =
>      (GDALDataset *) R_ExternalPtrAddr(sxpHandle);
> 
>    if (pDataset == NULL) return(R_NilValue);
> 
>    installErrorHandler();
> 
>    GDALDriver *pDriver = pDataset->GetDriver();
> 
>    const char *filename = pDataset->GetDescription();
> 
>    GDALDeleteDataset((GDALDriverH) pDriver, filename);
> 
>    R_ClearExternalPtr(sxpHandle);
> 
>    uninstallErrorHandlerAndTriggerError();
> 
> but after this is run, the file remains open. Is GDALDeleteDataset()
> inappropriate? Should we say GDALClose((GDALDatasetH)pDataset); first; you
> suggested this instead of pDataset->~GDALDataset(); last year? The file
> pointers are inside the Dataset objects, so obviously they should be
> closed. We have tried putting things in various orders, without success so
> far, I'm afraid.

GDALDeleteDataset() doesn't take the dataset object as a parameter, so it will 
not delete it for you (in the C++ sense of delete... The naming of functions 
is a bit confusing admitedly)

Yes, you need to call GDALClose() before GDALDeleteDataset(), and make sure 
that the handle to the dataset is no used afterwards of course. I mention that 
because I'm not sure what R_ClearExternalPtr() does.


> 
> Best wishes,
> 
> Roger
> 


-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From Roger.Bivand at nhh.no  Tue Nov  5 11:10:56 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 5 Nov 2013 20:10:56 +0100
Subject: [gdal-dev] Locked files under Windows
In-Reply-To: <201311051959.54351.even.rouault@mines-paris.org>
References: <alpine.LRH.2.03.1311051606520.949@reclus.nhh.no>
	<1383666181.527912059b1e4@imp.free.fr>
	<alpine.LRH.2.03.1311051824230.1536@reclus.nhh.no>
	<201311051959.54351.even.rouault@mines-paris.org>
Message-ID: <alpine.LRH.2.03.1311052006060.1859@reclus.nhh.no>

On Tue, 5 Nov 2013, Even Rouault wrote:

>> Even,
>>
>> Thanks as always for getting back quickly! Yes, the relevant code is (line
>> 475 in rgdal/src/gdal-bindings.cpp):
>>
>>    GDALDataset *pDataset =
>>      (GDALDataset *) R_ExternalPtrAddr(sxpHandle);
>>
>>    if (pDataset == NULL) return(R_NilValue);
>>
>>    installErrorHandler();
>>
>>    GDALDriver *pDriver = pDataset->GetDriver();
>>
>>    const char *filename = pDataset->GetDescription();
>>
>>    GDALDeleteDataset((GDALDriverH) pDriver, filename);
>>
>>    R_ClearExternalPtr(sxpHandle);
>>
>>    uninstallErrorHandlerAndTriggerError();
>>
>> but after this is run, the file remains open. Is GDALDeleteDataset()
>> inappropriate? Should we say GDALClose((GDALDatasetH)pDataset); first; you
>> suggested this instead of pDataset->~GDALDataset(); last year? The file
>> pointers are inside the Dataset objects, so obviously they should be
>> closed. We have tried putting things in various orders, without success so
>> far, I'm afraid.
>
> GDALDeleteDataset() doesn't take the dataset object as a parameter, so it will
> not delete it for you (in the C++ sense of delete... The naming of functions
> is a bit confusing admitedly)
>
> Yes, you need to call GDALClose() before GDALDeleteDataset(), and make sure
> that the handle to the dataset is no used afterwards of course. I mention that
> because I'm not sure what R_ClearExternalPtr() does.

Right - I've been trying this based on your first reply, which put me "on 
track". I think that we have assumed that GDALDeleteDataset() took an open 
dataset and deleted it, closing, freeing and unlinking combined. It makes 
sense, though, to close first after having stored the arguments to 
GDALDeleteDataset(). The R_ClearExternalPtr() function clears the internal 
object in R in which external pointers are stored, so would zombie the 
dataset if applied too early. Initial tests on Linux and Windows are 
promising ...

Thanks again,

Roger

>
>
>>
>> Best wishes,
>>
>> Roger
>>
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From howard at hobu.co  Tue Nov  5 15:02:55 2013
From: howard at hobu.co (Howard Butler)
Date: Tue, 5 Nov 2013 17:02:55 -0600
Subject: [gdal-dev] [pdal] Building PDAL using pramsey-config.sh
In-Reply-To: <201311042044.27734.even.rouault@mines-paris.org>
References: <CADBC8F358BE2845B978CF56956066AF04F58740@SID00202.hsr.ch>
	<CAFcOn28FiUTrG=erd0GJE17nRN135w_u2JicknghYhOoL5-VWw@mail.gmail.com>
	<201311042044.27734.even.rouault@mines-paris.org>
Message-ID: <F35BC886-8F07-4D60-9988-83E0EDAB9F05@hobu.co>


On Nov 4, 2013, at 1:44 PM, Even Rouault <even.rouault at mines-paris.org> wrote:

> If doable, the best thing would be for PDAL to avoid including in the same 
> .cpp file both geotiff/cpl_serv.h and gdal/cpl_port.h. Or cheating by #define 
> CPL_SERV_H_INCLUDED before including libgeotiff headers.

I'll make the change of #define'ing CPL_SERV_H_INCLUDED in PDAL.

I will also note that there is now a Vagrant configuration for PDAL in the master branch that you can use to stand up an Ubuntu instance and play around with things like pgpointcloud, etc. See http://www.pointcloud.org/vagrant.html for more information and https://github.com/PDAL/PDAL/tree/master/scripts/vagrant for the configuration scripts used to build it all out.

Howard

PS, I'm sorry that for some reason I missed the original email on this thread. 



From antonio.rocha at deimos.com.pt  Tue Nov  5 17:29:48 2013
From: antonio.rocha at deimos.com.pt (=?ISO-8859-1?Q?Ant=F3nio_Rocha?=)
Date: Wed, 06 Nov 2013 01:29:48 +0000
Subject: [gdal-dev] Using gdal_translate to convert to KML overlay
Message-ID: <52799B8C.2010308@deimos.com.pt>

Dear all,
I'm using a similar command line like this to convert a geotiff RASTER 
to KMZ but

gdal_translate.exe -of KMLSUPEROVERLAY c:\in.tif c:\out.kmz -co FORMAT=JPEG

All I get is a totally black image. Any tips on how to solve this?

REgards,
Antonio
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131106/a86e9cb5/attachment.html>

From ahuarte47 at yahoo.es  Wed Nov  6 04:59:56 2013
From: ahuarte47 at yahoo.es (A Huarte)
Date: Wed, 6 Nov 2013 12:59:56 +0000 (GMT)
Subject: [gdal-dev] Speed improvement for OGR shapefile provider
In-Reply-To: <1382444255.52666cdf9f2aa@imp.free.fr>
References: <1382436809.97952.YahooMailNeo@web28903.mail.ir2.yahoo.com>
	<1382444255.52666cdf9f2aa@imp.free.fr>
Message-ID: <1383742796.35102.YahooMailNeo@web28904.mail.ir2.yahoo.com>

Hi, I made tests with 'test_ogrsf.exe' and a dbase file.


https://github.com/OSGeo/gdal/pull/24


Regards



>________________________________
> De: Even Rouault <even.rouault at mines-paris.org>
>Para: A Huarte <ahuarte47 at yahoo.es> 
>CC: "gdal-dev at lists.osgeo.org" <gdal-dev at lists.osgeo.org> 
>Enviado: Martes 22 de octubre de 2013 14:17
>Asunto: Re: [gdal-dev]  Support of filemapping for fast rendering in QGIS...
> 
>
>Selon A Huarte <ahuarte47 at yahoo.es>:
>
>> Hi, I want improve the rendering of vector features in QGIS.?
>>
>> I have opened a new branch?of code in the repository of
>>
>QGIS(https://github.com/qgis/QGIS/pull/927?//?https://github.com/ahuarte47/QGIS/tree/Issue_8725-OGR)?and
>> the drawing tests give me ~3x faster that original code :-)
>
>On which OS ?
>Is it the performance gain of QGIS + OGR changes combined ?
>What is the speed-up in OGR side only ? You could for example use the test_ogrsf
>utility as a potential benchmark. You have to build explicitely? with "make
>test_ogrsf" / "nmake /f makefile.vc test_ogrsf.exe", in the apps directory of
>GDAL.
>
>>
>> I am testing with huge shapefiles (>500.000 records) and I have detect that
>> the OGR-shapefile provider would be optimized using filemapping (boost
>> <http://www.boost.org/>, or others...)
>>
>> I wonder if there is any support for FileMapping in gdal or planned.
>
>There is none currently. This is something that has been talked about by a few
>people, but never implemented yet. I actually had a local experiment on Linux
>but I couldn't observe any real performance gain by using mmap() rather than
>fread(). Things are maybe different on the Windows side.
>
>> My
>> intention would be to redefine the access to the files in this provider with
>> a new function with "SAHooks" using FileMapping. I provide, as explanation,
>> an unfinished implementation using boost with which greatly speeds up the
>> read of files for critical, massive and repetitive processes such as the
>> painting in a map.
>
>A more general approach that could benefit to other drivers than shapefile
>(potentially most GDAL and OGR drivers actually) would be to implement a
>/vsimemmapped/ virtual file system driver. You have many examples of such
>drivers in the port subdirectory. And like it is done currently with /vsicache/,
>the default virtual file system in cpl_vsil_unix_stdio_64.cpp or
>cpl_vsil_win32.cpp could be instructed to use /vsicache/ if an env. variable is
>toggled.
>
>>
>>
>> On the other hand, this provider may also accelerate with some small changes
>> that are pending of review in the ticket
>> (http://trac.osgeo.org/gdal/ticket/5272) that I hope will be evaluated.
>
>I had skimmed through that one too :
>
>* Did you evaluate the precision loss of using OGRFastAtof() rather than
>CPLAtof() ?
>
>* Are you sure that the performance improvement of replacing memcpy() by *dest =
>*src is significant ? A decent compiler (GCC ;-)) should optimize that on most
>platforms anyway. The thing is that there are still people using odd platforms
>where a non-aligned pointer assingment will cause a SIGBUS, hence the need for
>memcpy(). If the performance gain is significant enough we could perhaps have a
>MEMCPY_DOUBLE macro that on X86 would evaluate to *dest = *ptr and on other
>platforms would default to memcpy().
>
>Best regards,
>
>Even
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131106/7664ee1c/attachment.html>

From Moses.Gone at t-systems.com  Wed Nov  6 11:01:14 2013
From: Moses.Gone at t-systems.com (Moses.Gone at t-systems.com)
Date: Wed, 6 Nov 2013 20:01:14 +0100
Subject: [gdal-dev] gdal_translate produces tif with different colors as
	original
Message-ID: <2D55B4FBCD59D045AC382D3F65435B7903843AD77DF3@HE101453.emea1.cds.t-internal.com>

Hello List,
I am using SDE as my raster data source with the ultimate goal  to tile this dataset: I am running the following  gdal_translate command to generate the initial VRT:

gdal_translate  -projwin 390605 5588320 410128 5568805 -a_srs EPSG:25832 -a_nodata none -of vrt SDE:server,5153,db,user,pw,table,image clippedvrt.vrt

Tiling the resultant VRT produces tiff with weird colors. The colors are either intensified or totally different from the original as you can see from the attached test results

https://drive.google.com/file/d/0Bw-iJv3cImO7bkZYRVZERi1rTTg/edit?usp=sharing

could someone shade some light as to what might be happening.

Thank you

Moses



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131106/7aeb0b37/attachment.html>

From pramsey at boundlessgeo.com  Wed Nov  6 11:35:46 2013
From: pramsey at boundlessgeo.com (Paul Ramsey)
Date: Wed, 6 Nov 2013 11:35:46 -0800
Subject: [gdal-dev] Autotest/Driver Registration Help
In-Reply-To: <0E95993665DC43AAB9E09B2FDB9F73D6@boundlessgeo.com>
References: <AE738344EDF14E44893F0A25075F4DE2@boundlessgeo.com>
	<201311061021.49413.even.rouault@mines-paris.org>
	<0E95993665DC43AAB9E09B2FDB9F73D6@boundlessgeo.com>
Message-ID: <9190A08724CD465FA90BA091548270DF@boundlessgeo.com>

Completely getting nothing... even when I install gdal into /usr/local/lib over top of my standard gdal, the basic driver registration stubbornly returns 'None' 

        gpkg_dr = ogr.GetDriverByName( 'GPKG' )

It makes me think I'm doing something wrong in adding the driver to OGR, but I've gone over it many many times, comparing to cartodb and sqlite and it's doing all the things it should do. It's being detected, it's building, I can run 'nm' on libgdal and see all the class names and even the _RegisterOGRGeoPackage symbol in there. But the test simply will not register the driver. 

-- 
Paul Ramsey | Boundless
http://boundlessgeo.com/support/postgis
2508850632 | @pwramsey
> > 
> > 
> > 
> 
> 
> 




On Wednesday, November 6, 2013 at 10:54 AM, Paul Ramsey wrote:

> Darn, I'm not getting good results for either linking or debugging... set the DYLD_LIBRARY_PATH and PYTHONPATH appropriately, but
> 
> In my own test, I cannot even get to the driver load step, basically this
> 
> gpkg_dr = ogr.GetDriverByName( 'GPKG' )
> 
> only ever returns 'None'
> 
> And going into gdb doesn't work either, even on a test that otherwise works (the sqlite tests will run to completion)
> 
> Tadpole:~/Code/gdal-git/autotest/ogr pramsey(gpkg)$ gdb python
> (gdb) b OGRSQLiteDriver::Open
> (gdb) run ogr_sqlite.py
> Starting program: /usr/bin/python ogr_sqlite.py
> Reading symbols for shared libraries .++..... done
> Program received signal SIGTRAP, Trace/breakpoint trap.
> 0x00007fff5fc01028 in __dyld__dyld_start ()
> (gdb) bt
> #0 0x00007fff5fc01028 in __dyld__dyld_start ()
> 
> 
> 
> 
> On Wednesday, November 6, 2013 at 1:21 AM, Even Rouault wrote:
> 
> > Hi Paul,
> > > 
> > > - To test a new driver, you recommend building autotests as you go, yes?
> > 
> > Yes, that's definitely a good practice. At least they must be written at some 
> > point for regression testing.
> > 
> > You can also work with ogrinfo and ogr2ogr. And I'd also advertize the use of 
> > the test_ogrsf utility, which is a program that checks the consistency of a 
> > OGR driver by testing that the implementation follows the behaviour documented 
> > in the API, and also test-stress it a bit. To build it, you need to :
> > cd apps
> > make test_ogrsf
> > 
> > And then you use it with "test_ogrsf [-ro] your.gpkg"
> > 
> > But for that you need a driver that is feature full and an existing test file.
> > 
> > > - But, I cannot even get my autotest script to load the driver... and the
> > > test is basically a copy of the sqlite test (which does run and work)
> > > https://github.com/pramsey/gdal/blob/gpkg/autotest/ogr/ogr_gpkg.py -
> > 
> > 
> > 
> > 
> > 
> > Looks good.
> > 
> > > I'm
> > > guessing that this is an environment/loading problem? That maybe the
> > > python tests are picking up my system libgdal.dylib not the built one in
> > > the source tree? What environment variable magic do I need to set to force
> > > it to use the right dylib?
> > 
> > 
> > 
> > 
> > 
> > Disclaimer: I have never used any Mac...
> > 
> > Yes, you should probably try setting DYLD_LIBRARY_PATH to point to the path 
> > where libgdal.dylib is in your development tree.
> > 
> > But mixing the default Python bindings from another version with the libgdal 
> > of your development version isn't particularly recommanded (in theory it 
> > should work since Python bindings use the GDAL/OGR C API, which is stable). I 
> > usually build the version of the Python bindings that matches my development 
> > tree and make sure it is used.
> > 
> > cd swig/python
> > python setup.py build
> > export PYTHONPATH=$PWD/build/lib.linux-x86_64-2.6
> > (last part of the path to match your OS + Arch + Python version)
> > 
> > Setting DYLD_LIBRARY_PATH is also probably necessary
> > 
> > > - Secondly, assuming I do get a test running,
> > > how do I attach a debugger to it to track more difficult/deeper issues?
> > > 
> > > gdb python
> > > 
> > > > b OGRGeoPackageDriver::Open
> > > > run ogr_gpkg.py
> > > 
> > > 
> > > 
> > > 
> > > 
> > > - Like so? Or is there other magic to debug things loaded into Python?
> > 
> > Looks good. The above works for me for other drivers.
> > 
> > $ gdb python
> > [...]
> > (gdb) b OGRSQLiteDriver::Open
> > Can't find member of namespace, class, struct, or union named 
> > "OGRSQLiteDriver::Open"
> > Hint: try 'OGRSQLiteDriver::Open<TAB> or 'OGRSQLiteDriver::Open<ESC-?>
> > (Note leading single quote.)
> > Make breakpoint pending on future shared library load? (y or [n]) y
> > Breakpoint 1 (OGRSQLiteDriver::Open) pending.
> > (gdb) run ogr_sqlite.py
> > Starting program: /usr/bin/python ogr_sqlite.py
> > [Thread debugging using libthread_db enabled]
> > TEST: ogr_sqlite_1 ... [New Thread 0x7fffe4425700 (LWP 9243)]
> > [Thread 0x7fffe4425700 (LWP 9243) exited]
> > success
> > TEST: ogr_sqlite_2 ... 
> > Breakpoint 1, OGRSQLiteDriver::Open (this=0xa5b040, pszFilename=0x7ffff7ef3f94 
> > "tmp/sqlite_test.db", bUpdate=1) at ogrsqlitedriver.cpp:68
> > 68 {
> > (gdb) 
> > 
> > 
> > Even
> > 
> > -- 
> > Geospatial professional services
> > http://even.rouault.free.fr/services.html
> 




From even.rouault at mines-paris.org  Wed Nov  6 11:38:38 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 6 Nov 2013 20:38:38 +0100
Subject: [gdal-dev] Autotest/Driver Registration Help
In-Reply-To: <9190A08724CD465FA90BA091548270DF@boundlessgeo.com>
References: <AE738344EDF14E44893F0A25075F4DE2@boundlessgeo.com>
	<0E95993665DC43AAB9E09B2FDB9F73D6@boundlessgeo.com>
	<9190A08724CD465FA90BA091548270DF@boundlessgeo.com>
Message-ID: <201311062038.39153.even.rouault@mines-paris.org>

Le mercredi 06 novembre 2013 20:35:46, Paul Ramsey a ?crit :
> Completely getting nothing... even when I install gdal into /usr/local/lib
> over top of my standard gdal, the basic driver registration stubbornly
> returns 'None'
> 
>         gpkg_dr = ogr.GetDriverByName( 'GPKG' )
> 
> It makes me think I'm doing something wrong in adding the driver to OGR,
> but I've gone over it many many times, comparing to cartodb and sqlite and
> it's doing all the things it should do. It's being detected, it's
> building, I can run 'nm' on libgdal and see all the class names and even
> the _RegisterOGRGeoPackage symbol in there. But the test simply will not
> register the driver.

Does "ogrinfo --formats" report the GPKG driver ?

I'm connected to IRC (but might not be constantly in front of it. Soon dinner 
time here)

> 
> On Wednesday, November 6, 2013 at 10:54 AM, Paul Ramsey wrote:
> > Darn, I'm not getting good results for either linking or debugging... set
> > the DYLD_LIBRARY_PATH and PYTHONPATH appropriately, but
> > 
> > In my own test, I cannot even get to the driver load step, basically this
> > 
> > gpkg_dr = ogr.GetDriverByName( 'GPKG' )
> > 
> > only ever returns 'None'
> > 
> > And going into gdb doesn't work either, even on a test that otherwise
> > works (the sqlite tests will run to completion)
> > 
> > Tadpole:~/Code/gdal-git/autotest/ogr pramsey(gpkg)$ gdb python
> > (gdb) b OGRSQLiteDriver::Open
> > (gdb) run ogr_sqlite.py
> > Starting program: /usr/bin/python ogr_sqlite.py
> > Reading symbols for shared libraries .++..... done
> > Program received signal SIGTRAP, Trace/breakpoint trap.
> > 0x00007fff5fc01028 in __dyld__dyld_start ()
> > (gdb) bt
> > #0 0x00007fff5fc01028 in __dyld__dyld_start ()
> > 
> > On Wednesday, November 6, 2013 at 1:21 AM, Even Rouault wrote:
> > > Hi Paul,
> > > 
> > > > - To test a new driver, you recommend building autotests as you go,
> > > > yes?
> > > 
> > > Yes, that's definitely a good practice. At least they must be written
> > > at some point for regression testing.
> > > 
> > > You can also work with ogrinfo and ogr2ogr. And I'd also advertize the
> > > use of the test_ogrsf utility, which is a program that checks the
> > > consistency of a OGR driver by testing that the implementation follows
> > > the behaviour documented in the API, and also test-stress it a bit. To
> > > build it, you need to : cd apps
> > > make test_ogrsf
> > > 
> > > And then you use it with "test_ogrsf [-ro] your.gpkg"
> > > 
> > > But for that you need a driver that is feature full and an existing
> > > test file.
> > > 
> > > > - But, I cannot even get my autotest script to load the driver... and
> > > > the test is basically a copy of the sqlite test (which does run and
> > > > work)
> > > > https://github.com/pramsey/gdal/blob/gpkg/autotest/ogr/ogr_gpkg.py -
> > > 
> > > Looks good.
> > > 
> > > > I'm
> > > > guessing that this is an environment/loading problem? That maybe the
> > > > python tests are picking up my system libgdal.dylib not the built one
> > > > in the source tree? What environment variable magic do I need to set
> > > > to force it to use the right dylib?
> > > 
> > > Disclaimer: I have never used any Mac...
> > > 
> > > Yes, you should probably try setting DYLD_LIBRARY_PATH to point to the
> > > path where libgdal.dylib is in your development tree.
> > > 
> > > But mixing the default Python bindings from another version with the
> > > libgdal of your development version isn't particularly recommanded (in
> > > theory it should work since Python bindings use the GDAL/OGR C API,
> > > which is stable). I usually build the version of the Python bindings
> > > that matches my development tree and make sure it is used.
> > > 
> > > cd swig/python
> > > python setup.py build
> > > export PYTHONPATH=$PWD/build/lib.linux-x86_64-2.6
> > > (last part of the path to match your OS + Arch + Python version)
> > > 
> > > Setting DYLD_LIBRARY_PATH is also probably necessary
> > > 
> > > > - Secondly, assuming I do get a test running,
> > > > how do I attach a debugger to it to track more difficult/deeper
> > > > issues?
> > > > 
> > > > gdb python
> > > > 
> > > > > b OGRGeoPackageDriver::Open
> > > > > run ogr_gpkg.py
> > > > 
> > > > - Like so? Or is there other magic to debug things loaded into
> > > > Python?
> > > 
> > > Looks good. The above works for me for other drivers.
> > > 
> > > $ gdb python
> > > [...]
> > > (gdb) b OGRSQLiteDriver::Open
> > > Can't find member of namespace, class, struct, or union named
> > > "OGRSQLiteDriver::Open"
> > > Hint: try 'OGRSQLiteDriver::Open<TAB> or 'OGRSQLiteDriver::Open<ESC-?>
> > > (Note leading single quote.)
> > > Make breakpoint pending on future shared library load? (y or [n]) y
> > > Breakpoint 1 (OGRSQLiteDriver::Open) pending.
> > > (gdb) run ogr_sqlite.py
> > > Starting program: /usr/bin/python ogr_sqlite.py
> > > [Thread debugging using libthread_db enabled]
> > > TEST: ogr_sqlite_1 ... [New Thread 0x7fffe4425700 (LWP 9243)]
> > > [Thread 0x7fffe4425700 (LWP 9243) exited]
> > > success
> > > TEST: ogr_sqlite_2 ...
> > > Breakpoint 1, OGRSQLiteDriver::Open (this=0xa5b040,
> > > pszFilename=0x7ffff7ef3f94 "tmp/sqlite_test.db", bUpdate=1) at
> > > ogrsqlitedriver.cpp:68
> > > 68 {
> > > (gdb)
> > > 
> > > 
> > > Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From pramsey at boundlessgeo.com  Wed Nov  6 11:41:47 2013
From: pramsey at boundlessgeo.com (Paul Ramsey)
Date: Wed, 6 Nov 2013 11:41:47 -0800
Subject: [gdal-dev] Autotest/Driver Registration Help
In-Reply-To: <201311062038.39153.even.rouault@mines-paris.org>
References: <AE738344EDF14E44893F0A25075F4DE2@boundlessgeo.com>
	<0E95993665DC43AAB9E09B2FDB9F73D6@boundlessgeo.com>
	<9190A08724CD465FA90BA091548270DF@boundlessgeo.com>
	<201311062038.39153.even.rouault@mines-paris.org>
Message-ID: <4C0B2A500DEB486CA67B46C286825D51@boundlessgeo.com>

It does, though 'otool -L' indicates it's reading libgdal from /usr/local/lib, in defiance of DYLD_LIBRARY_PATH. Fortunately I installed there previously so I guess that's why it's finding the driver. Installing hasn't changed the behaviour of the python test though.

  -> "GPKG" (read/write)

P.

--  
Paul Ramsey | Boundless
http://boundlessgeo.com/support/postgis
2508850632 | @pwramsey
> >  
> >  
> >  
>  
>  
>  




On Wednesday, November 6, 2013 at 11:38 AM, Even Rouault wrote:

> Le mercredi 06 novembre 2013 20:35:46, Paul Ramsey a ?crit :
> > Completely getting nothing... even when I install gdal into /usr/local/lib
> > over top of my standard gdal, the basic driver registration stubbornly
> > returns 'None'
> >  
> > gpkg_dr = ogr.GetDriverByName( 'GPKG' )
> >  
> > It makes me think I'm doing something wrong in adding the driver to OGR,
> > but I've gone over it many many times, comparing to cartodb and sqlite and
> > it's doing all the things it should do. It's being detected, it's
> > building, I can run 'nm' on libgdal and see all the class names and even
> > the _RegisterOGRGeoPackage symbol in there. But the test simply will not
> > register the driver.
>  
>  
>  
> Does "ogrinfo --formats" report the GPKG driver ?
>  
> I'm connected to IRC (but might not be constantly in front of it. Soon dinner  
> time here)
>  
> >  
> > On Wednesday, November 6, 2013 at 10:54 AM, Paul Ramsey wrote:
> > > Darn, I'm not getting good results for either linking or debugging... set
> > > the DYLD_LIBRARY_PATH and PYTHONPATH appropriately, but
> > >  
> > > In my own test, I cannot even get to the driver load step, basically this
> > >  
> > > gpkg_dr = ogr.GetDriverByName( 'GPKG' )
> > >  
> > > only ever returns 'None'
> > >  
> > > And going into gdb doesn't work either, even on a test that otherwise
> > > works (the sqlite tests will run to completion)
> > >  
> > > Tadpole:~/Code/gdal-git/autotest/ogr pramsey(gpkg)$ gdb python
> > > (gdb) b OGRSQLiteDriver::Open
> > > (gdb) run ogr_sqlite.py
> > > Starting program: /usr/bin/python ogr_sqlite.py
> > > Reading symbols for shared libraries .++..... done
> > > Program received signal SIGTRAP, Trace/breakpoint trap.
> > > 0x00007fff5fc01028 in __dyld__dyld_start ()
> > > (gdb) bt
> > > #0 0x00007fff5fc01028 in __dyld__dyld_start ()
> > >  
> > > On Wednesday, November 6, 2013 at 1:21 AM, Even Rouault wrote:
> > > > Hi Paul,
> > > >  
> > > > > - To test a new driver, you recommend building autotests as you go,
> > > > > yes?
> > > >  
> > > >  
> > > >  
> > > > Yes, that's definitely a good practice. At least they must be written
> > > > at some point for regression testing.
> > > >  
> > > > You can also work with ogrinfo and ogr2ogr. And I'd also advertize the
> > > > use of the test_ogrsf utility, which is a program that checks the
> > > > consistency of a OGR driver by testing that the implementation follows
> > > > the behaviour documented in the API, and also test-stress it a bit. To
> > > > build it, you need to : cd apps
> > > > make test_ogrsf
> > > >  
> > > > And then you use it with "test_ogrsf [-ro] your.gpkg"
> > > >  
> > > > But for that you need a driver that is feature full and an existing
> > > > test file.
> > > >  
> > > > > - But, I cannot even get my autotest script to load the driver... and
> > > > > the test is basically a copy of the sqlite test (which does run and
> > > > > work)
> > > > > https://github.com/pramsey/gdal/blob/gpkg/autotest/ogr/ogr_gpkg.py -
> > > >  
> > > >  
> > > >  
> > > > Looks good.
> > > >  
> > > > > I'm
> > > > > guessing that this is an environment/loading problem? That maybe the
> > > > > python tests are picking up my system libgdal.dylib not the built one
> > > > > in the source tree? What environment variable magic do I need to set
> > > > > to force it to use the right dylib?
> > > >  
> > > >  
> > > >  
> > > > Disclaimer: I have never used any Mac...
> > > >  
> > > > Yes, you should probably try setting DYLD_LIBRARY_PATH to point to the
> > > > path where libgdal.dylib is in your development tree.
> > > >  
> > > > But mixing the default Python bindings from another version with the
> > > > libgdal of your development version isn't particularly recommanded (in
> > > > theory it should work since Python bindings use the GDAL/OGR C API,
> > > > which is stable). I usually build the version of the Python bindings
> > > > that matches my development tree and make sure it is used.
> > > >  
> > > > cd swig/python
> > > > python setup.py build
> > > > export PYTHONPATH=$PWD/build/lib.linux-x86_64-2.6
> > > > (last part of the path to match your OS + Arch + Python version)
> > > >  
> > > > Setting DYLD_LIBRARY_PATH is also probably necessary
> > > >  
> > > > > - Secondly, assuming I do get a test running,
> > > > > how do I attach a debugger to it to track more difficult/deeper
> > > > > issues?
> > > > >  
> > > > > gdb python
> > > > >  
> > > > > > b OGRGeoPackageDriver::Open
> > > > > > run ogr_gpkg.py
> > > > >  
> > > > >  
> > > > >  
> > > > > - Like so? Or is there other magic to debug things loaded into
> > > > > Python?
> > > >  
> > > >  
> > > >  
> > > > Looks good. The above works for me for other drivers.
> > > >  
> > > > $ gdb python
> > > > [...]
> > > > (gdb) b OGRSQLiteDriver::Open
> > > > Can't find member of namespace, class, struct, or union named
> > > > "OGRSQLiteDriver::Open"
> > > > Hint: try 'OGRSQLiteDriver::Open<TAB> or 'OGRSQLiteDriver::Open<ESC-?>
> > > > (Note leading single quote.)
> > > > Make breakpoint pending on future shared library load? (y or [n]) y
> > > > Breakpoint 1 (OGRSQLiteDriver::Open) pending.
> > > > (gdb) run ogr_sqlite.py
> > > > Starting program: /usr/bin/python ogr_sqlite.py
> > > > [Thread debugging using libthread_db enabled]
> > > > TEST: ogr_sqlite_1 ... [New Thread 0x7fffe4425700 (LWP 9243)]
> > > > [Thread 0x7fffe4425700 (LWP 9243) exited]
> > > > success
> > > > TEST: ogr_sqlite_2 ...
> > > > Breakpoint 1, OGRSQLiteDriver::Open (this=0xa5b040,
> > > > pszFilename=0x7ffff7ef3f94 "tmp/sqlite_test.db", bUpdate=1) at
> > > > ogrsqlitedriver.cpp:68
> > > > 68 {
> > > > (gdb)
> > > >  
> > > >  
> > > > Even
>  
> --  
> Geospatial professional services
> http://even.rouault.free.fr/services.html




From pramsey at boundlessgeo.com  Wed Nov  6 12:09:54 2013
From: pramsey at boundlessgeo.com (Paul Ramsey)
Date: Wed, 6 Nov 2013 12:09:54 -0800
Subject: [gdal-dev] Autotest/Driver Registration Help
In-Reply-To: <4C0B2A500DEB486CA67B46C286825D51@boundlessgeo.com>
References: <AE738344EDF14E44893F0A25075F4DE2@boundlessgeo.com>
	<0E95993665DC43AAB9E09B2FDB9F73D6@boundlessgeo.com>
	<9190A08724CD465FA90BA091548270DF@boundlessgeo.com>
	<201311062038.39153.even.rouault@mines-paris.org>
	<4C0B2A500DEB486CA67B46C286825D51@boundlessgeo.com>
Message-ID: <CACowWR27F8zNMU_sFaxch4j_Nio9HDJV=dFv8YqGT_LagC_B9g@mail.gmail.com>

Mystery "solved".

When running 'python', the python ogr libraries were being
preferentially loaded from /Library/Frameworks/GDAL, the package
installed with the OSX QGIS build from KyngChaos, regardless of the
value of the PYTHONPATH variable. That framework in turn seems to have
preferentially loaded its own libgdal, regardless of the value of the
DYLD_LIBRARY_PATH.

So, when working with the GDAL python autotest routines: BEWARE any
GDALs that might be in your frameworks directory.

P.


On Wed, Nov 6, 2013 at 11:41 AM, Paul Ramsey <pramsey at boundlessgeo.com> wrote:
> It does, though 'otool -L' indicates it's reading libgdal from /usr/local/lib, in defiance of DYLD_LIBRARY_PATH. Fortunately I installed there previously so I guess that's why it's finding the driver. Installing hasn't changed the behaviour of the python test though.
>
>   -> "GPKG" (read/write)
>
> P.
>
> --
> Paul Ramsey | Boundless
> http://boundlessgeo.com/support/postgis
> 2508850632 | @pwramsey
>> >
>> >
>> >
>>
>>
>>
>
>
>
>
> On Wednesday, November 6, 2013 at 11:38 AM, Even Rouault wrote:
>
>> Le mercredi 06 novembre 2013 20:35:46, Paul Ramsey a ?crit :
>> > Completely getting nothing... even when I install gdal into /usr/local/lib
>> > over top of my standard gdal, the basic driver registration stubbornly
>> > returns 'None'
>> >
>> > gpkg_dr = ogr.GetDriverByName( 'GPKG' )
>> >
>> > It makes me think I'm doing something wrong in adding the driver to OGR,
>> > but I've gone over it many many times, comparing to cartodb and sqlite and
>> > it's doing all the things it should do. It's being detected, it's
>> > building, I can run 'nm' on libgdal and see all the class names and even
>> > the _RegisterOGRGeoPackage symbol in there. But the test simply will not
>> > register the driver.
>>
>>
>>
>> Does "ogrinfo --formats" report the GPKG driver ?
>>
>> I'm connected to IRC (but might not be constantly in front of it. Soon dinner
>> time here)
>>
>> >
>> > On Wednesday, November 6, 2013 at 10:54 AM, Paul Ramsey wrote:
>> > > Darn, I'm not getting good results for either linking or debugging... set
>> > > the DYLD_LIBRARY_PATH and PYTHONPATH appropriately, but
>> > >
>> > > In my own test, I cannot even get to the driver load step, basically this
>> > >
>> > > gpkg_dr = ogr.GetDriverByName( 'GPKG' )
>> > >
>> > > only ever returns 'None'
>> > >
>> > > And going into gdb doesn't work either, even on a test that otherwise
>> > > works (the sqlite tests will run to completion)
>> > >
>> > > Tadpole:~/Code/gdal-git/autotest/ogr pramsey(gpkg)$ gdb python
>> > > (gdb) b OGRSQLiteDriver::Open
>> > > (gdb) run ogr_sqlite.py
>> > > Starting program: /usr/bin/python ogr_sqlite.py
>> > > Reading symbols for shared libraries .++..... done
>> > > Program received signal SIGTRAP, Trace/breakpoint trap.
>> > > 0x00007fff5fc01028 in __dyld__dyld_start ()
>> > > (gdb) bt
>> > > #0 0x00007fff5fc01028 in __dyld__dyld_start ()
>> > >
>> > > On Wednesday, November 6, 2013 at 1:21 AM, Even Rouault wrote:
>> > > > Hi Paul,
>> > > >
>> > > > > - To test a new driver, you recommend building autotests as you go,
>> > > > > yes?
>> > > >
>> > > >
>> > > >
>> > > > Yes, that's definitely a good practice. At least they must be written
>> > > > at some point for regression testing.
>> > > >
>> > > > You can also work with ogrinfo and ogr2ogr. And I'd also advertize the
>> > > > use of the test_ogrsf utility, which is a program that checks the
>> > > > consistency of a OGR driver by testing that the implementation follows
>> > > > the behaviour documented in the API, and also test-stress it a bit. To
>> > > > build it, you need to : cd apps
>> > > > make test_ogrsf
>> > > >
>> > > > And then you use it with "test_ogrsf [-ro] your.gpkg"
>> > > >
>> > > > But for that you need a driver that is feature full and an existing
>> > > > test file.
>> > > >
>> > > > > - But, I cannot even get my autotest script to load the driver... and
>> > > > > the test is basically a copy of the sqlite test (which does run and
>> > > > > work)
>> > > > > https://github.com/pramsey/gdal/blob/gpkg/autotest/ogr/ogr_gpkg.py -
>> > > >
>> > > >
>> > > >
>> > > > Looks good.
>> > > >
>> > > > > I'm
>> > > > > guessing that this is an environment/loading problem? That maybe the
>> > > > > python tests are picking up my system libgdal.dylib not the built one
>> > > > > in the source tree? What environment variable magic do I need to set
>> > > > > to force it to use the right dylib?
>> > > >
>> > > >
>> > > >
>> > > > Disclaimer: I have never used any Mac...
>> > > >
>> > > > Yes, you should probably try setting DYLD_LIBRARY_PATH to point to the
>> > > > path where libgdal.dylib is in your development tree.
>> > > >
>> > > > But mixing the default Python bindings from another version with the
>> > > > libgdal of your development version isn't particularly recommanded (in
>> > > > theory it should work since Python bindings use the GDAL/OGR C API,
>> > > > which is stable). I usually build the version of the Python bindings
>> > > > that matches my development tree and make sure it is used.
>> > > >
>> > > > cd swig/python
>> > > > python setup.py build
>> > > > export PYTHONPATH=$PWD/build/lib.linux-x86_64-2.6
>> > > > (last part of the path to match your OS + Arch + Python version)
>> > > >
>> > > > Setting DYLD_LIBRARY_PATH is also probably necessary
>> > > >
>> > > > > - Secondly, assuming I do get a test running,
>> > > > > how do I attach a debugger to it to track more difficult/deeper
>> > > > > issues?
>> > > > >
>> > > > > gdb python
>> > > > >
>> > > > > > b OGRGeoPackageDriver::Open
>> > > > > > run ogr_gpkg.py
>> > > > >
>> > > > >
>> > > > >
>> > > > > - Like so? Or is there other magic to debug things loaded into
>> > > > > Python?
>> > > >
>> > > >
>> > > >
>> > > > Looks good. The above works for me for other drivers.
>> > > >
>> > > > $ gdb python
>> > > > [...]
>> > > > (gdb) b OGRSQLiteDriver::Open
>> > > > Can't find member of namespace, class, struct, or union named
>> > > > "OGRSQLiteDriver::Open"
>> > > > Hint: try 'OGRSQLiteDriver::Open<TAB> or 'OGRSQLiteDriver::Open<ESC-?>
>> > > > (Note leading single quote.)
>> > > > Make breakpoint pending on future shared library load? (y or [n]) y
>> > > > Breakpoint 1 (OGRSQLiteDriver::Open) pending.
>> > > > (gdb) run ogr_sqlite.py
>> > > > Starting program: /usr/bin/python ogr_sqlite.py
>> > > > [Thread debugging using libthread_db enabled]
>> > > > TEST: ogr_sqlite_1 ... [New Thread 0x7fffe4425700 (LWP 9243)]
>> > > > [Thread 0x7fffe4425700 (LWP 9243) exited]
>> > > > success
>> > > > TEST: ogr_sqlite_2 ...
>> > > > Breakpoint 1, OGRSQLiteDriver::Open (this=0xa5b040,
>> > > > pszFilename=0x7ffff7ef3f94 "tmp/sqlite_test.db", bUpdate=1) at
>> > > > ogrsqlitedriver.cpp:68
>> > > > 68 {
>> > > > (gdb)
>> > > >
>> > > >
>> > > > Even
>>
>> --
>> Geospatial professional services
>> http://even.rouault.free.fr/services.html
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From jukka.rahkonen at mmmtike.fi  Wed Nov  6 12:32:42 2013
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Wed, 6 Nov 2013 20:32:42 +0000 (UTC)
Subject: [gdal-dev]
	=?utf-8?q?gdal=5Ftranslate_produces_tif_with_different?=
	=?utf-8?q?_colors_as_original?=
References: <2D55B4FBCD59D045AC382D3F65435B7903843AD77DF3@HE101453.emea1.cds.t-internal.com>
Message-ID: <loom.20131106T211413-94@post.gmane.org>

 <Moses.Gone <at> t-systems.com> writes:

> 
> 
> 
> Hello List,
> I am using SDE as my raster data source with the ultimate goal? to tile
this dataset: I am running the following? gdal_translate command to generate
the initial VRT:? 
> ?
> gdal_translate? -projwin 390605 5588320 410128 5568805 -a_srs EPSG:25832
-a_nodata none -of vrt SDE:server,5153,db,user,pw,table,image clippedvrt.vrt
> ?
> Tiling the resultant VRT produces tiff with weird colors. The colors are
either intensified or totally different from the original as you can see
from the attached test results
> ?
> 
> https://drive.google.com/file/d/0Bw-iJv3cImO7bkZYRVZERi1rTTg/edit?usp=sharing 
> ?
> could someone shade some light as to what might be happening.

Hi,

I have seen something similar when I have created a VRT file from one
paletted image but the following images have used different palettes which
were optimized for each image. Now the palette of the  first image was
written into the VRT file and when it was applied to the other images the
result looked pretty funny. In my case I used the gdalbuildvrt tool which
gave me a helpful warning and a useful hint:
" The end result might produce weird colors. 
You're advised to preprocess your rasters with other
tools, such as pct2rgb.py or gdal_translate -expand RGB to operate
gdalbuildvrt on RGB rasters instead."

Perhaps you have somehow similar situation.

-Jukka Rahkonen-





From normvcr at telus.net  Wed Nov  6 13:23:10 2013
From: normvcr at telus.net (Norman Goldstein)
Date: Wed, 06 Nov 2013 13:23:10 -0800
Subject: [gdal-dev] geotiff projection not showing up
Message-ID: <527AB33E.3050306@telus.net>

I have created a geotiff file using the "GTiff" driver, and have 
successfully set options for it to be a strips file with no 
compression.  Also, successfully called the functions

dataset->SetMetadataItem( "AREA_OR_POINT",
                                             "Point",
                                              nullptr ) )

and

dataset->SetGCPs( 3,
                                gcps,
                                "Richmond" )

Here is the listgeo dump:

############# listgeo dump ##############
Geotiff_Information:
    Version: 1
    Key_Revision: 1.0
    Tagged_Information:
       ModelTiepointTag (6,3):
          0                249              0
          0                0                0
          399              249              0
          1000             0                0
          0                0                0
          0                2000             0
       End_Of_Tags.
    Keyed_Information:
       GTRasterTypeGeoKey (Short,1): RasterPixelIsPoint
       End_Of_Keys.
    End_Of_Geotiff.


Corner Coordinates:
  ... unable to transform points between pixel/line and PCS space
#####################################

I also set the reference system using the following code:

/////////////////////// c++ code ////////////////////////////
   OGRSpatialReference oSRS;
   oSRS.SetProjCS( "NoWhere" );
   oSRS.SetWellKnownGeogCS( "WGS84" );
   oSRS.SetEquirectangular( 0.0,        // Centre lat
                0.0,        // Centre lon
                0.0,   // False Easting
                0.0 ); // False Northing

   char* wkt = nullptr;

   if( OGRERR_NONE != oSRS.exportToPrettyWkt( &wkt ) )
   {
      error...
   }

   if( CE_Failure == dataset->SetProjection( wkt ) )
   {
    error...
   }
///////////////////////////////////////////////////////////////

So, why is listgeo not able to transform points between pixel/line and 
PCS space?

I am happy to upload a full working example if needed.

Thank you.











-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4243 bytes
Desc: S/MIME Cryptographic Signature
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131106/1c5d7399/attachment.bin>

From warmerdam at pobox.com  Wed Nov  6 13:51:17 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed, 6 Nov 2013 13:51:17 -0800
Subject: [gdal-dev] geotiff projection not showing up
In-Reply-To: <527AB33E.3050306@telus.net>
References: <527AB33E.3050306@telus.net>
Message-ID: <CA+YzLBdy+UVXK=fjZt6TNtYLtA2izcL2-hP20gecqv77De9jZA@mail.gmail.com>

Norman,

I believe you want to call SetGCPProjection() instead of SetProjection()
when using GCPs instead of an affine transform.

Best regards,
Frank



On Wed, Nov 6, 2013 at 1:23 PM, Norman Goldstein <normvcr at telus.net> wrote:

> I have created a geotiff file using the "GTiff" driver, and have
> successfully set options for it to be a strips file with no compression.
>  Also, successfully called the functions
>
> dataset->SetMetadataItem( "AREA_OR_POINT",
>                                             "Point",
>                                              nullptr ) )
>
> and
>
> dataset->SetGCPs( 3,
>                                gcps,
>                                "Richmond" )
>
> Here is the listgeo dump:
>
> ############# listgeo dump ##############
> Geotiff_Information:
>    Version: 1
>    Key_Revision: 1.0
>    Tagged_Information:
>       ModelTiepointTag (6,3):
>          0                249              0
>          0                0                0
>          399              249              0
>          1000             0                0
>          0                0                0
>          0                2000             0
>       End_Of_Tags.
>    Keyed_Information:
>       GTRasterTypeGeoKey (Short,1): RasterPixelIsPoint
>       End_Of_Keys.
>    End_Of_Geotiff.
>
>
> Corner Coordinates:
>  ... unable to transform points between pixel/line and PCS space
> #####################################
>
> I also set the reference system using the following code:
>
> /////////////////////// c++ code ////////////////////////////
>   OGRSpatialReference oSRS;
>   oSRS.SetProjCS( "NoWhere" );
>   oSRS.SetWellKnownGeogCS( "WGS84" );
>   oSRS.SetEquirectangular( 0.0,        // Centre lat
>                0.0,        // Centre lon
>                0.0,   // False Easting
>                0.0 ); // False Northing
>
>   char* wkt = nullptr;
>
>   if( OGRERR_NONE != oSRS.exportToPrettyWkt( &wkt ) )
>   {
>      error...
>   }
>
>   if( CE_Failure == dataset->SetProjection( wkt ) )
>   {
>    error...
>   }
> ///////////////////////////////////////////////////////////////
>
> So, why is listgeo not able to transform points between pixel/line and PCS
> space?
>
> I am happy to upload a full working example if needed.
>
> Thank you.
>
>
>
>
>
>
>
>
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131106/95d925b4/attachment-0001.html>

From normvcr at telus.net  Wed Nov  6 16:00:12 2013
From: normvcr at telus.net (Norman Goldstein)
Date: Wed, 06 Nov 2013 16:00:12 -0800
Subject: [gdal-dev] geotiff projection not showing up
In-Reply-To: <CA+YzLBdy+UVXK=fjZt6TNtYLtA2izcL2-hP20gecqv77De9jZA@mail.gmail.com>
References: <527AB33E.3050306@telus.net>
	<CA+YzLBdy+UVXK=fjZt6TNtYLtA2izcL2-hP20gecqv77De9jZA@mail.gmail.com>
Message-ID: <527AD80C.8050507@telus.net>

Frank,

I am using GDAL
Version     : 1.9.2

so maybe that is why I do not see the method SetGCPProjection().

I think you have convinced me, though, to calculate the 6 coefficients 
directly,
and then call SetGeoTransform().  Will let you guys know how this works out
for me.

Thank you,
Norm


On 11/06/2013 01:51 PM, Frank Warmerdam wrote:
> Norman,
>
> I believe you want to call SetGCPProjection() instead of 
> SetProjection() when using GCPs instead of an affine transform.
>
> Best regards,
> Frank
>
>
>
> On Wed, Nov 6, 2013 at 1:23 PM, Norman Goldstein <normvcr at telus.net 
> <mailto:normvcr at telus.net>> wrote:
>
>     I have created a geotiff file using the "GTiff" driver, and have
>     successfully set options for it to be a strips file with no
>     compression.  Also, successfully called the functions
>
>     dataset->SetMetadataItem( "AREA_OR_POINT",
>                                                 "Point",
>                                                  nullptr ) )
>
>     and
>
>     dataset->SetGCPs( 3,
>                                    gcps,
>                                    "Richmond" )
>
>     Here is the listgeo dump:
>
>     ############# listgeo dump ##############
>     Geotiff_Information:
>        Version: 1
>        Key_Revision: 1.0
>        Tagged_Information:
>           ModelTiepointTag (6,3):
>              0                249              0
>              0                0                0
>              399              249              0
>              1000             0                0
>              0                0                0
>              0                2000             0
>           End_Of_Tags.
>        Keyed_Information:
>           GTRasterTypeGeoKey (Short,1): RasterPixelIsPoint
>           End_Of_Keys.
>        End_Of_Geotiff.
>
>
>     Corner Coordinates:
>      ... unable to transform points between pixel/line and PCS space
>     #####################################
>
>     I also set the reference system using the following code:
>
>     /////////////////////// c++ code ////////////////////////////
>       OGRSpatialReference oSRS;
>       oSRS.SetProjCS( "NoWhere" );
>       oSRS.SetWellKnownGeogCS( "WGS84" );
>       oSRS.SetEquirectangular( 0.0,        // Centre lat
>                    0.0,        // Centre lon
>                    0.0,   // False Easting
>                    0.0 ); // False Northing
>
>       char* wkt = nullptr;
>
>       if( OGRERR_NONE != oSRS.exportToPrettyWkt( &wkt ) )
>       {
>          error...
>       }
>
>       if( CE_Failure == dataset->SetProjection( wkt ) )
>       {
>        error...
>       }
>     ///////////////////////////////////////////////////////////////
>
>     So, why is listgeo not able to transform points between pixel/line
>     and PCS space?
>
>     I am happy to upload a full working example if needed.
>
>     Thank you.
>
>
>
>
>
>
>
>
>
>
>
>
>     _______________________________________________
>     gdal-dev mailing list
>     gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>     http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
> -- 
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, 
> warmerdam at pobox.com <mailto:warmerdam at pobox.com>
> light and sound - activate the windows | http://pobox.com/~warmerdam 
> <http://pobox.com/%7Ewarmerdam>
> and watch the world go round - Rush    | Geospatial Software Developer

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131106/48fd08a5/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4243 bytes
Desc: S/MIME Cryptographic Signature
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131106/48fd08a5/attachment.bin>

From salim at pixoneer.co.kr  Thu Nov  7 01:03:14 2013
From: salim at pixoneer.co.kr (=?ks_c_5601-1987?B?U2V1bmcgQWUgTGlt?=)
Date: Thu, 07 Nov 2013 18:03:14 +0900
Subject: [gdal-dev] =?ks_c_5601-1987?q?NewDataset_and_SetBand_error?=
Message-ID: <1383814994.26514.261.salim@pixoneer.co.kr>

Dear,

I make a console application with VS2010 linking "gdal_i.lib".
The steps are :
1. Create New Dataset and Band in main.cpp
class XXDataset : public GDALPamDataset
{
public:
	XXDataset() {};
	~XXDataset() {};

	static GDALDataset* Open(GDALOpenInfo*);
};

class XXRasterBand : public GDALPamRasterBand
{
public:
	XXRasterBand( GDALDataset*, int, GDALDataType );
	~XXRasterBand() {};
};



GDALDataset* XXDataset::Open(GDALOpenInfo* pOpenInfo)
{
	XXDataset* poDS = new XXDataset();
	poDS- >nRasterXSize = 100;
	poDS- >nRasterYSize = 200;
	poDS- >eAccess = GA_Update;
	poDS- >nBands = 3;

	int iBand = 0;
	for(iBand = 1; iBand < = 3; iBand++ )
	{
		XXRasterBand* band = new XXRasterBand( poDS, iBand, GDT_Byte);
		poDS- >SetBand( iBand, band );
	}

	return poDS;
}

XXRasterBand::XXRasterBand( GDALDataset *poDS, int nBand, GDALDataType eType)
{
	this- >poDS = poDS;
	this- >nBand = nBand;
	this- >eDataType = eType;
	nRasterXSize = 100;
	nRasterYSize = 200;
	nBlockXSize = nRasterXSize;
	nBlockYSize = nRasterYSize;
}

2. Add the code in main function
void main()
{


    GDALDataset* pDSTemp = XXDataset::Open(NULL);
	if (pDSTemp) GDALClose(pDSTemp);
}



I compile and try to debug this app.
But in "poDS->SetBand" line of "XXDataset::Open", the app is broken when the first band is ready to set.
In XXDataset::Open, all value of parameters is right.
But When stepping into the "SetBand" function, the values may be corrupted.
"papobands" of GDALDataset is not null and it make an error.

Please let me know the reason or some tips.

Thanks.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131107/84733a3e/attachment-0001.html>

From warmerdam at pobox.com  Thu Nov  7 07:32:23 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu, 7 Nov 2013 07:32:23 -0800
Subject: [gdal-dev] geotiff projection not showing up
In-Reply-To: <527AD80C.8050507@telus.net>
References: <527AB33E.3050306@telus.net>
	<CA+YzLBdy+UVXK=fjZt6TNtYLtA2izcL2-hP20gecqv77De9jZA@mail.gmail.com>
	<527AD80C.8050507@telus.net>
Message-ID: <CA+YzLBeuiJc1d3sZH5bTf9MbxQoyixh2OB--EZhGMN2KmRPy0A@mail.gmail.com>

Norman,

My apologies.  The GCP projection is actually supposed to be passed as the
third value in the SetGCPs call - where you have passed the string
"Richmond".  Instead pass the whole WKT strings for the coordinate system.

Best regards,
Frank


On Wed, Nov 6, 2013 at 4:00 PM, Norman Goldstein <normvcr at telus.net> wrote:

>  Frank,
>
> I am using GDAL
> Version     : 1.9.2
>
> so maybe that is why I do not see the method SetGCPProjection().
>
> I think you have convinced me, though, to calculate the 6 coefficients
> directly,
> and then call SetGeoTransform().  Will let you guys know how this works out
> for me.
>
> Thank you,
> Norm
>
>
>
> On 11/06/2013 01:51 PM, Frank Warmerdam wrote:
>
> Norman,
>
>  I believe you want to call SetGCPProjection() instead of SetProjection()
> when using GCPs instead of an affine transform.
>
>  Best regards,
> Frank
>
>
>
> On Wed, Nov 6, 2013 at 1:23 PM, Norman Goldstein <normvcr at telus.net>wrote:
>
>> I have created a geotiff file using the "GTiff" driver, and have
>> successfully set options for it to be a strips file with no compression.
>>  Also, successfully called the functions
>>
>> dataset->SetMetadataItem( "AREA_OR_POINT",
>>                                             "Point",
>>                                              nullptr ) )
>>
>> and
>>
>> dataset->SetGCPs( 3,
>>                                gcps,
>>                                "Richmond" )
>>
>> Here is the listgeo dump:
>>
>> ############# listgeo dump ##############
>> Geotiff_Information:
>>    Version: 1
>>    Key_Revision: 1.0
>>    Tagged_Information:
>>       ModelTiepointTag (6,3):
>>          0                249              0
>>          0                0                0
>>          399              249              0
>>          1000             0                0
>>          0                0                0
>>          0                2000             0
>>       End_Of_Tags.
>>    Keyed_Information:
>>       GTRasterTypeGeoKey (Short,1): RasterPixelIsPoint
>>       End_Of_Keys.
>>    End_Of_Geotiff.
>>
>>
>> Corner Coordinates:
>>  ... unable to transform points between pixel/line and PCS space
>> #####################################
>>
>> I also set the reference system using the following code:
>>
>> /////////////////////// c++ code ////////////////////////////
>>   OGRSpatialReference oSRS;
>>   oSRS.SetProjCS( "NoWhere" );
>>   oSRS.SetWellKnownGeogCS( "WGS84" );
>>   oSRS.SetEquirectangular( 0.0,        // Centre lat
>>                0.0,        // Centre lon
>>                0.0,   // False Easting
>>                0.0 ); // False Northing
>>
>>   char* wkt = nullptr;
>>
>>   if( OGRERR_NONE != oSRS.exportToPrettyWkt( &wkt ) )
>>   {
>>      error...
>>   }
>>
>>   if( CE_Failure == dataset->SetProjection( wkt ) )
>>   {
>>    error...
>>   }
>> ///////////////////////////////////////////////////////////////
>>
>> So, why is listgeo not able to transform points between pixel/line and
>> PCS space?
>>
>> I am happy to upload a full working example if needed.
>>
>> Thank you.
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>
>  --
>
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam at pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Software Developer
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131107/1136102e/attachment.html>

From Christopher.Pouliot at state.mn.us  Thu Nov  7 07:51:35 2013
From: Christopher.Pouliot at state.mn.us (Pouliot, Christopher (MNIT))
Date: Thu, 7 Nov 2013 15:51:35 +0000
Subject: [gdal-dev] Writing GPX Files with multiple Extensions
Message-ID: <074A014435F2E543B1FD97E729C76E4D0ADE8BA3@055-CH1MPN1-011.055d.mgd.msft.net>

Hello All,

I am currently using GDAL 1.9 and I'm writing out GPX files for uploading onto Garmin units.  Garmin has many different GPX extensions (gpxx, gpxtpx, gpxtrx, etc) for defining extra attributes for their GPS data.  I am wondering how I would specify these multiple extensions in my code?  Currently, I am defining a single extension as shown below:

ds = drv.CreateDataSource(outputFilePath, new string[] { "GPX_USE_EXTENSIONS=YES","GPX_EXTENSIONS_NS=gpxx","GPX_EXTENSIONS_NS_URL=http://www.garmin.com/xmlschemas/GpxExtensions/v3"});}

How would I go about setting more namespaces (gpxtpx, gpxtrx, ...)?  And then how would I specify that an attribute belongs in a particular extension?

Thanks,

Chris

Chris Pouliot  |  GIS Application Developer
MN.IT Services @ Department of Natural Resources
(651) 259-5491 (w)  |  christopher.pouliot at state.mn.us
[cid:image002.jpg at 01CEDB9E.F20C9670]<http://www.mn.gov/oet>  Information Technology for Minnesota Government   |   mn.gov/oet<http://www.mn.gov/oet>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131107/dc7c33ca/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image002.jpg
Type: image/jpeg
Size: 1611 bytes
Desc: image002.jpg
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131107/dc7c33ca/attachment.jpg>

From andre+joost at nurfuerspam.de  Thu Nov  7 07:54:32 2013
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Thu, 07 Nov 2013 16:54:32 +0100
Subject: [gdal-dev] gdal_translate produces tif with different colors as
	original
In-Reply-To: <loom.20131106T211413-94@post.gmane.org>
References: <2D55B4FBCD59D045AC382D3F65435B7903843AD77DF3@HE101453.emea1.cds.t-internal.com>
	<loom.20131106T211413-94@post.gmane.org>
Message-ID: <l5gehg$2se$2@ger.gmane.org>

Am 06.11.2013 21:32, schrieb Jukka Rahkonen:

> You're advised to preprocess your rasters with other
> tools, such as pct2rgb.py or gdal_translate -expand RGB to operate
> gdalbuildvrt on RGB rasters instead."
>

I proposed that, but have a look at the color palette of the VRT:

<http://gis.stackexchange.com/questions/76662/gdal-translate-produces-tif-with-different-colors-as-original>

Is it a fault of the source or the driver?

Greetings,
Andr? Joost


From andre+joost at nurfuerspam.de  Thu Nov  7 08:08:53 2013
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Thu, 07 Nov 2013 17:08:53 +0100
Subject: [gdal-dev] Difference: EPSG 3004 - EPSG 102092
In-Reply-To: <CFCE4B3585662C4BB27611ED767C0E861D22C5@EXMBX22.ad.utwente.nl>
References: <527B9F35.1010104@tiscali.it>
	<CFCE4B3585662C4BB27611ED767C0E861D22C5@EXMBX22.ad.utwente.nl>
Message-ID: <l5gehf$2se$1@ger.gmane.org>

Am 07.11.2013 16:39, schrieb 
b.j.kobben at utwente.nl:
> As an added note: be aware that 102092 is NOT an actual EPSG code. EPSG
> codes with no's>  32768 are not in the official EPSG database, and are in
> actual fact therefore not EPSG codes really.
>

It is actually a definition by ESRI:
<http://spatialreference.org/ref/esri/102092/>

and we all know that they keep datum shifts always seperately from 
projection definitions.

I don't understand why QGIS 2.0 (and GDAL 1.10.0) simply calls them EPSG.
QGIS 1.8.0 Lisboa did not know those codes, and they named French 
definitions IGNF:...

I would like to see those ESRI definitions marked ESRI:... to flag the 
difference.

** added mailing lists for proj.4 and gdal as it comes probably from there

Greetings,
Andr? Joost


From warmerdam at pobox.com  Thu Nov  7 08:31:40 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu, 7 Nov 2013 08:31:40 -0800
Subject: [gdal-dev] NewDataset and SetBand error
In-Reply-To: <1383814994.26514.261.salim@pixoneer.co.kr>
References: <1383814994.26514.261.salim@pixoneer.co.kr>
Message-ID: <CA+YzLBcJq7K-5HzitT9Zo74xPT1WMFYSN2UKXumoTH8Bzpi8SA@mail.gmail.com>

Seung,

If the fields, like papoBands in the dataset seem ok before stepping into
SetBand(), and corrupt once you are inside I would suspect that GDAL and
your application have been built with different gdal_priv.h include files
*or* with different structure alighnments flags for Visual Studio.  Did you
build GDAL from source using the same configuration you are building your
application with?

Best regards,
Frank



On Thu, Nov 7, 2013 at 1:03 AM, Seung Ae Lim <salim at pixoneer.co.kr> wrote:

>   Dear,
>
>
>
>  I make a console application with VS2010 linking "gdal_i.lib".
>
>  The steps are :
>
> * 1. Create New Dataset and Band in main.cpp*
> class XXDataset : public GDALPamDataset
> {
> public:
>  XXDataset() {};
>  ~XXDataset() {};
>
>  static GDALDataset* Open(GDALOpenInfo*);
> };
>
> class XXRasterBand : public GDALPamRasterBand
> {
> public:
>  XXRasterBand( GDALDataset*, int, GDALDataType );
>  ~XXRasterBand() {};
> };
>
>
> GDALDataset* XXDataset::Open(GDALOpenInfo* pOpenInfo)
> {
>  XXDataset* poDS = new XXDataset();
>  poDS- >nRasterXSize = 100;
>  poDS- >nRasterYSize = 200;
>  poDS- >eAccess = GA_Update;
>  poDS- >nBands = 3;
>
>  int iBand = 0;
>  for(iBand = 1; iBand < = 3; iBand++ )
>  {
>  XXRasterBand* band = new XXRasterBand( poDS, iBand, GDT_Byte);
>  poDS- >SetBand( iBand, band );
>  }
>
>  return poDS;
> }
>
> XXRasterBand::XXRasterBand( GDALDataset *poDS, int nBand, GDALDataType
> eType)
> {
>  this- >poDS = poDS;
>  this- >nBand = nBand;
>  this- >eDataType = eType;
>  nRasterXSize = 100;
>  nRasterYSize = 200;
>  nBlockXSize = nRasterXSize;
>  nBlockYSize = nRasterYSize;
> }
>
> *2. Add the code in main function*
> void main()
> {
>
>
>         GDALDataset* pDSTemp = XXDataset::Open(NULL);
>  if (pDSTemp) GDALClose(pDSTemp);
> }
>
>
> I compile and try to debug this app.
> But in "poDS->SetBand" line of "XXDataset::Open", the app is broken when
> the first band is ready to set.
> In XXDataset::Open, all value of parameters is right.
> But When stepping into the "SetBand" function, the values may be corrupted.
> "papobands" of GDALDataset is not null and it make an error.
>
> Please let me know the reason or some tips.
>
> Thanks.
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131107/98e9bb19/attachment.html>

From varlo at ukr.net  Thu Nov  7 09:12:17 2013
From: varlo at ukr.net (Victor R)
Date: Thu, 07 Nov 2013 19:12:17 +0200
Subject: [gdal-dev] Could you approve my post
Message-ID: <1383844337.837983644.gnuykgl6@frv45.ukr.net>

Could you approve my post? 

http://osgeo-org.1560.x6.nabble.com/gdal-dev-C-ogr-wrap-dll-exception-with-ogr-OGRERR-NONE-td5044742.html#a5088006 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131107/e7b0f659/attachment.html>

From mateusz at loskot.net  Thu Nov  7 09:36:50 2013
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu, 7 Nov 2013 17:36:50 +0000
Subject: [gdal-dev] Could you approve my post
In-Reply-To: <1383844337.837983644.gnuykgl6@frv45.ukr.net>
References: <1383844337.837983644.gnuykgl6@frv45.ukr.net>
Message-ID: <CABUeae8+iQFkS4fygbGPQn8hw2RDut4cpMJudoP=xLyqWMkp8w@mail.gmail.com>

On 7 November 2013 17:12, Victor R <varlo at ukr.net> wrote:

>  Could you approve my post?
>
>
> http://osgeo-org.1560.x6.nabble.com/gdal-dev-C-ogr-wrap-dll-exception-with-ogr-OGRERR-NONE-td5044742.html#a5088006
>


Please, read this section
http://wiki.osgeo.org/wiki/Mailing_Lists#Nabble
and verify your Nabble account uses exactly the same e-mail address
as your gdal-dev subscribtion.
You may want to ask Nabble folks for help if you need further clarifications
on how to use Nabble with mailing lists.

Best regards,
-- 
Mateusz  Loskot, http://mateusz.loskot.net
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131107/83fa949b/attachment.html>

From varlo at ukr.net  Thu Nov  7 10:44:51 2013
From: varlo at ukr.net (varlo at ukr.net)
Date: Thu, 07 Nov 2013 10:44:51 -0800
Subject: [gdal-dev] Unable to load DLL 'ogr_wrap' issue
Message-ID: <32974353.61151.1383849876104.JavaMail.nabble@alf.nabble.com>

Hello,

Have you solved Unable to load DLL 'ogr_wrap' issue? I have the same problem now.

Best regards, Victor

_____________________________________
Sent from http://osgeo-org.1560.x6.nabble.com


From even.rouault at mines-paris.org  Thu Nov  7 11:22:21 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 7 Nov 2013 20:22:21 +0100
Subject: [gdal-dev] Writing GPX Files with multiple Extensions
In-Reply-To: <074A014435F2E543B1FD97E729C76E4D0ADE8BA3@055-CH1MPN1-011.055d.mgd.msft.net>
References: <074A014435F2E543B1FD97E729C76E4D0ADE8BA3@055-CH1MPN1-011.055d.mgd.msft.net>
Message-ID: <201311072022.21469.even.rouault@mines-paris.org>

Le jeudi 07 novembre 2013 16:51:35, Pouliot, Christopher (MNIT) a ?crit :
> Hello All,
> 
> I am currently using GDAL 1.9 and I'm writing out GPX files for uploading
> onto Garmin units.  Garmin has many different GPX extensions (gpxx,
> gpxtpx, gpxtrx, etc) for defining extra attributes for their GPS data.  I
> am wondering how I would specify these multiple extensions in my code? 
> Currently, I am defining a single extension as shown below:
> 
> ds = drv.CreateDataSource(outputFilePath, new string[] {
> "GPX_USE_EXTENSIONS=YES","GPX_EXTENSIONS_NS=gpxx","GPX_EXTENSIONS_NS_URL=h
> ttp://www.garmin.com/xmlschemas/GpxExtensions/v3"});}
> 
> How would I go about setting more namespaces (gpxtpx, gpxtrx, ...)?

This is not possible currently. Would require an enhancement in the driver, 
like acception a comma separated list of values for GPX_EXTENSIONS_NS and 
GPX_EXTENSIONS_NS_URL

> And
> then how would I specify that an attribute belongs in a particular
> extension?

It could detect it by the name of attribute. For example, gpxx_foo, 
gpxtpx_bar, gpxtrx_baz

> 
> Thanks,
> 
> Chris
> 
> Chris Pouliot  |  GIS Application Developer
> MN.IT Services @ Department of Natural Resources
> (651) 259-5491 (w)  |  christopher.pouliot at state.mn.us
> [cid:image002.jpg at 01CEDB9E.F20C9670]<http://www.mn.gov/oet>  Information
> Technology for Minnesota Government   |  
> mn.gov/oet<http://www.mn.gov/oet>

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From Christopher.Pouliot at state.mn.us  Thu Nov  7 11:41:48 2013
From: Christopher.Pouliot at state.mn.us (Pouliot, Christopher (MNIT))
Date: Thu, 7 Nov 2013 19:41:48 +0000
Subject: [gdal-dev] Writing GPX Files with multiple Extensions
In-Reply-To: <201311072022.21469.even.rouault@mines-paris.org>
References: <074A014435F2E543B1FD97E729C76E4D0ADE8BA3@055-CH1MPN1-011.055d.mgd.msft.net>
	<201311072022.21469.even.rouault@mines-paris.org>
Message-ID: <074A014435F2E543B1FD97E729C76E4D0ADE8DF4@055-CH1MPN1-011.055d.mgd.msft.net>

Even,

Thanks for the response!  I see that GPSBabel uses GDAL and writes out multiple extensions.  I'll check with them to see how they are doing it.

Chris

-----Original Message-----
From: Even Rouault [mailto:even.rouault at mines-paris.org] 
Sent: Thursday, November 07, 2013 1:22 PM
To: gdal-dev at lists.osgeo.org
Cc: Pouliot, Christopher (MNIT)
Subject: Re: [gdal-dev] Writing GPX Files with multiple Extensions

Le jeudi 07 novembre 2013 16:51:35, Pouliot, Christopher (MNIT) a ?crit :
> Hello All,
> 
> I am currently using GDAL 1.9 and I'm writing out GPX files for 
> uploading onto Garmin units.  Garmin has many different GPX extensions 
> (gpxx, gpxtpx, gpxtrx, etc) for defining extra attributes for their 
> GPS data.  I am wondering how I would specify these multiple extensions in my code?
> Currently, I am defining a single extension as shown below:
> 
> ds = drv.CreateDataSource(outputFilePath, new string[] { 
> "GPX_USE_EXTENSIONS=YES","GPX_EXTENSIONS_NS=gpxx","GPX_EXTENSIONS_NS_U
> RL=h ttp://www.garmin.com/xmlschemas/GpxExtensions/v3"});}
> 
> How would I go about setting more namespaces (gpxtpx, gpxtrx, ...)?

This is not possible currently. Would require an enhancement in the driver, like acception a comma separated list of values for GPX_EXTENSIONS_NS and GPX_EXTENSIONS_NS_URL

> And
> then how would I specify that an attribute belongs in a particular 
> extension?

It could detect it by the name of attribute. For example, gpxx_foo, gpxtpx_bar, gpxtrx_baz

> 
> Thanks,
> 
> Chris
> 
> Chris Pouliot  |  GIS Application Developer MN.IT Services @ 
> Department of Natural Resources
> (651) 259-5491 (w)  |  christopher.pouliot at state.mn.us 
> [cid:image002.jpg at 01CEDB9E.F20C9670]<http://www.mn.gov/oet>  Information
> Technology for Minnesota Government   |  
> mn.gov/oet<http://www.mn.gov/oet>

--
Geospatial professional services
http://even.rouault.free.fr/services.html


From even.rouault at mines-paris.org  Thu Nov  7 11:46:46 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 7 Nov 2013 20:46:46 +0100
Subject: [gdal-dev] Writing GPX Files with multiple Extensions
In-Reply-To: <074A014435F2E543B1FD97E729C76E4D0ADE8DF4@055-CH1MPN1-011.055d.mgd.msft.net>
References: <074A014435F2E543B1FD97E729C76E4D0ADE8BA3@055-CH1MPN1-011.055d.mgd.msft.net>
	<201311072022.21469.even.rouault@mines-paris.org>
	<074A014435F2E543B1FD97E729C76E4D0ADE8DF4@055-CH1MPN1-011.055d.mgd.msft.net>
Message-ID: <201311072046.46365.even.rouault@mines-paris.org>

Le jeudi 07 novembre 2013 20:41:48, Pouliot, Christopher (MNIT) a ?crit :
> Even,
> 
> Thanks for the response!  I see that GPSBabel uses GDAL

Really ? OGR has a GPSBabel driver, but I didn't know that the reversed way 
existed.

> and writes out
> multiple extensions.  I'll check with them to see how they are doing it.

GPSBabel has its own GPX reader/writer. It wouldn't be difficult to extend the 
OGR GPX driver to implement what I mentionned below. Alternatively you could 
generate the GPX yourself. It is quite easy.

> 
> Chris
> 
> -----Original Message-----
> From: Even Rouault [mailto:even.rouault at mines-paris.org]
> Sent: Thursday, November 07, 2013 1:22 PM
> To: gdal-dev at lists.osgeo.org
> Cc: Pouliot, Christopher (MNIT)
> Subject: Re: [gdal-dev] Writing GPX Files with multiple Extensions
> 
> Le jeudi 07 novembre 2013 16:51:35, Pouliot, Christopher (MNIT) a ?crit :
> > Hello All,
> > 
> > I am currently using GDAL 1.9 and I'm writing out GPX files for
> > uploading onto Garmin units.  Garmin has many different GPX extensions
> > (gpxx, gpxtpx, gpxtrx, etc) for defining extra attributes for their
> > GPS data.  I am wondering how I would specify these multiple extensions
> > in my code? Currently, I am defining a single extension as shown below:
> > 
> > ds = drv.CreateDataSource(outputFilePath, new string[] {
> > "GPX_USE_EXTENSIONS=YES","GPX_EXTENSIONS_NS=gpxx","GPX_EXTENSIONS_NS_U
> > RL=h ttp://www.garmin.com/xmlschemas/GpxExtensions/v3"});}
> > 
> > How would I go about setting more namespaces (gpxtpx, gpxtrx, ...)?
> 
> This is not possible currently. Would require an enhancement in the driver,
> like acception a comma separated list of values for GPX_EXTENSIONS_NS and
> GPX_EXTENSIONS_NS_URL
> 
> > And
> > then how would I specify that an attribute belongs in a particular
> > extension?
> 
> It could detect it by the name of attribute. For example, gpxx_foo,
> gpxtpx_bar, gpxtrx_baz
> 
> > Thanks,
> > 
> > Chris
> > 
> > Chris Pouliot  |  GIS Application Developer MN.IT Services @
> > Department of Natural Resources
> > (651) 259-5491 (w)  |  christopher.pouliot at state.mn.us
> > [cid:image002.jpg at 01CEDB9E.F20C9670]<http://www.mn.gov/oet>  Information
> > Technology for Minnesota Government   |
> > mn.gov/oet<http://www.mn.gov/oet>
> 
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From Christopher.Pouliot at state.mn.us  Thu Nov  7 12:15:04 2013
From: Christopher.Pouliot at state.mn.us (Pouliot, Christopher (MNIT))
Date: Thu, 7 Nov 2013 20:15:04 +0000
Subject: [gdal-dev] Writing GPX Files with multiple Extensions
In-Reply-To: <201311072046.46365.even.rouault@mines-paris.org>
References: <074A014435F2E543B1FD97E729C76E4D0ADE8BA3@055-CH1MPN1-011.055d.mgd.msft.net>
	<201311072022.21469.even.rouault@mines-paris.org>
	<074A014435F2E543B1FD97E729C76E4D0ADE8DF4@055-CH1MPN1-011.055d.mgd.msft.net>
	<201311072046.46365.even.rouault@mines-paris.org>
Message-ID: <074A014435F2E543B1FD97E729C76E4D0ADE8E6A@055-CH1MPN1-011.055d.mgd.msft.net>

Attached is a sample from downloading one Waypoint and a track using GPSBabel.  I'll look into the GPSBabel driver.  I don't have much time to devote to this so hope to find a relatively quick solution.

Thanks again!

Chris


-----Original Message-----
From: Even Rouault [mailto:even.rouault at mines-paris.org] 
Sent: Thursday, November 07, 2013 1:47 PM
To: Pouliot, Christopher (MNIT)
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Writing GPX Files with multiple Extensions

Le jeudi 07 novembre 2013 20:41:48, Pouliot, Christopher (MNIT) a ?crit :
> Even,
> 
> Thanks for the response!  I see that GPSBabel uses GDAL

Really ? OGR has a GPSBabel driver, but I didn't know that the reversed way existed.

> and writes out
> multiple extensions.  I'll check with them to see how they are doing it.

GPSBabel has its own GPX reader/writer. It wouldn't be difficult to extend the OGR GPX driver to implement what I mentionned below. Alternatively you could generate the GPX yourself. It is quite easy.

> 
> Chris
> 
> -----Original Message-----
> From: Even Rouault [mailto:even.rouault at mines-paris.org]
> Sent: Thursday, November 07, 2013 1:22 PM
> To: gdal-dev at lists.osgeo.org
> Cc: Pouliot, Christopher (MNIT)
> Subject: Re: [gdal-dev] Writing GPX Files with multiple Extensions
> 
> Le jeudi 07 novembre 2013 16:51:35, Pouliot, Christopher (MNIT) a ?crit :
> > Hello All,
> > 
> > I am currently using GDAL 1.9 and I'm writing out GPX files for 
> > uploading onto Garmin units.  Garmin has many different GPX 
> > extensions (gpxx, gpxtpx, gpxtrx, etc) for defining extra attributes 
> > for their GPS data.  I am wondering how I would specify these 
> > multiple extensions in my code? Currently, I am defining a single extension as shown below:
> > 
> > ds = drv.CreateDataSource(outputFilePath, new string[] { 
> > "GPX_USE_EXTENSIONS=YES","GPX_EXTENSIONS_NS=gpxx","GPX_EXTENSIONS_NS
> > _U RL=h ttp://www.garmin.com/xmlschemas/GpxExtensions/v3"});}
> > 
> > How would I go about setting more namespaces (gpxtpx, gpxtrx, ...)?
> 
> This is not possible currently. Would require an enhancement in the 
> driver, like acception a comma separated list of values for 
> GPX_EXTENSIONS_NS and GPX_EXTENSIONS_NS_URL
> 
> > And
> > then how would I specify that an attribute belongs in a particular 
> > extension?
> 
> It could detect it by the name of attribute. For example, gpxx_foo, 
> gpxtpx_bar, gpxtrx_baz
> 
> > Thanks,
> > 
> > Chris
> > 
> > Chris Pouliot  |  GIS Application Developer MN.IT Services @ 
> > Department of Natural Resources
> > (651) 259-5491 (w)  |  christopher.pouliot at state.mn.us 
> > [cid:image002.jpg at 01CEDB9E.F20C9670]<http://www.mn.gov/oet>  Information
> > Technology for Minnesota Government   |
> > mn.gov/oet<http://www.mn.gov/oet>
> 
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html

--
Geospatial professional services
http://even.rouault.free.fr/services.html

-------------- next part --------------
A non-text attachment was scrubbed...
Name: babel.gpx
Type: application/octet-stream
Size: 2119 bytes
Desc: babel.gpx
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131107/dbf9648b/attachment.obj>

From howarth at bromo.med.uc.edu  Thu Nov  7 13:34:07 2013
From: howarth at bromo.med.uc.edu (Jack Howarth)
Date: Thu, 7 Nov 2013 16:34:07 -0500
Subject: [gdal-dev] Motion: Approve GDAL/OGR 1.10.1RC1 for release
Message-ID: <20131107213407.GA24403@bromo.med.uc.edu>

The failures on x86_64-apple-darwin13 for the png.py test suite from auto
test for gdal 0.10.1 are the same failures described here...

https://github.com/licq-im/licq/pull/32
<https://github.com/licq-im/licq/pull/32>

The failures are completely suppressed by regenerating
autotest/gdrivers/data/test.png with
"optipng -nb -nc -np test.png"...

% ./png.py
  TEST: png_1 ... success
  TEST: png_2 ... success
  TEST: png_3 ... success
  TEST: png_4 ... success
  TEST: png_5 ... success
  TEST: png_6 ... success
  TEST: png_7 ... success
  TEST: png_8 ... success
  TEST: png_9 ... success
  TEST: png_10 ... success
  TEST: png_11 ... success

Test Script: png
Succeeded: 11
Failed:    0 (0 blew exceptions)
Skipped:   0
Expected fail:0
Duration:  0.08s


From salim at pixoneer.co.kr  Thu Nov  7 16:17:27 2013
From: salim at pixoneer.co.kr (=?ks_c_5601-1987?B?U2V1bmcgQWUgTGlt?=)
Date: Fri, 08 Nov 2013 09:17:27 +0900
Subject: [gdal-dev] =?ks_c_5601-1987?q?NewDataset_and_SetBand_error?=
Message-ID: <1383869847.18409.142.salim@pixoneer.co.kr>

I build GDAL library just opening "makegdal10.sln".
My test program is just simple console application with VS2010 without any added configuration.
GDAL :f:\gdal-1.10.0\
Test program include config :f:\gdal-1.10.0\port\;f:\gdal-1.10.0\gcore;f:\gdal-1.10.0\ogr;f:\gdal-1.10.0\frmts;
Test program link path :f:\gdal-1.10.0\gdal_i.lib

In my thought, my program may use same sources with GDAL.

Is there any GDAL configuration for my program?

Thanks.
Seung Ae


----- Original Message -----
From:Frank Warmerdam [warmerdam at pobox.com]
To:Seung Ae Lim [salim at pixoneer.co.kr]
Cc:gdal dev [gdal-dev at lists.osgeo.org]
Sent:Fri , November 08, 2013 01:31 AM
Subject:Re: [gdal-dev] NewDataset and SetBand error




Seung,


If the fields, like papoBands in the dataset seem ok before stepping into SetBand(), and corrupt once you are inside I would suspect that GDAL and your application have been built with different gdal_priv.h include files *or* with different structure alighnments flags for Visual Studio. Did you build GDAL from source using the same configuration you are building your application with?


Best regards,
Frank






On Thu, Nov 7, 2013 at 1:03 AM, Seung Ae Lim < salim at pixoneer.co.kr > wrote:



Dear,

I make a console application with VS2010 linking "gdal_i.lib".
The steps are :
1. Create New Dataset and Band in main.cpp
class XXDataset : public GDALPamDataset
{
public:
	XXDataset() {};
	~XXDataset() {};

	static GDALDataset* Open(GDALOpenInfo*);
};

class XXRasterBand : public GDALPamRasterBand
{
public:
	XXRasterBand( GDALDataset*, int, GDALDataType );
	~XXRasterBand() {};
};



GDALDataset* XXDataset::Open(GDALOpenInfo* pOpenInfo)
{
	XXDataset* poDS = new XXDataset();
	poDS-  >nRasterXSize = 100;
	poDS-  >nRasterYSize = 200;
	poDS-  >eAccess = GA_Update;
	poDS-  >nBands = 3;

	int iBand = 0;
	for(iBand = 1; iBand <  = 3; iBand++ )
	{
		XXRasterBand* band = new XXRasterBand( poDS, iBand, GDT_Byte);
		poDS-  >SetBand( iBand, band );
	}

	return poDS;
}

XXRasterBand::XXRasterBand( GDALDataset *poDS, int nBand, GDALDataType eType)
{
	this-  >poDS = poDS;
	this-  >nBand = nBand;
	this-  >eDataType = eType;
	nRasterXSize = 100;
	nRasterYSize = 200;
	nBlockXSize = nRasterXSize;
	nBlockYSize = nRasterYSize;
}

2. Add the code in main function
void main()
{


    GDALDataset* pDSTemp = XXDataset::Open(NULL);
	if (pDSTemp) GDALClose(pDSTemp);
}



I compile and try to debug this app.
But in "poDS- >SetBand" line of "XXDataset::Open", the app is broken when the first band is ready to set.
In XXDataset::Open, all value of parameters is right.
But When stepping into the "SetBand" function, the values may be corrupted.
"papobands" of GDALDataset is not null and it make an error.

Please let me know the reason or some tips.

Thanks.



  

_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org

http://lists.osgeo.org/mailman/listinfo/gdal-dev








-- 

---------------------------------------+--------------------------------------

I set the clouds in motion - turn up | Frank Warmerdam, warmerdam at pobox.com

light and sound - activate the windows | http://pobox.com/~warmerdam

and watch the world go round - Rush  | Geospatial Software Developer

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131108/55d88a90/attachment-0001.html>

From tpiepho at gmail.com  Thu Nov  7 17:46:24 2013
From: tpiepho at gmail.com (Trent Piepho)
Date: Thu,  7 Nov 2013 17:46:24 -0800
Subject: [gdal-dev] [PATCH v2] Support Mercator_2SP in GeoTIFF
In-Reply-To: <201311042012.56445.even.rouault@mines-paris.org>
References: <201311042012.56445.even.rouault@mines-paris.org>
Message-ID: <1383875184-8839-1-git-send-email-tpiepho@gmail.com>

Mercator_[12]SP are both the same projection in GeoTIFF.  Lacking a
definition in the official specification, the intention appears to be that
for Mercator_2SP the latitude of true scale (lat_ts) should be specified in
ProjStdParallel1GeoKey and for Mercator_1SP the scale at origin (k) should
be specified in ProjScaleAtNatOriginGeoKey.  As proposed here,
http://permalink.gmane.org/gmane.comp.gis.geotiff/387

Current behavior when creating a GTiff with 2SP is to drop lat_ts and create
a default k value of 1.0, which will product an incorrect projection.  When
reading, 1SP is always used and lat_ts is ignored.  It is expected that
libgeotiff will provide a default k of 1.0 if none was specified in the
file.

This patches changes the behavior when writing to supply
ProjScaleAtNatOriginGeoKey for Mercator_1SP or ProjStdParallel1GeoKey for
Mercator_2SP.

When reading, 2SP is used if ProjStdParallel1GeoKey is present and 1SP is
used otherwise.  A warning is issued if both keys are present (and scale is
ignored).  It is expected that libgeotiff's normalization will continue to
provide a default scale of 1.0 if neither parameter is present.
---
v2
Split out libgeotiff part.  This patch does not need the libgeotiff
patch to be applied.  Will write correctly without libgeotiff patch. 
Reading will be unchanged unless libgeotiff is also patched.

 gdal/frmts/gtiff/gt_wkt_srs.cpp |   28 ++++++++++++++++++++++------
 1 file changed, 22 insertions(+), 6 deletions(-)

diff --git a/gdal/frmts/gtiff/gt_wkt_srs.cpp b/gdal/frmts/gtiff/gt_wkt_srs.cpp
index 5934df5..0afb101 100644
--- a/gdal/frmts/gtiff/gt_wkt_srs.cpp
+++ b/gdal/frmts/gtiff/gt_wkt_srs.cpp
@@ -737,9 +737,21 @@ char *GTIFGetOGISDefn( GTIF *hGTIF, GTIFDefn * psDefn )
             break;
 
           case CT_Mercator:
-            oSRS.SetMercator( adfParm[0], adfParm[1],
-                              adfParm[4],
-                              adfParm[5], adfParm[6] );
+            /* If a lat_ts was specified use 2SP, otherwise use 1SP */
+            if (psDefn->ProjParmId[2] == ProjStdParallel1GeoKey)
+            {
+                if (psDefn->ProjParmId[4] == ProjScaleAtNatOriginGeoKey)
+                    CPLError( CE_Warning, CPLE_AppDefined,
+                              "Mercator projection should not define both StdParallel1 and ScaleAtNatOrigin.\n"
+                              "Using StdParallel1 and ignoring ScaleAtNatOrigin.\n" );
+                oSRS.SetMercator2SP( adfParm[2],
+                                     adfParm[0], adfParm[1],
+                                     adfParm[5], adfParm[6]);
+            }
+            else
+                oSRS.SetMercator( adfParm[0], adfParm[1],
+                                  adfParm[4],
+                                  adfParm[5], adfParm[6] );
                               
             if (psDefn->Projection == 1024 || psDefn->Projection == 9841) // override hack for google mercator. 
             {
@@ -1510,14 +1522,18 @@ int GTIFSetFromOGISDefn( GTIF * psGTIF, const char *pszOGCWKT )
         GTIFKeySet(psGTIF, ProjNatOriginLongGeoKey, TYPE_DOUBLE, 1,
                    poSRS->GetNormProjParm( SRS_PP_CENTRAL_MERIDIAN, 0.0 ) );
         
-        GTIFKeySet(psGTIF, ProjScaleAtNatOriginGeoKey, TYPE_DOUBLE, 1,
-                   poSRS->GetNormProjParm( SRS_PP_SCALE_FACTOR, 1.0 ) );
-        
         GTIFKeySet(psGTIF, ProjFalseEastingGeoKey, TYPE_DOUBLE, 1,
                    poSRS->GetProjParm( SRS_PP_FALSE_EASTING, 0.0 ) );
         
         GTIFKeySet(psGTIF, ProjFalseNorthingGeoKey, TYPE_DOUBLE, 1,
                    poSRS->GetProjParm( SRS_PP_FALSE_NORTHING, 0.0 ) );
+
+        if( EQUAL(pszProjection,SRS_PT_MERCATOR_2SP) )
+            GTIFKeySet(psGTIF, ProjStdParallel1GeoKey, TYPE_DOUBLE, 1,
+                       poSRS->GetNormProjParm( SRS_PP_STANDARD_PARALLEL_1, 0.0 ) );
+        else
+            GTIFKeySet(psGTIF, ProjScaleAtNatOriginGeoKey, TYPE_DOUBLE, 1,
+                       poSRS->GetNormProjParm( SRS_PP_SCALE_FACTOR, 1.0 ) );
     }
     
     else if( EQUAL(pszProjection,SRS_PT_OBLIQUE_STEREOGRAPHIC) )
-- 
1.7.10.4


From even.rouault at mines-paris.org  Fri Nov  8 02:18:34 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 08 Nov 2013 11:18:34 +0100
Subject: [gdal-dev] [PATCH v2] Support Mercator_2SP in GeoTIFF
In-Reply-To: <1383875184-8839-1-git-send-email-tpiepho@gmail.com>
References: <201311042012.56445.even.rouault@mines-paris.org>
	<1383875184-8839-1-git-send-email-tpiepho@gmail.com>
Message-ID: <1383905914.527cba7aa01ab@imp.free.fr>

Selon Trent Piepho <tpiepho at gmail.com>:

Thanks. Would you mind attaching it in a ticket in GDAL trac :
http://trac.osgeo.org/gdal/newticket ?
I see you've created the ticket for the corresponding libgeotiff part. Before
applying the GDAL part, I think we should wait for Frank having reviewed and
applied the libgeotiff part, so that we can have round-tripping.


> Mercator_[12]SP are both the same projection in GeoTIFF.  Lacking a
> definition in the official specification, the intention appears to be that
> for Mercator_2SP the latitude of true scale (lat_ts) should be specified in
> ProjStdParallel1GeoKey and for Mercator_1SP the scale at origin (k) should
> be specified in ProjScaleAtNatOriginGeoKey.  As proposed here,
> http://permalink.gmane.org/gmane.comp.gis.geotiff/387
>
> Current behavior when creating a GTiff with 2SP is to drop lat_ts and create
> a default k value of 1.0, which will product an incorrect projection.  When
> reading, 1SP is always used and lat_ts is ignored.  It is expected that
> libgeotiff will provide a default k of 1.0 if none was specified in the
> file.
>
> This patches changes the behavior when writing to supply
> ProjScaleAtNatOriginGeoKey for Mercator_1SP or ProjStdParallel1GeoKey for
> Mercator_2SP.
>
> When reading, 2SP is used if ProjStdParallel1GeoKey is present and 1SP is
> used otherwise.  A warning is issued if both keys are present (and scale is
> ignored).  It is expected that libgeotiff's normalization will continue to
> provide a default scale of 1.0 if neither parameter is present.
> ---
> v2
> Split out libgeotiff part.  This patch does not need the libgeotiff
> patch to be applied.  Will write correctly without libgeotiff patch.
> Reading will be unchanged unless libgeotiff is also patched.
>
>  gdal/frmts/gtiff/gt_wkt_srs.cpp |   28 ++++++++++++++++++++++------
>  1 file changed, 22 insertions(+), 6 deletions(-)
>
> diff --git a/gdal/frmts/gtiff/gt_wkt_srs.cpp
> b/gdal/frmts/gtiff/gt_wkt_srs.cpp
> index 5934df5..0afb101 100644
> --- a/gdal/frmts/gtiff/gt_wkt_srs.cpp
> +++ b/gdal/frmts/gtiff/gt_wkt_srs.cpp
> @@ -737,9 +737,21 @@ char *GTIFGetOGISDefn( GTIF *hGTIF, GTIFDefn * psDefn )
>              break;
>
>            case CT_Mercator:
> -            oSRS.SetMercator( adfParm[0], adfParm[1],
> -                              adfParm[4],
> -                              adfParm[5], adfParm[6] );
> +            /* If a lat_ts was specified use 2SP, otherwise use 1SP */
> +            if (psDefn->ProjParmId[2] == ProjStdParallel1GeoKey)
> +            {
> +                if (psDefn->ProjParmId[4] == ProjScaleAtNatOriginGeoKey)
> +                    CPLError( CE_Warning, CPLE_AppDefined,
> +                              "Mercator projection should not define both
> StdParallel1 and ScaleAtNatOrigin.\n"
> +                              "Using StdParallel1 and ignoring
> ScaleAtNatOrigin.\n" );
> +                oSRS.SetMercator2SP( adfParm[2],
> +                                     adfParm[0], adfParm[1],
> +                                     adfParm[5], adfParm[6]);
> +            }
> +            else
> +                oSRS.SetMercator( adfParm[0], adfParm[1],
> +                                  adfParm[4],
> +                                  adfParm[5], adfParm[6] );
>
>              if (psDefn->Projection == 1024 || psDefn->Projection == 9841) //
> override hack for google mercator.
>              {
> @@ -1510,14 +1522,18 @@ int GTIFSetFromOGISDefn( GTIF * psGTIF, const char
> *pszOGCWKT )
>          GTIFKeySet(psGTIF, ProjNatOriginLongGeoKey, TYPE_DOUBLE, 1,
>                     poSRS->GetNormProjParm( SRS_PP_CENTRAL_MERIDIAN, 0.0 ) );
>
> -        GTIFKeySet(psGTIF, ProjScaleAtNatOriginGeoKey, TYPE_DOUBLE, 1,
> -                   poSRS->GetNormProjParm( SRS_PP_SCALE_FACTOR, 1.0 ) );
> -
>          GTIFKeySet(psGTIF, ProjFalseEastingGeoKey, TYPE_DOUBLE, 1,
>                     poSRS->GetProjParm( SRS_PP_FALSE_EASTING, 0.0 ) );
>
>          GTIFKeySet(psGTIF, ProjFalseNorthingGeoKey, TYPE_DOUBLE, 1,
>                     poSRS->GetProjParm( SRS_PP_FALSE_NORTHING, 0.0 ) );
> +
> +        if( EQUAL(pszProjection,SRS_PT_MERCATOR_2SP) )
> +            GTIFKeySet(psGTIF, ProjStdParallel1GeoKey, TYPE_DOUBLE, 1,
> +                       poSRS->GetNormProjParm( SRS_PP_STANDARD_PARALLEL_1,
> 0.0 ) );
> +        else
> +            GTIFKeySet(psGTIF, ProjScaleAtNatOriginGeoKey, TYPE_DOUBLE, 1,
> +                       poSRS->GetNormProjParm( SRS_PP_SCALE_FACTOR, 1.0 ) );
>      }
>
>      else if( EQUAL(pszProjection,SRS_PT_OBLIQUE_STEREOGRAPHIC) )
> --
> 1.7.10.4
>
>



From hbobenicio at gmail.com  Fri Nov  8 05:21:45 2013
From: hbobenicio at gmail.com (Hugo Benicio)
Date: Fri, 8 Nov 2013 11:21:45 -0200
Subject: [gdal-dev] Building GDAL 1.9.2 for debugging
Message-ID: <CAKGFd-ynFV47Qkn32k98upOLjU5CW73uG5+etQOCPmykYW2FQA@mail.gmail.com>

I'm trying to compile GDAL 1.9.2 from source by myself using the DEBUG=1
build.

There is a flag on nmake.opt for VLD support:
MSVC_VLD_DIR="C:\Program Files\Visual Leak Detector"

although, if I try to use it, it give me strange error while building gdal.

Anyways, I'm building gdal like this:
nmake -f makefile.vc MSVC_VER=1500 DEBUG=1

which seems to run nicely. Then I do:
nmake -f makefile.vc MSVC_VER=1500 DEBUG=1 install

Ok, everything seems good. I get the "gdal19.dll", "gdal_i.lib" and
"gdal19.pdb"...
but, where do I get the include files to use in my project?
My build directory (GDAL_HOME =
"C:\Users\Hugo\Downloads\gdal-1.9.2\build-debug")
gives me only a "bin", "data" and "html" folders...
Did the build really succeed? How can I get the include directory to build
my project?

Thanks in advance,
Hugo Ben?cio.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131108/2381eefe/attachment.html>

From hbobenicio at gmail.com  Fri Nov  8 05:45:07 2013
From: hbobenicio at gmail.com (Hugo Benicio)
Date: Fri, 8 Nov 2013 11:45:07 -0200
Subject: [gdal-dev] Building GDAL 1.9.2 for debugging
In-Reply-To: <CAKGFd-ynFV47Qkn32k98upOLjU5CW73uG5+etQOCPmykYW2FQA@mail.gmail.com>
References: <CAKGFd-ynFV47Qkn32k98upOLjU5CW73uG5+etQOCPmykYW2FQA@mail.gmail.com>
Message-ID: <CAKGFd-wfM5K=DW0A7mdyjYFG_jgSUqqN69KPeVXYR0=smmEBmw@mail.gmail.com>

Nevermind, I got it
I was missing

nmake /f makefile.vc devinstall



On Fri, Nov 8, 2013 at 10:21 AM, Hugo Benicio <hbobenicio at gmail.com> wrote:

> I'm trying to compile GDAL 1.9.2 from source by myself using the DEBUG=1
> build.
>
> There is a flag on nmake.opt for VLD support:
> MSVC_VLD_DIR="C:\Program Files\Visual Leak Detector"
>
> although, if I try to use it, it give me strange error while building gdal.
>
> Anyways, I'm building gdal like this:
> nmake -f makefile.vc MSVC_VER=1500 DEBUG=1
>
> which seems to run nicely. Then I do:
> nmake -f makefile.vc MSVC_VER=1500 DEBUG=1 install
>
> Ok, everything seems good. I get the "gdal19.dll", "gdal_i.lib" and
> "gdal19.pdb"...
> but, where do I get the include files to use in my project?
> My build directory (GDAL_HOME =
> "C:\Users\Hugo\Downloads\gdal-1.9.2\build-debug")
> gives me only a "bin", "data" and "html" folders...
> Did the build really succeed? How can I get the include directory to build
> my project?
>
> Thanks in advance,
> Hugo Ben?cio.
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131108/12bcf3a6/attachment.html>

From bontepaarden at gmail.com  Fri Nov  8 05:52:17 2013
From: bontepaarden at gmail.com (Paul Meems)
Date: Fri, 8 Nov 2013 14:52:17 +0100
Subject: [gdal-dev] Fwd:  Changed API for exportToGEOS
In-Reply-To: <CAHNf2YTS=e2z4mk_9rtH9X76cZYmmjhgCKB4XaxXQPrPKtuBOA@mail.gmail.com>
References: <CAHNf2YQfp-5M3m72Dyaw0s=zVg8FC2dQ3-xsTy=GTJqRUEUYpw@mail.gmail.com>
	<CAHNf2YSBJUcid1Q7ibAFHCR23G=8aqOxEBV=hjxTYjxhD74=rg@mail.gmail.com>
	<CAHNf2YTZuCQ3Nz9WTmM5toe+AtDFq20ToE+yVatkDzpnOcAG6Q@mail.gmail.com>
	<201310231353.58159.even.rouault@mines-paris.org>
	<CAHNf2YQV+TVbm9RDyW==VieNsfcnSZCywSLfbj1w9Up8hK3BZw@mail.gmail.com>
	<CAHNf2YTS=e2z4mk_9rtH9X76cZYmmjhgCKB4XaxXQPrPKtuBOA@mail.gmail.com>
Message-ID: <CAHNf2YSQwrVZ4D40uTrP=cO7QdfsaRZRQvKnW-YiAt=oFQmhaw@mail.gmail.com>

Hi all,

Sorry to bother you all again.
We're still struggling with upgrading to GDAL and GEOS.
When I use GDALv1.9 with GEOSv3.3.5 with our C++ application (MapWinGIS), I
have no problems.
The GEOS methods are still working. I've made a test to buffer a geometry.

When I upgrade to GDAL trunk (v1.11) and GEOSv3.4.2 I can't compile my
project because of API changes.
As mentioned before the function createFromGEOS() has now a different
signature.

First of all why was this method changed instead of creating a new one?
There is a buffer and a buffer_r method.
If the new method would have been called createFromGEOS_r() we would not
have so much trouble.

Secondly I added GEOSContextHandle_t hGEOSCtxt =
OGRGeometry::createGEOSContext(); before calling the changed
createFromGEOS().
I can compile now but GEOSBuffer() is always returning NULL.

If the original situation cannot be restored be keeping createFromGEOS and
creating createFromGEOS_r I need to know how I should change the rest of my
code to make the GEOS functions work again. I can try to use buffer_r and
use the context created before. But that means I need to change a lot of
code. Before I do that I need to know if that is solving my issue.

Our BufferByDistance function is now not working and probably needs to be
changed. The source code is here:
https://mapwingis.svn.codeplex.com/svn/MapWinGIS/trunk/COM%20classes/Shapefile_Geoprocessing.cpp
Our Shape2GEOSGeom() function is now calling createGEOSContext() and
Shape2GEOSGeom is called by our BufferByDistance function. The code is here:
https://mapwingis.svn.codeplex.com/svn/MapWinGIS/trunk/Processing/GeometryConverter.cpp

I think I need to create the context in our BufferByDistance function and
pass it as an argument to our Shape2GEOSGeom() function. Next I should
switch to GEOSBuffer_r and use the same context. Am I right? Is that the
correct approach? If so I need to change the signature of our
Shape2GEOSGeom() function which is use in a lot places. That is OK, as long
as I know it is the solution.

Thanks for any help,

Paul
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131108/ee8cfb78/attachment-0001.html>

From andre+joost at nurfuerspam.de  Fri Nov  8 06:27:22 2013
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Fri, 08 Nov 2013 15:27:22 +0100
Subject: [gdal-dev] Difference: EPSG 3004 - EPSG 102092
In-Reply-To: <dbav83lw2ao70h4jmswbequg.1383843154211@email.android.com>
References: <dbav83lw2ao70h4jmswbequg.1383843154211@email.android.com>
Message-ID: <l5isev$584$1@ger.gmane.org>

I guess this should have gone to the list too:

Am 07.11.2013 17:52, schrieb thare at usgs.gov:
> All, At least this issue with codes has just not negatively impacted
> the planetary community. While the planetary community had its own
> attempted codes, maybe it is time to try to start shedding the use of
> them all together in our community...? Ideally passing a uri
> (pointing to gml or WTK) or full passing full GML projection would be
> ideal.
>
> This finite set of codes are going to continue to be a nuisance for
> us all if we don't try to start implementing an alternative. I would
> love to see their use slowly deprecated. Or is that just too crazy to
> hope for.
>
> Thoughts?
>
> Regards, Trent
>




From howarth at bromo.med.uc.edu  Fri Nov  8 07:31:08 2013
From: howarth at bromo.med.uc.edu (Jack Howarth)
Date: Fri, 8 Nov 2013 10:31:08 -0500
Subject: [gdal-dev] Motion: Approve GDAL/OGR 1.10.1RC1 for release
In-Reply-To: <20131107213407.GA24403@bromo.med.uc.edu>
References: <20131107213407.GA24403@bromo.med.uc.edu>
Message-ID: <20131108153108.GA30467@bromo.med.uc.edu>

On Thu, Nov 07, 2013 at 04:34:07PM -0500, Jack Howarth wrote:
> The failures on x86_64-apple-darwin13 for the png.py test suite from auto
> test for gdal 0.10.1 are the same failures described here...
> 
> https://github.com/licq-im/licq/pull/32
> <https://github.com/licq-im/licq/pull/32>
> 
> The failures are completely suppressed by regenerating
> autotest/gdrivers/data/test.png with
> "optipng -nb -nc -np test.png"...

Just to clarify, I used optipng 0.6.3 for this. The newer optipng 0.7.4
release seems more problematic as none of the obvious combination of options
can fix the test.png file without changing the checksums and causing additional
failures. So you will want to use the optipng 0.6.x release series to fix
the bad png files in gdal.

> 
> % ./png.py
>   TEST: png_1 ... success
>   TEST: png_2 ... success
>   TEST: png_3 ... success
>   TEST: png_4 ... success
>   TEST: png_5 ... success
>   TEST: png_6 ... success
>   TEST: png_7 ... success
>   TEST: png_8 ... success
>   TEST: png_9 ... success
>   TEST: png_10 ... success
>   TEST: png_11 ... success
> 
> Test Script: png
> Succeeded: 11
> Failed:    0 (0 blew exceptions)
> Skipped:   0
> Expected fail:0
> Duration:  0.08s
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From howarth at bromo.med.uc.edu  Fri Nov  8 08:02:46 2013
From: howarth at bromo.med.uc.edu (Jack Howarth)
Date: Fri, 8 Nov 2013 11:02:46 -0500
Subject: [gdal-dev] Motion: Approve GDAL/OGR 1.10.1RC1 for release
In-Reply-To: <20131108153108.GA30467@bromo.med.uc.edu>
References: <20131107213407.GA24403@bromo.med.uc.edu>
	<20131108153108.GA30467@bromo.med.uc.edu>
Message-ID: <20131108160246.GA30666@bromo.med.uc.edu>

On Fri, Nov 08, 2013 at 10:31:08AM -0500, Jack Howarth wrote:
> On Thu, Nov 07, 2013 at 04:34:07PM -0500, Jack Howarth wrote:
> > The failures on x86_64-apple-darwin13 for the png.py test suite from auto
> > test for gdal 0.10.1 are the same failures described here...
> > 
> > https://github.com/licq-im/licq/pull/32
> > <https://github.com/licq-im/licq/pull/32>
> > 
> > The failures are completely suppressed by regenerating
> > autotest/gdrivers/data/test.png with
> > "optipng -nb -nc -np test.png"...
> 
> Just to clarify, I used optipng 0.6.3 for this. The newer optipng 0.7.4
> release seems more problematic as none of the obvious combination of options
> can fix the test.png file without changing the checksums and causing additional
> failures. So you will want to use the optipng 0.6.x release series to fix
> the bad png files in gdal.

Also, my tests here using optipng 0.7.4 to detect damaged png files indicate
that only data/gdalicon.png in gdal-0.10.1 needs to be fixed.

optipng -nb -nc -np -fix data/gdalicon.png
** Processing: data/gdalicon.png
Warning: 
32x32 pixels, 4x8 bits/pixel, RGB+alpha
Recoverable errors found in input. Fixing...
Input IDAT size = 1964 bytes
Input file size = 2021 bytes

Trying:
  zc = 9  zm = 8  zs = 0  f = 0		IDAT size = 240
                               
Selecting parameters:
  zc = 9  zm = 8  zs = 0  f = 0		IDAT size = 240

Output IDAT size = 240 bytes (1724 bytes decrease)
Output file size = 313 bytes (1708 bytes = 84.51% decrease)

** Status report
1 file(s) have been processed.
1 error(s) have been encountered.
1 erroneous file(s) have been fixed.


> 
> > 
> > % ./png.py
> >   TEST: png_1 ... success
> >   TEST: png_2 ... success
> >   TEST: png_3 ... success
> >   TEST: png_4 ... success
> >   TEST: png_5 ... success
> >   TEST: png_6 ... success
> >   TEST: png_7 ... success
> >   TEST: png_8 ... success
> >   TEST: png_9 ... success
> >   TEST: png_10 ... success
> >   TEST: png_11 ... success
> > 
> > Test Script: png
> > Succeeded: 11
> > Failed:    0 (0 blew exceptions)
> > Skipped:   0
> > Expected fail:0
> > Duration:  0.08s
> > 
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From schwehr at gmail.com  Fri Nov  8 09:12:05 2013
From: schwehr at gmail.com (Kurt Schwehr)
Date: Fri, 8 Nov 2013 09:12:05 -0800
Subject: [gdal-dev] libpng and autotest
In-Reply-To: <20131108160246.GA30666@bromo.med.uc.edu>
References: <20131107213407.GA24403@bromo.med.uc.edu>
	<20131108153108.GA30467@bromo.med.uc.edu>
	<20131108160246.GA30666@bromo.med.uc.edu>
Message-ID: <0A5CBBD2-FC9F-4DBA-8E36-A3E6022C1C92@gmail.com>

Jack,

Is there an explanation someplace with more detail as to what is wrong those png's, why older versions of libpng are okay with it and why libpng has changed its behavior?

Thanks,
-kurt



On Nov 8, 2013, at 8:02 AM, Jack Howarth <howarth at bromo.med.uc.edu> wrote:

> On Fri, Nov 08, 2013 at 10:31:08AM -0500, Jack Howarth wrote:
>> On Thu, Nov 07, 2013 at 04:34:07PM -0500, Jack Howarth wrote:
>>> The failures on x86_64-apple-darwin13 for the png.py test suite from auto
>>> test for gdal 0.10.1 are the same failures described here...
>>> 
>>> https://github.com/licq-im/licq/pull/32
>>> <https://github.com/licq-im/licq/pull/32>
>>> 
>>> The failures are completely suppressed by regenerating
>>> autotest/gdrivers/data/test.png with
>>> "optipng -nb -nc -np test.png"...
>> 
>> Just to clarify, I used optipng 0.6.3 for this. The newer optipng 0.7.4
>> release seems more problematic as none of the obvious combination of options
>> can fix the test.png file without changing the checksums and causing additional
>> failures. So you will want to use the optipng 0.6.x release series to fix
>> the bad png files in gdal.
> 
> Also, my tests here using optipng 0.7.4 to detect damaged png files indicate
> that only data/gdalicon.png in gdal-0.10.1 needs to be fixed.
> 
> optipng -nb -nc -np -fix data/gdalicon.png
> ** Processing: data/gdalicon.png
> Warning: 
> 32x32 pixels, 4x8 bits/pixel, RGB+alpha
> Recoverable errors found in input. Fixing...
> Input IDAT size = 1964 bytes
> Input file size = 2021 bytes
> 
> Trying:
>  zc = 9  zm = 8  zs = 0  f = 0		IDAT size = 240
> 
> Selecting parameters:
>  zc = 9  zm = 8  zs = 0  f = 0		IDAT size = 240
> 
> Output IDAT size = 240 bytes (1724 bytes decrease)
> Output file size = 313 bytes (1708 bytes = 84.51% decrease)
> 
> ** Status report
> 1 file(s) have been processed.
> 1 error(s) have been encountered.
> 1 erroneous file(s) have been fixed.
> 
> 
>> 
>>> 
>>> % ./png.py
>>>  TEST: png_1 ... success
>>>  TEST: png_2 ... success
>>>  TEST: png_3 ... success
>>>  TEST: png_4 ... success
>>>  TEST: png_5 ... success
>>>  TEST: png_6 ... success
>>>  TEST: png_7 ... success
>>>  TEST: png_8 ... success
>>>  TEST: png_9 ... success
>>>  TEST: png_10 ... success
>>>  TEST: png_11 ... success
>>> 
>>> Test Script: png
>>> Succeeded: 11
>>> Failed:    0 (0 blew exceptions)
>>> Skipped:   0
>>> Expected fail:0
>>> Duration:  0.08s
>>> 
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From howarth at bromo.med.uc.edu  Fri Nov  8 09:50:45 2013
From: howarth at bromo.med.uc.edu (Jack Howarth)
Date: Fri, 8 Nov 2013 12:50:45 -0500
Subject: [gdal-dev] libpng and autotest
In-Reply-To: <0A5CBBD2-FC9F-4DBA-8E36-A3E6022C1C92@gmail.com>
References: <20131107213407.GA24403@bromo.med.uc.edu>
	<20131108153108.GA30467@bromo.med.uc.edu>
	<20131108160246.GA30666@bromo.med.uc.edu>
	<0A5CBBD2-FC9F-4DBA-8E36-A3E6022C1C92@gmail.com>
Message-ID: <20131108175045.GA31245@bromo.med.uc.edu>

On Fri, Nov 08, 2013 at 09:12:05AM -0800, Kurt Schwehr wrote:
> Jack,
> 
> Is there an explanation someplace with more detail as to what is wrong those png's, why older versions of libpng are okay with it and why libpng has changed its behavior?
> 
> Thanks,
> -kurt

Kurt,
   The following link...

http://comments.gmane.org/gmane.comp.graphics.png.devel/6017

appears to discuss the issue we are seeing with the test.png file...

>  Libpng-1.6.0 through 1.6.2 use the CMF bytes at the beginning of an zlib datastream to set the window size for decoding.  
>  Libpng-1.5.x and earlier ignored the CMF bytes and always used a 32kbyte window.  Libpng-1.6.x has uncovered the fact 
>  that there are hundreds of files in the wild (found in linux distributions such as gentoo) with a too-small CMF, which 
>  results in a "Too far back" error when decoding these PNGs.  I have not yet been able to discover what application is producing these.

If you read completely through the gmane.comp.graphics.png.devel/6017 thread, you should be
at least convinced that such corruption is a known issue.
          Jack

> 
> 
> 
> On Nov 8, 2013, at 8:02 AM, Jack Howarth <howarth at bromo.med.uc.edu> wrote:
> 
> > On Fri, Nov 08, 2013 at 10:31:08AM -0500, Jack Howarth wrote:
> >> On Thu, Nov 07, 2013 at 04:34:07PM -0500, Jack Howarth wrote:
> >>> The failures on x86_64-apple-darwin13 for the png.py test suite from auto
> >>> test for gdal 0.10.1 are the same failures described here...
> >>> 
> >>> https://github.com/licq-im/licq/pull/32
> >>> <https://github.com/licq-im/licq/pull/32>
> >>> 
> >>> The failures are completely suppressed by regenerating
> >>> autotest/gdrivers/data/test.png with
> >>> "optipng -nb -nc -np test.png"...
> >> 
> >> Just to clarify, I used optipng 0.6.3 for this. The newer optipng 0.7.4
> >> release seems more problematic as none of the obvious combination of options
> >> can fix the test.png file without changing the checksums and causing additional
> >> failures. So you will want to use the optipng 0.6.x release series to fix
> >> the bad png files in gdal.
> > 
> > Also, my tests here using optipng 0.7.4 to detect damaged png files indicate
> > that only data/gdalicon.png in gdal-0.10.1 needs to be fixed.
> > 
> > optipng -nb -nc -np -fix data/gdalicon.png
> > ** Processing: data/gdalicon.png
> > Warning: 
> > 32x32 pixels, 4x8 bits/pixel, RGB+alpha
> > Recoverable errors found in input. Fixing...
> > Input IDAT size = 1964 bytes
> > Input file size = 2021 bytes
> > 
> > Trying:
> >  zc = 9  zm = 8  zs = 0  f = 0		IDAT size = 240
> > 
> > Selecting parameters:
> >  zc = 9  zm = 8  zs = 0  f = 0		IDAT size = 240
> > 
> > Output IDAT size = 240 bytes (1724 bytes decrease)
> > Output file size = 313 bytes (1708 bytes = 84.51% decrease)
> > 
> > ** Status report
> > 1 file(s) have been processed.
> > 1 error(s) have been encountered.
> > 1 erroneous file(s) have been fixed.
> > 
> > 
> >> 
> >>> 
> >>> % ./png.py
> >>>  TEST: png_1 ... success
> >>>  TEST: png_2 ... success
> >>>  TEST: png_3 ... success
> >>>  TEST: png_4 ... success
> >>>  TEST: png_5 ... success
> >>>  TEST: png_6 ... success
> >>>  TEST: png_7 ... success
> >>>  TEST: png_8 ... success
> >>>  TEST: png_9 ... success
> >>>  TEST: png_10 ... success
> >>>  TEST: png_11 ... success
> >>> 
> >>> Test Script: png
> >>> Succeeded: 11
> >>> Failed:    0 (0 blew exceptions)
> >>> Skipped:   0
> >>> Expected fail:0
> >>> Duration:  0.08s
> >>> 
> >>> _______________________________________________
> >>> gdal-dev mailing list
> >>> gdal-dev at lists.osgeo.org
> >>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >> _______________________________________________
> >> gdal-dev mailing list
> >> gdal-dev at lists.osgeo.org
> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev

From jukka.rahkonen at mmmtike.fi  Fri Nov  8 10:19:35 2013
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Fri, 8 Nov 2013 18:19:35 +0000 (UTC)
Subject: [gdal-dev] In which version utilities have appeared?
Message-ID: <loom.20131108T191558-267@post.gmane.org>

Hi,

Is there a list about the minimum GDAL version for each of the GDAL tools in
http://www.gdal.org/gdal_utilities.html?

-Jukka Rahkonen-


From even.rouault at mines-paris.org  Fri Nov  8 10:22:36 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 8 Nov 2013 19:22:36 +0100
Subject: [gdal-dev] In which version utilities have appeared?
In-Reply-To: <loom.20131108T191558-267@post.gmane.org>
References: <loom.20131108T191558-267@post.gmane.org>
Message-ID: <201311081922.36592.even.rouault@mines-paris.org>

Le vendredi 08 novembre 2013 19:19:35, Jukka Rahkonen a ?crit :
> Hi,
> 
> Is there a list about the minimum GDAL version for each of the GDAL tools
> in http://www.gdal.org/gdal_utilities.html?

Not directly. A solution would be to download the *doc packages on 
http://download.osgeo.org/gdal/ and look at the differences

> 
> -Jukka Rahkonen-
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From jukka.rahkonen at mmmtike.fi  Fri Nov  8 10:30:34 2013
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Fri, 8 Nov 2013 18:30:34 +0000 (UTC)
Subject: [gdal-dev] In which version utilities have appeared?
References: <loom.20131108T191558-267@post.gmane.org>
	<201311081922.36592.even.rouault@mines-paris.org>
Message-ID: <loom.20131108T192424-827@post.gmane.org>

Even Rouault <even.rouault <at> mines-paris.org> writes:

> 
> Le vendredi 08 novembre 2013 19:19:35, Jukka Rahkonen a ?crit :
> > Hi,
> > 
> > Is there a list about the minimum GDAL version for each of the GDAL tools
> > in http://www.gdal.org/gdal_utilities.html?
> 
> Not directly. A solution would be to download the *doc packages on 
> http://download.osgeo.org/gdal/ and look at the differences

Oh dear. And if I bother to do that what might be a good place to share the
results? Wiki perhaps? I am writing short tutorials sometimes and it is 
essential to mension the versions because there are old GDAL versions in the
wild and included in other programs.

-Jukka-


From even.rouault at mines-paris.org  Fri Nov  8 10:34:29 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 8 Nov 2013 19:34:29 +0100
Subject: [gdal-dev] In which version utilities have appeared?
In-Reply-To: <loom.20131108T192424-827@post.gmane.org>
References: <loom.20131108T191558-267@post.gmane.org>
	<201311081922.36592.even.rouault@mines-paris.org>
	<loom.20131108T192424-827@post.gmane.org>
Message-ID: <201311081934.29459.even.rouault@mines-paris.org>

Le vendredi 08 novembre 2013 19:30:34, Jukka Rahkonen a ?crit :
> Even Rouault <even.rouault <at> mines-paris.org> writes:
> > Le vendredi 08 novembre 2013 19:19:35, Jukka Rahkonen a ?crit :
> > > Hi,
> > > 
> > > Is there a list about the minimum GDAL version for each of the GDAL
> > > tools in http://www.gdal.org/gdal_utilities.html?
> > 
> > Not directly. A solution would be to download the *doc packages on
> > http://download.osgeo.org/gdal/ and look at the differences
> 
> Oh dear. And if I bother to do that what might be a good place to share the
> results? Wiki perhaps? I am writing short tutorials sometimes and it is
> essential to mension the versions because there are old GDAL versions in
> the wild and included in other programs.

Well, I admire your energy. Why not being lazy and telling that your tutorial 
applies to GDAL 1.10 or above, and if people are using older versions some 
things might not apply.

> 
> -Jukka-
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From eadam at co.lincoln.or.us  Fri Nov  8 11:04:27 2013
From: eadam at co.lincoln.or.us (Eli Adam)
Date: Fri, 8 Nov 2013 11:04:27 -0800
Subject: [gdal-dev] In which version utilities have appeared?
In-Reply-To: <201311081934.29459.even.rouault@mines-paris.org>
References: <loom.20131108T191558-267@post.gmane.org>
	<201311081922.36592.even.rouault@mines-paris.org>
	<loom.20131108T192424-827@post.gmane.org>
	<201311081934.29459.even.rouault@mines-paris.org>
Message-ID: <CACqBkM_+WXBwkyc28tMQUPRi16m5HDxOkc8gxZqWbVgsuchjaw@mail.gmail.com>

On Fri, Nov 8, 2013 at 10:34 AM, Even Rouault
<even.rouault at mines-paris.org> wrote:
> Le vendredi 08 novembre 2013 19:30:34, Jukka Rahkonen a ?crit :
>> Even Rouault <even.rouault <at> mines-paris.org> writes:
>> > Le vendredi 08 novembre 2013 19:19:35, Jukka Rahkonen a ?crit :
>> > > Hi,
>> > >
>> > > Is there a list about the minimum GDAL version for each of the GDAL
>> > > tools in http://www.gdal.org/gdal_utilities.html?

There are not that many utilities, however, many of the utilities have
all kinds of flags and features which started at various versions.
Looking for "starting with gdal" on http://gdal.org/ogr2ogr.html gives
a hint at that complexity.  "starting with" or "GDAL >" on
http://gdal.org/gdal_translate.html ....  And if there are changes in
formats (or proj4) that interact with these flags... Coherent
presentation would require a huge table or chart and maybe still be
confusing.

$.02, Eli


>> >
>> > Not directly. A solution would be to download the *doc packages on
>> > http://download.osgeo.org/gdal/ and look at the differences
>>
>> Oh dear. And if I bother to do that what might be a good place to share the
>> results? Wiki perhaps? I am writing short tutorials sometimes and it is
>> essential to mension the versions because there are old GDAL versions in
>> the wild and included in other programs.
>
> Well, I admire your energy. Why not being lazy and telling that your tutorial
> applies to GDAL 1.10 or above, and if people are using older versions some
> things might not apply.
>
>>
>> -Jukka-
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at mines-paris.org  Fri Nov  8 11:04:49 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 8 Nov 2013 20:04:49 +0100
Subject: [gdal-dev] Fwd:  Changed API for exportToGEOS
In-Reply-To: <CAHNf2YSQwrVZ4D40uTrP=cO7QdfsaRZRQvKnW-YiAt=oFQmhaw@mail.gmail.com>
References: <CAHNf2YQfp-5M3m72Dyaw0s=zVg8FC2dQ3-xsTy=GTJqRUEUYpw@mail.gmail.com>
	<CAHNf2YTS=e2z4mk_9rtH9X76cZYmmjhgCKB4XaxXQPrPKtuBOA@mail.gmail.com>
	<CAHNf2YSQwrVZ4D40uTrP=cO7QdfsaRZRQvKnW-YiAt=oFQmhaw@mail.gmail.com>
Message-ID: <201311082004.49142.even.rouault@mines-paris.org>

Le vendredi 08 novembre 2013 14:52:17, Paul Meems a ?crit :
> Hi all,
> 
> Sorry to bother you all again.
> We're still struggling with upgrading to GDAL and GEOS.
> When I use GDALv1.9 with GEOSv3.3.5 with our C++ application (MapWinGIS), I
> have no problems.
> The GEOS methods are still working. I've made a test to buffer a geometry.
> 
> When I upgrade to GDAL trunk (v1.11) and GEOSv3.4.2 I can't compile my
> project because of API changes.
> As mentioned before the function createFromGEOS() has now a different
> signature.
> 
> First of all why was this method changed instead of creating a new one?

Because we don't offer stability of the C++ API between major versions, that it 
wasn't thought as being used outside of GDAL code, and, due to the GEOS API, 
there's no way of implementing both methods in an elegant way (you would need 
to have the same code copied & pasted, a version with non reentrant GEOS 
symbols, and the one one with the _r symbols)

> There is a buffer and a buffer_r method.
> If the new method would have been called createFromGEOS_r() we would not
> have so much trouble.
> 
> Secondly I added GEOSContextHandle_t hGEOSCtxt =
> OGRGeometry::createGEOSContext(); before calling the changed
> createFromGEOS().
> I can compile now but GEOSBuffer() is always returning NULL.

The issue must be that you provide here a different GEOS context (the one 
you've created) than the one that was attached to your GEOS geometry when it 
was created (the global thread unsfafe GEOS context). I'm not surprised that 
GEOS doesn't appreciate that a lot.

One idea to avoid migrating your application to the _r calls would have been 
to use the global GEOS context, but unfortunatelly I've just skimmed through 
GEOS code and that context remains hidden, so I think you have no other choice 
than migrating to the _r API if you still want to use the C++ methods of GDAL 
that expose the GEOS side of things.

> 
> If the original situation cannot be restored be keeping createFromGEOS and
> creating createFromGEOS_r I need to know how I should change the rest of my
> code to make the GEOS functions work again.

If you badly need the old createFromGEOS, just incorporate its code into your 
application. Its implementation uses public GEOS API + 
OGRGeometryFactory::createFromWkb()

See 
http://trac.osgeo.org/gdal/browser/branches/1.10/gdal/ogr/ogrgeometryfactory.cpp#L1486

I wouldn't like OGR code to keep such a left-over of the past with its thread-
safety issues.

> I can try to use buffer_r and
> use the context created before. But that means I need to change a lot of
> code. Before I do that I need to know if that is solving my issue.

General methodological advice : experiment on a small test program to validate 
your ideas before changing everything blindly.

> 
> Our BufferByDistance function is now not working and probably needs to be
> changed. The source code is here:
> https://mapwingis.svn.codeplex.com/svn/MapWinGIS/trunk/COM%20classes/Shapef
> ile_Geoprocessing.cpp Our Shape2GEOSGeom() function is now calling
> createGEOSContext() and Shape2GEOSGeom is called by our BufferByDistance
> function. The code is here:
> https://mapwingis.svn.codeplex.com/svn/MapWinGIS/trunk/Processing/Geometry
> Converter.cpp
> 
> I think I need to create the context in our BufferByDistance function and
> pass it as an argument to our Shape2GEOSGeom() function. Next I should
> switch to GEOSBuffer_r and use the same context. Am I right? Is that the
> correct approach? If so I need to change the signature of our
> Shape2GEOSGeom() function which is use in a lot places. That is OK, as long
> as I know it is the solution.

The root of the issue must be with the constant switch between the global GEOS 
context and the temporary GEOS context you use for OGRGeometry::exportToGEOS() 
and OGRGeometryFactory::createFromGEOS_r().

So if you create a GEOS context with OGRGeometry::createGEOSContext(), use it 
during the whole life time of objects that will be instanciated with it and 
destroys it afterwards it should work. Basically it could have the lifetime of 
your application.

Slighlty out-of-topic : I've skimmed very quickly through your code, and I'm 
wondering why you do so many conversions : OGRGeometry -> GEOSGeometry -> 
GEOSBuffer -> GEOSGeometry -> OGRGeometry. You could just use the 
OGRGeometry::Buffer() operation instead of going through GEOS by yourself. 
OGRGeometry::Buffer() does that for you.


Hum, actually, after having written this email, I now believe that your issue 
might be more simple than that. Do you call initGEOS() at all in your 
application code ? If you don't, then the global GEOS context will not be 
initialized at all, and when reviewing GEOS code, I can see that all non _r 
methods will fail silently. You could confirm with a debug build of GEOS and 
stepping into methods. Mixing of global vs local GEOS context might perhaps 
cause issues, but more likely in more advanced situations than just 
GEOSBuffer(). So calling initGEOS() in your code might be a (not recommanded) 
trick to quick fix your immediate issues, but it could perhaps lead to subtle 
problems.

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Fri Nov  8 11:24:51 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 8 Nov 2013 20:24:51 +0100
Subject: [gdal-dev] libpng and autotest
In-Reply-To: <20131108175045.GA31245@bromo.med.uc.edu>
References: <20131107213407.GA24403@bromo.med.uc.edu>
	<0A5CBBD2-FC9F-4DBA-8E36-A3E6022C1C92@gmail.com>
	<20131108175045.GA31245@bromo.med.uc.edu>
Message-ID: <201311082024.51416.even.rouault@mines-paris.org>

Le vendredi 08 novembre 2013 18:50:45, Jack Howarth a ?crit :
> On Fri, Nov 08, 2013 at 09:12:05AM -0800, Kurt Schwehr wrote:
> > Jack,
> > 
> > Is there an explanation someplace with more detail as to what is wrong
> > those png's, why older versions of libpng are okay with it and why
> > libpng has changed its behavior?
> > 
> > Thanks,
> > -kurt
> 
> Kurt,
>    The following link...
> 
> http://comments.gmane.org/gmane.comp.graphics.png.devel/6017
> 
> appears to discuss the issue we are seeing with the test.png file...
> 
> >  Libpng-1.6.0 through 1.6.2 use the CMF bytes at the beginning of an zlib
> >  datastream to set the window size for decoding. Libpng-1.5.x and
> >  earlier ignored the CMF bytes and always used a 32kbyte window. 
> >  Libpng-1.6.x has uncovered the fact that there are hundreds of files in
> >  the wild (found in linux distributions such as gentoo) with a too-small
> >  CMF, which results in a "Too far back" error when decoding these PNGs. 
> >  I have not yet been able to discover what application is producing
> >  these.
> 
> If you read completely through the gmane.comp.graphics.png.devel/6017
> thread, you should be at least convinced that such corruption is a known
> issue.

This is strange. I can't reproduce any issue on Linux with libpng 1.6.2 or 
libpng 1.6.3 with gdalicon.png or autotest/gdrivers/data/test.png that is used 
by png_1 test. If it matters, the zlib is still my system zlib 1.2.3. 


$ ldd apps/gdalinfo | grep png
	libpng16.so.16 => /home/even/install-libpng-1.6.2/lib/libpng16.so.16 
(0x00007fda95e39000)

$ gdalinfo data/gdalicon.png -checksum
Driver: PNG/Portable Network Graphics
Files: data/gdalicon.png
Size is 32, 32
Coordinate System is `'
Image Structure Metadata:
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0,   32.0)
Upper Right (   32.0,    0.0)
Lower Right (   32.0,   32.0)
Center      (   16.0,   16.0)
Band 1 Block=32x1 Type=Byte, ColorInterp=Red
  Checksum=7617
  Mask Flags: PER_DATASET ALPHA 
Band 2 Block=32x1 Type=Byte, ColorInterp=Green
  Checksum=7808
  Mask Flags: PER_DATASET ALPHA 
Band 3 Block=32x1 Type=Byte, ColorInterp=Blue
  Checksum=7377
  Mask Flags: PER_DATASET ALPHA 
Band 4 Block=32x1 Type=Byte, ColorInterp=Alpha
  Checksum=7926

$ gdalinfo ../autotest/gdrivers/data/test.png -checksum
Driver: PNG/Portable Network Graphics
Files: ../autotest/gdrivers/data/test.png
       ../autotest/gdrivers/data/test.wld
Size is 400, 400
Coordinate System is `'
GeoTransform =
  700000.3050000001, 0.38, 0.01
  4287500.695, -0.01, -0.38
Corner Coordinates:
Upper Left  (  700000.305, 4287500.695) 
Lower Left  (  700004.305, 4287348.695) 
Upper Right (  700152.305, 4287496.695) 
Lower Right (  700156.305, 4287344.695) 
Center      (  700078.305, 4287422.695) 
Band 1 Block=400x1 Type=Byte, ColorInterp=Palette
  Checksum=57921
  NoData Value=0
  Color Table (RGB with 16 entries)
    0: 255,255,255,0
    1: 255,255,208,255
    2: 255,255,204,255
    3: 153,204,255,255
    4: 0,153,255,255
    5: 102,102,102,255
    6: 153,153,153,255
    7: 150,150,150,255
    8: 0,0,0,255
    9: 100,160,210,255
   10: 255,255,255,255
   11: 226,226,226,255
   12: 51,51,51,255
   13: 0,0,0,255
   14: 0,0,0,255
   15: 0,0,0,255



>           Jack
> 
> > On Nov 8, 2013, at 8:02 AM, Jack Howarth <howarth at bromo.med.uc.edu> wrote:
> > > On Fri, Nov 08, 2013 at 10:31:08AM -0500, Jack Howarth wrote:
> > >> On Thu, Nov 07, 2013 at 04:34:07PM -0500, Jack Howarth wrote:
> > >>> The failures on x86_64-apple-darwin13 for the png.py test suite from
> > >>> auto test for gdal 0.10.1 are the same failures described here...
> > >>> 
> > >>> https://github.com/licq-im/licq/pull/32
> > >>> <https://github.com/licq-im/licq/pull/32>
> > >>> 
> > >>> The failures are completely suppressed by regenerating
> > >>> autotest/gdrivers/data/test.png with
> > >>> "optipng -nb -nc -np test.png"...
> > >> 
> > >> Just to clarify, I used optipng 0.6.3 for this. The newer optipng
> > >> 0.7.4 release seems more problematic as none of the obvious
> > >> combination of options can fix the test.png file without changing the
> > >> checksums and causing additional failures. So you will want to use
> > >> the optipng 0.6.x release series to fix the bad png files in gdal.
> > > 
> > > Also, my tests here using optipng 0.7.4 to detect damaged png files
> > > indicate that only data/gdalicon.png in gdal-0.10.1 needs to be fixed.
> > > 
> > > optipng -nb -nc -np -fix data/gdalicon.png
> > > ** Processing: data/gdalicon.png
> > > Warning:
> > > 32x32 pixels, 4x8 bits/pixel, RGB+alpha
> > > Recoverable errors found in input. Fixing...
> > > Input IDAT size = 1964 bytes
> > > Input file size = 2021 bytes
> > > 
> > > Trying:
> > >  zc = 9  zm = 8  zs = 0  f = 0		IDAT size = 240
> > > 
> > > Selecting parameters:
> > >  zc = 9  zm = 8  zs = 0  f = 0		IDAT size = 240
> > > 
> > > Output IDAT size = 240 bytes (1724 bytes decrease)
> > > Output file size = 313 bytes (1708 bytes = 84.51% decrease)
> > > 
> > > ** Status report
> > > 1 file(s) have been processed.
> > > 1 error(s) have been encountered.
> > > 1 erroneous file(s) have been fixed.
> > > 
> > >>> % ./png.py
> > >>> 
> > >>>  TEST: png_1 ... success
> > >>>  TEST: png_2 ... success
> > >>>  TEST: png_3 ... success
> > >>>  TEST: png_4 ... success
> > >>>  TEST: png_5 ... success
> > >>>  TEST: png_6 ... success
> > >>>  TEST: png_7 ... success
> > >>>  TEST: png_8 ... success
> > >>>  TEST: png_9 ... success
> > >>>  TEST: png_10 ... success
> > >>>  TEST: png_11 ... success
> > >>> 
> > >>> Test Script: png
> > >>> Succeeded: 11
> > >>> Failed:    0 (0 blew exceptions)
> > >>> Skipped:   0
> > >>> Expected fail:0
> > >>> Duration:  0.08s
> > >>> 
> > >>> _______________________________________________
> > >>> gdal-dev mailing list
> > >>> gdal-dev at lists.osgeo.org
> > >>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > >> 
> > >> _______________________________________________
> > >> gdal-dev mailing list
> > >> gdal-dev at lists.osgeo.org
> > >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > > 
> > > _______________________________________________
> > > gdal-dev mailing list
> > > gdal-dev at lists.osgeo.org
> > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From neveu at pcigeomatics.com  Fri Nov  8 12:19:45 2013
From: neveu at pcigeomatics.com (Phelippe Neveu)
Date: Fri, 8 Nov 2013 20:19:45 +0000
Subject: [gdal-dev] (no subject)
Message-ID: <99e997e1bb7f430482b002b7fedcb6fb@BLUPR06MB068.namprd06.prod.outlook.com>

To whom it may concern,

We have updates to the PCIDSK library that we would like to upstream to GDAL.

We have fixed numerous bugs, we have done many optimizations, and we also implemented a new binary tile directory.

How should we proceed with the upstream?

Thanks,

Phelippe
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131108/aa14c573/attachment.html>

From howarth at bromo.med.uc.edu  Fri Nov  8 12:31:05 2013
From: howarth at bromo.med.uc.edu (Jack Howarth)
Date: Fri, 8 Nov 2013 15:31:05 -0500
Subject: [gdal-dev] libpng and autotest
In-Reply-To: <201311082024.51416.even.rouault@mines-paris.org>
References: <20131107213407.GA24403@bromo.med.uc.edu>
	<0A5CBBD2-FC9F-4DBA-8E36-A3E6022C1C92@gmail.com>
	<20131108175045.GA31245@bromo.med.uc.edu>
	<201311082024.51416.even.rouault@mines-paris.org>
Message-ID: <20131108203105.GA32123@bromo.med.uc.edu>

On Fri, Nov 08, 2013 at 08:24:51PM +0100, Even Rouault wrote:
> Le vendredi 08 novembre 2013 18:50:45, Jack Howarth a ?crit :
> > On Fri, Nov 08, 2013 at 09:12:05AM -0800, Kurt Schwehr wrote:
> > > Jack,
> > > 
> > > Is there an explanation someplace with more detail as to what is wrong
> > > those png's, why older versions of libpng are okay with it and why
> > > libpng has changed its behavior?
> > > 
> > > Thanks,
> > > -kurt
> > 
> > Kurt,
> >    The following link...
> > 
> > http://comments.gmane.org/gmane.comp.graphics.png.devel/6017
> > 
> > appears to discuss the issue we are seeing with the test.png file...
> > 
> > >  Libpng-1.6.0 through 1.6.2 use the CMF bytes at the beginning of an zlib
> > >  datastream to set the window size for decoding. Libpng-1.5.x and
> > >  earlier ignored the CMF bytes and always used a 32kbyte window. 
> > >  Libpng-1.6.x has uncovered the fact that there are hundreds of files in
> > >  the wild (found in linux distributions such as gentoo) with a too-small
> > >  CMF, which results in a "Too far back" error when decoding these PNGs. 
> > >  I have not yet been able to discover what application is producing
> > >  these.
> > 
> > If you read completely through the gmane.comp.graphics.png.devel/6017
> > thread, you should be at least convinced that such corruption is a known
> > issue.
> 
> This is strange. I can't reproduce any issue on Linux with libpng 1.6.2 or 
> libpng 1.6.3 with gdalicon.png or autotest/gdrivers/data/test.png that is used 
> by png_1 test. If it matters, the zlib is still my system zlib 1.2.3. 

Another thread discussing the same issue is at...

http://lilypond.1069038.n5.nabble.com/fixing-PNG-images-td146225.html

as well as here...

http://www.opendevs.org/qkup/libpng16-will-not-read-some-broken-png-images.pdf

I can see the problem with the pngfix from libpng 1.6.6 as follows...

# pngfix data/test.png
IDAT TFB default 10 15 8575 160400 data/test.png

whereas when I repair the file with optipng, I see...

% optipng -nb -nc -np -fix test.png
OptiPNG 0.6.3: Advanced PNG optimizer.
Copyright (C) 2001-2009 Cosmin Truta.

** Processing: test.png
400x400 pixels, 8 bits/pixel, 16 colors (16 transparent) in palette
Input IDAT size = 8575 bytes
Input file size = 8732 bytes

Trying:
  zc = 9  zm = 8  zs = 0  f = 0		IDAT size = 7349
                               
Selecting parameters:
  zc = 9  zm = 8  zs = 0  f = 0		IDAT size = 7349

Output IDAT size = 7349 bytes (1226 bytes decrease)
Output file size = 7494 bytes (1238 bytes = 14.18% decrease)

# pngfix data/test.png
IDAT OK  maximum 15 15 7349 160400 data/test.png

which is explained in the usage output from pngfix with no arguments as...

  The summary lines describe issues encountered with the zlib compressed
  stream of a chunk.  They have the following format, which is SUBJECT TO
  CHANGE in the future:

     chunk reason comp-level p1 p2 p3 p4 file

  p1 through p4 vary according to the 'reason'.  There are always 8 space
  separated fields.  Reasons specific formats are:

     chunk ERR status code read-errno write-errno message file
     chunk SKP comp-level file-bits zlib-rc compressed message file
     chunk ??? comp-level file-bits ok-bits compressed uncompress file

  The various fields are

$1 chunk:      The chunk type of a chunk in the file or 'HEAD' if a problem
               is reported by libpng at the start of the IDAT stream.
$2 reason:     One of:
          CHK: A zlib header checksum was detected and fixed.
          TFB: The zlib too far back error was detected and fixed.
          OK : No errors were detected in the zlib stream and optimization
               was not requested, or was not possible.
          OPT: The zlib stream window bits value could be improved (and was).
          SKP: The chunk was skipped because of a zlib issue (zlib-rc) with
               explanation 'message'
          ERR: The read of the file was aborted.  The parameters explain why.
$3 status:     For 'ERR' the accumulate status code from 'EXIT CODES' above.
               This is printed as a 2 digit hexadecimal value
   comp-level: The recorded compression level (FLEVEL) of a zlib stream
               expressed as a string {supfast,stdfast,default,maximum}
$4 code:       The file exit code; where stop was called, as a fairly terse
               string {warning,libpng,zlib,invalid,read,write,unexpected}.
   file-bits:  The zlib window bits recorded in the file.
$5 read-errno: A system errno value from a read translated by strerror(3).
   zlib-rc:    A zlib return code as a string (see zlib.h).
   ok-bits:    The smallest zlib window bits value that works.
$6 write-errno:A system errno value from a write translated by strerror(3).
   compressed: The count of compressed bytes in the zlib stream, when the
               reason is 'SKP'; this is a count of the bytes read from the
               stream when the fatal error was encountered.
$7 message:    An error message (spaces replaced by _, as in all parameters),
   uncompress: The count of bytes from uncompressing the zlib stream; this
               may not be the same as the number of bytes in the image.
$8 file:       The name of the file (this may contain spaces).

Note that the current test.png that you are shipping is reported as TFB 
for "The zlib too far back error was detected and fixed" by pngfix whereas
the copy repaired by optipng reports OK for "No errors were detected in the zlib 
stream and optimization was not requested, or was not possible.". So far
I haven't been able to puzzle out how to get pngfix to repair the file but
I notice most are using optipng for that.
                     Jack 

> 
> 
> $ ldd apps/gdalinfo | grep png
> 	libpng16.so.16 => /home/even/install-libpng-1.6.2/lib/libpng16.so.16 
> (0x00007fda95e39000)
> 
> $ gdalinfo data/gdalicon.png -checksum
> Driver: PNG/Portable Network Graphics
> Files: data/gdalicon.png
> Size is 32, 32
> Coordinate System is `'
> Image Structure Metadata:
>   INTERLEAVE=PIXEL
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0,   32.0)
> Upper Right (   32.0,    0.0)
> Lower Right (   32.0,   32.0)
> Center      (   16.0,   16.0)
> Band 1 Block=32x1 Type=Byte, ColorInterp=Red
>   Checksum=7617
>   Mask Flags: PER_DATASET ALPHA 
> Band 2 Block=32x1 Type=Byte, ColorInterp=Green
>   Checksum=7808
>   Mask Flags: PER_DATASET ALPHA 
> Band 3 Block=32x1 Type=Byte, ColorInterp=Blue
>   Checksum=7377
>   Mask Flags: PER_DATASET ALPHA 
> Band 4 Block=32x1 Type=Byte, ColorInterp=Alpha
>   Checksum=7926
> 
> $ gdalinfo ../autotest/gdrivers/data/test.png -checksum
> Driver: PNG/Portable Network Graphics
> Files: ../autotest/gdrivers/data/test.png
>        ../autotest/gdrivers/data/test.wld
> Size is 400, 400
> Coordinate System is `'
> GeoTransform =
>   700000.3050000001, 0.38, 0.01
>   4287500.695, -0.01, -0.38
> Corner Coordinates:
> Upper Left  (  700000.305, 4287500.695) 
> Lower Left  (  700004.305, 4287348.695) 
> Upper Right (  700152.305, 4287496.695) 
> Lower Right (  700156.305, 4287344.695) 
> Center      (  700078.305, 4287422.695) 
> Band 1 Block=400x1 Type=Byte, ColorInterp=Palette
>   Checksum=57921
>   NoData Value=0
>   Color Table (RGB with 16 entries)
>     0: 255,255,255,0
>     1: 255,255,208,255
>     2: 255,255,204,255
>     3: 153,204,255,255
>     4: 0,153,255,255
>     5: 102,102,102,255
>     6: 153,153,153,255
>     7: 150,150,150,255
>     8: 0,0,0,255
>     9: 100,160,210,255
>    10: 255,255,255,255
>    11: 226,226,226,255
>    12: 51,51,51,255
>    13: 0,0,0,255
>    14: 0,0,0,255
>    15: 0,0,0,255
> 
> 
> 
> >           Jack
> > 
> > > On Nov 8, 2013, at 8:02 AM, Jack Howarth <howarth at bromo.med.uc.edu> wrote:
> > > > On Fri, Nov 08, 2013 at 10:31:08AM -0500, Jack Howarth wrote:
> > > >> On Thu, Nov 07, 2013 at 04:34:07PM -0500, Jack Howarth wrote:
> > > >>> The failures on x86_64-apple-darwin13 for the png.py test suite from
> > > >>> auto test for gdal 0.10.1 are the same failures described here...
> > > >>> 
> > > >>> https://github.com/licq-im/licq/pull/32
> > > >>> <https://github.com/licq-im/licq/pull/32>
> > > >>> 
> > > >>> The failures are completely suppressed by regenerating
> > > >>> autotest/gdrivers/data/test.png with
> > > >>> "optipng -nb -nc -np test.png"...
> > > >> 
> > > >> Just to clarify, I used optipng 0.6.3 for this. The newer optipng
> > > >> 0.7.4 release seems more problematic as none of the obvious
> > > >> combination of options can fix the test.png file without changing the
> > > >> checksums and causing additional failures. So you will want to use
> > > >> the optipng 0.6.x release series to fix the bad png files in gdal.
> > > > 
> > > > Also, my tests here using optipng 0.7.4 to detect damaged png files
> > > > indicate that only data/gdalicon.png in gdal-0.10.1 needs to be fixed.
> > > > 
> > > > optipng -nb -nc -np -fix data/gdalicon.png
> > > > ** Processing: data/gdalicon.png
> > > > Warning:
> > > > 32x32 pixels, 4x8 bits/pixel, RGB+alpha
> > > > Recoverable errors found in input. Fixing...
> > > > Input IDAT size = 1964 bytes
> > > > Input file size = 2021 bytes
> > > > 
> > > > Trying:
> > > >  zc = 9  zm = 8  zs = 0  f = 0		IDAT size = 240
> > > > 
> > > > Selecting parameters:
> > > >  zc = 9  zm = 8  zs = 0  f = 0		IDAT size = 240
> > > > 
> > > > Output IDAT size = 240 bytes (1724 bytes decrease)
> > > > Output file size = 313 bytes (1708 bytes = 84.51% decrease)
> > > > 
> > > > ** Status report
> > > > 1 file(s) have been processed.
> > > > 1 error(s) have been encountered.
> > > > 1 erroneous file(s) have been fixed.
> > > > 
> > > >>> % ./png.py
> > > >>> 
> > > >>>  TEST: png_1 ... success
> > > >>>  TEST: png_2 ... success
> > > >>>  TEST: png_3 ... success
> > > >>>  TEST: png_4 ... success
> > > >>>  TEST: png_5 ... success
> > > >>>  TEST: png_6 ... success
> > > >>>  TEST: png_7 ... success
> > > >>>  TEST: png_8 ... success
> > > >>>  TEST: png_9 ... success
> > > >>>  TEST: png_10 ... success
> > > >>>  TEST: png_11 ... success
> > > >>> 
> > > >>> Test Script: png
> > > >>> Succeeded: 11
> > > >>> Failed:    0 (0 blew exceptions)
> > > >>> Skipped:   0
> > > >>> Expected fail:0
> > > >>> Duration:  0.08s
> > > >>> 
> > > >>> _______________________________________________
> > > >>> gdal-dev mailing list
> > > >>> gdal-dev at lists.osgeo.org
> > > >>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > > >> 
> > > >> _______________________________________________
> > > >> gdal-dev mailing list
> > > >> gdal-dev at lists.osgeo.org
> > > >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > > > 
> > > > _______________________________________________
> > > > gdal-dev mailing list
> > > > gdal-dev at lists.osgeo.org
> > > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > 
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> -- 
> Geospatial professional services
> http://even.rouault.free.fr/services.html

From howarth at bromo.med.uc.edu  Fri Nov  8 12:46:12 2013
From: howarth at bromo.med.uc.edu (Jack Howarth)
Date: Fri, 8 Nov 2013 15:46:12 -0500
Subject: [gdal-dev] libpng and autotest
In-Reply-To: <20131108203105.GA32123@bromo.med.uc.edu>
References: <20131107213407.GA24403@bromo.med.uc.edu>
	<0A5CBBD2-FC9F-4DBA-8E36-A3E6022C1C92@gmail.com>
	<20131108175045.GA31245@bromo.med.uc.edu>
	<201311082024.51416.even.rouault@mines-paris.org>
	<20131108203105.GA32123@bromo.med.uc.edu>
Message-ID: <20131108204612.GB32123@bromo.med.uc.edu>

On Fri, Nov 08, 2013 at 03:31:05PM -0500, Jack Howarth wrote:
> On Fri, Nov 08, 2013 at 08:24:51PM +0100, Even Rouault wrote:
> > Le vendredi 08 novembre 2013 18:50:45, Jack Howarth a ?crit :
> > > On Fri, Nov 08, 2013 at 09:12:05AM -0800, Kurt Schwehr wrote:
> > > > Jack,
> > > > 
> > > > Is there an explanation someplace with more detail as to what is wrong
> > > > those png's, why older versions of libpng are okay with it and why
> > > > libpng has changed its behavior?
> > > > 
> > > > Thanks,
> > > > -kurt
> > > 
> > > Kurt,
> > >    The following link...
> > > 
> > > http://comments.gmane.org/gmane.comp.graphics.png.devel/6017
> > > 
> > > appears to discuss the issue we are seeing with the test.png file...
> > > 
> > > >  Libpng-1.6.0 through 1.6.2 use the CMF bytes at the beginning of an zlib
> > > >  datastream to set the window size for decoding. Libpng-1.5.x and
> > > >  earlier ignored the CMF bytes and always used a 32kbyte window. 
> > > >  Libpng-1.6.x has uncovered the fact that there are hundreds of files in
> > > >  the wild (found in linux distributions such as gentoo) with a too-small
> > > >  CMF, which results in a "Too far back" error when decoding these PNGs. 
> > > >  I have not yet been able to discover what application is producing
> > > >  these.
> > > 
> > > If you read completely through the gmane.comp.graphics.png.devel/6017
> > > thread, you should be at least convinced that such corruption is a known
> > > issue.
> > 
> > This is strange. I can't reproduce any issue on Linux with libpng 1.6.2 or 
> > libpng 1.6.3 with gdalicon.png or autotest/gdrivers/data/test.png that is used 
> > by png_1 test. If it matters, the zlib is still my system zlib 1.2.3. 
> 
> Another thread discussing the same issue is at...
> 
> http://lilypond.1069038.n5.nabble.com/fixing-PNG-images-td146225.html
> 
> as well as here...
> 
> http://www.opendevs.org/qkup/libpng16-will-not-read-some-broken-png-images.pdf
> 
> I can see the problem with the pngfix from libpng 1.6.6 as follows...
> 
> # pngfix data/test.png
> IDAT TFB default 10 15 8575 160400 data/test.png
> 
> whereas when I repair the file with optipng, I see...
> 
> % optipng -nb -nc -np -fix test.png
> OptiPNG 0.6.3: Advanced PNG optimizer.
> Copyright (C) 2001-2009 Cosmin Truta.
> 
> ** Processing: test.png
> 400x400 pixels, 8 bits/pixel, 16 colors (16 transparent) in palette
> Input IDAT size = 8575 bytes
> Input file size = 8732 bytes
> 
> Trying:
>   zc = 9  zm = 8  zs = 0  f = 0		IDAT size = 7349
>                                
> Selecting parameters:
>   zc = 9  zm = 8  zs = 0  f = 0		IDAT size = 7349
> 
> Output IDAT size = 7349 bytes (1226 bytes decrease)
> Output file size = 7494 bytes (1238 bytes = 14.18% decrease)
> 
> # pngfix data/test.png
> IDAT OK  maximum 15 15 7349 160400 data/test.png
> 
> which is explained in the usage output from pngfix with no arguments as...
> 
>   The summary lines describe issues encountered with the zlib compressed
>   stream of a chunk.  They have the following format, which is SUBJECT TO
>   CHANGE in the future:
> 
>      chunk reason comp-level p1 p2 p3 p4 file
> 
>   p1 through p4 vary according to the 'reason'.  There are always 8 space
>   separated fields.  Reasons specific formats are:
> 
>      chunk ERR status code read-errno write-errno message file
>      chunk SKP comp-level file-bits zlib-rc compressed message file
>      chunk ??? comp-level file-bits ok-bits compressed uncompress file
> 
>   The various fields are
> 
> $1 chunk:      The chunk type of a chunk in the file or 'HEAD' if a problem
>                is reported by libpng at the start of the IDAT stream.
> $2 reason:     One of:
>           CHK: A zlib header checksum was detected and fixed.
>           TFB: The zlib too far back error was detected and fixed.
>           OK : No errors were detected in the zlib stream and optimization
>                was not requested, or was not possible.
>           OPT: The zlib stream window bits value could be improved (and was).
>           SKP: The chunk was skipped because of a zlib issue (zlib-rc) with
>                explanation 'message'
>           ERR: The read of the file was aborted.  The parameters explain why.
> $3 status:     For 'ERR' the accumulate status code from 'EXIT CODES' above.
>                This is printed as a 2 digit hexadecimal value
>    comp-level: The recorded compression level (FLEVEL) of a zlib stream
>                expressed as a string {supfast,stdfast,default,maximum}
> $4 code:       The file exit code; where stop was called, as a fairly terse
>                string {warning,libpng,zlib,invalid,read,write,unexpected}.
>    file-bits:  The zlib window bits recorded in the file.
> $5 read-errno: A system errno value from a read translated by strerror(3).
>    zlib-rc:    A zlib return code as a string (see zlib.h).
>    ok-bits:    The smallest zlib window bits value that works.
> $6 write-errno:A system errno value from a write translated by strerror(3).
>    compressed: The count of compressed bytes in the zlib stream, when the
>                reason is 'SKP'; this is a count of the bytes read from the
>                stream when the fatal error was encountered.
> $7 message:    An error message (spaces replaced by _, as in all parameters),
>    uncompress: The count of bytes from uncompressing the zlib stream; this
>                may not be the same as the number of bytes in the image.
> $8 file:       The name of the file (this may contain spaces).
> 
> Note that the current test.png that you are shipping is reported as TFB 
> for "The zlib too far back error was detected and fixed" by pngfix whereas
> the copy repaired by optipng reports OK for "No errors were detected in the zlib 
> stream and optimization was not requested, or was not possible.". So far
> I haven't been able to puzzle out how to get pngfix to repair the file but
> I notice most are using optipng for that.
>                      Jack 
> 

One last note. I reinstalled the older libpng16-1.6.3-1 packaging on fink and
it reports the same exact error for the bundled test.png file as the 1.6.6
release does...

% /sw/bin/pngfix test.png
IDAT TFB default 10 15 8575 160400 test.png.sav

So you should be able to find this problem with libpng 1.6.3 or later. Note
that the detection of this issue was added during the libpng 1.6.3 development
cycle so you need to be sure use its pngfix utility and not that from 1.6.2.

----------------------------------------------------------------------------
Changes since the last public release (1.6.2):
...

Added png-fix-itxt and png-fix-too-far-back to the built programs and
 removed warnings from the source code and timepng that are revealed as
 a result.
Detect wrong libpng versions linked to png-fix-too-far-back, which currently
only works with libpng versions that can be made to reliably fail when
the deflate data contains an out-of-window reference.  This means only
1.6 and later.
...
Attempt to detect configuration issues with png-fix-too-far-back, which
  requires both the correct libpng and the correct zlib to function
  correctly.
---------------------------------------------------------------------------

Note on darwin we typically use the system libz which appears to be
derivation of 1.2.5.

> > 
> > 
> > $ ldd apps/gdalinfo | grep png
> > 	libpng16.so.16 => /home/even/install-libpng-1.6.2/lib/libpng16.so.16 
> > (0x00007fda95e39000)
> > 
> > $ gdalinfo data/gdalicon.png -checksum
> > Driver: PNG/Portable Network Graphics
> > Files: data/gdalicon.png
> > Size is 32, 32
> > Coordinate System is `'
> > Image Structure Metadata:
> >   INTERLEAVE=PIXEL
> > Corner Coordinates:
> > Upper Left  (    0.0,    0.0)
> > Lower Left  (    0.0,   32.0)
> > Upper Right (   32.0,    0.0)
> > Lower Right (   32.0,   32.0)
> > Center      (   16.0,   16.0)
> > Band 1 Block=32x1 Type=Byte, ColorInterp=Red
> >   Checksum=7617
> >   Mask Flags: PER_DATASET ALPHA 
> > Band 2 Block=32x1 Type=Byte, ColorInterp=Green
> >   Checksum=7808
> >   Mask Flags: PER_DATASET ALPHA 
> > Band 3 Block=32x1 Type=Byte, ColorInterp=Blue
> >   Checksum=7377
> >   Mask Flags: PER_DATASET ALPHA 
> > Band 4 Block=32x1 Type=Byte, ColorInterp=Alpha
> >   Checksum=7926
> > 
> > $ gdalinfo ../autotest/gdrivers/data/test.png -checksum
> > Driver: PNG/Portable Network Graphics
> > Files: ../autotest/gdrivers/data/test.png
> >        ../autotest/gdrivers/data/test.wld
> > Size is 400, 400
> > Coordinate System is `'
> > GeoTransform =
> >   700000.3050000001, 0.38, 0.01
> >   4287500.695, -0.01, -0.38
> > Corner Coordinates:
> > Upper Left  (  700000.305, 4287500.695) 
> > Lower Left  (  700004.305, 4287348.695) 
> > Upper Right (  700152.305, 4287496.695) 
> > Lower Right (  700156.305, 4287344.695) 
> > Center      (  700078.305, 4287422.695) 
> > Band 1 Block=400x1 Type=Byte, ColorInterp=Palette
> >   Checksum=57921
> >   NoData Value=0
> >   Color Table (RGB with 16 entries)
> >     0: 255,255,255,0
> >     1: 255,255,208,255
> >     2: 255,255,204,255
> >     3: 153,204,255,255
> >     4: 0,153,255,255
> >     5: 102,102,102,255
> >     6: 153,153,153,255
> >     7: 150,150,150,255
> >     8: 0,0,0,255
> >     9: 100,160,210,255
> >    10: 255,255,255,255
> >    11: 226,226,226,255
> >    12: 51,51,51,255
> >    13: 0,0,0,255
> >    14: 0,0,0,255
> >    15: 0,0,0,255
> > 
> > 
> > 
> > >           Jack
> > > 
> > > > On Nov 8, 2013, at 8:02 AM, Jack Howarth <howarth at bromo.med.uc.edu> wrote:
> > > > > On Fri, Nov 08, 2013 at 10:31:08AM -0500, Jack Howarth wrote:
> > > > >> On Thu, Nov 07, 2013 at 04:34:07PM -0500, Jack Howarth wrote:
> > > > >>> The failures on x86_64-apple-darwin13 for the png.py test suite from
> > > > >>> auto test for gdal 0.10.1 are the same failures described here...
> > > > >>> 
> > > > >>> https://github.com/licq-im/licq/pull/32
> > > > >>> <https://github.com/licq-im/licq/pull/32>
> > > > >>> 
> > > > >>> The failures are completely suppressed by regenerating
> > > > >>> autotest/gdrivers/data/test.png with
> > > > >>> "optipng -nb -nc -np test.png"...
> > > > >> 
> > > > >> Just to clarify, I used optipng 0.6.3 for this. The newer optipng
> > > > >> 0.7.4 release seems more problematic as none of the obvious
> > > > >> combination of options can fix the test.png file without changing the
> > > > >> checksums and causing additional failures. So you will want to use
> > > > >> the optipng 0.6.x release series to fix the bad png files in gdal.
> > > > > 
> > > > > Also, my tests here using optipng 0.7.4 to detect damaged png files
> > > > > indicate that only data/gdalicon.png in gdal-0.10.1 needs to be fixed.
> > > > > 
> > > > > optipng -nb -nc -np -fix data/gdalicon.png
> > > > > ** Processing: data/gdalicon.png
> > > > > Warning:
> > > > > 32x32 pixels, 4x8 bits/pixel, RGB+alpha
> > > > > Recoverable errors found in input. Fixing...
> > > > > Input IDAT size = 1964 bytes
> > > > > Input file size = 2021 bytes
> > > > > 
> > > > > Trying:
> > > > >  zc = 9  zm = 8  zs = 0  f = 0		IDAT size = 240
> > > > > 
> > > > > Selecting parameters:
> > > > >  zc = 9  zm = 8  zs = 0  f = 0		IDAT size = 240
> > > > > 
> > > > > Output IDAT size = 240 bytes (1724 bytes decrease)
> > > > > Output file size = 313 bytes (1708 bytes = 84.51% decrease)
> > > > > 
> > > > > ** Status report
> > > > > 1 file(s) have been processed.
> > > > > 1 error(s) have been encountered.
> > > > > 1 erroneous file(s) have been fixed.
> > > > > 
> > > > >>> % ./png.py
> > > > >>> 
> > > > >>>  TEST: png_1 ... success
> > > > >>>  TEST: png_2 ... success
> > > > >>>  TEST: png_3 ... success
> > > > >>>  TEST: png_4 ... success
> > > > >>>  TEST: png_5 ... success
> > > > >>>  TEST: png_6 ... success
> > > > >>>  TEST: png_7 ... success
> > > > >>>  TEST: png_8 ... success
> > > > >>>  TEST: png_9 ... success
> > > > >>>  TEST: png_10 ... success
> > > > >>>  TEST: png_11 ... success
> > > > >>> 
> > > > >>> Test Script: png
> > > > >>> Succeeded: 11
> > > > >>> Failed:    0 (0 blew exceptions)
> > > > >>> Skipped:   0
> > > > >>> Expected fail:0
> > > > >>> Duration:  0.08s
> > > > >>> 
> > > > >>> _______________________________________________
> > > > >>> gdal-dev mailing list
> > > > >>> gdal-dev at lists.osgeo.org
> > > > >>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > > > >> 
> > > > >> _______________________________________________
> > > > >> gdal-dev mailing list
> > > > >> gdal-dev at lists.osgeo.org
> > > > >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > > > > 
> > > > > _______________________________________________
> > > > > gdal-dev mailing list
> > > > > gdal-dev at lists.osgeo.org
> > > > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > > 
> > > _______________________________________________
> > > gdal-dev mailing list
> > > gdal-dev at lists.osgeo.org
> > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > 
> > -- 
> > Geospatial professional services
> > http://even.rouault.free.fr/services.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From howarth at bromo.med.uc.edu  Fri Nov  8 13:01:37 2013
From: howarth at bromo.med.uc.edu (Jack Howarth)
Date: Fri, 8 Nov 2013 16:01:37 -0500
Subject: [gdal-dev] libpng and autotest
In-Reply-To: <20131108204612.GB32123@bromo.med.uc.edu>
References: <20131107213407.GA24403@bromo.med.uc.edu>
	<0A5CBBD2-FC9F-4DBA-8E36-A3E6022C1C92@gmail.com>
	<20131108175045.GA31245@bromo.med.uc.edu>
	<201311082024.51416.even.rouault@mines-paris.org>
	<20131108203105.GA32123@bromo.med.uc.edu>
	<20131108204612.GB32123@bromo.med.uc.edu>
Message-ID: <20131108210137.GC32123@bromo.med.uc.edu>

On Fri, Nov 08, 2013 at 03:46:12PM -0500, Jack Howarth wrote:
> On Fri, Nov 08, 2013 at 03:31:05PM -0500, Jack Howarth wrote:
> > On Fri, Nov 08, 2013 at 08:24:51PM +0100, Even Rouault wrote:
> > > Le vendredi 08 novembre 2013 18:50:45, Jack Howarth a ?crit :
> > > > On Fri, Nov 08, 2013 at 09:12:05AM -0800, Kurt Schwehr wrote:
> > > > > Jack,
> > > > > 
> > > > > Is there an explanation someplace with more detail as to what is wrong
> > > > > those png's, why older versions of libpng are okay with it and why
> > > > > libpng has changed its behavior?
> > > > > 
> > > > > Thanks,
> > > > > -kurt
> > > > 
> > > > Kurt,
> > > >    The following link...
> > > > 
> > > > http://comments.gmane.org/gmane.comp.graphics.png.devel/6017
> > > > 
> > > > appears to discuss the issue we are seeing with the test.png file...
> > > > 
> > > > >  Libpng-1.6.0 through 1.6.2 use the CMF bytes at the beginning of an zlib
> > > > >  datastream to set the window size for decoding. Libpng-1.5.x and
> > > > >  earlier ignored the CMF bytes and always used a 32kbyte window. 
> > > > >  Libpng-1.6.x has uncovered the fact that there are hundreds of files in
> > > > >  the wild (found in linux distributions such as gentoo) with a too-small
> > > > >  CMF, which results in a "Too far back" error when decoding these PNGs. 
> > > > >  I have not yet been able to discover what application is producing
> > > > >  these.
> > > > 
> > > > If you read completely through the gmane.comp.graphics.png.devel/6017
> > > > thread, you should be at least convinced that such corruption is a known
> > > > issue.
> > > 
> > > This is strange. I can't reproduce any issue on Linux with libpng 1.6.2 or 
> > > libpng 1.6.3 with gdalicon.png or autotest/gdrivers/data/test.png that is used 
> > > by png_1 test. If it matters, the zlib is still my system zlib 1.2.3. 
> > 
> > Another thread discussing the same issue is at...
> > 
> > http://lilypond.1069038.n5.nabble.com/fixing-PNG-images-td146225.html
> > 
> > as well as here...
> > 
> > http://www.opendevs.org/qkup/libpng16-will-not-read-some-broken-png-images.pdf
> > 
> > I can see the problem with the pngfix from libpng 1.6.6 as follows...
> > 
> > # pngfix data/test.png
> > IDAT TFB default 10 15 8575 160400 data/test.png
> > 
> > whereas when I repair the file with optipng, I see...
> > 
> > % optipng -nb -nc -np -fix test.png
> > OptiPNG 0.6.3: Advanced PNG optimizer.
> > Copyright (C) 2001-2009 Cosmin Truta.
> > 
> > ** Processing: test.png
> > 400x400 pixels, 8 bits/pixel, 16 colors (16 transparent) in palette
> > Input IDAT size = 8575 bytes
> > Input file size = 8732 bytes
> > 
> > Trying:
> >   zc = 9  zm = 8  zs = 0  f = 0		IDAT size = 7349
> >                                
> > Selecting parameters:
> >   zc = 9  zm = 8  zs = 0  f = 0		IDAT size = 7349
> > 
> > Output IDAT size = 7349 bytes (1226 bytes decrease)
> > Output file size = 7494 bytes (1238 bytes = 14.18% decrease)
> > 
> > # pngfix data/test.png
> > IDAT OK  maximum 15 15 7349 160400 data/test.png
> > 
> > which is explained in the usage output from pngfix with no arguments as...
> > 
> >   The summary lines describe issues encountered with the zlib compressed
> >   stream of a chunk.  They have the following format, which is SUBJECT TO
> >   CHANGE in the future:
> > 
> >      chunk reason comp-level p1 p2 p3 p4 file
> > 
> >   p1 through p4 vary according to the 'reason'.  There are always 8 space
> >   separated fields.  Reasons specific formats are:
> > 
> >      chunk ERR status code read-errno write-errno message file
> >      chunk SKP comp-level file-bits zlib-rc compressed message file
> >      chunk ??? comp-level file-bits ok-bits compressed uncompress file
> > 
> >   The various fields are
> > 
> > $1 chunk:      The chunk type of a chunk in the file or 'HEAD' if a problem
> >                is reported by libpng at the start of the IDAT stream.
> > $2 reason:     One of:
> >           CHK: A zlib header checksum was detected and fixed.
> >           TFB: The zlib too far back error was detected and fixed.
> >           OK : No errors were detected in the zlib stream and optimization
> >                was not requested, or was not possible.
> >           OPT: The zlib stream window bits value could be improved (and was).
> >           SKP: The chunk was skipped because of a zlib issue (zlib-rc) with
> >                explanation 'message'
> >           ERR: The read of the file was aborted.  The parameters explain why.
> > $3 status:     For 'ERR' the accumulate status code from 'EXIT CODES' above.
> >                This is printed as a 2 digit hexadecimal value
> >    comp-level: The recorded compression level (FLEVEL) of a zlib stream
> >                expressed as a string {supfast,stdfast,default,maximum}
> > $4 code:       The file exit code; where stop was called, as a fairly terse
> >                string {warning,libpng,zlib,invalid,read,write,unexpected}.
> >    file-bits:  The zlib window bits recorded in the file.
> > $5 read-errno: A system errno value from a read translated by strerror(3).
> >    zlib-rc:    A zlib return code as a string (see zlib.h).
> >    ok-bits:    The smallest zlib window bits value that works.
> > $6 write-errno:A system errno value from a write translated by strerror(3).
> >    compressed: The count of compressed bytes in the zlib stream, when the
> >                reason is 'SKP'; this is a count of the bytes read from the
> >                stream when the fatal error was encountered.
> > $7 message:    An error message (spaces replaced by _, as in all parameters),
> >    uncompress: The count of bytes from uncompressing the zlib stream; this
> >                may not be the same as the number of bytes in the image.
> > $8 file:       The name of the file (this may contain spaces).
> > 
> > Note that the current test.png that you are shipping is reported as TFB 
> > for "The zlib too far back error was detected and fixed" by pngfix whereas
> > the copy repaired by optipng reports OK for "No errors were detected in the zlib 
> > stream and optimization was not requested, or was not possible.". So far
> > I haven't been able to puzzle out how to get pngfix to repair the file but
> > I notice most are using optipng for that.
> >                      Jack 
> > 
> 
> One last note. I reinstalled the older libpng16-1.6.3-1 packaging on fink and
> it reports the same exact error for the bundled test.png file as the 1.6.6
> release does...
> 
> % /sw/bin/pngfix test.png
> IDAT TFB default 10 15 8575 160400 test.png.sav
> 
> So you should be able to find this problem with libpng 1.6.3 or later. Note
> that the detection of this issue was added during the libpng 1.6.3 development
> cycle so you need to be sure use its pngfix utility and not that from 1.6.2.
> 
> ----------------------------------------------------------------------------
> Changes since the last public release (1.6.2):
> ...
> 
> Added png-fix-itxt and png-fix-too-far-back to the built programs and
>  removed warnings from the source code and timepng that are revealed as
>  a result.
> Detect wrong libpng versions linked to png-fix-too-far-back, which currently
> only works with libpng versions that can be made to reliably fail when
> the deflate data contains an out-of-window reference.  This means only
> 1.6 and later.
> ...
> Attempt to detect configuration issues with png-fix-too-far-back, which
>   requires both the correct libpng and the correct zlib to function
>   correctly.
> ---------------------------------------------------------------------------
> 
> Note on darwin we typically use the system libz which appears to be
> derivation of 1.2.5.

I can reproduce this output from pngfix on a Fedora 15 box as follows...

% tar -zxvf libpng-1.6.6.tar.gz
% cd libpng-1.6.6
% ./configure
% make
% cp ~/autotest/gdrivers/data/test.png .
% ./pngfix test.png
IDAT TFB default 10 15 8575 160400 test.png


> 
> > > 
> > > 
> > > $ ldd apps/gdalinfo | grep png
> > > 	libpng16.so.16 => /home/even/install-libpng-1.6.2/lib/libpng16.so.16 
> > > (0x00007fda95e39000)
> > > 
> > > $ gdalinfo data/gdalicon.png -checksum
> > > Driver: PNG/Portable Network Graphics
> > > Files: data/gdalicon.png
> > > Size is 32, 32
> > > Coordinate System is `'
> > > Image Structure Metadata:
> > >   INTERLEAVE=PIXEL
> > > Corner Coordinates:
> > > Upper Left  (    0.0,    0.0)
> > > Lower Left  (    0.0,   32.0)
> > > Upper Right (   32.0,    0.0)
> > > Lower Right (   32.0,   32.0)
> > > Center      (   16.0,   16.0)
> > > Band 1 Block=32x1 Type=Byte, ColorInterp=Red
> > >   Checksum=7617
> > >   Mask Flags: PER_DATASET ALPHA 
> > > Band 2 Block=32x1 Type=Byte, ColorInterp=Green
> > >   Checksum=7808
> > >   Mask Flags: PER_DATASET ALPHA 
> > > Band 3 Block=32x1 Type=Byte, ColorInterp=Blue
> > >   Checksum=7377
> > >   Mask Flags: PER_DATASET ALPHA 
> > > Band 4 Block=32x1 Type=Byte, ColorInterp=Alpha
> > >   Checksum=7926
> > > 
> > > $ gdalinfo ../autotest/gdrivers/data/test.png -checksum
> > > Driver: PNG/Portable Network Graphics
> > > Files: ../autotest/gdrivers/data/test.png
> > >        ../autotest/gdrivers/data/test.wld
> > > Size is 400, 400
> > > Coordinate System is `'
> > > GeoTransform =
> > >   700000.3050000001, 0.38, 0.01
> > >   4287500.695, -0.01, -0.38
> > > Corner Coordinates:
> > > Upper Left  (  700000.305, 4287500.695) 
> > > Lower Left  (  700004.305, 4287348.695) 
> > > Upper Right (  700152.305, 4287496.695) 
> > > Lower Right (  700156.305, 4287344.695) 
> > > Center      (  700078.305, 4287422.695) 
> > > Band 1 Block=400x1 Type=Byte, ColorInterp=Palette
> > >   Checksum=57921
> > >   NoData Value=0
> > >   Color Table (RGB with 16 entries)
> > >     0: 255,255,255,0
> > >     1: 255,255,208,255
> > >     2: 255,255,204,255
> > >     3: 153,204,255,255
> > >     4: 0,153,255,255
> > >     5: 102,102,102,255
> > >     6: 153,153,153,255
> > >     7: 150,150,150,255
> > >     8: 0,0,0,255
> > >     9: 100,160,210,255
> > >    10: 255,255,255,255
> > >    11: 226,226,226,255
> > >    12: 51,51,51,255
> > >    13: 0,0,0,255
> > >    14: 0,0,0,255
> > >    15: 0,0,0,255
> > > 
> > > 
> > > 
> > > >           Jack
> > > > 
> > > > > On Nov 8, 2013, at 8:02 AM, Jack Howarth <howarth at bromo.med.uc.edu> wrote:
> > > > > > On Fri, Nov 08, 2013 at 10:31:08AM -0500, Jack Howarth wrote:
> > > > > >> On Thu, Nov 07, 2013 at 04:34:07PM -0500, Jack Howarth wrote:
> > > > > >>> The failures on x86_64-apple-darwin13 for the png.py test suite from
> > > > > >>> auto test for gdal 0.10.1 are the same failures described here...
> > > > > >>> 
> > > > > >>> https://github.com/licq-im/licq/pull/32
> > > > > >>> <https://github.com/licq-im/licq/pull/32>
> > > > > >>> 
> > > > > >>> The failures are completely suppressed by regenerating
> > > > > >>> autotest/gdrivers/data/test.png with
> > > > > >>> "optipng -nb -nc -np test.png"...
> > > > > >> 
> > > > > >> Just to clarify, I used optipng 0.6.3 for this. The newer optipng
> > > > > >> 0.7.4 release seems more problematic as none of the obvious
> > > > > >> combination of options can fix the test.png file without changing the
> > > > > >> checksums and causing additional failures. So you will want to use
> > > > > >> the optipng 0.6.x release series to fix the bad png files in gdal.
> > > > > > 
> > > > > > Also, my tests here using optipng 0.7.4 to detect damaged png files
> > > > > > indicate that only data/gdalicon.png in gdal-0.10.1 needs to be fixed.
> > > > > > 
> > > > > > optipng -nb -nc -np -fix data/gdalicon.png
> > > > > > ** Processing: data/gdalicon.png
> > > > > > Warning:
> > > > > > 32x32 pixels, 4x8 bits/pixel, RGB+alpha
> > > > > > Recoverable errors found in input. Fixing...
> > > > > > Input IDAT size = 1964 bytes
> > > > > > Input file size = 2021 bytes
> > > > > > 
> > > > > > Trying:
> > > > > >  zc = 9  zm = 8  zs = 0  f = 0		IDAT size = 240
> > > > > > 
> > > > > > Selecting parameters:
> > > > > >  zc = 9  zm = 8  zs = 0  f = 0		IDAT size = 240
> > > > > > 
> > > > > > Output IDAT size = 240 bytes (1724 bytes decrease)
> > > > > > Output file size = 313 bytes (1708 bytes = 84.51% decrease)
> > > > > > 
> > > > > > ** Status report
> > > > > > 1 file(s) have been processed.
> > > > > > 1 error(s) have been encountered.
> > > > > > 1 erroneous file(s) have been fixed.
> > > > > > 
> > > > > >>> % ./png.py
> > > > > >>> 
> > > > > >>>  TEST: png_1 ... success
> > > > > >>>  TEST: png_2 ... success
> > > > > >>>  TEST: png_3 ... success
> > > > > >>>  TEST: png_4 ... success
> > > > > >>>  TEST: png_5 ... success
> > > > > >>>  TEST: png_6 ... success
> > > > > >>>  TEST: png_7 ... success
> > > > > >>>  TEST: png_8 ... success
> > > > > >>>  TEST: png_9 ... success
> > > > > >>>  TEST: png_10 ... success
> > > > > >>>  TEST: png_11 ... success
> > > > > >>> 
> > > > > >>> Test Script: png
> > > > > >>> Succeeded: 11
> > > > > >>> Failed:    0 (0 blew exceptions)
> > > > > >>> Skipped:   0
> > > > > >>> Expected fail:0
> > > > > >>> Duration:  0.08s
> > > > > >>> 
> > > > > >>> _______________________________________________
> > > > > >>> gdal-dev mailing list
> > > > > >>> gdal-dev at lists.osgeo.org
> > > > > >>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > > > > >> 
> > > > > >> _______________________________________________
> > > > > >> gdal-dev mailing list
> > > > > >> gdal-dev at lists.osgeo.org
> > > > > >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > > > > > 
> > > > > > _______________________________________________
> > > > > > gdal-dev mailing list
> > > > > > gdal-dev at lists.osgeo.org
> > > > > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > > > 
> > > > _______________________________________________
> > > > gdal-dev mailing list
> > > > gdal-dev at lists.osgeo.org
> > > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > > 
> > > -- 
> > > Geospatial professional services
> > > http://even.rouault.free.fr/services.html
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From warmerdam at pobox.com  Fri Nov  8 13:34:36 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri, 8 Nov 2013 13:34:36 -0800
Subject: [gdal-dev] (no subject)
In-Reply-To: <99e997e1bb7f430482b002b7fedcb6fb@BLUPR06MB068.namprd06.prod.outlook.com>
References: <99e997e1bb7f430482b002b7fedcb6fb@BLUPR06MB068.namprd06.prod.outlook.com>
Message-ID: <CA+YzLBcCpeQqqRKecxRjsWsDPKKN-WaXpbsw7zLXcF1vgjdaQw@mail.gmail.com>

Phelippe,

There are a few ways we could move forward on this.

I believe the apparent master version of the PCIDSK SDK from GDAL's point
of view is:

  http://svn.osgeo.org/gdal/sandbox/warmerdam/pcidsk

And I think the process I used before was to periodally migrate this into
the GDAL tree at:

  http://svn.osgeo.org/gdal/trunk/gdal/frmts/pcidsk/sdk/

Approaches:

1) You just drop a code dump on us, and existing developers integrate it.

2) We arrange commit access for you and you prepare an updated SDK in the
"sandbox" area in SVN.  We could then migrate that into the GDAL PCIDSK
driver itself when we are comfortable with it.

3) We arrange full commit access for you and you do your integration
directly in GDAL itself.

I prefer option (2) which avoids the likely breakage in GDAL that might
come from a wholesale replacement of the existing inside-GDAL code.  But
those who wish can still built against the standalone SDK for testing
purposes and so forth.  I'd imagine I'd be the GDAL developer to help move
things over eventually.

If you are ok with (2) then please create an OSGeo at:

  http://www.osgeo.org/osgeo_userid/

And I'll try to arrange sandbox-only commit access for you.

Best regards,
Frank



On Fri, Nov 8, 2013 at 12:19 PM, Phelippe Neveu <neveu at pcigeomatics.com>wrote:

>  To whom it may concern,
>
>  We have updates to the PCIDSK library that we would like to upstream to
> GDAL.
>
>  We have fixed numerous bugs, we have done many optimizations, and we
> also implemented a new binary tile directory.
>
>  How should we proceed with the upstream?
>
>  Thanks,
>
>  Phelippe
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131108/0f3ce6d2/attachment.html>

From federicojurio at suremptec.com.ar  Fri Nov  8 13:41:07 2013
From: federicojurio at suremptec.com.ar (Federico Jurio)
Date: Fri, 8 Nov 2013 19:41:07 -0200
Subject: [gdal-dev] (no subject)
Message-ID: <CADmC3axtUKvqWQRiiGcqUsd-NnCwxFy9P9LmpCaSdAMg-8qsdg@mail.gmail.com>

Hi all, I have a csv file named test.csv with the asociated test.vrt

*test.vrt*
<OGRVRTDataSource>
    <OGRVRTLayer name="test">

<SrcDataSource>C:\\Users\\FedericoJurio\\Desktop\\test.csv</SrcDataSource>
        <GeometryType>wkbPoint</GeometryType>
        <LayerSRS>WGS84</LayerSRS>
        <GeometryField encoding="PointFromColumns" x="Longitude"
y="Latitude"/>
    </OGRVRTLayer>
</OGRVRTDataSource>

*test.csv*
Latitude,Longitude,Name
48.1,0.25,"First point"
49.2,1.1,"Second point"
47.5,0.75,"Third point"

In my code i can add the vrt file to the datasource successfully but when i
try to check the TestCapability(OLCRandomRead) from the correct layer
returns FALSE and i don't no why. Gdal can read the file from the console
with ogrinfo and everithing seems to be fine

*ogrinfo test.vrt*
INFO: Open of `test.vrt'
      using driver `VRT' successful.
1: test (Point)

Does anyone have any idea of why TestCapability returns false?

Thanks in advance,
Regards

-- 
Federico Jurio
SUR Emprendimientos Tecnol?gicos

Per? 345  Piso 5to Oficina "B" (C1067AAG)
Ciudad de Buenos Aires, Argentina
Tel. +54 (11) 4342-2976/84
federicojurio at suremptec.com.ar
www.suremptec.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131108/c8e5ea0f/attachment-0001.html>

From even.rouault at mines-paris.org  Fri Nov  8 13:46:18 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 8 Nov 2013 22:46:18 +0100
Subject: [gdal-dev] (no subject)
In-Reply-To: <CADmC3axtUKvqWQRiiGcqUsd-NnCwxFy9P9LmpCaSdAMg-8qsdg@mail.gmail.com>
References: <CADmC3axtUKvqWQRiiGcqUsd-NnCwxFy9P9LmpCaSdAMg-8qsdg@mail.gmail.com>
Message-ID: <201311082246.18714.even.rouault@mines-paris.org>

Le vendredi 08 novembre 2013 22:41:07, Federico Jurio a ?crit :
> Hi all, I have a csv file named test.csv with the asociated test.vrt
> 
> *test.vrt*
> <OGRVRTDataSource>
>     <OGRVRTLayer name="test">
> 
> <SrcDataSource>C:\\Users\\FedericoJurio\\Desktop\\test.csv</SrcDataSource>
>         <GeometryType>wkbPoint</GeometryType>
>         <LayerSRS>WGS84</LayerSRS>
>         <GeometryField encoding="PointFromColumns" x="Longitude"
> y="Latitude"/>
>     </OGRVRTLayer>
> </OGRVRTDataSource>
> 
> *test.csv*
> Latitude,Longitude,Name
> 48.1,0.25,"First point"
> 49.2,1.1,"Second point"
> 47.5,0.75,"Third point"
> 
> In my code i can add the vrt file to the datasource successfully but when i
> try to check the TestCapability(OLCRandomRead) from the correct layer
> returns FALSE and i don't no why. Gdal can read the file from the console
> with ogrinfo and everithing seems to be fine
> 
> *ogrinfo test.vrt*
> INFO: Open of `test.vrt'
>       using driver `VRT' successful.
> 1: test (Point)
> 
> Does anyone have any idea of why TestCapability returns false?

Quoting http://gdal.org/ogr/ogr__api_8h.html#a480adc8b839b04597f49583371d366fd 
:

"""OLCRandomRead / "RandomRead": TRUE if the GetFeature() method is 
implemented in an optimized way for this layer, as opposed to the default 
implementation using ResetReading() and GetNextFeature() to find the requested 
feature id."""

The organization of a CSV file doesn't allow *efficient* random access, hence 
TestCapability(OLCRandomRead) return FALSE. This doesn't prevent random 
reading from being possible. It will be just slow (on a file with several 
thousands of records... not a 3 line file ;-)). And ogrinfo just needs efficient 
sequential reading, which CSV allows.


> 
> Thanks in advance,
> Regards

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131108/58f08b61/attachment.html>

From neveu at pcigeomatics.com  Fri Nov  8 14:26:18 2013
From: neveu at pcigeomatics.com (Phelippe Neveu)
Date: Fri, 8 Nov 2013 22:26:18 +0000
Subject: [gdal-dev] (no subject)
In-Reply-To: <CA+YzLBcCpeQqqRKecxRjsWsDPKKN-WaXpbsw7zLXcF1vgjdaQw@mail.gmail.com>
References: <99e997e1bb7f430482b002b7fedcb6fb@BLUPR06MB068.namprd06.prod.outlook.com>,
	<CA+YzLBcCpeQqqRKecxRjsWsDPKKN-WaXpbsw7zLXcF1vgjdaQw@mail.gmail.com>
Message-ID: <67801076d5444b87b8193a27ad6c17f6@BLUPR06MB068.namprd06.prod.outlook.com>

Hello Frank,

We would probably go with the approach #2. We will also have to merge any changes made in GDAL if any changes were done since our last update which was 2 years ago I think.

I'm going on vacation for the next week, so I will get back to you on the 18th of November to arrange the access to the sandbox.

Regards,

Phelippe
________________________________
From: fwarmerdam at gmail.com <fwarmerdam at gmail.com> on behalf of Frank Warmerdam <warmerdam at pobox.com>
Sent: Friday, November 08, 2013 16:34
To: Phelippe Neveu
Cc: gdal-dev at lists.osgeo.org; David Stanley; Louis Burry
Subject: Re: [gdal-dev] (no subject)

Phelippe,

There are a few ways we could move forward on this.

I believe the apparent master version of the PCIDSK SDK from GDAL's point of view is:

  http://svn.osgeo.org/gdal/sandbox/warmerdam/pcidsk

And I think the process I used before was to periodally migrate this into the GDAL tree at:

  http://svn.osgeo.org/gdal/trunk/gdal/frmts/pcidsk/sdk/

Approaches:

1) You just drop a code dump on us, and existing developers integrate it.

2) We arrange commit access for you and you prepare an updated SDK in the "sandbox" area in SVN.  We could then migrate that into the GDAL PCIDSK driver itself when we are comfortable with it.

3) We arrange full commit access for you and you do your integration directly in GDAL itself.

I prefer option (2) which avoids the likely breakage in GDAL that might come from a wholesale replacement of the existing inside-GDAL code.  But those who wish can still built against the standalone SDK for testing purposes and so forth.  I'd imagine I'd be the GDAL developer to help move things over eventually.

If you are ok with (2) then please create an OSGeo at:

  http://www.osgeo.org/osgeo_userid/

And I'll try to arrange sandbox-only commit access for you.

Best regards,
Frank



On Fri, Nov 8, 2013 at 12:19 PM, Phelippe Neveu <neveu at pcigeomatics.com<mailto:neveu at pcigeomatics.com>> wrote:
To whom it may concern,

We have updates to the PCIDSK library that we would like to upstream to GDAL.

We have fixed numerous bugs, we have done many optimizations, and we also implemented a new binary tile directory.

How should we proceed with the upstream?

Thanks,

Phelippe

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
http://lists.osgeo.org/mailman/listinfo/gdal-dev



--
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com<mailto:warmerdam at pobox.com>
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131108/3b8fa6f1/attachment.html>

From mariusjigmond at hotmail.com  Fri Nov  8 18:43:08 2013
From: mariusjigmond at hotmail.com (Marius Jigmond)
Date: Fri, 8 Nov 2013 20:43:08 -0600
Subject: [gdal-dev] gdal_translate produces tif with different colors as
 original
In-Reply-To: <l5gehg$2se$2@ger.gmane.org>
References: <2D55B4FBCD59D045AC382D3F65435B7903843AD77DF3@HE101453.emea1.cds.t-internal.com>,
	<loom.20131106T211413-94@post.gmane.org>,
	<l5gehg$2se$2@ger.gmane.org>
Message-ID: <BLU175-W115588E1C0D1548122277FB2FD0@phx.gbl>

I noticed you're using ArcMap for visualizing the results. Did you check what histogram/gamma stretch gets applied by default when you load the layer? I run into this issue often as results from GDAL operations appear much worse when loaded into ArcMap compared to originals. When I turn off stretching, both histogram/gamma, results are nearly identical to original.
-marius

> To: gdal-dev at lists.osgeo.org
> From: andre+joost at nurfuerspam.de
> Date: Thu, 7 Nov 2013 16:54:32 +0100
> Subject: Re: [gdal-dev] gdal_translate produces tif with different colors as	original
> 
> Am 06.11.2013 21:32, schrieb Jukka Rahkonen:
> 
> > You're advised to preprocess your rasters with other
> > tools, such as pct2rgb.py or gdal_translate -expand RGB to operate
> > gdalbuildvrt on RGB rasters instead."
> >
> 
> I proposed that, but have a look at the color palette of the VRT:
> 
> <http://gis.stackexchange.com/questions/76662/gdal-translate-produces-tif-with-different-colors-as-original>
> 
> Is it a fault of the source or the driver?
> 
> Greetings,
> Andr? Joost
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131108/337602da/attachment.html>

From dcohen at iastate.edu  Sat Nov  9 01:46:20 2013
From: dcohen at iastate.edu (denis cohen)
Date: Sat, 9 Nov 2013 10:46:20 +0100
Subject: [gdal-dev] writing XYZ file
Message-ID: <CAKf_S2Kb1BuqvJYMfXLoyWdm94eoSOKNRhZYaTOrJhFtKazNmA@mail.gmail.com>

Hello,

I am a new user of gdal.
I used gdal_translate to convert a netcdf file to xyz:
gdal_translate -of XYZ file.nc file.xyz

However, the xyz file starts with the upperleft coordinate.
Is it possible to have it write the xyz file starting with the lower left
coordinate?

Thank you for your help

Denis
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131109/a8d32749/attachment-0001.html>

From jukka.rahkonen at mmmtike.fi  Sat Nov  9 01:53:13 2013
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Sat, 9 Nov 2013 09:53:13 +0000 (UTC)
Subject: [gdal-dev] In which version utilities have appeared?
References: <loom.20131108T191558-267@post.gmane.org>
	<201311081922.36592.even.rouault@mines-paris.org>
	<loom.20131108T192424-827@post.gmane.org>
	<201311081934.29459.even.rouault@mines-paris.org>
Message-ID: <loom.20131109T100414-991@post.gmane.org>

Even Rouault <even.rouault <at> mines-paris.org> writes:

> 
> Well, I admire your energy. Why not being lazy and telling that your tutorial 
> applies to GDAL 1.10 or above, and if people are using older versions some 
> things might not apply.


All users do not administrate their computers. If sys admin suggests
something like Debian Squeeze stable
http://packages.debian.org/squeeze/gdal-bin or Debian Wheezy stable
http://packages.debian.org/wheezy/gdal-bin it would be nice to check fast if
for example "gdallocationinfo" or "gdal_edit.py" is supported or if admins
should install something cutting edge instead
http://packages.debian.org/experimental/gdal-bin. Which they probably will
not do but that is another story.

By the way, I checked my laptop that I have been used since 2006 and found
44 separate GDAL dll files of versions between 1.2 and 1.10.

-Jukka-


From even.rouault at mines-paris.org  Sat Nov  9 10:31:54 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 9 Nov 2013 19:31:54 +0100
Subject: [gdal-dev] libpng and autotest
In-Reply-To: <20131108210137.GC32123@bromo.med.uc.edu>
References: <20131107213407.GA24403@bromo.med.uc.edu>
	<20131108204612.GB32123@bromo.med.uc.edu>
	<20131108210137.GC32123@bromo.med.uc.edu>
Message-ID: <201311091931.54281.even.rouault@mines-paris.org>


> > -------------------------------------------------------------------------
> > --
> > 
> > Note on darwin we typically use the system libz which appears to be
> > derivation of 1.2.5.
> 
> I can reproduce this output from pngfix on a Fedora 15 box as follows...
> 
> % tar -zxvf libpng-1.6.6.tar.gz
> % cd libpng-1.6.6
> % ./configure
> % make
> % cp ~/autotest/gdrivers/data/test.png .
> % ./pngfix test.png
> IDAT TFB default 10 15 8575 160400 test.png
> 

Jack,

I've finally managed to reproduce with libpng 1.6.6 and by using it with zlib 
1.2.8. Actually pngfix refused to run with my system zlib 1.2.3 and while 
looking at the code of libpng, it appears that this issue about window size 
only appears with zlib 1.2.4 or above since libpng then uses a new API of zlib 
that takes into account this window size. So broken images will only be 
detected with a combination of both recent libpng and zlib.

I've committed the fixed gdalicon.png and autotest/gdrivers/data/test.png in 
trunk.

Thanks for your tenacity.

Even


-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Sat Nov  9 11:02:23 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 9 Nov 2013 20:02:23 +0100
Subject: [gdal-dev] writing XYZ file
In-Reply-To: <CAKf_S2Kb1BuqvJYMfXLoyWdm94eoSOKNRhZYaTOrJhFtKazNmA@mail.gmail.com>
References: <CAKf_S2Kb1BuqvJYMfXLoyWdm94eoSOKNRhZYaTOrJhFtKazNmA@mail.gmail.com>
Message-ID: <201311092002.23371.even.rouault@mines-paris.org>

Le samedi 09 novembre 2013 10:46:20, denis cohen a ?crit :
> Hello,
> 
> I am a new user of gdal.
> I used gdal_translate to convert a netcdf file to xyz:
> gdal_translate -of XYZ file.nc file.xyz
> 
> However, the xyz file starts with the upperleft coordinate.
> Is it possible to have it write the xyz file starting with the lower left
> coordinate?

Not directly although it wouldn't be complicated to add an option to do that.

You can try the following GDAL Python script that will create an intermediary 
TIFF image that has both inverted georeferencing and imagery in a consistant 
way.

python invert.py file.nc file_reserved.tif
gdal_translate -of XYZ file_reversed.tif file.xyz


----- Begin of script invert.py ------

# -*- coding: utf-8 -*-
import sys
from osgeo import gdal

src_ds = gdal.Open(sys.argv[1])
xsize = src_ds.RasterXSize
ysize = src_ds.RasterYSize
bandcount = src_ds.RasterCount
out_drv = gdal.GetDriverByName('GTiff')
out_ds = out_drv.Create(sys.argv[2], xsize, ysize, bandcount)
out_ds.SetProjection(src_ds.GetProjectionRef())
src_gt = src_ds.GetGeoTransform()
out_gt = [ src_gt[i] for i in range(6) ]
out_gt[3] = src_gt[3] + ysize * src_gt[5]
out_gt[5] = -src_gt[5]
out_ds.SetGeoTransform(out_gt)
for j in range(src_ds.RasterYSize):
    data = src_ds.ReadRaster(0, ysize - 1 - j, xsize, 1)
    out_ds.WriteRaster(0, j, xsize, 1, data)
out_ds = None
src_ds = None

----- End of script ------

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From dcohen at iastate.edu  Sat Nov  9 11:39:50 2013
From: dcohen at iastate.edu (denis cohen)
Date: Sat, 9 Nov 2013 20:39:50 +0100
Subject: [gdal-dev] writing XYZ file
Message-ID: <CAKf_S2+YMjuBDgPDodZ51fP-Xa_dLyTGJB_VkQD6vYe-6dyMtQ@mail.gmail.com>

Hi,

Thanks for the script. It works fine except for the actual data (elevation
in my case, this is a DEM).
It does not write the correct values.

Merci

Denis



On Sat, Nov 9, 2013 at 8:02 PM, Even Rouault
<even.rouault at mines-paris.org>wrote:

> Le samedi 09 novembre 2013 10:46:20, denis cohen a ?crit :
> > Hello,
> >
> > I am a new user of gdal.
> > I used gdal_translate to convert a netcdf file to xyz:
> > gdal_translate -of XYZ file.nc file.xyz
> >
> > However, the xyz file starts with the upperleft coordinate.
> > Is it possible to have it write the xyz file starting with the lower left
> > coordinate?
>
> Not directly although it wouldn't be complicated to add an option to do
> that.
>
> You can try the following GDAL Python script that will create an
> intermediary
> TIFF image that has both inverted georeferencing and imagery in a
> consistant
> way.
>
> python invert.py file.nc file_reserved.tif
> gdal_translate -of XYZ file_reversed.tif file.xyz
>
>
> ----- Begin of script invert.py ------
>
> # -*- coding: utf-8 -*-
> import sys
> from osgeo import gdal
>
> src_ds = gdal.Open(sys.argv[1])
> xsize = src_ds.RasterXSize
> ysize = src_ds.RasterYSize
> bandcount = src_ds.RasterCount
> out_drv = gdal.GetDriverByName('GTiff')
> out_ds = out_drv.Create(sys.argv[2], xsize, ysize, bandcount)
> out_ds.SetProjection(src_ds.GetProjectionRef())
> src_gt = src_ds.GetGeoTransform()
> out_gt = [ src_gt[i] for i in range(6) ]
> out_gt[3] = src_gt[3] + ysize * src_gt[5]
> out_gt[5] = -src_gt[5]
> out_ds.SetGeoTransform(out_gt)
> for j in range(src_ds.RasterYSize):
>     data = src_ds.ReadRaster(0, ysize - 1 - j, xsize, 1)
>     out_ds.WriteRaster(0, j, xsize, 1, data)
> out_ds = None
> src_ds = None
>
> ----- End of script ------
>
> Even
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131109/7ae22dc5/attachment.html>

From even.rouault at mines-paris.org  Sat Nov  9 11:46:55 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 9 Nov 2013 20:46:55 +0100
Subject: [gdal-dev] writing XYZ file
In-Reply-To: <CAKf_S2+YMjuBDgPDodZ51fP-Xa_dLyTGJB_VkQD6vYe-6dyMtQ@mail.gmail.com>
References: <CAKf_S2+YMjuBDgPDodZ51fP-Xa_dLyTGJB_VkQD6vYe-6dyMtQ@mail.gmail.com>
Message-ID: <201311092046.55936.even.rouault@mines-paris.org>

Le samedi 09 novembre 2013 20:39:50, denis cohen a ?crit :
> Hi,
> 
> Thanks for the script. It works fine except for the actual data (elevation
> in my case, this is a DEM).
> It does not write the correct values.

Ah right, this version only worked for Byte data type. The below version 
should work for any GDAL data type

----- Begin of script invert.py ------

# -*- coding: utf-8 -*-
import sys
from osgeo import gdal

src_ds = gdal.Open(sys.argv[1])
xsize = src_ds.RasterXSize
ysize = src_ds.RasterYSize
bandcount = src_ds.RasterCount
datatype = src_ds.GetRasterBand(1).DataType
out_drv = gdal.GetDriverByName('GTiff')
out_ds = out_drv.Create(sys.argv[2], xsize, ysize, bandcount, datatype)
out_ds.SetProjection(src_ds.GetProjectionRef())
src_gt = src_ds.GetGeoTransform()
out_gt = [ src_gt[i] for i in range(6) ]
out_gt[3] = src_gt[3] + ysize * src_gt[5]
out_gt[5] = -src_gt[5]
out_ds.SetGeoTransform(out_gt)
for j in range(src_ds.RasterYSize):
    data = src_ds.ReadRaster(0, ysize - 1 - j, xsize, 1, buf_type = datatype)
    out_ds.WriteRaster(0, j, xsize, 1, data, buf_type = datatype)
out_ds = None
src_ds = None

----- End of script ------



> 
> Merci
> 
> Denis
> 
> 
> 
> On Sat, Nov 9, 2013 at 8:02 PM, Even Rouault
> 
> <even.rouault at mines-paris.org>wrote:
> > Le samedi 09 novembre 2013 10:46:20, denis cohen a ?crit :
> > > Hello,
> > > 
> > > I am a new user of gdal.
> > > I used gdal_translate to convert a netcdf file to xyz:
> > > gdal_translate -of XYZ file.nc file.xyz
> > > 
> > > However, the xyz file starts with the upperleft coordinate.
> > > Is it possible to have it write the xyz file starting with the lower
> > > left coordinate?
> > 
> > Not directly although it wouldn't be complicated to add an option to do
> > that.
> > 
> > You can try the following GDAL Python script that will create an
> > intermediary
> > TIFF image that has both inverted georeferencing and imagery in a
> > consistant
> > way.
> > 
> > python invert.py file.nc file_reserved.tif
> > gdal_translate -of XYZ file_reversed.tif file.xyz
> > 
> > 
> > ----- Begin of script invert.py ------
> > 
> > # -*- coding: utf-8 -*-
> > import sys
> > from osgeo import gdal
> > 
> > src_ds = gdal.Open(sys.argv[1])
> > xsize = src_ds.RasterXSize
> > ysize = src_ds.RasterYSize
> > bandcount = src_ds.RasterCount
> > out_drv = gdal.GetDriverByName('GTiff')
> > out_ds = out_drv.Create(sys.argv[2], xsize, ysize, bandcount)
> > out_ds.SetProjection(src_ds.GetProjectionRef())
> > src_gt = src_ds.GetGeoTransform()
> > out_gt = [ src_gt[i] for i in range(6) ]
> > out_gt[3] = src_gt[3] + ysize * src_gt[5]
> > out_gt[5] = -src_gt[5]
> > out_ds.SetGeoTransform(out_gt)
> > 
> > for j in range(src_ds.RasterYSize):
> >     data = src_ds.ReadRaster(0, ysize - 1 - j, xsize, 1)
> >     out_ds.WriteRaster(0, j, xsize, 1, data)
> > 
> > out_ds = None
> > src_ds = None
> > 
> > ----- End of script ------
> > 
> > Even
> > 
> > --
> > Geospatial professional services
> > http://even.rouault.free.fr/services.html

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From dcohen at iastate.edu  Sat Nov  9 11:59:11 2013
From: dcohen at iastate.edu (denis cohen)
Date: Sat, 9 Nov 2013 20:59:11 +0100
Subject: [gdal-dev] writing XYZ file
In-Reply-To: <201311092046.55936.even.rouault@mines-paris.org>
References: <CAKf_S2+YMjuBDgPDodZ51fP-Xa_dLyTGJB_VkQD6vYe-6dyMtQ@mail.gmail.com>
	<201311092046.55936.even.rouault@mines-paris.org>
Message-ID: <CAKf_S2LcF4_7UkfZx7yZdEOU50z00x6wy2micGciyecxXWTcaw@mail.gmail.com>

Salut,

Almost there, it looks like the data is not inverted, it still starts from
the upper left corner instead of lower left.

Thanks

Denis



On Sat, Nov 9, 2013 at 8:46 PM, Even Rouault
<even.rouault at mines-paris.org>wrote:

> Le samedi 09 novembre 2013 20:39:50, denis cohen a ?crit :
> > Hi,
> >
> > Thanks for the script. It works fine except for the actual data
> (elevation
> > in my case, this is a DEM).
> > It does not write the correct values.
>
> Ah right, this version only worked for Byte data type. The below version
> should work for any GDAL data type
>
> ----- Begin of script invert.py ------
>
> # -*- coding: utf-8 -*-
> import sys
> from osgeo import gdal
>
> src_ds = gdal.Open(sys.argv[1])
> xsize = src_ds.RasterXSize
> ysize = src_ds.RasterYSize
> bandcount = src_ds.RasterCount
> datatype = src_ds.GetRasterBand(1).DataType
> out_drv = gdal.GetDriverByName('GTiff')
> out_ds = out_drv.Create(sys.argv[2], xsize, ysize, bandcount, datatype)
> out_ds.SetProjection(src_ds.GetProjectionRef())
> src_gt = src_ds.GetGeoTransform()
> out_gt = [ src_gt[i] for i in range(6) ]
> out_gt[3] = src_gt[3] + ysize * src_gt[5]
> out_gt[5] = -src_gt[5]
> out_ds.SetGeoTransform(out_gt)
> for j in range(src_ds.RasterYSize):
>     data = src_ds.ReadRaster(0, ysize - 1 - j, xsize, 1, buf_type =
> datatype)
>     out_ds.WriteRaster(0, j, xsize, 1, data, buf_type = datatype)
> out_ds = None
> src_ds = None
>
> ----- End of script ------
>
>
>
> >
> > Merci
> >
> > Denis
> >
> >
> >
> > On Sat, Nov 9, 2013 at 8:02 PM, Even Rouault
> >
> > <even.rouault at mines-paris.org>wrote:
> > > Le samedi 09 novembre 2013 10:46:20, denis cohen a ?crit :
> > > > Hello,
> > > >
> > > > I am a new user of gdal.
> > > > I used gdal_translate to convert a netcdf file to xyz:
> > > > gdal_translate -of XYZ file.nc file.xyz
> > > >
> > > > However, the xyz file starts with the upperleft coordinate.
> > > > Is it possible to have it write the xyz file starting with the lower
> > > > left coordinate?
> > >
> > > Not directly although it wouldn't be complicated to add an option to do
> > > that.
> > >
> > > You can try the following GDAL Python script that will create an
> > > intermediary
> > > TIFF image that has both inverted georeferencing and imagery in a
> > > consistant
> > > way.
> > >
> > > python invert.py file.nc file_reserved.tif
> > > gdal_translate -of XYZ file_reversed.tif file.xyz
> > >
> > >
> > > ----- Begin of script invert.py ------
> > >
> > > # -*- coding: utf-8 -*-
> > > import sys
> > > from osgeo import gdal
> > >
> > > src_ds = gdal.Open(sys.argv[1])
> > > xsize = src_ds.RasterXSize
> > > ysize = src_ds.RasterYSize
> > > bandcount = src_ds.RasterCount
> > > out_drv = gdal.GetDriverByName('GTiff')
> > > out_ds = out_drv.Create(sys.argv[2], xsize, ysize, bandcount)
> > > out_ds.SetProjection(src_ds.GetProjectionRef())
> > > src_gt = src_ds.GetGeoTransform()
> > > out_gt = [ src_gt[i] for i in range(6) ]
> > > out_gt[3] = src_gt[3] + ysize * src_gt[5]
> > > out_gt[5] = -src_gt[5]
> > > out_ds.SetGeoTransform(out_gt)
> > >
> > > for j in range(src_ds.RasterYSize):
> > >     data = src_ds.ReadRaster(0, ysize - 1 - j, xsize, 1)
> > >     out_ds.WriteRaster(0, j, xsize, 1, data)
> > >
> > > out_ds = None
> > > src_ds = None
> > >
> > > ----- End of script ------
> > >
> > > Even
> > >
> > > --
> > > Geospatial professional services
> > > http://even.rouault.free.fr/services.html
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131109/c5f59c11/attachment-0001.html>

From even.rouault at mines-paris.org  Sat Nov  9 12:12:37 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 9 Nov 2013 21:12:37 +0100
Subject: [gdal-dev] writing XYZ file
In-Reply-To: <CAKf_S2LcF4_7UkfZx7yZdEOU50z00x6wy2micGciyecxXWTcaw@mail.gmail.com>
References: <CAKf_S2+YMjuBDgPDodZ51fP-Xa_dLyTGJB_VkQD6vYe-6dyMtQ@mail.gmail.com>
	<201311092046.55936.even.rouault@mines-paris.org>
	<CAKf_S2LcF4_7UkfZx7yZdEOU50z00x6wy2micGciyecxXWTcaw@mail.gmail.com>
Message-ID: <201311092112.37257.even.rouault@mines-paris.org>

Le samedi 09 novembre 2013 20:59:11, denis cohen a ?crit :
> Salut,
> 
> Almost there, it looks like the data is not inverted, it still starts from
> the upper left corner instead of lower left.

Really ? Not in my testing. 

$ gdalinfo ../autotest/gdrivers/data/small_world.tif
Driver: GTiff/GeoTIFF
Files: ../autotest/gdrivers/data/small_world.tif
Size is 400, 200
Coordinate System is:
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563,
            AUTHORITY["EPSG","7030"]],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0],
    UNIT["degree",0.0174532925199433],
    AUTHORITY["EPSG","4326"]]
Origin = (-180.000000000000000,90.000000000000000)
Pixel Size = (0.900000000000000,-0.900000000000000)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (-180.0000000,  90.0000000) (180d 0' 0.00"W, 90d 0' 0.00"N)
Lower Left  (-180.0000000, -90.0000000) (180d 0' 0.00"W, 90d 0' 0.00"S)
Upper Right ( 180.0000000,  90.0000000) (180d 0' 0.00"E, 90d 0' 0.00"N)
Lower Right ( 180.0000000, -90.0000000) (180d 0' 0.00"E, 90d 0' 0.00"S)
Center      (   0.0000000,   0.0000000) (  0d 0' 0.01"E,  0d 0' 0.01"N)

$ python create_upsidedown_tif.py ../autotest/gdrivers/data/small_world.tif 
reverse.tif

$ gdal_translate reverse.tif  out.xyz -of xyz

$ head out.xyz
-179.550000000000011 -89.5499999999999972 215
[...]

> 
> Thanks
> 
> Denis
> 
> 
> 
> On Sat, Nov 9, 2013 at 8:46 PM, Even Rouault
> 
> <even.rouault at mines-paris.org>wrote:
> > Le samedi 09 novembre 2013 20:39:50, denis cohen a ?crit :
> > > Hi,
> > > 
> > > Thanks for the script. It works fine except for the actual data
> > 
> > (elevation
> > 
> > > in my case, this is a DEM).
> > > It does not write the correct values.
> > 
> > Ah right, this version only worked for Byte data type. The below version
> > should work for any GDAL data type
> > 
> > ----- Begin of script invert.py ------
> > 
> > # -*- coding: utf-8 -*-
> > import sys
> > from osgeo import gdal
> > 
> > src_ds = gdal.Open(sys.argv[1])
> > xsize = src_ds.RasterXSize
> > ysize = src_ds.RasterYSize
> > bandcount = src_ds.RasterCount
> > datatype = src_ds.GetRasterBand(1).DataType
> > out_drv = gdal.GetDriverByName('GTiff')
> > out_ds = out_drv.Create(sys.argv[2], xsize, ysize, bandcount, datatype)
> > out_ds.SetProjection(src_ds.GetProjectionRef())
> > src_gt = src_ds.GetGeoTransform()
> > out_gt = [ src_gt[i] for i in range(6) ]
> > out_gt[3] = src_gt[3] + ysize * src_gt[5]
> > out_gt[5] = -src_gt[5]
> > out_ds.SetGeoTransform(out_gt)
> > 
> > for j in range(src_ds.RasterYSize):
> >     data = src_ds.ReadRaster(0, ysize - 1 - j, xsize, 1, buf_type =
> > 
> > datatype)
> > 
> >     out_ds.WriteRaster(0, j, xsize, 1, data, buf_type = datatype)
> > 
> > out_ds = None
> > src_ds = None
> > 
> > ----- End of script ------
> > 
> > > Merci
> > > 
> > > Denis
> > > 
> > > 
> > > 
> > > On Sat, Nov 9, 2013 at 8:02 PM, Even Rouault
> > > 
> > > <even.rouault at mines-paris.org>wrote:
> > > > Le samedi 09 novembre 2013 10:46:20, denis cohen a ?crit :
> > > > > Hello,
> > > > > 
> > > > > I am a new user of gdal.
> > > > > I used gdal_translate to convert a netcdf file to xyz:
> > > > > gdal_translate -of XYZ file.nc file.xyz
> > > > > 
> > > > > However, the xyz file starts with the upperleft coordinate.
> > > > > Is it possible to have it write the xyz file starting with the
> > > > > lower left coordinate?
> > > > 
> > > > Not directly although it wouldn't be complicated to add an option to
> > > > do that.
> > > > 
> > > > You can try the following GDAL Python script that will create an
> > > > intermediary
> > > > TIFF image that has both inverted georeferencing and imagery in a
> > > > consistant
> > > > way.
> > > > 
> > > > python invert.py file.nc file_reserved.tif
> > > > gdal_translate -of XYZ file_reversed.tif file.xyz
> > > > 
> > > > 
> > > > ----- Begin of script invert.py ------
> > > > 
> > > > # -*- coding: utf-8 -*-
> > > > import sys
> > > > from osgeo import gdal
> > > > 
> > > > src_ds = gdal.Open(sys.argv[1])
> > > > xsize = src_ds.RasterXSize
> > > > ysize = src_ds.RasterYSize
> > > > bandcount = src_ds.RasterCount
> > > > out_drv = gdal.GetDriverByName('GTiff')
> > > > out_ds = out_drv.Create(sys.argv[2], xsize, ysize, bandcount)
> > > > out_ds.SetProjection(src_ds.GetProjectionRef())
> > > > src_gt = src_ds.GetGeoTransform()
> > > > out_gt = [ src_gt[i] for i in range(6) ]
> > > > out_gt[3] = src_gt[3] + ysize * src_gt[5]
> > > > out_gt[5] = -src_gt[5]
> > > > out_ds.SetGeoTransform(out_gt)
> > > > 
> > > > for j in range(src_ds.RasterYSize):
> > > >     data = src_ds.ReadRaster(0, ysize - 1 - j, xsize, 1)
> > > >     out_ds.WriteRaster(0, j, xsize, 1, data)
> > > > 
> > > > out_ds = None
> > > > src_ds = None
> > > > 
> > > > ----- End of script ------
> > > > 
> > > > Even
> > > > 
> > > > --
> > > > Geospatial professional services
> > > > http://even.rouault.free.fr/services.html
> > 
> > --
> > Geospatial professional services
> > http://even.rouault.free.fr/services.html

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From dcohen at iastate.edu  Sat Nov  9 12:17:07 2013
From: dcohen at iastate.edu (denis cohen)
Date: Sat, 9 Nov 2013 21:17:07 +0100
Subject: [gdal-dev] writing XYZ file
In-Reply-To: <201311092112.37257.even.rouault@mines-paris.org>
References: <CAKf_S2+YMjuBDgPDodZ51fP-Xa_dLyTGJB_VkQD6vYe-6dyMtQ@mail.gmail.com>
	<201311092046.55936.even.rouault@mines-paris.org>
	<CAKf_S2LcF4_7UkfZx7yZdEOU50z00x6wy2micGciyecxXWTcaw@mail.gmail.com>
	<201311092112.37257.even.rouault@mines-paris.org>
Message-ID: <CAKf_S2J_yvOZh=5VqpCwVNBJLrOsvTULwsXNDRxezVe7AmnodQ@mail.gmail.com>

Hi,

May be I wasn't clear. The x,y coordinates start from the lower left but
not the elevation (z coord).

Denis



On Sat, Nov 9, 2013 at 9:12 PM, Even Rouault
<even.rouault at mines-paris.org>wrote:

> Le samedi 09 novembre 2013 20:59:11, denis cohen a ?crit :
> > Salut,
> >
> > Almost there, it looks like the data is not inverted, it still starts
> from
> > the upper left corner instead of lower left.
>
> Really ? Not in my testing.
>
> $ gdalinfo ../autotest/gdrivers/data/small_world.tif
> Driver: GTiff/GeoTIFF
> Files: ../autotest/gdrivers/data/small_world.tif
> Size is 400, 200
> Coordinate System is:
> GEOGCS["WGS 84",
>     DATUM["WGS_1984",
>         SPHEROID["WGS 84",6378137,298.257223563,
>             AUTHORITY["EPSG","7030"]],
>         AUTHORITY["EPSG","6326"]],
>     PRIMEM["Greenwich",0],
>     UNIT["degree",0.0174532925199433],
>     AUTHORITY["EPSG","4326"]]
> Origin = (-180.000000000000000,90.000000000000000)
> Pixel Size = (0.900000000000000,-0.900000000000000)
> Metadata:
>   AREA_OR_POINT=Area
> Image Structure Metadata:
>   INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  (-180.0000000,  90.0000000) (180d 0' 0.00"W, 90d 0' 0.00"N)
> Lower Left  (-180.0000000, -90.0000000) (180d 0' 0.00"W, 90d 0' 0.00"S)
> Upper Right ( 180.0000000,  90.0000000) (180d 0' 0.00"E, 90d 0' 0.00"N)
> Lower Right ( 180.0000000, -90.0000000) (180d 0' 0.00"E, 90d 0' 0.00"S)
> Center      (   0.0000000,   0.0000000) (  0d 0' 0.01"E,  0d 0' 0.01"N)
>
> $ python create_upsidedown_tif.py ../autotest/gdrivers/data/small_world.tif
> reverse.tif
>
> $ gdal_translate reverse.tif  out.xyz -of xyz
>
> $ head out.xyz
> -179.550000000000011 -89.5499999999999972 215
> [...]
>
> >
> > Thanks
> >
> > Denis
> >
> >
> >
> > On Sat, Nov 9, 2013 at 8:46 PM, Even Rouault
> >
> > <even.rouault at mines-paris.org>wrote:
> > > Le samedi 09 novembre 2013 20:39:50, denis cohen a ?crit :
> > > > Hi,
> > > >
> > > > Thanks for the script. It works fine except for the actual data
> > >
> > > (elevation
> > >
> > > > in my case, this is a DEM).
> > > > It does not write the correct values.
> > >
> > > Ah right, this version only worked for Byte data type. The below
> version
> > > should work for any GDAL data type
> > >
> > > ----- Begin of script invert.py ------
> > >
> > > # -*- coding: utf-8 -*-
> > > import sys
> > > from osgeo import gdal
> > >
> > > src_ds = gdal.Open(sys.argv[1])
> > > xsize = src_ds.RasterXSize
> > > ysize = src_ds.RasterYSize
> > > bandcount = src_ds.RasterCount
> > > datatype = src_ds.GetRasterBand(1).DataType
> > > out_drv = gdal.GetDriverByName('GTiff')
> > > out_ds = out_drv.Create(sys.argv[2], xsize, ysize, bandcount, datatype)
> > > out_ds.SetProjection(src_ds.GetProjectionRef())
> > > src_gt = src_ds.GetGeoTransform()
> > > out_gt = [ src_gt[i] for i in range(6) ]
> > > out_gt[3] = src_gt[3] + ysize * src_gt[5]
> > > out_gt[5] = -src_gt[5]
> > > out_ds.SetGeoTransform(out_gt)
> > >
> > > for j in range(src_ds.RasterYSize):
> > >     data = src_ds.ReadRaster(0, ysize - 1 - j, xsize, 1, buf_type =
> > >
> > > datatype)
> > >
> > >     out_ds.WriteRaster(0, j, xsize, 1, data, buf_type = datatype)
> > >
> > > out_ds = None
> > > src_ds = None
> > >
> > > ----- End of script ------
> > >
> > > > Merci
> > > >
> > > > Denis
> > > >
> > > >
> > > >
> > > > On Sat, Nov 9, 2013 at 8:02 PM, Even Rouault
> > > >
> > > > <even.rouault at mines-paris.org>wrote:
> > > > > Le samedi 09 novembre 2013 10:46:20, denis cohen a ?crit :
> > > > > > Hello,
> > > > > >
> > > > > > I am a new user of gdal.
> > > > > > I used gdal_translate to convert a netcdf file to xyz:
> > > > > > gdal_translate -of XYZ file.nc file.xyz
> > > > > >
> > > > > > However, the xyz file starts with the upperleft coordinate.
> > > > > > Is it possible to have it write the xyz file starting with the
> > > > > > lower left coordinate?
> > > > >
> > > > > Not directly although it wouldn't be complicated to add an option
> to
> > > > > do that.
> > > > >
> > > > > You can try the following GDAL Python script that will create an
> > > > > intermediary
> > > > > TIFF image that has both inverted georeferencing and imagery in a
> > > > > consistant
> > > > > way.
> > > > >
> > > > > python invert.py file.nc file_reserved.tif
> > > > > gdal_translate -of XYZ file_reversed.tif file.xyz
> > > > >
> > > > >
> > > > > ----- Begin of script invert.py ------
> > > > >
> > > > > # -*- coding: utf-8 -*-
> > > > > import sys
> > > > > from osgeo import gdal
> > > > >
> > > > > src_ds = gdal.Open(sys.argv[1])
> > > > > xsize = src_ds.RasterXSize
> > > > > ysize = src_ds.RasterYSize
> > > > > bandcount = src_ds.RasterCount
> > > > > out_drv = gdal.GetDriverByName('GTiff')
> > > > > out_ds = out_drv.Create(sys.argv[2], xsize, ysize, bandcount)
> > > > > out_ds.SetProjection(src_ds.GetProjectionRef())
> > > > > src_gt = src_ds.GetGeoTransform()
> > > > > out_gt = [ src_gt[i] for i in range(6) ]
> > > > > out_gt[3] = src_gt[3] + ysize * src_gt[5]
> > > > > out_gt[5] = -src_gt[5]
> > > > > out_ds.SetGeoTransform(out_gt)
> > > > >
> > > > > for j in range(src_ds.RasterYSize):
> > > > >     data = src_ds.ReadRaster(0, ysize - 1 - j, xsize, 1)
> > > > >     out_ds.WriteRaster(0, j, xsize, 1, data)
> > > > >
> > > > > out_ds = None
> > > > > src_ds = None
> > > > >
> > > > > ----- End of script ------
> > > > >
> > > > > Even
> > > > >
> > > > > --
> > > > > Geospatial professional services
> > > > > http://even.rouault.free.fr/services.html
> > >
> > > --
> > > Geospatial professional services
> > > http://even.rouault.free.fr/services.html
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131109/a9f585f6/attachment.html>

From normvcr at telus.net  Sat Nov  9 13:07:55 2013
From: normvcr at telus.net (Norman Goldstein)
Date: Sat, 09 Nov 2013 13:07:55 -0800
Subject: [gdal-dev] geotiff projection not showing up
In-Reply-To: <CA+YzLBeuiJc1d3sZH5bTf9MbxQoyixh2OB--EZhGMN2KmRPy0A@mail.gmail.com>
References: <527AB33E.3050306@telus.net>	<CA+YzLBdy+UVXK=fjZt6TNtYLtA2izcL2-hP20gecqv77De9jZA@mail.gmail.com>	<527AD80C.8050507@telus.net>
	<CA+YzLBeuiJc1d3sZH5bTf9MbxQoyixh2OB--EZhGMN2KmRPy0A@mail.gmail.com>
Message-ID: <527EA42B.60806@telus.net>

Frank,

Things are better, now, but not quite there for me.
Still not able to transform pixel/line to PCS space.
(the listgeo dump is, below)

I think the problem is that there is no definition of the

ModelPixelScaleTag

It seems that this tag, together with the ModelTiepointTag,
is how an affine transformation is inferred.  Or by directly
setting

ModelTransformationTag

which I could do with GDALDataset's SetGeoTransform()
method (for defining 2D affine transformations).

The GTiffDataset class is hidden from users of GDAL,
being defined in the cpp file frmts/gtiff/geotiff.cpp .
Is there a way to directly set the tags of a GeoTIFF
GDAL Dataset?  Or, would this break GDAL's useful
ability of uniformly dealing with the many different
dataset formats?


------------------------

I changed the call to SetGCPs, as you suggested:

dataset->SetGCPs( 3,
                       gcps,
                       wkt )

where wkt is the equirectangular projection defined
below, in an earlier email.  Here is the listgeo dump:

////////////////////// listgeo dump /////////////////////////
Geotiff_Information:
    Version: 1
    Key_Revision: 1.0
    Tagged_Information:
       ModelTiepointTag (6,3):
          0                249              0
          0                0                0
          399              249              0
          1000             0                0
          0                0                0
          0                2000             0
       End_Of_Tags.
    Keyed_Information:
       GTModelTypeGeoKey (Short,1): ModelTypeProjected
       GTRasterTypeGeoKey (Short,1): RasterPixelIsPoint
       GTCitationGeoKey (Ascii,8): "NoWhere"
       GeographicTypeGeoKey (Short,1): GCS_WGS_84
       GeogCitationGeoKey (Ascii,7): "WGS 84"
       GeogAngularUnitsGeoKey (Short,1): Angular_Degree
       GeogSemiMajorAxisGeoKey (Double,1): 6378137
       GeogInvFlatteningGeoKey (Double,1): 298.257224
       ProjectedCSTypeGeoKey (Short,1): User-Defined
       ProjectionGeoKey (Short,1): User-Defined
       ProjCoordTransGeoKey (Short,1): CT_Equirectangular
       ProjLinearUnitsGeoKey (Short,1): Linear_Meter
       ProjStdParallel1GeoKey (Double,1): 0
       ProjFalseEastingGeoKey (Double,1): 0
       ProjFalseNorthingGeoKey (Double,1): 0
       ProjCenterLongGeoKey (Double,1): 0
       ProjCenterLatGeoKey (Double,1): 0
       End_Of_Keys.
    End_Of_Geotiff.

Projection Method: CT_Equirectangular
    ProjCenterLatGeoKey: 0.000000 (  0d 0' 0.00"N)
    ProjCenterLongGeoKey: 0.000000 (  0d 0' 0.00"E)
    ProjFalseEastingGeoKey: 0.000000 m
    ProjFalseNorthingGeoKey: 0.000000 m
GCS: 4326/WGS 84
Datum: 6326/World Geodetic System 1984
Ellipsoid: 7030/WGS 84 (6378137.00,6356752.31)
Prime Meridian: 8901/Greenwich (0.000000/  0d 0' 0.00"E)
Projection Linear Units: 9001/metre (1.000000m)

Corner Coordinates:
  ... unable to transform points between pixel/line and PCS space
////////////////////////////////////////////////////////////

This is much better, but, still missing the pixel/line <--> PCS
transformation (as noted, above).


On 11/07/2013 07:32 AM, Frank Warmerdam wrote:
> Norman,
>
> My apologies.  The GCP projection is actually supposed to be passed as 
> the third value in the SetGCPs call - where you have passed the string 
> "Richmond".  Instead pass the whole WKT strings for the coordinate system.
>
> Best regards,
> Frank
>
>
> On Wed, Nov 6, 2013 at 4:00 PM, Norman Goldstein <normvcr at telus.net 
> <mailto:normvcr at telus.net>> wrote:
>
>     Frank,
>
>     I am using GDAL
>     Version     : 1.9.2
>
>     so maybe that is why I do not see the method SetGCPProjection().
>
>     I think you have convinced me, though, to calculate the 6
>     coefficients directly,
>     and then call SetGeoTransform().  Will let you guys know how this
>     works out
>     for me.
>
>     Thank you,
>     Norm
>
>
>
>     On 11/06/2013 01:51 PM, Frank Warmerdam wrote:
>>     Norman,
>>
>>     I believe you want to call SetGCPProjection() instead of
>>     SetProjection() when using GCPs instead of an affine transform.
>>
>>     Best regards,
>>     Frank
>>
>>
>>
>>     On Wed, Nov 6, 2013 at 1:23 PM, Norman Goldstein
>>     <normvcr at telus.net <mailto:normvcr at telus.net>> wrote:
>>
>>         I have created a geotiff file using the "GTiff" driver, and
>>         have successfully set options for it to be a strips file with
>>         no compression.  Also, successfully called the functions
>>
>>         dataset->SetMetadataItem( "AREA_OR_POINT",
>>         "Point",
>>          nullptr ) )
>>
>>         and
>>
>>         dataset->SetGCPs( 3,
>>                                        gcps,
>>                                        "Richmond" )
>>
>>         Here is the listgeo dump:
>>
>>         ############# listgeo dump ##############
>>         Geotiff_Information:
>>            Version: 1
>>            Key_Revision: 1.0
>>            Tagged_Information:
>>               ModelTiepointTag (6,3):
>>                  0                249              0
>>                  0                0                0
>>                  399              249              0
>>                  1000             0                0
>>                  0                0                0
>>                  0                2000             0
>>               End_Of_Tags.
>>            Keyed_Information:
>>               GTRasterTypeGeoKey (Short,1): RasterPixelIsPoint
>>               End_Of_Keys.
>>            End_Of_Geotiff.
>>
>>
>>         Corner Coordinates:
>>          ... unable to transform points between pixel/line and PCS space
>>         #####################################
>>
>>         I also set the reference system using the following code:
>>
>>         /////////////////////// c++ code ////////////////////////////
>>           OGRSpatialReference oSRS;
>>           oSRS.SetProjCS( "NoWhere" );
>>           oSRS.SetWellKnownGeogCS( "WGS84" );
>>           oSRS.SetEquirectangular( 0.0,        // Centre lat
>>                        0.0,        // Centre lon
>>                        0.0,   // False Easting
>>                        0.0 ); // False Northing
>>
>>           char* wkt = nullptr;
>>
>>           if( OGRERR_NONE != oSRS.exportToPrettyWkt( &wkt ) )
>>           {
>>              error...
>>           }
>>
>>           if( CE_Failure == dataset->SetProjection( wkt ) )
>>           {
>>            error...
>>           }
>>         ///////////////////////////////////////////////////////////////
>>
>>         So, why is listgeo not able to transform points between
>>         pixel/line and PCS space?
>>
>>         I am happy to upload a full working example if needed.
>>
>>         Thank you.
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>         _______________________________________________
>>         gdal-dev mailing list
>>         gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>>         http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>
>>
>>
>>     -- 
>>     ---------------------------------------+--------------------------------------
>>     I set the clouds in motion - turn up   | Frank Warmerdam,
>>     warmerdam at pobox.com <mailto:warmerdam at pobox.com>
>>     light and sound - activate the windows |
>>     http://pobox.com/~warmerdam <http://pobox.com/%7Ewarmerdam>
>>     and watch the world go round - Rush    | Geospatial Software
>>     Developer
>
>
>     _______________________________________________
>     gdal-dev mailing list
>     gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>     http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
> -- 
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, 
> warmerdam at pobox.com <mailto:warmerdam at pobox.com>
> light and sound - activate the windows | http://pobox.com/~warmerdam 
> <http://pobox.com/%7Ewarmerdam>
> and watch the world go round - Rush    | Geospatial Software Developer

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131109/9f4b81e7/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4243 bytes
Desc: S/MIME Cryptographic Signature
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131109/9f4b81e7/attachment-0001.bin>

From even.rouault at mines-paris.org  Sat Nov  9 14:01:40 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 9 Nov 2013 23:01:40 +0100
Subject: [gdal-dev] writing XYZ file
In-Reply-To: <CAKf_S2J_yvOZh=5VqpCwVNBJLrOsvTULwsXNDRxezVe7AmnodQ@mail.gmail.com>
References: <CAKf_S2+YMjuBDgPDodZ51fP-Xa_dLyTGJB_VkQD6vYe-6dyMtQ@mail.gmail.com>
	<201311092112.37257.even.rouault@mines-paris.org>
	<CAKf_S2J_yvOZh=5VqpCwVNBJLrOsvTULwsXNDRxezVe7AmnodQ@mail.gmail.com>
Message-ID: <201311092301.40766.even.rouault@mines-paris.org>

Le samedi 09 novembre 2013 21:17:07, denis cohen a ?crit :
> Hi,
> 
> May be I wasn't clear. The x,y coordinates start from the lower left but
> not the elevation (z coord).

Well, it seems to work as expected with my test dataset. Are you sure about 
that ? Perhaps there's something particular with your dataset that I can't see 
at my end, although I don't see what could go wrong for you and not for me.

> 
> Denis
> 
> 
> 
> On Sat, Nov 9, 2013 at 9:12 PM, Even Rouault
> 
> <even.rouault at mines-paris.org>wrote:
> > Le samedi 09 novembre 2013 20:59:11, denis cohen a ?crit :
> > > Salut,
> > > 
> > > Almost there, it looks like the data is not inverted, it still starts
> > 
> > from
> > 
> > > the upper left corner instead of lower left.
> > 
> > Really ? Not in my testing.
> > 
> > $ gdalinfo ../autotest/gdrivers/data/small_world.tif
> > Driver: GTiff/GeoTIFF
> > Files: ../autotest/gdrivers/data/small_world.tif
> > Size is 400, 200
> > Coordinate System is:
> > GEOGCS["WGS 84",
> > 
> >     DATUM["WGS_1984",
> >     
> >         SPHEROID["WGS 84",6378137,298.257223563,
> >         
> >             AUTHORITY["EPSG","7030"]],
> >         
> >         AUTHORITY["EPSG","6326"]],
> >     
> >     PRIMEM["Greenwich",0],
> >     UNIT["degree",0.0174532925199433],
> >     AUTHORITY["EPSG","4326"]]
> > 
> > Origin = (-180.000000000000000,90.000000000000000)
> > Pixel Size = (0.900000000000000,-0.900000000000000)
> > 
> > Metadata:
> >   AREA_OR_POINT=Area
> > 
> > Image Structure Metadata:
> >   INTERLEAVE=BAND
> > 
> > Corner Coordinates:
> > Upper Left  (-180.0000000,  90.0000000) (180d 0' 0.00"W, 90d 0' 0.00"N)
> > Lower Left  (-180.0000000, -90.0000000) (180d 0' 0.00"W, 90d 0' 0.00"S)
> > Upper Right ( 180.0000000,  90.0000000) (180d 0' 0.00"E, 90d 0' 0.00"N)
> > Lower Right ( 180.0000000, -90.0000000) (180d 0' 0.00"E, 90d 0' 0.00"S)
> > Center      (   0.0000000,   0.0000000) (  0d 0' 0.01"E,  0d 0' 0.01"N)
> > 
> > $ python create_upsidedown_tif.py
> > ../autotest/gdrivers/data/small_world.tif reverse.tif
> > 
> > $ gdal_translate reverse.tif  out.xyz -of xyz
> > 
> > $ head out.xyz
> > -179.550000000000011 -89.5499999999999972 215
> > [...]
> > 
> > > Thanks
> > > 
> > > Denis
> > > 
> > > 
> > > 
> > > On Sat, Nov 9, 2013 at 8:46 PM, Even Rouault
> > > 
> > > <even.rouault at mines-paris.org>wrote:
> > > > Le samedi 09 novembre 2013 20:39:50, denis cohen a ?crit :
> > > > > Hi,
> > > > > 
> > > > > Thanks for the script. It works fine except for the actual data
> > > > 
> > > > (elevation
> > > > 
> > > > > in my case, this is a DEM).
> > > > > It does not write the correct values.
> > > > 
> > > > Ah right, this version only worked for Byte data type. The below
> > 
> > version
> > 
> > > > should work for any GDAL data type
> > > > 
> > > > ----- Begin of script invert.py ------
> > > > 
> > > > # -*- coding: utf-8 -*-
> > > > import sys
> > > > from osgeo import gdal
> > > > 
> > > > src_ds = gdal.Open(sys.argv[1])
> > > > xsize = src_ds.RasterXSize
> > > > ysize = src_ds.RasterYSize
> > > > bandcount = src_ds.RasterCount
> > > > datatype = src_ds.GetRasterBand(1).DataType
> > > > out_drv = gdal.GetDriverByName('GTiff')
> > > > out_ds = out_drv.Create(sys.argv[2], xsize, ysize, bandcount,
> > > > datatype) out_ds.SetProjection(src_ds.GetProjectionRef())
> > > > src_gt = src_ds.GetGeoTransform()
> > > > out_gt = [ src_gt[i] for i in range(6) ]
> > > > out_gt[3] = src_gt[3] + ysize * src_gt[5]
> > > > out_gt[5] = -src_gt[5]
> > > > out_ds.SetGeoTransform(out_gt)
> > > > 
> > > > for j in range(src_ds.RasterYSize):
> > > >     data = src_ds.ReadRaster(0, ysize - 1 - j, xsize, 1, buf_type =
> > > > 
> > > > datatype)
> > > > 
> > > >     out_ds.WriteRaster(0, j, xsize, 1, data, buf_type = datatype)
> > > > 
> > > > out_ds = None
> > > > src_ds = None
> > > > 
> > > > ----- End of script ------
> > > > 
> > > > > Merci
> > > > > 
> > > > > Denis
> > > > > 
> > > > > 
> > > > > 
> > > > > On Sat, Nov 9, 2013 at 8:02 PM, Even Rouault
> > > > > 
> > > > > <even.rouault at mines-paris.org>wrote:
> > > > > > Le samedi 09 novembre 2013 10:46:20, denis cohen a ?crit :
> > > > > > > Hello,
> > > > > > > 
> > > > > > > I am a new user of gdal.
> > > > > > > I used gdal_translate to convert a netcdf file to xyz:
> > > > > > > gdal_translate -of XYZ file.nc file.xyz
> > > > > > > 
> > > > > > > However, the xyz file starts with the upperleft coordinate.
> > > > > > > Is it possible to have it write the xyz file starting with the
> > > > > > > lower left coordinate?
> > > > > > 
> > > > > > Not directly although it wouldn't be complicated to add an option
> > 
> > to
> > 
> > > > > > do that.
> > > > > > 
> > > > > > You can try the following GDAL Python script that will create an
> > > > > > intermediary
> > > > > > TIFF image that has both inverted georeferencing and imagery in a
> > > > > > consistant
> > > > > > way.
> > > > > > 
> > > > > > python invert.py file.nc file_reserved.tif
> > > > > > gdal_translate -of XYZ file_reversed.tif file.xyz
> > > > > > 
> > > > > > 
> > > > > > ----- Begin of script invert.py ------
> > > > > > 
> > > > > > # -*- coding: utf-8 -*-
> > > > > > import sys
> > > > > > from osgeo import gdal
> > > > > > 
> > > > > > src_ds = gdal.Open(sys.argv[1])
> > > > > > xsize = src_ds.RasterXSize
> > > > > > ysize = src_ds.RasterYSize
> > > > > > bandcount = src_ds.RasterCount
> > > > > > out_drv = gdal.GetDriverByName('GTiff')
> > > > > > out_ds = out_drv.Create(sys.argv[2], xsize, ysize, bandcount)
> > > > > > out_ds.SetProjection(src_ds.GetProjectionRef())
> > > > > > src_gt = src_ds.GetGeoTransform()
> > > > > > out_gt = [ src_gt[i] for i in range(6) ]
> > > > > > out_gt[3] = src_gt[3] + ysize * src_gt[5]
> > > > > > out_gt[5] = -src_gt[5]
> > > > > > out_ds.SetGeoTransform(out_gt)
> > > > > > 
> > > > > > for j in range(src_ds.RasterYSize):
> > > > > >     data = src_ds.ReadRaster(0, ysize - 1 - j, xsize, 1)
> > > > > >     out_ds.WriteRaster(0, j, xsize, 1, data)
> > > > > > 
> > > > > > out_ds = None
> > > > > > src_ds = None
> > > > > > 
> > > > > > ----- End of script ------
> > > > > > 
> > > > > > Even
> > > > > > 
> > > > > > --
> > > > > > Geospatial professional services
> > > > > > http://even.rouault.free.fr/services.html
> > > > 
> > > > --
> > > > Geospatial professional services
> > > > http://even.rouault.free.fr/services.html
> > 
> > --
> > Geospatial professional services
> > http://even.rouault.free.fr/services.html

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From tpiepho at gmail.com  Sat Nov  9 15:14:42 2013
From: tpiepho at gmail.com (Trent Piepho)
Date: Sat, 9 Nov 2013 15:14:42 -0800
Subject: [gdal-dev] geotiff projection not showing up
In-Reply-To: <527EA42B.60806@telus.net>
References: <527AB33E.3050306@telus.net>
	<CA+YzLBdy+UVXK=fjZt6TNtYLtA2izcL2-hP20gecqv77De9jZA@mail.gmail.com>
	<527AD80C.8050507@telus.net>
	<CA+YzLBeuiJc1d3sZH5bTf9MbxQoyixh2OB--EZhGMN2KmRPy0A@mail.gmail.com>
	<527EA42B.60806@telus.net>
Message-ID: <CA+7tXijAe0DW1Z1kP_XrvGH+bzVn6wsga1gNd2Nv2P4_ATMZ7w@mail.gmail.com>

On Sat, Nov 9, 2013 at 1:07 PM, Norman Goldstein <normvcr at telus.net> wrote:
> Things are better, now, but not quite there for me.
> Still not able to transform pixel/line to PCS space.
> (the listgeo dump is, below)
>
> I think the problem is that there is no definition of the
>
> ModelPixelScaleTag
>
> It seems that this tag, together with the ModelTiepointTag,
> is how an affine transformation is inferred.  Or by directly
> setting
>
> ModelTransformationTag
>
> which I could do with GDALDataset's SetGeoTransform()
> method (for defining 2D affine transformations).

I've found that unless you call SetGeoTransform() and give an affine
transform, most apps, including listgeo and gdalsrsinfo, aren't
entirely happy with the georeferencing.  GDAL has a function that
computes a transform from GCPs, but it needs to be part of the GDAL
code for the dataset driver.  GDAL doesn't automatically do it when a
user of GDAL wants an affine transform from a dataset.

It seems like most code that tries to find corner coordinates and/or
the pixel size of a raster expects an affine transform plus a
projection.  If there are a set of GCPs, then that code won't work.
The information may well be there, like your three GCP points, but the
GDAL user needs totally different code make use of it.  It's the same
reason most of NOAA's nautical charts don't work with apps that use
GDAL or GDAL created GeoTIFFs.  I've just started looking at the GDAL
code, but it doesn't seem like GDAL abstracts this enough to have
broad compatibility.

From dcohen at iastate.edu  Sat Nov  9 20:27:40 2013
From: dcohen at iastate.edu (denis cohen)
Date: Sun, 10 Nov 2013 05:27:40 +0100
Subject: [gdal-dev] writing XYZ file
In-Reply-To: <201311092301.40766.even.rouault@mines-paris.org>
References: <CAKf_S2+YMjuBDgPDodZ51fP-Xa_dLyTGJB_VkQD6vYe-6dyMtQ@mail.gmail.com>
	<201311092112.37257.even.rouault@mines-paris.org>
	<CAKf_S2J_yvOZh=5VqpCwVNBJLrOsvTULwsXNDRxezVe7AmnodQ@mail.gmail.com>
	<201311092301.40766.even.rouault@mines-paris.org>
Message-ID: <CAKf_S2JxwUvVNZ-31fsDDnrSNZ9LLVypBFnsdw2kpRVR8ycxtg@mail.gmail.com>

Morning,
Sorry about this. You are right. It works. My mistake.
Thanks a lot for your help.
Denis



On Sat, Nov 9, 2013 at 11:01 PM, Even Rouault
<even.rouault at mines-paris.org>wrote:

> Le samedi 09 novembre 2013 21:17:07, denis cohen a ?crit :
> > Hi,
> >
> > May be I wasn't clear. The x,y coordinates start from the lower left but
> > not the elevation (z coord).
>
> Well, it seems to work as expected with my test dataset. Are you sure about
> that ? Perhaps there's something particular with your dataset that I can't
> see
> at my end, although I don't see what could go wrong for you and not for me.
>
> >
> > Denis
> >
> >
> >
> > On Sat, Nov 9, 2013 at 9:12 PM, Even Rouault
> >
> > <even.rouault at mines-paris.org>wrote:
> > > Le samedi 09 novembre 2013 20:59:11, denis cohen a ?crit :
> > > > Salut,
> > > >
> > > > Almost there, it looks like the data is not inverted, it still starts
> > >
> > > from
> > >
> > > > the upper left corner instead of lower left.
> > >
> > > Really ? Not in my testing.
> > >
> > > $ gdalinfo ../autotest/gdrivers/data/small_world.tif
> > > Driver: GTiff/GeoTIFF
> > > Files: ../autotest/gdrivers/data/small_world.tif
> > > Size is 400, 200
> > > Coordinate System is:
> > > GEOGCS["WGS 84",
> > >
> > >     DATUM["WGS_1984",
> > >
> > >         SPHEROID["WGS 84",6378137,298.257223563,
> > >
> > >             AUTHORITY["EPSG","7030"]],
> > >
> > >         AUTHORITY["EPSG","6326"]],
> > >
> > >     PRIMEM["Greenwich",0],
> > >     UNIT["degree",0.0174532925199433],
> > >     AUTHORITY["EPSG","4326"]]
> > >
> > > Origin = (-180.000000000000000,90.000000000000000)
> > > Pixel Size = (0.900000000000000,-0.900000000000000)
> > >
> > > Metadata:
> > >   AREA_OR_POINT=Area
> > >
> > > Image Structure Metadata:
> > >   INTERLEAVE=BAND
> > >
> > > Corner Coordinates:
> > > Upper Left  (-180.0000000,  90.0000000) (180d 0' 0.00"W, 90d 0' 0.00"N)
> > > Lower Left  (-180.0000000, -90.0000000) (180d 0' 0.00"W, 90d 0' 0.00"S)
> > > Upper Right ( 180.0000000,  90.0000000) (180d 0' 0.00"E, 90d 0' 0.00"N)
> > > Lower Right ( 180.0000000, -90.0000000) (180d 0' 0.00"E, 90d 0' 0.00"S)
> > > Center      (   0.0000000,   0.0000000) (  0d 0' 0.01"E,  0d 0' 0.01"N)
> > >
> > > $ python create_upsidedown_tif.py
> > > ../autotest/gdrivers/data/small_world.tif reverse.tif
> > >
> > > $ gdal_translate reverse.tif  out.xyz -of xyz
> > >
> > > $ head out.xyz
> > > -179.550000000000011 -89.5499999999999972 215
> > > [...]
> > >
> > > > Thanks
> > > >
> > > > Denis
> > > >
> > > >
> > > >
> > > > On Sat, Nov 9, 2013 at 8:46 PM, Even Rouault
> > > >
> > > > <even.rouault at mines-paris.org>wrote:
> > > > > Le samedi 09 novembre 2013 20:39:50, denis cohen a ?crit :
> > > > > > Hi,
> > > > > >
> > > > > > Thanks for the script. It works fine except for the actual data
> > > > >
> > > > > (elevation
> > > > >
> > > > > > in my case, this is a DEM).
> > > > > > It does not write the correct values.
> > > > >
> > > > > Ah right, this version only worked for Byte data type. The below
> > >
> > > version
> > >
> > > > > should work for any GDAL data type
> > > > >
> > > > > ----- Begin of script invert.py ------
> > > > >
> > > > > # -*- coding: utf-8 -*-
> > > > > import sys
> > > > > from osgeo import gdal
> > > > >
> > > > > src_ds = gdal.Open(sys.argv[1])
> > > > > xsize = src_ds.RasterXSize
> > > > > ysize = src_ds.RasterYSize
> > > > > bandcount = src_ds.RasterCount
> > > > > datatype = src_ds.GetRasterBand(1).DataType
> > > > > out_drv = gdal.GetDriverByName('GTiff')
> > > > > out_ds = out_drv.Create(sys.argv[2], xsize, ysize, bandcount,
> > > > > datatype) out_ds.SetProjection(src_ds.GetProjectionRef())
> > > > > src_gt = src_ds.GetGeoTransform()
> > > > > out_gt = [ src_gt[i] for i in range(6) ]
> > > > > out_gt[3] = src_gt[3] + ysize * src_gt[5]
> > > > > out_gt[5] = -src_gt[5]
> > > > > out_ds.SetGeoTransform(out_gt)
> > > > >
> > > > > for j in range(src_ds.RasterYSize):
> > > > >     data = src_ds.ReadRaster(0, ysize - 1 - j, xsize, 1, buf_type =
> > > > >
> > > > > datatype)
> > > > >
> > > > >     out_ds.WriteRaster(0, j, xsize, 1, data, buf_type = datatype)
> > > > >
> > > > > out_ds = None
> > > > > src_ds = None
> > > > >
> > > > > ----- End of script ------
> > > > >
> > > > > > Merci
> > > > > >
> > > > > > Denis
> > > > > >
> > > > > >
> > > > > >
> > > > > > On Sat, Nov 9, 2013 at 8:02 PM, Even Rouault
> > > > > >
> > > > > > <even.rouault at mines-paris.org>wrote:
> > > > > > > Le samedi 09 novembre 2013 10:46:20, denis cohen a ?crit :
> > > > > > > > Hello,
> > > > > > > >
> > > > > > > > I am a new user of gdal.
> > > > > > > > I used gdal_translate to convert a netcdf file to xyz:
> > > > > > > > gdal_translate -of XYZ file.nc file.xyz
> > > > > > > >
> > > > > > > > However, the xyz file starts with the upperleft coordinate.
> > > > > > > > Is it possible to have it write the xyz file starting with
> the
> > > > > > > > lower left coordinate?
> > > > > > >
> > > > > > > Not directly although it wouldn't be complicated to add an
> option
> > >
> > > to
> > >
> > > > > > > do that.
> > > > > > >
> > > > > > > You can try the following GDAL Python script that will create
> an
> > > > > > > intermediary
> > > > > > > TIFF image that has both inverted georeferencing and imagery
> in a
> > > > > > > consistant
> > > > > > > way.
> > > > > > >
> > > > > > > python invert.py file.nc file_reserved.tif
> > > > > > > gdal_translate -of XYZ file_reversed.tif file.xyz
> > > > > > >
> > > > > > >
> > > > > > > ----- Begin of script invert.py ------
> > > > > > >
> > > > > > > # -*- coding: utf-8 -*-
> > > > > > > import sys
> > > > > > > from osgeo import gdal
> > > > > > >
> > > > > > > src_ds = gdal.Open(sys.argv[1])
> > > > > > > xsize = src_ds.RasterXSize
> > > > > > > ysize = src_ds.RasterYSize
> > > > > > > bandcount = src_ds.RasterCount
> > > > > > > out_drv = gdal.GetDriverByName('GTiff')
> > > > > > > out_ds = out_drv.Create(sys.argv[2], xsize, ysize, bandcount)
> > > > > > > out_ds.SetProjection(src_ds.GetProjectionRef())
> > > > > > > src_gt = src_ds.GetGeoTransform()
> > > > > > > out_gt = [ src_gt[i] for i in range(6) ]
> > > > > > > out_gt[3] = src_gt[3] + ysize * src_gt[5]
> > > > > > > out_gt[5] = -src_gt[5]
> > > > > > > out_ds.SetGeoTransform(out_gt)
> > > > > > >
> > > > > > > for j in range(src_ds.RasterYSize):
> > > > > > >     data = src_ds.ReadRaster(0, ysize - 1 - j, xsize, 1)
> > > > > > >     out_ds.WriteRaster(0, j, xsize, 1, data)
> > > > > > >
> > > > > > > out_ds = None
> > > > > > > src_ds = None
> > > > > > >
> > > > > > > ----- End of script ------
> > > > > > >
> > > > > > > Even
> > > > > > >
> > > > > > > --
> > > > > > > Geospatial professional services
> > > > > > > http://even.rouault.free.fr/services.html
> > > > >
> > > > > --
> > > > > Geospatial professional services
> > > > > http://even.rouault.free.fr/services.html
> > >
> > > --
> > > Geospatial professional services
> > > http://even.rouault.free.fr/services.html
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131110/00471a22/attachment-0001.html>

From even.rouault at mines-paris.org  Sun Nov 10 01:43:56 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sun, 10 Nov 2013 10:43:56 +0100
Subject: [gdal-dev] geotiff projection not showing up
In-Reply-To: <CA+7tXijAe0DW1Z1kP_XrvGH+bzVn6wsga1gNd2Nv2P4_ATMZ7w@mail.gmail.com>
References: <527AB33E.3050306@telus.net> <527EA42B.60806@telus.net>
	<CA+7tXijAe0DW1Z1kP_XrvGH+bzVn6wsga1gNd2Nv2P4_ATMZ7w@mail.gmail.com>
Message-ID: <201311101043.57128.even.rouault@mines-paris.org>

Le dimanche 10 novembre 2013 00:14:42, Trent Piepho a ?crit :
> On Sat, Nov 9, 2013 at 1:07 PM, Norman Goldstein <normvcr at telus.net> wrote:
> > Things are better, now, but not quite there for me.
> > Still not able to transform pixel/line to PCS space.
> > (the listgeo dump is, below)
> > 
> > I think the problem is that there is no definition of the
> > 
> > ModelPixelScaleTag
> > 
> > It seems that this tag, together with the ModelTiepointTag,
> > is how an affine transformation is inferred.  Or by directly
> > setting
> > 
> > ModelTransformationTag
> > 
> > which I could do with GDALDataset's SetGeoTransform()
> > method (for defining 2D affine transformations).
> 
> I've found that unless you call SetGeoTransform() and give an affine
> transform, most apps, including listgeo and gdalsrsinfo, aren't
> entirely happy with the georeferencing.  GDAL has a function that
> computes a transform from GCPs, but it needs to be part of the GDAL
> code for the dataset driver.  GDAL doesn't automatically do it when a
> user of GDAL wants an affine transform from a dataset.

True. This is (I think) a design decision, as generally GDAL tries to expose 
information as close as possible to what is in the dataset. GCPs alone don't 
provide an unambiguous way of transforming image pixel coordinates into real-
world coordinates. You have to specify which extrapolation method you want to 
use : polynomial at which order, thin plate spline, .. 

Of course with 3 points, you can (but not necessarily must) compute an affine 
transform in an unambiguous way, but in that case you'd rather define the 6 
coefficient geotransform directly.

And I've worked with a mapping authority that forbids from implicitly using 
the tiepoints from a GeoTIFF to compute a geotransform.

Depending on the cases, GDAL drivers might choose to compute an approximate 
geotransform from the GCPs, but GDAL core will not make that behind their 
back.

> 
> It seems like most code that tries to find corner coordinates and/or
> the pixel size of a raster expects an affine transform plus a
> projection.  If there are a set of GCPs, then that code won't work.
> The information may well be there, like your three GCP points, but the
> GDAL user needs totally different code make use of it.  It's the same
> reason most of NOAA's nautical charts don't work with apps that use
> GDAL or GDAL created GeoTIFFs.  I've just started looking at the GDAL
> code, but it doesn't seem like GDAL abstracts this enough to have
> broad compatibility.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From antticastren at gmail.com  Mon Nov 11 00:27:54 2013
From: antticastren at gmail.com (=?ISO-8859-1?Q?Antti_Castr=E9n?=)
Date: Mon, 11 Nov 2013 10:27:54 +0200
Subject: [gdal-dev] [PATCH v2] Support Mercator_2SP in GeoTIFF
Message-ID: <CAPcvoOJctLnpVBa=X9V0HHELv1vvRjbGzhuHNc0zsNptUkNrfw@mail.gmail.com>

Hello Trent, Even et al.



Your work and comments on GeoTIFF and Mercator 2sp hopefully addresses the
problem I ran into few years ago. I wrote a description to ESRI's forums
with extracts of header information by ArcGIS and Geomedia. The postings
are at:

http://forums.arcgis.com/threads/24850-Projection-problem-with-GeoTIFFs-and-Mercator



Since then I have seen the similar behavior in other software also. It
confuses my geodesist-engineer-brain a little to see the terms latitude of
origin, latitude of true scale, standard parallel and natural origin
latitude used more or less interchangeably...



If you need volunteer for testing the patch or to give more insight to the
problem I am more than willing. Hopefully the software vendors follow the
resulting changes in specs.



To circumvent the whole problem I have advised my colleagues to reproject
their future Mercator_2sp GeoTIFFs to the Equator. This way the scale
problem disappears since both latitude parameter values are in fact 0. In
addition they can then use predefined CRS-code EPSG::3395, because nautical
charts are nowadays by international standards published using WGS84 as
horizontal datum.



Cheers,



  Antti
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131111/29f0557c/attachment.html>

From Moses.Gone at t-systems.com  Mon Nov 11 02:31:15 2013
From: Moses.Gone at t-systems.com (Moses.Gone at t-systems.com)
Date: Mon, 11 Nov 2013 11:31:15 +0100
Subject: [gdal-dev] gdal_translate produces tif with different colors as
 original
In-Reply-To: <BLU175-W115588E1C0D1548122277FB2FD0@phx.gbl>
References: <2D55B4FBCD59D045AC382D3F65435B7903843AD77DF3@HE101453.emea1.cds.t-internal.com>,
	<loom.20131106T211413-94@post.gmane.org>, <l5gehg$2se$2@ger.gmane.org>
	<BLU175-W115588E1C0D1548122277FB2FD0@phx.gbl>
Message-ID: <2D55B4FBCD59D045AC382D3F65435B7903843AEB8BB3@HE101453.emea1.cds.t-internal.com>

Hello Marius,
Actually am not sure as my colleague did the actual test. But we tried visualization also in QGIS and had the same result as ArcMap. I will check this again and let you know. In the mean time, we decided to follow Andre? s approach to strip the VRT off the wrong palette and then apply the right palette.

Thanks and regards,
Moses

From: gdal-dev-bounces at lists.osgeo.org [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Marius Jigmond
Sent: 09 November 2013 03:43
To: Andre Joost; gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] gdal_translate produces tif with different colors as original

I noticed you're using ArcMap for visualizing the results. Did you check what histogram/gamma stretch gets applied by default when you load the layer? I run into this issue often as results from GDAL operations appear much worse when loaded into ArcMap compared to originals. When I turn off stretching, both histogram/gamma, results are nearly identical to original.

-marius
> To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
> From: andre+joost at nurfuerspam.de<mailto:andre+joost at nurfuerspam.de>
> Date: Thu, 7 Nov 2013 16:54:32 +0100
> Subject: Re: [gdal-dev] gdal_translate produces tif with different colors as original
>
> Am 06.11.2013 21:32, schrieb Jukka Rahkonen:
>
> > You're advised to preprocess your rasters with other
> > tools, such as pct2rgb.py or gdal_translate -expand RGB to operate
> > gdalbuildvrt on RGB rasters instead."
> >
>
> I proposed that, but have a look at the color palette of the VRT:
>
> <http://gis.stackexchange.com/questions/76662/gdal-translate-produces-tif-with-different-colors-as-original>
>
> Is it a fault of the source or the driver?
>
> Greetings,
> Andr? Joost
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131111/3cc7dc45/attachment.html>

From james at agritech.co.uk  Mon Nov 11 04:07:42 2013
From: james at agritech.co.uk (JSz)
Date: Mon, 11 Nov 2013 04:07:42 -0800 (PST)
Subject: [gdal-dev] Create PNG / TIFF with referenced KML/KMZ file from non
 regular X, Y, Z data
Message-ID: <1384171662426-5088516.post@n6.nabble.com>

Good morning all,

I wish to use the OGR tools to create an interpolated image which is trimmed
to a boundary provided.

The boundary is currently in X,Y in a mySQL database

The X,Y,Z data is in a CSV

So I have started on the route of using GDAL_GRID to initially rasterize my
data with the VRT file :

<OGRVRTDataSource>
<OGRVRTLayer name="data">
<SrcDataSource>data.csv</SrcDataSource>
<GeometryType>wkbPoint</GeometryType>
<LayerSRS>WGS84</LayerSRS>
<GeometryField separator=" " encoding="PointFromColumns" x="lat" y="lon"
z="alt"/>
</OGRVRTLayer>
</OGRVRTDataSource>


and the command line : 

gdal_grid -ot byte -of BMP -zfield alt -l data dem.vrt test_data.bmp


I had to set to byte and BMP as thats the only format that would output
something which has variable data, everything else was either a white image
or black image.

So now I have a grey scale image with 'some' variation in it which is
expanded to the extremities of my data ( which is currently oritentated
wrong by I'm sure I can correct with translate) , I would like to now build
upon this to create a custom colour palette ( red through to green ) and
trim the whole lot to either the outside of the point data or ability to
specify a boundary to clip to.

So what I'm really asking :

How do I apply a 'pretty' color scheme
How do I do trim the image to my boundary

Many thanks

James







--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Create-PNG-TIFF-with-referenced-KML-KMZ-file-from-non-regular-X-Y-Z-data-tp5088516.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From james at agritech.co.uk  Mon Nov 11 05:11:47 2013
From: james at agritech.co.uk (JSz)
Date: Mon, 11 Nov 2013 05:11:47 -0800 (PST)
Subject: [gdal-dev] Create PNG / TIFF with referenced KML/KMZ file from
 non regular X, Y, Z data
In-Reply-To: <1384171662426-5088516.post@n6.nabble.com>
References: <1384171662426-5088516.post@n6.nabble.com>
Message-ID: <1384175507634-5088524.post@n6.nabble.com>

after opening my generated PNG and geoTiff images in QGIS they render fine
but as the end intention is to overlay them in the google maps API using
javascript they obviously need to be to displayed natively



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Create-PNG-TIFF-with-referenced-KML-KMZ-file-from-non-regular-X-Y-Z-data-tp5088516p5088524.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From achrysochoou at hotmail.com  Mon Nov 11 08:37:55 2013
From: achrysochoou at hotmail.com (achrysochoou)
Date: Mon, 11 Nov 2013 08:37:55 -0800 (PST)
Subject: [gdal-dev] Can I resume gdal_retile?
Message-ID: <1384187875321-5088569.post@n6.nabble.com>

I used gdal_retile on a 5TB data set and the server crashed during the
weekend. 
Is it possible to resume the process and keep what has been done?
What will happen if I start the process again? Will it over-write or ignore
previously created data?




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Can-I-resume-gdal-retile-tp5088569.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at mines-paris.org  Mon Nov 11 09:02:12 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 11 Nov 2013 18:02:12 +0100
Subject: [gdal-dev] Can I resume gdal_retile?
In-Reply-To: <1384187875321-5088569.post@n6.nabble.com>
References: <1384187875321-5088569.post@n6.nabble.com>
Message-ID: <201311111802.12903.even.rouault@mines-paris.org>

Le lundi 11 novembre 2013 17:37:55, achrysochoou a ?crit :
> I used gdal_retile on a 5TB data set and the server crashed during the
> weekend.
> Is it possible to resume the process and keep what has been done?

Not currently, but you can try the attached modified script (very lightly 
tested) that should skip existing tiles. Not however that if a tile has been 
only partly written at the time of the crash, it could consider it as being 
completely written and would not try to regenerate it.

> What will happen if I start the process again? Will it over-write or ignore
> previously created data?

The current script would over-write existing tiles.

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: gdal_retile.py
Type: text/x-python
Size: 31315 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131111/bc138e59/attachment-0001.py>

From achrysochoou at hotmail.com  Mon Nov 11 09:45:57 2013
From: achrysochoou at hotmail.com (achrysochoou)
Date: Mon, 11 Nov 2013 09:45:57 -0800 (PST)
Subject: [gdal-dev] Can I resume gdal_retile?
In-Reply-To: <201311111802.12903.even.rouault@mines-paris.org>
References: <1384187875321-5088569.post@n6.nabble.com>
	<201311111802.12903.even.rouault@mines-paris.org>
Message-ID: <1384191957089-5088589.post@n6.nabble.com>

Thank you for the gdal_retile.py script. 
I will delete the last created folder, give it a try and post back. 




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Can-I-resume-gdal-retile-tp5088569p5088589.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From normvcr at telus.net  Mon Nov 11 11:46:47 2013
From: normvcr at telus.net (Norman Goldstein)
Date: Mon, 11 Nov 2013 11:46:47 -0800
Subject: [gdal-dev] geotiff projection not showing up
In-Reply-To: <CA+7tXijAe0DW1Z1kP_XrvGH+bzVn6wsga1gNd2Nv2P4_ATMZ7w@mail.gmail.com>
References: <527AB33E.3050306@telus.net>	<CA+YzLBdy+UVXK=fjZt6TNtYLtA2izcL2-hP20gecqv77De9jZA@mail.gmail.com>	<527AD80C.8050507@telus.net>	<CA+YzLBeuiJc1d3sZH5bTf9MbxQoyixh2OB--EZhGMN2KmRPy0A@mail.gmail.com>	<527EA42B.60806@telus.net>
	<CA+7tXijAe0DW1Z1kP_XrvGH+bzVn6wsga1gNd2Nv2P4_ATMZ7w@mail.gmail.com>
Message-ID: <52813427.8050109@telus.net>

Frank and Trent,

I have created a proper GeoTIFF file with the code
listed, below.  There is still one oddity:
The code sets the   line/sample --> x/y   affine transformation
using an array of 6 doubles.  The code contains a conditional
compilation that chooses between two different arrays of
6 doubles.

The #if 1 array produces a full listgeo dump.
The #else listgeo dump is missing the corner coordinates.

The difference between the two arrays is
-- The false northing for #if 1 is  0.001 .
-- The false northing for #else  is  0

Is this a quirk of GDAL?  of listeo?  Or, should map x,y
always be set up to take on only positive values?


/////////////////////// full source code ///////////////////////////
#include <iostream>
#include "ogr_spatialref.h"
#include "gdal_priv.h"

int main( int argc, char* argv[] )
{
   using namespace std;

   GDALAllRegister();
   GDALDriverManager* dmgr = GetGDALDriverManager();

   GDALDriver* drv =
     dmgr->GetDriverByName( "GTiff" );

   if( nullptr == drv )
   {
     cerr << "Error from GetDriverByName" << endl;
     return -3;
   }

   GDALDataset* dataset = drv->Create( "dem.tif",
                       300,
                       200,
                       1,             // Num bands
                       GDT_Float32,
                       nullptr );
   if( nullptr == dataset )
   {
     cerr << "Error from Create" << endl;
     return -4;
   }

   OGRSpatialReference oSRS;
   oSRS.SetProjCS( "NoWhere" );
   oSRS.SetWellKnownGeogCS( "WGS84" );
   oSRS.SetEquirectangular( 0.0,        // Centre lat
                0.0,        // Centre lon
                0.0,   // False Easting
                0.0 ); // False Northing

   char* wkt = nullptr;

   if( OGRERR_NONE != oSRS.exportToWkt( &wkt ) )
   {
     cerr << "Error from exportToWkt" << endl;
     return -5;
   }

   cout << "WKT= " << wkt << endl;

#if 1
   double coeffs[] = { 0.0, 1.0, 0.0,
               0.001, 0.0, -1.0 };
#else
   double coeffs[] = { 0.0, 1.0, 0.0,
               0.0, 0.0, -1.0 };
#endif

   if( CE_None != dataset->SetGeoTransform( coeffs ) )
   {
     cerr << "Error from SetGeoTransform" << endl;
     return -6;
   }

   if( CE_None != dataset->SetProjection( wkt ) )
   {
     cerr << "Error from SetProjection" << endl;
     return -7;
   }

   OGRFree( wkt );
   wkt = nullptr;

   GDALClose( dataset );
   dataset = nullptr;
}// main
///////////////////////////////////////////////////////

############# full listgeo dump ###############
Geotiff_Information:
    Version: 1
    Key_Revision: 1.0
    Tagged_Information:
       ModelTiepointTag (2,3):
          0                0                0
          0                0.001            0
       ModelPixelScaleTag (1,3):
          1                1                0
       End_Of_Tags.
    Keyed_Information:
       GTModelTypeGeoKey (Short,1): ModelTypeProjected
       GTRasterTypeGeoKey (Short,1): RasterPixelIsArea
       GTCitationGeoKey (Ascii,8): "NoWhere"
       GeographicTypeGeoKey (Short,1): GCS_WGS_84
       GeogCitationGeoKey (Ascii,7): "WGS 84"
       GeogAngularUnitsGeoKey (Short,1): Angular_Degree
       GeogSemiMajorAxisGeoKey (Double,1): 6378137
       GeogInvFlatteningGeoKey (Double,1): 298.257224
       ProjectedCSTypeGeoKey (Short,1): User-Defined
       ProjectionGeoKey (Short,1): User-Defined
       ProjCoordTransGeoKey (Short,1): CT_Equirectangular
       ProjLinearUnitsGeoKey (Short,1): Linear_Meter
       ProjStdParallel1GeoKey (Double,1): 0
       ProjFalseEastingGeoKey (Double,1): 0
       ProjFalseNorthingGeoKey (Double,1): 0
       ProjCenterLongGeoKey (Double,1): 0
       ProjCenterLatGeoKey (Double,1): 0
       End_Of_Keys.
    End_Of_Geotiff.

Projection Method: CT_Equirectangular
    ProjCenterLatGeoKey: 0.000000 (  0d 0' 0.00"N)
    ProjCenterLongGeoKey: 0.000000 (  0d 0' 0.00"E)
    ProjFalseEastingGeoKey: 0.000000 m
    ProjFalseNorthingGeoKey: 0.000000 m
GCS: 4326/WGS 84
Datum: 6326/World Geodetic System 1984
Ellipsoid: 7030/WGS 84 (6378137.00,6356752.31)
Prime Meridian: 8901/Greenwich (0.000000/  0d 0' 0.00"E)
Projection Linear Units: 9001/metre (1.000000m)

Corner Coordinates:
Upper Left    (       0.000,       0.001)  (  0d 0' 0.00"E,  0d 0' 0.00"N)
Lower Left    (       0.000,    -199.999)  (  0d 0' 0.00"E,  0d 0' 6.47"S)
Upper Right   (     300.000,       0.001)  (  0d 0' 9.70"E,  0d 0' 0.00"N)
Lower Right   (     300.000,    -199.999)  (  0d 0' 9.70"E,  0d 0' 6.47"S)
Center        (     150.000,     -99.999)  (  0d 0' 4.85"E,  0d 0' 3.23"S)
########################################


On 11/09/2013 03:14 PM, Trent Piepho wrote:
> On Sat, Nov 9, 2013 at 1:07 PM, Norman Goldstein <normvcr at telus.net> wrote:
>> Things are better, now, but not quite there for me.
>> Still not able to transform pixel/line to PCS space.
>> (the listgeo dump is, below)
>>
>> I think the problem is that there is no definition of the
>>
>> ModelPixelScaleTag
>>
>> It seems that this tag, together with the ModelTiepointTag,
>> is how an affine transformation is inferred.  Or by directly
>> setting
>>
>> ModelTransformationTag
>>
>> which I could do with GDALDataset's SetGeoTransform()
>> method (for defining 2D affine transformations).
> I've found that unless you call SetGeoTransform() and give an affine
> transform, most apps, including listgeo and gdalsrsinfo, aren't
> entirely happy with the georeferencing.  GDAL has a function that
> computes a transform from GCPs, but it needs to be part of the GDAL
> code for the dataset driver.  GDAL doesn't automatically do it when a
> user of GDAL wants an affine transform from a dataset.
>
> It seems like most code that tries to find corner coordinates and/or
> the pixel size of a raster expects an affine transform plus a
> projection.  If there are a set of GCPs, then that code won't work.
> The information may well be there, like your three GCP points, but the
> GDAL user needs totally different code make use of it.  It's the same
> reason most of NOAA's nautical charts don't work with apps that use
> GDAL or GDAL created GeoTIFFs.  I've just started looking at the GDAL
> code, but it doesn't seem like GDAL abstracts this enough to have
> broad compatibility.
>


-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4243 bytes
Desc: S/MIME Cryptographic Signature
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131111/88391feb/attachment.bin>

From even.rouault at mines-paris.org  Mon Nov 11 12:06:53 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 11 Nov 2013 21:06:53 +0100
Subject: [gdal-dev] geotiff projection not showing up
In-Reply-To: <52813427.8050109@telus.net>
References: <527AB33E.3050306@telus.net>
	<CA+7tXijAe0DW1Z1kP_XrvGH+bzVn6wsga1gNd2Nv2P4_ATMZ7w@mail.gmail.com>
	<52813427.8050109@telus.net>
Message-ID: <201311112106.53539.even.rouault@mines-paris.org>

Le lundi 11 novembre 2013 20:46:47, Norman Goldstein a ?crit :
> Frank and Trent,
> 
> I have created a proper GeoTIFF file with the code
> listed, below.  There is still one oddity:
> The code sets the   line/sample --> x/y   affine transformation
> using an array of 6 doubles.  The code contains a conditional
> compilation that chooses between two different arrays of
> 6 doubles.
> 
> The #if 1 array produces a full listgeo dump.
> The #else listgeo dump is missing the corner coordinates.
> 
> The difference between the two arrays is
> -- The false northing for #if 1 is  0.001 .
> -- The false northing for #else  is  0
> 
> Is this a quirk of GDAL?  of listeo?  Or, should map x,y
> always be set up to take on only positive values?

The GDAL GTiff driver considers that the  {0.0, 1.0, 0.0, 0.0, 0.0, -1.0} 
geotransform as indicating that the image is not georeferenced (identity 
geotransform). This is not something that you are likely to use in real-world 
situations.

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From bobc at bluemarblegeo.com  Wed Nov 13 12:13:16 2013
From: bobc at bluemarblegeo.com (Bob Cave)
Date: Wed, 13 Nov 2013 12:13:16 -0800 (PST)
Subject: [gdal-dev] Getting SRID from MS SQL Server Spatial Table
Message-ID: <1384373595999-5089019.post@n6.nabble.com>

Hello,

I am using the MS SQL Server driver (1.10.1) with
MSSQLSPATIAL_USE_GEOMETRY_COLUMNS=NO.  When I attempt to read a table, I
find that the driver does not identify the spatial reference the table is
using.  Is there a way to get the driver to query for the SRID?

When I use MSSQLSPATIAL_USE_GEOMETRY_COLUMNS=YES, then the SRID can be
identified.  This is fine for my test database, but I need to be able to
support databases that don't have a geometry_columns table.

Thanks,

Bob



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Getting-SRID-from-MS-SQL-Server-Spatial-Table-tp5089019.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From szekerest at gmail.com  Wed Nov 13 13:25:24 2013
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed, 13 Nov 2013 22:25:24 +0100
Subject: [gdal-dev] Getting SRID from MS SQL Server Spatial Table
In-Reply-To: <1384373595999-5089019.post@n6.nabble.com>
References: <1384373595999-5089019.post@n6.nabble.com>
Message-ID: <CACALY+S7SA6qB2EPqVp12oUusQmnd52Z1XcsX5_YjVTuy5ZDbg@mail.gmail.com>

Bob,

You should specify the SRID as the attribute in the geometries in the
database table, which should also set the spatial reference of the layer.

Best regards,

Tamas



2013/11/13 Bob Cave <bobc at bluemarblegeo.com>

> Hello,
>
> I am using the MS SQL Server driver (1.10.1) with
> MSSQLSPATIAL_USE_GEOMETRY_COLUMNS=NO.  When I attempt to read a table, I
> find that the driver does not identify the spatial reference the table is
> using.  Is there a way to get the driver to query for the SRID?
>
> When I use MSSQLSPATIAL_USE_GEOMETRY_COLUMNS=YES, then the SRID can be
> identified.  This is fine for my test database, but I need to be able to
> support databases that don't have a geometry_columns table.
>
> Thanks,
>
> Bob
>
>
>
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/Getting-SRID-from-MS-SQL-Server-Spatial-Table-tp5089019.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131113/ef21a94e/attachment.html>

From bobc at bluemarblegeo.com  Wed Nov 13 13:40:50 2013
From: bobc at bluemarblegeo.com (Bob Cave)
Date: Wed, 13 Nov 2013 13:40:50 -0800 (PST)
Subject: [gdal-dev] Getting SRID from MS SQL Server Spatial Table
In-Reply-To: <CACALY+S7SA6qB2EPqVp12oUusQmnd52Z1XcsX5_YjVTuy5ZDbg@mail.gmail.com>
References: <1384373595999-5089019.post@n6.nabble.com>
	<CACALY+S7SA6qB2EPqVp12oUusQmnd52Z1XcsX5_YjVTuy5ZDbg@mail.gmail.com>
Message-ID: <1384378850927-5089033.post@n6.nabble.com>

Tamas,

Thank you for the quick reply.

My code is reading a table, so I am trying to identify the SRID that was
used when the table was created and the geometries were added to the table. 
How do I query the SRID from the geometry in the table?  The MS SQL Server
driver does this when it is reading the geometry_columns table, but when the
driver is not using the geometry_columns table, it does not attempt to
identify the SRID. I am trying to determine how I can do this myself.

Thanks,

Bob


Tamas Szekeres wrote
> Bob,
> 
> You should specify the SRID as the attribute in the geometries in the
> database table, which should also set the spatial reference of the layer.
> 
> Best regards,
> 
> Tamas
> 
> 
> 
> 2013/11/13 Bob Cave &lt;

> bobc@

> &gt;
> 
>> Hello,
>>
>> I am using the MS SQL Server driver (1.10.1) with
>> MSSQLSPATIAL_USE_GEOMETRY_COLUMNS=NO.  When I attempt to read a table, I
>> find that the driver does not identify the spatial reference the table is
>> using.  Is there a way to get the driver to query for the SRID?
>>
>> When I use MSSQLSPATIAL_USE_GEOMETRY_COLUMNS=YES, then the SRID can be
>> identified.  This is fine for my test database, but I need to be able to
>> support databases that don't have a geometry_columns table.
>>
>> Thanks,
>>
>> Bob
>>
>>
>>
>> --
>> View this message in context:
>> http://osgeo-org.1560.x6.nabble.com/Getting-SRID-from-MS-SQL-Server-Spatial-Table-tp5089019.html
>> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>> _______________________________________________
>> gdal-dev mailing list
>> 

> gdal-dev at .osgeo

>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> http://lists.osgeo.org/mailman/listinfo/gdal-dev





--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Getting-SRID-from-MS-SQL-Server-Spatial-Table-tp5089019p5089033.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From szekerest at gmail.com  Wed Nov 13 14:00:17 2013
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed, 13 Nov 2013 23:00:17 +0100
Subject: [gdal-dev] Getting SRID from MS SQL Server Spatial Table
In-Reply-To: <1384378850927-5089033.post@n6.nabble.com>
References: <1384373595999-5089019.post@n6.nabble.com>
	<CACALY+S7SA6qB2EPqVp12oUusQmnd52Z1XcsX5_YjVTuy5ZDbg@mail.gmail.com>
	<1384378850927-5089033.post@n6.nabble.com>
Message-ID: <CACALY+QsxmJcnVedQz1EecQpKKr7GJquiv5K6M9xfs+q_+39vQ@mail.gmail.com>

The driver is doing something like:

select top 1 ogr_geometry.STSrid from [mytable]

Best regards,

Tamas



2013/11/13 Bob Cave <bobc at bluemarblegeo.com>

> Tamas,
>
> Thank you for the quick reply.
>
> My code is reading a table, so I am trying to identify the SRID that was
> used when the table was created and the geometries were added to the table.
> How do I query the SRID from the geometry in the table?  The MS SQL Server
> driver does this when it is reading the geometry_columns table, but when
> the
> driver is not using the geometry_columns table, it does not attempt to
> identify the SRID. I am trying to determine how I can do this myself.
>
> Thanks,
>
> Bob
>
>
> Tamas Szekeres wrote
> > Bob,
> >
> > You should specify the SRID as the attribute in the geometries in the
> > database table, which should also set the spatial reference of the layer.
> >
> > Best regards,
> >
> > Tamas
> >
> >
> >
> > 2013/11/13 Bob Cave &lt;
>
> > bobc@
>
> > &gt;
> >
> >> Hello,
> >>
> >> I am using the MS SQL Server driver (1.10.1) with
> >> MSSQLSPATIAL_USE_GEOMETRY_COLUMNS=NO.  When I attempt to read a table, I
> >> find that the driver does not identify the spatial reference the table
> is
> >> using.  Is there a way to get the driver to query for the SRID?
> >>
> >> When I use MSSQLSPATIAL_USE_GEOMETRY_COLUMNS=YES, then the SRID can be
> >> identified.  This is fine for my test database, but I need to be able to
> >> support databases that don't have a geometry_columns table.
> >>
> >> Thanks,
> >>
> >> Bob
> >>
> >>
> >>
> >> --
> >> View this message in context:
> >>
> http://osgeo-org.1560.x6.nabble.com/Getting-SRID-from-MS-SQL-Server-Spatial-Table-tp5089019.html
> >> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> >> _______________________________________________
> >> gdal-dev mailing list
> >>
>
> > gdal-dev at .osgeo
>
> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >>
> >
> > _______________________________________________
> > gdal-dev mailing list
>
> > gdal-dev at .osgeo
>
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
>
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/Getting-SRID-from-MS-SQL-Server-Spatial-Table-tp5089019p5089033.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131113/230a6041/attachment.html>

From tpiepho at gmail.com  Wed Nov 13 15:21:45 2013
From: tpiepho at gmail.com (Trent Piepho)
Date: Wed, 13 Nov 2013 15:21:45 -0800
Subject: [gdal-dev] [PATCH v2] Support Mercator_2SP in GeoTIFF
In-Reply-To: <CAPcvoOJctLnpVBa=X9V0HHELv1vvRjbGzhuHNc0zsNptUkNrfw@mail.gmail.com>
References: <CAPcvoOJctLnpVBa=X9V0HHELv1vvRjbGzhuHNc0zsNptUkNrfw@mail.gmail.com>
Message-ID: <CA+7tXiga3wM_eQnb4vg=aPEpJnDNa3b+HRyhEwDkDighMFfe=g@mail.gmail.com>

It looks like arcgis does not support Mercator_1SP in geotiff files.
It just ignores the scale factor and uses 1.0.  Which means in GDAL
and libgeotiff as they are now, there is no way to export Mercator
projections that don't have a scale of 1.0 to arcgis.

ArcGIS does support Mercator_2SP, but instead of placing the latitude
of true scale in ProjStdParallel1GeoKey, it uses
ProjNatOriginLatGeoKey.  Which seems to be plainly wrong, yet that's
what it does.

I wonder if ESRI used libgeotiff?  With unpatched libgeotiff, the only
way to get a latitude from a Mercator geotiff it to use one of the
origin latitude GeoKeys.  It's not correct, but it does allow one to
stick the number in the file and get it back out without having to
modify or understand any libgeotiff code.

It's possible that ArcGIS supports getting the latitude of true scale
from ProjStdParallel1GeoKey, even it it doesn't store it there.
Antii, could you test this file with ArcGIS?

https://drive.google.com/file/d/0BybuTedE9CLxak9iakZRTC00cHM/edit?usp=sharing

Pick file->download to get the geotiff file.

It should have projection information like this:
    PROJECTION["Mercator_2SP"],
    PARAMETER["standard_parallel_1",47.667],
    PARAMETER["central_meridian",0],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]]]
Origin = (-9278434.534151820465922,4143530.208984711207449)
Pixel Size = (240.003786961970206,-240.003786961970206)
Corner Coordinates:
Upper Left  (-9278434.534, 4143530.209) (123d32'26.22"W, 48d23'56.59"N)
Lower Left  (-9278434.534, 3984167.694) (123d32'26.22"W, 46d57'58.64"N)
Upper Right (-9165872.758, 4143530.209) (122d 2'30.76"W, 48d23'56.59"N)
Lower Right (-9165872.758, 3984167.694) (122d 2'30.76"W, 46d57'58.64"N)
Center      (-9222153.646, 4063848.952) (122d47'28.49"W, 47d41'15.43"N)

From eadam at co.lincoln.or.us  Wed Nov 13 21:21:08 2013
From: eadam at co.lincoln.or.us (Eli Adam)
Date: Wed, 13 Nov 2013 21:21:08 -0800
Subject: [gdal-dev] Using/citing GDAL documentation
In-Reply-To: <CABG0rfunvEu=yUvXjf39ZsBvrOZnky50KVUMhOaPvtvT=MRsGw@mail.gmail.com>
References: <CABG0rfunvEu=yUvXjf39ZsBvrOZnky50KVUMhOaPvtvT=MRsGw@mail.gmail.com>
Message-ID: <CACqBkM86Nfw2uCWdH3s6viLtxEXXRgTCcRX2ypWFvm4acP8B-A@mail.gmail.com>

On Fri, Oct 18, 2013 at 6:13 PM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
> GDALers:
>
> I'm working with a colleague on a new set of R wrappers for GDAL, and
> we are at the point where we are starting to document the functions.
> Our R interface is designed to be VERY close to the GDAL command line
> utilities (we use the same parameter names, for instance), so I was
> wondering if it would be ok to use almost word-for-word the GDAL
> documentation of each of the parameters in our package's man files
> (this would save us an inordinate amount of time paraphrasing the docs
> for all of those functions).  If this is ok, how should I cite the
> documentation properly?

I can't answer about reuse of the documentation, but citation is
probably covered here,
http://trac.osgeo.org/gdal/wiki/FAQGeneral#HowdoIciteGDAL

Hopefully someone else will more directly answer your questions (my
uninformed opinion is that reuse is probably fine).

Best Regards, Eli

>
> Cheers!  Incidentally, the package is up on R-forge:
> https://r-forge.r-project.org/projects/gdalutils/
>
> --j
>
> --
> Jonathan A. Greenberg, PhD
> Assistant Professor
> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
> Department of Geography and Geographic Information Science
> University of Illinois at Urbana-Champaign
> 259 Computing Applications Building, MC-150
> 605 East Springfield Avenue
> Champaign, IL  61820-6371
> Phone: 217-300-1924
> http://www.geog.illinois.edu/~jgrn/
> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From lhomme.xavier at gmail.com  Thu Nov 14 01:35:35 2013
From: lhomme.xavier at gmail.com (xavier lhomme)
Date: Thu, 14 Nov 2013 10:35:35 +0100
Subject: [gdal-dev]  Support USRP
Message-ID: <CACqzBMxWN=UXhHAqv8fRMsotWnbBQbWwX1_d9L3m=n99Qwhg1w@mail.gmail.com>

Hi

  I have a USRP product with several images organized with
   a THF file which describe all containing image and a directory for each
image
(with  .Gen, .SOU, .IMG and a .QAL ).
The ASRP/USRP driver recognize .IMG file as explain in the web site.

ASRP/USRP is related to ADRG (and source code is stored in the ADRG
directory)
the ADRG driver is able to recognize THF file

Is it possible to improve ASRP/USRP driver to support THF files ?


Best regards
xlhomme
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131114/acb4c965/attachment-0001.html>

From vesnikos at gmail.com  Thu Nov 14 05:59:19 2013
From: vesnikos at gmail.com (Nick Ves)
Date: Thu, 14 Nov 2013 15:59:19 +0200
Subject: [gdal-dev] Using/citing GDAL documentation
In-Reply-To: <CABG0rfunvEu=yUvXjf39ZsBvrOZnky50KVUMhOaPvtvT=MRsGw@mail.gmail.com>
References: <CABG0rfunvEu=yUvXjf39ZsBvrOZnky50KVUMhOaPvtvT=MRsGw@mail.gmail.com>
Message-ID: <CADCcPvsdE0jY-8oWOKTkRhoEN15FeaZ_NPH-rgmEK+ceYSp9Nw@mail.gmail.com>

sounds really cool.

One question though: Whats the difference between gdalUtils and rgdal?

On Sat, Oct 19, 2013 at 4:13 AM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
> GDALers:
>
> I'm working with a colleague on a new set of R wrappers for GDAL, and
> we are at the point where we are starting to document the functions.
> Our R interface is designed to be VERY close to the GDAL command line
> utilities (we use the same parameter names, for instance), so I was
> wondering if it would be ok to use almost word-for-word the GDAL
> documentation of each of the parameters in our package's man files
> (this would save us an inordinate amount of time paraphrasing the docs
> for all of those functions).  If this is ok, how should I cite the
> documentation properly?
>
> Cheers!  Incidentally, the package is up on R-forge:
> https://r-forge.r-project.org/projects/gdalutils/
>
> --j
>
> --
> Jonathan A. Greenberg, PhD
> Assistant Professor
> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
> Department of Geography and Geographic Information Science
> University of Illinois at Urbana-Champaign
> 259 Computing Applications Building, MC-150
> 605 East Springfield Avenue
> Champaign, IL  61820-6371
> Phone: 217-300-1924
> http://www.geog.illinois.edu/~jgrn/
> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From bobc at bluemarblegeo.com  Thu Nov 14 08:51:56 2013
From: bobc at bluemarblegeo.com (Bob Cave)
Date: Thu, 14 Nov 2013 08:51:56 -0800 (PST)
Subject: [gdal-dev] Getting SRID from MS SQL Server Spatial Table
In-Reply-To: <CACALY+QsxmJcnVedQz1EecQpKKr7GJquiv5K6M9xfs+q_+39vQ@mail.gmail.com>
References: <1384373595999-5089019.post@n6.nabble.com>
	<CACALY+S7SA6qB2EPqVp12oUusQmnd52Z1XcsX5_YjVTuy5ZDbg@mail.gmail.com>
	<1384378850927-5089033.post@n6.nabble.com>
	<CACALY+QsxmJcnVedQz1EecQpKKr7GJquiv5K6M9xfs+q_+39vQ@mail.gmail.com>
Message-ID: <1384447916398-5089183.post@n6.nabble.com>

Hi Tamas,

I looked through the source code for the MS SQL Server Spatial driver,
version 1.10.1 and in the latest trunk download, and was unable to find that
query.  Is that something that you have added but not checked in yet?

In any case, I will give try that query myself.  Thanks.

Cheers,

Bob


Tamas Szekeres wrote
> The driver is doing something like:
> 
> select top 1 ogr_geometry.STSrid from [mytable]
> 
> Best regards,
> 
> Tamas
> 
> 
> 
> 2013/11/13 Bob Cave &lt;

> bobc@

> &gt;
> 
>> Tamas,
>>
>> Thank you for the quick reply.
>>
>> My code is reading a table, so I am trying to identify the SRID that was
>> used when the table was created and the geometries were added to the
>> table.
>> How do I query the SRID from the geometry in the table?  The MS SQL
>> Server
>> driver does this when it is reading the geometry_columns table, but when
>> the
>> driver is not using the geometry_columns table, it does not attempt to
>> identify the SRID. I am trying to determine how I can do this myself.
>>
>> Thanks,
>>
>> Bob
>>
>>
>> Tamas Szekeres wrote
>> > Bob,
>> >
>> > You should specify the SRID as the attribute in the geometries in the
>> > database table, which should also set the spatial reference of the
>> layer.
>> >
>> > Best regards,
>> >
>> > Tamas
>> >
>> >
>> >
>> > 2013/11/13 Bob Cave &lt;
>>
>> > bobc@
>>
>> > &gt;
>> >
>> >> Hello,
>> >>
>> >> I am using the MS SQL Server driver (1.10.1) with
>> >> MSSQLSPATIAL_USE_GEOMETRY_COLUMNS=NO.  When I attempt to read a table,
>> I
>> >> find that the driver does not identify the spatial reference the table
>> is
>> >> using.  Is there a way to get the driver to query for the SRID?
>> >>
>> >> When I use MSSQLSPATIAL_USE_GEOMETRY_COLUMNS=YES, then the SRID can be
>> >> identified.  This is fine for my test database, but I need to be able
>> to
>> >> support databases that don't have a geometry_columns table.
>> >>
>> >> Thanks,
>> >>
>> >> Bob
>> >>
>> >>
>> >>
>> >> --
>> >> View this message in context:
>> >>
>> http://osgeo-org.1560.x6.nabble.com/Getting-SRID-from-MS-SQL-Server-Spatial-Table-tp5089019.html
>> >> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>> >> _______________________________________________
>> >> gdal-dev mailing list
>> >>
>>
>> > gdal-dev at .osgeo
>>
>> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>> >>
>> >
>> > _______________________________________________
>> > gdal-dev mailing list
>>
>> > gdal-dev at .osgeo
>>
>> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>
>>
>>
>>
>> --
>> View this message in context:
>> http://osgeo-org.1560.x6.nabble.com/Getting-SRID-from-MS-SQL-Server-Spatial-Table-tp5089019p5089033.html
>> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>> _______________________________________________
>> gdal-dev mailing list
>> 

> gdal-dev at .osgeo

>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> http://lists.osgeo.org/mailman/listinfo/gdal-dev





--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Getting-SRID-from-MS-SQL-Server-Spatial-Table-tp5089019p5089183.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From szekerest at gmail.com  Thu Nov 14 11:27:36 2013
From: szekerest at gmail.com (Tamas Szekeres)
Date: Thu, 14 Nov 2013 20:27:36 +0100
Subject: [gdal-dev] Getting SRID from MS SQL Server Spatial Table
In-Reply-To: <1384447916398-5089183.post@n6.nabble.com>
References: <1384373595999-5089019.post@n6.nabble.com>
	<CACALY+S7SA6qB2EPqVp12oUusQmnd52Z1XcsX5_YjVTuy5ZDbg@mail.gmail.com>
	<1384378850927-5089033.post@n6.nabble.com>
	<CACALY+QsxmJcnVedQz1EecQpKKr7GJquiv5K6M9xfs+q_+39vQ@mail.gmail.com>
	<1384447916398-5089183.post@n6.nabble.com>
Message-ID: <CACALY+Tuuh5FpxE83NsOj3z5S8ADd8qVmK=sVNGK5p2ZBbivHw@mail.gmail.com>

Bob,

I did not mention to use exactly the same select, just a similar effect
when reading the geometries.
In ogrmssqlspatiallayer.cpp<http://trac.osgeo.org/gdal/browser/trunk/gdal/ogr/ogrsf_frmts/mssqlspatial/ogrmssqlspatiallayer.cpp>see
the function
OGRMSSQLSpatialLayer::GetNextRawFeature()

nSRSId = oParser.GetSRSId();

and then:

if ( GetSpatialRef() )
   poGeom->assignSpatialReference( poSRS );


Best regards,

Tamas



2013/11/14 Bob Cave <bobc at bluemarblegeo.com>

> Hi Tamas,
>
> I looked through the source code for the MS SQL Server Spatial driver,
> version 1.10.1 and in the latest trunk download, and was unable to find
> that
> query.  Is that something that you have added but not checked in yet?
>
> In any case, I will give try that query myself.  Thanks.
>
> Cheers,
>
> Bob
>
>
> Tamas Szekeres wrote
> > The driver is doing something like:
> >
> > select top 1 ogr_geometry.STSrid from [mytable]
> >
> > Best regards,
> >
> > Tamas
> >
> >
> >
> > 2013/11/13 Bob Cave &lt;
>
> > bobc@
>
> > &gt;
> >
> >> Tamas,
> >>
> >> Thank you for the quick reply.
> >>
> >> My code is reading a table, so I am trying to identify the SRID that was
> >> used when the table was created and the geometries were added to the
> >> table.
> >> How do I query the SRID from the geometry in the table?  The MS SQL
> >> Server
> >> driver does this when it is reading the geometry_columns table, but when
> >> the
> >> driver is not using the geometry_columns table, it does not attempt to
> >> identify the SRID. I am trying to determine how I can do this myself.
> >>
> >> Thanks,
> >>
> >> Bob
> >>
> >>
> >> Tamas Szekeres wrote
> >> > Bob,
> >> >
> >> > You should specify the SRID as the attribute in the geometries in the
> >> > database table, which should also set the spatial reference of the
> >> layer.
> >> >
> >> > Best regards,
> >> >
> >> > Tamas
> >> >
> >> >
> >> >
> >> > 2013/11/13 Bob Cave &lt;
> >>
> >> > bobc@
> >>
> >> > &gt;
> >> >
> >> >> Hello,
> >> >>
> >> >> I am using the MS SQL Server driver (1.10.1) with
> >> >> MSSQLSPATIAL_USE_GEOMETRY_COLUMNS=NO.  When I attempt to read a
> table,
> >> I
> >> >> find that the driver does not identify the spatial reference the
> table
> >> is
> >> >> using.  Is there a way to get the driver to query for the SRID?
> >> >>
> >> >> When I use MSSQLSPATIAL_USE_GEOMETRY_COLUMNS=YES, then the SRID can
> be
> >> >> identified.  This is fine for my test database, but I need to be able
> >> to
> >> >> support databases that don't have a geometry_columns table.
> >> >>
> >> >> Thanks,
> >> >>
> >> >> Bob
> >> >>
> >> >>
> >> >>
> >> >> --
> >> >> View this message in context:
> >> >>
> >>
> http://osgeo-org.1560.x6.nabble.com/Getting-SRID-from-MS-SQL-Server-Spatial-Table-tp5089019.html
> >> >> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> >> >> _______________________________________________
> >> >> gdal-dev mailing list
> >> >>
> >>
> >> > gdal-dev at .osgeo
> >>
> >> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >> >>
> >> >
> >> > _______________________________________________
> >> > gdal-dev mailing list
> >>
> >> > gdal-dev at .osgeo
> >>
> >> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >>
> >>
> >>
> >>
> >>
> >> --
> >> View this message in context:
> >>
> http://osgeo-org.1560.x6.nabble.com/Getting-SRID-from-MS-SQL-Server-Spatial-Table-tp5089019p5089033.html
> >> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> >> _______________________________________________
> >> gdal-dev mailing list
> >>
>
> > gdal-dev at .osgeo
>
> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >>
> >
> > _______________________________________________
> > gdal-dev mailing list
>
> > gdal-dev at .osgeo
>
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
>
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/Getting-SRID-from-MS-SQL-Server-Spatial-Table-tp5089019p5089183.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131114/fc768983/attachment.html>

From bobc at bluemarblegeo.com  Thu Nov 14 11:44:26 2013
From: bobc at bluemarblegeo.com (Bob Cave)
Date: Thu, 14 Nov 2013 11:44:26 -0800 (PST)
Subject: [gdal-dev] Getting SRID from MS SQL Server Spatial Table
In-Reply-To: <CACALY+Tuuh5FpxE83NsOj3z5S8ADd8qVmK=sVNGK5p2ZBbivHw@mail.gmail.com>
References: <1384373595999-5089019.post@n6.nabble.com>
	<CACALY+S7SA6qB2EPqVp12oUusQmnd52Z1XcsX5_YjVTuy5ZDbg@mail.gmail.com>
	<1384378850927-5089033.post@n6.nabble.com>
	<CACALY+QsxmJcnVedQz1EecQpKKr7GJquiv5K6M9xfs+q_+39vQ@mail.gmail.com>
	<1384447916398-5089183.post@n6.nabble.com>
	<CACALY+Tuuh5FpxE83NsOj3z5S8ADd8qVmK=sVNGK5p2ZBbivHw@mail.gmail.com>
Message-ID: <1384458266761-5089210.post@n6.nabble.com>

Hi Tamas,

It looks like I misunderstood what you were saying.  Thank you for the
clarification.

Cheers,

Bob


Tamas Szekeres wrote
> Bob,
> 
> I did not mention to use exactly the same select, just a similar effect
> when reading the geometries.
> In
> ogrmssqlspatiallayer.cpp&lt;http://trac.osgeo.org/gdal/browser/trunk/gdal/ogr/ogrsf_frmts/mssqlspatial/ogrmssqlspatiallayer.cpp&gt;see
> the function
> OGRMSSQLSpatialLayer::GetNextRawFeature()
> 
> nSRSId = oParser.GetSRSId();
> 
> and then:
> 
> if ( GetSpatialRef() )
>    poGeom->assignSpatialReference( poSRS );
> 
> 
> Best regards,
> 
> Tamas
> 
> 
> 
> 2013/11/14 Bob Cave &lt;

> bobc@

> &gt;
> 
>> Hi Tamas,
>>
>> I looked through the source code for the MS SQL Server Spatial driver,
>> version 1.10.1 and in the latest trunk download, and was unable to find
>> that
>> query.  Is that something that you have added but not checked in yet?
>>
>> In any case, I will give try that query myself.  Thanks.
>>
>> Cheers,
>>
>> Bob
>>
>>
>> Tamas Szekeres wrote
>> > The driver is doing something like:
>> >
>> > select top 1 ogr_geometry.STSrid from [mytable]
>> >
>> > Best regards,
>> >
>> > Tamas
>> >
>> >
>> >
>> > 2013/11/13 Bob Cave &lt;
>>
>> > bobc@
>>
>> > &gt;
>> >
>> >> Tamas,
>> >>
>> >> Thank you for the quick reply.
>> >>
>> >> My code is reading a table, so I am trying to identify the SRID that
>> was
>> >> used when the table was created and the geometries were added to the
>> >> table.
>> >> How do I query the SRID from the geometry in the table?  The MS SQL
>> >> Server
>> >> driver does this when it is reading the geometry_columns table, but
>> when
>> >> the
>> >> driver is not using the geometry_columns table, it does not attempt to
>> >> identify the SRID. I am trying to determine how I can do this myself.
>> >>
>> >> Thanks,
>> >>
>> >> Bob
>> >>
>> >>
>> >> Tamas Szekeres wrote
>> >> > Bob,
>> >> >
>> >> > You should specify the SRID as the attribute in the geometries in
>> the
>> >> > database table, which should also set the spatial reference of the
>> >> layer.
>> >> >
>> >> > Best regards,
>> >> >
>> >> > Tamas
>> >> >
>> >> >
>> >> >
>> >> > 2013/11/13 Bob Cave &lt;
>> >>
>> >> > bobc@
>> >>
>> >> > &gt;
>> >> >
>> >> >> Hello,
>> >> >>
>> >> >> I am using the MS SQL Server driver (1.10.1) with
>> >> >> MSSQLSPATIAL_USE_GEOMETRY_COLUMNS=NO.  When I attempt to read a
>> table,
>> >> I
>> >> >> find that the driver does not identify the spatial reference the
>> table
>> >> is
>> >> >> using.  Is there a way to get the driver to query for the SRID?
>> >> >>
>> >> >> When I use MSSQLSPATIAL_USE_GEOMETRY_COLUMNS=YES, then the SRID can
>> be
>> >> >> identified.  This is fine for my test database, but I need to be
>> able
>> >> to
>> >> >> support databases that don't have a geometry_columns table.
>> >> >>
>> >> >> Thanks,
>> >> >>
>> >> >> Bob
>> >> >>
>> >> >>
>> >> >>
>> >> >> --
>> >> >> View this message in context:
>> >> >>
>> >>
>> http://osgeo-org.1560.x6.nabble.com/Getting-SRID-from-MS-SQL-Server-Spatial-Table-tp5089019.html
>> >> >> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>> >> >> _______________________________________________
>> >> >> gdal-dev mailing list
>> >> >>
>> >>
>> >> > gdal-dev at .osgeo
>> >>
>> >> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>> >> >>
>> >> >
>> >> > _______________________________________________
>> >> > gdal-dev mailing list
>> >>
>> >> > gdal-dev at .osgeo
>> >>
>> >> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>> >>
>> >>
>> >>
>> >>
>> >>
>> >> --
>> >> View this message in context:
>> >>
>> http://osgeo-org.1560.x6.nabble.com/Getting-SRID-from-MS-SQL-Server-Spatial-Table-tp5089019p5089033.html
>> >> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>> >> _______________________________________________
>> >> gdal-dev mailing list
>> >>
>>
>> > gdal-dev at .osgeo
>>
>> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>> >>
>> >
>> > _______________________________________________
>> > gdal-dev mailing list
>>
>> > gdal-dev at .osgeo
>>
>> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>
>>
>>
>>
>> --
>> View this message in context:
>> http://osgeo-org.1560.x6.nabble.com/Getting-SRID-from-MS-SQL-Server-Spatial-Table-tp5089019p5089183.html
>> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>> _______________________________________________
>> gdal-dev mailing list
>> 

> gdal-dev at .osgeo

>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> http://lists.osgeo.org/mailman/listinfo/gdal-dev





--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Getting-SRID-from-MS-SQL-Server-Spatial-Table-tp5089019p5089210.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From tpiepho at gmail.com  Thu Nov 14 12:24:01 2013
From: tpiepho at gmail.com (Trent Piepho)
Date: Thu, 14 Nov 2013 12:24:01 -0800
Subject: [gdal-dev] geotiff projection not showing up
In-Reply-To: <201311101043.57128.even.rouault@mines-paris.org>
References: <527AB33E.3050306@telus.net> <527EA42B.60806@telus.net>
	<CA+7tXijAe0DW1Z1kP_XrvGH+bzVn6wsga1gNd2Nv2P4_ATMZ7w@mail.gmail.com>
	<201311101043.57128.even.rouault@mines-paris.org>
Message-ID: <CA+7tXii7fWWS37OkynX4kDpxN9YuMAuom1f1eFeSd9-m+Cwa1g@mail.gmail.com>

On Nov 10, 2013 1:44 AM, "Even Rouault" <even.rouault at mines-paris.org>
wrote:
>
> Le dimanche 10 novembre 2013 00:14:42, Trent Piepho a ?crit :
> > I've found that unless you call SetGeoTransform() and give an affine
> > transform, most apps, including listgeo and gdalsrsinfo, aren't
> > entirely happy with the georeferencing.  GDAL has a function that
> > computes a transform from GCPs, but it needs to be part of the GDAL
> > code for the dataset driver.  GDAL doesn't automatically do it when a
> > user of GDAL wants an affine transform from a dataset.
>
> True. This is (I think) a design decision, as generally GDAL tries to
expose
> information as close as possible to what is in the dataset. GCPs alone
don't
> provide an unambiguous way of transforming image pixel coordinates into
real-
> world coordinates. You have to specify which extrapolation method you
want to
> use : polynomial at which order, thin plate spline, ..

>From what I've seen many apps just want to translate between pixel,line and
geographic coordinates.  The method to do this appears to be to get the SRS
from the dataset, use one of it's methods to transform between geographic
coordinates and projected coordinates, then get the geotransform
coefficients and preform the affine transform with them.

With no geotransform, this doesn't work.  Instead one is supposed to....I
don't know.  I don't see any OGR or dataset function that will do the
coordinate transform.  I've looked at other apps, and none of them can
handle this.   So you end up with the only way to georeference a dataset,
and have anything work, is to use a affine transform.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131114/10532465/attachment.html>

From even.rouault at mines-paris.org  Thu Nov 14 12:50:00 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 14 Nov 2013 21:50:00 +0100
Subject: [gdal-dev] geotiff projection not showing up
In-Reply-To: <CA+7tXii7fWWS37OkynX4kDpxN9YuMAuom1f1eFeSd9-m+Cwa1g@mail.gmail.com>
References: <527AB33E.3050306@telus.net>
	<201311101043.57128.even.rouault@mines-paris.org>
	<CA+7tXii7fWWS37OkynX4kDpxN9YuMAuom1f1eFeSd9-m+Cwa1g@mail.gmail.com>
Message-ID: <201311142150.00752.even.rouault@mines-paris.org>

Le jeudi 14 novembre 2013 21:24:01, Trent Piepho a ?crit :
> On Nov 10, 2013 1:44 AM, "Even Rouault" <even.rouault at mines-paris.org>
> 
> wrote:
> > Le dimanche 10 novembre 2013 00:14:42, Trent Piepho a ?crit :
> > > I've found that unless you call SetGeoTransform() and give an affine
> > > transform, most apps, including listgeo and gdalsrsinfo, aren't
> > > entirely happy with the georeferencing.  GDAL has a function that
> > > computes a transform from GCPs, but it needs to be part of the GDAL
> > > code for the dataset driver.  GDAL doesn't automatically do it when a
> > > user of GDAL wants an affine transform from a dataset.
> > 
> > True. This is (I think) a design decision, as generally GDAL tries to
> 
> expose
> 
> > information as close as possible to what is in the dataset. GCPs alone
> 
> don't
> 
> > provide an unambiguous way of transforming image pixel coordinates into
> 
> real-
> 
> > world coordinates. You have to specify which extrapolation method you
> 
> want to
> 
> > use : polynomial at which order, thin plate spline, ..
> 
> From what I've seen many apps just want to translate between pixel,line and
> geographic coordinates.  The method to do this appears to be to get the SRS
> from the dataset, use one of it's methods to transform between geographic
> coordinates and projected coordinates, then get the geotransform
> coefficients and preform the affine transform with them.
> 
> With no geotransform, this doesn't work.  Instead one is supposed to....I
> don't know.  I don't see any OGR or dataset function that will do the
> coordinate transform.  I've looked at other apps, and none of them can
> handle this.   So you end up with the only way to georeference a dataset,
> and have anything work, is to use a affine transform.

You can use gdalwarp to transform a dataset with GCPs to a dataset with 
geotransform. gdalwarp uses the GDAL warping API : 
http://www.gdal.org/warptut.html


-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From nhatzop at gmail.com  Thu Nov 14 20:55:04 2013
From: nhatzop at gmail.com (Nikolaos Hatzopoulos)
Date: Thu, 14 Nov 2013 20:55:04 -0800
Subject: [gdal-dev] l1b to grid
Message-ID: <CALDJGKCuzamK2e7w-oFf8BF7Afd6YYDqJTpnnt1uuFu459v3EQ@mail.gmail.com>

Does anyone know how to grid a level1b swath image from satellites to a
gridded projection?

Best,
--Nikos Hatzopoulos
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131114/911e29e0/attachment.html>

From jukka.rahkonen at mmmtike.fi  Fri Nov 15 04:41:56 2013
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Fri, 15 Nov 2013 12:41:56 +0000 (UTC)
Subject: [gdal-dev] How to check if image is valid?
Message-ID: <loom.20131115T133000-281@post.gmane.org>

Hi,

Is there some fast method to check if an image is valid? I am creating
overviews for some images and process yields this kind of errors:

G:\m150_wms>gdaladdo -r average -ro --config COMPRESS_OVERVIEW JPEG --config
PHOTOMETRIC_OVERVIEW YC
BCR --config INTERLEAVE_OVERVIEW PIXEL TTEC_2011_M150_TM35_R4332B.TIF 2 4 8
16 32 64
0Warning 1: File open for read-only accessing, creating overviews externally.
...10...20Warning 1: JPEGLib:Premature end of JPEG file
ERROR 1: JPEGLib:Not a JPEG file: starts with 0x00 0x00
ERROR 1: TIFFReadEncodedTile() failed.
ERROR 1: IReadBlock failed at X offset 36, Y offset 13
ERROR 1: GetBlockRef failed at X block offset 36, Y block offset 13
...30...40...50...60...70...80...90...100 - done.

Now I would like to run a check for a few thousand images and check if they
are healthy. What is the recommended method to do it? Is it possible to run
gdal_translate by using some dummy output format and capture just the
filename and exit code into a log file so I could sort the images into good
ones and probably corrupted? Or can I use gdalinfo with some parameters for
this purpose?


-Jukka Rahkonen-


From even.rouault at mines-paris.org  Fri Nov 15 11:00:28 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 15 Nov 2013 20:00:28 +0100
Subject: [gdal-dev] How to check if image is valid?
In-Reply-To: <loom.20131115T133000-281@post.gmane.org>
References: <loom.20131115T133000-281@post.gmane.org>
Message-ID: <201311152000.28279.even.rouault@mines-paris.org>

Le vendredi 15 novembre 2013 13:41:56, Jukka Rahkonen a ?crit :
> Hi,
> 
> Is there some fast method to check if an image is valid? I am creating
> overviews for some images and process yields this kind of errors:
> 
> G:\m150_wms>gdaladdo -r average -ro --config COMPRESS_OVERVIEW JPEG
> --config PHOTOMETRIC_OVERVIEW YC
> BCR --config INTERLEAVE_OVERVIEW PIXEL TTEC_2011_M150_TM35_R4332B.TIF 2 4 8
> 16 32 64
> 0Warning 1: File open for read-only accessing, creating overviews
> externally. ...10...20Warning 1: JPEGLib:Premature end of JPEG file
> ERROR 1: JPEGLib:Not a JPEG file: starts with 0x00 0x00
> ERROR 1: TIFFReadEncodedTile() failed.
> ERROR 1: IReadBlock failed at X offset 36, Y offset 13
> ERROR 1: GetBlockRef failed at X block offset 36, Y block offset 13
> ...30...40...50...60...70...80...90...100 - done.

Are you sure that the error comes from the base image ? Overview building with 
TIFF compression has been a source of various bugs in the past, so that could 
be that too, although it finally seems to be quite stable since a few versions 
now.

> 
> Now I would like to run a check for a few thousand images and check if they
> are healthy. What is the recommended method to do it? Is it possible to run
> gdal_translate by using some dummy output format and capture just the
> filename and exit code into a log file so I could sort the images into good
> ones and probably corrupted?

"gdal_translate corrupted.tif /vsimem/foo.tif" returns a non 0 exit code. The 
issue is that it can consume a lot of RAM (size of uncompressed image) if 
corrupted.tif is very big.

> Or can I use gdalinfo with some parameters for
> this purpose?

I would have said "gdalinfo -checksum corrupted.tif", but actually the I/O 
error during checksum computation doesn't have an influence on the error code, 
so you can't use that

You can try the following Python script, let call it check_integrity.py

import sys
from osgeo import gdal
ds = gdal.Open(sys.argv[1])
for i in range(ds.RasterCount):
    ds.GetRasterBand(1).Checksum()
    if gdal.GetLastErrorType() != 0:
        sys.exit(1)
sys.exit(0)

"python check_integrity.py corrupt.tif" will return 1 as error code. 
(Checksum() isn't necessary the most efficient way of doing I/O in case of 
interleave bands, but that the shortest script I could come with ;-))

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Fri Nov 15 11:24:21 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 15 Nov 2013 20:24:21 +0100
Subject: [gdal-dev] Support USRP
In-Reply-To: <CACqzBMxWN=UXhHAqv8fRMsotWnbBQbWwX1_d9L3m=n99Qwhg1w@mail.gmail.com>
References: <CACqzBMxWN=UXhHAqv8fRMsotWnbBQbWwX1_d9L3m=n99Qwhg1w@mail.gmail.com>
Message-ID: <201311152024.21392.even.rouault@mines-paris.org>

Le jeudi 14 novembre 2013 10:35:35, xavier lhomme a ?crit :
> Hi
> 
>   I have a USRP product with several images organized with
>    a THF file which describe all containing image and a directory for each
> image
> (with  .Gen, .SOU, .IMG and a .QAL ).
> The ASRP/USRP driver recognize .IMG file as explain in the web site.
> 
> ASRP/USRP is related to ADRG (and source code is stored in the ADRG
> directory)
> the ADRG driver is able to recognize THF file
> 
> Is it possible to improve ASRP/USRP driver to support THF files ?

That is undoubtedly technically doable. The THF being a catalog, the best use 
of it I can see in an enhanced driver would be to report those images as 
SUBDATASETS of the THF dataset.

> 
> 
> Best regards
> xlhomme

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From martin.pineault at geo-plus.com  Fri Nov 15 11:37:12 2013
From: martin.pineault at geo-plus.com (Martin Pineault)
Date: Fri, 15 Nov 2013 14:37:12 -0500
Subject: [gdal-dev] gdal for WindowCE
Message-ID: <015e01cee23a$1539e7a0$3fadb6e0$@geo-plus.com>

Hi,

 

We may be interested in maintaining the CE/Mobile flavor of gdal. But first
someone told us that Autocad DWG files where supported (this is our need).
But can?t find any mention in your web page.

 

Thank you.


MARTIN PINEAULT
Vice-President, Business Development

ligne intermediaire


logo et age cie

 


555, rue de l'Ar?na, suite 102
Saint-Nicolas, Qc, G7A 1E5

 



icone telephone

 

1-888-831-3668, #40


icone fax

 

1-866-635-7344


 <mailto:maurice.temfack at geo-plus.com> martin.pineault at geo-plus.com


 

 

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131115/d37115b7/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 144 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131115/d37115b7/attachment-0001.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image002.gif
Type: image/gif
Size: 5686 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131115/d37115b7/attachment-0001.gif>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image003.jpg
Type: image/jpeg
Size: 882 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131115/d37115b7/attachment-0002.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image004.jpg
Type: image/jpeg
Size: 840 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131115/d37115b7/attachment-0003.jpg>

From warmerdam at pobox.com  Fri Nov 15 11:47:57 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri, 15 Nov 2013 11:47:57 -0800
Subject: [gdal-dev] gdal for WindowCE
In-Reply-To: <015e01cee23a$1539e7a0$3fadb6e0$@geo-plus.com>
References: <015e01cee23a$1539e7a0$3fadb6e0$@geo-plus.com>
Message-ID: <CA+YzLBdwahGkWuV5T0Yjg3o3_9=ffWmJCE=zO3zkswuc2SnhxA@mail.gmail.com>

Martin,

The only DWG support that I recall depends on the libraries from the Open
Design Alliance and I'm not sure if they work on windows CE.  Also, that
driver has many limitations - rendering the DWG features down to simple
features in OGR.  You might want to investigate that it really gives you
want you want.  Some more info on the DWG driver is available at:

 http://www.gdal.org/ogr/drv_dwg.html

If it does suit your needs, and the ODA libraries can be built on WinCE
then it would be great to have you helping keeping GDAL/OGR working
properly on WinCE.

Best regards,
Frank



On Fri, Nov 15, 2013 at 11:37 AM, Martin Pineault <
martin.pineault at geo-plus.com> wrote:

> Hi,
>
>
>
> We may be interested in maintaining the CE/Mobile flavor of gdal. But
> first someone told us that Autocad DWG files where supported (this is our
> need). But can?t find any mention in your web page.
>
>
>
> Thank you.
>
> *MARTIN PINEAULT*
> Vice-President, Business Development
>
> [image: ligne intermediaire]
>
> [image: logo et age cie]
>
>
>
> 555, rue de l'Ar?na, suite 102
> Saint-Nicolas, Qc, G7A 1E5
>
>
>
> [image: icone telephone]
>
>
>
> 1-888-831-3668, #40
>
> [image: icone fax]
>
>
>
> 1-866-635-7344
>
> *martin.pineault at geo-plus.com <maurice.temfack at geo-plus.com>*
>
>
>
>
>
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131115/be1fcd4c/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image004.jpg
Type: image/jpeg
Size: 840 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131115/be1fcd4c/attachment.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image002.gif
Type: image/gif
Size: 5686 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131115/be1fcd4c/attachment.gif>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image003.jpg
Type: image/jpeg
Size: 882 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131115/be1fcd4c/attachment-0001.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 144 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131115/be1fcd4c/attachment.png>

From martin.pineault at geo-plus.com  Fri Nov 15 11:56:37 2013
From: martin.pineault at geo-plus.com (Martin Pineault)
Date: Fri, 15 Nov 2013 14:56:37 -0500
Subject: [gdal-dev] gdal for WindowCE
In-Reply-To: <CA+YzLBdwahGkWuV5T0Yjg3o3_9=ffWmJCE=zO3zkswuc2SnhxA@mail.gmail.com>
References: <015e01cee23a$1539e7a0$3fadb6e0$@geo-plus.com>
	<CA+YzLBdwahGkWuV5T0Yjg3o3_9=ffWmJCE=zO3zkswuc2SnhxA@mail.gmail.com>
Message-ID: <016701cee23c$cb46c110$61d44330$@geo-plus.com>

Hi Frank,

 

The ODA is running on CE. We are part of the membership and have been using
this for a couple years. But the problem is that the entire libraries are
static and take too much memory to be usable.

 

We don?t need much thing from DWG and I will look at your documentation to
see if it?s fit our needs.

 

Thank you.

 

MARTIN PINEAULT
Vice-President, Business Development

 

De : fwarmerdam at gmail.com [mailto:fwarmerdam at gmail.com] De la part de Frank
Warmerdam
Envoy? : 15 novembre 2013 14:48
? : Martin Pineault
Cc : gdal dev
Objet : Re: [gdal-dev] gdal for WindowCE

 

Martin,

 

The only DWG support that I recall depends on the libraries from the Open
Design Alliance and I'm not sure if they work on windows CE.  Also, that
driver has many limitations - rendering the DWG features down to simple
features in OGR.  You might want to investigate that it really gives you
want you want.  Some more info on the DWG driver is available at:

 

 http://www.gdal.org/ogr/drv_dwg.html

 

If it does suit your needs, and the ODA libraries can be built on WinCE then
it would be great to have you helping keeping GDAL/OGR working properly on
WinCE.

 

Best regards,

Frank

 

 

On Fri, Nov 15, 2013 at 11:37 AM, Martin Pineault
<martin.pineault at geo-plus.com> wrote:

Hi,

 

We may be interested in maintaining the CE/Mobile flavor of gdal. But first
someone told us that Autocad DWG files where supported (this is our need).
But can?t find any mention in your web page.

 

Thank you.


MARTIN PINEAULT
Vice-President, Business Development

ligne intermediaire


logo et age cie

 


555, rue de l'Ar?na, suite 102
Saint-Nicolas, Qc, G7A 1E5

 



icone telephone

 

1-888-831-3668, #40 <tel:1-888-831-3668%2C%20%2340> 


icone fax

 

1-866-635-7344


 <mailto:maurice.temfack at geo-plus.com> martin.pineault at geo-plus.com


 

 

 

 


_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev





 

-- 
---------------------------------------+------------------------------------
--
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131115/af3d8e7d/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 144 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131115/af3d8e7d/attachment-0001.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image002.gif
Type: image/gif
Size: 5686 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131115/af3d8e7d/attachment-0001.gif>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image003.jpg
Type: image/jpeg
Size: 882 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131115/af3d8e7d/attachment-0002.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image004.jpg
Type: image/jpeg
Size: 840 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131115/af3d8e7d/attachment-0003.jpg>

From lhomme.xavier at gmail.com  Sat Nov 16 02:51:31 2013
From: lhomme.xavier at gmail.com (xavier lhomme)
Date: Sat, 16 Nov 2013 11:51:31 +0100
Subject: [gdal-dev] Support USRP
In-Reply-To: <201311152024.21392.even.rouault@mines-paris.org>
References: <CACqzBMxWN=UXhHAqv8fRMsotWnbBQbWwX1_d9L3m=n99Qwhg1w@mail.gmail.com>
	<201311152024.21392.even.rouault@mines-paris.org>
Message-ID: <CACqzBMxRbN=DO2hzDFWT5sSnV1seKLQWaRYDYiYgagTMrFWbwQ@mail.gmail.com>

Hi
I'm on it . Seems to have many common function with ADRG driver.

I will report here the enhancement.

xlhomme


2013/11/15 Even Rouault <even.rouault at mines-paris.org>

> Le jeudi 14 novembre 2013 10:35:35, xavier lhomme a ?crit :
> > Hi
> >
> >   I have a USRP product with several images organized with
> >    a THF file which describe all containing image and a directory for
> each
> > image
> > (with  .Gen, .SOU, .IMG and a .QAL ).
> > The ASRP/USRP driver recognize .IMG file as explain in the web site.
> >
> > ASRP/USRP is related to ADRG (and source code is stored in the ADRG
> > directory)
> > the ADRG driver is able to recognize THF file
> >
> > Is it possible to improve ASRP/USRP driver to support THF files ?
>
> That is undoubtedly technically doable. The THF being a catalog, the best
> use
> of it I can see in an enhanced driver would be to report those images as
> SUBDATASETS of the THF dataset.
>
> >
> >
> > Best regards
> > xlhomme
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131116/d6604f0a/attachment.html>

From lhomme.xavier at gmail.com  Sat Nov 16 03:25:53 2013
From: lhomme.xavier at gmail.com (xavier lhomme)
Date: Sat, 16 Nov 2013 12:25:53 +0100
Subject: [gdal-dev]  coding rules / guidelines
Message-ID: <CACqzBMykODOZiRVE8dZdYf1SrW2uzGcYeRF35qKkLvbX+yNK=A@mail.gmail.com>

Hi

Is there some coding rules or guidelines for GDAL , naming convention ?

For example where can I found the signification of variable name starting
with
papsz ?

xlhomme
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131116/5af23291/attachment.html>

From even.rouault at mines-paris.org  Sat Nov 16 03:53:32 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 16 Nov 2013 12:53:32 +0100
Subject: [gdal-dev] coding rules / guidelines
In-Reply-To: <CACqzBMykODOZiRVE8dZdYf1SrW2uzGcYeRF35qKkLvbX+yNK=A@mail.gmail.com>
References: <CACqzBMykODOZiRVE8dZdYf1SrW2uzGcYeRF35qKkLvbX+yNK=A@mail.gmail.com>
Message-ID: <201311161253.32806.even.rouault@mines-paris.org>

Le samedi 16 novembre 2013 12:25:53, xavier lhomme a ?crit :
> Hi
> 
> Is there some coding rules or guidelines for GDAL , naming convention ?
> 
> For example where can I found the signification of variable name starting
> with
> papsz ?

See http://trac.osgeo.org/gdal/wiki/rfc8_devguide

> 
> xlhomme

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From jgrn at illinois.edu  Sat Nov 16 13:51:50 2013
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Sat, 16 Nov 2013 15:51:50 -0600
Subject: [gdal-dev] Using/citing GDAL documentation
In-Reply-To: <CADCcPvsdE0jY-8oWOKTkRhoEN15FeaZ_NPH-rgmEK+ceYSp9Nw@mail.gmail.com>
References: <CABG0rfunvEu=yUvXjf39ZsBvrOZnky50KVUMhOaPvtvT=MRsGw@mail.gmail.com>
	<CADCcPvsdE0jY-8oWOKTkRhoEN15FeaZ_NPH-rgmEK+ceYSp9Nw@mail.gmail.com>
Message-ID: <CABG0rfubbqWmChpvRdFhp7YtkOoArHPQ-gnj0YmysXVNY68DEQ@mail.gmail.com>

Hi Nick:

My package (gdalUtils) are just straight-wrappers for the GDAL Utilities (
http://www.gdal.org/gdal_utilities.html) -- I've got most of the non-python
ones finished.  rgdal contain low-level bindings to GDAL and Python (
http://cran.r-project.org/web/packages/rgdal/index.html), but are missing
quite a few functions that the GDAL Utilities contain.  On top of that,
rgdal uses a compiled version of some of the GDAL libraries that is missing
quite a bit of functionality, particularly on Windows boxes -- most
notably, HDF4/5 support.  My package does not contain a GDAL install, it
searches for one that a user installed themselves (typically via
OSGeo4W/QGIS), so provides more flexibility in variations in GDAL
installations.

rgdal and gdalUtils are complementary packages, mind you.  rgdal is used
quite a bit by other packages for providing various raster functionality.
 I'm simply filling in some of the gaps in rgdal's capabilities.

--j


On Thu, Nov 14, 2013 at 7:59 AM, Nick Ves <vesnikos at gmail.com> wrote:

> sounds really cool.
>
> One question though: Whats the difference between gdalUtils and rgdal?
>
> On Sat, Oct 19, 2013 at 4:13 AM, Jonathan Greenberg <jgrn at illinois.edu>
> wrote:
> > GDALers:
> >
> > I'm working with a colleague on a new set of R wrappers for GDAL, and
> > we are at the point where we are starting to document the functions.
> > Our R interface is designed to be VERY close to the GDAL command line
> > utilities (we use the same parameter names, for instance), so I was
> > wondering if it would be ok to use almost word-for-word the GDAL
> > documentation of each of the parameters in our package's man files
> > (this would save us an inordinate amount of time paraphrasing the docs
> > for all of those functions).  If this is ok, how should I cite the
> > documentation properly?
> >
> > Cheers!  Incidentally, the package is up on R-forge:
> > https://r-forge.r-project.org/projects/gdalutils/
> >
> > --j
> >
> > --
> > Jonathan A. Greenberg, PhD
> > Assistant Professor
> > Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
> > Department of Geography and Geographic Information Science
> > University of Illinois at Urbana-Champaign
> > 259 Computing Applications Building, MC-150
> > 605 East Springfield Avenue
> > Champaign, IL  61820-6371
> > Phone: 217-300-1924
> > http://www.geog.illinois.edu/~jgrn/
> > AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Department of Geography and Geographic Information Science
University of Illinois at Urbana-Champaign
259 Computing Applications Building, MC-150
605 East Springfield Avenue
Champaign, IL  61820-6371
Phone: 217-300-1924
http://www.geog.illinois.edu/~jgrn/
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131116/367af77e/attachment.html>

From john.welter at nwgeo.com  Sat Nov 16 16:57:48 2013
From: john.welter at nwgeo.com (jwelter)
Date: Sat, 16 Nov 2013 16:57:48 -0800 (PST)
Subject: [gdal-dev] Unable to decode ADS100 images
In-Reply-To: <8F25D7B9D78147488B5CCD8C6D299B429BBB4934@tlswinmbx01.toulouse.spotimage.int>
References: <8F25D7B9D78147488B5CCD8C6D299B429BBB4934@tlswinmbx01.toulouse.spotimage.int>
Message-ID: <1384649868038-5089507.post@n6.nabble.com>

The codec is proprietary and currently not released.

We do have plans to release an updated SDK to support ADS100 images much
like what is offered for ADS40/80 but not sure when that will occur.

John








--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Unable-to-decode-ADS100-images-tp5087243p5089507.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From kyle.sletmoe at urbanrobotics.net  Sat Nov 16 18:33:15 2013
From: kyle.sletmoe at urbanrobotics.net (kyle.sletmoe)
Date: Sat, 16 Nov 2013 18:33:15 -0800 (PST)
Subject: [gdal-dev] building gdal on windows -- how to hide internal libtiff
	symbols
Message-ID: <1384655595975-5089510.post@n6.nabble.com>

I am building on Windows and would like to know how to hide the internal
libtiff (and libgeotiff) symbols. I know about doing:

./configure --prefix=$GDAL_INSTALL \
  --with-libtiff=internal \
  --with-geotiff=internal \
  --with-rename-internal-libtiff-symbols=yes \
  --with-rename-internal-libgeotiff-symbols=yes

on Linux, but how can I accomplish this when building on Windows with the
MSVC++ compiler?



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/building-gdal-on-windows-how-to-hide-internal-libtiff-symbols-tp5089510.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at mines-paris.org  Sun Nov 17 02:46:59 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sun, 17 Nov 2013 11:46:59 +0100
Subject: [gdal-dev] building gdal on windows -- how to hide internal
	libtiff symbols
In-Reply-To: <1384655595975-5089510.post@n6.nabble.com>
References: <1384655595975-5089510.post@n6.nabble.com>
Message-ID: <201311171146.59855.even.rouault@mines-paris.org>

Le dimanche 17 novembre 2013 03:33:15, kyle.sletmoe a ?crit :
> I am building on Windows and would like to know how to hide the internal
> libtiff (and libgeotiff) symbols. I know about doing:
> 
> ./configure --prefix=$GDAL_INSTALL \
>   --with-libtiff=internal \
>   --with-geotiff=internal \
>   --with-rename-internal-libtiff-symbols=yes \
>   --with-rename-internal-libgeotiff-symbols=yes
> 
> on Linux, but how can I accomplish this when building on Windows with the
> MSVC++ compiler?

Kyle,

I don't think that you need the rename options on Windows. The libtiff and 
libgeotiff symbols from the internal lib shouldn't be exposed to outside of 
GDAL. At least, I'm not aware of anyone having reported issues on Windows 
related to that, whereas the problem was confirmed on Linux.

> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/building-gdal-on-windows-how-to-hide-i
> nternal-libtiff-symbols-tp5089510.html Sent from the GDAL - Dev mailing
> list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From jun.xiong1981 at gmail.com  Sun Nov 17 19:13:40 2013
From: jun.xiong1981 at gmail.com (Jun Xiong)
Date: Sun, 17 Nov 2013 20:13:40 -0700
Subject: [gdal-dev] How to implement tile read / write to gdal supported
	format file?
Message-ID: <CAODwqSmbWf_6ag8GJspsf8_tGyBt3R6=VOnRrLm8jXPMwsJK6Q@mail.gmail.com>

Hi All,

I have several 2.5 Gb geotiff files which are needed to be processed in
memory.  I wrote a script with python + gdal but was killed by
administrator but I occupied too much resources.

I guess I need to partition these files into smaller piece and process them
one by one. No idea about it?

Any suggestion?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131117/5a8d2790/attachment.html>

From lhomme.xavier at gmail.com  Mon Nov 18 01:00:15 2013
From: lhomme.xavier at gmail.com (xavier lhomme)
Date: Mon, 18 Nov 2013 10:00:15 +0100
Subject: [gdal-dev] Support USRP
In-Reply-To: <201311152024.21392.even.rouault@mines-paris.org>
References: <CACqzBMxWN=UXhHAqv8fRMsotWnbBQbWwX1_d9L3m=n99Qwhg1w@mail.gmail.com>
	<201311152024.21392.even.rouault@mines-paris.org>
Message-ID: <CACqzBMwN5xtL_hB4-Tqp=2M4sODkcJ903_xBSZx=krB4mtj2LQ@mail.gmail.com>

Hi

  What should be the return of gdalinfo after reading a TRANSH01.THF :
   I have added all IMG in subdatasets. But should I set a SpatialReference
and Extent for the main dataset (by merging all Extent in one ) ?

xav


2013/11/15 Even Rouault <even.rouault at mines-paris.org>

> Le jeudi 14 novembre 2013 10:35:35, xavier lhomme a ?crit :
> > Hi
> >
> >   I have a USRP product with several images organized with
> >    a THF file which describe all containing image and a directory for
> each
> > image
> > (with  .Gen, .SOU, .IMG and a .QAL ).
> > The ASRP/USRP driver recognize .IMG file as explain in the web site.
> >
> > ASRP/USRP is related to ADRG (and source code is stored in the ADRG
> > directory)
> > the ADRG driver is able to recognize THF file
> >
> > Is it possible to improve ASRP/USRP driver to support THF files ?
>
> That is undoubtedly technically doable. The THF being a catalog, the best
> use
> of it I can see in an enhanced driver would be to report those images as
> SUBDATASETS of the THF dataset.
>
> >
> >
> > Best regards
> > xlhomme
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131118/8e1dc837/attachment.html>

From even.rouault at mines-paris.org  Mon Nov 18 01:26:30 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 18 Nov 2013 10:26:30 +0100
Subject: [gdal-dev] Support USRP
In-Reply-To: <CACqzBMwN5xtL_hB4-Tqp=2M4sODkcJ903_xBSZx=krB4mtj2LQ@mail.gmail.com>
References: <CACqzBMxWN=UXhHAqv8fRMsotWnbBQbWwX1_d9L3m=n99Qwhg1w@mail.gmail.com>
	<201311152024.21392.even.rouault@mines-paris.org>
	<CACqzBMwN5xtL_hB4-Tqp=2M4sODkcJ903_xBSZx=krB4mtj2LQ@mail.gmail.com>
Message-ID: <1384766790.5289dd4694418@imp.free.fr>

Selon xavier lhomme <lhomme.xavier at gmail.com>:

> Hi
>
>   What should be the return of gdalinfo after reading a TRANSH01.THF :
>    I have added all IMG in subdatasets. But should I set a SpatialReference
> and Extent for the main dataset (by merging all Extent in one ) ?

Datasets that only report subdatasets generally don't define any spatial
reference or extent. Basically they keep with the defaults of the GDALDataset
constructor.

>
> xav
>
>
> 2013/11/15 Even Rouault <even.rouault at mines-paris.org>
>
> > Le jeudi 14 novembre 2013 10:35:35, xavier lhomme a ?crit :
> > > Hi
> > >
> > >   I have a USRP product with several images organized with
> > >    a THF file which describe all containing image and a directory for
> > each
> > > image
> > > (with  .Gen, .SOU, .IMG and a .QAL ).
> > > The ASRP/USRP driver recognize .IMG file as explain in the web site.
> > >
> > > ASRP/USRP is related to ADRG (and source code is stored in the ADRG
> > > directory)
> > > the ADRG driver is able to recognize THF file
> > >
> > > Is it possible to improve ASRP/USRP driver to support THF files ?
> >
> > That is undoubtedly technically doable. The THF being a catalog, the best
> > use
> > of it I can see in an enhanced driver would be to report those images as
> > SUBDATASETS of the THF dataset.
> >
> > >
> > >
> > > Best regards
> > > xlhomme
> >
> > --
> > Geospatial professional services
> > http://even.rouault.free.fr/services.html
> >
>



From lhomme.xavier at gmail.com  Mon Nov 18 04:45:32 2013
From: lhomme.xavier at gmail.com (xavier lhomme)
Date: Mon, 18 Nov 2013 13:45:32 +0100
Subject: [gdal-dev] Support USRP
In-Reply-To: <1384766790.5289dd4694418@imp.free.fr>
References: <CACqzBMxWN=UXhHAqv8fRMsotWnbBQbWwX1_d9L3m=n99Qwhg1w@mail.gmail.com>
	<201311152024.21392.even.rouault@mines-paris.org>
	<CACqzBMwN5xtL_hB4-Tqp=2M4sODkcJ903_xBSZx=krB4mtj2LQ@mail.gmail.com>
	<1384766790.5289dd4694418@imp.free.fr>
Message-ID: <CACqzBMyh2VrsgsdwFPL3p_8QpDxoJziU9aMYCc_FWV9Cnb3=cA@mail.gmail.com>

Hi
 I've submitted a ticket #5297 and attached a new version of the usrp/asrp
driver.

Best Regards


2013/11/18 Even Rouault <even.rouault at mines-paris.org>

> Selon xavier lhomme <lhomme.xavier at gmail.com>:
>
> > Hi
> >
> >   What should be the return of gdalinfo after reading a TRANSH01.THF :
> >    I have added all IMG in subdatasets. But should I set a
> SpatialReference
> > and Extent for the main dataset (by merging all Extent in one ) ?
>
> Datasets that only report subdatasets generally don't define any spatial
> reference or extent. Basically they keep with the defaults of the
> GDALDataset
> constructor.
>
> >
> > xav
> >
> >
> > 2013/11/15 Even Rouault <even.rouault at mines-paris.org>
> >
> > > Le jeudi 14 novembre 2013 10:35:35, xavier lhomme a ?crit :
> > > > Hi
> > > >
> > > >   I have a USRP product with several images organized with
> > > >    a THF file which describe all containing image and a directory for
> > > each
> > > > image
> > > > (with  .Gen, .SOU, .IMG and a .QAL ).
> > > > The ASRP/USRP driver recognize .IMG file as explain in the web site.
> > > >
> > > > ASRP/USRP is related to ADRG (and source code is stored in the ADRG
> > > > directory)
> > > > the ADRG driver is able to recognize THF file
> > > >
> > > > Is it possible to improve ASRP/USRP driver to support THF files ?
> > >
> > > That is undoubtedly technically doable. The THF being a catalog, the
> best
> > > use
> > > of it I can see in an enhanced driver would be to report those images
> as
> > > SUBDATASETS of the THF dataset.
> > >
> > > >
> > > >
> > > > Best regards
> > > > xlhomme
> > >
> > > --
> > > Geospatial professional services
> > > http://even.rouault.free.fr/services.html
> > >
> >
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131118/977787bd/attachment.html>

From antti.castren at iki.fi  Mon Nov 18 04:54:01 2013
From: antti.castren at iki.fi (=?ISO-8859-1?Q?Antti_Castr=E9n?=)
Date: Mon, 18 Nov 2013 14:54:01 +0200
Subject: [gdal-dev] [PATCH v2] Support Mercator_2SP in GeoTIFF
In-Reply-To: <CA+7tXiga3wM_eQnb4vg=aPEpJnDNa3b+HRyhEwDkDighMFfe=g@mail.gmail.com>
References: <CAPcvoOJctLnpVBa=X9V0HHELv1vvRjbGzhuHNc0zsNptUkNrfw@mail.gmail.com>
	<CA+7tXiga3wM_eQnb4vg=aPEpJnDNa3b+HRyhEwDkDighMFfe=g@mail.gmail.com>
Message-ID: <CAPcvoOLeCJVm_=VqAKhN5owdRwQ_sNNSX7LHfV1fuJTOdjsVLA@mail.gmail.com>

Hi Trent,

The chart  opens in ArcMap (ArcGIS 10.0) well, and it is in right
location (Seattle).

Relevant properties of the file as seen by ArcGIS:
Cell Size: 240.003787, 240.003787
Extent
Top:4143530.20898
Left: -9278434.53415
Right:  -9165872.75807
Bottom:  3984167.69444
Spatial Reference: Global Mercator
Linear Unit: Meter
false_easting: 0
false_northing: 0
central_meridian: 0
standard_parallel_1:  47.667
Datum: D_North_American_1983


I opened the file in FME Data Inspector (FME Desktop 2013 SP1) also.
It did not read the latitude of true scale from the
ProjStdParallel1GeoKey as you can see from the following parameters.
Therefore it places the chart to NE Georgia/NW South Carolina as if
the latitude of true scale was the Equator.

<FME Parameters>
Coordinate System Parameters
CS_NAME: _FME_0
DESC_NM: Global Mercator
DT_NAME: NAD83
PROJ: MRCAT
UNIT: METER

Datum Parameters
DESC_NM: NAD 1983, Alaska, Canada,Continental US,Mexico,Central America
ELLIPSOID: GRS1980
SOURCE: US Defense Mapping Agency, TR-8350.2-B, August 1993
USE: NAD83

Ellipsoid Parameters
DESC_NM: Geodetic Reference System of 1980
E_RAD: 6378137
P_RAD: 6356752.3141403478
SOURCE: Stem, L.E., Jan 1989, State Plane Coordinate System of 1983

OGC WKT Description
PROJCS["Global Mercator",
    GEOGCS["NAD83",
        DATUM["North_American_Datum_1983",
            SPHEROID["Geodetic Reference System of
1980",6378137,298.2572221008916,
                AUTHORITY["EPSG","7019"]],
            AUTHORITY["EPSG","6269"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4269"]],
    PROJECTION["Mercator_1SP"],
    PARAMETER["central_meridian",0],
    PARAMETER["scale_factor",1],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["METER",1]]

Esri WKT Description
PROJCS["Global_Mercator",GEOGCS["GCS_North_American_1983",DATUM["D_North_American_1983",SPHEROID["Geodetic_Reference_System_of_1980",6378137,298.2572221008916]],PRIMEM["Greenwich",0],UNIT["Degree",0.017453292519943295]],PROJECTION["Mercator"],PARAMETER["central_meridian",0],PARAMETER["false_easting",0],PARAMETER["false_northing",0],UNIT["Meter",1],PARAMETER["standard_parallel_1",0.0]]
</FME Parameters>

Intergraph's Geomedia Professional recognises the file as GeoTIFF, but
the chart appears to be in the same false place as with FME.

If you want, I could update the file's georeferencing by FME and
Geomedia so that location is correct. Then I could send listgeo
information or even put the actual files available if desired.

The goal is, of course, to get various software vendors to use the
GeoTIFF-information the same way. Hopefully the common way would also
be logically correct, but I guess that's too much to ask.

Best regards,

  Antti


Here is the listgeo info from the original file for those who are interested:

Geotiff_Information:
   Version: 1
   Key_Revision: 1.0
   Tagged_Information:
      ModelTiepointTag (2,3):
         0                0                0
         -9278434.53      4143530.21       0
      ModelPixelScaleTag (1,3):
         240.003787       240.003787       0
      End_Of_Tags.
   Keyed_Information:
      GTModelTypeGeoKey (Short,1): ModelTypeProjected
      GTRasterTypeGeoKey (Short,1): RasterPixelIsArea
      GTCitationGeoKey (Ascii,16): "Global Mercator"
      GeographicTypeGeoKey (Short,1): GCS_NAD83
      GeogCitationGeoKey (Ascii,6): "NAD83"
      GeogAngularUnitsGeoKey (Short,1): Angular_Degree
      GeogSemiMajorAxisGeoKey (Double,1): 6378137
      GeogInvFlatteningGeoKey (Double,1): 298.257222
      Unknown-2062 (Double,3): 0                0                0
      ProjectedCSTypeGeoKey (Short,1): User-Defined
      ProjectionGeoKey (Short,1): User-Defined
      ProjCoordTransGeoKey (Short,1): CT_Mercator
      ProjLinearUnitsGeoKey (Short,1): Linear_Meter
      ProjStdParallel1GeoKey (Double,1): 47.667
      ProjNatOriginLongGeoKey (Double,1): 0
      ProjNatOriginLatGeoKey (Double,1): 0
      ProjFalseEastingGeoKey (Double,1): 0
      ProjFalseNorthingGeoKey (Double,1): 0
      ProjScaleAtNatOriginGeoKey (Double,1): 1
      End_Of_Keys.
   End_Of_Geotiff.
Projection Method: CT_Mercator
   ProjNatOriginLatGeoKey: 0.000000 (  0d 0' 0.00"N)
   ProjNatOriginLongGeoKey: 0.000000 (  0d 0' 0.00"E)
   ProjScaleAtNatOriginGeoKey: 1.000000
   ProjFalseEastingGeoKey: 0.000000 m
   ProjFalseNorthingGeoKey: 0.000000 m
GCS: 4269/NAD83
Datum: 6269/North American Datum 1983
Ellipsoid: 7019/GRS 1980 (6378137.00,6356752.31)
Prime Meridian: 8901/Greenwich (0.000000/  0d 0' 0.00"E)
Projection Linear Units: 9001/metre (1.000000m)
Corner Coordinates:
Upper Left    (-9278434.534, 4143530.209)
Lower Left    (-9278434.534, 3984167.694)
Upper Right   (-9165872.758, 4143530.209)
Lower Right   (-9165872.758, 3984167.694)
Center        (-9222153.646, 4063848.952)


2013/11/14 Trent Piepho <tpiepho at gmail.com>:
> It looks like arcgis does not support Mercator_1SP in geotiff files.
> It just ignores the scale factor and uses 1.0.  Which means in GDAL
> and libgeotiff as they are now, there is no way to export Mercator
> projections that don't have a scale of 1.0 to arcgis.
>
> ArcGIS does support Mercator_2SP, but instead of placing the latitude
> of true scale in ProjStdParallel1GeoKey, it uses
> ProjNatOriginLatGeoKey.  Which seems to be plainly wrong, yet that's
> what it does.
>
> I wonder if ESRI used libgeotiff?  With unpatched libgeotiff, the only
> way to get a latitude from a Mercator geotiff it to use one of the
> origin latitude GeoKeys.  It's not correct, but it does allow one to
> stick the number in the file and get it back out without having to
> modify or understand any libgeotiff code.
>
> It's possible that ArcGIS supports getting the latitude of true scale
> from ProjStdParallel1GeoKey, even it it doesn't store it there.
> Antii, could you test this file with ArcGIS?
>
> https://drive.google.com/file/d/0BybuTedE9CLxak9iakZRTC00cHM/edit?usp=sharing
>
> Pick file->download to get the geotiff file.
>
> It should have projection information like this:
>     PROJECTION["Mercator_2SP"],
>     PARAMETER["standard_parallel_1",47.667],
>     PARAMETER["central_meridian",0],
>     PARAMETER["false_easting",0],
>     PARAMETER["false_northing",0],
>     UNIT["metre",1,
>         AUTHORITY["EPSG","9001"]]]
> Origin = (-9278434.534151820465922,4143530.208984711207449)
> Pixel Size = (240.003786961970206,-240.003786961970206)
> Corner Coordinates:
> Upper Left  (-9278434.534, 4143530.209) (123d32'26.22"W, 48d23'56.59"N)
> Lower Left  (-9278434.534, 3984167.694) (123d32'26.22"W, 46d57'58.64"N)
> Upper Right (-9165872.758, 4143530.209) (122d 2'30.76"W, 48d23'56.59"N)
> Lower Right (-9165872.758, 3984167.694) (122d 2'30.76"W, 46d57'58.64"N)
> Center      (-9222153.646, 4063848.952) (122d47'28.49"W, 47d41'15.43"N)

From fabian.schindler at eox.at  Mon Nov 18 07:40:25 2013
From: fabian.schindler at eox.at (Fabian Schindler)
Date: Mon, 18 Nov 2013 16:40:25 +0100
Subject: [gdal-dev] Patch: Improvements to the rasdaman driver
Message-ID: <528A34E9.1090804@eox.at>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Devs,

I implemented a couple of improvements of the GDAL rasdaman driver.
Ticket with a detailed description of the changes and patch are
available here: http://trac.osgeo.org/gdal/ticket/5298


Of course, I appreciate any feedback and I hope the patch will be applied!

Cheers,
Fabian
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://www.enigmail.net/

iQEcBAEBAgAGBQJSijTpAAoJEJoaok7HgajKsXsH/0bjVpeaH1CSanzEvYQrAqpt
fGbv5mfNPoJ/CIh+eiA12UWVqOfkEUhsLsOHqKdPyWxTFUHt2++U4mBKyk0LbtsX
ihJZFoZ0VGnrwqvoHgbha44f7QIX5iDTsuVuMIN6Q+8cNOX1vckyGMDMzSmdSGDR
2mmm80nAtOxdVF5OwMaOXBCF2DraVMPjk0xd9sntSGJ1EgQgfxUP2p5w7ItTP+UG
pAw0xK+D+0kpoj4vkyq2qWWTkC56O1GLUoZP8s1WkdhxMWRCtkrKKevDpdStg2NU
kPtLu0/fc2IqU9d/lL4PJhlS7kMjJ5wz4XWuJ0whwlAx27MNWH6L5P1bdaSCyWs=
=MOCq
-----END PGP SIGNATURE-----

From robbkwright at gmail.com  Mon Nov 18 08:36:54 2013
From: robbkwright at gmail.com (Robb K. Wright)
Date: Mon, 18 Nov 2013 11:36:54 -0500
Subject: [gdal-dev] ogr2og / forcing a +-180 system
Message-ID: <528A4226.7080702@gmail.com>


I need to use ogr2ogr (or any other command line) to convert a shapefile 
with longitudes spanning from -220 to -60, forcing it into a +-180 
scheme, so the -220 coordinate would come out as +140 and the -60 stays 
as -60.  I don't need to worry about the polys that actually cross the 
180 line.

Any thoughts?  I was thinking that running it through EPSG:4326 would 
reshape it (as it does in Esri-land), but no luck.

Robb




From warmerdam at pobox.com  Mon Nov 18 09:50:50 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon, 18 Nov 2013 09:50:50 -0800
Subject: [gdal-dev] ogr2og / forcing a +-180 system
In-Reply-To: <528A4226.7080702@gmail.com>
References: <528A4226.7080702@gmail.com>
Message-ID: <CA+YzLBeoUBpX3C=8+6QPRj0R8EQFTKwdyT6p9HpcrOREV4yRCA@mail.gmail.com>

Robb,

Have you tried the -wrapdateline switch?  I do not believe geometries that
cross the dateline will be handled ideally (they aren't split as one might
hope), but if you don't have them then the rest of the geometries should be
wrapped.  I see there is even now a -datelineoffset switch if someone
needed 0 to 360.

Best regards,
Frank


On Mon, Nov 18, 2013 at 8:36 AM, Robb K. Wright <robbkwright at gmail.com>wrote:

>
> I need to use ogr2ogr (or any other command line) to convert a shapefile
> with longitudes spanning from -220 to -60, forcing it into a +-180 scheme,
> so the -220 coordinate would come out as +140 and the -60 stays as -60.  I
> don't need to worry about the polys that actually cross the 180 line.
>
> Any thoughts?  I was thinking that running it through EPSG:4326 would
> reshape it (as it does in Esri-land), but no luck.
>
> Robb
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131118/716c27ad/attachment.html>

From james at agritech.co.uk  Mon Nov 18 10:14:15 2013
From: james at agritech.co.uk (JSz)
Date: Mon, 18 Nov 2013 10:14:15 -0800 (PST)
Subject: [gdal-dev] Generated KML incorrectly formated and image reflected
	in X axis
Message-ID: <1384798455078-5089715.post@n6.nabble.com>

Good evening,

I have generated an KMZ file using :
gdal_translate.exe -of KMLSUPEROVERLAY EM_RESULTS.tiff EM_RESULTS.kmz -co
FORMAT=JPEG

Opening the KMZ on its own with GoogleEarth doesnt display anything, if I
extract the tiles directly out the KML and extract to Desktop and drill down
I can open the KML / images.  However the image when overlayed in GE seems
to be reflected in the X axis.
 
<http://osgeo-org.1560.x6.nabble.com/file/n5089715/Capture.png> 


gdal_grid -a invdist:smoothing=0:radius1=0.0004:radius2=0.0004 -of GTiff
-zField hcp_cond -ot Float64 -l data EMSCANNING.vrt EM_RESULTS.tiff


<OGRVRTDataSource>
<OGRVRTLayer name="data">
<SrcDataSource>data.csv</SrcDataSource>
<GeometryType>wkbPoint</GeometryType>
<LayerSRS>WGS84</LayerSRS>
<GeometryField separator=" " encoding="PointFromColumns" x="lon" y="lat"
z="hcp_cond"/>
</OGRVRTLayer>
</OGRVRTDataSource>




Any pointers or suggestions on resolving both the projection and KMZ
structure?




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Generated-KML-incorrectly-formated-and-image-reflected-in-X-axis-tp5089715.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From robbkwright at gmail.com  Mon Nov 18 11:29:07 2013
From: robbkwright at gmail.com (Robb K. Wright)
Date: Mon, 18 Nov 2013 14:29:07 -0500
Subject: [gdal-dev] ogr2og / forcing a +-180 system
In-Reply-To: <CA+YzLBeoUBpX3C=8+6QPRj0R8EQFTKwdyT6p9HpcrOREV4yRCA@mail.gmail.com>
References: <528A4226.7080702@gmail.com>
	<CA+YzLBeoUBpX3C=8+6QPRj0R8EQFTKwdyT6p9HpcrOREV4yRCA@mail.gmail.com>
Message-ID: <528A6A83.5030803@gmail.com>


I haven't been able to get either -wrapdateline or -datelineoffset to 
alter the coords.  As far as I can figure out, the -wrapdateline option 
only operates on features that actually intersect the 180 line, so using 
it doesn't alter my coords since mine are only on either side.  I'm just 
trying to shift any polys <-180 to be have long +360.  Here's a sample 
shape if anybody wants to take a swing:  
http://branewright.org/test/test_file.zip

Robb

On 11/18/13 12:50 PM, Frank Warmerdam wrote:
> Robb,
>
> Have you tried the -wrapdateline switch?  I do not believe geometries 
> that cross the dateline will be handled ideally (they aren't split as 
> one might hope), but if you don't have them then the rest of the 
> geometries should be wrapped.  I see there is even now a 
> -datelineoffset switch if someone needed 0 to 360.
>
> Best regards,
> Frank
>
>
> On Mon, Nov 18, 2013 at 8:36 AM, Robb K. Wright <robbkwright at gmail.com 
> <mailto:robbkwright at gmail.com>> wrote:
>
>
>     I need to use ogr2ogr (or any other command line) to convert a
>     shapefile with longitudes spanning from -220 to -60, forcing it
>     into a +-180 scheme, so the -220 coordinate would come out as +140
>     and the -60 stays as -60.  I don't need to worry about the polys
>     that actually cross the 180 line.
>
>     Any thoughts?  I was thinking that running it through EPSG:4326
>     would reshape it (as it does in Esri-land), but no luck.
>
>     Robb
>
>
>
>     _______________________________________________
>     gdal-dev mailing list
>     gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>     http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
> -- 
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, 
> warmerdam at pobox.com <mailto:warmerdam at pobox.com>
> light and sound - activate the windows | http://pobox.com/~warmerdam 
> <http://pobox.com/%7Ewarmerdam>
> and watch the world go round - Rush    | Geospatial Software Developer


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131118/8a35b5ff/attachment.html>

From even.rouault at mines-paris.org  Mon Nov 18 11:36:05 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 18 Nov 2013 20:36:05 +0100
Subject: [gdal-dev] Generated KML incorrectly formated and image
	reflected in X axis
In-Reply-To: <1384798455078-5089715.post@n6.nabble.com>
References: <1384798455078-5089715.post@n6.nabble.com>
Message-ID: <201311182036.05421.even.rouault@mines-paris.org>

Le lundi 18 novembre 2013 19:14:15, JSz a ?crit :
> Good evening,
> 
> I have generated an KMZ file using :
> gdal_translate.exe -of KMLSUPEROVERLAY EM_RESULTS.tiff EM_RESULTS.kmz -co
> FORMAT=JPEG
> 
> Opening the KMZ on its own with GoogleEarth doesnt display anything, if I
> extract the tiles directly out the KML and extract to Desktop and drill
> down I can open the KML / images.  However the image when overlayed in GE
> seems to be reflected in the X axis.
> 
> <http://osgeo-org.1560.x6.nabble.com/file/n5089715/Capture.png>
> 
> 
> gdal_grid -a invdist:smoothing=0:radius1=0.0004:radius2=0.0004 -of GTiff
> -zField hcp_cond -ot Float64 -l data EMSCANNING.vrt EM_RESULTS.tiff

gdal_grid generates by default images with bottom-left corner as origin, 
whereas the usual convention is top-left. So this is perhaps your issue. You 
could try to do : "gdalwarp EM_RESULTS.tiff EM_RESULTS_warped.tiff" and 
gdal_translate this intermediary file to KMLSUPEROVERLAY.

> 
> 
> <OGRVRTDataSource>
> <OGRVRTLayer name="data">
> <SrcDataSource>data.csv</SrcDataSource>
> <GeometryType>wkbPoint</GeometryType>
> <LayerSRS>WGS84</LayerSRS>
> <GeometryField separator=" " encoding="PointFromColumns" x="lon" y="lat"
> z="hcp_cond"/>
> </OGRVRTLayer>
> </OGRVRTDataSource>
> 
> 
> 
> 
> Any pointers or suggestions on resolving both the projection and KMZ
> structure?
> 
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/Generated-KML-incorrectly-formated-and
> -image-reflected-in-X-axis-tp5089715.html Sent from the GDAL - Dev mailing
> list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From kyle.sletmoe at urbanrobotics.net  Mon Nov 18 12:07:40 2013
From: kyle.sletmoe at urbanrobotics.net (kyle.sletmoe)
Date: Mon, 18 Nov 2013 12:07:40 -0800 (PST)
Subject: [gdal-dev] building gdal on windows -- how to hide internal
 libtiff symbols
In-Reply-To: <201311171146.59855.even.rouault@mines-paris.org>
References: <1384655595975-5089510.post@n6.nabble.com>
	<201311171146.59855.even.rouault@mines-paris.org>
Message-ID: <1384805260860-5089742.post@n6.nabble.com>

Even,

Oh, OK I was not aware of this. Thanks for the help.

Regards,
Kyle



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/building-gdal-on-windows-how-to-hide-internal-libtiff-symbols-tp5089510p5089742.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From james at agritech.co.uk  Mon Nov 18 13:33:34 2013
From: james at agritech.co.uk (JSz)
Date: Mon, 18 Nov 2013 13:33:34 -0800 (PST)
Subject: [gdal-dev] Generated KML incorrectly formated and image
 reflected in X axis
In-Reply-To: <201311182036.05421.even.rouault@mines-paris.org>
References: <1384798455078-5089715.post@n6.nabble.com>
	<201311182036.05421.even.rouault@mines-paris.org>
Message-ID: <1384810414112-5089752.post@n6.nabble.com>

Perfect, that solved the projection issue.

Have you any ideas why the KMZ file isn't able to open in google earth but
if I remove the individual parts ( 0.kml and 0.png ) and open all is ok?

Alternativly is there a way to just generate the KML file directly rather
than with :

gdal_translate.exe -of KMLSUPEROVERLAY MY_TIFF_File.tiff Output.kmz -co
FORMAT=PNG

J



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Generated-KML-incorrectly-formated-and-image-reflected-in-X-axis-tp5089715p5089752.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at mines-paris.org  Mon Nov 18 16:49:12 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 19 Nov 2013 01:49:12 +0100
Subject: [gdal-dev] ogr2og / forcing a +-180 system
In-Reply-To: <528A6A83.5030803@gmail.com>
References: <528A4226.7080702@gmail.com>
	<CA+YzLBeoUBpX3C=8+6QPRj0R8EQFTKwdyT6p9HpcrOREV4yRCA@mail.gmail.com>
	<528A6A83.5030803@gmail.com>
Message-ID: <201311190149.12760.even.rouault@mines-paris.org>

Le lundi 18 novembre 2013 20:29:07, Robb K. Wright a ?crit :
> I haven't been able to get either -wrapdateline or -datelineoffset to
> alter the coords.  As far as I can figure out, the -wrapdateline option
> only operates on features that actually intersect the 180 line, so using
> it doesn't alter my coords since mine are only on either side.  I'm just
> trying to shift any polys <-180 to be have long +360.  Here's a sample
> shape if anybody wants to take a swing:
> http://branewright.org/test/test_file.zip

Robb,

I can think of 2 ways :

- doing an intermediate reprojection to EPSG:3857, and then reprojecting the 
result to EPSG:4326.

ogr2ogr tmp.shp test5.shp -t_srs EPSG:3857
ogr2ogr test5_shifted.shp tmp.shp -t_srs EPSG:4326

- with GDAL 1.10 and Spatialite 4.0, using the spatialite ST_Shift_Longitude() 
function :

ogr2ogr test5_shifted.shp test5.shp -dialect sqlite \
   -sql "select ST_Shift_Longitude(geometry) as GEOMETRY, * from test5" 

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From kyle.sletmoe at urbanrobotics.net  Mon Nov 18 16:55:21 2013
From: kyle.sletmoe at urbanrobotics.net (Kyle Sletmoe)
Date: Mon, 18 Nov 2013 16:55:21 -0800
Subject: [gdal-dev] set authenticate set delivery off
Message-ID: <CAPr8K=mE=QajZzeKqeDtAibY_84NdYaxgpPtZUOJVaipxG8S8g@mail.gmail.com>

set authenticate set delivery off

-- 
*Information contained herein is subject to the Code of Federal Regulations 
Chapter 22 International Traffic in Arms Regulations. This data may not be 
resold, diverted, transferred, transshipped, made available to a foreign 
national within the United States, or otherwise disposed of in any other 
country outside of its intended destination, either in original form or 
after being incorporated through an intermediate process into other data 
without the prior written approval of the US Department of State.  **Penalties 
for violation include bans on defense and military work, fines and 
imprisonment.*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131118/516ddc5e/attachment.html>

From lukepinnerau at gmail.com  Mon Nov 18 23:34:16 2013
From: lukepinnerau at gmail.com (Luke)
Date: Mon, 18 Nov 2013 23:34:16 -0800 (PST)
Subject: [gdal-dev] How to implement tile read / write to gdal supported
 format file?
In-Reply-To: <CAODwqSmbWf_6ag8GJspsf8_tGyBt3R6=VOnRrLm8jXPMwsJK6Q@mail.gmail.com>
References: <CAODwqSmbWf_6ag8GJspsf8_tGyBt3R6=VOnRrLm8jXPMwsJK6Q@mail.gmail.com>
Message-ID: <1384846456100-5089803.post@n6.nabble.com>

You could do something like the following:
(code modified from the gdal_calculations library -
http://code.google.com/p/gdal-calculations)

from osgeo import gdal

class Block(object):

    def __init__(self, dataset, band, xoff, yoff, xsize, ysize):
        self.xoff = xoff
        self.yoff = yoff
        self.xsize = xsize
        self.ysize = ysize
        if not band: self.data = dataset.ReadAsArray(xoff, yoff, xsize,
ysize)
        else: self.data = dataset.GetRasterBand(band).ReadAsArray(xoff,
yoff, xsize, ysize)

def read_blocks_as_array(dataset, band=0, nblocks=1):
    '''Read GDAL Datasets or individual Bands block by block'''

    ncols=dataset.RasterXSize()
    nrows=dataset.RasterYSize()
    xblock,yblock=dataset.GetRasterBand(1).GetBlockSize()

    if xblock==ncols:
        yblock*=nblocks
    else:
        xblock*=nblocks

    for yoff in xrange(0, nrows, yblock):

        if yoff + yblock < nrows:
            ysize = yblock
        else:
            ysize  = nrows - yoff

        for xoff in xrange(0, ncols, xblock):
            if xoff + xblock < ncols:
                xsize  = xblock
            else:
                xsize = ncols - xoff

            yield Block(dataset, band, xoff, yoff, xsize, ysize)
            

ds1=gdal.Open(some_raster)
ds2=gdal.Open(another_raster)
out_driver=gdal.GetDriverByName('GTIFF')
out_ds=out_driver.Create (out_raster,ds1.RasterXSize(),ds1.RasterYSize(),
                               1,ds1.GetRasterBand(1).DataType,
                               ['BIGTIFF=IF_SAFER'])

out_ds.SetGeoTransform(ds1.GetGeoTransform())
out_ds.SetProjection(ds1.GetProjection())
out_band=out_ds.GetRasterBand(1)

for block in read_blocks_as_array(ds1,band=1,nblocks=10):
    block2=Block(ds2, 1, block.xoff, block.yoff, block.xsize, block.ysize)
    ndarray1=block.data
    ndarray2=block2.data
    result = ndarray1+ndarray2
    out_band.WriteArray(result, block.xoff, block.yoff)



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-How-to-implement-tile-read-write-to-gdal-supported-format-file-tp5089581p5089803.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From robbkwright at gmail.com  Tue Nov 19 04:19:43 2013
From: robbkwright at gmail.com (Robb K. Wright)
Date: Tue, 19 Nov 2013 07:19:43 -0500
Subject: [gdal-dev] ogr2og / forcing a +-180 system
In-Reply-To: <201311190149.12760.even.rouault@mines-paris.org>
References: <528A4226.7080702@gmail.com>
	<CA+YzLBeoUBpX3C=8+6QPRj0R8EQFTKwdyT6p9HpcrOREV4yRCA@mail.gmail.com>
	<528A6A83.5030803@gmail.com>
	<201311190149.12760.even.rouault@mines-paris.org>
Message-ID: <528B575F.1000902@gmail.com>


Perfect!  The double project fits my needs exactly.

Robb


On 11/18/13 7:49 PM, Even Rouault wrote:
> Le lundi 18 novembre 2013 20:29:07, Robb K. Wright a ?crit :
>> I haven't been able to get either -wrapdateline or -datelineoffset to
>> alter the coords.  As far as I can figure out, the -wrapdateline option
>> only operates on features that actually intersect the 180 line, so using
>> it doesn't alter my coords since mine are only on either side.  I'm just
>> trying to shift any polys <-180 to be have long +360.  Here's a sample
>> shape if anybody wants to take a swing:
>> http://branewright.org/test/test_file.zip
> Robb,
>
> I can think of 2 ways :
>
> - doing an intermediate reprojection to EPSG:3857, and then reprojecting the
> result to EPSG:4326.
>
> ogr2ogr tmp.shp test5.shp -t_srs EPSG:3857
> ogr2ogr test5_shifted.shp tmp.shp -t_srs EPSG:4326
>
> - with GDAL 1.10 and Spatialite 4.0, using the spatialite ST_Shift_Longitude()
> function :
>
> ogr2ogr test5_shifted2.shp test5.shp -dialect sqlite \
>     -sql "select ST_Shift_Longitude(geometry) as GEOMETRY, * from test5"
>
> Even
>



From martin.pineault at geo-plus.com  Tue Nov 19 05:32:01 2013
From: martin.pineault at geo-plus.com (Martin Pineault)
Date: Tue, 19 Nov 2013 08:32:01 -0500
Subject: [gdal-dev] gdal for WindowCE
In-Reply-To: <CA+YzLBdwahGkWuV5T0Yjg3o3_9=ffWmJCE=zO3zkswuc2SnhxA@mail.gmail.com>
References: <015e01cee23a$1539e7a0$3fadb6e0$@geo-plus.com>
	<CA+YzLBdwahGkWuV5T0Yjg3o3_9=ffWmJCE=zO3zkswuc2SnhxA@mail.gmail.com>
Message-ID: <002301cee52b$bac65e80$30531b80$@geo-plus.com>

Frank,

 

>From what I read, this wouldn?t solve our problem since GDAL is using the
same huge static library that we do.

In fact, it would be worst since we add GDAL memory requirement on the top
of ODA.

 

Any other solution you may think of ?

 

Thank you.

 

MARTIN PINEAULT
Vice-President, Business Development

 

De : fwarmerdam at gmail.com [mailto:fwarmerdam at gmail.com] De la part de Frank
Warmerdam
Envoy? : 15 novembre 2013 14:48
? : Martin Pineault
Cc : gdal dev
Objet : Re: [gdal-dev] gdal for WindowCE

 

Martin,

 

The only DWG support that I recall depends on the libraries from the Open
Design Alliance and I'm not sure if they work on windows CE.  Also, that
driver has many limitations - rendering the DWG features down to simple
features in OGR.  You might want to investigate that it really gives you
want you want.  Some more info on the DWG driver is available at:

 

 http://www.gdal.org/ogr/drv_dwg.html

 

If it does suit your needs, and the ODA libraries can be built on WinCE then
it would be great to have you helping keeping GDAL/OGR working properly on
WinCE.

 

Best regards,

Frank

 

 

On Fri, Nov 15, 2013 at 11:37 AM, Martin Pineault
<martin.pineault at geo-plus.com> wrote:

Hi,

 

We may be interested in maintaining the CE/Mobile flavor of gdal. But first
someone told us that Autocad DWG files where supported (this is our need).
But can?t find any mention in your web page.

 

Thank you.


MARTIN PINEAULT
Vice-President, Business Development

ligne intermediaire


logo et age cie

 


555, rue de l'Ar?na, suite 102
Saint-Nicolas, Qc, G7A 1E5

 



icone telephone

 

1-888-831-3668, #40 <tel:1-888-831-3668%2C%20%2340> 


icone fax

 

1-866-635-7344


 <mailto:maurice.temfack at geo-plus.com> martin.pineault at geo-plus.com


 

 

 

 


_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev





 

-- 
---------------------------------------+------------------------------------
--
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131119/aca22b94/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 144 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131119/aca22b94/attachment-0001.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image002.gif
Type: image/gif
Size: 5686 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131119/aca22b94/attachment-0001.gif>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image003.jpg
Type: image/jpeg
Size: 882 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131119/aca22b94/attachment-0002.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image004.jpg
Type: image/jpeg
Size: 840 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131119/aca22b94/attachment-0003.jpg>

From howard at hobu.co  Tue Nov 19 08:42:32 2013
From: howard at hobu.co (Howard Butler)
Date: Tue, 19 Nov 2013 10:42:32 -0600
Subject: [gdal-dev] RFC 44: JSON/XML output for ogrinfo/gdalinfo
Message-ID: <F7211CA5-FCB8-4253-8E26-654306A36D90@hobu.co>

All,

Dan Little and myself would like to put forward an RFC proposing -xml and -json output support for both ogrinfo and gdalinfo. No changes are proposed to the current text format (which would continue to be the default output format), but having JSON and XML available would greatly ease the integration of gdalinfo and ogrinfo into existing processing workflows without requiring that someone jump into scripting land. Though it might have been overkill to have an RFC, I thought it would be useful to have something to collaborate on if others have ideas about these particular features. 	

http://trac.osgeo.org/gdal/wiki/rfc44_gdalinfoxml

We look forward to your feedback,

Howard

From mateusz at loskot.net  Tue Nov 19 08:49:20 2013
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue, 19 Nov 2013 16:49:20 +0000
Subject: [gdal-dev] RFC 44: JSON/XML output for ogrinfo/gdalinfo
In-Reply-To: <F7211CA5-FCB8-4253-8E26-654306A36D90@hobu.co>
References: <F7211CA5-FCB8-4253-8E26-654306A36D90@hobu.co>
Message-ID: <CABUeae-n8vyAE+oEaankQvnWxn86UuLXbWv+FoDDjy-KSqce0Q@mail.gmail.com>

On 19 November 2013 16:42, Howard Butler <howard at hobu.co> wrote:
> All,
>
> Dan Little and myself would like to put forward an RFC proposing -xml and -json output support for both ogrinfo and gdalinfo. No changes are proposed to the current text format (which would continue to be the default output format), but having JSON and XML available would greatly ease the integration of gdalinfo and ogrinfo into existing processing workflows without requiring that someone jump into scripting land. Though it might have been overkill to have an RFC, I thought it would be useful to have something to collaborate on if others have ideas about these particular features.
>
> http://trac.osgeo.org/gdal/wiki/rfc44_gdalinfoxml
>
> We look forward to your feedback,

"You don't parse the output of gdalinfo --format, do you?" :P

[1] http://lists.osgeo.org/pipermail/gdal-dev/2013-January/035117.html

Best regards,
-- 
Mateusz  Loskot, http://mateusz.loskot.net

From howard at hobu.co  Tue Nov 19 09:00:22 2013
From: howard at hobu.co (Howard Butler)
Date: Tue, 19 Nov 2013 11:00:22 -0600
Subject: [gdal-dev] RFC 44: JSON/XML output for ogrinfo/gdalinfo
In-Reply-To: <CABUeae-n8vyAE+oEaankQvnWxn86UuLXbWv+FoDDjy-KSqce0Q@mail.gmail.com>
References: <F7211CA5-FCB8-4253-8E26-654306A36D90@hobu.co>
	<CABUeae-n8vyAE+oEaankQvnWxn86UuLXbWv+FoDDjy-KSqce0Q@mail.gmail.com>
Message-ID: <4736572C-8151-4DAA-BDF0-2551D6426E95@hobu.co>


On Nov 19, 2013, at 10:49 AM, Mateusz Loskot <mateusz at loskot.net> wrote:

> On 19 November 2013 16:42, Howard Butler <howard at hobu.co> wrote:
>> All,
>> 
>> Dan Little and myself would like to put forward an RFC proposing -xml and -json output support for both ogrinfo and gdalinfo. No changes are proposed to the current text format (which would continue to be the default output format), but having JSON and XML available would greatly ease the integration of gdalinfo and ogrinfo into existing processing workflows without requiring that someone jump into scripting land. Though it might have been overkill to have an RFC, I thought it would be useful to have something to collaborate on if others have ideas about these particular features.
>> 
>> http://trac.osgeo.org/gdal/wiki/rfc44_gdalinfoxml
>> 
>> We look forward to your feedback,
> 
> "You don't parse the output of gdalinfo --format, do you?" :P
> 
> [1] http://lists.osgeo.org/pipermail/gdal-dev/2013-January/035117.html

I don't, but I fully expect that are there are folks who have, simply due to not having a better, more convenient way to do things. JSON and XML output puts people on the right path at least...

Howard
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 495 bytes
Desc: Message signed with OpenPGP using GPGMail
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131119/dca81c60/attachment.pgp>

From mateusz at loskot.net  Tue Nov 19 09:03:30 2013
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue, 19 Nov 2013 17:03:30 +0000
Subject: [gdal-dev] RFC 44: JSON/XML output for ogrinfo/gdalinfo
In-Reply-To: <4736572C-8151-4DAA-BDF0-2551D6426E95@hobu.co>
References: <F7211CA5-FCB8-4253-8E26-654306A36D90@hobu.co>
	<CABUeae-n8vyAE+oEaankQvnWxn86UuLXbWv+FoDDjy-KSqce0Q@mail.gmail.com>
	<4736572C-8151-4DAA-BDF0-2551D6426E95@hobu.co>
Message-ID: <CABUeae_EEipeT_KO3EAaGtpi4_FEZGZRCypm3gkj80cu7fN21g@mail.gmail.com>

On 19 November 2013 17:00, Howard Butler <howard at hobu.co> wrote:
> On Nov 19, 2013, at 10:49 AM, Mateusz Loskot <mateusz at loskot.net> wrote:
>> On 19 November 2013 16:42, Howard Butler <howard at hobu.co> wrote:
>>> All,
>>>
>>> Dan Little and myself would like to put forward an RFC proposing -xml and -json output support for both ogrinfo and gdalinfo. No changes are proposed to the current text format (which would continue to be the default output format), but having JSON and XML available would greatly ease the integration of gdalinfo and ogrinfo into existing processing workflows without requiring that someone jump into scripting land. Though it might have been overkill to have an RFC, I thought it would be useful to have something to collaborate on if others have ideas about these particular features.
>>>
>>> http://trac.osgeo.org/gdal/wiki/rfc44_gdalinfoxml
>>>
>>> We look forward to your feedback,
>>
>> "You don't parse the output of gdalinfo --format, do you?" :P
>>
>> [1] http://lists.osgeo.org/pipermail/gdal-dev/2013-January/035117.html
>
> I don't, but I fully expect that are there are folks who have, simply due to not having a better,
> more convenient way to do things. JSON and XML output puts people on the right path at least...

Hobu, sure thing.
That was a bit of joke, and, on reflection I think a specified format
is actually useful idea.

Best regards,
-- 
Mateusz  Loskot, http://mateusz.loskot.net

From howard at hobu.co  Tue Nov 19 09:07:24 2013
From: howard at hobu.co (Howard Butler)
Date: Tue, 19 Nov 2013 11:07:24 -0600
Subject: [gdal-dev] RFC 44: JSON/XML output for ogrinfo/gdalinfo
In-Reply-To: <CABUeae_EEipeT_KO3EAaGtpi4_FEZGZRCypm3gkj80cu7fN21g@mail.gmail.com>
References: <F7211CA5-FCB8-4253-8E26-654306A36D90@hobu.co>
	<CABUeae-n8vyAE+oEaankQvnWxn86UuLXbWv+FoDDjy-KSqce0Q@mail.gmail.com>
	<4736572C-8151-4DAA-BDF0-2551D6426E95@hobu.co>
	<CABUeae_EEipeT_KO3EAaGtpi4_FEZGZRCypm3gkj80cu7fN21g@mail.gmail.com>
Message-ID: <424EFCF2-5C8B-4D9E-A9C9-B63FC47D3DF6@hobu.co>


On Nov 19, 2013, at 11:03 AM, Mateusz Loskot <mateusz at loskot.net> wrote:

>>> "You don't parse the output of gdalinfo --format, do you?" :P
>>> 
>>> [1] http://lists.osgeo.org/pipermail/gdal-dev/2013-January/035117.html
>> 
>> I don't, but I fully expect that are there are folks who have, simply due to not having a better,
>> more convenient way to do things. JSON and XML output puts people on the right path at least...
> 
> Hobu, sure thing.
> That was a bit of joke, and, on reflection I think a specified format
> is actually useful idea.

Yes, I know, but it does bring up the issue of what to do when new things are added? Is there a specification/schema/something that provides some sort of forward compatibility? Do we promise to never change the name(s) of things? The free-form text format has been remarkably stable over the years, but it has accreted new items as time as gone on. Something to think about anyway...

Howard
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 495 bytes
Desc: Message signed with OpenPGP using GPGMail
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131119/93fa2761/attachment.pgp>

From Tom.Kralidis at ec.gc.ca  Tue Nov 19 09:22:03 2013
From: Tom.Kralidis at ec.gc.ca (Kralidis,Tom [Ontario])
Date: Tue, 19 Nov 2013 12:22:03 -0500
Subject: [gdal-dev] RFC 44: JSON/XML output for ogrinfo/gdalinfo
References: <F7211CA5-FCB8-4253-8E26-654306A36D90@hobu.co><CABUeae-n8vyAE+oEaankQvnWxn86UuLXbWv+FoDDjy-KSqce0Q@mail.gmail.com><4736572C-8151-4DAA-BDF0-2551D6426E95@hobu.co>
	<CABUeae_EEipeT_KO3EAaGtpi4_FEZGZRCypm3gkj80cu7fN21g@mail.gmail.com>
Message-ID: <D4979196AC320B45BE4A5DD7EE80C3E40FFF36@sdow04exmail2.ontario.int.ec.gc.ca>

This would be a handy addition.  It would be helpful, to add to the RFC, sample XML output.

________________________________

From: gdal-dev-bounces at lists.osgeo.org on behalf of Mateusz Loskot
Sent: Tue 19-Nov-13 12:03
To: Howard Butler
Cc: gdal-dev at lists.osgeo.org dev
Subject: Re: [gdal-dev] RFC 44: JSON/XML output for ogrinfo/gdalinfo



On 19 November 2013 17:00, Howard Butler <howard at hobu.co> wrote:
> On Nov 19, 2013, at 10:49 AM, Mateusz Loskot <mateusz at loskot.net> wrote:
>> On 19 November 2013 16:42, Howard Butler <howard at hobu.co> wrote:
>>> All,
>>>
>>> Dan Little and myself would like to put forward an RFC proposing -xml and -json output support for both ogrinfo and gdalinfo. No changes are proposed to the current text format (which would continue to be the default output format), but having JSON and XML available would greatly ease the integration of gdalinfo and ogrinfo into existing processing workflows without requiring that someone jump into scripting land. Though it might have been overkill to have an RFC, I thought it would be useful to have something to collaborate on if others have ideas about these particular features.
>>>
>>> http://trac.osgeo.org/gdal/wiki/rfc44_gdalinfoxml
>>>
>>> We look forward to your feedback,
>>
>> "You don't parse the output of gdalinfo --format, do you?" :P
>>
>> [1] http://lists.osgeo.org/pipermail/gdal-dev/2013-January/035117.html
>
> I don't, but I fully expect that are there are folks who have, simply due to not having a better,
> more convenient way to do things. JSON and XML output puts people on the right path at least...

Hobu, sure thing.
That was a bit of joke, and, on reflection I think a specified format
is actually useful idea.

Best regards,
--
Mateusz  Loskot, http://mateusz.loskot.net <http://mateusz.loskot.net/> 
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev



From etourigny.dev at gmail.com  Tue Nov 19 09:31:21 2013
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Tue, 19 Nov 2013 15:31:21 -0200
Subject: [gdal-dev] RFC 44: JSON/XML output for ogrinfo/gdalinfo
In-Reply-To: <F7211CA5-FCB8-4253-8E26-654306A36D90@hobu.co>
References: <F7211CA5-FCB8-4253-8E26-654306A36D90@hobu.co>
Message-ID: <CA+TxYvNqHCbwbWbj7hcnve=1YN3S5-NaMFBeD3Y8ADCyODWK+A@mail.gmail.com>

You might think of adding json/xml output also to gdalsrsinfo, it should
not be much work.

For example, if you have a <srs> node output by gdalsrsinfo, you could have
the same (and only) node in gdalsrsinfo.  Also consider that there are
various output formats for srs (mostly in gdalsrsinfo, but also proj4 for
gdalinfo).

cheers
Etienne


On Tue, Nov 19, 2013 at 2:42 PM, Howard Butler <howard at hobu.co> wrote:

> All,
>
> Dan Little and myself would like to put forward an RFC proposing -xml and
> -json output support for both ogrinfo and gdalinfo. No changes are proposed
> to the current text format (which would continue to be the default output
> format), but having JSON and XML available would greatly ease the
> integration of gdalinfo and ogrinfo into existing processing workflows
> without requiring that someone jump into scripting land. Though it might
> have been overkill to have an RFC, I thought it would be useful to have
> something to collaborate on if others have ideas about these particular
> features.
>
> http://trac.osgeo.org/gdal/wiki/rfc44_gdalinfoxml
>
> We look forward to your feedback,
>
> Howard
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131119/a4a08413/attachment-0001.html>

From pcreso at pcreso.com  Tue Nov 19 10:41:44 2013
From: pcreso at pcreso.com (Brent Wood)
Date: Tue, 19 Nov 2013 10:41:44 -0800 (PST)
Subject: [gdal-dev] ogr2og / forcing a +-180 system
In-Reply-To: <528A6A83.5030803@gmail.com>
References: <528A4226.7080702@gmail.com>	<CA+YzLBeoUBpX3C=8+6QPRj0R8EQFTKwdyT6p9HpcrOREV4yRCA@mail.gmail.com>
	<528A6A83.5030803@gmail.com>
Message-ID: <1384886504.66457.YahooMailNeo@web122001.mail.ne1.yahoo.com>

I suggest loading it into Postgis & use the ST_ShiftLongitude() function - this was written specifically to enable 0-360 & +-180 conversions.

It may be that your data with longitudes <-180 fails with this too, but it is the closest I know of...

Otherwise you could perhaps script something up with GMT v5, which works in mod360 for longitudes?


Brent Wood



________________________________
 From: Robb K. Wright <robbkwright at gmail.com>
To: Frank Warmerdam <warmerdam at pobox.com> 
Cc: gdal dev <gdal-dev at lists.osgeo.org> 
Sent: Tuesday, November 19, 2013 8:29 AM
Subject: Re: [gdal-dev] ogr2og / forcing a +-180 system
 



I haven't been able to get either -wrapdateline or -datelineoffset
      to alter the coords.? As far as I can figure out, the
      -wrapdateline option only operates on features that actually
      intersect the 180 line, so using it doesn't alter my coords since
      mine are only on either side.? I'm just trying to shift any polys
      <-180 to be have long +360.? Here's a sample shape if anybody
      wants to take a swing:? http://branewright.org/test/test_file.zip

Robb

On 11/18/13 12:50 PM, Frank Warmerdam wrote:

Robb, 
>
>
>Have you tried the -wrapdateline switch? ?I do not believe geometries that cross the dateline will be handled ideally (they aren't split as one might hope), but if you don't have them then the rest of the geometries should be wrapped. ?I see there is even now a -datelineoffset switch if someone needed 0 to 360.
>
>
>Best regards,
>Frank
>
>
>
>On Mon, Nov 18, 2013 at 8:36 AM, Robb K. Wright <robbkwright at gmail.com> wrote:
>
>
>>I need to use ogr2ogr (or any other command line) to convert
            a shapefile with longitudes spanning from -220 to -60,
            forcing it into a +-180 scheme, so the -220 coordinate would
            come out as +140 and the -60 stays as -60. ?I don't need to
            worry about the polys that actually cross the 180 line.
>>
>>Any thoughts? ?I was thinking that running it through
            EPSG:4326 would reshape it (as it does in Esri-land), but no
            luck.
>>
>>Robb
>>
>>
>>
>>_______________________________________________
>>gdal-dev mailing list
>>gdal-dev at lists.osgeo.org
>>http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>
>
-- 
>---------------------------------------+--------------------------------------
>I set the clouds in motion - turn up?? | Frank Warmerdam, warmerdam at pobox.com
>light and sound - activate the windows | http://pobox.com/~warmerdam
>and watch the world go round - Rush? ? | Geospatial Software
        Developer
>



_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131119/faf379ac/attachment.html>

From warmerdam at pobox.com  Tue Nov 19 10:44:55 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue, 19 Nov 2013 10:44:55 -0800
Subject: [gdal-dev] RFC 44: JSON/XML output for ogrinfo/gdalinfo
In-Reply-To: <F7211CA5-FCB8-4253-8E26-654306A36D90@hobu.co>
References: <F7211CA5-FCB8-4253-8E26-654306A36D90@hobu.co>
Message-ID: <CA+YzLBd=_cCiaBi5nJFKTUkUupx89uP+oTHy3BVmcC3Jmb1_zw@mail.gmail.com>

Howard,

I was a bit surprised that the RFC doesn't actually define the format.  I
gather we are supposed to deduce it from the modified ogrinfo code?

On the GDAL side, rather than have gdalinfo support some secondary
reporting format, I *feel* it would be better to just have a method on a
dataset to provide a summary report somewhat similar to what gdalinfo would
give.  In XML this would essentially be what you would get from doing a
"gdal_translate -of VRT abc.tif abc.vrt ".

I must confess there isn't such a clean analog on the ogrinfo side, and if
you want to also capture feature data written out by ogrinfo it gets
someone more complicated.

Skimming the (json missing) example ogrinfo it seems like a lot of work -
particularly to maintain in a way that will keep all output formats in
line.

I started out supportive, but the more I think about the approach the less
keen I am.

Best regards,
Frank



On Tue, Nov 19, 2013 at 8:42 AM, Howard Butler <howard at hobu.co> wrote:

> All,
>
> Dan Little and myself would like to put forward an RFC proposing -xml and
> -json output support for both ogrinfo and gdalinfo. No changes are proposed
> to the current text format (which would continue to be the default output
> format), but having JSON and XML available would greatly ease the
> integration of gdalinfo and ogrinfo into existing processing workflows
> without requiring that someone jump into scripting land. Though it might
> have been overkill to have an RFC, I thought it would be useful to have
> something to collaborate on if others have ideas about these particular
> features.
>
> http://trac.osgeo.org/gdal/wiki/rfc44_gdalinfoxml
>
> We look forward to your feedback,
>
> Howard
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131119/1f55630f/attachment.html>

From dmorissette at mapgears.com  Tue Nov 19 10:59:14 2013
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Tue, 19 Nov 2013 13:59:14 -0500
Subject: [gdal-dev] RFC 44: JSON/XML output for ogrinfo/gdalinfo
In-Reply-To: <F7211CA5-FCB8-4253-8E26-654306A36D90@hobu.co>
References: <F7211CA5-FCB8-4253-8E26-654306A36D90@hobu.co>
Message-ID: <528BB502.2040804@mapgears.com>

FWIW I like the idea, but as others have pointed out some thinking needs 
to be put into the json & xml output formats.

Daniel

On 13-11-19 11:42 AM, Howard Butler wrote:
> All,
>
> Dan Little and myself would like to put forward an RFC proposing -xml and -json output support for both ogrinfo and gdalinfo. No changes are proposed to the current text format (which would continue to be the default output format), but having JSON and XML available would greatly ease the integration of gdalinfo and ogrinfo into existing processing workflows without requiring that someone jump into scripting land. Though it might have been overkill to have an RFC, I thought it would be useful to have something to collaborate on if others have ideas about these particular features. 	
>
> http://trac.osgeo.org/gdal/wiki/rfc44_gdalinfoxml
>
> We look forward to your feedback,
>
> Howard
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
Daniel Morissette
http://www.mapgears.com/
Provider of Professional MapServer Support since 2000


From danlittle at yahoo.com  Tue Nov 19 11:43:42 2013
From: danlittle at yahoo.com (Dan Little)
Date: Tue, 19 Nov 2013 11:43:42 -0800 (PST)
Subject: [gdal-dev] RFC 44: JSON/XML output for ogrinfo/gdalinfo
In-Reply-To: <CA+YzLBd=_cCiaBi5nJFKTUkUupx89uP+oTHy3BVmcC3Jmb1_zw@mail.gmail.com>
References: <F7211CA5-FCB8-4253-8E26-654306A36D90@hobu.co>
	<CA+YzLBd=_cCiaBi5nJFKTUkUupx89uP+oTHy3BVmcC3Jmb1_zw@mail.gmail.com>
Message-ID: <1384890222.75930.YahooMailNeo@web163002.mail.bf1.yahoo.com>

I'm not sure as to the purposed utility of the gdalinfo -vrt conversion approach. ?It may very well be valid, I spend most of my time with vector data and can't take a position one way or the other. ?Even so, I think having a script friendly output format for ogrinfo is very useful. ?When Howard and I chatted about it, I started getting visions of a massive metadata site generating itself with not more than a couple of command line scripts. ?These may be delusions of grandeur but this modification would overcome a first-line obstacle to making it a reality.

I too have some concern about maintaining three different formats. ?I was actually inclined to generate an intermediate format that would then go to XML or JSON but the XML version came together rather cleanly in a few hours so I didn't go down that path. ?The proof of concept came together far enough that we thought it prudent to get the ideas formally put into an RFC.

Multiple formats comes with the required multiple format maintenance penalty. ?Sticking with XML minimizes some complications because MiniXML is always be available during a build and it keeps the code a little cleaner. ?That said, JSON is currently the sexy format, and all the cool kids are doing it. (All technical arguments about JSON aside...) If we conceded to just supporting one additional output format, I would really like to see the XML output further refined.

ogrinfo and gdalinfo as they currently exist are a large collection of printf statements in the main function. ?I logically removed the diagnostic messages (putting them on stderr) and ensured the intended content was separated into two different formatting functions. ?The functions are currently responsible for doing their own output to stdout as to prevent the need to completely rewrite the standard output format.

Sorry, for not including an example of the XML sample. ?I can certainly generate something as necessary. ?The version I have in the proposed code works but can easily be changed in order to meet the needs and preferences to the project at large.




On Tuesday, November 19, 2013 12:45 PM, Frank Warmerdam <warmerdam at pobox.com> wrote:
 
Howard,

I was a bit surprised that the RFC doesn't actually define the format. ?I gather we are supposed to deduce it from the modified ogrinfo code?

On the GDAL side, rather than have gdalinfo support some secondary reporting format, I *feel* it would be better to just have a method on a dataset to provide a summary report somewhat similar to what gdalinfo would give. ?In XML this would essentially be what you would get from doing a "gdal_translate -of VRT abc.tif abc.vrt ". ?

I must confess there isn't such a clean analog on the ogrinfo side, and if you want to also capture feature data written out by ogrinfo it gets someone more complicated.

Skimming the (json missing) example ogrinfo it seems like a lot of work - particularly to maintain in a way that will keep all output formats in line. ?

I started out supportive, but the more I think about the approach the less keen I am.

Best regards,
Frank




On Tue, Nov 19, 2013 at 8:42 AM, Howard Butler <howard at hobu.co> wrote:

All,
>
>Dan Little and myself would like to put forward an RFC proposing -xml and -json output support for both ogrinfo and gdalinfo. No changes are proposed to the current text format (which would continue to be the default output format), but having JSON and XML available would greatly ease the integration of gdalinfo and ogrinfo into existing processing workflows without requiring that someone jump into scripting land. Though it might have been overkill to have an RFC, I thought it would be useful to have something to collaborate on if others have ideas about these particular features.
>
>http://trac.osgeo.org/gdal/wiki/rfc44_gdalinfoxml
>
>We look forward to your feedback,
>
>Howard
>_______________________________________________
>gdal-dev mailing list
>gdal-dev at lists.osgeo.org
>http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up?? | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush? ? | Geospatial Software Developer

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131119/940fd8a4/attachment-0001.html>

From even.rouault at mines-paris.org  Tue Nov 19 12:01:13 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 19 Nov 2013 21:01:13 +0100
Subject: [gdal-dev] RFC 44: JSON/XML output for ogrinfo/gdalinfo
In-Reply-To: <F7211CA5-FCB8-4253-8E26-654306A36D90@hobu.co>
References: <F7211CA5-FCB8-4253-8E26-654306A36D90@hobu.co>
Message-ID: <201311192101.13688.even.rouault@mines-paris.org>

Le mardi 19 novembre 2013 17:42:32, Howard Butler a ?crit :
> All,
> 
> Dan Little and myself would like to put forward an RFC proposing -xml and
> -json output support for both ogrinfo and gdalinfo. No changes are
> proposed to the current text format (which would continue to be the
> default output format), but having JSON and XML available would greatly
> ease the integration of gdalinfo and ogrinfo into existing processing
> workflows without requiring that someone jump into scripting land. Though
> it might have been overkill to have an RFC, I thought it would be useful
> to have something to collaborate on if others have ideas about these
> particular features.
> 
> http://trac.osgeo.org/gdal/wiki/rfc44_gdalinfoxml
> 
> We look forward to your feedback,

Howard,

Certainly a proposal that would please people that don't want to study GDAL or 
OGR API ;-)

A few points, with some overlap with previous email exchanges :

- so that users can anticipate how to parse the output, documenting the 
grammar of the JSON and XML outputs seems to be necessary and should be the 
main topic of discussion in this RFC phase.

- some stability of the output would be appreciated, although it is always 
difficult to guaranty it will stay stable forever. For example, when adding RFC 
41 (multiple geometry fields per layer/feature), I tried to not change the 
output of ogrinfo when there's a single geometry but that implied some if else 
logic. But json / xml content have in their nature at least the capacity of 
being extended with new elements/nodes, so users would be encouraged to be 
robust to elements/nodes that were not documented in the GDAL version on which 
they based their implementation. And if breakage in the format occurs at some 
point for valid reasons, the action will be to document that in the release 
notes.

- I saw on IRC that you didn't anticipate to make that capability as an API 
call but still rely on parsing the output of the utilities. That make its use 
a bit complicated (in my opinion), but I don't see this as a blocking point. 

By the way, regarding ogrinfo, do you intend to dump all the features in the -
al mode or just the summary of the layers ? The "background" paragraph only 
mentions metadata. In which case there could be some redundancy with the 
GeoJSON and GML drivers (*)
Another point to take into account is that CPLMiniXML builds a DOM, as well as 
libjson-c. So, if dumping a huge layer that could possibly not fit into RAM 
(for that reason, the GML driver write "at hand" its output, and the GeoJSON 
builds a JSON object for each object that it dumps into the output, but not a 
JSON object for the whole collection. The inconsistency being that for read 
support, a global JSON object is reconstructed. End of slightly out of topic 
consideration). Not necessarily a use case that we want to cover, and to go 
back to my remark about an API call, you could raise that an API call would 
return a string, so with that same problem ;-)

- regarding Etienne's remark regarding all various way of encoding projection, 
I don't think we need to cover all the possibilities. <SRS 
type="WKT">PROJCS[...]</SRS> could be the base possibility. And we can then 
easily add other variants if needed.

- regarding the possible sources of inspiration for XML formats, for GDAL, we 
have PAM .aux.xml and .vrt as examples (both share common XML elements). For 
OGR, we also have the .vrt format

$ python swig/python/samples/ogr2vrt.py -schema poly.shp out.vrt
$ cat out.vrt
<OGRVRTDataSource>
  <OGRVRTLayer name="poly">
    <SrcDataSource relativeToVRT="0" shared="0">@dummy@</SrcDataSource>
    <SrcLayer>@dummy@</SrcLayer>
    <GeometryType>wkbPolygon</GeometryType>
    <LayerSRS>PROJCS[&quot;OSGB 1936 / British National 
Grid&quot;,GEOGCS[&quot;OSGB 
1936&quot;,DATUM[&quot;OSGB_1936&quot;,SPHEROID[&quot;Airy_1830&quot;,6377563.396,299.3249646]],PRIMEM[&quot;Greenwich&quot;,0],UNIT[&quot;Degree&quot;,0.017453292519943295]],PROJECTION[&quot;Transverse_Mercator&quot;],PARAMETER[&quot;latitude_of_origin&quot;,49],PARAMETER[&quot;central_meridian&quot;,-2],PARAMETER[&quot;scale_factor&quot;,0.9996012717],PARAMETER[&quot;false_easting&quot;,400000],PARAMETER[&quot;false_northing&quot;,-100000],UNIT[&quot;Meter&quot;,1]]</LayerSRS>
    <Field name="AREA" type="Real" width="12" precision="3"/>
    <Field name="EAS_ID" type="Real" width="11"/>
    <Field name="PRFEDEA" type="String" width="16"/>
  </OGRVRTLayer>
</OGRVRTDataSource>


(*) . Well, I've just actually looked at the proposed ogrinfo code and see 
that the XML format is a custom one. I'm not particularly a huge fan of GML, 
although I spent (too) much time with it, but I'm not particularly 
enthousiastic that we invent our own OGR specific vector format... Someone 
would need to write a OGR driver to read it ;-)

Best regards,

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From tpiepho at gmail.com  Tue Nov 19 18:29:25 2013
From: tpiepho at gmail.com (Trent Piepho)
Date: Tue, 19 Nov 2013 18:29:25 -0800
Subject: [gdal-dev] [PATCH v2] Support Mercator_2SP in GeoTIFF
In-Reply-To: <CAPcvoOLeCJVm_=VqAKhN5owdRwQ_sNNSX7LHfV1fuJTOdjsVLA@mail.gmail.com>
References: <CAPcvoOJctLnpVBa=X9V0HHELv1vvRjbGzhuHNc0zsNptUkNrfw@mail.gmail.com>
	<CA+7tXiga3wM_eQnb4vg=aPEpJnDNa3b+HRyhEwDkDighMFfe=g@mail.gmail.com>
	<CAPcvoOLeCJVm_=VqAKhN5owdRwQ_sNNSX7LHfV1fuJTOdjsVLA@mail.gmail.com>
Message-ID: <CA+7tXihgJrv7qCVPPh+Q8J7P-jjSYH8wTWZETbCk0WSnOe7EDA@mail.gmail.com>

Antii,

Thank you for the testing.  It looks like Arc/GIS works while FME and
Intergraph don't.

That file had both StdParallel1 and ScaleAtNatOrigin defined.

I've uploaded two new files.  This one has only StdParallel1 defined with
no ScaleAtNatOrigin.
https://drive.google.com/file/d/0BybuTedE9CLxRnNlNUl2Zm5JRzg/edit?usp=sharing

This file has the lat_ts stored in NatOriginLat and no ScaleAtNatOrigin
defined.
https://drive.google.com/file/d/0BybuTedE9CLxMzltYlBFWU51RzA/edit?usp=sharing

I think the latter might have better compatibility.  Yet it seems to
clearly be the incorrect way to do it.


On Mon, Nov 18, 2013 at 4:54 AM, Antti Castr?n <antti.castren at iki.fi> wrote:

> Hi Trent,
>
> The chart  opens in ArcMap (ArcGIS 10.0) well, and it is in right
> location (Seattle).
>
> Relevant properties of the file as seen by ArcGIS:
> Cell Size: 240.003787, 240.003787
> Extent
> Top:4143530.20898
> Left: -9278434.53415
> Right:  -9165872.75807
> Bottom:  3984167.69444
> Spatial Reference: Global Mercator
> Linear Unit: Meter
> false_easting: 0
> false_northing: 0
> central_meridian: 0
> standard_parallel_1:  47.667
> Datum: D_North_American_1983
>
>
> I opened the file in FME Data Inspector (FME Desktop 2013 SP1) also.
> It did not read the latitude of true scale from the
> ProjStdParallel1GeoKey as you can see from the following parameters.
> Therefore it places the chart to NE Georgia/NW South Carolina as if
> the latitude of true scale was the Equator.
>
> <FME Parameters>
> Coordinate System Parameters
> CS_NAME: _FME_0
> DESC_NM: Global Mercator
> DT_NAME: NAD83
> PROJ: MRCAT
> UNIT: METER
>
> Datum Parameters
> DESC_NM: NAD 1983, Alaska, Canada,Continental US,Mexico,Central America
> ELLIPSOID: GRS1980
> SOURCE: US Defense Mapping Agency, TR-8350.2-B, August 1993
> USE: NAD83
>
> Ellipsoid Parameters
> DESC_NM: Geodetic Reference System of 1980
> E_RAD: 6378137
> P_RAD: 6356752.3141403478
> SOURCE: Stem, L.E., Jan 1989, State Plane Coordinate System of 1983
>
> OGC WKT Description
> PROJCS["Global Mercator",
>     GEOGCS["NAD83",
>         DATUM["North_American_Datum_1983",
>             SPHEROID["Geodetic Reference System of
> 1980",6378137,298.2572221008916,
>                 AUTHORITY["EPSG","7019"]],
>             AUTHORITY["EPSG","6269"]],
>         PRIMEM["Greenwich",0],
>         UNIT["degree",0.0174532925199433],
>         AUTHORITY["EPSG","4269"]],
>     PROJECTION["Mercator_1SP"],
>     PARAMETER["central_meridian",0],
>     PARAMETER["scale_factor",1],
>     PARAMETER["false_easting",0],
>     PARAMETER["false_northing",0],
>     UNIT["METER",1]]
>
> Esri WKT Description
>
> PROJCS["Global_Mercator",GEOGCS["GCS_North_American_1983",DATUM["D_North_American_1983",SPHEROID["Geodetic_Reference_System_of_1980",6378137,298.2572221008916]],PRIMEM["Greenwich",0],UNIT["Degree",0.017453292519943295]],PROJECTION["Mercator"],PARAMETER["central_meridian",0],PARAMETER["false_easting",0],PARAMETER["false_northing",0],UNIT["Meter",1],PARAMETER["standard_parallel_1",0.0]]
> </FME Parameters>
>
> Intergraph's Geomedia Professional recognises the file as GeoTIFF, but
> the chart appears to be in the same false place as with FME.
>
> If you want, I could update the file's georeferencing by FME and
> Geomedia so that location is correct. Then I could send listgeo
> information or even put the actual files available if desired.
>
> The goal is, of course, to get various software vendors to use the
> GeoTIFF-information the same way. Hopefully the common way would also
> be logically correct, but I guess that's too much to ask.
>
> Best regards,
>
>   Antti
>
>
> Here is the listgeo info from the original file for those who are
> interested:
>
> Geotiff_Information:
>    Version: 1
>    Key_Revision: 1.0
>    Tagged_Information:
>       ModelTiepointTag (2,3):
>          0                0                0
>          -9278434.53      4143530.21       0
>       ModelPixelScaleTag (1,3):
>          240.003787       240.003787       0
>       End_Of_Tags.
>    Keyed_Information:
>       GTModelTypeGeoKey (Short,1): ModelTypeProjected
>       GTRasterTypeGeoKey (Short,1): RasterPixelIsArea
>       GTCitationGeoKey (Ascii,16): "Global Mercator"
>       GeographicTypeGeoKey (Short,1): GCS_NAD83
>       GeogCitationGeoKey (Ascii,6): "NAD83"
>       GeogAngularUnitsGeoKey (Short,1): Angular_Degree
>       GeogSemiMajorAxisGeoKey (Double,1): 6378137
>       GeogInvFlatteningGeoKey (Double,1): 298.257222
>       Unknown-2062 (Double,3): 0                0                0
>       ProjectedCSTypeGeoKey (Short,1): User-Defined
>       ProjectionGeoKey (Short,1): User-Defined
>       ProjCoordTransGeoKey (Short,1): CT_Mercator
>       ProjLinearUnitsGeoKey (Short,1): Linear_Meter
>       ProjStdParallel1GeoKey (Double,1): 47.667
>       ProjNatOriginLongGeoKey (Double,1): 0
>       ProjNatOriginLatGeoKey (Double,1): 0
>       ProjFalseEastingGeoKey (Double,1): 0
>       ProjFalseNorthingGeoKey (Double,1): 0
>       ProjScaleAtNatOriginGeoKey (Double,1): 1
>       End_Of_Keys.
>    End_Of_Geotiff.
> Projection Method: CT_Mercator
>    ProjNatOriginLatGeoKey: 0.000000 (  0d 0' 0.00"N)
>    ProjNatOriginLongGeoKey: 0.000000 (  0d 0' 0.00"E)
>    ProjScaleAtNatOriginGeoKey: 1.000000
>    ProjFalseEastingGeoKey: 0.000000 m
>    ProjFalseNorthingGeoKey: 0.000000 m
> GCS: 4269/NAD83
> Datum: 6269/North American Datum 1983
> Ellipsoid: 7019/GRS 1980 (6378137.00,6356752.31)
> Prime Meridian: 8901/Greenwich (0.000000/  0d 0' 0.00"E)
> Projection Linear Units: 9001/metre (1.000000m)
> Corner Coordinates:
> Upper Left    (-9278434.534, 4143530.209)
> Lower Left    (-9278434.534, 3984167.694)
> Upper Right   (-9165872.758, 4143530.209)
> Lower Right   (-9165872.758, 3984167.694)
> Center        (-9222153.646, 4063848.952)
>
>
> 2013/11/14 Trent Piepho <tpiepho at gmail.com>:
> > It looks like arcgis does not support Mercator_1SP in geotiff files.
> > It just ignores the scale factor and uses 1.0.  Which means in GDAL
> > and libgeotiff as they are now, there is no way to export Mercator
> > projections that don't have a scale of 1.0 to arcgis.
> >
> > ArcGIS does support Mercator_2SP, but instead of placing the latitude
> > of true scale in ProjStdParallel1GeoKey, it uses
> > ProjNatOriginLatGeoKey.  Which seems to be plainly wrong, yet that's
> > what it does.
> >
> > I wonder if ESRI used libgeotiff?  With unpatched libgeotiff, the only
> > way to get a latitude from a Mercator geotiff it to use one of the
> > origin latitude GeoKeys.  It's not correct, but it does allow one to
> > stick the number in the file and get it back out without having to
> > modify or understand any libgeotiff code.
> >
> > It's possible that ArcGIS supports getting the latitude of true scale
> > from ProjStdParallel1GeoKey, even it it doesn't store it there.
> > Antii, could you test this file with ArcGIS?
> >
> >
> https://drive.google.com/file/d/0BybuTedE9CLxak9iakZRTC00cHM/edit?usp=sharing
> >
> > Pick file->download to get the geotiff file.
> >
> > It should have projection information like this:
> >     PROJECTION["Mercator_2SP"],
> >     PARAMETER["standard_parallel_1",47.667],
> >     PARAMETER["central_meridian",0],
> >     PARAMETER["false_easting",0],
> >     PARAMETER["false_northing",0],
> >     UNIT["metre",1,
> >         AUTHORITY["EPSG","9001"]]]
> > Origin = (-9278434.534151820465922,4143530.208984711207449)
> > Pixel Size = (240.003786961970206,-240.003786961970206)
> > Corner Coordinates:
> > Upper Left  (-9278434.534, 4143530.209) (123d32'26.22"W, 48d23'56.59"N)
> > Lower Left  (-9278434.534, 3984167.694) (123d32'26.22"W, 46d57'58.64"N)
> > Upper Right (-9165872.758, 4143530.209) (122d 2'30.76"W, 48d23'56.59"N)
> > Lower Right (-9165872.758, 3984167.694) (122d 2'30.76"W, 46d57'58.64"N)
> > Center      (-9222153.646, 4063848.952) (122d47'28.49"W, 47d41'15.43"N)
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131119/8d74172d/attachment.html>

From howard at hobu.co  Tue Nov 19 20:37:26 2013
From: howard at hobu.co (Howard Butler)
Date: Tue, 19 Nov 2013 22:37:26 -0600
Subject: [gdal-dev] RFC 44: JSON/XML output for ogrinfo/gdalinfo
In-Reply-To: <201311192101.13688.even.rouault@mines-paris.org>
References: <F7211CA5-FCB8-4253-8E26-654306A36D90@hobu.co>
	<201311192101.13688.even.rouault@mines-paris.org>
Message-ID: <EFFB7D60-BF1D-48E7-ACDE-B5566401F1F5@hobu.co>


On Nov 19, 2013, at 2:01 PM, Even Rouault <even.rouault at mines-paris.org> wrote:

> Certainly a proposal that would please people that don't want to study GDAL or 
> OGR API ;-)

Hehe, yeah. Hipster enablement.

> - I saw on IRC that you didn't anticipate to make that capability as an API 
> call but still rely on parsing the output of the utilities. That make its use 
> a bit complicated (in my opinion), but I don't see this as a blocking point. 

Are there other examples of this type of application-oriented capability available in the APIs of GDAL and OGR proper? I've got no problem pushing this type of thing into the API stead of out in application-land if there's general support for it.

> By the way, regarding ogrinfo, do you intend to dump all the features in the -
> al mode or just the summary of the layers ?

The immediate desire was simply focused on metadata and summary data along with SRS info. I didn't really want to come up with a new way of representing geometry or features, and I don't want to reengineer anything that might already have been done. That's one reason why we kicked out the RFC a little prematurely.

> The "background" paragraph only 
> mentions metadata. In which case there could be some redundancy with the 
> GeoJSON and GML drivers (*)

Would it seem reasonable that if you ask for JSON, you get GeoJSON, and if you ask for XML, you get GML?

> $ python swig/python/samples/ogr2vrt.py -schema poly.shp out.vrt

I didn't know about ogr2vrt.py. For summary information, this is pretty much what I require, other than wanting to have it within arm's reach inside of ogrinfo. Is there a gdal2vrt.py as well? I know about gdalbuildvrt, but that's mostly processing directives, not metadata, right?

Howard
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 495 bytes
Desc: Message signed with OpenPGP using GPGMail
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131119/f2fdc4e9/attachment-0001.pgp>

From even.rouault at mines-paris.org  Wed Nov 20 01:35:44 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 20 Nov 2013 10:35:44 +0100
Subject: [gdal-dev] [PATCH v2] Support Mercator_2SP in GeoTIFF
In-Reply-To: <CA+7tXihgJrv7qCVPPh+Q8J7P-jjSYH8wTWZETbCk0WSnOe7EDA@mail.gmail.com>
References: <CAPcvoOJctLnpVBa=X9V0HHELv1vvRjbGzhuHNc0zsNptUkNrfw@mail.gmail.com>
	<CAPcvoOLeCJVm_=VqAKhN5owdRwQ_sNNSX7LHfV1fuJTOdjsVLA@mail.gmail.com>
	<CA+7tXihgJrv7qCVPPh+Q8J7P-jjSYH8wTWZETbCk0WSnOe7EDA@mail.gmail.com>
Message-ID: <201311201035.44812.even.rouault@mines-paris.org>

Le mercredi 20 novembre 2013 03:29:25, Trent Piepho a ?crit :
> Antii,
> 
> Thank you for the testing.  It looks like Arc/GIS works while FME and
> Intergraph don't.

Some of those proprietary software use GDAL, but possibly not for GeoTIFF 
support, or if they do, perhaps with their own patches.

> 
> That file had both StdParallel1 and ScaleAtNatOrigin defined.
> 
> I've uploaded two new files.  This one has only StdParallel1 defined with
> no ScaleAtNatOrigin.
> https://drive.google.com/file/d/0BybuTedE9CLxRnNlNUl2Zm5JRzg/edit?usp=shari
> ng
> 
> This file has the lat_ts stored in NatOriginLat and no ScaleAtNatOrigin
> defined.
> https://drive.google.com/file/d/0BybuTedE9CLxMzltYlBFWU51RzA/edit?usp=shari
> ng
> 
> I think the latter might have better compatibility.  Yet it seems to
> clearly be the incorrect way to do it.

If the way of encoding/decoding is changed, it would be best to do it the 
"right" way and eventually other vendors will catch up with this 
interpretation.

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Wed Nov 20 02:34:13 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 20 Nov 2013 11:34:13 +0100
Subject: [gdal-dev] RFC 44: JSON/XML output for ogrinfo/gdalinfo
In-Reply-To: <EFFB7D60-BF1D-48E7-ACDE-B5566401F1F5@hobu.co>
References: <F7211CA5-FCB8-4253-8E26-654306A36D90@hobu.co>
	<201311192101.13688.even.rouault@mines-paris.org>
	<EFFB7D60-BF1D-48E7-ACDE-B5566401F1F5@hobu.co>
Message-ID: <201311201134.14011.even.rouault@mines-paris.org>

> 
> > - I saw on IRC that you didn't anticipate to make that capability as an
> > API call but still rely on parsing the output of the utilities. That
> > make its use a bit complicated (in my opinion), but I don't see this as
> > a blocking point.
> 
> Are there other examples of this type of application-oriented capability
> available in the APIs of GDAL and OGR proper?

Not that I can think of. But this would be something along to FrankW's 
proposal, let's say a "char* GDALGetSummary(GDALDatasetH hDS, const char* 
pszFormat, char** papszOptions);" and same thing with an OGR datasource.

> 
> > By the way, regarding ogrinfo, do you intend to dump all the features in
> > the - al mode or just the summary of the layers ?
> 
> The immediate desire was simply focused on metadata and summary data along
> with SRS info. I didn't really want to come up with a new way of
> representing geometry or features, and I don't want to reengineer anything
> that might already have been done. That's one reason why we kicked out the
> RFC a little prematurely.
> 
> > The "background" paragraph only
> > mentions metadata. In which case there could be some redundancy with the
> > GeoJSON and GML drivers (*)
> 
> Would it seem reasonable that if you ask for JSON, you get GeoJSON, and if
> you ask for XML, you get GML?

You could use ogr2ogr for that as well ? Just trying to understand the benefit 
of doing it in ogrinfo.

Below, I give a few possible inspirational sources. Not that I have a strong 
opinion for one or another, but I thought it might be usefull to know what we 
already have.

Or from Python, you can already use

from osgeo import ogr
ds = ogr.Open('poly.shp')
lyr = ds.GetLayer(0)
for feat in lyr:
	feat.ExportToJson()

We have a ExportToGML() at geometry level, but not at feature level. I guess 
it could be added similarly to how it has been done to ExportToGML()

> 
> > $ python swig/python/samples/ogr2vrt.py -schema poly.shp out.vrt
> 
> I didn't know about ogr2vrt.py. For summary information, this is pretty
> much what I require, other than wanting to have it within arm's reach
> inside of ogrinfo. 

Regarding ogr2vrt.py output, I can see that feature count and extents are 
missing. But looking at OGR VRT source, I see they can be mentionned.

<OGRVRTDataSource>
  <OGRVRTLayer name="poly">
    <SrcDataSource relativeToVRT="0" shared="0">@dummy@</SrcDataSource>
    <SrcLayer>@dummy@</SrcLayer>
    <GeometryType>wkbPolygon</GeometryType>
    <LayerSRS>PROJCS[&quot;OSGB 1936 / British National 
Grid&quot;,GEOGCS[&quot;OSGB 
1936&quot;,DATUM[&quot;OSGB_1936&quot;,SPHEROID[&quot;Airy_1830&quot;,6377563.396,299.3249646]],PRIMEM[&quot;Greenwich&quot;,0],UNIT[&quot;Degree&quot;,0.017453292519943295]],PROJECTION[&quot;Transverse_Mercator&quot;],PARAMETER[&quot;latitude_of_origin&quot;,49],PARAMETER[&quot;central_meridian&quot;,-2],PARAMETER[&quot;scale_factor&quot;,0.9996012717],PARAMETER[&quot;false_easting&quot;,400000],PARAMETER[&quot;false_northing&quot;,-100000],UNIT[&quot;Meter&quot;,1]]</LayerSRS>
    <FeatureCount>10</FeatureCount>
    <ExtentXMin>478315.531250</ExtentXMin>
    <ExtentYMin>4762880.500000</ExtentYMin>
    <ExtentXMax>481645.312500</ExtentXMax>
    <ExtentYMax>4765610.500000</ExtentYMax>
    <Field name="AREA" type="Real" width="12" precision="3"/>
    <Field name="EAS_ID" type="Real" width="11"/>
    <Field name="PRFEDEA" type="String" width="16"/>
  </OGRVRTLayer>
</OGRVRTDataSource>

One issue is that the OGR VRT format does not yet support RFC 41 new 
capabilities.

I'm also thinking to the .gfs file, that is sort of "proprietary" GML schema, 
generated by the OGR GML driver when it reads a GML file without a XSD file (or 
with a XSD file too complex to be understood)

<GMLFeatureClassList>
  <GMLFeatureClass>
    <Name>poly</Name>
    <ElementPath>poly</ElementPath>
    <GeometryType>3</GeometryType>
    <DatasetSpecificInfo>
      <FeatureCount>10</FeatureCount>
      <ExtentXMin>478315.53125</ExtentXMin>
      <ExtentXMax>481645.31250</ExtentXMax>
      <ExtentYMin>4762880.50000</ExtentYMin>
      <ExtentYMax>4765610.50000</ExtentYMax>
    </DatasetSpecificInfo>
    <PropertyDefn>
      <Name>AREA</Name>
      <ElementPath>AREA</ElementPath>
      <Type>Real</Type>
    </PropertyDefn>
    <PropertyDefn>
      <Name>EAS_ID</Name>
      <ElementPath>EAS_ID</ElementPath>
      <Type>Integer</Type>
    </PropertyDefn>
    <PropertyDefn>
      <Name>PRFEDEA</Name>
      <ElementPath>PRFEDEA</ElementPath>
      <Type>Integer</Type>
    </PropertyDefn>
  </GMLFeatureClass>
</GMLFeatureClassList>

But it has some GML specificities, like the <ElementPath> and some oddity like 
the numeric value for the OGRwkbGeometry enumeration in the <GeometryType> 
element instead of a text representation.


> Is there a gdal2vrt.py as well?

Sort of : it is called "gdal_translate -of VRT"

> I know about
> gdalbuildvrt, but that's mostly processing directives, not metadata,
> right?

In its most simple use (just one source dataset), gdalbuildvrt is somehow 
equivalent to gdal_translate -of VRT, but possibly with less metadata.

> 
> Howard

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From Bob.Moskovitz at conservation.ca.gov  Wed Nov 20 10:58:29 2013
From: Bob.Moskovitz at conservation.ca.gov (Moskovitz, Bob@DOC)
Date: Wed, 20 Nov 2013 18:58:29 +0000
Subject: [gdal-dev] Can GDAL access ARCGIS REST services?
Message-ID: <60358EDE3281814C993C0519A6DD0F1903FD6D46@057-SN2MPN1-063.057d.mgd.msft.net>

Hello all,

At one time, I was able to view NAIP imagery using WMS, but it appears that I can only access it using ARCGIS REST services.   According to http://www.northrivergeographic.com/qgis-adding-an-arcgis-rest-service, I tried something like this:

C:\>gdal_translate --debug on "http://gis.apfo.usda.gov/arcgis/rest/services/NAIP/California_2012_1m_NC/ImageServer?f=json&pretty=true" c:\temp\NAIP2012.xml -of WMS
HTTP: Fetch(http://gis.apfo.usda.gov/arcgis/rest/services/NAIP/California_2012_1m_NC/ImageServer?f=json&pretty=true)
ERROR 4: `/vsimem/http_1/file.dat' not recognised as a supported file format.

ERROR 4: `/tmp/file.dat' not recognised as a supported file format.

GDALOpen failed - 4
`/tmp/file.dat' not recognised as a supported file format.

Anyone have any suggestions on how to access this web service?

Thanks!


Robert Moskovitz
California Geological Survey
Seismic Hazards Zonation Program

CONFIDENTIALITY NOTICE: This communication is intended only for the use of the individual or entity to which it is addressed. This message contains information from the State of California, California Geological Survey, which may be privileged, confidential and exempt from disclosure under applicable law, including the Electronic Communications Privacy Act. If the reader of this communication is not the intended recipient, you are hereby notified that any dissemination, distribution, or copying of this communication is strictly prohibited.



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131120/8649c927/attachment.html>

From even.rouault at mines-paris.org  Wed Nov 20 11:21:30 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 20 Nov 2013 20:21:30 +0100
Subject: [gdal-dev] Can GDAL access ARCGIS REST services?
In-Reply-To: <60358EDE3281814C993C0519A6DD0F1903FD6D46@057-SN2MPN1-063.057d.mgd.msft.net>
References: <60358EDE3281814C993C0519A6DD0F1903FD6D46@057-SN2MPN1-063.057d.mgd.msft.net>
Message-ID: <201311202021.30353.even.rouault@mines-paris.org>

Le mercredi 20 novembre 2013 19:58:29, Moskovitz, Bob at DOC a ?crit :
> Hello all,
> 
> At one time, I was able to view NAIP imagery using WMS, but it appears that
> I can only access it using ARCGIS REST services.   According to
> http://www.northrivergeographic.com/qgis-adding-an-arcgis-rest-service, I
> tried something like this:
> 
> C:\>gdal_translate --debug on
> "http://gis.apfo.usda.gov/arcgis/rest/services/NAIP/California_2012_1m_NC/
> ImageServer?f=json&pretty=true" c:\temp\NAIP2012.xml -of WMS HTTP:
> Fetch(http://gis.apfo.usda.gov/arcgis/rest/services/NAIP/California_2012_1
> m_NC/ImageServer?f=json&pretty=true) ERROR 4: `/vsimem/http_1/file.dat' not
> recognised as a supported file format.
> 
> ERROR 4: `/tmp/file.dat' not recognised as a supported file format.
> 
> GDALOpen failed - 4
> `/tmp/file.dat' not recognised as a supported file format.
> 
> Anyone have any suggestions on how to access this web service?

The WMS driver only understands documents produced by the "MapServer" ArcGIS 
service/protocol, not "ImageServer"

> 
> Thanks!
> 
> 
> Robert Moskovitz
> California Geological Survey
> Seismic Hazards Zonation Program
> 
> CONFIDENTIALITY NOTICE: This communication is intended only for the use of
> the individual or entity to which it is addressed. This message contains
> information from the State of California, California Geological Survey,
> which may be privileged, confidential and exempt from disclosure under
> applicable law, including the Electronic Communications Privacy Act. If
> the reader of this communication is not the intended recipient, you are
> hereby notified that any dissemination, distribution, or copying of this
> communication is strictly prohibited.

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From Bob.Moskovitz at conservation.ca.gov  Wed Nov 20 11:28:09 2013
From: Bob.Moskovitz at conservation.ca.gov (Moskovitz, Bob@DOC)
Date: Wed, 20 Nov 2013 19:28:09 +0000
Subject: [gdal-dev] Can GDAL access ARCGIS REST services?
In-Reply-To: <201311202021.30353.even.rouault@mines-paris.org>
References: <60358EDE3281814C993C0519A6DD0F1903FD6D46@057-SN2MPN1-063.057d.mgd.msft.net>
	<201311202021.30353.even.rouault@mines-paris.org>
Message-ID: <60358EDE3281814C993C0519A6DD0F1903FD6D79@057-SN2MPN1-063.057d.mgd.msft.net>

That's too bad :(  Here is another one that doesn't work even though it says it is a "MapServer":  http://atlas.resources.ca.gov/ArcGIS/rest/services/Base_Maps/NAIP2012_Index/MapServer .


-----Original Message-----
From: Even Rouault [mailto:even.rouault at mines-paris.org] 
Sent: Wednesday, November 20, 2013 11:22 AM
To: gdal-dev at lists.osgeo.org
Cc: Moskovitz, Bob at DOC
Subject: Re: [gdal-dev] Can GDAL access ARCGIS REST services?

Le mercredi 20 novembre 2013 19:58:29, Moskovitz, Bob at DOC a ?crit :
> Hello all,
> 
> At one time, I was able to view NAIP imagery using WMS, but it appears that
> I can only access it using ARCGIS REST services.   According to
> http://www.northrivergeographic.com/qgis-adding-an-arcgis-rest-service
> , I tried something like this:
> 
> C:\>gdal_translate --debug on
> "http://gis.apfo.usda.gov/arcgis/rest/services/NAIP/California_2012_1m
> _NC/ ImageServer?f=json&pretty=true" c:\temp\NAIP2012.xml -of WMS 
> HTTP:
> Fetch(http://gis.apfo.usda.gov/arcgis/rest/services/NAIP/California_20
> 12_1
> m_NC/ImageServer?f=json&pretty=true) ERROR 4: 
> `/vsimem/http_1/file.dat' not recognised as a supported file format.
> 
> ERROR 4: `/tmp/file.dat' not recognised as a supported file format.
> 
> GDALOpen failed - 4
> `/tmp/file.dat' not recognised as a supported file format.
> 
> Anyone have any suggestions on how to access this web service?

The WMS driver only understands documents produced by the "MapServer" ArcGIS service/protocol, not "ImageServer"

> 
> Thanks!
> 
> 
> Robert Moskovitz
> California Geological Survey
> Seismic Hazards Zonation Program
> 
> CONFIDENTIALITY NOTICE: This communication is intended only for the 
> use of the individual or entity to which it is addressed. This message 
> contains information from the State of California, California 
> Geological Survey, which may be privileged, confidential and exempt 
> from disclosure under applicable law, including the Electronic 
> Communications Privacy Act. If the reader of this communication is not 
> the intended recipient, you are hereby notified that any 
> dissemination, distribution, or copying of this communication is strictly prohibited.

--
Geospatial professional services
http://even.rouault.free.fr/services.html


From tpiepho at gmail.com  Wed Nov 20 14:32:21 2013
From: tpiepho at gmail.com (Trent Piepho)
Date: Wed, 20 Nov 2013 14:32:21 -0800
Subject: [gdal-dev] [PATCH v2] Support Mercator_2SP in GeoTIFF
In-Reply-To: <201311201035.44812.even.rouault@mines-paris.org>
References: <CAPcvoOJctLnpVBa=X9V0HHELv1vvRjbGzhuHNc0zsNptUkNrfw@mail.gmail.com>
	<CAPcvoOLeCJVm_=VqAKhN5owdRwQ_sNNSX7LHfV1fuJTOdjsVLA@mail.gmail.com>
	<CA+7tXihgJrv7qCVPPh+Q8J7P-jjSYH8wTWZETbCk0WSnOe7EDA@mail.gmail.com>
	<201311201035.44812.even.rouault@mines-paris.org>
Message-ID: <CA+7tXihoF6eHLF+oH7=jkWW_zQRH7C0uD02EW-97CZLqCtRZrg@mail.gmail.com>

On Wed, Nov 20, 2013 at 1:35 AM, Even Rouault
<even.rouault at mines-paris.org> wrote:
>
> Le mercredi 20 novembre 2013 03:29:25, Trent Piepho a ?crit :
> > That file had both StdParallel1 and ScaleAtNatOrigin defined.
> >
> > I've uploaded two new files.  This one has only StdParallel1 defined with
> > no ScaleAtNatOrigin.
> > https://drive.google.com/file/d/0BybuTedE9CLxRnNlNUl2Zm5JRzg/edit?usp=shari
> > ng
> >
> > This file has the lat_ts stored in NatOriginLat and no ScaleAtNatOrigin
> > defined.
> > https://drive.google.com/file/d/0BybuTedE9CLxMzltYlBFWU51RzA/edit?usp=shari
> > ng
> >
> > I think the latter might have better compatibility.  Yet it seems to
> > clearly be the incorrect way to do it.
>
> If the way of encoding/decoding is changed, it would be best to do it the
> "right" way and eventually other vendors will catch up with this
> interpretation.

Right now the way GDAL handles Mercator_2SP doesn't work with
anything, including GDAL.  So clearly it should be changed to
something else.

Of the two options, one (StdParallel1) would appear to be the correct
way and the other (NatOriginLat) might have better compatibility with
existing software.  It would be nice to see the results of testing the
file using NatOriginLat, to see if it does indeed work correctly with
other software.

GDAL could be patched to read both options as Mercator_2SP.  It's not
correct, but given that there appears to be a lot of software that
places the latitude of true scale in NatOriginLat and that using an
origin other than the equator for Mercator is not something commonly
done, it's going to be the right guess almost all the time.

From salim at pixoneer.co.kr  Wed Nov 20 16:15:53 2013
From: salim at pixoneer.co.kr (=?ks_c_5601-1987?B?U2V1bmcgQWUgTGlt?=)
Date: Thu, 21 Nov 2013 09:15:53 +0900
Subject: [gdal-dev] =?ks_c_5601-1987?q?NewDataset_and_SetBand_error?=
Message-ID: <1384992953.16378.269.salim@pixoneer.co.kr>



div, span, p { padding: 0px; margin:0cm; margin-bottom:3.5pt; text-align:justify; text-justify:inter-ideograph; text-autospace:none; word-break:break-hangul; font-size: 10pt; }; p.fcknormal, li.fcknormal, div.fcknormal { padding: 0px; margin:0cm; margin-bottom:3.5pt; text-align:justify; text-justify:inter-ideograph; text-autospace:none; word-break:break-hangul; font-size: 10pt };

I build GDAL library just opening "makegdal10.sln".
My test program is just simple console application with VS2010 without any added configuration.
GDAL :f:\gdal-1.10.0\
Test program include config :f:\gdal-1.10.0\port\;f:\gdal-1.10.0\gcore;f:\gdal-1.10.0\ogr;f:\gdal-1.10.0\frmts;
Test program link path :f:\gdal-1.10.0\gdal_i.lib

In my thought, my program may use same sources with GDAL.

Is there any GDAL configuration for my program?

Thanks.
Seung Ae


----- Original Message -----
From:Frank Warmerdam [warmerdam at pobox.com]
To:Seung Ae Lim [salim at pixoneer.co.kr]
Cc:gdal dev [gdal-dev at lists.osgeo.org]
Sent:Fri , November 08, 2013 01:31 AM
Subject:Re: [gdal-dev] NewDataset and SetBand error




Seung,


If the fields, like papoBands in the dataset seem ok before stepping into SetBand(), and corrupt once you are inside I would suspect that GDAL and your application have been built with different gdal_priv.h include files *or* with different structure alighnments flags for Visual Studio.  Did you build GDAL from source using the same configuration you are building your application with?
Best regards,
Frank






On Thu, Nov 7, 2013 at 1:03 AM, Seung Ae Lim <  salim at pixoneer.co.kr  > wrote:



Dear,

I make a console application with VS2010 linking "gdal_i.lib".
The steps are :
1. Create New Dataset and Band in main.cpp
class XXDataset : public GDALPamDataset
{
public:
	XXDataset() {};
	~XXDataset() {};

	static GDALDataset* Open(GDALOpenInfo*);
};

class XXRasterBand : public GDALPamRasterBand
{
public:
	XXRasterBand( GDALDataset*, int, GDALDataType );
	~XXRasterBand() {};
};



GDALDataset* XXDataset::Open(GDALOpenInfo* pOpenInfo)
{
	XXDataset* poDS = new XXDataset();
	poDS-   >nRasterXSize = 100;
	poDS-   >nRasterYSize = 200;
	poDS-   >eAccess = GA_Update;
	poDS-   >nBands = 3;

	int iBand = 0;
	for(iBand = 1; iBand <   = 3; iBand++ )
	{
		XXRasterBand* band = new XXRasterBand( poDS, iBand, GDT_Byte);
		poDS-   >SetBand( iBand, band );
	}

	return poDS;
}

XXRasterBand::XXRasterBand( GDALDataset *poDS, int nBand, GDALDataType eType)
{
	this-   >poDS = poDS;
	this-   >nBand = nBand;
	this-   >eDataType = eType;
	nRasterXSize = 100;
	nRasterYSize = 200;
	nBlockXSize = nRasterXSize;
	nBlockYSize = nRasterYSize;
}

2. Add the code in main function
void main()
{


        GDALDataset* pDSTemp = XXDataset::Open(NULL);
	if (pDSTemp) GDALClose(pDSTemp);
}



I compile and try to debug this app.
But in "poDS-  >SetBand" line of "XXDataset::Open", the app is broken when the first band is ready to set.
In XXDataset::Open, all value of parameters is right.
But When stepping into the "SetBand" function, the values may be corrupted.
"papobands" of GDALDataset is not null and it make an error.

Please let me know the reason or some tips.

Thanks.



  

_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org

http://lists.osgeo.org/mailman/listinfo/gdal-dev








-- 

---------------------------------------+--------------------------------------

I set the clouds in motion - turn up  | Frank Warmerdam, warmerdam at pobox.com

light and sound - activate the windows | http://pobox.com/~warmerdam

and watch the world go round - Rush    | Geospatial Software Developer




-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131121/ef9572ce/attachment.html>

From david.reed.c at gmail.com  Thu Nov 21 06:14:05 2013
From: david.reed.c at gmail.com (David Reed)
Date: Thu, 21 Nov 2013 09:14:05 -0500
Subject: [gdal-dev] ogr2ogr libcurl error
Message-ID: <CAM6XA7mwCFtrepyp9DPFvXKi0gMUdsvyWq_O+fMKd76wPGbScA@mail.gmail.com>

Hi, I am trying to get ogr2ogr working, but am getting the following error:

dyld: Library not loaded: libcurl.4.dylib
  Referenced from: /usr/local/bin/ogr2ogr
  Reason: Incompatible library version: ogr2ogr requires version 8.0.0 or
later, but libcurl.4.dylib provides version 7.0.0

As I can tell, the latest curl is version 7
(link)<http://curl.haxx.se/download.html>,
why is this asking for version 8? I also tried to upgrade curl with brew
but couldn't symlink into /usr/local, because would cause conflicts with
the OS.

Anyone have any ideas?

-Dave
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131121/3cfe861c/attachment.html>

From even.rouault at mines-paris.org  Thu Nov 21 13:34:00 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 21 Nov 2013 22:34:00 +0100
Subject: [gdal-dev] ogr2ogr libcurl error
In-Reply-To: <CAM6XA7mwCFtrepyp9DPFvXKi0gMUdsvyWq_O+fMKd76wPGbScA@mail.gmail.com>
References: <CAM6XA7mwCFtrepyp9DPFvXKi0gMUdsvyWq_O+fMKd76wPGbScA@mail.gmail.com>
Message-ID: <201311212234.00159.even.rouault@mines-paris.org>

Le jeudi 21 novembre 2013 15:14:05, David Reed a ?crit :
> Hi, I am trying to get ogr2ogr working, but am getting the following error:
> 
> dyld: Library not loaded: libcurl.4.dylib
>   Referenced from: /usr/local/bin/ogr2ogr
>   Reason: Incompatible library version: ogr2ogr requires version 8.0.0 or
> later, but libcurl.4.dylib provides version 7.0.0
> 
> As I can tell, the latest curl is version 7
> (link)<http://curl.haxx.se/download.html>,
> why is this asking for version 8? I also tried to upgrade curl with brew
> but couldn't symlink into /usr/local, because would cause conflicts with
> the OS.
> 
> Anyone have any ideas?

If you didn't define the --with-curl option when running GDAL ./configure, then 
GDAL will link with the curl library indicated by "curl-config --libs"
You likley have several libcurl on your system and the one that got used when 
linking GDAL is not the one available at runtime.
The 8.0.0 or 7.0.0 don't necessarily reflect the "human readable" version of 
the curl library. It might be some other numbering scheme related to how the 
API/ABI of the library evolves, or something linked to packaging.

> 
> -Dave

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From afalciano at yahoo.it  Fri Nov 22 02:15:23 2013
From: afalciano at yahoo.it (Antonio Falciano)
Date: Fri, 22 Nov 2013 11:15:23 +0100
Subject: [gdal-dev] Gdalinfo does not print into file on Windows
In-Reply-To: <1379460881026-5078377.post@n6.nabble.com>
References: <loom.20130917T130051-998@post.gmane.org>	<1379430157.52386f0d28e39@imp.free.fr>
	<1379460881026-5078377.post@n6.nabble.com>
Message-ID: <528F2EBB.1000309@yahoo.it>

Il 18/09/2013 01:34, lpinner ha scritto:
> Disabling the ECW plugin also enables setting a non-zero exit code
> (http://trac.osgeo.org/gdal/ticket/4830)

Hi all,
it seems that this issue disappears updating to ECW 5.0 SDK, as Tamas
Szekeres suggests in this ticket [1]. I've discovered it doing some little
tests on GSE [2]. Can anyone confirm this?

Cheers,
Antonio

[1] https://github.com/gisinternals/buildsystem/issues/36
[2] 
http://gis.stackexchange.com/questions/78304/gdalinfo-image-tifstats-txt-returns-empty-text-file-windows-7-64-bit

-- 
Antonio Falciano
http://www.linkedin.com/in/antoniofalciano

From Moses.Gone at t-systems.com  Fri Nov 22 04:12:32 2013
From: Moses.Gone at t-systems.com (Moses.Gone at t-systems.com)
Date: Fri, 22 Nov 2013 13:12:32 +0100
Subject: [gdal-dev] Handling data raster data in decimal seconds
Message-ID: <2D55B4FBCD59D045AC382D3F65435B7903843B2CC804@HE101453.emea1.cds.t-internal.com>

Hello GDAL Experts,
We have a grid dataset that is in WGS84 decimal-second coordinates. The first problem is that when we run gdalinfo against this data, the coordinates systems comes out wrong i.e in decimal degrees rather than in decimal seconds:

bash-2.05$ gdalinfo -noct /users/ds57201a/user3/rbda/de/uka30qs/dlu/grd/aa_ds_1
Driver: AIG/Arc/Info Binary Grid
Files: /users/ds57201a/user3/rbda/de/uka30qs/dlu/grd/aa_ds_1
       /users/ds57201a/user3/rbda/de/uka30qs/dlu/grd/aa_ds_1.aux.xml
       /users/ds57201a/user3/rbda/de/uka30qs/dlu/grd/aa_ds_1/hdr.adf
       /users/ds57201a/user3/rbda/de/uka30qs/dlu/grd/aa_ds_1/metadata.xml
       /users/ds57201a/user3/rbda/de/uka30qs/dlu/grd/aa_ds_1/prj.adf
       /users/ds57201a/user3/rbda/de/uka30qs/dlu/grd/aa_ds_1/w001001.adf
       /users/ds57201a/user3/rbda/de/uka30qs/dlu/grd/aa_ds_1/w001001x.adf
       /users/ds57201a/user3/rbda/de/uka30qs/dlu/grd/aa_ds_1/dblbnd.adf
       /users/ds57201a/user3/rbda/de/uka30qs/dlu/grd/aa_ds_1/sta.adf
       /users/ds57201a/user3/rbda/de/uka30qs/dlu/grd/aa_ds_1/vat.adf
Size is 1324, 936
Coordinate System is:
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563,
            AUTHORITY["EPSG","7030"]],
        TOWGS84[0,0,0,0,0,0,0],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0,
        AUTHORITY["EPSG","8901"]],
    UNIT["degree",0.0174532925199433,
        AUTHORITY["EPSG","9108"]],
    AUTHORITY["EPSG","4326"]]
Origin = (5.984444444444445,50.945000000000000)
Pixel Size = (0.000277777777778,-0.000277777777778)
Corner Coordinates:
Upper Left  (   5.9844444,  50.9450000) (  5d59' 4.00"E, 50d56'42.00"N)
Lower Left  (   5.9844444,  50.6850000) (  5d59' 4.00"E, 50d41' 6.00"N)
Upper Right (   6.3522222,  50.9450000) (  6d21' 8.00"E, 50d56'42.00"N)
Lower Right (   6.3522222,  50.6850000) (  6d21' 8.00"E, 50d41' 6.00"N)
Center      (   6.1683333,  50.8150000) (  6d10' 6.00"E, 50d48'54.00"N)

Source SRS should look like this:
GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["arc-second",0.000004848136811095,AUTHORITY["EPSG","9104"]],AUTHORITY["EPSG","4326"]]

We know for sure that the data is in DS and not DD

Now the real problem comes when we want to warp this dataset to a different SRS. Since GDAL already reads a wrong SRS on the input data, all transformations end up wrong. We tried to override this by forcing a source coordinate systems on the data using gdal_translate, but to no avail:

gdal_translate -of vrt -a_srs /users/ds57201a/user1/uka/ukatiler/config/projections/ds_4326.prj aachen.vrt test.vrt

ds_4326.prj wkt:
GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["arc-second",0.000004848136811095,AUTHORITY["EPSG","9104"]],AUTHORITY["EPSG","4326"]]

gdalwarp --debug on -wm 500 -wo SKIP_NOSOURCE=YES -wo NUM_THREADS=ALL_CPUS -wo OPTIMIZE_SIZE=TRUE -tr 1.0 1.0 -of vrt -s_srs ds_4326.prj -t_srs ds_4258.prj vrt_with_target_srs.vrt

That command generated this result:

GDAL: GDALOpen(/users/ds57201a/user3/rbda/de/uka30qs/dlu/grd/617bc9d0-52ce-11e3-9de2-f1b38c98f22b/uka_parameter/vrt_with_source_srs.vrt, this=44f20) succeeds as VRT.
OGRCT: PROJ >= 4.8.0 features enabled
OGRCT: Wrap source at 6.16833.
OGRCT: Source: +proj=longlat +ellps=WGS84 +no_defs
OGRCT: Target: +proj=longlat +ellps=GRS80 +no_defs
OGRCT: Wrap target at 6.16833.
OGRCT: Source: +proj=longlat +ellps=GRS80 +no_defs
OGRCT: Target: +proj=longlat +ellps=WGS84 +no_defs
OGRCT: Wrap source at 6.16833.
OGRCT: Source: +proj=longlat +ellps=WGS84 +no_defs
OGRCT: Target: +proj=longlat +ellps=GRS80 +no_defs
OGRCT: Wrap target at 6.16833.
OGRCT: Source: +proj=longlat +ellps=GRS80 +no_defs
OGRCT: Target: +proj=longlat +ellps=WGS84 +no_defs
Creating output file that is 0P x 0L.
ERROR 1: Attempt to create 0x0 dataset is illegal,sizes must be larger than zero.

Gdalinfo on the warped dataset(when I don't get the above error) shows this:
Corner Coordinates:
- Upper Left  (   30301.000,  187402.000) (Invalid angle,Invalid angle)
Lower Left  (   30301.000,  178241.000) (Invalid angle,Invalid angle)
Upper Right (   39346.000,  187402.000) (Invalid angle,Invalid angle)
Lower Right (   39346.000,  178241.000) (Invalid angle,Invalid angle)
Center      (   34823.500,  182821.500) (Invalid angle,Invalid angle)

Is there anyone who has experienced the same thing or  knows how to deal with data in decimal seconds within GDAL?


Thanks and regards
Moses

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131122/7eb490eb/attachment.html>

From even.rouault at mines-paris.org  Fri Nov 22 10:38:14 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 22 Nov 2013 19:38:14 +0100
Subject: [gdal-dev] Handling data raster data in decimal seconds
In-Reply-To: <2D55B4FBCD59D045AC382D3F65435B7903843B2CC804@HE101453.emea1.cds.t-internal.com>
References: <2D55B4FBCD59D045AC382D3F65435B7903843B2CC804@HE101453.emea1.cds.t-internal.com>
Message-ID: <201311221938.14943.even.rouault@mines-paris.org>

Le vendredi 22 novembre 2013 13:12:32, Moses.Gone at t-systems.com a ?crit :
> Hello GDAL Experts,
> We have a grid dataset that is in WGS84 decimal-second coordinates. The
> first problem is that when we run gdalinfo against this data, the
> coordinates systems comes out wrong i.e in decimal degrees rather than in
> decimal seconds:
> 
> bash-2.05$ gdalinfo -noct
> /users/ds57201a/user3/rbda/de/uka30qs/dlu/grd/aa_ds_1 Driver: AIG/Arc/Info
> Binary Grid
> Files: /users/ds57201a/user3/rbda/de/uka30qs/dlu/grd/aa_ds_1
>        /users/ds57201a/user3/rbda/de/uka30qs/dlu/grd/aa_ds_1.aux.xml
>        /users/ds57201a/user3/rbda/de/uka30qs/dlu/grd/aa_ds_1/hdr.adf
>        /users/ds57201a/user3/rbda/de/uka30qs/dlu/grd/aa_ds_1/metadata.xml
>        /users/ds57201a/user3/rbda/de/uka30qs/dlu/grd/aa_ds_1/prj.adf
>        /users/ds57201a/user3/rbda/de/uka30qs/dlu/grd/aa_ds_1/w001001.adf
>        /users/ds57201a/user3/rbda/de/uka30qs/dlu/grd/aa_ds_1/w001001x.adf
>        /users/ds57201a/user3/rbda/de/uka30qs/dlu/grd/aa_ds_1/dblbnd.adf
>        /users/ds57201a/user3/rbda/de/uka30qs/dlu/grd/aa_ds_1/sta.adf
>        /users/ds57201a/user3/rbda/de/uka30qs/dlu/grd/aa_ds_1/vat.adf
> Size is 1324, 936
> Coordinate System is:
> GEOGCS["WGS 84",
>     DATUM["WGS_1984",
>         SPHEROID["WGS 84",6378137,298.257223563,
>             AUTHORITY["EPSG","7030"]],
>         TOWGS84[0,0,0,0,0,0,0],
>         AUTHORITY["EPSG","6326"]],
>     PRIMEM["Greenwich",0,
>         AUTHORITY["EPSG","8901"]],
>     UNIT["degree",0.0174532925199433,
>         AUTHORITY["EPSG","9108"]],
>     AUTHORITY["EPSG","4326"]]
> Origin = (5.984444444444445,50.945000000000000)
> Pixel Size = (0.000277777777778,-0.000277777777778)
> Corner Coordinates:
> Upper Left  (   5.9844444,  50.9450000) (  5d59' 4.00"E, 50d56'42.00"N)
> Lower Left  (   5.9844444,  50.6850000) (  5d59' 4.00"E, 50d41' 6.00"N)
> Upper Right (   6.3522222,  50.9450000) (  6d21' 8.00"E, 50d56'42.00"N)
> Lower Right (   6.3522222,  50.6850000) (  6d21' 8.00"E, 50d41' 6.00"N)
> Center      (   6.1683333,  50.8150000) (  6d10' 6.00"E, 50d48'54.00"N)
> 
> Source SRS should look like this:
> GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS
> 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326
> "]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["arc-second",0.0000
> 04848136811095,AUTHORITY["EPSG","9104"]],AUTHORITY["EPSG","4326"]]
> 
> We know for sure that the data is in DS and not DD

I can see in the AIGRID driver that there's a special case to deal with "Units 
DS" when reading in prj.adf.
I'm not sure when your source SRS comes from ?
It would be interesting that you create a ticket with the dataset attached and 
the expect corner coordinates.


> 
> Now the real problem comes when we want to warp this dataset to a different
> SRS. Since GDAL already reads a wrong SRS on the input data, all
> transformations end up wrong. We tried to override this by forcing a
> source coordinate systems on the data using gdal_translate, but to no
> avail:
> 
> gdal_translate -of vrt -a_srs
> /users/ds57201a/user1/uka/ukatiler/config/projections/ds_4326.prj
> aachen.vrt test.vrt
> 
> ds_4326.prj wkt:
> GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS
> 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326
> "]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["arc-second",0.0000
> 04848136811095,AUTHORITY["EPSG","9104"]],AUTHORITY["EPSG","4326"]]
> 
> gdalwarp --debug on -wm 500 -wo SKIP_NOSOURCE=YES -wo NUM_THREADS=ALL_CPUS
> -wo OPTIMIZE_SIZE=TRUE -tr 1.0 1.0 -of vrt -s_srs ds_4326.prj -t_srs
> ds_4258.prj vrt_with_target_srs.vrt
> 
> That command generated this result:
> 
> GDAL:
> GDALOpen(/users/ds57201a/user3/rbda/de/uka30qs/dlu/grd/617bc9d0-52ce-11e3-
> 9de2-f1b38c98f22b/uka_parameter/vrt_with_source_srs.vrt, this=44f20)
> succeeds as VRT. OGRCT: PROJ >= 4.8.0 features enabled
> OGRCT: Wrap source at 6.16833.
> OGRCT: Source: +proj=longlat +ellps=WGS84 +no_defs
> OGRCT: Target: +proj=longlat +ellps=GRS80 +no_defs
> OGRCT: Wrap target at 6.16833.
> OGRCT: Source: +proj=longlat +ellps=GRS80 +no_defs
> OGRCT: Target: +proj=longlat +ellps=WGS84 +no_defs
> OGRCT: Wrap source at 6.16833.
> OGRCT: Source: +proj=longlat +ellps=WGS84 +no_defs
> OGRCT: Target: +proj=longlat +ellps=GRS80 +no_defs
> OGRCT: Wrap target at 6.16833.
> OGRCT: Source: +proj=longlat +ellps=GRS80 +no_defs
> OGRCT: Target: +proj=longlat +ellps=WGS84 +no_defs
> Creating output file that is 0P x 0L.
> ERROR 1: Attempt to create 0x0 dataset is illegal,sizes must be larger than
> zero.
> 
> Gdalinfo on the warped dataset(when I don't get the above error) shows
> this: Corner Coordinates:
> - Upper Left  (   30301.000,  187402.000) (Invalid angle,Invalid angle)
> Lower Left  (   30301.000,  178241.000) (Invalid angle,Invalid angle)
> Upper Right (   39346.000,  187402.000) (Invalid angle,Invalid angle)
> Lower Right (   39346.000,  178241.000) (Invalid angle,Invalid angle)
> Center      (   34823.500,  182821.500) (Invalid angle,Invalid angle)
> 
> Is there anyone who has experienced the same thing or  knows how to deal
> with data in decimal seconds within GDAL?
> 
> 
> Thanks and regards
> Moses

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From antti.castren at iki.fi  Fri Nov 22 14:18:27 2013
From: antti.castren at iki.fi (=?ISO-8859-1?Q?Antti_Castr=E9n?=)
Date: Sat, 23 Nov 2013 00:18:27 +0200
Subject: [gdal-dev] [PATCH v2] Support Mercator_2SP in GeoTIFF
In-Reply-To: <CA+7tXihgJrv7qCVPPh+Q8J7P-jjSYH8wTWZETbCk0WSnOe7EDA@mail.gmail.com>
References: <CAPcvoOJctLnpVBa=X9V0HHELv1vvRjbGzhuHNc0zsNptUkNrfw@mail.gmail.com>
	<CA+7tXiga3wM_eQnb4vg=aPEpJnDNa3b+HRyhEwDkDighMFfe=g@mail.gmail.com>
	<CAPcvoOLeCJVm_=VqAKhN5owdRwQ_sNNSX7LHfV1fuJTOdjsVLA@mail.gmail.com>
	<CA+7tXihgJrv7qCVPPh+Q8J7P-jjSYH8wTWZETbCk0WSnOe7EDA@mail.gmail.com>
Message-ID: <CAPcvoOJBbV4Mk=PEALu8kLgYz=fTwTg-r3Rv0xONfGX6jzevOQ@mail.gmail.com>

Hi Trent et al.

Thanks for your work on the issue.

I tested the files, and results were not satisfactory. But at least we
got more information on the issue.

FME opened both files.

The georeferencing of 18440_lowres_nol.tif was recognized by FME as:
DESC_NM: Global Mercator
DT_NAME: NAD83
PARM2: 47.667
PROJ: MRCAT
UNIT: METER

This should place the file at correct location.

The georeferencing of 18440_lowres_sp1.tif was recognized by FME as:
DESC_NM: Global Mercator
DT_NAME: NAD83
PROJ: MRCAT
UNIT: METER

To compare to the first file which you provided last week, its FME
parameters were:
DESC_NM: Global Mercator
DT_NAME: NAD83
PROJ: MRCAT
UNIT: METER

It seems FME doesn't read StdParallel1 or at least it doesn't use it.

Geomedia did NOT recognize either of the files as valid GeoTIFF.

To get projection (and of course location) right GeoMedia reads following keys:
      ProjCoordTransGeoKey (Short,1): CT_Mercator
      ProjLinearUnitsGeoKey (Short,1): Linear_Meter
      ProjNatOriginLongGeoKey (Double,1): 0
      ProjNatOriginLatGeoKey (Double,1): 0
      ProjFalseEastingGeoKey (Double,1): 0
      ProjFalseNorthingGeoKey (Double,1): 0
      ProjCenterLatGeoKey (Double,1): 60.7666667
      ProjScaleAtNatOriginGeoKey (Double,1): 0.48961699

These keys are (in my humble opinion) logical and the most correct
ones. Of course there is some redundancy. Unfortunately FME and ArcGIS
don't read last two at all, and therefore they place the file as if it
was projected from the Equator with scale 0.

ArcGIS opened all your three files at correct location.

By the way, I have seen that many sofware which are able to
interchange latitude of true scale and scalefactor at the Equator fail
to do the calculation with enough decimal places. My experience is
that you need at least 8 decimal places in scale factor to align your
raster data correctly. (As seen in the GeoMedia example above)

Br,

  Antti

2013/11/20 Trent Piepho <tpiepho at gmail.com>:
> Antii,
>
> Thank you for the testing.  It looks like Arc/GIS works while FME and
> Intergraph don't.
>
> That file had both StdParallel1 and ScaleAtNatOrigin defined.
>
> I've uploaded two new files.  This one has only StdParallel1 defined with no
> ScaleAtNatOrigin.
> https://drive.google.com/file/d/0BybuTedE9CLxRnNlNUl2Zm5JRzg/edit?usp=sharing
>
> This file has the lat_ts stored in NatOriginLat and no ScaleAtNatOrigin
> defined.
> https://drive.google.com/file/d/0BybuTedE9CLxMzltYlBFWU51RzA/edit?usp=sharing
>
> I think the latter might have better compatibility.  Yet it seems to clearly
> be the incorrect way to do it.
>
>
> On Mon, Nov 18, 2013 at 4:54 AM, Antti Castr?n <antti.castren at iki.fi> wrote:
>>
>> Hi Trent,
>>
>> The chart  opens in ArcMap (ArcGIS 10.0) well, and it is in right
>> location (Seattle).
>>
>> Relevant properties of the file as seen by ArcGIS:
>> Cell Size: 240.003787, 240.003787
>> Extent
>> Top:4143530.20898
>> Left: -9278434.53415
>> Right:  -9165872.75807
>> Bottom:  3984167.69444
>> Spatial Reference: Global Mercator
>> Linear Unit: Meter
>> false_easting: 0
>> false_northing: 0
>> central_meridian: 0
>> standard_parallel_1:  47.667
>> Datum: D_North_American_1983
>>
>>
>> I opened the file in FME Data Inspector (FME Desktop 2013 SP1) also.
>> It did not read the latitude of true scale from the
>> ProjStdParallel1GeoKey as you can see from the following parameters.
>> Therefore it places the chart to NE Georgia/NW South Carolina as if
>> the latitude of true scale was the Equator.
>>
>> <FME Parameters>
>> Coordinate System Parameters
>> CS_NAME: _FME_0
>> DESC_NM: Global Mercator
>> DT_NAME: NAD83
>> PROJ: MRCAT
>> UNIT: METER
>>
>> Datum Parameters
>> DESC_NM: NAD 1983, Alaska, Canada,Continental US,Mexico,Central America
>> ELLIPSOID: GRS1980
>> SOURCE: US Defense Mapping Agency, TR-8350.2-B, August 1993
>> USE: NAD83
>>
>> Ellipsoid Parameters
>> DESC_NM: Geodetic Reference System of 1980
>> E_RAD: 6378137
>> P_RAD: 6356752.3141403478
>> SOURCE: Stem, L.E., Jan 1989, State Plane Coordinate System of 1983
>>
>> OGC WKT Description
>> PROJCS["Global Mercator",
>>     GEOGCS["NAD83",
>>         DATUM["North_American_Datum_1983",
>>             SPHEROID["Geodetic Reference System of
>> 1980",6378137,298.2572221008916,
>>                 AUTHORITY["EPSG","7019"]],
>>             AUTHORITY["EPSG","6269"]],
>>         PRIMEM["Greenwich",0],
>>         UNIT["degree",0.0174532925199433],
>>         AUTHORITY["EPSG","4269"]],
>>     PROJECTION["Mercator_1SP"],
>>     PARAMETER["central_meridian",0],
>>     PARAMETER["scale_factor",1],
>>     PARAMETER["false_easting",0],
>>     PARAMETER["false_northing",0],
>>     UNIT["METER",1]]
>>
>> Esri WKT Description
>>
>> PROJCS["Global_Mercator",GEOGCS["GCS_North_American_1983",DATUM["D_North_American_1983",SPHEROID["Geodetic_Reference_System_of_1980",6378137,298.2572221008916]],PRIMEM["Greenwich",0],UNIT["Degree",0.017453292519943295]],PROJECTION["Mercator"],PARAMETER["central_meridian",0],PARAMETER["false_easting",0],PARAMETER["false_northing",0],UNIT["Meter",1],PARAMETER["standard_parallel_1",0.0]]
>> </FME Parameters>
>>
>> Intergraph's Geomedia Professional recognises the file as GeoTIFF, but
>> the chart appears to be in the same false place as with FME.
>>
>> If you want, I could update the file's georeferencing by FME and
>> Geomedia so that location is correct. Then I could send listgeo
>> information or even put the actual files available if desired.
>>
>> The goal is, of course, to get various software vendors to use the
>> GeoTIFF-information the same way. Hopefully the common way would also
>> be logically correct, but I guess that's too much to ask.
>>
>> Best regards,
>>
>>   Antti
>>
>>
>> Here is the listgeo info from the original file for those who are
>> interested:
>>
>> Geotiff_Information:
>>    Version: 1
>>    Key_Revision: 1.0
>>    Tagged_Information:
>>       ModelTiepointTag (2,3):
>>          0                0                0
>>          -9278434.53      4143530.21       0
>>       ModelPixelScaleTag (1,3):
>>          240.003787       240.003787       0
>>       End_Of_Tags.
>>    Keyed_Information:
>>       GTModelTypeGeoKey (Short,1): ModelTypeProjected
>>       GTRasterTypeGeoKey (Short,1): RasterPixelIsArea
>>       GTCitationGeoKey (Ascii,16): "Global Mercator"
>>       GeographicTypeGeoKey (Short,1): GCS_NAD83
>>       GeogCitationGeoKey (Ascii,6): "NAD83"
>>       GeogAngularUnitsGeoKey (Short,1): Angular_Degree
>>       GeogSemiMajorAxisGeoKey (Double,1): 6378137
>>       GeogInvFlatteningGeoKey (Double,1): 298.257222
>>       Unknown-2062 (Double,3): 0                0                0
>>       ProjectedCSTypeGeoKey (Short,1): User-Defined
>>       ProjectionGeoKey (Short,1): User-Defined
>>       ProjCoordTransGeoKey (Short,1): CT_Mercator
>>       ProjLinearUnitsGeoKey (Short,1): Linear_Meter
>>       ProjStdParallel1GeoKey (Double,1): 47.667
>>       ProjNatOriginLongGeoKey (Double,1): 0
>>       ProjNatOriginLatGeoKey (Double,1): 0
>>       ProjFalseEastingGeoKey (Double,1): 0
>>       ProjFalseNorthingGeoKey (Double,1): 0
>>       ProjScaleAtNatOriginGeoKey (Double,1): 1
>>       End_Of_Keys.
>>    End_Of_Geotiff.
>> Projection Method: CT_Mercator
>>    ProjNatOriginLatGeoKey: 0.000000 (  0d 0' 0.00"N)
>>    ProjNatOriginLongGeoKey: 0.000000 (  0d 0' 0.00"E)
>>    ProjScaleAtNatOriginGeoKey: 1.000000
>>    ProjFalseEastingGeoKey: 0.000000 m
>>    ProjFalseNorthingGeoKey: 0.000000 m
>> GCS: 4269/NAD83
>> Datum: 6269/North American Datum 1983
>> Ellipsoid: 7019/GRS 1980 (6378137.00,6356752.31)
>> Prime Meridian: 8901/Greenwich (0.000000/  0d 0' 0.00"E)
>> Projection Linear Units: 9001/metre (1.000000m)
>> Corner Coordinates:
>> Upper Left    (-9278434.534, 4143530.209)
>> Lower Left    (-9278434.534, 3984167.694)
>> Upper Right   (-9165872.758, 4143530.209)
>> Lower Right   (-9165872.758, 3984167.694)
>> Center        (-9222153.646, 4063848.952)
>>
>>
>> 2013/11/14 Trent Piepho <tpiepho at gmail.com>:
>> > It looks like arcgis does not support Mercator_1SP in geotiff files.
>> > It just ignores the scale factor and uses 1.0.  Which means in GDAL
>> > and libgeotiff as they are now, there is no way to export Mercator
>> > projections that don't have a scale of 1.0 to arcgis.
>> >
>> > ArcGIS does support Mercator_2SP, but instead of placing the latitude
>> > of true scale in ProjStdParallel1GeoKey, it uses
>> > ProjNatOriginLatGeoKey.  Which seems to be plainly wrong, yet that's
>> > what it does.
>> >
>> > I wonder if ESRI used libgeotiff?  With unpatched libgeotiff, the only
>> > way to get a latitude from a Mercator geotiff it to use one of the
>> > origin latitude GeoKeys.  It's not correct, but it does allow one to
>> > stick the number in the file and get it back out without having to
>> > modify or understand any libgeotiff code.
>> >
>> > It's possible that ArcGIS supports getting the latitude of true scale
>> > from ProjStdParallel1GeoKey, even it it doesn't store it there.
>> > Antii, could you test this file with ArcGIS?
>> >
>> >
>> > https://drive.google.com/file/d/0BybuTedE9CLxak9iakZRTC00cHM/edit?usp=sharing
>> >
>> > Pick file->download to get the geotiff file.
>> >
>> > It should have projection information like this:
>> >     PROJECTION["Mercator_2SP"],
>> >     PARAMETER["standard_parallel_1",47.667],
>> >     PARAMETER["central_meridian",0],
>> >     PARAMETER["false_easting",0],
>> >     PARAMETER["false_northing",0],
>> >     UNIT["metre",1,
>> >         AUTHORITY["EPSG","9001"]]]
>> > Origin = (-9278434.534151820465922,4143530.208984711207449)
>> > Pixel Size = (240.003786961970206,-240.003786961970206)
>> > Corner Coordinates:
>> > Upper Left  (-9278434.534, 4143530.209) (123d32'26.22"W, 48d23'56.59"N)
>> > Lower Left  (-9278434.534, 3984167.694) (123d32'26.22"W, 46d57'58.64"N)
>> > Upper Right (-9165872.758, 4143530.209) (122d 2'30.76"W, 48d23'56.59"N)
>> > Lower Right (-9165872.758, 3984167.694) (122d 2'30.76"W, 46d57'58.64"N)
>> > Center      (-9222153.646, 4063848.952) (122d47'28.49"W, 47d41'15.43"N)
>
>



-- 
Antti Castr?n
+358505997538
antti.castren at iki.fi

From JPalmer at linz.govt.nz  Sat Nov 23 11:35:52 2013
From: JPalmer at linz.govt.nz (Jeremy Palmer)
Date: Sun, 24 Nov 2013 08:35:52 +1300
Subject: [gdal-dev] ECW lossless JPEG 2000 compression issue
Message-ID: <C6B695652D5E6B4597E90C5734C0242616D7A62CA3@prdlsmmsg01.ad.linz.govt.nz>

Hi Devs,

I'm using the GDAL ECW plugin with the ECW 3.3 SDK (2006-09-06) on windows and LINUX. I have built the ECW lib and GDAL plugin from source and have applied all the suggested patches from here:

http://trac.osgeo.org/gdal/wiki/ECW

However I'm getting quality issues with when reading lossless JPEG 2000 compression files. The images seem over compressed in places...

There is some mention of the ECW 3.3 release fixing a bug in the lossless JPEG 2000 compression, where previously a tiny fraction of pixels would be
compressed with a value +/-1 with respect to the input:

http://osgeo-org.1560.x6.nabble.com/ECW-JPEG-2000-SDK-v3-3-News-Update-td3774896.html

Has anyone else had issues when reading lossless JPEG 2000 files in the 3.3 SDK? Have I got all of the patches applied?

Cheers,
Jeremy

This message contains information, which is confidential and may be subject to legal privilege. If you are not the intended recipient, you must not peruse, use, disseminate, distribute or copy this message. If you have received this message in error, please notify us immediately (Phone 0800 665 463 or info at linz.govt.nz) and destroy the original message. LINZ accepts no responsibility for changes to this email, or for any attachments, after its transmission from LINZ. Thank You.

From jukka.rahkonen at mmmtike.fi  Sat Nov 23 12:48:34 2013
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Sat, 23 Nov 2013 20:48:34 +0000 (UTC)
Subject: [gdal-dev] ECW lossless JPEG 2000 compression issue
References: <C6B695652D5E6B4597E90C5734C0242616D7A62CA3@prdlsmmsg01.ad.linz.govt.nz>
Message-ID: <loom.20131123T214635-384@post.gmane.org>

Jeremy Palmer <JPalmer <at> linz.govt.nz> writes:


> 
> Has anyone else had issues when reading lossless JPEG 2000 files in the
3.3 SDK? Have I got all of the patches applied?

You are out of luck with 3.x SDK. You need SDK 4.2 or above, see
http://trac.osgeo.org/gdal/ticket/2805

-Jukka Rahkonen-


From lee.w.eddington at gmail.com  Sat Nov 23 13:47:34 2013
From: lee.w.eddington at gmail.com (Lee Eddington)
Date: Sat, 23 Nov 2013 13:47:34 -0800
Subject: [gdal-dev] WRF NetCDF import
Message-ID: <CAHmmfARq2aWy3OsqFce+YDBCmANH9+y8zzTEB_JS7zdFQeMRSQ@mail.gmail.com>

I'm trying to use r.in.gdal in GRASS GIS to import Weather Research &
Forecasting (WRF) model NetCDF output.  There have been some tips provided
by the GRASS users list, but none have worked for me.  I can import the
data as a simple x,y array with no georeferencing, but information about
georeferencing is in the file as other programs read, georeference and
display the file correctly.

gdalinfo produces the following:

lees-mbp:full Lee$ gdalinfo test_full.nc
Warning 1: No UNIDATA NC_GLOBAL:Conventions attribute
Driver: netCDF/Network Common Data Format
Files: test_full.nc
Size is 512, 512
Coordinate System is `'
Metadata:
  NC_GLOBAL#BL_PBL_PHYSICS=1
  NC_GLOBAL#BOTTOM-TOP_GRID_DIMENSION=28
  NC_GLOBAL#BOTTOM-TOP_PATCH_END_STAG=28
  NC_GLOBAL#BOTTOM-TOP_PATCH_END_UNSTAG=27
  NC_GLOBAL#BOTTOM-TOP_PATCH_START_STAG=1
  NC_GLOBAL#BOTTOM-TOP_PATCH_START_UNSTAG=1
  NC_GLOBAL#BUCKET_J=-1
  NC_GLOBAL#BUCKET_MM=-1
  NC_GLOBAL#CEN_LAT=-8.4095154
  NC_GLOBAL#CEN_LON=115.02
  NC_GLOBAL#CU_PHYSICS=0
  NC_GLOBAL#DAMP_OPT=0
  NC_GLOBAL#DAMPCOEF=0.2
  NC_GLOBAL#DFI_OPT=0
  NC_GLOBAL#DIFF_6TH_FACTOR=0.12
  NC_GLOBAL#DIFF_6TH_OPT=0
  NC_GLOBAL#DIFF_OPT=1
  NC_GLOBAL#DT=16.666666
  NC_GLOBAL#DX=3000
  NC_GLOBAL#DY=3000
  NC_GLOBAL#FEEDBACK=0
  NC_GLOBAL#GFDDA_END_H=0
  NC_GLOBAL#GFDDA_INTERVAL_M=0
  NC_GLOBAL#GMT=12
  NC_GLOBAL#GRID_FDDA=0
  NC_GLOBAL#GRID_ID=3
  NC_GLOBAL#GRID_SFDDA=0
  NC_GLOBAL#GRIDTYPE=C
  NC_GLOBAL#HYPSOMETRIC_OPT=2
  NC_GLOBAL#I_PARENT_START=34
  NC_GLOBAL#ISFTCFLX=0
  NC_GLOBAL#ISHALLOW=0
  NC_GLOBAL#ISICE=24
  NC_GLOBAL#ISLAKE=-1
  NC_GLOBAL#ISOILWATER=14
  NC_GLOBAL#ISURBAN=1
  NC_GLOBAL#ISWATER=16
  NC_GLOBAL#J_PARENT_START=34
  NC_GLOBAL#JULDAY=324
  NC_GLOBAL#JULYR=2013
  NC_GLOBAL#KHDIF=0
  NC_GLOBAL#KM_OPT=4
  NC_GLOBAL#KVDIF=0
  NC_GLOBAL#MAP_PROJ=3
  NC_GLOBAL#MFSHCONV=0
  NC_GLOBAL#MMINLU=USGS
  NC_GLOBAL#MOAD_CEN_LAT=-8.4095078
  NC_GLOBAL#MOIST_ADV_OPT=1
  NC_GLOBAL#MP_PHYSICS=3
  NC_GLOBAL#NUM_LAND_CAT=24
  NC_GLOBAL#OBS_NUDGE_OPT=0
  NC_GLOBAL#OMLCALL=0
  NC_GLOBAL#PARENT_GRID_RATIO=3
  NC_GLOBAL#PARENT_ID=2
  NC_GLOBAL#POLE_LAT=90
  NC_GLOBAL#POLE_LON=0
  NC_GLOBAL#PREC_ACC_DT=0
  NC_GLOBAL#RA_LW_PHYSICS=1
  NC_GLOBAL#RA_SW_PHYSICS=1
  NC_GLOBAL#SCALAR_ADV_OPT=1
  NC_GLOBAL#SF_SFCLAY_PHYSICS=1
  NC_GLOBAL#SF_SURFACE_PHYSICS=2
  NC_GLOBAL#SF_URBAN_PHYSICS=0
  NC_GLOBAL#SGFDDA_END_H=0
  NC_GLOBAL#SGFDDA_INTERVAL_M=0
  NC_GLOBAL#SHCU_PHYSICS=0
  NC_GLOBAL#SIMULATION_START_DATE=2013-11-20_12:00:00
  NC_GLOBAL#SMOOTH_OPTION=0
  NC_GLOBAL#SOUTH-NORTH_GRID_DIMENSION=154
  NC_GLOBAL#SOUTH-NORTH_PATCH_END_STAG=154
  NC_GLOBAL#SOUTH-NORTH_PATCH_END_UNSTAG=153
  NC_GLOBAL#SOUTH-NORTH_PATCH_START_STAG=1
  NC_GLOBAL#SOUTH-NORTH_PATCH_START_UNSTAG=1
  NC_GLOBAL#SST_UPDATE=0
  NC_GLOBAL#STAND_LON=115.02
  NC_GLOBAL#START_DATE=2013-11-20_12:00:00
  NC_GLOBAL#SURFACE_INPUT_SOURCE=1
  NC_GLOBAL#SWRAD_SCAT=1
  NC_GLOBAL#TITLE= OUTPUT FROM WRF V3.4 MODEL
  NC_GLOBAL#TKE_ADV_OPT=1
  NC_GLOBAL#TRUELAT1=-8.4095001
  NC_GLOBAL#TRUELAT2=0
  NC_GLOBAL#W_DAMPING=0
  NC_GLOBAL#WEST-EAST_GRID_DIMENSION=199
  NC_GLOBAL#WEST-EAST_PATCH_END_STAG=199
  NC_GLOBAL#WEST-EAST_PATCH_END_UNSTAG=198
  NC_GLOBAL#WEST-EAST_PATCH_START_STAG=1
  NC_GLOBAL#WEST-EAST_PATCH_START_UNSTAG=1
Subdatasets:
  SUBDATASET_1_NAME=NETCDF:"test_full.nc":Times
  SUBDATASET_1_DESC=[1x19] Times (8-bit character)
  SUBDATASET_2_NAME=NETCDF:"test_full.nc":LU_INDEX
  SUBDATASET_2_DESC=[1x153x198] LU_INDEX (32-bit floating-point)

(more SUBDATASETs)

  SUBDATASET_106_NAME=NETCDF:"test_full.nc":LANDMASK
  SUBDATASET_106_DESC=[1x153x198] LANDMASK (32-bit floating-point)
  SUBDATASET_107_NAME=NETCDF:"test_full.nc":SST
  SUBDATASET_107_DESC=[1x153x198] SST (32-bit floating-point)
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0,  512.0)
Upper Right (  512.0,    0.0)
Lower Right (  512.0,  512.0)
Center      (  256.0,  256.0)

My first question is why am I getting the following warning?:

Warning 1: No UNIDATA NC_GLOBAL:Conventions attribute

Next, I see what appears is georeferencing info in the following lines:

  NC_GLOBAL#CEN_LAT=-8.4095154
  NC_GLOBAL#CEN_LON=115.02
  NC_GLOBAL#MAP_PROJ=3 (Mercator)
  NC_GLOBAL#MOAD_CEN_LAT=-8.4095078
  NC_GLOBAL#STAND_LON=115.02
  NC_GLOBAL#TRUELAT1=-8.4095001

but obviously this is not being interpreted or used.

Trying to use gdalwarp:

lees-mbp:full Lee$ gdalwarp NETCDF:test_full.nc:HGT test_full_HGT.tif
Warning 1: No UNIDATA NC_GLOBAL:Conventions attribute
ERROR 1: Unable to compute a transformation between pixel/line
and georeferenced coordinates for NETCDF:test_full.nc:HGT.
There is no affine transformation and no GCPs.

Can anyone explain what I need to do?

Thanks,
Lee
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131123/a7153c47/attachment.html>

From JPalmer at linz.govt.nz  Sat Nov 23 14:04:55 2013
From: JPalmer at linz.govt.nz (Jeremy Palmer)
Date: Sun, 24 Nov 2013 11:04:55 +1300
Subject: [gdal-dev] ECW lossless JPEG 2000 compression issue
In-Reply-To: <loom.20131123T214635-384@post.gmane.org>
References: <C6B695652D5E6B4597E90C5734C0242616D7A62CA3@prdlsmmsg01.ad.linz.govt.nz>,
	<loom.20131123T214635-384@post.gmane.org>
Message-ID: <C6B695652D5E6B4597E90C5734C0242616D7A62CA5@prdlsmmsg01.ad.linz.govt.nz>

Thanks Jukka.
________________________________________
From: gdal-dev-bounces at lists.osgeo.org [gdal-dev-bounces at lists.osgeo.org] On Behalf Of Jukka Rahkonen [jukka.rahkonen at mmmtike.fi]
Sent: Sunday, 24 November 2013 9:48 a.m.
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] ECW lossless JPEG 2000 compression issue

Jeremy Palmer <JPalmer <at> linz.govt.nz> writes:


>
> Has anyone else had issues when reading lossless JPEG 2000 files in the
3.3 SDK? Have I got all of the patches applied?

You are out of luck with 3.x SDK. You need SDK 4.2 or above, see
http://trac.osgeo.org/gdal/ticket/2805

-Jukka Rahkonen-

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

This message contains information, which is confidential and may be subject to legal privilege. If you are not the intended recipient, you must not peruse, use, disseminate, distribute or copy this message. If you have received this message in error, please notify us immediately (Phone 0800 665 463 or info at linz.govt.nz) and destroy the original message. LINZ accepts no responsibility for changes to this email, or for any attachments, after its transmission from LINZ. Thank You.

From etourigny.dev at gmail.com  Sun Nov 24 08:20:24 2013
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Sun, 24 Nov 2013 14:20:24 -0200
Subject: [gdal-dev] WRF NetCDF import
In-Reply-To: <CAHmmfARq2aWy3OsqFce+YDBCmANH9+y8zzTEB_JS7zdFQeMRSQ@mail.gmail.com>
References: <CAHmmfARq2aWy3OsqFce+YDBCmANH9+y8zzTEB_JS7zdFQeMRSQ@mail.gmail.com>
Message-ID: <CA+TxYvNvXLXuLEx99dm6uLZLqiFPr08itS6Gr4X6+6MYJs8zqQ@mail.gmail.com>

The "georeferencing info" you refer to is non-standard, and GDAL cannot use
that. It (and presumably the grass provider, although I don't know) use the
CF standard for encoding lat/lon information. what is the output of
gdalinfo NETCDF:test_full.nc:HGT

I don't know how the grass provider deals with subdatasets, but if you open
the file in qgis (using the gdal provider, it will sllow you to select the
subdataset you want).

You could also extract the variable with another tool like cdo or nco.

Etienne



On Sat, Nov 23, 2013 at 7:47 PM, Lee Eddington <lee.w.eddington at gmail.com>wrote:

> I'm trying to use r.in.gdal in GRASS GIS to import Weather Research &
> Forecasting (WRF) model NetCDF output.  There have been some tips provided
> by the GRASS users list, but none have worked for me.  I can import the
> data as a simple x,y array with no georeferencing, but information about
> georeferencing is in the file as other programs read, georeference and
> display the file correctly.
>
> gdalinfo produces the following:
>
> lees-mbp:full Lee$ gdalinfo test_full.nc
> Warning 1: No UNIDATA NC_GLOBAL:Conventions attribute
> Driver: netCDF/Network Common Data Format
> Files: test_full.nc
> Size is 512, 512
> Coordinate System is `'
> Metadata:
>   NC_GLOBAL#BL_PBL_PHYSICS=1
>   NC_GLOBAL#BOTTOM-TOP_GRID_DIMENSION=28
>   NC_GLOBAL#BOTTOM-TOP_PATCH_END_STAG=28
>   NC_GLOBAL#BOTTOM-TOP_PATCH_END_UNSTAG=27
>   NC_GLOBAL#BOTTOM-TOP_PATCH_START_STAG=1
>   NC_GLOBAL#BOTTOM-TOP_PATCH_START_UNSTAG=1
>   NC_GLOBAL#BUCKET_J=-1
>   NC_GLOBAL#BUCKET_MM=-1
>   NC_GLOBAL#CEN_LAT=-8.4095154
>   NC_GLOBAL#CEN_LON=115.02
>   NC_GLOBAL#CU_PHYSICS=0
>   NC_GLOBAL#DAMP_OPT=0
>   NC_GLOBAL#DAMPCOEF=0.2
>   NC_GLOBAL#DFI_OPT=0
>   NC_GLOBAL#DIFF_6TH_FACTOR=0.12
>   NC_GLOBAL#DIFF_6TH_OPT=0
>   NC_GLOBAL#DIFF_OPT=1
>   NC_GLOBAL#DT=16.666666
>   NC_GLOBAL#DX=3000
>   NC_GLOBAL#DY=3000
>   NC_GLOBAL#FEEDBACK=0
>   NC_GLOBAL#GFDDA_END_H=0
>   NC_GLOBAL#GFDDA_INTERVAL_M=0
>   NC_GLOBAL#GMT=12
>   NC_GLOBAL#GRID_FDDA=0
>   NC_GLOBAL#GRID_ID=3
>   NC_GLOBAL#GRID_SFDDA=0
>   NC_GLOBAL#GRIDTYPE=C
>   NC_GLOBAL#HYPSOMETRIC_OPT=2
>   NC_GLOBAL#I_PARENT_START=34
>   NC_GLOBAL#ISFTCFLX=0
>   NC_GLOBAL#ISHALLOW=0
>   NC_GLOBAL#ISICE=24
>   NC_GLOBAL#ISLAKE=-1
>   NC_GLOBAL#ISOILWATER=14
>   NC_GLOBAL#ISURBAN=1
>   NC_GLOBAL#ISWATER=16
>   NC_GLOBAL#J_PARENT_START=34
>   NC_GLOBAL#JULDAY=324
>   NC_GLOBAL#JULYR=2013
>   NC_GLOBAL#KHDIF=0
>   NC_GLOBAL#KM_OPT=4
>   NC_GLOBAL#KVDIF=0
>   NC_GLOBAL#MAP_PROJ=3
>   NC_GLOBAL#MFSHCONV=0
>   NC_GLOBAL#MMINLU=USGS
>   NC_GLOBAL#MOAD_CEN_LAT=-8.4095078
>   NC_GLOBAL#MOIST_ADV_OPT=1
>   NC_GLOBAL#MP_PHYSICS=3
>   NC_GLOBAL#NUM_LAND_CAT=24
>   NC_GLOBAL#OBS_NUDGE_OPT=0
>   NC_GLOBAL#OMLCALL=0
>   NC_GLOBAL#PARENT_GRID_RATIO=3
>   NC_GLOBAL#PARENT_ID=2
>   NC_GLOBAL#POLE_LAT=90
>   NC_GLOBAL#POLE_LON=0
>   NC_GLOBAL#PREC_ACC_DT=0
>   NC_GLOBAL#RA_LW_PHYSICS=1
>   NC_GLOBAL#RA_SW_PHYSICS=1
>   NC_GLOBAL#SCALAR_ADV_OPT=1
>   NC_GLOBAL#SF_SFCLAY_PHYSICS=1
>   NC_GLOBAL#SF_SURFACE_PHYSICS=2
>   NC_GLOBAL#SF_URBAN_PHYSICS=0
>   NC_GLOBAL#SGFDDA_END_H=0
>   NC_GLOBAL#SGFDDA_INTERVAL_M=0
>   NC_GLOBAL#SHCU_PHYSICS=0
>   NC_GLOBAL#SIMULATION_START_DATE=2013-11-20_12:00:00
>   NC_GLOBAL#SMOOTH_OPTION=0
>   NC_GLOBAL#SOUTH-NORTH_GRID_DIMENSION=154
>   NC_GLOBAL#SOUTH-NORTH_PATCH_END_STAG=154
>   NC_GLOBAL#SOUTH-NORTH_PATCH_END_UNSTAG=153
>   NC_GLOBAL#SOUTH-NORTH_PATCH_START_STAG=1
>   NC_GLOBAL#SOUTH-NORTH_PATCH_START_UNSTAG=1
>   NC_GLOBAL#SST_UPDATE=0
>   NC_GLOBAL#STAND_LON=115.02
>   NC_GLOBAL#START_DATE=2013-11-20_12:00:00
>   NC_GLOBAL#SURFACE_INPUT_SOURCE=1
>   NC_GLOBAL#SWRAD_SCAT=1
>   NC_GLOBAL#TITLE= OUTPUT FROM WRF V3.4 MODEL
>   NC_GLOBAL#TKE_ADV_OPT=1
>   NC_GLOBAL#TRUELAT1=-8.4095001
>   NC_GLOBAL#TRUELAT2=0
>   NC_GLOBAL#W_DAMPING=0
>   NC_GLOBAL#WEST-EAST_GRID_DIMENSION=199
>   NC_GLOBAL#WEST-EAST_PATCH_END_STAG=199
>   NC_GLOBAL#WEST-EAST_PATCH_END_UNSTAG=198
>   NC_GLOBAL#WEST-EAST_PATCH_START_STAG=1
>   NC_GLOBAL#WEST-EAST_PATCH_START_UNSTAG=1
> Subdatasets:
>   SUBDATASET_1_NAME=NETCDF:"test_full.nc":Times
>   SUBDATASET_1_DESC=[1x19] Times (8-bit character)
>   SUBDATASET_2_NAME=NETCDF:"test_full.nc":LU_INDEX
>   SUBDATASET_2_DESC=[1x153x198] LU_INDEX (32-bit floating-point)
>
> (more SUBDATASETs)
>
>   SUBDATASET_106_NAME=NETCDF:"test_full.nc":LANDMASK
>   SUBDATASET_106_DESC=[1x153x198] LANDMASK (32-bit floating-point)
>   SUBDATASET_107_NAME=NETCDF:"test_full.nc":SST
>   SUBDATASET_107_DESC=[1x153x198] SST (32-bit floating-point)
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0,  512.0)
> Upper Right (  512.0,    0.0)
> Lower Right (  512.0,  512.0)
> Center      (  256.0,  256.0)
>
> My first question is why am I getting the following warning?:
>
> Warning 1: No UNIDATA NC_GLOBAL:Conventions attribute
>
> Next, I see what appears is georeferencing info in the following lines:
>
>   NC_GLOBAL#CEN_LAT=-8.4095154
>   NC_GLOBAL#CEN_LON=115.02
>   NC_GLOBAL#MAP_PROJ=3 (Mercator)
>   NC_GLOBAL#MOAD_CEN_LAT=-8.4095078
>   NC_GLOBAL#STAND_LON=115.02
>   NC_GLOBAL#TRUELAT1=-8.4095001
>
> but obviously this is not being interpreted or used.
>
> Trying to use gdalwarp:
>
> lees-mbp:full Lee$ gdalwarp NETCDF:test_full.nc:HGT test_full_HGT.tif
> Warning 1: No UNIDATA NC_GLOBAL:Conventions attribute
> ERROR 1: Unable to compute a transformation between pixel/line
> and georeferenced coordinates for NETCDF:test_full.nc:HGT.
> There is no affine transformation and no GCPs.
>
> Can anyone explain what I need to do?
>
> Thanks,
> Lee
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131124/11a770c2/attachment-0001.html>

From lucia.rueda at ba.ieo.es  Mon Nov 25 00:16:22 2013
From: lucia.rueda at ba.ieo.es (Lucia Rueda Ramirez)
Date: Mon, 25 Nov 2013 09:16:22 +0100
Subject: [gdal-dev] reading hdf4 files in R
Message-ID: <0838E01493845742A4D4039EA34EB1C101621B18@ieopalma2.ba.ieo.es>

Hi,

 

I am trying to read hdf4 files in R. I have tried to install the gdal
package from http://trac.osgeo.org/gdal/wiki/DownloadSource
<http://trac.osgeo.org/gdal/wiki/DownloadSource>  but I get an error
message saying that the description file is missing (Error: Does not
appear to be an R package (no DESCRIPTION)).

 

I have also tried to load the hdf4 files using the modis library and the
code 

 

sds <- getSds("C:/mypath/T20011612001168.L3m_8D_CHL_chlor_a_4km.hdf") 

 

But I get the following errors:

 

'FWTools/OSGeo4W' installation not found or path not set.

If you don't have installed one of them you can get it from
'http://fwtools.maptools.org/' or 'http://trac.osgeo.org/osgeo4w/'

(recommanded)

Trying to autodetect path to 'FWTools/OSGeo4W' (this may takes some
time, you can interupt this process and set it manually, see 'gdalPath'
argument in '?MODISoptions':

 

Found 'FWTools' version: '1.7.0b2' to enalbe this run:

 MODISoptions(gdalPath='c:/Archivos de programa/FWTools2.4.7/bin') Found
'OSgeo4W' version: '1:' in 'c:/OSGeo4W/bin' but without HDF4
support...strange, try to remove and re-install 'OSgeo4W'!

Error in getSds("C:/Documents and Settings/lucia.rueda/Mis

documentos/MEDITS/tema_clorofila/T20011612001168.L3m_8D_CHL_chlor_a_4km.
hdf")

: 

  Method GDAL does not work. Is GDAL installed properly on your system?
Run:

'checkTools()' to check out which metods should work on your system!

 

I have already installed the FWTools/OSGeo4W from the recommended url
above though I got installation errors as well...

 

Anyone with the same problem?? Any help would be apreciated. I have gone
through most forums but can't figure out how to solve this.

 

Thanks a lot

 

Lucia

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131125/2d0a161c/attachment.html>

From Darren.Carman at astrium.eads.net  Mon Nov 25 02:42:23 2013
From: Darren.Carman at astrium.eads.net (CARMAN, Darren)
Date: Mon, 25 Nov 2013 10:42:23 -0000
Subject: [gdal-dev] Large shapefile issues
Message-ID: <BC6AE4846A9FD641B39A8A776CC90B6E0204D695@sv060.infoterra-global.com>

Hi List

 

I notice on the OGR formats page for ESRI Shapefile the following is
mentioned:

================

Size Issues

Geometry: The Shapefile format explicitly uses 32bit offsets and so
cannot go over 8GB (it actually uses 32bit offsets to 16bit words).
Hence, it is is not recommended to use a file size over 4GB.

Attributes: The dbf format does not have any offsets in it, so it can be
arbitrarily large.

================

 

Yet on the ESRI website:

================

Geometry limitations

There is a 2 GB size limit for any shapefile component file, which
translates to a maximum of roughly 70 million point features. The actual
number of line or polygon features you can store in a shapefile depends
on the number of vertices in each line or polygon (a vertex is
equivalent to a point).

================

 

I assume the OGR web page is wrong, or has a different meaning outside
of ESRI S/W use.

 

I notice that the PostGIS utility pgsql2shp stops processing with an
error once the dbf file goes over 2GB. Is there any way to get ogr2ogr
to do this?

 

Ideally, something I can't find a lot of information about online, is
there a way to get ogr2ogr to start writing to a new shapefile at a
certain processing point (number of objects or file size)?

 

Alternatively, assuming the OGR website text is correct for files it
creates, is there any utility that could be used to split the created
shapefile files into ones with a size less than 2GB?

 

Thanks in advance

Darren

 

 

 

 Darren Carman
Senior Software Engineer

GEO-Information Services

 

Astrium Services

Tel +44 (0)1252 362138

http://www.astrium-geo.com <http://www.infoterra.co.uk> 

 


Infoterra Ltd. Is part of the Astrium GEO-Information Services Division and a wholly owned subsidiary of Astrium, Europe's leading space systems and services specialist.

Disclaimer. The information contained in this e-mail and its attachments are confidential and intended only for the use of the named addressee(s). If you are not the intended addressee, please do not read, copy, use or disclose this message or its attachments. If you have received this message in error, please notify the sender immediately and delete or destroy all copies of this message and attachments in all media. Any views or opinions expressed are solely those of the author and do not necessarily represent those of Infoterra Ltd and shall not form part of any binding agreement.

Infoterra Limited a company registered in England under number 2359955 and having its registered office at Europa House, Southwood Crescent, Farnborough, GU14 0NL. VAT number GB 476 0468 27. 

P Before printing, think about the environment 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131125/4d5e8487/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 306 bytes
Desc: image001.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131125/4d5e8487/attachment.png>

From chaitanya.ch at gmail.com  Mon Nov 25 04:00:20 2013
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Mon, 25 Nov 2013 17:30:20 +0530
Subject: [gdal-dev] Large shapefile issues
In-Reply-To: <BC6AE4846A9FD641B39A8A776CC90B6E0204D695@sv060.infoterra-global.com>
References: <BC6AE4846A9FD641B39A8A776CC90B6E0204D695@sv060.infoterra-global.com>
Message-ID: <CAMKgpOZtSrh7bYA7jN9zWAYRshj_ETk06WnR_RTfkT8ixnChog@mail.gmail.com>

Darren,

These limitations are a result of the shapefile reader/writer
implementation. While the specification permits up to 8GB, the
implementation might not use it fully.

According to the specification a feature offset is stored as a 32-bit
integer to a 16-bit word. So, that's (2^32)*16 bits or (2^32)*2 bytes. To
fully utilize this, we need to use unsigned 32-bit integers and check for
overflows.
Originally, the shapelib library used by GDAL had the same limit as ESRI's.

If you are reaching the file size limits, I suggest you look into some
other file format to store your data. SQLite/SpatiaLite is a good option.

A hacky way to split the features across multiple shapefiles is to use the
-where option in ogr2ogr. You can filter based on the FID values.



On Mon, Nov 25, 2013 at 4:12 PM, CARMAN, Darren <
Darren.Carman at astrium.eads.net> wrote:

> Hi List
>
>
>
> I notice on the OGR formats page for ESRI Shapefile the following is
> mentioned:
>
> ================
>
> Size Issues
>
> Geometry: The Shapefile format explicitly uses 32bit offsets and so cannot
> go over 8GB (it actually uses 32bit offsets to 16bit words). Hence, it is
> is not recommended to use a file size over 4GB.
>
> Attributes: The dbf format does not have any offsets in it, so it can be
> arbitrarily large.
>
> ================
>
>
>
> Yet on the ESRI website:
>
> ================
>
> Geometry limitations
>
> There is a 2 GB size limit for any shapefile component file, which
> translates to a maximum of roughly 70 million point features. The actual
> number of line or polygon features you can store in a shapefile depends on
> the number of vertices in each line or polygon (a vertex is equivalent to a
> point).
>
> ================
>
>
>
> I assume the OGR web page is wrong, or has a different meaning outside of
> ESRI S/W use.
>
>
>
> I notice that the PostGIS utility pgsql2shp stops processing with an error
> once the dbf file goes over 2GB. Is there any way to get ogr2ogr to do this?
>
>
>
> Ideally, something I can?t find a lot of information about online, is
> there a way to get ogr2ogr to start writing to a new shapefile at a certain
> processing point (number of objects or file size)?
>
>
>
> Alternatively, assuming the OGR website text is correct for files it
> creates, is there any utility that could be used to split the created
> shapefile files into ones with a size less than 2GB?
>
>
>
> Thanks in advance
>
> Darren
>
>
>
>
>
>
>
> *Darren Carman*
> Senior Software Engineer
>
> GEO-Information Services
>
>
>
> *Astrium Services*
>
> Tel +44 (0)1252 362138
>
> http://www.astrium-geo.com <http://www.infoterra.co.uk>
>
>
>
>
>
> Infoterra Ltd. Is part of the Astrium GEO-Information Services Division
> and a wholly owned subsidiary of Astrium, Europe's leading space systems
> and services specialist.
>
> Disclaimer. The information contained in this e-mail and its attachments
> are confidential and intended only for the use of the named addressee(s).
> If you are not the intended addressee, please do not read, copy, use or
> disclose this message or its attachments. If you have received this message
> in error, please notify the sender immediately and delete or destroy all
> copies of this message and attachments in all media. Any views or opinions
> expressed are solely those of the author and do not necessarily represent
> those of Infoterra Ltd and shall not form part of any binding agreement.
>
> Infoterra Limited a company registered in England under number 2359955
> and having its registered office at Europa House, Southwood Crescent,
> Farnborough, GU14 0NL. VAT number GB 476 0468 27.
>
> P Before printing, think about the environment
>
>
>
>
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
Best regards,
Chaitanya kumar CH.

+91-9494447584
17.2416N 80.1426E
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131125/92e84b86/attachment-0001.html>

From etourigny.dev at gmail.com  Mon Nov 25 10:23:32 2013
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Mon, 25 Nov 2013 16:23:32 -0200
Subject: [gdal-dev] Fwd:  WRF NetCDF import
In-Reply-To: <CAJx2nokEViqKsqK4AmUmar+L=z4_MurQseB7CeyDJrGqM6ZoHA@mail.gmail.com>
References: <CAHmmfARq2aWy3OsqFce+YDBCmANH9+y8zzTEB_JS7zdFQeMRSQ@mail.gmail.com>
	<CA+TxYvNvXLXuLEx99dm6uLZLqiFPr08itS6Gr4X6+6MYJs8zqQ@mail.gmail.com>
	<CAJx2nokEViqKsqK4AmUmar+L=z4_MurQseB7CeyDJrGqM6ZoHA@mail.gmail.com>
Message-ID: <CA+TxYvOYgVymSTUYtWnLrW-0bz7-khhMnv3g=60J=p23a1BFgg@mail.gmail.com>

Forwarding to the list and others...

---------- Forwarded message ----------
From: Roger Veciana i Rovira <rveciana at gmail.com>
Date: Mon, Nov 25, 2013 at 9:35 AM
Subject: Re: [gdal-dev] WRF NetCDF import
To: Etienne Tourigny <etourigny.dev at gmail.com>


As Etienne told you, the geotransform and projection from your files is not
in the format that GDAL can understand.
I wrote a script that reads the projection and calculates the geotransform
to save it in a GeoTIFF file:

http://geoexamples.blogspot.com.es/2013/09/reading-wrf-netcdf-files-with-gdal.html

The script also interpolates the WRF sigma levels to the desired pressure
level, so you will have to look for the functions that you need.

Anyway, the solution is quite complicated, and using cdo, nco or other
tools (I use ARWPost) may be easier.

Roger


2013/11/24 Etienne Tourigny <etourigny.dev at gmail.com>

> The "georeferencing info" you refer to is non-standard, and GDAL cannot
> use that. It (and presumably the grass provider, although I don't know) use
> the CF standard for encoding lat/lon information. what is the output of
> gdalinfo NETCDF:test_full.nc:HGT
>
> I don't know how the grass provider deals with subdatasets, but if you
> open the file in qgis (using the gdal provider, it will sllow you to select
> the subdataset you want).
>
> You could also extract the variable with another tool like cdo or nco.
>
> Etienne
>
>
>
> On Sat, Nov 23, 2013 at 7:47 PM, Lee Eddington <lee.w.eddington at gmail.com>wrote:
>
>> I'm trying to use r.in.gdal in GRASS GIS to import Weather Research &
>> Forecasting (WRF) model NetCDF output.  There have been some tips provided
>> by the GRASS users list, but none have worked for me.  I can import the
>> data as a simple x,y array with no georeferencing, but information about
>> georeferencing is in the file as other programs read, georeference and
>> display the file correctly.
>>
>> gdalinfo produces the following:
>>
>> lees-mbp:full Lee$ gdalinfo test_full.nc
>> Warning 1: No UNIDATA NC_GLOBAL:Conventions attribute
>>  Driver: netCDF/Network Common Data Format
>> Files: test_full.nc
>> Size is 512, 512
>> Coordinate System is `'
>> Metadata:
>>   NC_GLOBAL#BL_PBL_PHYSICS=1
>>   NC_GLOBAL#BOTTOM-TOP_GRID_DIMENSION=28
>>   NC_GLOBAL#BOTTOM-TOP_PATCH_END_STAG=28
>>   NC_GLOBAL#BOTTOM-TOP_PATCH_END_UNSTAG=27
>>   NC_GLOBAL#BOTTOM-TOP_PATCH_START_STAG=1
>>   NC_GLOBAL#BOTTOM-TOP_PATCH_START_UNSTAG=1
>>   NC_GLOBAL#BUCKET_J=-1
>>   NC_GLOBAL#BUCKET_MM=-1
>>   NC_GLOBAL#CEN_LAT=-8.4095154
>>   NC_GLOBAL#CEN_LON=115.02
>>   NC_GLOBAL#CU_PHYSICS=0
>>   NC_GLOBAL#DAMP_OPT=0
>>   NC_GLOBAL#DAMPCOEF=0.2
>>   NC_GLOBAL#DFI_OPT=0
>>   NC_GLOBAL#DIFF_6TH_FACTOR=0.12
>>   NC_GLOBAL#DIFF_6TH_OPT=0
>>   NC_GLOBAL#DIFF_OPT=1
>>   NC_GLOBAL#DT=16.666666
>>   NC_GLOBAL#DX=3000
>>   NC_GLOBAL#DY=3000
>>   NC_GLOBAL#FEEDBACK=0
>>   NC_GLOBAL#GFDDA_END_H=0
>>   NC_GLOBAL#GFDDA_INTERVAL_M=0
>>   NC_GLOBAL#GMT=12
>>   NC_GLOBAL#GRID_FDDA=0
>>   NC_GLOBAL#GRID_ID=3
>>   NC_GLOBAL#GRID_SFDDA=0
>>   NC_GLOBAL#GRIDTYPE=C
>>   NC_GLOBAL#HYPSOMETRIC_OPT=2
>>   NC_GLOBAL#I_PARENT_START=34
>>   NC_GLOBAL#ISFTCFLX=0
>>   NC_GLOBAL#ISHALLOW=0
>>   NC_GLOBAL#ISICE=24
>>   NC_GLOBAL#ISLAKE=-1
>>   NC_GLOBAL#ISOILWATER=14
>>   NC_GLOBAL#ISURBAN=1
>>   NC_GLOBAL#ISWATER=16
>>   NC_GLOBAL#J_PARENT_START=34
>>   NC_GLOBAL#JULDAY=324
>>   NC_GLOBAL#JULYR=2013
>>   NC_GLOBAL#KHDIF=0
>>   NC_GLOBAL#KM_OPT=4
>>   NC_GLOBAL#KVDIF=0
>>   NC_GLOBAL#MAP_PROJ=3
>>   NC_GLOBAL#MFSHCONV=0
>>   NC_GLOBAL#MMINLU=USGS
>>   NC_GLOBAL#MOAD_CEN_LAT=-8.4095078
>>   NC_GLOBAL#MOIST_ADV_OPT=1
>>   NC_GLOBAL#MP_PHYSICS=3
>>   NC_GLOBAL#NUM_LAND_CAT=24
>>   NC_GLOBAL#OBS_NUDGE_OPT=0
>>   NC_GLOBAL#OMLCALL=0
>>   NC_GLOBAL#PARENT_GRID_RATIO=3
>>   NC_GLOBAL#PARENT_ID=2
>>   NC_GLOBAL#POLE_LAT=90
>>   NC_GLOBAL#POLE_LON=0
>>   NC_GLOBAL#PREC_ACC_DT=0
>>   NC_GLOBAL#RA_LW_PHYSICS=1
>>   NC_GLOBAL#RA_SW_PHYSICS=1
>>   NC_GLOBAL#SCALAR_ADV_OPT=1
>>   NC_GLOBAL#SF_SFCLAY_PHYSICS=1
>>   NC_GLOBAL#SF_SURFACE_PHYSICS=2
>>   NC_GLOBAL#SF_URBAN_PHYSICS=0
>>   NC_GLOBAL#SGFDDA_END_H=0
>>   NC_GLOBAL#SGFDDA_INTERVAL_M=0
>>   NC_GLOBAL#SHCU_PHYSICS=0
>>   NC_GLOBAL#SIMULATION_START_DATE=2013-11-20_12:00:00
>>   NC_GLOBAL#SMOOTH_OPTION=0
>>   NC_GLOBAL#SOUTH-NORTH_GRID_DIMENSION=154
>>   NC_GLOBAL#SOUTH-NORTH_PATCH_END_STAG=154
>>   NC_GLOBAL#SOUTH-NORTH_PATCH_END_UNSTAG=153
>>   NC_GLOBAL#SOUTH-NORTH_PATCH_START_STAG=1
>>   NC_GLOBAL#SOUTH-NORTH_PATCH_START_UNSTAG=1
>>   NC_GLOBAL#SST_UPDATE=0
>>   NC_GLOBAL#STAND_LON=115.02
>>   NC_GLOBAL#START_DATE=2013-11-20_12:00:00
>>   NC_GLOBAL#SURFACE_INPUT_SOURCE=1
>>   NC_GLOBAL#SWRAD_SCAT=1
>>   NC_GLOBAL#TITLE= OUTPUT FROM WRF V3.4 MODEL
>>   NC_GLOBAL#TKE_ADV_OPT=1
>>   NC_GLOBAL#TRUELAT1=-8.4095001
>>   NC_GLOBAL#TRUELAT2=0
>>   NC_GLOBAL#W_DAMPING=0
>>   NC_GLOBAL#WEST-EAST_GRID_DIMENSION=199
>>   NC_GLOBAL#WEST-EAST_PATCH_END_STAG=199
>>   NC_GLOBAL#WEST-EAST_PATCH_END_UNSTAG=198
>>   NC_GLOBAL#WEST-EAST_PATCH_START_STAG=1
>>   NC_GLOBAL#WEST-EAST_PATCH_START_UNSTAG=1
>> Subdatasets:
>>   SUBDATASET_1_NAME=NETCDF:"test_full.nc":Times
>>   SUBDATASET_1_DESC=[1x19] Times (8-bit character)
>>   SUBDATASET_2_NAME=NETCDF:"test_full.nc":LU_INDEX
>>   SUBDATASET_2_DESC=[1x153x198] LU_INDEX (32-bit floating-point)
>>
>> (more SUBDATASETs)
>>
>>   SUBDATASET_106_NAME=NETCDF:"test_full.nc":LANDMASK
>>   SUBDATASET_106_DESC=[1x153x198] LANDMASK (32-bit floating-point)
>>   SUBDATASET_107_NAME=NETCDF:"test_full.nc":SST
>>   SUBDATASET_107_DESC=[1x153x198] SST (32-bit floating-point)
>> Corner Coordinates:
>> Upper Left  (    0.0,    0.0)
>> Lower Left  (    0.0,  512.0)
>> Upper Right (  512.0,    0.0)
>> Lower Right (  512.0,  512.0)
>> Center      (  256.0,  256.0)
>>
>> My first question is why am I getting the following warning?:
>>
>> Warning 1: No UNIDATA NC_GLOBAL:Conventions attribute
>>
>> Next, I see what appears is georeferencing info in the following lines:
>>
>>   NC_GLOBAL#CEN_LAT=-8.4095154
>>   NC_GLOBAL#CEN_LON=115.02
>>   NC_GLOBAL#MAP_PROJ=3 (Mercator)
>>   NC_GLOBAL#MOAD_CEN_LAT=-8.4095078
>>    NC_GLOBAL#STAND_LON=115.02
>>   NC_GLOBAL#TRUELAT1=-8.4095001
>>
>> but obviously this is not being interpreted or used.
>>
>> Trying to use gdalwarp:
>>
>> lees-mbp:full Lee$ gdalwarp NETCDF:test_full.nc:HGT test_full_HGT.tif
>> Warning 1: No UNIDATA NC_GLOBAL:Conventions attribute
>> ERROR 1: Unable to compute a transformation between pixel/line
>> and georeferenced coordinates for NETCDF:test_full.nc:HGT.
>> There is no affine transformation and no GCPs.
>>
>> Can anyone explain what I need to do?
>>
>> Thanks,
>> Lee
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131125/baa10d88/attachment.html>

From etourigny.dev at gmail.com  Mon Nov 25 10:25:18 2013
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Mon, 25 Nov 2013 16:25:18 -0200
Subject: [gdal-dev] reading hdf4 files in R
In-Reply-To: <0838E01493845742A4D4039EA34EB1C101621B18@ieopalma2.ba.ieo.es>
References: <0838E01493845742A4D4039EA34EB1C101621B18@ieopalma2.ba.ieo.es>
Message-ID: <CA+TxYvP5GUpgGrjYjtYeALNxsN+vqy2suOdQqHvrchZ2=m7Auw@mail.gmail.com>

fwtool is really old so you should not use it and uninstall it.

You may want to use the R package Rgdal, but I have not used iit under
windows.

http://cran.r-project.org/web/packages/rgdal/index.html


On Mon, Nov 25, 2013 at 6:16 AM, Lucia Rueda Ramirez
<lucia.rueda at ba.ieo.es>wrote:

>  Hi,
>
>
>
> I am trying to read hdf4 files in R. I have tried to install the gdal
> package from http://trac.osgeo.org/gdal/wiki/DownloadSource but I get an
> error message saying that the description file is missing (Error: Does not
> appear to be an R package (no DESCRIPTION)).
>
>
>
> I have also tried to load the hdf4 files using the modis library and the
> code
>
>
>
> sds <- getSds("C:/mypath/T20011612001168.L3m_8D_CHL_chlor_a_4km.hdf")
>
>
>
> But I get the following errors:
>
>
>
> 'FWTools/OSGeo4W' installation not found or path not set.
>
> If you don't have installed one of them you can get it from '
> http://fwtools.maptools.org/' or 'http://trac.osgeo.org/osgeo4w/'
>
> (recommanded)
>
> Trying to autodetect path to 'FWTools/OSGeo4W' (this may takes some time,
> you can interupt this process and set it manually, see 'gdalPath' argument
> in '?MODISoptions':
>
>
>
> Found 'FWTools' version: '1.7.0b2' to enalbe this run:
>
>  MODISoptions(gdalPath='c:/Archivos de programa/FWTools2.4.7/bin') Found
> 'OSgeo4W' version: '1:' in 'c:/OSGeo4W/bin' but without HDF4
> support...strange, try to remove and re-install 'OSgeo4W'!
>
> Error in getSds("C:/Documents and Settings/lucia.rueda/Mis
>
>
> documentos/MEDITS/tema_clorofila/T20011612001168.L3m_8D_CHL_chlor_a_4km.hdf")
>
> :
>
>   Method GDAL does not work. Is GDAL installed properly on your system?
> Run:
>
> 'checkTools()' to check out which metods should work on your system!
>
>
>
> I have already installed the FWTools/OSGeo4W from the recommended url
> above though I got installation errors as well...
>
>
>
> Anyone with the same problem?? Any help would be apreciated. I have gone
> through most forums but can't figure out how to solve this.
>
>
>
> Thanks a lot
>
>
>
> Lucia
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131125/1ff2cfac/attachment.html>

From skunkmyrddyn at gmail.com  Mon Nov 25 13:29:00 2013
From: skunkmyrddyn at gmail.com (Simon Shak)
Date: Mon, 25 Nov 2013 22:29:00 +0100
Subject: [gdal-dev] Nodata and compression artifacts
Message-ID: <CAJuTQSGs23=fbvNteE5P8mHsQrmTi-K7EHyMzi2zgYqkkyXY=A@mail.gmail.com>

I?m working with gdalwarp to reprocess a large amount of imagery to be
compatible with another program that requires imagery to be in WGS84.  The
input imagery is compressed in MrSID format and does not include an
internal mask for nodata.  I don?t know if this is because the creator of
the imagery overlooked it, or if the format doesn?t support a mask.  Either
way, when I attempt to merge neighboring sets, I get odd bands of dark
color.  I?ve looked closely, and it is evident because at the edge of the
images are non 100% black pixels, that though I?m sending ?srcnodata 0 into
gdalwarp, they get read as pixels and progress through.  I?ve looked into
using the nearblack command on the files first, but the compression ratio
of the .SID files makes it such that the files don?t easily fit into my
hard drive array for pre-nearblacking them before processing, plus the
physical size of some of these files are large enough that the nearblack
takes a long time to run.  Without the nearblack step, my multithreaded
control script can process one chunk in a day, but adding the nearblack,
and it increases to a week at least.



I?m looking for a solution that would not require making a large interim
uncompressed version and would hopefully not incur a lengthy additional
process.



The simpler thoughts I have would be to adjust gdalwarp?s ?srcnodata to
take a range option, much like nearblack, so that if it detects a pixel
(even in the middle) that is with the range specified would get ignored, or
a way to include an ancillary file that could contain a mask.  Either would
work for me, I have potential ways to quickly generate a mask for the input
files.  I?d think the mask could work much like .TIF can have a .TFW, that
a .MSK could be detected as well.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131125/c141d385/attachment.html>

From even.rouault at mines-paris.org  Mon Nov 25 13:33:16 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 25 Nov 2013 22:33:16 +0100
Subject: [gdal-dev] Nodata and compression artifacts
In-Reply-To: <CAJuTQSGs23=fbvNteE5P8mHsQrmTi-K7EHyMzi2zgYqkkyXY=A@mail.gmail.com>
References: <CAJuTQSGs23=fbvNteE5P8mHsQrmTi-K7EHyMzi2zgYqkkyXY=A@mail.gmail.com>
Message-ID: <201311252233.16874.even.rouault@mines-paris.org>

Le lundi 25 novembre 2013 22:29:00, Simon Shak a ?crit :
> I?m working with gdalwarp to reprocess a large amount of imagery to be
> compatible with another program that requires imagery to be in WGS84.  The
> input imagery is compressed in MrSID format and does not include an
> internal mask for nodata.  I don?t know if this is because the creator of
> the imagery overlooked it, or if the format doesn?t support a mask.  Either
> way, when I attempt to merge neighboring sets, I get odd bands of dark
> color.  I?ve looked closely, and it is evident because at the edge of the
> images are non 100% black pixels, that though I?m sending ?srcnodata 0 into
> gdalwarp, they get read as pixels and progress through.  I?ve looked into
> using the nearblack command on the files first, but the compression ratio
> of the .SID files makes it such that the files don?t easily fit into my
> hard drive array for pre-nearblacking them before processing, plus the
> physical size of some of these files are large enough that the nearblack
> takes a long time to run.  Without the nearblack step, my multithreaded
> control script can process one chunk in a day, but adding the nearblack,
> and it increases to a week at least.
> 
> 
> 
> I?m looking for a solution that would not require making a large interim
> uncompressed version and would hopefully not incur a lengthy additional
> process.
> 
> 
> 
> The simpler thoughts I have would be to adjust gdalwarp?s ?srcnodata to
> take a range option, much like nearblack, so that if it detects a pixel
> (even in the middle) that is with the range specified would get ignored, or
> a way to include an ancillary file that could contain a mask.  Either would
> work for me, I have potential ways to quickly generate a mask for the input
> files.  I?d think the mask could work much like .TIF can have a .TFW, that
> a .MSK could be detected as well.

You can use the -cutline option of gdalwarp if you have the mask as a shapefile 
or another OGR datasource.
You could also use a VRT file to combine the MrSID imagery and add another band 
from TIF for example as the alpha/mask band.


-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From skunkmyrddyn at gmail.com  Mon Nov 25 13:37:57 2013
From: skunkmyrddyn at gmail.com (Simon Shak)
Date: Mon, 25 Nov 2013 22:37:57 +0100
Subject: [gdal-dev] Nodata and compression artifacts
In-Reply-To: <201311252233.16874.even.rouault@mines-paris.org>
References: <CAJuTQSGs23=fbvNteE5P8mHsQrmTi-K7EHyMzi2zgYqkkyXY=A@mail.gmail.com>
	<201311252233.16874.even.rouault@mines-paris.org>
Message-ID: <CAJuTQSGgyNdMzj1GqMSFwGkG0o2H+D84g1-DzPfk9Jc+YS_pxA@mail.gmail.com>

I will look into the vet file. I often have multiple input files and didn't
see a way to use the cutline option with multiple input cutline.
On Nov 25, 2013 3:33 PM, "Even Rouault" <even.rouault at mines-paris.org>
wrote:

> Le lundi 25 novembre 2013 22:29:00, Simon Shak a ?crit :
> > I?m working with gdalwarp to reprocess a large amount of imagery to be
> > compatible with another program that requires imagery to be in WGS84.
>  The
> > input imagery is compressed in MrSID format and does not include an
> > internal mask for nodata.  I don?t know if this is because the creator of
> > the imagery overlooked it, or if the format doesn?t support a mask.
>  Either
> > way, when I attempt to merge neighboring sets, I get odd bands of dark
> > color.  I?ve looked closely, and it is evident because at the edge of the
> > images are non 100% black pixels, that though I?m sending ?srcnodata 0
> into
> > gdalwarp, they get read as pixels and progress through.  I?ve looked into
> > using the nearblack command on the files first, but the compression ratio
> > of the .SID files makes it such that the files don?t easily fit into my
> > hard drive array for pre-nearblacking them before processing, plus the
> > physical size of some of these files are large enough that the nearblack
> > takes a long time to run.  Without the nearblack step, my multithreaded
> > control script can process one chunk in a day, but adding the nearblack,
> > and it increases to a week at least.
> >
> >
> >
> > I?m looking for a solution that would not require making a large interim
> > uncompressed version and would hopefully not incur a lengthy additional
> > process.
> >
> >
> >
> > The simpler thoughts I have would be to adjust gdalwarp?s ?srcnodata to
> > take a range option, much like nearblack, so that if it detects a pixel
> > (even in the middle) that is with the range specified would get ignored,
> or
> > a way to include an ancillary file that could contain a mask.  Either
> would
> > work for me, I have potential ways to quickly generate a mask for the
> input
> > files.  I?d think the mask could work much like .TIF can have a .TFW,
> that
> > a .MSK could be detected as well.
>
> You can use the -cutline option of gdalwarp if you have the mask as a
> shapefile
> or another OGR datasource.
> You could also use a VRT file to combine the MrSID imagery and add another
> band
> from TIF for example as the alpha/mask band.
>
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131125/ec606982/attachment.html>

From osgeo at gzmarketing.com  Mon Nov 25 13:38:45 2013
From: osgeo at gzmarketing.com (Metzen)
Date: Mon, 25 Nov 2013 13:38:45 -0800 (PST)
Subject: [gdal-dev] Slice Large GeoTiff into 1 Degree Tiles
Message-ID: <1385415525066-5091122.post@n6.nabble.com>

I have a bunch of large GeoTiff files (1.4GB, 4 latitude degrees x 8
longitude degrees).

I need to slice each one up into 1 degree lat x 1 degree long tiles (with
just a little bit of overage in each).

Here is the gdalinfo output for one of the GeoTiff files:

Driver: GTiff/GeoTIFF
Files: index.tif
Size is 38401, 19201
Coordinate System is:
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563,
            AUTHORITY["EPSG","7030"]],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0],
    UNIT["degree",0.0174532925199433],
    AUTHORITY["EPSG","4326"]]
Origin = (-112.000104166666674,56.000104166666667)
Pixel Size = (0.000208333333333,-0.000208333333333)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (-112.0001042,  56.0001042) (112d 0' 0.38"W, 56d 0' 0.37"N)
Lower Left  (-112.0001042,  51.9998958) (112d 0' 0.38"W, 51d59'59.62"N)
Upper Right (-103.9998958,  56.0001042) (103d59'59.62"W, 56d 0' 0.37"N)
Lower Right (-103.9998958,  51.9998958) (103d59'59.62"W, 51d59'59.62"N)
Center      (-108.0000000,  54.0000000) (108d 0' 0.00"W, 54d 0' 0.00"N)
Band 1 Block=38401x1 Type=Int16, ColorInterp=Gray
  NoData Value=-32767

I want everything to be the same except the size. So each one needs to be
sliced into 32 tiles, each 1 degree x 1 degree.

For instance one would cover:
-112.0001042, 56.0001042 to -110.9998958, 54.9998958 (essentially -112, 56
to -111, 55).

I see utilities like gdal_retile.py and gdal_grid, but I'm not making
progress.

Is there a gdal tool that can do what I need?   If so, which one(s), and can
you share an example command?




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Slice-Large-GeoTiff-into-1-Degree-Tiles-tp5091122.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at mines-paris.org  Mon Nov 25 13:44:48 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 25 Nov 2013 22:44:48 +0100
Subject: [gdal-dev] Nodata and compression artifacts
In-Reply-To: <CAJuTQSGgyNdMzj1GqMSFwGkG0o2H+D84g1-DzPfk9Jc+YS_pxA@mail.gmail.com>
References: <CAJuTQSGs23=fbvNteE5P8mHsQrmTi-K7EHyMzi2zgYqkkyXY=A@mail.gmail.com>
	<201311252233.16874.even.rouault@mines-paris.org>
	<CAJuTQSGgyNdMzj1GqMSFwGkG0o2H+D84g1-DzPfk9Jc+YS_pxA@mail.gmail.com>
Message-ID: <201311252244.48424.even.rouault@mines-paris.org>


> I often have multiple input files and didn't
> see a way to use the cutline option with multiple input cutline.

You can try merging them into a single OGR layer (with ogr2ogr for example)

> On Nov 25, 2013 3:33 PM, "Even Rouault" <even.rouault at mines-paris.org>
> 
> wrote:
> > Le lundi 25 novembre 2013 22:29:00, Simon Shak a ?crit :
> > > I?m working with gdalwarp to reprocess a large amount of imagery to be
> > > compatible with another program that requires imagery to be in WGS84.
> >  
> >  The
> >  
> > > input imagery is compressed in MrSID format and does not include an
> > > internal mask for nodata.  I don?t know if this is because the creator
> > > of the imagery overlooked it, or if the format doesn?t support a mask.
> >  
> >  Either
> >  
> > > way, when I attempt to merge neighboring sets, I get odd bands of dark
> > > color.  I?ve looked closely, and it is evident because at the edge of
> > > the images are non 100% black pixels, that though I?m sending
> > > ?srcnodata 0
> > 
> > into
> > 
> > > gdalwarp, they get read as pixels and progress through.  I?ve looked
> > > into using the nearblack command on the files first, but the
> > > compression ratio of the .SID files makes it such that the files don?t
> > > easily fit into my hard drive array for pre-nearblacking them before
> > > processing, plus the physical size of some of these files are large
> > > enough that the nearblack takes a long time to run.  Without the
> > > nearblack step, my multithreaded control script can process one chunk
> > > in a day, but adding the nearblack, and it increases to a week at
> > > least.
> > > 
> > > 
> > > 
> > > I?m looking for a solution that would not require making a large
> > > interim uncompressed version and would hopefully not incur a lengthy
> > > additional process.
> > > 
> > > 
> > > 
> > > The simpler thoughts I have would be to adjust gdalwarp?s ?srcnodata to
> > > take a range option, much like nearblack, so that if it detects a pixel
> > > (even in the middle) that is with the range specified would get
> > > ignored,
> > 
> > or
> > 
> > > a way to include an ancillary file that could contain a mask.  Either
> > 
> > would
> > 
> > > work for me, I have potential ways to quickly generate a mask for the
> > 
> > input
> > 
> > > files.  I?d think the mask could work much like .TIF can have a .TFW,
> > 
> > that
> > 
> > > a .MSK could be detected as well.
> > 
> > You can use the -cutline option of gdalwarp if you have the mask as a
> > shapefile
> > or another OGR datasource.
> > You could also use a VRT file to combine the MrSID imagery and add
> > another band
> > from TIF for example as the alpha/mask band.
> > 
> > 
> > --
> > Geospatial professional services
> > http://even.rouault.free.fr/services.html

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Mon Nov 25 13:47:01 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 25 Nov 2013 22:47:01 +0100
Subject: [gdal-dev] Slice Large GeoTiff into 1 Degree Tiles
In-Reply-To: <1385415525066-5091122.post@n6.nabble.com>
References: <1385415525066-5091122.post@n6.nabble.com>
Message-ID: <201311252247.01917.even.rouault@mines-paris.org>

Le lundi 25 novembre 2013 22:38:45, Metzen a ?crit :
> I have a bunch of large GeoTiff files (1.4GB, 4 latitude degrees x 8
> longitude degrees).
> 
> I need to slice each one up into 1 degree lat x 1 degree long tiles (with
> just a little bit of overage in each).
> 
> Here is the gdalinfo output for one of the GeoTiff files:
> 
> Driver: GTiff/GeoTIFF
> Files: index.tif
> Size is 38401, 19201
> Coordinate System is:
> GEOGCS["WGS 84",
>     DATUM["WGS_1984",
>         SPHEROID["WGS 84",6378137,298.257223563,
>             AUTHORITY["EPSG","7030"]],
>         AUTHORITY["EPSG","6326"]],
>     PRIMEM["Greenwich",0],
>     UNIT["degree",0.0174532925199433],
>     AUTHORITY["EPSG","4326"]]
> Origin = (-112.000104166666674,56.000104166666667)
> Pixel Size = (0.000208333333333,-0.000208333333333)
> Metadata:
>   AREA_OR_POINT=Area
> Image Structure Metadata:
>   INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  (-112.0001042,  56.0001042) (112d 0' 0.38"W, 56d 0' 0.37"N)
> Lower Left  (-112.0001042,  51.9998958) (112d 0' 0.38"W, 51d59'59.62"N)
> Upper Right (-103.9998958,  56.0001042) (103d59'59.62"W, 56d 0' 0.37"N)
> Lower Right (-103.9998958,  51.9998958) (103d59'59.62"W, 51d59'59.62"N)
> Center      (-108.0000000,  54.0000000) (108d 0' 0.00"W, 54d 0' 0.00"N)
> Band 1 Block=38401x1 Type=Int16, ColorInterp=Gray
>   NoData Value=-32767
> 
> I want everything to be the same except the size. So each one needs to be
> sliced into 32 tiles, each 1 degree x 1 degree.
> 
> For instance one would cover:
> -112.0001042, 56.0001042 to -110.9998958, 54.9998958 (essentially -112, 56
> to -111, 55).
> 
> I see utilities like gdal_retile.py and gdal_grid, but I'm not making
> progress.
> 
> Is there a gdal tool that can do what I need?   If so, which one(s), and
> can you share an example command?

gdal_translate with the -projwin option and a small loop written in your 
preferred scription language should do it.

> 
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/Slice-Large-GeoTiff-into-1-Degree-Tile
> s-tp5091122.html Sent from the GDAL - Dev mailing list archive at
> Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From skunkmyrddyn at gmail.com  Mon Nov 25 13:48:14 2013
From: skunkmyrddyn at gmail.com (Simon Shak)
Date: Mon, 25 Nov 2013 22:48:14 +0100
Subject: [gdal-dev] Nodata and compression artifacts
In-Reply-To: <201311252244.48424.even.rouault@mines-paris.org>
References: <CAJuTQSGs23=fbvNteE5P8mHsQrmTi-K7EHyMzi2zgYqkkyXY=A@mail.gmail.com>
	<201311252233.16874.even.rouault@mines-paris.org>
	<CAJuTQSGgyNdMzj1GqMSFwGkG0o2H+D84g1-DzPfk9Jc+YS_pxA@mail.gmail.com>
	<201311252244.48424.even.rouault@mines-paris.org>
Message-ID: <CAJuTQSE9OM1tUspWQz8dasnCPnsHHzfYugOdGtj+BpU3EBQzOw@mail.gmail.com>

Sorry my phone botched the reply. Meant to say having something like having
9 input files into gdalwarp and needing a cutline for each input to mask
their individual Nodata.
On Nov 25, 2013 3:44 PM, "Even Rouault" <even.rouault at mines-paris.org>
wrote:

>
> > I often have multiple input files and didn't
> > see a way to use the cutline option with multiple input cutline.
>
> You can try merging them into a single OGR layer (with ogr2ogr for example)
>
> > On Nov 25, 2013 3:33 PM, "Even Rouault" <even.rouault at mines-paris.org>
> >
> > wrote:
> > > Le lundi 25 novembre 2013 22:29:00, Simon Shak a ?crit :
> > > > I?m working with gdalwarp to reprocess a large amount of imagery to
> be
> > > > compatible with another program that requires imagery to be in WGS84.
> > >
> > >  The
> > >
> > > > input imagery is compressed in MrSID format and does not include an
> > > > internal mask for nodata.  I don?t know if this is because the
> creator
> > > > of the imagery overlooked it, or if the format doesn?t support a
> mask.
> > >
> > >  Either
> > >
> > > > way, when I attempt to merge neighboring sets, I get odd bands of
> dark
> > > > color.  I?ve looked closely, and it is evident because at the edge of
> > > > the images are non 100% black pixels, that though I?m sending
> > > > ?srcnodata 0
> > >
> > > into
> > >
> > > > gdalwarp, they get read as pixels and progress through.  I?ve looked
> > > > into using the nearblack command on the files first, but the
> > > > compression ratio of the .SID files makes it such that the files
> don?t
> > > > easily fit into my hard drive array for pre-nearblacking them before
> > > > processing, plus the physical size of some of these files are large
> > > > enough that the nearblack takes a long time to run.  Without the
> > > > nearblack step, my multithreaded control script can process one chunk
> > > > in a day, but adding the nearblack, and it increases to a week at
> > > > least.
> > > >
> > > >
> > > >
> > > > I?m looking for a solution that would not require making a large
> > > > interim uncompressed version and would hopefully not incur a lengthy
> > > > additional process.
> > > >
> > > >
> > > >
> > > > The simpler thoughts I have would be to adjust gdalwarp?s ?srcnodata
> to
> > > > take a range option, much like nearblack, so that if it detects a
> pixel
> > > > (even in the middle) that is with the range specified would get
> > > > ignored,
> > >
> > > or
> > >
> > > > a way to include an ancillary file that could contain a mask.  Either
> > >
> > > would
> > >
> > > > work for me, I have potential ways to quickly generate a mask for the
> > >
> > > input
> > >
> > > > files.  I?d think the mask could work much like .TIF can have a .TFW,
> > >
> > > that
> > >
> > > > a .MSK could be detected as well.
> > >
> > > You can use the -cutline option of gdalwarp if you have the mask as a
> > > shapefile
> > > or another OGR datasource.
> > > You could also use a VRT file to combine the MrSID imagery and add
> > > another band
> > > from TIF for example as the alpha/mask band.
> > >
> > >
> > > --
> > > Geospatial professional services
> > > http://even.rouault.free.fr/services.html
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131125/3d9daeae/attachment.html>

From osgeo at gzmarketing.com  Mon Nov 25 13:55:18 2013
From: osgeo at gzmarketing.com (Metzen)
Date: Mon, 25 Nov 2013 13:55:18 -0800 (PST)
Subject: [gdal-dev] Slice Large GeoTiff into 1 Degree Tiles
In-Reply-To: <201311252247.01917.even.rouault@mines-paris.org>
References: <1385415525066-5091122.post@n6.nabble.com>
	<201311252247.01917.even.rouault@mines-paris.org>
Message-ID: <1385416518705-5091131.post@n6.nabble.com>

Thanks, that's exactly what I'm looking for.





--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Slice-Large-GeoTiff-into-1-Degree-Tiles-tp5091122p5091131.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From lee.w.eddington at gmail.com  Mon Nov 25 14:00:41 2013
From: lee.w.eddington at gmail.com (Lee Eddington)
Date: Mon, 25 Nov 2013 14:00:41 -0800
Subject: [gdal-dev] WRF NetCDF import
In-Reply-To: <CA+TxYvOYgVymSTUYtWnLrW-0bz7-khhMnv3g=60J=p23a1BFgg@mail.gmail.com>
References: <CAHmmfARq2aWy3OsqFce+YDBCmANH9+y8zzTEB_JS7zdFQeMRSQ@mail.gmail.com>
	<CA+TxYvNvXLXuLEx99dm6uLZLqiFPr08itS6Gr4X6+6MYJs8zqQ@mail.gmail.com>
	<CAJx2nokEViqKsqK4AmUmar+L=z4_MurQseB7CeyDJrGqM6ZoHA@mail.gmail.com>
	<CA+TxYvOYgVymSTUYtWnLrW-0bz7-khhMnv3g=60J=p23a1BFgg@mail.gmail.com>
Message-ID: <CAHmmfAQosB+3MwYz4PQ3E6wtdAS44yd1nQi0FFvow_ou70vfdw@mail.gmail.com>

Roger,

Thank you for the info and link.  Using a modified version of your code I
was able to create and import into GRASS a GeoTIFF with the proper
georeferencing.  The coordinate system units are in meters though, and I'd
prefer to have them in degrees lat/lon.  Do you know if there's a way to
specify that using the oar or gdal routines in your code?

Thanks,
Lee



On Mon, Nov 25, 2013 at 10:23 AM, Etienne Tourigny
<etourigny.dev at gmail.com>wrote:

> Forwarding to the list and others...
>
> ---------- Forwarded message ----------
> From: Roger Veciana i Rovira <rveciana at gmail.com>
> Date: Mon, Nov 25, 2013 at 9:35 AM
> Subject: Re: [gdal-dev] WRF NetCDF import
> To: Etienne Tourigny <etourigny.dev at gmail.com>
>
>
> As Etienne told you, the geotransform and projection from your files is
> not in the format that GDAL can understand.
> I wrote a script that reads the projection and calculates the geotransform
> to save it in a GeoTIFF file:
>
>
> http://geoexamples.blogspot.com.es/2013/09/reading-wrf-netcdf-files-with-gdal.html
>
> The script also interpolates the WRF sigma levels to the desired pressure
> level, so you will have to look for the functions that you need.
>
> Anyway, the solution is quite complicated, and using cdo, nco or other
> tools (I use ARWPost) may be easier.
>
> Roger
>
>
> 2013/11/24 Etienne Tourigny <etourigny.dev at gmail.com>
>
>> The "georeferencing info" you refer to is non-standard, and GDAL cannot
>> use that. It (and presumably the grass provider, although I don't know) use
>> the CF standard for encoding lat/lon information. what is the output of
>> gdalinfo NETCDF:test_full.nc:HGT
>>
>> I don't know how the grass provider deals with subdatasets, but if you
>> open the file in qgis (using the gdal provider, it will sllow you to select
>> the subdataset you want).
>>
>> You could also extract the variable with another tool like cdo or nco.
>>
>> Etienne
>>
>>
>>
>> On Sat, Nov 23, 2013 at 7:47 PM, Lee Eddington <lee.w.eddington at gmail.com
>> > wrote:
>>
>>> I'm trying to use r.in.gdal in GRASS GIS to import Weather Research &
>>> Forecasting (WRF) model NetCDF output.  There have been some tips provided
>>> by the GRASS users list, but none have worked for me.  I can import the
>>> data as a simple x,y array with no georeferencing, but information about
>>> georeferencing is in the file as other programs read, georeference and
>>> display the file correctly.
>>>
>>> gdalinfo produces the following:
>>>
>>> lees-mbp:full Lee$ gdalinfo test_full.nc
>>> Warning 1: No UNIDATA NC_GLOBAL:Conventions attribute
>>>  Driver: netCDF/Network Common Data Format
>>> Files: test_full.nc
>>> Size is 512, 512
>>> Coordinate System is `'
>>> Metadata:
>>>   NC_GLOBAL#BL_PBL_PHYSICS=1
>>>   NC_GLOBAL#BOTTOM-TOP_GRID_DIMENSION=28
>>>   NC_GLOBAL#BOTTOM-TOP_PATCH_END_STAG=28
>>>   NC_GLOBAL#BOTTOM-TOP_PATCH_END_UNSTAG=27
>>>   NC_GLOBAL#BOTTOM-TOP_PATCH_START_STAG=1
>>>   NC_GLOBAL#BOTTOM-TOP_PATCH_START_UNSTAG=1
>>>   NC_GLOBAL#BUCKET_J=-1
>>>   NC_GLOBAL#BUCKET_MM=-1
>>>   NC_GLOBAL#CEN_LAT=-8.4095154
>>>   NC_GLOBAL#CEN_LON=115.02
>>>   NC_GLOBAL#CU_PHYSICS=0
>>>   NC_GLOBAL#DAMP_OPT=0
>>>   NC_GLOBAL#DAMPCOEF=0.2
>>>   NC_GLOBAL#DFI_OPT=0
>>>   NC_GLOBAL#DIFF_6TH_FACTOR=0.12
>>>   NC_GLOBAL#DIFF_6TH_OPT=0
>>>   NC_GLOBAL#DIFF_OPT=1
>>>   NC_GLOBAL#DT=16.666666
>>>   NC_GLOBAL#DX=3000
>>>   NC_GLOBAL#DY=3000
>>>   NC_GLOBAL#FEEDBACK=0
>>>   NC_GLOBAL#GFDDA_END_H=0
>>>   NC_GLOBAL#GFDDA_INTERVAL_M=0
>>>   NC_GLOBAL#GMT=12
>>>   NC_GLOBAL#GRID_FDDA=0
>>>   NC_GLOBAL#GRID_ID=3
>>>   NC_GLOBAL#GRID_SFDDA=0
>>>   NC_GLOBAL#GRIDTYPE=C
>>>   NC_GLOBAL#HYPSOMETRIC_OPT=2
>>>   NC_GLOBAL#I_PARENT_START=34
>>>   NC_GLOBAL#ISFTCFLX=0
>>>   NC_GLOBAL#ISHALLOW=0
>>>   NC_GLOBAL#ISICE=24
>>>   NC_GLOBAL#ISLAKE=-1
>>>   NC_GLOBAL#ISOILWATER=14
>>>   NC_GLOBAL#ISURBAN=1
>>>   NC_GLOBAL#ISWATER=16
>>>   NC_GLOBAL#J_PARENT_START=34
>>>   NC_GLOBAL#JULDAY=324
>>>   NC_GLOBAL#JULYR=2013
>>>   NC_GLOBAL#KHDIF=0
>>>   NC_GLOBAL#KM_OPT=4
>>>   NC_GLOBAL#KVDIF=0
>>>   NC_GLOBAL#MAP_PROJ=3
>>>   NC_GLOBAL#MFSHCONV=0
>>>   NC_GLOBAL#MMINLU=USGS
>>>   NC_GLOBAL#MOAD_CEN_LAT=-8.4095078
>>>   NC_GLOBAL#MOIST_ADV_OPT=1
>>>   NC_GLOBAL#MP_PHYSICS=3
>>>   NC_GLOBAL#NUM_LAND_CAT=24
>>>   NC_GLOBAL#OBS_NUDGE_OPT=0
>>>   NC_GLOBAL#OMLCALL=0
>>>   NC_GLOBAL#PARENT_GRID_RATIO=3
>>>   NC_GLOBAL#PARENT_ID=2
>>>   NC_GLOBAL#POLE_LAT=90
>>>   NC_GLOBAL#POLE_LON=0
>>>   NC_GLOBAL#PREC_ACC_DT=0
>>>   NC_GLOBAL#RA_LW_PHYSICS=1
>>>   NC_GLOBAL#RA_SW_PHYSICS=1
>>>   NC_GLOBAL#SCALAR_ADV_OPT=1
>>>   NC_GLOBAL#SF_SFCLAY_PHYSICS=1
>>>   NC_GLOBAL#SF_SURFACE_PHYSICS=2
>>>   NC_GLOBAL#SF_URBAN_PHYSICS=0
>>>   NC_GLOBAL#SGFDDA_END_H=0
>>>   NC_GLOBAL#SGFDDA_INTERVAL_M=0
>>>   NC_GLOBAL#SHCU_PHYSICS=0
>>>   NC_GLOBAL#SIMULATION_START_DATE=2013-11-20_12:00:00
>>>   NC_GLOBAL#SMOOTH_OPTION=0
>>>   NC_GLOBAL#SOUTH-NORTH_GRID_DIMENSION=154
>>>   NC_GLOBAL#SOUTH-NORTH_PATCH_END_STAG=154
>>>   NC_GLOBAL#SOUTH-NORTH_PATCH_END_UNSTAG=153
>>>   NC_GLOBAL#SOUTH-NORTH_PATCH_START_STAG=1
>>>   NC_GLOBAL#SOUTH-NORTH_PATCH_START_UNSTAG=1
>>>   NC_GLOBAL#SST_UPDATE=0
>>>   NC_GLOBAL#STAND_LON=115.02
>>>   NC_GLOBAL#START_DATE=2013-11-20_12:00:00
>>>   NC_GLOBAL#SURFACE_INPUT_SOURCE=1
>>>   NC_GLOBAL#SWRAD_SCAT=1
>>>   NC_GLOBAL#TITLE= OUTPUT FROM WRF V3.4 MODEL
>>>   NC_GLOBAL#TKE_ADV_OPT=1
>>>   NC_GLOBAL#TRUELAT1=-8.4095001
>>>   NC_GLOBAL#TRUELAT2=0
>>>   NC_GLOBAL#W_DAMPING=0
>>>   NC_GLOBAL#WEST-EAST_GRID_DIMENSION=199
>>>   NC_GLOBAL#WEST-EAST_PATCH_END_STAG=199
>>>   NC_GLOBAL#WEST-EAST_PATCH_END_UNSTAG=198
>>>   NC_GLOBAL#WEST-EAST_PATCH_START_STAG=1
>>>   NC_GLOBAL#WEST-EAST_PATCH_START_UNSTAG=1
>>> Subdatasets:
>>>   SUBDATASET_1_NAME=NETCDF:"test_full.nc":Times
>>>   SUBDATASET_1_DESC=[1x19] Times (8-bit character)
>>>   SUBDATASET_2_NAME=NETCDF:"test_full.nc":LU_INDEX
>>>   SUBDATASET_2_DESC=[1x153x198] LU_INDEX (32-bit floating-point)
>>>
>>> (more SUBDATASETs)
>>>
>>>   SUBDATASET_106_NAME=NETCDF:"test_full.nc":LANDMASK
>>>   SUBDATASET_106_DESC=[1x153x198] LANDMASK (32-bit floating-point)
>>>   SUBDATASET_107_NAME=NETCDF:"test_full.nc":SST
>>>   SUBDATASET_107_DESC=[1x153x198] SST (32-bit floating-point)
>>> Corner Coordinates:
>>> Upper Left  (    0.0,    0.0)
>>> Lower Left  (    0.0,  512.0)
>>> Upper Right (  512.0,    0.0)
>>> Lower Right (  512.0,  512.0)
>>> Center      (  256.0,  256.0)
>>>
>>> My first question is why am I getting the following warning?:
>>>
>>> Warning 1: No UNIDATA NC_GLOBAL:Conventions attribute
>>>
>>> Next, I see what appears is georeferencing info in the following lines:
>>>
>>>   NC_GLOBAL#CEN_LAT=-8.4095154
>>>   NC_GLOBAL#CEN_LON=115.02
>>>   NC_GLOBAL#MAP_PROJ=3 (Mercator)
>>>   NC_GLOBAL#MOAD_CEN_LAT=-8.4095078
>>>    NC_GLOBAL#STAND_LON=115.02
>>>   NC_GLOBAL#TRUELAT1=-8.4095001
>>>
>>> but obviously this is not being interpreted or used.
>>>
>>> Trying to use gdalwarp:
>>>
>>> lees-mbp:full Lee$ gdalwarp NETCDF:test_full.nc:HGT test_full_HGT.tif
>>> Warning 1: No UNIDATA NC_GLOBAL:Conventions attribute
>>> ERROR 1: Unable to compute a transformation between pixel/line
>>> and georeferenced coordinates for NETCDF:test_full.nc:HGT.
>>> There is no affine transformation and no GCPs.
>>>
>>> Can anyone explain what I need to do?
>>>
>>> Thanks,
>>> Lee
>>>
>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131125/df65e1ac/attachment-0001.html>

From even.rouault at mines-paris.org  Mon Nov 25 14:52:44 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 25 Nov 2013 23:52:44 +0100
Subject: [gdal-dev] Large shapefile issues
In-Reply-To: <BC6AE4846A9FD641B39A8A776CC90B6E0204D695@sv060.infoterra-global.com>
References: <BC6AE4846A9FD641B39A8A776CC90B6E0204D695@sv060.infoterra-global.com>
Message-ID: <201311252352.44751.even.rouault@mines-paris.org>

Le lundi 25 novembre 2013 11:42:23, CARMAN, Darren a ?crit :
> Hi List
> 
> 
> 
> I notice on the OGR formats page for ESRI Shapefile the following is
> mentioned:
> 
> ================
> 
> Size Issues
> 
> Geometry: The Shapefile format explicitly uses 32bit offsets and so
> cannot go over 8GB (it actually uses 32bit offsets to 16bit words).
> Hence, it is is not recommended to use a file size over 4GB.
> 
> Attributes: The dbf format does not have any offsets in it, so it can be
> arbitrarily large.
> 
> ================
> 
> 
> 
> Yet on the ESRI website:
> 
> ================
> 
> Geometry limitations
> 
> There is a 2 GB size limit for any shapefile component file, which
> translates to a maximum of roughly 70 million point features. The actual
> number of line or polygon features you can store in a shapefile depends
> on the number of vertices in each line or polygon (a vertex is
> equivalent to a point).
> 
> ================
> 
> 
> 
> I assume the OGR web page is wrong, or has a different meaning outside
> of ESRI S/W use.

Darren,

Yes, as underlined by Chaitanya the actual limit depends on the software 
implementation. Actually the limit in OGR was 4 GB for the .SHP, and AFAICS 
unlimited for DBF.

I've added in http://trac.osgeo.org/gdal/changeset/26657 a 2GB_LIMIT=YES layer 
creation option (and SHAPE_2GB_LIMIT configuration option) that will enforce 
the 2GB limit. And in http://trac.osgeo.org/gdal/changeset/26658 a change so 
that when the layer is reached the file is properly closed with the valid 
information.

Spliting files over several files would properly need to be done outside of 
this, in a script, by restarting from the source layer at the index next to 
the one that was last written in the shapefile.

Best regards,

Even
-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From woodbri at swoodbridge.com  Mon Nov 25 15:46:18 2013
From: woodbri at swoodbridge.com (Stephen Woodbridge)
Date: Mon, 25 Nov 2013 18:46:18 -0500
Subject: [gdal-dev] Large shapefile issues
In-Reply-To: <201311252352.44751.even.rouault@mines-paris.org>
References: <BC6AE4846A9FD641B39A8A776CC90B6E0204D695@sv060.infoterra-global.com>
	<201311252352.44751.even.rouault@mines-paris.org>
Message-ID: <5293E14A.90401@swoodbridge.com>

Unless something has changed, I have never been able to work with dbf 
file over 2GB using shapelib.

-Steve W

On 11/25/2013 5:52 PM, Even Rouault wrote:
> Le lundi 25 novembre 2013 11:42:23, CARMAN, Darren a ?crit :
>> Hi List
>>
>>
>>
>> I notice on the OGR formats page for ESRI Shapefile the following is
>> mentioned:
>>
>> ================
>>
>> Size Issues
>>
>> Geometry: The Shapefile format explicitly uses 32bit offsets and so
>> cannot go over 8GB (it actually uses 32bit offsets to 16bit words).
>> Hence, it is is not recommended to use a file size over 4GB.
>>
>> Attributes: The dbf format does not have any offsets in it, so it can be
>> arbitrarily large.
>>
>> ================
>>
>>
>>
>> Yet on the ESRI website:
>>
>> ================
>>
>> Geometry limitations
>>
>> There is a 2 GB size limit for any shapefile component file, which
>> translates to a maximum of roughly 70 million point features. The actual
>> number of line or polygon features you can store in a shapefile depends
>> on the number of vertices in each line or polygon (a vertex is
>> equivalent to a point).
>>
>> ================
>>
>>
>>
>> I assume the OGR web page is wrong, or has a different meaning outside
>> of ESRI S/W use.
>
> Darren,
>
> Yes, as underlined by Chaitanya the actual limit depends on the software
> implementation. Actually the limit in OGR was 4 GB for the .SHP, and AFAICS
> unlimited for DBF.
>
> I've added in http://trac.osgeo.org/gdal/changeset/26657 a 2GB_LIMIT=YES layer
> creation option (and SHAPE_2GB_LIMIT configuration option) that will enforce
> the 2GB limit. And in http://trac.osgeo.org/gdal/changeset/26658 a change so
> that when the layer is reached the file is properly closed with the valid
> information.
>
> Spliting files over several files would properly need to be done outside of
> this, in a script, by restarting from the source layer at the index next to
> the one that was last written in the shapefile.
>
> Best regards,
>
> Even
>


From even.rouault at mines-paris.org  Mon Nov 25 15:56:05 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 26 Nov 2013 00:56:05 +0100
Subject: [gdal-dev] Large shapefile issues
In-Reply-To: <5293E14A.90401@swoodbridge.com>
References: <BC6AE4846A9FD641B39A8A776CC90B6E0204D695@sv060.infoterra-global.com>
	<201311252352.44751.even.rouault@mines-paris.org>
	<5293E14A.90401@swoodbridge.com>
Message-ID: <201311260056.05247.even.rouault@mines-paris.org>

Le mardi 26 novembre 2013 00:46:18, Stephen Woodbridge a ?crit :
> Unless something has changed, I have never been able to work with dbf
> file over 2GB using shapelib.

With shapelib or OGR ? With shapelib, you need to define SAOffset to be a 64bit 
integer, which OGR does.
The shapefile driver regression tests include a test to read and update a 
record over 2GB.

> 
> -Steve W
> 
> On 11/25/2013 5:52 PM, Even Rouault wrote:
> > Le lundi 25 novembre 2013 11:42:23, CARMAN, Darren a ?crit :
> >> Hi List
> >> 
> >> 
> >> 
> >> I notice on the OGR formats page for ESRI Shapefile the following is
> >> mentioned:
> >> 
> >> ================
> >> 
> >> Size Issues
> >> 
> >> Geometry: The Shapefile format explicitly uses 32bit offsets and so
> >> cannot go over 8GB (it actually uses 32bit offsets to 16bit words).
> >> Hence, it is is not recommended to use a file size over 4GB.
> >> 
> >> Attributes: The dbf format does not have any offsets in it, so it can be
> >> arbitrarily large.
> >> 
> >> ================
> >> 
> >> 
> >> 
> >> Yet on the ESRI website:
> >> 
> >> ================
> >> 
> >> Geometry limitations
> >> 
> >> There is a 2 GB size limit for any shapefile component file, which
> >> translates to a maximum of roughly 70 million point features. The actual
> >> number of line or polygon features you can store in a shapefile depends
> >> on the number of vertices in each line or polygon (a vertex is
> >> equivalent to a point).
> >> 
> >> ================
> >> 
> >> 
> >> 
> >> I assume the OGR web page is wrong, or has a different meaning outside
> >> of ESRI S/W use.
> > 
> > Darren,
> > 
> > Yes, as underlined by Chaitanya the actual limit depends on the software
> > implementation. Actually the limit in OGR was 4 GB for the .SHP, and
> > AFAICS unlimited for DBF.
> > 
> > I've added in http://trac.osgeo.org/gdal/changeset/26657 a 2GB_LIMIT=YES
> > layer creation option (and SHAPE_2GB_LIMIT configuration option) that
> > will enforce the 2GB limit. And in
> > http://trac.osgeo.org/gdal/changeset/26658 a change so that when the
> > layer is reached the file is properly closed with the valid information.
> > 
> > Spliting files over several files would properly need to be done outside
> > of this, in a script, by restarting from the source layer at the index
> > next to the one that was last written in the shapefile.
> > 
> > Best regards,
> > 
> > Even
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From xwh19910215 at 163.com  Mon Nov 25 18:31:50 2013
From: xwh19910215 at 163.com (xwh19910215 at 163.com)
Date: Tue, 26 Nov 2013 10:31:50 +0800
Subject: [gdal-dev]  Using Derived Bands(VRT) in .NET
Message-ID: <2013112610315044178314@163.com>

Hi,
 
I am trying to read dataset using VRT Driver, and need using derived bands of VRT Datasets (linked in http://www.gdal.org/gdal_vrttut.html). Now I known it could be achieved in C++, but not achieved in C#(.Net) as the classlib of GDAL in .NET dosen't contain class GDALAddDerivedBandPixelFunc.  Is this function available in .NET and how to achieve? 

Thanks a lot!




XWH xwh19910215 at 163.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131126/e45b44c4/attachment.html>

From lee.w.eddington at gmail.com  Mon Nov 25 20:27:54 2013
From: lee.w.eddington at gmail.com (Lee Eddington)
Date: Mon, 25 Nov 2013 20:27:54 -0800
Subject: [gdal-dev] WRF NetCDF import
In-Reply-To: <CAHmmfAQosB+3MwYz4PQ3E6wtdAS44yd1nQi0FFvow_ou70vfdw@mail.gmail.com>
References: <CAHmmfARq2aWy3OsqFce+YDBCmANH9+y8zzTEB_JS7zdFQeMRSQ@mail.gmail.com>
	<CA+TxYvNvXLXuLEx99dm6uLZLqiFPr08itS6Gr4X6+6MYJs8zqQ@mail.gmail.com>
	<CAJx2nokEViqKsqK4AmUmar+L=z4_MurQseB7CeyDJrGqM6ZoHA@mail.gmail.com>
	<CA+TxYvOYgVymSTUYtWnLrW-0bz7-khhMnv3g=60J=p23a1BFgg@mail.gmail.com>
	<CAHmmfAQosB+3MwYz4PQ3E6wtdAS44yd1nQi0FFvow_ou70vfdw@mail.gmail.com>
Message-ID: <CAHmmfAT7hRdYutmHW1ZRGvyUfrUhhP6Xh8RjBthny3TNZqrCZg@mail.gmail.com>

I think I might be getting close.  I found the following which I'm hoping
will create the GeoTiff with angular units of degrees instead of linear
units of meters:

OGRErr OGRSpatialReference::SetAngularUnits(const char * pszUnitsName,
double dfInRadians
)

and tried to use it, but don't know the proper pszUnitsName.  I've tried
"degree", "degrees", "DEGREE", "DEGREES", "DEG", "SRS_UA_DEGREE", but
always get a return code of 6 instead of 0.  I can't find a list of names
or any examples of how to use this properly.


On Mon, Nov 25, 2013 at 2:00 PM, Lee Eddington <lee.w.eddington at gmail.com>wrote:

> Roger,
>
> Thank you for the info and link.  Using a modified version of your code I
> was able to create and import into GRASS a GeoTIFF with the proper
> georeferencing.  The coordinate system units are in meters though, and I'd
> prefer to have them in degrees lat/lon.  Do you know if there's a way to
> specify that using the oar or gdal routines in your code?
>
> Thanks,
> Lee
>
>
>
> On Mon, Nov 25, 2013 at 10:23 AM, Etienne Tourigny <
> etourigny.dev at gmail.com> wrote:
>
>> Forwarding to the list and others...
>>
>> ---------- Forwarded message ----------
>> From: Roger Veciana i Rovira <rveciana at gmail.com>
>> Date: Mon, Nov 25, 2013 at 9:35 AM
>> Subject: Re: [gdal-dev] WRF NetCDF import
>> To: Etienne Tourigny <etourigny.dev at gmail.com>
>>
>>
>> As Etienne told you, the geotransform and projection from your files is
>> not in the format that GDAL can understand.
>> I wrote a script that reads the projection and calculates the
>> geotransform to save it in a GeoTIFF file:
>>
>>
>> http://geoexamples.blogspot.com.es/2013/09/reading-wrf-netcdf-files-with-gdal.html
>>
>> The script also interpolates the WRF sigma levels to the desired pressure
>> level, so you will have to look for the functions that you need.
>>
>> Anyway, the solution is quite complicated, and using cdo, nco or other
>> tools (I use ARWPost) may be easier.
>>
>> Roger
>>
>>
>> 2013/11/24 Etienne Tourigny <etourigny.dev at gmail.com>
>>
>>> The "georeferencing info" you refer to is non-standard, and GDAL cannot
>>> use that. It (and presumably the grass provider, although I don't know) use
>>> the CF standard for encoding lat/lon information. what is the output of
>>> gdalinfo NETCDF:test_full.nc:HGT
>>>
>>> I don't know how the grass provider deals with subdatasets, but if you
>>> open the file in qgis (using the gdal provider, it will sllow you to select
>>> the subdataset you want).
>>>
>>> You could also extract the variable with another tool like cdo or nco.
>>>
>>> Etienne
>>>
>>>
>>>
>>> On Sat, Nov 23, 2013 at 7:47 PM, Lee Eddington <
>>> lee.w.eddington at gmail.com> wrote:
>>>
>>>> I'm trying to use r.in.gdal in GRASS GIS to import Weather Research &
>>>> Forecasting (WRF) model NetCDF output.  There have been some tips provided
>>>> by the GRASS users list, but none have worked for me.  I can import the
>>>> data as a simple x,y array with no georeferencing, but information about
>>>> georeferencing is in the file as other programs read, georeference and
>>>> display the file correctly.
>>>>
>>>> gdalinfo produces the following:
>>>>
>>>> lees-mbp:full Lee$ gdalinfo test_full.nc
>>>> Warning 1: No UNIDATA NC_GLOBAL:Conventions attribute
>>>>  Driver: netCDF/Network Common Data Format
>>>> Files: test_full.nc
>>>> Size is 512, 512
>>>> Coordinate System is `'
>>>> Metadata:
>>>>   NC_GLOBAL#BL_PBL_PHYSICS=1
>>>>   NC_GLOBAL#BOTTOM-TOP_GRID_DIMENSION=28
>>>>   NC_GLOBAL#BOTTOM-TOP_PATCH_END_STAG=28
>>>>   NC_GLOBAL#BOTTOM-TOP_PATCH_END_UNSTAG=27
>>>>   NC_GLOBAL#BOTTOM-TOP_PATCH_START_STAG=1
>>>>   NC_GLOBAL#BOTTOM-TOP_PATCH_START_UNSTAG=1
>>>>   NC_GLOBAL#BUCKET_J=-1
>>>>   NC_GLOBAL#BUCKET_MM=-1
>>>>   NC_GLOBAL#CEN_LAT=-8.4095154
>>>>   NC_GLOBAL#CEN_LON=115.02
>>>>   NC_GLOBAL#CU_PHYSICS=0
>>>>   NC_GLOBAL#DAMP_OPT=0
>>>>   NC_GLOBAL#DAMPCOEF=0.2
>>>>   NC_GLOBAL#DFI_OPT=0
>>>>   NC_GLOBAL#DIFF_6TH_FACTOR=0.12
>>>>   NC_GLOBAL#DIFF_6TH_OPT=0
>>>>   NC_GLOBAL#DIFF_OPT=1
>>>>   NC_GLOBAL#DT=16.666666
>>>>   NC_GLOBAL#DX=3000
>>>>   NC_GLOBAL#DY=3000
>>>>   NC_GLOBAL#FEEDBACK=0
>>>>   NC_GLOBAL#GFDDA_END_H=0
>>>>   NC_GLOBAL#GFDDA_INTERVAL_M=0
>>>>   NC_GLOBAL#GMT=12
>>>>   NC_GLOBAL#GRID_FDDA=0
>>>>   NC_GLOBAL#GRID_ID=3
>>>>   NC_GLOBAL#GRID_SFDDA=0
>>>>   NC_GLOBAL#GRIDTYPE=C
>>>>   NC_GLOBAL#HYPSOMETRIC_OPT=2
>>>>   NC_GLOBAL#I_PARENT_START=34
>>>>   NC_GLOBAL#ISFTCFLX=0
>>>>   NC_GLOBAL#ISHALLOW=0
>>>>   NC_GLOBAL#ISICE=24
>>>>   NC_GLOBAL#ISLAKE=-1
>>>>   NC_GLOBAL#ISOILWATER=14
>>>>   NC_GLOBAL#ISURBAN=1
>>>>   NC_GLOBAL#ISWATER=16
>>>>   NC_GLOBAL#J_PARENT_START=34
>>>>   NC_GLOBAL#JULDAY=324
>>>>   NC_GLOBAL#JULYR=2013
>>>>   NC_GLOBAL#KHDIF=0
>>>>   NC_GLOBAL#KM_OPT=4
>>>>   NC_GLOBAL#KVDIF=0
>>>>   NC_GLOBAL#MAP_PROJ=3
>>>>   NC_GLOBAL#MFSHCONV=0
>>>>   NC_GLOBAL#MMINLU=USGS
>>>>   NC_GLOBAL#MOAD_CEN_LAT=-8.4095078
>>>>   NC_GLOBAL#MOIST_ADV_OPT=1
>>>>   NC_GLOBAL#MP_PHYSICS=3
>>>>   NC_GLOBAL#NUM_LAND_CAT=24
>>>>   NC_GLOBAL#OBS_NUDGE_OPT=0
>>>>   NC_GLOBAL#OMLCALL=0
>>>>   NC_GLOBAL#PARENT_GRID_RATIO=3
>>>>   NC_GLOBAL#PARENT_ID=2
>>>>   NC_GLOBAL#POLE_LAT=90
>>>>   NC_GLOBAL#POLE_LON=0
>>>>   NC_GLOBAL#PREC_ACC_DT=0
>>>>   NC_GLOBAL#RA_LW_PHYSICS=1
>>>>   NC_GLOBAL#RA_SW_PHYSICS=1
>>>>   NC_GLOBAL#SCALAR_ADV_OPT=1
>>>>   NC_GLOBAL#SF_SFCLAY_PHYSICS=1
>>>>   NC_GLOBAL#SF_SURFACE_PHYSICS=2
>>>>   NC_GLOBAL#SF_URBAN_PHYSICS=0
>>>>   NC_GLOBAL#SGFDDA_END_H=0
>>>>   NC_GLOBAL#SGFDDA_INTERVAL_M=0
>>>>   NC_GLOBAL#SHCU_PHYSICS=0
>>>>   NC_GLOBAL#SIMULATION_START_DATE=2013-11-20_12:00:00
>>>>   NC_GLOBAL#SMOOTH_OPTION=0
>>>>   NC_GLOBAL#SOUTH-NORTH_GRID_DIMENSION=154
>>>>   NC_GLOBAL#SOUTH-NORTH_PATCH_END_STAG=154
>>>>   NC_GLOBAL#SOUTH-NORTH_PATCH_END_UNSTAG=153
>>>>   NC_GLOBAL#SOUTH-NORTH_PATCH_START_STAG=1
>>>>   NC_GLOBAL#SOUTH-NORTH_PATCH_START_UNSTAG=1
>>>>   NC_GLOBAL#SST_UPDATE=0
>>>>   NC_GLOBAL#STAND_LON=115.02
>>>>   NC_GLOBAL#START_DATE=2013-11-20_12:00:00
>>>>   NC_GLOBAL#SURFACE_INPUT_SOURCE=1
>>>>   NC_GLOBAL#SWRAD_SCAT=1
>>>>   NC_GLOBAL#TITLE= OUTPUT FROM WRF V3.4 MODEL
>>>>   NC_GLOBAL#TKE_ADV_OPT=1
>>>>   NC_GLOBAL#TRUELAT1=-8.4095001
>>>>   NC_GLOBAL#TRUELAT2=0
>>>>   NC_GLOBAL#W_DAMPING=0
>>>>   NC_GLOBAL#WEST-EAST_GRID_DIMENSION=199
>>>>   NC_GLOBAL#WEST-EAST_PATCH_END_STAG=199
>>>>   NC_GLOBAL#WEST-EAST_PATCH_END_UNSTAG=198
>>>>   NC_GLOBAL#WEST-EAST_PATCH_START_STAG=1
>>>>   NC_GLOBAL#WEST-EAST_PATCH_START_UNSTAG=1
>>>> Subdatasets:
>>>>   SUBDATASET_1_NAME=NETCDF:"test_full.nc":Times
>>>>   SUBDATASET_1_DESC=[1x19] Times (8-bit character)
>>>>   SUBDATASET_2_NAME=NETCDF:"test_full.nc":LU_INDEX
>>>>   SUBDATASET_2_DESC=[1x153x198] LU_INDEX (32-bit floating-point)
>>>>
>>>> (more SUBDATASETs)
>>>>
>>>>   SUBDATASET_106_NAME=NETCDF:"test_full.nc":LANDMASK
>>>>   SUBDATASET_106_DESC=[1x153x198] LANDMASK (32-bit floating-point)
>>>>   SUBDATASET_107_NAME=NETCDF:"test_full.nc":SST
>>>>   SUBDATASET_107_DESC=[1x153x198] SST (32-bit floating-point)
>>>> Corner Coordinates:
>>>> Upper Left  (    0.0,    0.0)
>>>> Lower Left  (    0.0,  512.0)
>>>> Upper Right (  512.0,    0.0)
>>>> Lower Right (  512.0,  512.0)
>>>> Center      (  256.0,  256.0)
>>>>
>>>> My first question is why am I getting the following warning?:
>>>>
>>>> Warning 1: No UNIDATA NC_GLOBAL:Conventions attribute
>>>>
>>>> Next, I see what appears is georeferencing info in the following lines:
>>>>
>>>>   NC_GLOBAL#CEN_LAT=-8.4095154
>>>>   NC_GLOBAL#CEN_LON=115.02
>>>>   NC_GLOBAL#MAP_PROJ=3 (Mercator)
>>>>   NC_GLOBAL#MOAD_CEN_LAT=-8.4095078
>>>>    NC_GLOBAL#STAND_LON=115.02
>>>>   NC_GLOBAL#TRUELAT1=-8.4095001
>>>>
>>>> but obviously this is not being interpreted or used.
>>>>
>>>> Trying to use gdalwarp:
>>>>
>>>> lees-mbp:full Lee$ gdalwarp NETCDF:test_full.nc:HGT test_full_HGT.tif
>>>> Warning 1: No UNIDATA NC_GLOBAL:Conventions attribute
>>>> ERROR 1: Unable to compute a transformation between pixel/line
>>>> and georeferenced coordinates for NETCDF:test_full.nc:HGT.
>>>> There is no affine transformation and no GCPs.
>>>>
>>>> Can anyone explain what I need to do?
>>>>
>>>> Thanks,
>>>> Lee
>>>>
>>>>
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev at lists.osgeo.org
>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>
>>>
>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>
>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131125/9b6a63d7/attachment-0001.html>

From walkermatt at longwayaround.org.uk  Tue Nov 26 01:51:21 2013
From: walkermatt at longwayaround.org.uk (Matt Walker)
Date: Tue, 26 Nov 2013 09:51:21 +0000
Subject: [gdal-dev] Error when appending non-spatial tables in GML to PostGIS
Message-ID: <CACcwLY88VC3wfq7LXBWLWE51O94Ez-YiPzmoxHGFx9Qb85mcuQ@mail.gmail.com>

Hi,

I'm loading some Ordnance Survey ITN GML data into PostgreSQL 9.1 / PostGIS
1.5 which contains a number of feature types that are lookups without any
geometry, the first file loads fine but loading subsequent files using the
ogr2ogr -append option fails with the error:

    ERROR 1: Layer road already exists, CreateLayer failed.
    Use the layer creation option OVERWRITE=YES to replace it.

I'm finding that the gfs file generated by OGR sets the geometry type to
100 (no geometry), manually editing the gfs file to remove the GeometryType
element for the lookup feature types works around the error but creates a
redundant geometry column and an entry in geometry_columns.

I've put further details and two sample gml files containing a single
"feature" in each here: https://gist.github.com/walkermatt/7655745

Happy to create at ticket if it's appropriate.

Thanks,

Matt

-- 
Matt Walker
Astun Technology
@_walkermatt
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131126/33df15b5/attachment.html>

From lee.w.eddington at gmail.com  Tue Nov 26 02:32:13 2013
From: lee.w.eddington at gmail.com (Lee Eddington)
Date: Tue, 26 Nov 2013 02:32:13 -0800
Subject: [gdal-dev] WRF NetCDF import
In-Reply-To: <CAJx2nomc5e8494ZVwhw_BczENfJmRXT2NGSJoAZqHwcX4gdm6A@mail.gmail.com>
References: <CAHmmfARq2aWy3OsqFce+YDBCmANH9+y8zzTEB_JS7zdFQeMRSQ@mail.gmail.com>
	<CA+TxYvNvXLXuLEx99dm6uLZLqiFPr08itS6Gr4X6+6MYJs8zqQ@mail.gmail.com>
	<CAJx2nokEViqKsqK4AmUmar+L=z4_MurQseB7CeyDJrGqM6ZoHA@mail.gmail.com>
	<CA+TxYvOYgVymSTUYtWnLrW-0bz7-khhMnv3g=60J=p23a1BFgg@mail.gmail.com>
	<CAHmmfAQosB+3MwYz4PQ3E6wtdAS44yd1nQi0FFvow_ou70vfdw@mail.gmail.com>
	<CAHmmfAT7hRdYutmHW1ZRGvyUfrUhhP6Xh8RjBthny3TNZqrCZg@mail.gmail.com>
	<CAJx2nomc5e8494ZVwhw_BczENfJmRXT2NGSJoAZqHwcX4gdm6A@mail.gmail.com>
Message-ID: <CAHmmfARpxD0CF=cjXGty=fGSMVX2OFzGjZehC5H_J9ULUERRpg@mail.gmail.com>

Roger,

Attached is the script I'm using.

Here are the results from gdalinfo on the output file:

lees-mbp:full Lee$ gdalinfo u10_2013112018.tif
Driver: GTiff/GeoTIFF
Files: u10_2013112018.tif
Size is 198, 153
Coordinate System is:
PROJCS["unnamed",
    GEOGCS["unknown",
        DATUM["unknown",
            SPHEROID["unretrievable - using WGS84",6378137,298.257223563]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Mercator_1SP"],
    PARAMETER["central_meridian",115.02],
    PARAMETER["scale_factor",0.9893189261265199],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]]]
Origin = (-295898.731194700172637,-696504.655801336281002)
Pixel Size = (2988.872338323183612,-2964.865850256682734)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  ( -295898.731, -696504.656) (112d19'59.51"E,  6d21'13.48"S)
Lower Left  ( -295898.731,-1150129.131) (112d19'59.51"E, 10d27'15.97"S)
Upper Right (  295897.992, -696504.656) (117d42'24.46"E,  6d21'13.48"S)
Lower Right (  295897.992,-1150129.131) (117d42'24.46"E, 10d27'15.97"S)
Center      (      -0.370, -923316.893) (115d 1'11.99"E,  8d24'34.51"S)
Band 1 Block=198x10 Type=Float32, ColorInterp=Gray


When I import this into GRASS I get coordinates of meters instead of
lat/lon degrees.  I want to keep the mercator projection of the model and
not convert to a lat/lon projection.

Lee



On Tue, Nov 26, 2013 at 1:45 AM, Roger Veciana i Rovira
<rveciana at gmail.com>wrote:

> Lee,
>
> If I understand what are you saiying, you have to define a proper
> projection first:
>
> proj_out = osr.SpatialReference()
> proj_out.ImportFromEPSG(4326)
>
> Which will create the lat lon projection you need (using WGS84 datum,
> maybe this won't be exact in your model). Then, you have to set the
> geotransform directly in degrees as you want.
>
> Roger
>
>
> 2013/11/26 Lee Eddington <lee.w.eddington at gmail.com>
>
>> I think I might be getting close.  I found the following which I'm hoping
>> will create the GeoTiff with angular units of degrees instead of linear
>> units of meters:
>>
>> OGRErr OGRSpatialReference::SetAngularUnits(const char * pszUnitsName,
>> double dfInRadians
>> )
>>
>> and tried to use it, but don't know the proper pszUnitsName.  I've tried
>> "degree", "degrees", "DEGREE", "DEGREES", "DEG", "SRS_UA_DEGREE", but
>> always get a return code of 6 instead of 0.  I can't find a list of names
>> or any examples of how to use this properly.
>>
>>
>> On Mon, Nov 25, 2013 at 2:00 PM, Lee Eddington <lee.w.eddington at gmail.com
>> > wrote:
>>
>>> Roger,
>>>
>>> Thank you for the info and link.  Using a modified version of your code
>>> I was able to create and import into GRASS a GeoTIFF with the proper
>>> georeferencing.  The coordinate system units are in meters though, and I'd
>>> prefer to have them in degrees lat/lon.  Do you know if there's a way to
>>> specify that using the oar or gdal routines in your code?
>>>
>>> Thanks,
>>> Lee
>>>
>>>
>>>
>>> On Mon, Nov 25, 2013 at 10:23 AM, Etienne Tourigny <
>>> etourigny.dev at gmail.com> wrote:
>>>
>>>> Forwarding to the list and others...
>>>>
>>>> ---------- Forwarded message ----------
>>>> From: Roger Veciana i Rovira <rveciana at gmail.com>
>>>> Date: Mon, Nov 25, 2013 at 9:35 AM
>>>> Subject: Re: [gdal-dev] WRF NetCDF import
>>>> To: Etienne Tourigny <etourigny.dev at gmail.com>
>>>>
>>>>
>>>> As Etienne told you, the geotransform and projection from your files is
>>>> not in the format that GDAL can understand.
>>>> I wrote a script that reads the projection and calculates the
>>>> geotransform to save it in a GeoTIFF file:
>>>>
>>>>
>>>> http://geoexamples.blogspot.com.es/2013/09/reading-wrf-netcdf-files-with-gdal.html
>>>>
>>>> The script also interpolates the WRF sigma levels to the desired
>>>> pressure level, so you will have to look for the functions that you need.
>>>>
>>>> Anyway, the solution is quite complicated, and using cdo, nco or other
>>>> tools (I use ARWPost) may be easier.
>>>>
>>>> Roger
>>>>
>>>>
>>>> 2013/11/24 Etienne Tourigny <etourigny.dev at gmail.com>
>>>>
>>>>> The "georeferencing info" you refer to is non-standard, and GDAL
>>>>> cannot use that. It (and presumably the grass provider, although I don't
>>>>> know) use the CF standard for encoding lat/lon information. what is the
>>>>> output of
>>>>> gdalinfo NETCDF:test_full.nc:HGT
>>>>>
>>>>> I don't know how the grass provider deals with subdatasets, but if you
>>>>> open the file in qgis (using the gdal provider, it will sllow you to select
>>>>> the subdataset you want).
>>>>>
>>>>> You could also extract the variable with another tool like cdo or nco.
>>>>>
>>>>> Etienne
>>>>>
>>>>>
>>>>>
>>>>> On Sat, Nov 23, 2013 at 7:47 PM, Lee Eddington <
>>>>> lee.w.eddington at gmail.com> wrote:
>>>>>
>>>>>> I'm trying to use r.in.gdal in GRASS GIS to import Weather Research &
>>>>>> Forecasting (WRF) model NetCDF output.  There have been some tips provided
>>>>>> by the GRASS users list, but none have worked for me.  I can import the
>>>>>> data as a simple x,y array with no georeferencing, but information about
>>>>>> georeferencing is in the file as other programs read, georeference and
>>>>>> display the file correctly.
>>>>>>
>>>>>> gdalinfo produces the following:
>>>>>>
>>>>>> lees-mbp:full Lee$ gdalinfo test_full.nc
>>>>>> Warning 1: No UNIDATA NC_GLOBAL:Conventions attribute
>>>>>>  Driver: netCDF/Network Common Data Format
>>>>>> Files: test_full.nc
>>>>>> Size is 512, 512
>>>>>> Coordinate System is `'
>>>>>> Metadata:
>>>>>>   NC_GLOBAL#BL_PBL_PHYSICS=1
>>>>>>   NC_GLOBAL#BOTTOM-TOP_GRID_DIMENSION=28
>>>>>>   NC_GLOBAL#BOTTOM-TOP_PATCH_END_STAG=28
>>>>>>   NC_GLOBAL#BOTTOM-TOP_PATCH_END_UNSTAG=27
>>>>>>   NC_GLOBAL#BOTTOM-TOP_PATCH_START_STAG=1
>>>>>>   NC_GLOBAL#BOTTOM-TOP_PATCH_START_UNSTAG=1
>>>>>>   NC_GLOBAL#BUCKET_J=-1
>>>>>>   NC_GLOBAL#BUCKET_MM=-1
>>>>>>   NC_GLOBAL#CEN_LAT=-8.4095154
>>>>>>   NC_GLOBAL#CEN_LON=115.02
>>>>>>   NC_GLOBAL#CU_PHYSICS=0
>>>>>>   NC_GLOBAL#DAMP_OPT=0
>>>>>>   NC_GLOBAL#DAMPCOEF=0.2
>>>>>>   NC_GLOBAL#DFI_OPT=0
>>>>>>   NC_GLOBAL#DIFF_6TH_FACTOR=0.12
>>>>>>   NC_GLOBAL#DIFF_6TH_OPT=0
>>>>>>   NC_GLOBAL#DIFF_OPT=1
>>>>>>   NC_GLOBAL#DT=16.666666
>>>>>>   NC_GLOBAL#DX=3000
>>>>>>   NC_GLOBAL#DY=3000
>>>>>>   NC_GLOBAL#FEEDBACK=0
>>>>>>   NC_GLOBAL#GFDDA_END_H=0
>>>>>>   NC_GLOBAL#GFDDA_INTERVAL_M=0
>>>>>>   NC_GLOBAL#GMT=12
>>>>>>   NC_GLOBAL#GRID_FDDA=0
>>>>>>   NC_GLOBAL#GRID_ID=3
>>>>>>   NC_GLOBAL#GRID_SFDDA=0
>>>>>>   NC_GLOBAL#GRIDTYPE=C
>>>>>>   NC_GLOBAL#HYPSOMETRIC_OPT=2
>>>>>>   NC_GLOBAL#I_PARENT_START=34
>>>>>>   NC_GLOBAL#ISFTCFLX=0
>>>>>>   NC_GLOBAL#ISHALLOW=0
>>>>>>   NC_GLOBAL#ISICE=24
>>>>>>   NC_GLOBAL#ISLAKE=-1
>>>>>>   NC_GLOBAL#ISOILWATER=14
>>>>>>   NC_GLOBAL#ISURBAN=1
>>>>>>   NC_GLOBAL#ISWATER=16
>>>>>>   NC_GLOBAL#J_PARENT_START=34
>>>>>>   NC_GLOBAL#JULDAY=324
>>>>>>   NC_GLOBAL#JULYR=2013
>>>>>>   NC_GLOBAL#KHDIF=0
>>>>>>   NC_GLOBAL#KM_OPT=4
>>>>>>   NC_GLOBAL#KVDIF=0
>>>>>>   NC_GLOBAL#MAP_PROJ=3
>>>>>>   NC_GLOBAL#MFSHCONV=0
>>>>>>   NC_GLOBAL#MMINLU=USGS
>>>>>>   NC_GLOBAL#MOAD_CEN_LAT=-8.4095078
>>>>>>   NC_GLOBAL#MOIST_ADV_OPT=1
>>>>>>   NC_GLOBAL#MP_PHYSICS=3
>>>>>>   NC_GLOBAL#NUM_LAND_CAT=24
>>>>>>   NC_GLOBAL#OBS_NUDGE_OPT=0
>>>>>>   NC_GLOBAL#OMLCALL=0
>>>>>>   NC_GLOBAL#PARENT_GRID_RATIO=3
>>>>>>   NC_GLOBAL#PARENT_ID=2
>>>>>>   NC_GLOBAL#POLE_LAT=90
>>>>>>   NC_GLOBAL#POLE_LON=0
>>>>>>   NC_GLOBAL#PREC_ACC_DT=0
>>>>>>   NC_GLOBAL#RA_LW_PHYSICS=1
>>>>>>   NC_GLOBAL#RA_SW_PHYSICS=1
>>>>>>   NC_GLOBAL#SCALAR_ADV_OPT=1
>>>>>>   NC_GLOBAL#SF_SFCLAY_PHYSICS=1
>>>>>>   NC_GLOBAL#SF_SURFACE_PHYSICS=2
>>>>>>   NC_GLOBAL#SF_URBAN_PHYSICS=0
>>>>>>   NC_GLOBAL#SGFDDA_END_H=0
>>>>>>   NC_GLOBAL#SGFDDA_INTERVAL_M=0
>>>>>>   NC_GLOBAL#SHCU_PHYSICS=0
>>>>>>   NC_GLOBAL#SIMULATION_START_DATE=2013-11-20_12:00:00
>>>>>>   NC_GLOBAL#SMOOTH_OPTION=0
>>>>>>   NC_GLOBAL#SOUTH-NORTH_GRID_DIMENSION=154
>>>>>>   NC_GLOBAL#SOUTH-NORTH_PATCH_END_STAG=154
>>>>>>   NC_GLOBAL#SOUTH-NORTH_PATCH_END_UNSTAG=153
>>>>>>   NC_GLOBAL#SOUTH-NORTH_PATCH_START_STAG=1
>>>>>>   NC_GLOBAL#SOUTH-NORTH_PATCH_START_UNSTAG=1
>>>>>>   NC_GLOBAL#SST_UPDATE=0
>>>>>>   NC_GLOBAL#STAND_LON=115.02
>>>>>>   NC_GLOBAL#START_DATE=2013-11-20_12:00:00
>>>>>>   NC_GLOBAL#SURFACE_INPUT_SOURCE=1
>>>>>>   NC_GLOBAL#SWRAD_SCAT=1
>>>>>>   NC_GLOBAL#TITLE= OUTPUT FROM WRF V3.4 MODEL
>>>>>>   NC_GLOBAL#TKE_ADV_OPT=1
>>>>>>   NC_GLOBAL#TRUELAT1=-8.4095001
>>>>>>   NC_GLOBAL#TRUELAT2=0
>>>>>>   NC_GLOBAL#W_DAMPING=0
>>>>>>   NC_GLOBAL#WEST-EAST_GRID_DIMENSION=199
>>>>>>   NC_GLOBAL#WEST-EAST_PATCH_END_STAG=199
>>>>>>   NC_GLOBAL#WEST-EAST_PATCH_END_UNSTAG=198
>>>>>>   NC_GLOBAL#WEST-EAST_PATCH_START_STAG=1
>>>>>>   NC_GLOBAL#WEST-EAST_PATCH_START_UNSTAG=1
>>>>>> Subdatasets:
>>>>>>   SUBDATASET_1_NAME=NETCDF:"test_full.nc":Times
>>>>>>   SUBDATASET_1_DESC=[1x19] Times (8-bit character)
>>>>>>   SUBDATASET_2_NAME=NETCDF:"test_full.nc":LU_INDEX
>>>>>>   SUBDATASET_2_DESC=[1x153x198] LU_INDEX (32-bit floating-point)
>>>>>>
>>>>>> (more SUBDATASETs)
>>>>>>
>>>>>>   SUBDATASET_106_NAME=NETCDF:"test_full.nc":LANDMASK
>>>>>>   SUBDATASET_106_DESC=[1x153x198] LANDMASK (32-bit floating-point)
>>>>>>   SUBDATASET_107_NAME=NETCDF:"test_full.nc":SST
>>>>>>   SUBDATASET_107_DESC=[1x153x198] SST (32-bit floating-point)
>>>>>> Corner Coordinates:
>>>>>> Upper Left  (    0.0,    0.0)
>>>>>> Lower Left  (    0.0,  512.0)
>>>>>> Upper Right (  512.0,    0.0)
>>>>>> Lower Right (  512.0,  512.0)
>>>>>> Center      (  256.0,  256.0)
>>>>>>
>>>>>> My first question is why am I getting the following warning?:
>>>>>>
>>>>>> Warning 1: No UNIDATA NC_GLOBAL:Conventions attribute
>>>>>>
>>>>>> Next, I see what appears is georeferencing info in the following
>>>>>> lines:
>>>>>>
>>>>>>   NC_GLOBAL#CEN_LAT=-8.4095154
>>>>>>   NC_GLOBAL#CEN_LON=115.02
>>>>>>   NC_GLOBAL#MAP_PROJ=3 (Mercator)
>>>>>>   NC_GLOBAL#MOAD_CEN_LAT=-8.4095078
>>>>>>    NC_GLOBAL#STAND_LON=115.02
>>>>>>   NC_GLOBAL#TRUELAT1=-8.4095001
>>>>>>
>>>>>> but obviously this is not being interpreted or used.
>>>>>>
>>>>>> Trying to use gdalwarp:
>>>>>>
>>>>>> lees-mbp:full Lee$ gdalwarp NETCDF:test_full.nc:HGT test_full_HGT.tif
>>>>>> Warning 1: No UNIDATA NC_GLOBAL:Conventions attribute
>>>>>> ERROR 1: Unable to compute a transformation between pixel/line
>>>>>> and georeferenced coordinates for NETCDF:test_full.nc:HGT.
>>>>>> There is no affine transformation and no GCPs.
>>>>>>
>>>>>> Can anyone explain what I need to do?
>>>>>>
>>>>>> Thanks,
>>>>>> Lee
>>>>>>
>>>>>>
>>>>>> _______________________________________________
>>>>>> gdal-dev mailing list
>>>>>> gdal-dev at lists.osgeo.org
>>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>>>
>>>>>
>>>>>
>>>>> _______________________________________________
>>>>> gdal-dev mailing list
>>>>> gdal-dev at lists.osgeo.org
>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>>
>>>>
>>>>
>>>>
>>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131126/eaf1c354/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: read_wrf_netcdf_U10.py
Type: text/x-python-script
Size: 1837 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131126/eaf1c354/attachment-0001.bin>

From even.rouault at mines-paris.org  Tue Nov 26 05:55:43 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 26 Nov 2013 14:55:43 +0100
Subject: [gdal-dev] Error when appending non-spatial tables in GML to
	PostGIS
In-Reply-To: <CACcwLY88VC3wfq7LXBWLWE51O94Ez-YiPzmoxHGFx9Qb85mcuQ@mail.gmail.com>
References: <CACcwLY88VC3wfq7LXBWLWE51O94Ez-YiPzmoxHGFx9Qb85mcuQ@mail.gmail.com>
Message-ID: <1385474143.5294a85fc62d1@imp.free.fr>

Selon Matt Walker <walkermatt at longwayaround.org.uk>:

> Hi,
>
> I'm loading some Ordnance Survey ITN GML data into PostgreSQL 9.1 / PostGIS
> 1.5 which contains a number of feature types that are lookups without any
> geometry, the first file loads fine but loading subsequent files using the
> ogr2ogr -append option fails with the error:
>
>     ERROR 1: Layer road already exists, CreateLayer failed.
>     Use the layer creation option OVERWRITE=YES to replace it.
>
> I'm finding that the gfs file generated by OGR sets the geometry type to
> 100 (no geometry), manually editing the gfs file to remove the GeometryType
> element for the lookup feature types works around the error but creates a
> redundant geometry column and an entry in geometry_columns.
>
> I've put further details and two sample gml files containing a single
> "feature" in each here: https://gist.github.com/walkermatt/7655745
>
> Happy to create at ticket if it's appropriate.

You probably need to add "--config PG_LIST_ALL_TABLES YES" on the command line
so that the table without geometry is correctly loaded (after it has been
created). By default only registered spatial tables are recognized. See
http://gdal.org/ogr/drv_pg_advanced.html
The .gfs hack is likely unnecessary.

>
> Thanks,
>
> Matt
>
> --
> Matt Walker
> Astun Technology
> @_walkermatt
>



From james at agritech.co.uk  Tue Nov 26 07:50:19 2013
From: james at agritech.co.uk (JSz)
Date: Tue, 26 Nov 2013 07:50:19 -0800 (PST)
Subject: [gdal-dev] Using GDALWARP to crop to extremeties of source data
Message-ID: <1385481019193-5091315.post@n6.nabble.com>

I am using GDAL_grid to create a raster image using the command :

*gdal_grid -a invdist:power=2:smoothing=0.001:radius1=0.0005:radius2=0.0005
-of GTiff -zField a_field -ot Float64 -l data data_source.vrt results.tiff*

which obviously extrapolates the data beyond the extremities of my data, I
can cut the required data with a shape file by using :

*gdalwarp -cutline <<src_shape>> -crop_to_cutline -srcnodata 0 source.tiff
output.tiff*

However is there a way to cut to the extremities of my original data without
the need for the shape file?

Many thanks

JSz





--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Using-GDALWARP-to-crop-to-extremeties-of-source-data-tp5091315.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From etourigny.dev at gmail.com  Tue Nov 26 13:49:38 2013
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Tue, 26 Nov 2013 19:49:38 -0200
Subject: [gdal-dev] WRF NetCDF import
In-Reply-To: <CAHmmfARpxD0CF=cjXGty=fGSMVX2OFzGjZehC5H_J9ULUERRpg@mail.gmail.com>
References: <CAHmmfARq2aWy3OsqFce+YDBCmANH9+y8zzTEB_JS7zdFQeMRSQ@mail.gmail.com>
	<CA+TxYvNvXLXuLEx99dm6uLZLqiFPr08itS6Gr4X6+6MYJs8zqQ@mail.gmail.com>
	<CAJx2nokEViqKsqK4AmUmar+L=z4_MurQseB7CeyDJrGqM6ZoHA@mail.gmail.com>
	<CA+TxYvOYgVymSTUYtWnLrW-0bz7-khhMnv3g=60J=p23a1BFgg@mail.gmail.com>
	<CAHmmfAQosB+3MwYz4PQ3E6wtdAS44yd1nQi0FFvow_ou70vfdw@mail.gmail.com>
	<CAHmmfAT7hRdYutmHW1ZRGvyUfrUhhP6Xh8RjBthny3TNZqrCZg@mail.gmail.com>
	<CAJx2nomc5e8494ZVwhw_BczENfJmRXT2NGSJoAZqHwcX4gdm6A@mail.gmail.com>
	<CAHmmfARpxD0CF=cjXGty=fGSMVX2OFzGjZehC5H_J9ULUERRpg@mail.gmail.com>
Message-ID: <CA+TxYvMWMqENJ1Ye6Fvpa6zcqkOC_cTqX-tCqARqQDvQ5_QUvg@mail.gmail.com>

On Tue, Nov 26, 2013 at 8:32 AM, Lee Eddington <lee.w.eddington at gmail.com>wrote:

> Roger,
>
> Attached is the script I'm using.
>
> Here are the results from gdalinfo on the output file:
>
> lees-mbp:full Lee$ gdalinfo u10_2013112018.tif
> Driver: GTiff/GeoTIFF
> Files: u10_2013112018.tif
> Size is 198, 153
> Coordinate System is:
> PROJCS["unnamed",
>     GEOGCS["unknown",
>         DATUM["unknown",
>             SPHEROID["unretrievable - using WGS84",6378137,298.257223563]],
>         PRIMEM["Greenwich",0],
>         UNIT["degree",0.0174532925199433]],
>     PROJECTION["Mercator_1SP"],
>     PARAMETER["central_meridian",115.02],
>     PARAMETER["scale_factor",0.9893189261265199],
>     PARAMETER["false_easting",0],
>     PARAMETER["false_northing",0],
>     UNIT["metre",1,
>         AUTHORITY["EPSG","9001"]]]
> Origin = (-295898.731194700172637,-696504.655801336281002)
> Pixel Size = (2988.872338323183612,-2964.865850256682734)
> Metadata:
>   AREA_OR_POINT=Area
> Image Structure Metadata:
>   INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  ( -295898.731, -696504.656) (112d19'59.51"E,  6d21'13.48"S)
> Lower Left  ( -295898.731,-1150129.131) (112d19'59.51"E, 10d27'15.97"S)
> Upper Right (  295897.992, -696504.656) (117d42'24.46"E,  6d21'13.48"S)
> Lower Right (  295897.992,-1150129.131) (117d42'24.46"E, 10d27'15.97"S)
> Center      (      -0.370, -923316.893) (115d 1'11.99"E,  8d24'34.51"S)
> Band 1 Block=198x10 Type=Float32, ColorInterp=Gray
>
>
> When I import this into GRASS I get coordinates of meters instead of
> lat/lon degrees.  I want to keep the mercator projection of the model and
> not convert to a lat/lon projection.
>

Mercator projection is by definition in linear units (meters, km,
whatever), not angular units (degrees).


> Lee
>
>
>
> On Tue, Nov 26, 2013 at 1:45 AM, Roger Veciana i Rovira <
> rveciana at gmail.com> wrote:
>
>> Lee,
>>
>> If I understand what are you saiying, you have to define a proper
>> projection first:
>>
>> proj_out = osr.SpatialReference()
>> proj_out.ImportFromEPSG(4326)
>>
>> Which will create the lat lon projection you need (using WGS84 datum,
>> maybe this won't be exact in your model). Then, you have to set the
>> geotransform directly in degrees as you want.
>>
>> Roger
>>
>>
>> 2013/11/26 Lee Eddington <lee.w.eddington at gmail.com>
>>
>>> I think I might be getting close.  I found the following which I'm
>>> hoping will create the GeoTiff with angular units of degrees instead of
>>> linear units of meters:
>>>
>>> OGRErr OGRSpatialReference::SetAngularUnits(const char * pszUnitsName,
>>> double dfInRadians
>>> )
>>>
>>> and tried to use it, but don't know the proper pszUnitsName.  I've tried
>>> "degree", "degrees", "DEGREE", "DEGREES", "DEG", "SRS_UA_DEGREE", but
>>> always get a return code of 6 instead of 0.  I can't find a list of names
>>> or any examples of how to use this properly.
>>>
>>>
>>> On Mon, Nov 25, 2013 at 2:00 PM, Lee Eddington <
>>> lee.w.eddington at gmail.com> wrote:
>>>
>>>> Roger,
>>>>
>>>> Thank you for the info and link.  Using a modified version of your code
>>>> I was able to create and import into GRASS a GeoTIFF with the proper
>>>> georeferencing.  The coordinate system units are in meters though, and I'd
>>>> prefer to have them in degrees lat/lon.  Do you know if there's a way to
>>>> specify that using the oar or gdal routines in your code?
>>>>
>>>> Thanks,
>>>> Lee
>>>>
>>>>
>>>>
>>>> On Mon, Nov 25, 2013 at 10:23 AM, Etienne Tourigny <
>>>> etourigny.dev at gmail.com> wrote:
>>>>
>>>>> Forwarding to the list and others...
>>>>>
>>>>> ---------- Forwarded message ----------
>>>>> From: Roger Veciana i Rovira <rveciana at gmail.com>
>>>>> Date: Mon, Nov 25, 2013 at 9:35 AM
>>>>> Subject: Re: [gdal-dev] WRF NetCDF import
>>>>> To: Etienne Tourigny <etourigny.dev at gmail.com>
>>>>>
>>>>>
>>>>> As Etienne told you, the geotransform and projection from your files
>>>>> is not in the format that GDAL can understand.
>>>>> I wrote a script that reads the projection and calculates the
>>>>> geotransform to save it in a GeoTIFF file:
>>>>>
>>>>>
>>>>> http://geoexamples.blogspot.com.es/2013/09/reading-wrf-netcdf-files-with-gdal.html
>>>>>
>>>>> The script also interpolates the WRF sigma levels to the desired
>>>>> pressure level, so you will have to look for the functions that you need.
>>>>>
>>>>> Anyway, the solution is quite complicated, and using cdo, nco or other
>>>>> tools (I use ARWPost) may be easier.
>>>>>
>>>>> Roger
>>>>>
>>>>>
>>>>> 2013/11/24 Etienne Tourigny <etourigny.dev at gmail.com>
>>>>>
>>>>>> The "georeferencing info" you refer to is non-standard, and GDAL
>>>>>> cannot use that. It (and presumably the grass provider, although I don't
>>>>>> know) use the CF standard for encoding lat/lon information. what is the
>>>>>> output of
>>>>>> gdalinfo NETCDF:test_full.nc:HGT
>>>>>>
>>>>>> I don't know how the grass provider deals with subdatasets, but if
>>>>>> you open the file in qgis (using the gdal provider, it will sllow you to
>>>>>> select the subdataset you want).
>>>>>>
>>>>>> You could also extract the variable with another tool like cdo or nco.
>>>>>>
>>>>>> Etienne
>>>>>>
>>>>>>
>>>>>>
>>>>>> On Sat, Nov 23, 2013 at 7:47 PM, Lee Eddington <
>>>>>> lee.w.eddington at gmail.com> wrote:
>>>>>>
>>>>>>> I'm trying to use r.in.gdal in GRASS GIS to import Weather Research
>>>>>>> & Forecasting (WRF) model NetCDF output.  There have been some tips
>>>>>>> provided by the GRASS users list, but none have worked for me.  I can
>>>>>>> import the data as a simple x,y array with no georeferencing, but
>>>>>>> information about georeferencing is in the file as other programs read,
>>>>>>> georeference and display the file correctly.
>>>>>>>
>>>>>>> gdalinfo produces the following:
>>>>>>>
>>>>>>> lees-mbp:full Lee$ gdalinfo test_full.nc
>>>>>>> Warning 1: No UNIDATA NC_GLOBAL:Conventions attribute
>>>>>>>  Driver: netCDF/Network Common Data Format
>>>>>>> Files: test_full.nc
>>>>>>> Size is 512, 512
>>>>>>> Coordinate System is `'
>>>>>>> Metadata:
>>>>>>>   NC_GLOBAL#BL_PBL_PHYSICS=1
>>>>>>>   NC_GLOBAL#BOTTOM-TOP_GRID_DIMENSION=28
>>>>>>>   NC_GLOBAL#BOTTOM-TOP_PATCH_END_STAG=28
>>>>>>>   NC_GLOBAL#BOTTOM-TOP_PATCH_END_UNSTAG=27
>>>>>>>   NC_GLOBAL#BOTTOM-TOP_PATCH_START_STAG=1
>>>>>>>   NC_GLOBAL#BOTTOM-TOP_PATCH_START_UNSTAG=1
>>>>>>>   NC_GLOBAL#BUCKET_J=-1
>>>>>>>   NC_GLOBAL#BUCKET_MM=-1
>>>>>>>   NC_GLOBAL#CEN_LAT=-8.4095154
>>>>>>>   NC_GLOBAL#CEN_LON=115.02
>>>>>>>   NC_GLOBAL#CU_PHYSICS=0
>>>>>>>   NC_GLOBAL#DAMP_OPT=0
>>>>>>>   NC_GLOBAL#DAMPCOEF=0.2
>>>>>>>   NC_GLOBAL#DFI_OPT=0
>>>>>>>   NC_GLOBAL#DIFF_6TH_FACTOR=0.12
>>>>>>>   NC_GLOBAL#DIFF_6TH_OPT=0
>>>>>>>   NC_GLOBAL#DIFF_OPT=1
>>>>>>>   NC_GLOBAL#DT=16.666666
>>>>>>>   NC_GLOBAL#DX=3000
>>>>>>>   NC_GLOBAL#DY=3000
>>>>>>>   NC_GLOBAL#FEEDBACK=0
>>>>>>>   NC_GLOBAL#GFDDA_END_H=0
>>>>>>>   NC_GLOBAL#GFDDA_INTERVAL_M=0
>>>>>>>   NC_GLOBAL#GMT=12
>>>>>>>   NC_GLOBAL#GRID_FDDA=0
>>>>>>>   NC_GLOBAL#GRID_ID=3
>>>>>>>   NC_GLOBAL#GRID_SFDDA=0
>>>>>>>   NC_GLOBAL#GRIDTYPE=C
>>>>>>>   NC_GLOBAL#HYPSOMETRIC_OPT=2
>>>>>>>   NC_GLOBAL#I_PARENT_START=34
>>>>>>>   NC_GLOBAL#ISFTCFLX=0
>>>>>>>   NC_GLOBAL#ISHALLOW=0
>>>>>>>   NC_GLOBAL#ISICE=24
>>>>>>>   NC_GLOBAL#ISLAKE=-1
>>>>>>>   NC_GLOBAL#ISOILWATER=14
>>>>>>>   NC_GLOBAL#ISURBAN=1
>>>>>>>   NC_GLOBAL#ISWATER=16
>>>>>>>   NC_GLOBAL#J_PARENT_START=34
>>>>>>>   NC_GLOBAL#JULDAY=324
>>>>>>>   NC_GLOBAL#JULYR=2013
>>>>>>>   NC_GLOBAL#KHDIF=0
>>>>>>>   NC_GLOBAL#KM_OPT=4
>>>>>>>   NC_GLOBAL#KVDIF=0
>>>>>>>   NC_GLOBAL#MAP_PROJ=3
>>>>>>>   NC_GLOBAL#MFSHCONV=0
>>>>>>>   NC_GLOBAL#MMINLU=USGS
>>>>>>>   NC_GLOBAL#MOAD_CEN_LAT=-8.4095078
>>>>>>>   NC_GLOBAL#MOIST_ADV_OPT=1
>>>>>>>   NC_GLOBAL#MP_PHYSICS=3
>>>>>>>   NC_GLOBAL#NUM_LAND_CAT=24
>>>>>>>   NC_GLOBAL#OBS_NUDGE_OPT=0
>>>>>>>   NC_GLOBAL#OMLCALL=0
>>>>>>>   NC_GLOBAL#PARENT_GRID_RATIO=3
>>>>>>>   NC_GLOBAL#PARENT_ID=2
>>>>>>>   NC_GLOBAL#POLE_LAT=90
>>>>>>>   NC_GLOBAL#POLE_LON=0
>>>>>>>   NC_GLOBAL#PREC_ACC_DT=0
>>>>>>>   NC_GLOBAL#RA_LW_PHYSICS=1
>>>>>>>   NC_GLOBAL#RA_SW_PHYSICS=1
>>>>>>>   NC_GLOBAL#SCALAR_ADV_OPT=1
>>>>>>>   NC_GLOBAL#SF_SFCLAY_PHYSICS=1
>>>>>>>   NC_GLOBAL#SF_SURFACE_PHYSICS=2
>>>>>>>   NC_GLOBAL#SF_URBAN_PHYSICS=0
>>>>>>>   NC_GLOBAL#SGFDDA_END_H=0
>>>>>>>   NC_GLOBAL#SGFDDA_INTERVAL_M=0
>>>>>>>   NC_GLOBAL#SHCU_PHYSICS=0
>>>>>>>   NC_GLOBAL#SIMULATION_START_DATE=2013-11-20_12:00:00
>>>>>>>   NC_GLOBAL#SMOOTH_OPTION=0
>>>>>>>   NC_GLOBAL#SOUTH-NORTH_GRID_DIMENSION=154
>>>>>>>   NC_GLOBAL#SOUTH-NORTH_PATCH_END_STAG=154
>>>>>>>   NC_GLOBAL#SOUTH-NORTH_PATCH_END_UNSTAG=153
>>>>>>>   NC_GLOBAL#SOUTH-NORTH_PATCH_START_STAG=1
>>>>>>>   NC_GLOBAL#SOUTH-NORTH_PATCH_START_UNSTAG=1
>>>>>>>   NC_GLOBAL#SST_UPDATE=0
>>>>>>>   NC_GLOBAL#STAND_LON=115.02
>>>>>>>   NC_GLOBAL#START_DATE=2013-11-20_12:00:00
>>>>>>>   NC_GLOBAL#SURFACE_INPUT_SOURCE=1
>>>>>>>   NC_GLOBAL#SWRAD_SCAT=1
>>>>>>>   NC_GLOBAL#TITLE= OUTPUT FROM WRF V3.4 MODEL
>>>>>>>   NC_GLOBAL#TKE_ADV_OPT=1
>>>>>>>   NC_GLOBAL#TRUELAT1=-8.4095001
>>>>>>>   NC_GLOBAL#TRUELAT2=0
>>>>>>>   NC_GLOBAL#W_DAMPING=0
>>>>>>>   NC_GLOBAL#WEST-EAST_GRID_DIMENSION=199
>>>>>>>   NC_GLOBAL#WEST-EAST_PATCH_END_STAG=199
>>>>>>>   NC_GLOBAL#WEST-EAST_PATCH_END_UNSTAG=198
>>>>>>>   NC_GLOBAL#WEST-EAST_PATCH_START_STAG=1
>>>>>>>   NC_GLOBAL#WEST-EAST_PATCH_START_UNSTAG=1
>>>>>>> Subdatasets:
>>>>>>>   SUBDATASET_1_NAME=NETCDF:"test_full.nc":Times
>>>>>>>   SUBDATASET_1_DESC=[1x19] Times (8-bit character)
>>>>>>>   SUBDATASET_2_NAME=NETCDF:"test_full.nc":LU_INDEX
>>>>>>>   SUBDATASET_2_DESC=[1x153x198] LU_INDEX (32-bit floating-point)
>>>>>>>
>>>>>>> (more SUBDATASETs)
>>>>>>>
>>>>>>>   SUBDATASET_106_NAME=NETCDF:"test_full.nc":LANDMASK
>>>>>>>   SUBDATASET_106_DESC=[1x153x198] LANDMASK (32-bit floating-point)
>>>>>>>   SUBDATASET_107_NAME=NETCDF:"test_full.nc":SST
>>>>>>>   SUBDATASET_107_DESC=[1x153x198] SST (32-bit floating-point)
>>>>>>> Corner Coordinates:
>>>>>>> Upper Left  (    0.0,    0.0)
>>>>>>> Lower Left  (    0.0,  512.0)
>>>>>>> Upper Right (  512.0,    0.0)
>>>>>>> Lower Right (  512.0,  512.0)
>>>>>>> Center      (  256.0,  256.0)
>>>>>>>
>>>>>>> My first question is why am I getting the following warning?:
>>>>>>>
>>>>>>> Warning 1: No UNIDATA NC_GLOBAL:Conventions attribute
>>>>>>>
>>>>>>> Next, I see what appears is georeferencing info in the following
>>>>>>> lines:
>>>>>>>
>>>>>>>   NC_GLOBAL#CEN_LAT=-8.4095154
>>>>>>>   NC_GLOBAL#CEN_LON=115.02
>>>>>>>   NC_GLOBAL#MAP_PROJ=3 (Mercator)
>>>>>>>   NC_GLOBAL#MOAD_CEN_LAT=-8.4095078
>>>>>>>    NC_GLOBAL#STAND_LON=115.02
>>>>>>>   NC_GLOBAL#TRUELAT1=-8.4095001
>>>>>>>
>>>>>>> but obviously this is not being interpreted or used.
>>>>>>>
>>>>>>> Trying to use gdalwarp:
>>>>>>>
>>>>>>> lees-mbp:full Lee$ gdalwarp NETCDF:test_full.nc:HGT
>>>>>>> test_full_HGT.tif
>>>>>>> Warning 1: No UNIDATA NC_GLOBAL:Conventions attribute
>>>>>>> ERROR 1: Unable to compute a transformation between pixel/line
>>>>>>> and georeferenced coordinates for NETCDF:test_full.nc:HGT.
>>>>>>> There is no affine transformation and no GCPs.
>>>>>>>
>>>>>>> Can anyone explain what I need to do?
>>>>>>>
>>>>>>> Thanks,
>>>>>>> Lee
>>>>>>>
>>>>>>>
>>>>>>> _______________________________________________
>>>>>>> gdal-dev mailing list
>>>>>>> gdal-dev at lists.osgeo.org
>>>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>>>>
>>>>>>
>>>>>>
>>>>>> _______________________________________________
>>>>>> gdal-dev mailing list
>>>>>> gdal-dev at lists.osgeo.org
>>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>>>
>>>>>
>>>>>
>>>>>
>>>>
>>>
>>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131126/b3d455ba/attachment-0001.html>

From lukepinnerau at gmail.com  Wed Nov 27 00:58:14 2013
From: lukepinnerau at gmail.com (Luke)
Date: Wed, 27 Nov 2013 00:58:14 -0800 (PST)
Subject: [gdal-dev] How to use gdal_rasterize to create a LZW compressed
 Tiff
In-Reply-To: <1385529764328-5091388.post@n6.nabble.com>
References: <1385529764328-5091388.post@n6.nabble.com>
Message-ID: <1385542694985-5091414.post@n6.nabble.com>

See the documentation - http://www.gdal.org/gdal_rasterize.html
The syntax should be -co COMPRESS=LZW

Regards
Luke


gis.postgraduate wrote
> I want to use gdal_rasterize for generating Tiff from shp. Usually the
> result is big, so I try to compress it. Then I come to use the LZW
> compress option.
> I am using a command like this:
> gdal_rasterize.exe -burn 255 -burn 255 -burn 0 -burn 255 -ot Byte -tr
> 0.0332147 0.0332147 shp.shp shp0.tif --config COMPRESS LZW
> but it seems the "--config COMPRESS LZW" option doesn't function.(the
> result is exactly the same size as before.)





--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-How-to-use-gdal-rasterize-to-create-a-LZW-compressed-Tiff-tp5091388p5091414.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From giovanni.leoncini at aspen-re.com  Wed Nov 27 02:50:35 2013
From: giovanni.leoncini at aspen-re.com (zvanaz)
Date: Wed, 27 Nov 2013 02:50:35 -0800 (PST)
Subject: [gdal-dev] cannot read grib1 file, expect PV=255
Message-ID: <1385549435552-5091447.post@n6.nabble.com>

Hello,

when I try to read a specific grib1 file with readGDAL I get this error:
Error in .local(.Object, ...) :
>>  file.grb is a grib file, but no raster dataset was successfully
>> identified.

digging a bit further (Roger, thanks for this!):

gdalinfo --debug on file.grb

I see:

...
Warning: Inside GRIB2Inventory, Message # 50
ERROR: Couldn't find 'GRIB' or 'TDLP'
There were 6 trailing bytes in the file.
Un-handled possible ensemble section center 78 subcenter 255
GRIB: Problems with ReadGrib1Record called by ReadGrib2Record Inside
ReadGrib1Record
GRIB1 GDS: Expect PV = 255 != 43

is there any update on this? or maybe a workaround? sounds like this error
is not uncommon.

any help or hint would be appreciated!
thanks in advance
Giovanni



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/cannot-read-grib1-file-expect-PV-255-tp5091447.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From walkermatt at longwayaround.org.uk  Wed Nov 27 04:32:19 2013
From: walkermatt at longwayaround.org.uk (Matt Walker)
Date: Wed, 27 Nov 2013 12:32:19 +0000
Subject: [gdal-dev] Error when appending non-spatial tables in GML to
	PostGIS
In-Reply-To: <1385474143.5294a85fc62d1@imp.free.fr>
References: <CACcwLY88VC3wfq7LXBWLWE51O94Ez-YiPzmoxHGFx9Qb85mcuQ@mail.gmail.com>
	<1385474143.5294a85fc62d1@imp.free.fr>
Message-ID: <CACcwLY852BsQRDG9TXRgbU_uq=TL_UUjHrtMrspDrFAOZFva3g@mail.gmail.com>

Thanks Even, that was exactly what I needed. I'm now able to load the
lookup tables successfully thanks for your help.


On 26 November 2013 13:55, Even Rouault <even.rouault at mines-paris.org>wrote:

> Selon Matt Walker <walkermatt at longwayaround.org.uk>:
>
> > Hi,
> >
> > I'm loading some Ordnance Survey ITN GML data into PostgreSQL 9.1 /
> PostGIS
> > 1.5 which contains a number of feature types that are lookups without any
> > geometry, the first file loads fine but loading subsequent files using
> the
> > ogr2ogr -append option fails with the error:
> >
> >     ERROR 1: Layer road already exists, CreateLayer failed.
> >     Use the layer creation option OVERWRITE=YES to replace it.
> >
> > I'm finding that the gfs file generated by OGR sets the geometry type to
> > 100 (no geometry), manually editing the gfs file to remove the
> GeometryType
> > element for the lookup feature types works around the error but creates a
> > redundant geometry column and an entry in geometry_columns.
> >
> > I've put further details and two sample gml files containing a single
> > "feature" in each here: https://gist.github.com/walkermatt/7655745
> >
> > Happy to create at ticket if it's appropriate.
>
> You probably need to add "--config PG_LIST_ALL_TABLES YES" on the command
> line
> so that the table without geometry is correctly loaded (after it has been
> created). By default only registered spatial tables are recognized. See
> http://gdal.org/ogr/drv_pg_advanced.html
> The .gfs hack is likely unnecessary.
>
> >
> > Thanks,
> >
> > Matt
> >
> > --
> > Matt Walker
> > Astun Technology
> > @_walkermatt
> >
>
>
>


-- 
Matt Walker
@_walkermatt
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131127/03343c59/attachment.html>

From jonathanmoules at warwickshire.gov.uk  Wed Nov 27 08:02:53 2013
From: jonathanmoules at warwickshire.gov.uk (Jonathan Moules)
Date: Wed, 27 Nov 2013 16:02:53 +0000
Subject: [gdal-dev] How to get GDAL
Message-ID: <CAA-xNcVGQfMoNyg0dqhk=1v4Sw1SS-V=QA_6m3q0epcZJvKJ6A@mail.gmail.com>

Hi List,
I'm bringing this one over from the GeoServer-Users list. Basically I can't
for the life of me get a good install of GDAL for Windows where everything
*just works*.

To date I've tried:
http://gisinternals.com/SDK/P
 - But there are far too many options and I can never be sure I'm getting
the right thing (the page assumes a significant level of knowledge about
what package is what). In the end I just go with -
http://gisinternals.com/SDK/PackageList.aspx?file=release-1600-x64-gdal-1-10-mapserver-6-4.zip
 - From there I've tried both the msi (plus python bindings extra) and the
zip "Compiled binaries in a single .zip package"- both work for the
pure-GDAL stuff (gdalinfo) but none of the python scripts works (i.e.
gdal_merge.py).

====
I found FWTools - http://fwtools.maptools.org/ - except that it seems to be
an outdated version of GDAL so I'm hitting some GDAL bugs there that I
think are since fixed.

====
The QGIS version comes with all manner of environmental variable issues
that stop it from working stand-alone for me.

====
I think I may have tried the version that comes with FME too, but similar
issues.

So in short, where can I go to find a pre-compiled (Windows, ideally 64bit)
version of GDAL that Just Works?

Thanks,
Jonathan

-- 
This transmission is intended for the named addressee(s) only and may 
contain sensitive or protectively marked material up to RESTRICTED and 
should be handled accordingly. Unless you are the named addressee (or 
authorised to receive it for the addressee) you may not copy or use it, or 
disclose it to anyone else. If you have received this transmission in error 
please notify the sender immediately. All email traffic sent to or from us, 
including without limitation all GCSX traffic, may be subject to recording 
and/or monitoring in accordance with relevant legislation.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131127/539e53e8/attachment.html>

From mateusz at loskot.net  Wed Nov 27 08:15:11 2013
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed, 27 Nov 2013 16:15:11 +0000
Subject: [gdal-dev] How to get GDAL
In-Reply-To: <CAA-xNcVGQfMoNyg0dqhk=1v4Sw1SS-V=QA_6m3q0epcZJvKJ6A@mail.gmail.com>
References: <CAA-xNcVGQfMoNyg0dqhk=1v4Sw1SS-V=QA_6m3q0epcZJvKJ6A@mail.gmail.com>
Message-ID: <CABUeae_=vUh20r9KB+62PPyRGfOJHeWYowAdC_AL0=2pe9mkTQ@mail.gmail.com>

On 27 November 2013 16:02, Jonathan Moules
<jonathanmoules at warwickshire.gov.uk> wrote:
> So in short, where can I go to find a pre-compiled (Windows, ideally 64bit)
> version of GDAL that Just Works?

http://trac.osgeo.org/osgeo4w/

Best regards,
-- 
Mateusz  Loskot, http://mateusz.loskot.net

From jonathanmoules at warwickshire.gov.uk  Wed Nov 27 08:30:05 2013
From: jonathanmoules at warwickshire.gov.uk (Jonathan Moules)
Date: Wed, 27 Nov 2013 16:30:05 +0000
Subject: [gdal-dev] How to get GDAL
In-Reply-To: <CABUeae_=vUh20r9KB+62PPyRGfOJHeWYowAdC_AL0=2pe9mkTQ@mail.gmail.com>
References: <CAA-xNcVGQfMoNyg0dqhk=1v4Sw1SS-V=QA_6m3q0epcZJvKJ6A@mail.gmail.com>
	<CABUeae_=vUh20r9KB+62PPyRGfOJHeWYowAdC_AL0=2pe9mkTQ@mail.gmail.com>
Message-ID: <CAA-xNcX=LWvRGrqz+X2JvXUCj5h4g2uaK0r-Uiw7yG1=LCNpRA@mail.gmail.com>

Wow, that actually worked!
/me is pleasantly surprised. :-)

Thanks!



On 27 November 2013 16:15, Mateusz Loskot <mateusz at loskot.net> wrote:

> On 27 November 2013 16:02, Jonathan Moules
> <jonathanmoules at warwickshire.gov.uk> wrote:
> > So in short, where can I go to find a pre-compiled (Windows, ideally
> 64bit)
> > version of GDAL that Just Works?
>
> http://trac.osgeo.org/osgeo4w/
>
> Best regards,
> --
> Mateusz  Loskot, http://mateusz.loskot.net
>

-- 
This transmission is intended for the named addressee(s) only and may 
contain sensitive or protectively marked material up to RESTRICTED and 
should be handled accordingly. Unless you are the named addressee (or 
authorised to receive it for the addressee) you may not copy or use it, or 
disclose it to anyone else. If you have received this transmission in error 
please notify the sender immediately. All email traffic sent to or from us, 
including without limitation all GCSX traffic, may be subject to recording 
and/or monitoring in accordance with relevant legislation.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131127/edf57ecb/attachment.html>

From andre+joost at nurfuerspam.de  Wed Nov 27 12:30:45 2013
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Wed, 27 Nov 2013 21:30:45 +0100
Subject: [gdal-dev] How to get GDAL
In-Reply-To: <CAA-xNcVGQfMoNyg0dqhk=1v4Sw1SS-V=QA_6m3q0epcZJvKJ6A@mail.gmail.com>
References: <CAA-xNcVGQfMoNyg0dqhk=1v4Sw1SS-V=QA_6m3q0epcZJvKJ6A@mail.gmail.com>
Message-ID: <l75ktj$96k$1@ger.gmane.org>

Am 27.11.2013 17:02, schrieb Jonathan Moules:

>
> To date I've tried:
> http://gisinternals.com/SDK/P
>   - But there are far too many options and I can never be sure I'm getting
> the right thing (the page assumes a significant level of knowledge about
> what package is what). In the end I just go with -
> http://gisinternals.com/SDK/PackageList.aspx?file=release-1600-x64-gdal-1-10-mapserver-6-4.zip

should be a good choice.

>   - From there I've tried both the msi (plus python bindings extra) and the
> zip "Compiled binaries in a single .zip package"- both work for the
> pure-GDAL stuff (gdalinfo) but none of the python scripts works (i.e.
> gdal_merge.py).

I prefer the zip version, expand it to a folder of my choice, and run 
the SDKshell.bat. In the command window I can do the things I want to do 
in GDAL, without any interfering of other programms, even not from QGIS. 
Inside the shell, all varaibles are set correctly, and therefore all 
python modules run too.
And it is no problem installing an experimental new GDAL version and 
keeping the old one in parallel.


>
> ====
> I found FWTools - http://fwtools.maptools.org/ - except that it seems to be
> an outdated version of GDAL so I'm hitting some GDAL bugs there that I
> think are since fixed.

True. For get it.

>
> ====
> The QGIS version comes with all manner of environmental variable issues
> that stop it from working stand-alone for me.

Same as gisinternals: You get an OSGEo4w shell icon, and inside that do 
what you want at command level. That works with standalone and OSGeo4W 
installer. Inside the shell, the environmental variables are set correctly.

HTH,
Andr? Joost



From rlpires at gmail.com  Thu Nov 28 01:51:17 2013
From: rlpires at gmail.com (Rui L. Pires)
Date: Thu, 28 Nov 2013 10:51:17 +0100
Subject: [gdal-dev] LAS support
Message-ID: <CAP6xJca1TGozsUYeocU-++LP4YVErDtv4jcbRgt3gEZMyaXAWQ@mail.gmail.com>

Hello everyone,

Is there any interest in having LAS as one of the OGR supported formats?

Would there be any particular reason for not supporting it?

I would be willing to collaborate on this effort, if deemed useful.

Regards,
Rui
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131128/977526e6/attachment.html>

From mateusz at loskot.net  Thu Nov 28 02:03:10 2013
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu, 28 Nov 2013 10:03:10 +0000
Subject: [gdal-dev] LAS support
In-Reply-To: <CAP6xJca1TGozsUYeocU-++LP4YVErDtv4jcbRgt3gEZMyaXAWQ@mail.gmail.com>
References: <CAP6xJca1TGozsUYeocU-++LP4YVErDtv4jcbRgt3gEZMyaXAWQ@mail.gmail.com>
Message-ID: <CABUeae8dVBbEW=mUr_=XKvv4RenxYVwsbsUJOWW1smCGDR7=ug@mail.gmail.com>

On 28 November 2013 09:51, Rui L. Pires <rlpires at gmail.com> wrote:
> Hello everyone,
>
> Is there any interest in having LAS as one of the OGR supported formats?

It's been discussed:

http://lists.osgeo.org/pipermail/gdal-dev/2011-April/028439.html

> Would there be any particular reason for not supporting it?

Point cloud is not a vector, not a raster either? :-)

Best regards,
-- 
Mateusz  Loskot, http://mateusz.loskot.net

From yehil at rafael.co.il  Thu Nov 28 02:13:14 2013
From: yehil at rafael.co.il (Livneh Yehiyam)
Date: Thu, 28 Nov 2013 12:13:14 +0200
Subject: [gdal-dev] HRE (High resolution elevation) format
Message-ID: <C5D1974ECA44D2429ECBC64B967C34C0D03346243D@MAILBOXSERVER.rf.local>


Hi
Is there support in gdal for reading elevation in HRE format?

Thanks
Yehiyam Livneh


________________________________________

This message (including any attachments) issued by RAFAEL- ADVANCED DEFENSE SYSTEMS LTD. (hereinafter "RAFAEL") contains confidential information intended for a specific individual and purpose, may constitute information that is privileged or confidential or otherwise protected from disclosure. If you are not the intended recipient, you should contact us immediately and thereafter delete this message from your system. You are hereby notified that any disclosure, copying, dissemination, distribution or forwarding of this message, or the taking of any action based on it, is strictly prohibited. If you have received this e-mail in error, please notify us immediately by e-mail mailto:lawraf at rafael.co.il and completely delete or destroy any and all electronic or other copies of the original message and any attachments thereof.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131128/0d84ce3b/attachment.html>

From jonathanmoules at warwickshire.gov.uk  Thu Nov 28 03:34:25 2013
From: jonathanmoules at warwickshire.gov.uk (Jonathan Moules)
Date: Thu, 28 Nov 2013 11:34:25 +0000
Subject: [gdal-dev] How to get GDAL
In-Reply-To: <l75ktj$96k$1@ger.gmane.org>
References: <CAA-xNcVGQfMoNyg0dqhk=1v4Sw1SS-V=QA_6m3q0epcZJvKJ6A@mail.gmail.com>
	<l75ktj$96k$1@ger.gmane.org>
Message-ID: <CAA-xNcWvUw9bkutBPiNWhz43vTRrMGs5FVpr5asygsP7_7qFuA@mail.gmail.com>

>    - From there I've tried both the msi (plus python bindings extra) and
>> the
>> zip "Compiled binaries in a single .zip package"- both work for the
>> pure-GDAL stuff (gdalinfo) but none of the python scripts works (i.e.
>> gdal_merge.py).
>>
>
> I prefer the zip version, expand it to a folder of my choice, and run the
> SDKshell.bat. In the command window I can do the things I want to do in
> GDAL, without any interfering of other programms, even not from QGIS.
> Inside the shell, all varaibles are set correctly, and therefore all python
> modules run too.
> And it is no problem installing an experimental new GDAL version and
> keeping the old one in parallel.


That would be my preferred option, but as noted, the python stuff doesn't
work. I was getting a python error whenever I tried to run them.

Fortunately the OSGeo4W version works fine.
Cheers,
Jonathan

-- 
This transmission is intended for the named addressee(s) only and may 
contain sensitive or protectively marked material up to RESTRICTED and 
should be handled accordingly. Unless you are the named addressee (or 
authorised to receive it for the addressee) you may not copy or use it, or 
disclose it to anyone else. If you have received this transmission in error 
please notify the sender immediately. All email traffic sent to or from us, 
including without limitation all GCSX traffic, may be subject to recording 
and/or monitoring in accordance with relevant legislation.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131128/699a3f94/attachment.html>

From even.rouault at mines-paris.org  Thu Nov 28 04:00:26 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 28 Nov 2013 13:00:26 +0100
Subject: [gdal-dev] HRE (High resolution elevation) format
In-Reply-To: <C5D1974ECA44D2429ECBC64B967C34C0D03346243D@MAILBOXSERVER.rf.local>
References: <C5D1974ECA44D2429ECBC64B967C34C0D03346243D@MAILBOXSERVER.rf.local>
Message-ID: <201311281300.27389.even.rouault@mines-paris.org>

Le jeudi 28 novembre 2013 11:13:14, Livneh Yehiyam a ?crit :
> Hi
> Is there support in gdal for reading elevation in HRE format?

If you are thinking to NITF HRE, yes, as indicated in 
http://www.gdal.org/frmt_nitf.html

> 
> Thanks
> Yehiyam Livneh
> 
> 
> ________________________________________
> 
> This message (including any attachments) issued by RAFAEL- ADVANCED DEFENSE
> SYSTEMS LTD. (hereinafter "RAFAEL") contains confidential information
> intended for a specific individual and purpose, may constitute information
> that is privileged or confidential or otherwise protected from disclosure.
> If you are not the intended recipient, you should contact us immediately
> and thereafter delete this message from your system. You are hereby
> notified that any disclosure, copying, dissemination, distribution or
> forwarding of this message, or the taking of any action based on it, is
> strictly prohibited. If you have received this e-mail in error, please
> notify us immediately by e-mail mailto:lawraf at rafael.co.il and completely
> delete or destroy any and all electronic or other copies of the original
> message and any attachments thereof.

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From rlpires at gmail.com  Thu Nov 28 05:56:47 2013
From: rlpires at gmail.com (Rui L. Pires)
Date: Thu, 28 Nov 2013 14:56:47 +0100
Subject: [gdal-dev] LAS support
In-Reply-To: <CABUeae8dVBbEW=mUr_=XKvv4RenxYVwsbsUJOWW1smCGDR7=ug@mail.gmail.com>
References: <CAP6xJca1TGozsUYeocU-++LP4YVErDtv4jcbRgt3gEZMyaXAWQ@mail.gmail.com>
	<CABUeae8dVBbEW=mUr_=XKvv4RenxYVwsbsUJOWW1smCGDR7=ug@mail.gmail.com>
Message-ID: <CAP6xJcZacZtwHwLJ_7=jJszGEJoHPLSfG1RvYVSAygRRJnMh3A@mail.gmail.com>

On 28 November 2013 11:03, Mateusz Loskot <mateusz at loskot.net> wrote:

> On 28 November 2013 09:51, Rui L. Pires <rlpires at gmail.com> wrote:
> > Hello everyone,
> >
> > Is there any interest in having LAS as one of the OGR supported formats?
>
> It's been discussed:
>
> http://lists.osgeo.org/pipermail/gdal-dev/2011-April/028439.html
>

Fair enough.


> > Would there be any particular reason for not supporting it?
>
> Point cloud is not a vector, not a raster either? :-)
>

That might be debatable, but it won't be me reopening that discussion.
Having said that, if you could assure me that all formats supported in
http://www.gdal.org/ogr/ogr_formats.html are vector formats, I would have
understood your point (of not offering a LAS driver).

Regards,
Rui


On 28 November 2013 11:03, Mateusz Loskot <mateusz at loskot.net> wrote:

> On 28 November 2013 09:51, Rui L. Pires <rlpires at gmail.com> wrote:
> > Hello everyone,
> >
> > Is there any interest in having LAS as one of the OGR supported formats?
>
> It's been discussed:
>
> http://lists.osgeo.org/pipermail/gdal-dev/2011-April/028439.html
>
> > Would there be any particular reason for not supporting it?
>
> Point cloud is not a vector, not a raster either? :-)
>
> Best regards,
> --
> Mateusz  Loskot, http://mateusz.loskot.net
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131128/d34640f4/attachment-0001.html>

From mateusz at loskot.net  Thu Nov 28 06:09:42 2013
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu, 28 Nov 2013 14:09:42 +0000
Subject: [gdal-dev] LAS support
In-Reply-To: <CAP6xJcZacZtwHwLJ_7=jJszGEJoHPLSfG1RvYVSAygRRJnMh3A@mail.gmail.com>
References: <CAP6xJca1TGozsUYeocU-++LP4YVErDtv4jcbRgt3gEZMyaXAWQ@mail.gmail.com>
	<CABUeae8dVBbEW=mUr_=XKvv4RenxYVwsbsUJOWW1smCGDR7=ug@mail.gmail.com>
	<CAP6xJcZacZtwHwLJ_7=jJszGEJoHPLSfG1RvYVSAygRRJnMh3A@mail.gmail.com>
Message-ID: <CABUeae_9tNe4gZ-87Ks3jJEU97DZFOyDQX5OrwBDJYQ+OT-jhw@mail.gmail.com>

On 28 November 2013 13:56, Rui L. Pires <rlpires at gmail.com> wrote:
> On 28 November 2013 11:03, Mateusz Loskot <mateusz at loskot.net> wrote:
>> On 28 November 2013 09:51, Rui L. Pires <rlpires at gmail.com> wrote:
>> >
>> > Would there be any particular reason for not supporting it?
>>
>> Point cloud is not a vector, not a raster either? :-)
>
>
> That might be debatable, but it won't be me reopening that discussion.
> Having said that, if you could assure me that all formats supported in
> http://www.gdal.org/ogr/ogr_formats.html are vector formats, I would have
> understood your point (of not offering a LAS driver).

Rui,

I intentionally put question mark to indicate it's open question for me as well.
The nature of LiDAR data might be confusing and I'm interested to
learn more about it.
Dale Lutz said, "point cloud is a badly behaved raster".
I (used to) say, it's not a vector.
But I still haven't found clear answer "what is it" really :)

Best regards,
-- 
Mateusz  Loskot, http://mateusz.loskot.net

From fabian.schindler at eox.at  Thu Nov 28 06:14:14 2013
From: fabian.schindler at eox.at (Fabian Schindler)
Date: Thu, 28 Nov 2013 15:14:14 +0100
Subject: [gdal-dev] LAS support
In-Reply-To: <CABUeae_9tNe4gZ-87Ks3jJEU97DZFOyDQX5OrwBDJYQ+OT-jhw@mail.gmail.com>
References: <CAP6xJca1TGozsUYeocU-++LP4YVErDtv4jcbRgt3gEZMyaXAWQ@mail.gmail.com>	<CABUeae8dVBbEW=mUr_=XKvv4RenxYVwsbsUJOWW1smCGDR7=ug@mail.gmail.com>	<CAP6xJcZacZtwHwLJ_7=jJszGEJoHPLSfG1RvYVSAygRRJnMh3A@mail.gmail.com>
	<CABUeae_9tNe4gZ-87Ks3jJEU97DZFOyDQX5OrwBDJYQ+OT-jhw@mail.gmail.com>
Message-ID: <52974FB6.9020800@eox.at>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Rui,

IMHO point clouds are special form of vector data. But still, an OGR
driver would not be a viable solution.

Did you have a look at PDAL (http://www.pointcloud.org/)? It is
similar to GDAL and seems to have a built-in driver for LAS files.

regards,
Fabian

On 11/28/2013 03:09 PM, Mateusz Loskot wrote:
> On 28 November 2013 13:56, Rui L. Pires <rlpires at gmail.com> wrote:
>> On 28 November 2013 11:03, Mateusz Loskot <mateusz at loskot.net>
>> wrote:
>>> On 28 November 2013 09:51, Rui L. Pires <rlpires at gmail.com>
>>> wrote:
>>>> 
>>>> Would there be any particular reason for not supporting it?
>>> 
>>> Point cloud is not a vector, not a raster either? :-)
>> 
>> 
>> That might be debatable, but it won't be me reopening that
>> discussion. Having said that, if you could assure me that all
>> formats supported in http://www.gdal.org/ogr/ogr_formats.html are
>> vector formats, I would have understood your point (of not
>> offering a LAS driver).
> 
> Rui,
> 
> I intentionally put question mark to indicate it's open question
> for me as well. The nature of LiDAR data might be confusing and I'm
> interested to learn more about it. Dale Lutz said, "point cloud is
> a badly behaved raster". I (used to) say, it's not a vector. But I
> still haven't found clear answer "what is it" really :)
> 
> Best regards,
> 

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://www.enigmail.net/

iQEcBAEBAgAGBQJSl0+2AAoJEJoaok7HgajKZkkH/jZ/zxIjsth8OTcDEWFMmaP4
Szn2fL8oGRWnjtM0XRlRWxG1HHJ6o0ZrggjSnEa1DFr98RzXftv0ruknyj99ns5K
dBAdmksXlxGBz4KKdF609TFTgVgT9HyTObuNiqIxklyi8rN/XZBk+mfpQZpNBU3W
/IdXkrvBDWTYAh6YOWfXN+XQkeLpwfRsYk6m+UZRXSzYJdQrphsuUtXQrWJnoE68
9GDDZGgzyBlYiAXYt4nr0rNzvt367J7gXJd8h8Nyrgc3A+btyOjOZ1Jjs06TZGuE
ecM1F9wYARglZ+w6H865asGiJ4r54E2xpakMjgvwD5KTRrNZu6RbE31Tn1hI1ho=
=+UCc
-----END PGP SIGNATURE-----

From jluis at ualg.pt  Thu Nov 28 06:28:44 2013
From: jluis at ualg.pt (Joaquim Luis)
Date: Thu, 28 Nov 2013 14:28:44 +0000
Subject: [gdal-dev] LAS support
In-Reply-To: <52974FB6.9020800@eox.at>
References: <CAP6xJca1TGozsUYeocU-++LP4YVErDtv4jcbRgt3gEZMyaXAWQ@mail.gmail.com>	<CABUeae8dVBbEW=mUr_=XKvv4RenxYVwsbsUJOWW1smCGDR7=ug@mail.gmail.com>	<CAP6xJcZacZtwHwLJ_7=jJszGEJoHPLSfG1RvYVSAygRRJnMh3A@mail.gmail.com>
	<CABUeae_9tNe4gZ-87Ks3jJEU97DZFOyDQX5OrwBDJYQ+OT-jhw@mail.gmail.com>
	<52974FB6.9020800@eox.at>
Message-ID: <5297531C.4020200@ualg.pt>


> IMHO point clouds are special form of vector data. But still, an OGR
> driver would not be a viable solution.

... or as already mentioned of rasters (or grids as I prefer to call 
them when they are so).
By accident I found that that grids stored as XYZ in laszip are 3 times 
smaller than the same grid in netCDF with a deflation level of 9 (the 
maximum).
That makes it a REALLY interesting grid storage format.

Joaquim

>
> Did you have a look at PDAL (http://www.pointcloud.org/)? It is
> similar to GDAL and seems to have a built-in driver for LAS files.
>
> regards,
> Fabian
>
> On 11/28/2013 03:09 PM, Mateusz Loskot wrote:
>> On 28 November 2013 13:56, Rui L. Pires<rlpires at gmail.com>  wrote:
>>> On 28 November 2013 11:03, Mateusz Loskot<mateusz at loskot.net>
>>> wrote:
>>>> On 28 November 2013 09:51, Rui L. Pires<rlpires at gmail.com>
>>>> wrote:
>>>>> Would there be any particular reason for not supporting it?
>>>> Point cloud is not a vector, not a raster either? :-)
>>>
>>> That might be debatable, but it won't be me reopening that
>>> discussion. Having said that, if you could assure me that all
>>> formats supported in http://www.gdal.org/ogr/ogr_formats.html are
>>> vector formats, I would have understood your point (of not
>>> offering a LAS driver).
>> Rui,
>>
>> I intentionally put question mark to indicate it's open question
>> for me as well. The nature of LiDAR data might be confusing and I'm
>> interested to learn more about it. Dale Lutz said, "point cloud is
>> a badly behaved raster". I (used to) say, it's not a vector. But I
>> still haven't found clear answer "what is it" really :)
>>
>> Best regards,
>>
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.4.14 (GNU/Linux)
> Comment: Using GnuPG with Thunderbird - http://www.enigmail.net/
>
> iQEcBAEBAgAGBQJSl0+2AAoJEJoaok7HgajKZkkH/jZ/zxIjsth8OTcDEWFMmaP4
> Szn2fL8oGRWnjtM0XRlRWxG1HHJ6o0ZrggjSnEa1DFr98RzXftv0ruknyj99ns5K
> dBAdmksXlxGBz4KKdF609TFTgVgT9HyTObuNiqIxklyi8rN/XZBk+mfpQZpNBU3W
> /IdXkrvBDWTYAh6YOWfXN+XQkeLpwfRsYk6m+UZRXSzYJdQrphsuUtXQrWJnoE68
> 9GDDZGgzyBlYiAXYt4nr0rNzvt367J7gXJd8h8Nyrgc3A+btyOjOZ1Jjs06TZGuE
> ecM1F9wYARglZ+w6H865asGiJ4r54E2xpakMjgvwD5KTRrNZu6RbE31Tn1hI1ho=
> =+UCc
> -----END PGP SIGNATURE-----
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>


From gdal at stripfamily.net  Thu Nov 28 19:51:07 2013
From: gdal at stripfamily.net (David Strip)
Date: Thu, 28 Nov 2013 20:51:07 -0700
Subject: [gdal-dev] .csvt file doesn't allow space after comma
Message-ID: <52980F2B.30106@stripfamily.net>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131128/e300be3f/attachment.html>

From JPalmer at linz.govt.nz  Fri Nov 29 00:59:30 2013
From: JPalmer at linz.govt.nz (Jeremy Palmer)
Date: Fri, 29 Nov 2013 21:59:30 +1300
Subject: [gdal-dev] Force application of ntv2 grid
Message-ID: <C6B695652D5E6B4597E90C5734C0242616D8ACFD95@prdlsmmsg01.ad.linz.govt.nz>

Hi gdal-devs,

I'm trying to shift shapefile data using a custom NTv2 grid file. The logical source and destination coordinate systems are the same (geographic coordinates EPSG:4167), I only want to shift the data.

The type of command I'm trying to run is:

ogr2ogr -f "Esri Shapefile" -a_srs "+proj=longlat +ellps=GRS80" -t_srs "+proj=longlat +ellps=GRS80 +nadgrids=custom_grid.gsb +wktext" dst_datasource_name src_datasource_name

but the output shapefile does not get transformed...

Is this because there is a short circuit in proj4 if the ellipsoids are the same?

Any help would be greatly appreciated.

Best regards,
Jeremy


This message contains information, which is confidential and may be subject to legal privilege. If you are not the intended recipient, you must not peruse, use, disseminate, distribute or copy this message. If you have received this message in error, please notify us immediately (Phone 0800 665 463 or info at linz.govt.nz) and destroy the original message. LINZ accepts no responsibility for changes to this email, or for any attachments, after its transmission from LINZ. Thank You.

From rlpires at gmail.com  Fri Nov 29 02:32:32 2013
From: rlpires at gmail.com (Rui L. Pires)
Date: Fri, 29 Nov 2013 11:32:32 +0100
Subject: [gdal-dev] LAS support
In-Reply-To: <CABUeae_9tNe4gZ-87Ks3jJEU97DZFOyDQX5OrwBDJYQ+OT-jhw@mail.gmail.com>
References: <CAP6xJca1TGozsUYeocU-++LP4YVErDtv4jcbRgt3gEZMyaXAWQ@mail.gmail.com>
	<CABUeae8dVBbEW=mUr_=XKvv4RenxYVwsbsUJOWW1smCGDR7=ug@mail.gmail.com>
	<CAP6xJcZacZtwHwLJ_7=jJszGEJoHPLSfG1RvYVSAygRRJnMh3A@mail.gmail.com>
	<CABUeae_9tNe4gZ-87Ks3jJEU97DZFOyDQX5OrwBDJYQ+OT-jhw@mail.gmail.com>
Message-ID: <CAP6xJcZfWk+QtR_L2W6meY5k5N2Uz0OzH6wPAgp2TWiK8uZk=g@mail.gmail.com>

On 28 November 2013 15:09, Mateusz Loskot <mateusz at loskot.net> wrote:

> On 28 November 2013 13:56, Rui L. Pires <rlpires at gmail.com> wrote:
> > On 28 November 2013 11:03, Mateusz Loskot <mateusz at loskot.net> wrote:
> >> On 28 November 2013 09:51, Rui L. Pires <rlpires at gmail.com> wrote:
> >> >
> >> > Would there be any particular reason for not supporting it?
> >>
> >> Point cloud is not a vector, not a raster either? :-)
> >
> > That might be debatable, but it won't be me reopening that discussion.
> > Having said that, if you could assure me that all formats supported in
> > http://www.gdal.org/ogr/ogr_formats.html are vector formats, I would
> have
> > understood your point (of not offering a LAS driver).
>
> I intentionally put question mark to indicate it's open question for me as
> well.
> The nature of LiDAR data might be confusing and I'm interested to
> learn more about it.
> Dale Lutz said, "point cloud is a badly behaved raster".
> I (used to) say, it's not a vector.
> But I still haven't found clear answer "what is it" really :)
>

It's interesting you mention LiDAR, but I would like to stick to point
cloud, or point data set if you will.

I was approaching this issue and particularly OGR as a solution for data
conversion and reduction. I am quite fond of the functionality OGRLayer
makes possible in a transparent way, such as reprojection and spatial
querying.

But I will have to agree this functionality may already exist elsewhere and
as such there might reduced interest in offering it within the OGR API that
I am so fond of. Fair enough.

Regards,
Rui
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131129/6b669f7a/attachment.html>

From phil.wilkes at rmit.edu.au  Fri Nov 29 02:25:18 2013
From: phil.wilkes at rmit.edu.au (philwilkes)
Date: Fri, 29 Nov 2013 02:25:18 -0800 (PST)
Subject: [gdal-dev] SetColorInterpretation() for a GeoTiff using GDAL not
	working
Message-ID: <1385720718101-5091839.post@n6.nabble.com>

I have also posted this on http://gis.stackexchange.com/ but had no joy so
thought I'd try my luck here!

I have a single band image which I would like to copy to a 3 bands of a new
image and set the ColorInterpretation to red, green and blue respectively. I
have tried two approaches, one using the GTiff driver, explained below, and
the other using the VRT driver. 

My code is; 

############################################## 

from osgeo import gdal 
import os 

IM = "path/to/image.tif" # single band image 

### read image ### 
ds = gdal.Open(IM) 
X = ds.RasterXSize 
Y = ds.RasterYSize 
band = ds.GetRasterBand(1).ReadAsArray() 

### write to 3 bands ### 
driver = gdal.GetDriverByName("GTiff") 
outPath = os.path.join(os.path.split(IM)[0], "test_image.tif") 
outIM = driver.Create(outPath, X, Y, 3, gdal.GDT_Int16) 
for i in range(1, 4): 
    outIM.GetRasterBand(i).SetRasterColorInterpretation(2 + i) 
    outIM.GetRasterBand(i).WriteArray(band) 
    print outIM.GetRasterBand(i).GetRasterColorInterpretation() 
outIM = None 

############################################## 

The output is: 

1 
0 
0 

I have also tried using the SetColorInterpretation(). 

My question is, how do I set the ColorInterpretation metatag using the GTiff
driver?



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/SetColorInterpretation-for-a-GeoTiff-using-GDAL-not-working-tp5091839.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From mateusz at loskot.net  Fri Nov 29 02:44:14 2013
From: mateusz at loskot.net (Mateusz Loskot)
Date: Fri, 29 Nov 2013 10:44:14 +0000
Subject: [gdal-dev] LAS support
In-Reply-To: <CAP6xJcZfWk+QtR_L2W6meY5k5N2Uz0OzH6wPAgp2TWiK8uZk=g@mail.gmail.com>
References: <CAP6xJca1TGozsUYeocU-++LP4YVErDtv4jcbRgt3gEZMyaXAWQ@mail.gmail.com>
	<CABUeae8dVBbEW=mUr_=XKvv4RenxYVwsbsUJOWW1smCGDR7=ug@mail.gmail.com>
	<CAP6xJcZacZtwHwLJ_7=jJszGEJoHPLSfG1RvYVSAygRRJnMh3A@mail.gmail.com>
	<CABUeae_9tNe4gZ-87Ks3jJEU97DZFOyDQX5OrwBDJYQ+OT-jhw@mail.gmail.com>
	<CAP6xJcZfWk+QtR_L2W6meY5k5N2Uz0OzH6wPAgp2TWiK8uZk=g@mail.gmail.com>
Message-ID: <CABUeae_=og_1HZb2M24zZ3df7ArzzH-XJA8Qa9+L2_YkU55t0g@mail.gmail.com>

On 29 November 2013 10:32, Rui L. Pires <rlpires at gmail.com> wrote:
> On 28 November 2013 15:09, Mateusz Loskot <mateusz at loskot.net> wrote:
>> On 28 November 2013 13:56, Rui L. Pires <rlpires at gmail.com> wrote:
>> > On 28 November 2013 11:03, Mateusz Loskot <mateusz at loskot.net> wrote:
>> >> On 28 November 2013 09:51, Rui L. Pires <rlpires at gmail.com> wrote:
>> >> >
>> >> > Would there be any particular reason for not supporting it?
>> >>
>> >> Point cloud is not a vector, not a raster either? :-)
>> >
>> > That might be debatable, but it won't be me reopening that discussion.
>> > Having said that, if you could assure me that all formats supported in
>> > http://www.gdal.org/ogr/ogr_formats.html are vector formats, I would
>> > have
>> > understood your point (of not offering a LAS driver).
>>
>> I intentionally put question mark to indicate it's open question for me as
>> well.
>> The nature of LiDAR data might be confusing and I'm interested to
>> learn more about it.
>> Dale Lutz said, "point cloud is a badly behaved raster".
>> I (used to) say, it's not a vector.
>> But I still haven't found clear answer "what is it" really :)
>
>
> It's interesting you mention LiDAR, but I would like to stick to point
> cloud, or point data set if you will.

I meant point cloud. I sometimes may freely interchange LiDAR data and
point cloud data, not saying it's correct.

> I was approaching this issue and particularly OGR as a solution for data
> conversion and reduction. I am quite fond of the functionality OGRLayer
> makes possible in a transparent way, such as reprojection and spatial
> querying.

Those are valid use cases of course and I don't argue here.
Just, since OGR is an abstraction layer and point clouds are enormous,
I wouldn't expect high performance.
That's why, IMHO, point clouds require dedicated toolkits (PDAL, PCL).

Perhaps, you can try las2ogr to see how OGR in general will work for your uses.
Besides, writing OGR driver with libLAS (or PDAL) should be feasible.

Best regards,
-- 
Mateusz  Loskot, http://mateusz.loskot.net

From even.rouault at mines-paris.org  Fri Nov 29 03:04:51 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 29 Nov 2013 12:04:51 +0100
Subject: [gdal-dev] SetColorInterpretation() for a GeoTiff using GDAL
	not working
In-Reply-To: <1385720718101-5091839.post@n6.nabble.com>
References: <1385720718101-5091839.post@n6.nabble.com>
Message-ID: <1385723091.529874d3cb9f9@imp.free.fr>

Selon philwilkes <phil.wilkes at rmit.edu.au>:

> I have also posted this on http://gis.stackexchange.com/ but had no joy so
> thought I'd try my luck here!
>
> I have a single band image which I would like to copy to a 3 bands of a new
> image and set the ColorInterpretation to red, green and blue respectively. I
> have tried two approaches, one using the GTiff driver, explained below, and
> the other using the VRT driver.
>
> My code is;
>
> ##############################################
>
> from osgeo import gdal
> import os
>
> IM = "path/to/image.tif" # single band image
>
> ### read image ###
> ds = gdal.Open(IM)
> X = ds.RasterXSize
> Y = ds.RasterYSize
> band = ds.GetRasterBand(1).ReadAsArray()
>
> ### write to 3 bands ###
> driver = gdal.GetDriverByName("GTiff")
> outPath = os.path.join(os.path.split(IM)[0], "test_image.tif")
> outIM = driver.Create(outPath, X, Y, 3, gdal.GDT_Int16)
> for i in range(1, 4):
>     outIM.GetRasterBand(i).SetRasterColorInterpretation(2 + i)
>     outIM.GetRasterBand(i).WriteArray(band)
>     print outIM.GetRasterBand(i).GetRasterColorInterpretation()
> outIM = None
>
> ##############################################
>
> The output is:
>
> 1
> 0
> 0
>
> I have also tried using the SetColorInterpretation().
>
> My question is, how do I set the ColorInterpretation metatag using the GTiff
> driver?

Phil,

I've reviewed quickly the code of the GeoTIFF driver and indeed there's some
inconsistency in round-tripping of SetColorInterpretation() /
GetColorInterpretation().

The main reason is that fundamentally color interpretation in tiff format is not
a per-band setting, but a per-dataset setting. You should try outIM =
driver.Create(outPath, X, Y, 3, gdal.GDT_Int16, options = [ 'PHOTOMETRIC=RGB' ])
and you should not need to call SetColorInterpretation()

In the case of TIFF, SetColorInterpretation() has influence, at the TIFF file
format, only when setting alpha on the 2nd band of a 2 band dataset (grey +
alpha) or the 4th band of a 4 band dataset (RGB + alpha). All other calls will
set value at the persistance auxiliary metadata system level (.aux.xml files).
But it would be desirable that SetColorInterpretation() and
GetColorInterpretation() correctly round-trip. Would you mind opening a ticket
in GDAL trac about that ?

Best regards,

Even



From p.halls at york.ac.uk  Fri Nov 29 05:16:35 2013
From: p.halls at york.ac.uk (Peter Halls)
Date: Fri, 29 Nov 2013 13:16:35 +0000
Subject: [gdal-dev] .csvt file doesn't allow space after comma
In-Reply-To: <52980F2B.30106@stripfamily.net>
References: <52980F2B.30106@stripfamily.net>
Message-ID: <CADEnnOMdm7WoYFAuygbfz5j=tESarFcSsM_N=Lc7Z7Fah_O99A@mail.gmail.com>

David,


http://www.qgis.nl/2012/07/13/koppelen-van-data-uit-csv-bestand/?lang=endefines
the cvst file as a sequence of comma separated column definitions.
The examples are all 'dense', with no space between the comma and the next
value.  It seems odd to define it in this way - perhaps there is a reason
or perhaps it is a bijou bugette in QGIS ...

Peter


On 29 November 2013 03:51, David Strip <gdal at stripfamily.net> wrote:

>  I am trying to use a .csv file in a qgis project. After not getting what
> I expected, I learned about .csvt files and wrote a file that looked like
>
> "String", "Integer"
>
> with a space following the comma. This did not work - both fields were
> still read as String. After removing the comma I got a String field and an
> Integer field.
> The documentation states the list is comma-separated, which I suppose if
> strictly interpreted could mean no white space. However, in general .csv
> files ignore whitespace following a comma.
> I'm posting this in the event that someone is working with a more complex
> .csvt file that fails might have a chance of finding this when they search
> for a clue as to why their file isn't working.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
----------------------------------------------------------------------------------------------------------------
Peter J Halls, GIS Advisor & Team Leader Applications Support and Training,
               Information Directorate, University of York
Telephone: 01904 323806     Fax: 01904 323740
Snail mail: Harry Fairhurst Building, University of York,
                Heslington, York YO10 5DD
This message has the status of a private and personal communication
----------------------------------------------------------------------------------------------------------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131129/a08762d0/attachment-0001.html>

From andre+joost at nurfuerspam.de  Fri Nov 29 07:07:34 2013
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Fri, 29 Nov 2013 16:07:34 +0100
Subject: [gdal-dev] Force application of ntv2 grid
In-Reply-To: <C6B695652D5E6B4597E90C5734C0242616D8ACFD95@prdlsmmsg01.ad.linz.govt.nz>
References: <C6B695652D5E6B4597E90C5734C0242616D8ACFD95@prdlsmmsg01.ad.linz.govt.nz>
Message-ID: <l7aamb$2d1$1@ger.gmane.org>

Am 29.11.2013 09:59, schrieb Jeremy Palmer:
> Hi gdal-devs,
>
> I'm trying to shift shapefile data using a custom NTv2 grid file. The
> logical source and destination coordinate systems are the same
> (geographic coordinates EPSG:4167), I only want to shift the data.
>
> The type of command I'm trying to run is:
>
> ogr2ogr -f "Esri Shapefile" -a_srs "+proj=longlat +ellps=GRS80"
> -t_srs "+proj=longlat +ellps=GRS80 +nadgrids=custom_grid.gsb +wktext"
> dst_datasource_name src_datasource_name
>
> but the output shapefile does not get transformed...
>
> Is this because there is a short circuit in proj4 if the ellipsoids
> are the same?
>

No, you have to explicitely specify +towgs84=0,0,0,0,0,0,0 for the first 
srs. Otherwise it is assumed that both share the same datum.

HTH,
Andr? Joost


From rlpires at gmail.com  Fri Nov 29 09:35:28 2013
From: rlpires at gmail.com (Rui L. Pires)
Date: Fri, 29 Nov 2013 18:35:28 +0100
Subject: [gdal-dev] LAS support
In-Reply-To: <CABUeae_=og_1HZb2M24zZ3df7ArzzH-XJA8Qa9+L2_YkU55t0g@mail.gmail.com>
References: <CAP6xJca1TGozsUYeocU-++LP4YVErDtv4jcbRgt3gEZMyaXAWQ@mail.gmail.com>
	<CABUeae8dVBbEW=mUr_=XKvv4RenxYVwsbsUJOWW1smCGDR7=ug@mail.gmail.com>
	<CAP6xJcZacZtwHwLJ_7=jJszGEJoHPLSfG1RvYVSAygRRJnMh3A@mail.gmail.com>
	<CABUeae_9tNe4gZ-87Ks3jJEU97DZFOyDQX5OrwBDJYQ+OT-jhw@mail.gmail.com>
	<CAP6xJcZfWk+QtR_L2W6meY5k5N2Uz0OzH6wPAgp2TWiK8uZk=g@mail.gmail.com>
	<CABUeae_=og_1HZb2M24zZ3df7ArzzH-XJA8Qa9+L2_YkU55t0g@mail.gmail.com>
Message-ID: <CAP6xJcY3xfbYXeBskDY2VVdN5mPmPvOdxZXcg58XARNULG73gA@mail.gmail.com>

On 29 November 2013 11:44, Mateusz Loskot <mateusz at loskot.net> wrote:

> On 29 November 2013 10:32, Rui L. Pires <rlpires at gmail.com> wrote:
> > I was approaching this issue and particularly OGR as a solution for data
> > conversion and reduction. I am quite fond of the functionality OGRLayer
> > makes possible in a transparent way, such as reprojection and spatial
> > querying.
>
> Those are valid use cases of course and I don't argue here.
> Just, since OGR is an abstraction layer and point clouds are enormous,
> I wouldn't expect high performance.
> That's why, IMHO, point clouds require dedicated toolkits (PDAL, PCL).
>

Hi Mateusz,

I understand your point regarding performance but I consider that to be a
driver issue. My point is functionality before speed.

Perhaps, you can try las2ogr to see how OGR in general will work for your
> uses.
> Besides, writing OGR driver with libLAS (or PDAL) should be feasible.
>

Indeed it is feasible. It's running fine here! ;-)

Regards,
Rui
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131129/b371f775/attachment.html>

From even.rouault at mines-paris.org  Fri Nov 29 10:39:18 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 29 Nov 2013 19:39:18 +0100
Subject: [gdal-dev] LAS support
In-Reply-To: <CAP6xJcY3xfbYXeBskDY2VVdN5mPmPvOdxZXcg58XARNULG73gA@mail.gmail.com>
References: <CAP6xJca1TGozsUYeocU-++LP4YVErDtv4jcbRgt3gEZMyaXAWQ@mail.gmail.com>
	<CABUeae_=og_1HZb2M24zZ3df7ArzzH-XJA8Qa9+L2_YkU55t0g@mail.gmail.com>
	<CAP6xJcY3xfbYXeBskDY2VVdN5mPmPvOdxZXcg58XARNULG73gA@mail.gmail.com>
Message-ID: <201311291939.18710.even.rouault@mines-paris.org>

Le vendredi 29 novembre 2013 18:35:28, Rui L. Pires a ?crit :
> On 29 November 2013 11:44, Mateusz Loskot <mateusz at loskot.net> wrote:
> > On 29 November 2013 10:32, Rui L. Pires <rlpires at gmail.com> wrote:
> > > I was approaching this issue and particularly OGR as a solution for
> > > data conversion and reduction. I am quite fond of the functionality
> > > OGRLayer makes possible in a transparent way, such as reprojection and
> > > spatial querying.
> > 
> > Those are valid use cases of course and I don't argue here.
> > Just, since OGR is an abstraction layer and point clouds are enormous,
> > I wouldn't expect high performance.
> > That's why, IMHO, point clouds require dedicated toolkits (PDAL, PCL).
> 
> Hi Mateusz,
> 
> I understand your point regarding performance but I consider that to be a
> driver issue. My point is functionality before speed.
> 
> Perhaps, you can try las2ogr to see how OGR in general will work for your
> 
> > uses.
> > Besides, writing OGR driver with libLAS (or PDAL) should be feasible.
> 
> Indeed it is feasible. It's running fine here! ;-)

I'm not versed in lidar or point clouds to know if it is really relevant, but 
it is true that OGR has drivers for stuff that aren't strictly vector formats.  
And as las2ogr exists, I also imagine that an OGR driver should be doable.
So it would not be completely out of topic to have a OGR driver based on 
libLAS or PDAL (the question is : should it be based on libLAS or PDAL ? Any 
opinion on this ?) if people find it usefull (and this is a matter that comes 
back regularly).

A potential problem is that libLAS and PDAL have GDAL as a build dependency, 
so a OGR driver would need to be compiled as a plugin (same as GRASS plugin 
for example).

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From mateusz at loskot.net  Fri Nov 29 12:53:35 2013
From: mateusz at loskot.net (Mateusz Loskot)
Date: Fri, 29 Nov 2013 20:53:35 +0000
Subject: [gdal-dev] LAS support
In-Reply-To: <201311291939.18710.even.rouault@mines-paris.org>
References: <CAP6xJca1TGozsUYeocU-++LP4YVErDtv4jcbRgt3gEZMyaXAWQ@mail.gmail.com>
	<CABUeae_=og_1HZb2M24zZ3df7ArzzH-XJA8Qa9+L2_YkU55t0g@mail.gmail.com>
	<CAP6xJcY3xfbYXeBskDY2VVdN5mPmPvOdxZXcg58XARNULG73gA@mail.gmail.com>
	<201311291939.18710.even.rouault@mines-paris.org>
Message-ID: <CABUeae9KD0ZYKj0y3RYh+1mu2s+K-n2Goaq6m2ja=4MMFRs=PQ@mail.gmail.com>

On 29 November 2013 18:39, Even Rouault <even.rouault at mines-paris.org> wrote:
> Le vendredi 29 novembre 2013 18:35:28, Rui L. Pires a ?crit :
>> On 29 November 2013 11:44, Mateusz Loskot <mateusz at loskot.net> wrote:
>> > On 29 November 2013 10:32, Rui L. Pires <rlpires at gmail.com> wrote:
>> > > I was approaching this issue and particularly OGR as a solution for
>> > > data conversion and reduction. I am quite fond of the functionality
>> > > OGRLayer makes possible in a transparent way, such as reprojection and
>> > > spatial querying.
>> >
>> > Those are valid use cases of course and I don't argue here.
>> > Just, since OGR is an abstraction layer and point clouds are enormous,
>> > I wouldn't expect high performance.
>> > That's why, IMHO, point clouds require dedicated toolkits (PDAL, PCL).
>>
>> Hi Mateusz,
>>
>> I understand your point regarding performance but I consider that to be a
>> driver issue. My point is functionality before speed.
>>
>> Perhaps, you can try las2ogr to see how OGR in general will work for your
>>
>> > uses.
>> > Besides, writing OGR driver with libLAS (or PDAL) should be feasible.
>>
>> Indeed it is feasible. It's running fine here! ;-)
>
> I'm not versed in lidar or point clouds to know if it is really relevant, but
> it is true that OGR has drivers for stuff that aren't strictly vector formats.
> And as las2ogr exists, I also imagine that an OGR driver should be doable.
> So it would not be completely out of topic to have a OGR driver based on
> libLAS or PDAL

Sure. As I've said, I somewhat changed my opinion on that lately :-)

> (the question is : should it be based on libLAS or PDAL ? Any
> opinion on this ?)

AFAICT, it should be PDAL as libLAS is considered as deprecated
and not actively maintained. But, I'll leave this to Hobu to confirm.

> A potential problem is that libLAS and PDAL have GDAL as a build dependency,
> so a OGR driver would need to be compiled as a plugin (same as GRASS plugin
> for example).

That's right.

Best regards,
-- 
Mateusz  ?oskot, http://mateusz.loskot.net

From lauri.kajan at gmail.com  Sat Nov 30 03:27:19 2013
From: lauri.kajan at gmail.com (Lauri Kajan)
Date: Sat, 30 Nov 2013 13:27:19 +0200
Subject: [gdal-dev] How to get coordinates of original corners from warped
	image
Message-ID: <CAKWoFMKUtNi7HhdPAHoY26c+9=3sHinPRBKT2M=396RMtV7VtQ@mail.gmail.com>

Hi all

I have a set of aerial bird's view images and now I need to get extents of
those images as polygons.
I thought to add GCPs to images and possibly somehow to use the same
transformation that is used when warping the images with perspective
algorithm, to calculate coordinates for corners of the original images.

Is this possible with python?


Thanks

-Lauri
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131130/a2df1517/attachment.html>

From stefano.iacovella at gmail.com  Sat Nov 30 08:15:51 2013
From: stefano.iacovella at gmail.com (Stefano Iacovella)
Date: Sat, 30 Nov 2013 17:15:51 +0100
Subject: [gdal-dev] ogr2ogr PGDUMP not using typmod?
Message-ID: <CAG9OqYqhg2VkagMkyGhp4YOh7=zUHBZzr+GqseBsN1eSuBG3yA@mail.gmail.com>

Hi all,

I am having trouble trying to force ogr2ogr to use the typmod geometry
column creation using the PGDUMP format.
I tried to use -lco  POSTGIS_VERSION=2.0 but also with it I find this in
the output sql file:

SELECT AddGeometryColumn('public','linee','geom',4326,'LINESTRING',2);

This is definitely not a big issue as I can easily update the sql file
before running it, but I wonder if it is just me that can't find the right
way.

Thank you for any hint

Stefano

---------------------------------------------------
41.95581N 12.52854E


http://www.linkedin.com/in/stefanoiacovella

http://twitter.com/#!/Iacovellas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131130/1f91b6c8/attachment.html>

From even.rouault at mines-paris.org  Sat Nov 30 09:35:44 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 30 Nov 2013 18:35:44 +0100
Subject: [gdal-dev] ogr2ogr PGDUMP not using typmod?
In-Reply-To: <CAG9OqYqhg2VkagMkyGhp4YOh7=zUHBZzr+GqseBsN1eSuBG3yA@mail.gmail.com>
References: <CAG9OqYqhg2VkagMkyGhp4YOh7=zUHBZzr+GqseBsN1eSuBG3yA@mail.gmail.com>
Message-ID: <201311301835.44326.even.rouault@mines-paris.org>

Le samedi 30 novembre 2013 17:15:51, Stefano Iacovella a ?crit :
> Hi all,
> 
> I am having trouble trying to force ogr2ogr to use the typmod geometry
> column creation using the PGDUMP format.
> I tried to use -lco  POSTGIS_VERSION=2.0 but also with it I find this in
> the output sql file:
> 
> SELECT AddGeometryColumn('public','linee','geom',4326,'LINESTRING',2);
> 
> This is definitely not a big issue as I can easily update the sql file
> before running it, but I wonder if it is just me that can't find the right
> way.

You don't need to do any SQL rewriting, nor the PGDump driver needs changes.
In PostGIS 2.0, according to 
http://postgis.refractions.net/docs/AddGeometryColumn.html, 
AddGeometryColumn() will by default create a typmod geometry colum
I've verified it by issuing a "\d mytable" on a table created with PGDump.

> 
> Thank you for any hint
> 
> Stefano
> 
> ---------------------------------------------------
> 41.95581N 12.52854E
> 
> 
> http://www.linkedin.com/in/stefanoiacovella
> 
> http://twitter.com/#!/Iacovellas

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From stefano.iacovella at gmail.com  Sat Nov 30 09:52:59 2013
From: stefano.iacovella at gmail.com (Stefano Iacovella)
Date: Sat, 30 Nov 2013 18:52:59 +0100
Subject: [gdal-dev] ogr2ogr PGDUMP not using typmod?
In-Reply-To: <201311301835.44326.even.rouault@mines-paris.org>
References: <CAG9OqYqhg2VkagMkyGhp4YOh7=zUHBZzr+GqseBsN1eSuBG3yA@mail.gmail.com>
	<201311301835.44326.even.rouault@mines-paris.org>
Message-ID: <CAG9OqYpX-Ce3afr34u-sxekZoVq3JRv0_ZJn2oqesYN1mc2dsA@mail.gmail.com>

2013/11/30 Even Rouault <even.rouault at mines-paris.org>

> You don't need to do any SQL rewriting, nor the PGDump driver needs
> changes.
> In PostGIS 2.0, according to
> http://postgis.refractions.net/docs/AddGeometryColumn.html,
> AddGeometryColumn() will by default create a typmod geometry colum
> I've verified it by issuing a "\d mytable" on a table created with PGDump.
>

Thanks Even.
Nice to know, Indeed also shp2pgsql utility uses the AddGeometryColumn and
after reading the docs it makes sense.

Stefano

---------------------------------------------------
41.95581N 12.52854E


http://www.linkedin.com/in/stefanoiacovella

http://twitter.com/#!/Iacovellas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20131130/f5b571a0/attachment.html>

