From Martin.Spott at mgras.net  Thu Jun  1 05:57:37 2006
From: Martin.Spott at mgras.net (Martin Spott)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] GNU Compile of GDAL on Solaris
References: <444654B3.6010704@ciesin.columbia.edu>
Message-ID: <e5mdmh$14u0$1@osprey.mgras.de>

Gregory Yetman wrote:

> I did some digging, apparently the math.h library has been replaced
> with a .so file on Solaris. There is a math.h file in:
> 
> /opt/sfw/lib/gcc-lib/sparc-sun-solaris2.9/2.95.3/include/ [...]

I can't tell you any specifics regarding your GCC version. Maybe you'd
want to try GCC-3.4.2 from Sunfreeware which I used to compile
GDAL-1.3.1 on Solaris8,

	Martin.
-- 
 Unix _IS_ user friendly - it's just selective about who its friends are !
--------------------------------------------------------------------------

From ILucena at clarku.edu  Thu Jun  1 10:17:36 2006
From: ILucena at clarku.edu (Ivan Lucena)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] HFD4 Dataset, gdalwarp X ModisTolls
Message-ID: <6FD7C9DB26540B42A1207C69BF92D455015A3028@Iris.ad.clarku.edu>

Hi there,

Did anybody have the patience to compare gdalwarp against Modis
Reprojection Tools and MRTSwath?
 
Don't get me wrong, I believe that the MRTools are good, but there is no
API to do integration, and of course it only support HDF-4 as input and
GeoTiff/Raw as output. But it has more knowledge about the variations of
EOS data product than in GDAL.

So, One day I've heard a remote sense specialist saying:

- We prefer to use MRT and MRTSwatth to get the projected GeoTiffs
because our partners are using the same tools, so whatever the algorithm
is doing (right or wrong) is going to make ours images to match!

That makes me wondering, one day GDAL could became some kind of a
standard.  
But for the right reasons, not because it's free and everybody is using
it, but because it is really good.  We are all working on it.

Lucena, Ivan


From Peter.Rushforth at statcan.ca  Thu Jun  1 10:12:35 2006
From: Peter.Rushforth at statcan.ca (Peter.Rushforth@statcan.ca)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] projection info in mapinfo tab files corrupt
	whenspecifying -a_srs or -s_srs and -t_srs in ogr2ogr
Message-ID: <AB38021D12570A4AB907F442AE548807011A7F76@stcem04.statcan.ca>

Hi Daniel and Frank,

I added the -DMITAB_AFFINE_PARAMS option to the compilation, using
a cvs from 2006.05.30.

I get the following error:

g++ -Wall -fPIC -O2   -I.. -I../.. -I/bilbo05/rushpet/gdal/src/gdal-cvs-2006.05.30/port -I/bilbo05/rushpet/gdal/src/gdal-cvs-2006.05.30/gcore -I/bilbo05/rushpet/gdal/src/gdal-cvs-2006.05.30/alg -I/bilbo05/rushpet/gdal/src/gdal-cvs-2006.05.30/ogr -I/bilbo05/rushpet/gdal/src/gdal-cvs-2006.05.30/ogr/ogrsf_frmts -DOGR_ENABLED -I/bilbo05/rushpet/gdal/src/gdal-cvs-2006.05.30/port  -DOGR -DMITAB_AFFINE_PARAMS -c -o ../o/mitab_coordsys.o mitab_coordsys.cpp
mitab_coordsys.cpp: In function `OGRSpatialReference* MITABCoordSys2SpatialRef(const char*)':
mitab_coordsys.cpp:199: error: 'class OGRSpatialReference' has no member named 'nAffineFlag'
mitab_coordsys.cpp:200: error: 'class OGRSpatialReference' has no member named 'nAffineUnit'
mitab_coordsys.cpp:201: error: 'class OGRSpatialReference' has no member named 'dAffineParamA'
mitab_coordsys.cpp:202: error: 'class OGRSpatialReference' has no member named 'dAffineParamB'
mitab_coordsys.cpp:203: error: 'class OGRSpatialReference' has no member named 'dAffineParamC'
mitab_coordsys.cpp:204: error: 'class OGRSpatialReference' has no member named 'dAffineParamD'
mitab_coordsys.cpp:205: error: 'class OGRSpatialReference' has no member named 'dAffineParamE'
mitab_coordsys.cpp:206: error: 'class OGRSpatialReference' has no member named 'dAffineParamF'
mitab_coordsys.cpp:210: error: 'class OGRSpatialReference' has no member named 'nAffineFlag'

make: *** [../o/mitab_coordsys.o] Error 1

Can you see what the problem is from this?
Thanks for your suggestions.

Cheers,

Peter Rushforth
Geography Division
Statistics Canada
Ottawa Ontario
K1A 0T6


> -----Original Message-----
> From: gdal-dev-bounces@lists.maptools.org 
> [mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of 
> Daniel Morissette
> Sent: May 31, 2006 10:42 PM
> To: Peter Rushforth
> Cc: gdal-dev@lists.maptools.org
> Subject: Re: [Gdal-dev] projection info in mapinfo tab files 
> corrupt whenspecifying -a_srs or -s_srs and -t_srs in ogr2ogr
> 
> 
> This may be related to a bug in the MITAB library which is 
> used by OGR 
> to read/write TAB files: 
> http://bugzilla.maptools.org/show_bug.cgi?id=1319#c7
> See also:
> http://bugzilla.maptools.org/show_bug.cgi?id=1254
> 
> Perhaps try rebuilding gdal/ogr/ogrsf_frmts/mitab with 
> -DMITAB_AFFINE_PARAMS (and then relink ogr2ogr) and see if the crash 
> goes away.
> 
> Daniel
> 
> 
> Peter Rushforth wrote:
> > Hi,
> > 
> > I've done a little more testing and have a little more 
> info.  I attach 
> > a csv file which demonstrates when the corruption of the tab file 
> > occurs.
> > 
> > It appears to occur whenever the -a_srs option is used in 
> ogr2ogr, or 
> > when the data is reprojected using -s_srs and -t_srs.
> > 
> > The symptoms include crashing and irregular behaviour of mapinfo.  
> > When one views the Change Current view dialog, the coordinates are 
> > garbage and the map units are incorrect.
> > 
> > I am using fwtools 1.01 on windows, which *believe* is pretty up to 
> > date wrt cvs snapshots.
> > 
> > I've been looking at the data files in mapinfo pro viewer 8.0 and 
> > tatuk
> > viewer.
> > Tatuk doesn't seem to notice the problem, mapinfo doesn't like it.
> > 
> > Does this info lead anyone to conclude anything about 
> possible causes?
> > 
> > Cheers,
> > Peter
> > 
> > 
> > 
> ----------------------------------------------------------------------
> > --
> > 
> > _______________________________________________
> > Gdal-dev mailing list
> > Gdal-dev@lists.maptools.org 
> > http://lists.maptools.org/mailman/listinfo/gdal-dev
> 
> 
> -- 
> Daniel Morissette
> http://www.mapgears.com/ 
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org 
> http://lists.maptools.org/mailman/listinfo/gdal-dev
> 


From dmurphy at agi.com  Thu Jun  1 11:08:22 2006
From: dmurphy at agi.com (Murphy, David)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] Subdatasets
Message-ID: <29474044C503AA40A6D6403925FB04EBA6C12F@mail02.stk.com>

Hello-

 

I'm trying to run GDAL_Translate against a subdataset of CADRG RPF
dataset.  The GDALInfo results of this dataset are...

 

Driver: OGDI/OGDI Bridge

Size is 2000, 2000

Coordinate System is:

GEOGCS["WGS 84",

    DATUM["unknown",

        SPHEROID["WGS84",6378137,298.257223563]],

    PRIMEM["Greenwich",0],

    UNIT["degree",0.0174532925199433]]

Origin = (124.126904,43.092269)

Pixel Size = (0.00335787,-0.00248609)

Subdatasets:

  SUBDATASET_1_NAME=gltp:/rpf/d:/rpf:"1:50K@2@CADRG@DMAAC@0":Matrix

  SUBDATASET_1_DESC=1:50K@2@CADRG@DMAAC@0 as Matrix

  SUBDATASET_2_NAME=gltp:/rpf/d:/rpf:"1:50K@2@CADRG@DMAAC@0":Image

  SUBDATASET_2_DESC=1:50K@2@CADRG@DMAAC@0 as Image

Corner Coordinates:

Upper Left  ( 124.1269036,  43.0922693) (124d 7'36.85"E, 43d 5'32.17"N)

Lower Left  ( 124.1269036,  38.1200844) (124d 7'36.85"E, 38d 7'12.30"N)

Upper Right ( 130.8426396,  43.0922693) (130d50'33.50"E, 43d 5'32.17"N)

Lower Right ( 130.8426396,  38.1200844) (130d50'33.50"E, 38d 7'12.30"N)

Center      ( 127.4847716,  40.6061769) (127d29'5.18"E, 40d36'22.24"N)

Band 1 Block=2000x1 Type=Byte, ColorInterp=Red

  Overviews: arbitrary

Band 2 Block=2000x1 Type=Byte, ColorInterp=Green

  Overviews: arbitrary

Band 3 Block=2000x1 Type=Byte, ColorInterp=Blue

  Overviews: arbitrary

Band 4 Block=2000x1 Type=Byte, ColorInterp=Alpha

  Overviews: arbitrary

 

When I try to run GDAL_Translate.. (gdal_translate -of jp2kak
gltp:/rpf/d:/rpf:"1:50K@2@CADRG@DMAAC@0":Matrix  gdal_jp2test.jp2) I get
an error message ...

ERROR 1: Invalid URL. The rpf directory is invalid

GDALOpen failed - 1

Invalid URL. The rpf directory is invalid

 

Any suggestions on how I should specify a subdataset here?

 

Thanks,

Dave Murphy

 

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060601/46aa3023/attachment.html
From cbc at unc.edu  Thu Jun  1 11:59:39 2006
From: cbc at unc.edu (Chris Calloway)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] linking proj4
Message-ID: <447F0EEB.4030001@unc.edu>

I've done *some* looking around, and figure I'm at the point where I 
should ask...

Considering the gdal configure feature:

--with-static-proj4

described as:

"Compile with PROJ.4 statically"

Does this mean proj is automatically dynamically linked (if present in 
the library path or by ld.so.conf, etc.) by GDAL, or that the only 
possible linking of proj by GDAL is static?

-- 
Sincerely,

Chris Calloway
http://www.seacoos.org
office: 17-6 Venable Hall   phone: (919) 962-4323
mail: Campus Box #3300, UNC-CH, Chapel Hill, NC 27599






From richard.matsunaga at waypointinfo.com  Thu Jun  1 12:01:48 2006
From: richard.matsunaga at waypointinfo.com (Richard Matsunaga)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] projection info in mapinfo tab files corrupt
	whenspecifying -a_srs or -s_srs and -t_srs in ogr2ogr
In-Reply-To: <447E5A2A.2060105@pobox.com>
Message-ID: <001e01c68594$b07501b0$cd01a8c0@Maddog>

Now I'm confused. I had to fix this in order to get OGR working MI tabs.
Once the new release came out, I started using that version and it still
worked, so I assumed that the flag was changed in the GDAL build. Am I
wrong? Maybe I have some unintentional referencing happening!

The issue Peter has described is exactly the one which I was experiencing
and was solved by Daniel's suggestion below.

Richard 

-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Frank Warmerdam
Sent: May 31, 2006 11:08 PM
To: Daniel Morissette
Cc: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] projection info in mapinfo tab files corrupt
whenspecifying -a_srs or -s_srs and -t_srs in ogr2ogr

Daniel Morissette wrote:
> This may be related to a bug in the MITAB library which is used by OGR 
> to read/write TAB files:
> http://bugzilla.maptools.org/show_bug.cgi?id=1319#c7
> See also:
> http://bugzilla.maptools.org/show_bug.cgi?id=1254
> 
> Perhaps try rebuilding gdal/ogr/ogrsf_frmts/mitab with 
> -DMITAB_AFFINE_PARAMS (and then relink ogr2ogr) and see if the crash 
> goes away.

Daniel,

Should I be changing GDAL to build mitab this way?  Is there a reason this
isn't the default?

Best regards,
-- 
---------------------------------------+--------------------------------
---------------------------------------+------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org

_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev



From warmerdam at pobox.com  Thu Jun  1 15:32:12 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] linking proj4
In-Reply-To: <447F0EEB.4030001@unc.edu>
References: <447F0EEB.4030001@unc.edu>
Message-ID: <447F40BC.3050407@pobox.com>

Chris Calloway wrote:
> I've done *some* looking around, and figure I'm at the point where I 
> should ask...
> 
> Considering the gdal configure feature:
> 
> --with-static-proj4
> 
> described as:
> 
> "Compile with PROJ.4 statically"
> 
> Does this mean proj is automatically dynamically linked (if present in 
> the library path or by ld.so.conf, etc.) by GDAL, or that the only 
> possible linking of proj by GDAL is static?

Chris,

By default GDAL does not reference PROJ.4 at link time.  But at runtime
it will use dlopen() or LoadLibrary() to try and load the PROJ.4 DLL.
If found additional reprojection.  The --with-static-proj4 flag changes
things so that PROJ.4 is linked in at link time.  Despite the name, it
could actually be linking in the DLL or static version of PROJ.

I implemented this rather esoteric approach to avoid making GDAL directly
dependent on PROJ.  It would just use it at runtime if it was available.
I'm not so sure in retrospect that it was a good idea.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From warmerdam at pobox.com  Thu Jun  1 15:39:12 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] Subdatasets
In-Reply-To: <29474044C503AA40A6D6403925FB04EBA6C12F@mail02.stk.com>
References: <29474044C503AA40A6D6403925FB04EBA6C12F@mail02.stk.com>
Message-ID: <447F4260.3070009@pobox.com>

Murphy, David wrote:
> When I try to run GDAL_Translate.. (gdal_translate ?of jp2kak 
> gltp:/rpf/d:/rpf:"1:50K@2@CADRG@DMAAC@0":Matrix  gdal_jp2test.jp2) I get 
> an error message ?
> 
> ERROR 1: Invalid URL. The rpf directory is invalid


David,

I believe the issue is that the command shell is "evaluating out" the
double quotes.  It is necessary for the double quotes to be preserved
into the GDAL programs so that they know the colon in "1:50K" is part of
the layer name, not a separator of the different parts of the subdataset
name.

On unix I would add single quotes around things, I'm not sure if that works
in the DOS window.

gdal_translate ?of jp2kak \
   'gltp:/rpf/d:/rpf:"1:50K@2@CADRG@DMAAC@0":Matrix'  gdal_jp2test.jp2

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From cbc at unc.edu  Thu Jun  1 15:54:25 2006
From: cbc at unc.edu (Chris Calloway)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] libnc-dap and gdal
Message-ID: <447F45F1.1030606@unc.edu>

Has anyone here built GDAL with the OpenDAP alternative NetCDF library 
(libnc-dap)? Is that even possible or a good idea?

If so, could you share how you configured a makefile to do that?

-- 
Sincerely,

Chris Calloway
http://www.seacoos.org
office: 17-6 Venable Hall   phone: (919) 962-4323
mail: Campus Box #3300, UNC-CH, Chapel Hill, NC 27599






From tonio_73 at tiscali.fr  Thu Jun  1 16:03:45 2006
From: tonio_73 at tiscali.fr (Antoine Hue)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] Building DLL's on Windows
In-Reply-To: <447D7384.9020105@tkk.fi>
References: <447B5B07.1020309@tkk.fi> <447B8F08.6070102@pobox.com>
	<447BD781.5080104@tkk.fi> <447C5F0C.9030003@loskot.net>
	<447D7384.9020105@tkk.fi>
Message-ID: <5c4a970a42cd67dd0e2ebbe0a16029fc@tiscali.fr>


Le 31 mai 06, ? 12:44, Ari Jolma a ?crit :

> Adding to this same theme, I managed to compile GDAL in MinGW+MSys,
> libral with GDAL and Perl in plain MinGW+dmake.exe,

Hello Ari,

what is the version of MinGW and gcc you have been using. We have tried 
to build gdal on MinGW with gcc 3.2.?, it requires some tweaking of the 
jpeg code to get it straight:
-  gdal1.2.6/frmts/jpeg/libjpeg/jpeglib.h : line 82 add : typedef int 
boolean;
-  gdal1.2.6/frmts/jpeg/libjpeg/jmorecfg.h : comment line 229
With gcc 3.4.? (latest version available in MinGW), there is a type 
cast issue.

With gdal 1.3.1 it was even more complex, we did not manage to make it.

Antoine


From jcleary at email.unc.edu  Thu Jun  1 17:15:34 2006
From: jcleary at email.unc.edu (Jesse Cleary)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] OGR DODS multiple attribute layer
Message-ID: <447F58F6.7090707@email.unc.edu>

Hi folks

Apologies for cross-posting.  I'm using OGR to connect through a DODS 
server to a netCDF file and map the results in MapServer - very slick 
and working well for single attributes.  However, I'd also like to get 
multiple attributes at once from the same DODS dataset - like 
wind_direction (for LABELANGLEITEM) /and/ wind_speed  (for CLASSITEM) 
and can't figure out the syntax to make that work. The DODS URL call 
seems to work with additional variables in the CE, but the DATA 
parameter does not.  New to this OGR/DODS method so any advice is 
greatly appreciated...

Thanks!

Jesse Cleary

MapServer 4.8.1
GDAL 1.3.2

This single attribute mapfile snip works well...
<--
LAYER
  NAME  "JPOP_test"
  TYPE POINT
  CONNECTIONTYPE OGR
  CONNECTION 
'DODS:http://nemo.isis.unc.edu/cgi-bin/nph-dods/data/nc-coos/test_data/JPIER/nccoos-JPOP-met-latest.nc?air_pressure[0][0][0]'
  DATA "air_pressure"
  STATUS OFF
  CLASSITEM 'air_pressure'
  LABELITEM 'air_pressure'
...
-->


But I'd like to move to something like this.  Not working though - 
"msOGRFileOpen(): OGR error. GetLayer(wind_from_direction, air_pressure) 
failed for OGR connection" although the DODS URL in a browser (minor 
changes) does return the data I want.  I've tried a few DATA 
permutations - I think this is crux of the problem if its possible at all.
<--
LAYER
  NAME  "JPOP_test"
  TYPE POINT
  CONNECTIONTYPE OGR
  CONNECTION 
'DODS:http://nemo.isis.unc.edu/cgi-bin/nph-dods/data/nc-coos/test_data/JPIER/nccoos-JPOP-met-latest.nc?wind_speed[0][0][0],wind_from_direction[0][0][0]'
  DATA "wind_speed, wind_from_direction"
  STATUS OFF
  CLASSITEM wind_speed'
  LABELANGLEITEM 'wind_from_direction'
...
-->



-- 
Jesse Cleary				
Department of Marine Sciences	
UNC Chapel Hill

17-6 Venable Hall
jcleary@email.unc.edu
(919) 962-4323










From ari.jolma at tkk.fi  Thu Jun  1 17:24:53 2006
From: ari.jolma at tkk.fi (Ari Jolma)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] Building DLL's on Windows
In-Reply-To: <5c4a970a42cd67dd0e2ebbe0a16029fc@tiscali.fr>
References: <447B5B07.1020309@tkk.fi> <447B8F08.6070102@pobox.com>
	<447BD781.5080104@tkk.fi> <447C5F0C.9030003@loskot.net>
	<447D7384.9020105@tkk.fi>
	<5c4a970a42cd67dd0e2ebbe0a16029fc@tiscali.fr>
Message-ID: <447F5B25.6000602@tkk.fi>

Antoine Hue kirjoitti:
>
> Le 31 mai 06, ? 12:44, Ari Jolma a ?crit :
>
>> Adding to this same theme, I managed to compile GDAL in MinGW+MSys,
>> libral with GDAL and Perl in plain MinGW+dmake.exe,
>
> Hello Ari,
>
> what is the version of MinGW and gcc you have been using. We have 
> tried to build gdal on MinGW with gcc 3.2.?, it requires some tweaking 
> of the jpeg code to get it straight:
> -  gdal1.2.6/frmts/jpeg/libjpeg/jpeglib.h : line 82 add : typedef int 
> boolean;
> -  gdal1.2.6/frmts/jpeg/libjpeg/jmorecfg.h : comment line 229
> With gcc 3.4.? (latest version available in MinGW), there is a type 
> cast issue.
>
> With gdal 1.3.1 it was even more complex, we did not manage to make it.

I seem to have gcc 3.4.2  in MinGW. I had some problems with something 
that I do not remember now -- some small configuration thing --, but 
otherwise the compilation went ok. I used the instructions I found on 
web (e.g. http://www.remotesensing.org/gdal/faq.html) that does not 
produce a DLL. I believe that's one reason why the wrapper dll's are so big.

MinGW does not seem to have a mingw.dll, which includes all its libraries?

Ari

>
> Antoine


-- 
Prof. Ari Jolma
Kartografia ja Geoinformatiikka / Cartography and Geoinformatics
Teknillinen Korkeakoulu / Helsinki University of Technology
POBox 1200, 02015 TKK, Finland
Email: ari.jolma at tkk.fi URL: http://www.tkk.fi/~jolma


From robert.w.rose at gmail.com  Thu Jun  1 18:58:29 2006
From: robert.w.rose at gmail.com (Robert Rose)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] Warping Plate Carree images to Mercator
Message-ID: <a606edc30606011558v1d930d72x346a95f2a90fdf85@mail.gmail.com>

Howdy folks!  I'm super-new to GDAL and the whole GIS space.  I've got
a question that I think is pretty simple...

I'm trying to warp the NASA BlueMarble images into Mercator WGS84
projected images.  The documentation on BlueMarble says that they come
in the Plate Carree WGS84 projection system.

For starters I'm trying to take the lowest-resolution 8km whole-world
image and convert it into a 512x512 GeoTIFF in Mercator.  Below is my
best guess so far as to how to do this with the gdal command line
utilities:

> gdal_translate -a_srs EPSG:32662 -gcp 0 0 -180 90 -gcp 5400 0 180 90 -gcp 5400 2700 180 -90 world.jpg world.tif
Input file size is 5400, 2700
0...10...20...30...40...50...60...70...80...90...100 - done.

> gdalinfo world.tif
Driver: GTiff/GeoTIFF
Size is 5400, 2700
Coordinate System is `'
GCP Projection = PROJCS["WGS 84 / Plate Carree",GEOGCS["WGS 84",DATUM["WGS_1984"
,SPHEROID["WGS 84",6378137,298.2572235630016,AUTHORITY["EPSG","7030"]],AUTHORITY
["EPSG","6326"]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433],AUTHORI
TY["EPSG","4326"]],UNIT["metre",1,AUTHORITY["EPSG","9001"]],AUTHORITY["EPSG","32
662"]]
GCP[  0]: Id=1, Info=
          (0,0) -> (-180,90,0)
GCP[  1]: Id=2, Info=
          (5400,0) -> (180,90,0)
GCP[  2]: Id=3, Info=
          (5400,2700) -> (180,-90,0)
Metadata:
  AREA_OR_POINT=Area
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0, 2700.0)
Upper Right ( 5400.0,    0.0)
Lower Right ( 5400.0, 2700.0)
Center      ( 2700.0, 1350.0)
Band 1 Block=5400x1 Type=Byte, ColorInterp=Red
Band 2 Block=5400x1 Type=Byte, ColorInterp=Green
Band 3 Block=5400x1 Type=Byte, ColorInterp=Blue

>gdalwarp -s_srs EPSG:32662 -t_srs "+proj=merc +datum=WGS84" -ts 512
512 world.tif worldm.tif
Processing input file world.tif.
:0...10...20...30...40...50...60...70...80...90...100 - done.

The end result is definitely a 512x512 file that's been warped, but it
doesn't look at all like a Mercator projection of the Earth.

Any help would be greatly appreciated!  Thanks!

-robert

From jluis at ualg.pt  Thu Jun  1 20:13:44 2006
From: jluis at ualg.pt (Joaquim Luis)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] Warping Plate Carree images to Mercator
In-Reply-To: <a606edc30606011558v1d930d72x346a95f2a90fdf85@mail.gmail.com>
References: <a606edc30606011558v1d930d72x346a95f2a90fdf85@mail.gmail.com>
Message-ID: <447F82B8.9060107@ualg.pt>

Robert,
I don't know what you got, but I know that you cannot project the poles 
using a Mercator projection
(+/- 90 degrees are infinitely  deformed  in  Mercator)

Joaquim Luis
 
> Howdy folks!  I'm super-new to GDAL and the whole GIS space.  I've got
> a question that I think is pretty simple...
>
> I'm trying to warp the NASA BlueMarble images into Mercator WGS84
> projected images.  The documentation on BlueMarble says that they come
> in the Plate Carree WGS84 projection system.
>
> For starters I'm trying to take the lowest-resolution 8km whole-world
> image and convert it into a 512x512 GeoTIFF in Mercator.  Below is my
> best guess so far as to how to do this with the gdal command line
> utilities:
>
>> gdal_translate -a_srs EPSG:32662 -gcp 0 0 -180 90 -gcp 5400 0 180 90 
>> -gcp 5400 2700 180 -90 world.jpg world.tif
> Input file size is 5400, 2700
> 0...10...20...30...40...50...60...70...80...90...100 - done.
>
>> gdalinfo world.tif
> Driver: GTiff/GeoTIFF
> Size is 5400, 2700
> Coordinate System is `'
> GCP Projection = PROJCS["WGS 84 / Plate Carree",GEOGCS["WGS 
> 84",DATUM["WGS_1984"
> ,SPHEROID["WGS 
> 84",6378137,298.2572235630016,AUTHORITY["EPSG","7030"]],AUTHORITY
> ["EPSG","6326"]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433],AUTHORI 
>
> TY["EPSG","4326"]],UNIT["metre",1,AUTHORITY["EPSG","9001"]],AUTHORITY["EPSG","32 
>
> 662"]]
> GCP[  0]: Id=1, Info=
>          (0,0) -> (-180,90,0)
> GCP[  1]: Id=2, Info=
>          (5400,0) -> (180,90,0)
> GCP[  2]: Id=3, Info=
>          (5400,2700) -> (180,-90,0)
> Metadata:
>  AREA_OR_POINT=Area
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0, 2700.0)
> Upper Right ( 5400.0,    0.0)
> Lower Right ( 5400.0, 2700.0)
> Center      ( 2700.0, 1350.0)
> Band 1 Block=5400x1 Type=Byte, ColorInterp=Red
> Band 2 Block=5400x1 Type=Byte, ColorInterp=Green
> Band 3 Block=5400x1 Type=Byte, ColorInterp=Blue
>
>> gdalwarp -s_srs EPSG:32662 -t_srs "+proj=merc +datum=WGS84" -ts 512
> 512 world.tif worldm.tif
> Processing input file world.tif.
> :0...10...20...30...40...50...60...70...80...90...100 - done.
>
> The end result is definitely a 512x512 file that's been warped, but it
> doesn't look at all like a Mercator projection of the Earth.
>
> Any help would be greatly appreciated!  Thanks!
>
> -robert
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>
>


From robert.w.rose at gmail.com  Thu Jun  1 20:31:15 2006
From: robert.w.rose at gmail.com (Robert Rose)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] Warping Plate Carree images to Mercator
In-Reply-To: <447F82B8.9060107@ualg.pt>
References: <a606edc30606011558v1d930d72x346a95f2a90fdf85@mail.gmail.com>
	<447F82B8.9060107@ualg.pt>
Message-ID: <a606edc30606011731u70099060w5b092ad8c3e0ce1e@mail.gmail.com>

Ah, thank you!  That helps, but I still can't figure it out.

Basically what I'm trying to do is convert this:

http://veimages.gsfc.nasa.gov/7107/world.topo.bathy.200408.3x5400x2700.jpg

Into something that looks like this:

http://maps.google.com/?ll=4.915833,56.25&spn=179.778788,360&t=k&om=1

-robert

On 6/1/06, Joaquim Luis <jluis@ualg.pt> wrote:
>
> Robert,
> I don't know what you got, but I know that you cannot project the poles
> using a Mercator projection
> (+/- 90 degrees are infinitely  deformed  in  Mercator)
>
> Joaquim Luis
>
> > Howdy folks!  I'm super-new to GDAL and the whole GIS space.  I've got
> > a question that I think is pretty simple...
> >
> > I'm trying to warp the NASA BlueMarble images into Mercator WGS84
> > projected images.  The documentation on BlueMarble says that they come
> > in the Plate Carree WGS84 projection system.
> >
> > For starters I'm trying to take the lowest-resolution 8km whole-world
> > image and convert it into a 512x512 GeoTIFF in Mercator.  Below is my
> > best guess so far as to how to do this with the gdal command line
> > utilities:
> >
> >> gdal_translate -a_srs EPSG:32662 -gcp 0 0 -180 90 -gcp 5400 0 180 90
> >> -gcp 5400 2700 180 -90 world.jpg world.tif
> > Input file size is 5400, 2700
> > 0...10...20...30...40...50...60...70...80...90...100 - done.
> >
> >> gdalinfo world.tif
> > Driver: GTiff/GeoTIFF
> > Size is 5400, 2700
> > Coordinate System is `'
> > GCP Projection = PROJCS["WGS 84 / Plate Carree",GEOGCS["WGS
> > 84",DATUM["WGS_1984"
> > ,SPHEROID["WGS
> > 84",6378137,298.2572235630016,AUTHORITY["EPSG","7030"]],AUTHORITY
> > ["EPSG","6326"]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433
> ],AUTHORI
> >
> >
> TY["EPSG","4326"]],UNIT["metre",1,AUTHORITY["EPSG","9001"]],AUTHORITY["EPSG","32
> >
> > 662"]]
> > GCP[  0]: Id=1, Info=
> >          (0,0) -> (-180,90,0)
> > GCP[  1]: Id=2, Info=
> >          (5400,0) -> (180,90,0)
> > GCP[  2]: Id=3, Info=
> >          (5400,2700) -> (180,-90,0)
> > Metadata:
> >  AREA_OR_POINT=Area
> > Corner Coordinates:
> > Upper Left  (    0.0,    0.0)
> > Lower Left  (    0.0, 2700.0)
> > Upper Right ( 5400.0,    0.0)
> > Lower Right ( 5400.0, 2700.0)
> > Center      ( 2700.0, 1350.0)
> > Band 1 Block=5400x1 Type=Byte, ColorInterp=Red
> > Band 2 Block=5400x1 Type=Byte, ColorInterp=Green
> > Band 3 Block=5400x1 Type=Byte, ColorInterp=Blue
> >
> >> gdalwarp -s_srs EPSG:32662 -t_srs "+proj=merc +datum=WGS84" -ts 512
> > 512 world.tif worldm.tif
> > Processing input file world.tif.
> > :0...10...20...30...40...50...60...70...80...90...100 - done.
> >
> > The end result is definitely a 512x512 file that's been warped, but it
> > doesn't look at all like a Mercator projection of the Earth.
> >
> > Any help would be greatly appreciated!  Thanks!
> >
> > -robert
> > _______________________________________________
> > Gdal-dev mailing list
> > Gdal-dev@lists.maptools.org
> > http://lists.maptools.org/mailman/listinfo/gdal-dev
> >
> >
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060601/81f96135/attachment.html
From jluis at ualg.pt  Thu Jun  1 21:18:15 2006
From: jluis at ualg.pt (Joaquim Luis)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] Warping Plate Carree images to Mercator
In-Reply-To: <a606edc30606011731u70099060w5b092ad8c3e0ce1e@mail.gmail.com>
References: <a606edc30606011558v1d930d72x346a95f2a90fdf85@mail.gmail.com>	
	<447F82B8.9060107@ualg.pt>
	<a606edc30606011731u70099060w5b092ad8c3e0ce1e@mail.gmail.com>
Message-ID: <447F91D7.5020201@ualg.pt>

I don't know what is the projection of  the Google image. Maybe a Miller 
cylindrical.
I don't know either the proj string to do it.
You can look at the GMT cookbook to see many example maps of different 
projections.
(the site seams to be having some problems right now)

Joaquim
>
> Ah, thank you!  That helps, but I still can't figure it out.
>
> Basically what I'm trying to do is convert this:
>
> http://veimages.gsfc.nasa.gov/7107/world.topo.bathy.200408.3x5400x2700.jpg 
> <http://veimages.gsfc.nasa.gov/7107/world.topo.bathy.200408.3x5400x2700.jpg>
>
> Into something that looks like this:
>
> http://maps.google.com/?ll=4.915833,56.25&spn=179.778788,360&t=k&om=1 
> <http://maps.google.com/?ll=4.915833,56.25&spn=179.778788,360&t=k&om=1>
>


From shaun.kolomeitz at epa.qld.gov.au  Thu Jun  1 22:08:39 2006
From: shaun.kolomeitz at epa.qld.gov.au (Shaun Kolomeitz)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] RE: Gdal-dev Digest, Vol 25, Issue 1
Message-ID: <T78a10de6149384f0e1678@goshawk.env.qld.gov.au>

Martin,

Many thanks for the suggestion however I am using gcc-3.4.2 (plus gmake 3.8) on Solaris10.

LDFLAGS=-lstdc++
CFLAGS="-D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64"
LD_LIBRARY_PATH=/usr/sfw/lib:/usr/local/lib:/opt/csw/lib:/usr/lib
PATH=/usr/sfw/bin:/usr/local/bin:/opt/csw/bin:/usr/bin:/usr/sbin
export PATH LD_LIBRARY_PATH LDFLAGS CFLAGS

./configure --with-gnu-ld --prefix=/usr/local/bin --with-local=/usr/local \
--with-pg=/usr/local/pgsql/bin/pg_config --with-mysql=/usr/bin/mysql_config \
--with-jasper=/usr/local/include/jasper --with-ecw=/usr/local \
--with-mrsid=/usr/local/GeoExpressSDK --with-static-proj4=/usr/local/share/proj --with-geos=/usr/local/bin/geos-config \
--with-python

Are you able to compile in ECW ? ECW Compiles successfully (with the examples running fine), but GDAL has a cow when compiling with ECW.

Regards,
Shaun

> Date: Thu, 1 Jun 2006 09:57:37 +0000 (UTC)
> From: Martin Spott <Martin.Spott@mgras.net>
> Subject: Re: [Gdal-dev] GNU Compile of GDAL on Solaris
> To: gdal-dev@lists.maptools.org
> Message-ID: <e5mdmh$14u0$1@osprey.mgras.de>
> 
> Gregory Yetman wrote:
> 
> > I did some digging, apparently the math.h library has been replaced
> > with a .so file on Solaris. There is a math.h file in:
> > 
> > /opt/sfw/lib/gcc-lib/sparc-sun-solaris2.9/2.95.3/include/ [...]
> 
> I can't tell you any specifics regarding your GCC version. Maybe you'd
> want to try GCC-3.4.2 from Sunfreeware which I used to compile
> GDAL-1.3.1 on Solaris8,
> 
> 	Martin.
> -- 



___________________________
Disclaimer

This e-mail, including attachments if any, has originated from a Queensland government agency and may contain information that is confidential, or covered by legal professional privilege, and is intended for the named recipient(s) only.  If you have received this message in error, you are asked to inform the sender as quickly as possible and delete this message and any copies of this message from your computer system network.

Any form of disclosure, modification, distribution and/or publication of this e-mail, including attachments is prohibited.  Unless otherwise stated, this e-mail, including attachments represents the views of the sender and not the views of the Environmental Protection Agency.

Although this e-mail has been checked for the presence of computer viruses, the Environmental Protection Agency provides no warranty that all possible viruses have been detected and cleaned.  Any use of this e-mail could harm your computer system.
___________________________



From mark at overmeer.net  Fri Jun  2 05:12:52 2006
From: mark at overmeer.net (Mark Overmeer)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] tiff to jp2ecw
In-Reply-To: <20060529151808.GD11636@earth.overmeer.net>
References: <20060529095924.GA11636@earth.overmeer.net>
	<447B0584.30207@pobox.com>
	<20060529151808.GD11636@earth.overmeer.net>
Message-ID: <20060602091252.GS11636@earth.overmeer.net>

* Mark Overmeer (mark@overmeer.net) [060529 17:18]:

> * Frank Warmerdam (warmerdam@pobox.com) [060529 14:30]:
> > > (1) the input.tif (geotiff) contains 6 images, created with
> > >       geotifcp [123456].tif input.tif
> > >     however, the resulting output.jp2 contains only one image (the first)
> > 
> > Basically GDAL treats GeoTIFF as a one-image-per-file format.
> > If you wanted the six images treated as bands of a single image then
> > you could use a different mechanism to merge the bands. Let me know if
> > that was your desire.
> 
> Yes, that is (probably) what I need.  Six bands in one image of six images
> in one file.... probably both work.  How can I achieve the former?

This seems to me as quite a common request: I have 9 seperate GTiff bands
of a LandSat scene and need to repack them into three jpeg2000 files
where equally sized bands are packed into one jpeg2000 (to be accessed
with ERmapper)

I have tried different paths without success. Anyone with an example script?
-- 
Thanks in advance,

               MarkOv

From josegomez at gmx.net  Fri Jun  2 06:31:35 2006
From: josegomez at gmx.net (Jose Luis Gomez Dans)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] MODIS Equal Area Sinusoidal projection
Message-ID: <20060602103135.56160@gmx.net>

Hi!
The MODIS HDF files for level 4 (and up) products are given using the "Equal Area Sinusoidal Projection". I have tried to select one dataset, and export it to a GeoTIFF file using GDAL, but the projection information does not seem to work.The output GeoTIFF file does have the right metadata, thre resulting raster is not properly reprojected. I have also tried to set the source projection with "+proj=sinu", but this does not seem to produce a good result.

What I want to do is to extract one dataset from a MODIS HDF file, reproject it to UTM and then cut an area of interest. However, without dealing with the projection issue first.

Any pointers would be very appreciated!

Many thanks,
Jose
-- 


Der GMX SmartSurfer hilft bis zu 70% Ihrer Onlinekosten zu sparen!
      Ideal f?r Modem und ISDN: http://www.gmx.net/de/go/smartsurfer
    

From guillaume.huby.lists at gmail.com  Fri Jun  2 08:12:10 2006
From: guillaume.huby.lists at gmail.com (guillaume huby)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] MODIS Equal Area Sinusoidal projection
Message-ID: <ddc797c30606020512l3c46842ep93f909ebec7fb2f8@mail.gmail.com>

Hi Jose

> -----Message d'origine-----
> De : gdal-dev-bounces@lists.maptools.org
> [mailto:gdal-dev-bounces@lists.maptools.org] De la part de
> Jose Luis Gomez Dans
> Envoy? : vendredi 2 juin 2006 12:32
> ? : gdal-dev@lists.maptools.org
> Objet : [Gdal-dev] MODIS Equal Area Sinusoidal projection
>
>
> Hi!
> The MODIS HDF files for level 4 (and up) products are given
> using the "Equal Area Sinusoidal Projection". I have tried to
> select one dataset, and export it to a GeoTIFF file using
> GDAL, but the projection information does not seem to
> work.The output GeoTIFF file does have the right metadata,
> thre resulting raster is not properly reprojected. I have
> also tried to set the source projection with "+proj=sinu",
> but this does not seem to produce a good result.
>
> What I want to do is to extract one dataset from a MODIS HDF
> file, reproject it to UTM and then cut an area of interest.
> However, without dealing with the projection issue first.
>
> Any pointers would be very appreciated!

You should try HEG Tool
http://newsroom.gsfc.nasa.gov/sdptoolkit/HEG/HEGHome.html.
This tool is made for EOS datasets including MODIS. There is a UTM option
for repojection and subsetting. You can also use it in batch mode. But I do
not think it uses GDAL.

Regards,
Guillaume HUBY.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060602/127299c5/attachment.html
From ari.jolma at tkk.fi  Fri Jun  2 09:59:42 2006
From: ari.jolma at tkk.fi (Ari Jolma)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] MinGW build of gdal & perl wrappers
Message-ID: <4480444E.6060308@tkk.fi>

I've made a MinGW build of the gdal 1.3.2 release and I included the
Perl wrappers. I also built Perl with MinGW.

The build process is documented and the results are available at
http://map.hut.fi/gdal-perl/

The zip files should be manually installable to a windows machine with
MinGW. I would appreciate if somebody tested them.

Cheers,

Ari

-- 
Prof. Ari Jolma
Kartografia ja Geoinformatiikka / Cartography and Geoinformatics
Teknillinen Korkeakoulu / Helsinki University of Technology
tel: +358 9 451 3886 address: POBox 1200, 02015 TKK, Finland
Email: ari.jolma at tkk.fi URL: http://www.tkk.fi/~jolma

From lxnyce at gmail.com  Fri Jun  2 10:13:37 2006
From: lxnyce at gmail.com (Lennox Antoine)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] Warping Plate Carree images to Mercator
In-Reply-To: <447F91D7.5020201@ualg.pt>
References: <a606edc30606011558v1d930d72x346a95f2a90fdf85@mail.gmail.com>
	<447F82B8.9060107@ualg.pt>
	<a606edc30606011731u70099060w5b092ad8c3e0ce1e@mail.gmail.com>
	<447F91D7.5020201@ualg.pt>
Message-ID: <82c245aa0606020713l5b8cf165qc14934aee496fbbd@mail.gmail.com>

I believe this is the same projection used in VirtualEarth
(http://local.live.com/default.aspx?v=2&cp=0~0&style=h&lvl=1&scene=1875974),
so you can check out the projection they used to get it into
Geographic LL coordinates.

http://www.brains-n-brawn.com/default.aspx?vDir=veworldwind

I'll paste the reprojection area of the code here :

//NOTE tiles did not line up properly with ellps=WGS84
//string [] projectionParameters = new string[]{"proj=merc",
"ellps=WGS84", "no.defs"};
//+proj=longlat +ellps=sphere +a=6370997.0 +es=0.0
string [] projectionParameters = new string[]{"proj=merc",
"ellps=sphere", "a=" + earthRadius.ToString(), "es=0.0", "no.defs"};
proj = new Projection(projectionParameters);

I have also had luck estimating it with tangent and log functions
without using proj.4.

-Lennox


On 6/1/06, Joaquim Luis <jluis@ualg.pt> wrote:
> I don't know what is the projection of  the Google image. Maybe a Miller
> cylindrical.
> I don't know either the proj string to do it.
> You can look at the GMT cookbook to see many example maps of different
> projections.
> (the site seams to be having some problems right now)
>
> Joaquim
> >
> > Ah, thank you!  That helps, but I still can't figure it out.
> >
> > Basically what I'm trying to do is convert this:
> >
> > http://veimages.gsfc.nasa.gov/7107/world.topo.bathy.200408.3x5400x2700.jpg
> > <http://veimages.gsfc.nasa.gov/7107/world.topo.bathy.200408.3x5400x2700.jpg>
> >
> > Into something that looks like this:
> >
> > http://maps.google.com/?ll=4.915833,56.25&spn=179.778788,360&t=k&om=1
> > <http://maps.google.com/?ll=4.915833,56.25&spn=179.778788,360&t=k&om=1>
> >
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>

From warmerdam at pobox.com  Fri Jun  2 10:25:06 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] tiff to jp2ecw
In-Reply-To: <20060602091252.GS11636@earth.overmeer.net>
References: <20060529095924.GA11636@earth.overmeer.net>
	<447B0584.30207@pobox.com>
	<20060529151808.GD11636@earth.overmeer.net>
	<20060602091252.GS11636@earth.overmeer.net>
Message-ID: <44804A42.7090008@pobox.com>

Mark Overmeer wrote:
> * Mark Overmeer (mark@overmeer.net) [060529 17:18]:
> 
>> * Frank Warmerdam (warmerdam@pobox.com) [060529 14:30]:
>>>> (1) the input.tif (geotiff) contains 6 images, created with
>>>>       geotifcp [123456].tif input.tif
>>>>     however, the resulting output.jp2 contains only one image (the first)
>>> Basically GDAL treats GeoTIFF as a one-image-per-file format.
>>> If you wanted the six images treated as bands of a single image then
>>> you could use a different mechanism to merge the bands. Let me know if
>>> that was your desire.
>> Yes, that is (probably) what I need.  Six bands in one image of six images
>> in one file.... probably both work.  How can I achieve the former?
> 
> This seems to me as quite a common request: I have 9 seperate GTiff bands
> of a LandSat scene and need to repack them into three jpeg2000 files
> where equally sized bands are packed into one jpeg2000 (to be accessed
> with ERmapper)
> 
> I have tried different paths without success. Anyone with an example script?

Mark,

You can use the gdal_merge.py script to "stack" files into a multi-band
file.

eg.

gdal_merge -separate -o stack.tif band1.tif band2.tif band3.tif

The -separate tells the script to put each file into it's own band.

There is also a "Compose Dataset" tool in OpenEV (in the Image menu)
that apparently does this process, though I haven't used this myself yet.

Both are available in FWTools builds.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From tbeckman at usgs.gov  Fri Jun  2 10:29:19 2006
From: tbeckman at usgs.gov (Tim Beckmann)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] MODIS Equal Area Sinusoidal projection
In-Reply-To: <ddc797c30606020512l3c46842ep93f909ebec7fb2f8@mail.gmail.com>
Message-ID: <OFC2EF4E2F.4E35574F-ON86257181.004F77C4-05257181.004FAF19@usgs.gov>

Or try the MODIS reprojection tool available at 
http://edcdaac.usgs.gov/landdaac/tools/modis/index.asp


gdal-dev-bounces@lists.maptools.org wrote on 06/02/2006 07:12:10 AM:

> Hi Jose
> 
> > -----Message d'origine-----
> > De : gdal-dev-bounces@lists.maptools.org
> > [mailto: gdal-dev-bounces@lists.maptools.org] De la part de 
> > Jose Luis Gomez Dans
> > Envoy? : vendredi 2 juin 2006 12:32
> > ? : gdal-dev@lists.maptools.org
> > Objet : [Gdal-dev] MODIS Equal Area Sinusoidal projection
> > 
> > 
> > Hi!
> > The MODIS HDF files for level 4 (and up) products are given
> > using the "Equal Area Sinusoidal Projection". I have tried to 
> > select one dataset, and export it to a GeoTIFF file using 
> > GDAL, but the projection information does not seem to 
> > work.The output GeoTIFF file does have the right metadata, 
> > thre resulting raster is not properly reprojected. I have 
> > also tried to set the source projection with "+proj=sinu", 
> > but this does not seem to produce a good result.
> > 
> > What I want to do is to extract one dataset from a MODIS HDF
> > file, reproject it to UTM and then cut an area of interest. 
> > However, without dealing with the projection issue first.
> > 
> > Any pointers would be very appreciated!
> 
> You should try HEG Tool http://newsroom.gsfc.nasa.
> gov/sdptoolkit/HEG/HEGHome.html.
> This tool is made for EOS datasets including MODIS. There is a UTM 
> option for repojection and subsetting. You can also use it in batch 
> mode. But I do not think it uses GDAL. 
> 
> Regards,
> Guillaume HUBY._______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060602/f0a818c4/attachment.html
From zhonghaiw at gmail.com  Fri Jun  2 10:48:35 2006
From: zhonghaiw at gmail.com (Zhonghai Wang)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] Warping Plate Carree images to Mercator
In-Reply-To: <82c245aa0606020713l5b8cf165qc14934aee496fbbd@mail.gmail.com>
References: <a606edc30606011558v1d930d72x346a95f2a90fdf85@mail.gmail.com>
	<447F82B8.9060107@ualg.pt>
	<a606edc30606011731u70099060w5b092ad8c3e0ce1e@mail.gmail.com>
	<447F91D7.5020201@ualg.pt>
	<82c245aa0606020713l5b8cf165qc14934aee496fbbd@mail.gmail.com>
Message-ID: <2534c4120606020748r501519bap280b6d583f001b87@mail.gmail.com>

Hi Lennox,

http://local.live.com/default.aspx?v=2&cp=0~0&style=h&lvl=1&scene=1875974,

is this an application using ka-map?

zhonghai

On 6/2/06, Lennox Antoine <lxnyce@gmail.com> wrote:
>
> I believe this is the same projection used in VirtualEarth
> (http://local.live.com/default.aspx?v=2&cp=0~0&style=h&lvl=1&scene=1875974
> ),
> so you can check out the projection they used to get it into
> Geographic LL coordinates.
>
> http://www.brains-n-brawn.com/default.aspx?vDir=veworldwind
>
> I'll paste the reprojection area of the code here :
>
> //NOTE tiles did not line up properly with ellps=WGS84
> //string [] projectionParameters = new string[]{"proj=merc",
> "ellps=WGS84", "no.defs"};
> //+proj=longlat +ellps=sphere +a=6370997.0 +es=0.0
> string [] projectionParameters = new string[]{"proj=merc",
> "ellps=sphere", "a=" + earthRadius.ToString(), "es=0.0", "no.defs"};
> proj = new Projection(projectionParameters);
>
> I have also had luck estimating it with tangent and log functions
> without using proj.4.
>
> -Lennox
>
>
> On 6/1/06, Joaquim Luis <jluis@ualg.pt> wrote:
> > I don't know what is the projection of  the Google image. Maybe a Miller
> > cylindrical.
> > I don't know either the proj string to do it.
> > You can look at the GMT cookbook to see many example maps of different
> > projections.
> > (the site seams to be having some problems right now)
> >
> > Joaquim
> > >
> > > Ah, thank you!  That helps, but I still can't figure it out.
> > >
> > > Basically what I'm trying to do is convert this:
> > >
> > >
> http://veimages.gsfc.nasa.gov/7107/world.topo.bathy.200408.3x5400x2700.jpg
> > > <
> http://veimages.gsfc.nasa.gov/7107/world.topo.bathy.200408.3x5400x2700.jpg
> >
> > >
> > > Into something that looks like this:
> > >
> > > http://maps.google.com/?ll=4.915833,56.25&spn=179.778788,360&t=k&om=1
> > > <http://maps.google.com/?ll=4.915833,56.25&spn=179.778788,360&t=k&om=1
> >
> > >
> >
> > _______________________________________________
> > Gdal-dev mailing list
> > Gdal-dev@lists.maptools.org
> > http://lists.maptools.org/mailman/listinfo/gdal-dev
> >
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060602/d2cdc727/attachment.html
From Charles.Wivell at dnr.state.mn.us  Fri Jun  2 10:53:32 2006
From: Charles.Wivell at dnr.state.mn.us (Charles Wivell)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] MODIS Equal Area Sinusoidal projection
Message-ID: <s4800ac2.018@co5.dnr.state.mn.us>

Hi;

See Tim Beckmann's reply, but also, I think you'd want to subset before reprojecting (or subset during the reprojection), since a MODIS image covers many UTM zones. Also remember the resolution of MODIS images varies greatly as you move away from nadir.

Chuck Wivell

P.S. Don't get me started on the Hugh Dumb Format....



>>> Jose Luis Gomez Dans <josegomez@gmx.net> 6/2/2006 5:31 AM >>>
Hi!
The MODIS HDF files for level 4 (and up) products are given using the "Equal Area Sinusoidal Projection". I have tried to select one dataset, and export it to a GeoTIFF file using GDAL, but the projection information does not seem to work.The output GeoTIFF file does have the right metadata, thre resulting raster is not properly reprojected. I have also tried to set the source projection with "+proj=sinu", but this does not seem to produce a good result.

What I want to do is to extract one dataset from a MODIS HDF file, reproject it to UTM and then cut an area of interest. However, without dealing with the projection issue first.

Any pointers would be very appreciated!

Many thanks,
Jose
-- 


Der GMX SmartSurfer hilft bis zu 70% Ihrer Onlinekosten zu sparen!
      Ideal f?r Modem und ISDN: http://www.gmx.net/de/go/smartsurfer 
    
_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org 
http://lists.maptools.org/mailman/listinfo/gdal-dev



From robert.w.rose at gmail.com  Fri Jun  2 12:09:21 2006
From: robert.w.rose at gmail.com (Robert Rose)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] Warping Plate Carree images to Mercator
In-Reply-To: <82c245aa0606020713l5b8cf165qc14934aee496fbbd@mail.gmail.com>
References: <a606edc30606011558v1d930d72x346a95f2a90fdf85@mail.gmail.com>
	<447F82B8.9060107@ualg.pt>
	<a606edc30606011731u70099060w5b092ad8c3e0ce1e@mail.gmail.com>
	<447F91D7.5020201@ualg.pt>
	<82c245aa0606020713l5b8cf165qc14934aee496fbbd@mail.gmail.com>
Message-ID: <1B90C12D-F76F-4458-B3A9-50C853BB652E@gmail.com>


On Jun 2, 2006, at 7:13 AM, Lennox Antoine wrote:

> I believe this is the same projection used in VirtualEarth
> (http://local.live.com/default.aspx? 
> v=2&cp=0~0&style=h&lvl=1&scene=1875974),
> so you can check out the projection they used to get it into
> Geographic LL coordinates.
>
> http://www.brains-n-brawn.com/default.aspx?vDir=veworldwind
>
> I'll paste the reprojection area of the code here :
>
> //NOTE tiles did not line up properly with ellps=WGS84
> //string [] projectionParameters = new string[]{"proj=merc",
> "ellps=WGS84", "no.defs"};
> //+proj=longlat +ellps=sphere +a=6370997.0 +es=0.0
> string [] projectionParameters = new string[]{"proj=merc",
> "ellps=sphere", "a=" + earthRadius.ToString(), "es=0.0", "no.defs"};
> proj = new Projection(projectionParameters);
>
> I have also had luck estimating it with tangent and log functions
> without using proj.4.

Hi Lennox, thanks for the response.

I'm not sure how to turn what you've given me into command line  
parameters for gdalwarp or gdaltranslate tho...  The Mercator  
projection string sounds pretty similar to what I was trying before...

1) Save http://veimages.gsfc.nasa.gov/7107/world.topo.bathy. 
200408.3x5400x2700.jpg as world.jpg..

2) gdal_translate -a_srs EPSG:32662 -gcp 0 0 -180 90 -gcp 5400 0 180  
90 -gcp 5400 2700 180 -90 world.jpg world.tif

3) gdalwarp -s_srs EPSG:32662 -t_srs "+proj=merc +datum=WGS84" -ts  
512 512 world.tif worldm.tif

(EPSG:32662 is the projection code for WGS84 Plate Carree)

So are you suggesting I add "+ellps=sphere", "es=0" and  
"+a=earthRadius" to my gdalwarp command?

-robert
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060602/666c13ab/attachment.html
From warmerdam at pobox.com  Fri Jun  2 16:18:21 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] libnc-dap and gdal
In-Reply-To: <447F45F1.1030606@unc.edu>
References: <447F45F1.1030606@unc.edu>
Message-ID: <44809D0D.1090502@pobox.com>

Chris Calloway wrote:
> Has anyone here built GDAL with the OpenDAP alternative NetCDF library 
> (libnc-dap)? Is that even possible or a good idea?
> 
> If so, could you share how you configured a makefile to do that?

Chris,

Is this supposed to make a report opendap dataset look like a local
netcdf file?  I'm not convinced this would be better than treating
a remote opendap datasource using the dods driver.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From nbest at speakeasy.net  Fri Jun  2 10:36:17 2006
From: nbest at speakeasy.net (Neil Best)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] gdal for ubuntu
Message-ID: <1149258978.9695.216.camel@localhost.localdomain>

Hello, everybody.  I have been trying to build gdal from source for my
ubuntu breezy box and have had some problems building .debs for both
1.3.1 and 1.3.2.  How can I learn more about the status of the debian/
sub-directory and the possibility of getting upgraded packages into the
ubuntu repositories?  I am not even sure up which tree to bark, so any
guidance is appreciated.

I saw some old notes about the gdal packages being stuck at 1.2.6, but
no explanation why.  What are the roadblocks?

Anyone here involved with UbuntuGIS?  
https://wiki.ubuntu.com/UbuntuGIS


Neil



From mateusz at loskot.net  Fri Jun  2 17:54:11 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] gdal for ubuntu
In-Reply-To: <1149258978.9695.216.camel@localhost.localdomain>
References: <1149258978.9695.216.camel@localhost.localdomain>
Message-ID: <4480B383.2080108@loskot.net>

Neil Best wrote:
> Hello, everybody.  I have been trying to build gdal from source for 
> my ubuntu breezy box and have had some problems building .debs for 
> both 1.3.1 and 1.3.2.

Does it mean your problem is with building Debian packages (deb) or
building GDAL binaries from source?

> How can I learn more about the status of the debian/ sub-directory
> and the possibility of getting upgraded packages into the ubuntu
> repositories?

Do you mean 'debian' directory in GDAL sources tree?

> Anyone here involved with UbuntuGIS? 
> https://wiki.ubuntu.com/UbuntuGIS

I was involved for a while (2 months ago) as I'm Ubuntu user
but I had to break for a (longer) while. I'll try to be back in a 2-3
months.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From MChapman at sanz.com  Sat Jun  3 19:54:04 2006
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] unit_of_measure.csv
Message-ID: <ED3A48B9840E594890A2BC172D11946502F9C56C@mailman.san.com>

In the data file unit_of_measure.csv, what do the columns FACTOR_B and
FACTOR_C represent?  Is one of them meters per unit?

 

Best regards,

Martin

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060603/fcf42dbe/attachment.html
From lxnyce at gmail.com  Sat Jun  3 21:03:19 2006
From: lxnyce at gmail.com (Lennox Antoine)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] Warping Plate Carree images to Mercator
In-Reply-To: <1B90C12D-F76F-4458-B3A9-50C853BB652E@gmail.com>
References: <a606edc30606011558v1d930d72x346a95f2a90fdf85@mail.gmail.com>
	<447F82B8.9060107@ualg.pt>
	<a606edc30606011731u70099060w5b092ad8c3e0ce1e@mail.gmail.com>
	<447F91D7.5020201@ualg.pt>
	<82c245aa0606020713l5b8cf165qc14934aee496fbbd@mail.gmail.com>
	<1B90C12D-F76F-4458-B3A9-50C853BB652E@gmail.com>
Message-ID: <82c245aa0606031803g5d1e8753ge73af11db48ad464@mail.gmail.com>

I am hoping that if you use the same projection string, you should get
the result you're looking for. They use it to map from Virtual Earth's
Mercator projection to LL, so likewise it "should" be good to use for
LL to Mercator. It doesn't look that way though.

-Lennox

On 6/2/06, Robert Rose <robert.w.rose@gmail.com> wrote:
>
>
>
> On Jun 2, 2006, at 7:13 AM, Lennox Antoine wrote:
>
> I believe this is the same projection used in VirtualEarth
> (http://local.live.com/default.aspx?v=2&cp=0~0&style=h&lvl=1&scene=1875974),
> so you can check out the projection they used to get it into
> Geographic LL coordinates.
>
> http://www.brains-n-brawn.com/default.aspx?vDir=veworldwind
>
> I'll paste the reprojection area of the code here :
>
> //NOTE tiles did not line up properly with ellps=WGS84
> //string [] projectionParameters = new string[]{"proj=merc",
> "ellps=WGS84", "no.defs"};
> //+proj=longlat +ellps=sphere +a=6370997.0 +es=0.0
> string [] projectionParameters = new string[]{"proj=merc",
> "ellps=sphere", "a=" + earthRadius.ToString(), "es=0.0", "no.defs"};
> proj = new Projection(projectionParameters);
>
> I have also had luck estimating it with tangent and log functions
> without using proj.4.
>
> Hi Lennox, thanks for the response.
>
> I'm not sure how to turn what you've given me into command line parameters
> for gdalwarp or gdaltranslate tho...  The Mercator projection string sounds
> pretty similar to what I was trying before...
>
> 1) Save
> http://veimages.gsfc.nasa.gov/7107/world.topo.bathy.200408.3x5400x2700.jpg
> as world.jpg..
>
> 2) gdal_translate -a_srs EPSG:32662 -gcp 0 0 -180 90 -gcp 5400 0 180 90 -gcp
> 5400 2700 180 -90 world.jpg world.tif
>
> 3) gdalwarp -s_srs EPSG:32662 -t_srs "+proj=merc +datum=WGS84" -ts 512 512
> world.tif worldm.tif
>
> (EPSG:32662 is the projection code for WGS84 Plate Carree)
>
> So are you suggesting I add "+ellps=sphere", "es=0" and "+a=earthRadius" to
> my gdalwarp command?
>
> -robert

From MChapman at sanz.com  Sat Jun  3 21:59:47 2006
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] unit_of_measure
Message-ID: <ED3A48B9840E594890A2BC172D11946502F9C56D@mailman.san.com>

In the data file unit_of_measure.csv, what do the columns FACTOR_B and
FACTOR_C represent?  Is one of them meters per unit?

 

Best regards,

Martin

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060603/2d5d46db/attachment.html
From epatton at nrcan.gc.ca  Mon Jun  5 09:39:32 2006
From: epatton at nrcan.gc.ca (Patton, Eric)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] gdal for ubuntu
Message-ID: <0E5A77B55A57D511BB3F0002A537C262064111A3@s5-dar-r1.nrn.nrcan.gc.ca>

Hi Neil.

I've been struggling with getting gdal compiled from source in Ubuntu for
weeks now to no avail (see
http://lists.maptools.org/pipermail/gdal-dev/2006-May/008865.html).

I'm using Ubuntu Dapper, have applied all available updates through Synaptic
to date.

Just for fun, here's the output from my latest unsuccessful make run:

creating libgdal.la
/bin/sed: can't read /usr/lib/libstdc++.la: No such file or directory
libtool: link: `/usr/lib/libstdc++.la' is not a valid libtool archive
make[1]: *** [libgdal.la] Error 1
make[1]: Leaving directory `/opt/gdal-1.3.2'
make: *** [check-lib] Error 2

This output is the same as in my original post. Glynn Clements had suggested
on the Grass GIS list to make a symbolic link between libstdc++.so.6 and
libstdc++.so, and hopefully that will cause it to pick up the shared C++
library rather than the static version. I tried this idea this morning with
no success. So I'm quite at a loss as to what to do next.

~ Eric.



 

-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
To: gdal-dev@lists.maptools.org
Sent: 6/2/2006 10:36 AM
Subject: [Gdal-dev] gdal for ubuntu

Hello, everybody.  I have been trying to build gdal from source for my
ubuntu breezy box and have had some problems building .debs for both
1.3.1 and 1.3.2.  How can I learn more about the status of the debian/
sub-directory and the possibility of getting upgraded packages into the
ubuntu repositories?  I am not even sure up which tree to bark, so any
guidance is appreciated.

I saw some old notes about the gdal packages being stuck at 1.2.6, but
no explanation why.  What are the roadblocks?

Anyone here involved with UbuntuGIS?  
https://wiki.ubuntu.com/UbuntuGIS


Neil


_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev

From warmerdam at pobox.com  Mon Jun  5 11:54:47 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] unit_of_measure
In-Reply-To: <ED3A48B9840E594890A2BC172D11946502F9C56D@mailman.san.com>
References: <ED3A48B9840E594890A2BC172D11946502F9C56D@mailman.san.com>
Message-ID: <448453C7.8020902@pobox.com>

Chapman, Martin wrote:
> In the data file unit_of_measure.csv, what do the columns FACTOR_B and 
> FACTOR_C represent?  Is one of them meters per unit?

Martin,

I think "factor_b/factor_c" (ie treating them as a ratio) gives the
multiplier between meters and the units in question.  I believe that this
ratio is used so that some units can be defined more precisely in terms of
the original definition.  So, a US survey inch is defined as being 1/39.37
of a meter.  And a US Survey foot is 12 of these so 12/39.37.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From mateusz at loskot.net  Mon Jun  5 12:16:37 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] Re: [mdb-dev] Invalid soname
In-Reply-To: <20060604034639.92034.qmail@web54311.mail.yahoo.com>
References: <20060604034639.92034.qmail@web54311.mail.yahoo.com>
Message-ID: <448458E5.5080901@loskot.net>

Jeff Smith wrote:
> --- Mateusz Loskot <mateusz@loskot.net> wrote:
> 
>>As you can see, MDB Tools libraries have invalid soname.
>>Accordint to odbcinst.ini definition of MDB driver, I had to create symlink:
>>
>>$ ln -s /usr/local/lib/libmdbodbc.0.0.0 /usr/local/lib/libmdbodbc.so.0
>>
>>Is this known issue or I did something wrong?
> 
> 
> Yes, this is a known issue with 0.6pre1, which shipped with a bad ltmain.sh.
> Option 1: go to source directory, run 'libtoolize -f -c', then rerun
> configure/make/make install.  Option 2: use mdbtools from CVS.


Jeff,

Thank you for your explanation.
It's clear.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From cbc at unc.edu  Mon Jun  5 12:30:42 2006
From: cbc at unc.edu (Chris Calloway)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] libnc-dap and gdal
In-Reply-To: <44809D0D.1090502@pobox.com>
References: <447F45F1.1030606@unc.edu> <44809D0D.1090502@pobox.com>
Message-ID: <44845C32.2040401@unc.edu>

Frank Warmerdam wrote:
> Is this supposed to make a report opendap dataset look like a local
> netcdf file?

Yep.

> I'm not convinced this would be better than treating
> a remote opendap datasource using the dods driver.

Yep. Just wondering. We're doing that now through PyDap.

-- 
Sincerely,

Chris Calloway
http://www.seacoos.org
office: 17-6 Venable Hall   phone: (919) 962-4323
mail: Campus Box #3300, UNC-CH, Chapel Hill, NC 27599





From mateusz at loskot.net  Mon Jun  5 12:35:21 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] Re: [mdb-dev] Invalid soname
In-Reply-To: <448458E5.5080901@loskot.net>
References: <20060604034639.92034.qmail@web54311.mail.yahoo.com>
	<448458E5.5080901@loskot.net>
Message-ID: <44845D49.7030404@loskot.net>

Ups! Sorry, I put wrong e-mail address.
Please, ignore this post.
Mateusz

Mateusz Loskot wrote:
> Jeff Smith wrote:
> 
>>--- Mateusz Loskot <mateusz@loskot.net> wrote:
>>
>>
>>>As you can see, MDB Tools libraries have invalid soname.
>>>Accordint to odbcinst.ini definition of MDB driver, I had to create symlink:
>>>
>>>$ ln -s /usr/local/lib/libmdbodbc.0.0.0 /usr/local/lib/libmdbodbc.so.0
>>>
>>>Is this known issue or I did something wrong?
>>
>>
>>Yes, this is a known issue with 0.6pre1, which shipped with a bad ltmain.sh.
>>Option 1: go to source directory, run 'libtoolize -f -c', then rerun
>>configure/make/make install.  Option 2: use mdbtools from CVS.
> 
> 
> 
> Jeff,
> 
> Thank you for your explanation.
> It's clear.
> 
> Cheers


-- 
Mateusz Loskot
http://mateusz.loskot.net

From werchowyna at epf.pl  Mon Jun  5 12:51:43 2006
From: werchowyna at epf.pl (Maciek Sieczka)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] gdal for ubuntu
In-Reply-To: <0E5A77B55A57D511BB3F0002A537C262064111A3@s5-dar-r1.nrn.nrcan.gc.ca>
References: <0E5A77B55A57D511BB3F0002A537C262064111A3@s5-dar-r1.nrn.nrcan.gc.ca>
Message-ID: <20060605185143.e74b1af3.werchowyna@epf.pl>

Eric,

Just to let you know - I built GDAL CVS succesfully on an x86 machine
under Dapper RC 2 last friday or so. I don't have it available to do any
tetsing tough, wasn't mine (myself still on Breezy).

Maciek

--------------------
W polskim Internecie s? setki milion?w stron. My przekazujemy Tobie tylko najlepsze z nich!
http://katalog.panoramainternetu.pl/


From epatton at nrcan.gc.ca  Mon Jun  5 12:58:39 2006
From: epatton at nrcan.gc.ca (Patton, Eric)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] gdal for ubuntu
Message-ID: <0E5A77B55A57D511BB3F0002A537C262064111A8@s5-dar-r1.nrn.nrcan.gc.ca>

Maciek,

Did you compile it with or without libtool support? Do you remember what
compile flags you used?

--
Eric Patton 
epatton@nrcan.gc.ca

-----Original Message-----
From: Maciek Sieczka [mailto:werchowyna@epf.pl] 
Sent: Monday, June 05, 2006 1:52 PM
To: Patton, Eric
Cc: nbest@speakeasy.net; gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] gdal for ubuntu

Eric,

Just to let you know - I built GDAL CVS succesfully on an x86 machine under
Dapper RC 2 last friday or so. I don't have it available to do any tetsing
tough, wasn't mine (myself still on Breezy).

Maciek

--------------------
W polskim Internecie s? setki milion?w stron. My przekazujemy Tobie tylko
najlepsze z nich!
http://katalog.panoramainternetu.pl/


From rec at geodesign.com.br  Mon Jun  5 13:13:11 2006
From: rec at geodesign.com.br (Reinaldo Escada Chohfi)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] gdalwarp Transparency Question
Message-ID: <6.2.1.2.0.20060605135931.01ce49c8@mailhost.geodesign.com.br>

Hello,

I'm runing gdalwarp (FWTools 1.0.0a7) to mosaic geotiff images because the 
images are large and I run into memory problems with gdal_merge.

I get some strange results in several mosaics in the overlapping areas 
between images.  I use -srcnodata 0 to have gdalwarp do the transparency in 
these overlapping areas.

My question is, if am using -scrnodata 0, will the transparency be made 
when all 3 pixel values are 0, 0, 0 (RGB) or whenever any of the bands has 
a pixel value equal to 0?  It looks like I get a transparency only in the 
Blue, sometimes only in the Red or Green bands and the image has blue, red 
or green spots.  Do I have to use -scrnodata value "0 0 0" in order to get 
transparency only when RGB are equal to 0, 0, 0?

Thanks in advance for the help.

Reinaldo


From werchowyna at epf.pl  Mon Jun  5 13:27:17 2006
From: werchowyna at epf.pl (Maciek Sieczka)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] gdal for ubuntu
In-Reply-To: <0E5A77B55A57D511BB3F0002A537C262064111A8@s5-dar-r1.nrn.nrcan.gc.ca>
References: <0E5A77B55A57D511BB3F0002A537C262064111A8@s5-dar-r1.nrn.nrcan.gc.ca>
Message-ID: <20060605192717.cb9b910e.werchowyna@epf.pl>

On Mon, 5 Jun 2006 13:58:39 -0300 
"Patton, Eric" <epatton@nrcan.gc.ca> wrote:

> Maciek,
> 
> Did you compile it with or without libtool support? Do you remember
> what compile flags you used?

No problem, I almost always use the same flags for my GIS stuff and
always have them at hand :)

./configure --with-hdf4=/usr/local/lib --with-libz=internal
--with-png=internal --with-libtiff=internal --with-geotiff=internal
--with-jpeg=internal --with-gif=internal --with-geos=yes
--with-pg=/usr/bin/pg_config --with-sqlite=/usr/local/lib

geos,sqlite,postgres, all python pieces were from Dapper repos

proj4, hdf4 from CVS source

Maciek

--------------------
W polskim Internecie s? setki milion?w stron. My przekazujemy Tobie tylko najlepsze z nich!
http://katalog.panoramainternetu.pl/


From warmerdam at pobox.com  Mon Jun  5 14:37:45 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] gdalwarp Transparency Question
In-Reply-To: <6.2.1.2.0.20060605135931.01ce49c8@mailhost.geodesign.com.br>
References: <6.2.1.2.0.20060605135931.01ce49c8@mailhost.geodesign.com.br>
Message-ID: <448479F9.4010008@pobox.com>

Reinaldo Escada Chohfi wrote:
> Hello,
> 
> I'm runing gdalwarp (FWTools 1.0.0a7) to mosaic geotiff images because 
> the images are large and I run into memory problems with gdal_merge.
> 
> I get some strange results in several mosaics in the overlapping areas 
> between images.  I use -srcnodata 0 to have gdalwarp do the transparency 
> in these overlapping areas.
> 
> My question is, if am using -scrnodata 0, will the transparency be made 
> when all 3 pixel values are 0, 0, 0 (RGB) or whenever any of the bands 
> has a pixel value equal to 0?  It looks like I get a transparency only 
> in the Blue, sometimes only in the Red or Green bands and the image has 
> blue, red or green spots.  Do I have to use -scrnodata value "0 0 0" in 
> order to get transparency only when RGB are equal to 0, 0, 0?
> 
> Thanks in advance for the help.

Reinaldo,

Looking at the code, it seems I implemented UNIFIED_SRC_NODATA as the
default for gdalwarp circa September 2005.  A quick checks shows FWTools
1.0.0a7 as being built in early November of 2005.  So it should include this.

The UNIFIED_SRC_NODATA enabling forces gdalwarp to only consider a pixel as
nodata if the values match for all bands.  So, gdalwarp *should* do what
you want already.  That it is not may be a bug in one or more of the
warping logic cases.

Could you first try a newer FWTools and see if the problem persists?  If it
does, could you submit a bug report detailing how to reproduce your problem?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From epatton at nrcan.gc.ca  Mon Jun  5 15:13:15 2006
From: epatton at nrcan.gc.ca (Patton, Eric)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] What python libs are required for gdal compile?
Message-ID: <0E5A77B55A57D511BB3F0002A537C262064111AC@s5-dar-r1.nrn.nrcan.gc.ca>

Having received repeated libtool errors during compliation, I complied with
libtool support suppressed:

./configure --with-libz=internal --with-png=internal \
--with-libtiff=internal \
--with-geotiff=internal \
--with-jpeg=internal \
--with-gif=internal \
--with-sqlite=/usr/local/lib \
--with-libtool=no

And received the following errors:

...
<snip>
(Note: There are dozens of lines of gdal_wrap.c errors. Shown are the last
20 or so lines of these)
gdal_wrap.c:12032: warning: initialization makes integer from pointer
without a cast
gdal_wrap.c:12032: warning: excess elements in scalar initializer
gdal_wrap.c:12032: warning: (near initialization for '_gdalMethods[407]')
gdal_wrap.c:12032: warning: excess elements in scalar initializer
gdal_wrap.c:12032: warning: (near initialization for '_gdalMethods[407]')
gdal_wrap.c:12033: warning: braces around scalar initializer
gdal_wrap.c:12033: warning: (near initialization for '_gdalMethods[408]')
gdal_wrap.c:12033: warning: initialization makes integer from pointer
without a cast
gdal_wrap.c:12033: warning: excess elements in scalar initializer
gdal_wrap.c:12033: warning: (near initialization for '_gdalMethods[408]')
gdal_wrap.c:12034: warning: data definition has no type or storage class
gdal_wrap.c:12035: error: syntax error before '*' token
gdal_wrap.c:12035: warning: type defaults to 'int' in declaration of
'SWIG_globals'
gdal_wrap.c:12035: warning: data definition has no type or storage class
gdal_wrap.c: In function 'init_gdal':
gdal_wrap.c:12040: error: 'PyObject' undeclared (first use in this function)
gdal_wrap.c:12040: error: 'm' undeclared (first use in this function)
gdal_wrap.c:12040: error: 'd' undeclared (first use in this function)
gdal_wrap.c:12040: warning: left-hand operand of comma expression has no
effect
gdal_wrap.c:12040: warning: statement with no effect
gdal_wrap.c:12042: warning: implicit declaration of function 'Py_InitModule'
gdal_wrap.c:12043: warning: implicit declaration of function
'PyModule_GetDict'
make[1]: *** [gdal_wrap.o] Error 1
make[1]: Leaving directory `/opt/gdal-1.3.2/pymod'
make: *** [py-module] Error 2

Does anyone know what these errors mean? Are these errors indicate problems
with my python libraries?

~ Eric.


From rec at geodesign.com.br  Mon Jun  5 17:40:50 2006
From: rec at geodesign.com.br (Reinaldo Escada Chohfi)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] gdalwarp Transparency Question
In-Reply-To: <448479F9.4010008@pobox.com>
References: <6.2.1.2.0.20060605135931.01ce49c8@mailhost.geodesign.com.br>
	<448479F9.4010008@pobox.com>
Message-ID: <6.2.1.2.0.20060605183436.01cadeb0@mailhost.geodesign.com.br>

Frank,

I downloaded and installed FWTools 1.0.0 Win.  The gdalwarp transparency 
problem did not happen with this new version.  I tested on two images that 
I would get blue spots on the overlapping areas.  The new version did the 
transparency without the blue spots.  I'll let you know if it happens with 
other mosaics.

Thanks a lot.

Reinaldo.

At 03:37 PM 6/5/2006, Frank Warmerdam wrote:
>Reinaldo Escada Chohfi wrote:
>>Hello,
>>I'm runing gdalwarp (FWTools 1.0.0a7) to mosaic geotiff images because 
>>the images are large and I run into memory problems with gdal_merge.
>>I get some strange results in several mosaics in the overlapping areas 
>>between images.  I use -srcnodata 0 to have gdalwarp do the transparency 
>>in these overlapping areas.
>>My question is, if am using -scrnodata 0, will the transparency be made 
>>when all 3 pixel values are 0, 0, 0 (RGB) or whenever any of the bands 
>>has a pixel value equal to 0?  It looks like I get a transparency only in 
>>the Blue, sometimes only in the Red or Green bands and the image has 
>>blue, red or green spots.  Do I have to use -scrnodata value "0 0 0" in 
>>order to get transparency only when RGB are equal to 0, 0, 0?
>>Thanks in advance for the help.
>
>Reinaldo,
>
>Looking at the code, it seems I implemented UNIFIED_SRC_NODATA as the
>default for gdalwarp circa September 2005.  A quick checks shows FWTools
>1.0.0a7 as being built in early November of 2005.  So it should include this.
>
>The UNIFIED_SRC_NODATA enabling forces gdalwarp to only consider a pixel as
>nodata if the values match for all bands.  So, gdalwarp *should* do what
>you want already.  That it is not may be a bug in one or more of the
>warping logic cases.
>
>Could you first try a newer FWTools and see if the problem persists?  If it
>does, could you submit a bug report detailing how to reproduce your problem?
>
>Best regards,
>--
>---------------------------------------+--------------------------------------
>I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
>light and sound - activate the windows | http://pobox.com/~warmerdam
>and watch the world go round - Rush    | President OSGF, http://osgeo.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060605/43824ac6/attachment.html
From zhonghaiw at gmail.com  Tue Jun  6 06:34:54 2006
From: zhonghaiw at gmail.com (Zhonghai Wang)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] raster image preprocessing problem.
Message-ID: <2534c4120606060334t69cc6e6vd21f4021f29a6343@mail.gmail.com>

Hi there,

I have a couple of GIFs with wld files, but the original Projection is not
the one I want, I tried to use the Proj4 to reproject them on-the-fly, but
it takes really long to perform the map request, therefore I tried
to preprocess the images with GDAL tools, but I've got some problems here:

1. problem with gdalwarp: trying to mosaic the images into one output file,
but only the first image has the correct image color, the other images are
rendered with strange colors, is this a common problem if using gdalwarp to
mosaic images?

2.problem with gdal_merge.py: after trying the gdalwarp command, I've tried
the gdal_merge.py command to merge all the images together with the -pct
parameter, unfortunately, the merged image is the same as the first try. is
it possible to merge images using the command with the correct color table?

BTW: I can not use the gdal_translate command, since there are gaps between
the reprojected images.

thanks for your info.

zhonghai
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060606/37f7ada6/attachment.html
From josegomez at gmx.net  Tue Jun  6 06:45:42 2006
From: josegomez at gmx.net (Jose Luis Gomez Dans)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] MODIS Equal Area Sinusoidal projection
In-Reply-To: <s4800ac1.017@co5.dnr.state.mn.us>
References: <s4800ac1.017@co5.dnr.state.mn.us>
Message-ID: <20060606104542.66410@gmx.net>


Hi, and thanks to all who replied!
So, to sum it up: it is not possible to use GDAL as it is to subset and reproject MODIS Level4 files, I need to first convert the data using ons of the external teams provided by the MODIS team to achieve this. Is this correct?

Cheers,
Jose
-- 


Der GMX SmartSurfer hilft bis zu 70% Ihrer Onlinekosten zu sparen!
      Ideal f?r Modem und ISDN: http://www.gmx.net/de/go/smartsurfer
    

From mark at overmeer.net  Tue Jun  6 07:48:26 2006
From: mark at overmeer.net (Mark Overmeer)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] tiff to jp2ecw
In-Reply-To: <44804A42.7090008@pobox.com>
References: <20060529095924.GA11636@earth.overmeer.net>
	<447B0584.30207@pobox.com>
	<20060529151808.GD11636@earth.overmeer.net>
	<20060602091252.GS11636@earth.overmeer.net>
	<44804A42.7090008@pobox.com>
Message-ID: <20060606114826.GC11636@earth.overmeer.net>

>> * Mark Overmeer (mark@overmeer.net) [060529 17:18]:
>> This seems to me as quite a common request: I have 9 seperate GTiff bands
>> of a LandSat scene and need to repack them into three jpeg2000 files
>> where equally sized bands are packed into one jpeg2000 (to be accessed
>> with ERmapper)

* Frank Warmerdam (warmerdam@pobox.com) [060602 14:25]:
> gdal_merge -separate -o stack.tif band1.tif band2.tif band3.tif
> The -separate tells the script to put each file into it's own band.

This works well, thank you.
The next step is to add/change color-interpretation and band-names.  After
studying for over two hours, I could not find-out how to get those in.
It should be automatic.  Hints?

I will make my script publicly available at the end.
-- 
CU,
               MarkOv

From warmerdam at pobox.com  Tue Jun  6 07:55:42 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] tiff to jp2ecw
In-Reply-To: <20060606114826.GC11636@earth.overmeer.net>
References: <20060529095924.GA11636@earth.overmeer.net>
	<447B0584.30207@pobox.com>
	<20060529151808.GD11636@earth.overmeer.net>
	<20060602091252.GS11636@earth.overmeer.net>
	<44804A42.7090008@pobox.com>
	<20060606114826.GC11636@earth.overmeer.net>
Message-ID: <44856D3E.8000002@pobox.com>

Mark Overmeer wrote:
> This works well, thank you.
> The next step is to add/change color-interpretation and band-names.  

Mark,

Setting band names is not supported by most format drivers, including
the jpeg2000 drivers.

To set the band color interpretation I would suggest using the
-co PHOTOMETRIC=RGB flag to gdal_merge.py.  This is a TIFF specific
flag, but once the TIFF file is set appropriately; hopefully the JPEG2000
will pick it up too.

The only other user-accessable mechanism for setting band color interpretation
(other than writing python/etc scripts) would be to create a VRT file - and
XML header of sorts - and adjust the band color interpretation in this.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From Charles.Wivell at dnr.state.mn.us  Tue Jun  6 09:42:39 2006
From: Charles.Wivell at dnr.state.mn.us (Charles Wivell)
Date: Wed Nov 21 11:50:11 2007
Subject: DIY: Reprojection...Re: [Gdal-dev] raster image preprocessing problem.
Message-ID: <s485400a.045@co5.dnr.state.mn.us>

Hi all;

There's been a lot of mail about reprojecting from one map projection to another. Writing a ditty (scientific term for quick program) to reproject an image from one map projection to another is pretty straight forward, once you have a projection library.

The projection library I use is called GCTP (General Cartographic Transformation package) it is free from the USGS.

ftp://edcftp.cr.usgs.gov/pub/software/gctpc/

I'll pseudo code the process below (the steps are the same no matter what language you use).

1) Read in the image into a memory buffer (input space)
2) Get the current map projection information (Projection, datum, Upper left corner projection parameters, size of pixel in X and Y)
3) Frame your output space
    - Calculate the output space upper left and lower right values
      - Lat, Lon, projection x/y, output space pixel size
4) Create a memory buffer for the output space
5) For each pixel in the output space
6) Find the projection x/y using the pixel size and offset of the pixel from the upper left corner
7) Convert output space projection x/y to lat, lon using GCTP (inverse projection)
8) Convert lat, lon to input space projection x/y using forward projection routine in GCTP
9) Convert projection x/y into line, sample (row, column)
10) Resample DN values in input space near the calculated input space line, sample
11) Place resampled DN value into the output space at current pixel location (line, sample)
12) Get next output pixel location (back to step 5)
13) Write the output space buffer to a file


I'm use to using the terms line, sample since my background is from satellite imagery (thats was usually how they collected data a line scanner). It is just the same as row, column or y,x (line is in the y direction and sample is in the x direction)

These are also the basic steps to warp an image from one space to another, just that steps 7 and 8 are replaced with a mathematical relationship, usually a polynomial of some kind. Or if I'm taking raw satellite imagery or photography and projecting it into a map projection then  steps 7 and 8 are replaced with a platform/sensor/earth mathematical model.

In step 10 you can use Nearest Neighbor (just round to the nearest pixel location) or for a little better looking final image use bilinear resampling.

Oops... I just gave away all my secrets of being a Geospatial programmer.... ;-)


Chuck Wivell

MN DNR Grand Rapids MN








>>> "Zhonghai Wang" <zhonghaiw@gmail.com> 6/6/2006 5:34 AM >>>
Hi there,

I have a couple of GIFs with wld files, but the original Projection is not
the one I want, I tried to use the Proj4 to reproject them on-the-fly, but
it takes really long to perform the map request, therefore I tried
to preprocess the images with GDAL tools, but I've got some problems here:

1. problem with gdalwarp: trying to mosaic the images into one output file,
but only the first image has the correct image color, the other images are
rendered with strange colors, is this a common problem if using gdalwarp to
mosaic images?

2.problem with gdal_merge.py: after trying the gdalwarp command, I've tried
the gdal_merge.py command to merge all the images together with the -pct
parameter, unfortunately, the merged image is the same as the first try. is
it possible to merge images using the command with the correct color table?

BTW: I can not use the gdal_translate command, since there are gaps between
the reprojected images.

thanks for your info.

zhonghai



From warmerdam at pobox.com  Tue Jun  6 10:08:45 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] Problem with Gdalwarp
In-Reply-To: <000301c683ab$286a4fe0$8788e289@digar>
References: <000301c683ab$286a4fe0$8788e289@digar>
Message-ID: <44858C6D.7030002@pobox.com>

[ESW] Jan B. wrote:
> Now, when I try to use the gdalwarp.exe  with
> 
> gdalwarp -t_srs \"+proj=utm +zone=11 +datum=WGS84\" source.tif target.tif
> 
> I get the error
> 
> ERROR 1: Too many points (441 out of 441) failed to transform,
> unable to compute output bounds.
> 
> I am searching for the problem now for 5 days and cannot find it.

Jan,

I'm not sure how the code you included relates to the above command.  Was
it used to prepare "source.tif"?   I downloaded the target.tif you provided,
and it is odd in that it has a geographic coordinate system, but projected
coordinates - fairly small projected coordinates which don't look like UTM
coordinates anywhere in Europe.

Can you provide source.tif for us to try the same gdalwarp you did above?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From dmurphy at agi.com  Tue Jun  6 11:27:31 2006
From: dmurphy at agi.com (Murphy, David)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] JP2ECW ColorTables
Message-ID: <29474044C503AA40A6D6403925FB04EBA6C9B6@mail02.stk.com>

Hello-

 

Is there a GDAL create option to enable the JP2ECW driver to handle
color tables?  Our goal is to translate 1-band HFA (*.img) files with a
color table to JP2ECW files, but it seems that the JP2ECW driver
defaults all 1-band files to greyscale.  Any info would help.

 

Thanks,

Dave Murphy

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060606/31d7f417/attachment.html
From robert.w.rose at gmail.com  Tue Jun  6 12:00:46 2006
From: robert.w.rose at gmail.com (Robert Rose)
Date: Wed Nov 21 11:50:11 2007
Subject: DIY: Reprojection...Re: [Gdal-dev] raster image preprocessing
	problem.
In-Reply-To: <s485400a.045@co5.dnr.state.mn.us>
References: <s485400a.045@co5.dnr.state.mn.us>
Message-ID: <49C197A3-1294-40AC-98B8-E188DB850465@gmail.com>


On Jun 6, 2006, at 6:42 AM, Charles Wivell wrote:

> Hi all;
>
> There's been a lot of mail about reprojecting from one map  
> projection to another. Writing a ditty (scientific term for quick  
> program) to reproject an image from one map projection to another  
> is pretty straight forward, once you have a projection library.
>
> The projection library I use is called GCTP (General Cartographic  
> Transformation package) it is free from the USGS.
>
> ftp://edcftp.cr.usgs.gov/pub/software/gctpc/
>
> I'll pseudo code the process below (the steps are the same no  
> matter what language you use).
>
> 1) Read in the image into a memory buffer (input space)
> 2) Get the current map projection information (Projection, datum,  
> Upper left corner projection parameters, size of pixel in X and Y)
> 3) Frame your output space
>     - Calculate the output space upper left and lower right values
>       - Lat, Lon, projection x/y, output space pixel size
> 4) Create a memory buffer for the output space
> 5) For each pixel in the output space
> 6) Find the projection x/y using the pixel size and offset of the  
> pixel from the upper left corner
> 7) Convert output space projection x/y to lat, lon using GCTP  
> (inverse projection)
> 8) Convert lat, lon to input space projection x/y using forward  
> projection routine in GCTP
> 9) Convert projection x/y into line, sample (row, column)
> 10) Resample DN values in input space near the calculated input  
> space line, sample
> 11) Place resampled DN value into the output space at current pixel  
> location (line, sample)
> 12) Get next output pixel location (back to step 5)
> 13) Write the output space buffer to a file
>
>
> I'm use to using the terms line, sample since my background is from  
> satellite imagery (thats was usually how they collected data a line  
> scanner). It is just the same as row, column or y,x (line is in the  
> y direction and sample is in the x direction)
>
> These are also the basic steps to warp an image from one space to  
> another, just that steps 7 and 8 are replaced with a mathematical  
> relationship, usually a polynomial of some kind. Or if I'm taking  
> raw satellite imagery or photography and projecting it into a map  
> projection then  steps 7 and 8 are replaced with a platform/sensor/ 
> earth mathematical model.
>
> In step 10 you can use Nearest Neighbor (just round to the nearest  
> pixel location) or for a little better looking final image use  
> bilinear resampling.
>
> Oops... I just gave away all my secrets of being a Geospatial  
> programmer.... ;-)


Hi Chuck,  I sent out that email last week about re-projecting a  
Plate Carree image of the Earth into Mercator... (I still haven't  
gotten a sufficient answer btw)..

Sure, I could use the process you describe above to re-project the  
image myself programmatically, but isn't the process you describe  
above exactly what gdalwarp is for?  Or do I have gdalwarp completely  
mistaken?  If so, that would explain why I haven't gotten it to do  
what I want! :-)

Actually I have had success using gdalwarp to convert UTM  
orthoimagery to Mercator, but that's obviously a much smaller area  
than the Earth.  Does gdalwarp have any limitations when you give it  
an image that's suppose to cover the entire Earth?  Maybe that's why  
I can't get this to work.

-robert



From c_pennock at yahoo.com  Tue Jun  6 12:01:11 2006
From: c_pennock at yahoo.com (Chris Pennock)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] Merging DEMs seamlessly
Message-ID: <20060606160111.91894.qmail@web51911.mail.yahoo.com>

All - 

Merging DEMs is a frequent topic, but the suggestion I
often see is like:

gdal_merge.py -o merged.tif dem1.dem dem2.dem

I when this is done, even if the two DEMs being merged
have the *same* corner points, I usually get a few
points of empty space between the dems in the merged
tif. 

Does anyone have any thoughts on why this would
happen, or a possbile fix? Perhaps the culprit is that
neither of of two dems has the set of height points
closest to the line forming their interface. I
thought, however, that for every column of height
points, that one dem or the other would have each
point on the column. 

Many thanks in advance for this very newbie question!

Chris

__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
http://mail.yahoo.com 

From warmerdam at pobox.com  Tue Jun  6 12:26:19 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] JP2ECW ColorTables
In-Reply-To: <29474044C503AA40A6D6403925FB04EBA6C9B6@mail02.stk.com>
References: <29474044C503AA40A6D6403925FB04EBA6C9B6@mail02.stk.com>
Message-ID: <4485ACAB.7000909@pobox.com>

Murphy, David wrote:
> Hello-
> 
>  
> 
> Is there a GDAL create option to enable the JP2ECW driver to handle 
> color tables?  Our goal is to translate 1-band HFA (*.img) files with a 
> color table to JP2ECW files, but it seems that the JP2ECW driver 
> defaults all 1-band files to greyscale.  Any info would help.

David,

Looking at the JP2ECW driver I don't see any mechanism to apply a color
table.  It seems this does exist with the JP2KAK driver, if that would
be an option for you.

I don't recall any support for color tables in the ECW SDK API though I
might have missed it.  So it may not be possible to extend the JP2ECW
driver to support writing them.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From warmerdam at pobox.com  Tue Jun  6 12:32:09 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] Merging DEMs seamlessly
In-Reply-To: <20060606160111.91894.qmail@web51911.mail.yahoo.com>
References: <20060606160111.91894.qmail@web51911.mail.yahoo.com>
Message-ID: <4485AE09.3070408@pobox.com>

Chris Pennock wrote:
> All - 
> 
> Merging DEMs is a frequent topic, but the suggestion I
> often see is like:
> 
> gdal_merge.py -o merged.tif dem1.dem dem2.dem
> 
> I when this is done, even if the two DEMs being merged
> have the *same* corner points, I usually get a few
> points of empty space between the dems in the merged
> tif. 
> 
> Does anyone have any thoughts on why this would
> happen, or a possbile fix? Perhaps the culprit is that
> neither of of two dems has the set of height points
> closest to the line forming their interface. I
> thought, however, that for every column of height
> points, that one dem or the other would have each
> point on the column. 
> 
> Many thanks in advance for this very newbie question!

Chris,

Can you provide a couple of DEM files which demonstrate this problem?
And what version of gdal_merge.py you are using?  There were some adjustments
made to try and address edge-effects some months ago.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From warmerdam at pobox.com  Tue Jun  6 12:40:27 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] Warping Plate Carree images to Mercator
In-Reply-To: <1B90C12D-F76F-4458-B3A9-50C853BB652E@gmail.com>
References: <a606edc30606011558v1d930d72x346a95f2a90fdf85@mail.gmail.com>	<447F82B8.9060107@ualg.pt>	<a606edc30606011731u70099060w5b092ad8c3e0ce1e@mail.gmail.com>	<447F91D7.5020201@ualg.pt>	<82c245aa0606020713l5b8cf165qc14934aee496fbbd@mail.gmail.com>
	<1B90C12D-F76F-4458-B3A9-50C853BB652E@gmail.com>
Message-ID: <4485AFFB.9050802@pobox.com>

Robert Rose wrote:
> Hi Lennox, thanks for the response.
> 
> I'm not sure how to turn what you've given me into command line 
> parameters for gdalwarp or gdaltranslate tho...  The Mercator projection 
> string sounds pretty similar to what I was trying before...
> 
> 1) 
> Save http://veimages.gsfc.nasa.gov/7107/world.topo.bathy.200408.3x5400x2700.jpg as 
> world.jpg..
> 
> 2) gdal_translate -a_srs EPSG:32662 -gcp 0 0 -180 90 -gcp 5400 0 180 90 
> -gcp 5400 2700 180 -90 world.jpg world.tif
> 
> 3) gdalwarp -s_srs EPSG:32662 -t_srs "+proj=merc +datum=WGS84" -ts 
> 512 512 world.tif worldm.tif
> 
> (EPSG:32662 is the projection code for WGS84 Plate Carree)
> 
> So are you suggesting I add "+ellps=sphere", "es=0" and "+a=earthRadius" 
> to my gdalwarp command?

Robert,

Sorry for not responding to this before.  I think at one point you asked
what is the difference between a world Plate Caree projections (ie.
EPSG:32662) and a geographic coordinate system like EPSG:4326.

The answer is that locations in a projected coordinate system are measured
in a linear unit like meters (for EPSG:32662) while they are measured in
degrees for a geographic coordinate system like EPSG:4326.

So the problem in the above sequence is trying to assign a projected
coordinate system during the gdal_translate while using degrees for the
locations.  You need to do:

gdal_translate -a_srs EPSG:4326 -gcp 0 0 -180 90 -gcp 5400 0 180 90
  -gcp 5400 2700 180 -90 world.jpg world.tif

gdalwarp -t_srs "+proj=merc +datum=WGS84" -ts 512 512 world.tif worldm.tif

Note that I dropped the -s_srs item from the gdalwarp as well, since
the gdal_translate assignes the coordinate system to the TIFF file.

You could also use the -a_ullr commandline switch with gdal_translate
instead of using GCPs though the overall effect after the gdalwarp is not
changed.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From Charles.Wivell at dnr.state.mn.us  Tue Jun  6 12:41:37 2006
From: Charles.Wivell at dnr.state.mn.us (Charles Wivell)
Date: Wed Nov 21 11:50:11 2007
Subject: DIY: Reprojection...Re: [Gdal-dev] raster image
	preprocessing problem.
Message-ID: <s4856a05.012@co5.dnr.state.mn.us>

Hi Robert;

I really couldn't tell you what GDALWarp can do, or is for. I'm a control freak.... I write the stuff myself. I only use GDAL to read and write data from/to the really icky file formats.

But warp to me says it uses a polynomial to warp from one projection to another (but maybe I'm wrong), where as the correct (more accurate way) is to use a projection library, like I outlined.

I think if it is doing a warp it might have problems (what is the degree of the polynomial used in the warp...?) and like was pointed out by another replier, since the Mercator projection is not defined at the poles, a polynomial might go off into lala land (technical term) quicker than using the projection library....?

But I'm guessing about GDALWarp....


Chuck Wivell

MN DNR Grand Rapids MN




>>> Robert Rose <robert.w.rose@gmail.com> 6/6/2006 11:00 AM >>>

On Jun 6, 2006, at 6:42 AM, Charles Wivell wrote:

> Hi all;
>
> There's been a lot of mail about reprojecting from one map  
> projection to another. Writing a ditty (scientific term for quick  
> program) to reproject an image from one map projection to another  
> is pretty straight forward, once you have a projection library.
>
> The projection library I use is called GCTP (General Cartographic  
> Transformation package) it is free from the USGS.
>
> ftp://edcftp.cr.usgs.gov/pub/software/gctpc/ 
>
> I'll pseudo code the process below (the steps are the same no  
> matter what language you use).
>
> 1) Read in the image into a memory buffer (input space)
> 2) Get the current map projection information (Projection, datum,  
> Upper left corner projection parameters, size of pixel in X and Y)
> 3) Frame your output space
>     - Calculate the output space upper left and lower right values
>       - Lat, Lon, projection x/y, output space pixel size
> 4) Create a memory buffer for the output space
> 5) For each pixel in the output space
> 6) Find the projection x/y using the pixel size and offset of the  
> pixel from the upper left corner
> 7) Convert output space projection x/y to lat, lon using GCTP  
> (inverse projection)
> 8) Convert lat, lon to input space projection x/y using forward  
> projection routine in GCTP
> 9) Convert projection x/y into line, sample (row, column)
> 10) Resample DN values in input space near the calculated input  
> space line, sample
> 11) Place resampled DN value into the output space at current pixel  
> location (line, sample)
> 12) Get next output pixel location (back to step 5)
> 13) Write the output space buffer to a file
>
>
> I'm use to using the terms line, sample since my background is from  
> satellite imagery (thats was usually how they collected data a line  
> scanner). It is just the same as row, column or y,x (line is in the  
> y direction and sample is in the x direction)
>
> These are also the basic steps to warp an image from one space to  
> another, just that steps 7 and 8 are replaced with a mathematical  
> relationship, usually a polynomial of some kind. Or if I'm taking  
> raw satellite imagery or photography and projecting it into a map  
> projection then  steps 7 and 8 are replaced with a platform/sensor/ 
> earth mathematical model.
>
> In step 10 you can use Nearest Neighbor (just round to the nearest  
> pixel location) or for a little better looking final image use  
> bilinear resampling.
>
> Oops... I just gave away all my secrets of being a Geospatial  
> programmer.... ;-)


Hi Chuck,  I sent out that email last week about re-projecting a  
Plate Carree image of the Earth into Mercator... (I still haven't  
gotten a sufficient answer btw)..

Sure, I could use the process you describe above to re-project the  
image myself programmatically, but isn't the process you describe  
above exactly what gdalwarp is for?  Or do I have gdalwarp completely  
mistaken?  If so, that would explain why I haven't gotten it to do  
what I want! :-)

Actually I have had success using gdalwarp to convert UTM  
orthoimagery to Mercator, but that's obviously a much smaller area  
than the Earth.  Does gdalwarp have any limitations when you give it  
an image that's suppose to cover the entire Earth?  Maybe that's why  
I can't get this to work.

-robert


_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org 
http://lists.maptools.org/mailman/listinfo/gdal-dev


From ILucena at clarku.edu  Tue Jun  6 14:13:43 2006
From: ILucena at clarku.edu (Ivan Lucena)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] JP2ECW ColorTables
Message-ID: <6FD7C9DB26540B42A1207C69BF92D455015A33B0@Iris.ad.clarku.edu>

Dave,

 

I think it's a limitation of JPEG. It can't handle a color table at all.
You can check the free Intel or Microsoft implementation, but I guess
that JPEG wasn't designed for it or the compression algorithm does not
work with color table (now I am stretching my luck ;-)

 

I had the same problem and Frank advised me to look at the Python script
"pct2rgb.py" in the GDAL /bin folder to see how it creates a temporary
RGB GeoTiff and then translate it to JPEG. The advantage that I've found
in this technique is that it also allow you to convert input data types
other them byte to JPEG. You just need to normalize the values in 0-255
and use it as an color index.

 

I've implemented it in Delphi (+ GDAL) and its working fine.

 

Lucena, Ivan

 

________________________________

From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Murphy, David
Sent: Tuesday, June 06, 2006 11:28 AM
To: gdal-dev@lists.maptools.org
Subject: [Gdal-dev] JP2ECW ColorTables

 

Hello-

 

Is there a GDAL create option to enable the JP2ECW driver to handle
color tables?  Our goal is to translate 1-band HFA (*.img) files with a
color table to JP2ECW files, but it seems that the JP2ECW driver
defaults all 1-band files to greyscale.  Any info would help.

 

Thanks,

Dave Murphy

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060606/e2fe6c2e/attachment.html
From tchaddad at gmail.com  Tue Jun  6 14:18:26 2006
From: tchaddad at gmail.com (TC Haddad)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] ERMapper .ers ?
In-Reply-To: <25de2c7c0606061055r33e004dcvb40eef1c51ca27f1@mail.gmail.com>
References: <25de2c7c0606061055r33e004dcvb40eef1c51ca27f1@mail.gmail.com>
Message-ID: <25de2c7c0606061118h12104761lf09e5cfb73ccc969@mail.gmail.com>

I'm curious about being able to convert a large bunch of files to ER
Mapper .ers format. From what I've been told, .ers is basically a .bil
format raster with a custom header. Not sure how accurate this
description is, but I'm curious if gdal can create it...

we're looking at a project where we will have to convert a few large
series of rasters into .ers format. The source files would include
TIFFs, TIFFs w/ world files, ArcInfo grids, and/or DEMs. I was hoping
gdal might be a potential aid in this big task.

can someone enlighten me as to gdal's capabilities regarding .ers ?

thanks

Tanya

----- Original Message -----
From: "Frank Warmerdam" <warmerdam at pobox.com>
To: <gdal-dev at remotesensing.org>
Sent: Thursday, April 29, 2004 12:46 PM
Subject: Re: [Gdal-dev] ERMapper .ers ?


> Ben Discoe wrote:
> > I've been asked about the ERMapper .ers format... could GDAL read/write
it?
> > It seems to be an open format, in that ERMapper generally encourages
people
> > to use their format.  It is a raster format, i think?
>
> Ben,
>
>  From a few samples I have seen I gather the .ers file is basically an
ascii
> header describing an external raster file which can be in any number of
formats.
> I presume there is some raw raster format for files generated within
ERMapper.
> I think that in some cases the .ers file is also an algorithm description
of
> how to generate a raster from other files.
>
> However, I'm not really very sure of any of this.
>
> If folks want to scare up some examples datasets (not too huge I hope) I
> could look at implementing some degree of support.
>
> Best regards,
> --
> ---------------------------------------+----------------------------------
----
> I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
>


http://lists.maptools.org/pipermail/gdal-dev/2004-April/002593.html

From warmerdam at pobox.com  Tue Jun  6 14:23:40 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:11 2007
Subject: DIY: Reprojection...Re: [Gdal-dev] raster image	preprocessing
	problem.
In-Reply-To: <s4856a05.012@co5.dnr.state.mn.us>
References: <s4856a05.012@co5.dnr.state.mn.us>
Message-ID: <4485C82C.4090109@pobox.com>

Charles Wivell wrote:
> Hi Robert;
> 
> I really couldn't tell you what GDALWarp can do, or is for. I'm a control freak.... I write the stuff myself. I only use GDAL to read and write data from/to the really icky file formats.
> 
> But warp to me says it uses a polynomial to warp from one projection to another (but maybe I'm wrong), where as the correct (more accurate way) is to use a projection library, like I outlined.
> 
> I think if it is doing a warp it might have problems (what is the degree of the polynomial used in the warp...?) and like was pointed out by another replier, since the Mercator projection is not defined at the poles, a polynomial might go off into lala land (technical term) quicker than using the projection library....?
> 
> But I'm guessing about GDALWarp....

Charles / Robert,

Gdalwarp normally uses exact reprojection of the center point of each pixel
when doing reprojection using PROJ.4.  It also has an option for a
per-scanline linear approximation within some error threshold though I don't
believe that is used by default.  (see -et switch).

Gdalwarp also supports polynomial warping when given GCPs are input.

I certainly respect Charles' desire to "do it himself" though this level
of effort is clearly not practical for everyone.  I do aim for gdalwarp to
be generally useful for end users though there are a few things it doesn't
do.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From warmerdam at pobox.com  Tue Jun  6 14:52:05 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] ERMapper .ers ?
In-Reply-To: <25de2c7c0606061118h12104761lf09e5cfb73ccc969@mail.gmail.com>
References: <25de2c7c0606061055r33e004dcvb40eef1c51ca27f1@mail.gmail.com>
	<25de2c7c0606061118h12104761lf09e5cfb73ccc969@mail.gmail.com>
Message-ID: <4485CED5.7000106@pobox.com>

TC Haddad wrote:
> I'm curious about being able to convert a large bunch of files to ER
> Mapper .ers format. From what I've been told, .ers is basically a .bil
> format raster with a custom header. Not sure how accurate this
> description is, but I'm curious if gdal can create it...
> 
> we're looking at a project where we will have to convert a few large
> series of rasters into .ers format. The source files would include
> TIFFs, TIFFs w/ world files, ArcInfo grids, and/or DEMs. I was hoping
> gdal might be a potential aid in this big task.
> 
> can someone enlighten me as to gdal's capabilities regarding .ers ?
> 
> thanks
> 
> Tanya

Tanya,

Currently there is no operational .ers driver for GDAL.  I started one
once but didn't get far.  I think it would be pretty easy to write a script
that exports to EHDR (BIL) format and then constructed a .ers file referencing
the raster file.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From warmerdam at pobox.com  Tue Jun  6 15:02:47 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:11 2007
Subject: [Gdal-dev] What python libs are required for gdal compile?
In-Reply-To: <0E5A77B55A57D511BB3F0002A537C262064111AC@s5-dar-r1.nrn.nrcan.gc.ca>
References: <0E5A77B55A57D511BB3F0002A537C262064111AC@s5-dar-r1.nrn.nrcan.gc.ca>
Message-ID: <4485D157.3030909@pobox.com>

Patton, Eric wrote:
> Having received repeated libtool errors during compliation, I complied with
> libtool support suppressed:
>
> gdal_wrap.c:12035: warning: data definition has no type or storage class
> gdal_wrap.c: In function 'init_gdal':
> gdal_wrap.c:12040: error: 'PyObject' undeclared (first use in this function)

Eric,

The above is quite disturbing.  I find it hard to imagine successfully
including Python.h but not having the PyObject definition at this late
point in the file.

> gdal_wrap.c:12040: error: 'm' undeclared (first use in this function)
> gdal_wrap.c:12040: error: 'd' undeclared (first use in this function)
> gdal_wrap.c:12040: warning: left-hand operand of comma expression has no
> effect
> gdal_wrap.c:12040: warning: statement with no effect
> gdal_wrap.c:12042: warning: implicit declaration of function 'Py_InitModule'
> gdal_wrap.c:12043: warning: implicit declaration of function
> 'PyModule_GetDict'
> make[1]: *** [gdal_wrap.o] Error 1
> make[1]: Leaving directory `/opt/gdal-1.3.2/pymod'
> make: *** [py-module] Error 2
> 
> Does anyone know what these errors mean? Are these errors indicate problems
> with my python libraries?

Is this all the errors you get?  Is it possible you get some earlier
errors that might give more clues?

Note, it is critical to have the python development package (which contains
Python.h) installed.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From Charles.Wivell at dnr.state.mn.us  Tue Jun  6 15:38:20 2006
From: Charles.Wivell at dnr.state.mn.us (Charles Wivell)
Date: Wed Nov 21 11:50:11 2007
Subject: DIY: Reprojection...Re: [Gdal-dev] raster
	imagepreprocessing problem.
Message-ID: <s4859367.099@co5.dnr.state.mn.us>

Ivan;

Yup.... A long time ago and in a galaxy far far away (6 years and at University of North Dakota) I wrote a routine to take Level 1B MODIS 250m GSD (at Nadir) data and project it (if I remember right it was into the LCC projection). Yes, I set up the polynomial (full linear) for each of the blocks of 4 geo-located corner pixels. It was fun and interesting since in the output space driven method as I showed, you don't know which input space block you'll end up in, so I had to test to find which block I was in. Also in addition to framing the whole image, I framed each scan and worked scan by scan. Another fun thing about MODIS, is that at end of scan you have complete overlap between scans (meaning a point on the earth is seen by three scans), so which of the three scans do you use, or do you average..... And at the center there is a scan gap......

Hummmm... Maybe I should have framed each block too.... Might have saved the test.... or you could combine blocks and use higher order polynomials....

The Level 1B MODIS product is still raw geometrically and since they don't give you attitude and position information, you have to use the given geo-located pixels. I would rather have created a platform/sensor/earth model to do the projecting.

I'm calling them geo-located pixels since they are not really tied to the ground (not GCPs). They are created by forward projecting the Line of Sight vector to the ground using a platform/sensor/earth model. They are only as good as the attitude and position information allows.

Higher level MODIS products are already projected, so you can use the steps I listed.

Chuck Wivell

MN DNR Grand Rapids MN



>>> "Ivan Lucena" <ILucena@clarku.edu> 6/6/2006 1:33 PM >>>
Hi Charles,

That was great! 

I didn't miss that class, but forget half of the steps anyway.

Would you be so kind to show as a canonical-text-book-method to
reproject based on a regular or irregular swath of control points?

Talking about a regular grid of control points, some NASA-EOS
HDF-4-Swath image comes with more GCP than you might want. It could be
something like one GPCS over each other 4 pixels! Should we just do the
step 1 through 13 for every each 4x4 window in a 44000x48000 image?

Thanks for your contribution.

Lucena, Ivan


-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org 
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Charles Wivell
Sent: Tuesday, June 06, 2006 12:42 PM
To: robert.w.rose@gmail.com 
Cc: gdal-dev@lists.maptools.org 
Subject: Re: DIY: Reprojection...Re: [Gdal-dev] raster
imagepreprocessing problem.

Hi Robert;

I really couldn't tell you what GDALWarp can do, or is for. I'm a
control freak.... I write the stuff myself. I only use GDAL to read and
write data from/to the really icky file formats.

But warp to me says it uses a polynomial to warp from one projection to
another (but maybe I'm wrong), where as the correct (more accurate way)
is to use a projection library, like I outlined.

I think if it is doing a warp it might have problems (what is the degree
of the polynomial used in the warp...?) and like was pointed out by
another replier, since the Mercator projection is not defined at the
poles, a polynomial might go off into lala land (technical term) quicker
than using the projection library....?

But I'm guessing about GDALWarp....


Chuck Wivell

MN DNR Grand Rapids MN




>>> Robert Rose <robert.w.rose@gmail.com> 6/6/2006 11:00 AM >>>

On Jun 6, 2006, at 6:42 AM, Charles Wivell wrote:

> Hi all;
>
> There's been a lot of mail about reprojecting from one map  
> projection to another. Writing a ditty (scientific term for quick  
> program) to reproject an image from one map projection to another  
> is pretty straight forward, once you have a projection library.
>
> The projection library I use is called GCTP (General Cartographic  
> Transformation package) it is free from the USGS.
>
> ftp://edcftp.cr.usgs.gov/pub/software/gctpc/ 
>
> I'll pseudo code the process below (the steps are the same no  
> matter what language you use).
>
> 1) Read in the image into a memory buffer (input space)
> 2) Get the current map projection information (Projection, datum,  
> Upper left corner projection parameters, size of pixel in X and Y)
> 3) Frame your output space
>     - Calculate the output space upper left and lower right values
>       - Lat, Lon, projection x/y, output space pixel size
> 4) Create a memory buffer for the output space
> 5) For each pixel in the output space
> 6) Find the projection x/y using the pixel size and offset of the  
> pixel from the upper left corner
> 7) Convert output space projection x/y to lat, lon using GCTP  
> (inverse projection)
> 8) Convert lat, lon to input space projection x/y using forward  
> projection routine in GCTP
> 9) Convert projection x/y into line, sample (row, column)
> 10) Resample DN values in input space near the calculated input  
> space line, sample
> 11) Place resampled DN value into the output space at current pixel  
> location (line, sample)
> 12) Get next output pixel location (back to step 5)
> 13) Write the output space buffer to a file
>
>
> I'm use to using the terms line, sample since my background is from  
> satellite imagery (thats was usually how they collected data a line  
> scanner). It is just the same as row, column or y,x (line is in the  
> y direction and sample is in the x direction)
>
> These are also the basic steps to warp an image from one space to  
> another, just that steps 7 and 8 are replaced with a mathematical  
> relationship, usually a polynomial of some kind. Or if I'm taking  
> raw satellite imagery or photography and projecting it into a map  
> projection then  steps 7 and 8 are replaced with a platform/sensor/ 
> earth mathematical model.
>
> In step 10 you can use Nearest Neighbor (just round to the nearest  
> pixel location) or for a little better looking final image use  
> bilinear resampling.
>
> Oops... I just gave away all my secrets of being a Geospatial  
> programmer.... ;-)


Hi Chuck,  I sent out that email last week about re-projecting a  
Plate Carree image of the Earth into Mercator... (I still haven't  
gotten a sufficient answer btw)..

Sure, I could use the process you describe above to re-project the  
image myself programmatically, but isn't the process you describe  
above exactly what gdalwarp is for?  Or do I have gdalwarp completely  
mistaken?  If so, that would explain why I haven't gotten it to do  
what I want! :-)

Actually I have had success using gdalwarp to convert UTM  
orthoimagery to Mercator, but that's obviously a much smaller area  
than the Earth.  Does gdalwarp have any limitations when you give it  
an image that's suppose to cover the entire Earth?  Maybe that's why  
I can't get this to work.

-robert


_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org 
http://lists.maptools.org/mailman/listinfo/gdal-dev 

_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org 
http://lists.maptools.org/mailman/listinfo/gdal-dev


From bfraser at geoanalytic.com  Tue Jun  6 15:49:32 2006
From: bfraser at geoanalytic.com (Brent Fraser)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] ERMapper .ers ?
References: <25de2c7c0606061055r33e004dcvb40eef1c51ca27f1@mail.gmail.com>
	<25de2c7c0606061118h12104761lf09e5cfb73ccc969@mail.gmail.com>
Message-ID: <2d0501c689a2$54ac19b0$160002c0@shark>

Tanya,

  Yes, the .ers header file can reference a BIL file (that's the default).
And no, GDAL does not directly support the reading or writing of .ers files.

An .ers file can be simple or quite complicated, depending on your data
organization.  Here's an example of a simple one:

DatasetHeader Begin
        Version         = "5.5"
        LastUpdated     = Tue May 23 16:01:15 GMT 2006
        DataSetType     = ERStorage
        DataType        = Raster
        ByteOrder       = LSBFirst
        CoordinateSpace Begin
                Datum           = "WGS84"
                Projection      = "NUTM39"
                CoordinateType  = EN
                Rotation        = 0:0:0.0
        CoordinateSpace End
        RasterInfo Begin
                CellType        = Unsigned8BitInteger
                CellInfo Begin
                        Xdimension      = 49.9887396648
                        Ydimension      = 49.9887396648
                CellInfo End
                NrOfLines       = 449
                NrOfCellsPerLine        = 690
                RegistrationCoord Begin
                        Eastings        = 333482.7994339
                        Northings       = 1788902.13974
                RegistrationCoord End
                NrOfBands       = 3
                BandId Begin
                        Value           = "Red"
                BandId End
                BandId Begin
                        Value           = "Green"
                BandId End
                BandId Begin
                        Value           = "Blue"
                BandId End
        RasterInfo End
DatasetHeader End

As Frank points out, you could use gdal_translate to create a BIL/HDR file,
then use some sort of scripting to create a .ers file for each BIL from the
information in the .hdr files.

And there are a few details:

1. Typically in ERMapper's world  the BIL file has the same name as the .ers
file, but no .bil extension
2. The coordinate system descriptors  ("WGS84", "NUTM39" ) are ERMapper's
own, so you'll need to find out which ones to use for your data.
3. If you care about pixel registration, note that the registration
coordinates in a HDR file are the center of the top left pixel, while the
default in an ERS file is the top left corner of the top left pixel (1/2 a
pixel different in x and y).  You can change this default in an ERS file by
adding:
                RegistrationCellX  = 0.5
                RegistrationCellY  = 0.5
after
                RegistrationCoord End

Brent Fraser
GeoAnalytic Inc
Calgary, Alberta, Canada


----- Original Message ----- 
From: "TC Haddad" <tchaddad@gmail.com>
To: <gdal-dev@lists.maptools.org>
Sent: Tuesday, June 06, 2006 12:18 PM
Subject: [Gdal-dev] ERMapper .ers ?


> I'm curious about being able to convert a large bunch of files to ER
> Mapper .ers format. From what I've been told, .ers is basically a .bil
> format raster with a custom header. Not sure how accurate this
> description is, but I'm curious if gdal can create it...
>
> we're looking at a project where we will have to convert a few large
> series of rasters into .ers format. The source files would include
> TIFFs, TIFFs w/ world files, ArcInfo grids, and/or DEMs. I was hoping
> gdal might be a potential aid in this big task.
>
> can someone enlighten me as to gdal's capabilities regarding .ers ?
>
> thanks
>
> Tanya
>
> ----- Original Message -----
> From: "Frank Warmerdam" <warmerdam at pobox.com>
> To: <gdal-dev at remotesensing.org>
> Sent: Thursday, April 29, 2004 12:46 PM
> Subject: Re: [Gdal-dev] ERMapper .ers ?
>
>
> > Ben Discoe wrote:
> > > I've been asked about the ERMapper .ers format... could GDAL
read/write
> it?
> > > It seems to be an open format, in that ERMapper generally encourages
> people
> > > to use their format.  It is a raster format, i think?
> >
> > Ben,
> >
> >  From a few samples I have seen I gather the .ers file is basically an
> ascii
> > header describing an external raster file which can be in any number of
> formats.
> > I presume there is some raw raster format for files generated within
> ERMapper.
> > I think that in some cases the .ers file is also an algorithm
description
> of
> > how to generate a raster from other files.
> >
> > However, I'm not really very sure of any of this.
> >
> > If folks want to scare up some examples datasets (not too huge I hope) I
> > could look at implementing some degree of support.
> >
> > Best regards,
> > --
>
> ---------------------------------------+----------------------------------
> ----
> > I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam at pobox.com
> > light and sound - activate the windows | http://pobox.com/~warmerdam
> > and watch the world go round - Rush    | Geospatial Programmer for Rent
> >
>
>
> http://lists.maptools.org/pipermail/gdal-dev/2004-April/002593.html
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev


From rec at geodesign.com.br  Tue Jun  6 17:09:12 2006
From: rec at geodesign.com.br (Reinaldo Escada Chohfi)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] gdalwarp Transparency Question
In-Reply-To: <4485DEA3.7000505@gov.yk.ca>
References: <6.2.1.2.0.20060605135931.01ce49c8@mailhost.geodesign.com.br>
	<4485DEA3.7000505@gov.yk.ca>
Message-ID: <6.2.1.2.0.20060606174157.01cda998@mailhost.geodesign.com.br>

Skipped content of type multipart/alternative-------------- next part --------------
call gdal_merge -o C:\Tiles\CD-043.tif -ul_lr 569600 10064800 578300 10057600 -v -init 0 -createonly C:\Subsets\input-122-ul.tif C:\Subsets\input-122-ll.tif C:\Subsets\input-122-ur.tif C:\Subsets\input-122-lr.tif C:\Subsets\input-123-ul.tif C:\Subsets\input-123-ll.tif C:\Subsets\input-123-ur.tif C:\Subsets\input-123-lr.tif C:\Subsets\input-131-ul.tif C:\Subsets\input-131-ll.tif C:\Subsets\input-131-ur.tif C:\Subsets\input-131-lr.tif

gdal_translate -a_srs C:\Polyconic_WKT.dat -co "INTERLEAVE=PIXEL" C:\Tiles\CD-043.tif C:\Tiles\CD-043a.tif
del C:\Tiles\CD-043.tif
ren C:\Tiles\CD-043a.tif CD-043.tif

gdalwarp -s_srs C:\Polyconic_WKT.dat -srcnodata 0 C:\Subsets\input-122-ul.tif C:\Tiles\CD-043.tif
gdalwarp -s_srs C:\Polyconic_WKT.dat -srcnodata 0 C:\Subsets\input-122-ll.tif C:\Tiles\CD-043.tif
gdalwarp -s_srs C:\Polyconic_WKT.dat -srcnodata 0 C:\Subsets\input-122-ur.tif C:\Tiles\CD-043.tif
gdalwarp -s_srs C:\Polyconic_WKT.dat -srcnodata 0 C:\Subsets\input-122-lr.tif C:\Tiles\CD-043.tif
gdalwarp -s_srs C:\Polyconic_WKT.dat -srcnodata 0 C:\Subsets\input-123-ul.tif C:\Tiles\CD-043.tif
gdalwarp -s_srs C:\Polyconic_WKT.dat -srcnodata 0 C:\Subsets\input-123-ll.tif C:\Tiles\CD-043.tif
gdalwarp -s_srs C:\Polyconic_WKT.dat -srcnodata 0 C:\Subsets\input-123-ur.tif C:\Tiles\CD-043.tif
gdalwarp -s_srs C:\Polyconic_WKT.dat -srcnodata 0 C:\Subsets\input-123-lr.tif C:\Tiles\CD-043.tif
gdalwarp -s_srs C:\Polyconic_WKT.dat -srcnodata 0 C:\Subsets\input-131-ul.tif C:\Tiles\CD-043.tif
gdalwarp -s_srs C:\Polyconic_WKT.dat -srcnodata 0 C:\Subsets\input-131-ll.tif C:\Tiles\CD-043.tif
gdalwarp -s_srs C:\Polyconic_WKT.dat -srcnodata 0 C:\Subsets\input-131-ur.tif C:\Tiles\CD-043.tif
gdalwarp -s_srs C:\Polyconic_WKT.dat -srcnodata 0 C:\Subsets\input-131-lr.tif C:\Tiles\CD-043.tif


repeat the command lines for other tiles
From warmerdam at pobox.com  Tue Jun  6 19:41:09 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] gdalwarp Transparency Question
In-Reply-To: <6.2.1.2.0.20060606174157.01cda998@mailhost.geodesign.com.br>
References: <6.2.1.2.0.20060605135931.01ce49c8@mailhost.geodesign.com.br>	<4485DEA3.7000505@gov.yk.ca>
	<6.2.1.2.0.20060606174157.01cda998@mailhost.geodesign.com.br>
Message-ID: <44861295.4000800@pobox.com>

Reinaldo Escada Chohfi wrote:
> Matt,
> 
> I've been successfully using the attached command lines in .bat files to 
> crop and mosaic a large number of tiles.  Frank suggested to use 
> gdalwarp because my input images are large (approx. 2 GB each) and 
> gdal_merge loads entire images in memory and I was running into 
> problems. You have to use gdal_merge first to create the image and them 
> use gdalwarp to mosaic.  In my case the src and dst srs are the same.
> 
> I also use gdal_translate because I load the tiles into another program 
> that wants tiffs as INTERLEAVE=PIXEL.

Reinaldo,

I would add that gdalwarp should now support many input files, like
gdal_merge, and that creation options can be used directly with gdalwarp.
So, in theory your case could be expressed as:

gdalwarp -te 569600 10064800 578300 10057600 C:\Subsets\input\*.tif CD-043.tif
          -co INTERLEAVE=PIXEL

The many files in gdalwarp support was new for GDAL 1.3.2 in an effort
to de-emphasize gdal_merge.py.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From zhonghaiw at gmail.com  Wed Jun  7 02:56:39 2006
From: zhonghaiw at gmail.com (Zhonghai Wang)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] What python libs are required for gdal compile?
In-Reply-To: <4485D157.3030909@pobox.com>
References: <0E5A77B55A57D511BB3F0002A537C262064111AC@s5-dar-r1.nrn.nrcan.gc.ca>
	<4485D157.3030909@pobox.com>
Message-ID: <2534c4120606062356m57286bchc47dc597e7f48c58@mail.gmail.com>

Hi there,

you need Python 2.3.4, and don`t forget the additional Numeric package 2.3.4
.

best regards

zhonghai

On 6/6/06, Frank Warmerdam <warmerdam@pobox.com> wrote:
>
> Patton, Eric wrote:
> > Having received repeated libtool errors during compliation, I complied
> with
> > libtool support suppressed:
> >
> > gdal_wrap.c:12035: warning: data definition has no type or storage class
> > gdal_wrap.c: In function 'init_gdal':
> > gdal_wrap.c:12040: error: 'PyObject' undeclared (first use in this
> function)
>
> Eric,
>
> The above is quite disturbing.  I find it hard to imagine successfully
> including Python.h but not having the PyObject definition at this late
> point in the file.
>
> > gdal_wrap.c:12040: error: 'm' undeclared (first use in this function)
> > gdal_wrap.c:12040: error: 'd' undeclared (first use in this function)
> > gdal_wrap.c:12040: warning: left-hand operand of comma expression has no
> > effect
> > gdal_wrap.c:12040: warning: statement with no effect
> > gdal_wrap.c:12042: warning: implicit declaration of function
> 'Py_InitModule'
> > gdal_wrap.c:12043: warning: implicit declaration of function
> > 'PyModule_GetDict'
> > make[1]: *** [gdal_wrap.o] Error 1
> > make[1]: Leaving directory `/opt/gdal-1.3.2/pymod'
> > make: *** [py-module] Error 2
> >
> > Does anyone know what these errors mean? Are these errors indicate
> problems
> > with my python libraries?
>
> Is this all the errors you get?  Is it possible you get some earlier
> errors that might give more clues?
>
> Note, it is critical to have the python development package (which
> contains
> Python.h) installed.
>
> Best regards,
> --
>
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | President OSGF, http://osgeo.org
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060607/4df70bf8/attachment.html
From epatton at nrcan.gc.ca  Wed Jun  7 10:12:35 2006
From: epatton at nrcan.gc.ca (Patton, Eric)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] What python libs are required for gdal compile?
Message-ID: <0E5A77B55A57D511BB3F0002A537C262064111B0@s5-dar-r1.nrn.nrcan.gc.ca>

Thanks to all who replied; Frank, the problem was that I didn't have python
dev package installed. 

~ Eric. 

-----Original Message-----
From: Zhonghai Wang
To: Frank Warmerdam
Cc: Patton, Eric; gdal-dev@lists.maptools.org
Sent: 6/7/2006 2:56 AM
Subject: Re: [Gdal-dev] What python libs are required for gdal compile?

Hi there,
 
you need Python 2.3.4, and don`t forget the additional Numeric package
2.3.4.
 
best regards
 
zhonghai
 
On 6/6/06, Frank Warmerdam <warmerdam@pobox.com
<mailto:warmerdam@pobox.com> > wrote: 

Patton, Eric wrote:
> Having received repeated libtool errors during compliation, I complied
with
> libtool support suppressed:
>
> gdal_wrap.c:12035: warning: data definition has no type or storage
class
> gdal_wrap.c: In function 'init_gdal':
> gdal_wrap.c:12040: error: 'PyObject' undeclared (first use in this
function) 

Eric,

The above is quite disturbing.  I find it hard to imagine successfully
including Python.h but not having the PyObject definition at this late
point in the file.

> gdal_wrap.c:12040: error: 'm' undeclared (first use in this function) 
> gdal_wrap.c:12040: error: 'd' undeclared (first use in this function)
> gdal_wrap.c:12040: warning: left-hand operand of comma expression has
no
> effect
> gdal_wrap.c:12040: warning: statement with no effect 
> gdal_wrap.c:12042: warning: implicit declaration of function
'Py_InitModule'
> gdal_wrap.c:12043: warning: implicit declaration of function
> 'PyModule_GetDict'
> make[1]: *** [gdal_wrap.o] Error 1 
> make[1]: Leaving directory `/opt/gdal-1.3.2/pymod'
> make: *** [py-module] Error 2
>
> Does anyone know what these errors mean? Are these errors indicate
problems
> with my python libraries? 

Is this all the errors you get?  Is it possible you get some earlier
errors that might give more clues?

Note, it is critical to have the python development package (which
contains
Python.h) installed. 

Best regards,
--
---------------------------------------+--------------------------------
------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com <mailto:warmerdam@pobox.com>  
light and sound - activate the windows | http://pobox.com/~warmerdam
<http://pobox.com/~warmerdam> 
and watch the world go round - Rush    | President OSGF,
http://osgeo.org <http://osgeo.org>  

_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org <mailto:Gdal-dev@lists.maptools.org> 
 <http://lists.maptools.org/mailman/listinfo/gdal-dev>
http://lists.maptools.org/mailman/listinfo/gdal-dev




From matt.wilkie at gov.yk.ca  Wed Jun  7 12:04:36 2006
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] gdalwarp Transparency Question
In-Reply-To: <44861295.4000800@pobox.com>
References: <6.2.1.2.0.20060605135931.01ce49c8@mailhost.geodesign.com.br>	<4485DEA3.7000505@gov.yk.ca>
	<6.2.1.2.0.20060606174157.01cda998@mailhost.geodesign.com.br>
	<44861295.4000800@pobox.com>
Message-ID: <4486F914.4010504@gov.yk.ca>

> I would add that gdalwarp should now support many input files, like
> gdal_merge, and that creation options can be used directly with gdalwarp.
> So, in theory your case could be expressed as:
> 
> gdalwarp -te 569600 10064800 578300 10057600 C:\Subsets\input\*.tif 
> CD-043.tif

Good news! thank you Frank.
Does one still need to create an empty image with gdal_merge first?

-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
http://environmentyukon.gov.yk.ca/geomatics/
--------------------------------------------


From C.Wilmes at gmx.de  Wed Jun  7 12:53:28 2006
From: C.Wilmes at gmx.de (Christian Wilmes)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] Compiling Xerces with VS 2005
Message-ID: <20060607165328.88480@gmx.net>

Hi All,

I'm trying to compile the Xerces library with Visual Studio 2005. There seems to be a problem with wchar_t. I get errors like that one:
Error	20	error C2664: 'mbstowcs' : cannot convert parameter 1 from 'XMLCh *' to 'wchar_t *'	c:\ms4wCompiling\Projects\gdal-1.3.2\xerces-c-src2_4_0\src\xercesc\util\Transcoders\Win32\Win32TransService.cpp	177	

I already try to do the following:
In the file xerces-c-src2_4_0\src\xercesc\util\compilers\vcppdefs.hpp in line 178:
old: typedef unsigned short  XMLCh;
new: typedef wchar_t XMLCh;

But seems to be not the right ist causes other errors, for example that one:
Error	9	error C2679: binary '>>' : no operator found which takes a right-hand operand of type 'unsigned short' (or there is no acceptable conversion)	c:\ms4wCompiling\Projects\gdal-1.3.2\xerces-c-src2_4_0\src\xercesc\validators\schema\identity\XercesXPath.cpp	293	


Has anybody an idea what's to do?

Best Regards
Christian
-- 


Der GMX SmartSurfer hilft bis zu 70% Ihrer Onlinekosten zu sparen!
Ideal f?r Modem und ISDN: http://www.gmx.net/de/go/smartsurfer

From warmerdam at pobox.com  Wed Jun  7 14:20:28 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] gdalwarp Transparency Question
In-Reply-To: <4486F914.4010504@gov.yk.ca>
References: <6.2.1.2.0.20060605135931.01ce49c8@mailhost.geodesign.com.br>	<4485DEA3.7000505@gov.yk.ca>	<6.2.1.2.0.20060606174157.01cda998@mailhost.geodesign.com.br>	<44861295.4000800@pobox.com>
	<4486F914.4010504@gov.yk.ca>
Message-ID: <448718EC.4060207@pobox.com>

Matt Wilkie wrote:
>> I would add that gdalwarp should now support many input files, like
>> gdal_merge, and that creation options can be used directly with gdalwarp.
>> So, in theory your case could be expressed as:
>>
>> gdalwarp -te 569600 10064800 578300 10057600 C:\Subsets\input\*.tif 
>> CD-043.tif
> 
> Good news! thank you Frank.
> Does one still need to create an empty image with gdal_merge first?

Matt,

No, gdalwarp now knows how to do the prescan and build a merged mosaic.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From dmorissette at mapgears.com  Wed Jun  7 16:44:18 2006
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] VRT to turn multiple points into a polyline
Message-ID: <44873AA2.40701@mapgears.com>

Let's say I have a flat database table with an X and a Y column, it is 
easy to create a OGR-VRT data source to return the records as points.

Is there a way using the VRT driver to return a set of records with X,Y 
columns as a single LineString instead of multiple points?

The reason why I'm asking is that I have an Oracle database with X, Y, 
and TIMESTAMP columns, and I would like to use a SQL query in a VRT to 
select multiple points over a period of time and return them as a track 
(a LineString) instead of individual points for use in MapServer.

Does anyone know of a way to do that?

Daniel
-- 
Daniel Morissette
http://www.mapgears.com/

From rec at geodesign.com.br  Wed Jun  7 18:01:51 2006
From: rec at geodesign.com.br (Reinaldo Escada Chohfi)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] gdalwarp Transparency Question
In-Reply-To: <44861295.4000800@pobox.com>
References: <6.2.1.2.0.20060605135931.01ce49c8@mailhost.geodesign.com.br>
	<4485DEA3.7000505@gov.yk.ca>
	<6.2.1.2.0.20060606174157.01cda998@mailhost.geodesign.com.br>
	<44861295.4000800@pobox.com>
Message-ID: <6.2.1.2.0.20060607185428.01cdab48@mailhost.geodesign.com.br>

Frank,

I have a question about the usage of

-scrnodata value [value...]:  Set nodata masking values for input bands 
(different values can be supplied for each band). If more than one value is 
supplied all values should be quoted to keep them together as a single 
operating system argument.

It's not clear to me what's written on the second sentence.  How would I 
specify to set masking for the following RGB values 0 0 0, 0 0 17, 0 0 22, 
0 22 0?

Would it be --scrnodata "0 0 0" "0 0 17" "0 0 22" "0 22 0"?

Thanks,

Reinaldo

At 08:41 PM 6/6/2006, Frank Warmerdam wrote:
>Reinaldo Escada Chohfi wrote:
>>Matt,
>>I've been successfully using the attached command lines in .bat files to 
>>crop and mosaic a large number of tiles.  Frank suggested to use gdalwarp 
>>because my input images are large (approx. 2 GB each) and gdal_merge 
>>loads entire images in memory and I was running into problems. You have 
>>to use gdal_merge first to create the image and them use gdalwarp to 
>>mosaic.  In my case the src and dst srs are the same.
>>I also use gdal_translate because I load the tiles into another program 
>>that wants tiffs as INTERLEAVE=PIXEL.
>
>Reinaldo,
>
>I would add that gdalwarp should now support many input files, like
>gdal_merge, and that creation options can be used directly with gdalwarp.
>So, in theory your case could be expressed as:
>
>gdalwarp -te 569600 10064800 578300 10057600 C:\Subsets\input\*.tif CD-043.tif
>          -co INTERLEAVE=PIXEL
>
>The many files in gdalwarp support was new for GDAL 1.3.2 in an effort
>to de-emphasize gdal_merge.py.
>
>Best regards,
>--
>---------------------------------------+--------------------------------------
>I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
>light and sound - activate the windows | http://pobox.com/~warmerdam
>and watch the world go round - Rush    | President OSGF, http://osgeo.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060607/35555c41/attachment.html
From ben at vterrain.org  Wed Jun  7 18:17:47 2006
From: ben at vterrain.org (Ben Discoe)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] Merging DEMs seamlessly
In-Reply-To: <4485AE09.3070408@pobox.com>
Message-ID: <005801c68a80$35561a00$9b02a8c0@DellWork>

Chris,

In my experience, merging USGS DEMs _always_ leaves tiny gaps.  That's why
merging data in the GDAL-based VTP software always includes a "fill gaps"
operation to do simple interpolation to fill those gaps for you.

For more info, http://vterrain.org/Doc/VTBuilder/overview.html

VTBuilder has seen heavy use by many people for many years because
unattended elevation processing, besides being highly un-visual, so often
runs into these sorts of problems.

-Ben

> -----Original Message-----
> From: Frank Warmerdam
> Sent: Tuesday, June 06, 2006 6:32 AM
> 
> Chris Pennock wrote:
> > Merging DEMs is a frequent topic, but the suggestion I often see is 
> > like:
> > gdal_merge.py -o merged.tif dem1.dem dem2.dem
> > 
> > I when this is done, even if the two DEMs being merged have 
> > the *same* corner points, I usually get a few points of empty
> > space between the dems in the merged tif.
> > 
> > Does anyone have any thoughts on why this would happen, or 
> > a possbile fix?
> 
> Chris,
> 
> Can you provide a couple of DEM files which demonstrate this problem?
> And what version of gdal_merge.py you are using?  There were 
> some adjustments made to try and address edge-effects some months ago.


From szekerest at gmail.com  Wed Jun  7 18:22:06 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] VRT to turn multiple points into a polyline
In-Reply-To: <44873AA2.40701@mapgears.com>
Message-ID: <44875191.208ca3f7.1470.4f27@mx.gmail.com>


I would suggest to create a LINESTRING WKT inside the query a read that
layer as with WKT geometry field.

Best Regards,

Tamas 

-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Daniel Morissette
Sent: Wednesday, June 07, 2006 10:44 PM
To: gdal-dev
Subject: [Gdal-dev] VRT to turn multiple points into a polyline

Let's say I have a flat database table with an X and a Y column, it is 
easy to create a OGR-VRT data source to return the records as points.

Is there a way using the VRT driver to return a set of records with X,Y 
columns as a single LineString instead of multiple points?

The reason why I'm asking is that I have an Oracle database with X, Y, 
and TIMESTAMP columns, and I would like to use a SQL query in a VRT to 
select multiple points over a period of time and return them as a track 
(a LineString) instead of individual points for use in MapServer.

Does anyone know of a way to do that?

Daniel
-- 
Daniel Morissette
http://www.mapgears.com/
_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev

-- 
No virus found in this incoming message.
Checked by AVG Free Edition.
Version: 7.1.394 / Virus Database: 268.8.3/358 - Release Date: 2006.06.07.
 

-- 
No virus found in this outgoing message.
Checked by AVG Free Edition.
Version: 7.1.394 / Virus Database: 268.8.3/358 - Release Date: 2006.06.07.
 


From p.willis at telus.net  Wed Jun  7 21:30:05 2006
From: p.willis at telus.net (p.willis@telus.net)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] gdal_rasterize and ployline SHP files
Message-ID: <1149730205.44877d9d1af40@webmail.telus.net>

hello,

Does gdal_rasterize work with polylines from Esri Shape files?
I am having a few problems getting it to actually burn the 
polylines from a shapefile into a geotiff raster.

I get the message:

100-done

,but when I look at the geotiff, it remains exactly as it was.

At first I thought the geography of the raster and SHP file might
be different so I made sure that both were UTM and the same zone.
Still a no go.

my command line was:

gdal_rasterize -b 1 -b 2 -b 3 -burn 255 -burn 255 -burn 255 -l myUTM myUTM.shp
someUTM.tif

I am working in cygwin under WinXP.

Any ideas would be helpful,


Peter Willis


From bryan at geomega.com  Wed Jun  7 19:01:09 2006
From: bryan at geomega.com (Bryan Keith)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] gdal_rasterize and ployline SHP files
In-Reply-To: <1149730205.44877d9d1af40@webmail.telus.net>
References: <1149730205.44877d9d1af40@webmail.telus.net>
Message-ID: <44875AB5.1030406@geomega.com>

Peter,

gdal_rasterize doesn't work with polylines.  There were a few posts 
about this a couple weeks ago:

http://lists.maptools.org/pipermail/gdal-dev/2006-May/008997.html

Bryan

p.willis@telus.net wrote:
> hello,
> 
> Does gdal_rasterize work with polylines from Esri Shape files?
> I am having a few problems getting it to actually burn the 
> polylines from a shapefile into a geotiff raster.
> 
> I get the message:
> 
> 100-done
> 
> ,but when I look at the geotiff, it remains exactly as it was.
> 
> At first I thought the geography of the raster and SHP file might
> be different so I made sure that both were UTM and the same zone.
> Still a no go.
> 
> my command line was:
> 
> gdal_rasterize -b 1 -b 2 -b 3 -burn 255 -burn 255 -burn 255 -l myUTM myUTM.shp
> someUTM.tif
> 
> I am working in cygwin under WinXP.
> 
> Any ideas would be helpful,
> 
> 
> Peter Willis
> 
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
> 
> 

From warmerdam at pobox.com  Wed Jun  7 19:51:07 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] gdal_rasterize and ployline SHP files
In-Reply-To: <1149730205.44877d9d1af40@webmail.telus.net>
References: <1149730205.44877d9d1af40@webmail.telus.net>
Message-ID: <4487666B.9050601@pobox.com>

p.willis@telus.net wrote:
> hello,
> 
> Does gdal_rasterize work with polylines from Esri Shape files?
> I am having a few problems getting it to actually burn the 
> polylines from a shapefile into a geotiff raster.
> 
> I get the message:
> 
> 100-done
> 
> ,but when I look at the geotiff, it remains exactly as it was.
> 
> At first I thought the geography of the raster and SHP file might
> be different so I made sure that both were UTM and the same zone.
> Still a no go.
> 
> my command line was:
> 
> gdal_rasterize -b 1 -b 2 -b 3 -burn 255 -burn 255 -burn 255 -l myUTM myUTM.shp
> someUTM.tif
> 
> I am working in cygwin under WinXP.

Peter,

Currently gdal_rasterize only rasterizes polygons, not lines or points.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From condit at sdsc.edu  Wed Jun  7 20:46:55 2006
From: condit at sdsc.edu (Christopher Condit)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] which opendap library?
Message-ID: <845AADAC1106E44996327D62097E4C6B95E71E@et.ad.sdsc.edu>

Is the following library to be used to build opendap support on linux?

http://www.opendap.org/download/libdap++.html#3.6.2

 

I built this, but then when I add the -with-dods-root, it puts incorrect
flags into the GDALmake.opt file...

It appends /include to my path and /include/

 

Seems like it should be just my include path and /GNU

 

 

Thanks,

Chris

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060607/57b1fb44/attachment.html
From warmerdam at pobox.com  Wed Jun  7 21:48:19 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] which opendap library?
In-Reply-To: <845AADAC1106E44996327D62097E4C6B95E71E@et.ad.sdsc.edu>
References: <845AADAC1106E44996327D62097E4C6B95E71E@et.ad.sdsc.edu>
Message-ID: <448781E3.4050208@pobox.com>

Christopher Condit wrote:
> Is the following library to be used to build opendap support on linux?
> 
> http://www.opendap.org/download/libdap++.html#3.6.2
> 
>  
> 
> I built this, but then when I add the ?with-dods-root, it puts incorrect 
> flags into the GDALmake.opt file?
> 
> It appends /include to my path and /include/

Christopher,

I have built with libdap 3.6.2 successfully.  I think I may have done
some post GDAL 3.6.2 changes to configure to work with it out of the box.
Are you using GDAL CVS or 3.6.2?

Currently the include path (for include files) is:
    -I$DODS_ROOT/include -I$DODS_ROOT/include/libdap -I$DODS_ROOT/include/dap

I think there is extra stuff in there intended to work for older or newer
versions of the library.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From warmerdam at pobox.com  Wed Jun  7 21:57:49 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] gdalwarp Transparency Question
In-Reply-To: <6.2.1.2.0.20060607185428.01cdab48@mailhost.geodesign.com.br>
References: <6.2.1.2.0.20060605135931.01ce49c8@mailhost.geodesign.com.br>
	<4485DEA3.7000505@gov.yk.ca>
	<6.2.1.2.0.20060606174157.01cda998@mailhost.geodesign.com.br>
	<44861295.4000800@pobox.com>
	<6.2.1.2.0.20060607185428.01cdab48@mailhost.geodesign.com.br>
Message-ID: <4487841D.1060303@pobox.com>

Reinaldo Escada Chohfi wrote:
> Frank,
> 
> I have a question about the usage of
> 
> -scrnodata /value [value...]/:  Set nodata masking values for input 
> bands (different values can be supplied for each band). If more than one 
> value is supplied all values should be quoted to keep them together as a 
> single operating system argument.
> 
> It's not clear to me what's written on the second sentence.  How would I 
> specify to set masking for the following RGB values 0 0 0, 0 0 17, 0 0 
> 22, 0 22 0?
> 
> Would it be --scrnodata "0 0 0" "0 0 17" "0 0 22" "0 22 0"?

Reinaldo,

Gdalwarp only supports a single nodata value.  The verbage is trying to
indicate that you would need to quote the argument if you are providing
a tuple.  So '-srcnodata 0' is fine (and indicates 0 in all bands is nodata)
but if you wanted to indicate that red=0, green=0, blue=17 was nodata you
would need '-srcnodata "0 0 17"'.

But gdalwarp just doesn't support having more than one nodata tuple as
you apparently want to do.  Sorry.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From p.willis at telus.net  Wed Jun  7 13:52:58 2006
From: p.willis at telus.net (p.willis@telus.net)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] Problem compiling GDAL with HDFv4
Message-ID: <1149702778.4487127a597f3@webmail.telus.net>

I am compiling gdal-1.3.2 from source.
The autoconf configuration script finds libmfhdf fine.

During compile I get the following error:

<START>

 gcc -Wall -O2 -I/source/GDAL/gdal-1.3.2/port -I/source/GDAL/gdal-1.3.2/gcore -I
/source/GDAL/gdal-1.3.2/alg -I/source/GDAL/gdal-1.3.2/ogr -I/source/GDAL/gdal-1.
3.2/ogr/ogrsf_frmts -I/source/GDAL/gdal-1.3.2/ogr -I. -DOGR_ENABLED -I/source/GD
AL/gdal-1.3.2/port -c EHapi.c  -fPIC -DPIC -o ../../o/.libs/EHapi.o
In file included from /usr/local/include/hdf.h:169,
                 from /usr/local/include/mfhdf.h:24,
                 from EHapi.c:16:
/usr/local/include/hproto.h:1020: error: syntax error before "DFKgetPNSC"
make[3]: *** [../../o/EHapi.o] Error 1
make[3]: Leaving directory `/source/GDAL/gdal-1.3.2/frmts/hdf4/hdf-eos'
make[2]: *** [lib-hdfeos] Error 2
make[2]: Leaving directory `/source/GDAL/gdal-1.3.2/frmts/hdf4'
make[1]: *** [hdf4-install-obj] Error 2
make[1]: Leaving directory `/source/GDAL/gdal-1.3.2/frmts'
make: *** [frmts-target] Error 2

<END>

Is there  a problem with EHapi or do I need something else?

Any info would be appreciated,

Peter Willis


From zhonghaiw at gmail.com  Thu Jun  8 06:32:40 2006
From: zhonghaiw at gmail.com (Zhonghai Wang)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] compose seperate band satellite images.
Message-ID: <2534c4120606080332q14c1ca14o4eaff87b51b15976@mail.gmail.com>

Hi there,

I've got three satellite images B0, B1 and B2 from the Internet, where:

B0 for the BLUE band, Landsat band 1
B1 for the GREEN band, Landsat band 2
B2 for the RED band, Landsat band 3

and I am trying to compose them together in one GeoTIFF image using openEV,
here I've got some strange symptoms:

if I set the stack order as B0 B1 B2 (from top to bottom), I get a image
color; if I set the stack order as B2 B1 B0 (from top to bottom), I get
another image color. This is a little bit weird for me, since each image has
its own band color, and these colors are the real color, i.e RGB, if I
compose these three image together, the composed image should have the
nature color, and this should be unique.

frankly say, I am not very good at remote sensing things, your thoughts will
be very helpful for me.

zhonghai
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060608/31fe673a/attachment.html
From nbest at speakeasy.net  Thu Jun  8 10:39:54 2006
From: nbest at speakeasy.net (Neil Best)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] gdal for ubuntu
In-Reply-To: <4480B383.2080108@loskot.net>
References: <1149258978.9695.216.camel@localhost.localdomain>
	<4480B383.2080108@loskot.net>
Message-ID: <1149777594.9695.315.camel@localhost.localdomain>

Yes, Mateusz, I was referring to the 'debian' directory in GDAL source
tree.  When I tried to build a package for 1.3.1 the dpkg-buildpackage
way I got .debs named with version 1.2.1 or something and had
dependencies that didn't make any sense.  I presume that these
parameters are embedded in the control files somewhere.  The same
procedure under 1.3.2 bombed out in similar fasion as Eric Patton
reported to the list.  Surprisingly I was able to install gdal using
checkinstall. (Yay! Perl bindings!)  This suggests that the debian/
files have fallen out of date.  I will attempt to contact the Debian
package maintainer, Silke Reimer, but other suggestions are certainly
welcome.  I am willing to help move this along, but hearing from someone
with more familiarity with the history of the debian/ files would be
helpful and encouraging.

Neil


On Fri, 2006-06-02 at 17:54 +0000, an Mateusz Loskot wrote:
> Neil Best wrote:
> > Hello, everybody.  I have been trying to build gdal from source for 
> > my ubuntu breezy box and have had some problems building .debs for 
> > both 1.3.1 and 1.3.2.
> 
> Does it mean your problem is with building Debian packages (deb) or
> building GDAL binaries from source?
> 
> > How can I learn more about the status of the debian/ sub-directory
> > and the possibility of getting upgraded packages into the ubuntu
> > repositories?
> 
> Do you mean 'debian' directory in GDAL sources tree?
> 
> > Anyone here involved with UbuntuGIS? 
> > https://wiki.ubuntu.com/UbuntuGIS
> 
> I was involved for a while (2 months ago) as I'm Ubuntu user
> but I had to break for a (longer) while. I'll try to be back in a 2-3
> months.
> 
> Cheers
> -- 
> Mateusz Loskot
> http://mateusz.loskot.net


From warmerdam at pobox.com  Thu Jun  8 10:49:08 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] compose seperate band satellite images.
In-Reply-To: <2534c4120606080332q14c1ca14o4eaff87b51b15976@mail.gmail.com>
References: <2534c4120606080332q14c1ca14o4eaff87b51b15976@mail.gmail.com>
Message-ID: <448838E4.3040307@pobox.com>

Zhonghai Wang wrote:
> Hi there,
>  
> I've got three satellite images B0, B1 and B2 from the Internet, where:
>  
> B0 for the BLUE band, Landsat band 1
> B1 for the GREEN band, Landsat band 2
> B2 for the RED band, Landsat band 3
>  
> and I am trying to compose them together in one GeoTIFF image using 
> openEV, here I've got some strange symptoms:
>  
> if I set the stack order as B0 B1 B2 (from top to bottom), I get a image 
> color; if I set the stack order as B2 B1 B0 (from top to bottom), I get 
> another image color. This is a little bit weird for me, since each image 
> has its own band color, and these colors are the real color, i.e RGB, if 
> I compose these three image together, the composed image should have the 
> nature color, and this should be unique.
>  
> frankly say, I am not very good at remote sensing things, your thoughts 
> will be very helpful for me.

Zhonghai,

OpenEV and GDAL don't know which band ought to be red, green or blue
except based on the order you compose them.  So you should put the
band you want to be red first (B2), then green (B1) then blue (B0).

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From jhrg at mac.com  Thu Jun  8 12:45:39 2006
From: jhrg at mac.com (James Gallagher)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] which opendap library?
In-Reply-To: <845AADAC1106E44996327D62097E4C6B95E71E@et.ad.sdsc.edu>
References: <845AADAC1106E44996327D62097E4C6B95E71E@et.ad.sdsc.edu>
Message-ID: <60A8B93B-46AE-4275-9759-BD1970079658@mac.com>


On Jun 7, 2006, at 6:46 PM, Christopher Condit wrote:

> Is the following library to be used to build opendap support on linux?
>
> http://www.opendap.org/download/libdap++.html#3.6.2
>
>
>
> I built this, but then when I add the ?with-dods-root, it puts  
> incorrect flags into the GDALmake.opt file?
>
> It appends /include to my path and /include/
>
>
>
> Seems like it should be just my include path and /GNU

You may need to check the version of libdap that gdal requires. I  
have been making a fair number of changes to libdap and clients  
generally need to be updated to use the newer versions. I think gdal/ 
ogr works with the 3.5 versions of the library, but to be honest, I'm  
not sure.

James
>
>
>
>
> Thanks,
>
> Chris
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev

--
James Gallagher                jgallagher at opendap.org
OPeNDAP, Inc                   406.723.8663

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060608/0016962a/attachment.html
From ari.jolma at tkk.fi  Thu Jun  8 16:15:12 2006
From: ari.jolma at tkk.fi (Ari Jolma)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] Using the Geo::GDAL namespace for the Perl wrappers
Message-ID: <44888550.5090708@tkk.fi>

This is long overdue, hopefully it is not too late.

The Perl wrappers have had names gdalconst, gdal, ogr, and osr. In the 
Perl world, the namespace is global (literally) and CPAN (Comprehensive 
Perl Archive Network) is the realization. So, these modules should be in 
the Geo::GDAL namespace.

I've just been playing with it and I think I know how to configure 
things so that users can say something like:

use Geo::GDAL qw(:geom_types);
...
my $driver = Geo::GDAL::GetOGRDriver('..');
...
my $geom = Geo::GDAL::Geometry->new($wkbPolygon);
...

I.e. the module Geo::GDAL takes care of importing the workhorse modules, 
which are renamed Geo::GDAL::gdal etc. and exporting, if user wishes, 
variables like $wkbPolygon. There are few problems in putting GDAL and 
OGR into same namespace, for example both have GetDriver, but it feels 
unnecessary to have Geo::GDAL::OGR. Or what do you think?

Besides the obvious problem of breaking working code, do you see any 
other issues in this proposal?

This would let me or somebody design a bootstrap Geo::GDAL module for 
inclusion into CPAN, which either prints out: "go and install GDAL" or 
does it automagically (that would be serious AI :-) for him/her.

Ari

-- 
Prof. Ari Jolma
Kartografia ja Geoinformatiikka / Cartography and Geoinformatics
Teknillinen Korkeakoulu / Helsinki University of Technology
POBox 1200, 02015 TKK, Finland
Email: ari.jolma at tkk.fi URL: http://www.tkk.fi/~jolma


From Doug_Newcomb at fws.gov  Thu Jun  8 16:59:15 2006
From: Doug_Newcomb at fws.gov (Doug_Newcomb@fws.gov)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] Killing nodata images
Message-ID: <OF4F32B085.E9E1F275-ON85257187.0071B100-85257187.007349D8@fws.gov>

Hi folks,
      I've written a python script to chop large .sid files into 10,000 x
10,000 pixel tiff , prior to conversion to .ecw format.  The sid files are
countywide mosaics of aerial photographs.  Since not a lot of the counties
in this state are square,  there can be large nodata sections in the sid
files.  This means that some of the the blocks I chop out may be composed
entirely of nodata areas.  I've been trying to figure out a quick way to
determine if a file is entirely made up of nodata pixels while it's in tiff
format, so I can delete it before wasting the cpu cycles  converting it to
ecw.

       I'm fairly sure I'm missing something obvious due to  my lack of
skill with python and lack of understanding  of how the gdal -python
interface works, so all suggestions welcome.


Doug






Doug Newcomb
USFWS
Raleigh, NC
919-856-4520 ext. 14 doug_newcomb@fws.gov
---------------------------------------------------------------------------------------------------------

The opinions I express are my own and are not representative of the
official policy of the U.S.Fish and Wildlife Service or Dept. of Interior.
I left my signature file in /dev/null


From warmerdam at pobox.com  Thu Jun  8 19:53:04 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] Killing nodata images
In-Reply-To: <OF4F32B085.E9E1F275-ON85257187.0071B100-85257187.007349D8@fws.gov>
References: <OF4F32B085.E9E1F275-ON85257187.0071B100-85257187.007349D8@fws.gov>
Message-ID: <4488B860.6050002@pobox.com>

Doug_Newcomb@fws.gov wrote:
> Hi folks,
>       I've written a python script to chop large .sid files into 10,000 x
> 10,000 pixel tiff , prior to conversion to .ecw format.  The sid files are
> countywide mosaics of aerial photographs.  Since not a lot of the counties
> in this state are square,  there can be large nodata sections in the sid
> files.  This means that some of the the blocks I chop out may be composed
> entirely of nodata areas.  I've been trying to figure out a quick way to
> determine if a file is entirely made up of nodata pixels while it's in tiff
> format, so I can delete it before wasting the cpu cycles  converting it to
> ecw.
> 
>        I'm fairly sure I'm missing something obvious due to  my lack of
> skill with python and lack of understanding  of how the gdal -python
> interface works, so all suggestions welcome.

Doug,

If you call GetMaximum() on a gdal.Band and it returns a very small value
then it is likely that the entire image is black or near black (assuming black
is your nodata value).  You could check if band.GetMinimum() ==
band.GetMaximum() == nodata value, but if you are coming from sid there may
be some noise that would make it inexact.  In that case checking for
min/max being close to the nodata value.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From debian at adkgis.org  Thu Jun  8 22:39:35 2006
From: debian at adkgis.org (Steve Halasz)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] gdal for ubuntu
In-Reply-To: <1149777594.9695.315.camel@localhost.localdomain>
References: <1149258978.9695.216.camel@localhost.localdomain>
	<4480B383.2080108@loskot.net>	<1149777594.9695.315.camel@localhost.localdomain>
Message-ID: <1149820776.13219.7.camel@marcy>

I offered some time ago to keep the debian/ control files reasonably
up-to-date with respect to the official debian packages. Life has been
busy, but I'll try to find time for this soon.

Steve

On Thu, 2006-06-08 at 09:39 -0500, Neil Best wrote:
> Yes, Mateusz, I was referring to the 'debian' directory in GDAL source
> tree.  When I tried to build a package for 1.3.1 the dpkg-buildpackage
> way I got .debs named with version 1.2.1 or something and had
> dependencies that didn't make any sense.  I presume that these
> parameters are embedded in the control files somewhere.  The same
> procedure under 1.3.2 bombed out in similar fasion as Eric Patton
> reported to the list.  Surprisingly I was able to install gdal using
> checkinstall. (Yay! Perl bindings!)  This suggests that the debian/
> files have fallen out of date.  I will attempt to contact the Debian
> package maintainer, Silke Reimer, but other suggestions are certainly
> welcome.  I am willing to help move this along, but hearing from someone
> with more familiarity with the history of the debian/ files would be
> helpful and encouraging.
> 
> Neil
> 
> 
> On Fri, 2006-06-02 at 17:54 +0000, an Mateusz Loskot wrote:
> > Neil Best wrote:
> > > Hello, everybody.  I have been trying to build gdal from source for 
> > > my ubuntu breezy box and have had some problems building .debs for 
> > > both 1.3.1 and 1.3.2.
> > 
> > Does it mean your problem is with building Debian packages (deb) or
> > building GDAL binaries from source?
> > 
> > > How can I learn more about the status of the debian/ sub-directory
> > > and the possibility of getting upgraded packages into the ubuntu
> > > repositories?
> > 
> > Do you mean 'debian' directory in GDAL sources tree?
> > 
> > > Anyone here involved with UbuntuGIS? 
> > > https://wiki.ubuntu.com/UbuntuGIS
> > 
> > I was involved for a while (2 months ago) as I'm Ubuntu user
> > but I had to break for a (longer) while. I'll try to be back in a 2-3
> > months.
> > 
> > Cheers
> > -- 
> > Mateusz Loskot
> > http://mateusz.loskot.net
> 
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev


From mateusz at loskot.net  Thu Jun  8 23:43:33 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] gdal for ubuntu
In-Reply-To: <1149777594.9695.315.camel@localhost.localdomain>
References: <1149258978.9695.216.camel@localhost.localdomain>	<4480B383.2080108@loskot.net>
	<1149777594.9695.315.camel@localhost.localdomain>
Message-ID: <4488EE65.4090707@loskot.net>

Neil Best wrote:
> Yes, Mateusz, I was referring to the 'debian' directory in GDAL source
> tree. 
> [...]

Neil,

Sorry, I've not created or dig into debian package yet.
So, I have not much to say :-(

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From zhonghaiw at gmail.com  Fri Jun  9 04:43:34 2006
From: zhonghaiw at gmail.com (Zhonghai Wang)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] compose seperate band satellite images.
In-Reply-To: <448838E4.3040307@pobox.com>
References: <2534c4120606080332q14c1ca14o4eaff87b51b15976@mail.gmail.com>
	<448838E4.3040307@pobox.com>
Message-ID: <2534c4120606090143r2c479240m1457d51ec0d1efa0@mail.gmail.com>

thanks Frank, following your sugesstions I've got the raster image.

zhonghai


On 6/8/06, Frank Warmerdam <warmerdam@pobox.com> wrote:
>
> Zhonghai Wang wrote:
> > Hi there,
> >
> > I've got three satellite images B0, B1 and B2 from the Internet, where:
> >
> > B0 for the BLUE band, Landsat band 1
> > B1 for the GREEN band, Landsat band 2
> > B2 for the RED band, Landsat band 3
> >
> > and I am trying to compose them together in one GeoTIFF image using
> > openEV, here I've got some strange symptoms:
> >
> > if I set the stack order as B0 B1 B2 (from top to bottom), I get a image
> > color; if I set the stack order as B2 B1 B0 (from top to bottom), I get
> > another image color. This is a little bit weird for me, since each image
> > has its own band color, and these colors are the real color, i.e RGB, if
> > I compose these three image together, the composed image should have the
> > nature color, and this should be unique.
> >
> > frankly say, I am not very good at remote sensing things, your thoughts
> > will be very helpful for me.
>
> Zhonghai,
>
> OpenEV and GDAL don't know which band ought to be red, green or blue
> except based on the order you compose them.  So you should put the
> band you want to be red first (B2), then green (B1) then blue (B0).
>
> Best regards,
> --
>
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | President OSGF, http://osgeo.org
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060609/fb92195d/attachment.html
From madprof at gmx.ch  Fri Jun  9 05:00:21 2006
From: madprof at gmx.ch (Daniel Goetz)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] ogrinfo and oracle spatial
Message-ID: <20060609090021.185720@gmx.net>

Hi,

I am new here. And I have a problem. I want to show geodata lying in an oracle spatial database via mapserver and I want to do this by using the OGR interface. My previous attempts to do so failed the mapserver telling me: "msOracleSpatialLayerOpen(): OracleSpatial error. OracleSpatial is not supported "

So I wanted to test whether oraclespatial is supportes by OGR and I want to do so using ogrinfo. I have installed the latest ms4w on my computer and the oracle client 9i release 2 version (one on drive c:\  and the other on drive d:\). the actual data lie on a server in the intranet. 

I downloaded FWTools and launched the setfw.bat. for testing purpose I launched the command "ogrinfo c:\ms4w\apache\htdocs\test" where I have some Shapefiles lying. ogrinfo told me that there are two shapefiles what is the truth.

but now I don't know the command to test my database. I tried the following command: "ogrinfo oci:ggs_brwk2004_umn/umn@gds1prod". But ogrinfo told me that it was unable to open the datasource. 

Can anybody help me, please? Might it be that I have installed the oracle client on the "wrong" drive?

Thaank you so much for your help.


regards 

Daniel Goetz
-- 


"Feel free" ? 10 GB Mailbox, 100 FreeSMS/Monat ...
Jetzt GMX TopMail testen: http://www.gmx.net/de/go/topmail

From mateusz at loskot.net  Fri Jun  9 05:16:49 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] ogrinfo and oracle spatial
In-Reply-To: <20060609090021.185720@gmx.net>
References: <20060609090021.185720@gmx.net>
Message-ID: <44893C81.2060500@loskot.net>

Daniel Goetz wrote:
> I am new here. And I have a problem. I want to show geodata lying in 
> an oracle spatial database via mapserver and I want to do this by 
> using the OGR interface. My previous attempts to do so failed the 
> mapserver telling me: "msOracleSpatialLayerOpen(): OracleSpatial 
> error. OracleSpatial is not supported "


Daniel,

Sorry, I can't help you with MapServer stuff.
Please, ask on the MS lists.


> I downloaded FWTools and launched the setfw.bat. for testing purpose 
> I launched the command "ogrinfo c:\ms4w\apache\htdocs\test" where I 
> have some Shapefiles lying. ogrinfo told me that there are two 
> shapefiles what is the truth.


FYI, note that OGR in FWTools may vary from OGR build in MS4W package in
what drivers are built-in and what are excluded.
To see drivers built into FWTools you installed, run:

ogrinfo --formats

> but now I don't know the command to test my database. I tried the 
> following command: "ogrinfo oci:ggs_brwk2004_umn/umn@gds1prod". But 
> ogrinfo told me that it was unable to open the datasource.
> 
> Can anybody help me, please? Might it be that I have installed the 
> oracle client on the "wrong" drive?

Have you checked this webpage:
http://www.gdal.org/ogr/drv_oci.html

There are all OCI options described in details.
You can also find there usage examples.
Generally, the OCI data source definition should follow this format:

OCI:userid/password@database_instance:table,table

List of tables is optional, but if present, note there should be no
spaces between colon, commas and table names.

So, in your example, try to run:

ogrinfo OCI:ggs_brwk2004_umn/umn@gds1prod

where:
ggs_brwk2004_umn - userid
umn - password
gds1prod - database instance


If this command will fail, please give all ogrinfo output with error
message.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From madprof at gmx.ch  Fri Jun  9 06:26:38 2006
From: madprof at gmx.ch (Daniel Goetz)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] ogrinfo and oracle spatial
Message-ID: <20060609102638.185740@gmx.net>

Thank you Mateusz for your help.

Unfortunatelly the command: "ogrinfo OCI:gds_brwk2004_umn/umn@gds1prod" brought back the following (this tiem I used the ogrinfo integrated in ms4w: 

FAILURE:
Unable to open datasource 'OCI:gds_brwk2004_umn/umn@gds1prod' with the following drivers.

-> ESRI Shapefile
->MapInfo File
->UK .NTF
->SDTS
->TIGER
->S57
->DGN
->VRT
->AVCBin
->REC
->Memory
->CSV
->GML
->ODBC
->PGeo
->PostgreSQL
->MySQL

Subsequent I watched out fo the supported formats by commanding: "ogrinfo --formats"

the result was:

Loaded OGR Format Drivers:
->"ESRI Shapefiel" 
->"MapInfo File"
->"UK .NTF"
->"SDTS"
->"S57"
->"DGN"
->"VRT"
->"AVCBin"
->"REC"
->"Memory"
->"CSV"
->"GML"
->"ODBC"
->"PGeo"
->"PostgreSQL"
->"MySQL"

Can you please tell me whether the needed driver for oracle spatial is supported in my OGR. Can you tell me what I further sould do.

Thank you very much.


regards

Daniel Goetz



-- 


Der GMX SmartSurfer hilft bis zu 70% Ihrer Onlinekosten zu sparen!
Ideal f?r Modem und ISDN: http://www.gmx.net/de/go/smartsurfer

From mateusz at loskot.net  Fri Jun  9 06:51:41 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] ogrinfo and oracle spatial
In-Reply-To: <20060609102638.185740@gmx.net>
References: <20060609102638.185740@gmx.net>
Message-ID: <448952BD.5030506@loskot.net>

Daniel Goetz wrote:
> Thank you Mateusz for your help.
> 
> Unfortunatelly the command: "ogrinfo OCI:gds_brwk2004_umn/umn@gds1prod"
> brought back the following (this tiem I used the ogrinfo
> integrated in ms4w:
> 
> FAILURE:
> Unable to open datasource 'OCI:gds_brwk2004_umn/umn@gds1prod' with the following drivers.
> 
> -> ESRI Shapefile
> ->MapInfo File
> ->UK .NTF
> ->SDTS
> ->TIGER
> ->S57
> ->DGN
> ->VRT
> ->AVCBin
> ->REC
> ->Memory
> ->CSV
> ->GML
> ->ODBC
> ->PGeo
> ->PostgreSQL
> ->MySQL


As you can see, list of supported drivers of your OGR does not include
OCI for Oracle Spatial.
This is the problem.


> Subsequent I watched out fo the supported formats by commanding:
> "ogrinfo --formats"
> 
> the result was:
> 
> Loaded OGR Format Drivers:
> ->"ESRI Shapefiel" 
> ->"MapInfo File"
> ->"UK .NTF"
> ->"SDTS"
> ->"S57"
> ->"DGN"
> ->"VRT"
> ->"AVCBin"
> ->"REC"
> ->"Memory"
> ->"CSV"
> ->"GML"
> ->"ODBC"
> ->"PGeo"
> ->"PostgreSQL"
> ->"MySQL"


Yes, this is the same list as above you got with the error message.


> Can you please tell me whether the needed driver for oracle
> spatial is supported in my OGR. Can you tell me what I further
> sould do.


AFAIK,
you have to build GDAL yourself with OCI driver included in the OGR.
I'm writing 'AFAIK', because I don't know if there is any FWTools or
MS4W or any other package that provides OGR built with OCI support.

I assume you're using Windows, you can turn on OCI support by
editing nmake.opt file.
Find OCI word and you will see appropriate options/paths to enable this
driver (look for "Add ORACLE support" section).

On Unix, you can use --with-oci option for ./configure script.

BTW, I've never used OCI myself, so I'm giving you some suggestions I
base on  my knowledge, but not experience.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From hobu at iastate.edu  Fri Jun  9 09:18:52 2006
From: hobu at iastate.edu (Howard Butler)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] ogrinfo and oracle spatial
In-Reply-To: <448952BD.5030506@loskot.net>
References: <20060609102638.185740@gmx.net> <448952BD.5030506@loskot.net>
Message-ID: <p0623091ec0af2530d566@[192.168.11.4]>

The latest MS4W is built with support for Oracle OGR support.  You 
need to have the 10g client libraries installed on your path 
somewhere, and use the OGR_DRIVER_PATH/GDAL_DRIVER_PATH environment 
variables to activate it.  See the readme file in MS4W for more 
information.

In addition, the latest MS4W comes with Oracle MapServer support as 
well.  See the readme file for more information on that as well. 
Using it involves a some dll swapping, but it isn't too bad.

Howard

At 12:51 PM +0200 6/9/06, Mateusz Loskot wrote:
>Daniel Goetz wrote:
>>  Thank you Mateusz for your help.
>>
>>  Unfortunatelly the command: "ogrinfo OCI:gds_brwk2004_umn/umn@gds1prod"
>>  brought back the following (this tiem I used the ogrinfo
>>  integrated in ms4w:
>>
>>  FAILURE:
>>  Unable to open datasource 'OCI:gds_brwk2004_umn/umn@gds1prod' with 
>>the following drivers.
>>
>>  -> ESRI Shapefile
>>  ->MapInfo File
>>  ->UK .NTF
>>  ->SDTS
>>  ->TIGER
>>  ->S57
>>  ->DGN
>>  ->VRT
>>  ->AVCBin
>>  ->REC
>>  ->Memory
>>  ->CSV
>>  ->GML
>>  ->ODBC
>>  ->PGeo
>>  ->PostgreSQL
>>  ->MySQL
>
>
>As you can see, list of supported drivers of your OGR does not include
>OCI for Oracle Spatial.
>This is the problem.
>
>
>>  Subsequent I watched out fo the supported formats by commanding:
>>  "ogrinfo --formats"
>>
>>  the result was:
>>
>>  Loaded OGR Format Drivers:
>>  ->"ESRI Shapefiel"
>>  ->"MapInfo File"
>>  ->"UK .NTF"
>>  ->"SDTS"
>>  ->"S57"
>>  ->"DGN"
>>  ->"VRT"
>>  ->"AVCBin"
>>  ->"REC"
>>  ->"Memory"
>>  ->"CSV"
>>  ->"GML"
>>  ->"ODBC"
>>  ->"PGeo"
>>  ->"PostgreSQL"
>>  ->"MySQL"
>
>
>Yes, this is the same list as above you got with the error message.
>
>
>>  Can you please tell me whether the needed driver for oracle
>>  spatial is supported in my OGR. Can you tell me what I further
>>  sould do.
>
>
>AFAIK,
>you have to build GDAL yourself with OCI driver included in the OGR.
>I'm writing 'AFAIK', because I don't know if there is any FWTools or
>MS4W or any other package that provides OGR built with OCI support.
>
>I assume you're using Windows, you can turn on OCI support by
>editing nmake.opt file.
>Find OCI word and you will see appropriate options/paths to enable this
>driver (look for "Add ORACLE support" section).
>
>On Unix, you can use --with-oci option for ./configure script.
>
>BTW, I've never used OCI myself, so I'm giving you some suggestions I
>base on  my knowledge, but not experience.
>
>Cheers
>--
>Mateusz Loskot
>http://mateusz.loskot.net
>_______________________________________________
>Gdal-dev mailing list
>Gdal-dev@lists.maptools.org
>http://lists.maptools.org/mailman/listinfo/gdal-dev


From twoslick at gmail.com  Fri Jun  9 11:40:48 2006
From: twoslick at gmail.com (Timothy Rupe)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] Bug reading GMT files
Message-ID: <c8afa9bd0606090840i15c51b65vd509752e3b4f3c97@mail.gmail.com>

I've started using gdal_translate to convert a Generic Mapping Tools (GMT)
grid file to an Erdas Imagine Images (HFA) using the following command:
gdal_translate finaldem.grd -of HFA finaldem.img

Everything appears to work correctly, but the resulting elevation file is
translated towards the lower border.  For example, if the top of the DEM was
at latitude 40, and the bottom at 39, then the resulting file after the
conversion has its top at 39, and bottom at 38.

Gdal appears to incorrectly read the boundary values in GMT files, so the
lower and upper values are swapped:
tmp $ gdalinfo finaldem.grd
Driver: netCDF/network Common Data Format

<snip>

Corner Coordinates:
Upper Left  (-124.4998627,  40.0001373)
Lower Left  (-124.4998627,  40.4998627)
Upper Right (-124.0001373,  40.0001373)
Lower Right (-124.0001373,  40.4998627)
Center      (-124.2500000,  40.2500000)

<snip>

The real values of the boundaries are shown here:
grdinfo finaldem.grd
finaldem.grd: Title: user_z_unit
finaldem.grd: Command: grdcut surface.grd -Gfinaldem.grd -R-124.5/-124.0
/40.0/40.5
finaldem.grd: Remark:
finaldem.grd: Pixel node registration used
finaldem.grd: grdfile format: nf (# 18)
finaldem.grd: x_min: -124.5 x_max: -124 x_inc: 0.000277778 name: user_x_unit
nx: 1800
finaldem.grd: y_min: 40 y_max: 40.5 y_inc: 0.000277778 name: user_y_unit ny:
1800
finaldem.grd: z_min: -1052.48 z_max: 1237 name: user_z_unit
finaldem.grd: scale_factor: 1 add_offset: 0



Thanks,
Tim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060609/eed638aa/attachment.html
From mateusz at loskot.net  Fri Jun  9 13:09:45 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] ogrinfo and oracle spatial
In-Reply-To: <p0623091ec0af2530d566@[192.168.11.4]>
References: <20060609102638.185740@gmx.net> <448952BD.5030506@loskot.net>
	<p0623091ec0af2530d566@[192.168.11.4]>
Message-ID: <4489AB59.8010505@loskot.net>

Howard Butler wrote:
> The latest MS4W is built with support for Oracle OGR support.  You 
> need to have the 10g client libraries installed on your path 
> somewhere, and use the OGR_DRIVER_PATH/GDAL_DRIVER_PATH environment 
> variables to activate it.  See the readme file in MS4W for more 
> information.
> 
> In addition, the latest MS4W comes with Oracle MapServer support as 
> well.  See the readme file for more information on that as well. 
> Using it involves a some dll swapping, but it isn't too bad.


Howard,

Thank you very much for your.
I've never used MS4W so that was confusing.
But I tried help Daniel to check why his ogrinfo does not report OCI
support.


Daniel,

Sorry for misinforming your!
As you can see, you need to dig info MS4W docs (readme file) and
everything should be clear.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From ari.jolma at tkk.fi  Fri Jun  9 13:38:52 2006
From: ari.jolma at tkk.fi (Ari Jolma)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] Using the Geo::GDAL namespace for the Perl wrappers
In-Reply-To: <44888550.5090708@tkk.fi>
References: <44888550.5090708@tkk.fi>
Message-ID: <4489B22C.4070303@tkk.fi>

Here's the first design: http://map.hut.fi/gdal-perl/Geo-GDAL.html

It's mainly about tags for importing constructors, other functions or 
GDAL ad OGR constants into the module users namespace.

Ari Jolma kirjoitti:
> This is long overdue, hopefully it is not too late.
>
> The Perl wrappers have had names gdalconst, gdal, ogr, and osr. In the 
> Perl world, the namespace is global (literally) and CPAN 
> (Comprehensive Perl Archive Network) is the realization. So, these 
> modules should be in the Geo::GDAL namespace.
>
> I've just been playing with it and I think I know how to configure 
> things so that users can say something like:
>
> use Geo::GDAL qw(:geom_types);
> ...
> my $driver = Geo::GDAL::GetOGRDriver('..');
> ...
> my $geom = Geo::GDAL::Geometry->new($wkbPolygon);
> ...
>
> I.e. the module Geo::GDAL takes care of importing the workhorse 
> modules, which are renamed Geo::GDAL::gdal etc. and exporting, if user 
> wishes, variables like $wkbPolygon. There are few problems in putting 
> GDAL and OGR into same namespace, for example both have GetDriver, but 
> it feels unnecessary to have Geo::GDAL::OGR. Or what do you think?
>
> Besides the obvious problem of breaking working code, do you see any 
> other issues in this proposal?
>
> This would let me or somebody design a bootstrap Geo::GDAL module for 
> inclusion into CPAN, which either prints out: "go and install GDAL" or 
> does it automagically (that would be serious AI :-) for him/her.
>
> Ari
>


-- 
Prof. Ari Jolma
Kartografia ja Geoinformatiikka / Cartography and Geoinformatics
Teknillinen Korkeakoulu / Helsinki University of Technology
POBox 1200, 02015 TKK, Finland
Email: ari.jolma at tkk.fi URL: http://www.tkk.fi/~jolma


From atucker at businessobjects.com  Fri Jun  9 15:01:59 2006
From: atucker at businessobjects.com (Amanda Tucker)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] using OGRLayer::SetSpatialFilter to access polygons in
	.shp files
Message-ID: <27736D5DEC954F41A6718B6B3160191B013CC0B8@exch-van04.intl.businessobjects.com>

Hello, 

 

My goal is to input a point (lat/long) and to get all polygons that
contain this point.  I am using SetSpatialFilter() to filter on the
specified point.  I am being returned correct features (polygons), but
often, I am getting extra polygons.  I can see through GUI tools that
some polygons/multipolygons are being returned that do not contain the
point.  The doc for SetSpatialFilter() states 'currently this test may
be inaccurately implemented'.  Are there known cases that this method is
inaccurate?  And is this one of those cases?  Is there another way to
get the results I desire?  I also tried using within()/contain() after
these polygons were returned, but that did not work because I am not
building with GEOS.  Is there any way I can get the correct results
without building with GEOS?  And if not, where do I find the GEOS
binaries/source code to build with OGR?  And will these methods in GEOS
even solve my problem?

 

Thanks, Amanda

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060609/b92309e1/attachment.html
From dmurphy at agi.com  Fri Jun  9 16:03:52 2006
From: dmurphy at agi.com (Murphy, David)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] RPF A.TOC Files
Message-ID: <29474044C503AA40A6D6403925FB04EBB5CEFC@mail02.stk.com>

Hello-

 

Is there any way to read info from an RPF A.TOC file via OGDI (gltp)?  I
need to programmatically determine the number of frame (tile) files in
an RPF dataset.  Also, is there any documentation on the layout of an
RPF A.TOC file?

 

Thanks,

Dave Murphy

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060609/f8bd8a3a/attachment.html
From MChapman at sanz.com  Fri Jun  9 17:46:45 2006
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] RPF A.TOC Files
Message-ID: <ED3A48B9840E594890A2BC172D1194650651161E@mailman.san.com>

Dave,

 

OSSIM can do it, and it can use GDAL as a plug-in data source as well.
http://www.ossim.org <http://www.ossim.org/> 

 

Martin

 

________________________________

From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Murphy, David
Sent: Friday, June 09, 2006 2:04 PM
To: gdal-dev@lists.maptools.org
Subject: [Gdal-dev] RPF A.TOC Files

 

Hello-

 

Is there any way to read info from an RPF A.TOC file via OGDI (gltp)?  I
need to programmatically determine the number of frame (tile) files in
an RPF dataset.  Also, is there any documentation on the layout of an
RPF A.TOC file?

 

Thanks,

Dave Murphy

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060609/fd4ce18b/attachment.html
From Dan.Putler at sauder.ubc.ca  Sun Jun 11 16:44:04 2006
From: Dan.Putler at sauder.ubc.ca (Putler, Dan)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] ogr2ogr issues for vmap0 on Ubuntu Breezy
Message-ID: <8A141D7E-2E54-4762-8471-15A2AB4C27DB@sauder.ubc.ca>

Hi All,

I'm trying to convert some vmap0 files to shapefile format (the  
political boundary polygons to be exact) using ogr2ogr on an Ubuntu  
"Breezy" system. I first used the FWTools 1.0.0b2 build of ogr2ogr to  
do this. When doing the conversion, ogr2ogr doesn't complain, but  
only writes out the field names and formats in the dbf along with the  
prj file. The shp and shx file are created, but the don't appear to  
have any actual information in them. Following this, I rebuilt the  
gdal 1.3.1 library with ogdi support, and tried again, with the same  
outcome (on all four vmap0 databases, so I don't think it is a  
corruption issue). My guess is that I'm running into an Ubuntu  
specific issue, but I'm not sure. Any ideas?

On a related note, if someone has copies of the shapefile versions of  
the political boundaries, allowing me to obtain them from you would  
be greatly appreciated (yes, it is giving a man a fish, not teaching  
him to fish, but it solves my short term problem).

Dan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060611/a604d649/attachment.html
From surgpub at telkomsa.net  Sun Jun 11 18:54:13 2006
From: surgpub at telkomsa.net (Paul Surgeon)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] ogr2ogr issues for vmap0 on Ubuntu Breezy
In-Reply-To: <8A141D7E-2E54-4762-8471-15A2AB4C27DB@sauder.ubc.ca>
References: <8A141D7E-2E54-4762-8471-15A2AB4C27DB@sauder.ubc.ca>
Message-ID: <200606120054.14324.surgpub@telkomsa.net>

On Sunday 11 June 2006 22:44, Putler, Dan wrote:
> Hi All,
>
> I'm trying to convert some vmap0 files to shapefile format (the
> political boundary polygons to be exact) using ogr2ogr on an Ubuntu
> "Breezy" system. I first used the FWTools 1.0.0b2 build of ogr2ogr to
> do this. When doing the conversion, ogr2ogr doesn't complain, but
> only writes out the field names and formats in the dbf along with the
> prj file. The shp and shx file are created, but the don't appear to
> have any actual information in them. Following this, I rebuilt the
> gdal 1.3.1 library with ogdi support, and tried again, with the same
> outcome (on all four vmap0 databases, so I don't think it is a
> corruption issue). My guess is that I'm running into an Ubuntu
> specific issue, but I'm not sure. Any ideas?
>
> On a related note, if someone has copies of the shapefile versions of
> the political boundaries, allowing me to obtain them from you would
> be greatly appreciated (yes, it is giving a man a fish, not teaching
> him to fish, but it solves my short term problem).
>
> Dan

Hi Dan

It sounds like the case sensitive path issue that bit me a while back.
A lot of vmap data was saved with mixed upper and lower case file names and 
file extentions.
How I got around it is I placed the vmap0 data in a path without any upper 
case letters in it (/home/paul/tmp/vmap0) and ran ogrinfo and ogr2ogr from 
there.

If you prepend "strace -eopen" to your ogr commands you'll see where it's 
hunting for files and whether it's finding them or not.

In same cases you may have to rename the vmap directories or files. Making 
everything lower case is the easiest route.

paul@kubuntu:~/tmp/v0eur$ ogrinfo -so -ro 
gltp:/vrf/home/paul/tmp/v0eur/vmaplv0/eurnasia 'polbnda@bnd(*)_area' | grep 
"Feature"
Feature Count: 5847

Regards
Paul

From ari.jolma at tkk.fi  Mon Jun 12 06:12:43 2006
From: ari.jolma at tkk.fi (Ari Jolma)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] Changes to and upgrade of the Perl bindings
Message-ID: <448D3E1B.6080400@tkk.fi>

I believe the latest version of Geo::GDAL Perl interface(1) to GDAL and
OGR could be the Perl interface for the next release (1.3.3) of GDAL.

Now, dear PMC of GDAL, I give the ball to you. Instructions, please :-)

Is the source tree in Subversion already? I still have a working account
on the CVS, I believe. Do I just commit the changes?

Ari

(1)http://map.hut.fi/gdal-perl/Geo-GDAL.html

-- 
Prof. Ari Jolma
Kartografia ja Geoinformatiikka / Cartography and Geoinformatics
Teknillinen Korkeakoulu / Helsinki University of Technology
tel: +358 9 451 3886 address: POBox 1200, 02015 TKK, Finland
Email: ari.jolma at tkk.fi URL: http://www.tkk.fi/~jolma

From madprof at gmx.ch  Mon Jun 12 06:51:16 2006
From: madprof at gmx.ch (Daniel Goetz)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] ogrinfo and oracle spatial
In-Reply-To: <p0623091ec0af2530d566@[192.168.11.4]>
References: <20060609102638.185740@gmx.net> <448952BD.5030506@loskot.net>
	<p0623091ec0af2530d566@[192.168.11.4]>
Message-ID: <20060612105116.279790@gmx.net>

Thank you Howard and Mateusz for your help!!!

Now running ogrinfo it lists for one thing the OCI-support and for another it shows the tables in the oracle database that contain geometric data. That's really great. but I had to modify the command for ogrinfo: I wrote:" ogrinfo "OCI:username/password@host:port/sevice_name" instead of "OCI:username/password@service_name". Anyway, it works.

But now another problem occures concerning the mapserver: I "installed" the Oracle 10g instant client, set the windows environment variable PATH and did the .dll swapping like Howard and the readme file in the ms4w-package told me to do. Everything went fine until I want to test maping oracle spatial data via mapserver. the mapserver gave back the following: "mapserv(): Web application error. No template provided." I checked my .map-file for that but there I found a link to the template-file in the WEB-Object.

WEB
...
TEMPLATE "test_template.html"
...
END

After that I tested other test-projects that contain only shapefiles or rasterdata that had worked before the mentioned .dll swapping on my computer. but always the same error message was given out:
"mapserv(): Web application error. No template provided."

Has anybody an idea why this happens? What am I doing wrong? 
Here is my mapfile:

MAP
NAME "Oracle"
EXTENT 426666.49 466058.21 448321.44 490754.58
SIZE 1400 1800
SHAPEPATH "/ms4w/Apache/htdocs/raster/daten"
IMAGETYPE PNG
IMAGECOLOR 255 255 255
UNITS METERS
STATUS ON
CONFIG "GDAL_DRIVER_PATH" "C:/ms4w/gdalplugins"
WEB
	IMAGEPATH "c:\ms4w\Apache\htdocs\raster\tmp\"
	IMAGEURL "/raster/tmp/"
	TEMPLATE "test_template.html"
END

LAYER
        CONNECTIONTYPE OGR
        CONNECTION "OCI:gds_brwk2004_umn/umn@geo0xs01:1523/gds1prod.geo.stadt.nuernberg.de"
        DATA "RWG_TBS"
        NAME "RWG_TBS"       
        TYPE POLYGON
        STATUS ON

        CLASS
            NAME "Flaeche"
            STYLE
	     OUTLINECOLOR 128 128 128
             COLOR 225 225 185
            END
        END
END
END

Under "CONNECTION" in the LAYER-OBJECT I use the same phrase as in ogrinfo. the one including the host- and the port-data instead of the command shown in the mapserver-reference-guide "Vector Data Access" on http://mapserver.gis.umn.edu/docs/reference/vector_data , because I do not know where mapserver shall get these info (host and port) otherwise (but I also tested the version told in the reference-guide). As mentioned in the mail before, the database itself lies on a server in the intranet. Can anybody explain that to me? Thank you so much.

the linked tempalte is very simple: 

<html>
   <head>
      <title>Erstes Beispiel zum UMN Mapserver</title>
   </head>

   <body>
      Mapserver-Version auslesen:<br><br>[version]<br><br><br>
      Karte einbetten:<br><br>
      <img src="[img]"><br>

   </body>
</html>

and to start the whole process I write the following command-line in my browser:

http://localhost/cgi-bin/mapserv.exe?map=c:/ms4w/Apache/htdocs/raster/test_os_ogr.map&layers=all&

OK. That's it. I really don't know what exactly the problem might be. And I don't know how mapserver shall get access to the geodata in the oracle database without giving the host-address and the port-number. Would be very nice if somebody could help me. Thank you so much. 


> Datum: Fri, 9 Jun 2006 08:18:52 -0500
> Betreff: Re: [Gdal-dev] ogrinfo and oracle spatial
> 
> The latest MS4W is built with support for Oracle OGR support.  You 
> need to have the 10g client libraries installed on your path 
> somewhere, and use the OGR_DRIVER_PATH/GDAL_DRIVER_PATH environment 
> variables to activate it.  See the readme file in MS4W for more 
> information.
> 
> In addition, the latest MS4W comes with Oracle MapServer support as 
> well.  See the readme file for more information on that as well. 
> Using it involves a some dll swapping, but it isn't too bad.
> 
> Howard
> 
> At 12:51 PM +0200 6/9/06, Mateusz Loskot wrote:
> >Daniel Goetz wrote:
> >>  Thank you Mateusz for your help.
> >>
> >>  Unfortunatelly the command: "ogrinfo
> OCI:gds_brwk2004_umn/umn@gds1prod"
> >>  brought back the following (this tiem I used the ogrinfo
> >>  integrated in ms4w:
> >>
> >>  FAILURE:
> >>  Unable to open datasource 'OCI:gds_brwk2004_umn/umn@gds1prod' with 
> >>the following drivers.
> >>
> >>  -> ESRI Shapefile
> >>  ->MapInfo File
> >>  ->UK .NTF
> >>  ->SDTS
> >>  ->TIGER
> >>  ->S57
> >>  ->DGN
> >>  ->VRT
> >>  ->AVCBin
> >>  ->REC
> >>  ->Memory
> >>  ->CSV
> >>  ->GML
> >>  ->ODBC
> >>  ->PGeo
> >>  ->PostgreSQL
> >>  ->MySQL
> >
> >>As you can see, list of supported drivers of your OGR does not include
> >OCI for Oracle Spatial.
> >This is the problem.
> >
> >>>  Subsequent I watched out fo the supported formats by commanding:
> >>  "ogrinfo --formats"
> >>
> >>  the result was:
> >>
> >>  Loaded OGR Format Drivers:
> >>  ->"ESRI Shapefiel"
> >>  ->"MapInfo File"
> >>  ->"UK .NTF"
> >>  ->"SDTS"
> >>  ->"S57"
> >>  ->"DGN"
> >>  ->"VRT"
> >>  ->"AVCBin"
> >>  ->"REC"
> >>  ->"Memory"
> >>  ->"CSV"
> >>  ->"GML"
> >>  ->"ODBC"
> >>  ->"PGeo"
> >>  ->"PostgreSQL"
> >>  ->"MySQL"
> >
> >>Yes, this is the same list as above you got with the error message.
> >
> >>>  Can you please tell me whether the needed driver for oracle
> >>  spatial is supported in my OGR. Can you tell me what I further
> >>  sould do.
> >
> >>AFAIK,
> >you have to build GDAL yourself with OCI driver included in the OGR.
> >I'm writing 'AFAIK', because I don't know if there is any FWTools or
> >MS4W or any other package that provides OGR built with OCI support.
> >
> >I assume you're using Windows, you can turn on OCI support by
> >editing nmake.opt file.
> >Find OCI word and you will see appropriate options/paths to enable this
> >driver (look for "Add ORACLE support" section).
> >
> >On Unix, you can use --with-oci option for ./configure script.
> >
> >BTW, I've never used OCI myself, so I'm giving you some suggestions I
> >base on  my knowledge, but not experience.
> >
> >Cheers
> >--
> >Mateusz Loskot
> >http://mateusz.loskot.net
> >_______________________________________________
> >Gdal-dev mailing list
> >Gdal-dev@lists.maptools.org
> >http://lists.maptools.org/mailman/listinfo/gdal-dev
> 
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev

-- 


"Feel free" ? 10 GB Mailbox, 100 FreeSMS/Monat ...
Jetzt GMX TopMail testen: http://www.gmx.net/de/go/topmail

From ron_despain at hotmail.com  Mon Jun 12 08:50:40 2006
From: ron_despain at hotmail.com (Ron DeSpain)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] Writing NITF JPEG2000 files with gdal_translate
Message-ID: <BAY117-F18A4020BDE3A87E5A48D51878F0@phx.gbl>

I have read that GDAL supports NITF with JPEG 2000 compression files for a 
long time, but there does not seem to be a keyword for writing one with the 
command line application "gdal_translate".  Is there an undocumented 
gdal_translate option which writes an image to NITF2.1 with JPEG2000 
compression?

Thanks
Ron DeSpain
ron_despain@hotmail.com



From mateusz at loskot.net  Mon Jun 12 11:01:48 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] ogrinfo and oracle spatial
In-Reply-To: <20060612105116.279790@gmx.net>
References: <20060609102638.185740@gmx.net>
	<448952BD.5030506@loskot.net>	<p0623091ec0af2530d566@[192.168.11.4]>
	<20060612105116.279790@gmx.net>
Message-ID: <448D81DC.3060200@loskot.net>

Daniel Goetz wrote:
> OK. That's it. I really don't know what exactly the problem might be.
>  And I don't know how mapserver shall get access to the geodata in
> the oracle database without giving the host-address and the
> port-number. Would be very nice if somebody could help me. Thank you
> so much.

Daniel,
I think your questions fit better to MapServer list than GDAL.
Sorry, I can't help you in this problem.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From alexandre.leroux at ec.gc.ca  Mon Jun 12 11:13:03 2006
From: alexandre.leroux at ec.gc.ca (Alexandre Leroux)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] Cookie cutting shapefiles in OGR
Message-ID: <448D847F.7010504@ec.gc.ca>

Hi,

I'm new to the list and started using GDAL/OGR recently :-)

Can someone tell me if I can do the following with OGR: I have two 
shapefiles and need to cookie cut one with the other while keeping the 
attributes of the first shapefile in the newly generated third shapefile.

I saw there is OGRGeometry::Intersection which would allow me to do 
this, but I'd need to verify the intersection of all features from 
shapefile #1 with all features of shapefile #2, which would take days 
and days to compute with OGR (that's what my collegue which knows OGR 
way better told me). Is there a way to cookie cut shapefiles directly at 
the layer level?

This collegue also wonders if speed limitations from the GEOS library 
are affecting other users of OGR.

Thanks for any help!

Alex

http://slashgeo.org
-- 
Alexandre Leroux, M.Sc., Ing.
Environnement Canada / Environment Canada
Centre m?t?orologique canadien / Canadian Meteorological Centre
Division de la r?ponse aux urgences environnementales /
Environmental Emergency Response Division
alexandre.leroux@ec.gc.ca

From Tom.Kralidis at ec.gc.ca  Mon Jun 12 11:21:36 2006
From: Tom.Kralidis at ec.gc.ca (Kralidis,Tom [Burlington])
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] srtm and gdaladdo question
Message-ID: <2576812186CDD411BF1500508B6DCE950E91135F@ecnwri1.ontario.int.ec.gc.ca>


Hi,

I am trying to generate a set of SRTM data via gdaltindex, for use with
MapServer, which has worked with no problems.

The next challenge is ensure they are displayed efficiently in
MapServer, where I have taken the following steps:

- run gdaltindex
- run gdaladdo on each image

When I try to run gdaladdo, I encounter the following issues:

Sample image:
ftp://ftp.glcf.umiacs.umd.edu/glcf/SRTM/Degree_Tiles/n045/SRTM_u01_n045w
086/SRTM_u01_n045w086.tif.gz

$ gdaladdo -r average SRTM_u01_n045w086.tif 2 4 8 16 32

...

ERROR 1: IReadBlock failed at X offset 0, Y offset 11
ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 11
91ERROR 1: SRTM_u01_n045w086.tif:DumpModeDecode: Not enough data for
scanline 0
ERROR 1: TIFFReadEncodedTile() failed.

ERROR 1: IReadBlock failed at X offset 0, Y offset 12
ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 12
.ERROR 1: SRTM_u01_n045w086.tif:DumpModeDecode: Not enough data for
scanline 0
ERROR 1: TIFFReadEncodedTile() failed.

ERROR 1: IReadBlock failed at X offset 0, Y offset 13
ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 13
ERROR 1: SRTM_u01_n045w086.tif:DumpModeDecode: Not enough data for
scanline 0
ERROR 1: TIFFReadEncodedTile() failed.

ERROR 1: IReadBlock failed at X offset 0, Y offset 14
ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 14

...


Any idea what's going on?

Thanks

..Tom


From neteler at itc.it  Mon Jun 12 12:20:21 2006
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] ogr2ogr issues for vmap0 on Ubuntu Breezy
In-Reply-To: <200606120054.14324.surgpub@telkomsa.net>
References: <8A141D7E-2E54-4762-8471-15A2AB4C27DB@sauder.ubc.ca>
	<200606120054.14324.surgpub@telkomsa.net>
Message-ID: <20060612162021.GH20455@bartok.itc.it>

On Mon, Jun 12, 2006 at 12:54:13AM +0200, Paul Surgeon wrote:
> On Sunday 11 June 2006 22:44, Putler, Dan wrote:
> > Hi All,
> >
> > I'm trying to convert some vmap0 files to shapefile format (the
> > political boundary polygons to be exact) using ogr2ogr on an Ubuntu
> > "Breezy" system. I first used the FWTools 1.0.0b2 build of ogr2ogr to
> > do this. When doing the conversion, ogr2ogr doesn't complain, but
> > only writes out the field names and formats in the dbf along with the
> > prj file. The shp and shx file are created, but the don't appear to
> > have any actual information in them. Following this, I rebuilt the
> > gdal 1.3.1 library with ogdi support, and tried again, with the same
> > outcome (on all four vmap0 databases, so I don't think it is a
> > corruption issue). My guess is that I'm running into an Ubuntu
> > specific issue, but I'm not sure. Any ideas?
> >
> > On a related note, if someone has copies of the shapefile versions of
> > the political boundaries, allowing me to obtain them from you would
> > be greatly appreciated (yes, it is giving a man a fish, not teaching
> > him to fish, but it solves my short term problem).
> >
> > Dan
> 
> Hi Dan
> 
> It sounds like the case sensitive path issue that bit me a while back.
> A lot of vmap data was saved with mixed upper and lower case file names and 
> file extentions.

Hi,

these tricks are also explained here:

 "SRTM and VMAP0 data in OGR and GRASS"
  GRASS Newsletter, 3:2-6, June 2005.
  http://grass.itc.it/newsletter/index.php

+ Erratum of GRASS-News vol. 3 (June 2005)
  http://grass.itc.it/newsletter/GRASSNews_vol3_erratum.txt

Markus

> How I got around it is I placed the vmap0 data in a path without any upper 
> case letters in it (/home/paul/tmp/vmap0) and ran ogrinfo and ogr2ogr from 
> there.
> 
> If you prepend "strace -eopen" to your ogr commands you'll see where it's 
> hunting for files and whether it's finding them or not.
> 
> In same cases you may have to rename the vmap directories or files. Making 
> everything lower case is the easiest route.
> 
> paul@kubuntu:~/tmp/v0eur$ ogrinfo -so -ro 
> gltp:/vrf/home/paul/tmp/v0eur/vmaplv0/eurnasia 'polbnda@bnd(*)_area' | grep 
> "Feature"
> Feature Count: 5847
> 
> Regards
> Paul

From Dan.Putler at sauder.ubc.ca  Mon Jun 12 12:26:42 2006
From: Dan.Putler at sauder.ubc.ca (Putler, Dan)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] ogr2ogr issues for vmap0 on Ubuntu Breezy
In-Reply-To: urn:content-classes:message
Message-ID: <F3F5620D-7353-46D8-BAFD-AC3153FAA34A@sauder.ubc.ca>

Many, many thanks Paul. The mixed case in the file paths was exactly  
the problem. It would have taken me a _long_ time to figure that one  
out on my own.

Dan

On 11-Jun-06, at 3:54 PM, Paul Surgeon wrote:

> On Sunday 11 June 2006 22:44, Putler, Dan wrote:
>> Hi All,
>>
>> I'm trying to convert some vmap0 files to shapefile format (the
>> political boundary polygons to be exact) using ogr2ogr on an Ubuntu
>> "Breezy" system. I first used the FWTools 1.0.0b2 build of ogr2ogr to
>> do this. When doing the conversion, ogr2ogr doesn't complain, but
>> only writes out the field names and formats in the dbf along with the
>> prj file. The shp and shx file are created, but the don't appear to
>> have any actual information in them. Following this, I rebuilt the
>> gdal 1.3.1 library with ogdi support, and tried again, with the same
>> outcome (on all four vmap0 databases, so I don't think it is a
>> corruption issue). My guess is that I'm running into an Ubuntu
>> specific issue, but I'm not sure. Any ideas?
>>
>> On a related note, if someone has copies of the shapefile versions of
>> the political boundaries, allowing me to obtain them from you would
>> be greatly appreciated (yes, it is giving a man a fish, not teaching
>> him to fish, but it solves my short term problem).
>>
>> Dan
>
> Hi Dan
>
> It sounds like the case sensitive path issue that bit me a while back.
> A lot of vmap data was saved with mixed upper and lower case file  
> names and
> file extentions.
> How I got around it is I placed the vmap0 data in a path without  
> any upper
> case letters in it (/home/paul/tmp/vmap0) and ran ogrinfo and  
> ogr2ogr from
> there.
>
> If you prepend "strace -eopen" to your ogr commands you'll see  
> where it's
> hunting for files and whether it's finding them or not.
>
> In same cases you may have to rename the vmap directories or files.  
> Making
> everything lower case is the easiest route.
>
> paul@kubuntu:~/tmp/v0eur$ ogrinfo -so -ro
> gltp:/vrf/home/paul/tmp/v0eur/vmaplv0/eurnasia 'polbnda@bnd(*) 
> _area' | grep
> "Feature"
> Feature Count: 5847
>
> Regards
> Paul
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060612/cf1923db/attachment.html
From woklist at kyngchaos.com  Mon Jun 12 12:39:57 2006
From: woklist at kyngchaos.com (William Kyngesburye)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] srtm and gdaladdo question
In-Reply-To: <2576812186CDD411BF1500508B6DCE950E91135F@ecnwri1.ontario.int.ec.gc.ca>
References: <2576812186CDD411BF1500508B6DCE950E91135F@ecnwri1.ontario.int.ec.gc.ca>
Message-ID: <D098E650-2E8E-4643-BD9D-E2ACA3C4B4FE@kyngchaos.com>

I ran into the same problem a while back - what version of libtiff is  
your gdal built with?  I found that when going from tiff 3.7.4 to  
3.8.0 (still there at 3.8.2) I started getting these block errors at  
higher overview levels.  This is with grey-scale images (like SRTM),  
with color images I get bus errors.

I've been meaning to submit a bug report, but I don't know if it's  
libtiff of GDAL (seems to be libtiff, from the thread trace), and I  
never heard anything from my posts on this list.


On Jun 12, 2006, at 10:21 AM, Kralidis,Tom [Burlington] wrote:

>
> Hi,
>
> I am trying to generate a set of SRTM data via gdaltindex, for use  
> with
> MapServer, which has worked with no problems.
>
> The next challenge is ensure they are displayed efficiently in
> MapServer, where I have taken the following steps:
>
> - run gdaltindex
> - run gdaladdo on each image
>
> When I try to run gdaladdo, I encounter the following issues:
>
> Sample image:
> ftp://ftp.glcf.umiacs.umd.edu/glcf/SRTM/Degree_Tiles/n045/ 
> SRTM_u01_n045w
> 086/SRTM_u01_n045w086.tif.gz
>
> $ gdaladdo -r average SRTM_u01_n045w086.tif 2 4 8 16 32
>
> ...
>
> ERROR 1: IReadBlock failed at X offset 0, Y offset 11
> ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 11
> 91ERROR 1: SRTM_u01_n045w086.tif:DumpModeDecode: Not enough data for
> scanline 0
> ERROR 1: TIFFReadEncodedTile() failed.
>
> ERROR 1: IReadBlock failed at X offset 0, Y offset 12
> ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 12
> .ERROR 1: SRTM_u01_n045w086.tif:DumpModeDecode: Not enough data for
> scanline 0
> ERROR 1: TIFFReadEncodedTile() failed.
>
> ERROR 1: IReadBlock failed at X offset 0, Y offset 13
> ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 13
> ERROR 1: SRTM_u01_n045w086.tif:DumpModeDecode: Not enough data for
> scanline 0
> ERROR 1: TIFFReadEncodedTile() failed.
>
> ERROR 1: IReadBlock failed at X offset 0, Y offset 14
> ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 14
>
> ...
>
>
> Any idea what's going on?
>
> Thanks
>
> ..Tom
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev

-----
William Kyngesburye <kyngchaos@kyngchaos.com>
http://www.kyngchaos.com/

First Pogril: Why is life like sticking your head in a bucket filled  
with hyena offal?
Second Pogril: I don't know.  Why IS life like sticking your head in  
a bucket filled with hyena offal?
First Pogril: I don't know either.  Wretched, isn't it?

-HitchHiker's Guide to the Galaxy


From c_pennock at yahoo.com  Mon Jun 12 14:55:28 2006
From: c_pennock at yahoo.com (Chris Pennock)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] gdalwarp interpolation question
Message-ID: <20060612185528.34413.qmail@web51908.mail.yahoo.com>

To all you gdalwarp pros:

I'm experiencing some possibly odd results from
gdal_warp, and wondered if someone here could tell me
what the behavior *should* be.

When I warp a dem into a GTiff using -rcs for cubic
spline resampling, the edges of the resultant GTiff
are "rolled off". For example, on the east side of the
tiff, where I would expect the height data to go
immediately from say 1000ft to 0 (because there was no
dem data further to the east), I instead get, say a
point at 1000, then one at 500, then one at 0. So it
seems to be interpolating the edges of the dem data
dwon to 0. This makes it hard to merge these tiffs,
since little valleys occur betwen them.

On the other hand, using -rn (for nearest neighbor
resampling) causing no such rounding, so I can merge
the dems, but the resulting terrain is too jagged, due
to the -rn resampling.

So, my question is: Is such rolling off expected? Is
there some way to achieve nice resampling (like -rcs)
but to have a clear cut off at the edge of the
resulting tiff, to allow merging.

Many thanks in advance!
Chris

__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
http://mail.yahoo.com 

From warmerdam at pobox.com  Mon Jun 12 16:53:32 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] Writing NITF JPEG2000 files with gdal_translate
In-Reply-To: <BAY117-F18A4020BDE3A87E5A48D51878F0@phx.gbl>
References: <BAY117-F18A4020BDE3A87E5A48D51878F0@phx.gbl>
Message-ID: <931f8ea90606121353v688b7164n50569df50e885405@mail.gmail.com>

On 6/12/06, Ron DeSpain <ron_despain@hotmail.com> wrote:
> I have read that GDAL supports NITF with JPEG 2000 compression files for a
> long time, but there does not seem to be a keyword for writing one with the
> command line application "gdal_translate".  Is there an undocumented
> gdal_translate option which writes an image to NITF2.1 with JPEG2000
> compression?

Ron,

If you have GDAL built with ECW SDK support, I believe you should
be able to use the creation option IC=C8 to force production of
a jpeg2000 compressed file.

eg.
gdal_translate -co IC=C8 utm.tif utm.ntf

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From werchowyna at epf.pl  Mon Jun 12 17:32:22 2006
From: werchowyna at epf.pl (Maciek Sieczka)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] gdal for ubuntu
In-Reply-To: <1149258978.9695.216.camel@localhost.localdomain>
References: <1149258978.9695.216.camel@localhost.localdomain>
Message-ID: <20060612233222.ce624741.werchowyna@epf.pl>

On Fri, 02 Jun 2006 09:36:17 -0500
Neil Best <nbest@speakeasy.net> wrote:

> Hello, everybody.  I have been trying to build gdal from source for my
> ubuntu breezy box and have had some problems building .debs for both
> 1.3.1 and 1.3.2.

If you only want to build debs for seamless install/uninstall/upgrade
on your box, but not for releasing the debs to be used by others, I
recommend checkinstall http://asic-linux.com.mx/~izto/checkinstall.

I've been using 1.6.0 on Ubuntu Breezy for about a year now (and on
Mandriva before that) and it works perfect.

If you are going to build any packages --with-prefix=/usr/local (which
is a good idea) please first, before building your first deb, 'sudo
mkdir /usr/local/man' - otherwise checkinstall will fail to include man
pages.

Maciek

--------------------
W polskim Internecie s? setki milion?w stron. My przekazujemy Tobie tylko najlepsze z nich!
http://katalog.panoramainternetu.pl/


From craig.miller at spatialminds.com  Tue Jun 13 01:19:01 2006
From: craig.miller at spatialminds.com (Craig Miller)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] OGRLayer::GetGeometryColumn & GetFIDColumn
Message-ID: <022301c68ea8$e15a28b0$0401a8c0@vaio>

Hi,

I've been browsing the docs, but they are silent on this particular
question.  Could anyone clarify who owns the char* returned from
OGRLayer::GetGeometryColumn and OGRLayer::GetFIDColumn?  E.g. should I
delete them when I am through with them or does the OGRLayer still own them?

Thanks,
Craig


From mateusz at loskot.net  Tue Jun 13 07:45:45 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] OGRLayer::GetGeometryColumn & GetFIDColumn
In-Reply-To: <022301c68ea8$e15a28b0$0401a8c0@vaio>
References: <022301c68ea8$e15a28b0$0401a8c0@vaio>
Message-ID: <448EA569.8040009@loskot.net>

Craig Miller wrote:
> Hi,
> 
> I've been browsing the docs, but they are silent on this particular 
> question.  Could anyone clarify who owns the char* returned

It's not a type of char* but const char*.

> from OGRLayer::GetGeometryColumn and OGRLayer::GetFIDColumn?  E.g. 
> should I delete them when I am through with them or does the OGRLayer
>  still own them?

Client are not supposed to deallocate memory pointed by const char*
returned from those functions above. They are deallocated in OGRLayer
destructor, more precisely, in destructors of layer classes derived from
OGRLayer in particular driver.

Also, you're reading those values in read-only mode.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From ron_despain at hotmail.com  Tue Jun 13 13:10:23 2006
From: ron_despain at hotmail.com (Ron DeSpain)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] Writing NITF 2.0 and JP2 files with gdal_translate
Message-ID: <BAY117-F266CA0DA7F8BE82B4C33FA878C0@phx.gbl>

1] In trying to produce NITF2.1 JPEG2000 chip files from NITF2.0 and NITF2.1 
files, the following calls produced bad files.

gdal_translate --config GDAL_CACHEMAX 500 -of NITF -srcwin 2909 6648 400 400 
-scale -co "IC=C8" Imagep1_nitf20.ntf Imagep1_nitf20ChipToNJp2.ntf

gdal_translate --config GDAL_CACHEMAX 500 -of NITF -srcwin 11780 21928 400 
400 -scale -co "IC=C8" Image65PanNitf21U.NTF 
Image65PanNitf21UgdalchipToIC8.NTF

2] In trying to procuce NITF 2.0 uncompressed files from NITF2.1 
uncompressed files the following calls just produced NITF 2.1 files.

gdal_translate --config GDAL_CACHEMAX 800 -of NITF -quiet -co "FVER=02.00" 
Image65PanNitf21U.NTF Image65PanNitf21UtoN20.NTF

gdal_translate --config GDAL_CACHEMAX 800 -of NITF -quiet -co 
"FVER=NITF02.00" Image65PanNitf21U.NTF Image65PanNitf21UtoNITF0200.NTF

Does anyone see what I'm missing?

Thanks
Ron DeSpain
ron_despain@hotmail.com



From warmerdam at pobox.com  Tue Jun 13 13:11:09 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] Changes to and upgrade of the Perl bindings
In-Reply-To: <448D3E1B.6080400@tkk.fi>
References: <448D3E1B.6080400@tkk.fi>
Message-ID: <931f8ea90606131011q263dde2co503bb9b0d9e8f1df@mail.gmail.com>

On 6/12/06, Ari Jolma <ari.jolma@tkk.fi> wrote:
> I believe the latest version of Geo::GDAL Perl interface(1) to GDAL and
> OGR could be the Perl interface for the next release (1.3.3) of GDAL.
>
> Now, dear PMC of GDAL, I give the ball to you. Instructions, please :-)
>
> Is the source tree in Subversion already? I still have a working account
> on the CVS, I believe. Do I just commit the changes?

Ari,

The subversion migration hasn't happened yet for technical
reasons.  I'll let committers know when it has.

As far as I'm concerned you are theprimary owner of the perl
bindings, so you can do any changes you see fit that aren't
too disruptive.  If you are proposing a substantial/distruptive
change you might consider writing up a proposal either as an
RFC or just a clear question by email for vote by the PMC.

For the most part I don't understand the implications of what you
are proposing, but I'm likely to accept your advice since you know
the area well.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From ari.jolma at tkk.fi  Tue Jun 13 13:54:29 2006
From: ari.jolma at tkk.fi (Ari Jolma)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] Changes to and upgrade of the Perl bindings
In-Reply-To: <931f8ea90606131011q263dde2co503bb9b0d9e8f1df@mail.gmail.com>
References: <448D3E1B.6080400@tkk.fi>
	<931f8ea90606131011q263dde2co503bb9b0d9e8f1df@mail.gmail.com>
Message-ID: <448EFBD5.2090403@tkk.fi>

Frank Warmerdam kirjoitti:
> too disruptive.  If you are proposing a substantial/distruptive
> change you might consider writing up a proposal either as an
> RFC or just a clear question by email for vote by the PMC.
>
> For the most part I don't understand the implications of what you
> are proposing, but I'm likely to accept your advice since you know
> the area well.

I'm not very sure of the implications myself but my impression from the 
minor feedback is that the Perl bindings are not yet used much for any 
production systems, so there are no big concerns. However, my own CPAN 
modules have to be in sync with these, thus the releases have to be in sync.

I saw somewhere mentioned a release schedule. Is there a chance of 
having a release before end of this month? From my point of view it 
could be a good thing to have things released before iEMSs, which is 
July 7-14. But of course I'll adjust to what's possible.

Ari

>
> Best regards,


-- 
Prof. Ari Jolma
Kartografia ja Geoinformatiikka / Cartography and Geoinformatics
Teknillinen Korkeakoulu / Helsinki University of Technology
POBox 1200, 02015 TKK, Finland
Email: ari.jolma at tkk.fi URL: http://www.tkk.fi/~jolma


From richard.matsunaga at waypointinfo.com  Tue Jun 13 15:35:04 2006
From: richard.matsunaga at waypointinfo.com (Richard Matsunaga)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] memory leak in MapInfo layer
Message-ID: <002a01c68f20$79d95710$0202fea9@Maddog>

I believe I am experiencing a memory leak in MapInfo tab layers using the C
API (called by C# code).
 
I am writing points to a MapInfo tab file. If I don't add the point object
to the OgrFeature, there is no leak. As soon as I add the point (or any
geometry), the memory leak occurs.
 
If I choose a Shapefile datasource, there is no leak.
 
I took a quick look at the mitab source, but saw nothing obvious.
 
Could there be something I am doing wrong that is leading to this problem
with MapInfo files?
 
Another test that I did to confirm was to use 'OGR_F_SetGeometry' instead of
'OGR_F_SetGeometryDirectly' (and destroy the original geometry myself) and
the same leak occurs.
 
Cheers,
Richard
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060613/c90e831e/attachment.html
From craig.miller at spatialminds.com  Tue Jun 13 15:49:28 2006
From: craig.miller at spatialminds.com (Craig Miller)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] OGRLayer::GetGeometryColumn & GetFIDColumn
In-Reply-To: <448EA569.8040009@loskot.net>
Message-ID: <029a01c68f22$7b4be7f0$0401a8c0@vaio>

Thanks for the reply.

And here is an example for all the kids on why you shouldn't be coding when
you should be in bed.  You miss those little details like "const" in the
method signatures <sigh>.  Either that, or its an example of why you should
keep the refrigerator stocked with a variety of caffeinated products.

--Craig
 

-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Mateusz Loskot
Sent: Tuesday, June 13, 2006 4:46 AM
To: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] OGRLayer::GetGeometryColumn & GetFIDColumn

Craig Miller wrote:
> Hi,
> 
> I've been browsing the docs, but they are silent on this particular 
> question.  Could anyone clarify who owns the char* returned

It's not a type of char* but const char*.

> from OGRLayer::GetGeometryColumn and OGRLayer::GetFIDColumn?  E.g. 
> should I delete them when I am through with them or does the OGRLayer  
> still own them?

Client are not supposed to deallocate memory pointed by const char* returned
from those functions above. They are deallocated in OGRLayer destructor,
more precisely, in destructors of layer classes derived from OGRLayer in
particular driver.

Also, you're reading those values in read-only mode.

Cheers
--
Mateusz Loskot
http://mateusz.loskot.net
_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev


From mateusz at loskot.net  Tue Jun 13 15:56:11 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] memory leak in MapInfo layer
In-Reply-To: <002a01c68f20$79d95710$0202fea9@Maddog>
References: <002a01c68f20$79d95710$0202fea9@Maddog>
Message-ID: <448F185B.1070500@loskot.net>

Richard Matsunaga wrote:
> I believe I am experiencing a memory leak in MapInfo tab layers using
>  the C API (called by C# code).


Is this your own C# binding?
Could you provide a piece of code?


> I am writing points to a MapInfo tab file. If I don't add the point 
> object to the OgrFeature, there is no leak. As soon as I add the 
> point (or any geometry), the memory leak occurs.


How are you adding the geometry to feature?
There is a different semanting between SetGeometry and
SetGeometryDirectly regarding ownership of passed geometry.
BTW, how are you detecting memory leaks?

> If I choose a Shapefile datasource, there is no leak.


Hmm, so I'd suspect MapInfo driver is leaking but I'd need to know more
details about how are you using it.


> Could there be something I am doing wrong that is leading to this 
> problem with MapInfo files?


Sure there could be a problem with using OGR incorrectly what can lead
to memory leaks.

> Another test that I did to confirm was to use 'OGR_F_SetGeometry' 
> instead of 'OGR_F_SetGeometryDirectly' (and destroy the original 
> geometry myself) and the same leak occurs.

Good test. So, something other place is leaking.
Please, provide us with more details about:
- C# bindings you are using
- piece of code you are creating/destroying geometries

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From mateusz at loskot.net  Tue Jun 13 16:02:44 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] OGRLayer::GetGeometryColumn & GetFIDColumn
In-Reply-To: <029a01c68f22$7b4be7f0$0401a8c0@vaio>
References: <029a01c68f22$7b4be7f0$0401a8c0@vaio>
Message-ID: <448F19E4.9090300@loskot.net>

Craig Miller wrote:
> Thanks for the reply.
> 
> And here is an example for all the kids on why you shouldn't be coding when
> you should be in bed.  You miss those little details like "const" in the
> method signatures <sigh>.  Either that, or its an example of why you should
> keep the refrigerator stocked with a variety of caffeinated products.

Craig,

I'm not sure I understand your reply.
Certainly, it's possible my english is too limited.
Please, tell me, was my reply helpful or not?
Or may be you're suggesting there is a bug in OGR?

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From mateusz at loskot.net  Tue Jun 13 16:20:49 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] memory leak in MapInfo layer
In-Reply-To: <002a01c68f20$79d95710$0202fea9@Maddog>
References: <002a01c68f20$79d95710$0202fea9@Maddog>
Message-ID: <448F1E21.8030505@loskot.net>

Richard Matsunaga wrote:
> Could there be something I am doing wrong that is leading to this
> problem with MapInfo files?

Richard,

I tested ogr2ogr tool (current CVS) to dump Shapefiles to MapInfo (both
formats) with valgrind (Unix memory debugger) and no memory leaks have
been detected. Here you have what commands I did run and results I got:


mloskot:~/dev/gdal/_cvs/gdal$ valgrind --tool=memcheck --leak-check=yes
ogr/ogr2ogr -f "MapInfo File" ~/tmp/xxx.mif ~/data/test/polys.shp

==2096== Memcheck, a memory error detector.
==2096== Copyright (C) 2002-2005, and GNU GPL'd, by Julian Seward et al.
==2096== Using LibVEX rev 1471, a library for dynamic binary translation.
==2096== Copyright (C) 2004-2005, and GNU GPL'd, by OpenWorks LLP.
==2096== Using valgrind-3.1.0-Debian, a dynamic binary instrumentation
framework.
==2096== Copyright (C) 2000-2005, and GNU GPL'd, by Julian Seward et al.
==2096== For more details, rerun with: -v
==2096==
==2096==
==2096== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 73 from 1)
==2096== malloc/free: in use at exit: 0 bytes in 0 blocks.
==2096== malloc/free: 169,163 allocs, 169,163 frees, 9,335,586 bytes
allocated.
==2096== For counts of detected errors, rerun with: -v
==2096== No malloc'd blocks -- no leaks are possible.

mloskot:~/dev/gdal/_cvs/gdal$ valgrind --tool=memcheck --leak-check=yes
ogr/ogr2ogr -f "MapInfo File" ~/tmp/zzz.tab ~/data/test/polys.shp

==2100== Memcheck, a memory error detector.
==2100== Copyright (C) 2002-2005, and GNU GPL'd, by Julian Seward et al.
==2100== Using LibVEX rev 1471, a library for dynamic binary translation.
==2100== Copyright (C) 2004-2005, and GNU GPL'd, by OpenWorks LLP.
==2100== Using valgrind-3.1.0-Debian, a dynamic binary instrumentation
framework.
==2100== Copyright (C) 2000-2005, and GNU GPL'd, by Julian Seward et al.
==2100== For more details, rerun with: -v
==2100==
==2100==
==2100== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 73 from 1)
==2100== malloc/free: in use at exit: 0 bytes in 0 blocks.
==2100== malloc/free: 187,098 allocs, 187,098 frees, 11,675,855 bytes
allocated.
==2100== For counts of detected errors, rerun with: -v
==2100== No malloc'd blocks -- no leaks are possible.


So, I'd suppose there is something wrong with:
- C# bindings you're using
- or you're using OGR incorrectly

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From craig.miller at spatialminds.com  Tue Jun 13 16:38:55 2006
From: craig.miller at spatialminds.com (Craig Miller)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] OGRLayer::GetGeometryColumn & GetFIDColumn
In-Reply-To: <448F19E4.9090300@loskot.net>
Message-ID: <02a801c68f29$63da7490$0401a8c0@vaio>

Your reply was helpful.  I was making fun of myself for working late,
getting tired, and missing the const keyword as a result.

--Craig
 

-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Mateusz Loskot
Sent: Tuesday, June 13, 2006 1:03 PM
To: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] OGRLayer::GetGeometryColumn & GetFIDColumn

Craig Miller wrote:
> Thanks for the reply.
> 
> And here is an example for all the kids on why you shouldn't be coding 
> when you should be in bed.  You miss those little details like "const" 
> in the method signatures <sigh>.  Either that, or its an example of 
> why you should keep the refrigerator stocked with a variety of caffeinated
products.

Craig,

I'm not sure I understand your reply.
Certainly, it's possible my english is too limited.
Please, tell me, was my reply helpful or not?
Or may be you're suggesting there is a bug in OGR?

Cheers
--
Mateusz Loskot
http://mateusz.loskot.net
_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev


From mateusz at loskot.net  Tue Jun 13 17:01:35 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] OGRLayer::GetGeometryColumn & GetFIDColumn
In-Reply-To: <02a801c68f29$63da7490$0401a8c0@vaio>
References: <02a801c68f29$63da7490$0401a8c0@vaio>
Message-ID: <448F27AF.4010500@loskot.net>

Craig Miller wrote:
> Your reply was helpful.  I was making fun of myself for working late,
> getting tired, and missing the const keyword as a result.


That's what I supposed ;-)
Cool.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From dmorissette at mapgears.com  Tue Jun 13 18:04:08 2006
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] Tool to convert shapefile from [-180, 180] to [0,
	360] range
Message-ID: <448F3658.9000101@mapgears.com>

Is anyone aware of a tool or script that would convert the longitude of 
coordinates in a shapefile from [-180,180] to [0,360]? The tool could be 
based on OGR or any other open source package.

Just checking before writing something from scratch and reinventing the 
wheel.

Daniel
-- 
Daniel Morissette
http://www.mapgears.com/

From richard.matsunaga at waypointinfo.com  Tue Jun 13 19:36:17 2006
From: richard.matsunaga at waypointinfo.com (Richard Matsunaga)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] memory leak in MapInfo layer
In-Reply-To: <448F185B.1070500@loskot.net>
Message-ID: <000001c68f42$2b4b0c70$6500a8c0@Maddog>


Hi Mateusz,

Here is a sample of the code I am using. I have removed non-OGR related
details. For those who may not know, the 'using' statement is used to force
Dispose to be called once out of scope of the using statement. For OGR
objects that have to be cleaned up by the calling code, IDisposable is
implemented to clean up these objects. So in this example, OgrDataSource,
OgrSpatialReference and OgrFeature objects are contained within using
statements to ensure they are disposed of immediately. In addition, I
explicitly destroy the field definition objects that I create.

The C# wrapper is basically the same as the one I sent out some time ago,
although there have been changes - extended functionality, bug fixes and
some unrelated memory issues caused by the wrapper itself. I can send this
out again if that would help. I am fairly confident at this point that the
wrapper is not the cause of the leak, but since I am far from being a
platform invoke expert, there is a, of course, chance that some unexpected
behaviour with the wrapper is the cause.

I am not using any high tech means to detect memory leaks. I run the code
below in a loop and watch the system memory climb and climb. The .NET
garbage collection can be a finicky thing to an outside observer such as
myself, but it will not allow the system to run out of memory unless there
is a leak of some kind, and that can be a problem with managed resources or
unmanaged code. I have run a few .NET memory profilers and they have not
found any problems. There is another commercial product that I have not
tried (yet) that is able to instrument both managed and unmanaged code for
memory profiling.

If I do the same loop test with the Shapefile datasource or by skipping the
'feature.SetGeometryDirectly(point)' step, the memory usage remains static,
as expected.

Wow, this is a long email. Sorry for that :)

Richard

---------------

OgrDriver driver = OgrDriver.GetDriverByName(driverName);

using (OgrDataSource dataSource = driver.CreateDataSource(outputPath,
driverOptions))
{
	Collection<OgrFieldDefinition> fieldDefinitions =
CreateFieldDefinitions();

	using (OgrSpatialReference spatialReference = new
OgrSpatialReference())
	{
		string projectionString = "UTM " + this.utmZone + " (WGS84)
in northern hemisphere.";
	
spatialReference.SetProjectionCoordinateSystem(projectionString);
	
spatialReference.SetWellKnownGeographicCoordinateSystem("WGS84");
		spatialReference.SetUtm(this.utmZone, this.north);

		OgrLayer layer = dataSource.CreateLayer(layerName,
spatialReference,
			OgrWkbGeometryType.wkbPolygon);

		// add fields
		for (int fieldIndex = 0; fieldIndex <
fieldDefinitions.Count; fieldIndex++)
		{
			if (layer.CreateField(fieldDefinitions[fieldIndex],
false) != OgrErr.None)
			{
				throw new OgrException();
			}
		}

		foreach (/*data point to be written to file*/)
		{
			ArrayList fieldValues = GetFieldValues();

			using (OgrFeature feature = new
OgrFeature(layer.LayerFeatureDefinition))
			{
				for (int fieldIndex = 0; fieldIndex <
fieldValues.Count; fieldIndex++)
				{
					feature.SetField(fieldIndex,
fieldValues[fieldIndex]);
				}

				OgrPoint point = new OgrPoint(point.X,
point.Y);

				feature.SetGeometryDirectly(point);

	
feature.SetStyleString(/*MapInfoStyleString*/);
			}

			layer.AddFeature(feature);
		}
	}

	foreach (OgrFieldDefinition fieldDefinition in fieldDefinitions)
	{
		fieldDefinition.Destroy();
	}
} 

-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Mateusz Loskot
Sent: June 13, 2006 3:56 PM
To: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] memory leak in MapInfo layer

Richard Matsunaga wrote:
> I believe I am experiencing a memory leak in MapInfo tab layers using  
> the C API (called by C# code).


Is this your own C# binding?
Could you provide a piece of code?


> I am writing points to a MapInfo tab file. If I don't add the point 
> object to the OgrFeature, there is no leak. As soon as I add the point 
> (or any geometry), the memory leak occurs.


How are you adding the geometry to feature?
There is a different semanting between SetGeometry and SetGeometryDirectly
regarding ownership of passed geometry.
BTW, how are you detecting memory leaks?

> If I choose a Shapefile datasource, there is no leak.


Hmm, so I'd suspect MapInfo driver is leaking but I'd need to know more
details about how are you using it.


> Could there be something I am doing wrong that is leading to this 
> problem with MapInfo files?


Sure there could be a problem with using OGR incorrectly what can lead to
memory leaks.

> Another test that I did to confirm was to use 'OGR_F_SetGeometry' 
> instead of 'OGR_F_SetGeometryDirectly' (and destroy the original 
> geometry myself) and the same leak occurs.

Good test. So, something other place is leaking.
Please, provide us with more details about:
- C# bindings you are using
- piece of code you are creating/destroying geometries

Cheers
--
Mateusz Loskot
http://mateusz.loskot.net
_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev



From condit at sdsc.edu  Tue Jun 13 20:22:11 2006
From: condit at sdsc.edu (Christopher Condit)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] Tool to convert shapefile from [-180, 180] to [0,
	360] range
Message-ID: <845AADAC1106E44996327D62097E4C6B9B82E6@et.ad.sdsc.edu>

Hi Daniel,
This is not particularly elegant, but here's a script I use to go the
other way (0 to 360 -> -180 to 180).  Just switch it and change the
values to match your files...

%gdaltx% -ot Float32 -srcwin 0 0 360 330 -a_ullr 0 89.250 180 -75.25
source.tif right.tif
%gdaltx% -ot Float32 -srcwin 360 0 360 330 -a_ullr -180 89.250 0 -75.25
source.tif left.tif
%gdalmg% -o correct.tif left.tif right.tif
%gdalinfo% -mm correct.tif

Good luck,

Chris

-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Daniel
Morissette
Sent: Tuesday, June 13, 2006 3:04 PM
To: gdal-dev
Subject: [Gdal-dev] Tool to convert shapefile from [-180, 180] to
[0,360] range

Is anyone aware of a tool or script that would convert the longitude of 
coordinates in a shapefile from [-180,180] to [0,360]? The tool could be

based on OGR or any other open source package.

Just checking before writing something from scratch and reinventing the 
wheel.

Daniel
-- 
Daniel Morissette
http://www.mapgears.com/
_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev


From mateusz at loskot.net  Tue Jun 13 21:07:36 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] Tool to convert shapefile from [-180, 180] to [0,
	360] range
In-Reply-To: <448F3658.9000101@mapgears.com>
References: <448F3658.9000101@mapgears.com>
Message-ID: <448F6158.5070407@loskot.net>

Daniel Morissette wrote:
> Is anyone aware of a tool or script that would convert the longitude 
> of coordinates in a shapefile from [-180,180] to [0,360]? The tool 
> could be based on OGR or any other open source package.
> 
> Just checking before writing something from scratch and reinventing 
> the wheel.


Hi Daniel,

I created small utility on basis of ogr2ogr according your needs, just
for fun and practice :-)
I attached it as a 180to360.cpp file, so it's a C++ application.
I hope this attachement will not be cutted off by the gdal-dev mailer.
It works only with shapefiles.

This utility just adds 180 to every x coordinate.
So, it works well only if input coordinates are in range frm -180 to
180, but it does not check it.
You have to compile it as ogr2ogr.cpp, here is small Makefile:

# Change FLAGS if needed
CPP = g++
LDFLAGS = -L/usr/lib -lgdal
CPPFLAGS = -I/usr/include $(CPPFLAGS)

180to360: 180to360.cpp
	$(CPP) $(CPPFLAGS) $< -o $@ $(LDFLAGS)


Run it without any options and you will see the usage message.
In example:

./180to360 ~/tmp/sec.shp ~/tmp/test.shp

and test.shp includes features dumped from sec.shp with X coord conversion.

If there is something not working, just give me a note.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 180to360.cpp
Type: text/x-c++src
Size: 11980 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060614/db2b5e7d/180to360.bin
From ari.jolma at tkk.fi  Wed Jun 14 02:28:47 2006
From: ari.jolma at tkk.fi (Ari Jolma)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] memory leak in MapInfo layer
In-Reply-To: <000001c68f42$2b4b0c70$6500a8c0@Maddog>
References: <000001c68f42$2b4b0c70$6500a8c0@Maddog>
Message-ID: <448FAC9F.9080207@tkk.fi>

Richard Matsunaga kirjoitti:
> 			using (OgrFeature feature = new
> OgrFeature(layer.LayerFeatureDefinition))
> 			{
> 				for (int fieldIndex = 0; fieldIndex <
> fieldValues.Count; fieldIndex++)
> 				{
> 					feature.SetField(fieldIndex,
> fieldValues[fieldIndex]);
> 				}
>
> 				OgrPoint point = new OgrPoint(point.X,
> point.Y);
>
> 				feature.SetGeometryDirectly(point);
>
> 	
> feature.SetStyleString(/*MapInfoStyleString*/);
> 			}
>
> 			layer.AddFeature(feature);
>   

Some comments:

- why are you using the feature outside the using block?
- what is "AddFeature"? OGR has CreateFeature and SetFeature
- why you do not dispose the point object?

Ari


-- 
Prof. Ari Jolma
Kartografia ja Geoinformatiikka / Cartography and Geoinformatics
Teknillinen Korkeakoulu / Helsinki University of Technology
POBox 1200, 02015 TKK, Finland
Email: ari.jolma at tkk.fi URL: http://www.tkk.fi/~jolma


From mark at overmeer.net  Wed Jun 14 05:33:06 2006
From: mark at overmeer.net (Mark Overmeer)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] Changes to and upgrade of the Perl bindings
In-Reply-To: <448D3E1B.6080400@tkk.fi>
References: <448D3E1B.6080400@tkk.fi>
Message-ID: <20060614093306.GQ7890@earth.overmeer.net>

* Ari Jolma (ari.jolma@tkk.fi) [060612 10:12]:
> I believe the latest version of Geo::GDAL Perl interface(1) to GDAL and
> OGR could be the Perl interface for the next release (1.3.3) of GDAL.
> 
> Now, dear PMC of GDAL, I give the ball to you. Instructions, please :-)
> 
> Is the source tree in Subversion already? I still have a working account
> on the CVS, I believe. Do I just commit the changes?
> 
> Ari
> 
> (1)http://map.hut.fi/gdal-perl/Geo-GDAL.html

As author of Geo::Proj4 (and Perl freak in general) I would suggest
a few changes to the interface you plan.  Is this url still the
leading design?

Although a most GDAL (and family) library code uses things which resemble
objects, that does not directly map on an object-oriented implementation
in Perl.  So: if you wish to create an OO interface, you need to start
with seperating your interface thoughts more from what is present in
the libs.  Most importantly: real OO hides internal complexity.

Besides, you can benefit much more from complex Perl features.  I do
not know the specifics of the GDAL libraries (yet), but you could do:

  sub warp(@)
  {   my ($self, %args) = @_;
      my $proj = $args{projection} || 'wgs84';
      ErrorReset;
      my $result = DoWarpNow($proj);
      return $result if defined $result;
      $! = GetLastErrorNo;
      $@ = errtype_to_text(GetLastErrorType).': ',GetLastErrorMsg;
      undef;
  }

  my $image = GDAL::Image->new(....);

  my $result = $image->warp(projection => 'nad83')
     or die $@;
   
Furthermore, it would be nice to follow Perl's naming practice (although
not abligatory) to name packages like Gdal::Driver or GDAL::Driver
(each word starts with a cap), and methods with caps per word
accept the first:   ->finderClean().

Things like this:
    $driver->{LongName}
are a crime against OO.  It should be:
    $driver->longName;
    sub GDAL::Driver::longName() {shift->{LongName}}

GetDescription, SetDescription are in Perl usually merged as
   sub description(;$)
   {   my $self = shift;
       @_ ? ($self->{descr} = shift) : $self->{descr};
   }
So: both setter and getter in one.  On the other hand: I would not
permit people to change the description under fly... only accept
it during (driver)object initiation.  The getter then becomes
   sub description() {shift->{descr}}


RasterXSize $dataset->{RasterXSize}
RasterYSize $dataset->{RasterYSize}
could better become:
   sub rasterDimensions()
   {   ...
       (RasterXSize, RasterYSize);
   }
So people use it like
   my $meta = GDAL::Dataset->new(...);
   my ($w, $h) = $meta->rasterDimensions;

If things like
 SetGeoTransform:
  @transform = ($minX, $dx, 0, $maxY, 0, $dy);
  $dataset->SetGeoTransform(\@transform);
are preparations for actions, you should make it parameters to that
action, not a seperate public method.  For instance, in the above
fake warp() method:

  sub warp(@)
  {   my ($self, %args) = @_;
      ...
      if(my $transform = $args{transform})
      {   SetGeoTransform($self->{c_object}, @$transform);
      }
  }

  my $result = $image->warp
    ( projection => 'utm'
    , transform  => [ $minX, $dx, 0, $maxY, 0, $dy ]
    ) or die $@;

This way, you reduce the amount of knowledge a user needs to have to
use the library correctly.

Except when you have to pass multiple different arguments, avoid
the need for people to use references (most people do not understand
them well enough).  So:
  $dataset->SetGeoTransform(\@transform);
should become
  $dataset->SetGeoTransform(@transform);
or
  $dataset->SetGeoTransform($minX, $dx, 0, $maxY, 0, $dy);

Counters over arrays are a death-sin on Perl, except when you cannot
avoid them.  This:
 GetGCPs:
  my $gcps = $dataset->GetGCPs();
  for (0..$#$gcps) {
    $x[$_] = $gcps->[$_]->{GCPX};
    $y[$_] = $gcps->[$_]->{GCPY};
  }

should become
  my $gcps = $image->GCPs;
  my @x = map {$_->{GCPX}} @$gcps;
  my @y = map {$_->{GCPY}} @$gcps;

but probably nicer is:

  my $gcps   = $image->GCPs;
  my @points = map { [ $_->{GCPX}, {$_->{GCPY} ] } @$gcps;

or better, let GCPs() return a list, then

  my @points = map { [ $_->{GCPX}, {$_->{GCPY} ] }
                  $image->GCPs;
  foreach my $point (@points)
  {   print "X=$point->[0], Y=$point->[1]\n";
  }

or better, hide this knowledge to the user

  foreach my $point ($image->GCPpoints) ...
  
  package GDAL::Image;
  sub GCPpoints()
  {   my $self = shift;
      map { [ $_->{GCPX}, {$_->{GCPY} ] }
                  $self->metadata->GCPs;
  }

Your objects are:
    * gdal::MajorObject
        'major' should be 'base' or 'super', to follow OO terms.  What
        about:  GDAL::Object
    * gdal::Driver        GDAL::Driver
    * gdal::Dataset       GDAL::Image::Metadata
    * gdal::Band          GDAL::Image::Band
    * gdal::ColorTable    GDAL::Image::ColorTable
    * gdal::GCP           GDAL::GCP
And another object: GDAL::Image which combines related metadata and bands.
   print $image->band(3)->name;
"Image" or "Scene" or ... ?

I would also defined a transform object
   my $transform = GDAL::Transform->new(....);
   my $result = $transform->from

So: please first try to find the easiest user interface (write the
test-scripts first), and them map that onto the great features of GDAL.
-- 
Regards,
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
http://Mark.Overmeer.net                   http://solutions.overmeer.net


From richard.matsunaga at waypointinfo.com  Wed Jun 14 06:29:13 2006
From: richard.matsunaga at waypointinfo.com (Richard Matsunaga)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] memory leak in MapInfo layer
In-Reply-To: <448FAC9F.9080207@tkk.fi>
Message-ID: <000c01c68f9d$624e8bb0$6500a8c0@Maddog>


Sorry. That's a typo. The feature is added to the layer inside the using
block (wouldn't compile otherwise).

I don't dispose of the point object because it is owned by the feature once
SetGeometryDirectly is called. 

AddFeature is using CreateFeature (the naming makes more sense to me, so I
took liberties :)

Richard

-----Original Message-----
From: Ari Jolma [mailto:ari.jolma@tkk.fi] 
Sent: June 14, 2006 2:29 AM
To: Richard Matsunaga
Cc: 'Mateusz Loskot'; gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] memory leak in MapInfo layer

Richard Matsunaga kirjoitti:
> 			using (OgrFeature feature = new
> OgrFeature(layer.LayerFeatureDefinition))
> 			{
> 				for (int fieldIndex = 0; fieldIndex <
fieldValues.Count; 
> fieldIndex++)
> 				{
> 					feature.SetField(fieldIndex,
> fieldValues[fieldIndex]);
> 				}
>
> 				OgrPoint point = new OgrPoint(point.X,
point.Y);
>
> 				feature.SetGeometryDirectly(point);
>
> 	
> feature.SetStyleString(/*MapInfoStyleString*/);
> 			}
>
> 			layer.AddFeature(feature);
>   

Some comments:

- why are you using the feature outside the using block?
- what is "AddFeature"? OGR has CreateFeature and SetFeature
- why you do not dispose the point object?

Ari


--
Prof. Ari Jolma
Kartografia ja Geoinformatiikka / Cartography and Geoinformatics Teknillinen
Korkeakoulu / Helsinki University of Technology POBox 1200, 02015 TKK,
Finland
Email: ari.jolma at tkk.fi URL: http://www.tkk.fi/~jolma




From ari.jolma at tkk.fi  Wed Jun 14 08:12:44 2006
From: ari.jolma at tkk.fi (Ari Jolma)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] Changes to and upgrade of the Perl bindings
In-Reply-To: <20060614093306.GQ7890@earth.overmeer.net>
References: <448D3E1B.6080400@tkk.fi>
	<20060614093306.GQ7890@earth.overmeer.net>
Message-ID: <448FFD3C.90301@tkk.fi>

Mark Overmeer kirjoitti:
>>
>> (1)http://map.hut.fi/gdal-perl/Geo-GDAL.html
> 
> As author of Geo::Proj4 (and Perl freak in general) I would suggest
> a few changes to the interface you plan.  Is this url still the
> leading design?

Yes. That's the design for the main interface. The methods are the same
as before and in the old docs http://map.hut.fi/Geo/GDAL/gdal.html etc.

> 
> Although a most GDAL (and family) library code uses things which resemble
> objects, that does not directly map on an object-oriented implementation
> in Perl.  So: if you wish to create an OO interface, you need to start
> with seperating your interface thoughts more from what is present in
> the libs.  Most importantly: real OO hides internal complexity.
> 
> Besides, you can benefit much more from complex Perl features.  I do
> not know the specifics of the GDAL libraries (yet), but you could do:
> 
>   sub warp(@)
>   {   my ($self, %args) = @_;
>       my $proj = $args{projection} || 'wgs84';
>       ErrorReset;
>       my $result = DoWarpNow($proj);
>       return $result if defined $result;
>       $! = GetLastErrorNo;
>       $@ = errtype_to_text(GetLastErrorType).': ',GetLastErrorMsg;
>       undef;
>   }
> 
>   my $image = GDAL::Image->new(....);
> 
>   my $result = $image->warp(projection => 'nad83')
>      or die $@;
>    
> Furthermore, it would be nice to follow Perl's naming practice (although
> not abligatory) to name packages like Gdal::Driver or GDAL::Driver
> (each word starts with a cap), and methods with caps per word
> accept the first:   ->finderClean().

Is the naming practice written down somewhere? I know some modules use
finderClean naming but I've thought that's more Java's naming practise.
I thought finder_clean was used more in Perl. Here I'm trying to stick
to the naming and names that are in GDAL/OGR itself. My thinking is that
it should be easy to port GDAL scripts written in Python or Ruby to Perl
and vice versa.

My hands are also tied up a bit because of the Swig interface, where the
names are mostly defined and they are shared among all languages.

The methods usually call croak, if they fail.

> 
> Things like this:
>     $driver->{LongName}
> are a crime against OO.  It should be:
>     $driver->longName;
>     sub GDAL::Driver::longName() {shift->{LongName}}

Swig does some magic to tie things like $driver->{LongName} to getter
and setter functions.

> 
> GetDescription, SetDescription are in Perl usually merged as
>    sub description(;$)
>    {   my $self = shift;
>        @_ ? ($self->{descr} = shift) : $self->{descr};
>    }
> So: both setter and getter in one.  On the other hand: I would not
> permit people to change the description under fly... only accept
> it during (driver)object initiation.  The getter then becomes
>    sub description() {shift->{descr}}
> 
> 
> RasterXSize $dataset->{RasterXSize}
> RasterYSize $dataset->{RasterYSize}
> could better become:
>    sub rasterDimensions()
>    {   ...
>        (RasterXSize, RasterYSize);
>    }
> So people use it like
>    my $meta = GDAL::Dataset->new(...);
>    my ($w, $h) = $meta->rasterDimensions;
> 
> If things like
>  SetGeoTransform:
>   @transform = ($minX, $dx, 0, $maxY, 0, $dy);
>   $dataset->SetGeoTransform(\@transform);
> are preparations for actions, you should make it parameters to that
> action, not a seperate public method.  

Things like these are partly due to my poor knowledge of Swig. Current
versions of Swig support adding Perl code to the modules it generates,
so Perlifying things this way are more easy to do now.

>For instance, in the above
> fake warp() method:
> 
>   sub warp(@)
>   {   my ($self, %args) = @_;
>       ...
>       if(my $transform = $args{transform})
>       {   SetGeoTransform($self->{c_object}, @$transform);
>       }
>   }
> 
>   my $result = $image->warp
>     ( projection => 'utm'
>     , transform  => [ $minX, $dx, 0, $maxY, 0, $dy ]
>     ) or die $@;
> 
> This way, you reduce the amount of knowledge a user needs to have to
> use the library correctly.
> 
> Except when you have to pass multiple different arguments, avoid
> the need for people to use references (most people do not understand
> them well enough).  So:
>   $dataset->SetGeoTransform(\@transform);
> should become
>   $dataset->SetGeoTransform(@transform);
> or
>   $dataset->SetGeoTransform($minX, $dx, 0, $maxY, 0, $dy);

I have to admit this is because I did not know how to achieve the
latter, which is better also IMHO, in Swig :-(

> 
> Counters over arrays are a death-sin on Perl, except when you cannot
> avoid them.  This:
>  GetGCPs:
>   my $gcps = $dataset->GetGCPs();
>   for (0..$#$gcps) {
>     $x[$_] = $gcps->[$_]->{GCPX};
>     $y[$_] = $gcps->[$_]->{GCPY};
>   }
> 
> should become
>   my $gcps = $image->GCPs;
>   my @x = map {$_->{GCPX}} @$gcps;
>   my @y = map {$_->{GCPY}} @$gcps;
> 
> but probably nicer is:
> 
>   my $gcps   = $image->GCPs;
>   my @points = map { [ $_->{GCPX}, {$_->{GCPY} ] } @$gcps;
> 
> or better, let GCPs() return a list, then
> 
>   my @points = map { [ $_->{GCPX}, {$_->{GCPY} ] }
>                   $image->GCPs;
>   foreach my $point (@points)
>   {   print "X=$point->[0], Y=$point->[1]\n";
>   }
> 
> or better, hide this knowledge to the user
> 
>   foreach my $point ($image->GCPpoints) ...
>   
>   package GDAL::Image;
>   sub GCPpoints()
>   {   my $self = shift;
>       map { [ $_->{GCPX}, {$_->{GCPY} ] }
>                   $self->metadata->GCPs;
>   }

ah, but that's just an example in the docs...

> 
> Your objects are:
>     * gdal::MajorObject
>         'major' should be 'base' or 'super', to follow OO terms.  What
>         about:  GDAL::Object
>     * gdal::Driver        GDAL::Driver
>     * gdal::Dataset       GDAL::Image::Metadata
>     * gdal::Band          GDAL::Image::Band
>     * gdal::ColorTable    GDAL::Image::ColorTable
>     * gdal::GCP           GDAL::GCP
> And another object: GDAL::Image which combines related metadata and bands.
>    print $image->band(3)->name;
> "Image" or "Scene" or ... ?

Bands are accessed through Dataset, which is thus essentially the Image
class.

I wrote the constructor functions into the Geo::GDAL module, which are
probably yet another OO sin, because I did not know how to get from
having classes like Geo::GDAL::gdal::Band (or
Geo::GDAL::something::Band) that I get from Swig to Geo::GDAL::Band,
which would be desirable. I mean without having to change the shared
swig files too much -- i.e. write #ifdef SWIGPERL ...

I'm also a bit worried about performance penalty if I introduce yet
another layer by inheriting from Geo::GDAL::gdal::Band to Geo::GDAL::Band

There is also the problem that the GDAL library has to be used through
the swig wrappers with care, things like $image->band(3)->name are
usually dangerous, since the reference counting systems in high level
languages and in GDAL itself are disconnected.

> 
> I would also defined a transform object
>    my $transform = GDAL::Transform->new(....);
>    my $result = $transform->from
> 
> So: please first try to find the easiest user interface (write the
> test-scripts first), and them map that onto the great features of GDAL.

The current path in implementing the Perl interface to GDAL/OGR is

1) get a working interface
2) make it CPAN compatible (namespace mostly)
3) make it more Perl / fix the reference counting

We are at step 1) now. If we concentrate now just on my proposal for
Geo::GDAL and forget the other things, you're saying that:

- make it more OO (there shouldn't be any functions as in my design)
- declare the classes into Geo::GDAL namespace as (my interpretation)

Geo::GDAL::Image
Geo::GDAL::Image::Driver
Geo::GDAL::Image::Band
Geo::GDAL::Image::ColorTable
Geo::GDAL::GCP
Geo::GDAL::Transformation # I'm not very sure what classes we need for
                          # SRSs etc.
Geo::GDAL::Database # a short form of GeographicDatabase or 	

                    # VectorDatasource
Geo::GDAL::Database::Driver
Geo::GDAL::Layer
Geo::GDAL::Feature
Geo::GDAL::FeatureDefn
Geo::GDAL::FieldDefn
Geo::GDAL::Geometry

Should the last ones be Geo::GDAL::Database::Layer etc?

So, instead of a function GetGDALDriverCount we'd have a static function
Geo::GDAL::Image::Driver::Count that returns the number of available
raster drivers. And instead of CreateLayer we'd call Geo::GDAL::Layer->new.

Probably the easiest way would be to inherit the new classes from what
Swig produces. The method calls could be made better, for example it is
possible to add functionality later so that
$dataset->SetGeoTransform($minX, $dx, 0, $maxY, 0, $dy); works, while we
can keep the old $dataset->SetGeoTransform([$minX, $dx, 0, $maxY, 0,
$dy]); as deprecated form. In this step it is important to get the
namespace fixed.

It would be good to have as closely matching names as possible in all
wrapper languages.

Thanks for your comments!

Ari


-- 
Prof. Ari Jolma
Kartografia ja Geoinformatiikka / Cartography and Geoinformatics
Teknillinen Korkeakoulu / Helsinki University of Technology
tel: +358 9 451 3886 address: POBox 1200, 02015 TKK, Finland
Email: ari.jolma at tkk.fi URL: http://www.tkk.fi/~jolma


From mateusz at loskot.net  Wed Jun 14 08:33:29 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] memory leak in MapInfo layer
In-Reply-To: <000001c68f42$2b4b0c70$6500a8c0@Maddog>
References: <000001c68f42$2b4b0c70$6500a8c0@Maddog>
Message-ID: <44900219.9060209@loskot.net>

Richard Matsunaga wrote:
> Hi Mateusz,
> 
> Here is a sample of the code I am using. I have removed non-OGR 
> related details. For those who may not know, the 'using' statement is
>  used to force Dispose to be called once out of scope of the using 
> statement.


Yes, but OgrSpatialReference class is not disposable, so how did you
manage to put it in using?

VC# 2005 throws me this message:
error CS1674: 'GDALWrapper.OGR.OgrSpatialReference': type used in a
using statement must be implicitly convertible to 'System.IDisposable'

Or I have old version (from the beginning of May 2006) of your GDALWrapper?


> The C# wrapper is basically the same as the one I sent out some time
>  ago, although there have been changes - extended functionality, bug
>  fixes and some unrelated memory issues caused by the wrapper itself.
>  I can send this out again if that would help. I am fairly confident
>  at this point that the wrapper is not the cause of the leak, but 
> since I am far from being a platform invoke expert, there is a, of 
> course, chance that some unexpected behaviour with the wrapper is the
>  cause.


The best way to check is to implement the same functionality in C++
correctly and see if this also will leak.
It should be not very hard to get ESRI Shapefile/MapInfo File driver,
create datasource,
create one layer.


> I am not using any high tech means to detect memory leaks. I run the
>  code below in a loop and watch the system memory climb and climb.
> The .NET garbage collection can be a finicky thing to an outside 
> observer such as myself, but it will not allow the system to run out 
> of memory unless there is a leak of some kind, and that can be a 
> problem with managed resources or unmanaged code. I have run a few 
> .NET memory profilers and they have not found any problems. There is 
> another commercial product that I have not tried (yet) that is able 
> to instrument both managed and unmanaged code for memory profiling.


I checked the creation of data source  with .NET Memory
Profiler and also watching the memory usage in the tasks list.
I don't see huge increase of memory consuming.
I mean, 1000 layers (1000 x data source, driver, layer objects) gave me
about 2 MB memory usage.
Also the .NET Profiler reports the same number of objects created and
disposed of all classes I used.

I got problems with CreateLayer for Shapefile.
Calling OGR OGR_DS_CreateLayer gave me memory corruption.
I tried various parameters, null checking, etc.
I have no idea what's going wrong there.

But I've shown you, Valgrind on Linux does not show any memory issues
with ogr2ogr - a C++ program using OGR.
Unfortunately, I don't have any other bounds checker on Windows than
debuggers coming with VC++ and VC# 2005.

May be you could do some tests as simple as possible:
- create and add single field
- create and add single point (geometry) to feature
etc.

This way you should be able to find where is the problem in C# wrapper,
if any.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net


From mark at overmeer.net  Wed Jun 14 09:28:30 2006
From: mark at overmeer.net (Mark Overmeer)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] Changes to and upgrade of the Perl bindings
In-Reply-To: <448FFD3C.90301@tkk.fi>
References: <448D3E1B.6080400@tkk.fi>
	<20060614093306.GQ7890@earth.overmeer.net> <448FFD3C.90301@tkk.fi>
Message-ID: <20060614132830.GA7890@earth.overmeer.net>

* Ari Jolma (ari.jolma@tkk.fi) [060614 12:12]:
> Is the naming practice written down somewhere? I know some modules use
> finderClean naming but I've thought that's more Java's naming practise.

not AFAIK  But have a look at the large modules, like XML::LibXML

> I thought finder_clean was used more in Perl.

For functions.

> Here I'm trying to stick
> to the naming and names that are in GDAL/OGR itself. My thinking is that
> it should be easy to port GDAL scripts written in Python or Ruby to Perl
> and vice versa.

That will result in the same quality of code as the language translations
of Google's babel.  Don't!

> My hands are also tied up a bit because of the Swig interface, where the
> names are mostly defined and they are shared among all languages.

No, your hands are not tied.  Swig creates the interface between the
library and Perl, but NO-ONE forces you to publish the library interface
directly to module users.  Please do not burdon the users with Swigs
limits!!!

> > Things like this:
> >     $driver->{LongName}
> > are a crime against OO.  It should be:
> >     $driver->longName;
> >     sub GDAL::Driver::longName() {shift->{LongName}}
> 
> Swig does some magic to tie things like $driver->{LongName} to getter
> and setter functions.

Well, so... you see that the tie is still used: but only inside the
object.

> Things like these are partly due to my poor knowledge of Swig. Current
> versions of Swig support adding Perl code to the modules it generates,
> so Perlifying things this way are more easy to do now.

That is not a problem.  You let Swig create a module  GDAL::Image::Dataset,
in file GDAL/Image/Dataset.pm   User's have in their scripts "use GDAL::Image"  
In GDAL/Image.pm, you simply say:

  use GDAL::Image::Dataset;
  package GDAL::Image::Dataset;
  sub myNewOwnMethod()....

In ANY file, you can add methods and variables to ANY namespace, with the
package command.  You can put the wrapper code simply in GDAL/Image.pm
but also in some other module:

  GDAL/Image/DatasetWrapper.pm:
      use GDAL::Image::Dataset;
      package GDAL::Image::Dataset;
      sub myNewOwnMethod()....

> >   $dataset->SetGeoTransform(\@transform);
> > should become
> >   $dataset->SetGeoTransform(@transform);
> > or
> >   $dataset->SetGeoTransform($minX, $dx, 0, $maxY, 0, $dy);
> 
> I have to admit this is because I did not know how to achieve the
> latter, which is better also IMHO, in Swig :-(

Very simple... SWIG produces a function:
   SetGeoTransform($dataset, \@transform);
and you create a method
   sub setGeoTransform(@)
   {   my $self = shift;
       SetGeoTransform($self, \@_);
   }

> >  GetGCPs:
> >   my $gcps = $dataset->GetGCPs();
> >   for (0..$#$gcps) {
> >     $x[$_] = $gcps->[$_]->{GCPX};
> >     $y[$_] = $gcps->[$_]->{GCPY};
> >   }
> > 
> > should become
> > 
> >   foreach my $point ($image->GCPpoints) ...
> 
> ah, but that's just an example in the docs...

I surely hope you implement as you plan, so examples should work.  It
is silly to write examples that are ugly.

If you start writing the docs and tests from a "best usage" for the
average user, then you will end-up with a nice module.

> I wrote the constructor functions into the Geo::GDAL module, which are
> probably yet another OO sin, because I did not know how to get from
> having classes like Geo::GDAL::gdal::Band (or
> Geo::GDAL::something::Band) that I get from Swig to Geo::GDAL::Band,
> which would be desirable. I mean without having to change the shared
> swig files too much -- i.e. write #ifdef SWIGPERL ...

 *My::Favorit::Package::Name::new = \&Geo::GDAL::gdal::Band::new;

> I'm also a bit worried about performance penalty if I introduce yet
> another layer by inheriting from Geo::GDAL::gdal::Band to Geo::GDAL::Band

non-argument.  The application will run inside the library for 99.99% of
its time.  Besides, we have a software crisis, not a hardware limitation.

> There is also the problem that the GDAL library has to be used through
> the swig wrappers with care, things like $image->band(3)->name are
> usually dangerous, since the reference counting systems in high level
> languages and in GDAL itself are disconnected.

No, you will not get into these problems (when SWIG is working as it
should).

> The current path in implementing the Perl interface to GDAL/OGR is
> 1) get a working interface
> 2) make it CPAN compatible (namespace mostly)
> 3) make it more Perl / fix the reference counting

Please start with (2) to safe yourself a lot of work.  I would refrase
(1) into: design a workable interface.

> Geo::GDAL::Database::Driver
> Geo::GDAL::Layer
> Geo::GDAL::Feature
> Geo::GDAL::FeatureDefn
> Geo::GDAL::FieldDefn
> Geo::GDAL::Geometry
> Should the last ones be Geo::GDAL::Database::Layer etc?

I don't know enough about the meaning of the names.  Are all these
objects really necessary to publish to the users?  Can't you hide them?

> So, instead of a function GetGDALDriverCount we'd have a static function
> Geo::GDAL::Image::Driver::Count that returns the number of available
> raster drivers. And instead of CreateLayer we'd call Geo::GDAL::Layer->new.

In "real" Perl, you should implement it like this:

  # Returns the driver details as LIST of objects, count in SCALAR.
  package GDAL;
  sub drivers()
  {   my $count = GetGDALDriverCount;
      return $count unless wantarray;
      map {GDAL::Driver->new(number => $_)} 0..$count-1;
  }

  package GDAL::Driver;
  sub new(@)
  {   my ($class, %args) = @_;
      my $self   = bless {}, $class;
      my $number = $args{number} || 0;
      my $data   = Swig::GetDriverDataByNumber($number);
      copyDriverData($self, $data);    # to be implemented
      $self;
  }

  package main;   # the main program
  use GDAL;
  foreach my $driver (GDAL->drivers)
  {   print $driver->longName, "\n";
  }
  print scalar(GDAL->drivers), " drivers defined\n";

> It would be good to have as closely matching names as possible in all
> wrapper languages.

No. mistake.
Strive for the smallest and easiest user interface, then for the
practices used by the programming language at hand, and only on the
last place... when you have a few names to choose, then try to use
names which indicate the relation.   It is silly to give the user
access to 50 library methods where he/she could do with only three.
-- 
CU,
               MarkOv

From Tom.Kralidis at ec.gc.ca  Wed Jun 14 10:08:29 2006
From: Tom.Kralidis at ec.gc.ca (Kralidis,Tom [Burlington])
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] gdaltindex on numerous files
Message-ID: <2576812186CDD411BF1500508B6DCE950D17F2ED@ecnwri1.ontario.int.ec.gc.ca>

Hi,
 
I'm trying to create a MapServer tileindex via gdaltindex, where I would like to store the absolute paths to each raster image in the output tileindex.
 
Trying this gives me the following error:
 
$ gdaltindex srtm-index2 $PWD/*.tif
-bash: /usr/local/bin/gdaltindex: Argument list too long
 
Does gdaltindex take a filelist as an argument?  Trying:
 
 
$ gdaltindex srtm-index2 < some_file
$ gdaltindex srtm-index2 some_file
 
...didn't work.
 
Any advice would be much appreciated.
 
Thanks
 
..Tom
 


From hobu at iastate.edu  Wed Jun 14 10:19:52 2006
From: hobu at iastate.edu (Howard Butler)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] gdaltindex on numerous files
In-Reply-To: <2576812186CDD411BF1500508B6DCE950D17F2ED@ecnwri1.ontario.int.ec.gc.ca>
References: <2576812186CDD411BF1500508B6DCE950D17F2ED@ecnwri1.ontario.int.ec.gc.ca>
Message-ID: <p06230923c0b5cabea282@[192.168.11.4]>

Tom,

Is it possible xargs can do the trick to fix the 'argument list is too long'?

See <http://freebooks.by.ru/view/ShellProgIn24h/31480122.htm>

I don't know if gdaltindex can do absolute paths, but if you want to 
create custom tileindexes in any special way, you might look at 
Sean's scripts from the OSGIS '05 Hacks workshop. 
<http://hobu.biz/software/OSGIS_Hacks/python_OSGIS_hacks_aggregation.pdf>

Howard

At 10:08 AM -0400 6/14/06, Kralidis,Tom [Burlington] wrote:
>Hi,
>
>I'm trying to create a MapServer tileindex via gdaltindex, where I 
>would like to store the absolute paths to each raster image in the 
>output tileindex.
>
>Trying this gives me the following error:
>
>$ gdaltindex srtm-index2 $PWD/*.tif
>-bash: /usr/local/bin/gdaltindex: Argument list too long
>
>Does gdaltindex take a filelist as an argument?  Trying:
>
>
>$ gdaltindex srtm-index2 < some_file
>$ gdaltindex srtm-index2 some_file
>
>...didn't work.
>
>Any advice would be much appreciated.
>
>Thanks
>
>..Tom
>
>
>_______________________________________________
>Gdal-dev mailing list
>Gdal-dev@lists.maptools.org
>http://lists.maptools.org/mailman/listinfo/gdal-dev


From ILucena at clarku.edu  Wed Jun 14 10:26:37 2006
From: ILucena at clarku.edu (Ivan Lucena)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] gdaltindex on numerous files
Message-ID: <6FD7C9DB26540B42A1207C69BF92D455017A716A@Iris.ad.clarku.edu>

Tom,

UNIX handles wildcard different than Windows. It will expand it and then
rebuild your command line. That is way it could be to long. 

You should make UNIX create one command for each file found using
something like:

$ find $PWD -name '*.tif' -exec gdaltindex ... \;

Good luck,

Ivan


-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Kralidis,Tom
[Burlington]
Sent: 14 June 2006 10:08
To: gdal-dev@lists.maptools.org
Subject: [Gdal-dev] gdaltindex on numerous files

Hi,
 
I'm trying to create a MapServer tileindex via gdaltindex, where I would
like to store the absolute paths to each raster image in the output
tileindex.
 
Trying this gives me the following error:
 
$ gdaltindex srtm-index2 $PWD/*.tif
-bash: /usr/local/bin/gdaltindex: Argument list too long
 
Does gdaltindex take a filelist as an argument?  Trying:
 
 
$ gdaltindex srtm-index2 < some_file
$ gdaltindex srtm-index2 some_file
 
...didn't work.
 
Any advice would be much appreciated.
 
Thanks
 
..Tom
 

_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev


From Tom.Kralidis at ec.gc.ca  Wed Jun 14 10:32:51 2006
From: Tom.Kralidis at ec.gc.ca (Kralidis,Tom [Burlington])
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] gdaltindex on numerous files
References: <6FD7C9DB26540B42A1207C69BF92D455017A716A@Iris.ad.clarku.edu>
Message-ID: <2576812186CDD411BF1500508B6DCE950D17F2EF@ecnwri1.ontario.int.ec.gc.ca>

 
Ivan,
 
Thanks for the info.  This did the trick:
 
$ find $PWD -name "*.tif" -exec gdaltindex srtm-index3 {} \;
 
Thanks
 
..Tom

	-----Original Message----- 
	From: Ivan Lucena [mailto:ILucena@clarku.edu] 
	Sent: Wed 14-Jun-06 10:26 
	To: Kralidis,Tom [Burlington]; gdal-dev@lists.maptools.org 
	Cc: 
	Subject: RE: [Gdal-dev] gdaltindex on numerous files
	
	

	Tom,
	
	UNIX handles wildcard different than Windows. It will expand it and then
	rebuild your command line. That is way it could be to long.
	
	You should make UNIX create one command for each file found using
	something like:
	
	$ find $PWD -name '*.tif' -exec gdaltindex ... \;
	
	Good luck,
	
	Ivan
	
	
	-----Original Message-----
	From: gdal-dev-bounces@lists.maptools.org
	[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Kralidis,Tom
	[Burlington]
	Sent: 14 June 2006 10:08
	To: gdal-dev@lists.maptools.org
	Subject: [Gdal-dev] gdaltindex on numerous files
	
	Hi,
	
	I'm trying to create a MapServer tileindex via gdaltindex, where I would
	like to store the absolute paths to each raster image in the output
	tileindex.
	
	Trying this gives me the following error:
	
	$ gdaltindex srtm-index2 $PWD/*.tif
	-bash: /usr/local/bin/gdaltindex: Argument list too long
	
	Does gdaltindex take a filelist as an argument?  Trying:
	
	
	$ gdaltindex srtm-index2 < some_file
	$ gdaltindex srtm-index2 some_file
	
	...didn't work.
	
	Any advice would be much appreciated.
	
	Thanks
	
	..Tom
	
	
	_______________________________________________
	Gdal-dev mailing list
	Gdal-dev@lists.maptools.org
	http://lists.maptools.org/mailman/listinfo/gdal-dev
	



From mateusz at loskot.net  Wed Jun 14 10:34:27 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] gdaltindex on numerous files
In-Reply-To: <2576812186CDD411BF1500508B6DCE950D17F2ED@ecnwri1.ontario.int.ec.gc.ca>
References: <2576812186CDD411BF1500508B6DCE950D17F2ED@ecnwri1.ontario.int.ec.gc.ca>
Message-ID: <44901E73.6040502@loskot.net>

Kralidis,Tom [Burlington] wrote:
> Hi,
> 
> I'm trying to create a MapServer tileindex via gdaltindex, where I
> would like to store the absolute paths to each raster image in the
> output tileindex.
> 
> Trying this gives me the following error:
> 
> $ gdaltindex srtm-index2 $PWD/*.tif
> -bash: /usr/local/bin/gdaltindex:
> Argument list too long

Hmm, I'd suppose the problem is with your shell environment.
I use GNU Bash 3.1.17 and your command works well:

mloskot:~/data/samples$ gdaltindex ind $PWD/workshop/*.tif
mloskot:~/data/samples$ dbfdump -h ind
Field 0: Type=String, Title=`location', Width=255, Decimals=0
location
/home/mloskot/data/samples/workshop/drgncimq1926.tif
/home/mloskot/data/samples/workshop/drgncimq1942.tif

but if I run without $PWD:

mloskot:~/data/samples$ gdaltindex ind workshop/*.tif

gdaltindex produces relative paths:

mloskot:~/data/samples$ dbfdump -h ind
Field 0: Type=String, Title=`location', Width=255, Decimals=0
location
workshop/drgncimq1926.tif
workshop/drgncimq1942.tif

and that's normal behaviour.

gdaltindex takes paths as it gets. If you call with
$PWD/workshop/*.tif

the path is constructed as follows:

/home/mloskot/workshop/ + <filename>.tif


> Does gdaltindex take a filelist as an argument?


No, it does not.

MapServer's tile4ms takes metafile with input files list.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From mateusz at loskot.net  Wed Jun 14 10:56:27 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] gdaltindex on numerous files
In-Reply-To: <2576812186CDD411BF1500508B6DCE950D17F2EF@ecnwri1.ontario.int.ec.gc.ca>
References: <6FD7C9DB26540B42A1207C69BF92D455017A716A@Iris.ad.clarku.edu>
	<2576812186CDD411BF1500508B6DCE950D17F2EF@ecnwri1.ontario.int.ec.gc.ca>
Message-ID: <4490239B.7070708@loskot.net>

Kralidis,Tom [Burlington] wrote:
>  
> Thanks for the info.  This did the trick:
>  
> $ find $PWD -name "*.tif" -exec gdaltindex srtm-index3 {} \;

Tom, as Howard said too, you can achive the same with simplier syntax
using xargs:

find $PWD -name '*.tif' | xargs gdaltindex indexfile


Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From ari.jolma at tkk.fi  Wed Jun 14 13:20:43 2006
From: ari.jolma at tkk.fi (Ari Jolma)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] Changes to and upgrade of the Perl bindings
In-Reply-To: <20060614132830.GA7890@earth.overmeer.net>
References: <448D3E1B.6080400@tkk.fi>
	<20060614093306.GQ7890@earth.overmeer.net> <448FFD3C.90301@tkk.fi>
	<20060614132830.GA7890@earth.overmeer.net>
Message-ID: <4490456B.6090800@tkk.fi>

Mark Overmeer kirjoitti:
>   print scalar(GDAL->drivers), " drivers defined\n";
>   

Suppose I have Geo::GDAL::Layer::features. There may be millions of 
features in one layer. If this method really returns all of them in a 
list, it may take a while. Would scalar (Geo::GDAL::Layer::features) 
then also take a while, or can I somehow detect that inside the method 
(with wantarray) and call featureCount and return what it returns.. hmm, 
maybe I can. And what if the user calls it like this: 
Geo::GDAL::Layer::features->[34] to get just one feature?

I'm just trying to figure out what methods are needed:

feature
features
addFeature
featureCount
etc..

I've updated http://map.hut.fi/gdal-perl/Geo-GDAL.html but it's not 
finished since it will contain _all_ classes and their methods.

Ari

-- 
Prof. Ari Jolma
Kartografia ja Geoinformatiikka / Cartography and Geoinformatics
Teknillinen Korkeakoulu / Helsinki University of Technology
POBox 1200, 02015 TKK, Finland
Email: ari.jolma at tkk.fi URL: http://www.tkk.fi/~jolma


From aaronkoning at gmail.com  Wed Jun 14 15:25:31 2006
From: aaronkoning at gmail.com (Aaron Koning)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] Hi OGR'ers
Message-ID: <1319fbba0606141225o6c96d19x4f4f704ebd27d7a3@mail.gmail.com>

I have just started using a newer version of OGR that includes Date support.
(Context: I am importing shapefiles into PostgreSQL using OGR/PHP).
Unfortuently, when I have a null Date value in the shapefile OGR bails
stating that I may need another Date type. Is there anyway of getting OGR to
insert Null date values when there is a null value present?

Aaron

+--------------------------------------------
|  Aaron Koning
|  Information Technologist
|  Prince George, BC, Canada.
+--------------------------------------------
|  http://datashare.gis.unbc.ca/fist/
|  http://datashare.gis.unbc.ca/gctp-js/
+--------------------------------------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060614/5954efac/attachment.html
From zhonghaiw at gmail.com  Wed Jun 14 16:04:30 2006
From: zhonghaiw at gmail.com (Zhonghai Wang)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] Compile GDAL with VS2005 (BuildKit Source Code)
Message-ID: <2534c4120606141304n190c729h3bb635ec9b24c59@mail.gmail.com>

hi there,

been pasted this message in MapServer mailing list, but I realized that it
may be better if I paste it here, since it's GDAL problem. Sorry for the
duplicated message.

I am trying to compile GDAL with VS2005, but there are  a lot of error
messages after the namake /f makefile.vc command. Here is what I have done:

1.source code download: -- the MapServer BuildKit from Howard Butler
   http://hobu.stat.iastate.edu/mapserver/build_output/
   and I have downloaded the latest package version "
mapserver-4.8.3-2-msvc71-buildk-kit.zip"
2.and I follow the compilation guide here:

http://www.nabble.com/Windows-build-kit-for-MSVC-7.1-t1143108.html#a2997024
   to compile MapServer, according to this doc, I should at first compile
the GDAL package, and then come to the MapServer package. But when I am
trying to compile the GDAL
   package under VS2005 command prompt with the command "nmake /f
makefile.vc", there are some error messages appears, the scenario is:
********************************
*C:\buildkit\gdal-1.3.2>nmake /f makefile.vc clean
*C:\buildkit\gdal-1.3.2>nmake /f makefile.vc
*
*
*
*and here come the error messages, I paste only the first one here, because
I think if I fix this problem, the other error may be fixed at the same
time:
*
*msvcprt.lib(MSVCP80.dll) : error LNK2005: "class
std::basic_string<char,struct s
*td::char_traits<char>,class std::allocator<char> > __cdecl
std::operator+<char,s
*truct std::char_traits<char>,class std::allocator<char> >(class
std::basic_strin
*g<char,struct std::char_traits<char>,class std::allocator<char> > const
&,char c
*onst *)" (??$?HDU?$char_traits@...<http://www.nabble.com/user/SendEmail.jtp?type=post&post=4867349&i=0>
*
**@... <http://www.nabble.com/user/SendEmail.jtp?type=post&post=4867349&i=1>)
already defined in geos
*.lib(WKTReader.obj)
*
*********************************
I am really confused now, i am just wondering if GDAL can be compiled with
VS2005, or it can only be compiled with VC ++ 6?

thanks for any information.

zhonghai
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060614/695669d8/attachment.html
From hobu at iastate.edu  Wed Jun 14 16:14:35 2006
From: hobu at iastate.edu (Howard Butler)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] Compile GDAL with VS2005 (BuildKit Source Code)
In-Reply-To: <2534c4120606141304n190c729h3bb635ec9b24c59@mail.gmail.com>
References: <2534c4120606141304n190c729h3bb635ec9b24c59@mail.gmail.com>
Message-ID: <6.2.3.4.2.20060614150833.02adc5d0@hobu.mail.iastate.edu>

Zhonghai,

Yes GDAL can be compiled with MSVC 6, MSVC 2003, and MSVC 2005 -- 
from scratch  The buildkit on hobu.stat.iastate.edu is *specifically* 
for MSVC 2003.  This is because all of the "support" libraries have 
been compiled for you.  For example, in your pasted output, it is 
complaining about linkage errors with GEOS.  This is because GEOS was 
compiled with MSVC 2003, and the two C++ runtimes (MSVC 2003 (7.1) 
and MSVC 2005 (8.0)) are incompatible.  To successfully use the 
buildkit, you would have to recompile *every* library that 
MapServer/GDAL brings in with MSVC 2005.

The buildkit is not of much use if you have to recompile everything 
for your compiler platform.  Maybe someday, when I get MSVC 2005, I 
will roll out a buildkit for that as well.  In the interim, you are 
probably best off by downloading everything you need as source and 
building it all up individually.  Alternatively, you could switch to 
MSVC 2003 and use the buildkit, or start with the buildkit and go in 
and recompile each and every support library that you plan to 
link/use with MapServer/GDAL and MSVC 2005.

Howard




At 03:04 PM 6/14/2006, Zhonghai Wang wrote:
>hi there,
>
>been pasted this message in MapServer mailing list, but I realized 
>that it may be better if I paste it here, since it's GDAL problem. 
>Sorry for the duplicated message.
>
>I am trying to compile GDAL with VS2005, but there are  a lot of 
>error messages after the namake /f <http://makefile.vc>makefile.vc 
>command. Here is what I have done:
>
>1.source code download: -- the MapServer BuildKit from Howard Butler
> 
><http://hobu.stat.iastate.edu/mapserver/build_output/>http://hobu.stat.iastate.edu/mapserver/build_output/
>    and I have downloaded the latest package version 
> "mapserver-4.8.3-2-msvc71-buildk-kit.zip"
>2.and I follow the compilation guide here:
> 
><http://www.nabble.com/Windows-build-kit-for-MSVC-7.1-t1143108.html#a2997024>http://www.nabble.com/Windows-build-kit-for-MSVC-7.1-t1143108.html#a2997024 
>
>    to compile MapServer, according to this doc, I should at first 
> compile the GDAL package, and then come to the MapServer package. 
> But when I am trying to compile the GDAL
>    package under VS2005 command prompt with the command "nmake /f 
> <http://makefile.vc/>makefile.vc", there are some error messages 
> appears, the scenario is:
>********************************
>*C:\buildkit\gdal-1.3.2>nmake /f <http://makefile.vc/>makefile.vc clean
>*C:\buildkit\gdal-1.3.2>nmake /f <http://makefile.vc/>makefile.vc
>*
>*
>*
>*and here come the error messages, I paste only the first one here, 
>because I think if I fix this problem, the other error may be fixed 
>at the same time:
>*
>*msvcprt.lib(MSVCP80.dll) : error LNK2005: "class 
>std::basic_string<char,struct s
>*td::char_traits<char>,class std::allocator<char> > __cdecl 
>std::operator+<char,s
>*truct std::char_traits<char>,class std::allocator<char> >(class 
>std::basic_strin
>*g<char,struct std::char_traits<char>,class std::allocator<char> > 
>const &,char c
>*onst *)" 
>(<http://www.nabble.com/user/SendEmail.jtp?type=post&post=4867349&i=0> 
>??$?HDU?$char_traits@...*
>*<http://www.nabble.com/user/SendEmail.jtp?type=post&post=4867349&i=1>*@...) 
>already defined in geos
>*.lib(WKTReader.obj)
>*
>*********************************
>I am really confused now, i am just wondering if GDAL can be 
>compiled with VS2005, or it can only be compiled with VC ++ 6?
>
>thanks for any information.
>
>zhonghai
>_______________________________________________
>Gdal-dev mailing list
>Gdal-dev@lists.maptools.org
>http://lists.maptools.org/mailman/listinfo/gdal-dev


From bclay at ball.com  Wed Jun 14 16:22:00 2006
From: bclay at ball.com (Clay, Bruce)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] FW: multi-layer geotiff
Message-ID: <C482FF98AE985A47B8C982FD429C9E34FEF84D@daytonmsg2k3.AERO.BALL.COM>

 

 

-----Original Message-----
From: Clay, Bruce 
Sent: Wednesday, June 14, 2006 1:37 PM
To: 'gdal-dev@remotesensing.org'
Subject: multi-layer geotiff

 

Can GDAL be used to open multi-layer Geotiff raster files?

 

Not multi-band but more than one image in the same file. I was given
some Geotiff images that Microsoft Office Imaging tool shows 2 distinct
images in a single tiff file.

 

IDL was used to create the file using an APPEND function.

 

ArcMap does not seem to be able to find the second images so I would
like to extract the image using GDAL but I don't see any info in the
documentation.

 

Bruce

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060614/2d5746d0/attachment.html
From zhonghaiw at gmail.com  Wed Jun 14 16:36:57 2006
From: zhonghaiw at gmail.com (Zhonghai Wang)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] Compile GDAL with VS2005 (BuildKit Source Code)
In-Reply-To: <6.2.3.4.2.20060614150833.02adc5d0@hobu.mail.iastate.edu>
References: <2534c4120606141304n190c729h3bb635ec9b24c59@mail.gmail.com>
	<6.2.3.4.2.20060614150833.02adc5d0@hobu.mail.iastate.edu>
Message-ID: <2534c4120606141336g25f4f369ve4f86422d44a472a@mail.gmail.com>

Hi Howard,

thanks you so much for the important HINTS.

so you mean that I must compile all the needed libraries in the BuildKit
package myself with VS2005? Is this compilation guide still valid for the
whole compilation?
http://www.nabble.com/Windows-build-kit-for-MSVC-7.1-t1143108.html#a2997024>
http://www.nabble.com/Windows-build-kit-for-MSVC-7.1-t1143108.html#a2997024.<http://www.nabble.com/Windows-build-kit-for-MSVC-7.1-t1143108.html#a2997024>

so the steps may be:
1. compile the required libraries for GDAL (according to the component that
I need)
2. compile GDAL
3. compile the required libraries for MapServer
4. compile MapServer

and here is the last question^_^:
what does the command "nmake /f makefile.vc install" mean? for this command
which parameters in the nmake.opt file should be set correctly?

I really appreciate your help.

best regards

zhonghai

On 6/14/06, Howard Butler <hobu@iastate.edu> wrote:
>
> Zhonghai,
>
> Yes GDAL can be compiled with MSVC 6, MSVC 2003, and MSVC 2005 --
> from scratch  The buildkit on hobu.stat.iastate.edu is *specifically*
> for MSVC 2003.  This is because all of the "support" libraries have
> been compiled for you.  For example, in your pasted output, it is
> complaining about linkage errors with GEOS.  This is because GEOS was
> compiled with MSVC 2003, and the two C++ runtimes (MSVC 2003 (7.1)
> and MSVC 2005 (8.0)) are incompatible.  To successfully use the
> buildkit, you would have to recompile *every* library that
> MapServer/GDAL brings in with MSVC 2005.
>
> The buildkit is not of much use if you have to recompile everything
> for your compiler platform.  Maybe someday, when I get MSVC 2005, I
> will roll out a buildkit for that as well.  In the interim, you are
> probably best off by downloading everything you need as source and
> building it all up individually.  Alternatively, you could switch to
> MSVC 2003 and use the buildkit, or start with the buildkit and go in
> and recompile each and every support library that you plan to
> link/use with MapServer/GDAL and MSVC 2005.
>
> Howard
>
>
>
>
> At 03:04 PM 6/14/2006, Zhonghai Wang wrote:
> >hi there,
> >
> >been pasted this message in MapServer mailing list, but I realized
> >that it may be better if I paste it here, since it's GDAL problem.
> >Sorry for the duplicated message.
> >
> >I am trying to compile GDAL with VS2005, but there are  a lot of
> >error messages after the namake /f <http://makefile.vc>makefile.vc
> >command. Here is what I have done:
> >
> >1.source code download: -- the MapServer BuildKit from Howard Butler
> >
> ><http://hobu.stat.iastate.edu/mapserver/build_output/>
> http://hobu.stat.iastate.edu/mapserver/build_output/
> >    and I have downloaded the latest package version
> > "mapserver-4.8.3-2-msvc71-buildk-kit.zip"
> >2.and I follow the compilation guide here:
> >
> ><
> http://www.nabble.com/Windows-build-kit-for-MSVC-7.1-t1143108.html#a2997024
> >
> http://www.nabble.com/Windows-build-kit-for-MSVC-7.1-t1143108.html#a2997024
> >
> >    to compile MapServer, according to this doc, I should at first
> > compile the GDAL package, and then come to the MapServer package.
> > But when I am trying to compile the GDAL
> >    package under VS2005 command prompt with the command "nmake /f
> > <http://makefile.vc/>makefile.vc", there are some error messages
> > appears, the scenario is:
> >********************************
> >*C:\buildkit\gdal-1.3.2>nmake /f <http://makefile.vc/>makefile.vc clean
> >*C:\buildkit\gdal-1.3.2>nmake /f <http://makefile.vc/>makefile.vc
> >*
> >*
> >*
> >*and here come the error messages, I paste only the first one here,
> >because I think if I fix this problem, the other error may be fixed
> >at the same time:
> >*
> >*msvcprt.lib(MSVCP80.dll) : error LNK2005: "class
> >std::basic_string<char,struct s
> >*td::char_traits<char>,class std::allocator<char> > __cdecl
> >std::operator+<char,s
> >*truct std::char_traits<char>,class std::allocator<char> >(class
> >std::basic_strin
> >*g<char,struct std::char_traits<char>,class std::allocator<char> >
> >const &,char c
> >*onst *)"
> >(<http://www.nabble.com/user/SendEmail.jtp?type=post&post=4867349&i=0>
> >??$?HDU?$char_traits@...*
> >*<http://www.nabble.com/user/SendEmail.jtp?type=post&post=4867349&i=1
> >*@...)
> >already defined in geos
> >*.lib(WKTReader.obj)
> >*
> >*********************************
> >I am really confused now, i am just wondering if GDAL can be
> >compiled with VS2005, or it can only be compiled with VC ++ 6?
> >
> >thanks for any information.
> >
> >zhonghai
> >_______________________________________________
> >Gdal-dev mailing list
> >Gdal-dev@lists.maptools.org
> >http://lists.maptools.org/mailman/listinfo/gdal-dev
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060614/0dacd151/attachment.html
From hobu at iastate.edu  Wed Jun 14 16:48:46 2006
From: hobu at iastate.edu (Howard Butler)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] Compile GDAL with VS2005 (BuildKit Source Code)
In-Reply-To: <2534c4120606141336g25f4f369ve4f86422d44a472a@mail.gmail.co
 m>
References: <2534c4120606141304n190c729h3bb635ec9b24c59@mail.gmail.com>
	<6.2.3.4.2.20060614150833.02adc5d0@hobu.mail.iastate.edu>
	<2534c4120606141336g25f4f369ve4f86422d44a472a@mail.gmail.com>
Message-ID: <6.2.3.4.2.20060614154603.01e715c0@hobu.mail.iastate.edu>

At 03:36 PM 6/14/2006, Zhonghai Wang wrote:
>Hi Howard,
>
>thanks you so much for the important HINTS.
>
>so you mean that I must compile all the needed libraries in the 
>BuildKit package myself with VS2005? Is this compilation guide still 
>valid for the whole compilation? 
><http://www.nabble.com/Windows-build-kit-for-MSVC-7.1-t1143108.html#a2997024>http://www.nabble.com/Windows-build-kit-for-MSVC-7.1-t1143108.html#a2997024  
> >http://www.nabble.com/Windows-build-kit-for-MSVC-7.1-t1143108.html#a2997024.

It would still be valid if all of the support libs that you need are 
also compiled with VS2005.  This can be a challenging and frustrating 
task, and it is one of the major reasons why I made the buildkit in 
the first place.


>so the steps may be:
>1. compile the required libraries for GDAL (according to the 
>component that I need)
>2. compile GDAL
>3. compile the required libraries for MapServer
>4. compile MapServer

yep.


>and here is the last question^_^:
>what does the command "nmake /f <http://makefile.vc>makefile.vc 
>install" mean? for this command which parameters in the nmake.opt 
>file should be set correctly?

for both GDAL and MapServer, this command just copies the things 
you'll want to use (.exe's, .dlls, etc) into a common directory 
(..\bin, I think).  It doesn't do anything fancier than that.

Howard 


From dmorissette at mapgears.com  Wed Jun 14 16:56:26 2006
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] Tool to convert shapefile from [-180, 180] to [0, 360]
	range
In-Reply-To: <448F6158.5070407@loskot.net>
References: <448F3658.9000101@mapgears.com> <448F6158.5070407@loskot.net>
Message-ID: <449077FA.2090409@mapgears.com>

Mateusz Loskot wrote:
> 
> I created small utility on basis of ogr2ogr according your needs, just
> for fun and practice :-)
> I attached it as a 180to360.cpp file, so it's a C++ application.
> I hope this attachement will not be cutted off by the gdal-dev mailer.
> It works only with shapefiles.
> 
> This utility just adds 180 to every x coordinate.
> So, it works well only if input coordinates are in range frm -180 to
> 180, but it does not check it.

Hi Mateusz,

Thanks for the little program, that's what I was thinking of doing too. 
In case anyone is interested, I have attached a new version that I 
modified it a little bit to:

1- Shift by +360 instead of +180. i.e. -50 degrees = +310 degrees
2- Shift coordinates only if the centroid of the source feature is in 
the [-180,0] range

One last thing to do would be support for geometries other than points 
(at least linestrings and polygons).

Daniel
-- 
Daniel Morissette
http://www.mapgears.com/
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 180to360.cpp
Type: text/x-c++src
Size: 12385 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060614/1ca56acd/180to360.bin
From dmorissette at mapgears.com  Wed Jun 14 16:59:25 2006
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] Tool to convert shapefile from [-180, 180] to [0, 360]
	range
In-Reply-To: <449077FA.2090409@mapgears.com>
References: <448F3658.9000101@mapgears.com> <448F6158.5070407@loskot.net>
	<449077FA.2090409@mapgears.com>
Message-ID: <449078AD.3060500@mapgears.com>

OOpps.. the file I just sent contained a typo in the bNeedToShift test. 
Works fine for points still since minx == maxx, but would not have 
worked too well for some polygons or linestrings.

Here is what it should have been:

        bNeedToShift = ((oEnv.MinX+oEnv.MaxX)/2.0<0.0) ? TRUE : FALSE;

Daniel



Daniel Morissette wrote:
> Mateusz Loskot wrote:
> 
>>
>> I created small utility on basis of ogr2ogr according your needs, just
>> for fun and practice :-)
>> I attached it as a 180to360.cpp file, so it's a C++ application.
>> I hope this attachement will not be cutted off by the gdal-dev mailer.
>> It works only with shapefiles.
>>
>> This utility just adds 180 to every x coordinate.
>> So, it works well only if input coordinates are in range frm -180 to
>> 180, but it does not check it.
> 
> 
> Hi Mateusz,
> 
> Thanks for the little program, that's what I was thinking of doing too. 
> In case anyone is interested, I have attached a new version that I 
> modified it a little bit to:
> 
> 1- Shift by +360 instead of +180. i.e. -50 degrees = +310 degrees
> 2- Shift coordinates only if the centroid of the source feature is in 
> the [-180,0] range
> 
> One last thing to do would be support for geometries other than points 
> (at least linestrings and polygons).
> 
> Daniel
> 
> 
> ------------------------------------------------------------------------
> 
> // Converts longtitude format from -180;180 to 0;360 degrees
> // This program was created on basis of ogr2ogr
> 
> #include "ogrsf_frmts.h"
> #include "ogr_p.h"
> #include "cpl_conv.h"
> #include "cpl_string.h"
> #include "ogr_api.h"
> 
> static void Usage();
> 
> static int TranslateLayer( OGRDataSource *poSrcDS, 
>                            OGRLayer * poSrcLayer,
>                            OGRDataSource *poDstDS,
>                            char ** papszLSCO,
>                            const char *pszNewLayerName,
>                            int bTransform, 
>                            OGRSpatialReference *poOutputSRS,
>                            OGRSpatialReference *poSourceSRS,
>                            char **papszSelFields,
>                            int bAppend, int eGType,
>                            int bOverwrite );
> 
> static int bSkipFailures = FALSE;
> static int nGroupTransactions = 200;
> static int bPreserveFID = FALSE;
> static int nFIDToFetch = OGRNullFID;
> 
> /************************************************************************/
> /*                                main()                                */
> /************************************************************************/
> 
> int main( int nArgc, char ** papszArgv )
> 
> {
>     const char  *pszFormat = "ESRI Shapefile";
>     const char  *pszDataSource = NULL;
>     const char  *pszDestDataSource = NULL;
>     char        **papszLayers = NULL;
>     char        **papszDSCO = NULL, **papszLCO = NULL;
>     int         bTransform = FALSE;
>     int         bAppend = FALSE, bUpdate = FALSE, bOverwrite = FALSE;
>     const char  *pszOutputSRSDef = NULL;
>     const char  *pszSourceSRSDef = NULL;
>     OGRSpatialReference *poOutputSRS = NULL;
>     OGRSpatialReference *poSourceSRS = NULL;
>     const char  *pszNewLayerName = NULL;
>     const char  *pszWHERE = NULL;
>     OGRGeometry *poSpatialFilter = NULL;
>     const char  *pszSelect;
>     char        **papszSelFields = NULL;
>     const char  *pszSQLStatement = NULL;
>     int         eGType = -2;
> 
> /* -------------------------------------------------------------------- */
> /*      Register format(s).                                             */
> /* -------------------------------------------------------------------- */
>     OGRRegisterAll();
> 
> /* -------------------------------------------------------------------- */
> /*      Processing command line arguments.                              */
> /* -------------------------------------------------------------------- */
>     nArgc = OGRGeneralCmdLineProcessor( nArgc, &papszArgv, 0 );
>     
>     if( nArgc != 3 )
>     {
>         Usage();
>         exit( -nArgc );
>     }
> 
>    pszDataSource = papszArgv[1];
>    pszDestDataSource = papszArgv[2];
> 
> /* -------------------------------------------------------------------- */
> /*      Open data source.                                               */
> /* -------------------------------------------------------------------- */
>     OGRDataSource       *poDS;
>         
>     poDS = OGRSFDriverRegistrar::Open( pszDataSource, FALSE );
> 
> /* -------------------------------------------------------------------- */
> /*      Report failure                                                  */
> /* -------------------------------------------------------------------- */
>     if( poDS == NULL )
>     {
>         OGRSFDriverRegistrar    *poR = OGRSFDriverRegistrar::GetRegistrar();
>         
>         printf( "FAILURE:\n"
>                 "Unable to open datasource `%s' with the following drivers.\n",
>                 pszDataSource );
>         exit( 1 );
>     }
> 
> /* -------------------------------------------------------------------- */
> /*      Try opening the output datasource as an existing, writable      */
> /* -------------------------------------------------------------------- */
>     OGRDataSource       *poODS;
> 
>     OGRSFDriverRegistrar *poR = OGRSFDriverRegistrar::GetRegistrar();
>     OGRSFDriver          *poDriver = NULL;
>     int                  iDriver;
> 
>     poDriver = OGRSFDriverRegistrar::GetRegistrar()->GetDriverByName(pszFormat);
>     if( poDriver == NULL )
>     {
>         printf( "Unable to use driver `%s'.\n", pszFormat );
>         exit( 1 );
>     }
> 
> /* -------------------------------------------------------------------- */
> /*      Create the output data source.                                  */
> /* -------------------------------------------------------------------- */
>     poODS = poDriver->CreateDataSource( pszDestDataSource, papszDSCO );
>     if( poODS == NULL )
>     {
>         printf( "%s driver failed to create %s\n", 
>                 pszFormat, pszDestDataSource );
>         exit( 1 );
>     }
> 
> /* -------------------------------------------------------------------- */
> /*      Process each data source layer.                                 */
> /* -------------------------------------------------------------------- */
>     for( int iLayer = 0; 
>          pszSQLStatement == NULL && iLayer < poDS->GetLayerCount(); 
>          iLayer++ )
>     {
>         OGRLayer        *poLayer = poDS->GetLayer(iLayer);
> 
>         if( poLayer == NULL )
>         {
>             printf( "FAILURE: Couldn't fetch advertised layer %d!\n",
>                     iLayer );
>             exit( 1 );
>         }
> 
>         if( CSLCount(papszLayers) == 0
>             || CSLFindString( papszLayers,
>                               poLayer->GetLayerDefn()->GetName() ) != -1 )
>         {
>             if( !TranslateLayer( poDS, poLayer, poODS, papszLCO, 
>                                  pszNewLayerName, bTransform, poOutputSRS,
>                                  poSourceSRS, papszSelFields, bAppend, eGType,
>                                  bOverwrite ) 
>                 && !bSkipFailures )
>             {
>                 CPLError( CE_Failure, CPLE_AppDefined, 
>                           "Terminating translation prematurely after failed\n"
>                           "translation of layer %s\n", 
>                           poLayer->GetLayerDefn()->GetName() );
> 
>                 exit( 1 );
>             }
>         }
>     }
> 
> /* -------------------------------------------------------------------- */
> /*      Close down.                                                     */
> /* -------------------------------------------------------------------- */
>     delete poODS;
>     delete poDS;
> 
>     CSLDestroy(papszSelFields);
>     CSLDestroy( papszArgv );
>     CSLDestroy( papszLayers );
> 
>     OGRCleanupAll();
> 
> #ifdef DBMALLOC
>     malloc_dump(1);
> #endif
>     
>     return 0;
> }
> 
> /************************************************************************/
> /*                               Usage()                                */
> /************************************************************************/
> 
> static void Usage()
> 
> {
>     OGRSFDriverRegistrar        *poR = OGRSFDriverRegistrar::GetRegistrar();
> 
>     printf( "Usage: ogr2ogr <input dst> <output dst>\n"
>             );
>   
>     exit( 1 );
> }
> 
> /************************************************************************/
> /*                           TranslateLayer()                           */
> /************************************************************************/
> 
> static int TranslateLayer( OGRDataSource *poSrcDS, 
>                            OGRLayer * poSrcLayer,
>                            OGRDataSource *poDstDS,
>                            char **papszLCO,
>                            const char *pszNewLayerName,
>                            int bTransform, 
>                            OGRSpatialReference *poOutputSRS,
>                            OGRSpatialReference *poSourceSRS,
>                            char **papszSelFields,
>                            int bAppend, int eGType, int bOverwrite )
> 
> {
>     OGRLayer    *poDstLayer;
>     OGRFeatureDefn *poFDefn;
>     OGRErr      eErr;
>     int         bForceToPolygon = FALSE;
>     int         bForceToMultiPolygon = FALSE;
> 
>     if( pszNewLayerName == NULL )
>         pszNewLayerName = poSrcLayer->GetLayerDefn()->GetName();
> 
> /* -------------------------------------------------------------------- */
> /*      Get other info.                                                 */
> /* -------------------------------------------------------------------- */
>     poFDefn = poSrcLayer->GetLayerDefn();
>     
>     if( poOutputSRS == NULL )
>         poOutputSRS = poSrcLayer->GetSpatialRef();
> 
> /* -------------------------------------------------------------------- */
> /*      Find the layer.                                                 */
> /* -------------------------------------------------------------------- */
>     int iLayer = -1;
>     poDstLayer = NULL;
> 
>     for( iLayer = 0; iLayer < poDstDS->GetLayerCount(); iLayer++ )
>     {
>         OGRLayer        *poLayer = poDstDS->GetLayer(iLayer);
> 
>         if( poLayer != NULL 
>             && EQUAL(poLayer->GetLayerDefn()->GetName(),pszNewLayerName) )
>         {
>             poDstLayer = poLayer;
>             break;
>         }
>     }
> 
> /* -------------------------------------------------------------------- */
> /*      If the layer does not exist, then create it.                    */
> /* -------------------------------------------------------------------- */
>     if( poDstLayer == NULL )
>     {
>         if( eGType == -2 )
>             eGType = poFDefn->GetGeomType();
> 
>         CPLAssert( poDstDS->TestCapability( ODsCCreateLayer ) );
>         CPLErrorReset();
> 
>         poDstLayer = poDstDS->CreateLayer( pszNewLayerName, poOutputSRS,
>                                            (OGRwkbGeometryType) eGType, 
>                                            papszLCO );
> 
>         if( poDstLayer == NULL )
>             return FALSE;
> 
>         bAppend = FALSE;
>     }
> 
> /* -------------------------------------------------------------------- */
> /*      Add fields.  Default to copy all field.                         */
> /*      If only a subset of all fields requested, then output only      */
> /*      the selected fields, and in the order that they were            */
> /*      selected.                                                       */
> /* -------------------------------------------------------------------- */
>     int         iField;
> 
>     for( iField = 0; iField < poFDefn->GetFieldCount(); iField++ )
>     {
>         poDstLayer->CreateField( poFDefn->GetFieldDefn(iField) );
>     }
> 
> /* -------------------------------------------------------------------- */
> /*      Transfer features.                                              */
> /* -------------------------------------------------------------------- */
>     OGRFeature  *poFeature;
>     
>     poSrcLayer->ResetReading();
> 
>     while( TRUE )
>     {
>         OGRFeature      *poDstFeature = NULL;
> 
>         poFeature = poSrcLayer->GetNextFeature();
>         
>         if( poFeature == NULL )
>             break;
> 
>         CPLErrorReset();
>         poDstFeature = OGRFeature::CreateFeature( poDstLayer->GetLayerDefn() );
> 
>         if( poDstFeature->SetFrom( poFeature, TRUE ) != OGRERR_NONE )
>         {
>             CPLError( CE_Failure, CPLE_AppDefined,
>                       "Unable to translate feature %d from layer %s.\n",
>                       poFeature->GetFID(), poFDefn->GetName() );
>             
>             OGRFeature::DestroyFeature( poFeature );
>             OGRFeature::DestroyFeature( poDstFeature );
>             return FALSE;
>         }
> 
>         if( bPreserveFID )
>             poDstFeature->SetFID( poFeature->GetFID() );
>         
>         OGRGeometry* poGeom = poDstFeature->GetGeometryRef();
> 
>         // We will shift coordinates by +360 only if object centroid is in the
>         // [-180, 0] range, otherwise we leave the coordinates untouched
>         GBool bNeedToShift = FALSE;
>         if (poGeom)
>         {
>             OGREnvelope oEnv;
>             poGeom->getEnvelope(&oEnv);
>             bNeedToShift = ((oEnv.MinX+oEnv.MinX)/2<0.0) ? TRUE : FALSE;
>         }
> 
>         if( bNeedToShift )
>         {
>             OGRwkbGeometryType wkbType = poGeom->getGeometryType();
>             if ( wkbPoint == wkbType )
>             {
>                 OGRPoint* poPoint = static_cast<OGRPoint*>(poGeom);
>                 double x = poPoint->getX();
>                 if (bNeedToShift)
>                 poPoint->setX(x + 360);
>             }
>         }
> 
>         OGRFeature::DestroyFeature( poFeature );
> 
>         CPLErrorReset();
>         if( poDstLayer->CreateFeature( poDstFeature ) != OGRERR_NONE 
>             && !bSkipFailures )
>         {
>             OGRFeature::DestroyFeature( poDstFeature );
>             return FALSE;
>         }
> 
>         OGRFeature::DestroyFeature( poDstFeature );
>     }
> 
>     return TRUE;
> }
> 


-- 
Daniel Morissette
http://www.mapgears.com/

From craig.miller at spatialminds.com  Wed Jun 14 17:33:34 2006
From: craig.miller at spatialminds.com (Craig Miller)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] Setting PROJ4 path programatically
Message-ID: <006e01c68ffa$30ee5700$7500a8c0@vaio>

In digging through the archives, I found a post that briefly describes how
to set the path where PROJ4 looks for its data files (E.g. proj4/nad).  The
message mentions two functions:

	pj_set_finder(...);
	CPLSetConfigOption("GDAL_DATA", ...);

If I'm only using OGRSpatialReference directly and not calling into proj4
directly is the CPLSetConfigOption sufficient or do I need to call
pj_set_finder(...) as well.

Will these calls affect any other applications that are running on the same
machine that are also using PROJ4?


Thanks,
Craig





From ron_despain at hotmail.com  Wed Jun 14 17:43:20 2006
From: ron_despain at hotmail.com (Ron DeSpain)
Date: Wed Nov 21 11:50:12 2007
Subject: [Gdal-dev] How can I reply to an item in a thread?
Message-ID: <BAY117-F7C59453B64DC8ED607097878D0@phx.gbl>





From bclay at ball.com  Wed Jun 14 17:49:59 2006
From: bclay at ball.com (Clay, Bruce)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] How to split multi-layer geotiff images
Message-ID: <C482FF98AE985A47B8C982FD429C9E34FEF851@daytonmsg2k3.AERO.BALL.COM>

 I have had problems getting this message posted.  - the send keeps
timing out.  I apologize if multiples finally get sent out

 

 

Can GDAL be used to open multi-layer Geotiff raster files?

 

Not multi-band but more than one image in the same file. I was given
some Geotiff images that Microsoft Office Imaging tool shows 2 distinct
images in a single tiff file.

 

IDL was used to create the file using an APPEND function.

 

ArcMap does not seem to be able to find the second images so I would
like to extract the image using GDAL but I don't see any info in the
documentation.

 

Tiffsplit in the FW tool set will split the file into 2 images but it
kicks up some error messages

 

C:\GisTeam\Data\APC_tree\SL\data\UnitedStates\31251>H:\SupportLibraries\
FWTools1.0.0b2\bin\tiffsplit 20060122_001_1200z_n34.00_w84.00_SFP.tif

TIFFReadDirectory: Warning, 20060122_001_1200z_n34.00_w84.00_SFP.tif:
unknown field with tag 33550 (0x830e) encountered.

TIFFReadDirectory: Warning, 20060122_001_1200z_n34.00_w84.00_SFP.tif:
unknown field with tag 33922 (0x8482) encountered.

TIFFReadDirectory: Warning, 20060122_001_1200z_n34.00_w84.00_SFP.tif:
unknown field with tag 34735 (0x87af) encountered.

 

The resulting images have no spatial reference information in them.

 

Bruce

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060614/0c1199c8/attachment.html
From mateusz at loskot.net  Wed Jun 14 18:08:11 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] How can I reply to an item in a thread?
In-Reply-To: <BAY117-F7C59453B64DC8ED607097878D0@phx.gbl>
References: <BAY117-F7C59453B64DC8ED607097878D0@phx.gbl>
Message-ID: <449088CB.9090106@loskot.net>

Click "Reply" button in your e-mail client.
Also, please don't ask full questions in the subject only.
The body of message is much better.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From mateusz at loskot.net  Wed Jun 14 18:11:12 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Setting PROJ4 path programatically
In-Reply-To: <006e01c68ffa$30ee5700$7500a8c0@vaio>
References: <006e01c68ffa$30ee5700$7500a8c0@vaio>
Message-ID: <44908980.10305@loskot.net>

Craig Miller wrote:
> In digging through the archives, I found a post that briefly
> describes how to set the path where PROJ4 looks for its data files
> (E.g. proj4/nad).  The message mentions two functions:
> 
> pj_set_finder(...);
> CPLSetConfigOption("GDAL_DATA", ...);
> 
> If I'm only using OGRSpatialReference directly and not calling into
> proj4 directly is the CPLSetConfigOption sufficient or do I need to
> call pj_set_finder(...) as well.
> 
> Will these calls affect any other applications that are running on
> the same machine that are also using PROJ4?


I can answer about CPLSetConfigOption().
You can safely use this call and it won't affect any other
applications/external settings.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From dpinte at itae.be  Thu Jun 15 03:04:34 2006
From: dpinte at itae.be (Didrik Pinte)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Compile GDAL with VS2005 (BuildKit Source Code)
In-Reply-To: <2534c4120606141336g25f4f369ve4f86422d44a472a@mail.gmail.com>
References: <2534c4120606141304n190c729h3bb635ec9b24c59@mail.gmail.com>
	<6.2.3.4.2.20060614150833.02adc5d0@hobu.mail.iastate.edu>
	<2534c4120606141336g25f4f369ve4f86422d44a472a@mail.gmail.com>
Message-ID: <1150355074.21398.26.camel@geru-itae>

Le mercredi 14 juin 2006 ? 22:36 +0200, Zhonghai Wang a ?crit :
> Hi Howard,
> 
> thanks you so much for the important HINTS.
> 
> so you mean that I must compile all the needed libraries in the
> BuildKit package myself with VS2005? Is this compilation guide still
> valid for the whole compilation?
> http://www.nabble.com/Windows-build-kit-for-MSVC-7.1-t1143108.html#a2997024>http://www.nabble.com/Windows-build-kit-for-MSVC-7.1-t1143108.html#a2997024.
> 
> so the steps may be:
> 1. compile the required libraries for GDAL (according to the component
> that I need)
> 2. compile GDAL
> 3. compile the required libraries for MapServer
> 4. compile MapServer
> 
> and here is the last question^_^:
> what does the command "nmake /f makefile.vc install" mean? for this
> command which parameters in the nmake.opt file should be set
> correctly?
> 
> I really appreciate your help.
> 
> best regards
> 
> zhonghai

Another solution can be the use of the MSVC Toolkit, freely available on
the MS website. With this toolkit you have everything needed for
MSVC2003 compliant compilation. I've build geos, gdal, proj from scratch
using it. I can provide more details if needed.

Didrik
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Ceci est une partie de message
	=?ISO-8859-1?Q?num=E9riquement?= =?ISO-8859-1?Q?_sign=E9e?=
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060615/fd041b8c/attachment.bin
From zhonghaiw at gmail.com  Thu Jun 15 03:36:19 2006
From: zhonghaiw at gmail.com (Zhonghai Wang)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Compile GDAL with VS2005 (BuildKit Source Code)
In-Reply-To: <1150355074.21398.26.camel@geru-itae>
References: <2534c4120606141304n190c729h3bb635ec9b24c59@mail.gmail.com>
	<6.2.3.4.2.20060614150833.02adc5d0@hobu.mail.iastate.edu>
	<2534c4120606141336g25f4f369ve4f86422d44a472a@mail.gmail.com>
	<1150355074.21398.26.camel@geru-itae>
Message-ID: <2534c4120606150036q6adcbf39yaaa8bdedc1fd74@mail.gmail.com>

Hi Dirik,

you mean that I do not need to compile all the needed libraries from the
very begining?

the problem is now I want to compile GDAL and MapServer with VS2005, but the
needed Libraries by GDAL and MapServer were pre-compiled with VS2003, as
Howard said.

I'd like more details about the compilation.

thank you very much.

zhonghai


On 6/15/06, Didrik Pinte <dpinte@itae.be> wrote:
>
> Le mercredi 14 juin 2006 ? 22:36 +0200, Zhonghai Wang a ?crit :
> > Hi Howard,
> >
> > thanks you so much for the important HINTS.
> >
> > so you mean that I must compile all the needed libraries in the
> > BuildKit package myself with VS2005? Is this compilation guide still
> > valid for the whole compilation?
> >
> http://www.nabble.com/Windows-build-kit-for-MSVC-7.1-t1143108.html#a2997024
> >
> http://www.nabble.com/Windows-build-kit-for-MSVC-7.1-t1143108.html#a2997024
> .
> >
> > so the steps may be:
> > 1. compile the required libraries for GDAL (according to the component
> > that I need)
> > 2. compile GDAL
> > 3. compile the required libraries for MapServer
> > 4. compile MapServer
> >
> > and here is the last question^_^:
> > what does the command "nmake /f makefile.vc install" mean? for this
> > command which parameters in the nmake.opt file should be set
> > correctly?
> >
> > I really appreciate your help.
> >
> > best regards
> >
> > zhonghai
>
> Another solution can be the use of the MSVC Toolkit, freely available on
> the MS website. With this toolkit you have everything needed for
> MSVC2003 compliant compilation. I've build geos, gdal, proj from scratch
> using it. I can provide more details if needed.
>
> Didrik
>
>
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.4.3 (GNU/Linux)
>
> iD8DBQBEkQaC9Rlh4Zs4yBMRApdjAJ9FP6bDbHIFsrgsvaVz6TzfLtyxiQCfXNMf
> NVgWUPh+1wBuJ1byrcVzSxM=
> =thGh
> -----END PGP SIGNATURE-----
>
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060615/23018803/attachment.html
From dpinte at itae.be  Thu Jun 15 03:57:57 2006
From: dpinte at itae.be (Didrik Pinte)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Compile GDAL with VS2005 (BuildKit Source Code)
In-Reply-To: <2534c4120606150036q6adcbf39yaaa8bdedc1fd74@mail.gmail.com>
References: <2534c4120606141304n190c729h3bb635ec9b24c59@mail.gmail.com>
	<6.2.3.4.2.20060614150833.02adc5d0@hobu.mail.iastate.edu>
	<2534c4120606141336g25f4f369ve4f86422d44a472a@mail.gmail.com>
	<1150355074.21398.26.camel@geru-itae>
	<2534c4120606150036q6adcbf39yaaa8bdedc1fd74@mail.gmail.com>
Message-ID: <1150358277.21398.39.camel@geru-itae>

Le jeudi 15 juin 2006 ? 09:36 +0200, Zhonghai Wang a ?crit :
> Hi Dirik,
>  
> you mean that I do not need to compile all the needed libraries from
> the very begining?
>  
> the problem is now I want to compile GDAL and MapServer with VS2005,
> but the needed Libraries by GDAL and MapServer were pre-compiled with
> VS2003, as Howard said.
>  
> I'd like more details about the compilation.
>  
> thank you very much.
>  
> zhonghai

What i'm saying is that you can be able to compile gdal and mapserver
with using the libraries provided by the buildkit with the MSVC toolkit.

So it won't be a VS2005 compilation but a VS2003 with the toolkit.

Didrik



From digar at gmx.net  Thu Jun 15 02:17:53 2006
From: digar at gmx.net (Jan B.)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Problem with GDALWARP - very fast to solve
Message-ID: <001801c69043$6f7b7bd0$8788e289@digar>

I have again a small problem with the gdalwarp command line tool.

I try to convert the file, which you can find under :

www.esw.rwth-aachen.de/n56e010.bil

with the following command into the UTM System:

gdalwarp -t_srs "+proj=utm +zone=11 +datum=WGS84" n56e010.bil test.tif

But it always says that too many points failed to transform. What would be 
the correct command ???

Greetings (and hopefully I have specified the problem this time enought)

Jan Beiten 



From zhonghaiw at gmail.com  Thu Jun 15 08:49:15 2006
From: zhonghaiw at gmail.com (Zhonghai Wang)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Compile GDAL with VS2005 (BuildKit Source Code)
In-Reply-To: <1150358277.21398.39.camel@geru-itae>
References: <2534c4120606141304n190c729h3bb635ec9b24c59@mail.gmail.com>
	<6.2.3.4.2.20060614150833.02adc5d0@hobu.mail.iastate.edu>
	<2534c4120606141336g25f4f369ve4f86422d44a472a@mail.gmail.com>
	<1150355074.21398.26.camel@geru-itae>
	<2534c4120606150036q6adcbf39yaaa8bdedc1fd74@mail.gmail.com>
	<1150358277.21398.39.camel@geru-itae>
Message-ID: <2534c4120606150549l3a6473b3ra6044e378cf10989@mail.gmail.com>

Hi guys,

compile GDAL is not a easy task, and till now I finally finished it, but
without the following components:
ECW, DWG/DXF, XERCES, MRSID, GEOS, POSTGIS, and MYSQL.

acutally I need the XERCES and GEOS components, but I can not get them work,
but I will try it again withe this two component, and hopefully can get some
help from you guys.

so I step now to the libraries needed by MapServer.

zhonghai

with all your help I've finished compiling the needed libraries by GDAL, and

On 6/15/06, Didrik Pinte <dpinte@itae.be> wrote:

> Le jeudi 15 juin 2006 ? 09:36 +0200, Zhonghai Wang a ?crit :
> > Hi Dirik,
> >
> > you mean that I do not need to compile all the needed libraries from
> > the very begining?
> >
> > the problem is now I want to compile GDAL and MapServer with VS2005,
> > but the needed Libraries by GDAL and MapServer were pre-compiled with
> > VS2003, as Howard said.
> >
> > I'd like more details about the compilation.
> >
> > thank you very much.
> >
> > zhonghai
>
> What i'm saying is that you can be able to compile gdal and mapserver
> with using the libraries provided by the buildkit with the MSVC toolkit.
>
> So it won't be a VS2005 compilation but a VS2003 with the toolkit.
>
> Didrik
>
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060615/632e3ef5/attachment.html
From archer at eskimo.com  Thu Jun 15 09:25:28 2006
From: archer at eskimo.com (Curt, WE7U)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Tool to convert shapefile from [-180, 180] to [0,
	360] range
In-Reply-To: <448F3658.9000101@mapgears.com>
References: <448F3658.9000101@mapgears.com>
Message-ID: <Pine.SUN.4.58.0606150613040.29568@eskimo.com>

On Tue, 13 Jun 2006, Daniel Morissette wrote:

> Is anyone aware of a tool or script that would convert the longitude of
> coordinates in a shapefile from [-180,180] to [0,360]? The tool could be
> based on OGR or any other open source package.
>
> Just checking before writing something from scratch and reinventing the
> wheel.

Hey, that brings to mind something a few things I've been wanting to ask:

*) What should an application do with a shapefile that contains
polygons with longitudes in the -189.9 to -180.0 range?  Is there an
easy way to split up the shapes so they don't fall off the edge of
the earth?

We use some NOAA Shapefiles for weather alerts that cross that
boundary and our application doesn't like them.  I can tweak the
application, so just wondering whether to do that or split the
polygons multiples across that line.  To tweak the app would mean to
draw the polygon in two pieces anyway, one on the extreme right of
the view and one on the extreme left.  A bit of a pain
programming-wise.

I contacted NOAA about the files.  They thing it's fine to have
polygons cross that boundary.  Maybe it's just me that has a problem
with it?  I suspect they use ESRI software to generate them.

*) I tried some Mars Shapefiles that range from 0-360 degrees.  Our
application doesn't like that either.  Should an application check
the bounding polygon for the Shapefile and then apply a -180 degree
shift to all the longitudes if it detects this?  What to do with
polygons that cross it's 0.0 degree boundary (basically the same
question as the first above)?

--
Curt, WE7U.   APRS Client Comparisons: http://www.eskimo.com/~archer
"Lotto:    A tax on people who are bad at math." -- unknown
"Windows:  Microsoft's tax on computer illiterates." -- WE7U
"The world DOES revolve around me:  I picked the coordinate system!"

From Charles.Wivell at dnr.state.mn.us  Thu Jun 15 10:02:06 2006
From: Charles.Wivell at dnr.state.mn.us (Charles Wivell)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Tool to convert shapefile from [-180, 180] to
	[0, 360] range
Message-ID: <s4912235.005@co5.dnr.state.mn.us>

The shift you should use if you want the values between -180 and 180 for values less than -180 would be:

if (value < -180.0) value = value + 360.0;

If you want to convert values between 0 to 360 to values between -180 to 180 then:

if (value > 180.0) value = value - 360.0;

if you are programming this, then everything should be in radians...


Chuck Wivell

MN DNR Grand Rapids MN

>>> "Curt, WE7U" <archer@eskimo.com> 6/15/2006 8:25 AM >>>
On Tue, 13 Jun 2006, Daniel Morissette wrote:

> Is anyone aware of a tool or script that would convert the longitude of
> coordinates in a shapefile from [-180,180] to [0,360]? The tool could be
> based on OGR or any other open source package.
>
> Just checking before writing something from scratch and reinventing the
> wheel.

Hey, that brings to mind something a few things I've been wanting to ask:

*) What should an application do with a shapefile that contains
polygons with longitudes in the -189.9 to -180.0 range?  Is there an
easy way to split up the shapes so they don't fall off the edge of
the earth?

We use some NOAA Shapefiles for weather alerts that cross that
boundary and our application doesn't like them.  I can tweak the
application, so just wondering whether to do that or split the
polygons multiples across that line.  To tweak the app would mean to
draw the polygon in two pieces anyway, one on the extreme right of
the view and one on the extreme left.  A bit of a pain
programming-wise.

I contacted NOAA about the files.  They thing it's fine to have
polygons cross that boundary.  Maybe it's just me that has a problem
with it?  I suspect they use ESRI software to generate them.

*) I tried some Mars Shapefiles that range from 0-360 degrees.  Our
application doesn't like that either.  Should an application check
the bounding polygon for the Shapefile and then apply a -180 degree
shift to all the longitudes if it detects this?  What to do with
polygons that cross it's 0.0 degree boundary (basically the same
question as the first above)?

--
Curt, WE7U.   APRS Client Comparisons: http://www.eskimo.com/~archer 
"Lotto:    A tax on people who are bad at math." -- unknown
"Windows:  Microsoft's tax on computer illiterates." -- WE7U
"The world DOES revolve around me:  I picked the coordinate system!"
_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org 
http://lists.maptools.org/mailman/listinfo/gdal-dev



From Charles.Wivell at dnr.state.mn.us  Thu Jun 15 10:05:20 2006
From: Charles.Wivell at dnr.state.mn.us (Charles Wivell)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Tool to convert shapefile from [-180, 180] to
	[0, 360] range
Message-ID: <s49122f4.030@co5.dnr.state.mn.us>

One more conversion:

if you want to convert values between  -180 to 180 to values between 0 and 360 then:


if (value < 0.0) value = value + 360.0


Chuck Wivell



>>> "Curt, WE7U" <archer@eskimo.com> 6/15/2006 8:25 AM >>>
On Tue, 13 Jun 2006, Daniel Morissette wrote:

> Is anyone aware of a tool or script that would convert the longitude of
> coordinates in a shapefile from [-180,180] to [0,360]? The tool could be
> based on OGR or any other open source package.
>
> Just checking before writing something from scratch and reinventing the
> wheel.

Hey, that brings to mind something a few things I've been wanting to ask:

*) What should an application do with a shapefile that contains
polygons with longitudes in the -189.9 to -180.0 range?  Is there an
easy way to split up the shapes so they don't fall off the edge of
the earth?

We use some NOAA Shapefiles for weather alerts that cross that
boundary and our application doesn't like them.  I can tweak the
application, so just wondering whether to do that or split the
polygons multiples across that line.  To tweak the app would mean to
draw the polygon in two pieces anyway, one on the extreme right of
the view and one on the extreme left.  A bit of a pain
programming-wise.

I contacted NOAA about the files.  They thing it's fine to have
polygons cross that boundary.  Maybe it's just me that has a problem
with it?  I suspect they use ESRI software to generate them.

*) I tried some Mars Shapefiles that range from 0-360 degrees.  Our
application doesn't like that either.  Should an application check
the bounding polygon for the Shapefile and then apply a -180 degree
shift to all the longitudes if it detects this?  What to do with
polygons that cross it's 0.0 degree boundary (basically the same
question as the first above)?

--
Curt, WE7U.   APRS Client Comparisons: http://www.eskimo.com/~archer 
"Lotto:    A tax on people who are bad at math." -- unknown
"Windows:  Microsoft's tax on computer illiterates." -- WE7U
"The world DOES revolve around me:  I picked the coordinate system!"
_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org 
http://lists.maptools.org/mailman/listinfo/gdal-dev



From mateusz at loskot.net  Thu Jun 15 11:00:33 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] How can I reply to an item in a thread?
In-Reply-To: <33E9C96E5F4538409B0B533B74953E360170F18C@mlbe2k4.cs.myharris.net>
References: <33E9C96E5F4538409B0B533B74953E360170F18C@mlbe2k4.cs.myharris.net>
Message-ID: <44917611.5010404@loskot.net>

DeSpain, Ronald wrote:
> When I'm reviewing my thread I'm in Internet Explorer not an email 
> client, so there is no "Reply" button, so I can't figure out how to 
> reply to a response...in this case I clicked the responders email 
> address at the top of the message, but It doesn't look like it's
> going to him by the address on this message, but back to the list.
> I'm cc ing mateusz at loskot.net.  Mateusz...please forgive the
> inconveiniece, as I'm trying to figure out the procedure on this
> list.  Somehow It's confusing to me.

Ronald,
You can't reply to gdal-dev list from WWW browser.
You have to subscribe the gdal-dev list with yor e-mail address,
then you will be able to receive posts from other users and reply to
them from your e-mail client.

You can subscribe gdal-dev here:
http://lists.maptools.org/mailman/listinfo/gdal-dev/

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From archer at eskimo.com  Thu Jun 15 11:02:43 2006
From: archer at eskimo.com (Curt, WE7U)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Tool to convert shapefile from [-180, 180] to [0,
	360] range
In-Reply-To: <s4912235.003@co5.dnr.state.mn.us>
References: <s4912235.003@co5.dnr.state.mn.us>
Message-ID: <Pine.SUN.4.58.0606150756560.29568@eskimo.com>

On Thu, 15 Jun 2006, Charles Wivell wrote:

> The shift you should use if you want the values between -180 and
> 180 for values less than -180 would be:

I'm not interested in the conversions in this case as they're
trivial.

Are apps normally designed to handle 0-360 or are files expected to
conform to -180 to +180?  I have two types of files now that don't
correspond to -180 to +180.  I understand that for other planets it
is common to do the 0-360 thing.

Also these questions:

> *) What should an application do with a shapefile that contains
> polygons with longitudes in the -189.9 to -180.0 range?  Is there an
> easy way to split up the shapes so they don't fall off the edge of
> the earth?

Note:  Our app uses unprojected lat/long in WGS84 only for display.
-180 is the left edge, +180 is the right edge (if zoomed out far
enough to see them both).  Drawing polygons or lines that cross the
180 boundary is a big hassle, we'd have to split them before
drawing.

--
Curt, WE7U.   APRS Client Comparisons: http://www.eskimo.com/~archer
"Lotto:    A tax on people who are bad at math." -- unknown
"Windows:  Microsoft's tax on computer illiterates." -- WE7U
"The world DOES revolve around me:  I picked the coordinate system!"

From Charles.Wivell at dnr.state.mn.us  Thu Jun 15 12:17:17 2006
From: Charles.Wivell at dnr.state.mn.us (Charles Wivell)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Tool to convert shapefile from [-180, 180] to
	[0, 360] range
Message-ID: <s49141cc.064@co5.dnr.state.mn.us>

Oh the joys of displaying a 3D object onto a 2D display....


A well written app should be able to handle any longitude you supply (-240 or 495 degrees, should be just fine, but it might ask the user if they are sure...). A well written app should do all the calculations in 3D math for such large area datasets. It only becomes a problem when you are trying to display the 3D object. The app should allow the user to define the origin of the map. If you have lines that cross the -180/180 boundary, you should be able to choose the origin of the map so that the lines don't break. Such as, choose the left edge as 0 degrees longitude, center is 180/-180 and right edge is 360/0. This origin will break lines that cross the 0/360 boundary. If you have polygons all over the globe/planet, some will break, but the display software should handle the splitting for you...

In the apps I write I convert every longitude to between 0 and 360 (really between 0 and 2 Pi).

A programmer should have a set of units that they ALWAYS work/program in. I use the metric units and radians.... 

This would have saved the Mars spacecraft that crashed into Mars, if both contractors would have been working in the same units. Or if someone would have just checked (if they had an idea of what the ISP should be for a given fuel in the units they required as input) the outputs from one contractor that were inputs to the other....

I did a program for the Navy and they wanted the output in kilo-feet for altitude and nautical miles for range.... So you convert on input and convert on output.

Ok, I'll get off my soap box now....


Chuck Wivell



>>> "Curt, WE7U" <archer@eskimo.com> 6/15/2006 10:02 AM >>>
On Thu, 15 Jun 2006, Charles Wivell wrote:

> The shift you should use if you want the values between -180 and
> 180 for values less than -180 would be:

I'm not interested in the conversions in this case as they're
trivial.

Are apps normally designed to handle 0-360 or are files expected to
conform to -180 to +180?  I have two types of files now that don't
correspond to -180 to +180.  I understand that for other planets it
is common to do the 0-360 thing.

Also these questions:

> *) What should an application do with a shapefile that contains
> polygons with longitudes in the -189.9 to -180.0 range?  Is there an
> easy way to split up the shapes so they don't fall off the edge of
> the earth?

Note:  Our app uses unprojected lat/long in WGS84 only for display.
-180 is the left edge, +180 is the right edge (if zoomed out far
enough to see them both).  Drawing polygons or lines that cross the
180 boundary is a big hassle, we'd have to split them before
drawing.

--
Curt, WE7U.   APRS Client Comparisons: http://www.eskimo.com/~archer 
"Lotto:    A tax on people who are bad at math." -- unknown
"Windows:  Microsoft's tax on computer illiterates." -- WE7U
"The world DOES revolve around me:  I picked the coordinate system!"
_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org 
http://lists.maptools.org/mailman/listinfo/gdal-dev



From digar at gmx.net  Wed Jun 14 10:08:05 2006
From: digar at gmx.net (Jan B.)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Problem with GDALWARP - very fast to solve
Message-ID: <000e01c68fbb$f4fe2330$8788e289@digar>

I have again a small problem with the gdalwarp command line tool.

I try to convert the file, which you can find under :

www.esw.rwth-aachen.de/n56e010.bil

with the following command into the UTM System:

gdalwarp -t_srs "+proj=utm +zone=11 +datum=WGS84" n56e010.bil test.tif

But it always says that too many points failed to transform. What would be 
the correct command ???

Greetings (and hopefully I have specified the problem this time enought)

Jan Beiten 



From digar at gmx.net  Thu Jun 15 02:17:53 2006
From: digar at gmx.net (Jan B.)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Problem with GDALWARP - very fast to solve
Message-ID: <001801c69043$6f7b7bd0$8788e289@digar>

I have again a small problem with the gdalwarp command line tool.

I try to convert the file, which you can find under :

www.esw.rwth-aachen.de/n56e010.bil

with the following command into the UTM System:

gdalwarp -t_srs "+proj=utm +zone=11 +datum=WGS84" n56e010.bil test.tif

But it always says that too many points failed to transform. What would be 
the correct command ???

Greetings (and hopefully I have specified the problem this time enought)

Jan Beiten 



From ILucena at clarku.edu  Fri Jun 16 11:08:54 2006
From: ILucena at clarku.edu (Ivan Lucena)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] IPCC raster format
Message-ID: <6FD7C9DB26540B42A1207C69BF92D455017A737D@Iris.ad.clarku.edu>

Hi there,

 

I would rather been watching the World Cup, but I have to get this data
in a usable format and there is no better place to get it than from
GDAL's experts.

 

The "Intergovernmental Panel on Climate Change" (IPCC) offers data on
the web in a format described by this Fortran source code: (The file
extension is just a generic ".dat")

 

http://ipcc-ddc.cru.uea.ac.uk/obs/observed_fileformat.html

 

> more cpre0130.dat

    grd_sz      xmin      ymin      xmax      ymax    n_cols    n_rows
n_months

      0.50      0.25    -89.75    359.75     89.75       720       360
12

...

-9999-9999-9999-9999-9999-9999-9999-9999-9999   52   88  103   91   65
45   27   32 ...

-9999-9999-9999-9999-9999   11   20   22   25   27   26   27   28   31
29   28   30 ...

...

 

It's not hard to analyze the pattern on the data or the code, so I
figured that:

 

- It's an ASCII format;

- There are two lines of reader (easy to read)

- Each cell is 5 characters wide;

- The no-data is "-9999";

- There is no separator between cells (what makes my task difficult);

- It's a multi-band raster dataset with 12 bands; (720x360x12 cells)

- I am not sure if positive values can go beyond 9999 (that reminds me
COBOL)

 

I am heading in the direction of writing a Python+GDAL script to do the
task, but I am stuck in how to separate the cells. The Fortran code is
doing it in just one command as you can see in the code. I am thing that
maybe by using the NumPY stuff embedded in GDAL I could do the same.

 

Any Idea? Any experience with this data format?

 

Thanks in advance,

 

Ivan

 

-------------------------------------------------------

This is a Python command line interaction with the data:

 

>>> import gdal

>>> f = open('C:/Data/IPCC/cpre0130.dat', 'r');

>>> f.readline()

'    grd_sz      xmin      ymin      xmax      ymax    n_cols    n_rows
n_months\n'

>>> f.readline()

'      0.50      0.25    -89.75    359.75     89.75       720       360
12\n'

>>> f.readline()

'-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-
9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-99
99-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999
-9999-9999-9999-9999-9999-9

 

-------------------------------------------------------

Fortran source code:

 
program rd_ascii       
!
! f90 program to read in an integer ascii grid with
! variable dimensions into a global grid (720x360x12)
!
  parameter :: n_cols=720
  parameter :: n_rows=360
  integer, dimension (n_cols,n_rows,12) :: grid
  character(len=72) :: infl
  character(len=20) :: fmt
!
  call getarg(1,infl)
!       
  if(infl.eq.' ')then
    write(*,*) 'Enter ascii grid file name'
    read(*,'(a72)')infl
  end if
!       
  open(1,file=infl,status='old')
  read(1,*)
  read(1,*)xmin,ymin,xmax,ymax,ncols,nrows,nmonths,missing
  grid=missing
  fmt='( i5)'
  write(fmt(2:4),'(i3)')n_cols
  do im=1,nmonths
    do lat=1,n_rows
      read(1,fmt)(grid(lon,lat,im),lon=1,n_cols)
    enddo
  enddo
!       
end program rd_ascii

 

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060616/f1956b56/attachment.html
From nbest at speakeasy.net  Fri Jun 16 11:22:15 2006
From: nbest at speakeasy.net (Neil Best)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] fun with projections -- GCS to AEA
Message-ID: <1150471335.28798.55.camel@localhost.localdomain>

Hello all and happy Friday.  I have been working on something that isn't
coming out quite right so I though I would write it up for my own sanity
and share it in case someone was inclined to look it over.

I have a .shp of US counties in an unknown GCS.  QGIS assumes a WGS84,
good enough for me -- EPSG:4326 it is.  I need 50-mile buffers for each
county and my research tells me that whether I use GRASS or PostGIS I
need by base data to be projected into some cartesian units because the
buffer functions use map units.  Looks like a job for ogr2ogr.

But what projection?  Further digging indicated that an Albers
Equal-Area Conic is a good choice when working with the full extent of
the states.  I found some clues at (1), (2), and (3).  Neither OGR nor
QGIS seem to have any EPSG:9822 so I take this to be a general
transformation without the specific parameters.

So I wrote:

> g.proj -w proj4='+proj=aea +units=mi +datum=WGS84 +ellps=WGS84 \
    +lat_1=29.5 +lat_2=45.5 +lon_0=-96' > aeaUS.wkt

# aeaUS.wkt attached

> ogr2ogr -s_srs EPSG:4326 -t_srs aeaUS.wkt temp usagen counties
> ogrinfo -so temp counties > counties_aea.ogrinfo

# counties_aea.ogrinfo attached

What concerns me are the extents reported by ogrinfo:
Extent: (-6293474.061879, 2670863.569639) - (2256278.441196,
8557825.854853)

8.5 million miles wide?  I don't think so.

When I set a custom projection in QGIS using the same proj4 string and
add the original unprojected layer I see this metadata for the layer:

General:
Geometry type of the features in this layer : Polygon
The number of features in this layer : 3140
Extents:
In layer spatial reference system units : xMin,yMin -178.215,18.9248 :
xMax,yMax -66.9698,71.4066
In project spatial reference system units : xMin,yMin -4903.87,1195.6 :
xMax,yMax 1937.56,5684.6
Layer Spatial Reference System:
+proj=longlat +ellps=WGS84 +no_defs 
Project (Output) Spatial Reference System:
+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=0 +lon_0=-96 +x_0=0 +y_0=0
+ellps=WGS84 +datum=WGS84 +units=mi


~ 6800 miles wide -- that's more like it.  Cook County, IL (Chicago) is
about 50 miles north to south.  It's about 160 miles from Chicago to
Indianapolis as the crow flies.  I can live with that, but I need a
projected layer on disk, not just QGIS doing it on the fly.

When I open the ogr-generated .shp in a new QGIS project I get 

General:
Geometry type of the features in this layer : Polygon
The number of features in this layer : 3140
Extents:
In layer spatial reference system units : xMin,yMin -6.29347e
+06,2.67086e+06 : xMax,yMax 2.25628e+06,8.55783e+06
In project spatial reference system units : xMin,yMin -6.29347e
+06,2.67086e+06 : xMax,yMax 2.25628e+06,8.55783e+06
Layer Spatial Reference System:
+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=0 +lon_0=-96 +x_0=0 +y_0=0
+ellps=WGS84 +datum=WGS84 +units=mi
Project (Output) Spatial Reference System:
+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=0 +lon_0=-96 +x_0=0 +y_0=0
+ellps=WGS84 +datum=WGS84 +units=mi

Cook County is now over 77,000 miles long!


Q: Is this a good choice of projections?

Q: What is ogr trying to tell me?  Am I using it properly, particularly
the +units flag?  Do I need some kind of explicit scale factor?

Q: Is there an easier way to manipulate / generate .prj's and .wkt's
aside from g.proj (so I don't necessarily have to start GRASS)?

Q: What's the preferred method of looking up EPSGs?  I rely on QGIS.

Q: Isn't this a generally useful and popular projection?  "Default
values for ?1 and ?2 are respectively 29.5 N and 45.5 N (values normally
used for maps of the conterminous United States)." (4)  Shouldn't it
have an easy-to-use EPSG?  Maybe it does and I just don't know where to
look.

Anyone still reading?  I will post again if I discover anything further,
but I have been obsessing about this for ~24 hours now, so I think I
will try something else.  Much obliged for any input from the group and
happy to provide omitted details.

Neil


(1)http://www.remotesensing.org/geotiff/proj_list/albers_equal_area_conic.html
(2)http://www.intevation.de/rt/webrt?serial_num=3526&display=History
(3)http://www.remotesensing.org/geotiff/proj_list/guid7.html
(4) p. 35, Cartographic Projection Procedures for the UNIX Environment?A
    User?s Manual ftp://ftp.remotesensing.org/proj/new_docs/OF90-284.pdf

-------------- next part --------------
PROJCS["Albers Equal Area",
    GEOGCS["wgs84",
        DATUM["WGS_1984",
            SPHEROID["wgs84",6378137,298.257223563]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Albers_Conic_Equal_Area"],
    PARAMETER["standard_parallel_1",29.5],
    PARAMETER["standard_parallel_2",45.5],
    PARAMETER["latitude_of_center",0],
    PARAMETER["longitude_of_center",-96],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["mi",1]]
-------------- next part --------------
INFO: Open of `temp'
using driver `ESRI Shapefile' successful.

Layer name: counties
Geometry: Polygon
Feature Count: 3140
Extent: (-6293474.061879, 2670863.569639) - (2256278.441196, 8557825.854853)
Layer SRS WKT:
PROJCS["Albers Equal Area",
    GEOGCS["GCS_WGS_1984",
        DATUM["WGS_1984",
            SPHEROID["wgs84",6378137,298.257223563]],
        PRIMEM["Greenwich",0],
        UNIT["Degree",0.017453292519943295]],
    PROJECTION["Albers_Conic_Equal_Area"],
    PARAMETER["standard_parallel_1",29.5],
    PARAMETER["standard_parallel_2",45.5],
    PARAMETER["latitude_of_center",0],
    PARAMETER["longitude_of_center",-96],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["mi",1]]
NAME: String (32.0)
STATE_NAME: String (25.0)
STATE_FIPS: String (2.0)
CNTY_FIPS: String (3.0)
FIPS: String (5.0)
AREA: Real (18.4)
POP1990: Integer (10.0)
POP1997: Integer (10.0)
POP90_SQMI: Integer (6.0)
HOUSEHOLDS: Integer (8.0)
MALES: Integer (8.0)
FEMALES: Integer (8.0)
WHITE: Integer (8.0)
BLACK: Integer (8.0)
AMERI_ES: Integer (6.0)
ASIAN_PI: Integer (7.0)
OTHER: Integer (8.0)
HISPANIC: Integer (8.0)
AGE_UNDER5: Integer (7.0)
AGE_5_17: Integer (8.0)
AGE_18_29: Integer (8.0)
AGE_30_49: Integer (8.0)
AGE_50_64: Integer (8.0)
AGE_65_UP: Integer (7.0)
NEVERMARRY: Integer (8.0)
MARRIED: Integer (8.0)
SEPARATED: Integer (7.0)
WIDOWED: Integer (7.0)
DIVORCED: Integer (7.0)
HSEHLD_1_M: Integer (7.0)
HSEHLD_1_F: Integer (7.0)
MARHH_CHD: Integer (7.0)
MARHH_NO_C: Integer (7.0)
MHH_CHILD: Integer (6.0)
FHH_CHILD: Integer (7.0)
HSE_UNITS: Integer (8.0)
VACANT: Integer (7.0)
OWNER_OCC: Integer (8.0)
RENTER_OCC: Integer (8.0)
MEDIAN_VAL: Integer (7.0)
MEDIANRENT: Integer (4.0)
UNITS_1DET: Integer (8.0)
UNITS_1ATT: Integer (7.0)
UNITS2: Integer (7.0)
UNITS3_9: Integer (7.0)
UNITS10_49: Integer (7.0)
UNITS50_UP: Integer (7.0)
MOBILEHOME: Integer (6.0)
NO_FARMS87: Integer (5.0)
AVG_SIZE87: Integer (6.0)
CROP_ACR87: Integer (8.0)
AVG_SALE87: Integer (7.0)
From warmerdam at pobox.com  Fri Jun 16 11:57:47 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] IPCC raster format
In-Reply-To: <6FD7C9DB26540B42A1207C69BF92D455017A737D@Iris.ad.clarku.edu>
References: <6FD7C9DB26540B42A1207C69BF92D455017A737D@Iris.ad.clarku.edu>
Message-ID: <4492D4FB.9070009@pobox.com>

Ivan Lucena wrote:
> Hi there,
> 
>  
> 
> I would rather been watching the World Cup, but I have to get this data 
> in a usable format and there is no better place to get it than from 
> GDAL?s experts.
> 
>  
> 
> The ?Intergovernmental Panel on Climate Change? (IPCC) offers data on 
> the web in a format described by this Fortran source code: (The file 
> extension is just a generic ?.dat?)
> 
>  
> 
> http://ipcc-ddc.cru.uea.ac.uk/obs/observed_fileformat.html
> 
>  
> 
>>  more cpre0130.dat
> 
>     grd_sz      xmin      ymin      xmax      ymax    n_cols    n_rows  
> n_months
> 
>       0.50      0.25    -89.75    359.75     89.75       720       
> 360        12
> 
> ?
> 
> -9999-9999-9999-9999-9999-9999-9999-9999-9999   52   88  103   91   65   
> 45   27   32 ?
> 
> -9999-9999-9999-9999-9999   11   20   22   25   27   26   27   28   31 
>   29   28   30 ?
> 
> ?
> 
>  
> 
> It?s not hard to analyze the pattern on the data or the code, so I 
> figured that:
> 
>  
> 
> - It?s an ASCII format;
> 
> - There are two lines of reader (easy to read)
> 
> - Each cell is 5 characters wide;
> 
> - The no-data is ?-9999?;
> 
> - There is no separator between cells (what makes my task difficult);
> 
> - It?s a multi-band raster dataset with 12 bands; (720x360x12 cells)
> 
> - I am not sure if positive values can go beyond 9999 (that reminds me 
> COBOL)
> 
>  
> 
> I am heading in the direction of writing a Python+GDAL script to do the 
> task, but I am stuck in how to separate the cells. The Fortran code is 
> doing it in just one command as you can see in the code. I am thing that 
> maybe by using the NumPY stuff embedded in GDAL I could do the same.
> 
>  
> 
> Any Idea? Any experience with this data format?

Ivan,

I think a Python script would be the right approach since there is no
generic ascii driver that could be used for this format.  Since there is
no field separator, I guess you will need to loop through the strings you
read cutting out 5 character chunks of data as substrings.

eg.
   for item_i in range(12):
     item = line[item_i:item_i+5]
     ...

I imagine it would make sense to assemble the data in a Numeric array,
and then push that back with band.WriteArray() or something simmilar.
I was going to point at the gdal2grd.py script as an example, but it
goes the other way ... from gdal format to ascii file.  Perhaps it will
help a bit.  (gdal/pymod/samples/gdal2grd.py)

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From matt.wilkie at gov.yk.ca  Fri Jun 16 12:29:23 2006
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Problem with GDALWARP - very fast to solve
In-Reply-To: <001201c69114$b6c11b40$8788e289@digar>
References: <000e01c68fbb$f4fe2330$8788e289@digar> <4491B0DD.3020206@gov.yk.ca>
	<001201c69114$b6c11b40$8788e289@digar>
Message-ID: <4492DC63.5060301@gov.yk.ca>

Jan B. wrote:
> Sorry, forgot to upload the describing hdr file in the package.
> 
> Please look at
> 
> www.esw.rwth-aachen.de/USGS.rar

took a bit, but I finally figured this one out. You need to tell 
gdalwarp to ignore nodata:

   gdalwarp -t_srs "+proj=utm +zone=11 +datum=WGS84"
   -srcnodata "-32767" n56e010.bil test.tif


cheers,


-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
http://environmentyukon.gov.yk.ca/geomatics/
--------------------------------------------


From Chris.Barker at noaa.gov  Fri Jun 16 12:50:39 2006
From: Chris.Barker at noaa.gov (Christopher Barker)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] IPCC raster format
In-Reply-To: <6FD7C9DB26540B42A1207C69BF92D455017A737D@Iris.ad.clarku.edu>
References: <6FD7C9DB26540B42A1207C69BF92D455017A737D@Iris.ad.clarku.edu>
Message-ID: <4492E15F.9020107@noaa.gov>

Ivan Lucena wrote:
> I am heading in the direction of writing a Python+GDAL script to do the
> task, but I am stuck in how to separate the cells. The Fortran code is
> doing it in just one command as you can see in the code. 

Fixed format is native to Fortran, so it is easier there. there may be 
some code in the SciPy project to read Fortran fixed format files, but 
it's not too hard to do with Python. I've enclosed a script that does it 
either with numpy or with straight python. I'm not sure numpy really 
helps here as I don't think you can vectorize the  conversion from ascii 
to float.

Once you have all the numbers as numbers, you can use Numpy to make them 
the binary shape (and type) you need from there.

Enclosed is a script (there's a flag at the top for whether you want to 
use numpy or not) and a small sample data file that looks similar to 
what you want.

-Chris


-- 
Christopher Barker, Ph.D.
Oceanographer
                                     		
NOAA/OR&R/HAZMAT         (206) 526-6959   voice
7600 Sand Point Way NE   (206) 526-6329   fax
Seattle, WA  98115       (206) 526-6317   main reception

Chris.Barker@noaa.gov
-------------- next part --------------
grd_sz      xmin      ymin      xmax      ymax    n_cols    n_rows n_months
0.50      0.25    -89.75    359.75     89.75       720       360  12

1111122222-9999-9999-9999-9999-9999-9999-9999-9999-9999   52   88  103   91   65   45   27   32-9999-9999-9999-9999-9999   11   20   22   25   27   26   27   28   31
29   28   30

-------------- next part --------------
A non-text attachment was scrubbed...
Name: junk.py
Type: text/x-python
Size: 1268 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060616/0a650acc/junk.py
From paul.de-vlieger at clermont.cemagref.fr  Thu Jun  8 03:25:14 2006
From: paul.de-vlieger at clermont.cemagref.fr (VLIEGER (de) Paul)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Losing projection info when running transformation
	method for the 2nd time.
Message-ID: <48639FBE26060E4882B33D717E070B50027D4CE3@lassolas.clermont.cemagref.fr>

Hello,
i'am writing a program with perform transformations on map files.

This program is written in vb.net and i had to create a bridge(dll) between 
gdal/ogr and the .net platform (with managed c++) and it works pretty well
(any problem of compilation with visual c++).

The program takes a file in entry (mapinfo or esri), performs transformations (add/remove/rename fields),
recopies features (like ogr2ogr) and saves the new file as a mapinfo file.

OK so my program works and do what i want, but only one time per execution...

I have to translate a thousand of files like that and only the first file is correct,
I need to re-launch the program to translate correctly only one file...

The other files that the first can't be opened with mapinfo due to corrupted data???

So I search for the origin of the problem and I've found that the 2nd file haven't the good
projection info.

->first file(wkt): -> projection lambert II carto (for france)
	PROJCS["NTF_Lambert_II_?tendu",GEOGCS["GCS_NTF",DATUM["NTF",SPHEROID["Clarke_188
	0_IGN",6378249.2,293.46602]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.01745329251
	99433]],PROJECTION["Lambert_Conformal_Conic_1SP"],PARAMETER["False_Easting",6000
	00.0],PARAMETER["False_Northing",2200000.0],PARAMETER["Central_Meridian",2.33722
	91667],PARAMETER["Standard_Parallel_1",45.8989188889],PARAMETER["Standard_Parall
	el_2",47.6960144444],PARAMETER["Scale_Factor",1.0],PARAMETER["Latitude_Of_Origin
	",46.8],UNIT["Meter",1.0]]

->2nd file(wkt) (only openable with ogr)
	GEOGCS["unnamed",DATUM["WGS_1984",SPHEROID["WGS 84",6378137,298.257223563],TOWGS
	84[0,0,0,0,0,0,0]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433]]

all the other files get this projection info until I stop the program and re-lauch it.

I think Maybe I miss to delete/clean something the first time?
Is it normal that the file is created when I delete the datasource? >delete poODS;
Have you any idea about the origin of this problem?

Thank you...

Paul De Vlieger
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060608/b778de6d/attachment.html
From rdespain at harris.com  Thu Jun  8 13:14:38 2006
From: rdespain at harris.com (DeSpain, Ronald)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Writing NITFJP2s?
Message-ID: <33E9C96E5F4538409B0B533B74953E360170F16F@mlbe2k4.cs.myharris.net>

I'm looking for a way to use gdal_translate to write NITFJP2 image files
and version 1.2.6 indicates that it has these capabilities.  I'm using
version 1.3.2 currently.
 
ie
NITF Driver: 
- Added support for reading *and* writing JPEG2000 compressed NITF files

   using the ECW/JPEG2000 SDK. 
- Added ICHIPB support.
 
Is this only available via calls to the class libraries, or is there a
key word for the -of option of gdal_translate which is not documented?
 
I can't find any good installation instructions for either ECW, or
KAKADU.  I'm having to compile the applications on an SGI running IRIX.
I'm also using the WIN versions on my PC.  FWTools with gdal 1.3.2 for
the PC seems to have all the JPEG2000 stuff already in it...but it still
doesn't write out NITFJP2s.
 
Thanks
Ron DeSpain
Harris Geospatial Imaging
rdespain@harris.com
321 751 3789
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060608/2c0e6d35/attachment.html
From rdespain at harris.com  Tue Jun 13 12:53:34 2006
From: rdespain at harris.com (DeSpain, Ronald)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Writing NITF JPEG2000 files with gdal_translate
Message-ID: <33E9C96E5F4538409B0B533B74953E360170F17F@mlbe2k4.cs.myharris.net>

In trying to produce NITF2.1 JPEG2000 chip files from NITF2.0 and
NITF2.1 files, the following calls produced bad files.
 
gdal_translate --config GDAL_CACHEMAX 500 -of NITF -srcwin 2909 6648 400
400 -scale -co "IC=C8" Imagep1_nitf20.ntf Imagep1_nitf20ChipToNJp2.ntf
 
gdal_translate --config GDAL_CACHEMAX 500 -of NITF -srcwin 11780 21928
400 400 -scale -co "IC=C8" Image65PanNitf21U.NTF
Image65PanNitf21UgdalchipToIC8.NTF
 
In trying to procuce NITF 2.0 uncompressed files from NITF2.1
uncompressed files the following calls just produced NITF 2.1 files.
 
gdal_translate --config GDAL_CACHEMAX 800 -of NITF -quiet -co
"FVER=02.00" Image65PanNitf21U.NTF Image65PanNitf21UtoN20.NTF
 
gdal_translate --config GDAL_CACHEMAX 800 -of NITF -quiet -co
"FVER=NITF02.00" Image65PanNitf21U.NTF Image65PanNitf21UtoNITF0200.NTF
 
Does anyone see what I'm missing?
 
Thanks
Ron
 
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060613/7c198deb/attachment.html
From lukeroth at verizon.net  Tue Jun 13 16:34:21 2006
From: lukeroth at verizon.net (Luke Roth)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] how gdal_rasterize works
Message-ID: <448F214D.4010406@verizon.net>

I've been trying to use the polygon rasterization functions in 
alg/gdalrasterize.cpp for a while now, but I just can't get it to do 
what I want.  I've been using apps/gdal_rasterize.exe to rasterize an 
entire vector layer, but what I'd really like to do is to rasterize 
individual polygons from my C code without having to run 
gdal_rasterize.exe for each individual feature.  I've tried using the 
apps/gdal_rasterize.cpp code as a template, but I'm not getting 
anywhere.  Can anyone who has used this code give me a simple 
walkthrough or nudge me in the right direction?  I can give more details 
if it would help.

Thanks,
Luke

From agnoli.tv at libero.it  Wed Jun 14 17:32:54 2006
From: agnoli.tv at libero.it (Alberto Agnoli)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Driver for Garmin IMG formats or Polish Format
In-Reply-To: <200606142059.k5EKxen3027457@duke.maptools.org>
Message-ID: <000901c68ffa$18b35640$640fa8c0@N985>

Hallo everyone,

We made an application that uses GDAL OGR for reading several layers in a
shapefile DATASOURCE and then plots them on the screen (using geocanvas), a
map visualizer.
We're now using some shapefile we exported first from a GARMIN IMG file with
gpsMapEdit to Polish Format, and then with another tool we re-exported all
the data again to the shapefile format.
I wonder if some of you are planning to make an OGR Driver to read one of
the above formats. We would like to start or continue such a work, and for
this we're looking for suggestion/ideas.
Thanks a lot, Alberto Agnoli e Giuseppe Cigala 


From rdespain at harris.com  Thu Jun 15 10:31:42 2006
From: rdespain at harris.com (DeSpain, Ronald)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] How can I reply to an item in a thread?
Message-ID: <33E9C96E5F4538409B0B533B74953E360170F18C@mlbe2k4.cs.myharris.net>

When I'm reviewing my thread I'm in Internet Explorer not an email
client, so there is no "Reply" button, so I can't figure out how to
reply to a response...in this case I clicked the responders email
address at the top of the message, but It doesn't look like it's going
to him by the address on this message, but back to the list.  I'm cc ing
mateusz at loskot.net.  Mateusz...please forgive the inconveiniece, as
I'm trying to figure out the procedure on this list.  Somehow It's
confusing to me.
 
Ron DeSpain
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060615/0ef1d422/attachment.html
From Chris.Barker at noaa.gov  Fri Jun 16 15:21:28 2006
From: Chris.Barker at noaa.gov (Christopher Barker)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] how gdal_rasterize works
In-Reply-To: <448F214D.4010406@verizon.net>
References: <448F214D.4010406@verizon.net>
Message-ID: <449304B8.8040701@noaa.gov>



Luke Roth wrote:
> what I'd really like to do is to rasterize 
> individual polygons from my C code without having to run 
> gdal_rasterize.exe for each individual feature. 

Drawing a raster image from Vector data can be a very complex process. 
In particular, shape files specify the shapes, but don't specify 
anything about how they should be rendered. Once you know how they 
should be rendered, rendering them well requires a good rendering library.

There are a lot of tools for rendering maps out there (most using 
GDAL!). It's probably better to use one of them. One that does a 
particularly impressive job is Mapnik:

http://mapnik.org/

There are lots of others. You could also just draw the stuff yourself, 
using the GD lib, or Agg, or .....

I'll bet the MapServer project and/or the Python Cartographic library 
has something.

-Chris





-- 
Christopher Barker, Ph.D.
Oceanographer
                                     		
NOAA/OR&R/HAZMAT         (206) 526-6959   voice
7600 Sand Point Way NE   (206) 526-6329   fax
Seattle, WA  98115       (206) 526-6317   main reception

Chris.Barker@noaa.gov

From warmerdam at pobox.com  Fri Jun 16 15:26:07 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Tool to convert shapefile from [-180, 180] to [0,
	360] range
In-Reply-To: <448F3658.9000101@mapgears.com>
References: <448F3658.9000101@mapgears.com>
Message-ID: <449305CF.7090204@pobox.com>

Daniel Morissette wrote:
> Is anyone aware of a tool or script that would convert the longitude of 
> coordinates in a shapefile from [-180,180] to [0,360]? The tool could be 
> based on OGR or any other open source package.
> 
> Just checking before writing something from scratch and reinventing the 
> wheel.

Daniel,

I imagine you have what you need working now, and I see there was an
extensive thread on this issue.  I just wanted to add that in recent
works I've done some work on the OGRCoordinateTransformation object
related to supporting a "wrapping center" for geographic coordinate
systems.

It is now possible to define a wrapping center longitude, and the
OGRCoordinateTransformation object will take care of forcing longitudes
into the range center-180 to center+180.  This can be accomplished using
the CENTER_LONG configuration option like this:

   gdalwarp --config CENTER_LONG 180 openev/utm.tif ll.tif -t_srs WGS84

In the above case, the output lat/long file will use the range 0 to 360
instead of the default -180 to 180.

I also have an extension to WKT for setting this.  I believe you add
an entry like EXTENSION["CENTER_LONG",180] as a child of the GEOGCS node.
I would have mentioned this whole issue here sooner, except that I just
know that Martin Daly will now rightly jump all over me for corrupting
the standard WKT format.  I must say, I now regret not having advocated
on behalf of a vendor specific extension mechanism in the past. :-)

The gdalwarp utility now has some built-in smarts to apply a CENTER_LONG
to the source coordinate system center in the middle of the dataset.  The
original problem that motivated me to do something had to do with reprojection
away from lat/long and the projected coordinates for sampling not reprojecting
back onto the source dataset in the proper range.

I haven't written up an RFC on all this as I consider it quite experimental
though I must confess I have committed it in CVS.

In your case, I think it should be possible to run ogr2ogr like:

   ogr2ogr out.shp in.shp --config CENTER_LONG 180 -t_srs WGS84 -t_srs WGS84

though I haven't tried it to see if there are issues.  This certainly won't
take care of splitting a geometry that crosses the meridian as ought to be
done when transforming.  For points this won't matter, but it will for
line or polygon files.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From warmerdam at pobox.com  Fri Jun 16 16:04:43 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] how gdal_rasterize works
In-Reply-To: <448F214D.4010406@verizon.net>
References: <448F214D.4010406@verizon.net>
Message-ID: <44930EDB.5060909@pobox.com>

Luke Roth wrote:
> I've been trying to use the polygon rasterization functions in 
> alg/gdalrasterize.cpp for a while now, but I just can't get it to do 
> what I want.  I've been using apps/gdal_rasterize.exe to rasterize an 
> entire vector layer, but what I'd really like to do is to rasterize 
> individual polygons from my C code without having to run 
> gdal_rasterize.exe for each individual feature.  I've tried using the 
> apps/gdal_rasterize.cpp code as a template, but I'm not getting 
> anywhere.  Can anyone who has used this code give me a simple 
> walkthrough or nudge me in the right direction?  I can give more details 
> if it would help.

Luke,

You should be able to follow the gdal_rasterize.c code as a template
for this.  If you are running into problems, you might need to be specific
about what is going wrong.

Are you calling GDALRasterizeGeometries() once for each feature?  Keep in
mind that the downside of doing this is that a complete pass through the
raster (read/write) must be made for each features.  Well, actually come
to think of it, the code might be smart enough to focus on the area of
the geometry, but still it is likely to result in quite a bit of extra
read/write work on the raster.

As Chris Barker suggests, GDAL's rasterization capability is not
sophisticated from a render styling point of view.  Other tools may
be more appropriate if you want to do anything more sophisitcated
that rasterize the polygons in a single solid color.

For more interactive help, you might want to drop into #gdal on
irc.freenode.net.  I should be around for a while.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From ari.jolma at tkk.fi  Fri Jun 16 16:40:52 2006
From: ari.jolma at tkk.fi (Ari Jolma)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] how gdal_rasterize works
In-Reply-To: <448F214D.4010406@verizon.net>
References: <448F214D.4010406@verizon.net>
Message-ID: <1150490452.4493175488198@webmail2.hut.fi>

On Tue, 13 Jun 2006 16:34:21 -0400 Luke Roth <lukeroth@verizon.net> wrote:

> I've been trying to use the polygon rasterization functions in 
> alg/gdalrasterize.cpp for a while now, but I just can't get it to do 
> what I want.  I've been using apps/gdal_rasterize.exe to rasterize an 
> entire vector layer, but what I'd really like to do is to rasterize 
> individual polygons from my C code without having to run 
> gdal_rasterize.exe for each individual feature.  I've tried using the 
> apps/gdal_rasterize.cpp code as a template, but I'm not getting 
> anywhere.  Can anyone who has used this code give me a simple 
> walkthrough or nudge me in the right direction?  I can give more
> details 
> if it would help.

I've written simple rasterization functions into libral (libral.sf.net). With it
you can rasterize OGR data onto images that fit into run-time memory. 

Ari

> 
> Thanks,
> Luke
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
> 

-- 
Prof. Ari Jolma
Kartografia ja Geoinformatiikka / Cartography and Geoinformatics
Teknillinen Korkeakoulu / Helsinki University of Technology
POBox 1200, 02015 TKK, Finland
Email: ari.jolma at tkk.fi URL: http://www.tkk.fi/~jolma

From aaronkoning at gmail.com  Fri Jun 16 17:02:36 2006
From: aaronkoning at gmail.com (Aaron Koning)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] OGR can't handle Null values in a Date field
Message-ID: <1319fbba0606161402t240c8dd0u4f34c5e8148ef340@mail.gmail.com>

I have just started using a newer version of OGR that includes Date support.
(Context: I am importing shapefiles into PostgreSQL using OGR/PHP).
Unfortunately, when I there is a Null value in a Date field of the input
shapefile OGR bails (after successfully inserting non-null values). From
what I can see, it attempts to do an insert with a '00/00/00 00:00:00' value
and PostgreSQL states I may need another Date type for this value.

Is there anyway of getting OGR to output Null values into a Date field when
there is a Null value present in the input Date field? Alternatively, the
previous versions of OGR simply converted Date fields to strings. Is there a
way to revive this action (when I set the output field type to string
instead of bool, it doesn't work).

Aaron

+--------------------------------------------
|  Aaron Koning
|  Information Technologist
|  Prince George, BC, Canada.
+--------------------------------------------
|  http://datashare.gis.unbc.ca/fist/
|  http://datashare.gis.unbc.ca/gctp-js/
+--------------------------------------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060616/b5cb215f/attachment.html
From nbest at speakeasy.net  Fri Jun 16 18:23:31 2006
From: nbest at speakeasy.net (Neil Best)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] fun with projections -- GCS to AEA
In-Reply-To: <1150471335.28798.55.camel@localhost.localdomain>
References: <1150471335.28798.55.camel@localhost.localdomain>
Message-ID: <1150496612.28798.108.camel@localhost.localdomain>

Update:

When I work in GRASS and use g.setproj I can tell it that my units
should be miles in the prompts.  The result is:

> g.proj -jf
+proj=aea +lat_0=23.0000000000 +lat_1=29.5000000000 +lat_2=45.5000000000
+lon_0=-96.0000000000 +x_0=0.0000000000 +y_0=0.0000000000 +a=6378137
+rf=298.257223563 +no_defs +towgs84=0.000,0.000,0.000

> g.proj -w
PROJCS["Albers Equal Area",
    GEOGCS["wgs84",
        DATUM["WGS_1984",
            SPHEROID["wgs84",6378137,298.257223563],
            TOWGS84[0.000,0.000,0.000]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Albers_Conic_Equal_Area"],
    PARAMETER["standard_parallel_1",29.5],
    PARAMETER["standard_parallel_2",45.5],
    PARAMETER["latitude_of_center",23],
    PARAMETER["longitude_of_center",-96],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["miles",1609.344]]

> g.proj -fw > aeaUS.wkt

>ogr2ogr -s_srs EPSG:4326 -t_srs aeaUS.wkt -where 'state_fips not in 
("02","15")' temp usagen counties

# leaving out AK and HI -- sorry folks!

QGIS doesn't like the proj4 string for a custom projection (it complains
about the lack of an +ellps[sic] clause), but it picks it up from
the .prj generated by ogr2ogr just fine.  Now I should be able to
generate my buffers in GRASS.

Is there a bug somewhere among all of this?  The key appears to be the
UNIT clause of the WKT.  Comments?

g.setproj told me to do a g.region -d but it didn't seem to do the right
thing and I had to start over with a new location.  I know this isn't a
GRASS list, but while I have the floor . . .


On Fri, 2006-06-16 at 10:22 -0500, Neil Best wrote:
> Hello all and happy Friday.  I have been working on something that isn't
> coming out quite right so I though I would write it up for my own sanity
> and share it in case someone was inclined to look it over.
> 
> I have a .shp of US counties in an unknown GCS.  QGIS assumes a WGS84,
> good enough for me -- EPSG:4326 it is.  I need 50-mile buffers for each
> county and my research tells me that whether I use GRASS or PostGIS I
> need by base data to be projected into some cartesian units because the
> buffer functions use map units.  Looks like a job for ogr2ogr.
> 
> But what projection?  Further digging indicated that an Albers
> Equal-Area Conic is a good choice when working with the full extent of
> the states.  I found some clues at (1), (2), and (3).  Neither OGR nor
> QGIS seem to have any EPSG:9822 so I take this to be a general
> transformation without the specific parameters.
> 
> So I wrote:
> 
> > g.proj -w proj4='+proj=aea +units=mi +datum=WGS84 +ellps=WGS84 \
>     +lat_1=29.5 +lat_2=45.5 +lon_0=-96' > aeaUS.wkt
> 
> # aeaUS.wkt attached
> 
> > ogr2ogr -s_srs EPSG:4326 -t_srs aeaUS.wkt temp usagen counties
> > ogrinfo -so temp counties > counties_aea.ogrinfo
> 
> # counties_aea.ogrinfo attached
> 
> What concerns me are the extents reported by ogrinfo:
> Extent: (-6293474.061879, 2670863.569639) - (2256278.441196,
> 8557825.854853)
> 
> 8.5 million miles wide?  I don't think so.
> 
> When I set a custom projection in QGIS using the same proj4 string and
> add the original unprojected layer I see this metadata for the layer:
> 
> General:
> Geometry type of the features in this layer : Polygon
> The number of features in this layer : 3140
> Extents:
> In layer spatial reference system units : xMin,yMin -178.215,18.9248 :
> xMax,yMax -66.9698,71.4066
> In project spatial reference system units : xMin,yMin -4903.87,1195.6 :
> xMax,yMax 1937.56,5684.6
> Layer Spatial Reference System:
> +proj=longlat +ellps=WGS84 +no_defs 
> Project (Output) Spatial Reference System:
> +proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=0 +lon_0=-96 +x_0=0 +y_0=0
> +ellps=WGS84 +datum=WGS84 +units=mi
> 
> 
> ~ 6800 miles wide -- that's more like it.  Cook County, IL (Chicago) is
> about 50 miles north to south.  It's about 160 miles from Chicago to
> Indianapolis as the crow flies.  I can live with that, but I need a
> projected layer on disk, not just QGIS doing it on the fly.
> 
> When I open the ogr-generated .shp in a new QGIS project I get 
> 
> General:
> Geometry type of the features in this layer : Polygon
> The number of features in this layer : 3140
> Extents:
> In layer spatial reference system units : xMin,yMin -6.29347e
> +06,2.67086e+06 : xMax,yMax 2.25628e+06,8.55783e+06
> In project spatial reference system units : xMin,yMin -6.29347e
> +06,2.67086e+06 : xMax,yMax 2.25628e+06,8.55783e+06
> Layer Spatial Reference System:
> +proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=0 +lon_0=-96 +x_0=0 +y_0=0
> +ellps=WGS84 +datum=WGS84 +units=mi
> Project (Output) Spatial Reference System:
> +proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=0 +lon_0=-96 +x_0=0 +y_0=0
> +ellps=WGS84 +datum=WGS84 +units=mi
> 
> Cook County is now over 77,000 miles long!
> 
> 
> Q: Is this a good choice of projections?
> 
> Q: What is ogr trying to tell me?  Am I using it properly, particularly
> the +units flag?  Do I need some kind of explicit scale factor?
> 
> Q: Is there an easier way to manipulate / generate .prj's and .wkt's
> aside from g.proj (so I don't necessarily have to start GRASS)?
> 
> Q: What's the preferred method of looking up EPSGs?  I rely on QGIS.
> 
> Q: Isn't this a generally useful and popular projection?  "Default
> values for ?1 and ?2 are respectively 29.5 N and 45.5 N (values normally
> used for maps of the conterminous United States)." (4)  Shouldn't it
> have an easy-to-use EPSG?  Maybe it does and I just don't know where to
> look.
> 
> Anyone still reading?  I will post again if I discover anything further,
> but I have been obsessing about this for ~24 hours now, so I think I
> will try something else.  Much obliged for any input from the group and
> happy to provide omitted details.
> 
> Neil
> 
> 
> (1)http://www.remotesensing.org/geotiff/proj_list/albers_equal_area_conic.html
> (2)http://www.intevation.de/rt/webrt?serial_num=3526&display=History
> (3)http://www.remotesensing.org/geotiff/proj_list/guid7.html
> (4) p. 35, Cartographic Projection Procedures for the UNIX Environment?A
>     User?s Manual ftp://ftp.remotesensing.org/proj/new_docs/OF90-284.pdf
> 
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev


From warmerdam at pobox.com  Fri Jun 16 18:35:44 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] OGR can't handle Null values in a Date field
In-Reply-To: <1319fbba0606161402t240c8dd0u4f34c5e8148ef340@mail.gmail.com>
References: <1319fbba0606161402t240c8dd0u4f34c5e8148ef340@mail.gmail.com>
Message-ID: <44933240.3090703@pobox.com>

Aaron Koning wrote:
> I have just started using a newer version of OGR that includes Date 
> support. (Context: I am importing shapefiles into PostgreSQL using 
> OGR/PHP). Unfortunately, when I there is a Null value in a Date field of 
> the input shapefile OGR bails (after successfully inserting non-null 
> values). From what I can see, it attempts to do an insert with a 
> '00/00/00 00:00:00' value and PostgreSQL states I may need another Date 
> type for this value.
> 
> Is there anyway of getting OGR to output Null values into a Date field 
> when there is a Null value present in the input Date field? 
> Alternatively, the previous versions of OGR simply converted Date fields 
> to strings. Is there a way to revive this action (when I set the output 
> field type to string instead of bool, it doesn't work).

Aaron,

Date fields are intended to support nulls.  Could you provide me
with a shapefile with some null dates I could test with?  I think there
is just a bug at some point in the code with null propogation in date fields.

Best regards,--
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From warmerdam at pobox.com  Fri Jun 16 19:07:35 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] How to split multi-layer geotiff images
In-Reply-To: <C482FF98AE985A47B8C982FD429C9E34FEF851@daytonmsg2k3.AERO.BALL.COM>
References: <C482FF98AE985A47B8C982FD429C9E34FEF851@daytonmsg2k3.AERO.BALL.COM>
Message-ID: <449339B7.1030405@pobox.com>

Clay, Bruce wrote:
>  I have had problems getting this message posted.  ? the send keeps 
> timing out.  I apologize if multiples finally get sent out
> 
>  
> 
>  
> 
> Can GDAL be used to open multi-layer Geotiff raster files?
> 
>  
> 
> Not multi-band but more than one image in the same file. I was given 
> some Geotiff images that Microsoft Office Imaging tool shows 2 distinct 
> images in a single tiff file.
> 
>  
> 
> IDL was used to create the file using an APPEND function.
> 
>  
> 
> ArcMap does not seem to be able to find the second images so I would 
> like to extract the image using GDAL but I don?t see any info in the 
> documentation.
> 
>  
> 
> Tiffsplit in the FW tool set will split the file into 2 images but it 
> kicks up some error messages

Bruce,

I don't think GDAL provides a really convenient way of accessing these
multi-images; however, if you know how many directories there are you
can accessing them something like:

  gdal_translate GTIFF_DIR:2:2part.tif out.tif

So, prefix the filename with "GTIF_DIR:<number>:".  If <number> is
1 it will get the first directory, 2 for the second, etc.

You can see the dir count with tiffinfo or just try till it fails.

Ideally GDAL would report all the directories (that are no overviews)
as subdatasets but currently it does not.   I you would like to file
an enhancement bug in bugzilla I'll look into doing it at some point.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From warmerdam at pobox.com  Fri Jun 16 20:48:18 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Setting PROJ4 path programatically
In-Reply-To: <006e01c68ffa$30ee5700$7500a8c0@vaio>
References: <006e01c68ffa$30ee5700$7500a8c0@vaio>
Message-ID: <44935152.5060600@pobox.com>

Craig Miller wrote:
> In digging through the archives, I found a post that briefly describes how
> to set the path where PROJ4 looks for its data files (E.g. proj4/nad).  The
> message mentions two functions:
> 
> 	pj_set_finder(...);
> 	CPLSetConfigOption("GDAL_DATA", ...);
> 
> If I'm only using OGRSpatialReference directly and not calling into proj4
> directly is the CPLSetConfigOption sufficient or do I need to call
> pj_set_finder(...) as well.

Craig,

I believe you need to call pj_set_finder() even if you are only using PROJ.4
second hand, though this likely only applies for finding stuff like datum
shift files.

> Will these calls affect any other applications that are running on the same
> machine that are also using PROJ4?

Neither call will have an effect outside the process in which they are made.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From warmerdam at pobox.com  Fri Jun 16 21:30:21 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Driver for Garmin IMG formats or Polish Format
In-Reply-To: <000901c68ffa$18b35640$640fa8c0@N985>
References: <000901c68ffa$18b35640$640fa8c0@N985>
Message-ID: <44935B2D.7070104@pobox.com>

Alberto Agnoli wrote:
> Hallo everyone,
> 
> We made an application that uses GDAL OGR for reading several layers in a
> shapefile DATASOURCE and then plots them on the screen (using geocanvas), a
> map visualizer.
> We're now using some shapefile we exported first from a GARMIN IMG file with
> gpsMapEdit to Polish Format, and then with another tool we re-exported all
> the data again to the shapefile format.
> I wonder if some of you are planning to make an OGR Driver to read one of
> the above formats. We would like to start or continue such a work, and for
> this we're looking for suggestion/ideas.
> Thanks a lot, Alberto Agnoli e Giuseppe Cigala 

Alberto,

I am not aware of any work on supporting GPS formats in OGR.  Might it
just be easier to use GPSBabel to convert the GPS files into something OGR
can use?  Looking at GPSBabel that might be best accomplished through CSV
files.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From warmerdam at pobox.com  Fri Jun 16 22:31:33 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] srtm and gdaladdo question
In-Reply-To: <D098E650-2E8E-4643-BD9D-E2ACA3C4B4FE@kyngchaos.com>
References: <2576812186CDD411BF1500508B6DCE950E91135F@ecnwri1.ontario.int.ec.gc.ca>
	<D098E650-2E8E-4643-BD9D-E2ACA3C4B4FE@kyngchaos.com>
Message-ID: <44936985.1030909@pobox.com>

Tom / William,

I have just tried and reproduced this problem.  It looks quite serious
and a bit mysterious.  I'll try and look into it over the weekend,
but if one of you could file a bug on it that would be helpful.

Best regards,


William Kyngesburye wrote:
> I ran into the same problem a while back - what version of libtiff is 
> your gdal built with?  I found that when going from tiff 3.7.4 to 3.8.0 
> (still there at 3.8.2) I started getting these block errors at higher 
> overview levels.  This is with grey-scale images (like SRTM), with color 
> images I get bus errors.
> 
> I've been meaning to submit a bug report, but I don't know if it's 
> libtiff of GDAL (seems to be libtiff, from the thread trace), and I 
> never heard anything from my posts on this list.
> 
> 
> On Jun 12, 2006, at 10:21 AM, Kralidis,Tom [Burlington] wrote:
> 
>>
>> Hi,
>>
>> I am trying to generate a set of SRTM data via gdaltindex, for use with
>> MapServer, which has worked with no problems.
>>
>> The next challenge is ensure they are displayed efficiently in
>> MapServer, where I have taken the following steps:
>>
>> - run gdaltindex
>> - run gdaladdo on each image
>>
>> When I try to run gdaladdo, I encounter the following issues:
>>
>> Sample image:
>> ftp://ftp.glcf.umiacs.umd.edu/glcf/SRTM/Degree_Tiles/n045/SRTM_u01_n045w
>> 086/SRTM_u01_n045w086.tif.gz
>>
>> $ gdaladdo -r average SRTM_u01_n045w086.tif 2 4 8 16 32
>>
>> ...
>>
>> ERROR 1: IReadBlock failed at X offset 0, Y offset 11
>> ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 11
>> 91ERROR 1: SRTM_u01_n045w086.tif:DumpModeDecode: Not enough data for
>> scanline 0
>> ERROR 1: TIFFReadEncodedTile() failed.


-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From nhv at cape.com  Sat Jun 17 05:07:53 2006
From: nhv at cape.com (Norman Vine)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] IPCC raster format
In-Reply-To: <4492D4FB.9070009@pobox.com>
Message-ID: <EKEJIKAILPONGGENMBGACEOPAMAB.nhv@cape.com>

Frank Warmerdam writes:
> Ivan Lucena wrote:
> >
> > The ?Intergovernmental Panel on Climate Change? (IPCC) offers data on
> > the web in a format described by this Fortran source code:
> >
> > http://ipcc-ddc.cru.uea.ac.uk/obs/observed_fileformat.html
> >
> >
> > - It?s an ASCII format;
> >
> > - There are two lines of reader (easy to read)
> >
> > - Each cell is 5 characters wide;
> >
> > - The no-data is ?-9999?;
> >
> > - There is no separator between cells (what makes my task difficult);
> >
> > - It?s a multi-band raster dataset with 12 bands; (720x360x12 cells)
> >
> > - I am not sure if positive values can go beyond 9999 (that reminds me
> > COBOL)
> >
>
> I think a Python script would be the right approach since there is no
> generic ascii driver that could be used for this format.  Since there is
> no field separator, I guess you will need to loop through the strings you
> read cutting out 5 character chunks of data as substrings.
>
> eg.
>    for item_i in range(12):
>      item = line[item_i:item_i+5]
>      ...
>
> I imagine it would make sense to assemble the data in a Numeric array,
> and then push that back with band.WriteArray() or something simmilar.
> I was going to point at the gdal2grd.py script as an example, but it
> goes the other way ... from gdal format to ascii file.  Perhaps it will
> help a bit.  (gdal/pymod/samples/gdal2grd.py)

Sounds like you might want to look at    Scientific.IO.FortranFormat:
http://starship.python.net/~hinsen/ScientificPython/

HTH

Norman


From neteler at itc.it  Sat Jun 17 08:28:17 2006
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] how gdal_rasterize works
In-Reply-To: <44930EDB.5060909@pobox.com>
References: <448F214D.4010406@verizon.net> <44930EDB.5060909@pobox.com>
Message-ID: <20060617122817.GB22351@bartok.itc.it>

On Fri, Jun 16, 2006 at 04:04:43PM -0400, Frank Warmerdam wrote:
> Luke Roth wrote:
> >I've been trying to use the polygon rasterization functions in 
> >alg/gdalrasterize.cpp for a while now, but I just can't get it to do 
> >what I want.  I've been using apps/gdal_rasterize.exe to rasterize an 
> >entire vector layer, but what I'd really like to do is to rasterize 
> >individual polygons from my C code without having to run 
> >gdal_rasterize.exe for each individual feature.  I've tried using the 
> >apps/gdal_rasterize.cpp code as a template, but I'm not getting 
> >anywhere.  Can anyone who has used this code give me a simple 
> >walkthrough or nudge me in the right direction?  I can give more details 
> >if it would help.
> 
> Luke,
> 
> You should be able to follow the gdal_rasterize.c code as a template
> for this.  If you are running into problems, you might need to be specific
> about what is going wrong.
> 
> Are you calling GDALRasterizeGeometries() once for each feature?  Keep in
> mind that the downside of doing this is that a complete pass through the
> raster (read/write) must be made for each features.  Well, actually come
> to think of it, the code might be smart enough to focus on the area of
> the geometry, but still it is likely to result in quite a bit of extra
> read/write work on the raster.
> 
> As Chris Barker suggests, GDAL's rasterization capability is not
> sophisticated from a render styling point of view.  Other tools may
> be more appropriate if you want to do anything more sophisitcated
> that rasterize the polygons in a single solid color.
> 
> For more interactive help, you might want to drop into #gdal on
> irc.freenode.net.  I should be around for a while.
> 

Hi,

a stupid command line question: If a SHAPE is my starting point, how
to generate the needed raster map for "burn in" (if I don't
want to launch my GRASS machine for this)?

Certainly easy, but I don't recall...

thanks

 Markus

From woklist at kyngchaos.com  Sat Jun 17 13:30:49 2006
From: woklist at kyngchaos.com (William Kyngesburye)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] nodata -> alpha in TIFF output?
Message-ID: <F9926485-6B68-4B20-8D49-FEB53603A20B@kyngchaos.com>

I want to convert an RGB image group from GRASS, which has null/ 
nodata cells to an RGB TIFF with an alpha channel for the nodata  
cells.  I see that the TIFF format has an ALPHA=YES creation option,  
but that assumes that I have an extra band in the input for the  
nodata cells.  Is there a direct method/option, or do I need to add a  
nodata band to the GRASS image group?

The -a_nodata option doesn't seem to work for multiband images (ie - 
a_nodata 0,0,0 or just 0).  If it did I could take the first  
conversion where the nodata values become black and convert it again  
with the nodata option.  Assuming I don't have any pure black in the  
actual image.

-----
William Kyngesburye <kyngchaos@kyngchaos.com>
http://www.kyngchaos.com/

[Trillian]  What are you supposed to do WITH a maniacally depressed  
robot?

[Marvin]  You think you have problems?  What are you supposed to do  
if you ARE a maniacally depressed robot?  No, don't try and answer,  
I'm 50,000 times more intelligent than you and even I don't know the  
answer...

- HitchHiker's Guide to the Galaxy


From neteler at itc.it  Sat Jun 17 13:32:13 2006
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] DBF-Column type boolen and date?
Message-ID: <20060617173213.GB23778@bartok.itc.it>

Hi,

while updating the DBF driver in GRASS to the latest
shapelib version, I came across this proposal:

  [postgis-devel] DBF-Column type boolen and date
  strk at refractions.net strk at refractions.net
  Wed Jan 11 09:59:54 PST 2006
  http://postgis.refractions.net/pipermail/postgis-devel/2006-January/001940.html
  "Attached is a patch that will implement
   support for Date and Bool DBF<->pgsql transfer.
   ...
  "

which was also committed later:
  http://postgis.refractions.net/pipermail/postgis-devel/2006-January/001948.html

Could this be added to SHAPELIB/OGR as well?

Markus

From warmerdam at pobox.com  Sat Jun 17 23:06:12 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] using OGRLayer::SetSpatialFilter to access polygons
	in	.shp files
In-Reply-To: <27736D5DEC954F41A6718B6B3160191B013CC0B8@exch-van04.intl.businessobjects.com>
References: <27736D5DEC954F41A6718B6B3160191B013CC0B8@exch-van04.intl.businessobjects.com>
Message-ID: <4494C324.7070708@pobox.com>

Amanda Tucker wrote:
> Hello,
> 
>  
> 
> My goal is to input a point (lat/long) and to get all polygons that 
> contain this point.  I am using SetSpatialFilter() to filter on the 
> specified point.  I am being returned correct features (polygons), but 
> often, I am getting extra polygons.  I can see through GUI tools that 
> some polygons/multipolygons are being returned that do not contain the 
> point.  The doc for SetSpatialFilter() states ?currently this test may 
> be inaccurately implemented?.  Are there known cases that this method is 
> inaccurate?  And is this one of those cases?  Is there another way to 
> get the results I desire?  I also tried using within()/contain() after 
> these polygons were returned, but that did not work because I am not 
> building with GEOS.  Is there any way I can get the correct results 
> without building with GEOS?  And if not, where do I find the GEOS 
> binaries/source code to build with OGR?  And will these methods in GEOS 
> even solve my problem?

Amanda,

I believe the test is always passed on comparing the feature geometries
bounding rectangle to the spatial filter's bounding rectangle unless
GEOS support is built in, in which case I think a real intersection test
is done.

I believe FWTools is always built with GEOS if you want to use that for
a quick trial.  http://fwtools.maptools.org/

GEOS can be found at http://geos.refractions.net/

I see there is a PointOnSurface() method on the OGRPolygon that is not
yet implemented.  I likely ought to wire that to something when GEOS is
available.  In fact, point in polygon is not a very hard test for me to
do with using GEOS.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From warmerdam at pobox.com  Sun Jun 18 12:56:37 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] DBF-Column type boolen and date?
In-Reply-To: <20060617173213.GB23778@bartok.itc.it>
References: <20060617173213.GB23778@bartok.itc.it>
Message-ID: <449585C5.60501@pobox.com>

Markus Neteler wrote:
> Hi,
> 
> while updating the DBF driver in GRASS to the latest
> shapelib version, I came across this proposal:
> 
>   [postgis-devel] DBF-Column type boolen and date
>   strk at refractions.net strk at refractions.net
>   Wed Jan 11 09:59:54 PST 2006
>   http://postgis.refractions.net/pipermail/postgis-devel/2006-January/001940.html
>   "Attached is a patch that will implement
>    support for Date and Bool DBF<->pgsql transfer.
>    ...
>   "
> 
> which was also committed later:
>   http://postgis.refractions.net/pipermail/postgis-devel/2006-January/001948.html
> 
> Could this be added to SHAPELIB/OGR as well?

Markus,

OGR does not have a boolean field type, so for now we just map boolean fields
to ... umm, string I guess.  Dates are properly handled in the shapefile
driver using the native field type api i shapelib.

There was a proposed patch to add date (and boolean?) support in the shapelib
bugzilla, but I closed it since this can now be accomplished using the
native type shapelib functions.

Did you have a specific requirement for boolean fields?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From warmerdam at pobox.com  Sun Jun 18 13:20:09 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] how gdal_rasterize works
In-Reply-To: <20060617122817.GB22351@bartok.itc.it>
References: <448F214D.4010406@verizon.net> <44930EDB.5060909@pobox.com>
	<20060617122817.GB22351@bartok.itc.it>
Message-ID: <44958B49.9020704@pobox.com>

Markus Neteler wrote:
> Hi,
> 
> a stupid command line question: If a SHAPE is my starting point, how
> to generate the needed raster map for "burn in" (if I don't
> want to launch my GRASS machine for this)?
> 
> Certainly easy, but I don't recall...

Markus,

Well, to be honest I don't know an easy way.  I would be tempted to
gdal_translate an input file with the right number of bands, and
use the various options to set the desired region, size in pixels and
lines and coordinate system.

eg.

   gdal_translate in.tif wrk.tif -ot Byte -outsize 1000 1000 \
             -a_ullr -117 33 -116 34 -a_srs WGS84

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From dany.geotools at gmail.com  Mon Jun 19 04:14:55 2006
From: dany.geotools at gmail.com (Daniele Romagnoli)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Level 2 caching mechanism question
Message-ID: <7221db410606190114l5e3844bcnd61f3a0d99cceda9@mail.gmail.com>

Hi guys.
I'm writing a brief report on some GDAL capabilities and I would want to
know if I have correctly understood the level 2 caching mechanism.

Anyone can briefly summarize to me, how such a mechanism works as well as
its advantages?

Maybe, I have found the answer by analyzing GDAL sourcecode (IRasterIO
method and Co.).  (As an instance, If there are more than 64 blocks in a
row, then the sub blocking is activated by grouping 64 blocks at once in
greater subblocks...)

But I would like to have a better vision of the mechanism prior to write
wrong things.
Anyone could help me please?

Excuse me for my stupid question ^_^

Thanks a lot.
Regards,

Daniele
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060619/15b053c9/attachment.html
From tim at linfiniti.com  Sun Jun 18 19:26:39 2006
From: tim at linfiniti.com (Tim Sutton)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] IPCC raster format
In-Reply-To: <6FD7C9DB26540B42A1207C69BF92D455017A737D@Iris.ad.clarku.edu>
References: <6FD7C9DB26540B42A1207C69BF92D455017A737D@Iris.ad.clarku.edu>
Message-ID: <7FA572E4-ECA1-4242-B2BF-E3ECCD9B6741@linfiniti.com>

Hi

I wrote a tool in c++ once to read this and if I recall correctly  
spit out arc/info ascii grid files. Its been a while since I looked  
at it so Ill need to dig it up and recheck exactly what it did. Pete  
can you remember if this is in the climate data processing wizard? I  
have no network access as I write this so I will only be able to  
confirm for you tomorrow what I actually have. Ivan if you still   
have not found a suitable solution and Ill dig out what I have.

Regards

Tim

On 16/06/2006, at 12:08, Ivan Lucena wrote:

> Hi there,
>
>
>
> I would rather been watching the World Cup, but I have to get this  
> data in a usable format and there is no better place to get it than  
> from GDAL?s experts.
>
>
>
> The ?Intergovernmental Panel on Climate Change? (IPCC) offers data  
> on the web in a format described by this Fortran source code: (The  
> file extension is just a generic ?.dat?)
>
>
>
> http://ipcc-ddc.cru.uea.ac.uk/obs/observed_fileformat.html
>
>
>
> > more cpre0130.dat
>
>     grd_sz      xmin      ymin      xmax      ymax    n_cols     
> n_rows  n_months
>
>       0.50      0.25    -89.75    359.75     89.75       720        
> 360        12
>
> ?
>
> -9999-9999-9999-9999-9999-9999-9999-9999-9999   52   88  103   91    
> 65   45   27   32 ?
>
> -9999-9999-9999-9999-9999   11   20   22   25   27   26   27   28    
> 31   29   28   30 ?
>
> ?
>
>
>
> It?s not hard to analyze the pattern on the data or the code, so I  
> figured that:
>
>
>
> - It?s an ASCII format;
>
> - There are two lines of reader (easy to read)
>
> - Each cell is 5 characters wide;
>
> - The no-data is ?-9999?;
>
> - There is no separator between cells (what makes my task difficult);
>
> - It?s a multi-band raster dataset with 12 bands; (720x360x12 cells)
>
> - I am not sure if positive values can go beyond 9999 (that reminds  
> me COBOL)
>
>
>
> I am heading in the direction of writing a Python+GDAL script to do  
> the task, but I am stuck in how to separate the cells. The Fortran  
> code is doing it in just one command as you can see in the code. I  
> am thing that maybe by using the NumPY stuff embedded in GDAL I  
> could do the same.
>
>
>
> Any Idea? Any experience with this data format?
>
>
>
> Thanks in advance,
>
>
>
> Ivan
>
>
>
> -------------------------------------------------------
>
> This is a Python command line interaction with the data:
>
>
>
> >>> import gdal
>
> >>> f = open('C:/Data/IPCC/cpre0130.dat', 'r');
>
> >>> f.readline()
>
> '    grd_sz      xmin      ymin      xmax      ymax    n_cols     
> n_rows  n_months\n'
>
> >>> f.readline()
>
> '      0.50      0.25    -89.75    359.75     89.75       720        
> 360        12\n'
>
> >>> f.readline()
>
> '-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-999 
> 9-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-999 
> 9-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-999 
> 9-9999-9999-9999-9999-9999-9999-9
>
>
>
> -------------------------------------------------------
>
> Fortran source code:
>
>
> program rd_ascii
> !
> ! f90 program to read in an integer ascii grid with
> ! variable dimensions into a global grid (720x360x12)
> !
>   parameter :: n_cols=720
>   parameter :: n_rows=360
>   integer, dimension (n_cols,n_rows,12) :: grid
>   character(len=72) :: infl
>   character(len=20) :: fmt
> !
>   call getarg(1,infl)
> !
>   if(infl.eq.' ')then
>     write(*,*) 'Enter ascii grid file name'
>     read(*,'(a72)')infl
>   end if
> !
>   open(1,file=infl,status='old')
>   read(1,*)
>   read(1,*)xmin,ymin,xmax,ymax,ncols,nrows,nmonths,missing
>   grid=missing
>   fmt='( i5)'
>   write(fmt(2:4),'(i3)')n_cols
>   do im=1,nmonths
>     do lat=1,n_rows
>       read(1,fmt)(grid(lon,lat,im),lon=1,n_cols)
>     enddo
>   enddo
> !
> end program rd_ascii
>
>
>
>
>
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev

Tim Sutton
tim@linfiniti.com



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060618/59831d72/attachment.html
From neteler at itc.it  Mon Jun 19 07:39:04 2006
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] DBF-Column type boolen and date?
In-Reply-To: <449585C5.60501@pobox.com>
References: <20060617173213.GB23778@bartok.itc.it> <449585C5.60501@pobox.com>
Message-ID: <20060619113904.GD9472@bartok.itc.it>

On Sun, Jun 18, 2006 at 12:56:37PM -0400, Frank Warmerdam wrote:
> Markus Neteler wrote:
> >Hi,
> >
> >while updating the DBF driver in GRASS to the latest
> >shapelib version, I came across this proposal:
> >
> >  [postgis-devel] DBF-Column type boolen and date
> >  strk at refractions.net strk at refractions.net
> >  Wed Jan 11 09:59:54 PST 2006
> >  http://postgis.refractions.net/pipermail/postgis-devel/2006-January/001940.html
> >  "Attached is a patch that will implement
> >   support for Date and Bool DBF<->pgsql transfer.
> >   ...
> >  "
> >
> >which was also committed later:
> >  http://postgis.refractions.net/pipermail/postgis-devel/2006-January/001948.html
> >
> >Could this be added to SHAPELIB/OGR as well?
> 
> Markus,
> 
> OGR does not have a boolean field type, so for now we just map boolean 
> fields
> to ... umm, string I guess.  Dates are properly handled in the shapefile
> driver using the native field type api i shapelib.
> 
> There was a proposed patch to add date (and boolean?) support in the 
> shapelib
> bugzilla, but I closed it since this can now be accomplished using the
> native type shapelib functions.
> 
> Did you have a specific requirement for boolean fields?

Frank,

I was thinking moreover about the DATE support in the
GRASS DBF driver:

 http://freegis.org/cgi-bin/viewcvs.cgi/grass6/db/drivers/dbf/globals.h?rev=HEAD&content-type=text/vnd.viewcvs-markup

Currently only FTString, FTInteger, FTDouble are used and
date is mapped to char since FTDate isn't there (but was proposed
by strk). That's why I brought up the issue here.

I am not sure how to change the GRASS DBF driver to better implement
date support (mayeb there is nothing to change?). See line 313 in
http://freegis.org/cgi-bin/viewcvs.cgi/grass6/db/drivers/dbf/dbfexe.c?annotate=1.36

Best regards
 Markus

From Martin.Daly at cadcorp.com  Mon Jun 19 07:39:11 2006
From: Martin.Daly at cadcorp.com (Martin Daly)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Tool to convert shapefile from [-180, 180] to [0,
	360] range
Message-ID: <AA31868BC8CE1B4DB132141A6556A20A0E5C16@dev010_ex.Dev.cadcorp.net>

> I also have an extension to WKT for setting this.  I believe you add
> an entry like EXTENSION["CENTER_LONG",180] as a child of the 
> GEOGCS node.
> I would have mentioned this whole issue here sooner, except 
> that I just
> know that Martin Daly will now rightly jump all over me for corrupting
> the standard WKT format.  I must say, I now regret not having 
> advocated
> on behalf of a vendor specific extension mechanism in the past. :-)

As predicted...

Can you handle any of this with a (standard) FITTED_CS instead of a
(non-standard) EXTENSION?

Martin


From warmerdam at pobox.com  Mon Jun 19 08:50:11 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] DBF-Column type boolen and date?
In-Reply-To: <20060619113904.GD9472@bartok.itc.it>
References: <20060617173213.GB23778@bartok.itc.it> <449585C5.60501@pobox.com>
	<20060619113904.GD9472@bartok.itc.it>
Message-ID: <44969D83.8020702@pobox.com>

Markus Neteler wrote:
> Frank,
> 
> I was thinking moreover about the DATE support in the
> GRASS DBF driver:
> 
>  http://freegis.org/cgi-bin/viewcvs.cgi/grass6/db/drivers/dbf/globals.h?rev=HEAD&content-type=text/vnd.viewcvs-markup
> 
> Currently only FTString, FTInteger, FTDouble are used and
> date is mapped to char since FTDate isn't there (but was proposed
> by strk). That's why I brought up the issue here.
> 
> I am not sure how to change the GRASS DBF driver to better implement
> date support (mayeb there is nothing to change?). See line 313 in
> http://freegis.org/cgi-bin/viewcvs.cgi/grass6/db/drivers/dbf/dbfexe.c?annotate=1.36

Markus,

Some roughly comparable code is in ogrshapelayer.cpp.  As you can
see OFTDate is transferred using DBFAddNativeFieldType() instead of
the DBFAddField() so the specialized date type can be created.


/************************************************************************/
/*                            CreateField()                             */
/************************************************************************/

OGRErr OGRShapeLayer::CreateField( OGRFieldDefn *poField, int bApproxOK )

{
     int         iNewField;
     if( GetFeatureCount(TRUE) != 0 )
     {
         CPLError( CE_Failure, CPLE_NotSupported,
                   "Can't create fields on a Shapefile layer with features.\n");
         return OGRERR_FAILURE;
     }

     if( !bUpdateAccess )
     {
         CPLError( CE_Failure, CPLE_NotSupported,
                   "Can't create fields on a read-only shapefile layer.\n");
         return OGRERR_FAILURE;
     }

     if( poField->GetType() == OFTInteger )
     {
         if( poField->GetWidth() == 0 )
             iNewField =
                 DBFAddField( hDBF, poField->GetNameRef(), FTInteger, 11, 0 );
         else
             iNewField = DBFAddField( hDBF, poField->GetNameRef(), FTInteger,
                                      poField->GetWidth(), 0 );

         if( iNewField != -1 )
             poFeatureDefn->AddFieldDefn( poField );
     }
     else if( poField->GetType() == OFTReal )
     {
         if( poField->GetWidth() == 0 )
             iNewField =
                 DBFAddField( hDBF, poField->GetNameRef(), FTDouble, 24, 15 );
         else
             iNewField =
                 DBFAddField( hDBF, poField->GetNameRef(), FTDouble,
                              poField->GetWidth(), poField->GetPrecision() );

         if( iNewField != -1 )
             poFeatureDefn->AddFieldDefn( poField );
     }
     else if( poField->GetType() == OFTString )
     {
         if( poField->GetWidth() < 1 )
             iNewField =
                 DBFAddField( hDBF, poField->GetNameRef(), FTString, 80, 0 );
         else
             iNewField = DBFAddField( hDBF, poField->GetNameRef(), FTString,
                                      poField->GetWidth(), 0 );

         if( iNewField != -1 )
             poFeatureDefn->AddFieldDefn( poField );
     }
     else if( poField->GetType() == OFTDate )
     {
         iNewField =
             DBFAddNativeFieldType( hDBF, poField->GetNameRef(), 'D', 8, 0 );

         if( iNewField != -1 )
             poFeatureDefn->AddFieldDefn( poField );
     }
     else if( poField->GetType() == OFTDateTime )
     {
         CPLError( CE_Warning, CPLE_NotSupported,
                   "Field %s create as date field, though DateTime requested.\n",
                   poField->GetNameRef() );

         iNewField =
             DBFAddNativeFieldType( hDBF, poField->GetNameRef(), 'D', 8, 0 );

         if( iNewField != -1 )
             poFeatureDefn->AddFieldDefn( poField );
     }
     else
     {
         CPLError( CE_Failure, CPLE_NotSupported,
                   "Can't create fields of type %s on shapefile layers.\n",
                   OGRFieldDefn::GetFieldTypeName(poField->GetType()) );

         return OGRERR_FAILURE;
     }

     if( iNewField != -1 )
         return OGRERR_NONE;
     else
     {
         CPLError( CE_Failure, CPLE_AppDefined,
                   "Can't create field %s in Shape DBF file, reason unknown.\n",
                   poField->GetNameRef() );

         return OGRERR_FAILURE;
     }
}


-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From warmerdam at pobox.com  Mon Jun 19 08:45:36 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Tool to convert shapefile from [-180, 180] to [0, 360]
	range
In-Reply-To: <AA31868BC8CE1B4DB132141A6556A20A0E5C16@dev010_ex.Dev.cadcorp.net>
References: <AA31868BC8CE1B4DB132141A6556A20A0E5C16@dev010_ex.Dev.cadcorp.net>
Message-ID: <44969C70.8020506@pobox.com>

Martin Daly wrote:
>> I also have an extension to WKT for setting this.  I believe you add
>> an entry like EXTENSION["CENTER_LONG",180] as a child of the 
>> GEOGCS node.
>> I would have mentioned this whole issue here sooner, except 
>> that I just
>> know that Martin Daly will now rightly jump all over me for corrupting
>> the standard WKT format.  I must say, I now regret not having 
>> advocated
>> on behalf of a vendor specific extension mechanism in the past. :-)
> 
> As predicted...
> 
> Can you handle any of this with a (standard) FITTED_CS instead of a
> (non-standard) EXTENSION?

Martin,

I have spent a few minutes refamiliarizing myself with the more esoteric
parts of 01-009.  It would be possible in theory to use FITTED_CS with
a custom parameterized transformation.  But this would hugely change
and complicate the internal representation and I can't predict how much
that would mess up parts of GDAL/OGR, much less what would happen if I
ended up trying to write this out for use in another system.

One can hope that extra entries like EXTENSION would just be ignored by
most non-recognizing systems.  But a FITTED_CS would most likely just
cause unsuspecting software to give up.

To be honest, I always pretty much ignored the parts of 01-009 for
describing transformations, including the FITTED_CS.  My highest
aspiration with regard to WKT is to add support for COMPD_CS and
GEOCCS and to handle the AXIS keyword properly.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From warmerdam at pobox.com  Mon Jun 19 09:02:25 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Level 2 caching mechanism question
In-Reply-To: <7221db410606190114l5e3844bcnd61f3a0d99cceda9@mail.gmail.com>
References: <7221db410606190114l5e3844bcnd61f3a0d99cceda9@mail.gmail.com>
Message-ID: <4496A061.2090508@pobox.com>

Daniele Romagnoli wrote:
> Hi guys.
> I'm writing a brief report on some GDAL capabilities and I would want to 
> know if I have correctly understood the level 2 caching mechanism.
> 
> Anyone can briefly summarize to me, how such a mechanism works as well 
> as its advantages?
> 
> Maybe, I have found the answer by analyzing GDAL sourcecode (IRasterIO 
> method and Co.).  (As an instance, If there are more than 64 blocks in a 
> row, then the sub blocking is activated by grouping 64 blocks at once in 
> greater subblocks...)
> 
> But I would like to have a better vision of the mechanism prior to write 
> wrong things.
> Anyone could help me please?

Daniele,

Conceptually GDAL has a single level block cache.  However, for large files
with small blocks there can be a lot of blocks.  So many that maintaining
a single pointer to each block can get quite expensive in memory.

To avoid that the caching code maintains a two level data structure when
there are large numbers of blocks - well really any time the image is more
than 64 blocks wide.  The first level of the datastructure keeps a pointer
to each 64x64 subgroup of block pointers with the high level pointer being
NULL if the subarea has never been touched allowing 4096 blocks to be
represented by a single pointer if the region is not processed.

This two level data structure was implemented mainly to support Erdas
Imagine files in the 100+ GB range efficiently.  Imagine files typically
have fairly small blocks (64pixels x 64lines) so big files can have a lot
of blocks.

But I want to stress that this is not a "two level cache" in the sense
that computer processors have two levels of memory.  That is to say there
isn't a "fast cache" and "slow cache".  Just a two level data structure to
track a one level cache.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From ILucena at clarku.edu  Mon Jun 19 10:07:32 2006
From: ILucena at clarku.edu (Ivan Lucena)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] IPCC raster format
Message-ID: <6FD7C9DB26540B42A1207C69BF92D455017A790F@Iris.ad.clarku.edu>

Hi Tim,

I was about to write to Frank Warmerdam and Christopher Baker to say thanks for their suggestions.

Mine implementation works like that:

$ ipcc2gdal -of <writable driver> <input file> <output file "prefix">

Example:

$ ipcc2gdal -of gtiff cpre0130.dat cpre0130.tif
cpre0130_1.tif
cpre0130_2.tif
cpre0130_3.tif
cpre0130_4.tif
cpre0130_5.tif
cpre0130_6.tif
cpre0130_7.tif
cpre0130_8.tif
cpre0130_9.tif
cpre0130_10.tif
cpre0130_11.tif
cpre0130_12.tif

So thanks everybody,

Ivan 

________________________________________
From: Tim Sutton [mailto:timlinuxgis@gmail.com] On Behalf Of Tim Sutton
Sent: 18 June 2006 19:27
To: Ivan Lucena; Peter Brewer
Cc: Tim Sutton; gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] IPCC raster format

Hi

I wrote a tool in c++ once to read this and if I recall correctly spit out arc/info ascii grid files. Its been a while since I looked at it so Ill need to dig it up and recheck exactly what it did. Pete can you remember if this is in the climate data processing wizard? I have no network access as I write this so I will only be able to confirm for you tomorrow what I actually have. Ivan if you still? have not found a suitable solution and Ill dig out what I have.

Regards

Tim

On 16/06/2006, at 12:08, Ivan Lucena wrote:


Hi there,
?
I would rather been watching the World Cup, but I have to get this data in a usable format and there is no better place to get it than from GDAL's experts.
?
The "Intergovernmental Panel on Climate Change" (IPCC) offers data on the web in a format described by this Fortran source code: (The file extension is just a generic ".dat")
?
http://ipcc-ddc.cru.uea.ac.uk/obs/observed_fileformat.html
?
> more cpre0130.dat
??? grd_sz????? xmin????? ymin????? xmax????? ymax??? n_cols??? n_rows? n_months
????? 0.50????? 0.25??? -89.75??? 359.75???? 89.75?????? 720?????? 360??????? 12
...
-9999-9999-9999-9999-9999-9999-9999-9999-9999?? 52?? 88? 103?? 91?? 65?? 45?? 27?? 32 ...
-9999-9999-9999-9999-9999?? 11?? 20?? 22?? 25?? 27?? 26?? 27?? 28?? 31 ??29 ??28 ??30 ...
...
?
It's not hard to analyze the pattern on the data or the code, so I figured that:
?
- It's an ASCII format;
- There are two lines of reader (easy to read)
- Each cell is 5 characters wide;
- The no-data is "-9999";
- There is no separator between cells (what makes my task difficult);
- It's a multi-band raster dataset with 12 bands; (720x360x12 cells)
- I am not sure if positive values can go beyond 9999 (that reminds me COBOL)
?
I am heading in the direction of writing a Python+GDAL script to do the task, but I am stuck in how to separate the cells. The Fortran code is doing it in just one command as you can see in the code. I am thing that maybe by using the NumPY stuff embedded in GDAL I could do the same.
?
Any Idea? Any experience with this data format?
?
Thanks in advance,
?
Ivan
?
-------------------------------------------------------
This is a Python command line interaction with the data:
?
>>> import gdal
>>> f = open('C:/Data/IPCC/cpre0130.dat', 'r');
>>> f.readline()
'??? grd_sz????? xmin????? ymin????? xmax????? ymax??? n_cols??? n_rows? n_months\n'
>>> f.readline()
'????? 0.50????? 0.25??? -89.75??? 359.75???? 89.75?????? 720?????? 360??????? 12\n'
>>> f.readline()
'-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9
?
-------------------------------------------------------
Fortran source code:
?
program rd_ascii?????? 
!
! f90 program to read in an integer ascii grid with
! variable dimensions into a global grid (720x360x12)
!
? parameter :: n_cols=720
? parameter :: n_rows=360
? integer, dimension (n_cols,n_rows,12) :: grid
? character(len=72) :: infl
? character(len=20) :: fmt
!
? call getarg(1,infl)
!?????? 
? if(infl.eq.' ')then
??? write(*,*) 'Enter ascii grid file name'
??? read(*,'(a72)')infl
? end if
!?????? 
? open(1,file=infl,status='old')
? read(1,*)
? read(1,*)xmin,ymin,xmax,ymax,ncols,nrows,nmonths,missing
? grid=missing
? fmt='( i5)'
? write(fmt(2:4),'(i3)')n_cols
? do im=1,nmonths
??? do lat=1,n_rows
????? read(1,fmt)(grid(lon,lat,im),lon=1,n_cols)
??? enddo
? enddo
!?????? 
end program rd_ascii
?
?
?
_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev

Tim Sutton
tim@linfiniti.com






From dany.geotools at gmail.com  Mon Jun 19 11:24:15 2006
From: dany.geotools at gmail.com (Daniele Romagnoli)
Date: Wed Nov 21 11:50:13 2007
Subject: Fwd: [Gdal-dev] Level 2 caching mechanism question
In-Reply-To: <7221db410606190819n3a88b190t55f22349056c1960@mail.gmail.com>
References: <7221db410606190114l5e3844bcnd61f3a0d99cceda9@mail.gmail.com>
	<4496A061.2090508@pobox.com>
	<7221db410606190700m30be375u9e7e6812a47ecffd@mail.gmail.com>
	<7221db410606190819n3a88b190t55f22349056c1960@mail.gmail.com>
Message-ID: <7221db410606190824w276112ean3fa16f96c898e82b@mail.gmail.com>

Post Scriptum to my previous email:

I'm working in the Summer of Code with the Refractions Research, having
Simone Giannecchini as my Mentor.
My purpose is encapsulating the GDAL library within the ImageIO Java tools,
by using SWIG java bindings.

In such a way, we can exploit the Java ImageIO plugins within the GeoTools
grid coverage plugins, in order to access (read and write) many coverage
formats.

Probably, we need to modify the bindings to handle tile management.
As an instance, we need to add a binding for retrieving the chunk size.

In such a manner, within the ImageIO plugin, we can know the rasterband
block size and set the tilesize of the Image to this value.
This allows to use powerfull features of JAI ImageIO toolkit, as the tile
caching and the tile scheduling mechanismes, with great efficiency because
the data accesses will be performed in compliance with the rasterband
natural access size which  represents the more efficient chunk access size,
as stated in the GDAL Data Model.

Regards,
Daniele
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060619/92a598cb/attachment.html
From warmerdam at pobox.com  Mon Jun 19 12:31:05 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:13 2007
Subject: Fwd: [Gdal-dev] Level 2 caching mechanism question
In-Reply-To: <7221db410606190824w276112ean3fa16f96c898e82b@mail.gmail.com>
References: <7221db410606190114l5e3844bcnd61f3a0d99cceda9@mail.gmail.com>	
	<4496A061.2090508@pobox.com>	
	<7221db410606190700m30be375u9e7e6812a47ecffd@mail.gmail.com>	
	<7221db410606190819n3a88b190t55f22349056c1960@mail.gmail.com>
	<7221db410606190824w276112ean3fa16f96c898e82b@mail.gmail.com>
Message-ID: <4496D149.4070507@pobox.com>

Daniele Romagnoli wrote:
> Post Scriptum to my previous email:
>  
> I'm working in the Summer of Code with the Refractions Research, having 
> Simone Giannecchini as my Mentor.
> My purpose is encapsulating the GDAL library within the ImageIO Java 
> tools, by using SWIG java bindings.
> 
> In such a way, we can exploit the Java ImageIO plugins within the 
> GeoTools grid coverage plugins, in order to access (read and write) many 
> coverage formats.
> 
> Probably, we need to modify the bindings to handle tile management.
> As an instance, we need to add a binding for retrieving the chunk size. 

Daniele,

I concur that the GDALRasterBand::GetBlockSize() method needs to be
exposed via SWIG.  I hadn't realized this was missing.  Likely the
way to do this would be to expose these values as XBlockSize and
YBlockSize attributes or something similar.

I think this would be a task I could handle if you need it, though I'm
not really too savvy about some of the fancier swig issues.

> In such a manner, within the ImageIO plugin, we can know the rasterband 
> block size and set the tilesize of the Image to this value.
> This allows to use powerfull features of JAI ImageIO toolkit, as the 
> tile caching and the tile scheduling mechanismes, with great efficiency 
> because the data accesses will be performed in compliance with the 
> rasterband natural access size which  represents the more efficient 
> chunk access size, as stated in the GDAL Data Model.

There are also methods on the GDALRasterBand intended to be a more
efficient way of fetching on block boundaries.  However, I would discourage
trying to expose these through swig.  Instead I would encourage doing
regular RasterIO() calls on block boundaries.  This is certain to work
well for all drivers, and should have nearly the same performance as the
specialized block methods.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From mateusz at loskot.net  Mon Jun 19 23:01:43 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] OGR can't handle Null values in a Date field
In-Reply-To: <44933240.3090703@pobox.com>
References: <1319fbba0606161402t240c8dd0u4f34c5e8148ef340@mail.gmail.com>
	<44933240.3090703@pobox.com>
Message-ID: <44976517.7060203@loskot.net>

Frank Warmerdam wrote:
> Aaron Koning wrote:
>> I have just started using a newer version of OGR that includes Date
>> support. (Context: I am importing shapefiles into PostgreSQL using
>> OGR/PHP). Unfortunately, when I there is a Null value in a Date field
>> of the input shapefile OGR bails (after successfully inserting
>> non-null values). From what I can see, it attempts to do an insert
>> with a '00/00/00 00:00:00' value and PostgreSQL states I may need
>> another Date type for this value.
>>
>> Is there anyway of getting OGR to output Null values into a Date field
>> when there is a Null value present in the input Date field?
>> Alternatively, the previous versions of OGR simply converted Date
>> fields to strings. Is there a way to revive this action (when I set
>> the output field type to string instead of bool, it doesn't work).
> 
> Aaron,
> 
> Date fields are intended to support nulls.  Could you provide me
> with a shapefile with some null dates I could test with?  I think there
> is just a bug at some point in the code with null propogation in date
> fields.

Frank,

As we talked on the #gdal-dev, I'm taking this bug.

Aaron,

As Frank is asking above, please provide me with some sample of your
shapefiles. Thanks!

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From digar at esw.rwth-aachen.de  Tue Jun 20 01:04:17 2006
From: digar at esw.rwth-aachen.de (Jan)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Re: Problem with GDALWARP - very fast to solve
Message-ID: <003401c69426$fc117b30$8788e289@digar>

There seems to be still a problem with my versions of gdalwarp. I use
precompiled binaries from Fw-Tools 0.9.9 and 1.0.0. Both versions still say
to me that it can not be converted because of to many error and that it is
still not able to compute the right output bounds

ERROR 1: Too many points (441 out of 441) failed to transform,
unable to compute output bounds.

A real problem seems to be, that if a file with the name is already
existent, the call of gdalwarp will not give out any errors, but will not
change the target mage in any way.

It would be really great if you could help me again or perhaps give me an
idea how else i could transform images from degree to meters. My time gets
quite short, because I have to finish my program in the next two weeks for
my university course, and that part is the missing thing in it.

Greetings
Jan

"Jan B." <digar@gmx.net> schrieb im Newsbeitrag
news:000e01c68fbb$f4fe2330$8788e289@digar...
>I have again a small problem with the gdalwarp command line tool.
>
> I try to convert the file, which you can find under :
>
> www.esw.rwth-aachen.de/n56e010.bil
>
> with the following command into the UTM System:
>
> gdalwarp -t_srs "+proj=utm +zone=11 +datum=WGS84" n56e010.bil test.tif
>
> But it always says that too many points failed to transform. What would be 
> the correct command ???
>
> Greetings (and hopefully I have specified the problem this time enought)
>
> Jan Beiten


"Jan B." <digar@gmx.net> schrieb im Newsbeitrag
news:000e01c68fbb$f4fe2330$8788e289@digar...
>I have again a small problem with the gdalwarp command line tool.
>
> I try to convert the file, which you can find under :
>
> www.esw.rwth-aachen.de/n56e010.bil
>
> with the following command into the UTM System:
>
> gdalwarp -t_srs "+proj=utm +zone=11 +datum=WGS84" n56e010.bil test.tif
>
> But it always says that too many points failed to transform. What would be 
> the correct command ???
>
> Greetings (and hopefully I have specified the problem this time enought)
>
> Jan Beiten


"Jan B." <digar@gmx.net> schrieb im Newsbeitrag 
news:000e01c68fbb$f4fe2330$8788e289@digar...
>I have again a small problem with the gdalwarp command line tool.
>
> I try to convert the file, which you can find under :
>
> www.esw.rwth-aachen.de/n56e010.bil
>
> with the following command into the UTM System:
>
> gdalwarp -t_srs "+proj=utm +zone=11 +datum=WGS84" n56e010.bil test.tif
>
> But it always says that too many points failed to transform. What would be 
> the correct command ???
>
> Greetings (and hopefully I have specified the problem this time enought)
>
> Jan Beiten 





From ari.jolma at tkk.fi  Tue Jun 20 03:31:53 2006
From: ari.jolma at tkk.fi (Ari Jolma)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Using OSR methods from bindings
In-Reply-To: <1150486503.28798.95.camel@localhost.localdomain>
References: <448D3E1B.6080400@tkk.fi>
	<20060614093306.GQ7890@earth.overmeer.net> <448FFD3C.90301@tkk.fi>
	<1150486503.28798.95.camel@localhost.localdomain>
Message-ID: <4497A469.8070706@tkk.fi>

This is Perl but the case should be similar for all swig languages. This 
is the beginning of my review of the OSR methods in the swig interface.

> print $srs->GetLinearUnits()
> 1
>   

The returned value is the value to multiply by linear distances to 
transform them to meters. In this case the linear units are meters, so 
the multiplication factor is 1.

> print $srs->SetLinearUnits("mi")
> RuntimeError Usage:
> SpatialReference_SetLinearUnits(self,name,to_meters);
>   

There is a bug in the bindings: SetLinearUnits calls SetAngularUnits. 
When this is fixed, the call is for example: 
$srs->SetLinearUnits($osr::SRS_UL_FOOT, $osr::SRS_UL_FOOT_CONV)

> p osr::GetWellKnownGeogCSAsWKT($osr::SRS_PT_ALBERS_CONIC_EQUAL_AREA)
> (null return)
>   
I suspect $osr::SRS_PT_ALBERS_CONIC_EQUAL_AREA, which is the string 
'Albers_Conic_Equal_Area' is not a valid argument. For example

print osr::GetWellKnownGeogCSAsWKT('EPSG:4326'),"\n";

Returns a valid WKT.

-- 
Prof. Ari Jolma
Kartografia ja Geoinformatiikka / Cartography and Geoinformatics
Teknillinen Korkeakoulu / Helsinki University of Technology
tel: +358 9 451 3886 address: POBox 1200, 02015 TKK, Finland
Email: ari.jolma at tkk.fi URL: http://www.tkk.fi/~jolma


From m.massing at warped-space.de  Tue Jun 20 06:17:52 2006
From: m.massing at warped-space.de (Manuel Massing)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Re: Problem with GDALWARP - very fast to solve
In-Reply-To: <003401c69426$fc117b30$8788e289@digar>
References: <003401c69426$fc117b30$8788e289@digar>
Message-ID: <200606201217.52154.m.massing@warped-space.de>

Hello Jan,

> www.esw.rwth-aachen.de/n56e010.bil

it would be helpful if you could also provide the associated
.hdr and .prj files.

cheers,

	Manuel

From m.massing at warped-space.de  Tue Jun 20 07:22:40 2006
From: m.massing at warped-space.de (Manuel Massing)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Re: Problem with GDALWARP - very fast to solve
In-Reply-To: <200606201217.52154.m.massing@warped-space.de>
References: <003401c69426$fc117b30$8788e289@digar>
	<200606201217.52154.m.massing@warped-space.de>
Message-ID: <200606201322.40479.m.massing@warped-space.de>

Hello Jan,

> > www.esw.rwth-aachen.de/n56e010.bil
>
> it would be helpful if you could also provide the associated
> .hdr and .prj files.

in fact, the problem seems to be your target projection definition. The 
srtm tile you specify resides in utm zone 32 (not 11), so you should try 

	gdalwarp -s_srs "+proj=latlong +datum=WGS84" \
                 -t_srs "+proj=utm +zone=32 +datum=WGS84" \
	         n56e010.bil test.tif

with the attached .hdr file. Works for me.

bye,
	Manuel
-------------- next part --------------
A non-text attachment was scrubbed...
Name: n56e010.hdr
Type: image/x-hdr
Size: 326 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060620/96a5b325/n56e010.bin
From tfagin at coordinatesolutions.com  Tue Jun 20 11:45:58 2006
From: tfagin at coordinatesolutions.com (Todd Fagin)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] GDALWARP issues
Message-ID: <000001c69480$a1eee2f0$6e0ba8c0@TFD620>

Greetings GDAL list,

 

I am quite new to GDAL, so please excuse my general ignorance about all
things GDAL, as well as my frustration with this ongoing problem.

 

Currently, I am trying to reproject some Mr.SID images from UTM NAD83 to
USGS Albers.  Seems easy enough and it should be.  In fact, I have had a
great deal of success doing it with GDAL.  And that's the problem.
Sometimes it works perfectly, other times not at all.  If things
consistently failed, then I would know that the problem was with me.
However, since it works intermittently, I am completely perplexed.  

 

Below are two examples of what I am trying to do.  In both instances, I have
succeeded before and failed before.  When gdalwarp fails, I get a Widows
error telling me that "gdalwarp.exe has encountered a problem and needs to
close." On that note, I should add, I am running XP pro with all service
packs installed.

 

Example one-straightforward gdalwarp with no target extent specified:

 

gdalwarp -s_srs "ESRI::UTM14_83.prj" -t_srs "ESRI::USGSAlbers.prj" -of GTIFF
-co "TFW=YES" "c:\DOQ\36096b12.sid" "c:\DOQ\b12.tif"

 

Example two-gdalwarp with target extent defined.  

 

gdalwarp -s_srs "ESRI::UTM14_83.prj" -t_srs "ESRI::USGSAlbers.prj" -te
-66701.437329 1536254.54245 -54947.405852 1550909.99892 -of GTIFF -co
"TFW=YES" "c:\UTM\county.sid" "c:\Al_TIFF\quad2.tif"

 

Thanks in advance for any advice/input.

 

Todd Fagin

 

Coordinate Solutions, Inc.

501 N.E. 15th St.

Oklahoma City, OK 73104

405.246.9396 (Voice)

405.227.0781 (Fax)

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060620/35fc9b36/attachment.html
From c_pennock at yahoo.com  Tue Jun 20 15:01:30 2006
From: c_pennock at yahoo.com (Chris Pennock)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] (no subject)
In-Reply-To: <200606201217.52154.m.massing@warped-space.de>
Message-ID: <20060620190130.27178.qmail@web51907.mail.yahoo.com>

Hi all,

Merging dems seems like a common task, but I
cannot find a way to do it well using gdal. Is there a
best practice I should be aware of?

I realize that there will always be gaps between dems,
which must be fixed afterward (thanks Craig and Ben),
but what is the best way to merge the dems together,
with "clean" NODATA edges, so that the gaps can
be filled?

The problem I run into is that warping with "-rcs" for
cubic spline resampling, which looks best, leaves the
edges of the dem "rounded off". E.g. if the data
should be:

1000, 1000, 1000, NODATA, NODATA

I get instead:

1000, 1000, -400, -5000, NODATA

And so I don't have clean cut offs from data to
NODATA, which makes gap filling challenging.



Any help would be much appreciated.

Thanks,
Chris

__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
http://mail.yahoo.com 

From c_pennock at yahoo.com  Tue Jun 20 15:01:42 2006
From: c_pennock at yahoo.com (Chris Pennock)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Merging Dems
In-Reply-To: <200606201217.52154.m.massing@warped-space.de>
Message-ID: <20060620190143.99772.qmail@web51905.mail.yahoo.com>

Hi all,

Merging dems seems like a common task, but I
cannot find a way to do it well using gdal. Is there a
best practice I should be aware of?

I realize that there will always be gaps between dems,
which must be fixed afterward (thanks Craig and Ben),
but what is the best way to merge the dems together,
with "clean" NODATA edges, so that the gaps can
be filled?

The problem I run into is that warping with "-rcs" for
cubic spline resampling, which looks best, leaves the
edges of the dem "rounded off". E.g. if the data
should be:

1000, 1000, 1000, NODATA, NODATA

I get instead:

1000, 1000, -400, -5000, NODATA

And so I don't have clean cut offs from data to
NODATA, which makes gap filling challenging.



Any help would be much appreciated.

Thanks,
Chris

__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
http://mail.yahoo.com 

From c_pennock at yahoo.com  Tue Jun 20 15:58:22 2006
From: c_pennock at yahoo.com (Chris Pennock)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Merging Dems
In-Reply-To: <000f01c6949d$5af52770$6e0ba8c0@TFD620>
Message-ID: <20060620195822.51766.qmail@web51907.mail.yahoo.com>

Todd,

Thanks for the reply. I should have said that I *am*
using gdal_merge to merge the dems. The problem is
that I am warping them before the merge, which
"rounds" the edges of the dem, making it hard to fill
the gaps later.

Unless you're implying that I should just use
gdal_merge on the dems directly... but then I can't
specify the resolution I need with a nice resampling
algorithm like -rcs. Furthermore, merging dems
directly introduces some oddly shaped gaps between
dems that led me to believe that it was the "wrong
way" to do things.

How do you typically merge dems into one large
heightmap?

Thanks for the pointer to those dem utils!

Chris

--- Todd Fagin <tfagin@coordinatesolutions.com> wrote:

> GDAL_MERGE is probably the way to go to merge the
> DEMs.  Recently, though, I
> found this site, which has some nifty DEM tools for
> GDAL:
> 
>  
> 
> http://www.perrygeo.net/wordpress/?p=7
> 
>  
> 
> Todd Fagin
> 
>  
> 
>  
> 
>  
> 
>  
> 
> -----Original Message-----
> From: gdal-dev-bounces@lists.maptools.org
> [mailto:gdal-dev-bounces@lists.maptools.org] On
> Behalf Of Chris Pennock
> Sent: Tuesday, June 20, 2006 2:02 PM
> To: gdal-dev@lists.maptools.org
> Subject: [Gdal-dev] Merging Dems
> 
>  
> 
> Hi all,
> 
>  
> 
> Merging dems seems like a common task, but I
> 
> cannot find a way to do it well using gdal. Is there
> a
> 
> best practice I should be aware of?
> 
>  
> 
> I realize that there will always be gaps between
> dems,
> 
> which must be fixed afterward (thanks Craig and
> Ben),
> 
> but what is the best way to merge the dems together,
> 
> with "clean" NODATA edges, so that the gaps can
> 
> be filled?
> 
>  
> 
> The problem I run into is that warping with "-rcs"
> for
> 
> cubic spline resampling, which looks best, leaves
> the
> 
> edges of the dem "rounded off". E.g. if the data
> 
> should be:
> 
>  
> 
> 1000, 1000, 1000, NODATA, NODATA
> 
>  
> 
> I get instead:
> 
>  
> 
> 1000, 1000, -400, -5000, NODATA
> 
>  
> 
> And so I don't have clean cut offs from data to
> 
> NODATA, which makes gap filling challenging.
> 
>  
> 
>  
> 
>  
> 
> Any help would be much appreciated.
> 
>  
> 
> Thanks,
> 
> Chris
> 
>  
> 
> __________________________________________________
> 
> Do You Yahoo!?
> 
> Tired of spam?  Yahoo! Mail has the best spam
> protection around 
> 
> http://mail.yahoo.com 
> 
> _______________________________________________
> 
> Gdal-dev mailing list
> 
> Gdal-dev@lists.maptools.org
> 
> http://lists.maptools.org/mailman/listinfo/gdal-dev
> 
> 


__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
http://mail.yahoo.com 

From rdespain at harris.com  Tue Jun 20 16:14:53 2006
From: rdespain at harris.com (DeSpain, Ronald)
Date: Wed Nov 21 11:50:13 2007
Subject: [gdal-dev] GDAL Documentation
Message-ID: <33E9C96E5F4538409B0B533B74953E360170F19C@mlbe2k4.cs.myharris.net>

What happened to the 
 
"somewhat useful GDAL documentation at:"     :-)

http://gdal.velocet.ca/projects/gdal/html/heirarchy.html
<http://gdal.velocet.ca/projects/gdal/html/heirarchy.html> 

The link is broken.
 
Ron
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060620/83d4f523/attachment.html
From rayg at daylongraphics.com  Tue Jun 20 18:26:37 2006
From: rayg at daylongraphics.com (Ray Gardener)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Merging Dems
In-Reply-To: <20060620190143.99772.qmail@web51905.mail.yahoo.com>
References: <20060620190143.99772.qmail@web51905.mail.yahoo.com>
Message-ID: <4498761D.1060600@daylongraphics.com>

That's actually a common problem in sampling algorithms. LucasFilm, 
e.g., supports overpadded images in OpenEXR to let digital filters use 
their kernels without having to subtract kernel pixels outside the image 
(letting them run faster; less conditional logic, less branch 
misprediction stalls). If GDAL's sampler isn't taking edges into account 
properly, an option would be to prepad the DEM with repeated edge pixels 
and then crop it afterwards.

That won't solve void pixels inside the DEM (holes), and if those are a 
problem, the sampler process has to be adjusted.

Ray


Chris Pennock wrote:
> Hi all,
> 
> Merging dems seems like a common task, but I
> cannot find a way to do it well using gdal. Is there a
> best practice I should be aware of?
> 
> I realize that there will always be gaps between dems,
> which must be fixed afterward (thanks Craig and Ben),
> but what is the best way to merge the dems together,
> with "clean" NODATA edges, so that the gaps can
> be filled?
> 
> The problem I run into is that warping with "-rcs" for
> cubic spline resampling, which looks best, leaves the
> edges of the dem "rounded off". E.g. if the data
> should be:
> 
> 1000, 1000, 1000, NODATA, NODATA
> 
> I get instead:
> 
> 1000, 1000, -400, -5000, NODATA
> 
> And so I don't have clean cut offs from data to
> NODATA, which makes gap filling challenging.
> 
> 
> 
> Any help would be much appreciated.
> 
> Thanks,
> Chris
> 
> __________________________________________________
> Do You Yahoo!?
> Tired of spam?  Yahoo! Mail has the best spam protection around 
> http://mail.yahoo.com 
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
> 
> 

From mateusz at loskot.net  Tue Jun 20 19:06:36 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] [ANN] OGRPolygon::IsPointOnSurface()
Message-ID: <44987F7C.5040904@loskot.net>

Hi,

Yesterday, on Frank's request, I added two new functions to OGR
Geometry API:
OGRPolygon::IsPointOnSurface
OGRLinearRing::isPointInRing

The isPointInRing function tests if given point is inside
the lienar ring. The test is implemented as a common point-in-polygon
algorithm called as a "Ray casting" or "Crossing numbers" algorithm.

I'd like to ask for a bit of testing.
Comments are welcome too.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From warmerdam at pobox.com  Wed Jun 21 10:23:51 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Merging Dems
In-Reply-To: <20060620190143.99772.qmail@web51905.mail.yahoo.com>
References: <20060620190143.99772.qmail@web51905.mail.yahoo.com>
Message-ID: <44995677.3060408@pobox.com>

Chris Pennock wrote:
> Hi all,
> 
> Merging dems seems like a common task, but I
> cannot find a way to do it well using gdal. Is there a
> best practice I should be aware of?
> 
> I realize that there will always be gaps between dems,
> which must be fixed afterward (thanks Craig and Ben),
> but what is the best way to merge the dems together,
> with "clean" NODATA edges, so that the gaps can
> be filled?
> 
> The problem I run into is that warping with "-rcs" for
> cubic spline resampling, which looks best, leaves the
> edges of the dem "rounded off". E.g. if the data
> should be:
> 
> 1000, 1000, 1000, NODATA, NODATA
> 
> I get instead:
> 
> 1000, 1000, -400, -5000, NODATA
> 
> And so I don't have clean cut offs from data to
> NODATA, which makes gap filling challenging.

Chris,

Could you provide a couple nearby DEMs and the exact command you
use to merge them?  Gdalwarp tries hard to be careful about what
pixels are incorporated into interpolation kernels.  That is
recognised nodata pixels should not be included, and the interpolation
kernel should be updated accordingly.

I *suspect* the appropriate level of gdalwarp is not recognising the
nodata values which could be a local code flaw, or a lack of proper
global nodata information.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From richard.matsunaga at waypointinfo.com  Wed Jun 21 10:32:35 2006
From: richard.matsunaga at waypointinfo.com (Richard Matsunaga)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] MapInfo style string
Message-ID: <001801c6953f$89fd1260$cd01a8c0@Maddog>

In the course of my memory leak investigation, I noticed that using a style
string with MapInfo is a very finicky beast. If your string is not formed
correctly, it does not get caught when you set the string, but rather it
crashes later when you create the feature on the layer.
 
Can this be improved to parse the string better or at least return an error
gracefully?
 
Cheers,
Richard
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060621/bdec4ec2/attachment.html
From richard.matsunaga at waypointinfo.com  Wed Jun 21 10:26:45 2006
From: richard.matsunaga at waypointinfo.com (Richard Matsunaga)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] memory leak in MapInfo layer
In-Reply-To: <44900219.9060209@loskot.net>
Message-ID: <001501c6953e$ba78aea0$cd01a8c0@Maddog>

After days of pain and suffering and ultimately, barking up all the wrong
trees, I found the source of the memory leak.

I created a stripped-down-to-basics C# version of a program that writes
point symbols to a MapInfo file. I also created an identical C program.

I used DevPartner 8.1 to analyze both programs. It detects numerous leaks in
gdal, but based on Mateusz's comments and other odd results reported by
DevPartner, I am not putting too much faith in those results.

After all this, it turns out that OGR_F_SetStyleString() is the source of
the leak (or more accurately, when the feature is created on the layer
itself - hence the lack leak if the geometry is never added to the feature).
This is evident in both C and the C# versions of the programs, but for some
reason is greatly exaggerated in C#. For example, when I generate the same
layer repeatedly, it consumes a 100+ kB for each iteration in C. But in C#,
it consumes 2+ MB of memory for each iteration. I can't explain that, but
maybe has something to do with strdup and how the new buffer size is
computed when passed a reference to a C# string type? Doesn't sound right.

The root cause appears to be *poStyleMGr not being deleted (there are other
methods in the same file that do the same thing):

void ITABFeatureSymbol::SetSymbolFromStyleString(const char *pszStyleString)
{
...
	OGRStyleMgr *poStyleMgr = new OGRStyleMgr(NULL);
...
}

Cheers,
Richard

-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Mateusz Loskot
Sent: June 14, 2006 8:33 AM
To: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] memory leak in MapInfo layer

Richard Matsunaga wrote:
> Hi Mateusz,
> 
> Here is a sample of the code I am using. I have removed non-OGR 
> related details. For those who may not know, the 'using' statement is  
> used to force Dispose to be called once out of scope of the using 
> statement.


Yes, but OgrSpatialReference class is not disposable, so how did you manage
to put it in using?

VC# 2005 throws me this message:
error CS1674: 'GDALWrapper.OGR.OgrSpatialReference': type used in a using
statement must be implicitly convertible to 'System.IDisposable'

Or I have old version (from the beginning of May 2006) of your GDALWrapper?


> The C# wrapper is basically the same as the one I sent out some time  
> ago, although there have been changes - extended functionality, bug  
> fixes and some unrelated memory issues caused by the wrapper itself.
>  I can send this out again if that would help. I am fairly confident  
> at this point that the wrapper is not the cause of the leak, but since 
> I am far from being a platform invoke expert, there is a, of course, 
> chance that some unexpected behaviour with the wrapper is the  cause.


The best way to check is to implement the same functionality in C++
correctly and see if this also will leak.
It should be not very hard to get ESRI Shapefile/MapInfo File driver, create
datasource, create one layer.


> I am not using any high tech means to detect memory leaks. I run the  
> code below in a loop and watch the system memory climb and climb.
> The .NET garbage collection can be a finicky thing to an outside 
> observer such as myself, but it will not allow the system to run out 
> of memory unless there is a leak of some kind, and that can be a 
> problem with managed resources or unmanaged code. I have run a few 
> .NET memory profilers and they have not found any problems. There is 
> another commercial product that I have not tried (yet) that is able to 
> instrument both managed and unmanaged code for memory profiling.


I checked the creation of data source  with .NET Memory Profiler and also
watching the memory usage in the tasks list.
I don't see huge increase of memory consuming.
I mean, 1000 layers (1000 x data source, driver, layer objects) gave me
about 2 MB memory usage.
Also the .NET Profiler reports the same number of objects created and
disposed of all classes I used.

I got problems with CreateLayer for Shapefile.
Calling OGR OGR_DS_CreateLayer gave me memory corruption.
I tried various parameters, null checking, etc.
I have no idea what's going wrong there.

But I've shown you, Valgrind on Linux does not show any memory issues with
ogr2ogr - a C++ program using OGR.
Unfortunately, I don't have any other bounds checker on Windows than
debuggers coming with VC++ and VC# 2005.

May be you could do some tests as simple as possible:
- create and add single field
- create and add single point (geometry) to feature etc.

This way you should be able to find where is the problem in C# wrapper, if
any.

Cheers
--
Mateusz Loskot
http://mateusz.loskot.net

_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev



From cemehehko at mail.ru  Mon Jun 19 11:26:47 2006
From: cemehehko at mail.ru (cemehehko)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] ESRI ArcSDE OGR driver
Message-ID: <521253426.20060619192647@mail.ru>

Hello gdal-dev,

What about OGR driver to read/write from/into ArcGis SDE with
ArcSDE developer API? My SDE instance is over Oracle but I think that
this is not the best idea to use OGR/OCI driver. I not found table
ALL_SDO_GEOM_METADATA. I use Oracle Spatial to store my geometries in
SDE setup files for speed and convineince .
But ArcSDE can store no only over Oracle DBMS (M$ SQL, IBM, etc).
ArcSDE can also store geometries in BLOBs with WKB inside. There why I
want to use "native" ArcSDE API to process SDE layers.


-- 
Best regards,
 cemehehko                          mailto:cemehehko@mail.ru


From warmerdam at pobox.com  Wed Jun 21 11:14:45 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] MapInfo style string
In-Reply-To: <001801c6953f$89fd1260$cd01a8c0@Maddog>
References: <001801c6953f$89fd1260$cd01a8c0@Maddog>
Message-ID: <44996265.8060900@pobox.com>

Richard Matsunaga wrote:
> In the course of my memory leak investigation, I noticed that using a 
> style string with MapInfo is a very finicky beast. If your string is not 
> formed correctly, it does not get caught when you set the string, but 
> rather it crashes later when you create the feature on the layer.
>  
> Can this be improved to parse the string better or at least return an 
> error gracefully?

Richard,

If you can submit one (or more) bug reports demonstrating the problem
we can at least make things unlikely to crash.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From warmerdam at pobox.com  Wed Jun 21 11:43:08 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] ESRI ArcSDE OGR driver
In-Reply-To: <521253426.20060619192647@mail.ru>
References: <521253426.20060619192647@mail.ru>
Message-ID: <4499690C.1060200@pobox.com>

cemehehko wrote:
> Hello gdal-dev,
> 
> What about OGR driver to read/write from/into ArcGis SDE with
> ArcSDE developer API? My SDE instance is over Oracle but I think that
> this is not the best idea to use OGR/OCI driver. I not found table
> ALL_SDO_GEOM_METADATA. I use Oracle Spatial to store my geometries in
> SDE setup files for speed and convineince .
> But ArcSDE can store no only over Oracle DBMS (M$ SQL, IBM, etc).
> ArcSDE can also store geometries in BLOBs with WKB inside. There why I
> want to use "native" ArcSDE API to process SDE layers.

Cemehehko,

GDAL/OGR 1.3.2 includes a read-only SDE driver using the SDE C API.  So
to build this driver you need to have a copy of the SDE C API developer
kit from ESRI.  This driver could be extended to read/write support, but
that was not a priority for the client who drove this work (Delorme), so
it wasn't pursued.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From richard at waypointinfo.com  Wed Jun 21 12:54:29 2006
From: richard at waypointinfo.com (Richard Matsunaga)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] another MapInfo style string memory leak
Message-ID: <002901c69553$5f9b1120$cd01a8c0@Maddog>

Following up on my last email, there was another source of memory leaks that
I have found. Down the stack on the GetPart method is a new allocation and
this pointer is never deleted (and the statement below is inside a loop).
The same code is repeated in several methods (for Pen, Brush, and Symbol).
 
void ITABFeatureBrush::SetBrushFromStyleString(const char *pszStyleString)
{
...
        poStylePart = poStyleMgr->GetPart(i);
...
}

I have fixed these leaks and tested. All seems to be working as expected.

Cheers,
Richard



From dany.geotools at gmail.com  Wed Jun 21 13:04:52 2006
From: dany.geotools at gmail.com (Daniele Romagnoli)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] problems with "GDAL + Java SWIG" set up on Windows XP
Message-ID: <7221db410606211004n5c0faea5m5063fe082a806b0@mail.gmail.com>

Hi guys,

I'm trying to set up under Windows XP all the items needed to use GDAL with
JAVA.
Norman Barker has already given a great help to me but I have some problems.

Using the procedure found at
http://article.gmane.org/gmane.comp.gis.gdal.devel/6109/match=gdal+visual+c+++expressplus
some other tips, an error occurs:

---------------------------------------------------------------------------------------------------------------------

...................

C:\gdal\frmts>cd gtiff   && nmake /NOLOGO /f makefile.vc   && cd ..
        cl /nologo /MD /EHsc /Zi /Fd..\..\gdal.pdb -I..\..\port -I..\..\ogr
-I..
\..\gcore  -I..\..\alg -Ilibtiff -Ilibgeotiff /c tifvsi.cpp
tifvsi.cpp
C:\Programmi\Microsoft Visual Studio 8\VC\INCLUDE\swprintf.inl(41) : error
C2664
: '_vswprintf_c_l' : cannot convert parameter 4 from 'void *' to '_locale_t'
        Conversion from 'void*' to pointer to non-'void' requires an
explicit ca
st
C:\Programmi\Microsoft Visual Studio 8\VC\INCLUDE\swprintf.inl(51) : error
C2664
: '_vswprintf_c_l' : cannot convert parameter 4 from 'void *' to '_locale_t'
        Conversion from 'void*' to pointer to non-'void' requires an
explicit ca
st
NMAKE : fatal error U1077: '"C:\Programmi\Microsoft Visual Studio
8\VC\BIN\cl.EX
E"' : return code '0x2'
Stop.

---------------------------------------------------------------------------------------------------------------------

So, I have tried the "cygwin" way to build GDAL and it seems working:

./configure
make
make install

However, when I follow the steps suggested by Ben Collins at
http://lists.maptools.org/pipermail/gdal-dev/2006-February/007867.html, this
error occurs:
---------------------------------------------------------------------------------------------------------------------

........
/bin/sh.exe /cygdrive/c/gdal2/libtool --mode=compile g++ -fPIC -Wall  -O2
-I/cygdrive/c/gdal2/port -I/cygdrive/c/gdal2/gcore -I/cygdrive/c/gdal2/alg
-I/cygdrive/c/gdal2/ogr -I/cygdrive/c/gdal2/ogr/ogrsf_frmts
-I/usr/java/j2sdk1.4.2_08/include -I/usr/java/j2sdk1.4.2_08/include/win32 -c
osr_wrap.cpp
 g++ -fPIC -Wall -O2 -I/cygdrive/c/gdal2/port -I/cygdrive/c/gdal2/gcore
-I/cygdrive/c/gdal2/alg -I/cygdrive/c/gdal2/ogr
-I/cygdrive/c/gdal2/ogr/ogrsf_frmts -I/usr/java/j2sdk1.4.2_08/include
-I/usr/java/j2sdk1.4.2_08/include/win32 -c osr_wrap.cpp  -DPIC -o
.libs/osr_wrap.o
osr_wrap.cpp:1: warning: -fPIC ignored for target (all code is position
independent)
osr_wrap.cpp: In function `__jobjectArray*
Java_org_gdal_osr_osrJNI_GetProjectionMethods(JNIEnv*, __jclass*)':
osr_wrap.cpp:2233: error: invalid conversion from `__jarray*' to
`__jobjectArray*'
osr_wrap.cpp: In function `__jobjectArray*
Java_org_gdal_osr_osrJNI_GetProjectionMethodParameterList(JNIEnv*,
__jclass*, __jstring*, __jobjectArray*)':
osr_wrap.cpp:2285: error: invalid conversion from `__jarray*' to
`__jobjectArray*'
make: *** [osr_wrap.o] Error 1
---------------------------------------------------------------------------------------------------------------------


Maybe I blundered during some step.
Anyone can help me?

Regards,
Daniele
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060621/7a231a5b/attachment.html
From dany.geotools at gmail.com  Wed Jun 21 13:21:45 2006
From: dany.geotools at gmail.com (Daniele Romagnoli)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Re: problems with "GDAL + Java SWIG" set up on Windows XP
In-Reply-To: <7221db410606211004n5c0faea5m5063fe082a806b0@mail.gmail.com>
References: <7221db410606211004n5c0faea5m5063fe082a806b0@mail.gmail.com>
Message-ID: <7221db410606211021l1f44fe98ma510650f389c3759@mail.gmail.com>

Ok... I have solved the last error but a new error occurs:

/bin/sh.exe /cygdrive/c/gdal2/libtool --mode=compile g++ -fPIC -Wall  -O2
-I/cygdrive/c/gdal2/port -I/cygdrive/c/gdal2/gcore -I/cygdrive/c/gdal2/alg
-I/cygdrive/c/gdal2/ogr -I/cygdrive/c/gdal2/ogr/ogrsf_frmts
-I/usr/j2sdk1.4.2_08/include -I/usr/j2sdk1.4.2_08/include/win32 -c
osr_wrap.cpp
 g++ -fPIC -Wall -O2 -I/cygdrive/c/gdal2/port -I/cygdrive/c/gdal2/gcore
-I/cygdrive/c/gdal2/alg -I/cygdrive/c/gdal2/ogr
-I/cygdrive/c/gdal2/ogr/ogrsf_frmts -I/usr/j2sdk1.4.2_08/include
-I/usr/j2sdk1.4.2_08/include/win32 -c osr_wrap.cpp  -DPIC -o
.libs/osr_wrap.o
osr_wrap.cpp:1: warning: -fPIC ignored for target (all code is position
independent)
 g++ -fPIC -Wall -O2 -I/cygdrive/c/gdal2/port -I/cygdrive/c/gdal2/gcore
-I/cygdrive/c/gdal2/alg -I/cygdrive/c/gdal2/ogr
-I/cygdrive/c/gdal2/ogr/ogrsf_frmts -I/usr/j2sdk1.4.2_08/include
-I/usr/j2sdk1.4.2_08/include/win32 -c osr_wrap.cpp -o osr_wrap.o >/dev/null
2>&1
/bin/sh.exe /cygdrive/c/gdal2/libtool --mode=link       g++ -shared
/cygdrive/c/gdal2/libgdal.la osr_wrap.o -o libosrjni.so
g++ -shared osr_wrap.o -o libosrjni.so.exe
/cygdrive/c/gdal2/.libs/libgdal.a /usr/lib/libjasper.dll.a -L/usr/X11R6/lib
/usr/lib/libtiff.dll.a /usr/lib/libjpeg.dll.a -lpng -lz
cp ./.libs/*.so ./
cp: cannot stat `./.libs/*.so': No such file or directory
make: *** [build] Error 1

However, I see that in the directory there are 4 files *.so.exe

Maybe can I rename them from *.so.exe to *.so and then move them to the
/.libs folder?
....

Regards



On 6/21/06, Daniele Romagnoli <dany.geotools@gmail.com> wrote:
>
> Hi guys,
>
> I'm trying to set up under Windows XP all the items needed to use GDAL
> with JAVA.
> Norman Barker has already given a great help to me but I have some
> problems.
>
> Using the procedure found at
> http://article.gmane.org/gmane.comp.gis.gdal.devel/6109/match=gdal+visual+c+++expressplus some other tips, an error occurs:
>
>
> ---------------------------------------------------------------------------------------------------------------------
>
> ...................
>
> C:\gdal\frmts>cd gtiff   && nmake /NOLOGO /f makefile.vc   && cd ..
>         cl /nologo /MD /EHsc /Zi /Fd..\..\gdal.pdb -I..\..\port
> -I..\..\ogr -I..
> \..\gcore  -I..\..\alg -Ilibtiff -Ilibgeotiff /c tifvsi.cpp
> tifvsi.cpp
> C:\Programmi\Microsoft Visual Studio 8\VC\INCLUDE\swprintf.inl(41) : error
> C2664
> : '_vswprintf_c_l' : cannot convert parameter 4 from 'void *' to
> '_locale_t'
>         Conversion from 'void*' to pointer to non-'void' requires an
> explicit ca
> st
> C:\Programmi\Microsoft Visual Studio 8\VC\INCLUDE\swprintf.inl(51) : error
> C2664
> : '_vswprintf_c_l' : cannot convert parameter 4 from 'void *' to
> '_locale_t'
>         Conversion from 'void*' to pointer to non-'void' requires an
> explicit ca
> st
> NMAKE : fatal error U1077: '"C:\Programmi\Microsoft Visual Studio
> 8\VC\BIN\cl.EX
> E"' : return code '0x2'
> Stop.
>
>
> ---------------------------------------------------------------------------------------------------------------------
>
> So, I have tried the "cygwin" way to build GDAL and it seems working:
>
> ./configure
> make
> make install
>
> However, when I follow the steps suggested by Ben Collins at
> http://lists.maptools.org/pipermail/gdal-dev/2006-February/007867.html,
> this error occurs:
> ---------------------------------------------------------------------------------------------------------------------
>
> ........
> /bin/sh.exe /cygdrive/c/gdal2/libtool --mode=compile g++ -fPIC -Wall
> -O2   -I/cygdrive/c/gdal2/port -I/cygdrive/c/gdal2/gcore
> -I/cygdrive/c/gdal2/alg -I/cygdrive/c/gdal2/ogr
> -I/cygdrive/c/gdal2/ogr/ogrsf_frmts -I/usr/java/j2sdk1.4.2_08/include
> -I/usr/java/j2sdk1.4.2_08/include/win32 -c osr_wrap.cpp
>  g++ -fPIC -Wall -O2 -I/cygdrive/c/gdal2/port -I/cygdrive/c/gdal2/gcore
> -I/cygdrive/c/gdal2/alg -I/cygdrive/c/gdal2/ogr
> -I/cygdrive/c/gdal2/ogr/ogrsf_frmts -I/usr/java/j2sdk1.4.2_08/include
> -I/usr/java/j2sdk1.4.2_08/include/win32 -c osr_wrap.cpp  -DPIC -o
> .libs/osr_wrap.o
> osr_wrap.cpp:1: warning: -fPIC ignored for target (all code is position
> independent)
> osr_wrap.cpp: In function `__jobjectArray*
> Java_org_gdal_osr_osrJNI_GetProjectionMethods(JNIEnv*, __jclass*)':
> osr_wrap.cpp:2233: error: invalid conversion from `__jarray*' to
> `__jobjectArray*'
> osr_wrap.cpp: In function `__jobjectArray*
> Java_org_gdal_osr_osrJNI_GetProjectionMethodParameterList(JNIEnv*,
> __jclass*, __jstring*, __jobjectArray*)':
> osr_wrap.cpp:2285: error: invalid conversion from `__jarray*' to
> `__jobjectArray*'
> make: *** [osr_wrap.o] Error 1
> ---------------------------------------------------------------------------------------------------------------------
>
>
> Maybe I blundered during some step.
> Anyone can help me?
>
> Regards,
> Daniele
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060621/7f611838/attachment.html
From warmerdam at pobox.com  Wed Jun 21 13:45:40 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Re: problems with "GDAL + Java SWIG" set up on Windows XP
In-Reply-To: <7221db410606211021l1f44fe98ma510650f389c3759@mail.gmail.com>
References: <7221db410606211004n5c0faea5m5063fe082a806b0@mail.gmail.com>
	<7221db410606211021l1f44fe98ma510650f389c3759@mail.gmail.com>
Message-ID: <449985C4.7000800@pobox.com>

Daniele Romagnoli wrote:
> Ok... I have solved the last error but a new error occurs:
> 
> /bin/sh.exe /cygdrive/c/gdal2/libtool --mode=compile g++ -fPIC -Wall  
> -O2   -I/cygdrive/c/gdal2/port -I/cygdrive/c/gdal2/gcore 
> -I/cygdrive/c/gdal2/alg -I/cygdrive/c/gdal2/ogr 
> -I/cygdrive/c/gdal2/ogr/ogrsf_frmts -I/usr/j2sdk1.4.2_08/include 
> -I/usr/j2sdk1.4.2_08/include/win32 -c osr_wrap.cpp
>  g++ -fPIC -Wall -O2 -I/cygdrive/c/gdal2/port -I/cygdrive/c/gdal2/gcore 
> -I/cygdrive/c/gdal2/alg -I/cygdrive/c/gdal2/ogr 
> -I/cygdrive/c/gdal2/ogr/ogrsf_frmts -I/usr/j2sdk1.4.2_08/include 
> -I/usr/j2sdk1.4.2_08/include/win32 -c osr_wrap.cpp  -DPIC -o 
> .libs/osr_wrap.o
> osr_wrap.cpp:1: warning: -fPIC ignored for target (all code is position 
> independent)
>  g++ -fPIC -Wall -O2 -I/cygdrive/c/gdal2/port -I/cygdrive/c/gdal2/gcore 
> -I/cygdrive/c/gdal2/alg -I/cygdrive/c/gdal2/ogr 
> -I/cygdrive/c/gdal2/ogr/ogrsf_frmts -I/usr/j2sdk1.4.2_08/include 
> -I/usr/j2sdk1.4.2_08/include/win32 -c osr_wrap.cpp -o osr_wrap.o 
>  >/dev/null 2>&1
> /bin/sh.exe /cygdrive/c/gdal2/libtool --mode=link       g++ -shared  
> /cygdrive/c/gdal2/libgdal.la osr_wrap.o -o libosrjni.so
> g++ -shared osr_wrap.o -o libosrjni.so.exe  
> /cygdrive/c/gdal2/.libs/libgdal.a /usr/lib/libjasper.dll.a 
> -L/usr/X11R6/lib /usr/lib/libtiff.dll.a /usr/lib/libjpeg.dll.a -lpng -lz
> cp ./.libs/*.so ./
> cp: cannot stat `./.libs/*.so': No such file or directory
> make: *** [build] Error 1
> 
> However, I see that in the directory there are 4 files *.so.exe
> 
> Maybe can I rename them from *.so.exe to *.so and then move them to the 
> /.libs folder?

Daniele,

I haven't tried building any of the swig bindings for a cygwin build
of GDAL, and I'm not sure how practical it will be.  You are likely to
have to do quite a bit of fiddling to get it working.

I would generally encourage using visual studio as you started out doing.
I haven't personally used anything newer than visual studio 7.1 (ie. 2003)
so if you have that available you might want to use it instead of the
newer visual studio 8/2005.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From dany.geotools at gmail.com  Wed Jun 21 14:02:19 2006
From: dany.geotools at gmail.com (Daniele Romagnoli)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Re: problems with "GDAL + Java SWIG" set up on Windows XP
In-Reply-To: <449985C4.7000800@pobox.com>
References: <7221db410606211004n5c0faea5m5063fe082a806b0@mail.gmail.com>
	<7221db410606211021l1f44fe98ma510650f389c3759@mail.gmail.com>
	<449985C4.7000800@pobox.com>
Message-ID: <7221db410606211102u450b9eedn22bd4808a1aa7789@mail.gmail.com>

Frank,

Thank you for the suggested tip.

I chose 2005 because it is free ^_^

Then, I will look for the 7.1 version. Thank you very much.

Regards,
Daniele



On 6/21/06, Frank Warmerdam < warmerdam@pobox.com> wrote:
>
> Daniele Romagnoli wrote:
> > Ok... I have solved the last error but a new error occurs:
> >
> > /bin/sh.exe /cygdrive/c/gdal2/libtool --mode=compile g++ -fPIC -Wall
> > -O2   -I/cygdrive/c/gdal2/port -I/cygdrive/c/gdal2/gcore
> > -I/cygdrive/c/gdal2/alg -I/cygdrive/c/gdal2/ogr
> > -I/cygdrive/c/gdal2/ogr/ogrsf_frmts -I/usr/j2sdk1.4.2_08/include
> > -I/usr/j2sdk1.4.2_08/include/win32 -c osr_wrap.cpp
> >  g++ -fPIC -Wall -O2 -I/cygdrive/c/gdal2/port -I/cygdrive/c/gdal2/gcore
> > -I/cygdrive/c/gdal2/alg -I/cygdrive/c/gdal2/ogr
> > -I/cygdrive/c/gdal2/ogr/ogrsf_frmts -I/usr/j2sdk1.4.2_08/include
> > -I/usr/j2sdk1.4.2_08/include/win32 -c osr_wrap.cpp  -DPIC -o
> > .libs/osr_wrap.o
> > osr_wrap.cpp:1: warning: -fPIC ignored for target (all code is position
> > independent)
> >  g++ -fPIC -Wall -O2 -I/cygdrive/c/gdal2/port -I/cygdrive/c/gdal2/gcore
> > -I/cygdrive/c/gdal2/alg -I/cygdrive/c/gdal2/ogr
> > -I/cygdrive/c/gdal2/ogr/ogrsf_frmts -I/usr/j2sdk1.4.2_08/include
> > -I/usr/j2sdk1.4.2_08/include/win32 -c osr_wrap.cpp -o osr_wrap.o
> >  >/dev/null 2>&1
> > /bin/sh.exe /cygdrive/c/gdal2/libtool --mode=link       g++ -shared
> > /cygdrive/c/gdal2/libgdal.la osr_wrap.o -o libosrjni.so
> > g++ -shared osr_wrap.o -o libosrjni.so.exe
> > /cygdrive/c/gdal2/.libs/libgdal.a /usr/lib/libjasper.dll.a
> > -L/usr/X11R6/lib /usr/lib/libtiff.dll.a /usr/lib/libjpeg.dll.a -lpng -lz
>
> > cp ./.libs/*.so ./
> > cp: cannot stat `./.libs/*.so': No such file or directory
> > make: *** [build] Error 1
> >
> > However, I see that in the directory there are 4 files *.so.exe
> >
> > Maybe can I rename them from *.so.exe to *.so and then move them to the
> > /.libs folder?
>
> Daniele,
>
> I haven't tried building any of the swig bindings for a cygwin build
> of GDAL, and I'm not sure how practical it will be.  You are likely to
> have to do quite a bit of fiddling to get it working.
>
> I would generally encourage using visual studio as you started out doing.
> I haven't personally used anything newer than visual studio 7.1 (ie. 2003)
> so if you have that available you might want to use it instead of the
> newer visual studio 8/2005.
>
> Best regards,
> --
>
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam<http://pobox.com/%7Ewarmerdam>
> and watch the world go round - Rush    | President OSGF, http://osgeo.org
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060621/facbd976/attachment.html
From collinsb at mitre.org  Wed Jun 21 14:22:52 2006
From: collinsb at mitre.org (Collins, Benjamin)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Re: problems with "GDAL + Java SWIG" set up on Windows
	XP
Message-ID: <8D27E2CDAF11D34F97E7445BCCCDB92CF6CC56@IMCSRV1.MITRE.ORG>

So, obviously the Java SWIG build process could use some "refining".

The current setup should allow VC building on Win32.  I have not been
testing on cygwin for other reasons.

Since you have gotten this far, I would imagine that the *.so.exe files
could be renamed *.dll to be functional.  This is a guess, and obviosly
should not be a part of the normal build process!  The *.so extension
is hard-coded into the GNUmakefile (bad!) and cygwin and libtool must
be dredging up that .exe extension from somewhere.  These are issues
for which someone who is build-file knowledgeable would be very
valuable.

--
Ben

>-----Original Message-----
>From: gdal-dev-bounces@lists.maptools.org 
>[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of 
>Daniele Romagnoli
>Sent: Wednesday, June 21, 2006 1:22 PM
>To: gdal-dev@lists.maptools.org
>Cc: Simone Giannecchini
>Subject: [Gdal-dev] Re: problems with "GDAL + Java SWIG" set 
>up on Windows XP
>
>Ok... I have solved the last error but a new error occurs:
>
>/bin/sh.exe /cygdrive/c/gdal2/libtool --mode=compile g++ -fPIC 
>-Wall  -O2   -I/cygdrive/c/gdal2/port 
>-I/cygdrive/c/gdal2/gcore -I/cygdrive/c/gdal2/alg 
>-I/cygdrive/c/gdal2/ogr -I/cygdrive/c/gdal2/ogr/ogrsf_frmts 
>-I/usr/j2sdk1.4.2_08/include 
>-I/usr/j2sdk1.4.2_08/include/win32 -c osr_wrap.cpp 
> g++ -fPIC -Wall -O2 -I/cygdrive/c/gdal2/port 
>-I/cygdrive/c/gdal2/gcore -I/cygdrive/c/gdal2/alg 
>-I/cygdrive/c/gdal2/ogr -I/cygdrive/c/gdal2/ogr/ogrsf_frmts 
>-I/usr/j2sdk1.4.2_08/include 
>-I/usr/j2sdk1.4.2_08/include/win32 -c osr_wrap.cpp  -DPIC -o 
>.libs/osr_wrap.o 
>osr_wrap.cpp:1: warning: -fPIC ignored for target (all code is 
>position independent)
> g++ -fPIC -Wall -O2 -I/cygdrive/c/gdal2/port 
>-I/cygdrive/c/gdal2/gcore -I/cygdrive/c/gdal2/alg 
>-I/cygdrive/c/gdal2/ogr -I/cygdrive/c/gdal2/ogr/ogrsf_frmts 
>-I/usr/j2sdk1.4.2_08/include 
>-I/usr/j2sdk1.4.2_08/include/win32 -c osr_wrap.cpp -o 
>osr_wrap.o >/dev/null 2>&1 
>/bin/sh.exe /cygdrive/c/gdal2/libtool --mode=link       g++ 
>-shared  /cygdrive/c/gdal2/libgdal.la osr_wrap.o -o libosrjni.so
>g++ -shared osr_wrap.o -o libosrjni.so.exe  
>/cygdrive/c/gdal2/.libs/libgdal.a /usr/lib/libjasper.dll.a 
>-L/usr/X11R6/lib /usr/lib/libtiff.dll.a /usr/lib/libjpeg.dll.a 
>-lpng -lz 
>cp ./.libs/*.so ./
>cp: cannot stat `./.libs/*.so': No such file or directory
>make: *** [build] Error 1
>
>However, I see that in the directory there are 4 files *.so.exe
>
>Maybe can I rename them from *.so.exe to *.so and then move 
>them to the /.libs folder? 
>....
>
>Regards
>
>
>
>
>On 6/21/06, Daniele Romagnoli <dany.geotools@gmail.com> wrote: 
>
>	Hi guys,
>	
>	I'm trying to set up under Windows XP all the items 
>needed to use GDAL with JAVA. 
>	Norman Barker has already given a great help to me but 
>I have some problems.
>	
>	Using the procedure found at 
>http://article.gmane.org/gmane.comp.gis.gdal.devel/6109/match=g
>dal+visual+c+++express 
><http://article.gmane.org/gmane.comp.gis.gdal.devel/6109/match=
>gdal+visual+c+++express>  plus some other tips, an error occurs:
>	
>
>	
>---------------------------------------------------------------
>------------------------------------------------------
>
>	................... 
>	
>
>	C:\gdal\frmts>cd gtiff   && nmake /NOLOGO /f 
>makefile.vc   && cd ..
>	        cl /nologo /MD /EHsc /Zi /Fd..\..\gdal.pdb 
>-I..\..\port -I..\..\ogr -I..
>	\..\gcore  -I..\..\alg -Ilibtiff -Ilibgeotiff /c tifvsi.cpp
>	tifvsi.cpp
>	C:\Programmi\Microsoft Visual Studio 
>8\VC\INCLUDE\swprintf.inl(41) : error C2664
>	: '_vswprintf_c_l' : cannot convert parameter 4 from 
>'void *' to '_locale_t'
>	        Conversion from 'void*' to pointer to 
>non-'void' requires an explicit ca
>	st
>	C:\Programmi\Microsoft Visual Studio 
>8\VC\INCLUDE\swprintf.inl(51) : error C2664
>	: '_vswprintf_c_l' : cannot convert parameter 4 from 
>'void *' to '_locale_t'
>	        Conversion from 'void*' to pointer to 
>non-'void' requires an explicit ca
>	st
>	NMAKE : fatal error U1077: '"C:\Programmi\Microsoft 
>Visual Studio 8\VC\BIN\cl.EX
>	E"' : return code '0x2'
>	Stop.
>
>	
>---------------------------------------------------------------
>------------------------------------------------------ 
>
>
>	So, I have tried the "cygwin" way to build GDAL and it 
>seems working:
>	
>	./configure
>	make
>	make install
>	
>	However, when I follow the steps suggested by Ben 
>Collins at 
>http://lists.maptools.org/pipermail/gdal-dev/2006-February/0078
>67.html 
><http://lists.maptools.org/pipermail/gdal-dev/2006-February/007
>867.html> , this error occurs:
>	
>---------------------------------------------------------------
>------------------------------------------------------ 
>	........
>	/bin/sh.exe /cygdrive/c/gdal2/libtool --mode=compile 
>g++ -fPIC -Wall  -O2   -I/cygdrive/c/gdal2/port 
>-I/cygdrive/c/gdal2/gcore -I/cygdrive/c/gdal2/alg 
>-I/cygdrive/c/gdal2/ogr -I/cygdrive/c/gdal2/ogr/ogrsf_frmts 
>-I/usr/java/j2sdk1.4.2_08/include 
>-I/usr/java/j2sdk1.4.2_08/include/win32 -c osr_wrap.cpp 
>	 g++ -fPIC -Wall -O2 -I/cygdrive/c/gdal2/port 
>-I/cygdrive/c/gdal2/gcore -I/cygdrive/c/gdal2/alg 
>-I/cygdrive/c/gdal2/ogr -I/cygdrive/c/gdal2/ogr/ogrsf_frmts 
>-I/usr/java/j2sdk1.4.2_08/include 
>-I/usr/java/j2sdk1.4.2_08/include/win32 -c osr_wrap.cpp  -DPIC 
>-o .libs/osr_wrap.o 
>	osr_wrap.cpp:1: warning: -fPIC ignored for target (all 
>code is position independent)
>	osr_wrap.cpp: In function `__jobjectArray* 
>Java_org_gdal_osr_osrJNI_GetProjectionMethods(JNIEnv*, __jclass*)':
>	osr_wrap.cpp:2233: error: invalid conversion from 
>`__jarray*' to `__jobjectArray*' 
>	osr_wrap.cpp: In function `__jobjectArray* 
>Java_org_gdal_osr_osrJNI_GetProjectionMethodParameterList(JNIEn
>v*, __jclass*, __jstring*, __jobjectArray*)':
>	osr_wrap.cpp:2285: error: invalid conversion from 
>`__jarray*' to `__jobjectArray*' 
>	make: *** [osr_wrap.o] Error 1
>	
>---------------------------------------------------------------
>------------------------------------------------------ 
>	
>	Maybe I blundered during some step.
>	Anyone can help me?
>	
>	Regards,
>	
>	Daniele
>	
>	
>	
>
>
>


From jluis at ualg.pt  Wed Jun 21 15:34:06 2006
From: jluis at ualg.pt (Joaquim Luis)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] Merging Dems
In-Reply-To: <20060620190143.99772.qmail@web51905.mail.yahoo.com>
References: <20060620190143.99772.qmail@web51905.mail.yahoo.com>
Message-ID: <44999F2E.8050605@ualg.pt>

Chris,
If you can transform the dems into GMT grids than you can use grdblend. 
I never used it but from the manual
it does what you want.

Joaquim Luis

> Hi all,
>
> Merging dems seems like a common task, but I
> cannot find a way to do it well using gdal. Is there a
> best practice I should be aware of?
>
> I realize that there will always be gaps between dems,
> which must be fixed afterward (thanks Craig and Ben),
> but what is the best way to merge the dems together,
> with "clean" NODATA edges, so that the gaps can
> be filled?
>
> The problem I run into is that warping with "-rcs" for
> cubic spline resampling, which looks best, leaves the
> edges of the dem "rounded off". E.g. if the data
> should be:
>
> 1000, 1000, 1000, NODATA, NODATA
>
> I get instead:
>
> 1000, 1000, -400, -5000, NODATA
>
> And so I don't have clean cut offs from data to
> NODATA, which makes gap filling challenging.
>
>
>   

From richard at waypointinfo.com  Wed Jun 21 15:52:44 2006
From: richard at waypointinfo.com (Richard Matsunaga)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] memory leak in MapInfo layer
Message-ID: <004801c6956c$438034c0$cd01a8c0@Maddog>

 
Sorry if this is a duplicate. I never saw this message come up.


After days of pain and suffering and ultimately, barking up all the wrong
trees, I found the source of the memory leak.

I created a stripped-down-to-basics C# version of a program that writes
point symbols to a MapInfo file. I also created an identical C program.

I used DevPartner 8.1 to analyze both programs. It detects numerous leaks in
gdal, but based on Mateusz's comments and other odd results reported by
DevPartner, I am not putting too much faith in those results.

After all this, it turns out that OGR_F_SetStyleString() is the source of
the leak (or more accurately, when the feature is created on the layer
itself - hence the lack leak if the geometry is never added to the feature).
This is evident in both C and the C# versions of the programs, but for some
reason is greatly exaggerated in C#. For example, when I generate the same
layer repeatedly, it consumes a 100+ kB for each iteration in C. But in C#,
it consumes 2+ MB of memory for each iteration. I can't explain that, but
maybe has something to do with strdup and how the new buffer size is
computed when passed a reference to a C# string type? Doesn't sound right.

The root cause appears to be *poStyleMGr not being deleted (there are other
methods in the same file that do the same thing):

void ITABFeatureSymbol::SetSymbolFromStyleString(const char *pszStyleString)

{
 ...
	OGRStyleMgr *poStyleMgr = new OGRStyleMgr(NULL); 
 ...
}

Cheers,
Richard

-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Mateusz Loskot
Sent: June 14, 2006 8:33 AM
To: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] memory leak in MapInfo layer

Richard Matsunaga wrote:
> Hi Mateusz,
> 
> Here is a sample of the code I am using. I have removed non-OGR 
> related details. For those who may not know, the 'using' statement is 
> used to force Dispose to be called once out of scope of the using 
> statement.


Yes, but OgrSpatialReference class is not disposable, so how did you manage
to put it in using?

VC# 2005 throws me this message:
error CS1674: 'GDALWrapper.OGR.OgrSpatialReference': type used in a using
statement must be implicitly convertible to 'System.IDisposable'

Or I have old version (from the beginning of May 2006) of your GDALWrapper?


> The C# wrapper is basically the same as the one I sent out some time  
> ago, although there have been changes - extended functionality, bug  
> fixes and some unrelated memory issues caused by the wrapper itself.
>  I can send this out again if that would help. I am fairly confident  
> at this point that the wrapper is not the cause of the leak, but since 
> I am far from being a platform invoke expert, there is a, of course, 
> chance that some unexpected behaviour with the wrapper is the  cause.


The best way to check is to implement the same functionality in C++
correctly and see if this also will leak.
It should be not very hard to get ESRI Shapefile/MapInfo File driver, create
datasource, create one layer.


> I am not using any high tech means to detect memory leaks. I run the  
> code below in a loop and watch the system memory climb and climb.
> The .NET garbage collection can be a finicky thing to an outside 
> observer such as myself, but it will not allow the system to run out 
> of memory unless there is a leak of some kind, and that can be a 
> problem with managed resources or unmanaged code. I have run a few 
> .NET memory profilers and they have not found any problems. There is 
> another commercial product that I have not tried (yet) that is able to 
> instrument both managed and unmanaged code for memory profiling.


I checked the creation of data source  with .NET Memory Profiler and also
watching the memory usage in the tasks list.
I don't see huge increase of memory consuming.
I mean, 1000 layers (1000 x data source, driver, layer objects) gave me
about 2 MB memory usage.
Also the .NET Profiler reports the same number of objects created and
disposed of all classes I used.

I got problems with CreateLayer for Shapefile.
Calling OGR OGR_DS_CreateLayer gave me memory corruption.
I tried various parameters, null checking, etc.
I have no idea what's going wrong there.

But I've shown you, Valgrind on Linux does not show any memory issues with
ogr2ogr - a C++ program using OGR.
Unfortunately, I don't have any other bounds checker on Windows than
debuggers coming with VC++ and VC# 2005.

May be you could do some tests as simple as possible:
- create and add single field
- create and add single point (geometry) to feature etc.

This way you should be able to find where is the problem in C# wrapper, if
any.

Cheers
--
Mateusz Loskot
http://mateusz.loskot.net

_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev



From dmorissette at mapgears.com  Wed Jun 21 16:49:00 2006
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] lists.maptools.org problems
Message-ID: <4499B0BC.30505@mapgears.com>

You may have noticed delays with the delivery of some messages to this 
list and other maptools.org lists, this is due to some problems we are 
having with the list server and that we are working to resolve.

In the meantime, the contents of the mail queue is being flushed... 
slowly... sorry about this.

Daniel
-- 
Daniel Morissette
http://www.mapgears.com/

From angusd at midwestsurveys.com  Wed Jun 21 19:38:32 2006
From: angusd at midwestsurveys.com (Angus Dickey)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] resampling 8-bit imagery
Message-ID: <H00002670056eba6.1150933112.msicalmail.midwestsurveys.com@MHS>

I have a bunch of 8-bit paletted png images with gcps that I am trying to reproject by following these steps (in a shell script):

- extract the cgps from a text file
- use gdal_translate to copy the png to a geotiff defining the projection and adding the gcps along the way
- using gdalwarp to change the projection and output another geotiff

This actually works great as long as I use nearest neighbour resampling, other resampling methods (e.g. cubic convolution) mess up the resultant image. I assume this is because they change the grey levels of the 8-bit channel and they would no longer map to the palette.

Using nearest neighbour does not produce a very nice image so I tried to use pct2rgb.py before gdal_translate like so:

pct2rgb.py -of GTiff in.png out.tiff

The resultant tiff does not appear to be a standard 3 channel rgb tiff; it will not open in normal image editing software and it causes gdalwarp to error out:

ERROR 5: GDALDataset::GetRasterBand(2) - Illegal band #

ERROR 5: GDALDataset::GetRasterBand(3) - Illegal band #


Am I missing something obvious? Any help would be appreciated.

Thanks,

~Angus


From warmerdam at pobox.com  Wed Jun 21 20:12:41 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:13 2007
Subject: [Gdal-dev] resampling 8-bit imagery
In-Reply-To: <H00002670056eba6.1150933112.msicalmail.midwestsurveys.com@MHS>
References: <H00002670056eba6.1150933112.msicalmail.midwestsurveys.com@MHS>
Message-ID: <4499E079.8060504@pobox.com>


Angus,

Indeed, nearest neighbour resampling is usually the only appropriate
resampling to use with paletted images.

Angus Dickey wrote:
> Using nearest neighbour does not produce a very nice image so I tried to
> use pct2rgb.py before gdal_translate like so:
> 
> pct2rgb.py -of GTiff in.png out.tiff
> 
> The resultant tiff does not appear to be a standard 3 channel rgb tiff; it
> will not open in normal image editing software and it causes gdalwarp to
> error out:
> 
> ERROR 5: GDALDataset::GetRasterBand(2) - Illegal band #
> 
> ERROR 5: GDALDataset::GetRasterBand(3) - Illegal band #
> 
> Am I missing something obvious? Any help would be appreciated.

I don't see an obvious reason the file would not work with gdalwarp.
But many non-GDAL applications do not work very well with band interleaved
TIFF files, so the creation option INTERLEAVE=PIXEL can be helpful.
Unfortunately, it does not seem that the pct2rgb.py script supports
creation options, so you would be stuck doing something like:

   pct2rgb.py in.png out.tif
   gdal_translate -co INTERLEAVE=PIXEL out.tif out_pixel.tif

However, since you are getting errors from gdalwarp it would seem there
is something more serious at play.  What build of GDAL are you using?
Can you provide the in.png and out.tiff for inspection?  Perhaps you could
try the same process with FWTools?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From MChapman at sanz.com  Thu Jun 22 11:37:57 2006
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] JPIP Jpeg 2000 Interactive Protocol support 
Message-ID: <ED3A48B9840E594890A2BC172D11946506511639@mailman.san.com>

All,

 

I don't know much about JPIP (Jpeg 2000 Interactive Protocol), but I was
wondering if GDAL, or one of GDAL's third party drivers supports it.  I
didn't see it in the supported formats web page so I'm assuming it's not
supported.  Does anyone know if LizardTech supports it?  Has anyone in
this group ever worked with it before?

 

Best regards,

Martin

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060622/5c30fb3e/attachment.html
From jluis at ualg.pt  Thu Jun 22 14:03:25 2006
From: jluis at ualg.pt (Joaquim Luis)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] How to set a ColorTable from scratch?
In-Reply-To: <4499E079.8060504@pobox.com>
References: <H00002670056eba6.1150933112.msicalmail.midwestsurveys.com@MHS>
	<4499E079.8060504@pobox.com>
Message-ID: <449ADB6D.3050102@ualg.pt>

Hi,
I finally learned how to use the Create() method. However, I didn't find 
out how to create a new colortable.
There is the GDALSetRasterColorTable(GDALRasterBandH, GDALColorTableH) 
but how do we fill the
GDALColorTableH?

Thanks

Joaquim Luis

From warmerdam at pobox.com  Thu Jun 22 14:45:03 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] How to set a ColorTable from scratch?
In-Reply-To: <449ADB6D.3050102@ualg.pt>
References: <H00002670056eba6.1150933112.msicalmail.midwestsurveys.com@MHS>	<4499E079.8060504@pobox.com>
	<449ADB6D.3050102@ualg.pt>
Message-ID: <449AE52F.3060703@pobox.com>

Joaquim Luis wrote:
> Hi,
> I finally learned how to use the Create() method. However, I didn't find 
> out how to create a new colortable.
> There is the GDALSetRasterColorTable(GDALRasterBandH, GDALColorTableH) 
> but how do we fill the
> GDALColorTableH?

Joaquim ,

The following code from gdal/alg/gdalmediancut.cpp shows adding
a bunch of entries to a color table.

     for (i = 0, ptr = usedboxes; ptr != NULL; ++i, ptr = ptr->next)
     {
         GDALColorEntry	sEntry;

         sEntry.c1 = (GByte) (((ptr->rmin + ptr->rmax) << COLOR_SHIFT) / 2);
         sEntry.c2 = (GByte) (((ptr->gmin + ptr->gmax) << COLOR_SHIFT) / 2);
         sEntry.c3 = (GByte) (((ptr->bmin + ptr->bmax) << COLOR_SHIFT) / 2);
         GDALSetColorEntry( hColorTable, i, &sEntry );
     }

Hmm, it really ought to be explicitly setting sEntry.c4 = 255 (for opaque
colors).

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From jluis at ualg.pt  Thu Jun 22 15:13:05 2006
From: jluis at ualg.pt (Joaquim Luis)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] How to set a ColorTable from scratch?
In-Reply-To: <449AE52F.3060703@pobox.com>
References: <H00002670056eba6.1150933112.msicalmail.midwestsurveys.com@MHS>	<4499E079.8060504@pobox.com>
	<449ADB6D.3050102@ualg.pt> <449AE52F.3060703@pobox.com>
Message-ID: <449AEBC1.7050309@ualg.pt>

Frank Warmerdam wrote:
> Joaquim Luis wrote:
>> Hi,
>> I finally learned how to use the Create() method. However, I didn't 
>> find out how to create a new colortable.
>> There is the GDALSetRasterColorTable(GDALRasterBandH, 
>> GDALColorTableH) but how do we fill the
>> GDALColorTableH?
>
> Joaquim ,
>
> The following code from gdal/alg/gdalmediancut.cpp shows adding
> a bunch of entries to a color table.
>
>     for (i = 0, ptr = usedboxes; ptr != NULL; ++i, ptr = ptr->next)
>     {
>         GDALColorEntry    sEntry;
>
>         sEntry.c1 = (GByte) (((ptr->rmin + ptr->rmax) << COLOR_SHIFT) 
> / 2);
>         sEntry.c2 = (GByte) (((ptr->gmin + ptr->gmax) << COLOR_SHIFT) 
> / 2);
>         sEntry.c3 = (GByte) (((ptr->bmin + ptr->bmax) << COLOR_SHIFT) 
> / 2);
>         GDALSetColorEntry( hColorTable, i, &sEntry );
>     }
>
Frank,
I had already came across similar code and I wanted to try it, though 
expecting a crash as effectively
I just had.
The point (that is what I think) is who initializes hColorTable? I mean 
how do we allocate memory to it?
Currently I just have
GDALColorTableH    hColorTable;
GDALColorEntry    sEntry;

for (i = 0; i < nColors; i++) {
                sEntry.c1 = (short)(ptr_d[i] * 255);
                sEntry.c2 = (short)(ptr_d[i+nColors] * 255);
                sEntry.c3 = (short)(ptr_d[i+2*nColors] * 255);
                sEntry.c4 = (short)255;
                GDALSetColorEntry( hColorTable, i, &sEntry );

}

but it crashes at the first call to
    GDALSetColorEntry( hColorTable, i, &sEntry );

Joaquim Luis

From warmerdam at pobox.com  Thu Jun 22 15:25:40 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] How to set a ColorTable from scratch?
In-Reply-To: <449AEBC1.7050309@ualg.pt>
References: <H00002670056eba6.1150933112.msicalmail.midwestsurveys.com@MHS>	<4499E079.8060504@pobox.com>
	<449ADB6D.3050102@ualg.pt> <449AE52F.3060703@pobox.com>
	<449AEBC1.7050309@ualg.pt>
Message-ID: <449AEEB4.8000009@pobox.com>

Joaquim Luis wrote:
> Frank,
> I had already came across similar code and I wanted to try it, though 
> expecting a crash as effectively
 >
> I just had.
> The point (that is what I think) is who initializes hColorTable? I mean 
> how do we allocate memory to it?
> Currently I just have
> GDALColorTableH    hColorTable;
> GDALColorEntry    sEntry;

Joaquim,

Sorry about that.  The color table should be allocate with
GDALCreateColorTable().

eg.

hColorTable = GDALCreateColorTable( GPI_RGB );

> 
> for (i = 0; i < nColors; i++) {
>                sEntry.c1 = (short)(ptr_d[i] * 255);
>                sEntry.c2 = (short)(ptr_d[i+nColors] * 255);
>                sEntry.c3 = (short)(ptr_d[i+2*nColors] * 255);
>                sEntry.c4 = (short)255;
>                GDALSetColorEntry( hColorTable, i, &sEntry );
> 
> }
> 
> but it crashes at the first call to
>    GDALSetColorEntry( hColorTable, i, &sEntry );
> 
> Joaquim Luis
> 
> 


-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From jluis at ualg.pt  Thu Jun 22 15:39:17 2006
From: jluis at ualg.pt (Joaquim Luis)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] How to set a ColorTable from scratch?
In-Reply-To: <449AEEB4.8000009@pobox.com>
References: <H00002670056eba6.1150933112.msicalmail.midwestsurveys.com@MHS>	<4499E079.8060504@pobox.com>
	<449ADB6D.3050102@ualg.pt> <449AE52F.3060703@pobox.com>
	<449AEBC1.7050309@ualg.pt> <449AEEB4.8000009@pobox.com>
Message-ID: <449AF1E5.1000106@ualg.pt>


>
> Joaquim,
>
> Sorry about that.  The color table should be allocate with
> GDALCreateColorTable().
>
> eg.
>
> hColorTable = GDALCreateColorTable( GPI_RGB );
>

Frank,
Thanks (it works now) but let me abuse of your patience with one last 
question.
the
hColorTable = GDALCreateColorTable( GPI_RGB );
aways allocates a 256 color table. Is it possible to control the number 
of color entries ?
Or, alternatively, to remove a certain number of colors from the 256?
The code I'm working in is a Matlab MEX file. The only thing the code 
knows is that it received
a ML colormap and those, by default, have only 64  colors (but they can 
also have up to 256).

Joaquim

From warmerdam at pobox.com  Thu Jun 22 15:59:38 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] How to set a ColorTable from scratch?
In-Reply-To: <449AF1E5.1000106@ualg.pt>
References: <H00002670056eba6.1150933112.msicalmail.midwestsurveys.com@MHS>	<4499E079.8060504@pobox.com>
	<449ADB6D.3050102@ualg.pt> <449AE52F.3060703@pobox.com>
	<449AEBC1.7050309@ualg.pt> <449AEEB4.8000009@pobox.com>
	<449AF1E5.1000106@ualg.pt>
Message-ID: <449AF6AA.50000@pobox.com>

Joaquim Luis wrote:
> Frank,
> Thanks (it works now) but let me abuse of your patience with one last 
> question.
> the
> hColorTable = GDALCreateColorTable( GPI_RGB );
> aways allocates a 256 color table. Is it possible to control the number 
> of color entries ?
> Or, alternatively, to remove a certain number of colors from the 256?
> The code I'm working in is a Matlab MEX file. The only thing the code 
> knows is that it received
> a ML colormap and those, by default, have only 64  colors (but they can 
> also have up to 256).

Joaquim,

GDALCreateColorTable() creates a color table with zero elements.  It is
grown as you add entries.  But some file format drivers only support
particular fixed sizes of colormap. So for instance, if you write to
8bit tiff it will always use a 256 entry color table in the file because
that is the nature of the format.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From mpg at lizardtech.com  Thu Jun 22 16:06:08 2006
From: mpg at lizardtech.com (Michael P. Gerlek)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] RE: JPIP Jpeg 2000 Interactive Protocol support 
In-Reply-To: <200606221602.k5MG2Ovh001615@duke.maptools.org>
Message-ID: <DBEC881B4E22D1449F5FAC530E1ADD12647DA8@sea-srv-ms3.lizardtech.com>

Martin Chapman wrote:

> I don't know much about JPIP (Jpeg 2000 Interactive 
> Protocol), but I was
> wondering if GDAL, or one of GDAL's third party drivers 
> supports it.  I
> didn't see it in the supported formats web page so I'm 
> assuming it's not
> supported.  Does anyone know if LizardTech supports it?  Has anyone in
> this group ever worked with it before?

LizardTech's public SDKs do not support it yet, sorry.

Obviously a progressively streaming protocol like JPIP involves more
than just a "fill this buffer with pixels" sort of API, so wedging it
into GDAL's model would probably require some acrobatics.

(In other, related news, LizardTech is leading the current OGC OWS
effort to make JPIP -- and GMLJP2 -- a supported format for WCS.)

-mpg


From dave at cs.otago.ac.nz  Thu Jun 22 17:52:37 2006
From: dave at cs.otago.ac.nz (Dave Robertson)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] (no subject)
Message-ID: <D3F822BA-44E6-470E-9D1C-87194DAADF53@cs.otago.ac.nz>

Hi,

I'm trying to compile GDAL 1.3.2 with Kakadu v5.1 on OSX but make  
fails with a lot of undefined symbols reported by libtool.
Looking back through the list and gdal changelogs, the latest version  
of kakadu mentioned is 4.0.2 in GDAL 1.1.9

 >  JP2KAK Driver: Can be used with Kakadu 4.0.2 now.

Are later versions of kakadu supported, or to do I have to revert to  
Kakadu 4.0.2 ?

Thanks,
Dave Robertson



ld: Undefined symbols:
__ZN10jp2_colour4initE16jp2_colour_space
__ZN10jp2_source11read_headerEv
__ZN10jp2_source14access_paletteEv
__ZN10jp2_source15access_channelsEv
__ZN10jp2_target12write_headerEv
__ZN10jp2_target13access_colourEv
__ZN10jp2_target14access_paletteEv
__ZN10jp2_target15access_channelsEv
__ZN10jp2_target15open_codestreamEb
__ZN10jp2_target17access_dimensionsEv
__ZN10jp2_target4openEP14jp2_family_tgt
__ZN10jp2_targetD1Ev
__ZN11jp2_palette12get_num_lutsEv
__ZN11jp2_palette15get_num_entriesEv
__ZN11jp2_palette4initEii
__ZN11jp2_palette7get_lutEiPf
__ZN11jp2_palette7set_lutEiPiib
__ZN12jp2_channels15get_num_coloursEv
__ZN12jp2_channels18get_colour_mappingEiRiS0_S0_
__ZN12jp2_channels18set_colour_mappingEiiii
__ZN12jp2_channels19get_opacity_mappingEiRiS0_S0_
__ZN12jp2_channels19get_premult_mappingEiRiS0_S0_
__ZN12jp2_channels19set_opacity_mappingEiiii
__ZN12jp2_channels4initEi
__ZN12kdu_roi_rectC1E14kdu_codestream8kdu_dims
__ZN13jp2_input_boxC2Ev
__ZN14jp2_dimensions4initEP10siz_paramsb
__ZN14jp2_family_src4openEP21kdu_compressed_source
__ZN14jp2_family_src4openEPKcb
__ZN14jp2_family_src5closeEv
__ZN14jp2_family_tgt4openEPKc
__ZN14jp2_family_tgt5closeEv
__ZN14jp2_output_box5closeEv
__ZTV10jp2_source
__ZTV10jp2_target
/usr/bin/libtool: internal link edit command failed
make[1]: *** [libgdal.la] Error 1
make: *** [check-lib] Error 2




From mateusz at loskot.net  Thu Jun 22 19:11:11 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:14 2007
Subject: [gdal-dev] GDAL Documentation
In-Reply-To: <33E9C96E5F4538409B0B533B74953E360170F19C@mlbe2k4.cs.myharris.net>
References: <33E9C96E5F4538409B0B533B74953E360170F19C@mlbe2k4.cs.myharris.net>
Message-ID: <449B238F.4020100@loskot.net>

DeSpain, Ronald wrote:
> What happened to the
> 
> "somewhat useful GDAL documentation at:"     :-)
> 
> http://gdal.velocet.ca/projects/gdal/html/heirarchy.html
> 
> The link is broken.

Ronald,

Thanks for pointing that issue.
It has been fixed.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From mateusz at loskot.net  Thu Jun 22 20:50:03 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] [Bug 1207] ExportToGML doesn't include SRS - FIXED
Message-ID: <449B3ABB.2080902@loskot.net>

Hi,

I'd like to announce new feature in export OGR geometries to GML.

A few days ago, Schuyler Erle submited report about
missing export of SRS details in GML.

This issue has been fixed. Now, when OGR geometry has assigned SRS,
EPSG code is exported as a value of srsName (follows GML 2.x).

Longer story:
http://bugzilla.remotesensing.org/show_bug.cgi?id=1207

Tests and comments are welcome.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From warmerdam at pobox.com  Thu Jun 22 22:05:58 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] (no subject)
In-Reply-To: <D3F822BA-44E6-470E-9D1C-87194DAADF53@cs.otago.ac.nz>
References: <D3F822BA-44E6-470E-9D1C-87194DAADF53@cs.otago.ac.nz>
Message-ID: <449B4C86.2060505@pobox.com>

Dave Robertson wrote:
> Hi,
> 
> I'm trying to compile GDAL 1.3.2 with Kakadu v5.1 on OSX but make fails 
> with a lot of undefined symbols reported by libtool.
> Looking back through the list and gdal changelogs, the latest version of 
> kakadu mentioned is 4.0.2 in GDAL 1.1.9
> 
>  >  JP2KAK Driver: Can be used with Kakadu 4.0.2 now.
> 
> Are later versions of kakadu supported, or to do I have to revert to 
> Kakadu 4.0.2 ?

Dave,

I believe I have always used --without-libtool when building in Kakadu
support on unix systems.  The problem is that we explicitly pull in a
bunch of object files from Kakadu directly, rather than as a library
(because that is the only way Kakadu seems to offer them), and this
seriously confuses the libtool build which seems to expect to control
all object files "its way".

I'm pretty sure I have tried at least Kakadu 5.0 on Linux, so I
don't *forsee* a problem with 5.1 o MacOS X.  Hmm, in fact I'm pretty
sure I tried Kakadu 5.0 or 5.1 on MacOS X a couple weeks ago without
any significant problem (using --without-libtool).

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From cfis at savagexi.com  Fri Jun 23 08:21:06 2006
From: cfis at savagexi.com (Charlie Savage)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Re: Compiling swigged wrappers under MinGW
In-Reply-To: <447E0454.10006@tkk.fi>
References: <447DAA19.7070008@tkk.fi> <447E0454.10006@tkk.fi>
Message-ID: <449BDCB2.1050709@savagexi.com>

Ari,

Not sure if this is helpful anymore, but....

The trick with MingW I've found is link directly against the dlls.
Don't bother with dlltool and .lib files.

So:

g++ -shared somedll.dll my_code.o -o mydll.dll

I've had good luck with the Ruby bindings and MinGW.

Charlie


Ari Jolma wrote:
> Ari Jolma kirjoitti:
>> I almost got the (perl) wrappers compiled under MinGW. The remaining 
>> problem is that ogr.dll and osr.dll won't like to be loaded at the 
>> same time. The swig interface ogr.i imports osr.i so that might cause 
>> the problem. However the problem does not exist in unix so I'm not yet 
>> sure what's going on.
> 
> Talking a bit to myself but anyway, I managed to build the modules and 
> my test code runs the same as in Linux. The generated dll's are a bit 
> large but that could probably be improved. The DLL problems -- which 
> were hard!...:-( -- seem to be related to the Perl module building 
> process and the way it uses the MinGW dlltool. Even the swigwin is not 
> perfect at least for Perl target. I'll post my results later on a webpage.
> 
> Good night,
> 
> Ari
> 


-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/x-pkcs7-signature
Size: 3237 bytes
Desc: S/MIME Cryptographic Signature
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060623/7716422f/smime.bin
From angusd at midwestsurveys.com  Fri Jun 23 14:28:52 2006
From: angusd at midwestsurveys.com (Angus Dickey)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] resampling 8-bit imagery
In-Reply-To: <4499E079.8060504@pobox.com>
Message-ID: <H00002670057f444.1151087331.msicalmail.midwestsurveys.com@MHS>

Thanks for the response.

It was the band interleaving that was throwing off my other applications, pixel interleaving works fine. As for the GDAL error I was getting, that must have been my fault (script bug), because it seems to handle the band and pixel interleaved tiffs now (GDAL 1.3.2.0, released 2006/05/02).

~Angus



-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: June 21, 2006 6:13 PM
To: Angus Dickey
Cc: gdal-dev
Subject: Re: [Gdal-dev] resampling 8-bit imagery


Angus,

Indeed, nearest neighbour resampling is usually the only appropriate
resampling to use with paletted images.

Angus Dickey wrote:
> Using nearest neighbour does not produce a very nice image so I tried to
> use pct2rgb.py before gdal_translate like so:
> 
> pct2rgb.py -of GTiff in.png out.tiff
> 
> The resultant tiff does not appear to be a standard 3 channel rgb tiff; it
> will not open in normal image editing software and it causes gdalwarp to
> error out:
> 
> ERROR 5: GDALDataset::GetRasterBand(2) - Illegal band #
> 
> ERROR 5: GDALDataset::GetRasterBand(3) - Illegal band #
> 
> Am I missing something obvious? Any help would be appreciated.

I don't see an obvious reason the file would not work with gdalwarp.
But many non-GDAL applications do not work very well with band interleaved
TIFF files, so the creation option INTERLEAVE=PIXEL can be helpful.
Unfortunately, it does not seem that the pct2rgb.py script supports
creation options, so you would be stuck doing something like:

   pct2rgb.py in.png out.tif
   gdal_translate -co INTERLEAVE=PIXEL out.tif out_pixel.tif

However, since you are getting errors from gdalwarp it would seem there
is something more serious at play.  What build of GDAL are you using?
Can you provide the in.png and out.tiff for inspection?  Perhaps you could
try the same process with FWTools?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org




From cfis at savagexi.com  Fri Jun 23 16:13:19 2006
From: cfis at savagexi.com (Charlie Savage)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Re: ruby bindings not compiling from CVS
In-Reply-To: <44563376.1050206@nature.berkeley.edu>
References: <44563376.1050206@nature.berkeley.edu>
Message-ID: <449C4B5F.4070709@savagexi.com>

Hi Ken-ichi,

Sorry for such a long delay on this.  I checked this out - and can't
duplicate it.

I can build the ruby bindings on Windows with VC++ 2005 and MingW and
Fedora Core 5.  I don't have access to a Mac, so I can't check there.
If you still want to investigate this more let me know and maybe we can
figure out what is going on.

Charlie

Ken-ichi wrote:
> Hi all,
> 
> When I try to compile the latest CVS (4.30.06) version of GDAL 
> --with-ruby, configuring and compiling go off without a hitch, but when 
> I try to make install, I get this error:
> 
> (cd swig; make install)
> for dir in ruby ; do (cd $dir; make install ); done
> make -f RubyMakefile.mk install
> /bin/sh /usr/local/src/gdal-cvs-2006.04.30/libtool --mode=install 
> /usr/local/src/gdal-cvs-2006.04.30/install-sh -c gdal.so ogr.so 
> gdalconst.so osr.so 
> /usr/darwinports/lib/ruby/site_ruby/1.8/powerpc-darwin8.6.0/gdal
> /usr/local/src/gdal-cvs-2006.04.30/install-sh -c gdal.so 
> /usr/darwinports/lib/ruby/site_ruby/1.8/powerpc-darwin8.6.0/gdal/gdal.so
> install:  gdal.so does not exist
> make[3]: *** [install] Error 1
> make[2]: *** [install] Error 2
> make[1]: *** [install] Error 2
> make: *** [install-actions] Error 2
> 
> 
> It doesn't look like gdal.so is getting made at all.  I'm getting 
> basically the same error on Mac OS 10.4 and Gentoo Linux.  I do not get 
> this error on Gentoo with the 1.3.1 source (haven't tried that one on my 
> Mac yet).
> 
> Any thoughts?
> 


-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/x-pkcs7-signature
Size: 3237 bytes
Desc: S/MIME Cryptographic Signature
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060623/c64c72e0/smime.bin
From cfis at savagexi.com  Fri Jun 23 16:32:56 2006
From: cfis at savagexi.com (Charlie Savage)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Ruby Bindings Update
Message-ID: <449C4FF8.7090308@savagexi.com>

Summary
-----------

I've finally had a chance to look over the Ruby bindings again.  I
noticed a few build issues that I wanted to run by the list, see below
for more info.

Overall, the Ruby bindings seem in good shape to me for OGR and OSR.
There is a full set of unit tests for these modules in the gdal autotest
project.

However, they are not tested, and presumably do not work, for GDAL.
Most likely there are a couple api calls that need a little SWIG
tweaking.  Anyway, I don't have plans to do this since I only need the
OGR part of the bindings.  So if someone wants to make a final push on
GDAL let me know and I can point you in the right direction.

Onto the build issues....


Linux - Fedora Core 5, Dell Dimension machine
--------------------------

Compiling and installing the bindings works fine using the standard
build system (./configure, make, make install).

Issue #1 - However, you can't use them due to selinux errors:

     Cannot restore segment prot after reloc

This has to do with text relocations.  The solution turns out to be
fairly simple, add -fpic or -fPIC when building shared libraries (like
the Ruby bindings).

Should I

a) add this parameter to CFLAGS in the RubyMakefile.mk

- or -

b) should this be added as a global build flag?  I'd imagine all the
other SWIG extensions, and the gdal shared library itself, should run
into the same issue.


Issue #2

Ruby 1.8.4 moved its extension library from
/usr/lib/site-ruby/i386-linux to /usr/lib/ruby/site-ruby/i386-linux

No big deal, since I ask Ruby where the directory is on installation.
However, it turns out that on a fresh ruby install the i386-linux
directory doesn't exist.  So the makefile now has a check for this.


Windows - VC 2005 NET
--------------------------
Another library issue.  With VC.NET 2005 all dlls must include an
embedded manifest at resource id #2.  Yeah, I know, why????  Anyway,
more information then you'd ever want to know about this is here:

http://www.grimes.demon.co.uk/workshops/fusWSThirteen.htm

Here's the issue.  If you build with Visual Studio, the manifest gets
embedded correctly.  If you use nmake, then it doesn't and you have to
add it manually use mt.exe (see link above).  Once again, this is
another global issue that would affect any SWIG built extension.  It
ought to also affect gdal.dll, but that seems to work for me, don't know
  why.


Windows - MingW
--------------------------
Works, no issues


Os X
-------
Ken-ichi has reported that the bindings don't build on the Mac.
Unfortunately, I can't test that since I don't have one.  Not sure what
to do about that.


SWIG Version
------------

Last - I vaguely remember that the SWIG generated wrappers for Ruby were
  after swig 1.3.28 but before 1.3.29.  I see Ari has updated Perl to
1.3.29, the latest SWIG release, so I'll make sure the Ruby bindings are
at the same level.

Charlie

-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/x-pkcs7-signature
Size: 3237 bytes
Desc: S/MIME Cryptographic Signature
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060623/e309d224/smime.bin
From angusd at midwestsurveys.com  Fri Jun 23 17:00:42 2006
From: angusd at midwestsurveys.com (Angus Dickey)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] pixel/line-->georeferenced coordinates
Message-ID: <H00002670057f44b.1151096442.msicalmail.midwestsurveys.com@MHS>

Hey all,

I need a way map a pixel and line value of a georeferenced image (happens to be in UTM) to the actual coordinate, so I would like to be able to do this:

Input
-----
Pixel = 1256
Line = 4646

Output
------
x (e) = 368387
y (n) = 5633998

I don't think there are any gdal utilities capable of this. I am new to python and gdal but don't mind getting into it. Although I notice the warp API is only complete in C++. Would I be wasting my time trying to do this in python? Any recommendations or help is appreciated.

Thanks,

~Angus




From jluis at ualg.pt  Fri Jun 23 17:56:10 2006
From: jluis at ualg.pt (Joaquim Luis)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] The JP2ECW driver and NaNs
In-Reply-To: <449C4FF8.7090308@savagexi.com>
References: <449C4FF8.7090308@savagexi.com>
Message-ID: <449C637A.9070209@ualg.pt>

Hi,

I'm having some mysteries with the JP2ECW driver but this is, I think, a 
real issue.
I have matrices of different types that are saved in jpeg2000 format. 
When the matrix is of type float
and has NaNs something (not) funny happens. There is no error in the 
writing process but when I read
it back, the NaNs were converted to very large (+  and -) values.

The exact same code doesn't show any problems when I use the GTiff driver.

Joaquim Luis

From angusd at midwestsurveys.com  Fri Jun 23 18:26:43 2006
From: angusd at midwestsurveys.com (Angus Dickey)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] pixel/line-->georeferenced coordinates
In-Reply-To: <H00002670057f44b.1151096442.msicalmail.midwestsurveys.com@MHS>
Message-ID: <H00002670057f44f.1151101603.msicalmail.midwestsurveys.com@MHS>

Spoke too soon...

There is a python program in the pymod/samples directory that does almost exactly what I need.


-----Original Message-----
From: Angus Dickey 
Sent: June 23, 2006 3:01 PM
To: gdal-dev
Subject: [Gdal-dev] pixel/line-->georeferenced coordinates

Hey all,

I need a way map a pixel and line value of a georeferenced image (happens to be in UTM) to the actual coordinate, so I would like to be able to do this:

Input
-----
Pixel = 1256
Line = 4646

Output
------
x (e) = 368387
y (n) = 5633998

I don't think there are any gdal utilities capable of this. I am new to python and gdal but don't mind getting into it. Although I notice the warp API is only complete in C++. Would I be wasting my time trying to do this in python? Any recommendations or help is appreciated.

Thanks,

~Angus



_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev



From mateusz at loskot.net  Fri Jun 23 21:28:42 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] OGR can't handle Null values in a Date field
In-Reply-To: <1319fbba0606161402t240c8dd0u4f34c5e8148ef340@mail.gmail.com>
References: <1319fbba0606161402t240c8dd0u4f34c5e8148ef340@mail.gmail.com>
Message-ID: <449C954A.2000007@loskot.net>

Aaron Koning wrote:
> I have just started using a newer version of OGR that includes Date 
> support. (Context: I am importing shapefiles into PostgreSQL using 
> OGR/PHP). Unfortunately, when I there is a Null value in a Date field
>  of the input shapefile OGR bails (after successfully inserting 
> non-null values). From what I can see, it attempts to do an insert 
> with a '00/00/00 00:00:00' value and PostgreSQL states I may need 
> another Date type for this value.

Hi,

I tried to pump your sh
apefile to PostgresSQL using latest ogr2ogr
and I'm also getting date related errors but quite
different.

mloskot:~/tmp$ ogr2ogr -f PostgreSQL PG:dbname=gdal_nulldate dates.shp
ERROR 1: INSERT command for new feature failed.
ERROR:  invalid input syntax for type date: "2001/02/"

Command: INSERT INTO "dates" (WKB_GEOMETRY , "dstrbedate", "dstrbsdate")
 VALUES ('\\001\\003\\000\\000\\000\\001\\000
...
\\267,A', '2001/02/', '2001/02/')
ERROR 1: Terminating translation prematurely after failed
translation of layer dates

As ERROR message says, OGR parses dates as follows:
'2001/02/' and '2001/02/' what seems to be incorrect.

Your shapefile dates are in following format:
DSTRBEDATE DSTRBSDATE
20010207   20010207

I'm not sure why I'm getting this different error when using ogr2ogr
on my Linux box.

May be your PHP script does some additional step, preprocessing?

Frank,

Could you confirm if those dates in the Aaron's shapefile are in correct
format?


Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From neteler at itc.it  Sat Jun 24 03:37:41 2006
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] how gdal_rasterize works
In-Reply-To: <44958B49.9020704@pobox.com>
References: <448F214D.4010406@verizon.net> <44930EDB.5060909@pobox.com>
	<20060617122817.GB22351@bartok.itc.it> <44958B49.9020704@pobox.com>
Message-ID: <20060624073741.GB27889@bartok.itc.it>

On Sun, Jun 18, 2006 at 01:20:09PM -0400, Frank Warmerdam wrote:
> Markus Neteler wrote:
> >Hi,
> >
> >a stupid command line question: If a SHAPE is my starting point, how
> >to generate the needed raster map for "burn in" (if I don't
> >want to launch my GRASS machine for this)?
> >
> >Certainly easy, but I don't recall...
> 
> Markus,
> 
> Well, to be honest I don't know an easy way.  I would be tempted to
> gdal_translate an input file with the right number of bands, and
> use the various options to set the desired region, size in pixels and
> lines and coordinate system.
> 
> eg.
> 
>   gdal_translate in.tif wrk.tif -ot Byte -outsize 1000 1000 \
>             -a_ullr -117 33 -116 34 -a_srs WGS84
>

Frank,

I found a trick (for the record) to easily generate an "empty"
seed input file using the netpbm tools:


# Fetch extent from SHAPE file:
# ogrinfo -so mycircle.shp mycircle | grep Extent
# Extent: (669750.000000, 5107500.000000) - (671750.000000, 5109500.000000)
#               W               S                 E             N
W=669750
S=5107500
E=671750
N=5109500


# create 1 pixel seed file:
ppmmake white 1 1 | ppm2tiff tmp.tif

# enlarge to desired size and apply projection info:
gdal_translate tmp.tif mycircle.tif -ot Byte -outsize $XSIZE $YSIZE \
	-a_ullr $W $N $E $S -a_srs `cat mycircle.prj | tr -s ' ' '_'`

# "burn" SHAPE into raster map:
gdal_rasterize -b 1 -b 2 -b 3 -burn 255 -burn 0 -burn 0 \
	-l mycircle mycircle.shp mycircle.tif

Works!

BTW: Any ideas for a fancy shell based parsing of the SHAPE map
extent? In GRASS we have a flag for "shell style" output which
is pretty useful...

Best regards

 Markus


From cfis at savagexi.com  Sat Jun 24 03:50:35 2006
From: cfis at savagexi.com (Charlie Savage)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Ruby Bindings Update
In-Reply-To: <60c6835d0606240018j6754e36byb4dbfb0cccf2ae22@mail.gmail.com>
References: <449C4FF8.7090308@savagexi.com>
	<60c6835d0606240018j6754e36byb4dbfb0cccf2ae22@mail.gmail.com>
Message-ID: <449CEECB.3000405@savagexi.com>

[Sorry, meant to copy this to the list the first time]

Hey Shoaib,

  > Thanks for that Charlie
  >
  > I would be interested in porting some of my python scripts that use
  > gdal into ruby so i can start trying them in Rails.


That would be great.

  >
  > Just looking through the gdalautotest/ruby, it only has OGR stuff
  > there. I wouldn't mind helping out to create the ruby gdal tests.
  >

Interesting.  Under gdalautotest/ruby, you should see two directories -
ogr and osr.  If not, then make sure you're uptodate with CVS (although
I checked in the osr stuff in January, so that's probably not it).

  > So pointers on where to start, such as the dependencies & how to run
  > the gdal tests would be most welcome. I have got gdal-1.3.2 compiled
  > with the ruby bindings

Sure.  The way I would approach this (and what I did for ogr and osr):

1. Copy the gdalautotest\gcore directory and put the copy under
gdalautotest\ruby\gcore.

2.  Open up one of the python files.

3.  I then start at the top and work my way down, translating the Python
to Ruby (its not too hard, the languages are pretty close).  The reason
I port the Python code is because its a lot easier than coming up with
my own tests - and its a good baseline to make sure both languages are
doing the same thing.

4.  When porting, follow Ruby naming schemes.  So someObject.someMethod
becomes some_object.some_method (the swig bindings translate the names
under the covers).

5.  I use Ruby's unit test framework - that means you don't have to port
the bottom of each Python file which has some custom test running code.

6.  When ported, take the new Ruby file and name it tc_xxxx where tc is
"test case"

7.  Create a ts_xxx where ts is "test suite"  Add your new test case to
the test suite.  Obviously, you need just one ts file per directory.

9.  Run the test case, see what works and what doesn't work.

As you do the port, most stuff should work.  But you will undoubtedly
run into issues with the way SWIG exposes some of the API methods.

The things to look out for:

1.  Some API methods return new objects, and Ruby must be told this.
Hopefully you won't run into any of these since there was a lot of work
getting this right in the SWIG bindings shared by all languages.  You'll
know that you've got an issue if your test cases cause segmentation
faults (these become particularly obvious when running a full test suite
which gives everything time to blow up).

2.  There is also the inverse, you pass in an object as a parameter to
an API method and it takes over ownership.  Once again, hopefully you
won't run into this.  Once again, you'll know you have if you get
segmentation faults.

3.  This one you'll run into - sometimes an API method will return
something that SWIG doesn't know how to handle for Ruby.  For example, a
method might return a C++ standard library strstream.  Of course, Ruby
hasn't a clue what to do with that so a little wrapper code needs to
generated to convert it to a string.  These are called typemaps, and
there a bunch of them in the SWIG bindings.

So, if you can port the tests and show what works and what doesn't, I
can help out with tweaking the SWIG bindings if there are any problems.
   And as you write the tests, I can add them into the autotest project
for other to use as good examples in the future.

Hope this helps - feel free to ping me with any questions.

Charlie



Shoaib Burq wrote:
> 
> thanks
> shoaib
> -- 
> http://nomad-labs.com
> 
> On 6/24/06, Charlie Savage <cfis@savagexi.com> wrote:
>> Summary
>> -----------
>>
>> I've finally had a chance to look over the Ruby bindings again.  I
>> noticed a few build issues that I wanted to run by the list, see below
>> for more info.
>>
>> Overall, the Ruby bindings seem in good shape to me for OGR and OSR.
>> There is a full set of unit tests for these modules in the gdal autotest
>> project.
>>
>> However, they are not tested, and presumably do not work, for GDAL.
>> Most likely there are a couple api calls that need a little SWIG
>> tweaking.  Anyway, I don't have plans to do this since I only need the
>> OGR part of the bindings.  So if someone wants to make a final push on
>> GDAL let me know and I can point you in the right direction.
>>
>> Onto the build issues....
>>
>>
>> Linux - Fedora Core 5, Dell Dimension machine
>> --------------------------
>>
>> Compiling and installing the bindings works fine using the standard
>> build system (./configure, make, make install).
>>
>> Issue #1 - However, you can't use them due to selinux errors:
>>
>>      Cannot restore segment prot after reloc
>>
>> This has to do with text relocations.  The solution turns out to be
>> fairly simple, add -fpic or -fPIC when building shared libraries (like
>> the Ruby bindings).
>>
>> Should I
>>
>> a) add this parameter to CFLAGS in the RubyMakefile.mk
>>
>> - or -
>>
>> b) should this be added as a global build flag?  I'd imagine all the
>> other SWIG extensions, and the gdal shared library itself, should run
>> into the same issue.
>>
>>
>> Issue #2
>>
>> Ruby 1.8.4 moved its extension library from
>> /usr/lib/site-ruby/i386-linux to /usr/lib/ruby/site-ruby/i386-linux
>>
>> No big deal, since I ask Ruby where the directory is on installation.
>> However, it turns out that on a fresh ruby install the i386-linux
>> directory doesn't exist.  So the makefile now has a check for this.
>>
>>
>> Windows - VC 2005 NET
>> --------------------------
>> Another library issue.  With VC.NET 2005 all dlls must include an
>> embedded manifest at resource id #2.  Yeah, I know, why????  Anyway,
>> more information then you'd ever want to know about this is here:
>>
>> http://www.grimes.demon.co.uk/workshops/fusWSThirteen.htm
>>
>> Here's the issue.  If you build with Visual Studio, the manifest gets
>> embedded correctly.  If you use nmake, then it doesn't and you have to
>> add it manually use mt.exe (see link above).  Once again, this is
>> another global issue that would affect any SWIG built extension.  It
>> ought to also affect gdal.dll, but that seems to work for me, don't know
>>   why.
>>
>>
>> Windows - MingW
>> --------------------------
>> Works, no issues
>>
>>
>> Os X
>> -------
>> Ken-ichi has reported that the bindings don't build on the Mac.
>> Unfortunately, I can't test that since I don't have one.  Not sure what
>> to do about that.
>>
>>
>> SWIG Version
>> ------------
>>
>> Last - I vaguely remember that the SWIG generated wrappers for Ruby were
>>   after swig 1.3.28 but before 1.3.29.  I see Ari has updated Perl to
>> 1.3.29, the latest SWIG release, so I'll make sure the Ruby bindings are
>> at the same level.
>>
>> Charlie
>>
>>
>>
>> _______________________________________________
>> Gdal-dev mailing list
>> Gdal-dev@lists.maptools.org
>> http://lists.maptools.org/mailman/listinfo/gdal-dev
>>
>>
>>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/x-pkcs7-signature
Size: 3237 bytes
Desc: S/MIME Cryptographic Signature
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060624/56974de9/smime.bin
From woklist at kyngchaos.com  Sat Jun 24 15:40:27 2006
From: woklist at kyngchaos.com (William Kyngesburye)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] MrSID v6 update
Message-ID: <7B4639BC-0673-4E5F-908B-71ABF891A5AA@kyngchaos.com>

Looks like the MrSID DSDK v6 has finally been released.  Good news  
for Mac OS X users - it's finally comptible with GCC 4 on Tiger, AND  
is universal!

I made a GDAL plugin binary for Mac OS X to install on top of my GIS  
Libs package.  Since LizardTech still hasn't followed ERMapper's  
example and made their license explicitly open-source compatible, and  
it's still questionable whether it is or not, the plugin is a  
separate download from the GIS Libs package.

-----
William Kyngesburye <kyngchaos@kyngchaos.com>
http://www.kyngchaos.com/

"Time is an illusion - lunchtime doubly so."

- Ford Prefect


From fniles at mitre.org  Sat Jun 24 16:19:40 2006
From: fniles at mitre.org (Niles, Rick)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Who's doing the Fedora Extras RPM now?
Message-ID: <C75475395FBA894DB4C9C306D5A5C34E39AABF@IMCSRV1.MITRE.ORG>



I noticed on the Fedora list that they have closed the review of the
gdal RPM due to a combination of lack of response from the original
author (of the SPEC file) and that other people were interested in
picking it up.

This had taken way too long to get into Fedora Extras.  It makes it
difficult for any package that depends on it to have an simple install
on Fedora.

I'd be happy to give a try if no one else is really doing this.  

If someone else is actually doing something, want post the spec file
your using so we can give it a try?

Thanks,
Rick Niles.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060624/c594acea/attachment.html
From hobu at iastate.edu  Sat Jun 24 16:27:39 2006
From: hobu at iastate.edu (Howard Butler)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] MrSID v6 update
In-Reply-To: <7B4639BC-0673-4E5F-908B-71ABF891A5AA@kyngchaos.com>
References: <7B4639BC-0673-4E5F-908B-71ABF891A5AA@kyngchaos.com>
Message-ID: <p06230934c0c34dc25785@[192.168.11.4]>

William,

Definitely not open source, but the SDK libs are now 
redistributeable.  Michael Gerlek channeled the lawyers for Frank and 
I to share our concerns about our ability to redistribute things. 
See the REDISTRIBUTE.txt document for a synopsis of what is required 
(you can't distribute the 3rd_party stuff, need to credit LizardTech, 
and you need to carry their EULA around for that portion of the 
software).  These restrictions don't seem as onerous as they once 
were, and I thank the LizardTech folks for working the issues out. 
Additionally, the SDK can now be redistributed in my "buildkit" for 
Windows, which makes me and the few folks (MS4W) using it to make 
MapServer/GDAL builds very happy.

I was probably the one complaining the loudest about gcc 4 on OSX, 
and helped test it out on both the PowerPC and intelimac before 
release (against a CVS GDAL of about 2 weeks ago).  I made a 
suggestion of having a full Framework build of the SDK in the future, 
and I was told they'd look into it.

Hopefully someday the MrSID DSDK will be open source and we'll be 
able to recompile it wherever we need it (all those arcane 
architectures like IA64, linux on sparc, etc aren't covered 
currently).  Nonetheless, I see v6 of the MrSID SDK as a step forward.

Howard

At 2:40 PM -0500 6/24/06, William Kyngesburye wrote:
>Looks like the MrSID DSDK v6 has finally been released.  Good news 
>for Mac OS X users - it's finally comptible with GCC 4 on Tiger, AND 
>is universal!
>
>I made a GDAL plugin binary for Mac OS X to install on top of my GIS 
>Libs package.  Since LizardTech still hasn't followed ERMapper's 
>example and made their license explicitly open-source compatible, 
>and it's still questionable whether it is or not, the plugin is a 
>separate download from the GIS Libs package.
>
>-----
>William Kyngesburye <kyngchaos@kyngchaos.com>
>http://www.kyngchaos.com/
>
>"Time is an illusion - lunchtime doubly so."
>
>- Ford Prefect
>
>_______________________________________________
>Gdal-dev mailing list
>Gdal-dev@lists.maptools.org
>http://lists.maptools.org/mailman/listinfo/gdal-dev


From cfis at interserv.com  Fri Jun 23 06:55:34 2006
From: cfis at interserv.com (Charlie Savage)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Re: Compiling swigged wrappers under MinGW
In-Reply-To: <447E0454.10006@tkk.fi>
References: <447DAA19.7070008@tkk.fi> <447E0454.10006@tkk.fi>
Message-ID: <449BC8A6.8010802@interserv.com>

Ari,

Not sure if this is helpful anymore, but....

The trick with MingW I've found is link directly against the dlls. 
Don't bother with dlltool and .lib files.

So:

g++ -shared somedll.dll my_code.o -o mydll.dll

I've had good luck with the Ruby bindings and MinGW.

Charlie


Ari Jolma wrote:
> Ari Jolma kirjoitti:
>> I almost got the (perl) wrappers compiled under MinGW. The remaining 
>> problem is that ogr.dll and osr.dll won't like to be loaded at the 
>> same time. The swig interface ogr.i imports osr.i so that might cause 
>> the problem. However the problem does not exist in unix so I'm not yet 
>> sure what's going on.
> 
> Talking a bit to myself but anyway, I managed to build the modules and 
> my test code runs the same as in Linux. The generated dll's are a bit 
> large but that could probably be improved. The DLL problems -- which 
> were hard!...:-( -- seem to be related to the Perl module building 
> process and the way it uses the MinGW dlltool. Even the swigwin is not 
> perfect at least for Perl target. I'll post my results later on a webpage.
> 
> Good night,
> 
> Ari
> 


From cfis at interserv.com  Fri Jun 23 16:12:35 2006
From: cfis at interserv.com (Charlie Savage)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Re: ruby bindings not compiling from CVS
In-Reply-To: <44563376.1050206@nature.berkeley.edu>
References: <44563376.1050206@nature.berkeley.edu>
Message-ID: <449C4B33.9090407@interserv.com>

Hi Ken-ichi,

Sorry for such a long delay on this.  I checked this out - and can't 
duplicate it.

I can build the ruby bindings on Windows with VC++ 2005 and MingW and 
Fedora Core 5.  I don't have access to a Mac, so I can't check there. 
If you still want to investigate this more let me know and maybe we can 
figure out what is going on.

Charlie

Ken-ichi wrote:
> Hi all,
> 
> When I try to compile the latest CVS (4.30.06) version of GDAL 
> --with-ruby, configuring and compiling go off without a hitch, but when 
> I try to make install, I get this error:
> 
> (cd swig; make install)
> for dir in ruby ; do (cd $dir; make install ); done
> make -f RubyMakefile.mk install
> /bin/sh /usr/local/src/gdal-cvs-2006.04.30/libtool --mode=install 
> /usr/local/src/gdal-cvs-2006.04.30/install-sh -c gdal.so ogr.so 
> gdalconst.so osr.so 
> /usr/darwinports/lib/ruby/site_ruby/1.8/powerpc-darwin8.6.0/gdal
> /usr/local/src/gdal-cvs-2006.04.30/install-sh -c gdal.so 
> /usr/darwinports/lib/ruby/site_ruby/1.8/powerpc-darwin8.6.0/gdal/gdal.so
> install:  gdal.so does not exist
> make[3]: *** [install] Error 1
> make[2]: *** [install] Error 2
> make[1]: *** [install] Error 2
> make: *** [install-actions] Error 2
> 
> 
> It doesn't look like gdal.so is getting made at all.  I'm getting 
> basically the same error on Mac OS 10.4 and Gentoo Linux.  I do not get 
> this error on Gentoo with the 1.3.1 source (haven't tried that one on my 
> Mac yet).
> 
> Any thoughts?
> 


From cfis at interserv.com  Fri Jun 23 16:32:16 2006
From: cfis at interserv.com (Charlie Savage)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Ruby Bindings Update
Message-ID: <449C4FD0.7020201@interserv.com>

Summary
-----------

I've finally had a chance to look over the Ruby bindings again.  I 
noticed a few build issues that I wanted to run by the list, see below 
for more info.

Overall, the Ruby bindings seem in good shape to me for OGR and OSR. 
There is a full set of unit tests for these modules in the gdal autotest 
project.

However, they are not tested, and presumably do not work, for GDAL. 
Most likely there are a couple api calls that need a little SWIG 
tweaking.  Anyway, I don't have plans to do this since I only need the 
OGR part of the bindings.  So if someone wants to make a final push on 
GDAL let me know and I can point you in the right direction.

Onto the build issues....


Linux - Fedora Core 5, Dell Dimension machine
--------------------------

Compiling and installing the bindings works fine using the standard 
build system (./configure, make, make install).

Issue #1 - However, you can't use them due to selinux errors:

     Cannot restore segment prot after reloc

This has to do with text relocations.  The solution turns out to be 
fairly simple, add -fpic or -fPIC when building shared libraries (like 
the Ruby bindings).

Should I

a) add this parameter to CFLAGS in the RubyMakefile.mk

- or -

b) should this be added as a global build flag?  I'd imagine all the 
other SWIG extensions, and the gdal shared library itself, should run 
into the same issue.


Issue #2

Ruby 1.8.4 moved its extension library from 
/usr/lib/site-ruby/i386-linux to /usr/lib/ruby/site-ruby/i386-linux

No big deal, since I ask Ruby where the directory is on installation. 
However, it turns out that on a fresh ruby install the i386-linux 
directory doesn't exist.  So the makefile now has a check for this.


Windows - VC 2005 NET
--------------------------
Another library issue.  With VC.NET 2005 all dlls must include an 
embedded manifest at resource id #2.  Yeah, I know, why????  Anyway, 
more information then you'd ever want to know about this is here:

http://www.grimes.demon.co.uk/workshops/fusWSThirteen.htm

Here's the issue.  If you build with Visual Studio, the manifest gets 
embedded correctly.  If you use nmake, then it doesn't and you have to 
add it manually use mt.exe (see link above).  Once again, this is 
another global issue that would affect any SWIG built extension.  It 
ought to also affect gdal.dll, but that seems to work for me, don't know 
  why.


Windows - MingW
--------------------------
Works, no issues


Os X
-------
Ken-ichi has reported that the bindings don't build on the Mac. 
Unfortunately, I can't test that since I don't have one.  Not sure what 
to do about that.


SWIG Version
------------

Last - I vaguely remember that the SWIG generated wrappers for Ruby were 
  after swig 1.3.28 but before 1.3.29.  I see Ari has updated Perl to 
1.3.29, the latest SWIG release, so I'll make sure the Ruby bindings are 
at the same level.

Charlie

From hydromap at gmail.com  Sat Jun 24 23:11:30 2006
From: hydromap at gmail.com (Shoaib Burq)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Ruby Bindings Update
In-Reply-To: <449CEECB.3000405@savagexi.com>
References: <449C4FF8.7090308@savagexi.com>
	<60c6835d0606240018j6754e36byb4dbfb0cccf2ae22@mail.gmail.com>
	<449CEECB.3000405@savagexi.com>
Message-ID: <60c6835d0606242011v1e052fbcnfc39d2710050a2df@mail.gmail.com>

Brilliant! thanks for that I'll let you know how it goes
shoaib
On 6/24/06, Charlie Savage <cfis@savagexi.com> wrote:
> [Sorry, meant to copy this to the list the first time]
>
> Hey Shoaib,
>
>   > Thanks for that Charlie
>   >
>   > I would be interested in porting some of my python scripts that use
>   > gdal into ruby so i can start trying them in Rails.
>
>
> That would be great.
>
>   >
>   > Just looking through the gdalautotest/ruby, it only has OGR stuff
>   > there. I wouldn't mind helping out to create the ruby gdal tests.
>   >
>
> Interesting.  Under gdalautotest/ruby, you should see two directories -
> ogr and osr.  If not, then make sure you're uptodate with CVS (although
> I checked in the osr stuff in January, so that's probably not it).
>
>   > So pointers on where to start, such as the dependencies & how to run
>   > the gdal tests would be most welcome. I have got gdal-1.3.2 compiled
>   > with the ruby bindings
>
> Sure.  The way I would approach this (and what I did for ogr and osr):
>
> 1. Copy the gdalautotest\gcore directory and put the copy under
> gdalautotest\ruby\gcore.
>
> 2.  Open up one of the python files.
>
> 3.  I then start at the top and work my way down, translating the Python
> to Ruby (its not too hard, the languages are pretty close).  The reason
> I port the Python code is because its a lot easier than coming up with
> my own tests - and its a good baseline to make sure both languages are
> doing the same thing.
>
> 4.  When porting, follow Ruby naming schemes.  So someObject.someMethod
> becomes some_object.some_method (the swig bindings translate the names
> under the covers).
>
> 5.  I use Ruby's unit test framework - that means you don't have to port
> the bottom of each Python file which has some custom test running code.
>
> 6.  When ported, take the new Ruby file and name it tc_xxxx where tc is
> "test case"
>
> 7.  Create a ts_xxx where ts is "test suite"  Add your new test case to
> the test suite.  Obviously, you need just one ts file per directory.
>
> 9.  Run the test case, see what works and what doesn't work.
>
> As you do the port, most stuff should work.  But you will undoubtedly
> run into issues with the way SWIG exposes some of the API methods.
>
> The things to look out for:
>
> 1.  Some API methods return new objects, and Ruby must be told this.
> Hopefully you won't run into any of these since there was a lot of work
> getting this right in the SWIG bindings shared by all languages.  You'll
> know that you've got an issue if your test cases cause segmentation
> faults (these become particularly obvious when running a full test suite
> which gives everything time to blow up).
>
> 2.  There is also the inverse, you pass in an object as a parameter to
> an API method and it takes over ownership.  Once again, hopefully you
> won't run into this.  Once again, you'll know you have if you get
> segmentation faults.
>
> 3.  This one you'll run into - sometimes an API method will return
> something that SWIG doesn't know how to handle for Ruby.  For example, a
> method might return a C++ standard library strstream.  Of course, Ruby
> hasn't a clue what to do with that so a little wrapper code needs to
> generated to convert it to a string.  These are called typemaps, and
> there a bunch of them in the SWIG bindings.
>
> So, if you can port the tests and show what works and what doesn't, I
> can help out with tweaking the SWIG bindings if there are any problems.
>    And as you write the tests, I can add them into the autotest project
> for other to use as good examples in the future.
>
> Hope this helps - feel free to ping me with any questions.
>
> Charlie
>
>
>
> Shoaib Burq wrote:
> >
> > thanks
> > shoaib
> > --
> > http://nomad-labs.com
> >
> > On 6/24/06, Charlie Savage <cfis@savagexi.com> wrote:
> >> Summary
> >> -----------
> >>
> >> I've finally had a chance to look over the Ruby bindings again.  I
> >> noticed a few build issues that I wanted to run by the list, see below
> >> for more info.
> >>
> >> Overall, the Ruby bindings seem in good shape to me for OGR and OSR.
> >> There is a full set of unit tests for these modules in the gdal autotest
> >> project.
> >>
> >> However, they are not tested, and presumably do not work, for GDAL.
> >> Most likely there are a couple api calls that need a little SWIG
> >> tweaking.  Anyway, I don't have plans to do this since I only need the
> >> OGR part of the bindings.  So if someone wants to make a final push on
> >> GDAL let me know and I can point you in the right direction.
> >>
> >> Onto the build issues....
> >>
> >>
> >> Linux - Fedora Core 5, Dell Dimension machine
> >> --------------------------
> >>
> >> Compiling and installing the bindings works fine using the standard
> >> build system (./configure, make, make install).
> >>
> >> Issue #1 - However, you can't use them due to selinux errors:
> >>
> >>      Cannot restore segment prot after reloc
> >>
> >> This has to do with text relocations.  The solution turns out to be
> >> fairly simple, add -fpic or -fPIC when building shared libraries (like
> >> the Ruby bindings).
> >>
> >> Should I
> >>
> >> a) add this parameter to CFLAGS in the RubyMakefile.mk
> >>
> >> - or -
> >>
> >> b) should this be added as a global build flag?  I'd imagine all the
> >> other SWIG extensions, and the gdal shared library itself, should run
> >> into the same issue.
> >>
> >>
> >> Issue #2
> >>
> >> Ruby 1.8.4 moved its extension library from
> >> /usr/lib/site-ruby/i386-linux to /usr/lib/ruby/site-ruby/i386-linux
> >>
> >> No big deal, since I ask Ruby where the directory is on installation.
> >> However, it turns out that on a fresh ruby install the i386-linux
> >> directory doesn't exist.  So the makefile now has a check for this.
> >>
> >>
> >> Windows - VC 2005 NET
> >> --------------------------
> >> Another library issue.  With VC.NET 2005 all dlls must include an
> >> embedded manifest at resource id #2.  Yeah, I know, why????  Anyway,
> >> more information then you'd ever want to know about this is here:
> >>
> >> http://www.grimes.demon.co.uk/workshops/fusWSThirteen.htm
> >>
> >> Here's the issue.  If you build with Visual Studio, the manifest gets
> >> embedded correctly.  If you use nmake, then it doesn't and you have to
> >> add it manually use mt.exe (see link above).  Once again, this is
> >> another global issue that would affect any SWIG built extension.  It
> >> ought to also affect gdal.dll, but that seems to work for me, don't know
> >>   why.
> >>
> >>
> >> Windows - MingW
> >> --------------------------
> >> Works, no issues
> >>
> >>
> >> Os X
> >> -------
> >> Ken-ichi has reported that the bindings don't build on the Mac.
> >> Unfortunately, I can't test that since I don't have one.  Not sure what
> >> to do about that.
> >>
> >>
> >> SWIG Version
> >> ------------
> >>
> >> Last - I vaguely remember that the SWIG generated wrappers for Ruby were
> >>   after swig 1.3.28 but before 1.3.29.  I see Ari has updated Perl to
> >> 1.3.29, the latest SWIG release, so I'll make sure the Ruby bindings are
> >> at the same level.
> >>
> >> Charlie
> >>
> >>
> >>
> >> _______________________________________________
> >> Gdal-dev mailing list
> >> Gdal-dev@lists.maptools.org
> >> http://lists.maptools.org/mailman/listinfo/gdal-dev
> >>
> >>
> >>
>
>
>

From ari.jolma at tkk.fi  Sun Jun 25 15:00:49 2006
From: ari.jolma at tkk.fi (Ari Jolma)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Bugs in the bindings
Message-ID: <1151262049.449edd611538d@webmail2.hut.fi>

First, could we have the bindings as a component in Bugzilla?

Second, two bugs in ogr.i:

- CreateGeometryFromWk?: it is not nice to silently return null in case of an
error, I'm going to use croak(OGRErrMessages(err)) in Perl bindings

- SetPoint: test wkb25DBit and call ..SetPoint _or_ ..SetPoint_2D

Ari

-- 
Prof. Ari Jolma
Kartografia ja Geoinformatiikka / Cartography and Geoinformatics
Teknillinen Korkeakoulu / Helsinki University of Technology
POBox 1200, 02015 TKK, Finland
Email: ari.jolma at tkk.fi URL: http://www.tkk.fi/~jolma

From dave at cs.otago.ac.nz  Sun Jun 25 19:32:45 2006
From: dave at cs.otago.ac.nz (Dave Robertson)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] jp2kak on OSX
In-Reply-To: <200606230208.k5N27aH1028287@duke.maptools.org>
References: <200606230208.k5N27aH1028287@duke.maptools.org>
Message-ID: <C4D5166C-C455-4134-B5D3-685FAA588401@cs.otago.ac.nz>

Frank,
Thanks for the advice.

./configure --without-python --without-ecw --without-libtool --with- 
kakadu=< my absolute path to kakadu 5.1 >

Compiling gdal using the above configuration now returns a different  
set of undefined symbols, but still appears to be using libtool  
somewhere in the process.


ld: Undefined symbols:
__ZN11kdu_tiffdir12write_headerEP21kdu_compressed_targetx
__ZN11kdu_tiffdir4initEb
__ZN11kdu_tiffdir5closeEv
__ZN11kdu_tiffdir7opendirEP21kdu_compressed_source
__ZN11kdu_tiffdir8copy_tagERS_j
__ZN11kdu_tiffdir8open_tagEj
__ZN11kdu_tiffdir8read_tagEjiPd
__ZN11kdu_tiffdir8read_tagEjiPj
__ZN11kdu_tiffdir8read_tagEjiPt
__ZN11kdu_tiffdir8writedirEP21kdu_compressed_targetx
__ZN11kdu_tiffdir9write_tagEjiPd
__ZN11kdu_tiffdir9write_tagEjiPt
__ZN11kdu_tiffdir10create_tagEj
__ZN11kdu_tiffdir13get_dirlengthEv
__ZN11kdu_tiffdir9write_tagEjiPj
__ZN12jpx_metanode12get_existingERP14jp2_family_src
__ZN12jpx_metanode14get_descendantEi
__ZN12jpx_metanode8get_uuidEPh
__ZN16jpx_meta_manager11access_rootEv
/usr/bin/libtool: internal link edit command failed
make[1]: *** [/Volumes/FW28G/FW55G/projects/Searcher/gdal-kdu/ 
gdal-1.3.2/libgdal.dylib] Error 1
make: *** [check-lib] Error 2

Any suggestions?

Regards,
Dave Robertson.


>
> Dave Robertson wrote:
>> Hi,
>>
>> I'm trying to compile GDAL 1.3.2 with Kakadu v5.1 on OSX but make  
>> fails
>> with a lot of undefined symbols reported by libtool.
>> Looking back through the list and gdal changelogs, the latest  
>> version of
>> kakadu mentioned is 4.0.2 in GDAL 1.1.9
>>
>>>  JP2KAK Driver: Can be used with Kakadu 4.0.2 now.
>>
>> Are later versions of kakadu supported, or to do I have to revert to
>> Kakadu 4.0.2 ?
>
> Dave,
>
> I believe I have always used --without-libtool when building in Kakadu
> support on unix systems.  The problem is that we explicitly pull in a
> bunch of object files from Kakadu directly, rather than as a library
> (because that is the only way Kakadu seems to offer them), and this
> seriously confuses the libtool build which seems to expect to control
> all object files "its way".
>
> I'm pretty sure I have tried at least Kakadu 5.0 on Linux, so I
> don't *forsee* a problem with 5.1 o MacOS X.  Hmm, in fact I'm pretty
> sure I tried Kakadu 5.0 or 5.1 on MacOS X a couple weeks ago without
> any significant problem (using --without-libtool).
>
> Best regards,
> -- 







> Hi,
>
> I'm trying to compile GDAL 1.3.2 with Kakadu v5.1 on OSX but make
> fails with a lot of undefined symbols reported by libtool.
> Looking back through the list and gdal changelogs, the latest version
> of kakadu mentioned is 4.0.2 in GDAL 1.1.9
>
>>  JP2KAK Driver: Can be used with Kakadu 4.0.2 now.
>
> Are later versions of kakadu supported, or to do I have to revert to
> Kakadu 4.0.2 ?
>
> Thanks,
> Dave Robertson
>
>
>
> ld: Undefined symbols:
> __ZN10jp2_colour4initE16jp2_colour_space
> __ZN10jp2_source11read_headerEv
> __ZN10jp2_source14access_paletteEv
> __ZN10jp2_source15access_channelsEv
> __ZN10jp2_target12write_headerEv
> __ZN10jp2_target13access_colourEv
> __ZN10jp2_target14access_paletteEv
> __ZN10jp2_target15access_channelsEv
> __ZN10jp2_target15open_codestreamEb
> __ZN10jp2_target17access_dimensionsEv
> __ZN10jp2_target4openEP14jp2_family_tgt
> __ZN10jp2_targetD1Ev
> __ZN11jp2_palette12get_num_lutsEv
> __ZN11jp2_palette15get_num_entriesEv
> __ZN11jp2_palette4initEii
> __ZN11jp2_palette7get_lutEiPf
> __ZN11jp2_palette7set_lutEiPiib
> __ZN12jp2_channels15get_num_coloursEv
> __ZN12jp2_channels18get_colour_mappingEiRiS0_S0_
> __ZN12jp2_channels18set_colour_mappingEiiii
> __ZN12jp2_channels19get_opacity_mappingEiRiS0_S0_
> __ZN12jp2_channels19get_premult_mappingEiRiS0_S0_
> __ZN12jp2_channels19set_opacity_mappingEiiii
> __ZN12jp2_channels4initEi
> __ZN12kdu_roi_rectC1E14kdu_codestream8kdu_dims
> __ZN13jp2_input_boxC2Ev
> __ZN14jp2_dimensions4initEP10siz_paramsb
> __ZN14jp2_family_src4openEP21kdu_compressed_source
> __ZN14jp2_family_src4openEPKcb
> __ZN14jp2_family_src5closeEv
> __ZN14jp2_family_tgt4openEPKc
> __ZN14jp2_family_tgt5closeEv
> __ZN14jp2_output_box5closeEv
> __ZTV10jp2_source
> __ZTV10jp2_target
> /usr/bin/libtool: internal link edit command failed
> make[1]: *** [libgdal.la] Error 1
> make: *** [check-lib] Error 2

From neteler at itc.it  Mon Jun 26 03:11:35 2006
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Breaking long lines/boundaries with OGR function?
In-Reply-To: <20060626185237.067b53dd.hamish_nospam@yahoo.com>
References: <91d218430606241510j48bb8a4fy882b9af628e81165@mail.gmail.com>
	<20060626185237.067b53dd.hamish_nospam@yahoo.com>
Message-ID: <20060626071134.GA15993@bartok.itc.it>

Hi,

the following issue came up in GRASS:
v.in.ogr, the OGR based import tool, may take a long time if
the data contains long complicated polylines.

>From TODO
http://freegis.org/cgi-bin/viewcvs.cgi/grass6/doc/vector/TODO
> ============================
> v.in.ogr
> --------
> It would be useful to split long boundaries to smaller
> pieces. Otherwise cleaning process can become very slow because
> bounding box of long boundaries can overlap large part of the map (for
> example outline around all areas) and cleaning process is checking
> intersection with all boundaries falling in the bounding box.
> ============================

Since I don't know OGR well enough, is there any function 
we could make use of to achieve splitting of long lines before
handing data over to (topological) GRASS?

I found 
http://ogr.maptools.org/drv_dgn.html
"Polygons and line strings with too many vertices will be split into
 a group of elmements prefixed with a Complex Shape Header or Complex
 Chain Header element as appropriate."

Something seems to be there (or nearby).

thanks for a hint

 Markus

From ari.jolma at tkk.fi  Mon Jun 26 03:53:24 2006
From: ari.jolma at tkk.fi (Ari Jolma)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Breaking long lines/boundaries with OGR function?
In-Reply-To: <20060626071134.GA15993@bartok.itc.it>
References: <91d218430606241510j48bb8a4fy882b9af628e81165@mail.gmail.com>
	<20060626185237.067b53dd.hamish_nospam@yahoo.com>
	<20060626071134.GA15993@bartok.itc.it>
Message-ID: <1151308404.449f927452797@webmail1.hut.fi>

Markus,

I'm not sure why the import should be effected by the spatial extents etc. In my
code I "import" data from OGR each time I render it and there's no big overhead
because of that. The code is also extremely simple. What would you consider
"complicated"? I've for example looked at ghssh coastline data and they render
reasonably fast.

Of course I don't know much about the way GRASS stored vector data or about the
import tool :-)

Ari

On Mon, 26 Jun 2006 09:11:35 +0200 Markus Neteler <neteler@itc.it> wrote:

> Hi,
> 
> the following issue came up in GRASS:
> v.in.ogr, the OGR based import tool, may take a long time if
> the data contains long complicated polylines.
> 
> >From TODO
> http://freegis.org/cgi-bin/viewcvs.cgi/grass6/doc/vector/TODO
> > ============================
> > v.in.ogr
> > --------
> > It would be useful to split long boundaries to smaller
> > pieces. Otherwise cleaning process can become very slow because
> > bounding box of long boundaries can overlap large part of the map
> (for
> > example outline around all areas) and cleaning process is checking
> > intersection with all boundaries falling in the bounding box.
> > ============================
> 
> Since I don't know OGR well enough, is there any function 
> we could make use of to achieve splitting of long lines before
> handing data over to (topological) GRASS?
> 
> I found 
> http://ogr.maptools.org/drv_dgn.html
> "Polygons and line strings with too many vertices will be split into
>  a group of elmements prefixed with a Complex Shape Header or Complex
>  Chain Header element as appropriate."
> 
> Something seems to be there (or nearby).
> 
> thanks for a hint
> 
>  Markus
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
> 

-- 
Prof. Ari Jolma
Kartografia ja Geoinformatiikka / Cartography and Geoinformatics
Teknillinen Korkeakoulu / Helsinki University of Technology
POBox 1200, 02015 TKK, Finland
Email: ari.jolma at tkk.fi URL: http://www.tkk.fi/~jolma

From neteler at itc.it  Mon Jun 26 04:16:06 2006
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Breaking long lines/boundaries with OGR function?
In-Reply-To: <1151308404.449f927452797@webmail1.hut.fi>
References: <91d218430606241510j48bb8a4fy882b9af628e81165@mail.gmail.com>
	<20060626185237.067b53dd.hamish_nospam@yahoo.com>
	<20060626071134.GA15993@bartok.itc.it>
	<1151308404.449f927452797@webmail1.hut.fi>
Message-ID: <20060626081606.GD15993@bartok.itc.it>

Ari,

of course the pure import is fast, but the reconstruction
of topology takes time. Our idea is to deliver the data
in a way more suitable to fast topology reconstruction.
It's all about topology - I guess that your renderer
doesn't built it.

Hope this clarifies the idea (I'm no topology expert...),

 Markus


On Mon, Jun 26, 2006 at 10:53:24AM +0300, Ari Jolma wrote:
> Markus,
> 
> I'm not sure why the import should be effected by the spatial extents etc. In my
> code I "import" data from OGR each time I render it and there's no big overhead
> because of that. The code is also extremely simple. What would you consider
> "complicated"? I've for example looked at ghssh coastline data and they render
> reasonably fast.
> 
> Of course I don't know much about the way GRASS stored vector data or about the
> import tool :-)
> 
> Ari
> 
> On Mon, 26 Jun 2006 09:11:35 +0200 Markus Neteler <neteler@itc.it> wrote:
> 
> > Hi,
> > 
> > the following issue came up in GRASS:
> > v.in.ogr, the OGR based import tool, may take a long time if
> > the data contains long complicated polylines.
> > 
> > >From TODO
> > http://freegis.org/cgi-bin/viewcvs.cgi/grass6/doc/vector/TODO
> > > ============================
> > > v.in.ogr
> > > --------
> > > It would be useful to split long boundaries to smaller
> > > pieces. Otherwise cleaning process can become very slow because
> > > bounding box of long boundaries can overlap large part of the map
> > (for
> > > example outline around all areas) and cleaning process is checking
> > > intersection with all boundaries falling in the bounding box.
> > > ============================
> > 
> > Since I don't know OGR well enough, is there any function 
> > we could make use of to achieve splitting of long lines before
> > handing data over to (topological) GRASS?
> > 
> > I found 
> > http://ogr.maptools.org/drv_dgn.html
> > "Polygons and line strings with too many vertices will be split into
> >  a group of elmements prefixed with a Complex Shape Header or Complex
> >  Chain Header element as appropriate."
> > 
> > Something seems to be there (or nearby).
> > 
> > thanks for a hint
> > 
> >  Markus
> > _______________________________________________
> > Gdal-dev mailing list
> > Gdal-dev@lists.maptools.org
> > http://lists.maptools.org/mailman/listinfo/gdal-dev
> > 
> 
> -- 
> Prof. Ari Jolma
> Kartografia ja Geoinformatiikka / Cartography and Geoinformatics
> Teknillinen Korkeakoulu / Helsinki University of Technology
> POBox 1200, 02015 TKK, Finland
> Email: ari.jolma at tkk.fi URL: http://www.tkk.fi/~jolma

-- 
Markus Neteler  <neteler itc it>  http://mpa.itc.it/markus/
ITC-irst -  Centro per la Ricerca Scientifica e Tecnologica
MPBA - Predictive Models for Biol. & Environ. Data Analysis
Via Sommarive, 18        -       38050 Povo (Trento), Italy

From ari.jolma at tkk.fi  Mon Jun 26 04:53:14 2006
From: ari.jolma at tkk.fi (Ari Jolma)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Breaking long lines/boundaries with OGR function?
In-Reply-To: <20060626081606.GD15993@bartok.itc.it>
References: <91d218430606241510j48bb8a4fy882b9af628e81165@mail.gmail.com>
	<20060626185237.067b53dd.hamish_nospam@yahoo.com>
	<20060626071134.GA15993@bartok.itc.it>
	<1151308404.449f927452797@webmail1.hut.fi>
	<20060626081606.GD15993@bartok.itc.it>
Message-ID: <1151311994.449fa07ab9455@webmail1.hut.fi>

On Mon, 26 Jun 2006 10:16:06 +0200 Markus Neteler <neteler@itc.it> wrote:

> Ari,
> 
> of course the pure import is fast, but the reconstruction
> of topology takes time. Our idea is to deliver the data
> in a way more suitable to fast topology reconstruction.
> It's all about topology - I guess that your renderer
> doesn't built it.

No, I suspected something like this. Then the bottleneck is in the usage of the
topology code, which is GEOS in the case of OGR, I believe. Topological
operations on complicated geometries are more or less inherently slow.

In v.in.ogr you have more or direct access to OGR data and you can easily split
the data into smaller pieces for your own use. Since this splitting is an
optimization which depends on the need and there is no "logical" way for doing
it generally, I don't think there is a suitable existing function in OGR for
doing it. At least I can't think of anything now. Of course I maybe wrong and
Frank points out something that I can't think now ;)

Ari

> 
> Hope this clarifies the idea (I'm no topology expert...),
> 
>  Markus
> 
> 
> On Mon, Jun 26, 2006 at 10:53:24AM +0300, Ari Jolma wrote:
> > Markus,
> > 
> > I'm not sure why the import should be effected by the spatial extents
> etc. In my
> > code I "import" data from OGR each time I render it and there's no
> big overhead
> > because of that. The code is also extremely simple. What would you
> consider
> > "complicated"? I've for example looked at ghssh coastline data and
> they render
> > reasonably fast.
> > 
> > Of course I don't know much about the way GRASS stored vector data or
> about the
> > import tool :-)
> > 
> > Ari
> > 
> > On Mon, 26 Jun 2006 09:11:35 +0200 Markus Neteler <neteler@itc.it> 
> wrote:
> > 
> > > Hi,
> > > 
> > > the following issue came up in GRASS:
> > > v.in.ogr, the OGR based import tool, may take a long time if
> > > the data contains long complicated polylines.
> > > 
> > > >From TODO
> > > http://freegis.org/cgi-bin/viewcvs.cgi/grass6/doc/vector/TODO
> > > > ============================
> > > > v.in.ogr
> > > > --------
> > > > It would be useful to split long boundaries to smaller
> > > > pieces. Otherwise cleaning process can become very slow because
> > > > bounding box of long boundaries can overlap large part of the map
> > > (for
> > > > example outline around all areas) and cleaning process is
> checking
> > > > intersection with all boundaries falling in the bounding box.
> > > > ============================
> > > 
> > > Since I don't know OGR well enough, is there any function 
> > > we could make use of to achieve splitting of long lines before
> > > handing data over to (topological) GRASS?
> > > 
> > > I found 
> > > http://ogr.maptools.org/drv_dgn.html
> > > "Polygons and line strings with too many vertices will be split
> into
> > >  a group of elmements prefixed with a Complex Shape Header or
> Complex
> > >  Chain Header element as appropriate."
> > > 
> > > Something seems to be there (or nearby).
> > > 
> > > thanks for a hint
> > > 
> > >  Markus
> > > _______________________________________________
> > > Gdal-dev mailing list
> > > Gdal-dev@lists.maptools.org
> > > http://lists.maptools.org/mailman/listinfo/gdal-dev
> > > 
> > 
> > -- 
> > Prof. Ari Jolma
> > Kartografia ja Geoinformatiikka / Cartography and Geoinformatics
> > Teknillinen Korkeakoulu / Helsinki University of Technology
> > POBox 1200, 02015 TKK, Finland
> > Email: ari.jolma at tkk.fi URL: http://www.tkk.fi/~jolma
> 
> -- 
> Markus Neteler  <neteler itc it>  http://mpa.itc.it/markus/
> ITC-irst -  Centro per la Ricerca Scientifica e Tecnologica
> MPBA - Predictive Models for Biol. & Environ. Data Analysis
> Via Sommarive, 18        -       38050 Povo (Trento), Italy
> 

-- 
Prof. Ari Jolma
Kartografia ja Geoinformatiikka / Cartography and Geoinformatics
Teknillinen Korkeakoulu / Helsinki University of Technology
POBox 1200, 02015 TKK, Finland
Email: ari.jolma at tkk.fi URL: http://www.tkk.fi/~jolma

From mateusz at loskot.net  Mon Jun 26 05:03:02 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] [boost] GIL - is there interest for an image library in
	Boost?
Message-ID: <449FA2C6.4030809@loskot.net>

Hi,

A few days ago, interesting announcement was posted on the Boost mailing
list. It became a bigger discussion too.
Lubomir announced interesting project called GIL - Generic Image Library.
I believe, this may be also interesting to the GDAL Community.

I pasted the Lubomir's original message below.
The complete discussion is available here:
http://thread.gmane.org/gmane.comp.lib.boost.devel/143452/focus=143452

I hope you don't mind I'm forwarding this message here.
Cheers
Mateusz

--- Original Message ---
From: Lubomir Bourdev <lbourdev <at> adobe.com>
Subject: GIL - is there interest for an image library in Boost?
Newsgroups: gmane.comp.lib.boost.devel
Date: 2006-06-05 04:46:01 GMT (3 weeks, 4 hours and 12 minutes ago)

Hello,

We have developed the Generic Image Library (GIL) - a library that
abstracts away the image representation from algorithms written for
images. It allows for writing the algorithm once and having it work for
images in any color space, channel depth and pixel organization with
performance comparable to writing the code for each specific image
format.

GIL is currently part of the Adobe Open Source Libraries and we use it
for several imaging projects inside Adobe. Its only dependency is boost.

You can find the sources and documentation at GIL's home page:

http://opensource.adobe.com/gil

Is there an interest for having GIL be a boost library?

Also, I would appreciate any recommendations for improving the design of
GIL.

Thanks,


-- 
Mateusz Loskot
http://mateusz.loskot.net

From neteler at itc.it  Mon Jun 26 05:27:31 2006
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Breaking long lines/boundaries with OGR function?
In-Reply-To: <1151311994.449fa07ab9455@webmail1.hut.fi>
References: <91d218430606241510j48bb8a4fy882b9af628e81165@mail.gmail.com>
	<20060626185237.067b53dd.hamish_nospam@yahoo.com>
	<20060626071134.GA15993@bartok.itc.it>
	<1151308404.449f927452797@webmail1.hut.fi>
	<20060626081606.GD15993@bartok.itc.it>
	<1151311994.449fa07ab9455@webmail1.hut.fi>
Message-ID: <20060626092731.GE15993@bartok.itc.it>

On Mon, Jun 26, 2006 at 11:53:14AM +0300, Ari Jolma wrote:
> On Mon, 26 Jun 2006 10:16:06 +0200 Markus Neteler <neteler@itc.it> wrote:
> 
> > Ari,
> > 
> > of course the pure import is fast, but the reconstruction
> > of topology takes time. Our idea is to deliver the data
> > in a way more suitable to fast topology reconstruction.
> > It's all about topology - I guess that your renderer
> > doesn't built it.
> 
> No, I suspected something like this. Then the bottleneck is in the usage of the
> topology code, which is GEOS in the case of OGR, I believe. Topological
> operations on complicated geometries are more or less inherently slow.

No - GEOS isn't used here. To again better explain: The chain is
(SHAPE example):

SHAPE -> 
  OGR -> OGR_G_GetGeometryRef(), OGR_G_GetPointCount() etc ->
    GRASS level1 (non-top.) -> Vect_build() -> GRASS level2 (topological)

Vect_build() is sometimes slow as indicated below.

> In v.in.ogr you have more or direct access to OGR data and you can easily split
> the data into smaller pieces for your own use.

Right, this was my question.

> Since this splitting is an
> optimization which depends on the need and there is no "logical" way for doing
> it generally, I don't think there is a suitable existing function in OGR for
> doing it. At least I can't think of anything now. Of course I maybe wrong and
> Frank points out something that I can't think now ;)

Maybe there is a function to break lines with given threshold?
Not sure what to look for exactly.

Markus
 
> Ari
> 
> > 
> > Hope this clarifies the idea (I'm no topology expert...),
> > 
> >  Markus
> > 
> > 
> > On Mon, Jun 26, 2006 at 10:53:24AM +0300, Ari Jolma wrote:
> > > Markus,
> > > 
> > > I'm not sure why the import should be effected by the spatial extents
> > etc. In my
> > > code I "import" data from OGR each time I render it and there's no
> > big overhead
> > > because of that. The code is also extremely simple. What would you
> > consider
> > > "complicated"? I've for example looked at ghssh coastline data and
> > they render
> > > reasonably fast.
> > > 
> > > Of course I don't know much about the way GRASS stored vector data or
> > about the
> > > import tool :-)
> > > 
> > > Ari
> > > 
> > > On Mon, 26 Jun 2006 09:11:35 +0200 Markus Neteler <neteler@itc.it> 
> > wrote:
> > > 
> > > > Hi,
> > > > 
> > > > the following issue came up in GRASS:
> > > > v.in.ogr, the OGR based import tool, may take a long time if
> > > > the data contains long complicated polylines.
> > > > 
> > > > >From TODO
> > > > http://freegis.org/cgi-bin/viewcvs.cgi/grass6/doc/vector/TODO
> > > > > ============================
> > > > > v.in.ogr
> > > > > --------
> > > > > It would be useful to split long boundaries to smaller
> > > > > pieces. Otherwise cleaning process can become very slow because
> > > > > bounding box of long boundaries can overlap large part of the map
> > > > (for
> > > > > example outline around all areas) and cleaning process is
> > checking
> > > > > intersection with all boundaries falling in the bounding box.
> > > > > ============================
> > > > 
> > > > Since I don't know OGR well enough, is there any function 
> > > > we could make use of to achieve splitting of long lines before
> > > > handing data over to (topological) GRASS?
> > > > 
> > > > I found 
> > > > http://ogr.maptools.org/drv_dgn.html
> > > > "Polygons and line strings with too many vertices will be split
> > into
> > > >  a group of elmements prefixed with a Complex Shape Header or
> > Complex
> > > >  Chain Header element as appropriate."
> > > > 
> > > > Something seems to be there (or nearby).
> > > > 
> > > > thanks for a hint
> > > > 
> > > >  Markus
> > > > _______________________________________________
> > > > Gdal-dev mailing list
> > > > Gdal-dev@lists.maptools.org
> > > > http://lists.maptools.org/mailman/listinfo/gdal-dev
> > > > 
> > > 
> > > -- 
> > > Prof. Ari Jolma
> > > Kartografia ja Geoinformatiikka / Cartography and Geoinformatics
> > > Teknillinen Korkeakoulu / Helsinki University of Technology
> > > POBox 1200, 02015 TKK, Finland
> > > Email: ari.jolma at tkk.fi URL: http://www.tkk.fi/~jolma
> > 
> > -- 
> > Markus Neteler  <neteler itc it>  http://mpa.itc.it/markus/
> > ITC-irst -  Centro per la Ricerca Scientifica e Tecnologica
> > MPBA - Predictive Models for Biol. & Environ. Data Analysis
> > Via Sommarive, 18        -       38050 Povo (Trento), Italy
> > 
> 
> -- 
> Prof. Ari Jolma
> Kartografia ja Geoinformatiikka / Cartography and Geoinformatics
> Teknillinen Korkeakoulu / Helsinki University of Technology
> POBox 1200, 02015 TKK, Finland
> Email: ari.jolma at tkk.fi URL: http://www.tkk.fi/~jolma
> 

-- 
Markus Neteler  <neteler itc it>  http://mpa.itc.it/markus/
ITC-irst -  Centro per la Ricerca Scientifica e Tecnologica
MPBA - Predictive Models for Biol. & Environ. Data Analysis
Via Sommarive, 18        -       38050 Povo (Trento), Italy

From collinsb at mitre.org  Mon Jun 26 09:26:11 2006
From: collinsb at mitre.org (Collins, Benjamin)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] jp2kak on OSX
In-Reply-To: <C4D5166C-C455-4134-B5D3-685FAA588401@cs.otago.ac.nz>
Message-ID: <8D27E2CDAF11D34F97E7445BCCCDB92CF6D062@IMCSRV1.MITRE.ORG>

In Kakadu 5.1 there are two (new?) shared objcet files that are not
explicitly mentioned in the GNUMakefile in frmts/jp2kak.  These files
are:
<kdu_dir>/apps/make/jpx.o
<kdu_dir>/apps/make/kdu_tiff.o

If those file are added to the GNUMakefile you will proabaly be able to
build correctly.  I did not check the change into CVS because I'm
concerned that doing so would break gdal builds for old versions of
kakadu.

--
Ben Collins

>-----Original Message-----
>From: gdal-dev-bounces@lists.maptools.org 
>[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Dave 
>Robertson
>Sent: Sunday, June 25, 2006 7:33 PM
>To: gdal-dev@lists.maptools.org
>Subject: [Gdal-dev] jp2kak on OSX
>
>Frank,
>Thanks for the advice.
>
>./configure --without-python --without-ecw --without-libtool --with- 
>kakadu=< my absolute path to kakadu 5.1 >
>
>Compiling gdal using the above configuration now returns a different  
>set of undefined symbols, but still appears to be using libtool  
>somewhere in the process.
>
>
>ld: Undefined symbols:
>__ZN11kdu_tiffdir12write_headerEP21kdu_compressed_targetx
>__ZN11kdu_tiffdir4initEb
>__ZN11kdu_tiffdir5closeEv
>__ZN11kdu_tiffdir7opendirEP21kdu_compressed_source
>__ZN11kdu_tiffdir8copy_tagERS_j
>__ZN11kdu_tiffdir8open_tagEj
>__ZN11kdu_tiffdir8read_tagEjiPd
>__ZN11kdu_tiffdir8read_tagEjiPj
>__ZN11kdu_tiffdir8read_tagEjiPt
>__ZN11kdu_tiffdir8writedirEP21kdu_compressed_targetx
>__ZN11kdu_tiffdir9write_tagEjiPd
>__ZN11kdu_tiffdir9write_tagEjiPt
>__ZN11kdu_tiffdir10create_tagEj
>__ZN11kdu_tiffdir13get_dirlengthEv
>__ZN11kdu_tiffdir9write_tagEjiPj
>__ZN12jpx_metanode12get_existingERP14jp2_family_src
>__ZN12jpx_metanode14get_descendantEi
>__ZN12jpx_metanode8get_uuidEPh
>__ZN16jpx_meta_manager11access_rootEv
>/usr/bin/libtool: internal link edit command failed
>make[1]: *** [/Volumes/FW28G/FW55G/projects/Searcher/gdal-kdu/ 
>gdal-1.3.2/libgdal.dylib] Error 1
>make: *** [check-lib] Error 2
>
>Any suggestions?
>
>Regards,
>Dave Robertson.
>
>
>>
>> Dave Robertson wrote:
>>> Hi,
>>>
>>> I'm trying to compile GDAL 1.3.2 with Kakadu v5.1 on OSX but make  
>>> fails
>>> with a lot of undefined symbols reported by libtool.
>>> Looking back through the list and gdal changelogs, the latest  
>>> version of
>>> kakadu mentioned is 4.0.2 in GDAL 1.1.9
>>>
>>>>  JP2KAK Driver: Can be used with Kakadu 4.0.2 now.
>>>
>>> Are later versions of kakadu supported, or to do I have to revert
to
>>> Kakadu 4.0.2 ?
>>
>> Dave,
>>
>> I believe I have always used --without-libtool when building 
>in Kakadu
>> support on unix systems.  The problem is that we explicitly pull in
a
>> bunch of object files from Kakadu directly, rather than as a library
>> (because that is the only way Kakadu seems to offer them), and this
>> seriously confuses the libtool build which seems to expect to
control
>> all object files "its way".
>>
>> I'm pretty sure I have tried at least Kakadu 5.0 on Linux, so I
>> don't *forsee* a problem with 5.1 o MacOS X.  Hmm, in fact I'm
pretty
>> sure I tried Kakadu 5.0 or 5.1 on MacOS X a couple weeks ago without
>> any significant problem (using --without-libtool).
>>
>> Best regards,
>> -- 
>
>
>
>
>
>
>
>> Hi,
>>
>> I'm trying to compile GDAL 1.3.2 with Kakadu v5.1 on OSX but make
>> fails with a lot of undefined symbols reported by libtool.
>> Looking back through the list and gdal changelogs, the latest
version
>> of kakadu mentioned is 4.0.2 in GDAL 1.1.9
>>
>>>  JP2KAK Driver: Can be used with Kakadu 4.0.2 now.
>>
>> Are later versions of kakadu supported, or to do I have to revert to
>> Kakadu 4.0.2 ?
>>
>> Thanks,
>> Dave Robertson
>>
>>
>>
>> ld: Undefined symbols:
>> __ZN10jp2_colour4initE16jp2_colour_space
>> __ZN10jp2_source11read_headerEv
>> __ZN10jp2_source14access_paletteEv
>> __ZN10jp2_source15access_channelsEv
>> __ZN10jp2_target12write_headerEv
>> __ZN10jp2_target13access_colourEv
>> __ZN10jp2_target14access_paletteEv
>> __ZN10jp2_target15access_channelsEv
>> __ZN10jp2_target15open_codestreamEb
>> __ZN10jp2_target17access_dimensionsEv
>> __ZN10jp2_target4openEP14jp2_family_tgt
>> __ZN10jp2_targetD1Ev
>> __ZN11jp2_palette12get_num_lutsEv
>> __ZN11jp2_palette15get_num_entriesEv
>> __ZN11jp2_palette4initEii
>> __ZN11jp2_palette7get_lutEiPf
>> __ZN11jp2_palette7set_lutEiPiib
>> __ZN12jp2_channels15get_num_coloursEv
>> __ZN12jp2_channels18get_colour_mappingEiRiS0_S0_
>> __ZN12jp2_channels18set_colour_mappingEiiii
>> __ZN12jp2_channels19get_opacity_mappingEiRiS0_S0_
>> __ZN12jp2_channels19get_premult_mappingEiRiS0_S0_
>> __ZN12jp2_channels19set_opacity_mappingEiiii
>> __ZN12jp2_channels4initEi
>> __ZN12kdu_roi_rectC1E14kdu_codestream8kdu_dims
>> __ZN13jp2_input_boxC2Ev
>> __ZN14jp2_dimensions4initEP10siz_paramsb
>> __ZN14jp2_family_src4openEP21kdu_compressed_source
>> __ZN14jp2_family_src4openEPKcb
>> __ZN14jp2_family_src5closeEv
>> __ZN14jp2_family_tgt4openEPKc
>> __ZN14jp2_family_tgt5closeEv
>> __ZN14jp2_output_box5closeEv
>> __ZTV10jp2_source
>> __ZTV10jp2_target
>> /usr/bin/libtool: internal link edit command failed
>> make[1]: *** [libgdal.la] Error 1
>> make: *** [check-lib] Error 2
>_______________________________________________
>Gdal-dev mailing list
>Gdal-dev@lists.maptools.org
>http://lists.maptools.org/mailman/listinfo/gdal-dev
>


From warmerdam at pobox.com  Mon Jun 26 11:15:06 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Breaking long lines/boundaries with OGR function?
In-Reply-To: <20060626071134.GA15993@bartok.itc.it>
References: <91d218430606241510j48bb8a4fy882b9af628e81165@mail.gmail.com>	<20060626185237.067b53dd.hamish_nospam@yahoo.com>
	<20060626071134.GA15993@bartok.itc.it>
Message-ID: <449FF9FA.9040905@pobox.com>

Markus Neteler wrote:
> Hi,
> 
> the following issue came up in GRASS:
> v.in.ogr, the OGR based import tool, may take a long time if
> the data contains long complicated polylines.
> 
>>From TODO
> http://freegis.org/cgi-bin/viewcvs.cgi/grass6/doc/vector/TODO
>> ============================
>> v.in.ogr
>> --------
>> It would be useful to split long boundaries to smaller
>> pieces. Otherwise cleaning process can become very slow because
>> bounding box of long boundaries can overlap large part of the map (for
>> example outline around all areas) and cleaning process is checking
>> intersection with all boundaries falling in the bounding box.
>> ============================
> 
> Since I don't know OGR well enough, is there any function 
> we could make use of to achieve splitting of long lines before
> handing data over to (topological) GRASS?
> 
> I found 
> http://ogr.maptools.org/drv_dgn.html
> "Polygons and line strings with too many vertices will be split into
>  a group of elmements prefixed with a Complex Shape Header or Complex
>  Chain Header element as appropriate."
> 
> Something seems to be there (or nearby).

Markus,

It would not be particularly hard to have v.in.ogr break linestrings with
a lot of vertices into distinct geometries though it isn't clear to me
that this would really accelerate topology building.  There is no "canned"
method in OGR for splitting features though.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From warmerdam at pobox.com  Mon Jun 26 11:37:48 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Bugs in the bindings
In-Reply-To: <1151262049.449edd611538d@webmail2.hut.fi>
References: <1151262049.449edd611538d@webmail2.hut.fi>
Message-ID: <449FFF4C.5070406@pobox.com>

Ari Jolma wrote:
> First, could we have the bindings as a component in Bugzilla?

Ari,

I've created new GDAL/OGR components for:
  * PerlBindings - defaults to Ari
  * PythonBindings - defaults to me.
  * JavaBindings - defaults to me.
  * RubyBindings - defaults to Charlie.

> Second, two bugs in ogr.i:
> 
> - CreateGeometryFromWk?: it is not nice to silently return null in case of an
> error, I'm going to use croak(OGRErrMessages(err)) in Perl bindings

It would seem in general that an error should be produced on failure.

> - SetPoint: test wkb25DBit and call ..SetPoint _or_ ..SetPoint_2D

I'm not too sure what you mean.  In the NG bindings I see:

   %feature("kwargs") SetPoint;
   void SetPoint(int point, double x, double y, double z=0) {
     OGR_G_SetPoint(self, point, x, y, z);
   }

In the old bindings we have:


     def SetPoint( self, i, x, y, z = 0):
         return _gdal.OGR_G_SetPoint( self._o, i, x, y, z )

     def SetPoint_2D( self, i, x, y):
         return _gdal.OGR_G_SetPoint_2D( self._o, i, x, y )

What would you be doing the wkb25DBit check on in the new bindings?  I
suspect we ought to offer two methods, a SetPoint() method which is
implicitly 3D and SetPoint_2D() which is 2D.

It would be nicer if we could have distinct versions of SetPoint()
for two arguments and three, but I don't imagine that is safe for
us to do.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From kmenke at edac.unm.edu  Mon Jun 26 11:52:32 2006
From: kmenke at edac.unm.edu (Kurt Menke)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] r.in.gdal Relocation error
Message-ID: <009801c69938$89407900$4501100a@tybalt>

I have a new RHEL 3.0 box with GRASS-6.0.1, GDAL-1.3.1 and GDAL-Grass-1.3.1.
When I attempt to import a tiff into a GRASS location using r.in.gdal I
receive the following relocation error.  

 

Relocation error::/usr/local/gdal/lib/libgdal.so.1: undefined symbol: Tiff
GetConfiguredCODECs

 

Does anyone know what the likely causes are?

Thanks so much.

Kurt

 

 

*************************************

Kurt A. Menke, GISP

GIS Analyst/Programmer

Earth Data Analysis Center

MSC01 1110

1 University of New Mexico

Albuquerque, NM 87131-0001

Ph: 505-277-3622 x239

Fax: 505-277-3614

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060626/38ab3075/attachment.html
From neteler at itc.it  Mon Jun 26 12:11:38 2006
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Breaking long lines/boundaries with OGR function?
In-Reply-To: <449FF9FA.9040905@pobox.com>
References: <91d218430606241510j48bb8a4fy882b9af628e81165@mail.gmail.com>
	<20060626185237.067b53dd.hamish_nospam@yahoo.com>
	<20060626071134.GA15993@bartok.itc.it> <449FF9FA.9040905@pobox.com>
Message-ID: <20060626161138.GM15993@bartok.itc.it>

On Mon, Jun 26, 2006 at 11:15:06AM -0400, Frank Warmerdam wrote:
> Markus Neteler wrote:
> >Hi,
> >
> >the following issue came up in GRASS:
> >v.in.ogr, the OGR based import tool, may take a long time if
> >the data contains long complicated polylines.
> >
> >>From TODO
> >http://freegis.org/cgi-bin/viewcvs.cgi/grass6/doc/vector/TODO
> >>============================
> >>v.in.ogr
> >>--------
> >>It would be useful to split long boundaries to smaller
> >>pieces. Otherwise cleaning process can become very slow because
> >>bounding box of long boundaries can overlap large part of the map (for
> >>example outline around all areas) and cleaning process is checking
> >>intersection with all boundaries falling in the bounding box.
> >>============================
> >
> >Since I don't know OGR well enough, is there any function 
> >we could make use of to achieve splitting of long lines before
> >handing data over to (topological) GRASS?
> >
> >I found 
> >http://ogr.maptools.org/drv_dgn.html
> >"Polygons and line strings with too many vertices will be split into
> > a group of elmements prefixed with a Complex Shape Header or Complex
> > Chain Header element as appropriate."
> >
> >Something seems to be there (or nearby).
> 
> Markus,
> 
> It would not be particularly hard to have v.in.ogr break linestrings with
> a lot of vertices into distinct geometries though it isn't clear to me
> that this would really accelerate topology building.  There is no "canned"
> method in OGR for splitting features though.

Frank,

the relevant geometric portion was written by Radim who currently changes
the job. I am not familiar with internal details - just hoped to find
an OGR shortcut to accelerate the thing according to Radim's hints
on v.in.ogr.

thanks

 Markus

From warmerdam at pobox.com  Mon Jun 26 12:49:02 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] r.in.gdal Relocation error
In-Reply-To: <009801c69938$89407900$4501100a@tybalt>
References: <009801c69938$89407900$4501100a@tybalt>
Message-ID: <44A00FFE.3020007@pobox.com>

Kurt Menke wrote:
> I have a new RHEL 3.0 box with GRASS-6.0.1, GDAL-1.3.1 and 
> GDAL-Grass-1.3.1.  When I attempt to import a tiff into a GRASS location 
> using r.in.gdal I receive the following relocation error.  
> 
>  
> 
> Relocation error::/usr/local/gdal/lib/libgdal.so.1: undefined symbol: 
> Tiff GetConfiguredCODECs

Kurt,

This indicates that at runtime GDAL is picking up an older libtiff that
is missing this function.  Perhaps you have an older "system" libtiff, and
a newer one you built yourself on your system?  I wouldn't expect GDAL to
build unless a new version was around somewhere, but depending on shared
library search paths, at runtime it might be picking up an old one.

Presumably the solution would be to force use of the new libtiff in preference
to the older one, possibly by manipulating search paths (in LD_LIBRARY_PATH
env variable or /etc/ld.so.conf for instance) or just strip the old libtiff
off your system.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From collinsb at mitre.org  Mon Jun 26 13:36:26 2006
From: collinsb at mitre.org (Collins, Benjamin)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] MrSID / ENVI conflict
Message-ID: <8D27E2CDAF11D34F97E7445BCCCDB92CF6D0FC@IMCSRV1.MITRE.ORG>

To all,
I could not find this addressed elsewhere, so I'm asking the list:

When running gdalinfo (and other commands!) on a MrSID image that I
have, I am getting the report that "ENVI / ENVI .hdr Labelled" driver
is reading the image.  I did build gdal with MrSID support, and am
seeing the format show up in the '--formats' list.  It is getting the
image dimensions right, and is reading the projection information
correctly, but is obviously not the right driver (the block size and
color interpretation are both wrong).  When I use a modified gdalinfo
that has the call "GDALAllRegister()" replaced with
"GDALRegister_MrSID()" the image is correctly read.  Is this a problem
that others have run into?

If this is indeed not my problem, how should I solve this?  I do not
really need the ENVI driver, so I guess I could rebuild with this
support disabled.  But this does not seen so elegant.

It also brought to mind the idea that a user could want to request a
specific driver be used to load an image.  This does not seen possible
now.  Could/should the API be extended?

Thanks,
--
Ben Collins



From warmerdam at pobox.com  Mon Jun 26 13:52:40 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] jp2kak on OSX
In-Reply-To: <C4D5166C-C455-4134-B5D3-685FAA588401@cs.otago.ac.nz>
References: <200606230208.k5N27aH1028287@duke.maptools.org>
	<C4D5166C-C455-4134-B5D3-685FAA588401@cs.otago.ac.nz>
Message-ID: <44A01EE8.1090504@pobox.com>

Dave Robertson wrote:
> Frank,
> Thanks for the advice.
> 
> ./configure --without-python --without-ecw --without-libtool 
> --with-kakadu=< my absolute path to kakadu 5.1 >
> 
> Compiling gdal using the above configuration now returns a different set 
> of undefined symbols, but still appears to be using libtool somewhere in 
> the process.
> 
> 
> ld: Undefined symbols:
> __ZN11kdu_tiffdir12write_headerEP21kdu_compressed_targetx
> __ZN11kdu_tiffdir4initEb
> __ZN11kdu_tiffdir5closeEv
> __ZN11kdu_tiffdir7opendirEP21kdu_compressed_source
> __ZN11kdu_tiffdir8copy_tagERS_j
> __ZN11kdu_tiffdir8open_tagEj
> __ZN11kdu_tiffdir8read_tagEjiPd
> __ZN11kdu_tiffdir8read_tagEjiPj
> __ZN11kdu_tiffdir8read_tagEjiPt
> __ZN11kdu_tiffdir8writedirEP21kdu_compressed_targetx
> __ZN11kdu_tiffdir9write_tagEjiPd
> __ZN11kdu_tiffdir9write_tagEjiPt
> __ZN11kdu_tiffdir10create_tagEj
> __ZN11kdu_tiffdir13get_dirlengthEv
> __ZN11kdu_tiffdir9write_tagEjiPj
> __ZN12jpx_metanode12get_existingERP14jp2_family_src
> __ZN12jpx_metanode14get_descendantEi
> __ZN12jpx_metanode8get_uuidEPh
> __ZN16jpx_meta_manager11access_rootEv
> /usr/bin/libtool: internal link edit command failed
> make[1]: *** 
> [/Volumes/FW28G/FW55G/projects/Searcher/gdal-kdu/gdal-1.3.2/libgdal.dylib] 
> Error 1
> make: *** [check-lib] Error 2
> 
> Any suggestions?

Dave,

I think Ben's advice is likely good with regard to adding the extra files.
However, I see that the link error is still reporting use of libtool.  So
somehow I don't think the --without-libtool re-configuration quite stuck
properly.  You might want to make sure you do a "make clean" and then
re-configure.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From warmerdam at pobox.com  Mon Jun 26 13:58:46 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] MrSID / ENVI conflict
In-Reply-To: <8D27E2CDAF11D34F97E7445BCCCDB92CF6D0FC@IMCSRV1.MITRE.ORG>
References: <8D27E2CDAF11D34F97E7445BCCCDB92CF6D0FC@IMCSRV1.MITRE.ORG>
Message-ID: <44A02056.4010702@pobox.com>

Collins, Benjamin wrote:
> To all,
> I could not find this addressed elsewhere, so I'm asking the list:
> 
> When running gdalinfo (and other commands!) on a MrSID image that I
> have, I am getting the report that "ENVI / ENVI .hdr Labelled" driver
> is reading the image.  I did build gdal with MrSID support, and am
> seeing the format show up in the '--formats' list.  It is getting the
> image dimensions right, and is reading the projection information
> correctly, but is obviously not the right driver (the block size and
> color interpretation are both wrong).  When I use a modified gdalinfo
> that has the call "GDALAllRegister()" replaced with
> "GDALRegister_MrSID()" the image is correctly read.  Is this a problem
> that others have run into?

Ben,

I haven't run into this specific issue, though periodically I do run
into problems with the wrong driver recognising a dataset and trying
to open it.  In your case, perhaps there is a .hdr file in the same
directory with the same basename?

> If this is indeed not my problem, how should I solve this?  I do not
> really need the ENVI driver, so I guess I could rebuild with this
> support disabled.  But this does not seen so elegant.

There is also a quicky work around to add the driver name to the
GDAL_SKIP environment/configuration variable.

eg.
gdalinfo --config GDAL_SKIP ENVI abc.sid

> It also brought to mind the idea that a user could want to request a
> specific driver be used to load an image.  This does not seen possible
> now.  Could/should the API be extended?

I would agree that there ought to be a mechanism to open a file using
only a specific driver, but I'm not keen on adding yet another GDALOpen()
variation.  The clumsy approach at the API is to unregister all other
drivers at runtime from the GDALDriverManager.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From ari.jolma at tkk.fi  Mon Jun 26 16:27:19 2006
From: ari.jolma at tkk.fi (Ari Jolma)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Bugs in the bindings
In-Reply-To: <449FFF4C.5070406@pobox.com>
References: <1151262049.449edd611538d@webmail2.hut.fi>
	<449FFF4C.5070406@pobox.com>
Message-ID: <44A04327.9010308@tkk.fi>

Frank Warmerdam kirjoitti:
> I've created new GDAL/OGR components for:
>  * PerlBindings - defaults to Ari
>  * PythonBindings - defaults to me.
>  * JavaBindings - defaults to me.
>  * RubyBindings - defaults to Charlie.

thanks, how about general bindings..?

>
>> Second, two bugs in ogr.i:
>>
>> - CreateGeometryFromWk?: it is not nice to silently return null in 
>> case of an
>> error, I'm going to use croak(OGRErrMessages(err)) in Perl bindings
>
> It would seem in general that an error should be produced on failure.

My problem is that the croak (even swig_croak) is probably a Perl-only 
solution, but I'll look into it more and post it as a bug -- that's an 
example of a general bindings bug or "undesirable feature".

>
>> - SetPoint: test wkb25DBit and call ..SetPoint _or_ ..SetPoint_2D
>
> I'm not too sure what you mean.  In the NG bindings I see:
>
>   %feature("kwargs") SetPoint;
>   void SetPoint(int point, double x, double y, double z=0) {
>     OGR_G_SetPoint(self, point, x, y, z);
>   }
>
> In the old bindings we have:
>
>
>     def SetPoint( self, i, x, y, z = 0):
>         return _gdal.OGR_G_SetPoint( self._o, i, x, y, z )
>
>     def SetPoint_2D( self, i, x, y):
>         return _gdal.OGR_G_SetPoint_2D( self._o, i, x, y )
>
> What would you be doing the wkb25DBit check on in the new bindings?  I
> suspect we ought to offer two methods, a SetPoint() method which is
> implicitly 3D and SetPoint_2D() which is 2D.
>
> It would be nicer if we could have distinct versions of SetPoint()
> for two arguments and three, but I don't imagine that is safe for
> us to do.

I was/am a bit confused with this. At least two things should be done I 
think:

- from ogrpoint.cpp: setZ: "Setting a zero zIn value will make the point 
2D", but ogr_geometry.h: "setZ( double zIn ) { z = zIn; 
nCoordDimension=3; }", i.e., no test for the zIn == 0 case? I think the 
docs should be changed?

- In the bindings there is no method "setCoordinateDimension", but one 
is needed.

I believe I'll manage with the set/get CoordinateDimension methods, 
which I'll call as appropriate in the new Perl bindings mostly after 
SetPoint, depending on whether the input contains value for z or not.

BTW, my plans for the classes in Geo::GDAL namespace have escalated a 
bit (after reading Sean's and Charlie's posts on geos-devel). For 
example I intend to introduce Geo::GDAL::Point etc. classes and leave 
the Geometry class, whihc swig bindings provide, as a virtual class (not 
to instantiated by users).

Regards,

Ari

>
> Best regards,


-- 
Prof. Ari Jolma
Kartografia ja Geoinformatiikka / Cartography and Geoinformatics
Teknillinen Korkeakoulu / Helsinki University of Technology
POBox 1200, 02015 TKK, Finland
Email: ari.jolma at tkk.fi URL: http://www.tkk.fi/~jolma


From Bob.Moskovitz at conservation.ca.gov  Mon Jun 26 16:32:53 2006
From: Bob.Moskovitz at conservation.ca.gov (Moskovitz, Bob)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Problems with ogr2ogr?
Message-ID: <A73B6E7A4503E948826CE81A65AF5FEC0877BC@docexs1.ad.consrv.ca.gov>

Hello List,
 
I am a new user of GDAL./OGR and I have a problem converting (what is supposed to be) a NAD27 California State Plane Zone 5 Mapinfo file to a NAD27 UTM Zone 11.  For some reason ogr2ogr created a file that uses WGS84. The source file was created with MapInfo 6. This is what I did:
 
ogrinfo -al -so LAND_AP_7.tab
Had to open data source read-only.
INFO: Open of `LAND_AP_7.tab'
using driver `MapInfo File' successful.
 
Layer name: LAND_AP_7
Geometry: Polygon
Feature Count: 6
Extent: (2452634.218712, 276580.102129) - (2486216.118198, 322063.122454)
Layer SRS WKT:
PROJCS["unnamed",
    GEOGCS["unnamed",
        DATUM["North_American_Datum_1927",
            SPHEROID["Clarke 1866",6378206.4,294.9786982],
            TOWGS84[-8,160,176,0,0,0,0]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Lambert_Conformal_Conic_2SP"],
    PARAMETER["standard_parallel_1",34.0333333333],
    PARAMETER["standard_parallel_2",35.4666666667],
    PARAMETER["latitude_of_origin",33.5],
    PARAMETER["central_meridian",-118],
    PARAMETER["false_easting",609601.2],
    PARAMETER["false_northing",0],
    UNIT["U.S. Foot",0.3048006]]
AREA: Real (0.0)
PERIMETER: Real (0.0)
LAND_AP_7_: Integer (0.0)
LAND_AP_7_ID: Integer (0.0)
 
ogr2ogr -f "MapInfo File" -s_srs EPSG:26745 -t_srs EPSG:26711 test.tab LAND_AP_7.tab
ogrinfo -al -so test.tab
Had to open data source read-only.
INFO: Open of `test.tab'
using driver `MapInfo File' successful.
 
Layer name: test
Geometry: Polygon
Feature Count: 5
Extent: (545973.840000, 3789822.180000) - (556088.130000, 3803682.585000)
Layer SRS WKT:
PROJCS["unnamed",
    GEOGCS["unnamed",
        DATUM["North_American_Datum_1927",
            SPHEROID["Clarke 1866",6378206.4,294.9786982],
            TOWGS84[-8,160,176,0,0,0,0]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",-117],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",0],
    UNIT["Meter",1.0]]
AREA: Real (0.0)
PERIMETER: Real (0.0)
LAND_AP_7_: Integer (0.0)
LAND_AP_7_ID: Integer (0.0)
 
Thanks in advance!
 
Bob
 
Bob Moskovitz 
Seismic Hazards Zonation Program 
California Geological Survey 
http://gmw.consrv.ca.gov/shmp 

CONFIDENTIALITY NOTICE: This communication is intended only for the use of the individual or entity to which it is addressed. This message contains information from the State of California, California Geological Survey, which may be privileged, confidential and exempt from disclosure under applicable law, including the Electronic Communications Privacy Act. If the reader of this communication is not the intended recipient, you are hereby notified that any dissemination, distribution, or copying of this communication is strictly prohibited.

 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060626/0bf652d7/attachment.html
From cfis at interserv.com  Mon Jun 26 16:44:54 2006
From: cfis at interserv.com (Charlie Savage)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Re: Bugs in the bindings
In-Reply-To: <44A04327.9010308@tkk.fi>
References: <1151262049.449edd611538d@webmail2.hut.fi>	<449FFF4C.5070406@pobox.com>
	<44A04327.9010308@tkk.fi>
Message-ID: <44A04746.7000107@interserv.com>

> My problem is that the croak (even swig_croak) is probably a Perl-only 
> solution, but I'll look into it more and post it as a bug -- that's an 
> example of a general bindings bug or "undesirable feature".

Ari - could you use SWIG_exception (see 
http://www.swig.org/Doc1.3/SWIGDocumentation.html#Library_stl_exceptions). 
  That's generic across SWIG bindings.  There is also a slightly 
different version (whose name I can't remember, something like 
SWIG_Error) in the unified type library.  It handles raising the 
exception a little differently, so if SWIG_exception doesn't work then 
maybe the other one will.

> BTW, my plans for the classes in Geo::GDAL namespace have escalated a 
> bit (after reading Sean's and Charlie's posts on geos-devel). For 
> example I intend to introduce Geo::GDAL::Point etc. classes and leave 
> the Geometry class, whihc swig bindings provide, as a virtual class (not 
> to instantiated by users).

I've attached what I've done so far on Geos for you to take a look at. 
Basically, create the "fake" classes just like Gdal already does.  Then 
take a look at the return typemap in the enclosed file - seems to work fine.

While on the subject - 2 other things:

1.  Can we remove all the language specifiers in the typemaps, which are 
now deprecated by SWIG (you get lots of warning when running SWIG on the 
gdal bindings now).

2.  Feedback on the -fpic command line option I mentioned in  my last 
email.  Its needed on SELinux enabled systems.

Thanks,

Charlie
-------------- next part --------------
%module geos

%include "attribute.i"
%include "exception.i"
%include "std_string.i"
%include "std_vector.i"
%include "std_except.i"
%include "factory.i"

%{
typedef struct GeosCoordinateSequence_t *GeosCoordinateSequence;
typedef struct GeosGeometry_t *GeosGeometry;
typedef struct GeosPoint_t *GeosPoint;
typedef struct GeosLineString_t *GeosLineString;
typedef struct GeosLinearRing_t *GeosLinearRing;
typedef struct GeosPolygon_t *GeosPolygon;
typedef struct GeosGeometryCollection_t *GeosGeometryCollection;
typedef struct GeosMultiPoint_t *GeosMultiPoint;
typedef struct GeosMultiLineString_t *GeosMultiLineString;
typedef struct GeosMultiLinearRing_t *GeosMultiLinearRing;
typedef struct GeosMultiPolygon_t *GeosMultiPolygon;
%}

// Constants from geos_c.h  sinc
#define GEOS_VERSION_MAJOR 3
#define GEOS_VERSION_MINOR 0
#define GEOS_VERSION_PATCH 0rc1
#define GEOS_VERSION "3.0.0rc1"
#define GEOS_JTS_PORT "1.7.1"

#define GEOS_CAPI_VERSION_MAJOR 1
#define GEOS_CAPI_VERSION_MINOR 1
#define GEOS_CAPI_VERSION_PATCH 1
#define GEOS_CAPI_FIRST_INTERFACE GEOS_CAPI_VERSION_MAJOR 
#define GEOS_CAPI_LAST_INTERFACE (GEOS_CAPI_VERSION_MAJOR+GEOS_CAPI_VERSION_MINOR)
#define GEOS_CAPI_VERSION "3.0.0rc1-CAPI-1.1.1"


/* Supported geometry types */

    enum GEOSGeomTypes {
	GEOS_POINT,
	GEOS_LINESTRING,
	GEOS_LINEARRING,
	GEOS_POLYGON,
	GEOS_MULTIPOINT,
	GEOS_MULTILINESTRING,
	GEOS_MULTIPOLYGON,
	GEOS_GEOMETRYCOLLECTION
};
   

%{ 
#include "geos_c.h"
//#include <sstream>
%}

/* ==============  Language Specific Files ============ */

/* Import language specific SWIG files.  This allows each language
   to define its own renames as well as any special functionality
   such as language specific iterators for collections. Note 
   that %include allows the included files to generate interface
   wrapper code while %import does not.  Thus use %include since
   this is an important feature (for example, Ruby needs it to #undef
   the select macro) */


#ifdef SWIGPYTHON
//	%include ../python/python.i
#endif

#ifdef SWIGRUBY
//	%include ../ruby/ruby.i
#endif



// ===  CoordinateSequence ===

%rename (CoordinateSequence) GeosCoordinateSequence;
class GeosCoordinateSequence
{
public:
%extend
{
    GeosCoordinateSequence(size_t size, size_t dims)
    {
        return (GeosCoordinateSequence*) GEOSCoordSeq_create(size, dims);
    }

    GeosCoordinateSequence(const GeosCoordinateSequence& other)
    {
        GEOSCoordSeq coords = (GEOSCoordSeq) other;
        return (GeosCoordinateSequence*) GEOSCoordSeq_clone(coords);
    }

    ~GeosCoordinateSequence()
    {
        GEOSCoordSeq coords = (GEOSCoordSeq) self;
        return GEOSCoordSeq_destroy(coords);
    }

    int setX(size_t idx, double val)
    {
        GEOSCoordSeq coords = (GEOSCoordSeq) self;
        return GEOSCoordSeq_setX(coords, idx, val);
    }

    int setY(size_t idx, double val)
    {
        GEOSCoordSeq coords = (GEOSCoordSeq) self;
        return GEOSCoordSeq_setY(coords, idx, val);
    }

    int setZ(size_t idx, double val)
    {
        GEOSCoordSeq coords = (GEOSCoordSeq) self;
        return GEOSCoordSeq_setZ(coords, idx, val);
    }

    int setOrdinate(size_t idx, size_t dim, double val)
    {
        GEOSCoordSeq coords = (GEOSCoordSeq) self;
        return GEOSCoordSeq_setOrdinate(coords, idx, dim, val);
    }

    double getX(size_t idx)
    {
        double result;
        GEOSCoordSeq coords = (GEOSCoordSeq) self;
        GEOSCoordSeq_getX(coords, idx, &result);
        return result;
    }

    double getY(size_t idx)
    {
        double result;
        GEOSCoordSeq coords = (GEOSCoordSeq) self;
        GEOSCoordSeq_getY(coords, idx, &result);
        return result;
    }
    
    double getZ(size_t idx)
    {
        double result;
        GEOSCoordSeq coords = (GEOSCoordSeq) self;
        GEOSCoordSeq_getZ(coords, idx, &result);
        return result;
    }
    
    double getOrdinate(size_t idx, size_t dim)
    {
        double result;
        GEOSCoordSeq coords = (GEOSCoordSeq) self;
        GEOSCoordSeq_getOrdinate(coords, idx, dim, &result);
        return result;
    }

    int getSize()
    {
        size_t result;
        GEOSCoordSeq coords = (GEOSCoordSeq) self;
        GEOSCoordSeq_getSize(coords, &result);
        return result;
    }

    int getDimensions()
    {
        size_t result;
        GEOSCoordSeq coords = (GEOSCoordSeq) self;
        GEOSCoordSeq_getDimensions(coords, &result);
        return result;
    }
}
};


// ===  Geometry ===
%typemap(out) GeosGeometry 
{
    /* TestMe*/
    GeosGeometry geom = result;
    GEOSGeomTypes geomId = (GEOSGeomTypes)GEOSGeomTypeId((GEOSGeom) geom);

    switch (geomId)
    {
    case GEOS_POINT:
        $result = SWIG_NewPointerObj(SWIG_as_voidptr(result), $descriptor(GeosPoint), 0 | $owner);
        break;
	case GEOS_LINESTRING:
        $result = SWIG_NewPointerObj(SWIG_as_voidptr(result), $descriptor(GeosLineString), 0 | $owner);
        break;
	case GEOS_LINEARRING:
        $result = SWIG_NewPointerObj(SWIG_as_voidptr(result), $descriptor(GeosLinearRing), 0 | $owner);
        break;
/*	case GEOS_POLYGON:
        break;
	case GEOS_MULTIPOINT:
        break;
	case GEOS_MULTILINESTRING:
        break;
	case GEOS_MULTIPOLYGON:
        break;
	case GEOS_GEOMETRYCOLLECTION:
        break;*/
    }
}


/*    extern GEOSGeom GEOS_DLL GEOSPolygonize(const GEOSGeom geoms[],
	size_t ngeoms);


    GeosGeometry *Polygonize(size_t ngeoms)
    {
        const GEOSGeom g1 = (GEOSGeom) self;
        return (GeosGeometry*) GEOSPolygonize(g1, ngeoms);
    }
*/


%rename(Geometry) GeosGeometry;
class GeosGeometry
{
private:
    GeosGeometry();
public:
%extend
{
    ~GeosGeometry()
    {
        GEOSGeom geom = (GEOSGeom) self;
        GEOSGeom_destroy(geom);
    }

    char *geomType()
    {
        GEOSGeom geom = (GEOSGeom) self;
        return GEOSGeomType(geom);
    }

    int typeId()
    {
        GEOSGeom geom = (GEOSGeom) self;
        return GEOSGeomTypeId(geom);
    }
    
    int getSRID()
    {
        GEOSGeom geom = (GEOSGeom) self;
        return GEOSGetSRID(geom);
    }

    void setSRID(int SRID)
    {
        GEOSGeom geom = (GEOSGeom) self;
        return GEOSSetSRID(geom, SRID);
    }

    size_t getDimensions()
    {
        GEOSGeom geom = (GEOSGeom) self;
        return GEOSGeom_getDimensions(geom);
    }

    GeosGeometry *GEOSEnvelope()
    {
        const GEOSGeom g1 = (GEOSGeom) self;
        return (GeosGeometry*) GEOSEnvelope(g1);
    }

    GeosGeometry *ConvexHull()
    {
        const GEOSGeom g1 = (GEOSGeom) self;
        return (GeosGeometry*) GEOSConvexHull(g1);
    }

    GeosGeometry *Boundary()
    {
        const GEOSGeom g1 = (GEOSGeom) self;
        return (GeosGeometry*) GEOSBoundary(g1);
    }

    GeosGeometry *PointOnSurface()
    {
        const GEOSGeom g1 = (GEOSGeom) self;
        return (GeosGeometry*) GEOSPointOnSurface(g1);
    }

    GeosGeometry *LineMerge()
    {
        const GEOSGeom g1 = (GEOSGeom) self;
        return (GeosGeometry*) GEOSLineMerge(g1);
    }

    GeosGeometry *GetCentroid()
    {
        const GEOSGeom g1 = (GEOSGeom) self;
        return (GeosGeometry*) GEOSGetCentroid(g1);
    }

    GeosGeometry *Intersection(GeosGeometry *other)
    {
        const GEOSGeom g1 = (GEOSGeom) self;
        const GEOSGeom g2 = (GEOSGeom) other;
        return (GeosGeometry*) GEOSIntersection(g1, g2);
    }

    GeosGeometry *Difference(GeosGeometry *other)
    {
        const GEOSGeom g1 = (GEOSGeom) self;
        const GEOSGeom g2 = (GEOSGeom) other;
        return (GeosGeometry*) GEOSDifference(g1, g2);
    }

    GeosGeometry *SymDifference(GeosGeometry *other)
    {
        const GEOSGeom g1 = (GEOSGeom) self;
        const GEOSGeom g2 = (GEOSGeom) other;
        return (GeosGeometry*) GEOSSymDifference(g1, g2);
    }

    GeosGeometry *Union(GeosGeometry *other)
    {
        const GEOSGeom g1 = (GEOSGeom) self;
        const GEOSGeom g2 = (GEOSGeom) other;
        return (GeosGeometry*) GEOSUnion(g1, g2);
    }
    
    GeosGeometry *Relate(GeosGeometry *other)
    {
        const GEOSGeom g1 = (GEOSGeom) self;
        const GEOSGeom g2 = (GEOSGeom) other;
        return (GeosGeometry*) GEOSRelate(g1, g2);
    }

    GeosGeometry *Buffer(double width, int quadsegs)
    {
        const GEOSGeom g1 = (GEOSGeom) self;
        return (GeosGeometry*) GEOSBuffer(g1, width, quadsegs);
    }

    GeosGeometry *Simplify(double tolerance)
    {
        const GEOSGeom g1 = (GEOSGeom) self;
        return (GeosGeometry*) GEOSSimplify(g1, tolerance);
    }

    GeosGeometry *TopologyPreserveSimplify(double tolerance)
    {
        const GEOSGeom g1 = (GEOSGeom) self;
        return (GeosGeometry*) GEOSTopologyPreserveSimplify(g1, tolerance);
    }
}
};

%rename(Point) GeosPoint;
class GeosPoint: public GeosGeometry
{
private:
    GeosPoint();
    GeosPoint(const GeosPoint&);
public:
%extend
{
    ~GeosPoint()
    {
        GEOSGeom geom = (GEOSGeom) self;
        GEOSGeom_destroy(geom);
    }
}
};

%rename(LineString) GeosLineString;
class GeosLineString: public GeosGeometry
{
private:
    GeosLineString();
public:
%extend
{
    ~GeosLineString()
    {
        GEOSGeom geom = (GEOSGeom) self;
        GEOSGeom_destroy(geom);
    }
}
};

%rename(LinearRing) GeosLinearRing;
class GeosLinearRing: public GeosGeometry
{
private:
    GeosLinearRing();
public:
%extend
{
    ~GeosLinearRing()
    {
        GEOSGeom geom = (GEOSGeom) self;
        GEOSGeom_destroy(geom);
    }
}
};

%rename(Polygon) GeosPolygon;
class GeosPolygon: public GeosGeometry
{
private:
    GeosPolygon();
public:
%extend
{
    ~GeosPolygon()
    {
        GEOSGeom geom = (GEOSGeom) self;
        GEOSGeom_destroy(geom);
    }
}
};

%rename(GeometryCollection) GeosGeometryCollection;
class GeosGeometryCollection: public GeosGeometry
{
private:
    GeosGeometryCollection();
public:
%extend
{
    ~GeosGeometryCollection()
    {
        GEOSGeom geom = (GEOSGeom) self;
        GEOSGeom_destroy(geom);
    }
}
};

%rename(MultiPoint) GeosMultiPoint;
class GeosMultiPoint: public GeosGeometryCollection
{
private:
    GeosMultiPoint();
public:
%extend
{
    ~GeosMultiPoint()
    {
        GEOSGeom geom = (GEOSGeom) self;
        GEOSGeom_destroy(geom);
    }
}
};

%rename(MultiLineString) GeosMultiLineString;
class GeosMultiLineString: public GeosGeometryCollection
{
private:
    GeosMultiLineString();
public:
%extend
{
    ~GeosMultiLineString()
    {
        GEOSGeom geom = (GEOSGeom) self;
        GEOSGeom_destroy(geom);
    }
}
};

%rename(MultiLinearRing) GeosMultiLinearRing;
class GeosMultiLinearRing: public GeosGeometryCollection
{
private:
    GeosMultiLinearRing();
public:
%extend
{
    ~GeosMultiLinearRing()
    {
        GEOSGeom geom = (GEOSGeom) self;
        GEOSGeom_destroy(geom);
    }
}
};

%rename(MultiPolygon) GeosMultiPolygon;
class GeosMultiPolygon: public GeosGeometryCollection
{
private:
    GeosMultiPolygon();
public:
%extend
{
    ~GeosMultiPolygon()
    {
        GEOSGeom geom = (GEOSGeom) self;
        GEOSGeom_destroy(geom);
    }
}
};

// ==== Geometry Constructors ===========

%newobject createPoint;
%newobject createLineString;
%newobject createLinearRing;
%newobject createPolygon;

%apply SWIGTYPE *DISOWN {GeosCoordinateSequence *s};

%inline %{
GeosPoint *createPoint(GeosCoordinateSequence *s)
{
    GEOSCoordSeq coords = (GEOSCoordSeq) s;
    return (GeosPoint*) GEOSGeom_createPoint(coords);
}

GeosLinearRing *createLinearRing(GeosCoordinateSequence *s)
{
    GEOSCoordSeq coords = (GEOSCoordSeq) s;
    return (GeosLinearRing*) GEOSGeom_createLinearRing(coords);
}

GeosLineString *createLineString(GeosCoordinateSequence *s)
{
    GEOSCoordSeq coords = (GEOSCoordSeq) s;
    return (GeosLineString*) GEOSGeom_createLineString(coords);
}

GeosPolygon *createPolygon(GEOSGeom shell, GEOSGeom *holes, size_t nholes)
{
    return (GeosPolygon*) GEOSGeom_createPolygon(shell, holes, nholes);
}

%}

%clear GeosCoordinateSequence *s;

/*
%newobject createCollection;
GEOSGeom createCollection(int type, GEOSGeom *geoms, size_t ngeoms)
{
    return GEOSGeom_createCollection(type, geoms, ngeoms);
}
*/



// === Input/Output ===
%newobject geomFromWKT;
%newobject geomFromWKB;

%inline %{
GeosGeometry geomFromWKT(const char *wkt)
{
    return (GeosGeometry) GEOSGeomFromWKT(wkt);
}

char *geomToWKT(const GeosGeometry* g)
{
    const GEOSGeom geom = (const GEOSGeom) g;
    return GEOSGeomToWKT(geom);
}

int setWKBOutputDims(int newDims)
{
    return GEOS_setWKBOutputDims(newDims);
}

GeosGeometry geomFromWKB(const unsigned char *wkb, size_t size)
{
    return (GeosGeometry) GEOSGeomFromWKB_buf(wkb, size);
}

unsigned char *geomToWKB(const GEOSGeom* g, size_t *size)
{
    const GEOSGeom geom = (const GEOSGeom) g;
    return GEOSGeomToWKB_buf(geom, size);
}
%}
From dave at cs.otago.ac.nz  Mon Jun 26 18:25:38 2006
From: dave at cs.otago.ac.nz (Dave Robertson)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] jp2kak on OSX
Message-ID: <2D78141B-E0B3-4CE4-AFC0-2BC51A242DF7@cs.otago.ac.nz>

Ben,

Thanks for that information. The build completes successfully now.
Perhaps a note to this effect could be included in the jp2kak  
documentation?

Cheers
Dave Robertson.



> In Kakadu 5.1 there are two (new?) shared objcet files that are not
> explicitly mentioned in the GNUMakefile in frmts/jp2kak.  These files
> are:
> <kdu_dir>/apps/make/jpx.o
> <kdu_dir>/apps/make/kdu_tiff.o
>
> If those file are added to the GNUMakefile you will proabaly be  
> able to
> build correctly.  I did not check the change into CVS because I'm
> concerned that doing so would break gdal builds for old versions of
> kakadu.


From warmerdam at pobox.com  Mon Jun 26 19:05:20 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Ruby Bindings Update
In-Reply-To: <449C4FF8.7090308@savagexi.com>
References: <449C4FF8.7090308@savagexi.com>
Message-ID: <44A06830.3060901@pobox.com>

Charlie Savage wrote:
> Issue #1 - However, you can't use them due to selinux errors:
> 
>     Cannot restore segment prot after reloc
> 
> This has to do with text relocations.  The solution turns out to be
> fairly simple, add -fpic or -fPIC when building shared libraries (like
> the Ruby bindings).
> 
> Should I
> 
> a) add this parameter to CFLAGS in the RubyMakefile.mk
> 
> - or -
> 
> b) should this be added as a global build flag?  I'd imagine all the
> other SWIG extensions, and the gdal shared library itself, should run
> into the same issue.

Charlie,

When building without libtool the GDAL configure will try to add
-fPIC to CFLAGS if it works on the system.  Many systems, not just
SELinux, require this for proper operation.   However, with libtool
builds I think it is omitted and is provided internally by libtool.

I am afraid I am uncertain how the builds of some of the SWIG extensions
works.  If it uses the same build environment as GDAL then it should
inherit the correct settings either from CFLAGS or from libtool.  However,
if the logic is custom then something appropriate will need to be done.

I know that the python bindings use setup.py to build the extension and
this is completely distinct from the normal GDAL build system making it
hard to ensure that things are done properly.

> Issue #2
> 
> Ruby 1.8.4 moved its extension library from
> /usr/lib/site-ruby/i386-linux to /usr/lib/ruby/site-ruby/i386-linux
> 
> No big deal, since I ask Ruby where the directory is on installation.
> However, it turns out that on a fresh ruby install the i386-linux
> directory doesn't exist.  So the makefile now has a check for this.

ok, cool.

> Windows - VC 2005 NET
> --------------------------
> Another library issue.  With VC.NET 2005 all dlls must include an
> embedded manifest at resource id #2.  Yeah, I know, why????  Anyway,
> more information then you'd ever want to know about this is here:
> 
> http://www.grimes.demon.co.uk/workshops/fusWSThirteen.htm
> 
> Here's the issue.  If you build with Visual Studio, the manifest gets
> embedded correctly.  If you use nmake, then it doesn't and you have to
> add it manually use mt.exe (see link above).  Once again, this is
> another global issue that would affect any SWIG built extension.  It
> ought to also affect gdal.dll, but that seems to work for me, don't know
>  why.

I have built with newer visual studios that produce manifest files, which
I understood needed to be stored in the same directory as the DLLs.  There
is some magic in the makefiles to handle this.  I haven't heard of mt.exe
before.   I think I'll need to setup a proper VS 2005 environment.

> Os X
> -------
> Ken-ichi has reported that the bindings don't build on the Mac.
> Unfortunately, I can't test that since I don't have one.  Not sure what
> to do about that.

I'd test it on my system but it is pretty ancient and it might not
be worth the trouble.

> SWIG Version
> ------------
> 
> Last - I vaguely remember that the SWIG generated wrappers for Ruby were
>  after swig 1.3.28 but before 1.3.29.  I see Ari has updated Perl to
> 1.3.29, the latest SWIG release, so I'll make sure the Ruby bindings are
> at the same level.

Cool, thanks.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From schut at sarvision.nl  Tue Jun 27 03:12:24 2006
From: schut at sarvision.nl (Vincent Schut)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] ng python bindings
Message-ID: <44A0DA58.9070100@sarvision.nl>

Hi all,

I wondered (after some resultless google searching): is there some howto
lingering somewhere on how to build, install and use the ng python bindings?

Next to that, I remember having seen some messages come by on the numpy
mailing list about having the gdal python ng bindings use numpy instead
of numeric as it's supported array library. Because I'm using numpy
mostly today, I wondered if this will really be the case, and if there
is already any progress on having gdal bindings that natively support
numpy instead of Numeric.

Vincent.


From orianpax at hotmail.com  Tue Jun 27 04:32:17 2006
From: orianpax at hotmail.com (guan hw)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] some questions about gdal for WinCE 
Message-ID: <BAY101-F32D945B5EE66BEBB2FF084DD7E0@phx.gbl>

An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060627/d48ed8f3/attachment.html
From ari.jolma at tkk.fi  Tue Jun 27 09:20:21 2006
From: ari.jolma at tkk.fi (Ari Jolma)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Re: Bugs in the bindings
In-Reply-To: <44A04746.7000107@interserv.com>
References: <1151262049.449edd611538d@webmail2.hut.fi>
	<449FFF4C.5070406@pobox.com> <44A04327.9010308@tkk.fi>
	<44A04746.7000107@interserv.com>
Message-ID: <44A13095.1000602@tkk.fi>

Charlie Savage wrote:
>> My problem is that the croak (even swig_croak) is probably a 
>> Perl-only solution, but I'll look into it more and post it as a bug 
>> -- that's an example of a general bindings bug or "undesirable feature".
>
> Ari - could you use SWIG_exception (see 
> http://www.swig.org/Doc1.3/SWIGDocumentation.html#Library_stl_exceptions). 
>  That's generic across SWIG bindings.  There is also a slightly 
> different version (whose name I can't remember, something like 
> SWIG_Error) in the unified type library.  It handles raising the 
> exception a little differently, so if SWIG_exception doesn't work then 
> maybe the other one will.

I fixed it with "CPLError(CE_Failure, err, "%s", OGRErrMessages(err));" 
which leads to an exception in %exceptions block in cpl_exceptions.i

_But_ I noticed that at least in Perl one needs "SWIG_exception_fail" 
instead of "SWIG_exception" in cpl_exceptions.i; I fixed this now with a 
#ifdef SWIGPERL for Perl but I don't know if this is a Swig bug or what. 
Could you confirm that Ruby works with SWIG_exception?

I removed the last two throws from the *.i files in include and updated 
the Perl wrappers.

>
>> BTW, my plans for the classes in Geo::GDAL namespace have escalated a 
>> bit (after reading Sean's and Charlie's posts on geos-devel). For 
>> example I intend to introduce Geo::GDAL::Point etc. classes and leave 
>> the Geometry class, whihc swig bindings provide, as a virtual class 
>> (not to instantiated by users).
>
> I've attached what I've done so far on Geos for you to take a look at. 
> Basically, create the "fake" classes just like Gdal already does.  
> Then take a look at the return typemap in the enclosed file - seems to 
> work fine.

I'm building the new class system completely without Swig, but on the 
top of the Swig-made modules...

>
> While on the subject - 2 other things:
>
> 1.  Can we remove all the language specifiers in the typemaps, which 
> are now deprecated by SWIG (you get lots of warning when running SWIG 
> on the gdal bindings now).

I don't get any warnings. Maybe I already did remove them for Perl. (I 
build only Perl interface)

>
> 2.  Feedback on the -fpic command line option I mentioned in  my last 
> email.  Its needed on SELinux enabled systems.

Hmm, you wrote "-fpic or -fPIC", Perl adds -fPIC, I added -fpic to 
CCFLAGS and that did not cause a failure in my test.pl so I left it there.

Ari

>
> Thanks,
>
> Charlie
> ------------------------------------------------------------------------
>
> %module geos
>
> %include "attribute.i"
> %include "exception.i"
> %include "std_string.i"
> %include "std_vector.i"
> %include "std_except.i"
> %include "factory.i"
>
> %{
> typedef struct GeosCoordinateSequence_t *GeosCoordinateSequence;
> typedef struct GeosGeometry_t *GeosGeometry;
> typedef struct GeosPoint_t *GeosPoint;
> typedef struct GeosLineString_t *GeosLineString;
> typedef struct GeosLinearRing_t *GeosLinearRing;
> typedef struct GeosPolygon_t *GeosPolygon;
> typedef struct GeosGeometryCollection_t *GeosGeometryCollection;
> typedef struct GeosMultiPoint_t *GeosMultiPoint;
> typedef struct GeosMultiLineString_t *GeosMultiLineString;
> typedef struct GeosMultiLinearRing_t *GeosMultiLinearRing;
> typedef struct GeosMultiPolygon_t *GeosMultiPolygon;
> %}
>
> // Constants from geos_c.h  sinc
> #define GEOS_VERSION_MAJOR 3
> #define GEOS_VERSION_MINOR 0
> #define GEOS_VERSION_PATCH 0rc1
> #define GEOS_VERSION "3.0.0rc1"
> #define GEOS_JTS_PORT "1.7.1"
>
> #define GEOS_CAPI_VERSION_MAJOR 1
> #define GEOS_CAPI_VERSION_MINOR 1
> #define GEOS_CAPI_VERSION_PATCH 1
> #define GEOS_CAPI_FIRST_INTERFACE GEOS_CAPI_VERSION_MAJOR 
> #define GEOS_CAPI_LAST_INTERFACE (GEOS_CAPI_VERSION_MAJOR+GEOS_CAPI_VERSION_MINOR)
> #define GEOS_CAPI_VERSION "3.0.0rc1-CAPI-1.1.1"
>
>
> /* Supported geometry types */
>
>     enum GEOSGeomTypes {
> 	GEOS_POINT,
> 	GEOS_LINESTRING,
> 	GEOS_LINEARRING,
> 	GEOS_POLYGON,
> 	GEOS_MULTIPOINT,
> 	GEOS_MULTILINESTRING,
> 	GEOS_MULTIPOLYGON,
> 	GEOS_GEOMETRYCOLLECTION
> };
>    
>
> %{ 
> #include "geos_c.h"
> //#include <sstream>
> %}
>
> /* ==============  Language Specific Files ============ */
>
> /* Import language specific SWIG files.  This allows each language
>    to define its own renames as well as any special functionality
>    such as language specific iterators for collections. Note 
>    that %include allows the included files to generate interface
>    wrapper code while %import does not.  Thus use %include since
>    this is an important feature (for example, Ruby needs it to #undef
>    the select macro) */
>
>
> #ifdef SWIGPYTHON
> //	%include ../python/python.i
> #endif
>
> #ifdef SWIGRUBY
> //	%include ../ruby/ruby.i
> #endif
>
>
>
> // ===  CoordinateSequence ===
>
> %rename (CoordinateSequence) GeosCoordinateSequence;
> class GeosCoordinateSequence
> {
> public:
> %extend
> {
>     GeosCoordinateSequence(size_t size, size_t dims)
>     {
>         return (GeosCoordinateSequence*) GEOSCoordSeq_create(size, dims);
>     }
>
>     GeosCoordinateSequence(const GeosCoordinateSequence& other)
>     {
>         GEOSCoordSeq coords = (GEOSCoordSeq) other;
>         return (GeosCoordinateSequence*) GEOSCoordSeq_clone(coords);
>     }
>
>     ~GeosCoordinateSequence()
>     {
>         GEOSCoordSeq coords = (GEOSCoordSeq) self;
>         return GEOSCoordSeq_destroy(coords);
>     }
>
>     int setX(size_t idx, double val)
>     {
>         GEOSCoordSeq coords = (GEOSCoordSeq) self;
>         return GEOSCoordSeq_setX(coords, idx, val);
>     }
>
>     int setY(size_t idx, double val)
>     {
>         GEOSCoordSeq coords = (GEOSCoordSeq) self;
>         return GEOSCoordSeq_setY(coords, idx, val);
>     }
>
>     int setZ(size_t idx, double val)
>     {
>         GEOSCoordSeq coords = (GEOSCoordSeq) self;
>         return GEOSCoordSeq_setZ(coords, idx, val);
>     }
>
>     int setOrdinate(size_t idx, size_t dim, double val)
>     {
>         GEOSCoordSeq coords = (GEOSCoordSeq) self;
>         return GEOSCoordSeq_setOrdinate(coords, idx, dim, val);
>     }
>
>     double getX(size_t idx)
>     {
>         double result;
>         GEOSCoordSeq coords = (GEOSCoordSeq) self;
>         GEOSCoordSeq_getX(coords, idx, &result);
>         return result;
>     }
>
>     double getY(size_t idx)
>     {
>         double result;
>         GEOSCoordSeq coords = (GEOSCoordSeq) self;
>         GEOSCoordSeq_getY(coords, idx, &result);
>         return result;
>     }
>     
>     double getZ(size_t idx)
>     {
>         double result;
>         GEOSCoordSeq coords = (GEOSCoordSeq) self;
>         GEOSCoordSeq_getZ(coords, idx, &result);
>         return result;
>     }
>     
>     double getOrdinate(size_t idx, size_t dim)
>     {
>         double result;
>         GEOSCoordSeq coords = (GEOSCoordSeq) self;
>         GEOSCoordSeq_getOrdinate(coords, idx, dim, &result);
>         return result;
>     }
>
>     int getSize()
>     {
>         size_t result;
>         GEOSCoordSeq coords = (GEOSCoordSeq) self;
>         GEOSCoordSeq_getSize(coords, &result);
>         return result;
>     }
>
>     int getDimensions()
>     {
>         size_t result;
>         GEOSCoordSeq coords = (GEOSCoordSeq) self;
>         GEOSCoordSeq_getDimensions(coords, &result);
>         return result;
>     }
> }
> };
>
>
> // ===  Geometry ===
> %typemap(out) GeosGeometry 
> {
>     /* TestMe*/
>     GeosGeometry geom = result;
>     GEOSGeomTypes geomId = (GEOSGeomTypes)GEOSGeomTypeId((GEOSGeom) geom);
>
>     switch (geomId)
>     {
>     case GEOS_POINT:
>         $result = SWIG_NewPointerObj(SWIG_as_voidptr(result), $descriptor(GeosPoint), 0 | $owner);
>         break;
> 	case GEOS_LINESTRING:
>         $result = SWIG_NewPointerObj(SWIG_as_voidptr(result), $descriptor(GeosLineString), 0 | $owner);
>         break;
> 	case GEOS_LINEARRING:
>         $result = SWIG_NewPointerObj(SWIG_as_voidptr(result), $descriptor(GeosLinearRing), 0 | $owner);
>         break;
> /*	case GEOS_POLYGON:
>         break;
> 	case GEOS_MULTIPOINT:
>         break;
> 	case GEOS_MULTILINESTRING:
>         break;
> 	case GEOS_MULTIPOLYGON:
>         break;
> 	case GEOS_GEOMETRYCOLLECTION:
>         break;*/
>     }
> }
>
>
> /*    extern GEOSGeom GEOS_DLL GEOSPolygonize(const GEOSGeom geoms[],
> 	size_t ngeoms);
>
>
>     GeosGeometry *Polygonize(size_t ngeoms)
>     {
>         const GEOSGeom g1 = (GEOSGeom) self;
>         return (GeosGeometry*) GEOSPolygonize(g1, ngeoms);
>     }
> */
>
>
> %rename(Geometry) GeosGeometry;
> class GeosGeometry
> {
> private:
>     GeosGeometry();
> public:
> %extend
> {
>     ~GeosGeometry()
>     {
>         GEOSGeom geom = (GEOSGeom) self;
>         GEOSGeom_destroy(geom);
>     }
>
>     char *geomType()
>     {
>         GEOSGeom geom = (GEOSGeom) self;
>         return GEOSGeomType(geom);
>     }
>
>     int typeId()
>     {
>         GEOSGeom geom = (GEOSGeom) self;
>         return GEOSGeomTypeId(geom);
>     }
>     
>     int getSRID()
>     {
>         GEOSGeom geom = (GEOSGeom) self;
>         return GEOSGetSRID(geom);
>     }
>
>     void setSRID(int SRID)
>     {
>         GEOSGeom geom = (GEOSGeom) self;
>         return GEOSSetSRID(geom, SRID);
>     }
>
>     size_t getDimensions()
>     {
>         GEOSGeom geom = (GEOSGeom) self;
>         return GEOSGeom_getDimensions(geom);
>     }
>
>     GeosGeometry *GEOSEnvelope()
>     {
>         const GEOSGeom g1 = (GEOSGeom) self;
>         return (GeosGeometry*) GEOSEnvelope(g1);
>     }
>
>     GeosGeometry *ConvexHull()
>     {
>         const GEOSGeom g1 = (GEOSGeom) self;
>         return (GeosGeometry*) GEOSConvexHull(g1);
>     }
>
>     GeosGeometry *Boundary()
>     {
>         const GEOSGeom g1 = (GEOSGeom) self;
>         return (GeosGeometry*) GEOSBoundary(g1);
>     }
>
>     GeosGeometry *PointOnSurface()
>     {
>         const GEOSGeom g1 = (GEOSGeom) self;
>         return (GeosGeometry*) GEOSPointOnSurface(g1);
>     }
>
>     GeosGeometry *LineMerge()
>     {
>         const GEOSGeom g1 = (GEOSGeom) self;
>         return (GeosGeometry*) GEOSLineMerge(g1);
>     }
>
>     GeosGeometry *GetCentroid()
>     {
>         const GEOSGeom g1 = (GEOSGeom) self;
>         return (GeosGeometry*) GEOSGetCentroid(g1);
>     }
>
>     GeosGeometry *Intersection(GeosGeometry *other)
>     {
>         const GEOSGeom g1 = (GEOSGeom) self;
>         const GEOSGeom g2 = (GEOSGeom) other;
>         return (GeosGeometry*) GEOSIntersection(g1, g2);
>     }
>
>     GeosGeometry *Difference(GeosGeometry *other)
>     {
>         const GEOSGeom g1 = (GEOSGeom) self;
>         const GEOSGeom g2 = (GEOSGeom) other;
>         return (GeosGeometry*) GEOSDifference(g1, g2);
>     }
>
>     GeosGeometry *SymDifference(GeosGeometry *other)
>     {
>         const GEOSGeom g1 = (GEOSGeom) self;
>         const GEOSGeom g2 = (GEOSGeom) other;
>         return (GeosGeometry*) GEOSSymDifference(g1, g2);
>     }
>
>     GeosGeometry *Union(GeosGeometry *other)
>     {
>         const GEOSGeom g1 = (GEOSGeom) self;
>         const GEOSGeom g2 = (GEOSGeom) other;
>         return (GeosGeometry*) GEOSUnion(g1, g2);
>     }
>     
>     GeosGeometry *Relate(GeosGeometry *other)
>     {
>         const GEOSGeom g1 = (GEOSGeom) self;
>         const GEOSGeom g2 = (GEOSGeom) other;
>         return (GeosGeometry*) GEOSRelate(g1, g2);
>     }
>
>     GeosGeometry *Buffer(double width, int quadsegs)
>     {
>         const GEOSGeom g1 = (GEOSGeom) self;
>         return (GeosGeometry*) GEOSBuffer(g1, width, quadsegs);
>     }
>
>     GeosGeometry *Simplify(double tolerance)
>     {
>         const GEOSGeom g1 = (GEOSGeom) self;
>         return (GeosGeometry*) GEOSSimplify(g1, tolerance);
>     }
>
>     GeosGeometry *TopologyPreserveSimplify(double tolerance)
>     {
>         const GEOSGeom g1 = (GEOSGeom) self;
>         return (GeosGeometry*) GEOSTopologyPreserveSimplify(g1, tolerance);
>     }
> }
> };
>
> %rename(Point) GeosPoint;
> class GeosPoint: public GeosGeometry
> {
> private:
>     GeosPoint();
>     GeosPoint(const GeosPoint&);
> public:
> %extend
> {
>     ~GeosPoint()
>     {
>         GEOSGeom geom = (GEOSGeom) self;
>         GEOSGeom_destroy(geom);
>     }
> }
> };
>
> %rename(LineString) GeosLineString;
> class GeosLineString: public GeosGeometry
> {
> private:
>     GeosLineString();
> public:
> %extend
> {
>     ~GeosLineString()
>     {
>         GEOSGeom geom = (GEOSGeom) self;
>         GEOSGeom_destroy(geom);
>     }
> }
> };
>
> %rename(LinearRing) GeosLinearRing;
> class GeosLinearRing: public GeosGeometry
> {
> private:
>     GeosLinearRing();
> public:
> %extend
> {
>     ~GeosLinearRing()
>     {
>         GEOSGeom geom = (GEOSGeom) self;
>         GEOSGeom_destroy(geom);
>     }
> }
> };
>
> %rename(Polygon) GeosPolygon;
> class GeosPolygon: public GeosGeometry
> {
> private:
>     GeosPolygon();
> public:
> %extend
> {
>     ~GeosPolygon()
>     {
>         GEOSGeom geom = (GEOSGeom) self;
>         GEOSGeom_destroy(geom);
>     }
> }
> };
>
> %rename(GeometryCollection) GeosGeometryCollection;
> class GeosGeometryCollection: public GeosGeometry
> {
> private:
>     GeosGeometryCollection();
> public:
> %extend
> {
>     ~GeosGeometryCollection()
>     {
>         GEOSGeom geom = (GEOSGeom) self;
>         GEOSGeom_destroy(geom);
>     }
> }
> };
>
> %rename(MultiPoint) GeosMultiPoint;
> class GeosMultiPoint: public GeosGeometryCollection
> {
> private:
>     GeosMultiPoint();
> public:
> %extend
> {
>     ~GeosMultiPoint()
>     {
>         GEOSGeom geom = (GEOSGeom) self;
>         GEOSGeom_destroy(geom);
>     }
> }
> };
>
> %rename(MultiLineString) GeosMultiLineString;
> class GeosMultiLineString: public GeosGeometryCollection
> {
> private:
>     GeosMultiLineString();
> public:
> %extend
> {
>     ~GeosMultiLineString()
>     {
>         GEOSGeom geom = (GEOSGeom) self;
>         GEOSGeom_destroy(geom);
>     }
> }
> };
>
> %rename(MultiLinearRing) GeosMultiLinearRing;
> class GeosMultiLinearRing: public GeosGeometryCollection
> {
> private:
>     GeosMultiLinearRing();
> public:
> %extend
> {
>     ~GeosMultiLinearRing()
>     {
>         GEOSGeom geom = (GEOSGeom) self;
>         GEOSGeom_destroy(geom);
>     }
> }
> };
>
> %rename(MultiPolygon) GeosMultiPolygon;
> class GeosMultiPolygon: public GeosGeometryCollection
> {
> private:
>     GeosMultiPolygon();
> public:
> %extend
> {
>     ~GeosMultiPolygon()
>     {
>         GEOSGeom geom = (GEOSGeom) self;
>         GEOSGeom_destroy(geom);
>     }
> }
> };
>
> // ==== Geometry Constructors ===========
>
> %newobject createPoint;
> %newobject createLineString;
> %newobject createLinearRing;
> %newobject createPolygon;
>
> %apply SWIGTYPE *DISOWN {GeosCoordinateSequence *s};
>
> %inline %{
> GeosPoint *createPoint(GeosCoordinateSequence *s)
> {
>     GEOSCoordSeq coords = (GEOSCoordSeq) s;
>     return (GeosPoint*) GEOSGeom_createPoint(coords);
> }
>
> GeosLinearRing *createLinearRing(GeosCoordinateSequence *s)
> {
>     GEOSCoordSeq coords = (GEOSCoordSeq) s;
>     return (GeosLinearRing*) GEOSGeom_createLinearRing(coords);
> }
>
> GeosLineString *createLineString(GeosCoordinateSequence *s)
> {
>     GEOSCoordSeq coords = (GEOSCoordSeq) s;
>     return (GeosLineString*) GEOSGeom_createLineString(coords);
> }
>
> GeosPolygon *createPolygon(GEOSGeom shell, GEOSGeom *holes, size_t nholes)
> {
>     return (GeosPolygon*) GEOSGeom_createPolygon(shell, holes, nholes);
> }
>
> %}
>
> %clear GeosCoordinateSequence *s;
>
> /*
> %newobject createCollection;
> GEOSGeom createCollection(int type, GEOSGeom *geoms, size_t ngeoms)
> {
>     return GEOSGeom_createCollection(type, geoms, ngeoms);
> }
> */
>
>
>
> // === Input/Output ===
> %newobject geomFromWKT;
> %newobject geomFromWKB;
>
> %inline %{
> GeosGeometry geomFromWKT(const char *wkt)
> {
>     return (GeosGeometry) GEOSGeomFromWKT(wkt);
> }
>
> char *geomToWKT(const GeosGeometry* g)
> {
>     const GEOSGeom geom = (const GEOSGeom) g;
>     return GEOSGeomToWKT(geom);
> }
>
> int setWKBOutputDims(int newDims)
> {
>     return GEOS_setWKBOutputDims(newDims);
> }
>
> GeosGeometry geomFromWKB(const unsigned char *wkb, size_t size)
> {
>     return (GeosGeometry) GEOSGeomFromWKB_buf(wkb, size);
> }
>
> unsigned char *geomToWKB(const GEOSGeom* g, size_t *size)
> {
>     const GEOSGeom geom = (const GEOSGeom) g;
>     return GEOSGeomToWKB_buf(geom, size);
> }
> %}
>   


-- 
Prof. Ari Jolma
Kartografia ja Geoinformatiikka / Cartography and Geoinformatics
Teknillinen Korkeakoulu / Helsinki University of Technology
tel: +358 9 451 3886 address: POBox 1200, 02015 TKK, Finland
Email: ari.jolma at tkk.fi URL: http://www.tkk.fi/~jolma


From ILucena at clarku.edu  Tue Jun 27 09:42:14 2006
From: ILucena at clarku.edu (Ivan Lucena)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] import gdal, a installation problem
Message-ID: <6FD7C9DB26540B42A1207C69BF92D455017A7F9E@Iris.ad.clarku.edu>

Hi there!

I need some hints about installing GDAL Python extension in a Windows
environment of a non programmer user.

I installed:

- Python (python-2.4.3.msi), 
- pyWin (py2exe-0.6.5.win32-py2.4.exe), 
- Numeric (Numeric-24.2.win32-py2.4.exe),
- py2exe (py2exe-0.6.5.win32-py2.4.exe)

I copied GDAL distribution from my computer to:

- C:/Program Files/Gdal-1.3.2/bin
- C:/Program Files/Gdal-1.3.2/data
- C:/Program Files/Gdal-1.3.2/html
- C:/Program Files/Gdal-1.3.2/include
- C:/Program Files/Gdal-1.3.2/lib
- C:/Program Files/Gdal-1.3.2/pymod

In "My computer"/properties/Advanced/Environment Variables" I added to
the path system variable:

"C:/Python24/;C:/Program Files/Gdal-1.3.2/bin;C:/Program
Files/Gdal-1.3.2/bin";

In the "User variables" I added:

- GDAL_DATA = C:\Program Files\Gdal-1.3.2\data
- PYTHONPATH = C:\Program Files\Gdal-1.3.2\pymod;C:\Program
Files\Gdal-1.3.2\bin

It is working fine, except that I can't do:

	C:/Data> Python pct2rgb.py

I need to inform the full script path:

	C:/Data> Python "C:\Program Files\Gdal-1.3.2\bin\pct2rgb.py"

My question is: 

- Is it the right way to do that?

Any suggestions?

Thanks in advance,

Ivan


From dpinte at itae.be  Tue Jun 27 12:12:06 2006
From: dpinte at itae.be (Didrik Pinte)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] import gdal, a installation problem
In-Reply-To: <6FD7C9DB26540B42A1207C69BF92D455017A7F9E@Iris.ad.clarku.edu>
References: <6FD7C9DB26540B42A1207C69BF92D455017A7F9E@Iris.ad.clarku.edu>
Message-ID: <1151424726.5079.44.camel@geru-itae>

Le mardi 27 juin 2006 ? 09:42 -0400, Ivan Lucena a ?crit :

> 
> It is working fine, except that I can't do:
> 
> 	C:/Data> Python pct2rgb.py
> 
> I need to inform the full script path:
> 
> 	C:/Data> Python "C:\Program Files\Gdal-1.3.2\bin\pct2rgb.py"


when calling python from the command line, it's not the argument that
are "path completible"... 

It's the rigth way to do it.

If your python installation is correct, you must be able to do :

c:\Data>pct2rgb.py

or 

c:\Program Files\Gdal-1.3.2\bin>python pct2rgb.py

Didrik
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Ceci est une partie de message
	=?ISO-8859-1?Q?num=E9riquement?= =?ISO-8859-1?Q?_sign=E9e?=
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060627/2c160fe4/attachment.bin
From warmerdam at pobox.com  Tue Jun 27 12:13:08 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] import gdal, a installation problem
In-Reply-To: <6FD7C9DB26540B42A1207C69BF92D455017A7F9E@Iris.ad.clarku.edu>
References: <6FD7C9DB26540B42A1207C69BF92D455017A7F9E@Iris.ad.clarku.edu>
Message-ID: <44A15914.7060802@pobox.com>

Ivan Lucena wrote:
...
> It is working fine, except that I can't do:
> 
> 	C:/Data> Python pct2rgb.py
> 
> I need to inform the full script path:
> 
> 	C:/Data> Python "C:\Program Files\Gdal-1.3.2\bin\pct2rgb.py"
> 
> My question is: 
> 
> - Is it the right way to do that?
> 
> Any suggestions?

Ivan,

I don't know a way around this directly.  For FWTools I have .bat files
that invoke the various .py scripts so folks can do "pct2rgb ..." at the
commandline.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From warmerdam at pobox.com  Tue Jun 27 12:14:58 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] ng python bindings
In-Reply-To: <44A0DA58.9070100@sarvision.nl>
References: <44A0DA58.9070100@sarvision.nl>
Message-ID: <44A15982.2080902@pobox.com>

Vincent Schut wrote:
> Hi all,
> 
> I wondered (after some resultless google searching): is there some howto
> lingering somewhere on how to build, install and use the ng python bindings?

Vincent,

On linux/unix it *should* be sufficient to configure using the
"--with-ngpython --without-python" options.  Then build and install.

> Next to that, I remember having seen some messages come by on the numpy
> mailing list about having the gdal python ng bindings use numpy instead
> of numeric as it's supported array library. Because I'm using numpy
> mostly today, I wondered if this will really be the case, and if there
> is already any progress on having gdal bindings that natively support
> numpy instead of Numeric.

Mateusz has not yet completed the work on numpy support for the NG bindings.
I believe currently the ng bindings lack integration with numpy or numeric.
So, you might want to stick to the old bindings for a few more weeks till
the upgrade is ready.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From kmenke at edac.unm.edu  Tue Jun 27 12:09:40 2006
From: kmenke at edac.unm.edu (Kurt Menke)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] r.in.gdal Relocation error
In-Reply-To: <44A00FFE.3020007@pobox.com>
Message-ID: <009a01c69a04$1868dcf0$4501100a@tybalt>

Thanks Frank,
I will take a closer look at those libraries.

GDAL was built using the internal libtiff and geotiff libraries:

--with-libtiff=internal --with-geotiff=internal

Kurt

*************************************
Kurt A. Menke, GISP
GIS Analyst/Programmer
Earth Data Analysis Center
MSC01 1110
1 University of New Mexico
Albuquerque, NM 87131-0001
Ph: 505-277-3622 x239
Fax: 505-277-3614
 

-----Original Message-----
From: Frank Warmerdam [mailto:fwarmerdam@gmail.com] On Behalf Of Frank
Warmerdam
Sent: Monday, June 26, 2006 10:49 AM
To: Kurt Menke
Cc: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] r.in.gdal Relocation error

Kurt Menke wrote:
> I have a new RHEL 3.0 box with GRASS-6.0.1, GDAL-1.3.1 and 
> GDAL-Grass-1.3.1.  When I attempt to import a tiff into a GRASS location 
> using r.in.gdal I receive the following relocation error.  
> 
>  
> 
> Relocation error::/usr/local/gdal/lib/libgdal.so.1: undefined symbol: 
> Tiff GetConfiguredCODECs

Kurt,

This indicates that at runtime GDAL is picking up an older libtiff that
is missing this function.  Perhaps you have an older "system" libtiff, and
a newer one you built yourself on your system?  I wouldn't expect GDAL to
build unless a new version was around somewhere, but depending on shared
library search paths, at runtime it might be picking up an old one.

Presumably the solution would be to force use of the new libtiff in
preference
to the older one, possibly by manipulating search paths (in LD_LIBRARY_PATH
env variable or /etc/ld.so.conf for instance) or just strip the old libtiff
off your system.

Best regards,
-- 
---------------------------------------+------------------------------------
--
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org



From warmerdam at pobox.com  Tue Jun 27 12:30:57 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Problems with ogr2ogr?
In-Reply-To: <A73B6E7A4503E948826CE81A65AF5FEC0877BC@docexs1.ad.consrv.ca.gov>
References: <A73B6E7A4503E948826CE81A65AF5FEC0877BC@docexs1.ad.consrv.ca.gov>
Message-ID: <44A15D41.30402@pobox.com>

Moskovitz, Bob wrote:
> Hello List,
>  
> I am a new user of GDAL./OGR and I have a problem converting (what is 
> supposed to be) a NAD27 California State Plane Zone 5 Mapinfo file to a 
> NAD27 UTM Zone 11.  For some reason ogr2ogr created a file that 
> uses WGS84. The source file was created with MapInfo 6. This is what I did:
...
> *ogr2ogr -f "MapInfo File" -s_srs EPSG:26745 -t_srs EPSG:26711 test.tab 
> LAND_AP_7.tab*
> *ogrinfo -al -so test.tab*
> Had to open data source read-only.
> INFO: Open of `test.tab'
> using driver `MapInfo File' successful.
>  
> Layer name: test
> Geometry: Polygon
> Feature Count: 5
> Extent: (545973.840000, 3789822.180000) - (556088.130000, 3803682.585000)
> Layer SRS WKT:
> PROJCS["unnamed",
>     GEOGCS["unnamed",
>         DATUM["North_American_Datum_1927",
>             SPHEROID["Clarke 1866",6378206.4,294.9786982],
>             TOWGS84[-8,160,176,0,0,0,0]],
>         PRIMEM["Greenwich",0],
>         UNIT["degree",0.0174532925199433]],
>     PROJECTION["Transverse_Mercator"],
>     PARAMETER["latitude_of_origin",0],
>     PARAMETER["central_meridian",-117],
>     PARAMETER["scale_factor",0.9996],
>     PARAMETER["false_easting",500000],
>     PARAMETER["false_northing",0],
>     UNIT["Meter",1.0]]

Bob,

I'm not clear on why you think the output file is in WGS84.  The
above report from ogrinfo is UTM 11 NAD27.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From alexandre.leroux at ec.gc.ca  Tue Jun 27 13:02:05 2006
From: alexandre.leroux at ec.gc.ca (Alexandre Leroux)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Cookie cutting shapefiles in OGR
In-Reply-To: <448D847F.7010504@ec.gc.ca>
References: <448D847F.7010504@ec.gc.ca>
Message-ID: <44A1648D.7020704@ec.gc.ca>


Hi list,

I haven't got any news from my cookie cutting challenge below. Anyone 
has a clue to help me get started?

Thanks and cheers! :-)

Alex


> Can someone tell me if I can do the following with OGR: I have two 
> shapefiles and need to cookie cut one with the other while keeping the 
> attributes of the first shapefile in the newly generated third shapefile.
> 
> I saw there is OGRGeometry::Intersection which would allow me to do 
> this, but I'd need to verify the intersection of all features from 
> shapefile #1 with all features of shapefile #2, which would take days 
> and days to compute with OGR (that's what my collegue which knows OGR 
> way better told me). Is there a way to cookie cut shapefiles directly at 
> the layer level?

-- 
Alexandre Leroux, M.Sc., Ing.
Environnement Canada / Environment Canada
Centre m?t?orologique canadien / Canadian Meteorological Centre
Division de la r?ponse aux urgences environnementales /
Environmental Emergency Response Division
alexandre.leroux@ec.gc.ca

From dmurphy at agi.com  Tue Jun 27 13:10:00 2006
From: dmurphy at agi.com (Murphy, David)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Opening OGDI Datasets
Message-ID: <29474044C503AA40A6D6403925FB04EBC509E9@mail02.stk.com>

Hello-

 

I've developed a VB application which uses the GDAL library via
GDAL_FW.dll.  I have code that opens a CADRG (RPF) dataset

via the OGDI driver.  This code works fine on the development machine,
but when I deploy it to another machine I get an error message "could
not find  dynamic library "RPF"".  I'm using a gltp URL to access the
dataset.  I have GDAL_FW.dll as well as all the FWTools binaries in a
directory beneath the executable.  Are there any other binaries I would
need or does anything need to be registered?  Any info would help.

 

Thanks,

Dave Murphy

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060627/8678d359/attachment.html
From ILucena at clarku.edu  Tue Jun 27 13:22:52 2006
From: ILucena at clarku.edu (Ivan Lucena)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] import gdal, a installation problem
In-Reply-To: <1151424726.5079.44.camel@geru-itae>
Message-ID: <6FD7C9DB26540B42A1207C69BF92D455018C8D3D@Iris.ad.clarku.edu>

Didrik,

You suggestion is embarrassingly simple.

It works!!!!

C:\Data> pct2rgb.py
Usage: pct2rgb.py [-of format] [-b <band>] source_file dest_file
C:\Data>_

Thank you so very much

Ivan 

-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org [mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Didrik Pinte
Sent: 27 June 2006 12:12
To: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] import gdal, a installation problem

Le mardi 27 juin 2006 ? 09:42 -0400, Ivan Lucena a ?crit :

> 
> It is working fine, except that I can't do:
> 
> 	C:/Data> Python pct2rgb.py
> 
> I need to inform the full script path:
> 
> 	C:/Data> Python "C:\Program Files\Gdal-1.3.2\bin\pct2rgb.py"


when calling python from the command line, it's not the argument that
are "path completible"... 

It's the rigth way to do it.

If your python installation is correct, you must be able to do :

c:\Data>pct2rgb.py

or 

c:\Program Files\Gdal-1.3.2\bin>python pct2rgb.py

Didrik


From Bob.Moskovitz at conservation.ca.gov  Tue Jun 27 13:25:17 2006
From: Bob.Moskovitz at conservation.ca.gov (Moskovitz, Bob)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Problems with ogr2ogr?
Message-ID: <A73B6E7A4503E948826CE81A65AF5FEC0877BF@docexs1.ad.consrv.ca.gov>

Hello Frank,

There was a problem when I ran those commands on my Linux box (which is not connected to the Internet).  So, I re ran those commands on my Windows box (which is on the Internet), assuming that I would get the same results.  Looks like I was wrong.  

I am using the GDAL 1.3.1 Windows binary and I compiled GDAL 1.3.2 on my Linux box.  Below is the results of running GDAL on my Linux box.  Thank you for looking into this.

Bob

ogrinfo -al -so LAND_AP_7.tab
Had to open data source read-only.
INFO: Open of `LAND_AP_7.tab'
using driver `MapInfo File' successful.
 
Layer name: LAND_AP_7
Geometry: Polygon
Feature Count: 6
Extent: (2452634.218712, 276580.102129) - (2486216.118198, 322063.122454)
Layer SRS WKT:
PROJCS["unnamed",
    GEOGCS["unnamed",
        DATUM["NAD_1927",
            SPHEROID["Clarke 1866",6378206.4,294.9786982],
            TOWGS84[-8,160,176,0,0,0,0]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Lambert_Conformal_Conic_2SP"],
    PARAMETER["standard_parallel_1",34.0333333333],
    PARAMETER["standard_parallel_2",35.4666666667],
    PARAMETER["latitude_of_origin",33.5],
    PARAMETER["central_meridian",-118],
    PARAMETER["false_easting",609601.2],
    PARAMETER["false_northing",0],
    UNIT["U.S. Foot",0.3048006]]
AREA: Real (0.0)
PERIMETER: Real (0.0)
LAND_AP_7_: Integer (0.0)
LAND_AP_7_ID: Integer (0.0)
 
ogr2ogr -f "MapInfo File" -s_srs EPSG:26745 -t_srs EPSG:26711 test.tab LAND_AP_7.tab
ogrinfo -al -so test.tab
Had to open data source read-only.
INFO: Open of `test.tab'
using driver `MapInfo File' successful.
 
Layer name: test
Geometry: Polygon
Feature Count: 5
Extent: (545973.839059, 3789822.182688) - (556088.117459, 3803682.581444)
Layer SRS WKT:
PROJCS["unnamed",
    GEOGCS["unnamed",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.257223563],
            TOWGS84[0,0,0,-0,-0,-0,0]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",-117],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",0],
    UNIT["Meter",1.0]]
AREA: Real (0.0)
PERIMETER: Real (0.0)
LAND_AP_7_: Integer (0.0)
LAND_AP_7_ID: Integer (0.0)

-----Original Message-----
From: Frank Warmerdam [mailto:fwarmerdam@gmail.com]On Behalf Of Frank
Warmerdam
Sent: Tuesday, June 27, 2006 9:31 AM
To: Moskovitz, Bob
Cc: Gdal-Dev (E-mail)
Subject: Re: [Gdal-dev] Problems with ogr2ogr?


Moskovitz, Bob wrote:
> Hello List,
>  
> I am a new user of GDAL./OGR and I have a problem converting (what is 
> supposed to be) a NAD27 California State Plane Zone 5 Mapinfo file to a 
> NAD27 UTM Zone 11.  For some reason ogr2ogr created a file that 
> uses WGS84. The source file was created with MapInfo 6. This is what I did:
...
> *ogr2ogr -f "MapInfo File" -s_srs EPSG:26745 -t_srs EPSG:26711 test.tab 
> LAND_AP_7.tab*
> *ogrinfo -al -so test.tab*
> Had to open data source read-only.
> INFO: Open of `test.tab'
> using driver `MapInfo File' successful.
>  
> Layer name: test
> Geometry: Polygon
> Feature Count: 5
> Extent: (545973.840000, 3789822.180000) - (556088.130000, 3803682.585000)
> Layer SRS WKT:
> PROJCS["unnamed",
>     GEOGCS["unnamed",
>         DATUM["North_American_Datum_1927",
>             SPHEROID["Clarke 1866",6378206.4,294.9786982],
>             TOWGS84[-8,160,176,0,0,0,0]],
>         PRIMEM["Greenwich",0],
>         UNIT["degree",0.0174532925199433]],
>     PROJECTION["Transverse_Mercator"],
>     PARAMETER["latitude_of_origin",0],
>     PARAMETER["central_meridian",-117],
>     PARAMETER["scale_factor",0.9996],
>     PARAMETER["false_easting",500000],
>     PARAMETER["false_northing",0],
>     UNIT["Meter",1.0]]

Bob,

I'm not clear on why you think the output file is in WGS84.  The
above report from ogrinfo is UTM 11 NAD27.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org



From schut at sarvision.nl  Wed Jun 28 03:43:26 2006
From: schut at sarvision.nl (Vincent Schut)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] ng python bindings
In-Reply-To: <44A15982.2080902@pobox.com>
References: <44A0DA58.9070100@sarvision.nl> <44A15982.2080902@pobox.com>
Message-ID: <44A2331E.90904@sarvision.nl>

Frank Warmerdam wrote:
> Vincent Schut wrote:
>> Hi all,
>>
>> I wondered (after some resultless google searching): is there some howto
>> lingering somewhere on how to build, install and use the ng python
>> bindings?
>
> Vincent,
>
> On linux/unix it *should* be sufficient to configure using the
> "--with-ngpython --without-python" options.  Then build and install.
Sounds good!
Probably the lack of Numeric/Numpy support was what made me doubt a
correct install earlier, as I assumed that the compatibility of the ng
bindings with the old ones involved Numeric too.
>
>> Next to that, I remember having seen some messages come by on the numpy
>> mailing list about having the gdal python ng bindings use numpy instead
>> of numeric as it's supported array library. Because I'm using numpy
>> mostly today, I wondered if this will really be the case, and if there
>> is already any progress on having gdal bindings that natively support
>> numpy instead of Numeric.
>
> Mateusz has not yet completed the work on numpy support for the NG
> bindings.
> I believe currently the ng bindings lack integration with numpy or
> numeric.
> So, you might want to stick to the old bindings for a few more weeks till
> the upgrade is ready.
I'll wait till the numpy integration is ready then. And then I'll be a
happy (hopefully) beta tester.
Thanks for the update.
>
> Best regards,


From zhonghaiw at gmail.com  Wed Jun 28 06:42:20 2006
From: zhonghaiw at gmail.com (Zhonghai Wang)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] need suggestions about TIFF image processing
Message-ID: <2534c4120606280342p58274ed1q235c7df0d1fa70e1@mail.gmail.com>

Hi guys,

I have about 200 RGB TIFFs (24bit) for my application, since the color is
not so nice enough, I want to make some changes, therefore I need a software
to do it, and even to convert the image format, such as TIFF to GIF. Both
opensource and commercial software will do.

any  suggestions?

kind Regards

Zhonghai Wang
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060628/72e7f6ed/attachment.html
From mark at overmeer.net  Wed Jun 28 08:10:26 2006
From: mark at overmeer.net (Mark Overmeer)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] JP2KAK
Message-ID: <20060628121026.GE13345@earth.overmeer.net>


Hi,

using FWTools 1.0.0a7 linux precompiled binaries
GDAL 1.3.1.0, FWTools 1.0.0a7, released 2005/11/10

I start gdal_translate with one tif which contains three gdal_merge'd
tiff bands:

   gdal_translate -of JP2ECW my.tif my.jp2

output:

   Input file size is 4980, 4200
   0...10...20...30...40...50...60...70...80...90...100 - done.
   Warning 1: Kakadu Warning:
   Profile violation detected (code-stream is technically illegal).
   Profile-0 code-streams must have nominally square code-block dimensions,
   measuring 32x32 or 64x64.  You should set "Sprofile" to 1 or 2.

two things:
   1) why is Kakadu warning me?  I select JP2ECW

   2) how can I resolve the warning
-- 
Thanks in advance,

               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
http://Mark.Overmeer.net                   http://solutions.overmeer.net


From warmerdam at pobox.com  Wed Jun 28 09:05:25 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] JP2KAK
In-Reply-To: <20060628121026.GE13345@earth.overmeer.net>
References: <20060628121026.GE13345@earth.overmeer.net>
Message-ID: <44A27E95.5000106@pobox.com>

Mark Overmeer wrote:
> Hi,
> 
> using FWTools 1.0.0a7 linux precompiled binaries
> GDAL 1.3.1.0, FWTools 1.0.0a7, released 2005/11/10
> 
> I start gdal_translate with one tif which contains three gdal_merge'd
> tiff bands:
> 
>    gdal_translate -of JP2ECW my.tif my.jp2
> 
> output:
> 
>    Input file size is 4980, 4200
>    0...10...20...30...40...50...60...70...80...90...100 - done.
>    Warning 1: Kakadu Warning:
>    Profile violation detected (code-stream is technically illegal).
>    Profile-0 code-streams must have nominally square code-block dimensions,
>    measuring 32x32 or 64x64.  You should set "Sprofile" to 1 or 2.
> 
> two things:
>    1) why is Kakadu warning me?  I select JP2ECW

Mark,

The JPEG2000 file was written with the JP2ECW driver but when writing
is complete it is reopened with the generic GDALOpen() which ends up using
the first registered JPEG2000 driver which turns out to be Kakadu.

>    2) how can I resolve the warning

I'm not sure if this is a serious warning.  You might want to try
generating your file with the extra option -co PROFILE=BASELINE_1 and
see if that helps.  I suspect that is similar to the Sprofile=1 Kakadu
option.  If the problem persists you might want to take it up on the
ECW SDK forums at ermapper.com.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From mark at overmeer.net  Wed Jun 28 11:47:38 2006
From: mark at overmeer.net (Mark Overmeer)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] JP2KAK
In-Reply-To: <44A27E95.5000106@pobox.com>
References: <20060628121026.GE13345@earth.overmeer.net>
	<44A27E95.5000106@pobox.com>
Message-ID: <20060628154738.GC12993@earth.overmeer.net>

* Frank Warmerdam (warmerdam@pobox.com) [060628 13:05]:
> >   Input file size is 4980, 4200
> >   0...10...20...30...40...50...60...70...80...90...100 - done.
> >   Warning 1: Kakadu Warning:
> >
> >two things:
> >   1) why is Kakadu warning me?  I select JP2ECW
> 
> The JPEG2000 file was written with the JP2ECW driver but when writing
> is complete it is reopened with the generic GDALOpen() which ends up using
> the first registered JPEG2000 driver which turns out to be Kakadu.

It wonders me that the file is reopened in the first place (why?).  And then,
weird that the -of flag is ignored.  Although that did accidentally caught
an avoidable warning which is possitive.

> >   2) how can I resolve the warning
> 
> I'm not sure if this is a serious warning.  You might want to try
> generating your file with the extra option -co PROFILE=BASELINE_1 and
> see if that helps.  I suspect that is similar to the Sprofile=1 Kakadu
> option.  If the problem persists you might want to take it up on the
> ECW SDK forums at ermapper.com.

It helped.  Everywhere I see references to read the ECW SDK... but the docs
of the SDK do not explain the options (at least: I cannot find it)

Thanks for your fast answer!
-- 
               MarkOv

From bartvde at xs4all.nl  Wed Jun 28 12:05:44 2006
From: bartvde at xs4all.nl (Bart van den Eijnden (OSGIS))
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] GML 3 support
Message-ID: <44A2A8D8.5010302@xs4all.nl>

Hi Frank, list,

is there a roadmap for adding GML 3 support in OGR?

I guess lots of parties must be interested in this, so maybe some 
co-funding could do the trick.

Best regards,
Bart

-- 
Bart van den Eijnden
OSGIS, Open Source GIS
http://www.osgis.nl


From warmerdam at pobox.com  Wed Jun 28 12:16:25 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] JP2KAK
In-Reply-To: <20060628154738.GC12993@earth.overmeer.net>
References: <20060628121026.GE13345@earth.overmeer.net>
	<44A27E95.5000106@pobox.com>
	<20060628154738.GC12993@earth.overmeer.net>
Message-ID: <44A2AB59.6010506@pobox.com>

Mark Overmeer wrote:
> It wonders me that the file is reopened in the first place (why?).  

Mark,

The GDALCreateCopy() function returns a handle to the opened dataset
created, but many "create copy" functions have to fetch such an object
by calling the generic GDALOpen() function when they are done writing
the dataset.  You can think of this as an artifact of the internal API
organization.

 > And then,
> weird that the -of flag is ignored.  Although that did accidentally caught
> an avoidable warning which is possitive.

The GDALOpen() function provides no mechanism to ensure a particular driver
is used to open a file, so we often get the situation you see with jpeg2000
files where there are several drivers for the same format.

>>>   2) how can I resolve the warning
>> I'm not sure if this is a serious warning.  You might want to try
>> generating your file with the extra option -co PROFILE=BASELINE_1 and
>> see if that helps.  I suspect that is similar to the Sprofile=1 Kakadu
>> option.  If the problem persists you might want to take it up on the
>> ECW SDK forums at ermapper.com.
> 
> It helped.  Everywhere I see references to read the ECW SDK... but the docs
> of the SDK do not explain the options (at least: I cannot find it)

My copy of the ECW SDK source code includes an SDK.pdf file.  Circa page
113 is a section on the CNCSFile::SetParameter() call defining the meaning
of various parameters affecting JPEG2000 creation.

I will conceed that referring to the SDK docs for these options is a bit
of a cop-out on my part. :-)

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From werchowyna at epf.pl  Wed Jun 28 13:17:53 2006
From: werchowyna at epf.pl (Maciek Sieczka)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] need suggestions about TIFF image processing
In-Reply-To: <2534c4120606280342p58274ed1q235c7df0d1fa70e1@mail.gmail.com>
References: <2534c4120606280342p58274ed1q235c7df0d1fa70e1@mail.gmail.com>
Message-ID: <20060628191753.3aba7e6c.werchowyna@epf.pl>

On Wed, 28 Jun 2006 12:42:20 +0200
"Zhonghai Wang" <zhonghaiw@gmail.com> wrote:

> Hi guys,
> 
> I have about 200 RGB TIFFs (24bit) for my application, since the
> color is not so nice enough, I want to make some changes, therefore I
> need a software to do it, and even to convert the image format, such
> as TIFF to GIF.

gdal_translate, in a loop like this (using BASH on Linux, mind my
limited scripting skills but works, gifs will be stored in your
current dir):

#!/bin/bash

LIST=$(ls /the/dir/where/tiffs/are | grep -i ".tif")
#					       ^^^
#				adjust the extension as needed


for FILE in $LIST;
do

	echo
	echo Converting: $FILE

	# optional to convert all filenames to lowercase:
	# FILE_LOW=`echo $FILE | tr A-Z a-z`

	gdal_translate $FILE `basename $FILE .tif`.gif

done

> Both opensource and commercial software will do.

opensource is not contrary to commercial - take GDAL for example :).

Maciek

------------------------------------------------------------------------
CIEP?E KRAJE - CIEP?E MORZA. Szukasz atrakcyjnego wypoczynku w przyst?pnej cenie, zapoznaj si? z nasz? ofert?.
ZAPRASZAMY

www.skarpatravel.pl


From warmerdam at pobox.com  Wed Jun 28 15:24:48 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] GML 3 support
In-Reply-To: <44A2A8D8.5010302@xs4all.nl>
References: <44A2A8D8.5010302@xs4all.nl>
Message-ID: <44A2D780.6080905@pobox.com>

Bart van den Eijnden (OSGIS) wrote:
> Hi Frank, list,
> 
> is there a roadmap for adding GML 3 support in OGR?
> 
> I guess lots of parties must be interested in this, so maybe some 
> co-funding could do the trick.

Bart,

There is no fixed plan for this, but Mateusz Loskot and I have been
discussing the possibility of his doing a brand new GML3 driver not
built on the same adhoc techniques currently used in the GML2 driver.

I think it would be interesting to approach this as a two stage process,
with the first stage being the "simple features" profile of GML3 that
was recently approved by OGC, and then a second stage to move to a more
full featured implementation.

One issue is that GML3 includes some sophisticated data modelling capabilities
not inherent in OGR.  So we might either have to upgrade OGR or recognise
the limitations in the driver.

If anyone interested in potentially supporting such an effort would speak
up, I could try and prepare a more formal proposal with Mateusz in the coming
weeks.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From craig.miller at spatialminds.com  Wed Jun 28 15:37:53 2006
From: craig.miller at spatialminds.com (Craig Miller)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Limit columns returned in OGR?
Message-ID: <00f101c69aea$5933a760$0401a8c0@vaio>

Is there a way to limit the columns that are returned with a layer other
than using OGRDataSource::ExecuteSQL(...)?

E.g. 
OGRDatasource::GetLayer() allows me to set the SQL FROM clause to a single
table.
OGRLayer::SetAttributeFilter allows me to set the SQL WHERE clause.
I don't see it, but I thought I'd ask before I code something using
ExecuteSQL()... Is it possible to set the SQL SELECT clause?

Thanks,
Craig




From warmerdam at pobox.com  Wed Jun 28 21:48:17 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Limit columns returned in OGR?
In-Reply-To: <00f101c69aea$5933a760$0401a8c0@vaio>
References: <00f101c69aea$5933a760$0401a8c0@vaio>
Message-ID: <44A33161.4020904@pobox.com>

Craig Miller wrote:
> Is there a way to limit the columns that are returned with a layer other
> than using OGRDataSource::ExecuteSQL(...)?
> 
> E.g. 
> OGRDatasource::GetLayer() allows me to set the SQL FROM clause to a single
> table.
> OGRLayer::SetAttributeFilter allows me to set the SQL WHERE clause.
> I don't see it, but I thought I'd ask before I code something using
> ExecuteSQL()... Is it possible to set the SQL SELECT clause?

Craig,

There is no mechanism other than ExecuteSQL() to select only a subset
of columns from a layer/table within OGR.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From eric.doenges at gmx.net  Thu Jun 29 01:58:30 2006
From: eric.doenges at gmx.net (=?ISO-8859-1?Q?Eric_D=F6nges?=)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] need suggestions about TIFF image processing
In-Reply-To: <20060628191753.3aba7e6c.werchowyna@epf.pl>
References: <2534c4120606280342p58274ed1q235c7df0d1fa70e1@mail.gmail.com>
	<20060628191753.3aba7e6c.werchowyna@epf.pl>
Message-ID: <D38F97DB-34A0-4AD2-84B4-2BF621C30E46@gmx.net>


Am 28.06.2006 um 19:17 schrieb Maciek Sieczka:

> On Wed, 28 Jun 2006 12:42:20 +0200
> "Zhonghai Wang" <zhonghaiw@gmail.com> wrote:
>
>> Hi guys,
>>
>> I have about 200 RGB TIFFs (24bit) for my application, since the
>> color is not so nice enough, I want to make some changes, therefore I
>> need a software to do it, and even to convert the image format, such
>> as TIFF to GIF.
>
> gdal_translate, in a loop like this (using BASH on Linux, mind my
> limited scripting skills but works, gifs will be stored in your
> current dir):

If all you want to do is change image formats, you might also want to  
take a look
at ImageMagick (http://www.imagemagick.org), which supports most  
(raster) image formats
known to man, and allows you to do a large variety of image  
processing operations.
Like GDAL, it is free software.


From zhonghaiw at gmail.com  Thu Jun 29 02:52:05 2006
From: zhonghaiw at gmail.com (Zhonghai Wang)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] need suggestions about TIFF image processing
In-Reply-To: <D38F97DB-34A0-4AD2-84B4-2BF621C30E46@gmx.net>
References: <2534c4120606280342p58274ed1q235c7df0d1fa70e1@mail.gmail.com>
	<20060628191753.3aba7e6c.werchowyna@epf.pl>
	<D38F97DB-34A0-4AD2-84B4-2BF621C30E46@gmx.net>
Message-ID: <2534c4120606282352i7fd4750akda7b494cb3bbf611@mail.gmail.com>

Hi,

thank you guys for the suggestions. I've found a solution for my image
processing.

kind regards

zhonghai


On 6/29/06, Eric D?nges <eric.doenges@gmx.net> wrote:
>
>
> Am 28.06.2006 um 19:17 schrieb Maciek Sieczka:
>
> > On Wed, 28 Jun 2006 12:42:20 +0200
> > "Zhonghai Wang" <zhonghaiw@gmail.com> wrote:
> >
> >> Hi guys,
> >>
> >> I have about 200 RGB TIFFs (24bit) for my application, since the
> >> color is not so nice enough, I want to make some changes, therefore I
> >> need a software to do it, and even to convert the image format, such
> >> as TIFF to GIF.
> >
> > gdal_translate, in a loop like this (using BASH on Linux, mind my
> > limited scripting skills but works, gifs will be stored in your
> > current dir):
>
> If all you want to do is change image formats, you might also want to
> take a look
> at ImageMagick (http://www.imagemagick.org), which supports most
> (raster) image formats
> known to man, and allows you to do a large variety of image
> processing operations.
> Like GDAL, it is free software.
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060629/170a4120/attachment.html
From mark at overmeer.net  Thu Jun 29 04:29:46 2006
From: mark at overmeer.net (Mark Overmeer)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] JP2KAK
In-Reply-To: <44A2AB59.6010506@pobox.com>
References: <20060628121026.GE13345@earth.overmeer.net>
	<44A27E95.5000106@pobox.com>
	<20060628154738.GC12993@earth.overmeer.net>
	<44A2AB59.6010506@pobox.com>
Message-ID: <20060629082946.GF12993@earth.overmeer.net>

* Frank Warmerdam (warmerdam@pobox.com) [060628 16:16]:
> >It helped.  Everywhere I see references to read the ECW SDK... but the docs
> >of the SDK do not explain the options (at least: I cannot find it)
> 
> My copy of the ECW SDK source code includes an SDK.pdf file.  Circa page
> 113 is a section on the CNCSFile::SetParameter() call defining the meaning
> of various parameters affecting JPEG2000 creation.

Ok.  Problem solved: the compiled distribution contains a file
ER_Mapper_SDK.pdf which does contain some technical information about
the library, but the source distribution contains a file SDK.pdf which
contains real internals.

The reference to the parameters is there, but on the same level of
detail as on gdal's webpage: just listed.  This is typical for technical
documentation: describing the options without explaining the use. F.i:

 JP2_COMPRESS_BASELINE_0   Compress for Class 0 compliant Coders
 JP2_COMPRESS_BASELINE_1   Compress for Class 1 compliant Coders
 JP2_COMPRESS_BASELINE_2   Compress for Class 2 compliant Coders

could do with some words like:
 The higher the BASELINE, the better the compression, but the higher
 level is not always implemented and sometimes slower.

Above lines are certainly untrue, but what is the real meaning of the
options in user terms?  What is the effect on the output in size, quality,
portability.  That are questions the library user likes to have answered.
Of course, you get into polically difficult and subjective areas.

Anyway, I am very glad that I can convert anything to anything using GDAL,
although still uncertain whether I use the optimal settings.  Translating
20k satellite scenes, which takes me many weeks of computational
power, a little more assurance that this gives me the optimal results
(without the need to interpret the JPEG2000 specification in full detail
myself) was welcome.  Extend the wikipedia pages?

Thanks for your (as ever) fast, very clear, and to the point response.
-- 
Regards,
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
http://Mark.Overmeer.net                   http://solutions.overmeer.net


From collinsb at mitre.org  Thu Jun 29 12:46:46 2006
From: collinsb at mitre.org (Collins, Benjamin)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] SWIG architecture
Message-ID: <8D27E2CDAF11D34F97E7445BCCCDB92CFEC05E@IMCSRV1.MITRE.ORG>

To the SWIG folks,

We were interested in using more OGR features to handle vector formats
from the SWIG'ed Java wrappers.  However, the currently exposed
interfaces do not include the necessary functions to get information
about polygons, etc; especially not in the natural way that such
information is available in the C++ API.
I thought I would see that would result from a more hands-off approach
to the SWIG *.i files.  I created a new ogr.i file with the
ogrsf_frmts.h file '%include'd along with some of the other main files.
(Later I had to modify this a little, but not in any important way.)  I
SWIG'ed this and got a full featured, more object oriented Java
interface than before.  I am able to essentially use the C++ API with a
straigt "transliteration."  Some language-specific typemaps could still
help, but this is not the essence of the experiment.

So my question is this:  why does the SWIG wrapper wrap the C-stlye
API.  Why not just go for the C++, get all the OO for free (esp w/
OGRGeometry)?
Also, why the use of *Shadow, etc?

I fully realize that there may be some caveat of SWIG keeping us from
this approach.

Thanks,
--
Ben Collins


From Chris.Barker at noaa.gov  Thu Jun 29 18:10:39 2006
From: Chris.Barker at noaa.gov (Christopher Barker)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Is there a GetRasterBandasRGB?
Message-ID: <44A44FDF.4030704@noaa.gov>

Hi all,

I've been starting to work with GDAL (mostly with the python bindings), 
and I've been very impressed, it's a very nice piece of work. I'm 
particularly thrilled with the BSB support.

What I need to do is be able to read any (ideally) form of 
geo-referenced raster image that GDAL supports, and then get a 24 bit 
RGB version of a given subset of the image.

I've found I can use GetRasterBand() to extract the data I want. 
However, I found myself having to write different versions of the code, 
depending on how the data was stored:

if is is a single band raster, with a ColorTable, I do one thing

If it's a three band raster, with RBG bands, I do another

etc.....

Those are the two I've supported so far, but then it downed on me that 
my needs can not be unique! this must be a pretty common problem.

So the question is, have I missed a function that extracts a subsection 
of the rasterdata, and converts it to RGB data for me? If it's not built 
in to GDAL, has anyone written such a thing, and/or would this be the 
kind of thing that you'd like to add, if I write it?

thanks,

-Chris








-- 
Christopher Barker, Ph.D.
Oceanographer
                                     		
NOAA/OR&R/HAZMAT         (206) 526-6959   voice
7600 Sand Point Way NE   (206) 526-6329   fax
Seattle, WA  98115       (206) 526-6317   main reception

Chris.Barker@noaa.gov

From cfis at interserv.com  Thu Jun 29 19:52:23 2006
From: cfis at interserv.com (Charlie Savage)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Re: SWIG architecture
In-Reply-To: <8D27E2CDAF11D34F97E7445BCCCDB92CFEC05E@IMCSRV1.MITRE.ORG>
References: <8D27E2CDAF11D34F97E7445BCCCDB92CFEC05E@IMCSRV1.MITRE.ORG>
Message-ID: <44A467B7.6030305@interserv.com>

Hi Benjamin,

My understanding is that Frank made the decision to wrap using the C API 
and not the C++ API because the C API provides binary compatibility 
between releases.  In theory, this means that client applications are 
less likely to break when upgrading.

The same arguments have been put forth for the GEOS project, and in that 
case I've been migrating the SWIG bindings from the C++ api to the C API.

 From my viewpoint, I don't actually see how the C API provides better 
compatibility than the C++ api for the SWIG bindings (note it certainly 
does for C or C++ clients compiled against libgdal.so).  The reason I 
don't see any benefit is because for the languages I use (Ruby, but also 
Python) the host language is not relying on binary compatibility to load 
the SWIG built extensions (of course the extensions have to be 
recompiled for each new release but then again so does the C API). 
Instead, each language has hooks that you call to install new classes or 
methods.  Perhaps that is not the case for C# or Java, I haven't tried 
so I don't know.

The other argument for using the C API is that it limits what is exposed 
to clients, thus giving more freedom for the core of GDAL or GEOS to 
evolve over time without breaking clients.

Anyway, hope this helps.  I'm sure someone will chime in if I've missed 
some other reason.

Charlie







Anyway,
with the

http://geos.refractions.net/pipermail/geos-devel/2006-June/002317.html



binary compatibility

Collins, Benjamin wrote:
> To the SWIG folks,
> 
> We were interested in using more OGR features to handle vector formats
> from the SWIG'ed Java wrappers.  However, the currently exposed
> interfaces do not include the necessary functions to get information
> about polygons, etc; especially not in the natural way that such
> information is available in the C++ API.
> I thought I would see that would result from a more hands-off approach
> to the SWIG *.i files.  I created a new ogr.i file with the
> ogrsf_frmts.h file '%include'd along with some of the other main files.
> (Later I had to modify this a little, but not in any important way.)  I
> SWIG'ed this and got a full featured, more object oriented Java
> interface than before.  I am able to essentially use the C++ API with a
> straigt "transliteration."  Some language-specific typemaps could still
> help, but this is not the essence of the experiment.
> 
> So my question is this:  why does the SWIG wrapper wrap the C-stlye
> API.  Why not just go for the C++, get all the OO for free (esp w/
> OGRGeometry)?
> Also, why the use of *Shadow, etc?
> 
> I fully realize that there may be some caveat of SWIG keeping us from
> this approach.
> 
> Thanks,
> --
> Ben Collins


From cfis at savagexi.com  Thu Jun 29 20:07:13 2006
From: cfis at savagexi.com (Charlie Savage)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Re: SWIG architecture
In-Reply-To: <8D27E2CDAF11D34F97E7445BCCCDB92CFEC05E@IMCSRV1.MITRE.ORG>
References: <8D27E2CDAF11D34F97E7445BCCCDB92CFEC05E@IMCSRV1.MITRE.ORG>
Message-ID: <44A46B31.5000706@savagexi.com>

Hi Benjamin,

My understanding is that Frank made the decision to wrap using the C API
and not the C++ API because the C API provides binary compatibility
between releases.  In theory, this means that client applications are
less likely to break when upgrading.

The same arguments have been put forth for the GEOS project, and in that
case I've been migrating the SWIG bindings from the C++ api to the C API.

 From my viewpoint, I don't actually see how the C API provides better
compatibility than the C++ api for the SWIG bindings (note it certainly
does for C or C++ clients compiled against libgdal.so).  The reason I
don't see any benefit is because for the languages I use (Ruby, but also
Python) the host language is not relying on binary compatibility to load
the SWIG built extensions (of course the extensions have to be
recompiled for each new release but then again so does the C API).
Instead, each language has hooks that you call to install new classes or
methods.  Perhaps that is not the case for C# or Java, I haven't tried
so I don't know.

The other argument for using the C API is that it limits what is exposed
to clients, thus giving more freedom for the core of GDAL or GEOS to
evolve over time without breaking clients.

Anyway, hope this helps.  I'm sure someone will chime in if I've missed
some other reason.

Charlie







Anyway,
with the

http://geos.refractions.net/pipermail/geos-devel/2006-June/002317.html



binary compatibility

Collins, Benjamin wrote:
> To the SWIG folks,
> 
> We were interested in using more OGR features to handle vector formats
> from the SWIG'ed Java wrappers.  However, the currently exposed
> interfaces do not include the necessary functions to get information
> about polygons, etc; especially not in the natural way that such
> information is available in the C++ API.
> I thought I would see that would result from a more hands-off approach
> to the SWIG *.i files.  I created a new ogr.i file with the
> ogrsf_frmts.h file '%include'd along with some of the other main files.
> (Later I had to modify this a little, but not in any important way.)  I
> SWIG'ed this and got a full featured, more object oriented Java
> interface than before.  I am able to essentially use the C++ API with a
> straigt "transliteration."  Some language-specific typemaps could still
> help, but this is not the essence of the experiment.
> 
> So my question is this:  why does the SWIG wrapper wrap the C-stlye
> API.  Why not just go for the C++, get all the OO for free (esp w/
> OGRGeometry)?
> Also, why the use of *Shadow, etc?
> 
> I fully realize that there may be some caveat of SWIG keeping us from
> this approach.
> 
> Thanks,
> --
> Ben Collins


-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/x-pkcs7-signature
Size: 3237 bytes
Desc: S/MIME Cryptographic Signature
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060629/427c452f/smime.bin
From warmerdam at pobox.com  Fri Jun 30 00:53:27 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Slow JPEG2000 Reading with JP2KAK driver
Message-ID: <44A4AE47.10208@pobox.com>

Folks,

A client recently complained of poor performance reading with the
JP2KAK jpeg2000 driver.  I thought the points raised in my response
might be of somewhat general interest, as some apply to a variety of
drivers and situations, so I am forwarding a slightly edited copy of the
message here.

=== response:

There are a few issues with the current GDAL JP2KAK (Kakadu) driver.

The first is that it takes a tiled approach to reading the jpeg2000 files.
The code you have defaults to a 512x128 blocking size in the GDAL cache.
So if you want to read the whole file, it will do this as a quite a large
number of 512x128 reads.  Each read involves "setting a window" on the
jpeg2000 through the Kakadu library.  This process seems to be fairly
expensive.  A preferrable approach is to set a single full file size window
and then read through that one line at a time.

However, because GDAL does not know the access pattern of the calling
application in advance, it can be very hard to decide on a window strategy.
If the application ends up requesting lots of little bits of imagery
then I would either read through a lot of unused imagery from a big window,
or have to reset the window for each request which can be terrible if
each request is just one scanline for instance.

So I take this blocked approach that is rather suboptimal in the best
case, but at least not too bad in the worst case.

The second factor is that, as you supposed, multi-band files are read
one band at a time.  I'm not sure this is really a problem for some
datasets which are internally essentially band oriented anyways.  But
for some it might mean some extra processing or at least file io is
being done making distinct passes for red, green and blue.  For RGB
images, I actually just ask the Kakadu library for one band at a time,
so at least it is optimizing the access somewhat.  But for YCbCr images
I need to read all the bands just to compute any of red, green or blue.

So I have done some restructuring internally in the YCbCr case so that
once a chunk is read, the red, green and blue components are all
pushed into the block cache.  For my test YCbCr file (a common arrangement
for color jpeg2000 files) this sped things up by a factor of about 2.5.
So a substantial improvement, but not an order of magnitude.

I also did some tuning on the default block size, increasing it to
2048x128.  This sped processing up by about 25%.   Overall a translation
of a 3200 x 2600 file went from about 12 seconds to about 3.5 seconds
with these two code changes.   The old speed was about 2MB/second read
speed, while the new speed is about 7MB/second.

I'm not sure why your collegue was seeing processing speeds of about
0.3MB/second.  That does seem unreasonable slow.

But the *third* thing to keep in mind is that tile-blocked images
such as jpeg2000 are quite sensitive to "cache thrashing".  That is,
if the application asks for a single scanline of a very wide image,
it may be that the cache cannot hold a whole "row" of tiles in the
cache at one time.  If not, the caching system will start throwing
away the early tiles and the next scanline request will result in
all the tiles being re-read.  So it is very important from a
performance point of view to ensure that the GDAL caching limit is
at least large enough to hold a whole row of blocks.  For a 100000
pixel wide RGB image, you would need roughly 384MB of cache space
to hold a complete row of blocks (100000 x 128).  This cost of a
row is why I use a very asymetric size for the blocks - to reduce
the likelyhood of cache thrashing.

I am wondering if this might have been happening to your co-worker.

There are a few other things that I can potentially do to improve
the efficiency of the driver.

1) Provider overridden IRasterIO() methods that process large
    windowed requests as a single "set window and read" operation
    on the jpeg2000 files instead of using the blocking approach.
    This would help for applications that ask for data in large
    chunks.  I already do this in the MrSID and ECW SDK based
    jpeg2000 readers, though deciding when to use the special
    case can be problematic.

2) Modify the block based RasterIO() implementation to copy all
    data out of an acquired block into the working buffer before
    moving on to the next block.  Currently the logic attempts to
    satisfy all pixels in out destination buffer scanline before
    starting the next, which case result in cache thrashing even
    for large request windows.  This problem has been reported in
    the past by another client and I do intend to address it at
    some point.

    This would help a variety of block oriented drivers that can
    suffer cache thrashing on large datasets.

3) I could temporarily force the GDAL cache max to be large enough
    to hold one whole row of blocks while large files are open.
    This would avoid "cache thrashing" within GDAL, but might easily
    result in overall virtual memory thrashing.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From mateusz at loskot.net  Fri Jun 30 08:58:22 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Re: [GDAL Tasks] Autotest of PostgreSQL provider
In-Reply-To: <449CAC36.5080506@loskot.net>
References: <449CAC36.5080506@loskot.net>
Message-ID: <44A51FEE.9040301@loskot.net>

Hi Frank,

Here is small info regarding two extra tasks about ogr_pg.py.

Mateusz Loskot wrote:
> Two extra tasks:
> Check why two test cases fail:

> 
> mloskot:~/dev/gdal/_cvs/autotest/ogr$ ./ogr_pg.py
>   TEST: ogr_pg_1 ... success
>   TEST: ogr_pg_2 ... success
>   TEST: ogr_pg_3 ... success
>   TEST: ogr_pg_4 ... success
>   TEST: ogr_pg_5 ... success
>   TEST: ogr_pg_6 ... success
>   TEST: ogr_pg_7 ... fail
>     field eas_id feature 0 did not match expected value 158, got 168.

My version of autotest database did not include PostGIS.
After I imported lwpostgis.sql file and plpgsql support,
the test case works - SetSpatialFilter does the job well.

>   TEST: ogr_pg_8 ... success
>   TEST: ogr_pg_9 ... success
>   TEST: ogr_pg_10 ... success
>   TEST: ogr_pg_11 ... success
>   TEST: ogr_pg_12 ... fail
>     expected geometry but got NULL.

Again, lack of PostGIS.
When no PostGIS is available GeometryToHex returns incompatible output.
After I changed it to GeometryToBYTA, geometries imported to non-PostGIS
database of PostgreSQL have valid values.
But, because PG test requires PostGIS, I reverted to GeometryToHex which
works well when PostGIS is available.
I added CPLDebug message to inform user that no PostGIS is available.


All ogr_pg.py tests succeed.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From matt.wilkie at gov.yk.ca  Fri Jun 30 14:52:51 2006
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] inconsistent "worldfile=on" options
Message-ID: <44A57303.1070509@gov.yk.ca>

Hi All,

Is there a particular reason why gdal_translate support "-co 
worldfile=on" for jp2 jasper and jp2 mrsid but not jp2 ecw or kakadu?
Or why png uses "-co worldfile=yes" instead of "on"?
And the one I'm most curious about, why there isn't a global 
worldile=yes option for all formats?

thanks for your thoughts,

-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
http://environmentyukon.gov.yk.ca/geomatics/
--------------------------------------------


From tchaddad at gmail.com  Fri Jun 30 17:40:49 2006
From: tchaddad at gmail.com (TC Haddad)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] help with adding a projection definition
Message-ID: <25de2c7c0606301440j62104845kd02ea8c506953130@mail.gmail.com>

I'd like to use gdalwarp to reproject some large geotiffs, but
apparently my projection of choice EPSG:4495 is not recognized by
gdal.

On a previous machine I had to edit an old version of proj4 to take
this EPSG code, and was successful at that time. The parameters were
as follows:

# NAD83 / Oregon Lambert (Intl ft)
<4495> +proj=lcc +lat_1=43 +lat_2=45.5 +lat_0=41.75 +lon_0=-120.5
+x_0=400000.00000 +y_0=0 +ellps=GRS80 +datum=NAD83 +to_meter=0.3048
no_defs <>

I'd like to do the same again, but I can't figure out where gdal is
getting it's projection definitions from... what file name should I be
looking for?

My situation is FWtools 1.0.0b2 installed on WinXP sp2

thanks for any help,

Tanya

From mateusz at loskot.net  Fri Jun 30 05:15:12 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] FIXED - OGR can't handle Null values in a Date field
In-Reply-To: <1319fbba0606161402t240c8dd0u4f34c5e8148ef340@mail.gmail.com>
References: <1319fbba0606161402t240c8dd0u4f34c5e8148ef340@mail.gmail.com>
Message-ID: <44A4EBA0.7020400@loskot.net>

Aaron Koning wrote:
> Is there anyway of getting OGR to output Null values into a Date 
> field when there is a Null value present in the input Date field?

Hi,

Last days, I fixed this issue but due to my Internet connection was
broken, I could not commit it.
So, now I can and I've committed my changes to CVS.

Changes:
- Fixed Shape driver - NULL/0 date value was converted to string without
zero fill for year, e.g. 0/00/00 instead of 0000/00/00.

- Fixed NULL handling in PG driver - now, if date field stores year of
0000, the value is considered as NULL, because there is no ZERO year
(this follows PostgreSQL/MySQL dates handling behaviour, interesting
reference:
http://groups.google.pl/group/mailing.database.pgsql-sql/browse_frm/thread/1685953a3ebf48c1

So, I was able to import Aaron's shapefile to PostgreSQL 8.1.4.
Here are my commands:

ogr2ogr -f PostgreSQL PG:dbname=gdal_nulldate bugs/null_date/dates.shp

NOTE: I renamed Aaron's shapefile to dates.shp
Here is what I got in my gdal_nulldate database:

gdal_nulldate=# \dt
        List of relations
 Schema | Name  | Type  |  Owner
--------+-------+-------+---------
 public | dates | table | mloskot
(1 row)

gdal_nulldate=# \d dates
                                  Table "public.dates"
    Column    |     Type      |                        Modifiers
--------------+---------------+---------------------------------------------------------
 ogc_fid      | integer       | not null default
nextval('dates_ogc_fid_seq'::regclass)
 wkb_geometry | bytea         |
 dstrbedate   | date          |
 dstrbsdate   | date          |
 licenceid    | character(50) |
 permitid     | character(50) |
 blknmbr      | character(50) |
Indexes:
    "dates_pk" PRIMARY KEY, btree (ogc_fid)

gdal_nulldate=# select dstrbedate, dstrbsdate from dates;
 dstrbedate | dstrbsdate
------------+------------
 2001-02-07 | 2001-02-07
 2001-02-08 | 2001-02-08
 2002-02-01 | 2002-02-01
 2002-01-05 | 2002-01-05
 1999-01-06 | 1999-01-06
 1997-12-24 | 1997-12-24
 1999-03-03 | 1999-03-03
 2001-11-01 | 2001-11-01
 1998-12-21 | 1998-12-21
 1998-09-10 | 1998-09-10
 1998-02-04 | 1998-02-04
 2001-01-08 | 2001-01-08
            |
 1996-12-23 | 1996-12-23
 1992-11-13 | 1992-11-13
 1996-01-05 | 1996-01-05
            |
 1990-01-01 | 1990-01-01
(18 rows)

gdal_nulldate=#

NOTE: As you can see, two records store null dates, just as in the input
shapefile.

So, I assume this issue is fixed, but there are small things I'd like to
explain/learn (regarding OGR Shape driver and dates).
Please, see my comment marked with 'XXX - mloskot' in the
ogr/ogrsf_frmts/shape/shape2ogr.cpp file.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From schut at sarvision.nl  Fri Jun 30 05:49:37 2006
From: schut at sarvision.nl (Vincent Schut)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] ArcView binary raster support
Message-ID: <44A4F3B1.5010007@sarvision.nl>

Hi Frank, others,

We (SarVision BV, see www.sarvision.nl) regularly need to supply raster
data to clients who only (want to) work with ArcView. Alas, ArcView is
rather picky regarding raster import support, especially when concerning
the more unusual data types like float and signed int. We think that,
though ArcGis is available now which provides slightly better raster
support, a lot of our clients will continue to work with ArcView.
Therefore the following questions:

Would it be possible to add support to gdal for native ArcView raster
files, including other datatypes than simple ints, and (basic)
projection support?
If so, could you give an estimate of the costs to hire you to do this?

BTW I send this message to the list rather than directly to Frank
because maybe others are interested too and willing to share the cost :-)

Regards,
Vincent Schut.

From ari.jolma at tkk.fi  Fri Jun 30 05:45:34 2006
From: ari.jolma at tkk.fi (Ari Jolma)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] SWIG architecture
In-Reply-To: <8D27E2CDAF11D34F97E7445BCCCDB92CFEC05E@IMCSRV1.MITRE.ORG>
References: <8D27E2CDAF11D34F97E7445BCCCDB92CFEC05E@IMCSRV1.MITRE.ORG>
Message-ID: <44A4F2BE.7080907@tkk.fi>

I guess Hobu and Frank will have convincing arguments, I joined when the
design decisions were already made. The answer is probably in the web
pages: http://www.gdal.org/ogr/ "The C API is primarily intended to
provide a less fragile API since slight changes in the C++ API (such as
const correctness changes) can cause changes in method and class
signatures that prevent use of new DLLs with older clients. The C API is
also generally easy to call from other languages which allow call out to
DLLs functions, such as Visual Basic, or Delphi."

So it is both a development issue and an use issue.

I myself am writing yet another API with Perl on top of the Swig
modules: http://map.hut.fi/gdal-perl/Geo-GDAL.html

I see it also as a chance to write a new, clean, Perlish OO API. It will
be different from other language APIs, but that's inevitable I guess.

Are there any specific methods that you are missing? For example I just
added SetCoordinateDimension method to OGRGeometryShadow.

Ari

Collins, Benjamin kirjoitti:
> To the SWIG folks,
> 
> We were interested in using more OGR features to handle vector formats
> from the SWIG'ed Java wrappers.  However, the currently exposed
> interfaces do not include the necessary functions to get information
> about polygons, etc; especially not in the natural way that such
> information is available in the C++ API.
> I thought I would see that would result from a more hands-off approach
> to the SWIG *.i files.  I created a new ogr.i file with the
> ogrsf_frmts.h file '%include'd along with some of the other main files.
> (Later I had to modify this a little, but not in any important way.)  I
> SWIG'ed this and got a full featured, more object oriented Java
> interface than before.  I am able to essentially use the C++ API with a
> straigt "transliteration."  Some language-specific typemaps could still
> help, but this is not the essence of the experiment.
> 
> So my question is this:  why does the SWIG wrapper wrap the C-stlye
> API.  Why not just go for the C++, get all the OO for free (esp w/
> OGRGeometry)?
> Also, why the use of *Shadow, etc?
> 
> I fully realize that there may be some caveat of SWIG keeping us from
> this approach.
> 
> Thanks,
> --
> Ben Collins
> 
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev


-- 
Prof. Ari Jolma
Kartografia ja Geoinformatiikka / Cartography and Geoinformatics
Teknillinen Korkeakoulu / Helsinki University of Technology
tel: +358 9 451 3886 address: POBox 1200, 02015 TKK, Finland
Email: ari.jolma at tkk.fi URL: http://www.tkk.fi/~jolma

