From lists at home.gofferje.net  Thu Aug  1 00:35:56 2024
From: lists at home.gofferje.net (Stefan Gofferje)
Date: Thu, 1 Aug 2024 07:35:56 +0000
Subject: [gdal-dev] Python-GDAL - How do I create a GeoTIFF from this
 array?
In-Reply-To: <0107019102e11de9-fc989f77-4e56-433e-a182-a0f9670aaacf-000000@eu-central-1.amazonses.com>
References: <0107019102e11de9-fc989f77-4e56-433e-a182-a0f9670aaacf-000000@eu-central-1.amazonses.com>
Message-ID: <010701910cdded07-2db59650-6f7f-49e3-a311-e1367f6a2fc3-000000@eu-central-1.amazonses.com>

So, thanks to the replies here I found this article which describes how 
to create a GeoTiff from scratch for Dummies.

https://manivannank.medium.com/gdal-python-create-save-geotiff-using-gdal-in-python-469c2e33cb14

Sometimes one only needs to be told the right words to search for :)

Thanks guys!
-Stefan

-- 
  (o_   Stefan Gofferje            | SCLT, MCP, CCSA
  //\   Reg'd Linux User #247167   | VCP #2263
  V_/_  https://www.gofferje.net   | https://www.saakeskus.fi


From j1 at jimenezshaw.com  Thu Aug  1 01:11:08 2024
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Thu, 1 Aug 2024 10:11:08 +0200
Subject: [gdal-dev] Python-GDAL - How do I create a GeoTIFF from this
 array?
In-Reply-To: <010701910cdded07-2db59650-6f7f-49e3-a311-e1367f6a2fc3-000000@eu-central-1.amazonses.com>
References: <0107019102e11de9-fc989f77-4e56-433e-a182-a0f9670aaacf-000000@eu-central-1.amazonses.com>
 <010701910cdded07-2db59650-6f7f-49e3-a311-e1367f6a2fc3-000000@eu-central-1.amazonses.com>
Message-ID: <CADRrdKt4BnraXEfZG_ov2b5rx0c-8=V8YvNBSy-OnHKzkQbHFw@mail.gmail.com>

IIRC the x,y for SetGeoTransform are for the top left corner of the top
left pixel. Not the center of the pixel. It can be confusing.
(that means that it does not change with the pixelsize if you downscale or
upscale ;)

On Thu, 1 Aug 2024 at 09:35, Stefan Gofferje via gdal-dev <
gdal-dev at lists.osgeo.org> wrote:

> So, thanks to the replies here I found this article which describes how
> to create a GeoTiff from scratch for Dummies.
>
>
> https://manivannank.medium.com/gdal-python-create-save-geotiff-using-gdal-in-python-469c2e33cb14
>
> Sometimes one only needs to be told the right words to search for :)
>
> Thanks guys!
> -Stefan
>
> --
>   (o_   Stefan Gofferje            | SCLT, MCP, CCSA
>   //\   Reg'd Linux User #247167   | VCP #2263
>   V_/_  https://www.gofferje.net   | https://www.saakeskus.fi
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240801/a5acbf41/attachment.htm>

From lists at home.gofferje.net  Thu Aug  1 22:00:07 2024
From: lists at home.gofferje.net (Stefan Gofferje)
Date: Fri, 2 Aug 2024 05:00:07 +0000
Subject: [gdal-dev] Python-GDAL - How do I create a GeoTIFF from this
 array?
In-Reply-To: <CADRrdKt4BnraXEfZG_ov2b5rx0c-8=V8YvNBSy-OnHKzkQbHFw@mail.gmail.com>
References: <0107019102e11de9-fc989f77-4e56-433e-a182-a0f9670aaacf-000000@eu-central-1.amazonses.com>
 <010701910cdded07-2db59650-6f7f-49e3-a311-e1367f6a2fc3-000000@eu-central-1.amazonses.com>
 <CADRrdKt4BnraXEfZG_ov2b5rx0c-8=V8YvNBSy-OnHKzkQbHFw@mail.gmail.com>
Message-ID: <010701911175a2ae-5856fbc1-27a4-4586-bbd2-e87e1e9f2b35-000000@eu-central-1.amazonses.com>

On 8/1/24 11:11, Javier Jimenez Shaw wrote:
> IIRC the x,y for SetGeoTransform are for the top left corner of the top 
> left pixel. Not the center of the pixel. It can be confusing.
> (that means that it does not change with the pixelsize if you downscale 
> or upscale ;)

Oh, yeah, that would have caused some confusion because the data starts 
with the lower left corner...

-- 
  (o_   Stefan Gofferje            | SCLT, MCP, CCSA
  //\   Reg'd Linux User #247167   | VCP #2263
  V_/_  https://www.gofferje.net   | https://www.saakeskus.fi


From j1 at jimenezshaw.com  Fri Aug  2 04:39:33 2024
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Fri, 2 Aug 2024 13:39:33 +0200
Subject: [gdal-dev] Python-GDAL - How do I create a GeoTIFF from this
 array?
In-Reply-To: <010701911175a2ae-5856fbc1-27a4-4586-bbd2-e87e1e9f2b35-000000@eu-central-1.amazonses.com>
References: <0107019102e11de9-fc989f77-4e56-433e-a182-a0f9670aaacf-000000@eu-central-1.amazonses.com>
 <010701910cdded07-2db59650-6f7f-49e3-a311-e1367f6a2fc3-000000@eu-central-1.amazonses.com>
 <CADRrdKt4BnraXEfZG_ov2b5rx0c-8=V8YvNBSy-OnHKzkQbHFw@mail.gmail.com>
 <010701911175a2ae-5856fbc1-27a4-4586-bbd2-e87e1e9f2b35-000000@eu-central-1.amazonses.com>
Message-ID: <CADRrdKu0qM_bsQEkHwmpvvUd+s1A2hO-djwBwKM0ssL-crkqTw@mail.gmail.com>

Oh, that is one step further.

There are two things:
 - the difference between center of the pixel and corner of the pixel (that
I was "reporting" in my previous email)
 - row from top down or bottom up.

Tiffs usually have the rows ordered top down. Technically can be also
bottom up, but it may be a problem with some software. It is a strange
thing. Avoid that.
In the top-down mode (that is the usual one), in the geotransform the pixel
size in the Y direction is negative, because the Y direction in the image
goes in the oposite direction as the CRS.

On Fri, 2 Aug 2024 at 07:00, Stefan Gofferje <lists at home.gofferje.net>
wrote:

> On 8/1/24 11:11, Javier Jimenez Shaw wrote:
> > IIRC the x,y for SetGeoTransform are for the top left corner of the top
> > left pixel. Not the center of the pixel. It can be confusing.
> > (that means that it does not change with the pixelsize if you downscale
> > or upscale ;)
>
> Oh, yeah, that would have caused some confusion because the data starts
> with the lower left corner...
>
> --
>   (o_   Stefan Gofferje            | SCLT, MCP, CCSA
>   //\   Reg'd Linux User #247167   | VCP #2263
>   V_/_  https://www.gofferje.net   | https://www.saakeskus.fi
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240802/eb32962a/attachment.htm>

From jukka.rahkonen at maanmittauslaitos.fi  Sun Aug  4 11:31:51 2024
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Sun, 4 Aug 2024 18:31:51 +0000
Subject: [gdal-dev] Motion: Migrate gdal.org to ReadTheDocs
In-Reply-To: <AC15F350-EE08-4A83-9C02-F1DA34825967@hobu.co>
References: <AC15F350-EE08-4A83-9C02-F1DA34825967@hobu.co>
Message-ID: <DB9PR09MB68879414979788C1FAE1C47FFDBD2@DB9PR09MB6887.eurprd09.prod.outlook.com>

+1

-Jukka Rahkonen-

-----Alkuper?inen viesti-----
L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Howard Butler via gdal-dev
L?hetetty: torstai 25. hein?kuuta 2024 18.02
Vastaanottaja: gdal dev <gdal-dev at lists.osgeo.org>
Aihe: [gdal-dev] Motion: Migrate gdal.org to ReadTheDocs

All,

I would like to motion to migrate gdal.org 
...
from our self-managed GitHub Pages infrastructure to ReadTheDocs. You can read specific details about the migration in the ticket at
... 
/me starts with +1

Howard 
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org

From m.zdila at gmail.com  Sun Aug  4 22:52:17 2024
From: m.zdila at gmail.com (=?UTF-8?Q?Martin_=C5=BDdila?=)
Date: Mon, 5 Aug 2024 07:52:17 +0200
Subject: [gdal-dev] Re-creating mask with nearblack
Message-ID: <CAL520RmJKG4h=W7g0zKUJogWHbKAAq3LeQUDvZ=XkrzZJvE75Q@mail.gmail.com>

Hello,

I attempted to create a mask with nearblack -alg floodfill -setmask -nb 0
-white file.tif but near 90% it failed because of full disk space.

Will re-generating new mask remove (or overwrite) the old one? I wouldn't
like my geotiff to contain unused data unfinished mask.

If not, is there a way to get rid of it? I use JPEG compression so I don't
want to create a new geotiff from it by recompresing because it AFAIK would
reduce the image quality.

Thanks in advance
--
Martin ?dila
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240805/2010b8d2/attachment.htm>

From sibylle.stoeckli at gmx.ch  Tue Aug  6 01:48:35 2024
From: sibylle.stoeckli at gmx.ch (sibylle.stoeckli at gmx.ch)
Date: Tue, 6 Aug 2024 10:48:35 +0200
Subject: [gdal-dev] GDAL installation write permissions
Message-ID: <00c301dae7dd$6cc6d690$465483b0$@gmx.ch>

Dear community

 

I tried to install GDAL.

(base) C:\Users\Sibylle St?ckli>conda install -c conda-forge gdal

 

However I got the following error

Downloading and Extracting Packages:

 

Preparing transaction: done

Verifying transaction: failed

 

EnvironmentNotWritableError: The current user does not have write
permissions to the target environment.

  environment location: C:\ProgramData\miniconda3

 

Kind regards

Sibylle

 

Full code

 

(base) C:\Users\Sibylle St?ckli>conda install -c conda-forge gdal

Channels:

- conda-forge

- defaults

Platform: win-64

Collecting package metadata (repodata.json): done

Solving environment: done

 

## Package Plan ##

 

  environment location: C:\ProgramData\miniconda3

 

  added / updated specs:

    - gdal

 

 

The following NEW packages will be INSTALLED:

 

  blosc              conda-forge/win-64::blosc-1.21.6-h85f69ea_0

  freexl             conda-forge/win-64::freexl-2.0.0-h8276f4a_0

  gdal               conda-forge/win-64::gdal-3.9.1-py312h16ac12d_11

  geos               conda-forge/win-64::geos-3.12.2-h5a68840_1

  geotiff            conda-forge/win-64::geotiff-1.7.3-h232476a_2

  intel-openmp       conda-forge/win-64::intel-openmp-2024.2.0-h57928b3_980

  krb5               conda-forge/win-64::krb5-1.21.3-hdf4eb48_0

  lerc               conda-forge/win-64::lerc-4.0.0-h63175ca_0

  libblas            conda-forge/win-64::libblas-3.9.0-23_win64_mkl

  libcblas           conda-forge/win-64::libcblas-3.9.0-23_win64_mkl

  libdeflate         conda-forge/win-64::libdeflate-1.21-h2466b09_0

  libexpat           conda-forge/win-64::libexpat-2.6.2-h63175ca_0

  libgdal-core       conda-forge/win-64::libgdal-core-3.9.1-h6b59ad6_11

  libhwloc
conda-forge/win-64::libhwloc-2.11.1-default_h8125262_1000

  libjpeg-turbo      conda-forge/win-64::libjpeg-turbo-3.0.0-hcfcfb64_1

  libkml             conda-forge/win-64::libkml-1.3.0-h538826c_1020

  liblapack          conda-forge/win-64::liblapack-3.9.0-23_win64_mkl

  libpng             conda-forge/win-64::libpng-1.6.43-h19919ed_0

  librttopo          conda-forge/win-64::librttopo-1.1.0-h6c42fcb_16

  libspatialite      conda-forge/win-64::libspatialite-5.1.0-hab0cb6d_9

  libsqlite          conda-forge/win-64::libsqlite-3.46.0-h2466b09_0

  libtiff            conda-forge/win-64::libtiff-4.6.0-hb151862_4

  libwebp-base       conda-forge/win-64::libwebp-base-1.4.0-hcfcfb64_0

  libzlib            conda-forge/win-64::libzlib-1.3.1-h2466b09_1

  lzo                conda-forge/win-64::lzo-2.10-hcfcfb64_1001

  minizip            conda-forge/win-64::minizip-4.0.6-hb638d1e_0

  mkl                conda-forge/win-64::mkl-2024.1.0-h66d3029_694

  numpy              conda-forge/win-64::numpy-2.0.1-py312h49bc9c5_0

  proj               conda-forge/win-64::proj-9.4.1-hd9569ee_1

  pthreads-win32     conda-forge/win-64::pthreads-win32-2.9.1-hfa6e2cd_3

  python_abi         conda-forge/win-64::python_abi-3.12-4_cp312

  snappy             conda-forge/win-64::snappy-1.2.1-h23299a8_0

  tbb                conda-forge/win-64::tbb-2021.12.0-hc790b64_3

  ucrt               conda-forge/win-64::ucrt-10.0.22621.0-h57928b3_0

  uriparser          conda-forge/win-64::uriparser-0.9.8-h5a68840_0

  vc14_runtime
conda-forge/win-64::vc14_runtime-14.40.33810-ha82c5b3_20

  xerces-c           conda-forge/win-64::xerces-c-3.2.5-he0c23c2_1

 

The following packages will be UPDATED:

 

  ca-certificates    pkgs/main::ca-certificates-2024.3.11-~ -->
conda-forge::ca-certificates-2024.7.4-h56e8100_0

  certifi            pkgs/main/win-64::certifi-2024.6.2-py~ -->
conda-forge/noarch::certifi-2024.7.4-pyhd8ed1ab_0

  conda              pkgs/main::conda-24.5.0-py312haa95532~ -->
conda-forge::conda-24.7.1-py312h2e8e312_0

  fmt                       pkgs/main::fmt-9.1.0-h6d14046_1 -->
conda-forge::fmt-10.2.1-h181d51b_0

  libarchive         pkgs/main::libarchive-3.6.2-hb62f4d4_3 -->
conda-forge::libarchive-3.7.4-haf234dc_0

  libcurl               pkgs/main::libcurl-8.7.1-h86230a5_0 -->
conda-forge::libcurl-8.9.1-h18fefc2_0

  libiconv              pkgs/main::libiconv-1.16-h2bbff1b_3 -->
conda-forge::libiconv-1.17-hcfcfb64_2

  libsolv              pkgs/main::libsolv-0.7.24-h23ce68f_1 -->
conda-forge::libsolv-0.7.30-hbb528cf_0

  libxml2              pkgs/main::libxml2-2.10.4-h0ad7f3c_2 -->
conda-forge::libxml2-2.12.7-h0f24e4e_4

  openssl              pkgs/main::openssl-3.0.14-h827c3e9_0 -->
conda-forge::openssl-3.3.1-h2466b09_2

  pcre2                   pkgs/main::pcre2-10.42-h0ff8eda_1 -->
conda-forge::pcre2-10.44-h3d7b363_0

  vs2015_runtime     pkgs/main::vs2015_runtime-14.29.30133~ -->
conda-forge::vs2015_runtime-14.40.33810-h3bf8584_20

  zlib                    pkgs/main::zlib-1.2.13-h8cc25b3_1 -->
conda-forge::zlib-1.3.1-h2466b09_1

  zstandard          pkgs/main::zstandard-0.22.0-py312h346~ -->
conda-forge::zstandard-0.23.0-py312h7606c53_0

  zstd                     pkgs/main::zstd-1.5.5-hd43e919_2 -->
conda-forge::zstd-1.5.6-h0ea2cb4_0

 

The following packages will be SUPERSEDED by a higher-priority channel:

 

  libmamba             pkgs/main::libmamba-1.5.8-h99b1521_2 -->
conda-forge::libmamba-1.5.8-h3f09ed1_0

  libmambapy         pkgs/main::libmambapy-1.5.8-py312h77c~ -->
conda-forge::libmambapy-1.5.8-py312h66cf91f_0

  libssh2              pkgs/main::libssh2-1.11.0-h291bd65_0 -->
conda-forge::libssh2-1.11.0-h7dfc565_0

  pybind11-abi         pkgs/main::pybind11-abi-5-hd3eb1b0_0 -->
conda-forge::pybind11-abi-4-hd8ed1ab_3

  python                pkgs/main::python-3.12.4-h14ffc60_1 -->
conda-forge::python-3.12.4-h889d299_0_cpython

  tk                        pkgs/main::tk-8.6.14-h0416ee5_0 -->
conda-forge::tk-8.6.13-h5226925_1

 

 

Proceed ([y]/n)? y

 

 

Downloading and Extracting Packages:

 

Preparing transaction: done

Verifying transaction: failed

 

EnvironmentNotWritableError: The current user does not have write
permissions to the target environment.

  environment location: C:\ProgramData\miniconda3

 

 

 

(base) C:\Users\Sibylle St?ckli>

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240806/2b082140/attachment.htm>

From sean.gillies at gmail.com  Tue Aug  6 08:20:07 2024
From: sean.gillies at gmail.com (Sean Gillies)
Date: Tue, 6 Aug 2024 09:20:07 -0600
Subject: [gdal-dev] GDAL installation write permissions
In-Reply-To: <00c301dae7dd$6cc6d690$465483b0$@gmx.ch>
References: <00c301dae7dd$6cc6d690$465483b0$@gmx.ch>
Message-ID: <CAOodmJqaby=tH+h_scrkE3LLNgLqG0GeGkr6gmQHhHFWQrU5kw@mail.gmail.com>

Hi Sibylle,

It looks to me that you need to specify an environment location within your
own user directory. The page at
https://conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html#specifying-a-location-for-an-environment
has instructions on this.

Yours,


On Tue, Aug 6, 2024, 3:30?AM Sibylle St?ckli via gdal-dev <
gdal-dev at lists.osgeo.org> wrote:

> Dear community
>
>
>
> I tried to install GDAL.
>
> *(base) C:\Users\Sibylle St?ckli>conda install -c conda-forge gdal*
>
>
>
> However I got the following error
>
> *Downloading and Extracting Packages:*
>
>
>
> *Preparing transaction: done*
>
> *Verifying transaction: failed*
>
>
>
> *EnvironmentNotWritableError: The current user does not have write
> permissions to the target environment.*
>
> *  environment location: C:\ProgramData\miniconda3*
>
>
>
> Kind regards
>
> Sibylle
>
>
>
> Full code
>
>
>
> *(base) C:\Users\Sibylle St?ckli>conda install -c conda-forge gdal*
>
> *Channels:*
>
> * - conda-forge*
>
> * - defaults*
>
> *Platform: win-64*
>
> *Collecting package metadata (repodata.json): done*
>
> *Solving environment: done*
>
>
>
> *## Package Plan ##*
>
>
>
> *  environment location: C:\ProgramData\miniconda3*
>
>
>
> *  added / updated specs:*
>
> *    - gdal*
>
>
>
>
>
> *The following NEW packages will be INSTALLED:*
>
>
>
> *  blosc              conda-forge/win-64::blosc-1.21.6-h85f69ea_0*
>
> *  freexl             conda-forge/win-64::freexl-2.0.0-h8276f4a_0*
>
> *  gdal               conda-forge/win-64::gdal-3.9.1-py312h16ac12d_11*
>
> *  geos               conda-forge/win-64::geos-3.12.2-h5a68840_1*
>
> *  geotiff            conda-forge/win-64::geotiff-1.7.3-h232476a_2*
>
> *  intel-openmp
> conda-forge/win-64::intel-openmp-2024.2.0-h57928b3_980*
>
> *  krb5               conda-forge/win-64::krb5-1.21.3-hdf4eb48_0*
>
> *  lerc               conda-forge/win-64::lerc-4.0.0-h63175ca_0*
>
> *  libblas            conda-forge/win-64::libblas-3.9.0-23_win64_mkl*
>
> *  libcblas           conda-forge/win-64::libcblas-3.9.0-23_win64_mkl*
>
> *  libdeflate         conda-forge/win-64::libdeflate-1.21-h2466b09_0*
>
> *  libexpat           conda-forge/win-64::libexpat-2.6.2-h63175ca_0*
>
> *  libgdal-core       conda-forge/win-64::libgdal-core-3.9.1-h6b59ad6_11*
>
> *  libhwloc
> conda-forge/win-64::libhwloc-2.11.1-default_h8125262_1000*
>
> *  libjpeg-turbo      conda-forge/win-64::libjpeg-turbo-3.0.0-hcfcfb64_1*
>
> *  libkml             conda-forge/win-64::libkml-1.3.0-h538826c_1020*
>
> *  liblapack          conda-forge/win-64::liblapack-3.9.0-23_win64_mkl*
>
> *  libpng             conda-forge/win-64::libpng-1.6.43-h19919ed_0*
>
> *  librttopo          conda-forge/win-64::librttopo-1.1.0-h6c42fcb_16*
>
> *  libspatialite      conda-forge/win-64::libspatialite-5.1.0-hab0cb6d_9*
>
> *  libsqlite          conda-forge/win-64::libsqlite-3.46.0-h2466b09_0*
>
> *  libtiff            conda-forge/win-64::libtiff-4.6.0-hb151862_4*
>
> *  libwebp-base       conda-forge/win-64::libwebp-base-1.4.0-hcfcfb64_0*
>
> *  libzlib            conda-forge/win-64::libzlib-1.3.1-h2466b09_1*
>
> *  lzo                conda-forge/win-64::lzo-2.10-hcfcfb64_1001*
>
> *  minizip            conda-forge/win-64::minizip-4.0.6-hb638d1e_0*
>
> *  mkl                conda-forge/win-64::mkl-2024.1.0-h66d3029_694*
>
> *  numpy              conda-forge/win-64::numpy-2.0.1-py312h49bc9c5_0*
>
> *  proj               conda-forge/win-64::proj-9.4.1-hd9569ee_1*
>
> *  pthreads-win32     conda-forge/win-64::pthreads-win32-2.9.1-hfa6e2cd_3*
>
> *  python_abi         conda-forge/win-64::python_abi-3.12-4_cp312*
>
> *  snappy             conda-forge/win-64::snappy-1.2.1-h23299a8_0*
>
> *  tbb                conda-forge/win-64::tbb-2021.12.0-hc790b64_3*
>
> *  ucrt               conda-forge/win-64::ucrt-10.0.22621.0-h57928b3_0*
>
> *  uriparser          conda-forge/win-64::uriparser-0.9.8-h5a68840_0*
>
> *  vc14_runtime
> conda-forge/win-64::vc14_runtime-14.40.33810-ha82c5b3_20*
>
> *  xerces-c           conda-forge/win-64::xerces-c-3.2.5-he0c23c2_1*
>
>
>
> *The following packages will be UPDATED:*
>
>
>
> *  ca-certificates    pkgs/main::ca-certificates-2024.3.11-~ -->
> conda-forge::ca-certificates-2024.7.4-h56e8100_0*
>
> *  certifi            pkgs/main/win-64::certifi-2024.6.2-py~ -->
> conda-forge/noarch::certifi-2024.7.4-pyhd8ed1ab_0*
>
> *  conda              pkgs/main::conda-24.5.0-py312haa95532~ -->
> conda-forge::conda-24.7.1-py312h2e8e312_0*
>
> *  fmt                       pkgs/main::fmt-9.1.0-h6d14046_1 -->
> conda-forge::fmt-10.2.1-h181d51b_0*
>
> *  libarchive         pkgs/main::libarchive-3.6.2-hb62f4d4_3 -->
> conda-forge::libarchive-3.7.4-haf234dc_0*
>
> *  libcurl               pkgs/main::libcurl-8.7.1-h86230a5_0 -->
> conda-forge::libcurl-8.9.1-h18fefc2_0*
>
> *  libiconv              pkgs/main::libiconv-1.16-h2bbff1b_3 -->
> conda-forge::libiconv-1.17-hcfcfb64_2*
>
> *  libsolv              pkgs/main::libsolv-0.7.24-h23ce68f_1 -->
> conda-forge::libsolv-0.7.30-hbb528cf_0*
>
> *  libxml2              pkgs/main::libxml2-2.10.4-h0ad7f3c_2 -->
> conda-forge::libxml2-2.12.7-h0f24e4e_4*
>
> *  openssl              pkgs/main::openssl-3.0.14-h827c3e9_0 -->
> conda-forge::openssl-3.3.1-h2466b09_2*
>
> *  pcre2                   pkgs/main::pcre2-10.42-h0ff8eda_1 -->
> conda-forge::pcre2-10.44-h3d7b363_0*
>
> *  vs2015_runtime     pkgs/main::vs2015_runtime-14.29.30133~ -->
> conda-forge::vs2015_runtime-14.40.33810-h3bf8584_20*
>
> *  zlib                    pkgs/main::zlib-1.2.13-h8cc25b3_1 -->
> conda-forge::zlib-1.3.1-h2466b09_1*
>
> *  zstandard          pkgs/main::zstandard-0.22.0-py312h346~ -->
> conda-forge::zstandard-0.23.0-py312h7606c53_0*
>
> *  zstd                     pkgs/main::zstd-1.5.5-hd43e919_2 -->
> conda-forge::zstd-1.5.6-h0ea2cb4_0*
>
>
>
> *The following packages will be SUPERSEDED by a higher-priority channel:*
>
>
>
> *  libmamba             pkgs/main::libmamba-1.5.8-h99b1521_2 -->
> conda-forge::libmamba-1.5.8-h3f09ed1_0*
>
> *  libmambapy         pkgs/main::libmambapy-1.5.8-py312h77c~ -->
> conda-forge::libmambapy-1.5.8-py312h66cf91f_0*
>
> *  libssh2              pkgs/main::libssh2-1.11.0-h291bd65_0 -->
> conda-forge::libssh2-1.11.0-h7dfc565_0*
>
> *  pybind11-abi         pkgs/main::pybind11-abi-5-hd3eb1b0_0 -->
> conda-forge::pybind11-abi-4-hd8ed1ab_3*
>
> *  python                pkgs/main::python-3.12.4-h14ffc60_1 -->
> conda-forge::python-3.12.4-h889d299_0_cpython*
>
> *  tk                        pkgs/main::tk-8.6.14-h0416ee5_0 -->
> conda-forge::tk-8.6.13-h5226925_1*
>
>
>
>
>
> *Proceed ([y]/n)? y*
>
>
>
>
>
> *Downloading and Extracting Packages:*
>
>
>
> *Preparing transaction: done*
>
> *Verifying transaction: failed*
>
>
>
> *EnvironmentNotWritableError: The current user does not have write
> permissions to the target environment.*
>
>   *environment location: C:\ProgramData\miniconda3*
>
>
>
>
>
>
>
> *(base) C:\Users\Sibylle St?ckli>*
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240806/f3f268bb/attachment-0001.htm>

From even.rouault at spatialys.com  Sun Aug 11 06:10:32 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 11 Aug 2024 15:10:32 +0200
Subject: [gdal-dev] shapelib 1.6.1RC1 available
Message-ID: <20cdccee-9e0f-465b-9846-437a993d50bd@spatialys.com>

Hi,

Here's a shapelib v1.6.1 release candidate:
- https://download.osgeo.org/shapelib/shapelib-1.6.1rc1.tar.gz
- https://download.osgeo.org/shapelib/shapelib-1.6.1rc1.zip


Changes since v1.6.0:
- DBFIsValueNULL(): accept empty string as NULL Date 
(https://github.com/OSGeo/gdal/issues/10405)
- DBFIsValueNULL(): Accept string containing of width times "0" as NULL Date
- Only test for _WIN32 for Windows detection
- Windows: Fix UTF8 hook functions
- Various compiler warning fixes
- contrib/csv2shp.c: fix resource leaks (#86)
- Detect byte order at compile time
- shapefil.h: various const-correctness improvements
- shapefil.h: Remove SHPTreeRemoveShapeId not being implemented
- shapefil.h: Fix API call of SHPSearchDiskTreeEx
- Add API functions for read/write of date attributes: 
DBFReadDateAttribute/DBFWriteDateAttribute
- DBFWriteAttribute/DBFWriteLogicalAttribute: no longer silently accpets 
invalid input, but returns false
- DBFCloneEmpty: consider the SAHooks
- Move endian defines to shapefil_private.h (#99)
- Fix test execution by complete refactoring.
- Add C++ unit testing (#113)
- SBNOpenDiskTree(): make it work with node descriptors with 
non-increasing nBinStart
 ? Fixes https://github.com/OSGeo/shapelib/issues/106 / 
https://github.com/OSGeo/gdal/issues/9430
- sbnsearch.c: avoid potential integer overflows on corrupted files
- dbfdump: dump date and logical fields
- dbfinfo: print date and logical fields
- dbfcat: various fixes
- Fix -Werror=calloc-transposed-args with gcc 14
- SHPOpenLL(): avoid GDAL specific error message when .shx is missing (#129)
- CMake: generate pkg-config file (#135)
- CMake: Fix install interface include dir (#134)
- CMake: Make building executables optional with CMake (set BUILD_APPS 
to OFF) (#78)
- CMake: Remove duplicated shapefil.h installation in 
include_dir/shapelib (#80)
- CMake: Remove INSTALL_NAME_DIR from target (#49)
- CMake: Fix contrib.cmake

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From even.rouault at spatialys.com  Sun Aug 11 10:00:52 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 11 Aug 2024 19:00:52 +0200
Subject: [gdal-dev] GDAL 3.9.2 release candidate available
Message-ID: <3aa4a9a8-eff8-45e5-a46e-3a5075c2c8a4@spatialys.com>

Hi,

I have prepared a GDAL/OGR 3.9.2 release candidate.

Pick up an archive among the following ones (by ascending size):

 ? https://download.osgeo.org/gdal/3.9.2/gdal-3.9.2rc1.tar.xz
 ? https://download.osgeo.org/gdal/3.9.2/gdal-3.9.2rc1.tar.gz
 ? https://download.osgeo.org/gdal/3.9.2/gdal392rc1.zip

A snapshot of the gdalautotest suite is also available:

https://download.osgeo.org/gdal/3.9.2/gdalautotest-3.9.2rc1.tar.gz
 ? https://download.osgeo.org/gdal/3.9.2/gdalautotest-3.9.2rc1.zip

The NEWS file is here:

 ? https://github.com/OSGeo/gdal/blob/v3.9.2RC1/NEWS.md

Best regards,

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From public at postholer.com  Sun Aug 11 17:19:09 2024
From: public at postholer.com (Scott)
Date: Sun, 11 Aug 2024 17:19:09 -0700
Subject: [gdal-dev] GDAL 3.9.2 release candidate available
In-Reply-To: <3aa4a9a8-eff8-45e5-a46e-3a5075c2c8a4@spatialys.com>
References: <3aa4a9a8-eff8-45e5-a46e-3a5075c2c8a4@spatialys.com>
Message-ID: <a0b099c6-2331-4efa-9f8a-3042fdd4858b@postholer.com>

Looking at the news file, specifically about gdallocationinfo:

gdallocationinfo: avoid extra newline character in -valonly mode if 
coordinate is outside raster extent (3.9.0 regression)

Having that new-line character is imperative. For instance, say I have a 
file called coords.txt with the values:

-122.999312 37.341868
-122.999089 27.573119
-122.998763 18.92525
-122.998927 32.975703

Then I run the command:
gdallocationinfo -geoloc -valonly raster.tif < coords.txt > results.txt

...with results.txt:
0
767

327

The 3rd coordinate is outside the raster extent, it's empty or null. I 
will still get 4 results, which is very important. If I now try to 
append results.txt to coords.txt, I get a 1 to 1 relationship:

paste -d " " coords1.txt results.txt |tr " " ","
-122.999312,37.341868,0
-122.999089,27.573119,767
-122.998763,18.92525,
-122.998927,32.975703,327

The problem is, if that newline is removed, results.txt will have 1 less 
line than coords.txt. This is bad.

Thanks for listening!


On 8/11/24 10:00, Even Rouault via gdal-dev wrote:
> Hi,
> 
> I have prepared a GDAL/OGR 3.9.2 release candidate.
> 
> Pick up an archive among the following ones (by ascending size):
> 
>  ? https://download.osgeo.org/gdal/3.9.2/gdal-3.9.2rc1.tar.xz
>  ? https://download.osgeo.org/gdal/3.9.2/gdal-3.9.2rc1.tar.gz
>  ? https://download.osgeo.org/gdal/3.9.2/gdal392rc1.zip
> 
> A snapshot of the gdalautotest suite is also available:
> 
> https://download.osgeo.org/gdal/3.9.2/gdalautotest-3.9.2rc1.tar.gz
>  ? https://download.osgeo.org/gdal/3.9.2/gdalautotest-3.9.2rc1.zip
> 
> The NEWS file is here:
> 
>  ? https://github.com/OSGeo/gdal/blob/v3.9.2RC1/NEWS.md
> 
> Best regards,
> 
> Even
> 

From public at postholer.com  Sun Aug 11 18:07:32 2024
From: public at postholer.com (Scott)
Date: Sun, 11 Aug 2024 18:07:32 -0700
Subject: [gdal-dev] GDAL 3.9.2 release candidate available
In-Reply-To: <a0b099c6-2331-4efa-9f8a-3042fdd4858b@postholer.com>
References: <3aa4a9a8-eff8-45e5-a46e-3a5075c2c8a4@spatialys.com>
 <a0b099c6-2331-4efa-9f8a-3042fdd4858b@postholer.com>
Message-ID: <666908a5-8608-4655-839e-9b0fe7c3f365@postholer.com>

Ideally, it would be real nice to have an option that returns the coord 
and value on a single line.

On 8/11/24 17:19, Scott via gdal-dev wrote:
> Looking at the news file, specifically about gdallocationinfo:
> 
> gdallocationinfo: avoid extra newline character in -valonly mode if 
> coordinate is outside raster extent (3.9.0 regression)
> 
> Having that new-line character is imperative. For instance, say I have a 
> file called coords.txt with the values:
> 
> -122.999312 37.341868
> -122.999089 27.573119
> -122.998763 18.92525
> -122.998927 32.975703
> 
> Then I run the command:
> gdallocationinfo -geoloc -valonly raster.tif < coords.txt > results.txt
> 
> ...with results.txt:
> 0
> 767
> 
> 327
> 
> The 3rd coordinate is outside the raster extent, it's empty or null. I 
> will still get 4 results, which is very important. If I now try to 
> append results.txt to coords.txt, I get a 1 to 1 relationship:
> 
> paste -d " " coords1.txt results.txt |tr " " ","
> -122.999312,37.341868,0
> -122.999089,27.573119,767
> -122.998763,18.92525,
> -122.998927,32.975703,327
> 
> The problem is, if that newline is removed, results.txt will have 1 less 
> line than coords.txt. This is bad.
> 
> Thanks for listening!
> 
> 
> On 8/11/24 10:00, Even Rouault via gdal-dev wrote:
>> Hi,
>>
>> I have prepared a GDAL/OGR 3.9.2 release candidate.
>>
>> Pick up an archive among the following ones (by ascending size):
>>
>> ?? https://download.osgeo.org/gdal/3.9.2/gdal-3.9.2rc1.tar.xz
>> ?? https://download.osgeo.org/gdal/3.9.2/gdal-3.9.2rc1.tar.gz
>> ?? https://download.osgeo.org/gdal/3.9.2/gdal392rc1.zip
>>
>> A snapshot of the gdalautotest suite is also available:
>>
>> https://download.osgeo.org/gdal/3.9.2/gdalautotest-3.9.2rc1.tar.gz
>> ?? https://download.osgeo.org/gdal/3.9.2/gdalautotest-3.9.2rc1.zip
>>
>> The NEWS file is here:
>>
>> ?? https://github.com/OSGeo/gdal/blob/v3.9.2RC1/NEWS.md
>>
>> Best regards,
>>
>> Even
>>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at spatialys.com  Mon Aug 12 01:01:48 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 12 Aug 2024 10:01:48 +0200
Subject: [gdal-dev] GDAL 3.9.2 release candidate available
In-Reply-To: <a0b099c6-2331-4efa-9f8a-3042fdd4858b@postholer.com>
References: <3aa4a9a8-eff8-45e5-a46e-3a5075c2c8a4@spatialys.com>
 <a0b099c6-2331-4efa-9f8a-3042fdd4858b@postholer.com>
Message-ID: <15ba0e9b-2b0d-425b-bff1-228e76aa1c26@spatialys.com>

Scott,

Le 12/08/2024 ? 02:19, Scott via gdal-dev a ?crit?:
> Looking at the news file, specifically about gdallocationinfo:
>
> gdallocationinfo: avoid extra newline character in -valonly mode if 
> coordinate is outside raster extent (3.9.0 regression)
>
> Having that new-line character is imperative. 

The fix does what you describe (cf tests added in 
https://github.com/OSGeo/gdal/commit/c308cf3d9a59c9cdf2916585de273cdf54ab9bb4). 
The issue in 3.9.0 and 3.9.1 was that there were 2 newlines instead of a 
single one.

| Ideally, it would be real nice to have an option that returns the 
coord and value on a single line.

That's the -E echo mode. Except I now realize it doesn't work as 
expected in -geoloc/-wgs84 mode, where it reports the pixel, line value, 
whereas the documentation and example suggests that it should be the 
(non-transformed) input coordinates. I've queued a fix for that in 
https://github.com/OSGeo/gdal/pull/10586 . It will probably be in 3.9.3, 
unless there's a RC2

Even


-- 
http://www.spatialys.com
My software is free, but my time generally not.


From sean.gillies at gmail.com  Mon Aug 12 08:31:00 2024
From: sean.gillies at gmail.com (Sean Gillies)
Date: Mon, 12 Aug 2024 09:31:00 -0600
Subject: [gdal-dev] GDAL 3.9.2 release candidate available
In-Reply-To: <3aa4a9a8-eff8-45e5-a46e-3a5075c2c8a4@spatialys.com>
References: <3aa4a9a8-eff8-45e5-a46e-3a5075c2c8a4@spatialys.com>
Message-ID: <CAOodmJpf9XTBbHtL42DJ=hWD5RpWO9qPHonqxysDyiTqzXC8Dw@mail.gmail.com>

3.9.2rc1 looks good from the Rasterio perspective:
https://github.com/rasterio/rasterio/actions/runs/10345292335/job/28632108339

On Sun, Aug 11, 2024 at 11:01?AM Even Rouault via gdal-dev <
gdal-dev at lists.osgeo.org> wrote:

> Hi,
>
> I have prepared a GDAL/OGR 3.9.2 release candidate.
>
> Pick up an archive among the following ones (by ascending size):
>
>    https://download.osgeo.org/gdal/3.9.2/gdal-3.9.2rc1.tar.xz
>    https://download.osgeo.org/gdal/3.9.2/gdal-3.9.2rc1.tar.gz
>    https://download.osgeo.org/gdal/3.9.2/gdal392rc1.zip
>
> A snapshot of the gdalautotest suite is also available:
>
> https://download.osgeo.org/gdal/3.9.2/gdalautotest-3.9.2rc1.tar.gz
>    https://download.osgeo.org/gdal/3.9.2/gdalautotest-3.9.2rc1.zip
>
> The NEWS file is here:
>
>    https://github.com/OSGeo/gdal/blob/v3.9.2RC1/NEWS.md
>
> Best regards,
>
> Even
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240812/dff7ca46/attachment.htm>

From even.rouault at spatialys.com  Tue Aug 13 01:53:43 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 13 Aug 2024 10:53:43 +0200
Subject: [gdal-dev] shapelib 1.6.1RC2 available (was Re: shapelib 1.6.1RC1
 available)
In-Reply-To: <20cdccee-9e0f-465b-9846-437a993d50bd@spatialys.com>
References: <20cdccee-9e0f-465b-9846-437a993d50bd@spatialys.com>
Message-ID: <2c91f4c9-a8d1-417f-81e9-cb84c9ab8c51@spatialys.com>

Hi,

Here's a shapelib v1.6.1 RC2:
- https://download.osgeo.org/shapelib/shapelib-1.6.1rc2.tar.gz
- https://download.osgeo.org/shapelib/shapelib-1.6.1rc2.zip

Changes since v1.6.1RC1:
- shapefil.h: bump version number to 1.6.1
- CMake: (>= 3.21) Fix ctest paths for shared libs (MSVC and CygWin)
- CMake: Add GoogleTestAdapter (GTA) Run Settings

Even


-- 
http://www.spatialys.com
My software is free, but my time generally not.


From gdt at lexort.com  Tue Aug 13 05:54:18 2024
From: gdt at lexort.com (Greg Troxel)
Date: Tue, 13 Aug 2024 08:54:18 -0400
Subject: [gdal-dev] shapelib 1.6.1RC2 available (was Re: shapelib
 1.6.1RC1 available)
In-Reply-To: <2c91f4c9-a8d1-417f-81e9-cb84c9ab8c51@spatialys.com> (Even
 Rouault via gdal-dev's message of "Tue, 13 Aug 2024 10:53:43 +0200")
References: <20cdccee-9e0f-465b-9846-437a993d50bd@spatialys.com>
 <2c91f4c9-a8d1-417f-81e9-cb84c9ab8c51@spatialys.com>
Message-ID: <rmiwmkk60sl.fsf@s1.lexort.com>

(I'm building with autoconf.)

1) It builds fine on NetBSD 10 amd64, using an old pkgsrc workaround/?? to
explicitly build only the libs (that may well be no longer relevant):

  # \todo Explain why we don't install what shapelib installs.
  # \todo Perhaps file a bug upstream that the bin programs are not namespaced.
  BUILD_TARGET=          libshp.la
  INSTALL_TARGET=                install-libLTLIBRARIES install-libshp_la_includeHEADERS install-pkgconfigDATA

2) The tests all fail because they have #! lines with /bin/bash.  While it
could document a dependency on bash, and then find bash with configure
and substitute it, that all seems quite avoidable as I don't see
anything in the test scripts that really need non-POSIX sh features.

With the bash problem worked around, most tests pass, except

  FAIL: tests/shpproj.sh
  ======================

  ../test-driver: ./tests/shpproj.sh: not found
  FAIL tests/shpproj.sh (exit status: 127)

and I don't see that in the tarball, so I'm guessing that isn't a
problem only I am seeing.

shapelib doesn't depend on proj, so perhaps there needs to be
documentation of tests dependencies?

3) pkgsrc used to have this marked MAKE_JOBS_SAFE=no meaning "don't
allow -jN to make", without a comment.  I don't see why this would be
true so I'm going to remove that, but am mentioning it in case someone
else thinks it is needed.

4) I undid the kludge in 1, and I get a failure to build, because make
fires the rule for one of the programs first, and libshp.la isn't built
yet.  Running again with gmake instead, it builds.  So there's something
wrong, but I suspect it's wiser to work around this by documenting that
GNU Make is required.

5) There are a surprisingly large number of programs in bin.  The pkgsrc
package didn't used to install them, but they look like that likely
won't conflict with other pacakges..  Do you think users of shapelib
expect all of these to be installed?

  bin/Shape_PointInPoly
  bin/csv2shp
  bin/dbfadd
  bin/dbfcat
  bin/dbfcreate
  bin/dbfdump
  bin/dbfinfo
  bin/shpadd
  bin/shpcat
  bin/shpcentrd
  bin/shpcreate
  bin/shpdata
  bin/shpdump
  bin/shpdxf
  bin/shpfix
  bin/shpinfo
  bin/shprewind
  bin/shpsort
  bin/shptreedump
  bin/shputils
  bin/shpwkb

From gdt at lexort.com  Tue Aug 13 06:00:03 2024
From: gdt at lexort.com (Greg Troxel)
Date: Tue, 13 Aug 2024 09:00:03 -0400
Subject: [gdal-dev] shapelib 1.6.1RC2 available (was Re: shapelib
 1.6.1RC1 available)
In-Reply-To: <2c91f4c9-a8d1-417f-81e9-cb84c9ab8c51@spatialys.com> (Even
 Rouault via gdal-dev's message of "Tue, 13 Aug 2024 10:53:43 +0200")
References: <20cdccee-9e0f-465b-9846-437a993d50bd@spatialys.com>
 <2c91f4c9-a8d1-417f-81e9-cb84c9ab8c51@spatialys.com>
Message-ID: <rmisev860j0.fsf@s1.lexort.com>

Even Rouault via gdal-dev <gdal-dev at lists.osgeo.org> writes:

> Here's a shapelib v1.6.1 RC2:
> - https://download.osgeo.org/shapelib/shapelib-1.6.1rc2.tar.gz
> - https://download.osgeo.org/shapelib/shapelib-1.6.1rc2.zip
>
> Changes since v1.6.1RC1:
> - shapefil.h: bump version number to 1.6.1
> - CMake: (>= 3.21) Fix ctest paths for shared libs (MSVC and CygWin)
> - CMake: Add GoogleTestAdapter (GTA) Run Settings

Also, NEWS is missing.  (It points to changelog, but that's something
else and very out of date)

From even.rouault at spatialys.com  Tue Aug 13 06:24:52 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 13 Aug 2024 15:24:52 +0200
Subject: [gdal-dev] shapelib 1.6.1RC2 available (was Re: shapelib
 1.6.1RC1 available)
In-Reply-To: <rmiwmkk60sl.fsf@s1.lexort.com>
References: <20cdccee-9e0f-465b-9846-437a993d50bd@spatialys.com>
 <2c91f4c9-a8d1-417f-81e9-cb84c9ab8c51@spatialys.com>
 <rmiwmkk60sl.fsf@s1.lexort.com>
Message-ID: <7b5859b9-443c-4018-81bd-39c0db0e11bf@spatialys.com>

Greg,

> 2) The tests all fail because they have #! lines with /bin/bash.
Should be addressed per https://github.com/OSGeo/shapelib/pull/150
> could document a dependency on bash, and then find bash with configure
> and substitute it, that all seems quite avoidable as I don't see
> anything in the test scripts that really need non-POSIX sh features.
>
> With the bash problem worked around, most tests pass, except
>
>    FAIL: tests/shpproj.sh
>    ======================
>
>    ../test-driver: ./tests/shpproj.sh: not found
>    FAIL tests/shpproj.sh (exit status: 127)
>
> and I don't see that in the tarball, so I'm guessing that isn't a
> problem only I am seeing.
>
> shapelib doesn't depend on proj, so perhaps there needs to be
> documentation of tests dependencies?
I don't reproduce that error (shpproj.sh used to test a shpproj.c 
utility that was removed during the PROJ6 transition, so this is a 
remains of a more complete tests, but it has the virtue of testing a few 
of the contrib/ utilities that have no tests otherwise)
>
> 4) I undid the kludge in 1, and I get a failure to build, because make
> fires the rule for one of the programs first, and libshp.la isn't built
> yet.  Running again with gmake instead, it builds.  So there's something
> wrong, but I suspect it's wiser to work around this by documenting that
> GNU Make is required.
The automake/autoconf build system doesn't not receive much love this 
days (but should not be worse or better that it used to be). Perhaps we 
should remove it at some point.
>
> 5) There are a surprisingly large number of programs in bin.  The pkgsrc
> package didn't used to install them, but they look like that likely
> won't conflict with other pacakges..  Do you think users of shapelib
> expect all of these to be installed?

No opinion here. I hardly use myself any of the shapelib utils. I see 
Debian ships all of them 
(https://packages.debian.org/sid/amd64/shapelib/filelist), but some of 
them come from the contrib/ area (which doesn't necessarily means they 
are worse qualities than other non-contrib utilities). I came much later 
to the party, so I don't have much historical background to provide.

Nothing of the above seems to be 1.6.1 specific, so I don't think it 
deserves a new RC

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240813/733e643e/attachment.htm>

From gdt at lexort.com  Tue Aug 13 09:12:37 2024
From: gdt at lexort.com (Greg Troxel)
Date: Tue, 13 Aug 2024 12:12:37 -0400
Subject: [gdal-dev] GDAL 3.9.2 release candidate available
In-Reply-To: <3aa4a9a8-eff8-45e5-a46e-3a5075c2c8a4@spatialys.com> (Even
 Rouault via gdal-dev's message of "Sun, 11 Aug 2024 19:00:52 +0200")
References: <3aa4a9a8-eff8-45e5-a46e-3a5075c2c8a4@spatialys.com>
Message-ID: <rmied6s5rm2.fsf@s1.lexort.com>

Even Rouault via gdal-dev <gdal-dev at lists.osgeo.org> writes:

> ? https://download.osgeo.org/gdal/3.9.2/gdal-3.9.2rc1.tar.xz

On NetBDS 10 amd64, I locally updated pkgsrc, and gdal-lib, py-gdal
(bindings split package), and qgis all built without issues, and the
resulting qgis, when run on a project with a lot of layers of various
types, worked fine.

So looks good from here.

From even.rouault at spatialys.com  Tue Aug 13 09:13:10 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 13 Aug 2024 18:13:10 +0200
Subject: [gdal-dev] 3.9.2 RC2 [was Re: GDAL 3.9.2 release candidate
 available]
In-Reply-To: <3aa4a9a8-eff8-45e5-a46e-3a5075c2c8a4@spatialys.com>
References: <3aa4a9a8-eff8-45e5-a46e-3a5075c2c8a4@spatialys.com>
Message-ID: <efe188cd-a130-45e6-8f4e-b32fb28e2fba@spatialys.com>

Hi,

I've prepared a RC2:

 ? https://download.osgeo.org/gdal/3.9.2/gdal-3.9.2rc2.tar.xz
 ? https://download.osgeo.org/gdal/3.9.2/gdal-3.9.2rc2.tar.gz
 ? https://download.osgeo.org/gdal/3.9.2/gdal392rc2.zip
https://download.osgeo.org/gdal/3.9.2/gdalautotest-3.9.2rc2.tar.gz
 ? https://download.osgeo.org/gdal/3.9.2/gdalautotest-3.9.2rc2.zip

Changes since RC1 are:
- gdallocationinfo: in -E echo mode, always report input coordinates, 
not pixel,line
- netCDF driver: multidim: fix use-after-free on string variables in 
ReadOneElement()
- VRT: fix reading from virtual overviews when SrcRect / DstRect 
elements are missing
- Python bindings: make MDArray.Write(array_of_strings) work with a 0-d 
string variable

Even

Le 11/08/2024 ? 19:00, Even Rouault via gdal-dev a ?crit?:
> Hi,
>
> I have prepared a GDAL/OGR 3.9.2 release candidate.
>
> Pick up an archive among the following ones (by ascending size):
>
> ? https://download.osgeo.org/gdal/3.9.2/gdal-3.9.2rc1.tar.xz
> ? https://download.osgeo.org/gdal/3.9.2/gdal-3.9.2rc1.tar.gz
> ? https://download.osgeo.org/gdal/3.9.2/gdal392rc1.zip
>
> A snapshot of the gdalautotest suite is also available:
>
> https://download.osgeo.org/gdal/3.9.2/gdalautotest-3.9.2rc1.tar.gz
> ? https://download.osgeo.org/gdal/3.9.2/gdalautotest-3.9.2rc1.zip
>
> The NEWS file is here:
>
> ? https://github.com/OSGeo/gdal/blob/v3.9.2RC1/NEWS.md
>
> Best regards,
>
> Even
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.


From daniel.mannarino at gmail.com  Tue Aug 13 23:28:34 2024
From: daniel.mannarino at gmail.com (Daniel Mannarino)
Date: Wed, 14 Aug 2024 02:28:34 -0400
Subject: [gdal-dev] Trouble with gdaldem -exact_color_entry
Message-ID: <CAO8qHHENUZ6Df28Fpt6DPBNa2eYG-dt3WhZt0mDBRx9k5R7AmA@mail.gmail.com>

Hi all!

I'm having trouble getting gdaldem to work the way I believe it's supposed
to. In particular I have given it a single-band uint8 GeoTIFF and tried to
map the values to RGB bands via a colormap using exact matching, but the
resulting GeoTIFF is invariably all zeroes (as if there were no matches).
Using -nearest_color_entry or not specifying -exact_color_entry yields the
expected results, but I only want exact matches. I have tried specifying
values to match as both floats (0.0, 1.0, etc.) and ints (0, 1, etc.).
Adding an alpha channel makes no difference in this sense. Am I doing
something wrong, or is there an issue with gdaldem? Here are the commands I
used, and a link to the files in question:

gdaldem color-relief -co COMPRESS=DEFLATE -co TILED=YES -co BLOCKXSIZE=256
-co BLOCKYSIZE=256 -co SPARSE_OK=TRUE -co INTERLEAVE=BAND
-exact_color_entry -alpha foo.tif colormap.txt exact_foo_with_alpha.tif

gdaldem color-relief -co COMPRESS=DEFLATE -co TILED=YES -co BLOCKXSIZE=256
-co BLOCKYSIZE=256 -co SPARSE_OK=TRUE -co INTERLEAVE=BAND
-nearest_color_entry -alpha foo.tif colormap.txt nearest_foo_with_alpha.tif

gdaldem color-relief -co COMPRESS=DEFLATE -co TILED=YES -co BLOCKXSIZE=256
-co BLOCKYSIZE=256 -co SPARSE_OK=TRUE -co INTERLEAVE=BAND -alpha foo.tif
colormap.txt gradient_foo_with_alpha.tif

https://drive.google.com/drive/folders/17q3zQAcOqPTo4f8-swWEgrpQ9sfufasR?usp=share_link

These commands were performed with GDAL 3.9.1 installed on MacOS/ARM via
Homebrew, though the problem also occurs in our AMD64 AWS instances running
Linux and GDAL 3.8.4 with the official Docker images as a base.

Thanks for any help!
Daniel Mannarino
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240814/48a65286/attachment.htm>

From even.rouault at spatialys.com  Wed Aug 14 01:18:04 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 14 Aug 2024 10:18:04 +0200
Subject: [gdal-dev] Motion: approve GDAL 3.9.2RC2 as final 3.9.2 release
Message-ID: <3ebaa051-c824-4425-815c-98445d5a8814@spatialys.com>

Hi,

Motion: approve GDAL 3.9.2RC2 as final 3.9.2 release

Starting with my +1

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From even.rouault at spatialys.com  Wed Aug 14 01:29:13 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 14 Aug 2024 10:29:13 +0200
Subject: [gdal-dev] Shapelib 1.6.1 is released
Message-ID: <f7a55f0e-c0fd-450c-b0ea-4a3196a19245@spatialys.com>

Hi,

I've promoted shapelib v1.6.1rc2 + minor changes in test suite as final 
v1.6.1

- http://download.osgeo.org/shapelib/shapelib-1.6.1.tar.gz
- http://download.osgeo.org/shapelib/shapelib-1.6.1.zip

Changes since 1.6.0:
- DBFIsValueNULL(): accept empty string as NULL Date 
(https://github.com/OSGeo/gdal/issues/10405)
- DBFIsValueNULL(): Accept string containing of width times "0" as NULL Date
- Only test for _WIN32 for Windows detection
- Windows: Fix UTF8 hook functions
- Various compiler warning fixes
- contrib/csv2shp.c: fix resource leaks (#86)
- Detect byte order at compile time
- shapefil.h: various const-correctness improvements
- shapefil.h: Remove SHPTreeRemoveShapeId not being implemented
- shapefil.h: Fix API call of SHPSearchDiskTreeEx
- Add API functions for read/write of date attributes: 
DBFReadDateAttribute/DBFWriteDateAttribute
- DBFWriteAttribute/DBFWriteLogicalAttribute: no longer silently accpets 
invalid input, but returns false
- DBFCloneEmpty: consider the SAHooks
- Move endian defines to shapefil_private.h (#99)
- Fix test execution by complete refactoring.
- Add C++ unit testing (#113)
- SBNOpenDiskTree(): make it work with node descriptors with 
non-increasing nBinStart
 ? Fixes https://github.com/OSGeo/shapelib/issues/106 / 
https://github.com/OSGeo/gdal/issues/9430
- sbnsearch.c: avoid potential integer overflows on corrupted files
- dbfdump: dump date and logical fields
- dbfinfo: print date and logical fields
- dbfcat: various fixes
- Fix -Werror=calloc-transposed-args with gcc 14
- SHPOpenLL(): avoid GDAL specific error message when .shx is missing (#129)
- CMake: generate pkg-config file (#135)
- CMake: Fix install interface include dir (#134)
- CMake: Make building executables optional with CMake (set BUILD_APPS 
to OFF) (#78)
- CMake: Remove duplicated shapefil.h installation in 
include_dir/shapelib (#80)
- CMake: Remove INSTALL_NAME_DIR from target (#49)
- CMake: Fix contrib.cmake
- CMake: (>= 3.21) Fix ctest paths for shared libs (MSVC and CygWin)
- CMake: Add GoogleTestAdapter (GTA) Run Settings

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From jukka.rahkonen at maanmittauslaitos.fi  Wed Aug 14 01:55:46 2024
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Wed, 14 Aug 2024 08:55:46 +0000
Subject: [gdal-dev] Motion: approve GDAL 3.9.2RC2 as final 3.9.2 release
In-Reply-To: <3ebaa051-c824-4425-815c-98445d5a8814@spatialys.com>
References: <3ebaa051-c824-4425-815c-98445d5a8814@spatialys.com>
Message-ID: <DB9PR09MB68879DBA804AD3F67DAD02CCFD872@DB9PR09MB6887.eurprd09.prod.outlook.com>

+1

-Jukka Rahkonen-

-----Alkuper?inen viesti-----
L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Even Rouault via gdal-dev
L?hetetty: keskiviikko 14. elokuuta 2024 11.18
Vastaanottaja: gdal-dev at lists.osgeo.org
Aihe: [gdal-dev] Motion: approve GDAL 3.9.2RC2 as final 3.9.2 release

Hi,

Motion: approve GDAL 3.9.2RC2 as final 3.9.2 release

Starting with my +1

Even

-- 

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org

From even.rouault at spatialys.com  Wed Aug 14 03:45:18 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 14 Aug 2024 12:45:18 +0200
Subject: [gdal-dev] Trouble with gdaldem -exact_color_entry
In-Reply-To: <CAO8qHHENUZ6Df28Fpt6DPBNa2eYG-dt3WhZt0mDBRx9k5R7AmA@mail.gmail.com>
References: <CAO8qHHENUZ6Df28Fpt6DPBNa2eYG-dt3WhZt0mDBRx9k5R7AmA@mail.gmail.com>
Message-ID: <5d7260ba-5796-4ac6-b678-1021e8406bb1@spatialys.com>

Hi,

There was indeed an issue with the -exact_color_entry mode. Will be 
fixed per https://github.com/OSGeo/gdal/pull/10596

As your input band is integer, you can safely use -nearest_color_entry 
or the default linear interpretation mode (potentially adding an entry 
"12 0 0 0 0" in case you want to map values >= 12 to transparent)

Even

Le 14/08/2024 ? 08:28, Daniel Mannarino via gdal-dev a ?crit?:
> Hi all!
>
> I'm having trouble getting gdaldem to work the way I believe it's 
> supposed to. In particular I have given it a single-band uint8 GeoTIFF 
> and tried to map the values to RGB bands via a colormap using exact 
> matching, but the resulting GeoTIFF is invariably all zeroes (as if 
> there were no matches). Using -nearest_color_entry or not specifying 
> -exact_color_entry yields the expected results, but I only want exact 
> matches. I have tried specifying values to match as both floats (0.0, 
> 1.0, etc.) and ints (0, 1, etc.). Adding an alpha channel makes no 
> difference in this sense. Am I doing something wrong, or is there an 
> issue with gdaldem? Here are the commands I used, and a link to the 
> files in question:
>
> gdaldem color-relief -co COMPRESS=DEFLATE -co TILED=YES -co 
> BLOCKXSIZE=256 -co BLOCKYSIZE=256 -co SPARSE_OK=TRUE -co 
> INTERLEAVE=BAND -exact_color_entry -alpha foo.tif colormap.txt 
> exact_foo_with_alpha.tif
>
> gdaldem color-relief -co COMPRESS=DEFLATE -co TILED=YES -co 
> BLOCKXSIZE=256 -co BLOCKYSIZE=256 -co SPARSE_OK=TRUE -co 
> INTERLEAVE=BAND -nearest_color_entry -alpha foo.tif colormap.txt 
> nearest_foo_with_alpha.tif
>
> gdaldem color-relief -co COMPRESS=DEFLATE -co TILED=YES -co 
> BLOCKXSIZE=256 -co BLOCKYSIZE=256 -co SPARSE_OK=TRUE -co 
> INTERLEAVE=BAND -alpha foo.tif colormap.txt gradient_foo_with_alpha.tif
>
> https://drive.google.com/drive/folders/17q3zQAcOqPTo4f8-swWEgrpQ9sfufasR?usp=share_link
>
> These commands were performed with GDAL 3.9.1 installed on MacOS/ARM 
> via Homebrew, though the problem also occurs in our AMD64 AWS 
> instances running Linux and GDAL 3.8.4 with the official Docker images 
> as a base.
>
> Thanks for any help!
> Daniel Mannarino
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From j1 at jimenezshaw.com  Wed Aug 14 04:50:25 2024
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Wed, 14 Aug 2024 13:50:25 +0200
Subject: [gdal-dev] Motion: approve GDAL 3.9.2RC2 as final 3.9.2 release
In-Reply-To: <DB9PR09MB68879DBA804AD3F67DAD02CCFD872@DB9PR09MB6887.eurprd09.prod.outlook.com>
References: <3ebaa051-c824-4425-815c-98445d5a8814@spatialys.com>
 <DB9PR09MB68879DBA804AD3F67DAD02CCFD872@DB9PR09MB6887.eurprd09.prod.outlook.com>
Message-ID: <CADRrdKvQXQwV9hU+6hHpXjwHMMN88j0rF9=JBRXkWmN_tDDPMg@mail.gmail.com>

+1 Javier

On Wed, 14 Aug 2024 at 10:55, Rahkonen Jukka via gdal-dev <
gdal-dev at lists.osgeo.org> wrote:

> +1
>
> -Jukka Rahkonen-
>
> -----Alkuper?inen viesti-----
> L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Even
> Rouault via gdal-dev
> L?hetetty: keskiviikko 14. elokuuta 2024 11.18
> Vastaanottaja: gdal-dev at lists.osgeo.org
> Aihe: [gdal-dev] Motion: approve GDAL 3.9.2RC2 as final 3.9.2 release
>
> Hi,
>
> Motion: approve GDAL 3.9.2RC2 as final 3.9.2 release
>
> Starting with my +1
>
> Even
>
> --
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240814/cab2a6d3/attachment-0001.htm>

From howard at hobu.co  Thu Aug 15 06:56:25 2024
From: howard at hobu.co (Howard Butler)
Date: Thu, 15 Aug 2024 08:56:25 -0500
Subject: [gdal-dev] Motion: approve GDAL 3.9.2RC2 as final 3.9.2 release
In-Reply-To: <CADRrdKvQXQwV9hU+6hHpXjwHMMN88j0rF9=JBRXkWmN_tDDPMg@mail.gmail.com>
References: <3ebaa051-c824-4425-815c-98445d5a8814@spatialys.com>
 <DB9PR09MB68879DBA804AD3F67DAD02CCFD872@DB9PR09MB6887.eurprd09.prod.outlook.com>
 <CADRrdKvQXQwV9hU+6hHpXjwHMMN88j0rF9=JBRXkWmN_tDDPMg@mail.gmail.com>
Message-ID: <7FF93A1F-0B16-4A36-A212-BB6B9B02D3B4@hobu.co>

+1 Howard


> On Aug 14, 2024, at 6:50?AM, Javier Jimenez Shaw via gdal-dev <gdal-dev at lists.osgeo.org> wrote:
> 
> +1 Javier
> 
> On Wed, 14 Aug 2024 at 10:55, Rahkonen Jukka via gdal-dev <gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>> wrote:
>> +1
>> 
>> -Jukka Rahkonen-
>> 
>> -----Alkuper?inen viesti-----
>> L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org <mailto:gdal-dev-bounces at lists.osgeo.org>> Puolesta Even Rouault via gdal-dev
>> L?hetetty: keskiviikko 14. elokuuta 2024 11.18
>> Vastaanottaja: gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>> Aihe: [gdal-dev] Motion: approve GDAL 3.9.2RC2 as final 3.9.2 release
>> 
>> Hi,
>> 
>> Motion: approve GDAL 3.9.2RC2 as final 3.9.2 release
>> 
>> Starting with my +1
>> 
>> Even
>> 
>> -- 
>> 
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240815/40fe45f2/attachment.htm>

From shawn.fox at baesystems.us  Thu Aug 15 12:15:02 2024
From: shawn.fox at baesystems.us (Fox, Shawn D (US))
Date: Thu, 15 Aug 2024 19:15:02 +0000
Subject: [gdal-dev] Question about gdal-dev archive - searching for
 information on reading HDF, SAR_CEOS metadata
Message-ID: <mailman.3.1723749797.32172.gdal-dev@lists.osgeo.org>

Is there any way to search the archive?  So far, I have only found a way to show the threads for a particular month/year, but I don't see a way to do a keyword search.  My team has recently tried to upgrade from a very old version 1.10.0 to 3.4.2 and we can no longer successfully read metadata from HDF4, HDF5, and CEOS_SAR files in the same way that we could do so in the past.

Has anyone on the list had a similar experience when upgrading?  The driver and plugin pages for these data types has already been reviewed and we could not find any information to explain what change I need to make to read metadata again.  I can provide more specifics but wanted to know if anyone was willing to collaborate on that topic and share information.

Thanks,

Shawn Fox

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240815/eca2adb4/attachment.htm>

From public at postholer.com  Thu Aug 15 12:38:32 2024
From: public at postholer.com (Scott)
Date: Thu, 15 Aug 2024 12:38:32 -0700
Subject: [gdal-dev] Question about gdal-dev archive - searching for
 information on reading HDF, SAR_CEOS metadata
In-Reply-To: <20240815192317.E741E61346A9@lists.osgeo.org>
References: <20240815192317.E741E61346A9@lists.osgeo.org>
Message-ID: <8af3a61c-298a-4a08-9bc8-fb2152afacfc@postholer.com>

Hey Shawn,

In google try something like:

hdf4 site:lists.osgeo.org/pipermail/gdal-dev

You may be able to narrow things down.

On 8/15/24 12:15, Fox, Shawn D (US) via gdal-dev wrote:
> Is there any way to search the archive?? So far, I have only found a way 
> to show the threads for a particular month/year, but I don?t see a way 
> to do a keyword search.? My team has recently tried to upgrade from a 
> very old version 1.10.0 to 3.4.2 and we can no longer successfully read 
> metadata from HDF4, HDF5, and CEOS_SAR files in the same way that we 
> could do so in the past.
> 
> Has anyone on the list had a similar experience when upgrading?? The 
> driver and plugin pages for these data types has already been reviewed 
> and we could not find any information to explain what change I need to 
> make to read metadata again. I can provide more specifics but wanted to 
> know if anyone was willing to collaborate on that topic and share 
> information.
> 
> Thanks,
> 
> Shawn Fox
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From jukka.rahkonen at maanmittauslaitos.fi  Thu Aug 15 12:44:39 2024
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Thu, 15 Aug 2024 19:44:39 +0000
Subject: [gdal-dev] Question about gdal-dev archive - searching for
 information on reading HDF, SAR_CEOS metadata
In-Reply-To: <20240815192318.6195761346AF@lists.osgeo.org>
References: <20240815192318.6195761346AF@lists.osgeo.org>
Message-ID: <DB9PR09MB68875299DC342731F689D7BEFD802@DB9PR09MB6887.eurprd09.prod.outlook.com>

Hi,

Gdal-dev in Mail-archive is searchable hdf4 (mail-archive.com)<https://www.mail-archive.com/search?q=hdf4&l=gdal-dev%40lists.osgeo.org>

-Jukka Rahkonen-

L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Fox, Shawn D (US) via gdal-dev
L?hetetty: torstai 15. elokuuta 2024 22.15
Vastaanottaja: 'gdal-dev at lists.osgeo.org' <gdal-dev at lists.osgeo.org>
Aihe: [gdal-dev] Question about gdal-dev archive - searching for information on reading HDF, SAR_CEOS metadata

Is there any way to search the archive?  So far, I have only found a way to show the threads for a particular month/year, but I don't see a way to do a keyword search.  My team has recently tried to upgrade from a very old version 1.10.0 to 3.4.2 and we can no longer successfully read metadata from HDF4, HDF5, and CEOS_SAR files in the same way that we could do so in the past.

Has anyone on the list had a similar experience when upgrading?  The driver and plugin pages for these data types has already been reviewed and we could not find any information to explain what change I need to make to read metadata again.  I can provide more specifics but wanted to know if anyone was willing to collaborate on that topic and share information.

Thanks,

Shawn Fox

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240815/63618960/attachment-0001.htm>

From even.rouault at spatialys.com  Thu Aug 15 12:46:06 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 15 Aug 2024 21:46:06 +0200
Subject: [gdal-dev] Question about gdal-dev archive - searching for
 information on reading HDF, SAR_CEOS metadata
In-Reply-To: <20240815192317.E741E61346A9@lists.osgeo.org>
References: <20240815192317.E741E61346A9@lists.osgeo.org>
Message-ID: <b017946c-6b26-455f-b6f8-4229346a787e@spatialys.com>

Shawn,

can you be more specific about the issue? (ideally with a link to test 
datasets, and outputs of gdalinfo with older and newer versions)

Even

Le 15/08/2024 ? 21:15, Fox, Shawn D (US) via gdal-dev a ?crit?:
>
> Is there any way to search the archive?? So far, I have only found a 
> way to show the threads for a particular month/year, but I don?t see a 
> way to do a keyword search.? My team has recently tried to upgrade 
> from a very old version 1.10.0 to 3.4.2 and we can no longer 
> successfully read metadata from HDF4, HDF5, and CEOS_SAR files in the 
> same way that we could do so in the past.
>
> Has anyone on the list had a similar experience when upgrading?? The 
> driver and plugin pages for these data types has already been reviewed 
> and we could not find any information to explain what change I need to 
> make to read metadata again.? I can provide more specifics but wanted 
> to know if anyone was willing to collaborate on that topic and share 
> information.
>
> Thanks,
>
> Shawn Fox
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240815/8bc65714/attachment.htm>

From even.rouault at spatialys.com  Fri Aug 16 03:33:33 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 16 Aug 2024 12:33:33 +0200
Subject: [gdal-dev] Motion: approve GDAL 3.9.2RC2 as final 3.9.2 release
In-Reply-To: <3ebaa051-c824-4425-815c-98445d5a8814@spatialys.com>
References: <3ebaa051-c824-4425-815c-98445d5a8814@spatialys.com>
Message-ID: <07515234-4b66-4003-8620-540eb0d677e2@spatialys.com>

Motion passed with +1 from PSC members JukkaR, JavierJS, HowardB and me.

Le 14/08/2024 ? 10:18, Even Rouault via gdal-dev a ?crit?:
> Hi,
>
> Motion: approve GDAL 3.9.2RC2 as final 3.9.2 release
>
> Starting with my +1
>
> Even
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.


From even.rouault at spatialys.com  Fri Aug 16 04:06:56 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 16 Aug 2024 13:06:56 +0200
Subject: [gdal-dev] GDAL 3.9.2 is released
Message-ID: <6d6deba5-15fa-4536-9093-7590788f0bcd@spatialys.com>

Hi,

On behalf of the GDAL/OGR development team, I am pleased to announce the 
release of the GDAL/OGR 3.9.2 bug fix version.

Consult the release notes for the list of issues addressed:
 ??? https://github.com/OSGeo/gdal/blob/v3.9.2/NEWS.md

The sources are available at:

 ??? https://download.osgeo.org/gdal/3.9.2/gdal-3.9.2.tar.xz
 ??? https://download.osgeo.org/gdal/3.9.2/gdal-3.9.2.tar.xz.md5
 ??? https://download.osgeo.org/gdal/3.9.2/gdal-3.9.2.tar.xz.sig

or

 ??? https://download.osgeo.org/gdal/3.9.2/gdal-3.9.2.tar.gz
 ??? https://download.osgeo.org/gdal/3.9.2/gdal-3.9.2.tar.gz.md5
 ??? https://download.osgeo.org/gdal/3.9.2/gdal-3.9.2.tar.gz.sig

or

 ??? https://download.osgeo.org/gdal/3.9.2/gdal392.zip
 ??? https://download.osgeo.org/gdal/3.9.2/gdal392.zip.md5
 ??? https://download.osgeo.org/gdal/3.9.2/gdal392.zip.sig

Best regards,

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From bobby.obrien at baesystems.us  Mon Aug 19 16:52:06 2024
From: bobby.obrien at baesystems.us (O'Brien, Bobby (US) (Insight Global))
Date: Mon, 19 Aug 2024 23:52:06 +0000
Subject: [gdal-dev] Different Metadata Reported When Using Different
 Versions of GDAL
Message-ID: <mailman.4.1724112018.32172.gdal-dev@lists.osgeo.org>

Hello,

While performing a GDAL upgrade from version 1.10.0 to 3.4.2 I've noticed some metadata for a few file formats not being produced with the newer version of GDAL. For simplicity's sake, this email will only focus on one of the file formats.

The dataset that I tested with can be downloaded from search.earthdata.nasa.gov from the collection labeled "ASTER Level 1 precision terrain corrected registered at-sensor radiance V003". The specific file I used was AST_L1T_00308172024214434_20240819163247_3432525.hdf with a date of 2024-08-17. It seems new data is added to this collection frequently, however, testing with multiple files from that collection resulted in the same missing metadata. Running (gdalinfo AST_L1T_00308172024214434_20240819163247_3432525.hdf) with version 1.10 there is metadata labeled "XDIM" and "YDIM" that is reported each with a value of "11". However running with version 3.2.4 this metadata is not reported.

Both versions of gdalinfo report they are using "Driver: HDF4/Hierarchical Data Format Release 4". Is it possible to extract this missing metadata using GDAL 3.2.4?

Thanks,
Robert O'Brien
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240819/29a63b04/attachment.htm>

From franciscovicent at outlook.com  Tue Aug 20 14:05:06 2024
From: franciscovicent at outlook.com (Francisco Vicent)
Date: Tue, 20 Aug 2024 18:05:06 -0300
Subject: [gdal-dev] Noise at the top of NOAA19 (L1B) image
Message-ID: <PH8P221MB10636469189CA3D6F2EAB0ADB18D2@PH8P221MB1063.NAMP221.PROD.OUTLOOK.COM>

Hello there, GDAL community!

I'm experiencing some issues while warping a NOAA 19 image. I'm running 
a simple:

gdalwarp NSS.LHRR.NP.D16020.S1834.E1846.B3581920.WI warped.tif

When I display the result in QGIS, it seems that the image is a little 
cropped and has some noise at the top:

https://imgur.com/a/gZW6Sya

I've also tried with NOAA 14 and 16 datasets and they look as expected, 
so I guess that the NOAA-19 format might not be fully supported.

Anyway, I would like to hear from you if there's something I am missing, 
before filing an issue or attempting a fix.

Thanks in advance.

Regards,
Francisco



From arb at sat.dundee.ac.uk  Wed Aug 21 06:49:33 2024
From: arb at sat.dundee.ac.uk (Andrew Brooks)
Date: Wed, 21 Aug 2024 14:49:33 +0100
Subject: [gdal-dev] Noise at the top of NOAA19 (L1B) image
In-Reply-To: <PH8P221MB10636469189CA3D6F2EAB0ADB18D2@PH8P221MB1063.NAMP221.PROD.OUTLOOK.COM>
References: <PH8P221MB10636469189CA3D6F2EAB0ADB18D2@PH8P221MB1063.NAMP221.PROD.OUTLOOK.COM>
Message-ID: <CAHOfOo1H_U5_Wu=+b=ztwQATCB-0MrMjfR8PFHz_PWm7HHGnrQ@mail.gmail.com>

That's completely normal for data which has been received from satellites
that do not have on-board error detection/correction such as NOAA-n (n<20)

On Tue, 20 Aug 2024 at 22:05, Francisco Vicent via gdal-dev <
gdal-dev at lists.osgeo.org> wrote:

> Hello there, GDAL community!
>
> I'm experiencing some issues while warping a NOAA 19 image. I'm running
> a simple:
>
> gdalwarp NSS.LHRR.NP.D16020.S1834.E1846.B3581920.WI warped.tif
>
> When I display the result in QGIS, it seems that the image is a little
> cropped and has some noise at the top:
>
> https://imgur.com/a/gZW6Sya
>
> I've also tried with NOAA 14 and 16 datasets and they look as expected,
> so I guess that the NOAA-19 format might not be fully supported.
>
> Anyway, I would like to hear from you if there's something I am missing,
> before filing an issue or attempting a fix.
>
> Thanks in advance.
>
> Regards,
> Francisco
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240821/d3a76490/attachment.htm>

From Justin.Terry at wri.org  Wed Aug 21 09:08:36 2024
From: Justin.Terry at wri.org (Justin Terry)
Date: Wed, 21 Aug 2024 16:08:36 +0000
Subject: [gdal-dev] Overview resampling generating non-existant values
Message-ID: <SJ0PR11MB591817CCC281291D6C3CF1B69B8E2@SJ0PR11MB5918.namprd11.prod.outlook.com>

Hi,

I'm experiencing a strange issue I've never seen before where certain resampling methods that should only include values in the original dataset, like mode and nearest, are adding new values in the overviews.

For example, the original raster contains the following values:

[0,  1,  2,  4,  5,  8,  9, 10, 16, 17, 18, 20, 21, 32, 33, 34, 36, 37, 40, 41, 42, 64, 65, 66, 68, 69, 72, 73, 74, 80, 81, 82, 84, 85]

I resample it using the following command:

gdalwarp dataset.tif dataset_cog.tif -of COG -co COMPRESS=LZW -r mode

And when I look at overviews, I start these values, especially as it downsamples further:

[ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 90, 91]

I saw the same if I tried it with nearest resampling. Maybe I'm misunderstanding, but I would think these resampling methods would retain the original values, and not interpolate any in-between values.

I'm using GDAL version 3.9.1 on Mac M3 from Homebrew.

Thanks,
Justin

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240821/bd03a63a/attachment.htm>

From thomas.bonfort at gmail.com  Wed Aug 21 09:32:16 2024
From: thomas.bonfort at gmail.com (thomas bonfort)
Date: Wed, 21 Aug 2024 18:32:16 +0200
Subject: [gdal-dev] Overview resampling generating non-existant values
In-Reply-To: <SJ0PR11MB591817CCC281291D6C3CF1B69B8E2@SJ0PR11MB5918.namprd11.prod.outlook.com>
References: <SJ0PR11MB591817CCC281291D6C3CF1B69B8E2@SJ0PR11MB5918.namprd11.prod.outlook.com>
Message-ID: <CAOM3y2g0G_mPxAxLndUwkQNx8bOoWsUo6pDyZ4KKjhe-AOxE+g@mail.gmail.com>

For COG format, you should use -co RESAMPLING=mode. gdalwarp's -r switch
only applies to the full resolution warper resampling, not the overviews.
TB

Le mer. 21 ao?t 2024, 18:09, Justin Terry via gdal-dev <
gdal-dev at lists.osgeo.org> a ?crit :

> Hi,
>
>
>
> I'm experiencing a strange issue I've never seen before where certain
> resampling methods that should only include values in the original dataset,
> like mode and nearest, are adding new values in the overviews.
>
>
>
> For example, the original raster contains the following values:
>
>
>
> [0,  1,  2,  4,  5,  8,  9, 10, 16, 17, 18, 20, 21, 32, 33, 34, 36, 37,
> 40, 41, 42, 64, 65, 66, 68, 69, 72, 73, 74, 80, 81, 82, 84, 85]
>
>
>
> I resample it using the following command:
>
>
>
> gdalwarp dataset.tif dataset_cog.tif -of COG -co COMPRESS=LZW -r mode
>
>
>
> And when I look at overviews, I start these values, especially as it
> downsamples further:
>
> [ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
> 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36,
> 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55,
> 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74,
> 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 90, 91]
>
> I saw the same if I tried it with nearest resampling. Maybe I'm
> misunderstanding, but I would think these resampling methods would retain
> the original values, and not interpolate any in-between values.
>
> I'm using GDAL version 3.9.1 on Mac M3 from Homebrew.
>
> Thanks,
> Justin
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240821/602cfbfd/attachment-0001.htm>

From Justin.Terry at wri.org  Wed Aug 21 10:19:57 2024
From: Justin.Terry at wri.org (Justin Terry)
Date: Wed, 21 Aug 2024 17:19:57 +0000
Subject: [gdal-dev] Overview resampling generating non-existant values
In-Reply-To: <CAOM3y2g0G_mPxAxLndUwkQNx8bOoWsUo6pDyZ4KKjhe-AOxE+g@mail.gmail.com>
References: <SJ0PR11MB591817CCC281291D6C3CF1B69B8E2@SJ0PR11MB5918.namprd11.prod.outlook.com>
 <CAOM3y2g0G_mPxAxLndUwkQNx8bOoWsUo6pDyZ4KKjhe-AOxE+g@mail.gmail.com>
Message-ID: <SJ0PR11MB591883A0C38500FBCE9E801B9B8E2@SJ0PR11MB5918.namprd11.prod.outlook.com>

Aha, that resolved the issue, thanks!

From: thomas bonfort <thomas.bonfort at gmail.com>
Date: Wednesday, August 21, 2024 at 9:32?AM
To: Justin Terry <Justin.Terry at wri.org>
Cc: Gdal Dev <gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] Overview resampling generating non-existant values
You don't often get email from thomas.bonfort at gmail.com. Learn why this is important<https://aka.ms/LearnAboutSenderIdentification>
For COG format, you should use -co RESAMPLING=mode. gdalwarp's -r switch only applies to the full resolution warper resampling, not the overviews.
TB

Le mer. 21 ao?t 2024, 18:09, Justin Terry via gdal-dev <gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>> a ?crit :
Hi,

I'm experiencing a strange issue I've never seen before where certain resampling methods that should only include values in the original dataset, like mode and nearest, are adding new values in the overviews.

For example, the original raster contains the following values:

[0,  1,  2,  4,  5,  8,  9, 10, 16, 17, 18, 20, 21, 32, 33, 34, 36, 37, 40, 41, 42, 64, 65, 66, 68, 69, 72, 73, 74, 80, 81, 82, 84, 85]

I resample it using the following command:

gdalwarp dataset.tif dataset_cog.tif -of COG -co COMPRESS=LZW -r mode

And when I look at overviews, I start these values, especially as it downsamples further:

[ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 90, 91]

I saw the same if I tried it with nearest resampling. Maybe I'm misunderstanding, but I would think these resampling methods would retain the original values, and not interpolate any in-between values.

I'm using GDAL version 3.9.1 on Mac M3 from Homebrew.

Thanks,
Justin

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240821/85ac17bd/attachment-0001.htm>

From franciscovicent at outlook.com  Wed Aug 21 13:10:32 2024
From: franciscovicent at outlook.com (Francisco Vicent)
Date: Wed, 21 Aug 2024 17:10:32 -0300
Subject: [gdal-dev] Noise at the top of NOAA19 (L1B) image
In-Reply-To: <CAHOfOo1H_U5_Wu=+b=ztwQATCB-0MrMjfR8PFHz_PWm7HHGnrQ@mail.gmail.com>
References: <PH8P221MB10636469189CA3D6F2EAB0ADB18D2@PH8P221MB1063.NAMP221.PROD.OUTLOOK.COM>
 <CAHOfOo1H_U5_Wu=+b=ztwQATCB-0MrMjfR8PFHz_PWm7HHGnrQ@mail.gmail.com>
Message-ID: <PH8P221MB106327DB90C2FD3D864C0CF2B18E2@PH8P221MB1063.NAMP221.PROD.OUTLOOK.COM>

Do you suggest the image itself might be corrupt?

I can see the top of the image without noise if I extract the individual 
bands using pygac and then I create a TCI with GDAL:

https://i.imgur.com/OspvQi7.png

El 21/8/2024 a las 10:49, Andrew Brooks escribi?:
> That's completely normal for data which has been received from 
> satellites that do not have on-board error detection/correction such 
> as NOAA-n (n<20)
>
> On Tue, 20 Aug 2024 at 22:05, Francisco Vicent via gdal-dev 
> <gdal-dev at lists.osgeo.org> wrote:
>
>     Hello there, GDAL community!
>
>     I'm experiencing some issues while warping a NOAA 19 image. I'm
>     running
>     a simple:
>
>     gdalwarp NSS.LHRR.NP.D16020.S1834.E1846.B3581920.WI warped.tif
>
>     When I display the result in QGIS, it seems that the image is a
>     little
>     cropped and has some noise at the top:
>
>     https://imgur.com/a/gZW6Sya
>
>     I've also tried with NOAA 14 and 16 datasets and they look as
>     expected,
>     so I guess that the NOAA-19 format might not be fully supported.
>
>     Anyway, I would like to hear from you if there's something I am
>     missing,
>     before filing an issue or attempting a fix.
>
>     Thanks in advance.
>
>     Regards,
>     Francisco
>
>
>     _______________________________________________
>     gdal-dev mailing list
>     gdal-dev at lists.osgeo.org
>     https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240821/41f6645d/attachment.htm>

From vsharma.next at gmail.com  Wed Aug 21 14:16:34 2024
From: vsharma.next at gmail.com (Varun Sharma)
Date: Wed, 21 Aug 2024 23:16:34 +0200
Subject: [gdal-dev] BufferEx and GDAL 3.10
Message-ID: <CAMS_tAtU_7XmPG-WYeshrde7T8=5GQSWCC7788y=PFuN7eH=2g@mail.gmail.com>

Hi Team GDAL,

First message here - lots of respect to all of you involved in this
project.

I was looking through the code and documentation on vector operations and
wanted to use the BufferEx operation on OGRGeometry. But it is marked as
being for 3.10 !? some clarifying questions follow :

1. I see in the current master that the function seems to have been
implemented - am I correct ? Is something missing in there ?
2. If it has been implemented - it seems that its python bindings are not ?
how come ( I presume it bindings are generated automatically? )
3. is there a public roadmap for 3.10 ? ( sorry but I was unable to find it
from googling ). I ask not only for this function but as a reference for
the future as well.

As a background - I was about to implement this myself - by moving
geometries to GEOS but would prefer to remain within GDAL and not open up
more APIs in my own app code.

Many thanks in advance

Cheers,
Varun
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240821/400d2691/attachment.htm>

From even.rouault at spatialys.com  Wed Aug 21 14:25:18 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 21 Aug 2024 23:25:18 +0200
Subject: [gdal-dev] BufferEx and GDAL 3.10
In-Reply-To: <CAMS_tAtU_7XmPG-WYeshrde7T8=5GQSWCC7788y=PFuN7eH=2g@mail.gmail.com>
References: <CAMS_tAtU_7XmPG-WYeshrde7T8=5GQSWCC7788y=PFuN7eH=2g@mail.gmail.com>
Message-ID: <020d101a-398e-49b6-98d3-c920a5190ccf@spatialys.com>

Hi,
>
> First message here - lots of respect to all of you involved in this 
> project.
>
> I was looking through the code and documentation on vector operations 
> and wanted to use the BufferEx operation on OGRGeometry. But it is 
> marked as being for 3.10 !? some clarifying questions follow :

The online documentation reflects master. 3.10 will be what current 
master will be released as in next November
> 2. If it has been implemented - it seems that its python?bindings are 
> not ? how come ( I presume it bindings are generated automatically? )

Not automatically, but this has indeed been mapped as 
ogr.Geometry.Buffer() with a distance and options argument. Cf 
https://github.com/OSGeo/gdal/commit/f49da2489f7b1e83155146ef902243a1542097ba

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From howard at hobu.co  Thu Aug 22 05:10:35 2024
From: howard at hobu.co (Howard Butler)
Date: Thu, 22 Aug 2024 07:10:35 -0500
Subject: [gdal-dev] GDAL Maintainers Meeting Minutes
Message-ID: <2BC912D1-32F6-4066-A52C-D5658B3CC83E@hobu.co>

The monthly GDAL Maintainers Meeting scheduled for 08/22/2024 was canceled due to vacation season. Text reports were provided.

Maintenance activities update
------------------------------------------

Alessandro
* PR reviews

Dan

* No activity

Even

* shapelib 1.6.1 release
* GDAL 3.9.2 release
* Addition of a 'spelling' target for GDAL documentation and fix of a number of spellings issues, and initiating an allow list with the rest of unknown terms.
* Update of PROJ database to EPSG 11.015
* ~50 tickets and pull requests triaging/review/fixing
* With agreement with Dan, switch of GDAL documentation postponed post August 26th

Howard

* I'll see you at FOSS4GNA next month in St. Louis where I will be presenting about the GDAL Sponsorship Program https://whova.com/embedded/session/yES4SgdEKaaEK0AD6y4YnM1DD3NRWjkPECkzqJQHhCY%3D/4005895/?widget=primary 

The next GDAL Maintainers Meeting is 09/26/2024 at 13:00 UTC. Any GDAL PR contributors are welcome to join by reaching out to me for an invite.

Howard

From ermt at ghgsat.com  Thu Aug 22 09:03:24 2024
From: ermt at ghgsat.com (Ewan Tarrant)
Date: Thu, 22 Aug 2024 16:03:24 +0000
Subject: [gdal-dev] Help using gdal_grid when src_datasource is a NetCDF File
Message-ID: <QB1PR01MB26415825CA005CD64A4D5733B58F2@QB1PR01MB2641.CANPRD01.PROD.OUTLOOK.COM>

Hello gdal community!

I would like to use gdal_grid (https://gdal.org/programs/gdal_grid.html) to rasterize scattered data stored in a NetCDF file. My scattered data consists of a single scalar value, z, defined at an Easting and Northing coordinate pair.  I also have an EPSG code. I am having difficulty structuring my NetCDF file so that gdal_grid is able to understand it. I have tried all three methods documented in the NetCDF Raster Driver documentation - https://gdal.org/drivers/raster/netcdf.html#georeference

  1.
UNIDATA CF-1 convention
  2.
lat/lon grid array
  3.
Following metadata directly (via e.g. Northernmost_Northing,Southernmost_Northing etc)

but have been unsuccessful in getting gdal_grid to understand my netCDF file. I have built gdal 3.8.3 from source and I have enabled `-DGDAL_ENABLE_DRIVER_NETCDF=ON`.

Would it be possible to provide a minimal working example netCDF schema (or output of e.g. ncdump) that gdal_grid can recognize?

Thanks in advance for your help,

 Ewan.


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240822/c54500e3/attachment-0001.htm>

From mwtoews at gmail.com  Thu Aug 22 15:16:33 2024
From: mwtoews at gmail.com (Mike Taves)
Date: Fri, 23 Aug 2024 10:16:33 +1200
Subject: [gdal-dev] Help using gdal_grid when src_datasource is a NetCDF
 File
In-Reply-To: <QB1PR01MB26415825CA005CD64A4D5733B58F2@QB1PR01MB2641.CANPRD01.PROD.OUTLOOK.COM>
References: <QB1PR01MB26415825CA005CD64A4D5733B58F2@QB1PR01MB2641.CANPRD01.PROD.OUTLOOK.COM>
Message-ID: <CAM2FmMooLsu4+s2F2n3BXoZ=pNy4UjdJU9P7Nec_PXN4UzMfKQ@mail.gmail.com>

On Fri, 23 Aug 2024 at 04:03, Ewan Tarrant via gdal-dev
<gdal-dev at lists.osgeo.org> wrote:
> Thanks in advance for your help,

To read point data from a netCDF file, refer to the vector driver:
https://gdal.org/drivers/vector/netcdf.html

The data would need to conform to CF-1.8 for Point data:
https://cfconventions.org/Data/cf-conventions/cf-conventions-1.8/cf-conventions.html#point-data

Before getting to gdal_grid, make sure you can "see" the data with ogrinfo.

From arb at sat.dundee.ac.uk  Fri Aug 23 08:22:48 2024
From: arb at sat.dundee.ac.uk (Andrew Brooks)
Date: Fri, 23 Aug 2024 16:22:48 +0100
Subject: [gdal-dev] Noise at the top of NOAA19 (L1B) image
In-Reply-To: <PH8P221MB106327DB90C2FD3D864C0CF2B18E2@PH8P221MB1063.NAMP221.PROD.OUTLOOK.COM>
References: <PH8P221MB10636469189CA3D6F2EAB0ADB18D2@PH8P221MB1063.NAMP221.PROD.OUTLOOK.COM>
 <CAHOfOo1H_U5_Wu=+b=ztwQATCB-0MrMjfR8PFHz_PWm7HHGnrQ@mail.gmail.com>
 <PH8P221MB106327DB90C2FD3D864C0CF2B18E2@PH8P221MB1063.NAMP221.PROD.OUTLOOK.COM>
Message-ID: <CAHOfOo1oVdVymMN46LCnspJRS4ufOrq+Axq2mkh=0TVtQcyFeA@mail.gmail.com>

Yes, the raw data is likely corrupt. When you see the "image without noise"
pygac is probably automatically cropping off the noise for you.

On Wed, 21 Aug 2024 at 21:10, Francisco Vicent <franciscovicent at outlook.com>
wrote:

> Do you suggest the image itself might be corrupt?
>
> I can see the top of the image without noise if I extract the individual
> bands using pygac and then I create a TCI with GDAL:
>
> https://i.imgur.com/OspvQi7.png
> El 21/8/2024 a las 10:49, Andrew Brooks escribi?:
>
> That's completely normal for data which has been received from satellites
> that do not have on-board error detection/correction such as NOAA-n (n<20)
>
> On Tue, 20 Aug 2024 at 22:05, Francisco Vicent via gdal-dev <
> gdal-dev at lists.osgeo.org> wrote:
>
>> Hello there, GDAL community!
>>
>> I'm experiencing some issues while warping a NOAA 19 image. I'm running
>> a simple:
>>
>> gdalwarp NSS.LHRR.NP.D16020.S1834.E1846.B3581920.WI warped.tif
>>
>> When I display the result in QGIS, it seems that the image is a little
>> cropped and has some noise at the top:
>>
>> https://imgur.com/a/gZW6Sya
>>
>> I've also tried with NOAA 14 and 16 datasets and they look as expected,
>> so I guess that the NOAA-19 format might not be fully supported.
>>
>> Anyway, I would like to hear from you if there's something I am missing,
>> before filing an issue or attempting a fix.
>>
>> Thanks in advance.
>>
>> Regards,
>> Francisco
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240823/6d1b1eb5/attachment.htm>

From franciscovicent at outlook.com  Fri Aug 23 12:27:59 2024
From: franciscovicent at outlook.com (Francisco Vicent)
Date: Fri, 23 Aug 2024 16:27:59 -0300
Subject: [gdal-dev] Noise at the top of NOAA19 (L1B) image
In-Reply-To: <CAHOfOo1oVdVymMN46LCnspJRS4ufOrq+Axq2mkh=0TVtQcyFeA@mail.gmail.com>
References: <PH8P221MB10636469189CA3D6F2EAB0ADB18D2@PH8P221MB1063.NAMP221.PROD.OUTLOOK.COM>
 <CAHOfOo1H_U5_Wu=+b=ztwQATCB-0MrMjfR8PFHz_PWm7HHGnrQ@mail.gmail.com>
 <PH8P221MB106327DB90C2FD3D864C0CF2B18E2@PH8P221MB1063.NAMP221.PROD.OUTLOOK.COM>
 <CAHOfOo1oVdVymMN46LCnspJRS4ufOrq+Axq2mkh=0TVtQcyFeA@mail.gmail.com>
Message-ID: <PH8P221MB1063D906B40020DED4230AB8B1882@PH8P221MB1063.NAMP221.PROD.OUTLOOK.COM>

I understand.

Thanks for your help!

El 23/8/2024 a las 12:22, Andrew Brooks escribi?:
> Yes, the raw data is likely corrupt. When you see the "image without 
> noise" pygac is probably automatically cropping off the noise for you.
>
> On Wed, 21 Aug 2024 at 21:10, Francisco Vicent 
> <franciscovicent at outlook.com> wrote:
>
>     Do you suggest the image itself might be corrupt?
>
>     I can see the top of the image without noise if I extract the
>     individual bands using pygac and then I create a TCI with GDAL:
>
>     https://i.imgur.com/OspvQi7.png
>
>     El 21/8/2024 a las 10:49, Andrew Brooks escribi?:
>>     That's completely normal for data which has been received from
>>     satellites that do not have on-board error detection/correction
>>     such as NOAA-n (n<20)
>>
>>     On Tue, 20 Aug 2024 at 22:05, Francisco Vicent via gdal-dev
>>     <gdal-dev at lists.osgeo.org> wrote:
>>
>>         Hello there, GDAL community!
>>
>>         I'm experiencing some issues while warping a NOAA 19 image.
>>         I'm running
>>         a simple:
>>
>>         gdalwarp NSS.LHRR.NP.D16020.S1834.E1846.B3581920.WI warped.tif
>>
>>         When I display the result in QGIS, it seems that the image is
>>         a little
>>         cropped and has some noise at the top:
>>
>>         https://imgur.com/a/gZW6Sya
>>
>>         I've also tried with NOAA 14 and 16 datasets and they look as
>>         expected,
>>         so I guess that the NOAA-19 format might not be fully supported.
>>
>>         Anyway, I would like to hear from you if there's something I
>>         am missing,
>>         before filing an issue or attempting a fix.
>>
>>         Thanks in advance.
>>
>>         Regards,
>>         Francisco
>>
>>
>>         _______________________________________________
>>         gdal-dev mailing list
>>         gdal-dev at lists.osgeo.org
>>         https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240823/e570c2b2/attachment.htm>

From shawn.fox at baesystems.us  Fri Aug 23 18:14:02 2024
From: shawn.fox at baesystems.us (Fox, Shawn D (US))
Date: Sat, 24 Aug 2024 01:14:02 +0000
Subject: [gdal-dev] Upgrading to GDAL 3.4.2 from 1.10.0 shows different
 outputs from gdaltransform and corresponding C++ API
Message-ID: <mailman.5.1724462049.32172.gdal-dev@lists.osgeo.org>

Hello GDAL users.

I have noticed that from GDAL 1.10 - GDAL 3.1.0 that gdaltransform is producing different results for NAD27 GCS to WGS84 GCS transformations.  The differences in longitude in the output is more significant.  Having tested the differences in feet between the points output from each version I can see a difference of ~5 feet primarily due to the change in the longitude value.
Would anyone look at the following results and share your thoughts about why the result of this transformation is different in a newer version?  Could this be related to the concept of WGS 84 realization being different in newer versions of GDAL?  I am also linking GDAL 3.4.2 with PROJ 8.1.1 at this time.  These results were produced with GDAL 3.4.2, but the same results occur with GDAL 3.1.0 as well.  GDAL 3.4.2 is what I am currently trying to upgrade to.  The results from the C++ programming API are similar in difference.  I just used gdaltransform for the purposes of this message because it was a more convenient way of producing something that others might be able to reproduce.

GDAL 1.10.0 results
./gdaltransform -s_srs NAD27 -t_srs WGS84

-117.258911 32.804191
-117.25978144845 32.8042393819884 1.32247805595398e-07

GDAL 3.4.2 results
./gdaltransform -s_srs NAD27 -t_srs WGS84
-117.258911 32.804191
-117.259764476223 32.8042388409449 0

I have read that the support for specifying epochs related to realizations is not available until GDAL 3.8.0.

Here are some references I've read so far.
Transforming between WGS84 Realizations | Journal of Surveying Engineering | Vol 148, No 2 (ascelibrary.org)<https://ascelibrary.org/doi/10.1061/%28ASCE%29SU.1943-5428.0000389>
RFC 81: Support for coordinate epochs in geospatial formats - GDAL documentation<https://gdal.org/development/rfc/rfc81_coordinate_epoch.html>

Thanks,
Shawn Fox
San Diego, CA

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240824/4886e08a/attachment.htm>

From gdt at lexort.com  Sat Aug 24 05:15:32 2024
From: gdt at lexort.com (Greg Troxel)
Date: Sat, 24 Aug 2024 08:15:32 -0400
Subject: [gdal-dev] Upgrading to GDAL 3.4.2 from 1.10.0 shows different
 outputs from gdaltransform and corresponding C++ API
In-Reply-To: <20240824011409.EA2186142C96@lists.osgeo.org> (Shawn D. via
 gdal-dev Fox's message of "Sat, 24 Aug 2024 01:14:02 +0000")
References: <20240824011409.EA2186142C96@lists.osgeo.org>
Message-ID: <rmiplpy86cb.fsf@s1.lexort.com>

"Fox, Shawn D (US) via gdal-dev" <gdal-dev at lists.osgeo.org> writes:

> I have noticed that from GDAL 1.10 - GDAL 3.1.0 that gdaltransform is
> producing different results for NAD27 GCS to WGS84 GCS
> transformations.  The differences in longitude in the output is more
> significant.  Having tested the differences in feet between the points
> output from each version I can see a difference of ~5 feet primarily
> due to the change in the longitude value.

> Would anyone look at the following results and share your thoughts
> about why the result of this transformation is different in a newer
> version?  Could this be related to the concept of WGS 84 realization
> being different in newer versions of GDAL?  I am also linking GDAL
> 3.4.2 with PROJ 8.1.1 at this time.  These results were produced with
> GDAL 3.4.2, but the same results occur with GDAL 3.1.0 as well.  GDAL
> 3.4.2 is what I am currently trying to upgrade to.  The results from
> the C++ programming API are similar in difference.  I just used
> gdaltransform for the purposes of this message because it was a more
> convenient way of producing something that others might be able to
> reproduce.

You didn't explain

  - When you were using gdal 1.10 (what year was that??), what version
    of proj were you using?

  - What happens when you just use proj, and not gdal?  It's always best
    to simplify the problem.  Include the results of "projinfo".

  - What you get when using NGS's tools, which are more or less the gold
    standard for the right answer.

  - What your approach is to "WGS84", which is an ensemble.  It contains
    members that differ by about 2m, including one that more or less
    matches NAD83(1986) and ones that very closely match recent ITRF.

  - What you are thinking about plate motion -- and if that even makes
    sense given the low accuracy of NAD27.   And after you explain that,
    why you are using WGS84 rather than NAD83(2011) epoch 2010.0.

> GDAL 1.10.0 results
> ./gdaltransform -s_srs NAD27 -t_srs WGS84
>
> -117.258911 32.804191
> -117.25978144845 32.8042393819884 1.32247805595398e-07
>
> GDAL 3.4.2 results
> ./gdaltransform -s_srs NAD27 -t_srs WGS84
> -117.258911 32.804191
> -117.259764476223 32.8042388409449 0

If you are seeing less than 2m difference it's really hard to say either
is wrong, and it's not really a bug that it changed.

  NAD27 is a low-accuracy datum, with internal distortions.

  Generally, there are grid shift files to use with NAD27-NAD83
  conversions because of this.  They are not included in the main proj
  tarball, and are available in various data tarballs and via the net.
  Having them and not having them is quite different.

  proj treats NAD83 to WGS84 as a null transform because WGS84 has a
  member that matches NAD83.  But if you care about 1m, you have to:

    stop using the WGS84 ensemble

    once explicit about which member you mean, perhaps WGS84(G2139), pay
    attention to NAD83 to ITRF transforms.
  
> I have read that the support for specifying epochs related to realizations is not available until GDAL 3.8.0.

And, you aren't specifying them anyway :-)  Your problems are far
greater than epochs, which are only going to make sense once you resolve
the ensemble issues.

And, it's nearly impossible to believe that any data which is originally
in NAD27 is going to have errors that are as low as 2m in the first
place.


> Here are some references I've read so far.
> Transforming between WGS84 Realizations | Journal of Surveying Engineering | Vol 148, No 2 (ascelibrary.org)<https://ascelibrary.org/doi/10.1061/%28ASCE%29SU.1943-5428.0000389>

That's paywalled so not useful to th rest of us :-(

But the point is that it makes senes to transform between data that is
actually in different members of the ensemble, because it was gathered
in those members.

It does not make sense to transform *to* this ensemble, unless you
declare loudly and then act consistently with a belief that 2m of
difference is effectively zero -- in which case you have not presented a
problem.

From shawn.fox at baesystems.us  Mon Aug 26 09:03:15 2024
From: shawn.fox at baesystems.us (Fox, Shawn D (US))
Date: Mon, 26 Aug 2024 16:03:15 +0000
Subject: [gdal-dev] gdal-dev Digest, Vol 243, Issue 19
In-Reply-To: <mailman.1.1724526001.8358.gdal-dev@lists.osgeo.org>
Message-ID: <mailman.6.1724688260.32172.gdal-dev@lists.osgeo.org>

----------------------------------------------------------------------

Message: 1
Date: Sat, 24 Aug 2024 08:15:32 -0400
From: Greg Troxel <gdt at lexort.com>
To: "Fox, Shawn D (US) via gdal-dev" <gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] Upgrading to GDAL 3.4.2 from 1.10.0 shows
	different outputs from gdaltransform and corresponding C++ API
Message-ID: <rmiplpy86cb.fsf at s1.lexort.com>
Content-Type: text/plain

"Fox, Shawn D (US) via gdal-dev" <gdal-dev at lists.osgeo.org> writes:

> I have noticed that from GDAL 1.10 - GDAL 3.1.0 that gdaltransform is 
> producing different results for NAD27 GCS to WGS84 GCS 
> transformations.  The differences in longitude in the output is more 
> significant.  Having tested the differences in feet between the points 
> output from each version I can see a difference of ~5 feet primarily 
> due to the change in the longitude value.

> Would anyone look at the following results and share your thoughts 
> about why the result of this transformation is different in a newer 
> version?  Could this be related to the concept of WGS 84 realization 
> being different in newer versions of GDAL?  I am also linking GDAL
> 3.4.2 with PROJ 8.1.1 at this time.  These results were produced with 
> GDAL 3.4.2, but the same results occur with GDAL 3.1.0 as well.  GDAL
> 3.4.2 is what I am currently trying to upgrade to.  The results from 
> the C++ programming API are similar in difference.  I just used 
> gdaltransform for the purposes of this message because it was a more 
> convenient way of producing something that others might be able to 
> reproduce.

You didn't explain

  - When you were using gdal 1.10 (what year was that??), what version
    of proj were you using?
Sfox: Proj was version 4.4.9, but why does it matter what year I was using GDAL 1.10?  We are using it now in 2024 but it is the same library that was used in 2017, 2018, etc.  The library doesn't produce different results in different years.  I've only seen different results when changing the version.

  - What happens when you just use proj, and not gdal?  It's always best
    to simplify the problem.  Include the results of "projinfo".
Sfox: I haven't tried that because I assume that GDAL is simply using proj to do these transformations, but I will investigate that and try it out. The problem is that we have the GDAL API to work with so I'm not sure if it matters what the proj APIs directly return to us.

  - What you get when using NGS's tools, which are more or less the gold
    standard for the right answer.

Sfox: What does NGS stand far and where can I find those tools?

  - What your approach is to "WGS84", which is an ensemble.  It contains
    members that differ by about 2m, including one that more or less
    matches NAD83(1986) and ones that very closely match recent ITRF.
Sfox: What is an ensemble?  The GDAL API requires me to set the source and target SRS and provide the input coordinates but that is it.
Below is some example source code so that you can see the native C++ APIs being used.  

      /* if source is GCS NAD 27, then OSRSetWellKnownGeogCS */
      errorSource = OSRSetWellKnownGeogCS( sourceSRS, "NAD27");
      /* if target is GCS WGS 84, then OSRSetWellKnownGeogCS */
      errorTarget = OSRSetWellKnownGeogCS( targetSRS, "WGS84");
      
      /* create OGRCoordinateTransformationH object */
      /* returns the obj on success, NULL on failure */
      OGRCoordinateTransformationH ptrCT =
        OCTNewCoordinateTransformation( sourceSRS, targetSRS );

      /* check to make sure that it exists */
      if (NULL != ptrCT)
      {
        /* perform the transform */
        /* returns TRUE on success, FALSE on failure of some or all points */
        status = OCTTransform( ptrCT, NUMBER_OF_POINTS, x_lon, y_lat, NULL );
      }

  - What you are thinking about plate motion -- and if that even makes
    sense given the low accuracy of NAD27.   And after you explain that,
    why you are using WGS84 rather than NAD83(2011) epoch 2010.0.
Sfox: I wasn't thinking about anything related to that.  The results of the transformation haven't changed between GDAL 3.1.0 and GDAL 3.4.2 both using PROJ 8.1.1.  My question is simply why would  the calculations change since changing the PROJ version used with GDAL?  If it is as simple as the default realization has changed then that would be useful information. 

> GDAL 1.10.0 results
> ./gdaltransform -s_srs NAD27 -t_srs WGS84
>
> -117.258911 32.804191
> -117.25978144845 32.8042393819884 1.32247805595398e-07
>
> GDAL 3.4.2 results
> ./gdaltransform -s_srs NAD27 -t_srs WGS84
> -117.258911 32.804191
> -117.259764476223 32.8042388409449 0

If you are seeing less than 2m difference it's really hard to say either is wrong, and it's not really a bug that it changed.

  NAD27 is a low-accuracy datum, with internal distortions.

  Generally, there are grid shift files to use with NAD27-NAD83
  conversions because of this.  They are not included in the main proj
  tarball, and are available in various data tarballs and via the net.
  Having them and not having them is quite different.

  proj treats NAD83 to WGS84 as a null transform because WGS84 has a
  member that matches NAD83.  But if you care about 1m, you have to:

    stop using the WGS84 ensemble

    once explicit about which member you mean, perhaps WGS84(G2139), pay
    attention to NAD83 to ITRF transforms.

Sfox: I have a requirement to use WGS84 which is why it is being used.  What do you mean by the question, "which member you mean"?  The API in GDAL 3.4.2 does not allow me to select a specific WGS84 realization yet.  So how would I know if GDAL is using G2139?  I have not seen any documentation within the GDAL docs that tell me that.  You are using terminology such as "member" and "ensemble" which I am unfamiliar with.  
  
> I have read that the support for specifying epochs related to realizations is not available until GDAL 3.8.0.

And, you aren't specifying them anyway :-)  Your problems are far greater than epochs, which are only going to make sense once you resolve the ensemble issues.

Sfox: Of course not, because GDAL doesn't allow me to specify them.  What do you mean by ensemble vs realization?  You mentioned G1239 which is a realization and yet refer to it as an ensemble.

And, it's nearly impossible to believe that any data which is originally in NAD27 is going to have errors that are as low as 2m in the first place.

Sfox: I don't see the relevance.  Unless the code changed within GDAL and/or PROJ, there is no reason that the exact same transform with the exact same input should produce a different output. I see what you mean that if you start with something that isn't accurate to 2m then a calculation from that isn't going to be accurate either, but the fact remains that from one version of GDAL or PROJ to another the results changed.  It would be nice to know why so that we can be comfortable moving forward with an upgrade to a newer version of GDAL and PROJ.

> Here are some references I've read so far.
> Transforming between WGS84 Realizations | Journal of Surveying 
> Engineering | Vol 148, No 2 
> (ascelibrary.org)<https://ascelibrary.org/doi/10.1061/%28ASCE%29SU.194
> 3-5428.0000389>

That's paywalled so not useful to th rest of us :-(

But the point is that it makes senes to transform between data that is actually in different members of the ensemble, because it was gathered in those members.

It does not make sense to transform *to* this ensemble, unless you declare loudly and then act consistently with a belief that 2m of difference is effectively zero -- in which case you have not presented a problem.


------------------------------

Subject: Digest Footer

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev


------------------------------

End of gdal-dev Digest, Vol 243, Issue 19
*****************************************

From even.rouault at spatialys.com  Mon Aug 26 09:26:47 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 26 Aug 2024 18:26:47 +0200
Subject: [gdal-dev] Upgrading to GDAL 3.4.2 from 1.10.0 shows different
 outputs from gdaltransform and corresponding C++ API
In-Reply-To: <20240824011409.B40636142C92@lists.osgeo.org>
References: <20240824011409.B40636142C92@lists.osgeo.org>
Message-ID: <e2bbdd85-c464-4fb6-bfb8-19bcc3676b51@spatialys.com>

Shawn,

The results depends on which PROJ grids are available on your system (or 
if you allowed network access).

1) The result you get with GDAL 1.10 can be reproduced with modern PROJ 
versions by allowing (and restricting) to using the CONUS / 
us_noaa_conus.tif grid which corresponds to the "NAD27 to WGS 84 (79)" 
EPSG transformation, with an advertized accuracy of 5.0 m:

$ echo 32.804191 -117.258911 0 | PROJ_NETWORK=ON cct -d 8 +proj=pipeline 
+step +proj=axisswap +order=2,1 +step +proj=unitconvert +xy_in=deg 
+xy_out=rad +step +proj=hgridshift +grids=us_noaa_conus.tif +step 
+proj=unitconvert +xy_in=rad +xy_out=deg +step +proj=axisswap +order=2,1
32.80423938?? -117.25978145??? 0.00000000?????????? inf

2) The result you get with GDAL 3.4.2 / PROJ 8.1.1 can be actually 
reproduced by using only the "NAD27 to WGS 84 (6)" EPSG Helmert 
transformation,?with an advertized accuracy of 7.0 m, which is the most 
precise one in the absence of any grid:

$ echo 32.804191 -117.258911 | cs2cs -d 8 NAD27 WGS84
32.80423884??? -117.25976448 0.00000000

or explicitly with the pipeline show by "projinfo NAD27 WGS84 --bbox 
-118,32,-117,33 --spatial-test intersects --single-line":

$ echo 32.804191 -117.258911 0 |? cct -d 8 +proj=pipeline +step 
+proj=axisswap +order=2,1 +step +proj=unitconvert +xy_in=deg +xy_out=rad 
+step +proj=push +v_3 +step +proj=cart +ellps=clrk66 +step +proj=helmert 
+x=-8 +y=159 +z=175 +step +inv +proj=cart +ellps=WGS84 +step +proj=pop 
+v_3 +step +proj=unitconvert +xy_in=rad +xy_out=deg +step +proj=axisswap 
+order=2,1
32.80423884?? -117.25976448??? 0.00000000?????????? inf

3) You would get the """"most precise result"""" (with lots of quotes, 
because this is highly subjective, and assumes that NAD83(HARN) is 
equivalent to WGS 84, according to the comment in the EPSG database) 
with the "NAD27 to WGS 84 (41)" EPSG transformation, with an advertized 
accuracy of 1.5m, which combines the CONUS grid and us_noaa_cshpgn:

$ echo 32.804191 -117.258911 | PROJ_NETWORK=ON cs2cs -d 8 NAD27 WGS84
32.80424065??? -117.25978105 0.00000000

or explicitly with the pipeline show by "projinfo NAD27 WGS84 --bbox 
-118,32,-117,33 --spatial-test intersects --single-line":

$ echo 32.804191 -117.258911 0 | PROJ_NETWORK=ON cct -d 8 +proj=pipeline 
+step +proj=axisswap +order=2,1 +step +proj=unitconvert +xy_in=deg 
+xy_out=rad +step +proj=hgridshift +grids=us_noaa_conus.tif +step 
+proj=hgridshift +grids=us_noaa_cshpgn.tif +step +proj=unitconvert 
+xy_in=rad +xy_out=deg +step +proj=axisswap +order=2,1
32.80424065?? -117.25978105??? 0.00000000?????????? inf

==> All those results are valid. Some are more precise than others, 
under certain assumptions... But basically speaking about WGS 84 
introduces an intrinsic inaccuracy of about 2 meters (cf 
https://www.youtube.com/watch?v=M2ck3cAGvhg). I don't think there are 
any published time-dependent transformations for NAD27 to WGS84 or any 
of its realization.

Even

Le 24/08/2024 ? 03:14, Fox, Shawn D (US) via gdal-dev a ?crit?:
>
> Hello GDAL users.
>
> I have noticed that from GDAL 1.10 ? GDAL 3.1.0 that gdaltransform is 
> producing different results for NAD27 GCS to WGS84 GCS 
> transformations.? The differences in longitude in the output is more 
> significant.? Having tested the differences in feet between the points 
> output from each version I can see a difference of ~5 feet primarily 
> due to the change in the longitude value.
>
> Would anyone look at the following results and share your thoughts 
> about why the result of this transformation is different in a newer 
> version?? Could this be related to the concept of WGS 84 realization 
> being different in newer versions of GDAL?? I am also linking GDAL 
> 3.4.2 with PROJ 8.1.1 at this time.? These results were produced with 
> GDAL 3.4.2, but the same results occur with GDAL 3.1.0 as well.? GDAL 
> 3.4.2 is what I am currently trying to upgrade to.? The results from 
> the C++ programming API are similar in difference.? I just used 
> gdaltransform for the purposes of this message because it was a more 
> convenient way of producing something that others might be able to 
> reproduce.
>
> *GDAL 1.10.0 results*
>
> ./gdaltransform -s_srs NAD27 -t_srs WGS84
>
> -117.258911 32.804191
>
> -117.25978144845 32.8042393819884 1.32247805595398e-07
>
> *GDAL 3.4.2 results*
>
> ./gdaltransform -s_srs NAD27 -t_srs WGS84
>
> -117.258911 32.804191
>
> -117.259764476223 32.8042388409449 0
>
> I have read that the support for specifying epochs related to 
> realizations is not available until GDAL 3.8.0.
>
> Here are some references I?ve read so far.
>
> Transforming between WGS84 Realizations | Journal of Surveying 
> Engineering | Vol 148, No 2 (ascelibrary.org) 
> <https://ascelibrary.org/doi/10.1061/%28ASCE%29SU.1943-5428.0000389>
>
> RFC 81: Support for coordinate epochs in geospatial formats ? GDAL 
> documentation 
> <https://gdal.org/development/rfc/rfc81_coordinate_epoch.html>
>
> Thanks,
>
> Shawn Fox
>
> San Diego, CA
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240826/6677cc17/attachment-0001.htm>

From gdt at lexort.com  Mon Aug 26 10:37:19 2024
From: gdt at lexort.com (Greg Troxel)
Date: Mon, 26 Aug 2024 13:37:19 -0400
Subject: [gdal-dev] Upgrading to GDAL 3.4.2 from 1.10.0 shows different
 outputs from gdaltransform and corresponding C++ API
In-Reply-To: <e2bbdd85-c464-4fb6-bfb8-19bcc3676b51@spatialys.com> (Even
 Rouault via gdal-dev's message of "Mon, 26 Aug 2024 18:26:47 +0200")
References: <20240824011409.B40636142C92@lists.osgeo.org>
 <e2bbdd85-c464-4fb6-bfb8-19bcc3676b51@spatialys.com>
Message-ID: <rmijzg3yyls.fsf@s1.lexort.com>

Even Rouault via gdal-dev <gdal-dev at lists.osgeo.org> writes:

> 3) You would get the """"most precise result"""" (with lots of quotes,
> because this is highly subjective, and assumes that NAD83(HARN) is
> equivalent to WGS 84, according to the comment in the EPSG database)
> with the "NAD27 to WGS 84 (41)" EPSG transformation, with an
> advertized accuracy of 1.5m, which combines the CONUS grid and
> us_noaa_cshpgn:

It is only WGS84(TRANSIT) that can reasonably be equated to NAD83(1986),
more or less, and then pretty much all NAD83 are the same.  As I
understand it, the same transit data was used to contrain NAD83(1986)
and WGS84(TRANSIT), and then NAD83 future realizations were aligned
to the previous ones and WGS84 future realizations were aligned to ITRF,
thus memorializing the original TRANSIT mismatch from ITRS goals.

However, when people in 2024 want "WGS84", they almost certainly don't want
WGS84(TRANSIT), but rather "some recent realization which is ~== ITRF at
the cm level".

> I don't think there are any published time-dependent transformations
> for NAD27 to WGS84 or any of its realization.

I don't think so either, but NAD27->NAD83->ITRF has two hops that have
reasonable transformations.  THe first is static-static, on the same
plate, and the second should have a time-dependent transformation
available.

From michkowalczuk at gmail.com  Tue Aug 27 08:40:06 2024
From: michkowalczuk at gmail.com (=?UTF-8?Q?Micha=C5=82_Kowalczuk?=)
Date: Tue, 27 Aug 2024 17:40:06 +0200
Subject: [gdal-dev] GDAL WMTS detecting errors
Message-ID: <CAP+FqQDyrJh3_fD3trPkHECMYNOeMLuXrHKXMByY+4-U52Dk6g@mail.gmail.com>

Hi!
I'm wondering if the last issue 10348 was fully solved.
Try use the following WMTS server and to zoom to level 9-10, e.g. small
island in the Mediterranean

https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml

For a sample tile

https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/10/392/514

arcgis server returns error code 400.


GDALRasterIO passes so I do not know if there was an error inside. Only
logger gives some information, but how to detect such a situation?

A sample logger file attached

Kind regards,
Micha?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240827/703048ed/attachment-0001.htm>
-------------- next part --------------
[Tue Aug 27 17:24:31 2024].8040, 15.4100: GDAL: Selecting overview 8192 x 8192
[Tue Aug 27 17:24:31 2024].8040, 15.4100: GDAL: Selecting overview 8192 x 8192
[Tue Aug 27 17:24:31 2024].8040, 15.4100: GDAL: Selecting overview 8192 x 8192
[Tue Aug 27 17:28:13 2024].5380, 237.1440: GDAL: Selecting overview 524288 x 524288
[Tue Aug 27 17:28:13 2024].5500, 237.1560: HTTP: Requesting [1/11] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1035
[Tue Aug 27 17:28:13 2024].5500, 237.1560: HTTP: Requesting [2/11] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1036
[Tue Aug 27 17:28:14 2024].2310, 237.8370: HTTP: Requesting [3/11] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1037
[Tue Aug 27 17:28:14 2024].3600, 237.9660: HTTP: Requesting [4/11] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1038
[Tue Aug 27 17:28:14 2024].8450, 238.4510: HTTP: Requesting [5/11] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1039
[Tue Aug 27 17:28:14 2024].9450, 238.5510: HTTP: Requesting [6/11] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1040
[Tue Aug 27 17:28:15 2024].2540, 238.8600: HTTP: Requesting [7/11] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1041
[Tue Aug 27 17:28:15 2024].5610, 239.1670: HTTP: Requesting [8/11] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1042
[Tue Aug 27 17:28:15 2024].8680, 239.4740: HTTP: Requesting [9/11] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1043
[Tue Aug 27 17:28:16 2024].0600, 239.6660: HTTP: Requesting [10/11] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1044
[Tue Aug 27 17:28:16 2024].3630, 239.9690: HTTP: Requesting [11/11] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1045
[Tue Aug 27 17:28:16 2024].7910, 240.3970: HTTP: Request [0] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1035 : status = 400, type = text/html;charset=utf-8, error = <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>


[Tue Aug 27 17:28:16 2024].7910, 240.3970: HTTP: Request [1] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1036 : status = 400, type = text/html;charset=utf-8, error = <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>


[Tue Aug 27 17:28:16 2024].7910, 240.3970: HTTP: Request [2] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1037 : status = 400, type = text/html;charset=utf-8, error = <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>


[Tue Aug 27 17:28:16 2024].7910, 240.3970: HTTP: Request [3] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1038 : status = 400, type = text/html;charset=utf-8, error = <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>


[Tue Aug 27 17:28:16 2024].7910, 240.3970: HTTP: Request [4] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1039 : status = 400, type = text/html;charset=utf-8, error = <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>


[Tue Aug 27 17:28:16 2024].7910, 240.3970: HTTP: Request [5] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1040 : status = 400, type = text/html;charset=utf-8, error = <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>


[Tue Aug 27 17:28:16 2024].7910, 240.3970: HTTP: Request [6] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1041 : status = 400, type = text/html;charset=utf-8, error = <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>


[Tue Aug 27 17:28:16 2024].7910, 240.3970: HTTP: Request [7] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1042 : status = 400, type = text/html;charset=utf-8, error = <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>


[Tue Aug 27 17:28:16 2024].7910, 240.3970: HTTP: Request [8] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1043 : status = 400, type = text/html;charset=utf-8, error = <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>


[Tue Aug 27 17:28:16 2024].7910, 240.3970: HTTP: Request [9] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1044 : status = 400, type = text/html;charset=utf-8, error = <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>


[Tue Aug 27 17:28:16 2024].7910, 240.3970: HTTP: Request [10] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1045 : status = 400, type = text/html;charset=utf-8, error = <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>


[Tue Aug 27 17:28:16 2024].7960, 240.4020: WMS: ReadBlockFromCache
[Tue Aug 27 17:28:16 2024].7970, 240.4030: CPLError: C:\Users\Michal\.cache\gdalwmscache\dbfbb27ff320f8a0184552c944185a02/8/7/8720fa7b9a84bef191d950d3ed7bbad6: No such file or directory
ERROR 4: C:\Users\Michal\.cache\gdalwmscache\dbfbb27ff320f8a0184552c944185a02/8/7/8720fa7b9a84bef191d950d3ed7bbad6: No such file or directory
[Tue Aug 27 17:28:16 2024].7970, 240.4030: CPLError: GDALWMS: Unable to open downloaded block.
ERROR 1: GDALWMS: Unable to open downloaded block.
[Tue Aug 27 17:28:16 2024].7970, 240.4030: WMS: After ReadBlockFromCache
[Tue Aug 27 17:28:16 2024].7980, 240.4040: CPLError: GDALWMS: Unable to download block 1035, 775.
URL: <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>


  HTTP status code: 400, error: <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>

.
Add the HTTP status code to <ZeroBlockHttpCodes> to ignore this error (see http://www.gdal.org/frmt_wms.html).
ERROR 1: GDALWMS: Unable to download block 1035, 775.
URL: <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>


  HTTP status code: 400, error: <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>

.
Add the HTTP status code to <ZeroBlockHttpCodes> to ignore this error (see http://www.gdal.org/frmt_wms.html).
[Tue Aug 27 17:28:16 2024].7990, 240.4050: CPLError: GDAL_WMS>, band 3: IReadBlock failed at X offset 1035, Y offset 775: GDALWMS: Unable to download block 1035, 775.
URL: <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>


  HTTP status code: 400, error: <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>

.
Add the HTTP status code to <ZeroBlockHttpCodes> to ignore this error (see http://www.gdal.org/frmt_wms.html).
ERROR 1: GDAL_WMS>, band 3: IReadBlock failed at X offset 1035, Y offset 775: GDALWMS: Unable to download block 1035, 775.
URL: <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>


  HTTP status code: 400, error: <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>

.
Add the HTTP status code to <ZeroBlockHttpCodes> to ignore this error (see http://www.gdal.org/frmt_wms.html).
[Tue Aug 27 17:29:43 2024].1080, 326.7140: GDAL: Selecting overview 524288 x 524288
[Tue Aug 27 17:29:43 2024].1170, 326.7230: HTTP: Requesting [1/11] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1035
[Tue Aug 27 17:29:43 2024].1170, 326.7230: HTTP: Requesting [2/11] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1036
[Tue Aug 27 17:29:43 2024].9310, 327.5370: HTTP: Requesting [3/11] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1037
[Tue Aug 27 17:29:43 2024].9320, 327.5380: HTTP: Requesting [4/11] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1038
[Tue Aug 27 17:29:44 2024].4420, 328.0480: HTTP: Requesting [5/11] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1039
[Tue Aug 27 17:29:44 2024].4430, 328.0490: HTTP: Requesting [6/11] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1040
[Tue Aug 27 17:29:44 2024].9550, 328.5610: HTTP: Requesting [7/11] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1041
[Tue Aug 27 17:29:44 2024].9550, 328.5610: HTTP: Requesting [8/11] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1042
[Tue Aug 27 17:29:45 2024].3560, 328.9620: HTTP: Requesting [9/11] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1043
[Tue Aug 27 17:29:45 2024].5710, 329.1770: HTTP: Requesting [10/11] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1044
[Tue Aug 27 17:29:45 2024].7730, 329.3790: HTTP: Requesting [11/11] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1045
[Tue Aug 27 17:29:46 2024].1850, 329.7910: HTTP: Request [0] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1035 : status = 400, type = text/html;charset=utf-8, error = <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>


[Tue Aug 27 17:29:46 2024].1850, 329.7910: HTTP: Request [1] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1036 : status = 400, type = text/html;charset=utf-8, error = <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>


[Tue Aug 27 17:29:46 2024].1850, 329.7910: HTTP: Request [2] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1037 : status = 400, type = text/html;charset=utf-8, error = <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>


[Tue Aug 27 17:29:46 2024].1850, 329.7910: HTTP: Request [3] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1038 : status = 400, type = text/html;charset=utf-8, error = <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>


[Tue Aug 27 17:29:46 2024].1850, 329.7910: HTTP: Request [4] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1039 : status = 400, type = text/html;charset=utf-8, error = <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>


[Tue Aug 27 17:29:46 2024].1850, 329.7910: HTTP: Request [5] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1040 : status = 400, type = text/html;charset=utf-8, error = <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>


[Tue Aug 27 17:29:46 2024].1850, 329.7910: HTTP: Request [6] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1041 : status = 400, type = text/html;charset=utf-8, error = <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>


[Tue Aug 27 17:29:46 2024].1860, 329.7920: HTTP: Request [7] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1042 : status = 400, type = text/html;charset=utf-8, error = <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>


[Tue Aug 27 17:29:46 2024].1860, 329.7920: HTTP: Request [8] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1043 : status = 400, type = text/html;charset=utf-8, error = <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>


[Tue Aug 27 17:29:46 2024].1860, 329.7920: HTTP: Request [9] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1044 : status = 400, type = text/html;charset=utf-8, error = <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>


[Tue Aug 27 17:29:46 2024].1860, 329.7920: HTTP: Request [10] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1045 : status = 400, type = text/html;charset=utf-8, error = <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>


[Tue Aug 27 17:29:46 2024].1890, 329.7950: WMS: ReadBlockFromCache
[Tue Aug 27 17:29:46 2024].1900, 329.7960: CPLError: C:\Users\Michal\.cache\gdalwmscache\dbfbb27ff320f8a0184552c944185a02/8/7/8720fa7b9a84bef191d950d3ed7bbad6: No such file or directory
ERROR 4: C:\Users\Michal\.cache\gdalwmscache\dbfbb27ff320f8a0184552c944185a02/8/7/8720fa7b9a84bef191d950d3ed7bbad6: No such file or directory
[Tue Aug 27 17:29:46 2024].1900, 329.7960: CPLError: GDALWMS: Unable to open downloaded block.
ERROR 1: GDALWMS: Unable to open downloaded block.
[Tue Aug 27 17:29:46 2024].1910, 329.7970: WMS: After ReadBlockFromCache
[Tue Aug 27 17:29:46 2024].1910, 329.7970: CPLError: GDALWMS: Unable to download block 1035, 775.
URL: <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>


  HTTP status code: 400, error: <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>

.
Add the HTTP status code to <ZeroBlockHttpCodes> to ignore this error (see http://www.gdal.org/frmt_wms.html).
ERROR 1: GDALWMS: Unable to download block 1035, 775.
URL: <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>


  HTTP status code: 400, error: <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>

.
Add the HTTP status code to <ZeroBlockHttpCodes> to ignore this error (see http://www.gdal.org/frmt_wms.html).
[Tue Aug 27 17:29:46 2024].1910, 329.7970: CPLError: GDAL_WMS>, band 3: IReadBlock failed at X offset 1035, Y offset 775: GDALWMS: Unable to download block 1035, 775.
URL: <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>


  HTTP status code: 400, error: <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>

.
Add the HTTP status code to <ZeroBlockHttpCodes> to ignore this error (see http://www.gdal.org/frmt_wms.html).
ERROR 1: GDAL_WMS>, band 3: IReadBlock failed at X offset 1035, Y offset 775: GDALWMS: Unable to download block 1035, 775.
URL: <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>


  HTTP status code: 400, error: <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>

.
Add the HTTP status code to <ZeroBlockHttpCodes> to ignore this error (see http://www.gdal.org/frmt_wms.html).
[Tue Aug 27 17:32:40 2024].2510, 503.8570: GDAL: Selecting overview 524288 x 524288
[Tue Aug 27 17:32:40 2024].2590, 503.8650: HTTP: Requesting [1/11] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1035
[Tue Aug 27 17:32:40 2024].2590, 503.8650: HTTP: Requesting [2/11] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1036
[Tue Aug 27 17:32:41 2024].0700, 504.6760: HTTP: Requesting [3/11] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1037
[Tue Aug 27 17:32:41 2024].0820, 504.6880: HTTP: Requesting [4/11] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1038
[Tue Aug 27 17:32:41 2024].4880, 505.0940: HTTP: Requesting [5/11] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1039
[Tue Aug 27 17:32:41 2024].6960, 505.3020: HTTP: Requesting [6/11] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1040
[Tue Aug 27 17:32:42 2024].1030, 505.7090: HTTP: Requesting [7/11] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1041
[Tue Aug 27 17:32:42 2024].1080, 505.7140: HTTP: Requesting [8/11] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1042
[Tue Aug 27 17:32:42 2024].5110, 506.1170: HTTP: Requesting [9/11] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1043
[Tue Aug 27 17:32:42 2024].5140, 506.1200: HTTP: Requesting [10/11] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1044
[Tue Aug 27 17:32:42 2024].9230, 506.5290: HTTP: Requesting [11/11] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1045
[Tue Aug 27 17:32:43 2024].3320, 506.9380: HTTP: Request [0] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1035 : status = 400, type = text/html;charset=utf-8, error = <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>


[Tue Aug 27 17:32:43 2024].3320, 506.9380: HTTP: Request [1] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1036 : status = 400, type = text/html;charset=utf-8, error = <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>


[Tue Aug 27 17:32:43 2024].3320, 506.9380: HTTP: Request [2] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1037 : status = 400, type = text/html;charset=utf-8, error = <html lang="en">

<head>

<title>

Error: Invalid URL</title>

<link href="/arcgis/rest/static/main.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<table width="100%" class="userTable">

<tr>

<td class="titlecell">ArcGIS REST Framework</td>

</tr>

</table>

<table width="100%" class="navTable">

<tr valign="top">

<td class="breadcrumbs">

<a href="/arcgis/rest/services">Home</a>

</td>

</tr>

</table>

<div class="cbody">

<br/>

<br/>

<b>Error: </b>Invalid URL<br/>

<b>Code: </b>400<br/><br/>

<div style="color:#ff6666"> </div></div>

</body>

</html>


[Tue Aug 27 17:32:43 2024].3320, 506.9380: HTTP: Request [3] https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/11/775/1038 : status = 400, type = text/html;charset=utf-8, error = <html lang="en">


From sethg at geographika.co.uk  Tue Aug 27 12:32:14 2024
From: sethg at geographika.co.uk (Seth G)
Date: Tue, 27 Aug 2024 21:32:14 +0200
Subject: [gdal-dev] FileGDBs and FIDs of -21121
Message-ID: <44dba2f2-6a2a-4f52-a9f5-47f9803e9ca3@app.fastmail.com>

Hi all,

I'm using a GDAL within MapServer to export features as a FileGDB. Using the following OUTPUTFORMAT:

    OUTPUTFORMAT
        NAME "FileGDB"
        DRIVER "OGR/OpenFileGDB"
        MIMETYPE "application/x-ogc?filegdb"
        FORMATOPTION "STORAGE=filesystem"
        FORMATOPTION "FORM=zip"
        FORMATOPTION "FILENAME=result.gdb.zip"
        FORMATOPTION "LCO:FID=FID"
    END

I ran into an issue where a single feature Id is being set to NULL. After checking various database queries and configs it looks like the issue is when a feature id is -21121 and data exported to a FileGDB. When using GeoJSON the Id is returned correctly.

I searched in the GDAL codebase and found that this is a "magic" number: https://github.com/search?q=repo%3AOSGeo%2Fgdal%20-21121&type=code

#define OGRUnsetMarker -21121

Is there any way round this other than using different Ids?

Thanks,

Seth



--
web:https://geographika.net & https://mapserverstudio.net
twitter: @geographika

From even.rouault at spatialys.com  Tue Aug 27 13:03:58 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 27 Aug 2024 22:03:58 +0200
Subject: [gdal-dev] FileGDBs and FIDs of -21121
In-Reply-To: <44dba2f2-6a2a-4f52-a9f5-47f9803e9ca3@app.fastmail.com>
References: <44dba2f2-6a2a-4f52-a9f5-47f9803e9ca3@app.fastmail.com>
Message-ID: <ac8c8aee-4990-4c4e-bb87-1b6c1d56258e@spatialys.com>

Seth,

I'm not totally sure to understand the exact scenario. -21121 is a 
special value for OGRField, which is a distinct concept that the Feature 
ID, and normally it shouldn't prevent setting Integer64 fields to the 
value as this canary is set in 2 fields of OGRField.

from osgeo import ogr
layer_defn = ogr.FeatureDefn("test")
layer_defn.AddField(ogr.FieldDefn("i64", ogr.OFTInteger64))
 ?layer_defn.AddFieldDefn(ogr.FieldDefn("i64", ogr.OFTInteger64))
f = ogr.Feature(layer_defn)
f["i64"] = -21121
f.DumpReadable()
OGRFeature(test):-1
 ? i64 (Integer64) = -21121

But what is sure is that the OpenFileGDB driver will error out if you 
pass to CreateFeature() a feature with a FID < -1,? = 0 or > INT32_MAX,? 
since the FileGDB format only supports FID in the range [1, INT32_MAX], 
and -1 is the OGRNullFID special constant to indicate that you let the 
driver automatically assign a FID.

With GeoJSON, you would likely have an issue with features of FID = -1 
which would get assign a FID by the driver. Basically most formats will 
struggle with negative or null FIDs

What is perhaps missing in MapServer is a FORMATOPTION "SET_FID=FALSE" 
for drivers such as FileGDB? (or "FID_VALID_MIN" and "FIX_VALID_MAX" ?)? 
to limit the scope of calls to OGR_F_SetFID() by MapServer.

Even


Le 27/08/2024 ? 21:32, Seth G via gdal-dev a ?crit?:
> Hi all,
>
> I'm using a GDAL within MapServer to export features as a FileGDB. Using the following OUTPUTFORMAT:
>
>      OUTPUTFORMAT
>          NAME "FileGDB"
>          DRIVER "OGR/OpenFileGDB"
>          MIMETYPE "application/x-ogc?filegdb"
>          FORMATOPTION "STORAGE=filesystem"
>          FORMATOPTION "FORM=zip"
>          FORMATOPTION "FILENAME=result.gdb.zip"
>          FORMATOPTION "LCO:FID=FID"
>      END
>
> I ran into an issue where a single feature Id is being set to NULL. After checking various database queries and configs it looks like the issue is when a feature id is -21121 and data exported to a FileGDB. When using GeoJSON the Id is returned correctly.
>
> I searched in the GDAL codebase and found that this is a "magic" number: https://github.com/search?q=repo%3AOSGeo%2Fgdal%20-21121&type=code
>
> #define OGRUnsetMarker -21121
>
> Is there any way round this other than using different Ids?
>
> Thanks,
>
> Seth
>
>
>
> --
> web:https://geographika.net & https://mapserverstudio.net
> twitter: @geographika
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From sethg at geographika.co.uk  Tue Aug 27 13:31:13 2024
From: sethg at geographika.co.uk (Seth G)
Date: Tue, 27 Aug 2024 22:31:13 +0200
Subject: [gdal-dev] FileGDBs and FIDs of -21121
In-Reply-To: <ac8c8aee-4990-4c4e-bb87-1b6c1d56258e@spatialys.com>
References: <44dba2f2-6a2a-4f52-a9f5-47f9803e9ca3@app.fastmail.com>
 <ac8c8aee-4990-4c4e-bb87-1b6c1d56258e@spatialys.com>
Message-ID: <300cfa9a-c629-4f38-a11a-8dfecd19fd3d@app.fastmail.com>

Thanks Even for the details. 

Sorry, the FID is correctly populated (with an autogenerated FID values starting from 1). However the unique ID of the feature is exported in a separate attribute field, and it is in this field that all values are present in the FileGDB except for the record with -21121:

FID UniqueId
1      -21119
2     -21120
3     NULL (this should be -21121)
...

Looks like this could be a MapServer rather than GDAL issue so I'll debug further,

Seth

--
web:https://geographika.net & https://mapserverstudio.net
twitter: @geographika

On Tue, Aug 27, 2024, at 10:03 PM, Even Rouault wrote:
> Seth,
>
> I'm not totally sure to understand the exact scenario. -21121 is a 
> special value for OGRField, which is a distinct concept that the Feature 
> ID, and normally it shouldn't prevent setting Integer64 fields to the 
> value as this canary is set in 2 fields of OGRField.
>
> from osgeo import ogr
> layer_defn = ogr.FeatureDefn("test")
> layer_defn.AddField(ogr.FieldDefn("i64", ogr.OFTInteger64))
>  ?layer_defn.AddFieldDefn(ogr.FieldDefn("i64", ogr.OFTInteger64))
> f = ogr.Feature(layer_defn)
> f["i64"] = -21121
> f.DumpReadable()
> OGRFeature(test):-1
>  ? i64 (Integer64) = -21121
>
> But what is sure is that the OpenFileGDB driver will error out if you 
> pass to CreateFeature() a feature with a FID < -1,? = 0 or > INT32_MAX,? 
> since the FileGDB format only supports FID in the range [1, INT32_MAX], 
> and -1 is the OGRNullFID special constant to indicate that you let the 
> driver automatically assign a FID.
>
> With GeoJSON, you would likely have an issue with features of FID = -1 
> which would get assign a FID by the driver. Basically most formats will 
> struggle with negative or null FIDs
>
> What is perhaps missing in MapServer is a FORMATOPTION "SET_FID=FALSE" 
> for drivers such as FileGDB? (or "FID_VALID_MIN" and "FIX_VALID_MAX" ?)? 
> to limit the scope of calls to OGR_F_SetFID() by MapServer.
>
> Even
>
>
> Le 27/08/2024 ? 21:32, Seth G via gdal-dev a ?crit?:
>> Hi all,
>>
>> I'm using a GDAL within MapServer to export features as a FileGDB. Using the following OUTPUTFORMAT:
>>
>>      OUTPUTFORMAT
>>          NAME "FileGDB"
>>          DRIVER "OGR/OpenFileGDB"
>>          MIMETYPE "application/x-ogc?filegdb"
>>          FORMATOPTION "STORAGE=filesystem"
>>          FORMATOPTION "FORM=zip"
>>          FORMATOPTION "FILENAME=result.gdb.zip"
>>          FORMATOPTION "LCO:FID=FID"
>>      END
>>
>> I ran into an issue where a single feature Id is being set to NULL. After checking various database queries and configs it looks like the issue is when a feature id is -21121 and data exported to a FileGDB. When using GeoJSON the Id is returned correctly.
>>
>> I searched in the GDAL codebase and found that this is a "magic" number: https://github.com/search?q=repo%3AOSGeo%2Fgdal%20-21121&type=code
>>
>> #define OGRUnsetMarker -21121
>>
>> Is there any way round this other than using different Ids?
>>
>> Thanks,
>>
>> Seth
>>
>>
>>
>> --
>> web:https://geographika.net & https://mapserverstudio.net
>> twitter: @geographika
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- 
> http://www.spatialys.com
> My software is free, but my time generally not.

From even.rouault at spatialys.com  Tue Aug 27 14:01:27 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 27 Aug 2024 23:01:27 +0200
Subject: [gdal-dev] FileGDBs and FIDs of -21121
In-Reply-To: <300cfa9a-c629-4f38-a11a-8dfecd19fd3d@app.fastmail.com>
References: <44dba2f2-6a2a-4f52-a9f5-47f9803e9ca3@app.fastmail.com>
 <ac8c8aee-4990-4c4e-bb87-1b6c1d56258e@spatialys.com>
 <300cfa9a-c629-4f38-a11a-8dfecd19fd3d@app.fastmail.com>
Message-ID: <928c30c2-815d-4005-bdeb-36421133fc9b@spatialys.com>

oh, I've managed to reproduce. This is a bug in the OpenFileGDB driver. 
Fix to follow soon

Le 27/08/2024 ? 22:31, Seth G a ?crit?:
> Thanks Even for the details.
>
> Sorry, the FID is correctly populated (with an autogenerated FID values starting from 1). However the unique ID of the feature is exported in a separate attribute field, and it is in this field that all values are present in the FileGDB except for the record with -21121:
>
> FID UniqueId
> 1      -21119
> 2     -21120
> 3     NULL (this should be -21121)
> ...
>
> Looks like this could be a MapServer rather than GDAL issue so I'll debug further,
>
> Seth
>
> --
> web:https://geographika.net & https://mapserverstudio.net
> twitter: @geographika
>
> On Tue, Aug 27, 2024, at 10:03 PM, Even Rouault wrote:
>> Seth,
>>
>> I'm not totally sure to understand the exact scenario. -21121 is a
>> special value for OGRField, which is a distinct concept that the Feature
>> ID, and normally it shouldn't prevent setting Integer64 fields to the
>> value as this canary is set in 2 fields of OGRField.
>>
>> from osgeo import ogr
>> layer_defn = ogr.FeatureDefn("test")
>> layer_defn.AddField(ogr.FieldDefn("i64", ogr.OFTInteger64))
>>   ?layer_defn.AddFieldDefn(ogr.FieldDefn("i64", ogr.OFTInteger64))
>> f = ogr.Feature(layer_defn)
>> f["i64"] = -21121
>> f.DumpReadable()
>> OGRFeature(test):-1
>>   ? i64 (Integer64) = -21121
>>
>> But what is sure is that the OpenFileGDB driver will error out if you
>> pass to CreateFeature() a feature with a FID < -1,? = 0 or > INT32_MAX,
>> since the FileGDB format only supports FID in the range [1, INT32_MAX],
>> and -1 is the OGRNullFID special constant to indicate that you let the
>> driver automatically assign a FID.
>>
>> With GeoJSON, you would likely have an issue with features of FID = -1
>> which would get assign a FID by the driver. Basically most formats will
>> struggle with negative or null FIDs
>>
>> What is perhaps missing in MapServer is a FORMATOPTION "SET_FID=FALSE"
>> for drivers such as FileGDB? (or "FID_VALID_MIN" and "FIX_VALID_MAX" ?)
>> to limit the scope of calls to OGR_F_SetFID() by MapServer.
>>
>> Even
>>
>>
>> Le 27/08/2024 ? 21:32, Seth G via gdal-dev a ?crit?:
>>> Hi all,
>>>
>>> I'm using a GDAL within MapServer to export features as a FileGDB. Using the following OUTPUTFORMAT:
>>>
>>>       OUTPUTFORMAT
>>>           NAME "FileGDB"
>>>           DRIVER "OGR/OpenFileGDB"
>>>           MIMETYPE "application/x-ogc?filegdb"
>>>           FORMATOPTION "STORAGE=filesystem"
>>>           FORMATOPTION "FORM=zip"
>>>           FORMATOPTION "FILENAME=result.gdb.zip"
>>>           FORMATOPTION "LCO:FID=FID"
>>>       END
>>>
>>> I ran into an issue where a single feature Id is being set to NULL. After checking various database queries and configs it looks like the issue is when a feature id is -21121 and data exported to a FileGDB. When using GeoJSON the Id is returned correctly.
>>>
>>> I searched in the GDAL codebase and found that this is a "magic" number: https://github.com/search?q=repo%3AOSGeo%2Fgdal%20-21121&type=code
>>>
>>> #define OGRUnsetMarker -21121
>>>
>>> Is there any way round this other than using different Ids?
>>>
>>> Thanks,
>>>
>>> Seth
>>>
>>>
>>>
>>> --
>>> web:https://geographika.net & https://mapserverstudio.net
>>> twitter: @geographika
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>> -- 
>> http://www.spatialys.com
>> My software is free, but my time generally not.

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From even.rouault at spatialys.com  Tue Aug 27 14:14:23 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 27 Aug 2024 23:14:23 +0200
Subject: [gdal-dev] FileGDBs and FIDs of -21121
In-Reply-To: <928c30c2-815d-4005-bdeb-36421133fc9b@spatialys.com>
References: <44dba2f2-6a2a-4f52-a9f5-47f9803e9ca3@app.fastmail.com>
 <ac8c8aee-4990-4c4e-bb87-1b6c1d56258e@spatialys.com>
 <300cfa9a-c629-4f38-a11a-8dfecd19fd3d@app.fastmail.com>
 <928c30c2-815d-4005-bdeb-36421133fc9b@spatialys.com>
Message-ID: <8a1281ba-1f52-4eab-b6eb-9d5eb403d859@spatialys.com>


Le 27/08/2024 ? 23:01, Even Rouault via gdal-dev a ?crit?:
> oh, I've managed to reproduce. This is a bug in the OpenFileGDB 
> driver. Fix to follow soon

==> https://github.com/OSGeo/gdal/pull/10662


-- 
http://www.spatialys.com
My software is free, but my time generally not.


From sethg at geographika.co.uk  Tue Aug 27 14:23:14 2024
From: sethg at geographika.co.uk (Seth G)
Date: Tue, 27 Aug 2024 23:23:14 +0200
Subject: [gdal-dev] FileGDBs and FIDs of -21121
In-Reply-To: <8a1281ba-1f52-4eab-b6eb-9d5eb403d859@spatialys.com>
References: <44dba2f2-6a2a-4f52-a9f5-47f9803e9ca3@app.fastmail.com>
 <ac8c8aee-4990-4c4e-bb87-1b6c1d56258e@spatialys.com>
 <300cfa9a-c629-4f38-a11a-8dfecd19fd3d@app.fastmail.com>
 <928c30c2-815d-4005-bdeb-36421133fc9b@spatialys.com>
 <8a1281ba-1f52-4eab-b6eb-9d5eb403d859@spatialys.com>
Message-ID: <a9559b05-9e43-4612-92e2-2488ab562c29@app.fastmail.com>

Thanks Even!
I got as far as setting up a test case in MapServer and starting the debugger before your fix arrived :-)
As an aside, is there a reason -21121 was chosen as a special value?

Seth

--
web:https://geographika.net & https://mapserverstudio.net
twitter: @geographika

On Tue, Aug 27, 2024, at 11:14 PM, Even Rouault wrote:
> Le 27/08/2024 ? 23:01, Even Rouault via gdal-dev a ?crit?:
>> oh, I've managed to reproduce. This is a bug in the OpenFileGDB 
>> driver. Fix to follow soon
>
> ==> https://github.com/OSGeo/gdal/pull/10662
>
>
> -- 
> http://www.spatialys.com
> My software is free, but my time generally not.

From even.rouault at spatialys.com  Tue Aug 27 14:38:25 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 27 Aug 2024 23:38:25 +0200
Subject: [gdal-dev] FileGDBs and FIDs of -21121
In-Reply-To: <a9559b05-9e43-4612-92e2-2488ab562c29@app.fastmail.com>
References: <44dba2f2-6a2a-4f52-a9f5-47f9803e9ca3@app.fastmail.com>
 <ac8c8aee-4990-4c4e-bb87-1b6c1d56258e@spatialys.com>
 <300cfa9a-c629-4f38-a11a-8dfecd19fd3d@app.fastmail.com>
 <928c30c2-815d-4005-bdeb-36421133fc9b@spatialys.com>
 <8a1281ba-1f52-4eab-b6eb-9d5eb403d859@spatialys.com>
 <a9559b05-9e43-4612-92e2-2488ab562c29@app.fastmail.com>
Message-ID: <1ef001cb-72c7-45b0-96be-9baa798658e9@spatialys.com>

I'm afraid you are questioning design choices dating back to the last 
millennium: 
https://github.com/OSGeo/gdal/commit/9d4076f3672b0b6b31de175fcfa677b378c0b577 
:-)

This could be any value really (perhaps except 0). I assume this was a 
nice one when looking a OGRRaw value in a debugger to actually see it 
was initialized to unset, rather than just 0-initialized or random 
initialized.

Le 27/08/2024 ? 23:23, Seth G a ?crit?:
> Thanks Even!
> I got as far as setting up a test case in MapServer and starting the debugger before your fix arrived :-)
> As an aside, is there a reason -21121 was chosen as a special value?
>
> Seth
>
> --
> web:https://geographika.net  &https://mapserverstudio.net
> twitter: @geographika
>
> On Tue, Aug 27, 2024, at 11:14 PM, Even Rouault wrote:
>> Le 27/08/2024 ? 23:01, Even Rouault via gdal-dev a ?crit?:
>>> oh, I've managed to reproduce. This is a bug in the OpenFileGDB
>>> driver. Fix to follow soon
>> ==>https://github.com/OSGeo/gdal/pull/10662
>>
>>
>> -- 
>> http://www.spatialys.com
>> My software is free, but my time generally not.

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240827/2aec1ca7/attachment-0001.htm>

From snorris at hillcrestgeo.ca  Tue Aug 27 14:37:04 2024
From: snorris at hillcrestgeo.ca (snorris at hillcrestgeo.ca)
Date: Tue, 27 Aug 2024 14:37:04 -0700
Subject: [gdal-dev] debugging ogr/libcurl 302 redirect failure
Message-ID: <7E2FB1AB-6238-49AA-A680-7124FE8D15A2@hillcrestgeo.ca>

Hi list,

Using ogrinfo/ogr2ogr, I can't find the right config options to read data at this url: https://governmentofbc.maps.arcgis.com/sharing/rest/content/items/4bba119c2e9042d683cc9378fb1e836e/data 

Example command:
ogrinfo https://governmentofbc.maps.arcgis.com/sharing/rest/content/items/4bba119c2e9042d683cc9378fb1e836e/data \
  --config CPL_VSIL_CURL_USE_HEAD=NO \
  --config CPL_CURL_VERBOSE=YES \
  --debug ON

I've tried a few additional config options, but can't tell what the problem is - the output from CURL_VERBOSE includes a GET to the appropriate new url, and it presumably uses the token without issue because it reports on the correct attachment:

CURL_INFO_HEADER_IN: Content-Disposition: attachment; filename="transportation.gdb.zip"; size=307145

I can download without issue using `curl --location-trusted` but would prefer to use ogr directly.

thanks!

Simon


From even.rouault at spatialys.com  Tue Aug 27 15:33:04 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 28 Aug 2024 00:33:04 +0200
Subject: [gdal-dev] debugging ogr/libcurl 302 redirect failure
In-Reply-To: <7E2FB1AB-6238-49AA-A680-7124FE8D15A2@hillcrestgeo.ca>
References: <7E2FB1AB-6238-49AA-A680-7124FE8D15A2@hillcrestgeo.ca>
Message-ID: <ac42b0f0-a622-460f-90c3-ab9996474dc1@spatialys.com>

Hi,

will be fixed per https://github.com/OSGeo/gdal/pull/10663

Workaround with existing versions:

$ ogrinfo 
"/vsizip/{/vsicurl/https://governmentofbc.maps.arcgis.com/sharing/rest/content/items/4bba119c2e9042d683cc9378fb1e836e/data}/CoL_TransportationNetwork 
Jan 3 2024.gdb"
INFO: Open of 
`/vsizip/{/vsicurl/https://governmentofbc.maps.arcgis.com/sharing/rest/content/items/4bba119c2e9042d683cc9378fb1e836e/data}/CoL_TransportationNetwork 
Jan 3 2024.gdb'
 ????? using driver `OpenFileGDB' successful.
Layer: TRN_BRIDGES (Point)
Layer: TRN_DISASTER_RESPONSE_ROUTES (Multi Line String)
Layer: TRN_MEDIANS (Multi Polygon)
Layer: TRN_RAILWAY (Multi Line String)
Layer: TRN_SIDEWALKS (Multi Line String)
Layer: TRN_STREETNAMES (Multi Polygon)
Layer: TRN_BICYCLE_ROUTES (Multi Line String)
Layer: TRN_ROADS (Multi Line String)

Even

Le 27/08/2024 ? 23:37, Simon Norris via gdal-dev a ?crit?:
> Hi list,
>
> Using ogrinfo/ogr2ogr, I can't find the right config options to read data at this url: https://governmentofbc.maps.arcgis.com/sharing/rest/content/items/4bba119c2e9042d683cc9378fb1e836e/data
>
> Example command:
> ogrinfo https://governmentofbc.maps.arcgis.com/sharing/rest/content/items/4bba119c2e9042d683cc9378fb1e836e/data \
>    --config CPL_VSIL_CURL_USE_HEAD=NO \
>    --config CPL_CURL_VERBOSE=YES \
>    --debug ON
>
> I've tried a few additional config options, but can't tell what the problem is - the output from CURL_VERBOSE includes a GET to the appropriate new url, and it presumably uses the token without issue because it reports on the correct attachment:
>
> CURL_INFO_HEADER_IN: Content-Disposition: attachment; filename="transportation.gdb.zip"; size=307145
>
> I can download without issue using `curl --location-trusted` but would prefer to use ogr directly.
>
> thanks!
>
> Simon
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From michkowalczuk at gmail.com  Wed Aug 28 07:52:22 2024
From: michkowalczuk at gmail.com (=?UTF-8?Q?Micha=C5=82_Kowalczuk?=)
Date: Wed, 28 Aug 2024 16:52:22 +0200
Subject: [gdal-dev] GDAL WMTS detecting errors
In-Reply-To: <CAP+FqQDyrJh3_fD3trPkHECMYNOeMLuXrHKXMByY+4-U52Dk6g@mail.gmail.com>
References: <CAP+FqQDyrJh3_fD3trPkHECMYNOeMLuXrHKXMByY+4-U52Dk6g@mail.gmail.com>
Message-ID: <CAP+FqQCF0t9wu440B+xuEeCoN8+XbEsX27JBLQxpqpiv+T81Zg@mail.gmail.com>

Dear GDAL friends,
any thoughts on this issue?

Regards,
Micha?

wt., 27 sie 2024 o 17:40 Micha? Kowalczuk <michkowalczuk at gmail.com>
napisa?(a):

> Hi!
> I'm wondering if the last issue 10348 was fully solved.
> Try use the following WMTS server and to zoom to level 9-10, e.g. small
> island in the Mediterranean
>
>
> https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml
>
> For a sample tile
>
>
> https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/10/392/514
>
> arcgis server returns error code 400.
>
>
> GDALRasterIO passes so I do not know if there was an error inside. Only
> logger gives some information, but how to detect such a situation?
>
> A sample logger file attached
>
> Kind regards,
> Micha?
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240828/26e5e3a2/attachment.htm>

From even.rouault at spatialys.com  Wed Aug 28 08:07:35 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 28 Aug 2024 17:07:35 +0200
Subject: [gdal-dev] GDAL WMTS detecting errors
In-Reply-To: <CAP+FqQCF0t9wu440B+xuEeCoN8+XbEsX27JBLQxpqpiv+T81Zg@mail.gmail.com>
References: <CAP+FqQDyrJh3_fD3trPkHECMYNOeMLuXrHKXMByY+4-U52Dk6g@mail.gmail.com>
 <CAP+FqQCF0t9wu440B+xuEeCoN8+XbEsX27JBLQxpqpiv+T81Zg@mail.gmail.com>
Message-ID: <227ff67d-02a1-4748-89f5-62fd159fa41c@spatialys.com>

If you could provide a gdal_translate command line reproducing the issue 
(likely using -srcwin + -outsize or -srcwin + -ovr to select the 
appropriate tile), that would make investigation easier

Le 28/08/2024 ? 16:52, Micha? Kowalczuk via gdal-dev a ?crit?:
> Dear GDAL friends,
> any thoughts on this issue?
>
> Regards,
> Micha?
>
> wt., 27 sie 2024 o 17:40?Micha? Kowalczuk <michkowalczuk at gmail.com> 
> napisa?(a):
>
>     Hi!
>     I'm wondering if the last issue 10348 was fully solved.
>     Try use the following WMTS server and to zoom to level 9-10, e.g.
>     small island in the Mediterranean
>
>     https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml
>     <https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml>
>
>     For a sample tile
>
>     https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/10/392/514
>
>     arcgis server returns error code 400.
>
>
>     GDALRasterIO passes so I do not know if there was an error inside.
>     Only logger gives some information, but how to detect such a
>     situation?
>
>     A sample logger file attached
>
>
>     Kind regards,
>     Micha?
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240828/035c0fdf/attachment.htm>

From michkowalczuk at gmail.com  Wed Aug 28 08:26:03 2024
From: michkowalczuk at gmail.com (=?UTF-8?Q?Micha=C5=82_Kowalczuk?=)
Date: Wed, 28 Aug 2024 17:26:03 +0200
Subject: [gdal-dev] GDAL WMTS detecting errors
In-Reply-To: <227ff67d-02a1-4748-89f5-62fd159fa41c@spatialys.com>
References: <CAP+FqQDyrJh3_fD3trPkHECMYNOeMLuXrHKXMByY+4-U52Dk6g@mail.gmail.com>
 <CAP+FqQCF0t9wu440B+xuEeCoN8+XbEsX27JBLQxpqpiv+T81Zg@mail.gmail.com>
 <227ff67d-02a1-4748-89f5-62fd159fa41c@spatialys.com>
Message-ID: <CAP+FqQCNnxcoZ8pU00qJt6cPgJ9OVxVL8FgvBuddVUw_eVhcPg@mail.gmail.com>

First produces correct output

*gdal_translate -srcwin 33492026 20550638 8019970 4412002 -outsize 1576 867
"WMTS:https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=GoogleMapsCompatible
<https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=GoogleMapsCompatible>"
tile_ok.png*

The following for higher level fails:
*gdal_translate -srcwin 36228140 21140450 191172 105168 -outsize 1576 867
"WMTS:https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=GoogleMapsCompatible
<https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=GoogleMapsCompatible>"
tile_error.png*



?r., 28 sie 2024 o 17:07 Even Rouault <even.rouault at spatialys.com>
napisa?(a):

> If you could provide a gdal_translate command line reproducing the issue
> (likely using -srcwin + -outsize or -srcwin + -ovr to select the
> appropriate tile), that would make investigation easier
> Le 28/08/2024 ? 16:52, Micha? Kowalczuk via gdal-dev a ?crit :
>
> Dear GDAL friends,
> any thoughts on this issue?
>
> Regards,
> Micha?
>
> wt., 27 sie 2024 o 17:40 Micha? Kowalczuk <michkowalczuk at gmail.com>
> napisa?(a):
>
>> Hi!
>> I'm wondering if the last issue 10348 was fully solved.
>> Try use the following WMTS server and to zoom to level 9-10, e.g. small
>> island in the Mediterranean
>>
>>
>> https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml
>>
>> For a sample tile
>>
>>
>> https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/10/392/514
>>
>> arcgis server returns error code 400.
>>
>>
>> GDALRasterIO passes so I do not know if there was an error inside. Only
>> logger gives some information, but how to detect such a situation?
>>
>> A sample logger file attached
>>
>> Kind regards,
>> Micha?
>>
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240828/8d527f36/attachment-0001.htm>

From even.rouault at spatialys.com  Wed Aug 28 08:38:36 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 28 Aug 2024 17:38:36 +0200
Subject: [gdal-dev] GDAL WMTS detecting errors
In-Reply-To: <CAP+FqQCNnxcoZ8pU00qJt6cPgJ9OVxVL8FgvBuddVUw_eVhcPg@mail.gmail.com>
References: <CAP+FqQDyrJh3_fD3trPkHECMYNOeMLuXrHKXMByY+4-U52Dk6g@mail.gmail.com>
 <CAP+FqQCF0t9wu440B+xuEeCoN8+XbEsX27JBLQxpqpiv+T81Zg@mail.gmail.com>
 <227ff67d-02a1-4748-89f5-62fd159fa41c@spatialys.com>
 <CAP+FqQCNnxcoZ8pU00qJt6cPgJ9OVxVL8FgvBuddVUw_eVhcPg@mail.gmail.com>
Message-ID: <849caa11-9006-456d-865f-7ceed701c74e@spatialys.com>


Le 28/08/2024 ? 17:26, Micha? Kowalczuk a ?crit?:
> First produces correct output
> /gdal_translate -srcwin 33492026 20550638 8019970 4412002 -outsize 
> 1576 867 
> "WMTS:https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=GoogleMapsCompatible" 
> tile_ok.png
> /
>
> The following for higher level fails:
> /gdal_translate -srcwin 36228140 21140450 191172 105168 -outsize 1576 
> 867 
> "WMTS:https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=GoogleMapsCompatible" 
> tile_error.png/

/yes, and ? gdal_translate returns in error as expected due to the 
missing tiles. If you want HTTP 400 to be silently ignored, you can do:/

/gdal_translate 
"WMTS:https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=GoogleMapsCompatible" 
tmp.wmts -of wmts/

/and edit tmp.wtms to add 400 in <ZeroBlockHttpCodes>
/

>
>
>
> ?r., 28 sie 2024 o 17:07?Even Rouault <even.rouault at spatialys.com> 
> napisa?(a):
>
>     If you could provide a gdal_translate command line reproducing the
>     issue (likely using -srcwin + -outsize or -srcwin + -ovr to select
>     the appropriate tile), that would make investigation easier
>
>     Le 28/08/2024 ? 16:52, Micha? Kowalczuk via gdal-dev a ?crit?:
>>     Dear GDAL friends,
>>     any thoughts on this issue?
>>
>>     Regards,
>>     Micha?
>>
>>     wt., 27 sie 2024 o 17:40?Micha? Kowalczuk
>>     <michkowalczuk at gmail.com> napisa?(a):
>>
>>         Hi!
>>         I'm wondering if the last issue 10348 was fully solved.
>>         Try use the following WMTS server and to zoom to level 9-10,
>>         e.g. small island in the Mediterranean
>>
>>         https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml
>>         <https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml>
>>
>>         For a sample tile
>>
>>         https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/10/392/514
>>
>>         arcgis server returns error code 400.
>>
>>
>>         GDALRasterIO passes so I do not know if there was an error
>>         inside. Only logger gives some information, but how to detect
>>         such a situation?
>>
>>         A sample logger file attached
>>
>>
>>         Kind regards,
>>         Micha?
>>
>>
>>     _______________________________________________
>>     gdal-dev mailing list
>>     gdal-dev at lists.osgeo.org
>>     https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>     -- 
>     http://www.spatialys.com
>     My software is free, but my time generally not.
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240828/f34d76e6/attachment.htm>

From michkowalczuk at gmail.com  Wed Aug 28 08:41:05 2024
From: michkowalczuk at gmail.com (=?UTF-8?Q?Micha=C5=82_Kowalczuk?=)
Date: Wed, 28 Aug 2024 17:41:05 +0200
Subject: [gdal-dev] GDAL WMTS detecting errors
In-Reply-To: <849caa11-9006-456d-865f-7ceed701c74e@spatialys.com>
References: <CAP+FqQDyrJh3_fD3trPkHECMYNOeMLuXrHKXMByY+4-U52Dk6g@mail.gmail.com>
 <CAP+FqQCF0t9wu440B+xuEeCoN8+XbEsX27JBLQxpqpiv+T81Zg@mail.gmail.com>
 <227ff67d-02a1-4748-89f5-62fd159fa41c@spatialys.com>
 <CAP+FqQCNnxcoZ8pU00qJt6cPgJ9OVxVL8FgvBuddVUw_eVhcPg@mail.gmail.com>
 <849caa11-9006-456d-865f-7ceed701c74e@spatialys.com>
Message-ID: <CAP+FqQAnDO_4KHHyi--Y9tjv0ED8w+hGWvJrYf2Tv6rYVhFH2g@mail.gmail.com>

Yes, but if you use C API function GdalRasterDatasetIO you don?t get error.
I noticed this error only in gdal logger. How I can catch this error at
runtime in code?


W dniu ?r., 28.08.2024 o 17:38 Even Rouault <even.rouault at spatialys.com>
napisa?(a):

>
> Le 28/08/2024 ? 17:26, Micha? Kowalczuk a ?crit :
>
> First produces correct output
>
> *gdal_translate -srcwin 33492026 20550638 8019970 4412002 -outsize 1576
> 867
> "WMTS:https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=GoogleMapsCompatible
> <https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=GoogleMapsCompatible>"
> tile_ok.png *
>
> The following for higher level fails:
> *gdal_translate -srcwin 36228140 21140450 191172 105168 -outsize 1576 867
> "WMTS:https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=GoogleMapsCompatible
> <https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=GoogleMapsCompatible>"
> tile_error.png*
>
> *yes, and ? gdal_translate returns in error as expected due to the missing
> tiles. If you want HTTP 400 to be silently ignored, you can do:*
>
> *gdal_translate
> "WMTS:https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=GoogleMapsCompatible
> <https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=GoogleMapsCompatible>"
> tmp.wmts -of wmts*
>
>
> *and edit tmp.wtms to add 400 in <ZeroBlockHttpCodes> *
>
>
>
>
> ?r., 28 sie 2024 o 17:07 Even Rouault <even.rouault at spatialys.com>
> napisa?(a):
>
>> If you could provide a gdal_translate command line reproducing the issue
>> (likely using -srcwin + -outsize or -srcwin + -ovr to select the
>> appropriate tile), that would make investigation easier
>> Le 28/08/2024 ? 16:52, Micha? Kowalczuk via gdal-dev a ?crit :
>>
>> Dear GDAL friends,
>> any thoughts on this issue?
>>
>> Regards,
>> Micha?
>>
>> wt., 27 sie 2024 o 17:40 Micha? Kowalczuk <michkowalczuk at gmail.com>
>> napisa?(a):
>>
>>> Hi!
>>> I'm wondering if the last issue 10348 was fully solved.
>>> Try use the following WMTS server and to zoom to level 9-10, e.g. small
>>> island in the Mediterranean
>>>
>>>
>>> https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml
>>>
>>> For a sample tile
>>>
>>>
>>> https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/10/392/514
>>>
>>> arcgis server returns error code 400.
>>>
>>>
>>> GDALRasterIO passes so I do not know if there was an error inside. Only
>>> logger gives some information, but how to detect such a situation?
>>>
>>> A sample logger file attached
>>>
>>> Kind regards,
>>> Micha?
>>>
>>
>> _______________________________________________
>> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>> -- http://www.spatialys.com
>> My software is free, but my time generally not.
>>
>> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240828/519331ac/attachment.htm>

From even.rouault at spatialys.com  Wed Aug 28 08:51:12 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 28 Aug 2024 17:51:12 +0200
Subject: [gdal-dev] GDAL WMTS detecting errors
In-Reply-To: <CAP+FqQAnDO_4KHHyi--Y9tjv0ED8w+hGWvJrYf2Tv6rYVhFH2g@mail.gmail.com>
References: <CAP+FqQDyrJh3_fD3trPkHECMYNOeMLuXrHKXMByY+4-U52Dk6g@mail.gmail.com>
 <CAP+FqQCF0t9wu440B+xuEeCoN8+XbEsX27JBLQxpqpiv+T81Zg@mail.gmail.com>
 <227ff67d-02a1-4748-89f5-62fd159fa41c@spatialys.com>
 <CAP+FqQCNnxcoZ8pU00qJt6cPgJ9OVxVL8FgvBuddVUw_eVhcPg@mail.gmail.com>
 <849caa11-9006-456d-865f-7ceed701c74e@spatialys.com>
 <CAP+FqQAnDO_4KHHyi--Y9tjv0ED8w+hGWvJrYf2Tv6rYVhFH2g@mail.gmail.com>
Message-ID: <0a85f1c6-7af8-410d-b07b-b9c10a8a4bb6@spatialys.com>


Le 28/08/2024 ? 17:41, Micha? Kowalczuk a ?crit?:
> Yes, but if you use C API function GdalRasterDatasetIO you don?t get 
> error. I noticed this error only in gdal logger. How I can catch this 
> error at runtime in code?
Really? That looks doubtful to me, because I don't see how 
gdal_translate would return in error otherwise, but I may miss some 
subtlety obviously. Can you demonstrate that with a self-contained 
reproducer?
>
>
> W dniu ?r., 28.08.2024 o 17:38 Even Rouault 
> <even.rouault at spatialys.com> napisa?(a):
>
>
>     Le 28/08/2024 ? 17:26, Micha? Kowalczuk a ?crit?:
>>     First produces correct output
>>     /gdal_translate -srcwin 33492026 20550638 8019970 4412002
>>     -outsize 1576 867
>>     "WMTS:https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=GoogleMapsCompatible"
>>     tile_ok.png
>>     /
>>
>>     The following for higher level fails:
>>     /gdal_translate -srcwin 36228140 21140450 191172 105168 -outsize
>>     1576 867
>>     "WMTS:https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=GoogleMapsCompatible"
>>     tile_error.png/
>
>     /yes, and ? gdal_translate returns in error as expected due to the
>     missing tiles. If you want HTTP 400 to be silently ignored, you
>     can do:/
>
>     /gdal_translate
>     "WMTS:https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=GoogleMapsCompatible"
>     tmp.wmts -of wmts/
>
>     /and edit tmp.wtms to add 400 in <ZeroBlockHttpCodes>
>     /
>
>>
>>
>>
>>     ?r., 28 sie 2024 o 17:07?Even Rouault
>>     <even.rouault at spatialys.com> napisa?(a):
>>
>>         If you could provide a gdal_translate command line
>>         reproducing the issue (likely using -srcwin + -outsize or
>>         -srcwin + -ovr to select the appropriate tile), that would
>>         make investigation easier
>>
>>         Le 28/08/2024 ? 16:52, Micha? Kowalczuk via gdal-dev a ?crit?:
>>>         Dear GDAL friends,
>>>         any thoughts on this issue?
>>>
>>>         Regards,
>>>         Micha?
>>>
>>>         wt., 27 sie 2024 o 17:40?Micha? Kowalczuk
>>>         <michkowalczuk at gmail.com> napisa?(a):
>>>
>>>             Hi!
>>>             I'm wondering if the last issue 10348 was fully solved.
>>>             Try use the following WMTS server and to zoom to level
>>>             9-10, e.g. small island in the Mediterranean
>>>
>>>             https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml
>>>             <https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml>
>>>
>>>             For a sample tile
>>>
>>>             https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/10/392/514
>>>
>>>             arcgis server returns error code 400.
>>>
>>>
>>>             GDALRasterIO passes so I do not know if there was an
>>>             error inside. Only logger gives some information, but
>>>             how to detect such a situation?
>>>
>>>             A sample logger file attached
>>>
>>>
>>>             Kind regards,
>>>             Micha?
>>>
>>>
>>>         _______________________________________________
>>>         gdal-dev mailing list
>>>         gdal-dev at lists.osgeo.org
>>>         https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>         -- 
>>         http://www.spatialys.com
>>         My software is free, but my time generally not.
>>
>     -- 
>     http://www.spatialys.com
>     My software is free, but my time generally not.
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240828/0f6c1a3b/attachment-0001.htm>

From michkowalczuk at gmail.com  Wed Aug 28 09:04:03 2024
From: michkowalczuk at gmail.com (=?UTF-8?Q?Micha=C5=82_Kowalczuk?=)
Date: Wed, 28 Aug 2024 18:04:03 +0200
Subject: [gdal-dev] GDAL WMTS detecting errors
In-Reply-To: <0a85f1c6-7af8-410d-b07b-b9c10a8a4bb6@spatialys.com>
References: <CAP+FqQDyrJh3_fD3trPkHECMYNOeMLuXrHKXMByY+4-U52Dk6g@mail.gmail.com>
 <CAP+FqQCF0t9wu440B+xuEeCoN8+XbEsX27JBLQxpqpiv+T81Zg@mail.gmail.com>
 <227ff67d-02a1-4748-89f5-62fd159fa41c@spatialys.com>
 <CAP+FqQCNnxcoZ8pU00qJt6cPgJ9OVxVL8FgvBuddVUw_eVhcPg@mail.gmail.com>
 <849caa11-9006-456d-865f-7ceed701c74e@spatialys.com>
 <CAP+FqQAnDO_4KHHyi--Y9tjv0ED8w+hGWvJrYf2Tv6rYVhFH2g@mail.gmail.com>
 <0a85f1c6-7af8-410d-b07b-b9c10a8a4bb6@spatialys.com>
Message-ID: <CAP+FqQCr7wtqPH+P_rTNfuniCHD69UsoxdZOspiC=tpoRu5r6w@mail.gmail.com>

Sorry, my bad!
I missed to check output CPL Error from GdalRasterIO ?

You mentioned about *ZeroBlockHttpCodes *property. Can I set it
programmatically, as a configuration option?

As always great thank you!

?r., 28 sie 2024 o 17:51 Even Rouault <even.rouault at spatialys.com>
napisa?(a):

>
> Le 28/08/2024 ? 17:41, Micha? Kowalczuk a ?crit :
>
> Yes, but if you use C API function GdalRasterDatasetIO you don?t get
> error. I noticed this error only in gdal logger. How I can catch this error
> at runtime in code?
>
> Really? That looks doubtful to me, because I don't see how gdal_translate
> would return in error otherwise, but I may miss some subtlety obviously.
> Can you demonstrate that with a self-contained reproducer?
>
>
>
> W dniu ?r., 28.08.2024 o 17:38 Even Rouault <even.rouault at spatialys.com>
> napisa?(a):
>
>>
>> Le 28/08/2024 ? 17:26, Micha? Kowalczuk a ?crit :
>>
>> First produces correct output
>>
>> *gdal_translate -srcwin 33492026 20550638 8019970 4412002 -outsize 1576
>> 867
>> "WMTS:https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=GoogleMapsCompatible
>> <https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=GoogleMapsCompatible>"
>> tile_ok.png *
>>
>> The following for higher level fails:
>> *gdal_translate -srcwin 36228140 21140450 191172 105168 -outsize 1576 867
>> "WMTS:https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=GoogleMapsCompatible
>> <https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=GoogleMapsCompatible>"
>> tile_error.png*
>>
>> *yes, and ? gdal_translate returns in error as expected due to the
>> missing tiles. If you want HTTP 400 to be silently ignored, you can do:*
>>
>> *gdal_translate
>> "WMTS:https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=GoogleMapsCompatible
>> <https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=GoogleMapsCompatible>"
>> tmp.wmts -of wmts*
>>
>>
>> *and edit tmp.wtms to add 400 in <ZeroBlockHttpCodes> *
>>
>>
>>
>>
>> ?r., 28 sie 2024 o 17:07 Even Rouault <even.rouault at spatialys.com>
>> napisa?(a):
>>
>>> If you could provide a gdal_translate command line reproducing the issue
>>> (likely using -srcwin + -outsize or -srcwin + -ovr to select the
>>> appropriate tile), that would make investigation easier
>>> Le 28/08/2024 ? 16:52, Micha? Kowalczuk via gdal-dev a ?crit :
>>>
>>> Dear GDAL friends,
>>> any thoughts on this issue?
>>>
>>> Regards,
>>> Micha?
>>>
>>> wt., 27 sie 2024 o 17:40 Micha? Kowalczuk <michkowalczuk at gmail.com>
>>> napisa?(a):
>>>
>>>> Hi!
>>>> I'm wondering if the last issue 10348 was fully solved.
>>>> Try use the following WMTS server and to zoom to level 9-10, e.g. small
>>>> island in the Mediterranean
>>>>
>>>>
>>>> https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml
>>>>
>>>> For a sample tile
>>>>
>>>>
>>>> https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/10/392/514
>>>>
>>>> arcgis server returns error code 400.
>>>>
>>>>
>>>> GDALRasterIO passes so I do not know if there was an error inside. Only
>>>> logger gives some information, but how to detect such a situation?
>>>>
>>>> A sample logger file attached
>>>>
>>>> Kind regards,
>>>> Micha?
>>>>
>>>
>>> _______________________________________________
>>> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>> -- http://www.spatialys.com
>>> My software is free, but my time generally not.
>>>
>>> -- http://www.spatialys.com
>> My software is free, but my time generally not.
>>
>> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240828/58cba23c/attachment.htm>

From michkowalczuk at gmail.com  Wed Aug 28 09:14:43 2024
From: michkowalczuk at gmail.com (=?UTF-8?Q?Micha=C5=82_Kowalczuk?=)
Date: Wed, 28 Aug 2024 18:14:43 +0200
Subject: [gdal-dev] GDAL WMTS detecting errors
In-Reply-To: <CAP+FqQCr7wtqPH+P_rTNfuniCHD69UsoxdZOspiC=tpoRu5r6w@mail.gmail.com>
References: <CAP+FqQDyrJh3_fD3trPkHECMYNOeMLuXrHKXMByY+4-U52Dk6g@mail.gmail.com>
 <CAP+FqQCF0t9wu440B+xuEeCoN8+XbEsX27JBLQxpqpiv+T81Zg@mail.gmail.com>
 <227ff67d-02a1-4748-89f5-62fd159fa41c@spatialys.com>
 <CAP+FqQCNnxcoZ8pU00qJt6cPgJ9OVxVL8FgvBuddVUw_eVhcPg@mail.gmail.com>
 <849caa11-9006-456d-865f-7ceed701c74e@spatialys.com>
 <CAP+FqQAnDO_4KHHyi--Y9tjv0ED8w+hGWvJrYf2Tv6rYVhFH2g@mail.gmail.com>
 <0a85f1c6-7af8-410d-b07b-b9c10a8a4bb6@spatialys.com>
 <CAP+FqQCr7wtqPH+P_rTNfuniCHD69UsoxdZOspiC=tpoRu5r6w@mail.gmail.com>
Message-ID: <CAP+FqQCGmjDyU48W6W4pJJVycd=PHGTd-sFaqJJgE1Cpc80cbg@mail.gmail.com>

In other words, is there a way to remove http content from CPL error
message?

?r., 28 sie 2024 o 18:04 Micha? Kowalczuk <michkowalczuk at gmail.com>
napisa?(a):

> Sorry, my bad!
> I missed to check output CPL Error from GdalRasterIO ?
>
> You mentioned about *ZeroBlockHttpCodes *property. Can I set it
> programmatically, as a configuration option?
>
> As always great thank you!
>
> ?r., 28 sie 2024 o 17:51 Even Rouault <even.rouault at spatialys.com>
> napisa?(a):
>
>>
>> Le 28/08/2024 ? 17:41, Micha? Kowalczuk a ?crit :
>>
>> Yes, but if you use C API function GdalRasterDatasetIO you don?t get
>> error. I noticed this error only in gdal logger. How I can catch this error
>> at runtime in code?
>>
>> Really? That looks doubtful to me, because I don't see how gdal_translate
>> would return in error otherwise, but I may miss some subtlety obviously.
>> Can you demonstrate that with a self-contained reproducer?
>>
>>
>>
>> W dniu ?r., 28.08.2024 o 17:38 Even Rouault <even.rouault at spatialys.com>
>> napisa?(a):
>>
>>>
>>> Le 28/08/2024 ? 17:26, Micha? Kowalczuk a ?crit :
>>>
>>> First produces correct output
>>>
>>> *gdal_translate -srcwin 33492026 20550638 8019970 4412002 -outsize 1576
>>> 867
>>> "WMTS:https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=GoogleMapsCompatible
>>> <https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=GoogleMapsCompatible>"
>>> tile_ok.png *
>>>
>>> The following for higher level fails:
>>> *gdal_translate -srcwin 36228140 21140450 191172 105168 -outsize 1576
>>> 867
>>> "WMTS:https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=GoogleMapsCompatible
>>> <https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=GoogleMapsCompatible>"
>>> tile_error.png*
>>>
>>> *yes, and ? gdal_translate returns in error as expected due to the
>>> missing tiles. If you want HTTP 400 to be silently ignored, you can do:*
>>>
>>> *gdal_translate
>>> "WMTS:https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=GoogleMapsCompatible
>>> <https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=GoogleMapsCompatible>"
>>> tmp.wmts -of wmts*
>>>
>>>
>>> *and edit tmp.wtms to add 400 in <ZeroBlockHttpCodes> *
>>>
>>>
>>>
>>>
>>> ?r., 28 sie 2024 o 17:07 Even Rouault <even.rouault at spatialys.com>
>>> napisa?(a):
>>>
>>>> If you could provide a gdal_translate command line reproducing the
>>>> issue (likely using -srcwin + -outsize or -srcwin + -ovr to select the
>>>> appropriate tile), that would make investigation easier
>>>> Le 28/08/2024 ? 16:52, Micha? Kowalczuk via gdal-dev a ?crit :
>>>>
>>>> Dear GDAL friends,
>>>> any thoughts on this issue?
>>>>
>>>> Regards,
>>>> Micha?
>>>>
>>>> wt., 27 sie 2024 o 17:40 Micha? Kowalczuk <michkowalczuk at gmail.com>
>>>> napisa?(a):
>>>>
>>>>> Hi!
>>>>> I'm wondering if the last issue 10348 was fully solved.
>>>>> Try use the following WMTS server and to zoom to level 9-10, e.g.
>>>>> small island in the Mediterranean
>>>>>
>>>>>
>>>>> https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml
>>>>>
>>>>> For a sample tile
>>>>>
>>>>>
>>>>> https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/tile/1.0.0/USGSImageryOnly/default/GoogleMapsCompatible/10/392/514
>>>>>
>>>>> arcgis server returns error code 400.
>>>>>
>>>>>
>>>>> GDALRasterIO passes so I do not know if there was an error inside.
>>>>> Only logger gives some information, but how to detect such a situation?
>>>>>
>>>>> A sample logger file attached
>>>>>
>>>>> Kind regards,
>>>>> Micha?
>>>>>
>>>>
>>>> _______________________________________________
>>>> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>
>>>> -- http://www.spatialys.com
>>>> My software is free, but my time generally not.
>>>>
>>>> -- http://www.spatialys.com
>>> My software is free, but my time generally not.
>>>
>>> -- http://www.spatialys.com
>> My software is free, but my time generally not.
>>
>>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240828/59fd7898/attachment-0001.htm>

From dbaston at gmail.com  Wed Aug 28 09:45:35 2024
From: dbaston at gmail.com (Daniel Baston)
Date: Wed, 28 Aug 2024 12:45:35 -0400
Subject: [gdal-dev] Attribute filter on remote Parquet file is slow
Message-ID: <CA+K_q_oG_vBOsJPJih_46wM6e9YonAd8Rf6gWDiyLGFKeP2ukQ@mail.gmail.com>

Hello,

I'm trying to use ogr2ogr with an attribute filter to pull 14 polygons
from Overture maps. Running the following command with CPL_DEBUG=ON
tells me that "PARQUET: Attribute filter fully translated to Arrow"
yet it takes about 7 minutes to complete, and appears to download
quite a bit of data:

ogr2ogr /tmp/vt.geojson
"PARQUET:/vsis3/overturemaps-us-west-2/release/2024-08-20.0/theme=divisions/type=division_area"
-select "id,division_id,names.primary" -where "subtype='county' AND
country='US' AND region='US-VT'"

Have I made a mistake in my ogr2ogr invocation? For comparison,
running what I believe to be an equivalent query in DuckDB takes about
10 seconds:

SELECT
      id,
      division_id,
      names.primary,
      ST_GeomFromWKB(geometry) as geometry
      FROM
          read_parquet('s3://overturemaps-us-west-2/release/2024-08-20.0/theme=divisions/type=division_area/*',
hive_partitioning=1)
      WHERE
          subtype = 'county'
          AND country = 'US'
          AND region = 'US-VT';

I am using GDAL master (e09d07a7) and libarrow 16.1.

Thanks,
Dan

From even.rouault at spatialys.com  Wed Aug 28 10:01:19 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 28 Aug 2024 19:01:19 +0200
Subject: [gdal-dev] Attribute filter on remote Parquet file is slow
In-Reply-To: <CA+K_q_oG_vBOsJPJih_46wM6e9YonAd8Rf6gWDiyLGFKeP2ukQ@mail.gmail.com>
References: <CA+K_q_oG_vBOsJPJih_46wM6e9YonAd8Rf6gWDiyLGFKeP2ukQ@mail.gmail.com>
Message-ID: <2afbddf9-ff7f-4ad5-9f42-2a309764c669@spatialys.com>

Dan,

No you didn't do anything obviously wrong. I'm not sure that in the 
ArrowDataset mode libarrow actually uses group statistics to filter out 
row groups, which might cause it to actually ingest the whole files

You may also try to tune the config options at 
https://github.com/OSGeo/gdal/blob/master/ogr/ogrsf_frmts/parquet/ogrparquetdatasetlayer.cpp#L522-L558

do you observe a similar difference if you work with just a simple file 
like 
/vsis3/overturemaps-us-west-2/release/2024-08-20.0/theme=divisions/type=division_area/part-00000-5466202d-8cdf-48e5-9aee-886c73dafc5f-c000.zstd.parquet 
?

Even

Le 28/08/2024 ? 18:45, Daniel Baston via gdal-dev a ?crit?:
> Hello,
>
> I'm trying to use ogr2ogr with an attribute filter to pull 14 polygons
> from Overture maps. Running the following command with CPL_DEBUG=ON
> tells me that "PARQUET: Attribute filter fully translated to Arrow"
> yet it takes about 7 minutes to complete, and appears to download
> quite a bit of data:
>
> ogr2ogr /tmp/vt.geojson
> "PARQUET:/vsis3/overturemaps-us-west-2/release/2024-08-20.0/theme=divisions/type=division_area"
> -select "id,division_id,names.primary" -where "subtype='county' AND
> country='US' AND region='US-VT'"
>
> Have I made a mistake in my ogr2ogr invocation? For comparison,
> running what I believe to be an equivalent query in DuckDB takes about
> 10 seconds:
>
> SELECT
>        id,
>        division_id,
>        names.primary,
>        ST_GeomFromWKB(geometry) as geometry
>        FROM
>            read_parquet('s3://overturemaps-us-west-2/release/2024-08-20.0/theme=divisions/type=division_area/*',
> hive_partitioning=1)
>        WHERE
>            subtype = 'county'
>            AND country = 'US'
>            AND region = 'US-VT';
>
> I am using GDAL master (e09d07a7) and libarrow 16.1.
>
> Thanks,
> Dan
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From public at postholer.com  Wed Aug 28 10:27:59 2024
From: public at postholer.com (Scott)
Date: Wed, 28 Aug 2024 10:27:59 -0700
Subject: [gdal-dev] Attribute filter on remote Parquet file is slow
In-Reply-To: <CA+K_q_oG_vBOsJPJih_46wM6e9YonAd8Rf6gWDiyLGFKeP2ukQ@mail.gmail.com>
References: <CA+K_q_oG_vBOsJPJih_46wM6e9YonAd8Rf6gWDiyLGFKeP2ukQ@mail.gmail.com>
Message-ID: <d8cfa875-fbe2-4dcd-915f-b9cf3c9b3345@postholer.com>

I could be completely wrong here.

My understanding is duckdb uses httpfs or possibly some variant of fsspec.

I believe /vsis3 uses only libcurl, which doesn't *appear* to have 
support for httpfs.

Again, I could be wildly wrong.

On 8/28/24 09:45, Daniel Baston via gdal-dev wrote:
> Hello,
> 
> I'm trying to use ogr2ogr with an attribute filter to pull 14 polygons
> from Overture maps. Running the following command with CPL_DEBUG=ON
> tells me that "PARQUET: Attribute filter fully translated to Arrow"
> yet it takes about 7 minutes to complete, and appears to download
> quite a bit of data:
> 
> ogr2ogr /tmp/vt.geojson
> "PARQUET:/vsis3/overturemaps-us-west-2/release/2024-08-20.0/theme=divisions/type=division_area"
> -select "id,division_id,names.primary" -where "subtype='county' AND
> country='US' AND region='US-VT'"
> 
> Have I made a mistake in my ogr2ogr invocation? For comparison,
> running what I believe to be an equivalent query in DuckDB takes about
> 10 seconds:
> 
> SELECT
>        id,
>        division_id,
>        names.primary,
>        ST_GeomFromWKB(geometry) as geometry
>        FROM
>            read_parquet('s3://overturemaps-us-west-2/release/2024-08-20.0/theme=divisions/type=division_area/*',
> hive_partitioning=1)
>        WHERE
>            subtype = 'county'
>            AND country = 'US'
>            AND region = 'US-VT';
> 
> I am using GDAL master (e09d07a7) and libarrow 16.1.
> 
> Thanks,
> Dan
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From osgeo.mailinglist at gmail.com  Wed Aug 28 15:02:27 2024
From: osgeo.mailinglist at gmail.com (Thomas Gratier)
Date: Thu, 29 Aug 2024 00:02:27 +0200
Subject: [gdal-dev] WRITE_BBOX not available in GeoJSONSeq lco options?
Message-ID: <CACPZzQ2HmVgNS2K2k6r6h6mMb26xtgK1eWH+ULYBbdkDBW8gNg@mail.gmail.com>

Hi,

I needed to generate bbox at feature level in GeoJSONSeq when creating the
output. I was surprised to not found the option in the driver
https://gdal.org/en/latest/drivers/vector/geojsonseq.html#layer-creation-options
whereas it's available for GeoJSON
https://gdal.org/en/latest/drivers/vector/geojson.html#layer-creation-options
What is the origin of the choice or maybe non-choice? I can always go from
GeoJSON without bbox to GeoJSON with bbox then to GeoJSONSeq but not sure
it's the best way or if there is another way I did not find.
My option so far (combining with jq) is the following

ogr2ogr -f GeoJSON -lco WRITE_BBOX=YES /vsistdout/ poly_nobbox.geojson | jq
-r -c .features[] >| poly_with_box.geojsonl

Regards,

Thomas Gratier
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240829/1c6d2411/attachment.htm>

From even.rouault at spatialys.com  Wed Aug 28 15:18:25 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 29 Aug 2024 00:18:25 +0200
Subject: [gdal-dev] WRITE_BBOX not available in GeoJSONSeq lco options?
In-Reply-To: <CACPZzQ2HmVgNS2K2k6r6h6mMb26xtgK1eWH+ULYBbdkDBW8gNg@mail.gmail.com>
References: <CACPZzQ2HmVgNS2K2k6r6h6mMb26xtgK1eWH+ULYBbdkDBW8gNg@mail.gmail.com>
Message-ID: <d91fc30e-3bcb-4836-8916-a6229b3fb45d@spatialys.com>

Hi Thomas,

I can't think of a particular reason for not providing it. Option added 
in https://github.com/OSGeo/gdal/pull/10675

Even

Le 29/08/2024 ? 00:02, Thomas Gratier via gdal-dev a ?crit?:
> Hi,
>
> I needed to generate bbox at feature level in?GeoJSONSeq when creating 
> the output. I was surprised to not found the option in the driver 
> https://gdal.org/en/latest/drivers/vector/geojsonseq.html#layer-creation-options 
> whereas it's available for GeoJSON 
> https://gdal.org/en/latest/drivers/vector/geojson.html#layer-creation-options
> What is the origin of the choice or maybe non-choice? I can always go 
> from GeoJSON without bbox to GeoJSON with bbox then to GeoJSONSeq but 
> not sure it's the best way or if there is another way I did not find.
> My option so far (combining with jq) is the following
>
> ogr2ogr -f GeoJSON -lco WRITE_BBOX=YES /vsistdout/ poly_nobbox.geojson 
> | jq -r -c .features[] >| poly_with_box.geojsonl
>
> Regards,
>
> Thomas Gratier
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From dbaston at gmail.com  Wed Aug 28 16:36:12 2024
From: dbaston at gmail.com (Daniel Baston)
Date: Wed, 28 Aug 2024 19:36:12 -0400
Subject: [gdal-dev] Attribute filter on remote Parquet file is slow
In-Reply-To: <2afbddf9-ff7f-4ad5-9f42-2a309764c669@spatialys.com>
References: <CA+K_q_oG_vBOsJPJih_46wM6e9YonAd8Rf6gWDiyLGFKeP2ukQ@mail.gmail.com>
 <2afbddf9-ff7f-4ad5-9f42-2a309764c669@spatialys.com>
Message-ID: <CA+K_q_oivWRbgPKnc-TME+rA3cb7YYWstRgiszjoZyZ5vReCQQ@mail.gmail.com>

Hi Even,

Thanks for the suggestions. I've played around with it a bit more
without much success.

> No you didn't do anything obviously wrong. I'm not sure that in the
> ArrowDataset mode libarrow actually uses group statistics to filter out
> row groups, which might cause it to actually ingest the whole files

After instrumenting it a bit, it at least appears to filter out
selected row groups, but it's not terribly effective. 59 record
batches are downloaded, one of which contains the 14 desired features.
The ranges requested are not sequential and do not cover the entire
file. But the fetching process is much slower than downloading the 1.2
gb file directly and querying it locally.

>
> You may also try to tune the config options at
> https://github.com/OSGeo/gdal/blob/master/ogr/ogrsf_frmts/parquet/ogrparquetdatasetlayer.cpp#L522-L558
> do you observe a similar difference if you work with just a simple file
> like
> /vsis3/overturemaps-us-west-2/release/2024-08-20.0/theme=divisions/type=division_area/part-00000-5466202d-8cdf-48e5-9aee-886c73dafc5f-c000.zstd.parquet

I'm not seeing a performance difference by doing this, beyond the
(fairly high) run-to-run variability.

Dan

From sharma1981 at outlook.com  Thu Aug 29 00:41:12 2024
From: sharma1981 at outlook.com (Parveen Sharma)
Date: Thu, 29 Aug 2024 07:41:12 +0000
Subject: [gdal-dev] Is it possible to create standalone DLL for OGR GML
 driver ?
In-Reply-To: <SYZP282MB3189AF41A0C8AADA4D22D0E0D9962@SYZP282MB3189.AUSP282.PROD.OUTLOOK.COM>
References: <SYZP282MB3189AF41A0C8AADA4D22D0E0D9962@SYZP282MB3189.AUSP282.PROD.OUTLOOK.COM>
Message-ID: <SYZP282MB318938620216C3B4862B536FD9962@SYZP282MB3189.AUSP282.PROD.OUTLOOK.COM>


Hello

I am working on Release/3.3 branch of GDAL. I want to know if its possible to create a standalone DLL for OGR GML driver during build of GDAL itself?

So far i have tried enabling below flags in my nmake.local but there is no success so far.


OGR_ENABLE_DRIVER_GML_PLUGIN = YES
GDAL_ENABLE_PLUGINS = YES
OGR_ENABLE_PLUGINS = YES

I was wondering if there exists a way to get standalone OGR GML Driver. Please suggest.

Best regards,
Parveen


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240829/e39ff145/attachment.htm>

From michkowalczuk at gmail.com  Thu Aug 29 02:00:53 2024
From: michkowalczuk at gmail.com (=?UTF-8?Q?Micha=C5=82_Kowalczuk?=)
Date: Thu, 29 Aug 2024 11:00:53 +0200
Subject: [gdal-dev] WMTS gdal_translate vs RasterIO
Message-ID: <CAP+FqQD_aUB21vEVitpFUhhKA7529-Y3L0WhXKn4jmCpKijKvg@mail.gmail.com>

Hi once again!
I came across another problem using WMTS.
The following translate command:
*gdal_translate -srcwin 0 0 1073741760 1553779 -outsize 691 1
"WMTS:https://basemap.nationalmap.gov/arcgis/rest/services/USGSHydroCached/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSHydroCached,tilematrixset=GoogleMapsCompatible
<https://basemap.nationalmap.gov/arcgis/rest/services/USGSHydroCached/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSHydroCached,tilematrixset=GoogleMapsCompatible>"
tile.png*
passes with no errors.
.
If I use similar invoke of GDALRasterIO from C API I get the following
error:
*ERROR 5:
WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=default028mm:
Access window out of range in RasterIO().  Requested (0,0) of size
1073741760x1553779 on raster of 1073741756x1347126255.*

The GDALRasterIO function call looks like this. I'm quite sure of its
correctness, because it gives good results for the rest of tested WMTS
services

*GDALDatasetRasterIO(*

*handle_to_wmts_subdataset,*
*eRWFlag=GF_Read,*

*nXOff=0,*
*nYOff=0,*

*nXSize=1073741760,*
*nYSize=1553779,*

*pBuffer - buffer for data,*

*nBufXSize=1,*

*nBufYSize=691,*

*eBufType=GDT_Byte,*

*nBandCount=4,*

*panBandMap=[bIndex ,gIndex, rIndex, aIndex],*

*nPixelSpace=4,*

*nLineSpace=0,*

*nBandSpace=1)*

Can anyone explain me hot to interpret the mentioned error:
*Requested (0,0) of size 1073741760x1553779 on raster of
1073741756x1347126255?*

Thanks!
Micha?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240829/0c675d7e/attachment.htm>

From jukka.rahkonen at maanmittauslaitos.fi  Thu Aug 29 03:08:09 2024
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Thu, 29 Aug 2024 10:08:09 +0000
Subject: [gdal-dev] WMTS gdal_translate vs RasterIO
In-Reply-To: <CAP+FqQD_aUB21vEVitpFUhhKA7529-Y3L0WhXKn4jmCpKijKvg@mail.gmail.com>
References: <CAP+FqQD_aUB21vEVitpFUhhKA7529-Y3L0WhXKn4jmCpKijKvg@mail.gmail.com>
Message-ID: <DB9PR09MB688738471F0F0F021A537204FD962@DB9PR09MB6887.eurprd09.prod.outlook.com>

Hi,

For some reason, your code generates a request that is pointing to another tilematrixset. Gdal_translate is using "GoogleMapsCompatible" but with your code the "default028mm" gets used. Comparison does not make sense before you get both requests to use the same tilemetrixset.

-Jukka Rahkonen-

L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Michal Kowalczuk via gdal-dev
L?hetetty: torstai 29. elokuuta 2024 12.01
Vastaanottaja: gdal-dev at lists.osgeo.org
Aihe: [gdal-dev] WMTS gdal_translate vs RasterIO

Hi once again!
I came across another problem using WMTS.
The following translate command:
gdal_translate -srcwin 0 0 1073741760 1553779 -outsize 691 1 "WMTS:https://basemap.nationalmap.gov/arcgis/rest/services/USGSHydroCached/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSHydroCached,tilematrixset=GoogleMapsCompatible" tile.png
passes with no errors.
.
If I use similar invoke of GDALRasterIO from C API I get the following error:
ERROR 5: WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=default028mm: Access window out of range in RasterIO().  Requested (0,0) of size 1073741760x1553779 on raster of 1073741756x1347126255.

The GDALRasterIO function call looks like this. I'm quite sure of its correctness, because it gives good results for the rest of tested WMTS services
GDALDatasetRasterIO(
handle_to_wmts_subdataset,
eRWFlag=GF_Read,
nXOff=0,
nYOff=0,
nXSize=1073741760,
nYSize=1553779,
pBuffer - buffer for data,
nBufXSize=1,
nBufYSize=691,
eBufType=GDT_Byte,
nBandCount=4,
panBandMap=[bIndex ,gIndex, rIndex, aIndex],
nPixelSpace=4,
nLineSpace=0,
nBandSpace=1)

Can anyone explain me hot to interpret the mentioned error:
Requested (0,0) of size 1073741760x1553779 on raster of 1073741756x1347126255?

Thanks!
Micha?


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240829/f3a48af9/attachment-0001.htm>

From robert.coup at koordinates.com  Thu Aug 29 03:20:03 2024
From: robert.coup at koordinates.com (Robert Coup)
Date: Thu, 29 Aug 2024 11:20:03 +0100
Subject: [gdal-dev] WMTS gdal_translate vs RasterIO
In-Reply-To: <DB9PR09MB688738471F0F0F021A537204FD962@DB9PR09MB6887.eurprd09.prod.outlook.com>
References: <CAP+FqQD_aUB21vEVitpFUhhKA7529-Y3L0WhXKn4jmCpKijKvg@mail.gmail.com>
 <DB9PR09MB688738471F0F0F021A537204FD962@DB9PR09MB6887.eurprd09.prod.outlook.com>
Message-ID: <CAFLLRpJB6nfXRdnY1_CfBF+nKM4Dy8Vs9+HP35s8pcatHveC=g@mail.gmail.com>

Hi Micha?,

In addition to Jukka's key point:

  nBufXSize=1,
  nBufYSize=691,

appears to be backwards wrt:

  -outsize 691 1

Rob :)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240829/b3f2bcf5/attachment.htm>

From michkowalczuk at gmail.com  Thu Aug 29 03:22:06 2024
From: michkowalczuk at gmail.com (=?UTF-8?Q?Micha=C5=82_Kowalczuk?=)
Date: Thu, 29 Aug 2024 12:22:06 +0200
Subject: [gdal-dev] WMTS gdal_translate vs RasterIO
In-Reply-To: <CAFLLRpJB6nfXRdnY1_CfBF+nKM4Dy8Vs9+HP35s8pcatHveC=g@mail.gmail.com>
References: <CAP+FqQD_aUB21vEVitpFUhhKA7529-Y3L0WhXKn4jmCpKijKvg@mail.gmail.com>
 <DB9PR09MB688738471F0F0F021A537204FD962@DB9PR09MB6887.eurprd09.prod.outlook.com>
 <CAFLLRpJB6nfXRdnY1_CfBF+nKM4Dy8Vs9+HP35s8pcatHveC=g@mail.gmail.com>
Message-ID: <CAP+FqQDp+cxY+mnVRTBqj+Ftcbz=QYJWEiGRj+TVCsKL4AeusQ@mail.gmail.com>

I see. I will double check commands, fix and return to this.

W dniu czw., 29.08.2024 o 12:20 Robert Coup <robert.coup at koordinates.com>
napisa?(a):

> Hi Micha?,
>
> In addition to Jukka's key point:
>
>   nBufXSize=1,
>   nBufYSize=691,
>
> appears to be backwards wrt:
>
>   -outsize 691 1
>
> Rob :)
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240829/8579a0ce/attachment.htm>

From even.rouault at spatialys.com  Thu Aug 29 03:33:10 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 29 Aug 2024 12:33:10 +0200
Subject: [gdal-dev] Is it possible to create standalone DLL for OGR GML
 driver ?
In-Reply-To: <SYZP282MB318938620216C3B4862B536FD9962@SYZP282MB3189.AUSP282.PROD.OUTLOOK.COM>
References: <SYZP282MB3189AF41A0C8AADA4D22D0E0D9962@SYZP282MB3189.AUSP282.PROD.OUTLOOK.COM>
 <SYZP282MB318938620216C3B4862B536FD9962@SYZP282MB3189.AUSP282.PROD.OUTLOOK.COM>
Message-ID: <2623ca60-1039-44cd-b4d6-8771ac0f9e35@spatialys.com>


>
> I was wondering if there exists a way to get standalone OGR GML 
> Driver. Please suggest.

No, it must be built-in in core libgdal as part of its functionality is 
re-used by other drivers (NAS, WFS) through direct function calls

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240829/0e07100d/attachment.htm>

From jmckenna at gatewaygeomatics.com  Thu Aug 29 04:34:23 2024
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Thu, 29 Aug 2024 08:34:23 -0300
Subject: [gdal-dev] FileGDBs and FIDs of -21121
In-Reply-To: <1ef001cb-72c7-45b0-96be-9baa798658e9@spatialys.com>
References: <44dba2f2-6a2a-4f52-a9f5-47f9803e9ca3@app.fastmail.com>
 <ac8c8aee-4990-4c4e-bb87-1b6c1d56258e@spatialys.com>
 <300cfa9a-c629-4f38-a11a-8dfecd19fd3d@app.fastmail.com>
 <928c30c2-815d-4005-bdeb-36421133fc9b@spatialys.com>
 <8a1281ba-1f52-4eab-b6eb-9d5eb403d859@spatialys.com>
 <a9559b05-9e43-4612-92e2-2488ab562c29@app.fastmail.com>
 <1ef001cb-72c7-45b0-96be-9baa798658e9@spatialys.com>
Message-ID: <cb2efcc0-ea36-48ca-b7f9-2fadf37dc7e8@gatewaygeomatics.com>

I also like the subtle nod to Rush's legendary album, "twenty-one 
twelve", inside the GDAL code  ;)

-jeff



-- 
Jeff McKenna
GatewayGeo: Developers of MS4W, & offering MapServer Consulting/Dev
co-founder of FOSS4G
http://gatewaygeo.com/



On 2024-08-27 6:38 p.m., Even Rouault via gdal-dev wrote:
> I'm afraid you are questioning design choices dating back to the last 
> millennium: https://github.com/OSGeo/gdal/ 
> commit/9d4076f3672b0b6b31de175fcfa677b378c0b577 :-)
> 
> This could be any value really (perhaps except 0). I assume this was a 
> nice one when looking a OGRRaw value in a debugger to actually see it 
> was initialized to unset, rather than just 0-initialized or random 
> initialized.
> 
> Le 27/08/2024 ? 23:23, Seth G a ?crit?:
>> Thanks Even!
>> I got as far as setting up a test case in MapServer and starting the debugger before your fix arrived :-)
>> As an aside, is there a reason -21121 was chosen as a special value?
>>
>> Seth
>>
>> --
>> web:https://geographika.net &https://mapserverstudio.net
>> twitter: @geographika
>>
>> On Tue, Aug 27, 2024, at 11:14 PM, Even Rouault wrote:
>>> Le 27/08/2024 ? 23:01, Even Rouault via gdal-dev a ?crit?:
>>>> oh, I've managed to reproduce. This is a bug in the OpenFileGDB
>>>> driver. Fix to follow soon
>>> ==>https://github.com/OSGeo/gdal/pull/10662
>>>
>>>
>>> -- 
>>> http://www.spatialys.com
>>> My software is free, but my time generally not.
> 
> -- 
> http://www.spatialys.com
> My software is free, but my time generally not.

From even.rouault at spatialys.com  Thu Aug 29 05:26:34 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 29 Aug 2024 14:26:34 +0200
Subject: [gdal-dev] Call for review on RFC 101: Raster dataset read-only
 thread-safety
Message-ID: <60268c3f-1edd-42fa-9081-6d296aa765a7@spatialys.com>

Hi,

I've worked on a new RFC 101: Raster dataset read-only thread-safety: 
https://github.com/OSGeo/gdal/pull/10676

Summary: This RFC enables users to get instances of GDALDataset (and 
their related objects such as GDALRasterBand) that are thread-safe for 
read-only raster operations, that is such instances can be safely used 
from multiple threads without locking.

It is backed by a preliminary implementation (fairly complete, apart 
from writing new tests...). There's at least one open question raised in 
the RFC.

PS: you can see one of the benefits of the migration of the doc to 
ReadTheDocs hosting, with the preview of the updated documentation in 
pull requests. So this is a way to mention that the move to RtD hosting 
has now been completed, with the default version ("latest") reflecting 
the state of the master branch, as well as the version for the 
release/3.9 branch. Thanks to Dan Baston (and other people involved) for 
this work! There might be a few adjustments needed, so if you notice 
something unusual w.r.t. to the previous state, please file a ticket.

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From andrew at aitchison.me.uk  Thu Aug 29 10:42:16 2024
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Thu, 29 Aug 2024 18:42:16 +0100 (BST)
Subject: [gdal-dev] Is it possible to create standalone DLL for OGR GML
 driver ?
In-Reply-To: <2623ca60-1039-44cd-b4d6-8771ac0f9e35@spatialys.com>
References: <SYZP282MB3189AF41A0C8AADA4D22D0E0D9962@SYZP282MB3189.AUSP282.PROD.OUTLOOK.COM>
 <SYZP282MB318938620216C3B4862B536FD9962@SYZP282MB3189.AUSP282.PROD.OUTLOOK.COM>
 <2623ca60-1039-44cd-b4d6-8771ac0f9e35@spatialys.com>
Message-ID: <97991ef9-212d-8dbc-1c79-8715a2bb2f16@aitchison.me.uk>

On Thu, 29 Aug 2024, Even Rouault via gdal-dev wrote:

>
>> 
>> I was wondering if there exists a way to get standalone OGR GML Driver. 
>> Please suggest.
>
> No, it must be built-in in core libgdal as part of its functionality is 
> re-used by other drivers (NAS, WFS) through direct function calls

Would disabling NAS and WFS support make a difference ?

-- 
Andrew C. Aitchison                      Kendal, UK
                    andrew at aitchison.me.uk

From even.rouault at spatialys.com  Thu Aug 29 15:09:17 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 30 Aug 2024 00:09:17 +0200
Subject: [gdal-dev] Is it possible to create standalone DLL for OGR GML
 driver ?
In-Reply-To: <97991ef9-212d-8dbc-1c79-8715a2bb2f16@aitchison.me.uk>
References: <SYZP282MB3189AF41A0C8AADA4D22D0E0D9962@SYZP282MB3189.AUSP282.PROD.OUTLOOK.COM>
 <SYZP282MB318938620216C3B4862B536FD9962@SYZP282MB3189.AUSP282.PROD.OUTLOOK.COM>
 <2623ca60-1039-44cd-b4d6-8771ac0f9e35@spatialys.com>
 <97991ef9-212d-8dbc-1c79-8715a2bb2f16@aitchison.me.uk>
Message-ID: <0baaf8a6-4023-410d-b0b0-269f0b2970e4@spatialys.com>


Le 29/08/2024 ? 19:42, Andrew C Aitchison via gdal-dev a ?crit?:
> On Thu, 29 Aug 2024, Even Rouault via gdal-dev wrote:
>
>>
>>>
>>> I was wondering if there exists a way to get standalone OGR GML 
>>> Driver. Please suggest.
>>
>> No, it must be built-in in core libgdal as part of its functionality 
>> is re-used by other drivers (NAS, WFS) through direct function calls
>
> Would disabling NAS and WFS support make a difference ?

It would be required, but not sufficient. You also need to replace the 
BUILTIN keyword in ogr/ogrsf_frmts/gml/CMakeLists.txt with 
PLUGIN_CAPABLE . I wouldn't exclude that you would hit linking errors 
because the driver might use functions of the core that are not 
exported. In that case you need to tag the declaration of those 
functions with CPL_DLL

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From michkowalczuk at gmail.com  Thu Aug 29 23:59:25 2024
From: michkowalczuk at gmail.com (=?UTF-8?Q?Micha=C5=82_Kowalczuk?=)
Date: Fri, 30 Aug 2024 08:59:25 +0200
Subject: [gdal-dev] WMTS gdal_translate vs RasterIO
In-Reply-To: <CAP+FqQDp+cxY+mnVRTBqj+Ftcbz=QYJWEiGRj+TVCsKL4AeusQ@mail.gmail.com>
References: <CAP+FqQD_aUB21vEVitpFUhhKA7529-Y3L0WhXKn4jmCpKijKvg@mail.gmail.com>
 <DB9PR09MB688738471F0F0F021A537204FD962@DB9PR09MB6887.eurprd09.prod.outlook.com>
 <CAFLLRpJB6nfXRdnY1_CfBF+nKM4Dy8Vs9+HP35s8pcatHveC=g@mail.gmail.com>
 <CAP+FqQDp+cxY+mnVRTBqj+Ftcbz=QYJWEiGRj+TVCsKL4AeusQ@mail.gmail.com>
Message-ID: <CAP+FqQArx7OuQZwUwpLqo7MABDiH6CqEG+6YibFSLFrnUPBOeA@mail.gmail.com>

Sorry for incorrect sample commands in the last message.
I fixed it. The problem stays the same, because the problem was in email
not in my tested code.
*gdal_translate -srcwin 0 0 1073741760 1553779 -outsize 691 1
"WMTS:https://basemap.nationalmap.gov/arcgis/rest/services/USGSHydroCached/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSHydroCached,tilematrixset=default028mm
<https://basemap.nationalmap.gov/arcgis/rest/services/USGSHydroCached/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSHydroCached,tilematrixset=default028mm>"
tile.png*


*GDALDatasetRasterIO(*

*handle_to_wmts_subdataset,*
*eRWFlag=GF_Read,*

*nXOff=0,*
*nYOff=0,*

*nXSize=1073741760,*
*nYSize=1553779,*

*pBuffer - buffer for data,*
*nBufXSize=**691**,*
*nBufYSize=**1**,*

*eBufType=GDT_Byte,*

*nBandCount=4,*

*panBandMap=[bIndex ,gIndex, rIndex, aIndex],*

*nPixelSpace=4,*

*nLineSpace=0,*
*nBandSpace=1)*

Can anyone help me to understand why gdal_translate works and generates
output file, where GDALRasterIO raises error:
*Requested (0,0) of size 1073741760x1553779 on raster of
1073741756x1347126255?*

czw., 29 sie 2024 o 12:22 Micha? Kowalczuk <michkowalczuk at gmail.com>
napisa?(a):

> I see. I will double check commands, fix and return to this.
>
> W dniu czw., 29.08.2024 o 12:20 Robert Coup <robert.coup at koordinates.com>
> napisa?(a):
>
>> Hi Micha?,
>>
>> In addition to Jukka's key point:
>>
>>   nBufXSize=1,
>>   nBufYSize=691,
>>
>> appears to be backwards wrt:
>>
>>   -outsize 691 1
>>
>> Rob :)
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240830/76932b31/attachment.htm>

From jukka.rahkonen at maanmittauslaitos.fi  Fri Aug 30 00:23:18 2024
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Fri, 30 Aug 2024 07:23:18 +0000
Subject: [gdal-dev] WMTS gdal_translate vs RasterIO
In-Reply-To: <CAP+FqQArx7OuQZwUwpLqo7MABDiH6CqEG+6YibFSLFrnUPBOeA@mail.gmail.com>
References: <CAP+FqQD_aUB21vEVitpFUhhKA7529-Y3L0WhXKn4jmCpKijKvg@mail.gmail.com>
 <DB9PR09MB688738471F0F0F021A537204FD962@DB9PR09MB6887.eurprd09.prod.outlook.com>
 <CAFLLRpJB6nfXRdnY1_CfBF+nKM4Dy8Vs9+HP35s8pcatHveC=g@mail.gmail.com>
 <CAP+FqQDp+cxY+mnVRTBqj+Ftcbz=QYJWEiGRj+TVCsKL4AeusQ@mail.gmail.com>
 <CAP+FqQArx7OuQZwUwpLqo7MABDiH6CqEG+6YibFSLFrnUPBOeA@mail.gmail.com>
Message-ID: <AS5PR09MB6897FD58FF1E7EB4488ADC72FD972@AS5PR09MB6897.eurprd09.prod.outlook.com>

Hi,

Capture and show the http request that your code generates and sends to the WMTS server. Does it work if you send the same request with curl or with a browser? Or does the error come before the GetTile request is generated?

-Jukka Rahkonen-

L?hett?j?: Micha? Kowalczuk <michkowalczuk at gmail.com>
L?hetetty: perjantai 30. elokuuta 2024 9.59
Vastaanottaja: Robert Coup <robert.coup at koordinates.com>
Kopio: gdal-dev at lists.osgeo.org; Rahkonen Jukka <jukka.rahkonen at maanmittauslaitos.fi>
Aihe: Re: [gdal-dev] WMTS gdal_translate vs RasterIO

Sorry for incorrect sample commands in the last message.
I fixed it. The problem stays the same, because the problem was in email not in my tested code.
gdal_translate -srcwin 0 0 1073741760 1553779 -outsize 691 1 "WMTS:https://basemap.nationalmap.gov/arcgis/rest/services/USGSHydroCached/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSHydroCached,tilematrixset=default028mm" tile.png

GDALDatasetRasterIO(
handle_to_wmts_subdataset,
eRWFlag=GF_Read,
nXOff=0,
nYOff=0,
nXSize=1073741760,
nYSize=1553779,
pBuffer - buffer for data,
nBufXSize=691,
nBufYSize=1,
eBufType=GDT_Byte,
nBandCount=4,
panBandMap=[bIndex ,gIndex, rIndex, aIndex],
nPixelSpace=4,
nLineSpace=0,
nBandSpace=1)

Can anyone help me to understand why gdal_translate works and generates output file, where GDALRasterIO raises error:
Requested (0,0) of size 1073741760x1553779 on raster of 1073741756x1347126255?

czw., 29 sie 2024 o 12:22 Micha? Kowalczuk <michkowalczuk at gmail.com<mailto:michkowalczuk at gmail.com>> napisa?(a):
I see. I will double check commands, fix and return to this.

W dniu czw., 29.08.2024 o 12:20 Robert Coup <robert.coup at koordinates.com<mailto:robert.coup at koordinates.com>> napisa?(a):
Hi Micha?,

In addition to Jukka's key point:

  nBufXSize=1,
  nBufYSize=691,

appears to be backwards wrt:

  -outsize 691 1

Rob :)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240830/fb0f733b/attachment-0001.htm>

From michkowalczuk at gmail.com  Fri Aug 30 00:27:55 2024
From: michkowalczuk at gmail.com (=?UTF-8?Q?Micha=C5=82_Kowalczuk?=)
Date: Fri, 30 Aug 2024 09:27:55 +0200
Subject: [gdal-dev] WMTS gdal_translate vs RasterIO
In-Reply-To: <AS5PR09MB6897FD58FF1E7EB4488ADC72FD972@AS5PR09MB6897.eurprd09.prod.outlook.com>
References: <CAP+FqQD_aUB21vEVitpFUhhKA7529-Y3L0WhXKn4jmCpKijKvg@mail.gmail.com>
 <DB9PR09MB688738471F0F0F021A537204FD962@DB9PR09MB6887.eurprd09.prod.outlook.com>
 <CAFLLRpJB6nfXRdnY1_CfBF+nKM4Dy8Vs9+HP35s8pcatHveC=g@mail.gmail.com>
 <CAP+FqQDp+cxY+mnVRTBqj+Ftcbz=QYJWEiGRj+TVCsKL4AeusQ@mail.gmail.com>
 <CAP+FqQArx7OuQZwUwpLqo7MABDiH6CqEG+6YibFSLFrnUPBOeA@mail.gmail.com>
 <AS5PR09MB6897FD58FF1E7EB4488ADC72FD972@AS5PR09MB6897.eurprd09.prod.outlook.com>
Message-ID: <CAP+FqQCpi-H_SpNyypftuC+8jsetsxz8bngQAbcPeokr+_09TQ@mail.gmail.com>

Full GDAL log attached.
Sorry, but I do not know how to test your suggestion. GDAL logger creates
some caches and I do not know which http request i should use...

Thanks, Micha?

pt., 30 sie 2024 o 09:23 Rahkonen Jukka <jukka.rahkonen at maanmittauslaitos.fi>
napisa?(a):

> Hi,
>
>
>
> Capture and show the http request that your code generates and sends to
> the WMTS server. Does it work if you send the same request with curl or
> with a browser? Or does the error come before the GetTile request is
> generated?
>
>
>
> -Jukka Rahkonen-
>
>
>
> *L?hett?j?:* Micha? Kowalczuk <michkowalczuk at gmail.com>
> *L?hetetty:* perjantai 30. elokuuta 2024 9.59
> *Vastaanottaja:* Robert Coup <robert.coup at koordinates.com>
> *Kopio:* gdal-dev at lists.osgeo.org; Rahkonen Jukka <
> jukka.rahkonen at maanmittauslaitos.fi>
> *Aihe:* Re: [gdal-dev] WMTS gdal_translate vs RasterIO
>
>
>
> Sorry for incorrect sample commands in the last message.
>
> I fixed it. The problem stays the same, because the problem was in email
> not in my tested code.
>
> *gdal_translate -srcwin 0 0 1073741760 1553779 -outsize 691 1
> "WMTS:https://basemap.nationalmap.gov/arcgis/rest/services/USGSHydroCached/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSHydroCached,tilematrixset=default028mm
> <https://basemap.nationalmap.gov/arcgis/rest/services/USGSHydroCached/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSHydroCached,tilematrixset=default028mm>"
> tile.png*
>
>
>
> *GDALDatasetRasterIO(*
>
> *handle_to_wmts_subdataset,*
>
> *eRWFlag=GF_Read,*
>
> *nXOff=0,*
>
> *nYOff=0,*
>
> *nXSize=1073741760,*
>
> *nYSize=1553779,*
>
> *pBuffer - buffer for data,*
>
> *nBufXSize=691,*
>
> *nBufYSize=1,*
>
> *eBufType=GDT_Byte,*
>
> *nBandCount=4,*
>
> *panBandMap=[bIndex ,gIndex, rIndex, aIndex],*
>
> *nPixelSpace=4,*
>
> *nLineSpace=0,*
>
> *nBandSpace=1)*
>
>
>
> Can anyone help me to understand why gdal_translate works and generates
> output file, where GDALRasterIO raises error:
>
> *Requested (0,0) of size 1073741760x1553779 on raster of
> 1073741756x1347126255?*
>
>
>
> czw., 29 sie 2024 o 12:22 Micha? Kowalczuk <michkowalczuk at gmail.com>
> napisa?(a):
>
> I see. I will double check commands, fix and return to this.
>
>
>
> W dniu czw., 29.08.2024 o 12:20 Robert Coup <robert.coup at koordinates.com>
> napisa?(a):
>
> Hi Micha?,
>
>
> In addition to Jukka's key point:
>
>   nBufXSize=1,
>   nBufYSize=691,
>
> appears to be backwards wrt:
>
>
>   -outsize 691 1
>
>
>
> Rob :)
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240830/8e802eb7/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: App.WebServices.log
Type: application/octet-stream
Size: 27505 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240830/8e802eb7/attachment-0001.obj>

From jukka.rahkonen at maanmittauslaitos.fi  Fri Aug 30 00:50:55 2024
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Fri, 30 Aug 2024 07:50:55 +0000
Subject: [gdal-dev] WMTS gdal_translate vs RasterIO
In-Reply-To: <CAP+FqQCpi-H_SpNyypftuC+8jsetsxz8bngQAbcPeokr+_09TQ@mail.gmail.com>
References: <CAP+FqQD_aUB21vEVitpFUhhKA7529-Y3L0WhXKn4jmCpKijKvg@mail.gmail.com>
 <DB9PR09MB688738471F0F0F021A537204FD962@DB9PR09MB6887.eurprd09.prod.outlook.com>
 <CAFLLRpJB6nfXRdnY1_CfBF+nKM4Dy8Vs9+HP35s8pcatHveC=g@mail.gmail.com>
 <CAP+FqQDp+cxY+mnVRTBqj+Ftcbz=QYJWEiGRj+TVCsKL4AeusQ@mail.gmail.com>
 <CAP+FqQArx7OuQZwUwpLqo7MABDiH6CqEG+6YibFSLFrnUPBOeA@mail.gmail.com>
 <AS5PR09MB6897FD58FF1E7EB4488ADC72FD972@AS5PR09MB6897.eurprd09.prod.outlook.com>
 <CAP+FqQCpi-H_SpNyypftuC+8jsetsxz8bngQAbcPeokr+_09TQ@mail.gmail.com>
Message-ID: <AS5PR09MB68970FA6505D481BBA9146FDFD972@AS5PR09MB6897.eurprd09.prod.outlook.com>

Hi,

I do not know either, I am not a programmer. I have used sometimes a local proxy server for capturing the http traffic. With gdal_translate the http requests are printed when the command is run with -- debug on. It would probably be good to run gdal_translate with -ovr NONE https://gdal.org/en/latest/programs/gdal_translate.html#cmdoption-gdal_translate-ovr and force it to use the full resolution image, because I quess that your code is also hitting the full resolution. Maybe gdal_translate is already hitting the same resolution, but by using -ovr it is you who makes the decision.

By reading the values it seems that you request 1073741760 pixels but for some reason GDAL believes that there are only 1073741756 pixels available. If I were a programmer, I think I would have a try with nXSize=1073741756.

May I ask why do you want to compress quite a large area of a raster into a single line of pixels? You have probably some interesting use case.

-Jukka Rahkonen-

L?hett?j?: Micha? Kowalczuk <michkowalczuk at gmail.com>
L?hetetty: perjantai 30. elokuuta 2024 10.28
Vastaanottaja: Rahkonen Jukka <jukka.rahkonen at maanmittauslaitos.fi>
Kopio: Robert Coup <robert.coup at koordinates.com>; gdal-dev at lists.osgeo.org
Aihe: Re: [gdal-dev] WMTS gdal_translate vs RasterIO

Full GDAL log attached.
Sorry, but I do not know how to test your suggestion. GDAL logger creates some caches and I do not know which http request i should use...

Thanks, Micha?

pt., 30 sie 2024 o 09:23 Rahkonen Jukka <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>> napisa?(a):
Hi,

Capture and show the http request that your code generates and sends to the WMTS server. Does it work if you send the same request with curl or with a browser? Or does the error come before the GetTile request is generated?

-Jukka Rahkonen-

L?hett?j?: Micha? Kowalczuk <michkowalczuk at gmail.com<mailto:michkowalczuk at gmail.com>>
L?hetetty: perjantai 30. elokuuta 2024 9.59
Vastaanottaja: Robert Coup <robert.coup at koordinates.com<mailto:robert.coup at koordinates.com>>
Kopio: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>; Rahkonen Jukka <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>>
Aihe: Re: [gdal-dev] WMTS gdal_translate vs RasterIO

Sorry for incorrect sample commands in the last message.
I fixed it. The problem stays the same, because the problem was in email not in my tested code.
gdal_translate -srcwin 0 0 1073741760 1553779 -outsize 691 1 "WMTS:https://basemap.nationalmap.gov/arcgis/rest/services/USGSHydroCached/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSHydroCached,tilematrixset=default028mm" tile.png

GDALDatasetRasterIO(
handle_to_wmts_subdataset,
eRWFlag=GF_Read,
nXOff=0,
nYOff=0,
nXSize=1073741760,
nYSize=1553779,
pBuffer - buffer for data,
nBufXSize=691,
nBufYSize=1,
eBufType=GDT_Byte,
nBandCount=4,
panBandMap=[bIndex ,gIndex, rIndex, aIndex],
nPixelSpace=4,
nLineSpace=0,
nBandSpace=1)

Can anyone help me to understand why gdal_translate works and generates output file, where GDALRasterIO raises error:
Requested (0,0) of size 1073741760x1553779 on raster of 1073741756x1347126255?

czw., 29 sie 2024 o 12:22 Micha? Kowalczuk <michkowalczuk at gmail.com<mailto:michkowalczuk at gmail.com>> napisa?(a):
I see. I will double check commands, fix and return to this.

W dniu czw., 29.08.2024 o 12:20 Robert Coup <robert.coup at koordinates.com<mailto:robert.coup at koordinates.com>> napisa?(a):
Hi Micha?,

In addition to Jukka's key point:

  nBufXSize=1,
  nBufYSize=691,

appears to be backwards wrt:

  -outsize 691 1

Rob :)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240830/1e488590/attachment.htm>

From michkowalczuk at gmail.com  Fri Aug 30 02:49:34 2024
From: michkowalczuk at gmail.com (=?UTF-8?Q?Micha=C5=82_Kowalczuk?=)
Date: Fri, 30 Aug 2024 11:49:34 +0200
Subject: [gdal-dev] WMTS gdal_translate vs RasterIO
In-Reply-To: <AS5PR09MB68970FA6505D481BBA9146FDFD972@AS5PR09MB6897.eurprd09.prod.outlook.com>
References: <CAP+FqQD_aUB21vEVitpFUhhKA7529-Y3L0WhXKn4jmCpKijKvg@mail.gmail.com>
 <DB9PR09MB688738471F0F0F021A537204FD962@DB9PR09MB6887.eurprd09.prod.outlook.com>
 <CAFLLRpJB6nfXRdnY1_CfBF+nKM4Dy8Vs9+HP35s8pcatHveC=g@mail.gmail.com>
 <CAP+FqQDp+cxY+mnVRTBqj+Ftcbz=QYJWEiGRj+TVCsKL4AeusQ@mail.gmail.com>
 <CAP+FqQArx7OuQZwUwpLqo7MABDiH6CqEG+6YibFSLFrnUPBOeA@mail.gmail.com>
 <AS5PR09MB6897FD58FF1E7EB4488ADC72FD972@AS5PR09MB6897.eurprd09.prod.outlook.com>
 <CAP+FqQCpi-H_SpNyypftuC+8jsetsxz8bngQAbcPeokr+_09TQ@mail.gmail.com>
 <AS5PR09MB68970FA6505D481BBA9146FDFD972@AS5PR09MB6897.eurprd09.prod.outlook.com>
Message-ID: <CAP+FqQCxYafihEk40OYg9MtB=C4JMAPAgy_iaDviWOoJkdQNSA@mail.gmail.com>

   - When debugging *gdal_translate *I noticed that both gdal_translate and
   GDALRasterIO chose tilematrix=22 (*WMTS: Using tilematrix=22 (zoom level
   22)*
   - The difference is in the next log line:
      - gdal_translate uses XML as argument for GdalOpen:

*HTTP:
      Fetch(https://basemap.nationalmap.gov/arcgis/rest/services/USGSHydroCached/MapServer/WMTS/1.0.0/WMTSCapabilities.xml
      <https://basemap.nationalmap.gov/arcgis/rest/services/USGSHydroCached/MapServer/WMTS/1.0.0/WMTSCapabilities.xml>)
      *
*WMTS: Using tilematrix=22 (zoom level 22) *
*WMS: Using
      C:\Users\Michal\.cache\gdalwmscache\4112649712971ece915a619d7334b09c for
      cache *
*GDAL: GDALOpen(<GDAL_WMS><Service name="TMS">
       <ServerUrl>https://basemap.nationalmap.gov/arcgis/rest/services/USGSHydroCached/MapServer/WMTS/tile/1.0.0/USGSHydroCached/default/default028mm/22/${y}/${x}.png
      <https://basemap.nationalmap.gov/arcgis/rest/services/USGSHydroCached/MapServer/WMTS/tile/1.0.0/USGSHydroCached/default/default028mm/22/$%7By%7D/$%7Bx%7D.png></ServerUrl></Service><DataWindow>
         <UpperLeftX>-20037508.342787</UpperLeftX>
       <UpperLeftY>20037508.342787</UpperLeftY>
       <LowerRightX>49090487.0664309</LowerRightX>
       <LowerRightY>-36387522.4405195</LowerRightY>
<TileLevel>0</TileLevel>
       <TileX>0</TileX>    <TileY>0</TileY>    <SizeX>1852166912</SizeX>
       <SizeY>1511812608</SizeY>
       <YOrigin>top</YOrigin></DataWindow><BlockSizeX>256</BlockSizeX><BlockSizeY>256</BlockSizeY><BandsCount>4</BandsCount><DataType>Byte</DataType><Cache
      /><UnsafeSSL>true</UnsafeSSL><ZeroBlockHttpCodes>204,404</ZeroBlockHttpCodes><ZeroBlockOnServerException>true</ZeroBlockOnServerException></GDAL_WMS>,
      this=0000025616415250) succeeds as WMS. **WMS: Using
      C:\Users\Michal\.cache\gdalwmscache\9c7d5f9a99f1b710170c225a59a5ee4c for
      cache*
      - log from my code shows different approach...But this approach works
      fine for the other subdataset from this server
      "tilematrixset=GoogleMapsCompatible"
      *[Fri Aug 30 11:12:41 2024].3130, 14.4900: HTTP:
      Fetch(https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml
      <https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml>)*
      *[Fri Aug 30 11:12:41 2024].9710, 15.1480: WMTS: Using tilematrix=22
      (zoom level 22)*
      *[*
*Fri Aug 30 11:12:41 2024].9730, 15.1500: GDAL:
      GDALOpen(WMTS:https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=default028mm
      <https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=default028mm>,
      this=0000028EE0F1AA30) succeeds as WMTS. [**Fri Aug 30 11:12:41
      2024].9970, 15.1740: CPLError:
      WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=default028mm:
      Access window out of range in RasterIO().  Requested (0,0) of size
      1073741760x764544 on raster of 1073741756x1347126255.*
      *ERROR 5:
      WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=default028mm:
      Access window out of range in RasterIO().  Requested (0,0) of size
      1073741760x764544 on raster of 1073741756x1347126255.*
      - gdal_translate also works for -ovr NONE
   - when I hardcode to use *nxSize=1073741756* instead of *1073741760*,
   similar problem occurs later:
   GDAL CPL Error 5:
   WMTSCapabilities.xml,layer=USGSImageryOnly,tilematrixset=default028mm:
   Access window out of range in RasterIO().  Requested (0,1344795604) of size
   1073741756x2330668 on raster of 1073741756x1347126255.
   - answering to you last question - I fill windows bitmap using Delphi
   where I need to copy byte values line-by-line (using scanline approach).

I guess we're still stuck :-(

pt., 30 sie 2024 o 09:50 Rahkonen Jukka <jukka.rahkonen at maanmittauslaitos.fi>
napisa?(a):

> Hi,
>
>
>
> I do not know either, I am not a programmer. I have used sometimes a local
> proxy server for capturing the http traffic. With gdal_translate the http
> requests are printed when the command is run with -- debug on. It would
> probably be good to run gdal_translate with -ovr NONE
> https://gdal.org/en/latest/programs/gdal_translate.html#cmdoption-gdal_translate-ovr
> and force it to use the full resolution image, because I quess that your
> code is also hitting the full resolution. Maybe gdal_translate is already
> hitting the same resolution, but by using -ovr it is you who makes the
> decision.
>
>
>
> By reading the values it seems that you request 1073741760 pixels but for
> some reason GDAL believes that there are only 1073741756 pixels available.
> If I were a programmer, I think I would have a try with nXSize=1073741756.
>
>
>
> May I ask why do you want to compress quite a large area of a raster into
> a single line of pixels? You have probably some interesting use case.
>
>
>
> -Jukka Rahkonen-
>
>
>
> *L?hett?j?:* Micha? Kowalczuk <michkowalczuk at gmail.com>
> *L?hetetty:* perjantai 30. elokuuta 2024 10.28
> *Vastaanottaja:* Rahkonen Jukka <jukka.rahkonen at maanmittauslaitos.fi>
> *Kopio:* Robert Coup <robert.coup at koordinates.com>;
> gdal-dev at lists.osgeo.org
> *Aihe:* Re: [gdal-dev] WMTS gdal_translate vs RasterIO
>
>
>
> Full GDAL log attached.
>
> Sorry, but I do not know how to test your suggestion. GDAL logger creates
> some caches and I do not know which http request i should use...
>
>
>
> Thanks, Micha?
>
>
>
> pt., 30 sie 2024 o 09:23 Rahkonen Jukka <
> jukka.rahkonen at maanmittauslaitos.fi> napisa?(a):
>
> Hi,
>
>
>
> Capture and show the http request that your code generates and sends to
> the WMTS server. Does it work if you send the same request with curl or
> with a browser? Or does the error come before the GetTile request is
> generated?
>
>
>
> -Jukka Rahkonen-
>
>
>
> *L?hett?j?:* Micha? Kowalczuk <michkowalczuk at gmail.com>
> *L?hetetty:* perjantai 30. elokuuta 2024 9.59
> *Vastaanottaja:* Robert Coup <robert.coup at koordinates.com>
> *Kopio:* gdal-dev at lists.osgeo.org; Rahkonen Jukka <
> jukka.rahkonen at maanmittauslaitos.fi>
> *Aihe:* Re: [gdal-dev] WMTS gdal_translate vs RasterIO
>
>
>
> Sorry for incorrect sample commands in the last message.
>
> I fixed it. The problem stays the same, because the problem was in email
> not in my tested code.
>
> *gdal_translate -srcwin 0 0 1073741760 1553779 -outsize 691 1
> "WMTS:https://basemap.nationalmap.gov/arcgis/rest/services/USGSHydroCached/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSHydroCached,tilematrixset=default028mm
> <https://basemap.nationalmap.gov/arcgis/rest/services/USGSHydroCached/MapServer/WMTS/1.0.0/WMTSCapabilities.xml,layer=USGSHydroCached,tilematrixset=default028mm>"
> tile.png*
>
>
>
> *GDALDatasetRasterIO(*
>
> *handle_to_wmts_subdataset,*
>
> *eRWFlag=GF_Read,*
>
> *nXOff=0,*
>
> *nYOff=0,*
>
> *nXSize=1073741760,*
>
> *nYSize=1553779,*
>
> *pBuffer - buffer for data,*
>
> *nBufXSize=691,*
>
> *nBufYSize=1,*
>
> *eBufType=GDT_Byte,*
>
> *nBandCount=4,*
>
> *panBandMap=[bIndex ,gIndex, rIndex, aIndex],*
>
> *nPixelSpace=4,*
>
> *nLineSpace=0,*
>
> *nBandSpace=1)*
>
>
>
> Can anyone help me to understand why gdal_translate works and generates
> output file, where GDALRasterIO raises error:
>
> *Requested (0,0) of size 1073741760x1553779 on raster of
> 1073741756x1347126255?*
>
>
>
> czw., 29 sie 2024 o 12:22 Micha? Kowalczuk <michkowalczuk at gmail.com>
> napisa?(a):
>
> I see. I will double check commands, fix and return to this.
>
>
>
> W dniu czw., 29.08.2024 o 12:20 Robert Coup <robert.coup at koordinates.com>
> napisa?(a):
>
> Hi Micha?,
>
>
> In addition to Jukka's key point:
>
>   nBufXSize=1,
>   nBufYSize=691,
>
> appears to be backwards wrt:
>
>
>   -outsize 691 1
>
>
>
> Rob :)
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240830/de6cfd9c/attachment-0001.htm>

From simon.eves at heavy.ai  Fri Aug 30 13:12:25 2024
From: simon.eves at heavy.ai (Simon Eves)
Date: Fri, 30 Aug 2024 13:12:25 -0700
Subject: [gdal-dev] x86/ARM Differences
Message-ID: <CAJf0KTTRpsGZE4_6gy2J33FjHiburA586FYBTi_8TcoJLX8M5Q@mail.gmail.com>

Dear List,

We are in the process of creating an ARM build of our system, and we have
discovered some differences in GDAL behavior between the two.

One is the declared block size of a simple RGB PNG image, which we use for
some raster import tests. The image is 320x225 and gdalinfo on x86 reports
that for the block size of the three bands also. However, on ARM it reports
the block sizes as 320x1.

ubuntu at guest:~/work/heavydb-internal$ gdalinfo
Tests/Import/datafiles/raster/beach.png
Driver: PNG/Portable Network Graphics
Files: Tests/Import/datafiles/raster/beach.png
Size is 320, 225
Image Structure Metadata:
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0,  225.0)
Upper Right (  320.0,    0.0)
Lower Right (  320.0,  225.0)
Center      (  160.0,  112.5)
Band 1 Block=320x1 Type=Byte, ColorInterp=Red
Band 2 Block=320x1 Type=Byte, ColorInterp=Green
Band 3 Block=320x1 Type=Byte, ColorInterp=Blue

PNG file here (as a Zip to avoid risk of binary change)...

https://drive.google.com/file/d/1MaK_oBvX8YjgYNMrDpc0Hv7SlQFZ4890/view?usp=sharing

The second difference is the point order of the (single, outer) ring of a
MULTIPOLYGON when exported and re-imported as GeoJSONL. In either the
export or the import (haven't looked that deeply yet) the ring is getting
reversed. Note that the ring data is actually very bogus (lots of repeated
points and no avoidance of self-intersection). We simplified it to
topologically valid data and then there are no differences between
platforms. So it's possible that the CW/CCW auto-detection/reversal is
getting confused by some floating-point precision differences (which we
have also encountered in other places). We are not worried about this one,
having simplified the test so that it now passes, but the difference is
still slightly concerning.

These differences are consistent on both an AWS G5g.8xlarge and an nVidia
GH200, both running Ubuntu 22.04 and our own build (done on the AWS
instance) of GDAL 3.7.3.

I intend to try 3.9.2 also, as we are intending to upgrade to that for our
next release.

(repost after canceling original post held for moderation due to attachment
size)

-- 
Simon Eves
Senior Rendering Engineer
+1 (415) 902-1996
simon.eves at heavy.ai

<http://www.heavy.ai>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240830/d7c3b416/attachment.htm>

From even.rouault at spatialys.com  Fri Aug 30 13:24:26 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 30 Aug 2024 22:24:26 +0200
Subject: [gdal-dev] x86/ARM Differences
In-Reply-To: <CAJf0KTTRpsGZE4_6gy2J33FjHiburA586FYBTi_8TcoJLX8M5Q@mail.gmail.com>
References: <CAJf0KTTRpsGZE4_6gy2J33FjHiburA586FYBTi_8TcoJLX8M5Q@mail.gmail.com>
Message-ID: <34b3d347-7e22-47bb-9ed9-6c414784404c@spatialys.com>

Simon,


> One is the declared block size of a simple RGB PNG image, which we use 
> for some raster import tests. The image is 320x225 and gdalinfo?on x86 
> reports that for the block size of the three bands also. However, on 
> ARM it reports the block sizes as 320x1.

Yes, this is expected, as on x86_64, on byte images <= 512x512 pixels, 
there's a SSE2 optimization when decoding the whole image, which causes 
the size of the image to be set as the block size. You may disable this 
optimization by setting the GDAL_PNG_WHOLE_IMAGE_OPTIM=OFF config 
option, and you'll get a block height of 1, but I would recommend 
against it, unless this is for the purpose of having reproducible tests

> The second difference is the point order of the (single, outer) ring 
> of a MULTIPOLYGON when exported and re-imported as GeoJSONL. In either 
> the export or the import (haven't looked that deeply yet) the ring is 
> getting reversed. Note that the ring data is actually very bogus (lots 
> of repeated points and no avoidance of self-intersection). We 
> simplified it to topologically valid data and then there are no 
> differences between platforms. So it's possible that the CW/CCW 
> auto-detection/reversal is getting confused by some floating-point 
> precision differences (which we have also encountered in other 
> places). We are not worried about this one, having simplified the test 
> so that it now passes, but the difference is still slightly concerning.

Yes likely a floating-point precision difference in 
OGRLineString::isClockwise() computations

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240830/f80b3eb3/attachment.htm>

From simon.eves at heavy.ai  Fri Aug 30 14:43:09 2024
From: simon.eves at heavy.ai (Simon Eves)
Date: Fri, 30 Aug 2024 14:43:09 -0700
Subject: [gdal-dev] x86/ARM Differences
In-Reply-To: <34b3d347-7e22-47bb-9ed9-6c414784404c@spatialys.com>
References: <CAJf0KTTRpsGZE4_6gy2J33FjHiburA586FYBTi_8TcoJLX8M5Q@mail.gmail.com>
 <34b3d347-7e22-47bb-9ed9-6c414784404c@spatialys.com>
Message-ID: <CAJf0KTSA2kUx0SoexGfYu5v3mDEC=XaRPBxp0k6UdQiKXv8C7g@mail.gmail.com>

Thank you, Even.

Does that whole-image optimization only apply to PNG? I mean, obviously
that particular build option is PNG-specific, but are there other formats
which might exhibit similar differences in presented block size? If it's
just PNG, I'm not worried, as there aren't many geospatial PNGs... :)



On Fri, Aug 30, 2024 at 1:24?PM Even Rouault <even.rouault at spatialys.com>
wrote:

> Simon,
>
> One is the declared block size of a simple RGB PNG image, which we use for
> some raster import tests. The image is 320x225 and gdalinfo on x86
> reports that for the block size of the three bands also. However, on ARM it
> reports the block sizes as 320x1.
>
> Yes, this is expected, as on x86_64, on byte images <= 512x512 pixels,
> there's a SSE2 optimization when decoding the whole image, which causes the
> size of the image to be set as the block size. You may disable this
> optimization by setting the GDAL_PNG_WHOLE_IMAGE_OPTIM=OFF config option,
> and you'll get a block height of 1, but I would recommend against it,
> unless this is for the purpose of having reproducible tests
>
> The second difference is the point order of the (single, outer) ring of a
> MULTIPOLYGON when exported and re-imported as GeoJSONL. In either the
> export or the import (haven't looked that deeply yet) the ring is getting
> reversed. Note that the ring data is actually very bogus (lots of repeated
> points and no avoidance of self-intersection). We simplified it to
> topologically valid data and then there are no differences between
> platforms. So it's possible that the CW/CCW auto-detection/reversal is
> getting confused by some floating-point precision differences (which we
> have also encountered in other places). We are not worried about this one,
> having simplified the test so that it now passes, but the difference is
> still slightly concerning.
>
> Yes likely a floating-point precision difference in
> OGRLineString::isClockwise() computations
>
> Even
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240830/41da0462/attachment.htm>

From even.rouault at spatialys.com  Fri Aug 30 14:54:17 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 30 Aug 2024 23:54:17 +0200
Subject: [gdal-dev] x86/ARM Differences
In-Reply-To: <CAJf0KTSA2kUx0SoexGfYu5v3mDEC=XaRPBxp0k6UdQiKXv8C7g@mail.gmail.com>
References: <CAJf0KTTRpsGZE4_6gy2J33FjHiburA586FYBTi_8TcoJLX8M5Q@mail.gmail.com>
 <34b3d347-7e22-47bb-9ed9-6c414784404c@spatialys.com>
 <CAJf0KTSA2kUx0SoexGfYu5v3mDEC=XaRPBxp0k6UdQiKXv8C7g@mail.gmail.com>
Message-ID: <5ed38265-a24f-4485-a10d-b900cf143306@spatialys.com>

I can't think of other formats with similar behavior right now, but you 
shouldn't trust my memory. That said, reported block sizes might very 
well change with versions. Like in JPEG2000 drivers where heuristics to 
determine which block size to expose may be tuned, although this hasn't 
changed much recently.

Le 30/08/2024 ? 23:43, Simon Eves a ?crit?:
> Thank you, Even.
>
> Does that whole-image optimization only apply to PNG? I mean, 
> obviously that particular build option is PNG-specific, but are there 
> other formats which might exhibit similar differences in presented 
> block size? If it's just PNG, I'm not worried, as there aren't many 
> geospatial PNGs... :)
>
>
>
> On Fri, Aug 30, 2024 at 1:24?PM Even Rouault 
> <even.rouault at spatialys.com> wrote:
>
>     Simon,
>
>
>>     One is the declared block size of a simple RGB PNG image, which
>>     we use for some raster import tests. The image is 320x225 and
>>     gdalinfo?on x86 reports that for the block size of the three
>>     bands also. However, on ARM it reports the block sizes as 320x1.
>
>     Yes, this is expected, as on x86_64, on byte images <= 512x512
>     pixels, there's a SSE2 optimization when decoding the whole image,
>     which causes the size of the image to be set as the block size.
>     You may disable this optimization by setting the
>     GDAL_PNG_WHOLE_IMAGE_OPTIM=OFF config option, and you'll get a
>     block height of 1, but I would recommend against it, unless this
>     is for the purpose of having reproducible tests
>
>>     The second difference is the point order of the (single, outer)
>>     ring of a MULTIPOLYGON when exported and re-imported as GeoJSONL.
>>     In either the export or the import (haven't looked that deeply
>>     yet) the ring is getting reversed. Note that the ring data is
>>     actually very bogus (lots of repeated points and no avoidance of
>>     self-intersection). We simplified it to topologically valid data
>>     and then there are no differences between platforms. So it's
>>     possible that the CW/CCW auto-detection/reversal is getting
>>     confused by some floating-point precision differences (which we
>>     have also encountered in other places). We are not worried about
>>     this one, having simplified the test so that it now passes, but
>>     the difference is still slightly concerning.
>
>     Yes likely a floating-point precision difference in
>     OGRLineString::isClockwise() computations
>
>     Even
>
>     -- 
>     http://www.spatialys.com
>     My software is free, but my time generally not.
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240830/fb02e9b3/attachment-0001.htm>

From simon.eves at heavy.ai  Fri Aug 30 15:28:06 2024
From: simon.eves at heavy.ai (Simon Eves)
Date: Fri, 30 Aug 2024 15:28:06 -0700
Subject: [gdal-dev] x86/ARM Differences
In-Reply-To: <5ed38265-a24f-4485-a10d-b900cf143306@spatialys.com>
References: <CAJf0KTTRpsGZE4_6gy2J33FjHiburA586FYBTi_8TcoJLX8M5Q@mail.gmail.com>
 <34b3d347-7e22-47bb-9ed9-6c414784404c@spatialys.com>
 <CAJf0KTSA2kUx0SoexGfYu5v3mDEC=XaRPBxp0k6UdQiKXv8C7g@mail.gmail.com>
 <5ed38265-a24f-4485-a10d-b900cf143306@spatialys.com>
Message-ID: <CAJf0KTTDv9UagiOEdWricoaB5VGKCpRdFndDF_w17abNXnZB-Q@mail.gmail.com>

Understood. Thank you.

On Fri, Aug 30, 2024 at 2:54?PM Even Rouault <even.rouault at spatialys.com>
wrote:

> I can't think of other formats with similar behavior right now, but you
> shouldn't trust my memory. That said, reported block sizes might very well
> change with versions. Like in JPEG2000 drivers where heuristics to
> determine which block size to expose may be tuned, although this hasn't
> changed much recently.
> Le 30/08/2024 ? 23:43, Simon Eves a ?crit :
>
> Thank you, Even.
>
> Does that whole-image optimization only apply to PNG? I mean, obviously
> that particular build option is PNG-specific, but are there other formats
> which might exhibit similar differences in presented block size? If it's
> just PNG, I'm not worried, as there aren't many geospatial PNGs... :)
>
>
>
> On Fri, Aug 30, 2024 at 1:24?PM Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> Simon,
>>
>> One is the declared block size of a simple RGB PNG image, which we use
>> for some raster import tests. The image is 320x225 and gdalinfo on x86
>> reports that for the block size of the three bands also. However, on ARM it
>> reports the block sizes as 320x1.
>>
>> Yes, this is expected, as on x86_64, on byte images <= 512x512 pixels,
>> there's a SSE2 optimization when decoding the whole image, which causes the
>> size of the image to be set as the block size. You may disable this
>> optimization by setting the GDAL_PNG_WHOLE_IMAGE_OPTIM=OFF config option,
>> and you'll get a block height of 1, but I would recommend against it,
>> unless this is for the purpose of having reproducible tests
>>
>> The second difference is the point order of the (single, outer) ring of a
>> MULTIPOLYGON when exported and re-imported as GeoJSONL. In either the
>> export or the import (haven't looked that deeply yet) the ring is getting
>> reversed. Note that the ring data is actually very bogus (lots of repeated
>> points and no avoidance of self-intersection). We simplified it to
>> topologically valid data and then there are no differences between
>> platforms. So it's possible that the CW/CCW auto-detection/reversal is
>> getting confused by some floating-point precision differences (which we
>> have also encountered in other places). We are not worried about this one,
>> having simplified the test so that it now passes, but the difference is
>> still slightly concerning.
>>
>> Yes likely a floating-point precision difference in
>> OGRLineString::isClockwise() computations
>>
>> Even
>>
>> -- http://www.spatialys.com
>> My software is free, but my time generally not.
>>
>> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240830/582949af/attachment.htm>

From jukka.rahkonen at maanmittauslaitos.fi  Fri Aug 30 15:37:07 2024
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Fri, 30 Aug 2024 22:37:07 +0000
Subject: [gdal-dev] SQLite dialect and ILIKE
Message-ID: <DB9PR09MB688756EC8ADFD3BD51EF4911FD972@DB9PR09MB6887.eurprd09.prod.outlook.com>

Hi,

The documentation of the SQLite dialect https://gdal.org/en/latest/user/sql_sqlite_dialect.html#like-operator can make user believe that the dialect supports ILIKE operator since GDAL version 3.9 but that is not true. Maybe that is a copy-paste error in https://github.com/OSGeo/gdal/commit/1b886786fddfb49a3c3a000e2d1be5eede5b786e  and SQLite dialect is still supposed to have just LIKE . I considered to edit the documentation but I was not sure if I could just remove the two ILIKEs or if there is something more to edit.

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240830/ebeb942f/attachment.htm>

From even.rouault at spatialys.com  Fri Aug 30 15:47:52 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 31 Aug 2024 00:47:52 +0200
Subject: [gdal-dev] SQLite dialect and ILIKE
In-Reply-To: <DB9PR09MB688756EC8ADFD3BD51EF4911FD972@DB9PR09MB6887.eurprd09.prod.outlook.com>
References: <DB9PR09MB688756EC8ADFD3BD51EF4911FD972@DB9PR09MB6887.eurprd09.prod.outlook.com>
Message-ID: <6c0b4427-61fa-48bf-885e-454be6a2d3c0@spatialys.com>

good catch. Fixed in 
https://github.com/OSGeo/gdal/commit/9b1ab02e7b8cb5504cb65cacb287bc717ccee3f7

Le 31/08/2024 ? 00:37, Rahkonen Jukka via gdal-dev a ?crit?:
>
> Hi,
>
> The documentation of the SQLite dialect 
> https://gdal.org/en/latest/user/sql_sqlite_dialect.html#like-operator 
> can make user believe that the dialect supports ILIKE operator since 
> GDAL version 3.9 but that is not true. Maybe that is a copy-paste 
> error in 
> https://github.com/OSGeo/gdal/commit/1b886786fddfb49a3c3a000e2d1be5eede5b786e 
> ?and SQLite dialect is still supposed to have just LIKE . I considered 
> to edit the documentation but I was not sure if I could just remove 
> the two ILIKEs or if there is something more to edit.
>
> -Jukka Rahkonen-
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240831/45ee1970/attachment.htm>

From jukka.rahkonen at maanmittauslaitos.fi  Fri Aug 30 15:52:01 2024
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Fri, 30 Aug 2024 22:52:01 +0000
Subject: [gdal-dev] SQLite dialect and ILIKE
In-Reply-To: <6c0b4427-61fa-48bf-885e-454be6a2d3c0@spatialys.com>
References: <DB9PR09MB688756EC8ADFD3BD51EF4911FD972@DB9PR09MB6887.eurprd09.prod.outlook.com>
 <6c0b4427-61fa-48bf-885e-454be6a2d3c0@spatialys.com>
Message-ID: <DB9PR09MB6887B56C6E20ED6F2AF55499FD972@DB9PR09MB6887.eurprd09.prod.outlook.com>

Hi,

Not my catch really, I was reading https://gis.stackexchange.com/questions/485416/is-the-ilike-operator-in-qgis-not-working-correctly

-Jukka-

L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Even Rouault via gdal-dev
L?hetetty: lauantai 31. elokuuta 2024 1.48
Vastaanottaja: gdal-dev at lists.osgeo.org
Aihe: Re: [gdal-dev] SQLite dialect and ILIKE


good catch. Fixed in https://github.com/OSGeo/gdal/commit/9b1ab02e7b8cb5504cb65cacb287bc717ccee3f7
Le 31/08/2024 ? 00:37, Rahkonen Jukka via gdal-dev a ?crit :
Hi,

The documentation of the SQLite dialect https://gdal.org/en/latest/user/sql_sqlite_dialect.html#like-operator can make user believe that the dialect supports ILIKE operator since GDAL version 3.9 but that is not true. Maybe that is a copy-paste error in https://github.com/OSGeo/gdal/commit/1b886786fddfb49a3c3a000e2d1be5eede5b786e  and SQLite dialect is still supposed to have just LIKE . I considered to edit the documentation but I was not sure if I could just remove the two ILIKEs or if there is something more to edit.

-Jukka Rahkonen-



_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

https://lists.osgeo.org/mailman/listinfo/gdal-dev

--

http://www.spatialys.com<http://www.spatialys.com/>

My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240830/a32f28f6/attachment-0001.htm>

From even.rouault at spatialys.com  Sat Aug 31 07:21:53 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 31 Aug 2024 16:21:53 +0200
Subject: [gdal-dev] Extending GDAL Color Interpretation enumeration for
 infra-red bands (+ band wavelength) ?
Message-ID: <043bce04-fa2a-417d-b03b-72f9e5333ba1@spatialys.com>

Hi,

The GDAL Color Interpretation enumeration is a good start, but is quite 
limited regarding band spectral properties with just Red, Green, Bland, 
and nothing for other band wavelengths, particularly for infra-red.

I was looking a bit at the classifications at 
https://en.wikipedia.org/wiki/Infrared#Regions , and there are several 
ones, like the "commonly used subdivision scheme" (NIR, SWIR, MWIR, 
LWIR, FIR) or "CIE division scheme" (IR-A, IR-B, IR-C) or "ISO 20743 
scheme" (NIR, MIR, FIR).

My inclination would rather to re-use the STAC EO classification at 
https://github.com/stac-extensions/eo?tab=readme-ov-file#common-band-names, 
which shows a lot of similarities with 
https://github.com/awesome-spectral-indices/awesome-spectral-indices#expressions 
, and has a nice mapping with a few popular instruments.

While we are it, should we standardize central wavelength and full width 
half max (FWHM), has special properties of a bands rather than generic 
text-based metadata, like:

double GDALRasterBand::GetCentralWaveLengthMicrometer() -> NaN if unknown
double GDALRasterBand::GetFWHMMicrometer() -> NaN if unknown
void GDALRasterBand::SetCentralWaveLengthMicrometer(double)
void GDALRasterBand::SetFWHMMicrometer(double)

Or maybe just standardize a "CENTRAL_WAVELENGTH" and "FWHM" metadata 
items in the "IMAGERY" metadata domain: 
https://gdal.org/en/latest/user/raster_data_model.html#imagery-domain-remote-sensing 
?

Thoughts?

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From daniel.fred.evans at gmail.com  Sat Aug 31 11:54:24 2024
From: daniel.fred.evans at gmail.com (Daniel Evans)
Date: Sat, 31 Aug 2024 19:54:24 +0100
Subject: [gdal-dev] Extending GDAL Color Interpretation enumeration for
 infra-red bands (+ band wavelength) ?
In-Reply-To: <043bce04-fa2a-417d-b03b-72f9e5333ba1@spatialys.com>
References: <043bce04-fa2a-417d-b03b-72f9e5333ba1@spatialys.com>
Message-ID: <CANnaQabfKTcWKRqrf6OE-FN9fadWW4ubqPfMf3Ps=PoOJuzu_Q@mail.gmail.com>

Hi Even,

Firstly, I'll state my bias as someone involved in the production of
thermal MWIR EO data (3.5-5um) - unsurprisingly, I'd like some
classification that fits my data :-)

> classifications...

The NIR - SWIR - MWIR - LWIR classification scheme is by far the most
common I've encountered in earth observation. I've never encountered the
CIE scheme or the ISO 20473 scheme in EO - the ISO definition of Mid(wave)
Infrared extending all the way out to 30um is definitely not typical usage.

Thermal Infrared (TIR) can be used as a blanket term for MWIR and LWIR. I
don't know if GDAL users would find it useful to split the two, or just
have a broad TIR classification; MWIR data products are still relatively
rare.

I'm not immediately aware of any commonly used Far Infrared (>15um) EO data
products.

On the two Github links you shared, some thoughts are:
- Both lack any entry covering the MWIR (~3-5um)
- The "Thermal" definition on the second link is LWIR only, not the more
normal MWIR+LWIR definition
- The second link in particular is heavily aimed at describing Sentinel and
Landsat - not unfair, given that they are the most widely used IR datasets!
However, the subclassifications in the second link - "NIR", "NIR 2", "SWIR
1", "SWIR 2", "Thermal 1", "Thermal 2" - are not generic terms in my
experience. The terms in the first link (swir16, swir22, lwir11, lwir12)
are more familiar if GDAL were to go to that level of detail, but I think
you'd still need generic "swir"/"lwir" names to cover data that don't match
the Sentinel/Landsat ecosystem.


> FWHM and Central Wavelength

I think this is the most sensible description of a band.

I would be in favour of your suggestion of making them generic across all
bands via the IMAGERY metadata, not just IR. The increasing number of
multispectral/hyperspectral EO missions mean that simple RGB
classifications for optical data without further description are not always
appropriate. The stac-extensions repo already shows the addition of extra
terms like "coastal", "green05", and "yellow" to further define optical
bands.

No strong opinions personally on whether that wider definition uses nm or
um for the unit, but perhaps others have a strong opinion on "red" being
"650nm" vs. "0.65um"?

Cheers,
Daniel

On Sat, 31 Aug 2024 at 15:22, Even Rouault via gdal-dev <
gdal-dev at lists.osgeo.org> wrote:

> Hi,
>
> The GDAL Color Interpretation enumeration is a good start, but is quite
> limited regarding band spectral properties with just Red, Green, Bland,
> and nothing for other band wavelengths, particularly for infra-red.
>
> I was looking a bit at the classifications at
> https://en.wikipedia.org/wiki/Infrared#Regions , and there are several
> ones, like the "commonly used subdivision scheme" (NIR, SWIR, MWIR,
> LWIR, FIR) or "CIE division scheme" (IR-A, IR-B, IR-C) or "ISO 20743
> scheme" (NIR, MIR, FIR).
>
> My inclination would rather to re-use the STAC EO classification at
> https://github.com/stac-extensions/eo?tab=readme-ov-file#common-band-names,
>
> which shows a lot of similarities with
>
> https://github.com/awesome-spectral-indices/awesome-spectral-indices#expressions
> , and has a nice mapping with a few popular instruments.
>
> While we are it, should we standardize central wavelength and full width
> half max (FWHM), has special properties of a bands rather than generic
> text-based metadata, like:
>
> double GDALRasterBand::GetCentralWaveLengthMicrometer() -> NaN if unknown
> double GDALRasterBand::GetFWHMMicrometer() -> NaN if unknown
> void GDALRasterBand::SetCentralWaveLengthMicrometer(double)
> void GDALRasterBand::SetFWHMMicrometer(double)
>
> Or maybe just standardize a "CENTRAL_WAVELENGTH" and "FWHM" metadata
> items in the "IMAGERY" metadata domain:
>
> https://gdal.org/en/latest/user/raster_data_model.html#imagery-domain-remote-sensing
> ?
>
> Thoughts?
>
> Even
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240831/11ccb4ff/attachment.htm>

From jukka.rahkonen at maanmittauslaitos.fi  Sat Aug 31 12:48:19 2024
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Sat, 31 Aug 2024 19:48:19 +0000
Subject: [gdal-dev] Extending GDAL Color Interpretation enumeration for
 infra-red bands (+ band wavelength) ?
In-Reply-To: <CANnaQabfKTcWKRqrf6OE-FN9fadWW4ubqPfMf3Ps=PoOJuzu_Q@mail.gmail.com>
References: <043bce04-fa2a-417d-b03b-72f9e5333ba1@spatialys.com>
 <CANnaQabfKTcWKRqrf6OE-FN9fadWW4ubqPfMf3Ps=PoOJuzu_Q@mail.gmail.com>
Message-ID: <DB9PR09MB68875E538CAEB17A654FDB67FD902@DB9PR09MB6887.eurprd09.prod.outlook.com>

Hi,

In terrestrial applications (thermal cameras) I think I have only seen MWIR and LWIR, and due to the atmospheric windows the first typically means about 3,5-5um and the latter 8-14um. Such instruments usually support only either MWIR or LWIR. I think it would be good to separate MWIR and LWIR.

-Jukka Rahkonen-

L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Daniel Evans via gdal-dev
L?hetetty: lauantai 31. elokuuta 2024 21.54
Vastaanottaja: Even Rouault <even.rouault at spatialys.com>
Kopio: gdal-dev at lists.osgeo.org
Aihe: Re: [gdal-dev] Extending GDAL Color Interpretation enumeration for infra-red bands (+ band wavelength) ?

Hi Even,

Firstly, I'll state my bias as someone involved in the production of thermal MWIR EO data (3.5-5um) - unsurprisingly, I'd like some classification that fits my data :-)

> classifications...

The NIR - SWIR - MWIR - LWIR classification scheme is by far the most common I've encountered in earth observation. I've never encountered the CIE scheme or the ISO 20473 scheme in EO - the ISO definition of Mid(wave) Infrared extending all the way out to 30um is definitely not typical usage.

Thermal Infrared (TIR) can be used as a blanket term for MWIR and LWIR. I don't know if GDAL users would find it useful to split the two, or just have a broad TIR classification; MWIR data products are still relatively rare.

I'm not immediately aware of any commonly used Far Infrared (>15um) EO data products.

On the two Github links you shared, some thoughts are:
- Both lack any entry covering the MWIR (~3-5um)
- The "Thermal" definition on the second link is LWIR only, not the more normal MWIR+LWIR definition
- The second link in particular is heavily aimed at describing Sentinel and Landsat - not unfair, given that they are the most widely used IR datasets! However, the subclassifications in the second link - "NIR", "NIR 2", "SWIR 1", "SWIR 2", "Thermal 1", "Thermal 2" - are not generic terms in my experience. The terms in the first link (swir16, swir22, lwir11, lwir12) are more familiar if GDAL were to go to that level of detail, but I think you'd still need generic "swir"/"lwir" names to cover data that don't match the Sentinel/Landsat ecosystem.


> FWHM and Central Wavelength

I think this is the most sensible description of a band.

I would be in favour of your suggestion of making them generic across all bands via the IMAGERY metadata, not just IR. The increasing number of multispectral/hyperspectral EO missions mean that simple RGB classifications for optical data without further description are not always appropriate. The stac-extensions repo already shows the addition of extra terms like "coastal", "green05", and "yellow" to further define optical bands.

No strong opinions personally on whether that wider definition uses nm or um for the unit, but perhaps others have a strong opinion on "red" being "650nm" vs. "0.65um"?

Cheers,
Daniel

On Sat, 31 Aug 2024 at 15:22, Even Rouault via gdal-dev <gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>> wrote:
Hi,

The GDAL Color Interpretation enumeration is a good start, but is quite
limited regarding band spectral properties with just Red, Green, Bland,
and nothing for other band wavelengths, particularly for infra-red.

I was looking a bit at the classifications at
https://en.wikipedia.org/wiki/Infrared#Regions , and there are several
ones, like the "commonly used subdivision scheme" (NIR, SWIR, MWIR,
LWIR, FIR) or "CIE division scheme" (IR-A, IR-B, IR-C) or "ISO 20743
scheme" (NIR, MIR, FIR).

My inclination would rather to re-use the STAC EO classification at
https://github.com/stac-extensions/eo?tab=readme-ov-file#common-band-names,
which shows a lot of similarities with
https://github.com/awesome-spectral-indices/awesome-spectral-indices#expressions
, and has a nice mapping with a few popular instruments.

While we are it, should we standardize central wavelength and full width
half max (FWHM), has special properties of a bands rather than generic
text-based metadata, like:

double GDALRasterBand::GetCentralWaveLengthMicrometer() -> NaN if unknown
double GDALRasterBand::GetFWHMMicrometer() -> NaN if unknown
void GDALRasterBand::SetCentralWaveLengthMicrometer(double)
void GDALRasterBand::SetFWHMMicrometer(double)

Or maybe just standardize a "CENTRAL_WAVELENGTH" and "FWHM" metadata
items in the "IMAGERY" metadata domain:
https://gdal.org/en/latest/user/raster_data_model.html#imagery-domain-remote-sensing
?

Thoughts?

Even

--
http://www.spatialys.com<http://www.spatialys.com/>
My software is free, but my time generally not.

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240831/5de06a00/attachment.htm>

From schwehr at gmail.com  Sat Aug 31 14:30:20 2024
From: schwehr at gmail.com (Kurt Schwehr)
Date: Sat, 31 Aug 2024 14:30:20 -0700
Subject: [gdal-dev] Call for review on RFC 101: Raster dataset read-only
 thread-safety
In-Reply-To: <60268c3f-1edd-42fa-9081-6d296aa765a7@spatialys.com>
References: <60268c3f-1edd-42fa-9081-6d296aa765a7@spatialys.com>
Message-ID: <CACmBxyurQN+xqN7qx1dD7ioh-UC5o8a9_89VK79wSqw0s12h6Q@mail.gmail.com>

Thank you Even for this! I don't have any comments after a quick read
beyond appreciating that you discussed an alternative approach.

-Kurt

On Thu, Aug 29, 2024 at 5:27?AM Even Rouault via gdal-dev <
gdal-dev at lists.osgeo.org> wrote:

> Hi,
>
> I've worked on a new RFC 101: Raster dataset read-only thread-safety:
> https://github.com/OSGeo/gdal/pull/10676
>
> Summary: This RFC enables users to get instances of GDALDataset (and
> their related objects such as GDALRasterBand) that are thread-safe for
> read-only raster operations, that is such instances can be safely used
> from multiple threads without locking.
>
> It is backed by a preliminary implementation (fairly complete, apart
> from writing new tests...). There's at least one open question raised in
> the RFC.
>
> PS: you can see one of the benefits of the migration of the doc to
> ReadTheDocs hosting, with the preview of the updated documentation in
> pull requests. So this is a way to mention that the move to RtD hosting
> has now been completed, with the default version ("latest") reflecting
> the state of the master branch, as well as the version for the
> release/3.9 branch. Thanks to Dan Baston (and other people involved) for
> this work! There might be a few adjustments needed, so if you notice
> something unusual w.r.t. to the previous state, please file a ticket.
>
> Even
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240831/7a2c09b2/attachment-0001.htm>

From roelanto at gmail.com  Sat Aug 31 15:11:18 2024
From: roelanto at gmail.com (Roelant Ossewaarde)
Date: Sun, 1 Sep 2024 00:11:18 +0200
Subject: [gdal-dev] How to process non-default S-57 layers
Message-ID: <CAM9e0nASRzaCPvoDfxEo4SLt5E11xmzO7S6m7juyKT7XsiU1+w@mail.gmail.com>

I am working with S-57-files provided by Dutch Rijkswaterstaat, for
example downloadable from [here] (publicly available). I'm trying to
extract information from the layers with gdal (python).

The Inland charts have layers with OBJL attributes that denote feature
types that do not seem to appear in s57objectclasses.csv:

?????
? bash-3.2$ ogrinfo 1R7YM004/1R7YM004.000 Generic |grep OBJL | uniq -c
? Warning 1: Attributes BCNSHP ignored, not in expected schema.
? No more warnings will be issued for this dataset.
? Warning 1: Illegal feature attribute id (ATTF:ATTL[4]) of 17011
? on feature FIDN=-115676329, FIDS=64091.
? Skipping attribute. No more warnings will be issued.
?    1 OBJL: Integer (5.0)
?    4   OBJL (Integer) = 17028
?   47   OBJL (Integer) = 17029
?   10   OBJL (Integer) = 17032
?   33   OBJL (Integer) = 17031
?    2   OBJL (Integer) = 17067
? bash-3.2$
?????

As far as I understand, this means that the encoder used layers that are
non-standard. I see in the s57objectclasses.csv that 17XXX layers are
specific to inland waterways, but these particular layers are missing:

?????
? ...
? 0,"###Codes in the 17xxx range come from past s57objectclasses_iw.csv
(Inland Waterways)",,,,,,
? 17000,Anchor
berth,achbrt,catach;clsdng;comctn;DATEND;DATSTA;NOBJNM;OBJNAM;PEREND;PERSTA;RADIUS;restrn;STATUS;,INFORM;NINFOM;NTXTDS;PICREP;SCAMIN;TXTDSC;updmsg;,SORDAT;SORIND;,G,Point;Area;
? 17001,Anchorage
area,achare,catach;clsdng;comctn;DATEND;DATSTA;NOBJNM;OBJNAM;PEREND;PERSTA;restrn;STATUS;,INFORM;NINFOM;NTXTDS;PICREP;SCAMIN;TXTDSC;updmsg;,SORDAT;SORIND;,G,Point;Area;
? ...
? 17018,Navigational system of
marks,m_nsys,marsys;ORIENT;,INFORM;NINFOM;NTXTDS;SCAMIN;TXTDSC;updmsg;,SORDAT;SORIND;,G,Area;
? ... <missing layers?> ...
? 17050,Notice
mark,notmrk,catnmk;fnctnm;dirimp;disipd;disipu;disbk1;disbk2;addmrk;marsys;ORIENT;CONDTN;NOBJNM;OBJNAM;STATUS;,INFORM;NINFOM;NTXTDS;PICREP;SCAMIN;TXTDSC;updmsg;,SORDAT;SORIND;,G,Point;
? 17051,Waterway
axis,wtwaxs,catccl;NOBJNM;OBJNAM;,INFORM;NINFOM;NTXTDS;PICREP;SCAMIN;TXTDSC;updmsg;,SORDAT;SORIND;,G,Line;
?????

Am I supposed to add these objectclasses myself to the csv-file? How
would I know which attributes to add for these particular features? Is
there perhaps a simpler way to extract that information?

Kind regards,

Roelant.


[here]
<
https://vaarweginformatie.nl/fdd/main/wicket/resource/org.apache.wicket.Application/downloadfileResource?fileId=4016201503
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240901/a6476ae7/attachment.htm>

From rykovd at gmail.com  Sat Aug 31 15:17:55 2024
From: rykovd at gmail.com (Denis Rykov)
Date: Sun, 1 Sep 2024 00:17:55 +0200
Subject: [gdal-dev] AutoCreateWarpedVRT changes Int16 raster to Int32
Message-ID: <CAJbvKNoYMxa_JXK7BMwN=Zu1HHU2GE7hrjxegOmVxQfO4=Ab7g@mail.gmail.com>

Issue Report Rephrased:

For certain rasters with an *Int16* data type, calling AutoCreateWarpedVRT
changes the dataset type to *Int32*. For example:

>>> ds1 = gdal.Open("dem.tif", gdalconst.GA_ReadOnly)
>>> ds1.GetRasterBand(1).DataType
3
>>> ds2 = gdal.AutoCreateWarpedVRT(ds1)
>>> ds2.GetRasterBand(1).DataType
5
>>> ds2.GetRasterBand(1).GetNoDataValue()
32767.0

However, when I tested it on another raster, the type did not change:

>>> ds1 = gdal.Open("int16_50m.tif", gdalconst.GA_ReadOnly)
>>> ds1.GetRasterBand(1).DataType
3
>>> ds2 = gdal.AutoCreateWarpedVRT(ds1)
>>> ds2.GetRasterBand(1).DataType
3
>>> ds2.GetRasterBand(1).GetNoDataValue()
-32768.0

Is this a bug? It appears that the data type change might be influenced by
the nodata value.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240901/1c13ab2c/attachment.htm>

From even.rouault at spatialys.com  Sat Aug 31 15:58:37 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 1 Sep 2024 00:58:37 +0200
Subject: [gdal-dev] AutoCreateWarpedVRT changes Int16 raster to Int32
In-Reply-To: <CAJbvKNoYMxa_JXK7BMwN=Zu1HHU2GE7hrjxegOmVxQfO4=Ab7g@mail.gmail.com>
References: <CAJbvKNoYMxa_JXK7BMwN=Zu1HHU2GE7hrjxegOmVxQfO4=Ab7g@mail.gmail.com>
Message-ID: <7f711e81-0dfd-40e4-b768-a5176145fbd3@spatialys.com>

What is the gdalinfo output on dem.tif ?


> Is this a bug? It appears that the data type change might be 
> influenced by the nodata value.
Yes, there is some logic to take the "union" of the largest data types 
involved in the warping (but it should probably ignore nodata values 
that are outside of the validity range of the input data type. I didn't 
check what it does currently)
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240901/17d45afc/attachment.htm>

From public at postholer.com  Sat Aug 31 20:27:46 2024
From: public at postholer.com (Scott)
Date: Sat, 31 Aug 2024 20:27:46 -0700
Subject: [gdal-dev] Extending GDAL Color Interpretation enumeration for
 infra-red bands (+ band wavelength) ?
In-Reply-To: <043bce04-fa2a-417d-b03b-72f9e5333ba1@spatialys.com>
References: <043bce04-fa2a-417d-b03b-72f9e5333ba1@spatialys.com>
Message-ID: <4578d951-2083-4f6a-9473-5e97b34cbff2@postholer.com>

Given so many possible uses of band data, promote the use of meta data 
embedded in the image to suggest how the image should be rendered.

There is no way to make everyone happy. To me, a raster is 
multidimensional data storage and has absolutely nothing to do with the 
data source. Trying to anticipate every possible use now and in the 
future would be quite the feat.

Scott

On 8/31/24 07:21, Even Rouault via gdal-dev wrote:
> Hi,
> 
> The GDAL Color Interpretation enumeration is a good start, but is quite 
> limited regarding band spectral properties with just Red, Green, Bland, 
> and nothing for other band wavelengths, particularly for infra-red.
> 
> I was looking a bit at the classifications at 
> https://en.wikipedia.org/wiki/Infrared#Regions , and there are several 
> ones, like the "commonly used subdivision scheme" (NIR, SWIR, MWIR, 
> LWIR, FIR) or "CIE division scheme" (IR-A, IR-B, IR-C) or "ISO 20743 
> scheme" (NIR, MIR, FIR).
> 
> My inclination would rather to re-use the STAC EO classification at 
> https://github.com/stac-extensions/eo?tab=readme-ov-file#common-band-names, which shows a lot of similarities with https://github.com/awesome-spectral-indices/awesome-spectral-indices#expressions , and has a nice mapping with a few popular instruments.
> 
> While we are it, should we standardize central wavelength and full width 
> half max (FWHM), has special properties of a bands rather than generic 
> text-based metadata, like:
> 
> double GDALRasterBand::GetCentralWaveLengthMicrometer() -> NaN if unknown
> double GDALRasterBand::GetFWHMMicrometer() -> NaN if unknown
> void GDALRasterBand::SetCentralWaveLengthMicrometer(double)
> void GDALRasterBand::SetFWHMMicrometer(double)
> 
> Or maybe just standardize a "CENTRAL_WAVELENGTH" and "FWHM" metadata 
> items in the "IMAGERY" metadata domain: 
> https://gdal.org/en/latest/user/raster_data_model.html#imagery-domain-remote-sensing ?
> 
> Thoughts?
> 
> Even
> 

From rykovd at gmail.com  Sat Aug 31 22:55:44 2024
From: rykovd at gmail.com (Denis Rykov)
Date: Sun, 1 Sep 2024 07:55:44 +0200
Subject: [gdal-dev] AutoCreateWarpedVRT changes Int16 raster to Int32
In-Reply-To: <7f711e81-0dfd-40e4-b768-a5176145fbd3@spatialys.com>
References: <CAJbvKNoYMxa_JXK7BMwN=Zu1HHU2GE7hrjxegOmVxQfO4=Ab7g@mail.gmail.com>
 <7f711e81-0dfd-40e4-b768-a5176145fbd3@spatialys.com>
Message-ID: <CAJbvKNp1j1GjAZMGFhkiN2cUorEyXk4x8_R+hOVDFPGHrgifvA@mail.gmail.com>

$ gdalinfo dem.tif
Driver: GTiff/GeoTIFF
Files: dem.tif
Size is 1541, 1335
Coordinate System is:
GEOGCRS["WGS 84",
    ENSEMBLE["World Geodetic System 1984 ensemble",
        MEMBER["World Geodetic System 1984 (Transit)"],
        MEMBER["World Geodetic System 1984 (G730)"],
        MEMBER["World Geodetic System 1984 (G873)"],
        MEMBER["World Geodetic System 1984 (G1150)"],
        MEMBER["World Geodetic System 1984 (G1674)"],
        MEMBER["World Geodetic System 1984 (G1762)"],
        MEMBER["World Geodetic System 1984 (G2139)"],
        MEMBER["World Geodetic System 1984 (G2296)"],
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]],
        ENSEMBLEACCURACY[2.0]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["geodetic latitude (Lat)",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["geodetic longitude (Lon)",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    USAGE[
        SCOPE["Horizontal component of 3D system."],
        AREA["World."],
        BBOX[-90,-180,90,180]],
    ID["EPSG",4326]]
Data axis to CRS axis mapping: 2,1
Origin = (76.738472222222228,43.403749999999995)
Pixel Size = (0.000277777777778,-0.000277777777778)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  COMPRESSION=DEFLATE
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (  76.7384722,  43.4037500) ( 76d44'18.50"E, 43d24'13.50"N)
Lower Left  (  76.7384722,  43.0329167) ( 76d44'18.50"E, 43d 1'58.50"N)
Upper Right (  77.1665278,  43.4037500) ( 77d 9'59.50"E, 43d24'13.50"N)
Lower Right (  77.1665278,  43.0329167) ( 77d 9'59.50"E, 43d 1'58.50"N)
Center      (  76.9525000,  43.2183333) ( 76d57' 9.00"E, 43d13' 6.00"N)
Band 1 Block=1541x2 Type=Int16, ColorInterp=Gray
  NoData Value=-32768

On Sun, Sep 1, 2024 at 12:58?AM Even Rouault <even.rouault at spatialys.com>
wrote:

> What is the gdalinfo output on dem.tif ?
>
> Is this a bug? It appears that the data type change might be influenced by
> the nodata value.
>
> Yes, there is some logic to take the "union" of the largest data types
> involved in the warping (but it should probably ignore nodata values that
> are outside of the validity range of the input data type. I didn't check
> what it does currently)
>
>
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240901/e032bc23/attachment-0001.htm>

From rykovd at gmail.com  Sat Aug 31 23:00:54 2024
From: rykovd at gmail.com (Denis Rykov)
Date: Sun, 1 Sep 2024 08:00:54 +0200
Subject: [gdal-dev] AutoCreateWarpedVRT changes Int16 raster to Int32
In-Reply-To: <7f711e81-0dfd-40e4-b768-a5176145fbd3@spatialys.com>
References: <CAJbvKNoYMxa_JXK7BMwN=Zu1HHU2GE7hrjxegOmVxQfO4=Ab7g@mail.gmail.com>
 <7f711e81-0dfd-40e4-b768-a5176145fbd3@spatialys.com>
Message-ID: <CAJbvKNrm9+hAcBhmqJ_V9DTM4gA_=7YsYh+CBjndenhpFqdpmQ@mail.gmail.com>

Please disregard my previous message with the gdalinfo output. Here is the
correct one:

$ gdalinfo "dem.tif"
Driver: GTiff/GeoTIFF
Files: dem.tif
Size is 1541, 1335
Coordinate System is:
GEOGCRS["WGS 84",
    ENSEMBLE["World Geodetic System 1984 ensemble",
        MEMBER["World Geodetic System 1984 (Transit)"],
        MEMBER["World Geodetic System 1984 (G730)"],
        MEMBER["World Geodetic System 1984 (G873)"],
        MEMBER["World Geodetic System 1984 (G1150)"],
        MEMBER["World Geodetic System 1984 (G1674)"],
        MEMBER["World Geodetic System 1984 (G1762)"],
        MEMBER["World Geodetic System 1984 (G2139)"],
        MEMBER["World Geodetic System 1984 (G2296)"],
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]],
        ENSEMBLEACCURACY[2.0]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["geodetic latitude (Lat)",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["geodetic longitude (Lon)",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    USAGE[
        SCOPE["Horizontal component of 3D system."],
        AREA["World."],
        BBOX[-90,-180,90,180]],
    ID["EPSG",4326]]
Data axis to CRS axis mapping: 2,1
Origin = (76.738472222222228,43.403749999999995)
Pixel Size = (0.000277777777778,-0.000277777777778)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  COMPRESSION=DEFLATE
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (  76.7384722,  43.4037500) ( 76d44'18.50"E, 43d24'13.50"N)
Lower Left  (  76.7384722,  43.0329167) ( 76d44'18.50"E, 43d 1'58.50"N)
Upper Right (  77.1665278,  43.4037500) ( 77d 9'59.50"E, 43d24'13.50"N)
Lower Right (  77.1665278,  43.0329167) ( 77d 9'59.50"E, 43d 1'58.50"N)
Center      (  76.9525000,  43.2183333) ( 76d57' 9.00"E, 43d13' 6.00"N)
Band 1 Block=1541x2 Type=Int16, ColorInterp=Gray
  NoData Value=32767

On Sun, Sep 1, 2024 at 12:58?AM Even Rouault <even.rouault at spatialys.com>
wrote:

> What is the gdalinfo output on dem.tif ?
>
> Is this a bug? It appears that the data type change might be influenced by
> the nodata value.
>
> Yes, there is some logic to take the "union" of the largest data types
> involved in the warping (but it should probably ignore nodata values that
> are outside of the validity range of the input data type. I didn't check
> what it does currently)
>
>
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20240901/bfdfcdb0/attachment.htm>

