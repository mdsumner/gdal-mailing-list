From sean at mapbox.com  Sun Mar  1 08:14:43 2015
From: sean at mapbox.com (Sean Gillies)
Date: Sun, 1 Mar 2015 09:14:43 -0700
Subject: [gdal-dev] gdallocationinfo.exe multiple access
In-Reply-To: <201502281911.31066.even.rouault@spatialys.com>
References: <CAPqnkJQtcQ6LU_24NbFcpryE4-dBKRjX036-x2_1dTqqjY4c0g@mail.gmail.com>
	<201502281842.42600.even.rouault@spatialys.com>
	<CAPqnkJQq1ZwwETyRbYrN9ADQTsD3Q3WV9E7cZgZJSKx=5Z4Okw@mail.gmail.com>
	<201502281911.31066.even.rouault@spatialys.com>
Message-ID: <CADPhZXwa+v=q6pwJXr1rCZ7d1of7hohp4spKyFypFz2T4JGOYg@mail.gmail.com>

Yuta, Even:

Rasterio's rio-sample command

  https://github.com/mapbox/rasterio/blob/master/docs/cli.rst#sample
  https://github.com/mapbox/rasterio/blob/master/rasterio/rio/sample.py

can do any number of x, y pairs and only loads image data once. I think
it's a pretty good example of how to do this. And it's all GDAL under the
hood (but not GDAL's own Python bindings), so you get the same answer as
you would from GDAL.


On Sat, Feb 28, 2015 at 11:11 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le samedi 28 f?vrier 2015 19:03:21, Yuta Sato a ?crit :
> > Dear Even Rouault:
> > Thanks for full Python script. I understood this.
> >
> > However, since my lons and lats are thousands, it is taking days to
> extract
> > the values. So, my question is how can I sped up it. Is it possible to
> call
> > several tuples of lons and lats simultaneously? For loop is doing one by
> > one right?
>
> Days for just thousands of values ? I hope not...
> If you suffer from bad performance, you can try to sort the values by
> decreasing latitudes (and for equal latitude, by increasing longitude), so
> as
> to be nice with the typical organization of raster files and with the GDAL
> block cache. Alternatively/complementarily you can increase the maximum
> size
> of the GDAL block cache. The default value is 40 MB. If you call
> gdal.SetConfigOption('GDAL_CACHEMAX', '500'), you'll increase it to 500 MB.
> Otherwise if the dataset can entirely fit into memory, you can read it
> fully
> with ds.ReadAsArray(), and read directly from the returned array with the
> (x,y) computed as below.
> Parallel python could be a solution if you really need parallized
> processing.
> But I guess the complication would only be worth if you must deal with
> millions or billions of coordinate pairs.
>
> >
> > On Sun, Mar 1, 2015 at 2:42 AM, Even Rouault <even.rouault at spatialys.com
> >
> >
> > wrote:
> > > Le samedi 28 f?vrier 2015 18:29:01, Yuta Sato a ?crit :
> > > > Dear Even Rouault:
> > > >
> > > > Thanks for you quick response.
> > > > Unfortunately, I do not know how to pipe using python script.
> > > > I just know to use as follows:
> > > >
> > > > for x, y in zip(lons, lats):
> > > >         vals = subprocess.check_output([gdallocationinfo, '-valonly',
> > > >
> > > > '-l_srs', 'wgs84', image, str(x), str(y)])
> > > >
> > > > The input lons and lats are in the text file.
> > >
> > > As I suggested, you'd better extract the gist of
> > >
> http://svn.osgeo.org/gdal/trunk/gdal/swig/python/samples/val_at_coord.py
> > >
> > > So something like
> > >
> > > from osgeo import gdal
> > > from osgeo import osr
> > >
> > > ds = gdal.Open( image )
> > >
> > > srs = osr.SpatialReference()
> > > srs.ImportFromWkt(ds.GetProjection())
> > >
> > > srs_wgs84 = osr.SpatialReference()
> > > srs_wgs84.SetFromUserInput('WGS84')
> > >
> > > ct = osr.CoordinateTransformation(srs_wgs84, srs)
> > >
> > > for lon, lat in zip(lons, lats):
> > >         (X, Y, _) = ct.TransformPoint(lon, lat)
> > >
> > >         geomatrix = ds.GetGeoTransform()
> > >         (success, inv_geometrix) = gdal.InvGeoTransform(geomatrix)
> > >         x = int(inv_geometrix[0] + inv_geometrix[1] * X +
> > >         inv_geometrix[2]
> > >
> > > * Y)
> > >
> > >         y = int(inv_geometrix[3] + inv_geometrix[4] * X +
> > >         inv_geometrix[5]
> > >
> > > * Y)
> > >
> > >         vals = ds.ReadAsArray(x,y,1,1)
> > > >
> > > > Can you help me?
> > > > <https://plus.google.com/u/0/106381021255842353792?prsrc=4>
> > > >
> > > > On Sun, Mar 1, 2015 at 2:05 AM, Even Rouault
> > > > <even.rouault at spatialys.com
> > > >
> > > > wrote:
> > > > > Le samedi 28 f?vrier 2015 17:51:47, Yuta Sato a ?crit :
> > > > > > I have a list of longitudes and latitudes for which I extract the
> > >
> > > pixel
> > >
> > > > > > values using gdallocationinfo.exe one by one for each pairs of
> > > > > > longitudes and latitudes using for loop.
> > > > > >
> > > > > > How I simultaneously get pixel values for all the list of
> > > > > > longitudes and latitudes?
> > > > > > My list is large, so I want faster retrieval.
> > > > > > I am using python and outputting the pixel values into text file.
> > > > > > Is it possible?
> > > > >
> > > > > Yuka,
> > > > >
> > > > > you can pipe into gdallocationinfo several tuples of coordinates:
> > > > >
> > > > > $ printf "0 0\n0 1\n" | gdallocationinfo byte.tif
> > > > >
> > > > > Report:
> > > > >   Location: (0P,0L)
> > > > >
> > > > >   Band 1:
> > > > >     Value: 107
> > > > >
> > > > > Report:
> > > > >   Location: (0P,1L)
> > > > >
> > > > >   Band 1:
> > > > >     Value: 115
> > > > >
> > > > > But I think it would be easier/faster to just do that fully in
> > > > > Python.
> > >
> > > > > The following script has likely everything you need to do that:
> > >
> http://svn.osgeo.org/gdal/trunk/gdal/swig/python/samples/val_at_coord.py
> > >
> > > > > Even
> > > > >
> > > > >
> > > > > --
> > > > > Spatialys - Geospatial professional services
> > > > > http://www.spatialys.com
> > >
> > > --
> > > Spatialys - Geospatial professional services
> > > http://www.spatialys.com
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150301/ac7f010e/attachment.html>

From even.rouault at spatialys.com  Mon Mar  2 03:20:22 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 2 Mar 2015 12:20:22 +0100
Subject: [gdal-dev] Motion: Adopt RFC 54: Dataset transactions
In-Reply-To: <201502261024.53027.even.rouault@spatialys.com>
References: <201502261024.53027.even.rouault@spatialys.com>
Message-ID: <201503021220.22315.even.rouault@spatialys.com>

Le jeudi 26 f?vrier 2015 10:24:52, Even Rouault a ?crit :
> Hi,
> 
> As no points have been raised,
> 
> Motion : I move to adopt RFC 54: Dataset transactions
> 
> http://trac.osgeo.org/gdal/wiki/rfc54_dataset_transactions
> 
> Starting with my +1

Just a remainder this motion is under vote.

> 
> Best regards,
> 
> Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From howard at hobu.co  Mon Mar  2 06:11:50 2015
From: howard at hobu.co (Howard Butler)
Date: Mon, 2 Mar 2015 08:11:50 -0600
Subject: [gdal-dev] Motion: Adopt RFC 54: Dataset transactions
In-Reply-To: <201503021220.22315.even.rouault@spatialys.com>
References: <201502261024.53027.even.rouault@spatialys.com>
	<201503021220.22315.even.rouault@spatialys.com>
Message-ID: <ABC8F919-82DF-4BEE-AC09-0F17F930D38E@hobu.co>


> On Mar 2, 2015, at 5:20 AM, Even Rouault <even.rouault at spatialys.com> wrote:
> 
> Le jeudi 26 f?vrier 2015 10:24:52, Even Rouault a ?crit :
>> Hi,
>> 
>> As no points have been raised,
>> 
>> Motion : I move to adopt RFC 54: Dataset transactions
>> 
>> http://trac.osgeo.org/gdal/wiki/rfc54_dataset_transactions
>> 
>> Starting with my +1
> 
> Just a remainder this motion is under vote.

+1

Howard

From robert at roproducts.de  Mon Mar  2 08:01:10 2015
From: robert at roproducts.de (Robert Oehler)
Date: Mon, 2 Mar 2015 17:01:10 +0100
Subject: [gdal-dev] reprojection issue
Message-ID: <B5413323-F1D9-4A79-9411-35E32D822D67@roproducts.de>

Hi,

I?m developing a raster library using GDAL. I use the Java bindings.

I would like to do a reprojection of an image which I have in memory.

I?m using an in-memory driver to create a dataset. I fill it with the properties of the image and its data.

Now I?m doing

Dataset warped = gdal.AutoCreateWarpedVRT(ds, src_proj.ExportToWkt(), dst_proj.ExportToWkt());

but the resulting raster is very different from the original. (720,720 --> 635,810) while the resulting bounding box is correct (compared to my own reprojection implementation)

What am I doing wrong?

I?ve seen gdal.reprojectImage(..) What is the difference? Is it preferable in my case ?

Thank you

Robert Oehler

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150302/b4a094ac/attachment.html>

From gdal at stripfamily.net  Mon Mar  2 09:43:57 2015
From: gdal at stripfamily.net (David Strip)
Date: Mon, 02 Mar 2015 10:43:57 -0700
Subject: [gdal-dev] reprojection issue
In-Reply-To: <B5413323-F1D9-4A79-9411-35E32D822D67@roproducts.de>
References: <B5413323-F1D9-4A79-9411-35E32D822D67@roproducts.de>
Message-ID: <54F4A15D.1010208@stripfamily.net>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150302/572d1434/attachment.html>

From schut at sarvision.nl  Tue Mar  3 01:06:51 2015
From: schut at sarvision.nl (Vincent Schut)
Date: Tue, 03 Mar 2015 10:06:51 +0100
Subject: [gdal-dev] gdal trunk compatibility
In-Reply-To: <201412161127.28122.even.rouault@spatialys.com>
References: <54900416.5060407@sarvision.nl>
	<201412161127.28122.even.rouault@spatialys.com>
Message-ID: <54F579AB.3050307@sarvision.nl>

Hi folks,

I'd like to revive this thread a bit, because I'm trying to compile rsgislib (https://bitbucket.org/petebunting/rsgislib, a c++ rs/gis library which links with gdal) against my trunk version of gdal 2.0, which does not work. It does work with gdal 1.x, though. I'd like to get your opinion whether this is something that should be dealt with in rsgislib, or if it is seen as an unwanted incompatability between gdal 1.x and 2.x, and should be fixed in gdal.

Initially I get the following error:

[ 21%] Building CXX object src/CMakeFiles/rsgis_geom.dir/geom/RSGISGeomTestExport.cpp.o
/usr/local/src/rsgislib/src/geom/RSGISGeomTestExport.cpp: In member function ?void rsgis::geom::RSGISGeomTestExport::exportGEOSPolygons2SHP(std::string, bool, std::list<geos::geom::Polygon*>*)?:
/usr/local/src/rsgislib/src/geom/RSGISGeomTestExport.cpp:291:87: error: invalid conversion from ?GDALDriver*? to ?OGRSFDriver*? [-fpermissive]
    shpFiledriver = OGRSFDriverRegistrar::GetRegistrar()->GetDriverByName(pszDriverName );
                                                                                        ^
/usr/local/src/rsgislib/src/geom/RSGISGeomTestExport.cpp: In member function ?void rsgis::geom::RSGISGeomTestExport::exportGEOSPolygons2SHP(std::string, bool, std::vector<geos::geom::Polygon*>*)?:
/usr/local/src/rsgislib/src/geom/RSGISGeomTestExport.cpp:364:87: error: invalid conversion from ?GDALDriver*? to ?OGRSFDriver*? [-fpermissive]
    shpFiledriver = OGRSFDriverRegistrar::GetRegistrar()->GetDriverByName(pszDriverName );
                                                                                        ^
/usr/local/src/rsgislib/src/geom/RSGISGeomTestExport.cpp: In member function ?void rsgis::geom::RSGISGeomTestExport::exportGEOSCoordinates2SHP(std::string, bool, std::vector<geos::geom::Coordinate*>*)?:
/usr/local/src/rsgislib/src/geom/RSGISGeomTestExport.cpp:437:87: error: invalid conversion from ?GDALDriver*? to ?OGRSFDriver*? [-fpermissive]
    shpFiledriver = OGRSFDriverRegistrar::GetRegistrar()->GetDriverByName(pszDriverName );
                                                                                        ^
/usr/local/src/rsgislib/src/geom/RSGISGeomTestExport.cpp: In member function ?void rsgis::geom::RSGISGeomTestExport::exportGEOSLineStrings2SHP(std::string, bool, std::vector<geos::geom::LineString*>*)?:
/usr/local/src/rsgislib/src/geom/RSGISGeomTestExport.cpp:510:87: error: invalid conversion from ?GDALDriver*? to ?OGRSFDriver*? [-fpermissive]
    shpFiledriver = OGRSFDriverRegistrar::GetRegistrar()->GetDriverByName(pszDriverName );
                                                                                        ^
/usr/local/src/rsgislib/src/geom/RSGISGeomTestExport.cpp: In member function ?void rsgis::geom::RSGISGeomTestExport::exportGEOSLineSegments2SHP(std::string, bool, std::vector<geos::geom::LineSegment*>*)?:
/usr/local/src/rsgislib/src/geom/RSGISGeomTestExport.cpp:584:87: error: invalid conversion from ?GDALDriver*? to ?OGRSFDriver*? [-fpermissive]
    shpFiledriver = OGRSFDriverRegistrar::GetRegistrar()->GetDriverByName(pszDriverName );
                                                                                        ^
src/CMakeFiles/rsgis_geom.dir/build.make:169: recipe for target 'src/CMakeFiles/rsgis_geom.dir/geom/RSGISGeomTestExport.cpp.o' failed
make[2]: *** [src/CMakeFiles/rsgis_geom.dir/geom/RSGISGeomTestExport.cpp.o] Error 1
CMakeFiles/Makefile2:487: recipe for target 'src/CMakeFiles/rsgis_geom.dir/all' failed
make[1]: *** [src/CMakeFiles/rsgis_geom.dir/all] Error 2


If I rebuild with -fpermissive, compilation continues a bit further, but then halts here:

[ 65%] Building CXX object src/CMakeFiles/rsgis_classify.dir/classifier/RSGISClassificationUtils.cpp.o
/usr/local/src/rsgislib/src/classifier/RSGISClassificationUtils.cpp: In member function ?void rsgis::classifier::RSGISClassificationUtils::convertShapeFile2SpecLib(std::string, std::string, std::string, std::vector<std::basic_string<char> >*, bool)?:
/usr/local/src/rsgislib/src/classifier/RSGISClassificationUtils.cpp:174:17: error: ?Open? is not a member of ?OGRSFDriverRegistrar?
     inputSHPDS = OGRSFDriverRegistrar::Open(vector.c_str(), FALSE);
                  ^
src/CMakeFiles/rsgis_classify.dir/build.make:77: recipe for target 'src/CMakeFiles/rsgis_classify.dir/classifier/RSGISClassificationUtils.cpp.o' failed
make[2]: *** [src/CMakeFiles/rsgis_classify.dir/classifier/RSGISClassificationUtils.cpp.o] Error 1
CMakeFiles/Makefile2:290: recipe for target 'src/CMakeFiles/rsgis_classify.dir/all' failed
make[1]: *** [src/CMakeFiles/rsgis_classify.dir/all] Error 2


This is clearly a compatibiliby issue with the new gdal 2.0 raster/vector unification. Question is: is this something that should be fixed within gdal, or should it be changed in rsgislib?

Thanks for your insights!
Vincent.



On 12/16/14 11:27, Even Rouault wrote:
> Le mardi 16 d?cembre 2014 11:06:14, Vincent Schut a ?crit :
>> Folks,
>>
>> I'd like to use gdal-trunk (e.g. 2.0) for all the new features and
>> improvements, but I wonder about its compatibility with other software.
>> Is gdal 2.0 supposed to work transparently with libraries/programs that
>> used to link against gdal 1.11, e.g. qgis, postgis, etc.?
>
> Vincent,
>
> They mostly work unmodified, although you could run into a few problems if
> opening a dataset with curve geometries in QGIS for example (but there be some
> work to use OGR curve geometries in QGIS soon)
>
>>
>>
>> Reason I ask is I get a configure error with postgis trying to find gdal:
>>
>> RASTER: Raster support requested
>> checking for gdal-config... /usr/local/bin/gdal-config
>> checking GDAL version... 2.0.0
>> checking for OGR enabled... yes
>> checking gdal.h usability... yes
>> checking gdal.h presence... yes
>> checking for gdal.h... yes
>> checking ogr_api.h usability... yes
>> checking ogr_api.h presence... yes
>> checking for ogr_api.h... yes
>> checking cpl_conv.h usability... yes
>> checking cpl_conv.h presence... yes
>> checking for cpl_conv.h... yes
>> checking for library containing GDALAllRegister... no
>> configure: error: could not find GDAL
>>
>> the last line ("checking for library containing GDALAllRegister...")
>> takes a long time and then fails...
>
> I know PostGIS has a continuous testing system tracking GDAL trunk, so I'd say
> the issue is more on your side. GDALAllRegister is definitely a symbol that
> still exists in GDAL 2.0dev
>
> http://debbie.postgis.net:8080/job/GDAL_PostGIS_Regress/2074/consoleFull
>
> Even
>
>>
>> Thanks,
>> Vincent.
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>

From even.rouault at spatialys.com  Tue Mar  3 01:26:51 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 3 Mar 2015 10:26:51 +0100
Subject: [gdal-dev] gdal trunk compatibility
In-Reply-To: <54F579AB.3050307@sarvision.nl>
References: <54900416.5060407@sarvision.nl>
	<201412161127.28122.even.rouault@spatialys.com>
	<54F579AB.3050307@sarvision.nl>
Message-ID: <201503031026.51348.even.rouault@spatialys.com>

Le mardi 03 mars 2015 10:06:51, Vincent Schut a ?crit :
> Hi folks,
> 
> I'd like to revive this thread a bit, because I'm trying to compile
> rsgislib (https://bitbucket.org/petebunting/rsgislib, a c++ rs/gis library
> which links with gdal) against my trunk version of gdal 2.0, which does
> not work. It does work with gdal 1.x, though. I'd like to get your opinion
> whether this is something that should be dealt with in rsgislib, or if it
> is seen as an unwanted incompatability between gdal 1.x and 2.x, and
> should be fixed in gdal.

Vincent,

Those are intented changes. They are adressed by 
http://svn.osgeo.org/gdal/trunk/gdal/MIGRATION_GUIDE.TXT (RFC 46)

Even

> 
> Initially I get the following error:
> 
> [ 21%] Building CXX object
> src/CMakeFiles/rsgis_geom.dir/geom/RSGISGeomTestExport.cpp.o
> /usr/local/src/rsgislib/src/geom/RSGISGeomTestExport.cpp: In member
> function ?void
> rsgis::geom::RSGISGeomTestExport::exportGEOSPolygons2SHP(std::string,
> bool, std::list<geos::geom::Polygon*>*)?:
> /usr/local/src/rsgislib/src/geom/RSGISGeomTestExport.cpp:291:87: error:
> invalid conversion from ?GDALDriver*? to ?OGRSFDriver*? [-fpermissive]
> shpFiledriver =
> OGRSFDriverRegistrar::GetRegistrar()->GetDriverByName(pszDriverName ); ^
> /usr/local/src/rsgislib/src/geom/RSGISGeomTestExport.cpp: In member
> function ?void
> rsgis::geom::RSGISGeomTestExport::exportGEOSPolygons2SHP(std::string,
> bool, std::vector<geos::geom::Polygon*>*)?:
> /usr/local/src/rsgislib/src/geom/RSGISGeomTestExport.cpp:364:87: error:
> invalid conversion from ?GDALDriver*? to ?OGRSFDriver*? [-fpermissive]
> shpFiledriver =
> OGRSFDriverRegistrar::GetRegistrar()->GetDriverByName(pszDriverName ); ^
> /usr/local/src/rsgislib/src/geom/RSGISGeomTestExport.cpp: In member
> function ?void
> rsgis::geom::RSGISGeomTestExport::exportGEOSCoordinates2SHP(std::string,
> bool, std::vector<geos::geom::Coordinate*>*)?:
> /usr/local/src/rsgislib/src/geom/RSGISGeomTestExport.cpp:437:87: error:
> invalid conversion from ?GDALDriver*? to ?OGRSFDriver*? [-fpermissive]
> shpFiledriver =
> OGRSFDriverRegistrar::GetRegistrar()->GetDriverByName(pszDriverName ); ^
> /usr/local/src/rsgislib/src/geom/RSGISGeomTestExport.cpp: In member
> function ?void
> rsgis::geom::RSGISGeomTestExport::exportGEOSLineStrings2SHP(std::string,
> bool, std::vector<geos::geom::LineString*>*)?:
> /usr/local/src/rsgislib/src/geom/RSGISGeomTestExport.cpp:510:87: error:
> invalid conversion from ?GDALDriver*? to ?OGRSFDriver*? [-fpermissive]
> shpFiledriver =
> OGRSFDriverRegistrar::GetRegistrar()->GetDriverByName(pszDriverName ); ^
> /usr/local/src/rsgislib/src/geom/RSGISGeomTestExport.cpp: In member
> function ?void
> rsgis::geom::RSGISGeomTestExport::exportGEOSLineSegments2SHP(std::string,
> bool, std::vector<geos::geom::LineSegment*>*)?:
> /usr/local/src/rsgislib/src/geom/RSGISGeomTestExport.cpp:584:87: error:
> invalid conversion from ?GDALDriver*? to ?OGRSFDriver*? [-fpermissive]
> shpFiledriver =
> OGRSFDriverRegistrar::GetRegistrar()->GetDriverByName(pszDriverName ); ^
> src/CMakeFiles/rsgis_geom.dir/build.make:169: recipe for target
> 'src/CMakeFiles/rsgis_geom.dir/geom/RSGISGeomTestExport.cpp.o' failed
> make[2]: ***
> [src/CMakeFiles/rsgis_geom.dir/geom/RSGISGeomTestExport.cpp.o] Error 1
> CMakeFiles/Makefile2:487: recipe for target
> 'src/CMakeFiles/rsgis_geom.dir/all' failed make[1]: ***
> [src/CMakeFiles/rsgis_geom.dir/all] Error 2
> 
> 
> If I rebuild with -fpermissive, compilation continues a bit further, but
> then halts here:
> 
> [ 65%] Building CXX object
> src/CMakeFiles/rsgis_classify.dir/classifier/RSGISClassificationUtils.cpp.
> o /usr/local/src/rsgislib/src/classifier/RSGISClassificationUtils.cpp: In
> member function ?void
> rsgis::classifier::RSGISClassificationUtils::convertShapeFile2SpecLib(std:
> :string, std::string, std::string, std::vector<std::basic_string<char> >*,
> bool)?:
> /usr/local/src/rsgislib/src/classifier/RSGISClassificationUtils.cpp:174:17
> : error: ?Open? is not a member of ?OGRSFDriverRegistrar? inputSHPDS =
> OGRSFDriverRegistrar::Open(vector.c_str(), FALSE); ^
> src/CMakeFiles/rsgis_classify.dir/build.make:77: recipe for target
> 'src/CMakeFiles/rsgis_classify.dir/classifier/RSGISClassificationUtils.cpp
> .o' failed make[2]: ***
> [src/CMakeFiles/rsgis_classify.dir/classifier/RSGISClassificationUtils.cpp
> .o] Error 1 CMakeFiles/Makefile2:290: recipe for target
> 'src/CMakeFiles/rsgis_classify.dir/all' failed make[1]: ***
> [src/CMakeFiles/rsgis_classify.dir/all] Error 2
> 
> 
> This is clearly a compatibiliby issue with the new gdal 2.0 raster/vector
> unification. Question is: is this something that should be fixed within
> gdal, or should it be changed in rsgislib?
> 
> Thanks for your insights!
> Vincent.
> 
> On 12/16/14 11:27, Even Rouault wrote:
> > Le mardi 16 d?cembre 2014 11:06:14, Vincent Schut a ?crit :
> >> Folks,
> >> 
> >> I'd like to use gdal-trunk (e.g. 2.0) for all the new features and
> >> improvements, but I wonder about its compatibility with other software.
> >> Is gdal 2.0 supposed to work transparently with libraries/programs that
> >> used to link against gdal 1.11, e.g. qgis, postgis, etc.?
> > 
> > Vincent,
> > 
> > They mostly work unmodified, although you could run into a few problems
> > if opening a dataset with curve geometries in QGIS for example (but
> > there be some work to use OGR curve geometries in QGIS soon)
> > 
> >> Reason I ask is I get a configure error with postgis trying to find
> >> gdal:
> >> 
> >> RASTER: Raster support requested
> >> checking for gdal-config... /usr/local/bin/gdal-config
> >> checking GDAL version... 2.0.0
> >> checking for OGR enabled... yes
> >> checking gdal.h usability... yes
> >> checking gdal.h presence... yes
> >> checking for gdal.h... yes
> >> checking ogr_api.h usability... yes
> >> checking ogr_api.h presence... yes
> >> checking for ogr_api.h... yes
> >> checking cpl_conv.h usability... yes
> >> checking cpl_conv.h presence... yes
> >> checking for cpl_conv.h... yes
> >> checking for library containing GDALAllRegister... no
> >> configure: error: could not find GDAL
> >> 
> >> the last line ("checking for library containing GDALAllRegister...")
> >> takes a long time and then fails...
> > 
> > I know PostGIS has a continuous testing system tracking GDAL trunk, so
> > I'd say the issue is more on your side. GDALAllRegister is definitely a
> > symbol that still exists in GDAL 2.0dev
> > 
> > http://debbie.postgis.net:8080/job/GDAL_PostGIS_Regress/2074/consoleFull
> > 
> > Even
> > 
> >> Thanks,
> >> Vincent.
> >> _______________________________________________
> >> gdal-dev mailing list
> >> gdal-dev at lists.osgeo.org
> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From robert at roproducts.de  Tue Mar  3 01:27:30 2015
From: robert at roproducts.de (Robert Oehler)
Date: Tue, 3 Mar 2015 10:27:30 +0100
Subject: [gdal-dev] reprojection issue
In-Reply-To: <54F4A15D.1010208@stripfamily.net>
References: <B5413323-F1D9-4A79-9411-35E32D822D67@roproducts.de>
	<54F4A15D.1010208@stripfamily.net>
Message-ID: <0F4BCDBC-0ADA-4170-A3D1-EA66D199FE5A@roproducts.de>

Thank you, using gdal.reprojectimage(..) brought the expected result.


> Am 02.03.2015 um 18:43 schrieb David Strip <gdal at stripfamily.net>:
> 
> This result is not entirely unexpected, though it depends on the two projections. A square box in one projection will map onto something entirely different in many cases, often introducing skew which will change the aspect ratio and size of the resulting raster. If you view your reprojected dataset you will almost certainly find a skewed region surrounded by no data values.
> 
> On 3/2/2015 9:01 AM, Robert Oehler wrote:
>> 
>> Hi,
>> 
>> I?m developing a raster library using GDAL. I use the Java bindings.
>> 
>> I would like to do a reprojection of an image which I have in memory.
>> 
>> I?m using an in-memory driver to create a dataset. I fill it with the properties of the image and its data.
>> 
>> Now I?m doing
>> 
>> Dataset warped = gdal.AutoCreateWarpedVRT(ds, src_proj.ExportToWkt(), dst_proj.ExportToWkt());
>> 
>> but the resulting raster is very different from the original. (720,720 --> 635,810) while the resulting bounding box is correct (compared to my own reprojection implementation)
>> 
>> What am I doing wrong?
>> 
>> I?ve seen gdal.reprojectImage(..) What is the difference? Is it preferable in my case ?
>> 
>> Thank you
>> 
>> Robert Oehler
>> 
>> 
>> 
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev <http://lists.osgeo.org/mailman/listinfo/gdal-dev>
> 

Robert Oehler

Tel ( D ) : +49 179 4759609
Tel ( I )  : +39 370 3161263
--------------------------------------------

CEO RoProducts
www.roproducts.de

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150303/84f39e7e/attachment.html>

From schut at sarvision.nl  Tue Mar  3 01:33:53 2015
From: schut at sarvision.nl (Vincent Schut)
Date: Tue, 03 Mar 2015 10:33:53 +0100
Subject: [gdal-dev] gdal trunk compatibility
In-Reply-To: <201503031026.51348.even.rouault@spatialys.com>
References: <54900416.5060407@sarvision.nl>
	<201412161127.28122.even.rouault@spatialys.com>
	<54F579AB.3050307@sarvision.nl>
	<201503031026.51348.even.rouault@spatialys.com>
Message-ID: <54F58001.502@sarvision.nl>

On 03/03/15 10:26, Even Rouault wrote:
> Le mardi 03 mars 2015 10:06:51, Vincent Schut a ?crit :
>> Hi folks,
>>
>> I'd like to revive this thread a bit, because I'm trying to compile
>> rsgislib (https://bitbucket.org/petebunting/rsgislib, a c++ rs/gis library
>> which links with gdal) against my trunk version of gdal 2.0, which does
>> not work. It does work with gdal 1.x, though. I'd like to get your opinion
>> whether this is something that should be dealt with in rsgislib, or if it
>> is seen as an unwanted incompatability between gdal 1.x and 2.x, and
>> should be fixed in gdal.
> Vincent,
>
> Those are intented changes. They are adressed by
> http://svn.osgeo.org/gdal/trunk/gdal/MIGRATION_GUIDE.TXT (RFC 46)
>
> Even

Thanks Even for that link!
Vincent.
>
>> Initially I get the following error:
>>
>> [ 21%] Building CXX object
>> src/CMakeFiles/rsgis_geom.dir/geom/RSGISGeomTestExport.cpp.o
>> /usr/local/src/rsgislib/src/geom/RSGISGeomTestExport.cpp: In member
>> function ?void
>> rsgis::geom::RSGISGeomTestExport::exportGEOSPolygons2SHP(std::string,
>> bool, std::list<geos::geom::Polygon*>*)?:
>> /usr/local/src/rsgislib/src/geom/RSGISGeomTestExport.cpp:291:87: error:
>> invalid conversion from ?GDALDriver*? to ?OGRSFDriver*? [-fpermissive]
>> shpFiledriver =
>> OGRSFDriverRegistrar::GetRegistrar()->GetDriverByName(pszDriverName ); ^
>> /usr/local/src/rsgislib/src/geom/RSGISGeomTestExport.cpp: In member
>> function ?void
>> rsgis::geom::RSGISGeomTestExport::exportGEOSPolygons2SHP(std::string,
>> bool, std::vector<geos::geom::Polygon*>*)?:
>> /usr/local/src/rsgislib/src/geom/RSGISGeomTestExport.cpp:364:87: error:
>> invalid conversion from ?GDALDriver*? to ?OGRSFDriver*? [-fpermissive]
>> shpFiledriver =
>> OGRSFDriverRegistrar::GetRegistrar()->GetDriverByName(pszDriverName ); ^
>> /usr/local/src/rsgislib/src/geom/RSGISGeomTestExport.cpp: In member
>> function ?void
>> rsgis::geom::RSGISGeomTestExport::exportGEOSCoordinates2SHP(std::string,
>> bool, std::vector<geos::geom::Coordinate*>*)?:
>> /usr/local/src/rsgislib/src/geom/RSGISGeomTestExport.cpp:437:87: error:
>> invalid conversion from ?GDALDriver*? to ?OGRSFDriver*? [-fpermissive]
>> shpFiledriver =
>> OGRSFDriverRegistrar::GetRegistrar()->GetDriverByName(pszDriverName ); ^
>> /usr/local/src/rsgislib/src/geom/RSGISGeomTestExport.cpp: In member
>> function ?void
>> rsgis::geom::RSGISGeomTestExport::exportGEOSLineStrings2SHP(std::string,
>> bool, std::vector<geos::geom::LineString*>*)?:
>> /usr/local/src/rsgislib/src/geom/RSGISGeomTestExport.cpp:510:87: error:
>> invalid conversion from ?GDALDriver*? to ?OGRSFDriver*? [-fpermissive]
>> shpFiledriver =
>> OGRSFDriverRegistrar::GetRegistrar()->GetDriverByName(pszDriverName ); ^
>> /usr/local/src/rsgislib/src/geom/RSGISGeomTestExport.cpp: In member
>> function ?void
>> rsgis::geom::RSGISGeomTestExport::exportGEOSLineSegments2SHP(std::string,
>> bool, std::vector<geos::geom::LineSegment*>*)?:
>> /usr/local/src/rsgislib/src/geom/RSGISGeomTestExport.cpp:584:87: error:
>> invalid conversion from ?GDALDriver*? to ?OGRSFDriver*? [-fpermissive]
>> shpFiledriver =
>> OGRSFDriverRegistrar::GetRegistrar()->GetDriverByName(pszDriverName ); ^
>> src/CMakeFiles/rsgis_geom.dir/build.make:169: recipe for target
>> 'src/CMakeFiles/rsgis_geom.dir/geom/RSGISGeomTestExport.cpp.o' failed
>> make[2]: ***
>> [src/CMakeFiles/rsgis_geom.dir/geom/RSGISGeomTestExport.cpp.o] Error 1
>> CMakeFiles/Makefile2:487: recipe for target
>> 'src/CMakeFiles/rsgis_geom.dir/all' failed make[1]: ***
>> [src/CMakeFiles/rsgis_geom.dir/all] Error 2
>>
>>
>> If I rebuild with -fpermissive, compilation continues a bit further, but
>> then halts here:
>>
>> [ 65%] Building CXX object
>> src/CMakeFiles/rsgis_classify.dir/classifier/RSGISClassificationUtils.cpp.
>> o /usr/local/src/rsgislib/src/classifier/RSGISClassificationUtils.cpp: In
>> member function ?void
>> rsgis::classifier::RSGISClassificationUtils::convertShapeFile2SpecLib(std:
>> :string, std::string, std::string, std::vector<std::basic_string<char> >*,
>> bool)?:
>> /usr/local/src/rsgislib/src/classifier/RSGISClassificationUtils.cpp:174:17
>> : error: ?Open? is not a member of ?OGRSFDriverRegistrar? inputSHPDS =
>> OGRSFDriverRegistrar::Open(vector.c_str(), FALSE); ^
>> src/CMakeFiles/rsgis_classify.dir/build.make:77: recipe for target
>> 'src/CMakeFiles/rsgis_classify.dir/classifier/RSGISClassificationUtils.cpp
>> .o' failed make[2]: ***
>> [src/CMakeFiles/rsgis_classify.dir/classifier/RSGISClassificationUtils.cpp
>> .o] Error 1 CMakeFiles/Makefile2:290: recipe for target
>> 'src/CMakeFiles/rsgis_classify.dir/all' failed make[1]: ***
>> [src/CMakeFiles/rsgis_classify.dir/all] Error 2
>>
>>
>> This is clearly a compatibiliby issue with the new gdal 2.0 raster/vector
>> unification. Question is: is this something that should be fixed within
>> gdal, or should it be changed in rsgislib?
>>
>> Thanks for your insights!
>> Vincent.
>>
>> On 12/16/14 11:27, Even Rouault wrote:
>>> Le mardi 16 d?cembre 2014 11:06:14, Vincent Schut a ?crit :
>>>> Folks,
>>>>
>>>> I'd like to use gdal-trunk (e.g. 2.0) for all the new features and
>>>> improvements, but I wonder about its compatibility with other software.
>>>> Is gdal 2.0 supposed to work transparently with libraries/programs that
>>>> used to link against gdal 1.11, e.g. qgis, postgis, etc.?
>>> Vincent,
>>>
>>> They mostly work unmodified, although you could run into a few problems
>>> if opening a dataset with curve geometries in QGIS for example (but
>>> there be some work to use OGR curve geometries in QGIS soon)
>>>
>>>> Reason I ask is I get a configure error with postgis trying to find
>>>> gdal:
>>>>
>>>> RASTER: Raster support requested
>>>> checking for gdal-config... /usr/local/bin/gdal-config
>>>> checking GDAL version... 2.0.0
>>>> checking for OGR enabled... yes
>>>> checking gdal.h usability... yes
>>>> checking gdal.h presence... yes
>>>> checking for gdal.h... yes
>>>> checking ogr_api.h usability... yes
>>>> checking ogr_api.h presence... yes
>>>> checking for ogr_api.h... yes
>>>> checking cpl_conv.h usability... yes
>>>> checking cpl_conv.h presence... yes
>>>> checking for cpl_conv.h... yes
>>>> checking for library containing GDALAllRegister... no
>>>> configure: error: could not find GDAL
>>>>
>>>> the last line ("checking for library containing GDALAllRegister...")
>>>> takes a long time and then fails...
>>> I know PostGIS has a continuous testing system tracking GDAL trunk, so
>>> I'd say the issue is more on your side. GDALAllRegister is definitely a
>>> symbol that still exists in GDAL 2.0dev
>>>
>>> http://debbie.postgis.net:8080/job/GDAL_PostGIS_Regress/2074/consoleFull
>>>
>>> Even
>>>
>>>> Thanks,
>>>> Vincent.
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev at lists.osgeo.org
>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From even.rouault at spatialys.com  Tue Mar  3 01:34:25 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 3 Mar 2015 10:34:25 +0100
Subject: [gdal-dev] Motion: Adopt RFC 54: Dataset transactions
In-Reply-To: <201502261024.53027.even.rouault@spatialys.com>
References: <201502261024.53027.even.rouault@spatialys.com>
Message-ID: <201503031034.25273.even.rouault@spatialys.com>

Le jeudi 26 f?vrier 2015 10:24:52, Even Rouault a ?crit :
> Hi,
> 
> As no points have been raised,
> 
> Motion : I move to adopt RFC 54: Dataset transactions
> 
> http://trac.osgeo.org/gdal/wiki/rfc54_dataset_transactions
> 
> Starting with my +1

Hi,

I declare this motion passed with +1 from JukkaR, HowardB and me.

Even

> 
> Best regards,
> 
> Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Tue Mar  3 03:42:10 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 3 Mar 2015 12:42:10 +0100
Subject: [gdal-dev] Python developement guidelines
Message-ID: <201503031242.11294.even.rouault@spatialys.com>

Hi,

Just wanted to notify I've added the following section in 
http://trac.osgeo.org/gdal/wiki/rfc8_devguide

"""
Python code

   * All Python code in autotest, swig/python/scripts and swig/python/samples 
should pass OK with the Pyflakes checker (version used currently: 0.8.1). This 
is asserted by Travis-CI jobs
  *  Python code should be written to be compatible with both Python 2 and 
Python 3. 
"""

We could probably write more, but that's a beginning.

The first item matches a painful pass in the whole code base I did recently so 
that we get Pyflakes clean. I think this is a good practice and hopefully 
shouldn't be too controversial as it helps catching real errors it just caught 
errors I did in my latest commit) and has low false positive rate.
The second item might be more controversial and reflects my attempts to keep 
Python 3 compatibility even if it isn't my primary python version. There's a 
python3 job under https://travis-ci.org/rouault/gdal_coverage/builds/ but you 
have to look at the logs since, if an autotest script has python 3 syntax 
errors (like using print "stuff" instead of print("stuff")), it gets ignored 
without reporting errors. only errors linked to succesfully loaded scripts 
affect the global job status.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From bjornpiltz at blikken.de  Tue Mar  3 05:38:47 2015
From: bjornpiltz at blikken.de (=?UTF-8?B?QmrDtnJuIFBpbHR6?=)
Date: Tue, 3 Mar 2015 14:38:47 +0100
Subject: [gdal-dev] Encoding transform data in Shapefile
Message-ID: <CAF8Ue3mECd56mWPuibEqSZNO50KunVR3iyQTejNQozJ=UysbSA@mail.gmail.com>

Hi,
I'm extracting contours in geo-referenced images and saving the results to
shape files. At a later point I would like to read the shapefile and
transform the contours into the original integer coordinate system of the
original image. To be able to do this, I would have to save the "geo
transform" (or the inverse) in the shape file. Is there any way I can do
this?

Here is my current save routine(minus error checking etc)

/*
projection = PROJCS["WGS_1984_UTM_Zone_...
geoTransform = [0.1   0  x]
               [  0  -0.1 y]
               */
bool OGRShapeFile::write(const PolygonIWithHolesList& imageContours, const
QString& filename, const QString& projection, const QTransform&
geoTransform)
{
    // imageContours are integer pixel coordinates
    // first we transform them according to the geo transform.
    PolygonFWithHolesList contours;
    foreach(PolygonIWithHoles contour, imageContours)
        contours << poly->toPolygonF(geoTransform);

    OGRSpatialReference spatialReference;
    if (!projection.isNull())
    {
        std::string tmp1 = projection.toStdString();
        char* tmp2 = (char*)tmp1.c_str();
        spatialReference.importFromWkt(&tmp2);
    }

    OGRSFDriver* poDriver =
OGRSFDriverRegistrar::GetRegistrar()->GetDriverByName("ESRI Shapefile");
    OGRDataSource *poDS =
poDriver->CreateDataSource(filename.toLocal8Bit(), NULL);
    OGRLayer *poLayer = poDS->CreateLayer("point", &spatialReference,
wkbPolygon, NULL);

    foreach(const PolygonFWithHoles& polygon, contours)
    {
        OGRPolygon p;
        p.assignSpatialReference(&spatialReference);
        for (int i=0; i<polygon.holeCount()+1; i++)
        {
            ...
            p.addRing(&ring);
        }

        OGRFeature *poFeature =
OGRFeature::CreateFeature(poLayer->GetLayerDefn());
        poFeature->SetGeometry(&p);
        poLayer->CreateFeature(poFeature);
        OGRFeature::DestroyFeature(poFeature);
    }
    OGRDataSource::DestroyDataSource(poDS);
    return true;
}
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150303/967bc0c3/attachment.html>

From even.rouault at spatialys.com  Tue Mar  3 07:13:52 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 3 Mar 2015 16:13:52 +0100
Subject: [gdal-dev] Fwd: [SoC] OSGeo accepted to GSoC 2015 - overview of
	slot assignments
Message-ID: <201503031613.53095.even.rouault@spatialys.com>


----------  Message transmis  ----------

Sujet : [SoC] OSGeo accepted to GSoC 2015 - overview of slot assignments
Date : mardi 03 mars 2015, 10:41:42
De : Margherita Di Leo <diregola at gmail.com>
? : OSGeo Discussions <discuss at lists.osgeo.org>, "OSGeo-SoC" 
<soc at lists.osgeo.org>

Dear All,

it is our pleasure to announce that *OSGeo has been accepted as mentoring
organization* also this year! [1]
The OSGeo GSoC Team has been reshaped with respect to former
communications, and it's now composed by myself (Madi) in the role of
primary admin and the experienced Anne Ghisla in the role of co-admin.

Now it's time for prospecting students to carefully browse the list of
ideas and contact developers team of their interest. Mentor registration is
not yet open and will be announced in due time. Students can officially
apply on Melange from 16th to 27th of March.

All, do keep an eye (and a calendar client reminder) on all *GSoC 2015
dates* [2]!

This year, we will be using slightly different *procedure for assigning
slots* to selected projects. The experience from previous years made it
possible to define the criteria that will be applied this year, and
hopefully will be improved in the future:

1. Each project requires at least *two mentors*. The soundness of the
project, the selection of reliable mentors and student is responsibility of
its community. However, this year we strongly encourage the community to
assign to the wannabe-GSoC-student some small programming tasks or bug
fixes, in order to be sure that (s)he is familiar with the selected
software, the programming environment, version control system, mailing
list, etc and can code. Particular attention should be paid in the
selection of mentors that *won't disappear* in the course of the GSoC.

2. Each OSGeo software will have *one* slot assigned, provided that the
conditions at point 1 are met.

3. Like previous years, OSGeo will host some like-minded projects that
requested it, and will assign *1* slot to each guest, provided that the
conditions at point 1 are met.

4. This year we want to encourage projects that entail the* integration
between two or more OSGeo software*. For this reason, one extra slot will
be assigned to (sound) projects that aim at integrating two or more
software, provided that mentors of respective communities are involved.

5. If the number of slots will allow it, extra slots can be assigned to
projects that have gained a good *rate of success* in the course of past
years (reliable -not disappearing- mentors, student success, etc).

Further discussion on specific slot assignments will take place among
mentors in due time. This is the admins outline of this year's criteria.

Please send answers to this announcement* to soc [3] list*, and forward
this mail to all relevant mailing lists of your knowledge.

*And now, let s do this thing!*
*http://tinyurl.com/l32yzgp <http://tinyurl.com/l32yzgp>*

Yours enthusiastically,

Madi and Anne
OSGeo GSoC Admins 2015

[1]
http://google-opensource.blogspot.it/2015/03/mentoring-organizations-for-
google.html
[2] https://www.google-melange.com/gsoc/events/google/gsoc2015
[3] http://lists.osgeo.org/mailman/listinfo/soc




-- 
Best regards,

Dr. Margherita DI LEO
Scientific / technical project officer

European Commission - DG JRC
Institute for Environment and Sustainability (IES)
Via Fermi, 2749
I-21027 Ispra (VA) - Italy - TP 261

Tel. +39 0332 78 3600
margherita.di-leo at jrc.ec.europa.eu

Disclaimer: The views expressed are purely those of the writer and may not
in any circumstance be regarded as stating an official position of the
European Commission.

-------------------------------------------------------
-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From fazamhd at live.com  Tue Mar  3 07:12:35 2015
From: fazamhd at live.com (Faza Mahamood)
Date: Tue, 3 Mar 2015 20:42:35 +0530
Subject: [gdal-dev] Introduction
Message-ID: <SNT146-W24AC23CEF3C8ED72579ADCDE110@phx.gbl>

Hi
I am Faza Mahamood, undergraduate student at SASTRA University, India. I have used GDAL for my University project entitled "High resolution, multi-view image mosaic with automatic seamline" for working with Erdas Imagine .img format in c++.
I would like to contribute to GDAL as part of GSOC. I have downloaded the current development version and have successfully built on linux. After going through the ideas page, i am interested in "Integration of cpp GDAL utilities into GDAL core library".
Faza Mahamoodirc: fazalinkedin: http://in.linkedin.com/in/mfazagithub: https://github.com/fazam 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150303/e5e528fb/attachment.html>

From norman at cloudant.com  Tue Mar  3 17:01:30 2015
From: norman at cloudant.com (Norman Barker)
Date: Tue, 3 Mar 2015 18:01:30 -0700
Subject: [gdal-dev] Adding Sync to CouchDB/Cloudant Driver
Message-ID: <CACSHx9ktFDZQVRVJsAyYR0nODxVDAE=5GdgyH+eFAiEzNR-PSQ@mail.gmail.com>

Hi,

I am looking to add sync to the GDAL CouchDB driver. I would rather not add
additional API functions to do this but to wrap it up in the
usual GetFeature call. The first call to GetFeature would initiate a sync,
but thoughts on this are appreciated.

Sync is a useful function that is a key differentiator with CouchDB which
is a multi-master database.

There are a couple of ways of doing the sync, I could force a whole
database sync (the CouchDB model) or we could do a filtered sync based on
the bbox of the current local dataset. I would do the former in the initial
implementation.

As for the persistence, I would like to use leveldb as a local store though
I could use sqlite. The two schemas are as follows;

https://github.com/pouchdb/pouchdb/blob/master/lib/adapters/idb/idb.js#L56
https://github.com/couchbaselabs/TouchDB-iOS/wiki/Object-Design-And-Schema

I will be create a PR on this shortly, but I am interested in any early
feedback.

Norman
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150303/62f32639/attachment.html>

From even.rouault at spatialys.com  Wed Mar  4 00:43:08 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 4 Mar 2015 09:43:08 +0100
Subject: [gdal-dev] Adding Sync to CouchDB/Cloudant Driver
In-Reply-To: <CACSHx9ktFDZQVRVJsAyYR0nODxVDAE=5GdgyH+eFAiEzNR-PSQ@mail.gmail.com>
References: <CACSHx9ktFDZQVRVJsAyYR0nODxVDAE=5GdgyH+eFAiEzNR-PSQ@mail.gmail.com>
Message-ID: <201503040943.08504.even.rouault@spatialys.com>

Norman,

I'm not familiar with what this "sync" is about, so please bear with the naive 
questions.
Is it to synchronize all masters between them ?
Why GetFeature() and/or not at the first GetNextFeature(), or at database 
opening ?
What is the persistence you mention, and what is the connexion with the sync 
you mention ? Is it done at client (OGR) side ? Would leveldb be a new GDAL 
dependency ?

Even

> Hi,
> 
> I am looking to add sync to the GDAL CouchDB driver. I would rather not add
> additional API functions to do this but to wrap it up in the
> usual GetFeature call. The first call to GetFeature would initiate a sync,
> but thoughts on this are appreciated.
> 
> Sync is a useful function that is a key differentiator with CouchDB which
> is a multi-master database.
> 
> There are a couple of ways of doing the sync, I could force a whole
> database sync (the CouchDB model) or we could do a filtered sync based on
> the bbox of the current local dataset. I would do the former in the initial
> implementation.
> 
> As for the persistence, I would like to use leveldb as a local store though
> I could use sqlite. The two schemas are as follows;
> 
> https://github.com/pouchdb/pouchdb/blob/master/lib/adapters/idb/idb.js#L56
> https://github.com/couchbaselabs/TouchDB-iOS/wiki/Object-Design-And-Schema
> 
> I will be create a PR on this shortly, but I am interested in any early
> feedback.
> 
> Norman

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From sarthak.a at research.iiit.ac.in  Wed Mar  4 02:00:24 2015
From: sarthak.a at research.iiit.ac.in (sarthak agarwal)
Date: Wed, 4 Mar 2015 15:30:24 +0530
Subject: [gdal-dev] Introductory mail for GSOC project proposal
Message-ID: <CAPwn9cxqwKidsAd3rt6dOb-wG27gyBMWS+S-=HHMY-F3imt8Tg@mail.gmail.com>

Dear Sir/Madam,

Myself Sarthak currently working under Dr. KS Rajan as a research student
in Spatial Informatics Lab, IIIT hyderabad . I am currently working in
spatial databases by optimizing the performance of mongoDb for spatial
databases. Previously i have worked on Billboard placement optimization
problem considering the spatial ,temporal and traffic features.

I am interested in working with GDAL org under the project "*GDAL image
stretch/filter utility". *The problem looks interesting to me and I think i
can challenge the problem and solve it in the given time frame. I am
familiar with the technologies needed for this project.
Can you please provide me with some more literature to understand the
underlying concept behind the problem and a direction to solve it.

Regards,
Sarthak Agarwal
Btech and Ms by research in Spatial Informatics
International Institute Of Information Technology ,Hyderabad
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150304/75ccd11e/attachment.html>

From landa.martin at gmail.com  Wed Mar  4 05:47:00 2015
From: landa.martin at gmail.com (Martin Landa)
Date: Wed, 4 Mar 2015 14:47:00 +0100
Subject: [gdal-dev] VFK driver: RFC 54
Message-ID: <CA+Ei1OfGOHOGpty59e72nN2YCgBwSQKLApCF0MrRB3Teab7+uQ@mail.gmail.com>

Hi,

I wonder if VFK driver needs to be updated to RFC54 (Dataset
transactions) or it's completely unrelated?

Steps to reproduce:

1) download [1]

$ unzip Export_vse.zip

2) create empty PostGIS database

$ createdb test ; psql test -c"create extension postgis"

3) Import VFK to PostGIS

$ ogr2ogr -f PostgreSQL PG:dbname=test Export_vse.vfk

ERROR 1: no COPY in progress

ERROR 1: ERROR:  current transaction is aborted, commands ignored
until end of transaction block

ERROR 1: ERROR:  current transaction is aborted, commands ignored
until end of transaction block

ERROR 1: ERROR:  current transaction is aborted, commands ignored
until end of transaction block

ERROR 1: ERROR:  current transaction is aborted, commands ignored
until end of transaction block

ERROR 1: ERROR:  current transaction is aborted, commands ignored
until end of transaction block

ERROR 1: CREATE TABLE "public"."bud" ( ogc_fid SERIAL, PRIMARY KEY
(ogc_fid), "id" VARCHAR(30), "stav_dat" NUMERIC(2,0), "datum_vzniku"
VARCHAR(25), "datum_zaniku" VARCHAR(25), "priznak_kontextu"
NUMERIC(1,0), "rizeni_id_vzniku" VARCHAR(30), "rizeni_id_zaniku"
VARCHAR(30), "typbud_kod" NUMERIC(1,0), "caobce_kod" NUMERIC(6,0),
"cislo_domovni" NUMERIC(4,0), "cena_nemovitosti" NUMERIC(14,2),
"zpvybu_kod" NUMERIC(4,0), "tel_id" VARCHAR(30), "docasna_stavba"
VARCHAR(1), "je_soucasti" VARCHAR(1), "ps_id" VARCHAR(30),
"wkb_geometry" geometry(POLYGON,1) )
ERROR:  current transaction is aborted, commands ignored until end of
transaction block

ERROR 1: Unable to write feature 1 from layer BUD.

ERROR 1: Terminating translation prematurely after failed
translation of layer BUD (use -skipfailures to skip errors)

Martin

[1] http://www.cuzk.cz/Katastr-nemovitosti/Poskytovani-udaju-z-KN/Vymenny-format-KN/Vymenny-format-NVF/exportvse.aspx

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.cz/mentors/landa

From even.rouault at spatialys.com  Wed Mar  4 06:21:44 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 4 Mar 2015 15:21:44 +0100
Subject: [gdal-dev] VFK driver: RFC 54
In-Reply-To: <CA+Ei1OfGOHOGpty59e72nN2YCgBwSQKLApCF0MrRB3Teab7+uQ@mail.gmail.com>
References: <CA+Ei1OfGOHOGpty59e72nN2YCgBwSQKLApCF0MrRB3Teab7+uQ@mail.gmail.com>
Message-ID: <201503041521.44917.even.rouault@spatialys.com>

Le mercredi 04 mars 2015 14:47:00, Martin Landa a ?crit :
> Hi,
> 
> I wonder if VFK driver needs to be updated to RFC54 (Dataset
> transactions) or it's completely unrelated?

Hi Martin,

The VFK driver doesn't need updates, but it was a regression in the PG driver 
due to RFC54 indeed. 

Fixed by r28609
"PG: fix regression caused by RFC 54 with ogr2ogr when creating several layers 
that didn't exist in the PG database (trunk only)"

(the commit includes a new test case as this wasn't spoted by the existing ~ 
5000 lines of tests of the driver...)

Thanks for notifying and providing a way to reproduce.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From landa.martin at gmail.com  Wed Mar  4 06:34:15 2015
From: landa.martin at gmail.com (Martin Landa)
Date: Wed, 4 Mar 2015 15:34:15 +0100
Subject: [gdal-dev] VFK driver: RFC 54
In-Reply-To: <201503041521.44917.even.rouault@spatialys.com>
References: <CA+Ei1OfGOHOGpty59e72nN2YCgBwSQKLApCF0MrRB3Teab7+uQ@mail.gmail.com>
	<201503041521.44917.even.rouault@spatialys.com>
Message-ID: <CA+Ei1OeHkU6NG-+g=q6E-BbELXyBTa5LacsFuuv3yFbiDkn7xg@mail.gmail.com>

Hi Even,

2015-03-04 15:21 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:
> Fixed by r28609
> "PG: fix regression caused by RFC 54 with ogr2ogr when creating several layers
> that didn't exist in the PG database (trunk only)"

thanks! It solves the problem. Martin

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.cz/mentors/landa

From norman at cloudant.com  Wed Mar  4 06:35:14 2015
From: norman at cloudant.com (Norman Barker)
Date: Wed, 4 Mar 2015 07:35:14 -0700
Subject: [gdal-dev] Adding Sync to CouchDB/Cloudant Driver
In-Reply-To: <201503040943.08504.even.rouault@spatialys.com>
References: <CACSHx9ktFDZQVRVJsAyYR0nODxVDAE=5GdgyH+eFAiEzNR-PSQ@mail.gmail.com>
	<201503040943.08504.even.rouault@spatialys.com>
Message-ID: <CACSHx9=JcGd+uXhFsZzYutnyNDATF0oeszZLGQA-a0MWscjTpA@mail.gmail.com>

Hi Even,

the aim is to sync data between masters as per -
http://dataprotocols.org/couchdb-replication/ An example would be using
GDAL in QGIS and going offline to edit data and then coming back online,
the user would need to synchronize the dataset. As replication is a core
part of CouchDB I would like to add it to the CouchDB OGR Driver.

Synchronizing at the database opening is a great idea, that makes sense.

LevelDB would be a new GDAL dependency for the CouchDB driver, the GeoJSON
will be persisted in leveldb so that subsequent connections to a couchdb
database would only retrieve any changes to an upstream CouchDB server.
LevelDB is under the BSD license. LevelDB is used in PouchDB so it is
relatively easy to follow that code. I would aim to abstract leveldb behind
a OGRCouchDBCache class so that this storage engine could be changed.

Norman



On Wed, Mar 4, 2015 at 1:43 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Norman,
>
> I'm not familiar with what this "sync" is about, so please bear with the
> naive
> questions.
> Is it to synchronize all masters between them ?
> Why GetFeature() and/or not at the first GetNextFeature(), or at database
> opening ?
> What is the persistence you mention, and what is the connexion with the
> sync
> you mention ? Is it done at client (OGR) side ? Would leveldb be a new GDAL
> dependency ?
>
> Even
>
> > Hi,
> >
> > I am looking to add sync to the GDAL CouchDB driver. I would rather not
> add
> > additional API functions to do this but to wrap it up in the
> > usual GetFeature call. The first call to GetFeature would initiate a
> sync,
> > but thoughts on this are appreciated.
> >
> > Sync is a useful function that is a key differentiator with CouchDB which
> > is a multi-master database.
> >
> > There are a couple of ways of doing the sync, I could force a whole
> > database sync (the CouchDB model) or we could do a filtered sync based on
> > the bbox of the current local dataset. I would do the former in the
> initial
> > implementation.
> >
> > As for the persistence, I would like to use leveldb as a local store
> though
> > I could use sqlite. The two schemas are as follows;
> >
> >
> https://github.com/pouchdb/pouchdb/blob/master/lib/adapters/idb/idb.js#L56
> >
> https://github.com/couchbaselabs/TouchDB-iOS/wiki/Object-Design-And-Schema
> >
> > I will be create a PR on this shortly, but I am interested in any early
> > feedback.
> >
> > Norman
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150304/aeacf8da/attachment-0001.html>

From even.rouault at spatialys.com  Wed Mar  4 07:02:21 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 4 Mar 2015 16:02:21 +0100
Subject: [gdal-dev] Adding Sync to CouchDB/Cloudant Driver
In-Reply-To: <CACSHx9=JcGd+uXhFsZzYutnyNDATF0oeszZLGQA-a0MWscjTpA@mail.gmail.com>
References: <CACSHx9ktFDZQVRVJsAyYR0nODxVDAE=5GdgyH+eFAiEzNR-PSQ@mail.gmail.com>
	<201503040943.08504.even.rouault@spatialys.com>
	<CACSHx9=JcGd+uXhFsZzYutnyNDATF0oeszZLGQA-a0MWscjTpA@mail.gmail.com>
Message-ID: <201503041602.21296.even.rouault@spatialys.com>

Norman,

> 
> the aim is to sync data between masters as per -
> http://dataprotocols.org/couchdb-replication/ An example would be using
> GDAL in QGIS and going offline to edit data and then coming back online,
> the user would need to synchronize the dataset. As replication is a core
> part of CouchDB I would like to add it to the CouchDB OGR Driver.

If I understand well, you would consider the local copy as a "master", even if 
it is implemented as a non-couchdb instance ?

How would a user would decide that it enters offline mode : with a special 
connection string provided to the CouchDB driver ?

> 
> Synchronizing at the database opening is a great idea, that makes sense.

I've the vague feeling that offline editing and resync with server could be 
usefull for other drivers, but I'm not sure if it something that can be easily 
abstracted off the driver (i.e. if they aren't too many driver specific 
constraints to take into account during offline editing)

> 
> LevelDB would be a new GDAL dependency for the CouchDB driver, the GeoJSON
> will be persisted in leveldb so that subsequent connections to a couchdb
> database would only retrieve any changes to an upstream CouchDB server.
> LevelDB is under the BSD license. LevelDB is used in PouchDB so it is
> relatively easy to follow that code. I would aim to abstract leveldb behind
> a OGRCouchDBCache class so that this storage engine could be changed.

It looks like offline editing would be almost like a driver, no ? You need to 
create/edit/delete features. Create/delete layers?

As far as LevelDB, my remark would be that it will just make packagers' life a 
bit harder. Would that be a requirement for the CouchDB driver, or would that 
condition the offline editing feature only ?
Are there killer features that you need that couldn't be provided with 
SQLite3, which is used for long by GDAL and a dependency satisfied into all 
builds I'm aware of ?

Even

> 
> Norman
> 
> 
> 
> On Wed, Mar 4, 2015 at 1:43 AM, Even Rouault <even.rouault at spatialys.com>
> 
> wrote:
> > Norman,
> > 
> > I'm not familiar with what this "sync" is about, so please bear with the
> > naive
> > questions.
> > Is it to synchronize all masters between them ?
> > Why GetFeature() and/or not at the first GetNextFeature(), or at database
> > opening ?
> > What is the persistence you mention, and what is the connexion with the
> > sync
> > you mention ? Is it done at client (OGR) side ? Would leveldb be a new
> > GDAL dependency ?
> > 
> > Even
> > 
> > > Hi,
> > > 
> > > I am looking to add sync to the GDAL CouchDB driver. I would rather not
> > 
> > add
> > 
> > > additional API functions to do this but to wrap it up in the
> > > usual GetFeature call. The first call to GetFeature would initiate a
> > 
> > sync,
> > 
> > > but thoughts on this are appreciated.
> > > 
> > > Sync is a useful function that is a key differentiator with CouchDB
> > > which is a multi-master database.
> > > 
> > > There are a couple of ways of doing the sync, I could force a whole
> > > database sync (the CouchDB model) or we could do a filtered sync based
> > > on the bbox of the current local dataset. I would do the former in the
> > 
> > initial
> > 
> > > implementation.
> > > 
> > > As for the persistence, I would like to use leveldb as a local store
> > 
> > though
> > 
> > > I could use sqlite. The two schemas are as follows;
> > 
> > https://github.com/pouchdb/pouchdb/blob/master/lib/adapters/idb/idb.js#L5
> > 6
> > 
> > https://github.com/couchbaselabs/TouchDB-iOS/wiki/Object-Design-And-Schem
> > a
> > 
> > > I will be create a PR on this shortly, but I am interested in any early
> > > feedback.
> > > 
> > > Norman
> > 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From norman at cloudant.com  Wed Mar  4 08:24:42 2015
From: norman at cloudant.com (Norman Barker)
Date: Wed, 4 Mar 2015 09:24:42 -0700
Subject: [gdal-dev] Adding Sync to CouchDB/Cloudant Driver
In-Reply-To: <201503041602.21296.even.rouault@spatialys.com>
References: <CACSHx9ktFDZQVRVJsAyYR0nODxVDAE=5GdgyH+eFAiEzNR-PSQ@mail.gmail.com>
	<201503040943.08504.even.rouault@spatialys.com>
	<CACSHx9=JcGd+uXhFsZzYutnyNDATF0oeszZLGQA-a0MWscjTpA@mail.gmail.com>
	<201503041602.21296.even.rouault@spatialys.com>
Message-ID: <CACSHx9=WoNfhEXgK9gdaCEYOtQfo9oxaOv6gsm2BqUUu4ZiJTg@mail.gmail.com>

On Wed, Mar 4, 2015 at 8:02 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Norman,
>
> >
> > the aim is to sync data between masters as per -
> > http://dataprotocols.org/couchdb-replication/ An example would be using
> > GDAL in QGIS and going offline to edit data and then coming back online,
> > the user would need to synchronize the dataset. As replication is a core
> > part of CouchDB I would like to add it to the CouchDB OGR Driver.
>
> If I understand well, you would consider the local copy as a "master",
> even if
> it is implemented as a non-couchdb instance ?
>
> How would a user would decide that it enters offline mode : with a special
> connection string provided to the CouchDB driver ?
>

It wouldn't matter, it would only sync with an upstream server if there is
an available connection. However it could be useful
to override this (3G vs WiFi for example) so I will support a connection
string.

>
> >
> > Synchronizing at the database opening is a great idea, that makes sense.
>
> I've the vague feeling that offline editing and resync with server could be
> usefull for other drivers, but I'm not sure if it something that can be
> easily
> abstracted off the driver (i.e. if they aren't too many driver specific
> constraints to take into account during offline editing)
>

I think it would be useful for other drivers e.g. GeoPackage, however I
will put it in CouchDB with minimal API changes (if any) and
we can abstract it out later.

>
> >
> > LevelDB would be a new GDAL dependency for the CouchDB driver, the
> GeoJSON
> > will be persisted in leveldb so that subsequent connections to a couchdb
> > database would only retrieve any changes to an upstream CouchDB server.
> > LevelDB is under the BSD license. LevelDB is used in PouchDB so it is
> > relatively easy to follow that code. I would aim to abstract leveldb
> behind
> > a OGRCouchDBCache class so that this storage engine could be changed.
>
> It looks like offline editing would be almost like a driver, no ? You need
> to
> create/edit/delete features. Create/delete layers?
>
> As far as LevelDB, my remark would be that it will just make packagers'
> life a
> bit harder. Would that be a requirement for the CouchDB driver, or would
> that
> condition the offline editing feature only ?
> Are there killer features that you need that couldn't be provided with
> SQLite3, which is used for long by GDAL and a dependency satisfied into all
> builds I'm aware of ?
>

I will try with sqlite3, leveldb is a little easier, but I agree with your
build concerns.

>
> Even
>
> >
> > Norman
> >
> >
> >
> > On Wed, Mar 4, 2015 at 1:43 AM, Even Rouault <even.rouault at spatialys.com
> >
> >
> > wrote:
> > > Norman,
> > >
> > > I'm not familiar with what this "sync" is about, so please bear with
> the
> > > naive
> > > questions.
> > > Is it to synchronize all masters between them ?
> > > Why GetFeature() and/or not at the first GetNextFeature(), or at
> database
> > > opening ?
> > > What is the persistence you mention, and what is the connexion with the
> > > sync
> > > you mention ? Is it done at client (OGR) side ? Would leveldb be a new
> > > GDAL dependency ?
> > >
> > > Even
> > >
> > > > Hi,
> > > >
> > > > I am looking to add sync to the GDAL CouchDB driver. I would rather
> not
> > >
> > > add
> > >
> > > > additional API functions to do this but to wrap it up in the
> > > > usual GetFeature call. The first call to GetFeature would initiate a
> > >
> > > sync,
> > >
> > > > but thoughts on this are appreciated.
> > > >
> > > > Sync is a useful function that is a key differentiator with CouchDB
> > > > which is a multi-master database.
> > > >
> > > > There are a couple of ways of doing the sync, I could force a whole
> > > > database sync (the CouchDB model) or we could do a filtered sync
> based
> > > > on the bbox of the current local dataset. I would do the former in
> the
> > >
> > > initial
> > >
> > > > implementation.
> > > >
> > > > As for the persistence, I would like to use leveldb as a local store
> > >
> > > though
> > >
> > > > I could use sqlite. The two schemas are as follows;
> > >
> > >
> https://github.com/pouchdb/pouchdb/blob/master/lib/adapters/idb/idb.js#L5
> > > 6
> > >
> > >
> https://github.com/couchbaselabs/TouchDB-iOS/wiki/Object-Design-And-Schem
> > > a
> > >
> > > > I will be create a PR on this shortly, but I am interested in any
> early
> > > > feedback.
> > > >
> > > > Norman
> > >
> > > --
> > > Spatialys - Geospatial professional services
> > > http://www.spatialys.com
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150304/7db3a3e2/attachment.html>

From ari.jolma at gmail.com  Wed Mar  4 23:34:54 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Thu, 05 Mar 2015 09:34:54 +0200
Subject: [gdal-dev] Gdal 2.0 and Python Bindings
In-Reply-To: <CADCcPvucnd3rRH6zUXp2=AVi3GVPP806bjaDS+xYP1TWXTkyCQ@mail.gmail.com>
References: <CADCcPvucnd3rRH6zUXp2=AVi3GVPP806bjaDS+xYP1TWXTkyCQ@mail.gmail.com>
Message-ID: <54F8071E.4060003@gmail.com>

26.02.2015, 08:46, Nick Ves kirjoitti:
> Hi List,
>
> I am curious about the gdal v2 python bindings state. To be more
> specific im wondering if there is going to be any functional wrappings
> with an upcoming beta release and if so are there any documentation of
> the API or how to migrate exicting code to the new API?

The bigger changes in GDAL itself seem to be the closer integration of 
GDAL with OGR (at least classes driver, major object, and dataset are 
now more or less same) and multiple spatial fields in features. However, 
the changes have been made so that there is no impact to the Swig 
bindings - other than introduction of many new methods due to the 
multiple spatial fields.

I've been going through the Perl bindings and doing quite a lot and even 
breaking the existing API in small way (I have not yet submitted these 
changes) but so far I have not seen any reason to request/suggest a 
change to the underlying Swig API.

Best,

Ari

>
> N
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From jukka.rahkonen at maanmittauslaitos.fi  Thu Mar  5 07:25:53 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Thu, 5 Mar 2015 15:25:53 +0000 (UTC)
Subject: [gdal-dev] Default progression order in JP2OpenJPEG driver
Message-ID: <loom.20150305T161546-83@post.gmane.org>

Hi,

It defaults to "LRCP". Is it really a good selection? JP2KAK defaults to
"PRCL" and JP2ECW to "RPCL" which both feels better choices than LRCP. But
perhaps it has been considered to be good for OpenJPEG because it must
practically be used with tiled output which may guarantee fast locational
access even with LRCP.

-Jukka Rahkonen-


From ari.jolma at gmail.com  Thu Mar  5 07:35:45 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Thu, 05 Mar 2015 17:35:45 +0200
Subject: [gdal-dev] Perl bindings in 2.0
Message-ID: <54F877D1.2080601@gmail.com>

Folks,

I don't know what's the amount of use of the Perl bindings, my feeling 
is that it is not so much since there's not so much discussion on this 
list or elsewhere. Anyway, I use them and want to develop them further. 
Version 2.0 is chance to do some improvements, so I'm trying.

Perl bindings have quite a lot of Perl code on top of what Swig spits 
out. I like to think that has happened due to the difference between 
what C/C++ is good at and what a high level dynamic language like Perl 
is good at.

I have most trouble with OGR, probably because of the new concept of 
multiple geometry fields and lots of API for definitions (field and 
feature), which I think would perhaps be best hidden away and replaced 
with hashes etc. which are easy to use in Perl.

These are the main ideas that I have and which I'm trying to use as 
guidelines for the implementation, any comments are welcome:

- Prefer named parameters to strict lists. I.e., accept hashes (or 
hashrefs) as parameters and study their contents. This especially so in 
constructors.

- Names of concepts. This is a bit hard since for example OGR itself 
uses "Field" to mean both feature attribute and the definition of a 
feature attribute. Should the new geometry fields (also, somehow spatial 
attribute sounds better) be strictly distinct from non-geometry 
(non-spatial?) fields? For example in method CreateLayer, should there 
be a named parameter Fields or Fields and Geom(etry)Fields? BTW, 
abbreviated forms "GeomField" and "Defn" seem to be a part of GDAL 
vocabulary, perhaps I should stick to them and avoid as much as possible 
"spatial", "schema", "attribute", and others (Schema is already used in 
Perl bindings).

- Prefer string constants, i.e., "Point" instead of $Geo::OGR::wkbPoint. 
This is already in the bindings but I plan to make them automatic (the 
strings are taken from the code in initialization instead of being 
hard-coded) and add more support for them, for example class methods to 
list all constants of certain kind.

- Getters and Setters. Perl has a tradition of having dual purpose 
attribute methods, which is however questioned in Damian Conway's Perl 
Best Practices. I've introduced some into the bindings as alternatives 
but am in doubt now. Swig ties attributes and makes the objects 
hash-like but I don't like, one reason is because I prefer string constants.

- Use confess instead of croak. The stack trace gives a much better 
understanding of what went wrong in this case although I usually don't 
like them. I also plan to add many more checks into the bindings to 
avoid strange failures.

- In general simple is better, for example only one name for one 
concept, but it is quite hard to come up with simple and elegant design. 
I'm afraid that the current design is neither. Maybe the goal should be 
to make simple things simple with the bindings but complex things also 
possible.

Best,

Ari


From even.rouault at spatialys.com  Thu Mar  5 07:46:22 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 5 Mar 2015 16:46:22 +0100
Subject: [gdal-dev] Default progression order in JP2OpenJPEG driver
In-Reply-To: <loom.20150305T161546-83@post.gmane.org>
References: <loom.20150305T161546-83@post.gmane.org>
Message-ID: <201503051646.22538.even.rouault@spatialys.com>

Le jeudi 05 mars 2015 16:25:53, Jukka Rahkonen a ?crit :
> Hi,
> 
> It defaults to "LRCP". Is it really a good selection? JP2KAK defaults to
> "PRCL" and JP2ECW to "RPCL" which both feels better choices than LRCP. But
> perhaps it has been considered to be good for OpenJPEG because it must
> practically be used with tiled output which may guarantee fast locational
> access even with LRCP.

Jukka,

Do you have a reference for which progression order is best for which purpose 
?
The default of the OpenJPEG driver is the default os the openjpeg lib itself.

Even

> 
> -Jukka Rahkonen-
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Thu Mar  5 08:01:37 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Thu, 5 Mar 2015 16:01:37 +0000 (UTC)
Subject: [gdal-dev] Default progression order in JP2OpenJPEG driver
References: <loom.20150305T161546-83@post.gmane.org>
	<201503051646.22538.even.rouault@spatialys.com>
Message-ID: <loom.20150305T164950-257@post.gmane.org>

Even Rouault <even.rouault <at> spatialys.com> writes:

> 
> Le jeudi 05 mars 2015 16:25:53, Jukka Rahkonen a ?crit :
> > Hi,
> > 
> > It defaults to "LRCP". Is it really a good selection? JP2KAK defaults to
> > "PRCL" and JP2ECW to "RPCL" which both feels better choices than LRCP. But
> > perhaps it has been considered to be good for OpenJPEG because it must
> > practically be used with tiled output which may guarantee fast locational
> > access even with LRCP.
> 
> Jukka,
> 
> Do you have a reference for which progression order is best for which purpose 
> ?
> The default of the OpenJPEG driver is the default os the openjpeg lib itself.

Not really, it must be tested. Unfortunately different JPEG2000 libraries
behave in different ways. However, typical use of geospatial images means
capturing small excerpts from arbitrary places at variable target pixel
sizes and if the tile size is big then LRCP is guaranteed to be bad. Tiling
may change situation.

Test image should be big enough, like 50000x50000 pixels. Myself I have used
jmeter and Mapserver WMS with 1000 different BBOXes for testing. I am sure
you can write some nice python thing for the purpose.

JPEG2000 defaults are very often made for digital photos and for them LRCP
is OK; actually for such small images any progression order is OK.

-Jukka-

From norman at cloudant.com  Thu Mar  5 08:09:30 2015
From: norman at cloudant.com (Norman Barker)
Date: Thu, 5 Mar 2015 09:09:30 -0700
Subject: [gdal-dev] Default progression order in JP2OpenJPEG driver
In-Reply-To: <201503051646.22538.even.rouault@spatialys.com>
References: <loom.20150305T161546-83@post.gmane.org>
	<201503051646.22538.even.rouault@spatialys.com>
Message-ID: <CACSHx9nv4A3Eu528RxHjV21BXCuO-5Ty1YZLSR-TnipOo=3mSQ@mail.gmail.com>

Even, Jukka,

the NPJE end EPJE specifications are both good for understanding
progression order in JP2. It all depends on what you are trying to do, so a
default is just that, something that can be changed.

A JP2 file with PLT markers (packet markers) in my experience removes most
of the overhead of accessing packets as the header decoding doesn't have to
be performed.

Norman

On Thu, Mar 5, 2015 at 8:46 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le jeudi 05 mars 2015 16:25:53, Jukka Rahkonen a ?crit :
> > Hi,
> >
> > It defaults to "LRCP". Is it really a good selection? JP2KAK defaults to
> > "PRCL" and JP2ECW to "RPCL" which both feels better choices than LRCP.
> But
> > perhaps it has been considered to be good for OpenJPEG because it must
> > practically be used with tiled output which may guarantee fast locational
> > access even with LRCP.
>
> Jukka,
>
> Do you have a reference for which progression order is best for which
> purpose
> ?
> The default of the OpenJPEG driver is the default os the openjpeg lib
> itself.
>
> Even
>
> >
> > -Jukka Rahkonen-
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150305/3d634aa3/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Thu Mar  5 12:54:57 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Thu, 5 Mar 2015 20:54:57 +0000 (UTC)
Subject: [gdal-dev] Default progression order in JP2OpenJPEG driver
References: <loom.20150305T161546-83@post.gmane.org>
	<201503051646.22538.even.rouault@spatialys.com>
	<CACSHx9nv4A3Eu528RxHjV21BXCuO-5Ty1YZLSR-TnipOo=3mSQ@mail.gmail.com>
Message-ID: <loom.20150305T214931-312@post.gmane.org>

Norman Barker <norman <at> cloudant.com> writes:

 
> Even, Jukka,
> 
> the NPJE end EPJE specifications are both good for understanding
progression order in JP2. It all depends on what you are trying to do, so a
default is just that, something that can be changed.
> 
> A JP2 file with PLT markers (packet markers) in my experience removes most
of the overhead of accessing packets as the header decoding doesn't have to
be performed.
> 

I fear that only few people understand really JP2 and I do not count me in.
It is our responsibility to try to offer reasonable defaults for we consider
as standard geospatial image, let's say 15000 by 15000 pixels, RGB.

-Jukka-


From norman at cloudant.com  Thu Mar  5 13:23:58 2015
From: norman at cloudant.com (Norman Barker)
Date: Thu, 5 Mar 2015 14:23:58 -0700
Subject: [gdal-dev] Default progression order in JP2OpenJPEG driver
In-Reply-To: <loom.20150305T214931-312@post.gmane.org>
References: <loom.20150305T161546-83@post.gmane.org>
	<201503051646.22538.even.rouault@spatialys.com>
	<CACSHx9nv4A3Eu528RxHjV21BXCuO-5Ty1YZLSR-TnipOo=3mSQ@mail.gmail.com>
	<loom.20150305T214931-312@post.gmane.org>
Message-ID: <CACSHx9nRJS8gjx3xWHrRDz79JT2m5ZGxNjjx38y3V5R_qsVeOQ@mail.gmail.com>

I would be interested in doing this, I can probably create a doc that
outlines JP2/NITF C8 at a high level.

Most of the JP2 people I know (myself included) aren't doing JP2 anymore,
but it is a very useful format.

Norman

On Thu, Mar 5, 2015 at 1:54 PM, Jukka Rahkonen <
jukka.rahkonen at maanmittauslaitos.fi> wrote:

> Norman Barker <norman <at> cloudant.com> writes:
>
>
> > Even, Jukka,
> >
> > the NPJE end EPJE specifications are both good for understanding
> progression order in JP2. It all depends on what you are trying to do, so a
> default is just that, something that can be changed.
> >
> > A JP2 file with PLT markers (packet markers) in my experience removes
> most
> of the overhead of accessing packets as the header decoding doesn't have to
> be performed.
> >
>
> I fear that only few people understand really JP2 and I do not count me in.
> It is our responsibility to try to offer reasonable defaults for we
> consider
> as standard geospatial image, let's say 15000 by 15000 pixels, RGB.
>
> -Jukka-
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150305/70acd2ca/attachment.html>

From even.rouault at spatialys.com  Thu Mar  5 14:42:11 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 5 Mar 2015 23:42:11 +0100
Subject: [gdal-dev] Default progression order in JP2OpenJPEG driver
In-Reply-To: <loom.20150305T214931-312@post.gmane.org>
References: <loom.20150305T161546-83@post.gmane.org>
	<CACSHx9nv4A3Eu528RxHjV21BXCuO-5Ty1YZLSR-TnipOo=3mSQ@mail.gmail.com>
	<loom.20150305T214931-312@post.gmane.org>
Message-ID: <201503052342.12109.even.rouault@spatialys.com>

Le jeudi 05 mars 2015 21:54:57, Jukka Rahkonen a ?crit :
> Norman Barker <norman <at> cloudant.com> writes:
> > Even, Jukka,
> > 
> > the NPJE end EPJE specifications are both good for understanding
> 
> progression order in JP2. It all depends on what you are trying to do, so a
> default is just that, something that can be changed.
> 
> > A JP2 file with PLT markers (packet markers) in my experience removes
> > most
> 
> of the overhead of accessing packets as the header decoding doesn't have to
> be performed.
> 
> 
> I fear that only few people understand really JP2 and I do not count me in.
> It is our responsibility to try to offer reasonable defaults for we

I bet very few people can understand the whole complexity of the standard (and 
I do not count me either!). There are so many parameters that you can tune...

> consider as standard geospatial image, let's say 15000 by 15000 pixels, RGB

I've done a few tests encoding a RGB BMNG tile (21600x21600) with the 
JP2OpenJPEG driver with different block size (1024, 4096, 16384), with 
precincts, and with the PCRL, LRCP and RPCL progression orders. Using a 16384 
large tile requires a huge amount of RAM with openjpeg (at least 16384*16384*3 
= 800 MB, but perhaps twice or third times that when counting temporary 
buffers)

When reading with an efficient JPEG2000 decoder, for the same block size, I 
can't see any really noticeable difference between the 3 profiles, either when 
reading a single pixel, random regions at full resolution, or a downsampled 
region. I presume the difference between the organizations would appear in 
network streaming contexts rather than with an efficient storage and reader.

Note that the L factor doesn't count much as the driver only outputs one layer 
(that is something potentially tunable by the openjpeg lib, but not exposed by 
the driver)

Other findings are :
- The larger the block size is, the more efficient downsampled reads are 
(because that tends to reduce the number of requests that span over several 
tiles).
- The smaller the block size, the more efficient non-scaled reads are (with the 
size of regions of the order of the block size or less).

Those findings do not apply when using openjpeg as a reader because, as far as 
I tested, it doesn't seem to use precincts or other optimizations for intra-
tile reading at full resolution, so 1024x1024 tiles is a reasonable setting 
for it. Larger tiles will require a lot of memory for decoding too and will be 
slow. The main drawback is that getting the overviews will be slower than if a 
single tile would have been used.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Thu Mar  5 22:07:12 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Fri, 6 Mar 2015 06:07:12 +0000 (UTC)
Subject: [gdal-dev] Default progression order in JP2OpenJPEG driver
References: <loom.20150305T161546-83@post.gmane.org>
	<CACSHx9nv4A3Eu528RxHjV21BXCuO-5Ty1YZLSR-TnipOo=3mSQ@mail.gmail.com>
	<loom.20150305T214931-312@post.gmane.org>
	<201503052342.12109.even.rouault@spatialys.com>
Message-ID: <loom.20150306T064034-635@post.gmane.org>

Even Rouault <even.rouault <at> spatialys.com> writes:


> When reading with an efficient JPEG2000 decoder, for the same block size, I 
> can't see any really noticeable difference between the 3 profiles, either
when 
> reading a single pixel, random regions at full resolution, or a downsampled 
> region. I presume the difference between the organizations would appear in 
> network streaming contexts rather than with an efficient storage and reader.

Now once you say it I remember why I had a feeling of LRCP being so poor. It
was based an my tests I made a long time ago about serving images for
on-screen browsing through JPIP by using a dial-up modem and speed throttled
to 4 kbps. Very different use case indeed.

-Jukka-


From shoshot at ya.ru  Fri Mar  6 02:28:15 2015
From: shoshot at ya.ru (Shot2)
Date: Fri, 6 Mar 2015 10:28:15 +0000 (UTC)
Subject: [gdal-dev] Default progression order in JP2OpenJPEG driver
References: <loom.20150305T161546-83@post.gmane.org>
	<201503051646.22538.even.rouault@spatialys.com>
	<CACSHx9nv4A3Eu528RxHjV21BXCuO-5Ty1YZLSR-TnipOo=3mSQ@mail.gmail.com>
	<loom.20150305T214931-312@post.gmane.org>
Message-ID: <loom.20150306T093040-968@post.gmane.org>

Jukka Rahkonen <jukka.rahkonen <at> maanmittauslaitos.fi> writes:

> 
> Norman Barker <norman <at> cloudant.com> writes:
> 
>  
> > Even, Jukka,
> > 
> > the NPJE end EPJE specifications are both good for understanding
> progression order in JP2. It all depends on what you are trying to do, so a
> default is just that, something that can be changed.
> > 
> > A JP2 file with PLT markers (packet markers) in my experience removes most
> of the overhead of accessing packets as the header decoding doesn't have to
> be performed.
> > 
> 
> I fear that only few people understand really JP2 and I do not count me in.
> It is our responsibility to try to offer reasonable defaults for we consider
> as standard geospatial image, let's say 15000 by 15000 pixels, RGB.
> 
> -Jukka-
> 

Hi,
and thank you all for your dedication to bringing the GDAL-OpenJPEG codec up
to par! One small step for jpeg2000 :)

The books by Taubman & Marcellin "Jpeg2000 Image Compression Fundamentals"
(2002, Springer publ.) and "The JPEG 2000 Suite" by Schelkens et al. (2009,
Wiley publ.) are definitely worth reading, if time allows...

As noted by N. Barker, it all boils down to the intended or expected use of
said imagery. Imho it is up to the end user to decide - the best they can -
on sensible dimensions, local vs. remote browsing, usability requirements
(fast zooming, fast panning, etc.), decoder-friendly features, compliance
with standards or spec profiles, etc. One size can't fit all.

Still... in my experience the most unkindest impact usually depends on the
decoder involved and the specific codestream they expect to be fed: some
prove smart at leveraging the full power of the Jpeg2000 format, whereas
others are picky, crash-prone, or take a sluggish approach.

As a rule of thumb, from my various experiments with the format:
- quality-progressive orders (e.g. LRCP) are or limited interest, except for
specific cases involving interactive retrieval of remote datasets over slow
links, or for a quick "bitrate peeling" during transcoding. Still, in its
current state the Jp2OpenJpeg codec always creates a single quality layer,
thus making the default progression order rather harmless;
- quality-last, resolution- (RPCL) or region-progressive (PCRL) orders make
more sense for efficient zooming/panning respectively, e.g. for local random
access in huge geospatial imagery;
- precincts may greatly help with making zooming/panning/extraction
comfortable *if* decoders know how to use them;
- (indexed) tiles may prove either beneficial (w.r.t. memory requirements,
area extraction...) or detrimental (whenever a tilepart-blind decoder is fed
thousands of them).

tl;dr:
Considering plausible use cases, the new defaults for the Jp2OpenJpeg codec
look like a decent tradeoff:
- (L)RCP progression, maybe not the best but still a zoom-friendly
resolution-progressive order in the absence of multiple quality Layers
(otherwise RPCL could be a sensible alternative for gis datasets);
- ability to specify precincts (... which is now the default);
- use of moderate (1024?), memory-friendly, profile1-compliant or
configurable tiling;
- no more restrictions on the number of resolution levels.

Besides multiple quality layers, I'm wondering about additional benefits
from configurable Tile Parts indexes (-TP param, helps with browsing and ROI
retrieval when R- or P-indexed), as well as optional small code blocks (-b
param, e.g. 32? instead of the default 64?, allowing for fine-grained ROI
retrieval).

Cheers

From even.rouault at spatialys.com  Fri Mar  6 04:06:13 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 6 Mar 2015 13:06:13 +0100
Subject: [gdal-dev] Default progression order in JP2OpenJPEG driver
In-Reply-To: <loom.20150306T093040-968@post.gmane.org>
References: <loom.20150305T161546-83@post.gmane.org>
	<loom.20150305T214931-312@post.gmane.org>
	<loom.20150306T093040-968@post.gmane.org>
Message-ID: <201503061306.14145.even.rouault@spatialys.com>


> Besides multiple quality layers, I'm wondering about additional benefits
> from configurable Tile Parts indexes (-TP param, helps with browsing and
> ROI retrieval when R- or P-indexed), as well as optional small code blocks
> (-b param, e.g. 32? instead of the default 64?, allowing for fine-grained
> ROI retrieval).

I've extended the QUALITY option to specify several values (and thus layers). 
And added TILEPARTS, CODEBLOCK_WIDTH and CODEBLOCK_HEIGHT options.

> 
> Cheers
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Fri Mar  6 08:25:21 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Fri, 6 Mar 2015 16:25:21 +0000 (UTC)
Subject: [gdal-dev] Default progression order in JP2OpenJPEG driver
References: <loom.20150305T161546-83@post.gmane.org>
	<CACSHx9nv4A3Eu528RxHjV21BXCuO-5Ty1YZLSR-TnipOo=3mSQ@mail.gmail.com>
	<loom.20150305T214931-312@post.gmane.org>
	<201503052342.12109.even.rouault@spatialys.com>
Message-ID: <loom.20150306T170206-706@post.gmane.org>

Even Rouault <even.rouault <at> spatialys.com> writes:


> I've done a few tests encoding a RGB BMNG tile (21600x21600) with the 
> JP2OpenJPEG driver with different block size (1024, 4096, 16384), with 
> precincts, and with the PCRL, LRCP and RPCL progression orders. Using a 16384 
> large tile requires a huge amount of RAM with openjpeg (at least
16384*16384*3 
> = 800 MB, but perhaps twice or third times that when counting temporary 
> buffers)

OpenJPEG begins to be fast enough for practical use with tiled JPEG2000.
Unfortunately it is almost unusable with single tile images like the ones in
the directory below. Images are open data, only attribution required:
National Land Survey of Finland, 2014.

http://kartat.kapsi.fi/files/orto/etrs-tm35fin/mavi_vv_25000_50/2014/M52/10m/1/

Let's hope that OpenJPEG developers will discover some day how to read
single-tile images at reasonable speed. Now I cannot imagine that I would
use OpenJPEG driver even for converting such images with gdal_translate.
There is a free-as-in-beer solution by using JP2ECW read-only driver for
JPEG2000->GeoTIFF conversion followed by use of JP2OpenJPEG driver for
GeoTIFF->tiled JPEG2000 but that does not make my open source minded soul happy.

-Jukka Rahkonen-




From even.rouault at spatialys.com  Fri Mar  6 08:43:53 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 6 Mar 2015 17:43:53 +0100
Subject: [gdal-dev] Default progression order in JP2OpenJPEG driver
In-Reply-To: <loom.20150306T170206-706@post.gmane.org>
References: <loom.20150305T161546-83@post.gmane.org>
	<201503052342.12109.even.rouault@spatialys.com>
	<loom.20150306T170206-706@post.gmane.org>
Message-ID: <201503061743.54096.even.rouault@spatialys.com>

> 
> OpenJPEG begins to be fast enough for practical use with tiled JPEG2000.
> Unfortunately it is almost unusable with single tile images like the ones
> in the directory below. Images are open data, only attribution required:
> National Land Survey of Finland, 2014.
> 
> http://kartat.kapsi.fi/files/orto/etrs-tm35fin/mavi_vv_25000_50/2014/M52/10
> m/1/
> 
> Let's hope that OpenJPEG developers will discover some day how to read
> single-tile images at reasonable speed.

Yes that sums up to have opj_set_decode_area()+opj_decode() work efficiently. 
Currently GDAL uses that API if there's a single-tile. Otherwise it uses the 
opj_get_decoded_tile() API to decode tile per tile.

This should be better discussed on their channel ( 
https://groups.google.com/forum/#!forum/openjpeg ).


> Now I cannot imagine that I would
> use OpenJPEG driver even for converting such images with gdal_translate.
> There is a free-as-in-beer solution by using JP2ECW read-only driver for
> JPEG2000->GeoTIFF conversion followed by use of JP2OpenJPEG driver for
> GeoTIFF->tiled JPEG2000 but that does not make my open source minded soul
> happy.

Yes, and that causes further quality loss.

> 
> -Jukka Rahkonen-
> 
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Sat Mar  7 05:09:28 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Sat, 07 Mar 2015 15:09:28 +0200
Subject: [gdal-dev] Driver oddity
Message-ID: <54FAF888.2060608@gmail.com>

The GDAL and OGR drivers are now basically the same but separate ones in 
Swig bindings, maybe it has something to do with this oddity.

When I open GDAL driver "Memory", it does not advertise capability 
DCAP_RASTER and CreateDataset silently fails.

When I open GDAL driver "MEM", it advertises capability DCAP_RASTER and 
CreateDataset returns a valid object.

When I open MEM driver and then Memory driver, both behave similarly.

Both MEM and Memory are listed as GDAL drivers.

Cheers,

Ari

first run:

perl x.pl Memory
DCAP_CREATE => YES
DCAP_OPEN => YES
DCAP_VECTOR => YES
DMD_CREATIONFIELDDATATYPES => Integer Integer64 Real String Date 
DateTime Time IntegerList Integer64List RealList StringList Binary
DMD_LONGNAME => Memory
OGR_DRIVER => YES


DCAP_CREATE => YES
DCAP_OPEN => YES
DCAP_VECTOR => YES
DMD_CREATIONFIELDDATATYPES => Integer Integer64 Real String Date 
DateTime Time IntegerList Integer64List RealList StringList Binary
DMD_LONGNAME => Memory
OGR_DRIVER => YES

second run:

perl x.pl MEM
DCAP_CREATE => YES
DCAP_OPEN => YES
DCAP_RASTER => YES
DMD_CREATIONDATATYPES => Byte Int16 UInt16 Int32 UInt32 Float32 Float64 
CInt16 CInt32 CFloat32 CFloat64
DMD_CREATIONOPTIONLIST => <CreationOptionList>   <Option 
name='INTERLEAVE' type='string-select' default='BAND'> 
<Value>BAND</Value> <Value>PIXEL</Value> </Option></CreationOptionList>
DMD_LONGNAME => In Memory Raster
Geo::GDAL::Dataset=HASH(0xd020a0)

DCAP_CREATE => YES
DCAP_OPEN => YES
DCAP_RASTER => YES
DMD_CREATIONDATATYPES => Byte Int16 UInt16 Int32 UInt32 Float32 Float64 
CInt16 CInt32 CFloat32 CFloat64
DMD_CREATIONOPTIONLIST => <CreationOptionList>   <Option 
name='INTERLEAVE' type='string-select' default='BAND'> 
<Value>BAND</Value> <Value>PIXEL</Value> </Option></CreationOptionList>
DMD_LONGNAME => In Memory Raster
Geo::GDAL::Dataset=HASH(0xd77df0)

the program:

use Geo::GDAL;

$driver = shift @ARGV;

$d = Geo::GDAL::Driver($driver);
$m = $d->GetMetadata;
for my $k (sort keys %$m) {
     print "$k => $m->{$k}\n";
}
$s = $d->Create();
print $s,"\n";

print "\n";
$d = Geo::GDAL::Driver('Memory');
$m = $d->GetMetadata;
for my $k (sort keys %$m) {
     print "$k => $m->{$k}\n";
}
$s = $d->Create();
print $s,"\n";


From even.rouault at spatialys.com  Sat Mar  7 05:25:54 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 7 Mar 2015 14:25:54 +0100
Subject: [gdal-dev] Driver oddity
In-Reply-To: <54FAF888.2060608@gmail.com>
References: <54FAF888.2060608@gmail.com>
Message-ID: <201503071425.54757.even.rouault@spatialys.com>

Le samedi 07 mars 2015 14:09:28, Ari Jolma a ?crit :
> The GDAL and OGR drivers are now basically the same but separate ones in
> Swig bindings, maybe it has something to do with this oddity.
> 
> When I open GDAL driver "Memory", it does not advertise capability
> DCAP_RASTER 

Yes, because it is the vector driver. It advertizes DCAP_VECTOR

> and CreateDataset silently fails.

Not sure what your Create/CreateDataset() maps into which GDAL call in the 
Perl bindings, but what I can tell is that there's an emulation so that 
GDALDriver::Create(hDrv, name, xsize, ysize, nBands, eDataType, options) maps 
to OGRSFDriver::CreateDataSource(name, options) when it is an "old-style" OGR 
driver and xsize = 0 and ysize = 0 and nBands = 0 and eDataType = GDT_Unknown

See:

$ python
>>> from osgeo import gdal
>>> ds = gdal.GetDriverByName('Memory').Create('', 0, 0, 0)
>>> ds.CreateLayer('foo')
<osgeo.ogr.Layer; proxy of <Swig Object of type 'OGRLayerShadow *' at 
0x7f2c604586f0> >

> 
> When I open GDAL driver "MEM", it advertises capability DCAP_RASTER and
> CreateDataset returns a valid object.
> 
> When I open MEM driver and then Memory driver, both behave similarly.

Extremely weird. I cannt reproduce with Python. Isn't there some issue in the 
perl bindings related to key hashing or something like that ?

even at even-desktop:~/gdal/svn/trunk/gdal$ python
Python 2.6.6 (r266:84292, Oct 29 2012, 23:09:05) 
[GCC 4.4.3] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> from osgeo import gdal
>>> gdal.GetDriverByName('Memory').GetMetadata()
{'DMD_CREATIONFIELDDATATYPES': 'Integer Integer64 Real String Date DateTime 
Time IntegerList Integer64List RealList StringList Binary', 'DMD_LONGNAME': 
'Memory', 'DCAP_VECTOR': 'YES', 'OGR_DRIVER': 'YES', 'DCAP_OPEN': 'YES', 
'DCAP_CREATE': 'YES'}
>>> gdal.GetDriverByName('Memory').GetMetadata()
{'DMD_CREATIONFIELDDATATYPES': 'Integer Integer64 Real String Date DateTime 
Time IntegerList Integer64List RealList StringList Binary', 'DMD_LONGNAME': 
'Memory', 'DCAP_VECTOR': 'YES', 'OGR_DRIVER': 'YES', 'DCAP_OPEN': 'YES', 
'DCAP_CREATE': 'YES'}
>>> 

even at even-desktop:~/gdal/svn/trunk/gdal$ python
Python 2.6.6 (r266:84292, Oct 29 2012, 23:09:05) 
[GCC 4.4.3] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> from osgeo import gdal
>>> gdal.GetDriverByName('MEM').GetMetadata()
{'DMD_CREATIONOPTIONLIST': "<CreationOptionList>   <Option name='INTERLEAVE' 
type='string-select' default='BAND'>       <Value>BAND</Value>       
<Value>PIXEL</Value>   </Option></CreationOptionList>", 'DMD_LONGNAME': 'In 
Memory Raster', 'DMD_CREATIONDATATYPES': 'Byte Int16 UInt16 Int32 UInt32 
Float32 Float64 CInt16 CInt32 CFloat32 CFloat64', 'DCAP_OPEN': 'YES', 
'DCAP_RASTER': 'YES', 'DCAP_CREATE': 'YES'}
>>> gdal.GetDriverByName('Memory').GetMetadata()
{'DMD_CREATIONFIELDDATATYPES': 'Integer Integer64 Real String Date DateTime 
Time IntegerList Integer64List RealList StringList Binary', 'DMD_LONGNAME': 
'Memory', 'DCAP_VECTOR': 'YES', 'OGR_DRIVER': 'YES', 'DCAP_OPEN': 'YES', 
'DCAP_CREATE': 'YES'}


> 
> Both MEM and Memory are listed as GDAL drivers.

Yes, all drivers, new style or old style (i.e. still deriving from 
OGRSFDriver), raster or vector, are seen as GDAL drivers.

> 
> Cheers,
> 
> Ari
> 
> first run:
> 
> perl x.pl Memory
> DCAP_CREATE => YES
> DCAP_OPEN => YES
> DCAP_VECTOR => YES
> DMD_CREATIONFIELDDATATYPES => Integer Integer64 Real String Date
> DateTime Time IntegerList Integer64List RealList StringList Binary
> DMD_LONGNAME => Memory
> OGR_DRIVER => YES
> 
> 
> DCAP_CREATE => YES
> DCAP_OPEN => YES
> DCAP_VECTOR => YES
> DMD_CREATIONFIELDDATATYPES => Integer Integer64 Real String Date
> DateTime Time IntegerList Integer64List RealList StringList Binary
> DMD_LONGNAME => Memory
> OGR_DRIVER => YES
> 
> second run:
> 
> perl x.pl MEM
> DCAP_CREATE => YES
> DCAP_OPEN => YES
> DCAP_RASTER => YES
> DMD_CREATIONDATATYPES => Byte Int16 UInt16 Int32 UInt32 Float32 Float64
> CInt16 CInt32 CFloat32 CFloat64
> DMD_CREATIONOPTIONLIST => <CreationOptionList>   <Option
> name='INTERLEAVE' type='string-select' default='BAND'>
> <Value>BAND</Value> <Value>PIXEL</Value> </Option></CreationOptionList>
> DMD_LONGNAME => In Memory Raster
> Geo::GDAL::Dataset=HASH(0xd020a0)
> 
> DCAP_CREATE => YES
> DCAP_OPEN => YES
> DCAP_RASTER => YES
> DMD_CREATIONDATATYPES => Byte Int16 UInt16 Int32 UInt32 Float32 Float64
> CInt16 CInt32 CFloat32 CFloat64
> DMD_CREATIONOPTIONLIST => <CreationOptionList>   <Option
> name='INTERLEAVE' type='string-select' default='BAND'>
> <Value>BAND</Value> <Value>PIXEL</Value> </Option></CreationOptionList>
> DMD_LONGNAME => In Memory Raster
> Geo::GDAL::Dataset=HASH(0xd77df0)
> 
> the program:
> 
> use Geo::GDAL;
> 
> $driver = shift @ARGV;
> 
> $d = Geo::GDAL::Driver($driver);
> $m = $d->GetMetadata;
> for my $k (sort keys %$m) {
>      print "$k => $m->{$k}\n";
> }
> $s = $d->Create();
> print $s,"\n";
> 
> print "\n";
> $d = Geo::GDAL::Driver('Memory');
> $m = $d->GetMetadata;
> for my $k (sort keys %$m) {
>      print "$k => $m->{$k}\n";
> }
> $s = $d->Create();
> print $s,"\n";
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Sat Mar  7 06:30:31 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Sat, 07 Mar 2015 16:30:31 +0200
Subject: [gdal-dev] Driver oddity
In-Reply-To: <201503071425.54757.even.rouault@spatialys.com>
References: <54FAF888.2060608@gmail.com>
	<201503071425.54757.even.rouault@spatialys.com>
Message-ID: <54FB0B87.2020800@gmail.com>

07.03.2015, 15:25, Even Rouault kirjoitti:
>> I wrote:
>>
>> When I open MEM driver and then Memory driver, both behave similarly.
> Extremely weird. I cannt reproduce with Python.

This turned out to be bad Perl code in the bindings. This describes the case

http://davesource.com/Bugs/perl.5.html

Ari


From zoltans at geograph.co.za  Sun Mar  8 04:39:03 2015
From: zoltans at geograph.co.za (Zoltan Szecsei)
Date: Sun, 08 Mar 2015 13:39:03 +0200
Subject: [gdal-dev] Download GDAL 2.0
Message-ID: <54FC34D7.5000106@geograph.co.za>

Hi,
I'd like to install gdal v2.0 but cannot seem to find it.

I'm using Ubuntu 14.10
uname -a
Linux gs01 3.16.0-31-generic #41-Ubuntu SMP Tue Feb 10 15:24:04 UTC 2015 
x86_64 x86_64 x86_64 GNU/Linux
gdal_translate --version
GDAL 1.11.1, released 2014/09/24


Thanks,
Zoltan

From even.rouault at spatialys.com  Sun Mar  8 04:43:24 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 8 Mar 2015 12:43:24 +0100
Subject: [gdal-dev] Download GDAL 2.0
In-Reply-To: <54FC34D7.5000106@geograph.co.za>
References: <54FC34D7.5000106@geograph.co.za>
Message-ID: <201503081243.24941.even.rouault@spatialys.com>

Le dimanche 08 mars 2015 12:39:03, Zoltan Szecsei a ?crit :
> Hi,
> I'd like to install gdal v2.0 but cannot seem to find it.
> 
> I'm using Ubuntu 14.10
> uname -a
> Linux gs01 3.16.0-31-generic #41-Ubuntu SMP Tue Feb 10 15:24:04 UTC 2015
> x86_64 x86_64 x86_64 GNU/Linux
> gdal_translate --version
> GDAL 1.11.1, released 2014/09/24

Zoltan,

2.0 is still in development. You have to download it from sources.

Latest released version is 1.11.2.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From zoltans at geograph.co.za  Sun Mar  8 07:10:42 2015
From: zoltans at geograph.co.za (Zoltan Szecsei)
Date: Sun, 08 Mar 2015 16:10:42 +0200
Subject: [gdal-dev] Download GDAL 2.0 - gdal_translate -tx
In-Reply-To: <201503081257.41626.even.rouault@spatialys.com>
References: <54FC34D7.5000106@geograph.co.za>
	<201503081243.24941.even.rouault@spatialys.com>
	<54FC369A.8000804@geograph.co.za>
	<201503081257.41626.even.rouault@spatialys.com>
Message-ID: <54FC5862.60200@geograph.co.za>



On 03/08/2015 01:57 PM, Even Rouault wrote:
> Le dimanche 08 mars 2015 12:46:34, Zoltan Szecsei a ?crit :
>> On 03/08/2015 01:43 PM, Even Rouault wrote:
>>> Le dimanche 08 mars 2015 12:39:03, Zoltan Szecsei a ?crit :
>>>> Hi,
>>>> I'd like to install gdal v2.0 but cannot seem to find it.
>>>>
>>>> I'm using Ubuntu 14.10
>>>> uname -a
>>>> Linux gs01 3.16.0-31-generic #41-Ubuntu SMP Tue Feb 10 15:24:04 UTC 2015
>>>> x86_64 x86_64 x86_64 GNU/Linux
>>>> gdal_translate --version
>>>> GDAL 1.11.1, released 2014/09/24
>>> Zoltan,
>>>
>>> 2.0 is still in development. You have to download it from sources.
>> OK - svn checkout gdal-trunk?
> See
> http://trac.osgeo.org/gdal/wiki/DownloadSource#Developmentversionandsourcecontrol
>
>
Hi,
I've just successfully downloaded, compiled & installed the trunk version:
gdal_translate --version
GDAL 2.0.0dev, released 2014/04/16

yet I still don't have access to the '-tx' parameter for gdal_translate:

gdal_translate -tx $r $r -projwin $w $n $e $s $img ${AW}${i}.tif
FAILURE: Unknown option name '-tx'

Are the help-docs at http://www.gdal.org/gdal_translate.html just ahead 
of the source, or did I miss something?

Regards,
Zoltan








From even.rouault at spatialys.com  Sun Mar  8 07:15:43 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 8 Mar 2015 15:15:43 +0100
Subject: [gdal-dev] Download GDAL 2.0 - gdal_translate -tx
In-Reply-To: <54FC5862.60200@geograph.co.za>
References: <54FC34D7.5000106@geograph.co.za>
	<201503081257.41626.even.rouault@spatialys.com>
	<54FC5862.60200@geograph.co.za>
Message-ID: <201503081515.43670.even.rouault@spatialys.com>

Le dimanche 08 mars 2015 15:10:42, Zoltan Szecsei a ?crit :
> On 03/08/2015 01:57 PM, Even Rouault wrote:
> > Le dimanche 08 mars 2015 12:46:34, Zoltan Szecsei a ?crit :
> >> On 03/08/2015 01:43 PM, Even Rouault wrote:
> >>> Le dimanche 08 mars 2015 12:39:03, Zoltan Szecsei a ?crit :
> >>>> Hi,
> >>>> I'd like to install gdal v2.0 but cannot seem to find it.
> >>>> 
> >>>> I'm using Ubuntu 14.10
> >>>> uname -a
> >>>> Linux gs01 3.16.0-31-generic #41-Ubuntu SMP Tue Feb 10 15:24:04 UTC
> >>>> 2015 x86_64 x86_64 x86_64 GNU/Linux
> >>>> gdal_translate --version
> >>>> GDAL 1.11.1, released 2014/09/24
> >>> 
> >>> Zoltan,
> >>> 
> >>> 2.0 is still in development. You have to download it from sources.
> >> 
> >> OK - svn checkout gdal-trunk?
> > 
> > See
> > http://trac.osgeo.org/gdal/wiki/DownloadSource#Developmentversionandsourc
> > econtrol
> 
> Hi,
> I've just successfully downloaded, compiled & installed the trunk version:
> gdal_translate --version
> GDAL 2.0.0dev, released 2014/04/16
> 
> yet I still don't have access to the '-tx' parameter for gdal_translate:

I guess you meant -tr

> 
> gdal_translate -tx $r $r -projwin $w $n $e $s $img ${AW}${i}.tif
> FAILURE: Unknown option name '-tx'
> 
> Are the help-docs at http://www.gdal.org/gdal_translate.html just ahead
> of the source, or did I miss something?
> 
> Regards,
> Zoltan

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From zoltans at geograph.co.za  Sun Mar  8 07:17:27 2015
From: zoltans at geograph.co.za (Zoltan Szecsei)
Date: Sun, 08 Mar 2015 16:17:27 +0200
Subject: [gdal-dev] Download GDAL 2.0 - gdal_translate -tx
In-Reply-To: <201503081515.43670.even.rouault@spatialys.com>
References: <54FC34D7.5000106@geograph.co.za>
	<201503081257.41626.even.rouault@spatialys.com>
	<54FC5862.60200@geograph.co.za>
	<201503081515.43670.even.rouault@spatialys.com>
Message-ID: <54FC59F7.3000803@geograph.co.za>



On 03/08/2015 04:15 PM, Even Rouault wrote:
> Le dimanche 08 mars 2015 15:10:42, Zoltan Szecsei a ?crit :
>> On 03/08/2015 01:57 PM, Even Rouault wrote:
>>> Le dimanche 08 mars 2015 12:46:34, Zoltan Szecsei a ?crit :
>>>> On 03/08/2015 01:43 PM, Even Rouault wrote:
>>>>> Le dimanche 08 mars 2015 12:39:03, Zoltan Szecsei a ?crit :
>>>>>> Hi,
>>>>>> I'd like to install gdal v2.0 but cannot seem to find it.
>>>>>>
>>>>>> I'm using Ubuntu 14.10
>>>>>> uname -a
>>>>>> Linux gs01 3.16.0-31-generic #41-Ubuntu SMP Tue Feb 10 15:24:04 UTC
>>>>>> 2015 x86_64 x86_64 x86_64 GNU/Linux
>>>>>> gdal_translate --version
>>>>>> GDAL 1.11.1, released 2014/09/24
>>>>> Zoltan,
>>>>>
>>>>> 2.0 is still in development. You have to download it from sources.
>>>> OK - svn checkout gdal-trunk?
>>> See
>>> http://trac.osgeo.org/gdal/wiki/DownloadSource#Developmentversionandsourc
>>> econtrol
>> Hi,
>> I've just successfully downloaded, compiled & installed the trunk version:
>> gdal_translate --version
>> GDAL 2.0.0dev, released 2014/04/16
>>
>> yet I still don't have access to the '-tx' parameter for gdal_translate:
> I guess you meant -tr
It says:
> *-tr*xres yres :
>     (starting with GDAL 2.0) set target resolution. The values must be
>     expressed in georeferenced units. Both must be positive values.
>     This is exclusive with -outsize and -a_ullr. 

>> gdal_translate -tx $r $r -projwin $w $n $e $s $img ${AW}${i}.tif
>> FAILURE: Unknown option name '-tx'
>>
>> Are the help-docs at http://www.gdal.org/gdal_translate.html just ahead
>> of the source, or did I miss something?
>>
>> Regards,
>> Zoltan

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150308/cac69fa7/attachment.html>

From zoltans at geograph.co.za  Sun Mar  8 07:18:53 2015
From: zoltans at geograph.co.za (Zoltan Szecsei)
Date: Sun, 08 Mar 2015 16:18:53 +0200
Subject: [gdal-dev] Download GDAL 2.0 - gdal_translate -tx
In-Reply-To: <54FC59F7.3000803@geograph.co.za>
References: <54FC34D7.5000106@geograph.co.za>
	<201503081257.41626.even.rouault@spatialys.com>
	<54FC5862.60200@geograph.co.za>
	<201503081515.43670.even.rouault@spatialys.com>
	<54FC59F7.3000803@geograph.co.za>
Message-ID: <54FC5A4D.1090209@geograph.co.za>

yet I still don't have access to the '-tx' parameter for gdal_translate:
>> I guess you meant -tr
> It says:
>> *-tr*xres yres :
>>     (starting with GDAL 2.0) set target resolution. The values must
>>     be expressed in georeferenced units. Both must be positive
>>     values. This is exclusive with -outsize and -a_ullr. 
>


AArrrgh!
Now that I've put my reading glasses on......

(sorry)

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150308/b45f0738/attachment.html>

From ari.jolma at gmail.com  Sun Mar  8 14:20:50 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Sun, 08 Mar 2015 23:20:50 +0200
Subject: [gdal-dev] Bindings and typemaps
Message-ID: <54FCBD32.1070607@gmail.com>

Even,

It took me quite a while again to understand what goes on with Swig when 
we %apply a typemap etc.

I think we could simplify the things quite a lot if we simply use 
typedefs and then create typemaps for the return values.

For example CPLErr is never returned to the calling language (I think, 
but it could in any case be defined by the language typemap), thus we 
could simply define typemaps for it in language specific files instead 
of repeating

%apply (IF_ERROR_RETURN_NONE) { (CPLErr) };
...
%clear (CPLErr);

in the include/*.i files.

Also sometimes GDAL has simple int instead of CPLErr, which is used as a 
success/failure return value, then we could (like we already do) write

typedef int RETURN_NONE;

(actually we have also

typedef int OGRErr;

for SWIGCSHARP, which is invented for the same reason I assume)

and then define typemaps for the new type and skip again

%apply (IF_FALSE_RETURN_NONE) { (RETURN_NONE) };
...
%clear (RETURN_NONE);

which is overkill (and I believe I introduced that).

BTW, RETURN_NONE is not a good name, maybe use TRUE_OR_FALSE or 
something more descriptive.

Best,

Ari


From even.rouault at spatialys.com  Sun Mar  8 14:49:44 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 8 Mar 2015 22:49:44 +0100
Subject: [gdal-dev] Bindings and typemaps
In-Reply-To: <54FCBD32.1070607@gmail.com>
References: <54FCBD32.1070607@gmail.com>
Message-ID: <201503082249.44856.even.rouault@spatialys.com>

Le dimanche 08 mars 2015 22:20:50, Ari Jolma a ?crit :
> Even,
> 
> It took me quite a while again to understand what goes on with Swig when
> we %apply a typemap etc.
> 
> I think we could simplify the things quite a lot if we simply use
> typedefs and then create typemaps for the return values.
> 
> For example CPLErr is never returned to the calling language (I think,
> but it could in any case be defined by the language typemap), thus we
> could simply define typemaps for it in language specific files instead
> of repeating
> 
> %apply (IF_ERROR_RETURN_NONE) { (CPLErr) };
> ...
> %clear (CPLErr);
> 
> in the include/*.i files.
> 
> Also sometimes GDAL has simple int instead of CPLErr, which is used as a
> success/failure return value, then we could (like we already do) write
> 
> typedef int RETURN_NONE;
> 
> (actually we have also
> 
> typedef int OGRErr;
> 
> for SWIGCSHARP, which is invented for the same reason I assume)
> 
> and then define typemaps for the new type and skip again
> 
> %apply (IF_FALSE_RETURN_NONE) { (RETURN_NONE) };
> ...
> %clear (RETURN_NONE);
> 
> which is overkill (and I believe I introduced that).
> 
> BTW, RETURN_NONE is not a good name, maybe use TRUE_OR_FALSE or
> something more descriptive.

Ari,

Your proposal looks reasonable (but I don't pretend mastering SWIG and 
anticipating all side effects) and you can experiment with that if you wish. 
Please make sure to test the 4 supported languages. If there are breakage you 
don't know how to fix, it will require coordination with me and Tamas and that 
should perhaps be done through a ticket with a patch, or a dedicated branch.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Mon Mar  9 00:08:34 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Mon, 09 Mar 2015 09:08:34 +0200
Subject: [gdal-dev] Bindings and typemaps
In-Reply-To: <201503082249.44856.even.rouault@spatialys.com>
References: <54FCBD32.1070607@gmail.com>
	<201503082249.44856.even.rouault@spatialys.com>
Message-ID: <54FD46F2.7000400@gmail.com>

08.03.2015, 23:49, Even Rouault kirjoitti:
> Le dimanche 08 mars 2015 22:20:50, Ari Jolma a ?crit :
>>
> Ari,
>
> Your proposal looks reasonable (but I don't pretend mastering SWIG and
> anticipating all side effects) and you can experiment with that if you wish.
> Please make sure to test the 4 supported languages. If there are breakage you
> don't know how to fix, it will require coordination with me and Tamas and that
> should perhaps be done through a ticket with a patch, or a dedicated branch.

Wouldn't the whole thing be best to be a branch from the beginning. If I 
branch the whole swig tree like this

http://emilsblog.lerch.org/2010/03/working-with-feature-branch-in.html

then it would assumably be quite simple to test all the changes in all 
languages. I don't know how to test C# and Java bindings. Especially C# 
is probably out of what I can do.

Ari

>
> Even
>


From even.rouault at spatialys.com  Mon Mar  9 02:18:35 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 9 Mar 2015 10:18:35 +0100
Subject: [gdal-dev] Bindings and typemaps
In-Reply-To: <54FD46F2.7000400@gmail.com>
References: <54FCBD32.1070607@gmail.com>
	<201503082249.44856.even.rouault@spatialys.com>
	<54FD46F2.7000400@gmail.com>
Message-ID: <201503091018.35311.even.rouault@spatialys.com>

Le lundi 09 mars 2015 08:08:34, Ari Jolma a ?crit :
> 08.03.2015, 23:49, Even Rouault kirjoitti:
> > Le dimanche 08 mars 2015 22:20:50, Ari Jolma a ?crit :
> > 
> > Ari,
> > 
> > Your proposal looks reasonable (but I don't pretend mastering SWIG and
> > anticipating all side effects) and you can experiment with that if you
> > wish. Please make sure to test the 4 supported languages. If there are
> > breakage you don't know how to fix, it will require coordination with me
> > and Tamas and that should perhaps be done through a ticket with a patch,
> > or a dedicated branch.
> 
> Wouldn't the whole thing be best to be a branch from the beginning.

Yes probably.

> If I
> branch the whole swig tree like this
> 
> http://emilsblog.lerch.org/2010/03/working-with-feature-branch-in.html
> 
> then it would assumably be quite simple to test all the changes in all
> languages.

Yes, I generally branch a whole repository, but a subtree might do too. 
Or if you prefer Git, you could fork https://github.com/OSGeo/gdal


> I don't know how to test C# and Java bindings. Especially C#
> is probably out of what I can do.
> 
> Ari
> 
> > Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Mon Mar  9 02:35:31 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Mon, 09 Mar 2015 11:35:31 +0200
Subject: [gdal-dev] Bindings and typemaps
In-Reply-To: <201503091018.35311.even.rouault@spatialys.com>
References: <54FCBD32.1070607@gmail.com>
	<201503082249.44856.even.rouault@spatialys.com>
	<54FD46F2.7000400@gmail.com>
	<201503091018.35311.even.rouault@spatialys.com>
Message-ID: <54FD6963.20105@gmail.com>

09.03.2015, 11:18, Even Rouault kirjoitti:
> Le lundi 09 mars 2015 08:08:34, Ari Jolma a ?crit :
>> 08.03.2015, 23:49, Even Rouault kirjoitti:
>>> Le dimanche 08 mars 2015 22:20:50, Ari Jolma a ?crit :
>>>
>>> Ari,
>>>
>>> Your proposal looks reasonable (but I don't pretend mastering SWIG and
>>> anticipating all side effects) and you can experiment with that if you
>>> wish. Please make sure to test the 4 supported languages. If there are
>>> breakage you don't know how to fix, it will require coordination with me
>>> and Tamas and that should perhaps be done through a ticket with a patch,
>>> or a dedicated branch.
>> Wouldn't the whole thing be best to be a branch from the beginning.
> Yes probably.

I'll do that.

IMO the goal would be to reduce language specific ifdefs from the 
general bindings, and remove unnecessary typedefs.

For example there are a lot of

#ifndef SWIGJAVA
   %feature( "kwargs" ) CopyLayer;
#endif

Is there a reason keywords arguments are not enabled with -keyword 
option for languages that support them?

Ari

>
>> If I
>> branch the whole swig tree like this
>>
>> http://emilsblog.lerch.org/2010/03/working-with-feature-branch-in.html
>>
>> then it would assumably be quite simple to test all the changes in all
>> languages.
> Yes, I generally branch a whole repository, but a subtree might do too.
> Or if you prefer Git, you could fork https://github.com/OSGeo/gdal
>
>
>> I don't know how to test C# and Java bindings. Especially C#
>> is probably out of what I can do.
>>
>> Ari
>>
>>> Even


From ari.jolma at gmail.com  Mon Mar  9 06:27:05 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Mon, 09 Mar 2015 15:27:05 +0200
Subject: [gdal-dev] Bindings and typemaps
In-Reply-To: <201503091018.35311.even.rouault@spatialys.com>
References: <54FCBD32.1070607@gmail.com>
	<201503082249.44856.even.rouault@spatialys.com>
	<54FD46F2.7000400@gmail.com>
	<201503091018.35311.even.rouault@spatialys.com>
Message-ID: <54FD9FA9.2000902@gmail.com>

09.03.2015, 11:18, Even Rouault kirjoitti:
> Or if you prefer Git, you could fork https://github.com/OSGeo/gdal 

I did this fork and made the changes in my copy. Then made a pull 
request and now it says that the Travis CI build passed.

But I assume Java etc. are not tested by Travis?

Ari


From even.rouault at spatialys.com  Mon Mar  9 06:31:59 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 9 Mar 2015 14:31:59 +0100
Subject: [gdal-dev] Bindings and typemaps
In-Reply-To: <54FD9FA9.2000902@gmail.com>
References: <54FCBD32.1070607@gmail.com>
	<201503091018.35311.even.rouault@spatialys.com>
	<54FD9FA9.2000902@gmail.com>
Message-ID: <201503091431.59557.even.rouault@spatialys.com>

Le lundi 09 mars 2015 14:27:05, Ari Jolma a ?crit :
> 09.03.2015, 11:18, Even Rouault kirjoitti:
> > Or if you prefer Git, you could fork https://github.com/OSGeo/gdal
> 
> I did this fork and made the changes in my copy. Then made a pull
> request and now it says that the Travis CI build passed.
> 
> But I assume Java etc. are not tested by Travis?

The Java, Perl and Python bindings are tested by Travis. See .travis.yml at 
the root of the repository

I've just added in Vagrant the ability to build the Java and CSharp bindings, 
as well as Perl and Python. It turns out that Swig 2.0.4 that comes with 
Ubuntu 12.04 isn't compatible with the CSharp bindings. So the .cpp files are 
generated by a manually compiled swig 1.3.40. But at runtime I get a linking 
failure.

> 
> Ari

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Mon Mar  9 06:47:48 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Mon, 09 Mar 2015 15:47:48 +0200
Subject: [gdal-dev] Bindings and typemaps
In-Reply-To: <201503091431.59557.even.rouault@spatialys.com>
References: <54FCBD32.1070607@gmail.com>
	<201503091018.35311.even.rouault@spatialys.com>
	<54FD9FA9.2000902@gmail.com>
	<201503091431.59557.even.rouault@spatialys.com>
Message-ID: <54FDA484.1090500@gmail.com>

I'm curious about the setup.

Do you commit to github, which then commits to trac.osgeo.org/gdal or 
how is the system setup?

Ari

09.03.2015, 15:31, Even Rouault kirjoitti:
> Le lundi 09 mars 2015 14:27:05, Ari Jolma a ?crit :
>> 09.03.2015, 11:18, Even Rouault kirjoitti:
>>> Or if you prefer Git, you could fork https://github.com/OSGeo/gdal
>> I did this fork and made the changes in my copy. Then made a pull
>> request and now it says that the Travis CI build passed.
>>
>> But I assume Java etc. are not tested by Travis?
> The Java, Perl and Python bindings are tested by Travis. See .travis.yml at
> the root of the repository
>
> I've just added in Vagrant the ability to build the Java and CSharp bindings,
> as well as Perl and Python. It turns out that Swig 2.0.4 that comes with
> Ubuntu 12.04 isn't compatible with the CSharp bindings. So the .cpp files are
> generated by a manually compiled swig 1.3.40. But at runtime I get a linking
> failure.
>
>> Ari


From even.rouault at spatialys.com  Mon Mar  9 07:01:15 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 9 Mar 2015 15:01:15 +0100
Subject: [gdal-dev] Bindings and typemaps
In-Reply-To: <54FDA484.1090500@gmail.com>
References: <54FCBD32.1070607@gmail.com>
	<201503091431.59557.even.rouault@spatialys.com>
	<54FDA484.1090500@gmail.com>
Message-ID: <201503091501.15471.even.rouault@spatialys.com>

Le lundi 09 mars 2015 14:47:48, Ari Jolma a ?crit :
> I'm curious about the setup.
> 
> Do you commit to github, which then commits to trac.osgeo.org/gdal or
> how is the system setup?

Regarding Travis, this is vaguely described at 
http://trac.osgeo.org/gdal/wiki/Buildbot

Basically I've a cron job that use git-svn to mirror svn history into git

Regarding my usual commits habits, I usually just svn commit. When I do 
development in git branches, I may use git svn dcommit to commit back into 
SVN, but you can only do that on your own git-svn mirror, not a fork of 
https://github.com/OSGeo/gdal.
Rougly described at 
https://trac.osgeo.org/gdal/wiki/UsingGitToMaintainGDALWorkflow
Otherwise I create a git patch and apply it in a SVN repository (with caution 
to manually svn add new files).

Regarding Vagrant, this is described here:
https://trac.osgeo.org/gdal/wiki/Vagrant

> 
> Ari
> 
> 09.03.2015, 15:31, Even Rouault kirjoitti:
> > Le lundi 09 mars 2015 14:27:05, Ari Jolma a ?crit :
> >> 09.03.2015, 11:18, Even Rouault kirjoitti:
> >>> Or if you prefer Git, you could fork https://github.com/OSGeo/gdal
> >> 
> >> I did this fork and made the changes in my copy. Then made a pull
> >> request and now it says that the Travis CI build passed.
> >> 
> >> But I assume Java etc. are not tested by Travis?
> > 
> > The Java, Perl and Python bindings are tested by Travis. See .travis.yml
> > at the root of the repository
> > 
> > I've just added in Vagrant the ability to build the Java and CSharp
> > bindings, as well as Perl and Python. It turns out that Swig 2.0.4 that
> > comes with Ubuntu 12.04 isn't compatible with the CSharp bindings. So
> > the .cpp files are generated by a manually compiled swig 1.3.40. But at
> > runtime I get a linking failure.
> > 
> >> Ari

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ChiefDan at gmail.com  Mon Mar  9 15:25:03 2015
From: ChiefDan at gmail.com (ChiefDan)
Date: Mon, 9 Mar 2015 15:25:03 -0700 (PDT)
Subject: [gdal-dev] GNM Usage
Message-ID: <1425939903413-5192401.post@n6.nabble.com>

I'm trying to use the GNM API to create a graph of a line layer and point
layer.
I assume I successfully build the network as I have the shapefiles output in
the directory.
When I try to find a path between 2 GFID's, I always get the void layer(no
path found).

I am not certain, but the GFIDs I am using are for 2 point features from the
point layer. I've used ogrinfo to verify I am getting the correct gfids.
I've done the simplest path check of picking 2 points that are on the same
line with no points in between.
 
I've basically taken the tutorial and used that code, substituting my line
and point source data.

I'd really appreciate any pointers.

Dan




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/GNM-Usage-tp5192401.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From ChiefDan at gmail.com  Mon Mar  9 15:50:28 2015
From: ChiefDan at gmail.com (ChiefDan)
Date: Mon, 9 Mar 2015 15:50:28 -0700 (PDT)
Subject: [gdal-dev] GNM Usage
In-Reply-To: <1425939903413-5192401.post@n6.nabble.com>
References: <1425939903413-5192401.post@n6.nabble.com>
Message-ID: <1425941428177-5192408.post@n6.nabble.com>

One thing when building the network I did not do was use CreateRule to add
costs to paths as this does not make sense in my use case.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/GNM-Usage-tp5192401p5192408.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From armin.burger at gmx.net  Mon Mar  9 16:25:53 2015
From: armin.burger at gmx.net (Armin Burger)
Date: Tue, 10 Mar 2015 00:25:53 +0100
Subject: [gdal-dev] OpenFileGDB, feature classes in feature dataset
Message-ID: <54FE2C01.80806@gmx.net>

Dear all

I have a question regarding the OpenFileGDB driver in 1.11.2 release. It 
now lists also non-spatial tables as layers of an FGDB (as mentioned in 
the changelog). But it seems to not list any more layers that are 
"feature classes" under a parent "feature dataset" (that's how the 
relation is displayed in ArcGIS). This is at least the case for FGDB's 
in older v9 format. In GDAL version 1.11.0 these feature classes were 
still listed as layers.

Is this a bug or an intended behavior?

Best regards
Armin

From even.rouault at spatialys.com  Mon Mar  9 22:48:12 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 10 Mar 2015 06:48:12 +0100
Subject: [gdal-dev] OpenFileGDB, feature classes in feature dataset
In-Reply-To: <54FE2C01.80806@gmx.net>
References: <54FE2C01.80806@gmx.net>
Message-ID: <1425966492.54fe859c1a13a@imp.free.fr>

Selon Armin Burger <armin.burger at gmx.net>:

> Dear all
>
> I have a question regarding the OpenFileGDB driver in 1.11.2 release. It
> now lists also non-spatial tables as layers of an FGDB (as mentioned in
> the changelog). But it seems to not list any more layers that are
> "feature classes" under a parent "feature dataset" (that's how the
> relation is displayed in ArcGIS). This is at least the case for FGDB's
> in older v9 format. In GDAL version 1.11.0 these feature classes were
> still listed as layers.
>
> Is this a bug or an intended behavior?
>

Looks like an unfortunate side effect. could you open a ticket and attach such a
GDB or provide a link to it ?


> Best regards
> Armin
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gusevmihs at gmail.com  Tue Mar 10 05:35:24 2015
From: gusevmihs at gmail.com (Mikhail Gusev)
Date: Tue, 10 Mar 2015 16:35:24 +0400
Subject: [gdal-dev] GNM Usage
In-Reply-To: <1425941428177-5192408.post@n6.nabble.com>
References: <1425939903413-5192401.post@n6.nabble.com>
	<1425941428177-5192408.post@n6.nabble.com>
Message-ID: <CAJB43Vo-Et48skQcDQhkbXYObwKuH_OrZZA+yYHwBQ4+-KnrnQ@mail.gmail.com>

Hello, Dan.
Have you checked whether the _gnm_graph table had been populated
successfully? May it be void? The possible reason of this can be that the
points are "too far from the line ends" so you could check if you have set
an appropriate for your data snap tolerance value.

2015-03-10 2:50 GMT+04:00 ChiefDan <ChiefDan at gmail.com>:

> One thing when building the network I did not do was use CreateRule to add
> costs to paths as this does not make sense in my use case.
>
>
>
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/GNM-Usage-tp5192401p5192408.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150310/45247be1/attachment.html>

From landa.martin at gmail.com  Tue Mar 10 05:56:12 2015
From: landa.martin at gmail.com (Martin Landa)
Date: Tue, 10 Mar 2015 13:56:12 +0100
Subject: [gdal-dev] libpng: Invalid color type/bit depth combination in IHDR
Message-ID: <CA+Ei1Oe==bQwKiCv=mO=SYeuLZEDUg55GwGAQhErA+xEibXehQ@mail.gmail.com>

Hi,

when trying to convert data [1] from GeoTIFF to PNG I ended up with error below:

gdal_translate -of PNG dmt.tif dmt.png
Input file size is 19615, 11119
Warning 1: libpng: Invalid color type/bit depth combination in IHDR
ERROR 1: libpng: Invalid IHDR data

GDAL: 2.0.0
libpng: 1.2.49

Any idea how to solve it? Thanks, Martin

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.cz/mentors/landa

From jukka.rahkonen at maanmittauslaitos.fi  Tue Mar 10 07:41:30 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Tue, 10 Mar 2015 14:41:30 +0000 (UTC)
Subject: [gdal-dev] libpng: Invalid color type/bit depth combination in
	IHDR
References: <CA+Ei1Oe==bQwKiCv=mO=SYeuLZEDUg55GwGAQhErA+xEibXehQ@mail.gmail.com>
Message-ID: <loom.20150310T154022-558@post.gmane.org>

Martin Landa <landa.martin <at> gmail.com> writes:

> 
> Hi,
> 
> when trying to convert data [1] from GeoTIFF to PNG I ended up with error
below:
> 
> gdal_translate -of PNG dmt.tif dmt.png
> Input file size is 19615, 11119
> Warning 1: libpng: Invalid color type/bit depth combination in IHDR
> ERROR 1: libpng: Invalid IHDR data


Hi,

What do you get from gdalinfo dmt.tif?

-Jukka Rahkonen-


From landa.martin at gmail.com  Tue Mar 10 07:46:12 2015
From: landa.martin at gmail.com (Martin Landa)
Date: Tue, 10 Mar 2015 15:46:12 +0100
Subject: [gdal-dev] libpng: Invalid color type/bit depth combination in
	IHDR
In-Reply-To: <loom.20150310T154022-558@post.gmane.org>
References: <CA+Ei1Oe==bQwKiCv=mO=SYeuLZEDUg55GwGAQhErA+xEibXehQ@mail.gmail.com>
	<loom.20150310T154022-558@post.gmane.org>
Message-ID: <CA+Ei1OdX8s5_OYRpc7NZjiL6HMM8hKYi8p09at=nDA35ZxrvYg@mail.gmail.com>

Hi,

2015-03-10 15:41 GMT+01:00 Jukka Rahkonen <jukka.rahkonen at maanmittauslaitos.fi>:
>> when trying to convert data [1] from GeoTIFF to PNG I ended up with error
> below:
>>
>> gdal_translate -of PNG dmt.tif dmt.png
>> Input file size is 19615, 11119
>> Warning 1: libpng: Invalid color type/bit depth combination in IHDR
>> ERROR 1: libpng: Invalid IHDR data
>
> What do you get from gdalinfo dmt.tif?

Ops, I forgot the link [1], here it is:

dalinfo dmt.tif -noct
Driver: GTiff/GeoTIFF
Files: dmt.tif
Size is 19615, 11119
Coordinate System is:
PROJCS["Lambert Azimuthal Equal Area",
    GEOGCS["grs80",
        DATUM["European_Terrestrial_Reference_System_1989",
            SPHEROID["Geodetic_Reference_System_1980",6378137,298.257222101,
                AUTHORITY["EPSG","7019"]],
            AUTHORITY["EPSG","6258"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Lambert_Azimuthal_Equal_Area"],
    PARAMETER["latitude_of_center",52],
    PARAMETER["longitude_of_center",10],
    PARAMETER["false_easting",4321000],
    PARAMETER["false_northing",3210000],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]]]
Origin = (4470075.000000000000000,3113850.000000000000000)
Pixel Size = (25.000000000000000,-25.000000000000000)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  ( 4470075.000, 3113850.000) ( 12d 7'45.45"E, 51d 6'58.63"N)
Lower Left  ( 4470075.000, 2835875.000) ( 12d 1'17.21"E, 48d37' 4.34"N)
Upper Right ( 4960450.000, 3113850.000) ( 19d 5'33.89"E, 50d46'40.98"N)
Lower Right ( 4960450.000, 2835875.000) ( 18d38'14.85"E, 48d17'56.80"N)
Center      ( 4715262.500, 2974862.500) ( 15d28'34.54"E, 49d45'14.51"N)
Band 1 Block=19615x1 Type=UInt16, ColorInterp=Palette
  NoData Value=65535
  Metadata:
    COLOR_TABLE_RULES_COUNT=5
    COLOR_TABLE_RULE_RGB_0=4.927737e+01 3.556740e+02 255 255 0 0 255 0
    COLOR_TABLE_RULE_RGB_1=3.556740e+02 6.620707e+02 0 255 0 0 255 255
    COLOR_TABLE_RULE_RGB_2=6.620707e+02 9.684673e+02 0 255 255 0 0 255
    COLOR_TABLE_RULE_RGB_3=9.684673e+02 1.274864e+03 0 0 255 255 0 255
    COLOR_TABLE_RULE_RGB_4=1.274864e+03 1.581261e+03 255 0 255 255 0 0
    Generated_with=GRASS GIS 7.1.svn
  Color Table (RGB with 65536 entries)

[1] http://training.gismentors.eu/geodata/eu-dem/dmt.zip

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.cz/mentors/landa

From jukka.rahkonen at maanmittauslaitos.fi  Tue Mar 10 08:03:46 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Tue, 10 Mar 2015 15:03:46 +0000 (UTC)
Subject: [gdal-dev]
	=?utf-8?q?libpng=3A_Invalid_color_type/bit_depth_combi?=
	=?utf-8?q?nation_in=09IHDR?=
References: <CA+Ei1Oe==bQwKiCv=mO=SYeuLZEDUg55GwGAQhErA+xEibXehQ@mail.gmail.com>
	<loom.20150310T154022-558@post.gmane.org>
	<CA+Ei1OdX8s5_OYRpc7NZjiL6HMM8hKYi8p09at=nDA35ZxrvYg@mail.gmail.com>
Message-ID: <loom.20150310T155928-145@post.gmane.org>

Martin Landa <landa.martin <at> gmail.com> writes:


> Ops, I forgot the link [1], here it is:
 
> dalinfo dmt.tif -noct
> Driver: GTiff/GeoTIFF
> Files: dmt.tif
> Size is 19615, 11119
> Band 1 Block=19615x1 Type=UInt16, ColorInterp=Palette


Hi,

Perhaps it is because 16 bit + palette is not supported combination in png.
At least it appears so in the table of 
http://en.wikipedia.org/wiki/Portable_Network_Graphics#Color_depth

-Jukka Rahkonen-


From couffi at hotmail.com  Tue Mar 10 07:59:32 2015
From: couffi at hotmail.com (laurent couffinal)
Date: Tue, 10 Mar 2015 14:59:32 +0000
Subject: [gdal-dev] Unable to access GDAL_DATA directory on Android
Message-ID: <DUB128-W62A2F90475319CF523CC73DF180@phx.gbl>

Hello,
i am having same problem with the EPSG and SpatialReference with Android.
But i didn't succed to make it work ..
i tryed the gdal.SetConfigOption("GDAL_DATA", path) but i have an error message OGR General Error..
 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150310/51176016/attachment.html>

From landa.martin at gmail.com  Tue Mar 10 08:37:52 2015
From: landa.martin at gmail.com (Martin Landa)
Date: Tue, 10 Mar 2015 16:37:52 +0100
Subject: [gdal-dev] libpng: Invalid color type/bit depth combination in
	IHDR
In-Reply-To: <loom.20150310T155928-145@post.gmane.org>
References: <CA+Ei1Oe==bQwKiCv=mO=SYeuLZEDUg55GwGAQhErA+xEibXehQ@mail.gmail.com>
	<loom.20150310T154022-558@post.gmane.org>
	<CA+Ei1OdX8s5_OYRpc7NZjiL6HMM8hKYi8p09at=nDA35ZxrvYg@mail.gmail.com>
	<loom.20150310T155928-145@post.gmane.org>
Message-ID: <CA+Ei1Oeqkdy=tVStrVC1cMeTNZkNF6R3BUatsWk0COBAYYssMQ@mail.gmail.com>

Hi,

2015-03-10 16:03 GMT+01:00 Jukka Rahkonen <jukka.rahkonen at maanmittauslaitos.fi>:
> Perhaps it is because 16 bit + palette is not supported combination in png.
> At least it appears so in the table of
> http://en.wikipedia.org/wiki/Portable_Network_Graphics#Color_depth

right, `-expand rgba` helped to convert data into RGBA PNG output.
Thanks, Martin

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.cz/mentors/landa

From ChiefDan at gmail.com  Tue Mar 10 13:27:11 2015
From: ChiefDan at gmail.com (ChiefDan)
Date: Tue, 10 Mar 2015 13:27:11 -0700 (PDT)
Subject: [gdal-dev] GNM Usage
In-Reply-To: <CAJB43Vo-Et48skQcDQhkbXYObwKuH_OrZZA+yYHwBQ4+-KnrnQ@mail.gmail.com>
References: <1425939903413-5192401.post@n6.nabble.com>
	<1425941428177-5192408.post@n6.nabble.com>
	<CAJB43Vo-Et48skQcDQhkbXYObwKuH_OrZZA+yYHwBQ4+-KnrnQ@mail.gmail.com>
Message-ID: <1426019231646-5192666.post@n6.nabble.com>

Looking at the _gnm_graph table, I think that is the issue. THere are some
connections, but only 8 out of ~300 points.
Is it required that the points layer be on the end of a line? The points
layer I have are on top of the lines, however a single line may have
multiple points along its length.

Dan



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/GNM-Usage-tp5192401p5192666.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From sault.don at gmail.com  Tue Mar 10 16:33:37 2015
From: sault.don at gmail.com (Donovan Cameron)
Date: Tue, 10 Mar 2015 16:33:37 -0700
Subject: [gdal-dev] can't compile gdal-grass plugin against GRASS 7
Message-ID: <54FF7F51.60705@gmail.com>

Afternoon everyone,

I'm having some problems getting the gdal-grass 1.11.2 plugin to compile 
with grass 7.0.0 installed on Arch Linux 64bit.

I've compiled GDAL 1.11.2 --without-grass, then compiled grass 7.0.0 
from the tar (even tried from the svn release 7_0 branch) archive.

Next tried to compile gdal-grass plugin but it complains:
configure: error: --with-grass=/opt/grass requested, but libraries not 
found!  Perhaps you need to set LD_LIBRARY_PATH to include /opt/grass/lib?

GRASS installed a grass.conf into /etc/ld.so.conf.d/ with the contents 
/opt/grass/lib and then I ran "sudo ldconfig" but still get same error.

The config.log for gdal-grass has a part in it that says:
"/usr/bin/ld: cannot find -lgrass_gis.7.0.svn
/usr/bin/ld: cannot find -lgrass_raster.7.0.svn
/usr/bin/ld: cannot find -lgrass_gmath.7.0.svn
/usr/bin/ld: cannot find -lgrass_gis.7.0.svn
/usr/bin/ld: cannot find -lgrass_datetime.7.0.svn
/usr/bin/ld: cannot find -lgrass_gproj.7.0.svn
/usr/bin/ld: cannot find -lgrass_vector.7.0.svn
/usr/bin/ld: cannot find -lgrass_dbmibase.7.0.svn
/usr/bin/ld: cannot find -lgrass_dbmiclient.7.0.svn
/usr/bin/ld: cannot find -lgrass_dgl.7.0.svn
/usr/bin/ld: cannot find -lgrass_dig2.7.0.svn
/usr/bin/ld: cannot find -lgrass_rtree.7.0.svn
/usr/bin/ld: cannot find -lgrass_linkm.7.0.svn
/usr/bin/ld: cannot find -lgrass_btree2.7.0.svn
/usr/bin/ld: cannot find -lgrass_ccmath.7.0.svn"

But /opt/grass/lib has files with a full version number like 
libgrass_gis.7.0.0.so instead of libgrass_gis.7.0.svn.so
And those are symlinks like "libgrass_gis.7.0.0.so -> libgrass_gis.so"


Any help would be greatly appreciated or if anyone needs more info, feel 
free to ask.




Donovan

From landa.martin at gmail.com  Tue Mar 10 16:46:34 2015
From: landa.martin at gmail.com (Martin Landa)
Date: Wed, 11 Mar 2015 00:46:34 +0100
Subject: [gdal-dev] can't compile gdal-grass plugin against GRASS 7
In-Reply-To: <54FF7F51.60705@gmail.com>
References: <54FF7F51.60705@gmail.com>
Message-ID: <CA+Ei1OctYmwXNMLpEk1MBbKvZBqN_v2rE-QnSTg+qv=5MbM1oA@mail.gmail.com>

Hi,

2015-03-11 0:33 GMT+01:00 Donovan Cameron <sault.don at gmail.com>:

> I'm having some problems getting the gdal-grass 1.11.2 plugin to compile
> with grass 7.0.0 installed on Arch Linux 64bit.
>
> I've compiled GDAL 1.11.2 --without-grass, then compiled grass 7.0.0 from
> the tar (even tried from the svn release 7_0 branch) archive.

I have recently fixed this issue for upcoming 1.11.3 [1]. I can send
you updated tarball if needed. Martin

[1] http://trac.osgeo.org/gdal/ticket/5852#comment:17

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.cz/mentors/landa

From sault.don at gmail.com  Tue Mar 10 17:15:17 2015
From: sault.don at gmail.com (Saulteau Don)
Date: Tue, 10 Mar 2015 17:15:17 -0700
Subject: [gdal-dev] can't compile gdal-grass plugin against GRASS 7
In-Reply-To: <CA+Ei1OctYmwXNMLpEk1MBbKvZBqN_v2rE-QnSTg+qv=5MbM1oA@mail.gmail.com>
References: <54FF7F51.60705@gmail.com>
	<CA+Ei1OctYmwXNMLpEk1MBbKvZBqN_v2rE-QnSTg+qv=5MbM1oA@mail.gmail.com>
Message-ID: <CAJo0jfMbVa-YgA2FGq66G1cpo1KXvtzzExXpf-Vco_162Qcgow@mail.gmail.com>

That's good news. Thanks Martin.

I'd like to test 1.11.3 so it'd be great if I could get a copy of it.


Donovan

On Tue, Mar 10, 2015 at 4:46 PM, Martin Landa <landa.martin at gmail.com>
wrote:

> Hi,
>
> 2015-03-11 0:33 GMT+01:00 Donovan Cameron <sault.don at gmail.com>:
>
> > I'm having some problems getting the gdal-grass 1.11.2 plugin to compile
> > with grass 7.0.0 installed on Arch Linux 64bit.
> >
> > I've compiled GDAL 1.11.2 --without-grass, then compiled grass 7.0.0 from
> > the tar (even tried from the svn release 7_0 branch) archive.
>
> I have recently fixed this issue for upcoming 1.11.3 [1]. I can send
> you updated tarball if needed. Martin
>
> [1] http://trac.osgeo.org/gdal/ticket/5852#comment:17
>
> --
> Martin Landa
> http://geo.fsv.cvut.cz/gwiki/Landa
> http://gismentors.cz/mentors/landa
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150310/7377fd77/attachment.html>

From landa.martin at gmail.com  Tue Mar 10 17:28:58 2015
From: landa.martin at gmail.com (Martin Landa)
Date: Wed, 11 Mar 2015 01:28:58 +0100
Subject: [gdal-dev] can't compile gdal-grass plugin against GRASS 7
In-Reply-To: <CAJo0jfMbVa-YgA2FGq66G1cpo1KXvtzzExXpf-Vco_162Qcgow@mail.gmail.com>
References: <54FF7F51.60705@gmail.com>
	<CA+Ei1OctYmwXNMLpEk1MBbKvZBqN_v2rE-QnSTg+qv=5MbM1oA@mail.gmail.com>
	<CAJo0jfMbVa-YgA2FGq66G1cpo1KXvtzzExXpf-Vco_162Qcgow@mail.gmail.com>
Message-ID: <CA+Ei1Of_Ep7ifYtS72FB+q1uYkTQ32jptq3no=AQHM_CG+p0Xg@mail.gmail.com>

Hi,

2015-03-11 1:15 GMT+01:00 Saulteau Don <sault.don at gmail.com>:
> That's good news. Thanks Martin.
>
> I'd like to test 1.11.3 so it'd be great if I could get a copy of it.

please try out [1].

Martin

[1] http://geo102.fsv.cvut.cz/~landa/tmp/gdal-grass-1.11.2.tar.gz

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.cz/mentors/landa

From gusevmihs at gmail.com  Wed Mar 11 03:15:32 2015
From: gusevmihs at gmail.com (Mikhail Gusev)
Date: Wed, 11 Mar 2015 14:15:32 +0400
Subject: [gdal-dev] GNM Usage
In-Reply-To: <1426019231646-5192666.post@n6.nabble.com>
References: <1425939903413-5192401.post@n6.nabble.com>
	<1425941428177-5192408.post@n6.nabble.com>
	<CAJB43Vo-Et48skQcDQhkbXYObwKuH_OrZZA+yYHwBQ4+-KnrnQ@mail.gmail.com>
	<1426019231646-5192666.post@n6.nabble.com>
Message-ID: <CAJB43Vp8H94DanWGqRCOr8KcT1uDzHrOoL7X7Y-iUgY_uepcwA@mail.gmail.com>

The topology building algorithm firstly takes one of the line features,
determines its start and end point coordinates, than forms two areas with
the center in those points and in size with the snap tolerance value and
than searches two point features which are situated in the formed areas.
The connection will be recorded to the _gnm_graph only if the two according
point features were found.
So in your case you should verify the snap tolerance parameter. If your
network has the projection SRS it is set in linear units.

2015-03-11 0:27 GMT+04:00 ChiefDan <ChiefDan at gmail.com>:

> Looking at the _gnm_graph table, I think that is the issue. THere are some
> connections, but only 8 out of ~300 points.
> Is it required that the points layer be on the end of a line? The points
> layer I have are on top of the lines, however a single line may have
> multiple points along its length.
>
> Dan
>
>
>
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/GNM-Usage-tp5192401p5192666.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150311/5ea016c3/attachment.html>

From ChiefDan at gmail.com  Wed Mar 11 03:28:46 2015
From: ChiefDan at gmail.com (ChiefDan)
Date: Wed, 11 Mar 2015 03:28:46 -0700 (PDT)
Subject: [gdal-dev] GNM Usage
In-Reply-To: <CAJB43Vp8H94DanWGqRCOr8KcT1uDzHrOoL7X7Y-iUgY_uepcwA@mail.gmail.com>
References: <1425939903413-5192401.post@n6.nabble.com>
	<1425941428177-5192408.post@n6.nabble.com>
	<CAJB43Vo-Et48skQcDQhkbXYObwKuH_OrZZA+yYHwBQ4+-KnrnQ@mail.gmail.com>
	<1426019231646-5192666.post@n6.nabble.com>
	<CAJB43Vp8H94DanWGqRCOr8KcT1uDzHrOoL7X7Y-iUgY_uepcwA@mail.gmail.com>
Message-ID: <1426069726970-5192757.post@n6.nabble.com>

Thanks for the response. The source data is in EPSG 900913, the network data
according to ogrinfo:
PROJCS["WGS_84_Pseudo_Mercator",
    GEOGCS["GCS_WGS_1984",
        DATUM["WGS_1984",
            SPHEROID["WGS_84",6378137,298.257223563]],
        PRIMEM["Greenwich",0],
        UNIT["Degree",0.017453292519943295]],
    PROJECTION["Mercator_1SP"],
    PARAMETER["central_meridian",0],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["Meter",1],
    PARAMETER["latitude_of_origin",0.0]]

Looking at the individual point values, they seem to be EPSG 4326:
OGRFeature(gnm_Frog_Branches_point):1
  name (String) = 78B-S-0
  gfid (Integer) = 68
  POINT (12.305749698885625 45.450093091932679)

For a line with multiple point objects on it, will the GNM processing break
the line up into multiple segments creating the line segments between the
points?
Also, if there are overlapping lines that form a Y intersection, can the GNM
processing recognize that as a potential path?




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/GNM-Usage-tp5192401p5192757.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From gusevmihs at gmail.com  Wed Mar 11 04:08:54 2015
From: gusevmihs at gmail.com (Mikhail Gusev)
Date: Wed, 11 Mar 2015 15:08:54 +0400
Subject: [gdal-dev] GNM Usage
In-Reply-To: <1426069726970-5192757.post@n6.nabble.com>
References: <1425939903413-5192401.post@n6.nabble.com>
	<1425941428177-5192408.post@n6.nabble.com>
	<CAJB43Vo-Et48skQcDQhkbXYObwKuH_OrZZA+yYHwBQ4+-KnrnQ@mail.gmail.com>
	<1426019231646-5192666.post@n6.nabble.com>
	<CAJB43Vp8H94DanWGqRCOr8KcT1uDzHrOoL7X7Y-iUgY_uepcwA@mail.gmail.com>
	<1426069726970-5192757.post@n6.nabble.com>
Message-ID: <CAJB43VqfaoHYrHRFkMD4COQ4+YPvzkP-_BkMTokESV_aBHVP0g@mail.gmail.com>

No, it will not break the line into segments. All point features that are
geometrically on the line feature except endings will be ignored.
For Y intersection the connections will be created only for 3 lines with
the common end point.

2015-03-11 14:28 GMT+04:00 ChiefDan <ChiefDan at gmail.com>:

> Thanks for the response. The source data is in EPSG 900913, the network
> data
> according to ogrinfo:
> PROJCS["WGS_84_Pseudo_Mercator",
>     GEOGCS["GCS_WGS_1984",
>         DATUM["WGS_1984",
>             SPHEROID["WGS_84",6378137,298.257223563]],
>         PRIMEM["Greenwich",0],
>         UNIT["Degree",0.017453292519943295]],
>     PROJECTION["Mercator_1SP"],
>     PARAMETER["central_meridian",0],
>     PARAMETER["false_easting",0],
>     PARAMETER["false_northing",0],
>     UNIT["Meter",1],
>     PARAMETER["latitude_of_origin",0.0]]
>
> Looking at the individual point values, they seem to be EPSG 4326:
> OGRFeature(gnm_Frog_Branches_point):1
>   name (String) = 78B-S-0
>   gfid (Integer) = 68
>   POINT (12.305749698885625 45.450093091932679)
>
> For a line with multiple point objects on it, will the GNM processing break
> the line up into multiple segments creating the line segments between the
> points?
> Also, if there are overlapping lines that form a Y intersection, can the
> GNM
> processing recognize that as a potential path?
>
>
>
>
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/GNM-Usage-tp5192401p5192757.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150311/72e9a6a0/attachment-0001.html>

From ChiefDan at gmail.com  Wed Mar 11 05:01:50 2015
From: ChiefDan at gmail.com (ChiefDan)
Date: Wed, 11 Mar 2015 05:01:50 -0700 (PDT)
Subject: [gdal-dev] GNM Usage
In-Reply-To: <CAJB43VqfaoHYrHRFkMD4COQ4+YPvzkP-_BkMTokESV_aBHVP0g@mail.gmail.com>
References: <1425939903413-5192401.post@n6.nabble.com>
	<1425941428177-5192408.post@n6.nabble.com>
	<CAJB43Vo-Et48skQcDQhkbXYObwKuH_OrZZA+yYHwBQ4+-KnrnQ@mail.gmail.com>
	<1426019231646-5192666.post@n6.nabble.com>
	<CAJB43Vp8H94DanWGqRCOr8KcT1uDzHrOoL7X7Y-iUgY_uepcwA@mail.gmail.com>
	<1426069726970-5192757.post@n6.nabble.com>
	<CAJB43VqfaoHYrHRFkMD4COQ4+YPvzkP-_BkMTokESV_aBHVP0g@mail.gmail.com>
Message-ID: <1426075310008-5192776.post@n6.nabble.com>

Thanks for the info!



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/GNM-Usage-tp5192401p5192776.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From lambesh at yahoo.com  Wed Mar 11 05:17:29 2015
From: lambesh at yahoo.com (lambesh)
Date: Wed, 11 Mar 2015 05:17:29 -0700 (PDT)
Subject: [gdal-dev] GDAL Compilation issues
Message-ID: <1426076248975-5192779.post@n6.nabble.com>

Hi,

I am new to the world of GDAL. One of my applications is currently using
GDAL111.dll, I managed to build both 32 and 64bit of GDAL. I have noticed
that 64bit GDAL has exported functions without STDCALL conventions (i.e,
without _GDALXXX at NN), accordingly, I modified my code and the 64 bit version
of my application is working fine.

Now, coming to my 32bit version of the application, even though I have
commented STDCALL=YES in nmake.opt file and added the following:
OPTFLAGS= $(CXX_ANALYZE_FLAGS) $(CXX_PDB_FLAGS) /nologo /MD /EHsc /Ox
/D_CRT_SECURE_NO_DEPRECATE /D_CRT_NONSTDC_NO_DEPRECATE /DNDEBUG
*-DCPL_DISABLE_STDCALL*
, my application is complaining about unresolved external symbols during
linking:

error LNK2001: unresolved external symbol "public: *virtual enum CPLErr*
__thiscall GDALRasterBand::GetDefaultHistogram(double *,double *,int *,int *
*,int,int (__stdcall*)(double,char const *,void *),void *)"
(?GetDefaultHistogram at GDALRasterBand@@UAE?AW4CPLErr@@PAN0PAHPAPAHHP6GHNPBDPAX at Z4@Z)
GLSGLibU.lib(GLSGWin.obj) : 

error LNK2019: unresolved external symbol *_GDALClose at 4* referenced in
function "public: virtual bool __thiscall
CGLSGWin::SaveBitmapFile(int,int,int,int,class ATL::CStringT<wchar_t,class
StrTraitMFC_DLL&lt;wchar_t,class ATL::ChTraitsCRT&lt;wchar_t> > >,class
ATL::CStringT<wchar_t,class StrTraitMFC_DLL&lt;wchar_t,class
ATL::ChTraitsCRT&lt;wchar_t> > >,bool,struct D3DXCOLOR)"
(?SaveBitmapFile at CGLSGWin@@UAE_NHHHHV?$CStringT at _WV?$StrTraitMFC_DLL at _WV?$ChTraitsCRT at _W@ATL@@@@@ATL@@0_NUD3DXCOLOR@@@Z)
GLSGLibU.lib(GLSGWin.obj) : 

error LNK2019: unresolved external symbol "public: class GDALDataset *
__thiscall GDALDriver::CreateCopy(char const *,class GDALDataset *,int,char
* *,int (__stdcall*)(double,char const *,void *),void *)"
(?CreateCopy at GDALDriver@@QAEPAVGDALDataset@@PBDPAV2 at HPAPADP6GHN0PAX@Z3 at Z)
referenced in function "public: virtual bool __thiscall
CGLSGWin::SaveBitmapFile(int,int,int,int,class ATL::CStringT<wchar_t,class
StrTraitMFC_DLL&lt;wchar_t,class ATL::ChTraitsCRT&lt;wchar_t> > >,class
ATL::CStringT<wchar_t,class StrTraitMFC_DLL&lt;wchar_t,class
ATL::ChTraitsCRT&lt;wchar_t> > >,bool,struct D3DXCOLOR)"
(?SaveBitmapFile at CGLSGWin@@UAE_NHHHHV?$CStringT at _WV?$StrTraitMFC_DLL at _WV?$ChTraitsCRT at _W@ATL@@@@@ATL@@0_NUD3DXCOLOR@@@Z)
GLSGLibU.lib(GLSGWin.obj) : 

error LNK2019: unresolved external symbol *_GDALAllRegister at 0* ...

I have also verified the exports from 32bit gdal111.dll and the functions
are similar to that of 64bit.

I am using the following in another library:
m_hGDALDLLInstance = LoadLibrary(_T("gdal111.dll"));

        if ( m_hGDALDLLInstance == NULL )
        {
            DWORD dWord = GetLastError();
            return false;
        }

        GDALAllRegister = (pfnGDALAllRegister)GetProcAddress(
m_hGDALDLLInstance, "GDALAllRegister");
        GDALOpen = (pfnGDALOpen)GetProcAddress( m_hGDALDLLInstance,
"GDALOpen");
        GDALClose = (pfnGDALClose)GetProcAddress( m_hGDALDLLInstance,
"GDALClose");
        GDALGetDatasetDriver = (pfnGDALGetDatasetDriver)GetProcAddress(
m_hGDALDLLInstance, "GDALGetDatasetDriver");
        GDALGetDriverShortName = (pfnGDALGetDriverShortName)GetProcAddress(
m_hGDALDLLInstance, "GDALGetDriverShortName");
        GDALGetProjectionRef = (pfnGDALGetProjectionRef)GetProcAddress(
m_hGDALDLLInstance, "GDALGetProjectionRef");
        GDALGetRasterXSize = (pfnGDALGetRasterXSize)GetProcAddress(
m_hGDALDLLInstance, "GDALGetRasterXSize");
        GDALGetRasterYSize = (pfnGDALGetRasterYSize)GetProcAddress(
m_hGDALDLLInstance, "GDALGetRasterYSize");
        GDALGetRasterCount = (pfnGDALGetRasterCount)GetProcAddress(
m_hGDALDLLInstance, "GDALGetRasterCount");
        GDALGetRasterBand = (pfnGDALGetRasterBand)GetProcAddress(
m_hGDALDLLInstance, "GDALGetRasterBand");
        GDALGetRasterBandXSize = (pfnGDALGetRasterBandXSize)GetProcAddress(
m_hGDALDLLInstance, "GDALGetRasterBandXSize");
        GDALGetRasterBandYSize = (pfnGDALGetRasterBandYSize)GetProcAddress(
m_hGDALDLLInstance, "GDALGetRasterBandYSize");
        GDALGetRasterNoDataValue =
(pfnGDALGetRasterNoDataValue)GetProcAddress( m_hGDALDLLInstance,
"GDALGetRasterNoDataValue");
        GDALGetRasterDataType = (pfnGDALGetRasterDataType)GetProcAddress(
m_hGDALDLLInstance, "GDALGetRasterDataType");
        GDALGetRasterCategoryNames =
(pfnGDALGetRasterCategoryNames)GetProcAddress( m_hGDALDLLInstance,
"GDALGetRasterCategoryNames");
        GDALGetRasterColorInterpretation =
(pfnGDALGetRasterColorInterpretation)GetProcAddress( m_hGDALDLLInstance,
"GDALGetRasterColorInterpretation");
        GDALGetGeoTransform = (pfnGDALGetGeoTransform)GetProcAddress(
m_hGDALDLLInstance, "GDALGetGeoTransform");
        GDALRasterIO = (pfnGDALRasterIO)GetProcAddress( m_hGDALDLLInstance,
"GDALRasterIO");
        GDALGetRasterColorTable =
(pfnGDALGetRasterColorTable)GetProcAddress( m_hGDALDLLInstance,
"GDALGetRasterColorTable");
        GDALGetColorEntryCount = (pfnGDALGetColorEntryCount)GetProcAddress(
m_hGDALDLLInstance, "GDALGetColorEntryCount");
        GDALGetColorEntryAsRGB = (pfnGDALGetColorEntryAsRGB)GetProcAddress(
m_hGDALDLLInstance, "GDALGetColorEntryAsRGB");
        GDALDatasetRasterIO = (pfnGDALDatasetRasterIO)GetProcAddress(
m_hGDALDLLInstance, "GDALDatasetRasterIO");

Any help in this regard would really appreciated as I don't want to rewrite
the above code for 32bit by adding _ in front of every function




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/GDAL-Compilation-issues-tp5192779.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From bishop.dev at gmail.com  Wed Mar 11 06:15:31 2015
From: bishop.dev at gmail.com (Dmitriy Baryshnikov)
Date: Wed, 11 Mar 2015 16:15:31 +0300
Subject: [gdal-dev] GNM Usage
In-Reply-To: <1426075310008-5192776.post@n6.nabble.com>
References: <1425939903413-5192401.post@n6.nabble.com>	<1425941428177-5192408.post@n6.nabble.com>	<CAJB43Vo-Et48skQcDQhkbXYObwKuH_OrZZA+yYHwBQ4+-KnrnQ@mail.gmail.com>	<1426019231646-5192666.post@n6.nabble.com>	<CAJB43Vp8H94DanWGqRCOr8KcT1uDzHrOoL7X7Y-iUgY_uepcwA@mail.gmail.com>	<1426069726970-5192757.post@n6.nabble.com>	<CAJB43VqfaoHYrHRFkMD4COQ4+YPvzkP-_BkMTokESV_aBHVP0g@mail.gmail.com>
	<1426075310008-5192776.post@n6.nabble.com>
Message-ID: <55003FF3.1040109@gmail.com>

Hi,

I also would like to note, that this is the simple and sample algorithm. 
You free to use the GNM API to create more complex connections. For 
example, the GNM allows to connect some polygons (i.e. countries) 
without physical  geometry intersect/connect (logical connection). So, 
you have more capabilities, but (by now) using API of GNM.

Best regards,
     Dmitry

11.03.2015 15:01, ChiefDan ?????:
> Thanks for the info!
>
>
>
> --
> View this message in context: http://osgeo-org.1560.x6.nabble.com/GNM-Usage-tp5192401p5192776.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


From jgomezdans at gmail.com  Wed Mar 11 09:06:33 2015
From: jgomezdans at gmail.com (Jose Gomez-Dans)
Date: Wed, 11 Mar 2015 16:06:33 +0000
Subject: [gdal-dev] GDAL/OGR 1.11.2 released
In-Reply-To: <201502171014.17701.even.rouault@spatialys.com>
References: <201502171014.17701.even.rouault@spatialys.com>
Message-ID: <CAMWde5qdLk6erCG=51H9Gc8UtzfEPG6kyrOZ3+V_D1FmnTHhQA@mail.gmail.com>

Hi,


On 17 February 2015 at 09:14, Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
> On behalf of the GDAL/OGR development team, I am pleased to
> announce the release of the GDAL/OGR 1.11.2 bug fix release.
>

I have compiled some binaries for Linux using the Anaconda Python
distribution. Some people might find them useful: http://bit.ly/1HCz4uI

Jose
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150311/caa376e5/attachment.html>

From sault.don at gmail.com  Wed Mar 11 09:58:09 2015
From: sault.don at gmail.com (Donovan Cameron)
Date: Wed, 11 Mar 2015 09:58:09 -0700
Subject: [gdal-dev] can't compile gdal-grass plugin against GRASS 7
In-Reply-To: <CA+Ei1Of_Ep7ifYtS72FB+q1uYkTQ32jptq3no=AQHM_CG+p0Xg@mail.gmail.com>
References: <54FF7F51.60705@gmail.com>	<CA+Ei1OctYmwXNMLpEk1MBbKvZBqN_v2rE-QnSTg+qv=5MbM1oA@mail.gmail.com>	<CAJo0jfMbVa-YgA2FGq66G1cpo1KXvtzzExXpf-Vco_162Qcgow@mail.gmail.com>
	<CA+Ei1Of_Ep7ifYtS72FB+q1uYkTQ32jptq3no=AQHM_CG+p0Xg@mail.gmail.com>
Message-ID: <55007421.4040603@gmail.com>

Thanks a lot Martin,

build worked great, just had to patch the resultant Makefile because...

make DESTDIR="${pkgdir}" install

...would fail because the DESTDIR var wasn't recognized in the Makefile, 
which I patched in.

But that's a limited use case and likely not applicable to anyone who 
isn't running Arch Linux and using makepkg.




Donovan

On 10/03/15 05:28 PM, Martin Landa wrote:
> Hi,
>
> 2015-03-11 1:15 GMT+01:00 Saulteau Don <sault.don at gmail.com>:
>> That's good news. Thanks Martin.
>>
>> I'd like to test 1.11.3 so it'd be great if I could get a copy of it.
> please try out [1].
>
> Martin
>
> [1] http://geo102.fsv.cvut.cz/~landa/tmp/gdal-grass-1.11.2.tar.gz
>


From simonf at google.com  Wed Mar 11 13:25:30 2015
From: simonf at google.com (Simon (Vsevolod) Ilyushchenko)
Date: Wed, 11 Mar 2015 13:25:30 -0700
Subject: [gdal-dev] How to check whether a GRIB file uses a sphere or a
	spheroid?
Message-ID: <CAM_aJuSfttynMyyp8E=pftTnUNzJ5wc0NZfe22GYJSKJux89KQ@mail.gmail.com>

Hi,

If I use GDAL to read GRIB files like these:
ftp://hydro1.sci.gsfc.nasa.gov/data/s4pa/NLDAS/NLDAS_NOAH0125_H.002/2015/065/NLDAS_NOAH0125_H.A20150306.1300.002.grb

the CRS I get back is:
GEOGCS["Coordinate System imported from GRIB file",
    DATUM["unknown",
        SPHEROID["Sphere",6371200,0]],
    PRIMEM["Greenwich",0],
    UNIT["degree",0.0174532925199433]]

Plotting these files shows that they are shifted 1.5 pixels north, but
setting CRS to EPSG:4326 that uses SPHEROID["WGS 84",6378137,298.257223563
instead fixes the issue.

I'm trying to understand whether the source files incorrectly specifies
that it's a sphere, or whether the GDAL driver is wrong, but I cannot find
a GRIB reader that would show me this information about the file. What's
the best way to debug this?

Thanks,
Simon
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150311/d1a30b73/attachment.html>

From warmerdam at pobox.com  Wed Mar 11 17:17:00 2015
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed, 11 Mar 2015 17:17:00 -0700
Subject: [gdal-dev] How to check whether a GRIB file uses a sphere or a
	spheroid?
In-Reply-To: <CAM_aJuSfttynMyyp8E=pftTnUNzJ5wc0NZfe22GYJSKJux89KQ@mail.gmail.com>
References: <CAM_aJuSfttynMyyp8E=pftTnUNzJ5wc0NZfe22GYJSKJux89KQ@mail.gmail.com>
Message-ID: <CA+YzLBeZad-1vMwhAOn9F0+WqHKME_vVU4grDQ3=LSx1+1RRhw@mail.gmail.com>

Simon,

I skimmed the code and there is no actual datum support in the grib
reader.  It does attempt to differentiate between ellipsoids and spheres so
I assume the file actually did record things as a sphere.  Generally
speaking it is not clear to me that the GRIB driver can actually do better
based on the information in the files but I'd be happy to be proven wrong.
In the meantime, it appears you will need to overwrite the geographic
coordinate system in your ingestor.

Best regards,
Frank


On Wed, Mar 11, 2015 at 1:25 PM, Simon (Vsevolod) Ilyushchenko <
simonf at google.com> wrote:

> Hi,
>
> If I use GDAL to read GRIB files like these:
>
> ftp://hydro1.sci.gsfc.nasa.gov/data/s4pa/NLDAS/NLDAS_NOAH0125_H.002/2015/065/NLDAS_NOAH0125_H.A20150306.1300.002.grb
>
> the CRS I get back is:
> GEOGCS["Coordinate System imported from GRIB file",
>     DATUM["unknown",
>         SPHEROID["Sphere",6371200,0]],
>     PRIMEM["Greenwich",0],
>     UNIT["degree",0.0174532925199433]]
>
> Plotting these files shows that they are shifted 1.5 pixels north, but
> setting CRS to EPSG:4326 that uses SPHEROID["WGS 84",6378137,298.257223563
> instead fixes the issue.
>
> I'm trying to understand whether the source files incorrectly specifies
> that it's a sphere, or whether the GDAL driver is wrong, but I cannot find
> a GRIB reader that would show me this information about the file. What's
> the best way to debug this?
>
> Thanks,
> Simon
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150311/a4c2d977/attachment.html>

From gergely.czuczy at harmless.hu  Fri Mar 13 15:07:41 2015
From: gergely.czuczy at harmless.hu (Gergely Czuczy)
Date: Fri, 13 Mar 2015 23:07:41 +0100
Subject: [gdal-dev] 3D TIN support in WKBs
Message-ID: <55035FAD.8020209@harmless.hu>

Hello,

I would like to ask whether there's any support for reading 3D TIN data
from WKBs, and if so, how can I do this?

Currently when I try to read the following's WKB:
TIN Z (((512 -512 0,512 512 0,-512 -512 0,512 -512 0)),((512 512 0,512
-512 0,-512 -512 0,512 512 0)))
I get the error message:
ERROR 6: Unsupported WKB type 1016
ERROR 3: OGR Error: Unsupported geometry type

I would like to read TINZ data from PostGIS into C++ and Python
programs, however there doesn't seem to be many libraries that support this.

So, how can I read such 3D TINs using GDAL?

Thanks in advance,
Gergely


From even.rouault at spatialys.com  Fri Mar 13 21:35:17 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 14 Mar 2015 05:35:17 +0100
Subject: [gdal-dev] 3D TIN support in WKBs
In-Reply-To: <55035FAD.8020209@harmless.hu>
References: <55035FAD.8020209@harmless.hu>
Message-ID: <1426307717.5503ba852d173@imp.free.fr>

Selon Gergely Czuczy <gergely.czuczy at harmless.hu>:

> Hello,
>
> I would like to ask whether there's any support for reading 3D TIN data
> from WKBs, and if so, how can I do this?
>
> Currently when I try to read the following's WKB:
> TIN Z (((512 -512 0,512 512 0,-512 -512 0,512 -512 0)),((512 512 0,512
> -512 0,-512 -512 0,512 512 0)))
> I get the error message:
> ERROR 6: Unsupported WKB type 1016
> ERROR 3: OGR Error: Unsupported geometry type
>
> I would like to read TINZ data from PostGIS into C++ and Python
> programs, however there doesn't seem to be many libraries that support this.
>
> So, how can I read such 3D TINs using GDAL?

Gergely,

There's no support in GDAL for TIN. If you would want to implement it, you could
take inspiration of what has been done recently to support curve geometries.
Reading http://trac.osgeo.org/gdal/wiki/rfc49_curve_geometries should direct you
at the places to modify.

If you want to take a shorter route, you could just parse the WKB/WKT returned
by PostGIS at your application side.

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gergely.czuczy at harmless.hu  Fri Mar 13 23:17:04 2015
From: gergely.czuczy at harmless.hu (Gergely Czuczy)
Date: Sat, 14 Mar 2015 07:17:04 +0100
Subject: [gdal-dev] 3D TIN support in WKBs
In-Reply-To: <1426307717.5503ba852d173@imp.free.fr>
References: <55035FAD.8020209@harmless.hu>
	<1426307717.5503ba852d173@imp.free.fr>
Message-ID: <5503D260.20205@harmless.hu>

On 14/03/2015 05:35, Even Rouault wrote:
> Selon Gergely Czuczy <gergely.czuczy at harmless.hu>:
>
>> Hello,
>>
>> I would like to ask whether there's any support for reading 3D TIN data
>> from WKBs, and if so, how can I do this?
>>
>> Currently when I try to read the following's WKB:
>> TIN Z (((512 -512 0,512 512 0,-512 -512 0,512 -512 0)),((512 512 0,512
>> -512 0,-512 -512 0,512 512 0)))
>> I get the error message:
>> ERROR 6: Unsupported WKB type 1016
>> ERROR 3: OGR Error: Unsupported geometry type
>>
>> I would like to read TINZ data from PostGIS into C++ and Python
>> programs, however there doesn't seem to be many libraries that support this.
>>
>> So, how can I read such 3D TINs using GDAL?
> Gergely,
>
> There's no support in GDAL for TIN. If you would want to implement it, you could
> take inspiration of what has been done recently to support curve geometries.
> Reading http://trac.osgeo.org/gdal/wiki/rfc49_curve_geometries should direct you
> at the places to modify.
>
> If you want to take a shorter route, you could just parse the WKB/WKT returned
> by PostGIS at your application side.
>
> Even
Thank you for your reply. To be honest I would like to focus on my pet 
project, and probably you could find better people with 3D/graphics 
coding experience than me. That's one of the reasons why I am looking 
for some library to do the heavy lifting instead of me.

Could you please give me some pointers on how to parse a WKB/WKT? 
Especially the float representation in the WKB I'm interested in. I 
think I will try to parse it myself.

After that, if I parse it manually, can I construct a gdal object out of 
it for manipulation, and at the end export it again to one or more TINZs 
for propagating it back into postgis?

Gergely

From armin.burger at gmx.net  Sat Mar 14 07:30:13 2015
From: armin.burger at gmx.net (Armin Burger)
Date: Sat, 14 Mar 2015 15:30:13 +0100
Subject: [gdal-dev] OpenFileGDB, feature classes in feature dataset
In-Reply-To: <1425966492.54fe859c1a13a@imp.free.fr>
References: <54FE2C01.80806@gmx.net> <1425966492.54fe859c1a13a@imp.free.fr>
Message-ID: <550445F5.2030004@gmx.net>

Hi Even

thanks for the reply!

The FGDB dataset where I discovered that has unfortunately some 
commercial IPR restrictions, so I cannot share it (and it in addition 
has some 800 MB...). I will try to create a test FGDB with a similar 
internal structure, I have to check if I can create an FGDB v9 format 
with recent ArcGIS versions.

Armin


On 03/10/2015 06:48 AM, Even Rouault wrote:
> Selon Armin Burger <armin.burger at gmx.net>:
>
>> Dear all
>>
>> I have a question regarding the OpenFileGDB driver in 1.11.2 release. It
>> now lists also non-spatial tables as layers of an FGDB (as mentioned in
>> the changelog). But it seems to not list any more layers that are
>> "feature classes" under a parent "feature dataset" (that's how the
>> relation is displayed in ArcGIS). This is at least the case for FGDB's
>> in older v9 format. In GDAL version 1.11.0 these feature classes were
>> still listed as layers.
>>
>> Is this a bug or an intended behavior?
>>
>
> Looks like an unfortunate side effect. could you open a ticket and attach such a
> GDB or provide a link to it ?
>
>
>> Best regards
>> Armin
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>

From even.rouault at spatialys.com  Sat Mar 14 20:08:57 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 15 Mar 2015 04:08:57 +0100
Subject: [gdal-dev] OpenFileGDB, feature classes in feature dataset
In-Reply-To: <550445F5.2030004@gmx.net>
References: <54FE2C01.80806@gmx.net> <1425966492.54fe859c1a13a@imp.free.fr>
	<550445F5.2030004@gmx.net>
Message-ID: <1426388937.5504f7c920a12@imp.free.fr>

Armin,

I've committed a fix in http://trac.osgeo.org/gdal/ticket/5875 that should
hopefully fix your issue. There was a problem with the presence of non spatial
tables that could cause later tables not to be listed. This wasn't specifically
related to feature classes.

Even

> Hi Even
>
> thanks for the reply!
>
> The FGDB dataset where I discovered that has unfortunately some
> commercial IPR restrictions, so I cannot share it (and it in addition
> has some 800 MB...). I will try to create a test FGDB with a similar
> internal structure, I have to check if I can create an FGDB v9 format
> with recent ArcGIS versions.
>
> Armin
>
>
> On 03/10/2015 06:48 AM, Even Rouault wrote:
> > Selon Armin Burger <armin.burger at gmx.net>:
> >
> >> Dear all
> >>
> >> I have a question regarding the OpenFileGDB driver in 1.11.2 release. It
> >> now lists also non-spatial tables as layers of an FGDB (as mentioned in
> >> the changelog). But it seems to not list any more layers that are
> >> "feature classes" under a parent "feature dataset" (that's how the
> >> relation is displayed in ArcGIS). This is at least the case for FGDB's
> >> in older v9 format. In GDAL version 1.11.0 these feature classes were
> >> still listed as layers.
> >>
> >> Is this a bug or an intended behavior?
> >>
> >
> > Looks like an unfortunate side effect. could you open a ticket and attach
> such a
> > GDB or provide a link to it ?
> >
> >
> >> Best regards
> >> Armin
> >> _______________________________________________
> >> gdal-dev mailing list
> >> gdal-dev at lists.osgeo.org
> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >>
> >
> >
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From zoltans at geograph.co.za  Sun Mar 15 10:43:58 2015
From: zoltans at geograph.co.za (Zoltan Szecsei)
Date: Sun, 15 Mar 2015 19:43:58 +0200
Subject: [gdal-dev] gdal_translate with -projwin
Message-ID: <5505C4DE.2090505@geograph.co.za>

Hi,
I've been banging my head for an hour or so, and I cannot spot my 
(deliberate) error in trying to clip out an area from a vrt file.

    *geograph at gs01:/20150315_work/gdal$* gdal_translate --version
    GDAL 2.0.0dev, released 2014/04/16

    *geograph at gs01:/20150315_work/gdal$* gdal_translate -projwin -32666
    -3284691 -30125 -3288248 -of GTiff -co TFW=YES -co COMPRESS=LZW
    /mnt/geo_lvm0/gisdata/raster/ortho/ngi_20141205_WGS1984_Lo31.vrt
    AW25a.tif
    Input file size is 341744, 512321
    Computed -srcwin 129951 151143 5082 7114 from projected window.
    *geograph at gs01:/20150315_work/gdal$*

and AW25a.tif is not created.

I have also tried:

    removing everything except projwin, srcdata and dstdata - to no avail.
    using the computed values with -srcwin instead of -projwin
    putting quotes around the -co options


Any thoughts welcome.
Thanks in advance,
Zoltan

    *geograph at gs01:/20150315_work/gdal$* gdalinfo
    /mnt/geo_lvm0/gisdata/raster/orthos/ngi_20141205_WGS1984_Lo31.vrt
    Driver: VRT/Virtual Raster
    Files: /mnt/geo_lvm0/gisdata/raster/orthos/ngi_20141205_WGS1984_Lo31.vrt
    /mnt/geo_lvm0/gisdata/raster/orthos/ngi_20141205/2930AA/2930AA_01_2009_116_RGB_RECT.tif

    *dot...dot...dot...*

    /mnt/geo_lvm0/gisdata/raster/orthos/ngi_20141205/3130AB/3130AB_01_2013_559_RGB_RECT.tif
    /mnt/geo_lvm0/gisdata/raster/orthos/ngi_20141205/3130AC/3130AC_01_06_2013_559_RGB_RECT.tif
    Size is 341744, 512321
    Coordinate System is:
    PROJCS["Projection: Transverse Mercator; Datum: WGS84; Ellipsoid:
    WGS84",
         GEOGCS["WGS 84",
             DATUM["WGS_1984",
                 SPHEROID["WGS 84",6378137,298.257223563,
                     AUTHORITY["EPSG","7030"]],
                 AUTHORITY["EPSG","6326"]],
             PRIMEM["Greenwich",0],
             UNIT["degree",0.0174532925199433],
             AUTHORITY["EPSG","4326"]],
         PROJECTION["Transverse_Mercator"],
         PARAMETER["latitude_of_origin",0],
         PARAMETER["central_meridian",31],
         PARAMETER["scale_factor",1],
         PARAMETER["false_easting",0],
         PARAMETER["false_northing",0],
         UNIT["metre",1,
             AUTHORITY["EPSG","9001"]]]
    Origin = (-97641.549180324524059,-3209119.323926338460296)
    Pixel Size = (0.500000000000000,-0.500000000000000)
    Corner Coordinates:
    Upper Left  (  -97641.549,-3209119.324) ( 29d59'52.79"E, 28d59'41.68"S)
    Lower Left  (  -97641.549,-3465279.824) ( 29d58'27.71"E, 31d18'19.15"S)
    Upper Right (   73230.451,-3209119.324) ( 31d45' 5.46"E, 28d59'47.57"S)
    Lower Right (   73230.451,-3465279.824) ( 31d46' 9.27"E, 31d18'25.60"S)
    Center      (  -12205.549,-3337199.574) ( 30d52'23.89"E, 30d 9'14.66"S)
    Band 1 Block=128x128 Type=Byte, ColorInterp=Red
       NoData Value=0
    Band 2 Block=128x128 Type=Byte, ColorInterp=Green
       NoData Value=0
    Band 3 Block=128x128 Type=Byte, ColorInterp=Blue
       NoData Value=0
    *geograph at gs01:/20150315_work/gdal$ *


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150315/a9b50649/attachment.html>

From PriceR at landcareresearch.co.nz  Sun Mar 15 18:57:13 2015
From: PriceR at landcareresearch.co.nz (Robbie Price)
Date: Mon, 16 Mar 2015 01:57:13 +0000
Subject: [gdal-dev] trouble with netCDF in C#?
Message-ID: <F8C3C6DB66146D45BB0C091BEA01D9E1123136CA@HERMES.landcare.ad.landcareresearch.co.nz>

I'm having trouble converting some netcdf (version 3) files to Kea files using the GDAL C# bindings.

The problem is some form of memory leak caused by the netCDF code (from what I can establish through various tests).

There are two issues:

1)       A memory leak in this call (which I noticed, but can work around as I am only dealing with a small number of subdatasets)

a.  dsNetCDF = OSGeo.GDAL.Gdal.Open(strNetCDF_DSN, OSGeo.GDAL.Access.GA_ReadOnly);

2)      A memory issue/leak pointer assignment causing a crash that I cannot trace the error reports as:

Managed Debugging Assistant 'FatalExecutionEngineError' has detected a problem in 'O:\Projects\KEA_ReadWrite\bin\x64\Debug\KEA_ReadWrite.vshost.exe'.
Additional Information: The runtime has encountered a fatal error. The address of the error was at 0xebc85654, on thread 0x16ec. The error code is 0xc0000005. This error may be a bug in the CLR or in the unsafe or non-verifiable portions of user code. Common sources of this bug include user marshaling errors for COM-interop or PInvoke, which may corrupt the stack.

The error is consistent in nature but happens inconsistently in the code (between 1800 and 4000 bands) - here from another run:
Managed Debugging Assistant 'FatalExecutionEngineError' has detected a problem in 'O:\Projects\KEA_ReadWrite\bin\x64\Debug\KEA_ReadWrite.vshost.exe'.
Additional Information: The runtime has encountered a fatal error. The address of the error was at 0xebc85654, on thread 0x199c. The error code is 0xc0000005. This error may be a bug in the CLR or in the unsafe or non-verifiable portions of user code. Common sources of this bug include user marshaling errors for COM-interop or PInvoke, which may corrupt the stack.

The error MAY be occurring more often only on lines handling string functions (?)

Version Details

Using MSVS 2010 (C#) and the following:

http://www.gisinternals.com/query.html?content=filelist&file=release-1600-x64-gdal-mapserver.zip

gdal-200-1600-x64-core.msi<http://download2.gisinternals.com/sdk/Download.aspx?file=release-1600-x64-gdal-mapserver/gdal-200-1600-x64-core.msi>

3/15/2015 4:13 AM

21556 kB

Generic installer for the GDAL core components



Basic scenario is converting from one file type to another but taking the meta info from the NetCDF and using as band name info in the Kea file.  Input files have between 365 and 8000 bands but not large spatially (260*243).

________________________________

Please consider the environment before printing this email
Warning: This electronic message together with any attachments is confidential. If you receive it in error: (i) you must not read, use, disclose, copy or retain it; (ii) please contact the sender immediately by reply email and then delete the emails.
The views expressed in this email may not be those of Landcare Research New Zealand Limited. http://www.landcareresearch.co.nz
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150316/e9fa27e6/attachment.html>

From even.rouault at spatialys.com  Mon Mar 16 00:42:06 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 16 Mar 2015 08:42:06 +0100
Subject: [gdal-dev] gdal_translate with -projwin
In-Reply-To: <5505C4DE.2090505@geograph.co.za>
References: <5505C4DE.2090505@geograph.co.za>
Message-ID: <1426491726.5506894ed49fe@imp.free.fr>

Selon Zoltan Szecsei <zoltans at geograph.co.za>:

> Hi,
> I've been banging my head for an hour or so, and I cannot spot my
> (deliberate) error in trying to clip out an area from a vrt file.
>
>     *geograph at gs01:/20150315_work/gdal$* gdal_translate --version
>     GDAL 2.0.0dev, released 2014/04/16
>
>     *geograph at gs01:/20150315_work/gdal$* gdal_translate -projwin -32666
>     -3284691 -30125 -3288248 -of GTiff -co TFW=YES -co COMPRESS=LZW
>     /mnt/geo_lvm0/gisdata/raster/ortho/ngi_20141205_WGS1984_Lo31.vrt
>     AW25a.tif
>     Input file size is 341744, 512321
>     Computed -srcwin 129951 151143 5082 7114 from projected window.
>     *geograph at gs01:/20150315_work/gdal$*
>
> and AW25a.tif is not created.

Zoltan,

Nothing strikes my eyes as obviously wrong. You really mean no output file at
all ? And the commands runs instantenously ?

>
> I have also tried:
>
>     removing everything except projwin, srcdata and dstdata - to no avail.
>     using the computed values with -srcwin instead of -projwin
>     putting quotes around the -co options
>
>
> Any thoughts welcome.
> Thanks in advance,
> Zoltan
>
>     *geograph at gs01:/20150315_work/gdal$* gdalinfo
>     /mnt/geo_lvm0/gisdata/raster/orthos/ngi_20141205_WGS1984_Lo31.vrt
>     Driver: VRT/Virtual Raster
>     Files: /mnt/geo_lvm0/gisdata/raster/orthos/ngi_20141205_WGS1984_Lo31.vrt
>
>
/mnt/geo_lvm0/gisdata/raster/orthos/ngi_20141205/2930AA/2930AA_01_2009_116_RGB_RECT.tif
>
>     *dot...dot...dot...*
>
>
>
/mnt/geo_lvm0/gisdata/raster/orthos/ngi_20141205/3130AB/3130AB_01_2013_559_RGB_RECT.tif
>
>
/mnt/geo_lvm0/gisdata/raster/orthos/ngi_20141205/3130AC/3130AC_01_06_2013_559_RGB_RECT.tif
>     Size is 341744, 512321
>     Coordinate System is:
>     PROJCS["Projection: Transverse Mercator; Datum: WGS84; Ellipsoid:
>     WGS84",
>          GEOGCS["WGS 84",
>              DATUM["WGS_1984",
>                  SPHEROID["WGS 84",6378137,298.257223563,
>                      AUTHORITY["EPSG","7030"]],
>                  AUTHORITY["EPSG","6326"]],
>              PRIMEM["Greenwich",0],
>              UNIT["degree",0.0174532925199433],
>              AUTHORITY["EPSG","4326"]],
>          PROJECTION["Transverse_Mercator"],
>          PARAMETER["latitude_of_origin",0],
>          PARAMETER["central_meridian",31],
>          PARAMETER["scale_factor",1],
>          PARAMETER["false_easting",0],
>          PARAMETER["false_northing",0],
>          UNIT["metre",1,
>              AUTHORITY["EPSG","9001"]]]
>     Origin = (-97641.549180324524059,-3209119.323926338460296)
>     Pixel Size = (0.500000000000000,-0.500000000000000)
>     Corner Coordinates:
>     Upper Left  (  -97641.549,-3209119.324) ( 29d59'52.79"E, 28d59'41.68"S)
>     Lower Left  (  -97641.549,-3465279.824) ( 29d58'27.71"E, 31d18'19.15"S)
>     Upper Right (   73230.451,-3209119.324) ( 31d45' 5.46"E, 28d59'47.57"S)
>     Lower Right (   73230.451,-3465279.824) ( 31d46' 9.27"E, 31d18'25.60"S)
>     Center      (  -12205.549,-3337199.574) ( 30d52'23.89"E, 30d 9'14.66"S)
>     Band 1 Block=128x128 Type=Byte, ColorInterp=Red
>        NoData Value=0
>     Band 2 Block=128x128 Type=Byte, ColorInterp=Green
>        NoData Value=0
>     Band 3 Block=128x128 Type=Byte, ColorInterp=Blue
>        NoData Value=0
>     *geograph at gs01:/20150315_work/gdal$ *
>
>
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From zoltans at geograph.co.za  Mon Mar 16 01:21:07 2015
From: zoltans at geograph.co.za (Zoltan Szecsei)
Date: Mon, 16 Mar 2015 10:21:07 +0200
Subject: [gdal-dev] gdal_translate with -projwin
In-Reply-To: <1426491726.5506894ed49fe@imp.free.fr>
References: <5505C4DE.2090505@geograph.co.za>
	<1426491726.5506894ed49fe@imp.free.fr>
Message-ID: <55069273.9090300@geograph.co.za>

On 2015/03/16 09:42, Even Rouault wrote:
> Selon Zoltan Szecsei <zoltans at geograph.co.za>:
>
>> Hi,
>> I've been banging my head for an hour or so, and I cannot spot my
>> (deliberate) error in trying to clip out an area from a vrt file.
>>
>>      *geograph at gs01:/20150315_work/gdal$* gdal_translate --version
>>      GDAL 2.0.0dev, released 2014/04/16
>>
>>      *geograph at gs01:/20150315_work/gdal$* gdal_translate -projwin -32666
>>      -3284691 -30125 -3288248 -of GTiff -co TFW=YES -co COMPRESS=LZW
>>      /mnt/geo_lvm0/gisdata/raster/ortho/ngi_20141205_WGS1984_Lo31.vrt
>>      AW25a.tif
>>      Input file size is 341744, 512321
>>      Computed -srcwin 129951 151143 5082 7114 from projected window.
>>      *geograph at gs01:/20150315_work/gdal$*
>>
>> and AW25a.tif is not created.
> Zoltan,
>
> Nothing strikes my eyes as obviously wrong. You really mean no output file at
> all ? And the commands runs instantenously ?

Correct

>
>> I have also tried:
>>
>>      removing everything except projwin, srcdata and dstdata - to no avail.
>>      using the computed values with -srcwin instead of -projwin
>>      putting quotes around the -co options
>>
>>
>> Any thoughts welcome.
>> Thanks in advance,
>> Zoltan
>>
>>      *geograph at gs01:/20150315_work/gdal$* gdalinfo
>>      /mnt/geo_lvm0/gisdata/raster/orthos/ngi_20141205_WGS1984_Lo31.vrt
>>      Driver: VRT/Virtual Raster
>>      Files: /mnt/geo_lvm0/gisdata/raster/orthos/ngi_20141205_WGS1984_Lo31.vrt
>>
>>
> /mnt/geo_lvm0/gisdata/raster/orthos/ngi_20141205/2930AA/2930AA_01_2009_116_RGB_RECT.tif
>>      *dot...dot...dot...*
>>
>>
>>
> /mnt/geo_lvm0/gisdata/raster/orthos/ngi_20141205/3130AB/3130AB_01_2013_559_RGB_RECT.tif
>>
> /mnt/geo_lvm0/gisdata/raster/orthos/ngi_20141205/3130AC/3130AC_01_06_2013_559_RGB_RECT.tif
>>      Size is 341744, 512321
>>      Coordinate System is:
>>      PROJCS["Projection: Transverse Mercator; Datum: WGS84; Ellipsoid:
>>      WGS84",
>>           GEOGCS["WGS 84",
>>               DATUM["WGS_1984",
>>                   SPHEROID["WGS 84",6378137,298.257223563,
>>                       AUTHORITY["EPSG","7030"]],
>>                   AUTHORITY["EPSG","6326"]],
>>               PRIMEM["Greenwich",0],
>>               UNIT["degree",0.0174532925199433],
>>               AUTHORITY["EPSG","4326"]],
>>           PROJECTION["Transverse_Mercator"],
>>           PARAMETER["latitude_of_origin",0],
>>           PARAMETER["central_meridian",31],
>>           PARAMETER["scale_factor",1],
>>           PARAMETER["false_easting",0],
>>           PARAMETER["false_northing",0],
>>           UNIT["metre",1,
>>               AUTHORITY["EPSG","9001"]]]
>>      Origin = (-97641.549180324524059,-3209119.323926338460296)
>>      Pixel Size = (0.500000000000000,-0.500000000000000)
>>      Corner Coordinates:
>>      Upper Left  (  -97641.549,-3209119.324) ( 29d59'52.79"E, 28d59'41.68"S)
>>      Lower Left  (  -97641.549,-3465279.824) ( 29d58'27.71"E, 31d18'19.15"S)
>>      Upper Right (   73230.451,-3209119.324) ( 31d45' 5.46"E, 28d59'47.57"S)
>>      Lower Right (   73230.451,-3465279.824) ( 31d46' 9.27"E, 31d18'25.60"S)
>>      Center      (  -12205.549,-3337199.574) ( 30d52'23.89"E, 30d 9'14.66"S)
>>      Band 1 Block=128x128 Type=Byte, ColorInterp=Red
>>         NoData Value=0
>>      Band 2 Block=128x128 Type=Byte, ColorInterp=Green
>>         NoData Value=0
>>      Band 3 Block=128x128 Type=Byte, ColorInterp=Blue
>>         NoData Value=0
>>      *geograph at gs01:/20150315_work/gdal$ *
>>
>>
>>
>


-- 

===========================================
Zoltan Szecsei PrGISc [PGP0031]
Geograph (Pty) Ltd.
GIS and Photogrammetric Services

P.O. Box 7, Muizenberg 7950, South Africa.

Mobile: +27-83-6004028
Fax:    +27-86-6115323     www.geograph.co.za
===========================================


From jukka.rahkonen at maanmittauslaitos.fi  Mon Mar 16 02:56:44 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Mon, 16 Mar 2015 09:56:44 +0000 (UTC)
Subject: [gdal-dev] =?utf-8?q?gdal=5Ftranslate_with_-projwin?=
References: <5505C4DE.2090505@geograph.co.za>
	<1426491726.5506894ed49fe@imp.free.fr>
Message-ID: <loom.20150316T104929-807@post.gmane.org>

Even Rouault <even.rouault <at> spatialys.com> writes:

> 
> Selon Zoltan Szecsei <zoltans <at> geograph.co.za>:
> 
> > Hi,
> > I've been banging my head for an hour or so, and I cannot spot my
> > (deliberate) error in trying to clip out an area from a vrt file.

> 
> Zoltan,
> 
> Nothing strikes my eyes as obviously wrong. You really mean no output file at
> all ? And the commands runs instantenously ?

Hi,

Keep is as simple as possible. Make a test with one original tiff. Once you
can clip an area out of that with -prjwin, create a VRT file from that one
image only. If clipping is still successful, add more images into VRT.
Continue until the failure happens again. Think what happens then. Perhaps
it is a faulty image or then there is something wrong in GDAL.

But if clipping fails with one single image in VRT, put some small sample
that can be used for reproducing the error somewhere for downloading. If
your images are not free, it can be any other image if you just fool it to
contain similar georeferencing info.

-Jukka Rahkonen-


From zoltans at geograph.co.za  Mon Mar 16 04:04:46 2015
From: zoltans at geograph.co.za (Zoltan Szecsei)
Date: Mon, 16 Mar 2015 13:04:46 +0200
Subject: [gdal-dev] gdal_translate with -projwin
In-Reply-To: <loom.20150316T104929-807@post.gmane.org>
References: <5505C4DE.2090505@geograph.co.za>	<1426491726.5506894ed49fe@imp.free.fr>
	<loom.20150316T104929-807@post.gmane.org>
Message-ID: <5506B8CE.7010906@geograph.co.za>



On 03/16/2015 11:56 AM, Jukka Rahkonen wrote:
>
> Hi,
>
> Keep is as simple as possible. Make a test with one original tiff. Once you
> can clip an area out of that with -prjwin, create a VRT file from that one
> image only. If clipping is still successful, add more images into VRT.
> Continue until the failure happens again. Think what happens then. Perhaps
> it is a faulty image or then there is something wrong in GDAL.
>
> But if clipping fails with one single image in VRT, put some small sample
> that can be used for reproducing the error somewhere for downloading. If
> your images are not free, it can be any other image if you just fool it to
> contain similar georeferencing info.
>
> -Jukka Rahkonen-
>
>


I did try (partly) this approach, but my clip area covers a couple of 
the orthos in the VRT - but a clue I got was that even by excluding -epo 
and -eco, I was still getting "partially outside" errors, and no 
resulting TIFF file.

But in keeping with your KISS, I will adjust my clip area to be inside 
one of the orthos, and then build up/expand clip regions from there.

Thanks for the thoughts - I'll report back later.
Incidentally the 1st few lines of the vrt has:

    <VRTDataset rasterXSize="341744" rasterYSize="512321">
       <SRS>PROJCS[&quot;Projection: Transverse Mercator; Datum: WGS84;
    Ellipsoid: WGS84&quot;,GEOGCS[&quot;WGS
    84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS
    84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0],UNIT[&quot;degree&quot;,0.0174532925199433],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]],PROJECTION[&quot;Transverse_Mercator&quot;],PARAMETER[&quot;latitude_of_origin&quot;,0],PARAMETER[&quot;central_meridian&quot;,31],PARAMETER[&quot;scale_factor&quot;,1],PARAMETER[&quot;false_easting&quot;,0],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]]]</SRS>
       <GeoTransform> -9.7641549180324524e+04, 5.0000000000000000e-01, 
    0.0000000000000000e+00, -3.2091193239263385e+06, 
    0.0000000000000000e+00, -5.0000000000000000e-01</GeoTransform>
       <VRTRasterBand dataType="Byte" band="1">
    <NoDataValue>0.00000000000000E+00</NoDataValue>
         <ColorInterp>Red</ColorInterp>
         <SimpleSource>



Regards,
Zoltan

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150316/9c30048a/attachment-0001.html>

From zoltans at geograph.co.za  Mon Mar 16 04:29:42 2015
From: zoltans at geograph.co.za (Zoltan Szecsei)
Date: Mon, 16 Mar 2015 13:29:42 +0200
Subject: [gdal-dev] gdal_translate with -projwin  SOLVED
In-Reply-To: <5506B8CE.7010906@geograph.co.za>
References: <5505C4DE.2090505@geograph.co.za>	<1426491726.5506894ed49fe@imp.free.fr>	<loom.20150316T104929-807@post.gmane.org>
	<5506B8CE.7010906@geograph.co.za>
Message-ID: <5506BEA6.5050802@geograph.co.za>

OK, it was simple.
I did not have permission to write to the output directory !!!

I only found this out when I tried to cp the orthos to that directory so 
that I could build up a smaller vrt and not have to use long pathnames.

Whilst at the end of the day the problem was my side, it would be nice 
if the gdal utilities didn't just silently do nothing.
Is this something worth filing as an improvement request - or have the 
developers on this list taken note?

Thanks to all who chipped in.

Kind regards,
Zoltan




On 03/16/2015 01:04 PM, Zoltan Szecsei wrote:
>
>
> On 03/16/2015 11:56 AM, Jukka Rahkonen wrote:
>>
>> Hi,
>>
>> Keep is as simple as possible. Make a test with one original tiff. Once you
>> can clip an area out of that with -prjwin, create a VRT file from that one
>> image only. If clipping is still successful, add more images into VRT.
>> Continue until the failure happens again. Think what happens then. Perhaps
>> it is a faulty image or then there is something wrong in GDAL.
>>
>> But if clipping fails with one single image in VRT, put some small sample
>> that can be used for reproducing the error somewhere for downloading. If
>> your images are not free, it can be any other image if you just fool it to
>> contain similar georeferencing info.
>>
>> -Jukka Rahkonen-
>>
>>
>
>
> I did try (partly) this approach, but my clip area covers a couple of 
> the orthos in the VRT - but a clue I got was that even by excluding 
> -epo and -eco, I was still getting "partially outside" errors, and no 
> resulting TIFF file.
>
> But in keeping with your KISS, I will adjust my clip area to be inside 
> one of the orthos, and then build up/expand clip regions from there.
>
> Thanks for the thoughts - I'll report back later.
> Incidentally the 1st few lines of the vrt has:
>
>     <VRTDataset rasterXSize="341744" rasterYSize="512321">
>       <SRS>PROJCS[&quot;Projection: Transverse Mercator; Datum: WGS84;
>     Ellipsoid: WGS84&quot;,GEOGCS[&quot;WGS
>     84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS
>     84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0],UNIT[&quot;degree&quot;,0.0174532925199433],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]],PROJECTION[&quot;Transverse_Mercator&quot;],PARAMETER[&quot;latitude_of_origin&quot;,0],PARAMETER[&quot;central_meridian&quot;,31],PARAMETER[&quot;scale_factor&quot;,1],PARAMETER[&quot;false_easting&quot;,0],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]]]</SRS>
>       <GeoTransform> -9.7641549180324524e+04, 5.0000000000000000e-01, 
>     0.0000000000000000e+00, -3.2091193239263385e+06, 
>     0.0000000000000000e+00, -5.0000000000000000e-01</GeoTransform>
>       <VRTRasterBand dataType="Byte" band="1">
>     <NoDataValue>0.00000000000000E+00</NoDataValue>
>         <ColorInterp>Red</ColorInterp>
>         <SimpleSource>
>
>
>
> Regards,
> Zoltan
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150316/2232fe26/attachment.html>

From even.rouault at spatialys.com  Mon Mar 16 09:06:32 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 16 Mar 2015 17:06:32 +0100
Subject: [gdal-dev] gdal_translate with -projwin  SOLVED
In-Reply-To: <5506BEA6.5050802@geograph.co.za>
References: <5505C4DE.2090505@geograph.co.za>
	<1426491726.5506894ed49fe@imp.free.fr>
	<loom.20150316T104929-807@post.gmane.org>
	<5506B8CE.7010906@geograph.co.za> <5506BEA6.5050802@geograph.co.za>
Message-ID: <1426521992.5506ff8802118@imp.free.fr>

Selon Zoltan Szecsei <zoltans at geograph.co.za>:

> OK, it was simple.
> I did not have permission to write to the output directory !!!

Ah, I imagined that it could have been a reason but didn't mentionned it because
I was convinced you would have gotten an explicit error message. In fact, this
was a trunk regression specific to the GTiff driver. Now fixed (and unit test
checked)

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From aakaruce at iitr.ac.in  Mon Mar 16 08:34:03 2015
From: aakaruce at iitr.ac.in (Aakarsh Agarwal)
Date: Mon, 16 Mar 2015 21:04:03 +0530
Subject: [gdal-dev] GSoC 2015
Message-ID: <73a0df597009.55074543@iitr.ac.in>

Hi,
I am Aakarsh Agawal, pursuing B.Tech from IIT Roorkee in India.


Few things which attract me to GDAL are-


1. C++ being the central language for GDAL. I have been coding in C++ from quite some time and I have enough experience and command over the same.


2. GDAL is a library for implementing some popular and useful algorithms through this project. I am quite familiar with such algorithms and I have already worked upon them, coded them in c++. I often solve algorithmic problems on SPOJ, CodeChef etc. which require use of graph algorithms in practice.



Thus, I want to contribute to your organisation and nothing can be better than going for one of your GSoC projects for this year.


I am very much interested to work on GDAL project " GDAL image stretch/filter utility". I am looking forward to the necessary guidelines from your side so that I can be fruitful in this matter.


Please provide me with necessary details and guidelines for the same.Looking forward, positively, to contributing to GDAL this summer.


Thanks and Regards
Aakarsh Agarwal
IIT Roorkee
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150316/ea66e9ed/attachment.html>

From zoltans at geograph.co.za  Mon Mar 16 09:39:51 2015
From: zoltans at geograph.co.za (Zoltan Szecsei)
Date: Mon, 16 Mar 2015 18:39:51 +0200
Subject: [gdal-dev] gdal_translate with -projwin  SOLVED
In-Reply-To: <1426521992.5506ff8802118@imp.free.fr>
References: <5505C4DE.2090505@geograph.co.za>
	<1426491726.5506894ed49fe@imp.free.fr>
	<loom.20150316T104929-807@post.gmane.org>
	<5506B8CE.7010906@geograph.co.za> <5506BEA6.5050802@geograph.co.za>
	<1426521992.5506ff8802118@imp.free.fr>
Message-ID: <55070757.2020602@geograph.co.za>



On 03/16/2015 06:06 PM, Even Rouault wrote:
> Selon Zoltan Szecsei <zoltans at geograph.co.za>:
>
>> OK, it was simple.
>> I did not have permission to write to the output directory !!!
> Ah, I imagined that it could have been a reason but didn't mentionned it because
> I was convinced you would have gotten an explicit error message. In fact, this
> was a trunk regression specific to the GTiff driver. Now fixed (and unit test
> checked)

Cool - thanks Even

>


From even.rouault at spatialys.com  Mon Mar 16 11:54:36 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 16 Mar 2015 19:54:36 +0100
Subject: [gdal-dev] External files for RPC in GeoTIFF
Message-ID: <1426532076.550726ec6a373@imp.free.fr>

Hi,

I'd be interested in people's feedback about which "sidecar"/external files for
GeoTIFF to store RPC (Rational Polynomial Coefficients) are the most popular
those days and how well they are supported by the various remote sensing
software
packages. Besides reading/writing the TIFF RPC tag
(http://geotiff.maptools.org/rpc_prop.html), GDAL can read/write the .RPB format
as found in Digital Globe products, as well as read the _RPC.TXT format a found
in GeoEye products. This support dates back to some time ago, so I'm wondering
if there have been change in that area.

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From stefan.ziegler.de at gmail.com  Mon Mar 16 12:06:10 2015
From: stefan.ziegler.de at gmail.com (Stefan Ziegler)
Date: Mon, 16 Mar 2015 20:06:10 +0100
Subject: [gdal-dev] Extract Linestrings from GeometryCollections with ogr2gor
Message-ID: <CAJvo+18T19SKTyw2Zr5bP-GeVJTD_QKF_YtB82YSqrJYjzwDvQ@mail.gmail.com>

Hi

I have some contour lines which I clip with ogr2ogr's -clipsrc options. As
a result and in very rare cases I get some GeometryCollections which cannot
be stored in a  shapefile.

So I'm clipping to a GeoPackage and tried to extract the LinesStrings from
the GeometryCollections with the following command:

ogr2ogr -dialect INDIRECT_SQLITE -sql 'SELECT ID, elev,
(ST_Dump(geom)).geom as geom FROM linestring WHERE geometrytype =
\'LINESTRING'\' clipped_dumped.shp clipped.gpkg

ST_Dump seems to be unknown (as SQlite does not support arrays I guess) so
is ST_CollectionExtract(geom,2).

Is there a way to extract LineStrings from GeometryCollections. Probably
already avoiding them when clipping the original geometry?

best regards
Stefan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150316/b74ba6ae/attachment.html>

From michael.katz at noaa.gov  Mon Mar 16 12:40:50 2015
From: michael.katz at noaa.gov (Michael Katz - NOAA Affiliate)
Date: Mon, 16 Mar 2015 12:40:50 -0700
Subject: [gdal-dev] poBand->ComputeStatistics() returning different values
 than ArcMap for .tif file
Message-ID: <CALx5KqYf7KPXFy8ZDw=7kmCn_TTgwHYs0Xb5V2BwgZbbCGOr1A@mail.gmail.com>

I have a 2GB .tif file. It is 16 bit, and I know the values range from 0 to
2047 (i.e., 11 bits are used in the values). It reports three bands, RGB,
and when I use poBand->ComputeStatistics() on each band I get:

red band (first): min: 0, max: 1953
green band (second): min: 0, max: 2047
blue band (third): min: 0, max: 1991

But when I open the same file in ArcMap, get the Layer Properties, look at
the Symbology tab, set the stretch type to Minimum-Maximum, uncheck Apply
Gamma Stretch, and click the Histograms button, it shows the following
values:

Red: min: 60, max: 1547
Green: min: 230, max: 2047
Blue: min: 208, max: 1326

It is behaving as if (perhaps) ArcMap is throwing out a certain percentage
of outlier low and high values when reporting the statistics. But I have
Minimum-Maximum set as the stretch type, not Percentage Clip, and in any
event, my understanding is that the chosen stretch type should not affect
the statistics shown on the Histograms dialog box; that those values are
the raw values in the file.

Do you have any idea why GDAL would be reporting different min/max values
for the bands? Any ideas on how I can debug it?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150316/8cd5e17e/attachment.html>

From even.rouault at spatialys.com  Mon Mar 16 13:53:02 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 16 Mar 2015 21:53:02 +0100
Subject: [gdal-dev] poBand->ComputeStatistics() returning different
	values than ArcMap for .tif file
In-Reply-To: <CALx5KqYf7KPXFy8ZDw=7kmCn_TTgwHYs0Xb5V2BwgZbbCGOr1A@mail.gmail.com>
References: <CALx5KqYf7KPXFy8ZDw=7kmCn_TTgwHYs0Xb5V2BwgZbbCGOr1A@mail.gmail.com>
Message-ID: <1426539182.550742aed0fa4@imp.free.fr>

Selon Michael Katz - NOAA Affiliate <michael.katz at noaa.gov>:

> I have a 2GB .tif file. It is 16 bit, and I know the values range from 0 to
> 2047 (i.e., 11 bits are used in the values). It reports three bands, RGB,
> and when I use poBand->ComputeStatistics() on each band I get:
>
> red band (first): min: 0, max: 1953
> green band (second): min: 0, max: 2047
> blue band (third): min: 0, max: 1991
>
> But when I open the same file in ArcMap, get the Layer Properties, look at
> the Symbology tab, set the stretch type to Minimum-Maximum, uncheck Apply
> Gamma Stretch, and click the Histograms button, it shows the following
> values:
>
> Red: min: 60, max: 1547
> Green: min: 230, max: 2047
> Blue: min: 208, max: 1326
>
> It is behaving as if (perhaps) ArcMap is throwing out a certain percentage
> of outlier low and high values when reporting the statistics. But I have
> Minimum-Maximum set as the stretch type, not Percentage Clip, and in any
> event, my understanding is that the chosen stretch type should not affect
> the statistics shown on the Histograms dialog box; that those values are
> the raw values in the file.
>
> Do you have any idea why GDAL would be reporting different min/max values
> for the bands? Any ideas on how I can debug it?

Michael,

No idea what ArcGIS can do in that area, but GDAL should compute its statistics
based on all pixels. Unless the dataset has overviews, in which case if you
compute the statistics in approximate mode, it can use overviews and thus report
different values than the full resolution image.
You could grab all the pixel values by yourself with RasterIO() API and do the
min/max to check, but I've no reason to believe GDAL stats are broken.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From p.halls at york.ac.uk  Mon Mar 16 14:20:28 2015
From: p.halls at york.ac.uk (Peter Halls)
Date: Mon, 16 Mar 2015 21:20:28 +0000
Subject: [gdal-dev] poBand->ComputeStatistics() returning different
 values than ArcMap for .tif file
In-Reply-To: <CALx5KqYf7KPXFy8ZDw=7kmCn_TTgwHYs0Xb5V2BwgZbbCGOr1A@mail.gmail.com>
References: <CALx5KqYf7KPXFy8ZDw=7kmCn_TTgwHYs0Xb5V2BwgZbbCGOr1A@mail.gmail.com>
Message-ID: <CADEnnOOuPZYBvUdqNcDpTZSZAYL=vOGrje_QZbtO-H2tv5S8jg@mail.gmail.com>

Michael, Evan,

      ArcGIS is dpocumented as not reporting values that do not occur.
In this instance, the minimum values are (R) 60  (G) 230  and (B) 208.
None of these sequences begins at zero, an important factor if
computing the range of values.  I think this behaviour goes back to
the earliest days of raster support (ArcInfo Grid).

      An interesting question is, with these values, why GDAL is
reporting zero for the minimum values.  Unfortunately, I am currently
out of office whils the medics resolve a thyroid problem for me and do
not have a copy of GDAL source to hand.  Maybe there are compromises
in haviig a non-zero minimum value, but negative to positive value
ranges should be supported.

Best wishes,

Peter

On 16 March 2015 at 19:40, Michael Katz - NOAA Affiliate
<michael.katz at noaa.gov> wrote:
> I have a 2GB .tif file. It is 16 bit, and I know the values range from 0 to
> 2047 (i.e., 11 bits are used in the values). It reports three bands, RGB,
> and when I use poBand->ComputeStatistics() on each band I get:
>
> red band (first): min: 0, max: 1953
> green band (second): min: 0, max: 2047
> blue band (third): min: 0, max: 1991
>
> But when I open the same file in ArcMap, get the Layer Properties, look at
> the Symbology tab, set the stretch type to Minimum-Maximum, uncheck Apply
> Gamma Stretch, and click the Histograms button, it shows the following
> values:
>
> Red: min: 60, max: 1547
> Green: min: 230, max: 2047
> Blue: min: 208, max: 1326
>
> It is behaving as if (perhaps) ArcMap is throwing out a certain percentage
> of outlier low and high values when reporting the statistics. But I have
> Minimum-Maximum set as the stretch type, not Percentage Clip, and in any
> event, my understanding is that the chosen stretch type should not affect
> the statistics shown on the Histograms dialog box; that those values are the
> raw values in the file.
>
> Do you have any idea why GDAL would be reporting different min/max values
> for the bands? Any ideas on how I can debug it?
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
----------------------------------------------------------------------------------------------------------------
Peter J Halls, PhD Student, Post-war Reconstruction and Development Unit (PRDU)
                     Department of Politics, University of York

Snail mail: PRDU, Derwent College, University of York,
                Heslington, York YO10 5DD
This message has the status of a private and personal communication
----------------------------------------------------------------------------------------------------------------

From even.rouault at spatialys.com  Mon Mar 16 14:28:03 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 16 Mar 2015 22:28:03 +0100
Subject: [gdal-dev] Extract Linestrings from GeometryCollections with
	ogr2gor
In-Reply-To: <CAJvo+18T19SKTyw2Zr5bP-GeVJTD_QKF_YtB82YSqrJYjzwDvQ@mail.gmail.com>
References: <CAJvo+18T19SKTyw2Zr5bP-GeVJTD_QKF_YtB82YSqrJYjzwDvQ@mail.gmail.com>
Message-ID: <1426541283.55074ae3b58b3@imp.free.fr>

Stefan,

you could try the -explodecollections of ogr2ogr.

Even

> Hi
>
> I have some contour lines which I clip with ogr2ogr's -clipsrc options. As
> a result and in very rare cases I get some GeometryCollections which cannot
> be stored in a  shapefile.
>
> So I'm clipping to a GeoPackage and tried to extract the LinesStrings from
> the GeometryCollections with the following command:
>
> ogr2ogr -dialect INDIRECT_SQLITE -sql 'SELECT ID, elev,
> (ST_Dump(geom)).geom as geom FROM linestring WHERE geometrytype =
> \'LINESTRING'\' clipped_dumped.shp clipped.gpkg
>
> ST_Dump seems to be unknown (as SQlite does not support arrays I guess) so
> is ST_CollectionExtract(geom,2).
>
> Is there a way to extract LineStrings from GeometryCollections. Probably
> already avoiding them when clipping the original geometry?
>
> best regards
> Stefan
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Mon Mar 16 14:34:22 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Mon, 16 Mar 2015 21:34:22 +0000 (UTC)
Subject: [gdal-dev] Extract Linestrings from GeometryCollections with
	ogr2gor
References: <CAJvo+18T19SKTyw2Zr5bP-GeVJTD_QKF_YtB82YSqrJYjzwDvQ@mail.gmail.com>
Message-ID: <loom.20150316T221704-747@post.gmane.org>

Stefan Ziegler <stefan.ziegler.de <at> gmail.com> writes:

 
> Hi
> I have some contour lines which I clip with ogr2ogr's -clipsrc options. As
a result and in very rare cases I get some GeometryCollections which cannot
be stored in a? shapefile. 
> So I'm clipping to a GeoPackage and tried to extract the LinesStrings from
the GeometryCollections with the following command:ogr2ogr -dialect
INDIRECT_SQLITE -sql 'SELECT ID, elev, (ST_Dump(geom)).geom as geom FROM
linestring WHERE geometrytype = \'LINESTRING'\' clipped_dumped.shp clipped.gpkg
> ST_Dump seems to be unknown (as SQlite does not support arrays I guess) so
is ST_CollectionExtract(geom,2). 
> Is there a way to extract LineStrings from GeometryCollections. Probably
already avoiding them when clipping the original geometry?
> best regards
> Stefan

Hi,

There is no need to guess what functions are supported by Spatialite SQL, it
is documented in
https://www.gaia-gis.it/gaia-sins/xmlBlob/spatialite-sql-latest.html.

You are right with the arrays but Spatialite does have some tools for
splitting collections into elementary geometries. With the standard
functions you could probably do something useful with NumGeometries and
GeometryN by finding out the total number or geometries and then selecting
them one by one.

There are also special tools which can by used with spatialite-cli and
spatialite-gui
https://groups.google.com/forum/#!topic/spatialite-users/04YoENWokuA. An
then there is this brand new creative:

https://www.gaia-gis.it/fossil/libspatialite/wiki?name=VirtualElementary

-Jukka Rahkonen-

From jukka.rahkonen at maanmittauslaitos.fi  Mon Mar 16 14:39:08 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Mon, 16 Mar 2015 21:39:08 +0000 (UTC)
Subject: [gdal-dev]
	=?utf-8?q?Extract_Linestrings_from_GeometryCollections?=
	=?utf-8?q?_with=09ogr2gor?=
References: <CAJvo+18T19SKTyw2Zr5bP-GeVJTD_QKF_YtB82YSqrJYjzwDvQ@mail.gmail.com>
	<1426541283.55074ae3b58b3@imp.free.fr>
Message-ID: <loom.20150316T223657-872@post.gmane.org>

Even Rouault <even.rouault <at> spatialys.com> writes:

> 
> Stefan,
> 
> you could try the -explodecollections of ogr2ogr.
> 
> Even

Right, I did not remember but there is a bit similar case about separating
elementary geometries from collections in gis.stackexchange
http://gis.stackexchange.com/questions/137408/ogr2ogr-unable-to-open-kml-datasource

-Jukka Rahkonen-


From michael.katz at noaa.gov  Mon Mar 16 14:52:52 2015
From: michael.katz at noaa.gov (Michael Katz - NOAA Affiliate)
Date: Mon, 16 Mar 2015 14:52:52 -0700
Subject: [gdal-dev] poBand->ComputeStatistics() returning different
 values than ArcMap for .tif file
In-Reply-To: <550743cf.065bca0a.8259.ffff910d@mx.google.com>
References: <550743cf.065bca0a.8259.ffff910d@mx.google.com>
Message-ID: <CALx5KqZJ6kOkYV139N5PbtOTmmY5OVujCNC99s25uvQUf7yxtw@mail.gmail.com>

Trent, yes, this was key info.

When I open the Catalog panel in ArcMap and tell it to compute statistics
for the file, it comes back with the same statistics as GDAL gives. So that
part of the mystery is resolved.

What is confusing is that, for this particular image, whatever ArcMap is
doing to compute those quick statistics (the ones where, for instance, the
blue ranges from 208 to 1326 instead of the actual 0 to 1991), works out
well in terms of actually displaying the image. That is, if I map each
band's true value range into 0-255 for display, I get a picture that is
strongly tinted green. But if I use the quick ranges, that brings up the
red and blue (because their quick max is so much lower than the 2047) and
the picture ends up looking correct/realistic.

So, maybe this is just a coincidence, and in this particular case what
ArcMap happens to be doing for its quick statistics turns out to give about
the same effect as a (0.25%) percentage clip, which also gives a realistic
looking image.

What I would *like* is a quick way to find those reasonable percentage-clip
cutoffs. But for now I'll assume this was just a coincidence and I'll do a
scan of all the data to try to determine the (0.25%) percentage-clip
cutoffs as quickly as I can.


On Mon, Mar 16, 2015 at 1:57 PM, thare at usgs.gov <thare at usgs.gov> wrote:

> This might not matter in your case but in current versions of Arcmap it is
> common to only estimate the stats. I now always calculate stats per image
> prior to loading into Arcmap (in catalog).
>
> Let me know if that helps,
> Trent
>
> ----- Reply message -----
> From: "Michael Katz - NOAA Affiliate" <michael.katz at noaa.gov>
> To: "gdal-dev" <gdal-dev at lists.osgeo.org>
> Subject: [gdal-dev] poBand->ComputeStatistics() returning different values
> than ArcMap for .tif file
> Date: Mon, Mar 16, 2015 2:40 PM
>
> I have a 2GB .tif file. It is 16 bit, and I know the values range from 0
> to 2047 (i.e., 11 bits are used in the values). It reports three bands,
> RGB, and when I use poBand->ComputeStatistics() on each band I get:
>
> red band (first): min: 0, max: 1953
> green band (second): min: 0, max: 2047
> blue band (third): min: 0, max: 1991
>
> But when I open the same file in ArcMap, get the Layer Properties, look at
> the Symbology tab, set the stretch type to Minimum-Maximum, uncheck Apply
> Gamma Stretch, and click the Histograms button, it shows the following
> values:
>
> Red: min: 60, max: 1547
> Green: min: 230, max: 2047
> Blue: min: 208, max: 1326
>
> It is behaving as if (perhaps) ArcMap is throwing out a certain percentage
> of outlier low and high values when reporting the statistics. But I have
> Minimum-Maximum set as the stretch type, not Percentage Clip, and in any
> event, my understanding is that the chosen stretch type should not affect
> the statistics shown on the Histograms dialog box; that those values are
> the raw values in the file.
>
> Do you have any idea why GDAL would be reporting different min/max values
> for the bands? Any ideas on how I can debug it?
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150316/c3ea5d14/attachment-0001.html>

From PriceR at landcareresearch.co.nz  Mon Mar 16 21:40:25 2015
From: PriceR at landcareresearch.co.nz (Robbie Price)
Date: Tue, 17 Mar 2015 04:40:25 +0000
Subject: [gdal-dev] FW: trouble with netCDF in C#?  PLEASE REMOVE ISSUE
Message-ID: <F8C3C6DB66146D45BB0C091BEA01D9E11231FE6B@HERMES.landcare.ad.landcareresearch.co.nz>

Hi,

After much angst and wringing of hands I have resolved my problem - by looking in a totally different bit of my code to the area I though the error was occurring.

The best way to track these issues turned out to be using GC.Collect(0) "A Lot".  As soon as one stuffs up the GC will know about it.  Brilliant!!!!!!  (Just remember to comment them out when it is working)

Lesson 1:
I think my C# dynamic array definition and expecting the GDAL unmanaged code to automagically resize the array may be just a little optimistic.  I could not find a definitive statement on the size the array had to be so I got lazy and then forgot about it (this works inside Net just hunky dory).  I will have to find out the correct array size [maximum possible] and set it first:

double[] adblGeoTransform = new double[0];
dsNetCDF.GetGeoTransform(adblGeoTransform);
agcpNetCDF = dsNetCDF.GetGCPs();

whoops...


From: Robbie Price
Sent: Monday, 16 March 2015 2:57 p.m.
To: 'gdal-dev at lists.osgeo.org'
Subject: trouble with netCDF in C#?

I'm having trouble converting some netcdf (version 3) files to Kea files using the GDAL C# bindings.

The problem is some form of memory leak caused by the netCDF code (from what I can establish through various tests).

There are two issues:

1)       A memory leak in this call (which I noticed, but can work around as I am only dealing with a small number of subdatasets)

a.  dsNetCDF = OSGeo.GDAL.Gdal.Open(strNetCDF_DSN, OSGeo.GDAL.Access.GA_ReadOnly);

2)      A memory issue/leak pointer assignment causing a crash that I cannot trace the error reports as:

Managed Debugging Assistant 'FatalExecutionEngineError' has detected a problem in 'O:\Projects\KEA_ReadWrite\bin\x64\Debug\KEA_ReadWrite.vshost.exe'.
Additional Information: The runtime has encountered a fatal error. The address of the error was at 0xebc85654, on thread 0x16ec. The error code is 0xc0000005. This error may be a bug in the CLR or in the unsafe or non-verifiable portions of user code. Common sources of this bug include user marshaling errors for COM-interop or PInvoke, which may corrupt the stack.

The error is consistent in nature but happens inconsistently in the code (between 1800 and 4000 bands) - here from another run:
Managed Debugging Assistant 'FatalExecutionEngineError' has detected a problem in 'O:\Projects\KEA_ReadWrite\bin\x64\Debug\KEA_ReadWrite.vshost.exe'.
Additional Information: The runtime has encountered a fatal error. The address of the error was at 0xebc85654, on thread 0x199c. The error code is 0xc0000005. This error may be a bug in the CLR or in the unsafe or non-verifiable portions of user code. Common sources of this bug include user marshaling errors for COM-interop or PInvoke, which may corrupt the stack.

The error MAY be occurring more often only on lines handling string functions (?)

Version Details

Using MSVS 2010 (C#) and the following:

http://www.gisinternals.com/query.html?content=filelist&file=release-1600-x64-gdal-mapserver.zip

gdal-200-1600-x64-core.msi<http://download2.gisinternals.com/sdk/Download.aspx?file=release-1600-x64-gdal-mapserver/gdal-200-1600-x64-core.msi>

3/15/2015 4:13 AM

21556 kB

Generic installer for the GDAL core components



Basic scenario is converting from one file type to another but taking the meta info from the NetCDF and using as band name info in the Kea file.  Input files have between 365 and 8000 bands but not large spatially (260*243).

________________________________

Please consider the environment before printing this email
Warning: This electronic message together with any attachments is confidential. If you receive it in error: (i) you must not read, use, disclose, copy or retain it; (ii) please contact the sender immediately by reply email and then delete the emails.
The views expressed in this email may not be those of Landcare Research New Zealand Limited. http://www.landcareresearch.co.nz
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150317/4a540e3c/attachment.html>

From even.rouault at spatialys.com  Mon Mar 16 21:52:24 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 17 Mar 2015 05:52:24 +0100
Subject: [gdal-dev] FW: trouble with netCDF in C#?  PLEASE REMOVE ISSUE
In-Reply-To: <F8C3C6DB66146D45BB0C091BEA01D9E11231FE6B@HERMES.landcare.ad.landcareresearch.co.nz>
References: <F8C3C6DB66146D45BB0C091BEA01D9E11231FE6B@HERMES.landcare.ad.landcareresearch.co.nz>
Message-ID: <1426567944.5507b3089bb1f@imp.free.fr>

Selon Robbie Price <PriceR at landcareresearch.co.nz>:

> Hi,
>
> After much angst and wringing of hands I have resolved my problem - by
> looking in a totally different bit of my code to the area I though the error
> was occurring.
>
> The best way to track these issues turned out to be using GC.Collect(0) "A
> Lot".  As soon as one stuffs up the GC will know about it.  Brilliant!!!!!!
> (Just remember to comment them out when it is working)
>
> Lesson 1:
> I think my C# dynamic array definition and expecting the GDAL unmanaged code
> to automagically resize the array may be just a little optimistic.  I could
> not find a definitive statement on the size the array had to be so I got lazy
> and then forgot about it (this works inside Net just hunky dory).  I will
> have to find out the correct array size [maximum possible] and set it first:
>
> double[] adblGeoTransform = new double[0];
> dsNetCDF.GetGeoTransform(adblGeoTransform);
> agcpNetCDF = dsNetCDF.GetGCPs();
>
> whoops...
>

I'm not familiar with the C# bindings, but it is very likely t hatyou need to
set the array to 6 doubles, as it is its size in C/C++. See
http://gdal.org/gdal_tutorial.html

>
> From: Robbie Price
> Sent: Monday, 16 March 2015 2:57 p.m.
> To: 'gdal-dev at lists.osgeo.org'
> Subject: trouble with netCDF in C#?
>
> I'm having trouble converting some netcdf (version 3) files to Kea files
> using the GDAL C# bindings.
>
> The problem is some form of memory leak caused by the netCDF code (from what
> I can establish through various tests).
>
> There are two issues:
>
> 1)       A memory leak in this call (which I noticed, but can work around as
> I am only dealing with a small number of subdatasets)
>
> a.  dsNetCDF = OSGeo.GDAL.Gdal.Open(strNetCDF_DSN,
> OSGeo.GDAL.Access.GA_ReadOnly);
>
> 2)      A memory issue/leak pointer assignment causing a crash that I cannot
> trace the error reports as:
>
> Managed Debugging Assistant 'FatalExecutionEngineError' has detected a
> problem in
> 'O:\Projects\KEA_ReadWrite\bin\x64\Debug\KEA_ReadWrite.vshost.exe'.
> Additional Information: The runtime has encountered a fatal error. The
> address of the error was at 0xebc85654, on thread 0x16ec. The error code is
> 0xc0000005. This error may be a bug in the CLR or in the unsafe or
> non-verifiable portions of user code. Common sources of this bug include user
> marshaling errors for COM-interop or PInvoke, which may corrupt the stack.
>
> The error is consistent in nature but happens inconsistently in the code
> (between 1800 and 4000 bands) - here from another run:
> Managed Debugging Assistant 'FatalExecutionEngineError' has detected a
> problem in
> 'O:\Projects\KEA_ReadWrite\bin\x64\Debug\KEA_ReadWrite.vshost.exe'.
> Additional Information: The runtime has encountered a fatal error. The
> address of the error was at 0xebc85654, on thread 0x199c. The error code is
> 0xc0000005. This error may be a bug in the CLR or in the unsafe or
> non-verifiable portions of user code. Common sources of this bug include user
> marshaling errors for COM-interop or PInvoke, which may corrupt the stack.
>
> The error MAY be occurring more often only on lines handling string functions
> (?)
>
> Version Details
>
> Using MSVS 2010 (C#) and the following:
>
>
http://www.gisinternals.com/query.html?content=filelist&file=release-1600-x64-gdal-mapserver.zip
>
>
gdal-200-1600-x64-core.msi<http://download2.gisinternals.com/sdk/Download.aspx?file=release-1600-x64-gdal-mapserver/gdal-200-1600-x64-core.msi>
>
> 3/15/2015 4:13 AM
>
> 21556 kB
>
> Generic installer for the GDAL core components
>
>
>
> Basic scenario is converting from one file type to another but taking the
> meta info from the NetCDF and using as band name info in the Kea file.  Input
> files have between 365 and 8000 bands but not large spatially (260*243).
>
> ________________________________
>
> Please consider the environment before printing this email
> Warning: This electronic message together with any attachments is
> confidential. If you receive it in error: (i) you must not read, use,
> disclose, copy or retain it; (ii) please contact the sender immediately by
> reply email and then delete the emails.
> The views expressed in this email may not be those of Landcare Research New
> Zealand Limited. http://www.landcareresearch.co.nz
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From nik at nikosalexandris.net  Tue Mar 17 02:32:59 2015
From: nik at nikosalexandris.net (Nikos Alexandris)
Date: Tue, 17 Mar 2015 09:32:59 +0000
Subject: [gdal-dev] External files for RPC in GeoTIFF
In-Reply-To: <1426532076.550726ec6a373@imp.free.fr>
References: <1426532076.550726ec6a373@imp.free.fr>
Message-ID: <8c8b8e834f893615a87c752fa750ac45@nikosalexandris.net>

On 16.03.2015 18:54, Even Rouault wrote:
> Hi,
>
> I'd be interested in people's feedback about which "sidecar"/external 
> files for
> GeoTIFF to store RPC (Rational Polynomial Coefficients) are the most 
> popular
> those days and how well they are supported by the various remote 
> sensing
> software
> packages. Besides reading/writing the TIFF RPC tag
> (http://geotiff.maptools.org/rpc_prop.html), GDAL can read/write the 
> .RPB format
> as found in Digital Globe products, as well as read the _RPC.TXT 
> format a found
> in GeoEye products. This support dates back to some time ago, so I'm 
> wondering
> if there have been change in that area.

Not that I have much to offer in terms of support.  Some sort of a 
feedback though:  I have used, last year, many and different very high 
resolution products (QB2, IKONOS, WV2).  For all of them, GDAL worked 
nice in using the existing RPC metadata (packed inside a NITF  or  
stored inside RPB files) to warp images.

Nikos

From jukka.rahkonen at maanmittauslaitos.fi  Tue Mar 17 05:37:12 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Tue, 17 Mar 2015 12:37:12 +0000 (UTC)
Subject: [gdal-dev] Ogrtindex: schema consistency check too strict?
Message-ID: <loom.20150317T132440-67@post.gmane.org>

Hi,
Probably because of work done for 64 bit integer support ogrtindex in now
nagging that schemata of shapefiles with fields defined as Number(9.0) and
Number(10.0) do not match. The first is reported as Integer and the latter
as Integer64. However, that difference should not have any meaning for
ogrtindex utility or Mapserver that is using the index file.

For being able to create indexes for our data I have had to run orgtindex
with -accept_different_schemas option which is all right otherwise but it
accepts also all the meaningful differences which can make real harm for
Mapserver.

I think that Integer and Integer64 could be made to mean the same for
ogrtindex but I am not sure if it could have some consequences.

-Jukka Rahkonen-


From even.rouault at spatialys.com  Tue Mar 17 08:52:28 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 17 Mar 2015 16:52:28 +0100
Subject: [gdal-dev] Ogrtindex: schema consistency check too strict?
In-Reply-To: <loom.20150317T132440-67@post.gmane.org>
References: <loom.20150317T132440-67@post.gmane.org>
Message-ID: <1426607548.55084dbce7a55@imp.free.fr>

Jukka,

Accepting both Integer and Integer64 as the same could cause problems. For
example let's say you have a ogr tile index whose first dataset has a
"foo(Integer)" field and the second dataset is "foo(Integer64)". In
gml_types=auto mode, I believe that MapServer will use the schema of the first
dataset for the whole tiles, so you could have truncation of Integer64 values.

By the way, Integer64 bit support in MapServer is sitting in this pull request:
https://github.com/mapserver/mapserver/pull/5061

Even

> Hi,
> Probably because of work done for 64 bit integer support ogrtindex in now
> nagging that schemata of shapefiles with fields defined as Number(9.0) and
> Number(10.0) do not match. The first is reported as Integer and the latter
> as Integer64. However, that difference should not have any meaning for
> ogrtindex utility or Mapserver that is using the index file.
>
> For being able to create indexes for our data I have had to run orgtindex
> with -accept_different_schemas option which is all right otherwise but it
> accepts also all the meaningful differences which can make real harm for
> Mapserver.
>
> I think that Integer and Integer64 could be made to mean the same for
> ogrtindex but I am not sure if it could have some consequences.
>
> -Jukka Rahkonen-
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From Niels.vonFestenberg-Packisch.ext at rohde-schwarz.com  Tue Mar 17 08:46:24 2015
From: Niels.vonFestenberg-Packisch.ext at rohde-schwarz.com (Niels.vonFestenberg-Packisch.ext at rohde-schwarz.com)
Date: Tue, 17 Mar 2015 16:46:24 +0100
Subject: [gdal-dev] crashing debug-dll of proj4 and gdal with QT - not due
 to /MD(d) issue
Message-ID: <OF4886C081.9D437104-ONC1257E0B.0052E05F-C1257E0B.0056A596@rohde-schwarz.com>

Hi all

I have been trying hard to get a running debug version of the gdal- and 
proj4-dlls within a larger qt4.8 project. Everything runs smoothly in 
release mode, but in debug it always crashes at the first use of a 
proj4-function. I'm using VS2008, GDAL v1.11 and proj4 in v4.9 in on a 
win7 32bit project relying on Qt4.8 with QTCreator 3.3. 

All posts I found on that issue directed me to the choice of the C runtime 
dll when building the debug dlls (i.e. MSVCR90.dll vs. MSVCR90D.dll). 
However, I've now tried out a whole bunch of compiler flag combinations in 
both nmake.opt files (-MD, -MDd for the CRT choice, and also -Zi, -Od, 
-Ehsc ...), static and dynamic linking of the libs, also dependency walker 
to double check which dlls really are in use, but the error didn't change 
at all (nor it disappeared of course). 

I'm quite sure to have copied the compiler options of all other libs in 
use. Particularly, the crash always happens at the same code line as 
mentioned above. 

So anybody here has an idea how one could solve this? If you need further 
information on the build context, I'll be happy to supply it. 

Thank you very much in advance

Regards
Niels



----
Im Auftrag von
Rohde & Schwarz GmbH & Co. KG

Postfach 80 14 69   ?   81614 M?nchen
M?hldorfstra?e 15   ?   81671 M?nchen
Telefon:        (089) 4129-16563
Mail: Niels.vonFestenberg-Packisch.ext at rohde-schwarz.com
Internet: www.rohde-schwarz.com"
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150317/143b19df/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Tue Mar 17 09:16:21 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Tue, 17 Mar 2015 16:16:21 +0000
Subject: [gdal-dev] Ogrtindex: schema consistency check too strict?
Message-ID: <571a305876424455bc77125e8f499ac3@C119S212VM022.msvyvi.vaha.local>

Hi,

I created ogrtileindex with -accept_different_schemas option and at least I can render WMS maps with Mapserver 6.4 with it. I need those integer attributes for classification but not for WFS at least by now.

I fear that there is no GDAL tool that could unify the data types by lifting Number(9.0) into Number(10.0) in the dfb headers of my shapefiles. Rewriting everything into common schema could be on option even it would take some time because this data set is about 600 GB. But how could I define such a  common output schema?
 
-Jukka Rahkonen-

-----Alkuper?inen viesti-----
L?hett?j?: Even Rouault [mailto:even.rouault at spatialys.com] 
L?hetetty: 17. maaliskuuta 2015 17:52
Vastaanottaja: Rahkonen Jukka (MML)
Kopio: gdal-dev at lists.osgeo.org
Aihe: Re: [gdal-dev] Ogrtindex: schema consistency check too strict?

Jukka,

Accepting both Integer and Integer64 as the same could cause problems. For example let's say you have a ogr tile index whose first dataset has a "foo(Integer)" field and the second dataset is "foo(Integer64)". In gml_types=auto mode, I believe that MapServer will use the schema of the first dataset for the whole tiles, so you could have truncation of Integer64 values.

By the way, Integer64 bit support in MapServer is sitting in this pull request:
https://github.com/mapserver/mapserver/pull/5061

Even

> Hi,
> Probably because of work done for 64 bit integer support ogrtindex in 
> now nagging that schemata of shapefiles with fields defined as 
> Number(9.0) and
> Number(10.0) do not match. The first is reported as Integer and the 
> latter as Integer64. However, that difference should not have any 
> meaning for ogrtindex utility or Mapserver that is using the index file.
>
> For being able to create indexes for our data I have had to run 
> orgtindex with -accept_different_schemas option which is all right 
> otherwise but it accepts also all the meaningful differences which can 
> make real harm for Mapserver.
>
> I think that Integer and Integer64 could be made to mean the same for 
> ogrtindex but I am not sure if it could have some consequences.
>
> -Jukka Rahkonen-
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


--
Spatialys - Geospatial professional services http://www.spatialys.com

From even.rouault at spatialys.com  Tue Mar 17 09:35:13 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 17 Mar 2015 17:35:13 +0100
Subject: [gdal-dev] Ogrtindex: schema consistency check too strict?
In-Reply-To: <571a305876424455bc77125e8f499ac3@C119S212VM022.msvyvi.vaha.local>
References: <571a305876424455bc77125e8f499ac3@C119S212VM022.msvyvi.vaha.local>
Message-ID: <1426610113.550857c19abef@imp.free.fr>

Selon "Rahkonen Jukka (MML)" <jukka.rahkonen at maanmittauslaitos.fi>:

> Hi,
>
> I created ogrtileindex with -accept_different_schemas option and at least I
> can render WMS maps with Mapserver 6.4 with it. I need those integer
> attributes for classification but not for WFS at least by now.
>
> I fear that there is no GDAL tool that could unify the data types by lifting
> Number(9.0) into Number(10.0) in the dfb headers of my shapefiles.

Not just the headers, the records also need to be extended. Shapefiles support
the AlterFieldDefn() API, so you could issue a SQL like "ALTER TABLE mytable
ALTER COLUMN mycol TYPE bigint(10)", but as I'm writing that I'm not sure that
the code to support that promotion has yet been written.

> Rewriting
> everything into common schema could be on option even it would take some time
> because this data set is about 600 GB. But how could I define such a  common
> output schema?

If the data in the Number(10.0) doesn't exceed 2 billion, then you can use the
-accept_different_schemas trick as the data will fit on 32 bit integer.
Otherwise you could wrap the data into OGR VRT

>
> -Jukka Rahkonen-
>
> -----Alkuper?inen viesti-----
> L?hett?j?: Even Rouault [mailto:even.rouault at spatialys.com]
> L?hetetty: 17. maaliskuuta 2015 17:52
> Vastaanottaja: Rahkonen Jukka (MML)
> Kopio: gdal-dev at lists.osgeo.org
> Aihe: Re: [gdal-dev] Ogrtindex: schema consistency check too strict?
>
> Jukka,
>
> Accepting both Integer and Integer64 as the same could cause problems. For
> example let's say you have a ogr tile index whose first dataset has a
> "foo(Integer)" field and the second dataset is "foo(Integer64)". In
> gml_types=auto mode, I believe that MapServer will use the schema of the
> first dataset for the whole tiles, so you could have truncation of Integer64
> values.
>
> By the way, Integer64 bit support in MapServer is sitting in this pull
> request:
> https://github.com/mapserver/mapserver/pull/5061
>
> Even
>
> > Hi,
> > Probably because of work done for 64 bit integer support ogrtindex in
> > now nagging that schemata of shapefiles with fields defined as
> > Number(9.0) and
> > Number(10.0) do not match. The first is reported as Integer and the
> > latter as Integer64. However, that difference should not have any
> > meaning for ogrtindex utility or Mapserver that is using the index file.
> >
> > For being able to create indexes for our data I have had to run
> > orgtindex with -accept_different_schemas option which is all right
> > otherwise but it accepts also all the meaningful differences which can
> > make real harm for Mapserver.
> >
> > I think that Integer and Integer64 could be made to mean the same for
> > ogrtindex but I am not sure if it could have some consequences.
> >
> > -Jukka Rahkonen-
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >
>
>
> --
> Spatialys - Geospatial professional services http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From stefan.ziegler.de at gmail.com  Tue Mar 17 12:40:50 2015
From: stefan.ziegler.de at gmail.com (Stefan Ziegler)
Date: Tue, 17 Mar 2015 20:40:50 +0100
Subject: [gdal-dev] Extract Linestrings from GeometryCollections with
	ogr2gor
In-Reply-To: <loom.20150316T223657-872@post.gmane.org>
References: <CAJvo+18T19SKTyw2Zr5bP-GeVJTD_QKF_YtB82YSqrJYjzwDvQ@mail.gmail.com>
	<1426541283.55074ae3b58b3@imp.free.fr>
	<loom.20150316T223657-872@post.gmane.org>
Message-ID: <CAJvo+1-YSy2pkqb_yMPDvOWf032otR9q0uRCcN3RUSs1oDb3Gw@mail.gmail.com>

Thank you guys.

I used -explodecollections:

1) SHP -> GPKG
2) Clip contour lines in GPKG (this produces geometrycollections) -> GPKG
3) GPKG -> GPKG (with -explodecollections)
4) GPKG -> SHP (-nlt LINESTRING25 -skipfailures)

At the moment I have to use GDAL 1.11. With >= 2.0 there are for sure more
elegant ways (with -dialect INDIRECT_SQLITE option).

regards
Stefan

On Mon, Mar 16, 2015 at 10:39 PM, Jukka Rahkonen <
jukka.rahkonen at maanmittauslaitos.fi> wrote:

> Even Rouault <even.rouault <at> spatialys.com> writes:
>
> >
> > Stefan,
> >
> > you could try the -explodecollections of ogr2ogr.
> >
> > Even
>
> Right, I did not remember but there is a bit similar case about separating
> elementary geometries from collections in gis.stackexchange
>
> http://gis.stackexchange.com/questions/137408/ogr2ogr-unable-to-open-kml-datasource
>
> -Jukka Rahkonen-
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150317/724a85df/attachment.html>

From armin.burger at gmx.net  Tue Mar 17 12:48:11 2015
From: armin.burger at gmx.net (Armin Burger)
Date: Tue, 17 Mar 2015 20:48:11 +0100
Subject: [gdal-dev] OpenFileGDB, feature classes in feature dataset
In-Reply-To: <1426388937.5504f7c920a12@imp.free.fr>
References: <54FE2C01.80806@gmx.net> <1425966492.54fe859c1a13a@imp.free.fr>
	<550445F5.2030004@gmx.net> <1426388937.5504f7c920a12@imp.free.fr>
Message-ID: <550884FB.9080405@gmx.net>

Hi Even

Thanks a lot again! I added the fix to the current 1.11.2 version and 
afterwards everything was fine, all layers in the FGDB v9 were found.

Cheers
Armin


On 03/15/2015 04:08 AM, Even Rouault wrote:
> Armin,
>
> I've committed a fix in http://trac.osgeo.org/gdal/ticket/5875 that should
> hopefully fix your issue. There was a problem with the presence of non spatial
> tables that could cause later tables not to be listed. This wasn't specifically
> related to feature classes.
>
> Even
>
>> Hi Even
>>
>> thanks for the reply!
>>
>> The FGDB dataset where I discovered that has unfortunately some
>> commercial IPR restrictions, so I cannot share it (and it in addition
>> has some 800 MB...). I will try to create a test FGDB with a similar
>> internal structure, I have to check if I can create an FGDB v9 format
>> with recent ArcGIS versions.
>>
>> Armin
>>
>>
>> On 03/10/2015 06:48 AM, Even Rouault wrote:
>>> Selon Armin Burger <armin.burger at gmx.net>:
>>>
>>>> Dear all
>>>>
>>>> I have a question regarding the OpenFileGDB driver in 1.11.2 release. It
>>>> now lists also non-spatial tables as layers of an FGDB (as mentioned in
>>>> the changelog). But it seems to not list any more layers that are
>>>> "feature classes" under a parent "feature dataset" (that's how the
>>>> relation is displayed in ArcGIS). This is at least the case for FGDB's
>>>> in older v9 format. In GDAL version 1.11.0 these feature classes were
>>>> still listed as layers.
>>>>
>>>> Is this a bug or an intended behavior?
>>>>
>>>
>>> Looks like an unfortunate side effect. could you open a ticket and attach
>> such a
>>> GDB or provide a link to it ?
>>>
>>>
>>>> Best regards
>>>> Armin
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev at lists.osgeo.org
>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>
>>>
>>>
>>
>
>

From dan at rekt.io  Tue Mar 17 13:32:30 2015
From: dan at rekt.io (Daniel Evans)
Date: Tue, 17 Mar 2015 20:32:30 +0000
Subject: [gdal-dev] Add source no-data masking to proximity computation
Message-ID: <CAPnM4evMk820vTKtdOP=5CXk6C8HjXGix3qFevvn-P=+oUq+5g@mail.gmail.com>

Hello,

I recently submitted a pull request against GDAL that adds an option that
causes GDALComputeProximity to take into account areas of no data within
the input raster and updates gdal_proximity.py with a -use_nodata flag.
This pull request is here https://github.com/OSGeo/gdal/pull/49

Is this likely to be accepted? It saves a processing step to re-add no data
areas when working with certain tools. Do any changes need to be made
elsewhere?

Thanks,
Daniel.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150317/7753b50f/attachment.html>

From xcr33d at gmail.com  Tue Mar 17 17:43:25 2015
From: xcr33d at gmail.com (Edson Ticona)
Date: Tue, 17 Mar 2015 19:43:25 -0500
Subject: [gdal-dev] [GSOC] Support for m coordinates in OGRGeometries
Message-ID: <CALaeiivE8PSJx+pJG7GWHzrdJcCKnkYukuO9mcueORX76E=hMg@mail.gmail.com>

Hi

I was looking for the ideas list on the site and found this one
interesting: "Adding support for "M" dimension in OGR Geometries" but
it's from 2014. Is it still relevant for the project? I searched on
the code and it isn't implemented.
For example, the class OGRGeometry needs the methods isMeasured,
LocateAlong and LocateBetween according to the definition on the OGC
simple standard. I couldn't find an ISO standard talking about M
coordinates. Which one do you refer on the page?
What do you think? Some feedback would be helpful.

Regards
Edson

From even.rouault at spatialys.com  Tue Mar 17 18:04:21 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 18 Mar 2015 02:04:21 +0100
Subject: [gdal-dev] [GSOC] Support for m coordinates in OGRGeometries
In-Reply-To: <CALaeiivE8PSJx+pJG7GWHzrdJcCKnkYukuO9mcueORX76E=hMg@mail.gmail.com>
References: <CALaeiivE8PSJx+pJG7GWHzrdJcCKnkYukuO9mcueORX76E=hMg@mail.gmail.com>
Message-ID: <1426640661.5508cf152e0ab@imp.free.fr>

Selon Edson Ticona <xcr33d at gmail.com>:

> Hi
>
> I was looking for the ideas list on the site and found this one
> interesting: "Adding support for "M" dimension in OGR Geometries" but
> it's from 2014. Is it still relevant for the project? I searched on
> the code and it isn't implemented.
> For example, the class OGRGeometry needs the methods isMeasured,
> LocateAlong and LocateBetween according to the definition on the OGC
> simple standard. I couldn't find an ISO standard talking about M
> coordinates. Which one do you refer on the page?
> What do you think? Some feedback would be helpful.

Edson,

Yes it is still relevant. Perhaps SQL/MM Part 3 mentions it ? I didn't check.
You'll find the link to a draft doc on
http://trac.osgeo.org/gdal/wiki/rfc49_curve_geometries
What has been done in PostGIS might also be interested looking into.
M only might be a bit light for a whole SOC, so adding support for
POLYHEDRALSURFACE and TIN might also been interesting for completness (and full
PostGIS interoperability).

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From dmorissette at mapgears.com  Tue Mar 17 18:40:27 2015
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Tue, 17 Mar 2015 21:40:27 -0400
Subject: [gdal-dev] [GSOC] Support for m coordinates in OGRGeometries
In-Reply-To: <1426640661.5508cf152e0ab@imp.free.fr>
References: <CALaeiivE8PSJx+pJG7GWHzrdJcCKnkYukuO9mcueORX76E=hMg@mail.gmail.com>
	<1426640661.5508cf152e0ab@imp.free.fr>
Message-ID: <5508D78B.6020902@mapgears.com>

FWIW I think support for M would be a very welcome addition. An 
immediate use I'd see for it would be support for time on GPS tracks in 
GPX files.

Note that if supporting the M dimension doesn't seem enough for a SoC 
project, making sure that all formats that support M (or as many as 
possible) are upgraded to properly implement it may very well fill the 
rest of the summer.

My 0.02$

Daniel


On 2015-03-17 9:04 PM, Even Rouault wrote:
> Selon Edson Ticona <xcr33d at gmail.com>:
>
>> Hi
>>
>> I was looking for the ideas list on the site and found this one
>> interesting: "Adding support for "M" dimension in OGR Geometries" but
>> it's from 2014. Is it still relevant for the project? I searched on
>> the code and it isn't implemented.
>> For example, the class OGRGeometry needs the methods isMeasured,
>> LocateAlong and LocateBetween according to the definition on the OGC
>> simple standard. I couldn't find an ISO standard talking about M
>> coordinates. Which one do you refer on the page?
>> What do you think? Some feedback would be helpful.
>
> Edson,
>
> Yes it is still relevant. Perhaps SQL/MM Part 3 mentions it ? I didn't check.
> You'll find the link to a draft doc on
> http://trac.osgeo.org/gdal/wiki/rfc49_curve_geometries
> What has been done in PostGIS might also be interested looking into.
> M only might be a bit light for a whole SOC, so adding support for
> POLYHEDRALSURFACE and TIN might also been interesting for completness (and full
> PostGIS interoperability).
>
> Even
>


-- 
Daniel Morissette
T: +1 418-696-5056 #201
http://www.mapgears.com/
Provider of Professional MapServer Support since 2000

From even.rouault at spatialys.com  Tue Mar 17 20:20:09 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 18 Mar 2015 04:20:09 +0100
Subject: [gdal-dev] [GSOC] Support for m coordinates in OGRGeometries
In-Reply-To: <5508D78B.6020902@mapgears.com>
References: <CALaeiivE8PSJx+pJG7GWHzrdJcCKnkYukuO9mcueORX76E=hMg@mail.gmail.com>
	<1426640661.5508cf152e0ab@imp.free.fr>
	<5508D78B.6020902@mapgears.com>
Message-ID: <1426648809.5508eee98b30e@imp.free.fr>

Selon Daniel Morissette <dmorissette at mapgears.com>:

> FWIW I think support for M would be a very welcome addition. An
> immediate use I'd see for it would be support for time on GPS tracks in
> GPX files.
>
> Note that if supporting the M dimension doesn't seem enough for a SoC
> project, making sure that all formats that support M (or as many as
> possible) are upgraded to properly implement it may very well fill the
> rest of the summer.

Good point. At least the following ones for sure support M: Shapefile, ESRI
Personal Geodatabase, FileGDB / OpenFileGDB, PostGIS (and PGDump and CartoDB),
Spatialite, GeoPackage
Likely (but not verified): GML, Oracle
Maybe: MSSQL, MySQL
And as pointed by Daniel, the GPX and KML / LIBKML drivers could also use the M
dimension for storing track times. Probably the GPSTrackMaker one also, but not
verified.
So indeed quite a few drivers to get familiar with!

>
> My 0.02$
>
> Daniel
>
>
> On 2015-03-17 9:04 PM, Even Rouault wrote:
> > Selon Edson Ticona <xcr33d at gmail.com>:
> >
> >> Hi
> >>
> >> I was looking for the ideas list on the site and found this one
> >> interesting: "Adding support for "M" dimension in OGR Geometries" but
> >> it's from 2014. Is it still relevant for the project? I searched on
> >> the code and it isn't implemented.
> >> For example, the class OGRGeometry needs the methods isMeasured,
> >> LocateAlong and LocateBetween according to the definition on the OGC
> >> simple standard. I couldn't find an ISO standard talking about M
> >> coordinates. Which one do you refer on the page?
> >> What do you think? Some feedback would be helpful.
> >
> > Edson,
> >
> > Yes it is still relevant. Perhaps SQL/MM Part 3 mentions it ? I didn't
> check.
> > You'll find the link to a draft doc on
> > http://trac.osgeo.org/gdal/wiki/rfc49_curve_geometries
> > What has been done in PostGIS might also be interested looking into.
> > M only might be a bit light for a whole SOC, so adding support for
> > POLYHEDRALSURFACE and TIN might also been interesting for completness (and
> full
> > PostGIS interoperability).
> >
> > Even
> >
>
>
> --
> Daniel Morissette
> T: +1 418-696-5056 #201
> http://www.mapgears.com/
> Provider of Professional MapServer Support since 2000
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Tue Mar 17 21:22:36 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 18 Mar 2015 05:22:36 +0100
Subject: [gdal-dev] OpenFileGDB, feature classes in feature dataset
In-Reply-To: <550884FB.9080405@gmx.net>
References: <54FE2C01.80806@gmx.net> <1425966492.54fe859c1a13a@imp.free.fr>
	<550445F5.2030004@gmx.net> <1426388937.5504f7c920a12@imp.free.fr>
	<550884FB.9080405@gmx.net>
Message-ID: <1426652556.5508fd8c46165@imp.free.fr>

Selon Armin Burger <armin.burger at gmx.net>:

> Hi Even
>
> Thanks a lot again! I added the fix to the current 1.11.2 version and
> afterwards everything was fine, all layers in the FGDB v9 were found.

Cool. It would be usefull if someone could provide a as small as possible FGDB
v9 dataset to be used for regression testing. Let's say with a layer with a
point, another one with a line, another one with a polygon, multipoint, etc...
One no-spatial layer. One feature dataset layer. Something similar to
http://svn.osgeo.org/gdal/trunk/autotest/ogr/data/testopenfilegdb.gdb.zip but
generated by ArcGIS v9. It wouldn't have necessary caught this bug, but that
would be at least a start.

>
> Cheers
> Armin
>
>
> On 03/15/2015 04:08 AM, Even Rouault wrote:
> > Armin,
> >
> > I've committed a fix in http://trac.osgeo.org/gdal/ticket/5875 that should
> > hopefully fix your issue. There was a problem with the presence of non
> spatial
> > tables that could cause later tables not to be listed. This wasn't
> specifically
> > related to feature classes.
> >
> > Even
> >
> >> Hi Even
> >>
> >> thanks for the reply!
> >>
> >> The FGDB dataset where I discovered that has unfortunately some
> >> commercial IPR restrictions, so I cannot share it (and it in addition
> >> has some 800 MB...). I will try to create a test FGDB with a similar
> >> internal structure, I have to check if I can create an FGDB v9 format
> >> with recent ArcGIS versions.
> >>
> >> Armin
> >>
> >>
> >> On 03/10/2015 06:48 AM, Even Rouault wrote:
> >>> Selon Armin Burger <armin.burger at gmx.net>:
> >>>
> >>>> Dear all
> >>>>
> >>>> I have a question regarding the OpenFileGDB driver in 1.11.2 release. It
> >>>> now lists also non-spatial tables as layers of an FGDB (as mentioned in
> >>>> the changelog). But it seems to not list any more layers that are
> >>>> "feature classes" under a parent "feature dataset" (that's how the
> >>>> relation is displayed in ArcGIS). This is at least the case for FGDB's
> >>>> in older v9 format. In GDAL version 1.11.0 these feature classes were
> >>>> still listed as layers.
> >>>>
> >>>> Is this a bug or an intended behavior?
> >>>>
> >>>
> >>> Looks like an unfortunate side effect. could you open a ticket and attach
> >> such a
> >>> GDB or provide a link to it ?
> >>>
> >>>
> >>>> Best regards
> >>>> Armin
> >>>> _______________________________________________
> >>>> gdal-dev mailing list
> >>>> gdal-dev at lists.osgeo.org
> >>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >>>>
> >>>
> >>>
> >>
> >
> >
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From Michael.Smith at erdc.dren.mil  Wed Mar 18 04:15:57 2015
From: Michael.Smith at erdc.dren.mil (Smith, Michael ERDC-RDE-CRREL-NH)
Date: Wed, 18 Mar 2015 11:15:57 +0000
Subject: [gdal-dev] [EXTERNAL] Re: [GSOC] Support for m coordinates in
 OGRGeometries
In-Reply-To: <1426648809.5508eee98b30e@imp.free.fr>
References: <CALaeiivE8PSJx+pJG7GWHzrdJcCKnkYukuO9mcueORX76E=hMg@mail.gmail.com>
	<1426640661.5508cf152e0ab@imp.free.fr> <5508D78B.6020902@mapgears.com>
	<1426648809.5508eee98b30e@imp.free.fr>
Message-ID: <D12ED67F.10E8AD%michael.smith@erdc.dren.mil>

Oracle definitely supports M.

Mike
----
Michael Smith

US Army Corps
Remote Sensing GIS/Center
michael.smith at usace.army.mil





On 3/17/15, 11:20 PM, "Even Rouault" <even.rouault at spatialys.com> wrote:

>Selon Daniel Morissette <dmorissette at mapgears.com>:
>
>> FWIW I think support for M would be a very welcome addition. An
>> immediate use I'd see for it would be support for time on GPS tracks in
>> GPX files.
>>
>> Note that if supporting the M dimension doesn't seem enough for a SoC
>> project, making sure that all formats that support M (or as many as
>> possible) are upgraded to properly implement it may very well fill the
>> rest of the summer.
>
>Good point. At least the following ones for sure support M: Shapefile,
>ESRI
>Personal Geodatabase, FileGDB / OpenFileGDB, PostGIS (and PGDump and
>CartoDB),
>Spatialite, GeoPackage
>Likely (but not verified): GML, Oracle
>Maybe: MSSQL, MySQL
>And as pointed by Daniel, the GPX and KML / LIBKML drivers could also use
>the M
>dimension for storing track times. Probably the GPSTrackMaker one also,
>but not
>verified.
>So indeed quite a few drivers to get familiar with!
>
>>
>> My 0.02$
>>
>> Daniel
>>
>>
>> On 2015-03-17 9:04 PM, Even Rouault wrote:
>> > Selon Edson Ticona <xcr33d at gmail.com>:
>> >
>> >> Hi
>> >>
>> >> I was looking for the ideas list on the site and found this one
>> >> interesting: "Adding support for "M" dimension in OGR Geometries" but
>> >> it's from 2014. Is it still relevant for the project? I searched on
>> >> the code and it isn't implemented.
>> >> For example, the class OGRGeometry needs the methods isMeasured,
>> >> LocateAlong and LocateBetween according to the definition on the OGC
>> >> simple standard. I couldn't find an ISO standard talking about M
>> >> coordinates. Which one do you refer on the page?
>> >> What do you think? Some feedback would be helpful.
>> >
>> > Edson,
>> >
>> > Yes it is still relevant. Perhaps SQL/MM Part 3 mentions it ? I didn't
>> check.
>> > You'll find the link to a draft doc on
>> > http://trac.osgeo.org/gdal/wiki/rfc49_curve_geometries
>> > What has been done in PostGIS might also be interested looking into.
>> > M only might be a bit light for a whole SOC, so adding support for
>> > POLYHEDRALSURFACE and TIN might also been interesting for completness
>>(and
>> full
>> > PostGIS interoperability).
>> >
>> > Even
>> >
>>
>>
>> --
>> Daniel Morissette
>> T: +1 418-696-5056 #201
>> http://www.mapgears.com/
>> Provider of Professional MapServer Support since 2000
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>-- 
>Spatialys - Geospatial professional services
>http://www.spatialys.com
>_______________________________________________
>gdal-dev mailing list
>gdal-dev at lists.osgeo.org
>http://lists.osgeo.org/mailman/listinfo/gdal-dev


From Niels.vonFestenberg-Packisch.ext at rohde-schwarz.com  Wed Mar 18 06:24:05 2015
From: Niels.vonFestenberg-Packisch.ext at rohde-schwarz.com (Niels.vonFestenberg-Packisch.ext at rohde-schwarz.com)
Date: Wed, 18 Mar 2015 14:24:05 +0100
Subject: [gdal-dev] Antwort: crashing debug-dll of proj4 and gdal with QT -
 not due to /MD(d) issue
In-Reply-To: <OF4886C081.9D437104-ONC1257E0B.0052E05F-C1257E0B.0056A596@rohde-schwarz.com>
References: <OF4886C081.9D437104-ONC1257E0B.0052E05F-C1257E0B.0056A596@rohde-schwarz.com>
Message-ID: <OF81904F9B.333F3C5C-ONC1257E0C.00469912-C1257E0C.00499E16@rohde-schwarz.com>

Hi again,
the issue is fixed now. It turned out that there was some hidden and 
"suboptimal" work around in older source code which caused the newer PROJ4 
version 1.11 to crash.  Removing that solved the problem. 
Regards
Niels




Von:    Niels.vonFestenberg-Packisch.ext at rohde-schwarz.com
An:     gdal-dev at lists.osgeo.org, 
Datum:  17.03.2015 17:02
Betreff:        [gdal-dev] crashing debug-dll of proj4 and gdal with QT - 
not due to /MD(d) issue
Gesendet von:   gdal-dev-bounces at lists.osgeo.org



Hi all 

I have been trying hard to get a running debug version of the gdal- and 
proj4-dlls within a larger qt4.8 project. Everything runs smoothly in 
release mode, but in debug it always crashes at the first use of a 
proj4-function. I'm using VS2008, GDAL v1.11 and proj4 in v4.9 in on a 
win7 32bit project relying on Qt4.8 with QTCreator 3.3.   

All posts I found on that issue directed me to the choice of the C runtime 
dll when building the debug dlls (i.e. MSVCR90.dll vs. MSVCR90D.dll). 
However, I've now tried out a whole bunch of compiler flag combinations in 
both nmake.opt files (-MD, -MDd for the CRT choice, and also -Zi, -Od, 
-Ehsc ...), static and dynamic linking of the libs, also dependency walker 
to double check which dlls really are in use, but the error didn't change 
at all (nor it disappeared of course). 

I'm quite sure to have copied the compiler options of all other libs in 
use. Particularly, the crash always happens at the same code line as 
mentioned above. 

So anybody here has an idea how one could solve this? If you need further 
information on the build context, I'll be happy to supply it. 

Thank you very much in advance 

Regards 
Niels 



---- 
Im Auftrag von
Rohde & Schwarz GmbH & Co. KG

Postfach 80 14 69   ?   81614 M?nchen
M?hldorfstra?e 15   ?   81671 M?nchen
Telefon:        (089) 4129-16563
Mail: Niels.vonFestenberg-Packisch.ext at rohde-schwarz.com
Internet: www.rohde-schwarz.com"  
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150318/30505342/attachment.html>

From garethgrewcock at gmail.com  Wed Mar 18 08:41:40 2015
From: garethgrewcock at gmail.com (Gareth Grewcock)
Date: Wed, 18 Mar 2015 15:41:40 +0000
Subject: [gdal-dev] Hillshade | Raster Band Rendering
Message-ID: <CAMEt-j9-sgG6NovE4Fk6oiDRq1X=02gvpLWwHkSBSwLp=4HzuA@mail.gmail.com>

Hi - firstly, apologies if the gdal-dev mailing is not the appropriate
mailing list, please advise a more suitable place to post if so.



My objective is to create a hillshaded color-relief image of a DEM using
commandline/programmatic means only, so the process can be automated and
combined within an existing GMT/GDAL workflow.



Currently, I can generate both hillshaded and color-relief rasters using
gdaldem and combine them with Mapnik (using opacity) to generate a my final
rendered image. However, this process will use the min-max values in the
grayscale hillshaded image.



However, I can achieve an improved or sharper hillshaded image when I
manually use QGIS to further process the hillshaded image by:

1. Adding the hillshaded raster to QGIS, which applies by default the
'Cumulative count cut 2% - 98%' style.

2. Then export the hillshaded raster (with the cumulative count style
applied) as a ?Rendered Image?.



I have annotated a screenshot here
https://www.dropbox.com/s/ftzk7j2bmznuvjn/raster_band_rendering.png?dl=0
hopefully illustrating the

1.    Improved hillshaded raster output from QGIS ('Cumulative count cut)
compared with,

2.    gdal+mapnik output (using min-max)



So, is there an approach using gdal (or similar command-line tool/app) to
achieve the ?improved? hillshaded raster without the ?manual? QGIS step?



As I see it, my options are:

1. Use gdalinfo with the ?-hist? option to export the histogram of the
hillshaded raster. I guess then I could maybe calculate the 2% and 98%
percentile(?) values and then manipulate the raster values using
gdal_calc.py or something else.  However, I?m no statistician, so hoped
there would be an out of the box solution?!

2. Maybe, I could use the python api for QGIS to import the hillshade,
render, style and export back out. I?m sure this is possible, but would
require an additional python script.

3. Use another library or framework to achieve either of the above. I?ve
researched python?s numpy library, which maybe I could do the percentage
calculation directly on the raster. Again, potentially tricky learning
curve there?



Any help or advice would greatly appreciated. If any help, the data I?m
using is here
https://www.dropbox.com/s/v0peaa3rzaqbhen/raster_band_rendering.zip?dl=0



Cheers


Gareth
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150318/8f2efb04/attachment.html>

From pramsey at cleverelephant.ca  Wed Mar 18 09:19:27 2015
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Wed, 18 Mar 2015 09:19:27 -0700
Subject: [gdal-dev] Pg Table Listing
Message-ID: <etPan.5509a590.41b71efb.6393@Crane.local>

We noticed that in databases with lots of tables, OGR throws some pretty crazy SQL at the database, and things get slow and the source of the problem seems to be here:

http://trac.osgeo.org/gdal/browser/trunk/gdal/ogr/ogrsf_frmts/pg/ogrpgdatasource.cpp#L851

Which in addition to being a big query on system tables joins back to geometry_columns, which is, itself now a big query on system tables. I think that?s the main problem. Probably either the query should just use the system tables alone, and take advantage of the PostGIS geometry_columns view code as a guide

http://trac.osgeo.org/postgis/browser/trunk/postgis/postgis.sql.in#L4980

The only trick is, I guess, figuring out which versions of PgSQL particular system table code will work against. The main dividing line for PostGIS is between versions 1 and 2. ?What?s the minimum supported version of PgSQL for OGR?

P.?


--  
http://postgis.net  
http://cleverelephant.ca



From thare at usgs.gov  Wed Mar 18 09:45:30 2015
From: thare at usgs.gov (Hare, Trent)
Date: Wed, 18 Mar 2015 09:45:30 -0700
Subject: [gdal-dev] Hillshade | Raster Band Rendering
In-Reply-To: <CAMEt-j9-sgG6NovE4Fk6oiDRq1X=02gvpLWwHkSBSwLp=4HzuA@mail.gmail.com>
References: <CAMEt-j9-sgG6NovE4Fk6oiDRq1X=02gvpLWwHkSBSwLp=4HzuA@mail.gmail.com>
Message-ID: <CAB6t5t-5GnKz55GxQnB40AW8+5XqE6QxWD-9VrQr5qmUDoXB0w@mail.gmail.com>

Gareth,
   Frank implemented a method to merge a hillshade and color-mapped image
in GDAL/python (called hsv_merge.py). This code could be changed to meet
your needs. Otherwise you might be able to stretch the hillshade using the
scale parameter in gdal_translate prior to using hsv_merge.py.

https://svn.osgeo.org/gdal/trunk/gdal/swig/python/samples/

example workflow:
http://linfiniti.com/2010/12/a-workflow-for-creating-beautiful-relief-shaded-dems-using-gdal/

There many different methods to blend these two files together. If you
write an update to hsv_merge.py it would be good to hear about.

For a C++ (faster) implementation of hsv_merge, NASA Ames have released
binaries (and code) within their Stereo Pipeline (ASP) package.
http://ti.arc.nasa.gov/tech/asr/intelligent-robotics/ngt/stereo/

Good luck,
Trent

On Wed, Mar 18, 2015 at 8:41 AM, Gareth Grewcock <garethgrewcock at gmail.com>
wrote:

> Hi - firstly, apologies if the gdal-dev mailing is not the appropriate
> mailing list, please advise a more suitable place to post if so.
>
>
>
> My objective is to create a hillshaded color-relief image of a DEM using
> commandline/programmatic means only, so the process can be automated and
> combined within an existing GMT/GDAL workflow.
>
>
>
> Currently, I can generate both hillshaded and color-relief rasters using
> gdaldem and combine them with Mapnik (using opacity) to generate a my final
> rendered image. However, this process will use the min-max values in the
> grayscale hillshaded image.
>
>
>
> However, I can achieve an improved or sharper hillshaded image when I
> manually use QGIS to further process the hillshaded image by:
>
> 1. Adding the hillshaded raster to QGIS, which applies by default the
> 'Cumulative count cut 2% - 98%' style.
>
> 2. Then export the hillshaded raster (with the cumulative count style
> applied) as a ?Rendered Image?.
>
>
>
> I have annotated a screenshot here
> https://www.dropbox.com/s/ftzk7j2bmznuvjn/raster_band_rendering.png?dl=0
> hopefully illustrating the
>
> 1.    Improved hillshaded raster output from QGIS ('Cumulative count cut)
> compared with,
>
> 2.    gdal+mapnik output (using min-max)
>
>
>
> So, is there an approach using gdal (or similar command-line tool/app) to
> achieve the ?improved? hillshaded raster without the ?manual? QGIS step?
>
>
>
> As I see it, my options are:
>
> 1. Use gdalinfo with the ?-hist? option to export the histogram of the
> hillshaded raster. I guess then I could maybe calculate the 2% and 98%
> percentile(?) values and then manipulate the raster values using
> gdal_calc.py or something else.  However, I?m no statistician, so hoped
> there would be an out of the box solution?!
>
> 2. Maybe, I could use the python api for QGIS to import the hillshade,
> render, style and export back out. I?m sure this is possible, but would
> require an additional python script.
>
> 3. Use another library or framework to achieve either of the above. I?ve
> researched python?s numpy library, which maybe I could do the percentage
> calculation directly on the raster. Again, potentially tricky learning
> curve there?
>
>
>
> Any help or advice would greatly appreciated. If any help, the data I?m
> using is here
> https://www.dropbox.com/s/v0peaa3rzaqbhen/raster_band_rendering.zip?dl=0
>
>
>
> Cheers
>
>
> Gareth
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150318/fb0aa880/attachment-0001.html>

From even.rouault at spatialys.com  Wed Mar 18 09:53:55 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 18 Mar 2015 17:53:55 +0100
Subject: [gdal-dev] Pg Table Listing
In-Reply-To: <etPan.5509a590.41b71efb.6393@Crane.local>
References: <etPan.5509a590.41b71efb.6393@Crane.local>
Message-ID: <1426697635.5509ada312078@imp.free.fr>

Hi Paul,

> We noticed that in databases with lots of tables, OGR throws some pretty
> crazy SQL at the database, and things get slow and the source of the problem
> seems to be here:
>
>
http://trac.osgeo.org/gdal/browser/trunk/gdal/ogr/ogrsf_frmts/pg/ogrpgdatasource.cpp#L851
>
> Which in addition to being a big query on system tables joins back to
> geometry_columns, which is, itself now a big query on system tables. I think
> that???s the main problem.

It certainly is. I think the performance issue appeared with PostGIS 2.0 when
geometry_columns has become a view.

> Probably either the query should just use the
> system tables alone, and take advantage of the PostGIS geometry_columns view
> code as a guide
>
> http://trac.osgeo.org/postgis/browser/trunk/postgis/postgis.sql.in#L4980

The query also tries to get geospatial information (geometry column name, SRID,
geometry type), but we don't necessarily need it when establishing the layer
list, as it can also be resolved lazily later in
OGRPGTableLayer::ReadTableDefinition(), so if retrieving only table and schema
name of views and tables with geometry/geography columns is faster than
retrieving them + geometry column name, SRID and geometry type, then it might be
a potential optimization.

>
> The only trick is, I guess, figuring out which versions of PgSQL particular
> system table code will work against. The main dividing line for PostGIS is
> between versions 1 and 2. ??What???s the minimum supported version of PgSQL
> for OGR?

That is a good question. In theory the code should be able to support PostgreSQL
7.4 and prior... but I doubt it has been tested in a while, so it is likely
broken and we could probably do some spring cleanup. I personnaly have an old
Ubuntu 10.04 with PostgreSQL 8.4 + PostGIS 1.5 that works with current OGR. I
believe that could be reasonably established as conservative minimum versions.
Any people using more ancient versions ?

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From pramsey at cleverelephant.ca  Wed Mar 18 09:58:20 2015
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Wed, 18 Mar 2015 09:58:20 -0700
Subject: [gdal-dev] Pg Table Listing
In-Reply-To: <1426697635.5509ada312078@imp.free.fr>
References: <etPan.5509a590.41b71efb.6393@Crane.local>
	<1426697635.5509ada312078@imp.free.fr>
Message-ID: <etPan.5509aeae.515f007c.6393@Crane.local>




On March 18, 2015 at 9:53:58 AM, Even Rouault (even.rouault at spatialys.com) wrote:
>  
> It certainly is. I think the performance issue appeared with PostGIS 2.0 when
> geometry_columns has become a view.
>  
> > Probably either the query should just use the
> > system tables alone, and take advantage of the PostGIS geometry_columns view
> > code as a guide
> >
> > http://trac.osgeo.org/postgis/browser/trunk/postgis/postgis.sql.in#L4980  
>  
> The query also tries to get geospatial information (geometry column name, SRID,
> geometry type), but we don't necessarily need it when establishing the layer
> list, as it can also be resolved lazily later in
> OGRPGTableLayer::ReadTableDefinition(), so if retrieving only table and schema  
> name of views and tables with geometry/geography columns is faster than
> retrieving them + geometry column name, SRID and geometry type, then it might be
> a potential optimization.

The only upside of the current approach is that it?s nicely invariant across the versions of PostGIS. However, having two versions for performance reasons probably would be nice. If we could strip down the columns returned, that would make it even slicker. What?s the minimum columns needed at this stage in the driver setup?

There?s also a couple new relation types, ?m? for materialized views and ?f? for? gah! I don?t know. I?m not sure whether the OGR driver should consider a materialized view a view or a table? probably a table, since it has the same performance characteristics?

> I
> believe that could be reasonably established as conservative minimum versions.
> Any people using more ancient versions ?

Actually, I think that the system table usage is not so crazy that it wouldn?t go back as far as 8.0, and the introduction of schemas (pg_namespace). I don?t see anything else we?re using that isn?t as old as the stones.

p.?

From strk at keybit.net  Wed Mar 18 10:09:21 2015
From: strk at keybit.net (Sandro Santilli)
Date: Wed, 18 Mar 2015 18:09:21 +0100
Subject: [gdal-dev] Pg Table Listing
In-Reply-To: <etPan.5509aeae.515f007c.6393@Crane.local>
References: <etPan.5509a590.41b71efb.6393@Crane.local>
	<1426697635.5509ada312078@imp.free.fr>
	<etPan.5509aeae.515f007c.6393@Crane.local>
Message-ID: <20150318170920.GG3887@localhost>

On Wed, Mar 18, 2015 at 09:58:20AM -0700, Paul Ramsey wrote:

> There?s also a couple new relation types, ?m? for materialized
> views and ?f? for? gah! I don?t know. 

I think 'f' is for foreign data tables.

It's surprising that joining a view on catalogue tables considerably
slows down. Shouldn't the optimizer be able to rewrite the query
to skip redundancies ?

--strk;

  ()   Free GIS & Flash consultant/developer
  /\   http://strk.keybit.net/services.html

From pramsey at cleverelephant.ca  Wed Mar 18 10:18:05 2015
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Wed, 18 Mar 2015 10:18:05 -0700
Subject: [gdal-dev] Pg Table Listing
In-Reply-To: <20150318170920.GG3887@localhost>
References: <etPan.5509a590.41b71efb.6393@Crane.local>
	<1426697635.5509ada312078@imp.free.fr>
	<etPan.5509aeae.515f007c.6393@Crane.local>
	<20150318170920.GG3887@localhost>
Message-ID: <etPan.5509b353.1190cde7.6393@Crane.local>

Yes, that?s what ?f? is.
It could just be that on a database with N-hundred tables the query would be slow regardless. Something I?ll do a quick test of.
I?m writing up a few variants to go into those slots for different versions.
?P


--  
http://postgis.net  
http://cleverelephant.ca


On March 18, 2015 at 10:09:26 AM, Sandro Santilli (strk at keybit.net) wrote:
> On Wed, Mar 18, 2015 at 09:58:20AM -0700, Paul Ramsey wrote:
>  
> > There?s also a couple new relation types, ?m? for materialized
> > views and ?f? for? gah! I don?t know.
>  
> I think 'f' is for foreign data tables.
>  
> It's surprising that joining a view on catalogue tables considerably
> slows down. Shouldn't the optimizer be able to rewrite the query
> to skip redundancies ?
>  
> --strk;
>  
> () Free GIS & Flash consultant/developer
> /\ http://strk.keybit.net/services.html
>  


From pramsey at cleverelephant.ca  Wed Mar 18 10:27:51 2015
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Wed, 18 Mar 2015 10:27:51 -0700
Subject: [gdal-dev] Pg Table Listing
In-Reply-To: <etPan.5509b353.1190cde7.6393@Crane.local>
References: <etPan.5509a590.41b71efb.6393@Crane.local>
	<1426697635.5509ada312078@imp.free.fr>
	<etPan.5509aeae.515f007c.6393@Crane.local>
	<20150318170920.GG3887@localhost>
	<etPan.5509b353.1190cde7.6393@Crane.local>
Message-ID: <etPan.5509b599.66ef438d.6393@Crane.local>

OK, yeah, even w/o populating my database with 1000 tables, I can see the timing difference between joining with geometry_columns, and just hitting system tables directly


-- joined with geometry columns (14ms)
SELECT?
c.relname, n.nspname, c.relkind,?
g.f_geometry_column, g.type, g.coord_dimension, g.srid,?
1, a.attnotnull, c.oid as oid, a.attnum as attnum?
FROM geometry_columns g?
JOIN pg_class c ON g.f_table_name = c.relname
JOIN pg_namespace n ON g.f_table_schema = n.nspname AND c.relnamespace = n.oid?
JOIN pg_attribute a ON g.f_geometry_column = a.attname AND c.oid = a.attrelid
WHERE c.relkind in ('r','v','m','f')?
AND n.nspname != 'pg_catalog' ;


-- without geometry columns (2ms)

SELECT?
c.relname, n.nspname, c.relkind, a.attname, t.typname
FROM pg_attribute a
JOIN pg_type t ON a.atttypid = t.oid
JOIN pg_class c ON a.attrelid = c.oid
JOIN pg_namespace n ON c.relnamespace = n.oid?
WHERE t.typname = 'geometry'::name
AND c.relkind in ('r'::"char", 'v'::"char", 'm'::"char", 'f'::"char")?
AND n.nspname != 'pg_catalog' ;


So, seems a worthwhile effort,
P?

--  
http://postgis.net  
http://cleverelephant.ca


On March 18, 2015 at 10:19:16 AM, Paul Ramsey (pramsey at cleverelephant.ca) wrote:
> Yes, that?s what ?f? is.
> It could just be that on a database with N-hundred tables the query would be slow regardless.  
> Something I?ll do a quick test of.
> I?m writing up a few variants to go into those slots for different versions.
> P
>  
>  
> --
> http://postgis.net
> http://cleverelephant.ca
>  
>  
> On March 18, 2015 at 10:09:26 AM, Sandro Santilli (strk at keybit.net) wrote:
> > On Wed, Mar 18, 2015 at 09:58:20AM -0700, Paul Ramsey wrote:
> >
> > > There?s also a couple new relation types, ?m? for materialized
> > > views and ?f? for? gah! I don?t know.
> >
> > I think 'f' is for foreign data tables.
> >
> > It's surprising that joining a view on catalogue tables considerably
> > slows down. Shouldn't the optimizer be able to rewrite the query
> > to skip redundancies ?
> >
> > --strk;
> >
> > () Free GIS & Flash consultant/developer
> > /\ http://strk.keybit.net/services.html
> >
>  
>  


From pramsey at cleverelephant.ca  Wed Mar 18 10:59:28 2015
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Wed, 18 Mar 2015 10:59:28 -0700
Subject: [gdal-dev] Pg Table Listing
In-Reply-To: <etPan.5509b599.66ef438d.6393@Crane.local>
References: <etPan.5509a590.41b71efb.6393@Crane.local>
	<1426697635.5509ada312078@imp.free.fr>
	<etPan.5509aeae.515f007c.6393@Crane.local>
	<20150318170920.GG3887@localhost>
	<etPan.5509b353.1190cde7.6393@Crane.local>
	<etPan.5509b599.66ef438d.6393@Crane.local>
Message-ID: <etPan.5509bd03.7fdcc233.6393@Crane.local>

With 1000 tables, the disparity is 300ms for the join on geometry_columns and 30ms for the straight system table query.

Still, not something that should be noticeable (really) in the context of a batch query. I guess actually it would be twice as big, since the OGR query runs twice (once for geometry, once for geography) in the UNION. So nearing half a ?second. But still? in the context of a batch process? hm.

P.


--  
http://postgis.net  
http://cleverelephant.ca


On March 18, 2015 at 10:28:58 AM, Paul Ramsey (pramsey at cleverelephant.ca) wrote:
> OK, yeah, even w/o populating my database with 1000 tables, I can see the timing difference  
> between joining with geometry_columns, and just hitting system tables directly
>  
>  
> -- joined with geometry columns (14ms)
> SELECT
> c.relname, n.nspname, c.relkind,
> g.f_geometry_column, g.type, g.coord_dimension, g.srid,
> 1, a.attnotnull, c.oid as oid, a.attnum as attnum
> FROM geometry_columns g
> JOIN pg_class c ON g.f_table_name = c.relname
> JOIN pg_namespace n ON g.f_table_schema = n.nspname AND c.relnamespace = n.oid
> JOIN pg_attribute a ON g.f_geometry_column = a.attname AND c.oid = a.attrelid
> WHERE c.relkind in ('r','v','m','f')
> AND n.nspname != 'pg_catalog' ;
>  
>  
> -- without geometry columns (2ms)
>  
> SELECT
> c.relname, n.nspname, c.relkind, a.attname, t.typname
> FROM pg_attribute a
> JOIN pg_type t ON a.atttypid = t.oid
> JOIN pg_class c ON a.attrelid = c.oid
> JOIN pg_namespace n ON c.relnamespace = n.oid
> WHERE t.typname = 'geometry'::name
> AND c.relkind in ('r'::"char", 'v'::"char", 'm'::"char", 'f'::"char")
> AND n.nspname != 'pg_catalog' ;
>  
>  
> So, seems a worthwhile effort,
> P
>  
> --
> http://postgis.net
> http://cleverelephant.ca
>  
>  
> On March 18, 2015 at 10:19:16 AM, Paul Ramsey (pramsey at cleverelephant.ca) wrote:
> > Yes, that?s what ?f? is.
> > It could just be that on a database with N-hundred tables the query would be slow regardless.  
> > Something I?ll do a quick test of.
> > I?m writing up a few variants to go into those slots for different versions.
> > P
> >
> >
> > --
> > http://postgis.net
> > http://cleverelephant.ca
> >
> >
> > On March 18, 2015 at 10:09:26 AM, Sandro Santilli (strk at keybit.net) wrote:
> > > On Wed, Mar 18, 2015 at 09:58:20AM -0700, Paul Ramsey wrote:
> > >
> > > > There?s also a couple new relation types, ?m? for materialized
> > > > views and ?f? for? gah! I don?t know.
> > >
> > > I think 'f' is for foreign data tables.
> > >
> > > It's surprising that joining a view on catalogue tables considerably
> > > slows down. Shouldn't the optimizer be able to rewrite the query
> > > to skip redundancies ?
> > >
> > > --strk;
> > >
> > > () Free GIS & Flash consultant/developer
> > > /\ http://strk.keybit.net/services.html
> > >
> >
> >
>  
>  


From jluis at ualg.pt  Wed Mar 18 11:17:59 2015
From: jluis at ualg.pt (Joaquim Luis)
Date: Wed, 18 Mar 2015 18:17:59 -0000
Subject: [gdal-dev] Hillshade | Raster Band Rendering
In-Reply-To: <CAMEt-j9-sgG6NovE4Fk6oiDRq1X=02gvpLWwHkSBSwLp=4HzuA@mail.gmail.com>
References: <CAMEt-j9-sgG6NovE4Fk6oiDRq1X=02gvpLWwHkSBSwLp=4HzuA@mail.gmail.com>
Message-ID: <op.xvpg39gadbaoe8@macmarilu>


>
> My objective is to create a hillshaded color-relief image of a DEM using  
> commandline/programmatic means only, so the process >can be automated  
> and combined within an existing GMT/GDAL workflow.

If your workflow includes GMT that you have a reach panoply of methods to  
do shade illuminations. See man pages of grdgradient and grdhisteq.

Joaquim

>
>
> Currently, I can generate both hillshaded and color-relief rasters using  
> gdaldem and combine them with Mapnik (using opacity) to >generate a my  
> final rendered image. However, this process will use the min-max values  
> in the grayscale hillshaded image.
>
>
> However, I can achieve an improved or sharper hillshaded image when I  
> manually use QGIS to further process the hillshaded image >by:
>
> 1. Adding the hillshaded raster to QGIS, which applies by default the  
> 'Cumulative count cut 2% - 98%' style.
>
> 2. Then export the hillshaded raster (with the cumulative count style  
> applied) as a ?Rendered Image?.
>
>
> I have annotated a screenshot here  
> https://www.dropbox.com/s/ftzk7j2bmznuvjn/raster_band_rendering.png?dl=0  
> hopefully >illustrating the
>
> 1.    Improved hillshaded raster output from QGIS ('Cumulative count  
> cut) compared with,
> 2.    gdal+mapnik output (using min-max)
>
> So, is there an approach using gdal (or similar command-line tool/app)  
> to achieve the ?improved? hillshaded raster without the >?manual? QGIS  
> step?
>
>
> As I see it, my options are:
>
> 1. Use gdalinfo with the ?-hist? option to export the histogram of the  
> hillshaded raster. I guess then I could maybe calculate the 2% >and 98%  
> percentile(?) values and then manipulate the raster values using  
> gdal_calc.py or something else.  However, I?m no >statistician, so hoped  
> there would be an out of the box solution?!
>
> 2. Maybe, I could use the python api for QGIS to import the hillshade,  
> render, style and export back out. I?m sure this is possible, >but would  
> require an additional python script.
>
> 3. Use another library or framework to achieve either of the above. I?ve  
> researched python?s numpy library, which maybe I could do >the  
> percentage calculation directly on the raster. Again, potentially tricky  
> learning curve there?
>
>
> Any help or advice would greatly appreciated. If any help, the data I?m  
> using is here  
> https://www.dropbox.com/s/v0peaa3rzaqbhen/>raster_band_rendering.zip?dl=0
>
>
> Cheers
>
>
>> Gareth
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150318/38b47523/attachment-0001.html>

From nshthm at gmail.com  Wed Mar 18 12:27:41 2015
From: nshthm at gmail.com (Nishith Maheshwari)
Date: Thu, 19 Mar 2015 00:57:41 +0530
Subject: [gdal-dev] [GSOC] Integration of cpp GDAL utilities into GDAL core
	library
Message-ID: <CABRzcz9L-zeMxSry+yrTjYAPDvhRmbMrVs324yvbCTMvg-bvpA@mail.gmail.com>

Hi,
I am a masters student from IIIT Hyderabad and currently in my final year
of study and working in the Lab for Spatial Informatics here.

I was a part of GSOC 2014 and worked on the project *'Schematization Plugin
for QGIS'* last year [1][2].

I am interested in the project *'Integration of cpp GDAL utilities into
GDAL core library'* .

I have already looked at a few codes of gdal utilities available in the
'apps' folder of the sourcecode and had a few queries -

1. From my understanding of the project description, the aim is to refactor
the individual codes of gdal utilities by removing the main() and making
them available in the form of functions. These functions can then be
accessed by another function like GDALRunUtility() which can be used to
call them individually using specific parameters. Please let me know if I'm
thinking in the right direction.

2. If we are implementing individual functions for every utility we might
not require a separate layer of interaction in the form of
GDALRunUtility(). Any thoughts?

[1] http://hub.qgis.org/wiki/quantum-gis/nishithm
[2] https://github.com/nishithm/schematization

Regards,
Nishith Maheshwari
Lab for Spatial Informatics
IIIT Hyderabad, India
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150319/01cb6e91/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Wed Mar 18 14:02:07 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Wed, 18 Mar 2015 21:02:07 +0000 (UTC)
Subject: [gdal-dev] Shapefile driver and support for Boolean attributes
Message-ID: <loom.20150318T215741-157@post.gmane.org>

Hi,

Is there some special reason why the shapefile driver does not support 
Logical (Boolean) data type for attributes? It seems that the "L" data type
is there in dBase III format
https://ulisse.elettra.trieste.it/services/doc/dbase/DBFstruct.htm#C1.4 and
even well defined Value: "? Y y N n T t F f (? when not initialized)". 

-Jukka Rahkonen-




From even.rouault at spatialys.com  Wed Mar 18 14:13:03 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 18 Mar 2015 22:13:03 +0100
Subject: [gdal-dev] Shapefile driver and support for Boolean attributes
In-Reply-To: <loom.20150318T215741-157@post.gmane.org>
References: <loom.20150318T215741-157@post.gmane.org>
Message-ID: <1426713183.5509ea5f10a04@imp.free.fr>

Selon Jukka Rahkonen <jukka.rahkonen at maanmittauslaitos.fi>:

> Hi,
>
> Is there some special reason why the shapefile driver does not support
> Logical (Boolean) data type for attributes? It seems that the "L" data type
> is there in dBase III format
> https://ulisse.elettra.trieste.it/services/doc/dbase/DBFstruct.htm#C1.4 and
> even well defined Value: "? Y y N n T t F f (? when not initialized)".

Jukka,

This is a good point. It could be added indeed. There's some support from it in
shapelib. I'm wondering how well it is supported by other (non GDAL based)
implementations however. Existing OGR would recognize it as a String(1) as far
as I can see.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Wed Mar 18 14:45:41 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Wed, 18 Mar 2015 21:45:41 +0000
Subject: [gdal-dev] Shapefile driver and support for Boolean attributes
In-Reply-To: <1426713183.5509ea5f10a04@imp.free.fr>
References: <loom.20150318T215741-157@post.gmane.org>,
	<1426713183.5509ea5f10a04@imp.free.fr>
Message-ID: <1426715141588.258@maanmittauslaitos.fi>

Hi,

I am testing new Boolean data type in OpenJUMP which is saved as Logical when data are exported into shapefiles. Kosmo GIS supports Logical already and Geotools and gvSIG as well. I said Logical is well defined but that is not totally true. Some implementations seem to use space to mean not initialized (NULL) instead of "?" http://jira.codehaus.org/browse/GEOT-2689, or even consider ? to mean "false" instead of NULL. Needs a more comprehensive literature review.

-Jukka-
________________________________________
Even Rouault wrote:

Selon Jukka Rahkonen <jukka.rahkonen at maanmittauslaitos.fi>:

> Hi,
>
> Is there some special reason why the shapefile driver does not support
> Logical (Boolean) data type for attributes? It seems that the "L" data type
> is there in dBase III format
> https://ulisse.elettra.trieste.it/services/doc/dbase/DBFstruct.htm#C1.4 and
> even well defined Value: "? Y y N n T t F f (? when not initialized)".

Jukka,

This is a good point. It could be added indeed. There's some support from it in
shapelib. I'm wondering how well it is supported by other (non GDAL based)
implementations however. Existing OGR would recognize it as a String(1) as far
as I can see.

Even

--
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Mar 18 15:55:14 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 18 Mar 2015 23:55:14 +0100
Subject: [gdal-dev] Ruby bindings
Message-ID: <1426719314.550a025227249@imp.free.fr>

Hi,

The build of Ruby bindings is broken in trunk. See
http://trac.osgeo.org/gdal/ticket/5880

The situation is that, in years, nobody has really maintained them, so it isn't
even sure that they work at runtime once compilation issues are fixed. So we
might just have to wipe them out, or remove them from configure, if nobody steps
up to maintain them. Opinions ?

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From xcr33d at gmail.com  Wed Mar 18 17:47:18 2015
From: xcr33d at gmail.com (Edson Ticona)
Date: Wed, 18 Mar 2015 19:47:18 -0500
Subject: [gdal-dev] [EXTERNAL] Re: [GSOC] Support for m coordinates in
	OGRGeometries
In-Reply-To: <D12ED67F.10E8AD%michael.smith@erdc.dren.mil>
References: <CALaeiivE8PSJx+pJG7GWHzrdJcCKnkYukuO9mcueORX76E=hMg@mail.gmail.com>
	<1426640661.5508cf152e0ab@imp.free.fr> <5508D78B.6020902@mapgears.com>
	<1426648809.5508eee98b30e@imp.free.fr>
	<D12ED67F.10E8AD%michael.smith@erdc.dren.mil>
Message-ID: <CALaeiitjeg2eLkysbJgBMSXKa0C_gWm9aiW+AOzVd6=G0cdHmQ@mail.gmail.com>

Hi
I checked PostGIS and it implements all M related stuff in a component
called lwgeom, the other functions are called from geos. I think that
it might be better to work, first, on fully compatibility with PostGIS
and then start to see other drivers because of the time it takes to
get familiar with other drivers. I am working on a more detailed plan
that is based on what's done on lwgeom, I am sending it to the list on
the weekend to get some feedback.
Just for referece, MySQL doesn't support M; Oracle and GML do!

Edson

On Wed, Mar 18, 2015 at 6:15 AM, Smith, Michael ERDC-RDE-CRREL-NH
<Michael.Smith at erdc.dren.mil> wrote:
> Oracle definitely supports M.
>
> Mike
> ----
> Michael Smith
>
> US Army Corps
> Remote Sensing GIS/Center
> michael.smith at usace.army.mil
>
>
>
>
>
> On 3/17/15, 11:20 PM, "Even Rouault" <even.rouault at spatialys.com> wrote:
>
>>Selon Daniel Morissette <dmorissette at mapgears.com>:
>>
>>> FWIW I think support for M would be a very welcome addition. An
>>> immediate use I'd see for it would be support for time on GPS tracks in
>>> GPX files.
>>>
>>> Note that if supporting the M dimension doesn't seem enough for a SoC
>>> project, making sure that all formats that support M (or as many as
>>> possible) are upgraded to properly implement it may very well fill the
>>> rest of the summer.
>>
>>Good point. At least the following ones for sure support M: Shapefile,
>>ESRI
>>Personal Geodatabase, FileGDB / OpenFileGDB, PostGIS (and PGDump and
>>CartoDB),
>>Spatialite, GeoPackage
>>Likely (but not verified): GML, Oracle
>>Maybe: MSSQL, MySQL
>>And as pointed by Daniel, the GPX and KML / LIBKML drivers could also use
>>the M
>>dimension for storing track times. Probably the GPSTrackMaker one also,
>>but not
>>verified.
>>So indeed quite a few drivers to get familiar with!
>>
>>>
>>> My 0.02$
>>>
>>> Daniel
>>>
>>>
>>> On 2015-03-17 9:04 PM, Even Rouault wrote:
>>> > Selon Edson Ticona <xcr33d at gmail.com>:
>>> >
>>> >> Hi
>>> >>
>>> >> I was looking for the ideas list on the site and found this one
>>> >> interesting: "Adding support for "M" dimension in OGR Geometries" but
>>> >> it's from 2014. Is it still relevant for the project? I searched on
>>> >> the code and it isn't implemented.
>>> >> For example, the class OGRGeometry needs the methods isMeasured,
>>> >> LocateAlong and LocateBetween according to the definition on the OGC
>>> >> simple standard. I couldn't find an ISO standard talking about M
>>> >> coordinates. Which one do you refer on the page?
>>> >> What do you think? Some feedback would be helpful.
>>> >
>>> > Edson,
>>> >
>>> > Yes it is still relevant. Perhaps SQL/MM Part 3 mentions it ? I didn't
>>> check.
>>> > You'll find the link to a draft doc on
>>> > http://trac.osgeo.org/gdal/wiki/rfc49_curve_geometries
>>> > What has been done in PostGIS might also be interested looking into.
>>> > M only might be a bit light for a whole SOC, so adding support for
>>> > POLYHEDRALSURFACE and TIN might also been interesting for completness
>>>(and
>>> full
>>> > PostGIS interoperability).
>>> >
>>> > Even
>>> >
>>>
>>>
>>> --
>>> Daniel Morissette
>>> T: +1 418-696-5056 #201
>>> http://www.mapgears.com/
>>> Provider of Professional MapServer Support since 2000
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>
>>
>>--
>>Spatialys - Geospatial professional services
>>http://www.spatialys.com
>>_______________________________________________
>>gdal-dev mailing list
>>gdal-dev at lists.osgeo.org
>>http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From ari.jolma at gmail.com  Wed Mar 18 20:21:55 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Thu, 19 Mar 2015 10:21:55 +0700
Subject: [gdal-dev] Ruby bindings
In-Reply-To: <1426719314.550a025227249@imp.free.fr>
References: <1426719314.550a025227249@imp.free.fr>
Message-ID: <550A40D3.6090302@gmail.com>

19.03.2015, 05:55, Even Rouault kirjoitti:
> Hi,
>
> The build of Ruby bindings is broken in trunk. See
> http://trac.osgeo.org/gdal/ticket/5880
>
> The situation is that, in years, nobody has really maintained them, so it isn't
> even sure that they work at runtime once compilation issues are fixed. So we
> might just have to wipe them out, or remove them from configure, if nobody steps
> up to maintain them. Opinions ?

IMO, remove from configure. Or, at least make it non-automatic.

I would have thought the cause was me since I did some changes in the 
common include files but that does not seem to be the case. For some 
reason ogr_error_map.i is not included when making gdal_wrap.cpp. It 
should be since it is in the ruby typemaps??

Ari

>
> Even
>


From even.rouault at spatialys.com  Wed Mar 18 21:03:14 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 19 Mar 2015 05:03:14 +0100
Subject: [gdal-dev] Ruby bindings
In-Reply-To: <550A40D3.6090302@gmail.com>
References: <1426719314.550a025227249@imp.free.fr> <550A40D3.6090302@gmail.com>
Message-ID: <1426737794.550a4a828ca01@imp.free.fr>

Selon Ari Jolma <ari.jolma at gmail.com>:

> 19.03.2015, 05:55, Even Rouault kirjoitti:
> > Hi,
> >
> > The build of Ruby bindings is broken in trunk. See
> > http://trac.osgeo.org/gdal/ticket/5880
> >
> > The situation is that, in years, nobody has really maintained them, so it
> isn't
> > even sure that they work at runtime once compilation issues are fixed. So
> we
> > might just have to wipe them out, or remove them from configure, if nobody
> steps
> > up to maintain them. Opinions ?
>
> IMO, remove from configure. Or, at least make it non-automatic.

It is non automatic at the moment, but it doesn't make sense to provide an
option that when enabled cause a build failure.

>
> I would have thought the cause was me since I did some changes in the
> common include files but that does not seem to be the case. For some
> reason ogr_error_map.i is not included when making gdal_wrap.cpp. It
> should be since it is in the ruby typemaps??

$ grep -r ogr_error_map swig/include/
swig/include/ogr_error_map.i: * $Id: ogr_error_map.i 12444 2007-10-16 17:48:23Z
ajolma $
swig/include/perl/typemaps_perl.i:%import "ogr_error_map.i"
swig/include/ruby/typemaps_ruby.i:%include ogr_error_map.i
swig/include/java/typemaps_java.i:%import "ogr_error_map.i"
swig/include/python/typemaps_python.i:%import "ogr_error_map.i"

So the difference is that the ruby bindings do a include and not a import. The
difference between the two always goes above my head without looking at swig
docs. Anyway the problem is that there's no core maintainer with interest in
ruby bindings.

>
> Ari
>
> >
> > Even
> >
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From robert.coup at koordinates.com  Wed Mar 18 21:15:31 2015
From: robert.coup at koordinates.com (Robert Coup)
Date: Thu, 19 Mar 2015 17:15:31 +1300
Subject: [gdal-dev] Ruby bindings
In-Reply-To: <1426737794.550a4a828ca01@imp.free.fr>
References: <1426719314.550a025227249@imp.free.fr> <550A40D3.6090302@gmail.com>
	<1426737794.550a4a828ca01@imp.free.fr>
Message-ID: <CAFLLRpKxwNVtT6HfN9oeX-6fj5m5tnxe7POwE0zHTw2CyDVQ6g@mail.gmail.com>

On Thu, Mar 19, 2015 at 5:03 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Selon Ari Jolma <ari.jolma at gmail.com>:
>
> > 19.03.2015, 05:55, Even Rouault kirjoitti:
> > > Hi,
> > >
> > > The build of Ruby bindings is broken in trunk. See
> > > http://trac.osgeo.org/gdal/ticket/5880
> > >
> > > The situation is that, in years, nobody has really maintained them, so
> it
> > isn't
> > > even sure that they work at runtime once compilation issues are fixed.
> So
> > we
> > > might just have to wipe them out, or remove them from configure, if
> nobody
> > steps
> > > up to maintain them. Opinions ?
> >
> > IMO, remove from configure. Or, at least make it non-automatic.
>
> It is non automatic at the moment, but it doesn't make sense to provide an
> option that when enabled cause a build failure.
>

Part of the problem is Debian seems to have a
turn-on-all-the-build-options-humanly-possible policy, so anyone rebuilding
debs for internal use (*cough* me) tends to start from the latest
Debian/Ubuntu build config and tweak as needed.

Rob :)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150319/d129ac4a/attachment-0001.html>

From Volker.Wichmann at uibk.ac.at  Thu Mar 19 03:32:17 2015
From: Volker.Wichmann at uibk.ac.at (Volker Wichmann)
Date: Thu, 19 Mar 2015 11:32:17 +0100
Subject: [gdal-dev] [GSOC] Integration of cpp GDAL utilities into GDAL
 core library
In-Reply-To: <CABRzcz9L-zeMxSry+yrTjYAPDvhRmbMrVs324yvbCTMvg-bvpA@mail.gmail.com>
References: <CABRzcz9L-zeMxSry+yrTjYAPDvhRmbMrVs324yvbCTMvg-bvpA@mail.gmail.com>
Message-ID: <550AA5B1.7010000@uibk.ac.at>

Hi Nishith,

On 03/18/2015 08:27 PM, Nishith Maheshwari wrote:
> Hi,
> I am a masters student from IIIT Hyderabad and currently in my final
> year of study and working in the Lab for Spatial Informatics here.
>
> I was a part of GSOC 2014 and worked on the project *'Schematization
> Plugin for QGIS'* last year [1][2].
>
> I am interested in the project *'Integration of cpp GDAL utilities into
> GDAL core library'* .
>
> I have already looked at a few codes of gdal utilities available in the
> 'apps' folder of the sourcecode and had a few queries -
>
> 1. From my understanding of the project description, the aim is to
> refactor the individual codes of gdal utilities by removing the main()
> and making them available in the form of functions. These functions can
> then be accessed by another function like GDALRunUtility() which can be
> used to call them individually using specific parameters. Please let me
> know if I'm thinking in the right direction.
>
> 2. If we are implementing individual functions for every utility we
> might not require a separate layer of interaction in the form of
> GDALRunUtility(). Any thoughts?

yes, the idea was to move the functionality of the gdal utilities to 
GDAL core in order to have it available directly when using the library 
and thus to facilitate their usage from "external" programs. The 
functionality should be usable with the GDALRunUtility() function. This 
would avoid e.g. a system call to a tool or code duplication which is 
currently needed in order to create a GDAL vrt for example.

It is not intended to remove the GDAL tools, but they would have to be 
reworked to just provide the parameter interface and then to call 
GDALRunUtility() themselves. The idea to have a GDALRunUtility() 
function is to have a unique entry point and common interface to all 
tool functionality.

Best regards,
Volker


>
> [1] http://hub.qgis.org/wiki/quantum-gis/nishithm
> [2] https://github.com/nishithm/schematization
>
> Regards,
> Nishith Maheshwari
> Lab for Spatial Informatics
> IIIT Hyderabad, India
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


From Elke.Ochs at erdc.dren.mil  Thu Mar 19 07:31:52 2015
From: Elke.Ochs at erdc.dren.mil (Ochs, Elke ERDC-RDE-CRREL-NH)
Date: Thu, 19 Mar 2015 14:31:52 +0000
Subject: [gdal-dev] Releasing OGR feature from memory in Java
Message-ID: <49A547E4CC0E624EB0B69B7A9B7C0A4060868972@MS-EX2VKS.erdc.dren.mil>

Hello,

What is the proper way in Java (Windows) to release a feature from memory that has been loaded from an OGR layer?

I've been using  .delete() on the feature object, but just read in an  OGR API Tutorial that DestroyFeature should be used on Windows.  I can't seem to find reference to a DestroyFeature in Java.

Regards,
Elke

Elke Ochs, P.E.
US Army ERDC-CRREL
Elke.Ochs at usace.army.mil

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150319/e2ddb6cc/attachment.html>

From even.rouault at spatialys.com  Thu Mar 19 08:52:17 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 19 Mar 2015 16:52:17 +0100
Subject: [gdal-dev] Releasing OGR feature from memory in Java
In-Reply-To: <49A547E4CC0E624EB0B69B7A9B7C0A4060868972@MS-EX2VKS.erdc.dren.mil>
References: <49A547E4CC0E624EB0B69B7A9B7C0A4060868972@MS-EX2VKS.erdc.dren.mil>
Message-ID: <1426780337.550af0b1eada9@imp.free.fr>

Elke,

Calling DestroyFeature() rather than delete is specific to C++ / Windows. For
Java, calling .delete() or doing nothing special is fine.

Quoting http://gdal.org/java/org/gdal/ogr/Feature.html#delete() :

"""
public void delete()

    Delete (in memory) a feature.

    Calling this method is not required as normal garbage collection will
reclaim associated resources when the object goes out of scope. Otherwise
calling delete() explicitely will help release resources sooner. Don't call any
method on a deleted object !
"""

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Mar 20 09:55:33 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 20 Mar 2015 17:55:33 +0100
Subject: [gdal-dev] Call for discussion on RFC 55: Refined SetFeature() and
	DeleteFeature() semantics
Message-ID: <201503201755.33621.even.rouault@spatialys.com>

Hi,

This is a call for discussion on "RFC 55: Refined SetFeature() and 
DeleteFeature() semantics".

http://trac.osgeo.org/gdal/wiki/rfc55_refined_setfeature_deletefeature_semantics

Summary :

This RFC refines the semantics of SetFeature() and DeleteFeature() so as to be 
able to distinguish nominal case, attempts of updating/deleting non-existing 
features, from failures to update/delete existing features. 

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From lucadeluge at gmail.com  Fri Mar 20 14:59:59 2015
From: lucadeluge at gmail.com (Luca Delucchi)
Date: Fri, 20 Mar 2015 22:59:59 +0100
Subject: [gdal-dev] gdal grass plugin not working
Message-ID: <CAK4m-3w_p5wK7h_ir1OjfOBCdOY_RAB856w8Afb0yOeh4aHSOg@mail.gmail.com>

Hi devs,

I have problems with the gdal grass plugin and grass70.

The first problem is with compilation I try but I had the following problem

cd gdal-grass-1.11.2/
sh configure --with-grass=$HOME/software/grass70/dist.x86_64-unknown-linux-gnu
...

config.log
configure:3017: checking for G_putenv in -lgrass_gis.7.0.svn
configure:3047: gcc -o conftest -O2    conftest.c -lgrass_gis.7.0.svn
-L/home/neteler/software/grass70/dist.x86_64-unknown-linux-gnu/lib
-lgrass_raster.7.0.svn -lgrass_gmath.7.0.svn -lgrass_gis.7.0.svn
-lgrass_datetime.7.0.svn -lgrass_gproj.7.0.svn -lgrass_vector.7.0.svn
-lgrass_dbmibase.7.0.svn -lgrass_dbmiclient.7.0.svn
-lgrass_dgl.7.0.svn -lgrass_dig2.7.0.svn -lgrass_rtree.7.0.svn
-lgrass_linkm.7.0.svn -lgrass_btree2.7.0.svn -lgrass_ccmath.7.0.svn
-L/usr/lib64 -lgdal  >&5
/usr/bin/ld: cannot find -lgrass_gis.7.0.svn
/usr/bin/ld: cannot find -lgrass_raster.7.0.svn
/usr/bin/ld: cannot find -lgrass_gmath.7.0.svn
/usr/bin/ld: cannot find -lgrass_gis.7.0.svn
/usr/bin/ld: cannot find -lgrass_datetime.7.0.svn
/usr/bin/ld: cannot find -lgrass_gproj.7.0.svn
/usr/bin/ld: cannot find -lgrass_vector.7.0.svn
/usr/bin/ld: cannot find -lgrass_dbmibase.7.0.svn
/usr/bin/ld: cannot find -lgrass_dbmiclient.7.0.svn
/usr/bin/ld: cannot find -lgrass_dgl.7.0.svn
/usr/bin/ld: cannot find -lgrass_dig2.7.0.svn
/usr/bin/ld: cannot find -lgrass_rtree.7.0.svn
/usr/bin/ld: cannot find -lgrass_linkm.7.0.svn
/usr/bin/ld: cannot find -lgrass_btree2.7.0.svn
/usr/bin/ld: cannot find -lgrass_ccmath.7.0.svn

So I patched it with the attached diff and it compiled, but it is not
working yet

gdalinfo ~/shared/grassdata/esi_location/PERMANENT/cellhd/Terrain50_UK_ed
ERROR 4: `/home/lucadelu/shared/grassdata/esi_location/PERMANENT/cellhd/Terrain50_UK_ed'
not recognised as a supported file format.

gdalinfo failed - unable to open
'/home/lucadelu/shared/grassdata/esi_location/PERMANENT/cellhd/Terrain50_UK_ed'

the lib seems compiled correctly
http://pastebin.com/vuvCGpBY

do you have any idea how to fix it?

thanks

-- 
ciao
Luca

http://gis.cri.fmach.it/delucchi/
www.lucadelu.org
-------------- next part --------------
--- ./gdal-grass-1.11.2/configure.in    2015-02-06 16:30:50.000000000 +0100
+++ gdal-grass-1.11.2_MN/configure.in   2015-03-20 22:26:05.536408317 +0100
@@ -132,9 +132,9 @@
   else

     # Check for GRASS >= 7.0
-    AC_CHECK_LIB(grass_gis.7.0.svn,G_putenv,GRASS_SETTING=grass7+,GRASS_SETTING=no,-L$with_grass/lib -lgrass_raster.7.0.svn -lgrass_gmath.7.0.svn -lgrass_gis.7.0.svn -lgrass_datetime.7.0.svn -lgrass_gproj.7.0.svn -lgrass_vector.7.0.svn -lgrass_dbmibase.7.0.svn -lgrass_dbmiclient.7.0.svn -lgrass_dgl.7.0.svn -lgrass_dig2.7.0.svn -lgrass_rtree.7.0.svn -lgrass_linkm.7.0.svn -lgrass_btree2.7.0.svn -lgrass_ccmath.7.0.svn)
+    AC_CHECK_LIB(grass_gis,G_putenv,GRASS_SETTING=grass7+,GRASS_SETTING=no,-L$with_grass/lib -lgrass_raster -lgrass_gmath -lgrass_gis -lgrass_datetime -lgrass_gproj -lgrass_vector -lgrass_dbmibase -lgrass_dbmiclient -lgrass_dgl -lgrass_dig2 -lgrass_rtree -lgrass_linkm -lgrass_btree2 -lgrass_ccmath)
     if test "$GRASS_SETTING" = "grass7+" ; then
-        LIBS="-L$with_grass/lib -lgrass_raster.7.0.svn -lgrass_gmath.7.0.svn -lgrass_gis.7.0.svn -lgrass_datetime.7.0.svn -lgrass_gproj.7.0.svn -lgrass_vector.7.0.svn -lgrass_dbmibase.7.0.svn -lgrass_dbmiclient.7.0.svn -lgrass_dgl.7.0.svn -lgrass_dig2.7.0.svn -lgrass_rtree.7.0.svn -lgrass_linkm.7.0.svn -lgrass_btree2.7.0.svn -lgrass_ccmath.7.0.svn $LIBS"
+        LIBS="-L$with_grass/lib -lgrass_raster -lgrass_gmath -lgrass_gis -lgrass_datetime -lgrass_gproj -lgrass_vector -lgrass_dbmibase -lgrass_dbmiclient -lgrass_dgl -lgrass_dig2 -lgrass_rtree -lgrass_linkm -lgrass_btree2 -lgrass_ccmath $LIBS"
         GRASS_INCLUDE="-I$with_grass/include"
         GRASS_GISBASE="$with_grass"
     else

From kmichael.aye at gmail.com  Fri Mar 20 18:16:53 2015
From: kmichael.aye at gmail.com (Michael Aye)
Date: Sat, 21 Mar 2015 01:16:53 +0000 (UTC)
Subject: [gdal-dev]
	=?utf-8?q?Wrong_number_or_type_of_arguments_for_overlo?=
	=?utf-8?q?aded=09function=27CoordinateTransformation=5FTransformPo?=
	=?utf-8?q?int=27?=
References: <22C6A8A4889F0C45B71BF3272671822E820542BC@SVNSBIOMBX01.ENT.dfo-mpo.ca>
	<54DA51FF.3020506@pobox.com>
	<22C6A8A4889F0C45B71BF3272671822E820548E3@SVNSBIOMBX01.ENT.dfo-mpo.ca>
	<201502111411.05842.even.rouault@spatialys.com>
Message-ID: <loom.20150321T020816-855@post.gmane.org>



Even Rouault <even.rouault <at> spatialys.com> writes:

> 
> Brendan,
> 
> thanks for the follow-up. I've just committed a fix so that the error 
> report is 
> hopefully clearer now:
> 
> $ python swig/python/samples/tolatlong.py 0 0 byte.png
> ERROR: Cannot import projection ''
> 
> Even
> 
I am struggling with this as well after coming back to this topic after a 
longer break. 
And while I first also found that some of my files do not have a 
projection in them, I now
have identified a file that has all required data defined and still the 
CoordinateTransform 
is breaking with the above mentioned error.

Here is my work process, see if you can find something suspicious:

import gdal
ds = gdal.Open('img.cal.map.cub')
print("proj:", ds.GetProjection())
print("GeoTrans:", ds.GetGeoTransform())
x, y = gdal.ApplyGeoTransform(ds.GetGeoTransform(), 0, 0)
print("X:{}, Y:{}".format(x, y))
import osr
srs = osr.SpatialReference(ds.GetProjection())
print(srs.ExportToPrettyWkt())
ct = osr.CoordinateTransformation(srs, srs.CloneGeogCS())
print("CoordTrans:", ct)
print(ct.TransformPoint(x, y))

This results in:


proj: PROJCS["Sinusoidal 
Mars",GEOGCS["GCS_Mars",DATUM["D_Mars",
SPHEROID["Mars",3396190,0]],
PRIMEM[
"Reference_Meridian",0],UNIT["degree",0.0174532925199433]],
PROJECTION["Sinusoidal
"],PARAMETER["longitude_of_center",296.28065864847],
PARAMETER["false_easting",0]
,PARAMETER["false_northing",0]]
GeoTrans: 
(-4959.6267029156, 0.49556621731771, 0.0, -4803213.1200085, 0.0, 
-0.49556621731771)
X:-4959.6267029156, Y:-4803213.1200085
PROJCS["Sinusoidal Mars",
    GEOGCS["GCS_Mars",
        DATUM["D_Mars",
            SPHEROID["Mars",3396190,0]],
        PRIMEM["Reference_Meridian",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Sinusoidal"],
    PARAMETER["longitude_of_center",296.28065864847],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0]]
CoordTrans: <osgeo.osr.CoordinateTransformation; proxy of None >
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)
<ipython-input-50-9e312a3e5cc7> in <module>()
     10 ct = osr.CoordinateTransformation(srs, srs.CloneGeogCS())
     11 print("CoordTrans:", ct)
---> 12 print(ct.TransformPoint(x, y))

/Users/klay6683/miniconda3/lib/python3.4/site-packages/osgeo/osr.py in 
TransformPoint(self, *args)
    793         TransformPoint(self, double x, double y, double z = 0.0)
    794         """
--> 795     return _osr.CoordinateTransformation_TransformPoint(self, *args)
    796 
    797     def TransformPoints(self, *args):

NotImplementedError: Wrong number of arguments for overloaded function 
'CoordinateTransformation_TransformPoint'.
  Possible C/C++ prototypes are:
    TransformPoint(OSRCoordinateTransformationShadow *,double [3])
    TransformPoint(OSRCoordinateTransformationShadow *,double 
[3],double,double,double)


As the function is required an array with 3 elements formally 
(but I thought I previously 
handed it only 2 and it was just working fine, assuming 0 for the 
last element) I also tried 
two more versions, one with a Python list and one with that Python 
list embedded into a 
numpy array with dtype='double', all to no avail:

print(ct.TransformPoint((x,y,0)))
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)
<ipython-input-51-3179e52dbf67> in <module>()
----> 1 print(ct.TransformPoint((x,y,0)))

/Users/klay6683/miniconda3/lib/python3.4/site-packages/osgeo/osr.py in 
TransformPoint(self, *args)
    793         TransformPoint(self, double x, double y, double z = 0.0)
    794         """
--> 795         return _osr.CoordinateTransformation_TransformPoint(self, *args)
    796 
    797     def TransformPoints(self, *args):

NotImplementedError: Wrong number of arguments for overloaded function 
'CoordinateTransformation_TransformPoint'.
  Possible C/C++ prototypes are:
    TransformPoint(OSRCoordinateTransformationShadow *,double [3])
    TransformPoint(OSRCoordinateTransformationShadow *,double 
[3],double,double,double)


print(ct.TransformPoint(np.array([x,y,0],dtype='double')))
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)
<ipython-input-52-9bad892efd2f> in <module>()
----> 1 print(ct.TransformPoint(np.array([x,y,0],dtype='double')))

/Users/klay6683/miniconda3/lib/python3.4/site-packages/osgeo/osr.py in 
TransformPoint(self, *args)
    793         TransformPoint(self, double x, double y, double z = 0.0)
    794         """
--> 795         return _osr.CoordinateTransformation_TransformPoint(self, *args)
    796 
    797     def TransformPoints(self, *args):

NotImplementedError: Wrong number of arguments for overloaded function 
'CoordinateTransformation_TransformPoint'.
  Possible C/C++ prototypes are:
    TransformPoint(OSRCoordinateTransformationShadow *,double [3])
    TransformPoint(OSRCoordinateTransformationShadow *,double 
[3],double,double,double)


This is my gdal.VersionInfo() output:

'1110200'

Any ideas?

Thanks,
Michael




From fazamhd at live.com  Sat Mar 21 04:06:31 2015
From: fazamhd at live.com (Faza Mahamood)
Date: Sat, 21 Mar 2015 16:36:31 +0530
Subject: [gdal-dev] [GSOC] PROPOSAL - Integration of GDAL utilities into
 GDAL core library
Message-ID: <SNT146-W729026B2D8412184ACA97DDE0F0@phx.gbl>

Hi,

I have submitted my proposal in the melange website.

It can be found here

https://www.google-melange.com/gsoc/proposal/review/student/google/gsoc2015/faza/5668600916475904

I would be glad if the mentors could review it and suggest the necessary improvements before the deadline.

Faza Mahamood
irc: faza
github: https://www.github.com/fazam 		 	   		  

From woodbri at swoodbridge.com  Sun Mar 22 12:18:12 2015
From: woodbri at swoodbridge.com (Stephen Woodbridge)
Date: Sun, 22 Mar 2015 15:18:12 -0400
Subject: [gdal-dev] ogr2ogr: Stuck trying to append lots of gml files to
	postgis tables
Message-ID: <550F1574.8080406@swoodbridge.com>

Hi all,

I have a directory of gml files. I can load any of them into postgis 
without a problem. What I'm having a problem with is appending each file 
to the existing tables. I'm using : GDAL 1.10.1, released 2013/08/26

$ ogrinfo raw_itn/6360199_sn6103_2c7157.gz
Had to open data source read-only.
INFO: Open of `raw_itn/6360199_sn6103_2c7157.gz'
       using driver `GML' successful.
1: Road (None)
2: RoadLink (Line String)
3: RoadNode (Point)

$ ogrinfo raw_itn/6360199_sn6101_2c5532.gz
Had to open data source read-only.
INFO: Open of `raw_itn/6360199_sn6101_2c5532.gz'
       using driver `GML' successful.
1: RoadLinkInformation (Point)
2: Road (None)
3: RoadLink (Line String)
4: RoadNodeInformation (None)
5: RoadNode (Point)

Here is want I am trying:

dropdb -U postgres -h localhost data_itn
createdb -U postgres -h localhost data_itn
psql -U postgres -h localhost data_itn -c "create extension postgis"
psql -U postgres -h localhost data_itn -c "create schema itn"
psql -U postgres -h localhost data_itn -c "alter database data_itn set 
search_path to itn, public, pg_catalog"

# this loads fine

ogr2ogr -append -f PostgreSQL PG:"host=localhost user=postgres 
dbname=data_itn" raw_itn/6360199_sn6101_2c5532.gz

# all successive tries to append to the existing tables fails

ogr2ogr -append -f PostgreSQL PG:"host=localhost user=postgres 
dbname=data_itn" raw_itn/6360199_sn6103_2c7157.gz
ERROR 1: Layer road already exists, CreateLayer failed.
Use the layer creation option OVERWRITE=YES to replace it.
ERROR 1: Terminating translation prematurely after failed
translation of layer Road (use -skipfailures to skip errors)

If I don't install extension postgis then there is no problem reported 
and it appears to load all the data by appending the tables with the 
geometry in a colum wkb_geometry::bytea.

How can I load the data into postgis. I have over 700 gml files to load.

Thanks,
   -Steve

---
This email has been checked for viruses by Avast antivirus software.
http://www.avast.com


From even.rouault at spatialys.com  Sun Mar 22 12:32:32 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 22 Mar 2015 20:32:32 +0100
Subject: [gdal-dev] ogr2ogr: Stuck trying to append lots of gml files to
	postgis tables
In-Reply-To: <550F1574.8080406@swoodbridge.com>
References: <550F1574.8080406@swoodbridge.com>
Message-ID: <201503222032.33004.even.rouault@spatialys.com>

Le dimanche 22 mars 2015 20:18:12, Stephen Woodbridge a ?crit :
> Hi all,
> 
> I have a directory of gml files. I can load any of them into postgis
> without a problem. What I'm having a problem with is appending each file
> to the existing tables. I'm using : GDAL 1.10.1, released 2013/08/26
> 
> $ ogrinfo raw_itn/6360199_sn6103_2c7157.gz
> Had to open data source read-only.
> INFO: Open of `raw_itn/6360199_sn6103_2c7157.gz'
>        using driver `GML' successful.
> 1: Road (None)
> 2: RoadLink (Line String)
> 3: RoadNode (Point)
> 
> $ ogrinfo raw_itn/6360199_sn6101_2c5532.gz
> Had to open data source read-only.
> INFO: Open of `raw_itn/6360199_sn6101_2c5532.gz'
>        using driver `GML' successful.
> 1: RoadLinkInformation (Point)
> 2: Road (None)
> 3: RoadLink (Line String)
> 4: RoadNodeInformation (None)
> 5: RoadNode (Point)
> 
> Here is want I am trying:
> 
> dropdb -U postgres -h localhost data_itn
> createdb -U postgres -h localhost data_itn
> psql -U postgres -h localhost data_itn -c "create extension postgis"
> psql -U postgres -h localhost data_itn -c "create schema itn"
> psql -U postgres -h localhost data_itn -c "alter database data_itn set
> search_path to itn, public, pg_catalog"
> 
> # this loads fine
> 
> ogr2ogr -append -f PostgreSQL PG:"host=localhost user=postgres
> dbname=data_itn" raw_itn/6360199_sn6101_2c5532.gz
> 
> # all successive tries to append to the existing tables fails
> 
> ogr2ogr -append -f PostgreSQL PG:"host=localhost user=postgres
> dbname=data_itn" raw_itn/6360199_sn6103_2c7157.gz
> ERROR 1: Layer road already exists, CreateLayer failed.
> Use the layer creation option OVERWRITE=YES to replace it.
> ERROR 1: Terminating translation prematurely after failed
> translation of layer Road (use -skipfailures to skip errors)
> 
> If I don't install extension postgis then there is no problem reported
> and it appears to load all the data by appending the tables with the
> geometry in a colum wkb_geometry::bytea.
> 
> How can I load the data into postgis. I have over 700 gml files to load.

Defining PG_LIST_ALL_TABLES=YES as environment variable should solve this. By 
default non-spatial tables are not listed when opening a PG database, and 
ogr2ogr is confused as it doesn't see the existing table as existing, so it 
tries to recreate it. With trunk, ogr2ogr & the PG driver have been improved 
so that specifying  PG_LIST_ALL_TABLES=YES is not needed in that scenario.

Wondering if we shouldn't list all tables (excluding system tables) by 
default...

> 
> Thanks,
>    -Steve
> 
> ---
> This email has been checked for viruses by Avast antivirus software.
> http://www.avast.com
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From woodbri at swoodbridge.com  Sun Mar 22 13:33:56 2015
From: woodbri at swoodbridge.com (Stephen Woodbridge)
Date: Sun, 22 Mar 2015 16:33:56 -0400
Subject: [gdal-dev] ogr2ogr: Stuck trying to append lots of gml files to
 postgis tables
In-Reply-To: <201503222032.33004.even.rouault@spatialys.com>
References: <550F1574.8080406@swoodbridge.com>
	<201503222032.33004.even.rouault@spatialys.com>
Message-ID: <550F2734.1050902@swoodbridge.com>

On 3/22/2015 3:32 PM, Even Rouault wrote:
> Le dimanche 22 mars 2015 20:18:12, Stephen Woodbridge a ?crit :
>> Hi all,
>>
>> I have a directory of gml files. I can load any of them into postgis
>> without a problem. What I'm having a problem with is appending each file
>> to the existing tables. I'm using : GDAL 1.10.1, released 2013/08/26
>>
>> $ ogrinfo raw_itn/6360199_sn6103_2c7157.gz
>> Had to open data source read-only.
>> INFO: Open of `raw_itn/6360199_sn6103_2c7157.gz'
>>         using driver `GML' successful.
>> 1: Road (None)
>> 2: RoadLink (Line String)
>> 3: RoadNode (Point)
>>
>> $ ogrinfo raw_itn/6360199_sn6101_2c5532.gz
>> Had to open data source read-only.
>> INFO: Open of `raw_itn/6360199_sn6101_2c5532.gz'
>>         using driver `GML' successful.
>> 1: RoadLinkInformation (Point)
>> 2: Road (None)
>> 3: RoadLink (Line String)
>> 4: RoadNodeInformation (None)
>> 5: RoadNode (Point)
>>
>> Here is want I am trying:
>>
>> dropdb -U postgres -h localhost data_itn
>> createdb -U postgres -h localhost data_itn
>> psql -U postgres -h localhost data_itn -c "create extension postgis"
>> psql -U postgres -h localhost data_itn -c "create schema itn"
>> psql -U postgres -h localhost data_itn -c "alter database data_itn set
>> search_path to itn, public, pg_catalog"
>>
>> # this loads fine
>>
>> ogr2ogr -append -f PostgreSQL PG:"host=localhost user=postgres
>> dbname=data_itn" raw_itn/6360199_sn6101_2c5532.gz
>>
>> # all successive tries to append to the existing tables fails
>>
>> ogr2ogr -append -f PostgreSQL PG:"host=localhost user=postgres
>> dbname=data_itn" raw_itn/6360199_sn6103_2c7157.gz
>> ERROR 1: Layer road already exists, CreateLayer failed.
>> Use the layer creation option OVERWRITE=YES to replace it.
>> ERROR 1: Terminating translation prematurely after failed
>> translation of layer Road (use -skipfailures to skip errors)
>>
>> If I don't install extension postgis then there is no problem reported
>> and it appears to load all the data by appending the tables with the
>> geometry in a colum wkb_geometry::bytea.
>>
>> How can I load the data into postgis. I have over 700 gml files to load.
>
> Defining PG_LIST_ALL_TABLES=YES as environment variable should solve this. By
> default non-spatial tables are not listed when opening a PG database, and
> ogr2ogr is confused as it doesn't see the existing table as existing, so it
> tries to recreate it. With trunk, ogr2ogr & the PG driver have been improved
> so that specifying  PG_LIST_ALL_TABLES=YES is not needed in that scenario.
>
> Wondering if we shouldn't list all tables (excluding system tables) by
> default...

Thank you this is a very helpful response. I saw the 
PG_LIST_ALL_TABLES=YES in the documentation, but but never connect that 
with this problem.

If there is not a huge downside to listing all tables I can't see that 
it is a problem because it only happens once after a connection. Or 
maybe it only needs to be done if -append is set.

Anyway, Thanks for the help with this.

-Steve

>>
>> Thanks,
>>     -Steve
>>
>> ---
>> This email has been checked for viruses by Avast antivirus software.
>> http://www.avast.com
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


---
This email has been checked for viruses by Avast antivirus software.
http://www.avast.com


From sault.don at gmail.com  Sun Mar 22 18:10:51 2015
From: sault.don at gmail.com (Saulteau Don)
Date: Sun, 22 Mar 2015 18:10:51 -0700
Subject: [gdal-dev] ogr2ogr: Stuck trying to append lots of gml files to
 postgis tables
In-Reply-To: <550F2734.1050902@swoodbridge.com>
References: <550F1574.8080406@swoodbridge.com>
	<201503222032.33004.even.rouault@spatialys.com>
	<550F2734.1050902@swoodbridge.com>
Message-ID: <CAJo0jfNX9wGwwYhytV+CveppjTHqR6c31zEAhwfG=GP-n8=q7A@mail.gmail.com>

I wonder if part of the problem is that you haven't included the -update
flag as well in the ogr2ogr command.

ogr2ogr -update -append -f PostgreSQL PG:"host=localhost user=postgres
dbname=data_itn" raw_itn/6360199_sn6103_2c7157.gz

Then like the warning says, there's also the lco option of -lco
OVERWRITE=YES
Which also overwrites an existing layer, but it will retain any VIEWS in
the postgresql database that are built using the layer you're appending or
updating.



Donovan



On Sun, Mar 22, 2015 at 1:33 PM, Stephen Woodbridge <woodbri at swoodbridge.com
> wrote:

> On 3/22/2015 3:32 PM, Even Rouault wrote:
>
>> Le dimanche 22 mars 2015 20:18:12, Stephen Woodbridge a ?crit :
>>
>>> Hi all,
>>>
>>> I have a directory of gml files. I can load any of them into postgis
>>> without a problem. What I'm having a problem with is appending each file
>>> to the existing tables. I'm using : GDAL 1.10.1, released 2013/08/26
>>>
>>> $ ogrinfo raw_itn/6360199_sn6103_2c7157.gz
>>> Had to open data source read-only.
>>> INFO: Open of `raw_itn/6360199_sn6103_2c7157.gz'
>>>         using driver `GML' successful.
>>> 1: Road (None)
>>> 2: RoadLink (Line String)
>>> 3: RoadNode (Point)
>>>
>>> $ ogrinfo raw_itn/6360199_sn6101_2c5532.gz
>>> Had to open data source read-only.
>>> INFO: Open of `raw_itn/6360199_sn6101_2c5532.gz'
>>>         using driver `GML' successful.
>>> 1: RoadLinkInformation (Point)
>>> 2: Road (None)
>>> 3: RoadLink (Line String)
>>> 4: RoadNodeInformation (None)
>>> 5: RoadNode (Point)
>>>
>>> Here is want I am trying:
>>>
>>> dropdb -U postgres -h localhost data_itn
>>> createdb -U postgres -h localhost data_itn
>>> psql -U postgres -h localhost data_itn -c "create extension postgis"
>>> psql -U postgres -h localhost data_itn -c "create schema itn"
>>> psql -U postgres -h localhost data_itn -c "alter database data_itn set
>>> search_path to itn, public, pg_catalog"
>>>
>>> # this loads fine
>>>
>>> ogr2ogr -append -f PostgreSQL PG:"host=localhost user=postgres
>>> dbname=data_itn" raw_itn/6360199_sn6101_2c5532.gz
>>>
>>> # all successive tries to append to the existing tables fails
>>>
>>> ogr2ogr -append -f PostgreSQL PG:"host=localhost user=postgres
>>> dbname=data_itn" raw_itn/6360199_sn6103_2c7157.gz
>>> ERROR 1: Layer road already exists, CreateLayer failed.
>>> Use the layer creation option OVERWRITE=YES to replace it.
>>> ERROR 1: Terminating translation prematurely after failed
>>> translation of layer Road (use -skipfailures to skip errors)
>>>
>>> If I don't install extension postgis then there is no problem reported
>>> and it appears to load all the data by appending the tables with the
>>> geometry in a colum wkb_geometry::bytea.
>>>
>>> How can I load the data into postgis. I have over 700 gml files to load.
>>>
>>
>> Defining PG_LIST_ALL_TABLES=YES as environment variable should solve
>> this. By
>> default non-spatial tables are not listed when opening a PG database, and
>> ogr2ogr is confused as it doesn't see the existing table as existing, so
>> it
>> tries to recreate it. With trunk, ogr2ogr & the PG driver have been
>> improved
>> so that specifying  PG_LIST_ALL_TABLES=YES is not needed in that scenario.
>>
>> Wondering if we shouldn't list all tables (excluding system tables) by
>> default...
>>
>
> Thank you this is a very helpful response. I saw the
> PG_LIST_ALL_TABLES=YES in the documentation, but but never connect that
> with this problem.
>
> If there is not a huge downside to listing all tables I can't see that it
> is a problem because it only happens once after a connection. Or maybe it
> only needs to be done if -append is set.
>
> Anyway, Thanks for the help with this.
>
> -Steve
>
>
>
>>> Thanks,
>>>     -Steve
>>>
>>> ---
>>> This email has been checked for viruses by Avast antivirus software.
>>> http://www.avast.com
>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>
>>
>
> ---
> This email has been checked for viruses by Avast antivirus software.
> http://www.avast.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150322/9c42569e/attachment.html>

From woodbri at swoodbridge.com  Sun Mar 22 18:42:50 2015
From: woodbri at swoodbridge.com (Stephen Woodbridge)
Date: Sun, 22 Mar 2015 21:42:50 -0400
Subject: [gdal-dev] ogr2ogr: Stuck trying to append lots of gml files to
 postgis tables
In-Reply-To: <CAJo0jfNX9wGwwYhytV+CveppjTHqR6c31zEAhwfG=GP-n8=q7A@mail.gmail.com>
References: <550F1574.8080406@swoodbridge.com>	<201503222032.33004.even.rouault@spatialys.com>	<550F2734.1050902@swoodbridge.com>
	<CAJo0jfNX9wGwwYhytV+CveppjTHqR6c31zEAhwfG=GP-n8=q7A@mail.gmail.com>
Message-ID: <550F6F9A.5060708@swoodbridge.com>

No, I tried that also, but thank you for the suggestion. Running the 
command like this resolved the problem as Even suggested.

PG_LIST_ALL_TABLES=YES ogr2ogr -update -append -f PostgreSQL 
PG:"host=localhost user=postgres dbname=data_itn" 
raw_itn/6360199_sn6103_2c7157.__gz

Thanks,
   -Steve

On 3/22/2015 9:10 PM, Saulteau Don wrote:
> I wonder if part of the problem is that you haven't included the -update
> flag as well in the ogr2ogr command.
>
> ogr2ogr -update -append -f PostgreSQL PG:"host=localhost user=postgres
> dbname=data_itn" raw_itn/6360199_sn6103_2c7157.__gz
>
> Then like the warning says, there's also the lco option of -lco
> OVERWRITE=YES
> Which also overwrites an existing layer, but it will retain any VIEWS in
> the postgresql database that are built using the layer you're appending
> or updating.
>
>
>
> Donovan
>
>
>
> On Sun, Mar 22, 2015 at 1:33 PM, Stephen Woodbridge
> <woodbri at swoodbridge.com <mailto:woodbri at swoodbridge.com>> wrote:
>
>     On 3/22/2015 3:32 PM, Even Rouault wrote:
>
>         Le dimanche 22 mars 2015 20:18:12, Stephen Woodbridge a ?crit :
>
>             Hi all,
>
>             I have a directory of gml files. I can load any of them into
>             postgis
>             without a problem. What I'm having a problem with is
>             appending each file
>             to the existing tables. I'm using : GDAL 1.10.1, released
>             2013/08/26
>
>             $ ogrinfo raw_itn/6360199_sn6103_2c7157.__gz
>             Had to open data source read-only.
>             INFO: Open of `raw_itn/6360199_sn6103___2c7157.gz'
>                      using driver `GML' successful.
>             1: Road (None)
>             2: RoadLink (Line String)
>             3: RoadNode (Point)
>
>             $ ogrinfo raw_itn/6360199_sn6101_2c5532.__gz
>             Had to open data source read-only.
>             INFO: Open of `raw_itn/6360199_sn6101___2c5532.gz'
>                      using driver `GML' successful.
>             1: RoadLinkInformation (Point)
>             2: Road (None)
>             3: RoadLink (Line String)
>             4: RoadNodeInformation (None)
>             5: RoadNode (Point)
>
>             Here is want I am trying:
>
>             dropdb -U postgres -h localhost data_itn
>             createdb -U postgres -h localhost data_itn
>             psql -U postgres -h localhost data_itn -c "create extension
>             postgis"
>             psql -U postgres -h localhost data_itn -c "create schema itn"
>             psql -U postgres -h localhost data_itn -c "alter database
>             data_itn set
>             search_path to itn, public, pg_catalog"
>
>             # this loads fine
>
>             ogr2ogr -append -f PostgreSQL PG:"host=localhost user=postgres
>             dbname=data_itn" raw_itn/6360199_sn6101_2c5532.__gz
>
>             # all successive tries to append to the existing tables fails
>
>             ogr2ogr -append -f PostgreSQL PG:"host=localhost user=postgres
>             dbname=data_itn" raw_itn/6360199_sn6103_2c7157.__gz
>             ERROR 1: Layer road already exists, CreateLayer failed.
>             Use the layer creation option OVERWRITE=YES to replace it.
>             ERROR 1: Terminating translation prematurely after failed
>             translation of layer Road (use -skipfailures to skip errors)
>
>             If I don't install extension postgis then there is no
>             problem reported
>             and it appears to load all the data by appending the tables
>             with the
>             geometry in a colum wkb_geometry::bytea.
>
>             How can I load the data into postgis. I have over 700 gml
>             files to load.
>
>
>         Defining PG_LIST_ALL_TABLES=YES as environment variable should
>         solve this. By
>         default non-spatial tables are not listed when opening a PG
>         database, and
>         ogr2ogr is confused as it doesn't see the existing table as
>         existing, so it
>         tries to recreate it. With trunk, ogr2ogr & the PG driver have
>         been improved
>         so that specifying  PG_LIST_ALL_TABLES=YES is not needed in that
>         scenario.
>
>         Wondering if we shouldn't list all tables (excluding system
>         tables) by
>         default...
>
>
>     Thank you this is a very helpful response. I saw the
>     PG_LIST_ALL_TABLES=YES in the documentation, but but never connect
>     that with this problem.
>
>     If there is not a huge downside to listing all tables I can't see
>     that it is a problem because it only happens once after a
>     connection. Or maybe it only needs to be done if -append is set.
>
>     Anyway, Thanks for the help with this.
>
>     -Steve
>
>
>
>             Thanks,
>                  -Steve
>
>             ---
>             This email has been checked for viruses by Avast antivirus
>             software.
>             http://www.avast.com
>
>             _________________________________________________
>             gdal-dev mailing list
>             gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>             http://lists.osgeo.org/__mailman/listinfo/gdal-dev
>             <http://lists.osgeo.org/mailman/listinfo/gdal-dev>
>
>
>
>
>     ---
>     This email has been checked for viruses by Avast antivirus software.
>     http://www.avast.com
>
>     _________________________________________________
>     gdal-dev mailing list
>     gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>     http://lists.osgeo.org/__mailman/listinfo/gdal-dev
>     <http://lists.osgeo.org/mailman/listinfo/gdal-dev>
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


---
This email has been checked for viruses by Avast antivirus software.
http://www.avast.com


From garethgrewcock at gmail.com  Mon Mar 23 03:03:54 2015
From: garethgrewcock at gmail.com (Gareth Grewcock)
Date: Mon, 23 Mar 2015 10:03:54 +0000
Subject: [gdal-dev] Hillshade | Raster Band Rendering
In-Reply-To: <op.xvpg39gadbaoe8@macmarilu>
References: <CAMEt-j9-sgG6NovE4Fk6oiDRq1X=02gvpLWwHkSBSwLp=4HzuA@mail.gmail.com>
	<op.xvpg39gadbaoe8@macmarilu>
Message-ID: <CAMEt-j8r1D_GfP5iQTW+5+1bAFzEqMyLB0eKnjkWP-wHReat0A@mail.gmail.com>

Hi - I really appreciate all of your help so far. I am still looking into
this though but will get back to you as soon as I have a solution.

Cheers - Gareth

On Wed, Mar 18, 2015 at 6:17 PM, Joaquim Luis <jluis at ualg.pt> wrote:

>  My objective is to create a hillshaded color-relief image of a DEM using
> commandline/programmatic means only, so the process can be automated and
> combined within an existing GMT/GDAL workflow.
>
>
> If your workflow includes GMT that you have a reach panoply of methods to
> do shade illuminations. See man pages of grdgradient and grdhisteq.
>
> Joaquim
>
>
>
> Currently, I can generate both hillshaded and color-relief rasters using
> gdaldem and combine them with Mapnik (using opacity) to generate a my final
> rendered image. However, this process will use the min-max values in the
> grayscale hillshaded image.
>
>
>
> However, I can achieve an improved or sharper hillshaded image when I
> manually use QGIS to further process the hillshaded image by:
>
> 1. Adding the hillshaded raster to QGIS, which applies by default the
> 'Cumulative count cut 2% - 98%' style.
>
> 2. Then export the hillshaded raster (with the cumulative count style
> applied) as a ?Rendered Image?.
>
>
>
> I have annotated a screenshot here
> https://www.dropbox.com/s/ftzk7j2bmznuvjn/raster_band_rendering.png?dl=0
> hopefully illustrating the
>
> 1.    Improved hillshaded raster output from QGIS ('Cumulative count cut)
> compared with,
>
> 2.    gdal+mapnik output (using min-max)
>
>
>
> So, is there an approach using gdal (or similar command-line tool/app) to
> achieve the ?improved? hillshaded raster without the ?manual? QGIS step?
>
>
>
> As I see it, my options are:
>
> 1. Use gdalinfo with the ?-hist? option to export the histogram of the
> hillshaded raster. I guess then I could maybe calculate the 2% and 98%
> percentile(?) values and then manipulate the raster values using
> gdal_calc.py or something else.  However, I?m no statistician, so hoped
> there would be an out of the box solution?!
>
> 2. Maybe, I could use the python api for QGIS to import the hillshade,
> render, style and export back out. I?m sure this is possible, but would
> require an additional python script.
>
> 3. Use another library or framework to achieve either of the above. I?ve
> researched python?s numpy library, which maybe I could do the percentage
> calculation directly on the raster. Again, potentially tricky learning
> curve there?
>
>
>
> Any help or advice would greatly appreciated. If any help, the data I?m
> using is here
> https://www.dropbox.com/s/v0peaa3rzaqbhen/raster_band_rendering.zip?dl=0
>
>
>
> Cheers
>
>
> Gareth
>
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150323/693a9102/attachment.html>

From bingoyinhappy at 163.com  Mon Mar 23 04:33:31 2015
From: bingoyinhappy at 163.com (bingoyinhappy at 163.com)
Date: Mon, 23 Mar 2015 19:33:31 +0800
Subject: [gdal-dev] No VSIGetMemFileBuffer Method in java gdal
Message-ID: <2015032319333102322512@163.com>

Hi devs,
    In C++ gdal?VSIGetMemFileBuffer can convert /vsimem/** file to byte[], but I can not find corresponding method in java gdal. What can I do to use it in java?

thanks

bing



bingoyinhappy at 163.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150323/7db4fc1f/attachment.html>

From vesnikos at gmail.com  Mon Mar 23 05:48:30 2015
From: vesnikos at gmail.com (Nick Ves)
Date: Mon, 23 Mar 2015 14:48:30 +0200
Subject: [gdal-dev] SD file format
Message-ID: <CADCcPvvpXQog7qYnAaxvFvOOZMwe6L2YSoaKtd1R2LioSGbFWw@mail.gmail.com>

>From gis SE site [0] :

"I downliaded a SD file from here:
http://portal.emodnet-hydrography.eu/geographic-grid How can I open it
in QGIS?"

gdalinfo fails to open the file. Anyone has seen the the format before?

[0] http://gis.stackexchange.com/questions/139936/can-a-sd-file-format-be-opened-in-qgis

From jukka.rahkonen at maanmittauslaitos.fi  Mon Mar 23 06:16:38 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Mon, 23 Mar 2015 13:16:38 +0000 (UTC)
Subject: [gdal-dev] SD file format
References: <CADCcPvvpXQog7qYnAaxvFvOOZMwe6L2YSoaKtd1R2LioSGbFWw@mail.gmail.com>
Message-ID: <loom.20150323T141235-433@post.gmane.org>

Nick Ves <vesnikos <at> gmail.com> writes:

> 
> From gis SE site [0] :
> 
> "I downliaded a SD file from here:
> http://portal.emodnet-hydrography.eu/geographic-grid How can I open it
> in QGIS?"
> 
> gdalinfo fails to open the file. Anyone has seen the the format before?
> 
> [0]
http://gis.stackexchange.com/questions/139936/can-a-sd-file-format-be-opened-in-qgis

Hi,

Reading http://portal.emodnet-hydrography.eu/help/help.html#006 
Format is "Fledermaus SD"

More info:
"SD files:
The SD files can be viewed in the QPS 3D Fledermaus application or in the
iView4D viewer, which is available as a free download"

Download link is dead but read the Fledermaus site for further information
http://www.qps.nl/display/fledermaus/main.

-Jukka Rahkonen-



From even.rouault at spatialys.com  Mon Mar 23 08:25:30 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 23 Mar 2015 16:25:30 +0100
Subject: [gdal-dev] Pg Table Listing
In-Reply-To: <etPan.5509bd03.7fdcc233.6393@Crane.local>
References: <etPan.5509a590.41b71efb.6393@Crane.local>
	<etPan.5509b599.66ef438d.6393@Crane.local>
	<etPan.5509bd03.7fdcc233.6393@Crane.local>
Message-ID: <201503231625.30695.even.rouault@spatialys.com>

Le mercredi 18 mars 2015 18:59:28, Paul Ramsey a ?crit :
> With 1000 tables, the disparity is 300ms for the join on geometry_columns
> and 30ms for the straight system table query.

On my system, just "select * from geometry_columns" with 1000 tables takes ~ 
800 ms. Digging more into the definition of the view, what is super costly in 
fact is the evaluation of postgis_constraint_dims(), postgis_constraint_srid() 
and postgis_constraint_type(), because each causes a SELECT to be executed for 
each row if some typmod constraints are missing. I guess this could have, at 
worst, quadratic performance performance in case no/little index are 
available.

The following request gives similar information but in ~ 80 ms:

select c.relname, 
       a.attname,
       t.typname,
       postgis_typmod_dims(a.atttypmod) dim,
       postgis_typmod_srid(a.atttypmod) srid,
       postgis_typmod_type(a.atttypmod)::text typ,
       array_agg(s.consrc)::text
FROM pg_class c join pg_attribute a on a.attrelid=c.oid
                join pg_namespace n on c.relnamespace = n.oid
                AND (c.relkind = 'r'::"char" OR c.relkind = 'v'::"char" OR 
c.relkind = 'm'::"char" OR c.relkind = 'f'::"char")
                AND NOT ( n.nspname = 'public' AND c.relname = 
'raster_columns' )
                join pg_type t on a.atttypid = t.oid and (t.typname = 
'geometry'::name OR t.typname = 'geography'::name)
                left join pg_constraint s on s.connamespace = n.oid AND 
s.conrelid = c.oid
                          AND a.attnum = ANY (s.conkey)
                          AND (s.consrc LIKE '%geometrytype(% = %' OR s.consrc 
LIKE '%ndims(% = %' OR s.consrc LIKE '%srid(% = %')
GROUP BY c.relname, a.attname, t.typname, dim, srid, typ, c.oid
ORDER BY c.oid

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From strk at keybit.net  Mon Mar 23 09:16:17 2015
From: strk at keybit.net (Sandro Santilli)
Date: Mon, 23 Mar 2015 17:16:17 +0100
Subject: [gdal-dev] Pg Table Listing
In-Reply-To: <201503231625.30695.even.rouault@spatialys.com>
References: <etPan.5509a590.41b71efb.6393@Crane.local>
	<etPan.5509b599.66ef438d.6393@Crane.local>
	<etPan.5509bd03.7fdcc233.6393@Crane.local>
	<201503231625.30695.even.rouault@spatialys.com>
Message-ID: <20150323161617.GA20204@localhost>

On Mon, Mar 23, 2015 at 04:25:30PM +0100, Even Rouault wrote:
> Le mercredi 18 mars 2015 18:59:28, Paul Ramsey a ?crit :
> > With 1000 tables, the disparity is 300ms for the join on geometry_columns
> > and 30ms for the straight system table query.
> 
> On my system, just "select * from geometry_columns" with 1000 tables takes ~ 
> 800 ms. Digging more into the definition of the view, what is super costly in 
> fact is the evaluation of postgis_constraint_dims(), postgis_constraint_srid() 
> and postgis_constraint_type(), because each causes a SELECT to be executed for 
> each row if some typmod constraints are missing. I guess this could have, at 
> worst, quadratic performance performance in case no/little index are 
> available.
> 
> The following request gives similar information but in ~ 80 ms:

Now we're talking ! :)
Thanks for looking at it, Even.
Sounds worth a ticket on PostGIS to optimize that query.

--strk; 

From simonf at google.com  Mon Mar 23 15:46:19 2015
From: simonf at google.com (Simon (Vsevolod) Ilyushchenko)
Date: Mon, 23 Mar 2015 15:46:19 -0700
Subject: [gdal-dev] How to check whether a GRIB file uses a sphere or a
	spheroid?
In-Reply-To: <CA+YzLBeZad-1vMwhAOn9F0+WqHKME_vVU4grDQ3=LSx1+1RRhw@mail.gmail.com>
References: <CAM_aJuSfttynMyyp8E=pftTnUNzJ5wc0NZfe22GYJSKJux89KQ@mail.gmail.com>
	<CA+YzLBeZad-1vMwhAOn9F0+WqHKME_vVU4grDQ3=LSx1+1RRhw@mail.gmail.com>
Message-ID: <CAM_aJuQvQ4NhRDxvhdkbLThEWAUZNF6+jc3zdGHy7N8ECypxYw@mail.gmail.com>

Turns out the GDAL driver is doing the right thing. However, many other
tools that read GRIB files default to using the spheroid regardless of what
the files specify. Consequently, many data providers don't bother switching
this setting from the default sphere to the spheroid. We tried to use the
sphere instead of the intended spheroid, which was the wrong thing to do
for the dataset in question.

On Wed, Mar 11, 2015 at 5:17 PM, Frank Warmerdam <warmerdam at pobox.com>
wrote:

> Simon,
>
> I skimmed the code and there is no actual datum support in the grib
> reader.  It does attempt to differentiate between ellipsoids and spheres so
> I assume the file actually did record things as a sphere.  Generally
> speaking it is not clear to me that the GRIB driver can actually do better
> based on the information in the files but I'd be happy to be proven wrong.
> In the meantime, it appears you will need to overwrite the geographic
> coordinate system in your ingestor.
>
> Best regards,
> Frank
>
>
> On Wed, Mar 11, 2015 at 1:25 PM, Simon (Vsevolod) Ilyushchenko <
> simonf at google.com> wrote:
>
>> Hi,
>>
>> If I use GDAL to read GRIB files like these:
>>
>> ftp://hydro1.sci.gsfc.nasa.gov/data/s4pa/NLDAS/NLDAS_NOAH0125_H.002/2015/065/NLDAS_NOAH0125_H.A20150306.1300.002.grb
>>
>> the CRS I get back is:
>> GEOGCS["Coordinate System imported from GRIB file",
>>     DATUM["unknown",
>>         SPHEROID["Sphere",6371200,0]],
>>     PRIMEM["Greenwich",0],
>>     UNIT["degree",0.0174532925199433]]
>>
>> Plotting these files shows that they are shifted 1.5 pixels north, but
>> setting CRS to EPSG:4326 that uses SPHEROID["WGS 84",6378137,298.257223563
>> instead fixes the issue.
>>
>> I'm trying to understand whether the source files incorrectly specifies
>> that it's a sphere, or whether the GDAL driver is wrong, but I cannot find
>> a GRIB reader that would show me this information about the file. What's
>> the best way to debug this?
>>
>> Thanks,
>> Simon
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>
> --
>
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam at pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Software Developer
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150323/168860e9/attachment.html>

From ChiefDan at gmail.com  Mon Mar 23 15:55:32 2015
From: ChiefDan at gmail.com (ChiefDan)
Date: Mon, 23 Mar 2015 15:55:32 -0700 (PDT)
Subject: [gdal-dev] GDAL C++ Api, create new line segments from point layer
Message-ID: <1427151332823-5195061.post@n6.nabble.com>

I am trying to create a pathfinding graph from a shapefile with a line layer
and point layer. 

Using the C++ API, for each point in the points layer, I need to find the
next N points that are connected to that point along one or more
OGRLineStrings. I've been able to determine which OGRLineString in the
OGRMultiLineString a point from the points layer is on. I'd be creating new
line segments with these neighboring points as the start/end point and this
would be the path pair for the pathing as well.

I am not sure how to determine what point(s) from the points layer are next
on the line. Using the Distance() to compare won't work since a point could
be within the radius, but not on a line that would directly connect the 2
points.

I appreciate any pointers.


Dan



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/GDAL-C-Api-create-new-line-segments-from-point-layer-tp5195061.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From ChiefDan at gmail.com  Mon Mar 23 17:13:05 2015
From: ChiefDan at gmail.com (ChiefDan)
Date: Mon, 23 Mar 2015 17:13:05 -0700 (PDT)
Subject: [gdal-dev] GDAL C++ Api,
	create new line segments from point layer
In-Reply-To: <1427151332823-5195061.post@n6.nabble.com>
References: <1427151332823-5195061.post@n6.nabble.com>
Message-ID: <1427155985670-5195070.post@n6.nabble.com>

Would GEOS be a more appropriate library to use? GDAL was my goto due to
familiarity.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/GDAL-C-Api-create-new-line-segments-from-point-layer-tp5195061p5195070.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From jukka.rahkonen at maanmittauslaitos.fi  Mon Mar 23 23:08:03 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Tue, 24 Mar 2015 06:08:03 +0000 (UTC)
Subject: [gdal-dev] GDAL C++ Api,
	create new line segments from point layer
References: <1427151332823-5195061.post@n6.nabble.com>
Message-ID: <loom.20150324T070617-744@post.gmane.org>

ChiefDan <ChiefDan <at> gmail.com> writes:

> 
> I am trying to create a pathfinding graph from a shapefile with a line layer
> and point layer. 

Hi,

Have you already studied
http://trac.osgeo.org/gdal/wiki/rfc48_geographical_networks_support?

-Jukka Rahkonen-



From ChiefDan at gmail.com  Tue Mar 24 02:09:35 2015
From: ChiefDan at gmail.com (ChiefDan)
Date: Tue, 24 Mar 2015 02:09:35 -0700 (PDT)
Subject: [gdal-dev] GDAL C++ Api,
	create new line segments from point layer
In-Reply-To: <loom.20150324T070617-744@post.gmane.org>
References: <1427151332823-5195061.post@n6.nabble.com>
	<loom.20150324T070617-744@post.gmane.org>
Message-ID: <1427188175860-5195113.post@n6.nabble.com>

Yes, I've experimented with that library and actually asked a follow up
question here about it. To properly use it, I need to prepare the layer in
the manner I am asking about.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/GDAL-C-Api-create-new-line-segments-from-point-layer-tp5195061p5195113.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Tue Mar 24 02:34:28 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 24 Mar 2015 10:34:28 +0100
Subject: [gdal-dev] Ruby bindings
In-Reply-To: <1426719314.550a025227249@imp.free.fr>
References: <1426719314.550a025227249@imp.free.fr>
Message-ID: <201503241034.28396.even.rouault@spatialys.com>

Le mercredi 18 mars 2015 23:55:14, Even Rouault a ?crit :
> Hi,
> 
> The build of Ruby bindings is broken in trunk. See
> http://trac.osgeo.org/gdal/ticket/5880
> 
> The situation is that, in years, nobody has really maintained them, so it
> isn't even sure that they work at runtime once compilation issues are
> fixed. So we might just have to wipe them out, or remove them from
> configure, if nobody steps up to maintain them. Opinions ?

No interested party having popped up, per 
http://trac.osgeo.org/gdal/changeset/28756 , the Ruby are now removed from 
autoconf and makefile support.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Tue Mar 24 06:14:25 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Tue, 24 Mar 2015 13:14:25 +0000 (UTC)
Subject: [gdal-dev] New error messages when writing Spatialite
Message-ID: <loom.20150324T141054-854@post.gmane.org>

Hi,

I noticed that ogr2ogr from GDAL 2.0-dev is nowadays printing error messages
which I have not seen before:

"CreateSpatialIndex() error: either "points"."GEOMETRY" isn't a Geometry
column or a SpatialIndex is already defined"

Conversion works OK but messages make some unnecessary noise. It looks there
comes a new message per every COMMIT;

-Jukka Rahkonen-


From even.rouault at spatialys.com  Tue Mar 24 06:38:51 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 24 Mar 2015 14:38:51 +0100
Subject: [gdal-dev] New error messages when writing Spatialite
In-Reply-To: <loom.20150324T141054-854@post.gmane.org>
References: <loom.20150324T141054-854@post.gmane.org>
Message-ID: <201503241438.51617.even.rouault@spatialys.com>

Le mardi 24 mars 2015 14:14:25, Jukka Rahkonen a ?crit :
> Hi,
> 
> I noticed that ogr2ogr from GDAL 2.0-dev is nowadays printing error
> messages which I have not seen before:
> 
> "CreateSpatialIndex() error: either "points"."GEOMETRY" isn't a Geometry
> column or a SpatialIndex is already defined"
> 
> Conversion works OK but messages make some unnecessary noise. It looks
> there comes a new message per every COMMIT;

Hi Jukka,

Now fixed in trunk.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Tue Mar 24 06:54:16 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Tue, 24 Mar 2015 13:54:16 +0000
Subject: [gdal-dev] New error messages when writing Spatialite
Message-ID: <d01f3f676eca4b04b932723ddb9fd81b@C119S212VM022.msvyvi.vaha.local>

Even Rouault wrote:

> Le mardi 24 mars 2015 14:14:25, Jukka Rahkonen a ?crit :
>> Hi,
>> 
>> I noticed that ogr2ogr from GDAL 2.0-dev is nowadays printing error 
>> messages which I have not seen before:
>> 
>> "CreateSpatialIndex() error: either "points"."GEOMETRY" isn't a 
>> Geometry column or a SpatialIndex is already defined"
>> 
>> Conversion works OK but messages make some unnecessary noise. It looks 
>> there comes a new message per every COMMIT;

> Hi Jukka,

> Now fixed in trunk.

Did the error also mean that deferred creation of spatial index did not work but the index was created right ahead which makes initial insert slower?

-Jukka-

From even.rouault at spatialys.com  Tue Mar 24 07:14:35 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 24 Mar 2015 15:14:35 +0100
Subject: [gdal-dev] New error messages when writing Spatialite
In-Reply-To: <d01f3f676eca4b04b932723ddb9fd81b@C119S212VM022.msvyvi.vaha.local>
References: <d01f3f676eca4b04b932723ddb9fd81b@C119S212VM022.msvyvi.vaha.local>
Message-ID: <201503241514.35409.even.rouault@spatialys.com>

Le mardi 24 mars 2015 14:54:16, Rahkonen Jukka (MML) a ?crit :
> Even Rouault wrote:
> > Le mardi 24 mars 2015 14:14:25, Jukka Rahkonen a ?crit :
> >> Hi,
> >> 
> >> I noticed that ogr2ogr from GDAL 2.0-dev is nowadays printing error
> >> messages which I have not seen before:
> >> 
> >> "CreateSpatialIndex() error: either "points"."GEOMETRY" isn't a
> >> Geometry column or a SpatialIndex is already defined"
> >> 
> >> Conversion works OK but messages make some unnecessary noise. It looks
> >> there comes a new message per every COMMIT;
> > 
> > Hi Jukka,
> > 
> > Now fixed in trunk.
> 
> Did the error also mean that deferred creation of spatial index did not
> work but the index was created right ahead which makes initial insert
> slower?

No, the error was due to the spatial index being attempted to create twice, 
the first one when ogr2ogr commits the dataset transaction, and the other one 
when it closes the datasource.
I've actually just added an extra changeset since if there are more than 20000 
features, the creation of the spatial index at COMMIT time would actually slow 
down things.

> 
> -Jukka-
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Tue Mar 24 07:42:31 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Tue, 24 Mar 2015 14:42:31 +0000 (UTC)
Subject: [gdal-dev] New error messages when writing Spatialite
References: <d01f3f676eca4b04b932723ddb9fd81b@C119S212VM022.msvyvi.vaha.local>
	<201503241514.35409.even.rouault@spatialys.com>
Message-ID: <loom.20150324T153302-93@post.gmane.org>

Even Rouault <even.rouault <at> spatialys.com> writes:


> I've actually just added an extra changeset since if there are more than
20000 
> features, the creation of the spatial index at COMMIT time would actually
slow 
> down things.


I know, I was just experimenting with 12 GB OSM pbf file. Without index the
initial conversion is more than 10 times faster and in addition by creating
the spatial index as final step the SQLite database will be much less
fragmented.

-Jukka-


From matt.a.hanson at gmail.com  Tue Mar 24 08:03:58 2015
From: matt.a.hanson at gmail.com (Matt Hanson)
Date: Tue, 24 Mar 2015 11:03:58 -0400
Subject: [gdal-dev] GDAL C++ Api,
	create new line segments from point layer
In-Reply-To: <1427188175860-5195113.post@n6.nabble.com>
References: <1427151332823-5195061.post@n6.nabble.com>
	<loom.20150324T070617-744@post.gmane.org>
	<1427188175860-5195113.post@n6.nabble.com>
Message-ID: <CAGYeuZ=fWqKxTq-qUA8W+SrbvzwCFm3QAeVtVpsSP2BJupUbQQ@mail.gmail.com>

ChiefDan,

If I understand the problem correctly...

If you get the OGRGeometry of your line string (get the WKT from that or
somehow turn into an array or list that is easy to work with) you will have
all the points in order along the line.  Then, you'll need to find your
initial point of interest.  Once you find that match you can traverse up or
down the array.

matt



On Tue, Mar 24, 2015 at 5:09 AM, ChiefDan <ChiefDan at gmail.com> wrote:

> Yes, I've experimented with that library and actually asked a follow up
> question here about it. To properly use it, I need to prepare the layer in
> the manner I am asking about.
>
>
>
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/GDAL-C-Api-create-new-line-segments-from-point-layer-tp5195061p5195113.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150324/37e1c9bc/attachment.html>

From gusevmihs at gmail.com  Tue Mar 24 10:42:43 2015
From: gusevmihs at gmail.com (Mikhail Gusev)
Date: Tue, 24 Mar 2015 21:42:43 +0400
Subject: [gdal-dev] RFC 48: Geographical networks support
In-Reply-To: <54107FB7.6000604@gmail.com>
References: <CAJB43VoQhuC-HiAvq8MDC_RoaP4KjSZf3ShbL=zsvpyUQ7gecQ@mail.gmail.com>
	<201409082155.56976.even.rouault@spatialys.com>
	<CAJB43VoiMB0sF1-jJOAudviwA+_wtVmOkxhBHWuV8dvHod1seQ@mail.gmail.com>
	<201409082352.59995.even.rouault@spatialys.com>
	<CADz3VuXMjwH-b89RJ0Z4BQKoxX-DE669b_MVHZ4wiG_HaBYADA@mail.gmail.com>
	<54107FB7.6000604@gmail.com>
Message-ID: <CAJB43VqryORwBCtZUBVzmjMxd8O5fzw2CLJh=PDs0o=1yfr8Gg@mail.gmail.com>

Hello all.
I'm trying to fix issues which were mentioned before in order to integrate
GNM into GDAL 2.0. My question is about that issue:

Even Rouault:
>
- gnm/frmts/gnm_frmts.h :  I'm a bit concerned about exposing (installed
> header + CPL_DLL) an interface that has not yet been implemented. My
> intuition
> is that it might change once the first one or two implementations have been
> made. So maybe keep it internal/experimental for now.
>

What's the correct way to mark some parts of GNM as internal? Just write in
comments and documentation "this is for internal use for now" + not to add
the headers to the "install" target, or I need something else to achieve
this?


2014-09-10 20:43 GMT+04:00 Dmitriy Baryshnikov <bishop.dev at gmail.com>:

>  Hi, Imran.
>
> Yes, I think so. It depends on including GNM into GDAL. The python binding
> using swig, so adding the java will be simple.
>
> Best regards,
>     Dmitry
>
> 09.09.2014 19:41, Imran Rajjad ?????:
>
> Will this be available for java bindings too?
> On Sep 9, 2014 12:53 AM, "Even Rouault" <even.rouault at spatialys.com>
> wrote:
>
>>
>> > - gnm/frmts/gnm_frmts.h :  I'm a bit concerned about exposing (installed
>> >
>> > > header + CPL_DLL) an interface that has not yet been implemented. My
>> > > intuition
>> > > is that it might change once the first one or two implementations have
>> > > been made. So maybe keep it internal/experimental for now.
>> >
>> > I agree that the inclusion of the interfaces/capabilities that can be
>> (not
>> > will be) extended in future is not a 100% good idea. I hoped that
>> someone
>> > will be interested or even I will have time to implement and extend
>> > something of what I wrote at the "Future ideas" section in my RFC. But
>> we
>> > do not know exactly will it be implemented or not. So: (1) We can remove
>> > for now all these interfaces "for future", which means to leave only
>> > GNMGdalNetwork and one analysing class. (2) Try to implement these
>> > capabilities: pgRouting for gnm_frmts.h and for example
>> > GNMGdalStdRoutingAnalyser with some algorithm extension (K shortest
>> path).
>>
>> It's your call. Depend on how much time you have to implement that, but we
>> might go with the current state, if we clearly mark
>> experimental/unstabilized
>> interfaces as such. Either by "hiding" them, or by documentation if not
>> possible.
>>
>> > - GNMManager::CreateConnectivity () : I'm confused by the 'native'
>> term. In
>> >
>> > > this method, native=false seems to imply the GDAL "proprietary"
>> network
>> > > format
>> > > that can work with any vector driver that has similar capabilities
>> than
>> > > shapefile. Whereas in the RFC text, it seems to imply the contrary (
>> > > "network
>> > > of ?GDAL-native? format").
>> >
>> > Maybe I used it not correctly everywhere, but the general idea is the
>> > following: The term "native" corresponds to the existed network formats
>> (so
>> > when we work with pgRouting network we work with its native tables and
>> > fields, rather than with GNMGdal- system layers), while the
>> GDAL-networks
>> > are not "native" and more likely "common".
>> >
>>
>> Yes, that would be good if the language could be consistent among the
>> code and
>> the RFC text. From your explanation, it seems that the text in the RFC
>> should
>> be corrected. Yes GDAL-network is more a "common" or "generic" network
>> implementation.
>>
>> --
>> Spatialys - Geospatial professional services
>> http://www.spatialys.com
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttp://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150324/ed183edd/attachment.html>

From ChiefDan at gmail.com  Tue Mar 24 11:11:05 2015
From: ChiefDan at gmail.com (ChiefDan)
Date: Tue, 24 Mar 2015 11:11:05 -0700 (PDT)
Subject: [gdal-dev] GDAL C++ Api,
	create new line segments from point layer
In-Reply-To: <CAGYeuZ=fWqKxTq-qUA8W+SrbvzwCFm3QAeVtVpsSP2BJupUbQQ@mail.gmail.com>
References: <1427151332823-5195061.post@n6.nabble.com>
	<loom.20150324T070617-744@post.gmane.org>
	<1427188175860-5195113.post@n6.nabble.com>
	<CAGYeuZ=fWqKxTq-qUA8W+SrbvzwCFm3QAeVtVpsSP2BJupUbQQ@mail.gmail.com>
Message-ID: <1427220665673-5195238.post@n6.nabble.com>

Matt,

I've got a line layer and a points layer. The points layer fall on the line
layer, however they are not end points on the line layer, for the most part.

I'm not sure if that answers your question or not.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/GDAL-C-Api-create-new-line-segments-from-point-layer-tp5195061p5195238.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From matt.a.hanson at gmail.com  Tue Mar 24 12:36:13 2015
From: matt.a.hanson at gmail.com (Matt Hanson)
Date: Tue, 24 Mar 2015 15:36:13 -0400
Subject: [gdal-dev] GDAL C++ Api,
	create new line segments from point layer
In-Reply-To: <1427220665673-5195238.post@n6.nabble.com>
References: <1427151332823-5195061.post@n6.nabble.com>
	<loom.20150324T070617-744@post.gmane.org>
	<1427188175860-5195113.post@n6.nabble.com>
	<CAGYeuZ=fWqKxTq-qUA8W+SrbvzwCFm3QAeVtVpsSP2BJupUbQQ@mail.gmail.com>
	<1427220665673-5195238.post@n6.nabble.com>
Message-ID: <CAGYeuZmaxim=fmP4BjDgN_e9FBpd2_F8wJXu51SQfkOBLp3epQ@mail.gmail.com>

Want to make sure I understand this properly.

So you've got a series of points in your point layer, and a series of lines
in your line layer, and for each point on your points layer, you want to
find out which line this falls on.

Is that right?  It sounds like you've done this part.  However, I'm not
sure what is meant.  Is there an exact matching point on the line (i.e.
same exact coordinates), or are you finding the line that the point falls
on (using some sort of buffer or tolerance)?

If you are just finding the line that it happens to fall on, (I think this
is what you meant by "not end points"), then are you finding the closest
point that actually is part of the line?

If you have found the closest point on the line, then from there I think
it's easy to walk up and down the line by retrieving the points in order.
However, if you currently only have the linestring and the point
coordinates then use distance to find the actual closest on-line point.


Do I have this mostly right or have I only managed to confuse things more?




On Tue, Mar 24, 2015 at 2:11 PM, ChiefDan <ChiefDan at gmail.com> wrote:

> Matt,
>
> I've got a line layer and a points layer. The points layer fall on the line
> layer, however they are not end points on the line layer, for the most
> part.
>
> I'm not sure if that answers your question or not.
>
>
>
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/GDAL-C-Api-create-new-line-segments-from-point-layer-tp5195061p5195238.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150324/59a96bcc/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Tue Mar 24 13:51:00 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Tue, 24 Mar 2015 20:51:00 +0000 (UTC)
Subject: [gdal-dev]
	=?utf-8?q?GDAL_C++_Api=2C=09create_new_line_segments_f?=
	=?utf-8?q?rom_point_layer?=
References: <1427151332823-5195061.post@n6.nabble.com>
	<loom.20150324T070617-744@post.gmane.org>
	<1427188175860-5195113.post@n6.nabble.com>
	<CAGYeuZ=fWqKxTq-qUA8W+SrbvzwCFm3QAeVtVpsSP2BJupUbQQ@mail.gmail.com>
	<1427220665673-5195238.post@n6.nabble.com>
Message-ID: <loom.20150324T205931-442@post.gmane.org>

ChiefDan <ChiefDan <at> gmail.com> writes:

> 
> Matt,
> 
> I've got a line layer and a points layer. The points layer fall on the line
> layer, however they are not end points on the line layer, for the most part.
> 
> I'm not sure if that answers your question or not.

Hi,

Could you make a drawing about what you have and what you want to get?

If your aim is to cut long linestrings only where they intersect with points
from the point layer I believe that it is not easy with plain GDAL. There
are some useful functions in the SQLite/Spatialite SQL dialect
https://www.gaia-gis.it/gaia-sins/xmlBlob/spatialite-sql-latest.html, like
LinesCutAtNodes and Snap if you lines are only close to vertex a a
linestring. LinesCutAtNodes is making multilinestrings so you should
continue with something like the -explodecollections option in ogr2ogr.

-Jukka Rahkonen-


From geomartino at gmail.com  Tue Mar 24 14:16:30 2015
From: geomartino at gmail.com (Martin Ouellet)
Date: Tue, 24 Mar 2015 21:16:30 +0000
Subject: [gdal-dev] issue with Virtual Format and a remote CSV service
Message-ID: <CAENYpGYXZt_eYWgWUNQ5JoxtUV7eBtLBLw11Tk+YFp5_6=tHUg@mail.gmail.com>

Hi all,

I have a solr service which provide a valid csv response like this:

PHOTO_LATITUDE,PHOTO_LONGITUDE,ID
49.482333,-82.580556,A21524-047-1970-0
49.485278,-82.640444,A21524-048-1970-0
49.487583,-82.701194,A21524-049-1970-0
49.490444,-82.761111,A21524-050-1970-0
49.490333,-82.824333,A21524-051-1970-0

my vrt is:

<OGRVRTDataSource>
<OGRVRTLayer name="coord">
<SrcDataSource>http://solr/select?q=*%3A*&fl=PHOTO_LATITUDE%2CPHOTO_LONGITUDE%2CID&wt=csv</SrcDataSource>
<SrcLayer>coord</SrcLayer>
<GeometryType>wkbPoint</GeometryType>
<LayerSRS>WGS84</LayerSRS>
<GeometryField encoding="PointFromColumns" x="PHOTO_LONGITUDE"
y="PHOTO_LATITUDE"/>
</OGRVRTLayer>
</OGRVRTDataSource>

I've try to escape the & with &amp; in the url like the suggestions
here  <http://osgeo-org.1560.x6.nabble.com/Define-Virtual-Format-for-a-remote-GeoJSON-file-td5173766.html>but
in all cases, I still receive this error:

msOGRFileNextShape(): OGR error. Failed to read GeoJSON data

any ideas?

MartinO
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150324/1f499a84/attachment.html>

From even.rouault at spatialys.com  Tue Mar 24 14:22:25 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 24 Mar 2015 22:22:25 +0100
Subject: [gdal-dev] issue with Virtual Format and a remote CSV service
In-Reply-To: <CAENYpGYXZt_eYWgWUNQ5JoxtUV7eBtLBLw11Tk+YFp5_6=tHUg@mail.gmail.com>
References: <CAENYpGYXZt_eYWgWUNQ5JoxtUV7eBtLBLw11Tk+YFp5_6=tHUg@mail.gmail.com>
Message-ID: <201503242222.26015.even.rouault@spatialys.com>

Le mardi 24 mars 2015 22:16:30, Martin Ouellet a ?crit :
> Hi all,
> 
> I have a solr service which provide a valid csv response like this:
> 
> PHOTO_LATITUDE,PHOTO_LONGITUDE,ID
> 49.482333,-82.580556,A21524-047-1970-0
> 49.485278,-82.640444,A21524-048-1970-0
> 49.487583,-82.701194,A21524-049-1970-0
> 49.490444,-82.761111,A21524-050-1970-0
> 49.490333,-82.824333,A21524-051-1970-0
> 
> my vrt is:
> 
> <OGRVRTDataSource>
> <OGRVRTLayer name="coord">
> <SrcDataSource>http://solr/select?q=*%3A*&fl=PHOTO_LATITUDE%2CPHOTO_LONGITU
> DE%2CID&wt=csv</SrcDataSource> <SrcLayer>coord</SrcLayer>
> <GeometryType>wkbPoint</GeometryType>
> <LayerSRS>WGS84</LayerSRS>
> <GeometryField encoding="PointFromColumns" x="PHOTO_LONGITUDE"
> y="PHOTO_LATITUDE"/>
> </OGRVRTLayer>
> </OGRVRTDataSource>
> 
> I've try to escape the & with &amp; in the url like the suggestions
> here 
> <http://osgeo-org.1560.x6.nabble.com/Define-Virtual-Format-for-a-remote-Ge
> oJSON-file-td5173766.html>but in all cases, I still receive this error:
> 
> msOGRFileNextShape(): OGR error. Failed to read GeoJSON data

You need to do XML escaping indeed (& --> &amp;) and also prefix the URL by 
/vsicurl/ (the GeoJSON driver is the exception in that it tries to interpret 
any string by http:// as a potential source for it)

> 
> any ideas?
> 
> MartinO

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ChiefDan at gmail.com  Tue Mar 24 15:22:00 2015
From: ChiefDan at gmail.com (ChiefDan)
Date: Tue, 24 Mar 2015 15:22:00 -0700 (PDT)
Subject: [gdal-dev] GDAL C++ Api,
	create new line segments from point layer
In-Reply-To: <CAGYeuZmaxim=fmP4BjDgN_e9FBpd2_F8wJXu51SQfkOBLp3epQ@mail.gmail.com>
References: <1427151332823-5195061.post@n6.nabble.com>
	<loom.20150324T070617-744@post.gmane.org>
	<1427188175860-5195113.post@n6.nabble.com>
	<CAGYeuZ=fWqKxTq-qUA8W+SrbvzwCFm3QAeVtVpsSP2BJupUbQQ@mail.gmail.com>
	<1427220665673-5195238.post@n6.nabble.com>
	<CAGYeuZmaxim=fmP4BjDgN_e9FBpd2_F8wJXu51SQfkOBLp3epQ@mail.gmail.com>
Message-ID: <1427235720500-5195273.post@n6.nabble.com>

Matt Hanson-2 wrote
> So you've got a series of points in your point layer, and a series of
> lines
> in your line layer, and for each point on your points layer, you want to
> find out which line this falls on.

--I'm able to do this already.


Matt Hanson-2 wrote
> Is that right?  It sounds like you've done this part.  However, I'm not
> sure what is meant.  Is there an exact matching point on the line (i.e.
> same exact coordinates), or are you finding the line that the point falls
> on (using some sort of buffer or tolerance)?

--If you look at the picture above, those points are on the lines, but there
is not necessarily a corresponding point in the linestring, most likely
there is not.


Matt Hanson-2 wrote
> If you are just finding the line that it happens to fall on, (I think this
> is what you meant by "not end points"), then are you finding the closest
> point that actually is part of the line?

--I'm thinking to have a network of point-line-points for path finding. Pick
any one of the green points above, I need to create line segments from that
point to any point in any direction on the line that point is on to the next
point. In the end, the layers would visualize in the same manner, however
the original line(s) would now have end points at those green points.


Matt Hanson-2 wrote
> If you have found the closest point on the line, then from there I think
> it's easy to walk up and down the line by retrieving the points in order.
> However, if you currently only have the linestring and the point
> coordinates then use distance to find the actual closest on-line point.
> 
> 
> Do I have this mostly right or have I only managed to confuse things more?

--I'm sure I am not explaining it well as this is my first foray into path
finding and preparing the data so far has been the most difficult part. I'm
not fluent in GIS either so I think I'm lacking in proper vocabulary.




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/GDAL-C-Api-create-new-line-segments-from-point-layer-tp5195061p5195273.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From ChiefDan at gmail.com  Tue Mar 24 15:24:53 2015
From: ChiefDan at gmail.com (ChiefDan)
Date: Tue, 24 Mar 2015 15:24:53 -0700 (PDT)
Subject: [gdal-dev] GDAL C++ Api,
	create new line segments from point layer
In-Reply-To: <loom.20150324T205931-442@post.gmane.org>
References: <1427151332823-5195061.post@n6.nabble.com>
	<loom.20150324T070617-744@post.gmane.org>
	<1427188175860-5195113.post@n6.nabble.com>
	<CAGYeuZ=fWqKxTq-qUA8W+SrbvzwCFm3QAeVtVpsSP2BJupUbQQ@mail.gmail.com>
	<1427220665673-5195238.post@n6.nabble.com>
	<loom.20150324T205931-442@post.gmane.org>
Message-ID: <1427235893305-5195274.post@n6.nabble.com>

Jukka Rahkonen wrote
> Hi,
> 
> Could you make a drawing about what you have and what you want to get?
> 
> If your aim is to cut long linestrings only where they intersect with
> points
> from the point layer I believe that it is not easy with plain GDAL. There
> are some useful functions in the SQLite/Spatialite SQL dialect
> https://www.gaia-gis.it/gaia-sins/xmlBlob/spatialite-sql-latest.html, like
> LinesCutAtNodes and Snap if you lines are only close to vertex a a
> linestring. LinesCutAtNodes is making multilinestrings so you should
> continue with something like the -explodecollections option in ogr2ogr.
> 
> -Jukka Rahkonen-

--I'm thinking to have a network of point-line-points for path finding. Pick
any one of the green points above, I need to create line segments from that
point to any point in any direction on the line that point is on to the next
point. In the end, the layers would visualize in the same manner, however
the original line(s) would now have end points at those green points. 

I'll look into Spatialite, I knew it had networking api as well.

Dan




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/GDAL-C-Api-create-new-line-segments-from-point-layer-tp5195061p5195274.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From jukka.rahkonen at maanmittauslaitos.fi  Wed Mar 25 01:51:46 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Wed, 25 Mar 2015 08:51:46 +0000 (UTC)
Subject: [gdal-dev]
	=?utf-8?q?GDAL_C++_Api=2C=09create_new_line_segments_f?=
	=?utf-8?q?rom_point_layer?=
References: <1427151332823-5195061.post@n6.nabble.com>
	<loom.20150324T070617-744@post.gmane.org>
	<1427188175860-5195113.post@n6.nabble.com>
	<CAGYeuZ=fWqKxTq-qUA8W+SrbvzwCFm3QAeVtVpsSP2BJupUbQQ@mail.gmail.com>
	<1427220665673-5195238.post@n6.nabble.com>
	<loom.20150324T205931-442@post.gmane.org>
	<1427235893305-5195274.post@n6.nabble.com>
Message-ID: <loom.20150325T093255-528@post.gmane.org>

ChiefDan <ChiefDan <at> gmail.com> writes:

> 
> Jukka Rahkonen wrote
> > Hi,
> > 
> > Could you make a drawing about what you have and what you want to get?
> > 
> > If your aim is to cut long linestrings only where they intersect with
> > points
> > from the point layer I believe that it is not easy with plain GDAL. There
> > are some useful functions in the SQLite/Spatialite SQL dialect
> > https://www.gaia-gis.it/gaia-sins/xmlBlob/spatialite-sql-latest.html, like
> > LinesCutAtNodes and Snap if you lines are only close to vertex a a
> > linestring. LinesCutAtNodes is making multilinestrings so you should
> > continue with something like the -explodecollections option in ogr2ogr.
> > 
> > -Jukka Rahkonen-
> 
> --I'm thinking to have a network of point-line-points for path finding. Pick
> any one of the green points above, I need to create line segments from that
> point to any point in any direction on the line that point is on to the next
> point. In the end, the layers would visualize in the same manner, however
> the original line(s) would now have end points at those green points. 
> 
> I'll look into Spatialite, I knew it had networking api as well.

Hi,

I did not mean that you should use Spatialite instead of GDAL but that you
can utilize all that is supported by spatialite with GDAL through the SQLite
SQL dialect http://www.gdal.org/ogr_sql_sqlite.html.

Thanks for the image which I saw by accident from the Nabble thread. It does
not appear in any way gmane which I usually use for reading the mails.

You seem to be interested in on which track trains are standing. How about
this plan:
Cut all the linestrings which present tracks to reasonably short segments.
Trains are long so perhaps segments could be about 200 meters or even
longer. You can do the densification with ogr2ogr -segmentize 200. Build the
routing graph based on this segmentized data.

When you start routing you could now
- Select the segment that is closest to your train
- Select the start point/end point of that segment to be used as
node_from/node_to for your routing algorithm.

Because segments can be 200 m long the selected start/end node can be nearly
200 meters away from the reference point but because trains and platforms
are so long that should not matter so much. After all, both the first and
last car in a train are following the same route.

-Jukka Rahkonen-



From even.rouault at spatialys.com  Wed Mar 25 03:44:40 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 25 Mar 2015 11:44:40 +0100
Subject: [gdal-dev] Motion: Adopt RFC 55: Refined SetFeature() and
	DeleteFeature() semantics
Message-ID: <201503251144.40520.even.rouault@spatialys.com>

Hi,

As no points have been raised, 

Motion : I move to adopt RFC 55: Refined SetFeature() and 
DeleteFeature() semantics

http://trac.osgeo.org/gdal/wiki/rfc55_refined_setfeature_deletefeature_semantics

Starting with my +1

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From stefano.iacovella at gmail.com  Wed Mar 25 04:51:13 2015
From: stefano.iacovella at gmail.com (Stefano Iacovella)
Date: Wed, 25 Mar 2015 12:51:13 +0100
Subject: [gdal-dev] Issues configurign PostGIS with GDAL 1.11.2
Message-ID: <CAG9OqYpz7Qaesa_VfZS+xc-3UUtZaXbow0k83RO6JLc70WF5oA@mail.gmail.com>

Hi all,

sorry for the cross-posting, I am not sure whether the issue is more
relevant to GDAL or PostGIS.

I tried to compile PostGIS 2.1.6 on my Linux Box but the first step end
with an error:

~/sources/postgis-2.1.6 $ ./configure --with-gui
...
TOPOLOGY: Topology support requested
RASTER: Raster support requested
checking for gdal-config... /usr/local/bin/gdal-config
checking GDAL version... 1.11.2
checking for OGR enabled... yes
checking gdal.h usability... yes
checking gdal.h presence... yes
checking for gdal.h... yes
checking ogr_api.h usability... yes
checking ogr_api.h presence... yes
checking for ogr_api.h... yes
checking cpl_conv.h usability... yes
checking cpl_conv.h presence... yes
checking for cpl_conv.h... yes
checking for library containing GDALAllRegister... no
configure: error: could not find GDAL

It is the same Linux Box, Mint 17, on which I had previously successfully
configured and compiled PostGIS 2.1.5 on GDAL 1.11.1
The upgrade to GDAL 1.11.2 was done after the compilation of PostGIS 2.1.5
so I guess the problem may be related to this release.
I have in fact also tried to use the same configure command on sources for
PostGIS 2.1.5 but got the same error.

Am I doing something wrong or is it a bug?

Thank you in advance for your help

Stefano
---------------------------------------------------
41.95581N 12.52854E


http://www.linkedin.com/in/stefanoiacovella

http://twitter.com/#!/Iacovellas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150325/8672dd59/attachment.html>

From stefano.iacovella at gmail.com  Wed Mar 25 05:37:19 2015
From: stefano.iacovella at gmail.com (Stefano Iacovella)
Date: Wed, 25 Mar 2015 13:37:19 +0100
Subject: [gdal-dev] Issues configurign PostGIS with GDAL 1.11.2
In-Reply-To: <CAG9OqYpz7Qaesa_VfZS+xc-3UUtZaXbow0k83RO6JLc70WF5oA@mail.gmail.com>
References: <CAG9OqYpz7Qaesa_VfZS+xc-3UUtZaXbow0k83RO6JLc70WF5oA@mail.gmail.com>
Message-ID: <CAG9OqYppjzf_T6ftjZv1x8x5wRCAJB3RHFZOKrFDjgo_05n0SQ@mail.gmail.com>

May be I have found a clue about the issue.

Looking at the config.log I have found these rows:

| #define HAVE_GDAL_H 1
| #define HAVE_OGR_API_H 1
| #define HAVE_CPL_CONV_H 1
| /* end confdefs.h.  */
|
| /* Override any GCC internal prototype to avoid an error.
|    Use char because int might match the return type of a GCC
|    builtin and then its argument prototype would still apply.  */
| #ifdef __cplusplus
| extern "C"
| #endif
| char GDALAllRegister ();
| int
| main ()
| {
| return GDALAllRegister ();
|   ;
|   return 0;
| }
configure:20670: gcc -o conftest  -I/usr/local/include  conftest.c -lgdal
-L/usr/local/lib -lgdal >&5
//home/stefano/arcsdetools/sdeexe102/lib/libsde.so: undefined reference to
`pthread_atfork'
collect2: error: ld returned 1 exit status
configure:20670: $? = 1

could this error be the cause of the previous one?

I can't remember exactly when I installed the ArcSDE SDK and then
recompiled GDAL but I am pretty sure it was after compiling PostGIS 2.1.5

Thanks again

Stefano

---------------------------------------------------
41.95581N 12.52854E


http://www.linkedin.com/in/stefanoiacovella

http://twitter.com/#!/Iacovellas

2015-03-25 12:51 GMT+01:00 Stefano Iacovella <stefano.iacovella at gmail.com>:

> Hi all,
>
> sorry for the cross-posting, I am not sure whether the issue is more
> relevant to GDAL or PostGIS.
>
> I tried to compile PostGIS 2.1.6 on my Linux Box but the first step end
> with an error:
>
> ~/sources/postgis-2.1.6 $ ./configure --with-gui
> ...
> TOPOLOGY: Topology support requested
> RASTER: Raster support requested
> checking for gdal-config... /usr/local/bin/gdal-config
> checking GDAL version... 1.11.2
> checking for OGR enabled... yes
> checking gdal.h usability... yes
> checking gdal.h presence... yes
> checking for gdal.h... yes
> checking ogr_api.h usability... yes
> checking ogr_api.h presence... yes
> checking for ogr_api.h... yes
> checking cpl_conv.h usability... yes
> checking cpl_conv.h presence... yes
> checking for cpl_conv.h... yes
> checking for library containing GDALAllRegister... no
> configure: error: could not find GDAL
>
> It is the same Linux Box, Mint 17, on which I had previously successfully
> configured and compiled PostGIS 2.1.5 on GDAL 1.11.1
> The upgrade to GDAL 1.11.2 was done after the compilation of PostGIS 2.1.5
> so I guess the problem may be related to this release.
> I have in fact also tried to use the same configure command on sources for
> PostGIS 2.1.5 but got the same error.
>
> Am I doing something wrong or is it a bug?
>
> Thank you in advance for your help
>
> Stefano
> ---------------------------------------------------
> 41.95581N 12.52854E
>
>
> http://www.linkedin.com/in/stefanoiacovella
>
> http://twitter.com/#!/Iacovellas
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150325/d7671aeb/attachment.html>

From geomartino at gmail.com  Wed Mar 25 06:08:04 2015
From: geomartino at gmail.com (Martin Ouellet)
Date: Wed, 25 Mar 2015 13:08:04 +0000
Subject: [gdal-dev] issue with Virtual Format and a remote CSV service
In-Reply-To: <201503242222.26015.even.rouault@spatialys.com>
References: <CAENYpGYXZt_eYWgWUNQ5JoxtUV7eBtLBLw11Tk+YFp5_6=tHUg@mail.gmail.com>
	<201503242222.26015.even.rouault@spatialys.com>
Message-ID: <CAENYpGYDLNFJ0f44VEB9g4U_sCTsg8NPm_yCN=QCA9Z=S-8XrQ@mail.gmail.com>

Thanks Even for the quick response.  Is it ok to escape : (with %3A) and
the comma (with %2C) in the vrt?

even with the prefix , I received another error:
OGR error. Failed to open datasource `/vsicurl/http://<my
server>:8080/solr-geo2/collection2/select?q=*%3A*&amp;fl=PHOTO_LATITUDE%2CPHOTO_LONGITUDE%2CID&amp;wt=csv&#39;

cheers,

MartinO

On Tue, Mar 24, 2015 at 5:21 PM Even Rouault <even.rouault at spatialys.com>
wrote:

> Le mardi 24 mars 2015 22:16:30, Martin Ouellet a ?crit :
> > Hi all,
> >
> > I have a solr service which provide a valid csv response like this:
> >
> > PHOTO_LATITUDE,PHOTO_LONGITUDE,ID
> > 49.482333,-82.580556,A21524-047-1970-0
> > 49.485278,-82.640444,A21524-048-1970-0
> > 49.487583,-82.701194,A21524-049-1970-0
> > 49.490444,-82.761111,A21524-050-1970-0
> > 49.490333,-82.824333,A21524-051-1970-0
> >
> > my vrt is:
> >
> > <OGRVRTDataSource>
> > <OGRVRTLayer name="coord">
> > <SrcDataSource>http://solr/select?q=*%3A*&fl=PHOTO_
> LATITUDE%2CPHOTO_LONGITU
> > DE%2CID&wt=csv</SrcDataSource> <SrcLayer>coord</SrcLayer>
> > <GeometryType>wkbPoint</GeometryType>
> > <LayerSRS>WGS84</LayerSRS>
> > <GeometryField encoding="PointFromColumns" x="PHOTO_LONGITUDE"
> > y="PHOTO_LATITUDE"/>
> > </OGRVRTLayer>
> > </OGRVRTDataSource>
> >
> > I've try to escape the & with &amp; in the url like the suggestions
> > here
> > <http://osgeo-org.1560.x6.nabble.com/Define-Virtual-
> Format-for-a-remote-Ge
> > oJSON-file-td5173766.html>but in all cases, I still receive this error:
> >
> > msOGRFileNextShape(): OGR error. Failed to read GeoJSON data
>
> You need to do XML escaping indeed (& --> &amp;) and also prefix the URL by
> /vsicurl/ (the GeoJSON driver is the exception in that it tries to
> interpret
> any string by http:// as a potential source for it)
>
> >
> > any ideas?
> >
> > MartinO
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150325/a990b0cf/attachment.html>

From dmorissette at mapgears.com  Wed Mar 25 06:29:00 2015
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Wed, 25 Mar 2015 09:29:00 -0400
Subject: [gdal-dev] Motion: Adopt RFC 55: Refined SetFeature() and
 DeleteFeature() semantics
In-Reply-To: <201503251144.40520.even.rouault@spatialys.com>
References: <201503251144.40520.even.rouault@spatialys.com>
Message-ID: <5512B81C.3010206@mapgears.com>

+1

Daniel


On 2015-03-25 6:44 AM, Even Rouault wrote:
> Hi,
>
> As no points have been raised,
>
> Motion : I move to adopt RFC 55: Refined SetFeature() and
> DeleteFeature() semantics
>
> http://trac.osgeo.org/gdal/wiki/rfc55_refined_setfeature_deletefeature_semantics
>
> Starting with my +1
>
> Best regards,
>
> Even
>


-- 
Daniel Morissette
T: +1 418-696-5056 #201
http://www.mapgears.com/
Provider of Professional MapServer Support since 2000

From jukka.rahkonen at maanmittauslaitos.fi  Wed Mar 25 07:39:22 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Wed, 25 Mar 2015 14:39:22 +0000 (UTC)
Subject: [gdal-dev]
	=?utf-8?q?Motion=3A_Adopt_RFC_55=3A_Refined_SetFeature?=
	=?utf-8?q?=28=29_and=09DeleteFeature=28=29_semantics?=
References: <201503251144.40520.even.rouault@spatialys.com>
Message-ID: <loom.20150325T153851-659@post.gmane.org>

Even Rouault <even.rouault <at> spatialys.com> writes:


> Hi,
> 
> As no points have been raised, 
> 
> Motion : I move to adopt RFC 55: Refined SetFeature() and 
> DeleteFeature() semantics
> 
>
http://trac.osgeo.org/gdal/wiki/rfc55_refined_setfeature_deletefeature_semantics
> 
> Starting with my +1

+1

-Jukka Rahkonen-



From jukka.rahkonen at maanmittauslaitos.fi  Wed Mar 25 08:27:33 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Wed, 25 Mar 2015 15:27:33 +0000 (UTC)
Subject: [gdal-dev] issue with Virtual Format and a remote CSV service
References: <CAENYpGYXZt_eYWgWUNQ5JoxtUV7eBtLBLw11Tk+YFp5_6=tHUg@mail.gmail.com>
	<201503242222.26015.even.rouault@spatialys.com>
	<CAENYpGYDLNFJ0f44VEB9g4U_sCTsg8NPm_yCN=QCA9Z=S-8XrQ@mail.gmail.com>
Message-ID: <loom.20150325T161222-816@post.gmane.org>

Martin Ouellet <geomartino <at> gmail.com> writes:

> 
> 
> Thanks Even for the quick response.? Is it ok to escape : 
(with %3A) and
the comma (with %2C) in the vrt?even with the prefix ,
 I received another error:
> OGR error. Failed to open datasource `/vsicurl/http://<my
server>:8080/solr-geo2/collection2/select?q=*%3A*&
fl=PHOTO_LATITUDE%2CPHOTO_LONGITUDE%2CID&wt=csv'

Hi,

I put two test files here:
http://latuviitta.org/documents/rename%20test.gml (with space, %20)
http://latuviitta.org/documents/rename%26test.gml (with &, %26)

Reading the first one succeeds through this VRT:

<OGRVRTDataSource> 
<OGRVRTLayer name="m_asalue"> 
<SrcDataSource>/vsicurl/http://latuviitta.org/documents
/rename%20test.gml</SrcDataSource>
</OGRVRTLayer> 
</OGRVRTDataSource>

Save and test with "ogrinfo ogrvrttest2.xml -ro -al". Keep 
SrcDataSource in one line when saving.

It was too hard a challenge for me to write a working VRT file for the
latter one with &. Who will be the first lucky one? All that must 
be done is to guess the right syntax to place "&" character cleverly encoded
instead of _ENC_ in "rename_ENC_test.gml"

I have tried:
- URL-encoding to %26
- XML-encoding to &
- XML-encoding and then URL-encoding to %26amp%3B


-Jukka Rahkonen-



From howard at hobu.co  Wed Mar 25 09:00:22 2015
From: howard at hobu.co (Howard Butler)
Date: Wed, 25 Mar 2015 11:00:22 -0500
Subject: [gdal-dev] Motion: Adopt RFC 55: Refined SetFeature() and
	DeleteFeature() semantics
In-Reply-To: <5512B81C.3010206@mapgears.com>
References: <201503251144.40520.even.rouault@spatialys.com>
	<5512B81C.3010206@mapgears.com>
Message-ID: <19FCC7B3-6F1C-4F1D-9294-6DFD56903232@hobu.co>

+1

Howard

> On Mar 25, 2015, at 8:29 AM, Daniel Morissette <dmorissette at mapgears.com> wrote:
> 
> +1
> 
> Daniel
> 
> 
> On 2015-03-25 6:44 AM, Even Rouault wrote:
>> Hi,
>> 
>> As no points have been raised,
>> 
>> Motion : I move to adopt RFC 55: Refined SetFeature() and
>> DeleteFeature() semantics
>> 
>> http://trac.osgeo.org/gdal/wiki/rfc55_refined_setfeature_deletefeature_semantics
>> 
>> Starting with my +1
>> 
>> Best regards,
>> 
>> Even
>> 
> 
> 
> -- 
> Daniel Morissette
> T: +1 418-696-5056 #201
> http://www.mapgears.com/
> Provider of Professional MapServer Support since 2000
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From ChiefDan at gmail.com  Wed Mar 25 10:04:12 2015
From: ChiefDan at gmail.com (ChiefDan)
Date: Wed, 25 Mar 2015 10:04:12 -0700 (PDT)
Subject: [gdal-dev] GDAL C++ Api,
	create new line segments from point layer
In-Reply-To: <loom.20150325T093255-528@post.gmane.org>
References: <1427151332823-5195061.post@n6.nabble.com>
	<loom.20150324T070617-744@post.gmane.org>
	<1427188175860-5195113.post@n6.nabble.com>
	<CAGYeuZ=fWqKxTq-qUA8W+SrbvzwCFm3QAeVtVpsSP2BJupUbQQ@mail.gmail.com>
	<1427220665673-5195238.post@n6.nabble.com>
	<loom.20150324T205931-442@post.gmane.org>
	<1427235893305-5195274.post@n6.nabble.com>
	<loom.20150325T093255-528@post.gmane.org>
Message-ID: <1427303052435-5195426.post@n6.nabble.com>

Jukka,

THanks for the suggestions. THe green points are the decision points, so I
need to use those in my pathing. For instance, I would choose one of those
points and then choose another green point as the destination to get the
route(s).



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/GDAL-C-Api-create-new-line-segments-from-point-layer-tp5195061p5195426.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From jukka.rahkonen at maanmittauslaitos.fi  Wed Mar 25 10:35:27 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Wed, 25 Mar 2015 17:35:27 +0000 (UTC)
Subject: [gdal-dev]
	=?utf-8?q?GDAL_C++_Api=2C=09create_new_line_segments_f?=
	=?utf-8?q?rom_point_layer?=
References: <1427151332823-5195061.post@n6.nabble.com>
	<loom.20150324T070617-744@post.gmane.org>
	<1427188175860-5195113.post@n6.nabble.com>
	<CAGYeuZ=fWqKxTq-qUA8W+SrbvzwCFm3QAeVtVpsSP2BJupUbQQ@mail.gmail.com>
	<1427220665673-5195238.post@n6.nabble.com>
	<loom.20150324T205931-442@post.gmane.org>
	<1427235893305-5195274.post@n6.nabble.com>
	<loom.20150325T093255-528@post.gmane.org>
	<1427303052435-5195426.post@n6.nabble.com>
Message-ID: <loom.20150325T182222-389@post.gmane.org>

ChiefDan <ChiefDan <at> gmail.com> writes:

> 
> Jukka,
> 
> THanks for the suggestions. THe green points are the decision points, so I
> need to use those in my pathing. For instance, I would choose one of those
> points and then choose another green point as the destination to get the
> route(s).

I have not really done anything useful with routing so my thinking may be
all wrong. I was thinking that there is a green point A on top of segment P,
and another green point B on top of R and you want to go from A to B. If you
select the start point of P and end point of R and compute a route between
them, doesn't the route necessarily go also via A and B? Splitting the line
segments from the middle at exact locations of A and B would not make any
real change into the graph and routing because new nodes would be only
pass-through nodes with cardinality of 2.

-Jukka Rahkonen-




From ChiefDan at gmail.com  Wed Mar 25 10:50:57 2015
From: ChiefDan at gmail.com (ChiefDan)
Date: Wed, 25 Mar 2015 10:50:57 -0700 (PDT)
Subject: [gdal-dev] GDAL C++ Api,
	create new line segments from point layer
In-Reply-To: <loom.20150325T182222-389@post.gmane.org>
References: <1427151332823-5195061.post@n6.nabble.com>
	<loom.20150324T070617-744@post.gmane.org>
	<1427188175860-5195113.post@n6.nabble.com>
	<CAGYeuZ=fWqKxTq-qUA8W+SrbvzwCFm3QAeVtVpsSP2BJupUbQQ@mail.gmail.com>
	<1427220665673-5195238.post@n6.nabble.com>
	<loom.20150324T205931-442@post.gmane.org>
	<1427235893305-5195274.post@n6.nabble.com>
	<loom.20150325T093255-528@post.gmane.org>
	<1427303052435-5195426.post@n6.nabble.com>
	<loom.20150325T182222-389@post.gmane.org>
Message-ID: <1427305857471-5195438.post@n6.nabble.com>

Jukka,

I've not done anything useful with routing either, so I'm sure once I solve
my issue, I'll immediately realize a simpler way to do it.
Your segmenting the lines has given me an idea that is similar: Add the
points into the linestrings.
I think if I do this I can then more easily create line segments with the
start/end points at my green points.
Given a point, I can then determine which line it is on. Once I have that
line, I can loop through the points that make up that line until I find my
first point of interest. From that point in the line string I can then
iterate to the next point in the linestring, then search for that point in
my points layer. If I find it, that's a line segment.

THe complication will then be finding the next green point on an
intersecting linestring.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/GDAL-C-Api-create-new-line-segments-from-point-layer-tp5195061p5195438.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From bishop.dev at gmail.com  Wed Mar 25 13:55:36 2015
From: bishop.dev at gmail.com (Dmitriy Baryshnikov)
Date: Wed, 25 Mar 2015 23:55:36 +0300
Subject: [gdal-dev] RFC 48: Geographical networks support
In-Reply-To: <CAJB43VqryORwBCtZUBVzmjMxd8O5fzw2CLJh=PDs0o=1yfr8Gg@mail.gmail.com>
References: <CAJB43VoQhuC-HiAvq8MDC_RoaP4KjSZf3ShbL=zsvpyUQ7gecQ@mail.gmail.com>	<201409082155.56976.even.rouault@spatialys.com>	<CAJB43VoiMB0sF1-jJOAudviwA+_wtVmOkxhBHWuV8dvHod1seQ@mail.gmail.com>	<201409082352.59995.even.rouault@spatialys.com>	<CADz3VuXMjwH-b89RJ0Z4BQKoxX-DE669b_MVHZ4wiG_HaBYADA@mail.gmail.com>	<54107FB7.6000604@gmail.com>
	<CAJB43VqryORwBCtZUBVzmjMxd8O5fzw2CLJh=PDs0o=1yfr8Gg@mail.gmail.com>
Message-ID: <551320C8.7080508@gmail.com>

Hi Mikhail,

For classes, functions and etc. you can make them protected/private,
for API, the header file can be split into public API part and internal 
part.
May be some definitions can be placed into the source (cpp) files.

Also Even mentioned CPL_DLL macro which exported classes/functions from 
dll, it should be removed for internal classes/functions.

Best regards,
     Dmitry

24.03.2015 20:42, Mikhail Gusev ?????:
> Hello all.
> I'm trying to fix issues which were mentioned before in order to 
> integrate GNM into GDAL 2.0. My question is about that issue:
>
>     Even Rouault:
>
>     - gnm/frmts/gnm_frmts.h :  I'm a bit concerned about exposing
>     (installed
>     header + CPL_DLL) an interface that has not yet been implemented.
>     My intuition
>     is that it might change once the first one or two implementations
>     have been
>     made. So maybe keep it internal/experimental for now.
>
>
> What's the correct way to mark some parts of GNM as internal? Just 
> write in comments and documentation "this is for internal use for now" 
> + not to add the headers to the "install" target, or I need something 
> else to achieve this?

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150325/01ce5a5e/attachment.html>

From nicolas.simon at spw.wallonie.be  Thu Mar 26 04:04:57 2015
From: nicolas.simon at spw.wallonie.be (SIMON Nicolas)
Date: Thu, 26 Mar 2015 11:04:57 +0000
Subject: [gdal-dev] RFC 54 and RFC54
Message-ID: <F02D54DF5576D84C86C23A39A792DC7E316C413D@se0002v.wallonie.intra>

Hi list,

        As I was reading these RFC I was thinking about an old idea to improve the consistency between the different drivers.
        Instead of having a specific test suite for each drivers, it'll be more interesting to have a test suite in each driver relying on a generic test suite common to all driver.
        In this way, we don't have to write a complete test suite when implementing new behaviour in a driver or a new driver
        Another advantage is that we can ensure that drivers behave the same way.

        Concerning RFC55, does it means that driver relying on RDBMS should implement SetFeature as an update ?

        Thanks for your hints

Nicolas SIMON

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150326/8d1a6caa/attachment.html>

From even.rouault at spatialys.com  Thu Mar 26 04:32:31 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 26 Mar 2015 12:32:31 +0100
Subject: [gdal-dev] RFC 54 and RFC54
In-Reply-To: <F02D54DF5576D84C86C23A39A792DC7E316C413D@se0002v.wallonie.intra>
References: <F02D54DF5576D84C86C23A39A792DC7E316C413D@se0002v.wallonie.intra>
Message-ID: <201503261232.31100.even.rouault@spatialys.com>

Nicolas,

> Hi list,
> 
>         As I was reading these RFC I was thinking about an old idea to
> improve the consistency between the different drivers. Instead of having a
> specific test suite for each drivers, it'll be more interesting to have a
> test suite in each driver relying on a generic test suite common to all
> driver. In this way, we don't have to write a complete test suite when
> implementing new behaviour in a driver or a new driver Another advantage
> is that we can ensure that drivers behave the same way.

The test_ogrsf utility in apps/ (must be compiled explictely by make 
test_ogrsf or nmake /f makefile.vc test_ogrsf.exe) implements a generic test 
suite, and most driver tests call it from one of their steps. It is however 
hard to test everything from that generic tests since for good or wrong or 
historical reasons, driver specific behaviour tends to interfere...
Some extra metadata should be available so that test_ogrsf knows what is 
valid/invalid. For example some drivers will restrict CreateLayer() to some 
geometry types and/or oblige a not-null SRS to be passed, etc...

> 
>         Concerning RFC55, does it means that driver relying on RDBMS should
> implement SetFeature as an update ?

Not necessarily, although it is highly recommended that they use UPDATE. 
Currently most RDBMS do that, although at least the MySQL and OCI drivers 
implement SetFeature() as DeleteFeature() + CreateFeature(). If the 
DeleteFeature() steps returns OGRERR_NON_EXISTING_FEATURE, then SetFeature() 
must return this value.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From MWilson at edrnet.com  Thu Mar 26 04:16:18 2015
From: MWilson at edrnet.com (MWilson Matthew)
Date: Thu, 26 Mar 2015 11:16:18 +0000
Subject: [gdal-dev] gdal commands and alternate datum (Old Hawaiian) handling
Message-ID: <CY1PR0701MB12090F45ADA03AEBBFBEA67ED4080@CY1PR0701MB1209.namprd07.prod.outlook.com>

Good morning,
  I've got some raster images for Hawaii, and I've found that running any command (gdalinfo, translate, warp) will return the following error in my Ubuntu environment:

Warning 1: Unhandled (yet) value for Datum : OHA-M. Defaulting to WGS84...

  I have seen that the files located in /usr/share/gdal/1.10 do seem to mention the Hawaiian datums, but I'm not sure how to enable support of those when I run my regular commands.  I'm running a script in Python, so I'm wondering if it may be possible to work around this, or if this is just a future development that hasn't happened yet.

Thanks,
Matthew
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150326/d154310b/attachment.html>

From even.rouault at spatialys.com  Thu Mar 26 04:54:09 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 26 Mar 2015 12:54:09 +0100
Subject: [gdal-dev] Fwd: [SoC] Mentor registration procedure
Message-ID: <201503261254.09673.even.rouault@spatialys.com>

Hi,

For all willing mentors & co-mentors :

----------  Message transmis  ----------

Sujet : [SoC] Mentor registration procedure
Date : jeudi 26 mars 2015, 12:46:44
De : Margherita Di Leo <diregola at gmail.com>
? : "OSGeo-SoC" <soc at lists.osgeo.org>

Dear All,

I'd like to remind that you can find the procedure on how to apply as a
mentor here:
http://wiki.osgeo.org/wiki/Google_Summer_of_Code_2015_Administrative#How_to_register_as_a_mentor

Please read it through carefully, even if you are a returning mentor. It is
very important that you provide me *all the info* that I required
(particularly *the email address* that you wish to use for mentors mailing
list!!), because I don't know each and everyone of you and I would have to
look for you on the internet. Multiply this for the number of mentors (more
than 60, as past years) and you will get a mess :-)

Note that this year we have removed the step of filling a form, thus the
information need to be provided *when you require the connection to OSGeo
in Melange*. I depend upon your kind cooperation.

thank you

Madi and Anne
https://gs1.wac.edgecastcdn.net/8019B6/data.tumblr.com/tumblr_mcfagj0nJC1r9a3oo.gif

-- 
Best regards,

Dr. Margherita DI LEO
Scientific / technical project officer

European Commission - DG JRC
Institute for Environment and Sustainability (IES)
Via Fermi, 2749
I-21027 Ispra (VA) - Italy - TP 261

Tel. +39 0332 78 3600
margherita.di-leo at jrc.ec.europa.eu

Disclaimer: The views expressed are purely those of the writer and may not
in any circumstance be regarded as stating an official position of the
European Commission.

-------------------------------------------------------
-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Mar 26 05:31:13 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 26 Mar 2015 13:31:13 +0100
Subject: [gdal-dev] gdal commands and alternate datum (Old Hawaiian)
	handling
In-Reply-To: <CY1PR0701MB12090F45ADA03AEBBFBEA67ED4080@CY1PR0701MB1209.namprd07.prod.outlook.com>
References: <CY1PR0701MB12090F45ADA03AEBBFBEA67ED4080@CY1PR0701MB1209.namprd07.prod.outlook.com>
Message-ID: <201503261331.13967.even.rouault@spatialys.com>

Matthew,

> Good morning,
>   I've got some raster images for Hawaii, and I've found that running any
> command (gdalinfo, translate, warp) will return the following error in my
> Ubuntu environment:
> 
> Warning 1: Unhandled (yet) value for Datum : OHA-M. Defaulting to WGS84...

I guess this comes from a geospatial PDF ? You're lucky I remember having put 
that warning message when writing the driver... So please always specify which 
format/driver you're talking about.

> 
>   I have seen that the files located in /usr/share/gdal/1.10 do seem to
> mention the Hawaiian datums, but I'm not sure how to enable support of
> those when I run my regular commands.  I'm running a script in Python, so
> I'm wondering if it may be possible to work around this, or if this is
> just a future development that hasn't happened yet.

The driver only handles a dozain of common datum codes from the list of 
hundreds of datums given at annex A (Predefined Datums) of 
http://portal.opengeospatial.org/files/?artifact_id=40537 . The issue is that 
the matching between those GEOTRANS bases datum codes and their EPSG 
equivalents must be manually done... So they tend to be added on a case by 
case basis. In that instance OHA-M stands for 'OLD HAWAIIAN (CC), Mean' 
according to the annex.

In gdal/gt_datum.csv (derived from GeoTrans):

OGRFeature(gt_datum):153
  CODE (String) = OHA-M
  NAME (String) = OLD HAWAIIAN (CC), Mean
  ELLIPSOID (String) = CC
  DELTAX (String) = 61
  SIGMAX (String) = 25
  DELTAY (String) = -285
  SIGMAY (String) = 20
  DELTAZ (String) = -181
  SIGMAZ (String) = 20
  NORTH (String) = 17
  SOUTH (String) = 24
  WEST (String) = -164
  EAST (String) = -153
  ROTX (String) = (null)
  ROTY (String) = (null)
  ROTZ (String) = (null)
  SCALE (String) = (null)

But there are other variations of OHA- (A, B, C and D)

In the EPSG world, there's just one as far as I can see. And by comparing the 
DELTAX, DELTAY and DELTAZ parameters of the above definition with the TOWGS84 
of the below definition, OHA-M seems to match the 'Old_Hawaiian' datum from 
EPSG:6135

$ gdalsrsinfo EPSG:4135

PROJ.4 : '+proj=longlat +ellps=clrk66 +towgs84=61,-285,-181,0,0,0,0 +no_defs '

OGC WKT :
GEOGCS["Old Hawaiian",
    DATUM["Old_Hawaiian",
        SPHEROID["Clarke 1866",6378206.4,294.9786982138982,
            AUTHORITY["EPSG","7008"]],
        TOWGS84[61,-285,-181,0,0,0,0],
        AUTHORITY["EPSG","6135"]],
    PRIMEM["Greenwich",0,
        AUTHORITY["EPSG","8901"]],
    UNIT["degree",0.0174532925199433,
        AUTHORITY["EPSG","9122"]],
    AUTHORITY["EPSG","4135"]]

So you could likely replace the DATUM section of the WKT definition returned by 
the PDF driver with the DATUM section of the above and put that in a foo.wkt 
file, and then use -a_srs foo.wkt / -t_srs foo.wkt depending on the utility.

I've just implemented in trunk the interpretation of OHA-M based on above 
assumptions.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From SGONG at mdacorporation.com  Thu Mar 26 07:38:56 2015
From: SGONG at mdacorporation.com (Shawn Gong)
Date: Thu, 26 Mar 2015 14:38:56 +0000
Subject: [gdal-dev] NITF2.1 complex data type
Message-ID: <7DCBC135929FF74E8A5488B1814AC6BC24585F5F@exbermd02.ds.mda.ca>

Hi list,



We receive SAR SLC (single look complex) images in NITF2.1. But the I and O bands are separate (HH_I, HH_Q, VV_I, VV_Q, etc)

My colleague modified the gdal NITF driver nitfdataset.cpp to rewrite them as NITFComplexRasterBand (see below)
It works with a single-pol SLC and outputs as I+jQ. However dual- and quad-pol don't work. All three RGB bands show the same HH_I + j*HH_Q

Are we doing it wrong, or NITF2.1 doesn't allow multi-pol Complex data type?

Thanks,
Shawn
GDALDataset *NITFDataset::OpenInternal( GDALOpenInfo * poOpenInfo,
                                GDALDataset *poWritableJ2KDataset,
                                int bOpenForCreate)
{
.....
.....

    GDALDataType dt = bandList[0]->GetRasterDataType();
    if (EQUAL(psImage->szICAT,"SAR")    //SAR image...
        && nUsableBands==psImage->nBands && nUsableBands%2==0     //...with 2 bands ... (modified to allow an even number - spec seems to indicate only 2 bands allowed?)
        && dt==bandList[1]->GetRasterDataType()   //...that have the same datatype...
        && !GDALDataTypeIsComplex(dt)   //...and are not complex...
        && (dt==GDT_Int16 || dt==GDT_Int32 || dt==GDT_Float32 || dt==GDT_Float64))      //..and can be mapped directly to a complex type
    {
  bool allBandsIQ = true;
  for (int i = 0; i < nUsableBands; i+=2)
  {
   NITFBandInfo *psBandInfo1 = psImage->pasBandInfo + i;
   NITFBandInfo *psBandInfo2 = psImage->pasBandInfo + i + 1;
   //check that the ISUBCAT is labelled "I" and "Q" on the 2 bands
   if (!EQUAL(psBandInfo1->szISUBCAT, "I") || !EQUAL(psBandInfo2->szISUBCAT, "Q"))
   {
    allBandsIQ = false;
    break;
   }
  }
  if (allBandsIQ)
  {
   nUsableBands /= 2;
   for (int i = 0; i < nUsableBands; i++)
   {
    //wrap the I and Q bands into a single complex band
    bandList[i] = new NITFComplexRasterBand(poDS, bandList[2 * i], bandList[2 * i + 1], i+1);
   }
  }
    }
/* -------------------------------------------------------------------- */
/*      Add bands to dataset                                            */
/* -------------------------------------------------------------------- */
    for( iBand = 0; iBand < nUsableBands; iBand++ )
      poDS->SetBand( iBand+1, bandList[iBand] );
    CPLFree(bandList);
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150326/ea70b47b/attachment-0001.html>

From even.rouault at spatialys.com  Thu Mar 26 09:52:58 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 26 Mar 2015 17:52:58 +0100
Subject: [gdal-dev] NITF2.1 complex data type
In-Reply-To: <7DCBC135929FF74E8A5488B1814AC6BC24585F5F@exbermd02.ds.mda.ca>
References: <7DCBC135929FF74E8A5488B1814AC6BC24585F5F@exbermd02.ds.mda.ca>
Message-ID: <201503261752.58285.even.rouault@spatialys.com>

Shawn,

> 
> 
> We receive SAR SLC (single look complex) images in NITF2.1. But the I and O
> bands are separate (HH_I, HH_Q, VV_I, VV_Q, etc)
> 
> My colleague modified the gdal NITF driver nitfdataset.cpp to rewrite them
> as NITFComplexRasterBand (see below) It works with a single-pol SLC and
> outputs as I+jQ. However dual- and quad-pol don't work. All three RGB
> bands show the same HH_I + j*HH_Q
> 
> Are we doing it wrong, or NITF2.1 doesn't allow multi-pol Complex data
> type?

If you can read all the bands with the unmodified driver, then it comes from 
your changes.

> 
> Thanks,
> Shawn
> GDALDataset *NITFDataset::OpenInternal( GDALOpenInfo * poOpenInfo,
>                                 GDALDataset *poWritableJ2KDataset,
>                                 int bOpenForCreate)
> {
> .....
> .....
> 
>     GDALDataType dt = bandList[0]->GetRasterDataType();
>     if (EQUAL(psImage->szICAT,"SAR")    //SAR image...
>         && nUsableBands==psImage->nBands && nUsableBands%2==0     //...with
> 2 bands ... (modified to allow an even number - spec seems to indicate
> only 2 bands allowed?) && dt==bandList[1]->GetRasterDataType()   //...that
> have the same datatype... && !GDALDataTypeIsComplex(dt)   //...and are not
> complex... && (dt==GDT_Int16 || dt==GDT_Int32 || dt==GDT_Float32 ||
> dt==GDT_Float64))      //..and can be mapped directly to a complex type {
>   bool allBandsIQ = true;
>   for (int i = 0; i < nUsableBands; i+=2)
>   {
>    NITFBandInfo *psBandInfo1 = psImage->pasBandInfo + i;
>    NITFBandInfo *psBandInfo2 = psImage->pasBandInfo + i + 1;
>    //check that the ISUBCAT is labelled "I" and "Q" on the 2 bands
>    if (!EQUAL(psBandInfo1->szISUBCAT, "I") ||
> !EQUAL(psBandInfo2->szISUBCAT, "Q")) {
>     allBandsIQ = false;
>     break;
>    }
>   }
>   if (allBandsIQ)
>   {
>    nUsableBands /= 2;
>    for (int i = 0; i < nUsableBands; i++)
>    {
>     //wrap the I and Q bands into a single complex band
>     bandList[i] = new NITFComplexRasterBand(poDS, bandList[2 * i],
> bandList[2 * i + 1], i+1); }

-->This looks a bit suspicious as you're modifying the array you're iterating 
over, but I think that must be still be OK, although as you show only part of 
the code, it is difficult to tell for sure.

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From SGONG at mdacorporation.com  Thu Mar 26 11:23:28 2015
From: SGONG at mdacorporation.com (Shawn Gong)
Date: Thu, 26 Mar 2015 18:23:28 +0000
Subject: [gdal-dev] NITF2.1 complex data type
In-Reply-To: <201503261752.58285.even.rouault@spatialys.com>
References: <7DCBC135929FF74E8A5488B1814AC6BC24585F5F@exbermd02.ds.mda.ca>,
	<201503261752.58285.even.rouault@spatialys.com>
Message-ID: <7DCBC135929FF74E8A5488B1814AC6BC24585FBD@exbermd02.ds.mda.ca>

Hello Even,

To where can I submit the code?

Thanks,
Shawn
________________________________________
From: Even Rouault [even.rouault at spatialys.com]
Sent: March-26-15 12:52 PM
To: gdal-dev at lists.osgeo.org
Cc: Shawn Gong
Subject: Re: [gdal-dev] NITF2.1 complex data type

Shawn,

>
>
> We receive SAR SLC (single look complex) images in NITF2.1. But the I and O
> bands are separate (HH_I, HH_Q, VV_I, VV_Q, etc)
>
> My colleague modified the gdal NITF driver nitfdataset.cpp to rewrite them
> as NITFComplexRasterBand (see below) It works with a single-pol SLC and
> outputs as I+jQ. However dual- and quad-pol don't work. All three RGB
> bands show the same HH_I + j*HH_Q
>
> Are we doing it wrong, or NITF2.1 doesn't allow multi-pol Complex data
> type?

If you can read all the bands with the unmodified driver, then it comes from
your changes.

>
> Thanks,
> Shawn
> GDALDataset *NITFDataset::OpenInternal( GDALOpenInfo * poOpenInfo,
>                                 GDALDataset *poWritableJ2KDataset,
>                                 int bOpenForCreate)
> {
> .....
> .....
>
>     GDALDataType dt = bandList[0]->GetRasterDataType();
>     if (EQUAL(psImage->szICAT,"SAR")    //SAR image...
>         && nUsableBands==psImage->nBands && nUsableBands%2==0     //...with
> 2 bands ... (modified to allow an even number - spec seems to indicate
> only 2 bands allowed?) && dt==bandList[1]->GetRasterDataType()   //...that
> have the same datatype... && !GDALDataTypeIsComplex(dt)   //...and are not
> complex... && (dt==GDT_Int16 || dt==GDT_Int32 || dt==GDT_Float32 ||
> dt==GDT_Float64))      //..and can be mapped directly to a complex type {
>   bool allBandsIQ = true;
>   for (int i = 0; i < nUsableBands; i+=2)
>   {
>    NITFBandInfo *psBandInfo1 = psImage->pasBandInfo + i;
>    NITFBandInfo *psBandInfo2 = psImage->pasBandInfo + i + 1;
>    //check that the ISUBCAT is labelled "I" and "Q" on the 2 bands
>    if (!EQUAL(psBandInfo1->szISUBCAT, "I") ||
> !EQUAL(psBandInfo2->szISUBCAT, "Q")) {
>     allBandsIQ = false;
>     break;
>    }
>   }
>   if (allBandsIQ)
>   {
>    nUsableBands /= 2;
>    for (int i = 0; i < nUsableBands; i++)
>    {
>     //wrap the I and Q bands into a single complex band
>     bandList[i] = new NITFComplexRasterBand(poDS, bandList[2 * i],
> bandList[2 * i + 1], i+1); }

-->This looks a bit suspicious as you're modifying the array you're iterating
over, but I think that must be still be OK, although as you show only part of
the code, it is difficult to tell for sure.

Best regards,

Even

--
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Mar 26 11:32:09 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 26 Mar 2015 19:32:09 +0100
Subject: [gdal-dev] NITF2.1 complex data type
In-Reply-To: <7DCBC135929FF74E8A5488B1814AC6BC24585FBD@exbermd02.ds.mda.ca>
References: <7DCBC135929FF74E8A5488B1814AC6BC24585F5F@exbermd02.ds.mda.ca>
	<201503261752.58285.even.rouault@spatialys.com>
	<7DCBC135929FF74E8A5488B1814AC6BC24585FBD@exbermd02.ds.mda.ca>
Message-ID: <201503261932.09662.even.rouault@spatialys.com>

Le jeudi 26 mars 2015 19:23:28, Shawn Gong a ?crit :
> Hello Even,
> 
> To where can I submit the code?

Assuming you intend to contribute that upstream ultimately, ticket with patch 
attached / github branch / ...

> 
> Thanks,
> Shawn
> ________________________________________
> From: Even Rouault [even.rouault at spatialys.com]
> Sent: March-26-15 12:52 PM
> To: gdal-dev at lists.osgeo.org
> Cc: Shawn Gong
> Subject: Re: [gdal-dev] NITF2.1 complex data type
> 
> Shawn,
> 
> > We receive SAR SLC (single look complex) images in NITF2.1. But the I and
> > O bands are separate (HH_I, HH_Q, VV_I, VV_Q, etc)
> > 
> > My colleague modified the gdal NITF driver nitfdataset.cpp to rewrite
> > them as NITFComplexRasterBand (see below) It works with a single-pol SLC
> > and outputs as I+jQ. However dual- and quad-pol don't work. All three
> > RGB bands show the same HH_I + j*HH_Q
> > 
> > Are we doing it wrong, or NITF2.1 doesn't allow multi-pol Complex data
> > type?
> 
> If you can read all the bands with the unmodified driver, then it comes
> from your changes.
> 
> > Thanks,
> > Shawn
> > GDALDataset *NITFDataset::OpenInternal( GDALOpenInfo * poOpenInfo,
> > 
> >                                 GDALDataset *poWritableJ2KDataset,
> >                                 int bOpenForCreate)
> > 
> > {
> > .....
> > .....
> > 
> >     GDALDataType dt = bandList[0]->GetRasterDataType();
> >     if (EQUAL(psImage->szICAT,"SAR")    //SAR image...
> >     
> >         && nUsableBands==psImage->nBands && nUsableBands%2==0    
> >         //...with
> > 
> > 2 bands ... (modified to allow an even number - spec seems to indicate
> > only 2 bands allowed?) && dt==bandList[1]->GetRasterDataType()  
> > //...that have the same datatype... && !GDALDataTypeIsComplex(dt)  
> > //...and are not complex... && (dt==GDT_Int16 || dt==GDT_Int32 ||
> > dt==GDT_Float32 || dt==GDT_Float64))      //..and can be mapped directly
> > to a complex type {
> > 
> >   bool allBandsIQ = true;
> >   for (int i = 0; i < nUsableBands; i+=2)
> >   {
> >   
> >    NITFBandInfo *psBandInfo1 = psImage->pasBandInfo + i;
> >    NITFBandInfo *psBandInfo2 = psImage->pasBandInfo + i + 1;
> >    //check that the ISUBCAT is labelled "I" and "Q" on the 2 bands
> >    if (!EQUAL(psBandInfo1->szISUBCAT, "I") ||
> > 
> > !EQUAL(psBandInfo2->szISUBCAT, "Q")) {
> > 
> >     allBandsIQ = false;
> >     break;
> >    
> >    }
> >   
> >   }
> >   if (allBandsIQ)
> >   {
> >   
> >    nUsableBands /= 2;
> >    for (int i = 0; i < nUsableBands; i++)
> >    {
> >    
> >     //wrap the I and Q bands into a single complex band
> >     bandList[i] = new NITFComplexRasterBand(poDS, bandList[2 * i],
> > 
> > bandList[2 * i + 1], i+1); }
> 
> -->This looks a bit suspicious as you're modifying the array you're
> iterating over, but I think that must be still be OK, although as you show
> only part of the code, it is difficult to tell for sure.
> 
> Best regards,
> 
> Even
> 
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From nshthm at gmail.com  Fri Mar 27 11:23:13 2015
From: nshthm at gmail.com (Nishith Maheshwari)
Date: Fri, 27 Mar 2015 23:53:13 +0530
Subject: [gdal-dev] GSOC 2015 proposal - Integration of cpp GDAL utilities
	into GDAL core library
Message-ID: <CABRzcz8BOrqcbSW3=XMf+fxZO7txG2j+jys3dnHPEYbdoLVVfQ@mail.gmail.com>

Hi all,
Please find the following proposal for 'Integration of cpp GDAL utilities
into GDAL core library'. The same has been submitted to google-melange
website-

https://docs.google.com/document/d/1Knld8FjWCMpibF2MzJKjZ0S8mrUKdxpA7RrlUX-B95g/edit?usp=sharing

Sorry for the delay in putting up the proposal. Feedback and comments would
be really helpful.

Regards,
Nishith Maheshwari
Lab for Spatial Informatics
IIIT Hyderabad, India

On Thu, Mar 19, 2015 at 4:02 PM, Volker Wichmann <Volker.Wichmann at uibk.ac.at
> wrote:

> Hi Nishith,
>
> On 03/18/2015 08:27 PM, Nishith Maheshwari wrote:
>
>> Hi,
>> I am a masters student from IIIT Hyderabad and currently in my final
>> year of study and working in the Lab for Spatial Informatics here.
>>
>> I was a part of GSOC 2014 and worked on the project *'Schematization
>> Plugin for QGIS'* last year [1][2].
>>
>> I am interested in the project *'Integration of cpp GDAL utilities into
>> GDAL core library'* .
>>
>> I have already looked at a few codes of gdal utilities available in the
>> 'apps' folder of the sourcecode and had a few queries -
>>
>> 1. From my understanding of the project description, the aim is to
>> refactor the individual codes of gdal utilities by removing the main()
>> and making them available in the form of functions. These functions can
>> then be accessed by another function like GDALRunUtility() which can be
>> used to call them individually using specific parameters. Please let me
>> know if I'm thinking in the right direction.
>>
>> 2. If we are implementing individual functions for every utility we
>> might not require a separate layer of interaction in the form of
>> GDALRunUtility(). Any thoughts?
>>
>
> yes, the idea was to move the functionality of the gdal utilities to GDAL
> core in order to have it available directly when using the library and thus
> to facilitate their usage from "external" programs. The functionality
> should be usable with the GDALRunUtility() function. This would avoid e.g.
> a system call to a tool or code duplication which is currently needed in
> order to create a GDAL vrt for example.
>
> It is not intended to remove the GDAL tools, but they would have to be
> reworked to just provide the parameter interface and then to call
> GDALRunUtility() themselves. The idea to have a GDALRunUtility() function
> is to have a unique entry point and common interface to all tool
> functionality.
>
> Best regards,
> Volker
>
>
>
>> [1] http://hub.qgis.org/wiki/quantum-gis/nishithm
>> [2] https://github.com/nishithm/schematization
>>
>> Regards,
>> Nishith Maheshwari
>> Lab for Spatial Informatics
>> IIIT Hyderabad, India
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150327/baf762e2/attachment.html>

From p.halls at york.ac.uk  Fri Mar 27 12:56:33 2015
From: p.halls at york.ac.uk (Peter Halls)
Date: Fri, 27 Mar 2015 19:56:33 +0000
Subject: [gdal-dev] GSOC 2015 proposal - Integration of cpp GDAL
 utilities into GDAL core library
In-Reply-To: <CABRzcz8BOrqcbSW3=XMf+fxZO7txG2j+jys3dnHPEYbdoLVVfQ@mail.gmail.com>
References: <CABRzcz8BOrqcbSW3=XMf+fxZO7txG2j+jys3dnHPEYbdoLVVfQ@mail.gmail.com>
Message-ID: <CADEnnOPw9DVCBRQjZUHCb9+QREYBOG2pzTTO6XoOB+qkwtvwOw@mail.gmail.com>

Maybe I've missed the point (through over familiarity with GDAL/OGR?)
.... but these utilities were originally branded as 'worked examples'
of how to use the substantive libraries to perform well understood
operations from which usage of the libraries might be readily
understood.  Each utility is itself a commented set of function calls
to the relevent GDAL libraries.  Why is there a need to duplicate this
in turning the utilities into function calls which then, in turn, must
be called by new stand-alone utilities?  There has to be a loss of
efficiency in sunch a process.

Best wishes,

Peter

On 27 March 2015 at 18:23, Nishith Maheshwari <nshthm at gmail.com> wrote:
> Hi all,
> Please find the following proposal for 'Integration of cpp GDAL utilities
> into GDAL core library'. The same has been submitted to google-melange
> website-
>
> https://docs.google.com/document/d/1Knld8FjWCMpibF2MzJKjZ0S8mrUKdxpA7RrlUX-B95g/edit?usp=sharing
>
> Sorry for the delay in putting up the proposal. Feedback and comments would
> be really helpful.
>
> Regards,
> Nishith Maheshwari
> Lab for Spatial Informatics
> IIIT Hyderabad, India
>
> On Thu, Mar 19, 2015 at 4:02 PM, Volker Wichmann
> <Volker.Wichmann at uibk.ac.at> wrote:
>>
>> Hi Nishith,
>>
>> On 03/18/2015 08:27 PM, Nishith Maheshwari wrote:
>>>
>>> Hi,
>>> I am a masters student from IIIT Hyderabad and currently in my final
>>> year of study and working in the Lab for Spatial Informatics here.
>>>
>>> I was a part of GSOC 2014 and worked on the project *'Schematization
>>> Plugin for QGIS'* last year [1][2].
>>>
>>> I am interested in the project *'Integration of cpp GDAL utilities into
>>> GDAL core library'* .
>>>
>>> I have already looked at a few codes of gdal utilities available in the
>>> 'apps' folder of the sourcecode and had a few queries -
>>>
>>> 1. From my understanding of the project description, the aim is to
>>> refactor the individual codes of gdal utilities by removing the main()
>>> and making them available in the form of functions. These functions can
>>> then be accessed by another function like GDALRunUtility() which can be
>>> used to call them individually using specific parameters. Please let me
>>> know if I'm thinking in the right direction.
>>>
>>> 2. If we are implementing individual functions for every utility we
>>> might not require a separate layer of interaction in the form of
>>> GDALRunUtility(). Any thoughts?
>>
>>
>> yes, the idea was to move the functionality of the gdal utilities to GDAL
>> core in order to have it available directly when using the library and thus
>> to facilitate their usage from "external" programs. The functionality should
>> be usable with the GDALRunUtility() function. This would avoid e.g. a system
>> call to a tool or code duplication which is currently needed in order to
>> create a GDAL vrt for example.
>>
>> It is not intended to remove the GDAL tools, but they would have to be
>> reworked to just provide the parameter interface and then to call
>> GDALRunUtility() themselves. The idea to have a GDALRunUtility() function is
>> to have a unique entry point and common interface to all tool functionality.
>>
>> Best regards,
>> Volker
>>
>>
>>>
>>> [1] http://hub.qgis.org/wiki/quantum-gis/nishithm
>>> [2] https://github.com/nishithm/schematization
>>>
>>> Regards,
>>> Nishith Maheshwari
>>> Lab for Spatial Informatics
>>> IIIT Hyderabad, India
>>>
>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
----------------------------------------------------------------------------------------------------------------
Peter J Halls, PhD Student, Post-war Reconstruction and Development Unit (PRDU)
                     Department of Politics, University of York

Snail mail: PRDU, Derwent College, University of York,
                Heslington, York YO10 5DD
This message has the status of a private and personal communication
----------------------------------------------------------------------------------------------------------------

From even.rouault at spatialys.com  Fri Mar 27 13:08:34 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 27 Mar 2015 21:08:34 +0100
Subject: [gdal-dev] GSOC 2015 proposal - Integration of cpp GDAL
	utilities into GDAL core library
In-Reply-To: <CADEnnOPw9DVCBRQjZUHCb9+QREYBOG2pzTTO6XoOB+qkwtvwOw@mail.gmail.com>
References: <CABRzcz8BOrqcbSW3=XMf+fxZO7txG2j+jys3dnHPEYbdoLVVfQ@mail.gmail.com>
	<CADEnnOPw9DVCBRQjZUHCb9+QREYBOG2pzTTO6XoOB+qkwtvwOw@mail.gmail.com>
Message-ID: <201503272108.34617.even.rouault@spatialys.com>

Peter,

> Maybe I've missed the point (through over familiarity with GDAL/OGR?)
> .... but these utilities were originally branded as 'worked examples'
> of how to use the substantive libraries to perform well understood
> operations from which usage of the libraries might be readily
> understood.  Each utility is itself a commented set of function calls
> to the relevent GDAL libraries.

There is non trivial logic involved in some of the utilities (e.g. ogr2ogr) 
and people have the choice between :
- doing a system call ("ogr2ogr ...."), but this isn't practical to deal with 
progress report, cancellation, or operating on in-memory datasets
- copy&pasting the source code of the utility in their own code, and 
"librarify'ing" it to remove exit(), etc...
- learning the GDAL/OGR API to do their own custom processing chain. More 
powerfull but longer learning curve

So the interest of the project would be to make life easier for people using 
the first 2 bullets (and I can tell you that there are a lot of people hitting 
those 2 bullets)

> Why is there a need to duplicate this
> in turning the utilities into function calls which then, in turn, must
> be called by new stand-alone utilities?
> There has to be a loss of
> efficiency in sunch a process.

I don't think there will be a loss of efficiency

Instead of ogr2ogr.cpp being currently

int main(...)
{
	complex_code
}

you would have (very schematically)

ogr2ogr.cpp:

int main(...)
{
       ogr2ogr_options = parse aguments()
       return ogr2ogr(ogr2ogr_options)
}

and libgdalutils_ogr2ogr.cpp :

int ogr2ogr(ogr2ogr_options)
{
     complex_code (moved from currently existing main)
}

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From dmorissette at mapgears.com  Fri Mar 27 13:15:28 2015
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Fri, 27 Mar 2015 16:15:28 -0400
Subject: [gdal-dev] GSOC 2015 proposal - Integration of cpp GDAL
 utilities into GDAL core library
In-Reply-To: <201503272108.34617.even.rouault@spatialys.com>
References: <CABRzcz8BOrqcbSW3=XMf+fxZO7txG2j+jys3dnHPEYbdoLVVfQ@mail.gmail.com>	<CADEnnOPw9DVCBRQjZUHCb9+QREYBOG2pzTTO6XoOB+qkwtvwOw@mail.gmail.com>
	<201503272108.34617.even.rouault@spatialys.com>
Message-ID: <5515BA60.4040603@mapgears.com>

+1 to Even's explanation on why this would be a very welcome addition.

We should also add to the requirements a refactoring of the "complex 
code" to  structure the messages/information that is currently output to 
stdout by the command-line utilities so that the calling program can 
interpret and present that info to the end user in a meaningful way.

Daniel


On 2015-03-27 4:08 PM, Even Rouault wrote:
> Peter,
>
>> Maybe I've missed the point (through over familiarity with GDAL/OGR?)
>> .... but these utilities were originally branded as 'worked examples'
>> of how to use the substantive libraries to perform well understood
>> operations from which usage of the libraries might be readily
>> understood.  Each utility is itself a commented set of function calls
>> to the relevent GDAL libraries.
>
> There is non trivial logic involved in some of the utilities (e.g. ogr2ogr)
> and people have the choice between :
> - doing a system call ("ogr2ogr ...."), but this isn't practical to deal with
> progress report, cancellation, or operating on in-memory datasets
> - copy&pasting the source code of the utility in their own code, and
> "librarify'ing" it to remove exit(), etc...
> - learning the GDAL/OGR API to do their own custom processing chain. More
> powerfull but longer learning curve
>
> So the interest of the project would be to make life easier for people using
> the first 2 bullets (and I can tell you that there are a lot of people hitting
> those 2 bullets)
>
>> Why is there a need to duplicate this
>> in turning the utilities into function calls which then, in turn, must
>> be called by new stand-alone utilities?
>> There has to be a loss of
>> efficiency in sunch a process.
>
> I don't think there will be a loss of efficiency
>
> Instead of ogr2ogr.cpp being currently
>
> int main(...)
> {
> 	complex_code
> }
>
> you would have (very schematically)
>
> ogr2ogr.cpp:
>
> int main(...)
> {
>         ogr2ogr_options = parse aguments()
>         return ogr2ogr(ogr2ogr_options)
> }
>
> and libgdalutils_ogr2ogr.cpp :
>
> int ogr2ogr(ogr2ogr_options)
> {
>       complex_code (moved from currently existing main)
> }
>
> Even
>


-- 
Daniel Morissette
T: +1 418-696-5056 #201
http://www.mapgears.com/
Provider of Professional MapServer Support since 2000

From p.halls at york.ac.uk  Sat Mar 28 02:47:32 2015
From: p.halls at york.ac.uk (Peter Halls)
Date: Sat, 28 Mar 2015 09:47:32 +0000
Subject: [gdal-dev] GSOC 2015 proposal - Integration of cpp GDAL
 utilities into GDAL core library
In-Reply-To: <201503272108.34617.even.rouault@spatialys.com>
References: <CABRzcz8BOrqcbSW3=XMf+fxZO7txG2j+jys3dnHPEYbdoLVVfQ@mail.gmail.com>
	<CADEnnOPw9DVCBRQjZUHCb9+QREYBOG2pzTTO6XoOB+qkwtvwOw@mail.gmail.com>
	<201503272108.34617.even.rouault@spatialys.com>
Message-ID: <CADEnnON2bCNGpXv5FoJeWSEfHj6HqxQuM6SOuUcwLuD=D9gw0w@mail.gmail.com>

Thanks, Even and Daniel.  I see the logic behind the arguments.

The stand-alone utilities are probably the most heavility used
GDAL/OGR code.  Once these have been subsumed into internal function
calls, do we continue to provides the stand-alone utilities?
Programming seems to be a cyclic requirement: 5-10 years ago the
clamour was solely for press and go stand-alone utilities; today there
are possibly more programmers - or, at least, the programmers have
become more vocal.  I've seen several such cycles over my career.

I am not saying that the proposal is a bad idea, rather I am seeking
to test the proposal such that we continue to commit our scarce
resources where there is greatest benefit.


Best wishes,

Peter


On 27 March 2015 at 20:08, Even Rouault <even.rouault at spatialys.com> wrote:
> Peter,
>
>> Maybe I've missed the point (through over familiarity with GDAL/OGR?)
>> .... but these utilities were originally branded as 'worked examples'
>> of how to use the substantive libraries to perform well understood
>> operations from which usage of the libraries might be readily
>> understood.  Each utility is itself a commented set of function calls
>> to the relevent GDAL libraries.
>
> There is non trivial logic involved in some of the utilities (e.g. ogr2ogr)
> and people have the choice between :
> - doing a system call ("ogr2ogr ...."), but this isn't practical to deal with
> progress report, cancellation, or operating on in-memory datasets
> - copy&pasting the source code of the utility in their own code, and
> "librarify'ing" it to remove exit(), etc...
> - learning the GDAL/OGR API to do their own custom processing chain. More
> powerfull but longer learning curve
>
> So the interest of the project would be to make life easier for people using
> the first 2 bullets (and I can tell you that there are a lot of people hitting
> those 2 bullets)
>
>> Why is there a need to duplicate this
>> in turning the utilities into function calls which then, in turn, must
>> be called by new stand-alone utilities?
>> There has to be a loss of
>> efficiency in sunch a process.
>
> I don't think there will be a loss of efficiency
>
> Instead of ogr2ogr.cpp being currently
>
> int main(...)
> {
>         complex_code
> }
>
> you would have (very schematically)
>
> ogr2ogr.cpp:
>
> int main(...)
> {
>        ogr2ogr_options = parse aguments()
>        return ogr2ogr(ogr2ogr_options)
> }
>
> and libgdalutils_ogr2ogr.cpp :
>
> int ogr2ogr(ogr2ogr_options)
> {
>      complex_code (moved from currently existing main)
> }
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com



-- 
----------------------------------------------------------------------------------------------------------------
Peter J Halls, PhD Student, Post-war Reconstruction and Development Unit (PRDU)
                     Department of Politics, University of York

Snail mail: PRDU, Derwent College, University of York,
                Heslington, York YO10 5DD
This message has the status of a private and personal communication
----------------------------------------------------------------------------------------------------------------

From damian.dixon at gmail.com  Sat Mar 28 03:06:32 2015
From: damian.dixon at gmail.com (Damian Dixon)
Date: Sat, 28 Mar 2015 10:06:32 +0000
Subject: [gdal-dev] GSOC 2015 proposal - Integration of cpp GDAL
 utilities into GDAL core library
In-Reply-To: <CADEnnON2bCNGpXv5FoJeWSEfHj6HqxQuM6SOuUcwLuD=D9gw0w@mail.gmail.com>
References: <CABRzcz8BOrqcbSW3=XMf+fxZO7txG2j+jys3dnHPEYbdoLVVfQ@mail.gmail.com>
	<CADEnnOPw9DVCBRQjZUHCb9+QREYBOG2pzTTO6XoOB+qkwtvwOw@mail.gmail.com>
	<201503272108.34617.even.rouault@spatialys.com>
	<CADEnnON2bCNGpXv5FoJeWSEfHj6HqxQuM6SOuUcwLuD=D9gw0w@mail.gmail.com>
Message-ID: <CAJjdW1zdxY41O9SZrBr+GeOvYz5YUXbbhyTyXRkCm8mx0_8t2A@mail.gmail.com>

There are a lot of GIS specialists and geographers who are not programmers
that use the tools to convert or query gis data before using within a
commercial gis tool.

I believe that there is merit in providing a higher level api.

Just my two pennies worth... as a programmer... working for a GIS company.

Regards
Damian
On 28 Mar 2015 09:47, "Peter Halls" <p.halls at york.ac.uk> wrote:

> Thanks, Even and Daniel.  I see the logic behind the arguments.
>
> The stand-alone utilities are probably the most heavility used
> GDAL/OGR code.  Once these have been subsumed into internal function
> calls, do we continue to provides the stand-alone utilities?
> Programming seems to be a cyclic requirement: 5-10 years ago the
> clamour was solely for press and go stand-alone utilities; today there
> are possibly more programmers - or, at least, the programmers have
> become more vocal.  I've seen several such cycles over my career.
>
> I am not saying that the proposal is a bad idea, rather I am seeking
> to test the proposal such that we continue to commit our scarce
> resources where there is greatest benefit.
>
>
> Best wishes,
>
> Peter
>
>
> On 27 March 2015 at 20:08, Even Rouault <even.rouault at spatialys.com>
> wrote:
> > Peter,
> >
> >> Maybe I've missed the point (through over familiarity with GDAL/OGR?)
> >> .... but these utilities were originally branded as 'worked examples'
> >> of how to use the substantive libraries to perform well understood
> >> operations from which usage of the libraries might be readily
> >> understood.  Each utility is itself a commented set of function calls
> >> to the relevent GDAL libraries.
> >
> > There is non trivial logic involved in some of the utilities (e.g.
> ogr2ogr)
> > and people have the choice between :
> > - doing a system call ("ogr2ogr ...."), but this isn't practical to deal
> with
> > progress report, cancellation, or operating on in-memory datasets
> > - copy&pasting the source code of the utility in their own code, and
> > "librarify'ing" it to remove exit(), etc...
> > - learning the GDAL/OGR API to do their own custom processing chain. More
> > powerfull but longer learning curve
> >
> > So the interest of the project would be to make life easier for people
> using
> > the first 2 bullets (and I can tell you that there are a lot of people
> hitting
> > those 2 bullets)
> >
> >> Why is there a need to duplicate this
> >> in turning the utilities into function calls which then, in turn, must
> >> be called by new stand-alone utilities?
> >> There has to be a loss of
> >> efficiency in sunch a process.
> >
> > I don't think there will be a loss of efficiency
> >
> > Instead of ogr2ogr.cpp being currently
> >
> > int main(...)
> > {
> >         complex_code
> > }
> >
> > you would have (very schematically)
> >
> > ogr2ogr.cpp:
> >
> > int main(...)
> > {
> >        ogr2ogr_options = parse aguments()
> >        return ogr2ogr(ogr2ogr_options)
> > }
> >
> > and libgdalutils_ogr2ogr.cpp :
> >
> > int ogr2ogr(ogr2ogr_options)
> > {
> >      complex_code (moved from currently existing main)
> > }
> >
> > Even
> >
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com
>
>
>
> --
>
> ----------------------------------------------------------------------------------------------------------------
> Peter J Halls, PhD Student, Post-war Reconstruction and Development Unit
> (PRDU)
>                      Department of Politics, University of York
>
> Snail mail: PRDU, Derwent College, University of York,
>                 Heslington, York YO10 5DD
> This message has the status of a private and personal communication
>
> ----------------------------------------------------------------------------------------------------------------
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150328/94a889a8/attachment-0001.html>

From even.rouault at spatialys.com  Sat Mar 28 03:18:40 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 28 Mar 2015 11:18:40 +0100
Subject: [gdal-dev] GSOC 2015 proposal - Integration of cpp GDAL
	utilities into GDAL core library
In-Reply-To: <CADEnnON2bCNGpXv5FoJeWSEfHj6HqxQuM6SOuUcwLuD=D9gw0w@mail.gmail.com>
References: <CABRzcz8BOrqcbSW3=XMf+fxZO7txG2j+jys3dnHPEYbdoLVVfQ@mail.gmail.com>
	<201503272108.34617.even.rouault@spatialys.com>
	<CADEnnON2bCNGpXv5FoJeWSEfHj6HqxQuM6SOuUcwLuD=D9gw0w@mail.gmail.com>
Message-ID: <201503281118.41072.even.rouault@spatialys.com>

Le samedi 28 mars 2015 10:47:32, Peter Halls a ?crit :
> Thanks, Even and Daniel.  I see the logic behind the arguments.
> 
> The stand-alone utilities are probably the most heavility used
> GDAL/OGR code.  Once these have been subsumed into internal function
> calls, do we continue to provides the stand-alone utilities?

Yes, of course, this was actually implied by my pseudo code ;-)

> Programming seems to be a cyclic requirement: 5-10 years ago the
> clamour was solely for press and go stand-alone utilities; today there
> are possibly more programmers - or, at least, the programmers have
> become more vocal.  I've seen several such cycles over my career.
> 
> I am not saying that the proposal is a bad idea, rather I am seeking
> to test the proposal such that we continue to commit our scarce
> resources where there is greatest benefit.
> 
> 
> Best wishes,
> 
> Peter
> 
> On 27 March 2015 at 20:08, Even Rouault <even.rouault at spatialys.com> wrote:
> > Peter,
> > 
> >> Maybe I've missed the point (through over familiarity with GDAL/OGR?)
> >> .... but these utilities were originally branded as 'worked examples'
> >> of how to use the substantive libraries to perform well understood
> >> operations from which usage of the libraries might be readily
> >> understood.  Each utility is itself a commented set of function calls
> >> to the relevent GDAL libraries.
> > 
> > There is non trivial logic involved in some of the utilities (e.g.
> > ogr2ogr) and people have the choice between :
> > - doing a system call ("ogr2ogr ...."), but this isn't practical to deal
> > with progress report, cancellation, or operating on in-memory datasets -
> > copy&pasting the source code of the utility in their own code, and
> > "librarify'ing" it to remove exit(), etc...
> > - learning the GDAL/OGR API to do their own custom processing chain. More
> > powerfull but longer learning curve
> > 
> > So the interest of the project would be to make life easier for people
> > using the first 2 bullets (and I can tell you that there are a lot of
> > people hitting those 2 bullets)
> > 
> >> Why is there a need to duplicate this
> >> in turning the utilities into function calls which then, in turn, must
> >> be called by new stand-alone utilities?
> >> There has to be a loss of
> >> efficiency in sunch a process.
> > 
> > I don't think there will be a loss of efficiency
> > 
> > Instead of ogr2ogr.cpp being currently
> > 
> > int main(...)
> > {
> > 
> >         complex_code
> > 
> > }
> > 
> > you would have (very schematically)
> > 
> > ogr2ogr.cpp:
> > 
> > int main(...)
> > {
> > 
> >        ogr2ogr_options = parse aguments()
> >        return ogr2ogr(ogr2ogr_options)
> > 
> > }
> > 
> > and libgdalutils_ogr2ogr.cpp :
> > 
> > int ogr2ogr(ogr2ogr_options)
> > {
> > 
> >      complex_code (moved from currently existing main)
> > 
> > }
> > 
> > Even
> > 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From fazamhd at live.com  Sat Mar 28 06:36:42 2015
From: fazamhd at live.com (Faza Mahamood)
Date: Sat, 28 Mar 2015 19:06:42 +0530
Subject: [gdal-dev] RFC 44: Add Parseable Output Formats for ogrinfo and
	gdalinfo
Message-ID: <SNT146-W50F15D408B08E67D5B75A4DEF70@phx.gbl>

Hi,

I am planning to implement json output for gdalinfo and ogrinfo. I have added the proposed json format for gdalinfo. I would like to get feedback.

http://trac.osgeo.org/gdal/wiki/rfc44_gdalinfoxml

Regards,
Faza Mahamood

 		 	   		  

From even.rouault at spatialys.com  Sat Mar 28 07:41:04 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 28 Mar 2015 15:41:04 +0100
Subject: [gdal-dev] Motion: Adopt RFC 55: Refined SetFeature() and
	DeleteFeature() semantics
In-Reply-To: <201503251144.40520.even.rouault@spatialys.com>
References: <201503251144.40520.even.rouault@spatialys.com>
Message-ID: <201503281541.05058.even.rouault@spatialys.com>

Le mercredi 25 mars 2015 11:44:40, Even Rouault a ?crit :
> Hi,
> 
> As no points have been raised,
> 
> Motion : I move to adopt RFC 55: Refined SetFeature() and
> DeleteFeature() semantics
> 
> http://trac.osgeo.org/gdal/wiki/rfc55_refined_setfeature_deletefeature_sema
> ntics
> 

Hi,

I declare this motion passed with +1 from DanielM, HowardB, JukkaR and me.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From tkeitt at utexas.edu  Sun Mar 29 08:33:34 2015
From: tkeitt at utexas.edu (Tim Keitt)
Date: Sun, 29 Mar 2015 10:33:34 -0500
Subject: [gdal-dev] Ubuntu packages with debugging
Message-ID: <CANnL8gr3QWUD73ueT=GN6qs0eahZubp2mYDM6gPgg_DRFNo0DA@mail.gmail.com>

I'm looking for a version of libgdal1h or libgdal1-dev compiled with
debugging symbols. Anyone know of a source?

THK

-- 
http://www.keittlab.org/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150329/2b877048/attachment.html>

From even.rouault at spatialys.com  Sun Mar 29 12:07:03 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 29 Mar 2015 21:07:03 +0200
Subject: [gdal-dev] Coordination of potential mentors for GDAL GSoc 2015
Message-ID: <201503292107.03763.even.rouault@spatialys.com>

Hi,

According to https://groups.google.com/forum/?hl=en#!topic/osgeo-gsoc-
mentors/rqYSNPxHd0c we have until April 6th to discuss and rank proposals.

As stated by Margherita, this must be done in a private way due to discussions 
on personal merits of applicants. I suggest we do that in a Google document 
rather than in Melange or email, especially when establishing the global 
ranking (as fas as I can see we can't have a synthetic doc in melange, but I 
must confess melange UI scares me!) . If you think it is OK (I think it 
requires folks to have a google account), please respond to me with your 
google account email so I can share it with you. Otherwise we can fall-back to 
email discussions... Or if you've better ideas...

We have proposals for the following subjects :

- Integration of cpp GDAL utilities into GDAL core library :
     * new idea 2015, 
     * 2 proposals
     * potential mentors : me, Robert?, Daniel?, ???

- GDAL image stretch/filter utility
     * new idea 2015
     * 3 proposals
     * potential mentors: Trent Hare & Jay Laura, ???

- Support of M coordinates, polyhedral surface, TINS and triangles for GDAL
     * idea 2014
     * one proposal
     * potential mentors: me, ???

The important thing is that we need at least 2 mentors for a subject to be 
accepted. So, potential mentors, consider it your last chance to show up and 
register to melange ( 
http://wiki.osgeo.org/wiki/Google_Summer_of_Code_2015_Administrative#How_to_register_as_a_mentor 
) so as to be able to see applications.

If I understand well, we should have minimum one slot, maybe more, but that's 
not granted.

Personnaly I'll be mostly off in August so it would be good if the other 
mentors could be free at that time.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From robert.coup at koordinates.com  Sun Mar 29 15:58:51 2015
From: robert.coup at koordinates.com (Robert Coup)
Date: Mon, 30 Mar 2015 11:58:51 +1300
Subject: [gdal-dev] RFC 44: Add Parseable Output Formats for ogrinfo and
	gdalinfo
In-Reply-To: <SNT146-W50F15D408B08E67D5B75A4DEF70@phx.gbl>
References: <SNT146-W50F15D408B08E67D5B75A4DEF70@phx.gbl>
Message-ID: <CAFLLRpKQVQ8C5dtxgaZYQ_N0hE33DemxNQwuWGaov1fe4G=v8g@mail.gmail.com>

Hi,

Good work, thanks for taking this on!

1: Is there any particular reason to implement XML? Every language has a
good JSON parser these days, as you note in the RFC XML is more complex to
implement, and it's not like strict schemas or streaming (usual reasons for
XML) are going to be in place.

2: In terms of the proposed gdalinfo JSON...

a) bands[0].band == 1 -- any reason to favour this over the implicit index
in the bands[] array?

b) personally I'd prefer to be slightly more verbose in attribute naming.
eg. block -> blockSize, colorInterp -> colorInterpolation, proj -> proj4

c) There's support for multiple RATs in a single dataset, but the JSON
format only allows one. Maybe rats: {"name": {... attributes...}}?

d) HDF-derived formats (and probably some others) have support for multiple
datasets/component images. Is that something we could incorporate (maybe
with a top-level object surrounding each dataset description)?

There may be a few other elements where there's support (either now or in
the forseeable future) for multiple items. @Even, any thoughts?

3: Keen to see the ogrinfo equivalent!

Rob :)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150330/eacc26ee/attachment.html>

From etourigny.dev at gmail.com  Sun Mar 29 18:52:20 2015
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Mon, 30 Mar 2015 08:52:20 +0700
Subject: [gdal-dev] NetCDF driver improvements (including groups support)
In-Reply-To: <3B970FB76033264EB34479EC8A365E1101BA31EA11@vwiexc030.acri.local>
References: <3B970FB76033264EB34479EC8A365E1101BA31EA11@vwiexc030.acri.local>
Message-ID: <CA+TxYvOz13NXGQX6acvOqtAUcLOt2aQH9xjnsq=mucAMjHTLrA@mail.gmail.com>

Hi Julien

These improvements look really great!

Unfortunately I am on a long-term vacation and semi-retired from my GIS
work. So I am sorry but I cannot really help on testing and committing the
work...
That is why I did not respond sooner.

As the last "official" netcdf maintainer I should at least give some
comments.

Perhaps Even can test the patches and commit them, or someone could step in
as a new netcdf maintainer.

If it is possible, It would be best to separate these improvements into a
number of patches. In any case you should add your patch(es) to a number of
new gdal trac ticket(s) (or existing ticket if it fixes a bug).  I did
significant improvements some time ago and I understand that it is hard to
separate these improvements in several patches, so I don't think it is
absolutely necessary to split them up - but it helps debugging any
regressions. Especially the groups support, I/O improvements and NASA
products should have independent patches and tickets.

Regarding 10) it would be best to maintain backwards compatibility, but if
the issue is only with 1D dataset I don't think it matters that much.

Cheers,
Etienne

On Thu, Feb 5, 2015 at 11:10 PM, Julien Demaria <Julien.Demaria at acri-st.fr>
wrote:

> Hi GDAL team,
>
> I've implemented several improvements to the NetCDF driver and I would
> like to provide them to the community.
> Main goal of the changes is to add full support of NetCDF-4 including
> groups.
> NetCDF-4 is the future format of ESA Sentinel-3 products (no groups) and
> NASA Ocean Color team is switching their L2/L3 products to NetCDF-4 with
> groups (VIIRS has already switched to the new format in December).
> With the changes NASA L2 products geolocation is automatically handled as
> geolocation arrays and can be reprojected using gdalwarp.
>
> I validated with autotests that nothing is broken in tests netcdf.py
> (excepting test 13 but see my point 5), netcdf_cf.py and hdf5.py, using
> NetCDF-3 and 4 libraries.
> I've also tested the new functionalities on various NetCDF-4 files.
> I think the only possible regression could be for marginal cases where a
> file was seen directly as a dataset and is now seen as multiple subdatasets
> (for example if a file has only one var in the top group and has nested
> groups containing variables), but I think this is not very common.
>
> For the moment I have all these changes in local GIT separated commits on
> the latest gdal-1.11 branch, let me know what changes you want and how can
> I provide them.
>
> Changes :
>
> 1) Implement full support for NetCDF-4 groups on reading:
>     - explore recursively all nested groups to create the subdatasets list
>     - subdatasets in nested groups use the /group1/group2/.../groupn/var
> standard
>       NetCDF-4 convention, excepting for variables in the root group which
> do not
>       have a leading slash for backward compatibility
>     - when accessing a subdataset using NETCDF:$file:$path, the leading
> slash is optional
>     - global attributes of each nested group are also collected in the
> GDAL dataset
>       metadata, using the same convention
> /group1/group2/.../groupn/NC_GLOBAL#attr_name,
>       excepting for the root group which do not have a leading slash for
> backward compatibility
>     - when searching for a variable containing auxiliary information on
> the selected subdataset,
>       like coordinate variables or grid_mapping, we now also search in
> parent groups (using NCDFResolveVar).
>       I now this is something not specified at this time in the CF
> convention because CF does not know groups,
>       but it seems logical to me to support this: NetCDF-4 specifies that
> dimensions of a group are
>       shared to its nested groups, so associated coordinate variables
> could be defined as the same level of its
>       corresponding dimension.
>     - reference to coordinate variables using the "coordinates" attribute
> support now also absolute paths,
>       this allow for example to specify coordinate variables located
> outside the group of the selected variable
>       or its parents. Relative paths could be implemented if needed.
>       This feature is used to add support for new NASA Ocean Color L2
> products.
>
> 2) Implement full read/write support for new NetCDF4 types NC_UBYTE,
> NC_USHORT, NC_UINT and NC_STRING, only if NETCDF_HAS_NC4 is defined (and
> only if format=NC4 for writing).
>     Support implemented for variables and attributes.
>     NC_STRING type is supported for reading (scalar and arrays) attributes
> and is used for writing only for array attributes (scalar are still written
> as NC_CHAR).
>     If NETCDF_HAS_NC4 is not defined or format!=NC4, NC_STRING array
> attributes are written as a single NC_CHAR string using the GDAL
> {v1,v2,...} convention.
>     Add missing support for NC_BYTE in CreateBandMetadata() and
> NC_BYTE/SHORT in NCDFPut1DVar().
>
> 3) Add support for new NASA Ocean Color L2 products and ESA Sentinel-3 L1
> or
>     L2 products which use the NetCDF-4 format (with groups for NASA, see
>     http://oceancolor.gsfc.nasa.gov/DOCS/FormatChange.html):
>     - NASA products: simulate a "coordinates" variable attribute to detect
> CF
>       geolocation arrays, and set bBottomUp to FALSE
>     - ESA products: set bBottomUp to FALSE and disable warning on missing
>       Conventions attribute
>
> 4) Fix bug #4554 with a more generic solution by disabling the
> installation of the HDF5 atexit() cleanup routine using H5dont_atexit().
>     Previous fix was to call GDALExit() (for the moment only defined
> gdalwarp.cpp) at the end of every program, which is more painful.
>
> 5) Fix implementation of GetScale/Offset to not always return
> pbSuccess=TRUE.
>     Fix CopyMetadata to handle bands with only scale or offset.
>     ==> WARNING this commit breaks the autotest netcdf_13 (check for
> scale/offset = 1.0/0.0 if no scale or offset is available), but for me it
> is not logical to return always pbSuccess=TRUE
>
> 6) Optimize IReadBlock() and CheckData() handling of partial blocks in the
> x axis by re-using the GDAL block buffer instead of allocating a new
> temporary buffer for each block.
>
> 7) Force block size to 1 scanline for bottom-up datasets if nBlockYSize !=
> 1 instead of raising a fatal error
>     ==> Solve a recent problem raised on the mailing list
>
> 8) Implement Get/SetUnitType using the standard "units" NetCDF attribute
>
> 9) Change default block size to 256x256 instead of scanline (only affect
> file without NetCDF chunking)
>     ==> because I think this is better for a random access to the data,
> but I'm not sure if the community want this change which could impact
> performances
>
> 10) I've also implemented for my needs support for 1D variables by
> simulating 2D datasets with only one row (dimensionless variables are not
> supported for the moment),
>        but this breaks backward compatibility because files containing
> only one variable and associated 1D coordinate variables are now seen as
> multiple sub datasets...
>        and maybe this is not the goal of GDAL to give access to
> not-2D-raster variables (but sometimes it's useful ;-) )
>
> Thanks for GDAL!
>
> Julien
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150330/54cee1ba/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Sun Mar 29 22:00:46 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Mon, 30 Mar 2015 05:00:46 +0000 (UTC)
Subject: [gdal-dev]
	=?utf-8?q?RFC_44=3A_Add_Parseable_Output_Formats_for_o?=
	=?utf-8?q?grinfo_and=09gdalinfo?=
References: <SNT146-W50F15D408B08E67D5B75A4DEF70@phx.gbl>
	<CAFLLRpKQVQ8C5dtxgaZYQ_N0hE33DemxNQwuWGaov1fe4G=v8g@mail.gmail.com>
Message-ID: <loom.20150330T065232-810@post.gmane.org>

Robert Coup <robert.coup <at> koordinates.com> writes:

> 
> 
> Hi,
> Good work, thanks for taking this on!
> 
> 1: Is there any particular reason to implement XML? Every language has a
good JSON parser these days, as you note in the RFC XML is more complex to
implement, and it's not like strict schemas or streaming (usual reasons for
XML) are going to be in place.
> 

Hi,

Despite requiring a bit more work for implementing, would it make living any
harder afterwards if there is a support for both XML and json outputs? There
are for sure such GDAL users who use more XML than json in their everyday work.

-Jukka Rahkonen-


From hrz at geodata.soton.ac.uk  Mon Mar 30 00:16:33 2015
From: hrz at geodata.soton.ac.uk (Homme Zwaagstra)
Date: Mon, 30 Mar 2015 08:16:33 +0100
Subject: [gdal-dev] RFC 44: Add Parseable Output Formats for ogrinfo and
 gdalinfo
In-Reply-To: <CAFLLRpKQVQ8C5dtxgaZYQ_N0hE33DemxNQwuWGaov1fe4G=v8g@mail.gmail.com>
References: <SNT146-W50F15D408B08E67D5B75A4DEF70@phx.gbl>
	<CAFLLRpKQVQ8C5dtxgaZYQ_N0hE33DemxNQwuWGaov1fe4G=v8g@mail.gmail.com>
Message-ID: <5518F851.30502@geodata.soton.ac.uk>

Hi,

On 29/03/15 23:58, Robert Coup wrote:
> Hi,
 >
 > Good work, thanks for taking this on!

Yes, this will be very useful!

> 2: In terms of the proposed  gdalinfo JSON...
 >
 > b) personally I'd prefer to be slightly more verbose in attribute 
naming. eg. block -> blockSize, colorInterp -> colorInterpolation, proj 
-> proj4

I agree as that will make it easier to scan through the output without 
raising
questions or needing to refer to specs. E.g. does colorInterp mean color
interpretation or interpolation?!

> c) There's support for multiple  RATs in a single dataset, but the JSON format only allows one. Maybe 
rats: {"name": {... attributes...}}?
 >
 > d) HDF-derived formats (and probably some others) have support for 
multiple datasets/component images. Is that something we could 
incorporate (maybe with a top-level object surrounding each dataset 
description)?
 >
 > There may be a few other elements where there's support (either now 
or in the forseeable future) for multiple items. @Even, any thoughts?

Yes, it would be nice to have support (or the possibility of support) 
for the
information concerning the larger gdal data model.  This kind of high level
declarative API is really useful in covering a lot common use cases e.g. 
getting
the extent of a raster, and finding out what files define it.

The command line parseable output format interface in itself would be 
great, but
the icing on the cake would be the combination of this RFC with the GSOC 
2015
'Integration of cpp GDAL utilities into GDAL core library' exposing this 
as a
fully fledged core API.

> 3: Keen to see the ogrinfo  equivalent!

Agreed!


Regarding the JSON output, I would prefer the top level "cornerCoordinates"
property to be a GeoJSON feature collection rather than the current 
custom data
structure.  Currently it is:

{
     "cornerCoordinates": {
         "upperLeft": [
             440720.000,
             3751320.000
         ],
         "lowerLeft": [
             440720.000,
             3750120.000
         ],
         "upperRight": [
             441920.000,
             3751320.000
         ],
         "lowerRight": [
             441920.000,
             3750120.000
         ],
         "center": [
             441320.000,
             3750720.000
         ]
     }
}

I think the following would be more useful:

{ "cornerCoordinates":
   { "type": "FeatureCollection",
     "bbox": [440720.000, 3750120.000, 441920.000, 3751320.000],
     "features": [
         { "type": "Feature",
           "geometry": {"type": "Point", "coordinates": [440720.000, 
3751320.000]},
           "properties": {"position": "upperLeft"}
         },
         { "type": "Feature",
           "geometry": {"type": "Point", "coordinates": [440720.000, 
3750120.000]},
           "properties": {"position": "lowerLeft"}
         },
         { "type": "Feature",
           "geometry": {"type": "Point", "coordinates": [441920.000, 
3751320.000]},
           "properties": {"position": "upperRight"}
         },
         { "type": "Feature",
           "geometry": {"type": "Point", "coordinates": [441920.000, 
3751320.000]},
           "properties": {"position": "lowerRight"}
         },
         { "type": "Feature",
           "geometry": {"type": "Point", "coordinates": [441320.000, 
3750720.000]},
           "properties": {"position": "center"}
         }
     ]
   }
}

It is more verbose, but seeing as the output is designed for parsing, this
shouldn't be a problem.  The big plus is that it is standard, allowing 
things
like this:

     gdalinfo -json | jq '{cornerCoordinates}' | ogr2ogr extent.shp 
/vsistdin/

(jq is like sed for JSON data: see <http://stedolan.github.io/jq/>).

An added benefit is that the FeatureCollection also includes the bbox
information for easy access to the raster extent.

Best regards,

Homme

>
 > Rob :)
 >
 >
 > _______________________________________________
 > gdal-dev mailing list
 > gdal-dev at lists.osgeo.org
 > http://lists.osgeo.org/mailman/listinfo/gdal-dev


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150330/a2383cdb/attachment.html>

From hrz at geodata.soton.ac.uk  Mon Mar 30 00:32:27 2015
From: hrz at geodata.soton.ac.uk (Homme Zwaagstra)
Date: Mon, 30 Mar 2015 08:32:27 +0100
Subject: [gdal-dev] RFC 44: Add Parseable Output Formats for ogrinfo and
 gdalinfo
In-Reply-To: <5518F851.30502@geodata.soton.ac.uk>
References: <SNT146-W50F15D408B08E67D5B75A4DEF70@phx.gbl>	<CAFLLRpKQVQ8C5dtxgaZYQ_N0hE33DemxNQwuWGaov1fe4G=v8g@mail.gmail.com>
	<5518F851.30502@geodata.soton.ac.uk>
Message-ID: <5518FC0B.90602@geodata.soton.ac.uk>


P.S. on the proposal below, perhaps things could be 'standardised' even 
more by
including the cornerCoordinates in both wgs84 and native coordinate systems
(much like gdalinfo does at the moment).  In this way you can be 
guaranteed of
getting geojson output in its default coordinate system.  e.g.:

{ "cornerCoordinates":
   { "wgs84": ... GeoJSON FeatureCollection transformed to EPSG:4326 ...,
     "native: ... GeoJSON FeatureCollection in native coordinates ...
   }
}

Best regards,

Homme

On 30/03/15 08:16, Homme Zwaagstra wrote:
>
 > Regarding the JSON output, I would prefer the top level 
"cornerCoordinates"
 > property to be a GeoJSON feature collection rather than the current 
custom data
 > structure.  Currently it is:
 >
 > {
 >     "cornerCoordinates": {
 >         "upperLeft": [
 >             440720.000,
 >             3751320.000
 >         ],
 >         "lowerLeft": [
 >             440720.000,
 >             3750120.000
 >         ],
 >         "upperRight": [
 >             441920.000,
 >             3751320.000
 >         ],
 >         "lowerRight": [
 >             441920.000,
 >             3750120.000
 >         ],
 >         "center": [
 >             441320.000,
 >             3750720.000
 >         ]
 >     }
 > }
 >
 > I think the following would be more useful:
 >
 > { "cornerCoordinates":
 >   { "type": "FeatureCollection",
 >     "bbox": [440720.000, 3750120.000, 441920.000, 3751320.000],
 >     "features": [Hi,
 >
 > On 29/03/15 23:58, Robert Coup wrote:
 > > Hi,
 > >
 > > Good work, thanks for taking this on!
 >
 > Yes, this will be very useful!
 >
 > > 2: In terms of the proposed gdalinfo JSON...
 > >
 > > b) personally I'd prefer to be slightly more verbose in attribute 
naming. eg. block -> blockSize, colorInterp -> colorInterpolation, proj 
-> proj4
 >
 > I agree as that will make it easier to scan through the output 
without raising
 > questions or needing to refer to specs. E.g. does colorInterp mean color
 > interpretation or interpolation?!
 >
 > > c) There's support for multiple RATs in a single dataset, but the 
JSON format only allows one. Maybe rats: {"name": {... attributes...}}?
 > >
 > > d) HDF-derived formats (and probably some others) have support for 
multiple datasets/component images. Is that something we could 
incorporate (maybe with a top-level object surrounding each dataset 
description)?
 > >
 > > There may be a few other elements where there's support (either now 
or in the forseeable future) for multiple items. @Even, any thoughts?
 >
 > Yes, it would be nice to have support (or the possibility of support) 
for the
 > information concerning the larger gdal data model.  This kind of high 
level
 > declarative API is really useful in covering a lot common use cases 
e.g. getting
 > the extent of a raster, and finding out what files define it.
 >
 > The command line parseable output format interface in itself would be 
great, but
 > the icing on the cake would be the combination of this RFC with the 
GSOC 2015
 > 'Integration of cpp GDAL utilities into GDAL core library' exposing 
this as a
 > fully fledged core API.
 >
 > > 3: Keen to see the ogrinfo equivalent!
 >
 > Agreed!
 >
 >
 >         { "type": "Feature",
 >           "geometry": {"type": "Point", "coordinates": [440720.000, 
3751320.000]},
 >           "properties": {"position": "upperLeft"}
 >         },
 >         { "type": "Feature",
 >           "geometry": {"type": "Point", "coordinates": [440720.000, 
3750120.000]},
 >           "properties": {"position": "lowerLeft"}
 >         },
 >         { "type": "Feature",
 >           "geometry": {"type": "Point", "coordinates": [441920.000, 
3751320.000]},
 >           "properties": {"position": "upperRight"}
 >         },
 >         { "type": "Feature",
 >           "geometry": {"type": "Point", "coordinates": [441920.000, 
3751320.000]},
 >           "properties": {"position": "lowerRight"}
 >         },
 >         { "type": "Feature",
 >           "geometry": {"type": "Point", "coordinates": [441320.000, 
3750720.000]},
 >           "properties": {"position": "center"}
 >         }
 >     ]
 >   }
 > }
 >
 > It is more verbose, but seeing as the output is designed for parsing, 
this
 > shouldn't be a problem.  The big plus is that it is standard, 
allowing things
 > like this:
 >
 >     gdalinfo -json | jq '{cornerCoordinates}' | ogr2ogr extent.shp 
/vsistdin/
 >
 > (jq is like sed for JSON data: see <http://stedolan.github.io/jq/>).
 >
 > An added benefit is that the FeatureCollection also includes the bbox
 > information for easy access to the raster extent.
 >
 > Best regards,
 >
 > Homme
 >
 > >
 > > Rob :)
 > >
 > >
 > > _______________________________________________
 > > gdal-dev mailing list
 > > gdal-dev at lists.osgeo.org
 > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
 >
 >
 >
 >
 > _______________________________________________
 > gdal-dev mailing list
 > gdal-dev at lists.osgeo.org
 > http://lists.osgeo.org/mailman/listinfo/gdal-dev


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150330/ba462c28/attachment.html>

From Julien.Demaria at acri-st.fr  Mon Mar 30 01:09:58 2015
From: Julien.Demaria at acri-st.fr (Julien Demaria)
Date: Mon, 30 Mar 2015 08:09:58 +0000
Subject: [gdal-dev] NetCDF driver improvements (including groups support)
In-Reply-To: <CA+TxYvOz13NXGQX6acvOqtAUcLOt2aQH9xjnsq=mucAMjHTLrA@mail.gmail.com>
References: <3B970FB76033264EB34479EC8A365E1101BA31EA11@vwiexc030.acri.local>
	<CA+TxYvOz13NXGQX6acvOqtAUcLOt2aQH9xjnsq=mucAMjHTLrA@mail.gmail.com>
Message-ID: <3B970FB76033264EB34479EC8A365E1101BA323A48@vwiexc030.acri.local>

Hi Etienne,

Thanks a lot for your advices, my changes are already separated in different local GIT commits, so I plan to deliver them into separated patches/tickets (I already did it for change 7 related to ticket #5291).
But I discussed with Even and before deliver the patches I have to add unit tests for each patch (especially for new features), but unfortunately I don?t have a lot of free time to do this for the moment...

Cheers,
Julien

De : Etienne Tourigny [mailto:etourigny.dev at gmail.com]
Envoy? : lundi 30 mars 2015 03:52
? : Julien Demaria
Cc : gdal-dev at lists.osgeo.org
Objet : Re: [gdal-dev] NetCDF driver improvements (including groups support)

Hi Julien

These improvements look really great!

Unfortunately I am on a long-term vacation and semi-retired from my GIS work. So I am sorry but I cannot really help on testing and committing the work...
That is why I did not respond sooner.

As the last "official" netcdf maintainer I should at least give some comments.

Perhaps Even can test the patches and commit them, or someone could step in as a new netcdf maintainer.

If it is possible, It would be best to separate these improvements into a number of patches. In any case you should add your patch(es) to a number of new gdal trac ticket(s) (or existing ticket if it fixes a bug).  I did significant improvements some time ago and I understand that it is hard to separate these improvements in several patches, so I don't think it is absolutely necessary to split them up - but it helps debugging any regressions. Especially the groups support, I/O improvements and NASA products should have independent patches and tickets.

Regarding 10) it would be best to maintain backwards compatibility, but if the issue is only with 1D dataset I don't think it matters that much.

Cheers,
Etienne

On Thu, Feb 5, 2015 at 11:10 PM, Julien Demaria <Julien.Demaria at acri-st.fr<mailto:Julien.Demaria at acri-st.fr>> wrote:
Hi GDAL team,

I've implemented several improvements to the NetCDF driver and I would like to provide them to the community.
Main goal of the changes is to add full support of NetCDF-4 including groups.
NetCDF-4 is the future format of ESA Sentinel-3 products (no groups) and NASA Ocean Color team is switching their L2/L3 products to NetCDF-4 with groups (VIIRS has already switched to the new format in December).
With the changes NASA L2 products geolocation is automatically handled as geolocation arrays and can be reprojected using gdalwarp.

I validated with autotests that nothing is broken in tests netcdf.py (excepting test 13 but see my point 5), netcdf_cf.py and hdf5.py, using NetCDF-3 and 4 libraries.
I've also tested the new functionalities on various NetCDF-4 files.
I think the only possible regression could be for marginal cases where a file was seen directly as a dataset and is now seen as multiple subdatasets (for example if a file has only one var in the top group and has nested groups containing variables), but I think this is not very common.

For the moment I have all these changes in local GIT separated commits on the latest gdal-1.11 branch, let me know what changes you want and how can I provide them.

Changes :

1) Implement full support for NetCDF-4 groups on reading:
    - explore recursively all nested groups to create the subdatasets list
    - subdatasets in nested groups use the /group1/group2/.../groupn/var standard
      NetCDF-4 convention, excepting for variables in the root group which do not
      have a leading slash for backward compatibility
    - when accessing a subdataset using NETCDF:$file:$path, the leading slash is optional
    - global attributes of each nested group are also collected in the GDAL dataset
      metadata, using the same convention /group1/group2/.../groupn/NC_GLOBAL#attr_name,
      excepting for the root group which do not have a leading slash for backward compatibility
    - when searching for a variable containing auxiliary information on the selected subdataset,
      like coordinate variables or grid_mapping, we now also search in parent groups (using NCDFResolveVar).
      I now this is something not specified at this time in the CF convention because CF does not know groups,
      but it seems logical to me to support this: NetCDF-4 specifies that dimensions of a group are
      shared to its nested groups, so associated coordinate variables could be defined as the same level of its
      corresponding dimension.
    - reference to coordinate variables using the "coordinates" attribute support now also absolute paths,
      this allow for example to specify coordinate variables located outside the group of the selected variable
      or its parents. Relative paths could be implemented if needed.
      This feature is used to add support for new NASA Ocean Color L2 products.

2) Implement full read/write support for new NetCDF4 types NC_UBYTE, NC_USHORT, NC_UINT and NC_STRING, only if NETCDF_HAS_NC4 is defined (and only if format=NC4 for writing).
    Support implemented for variables and attributes.
    NC_STRING type is supported for reading (scalar and arrays) attributes and is used for writing only for array attributes (scalar are still written as NC_CHAR).
    If NETCDF_HAS_NC4 is not defined or format!=NC4, NC_STRING array attributes are written as a single NC_CHAR string using the GDAL {v1,v2,...} convention.
    Add missing support for NC_BYTE in CreateBandMetadata() and NC_BYTE/SHORT in NCDFPut1DVar().

3) Add support for new NASA Ocean Color L2 products and ESA Sentinel-3 L1 or
    L2 products which use the NetCDF-4 format (with groups for NASA, see
    http://oceancolor.gsfc.nasa.gov/DOCS/FormatChange.html):
    - NASA products: simulate a "coordinates" variable attribute to detect CF
      geolocation arrays, and set bBottomUp to FALSE
    - ESA products: set bBottomUp to FALSE and disable warning on missing
      Conventions attribute

4) Fix bug #4554 with a more generic solution by disabling the installation of the HDF5 atexit() cleanup routine using H5dont_atexit().
    Previous fix was to call GDALExit() (for the moment only defined gdalwarp.cpp) at the end of every program, which is more painful.

5) Fix implementation of GetScale/Offset to not always return pbSuccess=TRUE.
    Fix CopyMetadata to handle bands with only scale or offset.
    ==> WARNING this commit breaks the autotest netcdf_13 (check for scale/offset = 1.0/0.0 if no scale or offset is available), but for me it is not logical to return always pbSuccess=TRUE

6) Optimize IReadBlock() and CheckData() handling of partial blocks in the x axis by re-using the GDAL block buffer instead of allocating a new temporary buffer for each block.

7) Force block size to 1 scanline for bottom-up datasets if nBlockYSize != 1 instead of raising a fatal error
    ==> Solve a recent problem raised on the mailing list

8) Implement Get/SetUnitType using the standard "units" NetCDF attribute

9) Change default block size to 256x256 instead of scanline (only affect file without NetCDF chunking)
    ==> because I think this is better for a random access to the data, but I'm not sure if the community want this change which could impact performances

10) I've also implemented for my needs support for 1D variables by simulating 2D datasets with only one row (dimensionless variables are not supported for the moment),
       but this breaks backward compatibility because files containing only one variable and associated 1D coordinate variables are now seen as multiple sub datasets...
       and maybe this is not the goal of GDAL to give access to not-2D-raster variables (but sometimes it's useful ;-) )

Thanks for GDAL!

Julien

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150330/ccff534d/attachment-0001.html>

From jukka.rahkonen at maanmittauslaitos.fi  Mon Mar 30 01:46:07 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Mon, 30 Mar 2015 08:46:07 +0000 (UTC)
Subject: [gdal-dev] RFC 44: Add Parseable Output Formats for ogrinfo and
	gdalinfo
References: <SNT146-W50F15D408B08E67D5B75A4DEF70@phx.gbl>	<CAFLLRpKQVQ8C5dtxgaZYQ_N0hE33DemxNQwuWGaov1fe4G=v8g@mail.gmail.com>
	<5518F851.30502@geodata.soton.ac.uk>
	<5518FC0B.90602@geodata.soton.ac.uk>
Message-ID: <loom.20150330T100657-12@post.gmane.org>

Homme Zwaagstra <hrz <at> geodata.soton.ac.uk> writes:

> 
> 
>     
>     P.S. on the proposal below, perhaps things could be 'standardised'
>     even more by
>     including the cornerCoordinates in both wgs84 and native coordinate
>     systems
>     (much like gdalinfo does at the moment).? In this way you can be
>     guaranteed of
>     getting geojson output in its default coordinate system.? e.g.:
>     { "cornerCoordinates":
>     ? { "wgs84": ... GeoJSON FeatureCollection transformed to EPSG:4326
>     ...,
>     ??? "native: ... GeoJSON FeatureCollection in native coordinates ...
>     ? }
>     }
>     Best regards,
>     Homme? ?


Hi,

Do you want to open this can of worms? Hardcore GeoJSON folks will tell that
"GeoJSON FeatureCollection in native coordinates" does not exist because
newest GeoJSON draft wants to support only one CRS which is WGS84
Longitude-Latitude. From
https://datatracker.ietf.org/doc/draft-butler-geojson/?include_text=1

"Other coordinate reference systems, including ones described by CRS
objects of the kind defined in [GJ2008] are NOT RECOMMENDED."

And then hardcore OGC standard folks will tell that the axis order of
coordinates must follow the official EPSG:definitions.

At least for me as a user of ogrinfo and gdalinfo the bounds in the native
units are the ones which I need. A few times in a year the geographic bounds
may be useful but I have not even thought before writing this mail that
ogrinfo does not report the WGS84 bounds while gdalinfo does. I deal also
often with data with unknown CRS like shapefiles without .prj and tiff+tfw
files. I suppose that bounds of those cannot be expressed as GeoJSON
FeatureCollections according to the new draft because nobody knows how to
re-project from unknown to WGS84 and back..

I think that the original RFC keeps things simple by relying on plain XML
and JSON and not mixing GML and GeoJSON into the play. However, I am not a
programmer so I may be all wrong.

-Jukka Rahkonen-




From even.rouault at spatialys.com  Mon Mar 30 02:20:18 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 30 Mar 2015 11:20:18 +0200
Subject: [gdal-dev] RFC 44: Add Parseable Output Formats for ogrinfo and
	gdalinfo
In-Reply-To: <CAFLLRpKQVQ8C5dtxgaZYQ_N0hE33DemxNQwuWGaov1fe4G=v8g@mail.gmail.com>
References: <SNT146-W50F15D408B08E67D5B75A4DEF70@phx.gbl>
	<CAFLLRpKQVQ8C5dtxgaZYQ_N0hE33DemxNQwuWGaov1fe4G=v8g@mail.gmail.com>
Message-ID: <201503301120.18784.even.rouault@spatialys.com>

Hi,

(giving my feedback on all comments)

> 
> 1: Is there any particular reason to implement XML? Every language has a
> good JSON parser these days, as you note in the RFC XML is more complex to
> implement, and it's not like strict schemas or streaming (usual reasons for
> XML) are going to be in place.

I suggested Faza to "hijack" this existing RFC that was an empty shell up to 
now ( http://trac.osgeo.org/gdal/wiki/rfc44_gdalinfoxml?version=1 ) to fill it 
with his proposed JSon format. I don't know if Faza's plans include 
implementing XML some day, but it is pretty much independant and could be 
implemented later if needed.

> 
> 2: In terms of the proposed gdalinfo JSON...
> 
> a) bands[0].band == 1 -- any reason to favour this over the implicit index
> in the bands[] array?

Makes sense, but if you've a lot of bands and are humanly looking at the JSon, 
might be useful to know at first sight which band you're looking at, although 
this is not the primary aim of the JSon output. Similarly, there's also 
rat.rows[i].index in the proposal.

A bit related, the proposal includes colorTable.count which is 
len(colorTable.entries) and histogram.count which is len(histogram.buckets). 
But no bandCount which would be len(band) or gcps.count which would be 
len(gcps.gcpList)

No strong opinion personnaly whether we should be on the verbose or compact 
side, but being consistent would be good.

> 
> b) personally I'd prefer to be slightly more verbose in attribute naming.
> eg. block -> blockSize, colorInterp -> colorInterpolation, proj -> proj4

+1

> 
> c) There's support for multiple RATs in a single dataset, but the JSON
> format only allows one. Maybe rats: {"name": {... attributes...}}?

Actually, there's support only for the "default" RAT in the GDAL API. Well, if 
we want the JSon format to anticipate multiple RATs some day, rats : { 
"default" : { ... } } makes sense

> 
> d) HDF-derived formats (and probably some others) have support for multiple
> datasets/component images. Is that something we could incorporate (maybe
> with a top-level object surrounding each dataset description)?

Subdatasets should appear currently as :

"metadata" : {
	...
	"SUBDATASETS": {
		"SUBDATASET_1_NAME" : "the_name_you_can_pass_to_GDALOpen",
		"SUBDATASET_1_DESC" : "the_description",
	}
}

Your proposal would make sense but there might be a performance implications 
in case of numerous subdatasets, so perhaps have an explicit -subdatasets 
option to gdalinfo ?

I'm a bit hesitating among two approaches :

1) one with two objects. In that case, we would likely need a 'type' key (ala 
GeoJSON) to know what the object is about.

Normal output:

{
    "type": "Dataset",
    "description": "...",
    "driverShortName": "GTiff",
    "driverLongName": "GeoTIFF", 
    ... 
}

With -subdatasets :

{
	"type": "DatasetCollection",
	"description": "my.h5",
	"driverShortName": "HDF5",
	"driverLongName": "Hierarchical Data Format Release 5", 
	"datasets" : [
 		{
			"type": "Dataset",
			"description": "HDF5:my.h5:first_var",
			"driverShortName": "HDF5Image",
			....
			"bands" : [ ... ]
		},
	]
}

2) or another one where -subdatasets would just add a "subdatasets" object to 
the normal format.

{
	"description": "my.h5",
	"driverShortName": "HDF5",
	"driverLongName": "Hierarchical Data Format Release 5", 
	...
	"bands" : [], # empty
	"subdatasets" : [
 		{
			"description": "HDF5:my.h5:first_var",
			"driverShortName": "HDF5Image",
			....
		},
	]
}


> 
> There may be a few other elements where there's support (either now or in
> the forseeable future) for multiple items. @Even, any thoughts?

Nothing in mind currently, but perhaps add a "jsonFormatVersion" : "1.0" in 
case we would need to make compatible (1.X) and incompatible (2.0) additions ?

> 
> 3: Keen to see the ogrinfo equivalent!
> 

What would make sense is to include it inside the above GDAL dataset JSon 
template since OGRLayer is now a child of GDALDataset


Homme's comments :

>Yes, it would be nice to have support (or the possibility of support) 
>for the
>information concerning the larger gdal data model.  This kind of high level
>declarative API is really useful in covering a lot common use cases e.g. 

Not sure what other information you're thinking of ? Faza's proposal covers 
pretty much everything available on the raster side AFAICS.


>The command line parseable output format interface in itself would be 
>great, but
>the icing on the cake would be the combination of this RFC with the GSOC 
>2015
>'Integration of cpp GDAL utilities into GDAL core library' exposing this 
>as a
>fully fledged core API.

Faza is applying for this subject ;-)

> Regarding the JSON output, I would prefer the top level "cornerCoordinates"
> property to be a GeoJSON feature collection rather than the current 
> custom data
> structure
>  In this way you can be 
>guaranteed of
>getting geojson output in its default coordinate system.  e.g.:
>
>{ "cornerCoordinates":
>   { "wgs84": ... GeoJSON FeatureCollection transformed to EPSG:4326 ...,
>     "native: ... GeoJSON FeatureCollection in native coordinates ...
>   }
>}

+1, although latests Jukka's arguments make sense too...

One thing to be aware of is that the wgs84 object might not always be there, 
in case there's no projection information, or in case of inconsistent 
projection + geotransform which make transformation to WGS84 coordinates 
invalid. Actually there are cases where reprojection to WGS84 doesn't make any 
sense at all: consider a PDS, ISIS or VICAR dataset of a Moon or Mars image 
(but I think that currently you could reproject them to WGS84 ironically since 
neither OGRSpatialReference or proj.4 will realize you're dealing with 
different planets!).

Other remark: in the current gdalinfo report,

Upper Left  (  397335.000, 3877407.000) (100d 7'31.87"W, 35d 2' 2.87"N)
Lower Left  (  397335.000, 3865044.000) (100d 7'26.38"W, 34d55'21.61"N)
Upper Right (  411627.000, 3877407.000) ( 99d58' 7.88"W, 35d 2' 7.74"N)
Lower Right (  411627.000, 3865044.000) ( 99d58' 3.16"W, 34d55'26.46"N)
Center      (  404481.000, 3871225.500) (100d 2'47.32"W, 34d58'44.76"N)

the long/lat coordinates displayed are *not* necessarily WGS84. They are in 
the geographic coordinate system of the projected coordinate systems, so if 
you've a NAD27 UTM PCS, there will be in NAD27 long/lat (so in the case of my 
Mars images, the coordinates actually make sense since they are expressed in a 
Mars datum).

I'm not sure how usefull a FeatureCollection of Feature corners is. My latest 
thinking would be to keep Faza's proposal of having a "cornerCoordinates" 
object (in native coordinate system), and add a side "wgs84Extent" object (not 
always there for above reasons), which would be GeoJSON feature with a Polygon 
geometry (each 4 corners projected to WGS84) :

{
     ...
     "cornerCoordinates": {
         "upperLeft": [
             440720.000,
             3751320.000
         ],
         "lowerLeft": [
             440720.000,
             3750120.000
         ],
         "upperRight": [
             441920.000,
             3751320.000
         ],
         "lowerRight": [
             441920.000,
             3750120.000
         ],
         "center": [
             441320.000,
             3750720.000
         ]
     },
     "wgs84Extent": {
        "type": "Feature",
        "bbox": [2.0.5, 49.1, 2.8, 50.0],
        "geometry": {
              "type": "Polygon",
              "coordinates": [
                    [ 2.1, 49.1 ],
                    [ 2.05, 50.0 ],
                    [ 2.8, 49.9 ],
                    [ 2.15, 49.15 ],
                    [ 2.1, 49.1 ]
               ]
          },
          "properties": []
      } 
      ....
}


~~~~~

My own remark/question: With the preliminary implementation work done by Faza 
( 
https://github.com/fazam/gdal/commit/34c25e01d014ab18f8842ce7c9bca1142915af69#commitcomment-10458670 
), which follows closely the current logic of gdalinfo, some objects might not 
always be there in the output. For example "gcps" will not be there if there 
are no GCPs (and if -nogcps if passed, but in which case that's expected). 
Same for "unit", "offset", "scale", "rat", "colorTable", "histogram" ...
Is that something acceptable ? I think it might be OK but we must add a 
foreword sentence mentionning that some objects might not be present depending 
on the dataset characteristics and options passed to gdalinfo.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From hrz at geodata.soton.ac.uk  Mon Mar 30 02:46:01 2015
From: hrz at geodata.soton.ac.uk (Homme Zwaagstra)
Date: Mon, 30 Mar 2015 10:46:01 +0100
Subject: [gdal-dev] RFC 44: Add Parseable Output Formats for ogrinfo and
 gdalinfo
In-Reply-To: <loom.20150330T100657-12@post.gmane.org>
References: <SNT146-W50F15D408B08E67D5B75A4DEF70@phx.gbl>	<CAFLLRpKQVQ8C5dtxgaZYQ_N0hE33DemxNQwuWGaov1fe4G=v8g@mail.gmail.com>	<5518F851.30502@geodata.soton.ac.uk>	<5518FC0B.90602@geodata.soton.ac.uk>
	<loom.20150330T100657-12@post.gmane.org>
Message-ID: <55191B59.5090209@geodata.soton.ac.uk>

Hi Jukka,

On 30/03/15 09:46, Jukka Rahkonen wrote:
> Homme Zwaagstra <hrz  <at> geodata.soton.ac.uk> writes:
 >
 >>
 >>
 >>
 >>     P.S. on the proposal below, perhaps things could be 'standardised'
 >>     even more by
 >>     including the cornerCoordinates in both wgs84 and native coordinate
 >>     systems
 >>     (much like gdalinfo does at the moment).  In this way you can be
 >>     guaranteed of
 >>     getting geojson output in its default coordinate system.  e.g.:
 >>     { "cornerCoordinates":
 >>       { "wgs84": ... GeoJSON FeatureCollection transformed to EPSG:4326
 >>     ...,
 >>         "native: ... GeoJSON FeatureCollection in native coordinates ...
 >>       }
 >>     }
 >>     Best regards,
 >>     Homme
 >
 >
 > Hi,
 >
 > Do you want to open this can of worms? Hardcore GeoJSON folks will 
tell that
 > "GeoJSON FeatureCollection in native coordinates" does not exist because
 > newest GeoJSON draft wants to support only one CRS which is WGS84
 > Longitude-Latitude. From
 > https://datatracker.ietf.org/doc/draft-butler-geojson/?include_text=1
 >
 > "Other coordinate reference systems, including ones described by CRS
 > objects of the kind defined in [GJ2008] are NOT RECOMMENDED."
 >
 > And then hardcore OGC standard folks will tell that the axis order of
 > coordinates must follow the official EPSG:definitions.
 >
 > At least for me as a user of ogrinfo and gdalinfo the bounds in the 
native
 > units are the ones which I need. A few times in a year the geographic 
bounds
 > may be useful but I have not even thought before writing this mail that
 > ogrinfo does not report the WGS84 bounds while gdalinfo does. I deal also
 > often with data with unknown CRS like shapefiles without .prj and 
tiff+tfw
 > files. I suppose that bounds of those cannot be expressed as GeoJSON
 > FeatureCollections according to the new draft because nobody knows how to
 > re-project from unknown to WGS84 and back..

The fact that it is a can of worms is what made me think that providing both
options would be helpful from a practical point of view: many tools expect
geojson to be in wgs84 (in which case use the transformed object) but 
equally as
in your use case it is important to be able to access the native 
coordinates.

I think the key point I wanted to make is that having the coordinates in 
geojson
format makes them more generally accessible, whatever the CRS, but if 
there is
also the option to meet wider (geojson) expectations by also having them in
wgs84 then that can be no bad thing.

Because the JSON output is quite high level it would be nice to not to 
have to
add additional steps such as coordinate transformations to make more 
general use
of the data.  E.g. it would be nice to just be able to pull out the 
extent of a
raster and have it available in a 'known' usable format, such as adding 
it as a
GIS layer, database extent etc.

>
 >
 > I think that the original RFC keeps things simple by relying on plain XML
 > and JSON and not mixing GML and GeoJSON into the play. However, I am 
not a
 > programmer so I may be all wrong.

The geojson and xml is designed to be ingested by programs: I'm in favour of
making this process as easy as possible using standard tools and formats.

I didn't mention GML (the XML component doesn't interest me as much) but now
that you have... ;)

Best regards,

Homme

>
 >
 > -Jukka Rahkonen-
 >
 >
 >
 > _______________________________________________
 > gdal-dev mailing list
 > gdal-dev at lists.osgeo.org
 > http://lists.osgeo.org/mailman/listinfo/gdal-dev


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150330/7dcc2e3e/attachment.html>

From hrz at geodata.soton.ac.uk  Mon Mar 30 03:35:39 2015
From: hrz at geodata.soton.ac.uk (Homme Zwaagstra)
Date: Mon, 30 Mar 2015 11:35:39 +0100
Subject: [gdal-dev] RFC 44: Add Parseable Output Formats for ogrinfo and
 gdalinfo
In-Reply-To: <201503301120.18784.even.rouault@spatialys.com>
References: <SNT146-W50F15D408B08E67D5B75A4DEF70@phx.gbl>
	<CAFLLRpKQVQ8C5dtxgaZYQ_N0hE33DemxNQwuWGaov1fe4G=v8g@mail.gmail.com>
	<201503301120.18784.even.rouault@spatialys.com>
Message-ID: <551926FB.9030202@geodata.soton.ac.uk>

Hello,

On 30/03/15 10:20, Even Rouault wrote:

> Homme's comments :
 >
 >> Yes, it would be nice to have support (or the possibility of support)
 >> for the
 >> information concerning the larger gdal data model.  This kind of 
high level
 >> declarative API is really useful in covering a lot common use cases 
e.g.
 >
 > Not sure what other information you're thinking of ? Faza's proposal 
covers
 > pretty much everything available on the raster side AFAICS.

No specific information, just a general statement applied to Roberts 
last three
points to make the JSON accessible information as comprehensive as 
possible! I
agree that Faza's proposal combined with your suggestions makes for a very
complete and useful feature set: I have a number of custom scripts and tools
that I can't wait to simplify with this new functionality.

>
 >> The command line parseable output format interface in itself would be
 >> great, but
 >> the icing on the cake would be the combination of this RFC with the 
GSOC
 >> 2015
 >> 'Integration of cpp GDAL utilities into GDAL core library' exposing 
this
 >> as a
 >> fully fledged core API.
 >
 > Faza is applying for this subject ;-)
 >
 >> Regarding the JSON output, I would prefer the top level 
"cornerCoordinates"
 >> property to be a GeoJSON feature collection rather than the current
 >> custom data
 >> structure
 >>  In this way you can be
 >> guaranteed of
 >> getting geojson output in its default coordinate system. e.g.:
 >>
 >> { "cornerCoordinates":
 >>   { "wgs84": ... GeoJSON FeatureCollection transformed to EPSG:4326 ...,
 >>     "native: ... GeoJSON FeatureCollection in native coordinates ...
 >>   }
 >> }
 >
 > +1, although latests Jukka's arguments make sense too...
 >
 > One thing to be aware of is that the wgs84 object might not always be 
there,
 > in case there's no projection information, or in case of inconsistent
 > projection + geotransform which make transformation to WGS84 coordinates
 > invalid. Actually there are cases where reprojection to WGS84 doesn't 
make any
 > sense at all: consider a PDS, ISIS or VICAR dataset of a Moon or Mars 
image
 > (but I think that currently you could reproject them to WGS84 
ironically since
 > neither OGRSpatialReference or proj.4 will realize you're dealing with
 > different planets!).
 >
 > Other remark: in the current gdalinfo report,
 >
 > Upper Left  (  397335.000, 3877407.000) (100d 7'31.87"W, 35d 2' 2.87"N)
 > Lower Left  (  397335.000, 3865044.000) (100d 7'26.38"W, 34d55'21.61"N)
 > Upper Right (  411627.000, 3877407.000) ( 99d58' 7.88"W, 35d 2' 7.74"N)
 > Lower Right (  411627.000, 3865044.000) ( 99d58' 3.16"W, 34d55'26.46"N)
 > Center      (  404481.000, 3871225.500) (100d 2'47.32"W, 34d58'44.76"N)
 >
 > the long/lat coordinates displayed are *not* necessarily WGS84. They 
are in
 > the geographic coordinate system of the projected coordinate systems, 
so if
 > you've a NAD27 UTM PCS, there will be in NAD27 long/lat (so in the 
case of my
 > Mars images, the coordinates actually make sense since they are 
expressed in a
 > Mars datum).

Ok, I wasn't aware that Jukka's can of worms was on such a cosmic scale!

> I'm not sure how usefull a  FeatureCollection of Feature corners is. My latest
 > thinking would be to keep Faza's proposal of having a 
"cornerCoordinates"
 > object (in native coordinate system), and add a side "wgs84Extent" 
object (not
 > always there for above reasons), which would be GeoJSON feature with 
a Polygon
 > geometry (each 4 corners projected to WGS84) :
 >
 > {
 >      ...
 >      "cornerCoordinates": {
 >          "upperLeft": [
 >              440720.000,
 >              3751320.000
 >          ],
 >          "lowerLeft": [
 >              440720.000,
 >              3750120.000
 >          ],
 >          "upperRight": [
 >              441920.000,
 >              3751320.000
 >          ],
 >          "lowerRight": [
 >              441920.000,
 >              3750120.000
 >          ],
 >          "center": [
 >              441320.000,
 >              3750720.000
 >          ]
 >      },
 >      "wgs84Extent": {
 >         "type": "Feature",
 >         "bbox": [2.0.5, 49.1, 2.8, 50.0],
 >         "geometry": {
 >               "type": "Polygon",
 >               "coordinates": [
 >                     [ 2.1, 49.1 ],
 >                     [ 2.05, 50.0 ],
 >                     [ 2.8, 49.9 ],
 >                     [ 2.15, 49.15 ],
 >                     [ 2.1, 49.1 ]
 >                ]
 >           },
 >           "properties": []
 >       }
 >       ....
 > }
 >

Yes, having the cornerCorner coordinates as a polygon would be fine too (you
only give up the ability to extract the center coordinate using geojson).
However it would be a shame not to have geojson access, whether by points or
polygons, to coordinates from files where, as Jukka says, the CRS 
information
may be missing or untransformable (which I believe in the above would 
mean that
there is no wgs84Extent).

I understand that GeoJSON is usually represented as epsg:4326 (and in 
the future
'must' be!), but from a practical point of view I just find it easier to 
make
use of coordinates in geojson format (whatever the CRS), rather than 
massaging
custom (if admittedly simple) data structures into a usable format. It's a
small thing but lots of small things added up make a big difference :)

I suggested a FeatureCollection as you can embed the position (e.g. 
upperLeft)
as an attribute, but you could also adapt Fazam's original proposal to 
point to
a GeoJSON Geometry rather than a coordinate array e.g:

{
     ...
     "cornerCoordinates": {
         "upperLeft": {"type": "Point", "coordinates": [440720.000, 
3751320.000]},
         ...
     },
     ...
}

> ~~~~~
 >
 > My own remark/question: With the preliminary implementation work done 
by Faza
 > (
 > 
https://github.com/fazam/gdal/commit/34c25e01d014ab18f8842ce7c9bca1142915af69#commitcomment-10458670 

 > ), which follows closely the current logic of gdalinfo, some objects 
might not
 > always be there in the output. For example "gcps" will not be there 
if there
 > are no GCPs (and if -nogcps if passed, but in which case that's 
expected).
 > Same for "unit", "offset", "scale", "rat", "colorTable", "histogram" ...
 > Is that something acceptable ? I think it might be OK but we must add a
 > foreword sentence mentionning that some objects might not be present 
depending
 > on the dataset characteristics and options passed to gdalinfo.

My only comment would be to differentiate between a property that has
specifically been requested but is not available, and an optional
argument. E.g. if -nogcps is passed then it would make sense if the "gcps"
property didn't exist in the JSON, but if it was not passed and there 
were still
no gcps, then the JSON should be { "gcps": null }.  I am not familiar 
with the
code but it looks like this may already be the case?

Best regards,

Homme

> Even
 >

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150330/210b8b0e/attachment-0001.html>

From jluis at ualg.pt  Mon Mar 30 04:30:41 2015
From: jluis at ualg.pt (Joaquim Luis)
Date: Mon, 30 Mar 2015 12:30:41 +0100
Subject: [gdal-dev] NetCDF driver improvements (including groups support)
In-Reply-To: <3B970FB76033264EB34479EC8A365E1101BA323A48@vwiexc030.acri.local>
References: <3B970FB76033264EB34479EC8A365E1101BA31EA11@vwiexc030.acri.local>
	<CA+TxYvOz13NXGQX6acvOqtAUcLOt2aQH9xjnsq=mucAMjHTLrA@mail.gmail.com>
	<3B970FB76033264EB34479EC8A365E1101BA323A48@vwiexc030.acri.local>
Message-ID: <op.xwa59fjydbaoe8@macmarilu>



>
> Thanks a lot for your advices, my changes are already separated in  
> different local GIT commits, so I plan to deliver them >into separated  
> patches/tickets (I already did it for change 7 related to ticket #5291).

Hi Julien,

Please note that I had to reopen #5291 because unfortunately your patch,  
although it works, makes the reading unbearably slow.


Joaquim


>
> But I discussed with Even and before deliver the patches I have to add  
> unit tests for each patch (especially for new >features), but  
> unfortunately I don?t have a lot of free time to do this for the  
> moment...
>
>
> Cheers,
>
> Julien
>
>
> De : Etienne Tourigny [mailto:etourigny.dev at gmail.com]Envoy? : lundi 30  
> mars 2015 03:52
> ? : Julien Demaria
> Cc : gdal-dev at lists.osgeo.org
> Objet : Re: [gdal-dev] NetCDF driver improvements (including groups  
> support)
>
>
> Hi Julien
>
>
> These improvements look really great!  
>
> Unfortunately I am on a long-term vacation and semi-retired from my GIS  
> work. So I am sorry but I cannot really help on >testing and committing  
> the work...
>
> That is why I did not respond sooner.
>
>
> As the last "official" netcdf maintainer I should at least give some  
> comments.
>
>
> Perhaps Even can test the patches and commit them, or someone could step  
> in as a new netcdf maintainer.
>
>
> If it is possible, It would be best to separate these improvements into  
> a number of patches. In any case you should add your >patch(es) to a  
> number of new gdal trac ticket(s) (or existing ticket if it fixes a  
> bug).  I did significant improvements some time >ago and I understand  
> that it is hard to separate these improvements in several patches, so I  
> don't think it is absolutely >necessary to split them up - but it helps  
> debugging any regressions. Especially the groups support, I/O  
> improvements and >NASA products should have independent patches and  
> tickets.
>
>
> Regarding 10) it would be best to maintain backwards compatibility, but  
> if the issue is only with 1D dataset I don't think it >matters that much.
>
>
> Cheers,
>
> Etienne
>
>
> On Thu, Feb 5, 2015 at 11:10 PM, Julien Demaria  
> <Julien.Demaria at acri-st.fr> wrote:
>
> Hi GDAL team,
>
> I've implemented several improvements to the NetCDF driver and I would  
> like to provide them to the community.
> Main goal of the changes is to add full support of NetCDF-4 including  
> groups.
> NetCDF-4 is the future format of ESA Sentinel-3 products (no groups) and  
> NASA Ocean Color team is switching their L2/>L3 products to NetCDF-4  
> with groups (VIIRS has already switched to the new format in December).
> With the changes NASA L2 products geolocation is automatically handled  
> as geolocation arrays and can be reprojected using >gdalwarp.
>
> I validated with autotests that nothing is broken in tests netcdf.py  
> (excepting test 13 but see my point 5), netcdf_cf.py and >hdf5.py, using  
> NetCDF-3 and 4 libraries.
> I've also tested the new functionalities on various NetCDF-4 files.
> I think the only possible regression could be for marginal cases where a  
> file was seen directly as a dataset and is now seen as >multiple  
> subdatasets (for example if a file has only one var in the top group and  
> has nested groups containing variables), but I >think this is not very  
> common.
>
> For the moment I have all these changes in local GIT separated commits  
> on the latest gdal-1.11 branch, let me know what >changes you want and  
> how can I provide them.
>
> Changes :
>
> 1) Implement full support for NetCDF-4 groups on reading:
>    - explore recursively all nested groups to create the subdatasets list
>    - subdatasets in nested groups use the /group1/group2/.../groupn/var  
> standard
>      NetCDF-4 convention, excepting for variables in the root group  
> which do not
>      have a leading slash for backward compatibility
>    - when accessing a subdataset using NETCDF:$file:$path, the leading  
> slash is optional
>    - global attributes of each nested group are also collected in the  
> GDAL dataset
>      metadata, using the same convention  
> /group1/group2/.../groupn/NC_GLOBAL#attr_name,
>      excepting for the root group which do not have a leading slash for  
> backward compatibility
>    - when searching for a variable containing auxiliary information on  
> the selected subdataset,
>      like coordinate variables or grid_mapping, we now also search in  
> parent groups (using NCDFResolveVar).
>      I now this is something not specified at this time in the CF  
> convention because CF does not know groups,
>      but it seems logical to me to support this: NetCDF-4 specifies that  
> dimensions of a group are
>      shared to its nested groups, so associated coordinate variables  
> could be defined as the same level of its
>      corresponding dimension.
>    - reference to coordinate variables using the "coordinates" attribute  
> support now also absolute paths,
>      this allow for example to specify coordinate variables located  
> outside the group of the selected variable
>      or its parents. Relative paths could be implemented if needed.
>      This feature is used to add support for new NASA Ocean Color L2  
> products.
>
> 2) Implement full read/write support for new NetCDF4 types NC_UBYTE,  
> NC_USHORT, NC_UINT and NC_STRING, >only if NETCDF_HAS_NC4 is defined  
> (and only if format=NC4 for writing).
>    Support implemented for variables and attributes.
>    NC_STRING type is supported for reading (scalar and arrays)  
> attributes and is used for writing only for array attributes >(scalar  
> are still written as NC_CHAR).
>    If NETCDF_HAS_NC4 is not defined or format!=NC4, NC_STRING array  
> attributes are written as a single NC_CHAR >string using the GDAL  
> {v1,v2,...} convention.
>    Add missing support for NC_BYTE in CreateBandMetadata() and  
> NC_BYTE/SHORT in NCDFPut1DVar().
>
> 3) Add support for new NASA Ocean Color L2 products and ESA Sentinel-3  
> L1 or
>    L2 products which use the NetCDF-4 format (with groups for NASA, see
>    http://oceancolor.gsfc.nasa.gov/DOCS/FormatChange.html):
>    - NASA products: simulate a "coordinates" variable attribute to  
> detect CF
>      geolocation arrays, and set bBottomUp to FALSE
>    - ESA products: set bBottomUp to FALSE and disable warning on missing
>      Conventions attribute
>
> 4) Fix bug #4554 with a more generic solution by disabling the  
> installation of the HDF5 atexit() cleanup routine using >H5dont_atexit().
>    Previous fix was to call GDALExit() (for the moment only defined  
> gdalwarp.cpp) at the end of every program, which is >more painful.
>
> 5) Fix implementation of GetScale/Offset to not always return  
> pbSuccess=TRUE.
>    Fix CopyMetadata to handle bands with only scale or offset.
>    ==> WARNING this commit breaks the autotest netcdf_13 (check for  
> scale/offset = 1.0/0.0 if no scale or offset is >available), but for me  
> it is not logical to return always pbSuccess=TRUE
>
> 6) Optimize IReadBlock() and CheckData() handling of partial blocks in  
> the x axis by re-using the GDAL block buffer instead >of allocating a  
> new temporary buffer for each block.
>
> 7) Force block size to 1 scanline for bottom-up datasets if nBlockYSize  
> != 1 instead of raising a fatal error
>    ==> Solve a recent problem raised on the mailing list
>
> 8) Implement Get/SetUnitType using the standard "units" NetCDF attribute
>
> 9) Change default block size to 256x256 instead of scanline (only affect  
> file without NetCDF chunking)
>    ==> because I think this is better for a random access to the data,  
> but I'm not sure if the community want this change which >could impact  
> performances
>
> 10) I've also implemented for my needs support for 1D variables by  
> simulating 2D datasets with only one row (dimensionless >variables are  
> not supported for the moment),
>       but this breaks backward compatibility because files containing  
> only one variable and associated 1D coordinate variables >are now seen  
> as multiple sub datasets...
>       and maybe this is not the goal of GDAL to give access to  
> not-2D-raster variables (but sometimes it's useful ;-) )
>
> Thanks for GDAL!
>
> Julien
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150330/bc2a7e14/attachment.html>

From doug_newcomb at fws.gov  Mon Mar 30 05:14:45 2015
From: doug_newcomb at fws.gov (Newcomb, Doug)
Date: Mon, 30 Mar 2015 08:14:45 -0400
Subject: [gdal-dev] GSOC 2015 proposal - Integration of cpp GDAL
 utilities into GDAL core library
In-Reply-To: <CAJjdW1zdxY41O9SZrBr+GeOvYz5YUXbbhyTyXRkCm8mx0_8t2A@mail.gmail.com>
References: <CABRzcz8BOrqcbSW3=XMf+fxZO7txG2j+jys3dnHPEYbdoLVVfQ@mail.gmail.com>
	<CADEnnOPw9DVCBRQjZUHCb9+QREYBOG2pzTTO6XoOB+qkwtvwOw@mail.gmail.com>
	<201503272108.34617.even.rouault@spatialys.com>
	<CADEnnON2bCNGpXv5FoJeWSEfHj6HqxQuM6SOuUcwLuD=D9gw0w@mail.gmail.com>
	<CAJjdW1zdxY41O9SZrBr+GeOvYz5YUXbbhyTyXRkCm8mx0_8t2A@mail.gmail.com>
Message-ID: <CALQGVr0vB30Trcq=f-kQqQMXmZOSCferPUabU1Ro+6MZRv_PeA@mail.gmail.com>

+1

The utilities are used by a lot of folks who cannot have compilers loaded
on their computers for security reasons.

Doug

On Sat, Mar 28, 2015 at 6:06 AM, Damian Dixon <damian.dixon at gmail.com>
wrote:

> There are a lot of GIS specialists and geographers who are not programmers
> that use the tools to convert or query gis data before using within a
> commercial gis tool.
>
> I believe that there is merit in providing a higher level api.
>
> Just my two pennies worth... as a programmer... working for a GIS company.
>
> Regards
> Damian
> On 28 Mar 2015 09:47, "Peter Halls" <p.halls at york.ac.uk> wrote:
>
>> Thanks, Even and Daniel.  I see the logic behind the arguments.
>>
>> The stand-alone utilities are probably the most heavility used
>> GDAL/OGR code.  Once these have been subsumed into internal function
>> calls, do we continue to provides the stand-alone utilities?
>> Programming seems to be a cyclic requirement: 5-10 years ago the
>> clamour was solely for press and go stand-alone utilities; today there
>> are possibly more programmers - or, at least, the programmers have
>> become more vocal.  I've seen several such cycles over my career.
>>
>> I am not saying that the proposal is a bad idea, rather I am seeking
>> to test the proposal such that we continue to commit our scarce
>> resources where there is greatest benefit.
>>
>>
>> Best wishes,
>>
>> Peter
>>
>>
>> On 27 March 2015 at 20:08, Even Rouault <even.rouault at spatialys.com>
>> wrote:
>> > Peter,
>> >
>> >> Maybe I've missed the point (through over familiarity with GDAL/OGR?)
>> >> .... but these utilities were originally branded as 'worked examples'
>> >> of how to use the substantive libraries to perform well understood
>> >> operations from which usage of the libraries might be readily
>> >> understood.  Each utility is itself a commented set of function calls
>> >> to the relevent GDAL libraries.
>> >
>> > There is non trivial logic involved in some of the utilities (e.g.
>> ogr2ogr)
>> > and people have the choice between :
>> > - doing a system call ("ogr2ogr ...."), but this isn't practical to
>> deal with
>> > progress report, cancellation, or operating on in-memory datasets
>> > - copy&pasting the source code of the utility in their own code, and
>> > "librarify'ing" it to remove exit(), etc...
>> > - learning the GDAL/OGR API to do their own custom processing chain.
>> More
>> > powerfull but longer learning curve
>> >
>> > So the interest of the project would be to make life easier for people
>> using
>> > the first 2 bullets (and I can tell you that there are a lot of people
>> hitting
>> > those 2 bullets)
>> >
>> >> Why is there a need to duplicate this
>> >> in turning the utilities into function calls which then, in turn, must
>> >> be called by new stand-alone utilities?
>> >> There has to be a loss of
>> >> efficiency in sunch a process.
>> >
>> > I don't think there will be a loss of efficiency
>> >
>> > Instead of ogr2ogr.cpp being currently
>> >
>> > int main(...)
>> > {
>> >         complex_code
>> > }
>> >
>> > you would have (very schematically)
>> >
>> > ogr2ogr.cpp:
>> >
>> > int main(...)
>> > {
>> >        ogr2ogr_options = parse aguments()
>> >        return ogr2ogr(ogr2ogr_options)
>> > }
>> >
>> > and libgdalutils_ogr2ogr.cpp :
>> >
>> > int ogr2ogr(ogr2ogr_options)
>> > {
>> >      complex_code (moved from currently existing main)
>> > }
>> >
>> > Even
>> >
>> > --
>> > Spatialys - Geospatial professional services
>> > http://www.spatialys.com
>>
>>
>>
>> --
>>
>> ----------------------------------------------------------------------------------------------------------------
>> Peter J Halls, PhD Student, Post-war Reconstruction and Development Unit
>> (PRDU)
>>                      Department of Politics, University of York
>>
>> Snail mail: PRDU, Derwent College, University of York,
>>                 Heslington, York YO10 5DD
>> This message has the status of a private and personal communication
>>
>> ----------------------------------------------------------------------------------------------------------------
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
Doug Newcomb
USFWS
Raleigh, NC
919-856-4520 ext. 14 doug_newcomb at fws.gov
---------------------------------------------------------------------------------------------------------
The opinions I express are my own and are not representative of the
official policy of the U.S.Fish and Wildlife Service or Dept. of the
Interior.   Life is too short for undocumented, proprietary data formats.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150330/a72c8c07/attachment-0001.html>

From Julien.Demaria at acri-st.fr  Mon Mar 30 05:56:22 2015
From: Julien.Demaria at acri-st.fr (Julien Demaria)
Date: Mon, 30 Mar 2015 12:56:22 +0000
Subject: [gdal-dev] NetCDF driver improvements (including groups support)
In-Reply-To: <op.xwa59fjydbaoe8@macmarilu>
References: <3B970FB76033264EB34479EC8A365E1101BA31EA11@vwiexc030.acri.local>
	<CA+TxYvOz13NXGQX6acvOqtAUcLOt2aQH9xjnsq=mucAMjHTLrA@mail.gmail.com>
	<3B970FB76033264EB34479EC8A365E1101BA323A48@vwiexc030.acri.local>
	<op.xwa59fjydbaoe8@macmarilu>
Message-ID: <3B970FB76033264EB34479EC8A365E1101BA323B8C@vwiexc030.acri.local>

Hi Joaquim,

Yes I noted that and have no idea of the problem, I will try to analyze this asap.

Julien

De : gdal-dev-bounces at lists.osgeo.org [mailto:gdal-dev-bounces at lists.osgeo.org] De la part de Joaquim Luis
Envoy? : lundi 30 mars 2015 13:31
? : gdal-dev at lists.osgeo.org
Objet : Re: [gdal-dev] NetCDF driver improvements (including groups support)


Thanks a lot for your advices, my changes are already separated in different local GIT commits, so I plan to deliver them into separated patches/tickets (I already did it for change 7 related to ticket #5291).

Hi Julien,

Please note that I had to reopen #5291 because unfortunately your patch, although it works, makes the reading unbearably slow.


Joaquim


But I discussed with Even and before deliver the patches I have to add unit tests for each patch (especially for new features), but unfortunately I don?t have a lot of free time to do this for the moment...

Cheers,
Julien

De : Etienne Tourigny [mailto:etourigny.dev at gmail.com]
Envoy? : lundi 30 mars 2015 03:52
? : Julien Demaria
Cc : gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Objet : Re: [gdal-dev] NetCDF driver improvements (including groups support)

Hi Julien

These improvements look really great!

Unfortunately I am on a long-term vacation and semi-retired from my GIS work. So I am sorry but I cannot really help on testing and committing the work...
That is why I did not respond sooner.

As the last "official" netcdf maintainer I should at least give some comments.

Perhaps Even can test the patches and commit them, or someone could step in as a new netcdf maintainer.

If it is possible, It would be best to separate these improvements into a number of patches. In any case you should add your patch(es) to a number of new gdal trac ticket(s) (or existing ticket if it fixes a bug).  I did significant improvements some time ago and I understand that it is hard to separate these improvements in several patches, so I don't think it is absolutely necessary to split them up - but it helps debugging any regressions. Especially the groups support, I/O improvements and NASA products should have independent patches and tickets.

Regarding 10) it would be best to maintain backwards compatibility, but if the issue is only with 1D dataset I don't think it matters that much.

Cheers,
Etienne

On Thu, Feb 5, 2015 at 11:10 PM, Julien Demaria <Julien.Demaria at acri-st.fr<mailto:Julien.Demaria at acri-st.fr>> wrote:
Hi GDAL team,

I've implemented several improvements to the NetCDF driver and I would like to provide them to the community.
Main goal of the changes is to add full support of NetCDF-4 including groups.
NetCDF-4 is the future format of ESA Sentinel-3 products (no groups) and NASA Ocean Color team is switching their L2/L3 products to NetCDF-4 with groups (VIIRS has already switched to the new format in December).
With the changes NASA L2 products geolocation is automatically handled as geolocation arrays and can be reprojected using gdalwarp.

I validated with autotests that nothing is broken in tests netcdf.py (excepting test 13 but see my point 5), netcdf_cf.py and hdf5.py, using NetCDF-3 and 4 libraries.
I've also tested the new functionalities on various NetCDF-4 files.
I think the only possible regression could be for marginal cases where a file was seen directly as a dataset and is now seen as multiple subdatasets (for example if a file has only one var in the top group and has nested groups containing variables), but I think this is not very common.

For the moment I have all these changes in local GIT separated commits on the latest gdal-1.11 branch, let me know what changes you want and how can I provide them.

Changes :

1) Implement full support for NetCDF-4 groups on reading:
    - explore recursively all nested groups to create the subdatasets list
    - subdatasets in nested groups use the /group1/group2/.../groupn/var standard
      NetCDF-4 convention, excepting for variables in the root group which do not
      have a leading slash for backward compatibility
    - when accessing a subdataset using NETCDF:$file:$path, the leading slash is optional
    - global attributes of each nested group are also collected in the GDAL dataset
      metadata, using the same convention /group1/group2/.../groupn/NC_GLOBAL#attr_name,
      excepting for the root group which do not have a leading slash for backward compatibility
    - when searching for a variable containing auxiliary information on the selected subdataset,
      like coordinate variables or grid_mapping, we now also search in parent groups (using NCDFResolveVar).
      I now this is something not specified at this time in the CF convention because CF does not know groups,
      but it seems logical to me to support this: NetCDF-4 specifies that dimensions of a group are
      shared to its nested groups, so associated coordinate variables could be defined as the same level of its
      corresponding dimension.
    - reference to coordinate variables using the "coordinates" attribute support now also absolute paths,
      this allow for example to specify coordinate variables located outside the group of the selected variable
      or its parents. Relative paths could be implemented if needed.
      This feature is used to add support for new NASA Ocean Color L2 products.

2) Implement full read/write support for new NetCDF4 types NC_UBYTE, NC_USHORT, NC_UINT and NC_STRING, only if NETCDF_HAS_NC4 is defined (and only if format=NC4 for writing).
    Support implemented for variables and attributes.
    NC_STRING type is supported for reading (scalar and arrays) attributes and is used for writing only for array attributes (scalar are still written as NC_CHAR).
    If NETCDF_HAS_NC4 is not defined or format!=NC4, NC_STRING array attributes are written as a single NC_CHAR string using the GDAL {v1,v2,...} convention.
    Add missing support for NC_BYTE in CreateBandMetadata() and NC_BYTE/SHORT in NCDFPut1DVar().

3) Add support for new NASA Ocean Color L2 products and ESA Sentinel-3 L1 or
    L2 products which use the NetCDF-4 format (with groups for NASA, see
    http://oceancolor.gsfc.nasa.gov/DOCS/FormatChange.html):
    - NASA products: simulate a "coordinates" variable attribute to detect CF
      geolocation arrays, and set bBottomUp to FALSE
    - ESA products: set bBottomUp to FALSE and disable warning on missing
      Conventions attribute

4) Fix bug #4554 with a more generic solution by disabling the installation of the HDF5 atexit() cleanup routine using H5dont_atexit().
    Previous fix was to call GDALExit() (for the moment only defined gdalwarp.cpp) at the end of every program, which is more painful.

5) Fix implementation of GetScale/Offset to not always return pbSuccess=TRUE.
    Fix CopyMetadata to handle bands with only scale or offset.
    ==> WARNING this commit breaks the autotest netcdf_13 (check for scale/offset = 1.0/0.0 if no scale or offset is available), but for me it is not logical to return always pbSuccess=TRUE

6) Optimize IReadBlock() and CheckData() handling of partial blocks in the x axis by re-using the GDAL block buffer instead of allocating a new temporary buffer for each block.

7) Force block size to 1 scanline for bottom-up datasets if nBlockYSize != 1 instead of raising a fatal error
    ==> Solve a recent problem raised on the mailing list

8) Implement Get/SetUnitType using the standard "units" NetCDF attribute

9) Change default block size to 256x256 instead of scanline (only affect file without NetCDF chunking)
    ==> because I think this is better for a random access to the data, but I'm not sure if the community want this change which could impact performances

10) I've also implemented for my needs support for 1D variables by simulating 2D datasets with only one row (dimensionless variables are not supported for the moment),
       but this breaks backward compatibility because files containing only one variable and associated 1D coordinate variables are now seen as multiple sub datasets...
       and maybe this is not the goal of GDAL to give access to not-2D-raster variables (but sometimes it's useful ;-) )

Thanks for GDAL!

Julien

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
http://lists.osgeo.org/mailman/listinfo/gdal-dev



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150330/40acd0e6/attachment-0001.html>

From sean at mapbox.com  Mon Mar 30 07:40:18 2015
From: sean at mapbox.com (Sean Gillies)
Date: Mon, 30 Mar 2015 08:40:18 -0600
Subject: [gdal-dev] RFC 44: Add Parseable Output Formats for ogrinfo and
	gdalinfo
In-Reply-To: <CAFLLRpKQVQ8C5dtxgaZYQ_N0hE33DemxNQwuWGaov1fe4G=v8g@mail.gmail.com>
References: <SNT146-W50F15D408B08E67D5B75A4DEF70@phx.gbl>
	<CAFLLRpKQVQ8C5dtxgaZYQ_N0hE33DemxNQwuWGaov1fe4G=v8g@mail.gmail.com>
Message-ID: <CADPhZXysyDJt8nsLpkVrvjCJ8UmNf9vreiAYSwxUAGRbVmvaaw@mail.gmail.com>

Hi all,

I recommend that JSON item names match the names of methods of the GDAL
API. If not precisely, then at least in a consistent and predictable way.
Introducing new names increases the amount of needed documentation and
generally sows confusion.

For example, Rasterio's rio-info command (you may remember me presenting
about this at FOSS4G 2014), returns JSON with items like "bounds", "res",
"shape" just like in Rasterio's API.


https://github.com/sgillies/frs-cheat-sheet/blob/master/README.md#get-raster-information

For GDAL, I agree with Rob Coup that verbose is going to be better.
"colorInterpolation" matches the GDAL API method and is going to work out
better than "colorInterp":


http://www.gdal.org/classGDALRasterBand.html#a772e1232ac07944e4c6bce3c66f98103


On Sun, Mar 29, 2015 at 4:58 PM, Robert Coup <robert.coup at koordinates.com>
wrote:

> Hi,
>
> Good work, thanks for taking this on!
>
> 1: Is there any particular reason to implement XML? Every language has a
> good JSON parser these days, as you note in the RFC XML is more complex to
> implement, and it's not like strict schemas or streaming (usual reasons for
> XML) are going to be in place.
>
> 2: In terms of the proposed gdalinfo JSON...
>
> a) bands[0].band == 1 -- any reason to favour this over the implicit index
> in the bands[] array?
>
> b) personally I'd prefer to be slightly more verbose in attribute naming.
> eg. block -> blockSize, colorInterp -> colorInterpolation, proj -> proj4
>
> c) There's support for multiple RATs in a single dataset, but the JSON
> format only allows one. Maybe rats: {"name": {... attributes...}}?
>
> d) HDF-derived formats (and probably some others) have support for
> multiple datasets/component images. Is that something we could incorporate
> (maybe with a top-level object surrounding each dataset description)?
>
> There may be a few other elements where there's support (either now or in
> the forseeable future) for multiple items. @Even, any thoughts?
>
> 3: Keen to see the ogrinfo equivalent!
>
> Rob :)
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150330/dced372b/attachment.html>

From Stefan.Blumentrath at nina.no  Mon Mar 30 08:22:30 2015
From: Stefan.Blumentrath at nina.no (Blumentrath, Stefan)
Date: Mon, 30 Mar 2015 15:22:30 +0000
Subject: [gdal-dev] GDAL-GRASS-plugin 1.11.2
Message-ID: <65a7d234560140fd83780740f7ffa915@NINSRV23.nina.no>

Hi,

I just tried to compile the GDAL-GRASS-plugin 1.11.2 against GRASS 7.0.1 (the release branch).

It seems that there are some issues with the configure /configure.in file in the plugin

There ".7.0.svn" is hard coded in the library links (while the stable release puts the libraries in a folder ending on ".7.0.1svn"). So, I had to run:
sed -i 's/\.7\.0\.svn/.7.0.1svn/g' configure
In order to be able to configure the plugin.

After that it seems to work fine although I get a warning messages on ./configure:
"
checking for ranlib... ranlib
conftest2.c: In function 'g':
conftest2.c:2:1: warning: zero-length gnu_printf format string [-Wformat-zero-length]
void g(); void g(){printf("");}
^
"

Furthermore, I had to specify the includes for my PostgreSQL in order to make "make" work:
CPPFLAGS="-I/usr/include/postgresql" ./configure --with-grass=/usr/local/grass-7.0.1svn --with-gdal=/usr/local/bin/gdal-config

I also got an error on "sudo make install":
cp: cannot stat '/usr/local/grass-7.0.1svn/etc/ellipse.table': No such file or directory
make: *** [install] Error 1

But GDAL / OGR do now read both GRASS 7 raster and vector nicely...

Kind regards,
Stefan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150330/fae76e61/attachment.html>

From tkeitt at utexas.edu  Mon Mar 30 08:50:04 2015
From: tkeitt at utexas.edu (Tim Keitt)
Date: Mon, 30 Mar 2015 10:50:04 -0500
Subject: [gdal-dev] GSOC 2015 proposal - Integration of cpp GDAL
 utilities into GDAL core library
In-Reply-To: <CALQGVr0vB30Trcq=f-kQqQMXmZOSCferPUabU1Ro+6MZRv_PeA@mail.gmail.com>
References: <CABRzcz8BOrqcbSW3=XMf+fxZO7txG2j+jys3dnHPEYbdoLVVfQ@mail.gmail.com>
	<CADEnnOPw9DVCBRQjZUHCb9+QREYBOG2pzTTO6XoOB+qkwtvwOw@mail.gmail.com>
	<201503272108.34617.even.rouault@spatialys.com>
	<CADEnnON2bCNGpXv5FoJeWSEfHj6HqxQuM6SOuUcwLuD=D9gw0w@mail.gmail.com>
	<CAJjdW1zdxY41O9SZrBr+GeOvYz5YUXbbhyTyXRkCm8mx0_8t2A@mail.gmail.com>
	<CALQGVr0vB30Trcq=f-kQqQMXmZOSCferPUabU1Ro+6MZRv_PeA@mail.gmail.com>
Message-ID: <CANnL8gpr0U7miHwjqatKHOvHZAaUqsNeqwP20XsqRDfYG1d6hA@mail.gmail.com>

On Mon, Mar 30, 2015 at 7:14 AM, Newcomb, Doug <doug_newcomb at fws.gov> wrote:

> +1
>
> The utilities are used by a lot of folks who cannot have compilers loaded
> on their computers for security reasons.
>
> Doug
>
> On Sat, Mar 28, 2015 at 6:06 AM, Damian Dixon <damian.dixon at gmail.com>
> wrote:
>
>> There are a lot of GIS specialists and geographers who are not
>> programmers that use the tools to convert or query gis data before using
>> within a commercial gis tool.
>>
>> I believe that there is merit in providing a higher level api.
>>
>> Just my two pennies worth... as a programmer... working for a GIS company
>>
>
This is an excellent proposal. The current utilities are giant passages of
uninterrupted code. This makes them hard to maintain, extend and reuse. The
"main" function in these utilities should be a short sequence of function
calls to smaller blocks of code, which in turn should each be a short
sequence of function calls into yet smaller code blocks. Building a nice
API boundary between the utilities and GDAL core would be a big step
forward. As someone that writes wrappers for GDAL, I would really like to
be able to use the code from those utilities via a well-defined API. I've
gone as far as copying the utility code into a separate file and the
re-writing the main function as a function call interface and then linked
against this code. It would be really nice to have the functionality of the
utility programs callable from one or a small number of C API functions.

THK

-- 
http://www.keittlab.org/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150330/094190ba/attachment.html>

From landa.martin at gmail.com  Mon Mar 30 08:54:24 2015
From: landa.martin at gmail.com (Martin Landa)
Date: Mon, 30 Mar 2015 17:54:24 +0200
Subject: [gdal-dev] [GRASS-dev] GDAL-GRASS-plugin 1.11.2
In-Reply-To: <65a7d234560140fd83780740f7ffa915@NINSRV23.nina.no>
References: <65a7d234560140fd83780740f7ffa915@NINSRV23.nina.no>
Message-ID: <CA+Ei1OcJ6uuQ12N6CJ=jC26BwtM8jL90mYcQaH9yQoqfy2zr-w@mail.gmail.com>

Hi,

2015-03-30 17:22 GMT+02:00 Blumentrath, Stefan <Stefan.Blumentrath at nina.no>:
> I just tried to compile the GDAL-GRASS-plugin 1.11.2 against GRASS 7.0.1
> (the release branch).

it should be already fixed in SVN [1], so fixed for upcoming GDAL
1.11.3, see [2]. Martin

[1] http://svn.osgeo.org/gdal/branches/1.11/
[2] http://trac.osgeo.org/gdal/ticket/5852

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.cz/mentors/landa

From etourigny.dev at gmail.com  Mon Mar 30 09:10:03 2015
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Mon, 30 Mar 2015 23:10:03 +0700
Subject: [gdal-dev] trouble with netCDF in C#?
In-Reply-To: <F8C3C6DB66146D45BB0C091BEA01D9E1123136CA@HERMES.landcare.ad.landcareresearch.co.nz>
References: <F8C3C6DB66146D45BB0C091BEA01D9E1123136CA@HERMES.landcare.ad.landcareresearch.co.nz>
Message-ID: <CA+TxYvNn-SpncKCF89HiSMhTFchm1EfvOisRXxYkS5ozXrrjWQ@mail.gmail.com>

Does this happen when you use gdal_translate to copy the netcdf file to
another format (say gtiff)?

I am not familiar with c# but there must be a way to compile gdal and you
application to get the exact line of code that causes the crash?

Etienne

On Mon, Mar 16, 2015 at 8:57 AM, Robbie Price <PriceR at landcareresearch.co.nz
> wrote:

>  I?m having trouble converting some netcdf (version 3) files to Kea files
> using the GDAL C# bindings.
>
>
>
> The problem is some form of memory leak caused by the netCDF code (from
> what I can establish through various tests).
>
>
>
> There are two issues:
>
> 1)       A memory leak in this call (which I noticed, but can work around
> as I am only dealing with a small number of subdatasets)
>
> a.  dsNetCDF = OSGeo.GDAL.Gdal.Open(strNetCDF_DSN, OSGeo.GDAL.Access
> .GA_ReadOnly);
>
> 2)      A memory issue/leak pointer assignment causing a crash that I
> cannot trace the error reports as:
>
>
>
> Managed Debugging Assistant 'FatalExecutionEngineError' has detected a
> problem in
> 'O:\Projects\KEA_ReadWrite\bin\x64\Debug\KEA_ReadWrite.vshost.exe'.
>
> Additional Information: The runtime has encountered a fatal error. The
> address of the error was at 0xebc85654, on thread 0x16ec. The error code is
> 0xc0000005. This error may be a bug in the CLR or in the unsafe or
> non-verifiable portions of user code. Common sources of this bug include
> user marshaling errors for COM-interop or PInvoke, which may corrupt the
> stack.
>
>
>
> The error is consistent in nature but happens inconsistently in the code
> (between 1800 and 4000 bands) ? here from another run:
>
> Managed Debugging Assistant 'FatalExecutionEngineError' has detected a
> problem in
> 'O:\Projects\KEA_ReadWrite\bin\x64\Debug\KEA_ReadWrite.vshost.exe'.
>
> Additional Information: The runtime has encountered a fatal error. The
> address of the error was at 0xebc85654, on thread 0x199c. The error code is
> 0xc0000005. This error may be a bug in the CLR or in the unsafe or
> non-verifiable portions of user code. Common sources of this bug include
> user marshaling errors for COM-interop or PInvoke, which may corrupt the
> stack.
>
>
>
> The error *MAY* be occurring more often only on lines handling string
> functions (?)
>
>
>
> Version Details
>
>
>
> Using MSVS 2010 (C#) and the following:
>
>
>
>
> http://www.gisinternals.com/query.html?content=filelist&file=release-1600-x64-gdal-mapserver.zip
>
>
>
> *gdal-200-1600-x64-core.msi*
> <http://download2.gisinternals.com/sdk/Download.aspx?file=release-1600-x64-gdal-mapserver/gdal-200-1600-x64-core.msi>
>
> 3/15/2015 4:13 AM
>
> 21556 kB
>
> Generic installer for the GDAL core components
>
>
>
>
>
> Basic scenario is converting from one file type to another but taking the
> meta info from the NetCDF and using as band name info in the Kea file.
> Input files have between 365 and 8000 bands but not large spatially
> (260*243).
>
> ------------------------------
>
> Please consider the environment before printing this email
> Warning: This electronic message together with any attachments is
> confidential. If you receive it in error: (i) you must not read, use,
> disclose, copy or retain it; (ii) please contact the sender immediately by
> reply email and then delete the emails.
> The views expressed in this email may not be those of Landcare Research
> New Zealand Limited. http://www.landcareresearch.co.nz
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150330/1acd3afd/attachment-0001.html>

From neteler at osgeo.org  Mon Mar 30 09:16:16 2015
From: neteler at osgeo.org (Markus Neteler)
Date: Mon, 30 Mar 2015 18:16:16 +0200
Subject: [gdal-dev] [GRASS-dev] GDAL-GRASS-plugin 1.11.2
In-Reply-To: <65a7d234560140fd83780740f7ffa915@NINSRV23.nina.no>
References: <65a7d234560140fd83780740f7ffa915@NINSRV23.nina.no>
Message-ID: <CALFmHhvgzK5ifA-vdVCq1aBLr-5wxaHCfj48KOOwqZY=sBeFfQ@mail.gmail.com>

On Mon, Mar 30, 2015 at 5:22 PM, Blumentrath, Stefan
<Stefan.Blumentrath at nina.no> wrote:
...
> I also got an error on ?sudo make install?:
>
> cp: cannot stat ?/usr/local/grass-7.0.1svn/etc/ellipse.table?: No such file
> or directory
>
> make: *** [install] Error 1


The path changed between G6 and G7, it should be

etc/proj/*

@Martin, is this fixed as well?

thanks
Markus

From landa.martin at gmail.com  Mon Mar 30 09:27:30 2015
From: landa.martin at gmail.com (Martin Landa)
Date: Mon, 30 Mar 2015 18:27:30 +0200
Subject: [gdal-dev] [GRASS-dev] GDAL-GRASS-plugin 1.11.2
In-Reply-To: <CALFmHhvgzK5ifA-vdVCq1aBLr-5wxaHCfj48KOOwqZY=sBeFfQ@mail.gmail.com>
References: <65a7d234560140fd83780740f7ffa915@NINSRV23.nina.no>
	<CALFmHhvgzK5ifA-vdVCq1aBLr-5wxaHCfj48KOOwqZY=sBeFfQ@mail.gmail.com>
Message-ID: <CA+Ei1Oe1cYn7R3VkbGPK5pQyvSwnnC=18zr6ujJN70T_T3wuNA@mail.gmail.com>

2015-03-30 18:16 GMT+02:00 Markus Neteler <neteler at osgeo.org>:
> The path changed between G6 and G7, it should be
>
> etc/proj/*
>
> @Martin, is this fixed as well?

yes [1]. Martin

[1] http://trac.osgeo.org/gdal/browser/branches/1.11/gdal/frmts/grass/pkg/Makefile.in#L30

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.cz/mentors/landa

From Stefan.Blumentrath at nina.no  Mon Mar 30 13:07:03 2015
From: Stefan.Blumentrath at nina.no (Blumentrath, Stefan)
Date: Mon, 30 Mar 2015 20:07:03 +0000
Subject: [gdal-dev] [GRASS-dev] GDAL-GRASS-plugin 1.11.2
In-Reply-To: <CA+Ei1Oe1cYn7R3VkbGPK5pQyvSwnnC=18zr6ujJN70T_T3wuNA@mail.gmail.com>
References: <65a7d234560140fd83780740f7ffa915@NINSRV23.nina.no>
	<CALFmHhvgzK5ifA-vdVCq1aBLr-5wxaHCfj48KOOwqZY=sBeFfQ@mail.gmail.com>
	<CA+Ei1Oe1cYn7R3VkbGPK5pQyvSwnnC=18zr6ujJN70T_T3wuNA@mail.gmail.com>
Message-ID: <f714644b37914347a7941eacb9e0d637@NINSRV23.nina.no>

Thanks Martin,

I just downloaded configure.in, configure and Makefile.in and now it works.
I still get the conftest2 warning, but that does not matter I guess...(?).

Cheers
Stefan



-----Original Message-----
From: Martin Landa [mailto:landa.martin at gmail.com] 
Sent: 30. mars 2015 18:28
To: Markus Neteler
Cc: Blumentrath, Stefan; gdal-dev (gdal-dev at lists.osgeo.org); GRASS developers list (grass-dev at lists.osgeo.org)
Subject: Re: [gdal-dev] [GRASS-dev] GDAL-GRASS-plugin 1.11.2

2015-03-30 18:16 GMT+02:00 Markus Neteler <neteler at osgeo.org>:
> The path changed between G6 and G7, it should be
>
> etc/proj/*
>
> @Martin, is this fixed as well?

yes [1]. Martin

[1] http://trac.osgeo.org/gdal/browser/branches/1.11/gdal/frmts/grass/pkg/Makefile.in#L30

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.cz/mentors/landa

From schut at sarvision.nl  Tue Mar 31 01:55:52 2015
From: schut at sarvision.nl (Vincent Schut)
Date: Tue, 31 Mar 2015 10:55:52 +0200
Subject: [gdal-dev] building with libkea should use kea-config --hdfincludes
Message-ID: <551A6118.9010701@sarvision.nl>

Hi,

I'm building gdal (svn trunk, updated this morning) on a debian (testing) server with libkea (own build). Libkea uses hdf5, and debian put's its hdf5 include files in /usr/include/hdf5/serial. Gdal build fails on libkea with:

Entering directory '/usr/local/src/gdal/frmts/kea'
/bin/bash /usr/local/src/gdal/libtool --mode=compile --tag=CXX g++ -I/usr/local/src/gdal/port -I/usr/local/src/gdal/gcore -I/usr/local/src/gdal/alg -I/usr/local/src/gdal/ogr -I/usr/local/src/gdal/ogr/ogrsf_frmts -g -O2  -Wall -Wunused-parameter  -I/usr/local/include   -DOGR_ENABLED -I/usr/local/src/gdal/port  -DGDAL_COMPILATION -c -o ../o/keaband.lo keaband.cpp
libtool: compile:  g++ -I/usr/local/src/gdal/port -I/usr/local/src/gdal/gcore -I/usr/local/src/gdal/alg -I/usr/local/src/gdal/ogr -I/usr/local/src/gdal/ogr/ogrsf_frmts -g -O2 -Wall -Wunused-parameter -I/usr/local/include -DOGR_ENABLED -I/usr/local/src/gdal/port -DGDAL_COMPILATION -c keaband.cpp  -fPIC -DPIC -o ../o/.libs/keaband.o
In file included from keadataset.h:35:0,
                  from keaband.h:35,
                  from keaband.cpp:31:
/usr/local/include/libkea/KEAImageIO.h:38:19: fatal error: H5Cpp.h: No such file or directory
  #include "H5Cpp.h"
                    ^
compilation terminated.
../../GDALmake.opt:572: recipe for target '../o/keaband.lo' failed


H5Cpp.h is in /usr/include/hdf5/serial, and that folder is given by kea-config --hdfincludes:

kea-config --hdfincludes
/usr/include/hdf5/serial

Shouldnt gdal use that output from kea-config to pass to the compile command as -I (and maybe also kea-config --hdflibs)?


Best,
Vincent.

From even.rouault at spatialys.com  Tue Mar 31 02:13:58 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 31 Mar 2015 11:13:58 +0200
Subject: [gdal-dev] building with libkea should use kea-config
	--hdfincludes
In-Reply-To: <551A6118.9010701@sarvision.nl>
References: <551A6118.9010701@sarvision.nl>
Message-ID: <201503311113.58401.even.rouault@spatialys.com>

Le mardi 31 mars 2015 10:55:52, Vincent Schut a ?crit :
> Hi,
> 
> I'm building gdal (svn trunk, updated this morning) on a debian (testing)
> server with libkea (own build). Libkea uses hdf5, and debian put's its
> hdf5 include files in /usr/include/hdf5/serial. Gdal build fails on libkea
> with:
> 
> Entering directory '/usr/local/src/gdal/frmts/kea'
> /bin/bash /usr/local/src/gdal/libtool --mode=compile --tag=CXX g++
> -I/usr/local/src/gdal/port -I/usr/local/src/gdal/gcore
> -I/usr/local/src/gdal/alg -I/usr/local/src/gdal/ogr
> -I/usr/local/src/gdal/ogr/ogrsf_frmts -g -O2  -Wall -Wunused-parameter 
> -I/usr/local/include   -DOGR_ENABLED -I/usr/local/src/gdal/port 
> -DGDAL_COMPILATION -c -o ../o/keaband.lo keaband.cpp libtool: compile: 
> g++ -I/usr/local/src/gdal/port -I/usr/local/src/gdal/gcore
> -I/usr/local/src/gdal/alg -I/usr/local/src/gdal/ogr
> -I/usr/local/src/gdal/ogr/ogrsf_frmts -g -O2 -Wall -Wunused-parameter
> -I/usr/local/include -DOGR_ENABLED -I/usr/local/src/gdal/port
> -DGDAL_COMPILATION -c keaband.cpp  -fPIC -DPIC -o ../o/.libs/keaband.o In
> file included from keadataset.h:35:0,
>                   from keaband.h:35,
>                   from keaband.cpp:31:
> /usr/local/include/libkea/KEAImageIO.h:38:19: fatal error: H5Cpp.h: No such
> file or directory #include "H5Cpp.h"
>                     ^
> compilation terminated.
> ../../GDALmake.opt:572: recipe for target '../o/keaband.lo' failed
> 
> 
> H5Cpp.h is in /usr/include/hdf5/serial, and that folder is given by
> kea-config --hdfincludes:
> 
> kea-config --hdfincludes
> /usr/include/hdf5/serial
> 
> Shouldnt gdal use that output from kea-config to pass to the compile
> command as -I (and maybe also kea-config --hdflibs)?

Hi Vincent,

makes sense. I've committed the addition of --hdflibs to KEA_LIB and --hdfcflags 
to KEA_INC

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From schut at sarvision.nl  Tue Mar 31 02:16:08 2015
From: schut at sarvision.nl (Vincent Schut)
Date: Tue, 31 Mar 2015 11:16:08 +0200
Subject: [gdal-dev] building with libkea should use kea-config
	--hdfincludes
In-Reply-To: <551A6118.9010701@sarvision.nl>
References: <551A6118.9010701@sarvision.nl>
Message-ID: <551A65D8.6020706@sarvision.nl>

Saw that configure.in uses kea-config --cflags, which only results in the direct kea include dir being included. Here's a patch which uses --includes and --hdfincludes, which seems to work for me (need to run autogen.sh afterwards).

Vincent.


On 03/31/2015 10:55 AM, Vincent Schut wrote:
> Hi,
>
> I'm building gdal (svn trunk, updated this morning) on a debian (testing) server with libkea (own build). Libkea uses hdf5, and debian put's its hdf5 include files in /usr/include/hdf5/serial. Gdal build fails on libkea with:
>
> Entering directory '/usr/local/src/gdal/frmts/kea'
> /bin/bash /usr/local/src/gdal/libtool --mode=compile --tag=CXX g++ -I/usr/local/src/gdal/port -I/usr/local/src/gdal/gcore -I/usr/local/src/gdal/alg -I/usr/local/src/gdal/ogr -I/usr/local/src/gdal/ogr/ogrsf_frmts -g -O2  -Wall -Wunused-parameter  -I/usr/local/include   -DOGR_ENABLED -I/usr/local/src/gdal/port  -DGDAL_COMPILATION -c -o ../o/keaband.lo keaband.cpp
> libtool: compile:  g++ -I/usr/local/src/gdal/port -I/usr/local/src/gdal/gcore -I/usr/local/src/gdal/alg -I/usr/local/src/gdal/ogr -I/usr/local/src/gdal/ogr/ogrsf_frmts -g -O2 -Wall -Wunused-parameter -I/usr/local/include -DOGR_ENABLED -I/usr/local/src/gdal/port -DGDAL_COMPILATION -c keaband.cpp -fPIC -DPIC -o ../o/.libs/keaband.o
> In file included from keadataset.h:35:0,
>                  from keaband.h:35,
>                  from keaband.cpp:31:
> /usr/local/include/libkea/KEAImageIO.h:38:19: fatal error: H5Cpp.h: No such file or directory
>  #include "H5Cpp.h"
>                    ^
> compilation terminated.
> ../../GDALmake.opt:572: recipe for target '../o/keaband.lo' failed
>
>
> H5Cpp.h is in /usr/include/hdf5/serial, and that folder is given by kea-config --hdfincludes:
>
> kea-config --hdfincludes
> /usr/include/hdf5/serial
>
> Shouldnt gdal use that output from kea-config to pass to the compile command as -I (and maybe also kea-config --hdflibs)?
>
>
> Best,
> Vincent.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
Index: configure.in
===================================================================
--- configure.in	(revision 28826)
+++ configure.in	(working copy)
@@ -1810,7 +1810,7 @@
 
   HAVE_KEA=yes
   KEA_LIB="`$KEA_CONFIG --libs`"
-  KEA_INC="`$KEA_CONFIG --cflags`"
+  KEA_INC="-I`$KEA_CONFIG --includes` -I`$KEA_CONFIG --hdfincludes`"
   AC_MSG_RESULT([yes]) 
 fi
 

From schut at sarvision.nl  Tue Mar 31 02:30:06 2015
From: schut at sarvision.nl (Vincent Schut)
Date: Tue, 31 Mar 2015 11:30:06 +0200
Subject: [gdal-dev] building with libkea should use kea-config
	--hdfincludes
In-Reply-To: <201503311113.58401.even.rouault@spatialys.com>
References: <551A6118.9010701@sarvision.nl>
	<201503311113.58401.even.rouault@spatialys.com>
Message-ID: <551A691E.5080904@sarvision.nl>

Thanks Even, builds fine now.


On 03/31/2015 11:13 AM, Even Rouault wrote:
> Le mardi 31 mars 2015 10:55:52, Vincent Schut a ?crit :
>> Hi,
>>
>> I'm building gdal (svn trunk, updated this morning) on a debian (testing)
>> server with libkea (own build). Libkea uses hdf5, and debian put's its
>> hdf5 include files in /usr/include/hdf5/serial. Gdal build fails on libkea
>> with:
>>
>> Entering directory '/usr/local/src/gdal/frmts/kea'
>> /bin/bash /usr/local/src/gdal/libtool --mode=compile --tag=CXX g++
>> -I/usr/local/src/gdal/port -I/usr/local/src/gdal/gcore
>> -I/usr/local/src/gdal/alg -I/usr/local/src/gdal/ogr
>> -I/usr/local/src/gdal/ogr/ogrsf_frmts -g -O2  -Wall -Wunused-parameter
>> -I/usr/local/include   -DOGR_ENABLED -I/usr/local/src/gdal/port
>> -DGDAL_COMPILATION -c -o ../o/keaband.lo keaband.cpp libtool: compile:
>> g++ -I/usr/local/src/gdal/port -I/usr/local/src/gdal/gcore
>> -I/usr/local/src/gdal/alg -I/usr/local/src/gdal/ogr
>> -I/usr/local/src/gdal/ogr/ogrsf_frmts -g -O2 -Wall -Wunused-parameter
>> -I/usr/local/include -DOGR_ENABLED -I/usr/local/src/gdal/port
>> -DGDAL_COMPILATION -c keaband.cpp  -fPIC -DPIC -o ../o/.libs/keaband.o In
>> file included from keadataset.h:35:0,
>>                    from keaband.h:35,
>>                    from keaband.cpp:31:
>> /usr/local/include/libkea/KEAImageIO.h:38:19: fatal error: H5Cpp.h: No such
>> file or directory #include "H5Cpp.h"
>>                      ^
>> compilation terminated.
>> ../../GDALmake.opt:572: recipe for target '../o/keaband.lo' failed
>>
>>
>> H5Cpp.h is in /usr/include/hdf5/serial, and that folder is given by
>> kea-config --hdfincludes:
>>
>> kea-config --hdfincludes
>> /usr/include/hdf5/serial
>>
>> Shouldnt gdal use that output from kea-config to pass to the compile
>> command as -I (and maybe also kea-config --hdflibs)?
> Hi Vincent,
>
> makes sense. I've committed the addition of --hdflibs to KEA_LIB and --hdfcflags
> to KEA_INC
>
> Even
>


From jdeolive at gmail.com  Tue Mar 31 07:06:18 2015
From: jdeolive at gmail.com (Justin Deoliveira)
Date: Tue, 31 Mar 2015 08:06:18 -0600
Subject: [gdal-dev] gdal jar in maven central
Message-ID: <CAGLyg+rgkurE7yiv4c9UsXtBiXJaXuL2UnK8WTT+6PuWAiMZkg@mail.gmail.com>

Hi all,

I searched the archives and couldn't find much on this topic. I was
wondering how people would feel about having the gdal java jar hosted in
the central maven repository? I think it would be pretty nice for users to
not have to build the bindings locally, or find a repository that has them.

Any thoughts, objections, or concerns?

If people are into the idea I would be happy to put in the work to make it
happen.

Thanks!

-Justin
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150331/e036a253/attachment.html>

From even.rouault at spatialys.com  Tue Mar 31 07:25:56 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 31 Mar 2015 16:25:56 +0200
Subject: [gdal-dev] gdal jar in maven central
In-Reply-To: <CAGLyg+rgkurE7yiv4c9UsXtBiXJaXuL2UnK8WTT+6PuWAiMZkg@mail.gmail.com>
References: <CAGLyg+rgkurE7yiv4c9UsXtBiXJaXuL2UnK8WTT+6PuWAiMZkg@mail.gmail.com>
Message-ID: <201503311625.56808.even.rouault@spatialys.com>

Justin,

> I searched the archives and couldn't find much on this topic. I was
> wondering how people would feel about having the gdal java jar hosted in
> the central maven repository? I think it would be pretty nice for users to
> not have to build the bindings locally, or find a repository that has them.
> 
> Any thoughts, objections, or concerns?

That should likely be useful, but pardon the naive remark as I'm not familiar 
with how maven central works : the gdal.jar alone will not be usefull. You 
need the 4 libgdalXXXXjni.so / dll for it to be usefull, and of course thy are 
architecture dependant, so I'm wondering how that would be handled.

> 
> If people are into the idea I would be happy to put in the work to make it
> happen.
> 

Regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jdeolive at gmail.com  Tue Mar 31 07:43:06 2015
From: jdeolive at gmail.com (Justin Deoliveira)
Date: Tue, 31 Mar 2015 08:43:06 -0600
Subject: [gdal-dev] gdal jar in maven central
In-Reply-To: <201503311625.56808.even.rouault@spatialys.com>
References: <CAGLyg+rgkurE7yiv4c9UsXtBiXJaXuL2UnK8WTT+6PuWAiMZkg@mail.gmail.com>
	<201503311625.56808.even.rouault@spatialys.com>
Message-ID: <CAGLyg+qhAj3pw7HyzGbmv=CfGfQZous6vuOu23n5bYoZhxKwBw@mail.gmail.com>

Hey Even,

On Tue, Mar 31, 2015 at 8:25 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Justin,
>
> > I searched the archives and couldn't find much on this topic. I was
> > wondering how people would feel about having the gdal java jar hosted in
> > the central maven repository? I think it would be pretty nice for users
> to
> > not have to build the bindings locally, or find a repository that has
> them.
> >
> > Any thoughts, objections, or concerns?
>
> That should likely be useful, but pardon the naive remark as I'm not
> familiar
> with how maven central works : the gdal.jar alone will not be usefull. You
> need the 4 libgdalXXXXjni.so / dll for it to be usefull, and of course thy
> are
> architecture dependant, so I'm wondering how that would be handled.
>

Right. The jar won't be of much use unless you have all the native
libraries installed on the system. While maven does allow you to store
other artifacts in a repository I don't think that is a good fit in this
case. As you mention it's very platform dependant and it's pretty common
for users to compile gdal themselves to get the formats they need.

That said the jar itself would allow applications to at least compile.
Without the native libs any actual usage will of course fail. But most
projects I have seen that utilize the java bindings account for this case,
allow things like tests to fail cleanly, or disabling certain functionality
if the bindings are not active.

Long story short I think this would be of most use to developers writing
libraries that utilize the bindings. It would allow users of those
libraries to build it without any extra steps. At least that is my case.

>
> >
> > If people are into the idea I would be happy to put in the work to make
> it
> > happen.
> >
>
> Regards,
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150331/80f69ab8/attachment-0001.html>

From even.rouault at spatialys.com  Tue Mar 31 07:58:04 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 31 Mar 2015 16:58:04 +0200
Subject: [gdal-dev] gdal jar in maven central
In-Reply-To: <CAGLyg+qhAj3pw7HyzGbmv=CfGfQZous6vuOu23n5bYoZhxKwBw@mail.gmail.com>
References: <CAGLyg+rgkurE7yiv4c9UsXtBiXJaXuL2UnK8WTT+6PuWAiMZkg@mail.gmail.com>
	<201503311625.56808.even.rouault@spatialys.com>
	<CAGLyg+qhAj3pw7HyzGbmv=CfGfQZous6vuOu23n5bYoZhxKwBw@mail.gmail.com>
Message-ID: <201503311658.05585.even.rouault@spatialys.com>

Le mardi 31 mars 2015 16:43:06, Justin Deoliveira a ?crit :
> Hey Even,
> 
> On Tue, Mar 31, 2015 at 8:25 AM, Even Rouault <even.rouault at spatialys.com>
> 
> wrote:
> > Justin,
> > 
> > > I searched the archives and couldn't find much on this topic. I was
> > > wondering how people would feel about having the gdal java jar hosted
> > > in the central maven repository? I think it would be pretty nice for
> > > users
> > 
> > to
> > 
> > > not have to build the bindings locally, or find a repository that has
> > 
> > them.
> > 
> > > Any thoughts, objections, or concerns?
> > 
> > That should likely be useful, but pardon the naive remark as I'm not
> > familiar
> > with how maven central works : the gdal.jar alone will not be usefull.
> > You need the 4 libgdalXXXXjni.so / dll for it to be usefull, and of
> > course thy are
> > architecture dependant, so I'm wondering how that would be handled.
> 
> Right. The jar won't be of much use unless you have all the native
> libraries installed on the system. While maven does allow you to store
> other artifacts in a repository I don't think that is a good fit in this
> case. As you mention it's very platform dependant and it's pretty common
> for users to compile gdal themselves to get the formats they need.
> 
> That said the jar itself would allow applications to at least compile.
> Without the native libs any actual usage will of course fail. But most
> projects I have seen that utilize the java bindings account for this case,
> allow things like tests to fail cleanly, or disabling certain functionality
> if the bindings are not active.
> 
> Long story short I think this would be of most use to developers writing
> libraries that utilize the bindings. It would allow users of those
> libraries to build it without any extra steps. At least that is my case.

That's a valid use case I think. Although I guess some word of caution written 
in big letters will be necessary to make users aware that the gdal.jar is far 
from being self sufficient.

Regarding the libgdalXXXXjni.so, they don't depend on the third-party libs 
against which GDAL is compiled (well... in theory, as I can see that we do 
over-link in practice, in the Unix makefiles, but that could/should be 
corrected). So if a repository would manage different architectures, they could 
be delivered independantly of libgdal itself.

> 
> > > If people are into the idea I would be happy to put in the work to make
> > 
> > it
> > 
> > > happen.

Does that require adding/changing stuff in the GDAL repo itself or just 
uploading a built gdal.jar ? How does Maven Central "authenticate" who is 
allowed to upload what / how does the GDAL project gets control on that ?

> > 
> > Regards,
> > 
> > Even
> > 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jdeolive at gmail.com  Tue Mar 31 08:49:56 2015
From: jdeolive at gmail.com (Justin Deoliveira)
Date: Tue, 31 Mar 2015 09:49:56 -0600
Subject: [gdal-dev] gdal jar in maven central
In-Reply-To: <201503311658.05585.even.rouault@spatialys.com>
References: <CAGLyg+rgkurE7yiv4c9UsXtBiXJaXuL2UnK8WTT+6PuWAiMZkg@mail.gmail.com>
	<201503311625.56808.even.rouault@spatialys.com>
	<CAGLyg+qhAj3pw7HyzGbmv=CfGfQZous6vuOu23n5bYoZhxKwBw@mail.gmail.com>
	<201503311658.05585.even.rouault@spatialys.com>
Message-ID: <CAGLyg+qgJmgPv6ayd6HuvfDZNyvx_xkBLJSim5P08-XEDzyQJw@mail.gmail.com>

On Tue, Mar 31, 2015 at 8:58 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le mardi 31 mars 2015 16:43:06, Justin Deoliveira a ?crit :
> > Hey Even,
> >
> > On Tue, Mar 31, 2015 at 8:25 AM, Even Rouault <
> even.rouault at spatialys.com>
> >
> > wrote:
> > > Justin,
> > >
> > > > I searched the archives and couldn't find much on this topic. I was
> > > > wondering how people would feel about having the gdal java jar hosted
> > > > in the central maven repository? I think it would be pretty nice for
> > > > users
> > >
> > > to
> > >
> > > > not have to build the bindings locally, or find a repository that has
> > >
> > > them.
> > >
> > > > Any thoughts, objections, or concerns?
> > >
> > > That should likely be useful, but pardon the naive remark as I'm not
> > > familiar
> > > with how maven central works : the gdal.jar alone will not be usefull.
> > > You need the 4 libgdalXXXXjni.so / dll for it to be usefull, and of
> > > course thy are
> > > architecture dependant, so I'm wondering how that would be handled.
> >
> > Right. The jar won't be of much use unless you have all the native
> > libraries installed on the system. While maven does allow you to store
> > other artifacts in a repository I don't think that is a good fit in this
> > case. As you mention it's very platform dependant and it's pretty common
> > for users to compile gdal themselves to get the formats they need.
> >
> > That said the jar itself would allow applications to at least compile.
> > Without the native libs any actual usage will of course fail. But most
> > projects I have seen that utilize the java bindings account for this
> case,
> > allow things like tests to fail cleanly, or disabling certain
> functionality
> > if the bindings are not active.
> >
> > Long story short I think this would be of most use to developers writing
> > libraries that utilize the bindings. It would allow users of those
> > libraries to build it without any extra steps. At least that is my case.
>
> That's a valid use case I think. Although I guess some word of caution
> written
> in big letters will be necessary to make users aware that the gdal.jar is
> far
> from being self sufficient.
>

Right. The bindings already display a pretty visible warning when any of
libgdalXXXXjni.so (or anything it depends on) fail to load. Which I think
makes it fairly clear.

>
> Regarding the libgdalXXXXjni.so, they don't depend on the third-party libs
> against which GDAL is compiled (well... in theory, as I can see that we do
> over-link in practice, in the Unix makefiles, but that could/should be
> corrected). So if a repository would manage different architectures, they
> could
> be delivered independantly of libgdal itself.
>

Yeah, I've found that the libgdalXXXXjni.so work fairly well in isolation.
What I've done in the past is compile the java binding so/dylib/dll's and
post them for download. And found it usually works fine if the user already
has a "relatively close" version of libgdal installed.


> >
> > > > If people are into the idea I would be happy to put in the work to
> make
> > >
> > > it
> > >
> > > > happen.
>
> Does that require adding/changing stuff in the GDAL repo itself or just
> uploading a built gdal.jar ? How does Maven Central "authenticate" who is
> allowed to upload what / how does the GDAL project gets control on that ?
>
>
Right, there are a few steps involved. The easiest vector that I have seen
for open source projects  is to utilize the Sonatype OSSRH repositories
(which provide sync to maven central). The full process is described here.

  http://central.sonatype.org/pages/ossrh-guide.html#review-requirements

To sum it up though, here is what I think would be required for gdal.

1. Create a pom for the gdal jar that adheres to these requirements:


http://central.sonatype.org/pages/requirements.html#sufficient-metadata

2. Have a developer set up an OSSRH account and do the initial setup.

     http://central.sonatype.org/pages/ossrh-guide.html#initial-setup

3. For each release build the gdal jar (along with it's source and javadoc
artifacts) and GPG sign them.


http://central.sonatype.org/pages/requirements.html#sign-files-with-gpgpgp

   Then deploy all the jars/signatures to the OSSRH staging repositories.
This will eventually sync them to maven central.


Again I'm happy to volunteer to do these steps if there aren't any
developers on the project that want the extra hassle. Do the java bindings
have a dedicated maintainer at this point?


> >
> > > Regards,
> > >
> > > Even
> > >
> > > --
> > > Spatialys - Geospatial professional services
> > > http://www.spatialys.com
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150331/638d67be/attachment.html>

From even.rouault at spatialys.com  Tue Mar 31 09:01:40 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 31 Mar 2015 18:01:40 +0200
Subject: [gdal-dev] gdal jar in maven central
In-Reply-To: <CAGLyg+qgJmgPv6ayd6HuvfDZNyvx_xkBLJSim5P08-XEDzyQJw@mail.gmail.com>
References: <CAGLyg+rgkurE7yiv4c9UsXtBiXJaXuL2UnK8WTT+6PuWAiMZkg@mail.gmail.com>
	<201503311658.05585.even.rouault@spatialys.com>
	<CAGLyg+qgJmgPv6ayd6HuvfDZNyvx_xkBLJSim5P08-XEDzyQJw@mail.gmail.com>
Message-ID: <201503311801.40215.even.rouault@spatialys.com>

> Right, there are a few steps involved. The easiest vector that I have seen
> for open source projects  is to utilize the Sonatype OSSRH repositories
> (which provide sync to maven central). The full process is described here.
> 
>   http://central.sonatype.org/pages/ossrh-guide.html#review-requirements
> 
> To sum it up though, here is what I think would be required for gdal.
> 
> 1. Create a pom for the gdal jar that adheres to these requirements:
> 
> 
> http://central.sonatype.org/pages/requirements.html#sufficient-metadata
> 
> 2. Have a developer set up an OSSRH account and do the initial setup.
> 
>      http://central.sonatype.org/pages/ossrh-guide.html#initial-setup
> 
> 3. For each release build the gdal jar (along with it's source and javadoc
> artifacts) and GPG sign them.
> 
> 
> http://central.sonatype.org/pages/requirements.html#sign-files-with-gpgpgp
> 
>    Then deploy all the jars/signatures to the OSSRH staging repositories.
> This will eventually sync them to maven central.
> 
> 
> Again I'm happy to volunteer to do these steps if there aren't any
> developers on the project that want the extra hassle. Do the java bindings
> have a dedicated maintainer at this point?

I've somehow taken that hat on, but I've currently no real incentive to do 
work in the Java area, so I'm happy if you want to take care of that aspect.
Beyond the initial setup, it would be great if the steps that need to be taken 
at each release are documented in our HOWTO-RELEASE document (at the root of 
the source tree) so that anyone not familiar with Java/maven/Sonatype OSSRH 
can follow the steps in a rather brainless mode.


> 
> > > > Regards,
> > > > 
> > > > Even
> > > > 
> > > > --
> > > > Spatialys - Geospatial professional services
> > > > http://www.spatialys.com
> > 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jdeolive at gmail.com  Tue Mar 31 09:29:18 2015
From: jdeolive at gmail.com (Justin Deoliveira)
Date: Tue, 31 Mar 2015 10:29:18 -0600
Subject: [gdal-dev] gdal jar in maven central
In-Reply-To: <201503311801.40215.even.rouault@spatialys.com>
References: <CAGLyg+rgkurE7yiv4c9UsXtBiXJaXuL2UnK8WTT+6PuWAiMZkg@mail.gmail.com>
	<201503311658.05585.even.rouault@spatialys.com>
	<CAGLyg+qgJmgPv6ayd6HuvfDZNyvx_xkBLJSim5P08-XEDzyQJw@mail.gmail.com>
	<201503311801.40215.even.rouault@spatialys.com>
Message-ID: <CAGLyg+o7DV5wVthV=q98JPB6uM_f94Spb9WhbdtjRqH98UJtDg@mail.gmail.com>

On Tue, Mar 31, 2015 at 10:01 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> > Right, there are a few steps involved. The easiest vector that I have
> seen
> > for open source projects  is to utilize the Sonatype OSSRH repositories
> > (which provide sync to maven central). The full process is described
> here.
> >
> >   http://central.sonatype.org/pages/ossrh-guide.html#review-requirements
> >
> > To sum it up though, here is what I think would be required for gdal.
> >
> > 1. Create a pom for the gdal jar that adheres to these requirements:
> >
> >
> > http://central.sonatype.org/pages/requirements.html#sufficient-metadata
> >
> > 2. Have a developer set up an OSSRH account and do the initial setup.
> >
> >      http://central.sonatype.org/pages/ossrh-guide.html#initial-setup
> >
> > 3. For each release build the gdal jar (along with it's source and
> javadoc
> > artifacts) and GPG sign them.
> >
> >
> >
> http://central.sonatype.org/pages/requirements.html#sign-files-with-gpgpgp
> >
> >    Then deploy all the jars/signatures to the OSSRH staging repositories.
> > This will eventually sync them to maven central.
> >
> >
> > Again I'm happy to volunteer to do these steps if there aren't any
> > developers on the project that want the extra hassle. Do the java
> bindings
> > have a dedicated maintainer at this point?
>
> I've somehow taken that hat on, but I've currently no real incentive to do
> work in the Java area, so I'm happy if you want to take care of that
> aspect.
> Beyond the initial setup, it would be great if the steps that need to be
> taken
> at each release are documented in our HOWTO-RELEASE document (at the root
> of
> the source tree) so that anyone not familiar with Java/maven/Sonatype OSSRH
> can follow the steps in a rather brainless mode.
>
> Sure thing. I haven't done much with swig or anything aside from compiling
the bindings, but happy to learn as tasks come up.

So how about for a start I work toward deploying the latest stable release
(1.11.2) jar into maven central. As part of that process I'll document the
steps required and prepare a patch for HOWTO-RELEASE. Will that work?


> >
> > > > > Regards,
> > > > >
> > > > > Even
> > > > >
> > > > > --
> > > > > Spatialys - Geospatial professional services
> > > > > http://www.spatialys.com
> > >
> > > --
> > > Spatialys - Geospatial professional services
> > > http://www.spatialys.com
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150331/465cb0c8/attachment-0001.html>

From even.rouault at spatialys.com  Tue Mar 31 09:41:07 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 31 Mar 2015 18:41:07 +0200
Subject: [gdal-dev] gdal jar in maven central
In-Reply-To: <CAGLyg+o7DV5wVthV=q98JPB6uM_f94Spb9WhbdtjRqH98UJtDg@mail.gmail.com>
References: <CAGLyg+rgkurE7yiv4c9UsXtBiXJaXuL2UnK8WTT+6PuWAiMZkg@mail.gmail.com>
	<201503311801.40215.even.rouault@spatialys.com>
	<CAGLyg+o7DV5wVthV=q98JPB6uM_f94Spb9WhbdtjRqH98UJtDg@mail.gmail.com>
Message-ID: <201503311841.07615.even.rouault@spatialys.com>

Le mardi 31 mars 2015 18:29:18, Justin Deoliveira a ?crit :
> On Tue, Mar 31, 2015 at 10:01 AM, Even Rouault <even.rouault at spatialys.com>
> 
> wrote:
> > > Right, there are a few steps involved. The easiest vector that I have
> > 
> > seen
> > 
> > > for open source projects  is to utilize the Sonatype OSSRH repositories
> > > (which provide sync to maven central). The full process is described
> > 
> > here.
> > 
> > >   http://central.sonatype.org/pages/ossrh-guide.html#review-requirement
> > >   s
> > > 
> > > To sum it up though, here is what I think would be required for gdal.
> > > 
> > > 1. Create a pom for the gdal jar that adheres to these requirements:
> > > 
> > > 
> > > http://central.sonatype.org/pages/requirements.html#sufficient-metadata
> > > 
> > > 2. Have a developer set up an OSSRH account and do the initial setup.
> > > 
> > >      http://central.sonatype.org/pages/ossrh-guide.html#initial-setup
> > > 
> > > 3. For each release build the gdal jar (along with it's source and
> > 
> > javadoc
> > 
> > > artifacts) and GPG sign them.
> > 
> > http://central.sonatype.org/pages/requirements.html#sign-files-with-gpgpg
> > p
> > 
> > >    Then deploy all the jars/signatures to the OSSRH staging
> > >    repositories.
> > > 
> > > This will eventually sync them to maven central.
> > > 
> > > 
> > > Again I'm happy to volunteer to do these steps if there aren't any
> > > developers on the project that want the extra hassle. Do the java
> > 
> > bindings
> > 
> > > have a dedicated maintainer at this point?
> > 
> > I've somehow taken that hat on, but I've currently no real incentive to
> > do work in the Java area, so I'm happy if you want to take care of that
> > aspect.
> > Beyond the initial setup, it would be great if the steps that need to be
> > taken
> > at each release are documented in our HOWTO-RELEASE document (at the root
> > of
> > the source tree) so that anyone not familiar with Java/maven/Sonatype
> > OSSRH can follow the steps in a rather brainless mode.
> > 
> > Sure thing. I haven't done much with swig or anything aside from
> > compiling
> 
> the bindings, but happy to learn as tasks come up.
> 
> So how about for a start I work toward deploying the latest stable release
> (1.11.2) jar into maven central. As part of that process I'll document the
> steps required and prepare a patch for HOWTO-RELEASE. Will that work?

Sounds good.

> 
> > > > > > Regards,
> > > > > > 
> > > > > > Even
> > > > > > 
> > > > > > --
> > > > > > Spatialys - Geospatial professional services
> > > > > > http://www.spatialys.com
> > > > 
> > > > --
> > > > Spatialys - Geospatial professional services
> > > > http://www.spatialys.com
> > 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jdeolive at gmail.com  Tue Mar 31 21:07:11 2015
From: jdeolive at gmail.com (Justin Deoliveira)
Date: Tue, 31 Mar 2015 22:07:11 -0600
Subject: [gdal-dev] gdal jar in maven central
In-Reply-To: <201503311841.07615.even.rouault@spatialys.com>
References: <CAGLyg+rgkurE7yiv4c9UsXtBiXJaXuL2UnK8WTT+6PuWAiMZkg@mail.gmail.com>
	<201503311801.40215.even.rouault@spatialys.com>
	<CAGLyg+o7DV5wVthV=q98JPB6uM_f94Spb9WhbdtjRqH98UJtDg@mail.gmail.com>
	<201503311841.07615.even.rouault@spatialys.com>
Message-ID: <CAGLyg+oFP6nBDb5YhB+pp2p7bScPjBxqkMYFvfDNWAUPUCbvbg@mail.gmail.com>

Update on this one. I've created a pull request with the changes to the
java binding build needed to create maven artifacts that meet maven central
requirements.

  https://github.com/OSGeo/gdal/pull/52

I've also started the process of setting up the deployment infrastructure.
Progress is being tracked here:

  https://issues.sonatype.org/browse/OSSRH-14781


Once that is set up I will follow up with some additional instructions to
HOWTO-RELEASE that describe how to deploy maven artifacts.

-Justin

On Tue, Mar 31, 2015 at 10:41 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le mardi 31 mars 2015 18:29:18, Justin Deoliveira a ?crit :
> > On Tue, Mar 31, 2015 at 10:01 AM, Even Rouault <
> even.rouault at spatialys.com>
> >
> > wrote:
> > > > Right, there are a few steps involved. The easiest vector that I have
> > >
> > > seen
> > >
> > > > for open source projects  is to utilize the Sonatype OSSRH
> repositories
> > > > (which provide sync to maven central). The full process is described
> > >
> > > here.
> > >
> > > >
> http://central.sonatype.org/pages/ossrh-guide.html#review-requirement
> > > >   s
> > > >
> > > > To sum it up though, here is what I think would be required for gdal.
> > > >
> > > > 1. Create a pom for the gdal jar that adheres to these requirements:
> > > >
> > > >
> > > >
> http://central.sonatype.org/pages/requirements.html#sufficient-metadata
> > > >
> > > > 2. Have a developer set up an OSSRH account and do the initial setup.
> > > >
> > > >
> http://central.sonatype.org/pages/ossrh-guide.html#initial-setup
> > > >
> > > > 3. For each release build the gdal jar (along with it's source and
> > >
> > > javadoc
> > >
> > > > artifacts) and GPG sign them.
> > >
> > >
> http://central.sonatype.org/pages/requirements.html#sign-files-with-gpgpg
> > > p
> > >
> > > >    Then deploy all the jars/signatures to the OSSRH staging
> > > >    repositories.
> > > >
> > > > This will eventually sync them to maven central.
> > > >
> > > >
> > > > Again I'm happy to volunteer to do these steps if there aren't any
> > > > developers on the project that want the extra hassle. Do the java
> > >
> > > bindings
> > >
> > > > have a dedicated maintainer at this point?
> > >
> > > I've somehow taken that hat on, but I've currently no real incentive to
> > > do work in the Java area, so I'm happy if you want to take care of that
> > > aspect.
> > > Beyond the initial setup, it would be great if the steps that need to
> be
> > > taken
> > > at each release are documented in our HOWTO-RELEASE document (at the
> root
> > > of
> > > the source tree) so that anyone not familiar with Java/maven/Sonatype
> > > OSSRH can follow the steps in a rather brainless mode.
> > >
> > > Sure thing. I haven't done much with swig or anything aside from
> > > compiling
> >
> > the bindings, but happy to learn as tasks come up.
> >
> > So how about for a start I work toward deploying the latest stable
> release
> > (1.11.2) jar into maven central. As part of that process I'll document
> the
> > steps required and prepare a patch for HOWTO-RELEASE. Will that work?
>
> Sounds good.
>
> >
> > > > > > > Regards,
> > > > > > >
> > > > > > > Even
> > > > > > >
> > > > > > > --
> > > > > > > Spatialys - Geospatial professional services
> > > > > > > http://www.spatialys.com
> > > > >
> > > > > --
> > > > > Spatialys - Geospatial professional services
> > > > > http://www.spatialys.com
> > >
> > > --
> > > Spatialys - Geospatial professional services
> > > http://www.spatialys.com
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150331/c94539ce/attachment.html>

