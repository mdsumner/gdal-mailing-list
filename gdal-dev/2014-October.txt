From even.rouault at spatialys.com  Wed Oct  1 00:27:08 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 1 Oct 2014 09:27:08 +0200
Subject: [gdal-dev] Motion: Approve GDAL/OGR 1.11.1RC1 for release
In-Reply-To: <201409281419.39707.even.rouault@spatialys.com>
References: <201409281419.39707.even.rouault@spatialys.com>
Message-ID: <201410010927.08506.even.rouault@spatialys.com>

Le dimanche 28 septembre 2014 14:19:39, Even Rouault a ?crit :
> Hi,
> 
> No issue has been specifically reported on RC1 so far (*), so I invite PSC
> members to vote on this motion after doing your own testing and validation.
> Input from everyone else who can test it is also very welcome.
> 
> (*) Robert Coup raised to me that the 1.11 branch still contains the OGR
> WCTS code that has the security issues explained in
> http://lists.osgeo.org/pipermail/gdal-dev/2014-September/040084.html .
> Perhaps we can let it as such and add a notice in
> http://trac.osgeo.org/gdal/wiki/Release/1.11.1-News ?
> 
> ---
> 
> Motion: The GDAL/OGR 1.11.1RC1 package is promoted as the
> final GDAL/OGR 1.11.1 release.

I declare this motion as passed with +1 from TamasS, JukkaR, HowardB and me, 
and +0 from DanielM

I'm going to rename the RC to final and the release announcement will follow 
shortly.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Oct  1 00:59:25 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 1 Oct 2014 09:59:25 +0200
Subject: [gdal-dev] GDAL/OGR 1.11.1 released
Message-ID: <201410010959.25562.even.rouault@spatialys.com>

Hi,

On behalf of the GDAL/OGR development team, I am pleased to
announce the release of the GDAL/OGR 1.11.1 bug fix release.  This
release contains more than 80 bug fixes since the April 1.11.0 release.

The source is available at:

  http://download.osgeo.org/gdal/1.11.1/gdal-1.11.1.tar.xz
  http://download.osgeo.org/gdal/1.11.1/gdal-1.11.1.tar.gz
  http://download.osgeo.org/gdal/1.11.1/gdal1111.zip

Details on the the fixes in this release, and a security announcement, are 
available at:
  http://trac.osgeo.org/gdal/wiki/Release/1.11.1-News

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Oct  1 05:07:57 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 1 Oct 2014 14:07:57 +0200
Subject: [gdal-dev] Importing completely MITAB into GDAL source tree ?
Message-ID: <201410011407.58059.even.rouault@spatialys.com>

Hi,

As some of you know, the OGR MapInfo driver heavily depends on the source code 
of the MITAB library. Over the years, people have contributed fixes and 
improvements through GDAL. Not all those changes have made their way in the 
official MITAB repository that sits at https://github.com/mapgears/mitab and 
which has not evolved a lot in comparison to its copy in OGR.
Maintaining 2 copies and synchronizing them is a time consuming and error-
prone process.
On the other hand, there are still people that depend on the standalone MITAB 
library, its utilities (tab2tab, etc...) and its dedicated C API. So I'm 
wondering if it wouldn't be more efficient to import those specific remaining 
parts (standalone build scripts, C API and utilities) into the GDAL source 
tree (probably a ogr/ogrsf_frmts/mitab/build and ogr/ogrsf_frmts/mitab/apps)
That way both projects would share the same code in a very obvious way, while 
keeping their specificities.

Thoughts ?

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From andre.vautour at caris.com  Wed Oct  1 05:49:27 2014
From: andre.vautour at caris.com (Andre Vautour)
Date: Wed, 01 Oct 2014 09:49:27 -0300
Subject: [gdal-dev] Binary Predicates in SQLite SQL dialect
In-Reply-To: <201409302208.26031.even.rouault@spatialys.com>
References: <542AF45E.3060705@caris.com>
	<201409302208.26031.even.rouault@spatialys.com>
Message-ID: <542BF857.5090702@caris.com>


On 2014-09-30 17:08, Even Rouault wrote:
> Le mardi 30 septembre 2014 20:20:14, Andre Vautour a ?crit :
>> Hi all,
>>
>> I am trying to use a geometry binary predicate (ST_Intersects) in
>> ExecuteSQL() with the SQLite dialect and keep getting back an
>> "ST_Intersect function does not exist" error back from SQLite.
>>
>> GDAL is built with SpatiaLite (HAVE_SPATIALITE is defined), but I
>> believe the problem is that SpatiaLite is built without GEOS in our
>> case, so those predicate functions end-up not being available in
>> SpatiaLite. The end result is that OGRSQLiteRegisterSQLFunctions does
>> not add the OGR-based predicate functions as SpatiaLite is present, but
>> SpatiaLite does not contain the predicate functions.
>>
>> I would build SpatiaLite with GEOS support, but unfortunately its LGPL
>> licensing is too restrictive for our application. So, would it make
>> sense to change the logic in OGRSQLiteRegisterSQLFunctions to account
>> for the case of SpatiaLite being built without GEOS?
> Andre,
>
> That makes sense. I guess that can only be checked at runtime though, probably
> by issuing a ST_Intersects() and checking the error code.
>
> I'd note that the spatial predicates in OGR geometry are also based on GEOS.
> Except OGRGeometry::Intersects() that has a simplified implementation based on
> bounding box intersection when GEOS is not available.
>
> Some time ago, I had a look at boost geometry (
> http://www.boost.org/doc/libs/1_56_0/libs/geometry/doc/html/index.html  ). That
> could be used as an alternative backend to GEOS for most predicates and
> functions returning geometries, and the boost licence is a modified X/MIT.
In that case, I might lean towards implementing the binary predicates as 
SQLite functions at our level given that we have a proprietary 
implementation of ISO 19107.

In order to do so, I'd need to have a way to add functions to the 
created sqlite3 object. Assuming we cache the sqlite data source between 
SQL executions, one option would be to enable the loadable extensions on 
the created sqlite3 object like is done in 
sqlite\test_load_virtual_ogr.c using sqlite3_enable_load_extension(). I 
could then call ExcuteSQL() with "SELECT load_extension(...)". Another 
option would be to expose a callback that would allow an application to 
add functions to an SQLite database when it is created, that is, expose 
something similar to OGR2SQLITEModule::SetHandleSQLFunctions().

Yet another option would be to allow for an extension point by 
introducing something like an OverlayStrategy and having the default be 
the GEOSOverlayStrategy. That would allow for the boost::geometry 
extension point you were talking about, and allow applications that have 
their own geometry library like us to use their in house implementation 
for predicates and overlays.

Would you guys be willing to take one of those options?

Thanks again,
Andr?

> Even
>

-- 
*Andr? Vautour*, B.Sc.
Application Developer
CARIS <http://www.caris.com>
115 Waggoners Lane
Fredericton, New Brunswick
Canada    E3B 2L4
Tel: +1.506.458.8533     Fax: +1.506.459.3849
www.caris.com <http://www.caris.com>

*Connect with CARIS*
Twitter <http://www.twitter.com/CARIS_GIS> LinkedIn 
<http://www.linkedin.com/groups?mostPopular=&gid=3217878> FaceBook 
<http://www.facebook.com/pages/CARIS-The-Marine-GIS-Experts/123907500987669?v=app_4949752878> 
YouTube <http://www.youtube.com/user/CARISGIS>

Download your free copy of CARIS Easy View today!
www.caris.com/easyview <http://www.caris.com/easyview>

_________________________________________________________________________
This email and any files transmitted with it are confidential and 
intended only for the addressee(s). If you are not the intended 
recipient(s) please notify us by email reply. You should not use, 
disclose, distribute or copy this communication if received in error.

Any views or opinions expressed in this email are solely those of the 
author and do not necessarily represent those of the company. No binding 
contract will result from this email until such time as a written 
document is signed on behalf of the company.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141001/07058a5b/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/png
Size: 3859 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141001/07058a5b/attachment-0005.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/png
Size: 1208 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141001/07058a5b/attachment-0006.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/png
Size: 1262 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141001/07058a5b/attachment-0007.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/png
Size: 811 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141001/07058a5b/attachment-0008.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/png
Size: 1299 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141001/07058a5b/attachment-0009.png>

From even.rouault at spatialys.com  Wed Oct  1 06:12:33 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 1 Oct 2014 15:12:33 +0200
Subject: [gdal-dev] Binary Predicates in SQLite SQL dialect
In-Reply-To: <542BF857.5090702@caris.com>
References: <542AF45E.3060705@caris.com>
	<201409302208.26031.even.rouault@spatialys.com>
	<542BF857.5090702@caris.com>
Message-ID: <201410011512.33520.even.rouault@spatialys.com>

Le mercredi 01 octobre 2014 14:49:27, vous avez ?crit :
> On 2014-09-30 17:08, Even Rouault wrote:
> > Le mardi 30 septembre 2014 20:20:14, Andre Vautour a ?crit :
> >> Hi all,
> >> 
> >> I am trying to use a geometry binary predicate (ST_Intersects) in
> >> ExecuteSQL() with the SQLite dialect and keep getting back an
> >> "ST_Intersect function does not exist" error back from SQLite.
> >> 
> >> GDAL is built with SpatiaLite (HAVE_SPATIALITE is defined), but I
> >> believe the problem is that SpatiaLite is built without GEOS in our
> >> case, so those predicate functions end-up not being available in
> >> SpatiaLite. The end result is that OGRSQLiteRegisterSQLFunctions does
> >> not add the OGR-based predicate functions as SpatiaLite is present, but
> >> SpatiaLite does not contain the predicate functions.
> >> 
> >> I would build SpatiaLite with GEOS support, but unfortunately its LGPL
> >> licensing is too restrictive for our application. So, would it make
> >> sense to change the logic in OGRSQLiteRegisterSQLFunctions to account
> >> for the case of SpatiaLite being built without GEOS?
> > 
> > Andre,
> > 
> > That makes sense. I guess that can only be checked at runtime though,
> > probably by issuing a ST_Intersects() and checking the error code.
> > 
> > I'd note that the spatial predicates in OGR geometry are also based on
> > GEOS. Except OGRGeometry::Intersects() that has a simplified
> > implementation based on bounding box intersection when GEOS is not
> > available.
> > 
> > Some time ago, I had a look at boost geometry (
> > http://www.boost.org/doc/libs/1_56_0/libs/geometry/doc/html/index.html 
> > ). That could be used as an alternative backend to GEOS for most
> > predicates and functions returning geometries, and the boost licence is
> > a modified X/MIT.
> 
> In that case, I might lean towards implementing the binary predicates as
> SQLite functions at our level given that we have a proprietary
> implementation of ISO 19107.
> 
> In order to do so, I'd need to have a way to add functions to the
> created sqlite3 object. Assuming we cache the sqlite data source between
> SQL executions, one option would be to enable the loadable extensions on
> the created sqlite3 object like is done in
> sqlite\test_load_virtual_ogr.c using sqlite3_enable_load_extension(). I
> could then call ExcuteSQL() with "SELECT load_extension(...)". Another
> option would be to expose a callback that would allow an application to
> add functions to an SQLite database when it is created, that is, expose
> something similar to OGR2SQLITEModule::SetHandleSQLFunctions().
> 
> Yet another option would be to allow for an extension point by
> introducing something like an OverlayStrategy and having the default be
> the GEOSOverlayStrategy. That would allow for the boost::geometry
> extension point you were talking about, and allow applications that have
> their own geometry library like us to use their in house implementation
> for predicates and overlays.
> 
> Would you guys be willing to take one of those options?

Andr?,

The latter one looks the more appealing to me.

That would likely be a C++ interface IGeometryBackend with pure virtual 
methods like
   bool Intersects(OGRGeometry*, OGRGeometry*);
   OGRGeometry* Intersection(OGRGeometry*, OGRGeometry*);

And potentially GEOS prepared geometry could fit with :
   bool SupportsPreparedGeometry()
   bool SupportsPreparedGeometryInersection()
   GeometryBackendPreparedGeometry* Prepare(OGRGeometry*)
   void DeletePreparedGeometry(GeometryBackendPreparedGeometry*)
   bool Intersects(GeometryBackendPreparedGeometry*, OGRGeometry*)

And there would be OGRInstallGeometryBackend(IGeometryBackend*).

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From uffe.kousgaard at routeware.dk  Wed Oct  1 06:27:01 2014
From: uffe.kousgaard at routeware.dk (Uffe Kousgaard)
Date: Wed, 01 Oct 2014 15:27:01 +0200
Subject: [gdal-dev] Importing completely MITAB into GDAL source tree ?
In-Reply-To: <201410011407.58059.even.rouault@spatialys.com>
References: <201410011407.58059.even.rouault@spatialys.com>
Message-ID: <542C0125.4060908@routeware.dk>

As the one, who have requested this, I obviously think it is a great 
idea, since both https://github.com/mapgears/mitab and 
http://mitab.maptools.org/ are "dead".

Including the forum at yahoo:
https://groups.yahoo.com/neo/groups/mitab/info

We currently maintain our own older code based upon 1.7.0, which 
includes the first 2 fixes here:
http://trac.osgeo.org/gdal/ticket/5256
http://trac.osgeo.org/gdal/ticket/5676

And now I have just added this one (no fix for that one):
http://trac.osgeo.org/gdal/ticket/5677

We use MITAB C API and nothing else. That is the DLL version.
Compiled for both win32 and win64.

Regards
Uffe Kousgaard


Even Rouault wrote:
> Hi,
>
> As some of you know, the OGR MapInfo driver heavily depends on the source code 
> of the MITAB library. Over the years, people have contributed fixes and 
> improvements through GDAL. Not all those changes have made their way in the 
> official MITAB repository that sits at https://github.com/mapgears/mitab and 
> which has not evolved a lot in comparison to its copy in OGR.
> Maintaining 2 copies and synchronizing them is a time consuming and error-
> prone process.
> On the other hand, there are still people that depend on the standalone MITAB 
> library, its utilities (tab2tab, etc...) and its dedicated C API. So I'm 
> wondering if it wouldn't be more efficient to import those specific remaining 
> parts (standalone build scripts, C API and utilities) into the GDAL source 
> tree (probably a ogr/ogrsf_frmts/mitab/build and ogr/ogrsf_frmts/mitab/apps)
> That way both projects would share the same code in a very obvious way, while 
> keeping their specificities.
>
> Thoughts ?
>
> Even
>
>   

From doug_newcomb at fws.gov  Wed Oct  1 06:41:06 2014
From: doug_newcomb at fws.gov (Newcomb, Doug)
Date: Wed, 1 Oct 2014 09:41:06 -0400
Subject: [gdal-dev] LZW Compression on geotiffs
Message-ID: <CALQGVr31cjA86myKDx_mqHyACOMKMoG=6GKCCbkx0-u4dYmhZw@mail.gmail.com>

Hi,
I have a 4 band uncompressed geotiff ( NAIP data for North Carolina, USA)
that is 193 MB
I've been going over the compression options for gdal_translate  geotiffs
and I note the following:
gdal_translate -of ?GTIFF? -co ?COMPRESS=PACKBITS? gives me a file that is
194MB in size
gdal_translate -of ?GTIFF? -co ?COMPRESS=LZW? gives me a file that is 232MB
in size
gdal_translate -of ?GTIFF? -co ?COMPRESS=DEFLATE? gives me a file that is
177MB in size

Of the above  Lossless compression options for geotiff, it seems that
DEFLATE is the only one actually compressing.

I'm running gdal 1.11.0 on Ubuntu 12.04.3 64 bit compiled with ./configure
--with-libz   --with-png  --with-libtiff=internal
 --with-geotiff=internal   --with-jpeg=internal   --with-openjpeg
--with-pg=/usr/local/pgsql/bin/pg_config --with-ogr --with-xerces
--with-geos --with-hdf4 --with-hdf5 --with-poppler=/usr/local/lib
--with-podofo --with-spatialite --with-netcdf

Is this expected behavior?

Doug
-- 
Doug Newcomb
USFWS
Raleigh, NC
919-856-4520 ext. 14 doug_newcomb at fws.gov
---------------------------------------------------------------------------------------------------------
The opinions I express are my own and are not representative of the
official policy of the U.S.Fish and Wildlife Service or Dept. of the
Interior.   Life is too short for undocumented, proprietary data formats.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141001/4f28b201/attachment.html>

From bo.victor.thomsen at gmail.com  Wed Oct  1 06:44:32 2014
From: bo.victor.thomsen at gmail.com (Bo Victor Thomsen)
Date: Wed, 01 Oct 2014 15:44:32 +0200
Subject: [gdal-dev] Importing completely MITAB into GDAL source tree ?
In-Reply-To: <201410011407.58059.even.rouault@spatialys.com>
References: <201410011407.58059.even.rouault@spatialys.com>
Message-ID: <542C0540.9060702@gmail.com>

A very big +1 from me (As an occasional user of MiTab and a very small 
contributor to MiTab)

Regards
Bo Victor Thomsen
AestasGIS
Denmark

Den 01-10-2014 14:07, Even Rouault skrev:
> Hi,
>
> As some of you know, the OGR MapInfo driver heavily depends on the source code
> of the MITAB library. Over the years, people have contributed fixes and
> improvements through GDAL. Not all those changes have made their way in the
> official MITAB repository that sits at https://github.com/mapgears/mitab and
> which has not evolved a lot in comparison to its copy in OGR.
> Maintaining 2 copies and synchronizing them is a time consuming and error-
> prone process.
> On the other hand, there are still people that depend on the standalone MITAB
> library, its utilities (tab2tab, etc...) and its dedicated C API. So I'm
> wondering if it wouldn't be more efficient to import those specific remaining
> parts (standalone build scripts, C API and utilities) into the GDAL source
> tree (probably a ogr/ogrsf_frmts/mitab/build and ogr/ogrsf_frmts/mitab/apps)
> That way both projects would share the same code in a very obvious way, while
> keeping their specificities.
>
> Thoughts ?
>
> Even
>


From even.rouault at spatialys.com  Wed Oct  1 06:45:01 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 1 Oct 2014 15:45:01 +0200
Subject: [gdal-dev] LZW Compression on geotiffs
In-Reply-To: <CALQGVr31cjA86myKDx_mqHyACOMKMoG=6GKCCbkx0-u4dYmhZw@mail.gmail.com>
References: <CALQGVr31cjA86myKDx_mqHyACOMKMoG=6GKCCbkx0-u4dYmhZw@mail.gmail.com>
Message-ID: <201410011545.01908.even.rouault@spatialys.com>

Le mercredi 01 octobre 2014 15:41:06, Newcomb, Doug a ?crit :
> Hi,
> I have a 4 band uncompressed geotiff ( NAIP data for North Carolina, USA)
> that is 193 MB
> I've been going over the compression options for gdal_translate  geotiffs
> and I note the following:
> gdal_translate -of ?GTIFF? -co ?COMPRESS=PACKBITS? gives me a file that is
> 194MB in size
> gdal_translate -of ?GTIFF? -co ?COMPRESS=LZW? gives me a file that is 232MB
> in size
> gdal_translate -of ?GTIFF? -co ?COMPRESS=DEFLATE? gives me a file that is
> 177MB in size
> 
> Of the above  Lossless compression options for geotiff, it seems that
> DEFLATE is the only one actually compressing.
> 
> I'm running gdal 1.11.0 on Ubuntu 12.04.3 64 bit compiled with ./configure
> --with-libz   --with-png  --with-libtiff=internal
>  --with-geotiff=internal   --with-jpeg=internal   --with-openjpeg
> --with-pg=/usr/local/pgsql/bin/pg_config --with-ogr --with-xerces
> --with-geos --with-hdf4 --with-hdf5 --with-poppler=/usr/local/lib
> --with-podofo --with-spatialite --with-netcdf
> 
> Is this expected behavior?

Doug,

Not completely surprising that lossless methods don't work well with 
aerial/satellite imagery.
You may also want to test with -co TILED=YES .

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From doug_newcomb at fws.gov  Wed Oct  1 07:26:15 2014
From: doug_newcomb at fws.gov (Newcomb, Doug)
Date: Wed, 1 Oct 2014 10:26:15 -0400
Subject: [gdal-dev] LZW Compression on geotiffs
In-Reply-To: <201410011545.01908.even.rouault@spatialys.com>
References: <CALQGVr31cjA86myKDx_mqHyACOMKMoG=6GKCCbkx0-u4dYmhZw@mail.gmail.com>
	<201410011545.01908.even.rouault@spatialys.com>
Message-ID: <CALQGVr1y93-Jg9G2QtxY8ja29X+Z5zsN7LbZpZDwBo68jQ8ukg@mail.gmail.com>

Well,
I went back and compiled with 1.11.1 with the external geotiff library and
got the same result for LZW, tiling made no difference in size .

As an interesting sideline, I noticed that I had not been compiling with
LZMA compression  previously and compiled gdal 1.11.1 with LZMA.  I ran:


gdal_translate -of ?GTIFF? -co ?COMPRESS=LZMA? on the original file and got
a file of  149MB in size.

 I noticed that LZMA compression is not listed as one of the compression
options for the GeoTIFF format in the online documentation.  Has that
capability been available long?

Doug

On Wed, Oct 1, 2014 at 9:45 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le mercredi 01 octobre 2014 15:41:06, Newcomb, Doug a ?crit :
> > Hi,
> > I have a 4 band uncompressed geotiff ( NAIP data for North Carolina, USA)
> > that is 193 MB
> > I've been going over the compression options for gdal_translate  geotiffs
> > and I note the following:
> > gdal_translate -of ?GTIFF? -co ?COMPRESS=PACKBITS? gives me a file that
> is
> > 194MB in size
> > gdal_translate -of ?GTIFF? -co ?COMPRESS=LZW? gives me a file that is
> 232MB
> > in size
> > gdal_translate -of ?GTIFF? -co ?COMPRESS=DEFLATE? gives me a file that is
> > 177MB in size
> >
> > Of the above  Lossless compression options for geotiff, it seems that
> > DEFLATE is the only one actually compressing.
> >
> > I'm running gdal 1.11.0 on Ubuntu 12.04.3 64 bit compiled with
> ./configure
> > --with-libz   --with-png  --with-libtiff=internal
> >  --with-geotiff=internal   --with-jpeg=internal   --with-openjpeg
> > --with-pg=/usr/local/pgsql/bin/pg_config --with-ogr --with-xerces
> > --with-geos --with-hdf4 --with-hdf5 --with-poppler=/usr/local/lib
> > --with-podofo --with-spatialite --with-netcdf
> >
> > Is this expected behavior?
>
> Doug,
>
> Not completely surprising that lossless methods don't work well with
> aerial/satellite imagery.
> You may also want to test with -co TILED=YES .
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>



-- 
Doug Newcomb
USFWS
Raleigh, NC
919-856-4520 ext. 14 doug_newcomb at fws.gov
---------------------------------------------------------------------------------------------------------
The opinions I express are my own and are not representative of the
official policy of the U.S.Fish and Wildlife Service or Dept. of the
Interior.   Life is too short for undocumented, proprietary data formats.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141001/1accc7cd/attachment-0001.html>

From even.rouault at spatialys.com  Wed Oct  1 07:32:03 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 1 Oct 2014 16:32:03 +0200
Subject: [gdal-dev] LZW Compression on geotiffs
In-Reply-To: <CALQGVr1y93-Jg9G2QtxY8ja29X+Z5zsN7LbZpZDwBo68jQ8ukg@mail.gmail.com>
References: <CALQGVr31cjA86myKDx_mqHyACOMKMoG=6GKCCbkx0-u4dYmhZw@mail.gmail.com>
	<201410011545.01908.even.rouault@spatialys.com>
	<CALQGVr1y93-Jg9G2QtxY8ja29X+Z5zsN7LbZpZDwBo68jQ8ukg@mail.gmail.com>
Message-ID: <201410011632.03637.even.rouault@spatialys.com>

Le mercredi 01 octobre 2014 16:26:15, Newcomb, Doug a ?crit :
> Well,
> I went back and compiled with 1.11.1 with the external geotiff library and
> got the same result for LZW, tiling made no difference in size .
> 
> As an interesting sideline, I noticed that I had not been compiling with
> LZMA compression  previously and compiled gdal 1.11.1 with LZMA.  I ran:
> 
> 
> gdal_translate -of ?GTIFF? -co ?COMPRESS=LZMA? on the original file and got
> a file of  149MB in size.
> 
>  I noticed that LZMA compression is not listed as one of the compression
> options for the GeoTIFF format in the online documentation.  Has that
> capability been available long?

GDAL 1.8.0. Should likely be documented. Caution: GeoTIFF LZMA compression is 
something that is far from being standard. Probably only GDAL LZMA-enabled 
builds with internal libtiff (or with external libtiff 4.0.X built against 
liblzma) will be able to deal with that.

If that's an option for you, you could try lossless JPEG2000 compression. See 
http://www.gdal.org/frmt_jp2openjpeg.html and the "Lossless compression" 
paragraph.

> 
> Doug
> 
> On Wed, Oct 1, 2014 at 9:45 AM, Even Rouault <even.rouault at spatialys.com>
> 
> wrote:
> > Le mercredi 01 octobre 2014 15:41:06, Newcomb, Doug a ?crit :
> > > Hi,
> > > I have a 4 band uncompressed geotiff ( NAIP data for North Carolina,
> > > USA) that is 193 MB
> > > I've been going over the compression options for gdal_translate 
> > > geotiffs and I note the following:
> > > gdal_translate -of ?GTIFF? -co ?COMPRESS=PACKBITS? gives me a file that
> > 
> > is
> > 
> > > 194MB in size
> > > gdal_translate -of ?GTIFF? -co ?COMPRESS=LZW? gives me a file that is
> > 
> > 232MB
> > 
> > > in size
> > > gdal_translate -of ?GTIFF? -co ?COMPRESS=DEFLATE? gives me a file that
> > > is 177MB in size
> > > 
> > > Of the above  Lossless compression options for geotiff, it seems that
> > > DEFLATE is the only one actually compressing.
> > > 
> > > I'm running gdal 1.11.0 on Ubuntu 12.04.3 64 bit compiled with
> > 
> > ./configure
> > 
> > > --with-libz   --with-png  --with-libtiff=internal
> > > 
> > >  --with-geotiff=internal   --with-jpeg=internal   --with-openjpeg
> > > 
> > > --with-pg=/usr/local/pgsql/bin/pg_config --with-ogr --with-xerces
> > > --with-geos --with-hdf4 --with-hdf5 --with-poppler=/usr/local/lib
> > > --with-podofo --with-spatialite --with-netcdf
> > > 
> > > Is this expected behavior?
> > 
> > Doug,
> > 
> > Not completely surprising that lossless methods don't work well with
> > aerial/satellite imagery.
> > You may also want to test with -co TILED=YES .
> > 
> > Even
> > 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From szekerest at gmail.com  Wed Oct  1 07:41:55 2014
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed, 1 Oct 2014 16:41:55 +0200
Subject: [gdal-dev] Importing completely MITAB into GDAL source tree ?
In-Reply-To: <201410011407.58059.even.rouault@spatialys.com>
References: <201410011407.58059.even.rouault@spatialys.com>
Message-ID: <CACALY+To8Gd6+Re3wef6ohNDA58Kf8MeA6HJFswPzOmCTW66Eg@mail.gmail.com>

+1 from me.

2014-10-01 14:07 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:

> Hi,
>
> As some of you know, the OGR MapInfo driver heavily depends on the source
> code
> of the MITAB library. Over the years, people have contributed fixes and
> improvements through GDAL. Not all those changes have made their way in the
> official MITAB repository that sits at https://github.com/mapgears/mitab
> and
> which has not evolved a lot in comparison to its copy in OGR.
> Maintaining 2 copies and synchronizing them is a time consuming and error-
> prone process.
> On the other hand, there are still people that depend on the standalone
> MITAB
> library, its utilities (tab2tab, etc...) and its dedicated C API. So I'm
> wondering if it wouldn't be more efficient to import those specific
> remaining
> parts (standalone build scripts, C API and utilities) into the GDAL source
> tree (probably a ogr/ogrsf_frmts/mitab/build and
> ogr/ogrsf_frmts/mitab/apps)
> That way both projects would share the same code in a very obvious way,
> while
> keeping their specificities.
>
> Thoughts ?
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141001/3266103a/attachment.html>

From gdal at stripfamily.net  Wed Oct  1 08:03:18 2014
From: gdal at stripfamily.net (David Strip)
Date: Wed, 01 Oct 2014 09:03:18 -0600
Subject: [gdal-dev] LZW Compression on geotiffs
In-Reply-To: <201410011632.03637.even.rouault@spatialys.com>
References: <CALQGVr31cjA86myKDx_mqHyACOMKMoG=6GKCCbkx0-u4dYmhZw@mail.gmail.com>	<201410011545.01908.even.rouault@spatialys.com>	<CALQGVr1y93-Jg9G2QtxY8ja29X+Z5zsN7LbZpZDwBo68jQ8ukg@mail.gmail.com>
	<201410011632.03637.even.rouault@spatialys.com>
Message-ID: <542C17B6.4050007@stripfamily.net>

I was sufficiently intrigued by this result that I tried on some 3-band
aerial data I had handy. My data is from over Phila, PA. Here are the
results for various compression/tiling combinations. It's quite
different from yours

  93,784,427 out_none.tif

 73,241,943 out_deflate.tif
 59,786,628 out_deflate_tiled.tif
 
 93,191,345 out_lzw.tif
 78,036,699 out_lzw_tiled.tif

 94,516,744 out_pack.tif
 94,552,019 out_pack_tiled.tif

As Even noted, it's not surprising that some compression methods, esp.
packbits which is a very simple compression, would not have much effect,
and in fact actually increased file size. More surprising would be that
LZW and deflate don't save space. In my case, tiling made a big difference.

On 10/1/2014 8:32 AM, Even Rouault wrote:
> Le mercredi 01 octobre 2014 16:26:15, Newcomb, Doug a ?crit :
>> Well,
>> I went back and compiled with 1.11.1 with the external geotiff library and
>> got the same result for LZW, tiling made no difference in size .
>>
>> As an interesting sideline, I noticed that I had not been compiling with
>> LZMA compression  previously and compiled gdal 1.11.1 with LZMA.  I ran:
>>
>>
>> gdal_translate -of ?GTIFF? -co ?COMPRESS=LZMA? on the original file and got
>> a file of  149MB in size.
>>
>>  I noticed that LZMA compression is not listed as one of the compression
>> options for the GeoTIFF format in the online documentation.  Has that
>> capability been available long?
> GDAL 1.8.0. Should likely be documented. Caution: GeoTIFF LZMA compression is 
> something that is far from being standard. Probably only GDAL LZMA-enabled 
> builds with internal libtiff (or with external libtiff 4.0.X built against 
> liblzma) will be able to deal with that.
>
> If that's an option for you, you could try lossless JPEG2000 compression. See 
> http://www.gdal.org/frmt_jp2openjpeg.html and the "Lossless compression" 
> paragraph.
>
>> Doug
>>
>> On Wed, Oct 1, 2014 at 9:45 AM, Even Rouault <even.rouault at spatialys.com>
>>
>> wrote:
>>> Le mercredi 01 octobre 2014 15:41:06, Newcomb, Doug a ?crit :
>>>> Hi,
>>>> I have a 4 band uncompressed geotiff ( NAIP data for North Carolina,
>>>> USA) that is 193 MB
>>>> I've been going over the compression options for gdal_translate 
>>>> geotiffs and I note the following:
>>>> gdal_translate -of ?GTIFF? -co ?COMPRESS=PACKBITS? gives me a file that
>>> is
>>>
>>>> 194MB in size
>>>> gdal_translate -of ?GTIFF? -co ?COMPRESS=LZW? gives me a file that is
>>> 232MB
>>>
>>>> in size
>>>> gdal_translate -of ?GTIFF? -co ?COMPRESS=DEFLATE? gives me a file that
>>>> is 177MB in size
>>>>
>>>> Of the above  Lossless compression options for geotiff, it seems that
>>>> DEFLATE is the only one actually compressing.
>>>>
>>>> I'm running gdal 1.11.0 on Ubuntu 12.04.3 64 bit compiled with
>>> ./configure
>>>
>>>> --with-libz   --with-png  --with-libtiff=internal
>>>>
>>>>  --with-geotiff=internal   --with-jpeg=internal   --with-openjpeg
>>>>
>>>> --with-pg=/usr/local/pgsql/bin/pg_config --with-ogr --with-xerces
>>>> --with-geos --with-hdf4 --with-hdf5 --with-poppler=/usr/local/lib
>>>> --with-podofo --with-spatialite --with-netcdf
>>>>
>>>> Is this expected behavior?
>>> Doug,
>>>
>>> Not completely surprising that lossless methods don't work well with
>>> aerial/satellite imagery.
>>> You may also want to test with -co TILED=YES .
>>>
>>> Even
>>>
>>> --
>>> Spatialys - Geospatial professional services
>>> http://www.spatialys.com




From doug_newcomb at fws.gov  Wed Oct  1 08:08:30 2014
From: doug_newcomb at fws.gov (Newcomb, Doug)
Date: Wed, 1 Oct 2014 11:08:30 -0400
Subject: [gdal-dev] LZW Compression on geotiffs
In-Reply-To: <201410011632.03637.even.rouault@spatialys.com>
References: <CALQGVr31cjA86myKDx_mqHyACOMKMoG=6GKCCbkx0-u4dYmhZw@mail.gmail.com>
	<201410011545.01908.even.rouault@spatialys.com>
	<CALQGVr1y93-Jg9G2QtxY8ja29X+Z5zsN7LbZpZDwBo68jQ8ukg@mail.gmail.com>
	<201410011632.03637.even.rouault@spatialys.com>
Message-ID: <CALQGVr2mFJ7QmR2M8x82a9W9YsrcTJW9395j4c4vrx5TmUQKXw@mail.gmail.com>

Thanks! I have been also working with JPEG2000 compression with both he
jasper and openjpeg libraries.  For some reason, the openjpeg library
didn't seem to work with 4 band imagery ( Error 6:  Unable to export files
with 4 bands) , but the jasper library did.

Doug

On Wed, Oct 1, 2014 at 10:32 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le mercredi 01 octobre 2014 16:26:15, Newcomb, Doug a ?crit :
> > Well,
> > I went back and compiled with 1.11.1 with the external geotiff library
> and
> > got the same result for LZW, tiling made no difference in size .
> >
> > As an interesting sideline, I noticed that I had not been compiling with
> > LZMA compression  previously and compiled gdal 1.11.1 with LZMA.  I ran:
> >
> >
> > gdal_translate -of ?GTIFF? -co ?COMPRESS=LZMA? on the original file and
> got
> > a file of  149MB in size.
> >
> >  I noticed that LZMA compression is not listed as one of the compression
> > options for the GeoTIFF format in the online documentation.  Has that
> > capability been available long?
>
> GDAL 1.8.0. Should likely be documented. Caution: GeoTIFF LZMA compression
> is
> something that is far from being standard. Probably only GDAL LZMA-enabled
> builds with internal libtiff (or with external libtiff 4.0.X built against
> liblzma) will be able to deal with that.
>
> If that's an option for you, you could try lossless JPEG2000 compression.
> See
> http://www.gdal.org/frmt_jp2openjpeg.html and the "Lossless compression"
> paragraph.
>
> >
> > Doug
> >
> > On Wed, Oct 1, 2014 at 9:45 AM, Even Rouault <even.rouault at spatialys.com
> >
> >
> > wrote:
> > > Le mercredi 01 octobre 2014 15:41:06, Newcomb, Doug a ?crit :
> > > > Hi,
> > > > I have a 4 band uncompressed geotiff ( NAIP data for North Carolina,
> > > > USA) that is 193 MB
> > > > I've been going over the compression options for gdal_translate
> > > > geotiffs and I note the following:
> > > > gdal_translate -of ?GTIFF? -co ?COMPRESS=PACKBITS? gives me a file
> that
> > >
> > > is
> > >
> > > > 194MB in size
> > > > gdal_translate -of ?GTIFF? -co ?COMPRESS=LZW? gives me a file that is
> > >
> > > 232MB
> > >
> > > > in size
> > > > gdal_translate -of ?GTIFF? -co ?COMPRESS=DEFLATE? gives me a file
> that
> > > > is 177MB in size
> > > >
> > > > Of the above  Lossless compression options for geotiff, it seems that
> > > > DEFLATE is the only one actually compressing.
> > > >
> > > > I'm running gdal 1.11.0 on Ubuntu 12.04.3 64 bit compiled with
> > >
> > > ./configure
> > >
> > > > --with-libz   --with-png  --with-libtiff=internal
> > > >
> > > >  --with-geotiff=internal   --with-jpeg=internal   --with-openjpeg
> > > >
> > > > --with-pg=/usr/local/pgsql/bin/pg_config --with-ogr --with-xerces
> > > > --with-geos --with-hdf4 --with-hdf5 --with-poppler=/usr/local/lib
> > > > --with-podofo --with-spatialite --with-netcdf
> > > >
> > > > Is this expected behavior?
> > >
> > > Doug,
> > >
> > > Not completely surprising that lossless methods don't work well with
> > > aerial/satellite imagery.
> > > You may also want to test with -co TILED=YES .
> > >
> > > Even
> > >
> > > --
> > > Spatialys - Geospatial professional services
> > > http://www.spatialys.com
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>



-- 
Doug Newcomb
USFWS
Raleigh, NC
919-856-4520 ext. 14 doug_newcomb at fws.gov
---------------------------------------------------------------------------------------------------------
The opinions I express are my own and are not representative of the
official policy of the U.S.Fish and Wildlife Service or Dept. of the
Interior.   Life is too short for undocumented, proprietary data formats.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141001/8c4f4193/attachment-0001.html>

From stephen.roecker at gmail.com  Wed Oct  1 10:21:39 2014
From: stephen.roecker at gmail.com (Stephen Roecker)
Date: Wed, 1 Oct 2014 13:21:39 -0400
Subject: [gdal-dev] LZW Compression on geotiffs
Message-ID: <CAGcGWcoN7CariA6T2Vyh_HTM-HiVwUZG9N+Pjy=C+Nt-Fyfc2g@mail.gmail.com>

I've also been toying with the compression settings lately and thought
I would mention my experience. I'm not sure if this is known behavior,
but when subsequently using the compressed rasters with 'gdaldem' I
got some strange results when the raster was greater than 4GB (i.e.
BIGTIFF). The resulting rasters were either corrupt, way way larger than
they should have been, or I terminated before they completed due to
the extreme length of time (> 2 hours) they took to process. When I
used an uncompressed BIGTIFF raster with gdaldem, the results were as
expected. This was all using gdal 11.0, and the following BIGTIFF
compression settings, -co "TILED=YES" -co "BIGTIFF=YES" -co
"COMPRESS=DEFLATE".

Stephen

From even.rouault at spatialys.com  Wed Oct  1 10:52:08 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 1 Oct 2014 19:52:08 +0200
Subject: [gdal-dev] LZW Compression on geotiffs
In-Reply-To: <CAGcGWcoN7CariA6T2Vyh_HTM-HiVwUZG9N+Pjy=C+Nt-Fyfc2g@mail.gmail.com>
References: <CAGcGWcoN7CariA6T2Vyh_HTM-HiVwUZG9N+Pjy=C+Nt-Fyfc2g@mail.gmail.com>
Message-ID: <201410011952.08069.even.rouault@spatialys.com>

Le mercredi 01 octobre 2014 19:21:39, Stephen Roecker a ?crit :
> I've also been toying with the compression settings lately and thought
> I would mention my experience. I'm not sure if this is known behavior,
> but when subsequently using the compressed rasters with 'gdaldem' I
> got some strange results when the raster was greater than 4GB (i.e.
> BIGTIFF). The resulting rasters were either corrupt, way way larger than
> they should have been, or I terminated before they completed due to
> the extreme length of time (> 2 hours) they took to process. When I
> used an uncompressed BIGTIFF raster with gdaldem, the results were as
> expected. This was all using gdal 11.0, and the following BIGTIFF
> compression settings, -co "TILED=YES" -co "BIGTIFF=YES" -co
> "COMPRESS=DEFLATE".

Stephen,

That it might be long or result in larger than expected file is not completely 
unsurprising. With formats like geotiff, the gdaldem utility fills the output 
raster line by line. So when creating a tiled compress geotiff, partial blocks 
may be read and written several times. Each time a compressed block is written 
and larger than its previous size it gets written at the end of the TIFF, and 
the previous space occupied is lost. That you get corruption is more 
surprising though.
But there was another code path in gdaldem, used for formats like PNG, that 
can also be used for GTiff. It is a bit slower when applied in the general 
case, but it is definitely needed in the use case you mentionned (tiled 
compressed geotiff). Fixed now by http://trac.osgeo.org/gdal/ticket/5678

In the meantime, outputing to uncompressed file and then gdal_translat'ing to 
compressed tiled file is the best option.

Even


> 
> Stephen
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From dmorissette at mapgears.com  Wed Oct  1 10:57:00 2014
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Wed, 01 Oct 2014 13:57:00 -0400
Subject: [gdal-dev] Importing completely MITAB into GDAL source tree ?
In-Reply-To: <201410011407.58059.even.rouault@spatialys.com>
References: <201410011407.58059.even.rouault@spatialys.com>
Message-ID: <542C406C.1020604@mapgears.com>

Hi Even, all,

Thank you for bringing this up, FWIW I am supportive of solving the 
MITAB situation and will do my best to help do this in the best interest 
of all users.

Instead of just forking the source, should we talk instead about 
migrating the ownership/direction of the MITAB project under the GDAL 
umbrella? Would the GDAL PSC be interested in that? That would help 
address the perception that MITAB is "dead" and make it easier for 
people like you to contribute to it since there would be only one MITAB, 
the one maintained by the GDAL team.

Note that if we are to move MITAB under the GDAL umbrella, we'd need to 
keep in mind that this involves more than just copying the source under 
the GDAL source tree as you suggest here. The standalone version of 
MITAB contains a subset of the CPL and OGR files, which is just the bare 
minimum for MITAB to work. If you move the official MITAB source under 
the GDAL source tree, this separation will be lost and it will become 
impossible to build MITAB as a standalone lib independent of GDAL/OGR.

All this to say that just moving the source as you suggest is probably 
not enough to get real benefits, that would just formalize the fork 
between MITAB and GDAL without helping the users that need a standalone 
MITAB.

I think the MITAB situation is a bit similar to that of shapelib and 
libgeotiff which are extensively used by GDAL, but that also need to 
exist by themselves for the application developers that want direct 
access to a single format in a lightweight lib.

Who maintains and releases shapelib and libgeotiff today? I believe it's 
Frank. Would it make sense to also officially bring those two under the 
GDAL umbrella at the same time and solve the "when will you publish a 
new libgeotiff release?" question that I seem to hear every once in a 
while over beers at FOSS4G or code sprints.

That would be a bit like what we did when MapCache and TinyOWS joined 
MapServer project. The long term goal was to facilitate their 
integration with the MapServer core, and in the short term to increase 
the bus number of those projects and ensure their long term viability.

Daniel


On 14-10-01 8:07 AM, Even Rouault wrote:
> Hi,
>
> As some of you know, the OGR MapInfo driver heavily depends on the source code
> of the MITAB library. Over the years, people have contributed fixes and
> improvements through GDAL. Not all those changes have made their way in the
> official MITAB repository that sits at https://github.com/mapgears/mitab and
> which has not evolved a lot in comparison to its copy in OGR.
> Maintaining 2 copies and synchronizing them is a time consuming and error-
> prone process.
> On the other hand, there are still people that depend on the standalone MITAB
> library, its utilities (tab2tab, etc...) and its dedicated C API. So I'm
> wondering if it wouldn't be more efficient to import those specific remaining
> parts (standalone build scripts, C API and utilities) into the GDAL source
> tree (probably a ogr/ogrsf_frmts/mitab/build and ogr/ogrsf_frmts/mitab/apps)
> That way both projects would share the same code in a very obvious way, while
> keeping their specificities.
>
> Thoughts ?
>
> Even
>


-- 
Daniel Morissette
T: +1 418-696-5056 #201
http://www.mapgears.com/
Provider of Professional MapServer Support since 2000

From jukka.rahkonen at mmmtike.fi  Wed Oct  1 11:02:50 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Wed, 1 Oct 2014 18:02:50 +0000 (UTC)
Subject: [gdal-dev] LZW Compression on geotiffs
References: <CALQGVr31cjA86myKDx_mqHyACOMKMoG=6GKCCbkx0-u4dYmhZw@mail.gmail.com>
	<201410011545.01908.even.rouault@spatialys.com>
	<CALQGVr1y93-Jg9G2QtxY8ja29X+Z5zsN7LbZpZDwBo68jQ8ukg@mail.gmail.com>
	<201410011632.03637.even.rouault@spatialys.com>
Message-ID: <loom.20141001T194923-56@post.gmane.org>

Even Rouault <even.rouault <at> spatialys.com> writes:


> 
> If that's an option for you, you could try lossless JPEG2000 compression. See 
> http://www.gdal.org/frmt_jp2openjpeg.html and the "Lossless compression" 
> paragraph.


My numbers for the most simple compressions without tiling:

Original RGB      424 MB
LZW "compressed"  474 MB
Deflate           380 MB
Lossless JP2      197 MB

For comparison:
Tiff as zipped    347 MB
Tiff into png     263 MB
If I have understood right both zip and png are using deflate algorithm so
there might be some place for improving deflate compression in GDAL.

-Jukka Rahkonen-


From even.rouault at spatialys.com  Wed Oct  1 12:39:21 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 1 Oct 2014 21:39:21 +0200
Subject: [gdal-dev] Importing completely MITAB into GDAL source tree ?
In-Reply-To: <542C406C.1020604@mapgears.com>
References: <201410011407.58059.even.rouault@spatialys.com>
	<542C406C.1020604@mapgears.com>
Message-ID: <201410012139.21354.even.rouault@spatialys.com>

Daniel,

thanks for your thoughts.

> Thank you for bringing this up, FWIW I am supportive of solving the
> MITAB situation and will do my best to help do this in the best interest
> of all users.
> 
> Instead of just forking the source, should we talk instead about
> migrating the ownership/direction of the MITAB project under the GDAL
> umbrella? Would the GDAL PSC be interested in that? 

In such a mode, I guess MITAB releases would be synchronized with GDAL ones, 
as that would be the same source tarball.

> That would help
> address the perception that MITAB is "dead" and make it easier for
> people like you to contribute to it since there would be only one MITAB,
> the one maintained by the GDAL team.
> 
> Note that if we are to move MITAB under the GDAL umbrella, we'd need to
> keep in mind that this involves more than just copying the source under
> the GDAL source tree as you suggest here. The standalone version of
> MITAB contains a subset of the CPL and OGR files, which is just the bare
> minimum for MITAB to work. 

Yes I'm aware of that. I tried not so long ago to sync the CPL and OGR core 
version of MITAB with the ones of GDAL trunk in a branch of my MITAB fork : 
https://github.com/rouault/mitab/commit/9e62e99a11c1163460fd9530c494e35262561b24

> If you move the official MITAB source under
> the GDAL source tree, this separation will be lost and it will become
> impossible to build MITAB as a standalone lib independent of GDAL/OGR.

My idea was actually to have build scripts in let's say 
ogr/ogrsf_frmts/mitab/build that would still generate an independant mitab lib 
with as few as possible CPL/OGR files in it. That should be doable hopefully.

There are somewhat similar, although probably more simple, similar cases in 
the GDAL source tree. Some drivers, like OGR DGN, GDAL HFA,etc... have specific 
build targets to build debug utilities (although I suspect most must be broken 
due to the changes done over the year), or small library to deal just with the 
format.

> 
> All this to say that just moving the source as you suggest is probably
> not enough to get real benefits, that would just formalize the fork
> between MITAB and GDAL without helping the users that need a standalone
> MITAB.
> 
> I think the MITAB situation is a bit similar to that of shapelib and
> libgeotiff which are extensively used by GDAL, but that also need to
> exist by themselves for the application developers that want direct
> access to a single format in a lightweight lib.
> 
> Who maintains and releases shapelib and libgeotiff today? I believe it's
> Frank. Would it make sense to also officially bring those two under the
> GDAL umbrella at the same time and solve the "when will you publish a
> new libgeotiff release?" question that I seem to hear every once in a
> while over beers at FOSS4G or code sprints.

That's Frank's call, but indeed regarding shapelib last release was in april 
2012, and the OGR version has got a few improvements since.

Regarding libgeotiff, Frank and Howard have championned a RC during the code 
sprint at FOSS4G, that should be released tomorrow according to 
http://lists.maptools.org/pipermail/geotiff/2014-September/000774.html

> 
> That would be a bit like what we did when MapCache and TinyOWS joined
> MapServer project.

The situation is a bit different since MapCache and TinyOWS, as far as I know, 
don't share (currently) code with MapServer, and have actually their own git 
repositories (even if hosted under the same account at github)

> The long term goal was to facilitate their
> integration with the MapServer core, and in the short term to increase
> the bus number of those projects and ensure their long term viability.
> 

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gdal at stripfamily.net  Wed Oct  1 16:06:57 2014
From: gdal at stripfamily.net (David Strip)
Date: Wed, 01 Oct 2014 17:06:57 -0600
Subject: [gdal-dev] LZW Compression on geotiffs
In-Reply-To: <loom.20141001T194923-56@post.gmane.org>
References: <CALQGVr31cjA86myKDx_mqHyACOMKMoG=6GKCCbkx0-u4dYmhZw@mail.gmail.com>	<201410011545.01908.even.rouault@spatialys.com>	<CALQGVr1y93-Jg9G2QtxY8ja29X+Z5zsN7LbZpZDwBo68jQ8ukg@mail.gmail.com>	<201410011632.03637.even.rouault@spatialys.com>
	<loom.20141001T194923-56@post.gmane.org>
Message-ID: <542C8911.8020405@stripfamily.net>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141001/1f981f2b/attachment.html>

From even.rouault at spatialys.com  Wed Oct  1 16:13:20 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 2 Oct 2014 01:13:20 +0200
Subject: [gdal-dev] LZW Compression on geotiffs
In-Reply-To: <542C8911.8020405@stripfamily.net>
References: <CALQGVr31cjA86myKDx_mqHyACOMKMoG=6GKCCbkx0-u4dYmhZw@mail.gmail.com>
	<loom.20141001T194923-56@post.gmane.org>
	<542C8911.8020405@stripfamily.net>
Message-ID: <201410020113.20481.even.rouault@spatialys.com>

Le jeudi 02 octobre 2014 01:06:57, David Strip a ?crit :
> On 10/1/2014 12:02 PM, Jukka Rahkonen wrote:
> 
> For comparison:
> Tiff as zipped    347 MB
> Tiff into png     263 MB
> If I have understood right both zip and png are using deflate algorithm so
> there might be some place for improving deflate compression in GDAL.
> 
>  I was curious how png could achieve such  better compression if it is
> using the same deflate algorithm. I wouldn't think different
> implementations would account for so much improvement. It turns out the
> png compression uses a "filtering" step ahead of compression. This is
> explained here. The filter is similar to a differential pulse code
> modulation, in which the pixel is represented as the difference from the
> pixels to the left, left upper diagonal, and above. This typically reduces
> the magnitude of the value to something close to zero, making the encoding
> more efficient.

True, a way to improve things might be to specify -co PREDICTOR=2. Should 
apply to both LZW and DEFLATE.
This is one of the filter that might be used by PNG, except that PNG has 
different filters, so it will eventually beat TIFF deflate.

> 
>  David

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Oct  1 16:44:21 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 2 Oct 2014 01:44:21 +0200
Subject: [gdal-dev] Motion: Commit access for Jukka Rahkonen
In-Reply-To: <201409292111.05622.even.rouault@spatialys.com>
References: <201409292111.05622.even.rouault@spatialys.com>
Message-ID: <201410020144.21052.even.rouault@spatialys.com>

Le lundi 29 septembre 2014 21:11:05, Even Rouault a ?crit :
> Motion: Extend GDAL/OGR commit access to Jukka Rahkonen
> ---

I declare this motion passed with support from FrankW, TamasS, DanielM, 
HowardB and myself.

Jukka, I have added your OSGeo Trac account (jratike80) as member of GDAL SVN. 
Could you add your name in the COMMITERS file and commit it to check that 
things work properly ?

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From armin.burger at gmx.net  Wed Oct  1 16:46:59 2014
From: armin.burger at gmx.net (Armin Burger)
Date: Thu, 02 Oct 2014 01:46:59 +0200
Subject: [gdal-dev] LZW Compression on geotiffs
In-Reply-To: <201410020113.20481.even.rouault@spatialys.com>
References: <CALQGVr31cjA86myKDx_mqHyACOMKMoG=6GKCCbkx0-u4dYmhZw@mail.gmail.com>	<loom.20141001T194923-56@post.gmane.org>	<542C8911.8020405@stripfamily.net>
	<201410020113.20481.even.rouault@spatialys.com>
Message-ID: <542C9273.9010900@gmx.net>

I would also always recommend to use -co PREDICTOR=2 when compressing 
with LZW (or DEFLATE). So far I made quite good experiences with LZW and 
PREDICTOR=2, with typical compression rates close to gzip compression 
(meaning when putting the tif file into a tgz archive file).

The only time that I discovered where LZW does not work well was when 
using gdalwarp and directly writing the output as (untiled) LZW TIFF. 
This could create LZW files up to 2-3 times bigger than the uncompressed 
input TIFF. When using gdalwarp and one wants to save disk space one 
should either create tiled LZW TIFF's, or warp to uncompressed TIFF and 
then use gdal_translate with LZW to create the final LZW image, 
PREDICTOR=2 is recommended for both methods.

armin


On 10/02/2014 01:13 AM, Even Rouault wrote:
> Le jeudi 02 octobre 2014 01:06:57, David Strip a ?crit :
>> On 10/1/2014 12:02 PM, Jukka Rahkonen wrote:
>>
>> For comparison:
>> Tiff as zipped    347 MB
>> Tiff into png     263 MB
>> If I have understood right both zip and png are using deflate algorithm so
>> there might be some place for improving deflate compression in GDAL.
>>
>>   I was curious how png could achieve such  better compression if it is
>> using the same deflate algorithm. I wouldn't think different
>> implementations would account for so much improvement. It turns out the
>> png compression uses a "filtering" step ahead of compression. This is
>> explained here. The filter is similar to a differential pulse code
>> modulation, in which the pixel is represented as the difference from the
>> pixels to the left, left upper diagonal, and above. This typically reduces
>> the magnitude of the value to something close to zero, making the encoding
>> more efficient.
>
> True, a way to improve things might be to specify -co PREDICTOR=2. Should
> apply to both LZW and DEFLATE.
> This is one of the filter that might be used by PNG, except that PNG has
> different filters, so it will eventually beat TIFF deflate.
>
>>
>>   David
>

From jukka.rahkonen at mmmtike.fi  Wed Oct  1 21:31:43 2014
From: jukka.rahkonen at mmmtike.fi (Rahkonen Jukka (Tike))
Date: Thu, 2 Oct 2014 04:31:43 +0000
Subject: [gdal-dev] LZW Compression on geotiffs
Message-ID: <EFE5D7EE2EC8D3438FE02E356F81E35A11B2B712@FITLK-EXMBX04.msvyvi.vaha.local>

Even Rouault wrote:
> 
> Le jeudi 02 octobre 2014 01:06:57, David Strip a ?crit :
> > On 10/1/2014 12:02 PM, Jukka Rahkonen wrote:
> >
> > For comparison:
> > Tiff as zipped    347 MB
> > Tiff into png     263 MB
> > If I have understood right both zip and png are using deflate
> > algorithm so there might be some place for improving deflate compression in
> GDAL.
> >
> >  I was curious how png could achieve such  better compression if it is
> > using the same deflate algorithm. I wouldn't think different
> > implementations would account for so much improvement. It turns out
> > the png compression uses a "filtering" step ahead of compression. This
> > is explained here. The filter is similar to a differential pulse code
> > modulation, in which the pixel is represented as the difference from
> > the pixels to the left, left upper diagonal, and above. This typically
> > reduces the magnitude of the value to something close to zero, making
> > the encoding more efficient.
> 
> True, a way to improve things might be to specify -co PREDICTOR=2. Should
> apply to both LZW and DEFLATE.
> This is one of the filter that might be used by PNG, except that PNG has different
> filters, so it will eventually beat TIFF deflate.

Not a bad suggestion.

Original                                             424 MB
DEFLATE without predictor          380 MB 
DEFLATE with -co predictor=2     280 MB

-Jukka Rahkonen-

From robert.coup at koordinates.com  Wed Oct  1 22:09:17 2014
From: robert.coup at koordinates.com (Robert Coup)
Date: Thu, 2 Oct 2014 18:09:17 +1300
Subject: [gdal-dev] LZW Compression on geotiffs
In-Reply-To: <542C9273.9010900@gmx.net>
References: <CALQGVr31cjA86myKDx_mqHyACOMKMoG=6GKCCbkx0-u4dYmhZw@mail.gmail.com>
	<loom.20141001T194923-56@post.gmane.org>
	<542C8911.8020405@stripfamily.net>
	<201410020113.20481.even.rouault@spatialys.com>
	<542C9273.9010900@gmx.net>
Message-ID: <CAFLLRpL4g8_Yxq94gEqG0SFojZu5--Fe0iY4GcsacUZHHJCT_Q@mail.gmail.com>

On Thu, Oct 2, 2014 at 12:46 PM, Armin Burger <armin.burger at gmx.net> wrote:

> The only time that I discovered where LZW does not work well was when
> using gdalwarp and directly writing the output as (untiled) LZW TIFF. This
> could create LZW files up to 2-3 times bigger than the uncompressed input
> TIFF. When using gdalwarp and one wants to save disk space one should
> either create tiled LZW TIFF's, or warp to uncompressed TIFF and then use
> gdal_translate with LZW to create the final LZW image, PREDICTOR=2 is
> recommended for both methods.


We've learned to do the latter (warp first, then compress via translate) if
you're writing into the output TIFF from more than one input file. The
compressed tiff will be smaller, and you won't get weird bugs appearing
occasionally.

Rob :)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141002/682ed5f9/attachment.html>

From lukasz.tracewski at outlook.com  Thu Oct  2 00:02:00 2014
From: lukasz.tracewski at outlook.com (Lukasz Tracewski)
Date: Thu, 2 Oct 2014 09:02:00 +0200
Subject: [gdal-dev] Sum pixel values in selected area of an image
Message-ID: <DUB120-W2789066AA9A9FA4315AF018FB90@phx.gbl>

Hi,
I only recently started my adventure with GDAL and GIS in general, so please accept my apologies for perhaps maybe the most accurate formulation of the problem. I also did my best to find the answer already on this mailing list and outside, but to no avail - again possibly due to lack of experience. 
Last year Hansen et al. prepared a detailed map, 30 meters resolution, of forest cover for the whole planet. The data is publicly accessible, both for online viewing and download. Both can be found here: http://earthenginepartners.appspot.com/science-2013-global-forest The forest cover images are GeoTIFF and have pixel values in range [0, 100] that describes percentage of forest cover.
I have some georeferenced images that essentially are composed of ones and zeros, e.g.:0 1 1 0 00 1 1 1 00 1 0 0 0...
Those images are in 1000 meters scale and can spawn over whole continents.  My aim is to calculate forest cover for them: wherever the value is "1", this pixel should be added to the forest cover. Say the Hansen image looks like this:10 20 30 40 5010 80 80 0 00 0 0 0 0...
Then rows and column of this images should be multiplied by respective rows and columns of my own image, producing: 0 * 10 + 20 * 1 + 30 * 1 + 40 * 0 + 50 * 0 + 10 * 0 + 80 * 1 + ... = 210
Mind that scale of both images is different, so the example above is actually not accurate. The real calculations should average pixel values, then sum them and then convert to area.
Can anyone point me where to start? Maybe you know of any examples that could give me a hint?

Thanks,Lucas 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141002/cd04f058/attachment-0001.html>

From jukka.rahkonen at mmmtike.fi  Thu Oct  2 00:55:17 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Thu, 2 Oct 2014 07:55:17 +0000 (UTC)
Subject: [gdal-dev] LZW Compression on geotiffs
References: <EFE5D7EE2EC8D3438FE02E356F81E35A11B2B712@FITLK-EXMBX04.msvyvi.vaha.local>
Message-ID: <loom.20141002T095136-689@post.gmane.org>

Rahkonen Jukka (Tike <jukka.rahkonen <at> mmmtike.fi> writes:


> > True, a way to improve things might be to specify -co PREDICTOR=2. Should
> > apply to both LZW and DEFLATE.
> > This is one of the filter that might be used by PNG, except that PNG has
different
> > filters, so it will eventually beat TIFF deflate.
> 
> Not a bad suggestion.
> 
> Original                                             424 MB
> DEFLATE without predictor          380 MB 
> DEFLATE with -co predictor=2     280 MB


One more test with LZW

Without predictor                 474 MB
With -co predictor=2              307 MB

Is there something that prevents changing the default to "predictor=2" from
the current default value "1"?

-Jukka Rahkonen-


From andrea.aime at geo-solutions.it  Thu Oct  2 01:37:50 2014
From: andrea.aime at geo-solutions.it (Andrea Aime)
Date: Thu, 2 Oct 2014 10:37:50 +0200
Subject: [gdal-dev] LZW Compression on geotiffs
In-Reply-To: <loom.20141002T095136-689@post.gmane.org>
References: <EFE5D7EE2EC8D3438FE02E356F81E35A11B2B712@FITLK-EXMBX04.msvyvi.vaha.local>
	<loom.20141002T095136-689@post.gmane.org>
Message-ID: <CA+nxMTunCOshq70-JBKZnxpSrV9d2pcar4ooX4CTrawRg+v-BA@mail.gmail.com>

On Thu, Oct 2, 2014 at 9:55 AM, Jukka Rahkonen <jukka.rahkonen at mmmtike.fi>
wrote:

> Rahkonen Jukka (Tike <jukka.rahkonen <at> mmmtike.fi> writes:
>
>
> > > True, a way to improve things might be to specify -co PREDICTOR=2.
> Should
> > > apply to both LZW and DEFLATE.
> > > This is one of the filter that might be used by PNG, except that PNG
> has
> different
> > > filters, so it will eventually beat TIFF deflate.
> >
> > Not a bad suggestion.
> >
> > Original                                             424 MB
> > DEFLATE without predictor          380 MB
> > DEFLATE with -co predictor=2     280 MB
>
>
> One more test with LZW
>
> Without predictor                 474 MB
> With -co predictor=2              307 MB
>
> Is there something that prevents changing the default to "predictor=2" from
> the current default value "1"?
>

Interesting... wondering how much the predictor affects decoding speed
though (it is
a common case to have to compress once, and read many times out of the
compressed file)

Cheers
Andrea

-- 
==
GeoServer Professional Services from the experts! Visit
http://goo.gl/NWWaa2 for more information.
==

Ing. Andrea Aime
@geowolf
Technical Lead

GeoSolutions S.A.S.
Via Poggio alle Viti 1187
55054  Massarosa (LU)
Italy
phone: +39 0584 962313
fax: +39 0584 1660272
mob: +39  339 8844549

http://www.geo-solutions.it
http://twitter.com/geosolutions_it

*AVVERTENZE AI SENSI DEL D.Lgs. 196/2003*

Le informazioni contenute in questo messaggio di posta elettronica e/o
nel/i file/s allegato/i sono da considerarsi strettamente riservate. Il
loro utilizzo ? consentito esclusivamente al destinatario del messaggio,
per le finalit? indicate nel messaggio stesso. Qualora riceviate questo
messaggio senza esserne il destinatario, Vi preghiamo cortesemente di
darcene notizia via e-mail e di procedere alla distruzione del messaggio
stesso, cancellandolo dal Vostro sistema. Conservare il messaggio stesso,
divulgarlo anche in parte, distribuirlo ad altri soggetti, copiarlo, od
utilizzarlo per finalit? diverse, costituisce comportamento contrario ai
principi dettati dal D.Lgs. 196/2003.



The information in this message and/or attachments, is intended solely for
the attention and use of the named addressee(s) and may be confidential or
proprietary in nature or covered by the provisions of privacy act
(Legislative Decree June, 30 2003, no.196 - Italy's New Data Protection
Code).Any use not in accord with its purpose, any disclosure, reproduction,
copying, distribution, or either dissemination, either whole or partial, is
strictly forbidden except previous formal approval of the named
addressee(s). If you are not the intended recipient, please contact
immediately the sender by telephone, fax or e-mail and delete the
information in this message that has been received in error. The sender
does not give any warranty or accept liability as the content, accuracy or
completeness of sent messages and accepts no responsibility  for changes
made after they were sent or for other risks which arise as a result of
e-mail transmission, viruses, etc.

-------------------------------------------------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141002/d107b777/attachment.html>

From jukka.rahkonen at mmmtike.fi  Thu Oct  2 02:03:27 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Thu, 2 Oct 2014 09:03:27 +0000 (UTC)
Subject: [gdal-dev] LZW Compression on geotiffs
References: <EFE5D7EE2EC8D3438FE02E356F81E35A11B2B712@FITLK-EXMBX04.msvyvi.vaha.local>
	<loom.20141002T095136-689@post.gmane.org>
	<CA+nxMTunCOshq70-JBKZnxpSrV9d2pcar4ooX4CTrawRg+v-BA@mail.gmail.com>
Message-ID: <loom.20141002T104343-160@post.gmane.org>

Andrea Aime <andrea.aime <at> geo-solutions.it> writes:


> Interesting... wondering how much the predictor affects decoding speed
though (it is
> a common case to have to compress once, and read many times out of the
> compressed file)

A very quick test by decompressing deflate -> uncompressed from disk to disk
shows no difference in speed. Most time is used for disk read/write with
this test and actually with predictor the speed is perhaps a bit better
because there are less bytes to read. Would need more repeats to get
reliable results, though.

I now remember that I have mean measuring the WMS output from Mapserver with
different formatotions for png compression
http://www.mapserver.org/mapfile/outputformat.html. Conclusion was that it
was good to put some more load for the processor and compress more than the
default and make less bytes for the output. But png compression is perhaps
something different than the use of predictor and I guess that QUANTIZE
probably shrinks file size more effectively. But for a top quality 24-bit
png output it might be good to make WMS server to compress with predictor=2.
I wonder if Mapservers and Geoservers do it already. I can't see such
formatoption in Mapserver documents.

-Jukka Rahkonen-


From even.rouault at spatialys.com  Thu Oct  2 02:05:23 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 2 Oct 2014 11:05:23 +0200
Subject: [gdal-dev] LZW Compression on geotiffs
In-Reply-To: <loom.20141002T095136-689@post.gmane.org>
References: <EFE5D7EE2EC8D3438FE02E356F81E35A11B2B712@FITLK-EXMBX04.msvyvi.vaha.local>
	<loom.20141002T095136-689@post.gmane.org>
Message-ID: <201410021105.23308.even.rouault@spatialys.com>

Le jeudi 02 octobre 2014 09:55:17, Jukka Rahkonen a ?crit :
> Rahkonen Jukka (Tike <jukka.rahkonen <at> mmmtike.fi> writes:
> > > True, a way to improve things might be to specify -co PREDICTOR=2.
> > > Should apply to both LZW and DEFLATE.
> > > This is one of the filter that might be used by PNG, except that PNG
> > > has
> 
> different
> 
> > > filters, so it will eventually beat TIFF deflate.
> > 
> > Not a bad suggestion.
> > 
> > Original                                             424 MB
> > DEFLATE without predictor          380 MB
> > DEFLATE with -co predictor=2     280 MB
> 
> One more test with LZW
> 
> Without predictor                 474 MB
> With -co predictor=2              307 MB
> 
> Is there something that prevents changing the default to "predictor=2" from
> the current default value "1"?

I guess you can find cases where predictor=2 leads to bigger sizes, otherwise 
you could do several predictor passes and if each time the size would be 
smaller, you would violate principles of the information theory (you would 
compress less than the entropy of the data). But in practice, with non pure-
noise images, I think that horizontal differencing result in smaller files in 
nearly all cases. Would be good to know if someone has lead a test campaign on 
that, with various types of images, and particularly the ones involved in GIS.

There's at least one case I can think of where horizontal differencing would 
likely have no effect, or some negative effect. For paletted images where the 
index values of neighbour pixels have no correlation.

Adobe did apparently some tests, as mentionned in section 14 of 
https://partners.adobe.com/public/developer/en/tiff/TIFF6.pdf, but they don't 
compare the effect of horizontal differencing vs non-differencing. Interestingly 
they mention a trick (masking of low-order bits) that can enhance the effect of 
horizontal differencing at the expense of some loss of course. That's something 
is only relevant on the compression side. Completely transparent for the 
decompression side.

As raised by Andrea, there might be an impact of horizontal differencing on 
decompression time, but I'd expect it to be small. There's only one integer 
addition per sample value to undo the effect of the predictor.

> 
> -Jukka Rahkonen-
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Oct  2 08:00:46 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 2 Oct 2014 17:00:46 +0200
Subject: [gdal-dev] Sum pixel values in selected area of an image
In-Reply-To: <DUB120-W2789066AA9A9FA4315AF018FB90@phx.gbl>
References: <DUB120-W2789066AA9A9FA4315AF018FB90@phx.gbl>
Message-ID: <201410021700.46351.even.rouault@spatialys.com>

Le jeudi 02 octobre 2014 09:02:00, Lukasz Tracewski a ?crit :
> Hi,
> I only recently started my adventure with GDAL and GIS in general, so
> please accept my apologies for perhaps maybe the most accurate formulation
> of the problem. I also did my best to find the answer already on this
> mailing list and outside, but to no avail - again possibly due to lack of
> experience. Last year Hansen et al. prepared a detailed map, 30 meters
> resolution, of forest cover for the whole planet. The data is publicly
> accessible, both for online viewing and download. Both can be found here:
> http://earthenginepartners.appspot.com/science-2013-global-forest The
> forest cover images are GeoTIFF and have pixel values in range [0, 100]
> that describes percentage of forest cover. I have some georeferenced
> images that essentially are composed of ones and zeros, e.g.:0 1 1 0 00 1
> 1 1 00 1 0 0 0... Those images are in 1000 meters scale and can spawn over
> whole continents.  My aim is to calculate forest cover for them: wherever
> the value is "1", this pixel should be added to the forest cover. Say the
> Hansen image looks like this:10 20 30 40 5010 80 80 0 00 0 0 0 0... Then
> rows and column of this images should be multiplied by respective rows and
> columns of my own image, producing: 0 * 10 + 20 * 1 + 30 * 1 + 40 * 0 + 50
> * 0 + 10 * 0 + 80 * 1 + ... = 210 Mind that scale of both images is
> different, so the example above is actually not accurate. The real
> calculations should average pixel values, then sum them and then convert
> to area. Can anyone point me where to start? Maybe you know of any
> examples that could give me a hint?

Lukasz,

There are likely many ways of doing that. Here's a potential workflow

1) With gdalwarp -r averge -ts you could make sure both raster have same 
dimensions
2) Use gdal_calc.py to do the multiplication pixel by pixel.
3) Use gdalinfo -stats to compute statistics on the raster generated by 2). 
Multiply the MEAN value by the raster width and raster height, and that will 
give you the sum.

Even

> 
> Thanks,Lucas

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Thu Oct  2 09:26:37 2014
From: ari.jolma at gmail.com (Ari Jolma)
Date: Thu, 02 Oct 2014 19:26:37 +0300
Subject: [gdal-dev] RuntimeError no COPY in progress
Message-ID: <542D7CBD.3010807@gmail.com>

A strange bug somewhere between OGR and PostgreSQL(?)

I've created a layer with a geometry and id fields. The layer gets 
created ok. After inserting 500 features I get the error:

RuntimeError no COPY in progress

PostgreSQL  logs this:

2014-10-02 19:23:03 EEST ERROR:  COPY from stdin failed: COPY terminated 
by new PQexec
2014-10-02 19:23:03 EEST CONTEXT:  COPY rannat, line 501
2014-10-02 19:23:03 EEST STATEMENT:  COPY "rannat" ("wkb_geometry", 
"id") FROM STDIN;
2014-10-02 19:23:03 EEST ERROR:  current transaction is aborted, 
commands ignored until end of transaction block
2014-10-02 19:23:03 EEST STATEMENT:  FETCH 500 in OGRPGLayerReader0x258c8f0
2014-10-02 19:23:03 EEST ERROR:  current transaction is aborted, 
commands ignored until end of transaction block
2014-10-02 19:23:03 EEST STATEMENT:  CLOSE OGRPGLayerReader0x258c8f0

"rannat" is the new table.

Any ideas? Am I inserting features too fast??

Ari


From even.rouault at spatialys.com  Thu Oct  2 10:45:20 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 2 Oct 2014 19:45:20 +0200
Subject: [gdal-dev] RuntimeError no COPY in progress
In-Reply-To: <542D7CBD.3010807@gmail.com>
References: <542D7CBD.3010807@gmail.com>
Message-ID: <201410021945.20294.even.rouault@spatialys.com>

Le jeudi 02 octobre 2014 18:26:37, Ari Jolma a ?crit :
> A strange bug somewhere between OGR and PostgreSQL(?)
> 
> I've created a layer with a geometry and id fields. The layer gets
> created ok. After inserting 500 features I get the error:
> 
> RuntimeError no COPY in progress
> 
> PostgreSQL  logs this:
> 
> 2014-10-02 19:23:03 EEST ERROR:  COPY from stdin failed: COPY terminated
> by new PQexec
> 2014-10-02 19:23:03 EEST CONTEXT:  COPY rannat, line 501
> 2014-10-02 19:23:03 EEST STATEMENT:  COPY "rannat" ("wkb_geometry",
> "id") FROM STDIN;
> 2014-10-02 19:23:03 EEST ERROR:  current transaction is aborted,
> commands ignored until end of transaction block
> 2014-10-02 19:23:03 EEST STATEMENT:  FETCH 500 in OGRPGLayerReader0x258c8f0
> 2014-10-02 19:23:03 EEST ERROR:  current transaction is aborted,
> commands ignored until end of transaction block
> 2014-10-02 19:23:03 EEST STATEMENT:  CLOSE OGRPGLayerReader0x258c8f0
> 
> "rannat" is the new table.
> 
> Any ideas? Am I inserting features too fast??

Ari,

Too fast ? lol, no I don't think so. There must be something odd that happens, 
wrong escaping, whatever that makes the COPY to fail. Could you provide some 
way to reproduce this ?

Even

> 
> Ari
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Thu Oct  2 11:50:33 2014
From: ari.jolma at gmail.com (Ari Jolma)
Date: Thu, 02 Oct 2014 21:50:33 +0300
Subject: [gdal-dev] RuntimeError no COPY in progress
In-Reply-To: <201410021945.20294.even.rouault@spatialys.com>
References: <542D7CBD.3010807@gmail.com>
	<201410021945.20294.even.rouault@spatialys.com>
Message-ID: <542D9E79.8090807@gmail.com>

On 02.10.2014 20:45, Even Rouault wrote:
> Le jeudi 02 octobre 2014 18:26:37, Ari Jolma a ?crit :
>> 2014-10-02 19:23:03 EEST ERROR:  COPY from stdin failed: COPY terminated
>> by new PQexec
>>
>>
>>
>> Too fast ? lol, no I don't think so. There must be something odd that happens,
>> wrong escaping, whatever that makes the COPY to fail. Could you provide some
>> way to reproduce this ?

That may be difficult. I inserted some fprintfs to ogrpgtablelayer.cpp 
and the copy seems ok (and it is ok for the first 500). I even removed 
the only non-geometry field and the situation does not change - the FID 
does not seem to be an issue.

Then I ran the code until the table is created (this is naturally Perl 
code). Exit, and ran it again now with Layer Open and let the rest run 
as before with insert features. No problem. The problem seems to be when 
inserting into a newly created table.

Strange.

Ari


From even.rouault at spatialys.com  Thu Oct  2 11:55:16 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 2 Oct 2014 20:55:16 +0200
Subject: [gdal-dev]
 =?iso-8859-1?q?=5Bmapserver-dev=5D_New_env=2E_var=2E_t?=
 =?iso-8859-1?q?o_make_it_easier_to_test/debug_web=09services?=
In-Reply-To: <C549F0496453D842B4DD71AC8188DDC507F29649@055-CH1MPN1-041.055d.mgd.msft.net>
References: <201410022044.12654.even.rouault@spatialys.com>
	<C549F0496453D842B4DD71AC8188DDC507F29649@055-CH1MPN1-041.055d.mgd.msft.net>
Message-ID: <201410022055.16385.even.rouault@spatialys.com>

Le jeudi 02 octobre 2014 20:45:26, Lime, Steve D (MNIT) a ?crit :
> You were aware of the -nh option for mapserv, right?

Steve,

Ah, good point, actually, I was not.... I should have asked first.  But -nh 
doesn't seem to work. At least not in the WMS or WFS cases. It seems mapio.c 
doesn't honour mapserv->sendheaders, and the WMS or WFS code doesn't test it 
either

By looking at the places where sendheaders is used, it seems that you must 
test sendheaders at each place where msIO_setHeader() is called. Whereas my 
change does put the test inside msIO_setHeader() itself. Which is less error 
prone I think. But we cannot decently let both mechanisms in place

I see also some places that directly mess with sendheaders. Not sure why...

../maptemplate.c:  mapserv->sendheaders = MS_TRUE;
../maptemplate.c:    mapserv->sendheaders = MS_FALSE;
../mapwfs.c:    mapserv->sendheaders = MS_TRUE;

Even

> ________________________________________
> From: mapserver-dev-bounces at lists.osgeo.org
> [mapserver-dev-bounces at lists.osgeo.org] on behalf of Even Rouault
> [even.rouault at spatialys.com] Sent: Thursday, October 02, 2014 1:44 PM
> To: mapserver-dev at lists.osgeo.org
> Subject: [mapserver-dev] New env. var. to make it easier to test/debug web 
>     services
> 
> Hi,
> 
> I always get annoyed when running mapserv from command line and wanting to
> test/debug WMS, WFS, etc... without launching mapserv as a CGI, because
> the HTTP headers get emitted and thus produce an invalid PNG or GML.
> So I've pushed in master a small enhancement. If MS_HTTP_HEADER=NO is set
> as environmenet variable, the HTTP headers are not emitted.
> 
> So now you can do things like :
> 
> MS_HTTP_HEADER=NO mapserv QUERY_STRING="map=test.map&SERVICE=WMS&..." >
> out.png && display out.png MS_HTTP_HEADER=NO mapserv
> QUERY_STRING="map=test.map&SERVICE=WFS&..."  | xmllint -noout -
> 
> Even
> 
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> mapserver-dev mailing list
> mapserver-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/mapserver-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Oct  2 11:57:53 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 2 Oct 2014 20:57:53 +0200
Subject: [gdal-dev] RuntimeError no COPY in progress
In-Reply-To: <542D9E79.8090807@gmail.com>
References: <542D7CBD.3010807@gmail.com>
	<201410021945.20294.even.rouault@spatialys.com>
	<542D9E79.8090807@gmail.com>
Message-ID: <201410022057.53217.even.rouault@spatialys.com>

Le jeudi 02 octobre 2014 20:50:33, Ari Jolma a ?crit :
> On 02.10.2014 20:45, Even Rouault wrote:
> > Le jeudi 02 octobre 2014 18:26:37, Ari Jolma a ?crit :
> >> 2014-10-02 19:23:03 EEST ERROR:  COPY from stdin failed: COPY terminated
> >> by new PQexec
> >> 
> >> 
> >> 
> >> Too fast ? lol, no I don't think so. There must be something odd that
> >> happens, wrong escaping, whatever that makes the COPY to fail. Could
> >> you provide some way to reproduce this ?
> 
> That may be difficult.

Could you try changing your code to use another driver to output to another 
format, like shapefile, GML, etc... and then try ogr2ogr -f postgresql ?

> I inserted some fprintfs to ogrpgtablelayer.cpp
> and the copy seems ok (and it is ok for the first 500). I even removed
> the only non-geometry field and the situation does not change - the FID
> does not seem to be an issue.
> 
> Then I ran the code until the table is created (this is naturally Perl
> code). Exit, and ran it again now with Layer Open and let the rest run
> as before with insert features. No problem. The problem seems to be when
> inserting into a newly created table.
> 
> Strange.
> 
> Ari

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Oct  2 12:01:58 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 2 Oct 2014 21:01:58 +0200
Subject: [gdal-dev]
 =?iso-8859-1?q?=5Bmapserver-dev=5D_New_env=2E_var=2E_t?=
 =?iso-8859-1?q?o_make_it_easier_to_test/debug_web=09services?=
In-Reply-To: <C549F0496453D842B4DD71AC8188DDC507F29674@055-CH1MPN1-041.055d.mgd.msft.net>
References: <201410022044.12654.even.rouault@spatialys.com>
	<201410022055.16385.even.rouault@spatialys.com>
	<C549F0496453D842B4DD71AC8188DDC507F29674@055-CH1MPN1-041.055d.mgd.msft.net>
Message-ID: <201410022101.58389.even.rouault@spatialys.com>

Le jeudi 02 octobre 2014 20:57:46, Lime, Steve D (MNIT) a ?crit :
> How about making -nh set the environment variable programatically and
> losing the sendheaders checks?

Yes, that's a possibility. Although I think -nh could just call a function to 
disable the boolean in msio instead of messing with environmenet variables.

But I don't think we can remove all the sendheaders logic completely.  As 
mentionned in my above email, there's seem to have places where you want to 
disable/enable headers temporarily. Seems related to template. But I'm not 
familiar with the part of the code.

> 
> ________________________________________
> From: Even Rouault [even.rouault at spatialys.com]
> Sent: Thursday, October 02, 2014 1:55 PM
> To: Lime, Steve D (MNIT)
> Cc: gdal-dev at lists.osgeo.org
> Subject: Re: [mapserver-dev] New env. var. to make it easier to test/debug 
> web services
> 
> Le jeudi 02 octobre 2014 20:45:26, Lime, Steve D (MNIT) a ?crit :
> > You were aware of the -nh option for mapserv, right?
> 
> Steve,
> 
> Ah, good point, actually, I was not.... I should have asked first.  But -nh
> doesn't seem to work. At least not in the WMS or WFS cases. It seems
> mapio.c doesn't honour mapserv->sendheaders, and the WMS or WFS code
> doesn't test it either
> 
> By looking at the places where sendheaders is used, it seems that you must
> test sendheaders at each place where msIO_setHeader() is called. Whereas my
> change does put the test inside msIO_setHeader() itself. Which is less
> error prone I think. But we cannot decently let both mechanisms in place
> 
> I see also some places that directly mess with sendheaders. Not sure why...
> 
> ../maptemplate.c:  mapserv->sendheaders = MS_TRUE;
> ../maptemplate.c:    mapserv->sendheaders = MS_FALSE;
> ../mapwfs.c:    mapserv->sendheaders = MS_TRUE;
> 
> Even
> 
> > ________________________________________
> > From: mapserver-dev-bounces at lists.osgeo.org
> > [mapserver-dev-bounces at lists.osgeo.org] on behalf of Even Rouault
> > [even.rouault at spatialys.com] Sent: Thursday, October 02, 2014 1:44 PM
> > To: mapserver-dev at lists.osgeo.org
> > Subject: [mapserver-dev] New env. var. to make it easier to test/debug
> > web
> > 
> >     services
> > 
> > Hi,
> > 
> > I always get annoyed when running mapserv from command line and wanting
> > to test/debug WMS, WFS, etc... without launching mapserv as a CGI,
> > because the HTTP headers get emitted and thus produce an invalid PNG or
> > GML. So I've pushed in master a small enhancement. If MS_HTTP_HEADER=NO
> > is set as environmenet variable, the HTTP headers are not emitted.
> > 
> > So now you can do things like :
> > 
> > MS_HTTP_HEADER=NO mapserv QUERY_STRING="map=test.map&SERVICE=WMS&..." >
> > out.png && display out.png MS_HTTP_HEADER=NO mapserv
> > QUERY_STRING="map=test.map&SERVICE=WFS&..."  | xmllint -noout -
> > 
> > Even
> > 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com
> > _______________________________________________
> > mapserver-dev mailing list
> > mapserver-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/mapserver-dev
> 
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Thu Oct  2 12:15:13 2014
From: ari.jolma at gmail.com (Ari Jolma)
Date: Thu, 02 Oct 2014 22:15:13 +0300
Subject: [gdal-dev] RuntimeError no COPY in progress
In-Reply-To: <201410022057.53217.even.rouault@spatialys.com>
References: <542D7CBD.3010807@gmail.com>
	<201410021945.20294.even.rouault@spatialys.com>
	<542D9E79.8090807@gmail.com>
	<201410022057.53217.even.rouault@spatialys.com>
Message-ID: <542DA441.20303@gmail.com>

On 02.10.2014 21:57, Even Rouault wrote:
> Le jeudi 02 octobre 2014 20:50:33, Ari Jolma a ?crit :
>> On 02.10.2014 20:45, Even Rouault wrote:
>>> Le jeudi 02 octobre 2014 18:26:37, Ari Jolma a ?crit :
>>>> 2014-10-02 19:23:03 EEST ERROR:  COPY from stdin failed: COPY terminated
>>>> by new PQexec
>>>>
>>>>
>>>>



> Could you try changing your code to use another driver to output to another
> format, like shapefile, GML, etc... and then try ogr2ogr -f postgresql ?

No problems when doing it like that. I used shapefile as the 
intermediate format.

Ari


From even.rouault at spatialys.com  Thu Oct  2 12:18:20 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 2 Oct 2014 21:18:20 +0200
Subject: [gdal-dev] RuntimeError no COPY in progress
In-Reply-To: <542DA441.20303@gmail.com>
References: <542D7CBD.3010807@gmail.com>
	<201410022057.53217.even.rouault@spatialys.com>
	<542DA441.20303@gmail.com>
Message-ID: <201410022118.20540.even.rouault@spatialys.com>

Le jeudi 02 octobre 2014 21:15:13, Ari Jolma a ?crit :
> On 02.10.2014 21:57, Even Rouault wrote:
> > Le jeudi 02 octobre 2014 20:50:33, Ari Jolma a ?crit :
> >> On 02.10.2014 20:45, Even Rouault wrote:
> >>> Le jeudi 02 octobre 2014 18:26:37, Ari Jolma a ?crit :
> >>>> 2014-10-02 19:23:03 EEST ERROR:  COPY from stdin failed: COPY
> >>>> terminated by new PQexec
> > 
> > Could you try changing your code to use another driver to output to
> > another format, like shapefile, GML, etc... and then try ogr2ogr -f
> > postgresql ?
> 
> No problems when doing it like that. I used shapefile as the
> intermediate format.

Hum, definitely weird. I've an idea to debug that. If you use GDAL trunk, you 
could enable the OGR C API spy mechanism, as the Perl bindings used the C API.
That will produce a OGR Python script (sorry for Python ;-)) that should have 
the same side effects regarding the OGR PostgreSQL driver as your original Perl 
script.

See http://www.gdal.org/ograpispy_8h.html


> 
> Ari

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ghostility at gmail.com  Thu Oct  2 12:23:48 2014
From: ghostility at gmail.com (Vladan Divljak)
Date: Thu, 2 Oct 2014 21:23:48 +0200
Subject: [gdal-dev] ogr2ogr sqldump?
In-Reply-To: <CAKpwtuNda5Lw+gQ3U1mRciUdBMV-y3KW=BgXjCvKTsO+p21Grg@mail.gmail.com>
References: <CAKpwtuMmQzD=YxNTxkOuv5Z6rj+DZ+q+RbyU6EPqQfOj-17_Mg@mail.gmail.com>
	<CACALY+Qz91eFDN3EbqyvrE1DODtnCG6z+Lux55XOWxp7tZ3EDQ@mail.gmail.com>
	<CACALY+Q_qRD3pujDMZ7cV-uvK3CO+rDFNHx7--8dR37Z2W1-dQ@mail.gmail.com>
	<CAKpwtuP9RipL5_jwaugi8g1qP4Q0MChFPT5d3SE+9xNecbUZng@mail.gmail.com>
	<CAKpwtuNyguxLLPd_oPw5=xJaMea4o_z2pmqvJPNpV3j5QFJKGA@mail.gmail.com>
	<CACALY+TJ_DZQuH3s_jYUF22k_DYnaJm41g=uPdn1EOyK3cFTMg@mail.gmail.com>
	<CAKpwtuNda5Lw+gQ3U1mRciUdBMV-y3KW=BgXjCvKTsO+p21Grg@mail.gmail.com>
Message-ID: <CAKpwtuMfdRtyjwaeYT05oQC6yAE3uQnwhgHunJZTZW3K0d5E_A@mail.gmail.com>

Just to note in case it went to spam, that I sent sample file to Tamas 3
days ago.


Cheers

On Mon, Sep 29, 2014 at 4:12 PM, Vladan Divljak wrote:

> Hi Tamas,
>
> I attached sample pgdump which crashes ogr2ogr r27766 but not stable and
> reports errors while stable migrates all rows without issues.
>
> I used this command:
>
>     ogr2ogr --DEBUG ON -f MSSQLSpatial \
>     "MSSQL:server=.;database=test;trusted_connection=yes" \
>     PG:"host=localhost user=postgres dbname=test" v100 -skipfailures
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141002/42415ad6/attachment.html>

From even.rouault at spatialys.com  Thu Oct  2 12:24:50 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 2 Oct 2014 21:24:50 +0200
Subject: [gdal-dev]
 =?iso-8859-1?q?=5Bmapserver-dev=5D_New_env=2E_var=2E_t?=
 =?iso-8859-1?q?o_make_it_easier_to_test/debug_web=09services?=
In-Reply-To: <201410022101.58389.even.rouault@spatialys.com>
References: <201410022044.12654.even.rouault@spatialys.com>
	<C549F0496453D842B4DD71AC8188DDC507F29674@055-CH1MPN1-041.055d.mgd.msft.net>
	<201410022101.58389.even.rouault@spatialys.com>
Message-ID: <201410022124.50138.even.rouault@spatialys.com>

Le jeudi 02 octobre 2014 21:01:58, Even Rouault a ?crit :
> Le jeudi 02 octobre 2014 20:57:46, Lime, Steve D (MNIT) a ?crit :
> > How about making -nh set the environment variable programatically and
> > losing the sendheaders checks?
> 
> Yes, that's a possibility. Although I think -nh could just call a function
> to disable the boolean in msio instead of messing with environmenet
> variables.

I've just implemented that. So no more env. variable trick. Just the standard 
-nh mechanism.

Would be cool to have a "mapserv --help" mode to display available options, 
wouldn't it ?

> 
> But I don't think we can remove all the sendheaders logic completely.  As
> mentionned in my above email, there's seem to have places where you want to
> disable/enable headers temporarily. Seems related to template. But I'm not
> familiar with the part of the code.
> 
> > ________________________________________
> > From: Even Rouault [even.rouault at spatialys.com]
> > Sent: Thursday, October 02, 2014 1:55 PM
> > To: Lime, Steve D (MNIT)
> > Cc: gdal-dev at lists.osgeo.org
> > Subject: Re: [mapserver-dev] New env. var. to make it easier to
> > test/debug web services
> > 
> > Le jeudi 02 octobre 2014 20:45:26, Lime, Steve D (MNIT) a ?crit :
> > > You were aware of the -nh option for mapserv, right?
> > 
> > Steve,
> > 
> > Ah, good point, actually, I was not.... I should have asked first.  But
> > -nh doesn't seem to work. At least not in the WMS or WFS cases. It seems
> > mapio.c doesn't honour mapserv->sendheaders, and the WMS or WFS code
> > doesn't test it either
> > 
> > By looking at the places where sendheaders is used, it seems that you
> > must test sendheaders at each place where msIO_setHeader() is called.
> > Whereas my change does put the test inside msIO_setHeader() itself.
> > Which is less error prone I think. But we cannot decently let both
> > mechanisms in place
> > 
> > I see also some places that directly mess with sendheaders. Not sure
> > why...
> > 
> > ../maptemplate.c:  mapserv->sendheaders = MS_TRUE;
> > ../maptemplate.c:    mapserv->sendheaders = MS_FALSE;
> > ../mapwfs.c:    mapserv->sendheaders = MS_TRUE;
> > 
> > Even
> > 
> > > ________________________________________
> > > From: mapserver-dev-bounces at lists.osgeo.org
> > > [mapserver-dev-bounces at lists.osgeo.org] on behalf of Even Rouault
> > > [even.rouault at spatialys.com] Sent: Thursday, October 02, 2014 1:44 PM
> > > To: mapserver-dev at lists.osgeo.org
> > > Subject: [mapserver-dev] New env. var. to make it easier to test/debug
> > > web
> > > 
> > >     services
> > > 
> > > Hi,
> > > 
> > > I always get annoyed when running mapserv from command line and wanting
> > > to test/debug WMS, WFS, etc... without launching mapserv as a CGI,
> > > because the HTTP headers get emitted and thus produce an invalid PNG or
> > > GML. So I've pushed in master a small enhancement. If MS_HTTP_HEADER=NO
> > > is set as environmenet variable, the HTTP headers are not emitted.
> > > 
> > > So now you can do things like :
> > > 
> > > MS_HTTP_HEADER=NO mapserv QUERY_STRING="map=test.map&SERVICE=WMS&..." >
> > > out.png && display out.png MS_HTTP_HEADER=NO mapserv
> > > QUERY_STRING="map=test.map&SERVICE=WFS&..."  | xmllint -noout -
> > > 
> > > Even
> > > 
> > > --
> > > Spatialys - Geospatial professional services
> > > http://www.spatialys.com
> > > _______________________________________________
> > > mapserver-dev mailing list
> > > mapserver-dev at lists.osgeo.org
> > > http://lists.osgeo.org/mailman/listinfo/mapserver-dev
> > 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Thu Oct  2 12:32:14 2014
From: ari.jolma at gmail.com (Ari Jolma)
Date: Thu, 02 Oct 2014 22:32:14 +0300
Subject: [gdal-dev] RuntimeError no COPY in progress
In-Reply-To: <201410022118.20540.even.rouault@spatialys.com>
References: <542D7CBD.3010807@gmail.com>
	<201410022057.53217.even.rouault@spatialys.com>
	<542DA441.20303@gmail.com>
	<201410022118.20540.even.rouault@spatialys.com>
Message-ID: <542DA83E.6050701@gmail.com>

2014-10-02 19:23:03 EEST ERROR: COPY from stdin failed: COPY terminated 
by new PQexec
> Hum, definitely weird. I've an idea to debug that. If you use GDAL trunk, you
> could enable the OGR C API spy mechanism, as the Perl bindings used the C API.
> That will produce a OGR Python script (sorry for Python ;-)) that should have
> the same side effects regarding the OGR PostgreSQL driver as your original Perl
> script.
>
> See http://www.gdal.org/ograpispy_8h.html

ok, I'll try that (recompile takes time) but an intermediate information 
is that the situation occurs only when the same datasource is used for 
reading and writing. I'm converting Polygons into LineStrings, so I'm 
reading from the database the polygons from one table and writing back 
lines into a different table. Now when I had two datasource objects to 
the same database the problem did not occur again.

Ari


From even.rouault at spatialys.com  Thu Oct  2 12:35:47 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 2 Oct 2014 21:35:47 +0200
Subject: [gdal-dev] RuntimeError no COPY in progress
In-Reply-To: <542DA83E.6050701@gmail.com>
References: <542D7CBD.3010807@gmail.com>
	<201410022118.20540.even.rouault@spatialys.com>
	<542DA83E.6050701@gmail.com>
Message-ID: <201410022135.47537.even.rouault@spatialys.com>

Le jeudi 02 octobre 2014 21:32:14, Ari Jolma a ?crit :
> 2014-10-02 19:23:03 EEST ERROR: COPY from stdin failed: COPY terminated
> by new PQexec
> 
> > Hum, definitely weird. I've an idea to debug that. If you use GDAL trunk,
> > you could enable the OGR C API spy mechanism, as the Perl bindings used
> > the C API. That will produce a OGR Python script (sorry for Python ;-))
> > that should have the same side effects regarding the OGR PostgreSQL
> > driver as your original Perl script.
> > 
> > See http://www.gdal.org/ograpispy_8h.html
> 
> ok, I'll try that (recompile takes time) but an intermediate information
> is that the situation occurs only when the same datasource is used for
> reading and writing. I'm converting Polygons into LineStrings, so I'm
> reading from the database the polygons from one table and writing back
> lines into a different table. Now when I had two datasource objects to
> the same database the problem did not occur again.

Don't search more. Yes, this is a feature/defect of the PG driver currently. 
It has issues with transactions that make using it at the same time as a 
reader and a writer with the same OGR datasource will not work properly. The 
work around is to instanciate 2 datasource objects indeed.

> 
> Ari

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jmckenna at gatewaygeomatics.com  Thu Oct  2 12:41:20 2014
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Thu, 02 Oct 2014 16:41:20 -0300
Subject: [gdal-dev] [mapserver-dev] New env. var. to make it easier to
 test/debug web services
In-Reply-To: <201410022124.50138.even.rouault@spatialys.com>
References: <201410022044.12654.even.rouault@spatialys.com>	<C549F0496453D842B4DD71AC8188DDC507F29674@055-CH1MPN1-041.055d.mgd.msft.net>	<201410022101.58389.even.rouault@spatialys.com>
	<201410022124.50138.even.rouault@spatialys.com>
Message-ID: <542DAA60.9050804@gatewaygeomatics.com>

On 2014-10-02 4:24 PM, Even Rouault wrote:
> Le jeudi 02 octobre 2014 21:01:58, Even Rouault a ?crit :
>> Le jeudi 02 octobre 2014 20:57:46, Lime, Steve D (MNIT) a ?crit :
>>> How about making -nh set the environment variable programatically and
>>> losing the sendheaders checks?
>>
>> Yes, that's a possibility. Although I think -nh could just call a function
>> to disable the boolean in msio instead of messing with environmenet
>> variables.
>
> I've just implemented that. So no more env. variable trick. Just the standard
> -nh mechanism.
>
> Would be cool to have a "mapserv --help" mode to display available options,
> wouldn't it ?

Would be super cool!  It would list the -nh and -v options (I don't know 
of other options).  The default message is, not fully correct:

   "This script can only be used to decode form results and should be 
initiated as a CGI process via a httpd server"


-jeff




From ari.jolma at gmail.com  Thu Oct  2 12:49:48 2014
From: ari.jolma at gmail.com (Ari Jolma)
Date: Thu, 02 Oct 2014 22:49:48 +0300
Subject: [gdal-dev] RuntimeError no COPY in progress
In-Reply-To: <201410022135.47537.even.rouault@spatialys.com>
References: <542D7CBD.3010807@gmail.com>
	<201410022118.20540.even.rouault@spatialys.com>
	<542DA83E.6050701@gmail.com>
	<201410022135.47537.even.rouault@spatialys.com>
Message-ID: <542DAC5C.3080000@gmail.com>

On 02.10.2014 22:35, Even Rouault wrote:
> Don't search more. Yes, this is a feature/defect of the PG driver 
> currently. It has issues with transactions that make using it at the 
> same time as a reader and a writer with the same OGR datasource will 
> not work properly. The work around is to instanciate 2 datasource 
> objects indeed. 

I've added this to drv_pg_advanced.html.

Ari

>> Ari


From even.rouault at spatialys.com  Thu Oct  2 13:09:50 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 2 Oct 2014 22:09:50 +0200
Subject: [gdal-dev] [mapserver-dev] New env. var. to make it easier to
	test/debug web services
In-Reply-To: <542DAA60.9050804@gatewaygeomatics.com>
References: <201410022044.12654.even.rouault@spatialys.com>
	<201410022124.50138.even.rouault@spatialys.com>
	<542DAA60.9050804@gatewaygeomatics.com>
Message-ID: <201410022209.50385.even.rouault@spatialys.com>

Le jeudi 02 octobre 2014 21:41:20, Jeff McKenna a ?crit :
> On 2014-10-02 4:24 PM, Even Rouault wrote:
> > Le jeudi 02 octobre 2014 21:01:58, Even Rouault a ?crit :
> >> Le jeudi 02 octobre 2014 20:57:46, Lime, Steve D (MNIT) a ?crit :
> >>> How about making -nh set the environment variable programatically and
> >>> losing the sendheaders checks?
> >> 
> >> Yes, that's a possibility. Although I think -nh could just call a
> >> function to disable the boolean in msio instead of messing with
> >> environmenet variables.
> > 
> > I've just implemented that. So no more env. variable trick. Just the
> > standard -nh mechanism.
> > 
> > Would be cool to have a "mapserv --help" mode to display available
> > options, wouldn't it ?
> 
> Would be super cool!  It would list the -nh and -v options (I don't know
> of other options).  

With my latest commit, and default configuration :

$ mapserv --help
Usage: mapserv [--help] [-v] [-nh] [QUERY_STRING=value]

Options :
  -h, --help              Display this help message
  -v                      Display version and exit.
  -nh                     Suppress HTTP headers in CGI mode.
  QUERY_STRING=value      Set the QUERY_STRING in GET request mode.

When compiled with -DMS_ENABLE_CGI_CL_DEBUG_ARGS

$ mapserv --help
Usage: mapserv [--help] [-v] [-nh] [QUERY_STRING=value]
               [-tmpbase dirname] [-t mapfilename] [MS_ERRORFILE=value] [MS_DEBUGLEVEL=value]

Options :
  -h, --help              Display this help message
  -v                      Display version and exit.
  -nh                     Suppress HTTP headers in CGI mode.
  QUERY_STRING=value      Set the QUERY_STRING in GET request mode.
  -tmpbase dirname        Define a forced temporary directory.
  -t mapfilename          Display the tokens of the mapfile after parsing.
  MS_ERRORFILE=filename   Set error file.
  MS_DEBUGLEVEL=value     Set debug level.


> The default message is, not fully correct:
> 
>    "This script can only be used to decode form results and should be
> initiated as a CGI process via a httpd server"

Any suggestion ?

> 
> 
> -jeff
> 
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From szekerest at gmail.com  Thu Oct  2 13:28:46 2014
From: szekerest at gmail.com (Tamas Szekeres)
Date: Thu, 2 Oct 2014 22:28:46 +0200
Subject: [gdal-dev] ogr2ogr sqldump?
In-Reply-To: <CAKpwtuMfdRtyjwaeYT05oQC6yAE3uQnwhgHunJZTZW3K0d5E_A@mail.gmail.com>
References: <CAKpwtuMmQzD=YxNTxkOuv5Z6rj+DZ+q+RbyU6EPqQfOj-17_Mg@mail.gmail.com>
	<CACALY+Qz91eFDN3EbqyvrE1DODtnCG6z+Lux55XOWxp7tZ3EDQ@mail.gmail.com>
	<CACALY+Q_qRD3pujDMZ7cV-uvK3CO+rDFNHx7--8dR37Z2W1-dQ@mail.gmail.com>
	<CAKpwtuP9RipL5_jwaugi8g1qP4Q0MChFPT5d3SE+9xNecbUZng@mail.gmail.com>
	<CAKpwtuNyguxLLPd_oPw5=xJaMea4o_z2pmqvJPNpV3j5QFJKGA@mail.gmail.com>
	<CACALY+TJ_DZQuH3s_jYUF22k_DYnaJm41g=uPdn1EOyK3cFTMg@mail.gmail.com>
	<CAKpwtuNda5Lw+gQ3U1mRciUdBMV-y3KW=BgXjCvKTsO+p21Grg@mail.gmail.com>
	<CAKpwtuMfdRtyjwaeYT05oQC6yAE3uQnwhgHunJZTZW3K0d5E_A@mail.gmail.com>
Message-ID: <CACALY+TUZMo9Cep9pLEapgtm+UqiM7db4uGkWZOTTDJPorKEig@mail.gmail.com>

Vladan,

Just committed an implementation for the WKB geometry upload to MSSQL which
should also fix the issue of your use case.
Let me know if you still have issues.

Best regards,

Tamas



2014-10-02 21:23 GMT+02:00 Vladan Divljak <ghostility at gmail.com>:

> Just to note in case it went to spam, that I sent sample file to Tamas 3
> days ago.
>
>
> Cheers
>
> On Mon, Sep 29, 2014 at 4:12 PM, Vladan Divljak wrote:
>
>> Hi Tamas,
>>
>> I attached sample pgdump which crashes ogr2ogr r27766 but not stable and
>> reports errors while stable migrates all rows without issues.
>>
>> I used this command:
>>
>>     ogr2ogr --DEBUG ON -f MSSQLSpatial \
>>     "MSSQL:server=.;database=test;trusted_connection=yes" \
>>     PG:"host=localhost user=postgres dbname=test" v100 -skipfailures
>>
>>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141002/fbd0425d/attachment.html>

From ljvillarin30 at gmail.com  Thu Oct  2 19:18:29 2014
From: ljvillarin30 at gmail.com (Love)
Date: Fri, 3 Oct 2014 10:18:29 +0800
Subject: [gdal-dev] gdal/python/bash: Project level 2 hdf files only and
 automatically project the newest files added everyday(batch process)
Message-ID: <CAMZEyL7r1rOUtBuK=9wh_=iAteOa4jm16fhgt=GDtHTTjm04rQ@mail.gmail.com>

I have numerous hdf files dowloaded from ftp site and saved it to my local
directory.The hdf files has level 1 and level 2(e.g.
A2001037040000.L1A_LAC.hdffiles.hdf, A2001037040000.L2_LAC.hdffiles.hdf).
How will I project the level 2 files ONLY in batch process and
automatically create a directory for the projected files?And what should I
do so that I would be able to project/process the newest files I have
downloaded EVERYDAY, this means that the projection should update everyday
and if there are files added that should only be projected?

IMPORTANT: The hdf files for today aren't available yet so the newest files
to be projected/processed are those files uploaded yesterday because all
the files uploaded in the ftp site are delayed one day.

Thanks in advance for your help!

Code:

def projectData(self, event):

    def findSDS (path, filter):
        for root, dirs, files in os.walk(path):
            for file in fnmatch.filter(files, filter):
                yield file

    for sds in findSDS('D:/folder/hdf/files', '*.hdf'):
        inSDS = 'HDF4_SDS:' + 'D:/folder/hdf/files' + '/' + sds + ':01'
        path = 'D:/save/newprojected'
        outTIFF = path + sds + '.tif'
        cmd = 'gdalwarp -geoloc -t_srs "proj=longlat +datum=WGS84" -te
111.157 1.075 129.225 15.205 %s %s' % (inSDS, outTIFF)

        os.system(cmd)
        os.mkdir(path)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141003/1ffa9e44/attachment.html>

From lhomme.xavier at gmail.com  Fri Oct  3 00:48:43 2014
From: lhomme.xavier at gmail.com (xavier lhomme)
Date: Fri, 3 Oct 2014 09:48:43 +0200
Subject: [gdal-dev] Geotiff "client side"
Message-ID: <CACqzBMwzyD__G-=UJr89RTS7P=Ae=HFbvyi0fAnNLuUorMgUyQ@mail.gmail.com>

Hi

  WCS has the ability to return a coverage as a GeoTiff file. Then if you
want to display or process row data from this file in a Javascript web
client, you need to have to ability to decode the "GeoTiff" part of this
file.

 I found a Tiff.js library compiled with Emscripten. I succeed to display a
GeoTiff with this library as a Tiff file. But I still need to decode the
GeoTiff tag and create the "PCSToImage" / "ImageToPCS" functions.
  Two solutions :
       compile GeoTiff with emscripten or rewrite some part of the GeoTiff
function in javascript.

Another solution should be to ask the server to return the parameter from
the image. Is there a way to do this without sending the full image to the
server ?


Best regards

xavier lhomme
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141003/3f246e5a/attachment.html>

From p.baumann at jacobs-university.de  Fri Oct  3 02:12:13 2014
From: p.baumann at jacobs-university.de (Peter Baumann)
Date: Fri, 3 Oct 2014 11:12:13 +0200
Subject: [gdal-dev] Geotiff "client side"
In-Reply-To: <CACqzBMwzyD__G-=UJr89RTS7P=Ae=HFbvyi0fAnNLuUorMgUyQ@mail.gmail.com>
References: <CACqzBMwzyD__G-=UJr89RTS7P=Ae=HFbvyi0fAnNLuUorMgUyQ@mail.gmail.com>
Message-ID: <542E686D.6010708@jacobs-university.de>

Hi Xavier,

there is a couple of options with WCS 2.

- you can request another format which is easier to handle by the client, such 
as PNG (builtin browser support).

- you can send a separate DescibeCoverage request and get an XML structure 
containing all metadata.

- you can direct the server (if it supports this - data formats are at its 
discretion) to deliver a multipart MIME document (same mechanism as email + 
attachment). Its first part will be the coverage description in XML, the second 
part the (TIFF or PNG or ...) image.To this end, use this request syntax 
(presented in GET/KVP and TIFF, for POST/XML see the protocol binding specs):
     http://.../wcs?REQUEST=GetCoverage & ... &
         FORMAT=image/tiff & MEDIATYPE=multipart/related

HTH,
Peter



On 10/03/2014 09:48 AM, xavier lhomme wrote:
> Hi
>
>   WCS has the ability to return a coverage as a GeoTiff file. Then if you want 
> to display or process row data from this file in a Javascript web client, you 
> need to have to ability to decode the "GeoTiff" part of this file.
>
>  I found a Tiff.js library compiled with Emscripten. I succeed to display a 
> GeoTiff with this library as a Tiff file. But I still need to decode the 
> GeoTiff tag and create the "PCSToImage" / "ImageToPCS" functions.
>   Two solutions :
>        compile GeoTiff with emscripten or rewrite some part of the GeoTiff 
> function in javascript.
> Another solution should be to ask the server to return the parameter from the 
> image. Is there a way to do this without sending the full image to the server ?
>
>
> Best regards
>
> xavier lhomme

-- 
Dr. Peter Baumann
  - Professor of Computer Science, Jacobs University Bremen
    www.faculty.jacobs-university.de/pbaumann
    mail: p.baumann at jacobs-university.de
    tel: +49-421-200-3178, fax: +49-421-200-493178
  - Executive Director, rasdaman GmbH Bremen (HRB 26793)
    www.rasdaman.com, mail: baumann at rasdaman.com
    tel: 0800-rasdaman, fax: 0800-rasdafax, mobile: +49-173-5837882
"Si forte in alienas manus oberraverit hec peregrina epistola incertis ventis dimissa, sed Deo commendata, precamur ut ei reddatur cui soli destinata, nec preripiat quisquam non sibi parata." (mail disclaimer, AD 1083)


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141003/03a75032/attachment-0001.html>

From marcelblom at xs4all.nl  Fri Oct  3 06:02:18 2014
From: marcelblom at xs4all.nl (Marcel Blom)
Date: Fri, 03 Oct 2014 15:02:18 +0200
Subject: [gdal-dev] GDALwarp creates some darker images after update
 from 1.7.0b2 to GDAL 1.11.0
In-Reply-To: <54274574.2030309@xs4all.nl>
References: <5425A52D.8020406@xs4all.nl>	<201409261946.58340.even.rouault@spatialys.com>
	<54274574.2030309@xs4all.nl>
Message-ID: <542E9E5A.6090405@xs4all.nl>

Because I didn't see a difference between Tiff and BMP I started testing 
some more with the GDALwarp options...
And because the resolution made a difference, I tested with the -r 
filters...

When I used an other filter then cubicspline, the problem was gone. So 
the problem was a combination with the cubicspline filter and a specific 
target resolution.

I'm using an other filter now as work-around.
The testing files will be deleted. I need the space...


Marcel


Marcel Blom schreef op 28-9-2014 om 1:17:
> Hi Even,
>
> I uploaded stuff for testing in Dropbox : 
> https://www.dropbox.com/sh/0f1zrs295s75u5n/AAAZI2tTokaYZtJ6cfj9zxe0a?dl=0
>
> Because I had too much data I wanted to use lower resolution files and 
> guess what? On other resolutions the problems were gone.
> So it might have something to do with size/resolution..(?)
> I also tested warping direct from one source file and the results were 
> the same. But because I use a VRT with multiple source files I added a 
> VRT file and made these target files via the VRT file.
> I have only space to upload one source file. When I used multiple 
> source files in the VRT the target file was even darker (svt-08+.bmp)
>
> I uploaded :
> - !buildvrt.bat (with commands to build the VRT file)
> - !warp.bat (with commands to warp the VRT into target files)
> - _Source.tif (as source file)
> - _gdalbuild.vrt (as VRT file)
>
> Resulting target files:
> - svt-02.bmp (Source > VRT > Target 2048x2048 = normal)
> - svt-04.bmp (Source > VRT > Target 4096x4096 = normal)
> - svt-08.bmp (Source > VRT > Target 8192x8192 = darker)
> - svt-08+.bmp (Source > VRT with multiple files > Target 8192x8192 = 
> even darker)
> - svt-16.bmp (Source > VRT > Target 16384x16384 = normal)
>
> Really strange.
> I didn't see this behaviour with the older GDAL.
>
> Marcel
>
> Even Rouault schreef op 26-9-2014 om 19:46:
>> Marcel,
>>
>> The best would be that you prepare something that others can try in a 
>> fully
>> reproducable way, i.e. provide source(s) image(s) and all the exact 
>> command
>> lines you use.
>>
>> Even
>>
>> Le vendredi 26 septembre 2014 19:41:01, Marcel Blom a ?crit :
>>> Because of some problems with GDAL 1.7.0b2 in FWTools 2.4.7 I upgraded
>>> to GDAL 1.11.0 in the latest OSGeo4W distro. This solved some issues I
>>> had, but introduced a really annoying one and what ever I do I can't 
>>> get
>>> rid off it. I hope someone can help me out. If BTW I try to go back to
>>> GDAL 1.7.0b2 with FWTools the problem is still there, so I guess it's a
>>> (new) driver/DLL update issue.
>>>
>>> My problem looks exactly like this post... GDAL TIF to JPG Creates Dark
>>> Image
>>> <http://gis.stackexchange.com/questions/101393/gdal-tif-to-jpg-creates-dark 
>>>
>>> -image> Only that I don't use JPG. And I use GDALwarp. And not all 
>>> target
>>> files have the problem. Most target files look OK. And I only see it 
>>> with
>>> Aerial Photo like sources. With vector like raster sources I don't 
>>> see the
>>> problem. So when reading the other post I thought it had to do with a
>>> mask/alpha channel or something, but I can't see this in the source. 
>>> And
>>> whatever option I test, the problem remains.
>>>
>>> I already created a post here :
>>> http://gis.stackexchange.com/questions/114526/gdalwarp-creates-darker-targe 
>>>
>>> t-image-sometimes But I had no final answer... And I think this is the
>>> right place to ask.
>>>
>>> Here are two screenshots. One from the source (Tiff) and one from a
>>> intersection of four target files (Tiff or BMP)
>>>
>>> Section of Source :
>>> https://www.dropbox.com/s/gy2tu0h8dufv41o/Source.jpg?dl=0
>>>
>>> Intersection of four Target files :
>>> https://www.dropbox.com/s/av7mdj8ivx3zgsl/Target.jpg?dl=0
>>>
>>> The source I use is 8bit/channel RGB JPEG. And the merged Tiff is
>>> 8bit/channel RGB.
>>> I tested almost all options in multiple actions in my workflow. So
>>> cutting the source with gdaltranslate in smaller parts for editing.
>>> Building a VRT with gdalbuildvrt and cutting into final parts with
>>> gdalwarp which will show the problem.
>>>
>>> I started with the -b 1 -b 2 -b 3 option in my gdalbuildvrt action, but
>>> GDAL crashes here... (?) I also tested other options that might have
>>> something to do with the problem... -nomd -co ALPHA=YES/No -co
>>> PHOTOMETRIC=RGBA/RGB -setci, you name it...
>>>
>>> I checked good and bad source and target areas with gdalcompare and
>>> gdalinfo, but I saw nothing strange...
>>>
>>> I'm now thinking of resetting GDAL driver settings if that is 
>>> possible..(?)
>>>
>>> Has anyone seen this before? Can anyone give me a hint..?
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From jukka.rahkonen at mmmtike.fi  Fri Oct  3 14:11:31 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Fri, 3 Oct 2014 21:11:31 +0000 (UTC)
Subject: [gdal-dev] Accurate -spat for ogr2ogr
Message-ID: <loom.20141003T225759-709@post.gmane.org>

Hi,

There are advanced options in ogr2ogr for clipping features to WKT or to a
clipping layer. However, there does not seem to be a way to only select
features without clipping them in a same way. A typical use case would be to
select features from global dataset by country borders. Could this be doable
and how? I have understood that -spat is doing a quick and not accurate
selection by feature BBOXes and "-spat [xmin ymin xmax ymax]|WKT|datasource"
would not be good. Perhaps it should be then something derived from 
"-clipsrc [xmin ymin xmax ymax]|WKT|datasource|spat_extent" like 

"-selectsrc [xmin ymin xmax ymax]|WKT|datasource"? And -selectdst could be
supported in a similar way.

-Jukka Rahkonen-



From even.rouault at spatialys.com  Fri Oct  3 14:28:49 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 3 Oct 2014 23:28:49 +0200
Subject: [gdal-dev] Accurate -spat for ogr2ogr
In-Reply-To: <loom.20141003T225759-709@post.gmane.org>
References: <loom.20141003T225759-709@post.gmane.org>
Message-ID: <201410032328.49693.even.rouault@spatialys.com>

Le vendredi 03 octobre 2014 23:11:31, Jukka Rahkonen a ?crit :
> Hi,
> 
> There are advanced options in ogr2ogr for clipping features to WKT or to a
> clipping layer. However, there does not seem to be a way to only select
> features without clipping them in a same way. A typical use case would be
> to select features from global dataset by country borders. 

For that use case, I'm not sure if you would imagine selecting features that 
intersect the specified shape (current semantics of -spat), or that are fully 
contained within the shape ?

That can be done with sqlite dialect and use of a  "SELECT ... FROM ... WHERE 
ST_Intersects(geom_field, ST_GeomFromText('...'))" although I understand it is 
less convenient than specifying a shapefile.

> Could this be
> doable and how? I have understood that -spat is doing a quick and not
> accurate selection by feature BBOXes

Normally, for well behaved drivers, -spat should do full intersection of the 
spatial filter rectangle and the feature geometry when GEOS is available. It 
does only intersection of the spatial filter rectangle and the feature BBOX 
when GEOS isn't available

But it is true that the SetSpatialFilter() interface is mostly tested with 
rectangle filters, so I wouldn't be completely surprised that some drivers 
cheat and use only the geometry BBOX. Hum, seems to be the case of PostGIS. 
Should be corrected.

> and "-spat [xmin ymin xmax
> ymax]|WKT|datasource" would not be good. 

Why ?

> Perhaps it should be then
> something derived from "-clipsrc [xmin ymin xmax
> ymax]|WKT|datasource|spat_extent" like
> 
> "-selectsrc [xmin ymin xmax ymax]|WKT|datasource"? And -selectdst could be
> supported in a similar way.
> 
> -Jukka Rahkonen-
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at mmmtike.fi  Fri Oct  3 14:37:02 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Fri, 3 Oct 2014 21:37:02 +0000 (UTC)
Subject: [gdal-dev] Accurate -spat for ogr2ogr
References: <loom.20141003T225759-709@post.gmane.org>
	<201410032328.49693.even.rouault@spatialys.com>
Message-ID: <loom.20141003T233422-647@post.gmane.org>

Even Rouault <even.rouault <at> spatialys.com> writes:

> > and "-spat [xmin ymin xmax
> > ymax]|WKT|datasource" would not be good. 
> 
> Why ?


Only because I thought that -spat is tightly made to support only
rectangular selections and to make search by bboxes from spatial index if
such exists. 

-Jukka-


From lukasz.tracewski at outlook.com  Sun Oct  5 02:59:33 2014
From: lukasz.tracewski at outlook.com (Lukasz Tracewski)
Date: Sun, 5 Oct 2014 11:59:33 +0200
Subject: [gdal-dev] Sum pixel values in selected area of an image
In-Reply-To: <201410021700.46351.even.rouault@spatialys.com>
References: <DUB120-W2789066AA9A9FA4315AF018FB90@phx.gbl>,
	<201410021700.46351.even.rouault@spatialys.com>
Message-ID: <DUB120-W49B811BAF4ED8E3869C8CE8FA40@phx.gbl>

Unless I did not correctly understand the advice or the 'gdalwarp' manual page, the first point ("make sure both raster have same dimensions") is deviating from what I want to achieve here. Now I see that more detailed information might be needed - my apologies for the confusion.
Raster with forest are huge images, with 30 meters spatial resolution, and size of 36000 x 36000 pixels (lets call them "forest rasters"). The other raster describes area over which I would like to calculate the forest area. Those are bilevel images, with "1" meaning that the pixel should be included in calculations and "0" otherwise. Physically they represent habitats of certain animal species and spawn from a couple of hundreds km2 to hundreds of thousands km2. We will call them "animal rasters".
Here is an example how such habitat for a certain species looks like in ASCII format:
ncols 6nrows 5xllcorner 916000yllcorner 496000cellsize 1000.000000NODATA_value -99990 0 0 0 0 0 0 1 1 1 1 0 1 1 1 1 1 0 0 0 1 1 0 0 0 0 0 0 0 0 
The scale is 1000 meters. The forest raster is 30 meters.
If I now follow the proposed workflow, I have to rescale 36,000 x 36,000 pixels forest raster to 6x5 pixels, loosing therefore all resolution. That is of course assuming I understood correctly what Even proposed.
What I would like to get is something as follows:1. With gdalinfo read pixel size of "animal raster", in this case 0.008950249595932.2. Rescale the "forest raster" to match the scale: gdalwarp -tr 0.008950249595932 0.008950249595932 -r average -tap forest.tif forest_scaled.tif . Now they are at the same scale, but obviously the dimensions are different. Purpose of this part is to make the calculations faster.3. Multiply the two rasters, taking into account dimensionality. Since both images are goereferenced, I would expect that there is something in GDAL that takes that into account. If they are at the same scale, one could superimpose them and take nearest neighbour for multiplication.
I do not mind at all going to C++ or Python to achieve this. 

Thanks for help!Lucas

> From: even.rouault at spatialys.com
> To: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] Sum pixel values in selected area of an image
> Date: Thu, 2 Oct 2014 17:00:46 +0200
> CC: lukasz.tracewski at outlook.com
> 
> Le jeudi 02 octobre 2014 09:02:00, Lukasz Tracewski a ?crit :
> > Hi,
> > I only recently started my adventure with GDAL and GIS in general, so
> > please accept my apologies for perhaps maybe the most accurate formulation
> > of the problem. I also did my best to find the answer already on this
> > mailing list and outside, but to no avail - again possibly due to lack of
> > experience. Last year Hansen et al. prepared a detailed map, 30 meters
> > resolution, of forest cover for the whole planet. The data is publicly
> > accessible, both for online viewing and download. Both can be found here:
> > http://earthenginepartners.appspot.com/science-2013-global-forest The
> > forest cover images are GeoTIFF and have pixel values in range [0, 100]
> > that describes percentage of forest cover. I have some georeferenced
> > images that essentially are composed of ones and zeros, e.g.:0 1 1 0 00 1
> > 1 1 00 1 0 0 0... Those images are in 1000 meters scale and can spawn over
> > whole continents.  My aim is to calculate forest cover for them: wherever
> > the value is "1", this pixel should be added to the forest cover. Say the
> > Hansen image looks like this:10 20 30 40 5010 80 80 0 00 0 0 0 0... Then
> > rows and column of this images should be multiplied by respective rows and
> > columns of my own image, producing: 0 * 10 + 20 * 1 + 30 * 1 + 40 * 0 + 50
> > * 0 + 10 * 0 + 80 * 1 + ... = 210 Mind that scale of both images is
> > different, so the example above is actually not accurate. The real
> > calculations should average pixel values, then sum them and then convert
> > to area. Can anyone point me where to start? Maybe you know of any
> > examples that could give me a hint?
> 
> Lukasz,
> 
> There are likely many ways of doing that. Here's a potential workflow
> 
> 1) With gdalwarp -r averge -ts you could make sure both raster have same 
> dimensions
> 2) Use gdal_calc.py to do the multiplication pixel by pixel.
> 3) Use gdalinfo -stats to compute statistics on the raster generated by 2). 
> Multiply the MEAN value by the raster width and raster height, and that will 
> give you the sum.
> 
> Even
> 
> > 
> > Thanks,Lucas
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com
 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141005/948f5dd0/attachment.html>

From Martin.Lewis at euro.ngc.com  Mon Oct  6 08:02:51 2014
From: Martin.Lewis at euro.ngc.com (M Lewis)
Date: Mon, 6 Oct 2014 08:02:51 -0700 (PDT)
Subject: [gdal-dev] NITF YCbCr To RGB?
Message-ID: <1412607771762-5166169.post@n6.nabble.com>

We have a software component where users can view/zoom/pan different map
types.
We use GDAL to read the specific part of the image using RasterIO as raw
bytes and then convert to a bitmap for display.
We are now incorporating viewing NITF files and am a little confused in how
the NITF driver handles YCbCr colour space (which some of the NITFs have).
I have found these little snippets from Frank that I found in another post
from 2005:

/'....Othewise YCbCr images are automatically converted to RGB internally.
However, even in the (default) case where YCbCr images are converted to RGB
internally I *think* that the NITFDataset will still return the YCbCr band
types. This is a bug, and if you want it fixed please file a bug'/

Also in the NITFDataset code there is a comment:

/ /* FIXME? Does it make sense if the JPEG/JPEG2000 driver decodes */
                /* YCbCr data as RGB. We probably don't want to set */
                /* the color interpretation as Y, Cb, Cr *//

Here is a typical gdalinfo dump of a NITF file that I have to deal with:

Band 1 Block=640x1 Type=Byte, ColorInterp=YCbCr_Y
  Overviews: 320x240, 160x120
  Image Structure Metadata:
    COMPRESSION=JPEG
Band 2 Block=640x1 Type=Byte, ColorInterp=YCbCr_Cb
  Overviews: 320x240, 160x120
  Image Structure Metadata:
    COMPRESSION=JPEG
Band 3 Block=640x1 Type=Byte, ColorInterp=YCbCr_Cr
  Overviews: 320x240, 160x120
  Image Structure Metadata:
    COMPRESSION=JPEG

The question is can it be assumed (based on Franks comments) that in the
decoding by the JPEG driver that Band 1 has been converted to Red even
though it states above that the band is YCbCr?

Also if this is not the case and the bands are YCbCr, can somebody give any
clues of converting a YCbCr image in raw data bytes to an RGB bitmap?

Thanks

Martin



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/NITF-YCbCr-To-RGB-tp5166169.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Mon Oct  6 08:39:53 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 6 Oct 2014 17:39:53 +0200
Subject: [gdal-dev] NITF YCbCr To RGB?
In-Reply-To: <1412607771762-5166169.post@n6.nabble.com>
References: <1412607771762-5166169.post@n6.nabble.com>
Message-ID: <201410061739.53656.even.rouault@spatialys.com>

Le lundi 06 octobre 2014 17:02:51, M Lewis a ?crit :
> We have a software component where users can view/zoom/pan different map
> types.
> We use GDAL to read the specific part of the image using RasterIO as raw
> bytes and then convert to a bitmap for display.
> We are now incorporating viewing NITF files and am a little confused in how
> the NITF driver handles YCbCr colour space (which some of the NITFs have).
> I have found these little snippets from Frank that I found in another post
> from 2005:
> 
> /'....Othewise YCbCr images are automatically converted to RGB internally.
> However, even in the (default) case where YCbCr images are converted to RGB
> internally I *think* that the NITFDataset will still return the YCbCr band
> types. This is a bug, and if you want it fixed please file a bug'/
> 
> Also in the NITFDataset code there is a comment:
> 
> / /* FIXME? Does it make sense if the JPEG/JPEG2000 driver decodes */
>                 /* YCbCr data as RGB. We probably don't want to set */
>                 /* the color interpretation as Y, Cb, Cr *//
> 
> Here is a typical gdalinfo dump of a NITF file that I have to deal with:
> 
> Band 1 Block=640x1 Type=Byte, ColorInterp=YCbCr_Y
>   Overviews: 320x240, 160x120
>   Image Structure Metadata:
>     COMPRESSION=JPEG
> Band 2 Block=640x1 Type=Byte, ColorInterp=YCbCr_Cb
>   Overviews: 320x240, 160x120
>   Image Structure Metadata:
>     COMPRESSION=JPEG
> Band 3 Block=640x1 Type=Byte, ColorInterp=YCbCr_Cr
>   Overviews: 320x240, 160x120
>   Image Structure Metadata:
>     COMPRESSION=JPEG
> 
> The question is can it be assumed (based on Franks comments) that in the
> decoding by the JPEG driver that Band 1 has been converted to Red even
> though it states above that the band is YCbCr?

Martin,

Yes, Frank's comment is right. The color interpretation is wrong. It should be 
RGB, since on-the-fly colorspace conversion from YCbCr to RGB has been done.
That should be fixed

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From leifer at gmail.com  Mon Oct  6 09:08:22 2014
From: leifer at gmail.com (Leif Gruenwoldt)
Date: Mon, 6 Oct 2014 12:08:22 -0400
Subject: [gdal-dev] Tags missing on GitHub mirror
Message-ID: <CALFF=ZQ--LDkAOag990aMMcBi_QAK4yyDU0nvXKkFAFfBWaSHA@mail.gmail.com>

I'm trying to add the gdal repo as a git submodule to one
of my projects. My project requires a specific older revision of gdal
(1.4.1) so I want to set the git submodule to that point in time, but it's
hard to do that without the tags in the GitHub mirror.

Can someone push the git tags to the gdal github mirror?

https://github.com/OSGeo/gdal

Cheers

From even.rouault at spatialys.com  Mon Oct  6 09:20:05 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 6 Oct 2014 18:20:05 +0200
Subject: [gdal-dev] Tags missing on GitHub mirror
In-Reply-To: <CALFF=ZQ--LDkAOag990aMMcBi_QAK4yyDU0nvXKkFAFfBWaSHA@mail.gmail.com>
References: <CALFF=ZQ--LDkAOag990aMMcBi_QAK4yyDU0nvXKkFAFfBWaSHA@mail.gmail.com>
Message-ID: <201410061820.05621.even.rouault@spatialys.com>

Le lundi 06 octobre 2014 18:08:22, Leif Gruenwoldt a ?crit :
> I'm trying to add the gdal repo as a git submodule to one
> of my projects. My project requires a specific older revision of gdal
> (1.4.1) so I want to set the git submodule to that point in time, but it's
> hard to do that without the tags in the GitHub mirror.
> 
> Can someone push the git tags to the gdal github mirror?

It is already there (but it seems there's a UI problem with the github with 
Firefox, at least my version. had to use Chrome to display branches/tags)

https://github.com/OSGeo/gdal/tree/tags/1.4.1

> 
> https://github.com/OSGeo/gdal
> 
> Cheers
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From leifer at gmail.com  Mon Oct  6 10:20:35 2014
From: leifer at gmail.com (Leif Gruenwoldt)
Date: Mon, 6 Oct 2014 13:20:35 -0400
Subject: [gdal-dev] Tags missing on GitHub mirror
In-Reply-To: <201410061820.05621.even.rouault@spatialys.com>
References: <CALFF=ZQ--LDkAOag990aMMcBi_QAK4yyDU0nvXKkFAFfBWaSHA@mail.gmail.com>
	<201410061820.05621.even.rouault@spatialys.com>
Message-ID: <CALFF=ZSiuBnwfe3UT97T9QUbKq1e0f20+rWnrFbuSdytVF1TYg@mail.gmail.com>

Oh weird.

I decided to go ahead and clone the gdal repo locally, but I don't see
the tags there either. Maybe it's something to do with the svn -> git
migration...

Worst case I will use the git SHA1
(184230238828f0f31aed7335e4c8443963437b66) from the 1.4.1 github URL
you shared for configuring my git submodule.

On Mon, Oct 6, 2014 at 12:20 PM, Even Rouault
<even.rouault at spatialys.com> wrote:
> Le lundi 06 octobre 2014 18:08:22, Leif Gruenwoldt a ?crit :
>> I'm trying to add the gdal repo as a git submodule to one
>> of my projects. My project requires a specific older revision of gdal
>> (1.4.1) so I want to set the git submodule to that point in time, but it's
>> hard to do that without the tags in the GitHub mirror.
>>
>> Can someone push the git tags to the gdal github mirror?
>
> It is already there (but it seems there's a UI problem with the github with
> Firefox, at least my version. had to use Chrome to display branches/tags)
>
> https://github.com/OSGeo/gdal/tree/tags/1.4.1
>
>>
>> https://github.com/OSGeo/gdal
>>
>> Cheers
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com

From stefan.ziegler.de at gmail.com  Mon Oct  6 10:41:43 2014
From: stefan.ziegler.de at gmail.com (Stefan Ziegler)
Date: Mon, 6 Oct 2014 19:41:43 +0200
Subject: [gdal-dev] SQLite dialect with GeoPackage
Message-ID: <CAJvo+19FZ7YSsWhB14DDuecWMPLROSZcgiLNwS1bSx5yky1ESQ@mail.gmail.com>

Hi

When trying to use SQLite dialect with GeoPackage I get some errors, like:

stefan at hatschepsut:~/Downloads$ ogrinfo -al -sql 'SELECT
ST_X(ST_SnapToGrid(geom,1)) FROM bodenbedeckung__bbtext LIMIT 1'
2601.gpkgINFO: Open of `2601.gpkg'
      using driver `GPKG' successful.
ERROR 1: In ExecuteSQL(): sqlite3_prepare(SELECT
ST_X(ST_SnapToGrid(geom,1)) FROM bodenbedeckung__bbtext LIMIT 1):
  no such function: ST_SnapToGrid


The same query works with Shapefiles. I thought the SQLite dialect can be
used with any OGR datasource?

I'm using gdal dev.

regards
Stefan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141006/282dc92d/attachment.html>

From even.rouault at spatialys.com  Mon Oct  6 11:20:14 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 6 Oct 2014 20:20:14 +0200
Subject: [gdal-dev] SQLite dialect with GeoPackage
In-Reply-To: <CAJvo+19FZ7YSsWhB14DDuecWMPLROSZcgiLNwS1bSx5yky1ESQ@mail.gmail.com>
References: <CAJvo+19FZ7YSsWhB14DDuecWMPLROSZcgiLNwS1bSx5yky1ESQ@mail.gmail.com>
Message-ID: <201410062020.15253.even.rouault@spatialys.com>

Le lundi 06 octobre 2014 19:41:43, Stefan Ziegler a ?crit :
> Hi
> 
> When trying to use SQLite dialect with GeoPackage I get some errors, like:
> 
> stefan at hatschepsut:~/Downloads$ ogrinfo -al -sql 'SELECT
> ST_X(ST_SnapToGrid(geom,1)) FROM bodenbedeckung__bbtext LIMIT 1'
> 2601.gpkgINFO: Open of `2601.gpkg'
>       using driver `GPKG' successful.
> ERROR 1: In ExecuteSQL(): sqlite3_prepare(SELECT
> ST_X(ST_SnapToGrid(geom,1)) FROM bodenbedeckung__bbtext LIMIT 1):
>   no such function: ST_SnapToGrid
> 
> 
> The same query works with Shapefiles. I thought the SQLite dialect can be
> used with any OGR datasource?

Stefan,

You need a very recent Spatialite (4.2 I think) for compatibility with 
GeoPackage. But your request would not work since Spatialite functions can 
only work with Spatialite geometry blobs and not Geopackage geometry blobs. 
Spatialite 4.2 provide explicit conversion methods AsGPB / GeomFromGPB. 

For example :

$ ogrinfo poly.gpkg -sql "select AsGPB(ST_SnapToGrid(GeomFromGPB(geom),1)) 
from poly"

I've also just added in trunk a "INDIRECT_SQLITE" dialect that will cause the 
generic solution used for shapefiles for example to be usable by GeoPackage 
datasources too. But this will be slower than direct SQL due to an extra 
translation layer done by OGR ( GPKG -> OGR feature -> SQLite/Spatialite 
virtual table -> OGR feature ).

$ ogrinfo poly.gpkg -sql "select ST_SnapToGrid(geom,1) from poly" -dialect 
INDIRECT_SQLITE

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From stefan.ziegler.de at gmail.com  Mon Oct  6 11:48:02 2014
From: stefan.ziegler.de at gmail.com (Stefan Ziegler)
Date: Mon, 6 Oct 2014 20:48:02 +0200
Subject: [gdal-dev] SQLite dialect with GeoPackage
In-Reply-To: <201410062020.15253.even.rouault@spatialys.com>
References: <CAJvo+19FZ7YSsWhB14DDuecWMPLROSZcgiLNwS1bSx5yky1ESQ@mail.gmail.com>
	<201410062020.15253.even.rouault@spatialys.com>
Message-ID: <CAJvo+18WeJsWXH5ipANoW0p7NbEuyQbJxMR9VwT+MTbXn=x7jA@mail.gmail.com>

Hi Even

thanks! INDIRECT_SQLITE works like a charm. I could not figure out the
syntax to create a new layer in the very same gpkg file:

stefan at hatschepsut:~/Downloads$ ogr2ogr -append -f GPKG 2601.gpkg -nln
my_new_layer -dialect INDIRECT_SQLITE -sql 'SELECT * FROM
bodenbedeckung__bbtext WHERE tid IN (SELECT tid FROM bodenbedeckung__bbtext
GROUP BY ST_X(ST_SnapToGrid(geom, 500)), ST_Y(ST_SnapToGrid(geom, 500)),
nummer_name ORDER BY ST_X(ST_SnapToGrid(geom,500)),
ST_Y(ST_SnapToGrid(geom, 500)), ST_Distance(geom, ST_SnapToGrid(geom,
500)))' 2601.gpkg
ERROR 1: sqlite3_exec(CREATE TABLE "my_new_layer" ( "fid" INTEGER PRIMARY
KEY AUTOINCREMENT, "geom" POINT )) failed: database is locked
ERROR 1: Terminating translation prematurely after failed
translation from sql statement.

Is this even possible?

regards
Stefan


On Mon, Oct 6, 2014 at 8:20 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le lundi 06 octobre 2014 19:41:43, Stefan Ziegler a ?crit :
> > Hi
> >
> > When trying to use SQLite dialect with GeoPackage I get some errors,
> like:
> >
> > stefan at hatschepsut:~/Downloads$ ogrinfo -al -sql 'SELECT
> > ST_X(ST_SnapToGrid(geom,1)) FROM bodenbedeckung__bbtext LIMIT 1'
> > 2601.gpkgINFO: Open of `2601.gpkg'
> >       using driver `GPKG' successful.
> > ERROR 1: In ExecuteSQL(): sqlite3_prepare(SELECT
> > ST_X(ST_SnapToGrid(geom,1)) FROM bodenbedeckung__bbtext LIMIT 1):
> >   no such function: ST_SnapToGrid
> >
> >
> > The same query works with Shapefiles. I thought the SQLite dialect can be
> > used with any OGR datasource?
>
> Stefan,
>
> You need a very recent Spatialite (4.2 I think) for compatibility with
> GeoPackage. But your request would not work since Spatialite functions can
> only work with Spatialite geometry blobs and not Geopackage geometry blobs.
> Spatialite 4.2 provide explicit conversion methods AsGPB / GeomFromGPB.
>
> For example :
>
> $ ogrinfo poly.gpkg -sql "select AsGPB(ST_SnapToGrid(GeomFromGPB(geom),1))
> from poly"
>
> I've also just added in trunk a "INDIRECT_SQLITE" dialect that will cause
> the
> generic solution used for shapefiles for example to be usable by GeoPackage
> datasources too. But this will be slower than direct SQL due to an extra
> translation layer done by OGR ( GPKG -> OGR feature -> SQLite/Spatialite
> virtual table -> OGR feature ).
>
> $ ogrinfo poly.gpkg -sql "select ST_SnapToGrid(geom,1) from poly" -dialect
> INDIRECT_SQLITE
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141006/f7d9e643/attachment-0001.html>

From even.rouault at spatialys.com  Mon Oct  6 11:55:45 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 6 Oct 2014 20:55:45 +0200
Subject: [gdal-dev] SQLite dialect with GeoPackage
In-Reply-To: <CAJvo+18WeJsWXH5ipANoW0p7NbEuyQbJxMR9VwT+MTbXn=x7jA@mail.gmail.com>
References: <CAJvo+19FZ7YSsWhB14DDuecWMPLROSZcgiLNwS1bSx5yky1ESQ@mail.gmail.com>
	<201410062020.15253.even.rouault@spatialys.com>
	<CAJvo+18WeJsWXH5ipANoW0p7NbEuyQbJxMR9VwT+MTbXn=x7jA@mail.gmail.com>
Message-ID: <201410062055.45784.even.rouault@spatialys.com>

Le lundi 06 octobre 2014 20:48:02, Stefan Ziegler a ?crit :
> Hi Even
> 
> thanks! INDIRECT_SQLITE works like a charm. I could not figure out the
> syntax to create a new layer in the very same gpkg file:
> 
> stefan at hatschepsut:~/Downloads$ ogr2ogr -append -f GPKG 2601.gpkg -nln
> my_new_layer -dialect INDIRECT_SQLITE -sql 'SELECT * FROM
> bodenbedeckung__bbtext WHERE tid IN (SELECT tid FROM bodenbedeckung__bbtext
> GROUP BY ST_X(ST_SnapToGrid(geom, 500)), ST_Y(ST_SnapToGrid(geom, 500)),
> nummer_name ORDER BY ST_X(ST_SnapToGrid(geom,500)),
> ST_Y(ST_SnapToGrid(geom, 500)), ST_Distance(geom, ST_SnapToGrid(geom,
> 500)))' 2601.gpkg
> ERROR 1: sqlite3_exec(CREATE TABLE "my_new_layer" ( "fid" INTEGER PRIMARY
> KEY AUTOINCREMENT, "geom" POINT )) failed: database is locked
> ERROR 1: Terminating translation prematurely after failed
> translation from sql statement.
> 
> Is this even possible?

Ah, good point. I've just added a particular case in ogr2ogr, like done for 
sqlite, when input dataset = output dataset, to open the database just once to 
avoid that locking issue.

> 
> regards
> Stefan
> 
> 
> On Mon, Oct 6, 2014 at 8:20 PM, Even Rouault <even.rouault at spatialys.com>
> 
> wrote:
> > Le lundi 06 octobre 2014 19:41:43, Stefan Ziegler a ?crit :
> > > Hi
> > > 
> > > When trying to use SQLite dialect with GeoPackage I get some errors,
> > 
> > like:
> > > stefan at hatschepsut:~/Downloads$ ogrinfo -al -sql 'SELECT
> > > ST_X(ST_SnapToGrid(geom,1)) FROM bodenbedeckung__bbtext LIMIT 1'
> > > 2601.gpkgINFO: Open of `2601.gpkg'
> > > 
> > >       using driver `GPKG' successful.
> > > 
> > > ERROR 1: In ExecuteSQL(): sqlite3_prepare(SELECT
> > > 
> > > ST_X(ST_SnapToGrid(geom,1)) FROM bodenbedeckung__bbtext LIMIT 1):
> > >   no such function: ST_SnapToGrid
> > > 
> > > The same query works with Shapefiles. I thought the SQLite dialect can
> > > be used with any OGR datasource?
> > 
> > Stefan,
> > 
> > You need a very recent Spatialite (4.2 I think) for compatibility with
> > GeoPackage. But your request would not work since Spatialite functions
> > can only work with Spatialite geometry blobs and not Geopackage geometry
> > blobs. Spatialite 4.2 provide explicit conversion methods AsGPB /
> > GeomFromGPB.
> > 
> > For example :
> > 
> > $ ogrinfo poly.gpkg -sql "select
> > AsGPB(ST_SnapToGrid(GeomFromGPB(geom),1)) from poly"
> > 
> > I've also just added in trunk a "INDIRECT_SQLITE" dialect that will cause
> > the
> > generic solution used for shapefiles for example to be usable by
> > GeoPackage datasources too. But this will be slower than direct SQL due
> > to an extra translation layer done by OGR ( GPKG -> OGR feature ->
> > SQLite/Spatialite virtual table -> OGR feature ).
> > 
> > $ ogrinfo poly.gpkg -sql "select ST_SnapToGrid(geom,1) from poly"
> > -dialect INDIRECT_SQLITE
> > 
> > Even
> > 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From stefan.ziegler.de at gmail.com  Mon Oct  6 12:01:59 2014
From: stefan.ziegler.de at gmail.com (Stefan Ziegler)
Date: Mon, 6 Oct 2014 21:01:59 +0200
Subject: [gdal-dev] SQLite dialect with GeoPackage
In-Reply-To: <201410062055.45784.even.rouault@spatialys.com>
References: <CAJvo+19FZ7YSsWhB14DDuecWMPLROSZcgiLNwS1bSx5yky1ESQ@mail.gmail.com>
	<201410062020.15253.even.rouault@spatialys.com>
	<CAJvo+18WeJsWXH5ipANoW0p7NbEuyQbJxMR9VwT+MTbXn=x7jA@mail.gmail.com>
	<201410062055.45784.even.rouault@spatialys.com>
Message-ID: <CAJvo+18fd8rEsHyX=zwNJ+cExLXevMocdtaSuxdSXKYBH9GSiw@mail.gmail.com>

This is awesome! Thanks Even.

Stefan

On Mon, Oct 6, 2014 at 8:55 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le lundi 06 octobre 2014 20:48:02, Stefan Ziegler a ?crit :
> > Hi Even
> >
> > thanks! INDIRECT_SQLITE works like a charm. I could not figure out the
> > syntax to create a new layer in the very same gpkg file:
> >
> > stefan at hatschepsut:~/Downloads$ ogr2ogr -append -f GPKG 2601.gpkg -nln
> > my_new_layer -dialect INDIRECT_SQLITE -sql 'SELECT * FROM
> > bodenbedeckung__bbtext WHERE tid IN (SELECT tid FROM
> bodenbedeckung__bbtext
> > GROUP BY ST_X(ST_SnapToGrid(geom, 500)), ST_Y(ST_SnapToGrid(geom, 500)),
> > nummer_name ORDER BY ST_X(ST_SnapToGrid(geom,500)),
> > ST_Y(ST_SnapToGrid(geom, 500)), ST_Distance(geom, ST_SnapToGrid(geom,
> > 500)))' 2601.gpkg
> > ERROR 1: sqlite3_exec(CREATE TABLE "my_new_layer" ( "fid" INTEGER PRIMARY
> > KEY AUTOINCREMENT, "geom" POINT )) failed: database is locked
> > ERROR 1: Terminating translation prematurely after failed
> > translation from sql statement.
> >
> > Is this even possible?
>
> Ah, good point. I've just added a particular case in ogr2ogr, like done for
> sqlite, when input dataset = output dataset, to open the database just
> once to
> avoid that locking issue.
>
> >
> > regards
> > Stefan
> >
> >
> > On Mon, Oct 6, 2014 at 8:20 PM, Even Rouault <even.rouault at spatialys.com
> >
> >
> > wrote:
> > > Le lundi 06 octobre 2014 19:41:43, Stefan Ziegler a ?crit :
> > > > Hi
> > > >
> > > > When trying to use SQLite dialect with GeoPackage I get some errors,
> > >
> > > like:
> > > > stefan at hatschepsut:~/Downloads$ ogrinfo -al -sql 'SELECT
> > > > ST_X(ST_SnapToGrid(geom,1)) FROM bodenbedeckung__bbtext LIMIT 1'
> > > > 2601.gpkgINFO: Open of `2601.gpkg'
> > > >
> > > >       using driver `GPKG' successful.
> > > >
> > > > ERROR 1: In ExecuteSQL(): sqlite3_prepare(SELECT
> > > >
> > > > ST_X(ST_SnapToGrid(geom,1)) FROM bodenbedeckung__bbtext LIMIT 1):
> > > >   no such function: ST_SnapToGrid
> > > >
> > > > The same query works with Shapefiles. I thought the SQLite dialect
> can
> > > > be used with any OGR datasource?
> > >
> > > Stefan,
> > >
> > > You need a very recent Spatialite (4.2 I think) for compatibility with
> > > GeoPackage. But your request would not work since Spatialite functions
> > > can only work with Spatialite geometry blobs and not Geopackage
> geometry
> > > blobs. Spatialite 4.2 provide explicit conversion methods AsGPB /
> > > GeomFromGPB.
> > >
> > > For example :
> > >
> > > $ ogrinfo poly.gpkg -sql "select
> > > AsGPB(ST_SnapToGrid(GeomFromGPB(geom),1)) from poly"
> > >
> > > I've also just added in trunk a "INDIRECT_SQLITE" dialect that will
> cause
> > > the
> > > generic solution used for shapefiles for example to be usable by
> > > GeoPackage datasources too. But this will be slower than direct SQL due
> > > to an extra translation layer done by OGR ( GPKG -> OGR feature ->
> > > SQLite/Spatialite virtual table -> OGR feature ).
> > >
> > > $ ogrinfo poly.gpkg -sql "select ST_SnapToGrid(geom,1) from poly"
> > > -dialect INDIRECT_SQLITE
> > >
> > > Even
> > >
> > > --
> > > Spatialys - Geospatial professional services
> > > http://www.spatialys.com
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141006/055d1617/attachment.html>

From stefan.ziegler.de at gmail.com  Mon Oct  6 12:13:04 2014
From: stefan.ziegler.de at gmail.com (Stefan Ziegler)
Date: Mon, 6 Oct 2014 21:13:04 +0200
Subject: [gdal-dev] SQLite dialect with GeoPackage
In-Reply-To: <CAJvo+18fd8rEsHyX=zwNJ+cExLXevMocdtaSuxdSXKYBH9GSiw@mail.gmail.com>
References: <CAJvo+19FZ7YSsWhB14DDuecWMPLROSZcgiLNwS1bSx5yky1ESQ@mail.gmail.com>
	<201410062020.15253.even.rouault@spatialys.com>
	<CAJvo+18WeJsWXH5ipANoW0p7NbEuyQbJxMR9VwT+MTbXn=x7jA@mail.gmail.com>
	<201410062055.45784.even.rouault@spatialys.com>
	<CAJvo+18fd8rEsHyX=zwNJ+cExLXevMocdtaSuxdSXKYBH9GSiw@mail.gmail.com>
Message-ID: <CAJvo+19KFWXR94jtV1zyYhwoeuUw9NEkZkD8_q3=-nShrz-_hQ@mail.gmail.com>

Ah, still one - hopefully last - question: how can I overwrite a layer in
the gpkg?

stefan at hatschepsut:~/Downloads$ ogr2ogr -append  -f GPKG 2601.gpkg -nln
my_new_layer -lco OVERWRITE=YES -dialect INDIRECT_SQLITE -sql 'SELECT *
FROM  bodenbedeckung__bbtext WHERE tid IN (SELECT tid FROM
bodenbedeckung__bbtext GROUP BY ST_X(ST_SnapToGrid(geom, 500)),
ST_Y(ST_SnapToGrid(geom, 500)), nummer_name ORDER BY
ST_X(ST_SnapToGrid(geom,500)), ST_Y(ST_SnapToGrid(geom, 500)),
ST_Distance(geom, ST_SnapToGrid(geom, 500)))' 2601.gpkg
WARNING: Layer creation options ignored since an existing layer is
         being appended to.

-append is needed since the layer should be added to an existing file
-co OVERWRITE=YES is unknown: "FAILURE: Unknown option name '-co'"
-lco OVERWRITE=YES is ignored.

Stefan




On Mon, Oct 6, 2014 at 9:01 PM, Stefan Ziegler <stefan.ziegler.de at gmail.com>
wrote:

> This is awesome! Thanks Even.
>
> Stefan
>
> On Mon, Oct 6, 2014 at 8:55 PM, Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> Le lundi 06 octobre 2014 20:48:02, Stefan Ziegler a ?crit :
>> > Hi Even
>> >
>> > thanks! INDIRECT_SQLITE works like a charm. I could not figure out the
>> > syntax to create a new layer in the very same gpkg file:
>> >
>> > stefan at hatschepsut:~/Downloads$ ogr2ogr -append -f GPKG 2601.gpkg -nln
>> > my_new_layer -dialect INDIRECT_SQLITE -sql 'SELECT * FROM
>> > bodenbedeckung__bbtext WHERE tid IN (SELECT tid FROM
>> bodenbedeckung__bbtext
>> > GROUP BY ST_X(ST_SnapToGrid(geom, 500)), ST_Y(ST_SnapToGrid(geom, 500)),
>> > nummer_name ORDER BY ST_X(ST_SnapToGrid(geom,500)),
>> > ST_Y(ST_SnapToGrid(geom, 500)), ST_Distance(geom, ST_SnapToGrid(geom,
>> > 500)))' 2601.gpkg
>> > ERROR 1: sqlite3_exec(CREATE TABLE "my_new_layer" ( "fid" INTEGER
>> PRIMARY
>> > KEY AUTOINCREMENT, "geom" POINT )) failed: database is locked
>> > ERROR 1: Terminating translation prematurely after failed
>> > translation from sql statement.
>> >
>> > Is this even possible?
>>
>> Ah, good point. I've just added a particular case in ogr2ogr, like done
>> for
>> sqlite, when input dataset = output dataset, to open the database just
>> once to
>> avoid that locking issue.
>>
>> >
>> > regards
>> > Stefan
>> >
>> >
>> > On Mon, Oct 6, 2014 at 8:20 PM, Even Rouault <
>> even.rouault at spatialys.com>
>> >
>> > wrote:
>> > > Le lundi 06 octobre 2014 19:41:43, Stefan Ziegler a ?crit :
>> > > > Hi
>> > > >
>> > > > When trying to use SQLite dialect with GeoPackage I get some errors,
>> > >
>> > > like:
>> > > > stefan at hatschepsut:~/Downloads$ ogrinfo -al -sql 'SELECT
>> > > > ST_X(ST_SnapToGrid(geom,1)) FROM bodenbedeckung__bbtext LIMIT 1'
>> > > > 2601.gpkgINFO: Open of `2601.gpkg'
>> > > >
>> > > >       using driver `GPKG' successful.
>> > > >
>> > > > ERROR 1: In ExecuteSQL(): sqlite3_prepare(SELECT
>> > > >
>> > > > ST_X(ST_SnapToGrid(geom,1)) FROM bodenbedeckung__bbtext LIMIT 1):
>> > > >   no such function: ST_SnapToGrid
>> > > >
>> > > > The same query works with Shapefiles. I thought the SQLite dialect
>> can
>> > > > be used with any OGR datasource?
>> > >
>> > > Stefan,
>> > >
>> > > You need a very recent Spatialite (4.2 I think) for compatibility with
>> > > GeoPackage. But your request would not work since Spatialite functions
>> > > can only work with Spatialite geometry blobs and not Geopackage
>> geometry
>> > > blobs. Spatialite 4.2 provide explicit conversion methods AsGPB /
>> > > GeomFromGPB.
>> > >
>> > > For example :
>> > >
>> > > $ ogrinfo poly.gpkg -sql "select
>> > > AsGPB(ST_SnapToGrid(GeomFromGPB(geom),1)) from poly"
>> > >
>> > > I've also just added in trunk a "INDIRECT_SQLITE" dialect that will
>> cause
>> > > the
>> > > generic solution used for shapefiles for example to be usable by
>> > > GeoPackage datasources too. But this will be slower than direct SQL
>> due
>> > > to an extra translation layer done by OGR ( GPKG -> OGR feature ->
>> > > SQLite/Spatialite virtual table -> OGR feature ).
>> > >
>> > > $ ogrinfo poly.gpkg -sql "select ST_SnapToGrid(geom,1) from poly"
>> > > -dialect INDIRECT_SQLITE
>> > >
>> > > Even
>> > >
>> > > --
>> > > Spatialys - Geospatial professional services
>> > > http://www.spatialys.com
>>
>> --
>> Spatialys - Geospatial professional services
>> http://www.spatialys.com
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141006/95f8a1df/attachment.html>

From daniel.teske at web.de  Mon Oct  6 12:32:10 2014
From: daniel.teske at web.de (teeschke)
Date: Mon, 6 Oct 2014 12:32:10 -0700 (PDT)
Subject: [gdal-dev] handle GRIB files in polar stereographic projection
Message-ID: <1412623930082-5166227.post@n6.nabble.com>

Dear list,

I am having trouble to handle grib files, that are polar stereographic
projected. My goal is to reproject the grib into WGS84, but gdalinfo and
gdalwrap cannot find any data iside the grib. 

$ gdalinfo south_hemisphere.grb 
Warning: Inside GRIB2Inventory, Message # 2
ERROR: Ran out of file reading SECT0
There were 94 trailing bytes in the file.
ERROR 4: south_hemisphere.grb is a grib file, but no raster dataset was
successfully identified.
gdalinfo failed - unable to open 'south_hemisphere.grb'.


Analyzing the file with wgrib brings the following result

$ wgrib -V south_hemisphere.grb 
rec 1:0:date 2014092012 ICEC kpds5=91 kpds6=1 kpds7=0 levels=(0,0) grid=5
sfc anl: bitmap: 0 undef
  ICEC=Ice (ice=1;no ice=0) [fraction]
  timerange 0 P1 0 P2 0 TimeU 1  nx 790 ny 830 GDS grid 5 num_in_ave 0
missing 0
  center 88 subcenter 0 process 1 Table 1 scan: WE:SN winds(N/S) 
  polar stereo: Lat1 -41.501000 Long1 -135.000000 Orient 0.000000
     north pole (790 x 830) Dx 10000 Dy 10000 scan 64 mode 0
  min/max data -199 100  num bits 16  BDS_Ref -199  DecScale 0 BinScale -7

With wgrib and the netcdf-tools* I can display the metadata. Panoply** can
also display the grib file in variouse projections

Is GDAL made for working with polar stereographic projected gribs? Do you
have any idea how I can reproject the grib file?

Thanks you so much and best regards,
Daniel

*
http://www.unidata.ucar.edu/software/thredds/current/netcdf-java/documentation.htm
** http://www.giss.nasa.gov/tools/panoply/



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/handle-GRIB-files-in-polar-stereographic-projection-tp5166227.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Mon Oct  6 12:43:02 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 6 Oct 2014 21:43:02 +0200
Subject: [gdal-dev] SQLite dialect with GeoPackage
In-Reply-To: <CAJvo+19KFWXR94jtV1zyYhwoeuUw9NEkZkD8_q3=-nShrz-_hQ@mail.gmail.com>
References: <CAJvo+19FZ7YSsWhB14DDuecWMPLROSZcgiLNwS1bSx5yky1ESQ@mail.gmail.com>
	<CAJvo+18fd8rEsHyX=zwNJ+cExLXevMocdtaSuxdSXKYBH9GSiw@mail.gmail.com>
	<CAJvo+19KFWXR94jtV1zyYhwoeuUw9NEkZkD8_q3=-nShrz-_hQ@mail.gmail.com>
Message-ID: <201410062143.02887.even.rouault@spatialys.com>

Le lundi 06 octobre 2014 21:13:04, Stefan Ziegler a ?crit :
> Ah, still one - hopefully last - question: how can I overwrite a layer in
> the gpkg?
> 
> stefan at hatschepsut:~/Downloads$ ogr2ogr -append  -f GPKG 2601.gpkg -nln
> my_new_layer -lco OVERWRITE=YES -dialect INDIRECT_SQLITE -sql 'SELECT *
> FROM  bodenbedeckung__bbtext WHERE tid IN (SELECT tid FROM
> bodenbedeckung__bbtext GROUP BY ST_X(ST_SnapToGrid(geom, 500)),
> ST_Y(ST_SnapToGrid(geom, 500)), nummer_name ORDER BY
> ST_X(ST_SnapToGrid(geom,500)), ST_Y(ST_SnapToGrid(geom, 500)),
> ST_Distance(geom, ST_SnapToGrid(geom, 500)))' 2601.gpkg
> WARNING: Layer creation options ignored since an existing layer is
>          being appended to.
> 
> -append is needed since the layer should be added to an existing file
> -co OVERWRITE=YES is unknown: "FAILURE: Unknown option name '-co'"
> -lco OVERWRITE=YES is ignored.

Hum, using the same name as input and output dataset causes a lot of 
interesting issues. I've fixed the above issue.

Works if you use the -overwrite flag ( -lco OVERWRITE=YES will not work in that 
context )

ogr2ogr -overwrite poly.gpkg poly.gpkg -sql "select * from poly" -nln poly3

If you had the errors above, you may need to clean manually the database 
before, so as to put it back into a consistant state :

ogrinfo 2601.gpkg  -sql "drop table my_new_layer"
ogrinfo 2601.gpkg  -sql "drop table rtree_my_new_layer_geom"

> 
> Stefan
> 
> 
> 
> 
> On Mon, Oct 6, 2014 at 9:01 PM, Stefan Ziegler
> <stefan.ziegler.de at gmail.com>
> 
> wrote:
> > This is awesome! Thanks Even.
> > 
> > Stefan
> > 
> > On Mon, Oct 6, 2014 at 8:55 PM, Even Rouault <even.rouault at spatialys.com>
> > 
> > wrote:
> >> Le lundi 06 octobre 2014 20:48:02, Stefan Ziegler a ?crit :
> >> > Hi Even
> >> > 
> >> > thanks! INDIRECT_SQLITE works like a charm. I could not figure out the
> >> > syntax to create a new layer in the very same gpkg file:
> >> > 
> >> > stefan at hatschepsut:~/Downloads$ ogr2ogr -append -f GPKG 2601.gpkg -nln
> >> > my_new_layer -dialect INDIRECT_SQLITE -sql 'SELECT * FROM
> >> > bodenbedeckung__bbtext WHERE tid IN (SELECT tid FROM
> >> 
> >> bodenbedeckung__bbtext
> >> 
> >> > GROUP BY ST_X(ST_SnapToGrid(geom, 500)), ST_Y(ST_SnapToGrid(geom,
> >> > 500)), nummer_name ORDER BY ST_X(ST_SnapToGrid(geom,500)),
> >> > ST_Y(ST_SnapToGrid(geom, 500)), ST_Distance(geom, ST_SnapToGrid(geom,
> >> > 500)))' 2601.gpkg
> >> > ERROR 1: sqlite3_exec(CREATE TABLE "my_new_layer" ( "fid" INTEGER
> >> 
> >> PRIMARY
> >> 
> >> > KEY AUTOINCREMENT, "geom" POINT )) failed: database is locked
> >> > ERROR 1: Terminating translation prematurely after failed
> >> > translation from sql statement.
> >> > 
> >> > Is this even possible?
> >> 
> >> Ah, good point. I've just added a particular case in ogr2ogr, like done
> >> for
> >> sqlite, when input dataset = output dataset, to open the database just
> >> once to
> >> avoid that locking issue.
> >> 
> >> > regards
> >> > Stefan
> >> > 
> >> > 
> >> > On Mon, Oct 6, 2014 at 8:20 PM, Even Rouault <
> >> 
> >> even.rouault at spatialys.com>
> >> 
> >> > wrote:
> >> > > Le lundi 06 octobre 2014 19:41:43, Stefan Ziegler a ?crit :
> >> > > > Hi
> >> > > > 
> >> > > > When trying to use SQLite dialect with GeoPackage I get some
> >> > > > errors,
> >> > > 
> >> > > like:
> >> > > > stefan at hatschepsut:~/Downloads$ ogrinfo -al -sql 'SELECT
> >> > > > ST_X(ST_SnapToGrid(geom,1)) FROM bodenbedeckung__bbtext LIMIT 1'
> >> > > > 2601.gpkgINFO: Open of `2601.gpkg'
> >> > > > 
> >> > > >       using driver `GPKG' successful.
> >> > > > 
> >> > > > ERROR 1: In ExecuteSQL(): sqlite3_prepare(SELECT
> >> > > > 
> >> > > > ST_X(ST_SnapToGrid(geom,1)) FROM bodenbedeckung__bbtext LIMIT 1):
> >> > > >   no such function: ST_SnapToGrid
> >> > > > 
> >> > > > The same query works with Shapefiles. I thought the SQLite dialect
> >> 
> >> can
> >> 
> >> > > > be used with any OGR datasource?
> >> > > 
> >> > > Stefan,
> >> > > 
> >> > > You need a very recent Spatialite (4.2 I think) for compatibility
> >> > > with GeoPackage. But your request would not work since Spatialite
> >> > > functions can only work with Spatialite geometry blobs and not
> >> > > Geopackage
> >> 
> >> geometry
> >> 
> >> > > blobs. Spatialite 4.2 provide explicit conversion methods AsGPB /
> >> > > GeomFromGPB.
> >> > > 
> >> > > For example :
> >> > > 
> >> > > $ ogrinfo poly.gpkg -sql "select
> >> > > AsGPB(ST_SnapToGrid(GeomFromGPB(geom),1)) from poly"
> >> > > 
> >> > > I've also just added in trunk a "INDIRECT_SQLITE" dialect that will
> >> 
> >> cause
> >> 
> >> > > the
> >> > > generic solution used for shapefiles for example to be usable by
> >> > > GeoPackage datasources too. But this will be slower than direct SQL
> >> 
> >> due
> >> 
> >> > > to an extra translation layer done by OGR ( GPKG -> OGR feature ->
> >> > > SQLite/Spatialite virtual table -> OGR feature ).
> >> > > 
> >> > > $ ogrinfo poly.gpkg -sql "select ST_SnapToGrid(geom,1) from poly"
> >> > > -dialect INDIRECT_SQLITE
> >> > > 
> >> > > Even
> >> > > 
> >> > > --
> >> > > Spatialys - Geospatial professional services
> >> > > http://www.spatialys.com
> >> 
> >> --
> >> Spatialys - Geospatial professional services
> >> http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From kyle at pobox.com  Mon Oct  6 15:35:50 2014
From: kyle at pobox.com (Kyle Shannon)
Date: Mon, 6 Oct 2014 16:35:50 -0600
Subject: [gdal-dev] handle GRIB files in polar stereographic projection
In-Reply-To: <1412623930082-5166227.post@n6.nabble.com>
References: <1412623930082-5166227.post@n6.nabble.com>
Message-ID: <CAJ0mEz04Uz7ZZXvYrff10CPSJApjS5bG54oiFfKmXSNE+48bAA@mail.gmail.com>

Daniel,
Can you report your GDAL version, and perhaps a sample dataset?

On Mon, Oct 6, 2014 at 1:32 PM, teeschke <daniel.teske at web.de> wrote:
> Dear list,
>
> I am having trouble to handle grib files, that are polar stereographic
> projected. My goal is to reproject the grib into WGS84, but gdalinfo and
> gdalwrap cannot find any data iside the grib.
>
> $ gdalinfo south_hemisphere.grb
> Warning: Inside GRIB2Inventory, Message # 2
> ERROR: Ran out of file reading SECT0
> There were 94 trailing bytes in the file.
> ERROR 4: south_hemisphere.grb is a grib file, but no raster dataset was
> successfully identified.
> gdalinfo failed - unable to open 'south_hemisphere.grb'.
>
>
> Analyzing the file with wgrib brings the following result
>
> $ wgrib -V south_hemisphere.grb
> rec 1:0:date 2014092012 ICEC kpds5=91 kpds6=1 kpds7=0 levels=(0,0) grid=5
> sfc anl: bitmap: 0 undef
>   ICEC=Ice (ice=1;no ice=0) [fraction]
>   timerange 0 P1 0 P2 0 TimeU 1  nx 790 ny 830 GDS grid 5 num_in_ave 0
> missing 0
>   center 88 subcenter 0 process 1 Table 1 scan: WE:SN winds(N/S)
>   polar stereo: Lat1 -41.501000 Long1 -135.000000 Orient 0.000000
>      north pole (790 x 830) Dx 10000 Dy 10000 scan 64 mode 0
>   min/max data -199 100  num bits 16  BDS_Ref -199  DecScale 0 BinScale -7
>
> With wgrib and the netcdf-tools* I can display the metadata. Panoply** can
> also display the grib file in variouse projections
>
> Is GDAL made for working with polar stereographic projected gribs? Do you
> have any idea how I can reproject the grib file?
>
> Thanks you so much and best regards,
> Daniel
>
> *
> http://www.unidata.ucar.edu/software/thredds/current/netcdf-java/documentation.htm
> ** http://www.giss.nasa.gov/tools/panoply/
>
>
>
> --
> View this message in context: http://osgeo-org.1560.x6.nabble.com/handle-GRIB-files-in-polar-stereographic-projection-tp5166227.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Kyle

From Martin.Lewis at euro.ngc.com  Tue Oct  7 00:45:50 2014
From: Martin.Lewis at euro.ngc.com (M Lewis)
Date: Tue, 7 Oct 2014 00:45:50 -0700 (PDT)
Subject: [gdal-dev] NITF YCbCr To RGB?
In-Reply-To: <201410061739.53656.even.rouault@spatialys.com>
References: <1412607771762-5166169.post@n6.nabble.com>
	<201410061739.53656.even.rouault@spatialys.com>
Message-ID: <1412667950114-5166257.post@n6.nabble.com>

Thanks Even

So to be clear I am quite safe in assuming that Band 1 is R, Band 2 is G etc
as the conversion has been done?


Thanks

Martin



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/NITF-YCbCr-To-RGB-tp5166169p5166257.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From daniel.teske at web.de  Tue Oct  7 01:27:49 2014
From: daniel.teske at web.de (teeschke)
Date: Tue, 7 Oct 2014 01:27:49 -0700 (PDT)
Subject: [gdal-dev] handle GRIB files in polar stereographic projection
In-Reply-To: <1412623930082-5166227.post@n6.nabble.com>
References: <1412623930082-5166227.post@n6.nabble.com>
Message-ID: <1412670469448-5166269.post@n6.nabble.com>

I am using the GDAL version 1.11.0
I uploaded two grib files into my dropbox
https://www.dropbox.com/sh/0cywnha7vcg0y1h/AAD-JbG39tMkpOwJnDRlT7rYa?dl=0

Thanks and best regards,
teeschke



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/handle-GRIB-files-in-polar-stereographic-projection-tp5166227p5166269.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From landa.martin at gmail.com  Tue Oct  7 09:54:05 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Tue, 7 Oct 2014 18:54:05 +0200
Subject: [gdal-dev] compilation error in trunk
Message-ID: <CA+Ei1OdwZgrUm=7ANdMrAdcKtUxx+axtY=vA0RhKy=ok3VOs3w@mail.gmail.com>

Hi,

since today I am problem with compiling GDAL trunk.

make[1]: Entering directory '/opt/src/gdal/alg'
/bin/bash /home/martin/src/gdal/libtool --mode=compile --tag=CXX g++
-Wall  -g -DDEBUG  -Wall  -I/home/martin/src/gdal/port
-I/home/martin/src/gdal/gcore -I/home/martin/src/gdal/alg
-I/home/martin/src/gdal/ogr -I/home/martin/src/gdal/ogr/ogrsf_frmts
-DHAVE_GEOS=1 -I/usr/local/include -DOGR_ENABLED
-I/home/martin/src/gdal/port -I/usr/include  -DHAVE_OPENCL -c -o
gdalwarpkernel.lo gdalwarpkernel.cpp
libtool: compile:  g++ -Wall -g -DDEBUG -Wall
-I/home/martin/src/gdal/port -I/home/martin/src/gdal/gcore
-I/home/martin/src/gdal/alg -I/home/martin/src/gdal/ogr
-I/home/martin/src/gdal/ogr/ogrsf_frmts -DHAVE_GEOS=1
-I/usr/local/include -DOGR_ENABLED -I/home/martin/src/gdal/port
-I/usr/include -DHAVE_OPENCL -c gdalwarpkernel.cpp  -fPIC -DPIC -o
.libs/gdalwarpkernel.o
gdalwarpkernel.cpp: In function 'CPLErr GWKOpenCLCase(GDALWarpKernel*)':
gdalwarpkernel.cpp:3618:50: error: 'GDALWarpKernelOpenCLeleteEnv' was
not declared in this scope
     if((err = GDALWarpKernelOpenCLeleteEnv(warper)) != CL_SUCCESS)
                                                  ^
../GDALmake.opt:568: recipe for target 'gdalwarpkernel.lo' failed
make[1]: *** [gdalwarpkernel.lo] Error 1
make[1]: Leaving directory '/opt/src/gdal/alg'
GNUmakefile:57: recipe for target 'core-target' failed
make: *** [core-target] Error 2

Any idea what could be wrong? Thanks, Martin

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From savoie at nsidc.org  Tue Oct  7 10:22:18 2014
From: savoie at nsidc.org (savoie at nsidc.org)
Date: Tue, 07 Oct 2014 11:22:18 -0600
Subject: [gdal-dev] gdalwarp help/bug
Message-ID: <m11tqjre0l.fsf@savoie-laptop.ad.int.nsidc.org>


Hi all,

I'm not sure if I'm doing something wrong or if I've found a bug in gdalwarp.  I thought I'd ask here before putting in a trac ticket. Please let me know if this is the wrong procedure.

In any event, I have posted steps and links on gis.stackexchange that shows horizontal artifacts in the middle of images created during simple calls to gdal warp.


Stack exchange link: http://gis.stackexchange.com/questions/116465/gdalwarp-leaves-horizontal-artifacts-regridding-from-ease-grid-laea-to-polarst

Text of link follows:


Hi there,

I'm trying to understand how to use gdalwarp to warp an image.  I believe I'm doing the basics correctly, but I might be missing some gdalwarp options?  Any help would be greatly appreciate.

The basic problem is that I see horizontal artifiacts in my output image.

Here's the steps to reproduce.

Start with a simple 722x722 image.  http://imgur.com/UiMBqSd  (you can save with http://imgur.com/UiMBqSd.png)

apply metadata to make this a geotiff (this is a EASE-grid Lambert Azimuthal Equal Area projection on a 1924 authallic sphere.)


gdal_translate -a_srs '+proj=laea +lat_0=90 +lon_0=0 +x_0=0 +y_0=0 +a=6371228 +b=6371228 +units=m +no_defs' \
    -a_ullr -4524688.262500000 4524688.262500000 4524688.262500000 -4524688.262500000  \
    -co COMPRESS=DEFLATE -co PREDICTOR=2 -co ZLEVEL=9 \
    -of GTiff ./UiMbqSd.png ./UiMbqSd.withmetadata.tif


This seems to have the expected geographic information (~12.5km grid) confirmed with gdalinfo


gdalinfo UiMBqSd.withmetadata.tif


Driver: GTiff/GeoTIFF
Files: UiMbqSd.withmetadata.tif
Size is 722, 722
Coordinate System is:
PROJCS["unnamed",
    GEOGCS["unnamed ellipse",
        DATUM["unknown",
            SPHEROID["unnamed",6371228,0]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Lambert_Azimuthal_Equal_Area"],
    PARAMETER["latitude_of_center",90],
    PARAMETER["longitude_of_center",0],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]]]
Origin = (-4524688.262500000186265,4524688.262500000186265)
Pixel Size = (12533.762500000000728,-12533.762500000000728)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  COMPRESSION=DEFLATE
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (-4524688.263, 4524688.263) (135d 0' 0.00"W, 29d42'45.71"N)
Lower Left  (-4524688.263,-4524688.263) ( 45d 0' 0.00"W, 29d42'45.71"N)
Upper Right ( 4524688.263, 4524688.263) (135d 0' 0.00"E, 29d42'45.71"N)
Lower Right ( 4524688.263,-4524688.263) ( 45d 0' 0.00"E, 29d42'45.71"N)
Center      (   0.0000000,   0.0000000) (180d 0' 0.00"E, 90d 0' 0.00"N)
Band 1 Block=722x2 Type=Byte, ColorInterp=Red
  Mask Flags: PER_DATASET ALPHA
Band 2 Block=722x2 Type=Byte, ColorInterp=Green
  Mask Flags: PER_DATASET ALPHA
Band 3 Block=722x2 Type=Byte, ColorInterp=Blue
  Mask Flags: PER_DATASET ALPHA
Band 4 Block=722x2 Type=Byte, ColorInterp=Alpha


If I then try to regrid it.

gdalwarp -t_srs "+proj=stere +lat_0=90 +lon_0=-45 +lat_ts=70 +ellps=WGS84 +datum=WGS84 +units=m" ./UiMbqSd.withmetadata.tif ./regridded_lon0_-45.tif

The problem I'm seeing is horizontal artifacts that appear to protrude horizontally around the middle of the image.
You can see a png representation on imagur: http://imgur.com/Nrx4ZoS

This occurs even with different lat_0 values.
gdalwarp -t_srs "+proj=stere +lat_0=90 +lon_0=0 +lat_ts=70 +ellps=WGS84 +datum=WGS84 +units=m" ./UiMbqSd.withmetadata.tif ./regridded_lon0_0.tif

Another png representation on imagur:  http://imgur.com/uiiF9Ir


I'm currently running this on a mac:

> gdalwarp --version
GDAL 1.11.1, released 2014/09/24

But I've tested and seen the same behavior on ubuntu 12.04:
GDAL 1.10.1, released 2013/08/26

Any help solving this would be greatly appreciated.

Thanks
Matt





-- 
Matthew Savoie  -  Senior Software Developer
National Snow and Ice Data Center
(303) 735-0785   http://nsidc.org

From even.rouault at spatialys.com  Tue Oct  7 12:21:43 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 7 Oct 2014 21:21:43 +0200
Subject: [gdal-dev] compilation error in trunk
In-Reply-To: <CA+Ei1OdwZgrUm=7ANdMrAdcKtUxx+axtY=vA0RhKy=ok3VOs3w@mail.gmail.com>
References: <CA+Ei1OdwZgrUm=7ANdMrAdcKtUxx+axtY=vA0RhKy=ok3VOs3w@mail.gmail.com>
Message-ID: <201410072121.43444.even.rouault@spatialys.com>

Le mardi 07 octobre 2014 18:54:05, Martin Landa a ?crit :
> Hi,
> 
> since today I am problem with compiling GDAL trunk.
> 
> make[1]: Entering directory '/opt/src/gdal/alg'
> /bin/bash /home/martin/src/gdal/libtool --mode=compile --tag=CXX g++
> -Wall  -g -DDEBUG  -Wall  -I/home/martin/src/gdal/port
> -I/home/martin/src/gdal/gcore -I/home/martin/src/gdal/alg
> -I/home/martin/src/gdal/ogr -I/home/martin/src/gdal/ogr/ogrsf_frmts
> -DHAVE_GEOS=1 -I/usr/local/include -DOGR_ENABLED
> -I/home/martin/src/gdal/port -I/usr/include  -DHAVE_OPENCL -c -o
> gdalwarpkernel.lo gdalwarpkernel.cpp
> libtool: compile:  g++ -Wall -g -DDEBUG -Wall
> -I/home/martin/src/gdal/port -I/home/martin/src/gdal/gcore
> -I/home/martin/src/gdal/alg -I/home/martin/src/gdal/ogr
> -I/home/martin/src/gdal/ogr/ogrsf_frmts -DHAVE_GEOS=1
> -I/usr/local/include -DOGR_ENABLED -I/home/martin/src/gdal/port
> -I/usr/include -DHAVE_OPENCL -c gdalwarpkernel.cpp  -fPIC -DPIC -o
> .libs/gdalwarpkernel.o
> gdalwarpkernel.cpp: In function 'CPLErr GWKOpenCLCase(GDALWarpKernel*)':
> gdalwarpkernel.cpp:3618:50: error: 'GDALWarpKernelOpenCLeleteEnv' was
> not declared in this scope
>      if((err = GDALWarpKernelOpenCLeleteEnv(warper)) != CL_SUCCESS)
>                                                   ^
> ../GDALmake.opt:568: recipe for target 'gdalwarpkernel.lo' failed
> make[1]: *** [gdalwarpkernel.lo] Error 1
> make[1]: Leaving directory '/opt/src/gdal/alg'
> GNUmakefile:57: recipe for target 'core-target' failed
> make: *** [core-target] Error 2
> 
> Any idea what could be wrong? Thanks, Martin

oops, typo introduced accidently when editing that file yesterday, but as I 
didn't compile with opencl enabled, it didn't trigger. Should be now repaired.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From savoie at nsidc.org  Tue Oct  7 16:22:56 2014
From: savoie at nsidc.org (savoie at nsidc.org)
Date: Tue, 07 Oct 2014 17:22:56 -0600
Subject: [gdal-dev] gdalwarp help/bug
In-Reply-To: <m11tqjre0l.fsf@savoie-laptop.ad.int.nsidc.org>
	(savoie@nsidc.org's message of "Tue, 07 Oct 2014 11:22:18 -0600")
References: <m11tqjre0l.fsf@savoie-laptop.ad.int.nsidc.org>
Message-ID: <m161fvtqgf.fsf@savoie-laptop.ad.int.nsidc.org>


While I hate to do this, I'm going to answer my own question, or let you know that my question was answered by someone on gis.stackexchange.  This suggestion seems to have solved the problem.

Thanks
Matt


Try adding the -et (error threshold) option with lower thresholds than the default (0.125). When I use "-et 0.01", the horizontal artifacts disappear:

gdalwarp -t_srs "+proj=stere +lat_0=90 +lon_0=-45 +lat_ts=70 +ellps=WGS84 +datum=WGS84 +units=m" \
    -et 0.01 \
    ./UiMbqSd.withmetadata.tif ./regridded_lon0_-45.tif


savoie at nsidc.org writes:

> Hi all,
>
> I'm not sure if I'm doing something wrong or if I've found a bug in gdalwarp.  I thought I'd ask here before putting in a trac ticket. Please let me know if this is the wrong procedure.
>
> In any event, I have posted steps and links on gis.stackexchange that shows horizontal artifacts in the middle of images created during simple calls to gdal warp.
>
>
> Stack exchange link: http://gis.stackexchange.com/questions/116465/gdalwarp-leaves-horizontal-artifacts-regridding-from-ease-grid-laea-to-polarst
>
> Text of link follows:
>
>
> Hi there,
>
> I'm trying to understand how to use gdalwarp to warp an image.  I believe I'm doing the basics correctly, but I might be missing some gdalwarp options?  Any help would be greatly appreciate.
>
> The basic problem is that I see horizontal artifiacts in my output image.
>
> Here's the steps to reproduce.
>
> Start with a simple 722x722 image.  http://imgur.com/UiMBqSd  (you can save with http://imgur.com/UiMBqSd.png)
>
> apply metadata to make this a geotiff (this is a EASE-grid Lambert Azimuthal Equal Area projection on a 1924 authallic sphere.)
>
>
> gdal_translate -a_srs '+proj=laea +lat_0=90 +lon_0=0 +x_0=0 +y_0=0 +a=6371228 +b=6371228 +units=m +no_defs' \
>     -a_ullr -4524688.262500000 4524688.262500000 4524688.262500000 -4524688.262500000  \
>     -co COMPRESS=DEFLATE -co PREDICTOR=2 -co ZLEVEL=9 \
>     -of GTiff ./UiMbqSd.png ./UiMbqSd.withmetadata.tif
>
>
> This seems to have the expected geographic information (~12.5km grid) confirmed with gdalinfo
>
>
> gdalinfo UiMBqSd.withmetadata.tif
>
>
> Driver: GTiff/GeoTIFF
> Files: UiMbqSd.withmetadata.tif
> Size is 722, 722
> Coordinate System is:
> PROJCS["unnamed",
>     GEOGCS["unnamed ellipse",
>         DATUM["unknown",
>             SPHEROID["unnamed",6371228,0]],
>         PRIMEM["Greenwich",0],
>         UNIT["degree",0.0174532925199433]],
>     PROJECTION["Lambert_Azimuthal_Equal_Area"],
>     PARAMETER["latitude_of_center",90],
>     PARAMETER["longitude_of_center",0],
>     PARAMETER["false_easting",0],
>     PARAMETER["false_northing",0],
>     UNIT["metre",1,
>         AUTHORITY["EPSG","9001"]]]
> Origin = (-4524688.262500000186265,4524688.262500000186265)
> Pixel Size = (12533.762500000000728,-12533.762500000000728)
> Metadata:
>   AREA_OR_POINT=Area
> Image Structure Metadata:
>   COMPRESSION=DEFLATE
>   INTERLEAVE=PIXEL
> Corner Coordinates:
> Upper Left  (-4524688.263, 4524688.263) (135d 0' 0.00"W, 29d42'45.71"N)
> Lower Left  (-4524688.263,-4524688.263) ( 45d 0' 0.00"W, 29d42'45.71"N)
> Upper Right ( 4524688.263, 4524688.263) (135d 0' 0.00"E, 29d42'45.71"N)
> Lower Right ( 4524688.263,-4524688.263) ( 45d 0' 0.00"E, 29d42'45.71"N)
> Center      (   0.0000000,   0.0000000) (180d 0' 0.00"E, 90d 0' 0.00"N)
> Band 1 Block=722x2 Type=Byte, ColorInterp=Red
>   Mask Flags: PER_DATASET ALPHA
> Band 2 Block=722x2 Type=Byte, ColorInterp=Green
>   Mask Flags: PER_DATASET ALPHA
> Band 3 Block=722x2 Type=Byte, ColorInterp=Blue
>   Mask Flags: PER_DATASET ALPHA
> Band 4 Block=722x2 Type=Byte, ColorInterp=Alpha
>
>
> If I then try to regrid it.
>
> gdalwarp -t_srs "+proj=stere +lat_0=90 +lon_0=-45 +lat_ts=70 +ellps=WGS84 +datum=WGS84 +units=m" ./UiMbqSd.withmetadata.tif ./regridded_lon0_-45.tif
>
> The problem I'm seeing is horizontal artifacts that appear to protrude horizontally around the middle of the image.
> You can see a png representation on imagur: http://imgur.com/Nrx4ZoS
>
> This occurs even with different lat_0 values.
> gdalwarp -t_srs "+proj=stere +lat_0=90 +lon_0=0 +lat_ts=70 +ellps=WGS84 +datum=WGS84 +units=m" ./UiMbqSd.withmetadata.tif ./regridded_lon0_0.tif
>
> Another png representation on imagur:  http://imgur.com/uiiF9Ir
>
>
> I'm currently running this on a mac:
>
>> gdalwarp --version
> GDAL 1.11.1, released 2014/09/24
>
> But I've tested and seen the same behavior on ubuntu 12.04:
> GDAL 1.10.1, released 2013/08/26
>
> Any help solving this would be greatly appreciated.
>
> Thanks
> Matt

-- 
Matthew Savoie  -  Senior Software Developer
National Snow and Ice Data Center
(303) 735-0785   http://nsidc.org

From Martin.Lewis at euro.ngc.com  Fri Oct 10 01:12:14 2014
From: Martin.Lewis at euro.ngc.com (M Lewis)
Date: Fri, 10 Oct 2014 01:12:14 -0700 (PDT)
Subject: [gdal-dev] 16bit Pixel Arrangement?
Message-ID: <1412928734438-5166812.post@n6.nabble.com>

I am trying to read a NITF image that has a single band with a data type of
UInt16 and a ColorInterp of 'Undefined' as show below in some details taken
from the gdalinfo dump:

NITF_IMODE=B
NITF_IREP=MONO
NITF_ISCLAS=U
NITF_OSTAID=DG
NITF_PJUST=R
NITF_PVTYPE=INT
Corner Coordinates:
Upper Left  (  774731.700, 2060246.300) ( 72d23'46.92"W, 18d36'54.78"N)
Lower Left  (  774731.700, 2046011.700) ( 72d23'53.93"W, 18d29'12.10"N)
Upper Right (  788966.300, 2060246.300) ( 72d15'41.67"W, 18d36'47.89"N)
Lower Right (  788966.300, 2046011.700) ( 72d15'49.05"W, 18d29' 5.26"N)
Center      (  781849.000, 2053129.000) ( 72d19'47.89"W, 18d33' 0.05"N)
Band 1 Block=1024x1024 Type=UInt16, ColorInterp=Undefined

I am trying to create a corresponding 16bit bitmap for display but having
trouble as it appears this is a mono image but its coming out 'blue/green'
so it appears a shift somewhere in the pixel data

Can any one tell me, for a UInt16, what is the likely pixel data arrangement
that is returned in the RasterIO call as 'Undefined' doesn't help much i.e:

Is it 5 bits for R, 5 for B etc?
If it is, is it ABGR or RGBA?
Or is it none of the above and something else?
Should there be any further clues in the NITF metadata?

I have looked at the bytes coming back from the RasterIO call and they make
little sense; all the bottom bits are loaded and the top 5 bits 0 but for a 
mono image I would expect a more even pattern of bits set across all the 16
bits.

I have simplified the call to RasterIO using the following parameters:

eBufType = GDT_UInt16
nBandCount = 1
pBandMap = NULL   - so it reads just the first band
nPixelSpace = 0
nLineSpace = 0
nBandSpace = 0

For other things e.g. YCbCR, I understand that RasterIO does some
translation to RGB, is that what is going on here? If it is, what is the
translation likely to produce?

QGIS seems to be able to display the image correctly.

Thanks (sorry its a bit waffly)

Martin



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/16bit-Pixel-Arrangement-tp5166812.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From remi.cura at gmail.com  Fri Oct 10 07:11:02 2014
From: remi.cura at gmail.com (=?UTF-8?Q?R=C3=A9mi_Cura?=)
Date: Fri, 10 Oct 2014 16:11:02 +0200
Subject: [gdal-dev] GDAl no more compiling on Ubunut 12.0.4
Message-ID: <CAJvUf_v1V556S-MLtU1xEE_zpOjO5QLTj8dFeLu7upuLjG3bNA@mail.gmail.com>

Hello everybody.

It compiled GDAL on Ubuntu 12.0.4 LTS about 6 months ago.
Today I updated the git sources,
a new error at the very beginning of compilation stops everything

"Configure" seems to have changed a lot.
Any suggestions?
Cheers,
R?mi-C

//////////error//////////
In file included from cpl_conv.h:35:0,
                 from cpl_conv.cpp:33:
cpl_port.h:89:2: error: #error "Unexpected value for SIZEOF_INT"
cpl_port.h:93:2: error: #error "Unexpected value for SIZEOF_UNSIGNED_LONG"
cpl_port.h:97:2: error: #error "Unexpected value for SIZEOF_VOIDP"
////////////
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141010/77c030e0/attachment.html>

From eadam at co.lincoln.or.us  Fri Oct 10 09:32:57 2014
From: eadam at co.lincoln.or.us (Eli Adam)
Date: Fri, 10 Oct 2014 09:32:57 -0700
Subject: [gdal-dev] GDAl no more compiling on Ubunut 12.0.4
In-Reply-To: <CAJvUf_v1V556S-MLtU1xEE_zpOjO5QLTj8dFeLu7upuLjG3bNA@mail.gmail.com>
References: <CAJvUf_v1V556S-MLtU1xEE_zpOjO5QLTj8dFeLu7upuLjG3bNA@mail.gmail.com>
Message-ID: <CACqBkM_3oN-oUNqLNJc7ZCm=LG6ytyK=Sbkyi4oOKM6=PF3iJw@mail.gmail.com>

> It compiled GDAL on Ubuntu 12.0.4 LTS about 6 months ago.
> Today I updated the git sources,
> a new error at the very beginning of compilation stops everything
>
> "Configure" seems to have changed a lot.
> Any suggestions?

I can compile svn trunk on 12.04 as of today.  I started with a make
clean and then this is my configure:

./configure --with-poppler --with-spatialite=yes --with-java=yes
--with-mdb=yes --with-python --with-curl --with-expat --with-libkml

make clean might help.  There are a lot of different libraries which
can be internal or external and many combinations to test so not sure
how similar my setup is to yours.

Best regards, Eli


> Cheers,
> R?mi-C
>
> //////////error//////////
> In file included from cpl_conv.h:35:0,
>                  from cpl_conv.cpp:33:
> cpl_port.h:89:2: error: #error "Unexpected value for SIZEOF_INT"
> cpl_port.h:93:2: error: #error "Unexpected value for SIZEOF_UNSIGNED_LONG"
> cpl_port.h:97:2: error: #error "Unexpected value for SIZEOF_VOIDP"
> ////////////
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at spatialys.com  Fri Oct 10 14:27:41 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 10 Oct 2014 23:27:41 +0200
Subject: [gdal-dev] 16bit Pixel Arrangement?
In-Reply-To: <1412928734438-5166812.post@n6.nabble.com>
References: <1412928734438-5166812.post@n6.nabble.com>
Message-ID: <5217032.QlvnkAtOSB@even-n550jk>

On Friday 10 October 2014 01:12:14 M Lewis wrote:
> I am trying to read a NITF image that has a single band with a data type of
> UInt16 and a ColorInterp of 'Undefined' as show below in some details taken
> from the gdalinfo dump:
> 
> NITF_IMODE=B
> NITF_IREP=MONO
> NITF_ISCLAS=U
> NITF_OSTAID=DG
> NITF_PJUST=R
> NITF_PVTYPE=INT
> Corner Coordinates:
> Upper Left  (  774731.700, 2060246.300) ( 72d23'46.92"W, 18d36'54.78"N)
> Lower Left  (  774731.700, 2046011.700) ( 72d23'53.93"W, 18d29'12.10"N)
> Upper Right (  788966.300, 2060246.300) ( 72d15'41.67"W, 18d36'47.89"N)
> Lower Right (  788966.300, 2046011.700) ( 72d15'49.05"W, 18d29' 5.26"N)
> Center      (  781849.000, 2053129.000) ( 72d19'47.89"W, 18d33' 0.05"N)
> Band 1 Block=1024x1024 Type=UInt16, ColorInterp=Undefined
> 
> I am trying to create a corresponding 16bit bitmap for display but having
> trouble as it appears this is a mono image but its coming out 'blue/green'
> so it appears a shift somewhere in the pixel data

Martin,

this does not make sense to me. If it is a single band dataset, the best you 
can do is display it in grey levels. You will never have colours from that, 
unless you apply some color table with other means.

> 
> Can any one tell me, for a UInt16, what is the likely pixel data arrangement
> that is returned in the RasterIO call as 'Undefined' doesn't help much i.e:
> 
> Is it 5 bits for R, 5 for B etc?
> If it is, is it ABGR or RGBA?
> Or is it none of the above and something else?

That would be extremely odd to pack color components within uint16. Well, I 
known this is done in OpenGL textures, but I've never seen that trick in GIS 
format ;-)

> Should there be any further clues in the NITF metadata?
> 
> I have looked at the bytes coming back from the RasterIO call and they make
> little sense; all the bottom bits are loaded and the top 5 bits 0 but for a
> mono image I would expect a more even pattern of bits set across all the 16
> bits.

It is very common to have 12 bit imagery. And where each 12 bit sample is 
placed in a 16 bit container. Check if there's not a NITF_ABPP metadata item 
(ABPP = Actual Bit Per Pixel). That would give you the real dynamics of the 
values.

Otherwise just do "gdalinfo -stats the.nitf" and look at the minimum and 
maximum values.

You can try the -scale option of gdal_translate to for example convert to 8 
bit depth.

> 
> I have simplified the call to RasterIO using the following parameters:
> 
> eBufType = GDT_UInt16
> nBandCount = 1
> pBandMap = NULL   - so it reads just the first band
> nPixelSpace = 0
> nLineSpace = 0
> nBandSpace = 0
> 
> For other things e.g. YCbCR, I understand that RasterIO does some
> translation to RGB, is that what is going on here? If it is, what is the
> translation likely to produce?

In your case, no translation will be done, since there's apparently nothing to 
convert.

> 
> QGIS seems to be able to display the image correctly.
> 

As grey level I guess ? And likely after adjusting the min/max values


Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From andre+joost at nurfuerspam.de  Fri Oct 10 21:27:45 2014
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Sat, 11 Oct 2014 06:27:45 +0200
Subject: [gdal-dev] 16bit Pixel Arrangement?
In-Reply-To: <5217032.QlvnkAtOSB@even-n550jk>
References: <1412928734438-5166812.post@n6.nabble.com>
	<5217032.QlvnkAtOSB@even-n550jk>
Message-ID: <m1aboq$u97$1@ger.gmane.org>

Am 10.10.2014 23:27, schrieb Even Rouault:
> On Friday 10 October 2014 01:12:14 M Lewis wrote:

>
>>
>> QGIS seems to be able to display the image correctly.
>>
>
> As grey level I guess ? And likely after adjusting the min/max values
>

QGIS has support for pseudocolurs from single band. Maybe the author of 
the data used the same default colour ramp as QGIS does.

Greetings,
Andr? Joost



From landa.martin at gmail.com  Sat Oct 11 09:30:12 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Sat, 11 Oct 2014 18:30:12 +0200
Subject: [gdal-dev] Esri Shapefile: problem with UTF-8 on Windows
Message-ID: <CA+Ei1OeZWBR3QTexNPppyhUaSc6X3av=GR9E5yY+Pwzb7HNS7w@mail.gmail.com>

Hi,

I have problem with converting GML file (UTF-8) to Esri Shapefile on
Windows (Czech version), it fails with error:

Failed to create field name 'NutsLau' : cannot convert to UTF8

I am using configuration option LCO 'ENCODING=UTF8'. Exporting the
same file simply works on my Debian GNU/Linux.

Any idea what could be a problem? Thanks in advance, Martin

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From bishop.dev at gmail.com  Sat Oct 11 12:17:18 2014
From: bishop.dev at gmail.com (Dmitriy Baryshnikov)
Date: Sat, 11 Oct 2014 23:17:18 +0400
Subject: [gdal-dev] Esri Shapefile: problem with UTF-8 on Windows
In-Reply-To: <CA+Ei1OeZWBR3QTexNPppyhUaSc6X3av=GR9E5yY+Pwzb7HNS7w@mail.gmail.com>
References: <CA+Ei1OeZWBR3QTexNPppyhUaSc6X3av=GR9E5yY+Pwzb7HNS7w@mail.gmail.com>
Message-ID: <5439823E.2010206@gmail.com>

Hi,

It seems to me what ENCODING=UTF8 affects only on field values not 
names. It is good practice to not use non English field names.

Best regards,
     Dmitry

11.10.2014 20:30, Martin Landa ?????:
> Hi,
>
> I have problem with converting GML file (UTF-8) to Esri Shapefile on
> Windows (Czech version), it fails with error:
>
> Failed to create field name 'NutsLau' : cannot convert to UTF8
>
> I am using configuration option LCO 'ENCODING=UTF8'. Exporting the
> same file simply works on my Debian GNU/Linux.
>
> Any idea what could be a problem? Thanks in advance, Martin
>


From even.rouault at spatialys.com  Sat Oct 11 12:31:26 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 11 Oct 2014 21:31:26 +0200
Subject: [gdal-dev] Esri Shapefile: problem with UTF-8 on Windows
In-Reply-To: <5439823E.2010206@gmail.com>
References: <CA+Ei1OeZWBR3QTexNPppyhUaSc6X3av=GR9E5yY+Pwzb7HNS7w@mail.gmail.com>
	<5439823E.2010206@gmail.com>
Message-ID: <4063927.3ZnEGDgOya@even-n550jk>

On Saturday 11 October 2014 23:17:18 Dmitriy Baryshnikov wrote:
> Hi,
> 
> It seems to me what ENCODING=UTF8 affects only on field values not
> names.

In recent versions of GDAL, this should also recode field names. But I think 
the issue here is just a typo. It should be UTF-8, not UTF8. UTF8 might work 
on Linux since iconv accepts both UTF8 and UTF-8. But on Windows, only UTF-8 
will work.

> It is good practice to not use non English field names.
> 
> Best regards,
>      Dmitry
> 
> 11.10.2014 20:30, Martin Landa ?????:
> > Hi,
> > 
> > I have problem with converting GML file (UTF-8) to Esri Shapefile on
> > Windows (Czech version), it fails with error:
> > 
> > Failed to create field name 'NutsLau' : cannot convert to UTF8
> > 
> > I am using configuration option LCO 'ENCODING=UTF8'. Exporting the
> > same file simply works on my Debian GNU/Linux.
> > 
> > Any idea what could be a problem? Thanks in advance, Martin
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From landa.martin at gmail.com  Sat Oct 11 12:35:53 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Sat, 11 Oct 2014 21:35:53 +0200
Subject: [gdal-dev] Esri Shapefile: problem with UTF-8 on Windows
In-Reply-To: <5439823E.2010206@gmail.com>
References: <CA+Ei1OeZWBR3QTexNPppyhUaSc6X3av=GR9E5yY+Pwzb7HNS7w@mail.gmail.com>
	<5439823E.2010206@gmail.com>
Message-ID: <CA+Ei1Oe-WOOXCkou6gLFZ=0ajYuYXtnPaS25jDG=7YYsLBj=wg@mail.gmail.com>

Hi,

2014-10-11 21:17 GMT+02:00 Dmitriy Baryshnikov <bishop.dev at gmail.com>:
> It seems to me what ENCODING=UTF8 affects only on field values not names. It
> is good practice to not use non English field names.

>> Failed to create field name 'NutsLau' : cannot convert to UTF8

right, but the field names contain only ASCII characters, see
'NutsLau' in this case. Martin

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From landa.martin at gmail.com  Sat Oct 11 12:38:03 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Sat, 11 Oct 2014 21:38:03 +0200
Subject: [gdal-dev] Esri Shapefile: problem with UTF-8 on Windows
In-Reply-To: <4063927.3ZnEGDgOya@even-n550jk>
References: <CA+Ei1OeZWBR3QTexNPppyhUaSc6X3av=GR9E5yY+Pwzb7HNS7w@mail.gmail.com>
	<5439823E.2010206@gmail.com> <4063927.3ZnEGDgOya@even-n550jk>
Message-ID: <CA+Ei1Odd9Zn2dDLcuS4sz8iZ5B9D91ABFmqwsc6d7S80rvr3ZA@mail.gmail.com>

Hi Even,

2014-10-11 21:31 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:

> In recent versions of GDAL, this should also recode field names. But I think
> the issue here is just a typo. It should be UTF-8, not UTF8. UTF8 might work
> on Linux since iconv accepts both UTF8 and UTF-8. But on Windows, only UTF-8
> will work.

ah, you are right! Thanks! Martin

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From sfkeller at gmail.com  Sun Oct 12 05:34:20 2014
From: sfkeller at gmail.com (Stefan Keller)
Date: Sun, 12 Oct 2014 14:34:20 +0200
Subject: [gdal-dev] Generating GeoTIFF overview ("gdaladdo -r gauss ...")
 takes days for 2GB file...
Message-ID: <CAFcOn2_czXj86raxQW50aveiwaZRXAqUkHkbeko+gjeYLtu3eQ@mail.gmail.com>

Hi,

I have a GeoTIFF file of 2GB size. Now, this question is about
gdaladdo and how to optimize loading time of such a large raster file.

According to my observations QGIS has fastest loading times when it's
a single GeoTIFF file with overview images.

Q.1: Does anybody have tipps for even faster solutions loading raster
files into in QGIS (prepared by OGR or other preprocessors)?

The command "gdaladdo -r gauss C:\SG.tif  2 4 8 16 32 64 128 256"
takes actually about 7 days on a Lenovo notebook.

Q2.: Any hint's on how to accelerate this (or to other tools
generating overviews/pyramids)?

Yours, S.

From even.rouault at spatialys.com  Sun Oct 12 06:21:05 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 12 Oct 2014 15:21:05 +0200
Subject: [gdal-dev] Generating GeoTIFF overview ("gdaladdo -r gauss
 ...") takes days for 2GB file...
In-Reply-To: <CAFcOn2_czXj86raxQW50aveiwaZRXAqUkHkbeko+gjeYLtu3eQ@mail.gmail.com>
References: <CAFcOn2_czXj86raxQW50aveiwaZRXAqUkHkbeko+gjeYLtu3eQ@mail.gmail.com>
Message-ID: <5940651.NdEHAjeF3D@even-n550jk>

On Sunday 12 October 2014 14:34:20 Stefan Keller wrote:
> Hi,
> 
> I have a GeoTIFF file of 2GB size. Now, this question is about
> gdaladdo and how to optimize loading time of such a large raster file.
> 
> According to my observations QGIS has fastest loading times when it's
> a single GeoTIFF file with overview images.
> 
> Q.1: Does anybody have tipps for even faster solutions loading raster
> files into in QGIS (prepared by OGR or other preprocessors)?
> 
> The command "gdaladdo -r gauss C:\SG.tif  2 4 8 16 32 64 128 256"
> takes actually about 7 days on a Lenovo notebook.
> 
> Q2.: Any hint's on how to accelerate this (or to other tools
> generating overviews/pyramids)?

Weird, I've tested something similar. I've created a 2 GB tiff with :

from osgeo import gdal
ds = gdal.GetDriverByName('GTiff').Create('big.tif', 45000, 45000)
ds = None

And then : gdaladdo  -r gauss big.tif  2 4 8 16 32 64 128 256

Takes 30 seconds on my laptop with GDAL 1.11 or trunk (brand new laptop 
admitedly, but still, shouldn't take more than a few minutes on a 2 or 3 year 
old hardware)

So not sure why this is so slow for you. Could you paste the output of 
gdalinfo on SG.tif in case something shows up ?

> 
> Yours, S.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From lukasz.tracewski at outlook.com  Sun Oct 12 13:43:54 2014
From: lukasz.tracewski at outlook.com (Lukasz Tracewski)
Date: Sun, 12 Oct 2014 22:43:54 +0200
Subject: [gdal-dev] Conversion from ASCII to GeoTIFF with gdalwarp:
	incorrect output
Message-ID: <DUB120-W232C1323029BAFA11D0AC8FAF0@phx.gbl>

Hi,
I have a few thousands of ESRI ASCII rasters in World_Mollweide (EPSG:54009) projection, which I need to convert to GeoTIFF. Usually it goes fine, but there are certain special cases that resist peaceful conversion. They are all placed on Fiji, which is special in a sense being on very border of a world's map. Problem is that in those cases somehow output is completely messed up, with incorrect resolution.
Here is how I do the conversion:gdalwarp -s_srs '+proj=moll +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m no_defs' -t_srs EPSG:4326 -co NBITS=1 -co COMPRESS=CCITTRLE -co PHOTOMETRIC=MINISWHITE -ot Byte $ascfile $newname
My ASCII files are bilevel, with 0 and 1 only.
Here is an example of a problematic ASCII:https://drive.google.com/file/d/0B46Cy3WOKgyJYVdMLWV0OGFJQ2M/view?usp=sharing
That will produce GeoTIFF with only 3 pixels in latitude:https://drive.google.com/file/d/0B46Cy3WOKgyJTnoxSHdyaUR5cWs/view?usp=sharing
Thing is if I crop the ASCII in QGIS to include only left side of the image, then it's fine. If I take the right side, then again I get incorrect output. 
Any ideas?
Cheers,Lucas 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141012/b8e5f53b/attachment.html>

From landa.martin at gmail.com  Mon Oct 13 01:03:22 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Mon, 13 Oct 2014 10:03:22 +0200
Subject: [gdal-dev] StringList and Esri Shapefile
Message-ID: <CA+Ei1Of5kjnRbbGoUnNXCi14Eiju4gv=SRBihdFBkCa0KcsVhQ@mail.gmail.com>

Hi,

it seems that StringList type is not supported by Esri Shapefile
format. I am not sure how to solve this problem in the right way.

ERROR: Unable to read 20140930_OB_571041_UKSH.xml.gz: Can't create
fields of type StringList on shapefile layers.

Probably the Esri Shapefile driver could convert such data to string
automatically?

Thanks in advance, Martin

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From remi.cura at gmail.com  Mon Oct 13 01:14:36 2014
From: remi.cura at gmail.com (=?UTF-8?Q?R=C3=A9mi_Cura?=)
Date: Mon, 13 Oct 2014 10:14:36 +0200
Subject: [gdal-dev] GDAl no more compiling on Ubunut 12.0.4
In-Reply-To: <CACqBkM_3oN-oUNqLNJc7ZCm=LG6ytyK=Sbkyi4oOKM6=PF3iJw@mail.gmail.com>
References: <CAJvUf_v1V556S-MLtU1xEE_zpOjO5QLTj8dFeLu7upuLjG3bNA@mail.gmail.com>
	<CACqBkM_3oN-oUNqLNJc7ZCm=LG6ytyK=Sbkyi4oOKM6=PF3iJw@mail.gmail.com>
Message-ID: <CAJvUf_uDWsP07NAk9hj-tsdm_fyd7hAy4iqoEBCpZL7UCZ59kA@mail.gmail.com>

Hey,
Thanks for the help !

I started from a fresh git clone,
it compiled fine using the regular autotools.
Again from fresh git clone, cmake works fine.
It seems the bug is produced by
_ mixing autotools and cmake
_using a virtual box shared folder filesystem

So anybody using virtualbox shared file system must be careful (performance
hit is about 2 time also).

Cheers,
R?mi-C

2014-10-10 18:32 GMT+02:00 Eli Adam <eadam at co.lincoln.or.us>:

> > It compiled GDAL on Ubuntu 12.0.4 LTS about 6 months ago.
> > Today I updated the git sources,
> > a new error at the very beginning of compilation stops everything
> >
> > "Configure" seems to have changed a lot.
> > Any suggestions?
>
> I can compile svn trunk on 12.04 as of today.  I started with a make
> clean and then this is my configure:
>
> ./configure --with-poppler --with-spatialite=yes --with-java=yes
> --with-mdb=yes --with-python --with-curl --with-expat --with-libkml
>
> make clean might help.  There are a lot of different libraries which
> can be internal or external and many combinations to test so not sure
> how similar my setup is to yours.
>
> Best regards, Eli
>
>
> > Cheers,
> > R?mi-C
> >
> > //////////error//////////
> > In file included from cpl_conv.h:35:0,
> >                  from cpl_conv.cpp:33:
> > cpl_port.h:89:2: error: #error "Unexpected value for SIZEOF_INT"
> > cpl_port.h:93:2: error: #error "Unexpected value for
> SIZEOF_UNSIGNED_LONG"
> > cpl_port.h:97:2: error: #error "Unexpected value for SIZEOF_VOIDP"
> > ////////////
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141013/3ca8b9e2/attachment.html>

From even.rouault at spatialys.com  Mon Oct 13 01:41:13 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 13 Oct 2014 10:41:13 +0200
Subject: [gdal-dev] StringList and Esri Shapefile
In-Reply-To: <CA+Ei1Of5kjnRbbGoUnNXCi14Eiju4gv=SRBihdFBkCa0KcsVhQ@mail.gmail.com>
References: <CA+Ei1Of5kjnRbbGoUnNXCi14Eiju4gv=SRBihdFBkCa0KcsVhQ@mail.gmail.com>
Message-ID: <1927399.SIIbKWxtMT@even-n550jk>

On Monday 13 October 2014 10:03:22 Martin Landa wrote:
> Hi,
> 
> it seems that StringList type is not supported by Esri Shapefile
> format. I am not sure how to solve this problem in the right way.
> 
> ERROR: Unable to read 20140930_OB_571041_UKSH.xml.gz: Can't create
> fields of type StringList on shapefile layers.
> 
> Probably the Esri Shapefile driver could convert such data to string
> automatically?

Hi Martin,

traditionnaly we avoid doing "lossy" conversions without explicit user 
permission.
If you use ogr2ogr, you could use the "-fieldTypeToString StringList" option to 
ask for StringList fields to be converted to String.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From Martin.Lewis at euro.ngc.com  Mon Oct 13 02:03:30 2014
From: Martin.Lewis at euro.ngc.com (M Lewis)
Date: Mon, 13 Oct 2014 02:03:30 -0700 (PDT)
Subject: [gdal-dev] 16bit Pixel Arrangement?
In-Reply-To: <m1aboq$u97$1@ger.gmane.org>
References: <1412928734438-5166812.post@n6.nabble.com>
	<5217032.QlvnkAtOSB@even-n550jk> <m1aboq$u97$1@ger.gmane.org>
Message-ID: <1413191010947-5167148.post@n6.nabble.com>

Thanks for that, Even & Andre,

There is a NITF_ABPP metadata item and that is set to 11 so that explains
why all leading bits are 0. Also min/max on the stats is 1 to 2047.

The reason why I was going on about 5 bits for R etc was because that is how
colours are defined in a 16 bit bitmap and assumed that was how the data was
going to be organised in a 16 bit single band (if it was gray-scale, I
assumed that the ColorInterp would be set to gray-scale based on the
NITF_IREP=MONO metadata item).

I guess I'll have to grab the histogram and scale the pixel values
accordingly into an 8 bit gray-scale........I may be back!!


Thanks 

Martin






--
View this message in context: http://osgeo-org.1560.x6.nabble.com/16bit-Pixel-Arrangement-tp5166812p5167148.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From bo.victor.thomsen at gmail.com  Mon Oct 13 02:46:33 2014
From: bo.victor.thomsen at gmail.com (Bo Victor Thomsen)
Date: Mon, 13 Oct 2014 11:46:33 +0200
Subject: [gdal-dev] http://www.gisinternals.com down ??
In-Reply-To: <1413191010947-5167148.post@n6.nabble.com>
References: <1412928734438-5166812.post@n6.nabble.com>	<5217032.QlvnkAtOSB@even-n550jk>
	<m1aboq$u97$1@ger.gmane.org>
	<1413191010947-5167148.post@n6.nabble.com>
Message-ID: <543B9F79.5040907@gmail.com>

http://www.gisinternals.com is not accessible at the moment. Is there 
any alternatives for downloading binary windows versions of GDAL/OGR ?

Regards
Bo Victor Thomsen




From landa.martin at gmail.com  Mon Oct 13 03:47:45 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Mon, 13 Oct 2014 12:47:45 +0200
Subject: [gdal-dev] StringList and Esri Shapefile
In-Reply-To: <1927399.SIIbKWxtMT@even-n550jk>
References: <CA+Ei1Of5kjnRbbGoUnNXCi14Eiju4gv=SRBihdFBkCa0KcsVhQ@mail.gmail.com>
	<1927399.SIIbKWxtMT@even-n550jk>
Message-ID: <CA+Ei1Oefqm08q44W0K_ydMTp+Wd=51tAUXb6WBCBSCT--UK_CQ@mail.gmail.com>

Hi,

2014-10-13 10:41 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:

[...]

> If you use ogr2ogr, you could use the "-fieldTypeToString StringList" option to
> ask for StringList fields to be converted to String.

ah, ok, I overlooked this option. Is it possible also from Python API?
Thanks, Martin

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From even.rouault at spatialys.com  Mon Oct 13 03:58:02 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 13 Oct 2014 12:58:02 +0200
Subject: [gdal-dev] StringList and Esri Shapefile
In-Reply-To: <CA+Ei1Oefqm08q44W0K_ydMTp+Wd=51tAUXb6WBCBSCT--UK_CQ@mail.gmail.com>
References: <CA+Ei1Of5kjnRbbGoUnNXCi14Eiju4gv=SRBihdFBkCa0KcsVhQ@mail.gmail.com>
	<1927399.SIIbKWxtMT@even-n550jk>
	<CA+Ei1Oefqm08q44W0K_ydMTp+Wd=51tAUXb6WBCBSCT--UK_CQ@mail.gmail.com>
Message-ID: <7106188.t8M2aODPeD@even-n550jk>

On Monday 13 October 2014 12:47:45 Martin Landa wrote:
> Hi,
> 
> 2014-10-13 10:41 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
> 
> [...]
> 
> > If you use ogr2ogr, you could use the "-fieldTypeToString StringList"
> > option to ask for StringList fields to be converted to String.
> 
> ah, ok, I overlooked this option. Is it possible also from Python API?

Basically it is a matter of declaring a ogr.OFTString field in the target layer 
definition. dstFeature.SetFrom(srcFeature) will do the translation.

> Thanks, Martin

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From landa.martin at gmail.com  Mon Oct 13 04:33:11 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Mon, 13 Oct 2014 13:33:11 +0200
Subject: [gdal-dev] strange problem with compilation
Message-ID: <CA+Ei1Oeo+zuHjicEgmWFx7svSBrPvxdNon4jw6Se8GeADDH7Mw@mail.gmail.com>

Hi all,

we are facing to a strange problem when trying to compile C++ code
against GDAL library. We have a self-compiled GDAL located in
`/usr/local/lib`.

Sample code:

"""
#include "ogrsf_frmts.h"

int main()
{
   GDALAllRegister();
}
"""

Command:

g++ -I /usr/local/include -L /usr/local/lib  -lgdal main.cpp

Error:

undefined reference to GDALAllRegister

We checked that the library is in the path (libc.conf, updated  by
`ldconfig` ) and contains GDALAllRegister() (checked by `nm`).

OS: Ubuntu 14.04LTS (64bit).

Any idea what could be wrong? Thanks in advance, Martin

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From landa.martin at gmail.com  Mon Oct 13 04:41:11 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Mon, 13 Oct 2014 13:41:11 +0200
Subject: [gdal-dev] strange problem with compilation
In-Reply-To: <CA+Ei1Oeo+zuHjicEgmWFx7svSBrPvxdNon4jw6Se8GeADDH7Mw@mail.gmail.com>
References: <CA+Ei1Oeo+zuHjicEgmWFx7svSBrPvxdNon4jw6Se8GeADDH7Mw@mail.gmail.com>
Message-ID: <CA+Ei1Ocn+_1NtktBdWxsX1kTh0zApr1B_hT=7ndh0OfJbqmHqw@mail.gmail.com>

Hi,

2014-10-13 13:33 GMT+02:00 Martin Landa <landa.martin at gmail.com>:
> g++ -I /usr/local/include -L /usr/local/lib  -lgdal main.cpp
>
> Error:
>
> undefined reference to GDALAllRegister

solved,

g++ mail.cpp -I /usr/local/include -L /usr/local/lib -lgdal

works (so `-l` after cpp file).

Strangely g++ 4.7 works on both commands. Only g++ 4.8 fails...

Huh, sorry for the noise, Martin

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From even.rouault at spatialys.com  Mon Oct 13 04:51:17 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 13 Oct 2014 13:51:17 +0200
Subject: [gdal-dev] strange problem with compilation
In-Reply-To: <CA+Ei1Ocn+_1NtktBdWxsX1kTh0zApr1B_hT=7ndh0OfJbqmHqw@mail.gmail.com>
References: <CA+Ei1Oeo+zuHjicEgmWFx7svSBrPvxdNon4jw6Se8GeADDH7Mw@mail.gmail.com>
	<CA+Ei1Ocn+_1NtktBdWxsX1kTh0zApr1B_hT=7ndh0OfJbqmHqw@mail.gmail.com>
Message-ID: <1496984.XI7LlX0Yvy@even-n550jk>

On Monday 13 October 2014 13:41:11 Martin Landa wrote:
> Hi,
> 
> 2014-10-13 13:33 GMT+02:00 Martin Landa <landa.martin at gmail.com>:
> > g++ -I /usr/local/include -L /usr/local/lib  -lgdal main.cpp
> > 
> > Error:
> > 
> > undefined reference to GDALAllRegister
> 
> solved,
> 
> g++ mail.cpp -I /usr/local/include -L /usr/local/lib -lgdal
> 
> works (so `-l` after cpp file).
> 
> Strangely g++ 4.7 works on both commands. Only g++ 4.8 fails...

Yes, I've hit similar issues recently. Newer g++ are very picky about the 
order into which arguments appear on the command line for linking. You must 
put -L -l after the file that need them.

> 
> Huh, sorry for the noise, Martin

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From wolf+grass at bergenheim.net  Mon Oct 13 04:56:28 2014
From: wolf+grass at bergenheim.net (Wolf Bergenheim)
Date: Mon, 13 Oct 2014 13:56:28 +0200
Subject: [gdal-dev] http://www.gisinternals.com down ??
In-Reply-To: <543B9F79.5040907@gmail.com>
References: <1412928734438-5166812.post@n6.nabble.com>
	<5217032.QlvnkAtOSB@even-n550jk>
	<m1aboq$u97$1@ger.gmane.org> <1413191010947-5167148.post@n6.nabble.com>
	<543B9F79.5040907@gmail.com>
Message-ID: <CAJhTkW5bJVtYzdjKFtKCv15=f5wNpFEK_GvpcS7ibY5k0bxk+Q@mail.gmail.com>

Well,

The trac wiki does list one other source [1], also I recommend OSGeo4W [2]

[1] http://trac.osgeo.org/gdal/wiki/DownloadingGdalBinaries
[2] http://trac.osgeo.org/osgeo4w/

--Wolf

On Mon, Oct 13, 2014 at 11:46 AM, Bo Victor Thomsen <
bo.victor.thomsen at gmail.com> wrote:

> http://www.gisinternals.com is not accessible at the moment. Is there any
> alternatives for downloading binary windows versions of GDAL/OGR ?
>
> Regards
> Bo Victor Thomsen
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141013/161946d6/attachment.html>

From landa.martin at gmail.com  Mon Oct 13 05:43:50 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Mon, 13 Oct 2014 14:43:50 +0200
Subject: [gdal-dev] StringList and Esri Shapefile
In-Reply-To: <7106188.t8M2aODPeD@even-n550jk>
References: <CA+Ei1Of5kjnRbbGoUnNXCi14Eiju4gv=SRBihdFBkCa0KcsVhQ@mail.gmail.com>
	<1927399.SIIbKWxtMT@even-n550jk>
	<CA+Ei1Oefqm08q44W0K_ydMTp+Wd=51tAUXb6WBCBSCT--UK_CQ@mail.gmail.com>
	<7106188.t8M2aODPeD@even-n550jk>
Message-ID: <CA+Ei1OeVpWn2QPH8LW3KjeoHsRvjL5cGzrnhLDsCZd70y1hZRA@mail.gmail.com>

Hi,

2014-10-13 12:58 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
> Basically it is a matter of declaring a ogr.OFTString field in the target layer
> definition. dstFeature.SetFrom(srcFeature) will do the translation.

yes, I am already doing it

ofeature = ogr.Feature(olayer.GetLayerDefn())
ofeature.SetFrom(feature)

but it fails. Any idea? Thanks, Martin

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From szekerest at gmail.com  Mon Oct 13 06:32:52 2014
From: szekerest at gmail.com (Tamas Szekeres)
Date: Mon, 13 Oct 2014 15:32:52 +0200
Subject: [gdal-dev] http://www.gisinternals.com down ??
In-Reply-To: <543B9F79.5040907@gmail.com>
References: <1412928734438-5166812.post@n6.nabble.com>
	<5217032.QlvnkAtOSB@even-n550jk> <m1aboq$u97$1@ger.gmane.org>
	<1413191010947-5167148.post@n6.nabble.com>
	<543B9F79.5040907@gmail.com>
Message-ID: <CACALY+QbphCLqwGt4FB5v6PQ8GNwTOET-suVJT4WnCE3U=tHeQ@mail.gmail.com>

Back again.
http://www.gisinternals.com/sdk/

Best regards,

Tamas


2014-10-13 11:46 GMT+02:00 Bo Victor Thomsen <bo.victor.thomsen at gmail.com>:

> http://www.gisinternals.com is not accessible at the moment. Is there any
> alternatives for downloading binary windows versions of GDAL/OGR ?
>
> Regards
> Bo Victor Thomsen
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141013/4452cd11/attachment.html>

From J.Moules at hrwallingford.com  Mon Oct 13 06:05:00 2014
From: J.Moules at hrwallingford.com (Jonathan Moules)
Date: Mon, 13 Oct 2014 13:05:00 +0000
Subject: [gdal-dev] [Qgis-user] Generating GeoTIFF overview ("gdaladdo
 -r gauss ...") takes days for 2GB file...
In-Reply-To: <CAFcOn2_czXj86raxQW50aveiwaZRXAqUkHkbeko+gjeYLtu3eQ@mail.gmail.com>
References: <CAFcOn2_czXj86raxQW50aveiwaZRXAqUkHkbeko+gjeYLtu3eQ@mail.gmail.com>
Message-ID: <E6100A0537F18549AC8FCCB5D47FFE355F09AD@EXMBX1.hrw-uk.local>

Hi Stefan,
How large is the image? As in, pixel width & height.

Also the GDALinfo would be helpful.

7 days is a very long time. I've seen times like that myself for images that were 100,000*50,000 or similar dimensions where there was (still is?) an issue with the pyramiding function in GDAL (it was re-reading the data again and again).

Cheers,
Jonathan

-----Original Message-----
From: qgis-user-bounces at lists.osgeo.org [mailto:qgis-user-bounces at lists.osgeo.org] On Behalf Of Stefan Keller
Sent: Sunday, October 12, 2014 1:34 PM
To: gdal-dev at lists.osgeo.org; qgis-user
Subject: [Qgis-user] Generating GeoTIFF overview ("gdaladdo -r gauss ...") takes days for 2GB file...

Hi,

I have a GeoTIFF file of 2GB size. Now, this question is about gdaladdo and how to optimize loading time of such a large raster file.

According to my observations QGIS has fastest loading times when it's a single GeoTIFF file with overview images.

Q.1: Does anybody have tipps for even faster solutions loading raster files into in QGIS (prepared by OGR or other preprocessors)?

The command "gdaladdo -r gauss C:\SG.tif  2 4 8 16 32 64 128 256"
takes actually about 7 days on a Lenovo notebook.

Q2.: Any hint's on how to accelerate this (or to other tools generating overviews/pyramids)?

Yours, S.
_______________________________________________
Qgis-user mailing list
Qgis-user at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/qgis-user


This message has been scanned for viruses by MailControl - www.mailcontrol.com



Click https://www.mailcontrol.com/sr/pdM3aunlCjzGX2PQPOmvUgEBY15Clgt1cLVtYJoNw+TFapmLjYzc0LQlVsaeWay487vQIAp6KUWSPFO0UaI8cQ== to report this email as spam.

________________________________

HR Wallingford and its subsidiaries uses faxes and emails for confidential and legally privileged business communications. They do not of themselves create legal commitments. Disclosure to parties other than addressees requires our specific consent. We are not liable for unauthorised disclosures nor reliance upon them.
If you have received this message in error please advise us immediately and destroy all copies of it.

HR Wallingford Limited
Howbery Park, Wallingford, Oxfordshire, OX10 8BA, United Kingdom
Registered in England No. 02562099

________________________________

From landa.martin at gmail.com  Mon Oct 13 08:01:49 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Mon, 13 Oct 2014 17:01:49 +0200
Subject: [gdal-dev] StringList and Esri Shapefile
In-Reply-To: <CA+Ei1OeVpWn2QPH8LW3KjeoHsRvjL5cGzrnhLDsCZd70y1hZRA@mail.gmail.com>
References: <CA+Ei1Of5kjnRbbGoUnNXCi14Eiju4gv=SRBihdFBkCa0KcsVhQ@mail.gmail.com>
	<1927399.SIIbKWxtMT@even-n550jk>
	<CA+Ei1Oefqm08q44W0K_ydMTp+Wd=51tAUXb6WBCBSCT--UK_CQ@mail.gmail.com>
	<7106188.t8M2aODPeD@even-n550jk>
	<CA+Ei1OeVpWn2QPH8LW3KjeoHsRvjL5cGzrnhLDsCZd70y1hZRA@mail.gmail.com>
Message-ID: <CA+Ei1OeFo61pKMa8gnFshcOmKZEuEn7wQtWop0-6CMuvdYsNHA@mail.gmail.com>

2014-10-13 14:43 GMT+02:00 Martin Landa <landa.martin at gmail.com>:
> ofeature = ogr.Feature(olayer.GetLayerDefn())

the problem will be probably in the code above. Do I need to define
types of affected attributes manually (StringList -> String)?

Thanks, Martin

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From even.rouault at spatialys.com  Mon Oct 13 08:11:21 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 13 Oct 2014 17:11:21 +0200
Subject: [gdal-dev] StringList and Esri Shapefile
In-Reply-To: <CA+Ei1OeFo61pKMa8gnFshcOmKZEuEn7wQtWop0-6CMuvdYsNHA@mail.gmail.com>
References: <CA+Ei1Of5kjnRbbGoUnNXCi14Eiju4gv=SRBihdFBkCa0KcsVhQ@mail.gmail.com>
	<CA+Ei1OeVpWn2QPH8LW3KjeoHsRvjL5cGzrnhLDsCZd70y1hZRA@mail.gmail.com>
	<CA+Ei1OeFo61pKMa8gnFshcOmKZEuEn7wQtWop0-6CMuvdYsNHA@mail.gmail.com>
Message-ID: <2532801.ArUyrT30Tx@even-n550jk>

On Monday 13 October 2014 17:01:49 Martin Landa wrote:
> 2014-10-13 14:43 GMT+02:00 Martin Landa <landa.martin at gmail.com>:
> > ofeature = ogr.Feature(olayer.GetLayerDefn())
> 
> the problem will be probably in the code above. Do I need to define
> types of affected attributes manually (StringList -> String)?

Yes that's what I meant with "it is a matter of declaring a ogr.OFTString field 
in the target layer definition"
That's what is done in ogr2ogr.cpp or swig/python/samples/ogr2ogr.py

> 
> Thanks, Martin

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From andre+joost at nurfuerspam.de  Mon Oct 13 07:53:43 2014
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Mon, 13 Oct 2014 16:53:43 +0200
Subject: [gdal-dev] Conversion from ASCII to GeoTIFF with gdalwarp:
	incorrect output
In-Reply-To: <DUB120-W232C1323029BAFA11D0AC8FAF0@phx.gbl>
References: <DUB120-W232C1323029BAFA11D0AC8FAF0@phx.gbl>
Message-ID: <m1gq77$1ak$3@ger.gmane.org>

Am 12.10.2014 22:43, schrieb Lukasz Tracewski:
> Hi, I have a few thousands of ESRI ASCII rasters in World_Mollweide
> (EPSG:54009) projection, which I need to convert to GeoTIFF. Usually
> it goes fine, but there are certain special cases that resist
> peaceful conversion. They are all placed on Fiji, which is special in
> a sense being on very border of a world's map.

> Thing is if I crop the ASCII in QGIS to include only left side of the
> image, then it's fine. If I take the right side, then again I get
> incorrect output.

Your dataset crosses the 180? meridian, that's why gdalwarp does not 
like reprojecting to EPSG:4326.

What you can do:

- Reproject to a transverse mercator projection with 180? as central 
meridian

- Clip your raster at 180? (or rather +/- 179.95?). Thats not very 
difficult if you have done the tmerc reprojection.

- translate the data to XYZ format and import that as delimited text 
point data. Reprojection of points is a lot easier.

HTH,
Andr? Joost



From landa.martin at gmail.com  Mon Oct 13 09:30:24 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Mon, 13 Oct 2014 18:30:24 +0200
Subject: [gdal-dev] StringList and Esri Shapefile
In-Reply-To: <2532801.ArUyrT30Tx@even-n550jk>
References: <CA+Ei1Of5kjnRbbGoUnNXCi14Eiju4gv=SRBihdFBkCa0KcsVhQ@mail.gmail.com>
	<CA+Ei1OeVpWn2QPH8LW3KjeoHsRvjL5cGzrnhLDsCZd70y1hZRA@mail.gmail.com>
	<CA+Ei1OeFo61pKMa8gnFshcOmKZEuEn7wQtWop0-6CMuvdYsNHA@mail.gmail.com>
	<2532801.ArUyrT30Tx@even-n550jk>
Message-ID: <CA+Ei1OfZQ1v+JVuKBk0hxfLVfOnwHEOdQokmRk4hFH7gGppEOw@mail.gmail.com>

2014-10-13 17:11 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
> Yes that's what I meant with "it is a matter of declaring a ogr.OFTString field
> in the target layer definition"
> That's what is done in ogr2ogr.cpp or swig/python/samples/ogr2ogr.py

right, solved. Thanks for super quick help! Martin

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From stefan.ziegler.de at gmail.com  Mon Oct 13 12:19:10 2014
From: stefan.ziegler.de at gmail.com (Stefan Ziegler)
Date: Mon, 13 Oct 2014 21:19:10 +0200
Subject: [gdal-dev] gdalwarp with cutline, sql and geopackage
Message-ID: <CAJvo+18viLpejgNbZcuXrALG-k7ORc7CeEWFS_pWO=FhSMfHJw@mail.gmail.com>

Hi

I'm trying to clip a raster with a vector layer from a geopackage file. The
vector layer needs to be buffered before. The clipping works without
buffering:

gdalwarp -overwrite -wm 1024 -dstalpha -cutline
'administrative_grenzen.gpkg'  -csql 'SELECT geom FROM kantonsgrenzen WHERE
KANTONSNUM = 11' -co 'COMPRESS=LZW' -co 'TILED=YES'
/tmp/bpav5000f_1067-41_tmp.tif  /tmp/bpav5000f_1067-41.tif

When I try to buffer (ST_Buffer(geom)) the vector layer I get a "no such
function" error. Is there another way to achieve this? Or would it work
with a "dialect" option (like in ogr2ogr)?

best regards
Stefan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141013/8e46cdc3/attachment.html>

From even.rouault at spatialys.com  Mon Oct 13 14:05:02 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 13 Oct 2014 23:05:02 +0200
Subject: [gdal-dev] gdalwarp with cutline, sql and geopackage
In-Reply-To: <CAJvo+18viLpejgNbZcuXrALG-k7ORc7CeEWFS_pWO=FhSMfHJw@mail.gmail.com>
References: <CAJvo+18viLpejgNbZcuXrALG-k7ORc7CeEWFS_pWO=FhSMfHJw@mail.gmail.com>
Message-ID: <4198265.hkGC3KsAVN@even-n550jk>

On Monday 13 October 2014 21:19:10 Stefan Ziegler wrote:
> Hi
> 
> I'm trying to clip a raster with a vector layer from a geopackage file. The
> vector layer needs to be buffered before. The clipping works without
> buffering:
> 
> gdalwarp -overwrite -wm 1024 -dstalpha -cutline
> 'administrative_grenzen.gpkg'  -csql 'SELECT geom FROM kantonsgrenzen WHERE
> KANTONSNUM = 11' -co 'COMPRESS=LZW' -co 'TILED=YES'
> /tmp/bpav5000f_1067-41_tmp.tif  /tmp/bpav5000f_1067-41.tif
> 
> When I try to buffer (ST_Buffer(geom)) the vector layer I get a "no such
> function" error. Is there another way to achieve this? Or would it work
> with a "dialect" option (like in ogr2ogr)?

Yes, it would need to have a dialect option. Currently the SQL is run with the 
default dialect. The workaround is easy : use ogr2ogr to produce a temporary 
dataset with the buffered geometry and use it as the cutline of gdalwarp.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From landa.martin at gmail.com  Tue Oct 14 01:53:59 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Tue, 14 Oct 2014 10:53:59 +0200
Subject: [gdal-dev] StringList and Esri Shapefile
In-Reply-To: <CA+Ei1OfZQ1v+JVuKBk0hxfLVfOnwHEOdQokmRk4hFH7gGppEOw@mail.gmail.com>
References: <CA+Ei1Of5kjnRbbGoUnNXCi14Eiju4gv=SRBihdFBkCa0KcsVhQ@mail.gmail.com>
	<CA+Ei1OeVpWn2QPH8LW3KjeoHsRvjL5cGzrnhLDsCZd70y1hZRA@mail.gmail.com>
	<CA+Ei1OeFo61pKMa8gnFshcOmKZEuEn7wQtWop0-6CMuvdYsNHA@mail.gmail.com>
	<2532801.ArUyrT30Tx@even-n550jk>
	<CA+Ei1OfZQ1v+JVuKBk0hxfLVfOnwHEOdQokmRk4hFH7gGppEOw@mail.gmail.com>
Message-ID: <CA+Ei1OdeA4kNQ+dvwK2kUYj3n-TES3quC5PpLJQ_cJYzLZ6zLw@mail.gmail.com>

Hi,

2014-10-13 18:30 GMT+02:00 Martin Landa <landa.martin at gmail.com>:

I have another problem with Esri Shapefile format probably not related
to the originally reported issue. When converting data (GML)

OGRFeature(Parcely):0
  gml_id (String) = PA.2561191602
  Id (String) = 2561191602
  Nespravny (String) = (null)
  KmenoveCislo (Integer) = 162
  PododdeleniCisla (Integer) = 2

to Esri Shapefile I get

OGRFeature(parcely):0
  gml_id (String) = PA.2561191602
  Id (String) = 2561191602
  Nespravny (String) = (null)
  KmenoveCis (Integer) = (null)
  Pododdelen (Integer) = (null)

So missed 'KmenoveCislo/KmenoveCis'. Converting the same data using
ogr2ogr works.

But the same Python script works well when converting data eg. to PostGIS:

OGRFeature(parcely):1
  gml_id (String) = PA.2561191602
  id (String) = 2561191602
  nespravny (String) = (null)
  kmenovecislo (Integer) = 162
  pododdelenicisla (Integer) = 2


Critical part of the code:

"""
ofeature = ogr.Feature(olayer.GetLayerDefn())
ofeature.SetFrom(feature)
...
olayer.CreateFeature(ofeature)
"""

Any idea what could be wrong? Thanks in advance! Martin

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From bontepaarden at gmail.com  Tue Oct 14 02:22:20 2014
From: bontepaarden at gmail.com (Paul Meems)
Date: Tue, 14 Oct 2014 11:22:20 +0200
Subject: [gdal-dev] StringList and Esri Shapefile
In-Reply-To: <CA+Ei1OdeA4kNQ+dvwK2kUYj3n-TES3quC5PpLJQ_cJYzLZ6zLw@mail.gmail.com>
References: <CA+Ei1Of5kjnRbbGoUnNXCi14Eiju4gv=SRBihdFBkCa0KcsVhQ@mail.gmail.com>
	<CA+Ei1OeVpWn2QPH8LW3KjeoHsRvjL5cGzrnhLDsCZd70y1hZRA@mail.gmail.com>
	<CA+Ei1OeFo61pKMa8gnFshcOmKZEuEn7wQtWop0-6CMuvdYsNHA@mail.gmail.com>
	<2532801.ArUyrT30Tx@even-n550jk>
	<CA+Ei1OfZQ1v+JVuKBk0hxfLVfOnwHEOdQokmRk4hFH7gGppEOw@mail.gmail.com>
	<CA+Ei1OdeA4kNQ+dvwK2kUYj3n-TES3quC5PpLJQ_cJYzLZ6zLw@mail.gmail.com>
Message-ID: <CAHNf2YQ8_ixnnuiH5r=A+DSEUF36H0fMkpdeBr9sZJVuHegKPw@mail.gmail.com>

Hi Martin,

For ESRI shapefiles to max size of fieldnames is 10, so it is truncated.



Paul

*Paul Meems *
Release manager, configuration manager
and forum moderator of MapWindow GIS.
www.mapwindow.org

Owner of MapWindow.nl - Support for
Dutch speaking users.
www.mapwindow.nl



*The English presentations of the MapWindow GIS Conference 2014 are online.
<http://www.slideshare.net/mapwindow>*

2014-10-14 10:53 GMT+02:00 Martin Landa <landa.martin at gmail.com>:

> Hi,
>
> 2014-10-13 18:30 GMT+02:00 Martin Landa <landa.martin at gmail.com>:
>
> I have another problem with Esri Shapefile format probably not related
> to the originally reported issue. When converting data (GML)
>
> OGRFeature(Parcely):0
>   gml_id (String) = PA.2561191602
>   Id (String) = 2561191602
>   Nespravny (String) = (null)
>   KmenoveCislo (Integer) = 162
>   PododdeleniCisla (Integer) = 2
>
> to Esri Shapefile I get
>
> OGRFeature(parcely):0
>   gml_id (String) = PA.2561191602
>   Id (String) = 2561191602
>   Nespravny (String) = (null)
>   KmenoveCis (Integer) = (null)
>   Pododdelen (Integer) = (null)
>
> So missed 'KmenoveCislo/KmenoveCis'. Converting the same data using
> ogr2ogr works.
>
> But the same Python script works well when converting data eg. to PostGIS:
>
> OGRFeature(parcely):1
>   gml_id (String) = PA.2561191602
>   id (String) = 2561191602
>   nespravny (String) = (null)
>   kmenovecislo (Integer) = 162
>   pododdelenicisla (Integer) = 2
>
>
> Critical part of the code:
>
> """
> ofeature = ogr.Feature(olayer.GetLayerDefn())
> ofeature.SetFrom(feature)
> ...
> olayer.CreateFeature(ofeature)
> """
>
> Any idea what could be wrong? Thanks in advance! Martin
>
> --
> Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141014/d677b908/attachment.html>

From landa.martin at gmail.com  Tue Oct 14 02:28:19 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Tue, 14 Oct 2014 11:28:19 +0200
Subject: [gdal-dev] StringList and Esri Shapefile
In-Reply-To: <CAHNf2YQ8_ixnnuiH5r=A+DSEUF36H0fMkpdeBr9sZJVuHegKPw@mail.gmail.com>
References: <CA+Ei1Of5kjnRbbGoUnNXCi14Eiju4gv=SRBihdFBkCa0KcsVhQ@mail.gmail.com>
	<CA+Ei1OeVpWn2QPH8LW3KjeoHsRvjL5cGzrnhLDsCZd70y1hZRA@mail.gmail.com>
	<CA+Ei1OeFo61pKMa8gnFshcOmKZEuEn7wQtWop0-6CMuvdYsNHA@mail.gmail.com>
	<2532801.ArUyrT30Tx@even-n550jk>
	<CA+Ei1OfZQ1v+JVuKBk0hxfLVfOnwHEOdQokmRk4hFH7gGppEOw@mail.gmail.com>
	<CA+Ei1OdeA4kNQ+dvwK2kUYj3n-TES3quC5PpLJQ_cJYzLZ6zLw@mail.gmail.com>
	<CAHNf2YQ8_ixnnuiH5r=A+DSEUF36H0fMkpdeBr9sZJVuHegKPw@mail.gmail.com>
Message-ID: <CA+Ei1OdhjVQpph6A9DA0gzj_NMCji8z_Rc+pT5F8c6QXA-4JBg@mail.gmail.com>

Hi,

2014-10-14 11:22 GMT+02:00 Paul Meems <bontepaarden at gmail.com>:

> For ESRI shapefiles to max size of fieldnames is 10, so it is truncated.

I know. I am referring to something different - missing values.

Input:

  KmenoveCislo (Integer) = 162

Output (Esri Shapefile):

  KmenoveCis (Integer) = (null)

Martin

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From even.rouault at spatialys.com  Tue Oct 14 02:35:01 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 14 Oct 2014 11:35:01 +0200
Subject: [gdal-dev] StringList and Esri Shapefile
In-Reply-To: <CA+Ei1OdhjVQpph6A9DA0gzj_NMCji8z_Rc+pT5F8c6QXA-4JBg@mail.gmail.com>
References: <CA+Ei1Of5kjnRbbGoUnNXCi14Eiju4gv=SRBihdFBkCa0KcsVhQ@mail.gmail.com>
	<CAHNf2YQ8_ixnnuiH5r=A+DSEUF36H0fMkpdeBr9sZJVuHegKPw@mail.gmail.com>
	<CA+Ei1OdhjVQpph6A9DA0gzj_NMCji8z_Rc+pT5F8c6QXA-4JBg@mail.gmail.com>
Message-ID: <6229078.8gNXdOcXu5@even-n550jk>

On Tuesday 14 October 2014 11:28:19 Martin Landa wrote:
> Hi,
> 
> 2014-10-14 11:22 GMT+02:00 Paul Meems <bontepaarden at gmail.com>:
> > For ESRI shapefiles to max size of fieldnames is 10, so it is truncated.

Paul indeed identified the issue. If you use SetFrom(), it will not manage to 
match the target field names with the source ones, because CreateField() has 
done the field name truncation. ogr2ogr builds an integer map from the source 
field index to the target field index and uses SetFromWithMap(). You can have a 
look at swig/python/samples/ogr2ogr.py.
In the simple case (for drivers that don't have compulsory fields already 
created at layer creation), the map is the identity, i.e. panMap[i] = i with i 
from 0 to nFieldCount - 1.

> 
> I know. I am referring to something different - missing values.
> 
> Input:
> 
>   KmenoveCislo (Integer) = 162
> 
> Output (Esri Shapefile):
> 
>   KmenoveCis (Integer) = (null)
> 
> Martin

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From landa.martin at gmail.com  Tue Oct 14 09:28:06 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Tue, 14 Oct 2014 18:28:06 +0200
Subject: [gdal-dev] StringList and Esri Shapefile
In-Reply-To: <6229078.8gNXdOcXu5@even-n550jk>
References: <CA+Ei1Of5kjnRbbGoUnNXCi14Eiju4gv=SRBihdFBkCa0KcsVhQ@mail.gmail.com>
	<CAHNf2YQ8_ixnnuiH5r=A+DSEUF36H0fMkpdeBr9sZJVuHegKPw@mail.gmail.com>
	<CA+Ei1OdhjVQpph6A9DA0gzj_NMCji8z_Rc+pT5F8c6QXA-4JBg@mail.gmail.com>
	<6229078.8gNXdOcXu5@even-n550jk>
Message-ID: <CA+Ei1OcnRgTU1+k3Tn3783iKKRczHWcC13Zv9Em0H-8OTU29ZQ@mail.gmail.com>

Hi,

2014-10-14 11:35 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
> Paul indeed identified the issue. If you use SetFrom(), it will not manage to
> match the target field names with the source ones, because CreateField() has
> done the field name truncation. ogr2ogr builds an integer map from the source
> field index to the target field index and uses SetFromWithMap(). You can have a
> look at swig/python/samples/ogr2ogr.py.
> In the simple case (for drivers that don't have compulsory fields already
> created at layer creation), the map is the identity, i.e. panMap[i] = i with i
> from 0 to nFieldCount - 1.

thanks a lot! It helped... Martin

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From jgrn at illinois.edu  Tue Oct 14 11:12:00 2014
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Tue, 14 Oct 2014 13:12:00 -0500
Subject: [gdal-dev] Problems with HDF4
Message-ID: <CABG0rfv0_9qRih=ZZhHZJbnzxwe_g+JoUt=+fsA6_D9u9Ra28A@mail.gmail.com>

Gdallers:

I'm having some issues with a source-built GDAL's support of HDF4 on a
Linux box.  I've repeated this with both GDAL 1.10.1 and 1.11.1.  The
HDF is a landsat HDF:

@server> gdalinfo "/pathro/lndsr.LT51950531990333ESA00.hdf"
ERROR 4: Failed to open HDF4 file
"/pathto/lndsr.LT51950531990333ESA00.hdf" for SDS reading.

gdalinfo failed - unable to open '/pathto/lndsr.LT51950531990333ESA00.hdf'.

What is weird is that the install of both HDF4 and GDAL appeared to
work correctly.  Certainly gdalinfo --formats lists HDF4 as one of the
working formats.  The configure script I used for HDF4 was:

./configure --prefix=/usr/apps/oa --with-pic
--with-jpeg=/usr/apps/oa/lib --with-zlib=/usr/apps/oa/lib
--disable-fortran --disable-netcdf

And for GDAL:
./configure --prefix=/usr/apps/oa/ --with-python --without-sqlite3

Any ideas?

--j

-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Department of Geography and Geographic Information Science
University of Illinois at Urbana-Champaign
259 Computing Applications Building, MC-150
605 East Springfield Avenue
Champaign, IL  61820-6371
Phone: 217-300-1924
http://www.geog.illinois.edu/~jgrn/
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007

From j.tosovsky at email.cz  Tue Oct 14 12:51:38 2014
From: j.tosovsky at email.cz (Jan Tosovsky)
Date: Tue, 14 Oct 2014 21:51:38 +0200
Subject: [gdal-dev] gdal2tiles - incorrect corner coordinates
Message-ID: <01c801cfe7e8$464e4fc0$d2eaef40$@tosovsky@email.cz>

Dear All,

when producing GeoTiff tiles from large GeoTiff that contains Corner
Coordinates:
Upper Left  ( 1558426.488, 6800200.793) ( 13d59'58.50"E, 52d 0' 1.50"N)
Lower Left  ( 1558426.488, 6446209.776) ( 13d59'58.50"E, 49d59'58.63"N)
Upper Right ( 2003776.864, 6800200.793) ( 18d 0' 0.84"E, 52d 0' 1.50"N)
Lower Right ( 2003776.864, 6446209.776) ( 18d 0' 0.84"E, 49d59'58.63"N)

I am getting tiles with Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0,  256.0)
Upper Right (  256.0,    0.0)
Lower Right (  256.0,  256.0)

I would expect that every tile contains a subset of the original coords.

My command (GDAL 1.11.0):
gdal2tiles.py -v -z 6-7 warped.tif D:\OUTPUT

How can I fix this?

Thanks, Jan


From jukka.rahkonen at mmmtike.fi  Tue Oct 14 14:17:53 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Tue, 14 Oct 2014 21:17:53 +0000 (UTC)
Subject: [gdal-dev] gdal2tiles - incorrect corner coordinates
References: <14308.4961608567$1413316324@news.gmane.org>
Message-ID: <loom.20141014T230806-95@post.gmane.org>

Jan Tosovsky <j.tosovsky <at> email.cz> writes:

> 
> Dear All,
> 
> when producing GeoTiff tiles from large GeoTiff that contains Corner
> Coordinates:
> Upper Left  ( 1558426.488, 6800200.793) ( 13d59'58.50"E, 52d 0' 1.50"N)
> Lower Left  ( 1558426.488, 6446209.776) ( 13d59'58.50"E, 49d59'58.63"N)
> Upper Right ( 2003776.864, 6800200.793) ( 18d 0' 0.84"E, 52d 0' 1.50"N)
> Lower Right ( 2003776.864, 6446209.776) ( 18d 0' 0.84"E, 49d59'58.63"N)
> 
> I am getting tiles with Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0,  256.0)
> Upper Right (  256.0,    0.0)
> Lower Right (  256.0,  256.0)
> 
> I would expect that every tile contains a subset of the original coords.
> 
> My command (GDAL 1.11.0):
> gdal2tiles.py -v -z 6-7 warped.tif D:\OUTPUT
> 
> How can I fix this?

Hi,

You have wrong assumption about how gdal2tiles work. It does not create
tiles which are individually georeferenced. Instead, it creates images and
saves them to a directory structure which is well defined and whose metadata
is published. In the documentation http://www.gdal.org/gdal2tiles.html it is
written as "This utility generates a directory with small tiles and
metadata, following the OSGeo Tile Map Service Specification". Similarly
this OpenStreetMap tile is not georeferenced
http://a.tile.openstreetmap.org/9/281/172.png. However, the tiling schema is
known and because of that it is possible to know where tile number
9/281/172.png belongs.

-Jukka Rahkonen-




From jaadfoo at gmail.com  Tue Oct 14 15:52:27 2014
From: jaadfoo at gmail.com (Jamie Adams)
Date: Tue, 14 Oct 2014 15:52:27 -0700
Subject: [gdal-dev] Conversion from ASCII to GeoTIFF with gdalwarp:
 incorrect output
In-Reply-To: <DUB120-W232C1323029BAFA11D0AC8FAF0@phx.gbl>
References: <DUB120-W232C1323029BAFA11D0AC8FAF0@phx.gbl>
Message-ID: <CAGJMTBe3mBsFJASM34XZhqC8WU1uhsMEZg=H16TV41rMvttgpQ@mail.gmail.com>

I would use the CENTER_LONG config argument.  That will extend the raster
past the -180/180 boundary depending on which side you want to extend.

--config CENTER_LONG 180
Upper Left  ( 176.0010322, -16.1523859) (176d 0' 3.72"E, 16d 9' 8.59"S)
Lower Left  ( 176.0010322, -18.2685614) (176d 0' 3.72"E, 18d16' 6.82"S)
Upper Right (     181.182,     -16.152) (181d10'55.25"E, 16d 9' 8.59"S)
Lower Right (     181.182,     -18.269) (181d10'55.25"E, 18d16' 6.82"S)

--config CENTER_LONG -180
Upper Left  (    -183.999,     -16.152) (183d59'56.28"W, 16d 9' 8.59"S)
Lower Left  (    -183.999,     -18.269) (183d59'56.28"W, 18d16' 6.82"S)
Upper Right (-178.8179863, -16.1523859) (178d49' 4.75"W, 16d 9' 8.59"S)
Lower Right (-178.8179863, -18.2685614) (178d49' 4.75"W, 18d16' 6.82"S)


On Sun, Oct 12, 2014 at 1:43 PM, Lukasz Tracewski <
lukasz.tracewski at outlook.com> wrote:

> Hi,
>
> I have a few thousands of ESRI ASCII rasters in World_Mollweide
> (EPSG:54009) projection, which I need to convert to GeoTIFF. Usually it
> goes fine, but there are certain special cases that resist peaceful
> conversion. They are all placed on Fiji, which is special in a sense being
> on very border of a world's map. Problem is that in those cases somehow
> output is completely messed up, with incorrect resolution.
>
> Here is how I do the conversion:
> gdalwarp -s_srs '+proj=moll +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84
> +datum=WGS84 +units=m no_defs' -t_srs EPSG:4326 -co NBITS=1 -co
> COMPRESS=CCITTRLE -co PHOTOMETRIC=MINISWHITE -ot Byte $ascfile $newname
>
> My ASCII files are bilevel, with 0 and 1 only.
>
> Here is an example of a problematic ASCII:
>
> https://drive.google.com/file/d/0B46Cy3WOKgyJYVdMLWV0OGFJQ2M/view?usp=sharing
>
> That will produce GeoTIFF with only 3 pixels in latitude:
>
> https://drive.google.com/file/d/0B46Cy3WOKgyJTnoxSHdyaUR5cWs/view?usp=sharing
>
> Thing is if I crop the ASCII in QGIS to include only left side of the
> image, then it's fine. If I take the right side, then again I get incorrect
> output.
>
> Any ideas?
>
> Cheers,
> Lucas
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141014/3eaabd6a/attachment.html>

From ljvillarin30 at gmail.com  Wed Oct 15 02:05:27 2014
From: ljvillarin30 at gmail.com (Love)
Date: Wed, 15 Oct 2014 17:05:27 +0800
Subject: [gdal-dev] Batch Process: Check for newest files then Batch Project
 the newest files added to a directory and Make it automated
Message-ID: <CAMZEyL4cW3Qkrp1YyQWFw7NuUv9yAsYbNGahh1K-22GD8KK+TQ@mail.gmail.com>

How will I do this in batch process:

I have bunch of hdf files downloaded from the ftp and saved to a directory,
and in everyday there are newest files added to the ftp available for
download, then I'll download those newest files . Now, how will I check if
there are new files added to the hdf directory(directory where I saved the
downloaded files)? And then, if there are new files added how will I batch
project those new files only?If there were no new files, just do nothing or
a prompt will just appear indicating that there are no new files?
Any help will be much appreciated.

Here is the script for the projection:

gdalwarp -geoloc -t_srs "+proj=longlat +datum=WGS84" -te 113.205 1.120
157.105 2.005 HDF4_SDS:hdf:"A2001017054000.L2_LAC.sample.hdf":01 sample.tif
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141015/f6f03f99/attachment.html>

From jgrn at illinois.edu  Wed Oct 15 06:53:55 2014
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Wed, 15 Oct 2014 08:53:55 -0500
Subject: [gdal-dev] Problems with HDF4
In-Reply-To: <CABG0rfv0_9qRih=ZZhHZJbnzxwe_g+JoUt=+fsA6_D9u9Ra28A@mail.gmail.com>
References: <CABG0rfv0_9qRih=ZZhHZJbnzxwe_g+JoUt=+fsA6_D9u9Ra28A@mail.gmail.com>
Message-ID: <CABG0rfvds-FPpTxKozU54CHs4AuCQYzcpNM43Pd2p-ewGRUXrw@mail.gmail.com>

Ok, to follow up I got it figured out -- I needed to configure
--enable-shared for HDF4:

./configure --disable-fortran --disable-netcdf --enable-shared

It turns out I have another piece of software that required the HDF4
fortran libraries (which can't exist along with a shared library
install), so the two conflict with one another.  I'll install two
versions moving forward, unless someone has a better solution!

Reference: http://www.hdfgroup.org/HDF-FAQ.html#11share

--j

On Tue, Oct 14, 2014 at 1:12 PM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
> Gdallers:
>
> I'm having some issues with a source-built GDAL's support of HDF4 on a
> Linux box.  I've repeated this with both GDAL 1.10.1 and 1.11.1.  The
> HDF is a landsat HDF:
>
> @server> gdalinfo "/pathro/lndsr.LT51950531990333ESA00.hdf"
> ERROR 4: Failed to open HDF4 file
> "/pathto/lndsr.LT51950531990333ESA00.hdf" for SDS reading.
>
> gdalinfo failed - unable to open '/pathto/lndsr.LT51950531990333ESA00.hdf'.
>
> What is weird is that the install of both HDF4 and GDAL appeared to
> work correctly.  Certainly gdalinfo --formats lists HDF4 as one of the
> working formats.  The configure script I used for HDF4 was:
>
> ./configure --prefix=/usr/apps/oa --with-pic
> --with-jpeg=/usr/apps/oa/lib --with-zlib=/usr/apps/oa/lib
> --disable-fortran --disable-netcdf
>
> And for GDAL:
> ./configure --prefix=/usr/apps/oa/ --with-python --without-sqlite3
>
> Any ideas?
>
> --j
>
> --
> Jonathan A. Greenberg, PhD
> Assistant Professor
> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
> Department of Geography and Geographic Information Science
> University of Illinois at Urbana-Champaign
> 259 Computing Applications Building, MC-150
> 605 East Springfield Avenue
> Champaign, IL  61820-6371
> Phone: 217-300-1924
> http://www.geog.illinois.edu/~jgrn/
> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007



-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Department of Geography and Geographic Information Science
University of Illinois at Urbana-Champaign
259 Computing Applications Building, MC-150
605 East Springfield Avenue
Champaign, IL  61820-6371
Phone: 217-300-1924
http://www.geog.illinois.edu/~jgrn/
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007

From Martin.Lewis at euro.ngc.com  Wed Oct 15 07:30:19 2014
From: Martin.Lewis at euro.ngc.com (M Lewis)
Date: Wed, 15 Oct 2014 07:30:19 -0700 (PDT)
Subject: [gdal-dev] Remove Black Areas From Rotated Images
Message-ID: <1413383419233-5167665.post@n6.nabble.com>

I have searched and found lots of similar queries but nothing that quite
gives me the answer that I am looking for (as they all appear to be related
to gdal_translate rather than the C++ API.)

We have a set of strips of grey scale satellite imagery that are rotated.

I use AutoCreateWarpedVRT to generate a 'north-up' image that is converted
to a bitmap and displayed to the user.
When displayed the image has a black area surrounding it which tends to mask
other images that tile alongside.

>From searching around I assume it is to do with the GDALWarpOptions that can
be passed to the AutoCreateWarpedVRT function but the 'no-data' value of the
dataset when queried fails and just returns a default of -10000.0. 
Therefore I am unsure of what to set in the padfDstNoDataReal etc variables
to mask out the areas where there is no data.

The image is grey scale, the 'non-data' areas come out as black once the
image is returned from the RasterIO call so it makes it difficult to
post-process the image data.

Anybody got any tips on the way to do this and maybe set up the
GDALWarpOptions to pass to the AutoCreateWarpedVRT function? 
Is it even possible on a grey-scale dataset with no 'no-data' value?

Thanks

Martin




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Remove-Black-Areas-From-Rotated-Images-tp5167665.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Wed Oct 15 08:02:29 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 15 Oct 2014 17:02:29 +0200
Subject: [gdal-dev] Remove Black Areas From Rotated Images
In-Reply-To: <1413383419233-5167665.post@n6.nabble.com>
References: <1413383419233-5167665.post@n6.nabble.com>
Message-ID: <201410151702.29970.even.rouault@spatialys.com>

Le mercredi 15 octobre 2014 16:30:19, M Lewis a ?crit :
> I have searched and found lots of similar queries but nothing that quite
> gives me the answer that I am looking for (as they all appear to be related
> to gdal_translate rather than the C++ API.)
> 
> We have a set of strips of grey scale satellite imagery that are rotated.
> 
> I use AutoCreateWarpedVRT to generate a 'north-up' image that is converted
> to a bitmap and displayed to the user.
> When displayed the image has a black area surrounding it which tends to
> mask other images that tile alongside.
> 
> From searching around I assume it is to do with the GDALWarpOptions that
> can be passed to the AutoCreateWarpedVRT function but the 'no-data' value
> of the dataset when queried fails and just returns a default of -10000.0.
> Therefore I am unsure of what to set in the padfDstNoDataReal etc
> variables to mask out the areas where there is no data.
> 
> The image is grey scale, the 'non-data' areas come out as black once the
> image is returned from the RasterIO call so it makes it difficult to
> post-process the image data.
> 
> Anybody got any tips on the way to do this and maybe set up the
> GDALWarpOptions to pass to the AutoCreateWarpedVRT function?
> Is it even possible on a grey-scale dataset with no 'no-data' value?

You can try assigning 0 in padfDstNoDataReal AND assigning 0 as nodata value 
to the dataset returned by AutoCreateWarpedVRT() with 
ds.GetRasterBand(1).SetNoDataValue(0)

> 
> Thanks
> 
> Martin
> 
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/Remove-Black-Areas-From-Rotated-Images
> -tp5167665.html Sent from the GDAL - Dev mailing list archive at
> Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gdal-ml at hasenohr.eu  Wed Oct 15 12:19:37 2014
From: gdal-ml at hasenohr.eu (Paul Hasenohr)
Date: Wed, 15 Oct 2014 21:19:37 +0200
Subject: [gdal-dev] JP2 files created with JP2OpenJPEG can only have 1 or 3
	bands?
Message-ID: <543EC8C9.4060902@hasenohr.eu>

Hello,

I just compiled gdal-1.11.1 with support for jpeg2000 through OpenJPEG 
and wanted to convert a 4 bands TIFF file (with LZW compression) into a 
lossless JP2 file.
While attempting to run gdal_translate, I received this error message 
ERROR 6: Unable to export files with 4 bands

Looking at the file openjpegdataset.cpp [1], it seems that CreateCopy() 
only supports 1 band and 3 bands files. The option for 4 bands is even 
commented out. What is the reason for this?
Would it be possible to support the creation of JPEG2000 of any number 
of bands?
Can I safely enable the creation of 4 bands files?

I want to create GMLJP2 files as it is one option suggested by the 
INSPIRE technical guidelines on orthoimagery and I would like to use 
GDAL for this.

Thank you for your support.

Best regards,
Paul Hasenohr

[1] https://svn.osgeo.org/gdal/trunk/gdal/frmts/openjpeg/openjpegdataset.cpp

From even.rouault at spatialys.com  Wed Oct 15 12:48:06 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 15 Oct 2014 21:48:06 +0200
Subject: [gdal-dev] JP2 files created with JP2OpenJPEG can only have 1
	or 3 bands?
In-Reply-To: <543EC8C9.4060902@hasenohr.eu>
References: <543EC8C9.4060902@hasenohr.eu>
Message-ID: <201410152148.06984.even.rouault@spatialys.com>

Le mercredi 15 octobre 2014 21:19:37, Paul Hasenohr a ?crit :
> Hello,
> 
> I just compiled gdal-1.11.1 with support for jpeg2000 through OpenJPEG
> and wanted to convert a 4 bands TIFF file (with LZW compression) into a
> lossless JP2 file.
> While attempting to run gdal_translate, I received this error message
> ERROR 6: Unable to export files with 4 bands
> 
> Looking at the file openjpegdataset.cpp [1], it seems that CreateCopy()
> only supports 1 band and 3 bands files. The option for 4 bands is even
> commented out. What is the reason for this?
> Would it be possible to support the creation of JPEG2000 of any number
> of bands?
> Can I safely enable the creation of 4 bands files?

I tested that recently and it mostly works except that the alpha band is not 
correctly declared as alpha band, so other JPEG2000 codecs will see it as a 
"unknown" band. I couldn't find in the openjpeg API how to declare an alpha 
band. This would likely involved writing the appropriate information in a JP2 
box.

> 
> I want to create GMLJP2 files as it is one option suggested by the
> INSPIRE technical guidelines on orthoimagery and I would like to use
> GDAL for this.
> 
> Thank you for your support.
> 
> Best regards,
> Paul Hasenohr
> 
> [1]
> https://svn.osgeo.org/gdal/trunk/gdal/frmts/openjpeg/openjpegdataset.cpp
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gdal-ml at hasenohr.eu  Wed Oct 15 13:03:32 2014
From: gdal-ml at hasenohr.eu (Paul Hasenohr)
Date: Wed, 15 Oct 2014 22:03:32 +0200
Subject: [gdal-dev] JP2 files created with JP2OpenJPEG can only have 1
 or 3 bands?
In-Reply-To: <201410152148.06984.even.rouault@spatialys.com>
References: <543EC8C9.4060902@hasenohr.eu>
	<201410152148.06984.even.rouault@spatialys.com>
Message-ID: <543ED314.2030800@hasenohr.eu>

Hello Even,

Thank you for your answer.

In fact in my case, this 4th band is for a Near Infra Red channel so I 
definitely do not want to have it labelled as alpha!
But I will have other satellite images with more than 4 bands (plus 
possibly an alpha band). Would it be possible to simply remove this 
check on the number of bands in CreateCopy()?

Thanks,
Paul

On 15/10/14 21:48, Even Rouault wrote:
> Le mercredi 15 octobre 2014 21:19:37, Paul Hasenohr a ?crit :
>> Hello,
>>
>> I just compiled gdal-1.11.1 with support for jpeg2000 through OpenJPEG
>> and wanted to convert a 4 bands TIFF file (with LZW compression) into a
>> lossless JP2 file.
>> While attempting to run gdal_translate, I received this error message
>> ERROR 6: Unable to export files with 4 bands
>>
>> Looking at the file openjpegdataset.cpp [1], it seems that CreateCopy()
>> only supports 1 band and 3 bands files. The option for 4 bands is even
>> commented out. What is the reason for this?
>> Would it be possible to support the creation of JPEG2000 of any number
>> of bands?
>> Can I safely enable the creation of 4 bands files?
>
> I tested that recently and it mostly works except that the alpha band is not
> correctly declared as alpha band, so other JPEG2000 codecs will see it as a
> "unknown" band. I couldn't find in the openjpeg API how to declare an alpha
> band. This would likely involved writing the appropriate information in a JP2
> box.
>
>>
>> I want to create GMLJP2 files as it is one option suggested by the
>> INSPIRE technical guidelines on orthoimagery and I would like to use
>> GDAL for this.
>>
>> Thank you for your support.
>>
>> Best regards,
>> Paul Hasenohr
>>
>> [1]
>> https://svn.osgeo.org/gdal/trunk/gdal/frmts/openjpeg/openjpegdataset.cpp
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>

From even.rouault at spatialys.com  Wed Oct 15 13:06:07 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 15 Oct 2014 22:06:07 +0200
Subject: [gdal-dev] JP2 files created with JP2OpenJPEG can only have 1
	or 3 bands?
In-Reply-To: <543ED314.2030800@hasenohr.eu>
References: <543EC8C9.4060902@hasenohr.eu>
	<201410152148.06984.even.rouault@spatialys.com>
	<543ED314.2030800@hasenohr.eu>
Message-ID: <201410152206.07650.even.rouault@spatialys.com>

Le mercredi 15 octobre 2014 22:03:32, Paul Hasenohr a ?crit :
> Hello Even,
> 
> Thank you for your answer.
> 
> In fact in my case, this 4th band is for a Near Infra Red channel so I
> definitely do not want to have it labelled as alpha!
> But I will have other satellite images with more than 4 bands (plus
> possibly an alpha band). Would it be possible to simply remove this
> check on the number of bands in CreateCopy()?

Yes, that should be possible. Please file a ticket in Trac about that.

> 
> Thanks,
> Paul
> 
> On 15/10/14 21:48, Even Rouault wrote:
> > Le mercredi 15 octobre 2014 21:19:37, Paul Hasenohr a ?crit :
> >> Hello,
> >> 
> >> I just compiled gdal-1.11.1 with support for jpeg2000 through OpenJPEG
> >> and wanted to convert a 4 bands TIFF file (with LZW compression) into a
> >> lossless JP2 file.
> >> While attempting to run gdal_translate, I received this error message
> >> ERROR 6: Unable to export files with 4 bands
> >> 
> >> Looking at the file openjpegdataset.cpp [1], it seems that CreateCopy()
> >> only supports 1 band and 3 bands files. The option for 4 bands is even
> >> commented out. What is the reason for this?
> >> Would it be possible to support the creation of JPEG2000 of any number
> >> of bands?
> >> Can I safely enable the creation of 4 bands files?
> > 
> > I tested that recently and it mostly works except that the alpha band is
> > not correctly declared as alpha band, so other JPEG2000 codecs will see
> > it as a "unknown" band. I couldn't find in the openjpeg API how to
> > declare an alpha band. This would likely involved writing the
> > appropriate information in a JP2 box.
> > 
> >> I want to create GMLJP2 files as it is one option suggested by the
> >> INSPIRE technical guidelines on orthoimagery and I would like to use
> >> GDAL for this.
> >> 
> >> Thank you for your support.
> >> 
> >> Best regards,
> >> Paul Hasenohr
> >> 
> >> [1]
> >> https://svn.osgeo.org/gdal/trunk/gdal/frmts/openjpeg/openjpegdataset.cpp
> >> _______________________________________________
> >> gdal-dev mailing list
> >> gdal-dev at lists.osgeo.org
> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From tastle at caris.com  Wed Oct 15 13:09:19 2014
From: tastle at caris.com (Timothy Astle)
Date: Wed, 15 Oct 2014 17:09:19 -0300
Subject: [gdal-dev] URL encode the layer name when constructing the WMS sub
	datasets
Message-ID: <543ED46F.8010607@caris.com>

Does anyone have any thoughts on this minor change to where the URL 
encoding for the layer name is handled?  In the pull request, I've moved 
it so that it is done when the sub dataset URL is created.  It just 
makes things a lot clearer to work with as I know the URL can be treated 
as-is when I get the URL.

https://github.com/OSGeo/gdal/pull/41

I'd appreciate some quick feedback on this approach, because I'd like to 
keep my local build in sync with this projects direction.

Cheers,

-- 
Tim Astle
Development Manager for Web Technologies

*CARIS* <http://www.caris.com>
115 Waggoners Lane
Fredericton, New Brunswick
Canada    E3B 2L4
Tel: +1.506.458.8533     Fax: +1.506.459.3849
www.caris.com <http://www.caris.com>

*Connect with CARIS*
Twitter <http://www.twitter.com/CARIS_GIS> | LinkedIn 
<http://www.linkedin.com/groups?mostPopular=&gid=3217878> | Facebook 
<https://www.facebook.com/pages/CARIS-The-Marine-GIS-Experts/123907500987669?v=app_4949752878> 
| Google+ 
<https://plus.google.com/b/114389770462919844434/114389770462919844434/posts> 
| YouTube <http://www.youtube.com/user/CARISGIS>

Download your free copy of CARIS Easy View today!
www.caris.com/easyview <http://www.caris.com/easyview>

_________________________________________________________________________
This email and any files transmitted with it are confidential and 
intended only for the addressee(s). If you are not the intended 
recipient(s) please notify us by email reply. You should not use, 
disclose, distribute or copy this communication if received in error.

Any views or opinions expressed in this email are solely those of the 
author and do not necessarily represent those of the company. No binding 
contract will result from this email until such time as a written 
document is signed on behalf of the company.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141015/cccf9900/attachment.html>

From Martin.Lewis at euro.ngc.com  Thu Oct 16 01:15:53 2014
From: Martin.Lewis at euro.ngc.com (M Lewis)
Date: Thu, 16 Oct 2014 01:15:53 -0700 (PDT)
Subject: [gdal-dev] Remove Black Areas From Rotated Images
In-Reply-To: <201410151702.29970.even.rouault@spatialys.com>
References: <1413383419233-5167665.post@n6.nabble.com>
	<201410151702.29970.even.rouault@spatialys.com>
Message-ID: <1413447353400-5167762.post@n6.nabble.com>

Thanks Even

I am assuming that even in doing this there may still be an issue with
differentiating between pixels of pure black and this 0 'no-data' value in
an 8 bit band where raster min gives 0 and raster max gives 255.....ah well.

There is another question and I have noticed that the dataset created from
AutoCreateWarpedVRT has different raster min and max values.

One of the rasters (a single UInt16 band, rotated) has a raster min of 337.0
and a raster max of 872.0 when computed using ComputeRasterMinMax().

However the AutoCreateWarpedVRT dataset created from this original dataset
has a min of 0.0 and a max of 772.0, why?????

My plan (using your idea) of setting the no-data value to 0.0 would work on
the original dataset as the minimum is > 0.0 and therefore 0.0 could be
filtered out; however due to the conversion by the AutoCreateWarpedVRT, 0.0
is now a valid colour and once again falls into the issue of whether 0.0 is
'no-data' or a genuine colour.

Thanks

Martin



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Remove-Black-Areas-From-Rotated-Images-tp5167665p5167762.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Thu Oct 16 01:29:43 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 16 Oct 2014 10:29:43 +0200
Subject: [gdal-dev] Remove Black Areas From Rotated Images
In-Reply-To: <1413447353400-5167762.post@n6.nabble.com>
References: <1413383419233-5167665.post@n6.nabble.com>
	<201410151702.29970.even.rouault@spatialys.com>
	<1413447353400-5167762.post@n6.nabble.com>
Message-ID: <201410161029.44135.even.rouault@spatialys.com>

Le jeudi 16 octobre 2014 10:15:53, M Lewis a ?crit :
> Thanks Even
> 
> I am assuming that even in doing this there may still be an issue with
> differentiating between pixels of pure black and this 0 'no-data' value in
> an 8 bit band where raster min gives 0 and raster max gives 255.....ah
> well.
> 
> There is another question and I have noticed that the dataset created from
> AutoCreateWarpedVRT has different raster min and max values.
> 
> One of the rasters (a single UInt16 band, rotated) has a raster min of
> 337.0 and a raster max of 872.0 when computed using ComputeRasterMinMax().
> 
> However the AutoCreateWarpedVRT dataset created from this original dataset
> has a min of 0.0 and a max of 772.0, why?????

The 0's probably come from the black collar ( ComputeRasterMinMax() cannot 
make the difference between valid pixels and the black collar, unless you define 
0 as nodata)
And the different max is probably due to the resampling done when warping that 
misses some pixels (if nearest neighbour) or "average" them. You could play 
with different resampling algorithms.

> 
> My plan (using your idea) of setting the no-data value to 0.0 would work on
> the original dataset as the minimum is > 0.0 and therefore 0.0 could be
> filtered out; however due to the conversion by the AutoCreateWarpedVRT, 0.0
> is now a valid colour and once again falls into the issue of whether 0.0 is
> 'no-data' or a genuine colour.
> 
> Thanks
> 
> Martin
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/Remove-Black-Areas-From-Rotated-Images
> -tp5167665p5167762.html Sent from the GDAL - Dev mailing list archive at
> Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From Martin.Lewis at euro.ngc.com  Thu Oct 16 01:39:15 2014
From: Martin.Lewis at euro.ngc.com (M Lewis)
Date: Thu, 16 Oct 2014 01:39:15 -0700 (PDT)
Subject: [gdal-dev] Remove Black Areas From Rotated Images
In-Reply-To: <201410161029.44135.even.rouault@spatialys.com>
References: <1413383419233-5167665.post@n6.nabble.com>
	<201410151702.29970.even.rouault@spatialys.com>
	<1413447353400-5167762.post@n6.nabble.com>
	<201410161029.44135.even.rouault@spatialys.com>
Message-ID: <1413448755963-5167772.post@n6.nabble.com>

Thanks Even, prompt as ever, I'll give the setting 'no-data' a go.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Remove-Black-Areas-From-Rotated-Images-tp5167665p5167772.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From lukasz.tracewski at outlook.com  Thu Oct 16 10:33:35 2014
From: lukasz.tracewski at outlook.com (Lukasz Tracewski)
Date: Thu, 16 Oct 2014 19:33:35 +0200
Subject: [gdal-dev] Conversion from ASCII to GeoTIFF with gdalwarp:
 incorrect output
In-Reply-To: <CAGJMTBe3mBsFJASM34XZhqC8WU1uhsMEZg=H16TV41rMvttgpQ@mail.gmail.com>
References: <DUB120-W232C1323029BAFA11D0AC8FAF0@phx.gbl>,
	<CAGJMTBe3mBsFJASM34XZhqC8WU1uhsMEZg=H16TV41rMvttgpQ@mail.gmail.com>
Message-ID: <DUB120-W1CCFB40E25F676A215BFD8FAB0@phx.gbl>

Jamie, Andre,
Many thanks for your help and explaining what is happening. I followed Jamie's suggestion (which seemed easiest, since I am a beginner in GIS) and used CENTER_LONG config argument. Worked perfectly!
Lucas

Date: Tue, 14 Oct 2014 15:52:27 -0700
Subject: Re: [gdal-dev] Conversion from ASCII to GeoTIFF with gdalwarp: incorrect output
From: jaadfoo at gmail.com
To: lukasz.tracewski at outlook.com
CC: gdal-dev at lists.osgeo.org

I would use the CENTER_LONG config argument.  That will extend the raster past the -180/180 boundary depending on which side you want to extend.
--config CENTER_LONG 180 
Upper Left  ( 176.0010322, -16.1523859) (176d 0' 3.72"E, 16d 9' 8.59"S)Lower Left  ( 176.0010322, -18.2685614) (176d 0' 3.72"E, 18d16' 6.82"S)Upper Right (     181.182,     -16.152) (181d10'55.25"E, 16d 9' 8.59"S)Lower Right (     181.182,     -18.269) (181d10'55.25"E, 18d16' 6.82"S)
--config CENTER_LONG -180
Upper Left  (    -183.999,     -16.152) (183d59'56.28"W, 16d 9' 8.59"S)Lower Left  (    -183.999,     -18.269) (183d59'56.28"W, 18d16' 6.82"S)Upper Right (-178.8179863, -16.1523859) (178d49' 4.75"W, 16d 9' 8.59"S)Lower Right (-178.8179863, -18.2685614) (178d49' 4.75"W, 18d16' 6.82"S)

On Sun, Oct 12, 2014 at 1:43 PM, Lukasz Tracewski <lukasz.tracewski at outlook.com> wrote:



Hi,
I have a few thousands of ESRI ASCII rasters in World_Mollweide (EPSG:54009) projection, which I need to convert to GeoTIFF. Usually it goes fine, but there are certain special cases that resist peaceful conversion. They are all placed on Fiji, which is special in a sense being on very border of a world's map. Problem is that in those cases somehow output is completely messed up, with incorrect resolution.
Here is how I do the conversion:gdalwarp -s_srs '+proj=moll +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m no_defs' -t_srs EPSG:4326 -co NBITS=1 -co COMPRESS=CCITTRLE -co PHOTOMETRIC=MINISWHITE -ot Byte $ascfile $newname
My ASCII files are bilevel, with 0 and 1 only.
Here is an example of a problematic ASCII:https://drive.google.com/file/d/0B46Cy3WOKgyJYVdMLWV0OGFJQ2M/view?usp=sharing
That will produce GeoTIFF with only 3 pixels in latitude:https://drive.google.com/file/d/0B46Cy3WOKgyJTnoxSHdyaUR5cWs/view?usp=sharing
Thing is if I crop the ASCII in QGIS to include only left side of the image, then it's fine. If I take the right side, then again I get incorrect output. 
Any ideas?
Cheers,Lucas 		 	   		  

_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org

http://lists.osgeo.org/mailman/listinfo/gdal-dev

 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141016/2fca32fb/attachment-0001.html>

From matthias.uden at googlemail.com  Fri Oct 17 11:31:00 2014
From: matthias.uden at googlemail.com (Matthias Uden)
Date: Fri, 17 Oct 2014 20:31:00 +0200
Subject: [gdal-dev] OpenFileGDB 10 MB field description limitation
Message-ID: <54416064.2040600@gmail.com>

Hi list,

I'm running GDAL 1.11.1 on an Ubuntu 14.04.1 64-bit system.

ogr2ogr fails while trying to convert a Feature Class from a rather huge 
FileGDB to a PostGIS table. Unfortunately, I have currently no means to 
access the original GDB file directly.
It gives this error:

ERROR 1: Error occured in filegdbtable.cpp at line 659

Which breaks down to this line of code:

returnErrorIf 
<http://fossies.org/dox/gdal-1.11.1/filegdbtable__priv_8h.html#a2386c8f3b2701f62e44b603c048cab4b>(nFieldDescLength 
 > 10 * 1024 * 1024 || nFieldDescLength < 10 );


By putting in a debug output I figured that the "nFieldDescLength" of my 
feature class is /way/ larger than the maximum allowed value of 10 MB.
In fact it's something around 1.6 GiB.... :-o   (what kind of field 
description is *this*...?)

Does anyone of you have an idea on what exactly the "nFieldDescLength" 
is and - more importantly - why it's limited to 10MB and if further 
increasing this value would do any harm to the overall process? Is a 
field description of 1.6 gigs even realistic at all or is it more likely 
that I have a corrupt input file in some way? Can't I opt to just skip 
the lousy field description import and still import what I'm interested 
in - the /data/ itself?

Apparently there was already a bug ticket for this problem, which led to 
increasing the max. value from 1 to 10 MB [1]
It seems to me this might also be related to the "big file support 
problem" [2] which I thought was resolved in version 1.11.1 [3].

Any help or workaround suggestions are appreciated!
Otherwise I'll have to try if the proprietary ESRI driver can handle 
this... (not tested yet).

Many thanks and best regards,
Matthias

--

[1] - https://trac.osgeo.org/gdal/ticket/5660
[2] - https://trac.osgeo.org/gdal/ticket/5615
[3] - https://trac.osgeo.org/gdal/wiki/Release/1.11.1-News
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141017/c73c9df5/attachment.html>

From even.rouault at spatialys.com  Fri Oct 17 11:52:43 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 17 Oct 2014 20:52:43 +0200
Subject: [gdal-dev] OpenFileGDB 10 MB field description limitation
In-Reply-To: <54416064.2040600@gmail.com>
References: <54416064.2040600@gmail.com>
Message-ID: <201410172052.43418.even.rouault@spatialys.com>

Le vendredi 17 octobre 2014 20:31:00, Matthias Uden a ?crit :
> Hi list,
> 
> I'm running GDAL 1.11.1 on an Ubuntu 14.04.1 64-bit system.
> 
> ogr2ogr fails while trying to convert a Feature Class from a rather huge
> FileGDB to a PostGIS table. Unfortunately, I have currently no means to
> access the original GDB file directly.
> It gives this error:
> 
> ERROR 1: Error occured in filegdbtable.cpp at line 659
> 
> Which breaks down to this line of code:
> 
> returnErrorIf
> <http://fossies.org/dox/gdal-1.11.1/filegdbtable__priv_8h.html#a2386c8f3b27
> 01f62e44b603c048cab4b>(nFieldDescLength
> 
>  > 10 * 1024 * 1024 || nFieldDescLength < 10 );
> 
> By putting in a debug output I figured that the "nFieldDescLength" of my
> feature class is /way/ larger than the maximum allowed value of 10 MB.
> In fact it's something around 1.6 GiB.... :-o   (what kind of field
> description is *this*...?)

Matthias,

This is the size of the area in the table that describe the fields (their name, 
type, etc..). 10 MB is already a huge value (you can likely describe 10000 
attributes or more). If you get 1.6 GB for that field, then something is wrong 
before.

Access to the file for inspection would be needed.

> 
> Does anyone of you have an idea on what exactly the "nFieldDescLength"
> is and - more importantly - why it's limited to 10MB and if further
> increasing this value would do any harm to the overall process?

That could lead to 1.6 GB being allocated in RAM and being read from the file 
(if it's bigger than 1.6 GB), so a bad idea. The sanity check must remain to 
avoid this.

> Is a
> field description of 1.6 gigs even realistic at all or is it more likely
> that I have a corrupt input file in some way?

Perhaps not corrupt, but it potentially exhibits a hole in the reverse 
engineering of the format.

> Can't I opt to just skip
> the lousy field description import and still import what I'm interested
> in - the /data/ itself?
> 
> Apparently there was already a bug ticket for this problem, which led to
> increasing the max. value from 1 to 10 MB [1]

That was just a blind guess, and I'm not convinced it actually helped for the 
ticket mentionned.

> Otherwise I'll have to try if the proprietary ESRI driver can handle 
> this... (not tested yet).

That could be a good hint if the file is corrupt or not. Note: if the GDB is a 
GDB 9.X, then the FGDB SDK driver will not be able to open it.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From sfkeller at gmail.com  Fri Oct 17 15:17:06 2014
From: sfkeller at gmail.com (Stefan Keller)
Date: Sat, 18 Oct 2014 00:17:06 +0200
Subject: [gdal-dev] [Qgis-user] Generating GeoTIFF overview ("gdaladdo
 -r gauss ...") takes days for 2GB file...
In-Reply-To: <96EAE7D042AAC14486D68EC70207B0C14AA4F67D@srsofaioi16255.verw.rootso.org>
References: <CAFcOn2_czXj86raxQW50aveiwaZRXAqUkHkbeko+gjeYLtu3eQ@mail.gmail.com>
	<E6100A0537F18549AC8FCCB5D47FFE355F09AD@EXMBX1.hrw-uk.local>
	<96EAE7D042AAC14486D68EC70207B0C14AA4F67D@srsofaioi16255.verw.rootso.org>
Message-ID: <CAFcOn29MWsOJfbeKmnjJ2KmOTRekcDD4zG66u0OGXOitQGGLtA@mail.gmail.com>

Hoi Stefan

No it doesn'nt need to be gauss resampling method.
We found that GeoTIFF with overview index performs fastest.

Yours, S.

2014-10-13 15:22 GMT+02:00 Ziegler Stefan <Stefan.Ziegler at bd.so.ch>:
> Hi Stefan
>
> Does it need to be "gauss" as resampling method? You can use QGIS' own resampling functionality to get nice raster rendering.
>
> Regards
> Stefan
>
>> -----Urspr?ngliche Nachricht-----
>> Von: qgis-user-bounces at lists.osgeo.org [mailto:qgis-user-bounces at lists.osgeo.org] Im
>> Auftrag von Jonathan Moules
>> Gesendet: Montag, 13. Oktober 2014 15:05
>> An: 'Stefan Keller'; 'gdal-dev at lists.osgeo.org'; 'qgis-user'
>> Betreff: Re: [Qgis-user] Generating GeoTIFF overview ("gdaladdo -r gauss ...") takes
>> days for 2GB file...
>>
>> Hi Stefan,
>> How large is the image? As in, pixel width & height.
>>
>> Also the GDALinfo would be helpful.
>>
>> 7 days is a very long time. I've seen times like that myself for images that were
>> 100,000*50,000 or similar dimensions where there was (still is?) an issue with the
>> pyramiding function in GDAL (it was re-reading the data again and again).
>>
>> Cheers,
>> Jonathan
>>
>> -----Original Message-----
>> From: qgis-user-bounces at lists.osgeo.org [mailto:qgis-user-bounces at lists.osgeo.org]
>> On Behalf Of Stefan Keller
>> Sent: Sunday, October 12, 2014 1:34 PM
>> To: gdal-dev at lists.osgeo.org; qgis-user
>> Subject: [Qgis-user] Generating GeoTIFF overview ("gdaladdo -r gauss ...") takes days
>> for 2GB file...
>>
>> Hi,
>>
>> I have a GeoTIFF file of 2GB size. Now, this question is about gdaladdo and how to
>> optimize loading time of such a large raster file.
>>
>> According to my observations QGIS has fastest loading times when it's a single
>> GeoTIFF file with overview images.
>>
>> Q.1: Does anybody have tipps for even faster solutions loading raster files into in QGIS
>> (prepared by OGR or other preprocessors)?
>>
>> The command "gdaladdo -r gauss C:\SG.tif  2 4 8 16 32 64 128 256"
>> takes actually about 7 days on a Lenovo notebook.
>>
>> Q2.: Any hint's on how to accelerate this (or to other tools generating
>> overviews/pyramids)?
>>
>> Yours, S.
>> _______________________________________________
>> Qgis-user mailing list
>> Qgis-user at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/qgis-user
>>
>>
>> This message has been scanned for viruses by MailControl - www.mailcontrol.com
>>
>>
>>
>> Click
>> https://www.mailcontrol.com/sr/pdM3aunlCjzGX2PQPOmvUgEBY15Clgt1cLVtYJoNw+TFa
>> pmLjYzc0LQlVsaeWay487vQIAp6KUWSPFO0UaI8cQ== to report this email as spam.
>>
>> ________________________________
>>
>> HR Wallingford and its subsidiaries uses faxes and emails for confidential and legally
>> privileged business communications. They do not of themselves create legal
>> commitments. Disclosure to parties other than addressees requires our specific
>> consent. We are not liable for unauthorised disclosures nor reliance upon them.
>> If you have received this message in error please advise us immediately and destroy
>> all copies of it.
>>
>> HR Wallingford Limited
>> Howbery Park, Wallingford, Oxfordshire, OX10 8BA, United Kingdom Registered in
>> England No. 02562099
>>
>> ________________________________
>> _______________________________________________
>> Qgis-user mailing list
>> Qgis-user at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/qgis-user

From sfkeller at gmail.com  Fri Oct 17 15:17:37 2014
From: sfkeller at gmail.com (Stefan Keller)
Date: Sat, 18 Oct 2014 00:17:37 +0200
Subject: [gdal-dev] [Qgis-user] Generating GeoTIFF overview ("gdaladdo
 -r gauss ...") takes days for 2GB file...
In-Reply-To: <E6100A0537F18549AC8FCCB5D47FFE355F09AD@EXMBX1.hrw-uk.local>
References: <CAFcOn2_czXj86raxQW50aveiwaZRXAqUkHkbeko+gjeYLtu3eQ@mail.gmail.com>
	<E6100A0537F18549AC8FCCB5D47FFE355F09AD@EXMBX1.hrw-uk.local>
Message-ID: <CAFcOn28h=gqb5Mz6w6=X6K+RgQCWHY+PH5HGaj8MpV-bqTGeww@mail.gmail.com>

Jonathan

Thanks for asking. See below the output of gdalinfo.

Yours, S.


>gdalinfo zh.tif
Driver: GTiff/GeoTIFF
Files: zh.tif
Size is 152498, 190232
Coordinate System is:
PROJCS["CH1903 / LV03",
    GEOGCS["CH1903",
        DATUM["CH1903",
            SPHEROID["Bessel 1841",6377397.155,299.1528128000009,
                AUTHORITY["EPSG","7004"]],
            TOWGS84[674.4,15.1,405.3,0,0,0,0],
            AUTHORITY["EPSG","6149"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4149"]],
    PROJECTION["Hotine_Oblique_Mercator"],
    PARAMETER["latitude_of_center",46.95240555555556],
    PARAMETER["longitude_of_center",7.439583333333333],
    PARAMETER["azimuth",90],
    PARAMETER["rectified_grid_angle",90],
    PARAMETER["scale_factor",1],
    PARAMETER["false_easting",600000],
    PARAMETER["false_northing",200000],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AUTHORITY["EPSG","21781"]]
Origin = (669243.920000001790000,283343.191250000090000)
Pixel Size = (0.312500368857287,-0.312499428329607)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  COMPRESSION=LZW
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (  669243.920,  283343.191) (  8d21'43.79"E, 47d41'54.41"N)
Lower Left  (  669243.920,  223895.800) (  8d21'10.57"E, 47d 9'49.48"N)
Upper Right (  716899.601,  283343.191) (  8d59'49.11"E, 47d41'30.00"N)
Lower Right (  716899.601,  223895.800) (  8d58'53.05"E, 47d 9'25.32"N)
Center      (  693071.761,  253619.496) (  8d40'24.09"E, 47d25'41.40"N)
Band 1 Block=152498x1 Type=Byte, ColorInterp=Gray
  Min=1.000 Max=255.000
  Minimum=1.000, Maximum=255.000, Mean=231.759, StdDev=73.234
  NoData Value=0
  Overviews: 76249x95116, 38125x47558, 19063x23779, 9532x11890, 4766x5945, 2383x
2973, 1192x1487
  Metadata:
    STATISTICS_MAXIMUM=255
    STATISTICS_MEAN=231.75856617323
    STATISTICS_MINIMUM=1
    STATISTICS_STDDEV=73.233598475527



2014-10-13 15:05 GMT+02:00 Jonathan Moules <J.Moules at hrwallingford.com>:
> Hi Stefan,
> How large is the image? As in, pixel width & height.
>
> Also the GDALinfo would be helpful.
>
> 7 days is a very long time. I've seen times like that myself for images that were 100,000*50,000 or similar dimensions where there was (still is?) an issue with the pyramiding function in GDAL (it was re-reading the data again and again).
>
> Cheers,
> Jonathan
>
> -----Original Message-----
> From: qgis-user-bounces at lists.osgeo.org [mailto:qgis-user-bounces at lists.osgeo.org] On Behalf Of Stefan Keller
> Sent: Sunday, October 12, 2014 1:34 PM
> To: gdal-dev at lists.osgeo.org; qgis-user
> Subject: [Qgis-user] Generating GeoTIFF overview ("gdaladdo -r gauss ...") takes days for 2GB file...
>
> Hi,
>
> I have a GeoTIFF file of 2GB size. Now, this question is about gdaladdo and how to optimize loading time of such a large raster file.
>
> According to my observations QGIS has fastest loading times when it's a single GeoTIFF file with overview images.
>
> Q.1: Does anybody have tipps for even faster solutions loading raster files into in QGIS (prepared by OGR or other preprocessors)?
>
> The command "gdaladdo -r gauss C:\SG.tif  2 4 8 16 32 64 128 256"
> takes actually about 7 days on a Lenovo notebook.
>
> Q2.: Any hint's on how to accelerate this (or to other tools generating overviews/pyramids)?
>
> Yours, S.
> _______________________________________________
> Qgis-user mailing list
> Qgis-user at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/qgis-user
>
>
> This message has been scanned for viruses by MailControl - www.mailcontrol.com
>
>
>
> Click https://www.mailcontrol.com/sr/pdM3aunlCjzGX2PQPOmvUgEBY15Clgt1cLVtYJoNw+TFapmLjYzc0LQlVsaeWay487vQIAp6KUWSPFO0UaI8cQ== to report this email as spam.
>
> ________________________________
>
> HR Wallingford and its subsidiaries uses faxes and emails for confidential and legally privileged business communications. They do not of themselves create legal commitments. Disclosure to parties other than addressees requires our specific consent. We are not liable for unauthorised disclosures nor reliance upon them.
> If you have received this message in error please advise us immediately and destroy all copies of it.
>
> HR Wallingford Limited
> Howbery Park, Wallingford, Oxfordshire, OX10 8BA, United Kingdom
> Registered in England No. 02562099
>
> ________________________________

From michael.katz at noaa.gov  Fri Oct 17 15:31:16 2014
From: michael.katz at noaa.gov (Michael Katz - NOAA Affiliate)
Date: Fri, 17 Oct 2014 15:31:16 -0700
Subject: [gdal-dev] reading arbitrary raster into rgb
Message-ID: <CALx5KqbOjBwaob3-QBAknTvm-C1pDK95twT5xabV5iv7wqnpNA@mail.gmail.com>

(I apologize if this is a repost. I signed up the for the list yesterday
and it appeared the first attempt to post was rejected, but I don't know
how to be sure.)

I am using GDAL through the C++ api.

I want to be able to read an arbitrary raster file (in particular I'm
interested in (geo)tiff files and jpeg2000 files) into an RGB buffer, where
each value is a byte.

I was hoping to see an API like dataset->GetRasterRectToBuffer() that would
operate on the image level (not the band level) and would let me specify
that my buffer was an RGB byte buffer, and the library would do all the
right conversions, regardless of the data type and number of bands of the
source file. For instance, the source file could have CMYK bands with float
values, and it would still extract correctly to my RGB buffer.

Looking at: http://www.gdal.org/gdal_tutorial.html

I'm told that the main API to use to read data in GDAL is RasterIO().

But I'm scared by RasterIO() because it operates on a band. So that means I
already have to do my own logic to determine the number of bands in the
source file and map them to bands in my output RBG file. That seems
complicated in the general case. It seems like handling all the
possibilities of RGB, BGR, CMYK, HSL, etc. is exactly the kind of thing a
data abstraction raster library could save you from having to worry about.
As I say, I was hoping to find an API that operated at the whole image
level, not the band level, and could do whatever is best to get an RGB
image from whatever source. Maybe if it's not part of the GDAL library
still someone has put together some code to handle arbitrary source image
to RBG image mapping?

A lesser question is that I'm confused about the design of RasterIO()
itself. I see from its API description that it does a lot of nice
conversion as needed:

This method allows reading a region of a GDALRasterBand
<http://www.gdal.org/classGDALRasterBand.html> into a buffer, or writing
data from a buffer into a region of a GDALRasterBand
<http://www.gdal.org/classGDALRasterBand.html>. It automatically takes care
of data type translation if the data type (eBufType) of the buffer is
different than that of the GDALRasterBand
<http://www.gdal.org/classGDALRasterBand.html>. The method also takes care
of image decimation / replication if the buffer size (nBufXSize x
nBufYSize) is different than the size of the region being accessed (nXSize
x nYSize).


But then reading the intro tutorial (http://www.gdal.org/gdal_tutorial.html)
I see:

The pData is the memory buffer the data is read into, or written from. It's
real type must be whatever is passed as eBufType, such as GDT_Float32, or
GDT_Byte. The RasterIO() call will take care of converting between the
buffer's data type and the data type of the band. Note that when converting
floating point data to integer RasterIO() rounds down, and when converting
source values outside the legal range of the output the nearest legal value
is used. This implies, for instance, that 16bit data read into a GDT_Byte
buffer will map all values greater than 255 to 255, *the data is not
scaled!*


Not scaling seems really strange to me, and seems to make RasterIO() much
less useful. It seems like if I want to get byte values out, I'll need to
have code that checks the source data type, then allocates a buffer of that
GDALDataType's size, then does the read, then goes through and
copies-and-scales each value into my destination RGB buffer, with a
different case for handling each GDALDataType. I'm just wondering, since
RasterIO() "automatically takes care of data type translation", why it
would pin (i.e., destroy) all the data, instead of scaling it. Are 16 bit
values pinned to byte values (as in the example the tutorial cites) useful
to anyone?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141017/8b7c41b9/attachment.html>

From even.rouault at spatialys.com  Fri Oct 17 16:07:30 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 18 Oct 2014 01:07:30 +0200
Subject: [gdal-dev] reading arbitrary raster into rgb
In-Reply-To: <CALx5KqbOjBwaob3-QBAknTvm-C1pDK95twT5xabV5iv7wqnpNA@mail.gmail.com>
References: <CALx5KqbOjBwaob3-QBAknTvm-C1pDK95twT5xabV5iv7wqnpNA@mail.gmail.com>
Message-ID: <201410180107.31020.even.rouault@spatialys.com>

Le samedi 18 octobre 2014 00:31:16, Michael Katz - NOAA Affiliate a ?crit :
> (I apologize if this is a repost. I signed up the for the list yesterday
> and it appeared the first attempt to post was rejected, but I don't know
> how to be sure.)
> 
> I am using GDAL through the C++ api.
> 
> I want to be able to read an arbitrary raster file (in particular I'm
> interested in (geo)tiff files and jpeg2000 files) into an RGB buffer, where
> each value is a byte.
> 
> I was hoping to see an API like dataset->GetRasterRectToBuffer() that would
> operate on the image level (not the band level) and would let me specify
> that my buffer was an RGB byte buffer, and the library would do all the
> right conversions, regardless of the data type and number of bands of the
> source file. For instance, the source file could have CMYK bands with float
> values, and it would still extract correctly to my RGB buffer.
> 
> Looking at: http://www.gdal.org/gdal_tutorial.html
> 
> I'm told that the main API to use to read data in GDAL is RasterIO().
> 
> But I'm scared by RasterIO() because it operates on a band. So that means I
> already have to do my own logic to determine the number of bands in the
> source file and map them to bands in my output RBG file. That seems
> complicated in the general case. It seems like handling all the
> possibilities of RGB, BGR, CMYK, HSL, etc. is exactly the kind of thing a
> data abstraction raster library could save you from having to worry about.
> As I say, I was hoping to find an API that operated at the whole image
> level, not the band level, and could do whatever is best to get an RGB
> image from whatever source. Maybe if it's not part of the GDAL library
> still someone has put together some code to handle arbitrary source image
> to RBG image mapping?

Michael,

You can also use GDALDataset::RasterIO() ( 
http://www.gdal.org/classGDALDataset.html#ae077c53268d2272eebed10b891a05743 ) 
that can take several bands at once, and by setting nPixelSpace=3 and 
nBandSpace=1 (assuming you ask GDT_Byte), you can ask it to put in a buffer 
where each R sample is followed immediately by the B and the G, and then you 
have the R of the next pixel, etc..

Regarding color space conversions, GDAL generally doesn't do anything if the 
underlying library doesn't do it. But in the case of JPEG or JPEG2000, they do 
YCbCr -> RGB conversion transparently. CMYK is quite esoteric, but I think 
JPEG will translate it to RGB.

> 
> A lesser question is that I'm confused about the design of RasterIO()
> itself. I see from its API description that it does a lot of nice
> conversion as needed:
> 
> This method allows reading a region of a GDALRasterBand
> <http://www.gdal.org/classGDALRasterBand.html> into a buffer, or writing
> data from a buffer into a region of a GDALRasterBand
> <http://www.gdal.org/classGDALRasterBand.html>. It automatically takes care
> of data type translation if the data type (eBufType) of the buffer is
> different than that of the GDALRasterBand
> <http://www.gdal.org/classGDALRasterBand.html>. The method also takes care
> of image decimation / replication if the buffer size (nBufXSize x
> nBufYSize) is different than the size of the region being accessed (nXSize
> x nYSize).
> 
> 
> But then reading the intro tutorial
> (http://www.gdal.org/gdal_tutorial.html) I see:
> 
> The pData is the memory buffer the data is read into, or written from. It's
> real type must be whatever is passed as eBufType, such as GDT_Float32, or
> GDT_Byte. The RasterIO() call will take care of converting between the
> buffer's data type and the data type of the band. Note that when converting
> floating point data to integer RasterIO() rounds down,

That might be actually outdated. Recent GDAL versions should round to the 
closest integer.

> and when converting
> source values outside the legal range of the output the nearest legal value
> is used. This implies, for instance, that 16bit data read into a GDT_Byte
> buffer will map all values greater than 255 to 255, *the data is not
> scaled!*

Yes, that's true.
Several reasons : how do you scale floating point values that go from -infinity 
to +infinity to integer ? And even for integer value, it is not uncommon to 
have 12 bit data packed in 16bit, but lack of metadata indicating that it is 
actually 12bit, so automatic scaling would not be appropriate.

> 
> 
> Not scaling seems really strange to me, and seems to make RasterIO() much
> less useful. It seems like if I want to get byte values out, I'll need to
> have code that checks the source data type, then allocates a buffer of that
> GDALDataType's size, then does the read, then goes through and
> copies-and-scales each value into my destination RGB buffer, with a
> different case for handling each GDALDataType. I'm just wondering, since
> RasterIO() "automatically takes care of data type translation", why it
> would pin (i.e., destroy) all the data, instead of scaling it. Are 16 bit
> values pinned to byte values (as in the example the tutorial cites) useful
> to anyone?

Likely not, but at least the behaviour is documented ;-) So yes it is assumed 
that people will handle themselves more clever conversions than the one 
documented. For example, there are situations where you use non linear scaling 
to convert 12bit/16bit to 8bit for better visual rendering.

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From michael.katz at noaa.gov  Fri Oct 17 17:16:19 2014
From: michael.katz at noaa.gov (Michael Katz - NOAA Affiliate)
Date: Fri, 17 Oct 2014 17:16:19 -0700
Subject: [gdal-dev] reading arbitrary raster into rgb
In-Reply-To: <201410180107.31020.even.rouault@spatialys.com>
References: <CALx5KqbOjBwaob3-QBAknTvm-C1pDK95twT5xabV5iv7wqnpNA@mail.gmail.com>
	<201410180107.31020.even.rouault@spatialys.com>
Message-ID: <CALx5Kqa8UmbwTCV2ba4TcBqc9G_Xe9Fg3k3CuJf=SY=-SAL=HQ@mail.gmail.com>

Even, thanks for the reply and for pointing out the dataset version of
RasterIO().

But I still don't understand a few things. The main one is that you say:

>>> Regarding color space conversions, GDAL generally doesn't do anything
if the
>>> underlying library doesn't do it. But in the case of JPEG or JPEG2000,
they do
>>> YCbCr -> RGB conversion transparently. CMYK is quite esoteric, but I
think
>>> JPEG will translate it to RGB.

I don't understand what would direct the output to be RGB.

I understand nPixelSpace, nLineSpace, and nBandSpace to be purely a matter
of how you want the data laid out in the output buffer, but nothing about
what data (type, color space) gets written. So by setting nPixelSpace=3 and
nBandSpace=1 as you suggest, I understand that you get sequential RGB
triplets, but that in itself doesn't direct RasterIO() to output RGB,
right? My understanding is that the only thing that controls the output
type is eBuffType, but setting it to GDT_Byte doesn't mean "rgb", it just
means "byte". So if the input file had HSL, those bytes would be HSL. And
if the input file had RGB or HSL using floats, those byte values would be
pinned (i.e., destroyed) versions of the floating point values.

So I don't see where the "transparent" color space conversion comes in.

Overall, it's still sounding to me like if I want a function to read an
arbitrary file (tiff, JPEG200) into an RGB byte buffer, I need to handle
quite a bit of logic myself. I have to:

(a) Look at the number of bands and step through the bands one by one and
deduce what color space is being used. For instance, I might see that there
are four bands and the first band is *GCI_RedBand* , but that does not
guarantee that the next two bands are green and blue (although they
probably are).

(b) Allocate a buffer A to read the file in using its existing color space
and data type.

(c) Allocate a buffer B in RGB for the given number of pixels.

(d) For all the incoming color spaces and data types I choose to support
(my understanding is that the possibilities are RBG, HSL, CMYK, YCbCr), for
each pixel, grab data from the appropriate channels (in whatever order
those channels happen to be laid out) and do both a color space conversion
and a data type conversion from the pixel in A to the pixel in B.

(e) Possibly deal with other things like the file having a color table (not
sure if JPEG200 or tiff can have color tables?), which would modify my code
for (d).

Does that sound correct to you? Do you know of someone who has that code,
even if it's not part of GDAL itself?

It still seems to me natural that GDAL would provide an overarching
function that would do all of this, since there are a lot of cases to
consider and everybody wants basically the same thing.

I understand the point about people possibly wanting to map values in a
non-linear way or whatever, but it seems like that could be handled with a
default behavior with the option for a user callback function to customize.


On Fri, Oct 17, 2014 at 4:07 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le samedi 18 octobre 2014 00:31:16, Michael Katz - NOAA Affiliate a ?crit :
> > (I apologize if this is a repost. I signed up the for the list yesterday
> > and it appeared the first attempt to post was rejected, but I don't know
> > how to be sure.)
> >
> > I am using GDAL through the C++ api.
> >
> > I want to be able to read an arbitrary raster file (in particular I'm
> > interested in (geo)tiff files and jpeg2000 files) into an RGB buffer,
> where
> > each value is a byte.
> >
> > I was hoping to see an API like dataset->GetRasterRectToBuffer() that
> would
> > operate on the image level (not the band level) and would let me specify
> > that my buffer was an RGB byte buffer, and the library would do all the
> > right conversions, regardless of the data type and number of bands of the
> > source file. For instance, the source file could have CMYK bands with
> float
> > values, and it would still extract correctly to my RGB buffer.
> >
> > Looking at: http://www.gdal.org/gdal_tutorial.html
> >
> > I'm told that the main API to use to read data in GDAL is RasterIO().
> >
> > But I'm scared by RasterIO() because it operates on a band. So that
> means I
> > already have to do my own logic to determine the number of bands in the
> > source file and map them to bands in my output RBG file. That seems
> > complicated in the general case. It seems like handling all the
> > possibilities of RGB, BGR, CMYK, HSL, etc. is exactly the kind of thing a
> > data abstraction raster library could save you from having to worry
> about.
> > As I say, I was hoping to find an API that operated at the whole image
> > level, not the band level, and could do whatever is best to get an RGB
> > image from whatever source. Maybe if it's not part of the GDAL library
> > still someone has put together some code to handle arbitrary source image
> > to RBG image mapping?
>
> Michael,
>
> You can also use GDALDataset::RasterIO() (
> http://www.gdal.org/classGDALDataset.html#ae077c53268d2272eebed10b891a05743
> )
> that can take several bands at once, and by setting nPixelSpace=3 and
> nBandSpace=1 (assuming you ask GDT_Byte), you can ask it to put in a buffer
> where each R sample is followed immediately by the B and the G, and then
> you
> have the R of the next pixel, etc..
>
> Regarding color space conversions, GDAL generally doesn't do anything if
> the
> underlying library doesn't do it. But in the case of JPEG or JPEG2000,
> they do
> YCbCr -> RGB conversion transparently. CMYK is quite esoteric, but I think
> JPEG will translate it to RGB.
>
> >
> > A lesser question is that I'm confused about the design of RasterIO()
> > itself. I see from its API description that it does a lot of nice
> > conversion as needed:
> >
> > This method allows reading a region of a GDALRasterBand
> > <http://www.gdal.org/classGDALRasterBand.html> into a buffer, or writing
> > data from a buffer into a region of a GDALRasterBand
> > <http://www.gdal.org/classGDALRasterBand.html>. It automatically takes
> care
> > of data type translation if the data type (eBufType) of the buffer is
> > different than that of the GDALRasterBand
> > <http://www.gdal.org/classGDALRasterBand.html>. The method also takes
> care
> > of image decimation / replication if the buffer size (nBufXSize x
> > nBufYSize) is different than the size of the region being accessed
> (nXSize
> > x nYSize).
> >
> >
> > But then reading the intro tutorial
> > (http://www.gdal.org/gdal_tutorial.html) I see:
> >
> > The pData is the memory buffer the data is read into, or written from.
> It's
> > real type must be whatever is passed as eBufType, such as GDT_Float32, or
> > GDT_Byte. The RasterIO() call will take care of converting between the
> > buffer's data type and the data type of the band. Note that when
> converting
> > floating point data to integer RasterIO() rounds down,
>
> That might be actually outdated. Recent GDAL versions should round to the
> closest integer.
>
> > and when converting
> > source values outside the legal range of the output the nearest legal
> value
> > is used. This implies, for instance, that 16bit data read into a GDT_Byte
> > buffer will map all values greater than 255 to 255, *the data is not
> > scaled!*
>
> Yes, that's true.
> Several reasons : how do you scale floating point values that go from
> -infinity
> to +infinity to integer ? And even for integer value, it is not uncommon to
> have 12 bit data packed in 16bit, but lack of metadata indicating that it
> is
> actually 12bit, so automatic scaling would not be appropriate.
>
> >
> >
> > Not scaling seems really strange to me, and seems to make RasterIO() much
> > less useful. It seems like if I want to get byte values out, I'll need to
> > have code that checks the source data type, then allocates a buffer of
> that
> > GDALDataType's size, then does the read, then goes through and
> > copies-and-scales each value into my destination RGB buffer, with a
> > different case for handling each GDALDataType. I'm just wondering, since
> > RasterIO() "automatically takes care of data type translation", why it
> > would pin (i.e., destroy) all the data, instead of scaling it. Are 16 bit
> > values pinned to byte values (as in the example the tutorial cites)
> useful
> > to anyone?
>
> Likely not, but at least the behaviour is documented ;-) So yes it is
> assumed
> that people will handle themselves more clever conversions than the one
> documented. For example, there are situations where you use non linear
> scaling
> to convert 12bit/16bit to 8bit for better visual rendering.
>
> Best regards,
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141017/25cd82c0/attachment.html>

From even.rouault at spatialys.com  Sat Oct 18 02:10:08 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 18 Oct 2014 11:10:08 +0200
Subject: [gdal-dev] reading arbitrary raster into rgb
In-Reply-To: <CALx5Kqa8UmbwTCV2ba4TcBqc9G_Xe9Fg3k3CuJf=SY=-SAL=HQ@mail.gmail.com>
References: <CALx5KqbOjBwaob3-QBAknTvm-C1pDK95twT5xabV5iv7wqnpNA@mail.gmail.com>
	<201410180107.31020.even.rouault@spatialys.com>
	<CALx5Kqa8UmbwTCV2ba4TcBqc9G_Xe9Fg3k3CuJf=SY=-SAL=HQ@mail.gmail.com>
Message-ID: <201410181110.08549.even.rouault@spatialys.com>

Le samedi 18 octobre 2014 02:16:19, Michael Katz - NOAA Affiliate a ?crit :
> Even, thanks for the reply and for pointing out the dataset version of
> RasterIO().
> 
> But I still don't understand a few things. The main one is that you say:
> >>> Regarding color space conversions, GDAL generally doesn't do anything
> 
> if the
> 
> >>> underlying library doesn't do it. But in the case of JPEG or JPEG2000,
> 
> they do
> 
> >>> YCbCr -> RGB conversion transparently. CMYK is quite esoteric, but I
> 
> think
> 
> >>> JPEG will translate it to RGB.
> 
> I don't understand what would direct the output to be RGB.
> 
> I understand nPixelSpace, nLineSpace, and nBandSpace to be purely a matter
> of how you want the data laid out in the output buffer, but nothing about
> what data (type, color space) gets written. So by setting nPixelSpace=3 and
> nBandSpace=1 as you suggest, I understand that you get sequential RGB
> triplets, but that in itself doesn't direct RasterIO() to output RGB,
> right? My understanding is that the only thing that controls the output
> type is eBuffType, but setting it to GDT_Byte doesn't mean "rgb", it just
> means "byte". So if the input file had HSL, those bytes would be HSL.

Yes. But GDAL doesn't do everything itself. When reading a JPEG file it uses 
libjpeg, and it configures libjpeg to do YCbCr->RGB colorspace conversion 
transparently. So from GDAL point of view, and its users, the bands will be 
R,G,B and not Y,Cb,Cr.

> And
> if the input file had RGB or HSL using floats, those byte values would be
> pinned (i.e., destroyed) versions of the floating point values.
> 
> So I don't see where the "transparent" color space conversion comes in.

See above explanation. It is driver/underlying library specific logic 

> 
> Overall, it's still sounding to me like if I want a function to read an
> arbitrary file (tiff, JPEG200) into an RGB byte buffer, I need to handle
> quite a bit of logic myself. I have to:
> 
> (a) Look at the number of bands and step through the bands one by one and
> deduce what color space is being used. For instance, I might see that there
> are four bands and the first band is *GCI_RedBand* , but that does not
> guarantee that the next two bands are green and blue (although they
> probably are).
> 
> (b) Allocate a buffer A to read the file in using its existing color space
> and data type.
> 
> (c) Allocate a buffer B in RGB for the given number of pixels.
> 
> (d) For all the incoming color spaces and data types I choose to support
> (my understanding is that the possibilities are RBG, HSL, CMYK, YCbCr), for
> each pixel, grab data from the appropriate channels (in whatever order
> those channels happen to be laid out) and do both a color space conversion
> and a data type conversion from the pixel in A to the pixel in B.
> 
> (e) Possibly deal with other things like the file having a color table (not
> sure if JPEG200 or tiff can have color tables?), which would modify my code
> for (d).

Both can have, although paletted JPEG2000 is quite uncommon (have only seen 
paletted JPEG2000 in compliance test suite). Paletted TIFF is not so uncommon.

> 
> Does that sound correct to you? Do you know of someone who has that code,
> even if it's not part of GDAL itself?

Your theory is correct, but in practice you will hardly find datasets in those 
exotic colorspaces (well at least for most people I guess).
The GeoTIFF driver also uses the TIFFReadRGBAStrip()/TIFFReadRGBATile() API of 
libtiff to expose RGBA bands for some of thoese exotic colorspaces

The only thing you would have to deal yourself is color table expansion.
gdal_translate -expand RGB does the later. It uses VRT internally to do that. 
See AddComplexSource() in http://www.gdal.org/classVRTSourcedRasterBand.html. 
Color table expansion is done if you specified nColorTableComponent = 1, 2 or 
3.

> 
> It still seems to me natural that GDAL would provide an overarching
> function that would do all of this, since there are a lot of cases to
> consider and everybody wants basically the same thing.
> 
> I understand the point about people possibly wanting to map values in a
> non-linear way or whatever, but it seems like that could be handled with a
> default behavior with the option for a user callback function to customize.

Regarding user callback function, you could actually use VRT derived bands to 
do that. See the "Using Derived Bands" paragraph of 
http://www.gdal.org/gdal_vrttut.html

I can imagine there could be some helper API that would use RasterIO() 
internally and would expose to the user a RGBA dataset. Someone has to do it.. 
:-)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From vautieri at geoweb3d.com  Sat Oct 18 08:46:39 2014
From: vautieri at geoweb3d.com (Vincent Autieri II)
Date: Sat, 18 Oct 2014 11:46:39 -0400
Subject: [gdal-dev] Geoweb3d Seeks Experienced GDAL OpenGL C++ programmer
Message-ID: <CAPVN1MsGuiYpehjOyMqtQcvNVaiaZq-2kMG3HLW0jd7f2ByiHQ@mail.gmail.com>

I believe this is relevant to the majority of people that read this list,
and I hope its not in violation with the group's rules.

Role: Senior Graphics Software Engineer
Location: Geoweb3d USA - New York, Binghamton
Functional Area: 3D Engine Product Development
Employment type: Regular Full-time

Are you passionate about cutting edge 3D graphics?  Are you looking to
significantly advance your professional career, enjoy challenging work, and
get in on the ground floor of an exciting, growing small company? We have
an immediate opening for an experienced developer interested in working on
our 3D mapping engine.

Geoweb3d's software engineers develop the next generation 3D solutions to
meet the diverse needs of the fast moving geospatial industry.  The work
that you will be doing will have direct impact on the global geospatial
industry. This fast growing market is undergoing an exciting, rapid
transformation to 3D visualization with Geoweb3d at the forefront of this
innovation. For our users in Defense and Intelligence, the technology that
you produce will impact security and the preparedness of the warfighter.

Why join us?
The Geoweb3d team is a small, dedicated, highly motivated group in a fast
growing business located in upstate NY. We offer a competitive salary and
an extensive benefits package that includes medical, dental, vision, and
401K. You will be joining a talented, expanding, creative team that is
passionate about creating the premier 3D engine for the geospatial
industry. Our office environment is relaxed, fun, and nurtures teamwork.

The company
Geoweb3d is a leading provider of visualization, analysis, and modeling
solutions for the geospatial industry.  Our products are used across the
Defense, Intelligence, and commercial markets in both the US and around the
world. Geoweb3d also provides engineering services to integrate our 3D
engine into other products and industry solutions

Responsibilities
Your role would be a core developer on the team that designs, architects,
and develops the software for our 3D engine.  We are looking for a
passionate individual that has the experience and self motivation to work
on ground breaking 3D graphics technology. At the forefront of the
industry, this individual must be prepared to continuously learn and
readily integrate the latest technology.

Requirements
- Bachelor or Master Degree with 5 years of relevant experience.
- High proficiency in C++, STL, Boost, Object Orient Design, high
performance coding
- Mathematical skills relevant to 3D design and programming
- OpenGL 3.3 and 4.x
- Spatial data structures
- Strong communication and presentation skills within Geoweb3d and its
customers.
- Positive individual, bringing innovative ideas to the team and best
practices
- Capability to work both independently and with a team
- A diligent and resourceful self-starter

Other skills that would help
- Geospatial Data Abstraction Library (GDAL)
- GIS knowledge including concepts, tools, and data (vector, raster, 3D
models, LIDAR, and others)
- Knowledge of coordinate geometry and spatial reference systems
- 3D mapping
- Government software development processes and CDRLs
- Software version and revision control
- Jira project management

Interested?
Qualified applicants can email a cover letter and resume to
careers at geoweb3d.com.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141018/a90cb9e3/attachment.html>

From ljvillarin30 at gmail.com  Tue Oct 21 00:30:30 2014
From: ljvillarin30 at gmail.com (Love)
Date: Tue, 21 Oct 2014 15:30:30 +0800
Subject: [gdal-dev] How to project all the files or newest files that were
 added to the directory using gdalwarp and commandline(.bat file)
Message-ID: <CAMZEyL4WucusXnVNE9BC2SG7A6L0Jxr7S1ANuoyFB9mX50G+jg@mail.gmail.com>

How am I going to automatically detect all the files that were added to the
directory and then project it immediately?Because everyday I am downloading
hdf files and then project it from time to time which is a waste of time.
That's why I need it in batch process and automatic process.

Thank you in advance!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141021/6dbab53b/attachment.html>

From bontepaarden at gmail.com  Tue Oct 21 01:18:10 2014
From: bontepaarden at gmail.com (Paul Meems)
Date: Tue, 21 Oct 2014 10:18:10 +0200
Subject: [gdal-dev] How to project all the files or newest files that
 were added to the directory using gdalwarp and commandline(.bat file)
In-Reply-To: <CAMZEyL4WucusXnVNE9BC2SG7A6L0Jxr7S1ANuoyFB9mX50G+jg@mail.gmail.com>
References: <CAMZEyL4WucusXnVNE9BC2SG7A6L0Jxr7S1ANuoyFB9mX50G+jg@mail.gmail.com>
Message-ID: <CAHNf2YTxi5gaeS=LeUqHDwcSODCJ6FmvWgVvFq0G0Z-Df3bffQ@mail.gmail.com>

What I would do is create a subfolder called 'processed'
Run your bat file to project the files in your folder and move the
processed files to the subfolder.
This results in your main folder being empty if nothing to do and filled if
you need to do something.
Now you can schedule your bat file to run periodically.

BTW. I don't think this is a GDAL question, more a Windows batch question.




Paul

*Paul Meems *
Release manager, configuration manager
and forum moderator of MapWindow GIS.
www.mapwindow.org

Owner of MapWindow.nl - Support for
Dutch speaking users.
www.mapwindow.nl



*The English presentations of the MapWindow GIS Conference 2014 are online.
<http://www.slideshare.net/mapwindow>*

2014-10-21 9:30 GMT+02:00 Love <ljvillarin30 at gmail.com>:

> How am I going to automatically detect all the files that were added to
> the directory and then project it immediately?Because everyday I am
> downloading hdf files and then project it from time to time which is a
> waste of time. That's why I need it in batch process and automatic process.
>
> Thank you in advance!
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141021/76995cd2/attachment.html>

From even.rouault at spatialys.com  Tue Oct 21 09:11:18 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 21 Oct 2014 18:11:18 +0200
Subject: [gdal-dev] GTiff: new DISCARD_LSB creation option
Message-ID: <201410211811.18759.even.rouault@spatialys.com>

Hi,

Following a recent discussion on using PREDICTOR=2 with COMPRESS=DEFLATE with 
TIFF, I've implemented in trunk a trick suggested by Adobe in the TIFF 
specification to improve the effectiveness of horizontal prediction (which is 
using the difference between consecutive pixels rather than their value)

The DISCARD_LSB=nbit creation option is an initial *lossy* compression step 
that will discard nbit least-significant bits of the pixel values. A different 
value can be specified per band with nbit_band1,nbit_band2,...nbit_bandN.
A more practical view of this is that it decreases the number of colors per 
channel.

For example :

gdal_translate world.topo.bathy.200406.3x21600x21600.C1.png out_lsb1.tif \
   -co tiled=yes -co compress=deflate -co predictor=2 -co discard_lsb=1

gdal_translate world.topo.bathy.200406.3x21600x21600.C1.png out_lsb213.tif \
   -co tiled=yes -co compress=deflate -co predictor=2 -co discard_lsb=2,1,3

Resulting file sizes on the above mentionned RGB BMNG tile (21600x21600 
pixels):
world.topo.bathy.200406.3x21600x21600.C1.png: 484 696 919 bytes
out_lsb000.tif: 467 791 323 (i.e. lossless compression)
out_lsb111.tif: 352 89 5108
out_lsb213.tif: 286 368 793
out_lsb222.tif: 259 788 627
out_lsb324.tif: 210 505 787
out_lsb333.tif: 184 807 316
out_lsb334.tif: 177 060 429

--> discard_lsb=1 has really nearly undetectable visual degradation.
--> discard_lsb=2,1,3 : the rationale for that one is that the human eye is 
sensitive mostly to luminance, and in the usual computation of luminance from 
red, green, blue channels, the green channel has a weight of 72%, red 21% and 
blue 7%, so we discard more red bits than green bits, and more blue than red. 
Very good result overall. Some tiny artefacts can be seen in the blue 
gradients in the oceanic areas when watching closely.
--> the more you increase the number of discarded bits, the more artifacts in 
blue gradients. Quality on land areas remains quite good.

To be compared with JPEG compression (quality of 95% and 90%, YCbCr 4:2:0) :
out_jpeg_95_ycbcr.tif: 108 487 980
out_jpeg_90_ycbcr.tif: 72 054 360

So JPEG compression is more efficient, doesn't exhibit the issue with blue 
gradients but has the typical JPEG artifacts with high frequencies.

The advantage of DISCARD_LSB is that you have a guarantee on the error : it 
cannot exceed 2^(nbits-1) (and the mean error should be half ot that for 
evenly distributed values). It can also be used with RGBA images where JPEG 
YCbCr in TIFF cannot be used.

Important note: this is only something done on compression side, and doesn't 
change the encoded scheme. So 100% compatibility with any DEFLATE + PREDICTOR 
compatible reader.

Theoretically, that could be enhanced to do adaptative compression per tile 
(or even within a tile), by adjusting the number of discarded bits depending 
on the sensitiveness of the eye to the content.
Whereas JPEG-in-TIFF doesn't allow this (quantization tables are common to the 
whole file).

Happy experimentations !

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jemabingham at gmail.com  Tue Oct 21 14:51:39 2014
From: jemabingham at gmail.com (Jema)
Date: Tue, 21 Oct 2014 14:51:39 -0700 (PDT)
Subject: [gdal-dev] Handle Spaces in Rasterlite Database Path
Message-ID: <CANcXNv2v1rxzq8u5XmfnNvWDdPus6bn_RPV-L+fSykaFtXe3eA@mail.gmail.com>

OS:  Windows 7, 64-bit
GDAL:  1.11.0, 32-bit, C# Bindings

I successfully created a rasterlite database and added multiple rasters in
a directory path without spaces.  The database file was then moved into a
directory with spaces, and now I'm unable to connect to it.

Using the connection string syntax
(RASTERLITE:rasterlitedb_name[,table=raster_table_prefix];
http://gdal.org/frmt_rasterlite.html), I've tried without luck to isolate
the rasterlitedb_name containing spaces with any form of delimiter that I
could think of.  As I won't be able to control the final storage location
of the database, any advice would be appreciated.




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Handle-Spaces-in-Rasterlite-Database-Path-tp5168772.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141021/78ce0368/attachment.html>

From even.rouault at spatialys.com  Tue Oct 21 15:38:10 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 22 Oct 2014 00:38:10 +0200
Subject: [gdal-dev] Handle Spaces in Rasterlite Database Path
In-Reply-To: <CANcXNv2v1rxzq8u5XmfnNvWDdPus6bn_RPV-L+fSykaFtXe3eA@mail.gmail.com>
References: <CANcXNv2v1rxzq8u5XmfnNvWDdPus6bn_RPV-L+fSykaFtXe3eA@mail.gmail.com>
Message-ID: <201410220038.16711.even.rouault@spatialys.com>

Le mardi 21 octobre 2014 23:51:39, Jema a ?crit :
> OS:  Windows 7, 64-bit
> GDAL:  1.11.0, 32-bit, C# Bindings
> 
> I successfully created a rasterlite database and added multiple rasters in
> a directory path without spaces.  The database file was then moved into a
> directory with spaces, and now I'm unable to connect to it.
> 
> Using the connection string syntax
> (RASTERLITE:rasterlitedb_name[,table=raster_table_prefix];
> http://gdal.org/frmt_rasterlite.html), I've tried without luck to isolate
> the rasterlitedb_name containing spaces with any form of delimiter that I
> could think of.  As I won't be able to control the final storage location
> of the database, any advice would be appreciated.

Jema,

Spaces in filenames were not possible up to the fix I've just pushed in trunk

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From massimodisasha at gmail.com  Wed Oct 22 00:02:25 2014
From: massimodisasha at gmail.com (epi)
Date: Wed, 22 Oct 2014 03:02:25 -0400
Subject: [gdal-dev] unable to read geotransfmrm and projection information
	from a netcdf file (stereo graphic polar projection)
Message-ID: <F0803977-F24F-4B8D-8C46-2B5D93388B0B@gmail.com>

Hi,

I?m tring to read a netcdf file into OSSIM, but unfortunately my file doesn?t have proper georeferenced metadata, the results of ncdump shows the following info :


	int grid_mapping ;
		grid_mapping:grid_mapping_name = "polar_stereographic" ;
		grid_mapping:long_name = "grid mapping" ;
		grid_mapping:scale_factor_at_projection_origin = 0.933012701892219 ;
		grid_mapping:straight_vertical_longitude_from_pole = 58. ;
		grid_mapping:standard_parallel = 60. ;
		grid_mapping:latitude_of_projection_origin = 90. ;
		grid_mapping:false_easting = 2548000. ;
		grid_mapping:false_northing = 3988000. ;
		grid_mapping:semi_major_axis = 6371000. ;
		grid_mapping:semi_minor_axis = 6371000. ;
		grid_mapping:earth_radius = 6371000. ;
		grid_mapping:ellipsoid = "sphere" ;
		grid_mapping:dx = 4000. ;
		grid_mapping:proj4string = "+proj=stere +R=6371000.0 +a=6371000 +b=6371000 +lat_0=90 +lat_ts=60 +lon_0=58 +x_0=3988000 +y_0=2548000" ;


Can you help me in creating a proper geotiff file from this netcdf file ?
I tried goal_transform without success on it

attached at this link [ 1 ] there is the original netcdf 

[ 1 ]  http://epinux.com/shared/Mean_2009_2011.nc <http://epinux.com/shared/Mean_2009_2011.nc>

Thanks al lot for your precious help!

epifanio.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141022/493250d1/attachment.html>

From even.rouault at spatialys.com  Wed Oct 22 01:19:46 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 22 Oct 2014 10:19:46 +0200
Subject: [gdal-dev] unable to read geotransfmrm and projection
	information from a netcdf file (stereo graphic polar projection)
In-Reply-To: <F0803977-F24F-4B8D-8C46-2B5D93388B0B@gmail.com>
References: <F0803977-F24F-4B8D-8C46-2B5D93388B0B@gmail.com>
Message-ID: <201410221019.46598.even.rouault@spatialys.com>

Le mercredi 22 octobre 2014 09:02:25, epi a ?crit :
> Hi,
> 
> I?m tring to read a netcdf file into OSSIM, but unfortunately my file
> doesn?t have proper georeferenced metadata, the results of ncdump shows
> the following info :
> 
> 
> 	int grid_mapping ;
> 		grid_mapping:grid_mapping_name = "polar_stereographic" ;
> 		grid_mapping:long_name = "grid mapping" ;
> 		grid_mapping:scale_factor_at_projection_origin = 0.933012701892219 ;
> 		grid_mapping:straight_vertical_longitude_from_pole = 58. ;
> 		grid_mapping:standard_parallel = 60. ;
> 		grid_mapping:latitude_of_projection_origin = 90. ;
> 		grid_mapping:false_easting = 2548000. ;
> 		grid_mapping:false_northing = 3988000. ;
> 		grid_mapping:semi_major_axis = 6371000. ;
> 		grid_mapping:semi_minor_axis = 6371000. ;
> 		grid_mapping:earth_radius = 6371000. ;
> 		grid_mapping:ellipsoid = "sphere" ;
> 		grid_mapping:dx = 4000. ;
> 		grid_mapping:proj4string = "+proj=stere +R=6371000.0 +a=6371000
> +b=6371000 +lat_0=90 +lat_ts=60 +lon_0=58 +x_0=3988000 +y_0=2548000" ;
> 
> 
> Can you help me in creating a proper geotiff file from this netcdf file ?
> I tried goal_transform without success on it
> 
> attached at this link [ 1 ] there is the original netcdf
> 
> [ 1 ]  http://epinux.com/shared/Mean_2009_2011.nc
> <http://epinux.com/shared/Mean_2009_2011.nc>

epifanio,

That netcdf file uses a GEOLOCATION array mechanism that requires some 
processing.

I managed to get a rectified geotiff with gdalwarp:

gdalwarp -t_srs "+proj=stere +R=6371000.0 +a=6371000 +b=6371000 +lat_0=90 
+lat_ts=60 +lon_0=58 +x_0=3988000 +y_0=2548000"  
NETCDF:"Mean_2009_2011.nc":temperature temperature.tif -overwrite -srcnodata 
-9725.85 -dstnodata -9725.85

and similarly for other variables in the netCDF.

I've determined that the nodata value was -9725.85 by looking at the 
statistics reported by :

gdalinfo NETCDF:"Mean_2009_2011.nc":temperature -stats

I *think* (but haven't verified) that in that instance the geolocation must be 
a regular grid once projected from long/lat to polar stereographic, so 
probably the netCDF driver could be enhanced to expose a regular geotransform 
that could save the gdalwarp step.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From bontepaarden at gmail.com  Thu Oct 23 13:03:26 2014
From: bontepaarden at gmail.com (Paul Meems)
Date: Thu, 23 Oct 2014 22:03:26 +0200
Subject: [gdal-dev] Create PostGIS database using OGR/GDAL
Message-ID: <CAHNf2YTxQUA2T7B7fgNS8AXPUTCEP4cS1ETZwebJMCFOhOvNMA@mail.gmail.com>

Hi,

At this moment we are working on getting PostGIS support for MapWinGIS.
We use the PostGIS driver from GDALv2.

So far we can read and write layers.
We also want to implement some tests, which are also used as a show case
for other users.

For these tests I want to create a database, import some layers, doe
something with the layers and drop the database again.

Creating and dropping a database using ExecuteSQL() doesn't work as stated
at the driver page:
The PostgreSQL driver does not support creation of new datasets (a database
within PostgreSQL), but it does allow creation of new layers within an
existing database.
The error I'm getting is "CREATE DATABASE cannot run inside a transaction
block".

Does anybody have an idea how to solve this? I don't want to manually
create the database. The tests are more or less running automated. I would
also like to prevent to bypass GDAL/OGR and connect to PostGIS directly to
create and drop a database.

Any suggestions are much appreciated.

Thanks,

Paul

*Paul Meems *
Release manager, configuration manager
and forum moderator of MapWindow GIS.
www.mapwindow.org

Owner of MapWindow.nl - Support for
Dutch speaking users.
www.mapwindow.nl



*The English presentations of the MapWindow GIS Conference 2014 are online.
<http://www.slideshare.net/mapwindow>*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141023/1b1bcbb0/attachment.html>

From znmeb at znmeb.net  Thu Oct 23 13:48:57 2014
From: znmeb at znmeb.net (M. Edward (Ed) Borasky)
Date: Thu, 23 Oct 2014 13:48:57 -0700
Subject: [gdal-dev] Create PostGIS database using OGR/GDAL
In-Reply-To: <CAHNf2YTxQUA2T7B7fgNS8AXPUTCEP4cS1ETZwebJMCFOhOvNMA@mail.gmail.com>
References: <CAHNf2YTxQUA2T7B7fgNS8AXPUTCEP4cS1ETZwebJMCFOhOvNMA@mail.gmail.com>
Message-ID: <CAHkRx6HdH4yySFmKh1NpE9m42T0UAXoHyALqwNiK=a0JTPgR1w@mail.gmail.com>

If this is a Windows-only project, you can write directly to PostgreSQL /
PostGIS using the ODBC driver. And if you have shapefiles, there's a
PostGIS utility called "shp2pgsql" that will import them.

On Thu, Oct 23, 2014 at 1:03 PM, Paul Meems <bontepaarden at gmail.com> wrote:

> Hi,
>
> At this moment we are working on getting PostGIS support for MapWinGIS.
> We use the PostGIS driver from GDALv2.
>
> So far we can read and write layers.
> We also want to implement some tests, which are also used as a show case
> for other users.
>
> For these tests I want to create a database, import some layers, doe
> something with the layers and drop the database again.
>
> Creating and dropping a database using ExecuteSQL() doesn't work as stated
> at the driver page:
> The PostgreSQL driver does not support creation of new datasets (a
> database within PostgreSQL), but it does allow creation of new layers
> within an existing database.
> The error I'm getting is "CREATE DATABASE cannot run inside a transaction
> block".
>
> Does anybody have an idea how to solve this? I don't want to manually
> create the database. The tests are more or less running automated. I would
> also like to prevent to bypass GDAL/OGR and connect to PostGIS directly to
> create and drop a database.
>
> Any suggestions are much appreciated.
>
> Thanks,
>
> Paul
>
> *Paul Meems *
> Release manager, configuration manager
> and forum moderator of MapWindow GIS.
> www.mapwindow.org
>
> Owner of MapWindow.nl - Support for
> Dutch speaking users.
> www.mapwindow.nl
>
>
>
> *The English presentations of the MapWindow GIS Conference 2014 are
> online. <http://www.slideshare.net/mapwindow>*
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
Twitter: http://twitter.com/znmeb; Computational Journalism on a Stick
http://j.mp/CompJournoStickOverview

Remember, if you're traveling to Bactria, Hump Day is Tuesday and Thursday.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141023/da956492/attachment.html>

From landa.martin at gmail.com  Thu Oct 23 13:49:17 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Thu, 23 Oct 2014 22:49:17 +0200
Subject: [gdal-dev] ogr2ogr and RFC41
In-Reply-To: <201406112345.52734.even.rouault@mines-paris.org>
References: <CA+Ei1OfO1RRfU2RnZMrbpm+Gk4ieUQq629PVaWqRpkDzrf4EFQ@mail.gmail.com>
	<201406112345.52734.even.rouault@mines-paris.org>
Message-ID: <CA+Ei1OeAYVgHZvbSEdGwqxN4gdcz5PkJo4KQB95_DNa3PXncHw@mail.gmail.com>

Hi,

2014-06-11 23:45 GMT+02:00 Even Rouault <even.rouault at mines-paris.org>:

> Yes, by default it will transfer all source geometry fields into the target
> layer, if it supports multiple geometry fields. If you want only a subset of
> source geometry fields, you can write a SQL clause " SELECT geomfield1,
> geomfield2, other_attr FROM your_layer"

it's not work for me, eg.

$ ogr2ogr -f GPKG -sql "select originalnihranice from staty"
staty.gpkg PG:dbname=vfr_uksh_10_cr  -overwrite

gives

$ ogrinfo staty.gpkg sql_statement | grep Geometry

Geometry: Unknown (any)
Geometry Column = geom

I found `-select` option which seems to work:

$ ogr2ogr -f GPKG -select originalnihranice staty.gpkg
PG:dbname=vfr_uksh_10_cr staty -overwrite

$ ogrinfo staty.gpkg staty | grep Geometry

Geometry: Multi Polygon <-- OK
Geometry Column = geom

But it's still no usable, having attribute table with 10+ attributes I
need to write something like

--select geom2,attr1,attr2,...attr10

Would make sense to you to add a new option

--except geom1

or

--select !geom1

?

Thanks, Martin


-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From jemabingham at gmail.com  Thu Oct 23 15:43:50 2014
From: jemabingham at gmail.com (Jema Bingham)
Date: Thu, 23 Oct 2014 16:43:50 -0600
Subject: [gdal-dev] Handle Spaces in Rasterlite Database Path
In-Reply-To: <201410220038.16711.even.rouault@spatialys.com>
References: <CANcXNv2v1rxzq8u5XmfnNvWDdPus6bn_RPV-L+fSykaFtXe3eA@mail.gmail.com>
	<201410220038.16711.even.rouault@spatialys.com>
Message-ID: <CANcXNv1rV6jpB1up_1tmUGNTm-3pNUg7rtCA63zEAaV_L=go7g@mail.gmail.com>

Thanks.  Tested it, and it works.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141023/f4897064/attachment.html>

From even.rouault at spatialys.com  Thu Oct 23 16:16:31 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 24 Oct 2014 01:16:31 +0200
Subject: [gdal-dev] ogr2ogr and RFC41
In-Reply-To: <CA+Ei1OeAYVgHZvbSEdGwqxN4gdcz5PkJo4KQB95_DNa3PXncHw@mail.gmail.com>
References: <CA+Ei1OfO1RRfU2RnZMrbpm+Gk4ieUQq629PVaWqRpkDzrf4EFQ@mail.gmail.com>
	<201406112345.52734.even.rouault@mines-paris.org>
	<CA+Ei1OeAYVgHZvbSEdGwqxN4gdcz5PkJo4KQB95_DNa3PXncHw@mail.gmail.com>
Message-ID: <201410240116.31361.even.rouault@spatialys.com>

Le jeudi 23 octobre 2014 22:49:17, Martin Landa a ?crit :
> Hi,
> 
> 2014-06-11 23:45 GMT+02:00 Even Rouault <even.rouault at mines-paris.org>:
> > Yes, by default it will transfer all source geometry fields into the
> > target layer, if it supports multiple geometry fields. If you want only
> > a subset of source geometry fields, you can write a SQL clause " SELECT
> > geomfield1, geomfield2, other_attr FROM your_layer"
> 
> it's not work for me, eg.
> 
> $ ogr2ogr -f GPKG -sql "select originalnihranice from staty"
> staty.gpkg PG:dbname=vfr_uksh_10_cr  -overwrite
> 
> gives
> 
> $ ogrinfo staty.gpkg sql_statement | grep Geometry
> 
> Geometry: Unknown (any)
> Geometry Column = geom

It works. It is just that it cannot guess the geometry type from a SQL that 
could potentially return arbitrary geometries (well we could perhaps add 
heuristics to detect that the column is indeed a column of a spatial table, 
similarly to what exists in the spatialite&gpkg driver) . You can however 
specify -nlt multipolygon if you want stronger typing

> 
> I found `-select` option which seems to work:
> 
> $ ogr2ogr -f GPKG -select originalnihranice staty.gpkg
> PG:dbname=vfr_uksh_10_cr staty -overwrite
> 
> $ ogrinfo staty.gpkg staty | grep Geometry
> 
> Geometry: Multi Polygon <-- OK
> Geometry Column = geom

Yes because here we know that we are directly extracting information from the 
source layer.

> 
> But it's still no usable, having attribute table with 10+ attributes I
> need to write something like
> 
> --select geom2,attr1,attr2,...attr10
> 
> Would make sense to you to add a new option
> 
> --except geom1
> 
> or
> 
> --select !geom1

The later kind of reminds me of MapServer syntax :
"wms_enable_request" "* !GetFeatureInfo"

So perhaps something like ?
--select *,!geom1,!attr1

I can be wrong but there's no SQL syntax for "* but X and Y", is there ?

> 
> ?
> 
> Thanks, Martin

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ljvillarin30 at gmail.com  Thu Oct 23 20:00:43 2014
From: ljvillarin30 at gmail.com (user_name)
Date: Thu, 23 Oct 2014 20:00:43 -0700 (PDT)
Subject: [gdal-dev] How to merge 4 to 5 images per day using gdal-merge and
 cmd(.bat file)
Message-ID: <1414119643294-5169282.post@n6.nabble.com>

There are 4 to 5 projected images in one day. Let's say I have all the
projected images for 3 days. 

For day 1, the file name are:

T2010232034000.L2.Tera.tif
T2010232035000.L2.Tera.tif
T2010232036000.L2.Tera.tif
T2010232037000.L2.Tera.tif

For day 2, the file name are:

T2010233045000.L2.Tera.tif
T2010233046000.L2.Tera.tif
T2010233047000.L2.Tera.tif
T2010233048000.L2.Tera.tif
T2010233049000.L2.Tera.tif

For day 3, the file name are:

T2010234050000.L2.Tera.tif
T2010234051000.L2.Tera.tif
T2010234052000.L2.Tera.tif
T2010234053000.L2.Tera.tif
T2010234054000.L2.Tera.tif 

How will I merge all the images that are for day 1, for day 2 and for day 3
and save each merged images to a new directory leaving only the
T/datayear/juliandate as the filename for each day. Merging files is easy
but doing it in batch and merging based on the images per day is making me
crazy.

Note: T2010232034000 = Terra/Data Year/Julian Date/HH/MM/SS

Code for merging files:

set in_path=path_to_in_file
set out_path=path_to_out_file

md %out_path%

cd /d %in_path%

FORFILES /C "cmd /c gdal_merge.py -n 0 -a_nodata -32767 -of GTiff -o @path
%out_path%\@fname.tif"



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/How-to-merge-4-to-5-images-per-day-using-gdal-merge-and-cmd-bat-file-tp5169282.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From bontepaarden at gmail.com  Fri Oct 24 00:45:03 2014
From: bontepaarden at gmail.com (Paul Meems)
Date: Fri, 24 Oct 2014 09:45:03 +0200
Subject: [gdal-dev] Create PostGIS database using OGR/GDAL
In-Reply-To: <CAHkRx6HdH4yySFmKh1NpE9m42T0UAXoHyALqwNiK=a0JTPgR1w@mail.gmail.com>
References: <CAHNf2YTxQUA2T7B7fgNS8AXPUTCEP4cS1ETZwebJMCFOhOvNMA@mail.gmail.com>
	<CAHkRx6HdH4yySFmKh1NpE9m42T0UAXoHyALqwNiK=a0JTPgR1w@mail.gmail.com>
Message-ID: <CAHNf2YRJMm5_u-b85PLoCRvosT+4KRCHfFOBLgDEFxejD9ZUzQ@mail.gmail.com>

Thanks for your reply.

MapWinGIS is indeed a Windows-only project written in C++.
My test application is written in C#, so I can use npsql to connect to
PostGIS and send the 'Create database' statement.

But I'm mostly wondering why I can do everything with the PostGIS driver,
except create or drop a database.
Perhaps the driver needs a ExecuteNonQuery() function, like npsql does?




Paul

*Paul Meems *
Release manager, configuration manager
and forum moderator of MapWindow GIS.
www.mapwindow.org

Owner of MapWindow.nl - Support for
Dutch speaking users.
www.mapwindow.nl



*The English presentations of the MapWindow GIS Conference 2014 are online.
<http://www.slideshare.net/mapwindow>*

2014-10-23 22:48 GMT+02:00 M. Edward (Ed) Borasky <znmeb at znmeb.net>:

> If this is a Windows-only project, you can write directly to PostgreSQL /
> PostGIS using the ODBC driver. And if you have shapefiles, there's a
> PostGIS utility called "shp2pgsql" that will import them.
>
> On Thu, Oct 23, 2014 at 1:03 PM, Paul Meems <bontepaarden at gmail.com>
> wrote:
>
>> Hi,
>>
>> At this moment we are working on getting PostGIS support for MapWinGIS.
>> We use the PostGIS driver from GDALv2.
>>
>> So far we can read and write layers.
>> We also want to implement some tests, which are also used as a show case
>> for other users.
>>
>> For these tests I want to create a database, import some layers, doe
>> something with the layers and drop the database again.
>>
>> Creating and dropping a database using ExecuteSQL() doesn't work as
>> stated at the driver page:
>> The PostgreSQL driver does not support creation of new datasets (a
>> database within PostgreSQL), but it does allow creation of new layers
>> within an existing database.
>> The error I'm getting is "CREATE DATABASE cannot run inside a transaction
>> block".
>>
>> Does anybody have an idea how to solve this? I don't want to manually
>> create the database. The tests are more or less running automated. I would
>> also like to prevent to bypass GDAL/OGR and connect to PostGIS directly to
>> create and drop a database.
>>
>> Any suggestions are much appreciated.
>>
>> Thanks,
>>
>> Paul
>>
>> *Paul Meems *
>> Release manager, configuration manager
>> and forum moderator of MapWindow GIS.
>> www.mapwindow.org
>>
>> Owner of MapWindow.nl - Support for
>> Dutch speaking users.
>> www.mapwindow.nl
>>
>>
>>
>> *The English presentations of the MapWindow GIS Conference 2014 are
>> online. <http://www.slideshare.net/mapwindow>*
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>
> --
> Twitter: http://twitter.com/znmeb; Computational Journalism on a Stick
> http://j.mp/CompJournoStickOverview
>
> Remember, if you're traveling to Bactria, Hump Day is Tuesday and
> Thursday.
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141024/59941dca/attachment-0001.html>

From landa.martin at gmail.com  Fri Oct 24 00:46:59 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Fri, 24 Oct 2014 09:46:59 +0200
Subject: [gdal-dev] ogr2ogr and RFC41
In-Reply-To: <201410240116.31361.even.rouault@spatialys.com>
References: <CA+Ei1OfO1RRfU2RnZMrbpm+Gk4ieUQq629PVaWqRpkDzrf4EFQ@mail.gmail.com>
	<201406112345.52734.even.rouault@mines-paris.org>
	<CA+Ei1OeAYVgHZvbSEdGwqxN4gdcz5PkJo4KQB95_DNa3PXncHw@mail.gmail.com>
	<201410240116.31361.even.rouault@spatialys.com>
Message-ID: <CA+Ei1OdhBeDcha7_HjxvHueoEYg3Oavh6izp4aitBu9_c=XK2w@mail.gmail.com>

Hi,

2014-10-24 1:16 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:

> The later kind of reminds me of MapServer syntax :
> "wms_enable_request" "* !GetFeatureInfo"
>
> So perhaps something like ?
> --select *,!geom1,!attr1

yes, it would be nice to have it... Martin

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From pierre.villard at capgemini.com  Fri Oct 24 00:35:30 2014
From: pierre.villard at capgemini.com (VILLARD, Pierre)
Date: Fri, 24 Oct 2014 07:35:30 +0000
Subject: [gdal-dev] gdalwarp giving two different results with the same input
Message-ID: <87274485AF48E74685E99E27416D755F01AD166E@de-cm-mbx21>

Hi,

I am using GDAL (GDAL 1.9.2, released 2012/10/08) to change of EPSG referential on a GeoTiff file. I do the exact same command on two different computers (with the same version of GDAL and tiff libraries). And I get two different results... I am out of options, any idea ? Any place I should have a look ?

Command :

gdalwarp -s_srs EPSG:3975 -t_srs EPSG:4326 input.tif output.tif

Input file :

Driver: GTiff/GeoTIFF
Files: input.tif
Size is 1388, 584
Coordinate System is `'
Origin = (-17321655.543400000780821,7332251.365589999593794)
Pixel Size = (24959.157843515851710,-25110.449882157532556)
Metadata:
lat#_FillValue=9.96921e+36
lat#long_name=latitude
lat#units=degrees_north
lon#_FillValue=9.96921e+36
lon#long_name=longitude
lon#units=degrees_east
NC_GLOBAL#conventions=CF-1.4
NC_GLOBAL#creation_date=2014-10-20T16:12:01
NC_GLOBAL#datum=+ellps = WGS84
NC_GLOBAL#ease_global=yes
NC_GLOBAL#ease_origin_lat=-83.517136
NC_GLOBAL#ease_origin_lon=-179.87032
NC_GLOBAL#ease_projection=cylindrical
NC_GLOBAL#ease_resolution=25
NC_GLOBAL#grip_mapping=projection
NC_GLOBAL#history=none
NC_GLOBAL#institution=SMOS CATDS Processing Chain
NC_GLOBAL#netcdf_version_id=3.6.2
NC_GLOBAL#product_version=1.0
NC_GLOBAL#proj4text=+proj=cea +lon_0=0 +lat_ts=30 +x_0=0 +y_0=0 +ellps=WGS84 +units=m +no_defs
NC_GLOBAL#srid=EPSG:3975
Image Structure Metadata:
INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (-17321655.543, 7332251.366)
Lower Left  (-17321655.543,-7332251.366)
Upper Right (17321655.543, 7332251.366)
Lower Right (17321655.543,-7332251.366)
Center      (   0.0000000,   0.0000000)
Band 1 Block=1388x1 Type=Float64, ColorInterp=Gray

On computer A (the result I am expecting) :

Driver: GTiff/GeoTIFF
Files: output.tif
Size is 1355, 657
Coordinate System is:
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563,
            AUTHORITY["EPSG","7030"]],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0],
    UNIT["degree",0.0174532925199433],
    AUTHORITY["EPSG","4326"]]
Origin = (-179.524544819822239,87.025797325816669)
Pixel Size = (0.264973369536817,-0.264973369536817)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (-179.5245448,  87.0257973) (179d31'28.36"W, 87d 1'32.87"N)
Lower Left  (-179.5245448, -87.0617065) (179d31'28.36"W, 87d 3'42.14"S)
Upper Right ( 179.5143709,  87.0257973) (179d30'51.74"E, 87d 1'32.87"N)
Lower Right ( 179.5143709, -87.0617065) (179d30'51.74"E, 87d 3'42.14"S)
Center      (  -0.0050870,  -0.0179546) (  0d 0'18.31"W,  0d 1' 4.64"S)
Band 1 Block=1355x1 Type=Float64, ColorInterp=Gray

On computer B :

Driver: GTiff/GeoTIFF
Files: output.tif
Size is 1358, 651
Coordinate System is:
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563,
            AUTHORITY["EPSG","7030"]],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0],
    UNIT["degree",0.0174532925199433],
    AUTHORITY["EPSG","4326"]]
Origin = (-179.674959335984454,86.219877359659435)
Pixel Size = (0.264688310439600,-0.264688310439600)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (-179.6749593,  86.2198774) (179d40'29.85"W, 86d13'11.56"N)
Lower Left  (-179.6749593, -86.0922127) (179d40'29.85"W, 86d 5'31.97"S)
Upper Right ( 179.7717662,  86.2198774) (179d46'18.36"E, 86d13'11.56"N)
Lower Right ( 179.7717662, -86.0922127) (179d46'18.36"E, 86d 5'31.97"S)
Center      (   0.0484035,   0.0638323) (  0d 2'54.25"E,  0d 3'49.80"N)
Band 1 Block=1358x1 Type=Float64, ColorInterp=Gray

Thanks for your help !
Regards,
Pierre.
This message contains information that may be privileged or confidential and is the property of the Capgemini Group. It is intended only for the person to whom it is addressed. If you are not the intended recipient, you are not authorized to read, print, retain, copy, disseminate, distribute, or use this message or any part thereof. If you receive this message in error, please notify the sender immediately and delete all copies of this message.


From jrepetto at free.fr  Fri Oct 24 00:57:55 2014
From: jrepetto at free.fr (Jean-Claude Repetto)
Date: Fri, 24 Oct 2014 09:57:55 +0200
Subject: [gdal-dev] How to merge 4 to 5 images per day using gdal-merge
 and cmd(.bat file)
In-Reply-To: <1414119643294-5169282.post@n6.nabble.com>
References: <1414119643294-5169282.post@n6.nabble.com>
Message-ID: <544A0683.40404@free.fr>

Le 24/10/2014 05:00, user_name a ?crit :

>
> How will I merge all the images that are for day 1, for day 2 and for day 3
> and save each merged images to a new directory leaving only the
> T/datayear/juliandate as the filename for each day. Merging files is easy
> but doing it in batch and merging based on the images per day is making me
> crazy.


Your question is not related to GDAL.You should ask it on a Microsoft 
Windows forum or mailing list instead.

BTW, your email program is not configured correctly. Please replace 
"user_name" by your name.

From even.rouault at spatialys.com  Fri Oct 24 01:19:22 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 24 Oct 2014 10:19:22 +0200
Subject: [gdal-dev] Create PostGIS database using OGR/GDAL
In-Reply-To: <CAHNf2YRJMm5_u-b85PLoCRvosT+4KRCHfFOBLgDEFxejD9ZUzQ@mail.gmail.com>
References: <CAHNf2YTxQUA2T7B7fgNS8AXPUTCEP4cS1ETZwebJMCFOhOvNMA@mail.gmail.com>
	<CAHkRx6HdH4yySFmKh1NpE9m42T0UAXoHyALqwNiK=a0JTPgR1w@mail.gmail.com>
	<CAHNf2YRJMm5_u-b85PLoCRvosT+4KRCHfFOBLgDEFxejD9ZUzQ@mail.gmail.com>
Message-ID: <201410241019.22883.even.rouault@spatialys.com>

Le vendredi 24 octobre 2014 09:45:03, Paul Meems a ?crit :
> Thanks for your reply.
> 
> MapWinGIS is indeed a Windows-only project written in C++.
> My test application is written in C#, so I can use npsql to connect to
> PostGIS and send the 'Create database' statement.
> 
> But I'm mostly wondering why I can do everything with the PostGIS driver,
> except create or drop a database.
> Perhaps the driver needs a ExecuteNonQuery() function, like npsql does?

Paul,

Up to know ExecuteSQL() ran passed SQL inside a transaction except when it was 
a VACUUM that requires NOT to be run inside any transaction. Apparently CREATE 
DATABASE too. I've reverted the logic (in trunk): now  passed SQL is always 
run outside of transaction except in the case of SELECT ... FROM .... where we 
actually create a cursor to scroll the results, which require a transaction.
So now I can run CREATE DATABASE

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Oct 24 01:28:17 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 24 Oct 2014 10:28:17 +0200
Subject: [gdal-dev] gdalwarp giving two different results with the same
	input
In-Reply-To: <87274485AF48E74685E99E27416D755F01AD166E@de-cm-mbx21>
References: <87274485AF48E74685E99E27416D755F01AD166E@de-cm-mbx21>
Message-ID: <201410241028.17497.even.rouault@spatialys.com>

Le vendredi 24 octobre 2014 09:35:30, vous avez ?crit :
> Hi,
> 
> I am using GDAL (GDAL 1.9.2, released 2012/10/08) to change of EPSG
> referential on a GeoTiff file. I do the exact same command on two
> different computers (with the same version of GDAL and tiff libraries).
> And I get two different results... I am out of options, any idea ? Any
> place I should have a look ?

Pierre,

In case you did several attempts on computer B, did you erase output.tif 
before re-running gdalwarp ? gdalwarp will not do it (this is the mosaicing 
mode onto an existing target), unless you specify -overwrite.

Is the O.S., architecture and binary distribution of GDAL the same on both 
computers ?

Otherwise the other potential suspects might be the GDAL_DATA environment 
variable not defined or pointing to a wrong directory. Or different proj.4 
versions.

Even

> 
> Command :
> 
> gdalwarp -s_srs EPSG:3975 -t_srs EPSG:4326 input.tif output.tif
> 
> Input file :
> 
> Driver: GTiff/GeoTIFF
> Files: input.tif
> Size is 1388, 584
> Coordinate System is `'
> Origin = (-17321655.543400000780821,7332251.365589999593794)
> Pixel Size = (24959.157843515851710,-25110.449882157532556)
> Metadata:
> lat#_FillValue=9.96921e+36
> lat#long_name=latitude
> lat#units=degrees_north
> lon#_FillValue=9.96921e+36
> lon#long_name=longitude
> lon#units=degrees_east
> NC_GLOBAL#conventions=CF-1.4
> NC_GLOBAL#creation_date=2014-10-20T16:12:01
> NC_GLOBAL#datum=+ellps = WGS84
> NC_GLOBAL#ease_global=yes
> NC_GLOBAL#ease_origin_lat=-83.517136
> NC_GLOBAL#ease_origin_lon=-179.87032
> NC_GLOBAL#ease_projection=cylindrical
> NC_GLOBAL#ease_resolution=25
> NC_GLOBAL#grip_mapping=projection
> NC_GLOBAL#history=none
> NC_GLOBAL#institution=SMOS CATDS Processing Chain
> NC_GLOBAL#netcdf_version_id=3.6.2
> NC_GLOBAL#product_version=1.0
> NC_GLOBAL#proj4text=+proj=cea +lon_0=0 +lat_ts=30 +x_0=0 +y_0=0
> +ellps=WGS84 +units=m +no_defs NC_GLOBAL#srid=EPSG:3975
> Image Structure Metadata:
> INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  (-17321655.543, 7332251.366)
> Lower Left  (-17321655.543,-7332251.366)
> Upper Right (17321655.543, 7332251.366)
> Lower Right (17321655.543,-7332251.366)
> Center      (   0.0000000,   0.0000000)
> Band 1 Block=1388x1 Type=Float64, ColorInterp=Gray
> 
> On computer A (the result I am expecting) :
> 
> Driver: GTiff/GeoTIFF
> Files: output.tif
> Size is 1355, 657
> Coordinate System is:
> GEOGCS["WGS 84",
>     DATUM["WGS_1984",
>         SPHEROID["WGS 84",6378137,298.257223563,
>             AUTHORITY["EPSG","7030"]],
>         AUTHORITY["EPSG","6326"]],
>     PRIMEM["Greenwich",0],
>     UNIT["degree",0.0174532925199433],
>     AUTHORITY["EPSG","4326"]]
> Origin = (-179.524544819822239,87.025797325816669)
> Pixel Size = (0.264973369536817,-0.264973369536817)
> Metadata:
>   AREA_OR_POINT=Area
> Image Structure Metadata:
>   INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  (-179.5245448,  87.0257973) (179d31'28.36"W, 87d 1'32.87"N)
> Lower Left  (-179.5245448, -87.0617065) (179d31'28.36"W, 87d 3'42.14"S)
> Upper Right ( 179.5143709,  87.0257973) (179d30'51.74"E, 87d 1'32.87"N)
> Lower Right ( 179.5143709, -87.0617065) (179d30'51.74"E, 87d 3'42.14"S)
> Center      (  -0.0050870,  -0.0179546) (  0d 0'18.31"W,  0d 1' 4.64"S)
> Band 1 Block=1355x1 Type=Float64, ColorInterp=Gray
> 
> On computer B :
> 
> Driver: GTiff/GeoTIFF
> Files: output.tif
> Size is 1358, 651
> Coordinate System is:
> GEOGCS["WGS 84",
>     DATUM["WGS_1984",
>         SPHEROID["WGS 84",6378137,298.257223563,
>             AUTHORITY["EPSG","7030"]],
>         AUTHORITY["EPSG","6326"]],
>     PRIMEM["Greenwich",0],
>     UNIT["degree",0.0174532925199433],
>     AUTHORITY["EPSG","4326"]]
> Origin = (-179.674959335984454,86.219877359659435)
> Pixel Size = (0.264688310439600,-0.264688310439600)
> Metadata:
>   AREA_OR_POINT=Area
> Image Structure Metadata:
>   INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  (-179.6749593,  86.2198774) (179d40'29.85"W, 86d13'11.56"N)
> Lower Left  (-179.6749593, -86.0922127) (179d40'29.85"W, 86d 5'31.97"S)
> Upper Right ( 179.7717662,  86.2198774) (179d46'18.36"E, 86d13'11.56"N)
> Lower Right ( 179.7717662, -86.0922127) (179d46'18.36"E, 86d 5'31.97"S)
> Center      (   0.0484035,   0.0638323) (  0d 2'54.25"E,  0d 3'49.80"N)
> Band 1 Block=1358x1 Type=Float64, ColorInterp=Gray
> 
> Thanks for your help !
> Regards,
> Pierre.
> This message contains information that may be privileged or confidential
> and is the property of the Capgemini Group. It is intended only for the
> person to whom it is addressed. If you are not the intended recipient, you
> are not authorized to read, print, retain, copy, disseminate, distribute,
> or use this message or any part thereof. If you receive this message in
> error, please notify the sender immediately and delete all copies of this
> message.
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From pierre.villard at capgemini.com  Fri Oct 24 02:06:40 2014
From: pierre.villard at capgemini.com (VILLARD, Pierre)
Date: Fri, 24 Oct 2014 09:06:40 +0000
Subject: [gdal-dev] gdalwarp giving two different results with the same
 input
In-Reply-To: <201410241028.17497.even.rouault@spatialys.com>
References: <87274485AF48E74685E99E27416D755F01AD166E@de-cm-mbx21>
	<201410241028.17497.even.rouault@spatialys.com>
Message-ID: <87274485AF48E74685E99E27416D755F01AD1764@de-cm-mbx21>

Hi Even, thanks for your reply !

On one side I had :
proj-4.7.0-1.el6.rf.x86_64

On the other (on the computer with expecting results) :
proj-4.8.0-3.el6.x86_64

With the same versions, I get the same results !

Thanks a lot !

-----Message d'origine-----
De?: Even Rouault [mailto:even.rouault at spatialys.com] 
Envoy??: vendredi 24 octobre 2014 10:28
??: VILLARD, Pierre
Cc?: gdal-dev at lists.osgeo.org
Objet?: Re: [gdal-dev] gdalwarp giving two different results with the same input

Le vendredi 24 octobre 2014 09:35:30, vous avez ?crit :
> Hi,
> 
> I am using GDAL (GDAL 1.9.2, released 2012/10/08) to change of EPSG 
> referential on a GeoTiff file. I do the exact same command on two 
> different computers (with the same version of GDAL and tiff libraries).
> And I get two different results... I am out of options, any idea ? Any 
> place I should have a look ?

Pierre,

In case you did several attempts on computer B, did you erase output.tif before re-running gdalwarp ? gdalwarp will not do it (this is the mosaicing mode onto an existing target), unless you specify -overwrite.

Is the O.S., architecture and binary distribution of GDAL the same on both computers ?

Otherwise the other potential suspects might be the GDAL_DATA environment variable not defined or pointing to a wrong directory. Or different proj.4 versions.

Even

> 
> Command :
> 
> gdalwarp -s_srs EPSG:3975 -t_srs EPSG:4326 input.tif output.tif
> 
> Input file :
> 
> Driver: GTiff/GeoTIFF
> Files: input.tif
> Size is 1388, 584
> Coordinate System is `'
> Origin = (-17321655.543400000780821,7332251.365589999593794)
> Pixel Size = (24959.157843515851710,-25110.449882157532556)
> Metadata:
> lat#_FillValue=9.96921e+36
> lat#long_name=latitude
> lat#units=degrees_north
> lon#_FillValue=9.96921e+36
> lon#long_name=longitude
> lon#units=degrees_east
> NC_GLOBAL#conventions=CF-1.4
> NC_GLOBAL#creation_date=2014-10-20T16:12:01
> NC_GLOBAL#datum=+ellps = WGS84
> NC_GLOBAL#ease_global=yes
> NC_GLOBAL#ease_origin_lat=-83.517136
> NC_GLOBAL#ease_origin_lon=-179.87032
> NC_GLOBAL#ease_projection=cylindrical
> NC_GLOBAL#ease_resolution=25
> NC_GLOBAL#grip_mapping=projection
> NC_GLOBAL#history=none
> NC_GLOBAL#institution=SMOS CATDS Processing Chain
> NC_GLOBAL#netcdf_version_id=3.6.2
> NC_GLOBAL#product_version=1.0
> NC_GLOBAL#proj4text=+proj=cea +lon_0=0 +lat_ts=30 +x_0=0 +y_0=0
> +ellps=WGS84 +units=m +no_defs NC_GLOBAL#srid=EPSG:3975
> Image Structure Metadata:
> INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  (-17321655.543, 7332251.366) Lower Left  
> (-17321655.543,-7332251.366) Upper Right (17321655.543, 7332251.366) 
> Lower Right (17321655.543,-7332251.366)
> Center      (   0.0000000,   0.0000000)
> Band 1 Block=1388x1 Type=Float64, ColorInterp=Gray
> 
> On computer A (the result I am expecting) :
> 
> Driver: GTiff/GeoTIFF
> Files: output.tif
> Size is 1355, 657
> Coordinate System is:
> GEOGCS["WGS 84",
>     DATUM["WGS_1984",
>         SPHEROID["WGS 84",6378137,298.257223563,
>             AUTHORITY["EPSG","7030"]],
>         AUTHORITY["EPSG","6326"]],
>     PRIMEM["Greenwich",0],
>     UNIT["degree",0.0174532925199433],
>     AUTHORITY["EPSG","4326"]]
> Origin = (-179.524544819822239,87.025797325816669)
> Pixel Size = (0.264973369536817,-0.264973369536817)
> Metadata:
>   AREA_OR_POINT=Area
> Image Structure Metadata:
>   INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  (-179.5245448,  87.0257973) (179d31'28.36"W, 87d 
> 1'32.87"N) Lower Left  (-179.5245448, -87.0617065) (179d31'28.36"W, 
> 87d 3'42.14"S) Upper Right ( 179.5143709,  87.0257973) 
> (179d30'51.74"E, 87d 1'32.87"N) Lower Right ( 179.5143709, -87.0617065) (179d30'51.74"E, 87d 3'42.14"S)
> Center      (  -0.0050870,  -0.0179546) (  0d 0'18.31"W,  0d 1' 4.64"S)
> Band 1 Block=1355x1 Type=Float64, ColorInterp=Gray
> 
> On computer B :
> 
> Driver: GTiff/GeoTIFF
> Files: output.tif
> Size is 1358, 651
> Coordinate System is:
> GEOGCS["WGS 84",
>     DATUM["WGS_1984",
>         SPHEROID["WGS 84",6378137,298.257223563,
>             AUTHORITY["EPSG","7030"]],
>         AUTHORITY["EPSG","6326"]],
>     PRIMEM["Greenwich",0],
>     UNIT["degree",0.0174532925199433],
>     AUTHORITY["EPSG","4326"]]
> Origin = (-179.674959335984454,86.219877359659435)
> Pixel Size = (0.264688310439600,-0.264688310439600)
> Metadata:
>   AREA_OR_POINT=Area
> Image Structure Metadata:
>   INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  (-179.6749593,  86.2198774) (179d40'29.85"W, 
> 86d13'11.56"N) Lower Left  (-179.6749593, -86.0922127) 
> (179d40'29.85"W, 86d 5'31.97"S) Upper Right ( 179.7717662,  
> 86.2198774) (179d46'18.36"E, 86d13'11.56"N) Lower Right ( 179.7717662, -86.0922127) (179d46'18.36"E, 86d 5'31.97"S)
> Center      (   0.0484035,   0.0638323) (  0d 2'54.25"E,  0d 3'49.80"N)
> Band 1 Block=1358x1 Type=Float64, ColorInterp=Gray
> 
> Thanks for your help !
> Regards,
> Pierre.
> This message contains information that may be privileged or 
> confidential and is the property of the Capgemini Group. It is 
> intended only for the person to whom it is addressed. If you are not 
> the intended recipient, you are not authorized to read, print, retain, 
> copy, disseminate, distribute, or use this message or any part 
> thereof. If you receive this message in error, please notify the 
> sender immediately and delete all copies of this message.
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

--
Spatialys - Geospatial professional services http://www.spatialys.com
This message contains information that may be privileged or confidential and is the property of the Capgemini Group. It is intended only for the person to whom it is addressed. If you are not the intended recipient, you are not authorized to read, print, retain, copy, disseminate, distribute, or use this message or any part thereof. If you receive this message in error, please notify the sender immediately and delete all copies of this message.


From daniel.teske at web.de  Fri Oct 24 05:37:59 2014
From: daniel.teske at web.de (teeschke)
Date: Fri, 24 Oct 2014 05:37:59 -0700 (PDT)
Subject: [gdal-dev] handle GRIB files in polar stereographic projection
In-Reply-To: <1412670469448-5166269.post@n6.nabble.com>
References: <1412623930082-5166227.post@n6.nabble.com>
	<1412670469448-5166269.post@n6.nabble.com>
Message-ID: <1414154279586-5169393.post@n6.nabble.com>

I was able to transform the grib files to NetCDF using the Unidata NetCDF
Tools. 
java -classpath netcdfAll-4.3.jar ucar.nc2.dataset.NetcdfDataset -in
ice_conc_nh.grb -out ice_conc_nh.nc

Amazingly GDAL can now work with this files. Here is the gdalinfo
(Coordinates are in Days)

$ gdalinfo NETCDF:ice_conc_nh.nc:Ice_cover_surface
Driver: netCDF/Network Common Data Format
Files: ice_conc_nh.nc
       ice_conc_nh.nc.aux.xml
Size is 760, 1120
Coordinate System is:
PROJCS["unnamed",
    GEOGCS["unknown",
        DATUM["unknown",
            SPHEROID["Sphere",6371229,0]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Stereographic"],
    PARAMETER["latitude_of_origin",90],
    PARAMETER["central_meridian",-45.00000381469727],
    PARAMETER["scale_factor",0.9330127018922193],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["kilometre",1000,
        AUTHORITY["EPSG","9036"]]]
Origin = (-3698.443603515625000,6060.704589843750000)
Pixel Size = (10.000000000000000,-10.000000000000000)
Metadata:
  Ice_cover_surface#coordinates=time 
  Ice_cover_surface#description=Ice cover
  Ice_cover_surface#Grib1_Center=88
  Ice_cover_surface#Grib1_Level_Desc=Ground or water surface
  Ice_cover_surface#Grib1_Level_Type=1
  Ice_cover_surface#Grib1_Parameter=91
  Ice_cover_surface#Grib1_Subcenter=0
  Ice_cover_surface#Grib1_TableVersion=1
  Ice_cover_surface#Grib_Variable_Id=VAR_88-0-1-91_L1
  Ice_cover_surface#grid_mapping=PolarStereographic_Projection
  Ice_cover_surface#long_name=Ice cover @ Ground or water surface
  Ice_cover_surface#missing_value=nan
  Ice_cover_surface#units=proportion
  NC_GLOBAL#Conventions=CF-1.6
  NC_GLOBAL#featureType=GRID
  NC_GLOBAL#file_format=GRIB-1
  NC_GLOBAL#GRIB_table_version=0,1
  NC_GLOBAL#history=Read using CDM IOSP GribCollection v2
  NC_GLOBAL#Originating_or_generating_Center=Oslo
  NC_GLOBAL#Originating_or_generating_Subcenter=0
  NETCDF_DIM_EXTRA={time}
  NETCDF_DIM_time_DEF={1,6}
  NETCDF_DIM_time_VALUES=0
  PolarStereographic_Projection#earth_radius=6371229
  PolarStereographic_Projection#grid_mapping_name=stereographic
  PolarStereographic_Projection#latitude_of_projection_origin=90
 
PolarStereographic_Projection#longitude_of_projection_origin=-45.00000381469727
 
PolarStereographic_Projection#scale_factor_at_projection_origin=0.9330127018922193
  reftime#long_name=GRIB reference time
  reftime#standard_name=forecast_reference_time
  reftime#units=Hour since 2014-09-20T12:00:00Z
  time#long_name=GRIB forecast or observation time
  time#standard_name=time
  time#units=Hour since 2014-09-20T12:00:00Z
  x#standard_name=projection_x_coordinate
  x#units=km
  y#standard_name=projection_y_coordinate
  y#units=km
Corner Coordinates:
Upper Left  (   -3698.444,    6060.705) (166d23'34.54"E, 28d18'31.13"N)
Lower Left  (   -3698.444,   -5139.295) ( 80d44'25.12"W, 33d55'21.31"N)
Upper Right (    3901.556,    6060.705) (102d13'43.45"E, 27d32'42.72"N)
Lower Right (    3901.556,   -5139.295) (  7d47'44.26"W, 33d 1'11.09"N)
Center      (     101.556,     460.705) (122d34' 7.29"E, 85d27'18.90"N)
Band 1 Block=760x1 Type=Float32, ColorInterp=Undefined
  Min=-199.000 Max=100.000 
  Minimum=-199.000, Maximum=100.000, Mean=-51.973, StdDev=63.146
  NoData Value=nan
  Metadata:
    coordinates=time 
    description=Ice cover
    Grib1_Center=88
    Grib1_Level_Desc=Ground or water surface
    Grib1_Level_Type=1
    Grib1_Parameter=91
    Grib1_Subcenter=0
    Grib1_TableVersion=1
    Grib_Variable_Id=VAR_88-0-1-91_L1
    grid_mapping=PolarStereographic_Projection
    long_name=Ice cover @ Ground or water surface
    missing_value=nan
    NETCDF_DIM_time=0
    NETCDF_VARNAME=Ice_cover_surface
    STATISTICS_MAXIMUM=100
    STATISTICS_MEAN=-51.973378845782
    STATISTICS_MINIMUM=-199
    STATISTICS_STDDEV=63.146033919353
    units=proportion

This is the resulting Proj4-String
"+proj=stere +lat_0=90 +lon_0=-45.00000381469727 +k=0.9330127018922193
+x_0=0 +y_0=0 +a=6371229 +b=6371229 +units=km +no_defs"


The current pitfall is that gdalwarp cannot transform the data


$ gdalwarp -t_srs EPSG:4326 NETCDF:ice_conc_nh.nc:Ice_cover_surface
trans/ice_conc_nh_4326.tiff
(image is attached)

Here is the gdalinfo of the WGS84 GeoTiff (SIZE gets very small &
Coordinates are in Days like the original data)

Driver: GTiff/GeoTIFF
Files: trans/ice_conc_nh_4326.tiff
Size is 2761, 217
Coordinate System is:
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563,
            AUTHORITY["EPSG","7030"]],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0],
    UNIT["degree",0.0174532925199433],
    AUTHORITY["EPSG","4326"]]
Origin = (-176.400770410834753,55.428082489041401)
Pixel Size = (0.128740639134764,-0.128740639134764)
... ... ...Metadata... ... ...
Corner Coordinates:
Upper Left  (-176.4007704,  55.4280825) (176d24' 2.77"W, 55d25'41.10"N)
Lower Left  (-176.4007704,  27.4913638) (176d24' 2.77"W, 27d29'28.91"N)
Upper Right ( 179.0521342,  55.4280825) (179d 3' 7.68"E, 55d25'41.10"N)
Lower Right ( 179.0521342,  27.4913638) (179d 3' 7.68"E, 27d29'28.91"N)
Center      (   1.3256819,  41.4597231) (  1d19'32.45"E, 41d27'35.00"N)
... ... ...Other Stuff... ... ...

Do you see a way to fix the data and transform it correctly?





--
View this message in context: http://osgeo-org.1560.x6.nabble.com/handle-GRIB-files-in-polar-stereographic-projection-tp5166227p5169393.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From daniel.teske at web.de  Fri Oct 24 06:50:04 2014
From: daniel.teske at web.de (teeschke)
Date: Fri, 24 Oct 2014 06:50:04 -0700 (PDT)
Subject: [gdal-dev] handle GRIB files in polar stereographic projection
In-Reply-To: <1414154279586-5169393.post@n6.nabble.com>
References: <1412623930082-5166227.post@n6.nabble.com>
	<1412670469448-5166269.post@n6.nabble.com>
	<1414154279586-5169393.post@n6.nabble.com>
Message-ID: <1414158604593-5169424.post@n6.nabble.com>

I found out that the coordinates of other polar stereographic GRIB files are
also out of alignment.
see ftp://polar.ncep.noaa.gov/ice/

So lets get back to the very general question: How to handle polar
stereographic projected GRIB files like the ice coverages from NOAA?

Thank you so much and best regards
teeschke




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/handle-GRIB-files-in-polar-stereographic-projection-tp5166227p5169424.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From vbubbly21 at gmail.com  Fri Oct 24 21:03:22 2014
From: vbubbly21 at gmail.com (Artur Bercik)
Date: Sat, 25 Oct 2014 13:03:22 +0900
Subject: [gdal-dev] Transform pixel coordinates
Message-ID: <CA+F4vinQ_gR2SuVdSyWNmcmsQHPqUF5KsvcKk+0HeAAd6ZQaAQ@mail.gmail.com>

Dear GDAL users

I have a raster image of 406 lines and 270 samples with 5km pixel size. The
center coordinates (lats and lons in degrees in GCS) of upper left pixel,
and the center coordinates (lats and lons in degrees in GCS) of the lower
right pixel  are given, how can I calculate the coordinates of upper left
corner (ulx and uly) and the coordinates of lower right corner (lrx and
lry)?


upperLeftCentralX, upperLeftCentralY = 150.1234, 50.1234

pixelWidth, pixelHeight = 5, 5

cols, rows = 270, 406

upperLeftX, upperLeftY = ?, ?

Thanks in the advance.

Artur
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141025/b44493ef/attachment.html>

From vbubbly21 at gmail.com  Fri Oct 24 21:17:29 2014
From: vbubbly21 at gmail.com (Artur Bercik)
Date: Sat, 25 Oct 2014 13:17:29 +0900
Subject: [gdal-dev] Write a Custom GeoTransform and
Message-ID: <CA+F4vikDnrdMFFCyVxDYNb4Mc-wbD_BbifZYwVJPeybmVgsDDQ@mail.gmail.com>

Dear GDAL users:


How can I write a custom projection with the following information in order
to feed into gdaltranslate so that I can convert a TIFF file into GeoTiff
file.

upperLeftX, upperLeftY = 150.1234, 50.1234 (They are in GCS with WGS84
datum)
pixelWidth, pixelHeight = 5 km, 5 km
totalColumns, TotalRows = 270, 406

I prefer to use GDAL python.

Thanks in the advance.

Artur
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141025/715afcd7/attachment.html>

From andre+joost at nurfuerspam.de  Fri Oct 24 22:00:55 2014
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Sat, 25 Oct 2014 07:00:55 +0200
Subject: [gdal-dev] Transform pixel coordinates
In-Reply-To: <CA+F4vinQ_gR2SuVdSyWNmcmsQHPqUF5KsvcKk+0HeAAd6ZQaAQ@mail.gmail.com>
References: <CA+F4vinQ_gR2SuVdSyWNmcmsQHPqUF5KsvcKk+0HeAAd6ZQaAQ@mail.gmail.com>
Message-ID: <m2fat8$c41$1@ger.gmane.org>

Am 25.10.2014 um 06:03 schrieb Artur Bercik:
> Dear GDAL users
>
> I have a raster image of 406 lines and 270 samples with 5km pixel size. The
> center coordinates (lats and lons in degrees in GCS) of upper left pixel,
> and the center coordinates (lats and lons in degrees in GCS) of the lower
> right pixel  are given, how can I calculate the coordinates of upper left
> corner (ulx and uly) and the coordinates of lower right corner (lrx and
> lry)?
>

You need to know the projection definition to calculate from distance in 
pixel or km to degrees.

Greetings,
Andr? Joost



From vbubbly21 at gmail.com  Fri Oct 24 22:05:11 2014
From: vbubbly21 at gmail.com (Artur Bercik)
Date: Sat, 25 Oct 2014 14:05:11 +0900
Subject: [gdal-dev] Transform pixel coordinates
In-Reply-To: <m2fat8$c41$1@ger.gmane.org>
References: <CA+F4vinQ_gR2SuVdSyWNmcmsQHPqUF5KsvcKk+0HeAAd6ZQaAQ@mail.gmail.com>
	<m2fat8$c41$1@ger.gmane.org>
Message-ID: <CA+F4vi=7B8brU-E+G-hvCCW-LOD7rUYYaCPFx0YEks1o4NSSCA@mail.gmail.com>

On Sat, Oct 25, 2014 at 2:00 PM, Andre Joost <andre+joost at nurfuerspam.de>
wrote:

> Am 25.10.2014 um 06:03 schrieb Artur Bercik:
>
>> Dear GDAL users
>>
>> I have a raster image of 406 lines and 270 samples with 5km pixel size.
>> The
>> center coordinates (lats and lons in degrees in GCS) of upper left pixel,
>> and the center coordinates (lats and lons in degrees in GCS) of the lower
>> right pixel  are given, how can I calculate the coordinates of upper left
>> corner (ulx and uly) and the coordinates of lower right corner (lrx and
>> lry)?
>>
>>
> You need to know the projection definition to calculate from distance in
> pixel or km to degrees.
>

yes the projection are in GCS with WGS84 datum

>
> Greetings,
> Andr? Joost
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141025/5f5cc122/attachment.html>

From andre+joost at nurfuerspam.de  Sat Oct 25 00:09:43 2014
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Sat, 25 Oct 2014 09:09:43 +0200
Subject: [gdal-dev] Transform pixel coordinates
In-Reply-To: <CA+F4vi=7B8brU-E+G-hvCCW-LOD7rUYYaCPFx0YEks1o4NSSCA@mail.gmail.com>
References: <CA+F4vinQ_gR2SuVdSyWNmcmsQHPqUF5KsvcKk+0HeAAd6ZQaAQ@mail.gmail.com>	<m2fat8$c41$1@ger.gmane.org>
	<CA+F4vi=7B8brU-E+G-hvCCW-LOD7rUYYaCPFx0YEks1o4NSSCA@mail.gmail.com>
Message-ID: <m2fioe$m2v$2@ger.gmane.org>

Am 25.10.2014 um 07:05 schrieb Artur Bercik:
> On Sat, Oct 25, 2014 at 2:00 PM, Andre Joost <andre+joost at nurfuerspam.de>
> wrote:
>
>> Am 25.10.2014 um 06:03 schrieb Artur Bercik:
>>
>>> Dear GDAL users
>>>
>>> I have a raster image of 406 lines and 270 samples with 5km pixel size.
>>> The
>>> center coordinates (lats and lons in degrees in GCS) of upper left pixel,
>>> and the center coordinates (lats and lons in degrees in GCS) of the lower
>>> right pixel  are given, how can I calculate the coordinates of upper left
>>> corner (ulx and uly) and the coordinates of lower right corner (lrx and
>>> lry)?
>>>
>>>
>> You need to know the projection definition to calculate from distance in
>> pixel or km to degrees.
>>
>
> yes the projection are in GCS with WGS84 datum
>

GCS has units of degrees, not kilometers. Your image is 2030x1350 km, 
but you have to know if it is Mercator, Transverse Mercator, Lambert 
Coformal Conical, Stereographic, Albers Equal Area, Sinusoidal or 
whatever. And you have to know the origin of the projection, like 
Central meridian of UTM projections. And if North is upwards or not.

Greetings,
Andr? Joost



From vbubbly21 at gmail.com  Sat Oct 25 00:29:13 2014
From: vbubbly21 at gmail.com (Artur Bercik)
Date: Sat, 25 Oct 2014 16:29:13 +0900
Subject: [gdal-dev] Transform pixel coordinates
In-Reply-To: <m2fioe$m2v$2@ger.gmane.org>
References: <CA+F4vinQ_gR2SuVdSyWNmcmsQHPqUF5KsvcKk+0HeAAd6ZQaAQ@mail.gmail.com>
	<m2fat8$c41$1@ger.gmane.org>
	<CA+F4vi=7B8brU-E+G-hvCCW-LOD7rUYYaCPFx0YEks1o4NSSCA@mail.gmail.com>
	<m2fioe$m2v$2@ger.gmane.org>
Message-ID: <CA+F4vinhynYuUWahc0xme5sxn91LCB3EJkfyWJxedT3eit-O3w@mail.gmail.com>

On Sat, Oct 25, 2014 at 4:09 PM, Andre Joost <andre+joost at nurfuerspam.de>
wrote:

> Am 25.10.2014 um 07:05 schrieb Artur Bercik:
>
>> On Sat, Oct 25, 2014 at 2:00 PM, Andre Joost <andre+joost at nurfuerspam.de>
>> wrote:
>>
>>  Am 25.10.2014 um 06:03 schrieb Artur Bercik:
>>>
>>>  Dear GDAL users
>>>>
>>>> I have a raster image of 406 lines and 270 samples with 5km pixel size.
>>>> The
>>>> center coordinates (lats and lons in degrees in GCS) of upper left
>>>> pixel,
>>>> and the center coordinates (lats and lons in degrees in GCS) of the
>>>> lower
>>>> right pixel  are given, how can I calculate the coordinates of upper
>>>> left
>>>> corner (ulx and uly) and the coordinates of lower right corner (lrx and
>>>> lry)?
>>>>
>>>>
>>>>  You need to know the projection definition to calculate from distance
>>> in
>>> pixel or km to degrees.
>>>
>>>
>> yes the projection are in GCS with WGS84 datum
>>
>>
> GCS has units of degrees, not kilometers. Your image is 2030x1350 km, but
> you have to know if it is Mercator, Transverse Mercator, Lambert Coformal
> Conical, Stereographic, Albers Equal Area, Sinusoidal or whatever. And you
> have to know the origin of the projection, like Central meridian of UTM
> projections. And if North is upwards or not.
>
> sorry, yes the pixel size are in degrees,0.047 deg.(5 km approx. at
equator), in GCS and WGS84.

>
> Greetings,
> Andr? Joost
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141025/0e4eeff2/attachment.html>

From andre+joost at nurfuerspam.de  Sat Oct 25 01:05:41 2014
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Sat, 25 Oct 2014 10:05:41 +0200
Subject: [gdal-dev] Transform pixel coordinates
In-Reply-To: <CA+F4vinhynYuUWahc0xme5sxn91LCB3EJkfyWJxedT3eit-O3w@mail.gmail.com>
References: <CA+F4vinQ_gR2SuVdSyWNmcmsQHPqUF5KsvcKk+0HeAAd6ZQaAQ@mail.gmail.com>	<m2fat8$c41$1@ger.gmane.org>	<CA+F4vi=7B8brU-E+G-hvCCW-LOD7rUYYaCPFx0YEks1o4NSSCA@mail.gmail.com>	<m2fioe$m2v$2@ger.gmane.org>
	<CA+F4vinhynYuUWahc0xme5sxn91LCB3EJkfyWJxedT3eit-O3w@mail.gmail.com>
Message-ID: <m2flnc$v38$1@ger.gmane.org>

Am 25.10.2014 um 09:29 schrieb Artur Bercik:

>>
> sorry, yes the pixel size are in degrees,0.047 deg.(5 km approx. at
> equator), in GCS and WGS84.
>

Ok, then it is easy. Using the values from your other post:

upperLeftX, upperLeftY = 150.1234, 50.1234 (They are in GCS with WGS84
datum)
pixelWidth, pixelHeight = 0.047, 0.047
totalColumns, TotalRows = 270, 406

and assuming the coordinates are East and North positive. To 
georeference the image, set the extent in gdal_translate with -a_srs 
EPSG:4326 and -a_ullr ulx uly lrx lry

ulx and uly are known, the others are
lrx = ulx + 270 * 0.047
lry = uly - 406 * 0.047

This does not work if your image is not North-orientated.

HTH,
Andr? Joost





From mcasella03 at gmail.com  Sat Oct 25 02:05:56 2014
From: mcasella03 at gmail.com (Marco Casella)
Date: Sat, 25 Oct 2014 11:05:56 +0200
Subject: [gdal-dev] Ecw format
Message-ID: <F446B877-2175-41C3-8DCB-F1BFA46863CC@gmail.com>

How Can I transform some tiff file in ecw format? Any tips is well appreciated. 

Regards

Marco



From vbubbly21 at gmail.com  Sat Oct 25 03:00:09 2014
From: vbubbly21 at gmail.com (Artur Bercik)
Date: Sat, 25 Oct 2014 19:00:09 +0900
Subject: [gdal-dev] Transform pixel coordinates
In-Reply-To: <m2flnc$v38$1@ger.gmane.org>
References: <CA+F4vinQ_gR2SuVdSyWNmcmsQHPqUF5KsvcKk+0HeAAd6ZQaAQ@mail.gmail.com>
	<m2fat8$c41$1@ger.gmane.org>
	<CA+F4vi=7B8brU-E+G-hvCCW-LOD7rUYYaCPFx0YEks1o4NSSCA@mail.gmail.com>
	<m2fioe$m2v$2@ger.gmane.org>
	<CA+F4vinhynYuUWahc0xme5sxn91LCB3EJkfyWJxedT3eit-O3w@mail.gmail.com>
	<m2flnc$v38$1@ger.gmane.org>
Message-ID: <CA+F4vinjfSPEScdvGVirSP8_icHTqoza311wo2Edv_XvWwBU_Q@mail.gmail.com>

On Sat, Oct 25, 2014 at 5:05 PM, Andre Joost <andre+joost at nurfuerspam.de>
wrote:

> Am 25.10.2014 um 09:29 schrieb Artur Bercik:
>
>
>>>  sorry, yes the pixel size are in degrees,0.047 deg.(5 km approx. at
>> equator), in GCS and WGS84.
>>
>>
> Ok, then it is easy. Using the values from your other post:
>
> upperLeftX, upperLeftY = 150.1234, 50.1234 (They are in GCS with WGS84
> datum)
> pixelWidth, pixelHeight = 0.047, 0.047
> totalColumns, TotalRows = 270, 406
>
> and assuming the coordinates are East and North positive. To georeference
> the image, set the extent in gdal_translate with -a_srs EPSG:4326 and
> -a_ullr ulx uly lrx lry
>
> ulx and uly are known, the others are
> lrx = ulx + 270 * 0.047
> lry = uly - 406 * 0.047
>
> This does not work if your image is not North-orientated.
>
> HTH,
>
> Andr? Joost
>

Thank you very much, I have adopted it.

>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141025/897c25fc/attachment.html>

From andre+joost at nurfuerspam.de  Sat Oct 25 04:05:34 2014
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Sat, 25 Oct 2014 13:05:34 +0200
Subject: [gdal-dev] Ecw format
In-Reply-To: <F446B877-2175-41C3-8DCB-F1BFA46863CC@gmail.com>
References: <F446B877-2175-41C3-8DCB-F1BFA46863CC@gmail.com>
Message-ID: <m2g08e$mdp$1@ger.gmane.org>

Am 25.10.2014 um 11:05 schrieb Marco Casella:
> How Can I transform some tiff file in ecw format? Any tips is well appreciated.
>

You have to buy a license from ERDAS to do that.

Or you may find an old ECW driver with SDK v3.3 which allowed a limited 
filesize for file freation as well.

The current SDK v5 is read-only.

Greetings,
Andr? Joost



From landa.martin at gmail.com  Sun Oct 26 08:10:48 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Sun, 26 Oct 2014 16:10:48 +0100
Subject: [gdal-dev] ogr2ogr and RFC41
In-Reply-To: <CA+Ei1OdhBeDcha7_HjxvHueoEYg3Oavh6izp4aitBu9_c=XK2w@mail.gmail.com>
References: <CA+Ei1OfO1RRfU2RnZMrbpm+Gk4ieUQq629PVaWqRpkDzrf4EFQ@mail.gmail.com>
	<201406112345.52734.even.rouault@mines-paris.org>
	<CA+Ei1OeAYVgHZvbSEdGwqxN4gdcz5PkJo4KQB95_DNa3PXncHw@mail.gmail.com>
	<201410240116.31361.even.rouault@spatialys.com>
	<CA+Ei1OdhBeDcha7_HjxvHueoEYg3Oavh6izp4aitBu9_c=XK2w@mail.gmail.com>
Message-ID: <CA+Ei1Oc7+PaXfHDVBr9=Tt7CZzjqpMLY2M_8-RNj4ZD4ocJbUA@mail.gmail.com>

Hi,

2014-10-24 9:46 GMT+02:00 Martin Landa <landa.martin at gmail.com>:
>> So perhaps something like ?
>> --select *,!geom1,!attr1
>
> yes, it would be nice to have it... Martin

the attached patch shows a way, I am sure that it's possible to
simplily it. Anyway combination as (assuming that a source layer has
three geometry columns) seems to work:

$ ogr2ogr -f PostgreSQL -select '*' PG:dbname=vfr_10 PG:dbname=vfr
staty -overwrite

-> OK all attributes + geom1

$ ogr2ogr -f PostgreSQL -select '*,!geom1' PG:dbname=vfr_10
PG:dbname=vfr staty -overwrite

-> OK, all atributes + geom2

$ ogr2ogr -f PostgreSQL -select '*,!geom1,!geom2' PG:dbname=vfr_10
PG:dbname=vfr staty -overwrite

-> OK, all atributes + geom3

BTW, I would assume that if the destination datasource supports RFC41
than ogr2ogr transfers all geometry columns, but it doesn't seems to
be true, eg.:

$ ogrinfo PG:dbname=vfr staty | grep Geometry
Geometry (definicnibod): Point
Geometry (originalnihranice): Multi Polygon
Geometry (generalizovanehranice): Multi Polygon
Geometry Column 1 = definicnibod
Geometry Column 2 = originalnihranice
Geometry Column 3 = generalizovanehranice

$ ogr2ogr -f PostgreSQL PG:dbname=vfr_10 PG:dbname=vfr staty -overwrite

$ ogrinfo PG:dbname=vfr_10 staty | grep Geometry
Geometry: Unknown (any)
Geometry Column = GEOMETRY

Martin

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa *
http://www.gismentors.eu/mentors/landa
-------------- next part --------------
Index: apps/ogr2ogr.cpp
===================================================================
--- apps/ogr2ogr.cpp	(revision 27908)
+++ apps/ogr2ogr.cpp	(working copy)
@@ -38,6 +38,7 @@
 #include "commonutils.h"
 #include <map>
 #include <vector>
+#include <algorithm>
 
 CPL_CVSID("$Id$");
 
@@ -76,6 +77,9 @@
     TargetLayerInfo  *psInfo;
 } AssociatedLayers;
 
+static std::vector<CPLString> FilterSelectFields(OGRFeatureDefn *poSrcFDefn,
+                                                 char **papszSelFields, bool);
+
 static OGRLayer* GetLayerAndOverwriteIfNecessary(GDALDataset *poDstDS,
                                                  const char* pszNewLayerName,
                                                  int bOverwrite,
@@ -2561,6 +2565,8 @@
     OGRFeatureDefn *poSrcFDefn;
     OGRFeatureDefn *poDstFDefn = NULL;
 
+    std::vector<CPLString> oSelFields;
+
     if( pszNewLayerName == NULL )
         pszNewLayerName = poSrcLayer->GetName();
 
@@ -2570,15 +2576,22 @@
     poSrcFDefn = poSrcLayer->GetLayerDefn();
 
 /* -------------------------------------------------------------------- */
+/*      Filter select fields (*, !col).                                 */
+/* -------------------------------------------------------------------- */
+    if (papszSelFields)
+        oSelFields = FilterSelectFields(poSrcFDefn, papszSelFields,
+                                        poDstDS->TestCapability(ODsCCreateGeomFieldAfterCreateLayer));
+
+/* -------------------------------------------------------------------- */
 /*      Find requested geometry fields.                                 */
 /* -------------------------------------------------------------------- */
     std::vector<int> anRequestedGeomFields;
     int nSrcGeomFieldCount = poSrcFDefn->GetGeomFieldCount();
-    if (papszSelFields && !bAppend )
+    if (oSelFields.size() > 0 && !bAppend )
     {
-        for( int iField=0; papszSelFields[iField] != NULL; iField++)
+        for( size_t iField=0; iField < oSelFields.size(); iField++)
         {
-            int iSrcField = poSrcFDefn->GetFieldIndex(papszSelFields[iField]);
+            int iSrcField = poSrcFDefn->GetFieldIndex(oSelFields[iField]);
             if (iSrcField >= 0)
             {
                 /* do nothing */
@@ -2585,7 +2598,7 @@
             }
             else
             {
-                iSrcField = poSrcFDefn->GetGeomFieldIndex(papszSelFields[iField]);
+                iSrcField = poSrcFDefn->GetGeomFieldIndex(oSelFields[iField]);
                 if( iSrcField >= 0)
                 {
                     anRequestedGeomFields.push_back(iSrcField);
@@ -2593,7 +2606,7 @@
                 else
                 {
                     fprintf( stderr, "Field '%s' not found in source layer.\n",
-                            papszSelFields[iField] );
+                             oSelFields[iField].c_str() );
                     if( !bSkipFailures )
                         return NULL;
                 }
@@ -2797,8 +2810,8 @@
 /*      the selected fields, and in the order that they were            */
 /*      selected.                                                       */
 /* -------------------------------------------------------------------- */
-    int         nSrcFieldCount = poSrcFDefn->GetFieldCount();
-    int         iField, *panMap;
+    int      nSrcFieldCount = poSrcFDefn->GetFieldCount();
+    int      iField, *panMap;
 
     // Initialize the index-to-index map to -1's
     panMap = (int *) VSIMalloc( sizeof(int) * nSrcFieldCount );
@@ -2834,14 +2847,14 @@
             }
         }
     }
-    else if (papszSelFields && !bAppend )
+    else if (oSelFields.size() > 0 && !bAppend )
     {
         int  nDstFieldCount = 0;
         if (poDstFDefn)
             nDstFieldCount = poDstFDefn->GetFieldCount();
-        for( iField=0; papszSelFields[iField] != NULL; iField++)
+        for( iField=0; iField < (int) oSelFields.size(); iField++)
         {
-            int iSrcField = poSrcFDefn->GetFieldIndex(papszSelFields[iField]);
+            int iSrcField = poSrcFDefn->GetFieldIndex(oSelFields[iField]);
             if (iSrcField >= 0)
             {
                 OGRFieldDefn* poSrcFieldDefn = poSrcFDefn->GetFieldDefn(iSrcField);
@@ -2920,9 +2933,9 @@
                 const char* pszFieldName =
                     poSrcFDefn->GetFieldDefn(iSrcField)->GetNameRef();
                 int bFieldRequested = FALSE;
-                for( iField=0; papszSelFields[iField] != NULL; iField++)
+                for( iField=0; iField < (int) oSelFields.size(); iField++)
                 {
-                    if (EQUAL(pszFieldName, papszSelFields[iField]))
+                    if (EQUAL(pszFieldName, oSelFields[iField]))
                     {
                         bFieldRequested = TRUE;
                         break;
@@ -3658,3 +3671,104 @@
 
     return TRUE;
 }
+
+/* -------------------------------------------------------------------- */
+/*      Filter select fields (*, !col).                                 */
+/* -------------------------------------------------------------------- */
+std::vector<CPLString> FilterSelectFields(OGRFeatureDefn *poSrcFDefn, char **papszSelFields,
+                                          bool bCreateGeom)
+{
+    std::vector<CPLString> oSelFields;
+    int iSrcField, nFCount;
+    const char *pszSrcFieldName;
+    
+    // first pass - append requested columns (*)
+    for( int iField = 0; papszSelFields[iField] != NULL; iField++)
+    {
+        const char *pszFieldName = papszSelFields[iField];
+        if( EQUAL(pszFieldName, "*" ) )
+        {
+            // append all attributes
+            nFCount = poSrcFDefn->GetFieldCount();
+            for( iSrcField = 0; iSrcField < nFCount; iSrcField++ )
+            {
+                pszSrcFieldName = poSrcFDefn->GetFieldDefn(iSrcField)->GetNameRef();
+                if( std::find( oSelFields.begin(), oSelFields.end(),
+                                pszFieldName) == oSelFields.end() )
+                    oSelFields.push_back( pszSrcFieldName );
+            }
+            
+            // append also geometrie attributes
+            nFCount = poSrcFDefn->GetGeomFieldCount();
+            for( iSrcField = 0; iSrcField < nFCount; iSrcField++ )
+            {
+                pszSrcFieldName = poSrcFDefn->GetGeomFieldDefn(iSrcField)->GetNameRef();
+                if( std::find( oSelFields.begin(), oSelFields.end(),
+                                pszFieldName) == oSelFields.end() )
+                    oSelFields.push_back( pszSrcFieldName  );
+            }
+        }
+        else if( pszFieldName && pszFieldName[0] == '!' )
+        {
+            continue; // skip
+        }
+        else
+        {
+          if( std::find( oSelFields.begin(), oSelFields.end(),
+                         pszFieldName) == oSelFields.end() )
+              oSelFields.push_back(pszFieldName);
+        }
+    }
+
+    // second pass - include all geometry attributes 
+    nFCount = poSrcFDefn->GetGeomFieldCount();
+    for( iSrcField = 0; iSrcField < nFCount; iSrcField++ )
+    {
+        pszSrcFieldName = poSrcFDefn->GetGeomFieldDefn(iSrcField)->GetNameRef();
+        if( std::find( oSelFields.begin(), oSelFields.end(),
+                       pszSrcFieldName) == oSelFields.end() )
+            oSelFields.push_back( pszSrcFieldName );
+    }
+
+    // third pass - pop requested columns (!col)
+    for( int iField = 0; papszSelFields[iField] != NULL; iField++)
+    {
+        pszSrcFieldName = papszSelFields[iField];  
+        if( pszSrcFieldName && pszSrcFieldName[0] == '!' )
+        {
+            CPLString osFieldName(pszSrcFieldName);
+            osFieldName.erase( osFieldName.begin());  
+
+            std::vector<CPLString>::iterator iItem = std::remove( oSelFields.begin(),
+                                                                  oSelFields.end(), osFieldName );
+            oSelFields.erase( iItem, oSelFields.end() );
+        }
+    }
+
+    // fourth pass - check multiple geometry attributes
+    if ( !bCreateGeom )
+    {
+        bool bFirst = TRUE;
+        nFCount = poSrcFDefn->GetGeomFieldCount();
+        for( iSrcField = 0; iSrcField < nFCount; iSrcField++ )
+        {
+            CPLString osFieldName(poSrcFDefn->GetGeomFieldDefn(iSrcField)->GetNameRef());
+
+            if( std::find( oSelFields.begin(), oSelFields.end(),
+                           osFieldName) != oSelFields.end() )
+            {
+                
+                if (bFirst)
+                    bFirst = FALSE;
+                else
+                {
+                    std::vector<CPLString>::iterator iItem = std::remove( oSelFields.begin(),
+                                                                          oSelFields.end(), osFieldName );
+                    oSelFields.erase( iItem, oSelFields.end() ); 
+                }
+            }
+        }
+    }
+
+    return oSelFields;
+}

From even.rouault at spatialys.com  Sun Oct 26 09:58:59 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 26 Oct 2014 17:58:59 +0100
Subject: [gdal-dev] ogr2ogr and RFC41
In-Reply-To: <CA+Ei1Oc7+PaXfHDVBr9=Tt7CZzjqpMLY2M_8-RNj4ZD4ocJbUA@mail.gmail.com>
References: <CA+Ei1OfO1RRfU2RnZMrbpm+Gk4ieUQq629PVaWqRpkDzrf4EFQ@mail.gmail.com>
	<CA+Ei1OdhBeDcha7_HjxvHueoEYg3Oavh6izp4aitBu9_c=XK2w@mail.gmail.com>
	<CA+Ei1Oc7+PaXfHDVBr9=Tt7CZzjqpMLY2M_8-RNj4ZD4ocJbUA@mail.gmail.com>
Message-ID: <201410261758.59278.even.rouault@spatialys.com>

Le dimanche 26 octobre 2014 16:10:48, Martin Landa a ?crit :
> Hi,
> 
> 2014-10-24 9:46 GMT+02:00 Martin Landa <landa.martin at gmail.com>:
> >> So perhaps something like ?
> >> --select *,!geom1,!attr1
> > 
> > yes, it would be nice to have it... Martin
> 
> the attached patch shows a way, I am sure that it's possible to
> simplily it. Anyway combination as (assuming that a source layer has
> three geometry columns) seems to work:
> 
> $ ogr2ogr -f PostgreSQL -select '*' PG:dbname=vfr_10 PG:dbname=vfr
> staty -overwrite
> 
> -> OK all attributes + geom1
> 
> $ ogr2ogr -f PostgreSQL -select '*,!geom1' PG:dbname=vfr_10
> PG:dbname=vfr staty -overwrite
> 
> -> OK, all atributes + geom2
> 
> $ ogr2ogr -f PostgreSQL -select '*,!geom1,!geom2' PG:dbname=vfr_10
> PG:dbname=vfr staty -overwrite
> 
> -> OK, all atributes + geom3

Martin,

The patch and above syntax look good to me at first sight. Provided you also 
document the new syntax in apps/ogr_utilities.dox and add new test cases in 
autotest/utilities/test_ogr2ogr.py (you can have a look at/extend 
test_ogr2ogr_51 that tests RFC41 with the CSV driver), I think that's good for 
commit.

> 
> BTW, I would assume that if the destination datasource supports RFC41
> than ogr2ogr transfers all geometry columns, but it doesn't seems to
> be true, eg.:
> 
> $ ogrinfo PG:dbname=vfr staty | grep Geometry
> Geometry (definicnibod): Point
> Geometry (originalnihranice): Multi Polygon
> Geometry (generalizovanehranice): Multi Polygon
> Geometry Column 1 = definicnibod
> Geometry Column 2 = originalnihranice
> Geometry Column 3 = generalizovanehranice
> 
> $ ogr2ogr -f PostgreSQL PG:dbname=vfr_10 PG:dbname=vfr staty -overwrite
> 
> $ ogrinfo PG:dbname=vfr_10 staty | grep Geometry
> Geometry: Unknown (any)
> Geometry Column = GEOMETRY

Strange, a similar test works for me...

$ ogrinfo pg:dbname=autotest mainfeature | grep Geometry
Geometry (geometryproperty): Unknown (any)
Geometry (secondgeometryproperty): Unknown (any)
Geometry Column 1 = geometryproperty
Geometry Column 2 = secondgeometryproperty

$ ogr2ogr -f postgresql pg:dbname=autotest pg:dbname=autotest mainfeature \
	-nln mainfeature_copy -overwrite

 ogrinfo pg:dbname=autotest mainfeature_copy  | grep Geometry
Geometry (geometryproperty): Unknown (any)
Geometry (secondgeometryproperty): Unknown (any)
Geometry Column 1 = geometryproperty
Geometry Column 2 = secondgeometryproperty


Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From rgourrat at ag-carto.fr  Mon Oct 27 08:09:52 2014
From: rgourrat at ag-carto.fr (=?iso-8859-1?Q?R=E9my_GOURRAT?=)
Date: Mon, 27 Oct 2014 15:09:52 +0000
Subject: [gdal-dev] ogr2ogr Shap to OCI ora-01438 value larger...
Message-ID: <238B1E1830D86F46B3F030D491793D6003B7A821@EXC2010.aditu.fr>

Hi,

When i try to import a Shape with ogr2ogr and OCI  and this command line :

Before, i execute this command line to keep the accents:

SET NLS_LANG=American_America.UTF8

And just after :

ogr2ogr -f OCI OCI:****/****@****:ZZ_SHP_DOC_URBA "G:\temp\shp\shape_L93CC44\40243_DOC_URBA_L93CC44.shp" -nln ZZ_SHP_DOC_URBA -overwrite

I have this error message "ERROR 1: ORA-01438: value larger than specified precision allowed for this column"

So I modify like this ignoring  the SHAPE_AREA field :

ogr2ogr -f OCI OCI:ORA_PLU20/3717grade at Ag_GeoPLU:ZZ_SHP_ZONE_URBA -select TEX2,INSEE,IDURBA,DATAPPRO,DATVALID,TYPEDOC,DATEFIN,INTERCO,SIREN,ETAT,NOMREG,URLREG,NOMPLAN,URLPLAN,SITEWEB,TYPEREF,DATEREF "G:\temp\shp\shape_L93CC44\40243_ZONE_URBA_L93CC44.shp" -nln ZZ_SHP_DOC_URBA -nlt PROMOTE_TO_MULTI -overwrite

So i can identify the field problem cause  : "SHAPE_AREA"

In the shape via Qgis, i see the property field : double - real - 19 - 11, in oracle I see also  SHAPE_AREA NUMBER(19,11)

in Qgis the shape Area value is : 117839075.90299999714 (9 + 11 = 20 caracters)

I think it is a problem with the decimal character

and UTF-8 but I thought to resolve it with SET NLS_LANG=American_America.UTF8

but no...

thanks for your help.

R?my

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141027/237ff8e7/attachment.html>

From even.rouault at spatialys.com  Mon Oct 27 08:38:46 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 27 Oct 2014 16:38:46 +0100
Subject: [gdal-dev] ogr2ogr Shap to OCI ora-01438 value larger...
In-Reply-To: <238B1E1830D86F46B3F030D491793D6003B7A821@EXC2010.aditu.fr>
References: <238B1E1830D86F46B3F030D491793D6003B7A821@EXC2010.aditu.fr>
Message-ID: <201410271638.46847.even.rouault@spatialys.com>

Le lundi 27 octobre 2014 16:09:52, vous avez ?crit :
> Hi,
> 
> When i try to import a Shape with ogr2ogr and OCI  and this command line :
> 
> Before, i execute this command line to keep the accents:
> 
> SET NLS_LANG=American_America.UTF8
> 
> And just after :
> 
> ogr2ogr -f OCI OCI:****/****@****:ZZ_SHP_DOC_URBA
> "G:\temp\shp\shape_L93CC44\40243_DOC_URBA_L93CC44.shp" -nln
> ZZ_SHP_DOC_URBA -overwrite
> 
> I have this error message "ERROR 1: ORA-01438: value larger than specified
> precision allowed for this column"
> 
> So I modify like this ignoring  the SHAPE_AREA field :
> 
> ogr2ogr -f OCI OCI:ORA_PLU20/3717grade at Ag_GeoPLU:ZZ_SHP_ZONE_URBA -select
> TEX2,INSEE,IDURBA,DATAPPRO,DATVALID,TYPEDOC,DATEFIN,INTERCO,SIREN,ETAT,NOM
> REG,URLREG,NOMPLAN,URLPLAN,SITEWEB,TYPEREF,DATEREF
> "G:\temp\shp\shape_L93CC44\40243_ZONE_URBA_L93CC44.shp" -nln
> ZZ_SHP_DOC_URBA -nlt PROMOTE_TO_MULTI -overwrite
> 
> So i can identify the field problem cause  : "SHAPE_AREA"
> 
> In the shape via Qgis, i see the property field : double - real - 19 - 11,
> in oracle I see also  SHAPE_AREA NUMBER(19,11)
> 
> in Qgis the shape Area value is : 117839075.90299999714 (9 + 11 = 20
> caracters)
> 
> I think it is a problem with the decimal character
> 
> and UTF-8 but I thought to resolve it with SET
> NLS_LANG=American_America.UTF8

R?mi,

This looks like http://trac.osgeo.org/gdal/ticket/2667

Can perhaps be workarounded by adding -lco PRECISION=NO

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From olsond at google.com  Mon Oct 27 14:42:11 2014
From: olsond at google.com (David Olson)
Date: Mon, 27 Oct 2014 14:42:11 -0700
Subject: [gdal-dev] VRTWarpedDataset with ChunkandWarpImage
Message-ID: <CAETbBCwRHgfdBq+6hU-0Ovbh0SGWb8Q-31=s3h_khgHeCuOA1w@mail.gmail.com>

Hi,
  I've set up a c++ code which creates a VRTWarpedDataset from a source
image then uses ChunkAndWarpImage to warp additional source images and
create a mosaic with the VRTWarpedDataset destination (hdst_ds).
 The code is tested and runs fine without memory leak.
 However I do get an error upon calling GDALClose(hdst_ds) :
      *ERROR 6: WriteBlock() not supported for this dataset*.
 GDALClose calls FlushCache which calls WriteBlock.
 Just wanting to get some insight on this error. And possibly how to avoid
it.
Thanks,
David
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141027/bbb07e65/attachment.html>

From even.rouault at spatialys.com  Mon Oct 27 15:21:58 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 27 Oct 2014 23:21:58 +0100
Subject: [gdal-dev] VRTWarpedDataset with ChunkandWarpImage
In-Reply-To: <CAETbBCwRHgfdBq+6hU-0Ovbh0SGWb8Q-31=s3h_khgHeCuOA1w@mail.gmail.com>
References: <CAETbBCwRHgfdBq+6hU-0Ovbh0SGWb8Q-31=s3h_khgHeCuOA1w@mail.gmail.com>
Message-ID: <201410272321.58934.even.rouault@spatialys.com>

Le lundi 27 octobre 2014 22:42:11, David Olson a ?crit :
> Hi,
>   I've set up a c++ code which creates a VRTWarpedDataset from a source
> image then uses ChunkAndWarpImage to warp additional source images and
> create a mosaic with the VRTWarpedDataset destination (hdst_ds).
>  The code is tested and runs fine without memory leak.
>  However I do get an error upon calling GDALClose(hdst_ds) :
>       *ERROR 6: WriteBlock() not supported for this dataset*.
>  GDALClose calls FlushCache which calls WriteBlock.
>  Just wanting to get some insight on this error. And possibly how to avoid
> it.

David,

Difficult to tell without a reproducable snippet. But my guess is that you have 
an issue with setting up alpha band. Perhaps you have not defined nDstAlphaBand 
in the warping options ?

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From olsond at google.com  Mon Oct 27 15:41:12 2014
From: olsond at google.com (David Olson)
Date: Mon, 27 Oct 2014 15:41:12 -0700
Subject: [gdal-dev] VRTWarpedDataset with ChunkandWarpImage
In-Reply-To: <201410272321.58934.even.rouault@spatialys.com>
References: <CAETbBCwRHgfdBq+6hU-0Ovbh0SGWb8Q-31=s3h_khgHeCuOA1w@mail.gmail.com>
	<201410272321.58934.even.rouault@spatialys.com>
Message-ID: <CAETbBCxtq7wohJbudSAV9h6DvRrTNq5qFX3WcEZH8O8e1suU6A@mail.gmail.com>

Evan,
  The source and destination data are 3-band RGB so I don't believe that is
the problem...
  However I did define GdalWarp->nDstAlphaBand = 0 with the same result.
Basically getting three
  erorrs - one for each band:

ERROR 6: WriteBlock() not supported for this dataset.
ERROR 6: WriteBlock() not supported for this dataset.
ERROR 6: WriteBlock() not supported for this dataset.

Thanks, David

On Mon, Oct 27, 2014 at 3:21 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le lundi 27 octobre 2014 22:42:11, David Olson a ?crit :
> > Hi,
> >   I've set up a c++ code which creates a VRTWarpedDataset from a source
> > image then uses ChunkAndWarpImage to warp additional source images and
> > create a mosaic with the VRTWarpedDataset destination (hdst_ds).
> >  The code is tested and runs fine without memory leak.
> >  However I do get an error upon calling GDALClose(hdst_ds) :
> >       *ERROR 6: WriteBlock() not supported for this dataset*.
> >  GDALClose calls FlushCache which calls WriteBlock.
> >  Just wanting to get some insight on this error. And possibly how to
> avoid
> > it.
>
> David,
>
> Difficult to tell without a reproducable snippet. But my guess is that you
> have
> an issue with setting up alpha band. Perhaps you have not defined
> nDstAlphaBand
> in the warping options ?
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141027/ec5ea4ae/attachment.html>

From olsond at google.com  Mon Oct 27 16:16:25 2014
From: olsond at google.com (David Olson)
Date: Mon, 27 Oct 2014 16:16:25 -0700
Subject: [gdal-dev] VRTWarpedDataset with ChunkandWarpImage
In-Reply-To: <CAETbBCxtq7wohJbudSAV9h6DvRrTNq5qFX3WcEZH8O8e1suU6A@mail.gmail.com>
References: <CAETbBCwRHgfdBq+6hU-0Ovbh0SGWb8Q-31=s3h_khgHeCuOA1w@mail.gmail.com>
	<201410272321.58934.even.rouault@spatialys.com>
	<CAETbBCxtq7wohJbudSAV9h6DvRrTNq5qFX3WcEZH8O8e1suU6A@mail.gmail.com>
Message-ID: <CAETbBCwGrijTfWOcHCC2d5T+0Xzo6mVC=JPU8a48EX2TL7JiEg@mail.gmail.com>

Here shortened version of the code...

  VSIFCloseL(VSIFileFromMemBuffer((*vsifile1).c_str(),
                                  buf1, FALSE));  // buf1 = RGB JPEG
  GDALDatasetH hsrc1_ds = GDALOpenInternal((*vsifile1).c_str(), GA_ReadOnly,
                           kGdalAllowedDrivers);
 VSIFCloseL(VSIFileFromMemBuffer((*vsifile2).c_str(),
                                  buf2, FALSE));  // buf2 = RGB JPEG
 GDALDatasetH hsrc2_ds = GDALOpenInternal((*vsifile2).c_str(), GA_ReadOnly,
                           kGdalAllowedDrivers);
....  // initialize geo_transform, gdal_warp
gdal_warp->hSrcDS = hsrc1_ds;
VRTWarpedDataset *hdst_ds =  (VRTWarpedDataset*)(GDALCreateWarpedVRT(
      hsrc1_ds, XSize, YSize, &dst_geo_transform[0], gdal_warp));
gdal_warp->hDstDS = hdst_ds;
gdal_warp->hSrcDS = hsrc2_ds;
CPLErr eErr = warp_operation.ChunkAndWarpImage(0, 0,
GDALGetRasterXSize(hdst_ds),
                                            GDALGetRasterYSize(hdst_ds));
GDALClose((GDALDatasetH)hdst_ds);   // "ERROR 6: WriteBlock() not supported
for this dataset." /band
... // Close Source Datasets etc..



On Mon, Oct 27, 2014 at 3:41 PM, David Olson <olsond at google.com> wrote:

> Evan,
>   The source and destination data are 3-band RGB so I don't believe that
> is the problem...
>   However I did define GdalWarp->nDstAlphaBand = 0 with the same result.
> Basically getting three
>   erorrs - one for each band:
>
> ERROR 6: WriteBlock() not supported for this dataset.
> ERROR 6: WriteBlock() not supported for this dataset.
> ERROR 6: WriteBlock() not supported for this dataset.
>
> Thanks, David
>
> On Mon, Oct 27, 2014 at 3:21 PM, Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> Le lundi 27 octobre 2014 22:42:11, David Olson a ?crit :
>> > Hi,
>> >   I've set up a c++ code which creates a VRTWarpedDataset from a source
>> > image then uses ChunkAndWarpImage to warp additional source images and
>> > create a mosaic with the VRTWarpedDataset destination (hdst_ds).
>> >  The code is tested and runs fine without memory leak.
>> >  However I do get an error upon calling GDALClose(hdst_ds) :
>> >       *ERROR 6: WriteBlock() not supported for this dataset*.
>> >  GDALClose calls FlushCache which calls WriteBlock.
>> >  Just wanting to get some insight on this error. And possibly how to
>> avoid
>> > it.
>>
>> David,
>>
>> Difficult to tell without a reproducable snippet. But my guess is that
>> you have
>> an issue with setting up alpha band. Perhaps you have not defined
>> nDstAlphaBand
>> in the warping options ?
>>
>> Even
>>
>> --
>> Spatialys - Geospatial professional services
>> http://www.spatialys.com
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141027/f51f9699/attachment.html>

From even.rouault at spatialys.com  Mon Oct 27 16:33:08 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 28 Oct 2014 00:33:08 +0100
Subject: [gdal-dev] VRTWarpedDataset with ChunkandWarpImage
In-Reply-To: <CAETbBCwGrijTfWOcHCC2d5T+0Xzo6mVC=JPU8a48EX2TL7JiEg@mail.gmail.com>
References: <CAETbBCwRHgfdBq+6hU-0Ovbh0SGWb8Q-31=s3h_khgHeCuOA1w@mail.gmail.com>
	<CAETbBCxtq7wohJbudSAV9h6DvRrTNq5qFX3WcEZH8O8e1suU6A@mail.gmail.com>
	<CAETbBCwGrijTfWOcHCC2d5T+0Xzo6mVC=JPU8a48EX2TL7JiEg@mail.gmail.com>
Message-ID: <201410280033.08806.even.rouault@spatialys.com>

Le mardi 28 octobre 2014 00:16:25, David Olson a ?crit :
> Here shortened version of the code...
> 
>   VSIFCloseL(VSIFileFromMemBuffer((*vsifile1).c_str(),
>                                   buf1, FALSE));  // buf1 = RGB JPEG
>   GDALDatasetH hsrc1_ds = GDALOpenInternal((*vsifile1).c_str(),
> GA_ReadOnly, kGdalAllowedDrivers);
>  VSIFCloseL(VSIFileFromMemBuffer((*vsifile2).c_str(),
>                                   buf2, FALSE));  // buf2 = RGB JPEG
>  GDALDatasetH hsrc2_ds = GDALOpenInternal((*vsifile2).c_str(), GA_ReadOnly,
>                            kGdalAllowedDrivers);
> ....  // initialize geo_transform, gdal_warp
> gdal_warp->hSrcDS = hsrc1_ds;
> VRTWarpedDataset *hdst_ds =  (VRTWarpedDataset*)(GDALCreateWarpedVRT(
>       hsrc1_ds, XSize, YSize, &dst_geo_transform[0], gdal_warp));
> gdal_warp->hDstDS = hdst_ds;
> gdal_warp->hSrcDS = hsrc2_ds;
> CPLErr eErr = warp_operation.ChunkAndWarpImage(0, 0,
> GDALGetRasterXSize(hdst_ds),
>                                             GDALGetRasterYSize(hdst_ds));
> GDALClose((GDALDatasetH)hdst_ds);   // "ERROR 6: WriteBlock() not supported
> for this dataset." /band
> ... // Close Source Datasets etc..

Hum, what you attempt to do is really weird and explains the error. You cannot 
use a warped VRT as the *output* of a warping operation. You can only read in 
a warped VRT.

> 
> On Mon, Oct 27, 2014 at 3:41 PM, David Olson <olsond at google.com> wrote:
> > Evan,
> > 
> >   The source and destination data are 3-band RGB so I don't believe that
> > 
> > is the problem...
> > 
> >   However I did define GdalWarp->nDstAlphaBand = 0 with the same result.
> > 
> > Basically getting three
> > 
> >   erorrs - one for each band:
> > ERROR 6: WriteBlock() not supported for this dataset.
> > ERROR 6: WriteBlock() not supported for this dataset.
> > ERROR 6: WriteBlock() not supported for this dataset.
> > 
> > Thanks, David
> > 
> > On Mon, Oct 27, 2014 at 3:21 PM, Even Rouault
> > <even.rouault at spatialys.com>
> > 
> > wrote:
> >> Le lundi 27 octobre 2014 22:42:11, David Olson a ?crit :
> >> > Hi,
> >> > 
> >> >   I've set up a c++ code which creates a VRTWarpedDataset from a
> >> >   source
> >> > 
> >> > image then uses ChunkAndWarpImage to warp additional source images and
> >> > create a mosaic with the VRTWarpedDataset destination (hdst_ds).
> >> > 
> >> >  The code is tested and runs fine without memory leak.
> >> >  
> >> >  However I do get an error upon calling GDALClose(hdst_ds) :
> >> >       *ERROR 6: WriteBlock() not supported for this dataset*.
> >> >  
> >> >  GDALClose calls FlushCache which calls WriteBlock.
> >> >  Just wanting to get some insight on this error. And possibly how to
> >> 
> >> avoid
> >> 
> >> > it.
> >> 
> >> David,
> >> 
> >> Difficult to tell without a reproducable snippet. But my guess is that
> >> you have
> >> an issue with setting up alpha band. Perhaps you have not defined
> >> nDstAlphaBand
> >> in the warping options ?
> >> 
> >> Even
> >> 
> >> --
> >> Spatialys - Geospatial professional services
> >> http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From abusquets at gmail.com  Mon Oct 27 16:59:48 2014
From: abusquets at gmail.com (Alexandre Busquets)
Date: Tue, 28 Oct 2014 00:59:48 +0100
Subject: [gdal-dev] Point SYMBOL
Message-ID: <CAKse616r-p5txjDhAAS=gVM8XZwcXyn0VnD+W1YJM669jtO0ow@mail.gmail.com>

Hi,

I'm writing  a shp to dxf converter and I have a problem with the points.
The style is not applied (I only see a small point).
I have not problem with the lines and the polygons, only with the points.

This is a sample of my code adapted for this email.

data_source = ogr.GetDriverByName('DXF').CreateDataSource(fitxer_desti,
['HEADER=header.dxf'])

lyr = None

try:
    lyr = data_source.CreateLayer('entities')
except Exception:
    raise FitxerException('Can not open')


dst_feat = ogr.Feature(feature_def=lyr.GetLayerDefn())

style = 'SYMBOL(id:ogr-sym-3,c:#FF0000,s:50px)'

dst_feat.SetStyleString(style)
dst_feat.SetGeometryDirectly(geom)
dst_feat.SetField('Layer', 'points_sample')
lyr.CreateFeature(dst_feat)


Thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141028/6367d101/attachment-0001.html>

From voltagex at voltagex.org  Tue Oct 28 05:41:18 2014
From: voltagex at voltagex.org (Adam Baxter)
Date: Tue, 28 Oct 2014 23:41:18 +1100
Subject: [gdal-dev] Building C# bindings with VS2012/3
Message-ID: <CAChFQ9S2qPVvsd=k5kh0rXiGEGUoE=vKL3PX=v0ozwDB-fRmGA@mail.gmail.com>

Hi,
I've been able to build GDAL 1.11.1 using nmake, but the following
error happens when attempting to build the bindings in \swig\csharp.

Microsoft (R) Program Maintenance Utility Version 12.00.21005.1
Copyright (C) Microsoft Corporation.  All rights reserved.

    cd ogr
    nmake /nologo /f makefile.vc
NMAKE : fatal error U1073: don't know how to make 'ogr_wrap.obj'
Stop.
NMAKE : fatal error U1077: '"C:\Program Files (x86)\Microsoft Visual
Studio 12.0\VC\BIN\nmake.EXE"' : return code '0x2'
Stop.


After a make clean and a make interface I attempted the build again.
I've attached the errors but most of them seem to be related to not
finding types in System.Windows.Interop (HandleRef, IntPtr,
IDisposable)

The swig version I'm using is SWIG Version 3.0.2

Compiled with i586-mingw32msvc-g++ [i586-pc-mingw32msvc]

Configured options: +pcre

Any ideas?

Thanks,
Adam
-------------- next part --------------

Microsoft (R) Program Maintenance Utility Version 12.00.21005.1
Copyright (C) Microsoft Corporation.  All rights reserved.

	cd ogr
	nmake /nologo /f makefile.vc
	cl   /nologo /MD /EHsc /Ox /D_CRT_SECURE_NO_DEPRECATE /D_CRT_NONSTDC_NO_DEPRECATE /DNDEBUG /W4 /wd4127 /wd4251 /wd4275 /wd4786 /wd4100 /wd4245 /wd4206 /wd4018 /wd4389 /DHAVE_SSE_AT_COMPILE_TIME -I..\..\..\port -I..\..\..\ogr -I..\..\..\gcore  -I..\..\..\alg -I..\..\..\ogr\ogrsf_frmts  -DOGR_ENABLED  /c ogr_wrap.cpp 
ogr_wrap.cpp
	xcopy /D  /Y *.obj ..
D:ogr_wrap.obj
1 File(s) copied
	cd ..
	cd gdal
	nmake /nologo /f makefile.vc
	cl   /nologo /MD /EHsc /Ox /D_CRT_SECURE_NO_DEPRECATE /D_CRT_NONSTDC_NO_DEPRECATE /DNDEBUG /W4 /wd4127 /wd4251 /wd4275 /wd4786 /wd4100 /wd4245 /wd4206 /wd4018 /wd4389 /DHAVE_SSE_AT_COMPILE_TIME -I..\..\..\port -I..\..\..\ogr -I..\..\..\gcore  -I..\..\..\alg -I..\..\..\ogr\ogrsf_frmts  -DOGR_ENABLED  /c gdal_wrap.cpp 
gdal_wrap.cpp
	xcopy /D  /Y *.obj ..
D:gdal_wrap.obj
1 File(s) copied
	cd ..
	cd osr
	nmake /nologo /f makefile.vc
	cl   /nologo /MD /EHsc /Ox /D_CRT_SECURE_NO_DEPRECATE /D_CRT_NONSTDC_NO_DEPRECATE /DNDEBUG /W4 /wd4127 /wd4251 /wd4275 /wd4786 /wd4100 /wd4245 /wd4206 /wd4018 /wd4389 /DHAVE_SSE_AT_COMPILE_TIME -I..\..\..\port -I..\..\..\ogr -I..\..\..\gcore  -I..\..\..\alg -I..\..\..\ogr\ogrsf_frmts  -DOGR_ENABLED  /c osr_wrap.cpp 
osr_wrap.cpp
	xcopy /D  /Y *.obj ..
D:osr_wrap.obj
1 File(s) copied
	cd ..
	cd const
	nmake /nologo /f makefile.vc
	cl   /nologo /MD /EHsc /Ox /D_CRT_SECURE_NO_DEPRECATE /D_CRT_NONSTDC_NO_DEPRECATE /DNDEBUG /W4 /wd4127 /wd4251 /wd4275 /wd4786 /wd4100 /wd4245 /wd4206 /wd4018 /wd4389 /DHAVE_SSE_AT_COMPILE_TIME -I..\..\..\port -I..\..\..\ogr -I..\..\..\gcore  -I..\..\..\alg -I..\..\..\ogr\ogrsf_frmts  -DOGR_ENABLED  /c gdalconst_wrap.c 
gdalconst_wrap.c
	xcopy /D  /Y *.obj ..
D:gdalconst_wrap.obj
1 File(s) copied
	cd ..
	csc /platform:x86  /target:library /out:osr_csharp.dll osr\*.cs AssemblyInfo.cs
Microsoft (R) Visual C# Compiler version 12.0.30501.0

for C# 5
Copyright (C) Microsoft Corporation. All rights reserved.

osr\Osr.cs(13,30): error CS0246: The type or namespace name 'IDisposable' could not be found (are you missing a using directive or an assembly reference?)
osr\OsrPINVOKE.cs(199,36): error CS0246: The type or namespace name 'IDisposable' could not be found (are you missing a using directive or an assembly reference?)
osr\CoordinateTransformation.cs(12,11): error CS0246: The type or namespace name 'HandleRef' could not be found (are you missing a using directive or an assembly reference?)
osr\CoordinateTransformation.cs(19,35): error CS0246: The type or namespace name 'IntPtr' could not be found (are you missing a using directive or an assembly reference?)
osr\CoordinateTransformation.cs(25,17): error CS0246: The type or namespace name 'HandleRef' could not be found (are you missing a using directive or an assembly reference?)
osr\CoordinateTransformation.cs(28,17): error CS0246: The type or namespace name 'HandleRef' could not be found (are you missing a using directive or an assembly reference?)
osr\CoordinateTransformation.cs(40,17): error CS0246: The type or namespace name 'HandleRef' could not be found (are you missing a using directive or an assembly reference?)
osr\Osr.cs(58,69): error CS0246: The type or namespace name 'IntPtr' could not be found (are you missing a using directive or an assembly reference?)
osr\Osr.cs(59,63): error CS0246: The type or namespace name 'IntPtr' could not be found (are you missing a using directive or an assembly reference?)
osr\Osr.cs(59,79): error CS0246: The type or namespace name 'IntPtr' could not be found (are you missing a using directive or an assembly reference?)
osr\Osr.cs(42,44): error CS0246: The type or namespace name 'IntPtr' could not be found (are you missing a using directive or an assembly reference?)
osr\Osr.cs(53,42): error CS0246: The type or namespace name 'IntPtr' could not be found (are you missing a using directive or an assembly reference?)
osr\OsrPINVOKE.cs(200,21): error CS0246: The type or namespace name 'IntPtr' could not be found (are you missing a using directive or an assembly reference?)
osr\OsrPINVOKE.cs(189,10): error CS0111: Type 'OSGeo.OSR.OsrPINVOKE' already defines a member called 'OsrPINVOKE' with the same parameter types
osr\OsrPINVOKE.cs(185,10): (Location of symbol related to previous error)
osr\OsrPINVOKE.cs(218,47): error CS0246: The type or namespace name 'IntPtr' could not be found (are you missing a using directive or an assembly reference?)
osr\OsrPINVOKE.cs(227,24): error CS0246: The type or namespace name 'IntPtr' could not be found (are you missing a using directive or an assembly reference?)
osr\OsrPINVOKE.cs(230,24): error CS0246: The type or namespace name 'IntPtr' could not be found (are you missing a using directive or an assembly reference?)
osr\OsrPINVOKE.cs(512,116): error CS0246: The type or namespace name 'IntPtr' could not be found (are you missing a using directive or an assembly reference?)
osr\SpatialReference.cs(12,11): error CS0246: The type or namespace name 'HandleRef' could not be found (are you missing a using directive or an assembly reference?)
osr\SpatialReference.cs(19,27): error CS0246: The type or namespace name 'IntPtr' could not be found (are you missing a using directive or an assembly reference?)
osr\SpatialReference.cs(25,17): error CS0246: The type or namespace name 'HandleRef' could not be found (are you missing a using directive or an assembly reference?)
osr\SpatialReference.cs(28,17): error CS0246: The type or namespace name 'HandleRef' could not be found (are you missing a using directive or an assembly reference?)
osr\SpatialReference.cs(40,17): error CS0246: The type or namespace name 'HandleRef' could not be found (are you missing a using directive or an assembly reference?)
NMAKE : fatal error U1077: '"C:\Program Files (x86)\MSBuild\12.0\bin\csc.EXE"' : return code '0x1'
Stop.

From szekerest at gmail.com  Tue Oct 28 07:08:04 2014
From: szekerest at gmail.com (Tamas Szekeres)
Date: Tue, 28 Oct 2014 15:08:04 +0100
Subject: [gdal-dev] Building C# bindings with VS2012/3
In-Reply-To: <CAChFQ9S2qPVvsd=k5kh0rXiGEGUoE=vKL3PX=v0ozwDB-fRmGA@mail.gmail.com>
References: <CAChFQ9S2qPVvsd=k5kh0rXiGEGUoE=vKL3PX=v0ozwDB-fRmGA@mail.gmail.com>
Message-ID: <CACALY+SOvWokuYkzgfrK6g7j6yC8ZCtaXC_KhLkdZAH3p2wNcQ@mail.gmail.com>

Adam,

This is probably due to several breaking changes in the latest SWIG
versions related to the fixes in GDAL C# bindings, you should try with a
1.3.x version instead.

Best  regards,

Tamas




2014-10-28 13:41 GMT+01:00 Adam Baxter <voltagex at voltagex.org>:

> Hi,
> I've been able to build GDAL 1.11.1 using nmake, but the following
> error happens when attempting to build the bindings in \swig\csharp.
>
> Microsoft (R) Program Maintenance Utility Version 12.00.21005.1
> Copyright (C) Microsoft Corporation.  All rights reserved.
>
>     cd ogr
>     nmake /nologo /f makefile.vc
> NMAKE : fatal error U1073: don't know how to make 'ogr_wrap.obj'
> Stop.
> NMAKE : fatal error U1077: '"C:\Program Files (x86)\Microsoft Visual
> Studio 12.0\VC\BIN\nmake.EXE"' : return code '0x2'
> Stop.
>
>
> After a make clean and a make interface I attempted the build again.
> I've attached the errors but most of them seem to be related to not
> finding types in System.Windows.Interop (HandleRef, IntPtr,
> IDisposable)
>
> The swig version I'm using is SWIG Version 3.0.2
>
> Compiled with i586-mingw32msvc-g++ [i586-pc-mingw32msvc]
>
> Configured options: +pcre
>
> Any ideas?
>
> Thanks,
> Adam
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141028/9266e774/attachment.html>

From robert.coup at koordinates.com  Thu Oct 30 12:55:11 2014
From: robert.coup at koordinates.com (Robert Coup)
Date: Fri, 31 Oct 2014 08:55:11 +1300
Subject: [gdal-dev] Improving usage of GDAL in Mapnik
Message-ID: <CAFLLRpKs159=46JtAa-CQs_eEXS_DaCf0+QZRayRi=TN0eAsuA@mail.gmail.com>

Hi team,

Fixing a bug in the Mapnik GDAL code (
https://github.com/mapnik/mapnik/tree/master/plugins/input/gdal) where the
return value of RasterIO() isn't checked (so eg. if a component TIFF in a
VRT is unavailable it just trucks right along rendering blank images
without error) and it appears to me like the usage of GDAL could be
optimised a bit in
https://github.com/mapnik/mapnik/blob/master/plugins/input/gdal/gdal_featureset.cpp


I'm curious whether any of the following will actually make much
difference, or whether GDALs caching nullifies most of it already? Or
whether there are potentially other obvious performance optimisations?

* Favouring dataset.RasterIO() over band.RasterIO() to prevent up to 4x
raster reads
* Use of GetBlockSize() to read on block boundaries, then cropping data
later.
* Use GetMaskBand()/GetMaskFlags() to simplify nodata/alpha handling
(probably won't impact performance but might get rid of a bunch of code)

Cheers,

Rob :)
-- 

*Koordinates*PO Box 1604, Shortland St, Auckland 1140, New Zealand
Phone +64-9-966 0433 koordinates.com <https://koordinates.com/about>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20141031/af0c2265/attachment.html>

From even.rouault at spatialys.com  Thu Oct 30 17:01:45 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 31 Oct 2014 01:01:45 +0100
Subject: [gdal-dev] Improving usage of GDAL in Mapnik
In-Reply-To: <CAFLLRpKs159=46JtAa-CQs_eEXS_DaCf0+QZRayRi=TN0eAsuA@mail.gmail.com>
References: <CAFLLRpKs159=46JtAa-CQs_eEXS_DaCf0+QZRayRi=TN0eAsuA@mail.gmail.com>
Message-ID: <201410310101.45521.even.rouault@spatialys.com>

Le jeudi 30 octobre 2014 20:55:11, Robert Coup a ?crit :
> Hi team,
> 
> Fixing a bug in the Mapnik GDAL code (
> https://github.com/mapnik/mapnik/tree/master/plugins/input/gdal) where the
> return value of RasterIO() isn't checked (so eg. if a component TIFF in a
> VRT is unavailable it just trucks right along rendering blank images
> without error) and it appears to me like the usage of GDAL could be
> optimised a bit in
> https://github.com/mapnik/mapnik/blob/master/plugins/input/gdal/gdal_featur
> eset.cpp
> 
> 
> I'm curious whether any of the following will actually make much
> difference, or whether GDALs caching nullifies most of it already? Or
> whether there are potentially other obvious performance optimisations?
> 
> * Favouring dataset.RasterIO() over band.RasterIO() to prevent up to 4x
> raster reads

Rob,

If the size of the image (or your requested window) is below the GDAL block 
cache maximum size (default is 40 MB), then most drivers should cache the data 
for other bands when reading one band (particularly if decompression is 
involved), if the storage on disk is pixel interleaved (i.e R1,G1,B1,R2,G2,B2, 
etc...), which is generally the case for GeoTIFF. So reading in one call or 4 
calls will probably not make a lot of difference.
But if you know that you have to read the 4 bands, there's no reason not to 
use dataset.RasterIO() in all situations. GDAL, either in its generic 
implementation or in the driver specific one, will look at the declared 
interleaving and will/should select the most appropriate reading strategy, ie. 
potentially operating block by block if the data is pixel interleaved, or band 
by band otherwise.

> * Use of GetBlockSize() to read on block boundaries, then cropping data
> later.

I've not looked closely at the code you point to, but that depends on what you 
do. If you have allocated a big buffer to contain the whole requested window, 
then just issue a single RasterIO() and let GDAL do its job to filling it the 
best way.
If you just allocate small chunks of memory and process chunk by chunk, then 
it is indeed better to call RasterIO() on the block boundaries (or multiple of 
block boundaries).

> * Use GetMaskBand()/GetMaskFlags() to simplify nodata/alpha handling
> (probably won't impact performance but might get rid of a bunch of code)

Yes that can be convenient to avoid having to deal both with nodata and alpha 
band in a unified way. Plus some formats can really have a mask band that is 
neither of the two. For example you can create a JPEG-compressed YCbCr TIFF 
and use an internal mask band to encode transparency (although this is 
admitedly quite an exotic TIFF formulation because most readers will ignore 
the transparency mask)

Even

> 
> Cheers,
> 
> Rob :)

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at mmmtike.fi  Fri Oct 31 05:19:01 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Fri, 31 Oct 2014 12:19:01 +0000 (UTC)
Subject: [gdal-dev] =?utf-8?q?Sample_script_idea=3A_gdal=5Fsrsguess?=
Message-ID: <loom.20141031T124615-115@post.gmane.org>

Hi,

This question pops up every now and then in various forums: People have
received dataset in unknown SRS and they ask which coordinate system it
might be using. Most often data are shapefiles without .prj file or image
files with only .tfw file or sometimes scanned paper maps as plain images.

In case of shapefiles and tfw users can always pick a Ground Control Point
(GCP) having coordinates in the unknown system. With scanned maps it may be
possible too because maps have often a printed grid with coordinates.

On the other hand, people usually know roughly the location of data and it
would be easy to capture reference coordinates in EPSG:4326 or EPSG:3857
from world wide map services.

I suppose that it would be quite easy to make a python script that converts
the reference coordinates to all projections which have an EPSG code in the
Proj4 "epsg" file somehow similarly thn cs2cs and gdal_transform do, compute
delta-X, delta-Y and Root Mean Square Error (RMSE) from the converted
coordinates and GCP coordinates that the user gives as input. Finally the
script would print a few best guesses ordered by ascending RMSE.

Hard core developers may feel this too trivial but perhaps we have some GIS
teachers reading this list and wondering what would be their next challenge
for their students.

-Jukka Rahkonen-


From jukka.rahkonen at mmmtike.fi  Fri Oct 31 05:57:45 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Fri, 31 Oct 2014 12:57:45 +0000 (UTC)
Subject: [gdal-dev] Error with ogrlineref
Message-ID: <loom.20141031T134447-637@post.gmane.org>

Hi,

I noticed a tool that I had never tried: http://gdal.org/ogrlineref.html

I did not understand the meaning of all the options so I just copied the
example command but it failed for me. 


C:\temp\linref>ogrlineref -create -l line.shp -p references.shp
-pm dist -o parts.shp -s 10 -progress
Unsupported geometry type Line String for path

What's wrong with Line String? This is how my source data (-l) looks:

C:\temp\linref>ogrinfo line.shp
INFO: Open of `line.shp'
      using driver `ESRI Shapefile' successful.
1: line (Line String)


About the usage, should I understand that this utility cannot split lines or
insert milestones on lines by a given distance but I must create the point
file of milestone with some other tool and show that for ogrlineref with the
-p parameter? For my trial I created such point file with OpenJUMP PLUS.

-Jukka Rahkonen-


From aaronr at z-pulley.com  Fri Oct 31 09:54:19 2014
From: aaronr at z-pulley.com (Aaron Racicot)
Date: Fri, 31 Oct 2014 09:54:19 -0700
Subject: [gdal-dev] Sample script idea: gdal_srsguess
Message-ID: <080B6132-569E-4E72-B252-5D24DF5A2CC1@z-pulley.com>

We played with something just like this last year (called projfinder):

http://projfinder.com/

That is just a simple demo application that was a proof of concept.  Center the map where you think your data is from, enter in a sample X,Y from your dataset and it tries to guess what projection your data is in.  Nothing fancy like parsing arbitrary file formats etc? just simple X,Y from your data.

I gave a presentation on it at FOSS4G-NA 2013 (you can reference it here):

http://reprojected.com/blog/2013/05/28/foss4g-na-2013-was-a-home-run/

If you are interested in the code I can point you to it.  In the end it is basically a simple web-service built around a PostGIS SQL query that does the distance calculations to percolate up likely projections against the EPSG database.

Aaron

-- 
Aaron Racicot
Z-Pulley Inc.


From lcelati at latitude-geosystems.com  Fri Oct 31 10:43:22 2014
From: lcelati at latitude-geosystems.com (dandrigo)
Date: Fri, 31 Oct 2014 10:43:22 -0700 (PDT)
Subject: [gdal-dev] Import gpx files into Postgis db (windows)?
Message-ID: <1414777402227-5170662.post@n6.nabble.com>

Dear all, 

I'm working with windows 8 & postgis 2.1. 

I have several gps (gpx) files. I would like to import directly those gpx
files into my postgis database. 

What would be the easiest way? (ogr provided by OGR?)

In advance, thank you to throw light for me. 

Regards. 



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Import-gpx-files-into-Postgis-db-windows-tp5170662.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

