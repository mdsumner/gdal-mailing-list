From etourigny.dev at gmail.com  Fri May  1 03:57:11 2015
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Fri, 1 May 2015 17:57:11 +0700
Subject: [gdal-dev] define netcdf time dimension
In-Reply-To: <CAHYDKLbFTESqOoAyeB2CknP66HKbwBWJ-xUNmuXOhk8JJ7DvNA@mail.gmail.com>
References: <CAHYDKLbFTESqOoAyeB2CknP66HKbwBWJ-xUNmuXOhk8JJ7DvNA@mail.gmail.com>
Message-ID: <CA+TxYvN2kpbBBfTy58tmKXA9XKUtHPPWKZX3rs=yf8-rKXYLpQ@mail.gmail.com>

GDAL cannot be used to manipulate the netcdf dimension definitions.

You should use something specialized in dealing with netcdf dimensions such
as cdo [1] or nco [2].

[1] https://code.zmaw.de/projects/cdo
[2] http://nco.sourceforge.net/

On Tue, Apr 14, 2015 at 2:46 AM, Dominik Schneider <
Dominik.Schneider at colorado.edu> wrote:

> Hi -
>
> I have some .mdl files from IDL with .hdr header files that I?d like to
> convert to netcdf.
> The following code produces a netcdf file with a subdataset for each band
> in the mdl file. Is there any way to define the bands as the time
> dimension, in this case 4416 hourly timesteps?
>
> Or is there another tool that can convert this?
>
> gdal_translate -of NetCDF swe.mdl swe.nc
>
> Thanks
> Dominik?
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150501/36a3e26d/attachment.html>

From even.rouault at spatialys.com  Sun May  3 02:11:58 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 3 May 2015 11:11:58 +0200
Subject: [gdal-dev] GDAL 2.0 release plans
In-Reply-To: <55455EEC.1080207@gmail.com>
References: <201504131401.46728.even.rouault@spatialys.com>
	<201504292040.10516.even.rouault@spatialys.com>
	<55455EEC.1080207@gmail.com>
Message-ID: <201505031111.58902.even.rouault@spatialys.com>

Dmitry,

I didn't manage to apply the patch (due to the binary files)

$ patch -p0 < /tmp/md_reader.patch
patching file autotest/gcore/data/md_dg.IMD
patching file autotest/gcore/data/md_dg.RPB
patching file autotest/gcore/data/md_dg.tif
patch: **** malformed patch at line 187: \ No newline at end of file

Is there some branch somewhere where it can be tested ?

That said, I have no further remarks on this updated patch which looks good to 
me.

Even

Le dimanche 03 mai 2015 01:34:04, Dmitry Baryshnikov a ?crit :
> Hi everybody,
> 
> Let me introduce the patch to the current GDAL v.2 trunk. This patch
> change the way how imagery (satellite or aerial) metadata read. I create
> some base classes and several metadata readers: DigitalGlobe, GeoEye,
> OrbView (change existed code to use metadata readers), add Landsat,
> Pleiades, Resurs-DK1 (plan to add about 6 new satellites). Also I added
> new metadata domain: IMAGERY to hold some common imagery metadata:
> satellite, cloud cover, acquisition date/time. The cloud cover transform
> to values from 0 to 100 or 999 for n/a, and date/time to UTC.
> 
> Additional code review and testing are welcome. Also let me know, if I
> can commit this changes to trunk.
> 
> P.S. Even review the code of previous patch. I fix all errors reported
> by Even.
> 
> Best regards,
>      Dmitry
> 
> 29.04.2015 21:40, Even Rouault ?????:
> > Hi,
> > 
> > I wanted to have an update from other developers to know where there are
> > with respect to their planned schedule.
> > I had noted that :
> > - Dmitriy wanted to integrate his work on metadata support for various
> > satellite imagery. I have reviewed a preliminary version of it.
> > - Ari has ongoing work on Perl. I've seen a few commits passed.
> > - Pirmin intended to add curve support in Interlis. Haven't seen yet any
> > commit.
> > 
> > Are you still in track to finalize those works in the following days ?
> > Would adding the week-end help to have that in Beta1 ? I especially
> > think to Dmitriy's work who is quite substantial, and perhaps Perl
> > changes if there are still breaking change to come. Interlis specfic
> > changes might arrive after Beta1 I think.
> > 
> > Even
> > 
> >> Hi,
> >> 
> >> Some time ago, I mentionned my proposal of issuing a first GDAL 2.0 beta
> >> version for the end of this month (April 30th). Are there objections to
> >> sticking with that plan ? Does someone need a bit more time to finish an
> >> ongoing work ?
> >> 
> >> And if things go well with this beta (and potentially other beta(s)
> >> needed), we could try a release candidate for end of May. One month of
> >> beta phase might seem a bit short, but I'm not sure extending the beta
> >> testing period more will bring significant additional feedback (and
> >> things tend to slip, so better aim for a tight schedule). Thoughts ?
> >> Anyone using GDAL intensively and/or interesting in 2.0 should already
> >> track trunk closely ;-)
> >> 
> >> I can wear the hat of 2.0 release manager, but I'm happy to let it to
> >> any other volunteer.
> >> 
> >> Best regards,
> >> 
> >> Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From landa.martin at gmail.com  Sun May  3 03:26:15 2015
From: landa.martin at gmail.com (Martin Landa)
Date: Sun, 3 May 2015 12:26:15 +0200
Subject: [gdal-dev] open zipped gml
Message-ID: <CA+Ei1OcVei20gZ6jQcPse8Ce1FBy4LWjvYyorM0ovAO7aFp-ug@mail.gmail.com>

Hi all,

opening zipped gml using ogrinfo [1] fails with trunk.

$ ogrinfo /vsizip/DOP_ZachParkoviste_b_gml.zip -ro

Similar files in Esri Shapefile [2] is possible to open.

$ ogrinfo /vsizip/DOP_ZachParkoviste_b_shp.zip -ro

Any idea what could be wrong?

Thanks, Martin

[1] http://opendata.iprpraha.cz/CUR/DOP/DOP_ZachParkoviste_b/S_JTSK/DOP_ZachParkoviste_b_gml.zip
[2] http://opendata.iprpraha.cz/CUR/DOP/DOP_ZachParkoviste_b/S_JTSK/DOP_ZachParkoviste_b_shp.zip

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.cz/mentors/landa

From even.rouault at spatialys.com  Sun May  3 03:51:17 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 3 May 2015 12:51:17 +0200
Subject: [gdal-dev] open zipped gml
In-Reply-To: <CA+Ei1OcVei20gZ6jQcPse8Ce1FBy4LWjvYyorM0ovAO7aFp-ug@mail.gmail.com>
References: <CA+Ei1OcVei20gZ6jQcPse8Ce1FBy4LWjvYyorM0ovAO7aFp-ug@mail.gmail.com>
Message-ID: <201505031251.18204.even.rouault@spatialys.com>

Le dimanche 03 mai 2015 12:26:15, Martin Landa a ?crit :
> Hi all,
> 
> opening zipped gml using ogrinfo [1] fails with trunk.
> 
> $ ogrinfo /vsizip/DOP_ZachParkoviste_b_gml.zip -ro
> 
> Similar files in Esri Shapefile [2] is possible to open.
> 
> $ ogrinfo /vsizip/DOP_ZachParkoviste_b_shp.zip -ro
> 
> Any idea what could be wrong?

Hi Martin,

yes,  /vsizip/a_zip.zip  is seen as a directory by the driver. The shapefile 
driver accepts directories as input, whereas the GML driver does not. For the 
GML, you need to specify the filename within the zip

ogrinfo /vsizip/DOP_ZachParkoviste_b_gml.zip/DOP_ZachParkoviste_b.gml -ro

Even

> 
> Thanks, Martin
> 
> [1]
> http://opendata.iprpraha.cz/CUR/DOP/DOP_ZachParkoviste_b/S_JTSK/DOP_ZachPa
> rkoviste_b_gml.zip [2]
> http://opendata.iprpraha.cz/CUR/DOP/DOP_ZachParkoviste_b/S_JTSK/DOP_ZachPa
> rkoviste_b_shp.zip

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From bishop.dev at gmail.com  Sun May  3 04:00:04 2015
From: bishop.dev at gmail.com (Dmitry Baryshnikov)
Date: Sun, 03 May 2015 14:00:04 +0300
Subject: [gdal-dev] GDAL 2.0 release plans
In-Reply-To: <201505031111.58902.even.rouault@spatialys.com>
References: <201504131401.46728.even.rouault@spatialys.com>
	<201504292040.10516.even.rouault@spatialys.com>
	<55455EEC.1080207@gmail.com>
	<201505031111.58902.even.rouault@spatialys.com>
Message-ID: <5545FFB4.80202@gmail.com>

Hi Even,

It's strange as I create patch with same command (svn diff --force > 
~/md_reader.patch) as previous one.
I add changes for metadata readers directly to svn trunk copy on my PC.
I can create pull request for github GDAL trunk, but it takes some time 
to do, or I can just commit to svn trunk (preferable).
If something will be wrong, it can be easily roll back.

So, I decide to commit my changes to trunk.

Best regards,
     Dmitry

03.05.2015 12:11, Even Rouault ?????:
> Dmitry,
>
> I didn't manage to apply the patch (due to the binary files)
>
> $ patch -p0 < /tmp/md_reader.patch
> patching file autotest/gcore/data/md_dg.IMD
> patching file autotest/gcore/data/md_dg.RPB
> patching file autotest/gcore/data/md_dg.tif
> patch: **** malformed patch at line 187: \ No newline at end of file
>
> Is there some branch somewhere where it can be tested ?
>
> That said, I have no further remarks on this updated patch which looks good to
> me.
>
> Even
>
> Le dimanche 03 mai 2015 01:34:04, Dmitry Baryshnikov a ?crit :
>> Hi everybody,
>>
>> Let me introduce the patch to the current GDAL v.2 trunk. This patch
>> change the way how imagery (satellite or aerial) metadata read. I create
>> some base classes and several metadata readers: DigitalGlobe, GeoEye,
>> OrbView (change existed code to use metadata readers), add Landsat,
>> Pleiades, Resurs-DK1 (plan to add about 6 new satellites). Also I added
>> new metadata domain: IMAGERY to hold some common imagery metadata:
>> satellite, cloud cover, acquisition date/time. The cloud cover transform
>> to values from 0 to 100 or 999 for n/a, and date/time to UTC.
>>
>> Additional code review and testing are welcome. Also let me know, if I
>> can commit this changes to trunk.
>>
>> P.S. Even review the code of previous patch. I fix all errors reported
>> by Even.
>>
>> Best regards,
>>       Dmitry
>>
>> 29.04.2015 21:40, Even Rouault ?????:
>>> Hi,
>>>
>>> I wanted to have an update from other developers to know where there are
>>> with respect to their planned schedule.
>>> I had noted that :
>>> - Dmitriy wanted to integrate his work on metadata support for various
>>> satellite imagery. I have reviewed a preliminary version of it.
>>> - Ari has ongoing work on Perl. I've seen a few commits passed.
>>> - Pirmin intended to add curve support in Interlis. Haven't seen yet any
>>> commit.
>>>
>>> Are you still in track to finalize those works in the following days ?
>>> Would adding the week-end help to have that in Beta1 ? I especially
>>> think to Dmitriy's work who is quite substantial, and perhaps Perl
>>> changes if there are still breaking change to come. Interlis specfic
>>> changes might arrive after Beta1 I think.
>>>
>>> Even
>>>
>>>> Hi,
>>>>
>>>> Some time ago, I mentionned my proposal of issuing a first GDAL 2.0 beta
>>>> version for the end of this month (April 30th). Are there objections to
>>>> sticking with that plan ? Does someone need a bit more time to finish an
>>>> ongoing work ?
>>>>
>>>> And if things go well with this beta (and potentially other beta(s)
>>>> needed), we could try a release candidate for end of May. One month of
>>>> beta phase might seem a bit short, but I'm not sure extending the beta
>>>> testing period more will bring significant additional feedback (and
>>>> things tend to slip, so better aim for a tight schedule). Thoughts ?
>>>> Anyone using GDAL intensively and/or interesting in 2.0 should already
>>>> track trunk closely ;-)
>>>>
>>>> I can wear the hat of 2.0 release manager, but I'm happy to let it to
>>>> any other volunteer.
>>>>
>>>> Best regards,
>>>>
>>>> Even


From even.rouault at spatialys.com  Sun May  3 04:09:46 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 3 May 2015 13:09:46 +0200
Subject: [gdal-dev] GDAL 2.0 release plans
In-Reply-To: <5545FFB4.80202@gmail.com>
References: <201504131401.46728.even.rouault@spatialys.com>
	<201505031111.58902.even.rouault@spatialys.com>
	<5545FFB4.80202@gmail.com>
Message-ID: <201505031309.46374.even.rouault@spatialys.com>

> 
> It's strange as I create patch with same command (svn diff --force >
> ~/md_reader.patch) as previous one.

I didn't try to apply during my first review. Just looked at the diff.

> I add changes for metadata readers directly to svn trunk copy on my PC.
> I can create pull request for github GDAL trunk, but it takes some time
> to do, or I can just commit to svn trunk (preferable).
> If something will be wrong, it can be easily roll back.
> 
> So, I decide to commit my changes to trunk.

Sounds good. Once it is applied, you can have a look at the different test 
platforms (builds are scheduled at most 15 minutes after commit) :
https://travis-ci.org/rouault/gdal_coverage/builds/

> 
> Best regards,
>      Dmitry
> 
> 03.05.2015 12:11, Even Rouault ?????:
> > Dmitry,
> > 
> > I didn't manage to apply the patch (due to the binary files)
> > 
> > $ patch -p0 < /tmp/md_reader.patch
> > patching file autotest/gcore/data/md_dg.IMD
> > patching file autotest/gcore/data/md_dg.RPB
> > patching file autotest/gcore/data/md_dg.tif
> > patch: **** malformed patch at line 187: \ No newline at end of file
> > 
> > Is there some branch somewhere where it can be tested ?
> > 
> > That said, I have no further remarks on this updated patch which looks
> > good to me.
> > 
> > Even
> > 
> > Le dimanche 03 mai 2015 01:34:04, Dmitry Baryshnikov a ?crit :
> >> Hi everybody,
> >> 
> >> Let me introduce the patch to the current GDAL v.2 trunk. This patch
> >> change the way how imagery (satellite or aerial) metadata read. I create
> >> some base classes and several metadata readers: DigitalGlobe, GeoEye,
> >> OrbView (change existed code to use metadata readers), add Landsat,
> >> Pleiades, Resurs-DK1 (plan to add about 6 new satellites). Also I added
> >> new metadata domain: IMAGERY to hold some common imagery metadata:
> >> satellite, cloud cover, acquisition date/time. The cloud cover transform
> >> to values from 0 to 100 or 999 for n/a, and date/time to UTC.
> >> 
> >> Additional code review and testing are welcome. Also let me know, if I
> >> can commit this changes to trunk.
> >> 
> >> P.S. Even review the code of previous patch. I fix all errors reported
> >> by Even.
> >> 
> >> Best regards,
> >> 
> >>       Dmitry
> >> 
> >> 29.04.2015 21:40, Even Rouault ?????:
> >>> Hi,
> >>> 
> >>> I wanted to have an update from other developers to know where there
> >>> are with respect to their planned schedule.
> >>> I had noted that :
> >>> - Dmitriy wanted to integrate his work on metadata support for various
> >>> satellite imagery. I have reviewed a preliminary version of it.
> >>> - Ari has ongoing work on Perl. I've seen a few commits passed.
> >>> - Pirmin intended to add curve support in Interlis. Haven't seen yet
> >>> any commit.
> >>> 
> >>> Are you still in track to finalize those works in the following days ?
> >>> Would adding the week-end help to have that in Beta1 ? I especially
> >>> think to Dmitriy's work who is quite substantial, and perhaps Perl
> >>> changes if there are still breaking change to come. Interlis specfic
> >>> changes might arrive after Beta1 I think.
> >>> 
> >>> Even
> >>> 
> >>>> Hi,
> >>>> 
> >>>> Some time ago, I mentionned my proposal of issuing a first GDAL 2.0
> >>>> beta version for the end of this month (April 30th). Are there
> >>>> objections to sticking with that plan ? Does someone need a bit more
> >>>> time to finish an ongoing work ?
> >>>> 
> >>>> And if things go well with this beta (and potentially other beta(s)
> >>>> needed), we could try a release candidate for end of May. One month of
> >>>> beta phase might seem a bit short, but I'm not sure extending the beta
> >>>> testing period more will bring significant additional feedback (and
> >>>> things tend to slip, so better aim for a tight schedule). Thoughts ?
> >>>> Anyone using GDAL intensively and/or interesting in 2.0 should already
> >>>> track trunk closely ;-)
> >>>> 
> >>>> I can wear the hat of 2.0 release manager, but I'm happy to let it to
> >>>> any other volunteer.
> >>>> 
> >>>> Best regards,
> >>>> 
> >>>> Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From landa.martin at gmail.com  Sun May  3 06:11:15 2015
From: landa.martin at gmail.com (Martin Landa)
Date: Sun, 3 May 2015 15:11:15 +0200
Subject: [gdal-dev] open zipped gml
In-Reply-To: <201505031251.18204.even.rouault@spatialys.com>
References: <CA+Ei1OcVei20gZ6jQcPse8Ce1FBy4LWjvYyorM0ovAO7aFp-ug@mail.gmail.com>
	<201505031251.18204.even.rouault@spatialys.com>
Message-ID: <CA+Ei1OeRWrUWfXHWPibxFMSCMYZVivuGBRzxOqt3Fw863Jrf3g@mail.gmail.com>

2015-05-03 12:51 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
> ogrinfo /vsizip/DOP_ZachParkoviste_b_gml.zip/DOP_ZachParkoviste_b.gml -ro

thanks for clarification, Martin

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.cz/mentors/landa

From TomW at msc.qld.gov.au  Sun May  3 22:23:25 2015
From: TomW at msc.qld.gov.au (Tom Wardrop)
Date: Mon, 4 May 2015 05:23:25 +0000
Subject: [gdal-dev] gdal_retile not generating alpha band
Message-ID: <D16D3F6B.2FE75%tomw@msc.qld.gov.au>

Hi all,

I retiled whole lot of imagery over the weekend using the following gdal_retile command:


gdal_retile.py -v -r bilinear -levels 8 -ps 2048 2048 -s_srs EPSG:28355 -co "TILED=YES" -co "ALPHA=YES" -targetDir ~/output ~/input/*.tif

The result was good until I realised all the areas that should be transparent were instead black. It seems the problem is the source imagery didn?t have an alpha channel; it didn?t need one as there was no transparent data to represent. Because the source imagery didn?t fill the entire extent, gdal_retile had to create loads of transparent and partially-transparent tiles, which of course wound up black.

I was under the impression that "-co ALPHA=YES? would instruct gdal_retile to generate an alpha channel for all the generated tiles. Is this a bug? If not, how do I otherwise instruct gdal_retile to generate an alpha channel when required?

I?m working around this by using gdal_translate to re-save the source imagery with an (empty) alpha channel, so gdal_retile now outputs transparent tiles.

Any feedback is appreciated.

Cheers,
Tom


________________________________

Mareeba Shire Council Disclaimer

This message and any attachments may contain privileged and confidential information intended only for the use of the intended addressee(s). Any unauthorised use of this material is prohibited. If you received this message in error please notify the sender immediately, delete the message and destroy any printed or electronic copies. Opinions expressed in this e-mail are those of the sender and do not necessarily represent the views of the Mareeba Shire Council. Council does not accept any responsibility for the loss or damage that may result from reliance on, or the use of, any information contained in this e-mail or attachments.

We recommend that you scan this e-mail and any attachments for viruses before opening. This Council does not accept liability for any loss or damage incurred either directly or indirectly from opening this e-mail or any attachments to it.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150504/d1f078ca/attachment.html>

From even.rouault at spatialys.com  Mon May  4 06:20:50 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 4 May 2015 15:20:50 +0200
Subject: [gdal-dev] GDAL/OGR 2.0.0 Beta 1 Available
Message-ID: <201505041520.50488.even.rouault@spatialys.com>

Hi,

I have prepared the GDAL/OGR 2.0.0 Beta1 release.  It will potentially be 
followed by a second beta in the second half of this month and with hopefully 
a RC1 end of month/beginning of June.  The source is available at:

   http://download.osgeo.org/gdal/2.0.0beta1/gdal-2.0.0beta1.tar.xz
   http://download.osgeo.org/gdal/2.0.0beta1/gdal-2.0.0beta1.tar.gz
   http://download.osgeo.org/gdal/2.0.0beta1/gdal200beta1.zip

A snapshot of the Python autotest suite can be downloaded from:

   http://download.osgeo.org/gdal/2.0.0beta1/gdalautotest-2.0.0beta1.tar.gz
   http://download.osgeo.org/gdal/2.0.0beta1/gdalautotest-2.0.0beta1.zip

The GRASS plugins can be downloaded from:

   http://download.osgeo.org/gdal/2.0.0beta1/gdal-grass-2.0.0beta1.tar.gz

A test matrix document has been created in which people are encouraged to 
report the build environments they have tried and the tests done :

   http://trac.osgeo.org/gdal/wiki/TestMatrix200

New bugs found should be filed in Trac normally.

   http://trac.osgeo.org/gdal

GDAL developers and users are encouraged to treat the coming weeks
as the prime time for bug finding and fixing.  

I also recommend developers integrating GDAL into their libraries and 
applications that haven't tracked trunk lately to try it out and have a close 
look at http://svn.osgeo.org/gdal/trunk/gdal/MIGRATION_GUIDE.TXT since a 
number of breaking changes, especially on OGR C++ side, have been done.

The preliminary NEWS is available at :
     http://svn.osgeo.org/gdal/trunk/gdal/NEWS

GDAL committers should be even more careful than usually about what they 
commit in this period before the actual release. I haven't yet created a 2.0 
branch, so anything that is committed into trunk for now will be in final 2.0. 
If that blocks development for anyone, we can easily create the 2.0 branch 
when needed.

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gdal at stripfamily.net  Mon May  4 07:49:43 2015
From: gdal at stripfamily.net (David Strip)
Date: Mon, 04 May 2015 08:49:43 -0600
Subject: [gdal-dev] gdal_retile not generating alpha band
In-Reply-To: <D16D3F6B.2FE75%tomw@msc.qld.gov.au>
References: <D16D3F6B.2FE75%tomw@msc.qld.gov.au>
Message-ID: <55478707.9040005@stripfamily.net>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150504/6b845f05/attachment.html>

From TomW at msc.qld.gov.au  Mon May  4 16:41:21 2015
From: TomW at msc.qld.gov.au (Tom Wardrop)
Date: Mon, 4 May 2015 23:41:21 +0000
Subject: [gdal-dev] gdal_retile not generating alpha band
In-Reply-To: <55478707.9040005@stripfamily.net>
References: <D16D3F6B.2FE75%tomw@msc.qld.gov.au>
	<55478707.9040005@stripfamily.net>
Message-ID: <D16E403B.2FEBC%tomw@msc.qld.gov.au>

It would be really nice if I could find a single pass solution for this. I need to retile 200GB of imagery and would prefer not to have to process it twice. I think my work-around using gdal_translate is a better solution than converting black pixels to alpha, besides, I?m using GeoServer with the ImagePyramid plugin which I don?t believe supports ?nodata? transparency. It needs an alpha channel.

Tom Wardrop
IT Development Officer
ICT Section, Systems & Customer Service Group

[Description: C:\Users\royl.MSC\AppData\Roaming\Microsoft\Signatures\logo\logo.png]
Phone: 1300 308 461  |  Direct: 07 4086 4668  |  Fax: 07 4092 3323
Email: tomw at msc.qld.gov.au<mailto:RoyL at msc.qld.gov.au>  |  Website: www.msc.qld.gov.au<http://www.msc.qld.gov.au/>
65 Rankin Street, Mareeba  |  PO Box 154, Mareeba, Queensland, Australia, 4880

? Go green, keep it on screen - think before you print


From: David Strip <gdal at stripfamily.net<mailto:gdal at stripfamily.net>>
Date: Tuesday, 5 May 2015 12:49 am
To: Tom Wardrop <tomw at msc.qld.gov.au<mailto:tomw at msc.qld.gov.au>>, "gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>" <gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>>
Subject: Re: [gdal-dev] gdal_retile not generating alpha band

This sounds more like a problem with a missing NODATA value rather than transparency/alpha. As far as I can tell from the docs, there is no means to specify the NODATA value in the gdal_retile command, including the CO options. If the only place that true black occurs is in the regions with no input, you could use gdal_edit.py to add a NODATA value.

On 5/3/2015 11:23 PM, Tom Wardrop wrote:
Hi all,

I retiled whole lot of imagery over the weekend using the following gdal_retile command:


gdal_retile.py -v -r bilinear -levels 8 -ps 2048 2048 -s_srs EPSG:28355 -co "TILED=YES" -co "ALPHA=YES" -targetDir ~/output ~/input/*.tif

The result was good until I realised all the areas that should be transparent were instead black. It seems the problem is the source imagery didn?t have an alpha channel; it didn?t need one as there was no transparent data to represent. Because the source imagery didn?t fill the entire extent, gdal_retile had to create loads of transparent and partially-transparent tiles, which of course wound up black.

I was under the impression that "-co ALPHA=YES? would instruct gdal_retile to generate an alpha channel for all the generated tiles. Is this a bug? If not, how do I otherwise instruct gdal_retile to generate an alpha channel when required?

I?m working around this by using gdal_translate to re-save the source imagery with an (empty) alpha channel, so gdal_retile now outputs transparent tiles.

Any feedback is appreciated.

Cheers,
Tom




________________________________

Mareeba Shire Council Disclaimer

This message and any attachments may contain privileged and confidential information intended only for the use of the intended addressee(s). Any unauthorised use of this material is prohibited. If you received this message in error please notify the sender immediately, delete the message and destroy any printed or electronic copies. Opinions expressed in this e-mail are those of the sender and do not necessarily represent the views of the Mareeba Shire Council. Council does not accept any responsibility for the loss or damage that may result from reliance on, or the use of, any information contained in this e-mail or attachments.

We recommend that you scan this e-mail and any attachments for viruses before opening. This Council does not accept liability for any loss or damage incurred either directly or indirectly from opening this e-mail or any attachments to it.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150504/72f37dc9/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 403C01F8-B3C0-4FFC-B18D-E7CE62F0DC36[12].png
Type: image/png
Size: 9094 bytes
Desc: 403C01F8-B3C0-4FFC-B18D-E7CE62F0DC36[12].png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150504/72f37dc9/attachment.png>

From grb at skogoglandskap.no  Tue May  5 09:12:02 2015
From: grb at skogoglandskap.no (Graeme B. Bell)
Date: Tue, 5 May 2015 16:12:02 +0000
Subject: [gdal-dev] GDAL slow to write GeoTIFF?
In-Reply-To: <mailman.39.1430161236.31237.gdal-dev@lists.osgeo.org>
References: <mailman.39.1430161236.31237.gdal-dev@lists.osgeo.org>
Message-ID: <0C066B06-F74A-40DB-B669-ACDA96C1092A@skogoglandskap.no>


Gdal doesn't do well with ultra-large rasters in my experience.

Locally we split our rasters up into tiles, process tiles in parallel with Gnu Parallel, then use gdal_merge or gdalwarp to join them back together (usually gdal_merge is faster).
This usually brings our processing times on high res national rasters down to tens-of-minutes instead of days. 

If the raster is formed from original polygon data e.g. gdal_rasterize output, be sure to use compression, it will improve performance and file storage by 1-2 orders of magnitude. 

Graeme.


From mattbriggs at yahoo.com  Tue May  5 14:11:58 2015
From: mattbriggs at yahoo.com (Matt Briggs)
Date: Tue, 5 May 2015 14:11:58 -0700
Subject: [gdal-dev] gdal2tiles tile origin differences
Message-ID: <1430860318.96914.YahooMailBasic@web121106.mail.ne1.yahoo.com>

Hi,
 
 I am getting different X and Y values for tiles from gdal2tiles.py when in a PC
 (OSGeo4W - GDAL 1.9.2) environment and Linux (GDAL
 1.10.1).? It seems to me that the newer 1.10.2 x's and y's are wrong (not respecting the specified origin). 

 Is this a bug, which result is correct, and how do I get them to
 behave the same?
  

===

Details:
 I've created a sample tileset on a PC in windows using the
 tools from GDAL 1.9.2 in OSGeo4W for a map in projection
 NZTM2000 (EPSG:2193).? The resulting tiles are
 generated as-per my expectations, and the origin from which
 the tiles are numbered is the origin of the projection
 (+lat_0=0 +lon_0=173).
 
 Having perfected this with a small map area, I switched to a
 cloud server running linux and gdal1.10.1.? The process
 appears to run successfully - tiles are generated, BUT the
 tile x and y numbers are different.
 
 After much stuffing around, I've realised that the x and y
 values used match those used for the same geographic area
 when using the default EPSG:4326.? 
 
 During troubleshooting I have run the gdal2tiles on the same
 single map sheet with the same command line options in both
 environments, manually specifying the SRS in case the
 definitions differ, and got two different results.?
 I've also tested it using the built-in projection -s
 EPSG:2193.
 
 python gdal2tiles.py test.tif -s '+proj=tmerc +lat_0=0
 +lon_0=173 +k=0.9996 +x_0=1600000 +y_0=10000000 +ellps=GRS80
 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs' -z 5-10
 
 
 PC / Windows / Cygwin:
 mbriggs at forestero
 /d/OSGeo4W/maps_past $ ls test/11/
 1116/? 1117/? 1118/
 mbriggs at forestero
 /d/OSGeo4W/maps_past $ ls test/11/1116
 1303.png*? 1304.png*
 mbriggs at forestero
 /d/OSGeo4W/maps_past $ 
 
 Linux:
 mbriggs at dev:~$ ls
 test/11
 2022? 2023? 2024? 2025
 mbriggs at dev:~$ ls
 test/11/2022
 767.png? 768.png? 769.png
 mbriggs at dev:~$ 
 
 
 
 mbriggs at dev:~$ gdalinfo
 test.tif
 Driver: GTiff/GeoTIFF
 Files: test.tif
 Size is 4193, 2861
 Coordinate System is:
 PROJCS["unnamed",
 ? ? GEOGCS["GRS 1980(IUGG, 1980)",
 ? ? ? ? DATUM["unknown",
 ? ? ? ? ? ?
 SPHEROID["GRS80",6378137,298.257222101]],
 ? ? ? ? PRIMEM["Greenwich",0],
 ? ? ? ?
 UNIT["degree",0.0174532925199433]],
 ? ? PROJECTION["Transverse_Mercator"],
 ? ? PARAMETER["latitude_of_origin",0],
 ? ? PARAMETER["central_meridian",173],
 ? ? PARAMETER["scale_factor",0.9996],
 ? ? PARAMETER["false_easting",1600000],
 ? ? PARAMETER["false_northing",10000000],
 ? ? UNIT["metre",1,
 ? ? ? ? AUTHORITY["EPSG","9001"]]]
 Origin = (1810357.092181787360460,5488467.918922254815698)
 Pixel Size = (10.000000000000000,-10.000000000000000)
 Metadata:
 ? AREA_OR_POINT=Area
 Image Structure Metadata:
 ? INTERLEAVE=PIXEL
 Corner Coordinates:
 Upper Left? ( 1810357.092, 5488467.919)
 (175d29'27.21"E, 40d43'40.29"S)
 Lower Left? ( 1810357.092, 5459857.919) (175d30'
 2.02"E, 40d59' 7.25"S)
 Upper Right ( 1852287.092, 5488467.919) (175d59'12.51"E,
 40d42'57.90"S)
 Lower Right ( 1852287.092, 5459857.919) (175d59'54.22"E,
 40d58'24.47"S)
 Center? ? ? ( 1831322.092, 5474162.919)
 (175d44'39.06"E, 40d51' 3.45"S)
 Band 1 Block=4193x1 Type=Byte, ColorInterp=Red
 ? Mask Flags: PER_DATASET ALPHA 
 Band 2 Block=4193x1 Type=Byte, ColorInterp=Green
 ? Mask Flags: PER_DATASET ALPHA 
 Band 3 Block=4193x1 Type=Byte, ColorInterp=Blue
 ? Mask Flags: PER_DATASET ALPHA 
 Band 4 Block=4193x1 Type=Byte, ColorInterp=Alpha
 mbriggs at dev:~$ 
 
 
 
 Cheers,
 
 Matt
 

From pavol.hnila at fu-berlin.de  Wed May  6 05:30:23 2015
From: pavol.hnila at fu-berlin.de (Pavol Hnila)
Date: Wed, 06 May 2015 14:30:23 +0200
Subject: [gdal-dev] Problems with MySQL queries in GDAL
Message-ID: <554A095F.10400@fu-berlin.de>

Dear GDAL-developers,

I have noticed that the GDAL-Versions 1.11.2 used in QGIS 2.8 produce
complicated queries passed to MySQL that cause huge delays in QGIS when
working with spatial layers based on MySQL. It looks to me that GDAL
queries each time all tables in a database, even if only a single table
is requested. The older version 1.9.2 (used in QGIS 1.8) has not this
issue. I have described the problem in depth here:

http://gis.stackexchange.com/questions/135865/why-are-mysql-connections-extremely-slow-in-qgis-2-0-2-8-when-compared-to-qgi

The query logs of MySQL-Server can be seen here:
https://drive.google.com/folderview?id=0B1VM28puP8EPfmF2dGpjamVDWVZ6Vm1veHgtOElhY2lHb0ZTSlI1WXNuWWFvU3pRQmVLMTA&usp=sharing

Can someone have a look at it? I would greatly appreciate an explanation
of this GDAL behaviour and even more some fix or work-around. Can
someone replicate the problem or is there something specific about my
database design?

With best wishes,
Pavol

From even.rouault at spatialys.com  Wed May  6 06:57:54 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 6 May 2015 15:57:54 +0200
Subject: [gdal-dev] Problems with MySQL queries in GDAL
In-Reply-To: <554A095F.10400@fu-berlin.de>
References: <554A095F.10400@fu-berlin.de>
Message-ID: <201505061557.54897.even.rouault@spatialys.com>

Pavol,

I think I have noticed that behaviour with a QGIS version of some time ago , 
and it is (was? if it is fixed now) an issue specific to QGIS that opened&closed 
many connections to GDAL when browsing through a table (and that with any GDAL 
datasource, not specifically MySQL). The logs you show are typical of this. 
Nothing that GDAL can do about (well, it could lazily establish the schema of 
the accessed layers, but that would be a micro optimization, whereas the real 
fix is to be done in QGIS). So check with QGIS folks.

Even

> Dear GDAL-developers,
> 
> I have noticed that the GDAL-Versions 1.11.2 used in QGIS 2.8 produce
> complicated queries passed to MySQL that cause huge delays in QGIS when
> working with spatial layers based on MySQL. It looks to me that GDAL
> queries each time all tables in a database, even if only a single table
> is requested. The older version 1.9.2 (used in QGIS 1.8) has not this
> issue. I have described the problem in depth here:
> 
> http://gis.stackexchange.com/questions/135865/why-are-mysql-connections-ext
> remely-slow-in-qgis-2-0-2-8-when-compared-to-qgi
> 
> The query logs of MySQL-Server can be seen here:
> https://drive.google.com/folderview?id=0B1VM28puP8EPfmF2dGpjamVDWVZ6Vm1veHg
> tOElhY2lHb0ZTSlI1WXNuWWFvU3pRQmVLMTA&usp=sharing
> 
> Can someone have a look at it? I would greatly appreciate an explanation
> of this GDAL behaviour and even more some fix or work-around. Can
> someone replicate the problem or is there something specific about my
> database design?
> 
> With best wishes,
> Pavol
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From brodzik at nsidc.org  Wed May  6 08:24:57 2015
From: brodzik at nsidc.org (Mary Jo Brodzik)
Date: Wed, 6 May 2015 09:24:57 -0600 (MDT)
Subject: [gdal-dev] Requesting gdal update to at least EPSG v8.6
Message-ID: <alpine.OSX.1.10.1505060912560.15657@nsidc-worsley.ad.int.nsidc.org>


Hello,

I would like to request that gdal be updated to use the latest EPSG codes.

I worked with EPSG last year to correct some obsolete ProjectedCRS 
definitions for some products I am developing, and I understand that the 
corrected definitions were included in EPSG v8.6, released in Nov 2014.

I am unsure how to actually confirm the EPSG version included with gdal, 
but I did find this trac ticket (http://trac.osgeo.org/gdal/ticket/5462) 
that looks like you upgraded to epsg v8.4 in May 2014.

The EPSG web site at www.epsg-registry.org seems to indicate the latest 
version may be 8.7.  I don't know what is new.  For my purposes and to let 
my users know, v8.6 or better is what I need.

Thank you,
Mary Jo Brodzik

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Mary Jo Brodzik, Senior Associate Scientist, 303-492-8263
NSIDC/CIRES, Univ. of Colo. at Boulder, 449 UCB, Boulder, CO 80309-0449
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

From even.rouault at spatialys.com  Wed May  6 08:48:34 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 6 May 2015 17:48:34 +0200
Subject: [gdal-dev] Requesting gdal update to at least EPSG v8.6
In-Reply-To: <alpine.OSX.1.10.1505060912560.15657@nsidc-worsley.ad.int.nsidc.org>
References: <alpine.OSX.1.10.1505060912560.15657@nsidc-worsley.ad.int.nsidc.org>
Message-ID: <201505061748.34409.even.rouault@spatialys.com>

Le mercredi 06 mai 2015 17:24:57, vous avez ?crit :
> Hello,
> 
> I would like to request that gdal be updated to use the latest EPSG codes.
> 
> I worked with EPSG last year to correct some obsolete ProjectedCRS
> definitions for some products I am developing, and I understand that the
> corrected definitions were included in EPSG v8.6, released in Nov 2014.
> 
> I am unsure how to actually confirm the EPSG version included with gdal,
> but I did find this trac ticket (http://trac.osgeo.org/gdal/ticket/5462)
> that looks like you upgraded to epsg v8.4 in May 2014.

Mary,

GDAL 2.0 (currently in beta1) has been upgraded to EPSG v8.5. Isn't that good 
enough ? Which EPSG codes are you interested in ?

Even

> 
> The EPSG web site at www.epsg-registry.org seems to indicate the latest
> version may be 8.7.  I don't know what is new.  For my purposes and to let
> my users know, v8.6 or better is what I need.
> 
> Thank you,
> Mary Jo Brodzik
> 
> ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
> Mary Jo Brodzik, Senior Associate Scientist, 303-492-8263
> NSIDC/CIRES, Univ. of Colo. at Boulder, 449 UCB, Boulder, CO 80309-0449
> ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From brodzik at nsidc.org  Wed May  6 09:01:59 2015
From: brodzik at nsidc.org (Mary Jo Brodzik)
Date: Wed, 6 May 2015 10:01:59 -0600 (MDT)
Subject: [gdal-dev] Requesting gdal update to at least EPSG v8.6
In-Reply-To: <201505061748.34409.even.rouault@spatialys.com>
References: <alpine.OSX.1.10.1505060912560.15657@nsidc-worsley.ad.int.nsidc.org>
	<201505061748.34409.even.rouault@spatialys.com>
Message-ID: <alpine.OSX.1.10.1505060949360.15657@nsidc-worsley.ad.int.nsidc.org>


Bonjour, Even,  Merci for the quick response!

Unfortunately, I don't think v8.5 is good enough.  I worked with Roger 
Lott late last year, and he made several corrections, including:

1) New projection Conversion codes 6928, 6929, 6930
2) New ProjectedCRS codes 6931, 6932 and 6933
3) Changed the state of deprecated codes 3973, 3974, 3975 to "Invalid" 
because they were incorrect
4) Edited descriptions for 3408, 3409 and 3410 to indicate they are 
now superceded.

Roger did indicate that he had some of these in a patch release of EPSG 
v.8.5.4, but that there were still some names and metadata that were 
incorrect in 8.5.4 that were correctly released in v8.6.  From Roger:

> As far as the projection and CRS definitions are concerned everything is 
> already OK in v8.5.4 in that coordinate conversions using CRSs 6931-33 
> will be correctly implemented. It is only metadata (projection [but not 
> CRS] names and projection and CRS remarks) that will change. As soon as 
> we publish v8.6, v8.5.4 will no longer be available and the metadata you 
> consider wrong will be lost to posterity.

Mary Jo

On Wed, 6 May 2015, Even Rouault wrote:

> Date: Wed, 6 May 2015 17:48:34 +0200
> From: Even Rouault <even.rouault at spatialys.com>
> To: Mary Jo Brodzik <brodzik at nsidc.org>
> Cc: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] Requesting gdal update to at least EPSG v8.6
> 
> Le mercredi 06 mai 2015 17:24:57, vous avez ?crit :
>> Hello,
>>
>> I would like to request that gdal be updated to use the latest EPSG codes.
>>
>> I worked with EPSG last year to correct some obsolete ProjectedCRS
>> definitions for some products I am developing, and I understand that the
>> corrected definitions were included in EPSG v8.6, released in Nov 2014.
>>
>> I am unsure how to actually confirm the EPSG version included with gdal,
>> but I did find this trac ticket (http://trac.osgeo.org/gdal/ticket/5462)
>> that looks like you upgraded to epsg v8.4 in May 2014.
>
> Mary,
>
> GDAL 2.0 (currently in beta1) has been upgraded to EPSG v8.5. Isn't that good
> enough ? Which EPSG codes are you interested in ?
>
> Even
>
>>
>> The EPSG web site at www.epsg-registry.org seems to indicate the latest
>> version may be 8.7.  I don't know what is new.  For my purposes and to let
>> my users know, v8.6 or better is what I need.
>>
>> Thank you,
>> Mary Jo Brodzik
>>
>> ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
>> Mary Jo Brodzik, Senior Associate Scientist, 303-492-8263
>> NSIDC/CIRES, Univ. of Colo. at Boulder, 449 UCB, Boulder, CO 80309-0449
>> ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Mary Jo Brodzik, Senior Associate Scientist, 303-492-8263
NSIDC/CIRES, Univ. of Colo. at Boulder, 449 UCB, Boulder, CO 80309-0449
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

From even.rouault at spatialys.com  Wed May  6 09:17:18 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 6 May 2015 18:17:18 +0200
Subject: [gdal-dev] Requesting gdal update to at least EPSG v8.6
In-Reply-To: <alpine.OSX.1.10.1505060949360.15657@nsidc-worsley.ad.int.nsidc.org>
References: <alpine.OSX.1.10.1505060912560.15657@nsidc-worsley.ad.int.nsidc.org>
	<201505061748.34409.even.rouault@spatialys.com>
	<alpine.OSX.1.10.1505060949360.15657@nsidc-worsley.ad.int.nsidc.org>
Message-ID: <201505061817.18652.even.rouault@spatialys.com>

Le mercredi 06 mai 2015 18:01:59, Mary Jo Brodzik a ?crit :
> Bonjour, Even,  Merci for the quick response!
> 
> Unfortunately, I don't think v8.5 is good enough.  I worked with Roger
> Lott late last year, and he made several corrections, including:
> 
> 1) New projection Conversion codes 6928, 6929, 6930
> 2) New ProjectedCRS codes 6931, 6932 and 6933

They aren't yet in the version that was imported.

I'm moderately enthusiastic about redoing a new sync with latest EPSG database 
for just 3 codes, unless there's a strong demand from the community. You can 
workaround by manually adding in epsg.wkt the WKT definitions (old-style) of 
the PCS you're interested into.

If anyone is willing to do the update, the procedure is described here :
http://trac.osgeo.org/geotiff/browser/trunk/libgeotiff/csv/README


> 3) Changed the state of deprecated codes 3973, 3974, 3975 to "Invalid"
> because they were incorrect
> 4) Edited descriptions for 3408, 3409 and 3410 to indicate they are
> now superceded.
> 
> Roger did indicate that he had some of these in a patch release of EPSG
> v.8.5.4, but that there were still some names and metadata that were
> 
> incorrect in 8.5.4 that were correctly released in v8.6.  From Roger:
> > As far as the projection and CRS definitions are concerned everything is
> > already OK in v8.5.4 in that coordinate conversions using CRSs 6931-33
> > will be correctly implemented. It is only metadata (projection [but not
> > CRS] names and projection and CRS remarks) that will change. As soon as
> > we publish v8.6, v8.5.4 will no longer be available and the metadata you
> > consider wrong will be lost to posterity.
> 
> Mary Jo
> 
> On Wed, 6 May 2015, Even Rouault wrote:
> > Date: Wed, 6 May 2015 17:48:34 +0200
> > From: Even Rouault <even.rouault at spatialys.com>
> > To: Mary Jo Brodzik <brodzik at nsidc.org>
> > Cc: gdal-dev at lists.osgeo.org
> > Subject: Re: [gdal-dev] Requesting gdal update to at least EPSG v8.6
> > 
> > Le mercredi 06 mai 2015 17:24:57, vous avez ?crit :
> >> Hello,
> >> 
> >> I would like to request that gdal be updated to use the latest EPSG
> >> codes.
> >> 
> >> I worked with EPSG last year to correct some obsolete ProjectedCRS
> >> definitions for some products I am developing, and I understand that the
> >> corrected definitions were included in EPSG v8.6, released in Nov 2014.
> >> 
> >> I am unsure how to actually confirm the EPSG version included with gdal,
> >> but I did find this trac ticket (http://trac.osgeo.org/gdal/ticket/5462)
> >> that looks like you upgraded to epsg v8.4 in May 2014.
> > 
> > Mary,
> > 
> > GDAL 2.0 (currently in beta1) has been upgraded to EPSG v8.5. Isn't that
> > good enough ? Which EPSG codes are you interested in ?
> > 
> > Even
> > 
> >> The EPSG web site at www.epsg-registry.org seems to indicate the latest
> >> version may be 8.7.  I don't know what is new.  For my purposes and to
> >> let my users know, v8.6 or better is what I need.
> >> 
> >> Thank you,
> >> Mary Jo Brodzik
> >> 
> >> ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
> >> Mary Jo Brodzik, Senior Associate Scientist, 303-492-8263
> >> NSIDC/CIRES, Univ. of Colo. at Boulder, 449 UCB, Boulder, CO 80309-0449
> >> ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
> >> _______________________________________________
> >> gdal-dev mailing list
> >> gdal-dev at lists.osgeo.org
> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
> Mary Jo Brodzik, Senior Associate Scientist, 303-492-8263
> NSIDC/CIRES, Univ. of Colo. at Boulder, 449 UCB, Boulder, CO 80309-0449
> ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed May  6 09:22:52 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 6 May 2015 18:22:52 +0200
Subject: [gdal-dev] Problems with MySQL queries in GDAL
In-Reply-To: <g3bg9koo5afow9rplnuff1hq.1430927662704@email.android.com>
References: <554A095F.10400@fu-berlin.de>
	<201505061557.54897.even.rouault@spatialys.com>
	<g3bg9koo5afow9rplnuff1hq.1430927662704@email.android.com>
Message-ID: <201505061822.52589.even.rouault@spatialys.com>

Le mercredi 06 mai 2015 18:15:11, Pavol Hnila a ?crit :
> Even,
> 
> Thank you very much for your reply. I have actually also tried with OSGeo4W
> command line tool for Windows 7, using "ogrinfo mysql:... tablename"
> syntax. The result in mysql log file seems to be the same as with Qgis, so
> I concluded that the reason must be gdal.

I guess you just a DESCRIBE for each layer, but not multiple times for a given 
layer ?
I assumed this was the problem you had (multiple DESCRIBE for a given layer) 
given the logs you showed.

If your issue is rather that at dataset opening all layers are queried with 
DESCRIBE, then yes this is expected from the current state of the mysql 
driver. That could potentially be improved.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed May  6 09:54:14 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 6 May 2015 18:54:14 +0200
Subject: [gdal-dev] Problems with MySQL queries in GDAL
In-Reply-To: <2ivl8xo1cnuwsobg2dn8i383.1430930429750@email.android.com>
References: <554A095F.10400@fu-berlin.de>
	<201505061822.52589.even.rouault@spatialys.com>
	<2ivl8xo1cnuwsobg2dn8i383.1430930429750@email.android.com>
Message-ID: <201505061854.14914.even.rouault@spatialys.com>

Le mercredi 06 mai 2015 18:48:39, Pavol Hnila a ?crit :
> My impression is that all layers are queried for each record/row in the
> table that needs to be shown. If I have 34 rows in my layer and it is a
> single layer, there will be 34 queries. If I have 80 tables in the same
> database and I want to show those 34 rows of one table/layer, then there
> will be 34x80 queries. But why?

I've instrumented the mysql driver to emit a debug trace each time DESCRIBE is 
issued. The result is that all spatial layers are DESCRIBEd one and only once 
for each dataset opening.
If you see DESCRIBE for a same layer showing several times, then it means that 
QGIS is opening/closing the OGR dataset many times. Which would be conformant 
to the issue I noticed some time ago.

> 
> Pavol
> 
> ---- Even Rouault schrieb ----
> 
> >Le mercredi 06 mai 2015 18:15:11, Pavol Hnila a ?crit :
> >> Even,
> >> 
> >> Thank you very much for your reply. I have actually also tried with
> >> OSGeo4W command line tool for Windows 7, using "ogrinfo mysql:...
> >> tablename" syntax. The result in mysql log file seems to be the same as
> >> with Qgis, so I concluded that the reason must be gdal.
> >
> >I guess you just a DESCRIBE for each layer, but not multiple times for a
> >given layer ?
> >I assumed this was the problem you had (multiple DESCRIBE for a given
> >layer) given the logs you showed.
> >
> >If your issue is rather that at dataset opening all layers are queried
> >with DESCRIBE, then yes this is expected from the current state of the
> >mysql driver. That could potentially be improved.
> >
> >Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu May  7 03:23:11 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 7 May 2015 12:23:11 +0200
Subject: [gdal-dev] Problems with MySQL queries in GDAL
In-Reply-To: <554B38EB.6050305@fu-berlin.de>
References: <554A095F.10400@fu-berlin.de>
	<201505061854.14914.even.rouault@spatialys.com>
	<554B38EB.6050305@fu-berlin.de>
Message-ID: <201505071223.11769.even.rouault@spatialys.com>

Le jeudi 07 mai 2015 12:05:31, Pavol Hnila a ?crit :
> You are right, Even. I made tests today with pure GDAL (1.11)
> command-line tools. Running the "ogrinfo mysql:...tablename" command
> results in all MySQL layers being queried, but only once. So it must be
> the QGIS implementation issue that asks MySQL to query all layers for
> each row, each time, even when zooming in and out. I will contact the
> QGIS folks again.
> 
> Yet - for the GDAL part - I still have two more questions.
> 
> 1) You mentioned that it is expected from the current MySQL driver that
> all the layers are queried at the dataset opening, even if a single
> layer is wanted. Is there a particular advantage in that or did you mean
> with "improving the opening" to eliminate this behaviour?

Yes I meant that querying all the layers is what the MySQL driver currently 
does, as I guess it was easier to implement.
Note that you can specify a tables=a_table;another_table option in the mysql 
connection string that will restrict the number of tables visible&queried to 
the ones you specify

> 
> 2) The current GDAL MySQL driver presupposes the existence of the
> "geometry_columns" table, which is still not standartly implemented in
> MySQL environment. In our MySQL-Database we did not have
> "geometry_columns" table. But even after I have added those table (using
> automatic creation by GDAL when importing a custom shp file with
> ogr2ogr) and adjusted the values in order to correspond with the actual
> tables in the database, I see no change in the behaviour or performance
> of MySQL driver. Why then does the MySQL driver query it?

geometry_columns is specified by the OGC Simple Feature for SQL specification ( 
https://portal.opengeospatial.org/files/?artifact_id=829 ). It contains 
metadata for spatial layers such as the geometry type (point, line, polygon), 
the coordinate dimension (2D vs 3D) and the spatial reference system ID (whose 
definition is then queried in the spatial_ref_sys table). 
It is not intended to improve performance.
The driver could possibly be improved to quietly deal with the absence of 
geometry_columns (in which case, geometry type and spatial reference system 
wouldn't be reported in layer metadata)

> 
> Pavol
> 
> On 06.05.2015 18:54, Even Rouault wrote:
> > Le mercredi 06 mai 2015 18:48:39, Pavol Hnila a ?crit :
> >> My impression is that all layers are queried for each record/row in the
> >> table that needs to be shown. If I have 34 rows in my layer and it is a
> >> single layer, there will be 34 queries. If I have 80 tables in the same
> >> database and I want to show those 34 rows of one table/layer, then there
> >> will be 34x80 queries. But why?
> > 
> > I've instrumented the mysql driver to emit a debug trace each time
> > DESCRIBE is issued. The result is that all spatial layers are DESCRIBEd
> > one and only once for each dataset opening.
> > If you see DESCRIBE for a same layer showing several times, then it means
> > that QGIS is opening/closing the OGR dataset many times. Which would be
> > conformant to the issue I noticed some time ago.
> > 
> >> Pavol
> >> 
> >> ---- Even Rouault schrieb ----
> >> 
> >>> Le mercredi 06 mai 2015 18:15:11, Pavol Hnila a ?crit :
> >>>> Even,
> >>>> 
> >>>> Thank you very much for your reply. I have actually also tried with
> >>>> OSGeo4W command line tool for Windows 7, using "ogrinfo mysql:...
> >>>> tablename" syntax. The result in mysql log file seems to be the same
> >>>> as with Qgis, so I concluded that the reason must be gdal.
> >>> 
> >>> I guess you just a DESCRIBE for each layer, but not multiple times for
> >>> a given layer ?
> >>> I assumed this was the problem you had (multiple DESCRIBE for a given
> >>> layer) given the logs you showed.
> >>> 
> >>> If your issue is rather that at dataset opening all layers are queried
> >>> with DESCRIBE, then yes this is expected from the current state of the
> >>> mysql driver. That could potentially be improved.
> >>> 
> >>> Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jacek.tomaka at hexagongeospatial.com  Thu May  7 04:53:57 2015
From: jacek.tomaka at hexagongeospatial.com (Tomaka, Jacek)
Date: Thu, 7 May 2015 11:53:57 +0000
Subject: [gdal-dev] RFC 47 Status.
Message-ID: <3ED562F633B1AE46BF141E903F981307585746DC@ap-mbx3.ingrnet.com>

Hi,

What is the current status of RFC 47?
Is per dataset caching going to make it to GDAL 2.0?

Regards.
Jacek Tomaka
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150507/814b8ff8/attachment.html>

From even.rouault at spatialys.com  Thu May  7 05:05:27 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 7 May 2015 14:05:27 +0200
Subject: [gdal-dev] RFC 47 Status.
In-Reply-To: <3ED562F633B1AE46BF141E903F981307585746DC@ap-mbx3.ingrnet.com>
References: <3ED562F633B1AE46BF141E903F981307585746DC@ap-mbx3.ingrnet.com>
Message-ID: <201505071405.27991.even.rouault@spatialys.com>

Jacek,

> 
> What is the current status of RFC 47?

Pending. IMHO the per-dataset block cache vs global block cache looks good. 
I'm less convinced by the attempts to provide even limited multi-threaded 
access to a same GDALDataset object.

> Is per dataset caching going to make it to GDAL 2.0?

No, not that we are now in beta phase.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jacek.tomaka at hexagongeospatial.com  Thu May  7 05:20:42 2015
From: jacek.tomaka at hexagongeospatial.com (Tomaka, Jacek)
Date: Thu, 7 May 2015 12:20:42 +0000
Subject: [gdal-dev] RFC 47 Status.
In-Reply-To: <201505071405.27991.even.rouault@spatialys.com>
References: <3ED562F633B1AE46BF141E903F981307585746DC@ap-mbx3.ingrnet.com>
	<201505071405.27991.even.rouault@spatialys.com>
Message-ID: <3ED562F633B1AE46BF141E903F9813075857471E@ap-mbx3.ingrnet.com>

Even, 

I am not sure I understand what you are saying about 2.0 beta. Does it mean that it is too late for inclusion or it did not make it to the beta but can still make it to 2.0?
Given that the functionality is enabled by setting GDAL_DATASET_CACHING=YES it should not be too destabilizing?

I agree that per-dataset block cache is huge improvement. Especially in scenarios when different threads are reading different files/datasets. 

If there is chance for it to still be included in 2.0 please let me know what needs to be done to make it happen.  

Regards.
Jacek Tomaka

-----Original Message-----
From: Even Rouault [mailto:even.rouault at spatialys.com] 
Sent: Thursday, 7 May 2015 8:05 PM
To: gdal-dev at lists.osgeo.org
Cc: Tomaka, Jacek
Subject: Re: [gdal-dev] RFC 47 Status.

Jacek,

> 
> What is the current status of RFC 47?

Pending. IMHO the per-dataset block cache vs global block cache looks good. 
I'm less convinced by the attempts to provide even limited multi-threaded access to a same GDALDataset object.

> Is per dataset caching going to make it to GDAL 2.0?

No, not that we are now in beta phase.

Even

--
Spatialys - Geospatial professional services http://www.spatialys.com


From pavol.hnila at fu-berlin.de  Thu May  7 05:29:31 2015
From: pavol.hnila at fu-berlin.de (Pavol Hnila)
Date: Thu, 07 May 2015 14:29:31 +0200
Subject: [gdal-dev] Problems with MySQL queries in GDAL
In-Reply-To: <201505071223.11769.even.rouault@spatialys.com>
References: <554A095F.10400@fu-berlin.de>
	<201505061854.14914.even.rouault@spatialys.com>
	<554B38EB.6050305@fu-berlin.de>
	<201505071223.11769.even.rouault@spatialys.com>
Message-ID: <554B5AAB.9090009@fu-berlin.de>

> Note that you can specify a tables=a_table;another_table option in the mysql 
> connection string that will restrict the number of tables visible&queried to 
> the ones you specify

Works like charm for the performance... This might be the solution, if
implemented in QGIS. I will present the topic in the QGIS-developer
mailing list.

Many thanks Even,
Pavol

From even.rouault at spatialys.com  Thu May  7 05:45:23 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 7 May 2015 14:45:23 +0200
Subject: [gdal-dev] RFC 47 Status.
In-Reply-To: <3ED562F633B1AE46BF141E903F9813075857471E@ap-mbx3.ingrnet.com>
References: <3ED562F633B1AE46BF141E903F981307585746DC@ap-mbx3.ingrnet.com>
	<201505071405.27991.even.rouault@spatialys.com>
	<3ED562F633B1AE46BF141E903F9813075857471E@ap-mbx3.ingrnet.com>
Message-ID: <201505071445.23293.even.rouault@spatialys.com>

Le jeudi 07 mai 2015 14:20:42, Tomaka, Jacek a ?crit :
> Even,
> 
> I am not sure I understand what you are saying about 2.0 beta. Does it mean
> that it is too late for inclusion or it did not make it to the beta but
> can still make it to 2.0?

Now that we are in beta, I wouldn't normally expect new RFCs to be implemented 
for 2.0 final that are not already in the beta.

> Given that the functionality is enabled by
> setting GDAL_DATASET_CACHING=YES it should not be too destabilizing?

It still implies changing core classes. Anyway, the implementation isn't ready 
enough (2 different implementations, no tests etc...) and the RFC not finalized 
to expose the final solution. Somehow, for me, it goes a bit too far currently 
and should be rectricted only on adding the possibility of a per-dataset block 
cache. Further work on multithreaded access to a same dataset should be the 
subject of another RFC.

> 
> I agree that per-dataset block cache is huge improvement. Especially in
> scenarios when different threads are reading different files/datasets.
> 
> If there is chance for it to still be included in 2.0 please let me know
> what needs to be done to make it happen.

Well, someone would need to champion it & very quickly. But I don't see a 
compelling reason to absolutely put it in GDAL 2.0. I'd note I've done subtle 
improvements related to the scope of the mutex of the block cache (e.g. no 
longer making it a recursive mutex, but a regular one) during the 2.0 cycle 
that already reduce lock contention in some use cases (see slide 39 of 
https://docs.google.com/presentation/d/1kHOoZfnqcWCR1S3I49RWoddG2tGxCXxXkjSjANJ2Gh0/pub?start=false&loop=false&delayms=3000#slide=id.g7b40ab322_227 
). Further work like RFC 47 could go into 2.1

As far as I'm concerned, I'll revisit in the coming weeks (for 2.1) another 
older RFC in the same area of raster blocks 
(https://trac.osgeo.org/gdal/wiki/rfc26_blockcache, to deal with WMS/WMTS 
datasets that have dimensions nearing 1 billion x 1 billion pixels and thus a 
huge block address space), but that's a bit orthogonal to the per-dataset vs 
global block cache.

Even

> 
> Regards.
> Jacek Tomaka
> 
> -----Original Message-----
> From: Even Rouault [mailto:even.rouault at spatialys.com]
> Sent: Thursday, 7 May 2015 8:05 PM
> To: gdal-dev at lists.osgeo.org
> Cc: Tomaka, Jacek
> Subject: Re: [gdal-dev] RFC 47 Status.
> 
> Jacek,
> 
> > What is the current status of RFC 47?
> 
> Pending. IMHO the per-dataset block cache vs global block cache looks good.
> I'm less convinced by the attempts to provide even limited multi-threaded
> access to a same GDALDataset object.
> 
> > Is per dataset caching going to make it to GDAL 2.0?
> 
> No, not that we are now in beta phase.
> 
> Even
> 
> --
> Spatialys - Geospatial professional services http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jacek.tomaka at hexagongeospatial.com  Thu May  7 06:13:51 2015
From: jacek.tomaka at hexagongeospatial.com (Tomaka, Jacek)
Date: Thu, 7 May 2015 13:13:51 +0000
Subject: [gdal-dev] RFC 47 Status.
In-Reply-To: <201505071445.23293.even.rouault@spatialys.com>
References: <3ED562F633B1AE46BF141E903F981307585746DC@ap-mbx3.ingrnet.com>
	<201505071405.27991.even.rouault@spatialys.com>
	<3ED562F633B1AE46BF141E903F9813075857471E@ap-mbx3.ingrnet.com>
	<201505071445.23293.even.rouault@spatialys.com>
Message-ID: <3ED562F633B1AE46BF141E903F981307585747AF@ap-mbx3.ingrnet.com>

Even, 

That makes sense to me. 
I will try to test your mutexing changes to see if it improves our use cases. Maybe your locking improvements will solve all the problems we are seeing. 
Out of curiosity, the second value test on the slide, was it with sleep of 125 ms in case of contention?

Regards.
Jacek Tomaka


-----Original Message-----
From: Even Rouault [mailto:even.rouault at spatialys.com] 
Sent: Thursday, 7 May 2015 8:45 PM
To: Tomaka, Jacek
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] RFC 47 Status.

Le jeudi 07 mai 2015 14:20:42, Tomaka, Jacek a ?crit :
> Even,
> 
> I am not sure I understand what you are saying about 2.0 beta. Does it 
> mean that it is too late for inclusion or it did not make it to the 
> beta but can still make it to 2.0?

Now that we are in beta, I wouldn't normally expect new RFCs to be implemented for 2.0 final that are not already in the beta.

> Given that the functionality is enabled by setting 
> GDAL_DATASET_CACHING=YES it should not be too destabilizing?

It still implies changing core classes. Anyway, the implementation isn't ready enough (2 different implementations, no tests etc...) and the RFC not finalized to expose the final solution. Somehow, for me, it goes a bit too far currently and should be rectricted only on adding the possibility of a per-dataset block cache. Further work on multithreaded access to a same dataset should be the subject of another RFC.

> 
> I agree that per-dataset block cache is huge improvement. Especially 
> in scenarios when different threads are reading different files/datasets.
> 
> If there is chance for it to still be included in 2.0 please let me 
> know what needs to be done to make it happen.

Well, someone would need to champion it & very quickly. But I don't see a compelling reason to absolutely put it in GDAL 2.0. I'd note I've done subtle improvements related to the scope of the mutex of the block cache (e.g. no longer making it a recursive mutex, but a regular one) during the 2.0 cycle that already reduce lock contention in some use cases (see slide 39 of
https://docs.google.com/presentation/d/1kHOoZfnqcWCR1S3I49RWoddG2tGxCXxXkjSjANJ2Gh0/pub?start=false&loop=false&delayms=3000#slide=id.g7b40ab322_227
). Further work like RFC 47 could go into 2.1

As far as I'm concerned, I'll revisit in the coming weeks (for 2.1) another older RFC in the same area of raster blocks (https://trac.osgeo.org/gdal/wiki/rfc26_blockcache, to deal with WMS/WMTS datasets that have dimensions nearing 1 billion x 1 billion pixels and thus a huge block address space), but that's a bit orthogonal to the per-dataset vs global block cache.

Even

> 
> Regards.
> Jacek Tomaka
> 
> -----Original Message-----
> From: Even Rouault [mailto:even.rouault at spatialys.com]
> Sent: Thursday, 7 May 2015 8:05 PM
> To: gdal-dev at lists.osgeo.org
> Cc: Tomaka, Jacek
> Subject: Re: [gdal-dev] RFC 47 Status.
> 
> Jacek,
> 
> > What is the current status of RFC 47?
> 
> Pending. IMHO the per-dataset block cache vs global block cache looks good.
> I'm less convinced by the attempts to provide even limited multi-threaded
> access to a same GDALDataset object.
> 
> > Is per dataset caching going to make it to GDAL 2.0?
> 
> No, not that we are now in beta phase.
> 
> Even
> 
> --
> Spatialys - Geospatial professional services http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com


From even.rouault at spatialys.com  Thu May  7 06:20:19 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 7 May 2015 15:20:19 +0200
Subject: [gdal-dev] RFC 47 Status.
In-Reply-To: <3ED562F633B1AE46BF141E903F981307585747AF@ap-mbx3.ingrnet.com>
References: <3ED562F633B1AE46BF141E903F981307585746DC@ap-mbx3.ingrnet.com>
	<201505071445.23293.even.rouault@spatialys.com>
	<3ED562F633B1AE46BF141E903F981307585747AF@ap-mbx3.ingrnet.com>
Message-ID: <201505071520.19645.even.rouault@spatialys.com>

Le jeudi 07 mai 2015 15:13:51, Tomaka, Jacek a ?crit :
> Even,
> 
> That makes sense to me.
> I will try to test your mutexing changes to see if it improves our use
> cases. Maybe your locking improvements will solve all the problems we are
> seeing. Out of curiosity, the second value test on the slide, was it with
> sleep of 125 ms in case of contention?

I was wondering why you mention 125 ms, but a grep shows that there's such a 
delay in the Windows implementation of CPLAcquireMutex() when the critical 
section fails to be acquired, so I guess you must think to that ?
Well, the tests in my slides have only be done on Linux where there's no such 
sleep (just rely on pthread implementation).

> 
> Regards.
> Jacek Tomaka
> 
> 
> -----Original Message-----
> From: Even Rouault [mailto:even.rouault at spatialys.com]
> Sent: Thursday, 7 May 2015 8:45 PM
> To: Tomaka, Jacek
> Cc: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] RFC 47 Status.
> 
> Le jeudi 07 mai 2015 14:20:42, Tomaka, Jacek a ?crit :
> > Even,
> > 
> > I am not sure I understand what you are saying about 2.0 beta. Does it
> > mean that it is too late for inclusion or it did not make it to the
> > beta but can still make it to 2.0?
> 
> Now that we are in beta, I wouldn't normally expect new RFCs to be
> implemented for 2.0 final that are not already in the beta.
> 
> > Given that the functionality is enabled by setting
> > GDAL_DATASET_CACHING=YES it should not be too destabilizing?
> 
> It still implies changing core classes. Anyway, the implementation isn't
> ready enough (2 different implementations, no tests etc...) and the RFC
> not finalized to expose the final solution. Somehow, for me, it goes a bit
> too far currently and should be rectricted only on adding the possibility
> of a per-dataset block cache. Further work on multithreaded access to a
> same dataset should be the subject of another RFC.
> 
> > I agree that per-dataset block cache is huge improvement. Especially
> > in scenarios when different threads are reading different files/datasets.
> > 
> > If there is chance for it to still be included in 2.0 please let me
> > know what needs to be done to make it happen.
> 
> Well, someone would need to champion it & very quickly. But I don't see a
> compelling reason to absolutely put it in GDAL 2.0. I'd note I've done
> subtle improvements related to the scope of the mutex of the block cache
> (e.g. no longer making it a recursive mutex, but a regular one) during the
> 2.0 cycle that already reduce lock contention in some use cases (see slide
> 39 of
> https://docs.google.com/presentation/d/1kHOoZfnqcWCR1S3I49RWoddG2tGxCXxXkj
> SjANJ2Gh0/pub?start=false&loop=false&delayms=3000#slide=id.g7b40ab322_227
> ). Further work like RFC 47 could go into 2.1
> 
> As far as I'm concerned, I'll revisit in the coming weeks (for 2.1) another
> older RFC in the same area of raster blocks
> (https://trac.osgeo.org/gdal/wiki/rfc26_blockcache, to deal with WMS/WMTS
> datasets that have dimensions nearing 1 billion x 1 billion pixels and
> thus a huge block address space), but that's a bit orthogonal to the
> per-dataset vs global block cache.
> 
> Even
> 
> > Regards.
> > Jacek Tomaka
> > 
> > -----Original Message-----
> > From: Even Rouault [mailto:even.rouault at spatialys.com]
> > Sent: Thursday, 7 May 2015 8:05 PM
> > To: gdal-dev at lists.osgeo.org
> > Cc: Tomaka, Jacek
> > Subject: Re: [gdal-dev] RFC 47 Status.
> > 
> > Jacek,
> > 
> > > What is the current status of RFC 47?
> > 
> > Pending. IMHO the per-dataset block cache vs global block cache looks
> > good. I'm less convinced by the attempts to provide even limited
> > multi-threaded access to a same GDALDataset object.
> > 
> > > Is per dataset caching going to make it to GDAL 2.0?
> > 
> > No, not that we are now in beta phase.
> > 
> > Even
> > 
> > --
> > Spatialys - Geospatial professional services http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jacek.tomaka at hexagongeospatial.com  Thu May  7 08:18:34 2015
From: jacek.tomaka at hexagongeospatial.com (Tomaka, Jacek)
Date: Thu, 7 May 2015 15:18:34 +0000
Subject: [gdal-dev] RFC 47 Status.
In-Reply-To: <201505071520.19645.even.rouault@spatialys.com>
References: <3ED562F633B1AE46BF141E903F981307585746DC@ap-mbx3.ingrnet.com>
	<201505071445.23293.even.rouault@spatialys.com>
	<3ED562F633B1AE46BF141E903F981307585747AF@ap-mbx3.ingrnet.com>
	<201505071520.19645.even.rouault@spatialys.com>
Message-ID: <3ED562F633B1AE46BF141E903F98130758574875@ap-mbx3.ingrnet.com>

>I was wondering why you mention 125 ms, but a grep shows that there's such a delay in the Windows implementation of CPLAcquireMutex() when the critical section fails to be acquired, so I guess you >must think to that ?

Yes. I would not have come up with such a number myself ;) It is not prime ;) 

>Well, the tests in my slides have only be done on Linux where there's no such sleep (just rely on pthread implementation).

That is not a good news for Windows. But I will test it... 

Regards.
Jacek Tomaka

-----Original Message-----
From: Even Rouault [mailto:even.rouault at spatialys.com] 
Sent: Thursday, 7 May 2015 9:20 PM
To: Tomaka, Jacek
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] RFC 47 Status.

Le jeudi 07 mai 2015 15:13:51, Tomaka, Jacek a ?crit :
> Even,
> 
> That makes sense to me.
> I will try to test your mutexing changes to see if it improves our use 
> cases. Maybe your locking improvements will solve all the problems we 
> are seeing. Out of curiosity, the second value test on the slide, was 
> it with sleep of 125 ms in case of contention?

I was wondering why you mention 125 ms, but a grep shows that there's such a delay in the Windows implementation of CPLAcquireMutex() when the critical section fails to be acquired, so I guess you must think to that ?
Well, the tests in my slides have only be done on Linux where there's no such sleep (just rely on pthread implementation).

> 
> Regards.
> Jacek Tomaka
> 
> 
> -----Original Message-----
> From: Even Rouault [mailto:even.rouault at spatialys.com]
> Sent: Thursday, 7 May 2015 8:45 PM
> To: Tomaka, Jacek
> Cc: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] RFC 47 Status.
> 
> Le jeudi 07 mai 2015 14:20:42, Tomaka, Jacek a ?crit :
> > Even,
> > 
> > I am not sure I understand what you are saying about 2.0 beta. Does it
> > mean that it is too late for inclusion or it did not make it to the
> > beta but can still make it to 2.0?
> 
> Now that we are in beta, I wouldn't normally expect new RFCs to be
> implemented for 2.0 final that are not already in the beta.
> 
> > Given that the functionality is enabled by setting
> > GDAL_DATASET_CACHING=YES it should not be too destabilizing?
> 
> It still implies changing core classes. Anyway, the implementation isn't
> ready enough (2 different implementations, no tests etc...) and the RFC
> not finalized to expose the final solution. Somehow, for me, it goes a bit
> too far currently and should be rectricted only on adding the possibility
> of a per-dataset block cache. Further work on multithreaded access to a
> same dataset should be the subject of another RFC.
> 
> > I agree that per-dataset block cache is huge improvement. Especially
> > in scenarios when different threads are reading different files/datasets.
> > 
> > If there is chance for it to still be included in 2.0 please let me
> > know what needs to be done to make it happen.
> 
> Well, someone would need to champion it & very quickly. But I don't see a
> compelling reason to absolutely put it in GDAL 2.0. I'd note I've done
> subtle improvements related to the scope of the mutex of the block cache
> (e.g. no longer making it a recursive mutex, but a regular one) during the
> 2.0 cycle that already reduce lock contention in some use cases (see slide
> 39 of
> https://docs.google.com/presentation/d/1kHOoZfnqcWCR1S3I49RWoddG2tGxCXxXkj
> SjANJ2Gh0/pub?start=false&loop=false&delayms=3000#slide=id.g7b40ab322_227
> ). Further work like RFC 47 could go into 2.1
> 
> As far as I'm concerned, I'll revisit in the coming weeks (for 2.1) another
> older RFC in the same area of raster blocks
> (https://trac.osgeo.org/gdal/wiki/rfc26_blockcache, to deal with WMS/WMTS
> datasets that have dimensions nearing 1 billion x 1 billion pixels and
> thus a huge block address space), but that's a bit orthogonal to the
> per-dataset vs global block cache.
> 
> Even
> 
> > Regards.
> > Jacek Tomaka
> > 
> > -----Original Message-----
> > From: Even Rouault [mailto:even.rouault at spatialys.com]
> > Sent: Thursday, 7 May 2015 8:05 PM
> > To: gdal-dev at lists.osgeo.org
> > Cc: Tomaka, Jacek
> > Subject: Re: [gdal-dev] RFC 47 Status.
> > 
> > Jacek,
> > 
> > > What is the current status of RFC 47?
> > 
> > Pending. IMHO the per-dataset block cache vs global block cache looks
> > good. I'm less convinced by the attempts to provide even limited
> > multi-threaded access to a same GDALDataset object.
> > 
> > > Is per dataset caching going to make it to GDAL 2.0?
> > 
> > No, not that we are now in beta phase.
> > 
> > Even
> > 
> > --
> > Spatialys - Geospatial professional services http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com


From even.rouault at spatialys.com  Thu May  7 08:26:42 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 7 May 2015 17:26:42 +0200
Subject: [gdal-dev] RFC 47 Status.
In-Reply-To: <3ED562F633B1AE46BF141E903F98130758574875@ap-mbx3.ingrnet.com>
References: <3ED562F633B1AE46BF141E903F981307585746DC@ap-mbx3.ingrnet.com>
	<201505071520.19645.even.rouault@spatialys.com>
	<3ED562F633B1AE46BF141E903F98130758574875@ap-mbx3.ingrnet.com>
Message-ID: <201505071726.43046.even.rouault@spatialys.com>

Le jeudi 07 mai 2015 17:18:34, Tomaka, Jacek a ?crit :
> >I was wondering why you mention 125 ms, but a grep shows that there's such
> >a delay in the Windows implementation of CPLAcquireMutex() when the
> >critical section fails to be acquired, so I guess you >must think to that
> >?
> 
> Yes. I would not have come up with such a number myself ;) It is not prime
> ;)
> 
> >Well, the tests in my slides have only be done on Linux where there's no
> >such sleep (just rely on pthread implementation).
> 
> That is not a good news for Windows. But I will test it...

The changes done should logically not degrade performance on Windows, and 
hopefully improve it a bit. Your feedback is welcome.

> 
> Regards.
> Jacek Tomaka
> 
> -----Original Message-----
> From: Even Rouault [mailto:even.rouault at spatialys.com]
> Sent: Thursday, 7 May 2015 9:20 PM
> To: Tomaka, Jacek
> Cc: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] RFC 47 Status.
> 
> Le jeudi 07 mai 2015 15:13:51, Tomaka, Jacek a ?crit :
> > Even,
> > 
> > That makes sense to me.
> > I will try to test your mutexing changes to see if it improves our use
> > cases. Maybe your locking improvements will solve all the problems we
> > are seeing. Out of curiosity, the second value test on the slide, was
> > it with sleep of 125 ms in case of contention?
> 
> I was wondering why you mention 125 ms, but a grep shows that there's such
> a delay in the Windows implementation of CPLAcquireMutex() when the
> critical section fails to be acquired, so I guess you must think to that ?
> Well, the tests in my slides have only be done on Linux where there's no
> such sleep (just rely on pthread implementation).
> 
> > Regards.
> > Jacek Tomaka
> > 
> > 
> > -----Original Message-----
> > From: Even Rouault [mailto:even.rouault at spatialys.com]
> > Sent: Thursday, 7 May 2015 8:45 PM
> > To: Tomaka, Jacek
> > Cc: gdal-dev at lists.osgeo.org
> > Subject: Re: [gdal-dev] RFC 47 Status.
> > 
> > Le jeudi 07 mai 2015 14:20:42, Tomaka, Jacek a ?crit :
> > > Even,
> > > 
> > > I am not sure I understand what you are saying about 2.0 beta. Does it
> > > mean that it is too late for inclusion or it did not make it to the
> > > beta but can still make it to 2.0?
> > 
> > Now that we are in beta, I wouldn't normally expect new RFCs to be
> > implemented for 2.0 final that are not already in the beta.
> > 
> > > Given that the functionality is enabled by setting
> > > GDAL_DATASET_CACHING=YES it should not be too destabilizing?
> > 
> > It still implies changing core classes. Anyway, the implementation isn't
> > ready enough (2 different implementations, no tests etc...) and the RFC
> > not finalized to expose the final solution. Somehow, for me, it goes a
> > bit too far currently and should be rectricted only on adding the
> > possibility of a per-dataset block cache. Further work on multithreaded
> > access to a same dataset should be the subject of another RFC.
> > 
> > > I agree that per-dataset block cache is huge improvement. Especially
> > > in scenarios when different threads are reading different
> > > files/datasets.
> > > 
> > > If there is chance for it to still be included in 2.0 please let me
> > > know what needs to be done to make it happen.
> > 
> > Well, someone would need to champion it & very quickly. But I don't see a
> > compelling reason to absolutely put it in GDAL 2.0. I'd note I've done
> > subtle improvements related to the scope of the mutex of the block cache
> > (e.g. no longer making it a recursive mutex, but a regular one) during
> > the 2.0 cycle that already reduce lock contention in some use cases (see
> > slide 39 of
> > https://docs.google.com/presentation/d/1kHOoZfnqcWCR1S3I49RWoddG2tGxCXxXk
> > j
> > SjANJ2Gh0/pub?start=false&loop=false&delayms=3000#slide=id.g7b40ab322_22
> > 7 ). Further work like RFC 47 could go into 2.1
> > 
> > As far as I'm concerned, I'll revisit in the coming weeks (for 2.1)
> > another older RFC in the same area of raster blocks
> > (https://trac.osgeo.org/gdal/wiki/rfc26_blockcache, to deal with WMS/WMTS
> > datasets that have dimensions nearing 1 billion x 1 billion pixels and
> > thus a huge block address space), but that's a bit orthogonal to the
> > per-dataset vs global block cache.
> > 
> > Even
> > 
> > > Regards.
> > > Jacek Tomaka
> > > 
> > > -----Original Message-----
> > > From: Even Rouault [mailto:even.rouault at spatialys.com]
> > > Sent: Thursday, 7 May 2015 8:05 PM
> > > To: gdal-dev at lists.osgeo.org
> > > Cc: Tomaka, Jacek
> > > Subject: Re: [gdal-dev] RFC 47 Status.
> > > 
> > > Jacek,
> > > 
> > > > What is the current status of RFC 47?
> > > 
> > > Pending. IMHO the per-dataset block cache vs global block cache looks
> > > good. I'm less convinced by the attempts to provide even limited
> > > multi-threaded access to a same GDALDataset object.
> > > 
> > > > Is per dataset caching going to make it to GDAL 2.0?
> > > 
> > > No, not that we are now in beta phase.
> > > 
> > > Even
> > > 
> > > --
> > > Spatialys - Geospatial professional services http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From sfkeller at gmail.com  Thu May  7 11:27:03 2015
From: sfkeller at gmail.com (Stefan Keller)
Date: Thu, 7 May 2015 20:27:03 +0200
Subject: [gdal-dev] GDAL overrite file error
In-Reply-To: <201502061106.36172.even.rouault@spatialys.com>
References: <CAHMfM_fjSmgsAFqtOj_mZc1HC9D=JdiEj6MckDkJ4S5BmzrfMQ@mail.gmail.com>
	<201502061106.36172.even.rouault@spatialys.com>
Message-ID: <CAFcOn293044osX4008-Nk4VPK-gLMQHvd1Kf6BxiGS=XXC5X6A@mail.gmail.com>

Hi,

Regarding overwrite:
I think the "-overwrite" parameter in ogr2ogr commandline tool does not work.
I tried it with drivers like "ESRI Shapefile", GeoJSON and others
without success.
ogr2ogr always exits and reports
"ERROR 6: The GeoJSON driver does not overwrite existing files."
Why should drivers not be able to overwrite?
Is'nt deleting files common task for all drivers (meaning to be
handled outside the actual writer drivers)?

-S.




2015-02-06 11:06 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:
> Le vendredi 06 f?vrier 2015 10:42:04, Carlos Piury a ?crit :
>> Hi, I am trying to create a vector format (i.e. ESRI Shapefile) from laser
>> file (.las), and it works fine, but when I try to overwrite the file I get
>> the following error:
>>
>> ERROR 1: Layer 'output' already exists
>
> --> The message is hopefully clear enough and comes from the implementation of
> CreateLayer() in the shape file driver. You have to destroy the files of the
> shapefile first if they exists. You can use DeleteDataSource() for that.
>
>> terminate called after throwing an instance of 'std::runtime_error'
>>   what():  output layer creation failed
>> Aborted (core dumped)
>
> Does this come from inside GDAL code or you own code ? Looks like from yours,
> if you transform GDAL errors into C++ exceptions.
>
>>
>> I am using the next code to create the layer:
>>
>> OGRSFDriverH formatTranslateDriver =
>> OGRGetDriverByName(argFormat->sval[0]);
>>
>> OGRDataSourceH dataset = OGR_Dr_CreateDataSource(formatTranslateDriver,
>> argOutput->sval[0], 0);
>>
>> OGRLayerH layer = OGR_DS_CreateLayer(dataset, layerName.c_str(), 0,
>> wkbPoint25D, 0);
>>
>> Any idea about this error?
>>
>> Thanks.
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at spatialys.com  Thu May  7 11:56:33 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 7 May 2015 20:56:33 +0200
Subject: [gdal-dev] GDAL overrite file error
In-Reply-To: <CAFcOn293044osX4008-Nk4VPK-gLMQHvd1Kf6BxiGS=XXC5X6A@mail.gmail.com>
References: <CAHMfM_fjSmgsAFqtOj_mZc1HC9D=JdiEj6MckDkJ4S5BmzrfMQ@mail.gmail.com>
	<201502061106.36172.even.rouault@spatialys.com>
	<CAFcOn293044osX4008-Nk4VPK-gLMQHvd1Kf6BxiGS=XXC5X6A@mail.gmail.com>
Message-ID: <201505072056.33174.even.rouault@spatialys.com>

Le jeudi 07 mai 2015 20:27:03, Stefan Keller a ?crit :
> Hi,
> 
> Regarding overwrite:
> I think the "-overwrite" parameter in ogr2ogr commandline tool does not
> work. I tried it with drivers like "ESRI Shapefile", GeoJSON and others
> without success.
> ogr2ogr always exits and reports
> "ERROR 6: The GeoJSON driver does not overwrite existing files."
> Why should drivers not be able to overwrite?

-overwrite causes an existing layer to be deleted before being recreated, for 
drivers that support the DeleteLayer() API.
It does not cause an existing dataset to be destroyed however (which would be 
calling DeleteDataSource(), which isn't implemented by all drivers either), 
which is the issue you must have with the geojson driver.
For shapefiles, that works in my testing however.
I know this is a bit user unfriendly: nothing fundamentally impossible to 
improve here, just historic behaviour.

> Is'nt deleting files common task for all drivers (meaning to be
> handled outside the actual writer drivers)?

Implementation of DeleteLayer() is driver specific code, since only drivers 
know which files (when files are involve. Think to a PostGIS table) are related 
to a layer.

> 
> -S.
> 
> 2015-02-06 11:06 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:
> > Le vendredi 06 f?vrier 2015 10:42:04, Carlos Piury a ?crit :
> >> Hi, I am trying to create a vector format (i.e. ESRI Shapefile) from
> >> laser file (.las), and it works fine, but when I try to overwrite the
> >> file I get the following error:
> >> 
> >> ERROR 1: Layer 'output' already exists
> > 
> > --> The message is hopefully clear enough and comes from the
> > implementation of CreateLayer() in the shape file driver. You have to
> > destroy the files of the shapefile first if they exists. You can use
> > DeleteDataSource() for that.
> > 
> >> terminate called after throwing an instance of 'std::runtime_error'
> >> 
> >>   what():  output layer creation failed
> >> 
> >> Aborted (core dumped)
> > 
> > Does this come from inside GDAL code or you own code ? Looks like from
> > yours, if you transform GDAL errors into C++ exceptions.
> > 
> >> I am using the next code to create the layer:
> >> 
> >> OGRSFDriverH formatTranslateDriver =
> >> OGRGetDriverByName(argFormat->sval[0]);
> >> 
> >> OGRDataSourceH dataset = OGR_Dr_CreateDataSource(formatTranslateDriver,
> >> argOutput->sval[0], 0);
> >> 
> >> OGRLayerH layer = OGR_DS_CreateLayer(dataset, layerName.c_str(), 0,
> >> wkbPoint25D, 0);
> >> 
> >> Any idea about this error?
> >> 
> >> Thanks.
> > 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From sfkeller at gmail.com  Thu May  7 12:53:19 2015
From: sfkeller at gmail.com (Stefan Keller)
Date: Thu, 7 May 2015 21:53:19 +0200
Subject: [gdal-dev] GDAL overrite file error
In-Reply-To: <201505072056.33174.even.rouault@spatialys.com>
References: <CAHMfM_fjSmgsAFqtOj_mZc1HC9D=JdiEj6MckDkJ4S5BmzrfMQ@mail.gmail.com>
	<201502061106.36172.even.rouault@spatialys.com>
	<CAFcOn293044osX4008-Nk4VPK-gLMQHvd1Kf6BxiGS=XXC5X6A@mail.gmail.com>
	<201505072056.33174.even.rouault@spatialys.com>
Message-ID: <CAFcOn29Zpfyd7dMRTSg7gVpmTpr1UBhOWv+rnnC57BCOGh9fUw@mail.gmail.com>

Hi Even (and Peter)

Thanks for your quick answers! I actually referred to file related
read/write formats.
I tested some of them, if they support overwriting (I think this is
not always documented in the docs).

I fact, following support the -overwrite option (in alphabetical
order): GPKG, Mapinfo File, ESRI Shapefil, SQLite

Following don't: CSV, DXF, GeoJSON, GeoRSS, GML, GPX, Interlis 2, KML,
PDF and Spatialite (as SQLite w/ -dsco SPATIALITE=yes)

Cheers, Stefan

P.S. Interlis 1 crashes currently :-< Pirmin is working on it and I
hope his patch will make it int the next release before code freeze.


2015-05-07 20:56 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
> Le jeudi 07 mai 2015 20:27:03, Stefan Keller a ?crit :
>> Hi,
>>
>> Regarding overwrite:
>> I think the "-overwrite" parameter in ogr2ogr commandline tool does not
>> work. I tried it with drivers like "ESRI Shapefile", GeoJSON and others
>> without success.
>> ogr2ogr always exits and reports
>> "ERROR 6: The GeoJSON driver does not overwrite existing files."
>> Why should drivers not be able to overwrite?
>
> -overwrite causes an existing layer to be deleted before being recreated, for
> drivers that support the DeleteLayer() API.
> It does not cause an existing dataset to be destroyed however (which would be
> calling DeleteDataSource(), which isn't implemented by all drivers either),
> which is the issue you must have with the geojson driver.
> For shapefiles, that works in my testing however.
> I know this is a bit user unfriendly: nothing fundamentally impossible to
> improve here, just historic behaviour.
>
>> Is'nt deleting files common task for all drivers (meaning to be
>> handled outside the actual writer drivers)?
>
> Implementation of DeleteLayer() is driver specific code, since only drivers
> know which files (when files are involve. Think to a PostGIS table) are related
> to a layer.
>
>>
>> -S.
>>
>> 2015-02-06 11:06 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:
>> > Le vendredi 06 f?vrier 2015 10:42:04, Carlos Piury a ?crit :
>> >> Hi, I am trying to create a vector format (i.e. ESRI Shapefile) from
>> >> laser file (.las), and it works fine, but when I try to overwrite the
>> >> file I get the following error:
>> >>
>> >> ERROR 1: Layer 'output' already exists
>> >
>> > --> The message is hopefully clear enough and comes from the
>> > implementation of CreateLayer() in the shape file driver. You have to
>> > destroy the files of the shapefile first if they exists. You can use
>> > DeleteDataSource() for that.
>> >
>> >> terminate called after throwing an instance of 'std::runtime_error'
>> >>
>> >>   what():  output layer creation failed
>> >>
>> >> Aborted (core dumped)
>> >
>> > Does this come from inside GDAL code or you own code ? Looks like from
>> > yours, if you transform GDAL errors into C++ exceptions.
>> >
>> >> I am using the next code to create the layer:
>> >>
>> >> OGRSFDriverH formatTranslateDriver =
>> >> OGRGetDriverByName(argFormat->sval[0]);
>> >>
>> >> OGRDataSourceH dataset = OGR_Dr_CreateDataSource(formatTranslateDriver,
>> >> argOutput->sval[0], 0);
>> >>
>> >> OGRLayerH layer = OGR_DS_CreateLayer(dataset, layerName.c_str(), 0,
>> >> wkbPoint25D, 0);
>> >>
>> >> Any idea about this error?
>> >>
>> >> Thanks.
>> >
>> > --
>> > Spatialys - Geospatial professional services
>> > http://www.spatialys.com
>> > _______________________________________________
>> > gdal-dev mailing list
>> > gdal-dev at lists.osgeo.org
>> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com

From even.rouault at spatialys.com  Thu May  7 13:15:27 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 7 May 2015 22:15:27 +0200
Subject: [gdal-dev] GDAL overrite file error
In-Reply-To: <CAFcOn29Zpfyd7dMRTSg7gVpmTpr1UBhOWv+rnnC57BCOGh9fUw@mail.gmail.com>
References: <CAHMfM_fjSmgsAFqtOj_mZc1HC9D=JdiEj6MckDkJ4S5BmzrfMQ@mail.gmail.com>
	<201505072056.33174.even.rouault@spatialys.com>
	<CAFcOn29Zpfyd7dMRTSg7gVpmTpr1UBhOWv+rnnC57BCOGh9fUw@mail.gmail.com>
Message-ID: <201505072215.27244.even.rouault@spatialys.com>

Le jeudi 07 mai 2015 21:53:19, Stefan Keller a ?crit :
> Hi Even (and Peter)
> 
> Thanks for your quick answers! I actually referred to file related
> read/write formats.
> I tested some of them, if they support overwriting (I think this is
> not always documented in the docs).
> 
> I fact, following support the -overwrite option (in alphabetical
> order): GPKG, Mapinfo File, ESRI Shapefil, SQLite
> 
> Following don't: CSV, DXF, GeoJSON, GeoRSS, GML, GPX, Interlis 2, KML,
> PDF and

Yes expected, none of them support DeleteLayer()

> Spatialite (as SQLite w/ -dsco SPATIALITE=yes)

Strange : could you provide a reproducable way for this ?

The following works for me :
rm poly.sqlite
ogr2ogr -f sqlite poly.sqlite poly.shp -dsco spatialite=yes
ogr2ogr poly.sqlite poly.shp -overwrite

> 
> Cheers, Stefan
> 
> P.S. Interlis 1 crashes currently :-< Pirmin is working on it and I
> hope his patch will make it int the next release before code freeze.

OK, there's no ticket for that ?

> 
> 2015-05-07 20:56 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
> > Le jeudi 07 mai 2015 20:27:03, Stefan Keller a ?crit :
> >> Hi,
> >> 
> >> Regarding overwrite:
> >> I think the "-overwrite" parameter in ogr2ogr commandline tool does not
> >> work. I tried it with drivers like "ESRI Shapefile", GeoJSON and others
> >> without success.
> >> ogr2ogr always exits and reports
> >> "ERROR 6: The GeoJSON driver does not overwrite existing files."
> >> Why should drivers not be able to overwrite?
> > 
> > -overwrite causes an existing layer to be deleted before being recreated,
> > for drivers that support the DeleteLayer() API.
> > It does not cause an existing dataset to be destroyed however (which
> > would be calling DeleteDataSource(), which isn't implemented by all
> > drivers either), which is the issue you must have with the geojson
> > driver.
> > For shapefiles, that works in my testing however.
> > I know this is a bit user unfriendly: nothing fundamentally impossible to
> > improve here, just historic behaviour.
> > 
> >> Is'nt deleting files common task for all drivers (meaning to be
> >> handled outside the actual writer drivers)?
> > 
> > Implementation of DeleteLayer() is driver specific code, since only
> > drivers know which files (when files are involve. Think to a PostGIS
> > table) are related to a layer.
> > 
> >> -S.
> >> 
> >> 2015-02-06 11:06 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:
> >> > Le vendredi 06 f?vrier 2015 10:42:04, Carlos Piury a ?crit :
> >> >> Hi, I am trying to create a vector format (i.e. ESRI Shapefile) from
> >> >> laser file (.las), and it works fine, but when I try to overwrite the
> >> >> file I get the following error:
> >> >> 
> >> >> ERROR 1: Layer 'output' already exists
> >> > 
> >> > --> The message is hopefully clear enough and comes from the
> >> > implementation of CreateLayer() in the shape file driver. You have to
> >> > destroy the files of the shapefile first if they exists. You can use
> >> > DeleteDataSource() for that.
> >> > 
> >> >> terminate called after throwing an instance of 'std::runtime_error'
> >> >> 
> >> >>   what():  output layer creation failed
> >> >> 
> >> >> Aborted (core dumped)
> >> > 
> >> > Does this come from inside GDAL code or you own code ? Looks like from
> >> > yours, if you transform GDAL errors into C++ exceptions.
> >> > 
> >> >> I am using the next code to create the layer:
> >> >> 
> >> >> OGRSFDriverH formatTranslateDriver =
> >> >> OGRGetDriverByName(argFormat->sval[0]);
> >> >> 
> >> >> OGRDataSourceH dataset =
> >> >> OGR_Dr_CreateDataSource(formatTranslateDriver, argOutput->sval[0],
> >> >> 0);
> >> >> 
> >> >> OGRLayerH layer = OGR_DS_CreateLayer(dataset, layerName.c_str(), 0,
> >> >> wkbPoint25D, 0);
> >> >> 
> >> >> Any idea about this error?
> >> >> 
> >> >> Thanks.
> >> > 
> >> > --
> >> > Spatialys - Geospatial professional services
> >> > http://www.spatialys.com
> >> > _______________________________________________
> >> > gdal-dev mailing list
> >> > gdal-dev at lists.osgeo.org
> >> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu May  7 13:19:37 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 7 May 2015 22:19:37 +0200
Subject: [gdal-dev] GDAL overrite file error
In-Reply-To: <201505072215.27244.even.rouault@spatialys.com>
References: <CAHMfM_fjSmgsAFqtOj_mZc1HC9D=JdiEj6MckDkJ4S5BmzrfMQ@mail.gmail.com>
	<CAFcOn29Zpfyd7dMRTSg7gVpmTpr1UBhOWv+rnnC57BCOGh9fUw@mail.gmail.com>
	<201505072215.27244.even.rouault@spatialys.com>
Message-ID: <201505072219.38026.even.rouault@spatialys.com>

Le jeudi 07 mai 2015 22:15:27, Even Rouault a ?crit :
> Le jeudi 07 mai 2015 21:53:19, Stefan Keller a ?crit :
> > Hi Even (and Peter)
> > 
> > Thanks for your quick answers! I actually referred to file related
> > read/write formats.
> > I tested some of them, if they support overwriting (I think this is
> > not always documented in the docs).
> > 
> > I fact, following support the -overwrite option (in alphabetical
> > order): GPKG, Mapinfo File, ESRI Shapefil, SQLite
> > 
> > Following don't: CSV, DXF, GeoJSON, GeoRSS, GML, GPX, Interlis 2, KML,
> > PDF and
> 
> Yes expected, none of them support DeleteLayer()

Actually, small correction: CSV does implement DeleteLayer(), but only when 
the filename is directory that contains only .csv file, and not the .csv file 
itself.
> 
> > Spatialite (as SQLite w/ -dsco SPATIALITE=yes)
> 
> Strange : could you provide a reproducable way for this ?
> 
> The following works for me :
> rm poly.sqlite
> ogr2ogr -f sqlite poly.sqlite poly.shp -dsco spatialite=yes
> ogr2ogr poly.sqlite poly.shp -overwrite
> 
> > Cheers, Stefan
> > 
> > P.S. Interlis 1 crashes currently :-< Pirmin is working on it and I
> > hope his patch will make it int the next release before code freeze.
> 
> OK, there's no ticket for that ?
> 
> > 2015-05-07 20:56 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
> > > Le jeudi 07 mai 2015 20:27:03, Stefan Keller a ?crit :
> > >> Hi,
> > >> 
> > >> Regarding overwrite:
> > >> I think the "-overwrite" parameter in ogr2ogr commandline tool does
> > >> not work. I tried it with drivers like "ESRI Shapefile", GeoJSON and
> > >> others without success.
> > >> ogr2ogr always exits and reports
> > >> "ERROR 6: The GeoJSON driver does not overwrite existing files."
> > >> Why should drivers not be able to overwrite?
> > > 
> > > -overwrite causes an existing layer to be deleted before being
> > > recreated, for drivers that support the DeleteLayer() API.
> > > It does not cause an existing dataset to be destroyed however (which
> > > would be calling DeleteDataSource(), which isn't implemented by all
> > > drivers either), which is the issue you must have with the geojson
> > > driver.
> > > For shapefiles, that works in my testing however.
> > > I know this is a bit user unfriendly: nothing fundamentally impossible
> > > to improve here, just historic behaviour.
> > > 
> > >> Is'nt deleting files common task for all drivers (meaning to be
> > >> handled outside the actual writer drivers)?
> > > 
> > > Implementation of DeleteLayer() is driver specific code, since only
> > > drivers know which files (when files are involve. Think to a PostGIS
> > > table) are related to a layer.
> > > 
> > >> -S.
> > >> 
> > >> 2015-02-06 11:06 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:
> > >> > Le vendredi 06 f?vrier 2015 10:42:04, Carlos Piury a ?crit :
> > >> >> Hi, I am trying to create a vector format (i.e. ESRI Shapefile)
> > >> >> from laser file (.las), and it works fine, but when I try to
> > >> >> overwrite the file I get the following error:
> > >> >> 
> > >> >> ERROR 1: Layer 'output' already exists
> > >> > 
> > >> > --> The message is hopefully clear enough and comes from the
> > >> > implementation of CreateLayer() in the shape file driver. You have
> > >> > to destroy the files of the shapefile first if they exists. You can
> > >> > use DeleteDataSource() for that.
> > >> > 
> > >> >> terminate called after throwing an instance of 'std::runtime_error'
> > >> >> 
> > >> >>   what():  output layer creation failed
> > >> >> 
> > >> >> Aborted (core dumped)
> > >> > 
> > >> > Does this come from inside GDAL code or you own code ? Looks like
> > >> > from yours, if you transform GDAL errors into C++ exceptions.
> > >> > 
> > >> >> I am using the next code to create the layer:
> > >> >> 
> > >> >> OGRSFDriverH formatTranslateDriver =
> > >> >> OGRGetDriverByName(argFormat->sval[0]);
> > >> >> 
> > >> >> OGRDataSourceH dataset =
> > >> >> OGR_Dr_CreateDataSource(formatTranslateDriver, argOutput->sval[0],
> > >> >> 0);
> > >> >> 
> > >> >> OGRLayerH layer = OGR_DS_CreateLayer(dataset, layerName.c_str(), 0,
> > >> >> wkbPoint25D, 0);
> > >> >> 
> > >> >> Any idea about this error?
> > >> >> 
> > >> >> Thanks.
> > >> > 
> > >> > --
> > >> > Spatialys - Geospatial professional services
> > >> > http://www.spatialys.com
> > >> > _______________________________________________
> > >> > gdal-dev mailing list
> > >> > gdal-dev at lists.osgeo.org
> > >> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > > 
> > > --
> > > Spatialys - Geospatial professional services
> > > http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From sfkeller at gmail.com  Thu May  7 13:34:55 2015
From: sfkeller at gmail.com (Stefan Keller)
Date: Thu, 7 May 2015 22:34:55 +0200
Subject: [gdal-dev] GDAL overrite file error
In-Reply-To: <201505072215.27244.even.rouault@spatialys.com>
References: <CAHMfM_fjSmgsAFqtOj_mZc1HC9D=JdiEj6MckDkJ4S5BmzrfMQ@mail.gmail.com>
	<201505072056.33174.even.rouault@spatialys.com>
	<CAFcOn29Zpfyd7dMRTSg7gVpmTpr1UBhOWv+rnnC57BCOGh9fUw@mail.gmail.com>
	<201505072215.27244.even.rouault@spatialys.com>
Message-ID: <CAFcOn2-NnZGGipoqQ_uX2vr9MiDHYuHpwwySrg1JAzjdtFkA9Q@mail.gmail.com>

2015-05-07 22:15 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
>> Spatialite (as SQLite w/ -dsco SPATIALITE=yes)
>
> Strange : could you provide a reproducable way for this ?
>
> The following works for me :
> rm poly.sqlite
> ogr2ogr -f sqlite poly.sqlite poly.shp -dsco spatialite=yes
> ogr2ogr poly.sqlite poly.shp -overwrite

You're right again.
I repeated (unnecessarily) the dataset creation (-dsco) option in the
second statement with overwrite:
rm poly.sqlite
ogr2ogr -f sqlite poly.sqlite poly.shp -dsco spatialite=yes
ogr2ogr poly.sqlite poly.shp -overwrite -dsco spatialite=yes

-S.


2015-05-07 22:15 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
> Le jeudi 07 mai 2015 21:53:19, Stefan Keller a ?crit :
>> Hi Even (and Peter)
>>
>> Thanks for your quick answers! I actually referred to file related
>> read/write formats.
>> I tested some of them, if they support overwriting (I think this is
>> not always documented in the docs).
>>
>> I fact, following support the -overwrite option (in alphabetical
>> order): GPKG, Mapinfo File, ESRI Shapefil, SQLite
>>
>> Following don't: CSV, DXF, GeoJSON, GeoRSS, GML, GPX, Interlis 2, KML,
>> PDF and
>
> Yes expected, none of them support DeleteLayer()
>
>> Spatialite (as SQLite w/ -dsco SPATIALITE=yes)
>
> Strange : could you provide a reproducable way for this ?
>
> The following works for me :
> rm poly.sqlite
> ogr2ogr -f sqlite poly.sqlite poly.shp -dsco spatialite=yes
> ogr2ogr poly.sqlite poly.shp -overwrite
>
>>
>> Cheers, Stefan
>>
>> P.S. Interlis 1 crashes currently :-< Pirmin is working on it and I
>> hope his patch will make it int the next release before code freeze.
>
> OK, there's no ticket for that ?
>
>>
>> 2015-05-07 20:56 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
>> > Le jeudi 07 mai 2015 20:27:03, Stefan Keller a ?crit :
>> >> Hi,
>> >>
>> >> Regarding overwrite:
>> >> I think the "-overwrite" parameter in ogr2ogr commandline tool does not
>> >> work. I tried it with drivers like "ESRI Shapefile", GeoJSON and others
>> >> without success.
>> >> ogr2ogr always exits and reports
>> >> "ERROR 6: The GeoJSON driver does not overwrite existing files."
>> >> Why should drivers not be able to overwrite?
>> >
>> > -overwrite causes an existing layer to be deleted before being recreated,
>> > for drivers that support the DeleteLayer() API.
>> > It does not cause an existing dataset to be destroyed however (which
>> > would be calling DeleteDataSource(), which isn't implemented by all
>> > drivers either), which is the issue you must have with the geojson
>> > driver.
>> > For shapefiles, that works in my testing however.
>> > I know this is a bit user unfriendly: nothing fundamentally impossible to
>> > improve here, just historic behaviour.
>> >
>> >> Is'nt deleting files common task for all drivers (meaning to be
>> >> handled outside the actual writer drivers)?
>> >
>> > Implementation of DeleteLayer() is driver specific code, since only
>> > drivers know which files (when files are involve. Think to a PostGIS
>> > table) are related to a layer.
>> >
>> >> -S.
>> >>
>> >> 2015-02-06 11:06 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:
>> >> > Le vendredi 06 f?vrier 2015 10:42:04, Carlos Piury a ?crit :
>> >> >> Hi, I am trying to create a vector format (i.e. ESRI Shapefile) from
>> >> >> laser file (.las), and it works fine, but when I try to overwrite the
>> >> >> file I get the following error:
>> >> >>
>> >> >> ERROR 1: Layer 'output' already exists
>> >> >
>> >> > --> The message is hopefully clear enough and comes from the
>> >> > implementation of CreateLayer() in the shape file driver. You have to
>> >> > destroy the files of the shapefile first if they exists. You can use
>> >> > DeleteDataSource() for that.
>> >> >
>> >> >> terminate called after throwing an instance of 'std::runtime_error'
>> >> >>
>> >> >>   what():  output layer creation failed
>> >> >>
>> >> >> Aborted (core dumped)
>> >> >
>> >> > Does this come from inside GDAL code or you own code ? Looks like from
>> >> > yours, if you transform GDAL errors into C++ exceptions.
>> >> >
>> >> >> I am using the next code to create the layer:
>> >> >>
>> >> >> OGRSFDriverH formatTranslateDriver =
>> >> >> OGRGetDriverByName(argFormat->sval[0]);
>> >> >>
>> >> >> OGRDataSourceH dataset =
>> >> >> OGR_Dr_CreateDataSource(formatTranslateDriver, argOutput->sval[0],
>> >> >> 0);
>> >> >>
>> >> >> OGRLayerH layer = OGR_DS_CreateLayer(dataset, layerName.c_str(), 0,
>> >> >> wkbPoint25D, 0);
>> >> >>
>> >> >> Any idea about this error?
>> >> >>
>> >> >> Thanks.
>> >> >
>> >> > --
>> >> > Spatialys - Geospatial professional services
>> >> > http://www.spatialys.com
>> >> > _______________________________________________
>> >> > gdal-dev mailing list
>> >> > gdal-dev at lists.osgeo.org
>> >> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>> >
>> > --
>> > Spatialys - Geospatial professional services
>> > http://www.spatialys.com
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com

From brodzik at nsidc.org  Fri May  8 16:09:24 2015
From: brodzik at nsidc.org (Mary Jo Brodzik)
Date: Fri, 8 May 2015 17:09:24 -0600 (MDT)
Subject: [gdal-dev] Requesting gdal update to at least EPSG v8.6
In-Reply-To: <201505061817.18652.even.rouault@spatialys.com>
References: <alpine.OSX.1.10.1505060912560.15657@nsidc-worsley.ad.int.nsidc.org>
	<201505061748.34409.even.rouault@spatialys.com>
	<alpine.OSX.1.10.1505060949360.15657@nsidc-worsley.ad.int.nsidc.org>
	<201505061817.18652.even.rouault@spatialys.com>
Message-ID: <alpine.OSX.2.11.1505081704440.5095@nsidc-macice.local>


Hi, Even,

The directions for doing the update are way beyond my abilities. Is there 
someone who can help produce the update?

I'm glad I can manually update the machine that I'm working with, but this 
doesn't help the community of users who will be trying to read the data 
that we are producing.  Many of them are intimidated by gdal tools, so 
when I tell them how easy it will be for them to use gdal I'd really like 
to give them the new epsg codes, instead of proj.4 strings.

Mary Jo

On Wed, 6 May 2015, Even Rouault wrote:

> Date: Wed, 6 May 2015 18:17:18 +0200
> From: Even Rouault <even.rouault at spatialys.com>
> To: Mary Jo Brodzik <brodzik at nsidc.org>
> Cc: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] Requesting gdal update to at least EPSG v8.6
> 
> Le mercredi 06 mai 2015 18:01:59, Mary Jo Brodzik a ?crit :
>> Bonjour, Even,  Merci for the quick response!
>>
>> Unfortunately, I don't think v8.5 is good enough.  I worked with Roger
>> Lott late last year, and he made several corrections, including:
>>
>> 1) New projection Conversion codes 6928, 6929, 6930
>> 2) New ProjectedCRS codes 6931, 6932 and 6933
>
> They aren't yet in the version that was imported.
>
> I'm moderately enthusiastic about redoing a new sync with latest EPSG database
> for just 3 codes, unless there's a strong demand from the community. You can
> workaround by manually adding in epsg.wkt the WKT definitions (old-style) of
> the PCS you're interested into.
>
> If anyone is willing to do the update, the procedure is described here :
> http://trac.osgeo.org/geotiff/browser/trunk/libgeotiff/csv/README
>
>
>> 3) Changed the state of deprecated codes 3973, 3974, 3975 to "Invalid"
>> because they were incorrect
>> 4) Edited descriptions for 3408, 3409 and 3410 to indicate they are
>> now superceded.
>>
>> Roger did indicate that he had some of these in a patch release of EPSG
>> v.8.5.4, but that there were still some names and metadata that were
>>
>> incorrect in 8.5.4 that were correctly released in v8.6.  From Roger:
>>> As far as the projection and CRS definitions are concerned everything is
>>> already OK in v8.5.4 in that coordinate conversions using CRSs 6931-33
>>> will be correctly implemented. It is only metadata (projection [but not
>>> CRS] names and projection and CRS remarks) that will change. As soon as
>>> we publish v8.6, v8.5.4 will no longer be available and the metadata you
>>> consider wrong will be lost to posterity.
>>
>> Mary Jo
>>
>> On Wed, 6 May 2015, Even Rouault wrote:
>>> Date: Wed, 6 May 2015 17:48:34 +0200
>>> From: Even Rouault <even.rouault at spatialys.com>
>>> To: Mary Jo Brodzik <brodzik at nsidc.org>
>>> Cc: gdal-dev at lists.osgeo.org
>>> Subject: Re: [gdal-dev] Requesting gdal update to at least EPSG v8.6
>>>
>>> Le mercredi 06 mai 2015 17:24:57, vous avez ?crit :
>>>> Hello,
>>>>
>>>> I would like to request that gdal be updated to use the latest EPSG
>>>> codes.
>>>>
>>>> I worked with EPSG last year to correct some obsolete ProjectedCRS
>>>> definitions for some products I am developing, and I understand that the
>>>> corrected definitions were included in EPSG v8.6, released in Nov 2014.
>>>>
>>>> I am unsure how to actually confirm the EPSG version included with gdal,
>>>> but I did find this trac ticket (http://trac.osgeo.org/gdal/ticket/5462)
>>>> that looks like you upgraded to epsg v8.4 in May 2014.
>>>
>>> Mary,
>>>
>>> GDAL 2.0 (currently in beta1) has been upgraded to EPSG v8.5. Isn't that
>>> good enough ? Which EPSG codes are you interested in ?
>>>
>>> Even
>>>
>>>> The EPSG web site at www.epsg-registry.org seems to indicate the latest
>>>> version may be 8.7.  I don't know what is new.  For my purposes and to
>>>> let my users know, v8.6 or better is what I need.
>>>>
>>>> Thank you,
>>>> Mary Jo Brodzik
>>>>
>>>> ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
>>>> Mary Jo Brodzik, Senior Associate Scientist, 303-492-8263
>>>> NSIDC/CIRES, Univ. of Colo. at Boulder, 449 UCB, Boulder, CO 80309-0449
>>>> ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev at lists.osgeo.org
>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>> ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
>> Mary Jo Brodzik, Senior Associate Scientist, 303-492-8263
>> NSIDC/CIRES, Univ. of Colo. at Boulder, 449 UCB, Boulder, CO 80309-0449
>> ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
>
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Mary Jo Brodzik, Senior Associate Scientist, 303-492-8263
NSIDC/CIRES, Univ. of Colo. at Boulder, 449 UCB, Boulder, CO 80309-0449
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

From jukka.rahkonen at maanmittauslaitos.fi  Sat May  9 02:28:46 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Sat, 9 May 2015 09:28:46 +0000 (UTC)
Subject: [gdal-dev] New OGC standard about WKT for projections
Message-ID: <loom.20150509T112104-165@post.gmane.org>

Hi,

There seems to be a new OGC (and ISO) standard "Geographic information -
Well-known text representation of coordinate reference systems"

http://docs.opengeospatial.org/is/12-063r5/12-063r5.html

-Jukka Rahkonen-


From even.rouault at spatialys.com  Sat May  9 08:38:02 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 09 May 2015 17:38:02 +0200
Subject: [gdal-dev] New OGC standard about WKT for projections
In-Reply-To: <loom.20150509T112104-165@post.gmane.org>
References: <loom.20150509T112104-165@post.gmane.org>
Message-ID: <1431185882.554e29dad3f88@imp.free.fr>

Quoting Jukka Rahkonen <jukka.rahkonen at maanmittauslaitos.fi>:

> Hi,
>
> There seems to be a new OGC (and ISO) standard "Geographic information -
> Well-known text representation of coordinate reference systems"
>
> http://docs.opengeospatial.org/is/12-063r5/12-063r5.html

On a quick look, one thing that struck me is that there will no longer be any
direct equivalent of TOWGS84. AFAIU, the BOUNDCRS concept which can embrace the
concept of TOWGS84 through a Coordinate Frame method is to be used when the
transform to the TARGETCRS has already been done and document what was the
SOURCRS and the transformation applied. There's also the COORDINATEOPERATION
which can contain more or less same information but this doesn't describe a CRS
itself.

We'll see how it will be adopted. Was considered for GeoPackage at a time AFAIR,
but they switch backed to old WKT spec, the new one not being ready.

>
> -Jukka Rahkonen-
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From sunil.vankadara at hexagongeospatial.com  Mon May 11 01:05:43 2015
From: sunil.vankadara at hexagongeospatial.com (Vankadara, Sunil)
Date: Mon, 11 May 2015 08:05:43 +0000
Subject: [gdal-dev] Regarding DPI in Geospatial PDF
Message-ID: <3ED2AF5FA67CF548BC5C06A608D7D405243025A1@IN-MBX2.ingrnet.com>

Hi Team,

I have created two PDF file with default DPI and 600 values using gdal_translate application.
Unfortunately I couldn't find any difference among these two created files like file size, pixel size etc.

The input file details are
Input file type: Erdas . img file
Width of the image: 11938
Height of the image:: 14184
Datatype: UINT 8
No of Bands: 3

May I know the reason for not showing up the difference in created outputs?

Regards
Sunil


From jukka.rahkonen at maanmittauslaitos.fi  Mon May 11 02:50:39 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Mon, 11 May 2015 09:50:39 +0000 (UTC)
Subject: [gdal-dev] Regarding DPI in Geospatial PDF
References: <3ED2AF5FA67CF548BC5C06A608D7D405243025A1@IN-MBX2.ingrnet.com>
Message-ID: <loom.20150511T111320-178@post.gmane.org>

Vankadara, Sunil <sunil.vankadara <at> hexagongeospatial.com> writes:

> 
> Hi Team,
> 
> I have created two PDF file with default DPI and 600 values using
gdal_translate application.
> Unfortunately I couldn't find any difference among these two created files
like file size, pixel size etc.
> 
> The input file details are
> Input file type: Erdas . img file
> Width of the image: 11938
> Height of the image:: 14184
> Datatype: UINT 8
> No of Bands: 3
> 
> May I know the reason for not showing up the difference in created outputs?
> 
> Regards
> Sunil
> 

Hi,

It may be that DPI setting at the moment does not have a totally desired
effect. It would feel natural that increasing DPI from the default value 72
into a bigger value like 300 would make the page size of the PDF smaller
expressed as physical units like millimeters.

The DPI setting is not supposed to affect the image itself so the PDF file
size will be the same as well as the image quality so no up/downsampling
will occur.

You can read some background from http://trac.osgeo.org/gdal/ticket/5412. In
older PDF versions there was an absolute limit that page could not be bigger
than 14000 units and the unit size was fixed to 1/72 inch. This limitation
can be overridden in later PDF versions by using a UserUnit.

Create some sample PDF files with gdal_translate and you can see how the
user unit behaves by opening the PDF file with a text editor and having a
look at row 4 in the file.

Without -co DPI

<< /Annots 6 0 R /Contents 4 0 R /MediaBox [ 0 0 1728 1977 ] /Parent 1 0 R
/Resources 5 0 R /Type /Page /UserUnit 1 >>

With -co DPI=300

<< /Annots 6 0 R /Contents 4 0 R /MediaBox [ 0 0 414.72000000000008
474.48000000000008 ] /Parent 1 0 R /Resources 5 0 R /Type /Page /UserUnit
4.1666666666666661 >>

With -co DPI=600 

<< /Annots 6 0 R /Contents 4 0 R /MediaBox [ 0 0 207.36000000000004
237.24000000000004 ] /Parent 1 0 R /Resources 5 0 R /Type /Page /UserUnit
8.3333333333333321 >>


The image box sixe comes from (MediaBox size) x (UserUnit size) and remains
the same in all three cases because GDAL is adjusting both the MediaBox and
UserUnit hand in hand.

It could be that GDAL should not touch to the size of the MediaBox if it
does not exceed 14400 in either dimension.

-Jukka Rahkonen-


From stefan.ziegler.de at gmail.com  Mon May 11 02:52:44 2015
From: stefan.ziegler.de at gmail.com (Stefan Ziegler)
Date: Mon, 11 May 2015 11:52:44 +0200
Subject: [gdal-dev] Erdas Imagine .img vs. GeoTIFF
Message-ID: <CAJvo+19b6v-2EewkKWHkthQ8yeq0+WQsG7STkQLxyfeb0SYuBw@mail.gmail.com>

Hi

we have some Worldview 3 files in Erdas Imagine format. Are there any
advantages over GeoTIFF in daily business (or general)? Of course it
depends what daily business means... e.g. using derived products(RGB or
false color images) in a desktop gis application or in a wms.

best regards
Stefan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150511/de8e4d34/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Mon May 11 03:15:25 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Mon, 11 May 2015 10:15:25 +0000 (UTC)
Subject: [gdal-dev] Regarding DPI in Geospatial PDF
References: <3ED2AF5FA67CF548BC5C06A608D7D405243025A1@IN-MBX2.ingrnet.com>
	<loom.20150511T111320-178@post.gmane.org>
Message-ID: <loom.20150511T115636-755@post.gmane.org>

Jukka Rahkonen <jukka.rahkonen <at> maanmittauslaitos.fi> writes:

 
> It could be that GDAL should not touch to the size of the MediaBox if it
> does not exceed 14400 in either dimension.

Sorry, this was at least unclear or nonsense. What I meant to say was that
perhaps GDAL should handle the MediaBox size and UserUnits in such a way
that using higher DPI value would make image to print smaller on paper. I
think that by keeping the MediaBox and using UserUnit<1 the result would be
a smaller image but I am not sure it PDF behaves that way.

The current behaviour of GDAL keeps the physical image size intact despite
of DPI and that is the right thing to do when MediaBox would otherwise
exceed the 14400 unit limit. I hope my thinking is correct now.

-Jukka-


From lucadeluge at gmail.com  Mon May 11 06:20:48 2015
From: lucadeluge at gmail.com (Luca Delucchi)
Date: Mon, 11 May 2015 15:20:48 +0200
Subject: [gdal-dev] create GeospatialPDF using Python
In-Reply-To: <loom.20150421T105507-28@post.gmane.org>
References: <CAK4m-3zzzZNve0qj4gGd6fQjqmnNHSfp49S6apjvwHq9fsnTFA@mail.gmail.com>
	<201504171327.02879.even.rouault@spatialys.com>
	<CAK4m-3wuw85WvTUq7k-c+_SvtDsW_G=9B9eQ6hfnQ4HarsaebQ@mail.gmail.com>
	<201504171512.59927.even.rouault@spatialys.com>
	<CAK4m-3yZp2q04E42krneW7dRCHvpjvt-wOCGH2n+f3K2h=zTEA@mail.gmail.com>
	<loom.20150421T105507-28@post.gmane.org>
Message-ID: <CAK4m-3wfnnLi7fDTykgxf_inWp14yGgYjntm+N7NRgO2PkhRJw@mail.gmail.com>

On 21 April 2015 at 11:00, Jukka Rahkonen
<jukka.rahkonen at maanmittauslaitos.fi> wrote:

>
> Hi,
>

Hi,

> I would say "Yes, it may be a bug". If you would like to get a better answer
> you should show us a simple way to reproduce. In this case I think that an
> OGR_STYLE string with your gdal_translate command would be the minimum but
> even nicer would be to get also the raster and your faulty result file to
> compare with.
>

Sorry the late answer, data are here [0] (about 30MB) and this is the
gdal_translate command

gdal_translate -of PDF raster.pdf combine.pdf -co OGR_DATASOURCE=vector.pdf

> -Jukka Rahkonen-
>

[0] http://geodati.fmach.it/gfoss_geodata/test_pdf.zip


-- 
ciao
Luca

http://gis.cri.fmach.it/delucchi/
www.lucadelu.org

From lucadeluge at gmail.com  Mon May 11 06:42:12 2015
From: lucadeluge at gmail.com (Luca Delucchi)
Date: Mon, 11 May 2015 15:42:12 +0200
Subject: [gdal-dev] EXTRA_IMAGES in geospatialPDF
Message-ID: <CAK4m-3wn_VHnazEvNMDKuXqUAehzkUhmkuNUHpyak8WvakZTxQ@mail.gmail.com>

Hi devs,

I'm not understanding how to set the x and y values of EXTRA_IMAGES
specially when I use only vectors.

With raster I could get the dimension of the output geospatialPDF from
the input raster, but with vector I have no idea.

I tried using the coordinates of the bounding box of my layer, but it
didn't work.

Someone has some idea?

-- 
ciao
Luca

http://gis.cri.fmach.it/delucchi/
www.lucadelu.org

From jukka.rahkonen at maanmittauslaitos.fi  Mon May 11 06:52:05 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Mon, 11 May 2015 13:52:05 +0000 (UTC)
Subject: [gdal-dev] =?utf-8?q?EXTRA=5FIMAGES_in_geospatialPDF?=
References: <CAK4m-3wn_VHnazEvNMDKuXqUAehzkUhmkuNUHpyak8WvakZTxQ@mail.gmail.com>
Message-ID: <loom.20150511T154835-887@post.gmane.org>

Luca Delucchi <lucadeluge <at> gmail.com> writes:

> 
> Hi devs,
> 
> I'm not understanding how to set the x and y values of EXTRA_IMAGES
> specially when I use only vectors.
> 
> With raster I could get the dimension of the output geospatialPDF from
> the input raster, but with vector I have no idea.
> 
> I tried using the coordinates of the bounding box of my layer, but it
> didn't work.
> 
> Someone has some idea?

Yes, coordinates are image pixels and the anchor point is at the lower left
corner of the PDF page. From a still mostly valid document 
http://latuviitta.org/documents/Geospatial_PDF_maps_from_OSM_with_GDAL.pdf

"A comma separated list of entries, each with parameters
?image_name,x-offset,y-offset,scale_factor?.  Offset values are used for
giving the PDF image pixel where the bottom left  
corner of the extra image will be placed.  Respectively, offsets are count
from the bottom left corner
ot the PDF file. Parameter value ?file.png,0,0,1? will place the extra image
in the original scale into 
the lower left corner of the PDF file."

-Jukka Rahkonen-

From andre.vautour at caris.com  Mon May 11 07:50:41 2015
From: andre.vautour at caris.com (Andre Vautour)
Date: Mon, 11 May 2015 11:50:41 -0300
Subject: [gdal-dev] New OGC standard about WKT for projections
In-Reply-To: <1431185882.554e29dad3f88@imp.free.fr>
References: <loom.20150509T112104-165@post.gmane.org>
	<1431185882.554e29dad3f88@imp.free.fr>
Message-ID: <5550C1C1.9080803@caris.com>

The way I see it, the new spec does clear up some big holes like:

 1. Being able to specify an unambiguous operation/projection method (by
    identifier) for projections instead of loosely relying on the
    projection's name (9.3.3)
 2. Knowing the units of projection parameters (9.3.4)

On 2015-05-09 12:38, Even Rouault wrote:
> Quoting Jukka Rahkonen <jukka.rahkonen at maanmittauslaitos.fi>:
>
>> Hi,
>>
>> There seems to be a new OGC (and ISO) standard "Geographic information -
>> Well-known text representation of coordinate reference systems"
>>
>> http://docs.opengeospatial.org/is/12-063r5/12-063r5.html
> On a quick look, one thing that struck me is that there will no longer be any
> direct equivalent of TOWGS84.
The differences between the older WKT spec and the one currently 
implemented by GDAL are explained in Annex C. For TOWGS84 specifically, 
see C 3.3.3.

The transformation is not part of the coordinate reference system in 
both the EPSG registry and the ISO 19111 specification. What was weird 
with the older WKT spec is that you could have an identified CRS that 
had TOWGS84 specified, even though that definition is technically not 
part of the identified object. That being said, for a lot of practical 
applications, the transformation is essential, so it'll be interesting 
to see how it all plays out.

> 18.1 Bound CRS
> The definition of a CRS is not dependent upon any relationship to an 
> independent CRS. However in an implementation that merges datasets 
> referenced to differing CRSs, it is sometimes useful to associate the 
> definition of the transformation that has been used with the CRS 
> definition.
>   AFAIU, the BOUNDCRS concept which can embrace the
> concept of TOWGS84 through a Coordinate Frame method is to be used when the
> transform to the TARGETCRS has already been done and document what was the
> SOURCRS and the transformation applied.
Even, I'm not sure if I completely understood that last part. It's 
entirely possible that what follows is what you were trying to say. If 
that is the case, fell free to just ignore me. :)

The way I understand the BOUNDCRS concept is that it binds a 
transformation to a given CRS. That is, even though the transformation 
is not part of the CRS, you can use that construct to associate the 
transformation with a CRS (as it was previously done with TOWGS84). So, 
for a TOWGS84 equivalence, you'd have a BOUNDCRS where the source is the 
CRS being defined, the target would be WGS 84, and the operation method 
would be a 7 parameter geocentric transformations with the rotation 
convention (position vector/coordinate frame) explicitly defined.

I for one certainly hope it gets adopted by the industry, as I find 
there is too much ambiguity in the old WKT specification to truly 
achieve interoperability,
Andr?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150511/0b016d7f/attachment-0001.html>

From james.evans.4 at us.af.mil  Mon May 11 11:28:48 2015
From: james.evans.4 at us.af.mil (EVANS, JAMES R GS-13 USAF ACC 84 RADES/SCZE)
Date: Mon, 11 May 2015 18:28:48 +0000
Subject: [gdal-dev] GDAL WorldWind Mini-Drive problem under Windows 2008 R2
	on VM
Message-ID: <20EA793B1BC710448656BDC9BD25C4A12F8AD5BA@52ZHTX-D07-04D.area52.afnoapps.usaf.mil>

Hi,
I was running Mapserver under Windows 7, using the gdal worldwind minidriver to serve up imagery from various tile sets.  I'm trying to migrate to Server 2008 R2.  I don't seem to be able to get the mini driver to work and it looks like a permissions issue.  Any suggestions on how to troubleshoot this would be greatly appreciated.  Here is a log entry from Mapserver showing the failure.  I have given "Everyone" and "DefaultAppPool" Full Control over the C:\Mapdata directory.  
Thanks,
James

Here's what happens in the Mapserver Log:
[Mon May 11 10:36:44 2015].62000 msDrawRasterLayerLow(WAC_2014): entering.
[Mon May 11 10:36:44 2015].62000 msDrawRasterLayerLow(WAC_2014): Filename is: c:\MapData\WAC_2014.xml [Mon May 11 10:36:44 2015].62000 msDrawRasterLayerLow(WAC_2014): Path is: c:\MapData\WAC_2014.xml [Mon May 11 10:36:44 2015].62000 msResampleGDALToMap in effect: cellsize = 0.002197 [Mon May 11 10:36:44 2015].62000 msDrawGDAL(WAC_2014): using RAW_WINDOW=114687 29695 1026 1026, dst=0,0,1026,1026 [Mon May 11 10:36:44 2015].62000 msDrawRasterLayerGDAL(): red,green,blue,alpha bands = 1,2,3,0 [Mon May 11 10:36:44 2015].78000 drawGDAL(): Unable to access file. GDALDatasetRasterIO() failed: GetBlockRef failed at X block offset 223, Y block offset 57 [Mon May 11 10:36:44 2015].78000 msDrawMap(): Image handling error. Failed to draw layer named 'WAC_2014'.
[Mon May 11 10:36:44 2015].78000 freeLayer(): freeing layer at 000000000043D5C0.

From even.rouault at spatialys.com  Mon May 11 15:10:33 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 12 May 2015 00:10:33 +0200
Subject: [gdal-dev] New OGC standard about WKT for projections
In-Reply-To: <5550C1C1.9080803@caris.com>
References: <loom.20150509T112104-165@post.gmane.org>
	<1431185882.554e29dad3f88@imp.free.fr> <5550C1C1.9080803@caris.com>
Message-ID: <1431382233.555128d9366c3@imp.free.fr>

Selon Andre Vautour <andre.vautour at caris.com>:

> The way I see it, the new spec does clear up some big holes like:
>
>  1. Being able to specify an unambiguous operation/projection method (by
>     identifier) for projections instead of loosely relying on the
>     projection's name (9.3.3)
>  2. Knowing the units of projection parameters (9.3.4)

Yes, there are of course interesting improvements. I'm often playing the devil's
adovcate.

>
> The transformation is not part of the coordinate reference system in
> both the EPSG registry and the ISO 19111 specification. What was weird
> with the older WKT spec is that you could have an identified CRS that
> had TOWGS84 specified, even though that definition is technically not
> part of the identified object. That being said, for a lot of practical
> applications, the transformation is essential, so it'll be interesting
> to see how it all plays out.
>
> > 18.1 Bound CRS
> > The definition of a CRS is not dependent upon any relationship to an
> > independent CRS. However in an implementation that merges datasets
> > referenced to differing CRSs, it is sometimes useful to associate the
> > definition of the transformation that has been used with the CRS
> > definition.
> >   AFAIU, the BOUNDCRS concept which can embrace the
> > concept of TOWGS84 through a Coordinate Frame method is to be used when the
> > transform to the TARGETCRS has already been done and document what was the
> > SOURCRS and the transformation applied.
> Even, I'm not sure if I completely understood that last part. It's
> entirely possible that what follows is what you were trying to say. If
> that is the case, fell free to just ignore me. :)
>
> The way I understand the BOUNDCRS concept is that it binds a
> transformation to a given CRS. That is, even though the transformation
> is not part of the CRS, you can use that construct to associate the
> transformation with a CRS (as it was previously done with TOWGS84). So,
> for a TOWGS84 equivalence, you'd have a BOUNDCRS where the source is the
> CRS being defined, the target would be WGS 84, and the operation method
> would be a 7 parameter geocentric transformations with the rotation
> convention (position vector/coordinate frame) explicitly defined.

Hum, apparently I didn't understand the spec the way you explain it (I wouldn't
bet much on the correctness of my interpretation), although I would prefer your
interpretation to mine. My understanding was that if you have a BOUNDCRS the CRS
that would apply would be the TARGETCRS and you would know that the data
originaly was in SOURCECRS (this comes from how I understand the sentence "it is
sometimes useful to associate the definition of the transformation that has been
used with the CRS definition."). But you seem to understand it the other way,
i.e the SOURCECRS would still apply ?

Anyway it doesn't seem likely that most data would come with a BOUNDCRS
expliciting the tranform to be used to go to WGS 84, so that would mean that
GDAL for example would have to query it from its own EPSG database. Actually,
that something we should ideally already do for example with the ESRI WKT of
.prj files, since they do not have TOWG84 nodes.

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Mon May 11 15:27:37 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Mon, 11 May 2015 22:27:37 +0000 (UTC)
Subject: [gdal-dev] create GeospatialPDF using Python
References: <CAK4m-3zzzZNve0qj4gGd6fQjqmnNHSfp49S6apjvwHq9fsnTFA@mail.gmail.com>
	<201504171327.02879.even.rouault@spatialys.com>
	<CAK4m-3wuw85WvTUq7k-c+_SvtDsW_G=9B9eQ6hfnQ4HarsaebQ@mail.gmail.com>
	<201504171512.59927.even.rouault@spatialys.com>
	<CAK4m-3yZp2q04E42krneW7dRCHvpjvt-wOCGH2n+f3K2h=zTEA@mail.gmail.com>
	<loom.20150421T105507-28@post.gmane.org>
	<CAK4m-3wfnnLi7fDTykgxf_inWp14yGgYjntm+N7NRgO2PkhRJw@mail.gmail.com>
Message-ID: <loom.20150512T002427-891@post.gmane.org>

Luca Delucchi <lucadeluge <at> gmail.com> writes:

> 
> On 21 April 2015 at 11:00, Jukka Rahkonen
> <jukka.rahkonen <at> maanmittauslaitos.fi> wrote:
> 
> >
> > Hi,
> >
> 
> Hi,
> 
> > I would say "Yes, it may be a bug". If you would like to get a better answer
> > you should show us a simple way to reproduce. In this case I think that an
> > OGR_STYLE string with your gdal_translate command would be the minimum but
> > even nicer would be to get also the raster and your faulty result file to
> > compare with.
> >
> 
> Sorry the late answer, data are here [0] (about 30MB) and this is the
> gdal_translate command
> 
> gdal_translate -of PDF raster.pdf combine.pdf -co OGR_DATASOURCE=vector.pdf

Hi,

If you test vector.pdf with ogrinfo it shows attributes
OGRFeature(TR):14
  id (Integer) = 16
  Class (String) = MANUFATTI
  cls (Integer) = 4

I would try to save the same OGR_STYLE string that you have used for styling
the polygons also as an attribute into PDF. Perhaps then GDAL could read the
style back and transfer it to the other PDF.

-Jukka Rahkonen-


From even.rouault at spatialys.com  Mon May 11 15:29:33 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 12 May 2015 00:29:33 +0200
Subject: [gdal-dev] Erdas Imagine .img vs. GeoTIFF
In-Reply-To: <CAJvo+19b6v-2EewkKWHkthQ8yeq0+WQsG7STkQLxyfeb0SYuBw@mail.gmail.com>
References: <CAJvo+19b6v-2EewkKWHkthQ8yeq0+WQsG7STkQLxyfeb0SYuBw@mail.gmail.com>
Message-ID: <1431383373.55512d4d82166@imp.free.fr>

Selon Stefan Ziegler <stefan.ziegler.de at gmail.com>:

> Hi
>
> we have some Worldview 3 files in Erdas Imagine format. Are there any
> advantages over GeoTIFF in daily business (or general)? Of course it
> depends what daily business means... e.g. using derived products(RGB or
> false color images) in a desktop gis application or in a wms.

Stefan,

.img has pretty much feature parity with GeoTIFF (tiling, overviews), except
perhaps regarding compression schemes where .img only supports RLE.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From james.evans.4 at us.af.mil  Mon May 11 15:47:43 2015
From: james.evans.4 at us.af.mil (EVANS, JAMES R GS-13 USAF ACC 84 RADES/SCZE)
Date: Mon, 11 May 2015 22:47:43 +0000
Subject: [gdal-dev] GDAL WorldWind Mini-Drive problem under Windows 2008
 R2 on VM
Message-ID: <20EA793B1BC710448656BDC9BD25C4A12F8AD6EF@52ZHTX-D07-04D.area52.afnoapps.usaf.mil>

I did try gdal_translate and it does fail.  Here's what happens at the command prompt:

C:\MapData>gdal_translate -of JPEG -outsize 512 512 land-sea.xml test.jpg
Input file size is 20480, 10240
0ERROR 1: GDALWMS: Unable to download block 0, 0.
  URL: http://localhost/mapserver/content/tile.php?T=Land-Sea&L=0&X=0&Y=4
  HTTP status code: 200, error: (null).
ERROR 1: land-sea.xml, band 1: IReadBlock failed at X offset 0, Y offset 0

GDALINFO works just fine.  I did try running the command prompt as an administrator, with no luck.  I'm not sure how to solve this.  I would think it is a permissions problem, but maybe a missing environment variable or something?  At least I do have a working system at home to help troubleshoot this.  Any help would be appreciated.
Thanks,
James


-----Original Message-----
From: gdal-dev-bounces at lists.osgeo.org [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of EVANS, JAMES R GS-13 USAF ACC 84 RADES/SCZE
Sent: Monday, May 11, 2015 12:29 PM
To: gdal-dev at lists.osgeo.org
Subject: [gdal-dev] GDAL WorldWind Mini-Drive problem under Windows 2008 R2 on VM

Hi,
I was running Mapserver under Windows 7, using the gdal worldwind minidriver to serve up imagery from various tile sets.  I'm trying to migrate to Server 2008 R2.  I don't seem to be able to get the mini driver to work and it looks like a permissions issue.  Any suggestions on how to troubleshoot this would be greatly appreciated.  Here is a log entry from Mapserver showing the failure.  I have given "Everyone" and "DefaultAppPool" Full Control over the C:\Mapdata directory.  
Thanks,
James

Here's what happens in the Mapserver Log:
[Mon May 11 10:36:44 2015].62000 msDrawRasterLayerLow(WAC_2014): entering.
[Mon May 11 10:36:44 2015].62000 msDrawRasterLayerLow(WAC_2014): Filename is: c:\MapData\WAC_2014.xml [Mon May 11 10:36:44 2015].62000 msDrawRasterLayerLow(WAC_2014): Path is: c:\MapData\WAC_2014.xml [Mon May 11 10:36:44 2015].62000 msResampleGDALToMap in effect: cellsize = 0.002197 [Mon May 11 10:36:44 2015].62000 msDrawGDAL(WAC_2014): using RAW_WINDOW=114687 29695 1026 1026, dst=0,0,1026,1026 [Mon May 11 10:36:44 2015].62000 msDrawRasterLayerGDAL(): red,green,blue,alpha bands = 1,2,3,0 [Mon May 11 10:36:44 2015].78000 drawGDAL(): Unable to access file. GDALDatasetRasterIO() failed: GetBlockRef failed at X block offset 223, Y block offset 57 [Mon May 11 10:36:44 2015].78000 msDrawMap(): Image handling error. Failed to draw layer named 'WAC_2014'.
[Mon May 11 10:36:44 2015].78000 freeLayer(): freeing layer at 000000000043D5C0.
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

From lucadeluge at gmail.com  Tue May 12 00:11:57 2015
From: lucadeluge at gmail.com (Luca Delucchi)
Date: Tue, 12 May 2015 09:11:57 +0200
Subject: [gdal-dev] EXTRA_IMAGES in geospatialPDF
In-Reply-To: <loom.20150511T154835-887@post.gmane.org>
References: <CAK4m-3wn_VHnazEvNMDKuXqUAehzkUhmkuNUHpyak8WvakZTxQ@mail.gmail.com>
	<loom.20150511T154835-887@post.gmane.org>
Message-ID: <CAK4m-3zmUO51y3zxoHZUvU3XYEemdpBtB74m8xHkWubQybHnkg@mail.gmail.com>

On 11 May 2015 at 15:52, Jukka Rahkonen
<jukka.rahkonen at maanmittauslaitos.fi> wrote:

>
> Yes, coordinates are image pixels and the anchor point is at the lower left
> corner of the PDF page. From a still mostly valid document
> http://latuviitta.org/documents/Geospatial_PDF_maps_from_OSM_with_GDAL.pdf
>
> "A comma separated list of entries, each with parameters
> ?image_name,x-offset,y-offset,scale_factor?.  Offset values are used for
> giving the PDF image pixel where the bottom left
> corner of the extra image will be placed.  Respectively, offsets are count
> from the bottom left corner
> ot the PDF file. Parameter value ?file.png,0,0,1? will place the extra image
> in the original scale into
> the lower left corner of the PDF file."
>

Yes I understood this (read bot docs and "your" really cool tutorial),
but the problem is how to know the dimension of the output
geospatialPDF. With raster I can know the size's dimension but with
vector no.

Instead if I'm create a vector geospatialPDF I'm not able to set any
EXTRA_IMAGES

> -Jukka Rahkonen-
>

-- 
ciao
Luca

http://gis.cri.fmach.it/delucchi/
www.lucadelu.org

From lucadeluge at gmail.com  Tue May 12 00:19:59 2015
From: lucadeluge at gmail.com (Luca Delucchi)
Date: Tue, 12 May 2015 09:19:59 +0200
Subject: [gdal-dev] create GeospatialPDF using Python
In-Reply-To: <loom.20150512T002427-891@post.gmane.org>
References: <CAK4m-3zzzZNve0qj4gGd6fQjqmnNHSfp49S6apjvwHq9fsnTFA@mail.gmail.com>
	<201504171327.02879.even.rouault@spatialys.com>
	<CAK4m-3wuw85WvTUq7k-c+_SvtDsW_G=9B9eQ6hfnQ4HarsaebQ@mail.gmail.com>
	<201504171512.59927.even.rouault@spatialys.com>
	<CAK4m-3yZp2q04E42krneW7dRCHvpjvt-wOCGH2n+f3K2h=zTEA@mail.gmail.com>
	<loom.20150421T105507-28@post.gmane.org>
	<CAK4m-3wfnnLi7fDTykgxf_inWp14yGgYjntm+N7NRgO2PkhRJw@mail.gmail.com>
	<loom.20150512T002427-891@post.gmane.org>
Message-ID: <CAK4m-3zwJBpSP5w4JvKrvUpxbpEk-S7rHAeqxYgMzE-iYz-ojg@mail.gmail.com>

On 12 May 2015 at 00:27, Jukka Rahkonen
<jukka.rahkonen at maanmittauslaitos.fi> wrote:
> Luca Delucchi <lucadeluge <at> gmail.com> writes:
>
>>
>> On 21 April 2015 at 11:00, Jukka Rahkonen
>> <jukka.rahkonen <at> maanmittauslaitos.fi> wrote:
>>
>> >
>> > Hi,
>> >
>>
>> Hi,
>>
>> > I would say "Yes, it may be a bug". If you would like to get a better answer
>> > you should show us a simple way to reproduce. In this case I think that an
>> > OGR_STYLE string with your gdal_translate command would be the minimum but
>> > even nicer would be to get also the raster and your faulty result file to
>> > compare with.
>> >
>>
>> Sorry the late answer, data are here [0] (about 30MB) and this is the
>> gdal_translate command
>>
>> gdal_translate -of PDF raster.pdf combine.pdf -co OGR_DATASOURCE=vector.pdf
>
> Hi,
>
> If you test vector.pdf with ogrinfo it shows attributes
> OGRFeature(TR):14
>   id (Integer) = 16
>   Class (String) = MANUFATTI
>   cls (Integer) = 4
>
> I would try to save the same OGR_STYLE string that you have used for styling
> the polygons also as an attribute into PDF. Perhaps then GDAL could read the
> style back and transfer it to the other PDF.
>

Ok, I'll try and let you know

> -Jukka Rahkonen-
>


-- 
ciao
Luca

http://gis.cri.fmach.it/delucchi/
www.lucadelu.org

From damian.dixon at gmail.com  Tue May 12 02:17:14 2015
From: damian.dixon at gmail.com (Damian Dixon)
Date: Tue, 12 May 2015 10:17:14 +0100
Subject: [gdal-dev] New OGC standard about WKT for projections
In-Reply-To: <1431382233.555128d9366c3@imp.free.fr>
References: <loom.20150509T112104-165@post.gmane.org>
	<1431185882.554e29dad3f88@imp.free.fr>
	<5550C1C1.9080803@caris.com> <1431382233.555128d9366c3@imp.free.fr>
Message-ID: <CAJjdW1w43uzQX=43ejjnbWGHOUbQroz6X9hpzL5DdJ=f5HJ+iw@mail.gmail.com>

ESRI have open sourced an implementation of a draft of the standard.

The code can be found here:

https://github.com/Esri/ogc-crs-wkt-parser

I don't know how complete this is.



On 11 May 2015 at 23:10, Even Rouault <even.rouault at spatialys.com> wrote:

> Selon Andre Vautour <andre.vautour at caris.com>:
>
> > The way I see it, the new spec does clear up some big holes like:
> >
> >  1. Being able to specify an unambiguous operation/projection method (by
> >     identifier) for projections instead of loosely relying on the
> >     projection's name (9.3.3)
> >  2. Knowing the units of projection parameters (9.3.4)
>
> Yes, there are of course interesting improvements. I'm often playing the
> devil's
> adovcate.
>
> >
> > The transformation is not part of the coordinate reference system in
> > both the EPSG registry and the ISO 19111 specification. What was weird
> > with the older WKT spec is that you could have an identified CRS that
> > had TOWGS84 specified, even though that definition is technically not
> > part of the identified object. That being said, for a lot of practical
> > applications, the transformation is essential, so it'll be interesting
> > to see how it all plays out.
> >
> > > 18.1 Bound CRS
> > > The definition of a CRS is not dependent upon any relationship to an
> > > independent CRS. However in an implementation that merges datasets
> > > referenced to differing CRSs, it is sometimes useful to associate the
> > > definition of the transformation that has been used with the CRS
> > > definition.
> > >   AFAIU, the BOUNDCRS concept which can embrace the
> > > concept of TOWGS84 through a Coordinate Frame method is to be used
> when the
> > > transform to the TARGETCRS has already been done and document what was
> the
> > > SOURCRS and the transformation applied.
> > Even, I'm not sure if I completely understood that last part. It's
> > entirely possible that what follows is what you were trying to say. If
> > that is the case, fell free to just ignore me. :)
> >
> > The way I understand the BOUNDCRS concept is that it binds a
> > transformation to a given CRS. That is, even though the transformation
> > is not part of the CRS, you can use that construct to associate the
> > transformation with a CRS (as it was previously done with TOWGS84). So,
> > for a TOWGS84 equivalence, you'd have a BOUNDCRS where the source is the
> > CRS being defined, the target would be WGS 84, and the operation method
> > would be a 7 parameter geocentric transformations with the rotation
> > convention (position vector/coordinate frame) explicitly defined.
>
> Hum, apparently I didn't understand the spec the way you explain it (I
> wouldn't
> bet much on the correctness of my interpretation), although I would prefer
> your
> interpretation to mine. My understanding was that if you have a BOUNDCRS
> the CRS
> that would apply would be the TARGETCRS and you would know that the data
> originaly was in SOURCECRS (this comes from how I understand the sentence
> "it is
> sometimes useful to associate the definition of the transformation that
> has been
> used with the CRS definition."). But you seem to understand it the other
> way,
> i.e the SOURCECRS would still apply ?
>
> Anyway it doesn't seem likely that most data would come with a BOUNDCRS
> expliciting the tranform to be used to go to WGS 84, so that would mean
> that
> GDAL for example would have to query it from its own EPSG database.
> Actually,
> that something we should ideally already do for example with the ESRI WKT
> of
> .prj files, since they do not have TOWG84 nodes.
>
> Even
>
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150512/584d79e8/attachment-0001.html>

From pepijn at vaneeckhoudt.net  Tue May 12 02:54:28 2015
From: pepijn at vaneeckhoudt.net (Pepijn Van Eeckhoudt)
Date: Tue, 12 May 2015 11:54:28 +0200
Subject: [gdal-dev] New OGC standard about WKT for projections
In-Reply-To: <CAJjdW1w43uzQX=43ejjnbWGHOUbQroz6X9hpzL5DdJ=f5HJ+iw@mail.gmail.com>
References: <loom.20150509T112104-165@post.gmane.org>
	<1431185882.554e29dad3f88@imp.free.fr> <5550C1C1.9080803@caris.com>
	<1431382233.555128d9366c3@imp.free.fr>
	<CAJjdW1w43uzQX=43ejjnbWGHOUbQroz6X9hpzL5DdJ=f5HJ+iw@mail.gmail.com>
Message-ID: <7E863801-E07B-4D1D-81C5-103B748DBFDB@vaneeckhoudt.net>

And OGC finally got round to making the spec public. See http://www.opengeospatial.org/pressroom/pressreleases/2217 <http://www.opengeospatial.org/pressroom/pressreleases/2217> and http://docs.opengeospatial.org/is/12-063r5/12-063r5.html <http://docs.opengeospatial.org/is/12-063r5/12-063r5.html>

Pepijn

> On 12 May 2015, at 11:17, Damian Dixon <damian.dixon at gmail.com> wrote:
> 
> ESRI have open sourced an implementation of a draft of the standard.
> 
> The code can be found here:
> 
> https://github.com/Esri/ogc-crs-wkt-parser <https://github.com/Esri/ogc-crs-wkt-parser>
> 
> I don't know how complete this is.
> 
> 
> 
> On 11 May 2015 at 23:10, Even Rouault <even.rouault at spatialys.com <mailto:even.rouault at spatialys.com>> wrote:
> Selon Andre Vautour <andre.vautour at caris.com <mailto:andre.vautour at caris.com>>:
> 
> > The way I see it, the new spec does clear up some big holes like:
> >
> >  1. Being able to specify an unambiguous operation/projection method (by
> >     identifier) for projections instead of loosely relying on the
> >     projection's name (9.3.3)
> >  2. Knowing the units of projection parameters (9.3.4)
> 
> Yes, there are of course interesting improvements. I'm often playing the devil's
> adovcate.
> 
> >
> > The transformation is not part of the coordinate reference system in
> > both the EPSG registry and the ISO 19111 specification. What was weird
> > with the older WKT spec is that you could have an identified CRS that
> > had TOWGS84 specified, even though that definition is technically not
> > part of the identified object. That being said, for a lot of practical
> > applications, the transformation is essential, so it'll be interesting
> > to see how it all plays out.
> >
> > > 18.1 Bound CRS
> > > The definition of a CRS is not dependent upon any relationship to an
> > > independent CRS. However in an implementation that merges datasets
> > > referenced to differing CRSs, it is sometimes useful to associate the
> > > definition of the transformation that has been used with the CRS
> > > definition.
> > >   AFAIU, the BOUNDCRS concept which can embrace the
> > > concept of TOWGS84 through a Coordinate Frame method is to be used when the
> > > transform to the TARGETCRS has already been done and document what was the
> > > SOURCRS and the transformation applied.
> > Even, I'm not sure if I completely understood that last part. It's
> > entirely possible that what follows is what you were trying to say. If
> > that is the case, fell free to just ignore me. :)
> >
> > The way I understand the BOUNDCRS concept is that it binds a
> > transformation to a given CRS. That is, even though the transformation
> > is not part of the CRS, you can use that construct to associate the
> > transformation with a CRS (as it was previously done with TOWGS84). So,
> > for a TOWGS84 equivalence, you'd have a BOUNDCRS where the source is the
> > CRS being defined, the target would be WGS 84, and the operation method
> > would be a 7 parameter geocentric transformations with the rotation
> > convention (position vector/coordinate frame) explicitly defined.
> 
> Hum, apparently I didn't understand the spec the way you explain it (I wouldn't
> bet much on the correctness of my interpretation), although I would prefer your
> interpretation to mine. My understanding was that if you have a BOUNDCRS the CRS
> that would apply would be the TARGETCRS and you would know that the data
> originaly was in SOURCECRS (this comes from how I understand the sentence "it is
> sometimes useful to associate the definition of the transformation that has been
> used with the CRS definition."). But you seem to understand it the other way,
> i.e the SOURCECRS would still apply ?
> 
> Anyway it doesn't seem likely that most data would come with a BOUNDCRS
> expliciting the tranform to be used to go to WGS 84, so that would mean that
> GDAL for example would have to query it from its own EPSG database. Actually,
> that something we should ideally already do for example with the ESRI WKT of
> .prj files, since they do not have TOWG84 nodes.
> 
> Even
> 
> 
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com <http://www.spatialys.com/>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
> http://lists.osgeo.org/mailman/listinfo/gdal-dev <http://lists.osgeo.org/mailman/listinfo/gdal-dev>
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150512/9bfa0c3c/attachment.html>

From rgrout at continuum.io  Tue May 12 14:25:53 2015
From: rgrout at continuum.io (Ryan Grout)
Date: Tue, 12 May 2015 16:25:53 -0500
Subject: [gdal-dev] python malloc error (gdal_array)
Message-ID: <55526FE1.7090907@continuum.io>

Hi,

I am building GDAL for OS X (along with the Python bindings).
To test that everything is working fine, run the following imports

import osgeo.ogr
import osgeo.osr
import osgeo.gdal
import osgeo.gdalconst
import osgeo.gdal_array

Each module was imported in a separate session of Python.  After each 
import, Python was closed by calling sys.exit() from within the 
interpreter.  When I import osgeo.gdal_array, and then I quit Python I 
get the following error:
python(2690,0x7fff7db5d300) malloc: *** error for object 
0x56415741e5894855: pointer being freed was not allocated
*** set a breakpoint in malloc_error_break to debug

And Python crashes.

GDAL compiled with (and the resulting library is stripped with 
--strip-unneeded)
bash configure \
     --without-python \
     --with-hdf5=$PREFIX \
     --with-netcdf=$PREFIX \
     --prefix=$PREFIX
make
make install

I then compile the python bindings with NumPy support from the GDAL 
package on PyPI.
The problem only happens on OS X (I tested it on Linux, OS X, and Windows).

This leads me to believe that there may be a bug in gdal_array on OS X.  
I'm not sure how to provide more info.  Any thoughts?  I'm surprised 
that it is only happening on OS X.



From sunil.vankadara at hexagongeospatial.com  Tue May 12 23:21:31 2015
From: sunil.vankadara at hexagongeospatial.com (Vankadara, Sunil)
Date: Wed, 13 May 2015 06:21:31 +0000
Subject: [gdal-dev] Regarding DPI in Geospatial PDF
In-Reply-To: <loom.20150511T111320-178@post.gmane.org>
References: <3ED2AF5FA67CF548BC5C06A608D7D405243025A1@IN-MBX2.ingrnet.com>
	<loom.20150511T111320-178@post.gmane.org>
Message-ID: <3ED2AF5FA67CF548BC5C06A608D7D405243051E4@IN-MBX2.ingrnet.com>

Hi Jukka,

Thanks for the detailed explanation. I could understand from your mail that changes in the DPI value will not affect the Page Size and PDF file size.

I am an amateur in this context, may I know what the user can achieve by providing different DPI values in creating a PDF file?

Regards
Sunil

-----Original Message-----
From: gdal-dev-bounces at lists.osgeo.org [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Jukka Rahkonen
Sent: 11 May 2015 03:21:PM
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Regarding DPI in Geospatial PDF

Vankadara, Sunil <sunil.vankadara <at> hexagongeospatial.com> writes:

> 
> Hi Team,
> 
> I have created two PDF file with default DPI and 600 values using
gdal_translate application.
> Unfortunately I couldn't find any difference among these two created 
> files
like file size, pixel size etc.
> 
> The input file details are
> Input file type: Erdas . img file
> Width of the image: 11938
> Height of the image:: 14184
> Datatype: UINT 8
> No of Bands: 3
> 
> May I know the reason for not showing up the difference in created outputs?
> 
> Regards
> Sunil
> 

Hi,

It may be that DPI setting at the moment does not have a totally desired effect. It would feel natural that increasing DPI from the default value 72 into a bigger value like 300 would make the page size of the PDF smaller expressed as physical units like millimeters.

The DPI setting is not supposed to affect the image itself so the PDF file size will be the same as well as the image quality so no up/downsampling will occur.

You can read some background from http://trac.osgeo.org/gdal/ticket/5412. In older PDF versions there was an absolute limit that page could not be bigger than 14000 units and the unit size was fixed to 1/72 inch. This limitation can be overridden in later PDF versions by using a UserUnit.

Create some sample PDF files with gdal_translate and you can see how the user unit behaves by opening the PDF file with a text editor and having a look at row 4 in the file.

Without -co DPI

<< /Annots 6 0 R /Contents 4 0 R /MediaBox [ 0 0 1728 1977 ] /Parent 1 0 R /Resources 5 0 R /Type /Page /UserUnit 1 >>

With -co DPI=300

<< /Annots 6 0 R /Contents 4 0 R /MediaBox [ 0 0 414.72000000000008
474.48000000000008 ] /Parent 1 0 R /Resources 5 0 R /Type /Page /UserUnit
4.1666666666666661 >>

With -co DPI=600 

<< /Annots 6 0 R /Contents 4 0 R /MediaBox [ 0 0 207.36000000000004
237.24000000000004 ] /Parent 1 0 R /Resources 5 0 R /Type /Page /UserUnit
8.3333333333333321 >>


The image box sixe comes from (MediaBox size) x (UserUnit size) and remains the same in all three cases because GDAL is adjusting both the MediaBox and UserUnit hand in hand.

It could be that GDAL should not touch to the size of the MediaBox if it does not exceed 14400 in either dimension.

-Jukka Rahkonen-

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev


From a.brouwer at crotec.nl  Wed May 13 00:07:23 2015
From: a.brouwer at crotec.nl (AnnelieseBrouwer)
Date: Wed, 13 May 2015 00:07:23 -0700 (PDT)
Subject: [gdal-dev] =?utf-8?b?U2lnbnMgbGlrZSAnYuKJpDMuMicgbm90IHByb2Nlc3Nl?=
 =?utf-8?q?d_properly_to_dbf/shp_files?=
Message-ID: <1431500843251-5205479.post@n6.nabble.com>

Hello community,

It seems as if signs like 'b?3.2' were not processed properly to dbf/shp
files. 

I create shape files from JSON file with GDAL using the statement:

  ds.CopyLayer(srcLayer, fileNameWithoutExtension, null);

or with cpg file:

  ds.CopyLayer(srcLayer, fileNameWithoutExtension, new string[] {
"ENCODING=UTF-8" });

All shape files were created, we can see them in Geoserver Preview
(OpenLayers).

But we have problems with signs like '?'.
In the JSON file those signs are fine but it looks like as if in the dbf
file these signs were not written properly. Depending on what encoding we
use in datasource.CopyLayer, you'll see a question mark or something else.

We have tried using the config var. SHAPE_ENCODING but we did not get the
right result.

We think this is a GDAL issue?
We need those signs in our website (Geoserver,OpenLayers).

We are using GDAL: x86, gdal-111-1600-core 
Geoserver: 2.6.0

Any idea what could be wrong and how we can solve this problem? 

Any feedback is appreciated!

Best regards, A. Brouwer
Test.json <http://osgeo-org.1560.x6.nabble.com/file/n5205479/Test.json>  



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Signs-like-b-3-2-not-processed-properly-to-dbf-shp-files-tp5205479.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From sunil.vankadara at hexagongeospatial.com  Wed May 13 00:30:53 2015
From: sunil.vankadara at hexagongeospatial.com (Vankadara, Sunil)
Date: Wed, 13 May 2015 07:30:53 +0000
Subject: [gdal-dev] Regarding DPI in Geospatial PDF
In-Reply-To: <loom.20150511T111320-178@post.gmane.org>
References: <3ED2AF5FA67CF548BC5C06A608D7D405243025A1@IN-MBX2.ingrnet.com>
	<loom.20150511T111320-178@post.gmane.org>
Message-ID: <3ED2AF5FA67CF548BC5C06A608D7D40524305344@IN-MBX2.ingrnet.com>

Hi Jukka,



I could understand from your mail that the mediabox is nothing but the image size in terms of width and height and the user unit is nothing but each pixel size.



Does it mean it is the PDF readers responsibility to dynamically resample to the given parameters in Media Box and User units? But Acrobat adobe reader is not resampling the image dynamically in displaying the image



Few observations from my side are

*         I haven't noticed any differences in Page size for different DPI values.

*         There is no difference of the image on the paper for different DPI values. ( I took the print out and noticed the differences physically )



Regards

Sunil



-----Original Message-----
From: gdal-dev-bounces at lists.osgeo.org [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Jukka Rahkonen
Sent: 11 May 2015 03:21:PM
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Regarding DPI in Geospatial PDF



Vankadara, Sunil <sunil.vankadara <at> hexagongeospatial.com> writes:



>

> Hi Team,

>

> I have created two PDF file with default DPI and 600 values using

gdal_translate application.

> Unfortunately I couldn't find any difference among these two created

> files

like file size, pixel size etc.

>

> The input file details are

> Input file type: Erdas . img file

> Width of the image: 11938

> Height of the image:: 14184

> Datatype: UINT 8

> No of Bands: 3

>

> May I know the reason for not showing up the difference in created outputs?

>

> Regards

> Sunil

>



Hi,



It may be that DPI setting at the moment does not have a totally desired effect. It would feel natural that increasing DPI from the default value 72 into a bigger value like 300 would make the page size of the PDF smaller expressed as physical units like millimeters.



The DPI setting is not supposed to affect the image itself so the PDF file size will be the same as well as the image quality so no up/downsampling will occur.



You can read some background from http://trac.osgeo.org/gdal/ticket/5412. In older PDF versions there was an absolute limit that page could not be bigger than 14000 units and the unit size was fixed to 1/72 inch. This limitation can be overridden in later PDF versions by using a UserUnit.



Create some sample PDF files with gdal_translate and you can see how the user unit behaves by opening the PDF file with a text editor and having a look at row 4 in the file.



Without -co DPI



<< /Annots 6 0 R /Contents 4 0 R /MediaBox [ 0 0 1728 1977 ] /Parent 1 0 R /Resources 5 0 R /Type /Page /UserUnit 1 >>



With -co DPI=300



<< /Annots 6 0 R /Contents 4 0 R /MediaBox [ 0 0 414.72000000000008

474.48000000000008 ] /Parent 1 0 R /Resources 5 0 R /Type /Page /UserUnit

4.1666666666666661 >>



With -co DPI=600



<< /Annots 6 0 R /Contents 4 0 R /MediaBox [ 0 0 207.36000000000004

237.24000000000004 ] /Parent 1 0 R /Resources 5 0 R /Type /Page /UserUnit

8.3333333333333321 >>





The image box sixe comes from (MediaBox size) x (UserUnit size) and remains the same in all three cases because GDAL is adjusting both the MediaBox and UserUnit hand in hand.



It could be that GDAL should not touch to the size of the MediaBox if it does not exceed 14400 in either dimension.



-Jukka Rahkonen-



_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

http://lists.osgeo.org/mailman/listinfo/gdal-dev


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150513/89864941/attachment.html>

From dengo at gmx.net  Wed May 13 05:00:47 2015
From: dengo at gmx.net (Dennis Gocke)
Date: Wed, 13 May 2015 14:00:47 +0200
Subject: [gdal-dev] JP2 GML Axis Order Problem
Message-ID: <CALqbEi4AuNapZ0ixvsL7XqE40jqiLxsLPEsL=4Z1v4qpggjV2w@mail.gmail.com>

Hi guys,



we have a Pleiades image here, the jp2 coming directly from the provider
with an GML header like this:



<gml:featureMember>

    <gml:FeatureCollection>

     <gml:featureMember>

        <gml:RectifiedGridCoverage dimension="2"
gml:id="COVERAGE_DS_PHR1A_201306090940372_FR1_PX_E017N43_0315_01434">

         <gml:description>Ortho
DS_PHR1A_201306090940372_FR1_PX_E017N43_0315_01434
coverage</gml:description>

         <gml:name>DS_PHR1A_201306090940372_FR1_PX_E017N43_0315_01434</gml:name>

         <gml:rectifiedGridDomain>

            <gml:RectifiedGrid dimension="2">

             <gml:limits>



        <!--  The PLEIADES convention is used: first pixel on the product
is pixel (1,1) -->

                <gml:GridEnvelope>

                 <gml:low>1 1</gml:low>

                 <gml:high>8528 7086</gml:high>

        </gml:GridEnvelope>

             </gml:limits>



      <!--first axis easting: urn:ogc:def:axis-name:EPSG::3035-->

             <gml:axisName>Easting</gml:axisName>



      <!--second axis northing: urn:ogc:def:axis-name:EPSG::3035-->

             <gml:axisName>Northing</gml:axisName>

             <gml:origin>

                <gml:Point srsName="urn:ogc:def:crs:EPSG::3035">

                 <gml:pos>4895767.000000000000000
2296945.000000000000000</gml:pos>

        </gml:Point>

       </gml:origin>

             <gml:offsetVector
srsName="urn:ogc:def:crs:EPSG::3035">2.000000000000000 0</gml:offsetVector>

             <gml:offsetVector srsName="urn:ogc:def:crs:EPSG::3035">0
-2.000000000000000</gml:offsetVector>

            </gml:RectifiedGrid>

         </gml:rectifiedGridDomain>

        <gml:rangeSet>

            <gml:File>

             <gml:rangeParameters>

                <gml:QuantityExtent uom="int">0 255</gml:QuantityExtent>

       </gml:rangeParameters>

             <gml:fileName>gmljp2://codestream/0</gml:fileName>

             <gml:fileStructure>Record Interleaved</gml:fileStructure>

      </gml:File>

     </gml:rangeSet>

        </gml:RectifiedGridCoverage>

     </gml:featureMember>

    </gml:FeatureCollection>

</gml:featureMember>



</gml:FeatureCollection>





The LAEA projection (EPSG::3035) is defined with having an axis order of Y,
X, which means GDAL swaps the axis of the geotransform. But in this case
this gives the wrong result. The JP2 GML defines an X,Y axis order by
putting in <gml:axisName> tags, which are not yet considered by GDAL,
neither GDAL 1.11 nor GDAL 2.0.0 beta1.

We can solve this issue by setting the GDAL_IGNORE_AXIS_ORIENTATION to
true, but maybe it would be better if GDAL would consider the
<gml:axisName>


Best Regards,
Dennis
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150513/513a6e29/attachment-0001.html>

From even.rouault at spatialys.com  Wed May 13 05:58:51 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 13 May 2015 14:58:51 +0200
Subject: [gdal-dev] JP2 GML Axis Order Problem
In-Reply-To: <CALqbEi4AuNapZ0ixvsL7XqE40jqiLxsLPEsL=4Z1v4qpggjV2w@mail.gmail.com>
References: <CALqbEi4AuNapZ0ixvsL7XqE40jqiLxsLPEsL=4Z1v4qpggjV2w@mail.gmail.com>
Message-ID: <1431521931.55534a8b19657@imp.free.fr>

Dennis,

Could you open a ticket in GDAL Trac about that ?

Even

> Hi guys,
>
>
>
> we have a Pleiades image here, the jp2 coming directly from the provider
> with an GML header like this:
>
>
>
> <gml:featureMember>
>
>     <gml:FeatureCollection>
>
>      <gml:featureMember>
>
>         <gml:RectifiedGridCoverage dimension="2"
> gml:id="COVERAGE_DS_PHR1A_201306090940372_FR1_PX_E017N43_0315_01434">
>
>          <gml:description>Ortho
> DS_PHR1A_201306090940372_FR1_PX_E017N43_0315_01434
> coverage</gml:description>
>
>
> <gml:name>DS_PHR1A_201306090940372_FR1_PX_E017N43_0315_01434</gml:name>
>
>          <gml:rectifiedGridDomain>
>
>             <gml:RectifiedGrid dimension="2">
>
>              <gml:limits>
>
>
>
>         <!--  The PLEIADES convention is used: first pixel on the product
> is pixel (1,1) -->
>
>                 <gml:GridEnvelope>
>
>                  <gml:low>1 1</gml:low>
>
>                  <gml:high>8528 7086</gml:high>
>
>         </gml:GridEnvelope>
>
>              </gml:limits>
>
>
>
>       <!--first axis easting: urn:ogc:def:axis-name:EPSG::3035-->
>
>              <gml:axisName>Easting</gml:axisName>
>
>
>
>       <!--second axis northing: urn:ogc:def:axis-name:EPSG::3035-->
>
>              <gml:axisName>Northing</gml:axisName>
>
>              <gml:origin>
>
>                 <gml:Point srsName="urn:ogc:def:crs:EPSG::3035">
>
>                  <gml:pos>4895767.000000000000000
> 2296945.000000000000000</gml:pos>
>
>         </gml:Point>
>
>        </gml:origin>
>
>              <gml:offsetVector
> srsName="urn:ogc:def:crs:EPSG::3035">2.000000000000000 0</gml:offsetVector>
>
>              <gml:offsetVector srsName="urn:ogc:def:crs:EPSG::3035">0
> -2.000000000000000</gml:offsetVector>
>
>             </gml:RectifiedGrid>
>
>          </gml:rectifiedGridDomain>
>
>         <gml:rangeSet>
>
>             <gml:File>
>
>              <gml:rangeParameters>
>
>                 <gml:QuantityExtent uom="int">0 255</gml:QuantityExtent>
>
>        </gml:rangeParameters>
>
>              <gml:fileName>gmljp2://codestream/0</gml:fileName>
>
>              <gml:fileStructure>Record Interleaved</gml:fileStructure>
>
>       </gml:File>
>
>      </gml:rangeSet>
>
>         </gml:RectifiedGridCoverage>
>
>      </gml:featureMember>
>
>     </gml:FeatureCollection>
>
> </gml:featureMember>
>
>
>
> </gml:FeatureCollection>
>
>
>
>
>
> The LAEA projection (EPSG::3035) is defined with having an axis order of Y,
> X, which means GDAL swaps the axis of the geotransform. But in this case
> this gives the wrong result. The JP2 GML defines an X,Y axis order by
> putting in <gml:axisName> tags, which are not yet considered by GDAL,
> neither GDAL 1.11 nor GDAL 2.0.0 beta1.
>
> We can solve this issue by setting the GDAL_IGNORE_AXIS_ORIENTATION to
> true, but maybe it would be better if GDAL would consider the
> <gml:axisName>
>
>
> Best Regards,
> Dennis
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From dengo at gmx.net  Wed May 13 06:13:21 2015
From: dengo at gmx.net (Dennis Gocke)
Date: Wed, 13 May 2015 15:13:21 +0200
Subject: [gdal-dev] JP2 GML Axis Order Problem
In-Reply-To: <1431521931.55534a8b19657@imp.free.fr>
References: <CALqbEi4AuNapZ0ixvsL7XqE40jqiLxsLPEsL=4Z1v4qpggjV2w@mail.gmail.com>
	<1431521931.55534a8b19657@imp.free.fr>
Message-ID: <CALqbEi7FYA3LaBxEqpccGgKc0NGs3scYdwfGuCXKYHrgn1PAEQ@mail.gmail.com>

Hi Even,

I've created ticket #5960 <http://trac.osgeo.org/gdal/ticket/5960>

Best Regards,
Dennis


On Wed, May 13, 2015 at 2:58 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Dennis,
>
> Could you open a ticket in GDAL Trac about that ?
>
> Even
>
> > Hi guys,
> >
> >
> >
> > we have a Pleiades image here, the jp2 coming directly from the provider
> > with an GML header like this:
> >
> >
> >
> > <gml:featureMember>
> >
> >     <gml:FeatureCollection>
> >
> >      <gml:featureMember>
> >
> >         <gml:RectifiedGridCoverage dimension="2"
> > gml:id="COVERAGE_DS_PHR1A_201306090940372_FR1_PX_E017N43_0315_01434">
> >
> >          <gml:description>Ortho
> > DS_PHR1A_201306090940372_FR1_PX_E017N43_0315_01434
> > coverage</gml:description>
> >
> >
> > <gml:name>DS_PHR1A_201306090940372_FR1_PX_E017N43_0315_01434</gml:name>
> >
> >          <gml:rectifiedGridDomain>
> >
> >             <gml:RectifiedGrid dimension="2">
> >
> >              <gml:limits>
> >
> >
> >
> >         <!--  The PLEIADES convention is used: first pixel on the product
> > is pixel (1,1) -->
> >
> >                 <gml:GridEnvelope>
> >
> >                  <gml:low>1 1</gml:low>
> >
> >                  <gml:high>8528 7086</gml:high>
> >
> >         </gml:GridEnvelope>
> >
> >              </gml:limits>
> >
> >
> >
> >       <!--first axis easting: urn:ogc:def:axis-name:EPSG::3035-->
> >
> >              <gml:axisName>Easting</gml:axisName>
> >
> >
> >
> >       <!--second axis northing: urn:ogc:def:axis-name:EPSG::3035-->
> >
> >              <gml:axisName>Northing</gml:axisName>
> >
> >              <gml:origin>
> >
> >                 <gml:Point srsName="urn:ogc:def:crs:EPSG::3035">
> >
> >                  <gml:pos>4895767.000000000000000
> > 2296945.000000000000000</gml:pos>
> >
> >         </gml:Point>
> >
> >        </gml:origin>
> >
> >              <gml:offsetVector
> > srsName="urn:ogc:def:crs:EPSG::3035">2.000000000000000
> 0</gml:offsetVector>
> >
> >              <gml:offsetVector srsName="urn:ogc:def:crs:EPSG::3035">0
> > -2.000000000000000</gml:offsetVector>
> >
> >             </gml:RectifiedGrid>
> >
> >          </gml:rectifiedGridDomain>
> >
> >         <gml:rangeSet>
> >
> >             <gml:File>
> >
> >              <gml:rangeParameters>
> >
> >                 <gml:QuantityExtent uom="int">0 255</gml:QuantityExtent>
> >
> >        </gml:rangeParameters>
> >
> >              <gml:fileName>gmljp2://codestream/0</gml:fileName>
> >
> >              <gml:fileStructure>Record Interleaved</gml:fileStructure>
> >
> >       </gml:File>
> >
> >      </gml:rangeSet>
> >
> >         </gml:RectifiedGridCoverage>
> >
> >      </gml:featureMember>
> >
> >     </gml:FeatureCollection>
> >
> > </gml:featureMember>
> >
> >
> >
> > </gml:FeatureCollection>
> >
> >
> >
> >
> >
> > The LAEA projection (EPSG::3035) is defined with having an axis order of
> Y,
> > X, which means GDAL swaps the axis of the geotransform. But in this case
> > this gives the wrong result. The JP2 GML defines an X,Y axis order by
> > putting in <gml:axisName> tags, which are not yet considered by GDAL,
> > neither GDAL 1.11 nor GDAL 2.0.0 beta1.
> >
> > We can solve this issue by setting the GDAL_IGNORE_AXIS_ORIENTATION to
> > true, but maybe it would be better if GDAL would consider the
> > <gml:axisName>
> >
> >
> > Best Regards,
> > Dennis
> >
>
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150513/16d7ee59/attachment.html>

From Steve.Toutant at inspq.qc.ca  Wed May 13 12:11:21 2015
From: Steve.Toutant at inspq.qc.ca (Steve.Toutant at inspq.qc.ca)
Date: Wed, 13 May 2015 15:11:21 -0400
Subject: [gdal-dev] Python ogr GetFieldAsString problem
Message-ID: <OF8D6518EE.189D456F-ON85257E44.00678192-85257E44.006968B9@isn.rtss.qc.ca>

I'm trying to parse a GML and read all the values of an attribute.
Example
<gml:featureMember> 
      <ms:SMDVDP_STAT_METE fid="SMDVDP_STAT_METE.2153"> 
        <ms:LONG_STAT>-64,2131</ms:LONG_STAT> 
      </ms:SMDVDP_STAT_METE> 
    </gml:featureMember> 

DescribeFeatureType for this layer returns 
<element name="LONG_STAT" minOccurs="0" type="double"/> 

wfs_ds = ogr.Open(tmp_file.name)  #tmp_file.name is the response of a WFS 
getFeature request
layer = wfs_ds.GetLayerByName('SMDVDP_STAT_METE ')
feat = layer.GetNextFeature()
      while feat is not None:
          output.add(feat.GetFieldAsString('LONG_STAT'))
          feat = layer.GetNextFeature()

(At runtime, the WFs, layer and attribute can be anything of any type. And 
decimal separator, can be ',' or '.')
The problem is that feat.GetFieldAsString('LONG_STAT') truncate the string 
to the comma

So instead of having -64,2131, I get -64 in the output

What is the appropriate way to get the value of an attribute?

thanks you!


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150513/1bcfba6c/attachment.html>

From Steve.Toutant at inspq.qc.ca  Wed May 13 13:20:09 2015
From: Steve.Toutant at inspq.qc.ca (Steve.Toutant at inspq.qc.ca)
Date: Wed, 13 May 2015 16:20:09 -0400
Subject: [gdal-dev] RE Python ogr GetFieldAsString problem
In-Reply-To: <OF8D6518EE.189D456F-ON85257E44.00678192-85257E44.006968B9@LocalDomain>
References: <OF8D6518EE.189D456F-ON85257E44.00678192-85257E44.006968B9@LocalDomain>
Message-ID: <OFCEFA3D48.F1B41540-ON85257E44.006F8323-85257E44.006FB54E@isn.rtss.qc.ca>

More info.....
ogr2ogr --version = GDAL 1.10.1, released 2013/08/26
python --version = Python 2.7.3

I have modified my script to get the field type
while feat is not None:
          feat_defn = layer.GetLayerDefn()
          field_defn = 
feat_defn.GetFieldDefn(feat_defn.GetFieldIndex(attribut))
          print field_defn.GetType()
          if field_defn.GetType() == ogr.OFTReal:
            print "%.4f" % feat.GetFieldAsDouble(attribut)
          output.add(feat.GetFieldAsString(attribut))
          feat = layer.GetNextFeature()

It detects that it is a real, But GetFieldAsDouble also truncate the value 
at the comma



Steve Toutant/INSPQ/SSSS 
2015-05-13 15:11

A
gdal-dev at lists.osgeo.org
cc

Objet
Python ogr GetFieldAsString problem








I'm trying to parse a GML and read all the values of an attribute.
Example
<gml:featureMember> 
      <ms:SMDVDP_STAT_METE fid="SMDVDP_STAT_METE.2153"> 
        <ms:LONG_STAT>-64,2131</ms:LONG_STAT> 
      </ms:SMDVDP_STAT_METE> 
    </gml:featureMember> 

DescribeFeatureType for this layer returns 
<element name="LONG_STAT" minOccurs="0" type="double"/> 

wfs_ds = ogr.Open(tmp_file.name)  #tmp_file.name is the response of a WFS 
getFeature request
layer = wfs_ds.GetLayerByName('SMDVDP_STAT_METE ')
feat = layer.GetNextFeature()
      while feat is not None:
          output.add(feat.GetFieldAsString('LONG_STAT'))
          feat = layer.GetNextFeature()

(At runtime, the WFs, layer and attribute can be anything of any type. And 
decimal separator, can be ',' or '.')
The problem is that feat.GetFieldAsString('LONG_STAT') truncate the string 
to the comma

So instead of having -64,2131, I get -64 in the output

What is the appropriate way to get the value of an attribute?

thanks you!





-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150513/bc2afd11/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Wed May 13 13:55:19 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Wed, 13 May 2015 20:55:19 +0000 (UTC)
Subject: [gdal-dev] Python ogr GetFieldAsString problem
References: <OF8D6518EE.189D456F-ON85257E44.00678192-85257E44.006968B9@isn.rtss.qc.ca>
Message-ID: <loom.20150513T224904-804@post.gmane.org>

 <Steve.Toutant <at> inspq.qc.ca> writes:

> 
> I'm trying to parse a GML and read all
> the values of an attribute.

> The problem is that feat.GetFieldAsString('LONG_STAT')
> truncate the string to the comma
> So instead of having -64,2131,
> I get -64 in the output
> What is the appropriate way to get the
> value of an attribute?
> thanks you!

Hi,

I would concentrate on configuring your Oracle and Mapserver so that GML
from the WFS service would use point as a decimal separator instead of
comma. I do not know exactly what needs to be done but I would startby
reading a whole lot about NLS_LANG beginning from
http://www.oracle.com/technetwork/products/globalization/nls-lang-099431.html.

(I have been reading Mapserver-users mails so I know a bit about the
environment).

-Jukka Rahkonen-


From even.rouault at spatialys.com  Wed May 13 14:02:03 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 13 May 2015 23:02:03 +0200
Subject: [gdal-dev] RE Python ogr GetFieldAsString problem
In-Reply-To: <OFCEFA3D48.F1B41540-ON85257E44.006F8323-85257E44.006FB54E@isn.rtss.qc.ca>
References: <OF8D6518EE.189D456F-ON85257E44.00678192-85257E44.006968B9@LocalDomain>
	<OFCEFA3D48.F1B41540-ON85257E44.006F8323-85257E44.006FB54E@isn.rtss.qc.ca>
Message-ID: <1431550923.5553bbcb569a2@imp.free.fr>

Steve,

I believe comma as decimal separator is invalid for a XML double. Hence the GML
driver only parses the value up to the comma. This could likely be improved to
accept comma, but technically I believe a XML validator would reject this GML.

Even

> More info.....
> ogr2ogr --version = GDAL 1.10.1, released 2013/08/26
> python --version = Python 2.7.3
>
> I have modified my script to get the field type
> while feat is not None:
>           feat_defn = layer.GetLayerDefn()
>           field_defn =
> feat_defn.GetFieldDefn(feat_defn.GetFieldIndex(attribut))
>           print field_defn.GetType()
>           if field_defn.GetType() == ogr.OFTReal:
>             print "%.4f" % feat.GetFieldAsDouble(attribut)
>           output.add(feat.GetFieldAsString(attribut))
>           feat = layer.GetNextFeature()
>
> It detects that it is a real, But GetFieldAsDouble also truncate the value
> at the comma
>
>
>
> Steve Toutant/INSPQ/SSSS
> 2015-05-13 15:11
>
> A
> gdal-dev at lists.osgeo.org
> cc
>
> Objet
> Python ogr GetFieldAsString problem
>
>
>
>
>
>
>
>
> I'm trying to parse a GML and read all the values of an attribute.
> Example
> <gml:featureMember>
>       <ms:SMDVDP_STAT_METE fid="SMDVDP_STAT_METE.2153">
>         <ms:LONG_STAT>-64,2131</ms:LONG_STAT>
>       </ms:SMDVDP_STAT_METE>
>     </gml:featureMember>
>
> DescribeFeatureType for this layer returns
> <element name="LONG_STAT" minOccurs="0" type="double"/>
>
> wfs_ds = ogr.Open(tmp_file.name)  #tmp_file.name is the response of a WFS
> getFeature request
> layer = wfs_ds.GetLayerByName('SMDVDP_STAT_METE ')
> feat = layer.GetNextFeature()
>       while feat is not None:
>           output.add(feat.GetFieldAsString('LONG_STAT'))
>           feat = layer.GetNextFeature()
>
> (At runtime, the WFs, layer and attribute can be anything of any type. And
> decimal separator, can be ',' or '.')
> The problem is that feat.GetFieldAsString('LONG_STAT') truncate the string
> to the comma
>
> So instead of having -64,2131, I get -64 in the output
>
> What is the appropriate way to get the value of an attribute?
>
> thanks you!
>
>
>
>
>
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From Steve.Toutant at inspq.qc.ca  Thu May 14 06:02:36 2015
From: Steve.Toutant at inspq.qc.ca (Steve.Toutant at inspq.qc.ca)
Date: Thu, 14 May 2015 09:02:36 -0400
Subject: [gdal-dev] RE Python ogr GetFieldAsString problem
In-Reply-To: <1431550923.5553bbcb569a2@imp.free.fr>
References: <OF8D6518EE.189D456F-ON85257E44.00678192-85257E44.006968B9@LocalDomain>
	<OFCEFA3D48.F1B41540-ON85257E44.006F8323-85257E44.006FB54E@isn.rtss.qc.ca>
	<1431550923.5553bbcb569a2@imp.free.fr>
Message-ID: <OF5F239CE6.0B6F4B57-ON85257E45.00458BE1-85257E45.0047A60F@isn.rtss.qc.ca>

Thanks for your responses!
We can't change the settings, Refused by the system admin, too many 
applications are using the database and the actual settings.


The response of the WFS contains the comma, and it is in GML
 <gml:featureMember>
       <ms:SMDVDP_STAT_METE fid="SMDVDP_STAT_METE.2153">
         <ms:LONG_STAT>-64,2131</ms:LONG_STAT>
       </ms:SMDVDP_STAT_METE>
     </gml:featureMember>

The comma and decimals are not truncated by an XML validator, they are 
truncated by GetFieldAsDouble

But Maybe, it thinks that there are 2 values...-64 and 2131.
On my side, A patch would be to replace the , by ., use GetFieldAsDouble 
and replace . by , .....

Many countries in the world are using a comma as decimal separator there 
must be a solution....
What do you think, Does GetFieldAsDouble should be able to manage the ,''?

thanks!








Even Rouault <even.rouault at spatialys.com> 
2015-05-13 17:02

A
Steve.Toutant at inspq.qc.ca
cc
gdal-dev at lists.osgeo.org
Objet
Re: [gdal-dev] RE Python ogr GetFieldAsString problem








Steve,

I believe comma as decimal separator is invalid for a XML double. Hence 
the GML
driver only parses the value up to the comma. This could likely be 
improved to
accept comma, but technically I believe a XML validator would reject this 
GML.

Even

> More info.....
> ogr2ogr --version = GDAL 1.10.1, released 2013/08/26
> python --version = Python 2.7.3
>
> I have modified my script to get the field type
> while feat is not None:
>           feat_defn = layer.GetLayerDefn()
>           field_defn =
> feat_defn.GetFieldDefn(feat_defn.GetFieldIndex(attribut))
>           print field_defn.GetType()
>           if field_defn.GetType() == ogr.OFTReal:
>             print "%.4f" % feat.GetFieldAsDouble(attribut)
>           output.add(feat.GetFieldAsString(attribut))
>           feat = layer.GetNextFeature()
>
> It detects that it is a real, But GetFieldAsDouble also truncate the 
value
> at the comma
>
>
>
> Steve Toutant/INSPQ/SSSS
> 2015-05-13 15:11
>
> A
> gdal-dev at lists.osgeo.org
> cc
>
> Objet
> Python ogr GetFieldAsString problem
>
>
>
>
>
>
>
>
> I'm trying to parse a GML and read all the values of an attribute.
> Example
> <gml:featureMember>
>       <ms:SMDVDP_STAT_METE fid="SMDVDP_STAT_METE.2153">
>         <ms:LONG_STAT>-64,2131</ms:LONG_STAT>
>       </ms:SMDVDP_STAT_METE>
>     </gml:featureMember>
>
> DescribeFeatureType for this layer returns
> <element name="LONG_STAT" minOccurs="0" type="double"/>
>
> wfs_ds = ogr.Open(tmp_file.name)  #tmp_file.name is the response of a 
WFS
> getFeature request
> layer = wfs_ds.GetLayerByName('SMDVDP_STAT_METE ')
> feat = layer.GetNextFeature()
>       while feat is not None:
>           output.add(feat.GetFieldAsString('LONG_STAT'))
>           feat = layer.GetNextFeature()
>
> (At runtime, the WFs, layer and attribute can be anything of any type. 
And
> decimal separator, can be ',' or '.')
> The problem is that feat.GetFieldAsString('LONG_STAT') truncate the 
string
> to the comma
>
> So instead of having -64,2131, I get -64 in the output
>
> What is the appropriate way to get the value of an attribute?
>
> thanks you!
>
>
>
>
>
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150514/cf0bdbd1/attachment-0001.html>

From nik at nikosalexandris.net  Thu May 14 06:40:57 2015
From: nik at nikosalexandris.net (Nikos Alexandris)
Date: Thu, 14 May 2015 16:40:57 +0300
Subject: [gdal-dev] Reading the TerrainBase 1995 dataset (.BIN + .HDR) with
	gdal?
Message-ID: <20150514134057.GA3096@tpx1c2g>

Hi gdalers,

has anyone read the TerrainBase data set (NOOA, 1995) using gdal tools?

The link to the relevant CD is:
http://webapp1.dlib.indiana.edu/virtual_disk_library/index.cgi/6081153/FID3260

(see for example inside the DATA directory)

Thank you, Nikos

From even.rouault at spatialys.com  Thu May 14 06:46:32 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 14 May 2015 15:46:32 +0200
Subject: [gdal-dev] RE Python ogr GetFieldAsString problem
In-Reply-To: <OF5F239CE6.0B6F4B57-ON85257E45.00458BE1-85257E45.0047A60F@isn.rtss.qc.ca>
References: <OF8D6518EE.189D456F-ON85257E44.00678192-85257E44.006968B9@LocalDomain>
	<OFCEFA3D48.F1B41540-ON85257E44.006F8323-85257E44.006FB54E@isn.rtss.qc.ca>
	<1431550923.5553bbcb569a2@imp.free.fr>
	<OF5F239CE6.0B6F4B57-ON85257E45.00458BE1-85257E45.0047A60F@isn.rtss.qc.ca>
Message-ID: <1431611192.5554a738d0d96@imp.free.fr>

Selon Steve.Toutant at inspq.qc.ca:

> Thanks for your responses!
> We can't change the settings, Refused by the system admin, too many
> applications are using the database and the actual settings.
>
>
> The response of the WFS contains the comma, and it is in GML
>  <gml:featureMember>
>        <ms:SMDVDP_STAT_METE fid="SMDVDP_STAT_METE.2153">
>          <ms:LONG_STAT>-64,2131</ms:LONG_STAT>
>        </ms:SMDVDP_STAT_METE>
>      </gml:featureMember>
>
> The comma and decimals are not truncated by an XML validator,

I've tested something similar and libxml2 does reject such GML file :

Element '{http://ogr.maptools.org/}AREA': '215229,266' is not a valid value of
the local atomic type., line 17


 they are
> truncated by GetFieldAsDouble
>
> But Maybe, it thinks that there are 2 values...-64 and 2131.
> On my side, A patch would be to replace the , by ., use GetFieldAsDouble
> and replace . by , .....
>
> Many countries in the world are using a comma as decimal separator there
> must be a solution....

In GML/XML, decimal values should not be localized.

> What do you think, Does GetFieldAsDouble should be able to manage the ,''?

When the .gml file is accompanied by the .xsd, the GML reader can easily be
tweaked to recognize the , as decimal separator. But when operating without
.xsd, the detection of types would recognize such a value as a string, not a
real value. So I'm not sure if it is appropriate to apply. Anyway, if you want
it :

Index: ogr/ogrsf_frmts/gml/ogrgmllayer.cpp
===================================================================
--- ogr/ogrsf_frmts/gml/ogrgmllayer.cpp	(revision 29190)
+++ ogr/ogrsf_frmts/gml/ogrgmllayer.cpp	(working copy)
@@ -393,7 +393,7 @@
             {
               case GMLPT_Real:
               {
-                  poOGRFeature->SetField( iDstField,
CPLAtof(psGMLProperty->papszSubProperties[0]) );
+                  poOGRFeature->SetField( iDstField,
CPLAtofM(psGMLProperty->papszSubProperties[0]) );
               }
               break;




>
> thanks!
>
>
>
>
>
>
>
>
> Even Rouault <even.rouault at spatialys.com>
> 2015-05-13 17:02
>
> A
> Steve.Toutant at inspq.qc.ca
> cc
> gdal-dev at lists.osgeo.org
> Objet
> Re: [gdal-dev] RE Python ogr GetFieldAsString problem
>
>
>
>
>
>
>
>
> Steve,
>
> I believe comma as decimal separator is invalid for a XML double. Hence
> the GML
> driver only parses the value up to the comma. This could likely be
> improved to
> accept comma, but technically I believe a XML validator would reject this
> GML.
>
> Even
>
> > More info.....
> > ogr2ogr --version = GDAL 1.10.1, released 2013/08/26
> > python --version = Python 2.7.3
> >
> > I have modified my script to get the field type
> > while feat is not None:
> >           feat_defn = layer.GetLayerDefn()
> >           field_defn =
> > feat_defn.GetFieldDefn(feat_defn.GetFieldIndex(attribut))
> >           print field_defn.GetType()
> >           if field_defn.GetType() == ogr.OFTReal:
> >             print "%.4f" % feat.GetFieldAsDouble(attribut)
> >           output.add(feat.GetFieldAsString(attribut))
> >           feat = layer.GetNextFeature()
> >
> > It detects that it is a real, But GetFieldAsDouble also truncate the
> value
> > at the comma
> >
> >
> >
> > Steve Toutant/INSPQ/SSSS
> > 2015-05-13 15:11
> >
> > A
> > gdal-dev at lists.osgeo.org
> > cc
> >
> > Objet
> > Python ogr GetFieldAsString problem
> >
> >
> >
> >
> >
> >
> >
> >
> > I'm trying to parse a GML and read all the values of an attribute.
> > Example
> > <gml:featureMember>
> >       <ms:SMDVDP_STAT_METE fid="SMDVDP_STAT_METE.2153">
> >         <ms:LONG_STAT>-64,2131</ms:LONG_STAT>
> >       </ms:SMDVDP_STAT_METE>
> >     </gml:featureMember>
> >
> > DescribeFeatureType for this layer returns
> > <element name="LONG_STAT" minOccurs="0" type="double"/>
> >
> > wfs_ds = ogr.Open(tmp_file.name)  #tmp_file.name is the response of a
> WFS
> > getFeature request
> > layer = wfs_ds.GetLayerByName('SMDVDP_STAT_METE ')
> > feat = layer.GetNextFeature()
> >       while feat is not None:
> >           output.add(feat.GetFieldAsString('LONG_STAT'))
> >           feat = layer.GetNextFeature()
> >
> > (At runtime, the WFs, layer and attribute can be anything of any type.
> And
> > decimal separator, can be ',' or '.')
> > The problem is that feat.GetFieldAsString('LONG_STAT') truncate the
> string
> > to the comma
> >
> > So instead of having -64,2131, I get -64 in the output
> >
> > What is the appropriate way to get the value of an attribute?
> >
> > thanks you!
> >
> >
> >
> >
> >
> >
>
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
>
>
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu May 14 07:16:32 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 14 May 2015 16:16:32 +0200
Subject: [gdal-dev] RE Python ogr GetFieldAsString problem
In-Reply-To: <OF9985A4BC.5FF9EDF6-ON85257E45.004D4417-85257E45.004D9DF3@isn.rtss.qc.ca>
References: <OF8D6518EE.189D456F-ON85257E44.00678192-85257E44.006968B9@LocalDomain>
	<OFCEFA3D48.F1B41540-ON85257E44.006F8323-85257E44.006FB54E@isn.rtss.qc.ca>
	<1431550923.5553bbcb569a2@imp.free.fr>
	<OF5F239CE6.0B6F4B57-ON85257E45.00458BE1-85257E45.0047A60F@isn.rtss.qc.ca>
	<1431611192.5554a738d0d96@imp.free.fr>
	<OF9985A4BC.5FF9EDF6-ON85257E45.004D4417-85257E45.004D9DF3@isn.rtss.qc.ca>
Message-ID: <1431612992.5554ae406f976@imp.free.fr>

Selon Steve.Toutant at inspq.qc.ca:

> Hi Even,
> I don't understand why GetFieldAsString() truncates the value....Should it
> reads the value as it is?

To be pedantic, GetFieldAsString() does not truncate the value. The value is
truncated before, in the GML reader, when inserting the value from the GML as a
real value into the OGR real field.

> Is it because it also use a  GML reader?

The conversion from the XML content to the real value is done with a function
(CPLAtof()) that assumes dot as the decimal character, which is the correct
behaviour in that instance.

I guess you would have issues with most GML readers, that's why I'm a bit
hesitant into committing the patch.

>
> In this case I should probably use another tool than ogr to parse the GML,
> something like preg_match in php....
> Thanks
> steve
> Steve Toutant, M. Sc.
> Analyste en g?omatique
> Secteur environnement
> Direction de la sant? environnementale et de la toxicologie
> Institut national de sant? publique du Qu?bec
> 945, avenue Wolfe
> 4e ?tage, Qu?bec, Qc
> G1V 5B3
> 418 654-3010 poste 5428
>
> http://www.inspq.qc.ca
> http://www.monclimatmasante.qc.ca


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From Steve.Toutant at inspq.qc.ca  Thu May 14 07:24:30 2015
From: Steve.Toutant at inspq.qc.ca (Steve.Toutant at inspq.qc.ca)
Date: Thu, 14 May 2015 10:24:30 -0400
Subject: [gdal-dev] RE Python ogr GetFieldAsString problem
In-Reply-To: <1431612992.5554ae406f976@imp.free.fr>
References: <OF8D6518EE.189D456F-ON85257E44.00678192-85257E44.006968B9@LocalDomain>
	<OFCEFA3D48.F1B41540-ON85257E44.006F8323-85257E44.006FB54E@isn.rtss.qc.ca>
	<1431550923.5553bbcb569a2@imp.free.fr>
	<OF5F239CE6.0B6F4B57-ON85257E45.00458BE1-85257E45.0047A60F@isn.rtss.qc.ca>
	<1431611192.5554a738d0d96@imp.free.fr>
	<OF9985A4BC.5FF9EDF6-ON85257E45.004D4417-85257E45.004D9DF3@isn.rtss.qc.ca>
	<1431612992.5554ae406f976@imp.free.fr>
Message-ID: <OF33B18A6C.5340C39F-ON85257E45.004ED143-85257E45.004F25A5@isn.rtss.qc.ca>

I agree, no patch. 
Actually the patch will be on my side. I might use python re, to replace 
the comma by dot int he WFS response, for numeric field

If others are in the same situation, your suggestions are welcome
thanks





Even Rouault <even.rouault at spatialys.com> 
2015-05-14 10:16

A
Steve.Toutant at inspq.qc.ca
cc
gdal-dev at lists.osgeo.org
Objet
Re: [gdal-dev] RE Python ogr GetFieldAsString problem








Selon Steve.Toutant at inspq.qc.ca:

> Hi Even,
> I don't understand why GetFieldAsString() truncates the value....Should 
it
> reads the value as it is?

To be pedantic, GetFieldAsString() does not truncate the value. The value 
is
truncated before, in the GML reader, when inserting the value from the GML 
as a
real value into the OGR real field.

> Is it because it also use a  GML reader?

The conversion from the XML content to the real value is done with a 
function
(CPLAtof()) that assumes dot as the decimal character, which is the 
correct
behaviour in that instance.

I guess you would have issues with most GML readers, that's why I'm a bit
hesitant into committing the patch.

>
> In this case I should probably use another tool than ogr to parse the 
GML,
> something like preg_match in php....
> Thanks
> steve
> Steve Toutant, M. Sc.
> Analyste en g?omatique
> Secteur environnement
> Direction de la sant? environnementale et de la toxicologie
> Institut national de sant? publique du Qu?bec
> 945, avenue Wolfe
> 4e ?tage, Qu?bec, Qc
> G1V 5B3
> 418 654-3010 poste 5428
>
> http://www.inspq.qc.ca
> http://www.monclimatmasante.qc.ca


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150514/7d10671a/attachment.html>

From even.rouault at spatialys.com  Thu May 14 07:27:18 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 14 May 2015 16:27:18 +0200
Subject: [gdal-dev] Reading the TerrainBase 1995 dataset (.BIN + .HDR)
	with gdal?
In-Reply-To: <20150514134057.GA3096@tpx1c2g>
References: <20150514134057.GA3096@tpx1c2g>
Message-ID: <1431613638.5554b0c66ce32@imp.free.fr>

Selon Nikos Alexandris <nik at nikosalexandris.net>:

> Hi gdalers,
>
> has anyone read the TerrainBase data set (NOOA, 1995) using gdal tools?
>
> The link to the relevant CD is:
> http://webapp1.dlib.indiana.edu/virtual_disk_library/index.cgi/6081153/FID3260
>
> (see for example inside the DATA directory)

Nikos,

The .HDR file contains the same information as in the ESRI .HDR format, but with
a different format, so it is not automatically recognized.

>From the info in the .HDR you can build a VRT file (
http://gdal.org/gdal_vrttut.html ) referencing the .BIN. For example for
AFRICA.BIN :

<VRTDataset rasterXSize="984" rasterYSize="900">
  <SRS>WGS84</SRS>
 
<GeoTransform>-26.041666666,0.08333333,0,40.041666666,0,-0.08333333</GeoTransform>
  <VRTRasterBand dataType="Int16" band="1" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">AFRICA.BIN</SourceFilename>
  </VRTRasterBand>
</VRTDataset>

Otherwise you can find free DEMs as GeoTIFF at http://srtm.csi.cgiar.org/ (at a
much higher resolution)

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From yuchen at avenza.com  Thu May 14 08:08:32 2015
From: yuchen at avenza.com (Yuchen Zhong)
Date: Thu, 14 May 2015 11:08:32 -0400
Subject: [gdal-dev] GDAL no longer compile under Windows
Message-ID: <f855ea20-9abc-4067-9ee5-abbe2f7c7e93@getmailbird.com>

Hello all,

For some reason, GDAL no longer compile after this check in (commit) on May 3rd, 2015:?

Add imagery (satellite or aerial) metadata support (DigitalGlobe, GeoEye, OrbView, Landsat, Pleiades, Resurs-DK1).
git-svn-id: https://svn.osgeo.org/gdal/trunk at 29123 f0d54148-0727-0410-94bb-9a71ac55c965

I am using the script described in under this link:?https://trac.osgeo.org/gdal/wiki/BuildingOnWindows

? ? ? ?call "C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\vcvarsall.bat"
? ? ? ?C:\GDAL> nmake /f makefile.vc

I don't know whether I should write a ticket for this or not. But does this happens to anybody else? Or if there is anything that I am missing??

Best regards,

Yuchen
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150514/c50365af/attachment-0001.html>

From even.rouault at spatialys.com  Thu May 14 08:16:33 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 14 May 2015 17:16:33 +0200
Subject: [gdal-dev] GDAL no longer compile under Windows
In-Reply-To: <f855ea20-9abc-4067-9ee5-abbe2f7c7e93@getmailbird.com>
References: <f855ea20-9abc-4067-9ee5-abbe2f7c7e93@getmailbird.com>
Message-ID: <1431616593.5554bc5188cec@imp.free.fr>

Selon Yuchen Zhong <yuchen at avenza.com>:

> Hello all,
>
> For some reason, GDAL no longer compile after this check in (commit) on May
> 3rd, 2015:??
>

Yuchen

"no longer compiles" is not precise enough. Please report the exact error
messages.


> Add imagery (satellite or aerial) metadata support (DigitalGlobe, GeoEye,
> OrbView, Landsat, Pleiades, Resurs-DK1).
> git-svn-id: https://svn.osgeo.org/gdal/trunk at 29123
> f0d54148-0727-0410-94bb-9a71ac55c965

Did you try more recent revisions ? There was a temporary breakage that has been
fixed in later revisions.

The builds at http://archive.gisinternals.com/sdk/ succeeds with latest
revisions

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From yuchen at avenza.com  Thu May 14 08:37:47 2015
From: yuchen at avenza.com (Yuchen Zhong)
Date: Thu, 14 May 2015 11:37:47 -0400
Subject: [gdal-dev] GDAL no longer compile under Windows
In-Reply-To: <1431616593.5554bc5188cec@imp.free.fr>
References: <f855ea20-9abc-4067-9ee5-abbe2f7c7e93@getmailbird.com>
	<1431616593.5554bc5188cec@imp.free.fr>
Message-ID: <dc914b3b-03e8-401e-82ac-73f0146a7c8a@getmailbird.com>

Hello Even,

Basically, there are a number of files not found. I guess there must be an error in build script? I notice that gcore/makefile.vc was modified in that commit. It builds fine for the last commit on May 2, 2015.?

Here is an example of the error message (I also attached the entire compile log in this email for your reference):?

c1xx : fatal error C1083: Cannot open source file: 'gdaljp2metadatagenerator.cpp': No such file or directory
Generating Code...
NMAKE : fatal error U1077: '"C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\BIN\cl.EXE"' : return code '0x2'
Stop.

Best regards,
Yuchen


Sent from Mailbird [http://www.getmailbird.com/?utm_source=Mailbird&amp;utm_medium=email&amp;utm_campaign=sent-from-mailbird]
On 2015-05-14 11:15:34 AM, Even Rouault <even.rouault at spatialys.com> wrote:
Selon Yuchen Zhong :

> Hello all,
>
> For some reason, GDAL no longer compile after this check in (commit) on May
> 3rd, 2015:??
>

Yuchen

"no longer compiles" is not precise enough. Please report the exact error
messages.


> Add imagery (satellite or aerial) metadata support (DigitalGlobe, GeoEye,
> OrbView, Landsat, Pleiades, Resurs-DK1).
> git-svn-id: https://svn.osgeo.org/gdal/trunk at 29123
> f0d54148-0727-0410-94bb-9a71ac55c965

Did you try more recent revisions ? There was a temporary breakage that has been
fixed in later revisions.

The builds at http://archive.gisinternals.com/sdk/ succeeds with latest
revisions

Even

--
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150514/aacdd786/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: build gdal log.zip
Type: application/x-zip-compressed
Size: 14678 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150514/aacdd786/attachment.bin>

From even.rouault at spatialys.com  Thu May 14 08:41:58 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 14 May 2015 17:41:58 +0200
Subject: [gdal-dev] GDAL no longer compile under Windows
In-Reply-To: <dc914b3b-03e8-401e-82ac-73f0146a7c8a@getmailbird.com>
References: <f855ea20-9abc-4067-9ee5-abbe2f7c7e93@getmailbird.com>
	<1431616593.5554bc5188cec@imp.free.fr>
	<dc914b3b-03e8-401e-82ac-73f0146a7c8a@getmailbird.com>
Message-ID: <1431618118.5554c2462b4a8@imp.free.fr>

Selon Yuchen Zhong <yuchen at avenza.com>:

> Hello Even,
>
> Basically, there are a number of files not found. I guess there must be an
> error in build script? I notice that gcore/makefile.vc was modified in that
> commit. It builds fine for the last commit on May 2, 2015.??
>
> Here is an example of the error message (I also attached the entire compile
> log in this email for your reference):??
>
> c1xx : fatal error C1083: Cannot open source file:
> 'gdaljp2metadatagenerator.cpp': No such file or directory
> Generating Code...
> NMAKE : fatal error U1077: '"C:\Program Files (x86)\Microsoft Visual Studio
> 10.0\VC\BIN\cl.EXE"' : return code '0x2'
> Stop.

Yes that reminds me of the error that was fixed in a later revision. So svn
update.

>
> Best regards,
> Yuchen
>
>
> Sent from Mailbird
>
[http://www.getmailbird.com/?utm_source=Mailbird&amp;utm_medium=email&amp;utm_campaign=sent-from-mailbird]
> On 2015-05-14 11:15:34 AM, Even Rouault <even.rouault at spatialys.com> wrote:
> Selon Yuchen Zhong :
>
> > Hello all,
> >
> > For some reason, GDAL no longer compile after this check in (commit) on May
> > 3rd, 2015:????
> >
>
> Yuchen
>
> "no longer compiles" is not precise enough. Please report the exact error
> messages.
>
>
> > Add imagery (satellite or aerial) metadata support (DigitalGlobe, GeoEye,
> > OrbView, Landsat, Pleiades, Resurs-DK1).
> > git-svn-id: https://svn.osgeo.org/gdal/trunk at 29123
> > f0d54148-0727-0410-94bb-9a71ac55c965
>
> Did you try more recent revisions ? There was a temporary breakage that has
> been
> fixed in later revisions.
>
> The builds at http://archive.gisinternals.com/sdk/ succeeds with latest
> revisions
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From yuchen at avenza.com  Thu May 14 10:59:48 2015
From: yuchen at avenza.com (Yuchen Zhong)
Date: Thu, 14 May 2015 13:59:48 -0400
Subject: [gdal-dev] GDAL no longer compile under Windows
In-Reply-To: <1431618118.5554c2462b4a8@imp.free.fr>
References: <f855ea20-9abc-4067-9ee5-abbe2f7c7e93@getmailbird.com>
	<1431616593.5554bc5188cec@imp.free.fr>
	<dc914b3b-03e8-401e-82ac-73f0146a7c8a@getmailbird.com>
	<1431618118.5554c2462b4a8@imp.free.fr>
Message-ID: <7ed35153-db51-49d4-80f3-555581651e24@getmailbird.com>

Hello Even,?

I tried with the latest version for today. It is working with my previous build script.?
However, if I add DEBUG to it, it will give a lot of errors (different errors this time).?

Here is an example:?

reader_kompsat.cpp
reader_kompsat.cpp : fatal error C1033: cannot open program database 'c:\gdal200.pdb'
Generating Code...
NMAKE : fatal error U1077: '"C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\BIN\cl.EXE"' : return code '0x2'
Stop.

Similarly, it was alright before May 2. I guess it is only partially fixed??

Yuchen


Sent from Mailbird [http://www.getmailbird.com/?utm_source=Mailbird&amp;utm_medium=email&amp;utm_campaign=sent-from-mailbird]
On 2015-05-14 11:40:59 AM, Even Rouault <even.rouault at spatialys.com> wrote:
Selon Yuchen Zhong :

> Hello Even,
>
> Basically, there are a number of files not found. I guess there must be an
> error in build script? I notice that gcore/makefile.vc was modified in that
> commit. It builds fine for the last commit on May 2, 2015.??
>
> Here is an example of the error message (I also attached the entire compile
> log in this email for your reference):??
>
> c1xx : fatal error C1083: Cannot open source file:
> 'gdaljp2metadatagenerator.cpp': No such file or directory
> Generating Code...
> NMAKE : fatal error U1077: '"C:\Program Files (x86)\Microsoft Visual Studio
> 10.0\VC\BIN\cl.EXE"' : return code '0x2'
> Stop.

Yes that reminds me of the error that was fixed in a later revision. So svn
update.

>
> Best regards,
> Yuchen
>
>
> Sent from Mailbird
>
[http://www.getmailbird.com/?utm_source=Mailbird&utm_medium=email&utm_campaign=sent-from-mailbird]
> On 2015-05-14 11:15:34 AM, Even Rouault wrote:
> Selon Yuchen Zhong :
>
> > Hello all,
> >
> > For some reason, GDAL no longer compile after this check in (commit) on May
> > 3rd, 2015:????
> >
>
> Yuchen
>
> "no longer compiles" is not precise enough. Please report the exact error
> messages.
>
>
> > Add imagery (satellite or aerial) metadata support (DigitalGlobe, GeoEye,
> > OrbView, Landsat, Pleiades, Resurs-DK1).
> > git-svn-id: https://svn.osgeo.org/gdal/trunk at 29123
> > f0d54148-0727-0410-94bb-9a71ac55c965
>
> Did you try more recent revisions ? There was a temporary breakage that has
> been
> fixed in later revisions.
>
> The builds at http://archive.gisinternals.com/sdk/ succeeds with latest
> revisions
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>


--
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150514/64baa20f/attachment.html>

From even.rouault at spatialys.com  Thu May 14 11:31:14 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 14 May 2015 20:31:14 +0200
Subject: [gdal-dev] GDAL no longer compile under Windows
In-Reply-To: <bf268731-4181-4ead-978a-2d0fa8c5d838@getmailbird.com>
References: <f855ea20-9abc-4067-9ee5-abbe2f7c7e93@getmailbird.com>
	<1431616593.5554bc5188cec@imp.free.fr>
	<dc914b3b-03e8-401e-82ac-73f0146a7c8a@getmailbird.com>
	<1431618118.5554c2462b4a8@imp.free.fr>
	<7ed35153-db51-49d4-80f3-555581651e24@getmailbird.com>
	<bf268731-4181-4ead-978a-2d0fa8c5d838@getmailbird.com>
Message-ID: <1431628274.5554e9f25e609@imp.free.fr>

Selon Yuchen Zhong <yuchen at avenza.com>:

> Hello,
>
> Sorry my mail client just crashed and the draft message was send somehow.??
>
> Here is the build script that I used:??
>
> call "C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\vcvarsall.bat" >
> ..\make_gdal_call_log.txt 2>&1
> nmake /f makefile.vc clean > ..\make_gdal_clean_log.txt 2>&1
> nmake /f makefile.vc DEBUG=1 > ..\make_gdal_compile_log.txt 2>&1
>
> And also attached a log file. Again, the same script works all fine before
> May 2, 2015.??

Yuchen,

I've just committed something that should hopefully fix it. Seems nobody has
done a Windows debug build recently.

Even

>
> Best regards,
> Yuchen
>
> Sent from Mailbird
>
[http://www.getmailbird.com/?utm_source=Mailbird&amp;utm_medium=email&amp;utm_campaign=sent-from-mailbird]
> On 2015-05-14 1:59:04 PM, Yuchen Zhong <yuchen at avenza.com> wrote:
> Hello Even,??
>
> I tried with the latest version for today. It is working with my previous
> build script.??
> However, if I add DEBUG to it, it will give a lot of errors (different errors
> this time).??
>
> Here is an example:??
>
> reader_kompsat.cpp
> reader_kompsat.cpp : fatal error C1033: cannot open program database
> 'c:\gdal200.pdb'
> Generating Code...
> NMAKE : fatal error U1077: '"C:\Program Files (x86)\Microsoft Visual Studio
> 10.0\VC\BIN\cl.EXE"' : return code '0x2'
> Stop.
>
> Similarly, it was alright before May 2. I guess it is only partially fixed???
>
> Yuchen
>
>
> Sent from Mailbird
>
[http://www.getmailbird.com/?utm_source=Mailbird&amp;utm_medium=email&amp;utm_campaign=sent-from-mailbird]
> On 2015-05-14 11:40:59 AM, Even Rouault <even.rouault at spatialys.com> wrote:
> Selon Yuchen Zhong :
>
> > Hello Even,
> >
> > Basically, there are a number of files not found. I guess there must be an
> > error in build script? I notice that gcore/makefile.vc was modified in that
> > commit. It builds fine for the last commit on May 2, 2015.????
> >
> > Here is an example of the error message (I also attached the entire compile
> > log in this email for your reference):????
> >
> > c1xx : fatal error C1083: Cannot open source file:
> > 'gdaljp2metadatagenerator.cpp': No such file or directory
> > Generating Code...
> > NMAKE : fatal error U1077: '"C:\Program Files (x86)\Microsoft Visual Studio
> > 10.0\VC\BIN\cl.EXE"' : return code '0x2'
> > Stop.
>
> Yes that reminds me of the error that was fixed in a later revision. So svn
> update.
>
> >
> > Best regards,
> > Yuchen
> >
> >
> > Sent from Mailbird
> >
>
[http://www.getmailbird.com/?utm_source=Mailbird&utm_medium=email&utm_campaign=sent-from-mailbird]
> > On 2015-05-14 11:15:34 AM, Even Rouault wrote:
> > Selon Yuchen Zhong :
> >
> > > Hello all,
> > >
> > > For some reason, GDAL no longer compile after this check in (commit) on
> May
> > > 3rd, 2015:?????????
> > >
> >
> > Yuchen
> >
> > "no longer compiles" is not precise enough. Please report the exact error
> > messages.
> >
> >
> > > Add imagery (satellite or aerial) metadata support (DigitalGlobe, GeoEye,
> > > OrbView, Landsat, Pleiades, Resurs-DK1).
> > > git-svn-id: https://svn.osgeo.org/gdal/trunk at 29123
> > > f0d54148-0727-0410-94bb-9a71ac55c965
> >
> > Did you try more recent revisions ? There was a temporary breakage that has
> > been
> > fixed in later revisions.
> >
> > The builds at http://archive.gisinternals.com/sdk/ succeeds with latest
> > revisions
> >
> > Even
> >
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com
> >
>
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From nik at nikosalexandris.net  Thu May 14 12:25:57 2015
From: nik at nikosalexandris.net (Nikos Alexandris)
Date: Thu, 14 May 2015 22:25:57 +0300
Subject: [gdal-dev] Reading the TerrainBase 1995 dataset (.BIN + .HDR)
 with gdal?
In-Reply-To: <1431613638.5554b0c66ce32@imp.free.fr>
References: <20150514134057.GA3096@tpx1c2g>
	<1431613638.5554b0c66ce32@imp.free.fr>
Message-ID: <20150514192557.GB3096@tpx1c2g>


Nikos Alexandris:
 
> > Hi gdalers,
> > has anyone read the TerrainBase data set (NOOA, 1995) using gdal tools?
> > The link to the relevant CD is:
> > http://webapp1.dlib.indiana.edu/virtual_disk_library/index.cgi/6081153/FID3260
> > (see for example inside the DATA directory)

Even Rouault:

> The .HDR file contains the same information as in the ESRI .HDR
> format, but with a different format, so it is not automatically
> recognized. From the info in the .HDR you can build a VRT file
> (http://gdal.org/gdal_vrttut.html ) referencing the .BIN. For example
> for AFRICA.BIN :

> <VRTDataset rasterXSize="984" rasterYSize="900">
>   <SRS>WGS84</SRS>
>  
> <GeoTransform>-26.041666666,0.08333333,0,40.041666666,0,-0.08333333</GeoTransform>
>   <VRTRasterBand dataType="Int16" band="1" subClass="VRTRawRasterBand">
>     <SourceFilename relativeToVRT="1">AFRICA.BIN</SourceFilename>
>   </VRTRasterBand>
> </VRTDataset>
> 
> Otherwise you can find free DEMs as GeoTIFF at http://srtm.csi.cgiar.org/ (at a
> much higher resolution)

Milles mercis.

For the matter, resolution is not of concern in my current use-case. This particular data set
has been used to build the global "Linke Turbidity Factor" database offered by
SoDa/HelioClim [0][1][2]. Hence, it might be of interest for research involving "Linke
Turbidity", such as estimations of solar irradiation.

Nikos

--
[0] http://www.soda-is.com/eng/services/linke_turbidity_maps_info.html
[1] http://www.soda-is.com/linke/linke_helioserve.html
[2] http://www.soda-is.com/publications/ises2003_linke.pdf

From yuchen at avenza.com  Thu May 14 13:33:28 2015
From: yuchen at avenza.com (Yuchen Zhong)
Date: Thu, 14 May 2015 16:33:28 -0400
Subject: [gdal-dev] GDAL no longer compile under Windows
In-Reply-To: <1431628274.5554e9f25e609@imp.free.fr>
References: <f855ea20-9abc-4067-9ee5-abbe2f7c7e93@getmailbird.com>
	<1431616593.5554bc5188cec@imp.free.fr>
	<dc914b3b-03e8-401e-82ac-73f0146a7c8a@getmailbird.com>
	<1431618118.5554c2462b4a8@imp.free.fr>
	<7ed35153-db51-49d4-80f3-555581651e24@getmailbird.com>
	<bf268731-4181-4ead-978a-2d0fa8c5d838@getmailbird.com>
	<1431628274.5554e9f25e609@imp.free.fr>
Message-ID: <aaaca4d4-e796-43cc-914d-229b055c8c07@getmailbird.com>

Hello Even,

Just tried. That totally fixes it. Thank you!

Yuchen


Sent from Mailbird [http://www.getmailbird.com/?utm_source=Mailbird&amp;utm_medium=email&amp;utm_campaign=sent-from-mailbird]
On 2015-05-14 2:30:18 PM, Even Rouault <even.rouault at spatialys.com> wrote:
Selon Yuchen Zhong :

> Hello,
>
> Sorry my mail client just crashed and the draft message was send somehow.??
>
> Here is the build script that I used:??
>
> call "C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\vcvarsall.bat" >
> ..\make_gdal_call_log.txt 2>&1
> nmake /f makefile.vc clean > ..\make_gdal_clean_log.txt 2>&1
> nmake /f makefile.vc DEBUG=1 > ..\make_gdal_compile_log.txt 2>&1
>
> And also attached a log file. Again, the same script works all fine before
> May 2, 2015.??

Yuchen,

I've just committed something that should hopefully fix it. Seems nobody has
done a Windows debug build recently.

Even

>
> Best regards,
> Yuchen
>
> Sent from Mailbird
>
[http://www.getmailbird.com/?utm_source=Mailbird&utm_medium=email&utm_campaign=sent-from-mailbird]
> On 2015-05-14 1:59:04 PM, Yuchen Zhong wrote:
> Hello Even,??
>
> I tried with the latest version for today. It is working with my previous
> build script.??
> However, if I add DEBUG to it, it will give a lot of errors (different errors
> this time).??
>
> Here is an example:??
>
> reader_kompsat.cpp
> reader_kompsat.cpp : fatal error C1033: cannot open program database
> 'c:\gdal200.pdb'
> Generating Code...
> NMAKE : fatal error U1077: '"C:\Program Files (x86)\Microsoft Visual Studio
> 10.0\VC\BIN\cl.EXE"' : return code '0x2'
> Stop.
>
> Similarly, it was alright before May 2. I guess it is only partially fixed???
>
> Yuchen
>
>
> Sent from Mailbird
>
[http://www.getmailbird.com/?utm_source=Mailbird&utm_medium=email&utm_campaign=sent-from-mailbird]
> On 2015-05-14 11:40:59 AM, Even Rouault wrote:
> Selon Yuchen Zhong :
>
> > Hello Even,
> >
> > Basically, there are a number of files not found. I guess there must be an
> > error in build script? I notice that gcore/makefile.vc was modified in that
> > commit. It builds fine for the last commit on May 2, 2015.????
> >
> > Here is an example of the error message (I also attached the entire compile
> > log in this email for your reference):????
> >
> > c1xx : fatal error C1083: Cannot open source file:
> > 'gdaljp2metadatagenerator.cpp': No such file or directory
> > Generating Code...
> > NMAKE : fatal error U1077: '"C:\Program Files (x86)\Microsoft Visual Studio
> > 10.0\VC\BIN\cl.EXE"' : return code '0x2'
> > Stop.
>
> Yes that reminds me of the error that was fixed in a later revision. So svn
> update.
>
> >
> > Best regards,
> > Yuchen
> >
> >
> > Sent from Mailbird
> >
>
[http://www.getmailbird.com/?utm_source=Mailbird&utm_medium=email&utm_campaign=sent-from-mailbird]
> > On 2015-05-14 11:15:34 AM, Even Rouault wrote:
> > Selon Yuchen Zhong :
> >
> > > Hello all,
> > >
> > > For some reason, GDAL no longer compile after this check in (commit) on
> May
> > > 3rd, 2015:?????????
> > >
> >
> > Yuchen
> >
> > "no longer compiles" is not precise enough. Please report the exact error
> > messages.
> >
> >
> > > Add imagery (satellite or aerial) metadata support (DigitalGlobe, GeoEye,
> > > OrbView, Landsat, Pleiades, Resurs-DK1).
> > > git-svn-id: https://svn.osgeo.org/gdal/trunk at 29123
> > > f0d54148-0727-0410-94bb-9a71ac55c965
> >
> > Did you try more recent revisions ? There was a temporary breakage that has
> > been
> > fixed in later revisions.
> >
> > The builds at http://archive.gisinternals.com/sdk/ succeeds with latest
> > revisions
> >
> > Even
> >
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com
> >
>
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>


--
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150514/8d42e347/attachment.html>

From nik at nikosalexandris.net  Thu May 14 21:02:26 2015
From: nik at nikosalexandris.net (Nikos Alexandris)
Date: Fri, 15 May 2015 07:02:26 +0300
Subject: [gdal-dev] Reading the TerrainBase 1995 dataset (.BIN + .HDR)
 with gdal?
In-Reply-To: <1431613638.5554b0c66ce32@imp.free.fr>
References: <20150514134057.GA3096@tpx1c2g>
	<1431613638.5554b0c66ce32@imp.free.fr>
Message-ID: <20150515040226.GB14935@tpx1c2g>


Nikos Alexandris:
 
> > Hi gdalers,
> > has anyone read the TerrainBase data set (NOOA, 1995) using gdal tools?
> > The link to the relevant CD is:
> > http://webapp1.dlib.indiana.edu/virtual_disk_library/index.cgi/6081153/FID3260
> > (see for example inside the DATA directory)

Even Rouault:

> Nikos,
> 
> The .HDR file contains the same information as in the ESRI .HDR format, but with
> a different format, so it is not automatically recognized.
> 
> From the info in the .HDR you can build a VRT file (
> http://gdal.org/gdal_vrttut.html ) referencing the .BIN. For example
> for AFRICA.BIN :
> 
> <VRTDataset rasterXSize="984" rasterYSize="900">
>   <SRS>WGS84</SRS>
>  
> <GeoTransform>-26.041666666,0.08333333,0,40.041666666,0,-0.08333333</GeoTransform>
>   <VRTRasterBand dataType="Int16" band="1" subClass="VRTRawRasterBand">
>     <SourceFilename relativeToVRT="1">AFRICA.BIN</SourceFilename>
>   </VRTRasterBand>
> </VRTDataset>

Where do the fine digits +0.041666666 (for x and y) come from, as the reference corner coordinates are -26.0, 40.0?

Then, for EUROPE:

<VRTDataset rasterXSize="1140" rasterYSize="540">
  <SRS>WGS84</SRS>

<GeoTransform>-25.041666666,0.08333333,0,75.041666666,0,-0.08333333</GeoTransform>
  <VRTRasterBand dataType="Int16" band="1" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">EUROPE.BIN</SourceFilename>
  </VRTRasterBand>
</VRTDataset>

Imported normally in GRASS GIS :-)

Nikos

From even.rouault at spatialys.com  Fri May 15 00:08:27 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 15 May 2015 09:08:27 +0200
Subject: [gdal-dev] Reading the TerrainBase 1995 dataset (.BIN + .HDR)
	with gdal?
In-Reply-To: <20150515040226.GB14935@tpx1c2g>
References: <20150514134057.GA3096@tpx1c2g>
	<1431613638.5554b0c66ce32@imp.free.fr>
	<20150515040226.GB14935@tpx1c2g>
Message-ID: <1431673707.55559b6bbf531@imp.free.fr>

> Where do the fine digits +0.041666666 (for x and y) come from, as the
> reference corner coordinates are -26.0, 40.0?

>From "grid_cell_registration  = center of cell". GDAL convention for
registration is upper left corner of uppler left pixel, so you have to shift the
reference corner coordinates of the HDR by a half pixel to the north west.


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From dengo at gmx.net  Fri May 15 01:18:58 2015
From: dengo at gmx.net (Dennis Gocke)
Date: Fri, 15 May 2015 10:18:58 +0200
Subject: [gdal-dev] EarthWatch/DigitalGlobe .TIL format geotransform origin
	shifted
Message-ID: <CALqbEi5SYBFTiTfGPBB94C9JRCTKKzHDkWuv_7k88752v+Xwaw@mail.gmail.com>

Hey guys,



We have DigitalGlobe image strips which come with a *.til file.

The geotransform of the til and the separate images have a shift of half a
pixel when opened with GDAL.

The reason is that in the GDAL TIL driver the coordinates are treated as
outer pixel edge, where as it seems like they describe the pixel center, at
least in our cases.

Does  anyone know of a description for the TIL format to verify if the GDAL
driver or the TILs from DigitalGlobe are wrong?

For now we fixed it on our side, but you might consider changing the TIL
driver to treat the coordinates as pixel center.



Best Regards,

Dennis
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150515/45344d12/attachment.html>

From even.rouault at spatialys.com  Fri May 15 01:48:19 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 15 May 2015 10:48:19 +0200
Subject: [gdal-dev] EarthWatch/DigitalGlobe .TIL format geotransform
	origin shifted
In-Reply-To: <CALqbEi5SYBFTiTfGPBB94C9JRCTKKzHDkWuv_7k88752v+Xwaw@mail.gmail.com>
References: <CALqbEi5SYBFTiTfGPBB94C9JRCTKKzHDkWuv_7k88752v+Xwaw@mail.gmail.com>
Message-ID: <1431679699.5555b2d3d9d09@imp.free.fr>

Dennis,

https://www.digitalglobe.com/sites/default/files/ISD_External.pdf indeed
confirms your findings (page 37 & 38, doc of originX and ulX)

Fixed per http://trac.osgeo.org/gdal/ticket/5961

Even

> Hey guys,
>
>
>
> We have DigitalGlobe image strips which come with a *.til file.
>
> The geotransform of the til and the separate images have a shift of half a
> pixel when opened with GDAL.
>
> The reason is that in the GDAL TIL driver the coordinates are treated as
> outer pixel edge, where as it seems like they describe the pixel center, at
> least in our cases.
>
> Does  anyone know of a description for the TIL format to verify if the GDAL
> driver or the TILs from DigitalGlobe are wrong?
>
> For now we fixed it on our side, but you might consider changing the TIL
> driver to treat the coordinates as pixel center.
>
>
>
> Best Regards,
>
> Dennis
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From hema.yeedunuri at amigooptima.in  Fri May 15 02:12:48 2015
From: hema.yeedunuri at amigooptima.in (Hema Yeedunuri)
Date: Fri, 15 May 2015 14:42:48 +0530
Subject: [gdal-dev] match bounding box of two geometries of two different
	shape files
Message-ID: <CA+8Q=fB=ELbLewYBQsGHnBz1YAOnZYc6=H9qnfoQNRrq8TP+YQ@mail.gmail.com>

Hi all ,

I have two vectors one is of country (in black)and the other is
corresponding states(in red) of the country.There is some variation with
the overlaping of these two vectors as shown below.How should i match both
the files so that the red one exactly falls on the black one .Please find
the img in attachments

thanks & regards,
hema
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150515/833b5218/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: vector.png
Type: image/png
Size: 3334 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150515/833b5218/attachment.png>

From dengo at gmx.net  Fri May 15 04:48:32 2015
From: dengo at gmx.net (Dennis Gocke)
Date: Fri, 15 May 2015 13:48:32 +0200
Subject: [gdal-dev] EarthWatch/DigitalGlobe .TIL format geotransform
 origin shifted
In-Reply-To: <1431679699.5555b2d3d9d09@imp.free.fr>
References: <CALqbEi5SYBFTiTfGPBB94C9JRCTKKzHDkWuv_7k88752v+Xwaw@mail.gmail.com>
	<1431679699.5555b2d3d9d09@imp.free.fr>
Message-ID: <CALqbEi6PUvj4G_jeQhUG--ZHjOQZsjnhQ=0Y4PxNXdZ6A4BecQ@mail.gmail.com>

Hi Even,

thanks for confirming and fixing the issue.

Best Regards,
Dennis

On Fri, May 15, 2015 at 10:48 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Dennis,
>
> https://www.digitalglobe.com/sites/default/files/ISD_External.pdf indeed
> confirms your findings (page 37 & 38, doc of originX and ulX)
>
> Fixed per http://trac.osgeo.org/gdal/ticket/5961
>
> Even
>
> > Hey guys,
> >
> >
> >
> > We have DigitalGlobe image strips which come with a *.til file.
> >
> > The geotransform of the til and the separate images have a shift of half
> a
> > pixel when opened with GDAL.
> >
> > The reason is that in the GDAL TIL driver the coordinates are treated as
> > outer pixel edge, where as it seems like they describe the pixel center,
> at
> > least in our cases.
> >
> > Does  anyone know of a description for the TIL format to verify if the
> GDAL
> > driver or the TILs from DigitalGlobe are wrong?
> >
> > For now we fixed it on our side, but you might consider changing the TIL
> > driver to treat the coordinates as pixel center.
> >
> >
> >
> > Best Regards,
> >
> > Dennis
> >
>
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150515/f6a62378/attachment.html>

From hema.yeedunuri at amigooptima.in  Fri May 15 05:19:32 2015
From: hema.yeedunuri at amigooptima.in (Hema Yeedunuri)
Date: Fri, 15 May 2015 17:49:32 +0530
Subject: [gdal-dev] match bounding box of two geometries of two
	different shape files
In-Reply-To: <CA+8Q=fB=ELbLewYBQsGHnBz1YAOnZYc6=H9qnfoQNRrq8TP+YQ@mail.gmail.com>
References: <CA+8Q=fB=ELbLewYBQsGHnBz1YAOnZYc6=H9qnfoQNRrq8TP+YQ@mail.gmail.com>
Message-ID: <CA+8Q=fBHzxRPme1AUARvJGxi+do8MpeR_t=R7zn0Mz7YNn+S-Q@mail.gmail.com>

Hi All,

To be more clear I have attached better images that would explain problem.
I have to exactly fit the  vector img 1.png into vector image 2.png .I have
the 3.png where we can see that the two vectors doesnt fit properly i,e
1.png vector should exactly overlap on 2.png vector .How can it be done.

thanks,
Hema

On Fri, May 15, 2015 at 2:42 PM, Hema Yeedunuri <
hema.yeedunuri at amigooptima.in> wrote:

> Hi all ,
>
> I have two vectors one is of country (in black)and the other is
> corresponding states(in red) of the country.There is some variation with
> the overlaping of these two vectors as shown below.How should i match both
> the files so that the red one exactly falls on the black one .Please find
> the img in attachments
>
> thanks & regards,
> hema
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150515/08f4b784/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 3.png
Type: image/png
Size: 14076 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150515/08f4b784/attachment-0003.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 2.png
Type: image/png
Size: 10710 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150515/08f4b784/attachment-0004.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 1.png
Type: image/png
Size: 5089 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150515/08f4b784/attachment-0005.png>

From yutaxsato at gmail.com  Sat May 16 21:44:23 2015
From: yutaxsato at gmail.com (Yuta Sato)
Date: Sun, 17 May 2015 13:44:23 +0900
Subject: [gdal-dev] Pixel Shifts When Warping
Message-ID: <CAPqnkJTAqeYroew0Us5SH_Xq9EBNEis3LAwQJ5jJJEq2R-7xVw@mail.gmail.com>

Dear GDAL and Proj Developers and Users:

I am really frustrated when the MODIS HDF file converted into GeoTiff with
GCS projection never match with the same MODIS file  converted from MODIS
Reprojection tool.

The file I am working is here:

http://e4ftl01.cr.usgs.gov/MOTA/MCD43A4.005/2015.01.01/MCD43A4.A2015001.h26v05.005.2015027224017.hdf

I used the following parameters for gdalwarp:

-t_srs wgs84 -tr 0.004166666666667 0.004166666666667


I used the following parameters for MRT:

OUTPUT_PIXEL_SIZE = 0.004166666666667
DATUM = WGS84
OUTPUT_PROJECTION_TYPE = GEO

The image produced from MRT has:
size = 6025*2400
point-based
ulx, uly = 92.3799071,  40.0000000

The image produced from gdalwarp has:
size = 6027*2400
area based
ulx, uly = 92.3760431,  40.0000000

Do you have any idea on which is more precise: gdalwarp or MRT? Or there is
any way in gdalwarp to get the same image as MRT gives?

Any idea and experience is highly appreciated. Thank you very much in the
advance!

Sincerely yours,
yuta sato
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150517/988d5074/attachment.html>

From neteler at osgeo.org  Sun May 17 03:54:44 2015
From: neteler at osgeo.org (Markus Neteler)
Date: Sun, 17 May 2015 12:54:44 +0200
Subject: [gdal-dev] [Proj] Pixel Shifts When Warping
In-Reply-To: <CAPqnkJTAqeYroew0Us5SH_Xq9EBNEis3LAwQJ5jJJEq2R-7xVw@mail.gmail.com>
References: <CAPqnkJTAqeYroew0Us5SH_Xq9EBNEis3LAwQJ5jJJEq2R-7xVw@mail.gmail.com>
Message-ID: <CALFmHht5rnEy0+dJwsvniC1q3=wDpUfKqQcHC69Edf7u+s0uXg@mail.gmail.com>

On Sun, May 17, 2015 at 6:44 AM, Yuta Sato <yutaxsato at gmail.com> wrote:
> Dear GDAL and Proj Developers and Users:
>
> I am really frustrated when the MODIS HDF file converted into GeoTiff with
> GCS projection never match with the same MODIS file  converted from MODIS
> Reprojection tool.

We had this issue in the past, too, for our "EuroLST" project
(gap-filling of all LST maps for Europe, see
http://gis.cri.fmach.it/eurolst/).
Solved since then, see below.

...
> Do you have any idea on which is more precise: gdalwarp or MRT? Or there is
> any way in gdalwarp to get the same image as MRT gives?

You may take a look at
http://pymodis.fem-environment.eu/

pyModis >= 1.0 comes with fast GDAL support (way faster than MRT).

The details of the gdalwarp usage you find in the source code here:
https://github.com/lucadelu/pyModis/blob/master/pymodis/convertmodis_gdal.py


Hope this helps,
Markus

--
http://courses.neteler.org
http://gis.cri.fmach.it/neteler/
http://grass.osgeo.org/

From landa.martin at gmail.com  Sun May 17 04:15:25 2015
From: landa.martin at gmail.com (Martin Landa)
Date: Sun, 17 May 2015 13:15:25 +0200
Subject: [gdal-dev] FATAL: CPLGetTLSList(): pthread_setspecific() failed!
Message-ID: <CA+Ei1OdJkbM0nrvtRVw4y-Rgke65nBkD5YqD0JGBMSXA3G9+wg@mail.gmail.com>

Hi,

with recent build of trunk I am getting error in CPLGetTLSList(). Any
idea how to solve this issue?

GNU/Debian unstable
g++ (Debian 4.9.2-16) 4.9.2

        CFLAGS="-Wall -g" CXXFLAGS="-Wall -g" \
            ./configure --prefix=/usr/local --enable-debug
--mandir=/usr/local/share \
            --with-sqlite3 --with-spatialite=/usr/local --with-python \
            --with-gnu-ld --with-threads --with-opencl

$ ogrinfo --formats

 HTTP -raster,vector- (ro): HTTP Fetching Wrapper
GDAL: In GDALDestroy - unloading GDAL shared library.
FATAL: CPLGetTLSList(): pthread_setspecific() failed!
Aborted

Thanks in advance, Martin

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.cz/mentors/landa

From even.rouault at spatialys.com  Sun May 17 04:28:00 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 17 May 2015 13:28:00 +0200
Subject: [gdal-dev] FATAL: CPLGetTLSList(): pthread_setspecific() failed!
In-Reply-To: <CA+Ei1OdJkbM0nrvtRVw4y-Rgke65nBkD5YqD0JGBMSXA3G9+wg@mail.gmail.com>
References: <CA+Ei1OdJkbM0nrvtRVw4y-Rgke65nBkD5YqD0JGBMSXA3G9+wg@mail.gmail.com>
Message-ID: <201505171328.00522.even.rouault@spatialys.com>

Le dimanche 17 mai 2015 13:15:25, Martin Landa a ?crit :
> Hi,
> 
> with recent build of trunk I am getting error in CPLGetTLSList(). Any
> idea how to solve this issue?
> 
> GNU/Debian unstable
> g++ (Debian 4.9.2-16) 4.9.2
> 
>         CFLAGS="-Wall -g" CXXFLAGS="-Wall -g" \
>             ./configure --prefix=/usr/local --enable-debug
> --mandir=/usr/local/share \
>             --with-sqlite3 --with-spatialite=/usr/local --with-python \
>             --with-gnu-ld --with-threads --with-opencl
> 
> $ ogrinfo --formats
> 
>  HTTP -raster,vector- (ro): HTTP Fetching Wrapper
> GDAL: In GDALDestroy - unloading GDAL shared library.
> FATAL: CPLGetTLSList(): pthread_setspecific() failed!
> Aborted

Martin,

Is this is a clean build ?
There has been no change in recent weeks in cpl_multiproc.cpp.
Do you have plugins ?
What happens when running under Valgrind ?

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Sun May 17 04:32:21 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 17 May 2015 13:32:21 +0200
Subject: [gdal-dev] [Proj] Pixel Shifts When Warping
In-Reply-To: <CALFmHht5rnEy0+dJwsvniC1q3=wDpUfKqQcHC69Edf7u+s0uXg@mail.gmail.com>
References: <CAPqnkJTAqeYroew0Us5SH_Xq9EBNEis3LAwQJ5jJJEq2R-7xVw@mail.gmail.com>
	<CALFmHht5rnEy0+dJwsvniC1q3=wDpUfKqQcHC69Edf7u+s0uXg@mail.gmail.com>
Message-ID: <201505171332.21954.even.rouault@spatialys.com>

Le dimanche 17 mai 2015 12:54:44, Markus Neteler a ?crit :
> On Sun, May 17, 2015 at 6:44 AM, Yuta Sato <yutaxsato at gmail.com> wrote:
> > Dear GDAL and Proj Developers and Users:
> > 
> > I am really frustrated when the MODIS HDF file converted into GeoTiff
> > with GCS projection never match with the same MODIS file  converted from
> > MODIS Reprojection tool.
> 
> We had this issue in the past, too, for our "EuroLST" project
> (gap-filling of all LST maps for Europe, see
> http://gis.cri.fmach.it/eurolst/).
> Solved since then, see below.
> 
> ...
> 
> > Do you have any idea on which is more precise: gdalwarp or MRT? Or there
> > is any way in gdalwarp to get the same image as MRT gives?
> 
> You may take a look at
> http://pymodis.fem-environment.eu/
> 
> pyModis >= 1.0 comes with fast GDAL support (way faster than MRT).
> 
> The details of the gdalwarp usage you find in the source code here:
> https://github.com/lucadelu/pyModis/blob/master/pymodis/convertmodis_gdal.p
> y

Markus,

for the sake of my curiosity, could you explain what specific stuff it does 
compared to gdalwarp ? I quickly skimmed through the file and only saw regular 
use of the GDAL warping API. But perhaps I missed something.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From landa.martin at gmail.com  Sun May 17 04:37:14 2015
From: landa.martin at gmail.com (Martin Landa)
Date: Sun, 17 May 2015 13:37:14 +0200
Subject: [gdal-dev] FATAL: CPLGetTLSList(): pthread_setspecific() failed!
In-Reply-To: <201505171328.00522.even.rouault@spatialys.com>
References: <CA+Ei1OdJkbM0nrvtRVw4y-Rgke65nBkD5YqD0JGBMSXA3G9+wg@mail.gmail.com>
	<201505171328.00522.even.rouault@spatialys.com>
Message-ID: <CA+Ei1Odou_XQLVGuJW-X71Ms1y8kFb5Ju0ecrmt0z2Bfxh0rxA@mail.gmail.com>

Hi Even,

2015-05-17 13:28 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:

[...]

> Do you have plugins ?

that was the problem. After removing (outdated) plugins I am not
getting this error. Thanks, Martin

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.cz/mentors/landa

From neteler at osgeo.org  Mon May 18 07:24:08 2015
From: neteler at osgeo.org (Markus Neteler)
Date: Mon, 18 May 2015 16:24:08 +0200
Subject: [gdal-dev] [Proj] Pixel Shifts When Warping
In-Reply-To: <201505171332.21954.even.rouault@spatialys.com>
References: <CAPqnkJTAqeYroew0Us5SH_Xq9EBNEis3LAwQJ5jJJEq2R-7xVw@mail.gmail.com>
	<CALFmHht5rnEy0+dJwsvniC1q3=wDpUfKqQcHC69Edf7u+s0uXg@mail.gmail.com>
	<201505171332.21954.even.rouault@spatialys.com>
Message-ID: <CALFmHhvMXnMfyu4ai6KXU_zJhCaz99fpi-=WtLeRMSJr6HOdBA@mail.gmail.com>

On Sun, May 17, 2015 at 1:32 PM, Even Rouault
<even.rouault at spatialys.com> wrote:
> Le dimanche 17 mai 2015 12:54:44, Markus Neteler a ?crit :
>> On Sun, May 17, 2015 at 6:44 AM, Yuta Sato <yutaxsato at gmail.com> wrote:
>> > Dear GDAL and Proj Developers and Users:
>> >
>> > I am really frustrated when the MODIS HDF file converted into GeoTiff
>> > with GCS projection never match with the same MODIS file  converted from
>> > MODIS Reprojection tool.
>>
>> We had this issue in the past, too, for our "EuroLST" project
>> (gap-filling of all LST maps for Europe, see http://gis.cri.fmach.it/eurolst/).
>> Solved since then, see below.
>> ...
>>
>> > Do you have any idea on which is more precise: gdalwarp or MRT? Or there
>> > is any way in gdalwarp to get the same image as MRT gives?

An addition:

For our EuroLST project we use EU LAEA as target projection. In our
tests (we made a lot) the MRT results came out shifted by 0.5 -1.0
pixel since MRT does not support a datum or ellipsoid for LAEA (LA in
MRT), instead it supports only a sphere when reprojecting from MODIS
sinusoidal.

Using recent GDAL, gdalwarp does the reprojection from MODIS
sinusoidal to EU LAEA correctly.

>> You may take a look at
>> http://pymodis.fem-environment.eu/
>>
>> pyModis >= 1.0 comes with fast GDAL support (way faster than MRT).
>>
>> The details of the gdalwarp usage you find in the source code here:
>> https://github.com/lucadelu/pyModis/blob/master/pymodis/convertmodis_gdal.py
>
> Markus,
>
> for the sake of my curiosity, could you explain what specific stuff it does
> compared to gdalwarp ? I quickly skimmed through the file and only saw regular
> use of the GDAL warping API. But perhaps I missed something.

pyMODIS is a set of scripts and a library to perform the download of
large numbers of MODIS HDF/XML files (think cronjob), it creates a
mosaic of several tiles, it extracts specific information from
bit-encoded MODIS quality assessment layers of different product types
etc.

Essentially a ready to use product which happily uses GDAL as a backend.

Markus

-- 
http://courses.neteler.org
http://gis.cri.fmach.it/neteler/
http://grass.osgeo.org

From eruiz at aplitop.com  Mon May 18 08:04:59 2015
From: eruiz at aplitop.com (Elena Ruiz)
Date: Mon, 18 May 2015 17:04:59 +0200
Subject: [gdal-dev] Error loading ECW images
Message-ID: <77719CE0A8A0FD4C90916F438FABC09D01B7C077@server2k3.aplitop.local>

 

Good Afternoon, we are trying the GDAL Library we have implemented the application which import/export  GeoTiff and Erdas Imagine Files and we haven?t any problem, but now we want to load a ecw image of 1Gb, we are using the file "ecwdataset" with the function "GDALDataset *ECWDataset::Open( GDALOpenInfo * poOpenInfo, int bIsJPEG2000 )" and on line 2497 in the  code below, happen an exception and the application is closed.

 

/* -------------------------------------------------------------------- */

/*      Create band information objects.                                */

/* -------------------------------------------------------------------- */

    for( i=0; i < poDS->psFileInfo->nBands; i++ )

        poDS->SetBand( i+1, new ECWRasterBand( poDS, i+1 ) );

 

We have tried with different Release:

 

release-1700-x64-gdal-1-11-mapserver-6-4.zip and we have installed de plugin for ecw

release-1800-x64.zip

 

and with different version of ECW library, 3.x and 5.x.

 

We need solve this problem, we don't know if the problem is for ECW library, or storage management, or some options, plugin or the release appropriate . 

Thank you for your attention and I look forward to your reply.

 

 

 

________________________________

Elena Ruiz

Sumatra, 9 29190 M?laga. Spain

Programmer.Technical Support

Phone: +34 952 43 97 71

Software Department

Fax: +34 952 43 13 71

	E-mail: eruiz at aplitop.com

	Web: www.aplitop.com

 

 

NOTICE: The information contained in this electronic mail transmission is privileged and confidential, intended for the use of the named individual or entity to which it is directed, whose details are contained in address records belonging to APLITOP, S.L. for the purposes to contact the owner of the data via email. In the event that the recipient of this mail was a provider, distributor or a customer, we inform you that with more information regarding data protection in the legal notice in www.aplitop.com . The addressee is entitled to access, to amend or to delete the said records by contacting the above sender's address or by contacting protecciondedatos at aplitop.com. If you have received this electronic mail transmission in error, please delete it from your system. Unauthorized copying, forwarding or otherwise use of the information contained herein is prohibited by the laws in force. In the event that you do not wish to receive information about new products offered by APLITOP, sending its refusal to the email address protecciondedatos at aplitop.com

 

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150518/508d05fb/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image003.jpg
Type: image/jpeg
Size: 7278 bytes
Desc: image003.jpg
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150518/508d05fb/attachment-0002.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image002.jpg
Type: image/jpeg
Size: 5755 bytes
Desc: image002.jpg
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150518/508d05fb/attachment-0003.jpg>

From even.rouault at spatialys.com  Mon May 18 08:13:31 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 18 May 2015 17:13:31 +0200
Subject: [gdal-dev] Error loading ECW images
In-Reply-To: <77719CE0A8A0FD4C90916F438FABC09D01B7C077@server2k3.aplitop.local>
References: <77719CE0A8A0FD4C90916F438FABC09D01B7C077@server2k3.aplitop.local>
Message-ID: <201505181713.31541.even.rouault@spatialys.com>

Elena,

> Good Afternoon, we are trying the GDAL Library we have implemented the
> application which import/export  GeoTiff and Erdas Imagine Files and we
> haven?t any problem, but now we want to load a ecw image of 1Gb, we are
> using the file "ecwdataset" with the function "GDALDataset
> *ECWDataset::Open( GDALOpenInfo * poOpenInfo, int bIsJPEG2000 )"

Do you mean that you are directly calling this method explicitely ? This is 
not the recommanded way of using of GDAL. You'd rather use GDALOpen() and the 
public API, and not directly call internal methods of drivers.

> and on
> line 2497 in the  code below, happen an exception and the application is
> closed.
> 
> 
> 
> /* -------------------------------------------------------------------- */
> 
> /*      Create band information objects.                                */
> 
> /* -------------------------------------------------------------------- */
> 
>     for( i=0; i < poDS->psFileInfo->nBands; i++ )
> 
>         poDS->SetBand( i+1, new ECWRasterBand( poDS, i+1 ) );
> 
> 
> 
> We have tried with different Release:
> 
> 
> 
> release-1700-x64-gdal-1-11-mapserver-6-4.zip and we have installed de
> plugin for ecw
> 
> release-1800-x64.zip
> 
> 
> 
> and with different version of ECW library, 3.x and 5.x.

What happens if you open the file with gdalinfo in one of the above builds ?

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From sfkeller at gmail.com  Mon May 18 08:25:18 2015
From: sfkeller at gmail.com (Stefan Keller)
Date: Mon, 18 May 2015 17:25:18 +0200
Subject: [gdal-dev] GeoPackage vector driver fails if layer name contains
 chars not compatible with SQLite
Message-ID: <CAFcOn2_N=KGxyCj8u5tWjt_DpiVsbF1tBc=ALVQkQVWncB5g8w@mail.gmail.com>

Hi,

GeoPackage vector driver seems to fail if layer name contains chars
not compatible with SQLite (like dashes, '-').

See this:

$ ogr2ogr -f "GPKG" outfile.gpkg infile.geojson -nln layer_a
OK

$ ogrinfo -al -so outfile.gpkg
INFO: Open of `outfile.gpkg'
      using driver `GPKG' successful.
1: layer_a (Polygon)

$ ogr2ogr -f "GPKG" outfile2.gpkg infile.geojson -nln layer-a
ERROR 1: sqlite3_exec(CREATE TABLE layer-a ( fid INTEGER PRIMARY KEY AUTOINCREME
NT, geom POLYGON )) failed: near "-": syntax error
ERROR 1: Terminating translation prematurely after failed
translation of layer OGRGeoJSON (use -skipfailures to skip errors)

$ ogr2ogr -f "SQLite" outfile.sqlite infile.geojson -dsco
SPATIALITE=YES -nln layer-a
OK

$ ogrinfo outfile.sqlite
INFO: Open of `outfile.sqlite'
      using driver `SQLite' successful.
1: layer_a (Polygon)

$ ogr2ogr -f GPKG outfile2.gpkg  WFS:http://maps.zh.ch/wfs/TbaBaustellenZHWFS
ERROR 1: sqlite3_exec(CREATE TABLE baustellen-detailansicht ( fid
INTEGER PRIMARY KEY AUTOINCREMENT, geom POLYGON )) failed: near "-":
syntax error
ERROR 1: Terminating translation prematurely after failed translation
of layer baustellen-detailansicht (use -skipfailures to skip
errors)


Should I add a ticket to https://trac.osgeo.org/gdal/ ?

-S.

From yutaxsato at gmail.com  Mon May 18 08:31:39 2015
From: yutaxsato at gmail.com (Yuta Sato)
Date: Tue, 19 May 2015 00:31:39 +0900
Subject: [gdal-dev] [Proj] Pixel Shifts When Warping
In-Reply-To: <CALFmHhvMXnMfyu4ai6KXU_zJhCaz99fpi-=WtLeRMSJr6HOdBA@mail.gmail.com>
References: <CAPqnkJTAqeYroew0Us5SH_Xq9EBNEis3LAwQJ5jJJEq2R-7xVw@mail.gmail.com>
	<CALFmHht5rnEy0+dJwsvniC1q3=wDpUfKqQcHC69Edf7u+s0uXg@mail.gmail.com>
	<201505171332.21954.even.rouault@spatialys.com>
	<CALFmHhvMXnMfyu4ai6KXU_zJhCaz99fpi-=WtLeRMSJr6HOdBA@mail.gmail.com>
Message-ID: <CAPqnkJQ3OKBS5xpMBbcwPxB9KZQ9ME5GRqEO2bjd5fnqEsGgNg@mail.gmail.com>

Dear all:

Thanks for sharing your ideas and experiences.

As I mentioned in my question, it seems that MRT result is shifting right
while the GDAL warp result is correct. Do you agree?

The exact upper left corner of the original HDF-EOS file is exactly as the
GDAL warpped result.

The HDF file uses top left corner of top left pixel, while the MRT seems to
use central of top left pixel (MRT userguide page 10 under corner
coordinates section), am I right?

https://lpdaac.usgs.gov/sites/default/files/public/mrt41_usermanual_032811.pdf

If I am right, fortunately the GDAL would win!





On Mon, May 18, 2015 at 11:24 PM, Markus Neteler <neteler at osgeo.org> wrote:

> On Sun, May 17, 2015 at 1:32 PM, Even Rouault
> <even.rouault at spatialys.com> wrote:
> > Le dimanche 17 mai 2015 12:54:44, Markus Neteler a ?crit :
> >> On Sun, May 17, 2015 at 6:44 AM, Yuta Sato <yutaxsato at gmail.com> wrote:
> >> > Dear GDAL and Proj Developers and Users:
> >> >
> >> > I am really frustrated when the MODIS HDF file converted into GeoTiff
> >> > with GCS projection never match with the same MODIS file  converted
> from
> >> > MODIS Reprojection tool.
> >>
> >> We had this issue in the past, too, for our "EuroLST" project
> >> (gap-filling of all LST maps for Europe, see
> http://gis.cri.fmach.it/eurolst/).
> >> Solved since then, see below.
> >> ...
> >>
> >> > Do you have any idea on which is more precise: gdalwarp or MRT? Or
> there
> >> > is any way in gdalwarp to get the same image as MRT gives?
>
> An addition:
>
> For our EuroLST project we use EU LAEA as target projection. In our
> tests (we made a lot) the MRT results came out shifted by 0.5 -1.0
> pixel since MRT does not support a datum or ellipsoid for LAEA (LA in
> MRT), instead it supports only a sphere when reprojecting from MODIS
> sinusoidal.
>
> Using recent GDAL, gdalwarp does the reprojection from MODIS
> sinusoidal to EU LAEA correctly.
>
> >> You may take a look at
> >> http://pymodis.fem-environment.eu/
> >>
> >> pyModis >= 1.0 comes with fast GDAL support (way faster than MRT).
> >>
> >> The details of the gdalwarp usage you find in the source code here:
> >>
> https://github.com/lucadelu/pyModis/blob/master/pymodis/convertmodis_gdal.py
> >
> > Markus,
> >
> > for the sake of my curiosity, could you explain what specific stuff it
> does
> > compared to gdalwarp ? I quickly skimmed through the file and only saw
> regular
> > use of the GDAL warping API. But perhaps I missed something.
>
> pyMODIS is a set of scripts and a library to perform the download of
> large numbers of MODIS HDF/XML files (think cronjob), it creates a
> mosaic of several tiles, it extracts specific information from
> bit-encoded MODIS quality assessment layers of different product types
> etc.
>
> Essentially a ready to use product which happily uses GDAL as a backend.
>
> Markus
>
> --
> http://courses.neteler.org
> http://gis.cri.fmach.it/neteler/
> http://grass.osgeo.org
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150519/ae1e2581/attachment.html>

From even.rouault at spatialys.com  Mon May 18 08:40:31 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 18 May 2015 17:40:31 +0200
Subject: [gdal-dev] GeoPackage vector driver fails if layer name
	contains chars not compatible with SQLite
In-Reply-To: <CAFcOn2_N=KGxyCj8u5tWjt_DpiVsbF1tBc=ALVQkQVWncB5g8w@mail.gmail.com>
References: <CAFcOn2_N=KGxyCj8u5tWjt_DpiVsbF1tBc=ALVQkQVWncB5g8w@mail.gmail.com>
Message-ID: <201505181740.31854.even.rouault@spatialys.com>

Le lundi 18 mai 2015 17:25:18, Stefan Keller a ?crit :
> Hi,
> 
> GeoPackage vector driver seems to fail if layer name contains chars
> not compatible with SQLite (like dashes, '-').

Stefan,

This has been fixed in GDAL 2.0dev.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From sfkeller at gmail.com  Mon May 18 09:50:44 2015
From: sfkeller at gmail.com (Stefan Keller)
Date: Mon, 18 May 2015 18:50:44 +0200
Subject: [gdal-dev] GeoPackage vector driver fails if layer name
 contains chars not compatible with SQLite
In-Reply-To: <201505181740.31854.even.rouault@spatialys.com>
References: <CAFcOn2_N=KGxyCj8u5tWjt_DpiVsbF1tBc=ALVQkQVWncB5g8w@mail.gmail.com>
	<201505181740.31854.even.rouault@spatialys.com>
Message-ID: <CAFcOn28D0PrWoWN2bqHdAe8P81fca1QYaKcXypT7U0v94bAyog@mail.gmail.com>

Salut Even

2015-05-18 17:40 GMT+02:00 Even Rouault <even.rouault at spatialys.com> a ?crit :
> Le lundi 18 mai 2015 17:25:18, Stefan Keller a ?crit :
>> Hi,
>>
>> GeoPackage vector driver seems to fail if layer name contains chars
>> not compatible with SQLite (like dashes, '-').
>
> Stefan,
>
> This has been fixed in GDAL 2.0dev.

Merveilleux! Merci!!

-S.

2015-05-18 17:40 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
> Le lundi 18 mai 2015 17:25:18, Stefan Keller a ?crit :
>> Hi,
>>
>> GeoPackage vector driver seems to fail if layer name contains chars
>> not compatible with SQLite (like dashes, '-').
>
> Stefan,
>
> This has been fixed in GDAL 2.0dev.
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com

From randre at gmail.com  Mon May 18 10:43:21 2015
From: randre at gmail.com (=?UTF-8?B?Um9nZXIgQW5kcsOp?=)
Date: Mon, 18 May 2015 10:43:21 -0700
Subject: [gdal-dev] [Proj] Pixel Shifts When Warping
In-Reply-To: <CAPqnkJQ3OKBS5xpMBbcwPxB9KZQ9ME5GRqEO2bjd5fnqEsGgNg@mail.gmail.com>
References: <CAPqnkJTAqeYroew0Us5SH_Xq9EBNEis3LAwQJ5jJJEq2R-7xVw@mail.gmail.com>
	<CALFmHht5rnEy0+dJwsvniC1q3=wDpUfKqQcHC69Edf7u+s0uXg@mail.gmail.com>
	<201505171332.21954.even.rouault@spatialys.com>
	<CALFmHhvMXnMfyu4ai6KXU_zJhCaz99fpi-=WtLeRMSJr6HOdBA@mail.gmail.com>
	<CAPqnkJQ3OKBS5xpMBbcwPxB9KZQ9ME5GRqEO2bjd5fnqEsGgNg@mail.gmail.com>
Message-ID: <CAOL+ROFb_oJKQp00LjrjYpwMU+030eCaCUJ28n52OFxfpa0FFQ@mail.gmail.com>

The GDAL data model does specifically call out the top-left corner of the
top-left pixel as the origin. Not sure if that's helpful, but I remember
having to look this up before.

http://www.gdal.org/gdal_datamodel.html


On Mon, May 18, 2015 at 8:31 AM, Yuta Sato <yutaxsato at gmail.com> wrote:

> Dear all:
>
> Thanks for sharing your ideas and experiences.
>
> As I mentioned in my question, it seems that MRT result is shifting right
> while the GDAL warp result is correct. Do you agree?
>
> The exact upper left corner of the original HDF-EOS file is exactly as the
> GDAL warpped result.
>
> The HDF file uses top left corner of top left pixel, while the MRT seems
> to use central of top left pixel (MRT userguide page 10 under corner
> coordinates section), am I right?
>
>
> https://lpdaac.usgs.gov/sites/default/files/public/mrt41_usermanual_032811.pdf
>
> If I am right, fortunately the GDAL would win!
>
>
>
>
>
> On Mon, May 18, 2015 at 11:24 PM, Markus Neteler <neteler at osgeo.org>
> wrote:
>
>> On Sun, May 17, 2015 at 1:32 PM, Even Rouault
>> <even.rouault at spatialys.com> wrote:
>> > Le dimanche 17 mai 2015 12:54:44, Markus Neteler a ?crit :
>> >> On Sun, May 17, 2015 at 6:44 AM, Yuta Sato <yutaxsato at gmail.com>
>> wrote:
>> >> > Dear GDAL and Proj Developers and Users:
>> >> >
>> >> > I am really frustrated when the MODIS HDF file converted into GeoTiff
>> >> > with GCS projection never match with the same MODIS file  converted
>> from
>> >> > MODIS Reprojection tool.
>> >>
>> >> We had this issue in the past, too, for our "EuroLST" project
>> >> (gap-filling of all LST maps for Europe, see
>> http://gis.cri.fmach.it/eurolst/).
>> >> Solved since then, see below.
>> >> ...
>> >>
>> >> > Do you have any idea on which is more precise: gdalwarp or MRT? Or
>> there
>> >> > is any way in gdalwarp to get the same image as MRT gives?
>>
>> An addition:
>>
>> For our EuroLST project we use EU LAEA as target projection. In our
>> tests (we made a lot) the MRT results came out shifted by 0.5 -1.0
>> pixel since MRT does not support a datum or ellipsoid for LAEA (LA in
>> MRT), instead it supports only a sphere when reprojecting from MODIS
>> sinusoidal.
>>
>> Using recent GDAL, gdalwarp does the reprojection from MODIS
>> sinusoidal to EU LAEA correctly.
>>
>> >> You may take a look at
>> >> http://pymodis.fem-environment.eu/
>> >>
>> >> pyModis >= 1.0 comes with fast GDAL support (way faster than MRT).
>> >>
>> >> The details of the gdalwarp usage you find in the source code here:
>> >>
>> https://github.com/lucadelu/pyModis/blob/master/pymodis/convertmodis_gdal.py
>> >
>> > Markus,
>> >
>> > for the sake of my curiosity, could you explain what specific stuff it
>> does
>> > compared to gdalwarp ? I quickly skimmed through the file and only saw
>> regular
>> > use of the GDAL warping API. But perhaps I missed something.
>>
>> pyMODIS is a set of scripts and a library to perform the download of
>> large numbers of MODIS HDF/XML files (think cronjob), it creates a
>> mosaic of several tiles, it extracts specific information from
>> bit-encoded MODIS quality assessment layers of different product types
>> etc.
>>
>> Essentially a ready to use product which happily uses GDAL as a backend.
>>
>> Markus
>>
>> --
>> http://courses.neteler.org
>> http://gis.cri.fmach.it/neteler/
>> http://grass.osgeo.org
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150518/dc8a569b/attachment-0001.html>

From sean at mapbox.com  Mon May 18 11:37:12 2015
From: sean at mapbox.com (Sean Gillies)
Date: Mon, 18 May 2015 12:37:12 -0600
Subject: [gdal-dev] RFC 58: Removing Dataset Nodata Value
Message-ID: <CADPhZXy54dxXZ61gJeszo-aw722B4Ogb0VBV_zwJQg9SrS4bEQ@mail.gmail.com>

Hi all,

In consultation with Even Rouault, I've written up RFC 58.

  https://trac.osgeo.org/gdal/wiki/rfc58_removing_dataset_nodata_value

The gist of it: allowing deletion of a nodata value defined for a dataset,
thereby rendering all pixels valid without copying data to a new file.

I'd love your feedback and thumbs up or thumbs down on this RFC. Thanks,

--
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150518/3272d2b5/attachment.html>

From schut at sarvision.nl  Mon May 18 23:50:50 2015
From: schut at sarvision.nl (Vincent Schut)
Date: Tue, 19 May 2015 08:50:50 +0200
Subject: [gdal-dev] RFC 58: Removing Dataset Nodata Value
In-Reply-To: <CADPhZXy54dxXZ61gJeszo-aw722B4Ogb0VBV_zwJQg9SrS4bEQ@mail.gmail.com>
References: <CADPhZXy54dxXZ61gJeszo-aw722B4Ogb0VBV_zwJQg9SrS4bEQ@mail.gmail.com>
Message-ID: <555ADD4A.8020201@sarvision.nl>

On 05/18/2015 08:37 PM, Sean Gillies wrote:
> Hi all,
>
> In consultation with Even Rouault, I've written up RFC 58.
>
> https://trac.osgeo.org/gdal/wiki/rfc58_removing_dataset_nodata_value
>
> The gist of it: allowing deletion of a nodata value defined for a dataset, thereby rendering all pixels valid without copying data to a new file.
>
> I'd love your feedback and thumbs up or thumbs down on this RFC. Thanks,
As daily users of gdal me and my collegues would like to give this a very big thumbs up. We've really been missing this. Thanks a lot for starting this RFC.

Vincent.

>
> --
> Sean Gillies
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150519/cd19dcbe/attachment.html>

From lucadeluge at gmail.com  Tue May 19 01:03:19 2015
From: lucadeluge at gmail.com (Luca Delucchi)
Date: Tue, 19 May 2015 10:03:19 +0200
Subject: [gdal-dev] Regarding DPI in Geospatial PDF
In-Reply-To: <3ED2AF5FA67CF548BC5C06A608D7D40524305344@IN-MBX2.ingrnet.com>
References: <3ED2AF5FA67CF548BC5C06A608D7D405243025A1@IN-MBX2.ingrnet.com>
	<loom.20150511T111320-178@post.gmane.org>
	<3ED2AF5FA67CF548BC5C06A608D7D40524305344@IN-MBX2.ingrnet.com>
Message-ID: <CAK4m-3w3JymCpW7aqiGLOSHtagR3Y6WFu_A=Y83S+z37+xc0fw@mail.gmail.com>

On 13 May 2015 at 09:30, Vankadara, Sunil
<sunil.vankadara at hexagongeospatial.com> wrote:
> Hi Jukka,
>

Hi devs,

I did several test, and

>
> I could understand from your mail that the mediabox is nothing but the image
> size in terms of width and height and the user unit is nothing but each
> pixel size.
>
>
>
> Does it mean it is the PDF readers responsibility to dynamically resample to
> the given parameters in Media Box and User units? But Acrobat adobe reader
> is not resampling the image dynamically in displaying the image
>
>
>
> Few observations from my side are
>
> ?         I haven?t noticed any differences in Page size for different DPI
> values.
>

I notice different size in the page properties using Okular

> ?         There is no difference of the image on the paper for different DPI
> values. ( I took the print out and noticed the differences physically )
>

I didn't try to print, but If I zoom to the same percent I saw two
different region for the same screen


>
> Regards
>
> Sunil
>

-- 
ciao
Luca

http://gis.cri.fmach.it/delucchi/
www.lucadelu.org

From lucadeluge at gmail.com  Tue May 19 01:12:46 2015
From: lucadeluge at gmail.com (Luca Delucchi)
Date: Tue, 19 May 2015 10:12:46 +0200
Subject: [gdal-dev] geospatialPDF DPI and EXTRA_IMAGES
Message-ID: <CAK4m-3ynQUeSse+TwXYknToQjbT4BS5cPQJMMszh=4Yb_UVncA@mail.gmail.com>

Hi devs,

I noticed something strange about the position of EXTRA_IMAGES with
different DPI values.

If I set a value lower than 73 the  EXTRA_IMAGE it is added in the
right place, but If I increase the value the EXTRA_IMAGE it is moved
up from the correct point.

Is this normal or a bug?
Is there any way to avoid this shift from the correct position?

-- 
ciao
Luca

http://gis.cri.fmach.it/delucchi/
www.lucadelu.org

From even.rouault at spatialys.com  Tue May 19 01:37:50 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 19 May 2015 10:37:50 +0200
Subject: [gdal-dev] geospatialPDF DPI and EXTRA_IMAGES
In-Reply-To: <CAK4m-3ynQUeSse+TwXYknToQjbT4BS5cPQJMMszh=4Yb_UVncA@mail.gmail.com>
References: <CAK4m-3ynQUeSse+TwXYknToQjbT4BS5cPQJMMszh=4Yb_UVncA@mail.gmail.com>
Message-ID: <201505191037.50818.even.rouault@spatialys.com>

Le mardi 19 mai 2015 10:12:46, Luca Delucchi a ?crit :
> Hi devs,
> 
> I noticed something strange about the position of EXTRA_IMAGES with
> different DPI values.
> 
> If I set a value lower than 73 the  EXTRA_IMAGE it is added in the
> right place, but If I increase the value the EXTRA_IMAGE it is moved
> up from the correct point.
> 
> Is this normal or a bug?
> Is there any way to avoid this shift from the correct position?

Luca,

According to the doc, "x and y are in user units from the lower left corner of 
the page"

If you set a DPI < 72, GDAL will correct it to DPI = 72 since AFAIR, this is 
the minimum accepted value by the PDF spec (not sure of that though).

And since 1 user unit  = DPI / 72, if you increase the DPI, you must divide 
the offset by DPI / 72 so that the image stays at the same location in term of 
pixels.

From the PDF spec:
"""UserUnit
number
(Optional; PDF 1.6) A positive number giving the size of default user space 
units, in multiples of 1 ? 72 inch. The range of supported values is 
implementation-dependent; see implementation note 177 in Appendix H.
Default value: 1.0 (user unit is 1 ? 72 inch).
"""

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From cavallini at faunalia.it  Tue May 19 01:54:40 2015
From: cavallini at faunalia.it (Paolo Cavallini)
Date: Tue, 19 May 2015 10:54:40 +0200
Subject: [gdal-dev] ogr2ogr segfault
Message-ID: <555AFA50.60400@faunalia.it>

Hi all.
I'm consistently getting a segfault from:

ogr2ogr OUTPUTLAYER.shp strade.shp strade -dialect sqlite -sql "SELECT
ST_Line_Interpolate_Point( geometry , 0.5 ),* FROM 'strade' "

Anything I can do for debugging?
Debian Sid, might be a platform specific issue?
https://bugs.debian.org/785091
All the best.
-- 
Paolo Cavallini - www.faunalia.eu
QGIS & PostGIS courses: http://www.faunalia.eu/training.html

From ari.jolma at gmail.com  Tue May 19 02:01:09 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 19 May 2015 12:01:09 +0300
Subject: [gdal-dev] ogr2ogr segfault
In-Reply-To: <555AFA50.60400@faunalia.it>
References: <555AFA50.60400@faunalia.it>
Message-ID: <555AFBD5.2060307@gmail.com>

19.05.2015, 11:54, Paolo Cavallini kirjoitti:
> Hi all.
> I'm consistently getting a segfault from:
>
> ogr2ogr OUTPUTLAYER.shp strade.shp strade -dialect sqlite -sql "SELECT
> ST_Line_Interpolate_Point( geometry , 0.5 ),* FROM 'strade' "
>
> Anything I can do for debugging?

Paolo,

Can you give us the back trace what led to the segfault? Can you share 
the shapefile?

Best regards,

Ari

> Debian Sid, might be a platform specific issue?
> https://bugs.debian.org/785091
> All the best.


From even.rouault at spatialys.com  Tue May 19 02:05:11 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 19 May 2015 11:05:11 +0200
Subject: [gdal-dev] ogr2ogr segfault
In-Reply-To: <555AFA50.60400@faunalia.it>
References: <555AFA50.60400@faunalia.it>
Message-ID: <201505191105.11611.even.rouault@spatialys.com>

Paolo,

> Hi all.
> I'm consistently getting a segfault from:
> 
> ogr2ogr OUTPUTLAYER.shp strade.shp strade -dialect sqlite -sql "SELECT
> ST_Line_Interpolate_Point( geometry , 0.5 ),* FROM 'strade' "
> 
> Anything I can do for debugging?

Running under gdb and displaying the stack trace.

> Debian Sid, might be a platform specific issue?
> https://bugs.debian.org/785091

I've seen recently a similar discussion on spatialite mailing list I think. If 
upgrading from spatialite 4.something to 4.1.2 or later, GDAL should also be 
recompiled so as to benefit from the spatialite_init_ex() functions

I don't recall the details but I somehow remember that one of the intermediate 
spatialite versions had an issue in its termination routine freeing the global 
GEOS context. I don't have any more problems with latest versions. But the 
debian ticket you mention seemed to be about a problem that arose with proj4 
update. Hum...

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From cavallini at faunalia.it  Tue May 19 02:07:39 2015
From: cavallini at faunalia.it (Paolo Cavallini)
Date: Tue, 19 May 2015 11:07:39 +0200
Subject: [gdal-dev] ogr2ogr segfault
In-Reply-To: <555AFBD5.2060307@gmail.com>
References: <555AFA50.60400@faunalia.it> <555AFBD5.2060307@gmail.com>
Message-ID: <555AFD5B.9030401@faunalia.it>

Il 19/05/2015 11:01, Ari Jolma ha scritto:

> Can you give us the back trace what led to the segfault? Can you share
> the shapefile?

The shape is irrelevant, it happens with anyone.
I'll try to get the backtrace later, I'm now in a workshop.
Could anyone get the command working on Sid?
Thanks for the feedback.
All the best.
-- 
Paolo Cavallini - www.faunalia.eu
QGIS & PostGIS courses: http://www.faunalia.eu/training.html

From afalciano at yahoo.it  Tue May 19 02:18:23 2015
From: afalciano at yahoo.it (Antonio Falciano)
Date: Tue, 19 May 2015 11:18:23 +0200
Subject: [gdal-dev] ogr2ogr segfault
In-Reply-To: <555AFD5B.9030401@faunalia.it>
References: <555AFA50.60400@faunalia.it> <555AFBD5.2060307@gmail.com>
	<555AFD5B.9030401@faunalia.it>
Message-ID: <555AFFDF.5050400@yahoo.it>

Il 19/05/2015 11:07, Paolo Cavallini ha scritto:
> Il 19/05/2015 11:01, Ari Jolma ha scritto:
>
>> Can you give us the back trace what led to the segfault? Can you share
>> the shapefile?
>
> The shape is irrelevant, it happens with anyone.
> I'll try to get the backtrace later, I'm now in a workshop.
> Could anyone get the command working on Sid?
> Thanks for the feedback.
> All the best.
>

Hi Paolo,
try with:
ogr2ogr OUTPUTLAYER.shp strade.shp -dialect sqlite -sql "SELECT
ST_Line_Interpolate_Point(geometry, 0.5), * FROM strade"
What happens in this case?

Cheers,
Antonio

-- 
Antonio Falciano
http://www.linkedin.com/in/antoniofalciano

From ari.jolma at gmail.com  Tue May 19 02:24:19 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 19 May 2015 12:24:19 +0300
Subject: [gdal-dev] ogr2ogr segfault
In-Reply-To: <201505191105.11611.even.rouault@spatialys.com>
References: <555AFA50.60400@faunalia.it>
	<201505191105.11611.even.rouault@spatialys.com>
Message-ID: <555B0143.3080308@gmail.com>

19.05.2015, 12:05, Even Rouault kirjoitti:
> Paolo,
>
>> Hi all.
>> I'm consistently getting a segfault from:
>>
>> ogr2ogr OUTPUTLAYER.shp strade.shp strade -dialect sqlite -sql "SELECT
>> ST_Line_Interpolate_Point( geometry , 0.5 ),* FROM 'strade' "
>>
>> Anything I can do for debugging?
> Running under gdb and displaying the stack trace.

ogr2ogr OUTPUTLAYER.shp strade.shp -dialect sqlite -sql "SELECT 
ST_Line_Interpolate_Point( geometry , 0.5 ),* FROM 'strade'"
ERROR 1: In ExecuteSQL(): sqlite3_prepare(SELECT 
ST_Line_Interpolate_Point( geometry , 0.5 ),* FROM 'strade'):
   no such function: ST_Line_Interpolate_Point

I have both SQLite and SpatiaLite support on. What's going on?

Ari

>
>> Debian Sid, might be a platform specific issue?
>> https://bugs.debian.org/785091
> I've seen recently a similar discussion on spatialite mailing list I think. If
> upgrading from spatialite 4.something to 4.1.2 or later, GDAL should also be
> recompiled so as to benefit from the spatialite_init_ex() functions
>
> I don't recall the details but I somehow remember that one of the intermediate
> spatialite versions had an issue in its termination routine freeing the global
> GEOS context. I don't have any more problems with latest versions. But the
> debian ticket you mention seemed to be about a problem that arose with proj4
> update. Hum...
>
> Even
>


From even.rouault at spatialys.com  Tue May 19 02:25:27 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 19 May 2015 11:25:27 +0200
Subject: [gdal-dev] ogr2ogr segfault
In-Reply-To: <555B0143.3080308@gmail.com>
References: <555AFA50.60400@faunalia.it>
	<201505191105.11611.even.rouault@spatialys.com>
	<555B0143.3080308@gmail.com>
Message-ID: <201505191125.27414.even.rouault@spatialys.com>

Le mardi 19 mai 2015 11:24:19, Ari Jolma a ?crit :
> 19.05.2015, 12:05, Even Rouault kirjoitti:
> > Paolo,
> > 
> >> Hi all.
> >> I'm consistently getting a segfault from:
> >> 
> >> ogr2ogr OUTPUTLAYER.shp strade.shp strade -dialect sqlite -sql "SELECT
> >> ST_Line_Interpolate_Point( geometry , 0.5 ),* FROM 'strade' "
> >> 
> >> Anything I can do for debugging?
> > 
> > Running under gdb and displaying the stack trace.
> 
> ogr2ogr OUTPUTLAYER.shp strade.shp -dialect sqlite -sql "SELECT
> ST_Line_Interpolate_Point( geometry , 0.5 ),* FROM 'strade'"
> ERROR 1: In ExecuteSQL(): sqlite3_prepare(SELECT
> ST_Line_Interpolate_Point( geometry , 0.5 ),* FROM 'strade'):
>    no such function: ST_Line_Interpolate_Point
> 
> I have both SQLite and SpatiaLite support on. What's going on?

Not using a recent enough SpatiaLite I guess

> 
> Ari
> 
> >> Debian Sid, might be a platform specific issue?
> >> https://bugs.debian.org/785091
> > 
> > I've seen recently a similar discussion on spatialite mailing list I
> > think. If upgrading from spatialite 4.something to 4.1.2 or later, GDAL
> > should also be recompiled so as to benefit from the spatialite_init_ex()
> > functions
> > 
> > I don't recall the details but I somehow remember that one of the
> > intermediate spatialite versions had an issue in its termination routine
> > freeing the global GEOS context. I don't have any more problems with
> > latest versions. But the debian ticket you mention seemed to be about a
> > problem that arose with proj4 update. Hum...
> > 
> > Even
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From cavallini at faunalia.it  Tue May 19 02:39:24 2015
From: cavallini at faunalia.it (Paolo Cavallini)
Date: Tue, 19 May 2015 11:39:24 +0200
Subject: [gdal-dev] ogr2ogr segfault
In-Reply-To: <555AFFDF.5050400@yahoo.it>
References: <555AFA50.60400@faunalia.it>
	<555AFBD5.2060307@gmail.com>	<555AFD5B.9030401@faunalia.it>
	<555AFFDF.5050400@yahoo.it>
Message-ID: <555B04CC.4000101@faunalia.it>

Il 19/05/2015 11:18, Antonio Falciano ha scritto:

> ogr2ogr OUTPUTLAYER.shp strade.shp -dialect sqlite -sql "SELECT
> ST_Line_Interpolate_Point(geometry, 0.5), * FROM strade"
> What happens in this case?

Same thing, segfault.
Reading better notes from Debian developer I get convinced is the same
problem reported (not proj, sorry).
Thanks.

-- 
Paolo Cavallini - www.faunalia.eu
QGIS & PostGIS courses: http://www.faunalia.eu/training.html

From cavallini at faunalia.it  Tue May 19 02:43:17 2015
From: cavallini at faunalia.it (Paolo Cavallini)
Date: Tue, 19 May 2015 11:43:17 +0200
Subject: [gdal-dev] ogr2ogr segfault
In-Reply-To: <555AFFDF.5050400@yahoo.it>
References: <555AFA50.60400@faunalia.it>
	<555AFBD5.2060307@gmail.com>	<555AFD5B.9030401@faunalia.it>
	<555AFFDF.5050400@yahoo.it>
Message-ID: <555B05B5.1090909@faunalia.it>

Il 19/05/2015 11:18, Antonio Falciano ha scritto:

> ogr2ogr OUTPUTLAYER.shp strade.shp -dialect sqlite -sql "SELECT
> ST_Line_Interpolate_Point(geometry, 0.5), * FROM strade"
> What happens in this case?

Same thing, segfault.
Reading better notes from Debian developer I get convinced is the same
problem reported (not proj, sorry).

In fact:

Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
Core was generated by `ogr2ogr
/tmp/processing/ac237fb069174742838e3f468b7b8a28/OUTPUTLAYER.shp /home/'.
Program terminated with signal SIGSEGV, Segmentation fault.
#0  0x00007f9bfed4fff4 in spatialite_init () from
/usr/lib/x86_64-linux-gnu/libspatialite.so.5

Same thing as for qgis crashes.
Thanks for helping to understand.
-- 
Paolo Cavallini - www.faunalia.eu
QGIS & PostGIS courses: http://www.faunalia.eu/training.html

From cavallini at faunalia.it  Tue May 19 02:46:58 2015
From: cavallini at faunalia.it (Paolo Cavallini)
Date: Tue, 19 May 2015 11:46:58 +0200
Subject: [gdal-dev] ogr2ogr segfault
In-Reply-To: <555B05B5.1090909@faunalia.it>
References: <555AFA50.60400@faunalia.it>	<555AFBD5.2060307@gmail.com>	<555AFD5B.9030401@faunalia.it>	<555AFFDF.5050400@yahoo.it>
	<555B05B5.1090909@faunalia.it>
Message-ID: <555B0692.8040602@faunalia.it>

Il 19/05/2015 11:43, Paolo Cavallini ha scritto:
> Il 19/05/2015 11:18, Antonio Falciano ha scritto:
> 
>> ogr2ogr OUTPUTLAYER.shp strade.shp -dialect sqlite -sql "SELECT
>> ST_Line_Interpolate_Point(geometry, 0.5), * FROM strade"
>> What happens in this case?
> 
> Same thing, segfault.
> Reading better notes from Debian developer I get convinced is the same
> problem reported (not proj, sorry).
> 
> In fact:
> 
> Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
> Core was generated by `ogr2ogr
> /tmp/processing/ac237fb069174742838e3f468b7b8a28/OUTPUTLAYER.shp /home/'.
> Program terminated with signal SIGSEGV, Segmentation fault.
> #0  0x00007f9bfed4fff4 in spatialite_init () from
> /usr/lib/x86_64-linux-gnu/libspatialite.so.5

For completedness:

#0  0x00007f9bfed4fff4 in spatialite_init () from
/usr/lib/x86_64-linux-gnu/libspatialite.so.5
#1  0x00007f9c058874bf in ?? () from /usr/lib/libgdal.so.1
#2  0x00007f9c0588c385 in ?? () from /usr/lib/libgdal.so.1
#3  0x00007f9c058927e0 in ?? () from /usr/lib/libgdal.so.1
#4  0x0000000000405303 in ?? ()
#5  0x00007f9c04373b45 in __libc_start_main (main=0x404bc0, argc=7,
argv=0x7fff8d37a748, init=<optimized out>, fini=<optimized out>,
    rtld_fini=<optimized out>, stack_end=0x7fff8d37a738) at libc-start.c:287
#6  0x0000000000408292 in ?? ()

All the best.
-- 
Paolo Cavallini - www.faunalia.eu
QGIS & PostGIS courses: http://www.faunalia.eu/training.html

From ari.jolma at gmail.com  Tue May 19 03:21:15 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 19 May 2015 13:21:15 +0300
Subject: [gdal-dev] ogr2ogr segfault
In-Reply-To: <201505191125.27414.even.rouault@spatialys.com>
References: <555AFA50.60400@faunalia.it>
	<201505191105.11611.even.rouault@spatialys.com>
	<555B0143.3080308@gmail.com>
	<201505191125.27414.even.rouault@spatialys.com>
Message-ID: <555B0E9B.6020509@gmail.com>


>>>> Hi all.
>>>> I'm consistently getting a segfault from:
>>>>
>>>> ogr2ogr OUTPUTLAYER.shp strade.shp strade -dialect sqlite -sql "SELECT
>>>> ST_Line_Interpolate_Point( geometry , 0.5 ),* FROM 'strade' "
>>>>
>>>> Anything I can do for debugging?
>>> Running under gdb and displaying the stack trace.
>> ogr2ogr OUTPUTLAYER.shp strade.shp -dialect sqlite -sql "SELECT
>> ST_Line_Interpolate_Point( geometry , 0.5 ),* FROM 'strade'"
>> ERROR 1: In ExecuteSQL(): sqlite3_prepare(SELECT
>> ST_Line_Interpolate_Point( geometry , 0.5 ),* FROM 'strade'):
>>     no such function: ST_Line_Interpolate_Point
>>
>> I have both SQLite and SpatiaLite support on. What's going on?
> Not using a recent enough SpatiaLite I guess

I've now got the latest SpatiaLite version but ogr2ogr is still complaining.

However, I got also the SpatiaLite CLI and it has no problems:

spatialite> .loadshp strade strade utf8
========
Loading shapefile at 'strade' into SQLite table 'strade'

BEGIN;
CREATE TABLE "strade" (
"PK_UID" INTEGER PRIMARY KEY AUTOINCREMENT,
"id" INTEGER);
SELECT AddGeometryColumn('strade', 'Geometry', -1, 'LINESTRING', 'XY');
COMMIT;

Inserted 1 rows into 'strade' from SHAPEFILE
========
spatialite> SELECT astext(ST_Line_Interpolate_Point( geometry , 0.5 )),* 
FROM 'strade';
POINT(-0.352046 0.4463)|1|0|

Hm.

Ari


From even.rouault at spatialys.com  Tue May 19 03:25:53 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 19 May 2015 12:25:53 +0200
Subject: [gdal-dev] ogr2ogr segfault
In-Reply-To: <555B0E9B.6020509@gmail.com>
References: <555AFA50.60400@faunalia.it>
	<201505191125.27414.even.rouault@spatialys.com>
	<555B0E9B.6020509@gmail.com>
Message-ID: <201505191225.53429.even.rouault@spatialys.com>

Le mardi 19 mai 2015 12:21:15, Ari Jolma a ?crit :
> >>>> Hi all.
> >>>> I'm consistently getting a segfault from:
> >>>> 
> >>>> ogr2ogr OUTPUTLAYER.shp strade.shp strade -dialect sqlite -sql "SELECT
> >>>> ST_Line_Interpolate_Point( geometry , 0.5 ),* FROM 'strade' "
> >>>> 
> >>>> Anything I can do for debugging?
> >>> 
> >>> Running under gdb and displaying the stack trace.
> >> 
> >> ogr2ogr OUTPUTLAYER.shp strade.shp -dialect sqlite -sql "SELECT
> >> ST_Line_Interpolate_Point( geometry , 0.5 ),* FROM 'strade'"
> >> ERROR 1: In ExecuteSQL(): sqlite3_prepare(SELECT
> >> 
> >> ST_Line_Interpolate_Point( geometry , 0.5 ),* FROM 'strade'):
> >>     no such function: ST_Line_Interpolate_Point
> >> 
> >> I have both SQLite and SpatiaLite support on. What's going on?
> > 
> > Not using a recent enough SpatiaLite I guess
> 
> I've now got the latest SpatiaLite version but ogr2ogr is still
> complaining.

Check with

ogrinfo  strade.shp -dialect sqlite -sql "select spatialite_version()"

that you're linking against the spatialite version you expect.

> 
> However, I got also the SpatiaLite CLI and it has no problems:
> 
> spatialite> .loadshp strade strade utf8
> ========
> Loading shapefile at 'strade' into SQLite table 'strade'
> 
> BEGIN;
> CREATE TABLE "strade" (
> "PK_UID" INTEGER PRIMARY KEY AUTOINCREMENT,
> "id" INTEGER);
> SELECT AddGeometryColumn('strade', 'Geometry', -1, 'LINESTRING', 'XY');
> COMMIT;
> 
> Inserted 1 rows into 'strade' from SHAPEFILE
> ========
> spatialite> SELECT astext(ST_Line_Interpolate_Point( geometry , 0.5 )),*
> FROM 'strade';
> POINT(-0.352046 0.4463)|1|0|
> 
> Hm.
> 
> Ari

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From a.furieri at lqt.it  Tue May 19 03:56:44 2015
From: a.furieri at lqt.it (a.furieri at lqt.it)
Date: Tue, 19 May 2015 12:56:44 +0200
Subject: [gdal-dev] ogr2ogr segfault
In-Reply-To: <201505191125.27414.even.rouault@spatialys.com>
References: <555AFA50.60400@faunalia.it>
	<201505191105.11611.even.rouault@spatialys.com>
	<555B0143.3080308@gmail.com>
	<201505191125.27414.even.rouault@spatialys.com>
Message-ID: <379e198fa5be25188cb0a65d5014ba27@lqt.it>

On Tue, 19 May 2015 11:25:27 +0200, Even Rouault wrote:
> Debian Sid, might be a platform specific issue?
> https://bugs.debian.org/785091
>

few technical details useful to understand better:

a) starting since November 2013 it become definitely clear
    that the older self-registration mechanism based on the
    spatialite_init() API was intrinsically thread unsafe
    and could potentially have very bad interactions with
    the more recent versions of both PROJ.4 and GEOS

b) consequently a public announcement [1] was duly released
    warning about the deprecation of spatialite_init()
    and soliciting developers and maintainers to start
    supporting the alternative thread safe mechanism based
    on spatialite_alloc_connection(), spatialite_init_ex()
    and spatialite_cleanup() APIs.

c) all recent versions of libspatialite, spatialite-tools
    and spatialite_gui are now expected to be fully thread
    safe: and AFAIK the same is for recent versions of GDAL.
    any obsolete version still based on the nowadays deprecated
    spatialite_init() API is potentially at risk when deployed
    in a multithread configuration.

OTH Sandro

[1] 
https://groups.google.com/forum/#!searchin/spatialite-users/spatialite_init_ex/spatialite-users/83SOajOJ2JU/sgi5fuYAVVkJ


From ari.jolma at gmail.com  Tue May 19 04:02:48 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 19 May 2015 14:02:48 +0300
Subject: [gdal-dev] ogr2ogr segfault
In-Reply-To: <201505191225.53429.even.rouault@spatialys.com>
References: <555AFA50.60400@faunalia.it>
	<201505191125.27414.even.rouault@spatialys.com>
	<555B0E9B.6020509@gmail.com>
	<201505191225.53429.even.rouault@spatialys.com>
Message-ID: <555B1858.2000107@gmail.com>

19.05.2015, 13:25, Even Rouault kirjoitti:
> ogrinfo  strade.shp -dialect sqlite -sql "select spatialite_version()"

"no such function" :D

It's not finding the SpatiaLite at all. I'm using libsqlite3-0 from 
ubuntu and libspatialite is now my own compiled. I removed the ubuntu 
version. ldconfig shows I'm using the new one. I configured and compiled 
gdal and it finds libspatialite. ldd ogr2ogr (there is only the ogr2ogr 
I made) shows a link to the new libspatialite.

Ari


From even.rouault at spatialys.com  Tue May 19 04:04:53 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 19 May 2015 13:04:53 +0200
Subject: [gdal-dev] ogr2ogr segfault
In-Reply-To: <555B1858.2000107@gmail.com>
References: <555AFA50.60400@faunalia.it>
	<201505191225.53429.even.rouault@spatialys.com>
	<555B1858.2000107@gmail.com>
Message-ID: <201505191304.53658.even.rouault@spatialys.com>

Le mardi 19 mai 2015 13:02:48, Ari Jolma a ?crit :
> 19.05.2015, 13:25, Even Rouault kirjoitti:
> > ogrinfo  strade.shp -dialect sqlite -sql "select spatialite_version()"
> 
> "no such function" :D
> 
> It's not finding the SpatiaLite at all. I'm using libsqlite3-0 from
> ubuntu and libspatialite is now my own compiled. I removed the ubuntu
> version. ldconfig shows I'm using the new one. I configured and compiled
> gdal and it finds libspatialite. ldd ogr2ogr (there is only the ogr2ogr
> I made) shows a link to the new libspatialite.

Did you "make clean" between your different ./configure attempts ?

> 
> Ari

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Tue May 19 04:17:58 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 19 May 2015 14:17:58 +0300
Subject: [gdal-dev] ogr2ogr segfault
In-Reply-To: <201505191304.53658.even.rouault@spatialys.com>
References: <555AFA50.60400@faunalia.it>
	<201505191225.53429.even.rouault@spatialys.com>
	<555B1858.2000107@gmail.com>
	<201505191304.53658.even.rouault@spatialys.com>
Message-ID: <555B1BE6.1060300@gmail.com>

19.05.2015, 14:04, Even Rouault kirjoitti:
> Le mardi 19 mai 2015 13:02:48, Ari Jolma a ?crit :
>> 19.05.2015, 13:25, Even Rouault kirjoitti:
>>> ogrinfo  strade.shp -dialect sqlite -sql "select spatialite_version()"
>> "no such function" :D
>>
>> It's not finding the SpatiaLite at all. I'm using libsqlite3-0 from
>> ubuntu and libspatialite is now my own compiled. I removed the ubuntu
>> version. ldconfig shows I'm using the new one. I configured and compiled
>> gdal and it finds libspatialite. ldd ogr2ogr (there is only the ogr2ogr
>> I made) shows a link to the new libspatialite.
> Did you "make clean" between your different ./configure attempts ?

ok, that did it. Argh. There should be something in the configure to 
force make clean.

Anyway, now

ogr2ogr OUTPUTLAYER.shp strade.shp -dialect sqlite -sql "SELECT 
ST_Line_Interpolate_Point( geometry , 0.5 ),* FROM 'strade'"

works fine.

My gdal is from trunk, updated maybe last week.

Ari

>
>> Ari


From avyavkumar at gmail.com  Tue May 19 04:42:27 2015
From: avyavkumar at gmail.com (Avyav Kumar)
Date: Tue, 19 May 2015 17:12:27 +0530
Subject: [gdal-dev] Working on GDAL
Message-ID: <CAHOc4-1KjJLQc0SM1tMUxJ8AbjveBmj=d9m0WYyoLso5MKko5w@mail.gmail.com>

Hi,
I would like to implement filters and stretches for the GDAL library as
described here (
https://github.com/avyavkumar/GDAL-idea/blob/master/proposal-edit.txt). I
would really like to work on the same, but I still need advice. I would
appreciate guidance on the following tasks:

Help regarding the integration of code in the GDAL library (if it is up to
scratch)
General testing of the code with help from QGIS
Any other thing I might have missed/ useful details

I am a newbie with little experience, so any help/advice will be
appreciated.

Thanks!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150519/e0e6ffda/attachment-0001.html>

From lucena_ivan at hotmail.com  Tue May 19 06:31:34 2015
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Tue, 19 May 2015 09:31:34 -0400
Subject: [gdal-dev] RFC 58: Removing Dataset Nodata Value
In-Reply-To: <555ADD4A.8020201@sarvision.nl>
References: <CADPhZXy54dxXZ61gJeszo-aw722B4Ogb0VBV_zwJQg9SrS4bEQ@mail.gmail.com>,
	<555ADD4A.8020201@sarvision.nl>
Message-ID: <BLU173-W46EA116BFB82ED47747A2F90C30@phx.gbl>

Hi Vicent,

Since the SetNoDataValue and GetNodataValue is based on the limitation of GeoTiff I would not expect DeleteNoDataValue to be any different. For example, there is no way to set/get NoData for individuals bands, there is no way to set/get an array of NoData values or NoData value ranges. For drivers that support such thinks, the DeleteNoDataValue will probably delete all NoData values from the dataset.

But that is something that can't be resolved by the RFC 58. I think.

Very often, I find unsigned 8 bit images with absurd NoData value, like -9999. That is probably a software specific flag value. The problem is that in gdal_translate there is no option to prevent that NoData to be passed from one format to another. So I am about to implement a value range check on the CreateCopy to avoid that.

Would that be feasible to accept the option "-a_nodata NO" on GDAL command lines, to indicate that NoData should not pass from the input to the output dataset?

Best regards,

Ivan


Date: Tue, 19 May 2015 08:50:50 +0200
From: schut at sarvision.nl
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] RFC 58: Removing Dataset Nodata Value


  
    
  
  
    On 05/18/2015 08:37 PM, Sean Gillies wrote:

    
      Hi all,
        

        
        In consultation with Even Rouault, I've written up RFC 58. 
        

        
          https://trac.osgeo.org/gdal/wiki/rfc58_removing_dataset_nodata_value
        

        
        The gist of it: allowing deletion of a nodata value defined
          for a dataset, thereby rendering all pixels valid without
          copying data to a new file.
        

        
        I'd love your feedback and thumbs up or thumbs down on this
          RFC. Thanks,
      
    
    As daily users of gdal me and my collegues would like to give this a
    very big thumbs up. We've really been missing this. Thanks a lot for
    starting this RFC.

    

    Vincent.

    

    
      
        

        
        --
        Sean Gillies
        

        
        

        
      
      

      
      

      _______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev
    
    

  


_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150519/0ea42d14/attachment.html>

From even.rouault at spatialys.com  Tue May 19 06:39:13 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 19 May 2015 15:39:13 +0200
Subject: [gdal-dev] RFC 58: Removing Dataset Nodata Value
In-Reply-To: <BLU173-W46EA116BFB82ED47747A2F90C30@phx.gbl>
References: <CADPhZXy54dxXZ61gJeszo-aw722B4Ogb0VBV_zwJQg9SrS4bEQ@mail.gmail.com>
	<555ADD4A.8020201@sarvision.nl>
	<BLU173-W46EA116BFB82ED47747A2F90C30@phx.gbl>
Message-ID: <201505191539.14016.even.rouault@spatialys.com>

Hi Ivan,

> 
> Since the SetNoDataValue and GetNodataValue is based on the limitation of
> GeoTiff I would not expect DeleteNoDataValue to be any different. For
> example, there is no way to set/get NoData for individuals bands, there is
> no way to set/get an array of NoData values or NoData value ranges.

More than one nodata value is perhaps better modelled with a nodata mask.

> For
> drivers that support such thinks, the DeleteNoDataValue will probably
> delete all NoData values from the dataset.

Yes, it will for GeoTIFF.

> 
> But that is something that can't be resolved by the RFC 58. I think.

That's indeed an orthogonal issue. There's nothing in the absolute that would 
prevent from having a per-band nodata value in GeoTIFF. But currently the TIFF 
GDAL_NODATA tag is only documented to contain one value. Perhaps a new tag 
should be created for per-band nodata values. With the caveat that per-band 
nodata isn't always clearly defined: is it really per-band or is the unique 
combination (nodata1, nodata2, .... nodataN) the nodata value... ( the later 
is the semantics of the special NODATA_VALUES metadata item. See 
http://www.gdal.org/gdal_datamodel.html )

> 
> Very often, I find unsigned 8 bit images with absurd NoData value, like
> -9999. That is probably a software specific flag value. The problem is
> that in gdal_translate there is no option to prevent that NoData to be
> passed from one format to another. So I am about to implement a value
> range check on the CreateCopy to avoid that.
> 
> Would that be feasible to accept the option "-a_nodata NO" on GDAL command
> lines, to indicate that NoData should not pass from the input to the
> output dataset?

Perhaps you're looking for this ;-) ?

<dt> <b>-a_nodata</b> <i>value</i>:</dt><dd>
Assign a specified nodata value to output bands. Starting with GDAL 1.8.0, can
be set to <i>none</i> to avoid setting a nodata value to the output file if
one exists for the source file. Note that, if the input dataset has a
nodata value, this does not cause pixel values that are equal to that nodata
value to be changed to the value specified with this option.</dd>

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Tue May 19 06:43:38 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Tue, 19 May 2015 13:43:38 +0000 (UTC)
Subject: [gdal-dev] RFC 58: Removing Dataset Nodata Value
References: <CADPhZXy54dxXZ61gJeszo-aw722B4Ogb0VBV_zwJQg9SrS4bEQ@mail.gmail.com>,
	<555ADD4A.8020201@sarvision.nl>
	<BLU173-W46EA116BFB82ED47747A2F90C30@phx.gbl>
Message-ID: <loom.20150519T154146-614@post.gmane.org>

Ivan Lucena <lucena_ivan <at> hotmail.com> writes:

> Would that be feasible to accept the option "-a_nodata NO" on GDAL command
lines, to indicate that NoData should not pass from the input to the output
dataset?

Would it be something different than "-a_nodata none"?

-a_nodata value:
    Assign a specified nodata value to output bands. Starting with GDAL
1.8.0, can be set to none to avoid setting a nodata value to the output file
if one exists for the source file. Note that, if the input dataset has a
nodata value, this does not cause pixel values that are equal to that nodata
value to be changed to the value specified with this option. 

-Jukka Rahkonen-


From lucena_ivan at hotmail.com  Tue May 19 07:06:59 2015
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Tue, 19 May 2015 10:06:59 -0400
Subject: [gdal-dev] RFC 58: Removing Dataset Nodata Value
In-Reply-To: <loom.20150519T154146-614@post.gmane.org>
References: <CADPhZXy54dxXZ61gJeszo-aw722B4Ogb0VBV_zwJQg9SrS4bEQ@mail.gmail.com>,
	, <555ADD4A.8020201@sarvision.nl>,
	<BLU173-W46EA116BFB82ED47747A2F90C30@phx.gbl>,
	<loom.20150519T154146-614@post.gmane.org>
Message-ID: <BLU173-W2C6335B99F6DEAB6F317990C30@phx.gbl>

Jukka/Even,

Yes, you guy are right. The  "-a_nodata none" will help but I still need to implement a value range check on my CreateCopy anyway. So users don't need to run gdal_translate again after they find the problem or use "-a_nodata none" all the time (in a script for example) and miss the good ones.

Thanks.

> To: gdal-dev at lists.osgeo.org
> From: jukka.rahkonen at maanmittauslaitos.fi
> Date: Tue, 19 May 2015 13:43:38 +0000
> Subject: Re: [gdal-dev] RFC 58: Removing Dataset Nodata Value
> 
> Ivan Lucena <lucena_ivan <at> hotmail.com> writes:
> 
> > Would that be feasible to accept the option "-a_nodata NO" on GDAL command
> lines, to indicate that NoData should not pass from the input to the output
> dataset?
> 
> Would it be something different than "-a_nodata none"?
> 
> -a_nodata value:
>     Assign a specified nodata value to output bands. Starting with GDAL
> 1.8.0, can be set to none to avoid setting a nodata value to the output file
> if one exists for the source file. Note that, if the input dataset has a
> nodata value, this does not cause pixel values that are equal to that nodata
> value to be changed to the value specified with this option. 
> 
> -Jukka Rahkonen-
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150519/f01667a5/attachment.html>

From even.rouault at spatialys.com  Tue May 19 07:10:38 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 19 May 2015 16:10:38 +0200
Subject: [gdal-dev] RFC 58: Removing Dataset Nodata Value
In-Reply-To: <BLU173-W2C6335B99F6DEAB6F317990C30@phx.gbl>
References: <CADPhZXy54dxXZ61gJeszo-aw722B4Ogb0VBV_zwJQg9SrS4bEQ@mail.gmail.com>
	<loom.20150519T154146-614@post.gmane.org>
	<BLU173-W2C6335B99F6DEAB6F317990C30@phx.gbl>
Message-ID: <201505191610.38720.even.rouault@spatialys.com>

Le mardi 19 mai 2015 16:06:59, Ivan Lucena a ?crit :
> Jukka/Even,
> 
> Yes, you guy are right. The  "-a_nodata none" will help but I still need to
> implement a value range check on my CreateCopy anyway. So users don't need
> to run gdal_translate again after they find the problem or use "-a_nodata
> none" all the time (in a script for example) and miss the good ones.

I'm wondering if it might not make more sense to modify the input driver(s) to 
not report out-of-range nodata values ? I fail to see a reason to report an 
out-of-range nodata value.

> 
> Thanks.
> 
> > To: gdal-dev at lists.osgeo.org
> > From: jukka.rahkonen at maanmittauslaitos.fi
> > Date: Tue, 19 May 2015 13:43:38 +0000
> > Subject: Re: [gdal-dev] RFC 58: Removing Dataset Nodata Value
> > 
> > Ivan Lucena <lucena_ivan <at> hotmail.com> writes:
> > > Would that be feasible to accept the option "-a_nodata NO" on GDAL
> > > command
> > 
> > lines, to indicate that NoData should not pass from the input to the
> > output dataset?
> > 
> > Would it be something different than "-a_nodata none"?
> > 
> > -a_nodata value:
> >     Assign a specified nodata value to output bands. Starting with GDAL
> > 
> > 1.8.0, can be set to none to avoid setting a nodata value to the output
> > file if one exists for the source file. Note that, if the input dataset
> > has a nodata value, this does not cause pixel values that are equal to
> > that nodata value to be changed to the value specified with this option.
> > 
> > -Jukka Rahkonen-
> > 
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From lucena_ivan at hotmail.com  Tue May 19 07:23:46 2015
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Tue, 19 May 2015 10:23:46 -0400
Subject: [gdal-dev] RFC 58: Removing Dataset Nodata Value
In-Reply-To: <201505191610.38720.even.rouault@spatialys.com>
References: <CADPhZXy54dxXZ61gJeszo-aw722B4Ogb0VBV_zwJQg9SrS4bEQ@mail.gmail.com>
	<loom.20150519T154146-614@post.gmane.org>
	<BLU173-W2C6335B99F6DEAB6F317990C30@phx.gbl>,
	<201505191610.38720.even.rouault@spatialys.com>
Message-ID: <BLU173-W356305CA25CDFFDB77C52390C30@phx.gbl>



> From: even.rouault at spatialys.com
> To: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] RFC 58: Removing Dataset Nodata Value
> Date: Tue, 19 May 2015 16:10:38 +0200
> CC: lucena_ivan at hotmail.com; jukka.rahkonen at maanmittauslaitos.fi
> 
> Le mardi 19 mai 2015 16:06:59, Ivan Lucena a ?crit :
> > Jukka/Even,
> > 
> > Yes, you guy are right. The  "-a_nodata none" will help but I still need to
> > implement a value range check on my CreateCopy anyway. So users don't need
> > to run gdal_translate again after they find the problem or use "-a_nodata
> > none" all the time (in a script for example) and miss the good ones.
> 
> I'm wondering if it might not make more sense to modify the input driver(s) to 
> not report out-of-range nodata values ? I fail to see a reason to report an 
> out-of-range nodata value.
> 

That makes sense but we would need to go though all drivers and copy&paste the value range check code to avoid reporting wrong values. Could the core GetNoDataValue do that instead?

> > 
> > Thanks.
> > 
> > > To: gdal-dev at lists.osgeo.org
> > > From: jukka.rahkonen at maanmittauslaitos.fi
> > > Date: Tue, 19 May 2015 13:43:38 +0000
> > > Subject: Re: [gdal-dev] RFC 58: Removing Dataset Nodata Value
> > > 
> > > Ivan Lucena <lucena_ivan <at> hotmail.com> writes:
> > > > Would that be feasible to accept the option "-a_nodata NO" on GDAL
> > > > command
> > > 
> > > lines, to indicate that NoData should not pass from the input to the
> > > output dataset?
> > > 
> > > Would it be something different than "-a_nodata none"?
> > > 
> > > -a_nodata value:
> > >     Assign a specified nodata value to output bands. Starting with GDAL
> > > 
> > > 1.8.0, can be set to none to avoid setting a nodata value to the output
> > > file if one exists for the source file. Note that, if the input dataset
> > > has a nodata value, this does not cause pixel values that are equal to
> > > that nodata value to be changed to the value specified with this option.
> > > 
> > > -Jukka Rahkonen-
> > > 
> > > _______________________________________________
> > > gdal-dev mailing list
> > > gdal-dev at lists.osgeo.org
> > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com
 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150519/bff7428f/attachment-0001.html>

From even.rouault at spatialys.com  Tue May 19 07:26:34 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 19 May 2015 16:26:34 +0200
Subject: [gdal-dev] RFC 58: Removing Dataset Nodata Value
In-Reply-To: <BLU173-W496CA14DBF7D84441726D490C30@phx.gbl>
References: <CADPhZXy54dxXZ61gJeszo-aw722B4Ogb0VBV_zwJQg9SrS4bEQ@mail.gmail.com>
	<201505191610.38720.even.rouault@spatialys.com>
	<BLU173-W496CA14DBF7D84441726D490C30@phx.gbl>
Message-ID: <201505191626.34860.even.rouault@spatialys.com>

Le mardi 19 mai 2015 16:16:05, Ivan Lucena a ?crit :
> > From: even.rouault at spatialys.com
> > To: gdal-dev at lists.osgeo.org
> > Subject: Re: [gdal-dev] RFC 58: Removing Dataset Nodata Value
> > Date: Tue, 19 May 2015 16:10:38 +0200
> > CC: lucena_ivan at hotmail.com; jukka.rahkonen at maanmittauslaitos.fi
> > 
> > Le mardi 19 mai 2015 16:06:59, Ivan Lucena a ?crit :
> > > Jukka/Even,
> > > 
> > > Yes, you guy are right. The  "-a_nodata none" will help but I still
> > > need to implement a value range check on my CreateCopy anyway. So
> > > users don't need to run gdal_translate again after they find the
> > > problem or use "-a_nodata none" all the time (in a script for example)
> > > and miss the good ones.
> > 
> > I'm wondering if it might not make more sense to modify the input
> > driver(s) to not report out-of-range nodata values ? I fail to see a
> > reason to report an out-of-range nodata value.
> 
> That makes sense but we would need to go though all drivers and basically
> copy&paste a value range code.
> 
> Could the GDAL *Core* GetNoDataValue do that instead?

Not really since GetNoDataValue() is a virtual method implemented in drivers 
that overload it.

We could however have a core internal helper method, let's say 
GDALRasterBand::IsValueInRange(double) ( or perhaps a more general purpose 
function in gcore/gdal_misc.cpp GDALDataTypeIsValueInRange(GDALDataType,  
double) ) that would do the check and would be called by drivers that need it.

> 
> > > Thanks.
> > > 
> > > > To: gdal-dev at lists.osgeo.org
> > > > From: jukka.rahkonen at maanmittauslaitos.fi
> > > > Date: Tue, 19 May 2015 13:43:38 +0000
> > > > Subject: Re: [gdal-dev] RFC 58: Removing Dataset Nodata Value
> > > > 
> > > > Ivan Lucena <lucena_ivan <at> hotmail.com> writes:
> > > > > Would that be feasible to accept the option "-a_nodata NO" on GDAL
> > > > > command
> > > > 
> > > > lines, to indicate that NoData should not pass from the input to the
> > > > output dataset?
> > > > 
> > > > Would it be something different than "-a_nodata none"?
> > > > 
> > > > -a_nodata value:
> > > >     Assign a specified nodata value to output bands. Starting with
> > > >     GDAL
> > > > 
> > > > 1.8.0, can be set to none to avoid setting a nodata value to the
> > > > output file if one exists for the source file. Note that, if the
> > > > input dataset has a nodata value, this does not cause pixel values
> > > > that are equal to that nodata value to be changed to the value
> > > > specified with this option.
> > > > 
> > > > -Jukka Rahkonen-
> > > > 
> > > > _______________________________________________
> > > > gdal-dev mailing list
> > > > gdal-dev at lists.osgeo.org
> > > > http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Tue May 19 07:31:52 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Tue, 19 May 2015 14:31:52 +0000 (UTC)
Subject: [gdal-dev] RFC 58: Removing Dataset Nodata Value
References: <CADPhZXy54dxXZ61gJeszo-aw722B4Ogb0VBV_zwJQg9SrS4bEQ@mail.gmail.com>
	<loom.20150519T154146-614@post.gmane.org>
	<BLU173-W2C6335B99F6DEAB6F317990C30@phx.gbl>
	<201505191610.38720.even.rouault@spatialys.com>
Message-ID: <loom.20150519T162511-836@post.gmane.org>

Even Rouault <even.rouault <at> spatialys.com> writes:


> 
> I'm wondering if it might not make more sense to modify the input
driver(s) to 
> not report out-of-range nodata values ? I fail to see a reason to report an 
> out-of-range nodata value.

I wonder what happens for the nodata value if we convert images with GDAL
into types with more narrow range (32-bit -> 16-bit -> byte). Can the
out-of-range nodata values be our own creatures sometimes or do we handle
the case perfectly?

-Jukka Rahkonen-


From even.rouault at spatialys.com  Tue May 19 07:47:23 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 19 May 2015 16:47:23 +0200
Subject: [gdal-dev] RFC 58: Removing Dataset Nodata Value
In-Reply-To: <loom.20150519T162511-836@post.gmane.org>
References: <CADPhZXy54dxXZ61gJeszo-aw722B4Ogb0VBV_zwJQg9SrS4bEQ@mail.gmail.com>
	<201505191610.38720.even.rouault@spatialys.com>
	<loom.20150519T162511-836@post.gmane.org>
Message-ID: <201505191647.23353.even.rouault@spatialys.com>

Le mardi 19 mai 2015 16:31:52, Jukka Rahkonen a ?crit :
> Even Rouault <even.rouault <at> spatialys.com> writes:
> > I'm wondering if it might not make more sense to modify the input
> 
> driver(s) to
> 
> > not report out-of-range nodata values ? I fail to see a reason to report
> > an out-of-range nodata value.
> 
> I wonder what happens for the nodata value if we convert images with GDAL
> into types with more narrow range (32-bit -> 16-bit -> byte). Can the
> out-of-range nodata values be our own creatures sometimes or do we handle
> the case perfectly?

That should presumably be the job of the gdal_translate utility to remove a 
nodata value that would become out-of-range because of this conversion. Or 
perhaps clamp it with warning ?, since that's what it will do for pixel values 
(i.e. if you've a value at -99999 in int32, it will become -32768 in int16).

> 
> -Jukka Rahkonen-
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From cavallini at faunalia.it  Tue May 19 07:48:20 2015
From: cavallini at faunalia.it (Paolo Cavallini)
Date: Tue, 19 May 2015 16:48:20 +0200
Subject: [gdal-dev] buildvrt and reverse BW images
Message-ID: <555B4D34.5070102@faunalia.it>

Hi all.
I have several images, appearing correctly in BW, but with different
color tables:

  Color Table (RGB with 2 entries)
    0: 255,255,255,255
    1: 0,0,0,255

  Color Table (RGB with 2 entries)
    0: 0,0,0,255
    1: 255,255,255,255

When building a virtual raster, obviously they appear reversed (some BW,
some WB). Is there a way to build a uniform virtual raster, without
manually changing the single rasters?

Thanks.
-- 
Paolo Cavallini - www.faunalia.eu
QGIS & PostGIS courses: http://www.faunalia.eu/training.html

From even.rouault at spatialys.com  Tue May 19 09:13:58 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 19 May 2015 18:13:58 +0200
Subject: [gdal-dev] buildvrt and reverse BW images
In-Reply-To: <555B4D34.5070102@faunalia.it>
References: <555B4D34.5070102@faunalia.it>
Message-ID: <201505191813.58042.even.rouault@spatialys.com>

Le mardi 19 mai 2015 16:48:20, Paolo Cavallini a ?crit :
> Hi all.
> I have several images, appearing correctly in BW, but with different
> color tables:
> 
>   Color Table (RGB with 2 entries)
>     0: 255,255,255,255
>     1: 0,0,0,255
> 
>   Color Table (RGB with 2 entries)
>     0: 0,0,0,255
>     1: 255,255,255,255
> 
> When building a virtual raster, obviously they appear reversed (some BW,
> some WB). Is there a way to build a uniform virtual raster, without
> manually changing the single rasters?

Well, you could cheat a bit by generating inverted VRT for one of the two 
categories with :
gdal_translate in.tif -scale 1 0 0 1 inverted.vrt -of vrt
(if you display it it will not be consistent since only the values will be 
inverted, not the color table, but that's not important since the mosaic VRT 
ignore the color table of individual sources)
And then gdalbuildvrt the "reference" images and the inverted VRTs (make sure 
you put in first in the list a "reference" image so it color palettes gets 
selected)


> 
> Thanks.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From claire.porter at gmail.com  Tue May 19 15:54:19 2015
From: claire.porter at gmail.com (Claire Porter)
Date: Tue, 19 May 2015 17:54:19 -0500
Subject: [gdal-dev] JP2OpenJPEG Driver Reads 4th Band of NITF as Alpha
Message-ID: <CAN07go-sHfPm0zttPPgE93K9ZMMWNVOLGpNjwnA2gU8oGr1pGA@mail.gmail.com>

Hello,

I use the OpenJPEG 2.0 driver to decode the JP2 images within NITF files
(1B level NITF images from DigitalGlobe).  For 4 band images, the driver
interprets the 4th band as Alpha.  When I warp the imagery using gdalwarp,
the 4th band in the output is all zeros. If I convert the image using
gdal_translate, the 11 bit values in the 4th band are truncated to 255.
Using GTiff creation options of PHOTOMETRIC=RGB or MINISBLACK and ALPHA=NO
do not change the results.

I found this only occurs with the OpenJPEG driver. The Jasper, Kakadu, and
ECW drivers interpret the 4th band as Undefined and the 4th band behaves
normally in gdalwarp and gdal_translate.  I've tried gdal versions from
1.9.0 to 1.11.1.  I thought perhaps the issue would be solved in OpenJPEG
2.1, and so I tried compiling GDAL 1.11.1 with OpenJPEG 2.1.0.  But, that
still resulted in the 4th band being read as Alpha.

I'd really like to continue using OpenJPEG since it will be so well
supported in GDAL 2.0.  Anyone know a work around for this?  Is this a GDAL
issue or an OpenJPEG issue?

Thanks,
Claire


*gdalinfo using the OpenJPEG driver and GDAL 1.11.1:*

OPENJPEG: info: Start to read j2k main header (0).
OPENJPEG: info: Main header has been correctly decoded.
GDAL:
GDALOpen(/vsisubfile/3935_198497332,output/WV02_12OCT082110317-M1BS-103001001B68B600.ntf,
this=0x948760) succeeds as JP2OpenJPEG.
GDAL: NITFDataset::Open() wasn't able to derive a first order
geotransform.  It will be returned as GCPs.
GDAL: GDALDefaultOverviews::OverviewScan()
GDAL: GDALOpen(output/WV02_12OCT082110317-M1BS-103001001B68B600.ntf,
this=0x8bfd10) succeeds as NITF.
Driver: NITF/National Imagery Transmission Format
Files: output/WV02_12OCT082110317-M1BS-103001001B68B600.ntf
       output/WV02_12OCT082110317-M1BS-103001001B68B600.xml
Size is 9216, 8192
Coordinate System is `'
GCP Projection =
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563,
...........
  SAMP_OFF=4409
  SAMP_SCALE=4410
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0, 8192.0)
Upper Right ( 9216.0,    0.0)
Lower Right ( 9216.0, 8192.0)
Center      ( 4608.0, 4096.0)
Band 1 Block=1024x1024 Type=UInt16, ColorInterp=Blue
  Overviews: 4608x4096, 2304x2048, 1152x1024, 576x512, 288x256
  Overviews: arbitrary
  Image Structure Metadata:
    NBITS=11
Band 2 Block=1024x1024 Type=UInt16, ColorInterp=Green
  Overviews: 4608x4096, 2304x2048, 1152x1024, 576x512, 288x256
  Overviews: arbitrary
  Image Structure Metadata:
    NBITS=11
Band 3 Block=1024x1024 Type=UInt16, ColorInterp=Red
  Overviews: 4608x4096, 2304x2048, 1152x1024, 576x512, 288x256
  Overviews: arbitrary
  Image Structure Metadata:
    NBITS=11
Band 4 Block=1024x1024 Type=UInt16, ColorInterp=*Alpha*
  Overviews: 4608x4096, 2304x2048, 1152x1024, 576x512, 288x256
  Overviews: arbitrary
  Image Structure Metadata:
    NBITS=11
GDAL:
GDALClose(/vsisubfile/3935_198497332,output/WV02_12OCT082110317-M1BS-103001001B68B600.ntf,
this=0x94d3f0)
GDAL:
GDALClose(/vsisubfile/3935_198497332,output/WV02_12OCT082110317-M1BS-103001001B68B600.ntf,
this=0x948760)
GDAL: GDALClose(output/WV02_12OCT082110317-M1BS-103001001B68B600.ntf,
this=0x8bfd10)


*gdalinfo using** ECW and 1.11.1 (Jasper and Kakadu are similar):*

ECW:
NCScbmOpenFileView(/vsisubfile/3935_198497332,Z:\claire\debug_ortho\output2\WV02_12OCT082110317-M1BS-103001001B68B600.ntf):
eErr=2, will try VSIL stream.
ECW: Got mutex.
ECW: Using filename 'C:\Users\porte254\AppData\Local\Temp\99544_0.ntf' for
temporary directory determination purposes.
ECW: Using filename 'C:\Users\porte254\AppData\Local\Temp\99544_1.ntf' for
temporary directory determination purposes.
ECW: Using filename 'C:\Users\porte254\AppData\Local\Temp\99544_2.ntf' for
temporary directory determination purposes.
ECW: Using filename 'C:\Users\porte254\AppData\Local\Temp\99544_3.ntf' for
temporary directory determination purposes.
ECW: Using filename 'C:\Users\porte254\AppData\Local\Temp\99544_4.ntf' for
temporary directory determination purposes.
ECW: Using filename 'C:\Users\porte254\AppData\Local\Temp\99544_5.ntf' for
temporary directory determination purposes.
ECW: Using filename 'C:\Users\porte254\AppData\Local\Temp\99544_6.ntf' for
temporary directory determination purposes.
ECW: Using filename 'C:\Users\porte254\AppData\Local\Temp\99544_7.ntf' for
temporary directory determination purposes.
ECW: Using filename 'C:\Users\porte254\AppData\Local\Temp\99544_8.ntf' for
temporary directory determination purposes.
ECW: FileInfo: SizeXY=9216,8192 Bands=4
       OriginXY=0,0  CellIncrementXY=1,1
       ColorSpace=3, eCellType=1

GDAL:
GDALOpen(/vsisubfile/3935_198497332,Z:\claire\debug_ortho\output2\WV02_12OCT082110317-M1BS-103001001B68B600.ntf,
this=000000000032FBA0) succeeds as JP2ECW.
GDAL: NITFDataset::Open() wasn't able to derive a first order
geotransform.  It will be returned as GCPs.
GDAL: GDALDefaultOverviews::OverviewScan()
GDAL:
GDALOpen(Z:\claire\debug_ortho\output2\WV02_12OCT082110317-M1BS-103001001B68B600.ntf,
this=000000000031EC40) succeeds as NITF.
Driver: NITF/National Imagery Transmission Format
Files: output2\WV02_12OCT082110317-M1BS-103001001B68B600.ntf
         output2\WV02_12OCT082110317-M1BS-103001001B68B600.XML
Size is 9216, 8192
Coordinate System is `'
GCP Projection =
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563,
        .....................................................
  SAMP_OFF=4409
  SAMP_SCALE=4410
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0, 8192.0)
Upper Right ( 9216.0,    0.0)
Lower Right ( 9216.0, 8192.0)
Center      ( 4608.0, 4096.0)
Band 1 Block=256x256 Type=UInt16, ColorInterp=Blue
  Overviews: 4608x4096, 2304x2048, 1152x1024, 576x512, 288x256
  Image Structure Metadata:
    NBITS=11
Band 2 Block=256x256 Type=UInt16, ColorInterp=Green
  Overviews: 4608x4096, 2304x2048, 1152x1024, 576x512, 288x256
  Image Structure Metadata:
    NBITS=11
Band 3 Block=256x256 Type=UInt16, ColorInterp=Red
  Overviews: 4608x4096, 2304x2048, 1152x1024, 576x512, 288x256
  Image Structure Metadata:
    NBITS=11
Band 4 Block=256x256 Type=UInt16, ColorInterp=*Undefined*
  Overviews: 4608x4096, 2304x2048, 1152x1024, 576x512, 288x256
  Image Structure Metadata:
    NBITS=11
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150519/40485ce7/attachment.html>

From james.evans.4 at us.af.mil  Tue May 19 16:06:27 2015
From: james.evans.4 at us.af.mil (EVANS, JAMES R GS-13 USAF ACC 84 RADES/SCZE)
Date: Tue, 19 May 2015 23:06:27 +0000
Subject: [gdal-dev] JP2OpenJPEG Driver Reads 4th Band of NITF as Alpha
In-Reply-To: <CAN07go-sHfPm0zttPPgE93K9ZMMWNVOLGpNjwnA2gU8oGr1pGA@mail.gmail.com>
References: <CAN07go-sHfPm0zttPPgE93K9ZMMWNVOLGpNjwnA2gU8oGr1pGA@mail.gmail.com>
Message-ID: <20EA793B1BC710448656BDC9BD25C4A12F8D2960@52ZHTX-D07-04D.area52.afnoapps.usaf.mil>

Claire,
About a year ago I had a similar issue reading NAIP imagery.  I was able to use Global Mapper to convert the images.  After that MapServer using GDAL could serve the images correctly.  I don't know if that will help you, but it worked for me.  Converting  4.3 TB of imagery took a while....

-----Original Message-----
From: gdal-dev-bounces at lists.osgeo.org [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Claire Porter
Sent: Tuesday, May 19, 2015 4:54 PM
To: gdal-dev at lists.osgeo.org
Subject: [gdal-dev] JP2OpenJPEG Driver Reads 4th Band of NITF as Alpha

Hello,

I use the OpenJPEG 2.0 driver to decode the JP2 images within NITF files (1B level NITF images from DigitalGlobe).  For 4 band images, the driver interprets the 4th band as Alpha.  When I warp the imagery using gdalwarp, the 4th band in the output is all zeros. If I convert the image using gdal_translate, the 11 bit values in the 4th band are truncated to 255.  Using GTiff creation options of PHOTOMETRIC=RGB or MINISBLACK and ALPHA=NO do not change the results.

I found this only occurs with the OpenJPEG driver. The Jasper, Kakadu, and ECW drivers interpret the 4th band as Undefined and the 4th band behaves normally in gdalwarp and gdal_translate.  I've tried gdal versions from 1.9.0 to 1.11.1.  I thought perhaps the issue would be solved in OpenJPEG 2.1, and so I tried compiling GDAL 1.11.1 with OpenJPEG 2.1.0.  But, that still resulted in the 4th band being read as Alpha.

I'd really like to continue using OpenJPEG since it will be so well supported in GDAL 2.0.  Anyone know a work around for this?  Is this a GDAL issue or an OpenJPEG issue?

Thanks,
Claire


gdalinfo using the OpenJPEG driver and GDAL 1.11.1:


OPENJPEG: info: Start to read j2k main header (0).
OPENJPEG: info: Main header has been correctly decoded.
GDAL: GDALOpen(/vsisubfile/3935_198497332,output/WV02_12OCT082110317-M1BS-103001001B68B600.ntf, this=0x948760) succeeds as JP2OpenJPEG.
GDAL: NITFDataset::Open() wasn't able to derive a first order geotransform.  It will be returned as GCPs.
GDAL: GDALDefaultOverviews::OverviewScan()
GDAL: GDALOpen(output/WV02_12OCT082110317-M1BS-103001001B68B600.ntf, this=0x8bfd10) succeeds as NITF.
Driver: NITF/National Imagery Transmission Format
Files: output/WV02_12OCT082110317-M1BS-103001001B68B600.ntf
       output/WV02_12OCT082110317-M1BS-103001001B68B600.xml
Size is 9216, 8192
Coordinate System is `'
GCP Projection =
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563, ...........
  SAMP_OFF=4409
  SAMP_SCALE=4410
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0, 8192.0)
Upper Right ( 9216.0,    0.0)
Lower Right ( 9216.0, 8192.0)
Center      ( 4608.0, 4096.0)
Band 1 Block=1024x1024 Type=UInt16, ColorInterp=Blue
  Overviews: 4608x4096, 2304x2048, 1152x1024, 576x512, 288x256
  Overviews: arbitrary
  Image Structure Metadata:
    NBITS=11
Band 2 Block=1024x1024 Type=UInt16, ColorInterp=Green
  Overviews: 4608x4096, 2304x2048, 1152x1024, 576x512, 288x256
  Overviews: arbitrary
  Image Structure Metadata:
    NBITS=11
Band 3 Block=1024x1024 Type=UInt16, ColorInterp=Red
  Overviews: 4608x4096, 2304x2048, 1152x1024, 576x512, 288x256
  Overviews: arbitrary
  Image Structure Metadata:
    NBITS=11
Band 4 Block=1024x1024 Type=UInt16, ColorInterp=Alpha
  Overviews: 4608x4096, 2304x2048, 1152x1024, 576x512, 288x256
  Overviews: arbitrary
  Image Structure Metadata:
    NBITS=11
GDAL: GDALClose(/vsisubfile/3935_198497332,output/WV02_12OCT082110317-M1BS-103001001B68B600.ntf, this=0x94d3f0)
GDAL: GDALClose(/vsisubfile/3935_198497332,output/WV02_12OCT082110317-M1BS-103001001B68B600.ntf, this=0x948760)
GDAL: GDALClose(output/WV02_12OCT082110317-M1BS-103001001B68B600.ntf, this=0x8bfd10)


gdalinfo using ECW and 1.11.1 (Jasper and Kakadu are similar):

ECW: NCScbmOpenFileView(/vsisubfile/3935_198497332,Z:\claire\debug_ortho\output2\WV02_12OCT082110317-M1BS-103001001B68B600.ntf): eErr=2, will try VSIL stream.
ECW: Got mutex.
ECW: Using filename 'C:\Users\porte254\AppData\Local\Temp\99544_0.ntf' for temporary directory determination purposes.
ECW: Using filename 'C:\Users\porte254\AppData\Local\Temp\99544_1.ntf' for temporary directory determination purposes.
ECW: Using filename 'C:\Users\porte254\AppData\Local\Temp\99544_2.ntf' for temporary directory determination purposes.
ECW: Using filename 'C:\Users\porte254\AppData\Local\Temp\99544_3.ntf' for temporary directory determination purposes.
ECW: Using filename 'C:\Users\porte254\AppData\Local\Temp\99544_4.ntf' for temporary directory determination purposes.
ECW: Using filename 'C:\Users\porte254\AppData\Local\Temp\99544_5.ntf' for temporary directory determination purposes.
ECW: Using filename 'C:\Users\porte254\AppData\Local\Temp\99544_6.ntf' for temporary directory determination purposes.
ECW: Using filename 'C:\Users\porte254\AppData\Local\Temp\99544_7.ntf' for temporary directory determination purposes.
ECW: Using filename 'C:\Users\porte254\AppData\Local\Temp\99544_8.ntf' for temporary directory determination purposes.
ECW: FileInfo: SizeXY=9216,8192 Bands=4
       OriginXY=0,0  CellIncrementXY=1,1
       ColorSpace=3, eCellType=1


GDAL: GDALOpen(/vsisubfile/3935_198497332,Z:\claire\debug_ortho\output2\WV02_12OCT082110317-M1BS-103001001B68B600.ntf, this=000000000032FBA0) succeeds as JP2ECW.
GDAL: NITFDataset::Open() wasn't able to derive a first order
geotransform.  It will be returned as GCPs.
GDAL: GDALDefaultOverviews::OverviewScan()
GDAL: GDALOpen(Z:\claire\debug_ortho\output2\WV02_12OCT082110317-M1BS-103001001B68B600.ntf, this=000000000031EC40) succeeds as NITF.
Driver: NITF/National Imagery Transmission Format
Files: output2\WV02_12OCT082110317-M1BS-103001001B68B600.ntf
         output2\WV02_12OCT082110317-M1BS-103001001B68B600.XML
Size is 9216, 8192
Coordinate System is `'
GCP Projection = 
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563,
        .....................................................
  SAMP_OFF=4409
  SAMP_SCALE=4410
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0, 8192.0)
Upper Right ( 9216.0,    0.0)
Lower Right ( 9216.0, 8192.0)
Center      ( 4608.0, 4096.0)
Band 1 Block=256x256 Type=UInt16, ColorInterp=Blue
  Overviews: 4608x4096, 2304x2048, 1152x1024, 576x512, 288x256
  Image Structure Metadata:
    NBITS=11
Band 2 Block=256x256 Type=UInt16, ColorInterp=Green
  Overviews: 4608x4096, 2304x2048, 1152x1024, 576x512, 288x256
  Image Structure Metadata:
    NBITS=11
Band 3 Block=256x256 Type=UInt16, ColorInterp=Red
  Overviews: 4608x4096, 2304x2048, 1152x1024, 576x512, 288x256
  Image Structure Metadata:
    NBITS=11
Band 4 Block=256x256 Type=UInt16, ColorInterp=Undefined
  Overviews: 4608x4096, 2304x2048, 1152x1024, 576x512, 288x256
  Image Structure Metadata:
    NBITS=11


From xialang2012 at 163.com  Tue May 19 17:18:23 2015
From: xialang2012 at 163.com (xialang2012)
Date: Wed, 20 May 2015 08:18:23 +0800
Subject: [gdal-dev] help about the GDAL efficiency
Message-ID: <4c9168e7.2f2.14d6eae750a.Coremail.xialang2012@163.com>

Hi, 

I used GDAL to reproject the TM images, and the original projection of the TM images was longitude/latitude WGS84, the final projection was UTM 51. The codes I used is as following:

void doCore()
{

 GDALDataType eDT;
 GDALDataset *hDstDS;
 GDALDataset *hSrcDS;

 GDALAllRegister();

 //  cache Max
 GDALSetCacheMax(1024*1024*1024);

 // open file
 hSrcDS = (GDALDataset *)GDALOpen( "G:\\Data\\TM\\0_Water_Vapor_Near_Infrared.tif", GA_ReadOnly );
 CPLAssert( hSrcDS != NULL );

 GDALRasterBand *iBand1 = hSrcDS->GetRasterBand(1); 

 const char *pszSrcWKT;
 char *pszDstWKT = NULL;
 pszSrcWKT = GDALGetProjectionRef( hSrcDS );
 CPLAssert( pszSrcWKT != NULL && strlen(pszSrcWKT) > 0 );


    // set UTM
 OGRSpatialReference oSRS;
 oSRS.SetUTM(51, TRUE);
 oSRS.SetWellKnownGeogCS("WGS84");
 oSRS.exportToWkt( &pszDstWKT );

 void *hTransformArg;
 hTransformArg = GDALCreateGenImgProjTransformer( hSrcDS, pszSrcWKT, NULL, pszDstWKT, FALSE, 0, 1 );
 CPLAssert( hTransformArg != NULL );

 // calculate 6 parameters 
 double adfDstGeoTransform[6];
 int nPixels=0, nLines=0;
 CPLErr eErr;
 eErr = GDALSuggestedWarpOutput( hSrcDS, GDALGenImgProjTransform, hTransformArg, adfDstGeoTransform, &nPixels, &nLines );
 CPLAssert( eErr == CE_None );
 GDALDestroyGenImgProjTransformer(hTransformArg);


 // create out file
 eDT = GDALDataType(iBand1->GetRasterDataType());
 GDALDriver *hDriver = (GDALDriver *)GDALGetDriverByName( "GTiff" );
 CPLAssert( hDriver != NULL );
 hDstDS = (GDALDataset *)GDALCreate( hDriver, "G:\\data\\TM\\out.tif", nPixels, nLines, GDALGetRasterCount(hSrcDS), eDT, NULL );
 CPLAssert( hDstDS != NULL );

 // write projection info
 hDstDS->SetProjection(pszDstWKT);
 hDstDS->SetGeoTransform(adfDstGeoTransform);

 // create warp info 
 GDALWarpOptions *psWarpOptions = GDALCreateWarpOptions();

 psWarpOptions->dfWarpMemoryLimit = 1024*1024*1024;
 psWarpOptions->hSrcDS = hSrcDS;
 psWarpOptions->hDstDS = hDstDS;

 psWarpOptions->nBandCount = 1;
 psWarpOptions->panSrcBands = (int *) CPLMalloc(sizeof(int) );
 psWarpOptions->panSrcBands[0] = 1;
 psWarpOptions->panDstBands = (int *) CPLMalloc(sizeof(int) );
 psWarpOptions->panDstBands[0] = 1;

 psWarpOptions->pfnProgress = GDALTermProgress;

 psWarpOptions->pTransformerArg = GDALCreateGenImgProjTransformer( hSrcDS, pszSrcWKT, hDstDS, pszDstWKT, FALSE, 0, 1 );
 psWarpOptions->pfnTransformer = GDALGenImgProjTransform;

 // do it 
 GDALWarpOperation oOPeration;
 oOPeration.Initialize(psWarpOptions);
 oOPeration.ChunkAndWarpMulti(0, 0, nPixels, nLines);

 GDALDestroyGenImgProjTransformer(psWarpOptions->pTransformerArg);
 GDALDestroyWarpOptions( psWarpOptions );
 CPLFree(pszDstWKT);

 GDALClose(hDstDS);
 GDALClose(hSrcDS);
}

However, the time which the codes spent to process one image is about 70 seconds in VS 2010 x64 release, and in ENVI/IDL, it was only spend 45 seconds. So, I am wonder whether something wrong in my codes? Thanks!

Yours,
Xia Lang


2015-05-18


xialang2012 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150520/56a5ee34/attachment.html>

From cavallini at faunalia.it  Tue May 19 23:24:53 2015
From: cavallini at faunalia.it (Paolo Cavallini)
Date: Wed, 20 May 2015 08:24:53 +0200
Subject: [gdal-dev] buildvrt and reverse BW images
In-Reply-To: <201505191813.58042.even.rouault@spatialys.com>
References: <555B4D34.5070102@faunalia.it>
	<201505191813.58042.even.rouault@spatialys.com>
Message-ID: <555C28B5.6020004@faunalia.it>

Il 19/05/2015 18:13, Even Rouault ha scritto:

> Well, you could cheat a bit by generating inverted VRT for one of the two 
> categories with :

Merci Even.

-- 
Paolo Cavallini - www.faunalia.eu
QGIS & PostGIS courses: http://www.faunalia.eu/training.html

From even.rouault at spatialys.com  Wed May 20 01:24:57 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 20 May 2015 10:24:57 +0200
Subject: [gdal-dev] JP2OpenJPEG Driver Reads 4th Band of NITF as Alpha
In-Reply-To: <20EA793B1BC710448656BDC9BD25C4A12F8D2960@52ZHTX-D07-04D.area52.afnoapps.usaf.mil>
References: <CAN07go-sHfPm0zttPPgE93K9ZMMWNVOLGpNjwnA2gU8oGr1pGA@mail.gmail.com>
	<20EA793B1BC710448656BDC9BD25C4A12F8D2960@52ZHTX-D07-04D.area52.afnoapps.usaf.mil>
Message-ID: <201505201024.57628.even.rouault@spatialys.com>

Le mercredi 20 mai 2015 01:06:27, EVANS, JAMES R GS-13 USAF ACC 84 RADES/SCZE 
a ?crit :
> Claire,
> About a year ago I had a similar issue reading NAIP imagery.  I was able to
> use Global Mapper to convert the images.  After that MapServer using GDAL
> could serve the images correctly.  I don't know if that will help you, but
> it worked for me.  Converting  4.3 TB of imagery took a while....

This has been fixed in GDAL 2.0dev. Try beta1 : 
http://download.osgeo.org/gdal/2.0.0beta1/

Otherwise a workaround to avoid creating geotiffs is to gdal_translate to a 
VRT, and remove the Alpha color interpretation from the 4th band.

> 
> -----Original Message-----
> From: gdal-dev-bounces at lists.osgeo.org
> [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Claire Porter Sent:
> Tuesday, May 19, 2015 4:54 PM
> To: gdal-dev at lists.osgeo.org
> Subject: [gdal-dev] JP2OpenJPEG Driver Reads 4th Band of NITF as Alpha
> 
> Hello,
> 
> I use the OpenJPEG 2.0 driver to decode the JP2 images within NITF files
> (1B level NITF images from DigitalGlobe).  For 4 band images, the driver
> interprets the 4th band as Alpha.  When I warp the imagery using gdalwarp,
> the 4th band in the output is all zeros. If I convert the image using
> gdal_translate, the 11 bit values in the 4th band are truncated to 255. 
> Using GTiff creation options of PHOTOMETRIC=RGB or MINISBLACK and ALPHA=NO
> do not change the results.
> 
> I found this only occurs with the OpenJPEG driver. The Jasper, Kakadu, and
> ECW drivers interpret the 4th band as Undefined and the 4th band behaves
> normally in gdalwarp and gdal_translate.  I've tried gdal versions from
> 1.9.0 to 1.11.1.  I thought perhaps the issue would be solved in OpenJPEG
> 2.1, and so I tried compiling GDAL 1.11.1 with OpenJPEG 2.1.0.  But, that
> still resulted in the 4th band being read as Alpha.
> 
> I'd really like to continue using OpenJPEG since it will be so well
> supported in GDAL 2.0.  Anyone know a work around for this?  Is this a
> GDAL issue or an OpenJPEG issue?
> 
> Thanks,
> Claire
> 
> 
> gdalinfo using the OpenJPEG driver and GDAL 1.11.1:
> 
> 
> OPENJPEG: info: Start to read j2k main header (0).
> OPENJPEG: info: Main header has been correctly decoded.
> GDAL:
> GDALOpen(/vsisubfile/3935_198497332,output/WV02_12OCT082110317-M1BS-103001
> 001B68B600.ntf, this=0x948760) succeeds as JP2OpenJPEG. GDAL:
> NITFDataset::Open() wasn't able to derive a first order geotransform.  It
> will be returned as GCPs. GDAL: GDALDefaultOverviews::OverviewScan()
> GDAL: GDALOpen(output/WV02_12OCT082110317-M1BS-103001001B68B600.ntf,
> this=0x8bfd10) succeeds as NITF. Driver: NITF/National Imagery
> Transmission Format
> Files: output/WV02_12OCT082110317-M1BS-103001001B68B600.ntf
>        output/WV02_12OCT082110317-M1BS-103001001B68B600.xml
> Size is 9216, 8192
> Coordinate System is `'
> GCP Projection =
> GEOGCS["WGS 84",
>     DATUM["WGS_1984",
>         SPHEROID["WGS 84",6378137,298.257223563, ...........
>   SAMP_OFF=4409
>   SAMP_SCALE=4410
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0, 8192.0)
> Upper Right ( 9216.0,    0.0)
> Lower Right ( 9216.0, 8192.0)
> Center      ( 4608.0, 4096.0)
> Band 1 Block=1024x1024 Type=UInt16, ColorInterp=Blue
>   Overviews: 4608x4096, 2304x2048, 1152x1024, 576x512, 288x256
>   Overviews: arbitrary
>   Image Structure Metadata:
>     NBITS=11
> Band 2 Block=1024x1024 Type=UInt16, ColorInterp=Green
>   Overviews: 4608x4096, 2304x2048, 1152x1024, 576x512, 288x256
>   Overviews: arbitrary
>   Image Structure Metadata:
>     NBITS=11
> Band 3 Block=1024x1024 Type=UInt16, ColorInterp=Red
>   Overviews: 4608x4096, 2304x2048, 1152x1024, 576x512, 288x256
>   Overviews: arbitrary
>   Image Structure Metadata:
>     NBITS=11
> Band 4 Block=1024x1024 Type=UInt16, ColorInterp=Alpha
>   Overviews: 4608x4096, 2304x2048, 1152x1024, 576x512, 288x256
>   Overviews: arbitrary
>   Image Structure Metadata:
>     NBITS=11
> GDAL:
> GDALClose(/vsisubfile/3935_198497332,output/WV02_12OCT082110317-M1BS-10300
> 1001B68B600.ntf, this=0x94d3f0) GDAL:
> GDALClose(/vsisubfile/3935_198497332,output/WV02_12OCT082110317-M1BS-10300
> 1001B68B600.ntf, this=0x948760) GDAL:
> GDALClose(output/WV02_12OCT082110317-M1BS-103001001B68B600.ntf,
> this=0x8bfd10)
> 
> 
> gdalinfo using ECW and 1.11.1 (Jasper and Kakadu are similar):
> 
> ECW:
> NCScbmOpenFileView(/vsisubfile/3935_198497332,Z:\claire\debug_ortho\output
> 2\WV02_12OCT082110317-M1BS-103001001B68B600.ntf): eErr=2, will try VSIL
> stream. ECW: Got mutex.
> ECW: Using filename 'C:\Users\porte254\AppData\Local\Temp\99544_0.ntf' for
> temporary directory determination purposes. ECW: Using filename
> 'C:\Users\porte254\AppData\Local\Temp\99544_1.ntf' for temporary directory
> determination purposes. ECW: Using filename
> 'C:\Users\porte254\AppData\Local\Temp\99544_2.ntf' for temporary directory
> determination purposes. ECW: Using filename
> 'C:\Users\porte254\AppData\Local\Temp\99544_3.ntf' for temporary directory
> determination purposes. ECW: Using filename
> 'C:\Users\porte254\AppData\Local\Temp\99544_4.ntf' for temporary directory
> determination purposes. ECW: Using filename
> 'C:\Users\porte254\AppData\Local\Temp\99544_5.ntf' for temporary directory
> determination purposes. ECW: Using filename
> 'C:\Users\porte254\AppData\Local\Temp\99544_6.ntf' for temporary directory
> determination purposes. ECW: Using filename
> 'C:\Users\porte254\AppData\Local\Temp\99544_7.ntf' for temporary directory
> determination purposes. ECW: Using filename
> 'C:\Users\porte254\AppData\Local\Temp\99544_8.ntf' for temporary directory
> determination purposes. ECW: FileInfo: SizeXY=9216,8192 Bands=4
>        OriginXY=0,0  CellIncrementXY=1,1
>        ColorSpace=3, eCellType=1
> 
> 
> GDAL:
> GDALOpen(/vsisubfile/3935_198497332,Z:\claire\debug_ortho\output2\WV02_12O
> CT082110317-M1BS-103001001B68B600.ntf, this=000000000032FBA0) succeeds as
> JP2ECW. GDAL: NITFDataset::Open() wasn't able to derive a first order
> geotransform.  It will be returned as GCPs.
> GDAL: GDALDefaultOverviews::OverviewScan()
> GDAL:
> GDALOpen(Z:\claire\debug_ortho\output2\WV02_12OCT082110317-M1BS-103001001B
> 68B600.ntf, this=000000000031EC40) succeeds as NITF. Driver: NITF/National
> Imagery Transmission Format
> Files: output2\WV02_12OCT082110317-M1BS-103001001B68B600.ntf
>          output2\WV02_12OCT082110317-M1BS-103001001B68B600.XML
> Size is 9216, 8192
> Coordinate System is `'
> GCP Projection =
> GEOGCS["WGS 84",
>     DATUM["WGS_1984",
>         SPHEROID["WGS 84",6378137,298.257223563,
>         .....................................................
>   SAMP_OFF=4409
>   SAMP_SCALE=4410
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0, 8192.0)
> Upper Right ( 9216.0,    0.0)
> Lower Right ( 9216.0, 8192.0)
> Center      ( 4608.0, 4096.0)
> Band 1 Block=256x256 Type=UInt16, ColorInterp=Blue
>   Overviews: 4608x4096, 2304x2048, 1152x1024, 576x512, 288x256
>   Image Structure Metadata:
>     NBITS=11
> Band 2 Block=256x256 Type=UInt16, ColorInterp=Green
>   Overviews: 4608x4096, 2304x2048, 1152x1024, 576x512, 288x256
>   Image Structure Metadata:
>     NBITS=11
> Band 3 Block=256x256 Type=UInt16, ColorInterp=Red
>   Overviews: 4608x4096, 2304x2048, 1152x1024, 576x512, 288x256
>   Image Structure Metadata:
>     NBITS=11
> Band 4 Block=256x256 Type=UInt16, ColorInterp=Undefined
>   Overviews: 4608x4096, 2304x2048, 1152x1024, 576x512, 288x256
>   Image Structure Metadata:
>     NBITS=11
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed May 20 01:31:40 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 20 May 2015 10:31:40 +0200
Subject: [gdal-dev] help about the GDAL efficiency
In-Reply-To: <4c9168e7.2f2.14d6eae750a.Coremail.xialang2012@163.com>
References: <4c9168e7.2f2.14d6eae750a.Coremail.xialang2012@163.com>
Message-ID: <201505201031.40655.even.rouault@spatialys.com>

Xia Lang,

> 
> 
>  // create out file
>  eDT = GDALDataType(iBand1->GetRasterDataType());
>  GDALDriver *hDriver = (GDALDriver *)GDALGetDriverByName( "GTiff" );
>  CPLAssert( hDriver != NULL );
>  hDstDS = (GDALDataset *)GDALCreate( hDriver, "G:\\data\\TM\\out.tif",
> nPixels, nLines, GDALGetRasterCount(hSrcDS), eDT, NULL ); 

--> You might consider tiling your output dataset, if that's OK for your use 
(passing TILED=YES as creation optoins)

> CPLAssert(
> hDstDS != NULL );
> 
>  // write projection info
>  hDstDS->SetProjection(pszDstWKT);
>  hDstDS->SetGeoTransform(adfDstGeoTransform);
> 
>  // create warp info
>  GDALWarpOptions *psWarpOptions = GDALCreateWarpOptions();
> 
>  psWarpOptions->dfWarpMemoryLimit = 1024*1024*1024;

--> You likely don't need such a bit value. 60 or 100 MB should be OK.

>  psWarpOptions->hSrcDS = hSrcDS;
>  psWarpOptions->hDstDS = hDstDS;
> 
>  psWarpOptions->nBandCount = 1;
>  psWarpOptions->panSrcBands = (int *) CPLMalloc(sizeof(int) );
>  psWarpOptions->panSrcBands[0] = 1;
>  psWarpOptions->panDstBands = (int *) CPLMalloc(sizeof(int) );
>  psWarpOptions->panDstBands[0] = 1;
> 
>  psWarpOptions->pfnProgress = GDALTermProgress;
> 
>  psWarpOptions->pTransformerArg = GDALCreateGenImgProjTransformer( hSrcDS,
> pszSrcWKT, hDstDS, pszDstWKT, FALSE, 0, 1 ); psWarpOptions->pfnTransformer
> = GDALGenImgProjTransform;

Try adding the following to use an approximate transformer, which is the 
default behaviour of gdalwarp. The computations involved in UTM projection are 
quite heavy and this should help a lot.

/* -------------------------------------------------------------------- */
/*      Warp the transformer with a linear approximator unless the      */
/*      acceptable error is zero.                                       */
/* -------------------------------------------------------------------- */
        double dfErrorThreshold = 0.125;
        {
            psWarpOptions->pTransformerArg =
                GDALCreateApproxTransformer( GDALGenImgProjTransform, 
                                             psWarpOptions->pTransformerArg, 
dfErrorThreshold);
            psWarpOptions->pfnTransformer = GDALApproxTransform;
            GDALApproxTransformerOwnsSubtransformer(psWarpOptions-
>pTransformerArg, TRUE);
        }



> 
>  // do it
>  GDALWarpOperation oOPeration;
>  oOPeration.Initialize(psWarpOptions);
>  oOPeration.ChunkAndWarpMulti(0, 0, nPixels, nLines);
> 
>  GDALDestroyGenImgProjTransformer(psWarpOptions->pTransformerArg);
>  GDALDestroyWarpOptions( psWarpOptions );
>  CPLFree(pszDstWKT);
> 
>  GDALClose(hDstDS);
>  GDALClose(hSrcDS);
> }
> 
> However, the time which the codes spent to process one image is about 70
> seconds in VS 2010 x64 release, and in ENVI/IDL, it was only spend 45
> seconds. So, I am wonder whether something wrong in my codes? Thanks!

Did you compare with the speed of the pre-built gdalwarp utility ? But I'm 
confident that the approximation transformer might be the key to speed up.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From mdsumner at gmail.com  Wed May 20 01:33:33 2015
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 20 May 2015 08:33:33 +0000
Subject: [gdal-dev] gdalwarp problems with MODIS L1B
Message-ID: <CAAcGz9_ejTVp+tik+nATfScvpiV3Hkdm_91=Q9xSKWcChxF5Lg@mail.gmail.com>

Hello, I'm having problems with gdalwarp-ing a MODIS L1B calibrated
radiance dataset.

This file contains 31 SDS subdatasets, the first two here are Latitude and
Longitude arrays and the third is the reflectance data EV_1KM_RefSB. The
geolocation arrays have a pixel and line for every fifth pixel/line in the
data

MOD021KM.A2012062.0455.006.2014220083128.hdf
SUBDATASET_20_NAME=HDF4_SDS:UNKNOWN:"MOD021KM.A2012062.0455.006.2014220083128.hdf":0
SUBDATASET_20_DESC=[406x271] Latitude (32-bit floating-point)
SUBDATASET_21_NAME=HDF4_SDS:UNKNOWN:"MOD021KM.A2012062.0455.006.2014220083128.hdf":1
SUBDATASET_21_DESC=[406x271] Longitude (32-bit floating-point)
SUBDATASET_22_NAME=HDF4_SDS:UNKNOWN:"MOD021KM.A2012062.0455.006.2014220083128.hdf":2
SUBDATASET_22_DESC=[15x2030x1354] EV_1KM_RefSB (16-bit unsigned integer)

By my reading of https://trac.osgeo.org/gdal/wiki/rfc4_geolocate that means
the Geolocation tag from gdalinfo should have a PIXEL_STEP and LINE_STEP of
5, and if I do this I get a much better result but it's still not right.
I've put a jpeg image of the result, with the coastline mapped and not
lining up, here:

http://staff.acecrc.org.au/~mdsumner/mod1.jpg

If I understand correctly, gdalwarp should be able to georeference this
with a simple call, optionally with tr, te, and t_srs values

gdalwarp infile out.tif

The t_srs I use is '+proj=laea +lon_0=60 +lat_0=-70 +ellps=WG84'.

 Here's the gdalinfo output for the EV_1KM_RefSB subdataset for the
relevant section:

gdalinfo HDF4_SDS:UNKNOWN:"MOD021KM.A2012062.0455.006.2014220083128.hdf":2
|  grep 'Geolocation:' -A 10
Geolocation:
  LINE_OFFSET=0
  LINE_STEP=1
  PIXEL_OFFSET=0
  PIXEL_STEP=1
  SRS=GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS
84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],TOWGS84[0,0,0,0,0,0,0],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9108"]],AUTHORITY["EPSG","4326"]]
  X_BAND=1

X_DATASET=HDF4_SDS:UNKNOWN:"MOD021KM.A2012062.0455.006.2014220083128.hdf":1
  Y_BAND=1

Y_DATASET=HDF4_SDS:UNKNOWN:"MOD021KM.A2012062.0455.006.2014220083128.hdf":0
Corner Coordinates:

I get this file originally from here (136 Mb):

ftp://ladsweb.nascom.nasa.gov/allData/6/MOD021KM/2012/062/MOD021KM.A2012062.0455.006.2014220083128.hdf

I see this in 1.11.1 and 2.0.0beta1.

I have also attached the gdalinfo output in full here:

http://staff.acecrc.org.au/~mdsumner/gdalinfo_EV_1KM_RefSB.txt

cheers, Mike.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150520/b6d6116f/attachment-0001.html>

From sfkeller at gmail.com  Wed May 20 02:13:53 2015
From: sfkeller at gmail.com (Stefan Keller)
Date: Wed, 20 May 2015 11:13:53 +0200
Subject: [gdal-dev] GeoPackage vector driver fails if layer name
 contains chars not compatible with SQLite
In-Reply-To: <CAFcOn28D0PrWoWN2bqHdAe8P81fca1QYaKcXypT7U0v94bAyog@mail.gmail.com>
References: <CAFcOn2_N=KGxyCj8u5tWjt_DpiVsbF1tBc=ALVQkQVWncB5g8w@mail.gmail.com>
	<201505181740.31854.even.rouault@spatialys.com>
	<CAFcOn28D0PrWoWN2bqHdAe8P81fca1QYaKcXypT7U0v94bAyog@mail.gmail.com>
Message-ID: <CAFcOn2-oz8GQs++Q__UAX0J8=gkbyRPg3KarQJiJp0oVHPuVuQ@mail.gmail.com>

Hi Even

Just another small issue: GPKG can't handle pre-existing fid column name:

>ogr2ogr -f "GPKG" outfile2.gpkg infile.geojson -nln layer_a
ERROR 1: sqlite3_exec(ALTER TABLE layer_a ADD COLUMN fid INTEGER) failed: duplic
ate column name: fid

--S.


2015-05-18 18:50 GMT+02:00 Stefan Keller <sfkeller at gmail.com>:
> Salut Even
>
> 2015-05-18 17:40 GMT+02:00 Even Rouault <even.rouault at spatialys.com> a ?crit :
>> Le lundi 18 mai 2015 17:25:18, Stefan Keller a ?crit :
>>> Hi,
>>>
>>> GeoPackage vector driver seems to fail if layer name contains chars
>>> not compatible with SQLite (like dashes, '-').
>>
>> Stefan,
>>
>> This has been fixed in GDAL 2.0dev.
>
> Merveilleux! Merci!!
>
> -S.
>
> 2015-05-18 17:40 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
>> Le lundi 18 mai 2015 17:25:18, Stefan Keller a ?crit :
>>> Hi,
>>>
>>> GeoPackage vector driver seems to fail if layer name contains chars
>>> not compatible with SQLite (like dashes, '-').
>>
>> Stefan,
>>
>> This has been fixed in GDAL 2.0dev.
>>
>> Even
>>
>> --
>> Spatialys - Geospatial professional services
>> http://www.spatialys.com

From even.rouault at spatialys.com  Wed May 20 02:21:41 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 20 May 2015 11:21:41 +0200
Subject: [gdal-dev] GeoPackage vector driver fails if layer name
	contains chars not compatible with SQLite
In-Reply-To: <CAFcOn2-oz8GQs++Q__UAX0J8=gkbyRPg3KarQJiJp0oVHPuVuQ@mail.gmail.com>
References: <CAFcOn2_N=KGxyCj8u5tWjt_DpiVsbF1tBc=ALVQkQVWncB5g8w@mail.gmail.com>
	<CAFcOn28D0PrWoWN2bqHdAe8P81fca1QYaKcXypT7U0v94bAyog@mail.gmail.com>
	<CAFcOn2-oz8GQs++Q__UAX0J8=gkbyRPg3KarQJiJp0oVHPuVuQ@mail.gmail.com>
Message-ID: <201505201121.41805.even.rouault@spatialys.com>

Le mercredi 20 mai 2015 11:13:53, Stefan Keller a ?crit :
> Hi Even
> 
> Just another small issue: GPKG can't handle pre-existing fid column name:
> >ogr2ogr -f "GPKG" outfile2.gpkg infile.geojson -nln layer_a
> 
> ERROR 1: sqlite3_exec(ALTER TABLE layer_a ADD COLUMN fid INTEGER) failed:
> duplic ate column name: fid

Stefan,

you should really try GDAL 2.0.0beta1. Has been fixed there too.

Admitedly burried in  http://svn.osgeo.org/gdal/trunk/gdal/NEWS:
"""
Cross driver changes:
 * SQLite, GPKG, PG, PGDump: in a newly created table, allow to create a 
integer field with same name of FID column (#5845)
"""

Even


> 
> --S.
> 
> 2015-05-18 18:50 GMT+02:00 Stefan Keller <sfkeller at gmail.com>:
> > Salut Even
> > 
> > 2015-05-18 17:40 GMT+02:00 Even Rouault <even.rouault at spatialys.com> a 
?crit :
> >> Le lundi 18 mai 2015 17:25:18, Stefan Keller a ?crit :
> >>> Hi,
> >>> 
> >>> GeoPackage vector driver seems to fail if layer name contains chars
> >>> not compatible with SQLite (like dashes, '-').
> >> 
> >> Stefan,
> >> 
> >> This has been fixed in GDAL 2.0dev.
> > 
> > Merveilleux! Merci!!
> > 
> > -S.
> > 
> > 2015-05-18 17:40 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
> >> Le lundi 18 mai 2015 17:25:18, Stefan Keller a ?crit :
> >>> Hi,
> >>> 
> >>> GeoPackage vector driver seems to fail if layer name contains chars
> >>> not compatible with SQLite (like dashes, '-').
> >> 
> >> Stefan,
> >> 
> >> This has been fixed in GDAL 2.0dev.
> >> 
> >> Even
> >> 
> >> --
> >> Spatialys - Geospatial professional services
> >> http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed May 20 02:34:02 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 20 May 2015 11:34:02 +0200
Subject: [gdal-dev] gdalwarp problems with MODIS L1B
In-Reply-To: <CAAcGz9_ejTVp+tik+nATfScvpiV3Hkdm_91=Q9xSKWcChxF5Lg@mail.gmail.com>
References: <CAAcGz9_ejTVp+tik+nATfScvpiV3Hkdm_91=Q9xSKWcChxF5Lg@mail.gmail.com>
Message-ID: <201505201134.02313.even.rouault@spatialys.com>

Mike,

> 
> By my reading of https://trac.osgeo.org/gdal/wiki/rfc4_geolocate that means
> the Geolocation tag from gdalinfo should have a PIXEL_STEP and LINE_STEP of
> 5, and if I do this I get a much better result but it's still not right.

I've just committed a patch in trunk that should put more sensible values for 
those values :
r29212 "HDF4: ProcessModisSDSGeolocation(): set more correct values for 
PIXEL_/LINE_ OFFSET/STEP by comparing longitude and latitude subdatasets 
dimensions with main subdataset dimensions"


> I've put a jpeg image of the result, with the coastline mapped and not
> lining up, here:
> 
> http://staff.acecrc.org.au/~mdsumner/mod1.jpg

Either the data itself is wrong, either there's an issue with the geolocation 
transformer... Later hypothesis is the more likely, although I've managed to 
make it work with L1B datasets where the tps or geoloc transformers gave 
roughly the same results.

I've gotten smoother results by resizing the longitude&latitude subdatasets to 
the main subdataset dimension

gdal_translate 
HDF4_SDS:UNKNOWN:"MOD021KM.A2012062.0455.006.2014220083128.hdf":1 
longitude.tif -outsize 1354 2030 -r cubic

gdal_translate 
HDF4_SDS:UNKNOWN:"MOD021KM.A2012062.0455.006.2014220083128.hdf":0 latitude.tif 
-outsize 1354 2030 -r cubic

and then referencing them in the VRT produced with 

gdal_translate -of VRT 
HDF4_SDS:UNKNOWN:"MOD021KM.A2012062.0455.006.2014220083128.hdf":2 data.vrt

(and then by correcting the offset and step values to 0 and 1 respectively)

You might want to do the warp with -wo SAMPLE_GRID=YES -wo SAMPLE_STEPS=100 
too

But overall the reprojected image stays roughly at the same location. This 
helps only removing a few artifacts on the edges.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From mdsumner at gmail.com  Wed May 20 03:34:57 2015
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 20 May 2015 10:34:57 +0000
Subject: [gdal-dev] gdalwarp problems with MODIS L1B
In-Reply-To: <201505201134.02313.even.rouault@spatialys.com>
References: <CAAcGz9_ejTVp+tik+nATfScvpiV3Hkdm_91=Q9xSKWcChxF5Lg@mail.gmail.com>
	<201505201134.02313.even.rouault@spatialys.com>
Message-ID: <CAAcGz99ju_U_DdBKnREynx7U4KdktO+WnRUpLnW4x2tLhAUHPw@mail.gmail.com>

Hi Even, that is excellent, thank you.

I have one question about the resampling workaround:

On Wed, 20 May 2015 at 19:34 Even Rouault <even.rouault at spatialys.com>
wrote:

> Mike,
>
> >
> > By my reading of https://trac.osgeo.org/gdal/wiki/rfc4_geolocate that
> means
> > the Geolocation tag from gdalinfo should have a PIXEL_STEP and LINE_STEP
> of
> > 5, and if I do this I get a much better result but it's still not right.
>
> I've just committed a patch in trunk that should put more sensible values
> for
> those values :
> r29212 "HDF4: ProcessModisSDSGeolocation(): set more correct values for
> PIXEL_/LINE_ OFFSET/STEP by comparing longitude and latitude subdatasets
> dimensions with main subdataset dimensions"
>
>
> > I've put a jpeg image of the result, with the coastline mapped and not
> > lining up, here:
> >
> > http://staff.acecrc.org.au/~mdsumner/mod1.jpg
>
> Either the data itself is wrong, either there's an issue with the
> geolocation
> transformer... Later hypothesis is the more likely, although I've managed
> to
> make it work with L1B datasets where the tps or geoloc transformers gave
> roughly the same results.
>
> I've gotten smoother results by resizing the longitude&latitude
> subdatasets to
> the main subdataset dimension
>
> gdal_translate
> HDF4_SDS:UNKNOWN:"MOD021KM.A2012062.0455.006.2014220083128.hdf":1
> longitude.tif -outsize 1354 2030 -r cubic
>
> gdal_translate
> HDF4_SDS:UNKNOWN:"MOD021KM.A2012062.0455.006.2014220083128.hdf":0
> latitude.tif
> -outsize 1354 2030 -r cubic
>
> and then referencing them in the VRT produced with
>
> gdal_translate -of VRT
> HDF4_SDS:UNKNOWN:"MOD021KM.A2012062.0455.006.2014220083128.hdf":2 data.vrt
>
> (and then by correcting the offset and step values to 0 and 1 respectively)
>
>
Is this what occurs when warping generally? Or, even with your fix for
PIXEL/LINE STEP/OFFSET is present will it still be better to do these
external steps to improve the result?

Thanks again, I've really learnt a lot through this process.

Cheers, Mike.


> You might want to do the warp with -wo SAMPLE_GRID=YES -wo SAMPLE_STEPS=100
> too
>
> But overall the reprojected image stays roughly at the same location. This
> helps only removing a few artifacts on the edges.
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150520/789743a7/attachment.html>

From even.rouault at spatialys.com  Wed May 20 04:27:46 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 20 May 2015 13:27:46 +0200
Subject: [gdal-dev] gdalwarp problems with MODIS L1B
In-Reply-To: <CAAcGz99ju_U_DdBKnREynx7U4KdktO+WnRUpLnW4x2tLhAUHPw@mail.gmail.com>
References: <CAAcGz9_ejTVp+tik+nATfScvpiV3Hkdm_91=Q9xSKWcChxF5Lg@mail.gmail.com>
	<201505201134.02313.even.rouault@spatialys.com>
	<CAAcGz99ju_U_DdBKnREynx7U4KdktO+WnRUpLnW4x2tLhAUHPw@mail.gmail.com>
Message-ID: <201505201327.46500.even.rouault@spatialys.com>

Le mercredi 20 mai 2015 12:34:57, Michael Sumner a ?crit :
> Hi Even, that is excellent, thank you.
> 
> I have one question about the resampling workaround:
> 
> On Wed, 20 May 2015 at 19:34 Even Rouault <even.rouault at spatialys.com>
> 
> wrote:
> > Mike,
> > 
> > > By my reading of https://trac.osgeo.org/gdal/wiki/rfc4_geolocate that
> > 
> > means
> > 
> > > the Geolocation tag from gdalinfo should have a PIXEL_STEP and
> > > LINE_STEP
> > 
> > of
> > 
> > > 5, and if I do this I get a much better result but it's still not
> > > right.
> > 
> > I've just committed a patch in trunk that should put more sensible values
> > for
> > those values :
> > r29212 "HDF4: ProcessModisSDSGeolocation(): set more correct values for
> > PIXEL_/LINE_ OFFSET/STEP by comparing longitude and latitude subdatasets
> > dimensions with main subdataset dimensions"
> > 
> > > I've put a jpeg image of the result, with the coastline mapped and not
> > > lining up, here:
> > > 
> > > http://staff.acecrc.org.au/~mdsumner/mod1.jpg
> > 
> > Either the data itself is wrong, either there's an issue with the
> > geolocation
> > transformer... Later hypothesis is the more likely, although I've managed
> > to
> > make it work with L1B datasets where the tps or geoloc transformers gave
> > roughly the same results.
> > 
> > I've gotten smoother results by resizing the longitude&latitude
> > subdatasets to
> > the main subdataset dimension
> > 
> > gdal_translate
> > HDF4_SDS:UNKNOWN:"MOD021KM.A2012062.0455.006.2014220083128.hdf":1
> > longitude.tif -outsize 1354 2030 -r cubic
> > 
> > gdal_translate
> > HDF4_SDS:UNKNOWN:"MOD021KM.A2012062.0455.006.2014220083128.hdf":0
> > latitude.tif
> > -outsize 1354 2030 -r cubic
> > 
> > and then referencing them in the VRT produced with
> > 
> > gdal_translate -of VRT
> > HDF4_SDS:UNKNOWN:"MOD021KM.A2012062.0455.006.2014220083128.hdf":2
> > data.vrt
> > 
> > (and then by correcting the offset and step values to 0 and 1
> > respectively)
> 
> Is this what occurs when warping generally? 

The geolocation warper will do bilinear interpolation.

> Or, even with your fix for
> PIXEL/LINE STEP/OFFSET is present will it still be better to do these
> external steps to improve the result?

I'm not sure honestly. That should be studied in depth.

One idea I had would be to use the longitude and latitude subdatasets to 
generate GCPs from them and then use the TPS or 2nd order polynomial GCP 
transformers in order to compare the result (can be done manually for 
experiments, and could potentially become a dedicated transformer too although 
the performance of TPS will be not that great for a big number of GCPs). I 
would trust the GCPs transformers more than the geolocation one. If you still 
had bad results, you could begin blaming the data.

> 
> Thanks again, I've really learnt a lot through this process.
> 
> Cheers, Mike.
> 
> > You might want to do the warp with -wo SAMPLE_GRID=YES -wo
> > SAMPLE_STEPS=100 too
> > 
> > But overall the reprojected image stays roughly at the same location.
> > This helps only removing a few artifacts on the edges.
> > 
> > Even
> > 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From sfkeller at gmail.com  Wed May 20 05:41:23 2015
From: sfkeller at gmail.com (Stefan Keller)
Date: Wed, 20 May 2015 14:41:23 +0200
Subject: [gdal-dev] GeoPackage vector driver fails if layer name
 contains chars not compatible with SQLite
In-Reply-To: <201505201121.41805.even.rouault@spatialys.com>
References: <CAFcOn2_N=KGxyCj8u5tWjt_DpiVsbF1tBc=ALVQkQVWncB5g8w@mail.gmail.com>
	<CAFcOn28D0PrWoWN2bqHdAe8P81fca1QYaKcXypT7U0v94bAyog@mail.gmail.com>
	<CAFcOn2-oz8GQs++Q__UAX0J8=gkbyRPg3KarQJiJp0oVHPuVuQ@mail.gmail.com>
	<201505201121.41805.even.rouault@spatialys.com>
Message-ID: <CAFcOn2-p7EaQdfWZtBN1NwmbTCpBZxp-QyT7+w4+89MRasaRzw@mail.gmail.com>

Salut Even

Thanks and sorry me again.
We tried to compile GDAL 2.0.0beta1 version and still have problems.
Perhaps our config params are wrong?
- --with-pcraster=no
- --with-jasper=no
- --with-grib=no
- --with-vfk=no
- --with-hide-internal-symbols
- --with-xerces

-Stefan


$ ogr2ogr --version
GDAL 2.0.0beta1, released 2015/05/04

$ ogr2ogr -f 'GPKG' out.gpkg WFS:http://maps.zh.ch/wfs/TbaBaustellenZHWF
S
ERROR 1: failed to execute insert : NOT NULL constraint failed:
baustellen-detailansicht.weiteregemeinden
ERROR 1: Unable to write feature 518 from layer baustellen-detailansicht .
ERROR 1: Terminating translation prematurely after failed translation
of layer baustellen-detailansicht (use -skipfailures to skip errors)

2015-05-20 11:21 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
> Le mercredi 20 mai 2015 11:13:53, Stefan Keller a ?crit :
>> Hi Even
>>
>> Just another small issue: GPKG can't handle pre-existing fid column name:
>> >ogr2ogr -f "GPKG" outfile2.gpkg infile.geojson -nln layer_a
>>
>> ERROR 1: sqlite3_exec(ALTER TABLE layer_a ADD COLUMN fid INTEGER) failed:
>> duplic ate column name: fid
>
> Stefan,
>
> you should really try GDAL 2.0.0beta1. Has been fixed there too.
>
> Admitedly burried in  http://svn.osgeo.org/gdal/trunk/gdal/NEWS:
> """
> Cross driver changes:
>  * SQLite, GPKG, PG, PGDump: in a newly created table, allow to create a
> integer field with same name of FID column (#5845)
> """
>
> Even
>
>
>>
>> --S.
>>
>> 2015-05-18 18:50 GMT+02:00 Stefan Keller <sfkeller at gmail.com>:
>> > Salut Even
>> >
>> > 2015-05-18 17:40 GMT+02:00 Even Rouault <even.rouault at spatialys.com> a
> ?crit :
>> >> Le lundi 18 mai 2015 17:25:18, Stefan Keller a ?crit :
>> >>> Hi,
>> >>>
>> >>> GeoPackage vector driver seems to fail if layer name contains chars
>> >>> not compatible with SQLite (like dashes, '-').
>> >>
>> >> Stefan,
>> >>
>> >> This has been fixed in GDAL 2.0dev.
>> >
>> > Merveilleux! Merci!!
>> >
>> > -S.
>> >
>> > 2015-05-18 17:40 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
>> >> Le lundi 18 mai 2015 17:25:18, Stefan Keller a ?crit :
>> >>> Hi,
>> >>>
>> >>> GeoPackage vector driver seems to fail if layer name contains chars
>> >>> not compatible with SQLite (like dashes, '-').
>> >>
>> >> Stefan,
>> >>
>> >> This has been fixed in GDAL 2.0dev.
>> >>
>> >> Even
>> >>
>> >> --
>> >> Spatialys - Geospatial professional services
>> >> http://www.spatialys.com
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com

From even.rouault at spatialys.com  Wed May 20 06:51:41 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 20 May 2015 15:51:41 +0200
Subject: [gdal-dev] GeoPackage vector driver fails if layer name
	contains chars not compatible with SQLite
In-Reply-To: <CAFcOn2-p7EaQdfWZtBN1NwmbTCpBZxp-QyT7+w4+89MRasaRzw@mail.gmail.com>
References: <CAFcOn2_N=KGxyCj8u5tWjt_DpiVsbF1tBc=ALVQkQVWncB5g8w@mail.gmail.com>
	<201505201121.41805.even.rouault@spatialys.com>
	<CAFcOn2-p7EaQdfWZtBN1NwmbTCpBZxp-QyT7+w4+89MRasaRzw@mail.gmail.com>
Message-ID: <201505201551.41412.even.rouault@spatialys.com>

Le mercredi 20 mai 2015 14:41:23, Stefan Keller a ?crit :
> Salut Even
> 
> Thanks and sorry me again.
> We tried to compile GDAL 2.0.0beta1 version and still have problems.
> Perhaps our config params are wrong?

No they are fine

> $ ogr2ogr -f 'GPKG' out.gpkg WFS:http://maps.zh.ch/wfs/TbaBaustellenZHWF
> S
> ERROR 1: failed to execute insert : NOT NULL constraint failed:
> baustellen-detailansicht.weiteregemeinden
> ERROR 1: Unable to write feature 518 from layer baustellen-detailansicht .
> ERROR 1: Terminating translation prematurely after failed translation
> of layer baustellen-detailansicht (use -skipfailures to skip errors)

Thanks. This is an interesting feedback.

The issue is that OGR interprets the following 

        <ms:weiteregemeinden></ms:weiteregemeinden>

as being NULL, instead of empty string.
And the schema of the layer as defined by 
http://maps.zh.ch/wfs/TbaBaustellenZHWFS?SERVICE=WFS&VERSION=1.1.0&REQUEST=DescribeFeatureType&TYPENAME=baustellen-
detailansicht makes the attribute mandatory, hence NOT NULL.

Presumably the cleaner way of addressing this would be to make the GML driver 
report an empty string, instead of NULL, but I still think that the intent is 
generally NULL and this was the historic behaviour, so I'm hesitant to change 
this by default. So in light of this, I've reconsidered that not-nullable 
fields in GML/WFS drivers to be reported by default to avoid such issues. 
Users that want to be pedantic can use the just newly added open option 
EMPTY_AS_NULL=NO so as to have empty fields as empty strings and NOT NULL fields 
being reported. So all in all, things should run smoothly now in both the 
default mode (EMPTY_AS_NULL=YES) and in the pedantic mode (EMPTY_AS_NULL=NO)
Tracked in ticket http://trac.osgeo.org/gdal/ticket/5968.

In the meantime, you can workaround the issue by adding -forceNullable to the 
ogr2ogr command line which will drop those NOT NULL constraints.

Side remark:
http://maps.zh.ch/wfs/TbaBaustellenZHWFS?SERVICE=WFS&VERSION=1.1.0&REQUEST=GetFeature&TYPENAME=baustellen-
detailansicht doesn't pass XML validation against the schema because of things 
like <ms:lmutdat>2015-03-16 00:00:00</ms:lmutdat> which are not valid xs:date.

This should be <ms:lmutdat>2015-03-16T00:00:00</ms:lmutdat> and the field 
should be declared as <element name="lmutdat" type="dateTime"/>, but that 
might be a MapServer issue

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jamessramm at gmail.com  Wed May 20 06:57:38 2015
From: jamessramm at gmail.com (jramm)
Date: Wed, 20 May 2015 06:57:38 -0700 (PDT)
Subject: [gdal-dev] Raster attribute tables in GDAL?
Message-ID: <1432130258638-5206653.post@n6.nabble.com>

Does GDAL have any support for writing ESRI-style raster attribute tables?

These are the .vat.dbf files that often accompany geotiffs and other
formats....




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Raster-attribute-tables-in-GDAL-tp5206653.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From claire.porter at gmail.com  Wed May 20 07:29:10 2015
From: claire.porter at gmail.com (Claire Porter)
Date: Wed, 20 May 2015 09:29:10 -0500
Subject: [gdal-dev] JP2OpenJPEG Driver Reads 4th Band of NITF as Alpha
In-Reply-To: <201505201024.57628.even.rouault@spatialys.com>
References: <CAN07go-sHfPm0zttPPgE93K9ZMMWNVOLGpNjwnA2gU8oGr1pGA@mail.gmail.com>
	<20EA793B1BC710448656BDC9BD25C4A12F8D2960@52ZHTX-D07-04D.area52.afnoapps.usaf.mil>
	<201505201024.57628.even.rouault@spatialys.com>
Message-ID: <CAN07go9-6y8Y2wJq2tHY6egdnSeGQek_=0ENyLdZmPbJkAtM+g@mail.gmail.com>

Even and James,

Thanks for the suggestions.  Even's advice about converting first to a VRT,
modifying the Color Interpretation of the 4th band, and then using gdalwarp
worked perfectly.

In terms of the larger picture, is this a a bug I should report to OpenJPEG
or is it something best handled here?  Or, alternatively, is the workaround
good enough that it's not worth following up on?

Thanks again,
Claire
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150520/4eb3bc31/attachment.html>

From claire.porter at gmail.com  Wed May 20 07:33:14 2015
From: claire.porter at gmail.com (Claire Porter)
Date: Wed, 20 May 2015 09:33:14 -0500
Subject: [gdal-dev] JP2OpenJPEG Driver Reads 4th Band of NITF as Alpha
In-Reply-To: <CAN07go9-6y8Y2wJq2tHY6egdnSeGQek_=0ENyLdZmPbJkAtM+g@mail.gmail.com>
References: <CAN07go-sHfPm0zttPPgE93K9ZMMWNVOLGpNjwnA2gU8oGr1pGA@mail.gmail.com>
	<20EA793B1BC710448656BDC9BD25C4A12F8D2960@52ZHTX-D07-04D.area52.afnoapps.usaf.mil>
	<201505201024.57628.even.rouault@spatialys.com>
	<CAN07go9-6y8Y2wJq2tHY6egdnSeGQek_=0ENyLdZmPbJkAtM+g@mail.gmail.com>
Message-ID: <CAN07go_uM1+q7dh3j4TdwsbFx=YLHpOec57uh4xAF3DLrw3gjw@mail.gmail.com>

Even,

Sorry, I did not read your email closely enough.  I see it has been fixed.

Thanks,
Claire


On Wed, May 20, 2015 at 9:29 AM, Claire Porter <claire.porter at gmail.com>
wrote:

> Even and James,
>
> Thanks for the suggestions.  Even's advice about converting first to a
> VRT, modifying the Color Interpretation of the 4th band, and then using
> gdalwarp worked perfectly.
>
> In terms of the larger picture, is this a a bug I should report to
> OpenJPEG or is it something best handled here?  Or, alternatively, is the
> workaround good enough that it's not worth following up on?
>
> Thanks again,
> Claire
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150520/3980b742/attachment.html>

From even.rouault at spatialys.com  Wed May 20 07:40:31 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 20 May 2015 16:40:31 +0200
Subject: [gdal-dev] Raster attribute tables in GDAL?
In-Reply-To: <1432130258638-5206653.post@n6.nabble.com>
References: <1432130258638-5206653.post@n6.nabble.com>
Message-ID: <201505201640.31477.even.rouault@spatialys.com>

Le mercredi 20 mai 2015 15:57:38, jramm a ?crit :
> Does GDAL have any support for writing ESRI-style raster attribute tables?
> 
> These are the .vat.dbf files that often accompany geotiffs and other
> formats....

I wasn't particularly aware of those sidecar files, but looking a bit I found 
one sample at https://dl.vecnet.org/files/j67313813

It seems it is a standard .DBF file, so you can read/write it with the OGR 
Shapefile driver.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From kassies at gmail.com  Thu May 21 00:45:30 2015
From: kassies at gmail.com (Rutger)
Date: Thu, 21 May 2015 00:45:30 -0700 (PDT)
Subject: [gdal-dev] gdalwarp problems with MODIS L1B
In-Reply-To: <201505201327.46500.even.rouault@spatialys.com>
References: <CAAcGz9_ejTVp+tik+nATfScvpiV3Hkdm_91=Q9xSKWcChxF5Lg@mail.gmail.com>
	<201505201134.02313.even.rouault@spatialys.com>
	<CAAcGz99ju_U_DdBKnREynx7U4KdktO+WnRUpLnW4x2tLhAUHPw@mail.gmail.com>
	<201505201327.46500.even.rouault@spatialys.com>
Message-ID: <1432194330810-5206825.post@n6.nabble.com>

Hey,

Maybe i'm missing something, but for as far as i know, the MODIS MOD021KM
product is still a 'swath', and therefore still containing the bow-tie
effect as the result of the scanning sensor. Wouldn't this mean that
gdalwarp will never work? The lat/lon arrays aren't continuous, so any
fitting (GCP/TPS) wont be accurate. And upsampling the arrays with cubic,
like Even did, will result in interpolating pixels which are next each other
in the array/file, but aren't next to each other 'on the ground', wont work
well.

I think you need to either use a dedicated algorithm (like gradient search),
or something very generic (like the KDTree of Pyresample) to overcome the
bow-tie effect.

I have spend alot of time experimenting with this in GDAL, since i try to do
as much with GDAL as possible. But projecting a swath file from a scanning
sensor (like MODIS or VIIRS) is something i have never gotten to work. For
some historic discussion about this see for example:
http://osgeo-org.1560.x6.nabble.com/gdal-dev-reproject-python-numpy-binary-swath-lat-lon-td4978609.html


Regards,
Rutger



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-gdalwarp-problems-with-MODIS-L1B-tp5206583p5206825.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From yutaxsato at gmail.com  Thu May 21 01:19:13 2015
From: yutaxsato at gmail.com (Yuta Sato)
Date: Thu, 21 May 2015 17:19:13 +0900
Subject: [gdal-dev] gdalwarp problems with MODIS L1B
In-Reply-To: <1432194330810-5206825.post@n6.nabble.com>
References: <CAAcGz9_ejTVp+tik+nATfScvpiV3Hkdm_91=Q9xSKWcChxF5Lg@mail.gmail.com>
	<201505201134.02313.even.rouault@spatialys.com>
	<CAAcGz99ju_U_DdBKnREynx7U4KdktO+WnRUpLnW4x2tLhAUHPw@mail.gmail.com>
	<201505201327.46500.even.rouault@spatialys.com>
	<1432194330810-5206825.post@n6.nabble.com>
Message-ID: <CAPqnkJRizt3XtC1mb9UvpPrZ01jGhuPEVFvNhMy6Vw=haATu8A@mail.gmail.com>

Hi,

I think the MOD021KM swath product is point data, which should be gridded
using the array of latitude and longitude given.
gdal griddata may be an option. However, it's very slow even for a single
band of MOD021KM product.

MODIS team provides MODIS Swath Reprojection Tool for gridding the data,
which performs fast.
 https://lpdaac.usgs.gov/tools/modis_reprojection_tool_swath

I do not know the science behind MODIS Swath Reprojection Tool why it's
faster than the gdal griddata.
Can we discuss and implement a faster gridding tool in gdal? Why I am
focusing gdal is because the MODIS swath tool works only for MODIS data,
but the expected gdal tool would work for any data.

Thanks.

On Thu, May 21, 2015 at 4:45 PM, Rutger <kassies at gmail.com> wrote:

> Hey,
>
> Maybe i'm missing something, but for as far as i know, the MODIS MOD021KM
> product is still a 'swath', and therefore still containing the bow-tie
> effect as the result of the scanning sensor. Wouldn't this mean that
> gdalwarp will never work? The lat/lon arrays aren't continuous, so any
> fitting (GCP/TPS) wont be accurate. And upsampling the arrays with cubic,
> like Even did, will result in interpolating pixels which are next each
> other
> in the array/file, but aren't next to each other 'on the ground', wont work
> well.
>
> I think you need to either use a dedicated algorithm (like gradient
> search),
> or something very generic (like the KDTree of Pyresample) to overcome the
> bow-tie effect.
>
> I have spend alot of time experimenting with this in GDAL, since i try to
> do
> as much with GDAL as possible. But projecting a swath file from a scanning
> sensor (like MODIS or VIIRS) is something i have never gotten to work. For
> some historic discussion about this see for example:
>
> http://osgeo-org.1560.x6.nabble.com/gdal-dev-reproject-python-numpy-binary-swath-lat-lon-td4978609.html
>
>
> Regards,
> Rutger
>
>
>
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/gdal-dev-gdalwarp-problems-with-MODIS-L1B-tp5206583p5206825.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150521/435f5ae1/attachment.html>

From even.rouault at spatialys.com  Thu May 21 01:43:29 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 21 May 2015 10:43:29 +0200
Subject: [gdal-dev] gdalwarp problems with MODIS L1B
In-Reply-To: <1432194330810-5206825.post@n6.nabble.com>
References: <CAAcGz9_ejTVp+tik+nATfScvpiV3Hkdm_91=Q9xSKWcChxF5Lg@mail.gmail.com>
	<201505201327.46500.even.rouault@spatialys.com>
	<1432194330810-5206825.post@n6.nabble.com>
Message-ID: <201505211043.29436.even.rouault@spatialys.com>

Rutger,

> 
> Maybe i'm missing something, but for as far as i know, the MODIS MOD021KM
> product is still a 'swath', and therefore still containing the bow-tie
> effect as the result of the scanning sensor. Wouldn't this mean that
> gdalwarp will never work? The lat/lon arrays aren't continuous, 

yes you're right. I looked at the first column of the latitude array, and the 
derivative apparently changes sign for each row,

>>> from osgeo import gdal
>>> ds = 
gdal.Open('HDF4_SDS:UNKNOWN:"MOD021KM.A2012062.0455.006.2014220083128.hdf":0')
>>> first_col = ds.ReadAsArray()[:,0]
>>> first_col[1:] - first_col[0:-1]
array([-0.07051849,  0.0051384 , -0.07039642,  0.00334167, -0.07026672,
        0.00508118, -0.07014084,  0.00319672, -0.07001114,  0.00492477,
       -0.06988907,  0.00340271, -0.06975555,  0.00507736, -0.06962967,
....

So yes I don't think the GDAL transformers can work properly with that kind of 
data.

On lines, the values look more continuous. So a potential workaround might be 
to reorder the lines of the raster and of the lat,lon arrays priorly to any 
warping.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From Julien.Demaria at acri-st.fr  Thu May 21 02:04:32 2015
From: Julien.Demaria at acri-st.fr (Julien Demaria)
Date: Thu, 21 May 2015 09:04:32 +0000
Subject: [gdal-dev] gdalwarp problems with MODIS L1B
In-Reply-To: <201505211043.29436.even.rouault@spatialys.com>
References: <CAAcGz9_ejTVp+tik+nATfScvpiV3Hkdm_91=Q9xSKWcChxF5Lg@mail.gmail.com>
	<201505201327.46500.even.rouault@spatialys.com>
	<1432194330810-5206825.post@n6.nabble.com>
	<201505211043.29436.even.rouault@spatialys.com>
Message-ID: <3B970FB76033264EB34479EC8A365E1101BA3358C5@vwiexc030.acri.local>

Hi,

I confirm that gdalwarp should not work well with MODIS/VIIRS bow-tie effect. Maybe apply the same reprojection logic but on each bow-tie separately (bow-tie are blocks of 20 rows I think) should give better results by I don't know if it's possible.

Here we developed an internal reprojection tool to handle swath products with per-pixel lat/lon (like MODIS, VIIRS, SeaWiFS, MERIS, ...), we do binning: for each input pixel we search were it falls in the output regular grid, but this approach needs to allocate the full output grid at the beginning. We also use a fast flux-conserving resampling (skyview.gsfc.nasa.gov/polysamp/polysamp.ppt): each input pixel is represented as a quadrilateral computed using the input per-pixel lat/lon; this is better than doing binning only using pixel center which will create artifact holes in the output product depending on your input/output resolutions. We use GDAL to read input L2 data.

Regards,
Julien

-----Message d'origine-----
De?: gdal-dev-bounces at lists.osgeo.org [mailto:gdal-dev-bounces at lists.osgeo.org] De la part de Even Rouault
Envoy??: jeudi 21 mai 2015 10:43
??: gdal-dev at lists.osgeo.org
Cc?: Rutger
Objet?: Re: [gdal-dev] gdalwarp problems with MODIS L1B

Rutger,

> 
> Maybe i'm missing something, but for as far as i know, the MODIS 
> MOD021KM product is still a 'swath', and therefore still containing 
> the bow-tie effect as the result of the scanning sensor. Wouldn't this 
> mean that gdalwarp will never work? The lat/lon arrays aren't 
> continuous,

yes you're right. I looked at the first column of the latitude array, and the derivative apparently changes sign for each row,

>>> from osgeo import gdal
>>> ds =
gdal.Open('HDF4_SDS:UNKNOWN:"MOD021KM.A2012062.0455.006.2014220083128.hdf":0')
>>> first_col = ds.ReadAsArray()[:,0]
>>> first_col[1:] - first_col[0:-1]
array([-0.07051849,  0.0051384 , -0.07039642,  0.00334167, -0.07026672,
        0.00508118, -0.07014084,  0.00319672, -0.07001114,  0.00492477,
       -0.06988907,  0.00340271, -0.06975555,  0.00507736, -0.06962967, ....

So yes I don't think the GDAL transformers can work properly with that kind of data.

On lines, the values look more continuous. So a potential workaround might be to reorder the lines of the raster and of the lat,lon arrays priorly to any warping.

Even

--
Spatialys - Geospatial professional services http://www.spatialys.com _______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at spatialys.com  Thu May 21 02:42:16 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 21 May 2015 11:42:16 +0200
Subject: [gdal-dev] gdalwarp problems with MODIS L1B
In-Reply-To: <CAPqnkJRizt3XtC1mb9UvpPrZ01jGhuPEVFvNhMy6Vw=haATu8A@mail.gmail.com>
References: <CAAcGz9_ejTVp+tik+nATfScvpiV3Hkdm_91=Q9xSKWcChxF5Lg@mail.gmail.com>
	<1432194330810-5206825.post@n6.nabble.com>
	<CAPqnkJRizt3XtC1mb9UvpPrZ01jGhuPEVFvNhMy6Vw=haATu8A@mail.gmail.com>
Message-ID: <201505211142.16355.even.rouault@spatialys.com>

Le jeudi 21 mai 2015 10:19:13, Yuta Sato a ?crit :
> Hi,
> 
> I think the MOD021KM swath product is point data, which should be gridded
> using the array of latitude and longitude given.
> gdal griddata may be an option. However, it's very slow even for a single
> band of MOD021KM product.
> 
> MODIS team provides MODIS Swath Reprojection Tool for gridding the data,
> which performs fast.
>  https://lpdaac.usgs.gov/tools/modis_reprojection_tool_swath
> 
> I do not know the science behind MODIS Swath Reprojection Tool why it's
> faster than the gdal griddata.
> Can we discuss and implement a faster gridding tool in gdal? Why I am
> focusing gdal is because the MODIS swath tool works only for MODIS data,
> but the expected gdal tool would work for any data.

Yuta,

Make sure your point layer has a spatial index before running gdal_grid on it. 
You will also need to specify reasonable values for the search radius.

Even

> 
> Thanks.
> 
> On Thu, May 21, 2015 at 4:45 PM, Rutger <kassies at gmail.com> wrote:
> > Hey,
> > 
> > Maybe i'm missing something, but for as far as i know, the MODIS MOD021KM
> > product is still a 'swath', and therefore still containing the bow-tie
> > effect as the result of the scanning sensor. Wouldn't this mean that
> > gdalwarp will never work? The lat/lon arrays aren't continuous, so any
> > fitting (GCP/TPS) wont be accurate. And upsampling the arrays with cubic,
> > like Even did, will result in interpolating pixels which are next each
> > other
> > in the array/file, but aren't next to each other 'on the ground', wont
> > work well.
> > 
> > I think you need to either use a dedicated algorithm (like gradient
> > search),
> > or something very generic (like the KDTree of Pyresample) to overcome the
> > bow-tie effect.
> > 
> > I have spend alot of time experimenting with this in GDAL, since i try to
> > do
> > as much with GDAL as possible. But projecting a swath file from a
> > scanning sensor (like MODIS or VIIRS) is something i have never gotten
> > to work. For some historic discussion about this see for example:
> > 
> > http://osgeo-org.1560.x6.nabble.com/gdal-dev-reproject-python-numpy-binar
> > y-swath-lat-lon-td4978609.html
> > 
> > 
> > Regards,
> > Rutger
> > 
> > 
> > 
> > --
> > View this message in context:
> > http://osgeo-org.1560.x6.nabble.com/gdal-dev-gdalwarp-problems-with-MODIS
> > -L1B-tp5206583p5206825.html Sent from the GDAL - Dev mailing list archive
> > at Nabble.com.
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From cavallini at faunalia.it  Thu May 21 06:09:37 2015
From: cavallini at faunalia.it (Paolo Cavallini)
Date: Thu, 21 May 2015 15:09:37 +0200
Subject: [gdal-dev] rgdal?
Message-ID: <555DD911.6080202@faunalia.it>

Hi all,
after a long time not installing R afresh, I was surprised seeing the
the important rgdal package is not packaged. Is there a spcific reason
for this, or is it just the usual lack of time?
all the best, and thanks.
-- 
Paolo Cavallini - www.faunalia.eu
QGIS & PostGIS courses: http://www.faunalia.eu/training.html

From jamessramm at gmail.com  Thu May 21 06:14:46 2015
From: jamessramm at gmail.com (jramm)
Date: Thu, 21 May 2015 06:14:46 -0700 (PDT)
Subject: [gdal-dev] Raster attribute tables in GDAL?
In-Reply-To: <201505201640.31477.even.rouault@spatialys.com>
References: <1432130258638-5206653.post@n6.nabble.com>
	<201505201640.31477.even.rouault@spatialys.com>
Message-ID: <CAEW=KS5yf+Uxc2tj=2ozmAShfQmO0n_f9EUv=su9BX-XjhhFKQ@mail.gmail.com>

That sounds great. Does this driver allow you to only write the dbf file
(and not the shp/shx etc files?)

I can't find much on the docs for doing that:
http://www.gdal.org/drv_shapefile.html

I'll have a look through the header files...

On 20 May 2015 at 15:38, Even Rouault-2 [via OSGeo.org] <
ml-node+s1560n5206664h33 at n6.nabble.com> wrote:

> Le mercredi 20 mai 2015 15:57:38, jramm a ?crit :
> > Does GDAL have any support for writing ESRI-style raster attribute
> tables?
> >
> > These are the .vat.dbf files that often accompany geotiffs and other
> > formats....
>
> I wasn't particularly aware of those sidecar files, but looking a bit I
> found
> one sample at https://dl.vecnet.org/files/j67313813
>
> It seems it is a standard .DBF file, so you can read/write it with the OGR
> Shapefile driver.
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> [hidden email] <http:///user/SendEmail.jtp?type=node&node=5206664&i=0>
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
> ------------------------------
>  If you reply to this email, your message will be added to the discussion
> below:
>
> http://osgeo-org.1560.x6.nabble.com/Raster-attribute-tables-in-GDAL-tp5206653p5206664.html
>  To unsubscribe from Raster attribute tables in GDAL?, click here
> <http://osgeo-org.1560.x6.nabble.com/template/NamlServlet.jtp?macro=unsubscribe_by_code&node=5206653&code=amFtZXNzcmFtbUBnbWFpbC5jb218NTIwNjY1M3wyMTIyMDM1OTQ5>
> .
> NAML
> <http://osgeo-org.1560.x6.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&id=instant_html%21nabble%3Aemail.naml&base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.NodeNamespace&breadcrumbs=notify_subscribers%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml>
>




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Raster-attribute-tables-in-GDAL-tp5206653p5206907.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150521/f7b11bbb/attachment-0001.html>

From jamessramm at gmail.com  Thu May 21 06:18:57 2015
From: jamessramm at gmail.com (James Ramm)
Date: Thu, 21 May 2015 14:18:57 +0100
Subject: [gdal-dev] Raster attribute tables in GDAL?
In-Reply-To: <CAEW=KS5yf+Uxc2tj=2ozmAShfQmO0n_f9EUv=su9BX-XjhhFKQ@mail.gmail.com>
References: <1432130258638-5206653.post@n6.nabble.com>
	<201505201640.31477.even.rouault@spatialys.com>
	<CAEW=KS5yf+Uxc2tj=2ozmAShfQmO0n_f9EUv=su9BX-XjhhFKQ@mail.gmail.com>
Message-ID: <CAEW=KS5goVa1G2qGHhancW8+r14iBw+DyZfDStz7S9PP_x3jvg@mail.gmail.com>

Scratch my last message, I should've read more carefully:

"Can be one of NULL for a simple .dbf file with no .shp file,"

On 21 May 2015 at 14:14, jramm <jamessramm at gmail.com> wrote:

> That sounds great. Does this driver allow you to only write the dbf file
> (and not the shp/shx etc files?)
>
> I can't find much on the docs for doing that:
> http://www.gdal.org/drv_shapefile.html
>
> I'll have a look through the header files...
>
> On 20 May 2015 at 15:38, Even Rouault-2 [via OSGeo.org] <[hidden email]
> <http:///user/SendEmail.jtp?type=node&node=5206907&i=0>> wrote:
>
>> Le mercredi 20 mai 2015 15:57:38, jramm a ?crit :
>> > Does GDAL have any support for writing ESRI-style raster attribute
>> tables?
>> >
>> > These are the .vat.dbf files that often accompany geotiffs and other
>> > formats....
>>
>> I wasn't particularly aware of those sidecar files, but looking a bit I
>> found
>> one sample at https://dl.vecnet.org/files/j67313813
>>
>> It seems it is a standard .DBF file, so you can read/write it with the
>> OGR
>> Shapefile driver.
>>
>> Even
>>
>> --
>> Spatialys - Geospatial professional services
>> http://www.spatialys.com
>> _______________________________________________
>> gdal-dev mailing list
>> [hidden email] <http:///user/SendEmail.jtp?type=node&node=5206664&i=0>
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>
>> ------------------------------
>>  If you reply to this email, your message will be added to the
>> discussion below:
>>
>> http://osgeo-org.1560.x6.nabble.com/Raster-attribute-tables-in-GDAL-tp5206653p5206664.html
>>  To unsubscribe from Raster attribute tables in GDAL?, click here.
>> NAML
>> <http://osgeo-org.1560.x6.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&id=instant_html%21nabble%3Aemail.naml&base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.NodeNamespace&breadcrumbs=notify_subscribers%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml>
>>
>
>
> ------------------------------
> View this message in context: Re: Raster attribute tables in GDAL?
> <http://osgeo-org.1560.x6.nabble.com/Raster-attribute-tables-in-GDAL-tp5206653p5206907.html>
>
> Sent from the GDAL - Dev mailing list archive
> <http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html> at
> Nabble.com.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150521/2dad2d9c/attachment.html>

From even.rouault at spatialys.com  Thu May 21 06:21:40 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 21 May 2015 15:21:40 +0200
Subject: [gdal-dev] Raster attribute tables in GDAL?
In-Reply-To: <CAEW=KS5yf+Uxc2tj=2ozmAShfQmO0n_f9EUv=su9BX-XjhhFKQ@mail.gmail.com>
References: <1432130258638-5206653.post@n6.nabble.com>
	<201505201640.31477.even.rouault@spatialys.com>
	<CAEW=KS5yf+Uxc2tj=2ozmAShfQmO0n_f9EUv=su9BX-XjhhFKQ@mail.gmail.com>
Message-ID: <201505211521.40447.even.rouault@spatialys.com>

Le jeudi 21 mai 2015 15:14:46, jramm a ?crit :
> That sounds great. Does this driver allow you to only write the dbf file
> (and not the shp/shx etc files?)

Yes, if you create a layer with a None geometry type, no .shp,.shx will be 
created.

> 
> I can't find much on the docs for doing that:
> http://www.gdal.org/drv_shapefile.html
> 
> I'll have a look through the header files...

Basically follow http://gdal.org/1.11/ogr/ogr_apitut.html "Writing to OGR" and 
ignore what is related to geometries and pass wkbNone instead of wkbPoint when 
calling CreateLayer()

> 
> On 20 May 2015 at 15:38, Even Rouault-2 [via OSGeo.org] <
> 
> ml-node+s1560n5206664h33 at n6.nabble.com> wrote:
> > Le mercredi 20 mai 2015 15:57:38, jramm a ?crit :
> > > Does GDAL have any support for writing ESRI-style raster attribute
> > 
> > tables?
> > 
> > > These are the .vat.dbf files that often accompany geotiffs and other
> > > formats....
> > 
> > I wasn't particularly aware of those sidecar files, but looking a bit I
> > found
> > one sample at https://dl.vecnet.org/files/j67313813
> > 
> > It seems it is a standard .DBF file, so you can read/write it with the
> > OGR Shapefile driver.
> > 
> > Even
> > 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com
> > _______________________________________________
> > gdal-dev mailing list
> > [hidden email] <http:///user/SendEmail.jtp?type=node&node=5206664&i=0>
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > 
> > 
> > ------------------------------
> > 
> >  If you reply to this email, your message will be added to the discussion
> > 
> > below:
> > 
> > http://osgeo-org.1560.x6.nabble.com/Raster-attribute-tables-in-GDAL-tp520
> > 6653p5206664.html
> > 
> >  To unsubscribe from Raster attribute tables in GDAL?, click here
> > 
> > <http://osgeo-org.1560.x6.nabble.com/template/NamlServlet.jtp?macro=unsub
> > scribe_by_code&node=5206653&code=amFtZXNzcmFtbUBnbWFpbC5jb218NTIwNjY1M3wy
> > MTIyMDM1OTQ5> .
> > NAML
> > <http://osgeo-org.1560.x6.nabble.com/template/NamlServlet.jtp?macro=macro
> > _viewer&id=instant_html%21nabble%3Aemail.naml&base=nabble.naml.namespaces
> > .BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.
> > template.NodeNamespace&breadcrumbs=notify_subscribers%21nabble%3Aemail.na
> > ml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aema
> > il.naml>
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/Raster-attribute-tables-in-GDAL-tp5206
> 653p5206907.html Sent from the GDAL - Dev mailing list archive at
> Nabble.com.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From mdsumner at gmail.com  Thu May 21 08:14:45 2015
From: mdsumner at gmail.com (Michael Sumner)
Date: Thu, 21 May 2015 15:14:45 +0000
Subject: [gdal-dev] gdalwarp problems with MODIS L1B
In-Reply-To: <1432194330810-5206825.post@n6.nabble.com>
References: <CAAcGz9_ejTVp+tik+nATfScvpiV3Hkdm_91=Q9xSKWcChxF5Lg@mail.gmail.com>
	<201505201134.02313.even.rouault@spatialys.com>
	<CAAcGz99ju_U_DdBKnREynx7U4KdktO+WnRUpLnW4x2tLhAUHPw@mail.gmail.com>
	<201505201327.46500.even.rouault@spatialys.com>
	<1432194330810-5206825.post@n6.nabble.com>
Message-ID: <CAAcGz98BwVHcFCCj+5U6+Hp1ywPDbXQYh5JdKe=AJSz4Yf4TDw@mail.gmail.com>

Thank you Rutger, it was me who was missing things - I've been confused
about to what level the GDAL warping is appropriate, and every part of this
discussion has been very helpful. It seems very much like the
orthorectification process where you need a DEM as well as details on
camera geometry, but my understanding on the relationship here is very dim.

I'd love for lower level techniques like the MODIS Swath to grid and Seadas
L1A to L2 chain to be available via GDAL, but I have a lot to learn about
all the steps. I have no idea how appropriate it is for GDAL to aspire to
these things, but I'm very keen to learn.

Cheers, Mike

On Thu, 21 May 2015 at 17:48 Rutger <kassies at gmail.com> wrote:

> Hey,
>
> Maybe i'm missing something, but for as far as i know, the MODIS MOD021KM
> product is still a 'swath', and therefore still containing the bow-tie
> effect as the result of the scanning sensor. Wouldn't this mean that
> gdalwarp will never work? The lat/lon arrays aren't continuous, so any
> fitting (GCP/TPS) wont be accurate. And upsampling the arrays with cubic,
> like Even did, will result in interpolating pixels which are next each
> other
> in the array/file, but aren't next to each other 'on the ground', wont work
> well.
>
> I think you need to either use a dedicated algorithm (like gradient
> search),
> or something very generic (like the KDTree of Pyresample) to overcome the
> bow-tie effect.
>
> I have spend alot of time experimenting with this in GDAL, since i try to
> do
> as much with GDAL as possible. But projecting a swath file from a scanning
> sensor (like MODIS or VIIRS) is something i have never gotten to work. For
> some historic discussion about this see for example:
>
> http://osgeo-org.1560.x6.nabble.com/gdal-dev-reproject-python-numpy-binary-swath-lat-lon-td4978609.html
>
>
> Regards,
> Rutger
>
>
>
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/gdal-dev-gdalwarp-problems-with-MODIS-L1B-tp5206583p5206825.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150521/84f52296/attachment.html>

From ari.jolma at gmail.com  Thu May 21 08:23:56 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Thu, 21 May 2015 18:23:56 +0300
Subject: [gdal-dev] Suggested new typemap for the bindings
Message-ID: <555DF88C.6060304@gmail.com>

I defined a new type VSI_RETVAL to be used instead of int with VSI 
functions that return -1 in error and set errno.

For the Perl bindings I defined two typemaps for this type. One which 
strips the return value and one which throws an error if the return 
value is -1. The error is strerror(errno).

I think this improves the usability of those VSI functions from the 
binded languages.

Ari


From dassau at gbd-consult.de  Thu May 21 08:57:04 2015
From: dassau at gbd-consult.de (Otto Dassau)
Date: Thu, 21 May 2015 17:57:04 +0200
Subject: [gdal-dev] change PROJCS information within GDAL dataset
Message-ID: <20150521175704.410709cd@nature.speedport.ip>

Hi,

is it possible to change parameters, e.g. a AUTHORITY["EPSG","9001"]]]
value inside the PROJCS area of an existing GDAL dataset with gdal_edit.py?

PROJCS["UTM Zone 33, Northern Hemisphere",
    GEOGCS["GRS 1980(IUGG, 1980)",
        DATUM["unknown",
            SPHEROID["GRS80",6378137,298.257222101],
            TOWGS84[0,0,0,0,0,0,0]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",15],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]]]
[...]

I managed to add Metadata information with -mo, but don't know how to use
the -oo parameter.

thanks a lot
Otto

From even.rouault at spatialys.com  Thu May 21 09:07:03 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 21 May 2015 18:07:03 +0200
Subject: [gdal-dev] Suggested new typemap for the bindings
In-Reply-To: <555DF88C.6060304@gmail.com>
References: <555DF88C.6060304@gmail.com>
Message-ID: <201505211807.03454.even.rouault@spatialys.com>

Ari,

I regenerated the Python bindings and I'm now spammed with messages like the 
following that cause the tests to fail:

$ python vsifile.py
  TEST: vsifile_1 ... swig/python detected a memory leak of type 'VSI_RETVAL 
*', no destructor found.
swig/python detected a memory leak of type 'VSI_RETVAL *', no destructor 
found.
swig/python detected a memory leak of type 'VSI_RETVAL *', no destructor 
found.
fail
    line 96: failure
[...]

It looks like

 %{
 /* use this to not return the int returned by GDAL */
 typedef int RETURN_NONE;
+/* return value that is used for VSI methods that return -1 on error (and set 
errno) */
+typedef int VSI_RETVAL;
 
 %}

is not sufficient and we would need to instanciate typemaps for this in the 
Python bindings ? I hate SWIG... I'm afraid other languages might have similar 
issue

Even

> I defined a new type VSI_RETVAL to be used instead of int with VSI
> functions that return -1 in error and set errno.
> 
> For the Perl bindings I defined two typemaps for this type. One which
> strips the return value and one which throws an error if the return
> value is -1. The error is strerror(errno).
> 
> I think this improves the usability of those VSI functions from the
> binded languages.
> 
> Ari
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Thu May 21 09:13:18 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Thu, 21 May 2015 19:13:18 +0300
Subject: [gdal-dev] Suggested new typemap for the bindings
In-Reply-To: <201505211807.03454.even.rouault@spatialys.com>
References: <555DF88C.6060304@gmail.com>
	<201505211807.03454.even.rouault@spatialys.com>
Message-ID: <555E041E.4030403@gmail.com>

21.05.2015, 19:07, Even Rouault kirjoitti:
> Ari,
>
> I regenerated the Python bindings and I'm now spammed with messages like the
> following that cause the tests to fail:
>
> $ python vsifile.py
>    TEST: vsifile_1 ... swig/python detected a memory leak of type 'VSI_RETVAL
> *', no destructor found.
> swig/python detected a memory leak of type 'VSI_RETVAL *', no destructor
> found.
> swig/python detected a memory leak of type 'VSI_RETVAL *', no destructor
> found.
> fail
>      line 96: failure
> [...]
>
> It looks like
>
>   %{
>   /* use this to not return the int returned by GDAL */
>   typedef int RETURN_NONE;
> +/* return value that is used for VSI methods that return -1 on error (and set
> errno) */
> +typedef int VSI_RETVAL;
>   
>   %}
>
> is not sufficient and we would need to instanciate typemaps for this in the
> Python bindings ? I hate SWIG... I'm afraid other languages might have similar
> issue

I tried to avoid a lot of ifdef PERLs...

There should be a way to tell swig that VSI_RETVAL should use int 
typemaps unless they are defined specially. Hm.

Ari


>
> Even
>
>> I defined a new type VSI_RETVAL to be used instead of int with VSI
>> functions that return -1 in error and set errno.
>>
>> For the Perl bindings I defined two typemaps for this type. One which
>> strips the return value and one which throws an error if the return
>> value is -1. The error is strerror(errno).
>>
>> I think this improves the usability of those VSI functions from the
>> binded languages.
>>
>> Ari
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From even.rouault at spatialys.com  Thu May 21 09:19:32 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 21 May 2015 18:19:32 +0200
Subject: [gdal-dev] change PROJCS information within GDAL dataset
In-Reply-To: <20150521175704.410709cd@nature.speedport.ip>
References: <20150521175704.410709cd@nature.speedport.ip>
Message-ID: <201505211819.32152.even.rouault@spatialys.com>

Le jeudi 21 mai 2015 17:57:04, Otto Dassau a ?crit :
> Hi,
> 
> is it possible to change parameters, e.g. a AUTHORITY["EPSG","9001"]]]
> value inside the PROJCS area of an existing GDAL dataset with gdal_edit.py?
> 
> PROJCS["UTM Zone 33, Northern Hemisphere",
>     GEOGCS["GRS 1980(IUGG, 1980)",
>         DATUM["unknown",
>             SPHEROID["GRS80",6378137,298.257222101],
>             TOWGS84[0,0,0,0,0,0,0]],
>         PRIMEM["Greenwich",0],
>         UNIT["degree",0.0174532925199433]],
>     PROJECTION["Transverse_Mercator"],
>     PARAMETER["latitude_of_origin",0],
>     PARAMETER["central_meridian",15],
>     PARAMETER["scale_factor",0.9996],
>     PARAMETER["false_easting",500000],
>     PARAMETER["false_northing",0],
>     UNIT["metre",1,
>         AUTHORITY["EPSG","9001"]]]
> [...]
> 
> I managed to add Metadata information with -mo, but don't know how to use
> the -oo parameter.

Otto,

put the new SRS definition into a text file, let's say srs.wkt, and use 
gdal_edit.py -a_srs srs.wkt

But... in your case  AUTHORITY["EPSG","9001"] qualifies the UNIT meter and not 
the whole PROJCS (look at the brackets ;-))), which is what you likely want to 
do.

So you could more simply use -a_srs EPSG:XXXX where XXXX is the EPSG code of 
the CRS (25833 might be a good candidate in your case)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Thu May 21 09:22:08 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Thu, 21 May 2015 19:22:08 +0300
Subject: [gdal-dev] Suggested new typemap for the bindings
In-Reply-To: <201505211807.03454.even.rouault@spatialys.com>
References: <555DF88C.6060304@gmail.com>
	<201505211807.03454.even.rouault@spatialys.com>
Message-ID: <555E0630.7020609@gmail.com>

Probably just adding

%apply (int) {VSI_RETVAL};

is enough...



From even.rouault at spatialys.com  Thu May 21 09:30:20 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 21 May 2015 18:30:20 +0200
Subject: [gdal-dev] Suggested new typemap for the bindings
In-Reply-To: <555E0630.7020609@gmail.com>
References: <555DF88C.6060304@gmail.com>
	<201505211807.03454.even.rouault@spatialys.com>
	<555E0630.7020609@gmail.com>
Message-ID: <201505211830.20172.even.rouault@spatialys.com>

Le jeudi 21 mai 2015 18:22:08, Ari Jolma a ?crit :
> Probably just adding
> 
> %apply (int) {VSI_RETVAL};
> 
> is enough...

Yes, indeed. So I've committed :
r29225
"Add default typemap for VSI_RETVAL for Python, CSharp and Java; Regenerate 
python bindings"

Nice to have you as our Swig champion ;-)

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Thu May 21 09:34:03 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Thu, 21 May 2015 19:34:03 +0300
Subject: [gdal-dev] Suggested new typemap for the bindings
In-Reply-To: <201505211830.20172.even.rouault@spatialys.com>
References: <555DF88C.6060304@gmail.com>
	<201505211807.03454.even.rouault@spatialys.com>
	<555E0630.7020609@gmail.com>
	<201505211830.20172.even.rouault@spatialys.com>
Message-ID: <555E08FB.6040905@gmail.com>

21.05.2015, 19:30, Even Rouault kirjoitti:
> Le jeudi 21 mai 2015 18:22:08, Ari Jolma a ?crit :
>> Probably just adding
>>
>> %apply (int) {VSI_RETVAL};
>>
>> is enough...
> Yes, indeed. So I've committed :
> r29225
> "Add default typemap for VSI_RETVAL for Python, CSharp and Java; Regenerate
> python bindings"

ok, I put the same thing in gdal.i so it's now doubly sure :)

Ari

>
> Nice to have you as our Swig champion ;-)
>


From sameer.sheikh at wetransform.to  Thu May 21 09:45:49 2015
From: sameer.sheikh at wetransform.to (sameer.sheikh at wetransform.to)
Date: Thu, 21 May 2015 16:45:49 +0000
Subject: [gdal-dev] Reading multipatch textures from FileGeoDataBase using
	GDAL
Message-ID: <70f1e6fb900a853e1caba9a43cf7fd30@www.wetransform.to>

Hello,
I am using GDAL (Java binding) API in my application to read from file geodatabase. I am trying to read multipatch geometry and textures of a Building.
I could read features, Geometry, relationship information etc. from file geodatabase, but unable to read multipatch textures.
Could anybody suggest me approach to read textures from filegeodatabase?
Regards,
Sameer Sheikh
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150521/7628ca6f/attachment.html>

From even.rouault at spatialys.com  Thu May 21 10:05:24 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 21 May 2015 19:05:24 +0200
Subject: [gdal-dev] Reading multipatch textures from FileGeoDataBase
	using GDAL
In-Reply-To: <70f1e6fb900a853e1caba9a43cf7fd30@www.wetransform.to>
References: <70f1e6fb900a853e1caba9a43cf7fd30@www.wetransform.to>
Message-ID: <201505211905.24786.even.rouault@spatialys.com>

Sameer,

> I am using GDAL (Java binding) API in my application to read from file
> geodatabase. I am trying to read multipatch geometry and textures of a
> Building. I could read features, Geometry, relationship information etc.
> from file geodatabase, but unable to read multipatch textures. Could
> anybody suggest me approach to read textures from filegeodatabase?

There's no way with OGR currently. You should be able to get the vertex 
information from the multipatch, but textures are ignored for now. It's not 
directly obvious however how they could be modelled in OGR.

If you're also a C/C++ programmer, you could look at the Extended Shapefile 
specification provided with the FileGDB SDK, and hack into 
ogr/ogrpgeogeometry.cpp to enhance the multipatch decoder to decode textures.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu May 21 11:15:26 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 21 May 2015 20:15:26 +0200
Subject: [gdal-dev] Volunteer to assist for GDAL workshop at FOSS4G-E ?
Message-ID: <201505212015.27043.even.rouault@spatialys.com>

Hi,

I'll be giving a workshop at FOSS4G-E at Como on July 14th about GDAL : 
http://europe.foss4g.org/2015/Workshops

I was wondering if someone who would be available that day on that timeslot 
(morning) would be willing to help me assisting attendees. Besides some 
familiarity with GDAL command line utilities (and possibly Python), no prior 
preparation needed : I'm taking care of preparing test data and exercices.

If you're interested or have questions, let me know.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From sfkeller at gmail.com  Thu May 21 14:17:26 2015
From: sfkeller at gmail.com (Stefan Keller)
Date: Thu, 21 May 2015 23:17:26 +0200
Subject: [gdal-dev] OGR Field Types?
In-Reply-To: <CAFcOn29Er991kbrYYx3fE8OCB41bmdxAYpDad00sPJ1Pspuwxw@mail.gmail.com>
References: <CAFcOn28oLBOBdA6ExSUtHOphuYWb-hcyj6oFeAVEoWHzSZRD6A@mail.gmail.com>
	<201504292035.49049.even.rouault@spatialys.com>
	<CAFcOn29Er991kbrYYx3fE8OCB41bmdxAYpDad00sPJ1Pspuwxw@mail.gmail.com>
Message-ID: <CAFcOn2-SaN4p_KJCZXrL52b+q4d1g5WdmaeXqDVCq3eOr-yHhg@mail.gmail.com>

Hi Even

I just see some type mod and subtype definitions for .csvt files in
the CSV docs [1] :
<<
In a single line the types for each column have to be listed with
double quotes and be comma separated (e.g., "Integer","String"). It is
also possible to specify explicitly the width and precision of each
column, e.g. "Integer(5)","Real(10.7)","String(15)". The driver will
then use these types as specified for the csv columns. Starting with
GDAL 2.0, subtypes can be passed between parenthesis, such as
"Integer(Boolean)", "Integer(Int16)" and "Real(Float32)"
<<

Following questions and suggestions about .csvt:
1. Do type names really have to be in double quotes?
2. Is the separator always comma or can it also be a semicolon?
3. What about a Geometry type with subtypes? I suggest to add
4. "Geometry(Easting)","Geometry(Northing)"
5. "Geometry" -- encoded in WKT; having subtype values WKT (default),
Point, LineString, Polygon.

What do you think?
This could also make QGIS "Add Delimited Text Layer..." even better.

--S.

[1] http://www.gdal.org/drv_csv.html

2015-04-29 22:57 GMT+02:00 Stefan Keller <sfkeller at gmail.com>:
> Salut Even,
>
> Merci!
>
> 2015-04-29 20:35 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
>> Stefan
>>>
>>> Questions:
>>> 1. How is 'binary' encoded? E.g. when defining binary in a CSV file,
>>> how is it encoded? Hex?
>>
>> There's no support in the CSV driver for binary data
>>
>>> 2. Can a field in a CSV input files have a IntegerList or a Binary?
>>
>> No. Well on writing, the IntegerList will be serialized as a string. But not
>> recognized as IntegerList on reading
>>
>>> 3. What is the value delimiter in a field of type IntegerList,
>>> Integer64List, RealList, StringList?
>>
>> The default serializatoin will be (number_of_elements:val1,val2,...,valn), but
>> currently it is truncated to 80 chracters
>>
>>> 4. "Boolean, Int16, Float32" are mentioned as subtypes. Are there more
>>> subtypes?
>>
>> Not currently. See https://trac.osgeo.org/gdal/wiki/rfc50_ogr_field_subtype
>>
>> Even
>>
>> --
>> Spatialys - Geospatial professional services
>> http://www.spatialys.com

From even.rouault at spatialys.com  Thu May 21 14:34:52 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 21 May 2015 23:34:52 +0200
Subject: [gdal-dev] OGR Field Types?
In-Reply-To: <CAFcOn2-SaN4p_KJCZXrL52b+q4d1g5WdmaeXqDVCq3eOr-yHhg@mail.gmail.com>
References: <CAFcOn28oLBOBdA6ExSUtHOphuYWb-hcyj6oFeAVEoWHzSZRD6A@mail.gmail.com>
	<CAFcOn29Er991kbrYYx3fE8OCB41bmdxAYpDad00sPJ1Pspuwxw@mail.gmail.com>
	<CAFcOn2-SaN4p_KJCZXrL52b+q4d1g5WdmaeXqDVCq3eOr-yHhg@mail.gmail.com>
Message-ID: <201505212334.52905.even.rouault@spatialys.com>

Le jeudi 21 mai 2015 23:17:26, Stefan Keller a ?crit :
> Hi Even
> 
> I just see some type mod and subtype definitions for .csvt files in
> the CSV docs [1] :
> <<
> In a single line the types for each column have to be listed with
> double quotes and be comma separated (e.g., "Integer","String"). It is
> also possible to specify explicitly the width and precision of each
> column, e.g. "Integer(5)","Real(10.7)","String(15)". The driver will
> then use these types as specified for the csv columns. Starting with
> GDAL 2.0, subtypes can be passed between parenthesis, such as
> "Integer(Boolean)", "Integer(Int16)" and "Real(Float32)"
> <<
> 
> Following questions and suggestions about .csvt:
> 1. Do type names really have to be in double quotes?
No
> 2. Is the separator always comma or can it also be a semicolon?
Yes, always comma
> 3. What about a Geometry type with subtypes? I suggest to add
> 4. "Geometry(Easting)","Geometry(Northing)"
For points only I guess? Well you can build points with a OGR VRT from 2 CSV 
columns. I might perhaps add in some time an open option to specify the 
columns for the easting/longitude and northing/latitude.
> 5. "Geometry" -- encoded in WKT; having subtype values WKT (default),
> Point, LineString, Polygon.
"WKT" is not really consistant with Point,LineString,Polygon since the later 
would be expressed as WKT I guess. So perhaps WKT, WKT(Point), 
WKT(LineString), WKT(Polygon) ?

> 
> What do you think?
> This could also make QGIS "Add Delimited Text Layer..." even better.
> 
> --S.
> 
> [1] http://www.gdal.org/drv_csv.html
> 
> 2015-04-29 22:57 GMT+02:00 Stefan Keller <sfkeller at gmail.com>:
> > Salut Even,
> > 
> > Merci!
> > 
> > 2015-04-29 20:35 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
> >> Stefan
> >> 
> >>> Questions:
> >>> 1. How is 'binary' encoded? E.g. when defining binary in a CSV file,
> >>> how is it encoded? Hex?
> >> 
> >> There's no support in the CSV driver for binary data
> >> 
> >>> 2. Can a field in a CSV input files have a IntegerList or a Binary?
> >> 
> >> No. Well on writing, the IntegerList will be serialized as a string. But
> >> not recognized as IntegerList on reading
> >> 
> >>> 3. What is the value delimiter in a field of type IntegerList,
> >>> Integer64List, RealList, StringList?
> >> 
> >> The default serializatoin will be
> >> (number_of_elements:val1,val2,...,valn), but currently it is truncated
> >> to 80 chracters
> >> 
> >>> 4. "Boolean, Int16, Float32" are mentioned as subtypes. Are there more
> >>> subtypes?
> >> 
> >> Not currently. See
> >> https://trac.osgeo.org/gdal/wiki/rfc50_ogr_field_subtype
> >> 
> >> Even
> >> 
> >> --
> >> Spatialys - Geospatial professional services
> >> http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From sfkeller at gmail.com  Thu May 21 15:33:43 2015
From: sfkeller at gmail.com (Stefan Keller)
Date: Fri, 22 May 2015 00:33:43 +0200
Subject: [gdal-dev] OGR Field Types?
In-Reply-To: <201505212334.52905.even.rouault@spatialys.com>
References: <CAFcOn28oLBOBdA6ExSUtHOphuYWb-hcyj6oFeAVEoWHzSZRD6A@mail.gmail.com>
	<CAFcOn29Er991kbrYYx3fE8OCB41bmdxAYpDad00sPJ1Pspuwxw@mail.gmail.com>
	<CAFcOn2-SaN4p_KJCZXrL52b+q4d1g5WdmaeXqDVCq3eOr-yHhg@mail.gmail.com>
	<201505212334.52905.even.rouault@spatialys.com>
Message-ID: <CAFcOn28ueEZ0kFBUzsvNuy9O07CA4D2L_jT2u+ppC8JFgFPpZA@mail.gmail.com>

2015-05-21 23:34 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
...
>> 4. "Geometry(Easting)","Geometry(Northing)"
> For points only I guess?

Yes.

>> 5. "Geometry" -- encoded in WKT; having subtype values WKT (default),
>> Point, LineString, Polygon.
> "WKT" is not really consistant with Point,LineString,Polygon since the later
> would be expressed as WKT I guess. So perhaps WKT, WKT(Point),
> WKT(LineString), WKT(Polygon) ?

Right, d'accord. So, let's introduce following two geometry types:
* "Easting","Northing"
* WKT, WKT(Point), WKT(LineString), WKT(Polygon)

There are additional restricions to these geometry types:
* "Easting","Northing" must co-occur and should be neighboring columns
(in either order).
* if WKT is given, all rows are expected to contain the same geometry type.
* There's only one geometry column per .csvt, namely either
<<"Easting","Northing">> or <<WKT>>.

OK?

--S.


2015-05-21 23:34 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
> Le jeudi 21 mai 2015 23:17:26, Stefan Keller a ?crit :
>> Hi Even
>>
>> I just see some type mod and subtype definitions for .csvt files in
>> the CSV docs [1] :
>> <<
>> In a single line the types for each column have to be listed with
>> double quotes and be comma separated (e.g., "Integer","String"). It is
>> also possible to specify explicitly the width and precision of each
>> column, e.g. "Integer(5)","Real(10.7)","String(15)". The driver will
>> then use these types as specified for the csv columns. Starting with
>> GDAL 2.0, subtypes can be passed between parenthesis, such as
>> "Integer(Boolean)", "Integer(Int16)" and "Real(Float32)"
>> <<
>>
>> Following questions and suggestions about .csvt:
>> 1. Do type names really have to be in double quotes?
> No
>> 2. Is the separator always comma or can it also be a semicolon?
> Yes, always comma
>> 3. What about a Geometry type with subtypes? I suggest to add
>> 4. "Geometry(Easting)","Geometry(Northing)"
> For points only I guess? Well you can build points with a OGR VRT from 2 CSV
> columns. I might perhaps add in some time an open option to specify the
> columns for the easting/longitude and northing/latitude.
>> 5. "Geometry" -- encoded in WKT; having subtype values WKT (default),
>> Point, LineString, Polygon.
> "WKT" is not really consistant with Point,LineString,Polygon since the later
> would be expressed as WKT I guess. So perhaps WKT, WKT(Point),
> WKT(LineString), WKT(Polygon) ?
>
>>
>> What do you think?
>> This could also make QGIS "Add Delimited Text Layer..." even better.
>>
>> --S.
>>
>> [1] http://www.gdal.org/drv_csv.html
>>
>> 2015-04-29 22:57 GMT+02:00 Stefan Keller <sfkeller at gmail.com>:
>> > Salut Even,
>> >
>> > Merci!
>> >
>> > 2015-04-29 20:35 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
>> >> Stefan
>> >>
>> >>> Questions:
>> >>> 1. How is 'binary' encoded? E.g. when defining binary in a CSV file,
>> >>> how is it encoded? Hex?
>> >>
>> >> There's no support in the CSV driver for binary data
>> >>
>> >>> 2. Can a field in a CSV input files have a IntegerList or a Binary?
>> >>
>> >> No. Well on writing, the IntegerList will be serialized as a string. But
>> >> not recognized as IntegerList on reading
>> >>
>> >>> 3. What is the value delimiter in a field of type IntegerList,
>> >>> Integer64List, RealList, StringList?
>> >>
>> >> The default serializatoin will be
>> >> (number_of_elements:val1,val2,...,valn), but currently it is truncated
>> >> to 80 chracters
>> >>
>> >>> 4. "Boolean, Int16, Float32" are mentioned as subtypes. Are there more
>> >>> subtypes?
>> >>
>> >> Not currently. See
>> >> https://trac.osgeo.org/gdal/wiki/rfc50_ogr_field_subtype
>> >>
>> >> Even
>> >>
>> >> --
>> >> Spatialys - Geospatial professional services
>> >> http://www.spatialys.com
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com

From even.rouault at spatialys.com  Thu May 21 15:53:45 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 22 May 2015 00:53:45 +0200
Subject: [gdal-dev] OGR Field Types?
In-Reply-To: <CAFcOn28ueEZ0kFBUzsvNuy9O07CA4D2L_jT2u+ppC8JFgFPpZA@mail.gmail.com>
References: <CAFcOn28oLBOBdA6ExSUtHOphuYWb-hcyj6oFeAVEoWHzSZRD6A@mail.gmail.com>
	<201505212334.52905.even.rouault@spatialys.com>
	<CAFcOn28ueEZ0kFBUzsvNuy9O07CA4D2L_jT2u+ppC8JFgFPpZA@mail.gmail.com>
Message-ID: <201505220053.45562.even.rouault@spatialys.com>

Le vendredi 22 mai 2015 00:33:43, Stefan Keller a ?crit :
> 2015-05-21 23:34 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
> ...
> 
> >> 4. "Geometry(Easting)","Geometry(Northing)"
> > 
> > For points only I guess?
> 
> Yes.
> 
> >> 5. "Geometry" -- encoded in WKT; having subtype values WKT (default),
> >> Point, LineString, Polygon.
> > 
> > "WKT" is not really consistant with Point,LineString,Polygon since the
> > later would be expressed as WKT I guess. So perhaps WKT, WKT(Point),
> > WKT(LineString), WKT(Polygon) ?
> 
> Right, d'accord. So, let's introduce following two geometry types:
> * "Easting","Northing"
X,Y or Geometry(X), Geometry(Y) or Point(X),Point(Y) would perhaps be easier 
to get. I don't know.
> * WKT, WKT(Point), WKT(LineString), WKT(Polygon)
> 
> There are additional restricions to these geometry types:
> * "Easting","Northing" must co-occur and should be neighboring columns
> (in either order).
I guess most people would do that, but I don't see a strong rationale to 
impose neighboring coumns
> * if WKT is given, all rows are expected to contain the same geometry type.
For generic WKT, all geometry types should be possible (as currently). Only 
for WKT(xxxx), geometries should be restricted to the specified type.
> * There's only one geometry column per .csvt, namely either
> <<"Easting","Northing">> or <<WKT>>.
Kind of makes sense for Easting,Northing. But for WKT columns I don't see a 
reason for such a restriction. Actually there's already a 
secret/undocumented/debug mode in the CSV driver to read multiple geometry 
columns (I won't reveal it unless I'm tortured, but you can look at the code). 
This was mostly useful at the first stages when developing RFC 41.

> 
> OK?

Not sure what kind of committment would be expected if I say "OK", so I'll 
abstain ;-)

> 
> --S.
> 
> 2015-05-21 23:34 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
> > Le jeudi 21 mai 2015 23:17:26, Stefan Keller a ?crit :
> >> Hi Even
> >> 
> >> I just see some type mod and subtype definitions for .csvt files in
> >> the CSV docs [1] :
> >> <<
> >> In a single line the types for each column have to be listed with
> >> double quotes and be comma separated (e.g., "Integer","String"). It is
> >> also possible to specify explicitly the width and precision of each
> >> column, e.g. "Integer(5)","Real(10.7)","String(15)". The driver will
> >> then use these types as specified for the csv columns. Starting with
> >> GDAL 2.0, subtypes can be passed between parenthesis, such as
> >> "Integer(Boolean)", "Integer(Int16)" and "Real(Float32)"
> >> <<
> >> 
> >> Following questions and suggestions about .csvt:
> >> 1. Do type names really have to be in double quotes?
> > 
> > No
> > 
> >> 2. Is the separator always comma or can it also be a semicolon?
> > 
> > Yes, always comma
> > 
> >> 3. What about a Geometry type with subtypes? I suggest to add
> >> 4. "Geometry(Easting)","Geometry(Northing)"
> > 
> > For points only I guess? Well you can build points with a OGR VRT from 2
> > CSV columns. I might perhaps add in some time an open option to specify
> > the columns for the easting/longitude and northing/latitude.
> > 
> >> 5. "Geometry" -- encoded in WKT; having subtype values WKT (default),
> >> Point, LineString, Polygon.
> > 
> > "WKT" is not really consistant with Point,LineString,Polygon since the
> > later would be expressed as WKT I guess. So perhaps WKT, WKT(Point),
> > WKT(LineString), WKT(Polygon) ?
> > 
> >> What do you think?
> >> This could also make QGIS "Add Delimited Text Layer..." even better.
> >> 
> >> --S.
> >> 
> >> [1] http://www.gdal.org/drv_csv.html
> >> 
> >> 2015-04-29 22:57 GMT+02:00 Stefan Keller <sfkeller at gmail.com>:
> >> > Salut Even,
> >> > 
> >> > Merci!
> >> > 
> >> > 2015-04-29 20:35 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
> >> >> Stefan
> >> >> 
> >> >>> Questions:
> >> >>> 1. How is 'binary' encoded? E.g. when defining binary in a CSV file,
> >> >>> how is it encoded? Hex?
> >> >> 
> >> >> There's no support in the CSV driver for binary data
> >> >> 
> >> >>> 2. Can a field in a CSV input files have a IntegerList or a Binary?
> >> >> 
> >> >> No. Well on writing, the IntegerList will be serialized as a string.
> >> >> But not recognized as IntegerList on reading
> >> >> 
> >> >>> 3. What is the value delimiter in a field of type IntegerList,
> >> >>> Integer64List, RealList, StringList?
> >> >> 
> >> >> The default serializatoin will be
> >> >> (number_of_elements:val1,val2,...,valn), but currently it is
> >> >> truncated to 80 chracters
> >> >> 
> >> >>> 4. "Boolean, Int16, Float32" are mentioned as subtypes. Are there
> >> >>> more subtypes?
> >> >> 
> >> >> Not currently. See
> >> >> https://trac.osgeo.org/gdal/wiki/rfc50_ogr_field_subtype
> >> >> 
> >> >> Even
> >> >> 
> >> >> --
> >> >> Spatialys - Geospatial professional services
> >> >> http://www.spatialys.com
> > 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From sfkeller at gmail.com  Thu May 21 16:07:30 2015
From: sfkeller at gmail.com (Stefan Keller)
Date: Fri, 22 May 2015 01:07:30 +0200
Subject: [gdal-dev] OGR Field Types?
In-Reply-To: <201505220053.45562.even.rouault@spatialys.com>
References: <CAFcOn28oLBOBdA6ExSUtHOphuYWb-hcyj6oFeAVEoWHzSZRD6A@mail.gmail.com>
	<201505212334.52905.even.rouault@spatialys.com>
	<CAFcOn28ueEZ0kFBUzsvNuy9O07CA4D2L_jT2u+ppC8JFgFPpZA@mail.gmail.com>
	<201505220053.45562.even.rouault@spatialys.com>
Message-ID: <CAFcOn28gBGuhcB=gQnuVAzXvkg-L8XveR3TrBwFB4swND6c7CQ@mail.gmail.com>

2015-05-22 0:53 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
...
>> * "Easting","Northing"
> X,Y or Geometry(X), Geometry(Y) or Point(X),Point(Y) would perhaps be easier
> to get. I don't know.

So let's propose Point(X),Point(Y) or PointX,PointY.

-S.


2015-05-22 0:53 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
> Le vendredi 22 mai 2015 00:33:43, Stefan Keller a ?crit :
>> 2015-05-21 23:34 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
>> ...
>>
>> >> 4. "Geometry(Easting)","Geometry(Northing)"
>> >
>> > For points only I guess?
>>
>> Yes.
>>
>> >> 5. "Geometry" -- encoded in WKT; having subtype values WKT (default),
>> >> Point, LineString, Polygon.
>> >
>> > "WKT" is not really consistant with Point,LineString,Polygon since the
>> > later would be expressed as WKT I guess. So perhaps WKT, WKT(Point),
>> > WKT(LineString), WKT(Polygon) ?
>>
>> Right, d'accord. So, let's introduce following two geometry types:
>> * "Easting","Northing"
> X,Y or Geometry(X), Geometry(Y) or Point(X),Point(Y) would perhaps be easier
> to get. I don't know.
>> * WKT, WKT(Point), WKT(LineString), WKT(Polygon)
>>
>> There are additional restricions to these geometry types:
>> * "Easting","Northing" must co-occur and should be neighboring columns
>> (in either order).
> I guess most people would do that, but I don't see a strong rationale to
> impose neighboring coumns
>> * if WKT is given, all rows are expected to contain the same geometry type.
> For generic WKT, all geometry types should be possible (as currently). Only
> for WKT(xxxx), geometries should be restricted to the specified type.
>> * There's only one geometry column per .csvt, namely either
>> <<"Easting","Northing">> or <<WKT>>.
> Kind of makes sense for Easting,Northing. But for WKT columns I don't see a
> reason for such a restriction. Actually there's already a
> secret/undocumented/debug mode in the CSV driver to read multiple geometry
> columns (I won't reveal it unless I'm tortured, but you can look at the code).
> This was mostly useful at the first stages when developing RFC 41.
>
>>
>> OK?
>
> Not sure what kind of committment would be expected if I say "OK", so I'll
> abstain ;-)
>
>>
>> --S.
>>
>> 2015-05-21 23:34 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
>> > Le jeudi 21 mai 2015 23:17:26, Stefan Keller a ?crit :
>> >> Hi Even
>> >>
>> >> I just see some type mod and subtype definitions for .csvt files in
>> >> the CSV docs [1] :
>> >> <<
>> >> In a single line the types for each column have to be listed with
>> >> double quotes and be comma separated (e.g., "Integer","String"). It is
>> >> also possible to specify explicitly the width and precision of each
>> >> column, e.g. "Integer(5)","Real(10.7)","String(15)". The driver will
>> >> then use these types as specified for the csv columns. Starting with
>> >> GDAL 2.0, subtypes can be passed between parenthesis, such as
>> >> "Integer(Boolean)", "Integer(Int16)" and "Real(Float32)"
>> >> <<
>> >>
>> >> Following questions and suggestions about .csvt:
>> >> 1. Do type names really have to be in double quotes?
>> >
>> > No
>> >
>> >> 2. Is the separator always comma or can it also be a semicolon?
>> >
>> > Yes, always comma
>> >
>> >> 3. What about a Geometry type with subtypes? I suggest to add
>> >> 4. "Geometry(Easting)","Geometry(Northing)"
>> >
>> > For points only I guess? Well you can build points with a OGR VRT from 2
>> > CSV columns. I might perhaps add in some time an open option to specify
>> > the columns for the easting/longitude and northing/latitude.
>> >
>> >> 5. "Geometry" -- encoded in WKT; having subtype values WKT (default),
>> >> Point, LineString, Polygon.
>> >
>> > "WKT" is not really consistant with Point,LineString,Polygon since the
>> > later would be expressed as WKT I guess. So perhaps WKT, WKT(Point),
>> > WKT(LineString), WKT(Polygon) ?
>> >
>> >> What do you think?
>> >> This could also make QGIS "Add Delimited Text Layer..." even better.
>> >>
>> >> --S.
>> >>
>> >> [1] http://www.gdal.org/drv_csv.html
>> >>
>> >> 2015-04-29 22:57 GMT+02:00 Stefan Keller <sfkeller at gmail.com>:
>> >> > Salut Even,
>> >> >
>> >> > Merci!
>> >> >
>> >> > 2015-04-29 20:35 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
>> >> >> Stefan
>> >> >>
>> >> >>> Questions:
>> >> >>> 1. How is 'binary' encoded? E.g. when defining binary in a CSV file,
>> >> >>> how is it encoded? Hex?
>> >> >>
>> >> >> There's no support in the CSV driver for binary data
>> >> >>
>> >> >>> 2. Can a field in a CSV input files have a IntegerList or a Binary?
>> >> >>
>> >> >> No. Well on writing, the IntegerList will be serialized as a string.
>> >> >> But not recognized as IntegerList on reading
>> >> >>
>> >> >>> 3. What is the value delimiter in a field of type IntegerList,
>> >> >>> Integer64List, RealList, StringList?
>> >> >>
>> >> >> The default serializatoin will be
>> >> >> (number_of_elements:val1,val2,...,valn), but currently it is
>> >> >> truncated to 80 chracters
>> >> >>
>> >> >>> 4. "Boolean, Int16, Float32" are mentioned as subtypes. Are there
>> >> >>> more subtypes?
>> >> >>
>> >> >> Not currently. See
>> >> >> https://trac.osgeo.org/gdal/wiki/rfc50_ogr_field_subtype
>> >> >>
>> >> >> Even
>> >> >>
>> >> >> --
>> >> >> Spatialys - Geospatial professional services
>> >> >> http://www.spatialys.com
>> >
>> > --
>> > Spatialys - Geospatial professional services
>> > http://www.spatialys.com
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com

From ari.jolma at gmail.com  Fri May 22 01:38:58 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Fri, 22 May 2015 11:38:58 +0300
Subject: [gdal-dev] GIntBig in the bindings
Message-ID: <555EEB22.9050808@gmail.com>

It seems that there are quite a few interface methods with two versions 
where the only difference is whether GIntBig is used or not. Also some 
methods do not have GIntBig when they actually should use it since it is 
in the GDAL API.

I found out that at least in Swig Perl default typemaps have long long 
and unsigned long long. Thus using GIntBig should mostly be just the 
case of saying

%apply (long long) { GIntBig };

At least Python, Java and CSharp seem to have default typemaps for long 
long and unsigned long long.

However, what GIntBig really is, is a configure time decision. That 
should be somehow propagated to the bindings.

Ari


From ari.jolma at gmail.com  Fri May 22 01:46:05 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Fri, 22 May 2015 11:46:05 +0300
Subject: [gdal-dev] GIntBig in the bindings
In-Reply-To: <555EEB22.9050808@gmail.com>
References: <555EEB22.9050808@gmail.com>
Message-ID: <555EECCD.7000103@gmail.com>

22.05.2015, 11:38, Ari Jolma kirjoitti:
> It seems that there are quite a few interface methods with two 
> versions where the only difference is whether GIntBig is used or not. 
> Also some methods do not have GIntBig when they actually should use it 
> since it is in the GDAL API.
>
> I found out that at least in Swig Perl default typemaps have long long 
> and unsigned long long. Thus using GIntBig should mostly be just the 
> case of saying
>
> %apply (long long) { GIntBig };
>
> At least Python, Java and CSharp seem to have default typemaps for 
> long long and unsigned long long.
>
> However, what GIntBig really is, is a configure time decision. That 
> should be somehow propagated to the bindings.

I must also say that we're loosing (have lost?) the benefit of having a 
single set of "language independent" interface files because of all the 
#ifdefs in them. It might be easier to have only separate sets and then 
manually copy paste and edit when new things are added.

Ari

>
> Ari
>


From ari.jolma at gmail.com  Fri May 22 02:25:48 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Fri, 22 May 2015 12:25:48 +0300
Subject: [gdal-dev] GIntBig in the bindings
In-Reply-To: <555EEB22.9050808@gmail.com>
References: <555EEB22.9050808@gmail.com>
Message-ID: <555EF61C.3040206@gmail.com>

22.05.2015, 11:38, Ari Jolma kirjoitti:
> It seems that there are quite a few interface methods with two 
> versions where the only difference is whether GIntBig is used or not. 
> Also some methods do not have GIntBig when they actually should use it 
> since it is in the GDAL API.
>
> I found out that at least in Swig Perl default typemaps have long long 
> and unsigned long long. Thus using GIntBig should mostly be just the 
> case of saying
>
> %apply (long long) { GIntBig };
>
> At least Python, Java and CSharp seem to have default typemaps for 
> long long and unsigned long long.
>
> However, what GIntBig really is, is a configure time decision. That 
> should be somehow propagated to the bindings.

It is a compile time decision. It can be propagated like this (in 
interface file) (copied a piece of cpl_port.h):

%include "../../port/cpl_config.h"
#if defined(WIN32) && defined(_MSC_VER)
typedef __int64          GIntBig;
typedef unsigned __int64 GUIntBig;
#elif HAVE_LONG_LONG
typedef long long        GIntBig;
typedef unsigned long long GUIntBig;
#else
typedef long             GIntBig;
typedef unsigned long    GUIntBig;
#endif

Ari

>
> Ari
>


From even.rouault at spatialys.com  Fri May 22 02:44:22 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 22 May 2015 11:44:22 +0200
Subject: [gdal-dev] GIntBig in the bindings
In-Reply-To: <555EECCD.7000103@gmail.com>
References: <555EEB22.9050808@gmail.com> <555EECCD.7000103@gmail.com>
Message-ID: <201505221144.22856.even.rouault@spatialys.com>

Le vendredi 22 mai 2015 10:46:05, vous avez ?crit :
> 22.05.2015, 11:38, Ari Jolma kirjoitti:
> > It seems that there are quite a few interface methods with two
> > versions where the only difference is whether GIntBig is used or not.
> > Also some methods do not have GIntBig when they actually should use it
> > since it is in the GDAL API.
> > 
> > I found out that at least in Swig Perl default typemaps have long long
> > and unsigned long long. Thus using GIntBig should mostly be just the
> > case of saying
> > 
> > %apply (long long) { GIntBig };
> > 
> > At least Python, Java and CSharp seem to have default typemaps for
> > long long and unsigned long long.
> > 
> > However, what GIntBig really is, is a configure time decision. That
> > should be somehow propagated to the bindings.
> 
> I must also say that we're loosing (have lost?) the benefit of having a
> single set of "language independent" interface files because of all the
> #ifdefs in them. It might be easier to have only separate sets and then
> manually copy paste and edit when new things are added.

I don't know. We have the possibility to clear incrementally the .i file as 
soon as we identify that some features can be supported by all languages.

Regarding the GIntBig case, as it seems that the 4 languages officially 
supported (Java, Python, CSharp, Perl) have the in/out typemaps for GIntBig we 
can probably remove the #ifdef stuff. (Ruby has no such typemaps, but since we 
removed it from the makefiles, we don't have to care anymore)


> 
> Ari
> 
> > Ari
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri May 22 02:49:46 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 22 May 2015 11:49:46 +0200
Subject: [gdal-dev] GIntBig in the bindings
In-Reply-To: <555EF61C.3040206@gmail.com>
References: <555EEB22.9050808@gmail.com> <555EF61C.3040206@gmail.com>
Message-ID: <201505221149.46495.even.rouault@spatialys.com>

Le vendredi 22 mai 2015 11:25:48, Ari Jolma a ?crit :
> 22.05.2015, 11:38, Ari Jolma kirjoitti:
> > It seems that there are quite a few interface methods with two
> > versions where the only difference is whether GIntBig is used or not.
> > Also some methods do not have GIntBig when they actually should use it
> > since it is in the GDAL API.
> > 
> > I found out that at least in Swig Perl default typemaps have long long
> > and unsigned long long. Thus using GIntBig should mostly be just the
> > case of saying
> > 
> > %apply (long long) { GIntBig };
> > 
> > At least Python, Java and CSharp seem to have default typemaps for
> > long long and unsigned long long.
> > 
> > However, what GIntBig really is, is a configure time decision. That
> > should be somehow propagated to the bindings.
> 
> It is a compile time decision. It can be propagated like this (in
> interface file) (copied a piece of cpl_port.h):
> 
> %include "../../port/cpl_config.h"
> #if defined(WIN32) && defined(_MSC_VER)
> typedef __int64          GIntBig;
> typedef unsigned __int64 GUIntBig;
> #elif HAVE_LONG_LONG
> typedef long long        GIntBig;
> typedef unsigned long long GUIntBig;
> #else
> typedef long             GIntBig;
> typedef unsigned long    GUIntBig;
> #endif

Was wondering if SWIG would recognize __int64 on Windows. According to 
http://www.swig.org/Doc1.3/SWIGDocumentation.html ?3.4, %include <windows.i> 
would be needed

> 
> Ari
> 
> > Ari
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From sameer.sheikh at wetransform.to  Fri May 22 02:50:26 2015
From: sameer.sheikh at wetransform.to (sameer.sheikh at wetransform.to)
Date: Fri, 22 May 2015 09:50:26 +0000
Subject: [gdal-dev] Reading multipatch textures from FileGeoDataBase
 using GDAL
In-Reply-To: <201505211905.24786.even.rouault@spatialys.com>
References: <70f1e6fb900a853e1caba9a43cf7fd30@www.wetransform.to>
	<201505211905.24786.even.rouault@spatialys.com>
Message-ID: <a43a839b386f3bdb7504cf56fdb0f499@www.wetransform.to>

Hello Even,

Thank you for your suggestion, I have looked at ogr/ogrpgeogeometry.cpp file and I would like to point out the challenges that I am facing:
1. As far as I could understand it, the texture information has not been passed to the function which creates OGR representation from multipatch.
2. OGRrepresentation doesn't include a place to write images to, so that would need to be extended.
I would welcome and appreciate some guidance regarding what could be changed to make it work. Also, I  would like to mention that we are happy to contribute any improvements back.
Regards,
Sameer Sheikh
On Thu, May 21, 2015 at 07:05 PM, Even Rouault  wrote:
Sameer,

I am using GDAL (Java binding) API in my application to read from file
geodatabase. I am trying to read multipatch geometry and textures of a
Building. I could read features, Geometry, relationship information etc.
from file geodatabase, but unable to read multipatch textures. Could
anybody suggest me approach to read textures from filegeodatabase?

There's no way with OGR currently. You should be able to get the vertex 
information from the multipatch, but textures are ignored for now. It's not 
directly obvious however how they could be modelled in OGR.

If you're also a C/C++ programmer, you could look at the Extended Shapefile 
specification provided with the FileGDB SDK, and hack into 
ogr/ogrpgeogeometry.cpp to enhance the multipatch decoder to decode textures.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com (http://www.spatialys.com)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150522/9bc80026/attachment.html>

From even.rouault at spatialys.com  Fri May 22 03:57:37 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 22 May 2015 12:57:37 +0200
Subject: [gdal-dev] Reading multipatch textures from FileGeoDataBase
	using GDAL
In-Reply-To: <a43a839b386f3bdb7504cf56fdb0f499@www.wetransform.to>
References: <70f1e6fb900a853e1caba9a43cf7fd30@www.wetransform.to>
	<201505211905.24786.even.rouault@spatialys.com>
	<a43a839b386f3bdb7504cf56fdb0f499@www.wetransform.to>
Message-ID: <201505221257.37385.even.rouault@spatialys.com>

Le vendredi 22 mai 2015 11:50:26, sameer.sheikh at wetransform.to a ?crit :
> Hello Even,
> 
> Thank you for your suggestion, I have looked at ogr/ogrpgeogeometry.cpp
> file and I would like to point out the challenges that I am facing: 1. As
> far as I could understand it, the texture information has not been passed
> to the function which creates OGR representation from multipatch.

In the FileGDB driver, OGRCreateFromShapeBin() is called with the full 
geometry blob, including vertex coordinates, and hopefully followed by texture 
coordinates + material descriptions, which are currently ignored.

In the OpenFileGDB driver, as far as I remember, OGRCreateFromShapeBin() 
couldn't be directly called since the on-disk representation isn't directly 
the extended shapefile blob, although it is very close, and I didn't want to 
build an extended shapefile blob to be as fast as possible. So the parsing is 
done in more elementary steps and OGRCreateFromMultiPatchPart() is called. But 
I'd think that there are bytes currently ignored after the vertex information 
with the texture coords + materials. In case textures/materials are detected, 
you could also take a "slow" path and build the extended shapefile blob and 
pass it to OGRCreateFromShapeBin() to avoid code duplication.

> 2.
> OGRrepresentation doesn't include a place to write images to, so that
> would need to be extended. I would welcome and appreciate some guidance
> regarding what could be changed to make it work.

That's the tough part. We don't even have a proper geometry type for 
multipatch. Currently this is modelled as a OGRMultiPolygon but this isn't 
really correct, and should be a POLYHEDRALSURFACE as of ISO SQL MM-Part 3, 
becoming a new OGR geometry type OGRPolyhedralSurface.
Then you could imagine also add the texture and material info on it, although 
that seems to be really a ESRI specific stuff not present in standards, so not 
obvious if that would be appropriate to expose in the OGR abstraction.

Another idea would be to expose the geometry blob as a OFTBinary field of the 
feature (likely conditionnized by a open option so that folks that don't want 
it don't have issues with this binary field), and then parse it completely on 
your side, or have dedicated functions&structures in OGR to parse it and 
retrieve texture & material info.


> Also, I  would like to
> mention that we are happy to contribute any improvements back. Regards,
> Sameer Sheikh
> On Thu, May 21, 2015 at 07:05 PM, Even Rouault  wrote:
> Sameer,
> 
> I am using GDAL (Java binding) API in my application to read from file
> geodatabase. I am trying to read multipatch geometry and textures of a
> Building. I could read features, Geometry, relationship information etc.
> from file geodatabase, but unable to read multipatch textures. Could
> anybody suggest me approach to read textures from filegeodatabase?
> 
> There's no way with OGR currently. You should be able to get the vertex
> information from the multipatch, but textures are ignored for now. It's not
> directly obvious however how they could be modelled in OGR.
> 
> If you're also a C/C++ programmer, you could look at the Extended Shapefile
> specification provided with the FileGDB SDK, and hack into
> ogr/ogrpgeogeometry.cpp to enhance the multipatch decoder to decode
> textures.
> 
> Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Fri May 22 06:21:31 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Fri, 22 May 2015 16:21:31 +0300
Subject: [gdal-dev] GIntBig in the bindings
In-Reply-To: <201505221144.22856.even.rouault@spatialys.com>
References: <555EEB22.9050808@gmail.com> <555EECCD.7000103@gmail.com>
	<201505221144.22856.even.rouault@spatialys.com>
Message-ID: <555F2D5B.20406@gmail.com>

22.05.2015, 12:44, Even Rouault kirjoitti:
> Le vendredi 22 mai 2015 10:46:05, vous avez ?crit :
>> 22.05.2015, 11:38, Ari Jolma kirjoitti:
>>> It seems that there are quite a few interface methods with two
>>> versions where the only difference is whether GIntBig is used or not.
>>> Also some methods do not have GIntBig when they actually should use it
>>> since it is in the GDAL API.
>>>
>>> I found out that at least in Swig Perl default typemaps have long long
>>> and unsigned long long. Thus using GIntBig should mostly be just the
>>> case of saying
>>>
>>> %apply (long long) { GIntBig };
>>>
>>> At least Python, Java and CSharp seem to have default typemaps for
>>> long long and unsigned long long.
>>>
>>> However, what GIntBig really is, is a configure time decision. That
>>> should be somehow propagated to the bindings.
>> I must also say that we're loosing (have lost?) the benefit of having a
>> single set of "language independent" interface files because of all the
>> #ifdefs in them. It might be easier to have only separate sets and then
>> manually copy paste and edit when new things are added.
> I don't know. We have the possibility to clear incrementally the .i file as
> soon as we identify that some features can be supported by all languages.
>
> Regarding the GIntBig case, as it seems that the 4 languages officially
> supported (Java, Python, CSharp, Perl) have the in/out typemaps for GIntBig we
> can probably remove the #ifdef stuff. (Ruby has no such typemaps, but since we
> removed it from the makefiles, we don't have to care anymore)

The yesterday's solution to use %apply for VSI_RETVAL was probably not 
the best one.

I think a more correct way would be to simply say

typedef int VSI_RETVAL;

also outside %{ %}'s to make it known for swig that VSI_RETVAL is an int 
and it can be treated as an int by default. That is the same way we can 
make GIntBig known to swig.

It seems I knew this already since I made many changes like that in my 
github fork of gdal. I also made a pull request.

https://github.com/OSGeo/gdal/pull/48

Since GIntBig is possibly used in all bindings I think we need a new 
interface file gdal_typedefs.i, which is included by all.

I'll work on this on github.

Ari

>
>
>> Ari
>>
>>> Ari
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From andelamax38 at gmail.com  Fri May 22 16:19:15 2015
From: andelamax38 at gmail.com (Max Andela)
Date: Sat, 23 May 2015 08:19:15 +0900
Subject: [gdal-dev] gdalwarp problems with MODIS L1B
In-Reply-To: <201505201134.02313.even.rouault@spatialys.com>
References: <CAAcGz9_ejTVp+tik+nATfScvpiV3Hkdm_91=Q9xSKWcChxF5Lg@mail.gmail.com>
	<201505201134.02313.even.rouault@spatialys.com>
Message-ID: <CAGm=Sva6+8sX_TaFHHErR_edYkX2Jcs46ZvEhFm8r_zQq8sq+Q@mail.gmail.com>

Dear Even Rouault:
May I know how to input the latitude and longitude layers while warping
with gdalwarp?

Thanks.
max

On Wed, May 20, 2015 at 6:34 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Mike,
>
> >
> > By my reading of https://trac.osgeo.org/gdal/wiki/rfc4_geolocate that
> means
> > the Geolocation tag from gdalinfo should have a PIXEL_STEP and LINE_STEP
> of
> > 5, and if I do this I get a much better result but it's still not right.
>
> I've just committed a patch in trunk that should put more sensible values
> for
> those values :
> r29212 "HDF4: ProcessModisSDSGeolocation(): set more correct values for
> PIXEL_/LINE_ OFFSET/STEP by comparing longitude and latitude subdatasets
> dimensions with main subdataset dimensions"
>
>
> > I've put a jpeg image of the result, with the coastline mapped and not
> > lining up, here:
> >
> > http://staff.acecrc.org.au/~mdsumner/mod1.jpg
>
> Either the data itself is wrong, either there's an issue with the
> geolocation
> transformer... Later hypothesis is the more likely, although I've managed
> to
> make it work with L1B datasets where the tps or geoloc transformers gave
> roughly the same results.
>
> I've gotten smoother results by resizing the longitude&latitude
> subdatasets to
> the main subdataset dimension
>
> gdal_translate
> HDF4_SDS:UNKNOWN:"MOD021KM.A2012062.0455.006.2014220083128.hdf":1
> longitude.tif -outsize 1354 2030 -r cubic
>
> gdal_translate
> HDF4_SDS:UNKNOWN:"MOD021KM.A2012062.0455.006.2014220083128.hdf":0
> latitude.tif
> -outsize 1354 2030 -r cubic
>
> and then referencing them in the VRT produced with
>
> gdal_translate -of VRT
> HDF4_SDS:UNKNOWN:"MOD021KM.A2012062.0455.006.2014220083128.hdf":2 data.vrt
>
> (and then by correcting the offset and step values to 0 and 1 respectively)
>
> You might want to do the warp with -wo SAMPLE_GRID=YES -wo SAMPLE_STEPS=100
> too
>
> But overall the reprojected image stays roughly at the same location. This
> helps only removing a few artifacts on the edges.
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150523/2fb75146/attachment.html>

From ari.jolma at gmail.com  Sat May 23 00:00:40 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Sat, 23 May 2015 10:00:40 +0300
Subject: [gdal-dev] GIntBig in the bindings
In-Reply-To: <201505221144.22856.even.rouault@spatialys.com>
References: <555EEB22.9050808@gmail.com> <555EECCD.7000103@gmail.com>
	<201505221144.22856.even.rouault@spatialys.com>
Message-ID: <55602598.6070001@gmail.com>

22.05.2015, 12:44, Even Rouault kirjoitti:
>> 22.05.2015, 11:38, Ari Jolma kirjoitti:
>> I must also say that we're loosing (have lost?) the benefit of having 
>> a single set of "language independent" interface files because of all 
>> the #ifdefs in them. It might be easier to have only separate sets 
>> and then manually copy paste and edit when new things are added. 
> I don't know. We have the possibility to clear incrementally the .i file as
> soon as we identify that some features can be supported by all languages.

Here's an example from cpl.i. The bindings for BinaryToHex.

There are four cases separated by #ifdefs. In three of them the function 
declaration is the same, in one the return value is char* instead of 
retStringAndCPLFree*, which is a type defined for the bindings and a 
typemap is required for it (if there is no typemap, the code works but 
looses memory).

In the three others the difference is what typemap is applied. In one 
there is no apply and in the two others the typemap is almost the same 
except one uses unsigned char * and the other uses char *. I guess this 
is just because of convenience.

Overall in the interface files the apply's are causing many of the #ifdef's.

My suggestion is that we use recognized patterns in the function 
declarations and require that the language specific typemaps define 
typemaps for those that it needs.

In this case the pattern would be "int nBytes, const GByte *pabyData", 
which is used twice in the bindings as such and could be used in a 
couple more. For example in CreateGeometryFromWkb where OGR does not use 
it but I don't see why it couldn't be used.

I'll work on this approach in my github fork.

Best,

Ari


From even.rouault at spatialys.com  Mon May 25 03:36:30 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 25 May 2015 12:36:30 +0200
Subject: [gdal-dev] GDAL/OGR 2.0.0 Beta 2 Available
Message-ID: <201505251236.30815.even.rouault@spatialys.com>

Hi,

I have prepared the GDAL/OGR 2.0.0 Beta 2 release since we have had a
number of changes since beta 1 (see list at end of this email). Next step
will be RC1 probably in 2 weeks. The source is available at:

   http://download.osgeo.org/gdal/2.0.0beta2/gdal-2.0.0beta2.tar.xz
   http://download.osgeo.org/gdal/2.0.0beta2/gdal-2.0.0beta2.tar.gz
   http://download.osgeo.org/gdal/2.0.0beta2/gdal200beta2.zip

A snapshot of the Python autotest suite can be downloaded from:

   http://download.osgeo.org/gdal/2.0.0beta2/gdalautotest-2.0.0beta2.tar.gz
   http://download.osgeo.org/gdal/2.0.0beta2/gdalautotest-2.0.0beta2.zip

The GRASS plugins can be downloaded from (unchanged since beta 1):

   http://download.osgeo.org/gdal/2.0.0beta1/gdal-grass-2.0.0beta1.tar.gz

People are encouraged to report the build environments they have tried
(or use of prebuilt binaries) and the tests done in the test matrix.
We'd welcome more feedback.

   http://trac.osgeo.org/gdal/wiki/TestMatrix200

New bugs found should be filed in Trac normally.

   http://trac.osgeo.org/gdal

The updated NEWS is available at :
     http://svn.osgeo.org/gdal/trunk/gdal/NEWS

Anything that is committed into trunk for now will be in final 2.0,
so we need to be cautious at this stage.

Best regards,

Even

Annex - List of changes since Beta 1 :

Fix CPLHTTPFetch() retry logic (#5952)
gdalwarp: make -crop_to_cutline densify cutline in source SRS before reprojecting it to target SRS (#5951)
GeoJSON: support reading Feature without geometry field
OpenFileGDB: avoid warning when opening foo.gdb/a00000004.gdbtable
OpenFileGDB: optimize sequential reading of sparse layers, and test it
Small optimization in GDAL raster core & VRT: avoid creating scaled progress when base progress is NULL
RPC transformer: in DEM mode, implement optimization, in specific conditions (input points at same longitude, DEM in EPSG:4326) to extract several elevations at a time
PLScenes: dynamically discover layer schema for non ortho scene type
Perl bindings: Replace "create" with "new" in docs as new is now overridden in swig bindings.
FileGDB: really implements a almost ACID StartTransaction() by switching to the edited copy rather than staying on the original database
JPEG2000: indicated it is Jasper based in long name
GPSBabel: automatically open .igc files, implement Identify() and add open options
GPSBabel: advertize creation option
VRT: add more checks to CheckCompatibleForDatasetIO() to avoid issues with overview bands (patch by lplesea, #5954)
configure: do not enable Python bindings if PYTHON env variable is set without --with-python being explicitely specified (#5956)
Emulated transactions: allow CreateField(), etc... within transaction
Emulated transactions: remove ReadoptOldFeatureDefn() now that we cache the layer defn in the emulation layer
ogr2ogr: add -ds_transaction to force dataset transactions, mainly for FileGDB driver
Fix issue when removing an MSSQL spatial layer
MSSQLSpatial: Add support for creating features with default values (#5957)
MSSQLSpatial: Improve layer status handling when creating new layers in transaction.
Improve handling of no-data value by PCRaster driver (#5953)
GMLJP2: on reading, don't do axis inversation if there's an explicit axisName requesting easting, northing order (#5960); also strip axis order in reported SRS
Add Alos, Eros, Kompsat, RapiEye, Spot/Formosat satellite metadata readers. Fix common functions for this readers. Add autotests.
OpenFileGDB: disable feature count optimization with IS NOT NULL on an index column
FileGDB: enable bulk load on newly created layers
TIL: fix half pixel shift in geo registration (#5961)
NetCDF: fix crash on opening a NOAA dataset (#5962)
HFA: read projection even when it does not contain datum information (patch by jeepingben, #4659)
Algorithms: Unify GDALDestroy* functions behaviour (#3178)
HDF4: Fix AnyTypeToDouble() to use proper type (int instead of long) to work with DFNT_INT32/DFNT_UINT32 on 64-bit Linux (#5965)
GMLJP2: write non null bounding box at root of FeatureCollection (#5697)
XPlane: add support for Taxi Location 1300 record found in V1000
HDF4: ProcessModisSDSGeolocation(): set more correct values for PIXEL_/LINE_ OFFSET/STEP by comparing longitude and latitude subdatasets dimensions with main subdataset 
dimensions
gdal_merge.py: take into account alpha band to avoid writing zones of source images that are fully transparent (#3669, derived from patch by stefanklug)
GML/WFS: by default does not advertize NOT NULL fields since we treat empty strings as being null for historical reasons. By setting the open option EMPTY_AS_NULL=NO, empty 
strings will be reported as such and NOT NULL fields might be advertized (#5968)
Perl bindings :Stop using deprecated histogram functions in Perl.
GML: fix GML_ATTRIBUTES_TO_OGR_FIELDS=YES to work correctly with xlink:href too (#5970)
Add gcps2ogr.py sample script
Ili1: Fix multiple joining of geometry columns in QGIS
GIF: implement GetFileList() to report worldfile
Add default typemap for VSI_RETVAL for Python, CSharp and Java; Regenerate python bindings
GTiff: avoid generated corrupted  right-most and bottom-most tiles for 12-bit JPEG-compressed (partial fix that just disable tile filling, #5971)
ogr2ogr: add warning when -doo is ignored
ogr2ogr: fix crash with -clipdst when a reprojection fails before (#5973)
GPKG: enable Spatialite 4.3 'amphibious' mode to avoid explicit cast to Spatialite geometries
Shape: SHPReadOGRFeature() should free the passed psShape when not NULL and if the DBF record is deleted, so as to avoid later reads to faild (triggered by #5974, but not 
fixing it)
ogr2ogr: make -explodecollections work with multisurface or multicurve too
CSV: accept space as separator as input/output, and add MERGE_SEPARATOR=YES/NO open option
GML: add INVERT_AXIS_ORDER_IF_LAT_LONG, CONSIDER_EPSG_AS_URN, READ_MODE, EXPOSE_GML_ID, EXPOSE_FID, DOWNLOAD_SCHEMA and REGISTRY open options
WFS: add INVERT_AXIS_ORDER_IF_LAT_LONG, CONSIDER_EPSG_AS_URN open options
OSM: add CONFIG_FILE, USE_CUSTOM_INDEXING, COMPRESS_NODES, MAX_TMPFILE_SIZE and INTERLEAVED_READING open options
gdalinfo: add -json switch (patch by Faza Mahamood, partial implementation of RFC 44)



-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Tue May 26 00:43:51 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 26 May 2015 10:43:51 +0300
Subject: [gdal-dev] CSharp bindings question
Message-ID: <55642437.2040603@gmail.com>

Tamas,

I'm working on a cleanup of the bindings, trying to reduce the number of 
language specifics in the common interface files.

I can test Python, Java, and Perl bindings well in my Linux machine but 
can so far only generate and compile the CSharp wrappers. However, it 
seems maybe possible with Mono. I installed mcs but I'm now stuck with 
definitions with type

static OgrPINVOKE() {
}

appearing twice in OgrPINVOKE.cs and similar files. It seems that this 
is not because of my changes so far - they appear also on trunk version. 
The error message is

osr/OsrPINVOKE.cs(192,10): error CS0111: A member 
`OSGeo.OSR.OsrPINVOKE.OsrPINVOKE()' is already defined. Rename this 
member or use different parameter types

Do you have any idea what's going on and if it is even possible to 
compile the CSharp bindings with Mono?

Bindings generation and compilation of the wrapper code is ok, the error 
comes with command

mcs /debug:full /target:library /out:osr_csharp.dll osr/*.cs AssemblyInfo.cs

which is followed by

AssemblyInfo.cs(88,12): warning CS1699: Use compiler option `keyfile' or 
appropriate project settings instead of `AssemblyKeyFile' attribute

before the error (above).

Regards,

Ari


From szekerest at gmail.com  Tue May 26 01:13:49 2015
From: szekerest at gmail.com (Tamas Szekeres)
Date: Tue, 26 May 2015 10:13:49 +0200
Subject: [gdal-dev] CSharp bindings question
In-Reply-To: <55642437.2040603@gmail.com>
References: <55642437.2040603@gmail.com>
Message-ID: <CACALY+TSL-P1ZkO+iVrTMTb2VwdOydq02x62QhAUehcnqw2M7w@mail.gmail.com>

Hi Ari,

I haven't tried to compile that with mono for quite a long time. I'll give
it a try.

However we did not follow the latest changes in the SWIG implementation
with the bindings, so I'd try with an earlier version (ie. 1.3.39) to
generate the wrappers. May be we should consider including the generated
wrappers in gdal instead of let the users to use different versions with
different results.

The warning message should just be ignored at this stage.

Best regards,

Tamas



2015-05-26 9:43 GMT+02:00 Ari Jolma <ari.jolma at gmail.com>:

> Tamas,
>
> I'm working on a cleanup of the bindings, trying to reduce the number of
> language specifics in the common interface files.
>
> I can test Python, Java, and Perl bindings well in my Linux machine but
> can so far only generate and compile the CSharp wrappers. However, it seems
> maybe possible with Mono. I installed mcs but I'm now stuck with
> definitions with type
>
> static OgrPINVOKE() {
> }
>
> appearing twice in OgrPINVOKE.cs and similar files. It seems that this is
> not because of my changes so far - they appear also on trunk version. The
> error message is
>
> osr/OsrPINVOKE.cs(192,10): error CS0111: A member
> `OSGeo.OSR.OsrPINVOKE.OsrPINVOKE()' is already defined. Rename this member
> or use different parameter types
>
> Do you have any idea what's going on and if it is even possible to compile
> the CSharp bindings with Mono?
>
> Bindings generation and compilation of the wrapper code is ok, the error
> comes with command
>
> mcs /debug:full /target:library /out:osr_csharp.dll osr/*.cs
> AssemblyInfo.cs
>
> which is followed by
>
> AssemblyInfo.cs(88,12): warning CS1699: Use compiler option `keyfile' or
> appropriate project settings instead of `AssemblyKeyFile' attribute
>
> before the error (above).
>
> Regards,
>
> Ari
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150526/9e14ebd8/attachment.html>

From even.rouault at spatialys.com  Tue May 26 01:38:09 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 26 May 2015 10:38:09 +0200
Subject: [gdal-dev] CSharp bindings question
In-Reply-To: <CACALY+TSL-P1ZkO+iVrTMTb2VwdOydq02x62QhAUehcnqw2M7w@mail.gmail.com>
References: <55642437.2040603@gmail.com>
	<CACALY+TSL-P1ZkO+iVrTMTb2VwdOydq02x62QhAUehcnqw2M7w@mail.gmail.com>
Message-ID: <201505261038.10033.even.rouault@spatialys.com>

Le mardi 26 mai 2015 10:13:49, Tamas Szekeres a ?crit :
> Hi Ari,
> 
> I haven't tried to compile that with mono for quite a long time. I'll give
> it a try.
> 
> However we did not follow the latest changes in the SWIG implementation
> with the bindings, so I'd try with an earlier version (ie. 1.3.39) to
> generate the wrappers.

I can confirm that I can compile the CSharp bindings on Linux with SWIG 1.3.40 
(and run the tests), but I get the same error as Ari with SWIG 2.0.X

As far as I know, Java and Python bindings build and run equaly well with SWIG 
1.3.40 or 2.0.X (although there's a Unix makefile hack to have Python 3.2 
compat, conditionnaly applied with SWIG 1.3.40, that is no longer needed with 
SWIG 2.0.4 or later)

> May be we should consider including the generated
> wrappers in gdal instead of let the users to use different versions with
> different results.

It would be good if we could have a common SWIG version that works for all the 
bindings. So currently it seems to be 1.3.40 ?

Regarding putting the generated wrappers in SVN, that's already what we do for 
Python. We could also just include the generated wrappers in the tarballs.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From mauceri at actgate.com  Tue May 26 02:00:21 2015
From: mauceri at actgate.com (Calogero Mauceri)
Date: Tue, 26 May 2015 11:00:21 +0200
Subject: [gdal-dev] Problem saving/reading inf GCPs values in VRT
Message-ID: <55643625.8080501@actgate.com>

Hi all,

we are having problems saving/reading GCPs values in a VRT file when 
those values are inf or nan. This problem is happening on Window 
platform while it is working as expected in unix systems.

We are setting the GCP values in a VRT dataset using the library 
function GDALSetGCPs. The inf values get saved into the VRT XML as 
"*1.#INF00000000E+000*" string

<GCPList Projection="PROJCS[&quot;unnamed&quot;,
     GEOGCS[&quot;WGS 84&quot;,
         DATUM[&quot;WGS_1984&quot;,
             SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563],
             TOWGS84[0,0,0,0,0,0,0]],
         PRIMEM[&quot;Greenwich&quot;,0],
UNIT[&quot;degree&quot;,0.0174532925199433]],
     PROJECTION[&quot;Orthographic&quot;],
PARAMETER[&quot;latitude_of_origin&quot;,71.331088221],
PARAMETER[&quot;central_meridian&quot;,-156.63420306],
     PARAMETER[&quot;false_easting&quot;,0],
     PARAMETER[&quot;false_northing&quot;,0]]">
     <GCP Id="0" Pixel="0.0000" Line="0.0000" X="*1.#INF00000000E+000*" 
Y="*1.#INF00000000E+000*" />
     <GCP Id="1" Pixel="363.0000" Line="0.0000" X="-3.463981152302E+004" 
Y="3.246591123662E+004" />
     <GCP Id="2" Pixel="725.0000" Line="0.0000" X="-1.070555064325E+004" 
Y="1.097994383230E+004" />
     <GCP Id="3" Pixel="1088.0000" Line="0.0000" 
X="-5.461709489401E+003" Y="6.277974169290E+003" />
     <GCP Id="4" Pixel="1450.0000" Line="0.0000" 
X="-3.134437286904E+003" Y="4.191819043427E+003" />
   </GCPList>

when those values are read through the GDALGetGCPs library function, 
then the inf values are set to 1.0.
Is this a bug in GDAL or are we setting the inf GCP values in the wrong way?

Note that on unix everything works fine, the inf values are saved as 
"INF" strings in the VRT XML and they are properly converted when they 
are read back.

Thanks in advance for your help.
     Calogero

-- 
Calogero Mauceri
Software Engineer

Applied Coherent Technology Corporation (ACT)
www.actgate.com

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150526/b5dd0fff/attachment.html>

From ari.jolma at gmail.com  Tue May 26 02:09:21 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 26 May 2015 12:09:21 +0300
Subject: [gdal-dev] CSharp bindings question
In-Reply-To: <201505261038.10033.even.rouault@spatialys.com>
References: <55642437.2040603@gmail.com>
	<CACALY+TSL-P1ZkO+iVrTMTb2VwdOydq02x62QhAUehcnqw2M7w@mail.gmail.com>
	<201505261038.10033.even.rouault@spatialys.com>
Message-ID: <55643841.7060503@gmail.com>

26.05.2015, 11:38, Even Rouault kirjoitti:
> Le mardi 26 mai 2015 10:13:49, Tamas Szekeres a ?crit :
>> Hi Ari,
>>
>> I haven't tried to compile that with mono for quite a long time. I'll give
>> it a try.
>>
>> However we did not follow the latest changes in the SWIG implementation
>> with the bindings, so I'd try with an earlier version (ie. 1.3.39) to
>> generate the wrappers.
> I can confirm that I can compile the CSharp bindings on Linux with SWIG 1.3.40
> (and run the tests), but I get the same error as Ari with SWIG 2.0.X
>
> As far as I know, Java and Python bindings build and run equaly well with SWIG
> 1.3.40 or 2.0.X (although there's a Unix makefile hack to have Python 3.2
> compat, conditionnaly applied with SWIG 1.3.40, that is no longer needed with
> SWIG 2.0.4 or later)

Swig 1.3.39 seems questionable. Just look at the download amounts at 
sourceforge. 1.3.39 one download and 1.3.40 148 downloads per week.

However, 1.3.39 does *not* put the PVINVOKE() method twice into the 
PVINVOKE.cs file.

>
>> May be we should consider including the generated
>> wrappers in gdal instead of let the users to use different versions with
>> different results.
> It would be good if we could have a common SWIG version that works for all the
> bindings. So currently it seems to be 1.3.40 ?
>
> Regarding putting the generated wrappers in SVN, that's already what we do for
> Python. We could also just include the generated wrappers in the tarballs.

IMO "users" = people who use ready-made packages. Developers and 
packagers should be intelligent enough to use development tools. I don't 
like the idea of having generated files in source repositories. I'm also 
of the opinion that there should be a really good reason to use an old 
version of a common tool. And at least in my Linux (Mint, Maya - hmm, 
that seems already pretty old, I should upgrade) swig 2.0.11 is the 
current. But that's just me I guess.

Ari

>
> Even
>


From even.rouault at spatialys.com  Tue May 26 02:28:14 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 26 May 2015 11:28:14 +0200
Subject: [gdal-dev] Problem saving/reading inf GCPs values in VRT
In-Reply-To: <55643625.8080501@actgate.com>
References: <55643625.8080501@actgate.com>
Message-ID: <201505261128.14751.even.rouault@spatialys.com>

Le mardi 26 mai 2015 11:00:21, Calogero Mauceri a ?crit :
> Hi all,
> 
> we are having problems saving/reading GCPs values in a VRT file when
> those values are inf or nan. This problem is happening on Window
> platform while it is working as expected in unix systems.
> 
> We are setting the GCP values in a VRT dataset using the library
> function GDALSetGCPs. The inf values get saved into the VRT XML as
> "*1.#INF00000000E+000*" string
> 
> <GCPList Projection="PROJCS[&quot;unnamed&quot;,
>      GEOGCS[&quot;WGS 84&quot;,
>          DATUM[&quot;WGS_1984&quot;,
>              SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563],
>              TOWGS84[0,0,0,0,0,0,0]],
>          PRIMEM[&quot;Greenwich&quot;,0],
> UNIT[&quot;degree&quot;,0.0174532925199433]],
>      PROJECTION[&quot;Orthographic&quot;],
> PARAMETER[&quot;latitude_of_origin&quot;,71.331088221],
> PARAMETER[&quot;central_meridian&quot;,-156.63420306],
>      PARAMETER[&quot;false_easting&quot;,0],
>      PARAMETER[&quot;false_northing&quot;,0]]">
>      <GCP Id="0" Pixel="0.0000" Line="0.0000" X="*1.#INF00000000E+000*"
> Y="*1.#INF00000000E+000*" />
>      <GCP Id="1" Pixel="363.0000" Line="0.0000" X="-3.463981152302E+004"
> Y="3.246591123662E+004" />
>      <GCP Id="2" Pixel="725.0000" Line="0.0000" X="-1.070555064325E+004"
> Y="1.097994383230E+004" />
>      <GCP Id="3" Pixel="1088.0000" Line="0.0000"
> X="-5.461709489401E+003" Y="6.277974169290E+003" />
>      <GCP Id="4" Pixel="1450.0000" Line="0.0000"
> X="-3.134437286904E+003" Y="4.191819043427E+003" />
>    </GCPList>
> 
> when those values are read through the GDALGetGCPs library function,
> then the inf values are set to 1.0.
> Is this a bug in GDAL or are we setting the inf GCP values in the wrong
> way?
> 
> Note that on unix everything works fine, the inf values are saved as
> "INF" strings in the VRT XML and they are properly converted when they
> are read back.

Calogero,

Dealing with Inf or NaN serialized number on Windows require special cases. 
But I fail to see why you need to set GCPs at infinity or nan, and I'd bet the 
behaviour of the TPS or polynomial transforms will be pretty much undefined 
with such as value.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From mauceri at actgate.com  Tue May 26 02:40:22 2015
From: mauceri at actgate.com (Calogero Mauceri)
Date: Tue, 26 May 2015 11:40:22 +0200
Subject: [gdal-dev] Problem saving/reading inf GCPs values in VRT
In-Reply-To: <201505261128.14751.even.rouault@spatialys.com>
References: <55643625.8080501@actgate.com>
	<201505261128.14751.even.rouault@spatialys.com>
Message-ID: <55643F86.2080309@actgate.com>


Il 5/26/2015 11:28 AM, Even Rouault ha scritto:
> Le mardi 26 mai 2015 11:00:21, Calogero Mauceri a ?crit :
>> Hi all,
>>
>> we are having problems saving/reading GCPs values in a VRT file when
>> those values are inf or nan. This problem is happening on Window
>> platform while it is working as expected in unix systems.
>>
>> We are setting the GCP values in a VRT dataset using the library
>> function GDALSetGCPs. The inf values get saved into the VRT XML as
>> "*1.#INF00000000E+000*" string
>>
>> <GCPList Projection="PROJCS[&quot;unnamed&quot;,
>>       GEOGCS[&quot;WGS 84&quot;,
>>           DATUM[&quot;WGS_1984&quot;,
>>               SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563],
>>               TOWGS84[0,0,0,0,0,0,0]],
>>           PRIMEM[&quot;Greenwich&quot;,0],
>> UNIT[&quot;degree&quot;,0.0174532925199433]],
>>       PROJECTION[&quot;Orthographic&quot;],
>> PARAMETER[&quot;latitude_of_origin&quot;,71.331088221],
>> PARAMETER[&quot;central_meridian&quot;,-156.63420306],
>>       PARAMETER[&quot;false_easting&quot;,0],
>>       PARAMETER[&quot;false_northing&quot;,0]]">
>>       <GCP Id="0" Pixel="0.0000" Line="0.0000" X="*1.#INF00000000E+000*"
>> Y="*1.#INF00000000E+000*" />
>>       <GCP Id="1" Pixel="363.0000" Line="0.0000" X="-3.463981152302E+004"
>> Y="3.246591123662E+004" />
>>       <GCP Id="2" Pixel="725.0000" Line="0.0000" X="-1.070555064325E+004"
>> Y="1.097994383230E+004" />
>>       <GCP Id="3" Pixel="1088.0000" Line="0.0000"
>> X="-5.461709489401E+003" Y="6.277974169290E+003" />
>>       <GCP Id="4" Pixel="1450.0000" Line="0.0000"
>> X="-3.134437286904E+003" Y="4.191819043427E+003" />
>>     </GCPList>
>>
>> when those values are read through the GDALGetGCPs library function,
>> then the inf values are set to 1.0.
>> Is this a bug in GDAL or are we setting the inf GCP values in the wrong
>> way?
>>
>> Note that on unix everything works fine, the inf values are saved as
>> "INF" strings in the VRT XML and they are properly converted when they
>> are read back.
> Calogero,
>
> Dealing with Inf or NaN serialized number on Windows require special cases.
> But I fail to see why you need to set GCPs at infinity or nan, and I'd bet the
> behaviour of the TPS or polynomial transforms will be pretty much undefined
> with such as value.
>
> Even

I agree with you Even, Inf and NaN values should not be saved as GCPs, 
but the way how they are treated in GDAL is very misleading, as invalid 
values become valid after saving and then reading them.
If you think that should not be fixed it should be at least reported in 
the documentation.

Calogero

-- 
Calogero Mauceri
Software Engineer

Applied Coherent Technology Corporation (ACT)
www.actgate.com



From even.rouault at spatialys.com  Tue May 26 03:03:23 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 26 May 2015 12:03:23 +0200
Subject: [gdal-dev] Problem saving/reading inf GCPs values in VRT
In-Reply-To: <55643F86.2080309@actgate.com>
References: <55643625.8080501@actgate.com>
	<201505261128.14751.even.rouault@spatialys.com>
	<55643F86.2080309@actgate.com>
Message-ID: <201505261203.23564.even.rouault@spatialys.com>

Le mardi 26 mai 2015 11:40:22, Calogero Mauceri a ?crit :
> Il 5/26/2015 11:28 AM, Even Rouault ha scritto:
> > Le mardi 26 mai 2015 11:00:21, Calogero Mauceri a ?crit :
> >> Hi all,
> >> 
> >> we are having problems saving/reading GCPs values in a VRT file when
> >> those values are inf or nan. This problem is happening on Window
> >> platform while it is working as expected in unix systems.
> >> 
> >> We are setting the GCP values in a VRT dataset using the library
> >> function GDALSetGCPs. The inf values get saved into the VRT XML as
> >> "*1.#INF00000000E+000*" string
> >> 
> >> <GCPList Projection="PROJCS[&quot;unnamed&quot;,
> >> 
> >>       GEOGCS[&quot;WGS 84&quot;,
> >>       
> >>           DATUM[&quot;WGS_1984&quot;,
> >>           
> >>               SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563],
> >>               TOWGS84[0,0,0,0,0,0,0]],
> >>           
> >>           PRIMEM[&quot;Greenwich&quot;,0],
> >> 
> >> UNIT[&quot;degree&quot;,0.0174532925199433]],
> >> 
> >>       PROJECTION[&quot;Orthographic&quot;],
> >> 
> >> PARAMETER[&quot;latitude_of_origin&quot;,71.331088221],
> >> PARAMETER[&quot;central_meridian&quot;,-156.63420306],
> >> 
> >>       PARAMETER[&quot;false_easting&quot;,0],
> >>       PARAMETER[&quot;false_northing&quot;,0]]">
> >>       <GCP Id="0" Pixel="0.0000" Line="0.0000" X="*1.#INF00000000E+000*"
> >> 
> >> Y="*1.#INF00000000E+000*" />
> >> 
> >>       <GCP Id="1" Pixel="363.0000" Line="0.0000"
> >>       X="-3.463981152302E+004"
> >> 
> >> Y="3.246591123662E+004" />
> >> 
> >>       <GCP Id="2" Pixel="725.0000" Line="0.0000"
> >>       X="-1.070555064325E+004"
> >> 
> >> Y="1.097994383230E+004" />
> >> 
> >>       <GCP Id="3" Pixel="1088.0000" Line="0.0000"
> >> 
> >> X="-5.461709489401E+003" Y="6.277974169290E+003" />
> >> 
> >>       <GCP Id="4" Pixel="1450.0000" Line="0.0000"
> >> 
> >> X="-3.134437286904E+003" Y="4.191819043427E+003" />
> >> 
> >>     </GCPList>
> >> 
> >> when those values are read through the GDALGetGCPs library function,
> >> then the inf values are set to 1.0.
> >> Is this a bug in GDAL or are we setting the inf GCP values in the wrong
> >> way?
> >> 
> >> Note that on unix everything works fine, the inf values are saved as
> >> "INF" strings in the VRT XML and they are properly converted when they
> >> are read back.
> > 
> > Calogero,
> > 
> > Dealing with Inf or NaN serialized number on Windows require special
> > cases. But I fail to see why you need to set GCPs at infinity or nan,
> > and I'd bet the behaviour of the TPS or polynomial transforms will be
> > pretty much undefined with such as value.
> > 
> > Even
> 
> I agree with you Even, Inf and NaN values should not be saved as GCPs,
> but the way how they are treated in GDAL is very misleading, as invalid
> values become valid after saving and then reading them.
> If you think that should not be fixed it

Actually with changes done some time ago in trunk to use locale unaware 
functions to parse strings as double, it should have worked already, but only 
strict 1.#INF or -1.#INF were recognized. I've improved CPLStrodDelim() to 
also accept with other characters behind.

> should be at least reported in
> the documentation.
> 
> Calogero

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From cavallini at faunalia.it  Tue May 26 03:03:52 2015
From: cavallini at faunalia.it (Paolo Cavallini)
Date: Tue, 26 May 2015 12:03:52 +0200
Subject: [gdal-dev] Fast feature count not available?
Message-ID: <55644508.2020203@faunalia.it>

Hi all,
I'm trying to import from Oracle to PostGIS, with the command

ogr2ogr.exe -progress --config PG_USE_COPY YES -f PostgreSQL
PG:"host=*** port=5432 dbname=*** password=*** user=***" -lco DIM=2
OCI:georef/***@***:1523/**.**:GEOREF.GEO_NODES "GEOREF"."GEO_NODI_BT"
-nlt POINT -lco SCHEMA=georef -lco GEOMETRY_NAME=geom -lco FID=id -nln
geo_nodes -a_srs EPSG:4326 -spat -180.0 -90.0 180.0 90.0 -nlt
PROMOTE_TO_MULTI

which returns:

Progress turned off as fast feature count is not available.

The table is created, but empty.
I'd be grateful of any hint.

All the best.
-- 
Paolo Cavallini - www.faunalia.eu
QGIS & PostGIS courses: http://www.faunalia.eu/training.html

From even.rouault at spatialys.com  Tue May 26 03:13:47 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 26 May 2015 12:13:47 +0200
Subject: [gdal-dev] Fast feature count not available?
In-Reply-To: <55644508.2020203@faunalia.it>
References: <55644508.2020203@faunalia.it>
Message-ID: <201505261213.47246.even.rouault@spatialys.com>

Le mardi 26 mai 2015 12:03:52, Paolo Cavallini a ?crit :
> Hi all,
> I'm trying to import from Oracle to PostGIS, with the command
> 
> ogr2ogr.exe -progress --config PG_USE_COPY YES -f PostgreSQL
> PG:"host=*** port=5432 dbname=*** password=*** user=***" -lco DIM=2
> OCI:georef/***@***:1523/**.**:GEOREF.GEO_NODES "GEOREF"."GEO_NODI_BT"
> -nlt POINT -lco SCHEMA=georef -lco GEOMETRY_NAME=geom -lco FID=id -nln
> geo_nodes -a_srs EPSG:4326 -spat -180.0 -90.0 180.0 90.0 -nlt
> PROMOTE_TO_MULTI
> 
> which returns:
> 
> Progress turned off as fast feature count is not available.
> 
> The table is created, but empty.
> I'd be grateful of any hint.

Paolo,

The OCI driver doesn't advertize the OLCFastFeatureCount capability (although 
it has a specialized implementation of the FeatureCount() method, but perhaps 
COUNT(*) wasn't thought as fast enough to deserver exposing 
OLCFastFeatureCount). Anyway, that's just to make -progress work, which is 
just UI niceness, and not really needed, so the warning is not critical at all 
and has nothing to do with the fat you get an empty result set.

Try running your request with just ogrinfo until it returns non empty result. 
The "-spat -180.0 -90.0 180.0 90.0" part looks a bit suspicious to me. Why do 
you need to set this filter ? I also want to warn you that the SRS of the 
source layer should be a geographic one for this filter to work. And if it is 
indeed a geographic one, then it should select pretty much all the table 
content, so you could just remove it.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From mauceri at actgate.com  Tue May 26 03:18:39 2015
From: mauceri at actgate.com (Calogero Mauceri)
Date: Tue, 26 May 2015 12:18:39 +0200
Subject: [gdal-dev] Problem saving/reading inf GCPs values in VRT
In-Reply-To: <201505261203.23564.even.rouault@spatialys.com>
References: <55643625.8080501@actgate.com>
	<201505261128.14751.even.rouault@spatialys.com>
	<55643F86.2080309@actgate.com>
	<201505261203.23564.even.rouault@spatialys.com>
Message-ID: <5564487F.6070003@actgate.com>

Il 5/26/2015 12:03 PM, Even Rouault ha scritto:
> Le mardi 26 mai 2015 11:40:22, Calogero Mauceri a ?crit :
>> Il 5/26/2015 11:28 AM, Even Rouault ha scritto:
>>> Le mardi 26 mai 2015 11:00:21, Calogero Mauceri a ?crit :
>>>> Hi all,
>>>>
>>>> we are having problems saving/reading GCPs values in a VRT file when
>>>> those values are inf or nan. This problem is happening on Window
>>>> platform while it is working as expected in unix systems.
>>>>
>>>> We are setting the GCP values in a VRT dataset using the library
>>>> function GDALSetGCPs. The inf values get saved into the VRT XML as
>>>> "*1.#INF00000000E+000*" string
>>>>
>>>> <GCPList Projection="PROJCS[&quot;unnamed&quot;,
>>>>
>>>>        GEOGCS[&quot;WGS 84&quot;,
>>>>        
>>>>            DATUM[&quot;WGS_1984&quot;,
>>>>            
>>>>                SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563],
>>>>                TOWGS84[0,0,0,0,0,0,0]],
>>>>            
>>>>            PRIMEM[&quot;Greenwich&quot;,0],
>>>>
>>>> UNIT[&quot;degree&quot;,0.0174532925199433]],
>>>>
>>>>        PROJECTION[&quot;Orthographic&quot;],
>>>>
>>>> PARAMETER[&quot;latitude_of_origin&quot;,71.331088221],
>>>> PARAMETER[&quot;central_meridian&quot;,-156.63420306],
>>>>
>>>>        PARAMETER[&quot;false_easting&quot;,0],
>>>>        PARAMETER[&quot;false_northing&quot;,0]]">
>>>>        <GCP Id="0" Pixel="0.0000" Line="0.0000" X="*1.#INF00000000E+000*"
>>>>
>>>> Y="*1.#INF00000000E+000*" />
>>>>
>>>>        <GCP Id="1" Pixel="363.0000" Line="0.0000"
>>>>        X="-3.463981152302E+004"
>>>>
>>>> Y="3.246591123662E+004" />
>>>>
>>>>        <GCP Id="2" Pixel="725.0000" Line="0.0000"
>>>>        X="-1.070555064325E+004"
>>>>
>>>> Y="1.097994383230E+004" />
>>>>
>>>>        <GCP Id="3" Pixel="1088.0000" Line="0.0000"
>>>>
>>>> X="-5.461709489401E+003" Y="6.277974169290E+003" />
>>>>
>>>>        <GCP Id="4" Pixel="1450.0000" Line="0.0000"
>>>>
>>>> X="-3.134437286904E+003" Y="4.191819043427E+003" />
>>>>
>>>>      </GCPList>
>>>>
>>>> when those values are read through the GDALGetGCPs library function,
>>>> then the inf values are set to 1.0.
>>>> Is this a bug in GDAL or are we setting the inf GCP values in the wrong
>>>> way?
>>>>
>>>> Note that on unix everything works fine, the inf values are saved as
>>>> "INF" strings in the VRT XML and they are properly converted when they
>>>> are read back.
>>> Calogero,
>>>
>>> Dealing with Inf or NaN serialized number on Windows require special
>>> cases. But I fail to see why you need to set GCPs at infinity or nan,
>>> and I'd bet the behaviour of the TPS or polynomial transforms will be
>>> pretty much undefined with such as value.
>>>
>>> Even
>> I agree with you Even, Inf and NaN values should not be saved as GCPs,
>> but the way how they are treated in GDAL is very misleading, as invalid
>> values become valid after saving and then reading them.
>> If you think that should not be fixed it
> Actually with changes done some time ago in trunk to use locale unaware
> functions to parse strings as double, it should have worked already, but only
> strict 1.#INF or -1.#INF were recognized. I've improved CPLStrodDelim() to
> also accept with other characters behind.
>
>> should be at least reported in
>> the documentation.
>>
>> Calogero

Great Even!
Will the changes be in next GDAL release?

Calogero

-- 
Calogero Mauceri
Software Engineer

Applied Coherent Technology Corporation (ACT)
www.actgate.com



From even.rouault at spatialys.com  Tue May 26 03:20:39 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 26 May 2015 12:20:39 +0200
Subject: [gdal-dev] Problem saving/reading inf GCPs values in VRT
In-Reply-To: <5564487F.6070003@actgate.com>
References: <55643625.8080501@actgate.com>
	<201505261203.23564.even.rouault@spatialys.com>
	<5564487F.6070003@actgate.com>
Message-ID: <201505261220.39510.even.rouault@spatialys.com>

> Great Even!
> Will the changes be in next GDAL release? 

Yes 2.0
> 
> Calogero

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From szekerest at gmail.com  Tue May 26 03:53:31 2015
From: szekerest at gmail.com (Tamas Szekeres)
Date: Tue, 26 May 2015 12:53:31 +0200
Subject: [gdal-dev] CSharp bindings question
In-Reply-To: <55643841.7060503@gmail.com>
References: <55642437.2040603@gmail.com>
	<CACALY+TSL-P1ZkO+iVrTMTb2VwdOydq02x62QhAUehcnqw2M7w@mail.gmail.com>
	<201505261038.10033.even.rouault@spatialys.com>
	<55643841.7060503@gmail.com>
Message-ID: <CACALY+RhWrcSQTtUxkmVZ9SKkdc5-kTvV59VzQpA=yKnZFTviw@mail.gmail.com>

Is that a requirement that the bindings should work well with all SWIG
versions or that the generated wrappers should work just fine?

Formerly I have been thinking that we should support all versions, but it
took large amount of extra efforts to work around all incompatible changes
what SWIG introduces all the time even with the minor releases. Regarding
to SWIG C# the earlier versions produced definitely wrong code and I had
implement quite some generic stuff in the bindings (for example to work
around the early garbage collection issues). I see some enhancements in the
recent versions in this regard, but I'm not sure if I can completely remove
these additions to get a stable and consistent build.

Tamas



2015-05-26 11:09 GMT+02:00 Ari Jolma <ari.jolma at gmail.com>:

> 26.05.2015, 11:38, Even Rouault kirjoitti:
>
>> Le mardi 26 mai 2015 10:13:49, Tamas Szekeres a ?crit :
>>
>>> Hi Ari,
>>>
>>> I haven't tried to compile that with mono for quite a long time. I'll
>>> give
>>> it a try.
>>>
>>> However we did not follow the latest changes in the SWIG implementation
>>> with the bindings, so I'd try with an earlier version (ie. 1.3.39) to
>>> generate the wrappers.
>>>
>> I can confirm that I can compile the CSharp bindings on Linux with SWIG
>> 1.3.40
>> (and run the tests), but I get the same error as Ari with SWIG 2.0.X
>>
>> As far as I know, Java and Python bindings build and run equaly well with
>> SWIG
>> 1.3.40 or 2.0.X (although there's a Unix makefile hack to have Python 3.2
>> compat, conditionnaly applied with SWIG 1.3.40, that is no longer needed
>> with
>> SWIG 2.0.4 or later)
>>
>
> Swig 1.3.39 seems questionable. Just look at the download amounts at
> sourceforge. 1.3.39 one download and 1.3.40 148 downloads per week.
>
> However, 1.3.39 does *not* put the PVINVOKE() method twice into the
> PVINVOKE.cs file.
>
>
>>  May be we should consider including the generated
>>> wrappers in gdal instead of let the users to use different versions with
>>> different results.
>>>
>> It would be good if we could have a common SWIG version that works for
>> all the
>> bindings. So currently it seems to be 1.3.40 ?
>>
>> Regarding putting the generated wrappers in SVN, that's already what we
>> do for
>> Python. We could also just include the generated wrappers in the tarballs.
>>
>
> IMO "users" = people who use ready-made packages. Developers and packagers
> should be intelligent enough to use development tools. I don't like the
> idea of having generated files in source repositories. I'm also of the
> opinion that there should be a really good reason to use an old version of
> a common tool. And at least in my Linux (Mint, Maya - hmm, that seems
> already pretty old, I should upgrade) swig 2.0.11 is the current. But
> that's just me I guess.
>
> Ari
>
>
>> Even
>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150526/a0abfe95/attachment.html>

From ari.jolma at gmail.com  Tue May 26 04:04:29 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 26 May 2015 14:04:29 +0300
Subject: [gdal-dev] CSharp bindings question
In-Reply-To: <CACALY+RhWrcSQTtUxkmVZ9SKkdc5-kTvV59VzQpA=yKnZFTviw@mail.gmail.com>
References: <55642437.2040603@gmail.com>	<CACALY+TSL-P1ZkO+iVrTMTb2VwdOydq02x62QhAUehcnqw2M7w@mail.gmail.com>	<201505261038.10033.even.rouault@spatialys.com>	<55643841.7060503@gmail.com>
	<CACALY+RhWrcSQTtUxkmVZ9SKkdc5-kTvV59VzQpA=yKnZFTviw@mail.gmail.com>
Message-ID: <5564533D.80000@gmail.com>


On 26.05.2015 13:53, Tamas Szekeres wrote:
> Is that a requirement that the bindings should work well with all SWIG 
> versions or that the generated wrappers should work just fine?

I don't know about formal policy, There's nothing in

http://trac.osgeo.org/gdal/wiki/rfc8_devguide nor
http://trac.osgeo.org/gdal/wiki/HowToContribute

IMO that's quite much up to the developer(s) of the bindings in question.

Maybe we need a few rules in two above files. I would like to have some 
rules, which would help keeping the common interface files free of #if's.

FWIW, I haven't have much problems with different Swig versions with 
Perl bindings.

Ari

>
> Formerly I have been thinking that we should support all versions, but 
> it took large amount of extra efforts to work around all incompatible 
> changes what SWIG introduces all the time even with the minor 
> releases. Regarding to SWIG C# the earlier versions produced 
> definitely wrong code and I had implement quite some generic stuff in 
> the bindings (for example to work around the early garbage collection 
> issues). I see some enhancements in the recent versions in this 
> regard, but I'm not sure if I can completely remove these additions to 
> get a stable and consistent build.
>
> Tamas
>
>
>
> 2015-05-26 11:09 GMT+02:00 Ari Jolma <ari.jolma at gmail.com 
> <mailto:ari.jolma at gmail.com>>:
>
>     26.05.2015, 11:38, Even Rouault kirjoitti:
>
>         Le mardi 26 mai 2015 10:13:49, Tamas Szekeres a ?crit :
>
>             Hi Ari,
>
>             I haven't tried to compile that with mono for quite a long
>             time. I'll give
>             it a try.
>
>             However we did not follow the latest changes in the SWIG
>             implementation
>             with the bindings, so I'd try with an earlier version (ie.
>             1.3.39) to
>             generate the wrappers.
>
>         I can confirm that I can compile the CSharp bindings on Linux
>         with SWIG 1.3.40
>         (and run the tests), but I get the same error as Ari with SWIG
>         2.0.X
>
>         As far as I know, Java and Python bindings build and run
>         equaly well with SWIG
>         1.3.40 or 2.0.X (although there's a Unix makefile hack to have
>         Python 3.2
>         compat, conditionnaly applied with SWIG 1.3.40, that is no
>         longer needed with
>         SWIG 2.0.4 or later)
>
>
>     Swig 1.3.39 seems questionable. Just look at the download amounts
>     at sourceforge. 1.3.39 one download and 1.3.40 148 downloads per week.
>
>     However, 1.3.39 does *not* put the PVINVOKE() method twice into
>     the PVINVOKE.cs file.
>
>
>             May be we should consider including the generated
>             wrappers in gdal instead of let the users to use different
>             versions with
>             different results.
>
>         It would be good if we could have a common SWIG version that
>         works for all the
>         bindings. So currently it seems to be 1.3.40 ?
>
>         Regarding putting the generated wrappers in SVN, that's
>         already what we do for
>         Python. We could also just include the generated wrappers in
>         the tarballs.
>
>
>     IMO "users" = people who use ready-made packages. Developers and
>     packagers should be intelligent enough to use development tools. I
>     don't like the idea of having generated files in source
>     repositories. I'm also of the opinion that there should be a
>     really good reason to use an old version of a common tool. And at
>     least in my Linux (Mint, Maya - hmm, that seems already pretty
>     old, I should upgrade) swig 2.0.11 is the current. But that's just
>     me I guess.
>
>     Ari
>
>
>         Even
>
>
>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150526/6656b759/attachment-0001.html>

From cavallini at faunalia.it  Tue May 26 05:21:48 2015
From: cavallini at faunalia.it (Paolo Cavallini)
Date: Tue, 26 May 2015 14:21:48 +0200
Subject: [gdal-dev] Fast feature count not available?
In-Reply-To: <201505261213.47246.even.rouault@spatialys.com>
References: <55644508.2020203@faunalia.it>
	<201505261213.47246.even.rouault@spatialys.com>
Message-ID: <5564655C.4020502@faunalia.it>

Il 26/05/2015 12:13, Even Rouault ha scritto:

> The "-spat -180.0 -90.0 180.0 90.0" part looks a bit suspicious to me. Why do 

Quite clear, thanks Even. The command line was built by a QGIS plugin;
your explanation can help to solve also a bug on it.
All the best.

-- 
Paolo Cavallini - www.faunalia.eu
QGIS & PostGIS courses: http://www.faunalia.eu/training.html

From kassies at gmail.com  Wed May 27 02:17:38 2015
From: kassies at gmail.com (Rutger)
Date: Wed, 27 May 2015 02:17:38 -0700 (PDT)
Subject: [gdal-dev] gdalwarp problems with MODIS L1B
In-Reply-To: <CAGm=Sva6+8sX_TaFHHErR_edYkX2Jcs46ZvEhFm8r_zQq8sq+Q@mail.gmail.com>
References: <CAAcGz9_ejTVp+tik+nATfScvpiV3Hkdm_91=Q9xSKWcChxF5Lg@mail.gmail.com>
	<201505201134.02313.even.rouault@spatialys.com>
	<CAGm=Sva6+8sX_TaFHHErR_edYkX2Jcs46ZvEhFm8r_zQq8sq+Q@mail.gmail.com>
Message-ID: <1432718258223-5207732.post@n6.nabble.com>

Hi Max, 

Maybe this will help you:
http://osgeo-org.1560.x6.nabble.com/gdal-dev-reproject-python-numpy-binary-swath-lat-lon-td4978609.html#a4981318

I made two VRT's containing the latitude and longitude band. Then referenced
those in a VRT containing the actual data band, by using the "metadata" key
in VRT. Note that the step of 1 and offset of 0 correspond to a situation
where the shape of the lat/lon bands is identical to the data.


Regards,
Rutger 


Max Andela wrote
> Dear Even Rouault:
> May I know how to input the latitude and longitude layers while warping
> with gdalwarp?
> 
> Thanks.
> max
> 
> On Wed, May 20, 2015 at 6:34 PM, Even Rouault &lt;

> even.rouault@

> &gt;
> wrote:
> 
>> Mike,
>>
>> >
>> > By my reading of https://trac.osgeo.org/gdal/wiki/rfc4_geolocate that
>> means
>> > the Geolocation tag from gdalinfo should have a PIXEL_STEP and
>> LINE_STEP
>> of
>> > 5, and if I do this I get a much better result but it's still not
>> right.
>>
>> I've just committed a patch in trunk that should put more sensible values
>> for
>> those values :
>> r29212 "HDF4: ProcessModisSDSGeolocation(): set more correct values for
>> PIXEL_/LINE_ OFFSET/STEP by comparing longitude and latitude subdatasets
>> dimensions with main subdataset dimensions"
>>
>>
>> > I've put a jpeg image of the result, with the coastline mapped and not
>> > lining up, here:
>> >
>> > http://staff.acecrc.org.au/~mdsumner/mod1.jpg
>>
>> Either the data itself is wrong, either there's an issue with the
>> geolocation
>> transformer... Later hypothesis is the more likely, although I've managed
>> to
>> make it work with L1B datasets where the tps or geoloc transformers gave
>> roughly the same results.
>>
>> I've gotten smoother results by resizing the longitude&latitude
>> subdatasets to
>> the main subdataset dimension
>>
>> gdal_translate
>> HDF4_SDS:UNKNOWN:"MOD021KM.A2012062.0455.006.2014220083128.hdf":1
>> longitude.tif -outsize 1354 2030 -r cubic
>>
>> gdal_translate
>> HDF4_SDS:UNKNOWN:"MOD021KM.A2012062.0455.006.2014220083128.hdf":0
>> latitude.tif
>> -outsize 1354 2030 -r cubic
>>
>> and then referencing them in the VRT produced with
>>
>> gdal_translate -of VRT
>> HDF4_SDS:UNKNOWN:"MOD021KM.A2012062.0455.006.2014220083128.hdf":2
>> data.vrt
>>
>> (and then by correcting the offset and step values to 0 and 1
>> respectively)
>>
>> You might want to do the warp with -wo SAMPLE_GRID=YES -wo
>> SAMPLE_STEPS=100
>> too
>>
>> But overall the reprojected image stays roughly at the same location.
>> This
>> helps only removing a few artifacts on the edges.
>>
>> Even
>>
>> --
>> Spatialys - Geospatial professional services
>> http://www.spatialys.com
>> _______________________________________________
>> gdal-dev mailing list
>> 

> gdal-dev at .osgeo

>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> http://lists.osgeo.org/mailman/listinfo/gdal-dev





--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-gdalwarp-problems-with-MODIS-L1B-tp5206583p5207732.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From koen.marien at histogenex.com  Thu May 28 23:55:58 2015
From: koen.marien at histogenex.com (Koen2704)
Date: Thu, 28 May 2015 23:55:58 -0700 (PDT)
Subject: [gdal-dev] gdal_translate and gdal_gdaladdo to create tiled
 pyrimidal tiffs: grey?
In-Reply-To: <1432828815399-5208048.post@n6.nabble.com>
References: <1432828815399-5208048.post@n6.nabble.com>
Message-ID: <1432882558358-5208112.post@n6.nabble.com>

This post should now be mailed to the list as well. Sorry for the
inconvenience.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-translate-and-gdal-gdaladdo-to-create-tiled-pyrimidal-tiffs-grey-tp5208048p5208112.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From ari.jolma at gmail.com  Fri May 29 00:11:18 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Fri, 29 May 2015 10:11:18 +0300
Subject: [gdal-dev] CSharp bindings question
In-Reply-To: <CACALY+RhWrcSQTtUxkmVZ9SKkdc5-kTvV59VzQpA=yKnZFTviw@mail.gmail.com>
References: <55642437.2040603@gmail.com>	<CACALY+TSL-P1ZkO+iVrTMTb2VwdOydq02x62QhAUehcnqw2M7w@mail.gmail.com>	<201505261038.10033.even.rouault@spatialys.com>	<55643841.7060503@gmail.com>
	<CACALY+RhWrcSQTtUxkmVZ9SKkdc5-kTvV59VzQpA=yKnZFTviw@mail.gmail.com>
Message-ID: <55681116.9050800@gmail.com>

In my fork I've now added mono-mcs into the travis test machine and 
"make test" to CSharp. The build & tests all work.

https://travis-ci.org/OSGeo/gdal/builds/64450000

However, one fix I did for the CSharp bindings is most probably wrong 
(convert return value of handle.AddrOfPinnedObject() to char *)

https://github.com/ajolma/gdal/commit/6509ef06d6f89d99c446300e4f4a63b65613911e

Tamas, do you have an idea for this?

There are a lot of #if ... #endif's in for example ogr.i to limit 
%feature("kwargs"), this is due to a swig bug, which is fixed in 3.03 so 
we need to leave them in for now.

https://github.com/swig/swig/issues/242

There's a lot still to do to cleanup the common interface files but how 
do you feel, is there a chance that this is accepted into the trunk (and 
2.1)? I'd also love to have a policy for developing the bindings and 
working test codes for all maintained languages. A rule could be that 
the use of #if ... #endif in common files needs a good justification and 
commits, which do not cause test codes to fail are ok per se.

Best,

Ari

On 26.05.2015 13:53, Tamas Szekeres wrote:
> Is that a requirement that the bindings should work well with all SWIG 
> versions or that the generated wrappers should work just fine?
>
> Formerly I have been thinking that we should support all versions, but 
> it took large amount of extra efforts to work around all incompatible 
> changes what SWIG introduces all the time even with the minor 
> releases. Regarding to SWIG C# the earlier versions produced 
> definitely wrong code and I had implement quite some generic stuff in 
> the bindings (for example to work around the early garbage collection 
> issues). I see some enhancements in the recent versions in this 
> regard, but I'm not sure if I can completely remove these additions to 
> get a stable and consistent build.
>
> Tamas
>
>
>
> 2015-05-26 11:09 GMT+02:00 Ari Jolma <ari.jolma at gmail.com 
> <mailto:ari.jolma at gmail.com>>:
>
>     26.05.2015, 11:38, Even Rouault kirjoitti:
>
>         Le mardi 26 mai 2015 10:13:49, Tamas Szekeres a ?crit :
>
>             Hi Ari,
>
>             I haven't tried to compile that with mono for quite a long
>             time. I'll give
>             it a try.
>
>             However we did not follow the latest changes in the SWIG
>             implementation
>             with the bindings, so I'd try with an earlier version (ie.
>             1.3.39) to
>             generate the wrappers.
>
>         I can confirm that I can compile the CSharp bindings on Linux
>         with SWIG 1.3.40
>         (and run the tests), but I get the same error as Ari with SWIG
>         2.0.X
>
>         As far as I know, Java and Python bindings build and run
>         equaly well with SWIG
>         1.3.40 or 2.0.X (although there's a Unix makefile hack to have
>         Python 3.2
>         compat, conditionnaly applied with SWIG 1.3.40, that is no
>         longer needed with
>         SWIG 2.0.4 or later)
>
>
>     Swig 1.3.39 seems questionable. Just look at the download amounts
>     at sourceforge. 1.3.39 one download and 1.3.40 148 downloads per week.
>
>     However, 1.3.39 does *not* put the PVINVOKE() method twice into
>     the PVINVOKE.cs file.
>
>
>             May be we should consider including the generated
>             wrappers in gdal instead of let the users to use different
>             versions with
>             different results.
>
>         It would be good if we could have a common SWIG version that
>         works for all the
>         bindings. So currently it seems to be 1.3.40 ?
>
>         Regarding putting the generated wrappers in SVN, that's
>         already what we do for
>         Python. We could also just include the generated wrappers in
>         the tarballs.
>
>
>     IMO "users" = people who use ready-made packages. Developers and
>     packagers should be intelligent enough to use development tools. I
>     don't like the idea of having generated files in source
>     repositories. I'm also of the opinion that there should be a
>     really good reason to use an old version of a common tool. And at
>     least in my Linux (Mint, Maya - hmm, that seems already pretty
>     old, I should upgrade) swig 2.0.11 is the current. But that's just
>     me I guess.
>
>     Ari
>
>
>         Even
>
>
>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150529/81bb7704/attachment.html>

From even.rouault at spatialys.com  Fri May 29 01:52:51 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 29 May 2015 10:52:51 +0200
Subject: [gdal-dev] CSharp bindings question
In-Reply-To: <55681116.9050800@gmail.com>
References: <55642437.2040603@gmail.com>
	<CACALY+RhWrcSQTtUxkmVZ9SKkdc5-kTvV59VzQpA=yKnZFTviw@mail.gmail.com>
	<55681116.9050800@gmail.com>
Message-ID: <201505291052.51428.even.rouault@spatialys.com>

Hi Ari,

> In my fork I've now added mono-mcs into the travis test machine and
> "make test" to CSharp. The build & tests all work.
> 
> https://travis-ci.org/OSGeo/gdal/builds/64450000
> 
> However, one fix I did for the CSharp bindings is most probably wrong
> (convert return value of handle.AddrOfPinnedObject() to char *)
> 
> https://github.com/ajolma/gdal/commit/6509ef06d6f89d99c446300e4f4a63b656139
> 11e
> 
> Tamas, do you have an idea for this?
> 
> There are a lot of #if ... #endif's in for example ogr.i to limit
> %feature("kwargs"), this is due to a swig bug, which is fixed in 3.03 so
> we need to leave them in for now.
> 
> https://github.com/swig/swig/issues/242

Good to know.

I did a try with your branch and looks generally good to me as far as Python 
and Java are concerned. Thanks for your efforts on this.

I found that the Python bindings no longer compile with SWIG 1.3.40, but 
that's not really an issue if can now move to later SWIG versions (and Python 
3 support in SWIG 1.3.X needed an hack, so that would be great if we don't 
need it anymore). I tried with SWIG 2.0.10 and works good (tested with Python 
3.1 since Travis already tests Python 2)

I tried the Java bindings and looked at the generated code. I notice that 3 
SWIGTYPE_p_**** Java classes are generated due to missing typemaps :
- SWIGTYPE_p_CPLErrorHandler: only used by a gdal.CPLPushErrorHandler() method 
that wasn't exposed before. We'd likely need to hide it. It would require 
otherwise defining the appropriate typemap for the callback of 
PushErrorHandler() but callback typemaps are generally involved.
- SWIGTYPE_p_long_long: only used by Feature.SetFieldInteger64List() that 
wasn't exposed before. I guess I should be able to figure out the needed 
typemap
- SWIGTYPE_p_unsigned_char : only used as the return type of 
gdal.HexToBinary(). This used to return byte[] before.

Those are minor issues that I could fix once it is merged.

> 
> There's a lot still to do to cleanup the common interface files but how
> do you feel, is there a chance that this is accepted into the trunk (and
> 2.1)?

trunk as today is 2.0, so I think it would be more prudent if we wait for 2.0 
to have been branched off from trunk before committing this. If we commit that 
early in 2.1 dev cycle, we should have enough time to discover and address 
potential issues.

> I'd also love to have a policy for developing the bindings and
> working test codes for all maintained languages. A rule could be that
> the use of #if ... #endif in common files needs a good justification

I think one of the main pattern is that I want to map a C function to SWIG 
(for the need of the language of my interest) and realize that it needs a new 
typemap. So I add it for the language, and protect it by #if #endif to avoid 
breaking compilation for other languages (definitly justified), or expose new 
methods with the default and non-working SWIGTYPE_p_XXXXX types generated by 
SWIG. In this later case, we could question if #if #endif is justified: 
exposing non working methods isn't really great, but that shouldn't break 
users' workflow, since they won't be able to use them in practice, so they can 
be later fixed without really creating compatibility problems.

As it might be difficult in practice to coordinate with all maintainers at the 
exact time were things are needed, perhaps we need some wiki page to document 
which new methods have been added and which languages are impacted, so that 
the maintainer can look at it when he has time and add the needed typemaps.

> and
> commits, which do not cause test codes to fail are ok per se.

Seems reasonable to me.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From szekerest at gmail.com  Fri May 29 05:22:20 2015
From: szekerest at gmail.com (Tamas Szekeres)
Date: Fri, 29 May 2015 14:22:20 +0200
Subject: [gdal-dev] CSharp bindings question
In-Reply-To: <55681116.9050800@gmail.com>
References: <55642437.2040603@gmail.com>
	<CACALY+TSL-P1ZkO+iVrTMTb2VwdOydq02x62QhAUehcnqw2M7w@mail.gmail.com>
	<201505261038.10033.even.rouault@spatialys.com>
	<55643841.7060503@gmail.com>
	<CACALY+RhWrcSQTtUxkmVZ9SKkdc5-kTvV59VzQpA=yKnZFTviw@mail.gmail.com>
	<55681116.9050800@gmail.com>
Message-ID: <CACALY+Tw4FocB0YxKzuum0Am=8UoZpqbcv2OrLe0B8BZtP5=Ng@mail.gmail.com>

Hi Ari,

Which SWIG version have you been testing with?

Converting IntPtr to string doesn't seem to be a good solution. We should
do something like what we do for ReadRaster which also use
AddrOfPinnedObject().
I'm trying to reproduce this.

Best regards,

Tamas


2015-05-29 9:11 GMT+02:00 Ari Jolma <ari.jolma at gmail.com>:

>  In my fork I've now added mono-mcs into the travis test machine and "make
> test" to CSharp. The build & tests all work.
>
> https://travis-ci.org/OSGeo/gdal/builds/64450000
>
> However, one fix I did for the CSharp bindings is most probably wrong
> (convert return value of handle.AddrOfPinnedObject() to char *)
>
>
> https://github.com/ajolma/gdal/commit/6509ef06d6f89d99c446300e4f4a63b65613911e
>
> Tamas, do you have an idea for this?
>
> There are a lot of #if ... #endif's in for example ogr.i to limit
> %feature("kwargs"), this is due to a swig bug, which is fixed in 3.03 so we
> need to leave them in for now.
>
> https://github.com/swig/swig/issues/242
>
> There's a lot still to do to cleanup the common interface files but how do
> you feel, is there a chance that this is accepted into the trunk (and 2.1)?
> I'd also love to have a policy for developing the bindings and working test
> codes for all maintained languages. A rule could be that the use of #if ...
> #endif in common files needs a good justification and commits, which do not
> cause test codes to fail are ok per se.
>
> Best,
>
> Ari
>
> On 26.05.2015 13:53, Tamas Szekeres wrote:
>
> Is that a requirement that the bindings should work well with all SWIG
> versions or that the generated wrappers should work just fine?
>
>  Formerly I have been thinking that we should support all versions, but
> it took large amount of extra efforts to work around all incompatible
> changes what SWIG introduces all the time even with the minor releases.
> Regarding to SWIG C# the earlier versions produced definitely wrong code
> and I had implement quite some generic stuff in the bindings (for example
> to work around the early garbage collection issues). I see some
> enhancements in the recent versions in this regard, but I'm not sure if I
> can completely remove these additions to get a stable and consistent build.
>
>  Tamas
>
>
>
> 2015-05-26 11:09 GMT+02:00 Ari Jolma <ari.jolma at gmail.com>:
>
>> 26.05.2015, 11:38, Even Rouault kirjoitti:
>>
>>> Le mardi 26 mai 2015 10:13:49, Tamas Szekeres a ?crit :
>>>
>>>> Hi Ari,
>>>>
>>>> I haven't tried to compile that with mono for quite a long time. I'll
>>>> give
>>>> it a try.
>>>>
>>>> However we did not follow the latest changes in the SWIG implementation
>>>> with the bindings, so I'd try with an earlier version (ie. 1.3.39) to
>>>> generate the wrappers.
>>>>
>>> I can confirm that I can compile the CSharp bindings on Linux with SWIG
>>> 1.3.40
>>> (and run the tests), but I get the same error as Ari with SWIG 2.0.X
>>>
>>> As far as I know, Java and Python bindings build and run equaly well
>>> with SWIG
>>> 1.3.40 or 2.0.X (although there's a Unix makefile hack to have Python 3.2
>>> compat, conditionnaly applied with SWIG 1.3.40, that is no longer needed
>>> with
>>> SWIG 2.0.4 or later)
>>>
>>
>>  Swig 1.3.39 seems questionable. Just look at the download amounts at
>> sourceforge. 1.3.39 one download and 1.3.40 148 downloads per week.
>>
>> However, 1.3.39 does *not* put the PVINVOKE() method twice into the
>> PVINVOKE.cs file.
>>
>>
>>>  May be we should consider including the generated
>>>> wrappers in gdal instead of let the users to use different versions with
>>>> different results.
>>>>
>>> It would be good if we could have a common SWIG version that works for
>>> all the
>>> bindings. So currently it seems to be 1.3.40 ?
>>>
>>> Regarding putting the generated wrappers in SVN, that's already what we
>>> do for
>>> Python. We could also just include the generated wrappers in the
>>> tarballs.
>>>
>>
>>  IMO "users" = people who use ready-made packages. Developers and
>> packagers should be intelligent enough to use development tools. I don't
>> like the idea of having generated files in source repositories. I'm also of
>> the opinion that there should be a really good reason to use an old version
>> of a common tool. And at least in my Linux (Mint, Maya - hmm, that seems
>> already pretty old, I should upgrade) swig 2.0.11 is the current. But
>> that's just me I guess.
>>
>> Ari
>>
>>
>>> Even
>>>
>>>
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150529/2a1ad9fa/attachment-0001.html>

From ari.jolma at gmail.com  Fri May 29 06:15:35 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Fri, 29 May 2015 16:15:35 +0300
Subject: [gdal-dev] CSharp bindings question
In-Reply-To: <CACALY+Tw4FocB0YxKzuum0Am=8UoZpqbcv2OrLe0B8BZtP5=Ng@mail.gmail.com>
References: <55642437.2040603@gmail.com>	<CACALY+TSL-P1ZkO+iVrTMTb2VwdOydq02x62QhAUehcnqw2M7w@mail.gmail.com>	<201505261038.10033.even.rouault@spatialys.com>	<55643841.7060503@gmail.com>	<CACALY+RhWrcSQTtUxkmVZ9SKkdc5-kTvV59VzQpA=yKnZFTviw@mail.gmail.com>	<55681116.9050800@gmail.com>
	<CACALY+Tw4FocB0YxKzuum0Am=8UoZpqbcv2OrLe0B8BZtP5=Ng@mail.gmail.com>
Message-ID: <55686677.5020209@gmail.com>

On 29.05.2015 15:22, Tamas Szekeres wrote:
> Hi Ari,
>
> Which SWIG version have you been testing with?

Mostly with the one that's loaded by default into a new Ubuntu (travis) 
/ Mint (I have version 17 which is based on Ubuntu Trusty), both are 
2.0.11 I think.

>
> Converting IntPtr to string doesn't seem to be a good solution. We 
> should do something like what we do for ReadRaster which also use 
> AddrOfPinnedObject(). I'm trying to reproduce this.

Yes I'm sure it is not, I just used it to make it compile. It is used 
only(?) by FileFromMemBuffer, which is not tested in CSharp tests (I'm 
not yet testing it in Perl bindings either).

Ari

>
> Best regards,
>
> Tamas
>
>
> 2015-05-29 9:11 GMT+02:00 Ari Jolma <ari.jolma at gmail.com 
> <mailto:ari.jolma at gmail.com>>:
>
>     In my fork I've now added mono-mcs into the travis test machine
>     and "make test" to CSharp. The build & tests all work.
>
>     https://travis-ci.org/OSGeo/gdal/builds/64450000
>
>     However, one fix I did for the CSharp bindings is most probably
>     wrong (convert return value of handle.AddrOfPinnedObject() to char *)
>
>     https://github.com/ajolma/gdal/commit/6509ef06d6f89d99c446300e4f4a63b65613911e
>
>     Tamas, do you have an idea for this?
>
>     There are a lot of #if ... #endif's in for example ogr.i to limit
>     %feature("kwargs"), this is due to a swig bug, which is fixed in
>     3.03 so we need to leave them in for now.
>
>     https://github.com/swig/swig/issues/242
>
>     There's a lot still to do to cleanup the common interface files
>     but how do you feel, is there a chance that this is accepted into
>     the trunk (and 2.1)? I'd also love to have a policy for developing
>     the bindings and working test codes for all maintained languages.
>     A rule could be that the use of #if ... #endif in common files
>     needs a good justification and commits, which do not cause test
>     codes to fail are ok per se.
>
>     Best,
>
>     Ari
>
>     On 26.05.2015 13:53, Tamas Szekeres wrote:
>>     Is that a requirement that the bindings should work well with all
>>     SWIG versions or that the generated wrappers should work just fine?
>>
>>     Formerly I have been thinking that we should support all
>>     versions, but it took large amount of extra efforts to work
>>     around all incompatible changes what SWIG introduces all the time
>>     even with the minor releases. Regarding to SWIG C# the earlier
>>     versions produced definitely wrong code and I had implement quite
>>     some generic stuff in the bindings (for example to work around
>>     the early garbage collection issues). I see some enhancements in
>>     the recent versions in this regard, but I'm not sure if I can
>>     completely remove these additions to get a stable and consistent
>>     build.
>>
>>     Tamas
>>
>>
>>
>>     2015-05-26 11:09 GMT+02:00 Ari Jolma <ari.jolma at gmail.com
>>     <mailto:ari.jolma at gmail.com>>:
>>
>>         26.05.2015, 11:38, Even Rouault kirjoitti:
>>
>>             Le mardi 26 mai 2015 10:13:49, Tamas Szekeres a ?crit :
>>
>>                 Hi Ari,
>>
>>                 I haven't tried to compile that with mono for quite a
>>                 long time. I'll give
>>                 it a try.
>>
>>                 However we did not follow the latest changes in the
>>                 SWIG implementation
>>                 with the bindings, so I'd try with an earlier version
>>                 (ie. 1.3.39) to
>>                 generate the wrappers.
>>
>>             I can confirm that I can compile the CSharp bindings on
>>             Linux with SWIG 1.3.40
>>             (and run the tests), but I get the same error as Ari with
>>             SWIG 2.0.X
>>
>>             As far as I know, Java and Python bindings build and run
>>             equaly well with SWIG
>>             1.3.40 or 2.0.X (although there's a Unix makefile hack to
>>             have Python 3.2
>>             compat, conditionnaly applied with SWIG 1.3.40, that is
>>             no longer needed with
>>             SWIG 2.0.4 or later)
>>
>>
>>         Swig 1.3.39 seems questionable. Just look at the download
>>         amounts at sourceforge. 1.3.39 one download and 1.3.40 148
>>         downloads per week.
>>
>>         However, 1.3.39 does *not* put the PVINVOKE() method twice
>>         into the PVINVOKE.cs file.
>>
>>
>>                 May be we should consider including the generated
>>                 wrappers in gdal instead of let the users to use
>>                 different versions with
>>                 different results.
>>
>>             It would be good if we could have a common SWIG version
>>             that works for all the
>>             bindings. So currently it seems to be 1.3.40 ?
>>
>>             Regarding putting the generated wrappers in SVN, that's
>>             already what we do for
>>             Python. We could also just include the generated wrappers
>>             in the tarballs.
>>
>>
>>         IMO "users" = people who use ready-made packages. Developers
>>         and packagers should be intelligent enough to use development
>>         tools. I don't like the idea of having generated files in
>>         source repositories. I'm also of the opinion that there
>>         should be a really good reason to use an old version of a
>>         common tool. And at least in my Linux (Mint, Maya - hmm, that
>>         seems already pretty old, I should upgrade) swig 2.0.11 is
>>         the current. But that's just me I guess.
>>
>>         Ari
>>
>>
>>             Even
>>
>>
>>
>
>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150529/d1b26e8a/attachment.html>

From ari.jolma at gmail.com  Sun May 31 22:47:55 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Mon, 01 Jun 2015 08:47:55 +0300
Subject: [gdal-dev] CSharp bindings question
In-Reply-To: <201505291052.51428.even.rouault@spatialys.com>
References: <55642437.2040603@gmail.com>
	<CACALY+RhWrcSQTtUxkmVZ9SKkdc5-kTvV59VzQpA=yKnZFTviw@mail.gmail.com>
	<55681116.9050800@gmail.com>
	<201505291052.51428.even.rouault@spatialys.com>
Message-ID: <556BF20B.20205@gmail.com>

On 29.05.2015 11:52, Even Rouault wrote:
> As it might be difficult in practice to coordinate with all 
> maintainers at the exact time were things are needed, perhaps we need 
> some wiki page to document which new methods have been added and which 
> languages are impacted, so that the maintainer can look at it when he 
> has time and add the needed typemaps. 

Would a) a message to this list and b) an addition to a README file in 
swig be enough?

There is swig/include/README.typemaps, which IMO could be renamed to 
swig/README and made a bit larger in its scope.

Hm. Maybe c) a wiki page could also be of use. I haven't written to the 
wiki in a long time except to make some small updates. I could work on 
that a bit. The wiki should reference the README and vice versa.

Ari


