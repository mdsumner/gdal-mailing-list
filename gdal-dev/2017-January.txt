From silyko at gmail.com  Sun Jan  1 09:17:58 2017
From: silyko at gmail.com (Simon Lyngby Kokkendorff)
Date: Sun, 1 Jan 2017 18:17:58 +0100
Subject: [gdal-dev] OSM - delineation of rivers
Message-ID: <CANzGYpQjxwsEWFAvrajPg94xzXTQi5qCtLf-fGGVuHhRyfszEA@mail.gmail.com>

Dear List,

  I have some issues getting river boundaries out of OSM data when using
GDAL to read e.g. an OSM xml file downloaded via the overpass API. Using
e.g.:

>ogr2ogr -t_srs EPSG:3857 -f SQLITE -dsco SPATIALITE=YES --config
OSM_USE_CUSTOM_INDEXING NO map.sqlite map.osm

>ogrinfo --version
GDAL 2.1.0, released 2016/04/25

Specifically I have been trying with the River Thames in London. For some
parts of the river it works, and I get features in the 'lines' layer with
waterway='riverbank', that are closed. But for many locations I get no
features (lines or multlipolygons) that can be used to bound the river -
links to some images and OSM data below.

When running the ogr2ogr command, I do get an errror:

ERROR 1: Too many tags in relation 62149,

which is not unusual though..

However, the osm2pqsql tool seems to be able to handle the various cases
and I do get nice polygons bounding the river.

Hope that someone can shed some can shed some light on what can be done. Is
it a complex situation, that OGR currently cannot handle, or can I tune
some parameters or the osmconf.ini file to be able to handle these cases? I
am aware that rivers can be tagged in several different ways.

OSM data:
https://dl.dropboxusercontent.com/u/97068354/map.osm

Images:
https://dl.dropboxusercontent.com/u/97068354/London_thames.png
https://dl.dropboxusercontent.com/u/97068354/London_thames.pgw
https://dl.dropboxusercontent.com/u/97068354/thames_from_osm2pgsql.png
https://dl.dropboxusercontent.com/u/97068354/thames_from_osm2pgsql.pgw

Best Regards and Happy New Year!
Simon Kokkendorff
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170101/87a7d9ce/attachment.html>

From even.rouault at spatialys.com  Sun Jan  1 10:41:57 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 01 Jan 2017 19:41:57 +0100
Subject: [gdal-dev] OSM - delineation of rivers
In-Reply-To: <CANzGYpQjxwsEWFAvrajPg94xzXTQi5qCtLf-fGGVuHhRyfszEA@mail.gmail.com>
References: <CANzGYpQjxwsEWFAvrajPg94xzXTQi5qCtLf-fGGVuHhRyfszEA@mail.gmail.com>
Message-ID: <2216708.3e5UXsS07K@even-i700>

On dimanche 1 janvier 2017 18:17:58 CET Simon Lyngby Kokkendorff wrote:
> Dear List,
> 
>   I have some issues getting river boundaries out of OSM data when using
> GDAL to read e.g. an OSM xml file downloaded via the overpass API. Using
> 
> e.g.:
> >ogr2ogr -t_srs EPSG:3857 -f SQLITE -dsco SPATIALITE=YES --config
> 
> OSM_USE_CUSTOM_INDEXING NO map.sqlite map.osm
> 
> >ogrinfo --version
> 
> GDAL 2.1.0, released 2016/04/25
> 
> Specifically I have been trying with the River Thames in London. For some
> parts of the river it works, and I get features in the 'lines' layer with
> waterway='riverbank', that are closed. But for many locations I get no
> features (lines or multlipolygons) that can be used to bound the river -
> links to some images and OSM data below.
> 
> When running the ogr2ogr command, I do get an errror:
> 
> ERROR 1: Too many tags in relation 62149,
> 
> which is not unusual though..

I've just fixed in trunk this error, but this is not directly related to the issue you have.

I presume osm2pgsql is more tolerant when parsing relations where some members are 
missing. Currently the OGR OSM driver gives up building a multipolygon as soon as a member 
is missing. This is my hypothesis for the missing geometries (that should be confirmed by 
identifying the OSM id of the objects imported by osm2pgsql and missing in OGR OSM 
output)

This is for example the case for  <relation id="28934"> "River Thames".

No solution except improving OGROSMDataSource::BuildMultiPolygon() in ogr/ogrsf_frmts/
osm ;-) or extracting a larger extent around the area of interest so that relations aren't 
truncated.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170101/4b157f90/attachment.html>

From silyko at gmail.com  Sun Jan  1 12:15:23 2017
From: silyko at gmail.com (Simon Lyngby Kokkendorff)
Date: Sun, 1 Jan 2017 21:15:23 +0100
Subject: [gdal-dev] OSM - delineation of rivers
In-Reply-To: <2216708.3e5UXsS07K@even-i700>
References: <CANzGYpQjxwsEWFAvrajPg94xzXTQi5qCtLf-fGGVuHhRyfszEA@mail.gmail.com>
 <2216708.3e5UXsS07K@even-i700>
Message-ID: <CANzGYpSH0Hmsh-uQaKtv3U-gdX+D0z6Qn+xp466n028np0w-ug@mail.gmail.com>

Thanks Even,

 I'll try to see if I can fix the issue for that particular location by
including a larger area. Was just puzzled because things were working fine
at other locations along the river, and for some other rivers, even with a
smaller area. But perhaps that's due to river polygons being smaller.
Also I was cheating a bit with osm2pgsql which was run on a much larger
area - since I thought the problem wasn't due to the area being too small.
But makes completely sense of course, that this could be the issue -
somehow assumed that the overpass API would return all "relevant" features
intersecting the bounding box.

Will test a bit more 😄

Cheers,
Simon

Den 01/01/2017 7.41 PM skrev "Even Rouault" <even.rouault at spatialys.com>:

> On dimanche 1 janvier 2017 18:17:58 CET Simon Lyngby Kokkendorff wrote:
>
> > Dear List,
>
> >
>
> > I have some issues getting river boundaries out of OSM data when using
>
> > GDAL to read e.g. an OSM xml file downloaded via the overpass API. Using
>
> >
>
> > e.g.:
>
> > >ogr2ogr -t_srs EPSG:3857 -f SQLITE -dsco SPATIALITE=YES --config
>
> >
>
> > OSM_USE_CUSTOM_INDEXING NO map.sqlite map.osm
>
> >
>
> > >ogrinfo --version
>
> >
>
> > GDAL 2.1.0, released 2016/04/25
>
> >
>
> > Specifically I have been trying with the River Thames in London. For some
>
> > parts of the river it works, and I get features in the 'lines' layer with
>
> > waterway='riverbank', that are closed. But for many locations I get no
>
> > features (lines or multlipolygons) that can be used to bound the river -
>
> > links to some images and OSM data below.
>
> >
>
> > When running the ogr2ogr command, I do get an errror:
>
> >
>
> > ERROR 1: Too many tags in relation 62149,
>
> >
>
> > which is not unusual though..
>
>
>
> I've just fixed in trunk this error, but this is not directly related to
> the issue you have.
>
>
>
> I presume osm2pgsql is more tolerant when parsing relations where some
> members are missing. Currently the OGR OSM driver gives up building a
> multipolygon as soon as a member is missing. This is my hypothesis for the
> missing geometries (that should be confirmed by identifying the OSM id of
> the objects imported by osm2pgsql and missing in OGR OSM output)
>
>
>
> This is for example the case for <relation id="28934"> "River Thames".
>
>
>
> No solution except improving OGROSMDataSource::BuildMultiPolygon() in
> ogr/ogrsf_frmts/osm ;-) or extracting a larger extent around the area of
> interest so that relations aren't truncated.
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170101/e9b34209/attachment.html>

From silyko at gmail.com  Sun Jan  1 13:52:18 2017
From: silyko at gmail.com (Simon Lyngby Kokkendorff)
Date: Sun, 1 Jan 2017 22:52:18 +0100
Subject: [gdal-dev] OSM - delineation of rivers
In-Reply-To: <CANzGYpSH0Hmsh-uQaKtv3U-gdX+D0z6Qn+xp466n028np0w-ug@mail.gmail.com>
References: <CANzGYpQjxwsEWFAvrajPg94xzXTQi5qCtLf-fGGVuHhRyfszEA@mail.gmail.com>
 <2216708.3e5UXsS07K@even-i700>
 <CANzGYpSH0Hmsh-uQaKtv3U-gdX+D0z6Qn+xp466n028np0w-ug@mail.gmail.com>
Message-ID: <CANzGYpSSdWdMhQXPeXs9zJY2Nn84oV6b9Xfz6EjDvfuuQH=WGQ@mail.gmail.com>

And indeed - worked like a charm when I ran ogr2ogr on a pbf file
containing the whole of England. The River Thames is represented nicely, as
was the case with osm2pgsql. Was surprisingly fast also compared to
osm2pgsql!

So definitely a "too small area" issue!

Thanks again, and sorry for the noise!
Simon


On Sun, Jan 1, 2017 at 9:15 PM, Simon Lyngby Kokkendorff <silyko at gmail.com>
wrote:

> Thanks Even,
>
>  I'll try to see if I can fix the issue for that particular location by
> including a larger area. Was just puzzled because things were working fine
> at other locations along the river, and for some other rivers, even with a
> smaller area. But perhaps that's due to river polygons being smaller.
> Also I was cheating a bit with osm2pgsql which was run on a much larger
> area - since I thought the problem wasn't due to the area being too small.
> But makes completely sense of course, that this could be the issue -
> somehow assumed that the overpass API would return all "relevant" features
> intersecting the bounding box.
>
> Will test a bit more 😄
>
> Cheers,
> Simon
>
> Den 01/01/2017 7.41 PM skrev "Even Rouault" <even.rouault at spatialys.com>:
>
>> On dimanche 1 janvier 2017 18:17:58 CET Simon Lyngby Kokkendorff wrote:
>>
>> > Dear List,
>>
>> >
>>
>> > I have some issues getting river boundaries out of OSM data when using
>>
>> > GDAL to read e.g. an OSM xml file downloaded via the overpass API. Using
>>
>> >
>>
>> > e.g.:
>>
>> > >ogr2ogr -t_srs EPSG:3857 -f SQLITE -dsco SPATIALITE=YES --config
>>
>> >
>>
>> > OSM_USE_CUSTOM_INDEXING NO map.sqlite map.osm
>>
>> >
>>
>> > >ogrinfo --version
>>
>> >
>>
>> > GDAL 2.1.0, released 2016/04/25
>>
>> >
>>
>> > Specifically I have been trying with the River Thames in London. For
>> some
>>
>> > parts of the river it works, and I get features in the 'lines' layer
>> with
>>
>> > waterway='riverbank', that are closed. But for many locations I get no
>>
>> > features (lines or multlipolygons) that can be used to bound the river -
>>
>> > links to some images and OSM data below.
>>
>> >
>>
>> > When running the ogr2ogr command, I do get an errror:
>>
>> >
>>
>> > ERROR 1: Too many tags in relation 62149,
>>
>> >
>>
>> > which is not unusual though..
>>
>>
>>
>> I've just fixed in trunk this error, but this is not directly related to
>> the issue you have.
>>
>>
>>
>> I presume osm2pgsql is more tolerant when parsing relations where some
>> members are missing. Currently the OGR OSM driver gives up building a
>> multipolygon as soon as a member is missing. This is my hypothesis for the
>> missing geometries (that should be confirmed by identifying the OSM id of
>> the objects imported by osm2pgsql and missing in OGR OSM output)
>>
>>
>>
>> This is for example the case for <relation id="28934"> "River Thames".
>>
>>
>>
>> No solution except improving OGROSMDataSource::BuildMultiPolygon() in
>> ogr/ogrsf_frmts/osm ;-) or extracting a larger extent around the area of
>> interest so that relations aren't truncated.
>>
>>
>>
>> Even
>>
>>
>>
>> --
>>
>> Spatialys - Geospatial professional services
>>
>> http://www.spatialys.com
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170101/58eb6a98/attachment.html>

From andre+joost at nurfuerspam.de  Mon Jan  2 10:12:40 2017
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Mon, 02 Jan 2017 19:12:40 +0100
Subject: [gdal-dev] OSM - delineation of rivers
In-Reply-To: <CANzGYpSSdWdMhQXPeXs9zJY2Nn84oV6b9Xfz6EjDvfuuQH=WGQ@mail.gmail.com>
References: <CANzGYpQjxwsEWFAvrajPg94xzXTQi5qCtLf-fGGVuHhRyfszEA@mail.gmail.com>
 <2216708.3e5UXsS07K@even-i700>
 <CANzGYpSH0Hmsh-uQaKtv3U-gdX+D0z6Qn+xp466n028np0w-ug@mail.gmail.com>
 <CANzGYpSSdWdMhQXPeXs9zJY2Nn84oV6b9Xfz6EjDvfuuQH=WGQ@mail.gmail.com>
Message-ID: <o4e57q$l76$1@blaine.gmane.org>

Am 01.01.2017 um 22:52 schrieb Simon Lyngby Kokkendorff:
> And indeed - worked like a charm when I ran ogr2ogr on a pbf file
> containing the whole of England. The River Thames is represented nicely, as
> was the case with osm2pgsql. Was surprisingly fast also compared to
> osm2pgsql!
>
> So definitely a "too small area" issue!
>

Alternatively, you can look up the river relation at 
http://wiki.openstreetmap.org/wiki/UK_Waterway_Relations and Query only 
for that, but complete:

relation(2263653);>>;
out;

HTH,
André Joost



From silyko at gmail.com  Mon Jan  2 13:14:23 2017
From: silyko at gmail.com (Simon Lyngby Kokkendorff)
Date: Mon, 2 Jan 2017 22:14:23 +0100
Subject: [gdal-dev] OSM - delineation of rivers
In-Reply-To: <o4e57q$l76$1@blaine.gmane.org>
References: <CANzGYpQjxwsEWFAvrajPg94xzXTQi5qCtLf-fGGVuHhRyfszEA@mail.gmail.com>
 <2216708.3e5UXsS07K@even-i700>
 <CANzGYpSH0Hmsh-uQaKtv3U-gdX+D0z6Qn+xp466n028np0w-ug@mail.gmail.com>
 <CANzGYpSSdWdMhQXPeXs9zJY2Nn84oV6b9Xfz6EjDvfuuQH=WGQ@mail.gmail.com>
 <o4e57q$l76$1@blaine.gmane.org>
Message-ID: <CANzGYpTZza6htqB0dgAFbnaKwbYiWVb6i3+WqX47x3b9fK2dqQ@mail.gmail.com>

Hi Andre,

  Thanks for the tip - I guess there's a lot more that can be done with the
overpass API than I'm using right now!
In my case I need to process a lot of square regions (with random center
coords). Will try to see if the "river problem" can be fixed by fetching a
larger region than needed, or perhaps doing a more advanced query than the
simple bounding box one, I'm doing now. Should really look a bit more into
the API!

Cheers,
Simon



On Mon, Jan 2, 2017 at 7:12 PM, Andre Joost <andre+joost at nurfuerspam.de>
wrote:

> Am 01.01.2017 um 22:52 schrieb Simon Lyngby Kokkendorff:
>
>> And indeed - worked like a charm when I ran ogr2ogr on a pbf file
>> containing the whole of England. The River Thames is represented nicely,
>> as
>> was the case with osm2pgsql. Was surprisingly fast also compared to
>> osm2pgsql!
>>
>> So definitely a "too small area" issue!
>>
>>
> Alternatively, you can look up the river relation at
> http://wiki.openstreetmap.org/wiki/UK_Waterway_Relations and Query only
> for that, but complete:
>
> relation(2263653);>>;
> out;
>
> HTH,
> André Joost
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170102/33cf201d/attachment.html>

From nik at nixanz.com  Mon Jan  2 16:24:32 2017
From: nik at nixanz.com (Nik Sands)
Date: Tue, 03 Jan 2017 11:24:32 +1100
Subject: [gdal-dev] 1.11 OGR_F_SetFieldDouble() then
	OGR_F_GetFieldAsDouble() always returns zero
Message-ID: <bc4ce4707f1b0a3a124af811fb52e0799b7ab07c@atmail.dreamhost.com>

Hi List.  I'm using GDAL/OGR 1.11 in an Objective-C (iOS)
application.

I'm attempting to store double values in an OFTReal field using
OGR_F_SetFieldDouble() and then to retrieve these values later using
OGR_F_GetFieldAsDouble().  If I retrieve the value immediately, it
works fine.  However, after closing and re-opening the
datasource/layer, I only ever get zero (0.0) values.  I am running
syncToDisk() after writing values.

I'm using the Esri Shapefile driver.

The code used for writing is:
-----------------------------------------------------------------------

i = OGR_F_GetFieldIndex(feature.feature, "Time");

if ( i > -1 ) {

OGR_F_SetFieldDouble(feature.feature, i, [[NSDate date]
timeIntervalSince1970]);

NSLog(@"Wrote %ld Date  %f", OGR_F_GetFID(feature.feature),
OGR_F_GetFieldAsDouble(feature.feature, i));

//  LOGS EXPECTED NON-ZERO VALUE HERE

}

OGR_L_SyncToDisk(_layer);
-----------------------------------------------------------------------

The code used for reading after re-opening the data source is:
-----------------------------------------------------------------------

i = OGR_F_GetFieldIndex(_feature, "Time");

if ( i > -1 ) {

NSLog(@"Got %ld Cell Date:  %f", OGR_F_GetFID(_feature),
OGR_F_GetFieldAsDouble(_feature, i));

//  ALWAYS LOGS 0.0 HERE (logs a valid FID)

}
------------------------------------------------------------------------

Am I doing anything obviously wrong?  Any ideas why this is not
working as I expected?

Let me know if there is any more code that would make it more clear.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170103/8737f5a7/attachment.html>

From lucena_ivan at hotmail.com  Mon Jan  2 18:08:10 2017
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Tue, 3 Jan 2017 02:08:10 +0000
Subject: [gdal-dev] configure: WARNING: unrecognized options:
	--with-macosx-framework
Message-ID: <MWHPR19MB13288E3CC025C2E527CDAA84F26E0@MWHPR19MB1328.namprd19.prod.outlook.com>

Hi,


I can successfully built GDAL on OSX as long as my target is /usr/local but when building for the framework I and getting some errors.


The first one seems easy no fix:


$ ./configure --with-macosx-framework
configure: WARNING: unrecognized options: --with-macosx-framework
checking build system type... x86_64-apple-darwin14.5.0
checking host system type... x86_64-apple-darwin14.5.0
checking for gcc... gcc
checking whether the C compiler works... yes
. . .

There is a missing entry on the file "configure":

$ svn diff configure
Index: configure
===================================================================
--- configure    (revision 37029)
+++ configure    (working copy)
@@ -1047,6 +1047,7 @@
 with_perl
 with_php
 with_python
+with_macosx_framework
 with_java
 with_mdb
 with_jvm_lib

Once that is fixed, the "unrecognized options" warning goes away and I am getting in some linking error related to the code on frtms/pdf. It seems like a xCode version issue but I am still working on it.

Anyway, should I file a bug and commit the above path to the file "configure"?

Regards,

Ivan


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170103/2c6c6e34/attachment.html>

From even.rouault at spatialys.com  Mon Jan  2 23:40:02 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 03 Jan 2017 08:40:02 +0100
Subject: [gdal-dev] 1.11 OGR_F_SetFieldDouble() then
	OGR_F_GetFieldAsDouble() always returns zero
In-Reply-To: <bc4ce4707f1b0a3a124af811fb52e0799b7ab07c@atmail.dreamhost.com>
References: <bc4ce4707f1b0a3a124af811fb52e0799b7ab07c@atmail.dreamhost.com>
Message-ID: <2418842.1qO2kiDOIF@even-i700>

Nik,

Using OGR_F_SetFieldXXXXX() only modifies the in-memory value, but has 
no effect on serialization. You have to use OGR_L_SetFeature() to make sure 
that the modified feature is written back to the datasource.

As it seems to be a common pitfall, I'm going to improve the doc of the 
OGR_F_SetFieldXXXX functions to make that clear.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170103/226654d9/attachment.html>

From nik at nixanz.com  Tue Jan  3 00:24:34 2017
From: nik at nixanz.com (Nik)
Date: Tue, 3 Jan 2017 19:24:34 +1100
Subject: [gdal-dev] 1.11 OGR_F_SetFieldDouble() then
	OGR_F_GetFieldAsDouble() always returns zero
In-Reply-To: <2418842.1qO2kiDOIF@even-i700>
References: <bc4ce4707f1b0a3a124af811fb52e0799b7ab07c@atmail.dreamhost.com>
 <2418842.1qO2kiDOIF@even-i700>
Message-ID: <AA1020DB-EE5D-4EF9-9284-C1A06BE9DB8E@nixanz.com>

Hey, thanks for this advice Even.  I think I may have actually stumbled on a similar issue in the past (with setting geometry) so I really should have known better.  

Thanks for the reminder.   Yes, an update to the doco would help newbies as well as people like me who only dabble around the edges.   

Cheers,
Nik. 

-----------------------------------------
NIK SANDS
Line Tamer | Time Traveller | Space Cadet

> On 3 Jan 2017, at 6:40 pm, Even Rouault <even.rouault at spatialys.com> wrote:
> 
> Nik,
>  
> Using OGR_F_SetFieldXXXXX() only modifies the in-memory value, but has no effect on serialization. You have to use OGR_L_SetFeature() to make sure that the modified feature is written back to the datasource.
>  
> As it seems to be a common pitfall, I'm going to improve the doc of the OGR_F_SetFieldXXXX functions to make that clear.
>  
> Even
>  
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com


From even.rouault at spatialys.com  Tue Jan  3 02:55:49 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 03 Jan 2017 11:55:49 +0100
Subject: [gdal-dev] configure: WARNING: unrecognized options:
	--with-macosx-framework
In-Reply-To: <MWHPR19MB13288E3CC025C2E527CDAA84F26E0@MWHPR19MB1328.namprd19.prod.outlook.com>
References: <MWHPR19MB13288E3CC025C2E527CDAA84F26E0@MWHPR19MB1328.namprd19.prod.outlook.com>
Message-ID: <1527439.WMWFZUYRaI@even-i700>

> 
> Anyway, should I file a bug and commit the above path to the file
> "configure"?

configure should never been manually modified. It is regenerated by autoconf (currently 
2.69) from configure.in

I've traced the issue to be linked to the following line in configure.in

AC_ARG_WITH(,[  --with-macosx-framework         Build and install GDAL as a Mac OS X 
Framework],,)

Changing it to

AC_ARG_WITH(macosx-framework,[  --with-macosx-framework         Build and install GDAL as 
a Mac OS X Framework],,)

seems to solve the issue.

Surprisingly, the AC_ARG_WITH(,[ ....]) syntax has been used since
https://trac.osgeo.org/gdal/changeset/10196 , so perhaps the warning has always existed, or 
autoconf is less tolerant now. Who knows.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170103/87eced36/attachment.html>

From vladimir.sandoval at yandex.com  Tue Jan  3 09:45:58 2017
From: vladimir.sandoval at yandex.com (Vladimir Sandoval)
Date: Tue, 03 Jan 2017 20:45:58 +0300
Subject: [gdal-dev] GDAL and OGR utilities as library functions?
Message-ID: <7783761483465558@web6g.yandex.ru>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170103/8f2a775a/attachment.html>

From even.rouault at spatialys.com  Tue Jan  3 10:48:31 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 03 Jan 2017 19:48:31 +0100
Subject: [gdal-dev] GDAL and OGR utilities as library functions?
In-Reply-To: <7783761483465558@web6g.yandex.ru>
References: <7783761483465558@web6g.yandex.ru>
Message-ID: <3758452.Dtd88BJuxQ@even-i700>

On mardi 3 janvier 2017 20:45:58 CET Vladimir Sandoval wrote:
> Greetings:
> Referencing this blog
> post http://erouault.blogspot.com/2015/10/gdal-and-ogr-utilities-as-library
> .html I need to use the "new" Translate method in the GDAL Java API.
> However, the Translate method is not even in GDAL2.1.0 available at Maven
> (TranslateOptions is in there, but not Translate). The Windoze versions of
> GDAL available at GISInternals also do not seem to have the Translate
> method, although I did find one version that has it, I've added it to an
> IntelliJ project as a library. 
> Question1: Is it "supposed" to be available at this time?

To be honest, I didn't try but it looks like the method is available :

http://gdal.org/java/org/gdal/gdal/gdal.html#Translate(java.lang.String,%20org.gdal.gdal.Dataset,%20org.gdal.gdal.TranslateOptions)

and I can see it in the generated .java files from swig files.

>  
> There is little/no documentation on how to use the Translate method.

(Contributions in 2017 are as welcome as in previous years ! Hint: the file to edit is swig/java/javadoc.java and
the the doc is built with swig/java/make_doc.sh)

The general principles are exposed
here https://trac.osgeo.org/gdal/wiki/rfc59.1_utilities_as_a_library and should be
transposable to other languages.

> I'm
> guessing here, but the way I'm trying to use it is: 
> Vector<String> optionsVector = new Vector<>();
> optionsVector.add("of PNG");
> optionsVector.add("outsize 128 128");

try

optionsVector.add("-of");
optionsVector.add("PNG");
optionsVector.add("-outsize");
optionsVector.add("128");
optionsVector.add("128");

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170103/7a582fdc/attachment.html>

From vladimir.sandoval at yandex.com  Wed Jan  4 06:30:31 2017
From: vladimir.sandoval at yandex.com (Vlad)
Date: Wed, 4 Jan 2017 07:30:31 -0700 (MST)
Subject: [gdal-dev] GDAL and OGR utilities as library functions?
In-Reply-To: <3758452.Dtd88BJuxQ@even-i700>
References: <7783761483465558@web6g.yandex.ru> <3758452.Dtd88BJuxQ@even-i700>
Message-ID: <1483540231634-5301979.post@n6.nabble.com>

Even, thanks for the prompt response.  Your example is indeed correct and
worked just fine.  

Still having some problems with Windows GDAL version mismatches (the dreaded
SwigUpcast exception), and not all versions of the Windows gdal.jar have the
Translate method, but I'll get with Gisinternals to see what's going on with
that.

Thanks again.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-GDAL-and-OGR-utilities-as-library-functions-tp5301865p5301979.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From schwehr at gmail.com  Thu Jan  5 07:08:46 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Thu, 5 Jan 2017 07:08:46 -0800
Subject: [gdal-dev] C++11 timeline
In-Reply-To: <CACmBxysv7H=MP1iV+O=sHfh4Z8teuuvic7mgQrGiSmpeC_fmcw@mail.gmail.com>
References: <CACmBxysv7H=MP1iV+O=sHfh4Z8teuuvic7mgQrGiSmpeC_fmcw@mail.gmail.com>
Message-ID: <CACmBxyt4nE1Z_gCPOgUiOe=jNOg6us7kKE5uz0QeAYKQ8g4ypQ@mail.gmail.com>

A ping to bring the topic of C++11 back to the front post holidays.

Thoughts?

On Fri, Dec 23, 2016 at 10:05 AM, Kurt Schwehr <schwehr at gmail.com> wrote:

> Hi all,
>
> I would like to continue the C++11 discussion over the next couple weeks
> while many people are on slower development cycles with a proposal:
>
> * Starting 2017-Mar-01, we switch GDAL trunk to require C++11 support from
> the compiler.
> * All prior branches would stick with their existing requirements for
> C++03 support
>
> I had come up with a bunch of other things for a timeline, but they all
> see like noise after Even pointed out a whole ton of issues my thoughts.
> This isn't as aggressive as I would like, but it would definitely help
> reduce the maintenance burden on humans and reduce the test load for
> continuous integration.  I removed explicit mention of OS or compiler
> versions which I had in my initial thoughts.
>
> This would not be a free-for-all on C++11 features.  I think we would want
> to just start with removing some of the macros and workarounds that are
> currently in the code base.  Until we decide to go forward with other
> features, the main changes that would happen in C++ only code after this
> would be:
>
> - Change NULL to nullptr
> - Drop virtual when using the override keyword (this becomes a req with
> C++17)
> - CPL_OVERRIDE -> override
> - Remove HAVE_CXX11 #ifs
> - And maybe some other things I missed
>
> Once those are all done, we can then discuss when to allow things like
> unique_ptr internally (which will allow some serious simplification of some
> code).
>
> Then at some later time, we can discuss what API changes to allow, when to
> require C++14, C++17, C11, etc.
>
> Thoughts?
>
> -kurt
>
> e.g.
>
> find . -name \*.cpp -o -name \*.h | xargs grep -i override | grep virtual
> | wc -l
>     3998
>
> find . -name \*.cpp -o -name \*.h | xargs grep CPL_OVERRIDE | wc -l
>      712
>
> find . -name \*.cpp -o -name \*.h | xargs grep HAVE_CXX11 | wc -l
>       36
>
>


-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170105/950bc601/attachment.html>

From schwehr at gmail.com  Thu Jan  5 07:18:45 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Thu, 5 Jan 2017 07:18:45 -0800
Subject: [gdal-dev] Question on block size in the kakadu driver
Message-ID: <CACmBxyuh9dogTDhJZe=t5FSneL7=sM_XuJzfS7h799W9tYhbXA@mail.gmail.com>

Frank, Even or anyone with experience with jp2k block sizes,

Any chance you could comment on the change I proposed here?

https://trac.osgeo.org/gdal/ticket/6764

Is it reasonable to change this:

    if( nRasterXSize >= 2048 )
        nBlockXSize = 2048;
    else
        nBlockXSize = nRasterXSize;

    if( nRasterYSize >= 256 )  // <- 256
        nBlockYSize = 128;       // <- 128 ???
    else
        nBlockYSize = nRasterYSize;

Into:

         nBlockXSize = std::min(nRasterXSize, 2048);
         nBlockYSize = std::min(nRasterYSize, 128)

or

         nBlockXSize = std::min(nRasterXSize, 2048);
         nBlockYSize = std::min(nRasterYSize, 256)

Neither of those is the same behavior and the the jump from 256 back to 128
is not explained in the revision log.  Which behavior will have better
performance for a average case or will it matter?   The difference will be
between 262K cells or 524K cells.  With doubles, that will be 2 or 4 MB for
a single block from one band.  I'm thinking 128 is likely going to work
better with RAM caches.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170105/4ee6f15e/attachment.html>

From even.rouault at spatialys.com  Thu Jan  5 07:40:48 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 05 Jan 2017 16:40:48 +0100
Subject: [gdal-dev] Question on block size in the kakadu driver
In-Reply-To: <CACmBxyuh9dogTDhJZe=t5FSneL7=sM_XuJzfS7h799W9tYhbXA@mail.gmail.com>
References: <CACmBxyuh9dogTDhJZe=t5FSneL7=sM_XuJzfS7h799W9tYhbXA@mail.gmail.com>
Message-ID: <2823424.GDgglQMqA9@even-i700>

On jeudi 5 janvier 2017 07:18:45 CET Kurt Schwehr wrote:
> Frank, Even or anyone with experience with jp2k block sizes,
> 
> Any chance you could comment on the change I proposed here?
> 
> https://trac.osgeo.org/gdal/ticket/6764
> 
> Is it reasonable to change this:
> 
>     if( nRasterXSize >= 2048 )
>         nBlockXSize = 2048;
>     else
>         nBlockXSize = nRasterXSize;
> 
>     if( nRasterYSize >= 256 )  // <- 256
>         nBlockYSize = 128;       // <- 128 ???
>     else
>         nBlockYSize = nRasterYSize;
> 
> Into:
> 
>          nBlockXSize = std::min(nRasterXSize, 2048);
>          nBlockYSize = std::min(nRasterYSize, 128)
> 
> or
> 
>          nBlockXSize = std::min(nRasterXSize, 2048);
>          nBlockYSize = std::min(nRasterYSize, 256)
> 
> Neither of those is the same behavior and the the jump from 256 back to 128
> is not explained in the revision log.  Which behavior will have better
> performance for a average case or will it matter? 

The code is a bit weird indeed. But the block size of smallish datasets has no real importance, 
so if you find it more reasable, switching the condition to if ( nRasterYSize >= 128 ) (or the 
equivalent std::min()) should have no adverse consequences.

Block size in the case of JPEG 2000 is really hard to come with. A smarter block size logic 
would depend on JPEG 2000 tiling, presence of precincts, etc... This also could depend on the 
read pattern. Would deserve extensive testing to come out with the ideal formula... In the 
case of JP2KAK, there's also a IRasterIO() implementation that causes the block size to not 
be used at all in typical read scenarios.


> The difference will be
> between 262K cells or 524K cells.  With doubles, that will be 2 or 4 MB for
> a single block from one band.

FWIIW, JPEG2000 doesn't support double (at least not in the base standard)


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170105/b3292c0f/attachment.html>

From howard at hobu.co  Thu Jan  5 07:47:35 2017
From: howard at hobu.co (Howard Butler)
Date: Thu, 5 Jan 2017 09:47:35 -0600
Subject: [gdal-dev] C++11 timeline
In-Reply-To: <CACmBxyt4nE1Z_gCPOgUiOe=jNOg6us7kKE5uz0QeAYKQ8g4ypQ@mail.gmail.com>
References: <CACmBxysv7H=MP1iV+O=sHfh4Z8teuuvic7mgQrGiSmpeC_fmcw@mail.gmail.com>
 <CACmBxyt4nE1Z_gCPOgUiOe=jNOg6us7kKE5uz0QeAYKQ8g4ypQ@mail.gmail.com>
Message-ID: <02524FED-7022-4C4B-9664-A48A9A5D2F91@hobu.co>


> On Jan 5, 2017, at 9:08 AM, Kurt Schwehr <schwehr at gmail.com> wrote:
> 
> A ping to bring the topic of C++11 back to the front post holidays.
> 
> Thoughts?
> 
> On Fri, Dec 23, 2016 at 10:05 AM, Kurt Schwehr <schwehr at gmail.com> wrote:
> Hi all,
> 
> I would like to continue the C++11 discussion over the next couple weeks while many people are on slower development cycles with a proposal:
> 
> * Starting 2017-Mar-01, we switch GDAL trunk to require C++11 support from the compiler.
> * All prior branches would stick with their existing requirements for C++03 support
> 
> I had come up with a bunch of other things for a timeline, but they all see like noise after Even pointed out a whole ton of issues my thoughts.  This isn't as aggressive as I would like, but it would definitely help reduce the maintenance burden on humans and reduce the test load for continuous integration.  I removed explicit mention of OS or compiler versions which I had in my initial thoughts.
> 
> This would not be a free-for-all on C++11 features.  I think we would want to just start with removing some of the macros and workarounds that are currently in the code base.  Until we decide to go forward with other features, the main changes that would happen in C++ only code after this would be:
> 
> - Change NULL to nullptr
> - Drop virtual when using the override keyword (this becomes a req with C++17)
> - CPL_OVERRIDE -> override
> - Remove HAVE_CXX11 #ifs
> - And maybe some other things I missed
> 
> Once those are all done, we can then discuss when to allow things like unique_ptr internally (which will allow some serious simplification of some code).
> 
> Then at some later time, we can discuss what API changes to allow, when to require C++14, C++17, C11, etc.
> 
> Thoughts?

Kurt,

I meant to chime in on this. Thanks for the reminder. I wanted to put forward some of the experience we've had with PDAL on moving to C++11. I think the first question to ask is which compilers does GDAL expect to support, and then compute back from there as to whether or not enough C++11 support is covered by that set. PDAL's situation has been different than GDAL because we're a much younger project, we have a smaller set of compilers we have historically supported, and we have been a bit aggressive about moving forward. Even so, there are a few C++11'isms we don't use because we allow MSVC2013, for example. 

I agree that object lifetime management with unique_ptr and some systematic RAII would significantly improve GDAL's internals in terms of complexity and opportunity for bugs., but the refactoring itself is also likely to introduce a few bugs too. The benefits of following a few (not all) established modern C++ patterns would also help bootstrap developers into the GDAL codebase a bit faster as well. PDAL was happy to quit using Boost for its modern C++ library support, and our codebase has been better for it IMO. 

I'm not sure that GDAL has this luxury, however. The project would need to migrate with clear acknowledgement of the consequences -- the dropping of support for a number of now-working-but-quite-esoteric compilers. We wouldn't want to #ifdef hell the support of both. Maybe the size of the set that would be dropped is small. We need some feedback from people on the topic to gauge the temperature on it.

To migrate everything to C++11 just for the sake of it doesn't seem prudent, but I agree the long term benefits to the project could be significant. GDAL already has a number of CPL classes that are C++11 -like in terms of functionality they provide. There's been some benefit to doing our own thing and having control over it that might be given up with a move to C++11. 

What is the list of compilers that GDAL actively and accidentally supports? How will that be impacted by a C++11 requirement?

Howard


From even.rouault at spatialys.com  Thu Jan  5 09:26:27 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 05 Jan 2017 18:26:27 +0100
Subject: [gdal-dev] C++11 timeline
In-Reply-To: <02524FED-7022-4C4B-9664-A48A9A5D2F91@hobu.co>
References: <CACmBxysv7H=MP1iV+O=sHfh4Z8teuuvic7mgQrGiSmpeC_fmcw@mail.gmail.com>
 <CACmBxyt4nE1Z_gCPOgUiOe=jNOg6us7kKE5uz0QeAYKQ8g4ypQ@mail.gmail.com>
 <02524FED-7022-4C4B-9664-A48A9A5D2F91@hobu.co>
Message-ID: <22828021.y404zajIpn@even-i700>

> 
> What is the list of compilers that GDAL actively and accidentally supports?

Currently, at least:
GCC >= 4.4 (actually must be 4.1 since this is what ancient mingw uses)
clang >= 3.something (3.0 probably)
VS >= 2008
ICC 15 probably

One aspect is to also consider the various analyzers used. I think cppcheck has only partial C+
+11 support. I'd guess Coverity Scan should have decent C++11 support but this is just a 
guess. CLang Static Analyzer should likely work just fine with the C++11 supported by the 
underlying clang compiler

> How will that be impacted by a C++11 requirement?

GCC 4.8 is needed for C++11 I think. There are folks using recent GDAL on older distros like 
Ubuntu 12.04 (which ships with gcc 4.6). I guess they could switch to adding a PPA with a 
more recent toolchain.
For Visual Studio depends on the features we use. Would be good to have VS2013 or even 
2012. I'm CC'ing Jürgen Fischer to know if he has plans regarding of the compiler version that 
will be used for OSGeo4W / QGIS 3.0

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170105/16eacdd8/attachment.html>

From schwehr at gmail.com  Thu Jan  5 09:32:57 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Thu, 5 Jan 2017 09:32:57 -0800
Subject: [gdal-dev] C++11 timeline
In-Reply-To: <22828021.y404zajIpn@even-i700>
References: <CACmBxysv7H=MP1iV+O=sHfh4Z8teuuvic7mgQrGiSmpeC_fmcw@mail.gmail.com>
 <CACmBxyt4nE1Z_gCPOgUiOe=jNOg6us7kKE5uz0QeAYKQ8g4ypQ@mail.gmail.com>
 <02524FED-7022-4C4B-9664-A48A9A5D2F91@hobu.co> <22828021.y404zajIpn@even-i700>
Message-ID: <CACmBxyvPN450pVfa2vhP1-OENtbtng1kR7=POXP2GjXR8wJ2AQ@mail.gmail.com>

Even responded while I was trying to write up something, so I'm going to
stop writing and send :)

Howard,

Thanks for the thoughts.  I believe we are thinking along the same lines.

All,

After time for comments, I plan to write up an RFC for the initial strategy
that is explicit about assumptions.

Please correct me if you think I'm wrong/missing anything.  Especially when
it comes to non-linux / mac builds.

Useful references:

http://en.cppreference.com/w/cpp/compiler_support
https://en.wikipedia.org/wiki/List_of_compilers#C.2B.2B_compilers

Current explicit supported compilers:

- MS VC9
- MS VC12
- MS VC13
- MinGW 32 (this is old)
- MinGW 64 (newer)
- clang >= 3.0?
- gcc >= 4.6.3.  Even said 4.4

Best effort supported compilers:

- SunPro/Oracle C++ >= ?
- Intel >= ?

My guess at our new situaltion

- MS >= VC13 (I am confused by their version numbers)
- MinGW 32 (newer)
- MinGW 64 (newer)
- clang >= 3.3
- gcc >= 4.8

Best effort supported compilers:

- SunPro >= ?
- Intel >= ?

On Thu, Jan 5, 2017 at 9:26 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> >
>
> > What is the list of compilers that GDAL actively and accidentally
> supports?
>
>
>
> Currently, at least:
>
> GCC >= 4.4 (actually must be 4.1 since this is what ancient mingw uses)
>
> clang >= 3.something (3.0 probably)
>
> VS >= 2008
>
> ICC 15 probably
>
>
>
> One aspect is to also consider the various analyzers used. I think
> cppcheck has only partial C++11 support. I'd guess Coverity Scan should
> have decent C++11 support but this is just a guess. CLang Static Analyzer
> should likely work just fine with the C++11 supported by the underlying
> clang compiler
>
>
>
> > How will that be impacted by a C++11 requirement?
>
>
>
> GCC 4.8 is needed for C++11 I think. There are folks using recent GDAL on
> older distros like Ubuntu 12.04 (which ships with gcc 4.6). I guess they
> could switch to adding a PPA with a more recent toolchain.
>
> For Visual Studio depends on the features we use. Would be good to have
> VS2013 or even 2012. I'm CC'ing Jürgen Fischer to know if he has plans
> regarding of the compiler version that will be used for OSGeo4W / QGIS 3.0
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170105/b3e4e722/attachment.html>

From schwehr at gmail.com  Thu Jan  5 09:37:24 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Thu, 5 Jan 2017 09:37:24 -0800
Subject: [gdal-dev] Question on block size in the kakadu driver
In-Reply-To: <2823424.GDgglQMqA9@even-i700>
References: <CACmBxyuh9dogTDhJZe=t5FSneL7=sM_XuJzfS7h799W9tYhbXA@mail.gmail.com>
 <2823424.GDgglQMqA9@even-i700>
Message-ID: <CACmBxysi0v9EXu2v51Y1C9GW7CZ5JVLFoE-DQFiyd=PBQT6cXg@mail.gmail.com>

Even,

Thanks!  I'm working on a change that will do:

nBlockXSize = std::min(nRasterXSize, 2048);

nBlockYSize = std::min(nRasterYSize, 128);


Getting a performance monitoring system setup is definitely on my todo
list, but sadly still down a ways.


On Thu, Jan 5, 2017 at 7:40 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> On jeudi 5 janvier 2017 07:18:45 CET Kurt Schwehr wrote:
>
> > Frank, Even or anyone with experience with jp2k block sizes,
>
> >
>
> > Any chance you could comment on the change I proposed here?
>
> >
>
> > https://trac.osgeo.org/gdal/ticket/6764
>
> >
>
> > Is it reasonable to change this:
>
> >
>
> > if( nRasterXSize >= 2048 )
>
> > nBlockXSize = 2048;
>
> > else
>
> > nBlockXSize = nRasterXSize;
>
> >
>
> > if( nRasterYSize >= 256 ) // <- 256
>
> > nBlockYSize = 128; // <- 128 ???
>
> > else
>
> > nBlockYSize = nRasterYSize;
>
> >
>
> > Into:
>
> >
>
> > nBlockXSize = std::min(nRasterXSize, 2048);
>
> > nBlockYSize = std::min(nRasterYSize, 128)
>
> >
>
> > or
>
> >
>
> > nBlockXSize = std::min(nRasterXSize, 2048);
>
> > nBlockYSize = std::min(nRasterYSize, 256)
>
> >
>
> > Neither of those is the same behavior and the the jump from 256 back to
> 128
>
> > is not explained in the revision log. Which behavior will have better
>
> > performance for a average case or will it matter?
>
>
>
> The code is a bit weird indeed. But the block size of smallish datasets
> has no real importance, so if you find it more reasable, switching the
> condition to if ( nRasterYSize >= 128 ) (or the equivalent std::min())
> should have no adverse consequences.
>
>
>
> Block size in the case of JPEG 2000 is really hard to come with. A smarter
> block size logic would depend on JPEG 2000 tiling, presence of precincts,
> etc... This also could depend on the read pattern. Would deserve extensive
> testing to come out with the ideal formula... In the case of JP2KAK,
> there's also a IRasterIO() implementation that causes the block size to not
> be used at all in typical read scenarios.
>
>
>
>
>
> > The difference will be
>
> > between 262K cells or 524K cells. With doubles, that will be 2 or 4 MB
> for
>
> > a single block from one band.
>
>
>
> FWIIW, JPEG2000 doesn't support double (at least not in the base standard)
>
>
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170105/594f5ca4/attachment-0001.html>

From andrew.bell.ia at gmail.com  Thu Jan  5 11:38:38 2017
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Thu, 5 Jan 2017 13:38:38 -0600
Subject: [gdal-dev] C++11 timeline
In-Reply-To: <CACmBxyvPN450pVfa2vhP1-OENtbtng1kR7=POXP2GjXR8wJ2AQ@mail.gmail.com>
References: <CACmBxysv7H=MP1iV+O=sHfh4Z8teuuvic7mgQrGiSmpeC_fmcw@mail.gmail.com>
 <CACmBxyt4nE1Z_gCPOgUiOe=jNOg6us7kKE5uz0QeAYKQ8g4ypQ@mail.gmail.com>
 <02524FED-7022-4C4B-9664-A48A9A5D2F91@hobu.co> <22828021.y404zajIpn@even-i700>
 <CACmBxyvPN450pVfa2vhP1-OENtbtng1kR7=POXP2GjXR8wJ2AQ@mail.gmail.com>
Message-ID: <CACJ51z1VUQNO0-hvHvzn=8vHxd05jFne63ZCFHQOQDgyueC_7A@mail.gmail.com>

Why is there a desire to support old compilers for new code?  Those that
don't want to upgrade compilers can always use existing distributions.

On Thu, Jan 5, 2017 at 11:32 AM, Kurt Schwehr <schwehr at gmail.com> wrote:

> Even responded while I was trying to write up something, so I'm going to
> stop writing and send :)
>
> Howard,
>
> Thanks for the thoughts.  I believe we are thinking along the same lines.
>
> All,
>
> After time for comments, I plan to write up an RFC for the initial
> strategy that is explicit about assumptions.
>
> Please correct me if you think I'm wrong/missing anything.  Especially
> when it comes to non-linux / mac builds.
>
> Useful references:
>
> http://en.cppreference.com/w/cpp/compiler_support
> https://en.wikipedia.org/wiki/List_of_compilers#C.2B.2B_compilers
>
> Current explicit supported compilers:
>
> - MS VC9
> - MS VC12
> - MS VC13
> - MinGW 32 (this is old)
> - MinGW 64 (newer)
> - clang >= 3.0?
> - gcc >= 4.6.3.  Even said 4.4
>
> Best effort supported compilers:
>
> - SunPro/Oracle C++ >= ?
> - Intel >= ?
>
> My guess at our new situaltion
>
> - MS >= VC13 (I am confused by their version numbers)
> - MinGW 32 (newer)
> - MinGW 64 (newer)
> - clang >= 3.3
> - gcc >= 4.8
>
> Best effort supported compilers:
>
> - SunPro >= ?
> - Intel >= ?
>
> On Thu, Jan 5, 2017 at 9:26 AM, Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> >
>>
>> > What is the list of compilers that GDAL actively and accidentally
>> supports?
>>
>>
>>
>> Currently, at least:
>>
>> GCC >= 4.4 (actually must be 4.1 since this is what ancient mingw uses)
>>
>> clang >= 3.something (3.0 probably)
>>
>> VS >= 2008
>>
>> ICC 15 probably
>>
>>
>>
>> One aspect is to also consider the various analyzers used. I think
>> cppcheck has only partial C++11 support. I'd guess Coverity Scan should
>> have decent C++11 support but this is just a guess. CLang Static Analyzer
>> should likely work just fine with the C++11 supported by the underlying
>> clang compiler
>>
>>
>>
>> > How will that be impacted by a C++11 requirement?
>>
>>
>>
>> GCC 4.8 is needed for C++11 I think. There are folks using recent GDAL on
>> older distros like Ubuntu 12.04 (which ships with gcc 4.6). I guess they
>> could switch to adding a PPA with a more recent toolchain.
>>
>> For Visual Studio depends on the features we use. Would be good to have
>> VS2013 or even 2012. I'm CC'ing Jürgen Fischer to know if he has plans
>> regarding of the compiler version that will be used for OSGeo4W / QGIS 3.0
>>
>>
>>
>> Even
>>
>>
>>
>> --
>>
>> Spatialys - Geospatial professional services
>>
>> http://www.spatialys.com
>>
>
>
>
> --
> --
> http://schwehr.org
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170105/1346e7ad/attachment.html>

From lucena_ivan at hotmail.com  Thu Jan  5 12:03:33 2017
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Thu, 5 Jan 2017 20:03:33 +0000
Subject: [gdal-dev] configure: WARNING: unrecognized options:
 --with-macosx-framework
In-Reply-To: <1527439.WMWFZUYRaI@even-i700>
References: <MWHPR19MB13288E3CC025C2E527CDAA84F26E0@MWHPR19MB1328.namprd19.prod.outlook.com>,
 <1527439.WMWFZUYRaI@even-i700>
Message-ID: <MWHPR19MB132897ABCEF87F9AA0185B51F2600@MWHPR19MB1328.namprd19.prod.outlook.com>

Hi Even,


Your change fix the warning. Thanks.


The other issue I was having is that because on:


/frmts/pdf/GNUmakefile


LDFLAGS and CPPFLAGS defines libstdc++ while the result setting from ./configure is libc++.


I simply change the PDF driver makefile to use libc++ instead of libstdc++ and the GDAL macosx-framework build worked just fine. I don't know if we need to change that.


Thanks,

Ivan

________________________________
From: Even Rouault <even.rouault at spatialys.com>
Sent: Tuesday, January 3, 2017 5:55:49 AM
To: gdal-dev at lists.osgeo.org
Cc: Ivan Lucena
Subject: Re: [gdal-dev] configure: WARNING: unrecognized options: --with-macosx-framework


>

> Anyway, should I file a bug and commit the above path to the file

> "configure"?



configure should never been manually modified. It is regenerated by autoconf (currently 2.69) from configure.in



I've traced the issue to be linked to the following line in configure.in



AC_ARG_WITH(,[  --with-macosx-framework         Build and install GDAL as a Mac OS X Framework],,)



Changing it to



AC_ARG_WITH(macosx-framework,[ --with-macosx-framework Build and install GDAL as a Mac OS X Framework],,)



seems to solve the issue.



Surprisingly, the AC_ARG_WITH(,[ ....]) syntax has been used since

https://trac.osgeo.org/gdal/changeset/10196 , so perhaps the warning has always existed, or autoconf is less tolerant now. Who knows.



Even



--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170105/62c43873/attachment.html>

From jmckenna at gatewaygeomatics.com  Thu Jan  5 12:23:35 2017
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Thu, 5 Jan 2017 16:23:35 -0400
Subject: [gdal-dev] C++11 timeline
In-Reply-To: <22828021.y404zajIpn@even-i700>
References: <CACmBxysv7H=MP1iV+O=sHfh4Z8teuuvic7mgQrGiSmpeC_fmcw@mail.gmail.com>
 <CACmBxyt4nE1Z_gCPOgUiOe=jNOg6us7kKE5uz0QeAYKQ8g4ypQ@mail.gmail.com>
 <02524FED-7022-4C4B-9664-A48A9A5D2F91@hobu.co>
 <22828021.y404zajIpn@even-i700>
Message-ID: <ae1fb464-3b27-df51-8079-b3ed9cd1d466@gatewaygeomatics.com>

MS4W builds are moving to VS2015, because PHP 7's requirement for that 
compiler, but stable releases are done now with VS2012.  (I've 
officially moved away from the old VS2008)

-jeff

-- 
Jeff McKenna
President Emeritus, OSGeo Foundation
http://wiki.osgeo.org/wiki/Jeff_McKenna



On 2017-01-05 1:26 PM, Even Rouault wrote:
>>
>
>> What is the list of compilers that GDAL actively and accidentally
> supports?
>
>
>
> Currently, at least:
>
> GCC >= 4.4 (actually must be 4.1 since this is what ancient mingw uses)
>
> clang >= 3.something (3.0 probably)
>
> VS >= 2008
>
> ICC 15 probably
>
>
>
> One aspect is to also consider the various analyzers used. I think
> cppcheck has only partial C++11 support. I'd guess Coverity Scan should
> have decent C++11 support but this is just a guess. CLang Static
> Analyzer should likely work just fine with the C++11 supported by the
> underlying clang compiler
>
>
>
>> How will that be impacted by a C++11 requirement?
>
>
>
> GCC 4.8 is needed for C++11 I think. There are folks using recent GDAL
> on older distros like Ubuntu 12.04 (which ships with gcc 4.6). I guess
> they could switch to adding a PPA with a more recent toolchain.
>
> For Visual Studio depends on the features we use. Would be good to have
> VS2013 or even 2012. I'm CC'ing Jürgen Fischer to know if he has plans
> regarding of the compiler version that will be used for OSGeo4W / QGIS 3.0
>
>
>
> Even
>
>
>
> -




From bontepaarden at gmail.com  Thu Jan  5 13:36:53 2017
From: bontepaarden at gmail.com (Paul Meems)
Date: Thu, 5 Jan 2017 22:36:53 +0100
Subject: [gdal-dev] How does OGRFeature::GetFieldAsDouble handle NULL values
Message-ID: <CAHNf2YRUXNqzT6vzPEwo5VeTLj7okCQUWLiHhnLZbpSf_reWRw@mail.gmail.com>

We're using GDAL v2.1.2 on Windows.

We use the GDAL library with MapWinGIS to connect to a PostGIS database.
When the PostGIS table has NULL values in integer, numeric or double fields
and that data is read the returned values are 0 (zero), which is unexpected
by us.

We use Feature->GetFieldAsDouble() and Feature->GetFieldAsInteger().
Am I correct that these function return 0 when the database value is NULL?
If not our implementation is wrong and I need to continue my search.
The documentation
http://www.gdal.org/classOGRFeature.html#ab8a57c94e8bb8ffac5e7048d896254b4
doesn't say either way.

Thanks,

Paul
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170105/0d10ca1a/attachment.html>

From nyall.dawson at gmail.com  Thu Jan  5 14:24:13 2017
From: nyall.dawson at gmail.com (Nyall Dawson)
Date: Fri, 6 Jan 2017 08:24:13 +1000
Subject: [gdal-dev] How does OGRFeature::GetFieldAsDouble handle NULL
	values
In-Reply-To: <CAHNf2YRUXNqzT6vzPEwo5VeTLj7okCQUWLiHhnLZbpSf_reWRw@mail.gmail.com>
References: <CAHNf2YRUXNqzT6vzPEwo5VeTLj7okCQUWLiHhnLZbpSf_reWRw@mail.gmail.com>
Message-ID: <CAB28AsgJAE8-R+k+B9=xxX775TExzkmfQ8JmBF6VnJSpGNHREA@mail.gmail.com>

On 6 Jan 2017 7:37 AM, "Paul Meems" <bontepaarden at gmail.com> wrote:

We're using GDAL v2.1.2 on Windows.

We use the GDAL library with MapWinGIS to connect to a PostGIS database.
When the PostGIS table has NULL values in integer, numeric or double fields
and that data is read the returned values are 0 (zero), which is unexpected
by us.

We use Feature->GetFieldAsDouble() and Feature->GetFieldAsInteger().
Am I correct that these function return 0 when the database value is NULL?
If not our implementation is wrong and I need to continue my search.
The documentation http://www.gdal.org/classOGRFeature.html#
ab8a57c94e8bb8ffac5e7048d896254b4 doesn't say either way.


Try Feature->IsFieldSet(...)

http://www.gdal.org/classOGRFeature.html#a7ad01c76b7b13bcf9eab5092aacac5fb

That should return false for null values.

Nyall


Thanks,

Paul

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170106/a6f9049f/attachment.html>

From gdt at lexort.com  Thu Jan  5 18:42:50 2017
From: gdt at lexort.com (Greg Troxel)
Date: Thu, 05 Jan 2017 21:42:50 -0500
Subject: [gdal-dev] C++11 timeline
In-Reply-To: <22828021.y404zajIpn@even-i700> (Even Rouault's message of "Thu, 
 05 Jan 2017 18:26:27 +0100")
References: <CACmBxysv7H=MP1iV+O=sHfh4Z8teuuvic7mgQrGiSmpeC_fmcw@mail.gmail.com>
 <CACmBxyt4nE1Z_gCPOgUiOe=jNOg6us7kKE5uz0QeAYKQ8g4ypQ@mail.gmail.com>
 <02524FED-7022-4C4B-9664-A48A9A5D2F91@hobu.co>
 <22828021.y404zajIpn@even-i700>
Message-ID: <smu8tqoc3it.fsf@linuxpal.mit.edu>


Even Rouault <even.rouault at spatialys.com> writes:

>> How will that be impacted by a C++11 requirement?
>
> GCC 4.8 is needed for C++11 I think. There are folks using recent GDAL on older distros like 
> Ubuntu 12.04 (which ships with gcc 4.6). I guess they could switch to adding a PPA with a 
> more recent toolchain.

As a datapoint, NetBSD 6, a few years old but still supported, has gcc
4.5.  In general, it seems that requiring gcc 4.8 causes a fair bit of
grief for people.  I find that programs in straight C99 or older C++
build pretty much everywhere, and C++11 seems to take more effort.
Probably in 2 years this will be a non-issue.

Another possibility is to look at the features that would make a
difference and whether they are in boost.  As I somewhat fuzzily
understand it, much of the smart pointer stuff moved from boost to
C++11, so gcc 4.5 (or equivalent age clang) and boost may be a less
troublesome requirement.

Overall, I tend to think foundational support libraries should seek to
avoid being the thing that pushes someone to have to redo their
toolchain, and I am afraid that requiring C++11 would put gdal into that
category.

So, I think it's about how much trouble would be saved, vs imposed.   I
am not perceiving a lot of trouble from not using C++11 featues on the
dev list.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 162 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170105/c90981cd/attachment-0001.sig>

From schwehr at gmail.com  Thu Jan  5 20:19:50 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Thu, 5 Jan 2017 20:19:50 -0800
Subject: [gdal-dev] C++11 timeline
In-Reply-To: <smu8tqoc3it.fsf@linuxpal.mit.edu>
References: <CACmBxysv7H=MP1iV+O=sHfh4Z8teuuvic7mgQrGiSmpeC_fmcw@mail.gmail.com>
 <CACmBxyt4nE1Z_gCPOgUiOe=jNOg6us7kKE5uz0QeAYKQ8g4ypQ@mail.gmail.com>
 <02524FED-7022-4C4B-9664-A48A9A5D2F91@hobu.co> <22828021.y404zajIpn@even-i700>
 <smu8tqoc3it.fsf@linuxpal.mit.edu>
Message-ID: <CACmBxytE3aPgAB6WyoaOLZBt+t682OoaykP9LkV7jFsA--x66g@mail.gmail.com>

Checking http://en.cppreference.com/w/cpp/compiler_support shows C++11
support starting to take shape starting with gcc 4.3 (but it's missing
almost everything at that point).

Greg,

Can you explain the use case as to what keeps you on an older NetBSD but
unable to use a branch of a recent GDAL?  e.g. I'm am suggesting that we
keep GDAL 2.1 and older to stay with the current requirement of supporting
C++03.

As for boost, my experiences are that would be far more effort support it
on many platforms than getting a working C++11 compiler.  Boost is full of
really awesome code, but there be dragons and really careful consideration
should be made before requiring boost for any code that will have to be
linked against by other libraries.

-kurt

On Thu, Jan 5, 2017 at 6:42 PM, Greg Troxel <gdt at lexort.com> wrote:

>
> Even Rouault <even.rouault at spatialys.com> writes:
>
> >> How will that be impacted by a C++11 requirement?
> >
> > GCC 4.8 is needed for C++11 I think. There are folks using recent GDAL
> on older distros like
> > Ubuntu 12.04 (which ships with gcc 4.6). I guess they could switch to
> adding a PPA with a
> > more recent toolchain.
>
> As a datapoint, NetBSD 6, a few years old but still supported, has gcc
> 4.5.  In general, it seems that requiring gcc 4.8 causes a fair bit of
> grief for people.  I find that programs in straight C99 or older C++
> build pretty much everywhere, and C++11 seems to take more effort.
> Probably in 2 years this will be a non-issue.
>
> Another possibility is to look at the features that would make a
> difference and whether they are in boost.  As I somewhat fuzzily
> understand it, much of the smart pointer stuff moved from boost to
> C++11, so gcc 4.5 (or equivalent age clang) and boost may be a less
> troublesome requirement.
>
> Overall, I tend to think foundational support libraries should seek to
> avoid being the thing that pushes someone to have to redo their
> toolchain, and I am afraid that requiring C++11 would put gdal into that
> category.
>
> So, I think it's about how much trouble would be saved, vs imposed.   I
> am not perceiving a lot of trouble from not using C++11 featues on the
> dev list.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170105/afb1a765/attachment.html>

From bontepaarden at gmail.com  Thu Jan  5 23:44:39 2017
From: bontepaarden at gmail.com (Paul Meems)
Date: Fri, 6 Jan 2017 08:44:39 +0100
Subject: [gdal-dev] How does OGRFeature::GetFieldAsDouble handle NULL
	values
In-Reply-To: <CAB28AsgJAE8-R+k+B9=xxX775TExzkmfQ8JmBF6VnJSpGNHREA@mail.gmail.com>
References: <CAHNf2YRUXNqzT6vzPEwo5VeTLj7okCQUWLiHhnLZbpSf_reWRw@mail.gmail.com>
 <CAB28AsgJAE8-R+k+B9=xxX775TExzkmfQ8JmBF6VnJSpGNHREA@mail.gmail.com>
Message-ID: <CAHNf2YSuJsebjf2nh4=7jTW9j7e7ZbpV6FanYDGzqKydGH0niA@mail.gmail.com>

Thanks Nyall,

Looking at the documentation it seems to be what I'm looking for.

Thanks,

Paul

*Paul Meems *
Release manager, configuration manager
and forum moderator of MapWindow GIS.
www.mapwindow.org

Owner of MapWindow.nl - Support for
Dutch speaking users.
www.mapwindow.nl


*The MapWindow GIS project has moved to GitHub
<https://github.com/MapWindow>!*


Download the latest MapWinGIS mapping engine.
<https://github.com/MapWindow/MapWinGIS/releases>

Download the latest MapWindow 5 open source desktop application.
<https://github.com/MapWindow/MapWindow5/releases>

2017-01-05 23:24 GMT+01:00 Nyall Dawson <nyall.dawson at gmail.com>:

>
>
> On 6 Jan 2017 7:37 AM, "Paul Meems" <bontepaarden at gmail.com> wrote:
>
> We're using GDAL v2.1.2 on Windows.
>
> We use the GDAL library with MapWinGIS to connect to a PostGIS database.
> When the PostGIS table has NULL values in integer, numeric or double
> fields and that data is read the returned values are 0 (zero), which is
> unexpected by us.
>
> We use Feature->GetFieldAsDouble() and Feature->GetFieldAsInteger().
> Am I correct that these function return 0 when the database value is NULL?
> If not our implementation is wrong and I need to continue my search.
> The documentation http://www.gdal.org/classOGRFe
> ature.html#ab8a57c94e8bb8ffac5e7048d896254b4 doesn't say either way.
>
>
> Try Feature->IsFieldSet(...)
>
> http://www.gdal.org/classOGRFeature.html#a7ad01c76b7b13bcf9eab5092aacac5fb
>
> That should return false for null values.
>
> Nyall
>
>
> Thanks,
>
> Paul
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170106/3611c48e/attachment.html>

From andrew at aitchison.me.uk  Fri Jan  6 00:50:51 2017
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Fri, 6 Jan 2017 08:50:51 +0000 (GMT)
Subject: [gdal-dev] C++11 timeline
In-Reply-To: <CACmBxysv7H=MP1iV+O=sHfh4Z8teuuvic7mgQrGiSmpeC_fmcw@mail.gmail.com>
References: <CACmBxysv7H=MP1iV+O=sHfh4Z8teuuvic7mgQrGiSmpeC_fmcw@mail.gmail.com>
Message-ID: <alpine.LRH.2.20.1701060840110.12978@warden.aitchison.me.uk>

On Fri, 23 Dec 2016, Kurt Schwehr wrote:

> I would like to continue the C++11 discussion over the next couple weeks
> while many people are on slower development cycles with a proposal:
>
> * Starting 2017-Mar-01, we switch GDAL trunk to require C++11 support from
> the compiler.
> * All prior branches would stick with their existing requirements for C++03
> support
 		...		...
> This would not be a free-for-all on C++11 features.  I think we would want
> to just start with removing some of the macros and workarounds that are
> currently in the code base.  Until we decide to go forward with other
> features, the main changes that would happen in C++ only code after this
> would be:
>
> - Change NULL to nullptr
> - Drop virtual when using the override keyword (this becomes a req with
> C++17)
> - CPL_OVERRIDE -> override
> - Remove HAVE_CXX11 #ifs
> - And maybe some other things I missed

Are there many people maintaining/developing *plugin* drivers for gdal
- I know of the ECW plugins; are there any others ?

I am working on a couple of private drivers for proprietary formats,
and find it useful that I can use the same source to build plugins for 
GDAL 1.11 and 2.1.2.

Would the changes to nullptr, CPL_OVERRIDE etc. make it harder to maintain 
plugin code for old and new versions of GDAL ?

-- 
Andrew C Aitchison

From schwehr at gmail.com  Fri Jan  6 07:14:55 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Fri, 6 Jan 2017 07:14:55 -0800
Subject: [gdal-dev] C++11 timeline
In-Reply-To: <alpine.LRH.2.20.1701060840110.12978@warden.aitchison.me.uk>
References: <CACmBxysv7H=MP1iV+O=sHfh4Z8teuuvic7mgQrGiSmpeC_fmcw@mail.gmail.com>
 <alpine.LRH.2.20.1701060840110.12978@warden.aitchison.me.uk>
Message-ID: <CACmBxysyqnte1_fMi0=-=Zq7rT78Ud3doibC_FvYKNz21_qMsw@mail.gmail.com>

Andres,

Have you tried compiling GDAL 1.11 as C++11?  I used GDAL 1.11 built as
C++11 for quite a while before switching to GDAL 2.x.  We aren't talking
about changing the internal API for drivers.  Or am I missing something?

On Fri, Jan 6, 2017 at 12:50 AM, Andrew C Aitchison <andrew at aitchison.me.uk>
wrote:

> On Fri, 23 Dec 2016, Kurt Schwehr wrote:
>
> I would like to continue the C++11 discussion over the next couple weeks
>> while many people are on slower development cycles with a proposal:
>>
>> * Starting 2017-Mar-01, we switch GDAL trunk to require C++11 support from
>> the compiler.
>> * All prior branches would stick with their existing requirements for
>> C++03
>> support
>>
>                 ...             ...
>
>> This would not be a free-for-all on C++11 features.  I think we would want
>> to just start with removing some of the macros and workarounds that are
>> currently in the code base.  Until we decide to go forward with other
>> features, the main changes that would happen in C++ only code after this
>> would be:
>>
>> - Change NULL to nullptr
>> - Drop virtual when using the override keyword (this becomes a req with
>> C++17)
>> - CPL_OVERRIDE -> override
>> - Remove HAVE_CXX11 #ifs
>> - And maybe some other things I missed
>>
>
> Are there many people maintaining/developing *plugin* drivers for gdal
> - I know of the ECW plugins; are there any others ?
>
> I am working on a couple of private drivers for proprietary formats,
> and find it useful that I can use the same source to build plugins for
> GDAL 1.11 and 2.1.2.
>
> Would the changes to nullptr, CPL_OVERRIDE etc. make it harder to maintain
> plugin code for old and new versions of GDAL ?
>
> --
> Andrew C Aitchison
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170106/8248c467/attachment-0001.html>

From andrew at aitchison.me.uk  Sat Jan  7 06:38:12 2017
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Sat, 7 Jan 2017 14:38:12 +0000 (GMT)
Subject: [gdal-dev] C++11 timeline
In-Reply-To: <CACmBxysyqnte1_fMi0=-=Zq7rT78Ud3doibC_FvYKNz21_qMsw@mail.gmail.com>
References: <CACmBxysv7H=MP1iV+O=sHfh4Z8teuuvic7mgQrGiSmpeC_fmcw@mail.gmail.com>
 <alpine.LRH.2.20.1701060840110.12978@warden.aitchison.me.uk>
 <CACmBxysyqnte1_fMi0=-=Zq7rT78Ud3doibC_FvYKNz21_qMsw@mail.gmail.com>
Message-ID: <alpine.LRH.2.20.1701061723230.32372@warden.aitchison.me.uk>


On Fri, 6 Jan 2017, Kurt Schwehr wrote:

> Andrew,
>
> Have you tried compiling GDAL 1.11 as C++11?

Yes, and even with C++14 (g++ v5.3.1-6), but mixing GCC versions on linux 
is more forgiving than mixing different compilers on most other platforms.

>  I used GDAL 1.11 built as C++11 for quite a while before switching to GDAL 2.x.
>  We aren't talking about changing the internal API for drivers.
>  Or am I missing something?

I was thinking more about A*B*I compatibility when mixing compilers.
I use GDAL 1.11 because the legacy platform I am on (Scientific Linux 6)
only has QGIS 1.8 and the system compiler is C++98 (with C++0x as an 
option - no mention of C++03).

If other people are run-time linking apps not under their control
(either system provided or third party) against GDAL v1.11 libraries
they may not have the luxury of changing compiler, so may have to
build plugins with one compiler for v1.11 and another for v2.x.

Maybe this is the point at which they stop developing
for the older platforms and/or GDAL v1,
but I can see people needing to support GDAL 2.1.current and 2.next
for some time yet.


> On Fri, Jan 6, 2017 at 12:50 AM, Andrew C Aitchison <andrew at aitchison.me.uk>
> wrote:
>
>> On Fri, 23 Dec 2016, Kurt Schwehr wrote:
>>
>> I would like to continue the C++11 discussion over the next couple weeks
>>> while many people are on slower development cycles with a proposal:
>>>
>>> * Starting 2017-Mar-01, we switch GDAL trunk to require C++11 support from
>>> the compiler.
>>> * All prior branches would stick with their existing requirements for
>>> C++03
>>> support
>>>
>>                 ...             ...
>>
>>> This would not be a free-for-all on C++11 features.  I think we would want
>>> to just start with removing some of the macros and workarounds that are
>>> currently in the code base.  Until we decide to go forward with other
>>> features, the main changes that would happen in C++ only code after this
>>> would be:
>>>
>>> - Change NULL to nullptr
>>> - Drop virtual when using the override keyword (this becomes a req with
>>> C++17)
>>> - CPL_OVERRIDE -> override
>>> - Remove HAVE_CXX11 #ifs
>>> - And maybe some other things I missed
>>>
>>
>> Are there many people maintaining/developing *plugin* drivers for gdal
>> - I know of the ECW plugins; are there any others ?
>>
>> I am working on a couple of private drivers for proprietary formats,
>> and find it useful that I can use the same source to build plugins for
>> GDAL 1.11 and 2.1.2.
>>
>> Would the changes to nullptr, CPL_OVERRIDE etc. make it harder to maintain
>> plugin code for old and new versions of GDAL ?


From Victor.Poughon at cnes.fr  Mon Jan  9 01:31:25 2017
From: Victor.Poughon at cnes.fr (Poughon Victor)
Date: Mon, 9 Jan 2017 09:31:25 +0000
Subject: [gdal-dev] Usage of GDAL_FILENAME_IS_UTF8 config option
Message-ID: <3E55146A6A81B44A9CB69CAB65908CEA4C69EFB4@TW-MBX-P03.cnesnet.ad.cnes.fr>

Hi,

We are using GDAL in OTB and recently we had a bug report about opening non
ASCII filenames on Windows 10 [0]. They suggest a fix using:

> CPLSetConfigOption("GDAL_FILENAME_IS_UTF8","NO");

The test case is GDALOpen() on a file named 你好.tif, which I confirmed works
fine on Linux, but not on Windows 7 or 10.

So my question is to have some clarification on this option, to know if it's
potentially the correct fix for this problem. The doc says:

> This effectively restores the pre-GDAL1.8 behavior for handling filenames on
> Windows and might be appropriate for applications that treat filenames as
> being in the local encoding.

What does it mean exactly to consider filenames to be in the local encoding? And
how do I know if my application [1] does that?

Cheers,

[0] https://github.com/orfeotoolbox/OTB/pull/14
[1] https://github.com/janestar/OTB/blob/f6ffdc17ab3d7aa91726f03ed619fee806eb508a/Modules/IO/IOGDAL/src/otbGDALDriverManagerWrapper.cxx#L55

Victor Poughon





From damian.dixon at gmail.com  Mon Jan  9 02:03:58 2017
From: damian.dixon at gmail.com (Damian Dixon)
Date: Mon, 9 Jan 2017 10:03:58 +0000
Subject: [gdal-dev] Usage of GDAL_FILENAME_IS_UTF8 config option
In-Reply-To: <3E55146A6A81B44A9CB69CAB65908CEA4C69EFB4@TW-MBX-P03.cnesnet.ad.cnes.fr>
References: <3E55146A6A81B44A9CB69CAB65908CEA4C69EFB4@TW-MBX-P03.cnesnet.ad.cnes.fr>
Message-ID: <CAJjdW1y4HcuptZ+w2DfyksvYsM+30GZidbSctx+u4zBcYimo6g@mail.gmail.com>

Hi Victor,

If you set GDAL_FILENAME_IS_UTF8 to YES then you need to pass in filenames
and paths encoded as UTF8.

This means that on Windows you will need to do additional work to convert
from MBCS or UTF16/UCS2 to UTF8.

If your application is built as MBCS then what you essentially have is a
multi-byte string encoding which is the Windows local code page.

If your application is built for Unicode then you have UTF16/UCS2 so you
have to convert the filenames to UTF8 for GDAL/OGR to work.

If you save the filenames as part of an application specific configuration
then you need to consider how you will read read that data back in if the
Windows code page changes. This is not an easy task unless you also save
the code page as well. It also becomes a bit of a mess supporting this on
non-Windows.

The approach we took was to convert our Windows applications to Unicode and
store/use all paths/filenames as UTF8 for portability to
Linux/Android/Solaris.

Regards
Damian

PS. Microsoft has deprecated MBCS build of MFC.



On 9 January 2017 at 09:31, Poughon Victor <Victor.Poughon at cnes.fr> wrote:

> Hi,
>
> We are using GDAL in OTB and recently we had a bug report about opening non
> ASCII filenames on Windows 10 [0]. They suggest a fix using:
>
> > CPLSetConfigOption("GDAL_FILENAME_IS_UTF8","NO");
>
> The test case is GDALOpen() on a file named 你好.tif, which I confirmed works
> fine on Linux, but not on Windows 7 or 10.
>
> So my question is to have some clarification on this option, to know if
> it's
> potentially the correct fix for this problem. The doc says:
>
> > This effectively restores the pre-GDAL1.8 behavior for handling
> filenames on
> > Windows and might be appropriate for applications that treat filenames as
> > being in the local encoding.
>
> What does it mean exactly to consider filenames to be in the local
> encoding? And
> how do I know if my application [1] does that?
>
> Cheers,
>
> [0] https://github.com/orfeotoolbox/OTB/pull/14
> [1] https://github.com/janestar/OTB/blob/f6ffdc17ab3d7aa91726f03ed619fe
> e806eb508a/Modules/IO/IOGDAL/src/otbGDALDriverManagerWrapper.cxx#L55
>
> Victor Poughon
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170109/5b9c79eb/attachment.html>

From daniele.romagnoli at geo-solutions.it  Tue Jan 10 02:00:19 2017
From: daniele.romagnoli at geo-solutions.it (Daniele Romagnoli)
Date: Tue, 10 Jan 2017 11:00:19 +0100
Subject: [gdal-dev] Question on 0th IFD offset when producing a
 JPEG-Compressed GeoTIFF (GDAL 1.11 vs 2.x)
In-Reply-To: <CAJaHrDx0K6zgyktOV9-KDMNhxGEHrpGDLj7mSzDCJCn489TNLQ@mail.gmail.com>
References: <CAJaHrDwPP5_1_+oTAi2u=reSYRbjWhb2cKyREXFe0sLfB3XUVQ@mail.gmail.com>
 <5533045.SmJALounZ5@even-i700>
 <CAJaHrDxNew_OffFTXMBkdQut=Mrok=O+=037jEYfrSuO_x5xqw@mail.gmail.com>
 <7413075.dPIrFvsHGm@even-i700>
 <CAJaHrDx0K6zgyktOV9-KDMNhxGEHrpGDLj7mSzDCJCn489TNLQ@mail.gmail.com>
Message-ID: <CAJaHrDwo9DMQi71z3p-=i0u5ki0d-BEMsD+zTNDFc792oCn8fg@mail.gmail.com>

Hi Even.
I'm back to the topic :)
Do you have any timeframe for the 2.2.x release?

Best Regards,
Daniele



On Fri, Dec 16, 2016 at 2:56 PM, Daniele Romagnoli <
daniele.romagnoli at geo-solutions.it> wrote:

>
>
> On Fri, Dec 16, 2016 at 2:48 PM, Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>>
>>
>> > Right,
>>
>> > Indeed, before sending my previous email I have also tried with:
>>
>> > *gdaladdo -r average --config COMPRESS_OVERVIEW DEFLATE --config
>>
>> > PHOTOMETRIC_OVERVIEW RGB*
>>
>> > to understand if it was related to JPEG only but, even with these
>> options,
>>
>> > the output overviews were jpeg compressed (I assume there is some kind
>> of
>>
>> > coherency check in gdaladdo).
>>
>>
>>
>> With internal overviews, the _OVERVIEW configuration options are ignored.
>> Their value is deduced from the settings of the main IFD.
>>
> It makes sense, indeed.
>
>
>> I don't think there's a strong technical reason for that. Mostly a side
>> effect of the fact that there are slightly different code paths to handle
>> creation of internal and external overviews, and the reading of _OVERVIEW
>> config options is done only in the external overview code path.
>>
>>
>>
>> >
>>
>> > > I do reproduce something similar to your findings in 2.1 indeed. This
>> no
>>
>> > > longer happens in trunk due to related improvements (
>>
>> > > https://trac.osgeo.org/gdal/wiki/CloudOptimizedGeoTIFF), I made in
>> the
>>
>> > > last couple of weeks (using the same trick of creating a in-memory
>> TIFF
>>
>> > > file to get the JPEG tables and set them direcly on the overview IFD
>> at
>>
>> > > creation time).
>>
>> >
>>
>> > Do you think this will be available in other series or does it introduce
>>
>> > new API/major changes which makes it available on 2.2.x only?
>>
>>
>>
>> No API change, but this is in the improvement category rather than
>> bugfixing, and my first changeset resulted in some corrupted images in some
>> situations, which was unnoticed for a few weeks, so that's a sign that it
>> is a somewhat risky change (the GeoTIFF driver is a complex beast), not
>> worth the trouble of breaking stable branches.
>>
> Understood. thanks for the feedback.
> Cheers,
> Daniele
>
>
>>
>>
>> Even
>>
>>
>>
>> --
>>
>> Spatialys - Geospatial professional services
>>
>> http://www.spatialys.com
>>
>
>
>
> --
> ==
> GeoServer Professional Services from the experts! Visit
> http://goo.gl/it488V for more information.
> ==
>
> Ing. Daniele Romagnoli
> Senior Software Engineer
>
> GeoSolutions S.A.S.
> Via di Montramito 3/A
> 55054  Massarosa (LU)
> Italy
> phone: +39 0584 962313 <+39%200584%20962313>
> fax:      +39 0584 1660272 <+39%200584%20166%200272>
>
> http://www.geo-solutions.it
> http://twitter.com/geosolutions_it
>
> -------------------------------------------------------
>
> *AVVERTENZE AI SENSI DEL D.Lgs. 196/2003*
>
> Le informazioni contenute in questo messaggio di posta elettronica e/o
> nel/i file/s allegato/i sono da considerarsi strettamente riservate. Il
> loro utilizzo è consentito esclusivamente al destinatario del messaggio,
> per le finalità indicate nel messaggio stesso. Qualora riceviate questo
> messaggio senza esserne il destinatario, Vi preghiamo cortesemente di
> darcene notizia via e-mail e di procedere alla distruzione del messaggio
> stesso, cancellandolo dal Vostro sistema. Conservare il messaggio stesso,
> divulgarlo anche in parte, distribuirlo ad altri soggetti, copiarlo, od
> utilizzarlo per finalità diverse, costituisce comportamento contrario ai
> principi dettati dal D.Lgs. 196/2003.
>
>
>
> The information in this message and/or attachments, is intended solely for
> the attention and use of the named addressee(s) and may be confidential or
> proprietary in nature or covered by the provisions of privacy act
> (Legislative Decree June, 30 2003, no.196 - Italy's New Data Protection
> Code).Any use not in accord with its purpose, any disclosure, reproduction,
> copying, distribution, or either dissemination, either whole or partial, is
> strictly forbidden except previous formal approval of the named
> addressee(s). If you are not the intended recipient, please contact
> immediately the sender by telephone, fax or e-mail and delete the
> information in this message that has been received in error. The sender
> does not give any warranty or accept liability as the content, accuracy or
> completeness of sent messages and accepts no responsibility  for changes
> made after they were sent or for other risks which arise as a result of
> e-mail transmission, viruses, etc.
>
>


-- 
==
GeoServer Professional Services from the experts! Visit
http://goo.gl/it488V for more information.
==

Ing. Daniele Romagnoli
Senior Software Engineer

GeoSolutions S.A.S.
Via di Montramito 3/A
55054  Massarosa (LU)
Italy
phone: +39 0584 962313
fax:      +39 0584 1660272

http://www.geo-solutions.it
http://twitter.com/geosolutions_it

-------------------------------------------------------

*AVVERTENZE AI SENSI DEL D.Lgs. 196/2003*

Le informazioni contenute in questo messaggio di posta elettronica e/o
nel/i file/s allegato/i sono da considerarsi strettamente riservate. Il
loro utilizzo è consentito esclusivamente al destinatario del messaggio,
per le finalità indicate nel messaggio stesso. Qualora riceviate questo
messaggio senza esserne il destinatario, Vi preghiamo cortesemente di
darcene notizia via e-mail e di procedere alla distruzione del messaggio
stesso, cancellandolo dal Vostro sistema. Conservare il messaggio stesso,
divulgarlo anche in parte, distribuirlo ad altri soggetti, copiarlo, od
utilizzarlo per finalità diverse, costituisce comportamento contrario ai
principi dettati dal D.Lgs. 196/2003.



The information in this message and/or attachments, is intended solely for
the attention and use of the named addressee(s) and may be confidential or
proprietary in nature or covered by the provisions of privacy act
(Legislative Decree June, 30 2003, no.196 - Italy's New Data Protection
Code).Any use not in accord with its purpose, any disclosure, reproduction,
copying, distribution, or either dissemination, either whole or partial, is
strictly forbidden except previous formal approval of the named
addressee(s). If you are not the intended recipient, please contact
immediately the sender by telephone, fax or e-mail and delete the
information in this message that has been received in error. The sender
does not give any warranty or accept liability as the content, accuracy or
completeness of sent messages and accepts no responsibility  for changes
made after they were sent or for other risks which arise as a result of
e-mail transmission, viruses, etc.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170110/5fb21602/attachment.html>

From even.rouault at spatialys.com  Tue Jan 10 02:14:53 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 10 Jan 2017 11:14:53 +0100
Subject: [gdal-dev] Question on 0th IFD offset when producing a
	JPEG-Compressed GeoTIFF (GDAL 1.11 vs 2.x)
In-Reply-To: <CAJaHrDwo9DMQi71z3p-=i0u5ki0d-BEMsD+zTNDFc792oCn8fg@mail.gmail.com>
References: <CAJaHrDwPP5_1_+oTAi2u=reSYRbjWhb2cKyREXFe0sLfB3XUVQ@mail.gmail.com>
 <CAJaHrDx0K6zgyktOV9-KDMNhxGEHrpGDLj7mSzDCJCn489TNLQ@mail.gmail.com>
 <CAJaHrDwo9DMQi71z3p-=i0u5ki0d-BEMsD+zTNDFc792oCn8fg@mail.gmail.com>
Message-ID: <1839521.bCseQYm7fa@even-i700>

On mardi 10 janvier 2017 11:00:19 CET Daniele Romagnoli wrote:
> Hi Even.
> I'm back to the topic :)
> Do you have any timeframe for the 2.2.x release?

April/May likely, to fit with the yearly release tradition.

> 
> Best Regards,
> Daniele
> 
> 
> 
> On Fri, Dec 16, 2016 at 2:56 PM, Daniele Romagnoli <
> 
> daniele.romagnoli at geo-solutions.it> wrote:
> > On Fri, Dec 16, 2016 at 2:48 PM, Even Rouault <even.rouault at spatialys.com>
> > 
> > wrote:
> >> > Right,
> >> > 
> >> > Indeed, before sending my previous email I have also tried with:
> >> > 
> >> > *gdaladdo -r average --config COMPRESS_OVERVIEW DEFLATE --config
> >> > 
> >> > PHOTOMETRIC_OVERVIEW RGB*
> >> > 
> >> > to understand if it was related to JPEG only but, even with these
> >> 
> >> options,
> >> 
> >> > the output overviews were jpeg compressed (I assume there is some kind
> >> 
> >> of
> >> 
> >> > coherency check in gdaladdo).
> >> 
> >> With internal overviews, the _OVERVIEW configuration options are ignored.
> >> Their value is deduced from the settings of the main IFD.
> > 
> > It makes sense, indeed.
> > 
> >> I don't think there's a strong technical reason for that. Mostly a side
> >> effect of the fact that there are slightly different code paths to handle
> >> creation of internal and external overviews, and the reading of _OVERVIEW
> >> config options is done only in the external overview code path.
> >> 
> >> > > I do reproduce something similar to your findings in 2.1 indeed. This
> >> 
> >> no
> >> 
> >> > > longer happens in trunk due to related improvements (
> >> > > 
> >> > > https://trac.osgeo.org/gdal/wiki/CloudOptimizedGeoTIFF), I made in
> >> 
> >> the
> >> 
> >> > > last couple of weeks (using the same trick of creating a in-memory
> >> 
> >> TIFF
> >> 
> >> > > file to get the JPEG tables and set them direcly on the overview IFD
> >> 
> >> at
> >> 
> >> > > creation time).
> >> > 
> >> > Do you think this will be available in other series or does it
> >> > introduce
> >> > 
> >> > new API/major changes which makes it available on 2.2.x only?
> >> 
> >> No API change, but this is in the improvement category rather than
> >> bugfixing, and my first changeset resulted in some corrupted images in
> >> some
> >> situations, which was unnoticed for a few weeks, so that's a sign that it
> >> is a somewhat risky change (the GeoTIFF driver is a complex beast), not
> >> worth the trouble of breaking stable branches.
> > 
> > Understood. thanks for the feedback.
> > Cheers,
> > Daniele
> > 
> >> Even
> >> 
> >> 
> >> 
> >> --
> >> 
> >> Spatialys - Geospatial professional services
> >> 
> >> http://www.spatialys.com
> > 
> > --
> > ==
> > GeoServer Professional Services from the experts! Visit
> > http://goo.gl/it488V for more information.
> > ==
> > 
> > Ing. Daniele Romagnoli
> > Senior Software Engineer
> > 
> > GeoSolutions S.A.S.
> > Via di Montramito 3/A
> > 55054  Massarosa (LU)
> > Italy
> > phone: +39 0584 962313 <+39%200584%20962313>
> > fax:      +39 0584 1660272 <+39%200584%20166%200272>
> > 
> > http://www.geo-solutions.it
> > http://twitter.com/geosolutions_it
> > 
> > -------------------------------------------------------
> > 
> > *AVVERTENZE AI SENSI DEL D.Lgs. 196/2003*
> > 
> > Le informazioni contenute in questo messaggio di posta elettronica e/o
> > nel/i file/s allegato/i sono da considerarsi strettamente riservate. Il
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170110/d8c7becb/attachment-0001.html>

From even.rouault at spatialys.com  Tue Jan 10 05:25:34 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 10 Jan 2017 14:25:34 +0100
Subject: [gdal-dev] EPSG v9.0 upgrade
Message-ID: <3120596.LBnunzVJ1o@even-i700>

Hi,

I've updated to the EPSG v9.0 database.

The relevant tickets are:
* libgeotiff: https://trac.osgeo.org/geotiff/ticket/83
* GDAL: https://trac.osgeo.org/gdal/ticket/6772
* proj.4: proj.4: ​https://github.com/OSGeo/proj.4/issues/477
* postgis: ​https://trac.osgeo.org/postgis/ticket/3684 (patch submitted)

Combined with that update, I've also applied datum shift overrides for EPSG:4149 (CH1903), 
EPSG:3844 (Pulkovo 1942(58) / Stereo70 Romania), EPSG:31251,31252,31253 (MGI (Ferro) / 
Austria), EPSG:2397/2398/2399 (Pulkovo 1942(83) / 3-degree Gauss-Kruger zone 3,4,5), EPSG:
2065 (S-JTSK (Ferro) / Krovak).

Those were awaiting in various GDAL/libgeotif/proj tickets (*), and were not doable until now 
for most of them, since there was no possibility of defining datum shift overrides specific to 
projected coordinate systems, before the changes done in https://trac.osgeo.org/geotiff/
changeset/2747 and
https://trac.osgeo.org/gdal/changeset/37080

Even


(*) From libgeotiff ChangeLog:

2017-01-10 Even Rouault <even dot rouault at spatialys dot com>

	* csv/datum_shift_pref.csv: add overrides for PCS 2065
	(S-JTSK (Ferro) / Krovak)
	Fixes https://trac.osgeo.org/gdal/ticket/4762 and
	https://github.com/OSGeo/proj.4/issues/185

2017-01-10 Even Rouault <even dot rouault at spatialys dot com>

	* csv/datum_shift_pref.csv: add overrides for PCS 2397/2398/2399
	(Pulkovo 1942(83) / 3-degree Gauss-Kruger zone 3,4,5)
	Fixes https://github.com/OSGeo/proj.4/issues/235

2017-01-10 Even Rouault <even dot rouault at spatialys dot com>

	* csv/datum_shift_pref.csv: add overrides for PCS 31251,31252,31253
	(MGI (Ferro) / Austria)
	Fixes https://github.com/OSGeo/proj.4/issues/254

2017-01-10 Even Rouault <even dot rouault at spatialys dot com>

	* csv/build_pcs.py, csv/datum_shift_pref.csv: add mechanism to define
	TOWGS84 parameters per PCS (instead of only relying on the TOWGS84
	parameters of the underlying GCS).
	Add override for EPSG:3844 ("Pulkovo 1942(58) / Stereo70" Romania)
	Fixes https://trac.osgeo.org/geotiff/ticket/52

2017-01-10 Even Rouault <even dot rouault at spatialys dot com>

	* csv/datum_shift_pref.csv: add override for CH1903 (EPSG:4149)
	Fixes https://trac.osgeo.org/geotiff/ticket/73


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170110/80edee37/attachment.html>

From even.rouault at spatialys.com  Tue Jan 10 06:15:05 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 10 Jan 2017 15:15:05 +0100
Subject: [gdal-dev] Anyone interested in resurrecting PHP (7) bindings ?
Message-ID: <10995854.0QTK2cYfLm@even-i700>

Hi,

Seeing https://trac.osgeo.org/gdal/ticket/6770, I realized that we have in-tree 
PHP bindings...
They appear to still build with PHP 5 on an ancient distro, but they are broken 
with PHP 7.

I've tried the attached patch that attempts to use the -php7 flag available in SWIG 
3.0.11 but this still results in build failures (see attached log).

Failing to find anyone interested, we'll have to disable
./configure --with-php

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170110/fb944fed/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: php7.patch
Type: text/x-patch
Size: 2341 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170110/fb944fed/attachment-0001.bin>
-------------- next part --------------
gdal_wrap.cpp:4652:63: error: macro "add_assoc_string" passed 4 arguments, but takes just 3
           add_assoc_string(return_value,keyptr,(char*)valptr,1);
                                                               ^
gdal_wrap.cpp: In function ‘zval* CreateTupleFromDoubleArray(double*, unsigned int)’:
gdal_wrap.cpp:1403:22: error: ‘MAKE_STD_ZVAL’ was not declared in this scope
     MAKE_STD_ZVAL(tmp);
                      ^
gdal_wrap.cpp: In function ‘char* OGRErrMessages(int)’:
gdal_wrap.cpp:1651:12: warning: deprecated conversion from string constant to ‘char*’ [-Wwrite-strings]
     return "OGR Error 0: None";
            ^
gdal_wrap.cpp:1653:12: warning: deprecated conversion from string constant to ‘char*’ [-Wwrite-strings]
     return "OGR Error 1: Not enough data";
            ^
gdal_wrap.cpp:1655:12: warning: deprecated conversion from string constant to ‘char*’ [-Wwrite-strings]
     return "OGR Error 2: Unsupported geometry type";
            ^
gdal_wrap.cpp:1657:12: warning: deprecated conversion from string constant to ‘char*’ [-Wwrite-strings]
     return "OGR Error 3: Unsupported operation";
            ^
gdal_wrap.cpp:1659:12: warning: deprecated conversion from string constant to ‘char*’ [-Wwrite-strings]
     return "OGR Error 4: Corrupt data";
            ^
gdal_wrap.cpp:1661:12: warning: deprecated conversion from string constant to ‘char*’ [-Wwrite-strings]
     return "OGR Error 5: General Error";
            ^
gdal_wrap.cpp:1663:12: warning: deprecated conversion from string constant to ‘char*’ [-Wwrite-strings]
     return "OGR Error 6: Unsupported SRS";
            ^
gdal_wrap.cpp:1665:12: warning: deprecated conversion from string constant to ‘char*’ [-Wwrite-strings]
     return "OGR Error: Unknown";
            ^
gdal_wrap.cpp: In function ‘CPLErr GDALRasterBandShadow_GetHistogram(GDALRasterBandShadow*, double, double, int, int*, int, int, GDALProgressFunc, void*)’:
gdal_wrap.cpp:1868:18: warning: ‘CPLErr GDALGetRasterHistogram(GDALRasterBandH, double, double, int, int*, int, int, GDALProgressFunc, void*)’ is deprecated [-Wdeprecated-declarations]
     CPLErr err = GDALGetRasterHistogram( self, min, max, buckets, panHistogram,
                  ^
In file included from gdal_wrap.cpp:1134:0:
../../gcore/gdal.h:793:28: note: declared here
 CPLErr CPL_DLL CPL_STDCALL GDALGetRasterHistogram( GDALRasterBandH hBand,
                            ^
gdal_wrap.cpp:1868:18: warning: ‘CPLErr GDALGetRasterHistogram(GDALRasterBandH, double, double, int, int*, int, int, GDALProgressFunc, void*)’ is deprecated [-Wdeprecated-declarations]
     CPLErr err = GDALGetRasterHistogram( self, min, max, buckets, panHistogram,
                  ^
In file included from gdal_wrap.cpp:1134:0:
../../gcore/gdal.h:793:28: note: declared here
 CPLErr CPL_DLL CPL_STDCALL GDALGetRasterHistogram( GDALRasterBandH hBand,
                            ^
gdal_wrap.cpp:1870:66: warning: ‘CPLErr GDALGetRasterHistogram(GDALRasterBandH, double, double, int, int*, int, int, GDALProgressFunc, void*)’ is deprecated [-Wdeprecated-declarations]
                                          callback, callback_data );
                                                                  ^
In file included from gdal_wrap.cpp:1134:0:
../../gcore/gdal.h:793:28: note: declared here
 CPLErr CPL_DLL CPL_STDCALL GDALGetRasterHistogram( GDALRasterBandH hBand,
                            ^
gdal_wrap.cpp: In function ‘CPLErr GDALRasterBandShadow_GetDefaultHistogram(GDALRasterBandShadow*, double*, double*, int*, int**, int, GDALProgressFunc, void*)’:
gdal_wrap.cpp:1874:12: warning: ‘CPLErr GDALGetDefaultHistogram(GDALRasterBandH, double*, double*, int*, int**, int, GDALProgressFunc, void*)’ is deprecated [-Wdeprecated-declarations]
     return GDALGetDefaultHistogram( self, min_ret, max_ret, buckets_ret,
            ^
In file included from gdal_wrap.cpp:1134:0:
../../gcore/gdal.h:805:28: note: declared here
 CPLErr CPL_DLL CPL_STDCALL GDALGetDefaultHistogram( GDALRasterBandH hBand,
                            ^
gdal_wrap.cpp:1874:12: warning: ‘CPLErr GDALGetDefaultHistogram(GDALRasterBandH, double*, double*, int*, int**, int, GDALProgressFunc, void*)’ is deprecated [-Wdeprecated-declarations]
     return GDALGetDefaultHistogram( self, min_ret, max_ret, buckets_ret,
            ^
In file included from gdal_wrap.cpp:1134:0:
../../gcore/gdal.h:805:28: note: declared here
 CPLErr CPL_DLL CPL_STDCALL GDALGetDefaultHistogram( GDALRasterBandH hBand,
                            ^
gdal_wrap.cpp:1876:61: warning: ‘CPLErr GDALGetDefaultHistogram(GDALRasterBandH, double*, double*, int*, int**, int, GDALProgressFunc, void*)’ is deprecated [-Wdeprecated-declarations]
                                     callback, callback_data );
                                                             ^
In file included from gdal_wrap.cpp:1134:0:
../../gcore/gdal.h:805:28: note: declared here
 CPLErr CPL_DLL CPL_STDCALL GDALGetDefaultHistogram( GDALRasterBandH hBand,
                            ^
gdal_wrap.cpp: In function ‘CPLErr GDALRasterBandShadow_SetDefaultHistogram(GDALRasterBandShadow*, double, double, int, int*)’:
gdal_wrap.cpp:1879:12: warning: ‘CPLErr GDALSetDefaultHistogram(GDALRasterBandH, double, double, int, int*)’ is deprecated [-Wdeprecated-declarations]
     return GDALSetDefaultHistogram( self, min, max,
            ^
In file included from gdal_wrap.cpp:1134:0:
../../gcore/gdal.h:817:28: note: declared here
 CPLErr CPL_DLL CPL_STDCALL GDALSetDefaultHistogram( GDALRasterBandH hBand,
                            ^
gdal_wrap.cpp:1879:12: warning: ‘CPLErr GDALSetDefaultHistogram(GDALRasterBandH, double, double, int, int*)’ is deprecated [-Wdeprecated-declarations]
     return GDALSetDefaultHistogram( self, min, max,
            ^
In file included from gdal_wrap.cpp:1134:0:
../../gcore/gdal.h:817:28: note: declared here
 CPLErr CPL_DLL CPL_STDCALL GDALSetDefaultHistogram( GDALRasterBandH hBand,
                            ^
gdal_wrap.cpp:1880:44: warning: ‘CPLErr GDALSetDefaultHistogram(GDALRasterBandH, double, double, int, int*)’ is deprecated [-Wdeprecated-declarations]
                buckets_in, panHistogram_in );
                                            ^
In file included from gdal_wrap.cpp:1134:0:
../../gcore/gdal.h:817:28: note: declared here
 CPLErr CPL_DLL CPL_STDCALL GDALSetDefaultHistogram( GDALRasterBandH hBand,
                            ^
In file included from /usr/include/php/20151012/Zend/zend.h:31:0,
                 from gdal_wrap.cpp:748:
gdal_wrap.cpp: In function ‘void _wrap_EscapeString(zend_execute_data*, zval*)’:
/usr/include/php/20151012/Zend/zend_types.h:337:35: error: no match for ‘operator*’ (operand type is ‘zval {aka _zval_struct}’)
 #define Z_TYPE_P(zval_p)   Z_TYPE(*(zval_p))
                                   ^
/usr/include/php/20151012/Zend/zend_types.h:336:41: note: in definition of macro ‘Z_TYPE’
 #define Z_TYPE(zval)    zval_get_type(&(zval))
                                         ^
/usr/include/php/20151012/Zend/zend_operators.h:368:6: note: in expansion of macro ‘Z_TYPE_P’
  if (Z_TYPE_P(pzv)!=upper_type) {     \
      ^
/usr/include/php/20151012/Zend/zend_operators.h:410:35: note: in expansion of macro ‘convert_to_ex_master’
 #define convert_to_string_ex(pzv) convert_to_ex_master(pzv, string, IS_STRING)
                                   ^
gdal_wrap.cpp:3435:5: note: in expansion of macro ‘convert_to_string_ex’
     convert_to_string_ex(args[0]);
     ^
/usr/include/php/20151012/Zend/zend_types.h:337:35: error: no match for ‘operator*’ (operand type is ‘zval {aka _zval_struct}’)
 #define Z_TYPE_P(zval_p)   Z_TYPE(*(zval_p))
                                   ^
/usr/include/php/20151012/Zend/zend_types.h:336:41: note: in definition of macro ‘Z_TYPE’
 #define Z_TYPE(zval)    zval_get_type(&(zval))
                                         ^
/usr/include/php/20151012/Zend/zend_operators.h:274:35: note: in expansion of macro ‘Z_TYPE_P’
 #define convert_to_string(op) if (Z_TYPE_P(op) != IS_STRING) { _convert_to_string((op) ZEND_FILE_LINE_CC); }
                                   ^
/usr/include/php/20151012/Zend/zend_operators.h:369:3: note: in expansion of macro ‘convert_to_string’
   convert_to_##lower_type(pzv);      \
   ^
/usr/include/php/20151012/Zend/zend_operators.h:410:35: note: in expansion of macro ‘convert_to_ex_master’
 #define convert_to_string_ex(pzv) convert_to_ex_master(pzv, string, IS_STRING)
                                   ^
gdal_wrap.cpp:3435:5: note: in expansion of macro ‘convert_to_string_ex’
     convert_to_string_ex(args[0]);
     ^
In file included from /usr/include/php/20151012/Zend/zend.h:341:0,
                 from gdal_wrap.cpp:748:
/usr/include/php/20151012/Zend/zend_operators.h:274:105: error: cannot convert ‘zval {aka _zval_struct}’ to ‘zval* {aka _zval_struct*}’ for argument ‘1’ to ‘void _convert_to_string(zval*)’
 #define convert_to_string(op) if (Z_TYPE_P(op) != IS_STRING) { _convert_to_string((op) ZEND_FILE_LINE_CC); }
                                                                                                         ^
/usr/include/php/20151012/Zend/zend_operators.h:369:3: note: in expansion of macro ‘convert_to_string’
   convert_to_##lower_type(pzv);      \
   ^
/usr/include/php/20151012/Zend/zend_operators.h:410:35: note: in expansion of macro ‘convert_to_ex_master’
 #define convert_to_string_ex(pzv) convert_to_ex_master(pzv, string, IS_STRING)
                                   ^
gdal_wrap.cpp:3435:5: note: in expansion of macro ‘convert_to_string_ex’
     convert_to_string_ex(args[0]);
     ^
gdal_wrap.cpp:3436:31: error: ‘Z_STRVAL_PP’ was not declared in this scope
     arg2 = Z_STRVAL_PP(args[0]);
                               ^
gdal_wrap.cpp:3437:31: error: ‘Z_STRLEN_PP’ was not declared in this scope
     arg1 = Z_STRLEN_PP(args[0]);
                               ^
gdal_wrap.cpp: In function ‘void _wrap_MajorObject_GetMetadata_Dict(zend_execute_data*, zval*)’:
gdal_wrap.cpp:4652:11: error: ‘add_assoc_string’ was not declared in this scope
           add_assoc_string(return_value,keyptr,(char*)valptr,1);
           ^
gdal_wrap.cpp: In function ‘void _wrap_MajorObject_GetMetadata_List(zend_execute_data*, zval*)’:
gdal_wrap.cpp:4707:62: error: too many arguments to function ‘int add_next_index_string(zval*, const char*)’
         add_next_index_string( return_value, *stringarray, 1 );
                                                              ^
In file included from gdal_wrap.cpp:749:0:
/usr/include/php/20151012/Zend/zend_API.h:432:14: note: declared here
 ZEND_API int add_next_index_string(zval *arg, const char *str);
              ^
gdal_wrap.cpp: In function ‘void _wrap_GCPsToGeoTransform(zend_execute_data*, zval*)’:
gdal_wrap.cpp:6850:39: error: cannot convert ‘zval** {aka _zval_struct**}’ to ‘zval* {aka _zval_struct*}’ for argument ‘1’ to ‘void t_output_helper(zval*, zval*)’
     t_output_helper( &return_value, t );
                                       ^
gdal_wrap.cpp: In function ‘void _wrap_Dataset_GetGeoTransform(zend_execute_data*, zval*)’:
gdal_wrap.cpp:7309:39: error: cannot convert ‘zval** {aka _zval_struct**}’ to ‘zval* {aka _zval_struct*}’ for argument ‘1’ to ‘void t_output_helper(zval*, zval*)’
     t_output_helper( &return_value, t );
                                       ^
gdal_wrap.cpp: In function ‘void _wrap_Dataset_GetGCPs(zend_execute_data*, zval*)’:
gdal_wrap.cpp:7535:22: error: ‘MAKE_STD_ZVAL’ was not declared in this scope
     MAKE_STD_ZVAL(out);
                      ^
gdal_wrap.cpp: In function ‘void _wrap_Band_GetRasterCategoryNames(zend_execute_data*, zval*)’:
gdal_wrap.cpp:8364:62: error: too many arguments to function ‘int add_next_index_string(zval*, const char*)’
         add_next_index_string( return_value, *stringarray, 1 );
                                                              ^
In file included from gdal_wrap.cpp:749:0:
/usr/include/php/20151012/Zend/zend_API.h:432:14: note: declared here
 ZEND_API int add_next_index_string(zval *arg, const char *str);
              ^
In file included from /usr/include/php/20151012/Zend/zend.h:31:0,
                 from gdal_wrap.cpp:748:
gdal_wrap.cpp: In function ‘void _wrap_Band_Checksum(zend_execute_data*, zval*)’:
gdal_wrap.cpp:8965:25: error: no match for ‘operator*’ (operand type is ‘zval {aka _zval_struct}’)
       if ( ZVAL_IS_NULL(*args[3]) ) {
                         ^
/usr/include/php/20151012/Zend/zend_types.h:336:41: note: in definition of macro ‘Z_TYPE’
 #define Z_TYPE(zval)    zval_get_type(&(zval))
                                         ^
/usr/include/php/20151012/Zend/zend_API.h:647:26: note: in expansion of macro ‘Z_TYPE_P’
 #define ZVAL_IS_NULL(z) (Z_TYPE_P(z) == IS_NULL)
                          ^
gdal_wrap.cpp:8965:12: note: in expansion of macro ‘ZVAL_IS_NULL’
       if ( ZVAL_IS_NULL(*args[3]) ) {
            ^
/usr/include/php/20151012/Zend/zend_types.h:337:35: error: no match for ‘operator*’ (operand type is ‘zval {aka _zval_struct}’)
 #define Z_TYPE_P(zval_p)   Z_TYPE(*(zval_p))
                                   ^
/usr/include/php/20151012/Zend/zend_types.h:336:41: note: in definition of macro ‘Z_TYPE’
 #define Z_TYPE(zval)    zval_get_type(&(zval))
                                         ^
/usr/include/php/20151012/Zend/zend_operators.h:368:6: note: in expansion of macro ‘Z_TYPE_P’
  if (Z_TYPE_P(pzv)!=upper_type) {     \
      ^
/usr/include/php/20151012/Zend/zend_operators.h:408:34: note: in expansion of macro ‘convert_to_ex_master’
 #define convert_to_long_ex(pzv)  convert_to_ex_master(pzv, long, IS_LONG)
                                  ^
gdal_wrap.cpp:8968:7: note: in expansion of macro ‘convert_to_long_ex’
       convert_to_long_ex(args[3]);
       ^
In file included from /usr/include/php/20151012/Zend/zend.h:341:0,
                 from gdal_wrap.cpp:748:
/usr/include/php/20151012/Zend/zend_operators.h:369:30: error: cannot convert ‘zval {aka _zval_struct}’ to ‘zval* {aka _zval_struct*}’ for argument ‘1’ to ‘void convert_to_long(zval*)’
   convert_to_##lower_type(pzv);      \
                              ^
/usr/include/php/20151012/Zend/zend_operators.h:408:34: note: in expansion of macro ‘convert_to_ex_master’
 #define convert_to_long_ex(pzv)  convert_to_ex_master(pzv, long, IS_LONG)
                                  ^
gdal_wrap.cpp:8968:7: note: in expansion of macro ‘convert_to_long_ex’
       convert_to_long_ex(args[3]);
       ^
gdal_wrap.cpp:8969:39: error: ‘Z_LVAL_PP’ was not declared in this scope
       val4 = (int) Z_LVAL_PP( args[3] );
                                       ^
In file included from /usr/include/php/20151012/Zend/zend.h:31:0,
                 from gdal_wrap.cpp:748:
gdal_wrap.cpp:8976:25: error: no match for ‘operator*’ (operand type is ‘zval {aka _zval_struct}’)
       if ( ZVAL_IS_NULL(*args[4]) ) {
                         ^
/usr/include/php/20151012/Zend/zend_types.h:336:41: note: in definition of macro ‘Z_TYPE’
 #define Z_TYPE(zval)    zval_get_type(&(zval))
                                         ^
/usr/include/php/20151012/Zend/zend_API.h:647:26: note: in expansion of macro ‘Z_TYPE_P’
 #define ZVAL_IS_NULL(z) (Z_TYPE_P(z) == IS_NULL)
                          ^
gdal_wrap.cpp:8976:12: note: in expansion of macro ‘ZVAL_IS_NULL’
       if ( ZVAL_IS_NULL(*args[4]) ) {
            ^
/usr/include/php/20151012/Zend/zend_types.h:337:35: error: no match for ‘operator*’ (operand type is ‘zval {aka _zval_struct}’)
 #define Z_TYPE_P(zval_p)   Z_TYPE(*(zval_p))
                                   ^
/usr/include/php/20151012/Zend/zend_types.h:336:41: note: in definition of macro ‘Z_TYPE’
 #define Z_TYPE(zval)    zval_get_type(&(zval))
                                         ^
/usr/include/php/20151012/Zend/zend_operators.h:368:6: note: in expansion of macro ‘Z_TYPE_P’
  if (Z_TYPE_P(pzv)!=upper_type) {     \
      ^
/usr/include/php/20151012/Zend/zend_operators.h:408:34: note: in expansion of macro ‘convert_to_ex_master’
 #define convert_to_long_ex(pzv)  convert_to_ex_master(pzv, long, IS_LONG)
                                  ^
gdal_wrap.cpp:8979:7: note: in expansion of macro ‘convert_to_long_ex’
       convert_to_long_ex(args[4]);
       ^
In file included from /usr/include/php/20151012/Zend/zend.h:341:0,
                 from gdal_wrap.cpp:748:
/usr/include/php/20151012/Zend/zend_operators.h:369:30: error: cannot convert ‘zval {aka _zval_struct}’ to ‘zval* {aka _zval_struct*}’ for argument ‘1’ to ‘void convert_to_long(zval*)’
   convert_to_##lower_type(pzv);      \
                              ^
/usr/include/php/20151012/Zend/zend_operators.h:408:34: note: in expansion of macro ‘convert_to_ex_master’
 #define convert_to_long_ex(pzv)  convert_to_ex_master(pzv, long, IS_LONG)
                                  ^
gdal_wrap.cpp:8979:7: note: in expansion of macro ‘convert_to_long_ex’
       convert_to_long_ex(args[4]);
       ^
gdal_wrap.cpp:8980:39: error: ‘Z_LVAL_PP’ was not declared in this scope
       val5 = (int) Z_LVAL_PP( args[4] );
                                       ^
gdal_wrap.cpp: In function ‘void _wrap_Band_ComputeRasterMinMax(zend_execute_data*, zval*)’:
gdal_wrap.cpp:9030:39: error: cannot convert ‘zval** {aka _zval_struct**}’ to ‘zval* {aka _zval_struct*}’ for argument ‘1’ to ‘void t_output_helper(zval*, zval*)’
     t_output_helper( &return_value, t );
                                       ^
gdal_wrap.cpp: In function ‘void _wrap_Band_ComputeBandStats(zend_execute_data*, zval*)’:
gdal_wrap.cpp:9074:39: error: cannot convert ‘zval** {aka _zval_struct**}’ to ‘zval* {aka _zval_struct*}’ for argument ‘1’ to ‘void t_output_helper(zval*, zval*)’
     t_output_helper( &return_value, t );
                                       ^
gdal_wrap.cpp: In function ‘void _wrap_Band_GetCategoryNames(zend_execute_data*, zval*)’:
gdal_wrap.cpp:9694:62: error: too many arguments to function ‘int add_next_index_string(zval*, const char*)’
         add_next_index_string( return_value, *stringarray, 1 );
                                                              ^
In file included from gdal_wrap.cpp:749:0:
/usr/include/php/20151012/Zend/zend_API.h:432:14: note: declared here
 ZEND_API int add_next_index_string(zval *arg, const char *str);
              ^
In file included from /usr/include/php/20151012/Zend/zend.h:31:0,
                 from gdal_wrap.cpp:748:
gdal_wrap.cpp: In function ‘void _wrap_RasterAttributeTable_SetValueAsString(zend_execute_data*, zval*)’:
/usr/include/php/20151012/Zend/zend_types.h:337:35: error: no match for ‘operator*’ (operand type is ‘zval {aka _zval_struct}’)
 #define Z_TYPE_P(zval_p)   Z_TYPE(*(zval_p))
                                   ^
/usr/include/php/20151012/Zend/zend_types.h:336:41: note: in definition of macro ‘Z_TYPE’
 #define Z_TYPE(zval)    zval_get_type(&(zval))
                                         ^
/usr/include/php/20151012/Zend/zend_operators.h:368:6: note: in expansion of macro ‘Z_TYPE_P’
  if (Z_TYPE_P(pzv)!=upper_type) {     \
      ^
/usr/include/php/20151012/Zend/zend_operators.h:410:35: note: in expansion of macro ‘convert_to_ex_master’
 #define convert_to_string_ex(pzv) convert_to_ex_master(pzv, string, IS_STRING)
                                   ^
gdal_wrap.cpp:10464:5: note: in expansion of macro ‘convert_to_string_ex’
     convert_to_string_ex(args[3]);
     ^
/usr/include/php/20151012/Zend/zend_types.h:337:35: error: no match for ‘operator*’ (operand type is ‘zval {aka _zval_struct}’)
 #define Z_TYPE_P(zval_p)   Z_TYPE(*(zval_p))
                                   ^
/usr/include/php/20151012/Zend/zend_types.h:336:41: note: in definition of macro ‘Z_TYPE’
 #define Z_TYPE(zval)    zval_get_type(&(zval))
                                         ^
/usr/include/php/20151012/Zend/zend_operators.h:274:35: note: in expansion of macro ‘Z_TYPE_P’
 #define convert_to_string(op) if (Z_TYPE_P(op) != IS_STRING) { _convert_to_string((op) ZEND_FILE_LINE_CC); }
                                   ^
/usr/include/php/20151012/Zend/zend_operators.h:369:3: note: in expansion of macro ‘convert_to_string’
   convert_to_##lower_type(pzv);      \
   ^
/usr/include/php/20151012/Zend/zend_operators.h:410:35: note: in expansion of macro ‘convert_to_ex_master’
 #define convert_to_string_ex(pzv) convert_to_ex_master(pzv, string, IS_STRING)
                                   ^
gdal_wrap.cpp:10464:5: note: in expansion of macro ‘convert_to_string_ex’
     convert_to_string_ex(args[3]);
     ^
In file included from /usr/include/php/20151012/Zend/zend.h:341:0,
                 from gdal_wrap.cpp:748:
/usr/include/php/20151012/Zend/zend_operators.h:274:105: error: cannot convert ‘zval {aka _zval_struct}’ to ‘zval* {aka _zval_struct*}’ for argument ‘1’ to ‘void _convert_to_string(zval*)’
 #define convert_to_string(op) if (Z_TYPE_P(op) != IS_STRING) { _convert_to_string((op) ZEND_FILE_LINE_CC); }
                                                                                                         ^
/usr/include/php/20151012/Zend/zend_operators.h:369:3: note: in expansion of macro ‘convert_to_string’
   convert_to_##lower_type(pzv);      \
   ^
/usr/include/php/20151012/Zend/zend_operators.h:410:35: note: in expansion of macro ‘convert_to_ex_master’
 #define convert_to_string_ex(pzv) convert_to_ex_master(pzv, string, IS_STRING)
                                   ^
gdal_wrap.cpp:10464:5: note: in expansion of macro ‘convert_to_string_ex’
     convert_to_string_ex(args[3]);
     ^
gdal_wrap.cpp:10465:33: error: ‘Z_STRVAL_PP’ was not declared in this scope
     arg4 = Z_STRVAL_PP( args[3] );
                                 ^
gdal_wrap.cpp: In function ‘void _wrap_Transformer_TransformPoint__SWIG_0(zend_execute_data*, zval*)’:
gdal_wrap.cpp:12312:39: error: cannot convert ‘zval** {aka _zval_struct**}’ to ‘zval* {aka _zval_struct*}’ for argument ‘1’ to ‘void t_output_helper(zval*, zval*)’
     t_output_helper( &return_value, t );
                                       ^
gdal_wrap.cpp: In function ‘void _wrap_Transformer_TransformPoint__SWIG_1(zend_execute_data*, zval*)’:
gdal_wrap.cpp:12377:39: error: cannot convert ‘zval** {aka _zval_struct**}’ to ‘zval* {aka _zval_struct*}’ for argument ‘1’ to ‘void t_output_helper(zval*, zval*)’
     t_output_helper( &return_value, t );
                                       ^
gdal_wrap.cpp: In function ‘void _wrap_InvGeoTransform(zend_execute_data*, zval*)’:
gdal_wrap.cpp:12699:39: error: cannot convert ‘zval** {aka _zval_struct**}’ to ‘zval* {aka _zval_struct*}’ for argument ‘1’ to ‘void t_output_helper(zval*, zval*)’
     t_output_helper( &return_value, t );
                                       ^
gdal_wrap.cpp: In function ‘void _wrap_GeneralCmdLineProcessor(zend_execute_data*, zval*)’:
gdal_wrap.cpp:13729:62: error: too many arguments to function ‘int add_next_index_string(zval*, const char*)’
         add_next_index_string( return_value, *stringarray, 1 );
                                                              ^
In file included from gdal_wrap.cpp:749:0:
/usr/include/php/20151012/Zend/zend_API.h:432:14: note: declared here
 ZEND_API int add_next_index_string(zval *arg, const char *str);
              ^
make: *** [gdal_wrap.o] Erreur 1

From even.rouault at spatialys.com  Thu Jan 12 00:08:48 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 12 Jan 2017 09:08:48 +0100
Subject: [gdal-dev] 2.1.3 next week ?
Message-ID: <4219335.ZK3mLPtnN2@even-i700>

Hi,

I'm considering issuing a release candidate for 2.1.3 end of next week.
Anything that should be in it that isn't already ?

16 tickets (perhaps a few more if backported to 2.0.X or 1.11.X) are listed:
https://trac.osgeo.org/gdal/query?status=closed&resolution=fixed&milestone=2.1.3&group=resolution&order=priority

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170112/814cd394/attachment.html>

From schwehr at gmail.com  Thu Jan 12 00:43:25 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Thu, 12 Jan 2017 00:43:25 -0800
Subject: [gdal-dev] 2.1.3 next week ?
In-Reply-To: <4219335.ZK3mLPtnN2@even-i700>
References: <4219335.ZK3mLPtnN2@even-i700>
Message-ID: <CACmBxysYZqoC8Wp3AAm+Ysb_RhTGdU=0XXNgDB+=bUOJJq8M1A@mail.gmail.com>

I just got a copy of Kakadu v7.9 this week.  I need to see if GDAL needs
any patches for it, but I don't think it does.

On Thu, Jan 12, 2017 at 12:08 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
>
>
> I'm considering issuing a release candidate for 2.1.3 end of next week.
>
> Anything that should be in it that isn't already ?
>
>
>
> 16 tickets (perhaps a few more if backported to 2.0.X or 1.11.X) are
> listed:
>
> https://trac.osgeo.org/gdal/query?status=closed&
> resolution=fixed&milestone=2.1.3&group=resolution&order=priority
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170112/b4eba987/attachment.html>

From johan.de.braak at eleaf.com  Thu Jan 12 04:06:55 2017
From: johan.de.braak at eleaf.com (Johan de Braak)
Date: Thu, 12 Jan 2017 05:06:55 -0700 (MST)
Subject: [gdal-dev] gdal.DEMProcessingOptions
Message-ID: <1484222815295-5303172.post@n6.nabble.com>

Running: 
opts = gdal.DEMProcessingOptions(zeroForFlat=True)
gdal.DEMProcessing('my\out\file_aspect.tif', 'my\in\dem.tif', 'aspect',
options=opts)

resuts in the error:

Too many command options 'zero_for_flat'

However, if I run it as:

opts = ['-zero_for_flat']
gdal.DEMProcessing('my\out\file_aspect.tif', 'my\in\dem.tif', 'aspect',
options=opts)

It runs fine. Any ideas what may cause this?





--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-DEMProcessingOptions-tp5303172.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Thu Jan 12 04:16:02 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 12 Jan 2017 13:16:02 +0100
Subject: [gdal-dev] gdal.DEMProcessingOptions
In-Reply-To: <1484222815295-5303172.post@n6.nabble.com>
References: <1484222815295-5303172.post@n6.nabble.com>
Message-ID: <12909124.7sgtiEUlF6@even-i700>

> Any ideas what may cause this?

Yes, a typo...

I just fixed it per
https://trac.osgeo.org/gdal/ticket/6775

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170112/2e2bd04d/attachment.html>

From bontepaarden at gmail.com  Thu Jan 12 06:12:40 2017
From: bontepaarden at gmail.com (Paul Meems)
Date: Thu, 12 Jan 2017 15:12:40 +0100
Subject: [gdal-dev] Simple band calculations
Message-ID: <CAHNf2YRH4aK-GdQOzB90LNrS_2Q6quTdtGOcXaphDRK+We8o6Q@mail.gmail.com>

Hi list,

I have a 5 band GeoTiff and I want to derive a new image of it by doing
some simple band calculations. For example (band5-band3) / (band5+band3).
I was hoping I could do this with a VRT file, but can't find an example.
I did found details about GDAL Algebra and Pixel Functions, but I'm not
sure if I need those.

I'm a on the right track or should I create a new raster file and calculate
pixel for pixel?
The input file is 120MB - 250MB and I will need several derived images.
Using VRT files will help me keeping the disk space manageable.

Thanks,

Paul
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170112/20ce133a/attachment.html>

From gdt at lexort.com  Thu Jan 12 08:57:13 2017
From: gdt at lexort.com (Greg Troxel)
Date: Thu, 12 Jan 2017 11:57:13 -0500
Subject: [gdal-dev] C++11 timeline
In-Reply-To: <CACmBxytE3aPgAB6WyoaOLZBt+t682OoaykP9LkV7jFsA--x66g@mail.gmail.com>
 (Kurt Schwehr's message of "Thu, 5 Jan 2017 20:19:50 -0800")
References: <CACmBxysv7H=MP1iV+O=sHfh4Z8teuuvic7mgQrGiSmpeC_fmcw@mail.gmail.com>
 <CACmBxyt4nE1Z_gCPOgUiOe=jNOg6us7kKE5uz0QeAYKQ8g4ypQ@mail.gmail.com>
 <02524FED-7022-4C4B-9664-A48A9A5D2F91@hobu.co>
 <22828021.y404zajIpn@even-i700> <smu8tqoc3it.fsf@linuxpal.mit.edu>
 <CACmBxytE3aPgAB6WyoaOLZBt+t682OoaykP9LkV7jFsA--x66g@mail.gmail.com>
Message-ID: <smulgugp66u.fsf@linuxpal.mit.edu>


Kurt Schwehr <schwehr at gmail.com> writes:

> Greg,
>
> Can you explain the use case as to what keeps you on an older NetBSD but
> unable to use a branch of a recent GDAL?  e.g. I'm am suggesting that we
> keep GDAL 2.1 and older to stay with the current requirement of supporting
> C++03.

That is probably ok.  I should point out that I'm coming at this as a
packager - I look after a number of geo packages in pkgsrc, which
supports multiple versions of multiple operating systems, causing it to
run into more portability issues than packages for a particular Linux
distribution.  (My actual use of GDAL is so far not extensive and I can
certainly run it on a newer release.)

My concern is really that once there is a GDAL release that needs a
newer compiler, then some other program will require that version of
GDAL.  As a packager, I more or less have to decide whether to update
each program, balancing users getting new stuff and
stability/portability.

If no other packages start to depend on unreleased GDAL, and the first
GDAL release requiring C++11 is a ways off, and by then enough other
things require it that a system not having a C++11 compiler is totally
non-viable, then this shouldn't cause problems for pkgsrc.

> As for boost, my experiences are that would be far more effort support it
> on many platforms than getting a working C++11 compiler.  Boost is full of
> really awesome code, but there be dragons and really careful consideration
> should be made before requiring boost for any code that will have to be
> linked against by other libraries.

OK - thanks for explaining.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 162 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170112/6a57ace2/attachment.sig>

From schwehr at gmail.com  Thu Jan 12 12:04:20 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Thu, 12 Jan 2017 12:04:20 -0800
Subject: [gdal-dev] C++11 timeline
In-Reply-To: <smulgugp66u.fsf@linuxpal.mit.edu>
References: <CACmBxysv7H=MP1iV+O=sHfh4Z8teuuvic7mgQrGiSmpeC_fmcw@mail.gmail.com>
 <CACmBxyt4nE1Z_gCPOgUiOe=jNOg6us7kKE5uz0QeAYKQ8g4ypQ@mail.gmail.com>
 <02524FED-7022-4C4B-9664-A48A9A5D2F91@hobu.co> <22828021.y404zajIpn@even-i700>
 <smu8tqoc3it.fsf@linuxpal.mit.edu>
 <CACmBxytE3aPgAB6WyoaOLZBt+t682OoaykP9LkV7jFsA--x66g@mail.gmail.com>
 <smulgugp66u.fsf@linuxpal.mit.edu>
Message-ID: <CACmBxyv_epVDGrjbqEp_UUGpqnX_5TZPSU6kpUBc-Nd+V9s_rg@mail.gmail.com>

Thanks Gred and Andrew!  Those are exactly the kind of comments that help.

Greg,

I have lots of experience packaging GDAL in fink for the mac, but less
elsewhere.  I found this like which implies that pkgsrc is at GDAL 1.11.3.
Are there better links?

- http://pkgsrc.se/geography/gdal-lib
- https://github.com/joyent/pkgsrc/blob/trunk/geography/gdal-lib/Makefile

On Thu, Jan 12, 2017 at 8:57 AM, Greg Troxel <gdt at lexort.com> wrote:

>
> Kurt Schwehr <schwehr at gmail.com> writes:
>
> > Greg,
> >
> > Can you explain the use case as to what keeps you on an older NetBSD but
> > unable to use a branch of a recent GDAL?  e.g. I'm am suggesting that we
> > keep GDAL 2.1 and older to stay with the current requirement of
> supporting
> > C++03.
>
> That is probably ok.  I should point out that I'm coming at this as a
> packager - I look after a number of geo packages in pkgsrc, which
> supports multiple versions of multiple operating systems, causing it to
> run into more portability issues than packages for a particular Linux
> distribution.  (My actual use of GDAL is so far not extensive and I can
> certainly run it on a newer release.)
>
> My concern is really that once there is a GDAL release that needs a
> newer compiler, then some other program will require that version of
> GDAL.  As a packager, I more or less have to decide whether to update
> each program, balancing users getting new stuff and
> stability/portability.
>
> If no other packages start to depend on unreleased GDAL, and the first
> GDAL release requiring C++11 is a ways off, and by then enough other
> things require it that a system not having a C++11 compiler is totally
> non-viable, then this shouldn't cause problems for pkgsrc.
>
> > As for boost, my experiences are that would be far more effort support it
> > on many platforms than getting a working C++11 compiler.  Boost is full
> of
> > really awesome code, but there be dragons and really careful
> consideration
> > should be made before requiring boost for any code that will have to be
> > linked against by other libraries.
>
> OK - thanks for explaining.
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170112/f67474a0/attachment.html>

From nyall.dawson at gmail.com  Thu Jan 12 12:42:26 2017
From: nyall.dawson at gmail.com (Nyall Dawson)
Date: Fri, 13 Jan 2017 06:42:26 +1000
Subject: [gdal-dev] C++11 timeline
In-Reply-To: <smulgugp66u.fsf@linuxpal.mit.edu>
References: <CACmBxysv7H=MP1iV+O=sHfh4Z8teuuvic7mgQrGiSmpeC_fmcw@mail.gmail.com>
 <CACmBxyt4nE1Z_gCPOgUiOe=jNOg6us7kKE5uz0QeAYKQ8g4ypQ@mail.gmail.com>
 <02524FED-7022-4C4B-9664-A48A9A5D2F91@hobu.co> <22828021.y404zajIpn@even-i700>
 <smu8tqoc3it.fsf@linuxpal.mit.edu>
 <CACmBxytE3aPgAB6WyoaOLZBt+t682OoaykP9LkV7jFsA--x66g@mail.gmail.com>
 <smulgugp66u.fsf@linuxpal.mit.edu>
Message-ID: <CAB28AshJg_w7J7qVzFkpsnh1QTKMpHmnN7LUTWsTur-OJfxE_Q@mail.gmail.com>

On 13 January 2017 at 02:57, Greg Troxel <gdt at lexort.com> wrote:
>
> Kurt Schwehr <schwehr at gmail.com> writes:
>
> If no other packages start to depend on unreleased GDAL, and the first
> GDAL release requiring C++11 is a ways off, and by then enough other
> things require it that a system not having a C++11 compiler is totally
> non-viable, then this shouldn't cause problems for pkgsrc.
>

FYI - the upcoming QGIS 3.0 release has a hard c++11 requirement. Not
sure how much that affects things, but certainly projects which
utilise GDAL are already switching to c++11.

Nyall

From schwehr at gmail.com  Thu Jan 12 14:58:47 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Thu, 12 Jan 2017 14:58:47 -0800
Subject: [gdal-dev] 2.1.3 next week ?
In-Reply-To: <CACmBxysYZqoC8Wp3AAm+Ysb_RhTGdU=0XXNgDB+=bUOJJq8M1A@mail.gmail.com>
References: <4219335.ZK3mLPtnN2@even-i700>
 <CACmBxysYZqoC8Wp3AAm+Ysb_RhTGdU=0XXNgDB+=bUOJJq8M1A@mail.gmail.com>
Message-ID: <CACmBxyu2Na+4nPHoAqqLgkz7=TQ2EAgW9VpUcRr1Fqxi_8+2gw@mail.gmail.com>

I didn't need to do anything to build with kakadu 7.9 (with something close
to trunk), so +1 from me for a release.

On Thu, Jan 12, 2017 at 12:43 AM, Kurt Schwehr <schwehr at gmail.com> wrote:

> I just got a copy of Kakadu v7.9 this week.  I need to see if GDAL needs
> any patches for it, but I don't think it does.
>
> On Thu, Jan 12, 2017 at 12:08 AM, Even Rouault <even.rouault at spatialys.com
> > wrote:
>
>> Hi,
>>
>>
>>
>> I'm considering issuing a release candidate for 2.1.3 end of next week.
>>
>> Anything that should be in it that isn't already ?
>>
>>
>>
>> 16 tickets (perhaps a few more if backported to 2.0.X or 1.11.X) are
>> listed:
>>
>> https://trac.osgeo.org/gdal/query?status=closed&resolution=
>> fixed&milestone=2.1.3&group=resolution&order=priority
>>
>>
>>
>> Even
>>
>>
>>
>> --
>>
>> Spatialys - Geospatial professional services
>>
>> http://www.spatialys.com
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>
> --
> --
> http://schwehr.org
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170112/7461b6e1/attachment.html>

From andrew.bell.ia at gmail.com  Thu Jan 12 15:10:39 2017
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Thu, 12 Jan 2017 17:10:39 -0600
Subject: [gdal-dev] C++11 timeline
In-Reply-To: <CAB28AshJg_w7J7qVzFkpsnh1QTKMpHmnN7LUTWsTur-OJfxE_Q@mail.gmail.com>
References: <CACmBxysv7H=MP1iV+O=sHfh4Z8teuuvic7mgQrGiSmpeC_fmcw@mail.gmail.com>
 <CACmBxyt4nE1Z_gCPOgUiOe=jNOg6us7kKE5uz0QeAYKQ8g4ypQ@mail.gmail.com>
 <02524FED-7022-4C4B-9664-A48A9A5D2F91@hobu.co> <22828021.y404zajIpn@even-i700>
 <smu8tqoc3it.fsf@linuxpal.mit.edu>
 <CACmBxytE3aPgAB6WyoaOLZBt+t682OoaykP9LkV7jFsA--x66g@mail.gmail.com>
 <smulgugp66u.fsf@linuxpal.mit.edu>
 <CAB28AshJg_w7J7qVzFkpsnh1QTKMpHmnN7LUTWsTur-OJfxE_Q@mail.gmail.com>
Message-ID: <CACJ51z3b931ogJ8AeNiH0wiaNo+72brvjPw=XiyA1_Y-VuA9tQ@mail.gmail.com>

There's a lot of code to work on.  Would it make sense just to make a C++11
branch and get to work, merging into master whenever it seems the right
time?

On Thu, Jan 12, 2017 at 2:42 PM, Nyall Dawson <nyall.dawson at gmail.com>
wrote:

> On 13 January 2017 at 02:57, Greg Troxel <gdt at lexort.com> wrote:
> >
> > Kurt Schwehr <schwehr at gmail.com> writes:
> >
> > If no other packages start to depend on unreleased GDAL, and the first
> > GDAL release requiring C++11 is a ways off, and by then enough other
> > things require it that a system not having a C++11 compiler is totally
> > non-viable, then this shouldn't cause problems for pkgsrc.
> >
>
> FYI - the upcoming QGIS 3.0 release has a hard c++11 requirement. Not
> sure how much that affects things, but certainly projects which
> utilise GDAL are already switching to c++11.
>
> Nyall
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170112/0ccbb0ba/attachment.html>

From schwehr at gmail.com  Thu Jan 12 16:02:30 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Thu, 12 Jan 2017 16:02:30 -0800
Subject: [gdal-dev] C++11 timeline
In-Reply-To: <CACJ51z3b931ogJ8AeNiH0wiaNo+72brvjPw=XiyA1_Y-VuA9tQ@mail.gmail.com>
References: <CACmBxysv7H=MP1iV+O=sHfh4Z8teuuvic7mgQrGiSmpeC_fmcw@mail.gmail.com>
 <CACmBxyt4nE1Z_gCPOgUiOe=jNOg6us7kKE5uz0QeAYKQ8g4ypQ@mail.gmail.com>
 <02524FED-7022-4C4B-9664-A48A9A5D2F91@hobu.co> <22828021.y404zajIpn@even-i700>
 <smu8tqoc3it.fsf@linuxpal.mit.edu>
 <CACmBxytE3aPgAB6WyoaOLZBt+t682OoaykP9LkV7jFsA--x66g@mail.gmail.com>
 <smulgugp66u.fsf@linuxpal.mit.edu>
 <CAB28AshJg_w7J7qVzFkpsnh1QTKMpHmnN7LUTWsTur-OJfxE_Q@mail.gmail.com>
 <CACJ51z3b931ogJ8AeNiH0wiaNo+72brvjPw=XiyA1_Y-VuA9tQ@mail.gmail.com>
Message-ID: <CACmBxyvkDxXNZEM+sWvR-GvvzeGBzpUYMJLXGN5sZSV-AMT1TQ@mail.gmail.com>

That's a possibility, but as longs as we require most of the code base to
work with C++03, merging is going to be miserable.  I'm suggesting we flip
the requirement but make no immediate changes.  GDAL builds cleanly with
C++11 and C++14 right now, so it's just a matter of flipping the
requirement and then deciding what and when we allow things to switch to
new C++11 idiums.  Initially, we can start by getting rid of ifdefs and
doing a quick NULL -> nullptr (which is how gdal builds for me anyway with
NULL defined to be nullptr).

On Thu, Jan 12, 2017 at 3:10 PM, Andrew Bell <andrew.bell.ia at gmail.com>
wrote:

> There's a lot of code to work on.  Would it make sense just to make a
> C++11 branch and get to work, merging into master whenever it seems the
> right time?
>
> On Thu, Jan 12, 2017 at 2:42 PM, Nyall Dawson <nyall.dawson at gmail.com>
> wrote:
>
>> On 13 January 2017 at 02:57, Greg Troxel <gdt at lexort.com> wrote:
>> >
>> > Kurt Schwehr <schwehr at gmail.com> writes:
>> >
>> > If no other packages start to depend on unreleased GDAL, and the first
>> > GDAL release requiring C++11 is a ways off, and by then enough other
>> > things require it that a system not having a C++11 compiler is totally
>> > non-viable, then this shouldn't cause problems for pkgsrc.
>> >
>>
>> FYI - the upcoming QGIS 3.0 release has a hard c++11 requirement. Not
>> sure how much that affects things, but certainly projects which
>> utilise GDAL are already switching to c++11.
>>
>> Nyall
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>
> --
> Andrew Bell
> andrew.bell.ia at gmail.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170112/5b9afc08/attachment-0001.html>

From gdt at lexort.com  Thu Jan 12 17:55:53 2017
From: gdt at lexort.com (Greg Troxel)
Date: Thu, 12 Jan 2017 20:55:53 -0500
Subject: [gdal-dev] C++11 timeline
In-Reply-To: <CACmBxyv_epVDGrjbqEp_UUGpqnX_5TZPSU6kpUBc-Nd+V9s_rg@mail.gmail.com>
 (Kurt Schwehr's message of "Thu, 12 Jan 2017 12:04:20 -0800")
References: <CACmBxysv7H=MP1iV+O=sHfh4Z8teuuvic7mgQrGiSmpeC_fmcw@mail.gmail.com>
 <CACmBxyt4nE1Z_gCPOgUiOe=jNOg6us7kKE5uz0QeAYKQ8g4ypQ@mail.gmail.com>
 <02524FED-7022-4C4B-9664-A48A9A5D2F91@hobu.co>
 <22828021.y404zajIpn@even-i700> <smu8tqoc3it.fsf@linuxpal.mit.edu>
 <CACmBxytE3aPgAB6WyoaOLZBt+t682OoaykP9LkV7jFsA--x66g@mail.gmail.com>
 <smulgugp66u.fsf@linuxpal.mit.edu>
 <CACmBxyv_epVDGrjbqEp_UUGpqnX_5TZPSU6kpUBc-Nd+V9s_rg@mail.gmail.com>
Message-ID: <smu8tqfpvti.fsf@linuxpal.mit.edu>


Kurt Schwehr <schwehr at gmail.com> writes:

> Thanks Gred and Andrew!  Those are exactly the kind of comments that help.
>
> Greg,
>
> I have lots of experience packaging GDAL in fink for the mac, but less
> elsewhere.  I found this like which implies that pkgsrc is at GDAL 1.11.3.
> Are there better links?

Yes, it's behind, for no good reason.  I need to update it.  I might
have tried and found it non-trivial, but I don't remember clearly.

> - http://pkgsrc.se/geography/gdal-lib

That's a good link. Canonical http pointer at:
   http://cvsweb.netbsd.org/bsdweb.cgi/pkgsrc/geography/gdal-lib/

Also, this shows build status on a lot of platforms (but a small
fraction of the set pkgsrc is intended to work on):

  https://bulktracker.appspot.com/pkgresults/geography/gdal-lib

> - https://github.com/joyent/pkgsrc/blob/trunk/geography/gdal-lib/Makefile

That's a soft fork, intending to have a few diffs but not much.  The
vast majority of things are the same, especially normal packages like
gdal-lib.



-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 162 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170112/e1c6d65c/attachment.sig>

From jef at norbit.de  Fri Jan 13 01:18:30 2017
From: jef at norbit.de (=?iso-8859-1?B?SvxyZ2VuIEUu?= Fischer)
Date: Fri, 13 Jan 2017 10:18:30 +0100
Subject: [gdal-dev] C++11 timeline
In-Reply-To: <CAB28AshJg_w7J7qVzFkpsnh1QTKMpHmnN7LUTWsTur-OJfxE_Q@mail.gmail.com>
References: <CACmBxysv7H=MP1iV+O=sHfh4Z8teuuvic7mgQrGiSmpeC_fmcw@mail.gmail.com>
 <CACmBxyt4nE1Z_gCPOgUiOe=jNOg6us7kKE5uz0QeAYKQ8g4ypQ@mail.gmail.com>
 <02524FED-7022-4C4B-9664-A48A9A5D2F91@hobu.co>
 <22828021.y404zajIpn@even-i700> <smu8tqoc3it.fsf@linuxpal.mit.edu>
 <CACmBxytE3aPgAB6WyoaOLZBt+t682OoaykP9LkV7jFsA--x66g@mail.gmail.com>
 <smulgugp66u.fsf@linuxpal.mit.edu>
 <CAB28AshJg_w7J7qVzFkpsnh1QTKMpHmnN7LUTWsTur-OJfxE_Q@mail.gmail.com>
Message-ID: <20170113091830.GA6180@norbit.de>

Hi,

On Fri, 13. Jan 2017 at 06:42:26 +1000, Nyall Dawson wrote:
> FYI - the upcoming QGIS 3.0 release has a hard c++11 requirement. Not
> sure how much that affects things, but certainly projects which
> utilise GDAL are already switching to c++11.

We're not using the C++ API - so that shouldn't matter.


Jürgen

-- 
Jürgen E. Fischer           norBIT GmbH             Tel. +49-4931-918175-31
Dipl.-Inf. (FH)             Rheinstraße 13          Fax. +49-4931-918175-50
Software Engineer           D-26506 Norden             http://www.norbit.de
QGIS release manager (PSC)  Germany                    IRC: jef on FreeNode                         
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 827 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170113/ac6c91a5/attachment.sig>

From damian.dixon at gmail.com  Fri Jan 13 02:01:37 2017
From: damian.dixon at gmail.com (Damian Dixon)
Date: Fri, 13 Jan 2017 10:01:37 +0000
Subject: [gdal-dev] C++11 timeline
In-Reply-To: <smu8tqfpvti.fsf@linuxpal.mit.edu>
References: <CACmBxysv7H=MP1iV+O=sHfh4Z8teuuvic7mgQrGiSmpeC_fmcw@mail.gmail.com>
 <CACmBxyt4nE1Z_gCPOgUiOe=jNOg6us7kKE5uz0QeAYKQ8g4ypQ@mail.gmail.com>
 <02524FED-7022-4C4B-9664-A48A9A5D2F91@hobu.co> <22828021.y404zajIpn@even-i700>
 <smu8tqoc3it.fsf@linuxpal.mit.edu>
 <CACmBxytE3aPgAB6WyoaOLZBt+t682OoaykP9LkV7jFsA--x66g@mail.gmail.com>
 <smulgugp66u.fsf@linuxpal.mit.edu>
 <CACmBxyv_epVDGrjbqEp_UUGpqnX_5TZPSU6kpUBc-Nd+V9s_rg@mail.gmail.com>
 <smu8tqfpvti.fsf@linuxpal.mit.edu>
Message-ID: <CAJjdW1wAz6us5PN4iOR3tAnTDS0YLhJ96w8JC8tbmE-xGC5g3g@mail.gmail.com>

Hi,

We are actively using GDAL on WIndows, Linux and Android to deal with GIS
data reading gaps.

Currently we are constrained to using 'gcc 4.7' on Linux, which gives us a
lot of C++11 that we currently want to use.

On Windows we have switched to Visual Studio 2015.

On Android we will probably use the latest.

One of the reasons we tend to lag on compilers is due to needing to support
customers on older Operating Systems as well as the usual reluctance to
upgrade a compiler because of knock-on to system test costs.

That's not to say don't use new features of C++ or the library, just bear
in mind the potential knock on.

One of the ways we have dealt with this potential knock-on is to use boost
to provide many of the missing library features we are using.

We switch based on cmake tests between boost and the supplied libraries.

We have found the following very helpful from C++11 (and older):

   - shared_ptr
   - unique_ptr
   - nullptr
   - unordered_map
   - std::thread
   - std::nothrow for memory allocation

shared_ptr and unique_ptr make the management of allocated memory so much
less error prone, so the use internally, even if the API is not changed,
would be a bonus.

To be honest, if needed, we will just update the compilers we use to the
minimum required.

Regards
Damian



On 13 January 2017 at 01:55, Greg Troxel <gdt at lexort.com> wrote:

>
> Kurt Schwehr <schwehr at gmail.com> writes:
>
> > Thanks Gred and Andrew!  Those are exactly the kind of comments that
> help.
> >
> > Greg,
> >
> > I have lots of experience packaging GDAL in fink for the mac, but less
> > elsewhere.  I found this like which implies that pkgsrc is at GDAL
> 1.11.3.
> > Are there better links?
>
> Yes, it's behind, for no good reason.  I need to update it.  I might
> have tried and found it non-trivial, but I don't remember clearly.
>
> > - http://pkgsrc.se/geography/gdal-lib
>
> That's a good link. Canonical http pointer at:
>    http://cvsweb.netbsd.org/bsdweb.cgi/pkgsrc/geography/gdal-lib/
>
> Also, this shows build status on a lot of platforms (but a small
> fraction of the set pkgsrc is intended to work on):
>
>   https://bulktracker.appspot.com/pkgresults/geography/gdal-lib
>
> > - https://github.com/joyent/pkgsrc/blob/trunk/geography/
> gdal-lib/Makefile
>
> That's a soft fork, intending to have a few diffs but not much.  The
> vast majority of things are the same, especially normal packages like
> gdal-lib.
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170113/4a1aff74/attachment.html>

From jmckenna at gatewaygeomatics.com  Fri Jan 13 05:46:15 2017
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Fri, 13 Jan 2017 09:46:15 -0400
Subject: [gdal-dev] 2.1.3 next week ?
In-Reply-To: <4219335.ZK3mLPtnN2@even-i700>
References: <4219335.ZK3mLPtnN2@even-i700>
Message-ID: <bf9aa929-42fc-0454-2712-2914169b8b32@gatewaygeomatics.com>

+1 for 2.1.3 release

-jeff


-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/



On 2017-01-12 4:08 AM, Even Rouault wrote:
> Hi,
>
>
>
> I'm considering issuing a release candidate for 2.1.3 end of next week.
>
> Anything that should be in it that isn't already ?
>
>
>
> 16 tickets (perhaps a few more if backported to 2.0.X or 1.11.X) are listed:
>
> https://trac.osgeo.org/gdal/query?status=closed&resolution=fixed&milestone=2.1.3&group=resolution&order=priority
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
>

From Alexander.Berdnikow at mettenmeier.de  Fri Jan 13 07:54:55 2017
From: Alexander.Berdnikow at mettenmeier.de (Alexander.Berdnikow at mettenmeier.de)
Date: Fri, 13 Jan 2017 16:54:55 +0100
Subject: [gdal-dev] PostGIS with more than one geometry column per table |
	R-Trees
Message-ID: <OFEA0DB003.A05ED9B9-ONC12580A7.005589EB-C12580A7.00576CDE@mettenmeier.de>

Hi, 

sorry, there is a half copy of this post in the forum already, which was 
not accepted by the maillist. 

I translated a Table (Feature) of a PostGIS Database to a GeoPackage with 
GDAL. The Feature has two Linestring Geometries in the PostGIS DB. One 
geometry with exact positions of the network and one overwiew geometry 
which may have just rough positions. Often the overwiew ist just a copy of 
the exact positions, but sometimes it differs. 

After translation of the feature to GeoPackage everything seems fine, but 
in the GeoPackage I have only one Linestring geometry. It is listed in the 
gpkg_geometry_columns. 

My question is, which of the two geometries was translated to the 
GeoPackage? What happens to the other geometries of the feature in the 
translation process? 

I've read about the solution of the multiple geometries issue in 
GeoPackage in the GP-specification. Does GDAL support this in the 
translation process (maybe with a special option?)? 

______

A first solution for us was to use a View Schema, where each feature has 
only one geometry. Now I have two schemas in the PostGIS DB and they were 
both translated. Two questions about it:

- Is there a command to say which schemas to translate and which not? My 
command is now as follows:
ogr2ogr -f GPKG data.gpkg PG:"host=localhost user=user dbname=data 
password=pw" 

I found options to select tables, but there are hundreds of tables in the 
schema I am interested in. Maybe there is an easy  possibility to say 
"take only schema x"? Did not found it in the list 
http://www.gdal.org/ogr2ogr.html

- How can I supress the building of r-tree tables? There are virtually 
thousands of them in the created geopackage. 

Regards, 

Alexander 

_______________________________________________________

Mettenmeier GmbH
Sitz der Gesellschaft: 33100 Paderborn
Geschaeftsfuehrung: Ulrich Mettenmeier, Dirk Weidemann
Handelsregister: Amtsgericht Paderborn B 1114
USt.-ID: DE 811 324 124
Steuer-Nr.: 339/5873/3133
_______________________________________________________
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170113/13df93a3/attachment-0001.html>

From rayg at daylongraphics.com  Fri Jan 13 15:08:54 2017
From: rayg at daylongraphics.com (Ray Gardener)
Date: Fri, 13 Jan 2017 15:08:54 -0800
Subject: [gdal-dev] Usage of GDAL_FILENAME_IS_UTF8 config option
In-Reply-To: <CAJjdW1y4HcuptZ+w2DfyksvYsM+30GZidbSctx+u4zBcYimo6g@mail.gmail.com>
References: <3E55146A6A81B44A9CB69CAB65908CEA4C69EFB4@TW-MBX-P03.cnesnet.ad.cnes.fr>
 <CAJjdW1y4HcuptZ+w2DfyksvYsM+30GZidbSctx+u4zBcYimo6g@mail.gmail.com>
Message-ID: <20b54e38-f61c-6be6-072d-32d757ec5314@daylongraphics.com>

Just to add a small note regarding OS X (and iOS) and UTF-8 filenames: 
The HFS+ filesystem stores accented characters in decomposed form, which 
can differ from the filename given to an API that creates the file such 
as fopen(..., "wb").

Applications that store a filename (e.g. into a preference or MRU file) 
might store it in precomposed form, which won't match what the 
filesystem uses and risks a file-not-found error. e.g. on iOS, text 
input gives strings in precomposed form.

More info is available at
http://stackoverflow.com/questions/6153345/different-utf8-encoding-in-filenames-os-x

Ray



On 1/9/2017, Monday 2:03 AM, Damian Dixon wrote:
> Hi Victor,
>
> If you set GDAL_FILENAME_IS_UTF8 to YES then you need to pass in 
> filenames and paths encoded as UTF8.
>
> This means that on Windows you will need to do additional work to 
> convert from MBCS or UTF16/UCS2 to UTF8.
>
> If your application is built as MBCS then what you essentially have is 
> a multi-byte string encoding which is the Windows local code page.
>
> If your application is built for Unicode then you have UTF16/UCS2 so 
> you have to convert the filenames to UTF8 for GDAL/OGR to work.
>
> If you save the filenames as part of an application specific 
> configuration then you need to consider how you will read read that 
> data back in if the Windows code page changes. This is not an easy 
> task unless you also save the code page as well. It also becomes a bit 
> of a mess supporting this on non-Windows.
>
> The approach we took was to convert our Windows applications to 
> Unicode and store/use all paths/filenames as UTF8 for portability to 
> Linux/Android/Solaris.
>
> Regards
> Damian
>
> PS. Microsoft has deprecated MBCS build of MFC.
>
>
>
> On 9 January 2017 at 09:31, Poughon Victor <Victor.Poughon at cnes.fr 
> <mailto:Victor.Poughon at cnes.fr>> wrote:
>
>     Hi,
>
>     We are using GDAL in OTB and recently we had a bug report about
>     opening non
>     ASCII filenames on Windows 10 [0]. They suggest a fix using:
>
>     > CPLSetConfigOption("GDAL_FILENAME_IS_UTF8","NO");
>
>     The test case is GDALOpen() on a file named 你好.tif, which I
>     confirmed works
>     fine on Linux, but not on Windows 7 or 10.
>
>     So my question is to have some clarification on this option, to
>     know if it's
>     potentially the correct fix for this problem. The doc says:
>
>     > This effectively restores the pre-GDAL1.8 behavior for handling
>     filenames on
>     > Windows and might be appropriate for applications that treat
>     filenames as
>     > being in the local encoding.
>
>     What does it mean exactly to consider filenames to be in the local
>     encoding? And
>     how do I know if my application [1] does that?
>
>     Cheers,
>
>     [0] https://github.com/orfeotoolbox/OTB/pull/14
>     <https://github.com/orfeotoolbox/OTB/pull/14>
>     [1]
>     https://github.com/janestar/OTB/blob/f6ffdc17ab3d7aa91726f03ed619fee806eb508a/Modules/IO/IOGDAL/src/otbGDALDriverManagerWrapper.cxx#L55
>     <https://github.com/janestar/OTB/blob/f6ffdc17ab3d7aa91726f03ed619fee806eb508a/Modules/IO/IOGDAL/src/otbGDALDriverManagerWrapper.cxx#L55>
>
>     Victor Poughon
>
>
>
>
>     _______________________________________________
>     gdal-dev mailing list
>     gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>     http://lists.osgeo.org/mailman/listinfo/gdal-dev
>     <http://lists.osgeo.org/mailman/listinfo/gdal-dev>
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170113/dc86f266/attachment.html>

From gdt at lexort.com  Fri Jan 13 16:15:27 2017
From: gdt at lexort.com (Greg Troxel)
Date: Fri, 13 Jan 2017 19:15:27 -0500
Subject: [gdal-dev] C++11 timeline
In-Reply-To: <20170113091830.GA6180@norbit.de> (=?utf-8?Q?=22J=C3=BCrgen?=
 E. Fischer"'s message of "Fri, 13 Jan 2017 10:18:30 +0100")
References: <CACmBxysv7H=MP1iV+O=sHfh4Z8teuuvic7mgQrGiSmpeC_fmcw@mail.gmail.com>
 <CACmBxyt4nE1Z_gCPOgUiOe=jNOg6us7kKE5uz0QeAYKQ8g4ypQ@mail.gmail.com>
 <02524FED-7022-4C4B-9664-A48A9A5D2F91@hobu.co>
 <22828021.y404zajIpn@even-i700> <smu8tqoc3it.fsf@linuxpal.mit.edu>
 <CACmBxytE3aPgAB6WyoaOLZBt+t682OoaykP9LkV7jFsA--x66g@mail.gmail.com>
 <smulgugp66u.fsf@linuxpal.mit.edu>
 <CAB28AshJg_w7J7qVzFkpsnh1QTKMpHmnN7LUTWsTur-OJfxE_Q@mail.gmail.com>
 <20170113091830.GA6180@norbit.de>
Message-ID: <smu37gmmr8g.fsf@linuxpal.mit.edu>


Jürgen E. Fischer <jef at norbit.de> writes:

> On Fri, 13. Jan 2017 at 06:42:26 +1000, Nyall Dawson wrote:
>> FYI - the upcoming QGIS 3.0 release has a hard c++11 requirement. Not
>> sure how much that affects things, but certainly projects which
>> utilise GDAL are already switching to c++11.
>
> We're not using the C++ API - so that shouldn't matter.

I took the comment to mean that since QGIS would require c++11, if you
wanted to run QGIS, you'd ned to cope with a new-enough compiler, in
which case GDAL also needing it would not be an incremental burden.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 162 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170113/93e55820/attachment.sig>

From mofoyoda at gmail.com  Fri Jan 13 17:58:54 2017
From: mofoyoda at gmail.com (Nikolai Bezdna)
Date: Sat, 14 Jan 2017 04:58:54 +0300
Subject: [gdal-dev] Wrong interpretation of DIMENSION features in GDAL DXF
	driver
Message-ID: <4BBC3439-C036-4A3C-891B-A6AF7AF62E06@gmail.com>

I’ve found a bug in DXF driver: when reading features of type DIMENSION this driver translates them to multilinestrings, which is ok, but then puts unnecessary leading lines and rotates the main line (with arrows) to a horizontal state, which is really a wrong representation.
Here are two screenshots illustrating the issue: one from a cad viewer (https://dl.dropboxusercontent.com/u/7488735/acad_dxf.png <https://dl.dropboxusercontent.com/u/7488735/acad_dxf.png>) and another one from QGIS (https://dl.dropboxusercontent.com/u/7488735/gdal_dxf.png <https://dl.dropboxusercontent.com/u/7488735/gdal_dxf.png>), which uses gdal DXF driver to read this format.

I haven’t tried the new GSoC DWG driver yet (I guess it’s only in trunk now and not yet released) and unsure if it works for DXF. I very much hope this bug isn’t present there and dimension features are translated correctly. I’ll try out this new driver and let you know.

Cheers,
Nick
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170114/4f6abad0/attachment.html>

From jef at norbit.de  Sat Jan 14 01:13:48 2017
From: jef at norbit.de (=?iso-8859-1?B?SvxyZ2VuIEUu?= Fischer)
Date: Sat, 14 Jan 2017 10:13:48 +0100
Subject: [gdal-dev] C++11 timeline
In-Reply-To: <smu37gmmr8g.fsf@linuxpal.mit.edu>
References: <CACmBxysv7H=MP1iV+O=sHfh4Z8teuuvic7mgQrGiSmpeC_fmcw@mail.gmail.com>
 <CACmBxyt4nE1Z_gCPOgUiOe=jNOg6us7kKE5uz0QeAYKQ8g4ypQ@mail.gmail.com>
 <02524FED-7022-4C4B-9664-A48A9A5D2F91@hobu.co>
 <22828021.y404zajIpn@even-i700> <smu8tqoc3it.fsf@linuxpal.mit.edu>
 <CACmBxytE3aPgAB6WyoaOLZBt+t682OoaykP9LkV7jFsA--x66g@mail.gmail.com>
 <smulgugp66u.fsf@linuxpal.mit.edu>
 <CAB28AshJg_w7J7qVzFkpsnh1QTKMpHmnN7LUTWsTur-OJfxE_Q@mail.gmail.com>
 <20170113091830.GA6180@norbit.de>
 <smu37gmmr8g.fsf@linuxpal.mit.edu>
Message-ID: <20170114091348.GA10037@norbit.de>

Hi Greg,

On Fri, 13. Jan 2017 at 19:15:27 -0500, Greg Troxel wrote:
> > We're not using the C++ API - so that shouldn't matter.
 
> I took the comment to mean that since QGIS would require c++11, if you
> wanted to run QGIS, you'd ned to cope with a new-enough compiler, in
> which case GDAL also needing it would not be an incremental burden.

Well, it just meant that we use the C API and therefore are not tied to use the
same compiler for GDAL and QGIS.


Jürgen

-- 
Jürgen E. Fischer         norBIT GmbH               Tel. +49-4931-918175-31
Dipl.-Inf. (FH)           Rheinstraße 13            Fax. +49-4931-918175-50
Software Engineer         D-26506 Norden               http://www.norbit.de
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 827 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170114/0730a729/attachment.sig>

From even.rouault at spatialys.com  Sat Jan 14 04:06:45 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 14 Jan 2017 13:06:45 +0100
Subject: [gdal-dev] PostGIS with more than one geometry column per table
	| R-Trees
In-Reply-To: <OFEA0DB003.A05ED9B9-ONC12580A7.005589EB-C12580A7.00576CDE@mettenmeier.de>
References: <OFEA0DB003.A05ED9B9-ONC12580A7.005589EB-C12580A7.00576CDE@mettenmeier.de>
Message-ID: <5139088.8tc8PO7dgD@even-i700>

On vendredi 13 janvier 2017 16:54:55 CET Alexander.Berdnikow at mettenmeier.de wrote:
> Hi,
> 
> sorry, there is a half copy of this post in the forum already, which was
> not accepted by the maillist.
> 
> I translated a Table (Feature) of a PostGIS Database to a GeoPackage with
> GDAL. The Feature has two Linestring Geometries in the PostGIS DB. One
> geometry with exact positions of the network and one overwiew geometry
> which may have just rough positions. Often the overwiew ist just a copy of
> the exact positions, but sometimes it differs.
> 
> After translation of the feature to GeoPackage everything seems fine, but
> in the GeoPackage I have only one Linestring geometry. It is listed in the
> gpkg_geometry_columns.
> 
> My question is, which of the two geometries was translated to the
> GeoPackage?

The first geometry column reported in the PostGIS layer (as you can see with ogrinfo)

> What happens to the other geometries of the feature in the
> translation process?

Ignored / dropped.

> 
> I've read about the solution of the multiple geometries issue in
> GeoPackage in the GP-specification. Does GDAL support this in the
> translation process (maybe with a special option?)?

Not sure which solution you are talking about.

> 
> ______
> 
> A first solution for us was to use a View Schema, where each feature has
> only one geometry. Now I have two schemas in the PostGIS DB and they were
> both translated. Two questions about it:
> 
> - Is there a command to say which schemas to translate and which not? My
> command is now as follows:
> ogr2ogr -f GPKG data.gpkg PG:"host=localhost user=user dbname=data
> password=pw"
> 
> I found options to select tables, but there are hundreds of tables in the
> schema I am interested in. Maybe there is an easy  possibility to say
> "take only schema x"? Did not found it in the list
> http://www.gdal.org/ogr2ogr.html

You need to read the documentation of the PostGIS driver:
http://gdal.org/drv_pg.html

You can use add " schemas=xxxx" to the connection string.

> 
> - How can I supress the building of r-tree tables? There are virtually
> thousands of them in the created geopackage.

Documentation of the GPKG driver:
http://gdal.org/drv_geopackage.html

-lco SPATIAL_INDEX=NO

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170114/29b7423d/attachment-0001.html>

From even.rouault at spatialys.com  Sat Jan 14 12:31:29 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 14 Jan 2017 21:31:29 +0100
Subject: [gdal-dev] Sentinel driver
In-Reply-To: <1481529011795-5299537.post@n6.nabble.com>
References: <1481529011795-5299537.post@n6.nabble.com>
Message-ID: <3741880.cDvO3BH167@even-i700>

On lundi 12 décembre 2016 00:50:11 CET Johan de Braak wrote:
> Hi all,
> 
> Will there be an update of the Sentinel driver that is able to deal with the
> new Level 1C product format (as announced here:
> https://scihub.copernicus.eu/news/News00124 ) ?

I've added support for it in trunk and in 2.1 branch.
See https://trac.osgeo.org/gdal/ticket/6745

I've only tested with products with one granule. Not sure if there are products with 
several granules, so feedback appreciated.

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170114/7455ef32/attachment.html>

From alexander.berdnikow at mettenmeier.de  Mon Jan 16 06:24:05 2017
From: alexander.berdnikow at mettenmeier.de (Alexander Berdnikow)
Date: Mon, 16 Jan 2017 07:24:05 -0700 (MST)
Subject: [gdal-dev] PostGIS with more than one geometry column per table
	| R-Trees
In-Reply-To: <5139088.8tc8PO7dgD@even-i700>
References: <OFEA0DB003.A05ED9B9-ONC12580A7.005589EB-C12580A7.00576CDE@mettenmeier.de>
 <5139088.8tc8PO7dgD@even-i700>
Message-ID: <1484576645997-5303622.post@n6.nabble.com>

Thank you, Even!


Even Rouault-2 wrote
> On vendredi 13 janvier 2017 16:54:55 CET 

> Alexander.Berdnikow@

>  wrote:
>> I've read about the solution of the multiple geometries issue in
>> GeoPackage in the GP-specification. Does GDAL support this in the
>> translation process (maybe with a special option?)?
> 
> Not sure which solution you are talking about.

http://www.geopackage.org/modeling_guidelines.html

Use Case 2 describes a way how to handle multiple geometries in GeoPackage.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-PostGIS-with-more-than-one-geometry-column-per-table-R-Trees-tp5303398p5303622.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From jukka.rahkonen at maanmittauslaitos.fi  Mon Jan 16 06:47:00 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Mon, 16 Jan 2017 07:47:00 -0700 (MST)
Subject: [gdal-dev] PostGIS with more than one geometry column per table
	| R-Trees
In-Reply-To: <1484576645997-5303622.post@n6.nabble.com>
References: <OFEA0DB003.A05ED9B9-ONC12580A7.005589EB-C12580A7.00576CDE@mettenmeier.de>
 <5139088.8tc8PO7dgD@even-i700> <1484576645997-5303622.post@n6.nabble.com>
Message-ID: <1484578020140-5303624.post@n6.nabble.com>

Alexander Berdnikow wrote
> 
> http://www.geopackage.org/modeling_guidelines.html
> 
> Use Case 2 describes a way how to handle multiple geometries in
> GeoPackage.

Then you convert the first geometry with all the attributes into GeoPackage
and then add another layer with a command like





-Jukka Rahkonen



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-PostGIS-with-more-than-one-geometry-column-per-table-R-Trees-tp5303398p5303624.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From jukka.rahkonen at maanmittauslaitos.fi  Mon Jan 16 06:55:53 2017
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Mon, 16 Jan 2017 14:55:53 +0000
Subject: [gdal-dev] Wrong interpretation of DIMENSION features in GDAL
 DXF driver
Message-ID: <9cede9262518405e8bf0e77a9a97006a@C119S212VM022.msvyvi.vaha.local>

Sorry, Nabble did not include my ogr2ogr command to the mailing list mail, reposting.

You can do the join as suggested in http://www.geopackage.org/modeling_guidelines.html by converting the first geometry with all the attributes into GeoPackage as you have done, and then adding  another layer with a command like

ogr2ogr -append -update -f gpkg -sql "SELECT second_geometry AS geometry, id AS id from table_with_two_geometries"
my_geopackage.gpkg -nln table_with_second_geometry_to_be_joined PG:.....

-Jukka Rahkonen-

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170116/f98d0d15/attachment.html>

From jerome.siot at maxsea.fr  Mon Jan 16 23:48:45 2017
From: jerome.siot at maxsea.fr (Jerome Siot)
Date: Tue, 17 Jan 2017 07:48:45 +0000
Subject: [gdal-dev] GDAL S57 "New Object"
Message-ID: <1F69DB3E166E714BAD00B83D3FB0877402919744B6@EXCH2010.informatique-mer.fr>

Hi,
Implementing a program using gdal 2.0.1, I trap an exception on a GetNextFeature() call, on layer id 163 "NEW OBJECT", described on www.s-57.com<http://www.s-57.com>.
As a first idea, I read gdal/gdal/data/s57objectclasses.csv (from https://github.com/OSGeo/gdal/commits/trunk/gdal/data/s57objectclasses.csv) => this file has no description for "New Object"

Any idea ?





--
Best Regards, Jerome Siot
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170117/e4a4ce4e/attachment.html>

From bontepaarden at gmail.com  Mon Jan 16 23:59:30 2017
From: bontepaarden at gmail.com (Paul Meems)
Date: Tue, 17 Jan 2017 08:59:30 +0100
Subject: [gdal-dev] Using GDALTranslateOptions with '-a_ullr' doesn't work
Message-ID: <CAHNf2YSTekb8Qs0fAVKX-25+wKf2nC8_u6dZ3-2omgVLqEVxnQ@mail.gmail.com>

Hi list,

I'm using GDAL v2.1.2 from GisInternals.com on Win10 with the C#-bindings.

I'm trying to recreate this gdal_translate command in C#:
gdal_translate -of GTiff -a_nodata 65535 -a_srs "+proj=stere +lat_0=90
+lon_0=0 +lat_ts=60 +a=6378.14 +b=6356.75 +x_0=0 y_0=0" -a_ullr 0.0,
-3650.000, 800.000, -4415.000 "HDF5:\"in.h5\"://image1/image_data" "out.tif"

This is my C#-code:
var options =
    new GDALTranslateOptions(new[]
    {
        "-of", "GTiff",
        "-a_nodata", "65535",
        // "-a_srs", "\"+proj=stere +lat_0=90 +lon_0=0 +lat_ts=60
+a=6378.14 +b=6356.75 +x_0=0 y_0=0\"",
        //"-a_ullr", "0.0, -3650.000, 800.000, -4415.000"
    });
var newDs = Gdal.wrapper_GDALTranslate(outputFile, ds, options, null, null);

The above code works, because I commented the last two GDALTranslateOptions.

When I enable the -a_srs option I get this error: Failed to process SRS
definition
When I enable the -a_ullr option I get Unknown option name '-a_ullr'

So it seems I'm not doing it right. I tried looking for examples but
couldn't find any.
Can anybody assist?

Thanks,

Paul
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170117/35032d74/attachment.html>

From even.rouault at spatialys.com  Tue Jan 17 00:05:57 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 17 Jan 2017 09:05:57 +0100
Subject: [gdal-dev] Using GDALTranslateOptions with '-a_ullr' doesn't
	work
In-Reply-To: <CAHNf2YSTekb8Qs0fAVKX-25+wKf2nC8_u6dZ3-2omgVLqEVxnQ@mail.gmail.com>
References: <CAHNf2YSTekb8Qs0fAVKX-25+wKf2nC8_u6dZ3-2omgVLqEVxnQ@mail.gmail.com>
Message-ID: <8205204.alDnPWnMDo@even-i700>

On mardi 17 janvier 2017 08:59:30 CET Paul Meems wrote:
> Hi list,
> 
> I'm using GDAL v2.1.2 from GisInternals.com on Win10 with the C#-bindings.
> 
> I'm trying to recreate this gdal_translate command in C#:
> gdal_translate -of GTiff -a_nodata 65535 -a_srs "+proj=stere +lat_0=90
> +lon_0=0 +lat_ts=60 +a=6378.14 +b=6356.75 +x_0=0 y_0=0" -a_ullr 0.0,
> -3650.000, 800.000, -4415.000 "HDF5:\"in.h5\"://image1/image_data" "out.tif"
> 
> This is my C#-code:
> var options =
>     new GDALTranslateOptions(new[]
>     {
>         "-of", "GTiff",
>         "-a_nodata", "65535",
>         // "-a_srs", "\"+proj=stere +lat_0=90 +lon_0=0 +lat_ts=60
> +a=6378.14 +b=6356.75 +x_0=0 y_0=0\"",

Remvoe the \" in the proj.4 string. This is just needed for invokation from a shell, not when 
passing arguments as a string

>         //"-a_ullr", "0.0, -3650.000, 800.000, -4415.000"

Split the four values as 4 separate strings.

>     });
> var newDs = Gdal.wrapper_GDALTranslate(outputFile, ds, options, null, null);
> 
> The above code works, because I commented the last two GDALTranslateOptions.
> 
> When I enable the -a_srs option I get this error: Failed to process SRS
> definition
> When I enable the -a_ullr option I get Unknown option name '-a_ullr'
> 
> So it seems I'm not doing it right. I tried looking for examples but
> couldn't find any.
> Can anybody assist?
> 
> Thanks,
> 
> Paul


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170117/eda462e1/attachment.html>

From even.rouault at spatialys.com  Tue Jan 17 00:08:58 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 17 Jan 2017 09:08:58 +0100
Subject: [gdal-dev] GDAL S57 "New Object"
In-Reply-To: <1F69DB3E166E714BAD00B83D3FB0877402919744B6@EXCH2010.informatique-mer.fr>
References: <1F69DB3E166E714BAD00B83D3FB0877402919744B6@EXCH2010.informatique-mer.fr>
Message-ID: <15308344.24VmPaSRMX@even-i700>

On mardi 17 janvier 2017 07:48:45 CET Jerome Siot wrote:
> Hi,
> Implementing a program using gdal 2.0.1, I trap an exception on a
> GetNextFeature() call, on layer id 163 "NEW OBJECT", described on
> www.s-57.com<http://www.s-57.com>. As a first idea, I read
> gdal/gdal/data/s57objectclasses.csv (from
> https://github.com/OSGeo/gdal/commits/trunk/gdal/data/s57objectclasses.csv)
> => this file has no description for "New Object"
> 
> Any idea ?

Jerome,

It looks like you spotted the issue. Would you mind submitting a patch with the new entry in 
the file ?

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170117/878f73dd/attachment-0001.html>

From damian.dixon at gmail.com  Tue Jan 17 00:55:01 2017
From: damian.dixon at gmail.com (Damian Dixon)
Date: Tue, 17 Jan 2017 08:55:01 +0000
Subject: [gdal-dev] GDAL S57 "New Object"
In-Reply-To: <15308344.24VmPaSRMX@even-i700>
References: <1F69DB3E166E714BAD00B83D3FB0877402919744B6@EXCH2010.informatique-mer.fr>
 <15308344.24VmPaSRMX@even-i700>
Message-ID: <CAJjdW1wkNFkL3jvm29wET7T0ZYy7p-AtepW8amMJRNJkdtVoWw@mail.gmail.com>

The following is really for information...

New Object is an interesting one. It's used to extend the features
available in S-57 by the data provider without the need to modify the
standards (S-57 & S-52).

Normal a New Object is only created when there is a pressing need to
represent something new that is important to display. The only time I have
seen New Object is in test data.

The drawing instructions are normal embedded in the object itself rather
than being rules defined by the S-52 rendering tables. This means that
attributes may not be present.

So while you will be able to read the object, displaying it correctly may
not be so easy.

Regards
Damian


On 17 January 2017 at 08:08, Even Rouault <even.rouault at spatialys.com>
wrote:

> On mardi 17 janvier 2017 07:48:45 CET Jerome Siot wrote:
>
> > Hi,
>
> > Implementing a program using gdal 2.0.1, I trap an exception on a
>
> > GetNextFeature() call, on layer id 163 "NEW OBJECT", described on
>
> > www.s-57.com<http://www.s-57.com>. As a first idea, I read
>
> > gdal/gdal/data/s57objectclasses.csv (from
>
> > https://github.com/OSGeo/gdal/commits/trunk/gdal/data/
> s57objectclasses.csv)
>
> > => this file has no description for "New Object"
>
> >
>
> > Any idea ?
>
>
>
> Jerome,
>
>
>
> It looks like you spotted the issue. Would you mind submitting a patch
> with the new entry in the file ?
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170117/06834c95/attachment.html>

From bontepaarden at gmail.com  Tue Jan 17 04:13:35 2017
From: bontepaarden at gmail.com (Paul Meems)
Date: Tue, 17 Jan 2017 13:13:35 +0100
Subject: [gdal-dev] Using GDALTranslateOptions with '-a_ullr' doesn't
	work
In-Reply-To: <8205204.alDnPWnMDo@even-i700>
References: <CAHNf2YSTekb8Qs0fAVKX-25+wKf2nC8_u6dZ3-2omgVLqEVxnQ@mail.gmail.com>
 <8205204.alDnPWnMDo@even-i700>
Message-ID: <CAHNf2YQ6=cHHBs7E7d5OfdpqLSAEE4gOPdtKA7eWd60QUmCpsA@mail.gmail.com>

Thanks Even for your reply, it helped me great.

For future reference here's the working C# code:

var options =
    new GDALTranslateOptions(new[]
    {
        "-of", "GTiff",
        "-a_nodata", "65535",
        "-a_srs", "+proj=stere +lat_0=90 +lon_0=0 +lat_ts=60 +a=6378.14
+b=6356.75 +x_0=0 y_0=0",
        "-a_ullr", "0.0", "-3650.000", "800.000", "-4415.000"
    });
var newDs = Gdal.wrapper_GDALTranslate(outputFile, ds, options, null, null);


Regards,


Paul

*Paul Meems *
Release manager, configuration manager
and forum moderator of MapWindow GIS.
www.mapwindow.org

Owner of MapWindow.nl - Support for
Dutch speaking users.
www.mapwindow.nl


*The MapWindow GIS project has moved to GitHub
<https://github.com/MapWindow>!*


Download the latest MapWinGIS mapping engine.
<https://github.com/MapWindow/MapWinGIS/releases>

Download the latest MapWindow 5 open source desktop application.
<https://github.com/MapWindow/MapWindow5/releases>

2017-01-17 9:05 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:

> On mardi 17 janvier 2017 08:59:30 CET Paul Meems wrote:
>
> > Hi list,
>
> >
>
> > I'm using GDAL v2.1.2 from GisInternals.com on Win10 with the
> C#-bindings.
>
> >
>
> > I'm trying to recreate this gdal_translate command in C#:
>
> > gdal_translate -of GTiff -a_nodata 65535 -a_srs "+proj=stere +lat_0=90
>
> > +lon_0=0 +lat_ts=60 +a=6378.14 +b=6356.75 +x_0=0 y_0=0" -a_ullr 0.0,
>
> > -3650.000, 800.000, -4415.000 "HDF5:\"in.h5\"://image1/image_data"
> "out.tif"
>
> >
>
> > This is my C#-code:
>
> > var options =
>
> > new GDALTranslateOptions(new[]
>
> > {
>
> > "-of", "GTiff",
>
> > "-a_nodata", "65535",
>
> > // "-a_srs", "\"+proj=stere +lat_0=90 +lon_0=0 +lat_ts=60
>
> > +a=6378.14 +b=6356.75 +x_0=0 y_0=0\"",
>
>
>
> Remvoe the \" in the proj.4 string. This is just needed for invokation
> from a shell, not when passing arguments as a string
>
>
>
> > //"-a_ullr", "0.0, -3650.000, 800.000, -4415.000"
>
>
>
> Split the four values as 4 separate strings.
>
>
>
> > });
>
> > var newDs = Gdal.wrapper_GDALTranslate(outputFile, ds, options, null,
> null);
>
> >
>
> > The above code works, because I commented the last two
> GDALTranslateOptions.
>
> >
>
> > When I enable the -a_srs option I get this error: Failed to process SRS
>
> > definition
>
> > When I enable the -a_ullr option I get Unknown option name '-a_ullr'
>
> >
>
> > So it seems I'm not doing it right. I tried looking for examples but
>
> > couldn't find any.
>
> > Can anybody assist?
>
> >
>
> > Thanks,
>
> >
>
> > Paul
>
>
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170117/cefb179d/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Wed Jan 18 02:52:28 2017
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Wed, 18 Jan 2017 10:52:28 +0000
Subject: [gdal-dev] GMLAS does not resolve schema from WFS data
Message-ID: <0613fbdedaa446ada014b8e487182600@C119S212VM022.msvyvi.vaha.local>

Hi,

I downloaded one CadastralParcel from an INSPIRE service with curl

curl -k -o inspire-cp.gml "https://inspire-wfs.maanmittauslaitos.fi/inspire-wfs/cp?service=WFS&version=2.0.0&request=GetFeature&TypeNames=cp:CadastralParcel&count=1"

Then I tried to check what I have with ogrinfo but it fails

ogrinfo GMLAS:inspire-cp.gml

ERROR 3: Cannot resolve https://inspire-wfs.maanmittauslaitos.fi/inspire-wfs/cp?
SERVICE=WFS&VERSION=2.0.0&REQUEST=DescribeFeatureType&OUTPUTFORMAT=application%2
Fgml%2Bxml%3B+version%3D3.2&TYPENAME=cp:CadastralParcel&NAMESPACES=xmlns(cp,http
%3A%2F%2Finspire.ec.europa.eu%2Fschemas%2Fcp%2F4.0)

However, the DescribeFeatureType is successful when I copy-paste it into browser. I wonder what goes wrong. I had to use "-k" with curl to bypass a problem with certificate and therefore I tried also to set unsafe SSL for GDAL with "set GDAL_HTTP_UNSAFESSL=YES" but that did not change anything.

-Jukka Rahkonen-


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170118/2a49f9c1/attachment.html>

From even.rouault at spatialys.com  Wed Jan 18 03:02:54 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 18 Jan 2017 12:02:54 +0100
Subject: [gdal-dev] GMLAS does not resolve schema from WFS data
In-Reply-To: <0613fbdedaa446ada014b8e487182600@C119S212VM022.msvyvi.vaha.local>
References: <0613fbdedaa446ada014b8e487182600@C119S212VM022.msvyvi.vaha.local>
Message-ID: <1491976.RGTFXEJyzx@even-i700>

On mercredi 18 janvier 2017 10:52:28 CET Rahkonen Jukka (MML) wrote:
> Hi,
> 
> I downloaded one CadastralParcel from an INSPIRE service with curl
> 
> curl -k -o inspire-cp.gml
> "https://inspire-wfs.maanmittauslaitos.fi/inspire-wfs/cp?service=WFS&versio
> n=2.0.0&request=GetFeature&TypeNames=cp:CadastralParcel&count=1"
> 
> Then I tried to check what I have with ogrinfo but it fails
> 
> ogrinfo GMLAS:inspire-cp.gml
> 
> ERROR 3: Cannot resolve
> https://inspire-wfs.maanmittauslaitos.fi/inspire-wfs/cp?
> 
SERVICE=WFS&VERSION=2.0.0&REQUEST=DescribeFeatureType&OUTPUTFORMAT=applicat
> ion%2
> Fgml%2Bxml%3B+version
%3D3.2&TYPENAME=cp:CadastralParcel&NAMESPACES=xmlns(cp
> ,http %3A%2F%2Finspire.ec.europa.eu%2Fschemas%2Fcp%2F4.0)
> 
> However, the DescribeFeatureType is successful when I copy-paste it into
> browser. I wonder what goes wrong. I had to use "-k" with curl to bypass a
> problem with certificate and therefore I tried also to set unsafe SSL for
> GDAL with "set GDAL_HTTP_UNSAFESSL=YES" but that did not change anything.

I don't reproduce this issue on Ubuntu 16.04. You can try adding --config 
CPL_CURL_VERBOSE YES to get more low level details about what goes wrong

But I get other errors :

$ ogrinfo gmlas:inspire-cp.gml
ERROR 1: /vsicurl_streaming/https://inspire-wfs.maanmittauslaitos.fi/inspire-wfs/cp?
SERVICE=WFS&VERSION=2.0.0&REQUEST=DescribeFeatureType&OUTPUTFORMAT=applicati
on%2Fgml%2Bxml%3B+version%3D3.2&NAMESPACE=xmlns%28http%3A%2F
%2Finspire.ec.europa.eu%2Fschemas%2Fau%2F4.0%29:11:73 namespace 'http://
inspire.ec.europa.eu/schemas/base/3.3' is referenced without import declaration
ERROR 1: /vsicurl_streaming/https://inspire-wfs.maanmittauslaitos.fi/inspire-wfs/cp?
SERVICE=WFS&VERSION=2.0.0&REQUEST=DescribeFeatureType&OUTPUTFORMAT=applicati
on%2Fgml%2Bxml%3B+version%3D3.2&NAMESPACE=xmlns%28http%3A%2F
%2Finspire.ec.europa.eu%2Fschemas%2Fau%2F4.0%29:114:73 namespace 'http://
inspire.ec.europa.eu/schemas/base/3.3' is referenced without import declaration
[...]

The schema at https://inspire-wfs.maanmittauslaitos.fi/inspire-wfs/cp?
SERVICE=WFS&VERSION=2.0.0&REQUEST=DescribeFeatureType&OUTPUTFORMAT=applicati
on%2Fgml%2Bxml%3B+version%3D3.2&NAMESPACE=xmlns(http%3A%2F
%2Finspire.ec.europa.eu%2Fschemas%2Fau%2F4.0) indeed references namespaces without 
importing them (except GML). It indeed looks invalid to me.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170118/a8f559c1/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Wed Jan 18 03:17:13 2017
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Wed, 18 Jan 2017 11:17:13 +0000
Subject: [gdal-dev] GMLAS does not resolve schema from WFS data
Message-ID: <ad8cfe2edfe94da1875c62177cb8f3cf@C119S212VM022.msvyvi.vaha.local>

Thanks,

I added CPl_CURL_VERBOSE but I do not quite understand what it tries to tell me. GDAL seems to reach the deegree WFS server but then "* no chunk, no close, no size. Assume close to signal end"
* Couldn't find host inspire-wfs.maanmittauslaitos.fi in the _netrc file; using defaults
* timeout on name lookup is not supported
* Hostname was NOT found in DNS cache
*   Trying 10.37.213.18...
* Connected to inspire-wfs.maanmittauslaitos.fi (10.37.213.18) port 443 (#0)
* libcurl is now using a weak random seed!
* SSL connection using TLSv1.2 / DHE-RSA-AES256-GCM-SHA384
* Server certificate:
*                           subject: C=FI; ST=Finland; L=HELSINKI; O=Maanmittauslaitos; OU=Mitpa; CN=*.maanmittauslaitos.fi
*                           start date: 2016-10-11 00:00:00 GMT
*                           expire date: 2019-10-11 23:59:59 GMT
*                           issuer: C=US; O=thawte, Inc.; CN=thawte SSL CA - G2
*                           SSL certificate verify result: unable to get local issuer certificate (20), continuing anyway.
> GET /inspire-wfs/cp?SERVICE=WFS&VERSION=2.0.0&REQUEST=DescribeFeatureType&OUTPUTFORMAT=application%2Fgml%2Bxml%3B+version%3D3.2&TYPENAME=cp:CadastralParcel&NAMESPACES=xmlns(cp,http%3A%2F%2Finspire.ec.europa.eu%2Fschemas%2Fcp%2F4.0) HTTP/1.1

Host: inspire-wfs.maanmittauslaitos.fi
Accept: */*
Accept-Encoding: gzip
< HTTP/1.1 200 OK
* Server Apache-Coyote/1.1 is not blacklisted
< Server: Apache-Coyote/1.1
< Cache-Control: no-cache, no-store
< deegree-version: 3.3.18
< Content-Type: text/xml;charset=UTF-8
< Date: Wed, 18 Jan 2017 11:11:18 GMT

* no chunk, no close, no size. Assume close to signal end
<

* Closing connection 0
ERROR 3: Cannot resolve https://inspire-wfs.maanmittauslaitos.fi/inspire-wfs/cp?SERVICE=WFS&VERSION=2.0.0&REQUEST=DescribeFeatureType&OUTPUTFORMAT=application%2Fgml%2Bxml%3B+version%3D3.2&TYPENAME=cp:CadastralParcel&NAMESPACES=xmlns(cp,http%3A%2F%2Finspire.ec.europa.eu%2Fschemas%2Fcp%2F4.0)

-Jukka-

Even Rouault wrote:
Re: [gdal-dev] GMLAS does not resolve schema from WFS data


On mercredi 18 janvier 2017 10:52:28 CET Rahkonen Jukka (MML) wrote:

> Hi,

>

> I downloaded one CadastralParcel from an INSPIRE service with curl

>

> curl -k -o inspire-cp.gml

> "https://inspire-wfs.maanmittauslaitos.fi/inspire-wfs/cp?service=WFS&versio

> n=2.0.0&request=GetFeature&TypeNames=cp:CadastralParcel&count=1"

>

> Then I tried to check what I have with ogrinfo but it fails

>

> ogrinfo GMLAS:inspire-cp.gml

>

> ERROR 3: Cannot resolve

> https://inspire-wfs.maanmittauslaitos.fi/inspire-wfs/cp?

> SERVICE=WFS&VERSION=2.0.0&REQUEST=DescribeFeatureType&OUTPUTFORMAT=applicat

> ion%2

> Fgml%2Bxml%3B+version%3D3.2&TYPENAME=cp:CadastralParcel&NAMESPACES=xmlns(cp

> ,http %3A%2F%2Finspire.ec.europa.eu%2Fschemas%2Fcp%2F4.0)

>

> However, the DescribeFeatureType is successful when I copy-paste it into

> browser. I wonder what goes wrong. I had to use "-k" with curl to bypass a

> problem with certificate and therefore I tried also to set unsafe SSL for

> GDAL with "set GDAL_HTTP_UNSAFESSL=YES" but that did not change anything.



I don't reproduce this issue on Ubuntu 16.04. You can try adding --config CPL_CURL_VERBOSE YES to get more low level details about what goes wrong



But I get other errors :



$ ogrinfo gmlas:inspire-cp.gml

ERROR 1: /vsicurl_streaming/https://inspire-wfs.maanmittauslaitos.fi/inspire-wfs/cp?SERVICE=WFS&VERSION=2.0.0&REQUEST=DescribeFeatureType&OUTPUTFORMAT=application%2Fgml%2Bxml%3B+version%3D3.2&NAMESPACE=xmlns%28http%3A%2F%2Finspire.ec.europa.eu%2Fschemas%2Fau%2F4.0%29:11:73 namespace 'http://inspire.ec.europa.eu/schemas/base/3.3' is referenced without import declaration

ERROR 1: /vsicurl_streaming/https://inspire-wfs.maanmittauslaitos.fi/inspire-wfs/cp?SERVICE=WFS&VERSION=2.0.0&REQUEST=DescribeFeatureType&OUTPUTFORMAT=application%2Fgml%2Bxml%3B+version%3D3.2&NAMESPACE=xmlns%28http%3A%2F%2Finspire.ec.europa.eu%2Fschemas%2Fau%2F4.0%29:114:73 namespace 'http://inspire.ec.europa.eu/schemas/base/3.3' is referenced without import declaration

[...]



The schema at https://inspire-wfs.maanmittauslaitos.fi/inspire-wfs/cp?SERVICE=WFS&VERSION=2.0.0&REQUEST=DescribeFeatureType&OUTPUTFORMAT=application%2Fgml%2Bxml%3B+version%3D3.2&NAMESPACE=xmlns(http%3A%2F%2Finspire.ec.europa.eu%2Fschemas%2Fau%2F4.0) indeed references namespaces without importing them (except GML). It indeed looks invalid to me.



Even



--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170118/159bca91/attachment-0001.html>

From cgodkin at gmail.com  Wed Jan 18 06:55:49 2017
From: cgodkin at gmail.com (Carl Godkin)
Date: Wed, 18 Jan 2017 06:55:49 -0800
Subject: [gdal-dev] Question about .aux.xml sidecar file handling...
Message-ID: <CAE=8kmk1e+WyxnMB6Ps21wbwooByzpbB4BgESwqzpXn9V1O09A@mail.gmail.com>

Hi,

I have a geological map in a pair of files called USGS.tif and
USGS.tif.aux.xml

The XML seems to have ground control points (<SourceGCPs>) and a geographic
coordinate system (<SpatialReference>)

I was hoping that GDAL would treat the file as if it's a GeoTIFF.  But if I
run gdalinfo on the .tif, it doesn't seem to read the coordinate system or
GCPs.  Instead, I see this:

Driver: GTiff/GeoTIFF
Files: USGS.tif
       USGS.tif.aux.xml
Size is 11451, 12188
Coordinate System is `'
...
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0,12188.0)
Upper Right (11451.0,    0.0)
Lower Right (11451.0,12188.0)
Center      ( 5725.5, 6094.0)
...

Am I missing something?  I have GDAL_DATA set appropriately and am using
GDAL 2.1.1 on Windows.

I would like to either treat the .tif + .tif.aux.xml as a GeoTIFF or else
translate it to one.

Thanks very much,

carl
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170118/c4cb0613/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Wed Jan 18 14:00:12 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Wed, 18 Jan 2017 15:00:12 -0700 (MST)
Subject: [gdal-dev] Question about .aux.xml sidecar file handling...
In-Reply-To: <CAE=8kmk1e+WyxnMB6Ps21wbwooByzpbB4BgESwqzpXn9V1O09A@mail.gmail.com>
References: <CAE=8kmk1e+WyxnMB6Ps21wbwooByzpbB4BgESwqzpXn9V1O09A@mail.gmail.com>
Message-ID: <1484776812133-5303953.post@n6.nabble.com>

Carl Godkin-2 wrote
> Hi,
> 
> I have a geological map in a pair of files called USGS.tif and
> USGS.tif.aux.xml
> 
> The XML seems to have ground control points (
> <SourceGCPs>
> ) and a geographic
> coordinate system (
> <SpatialReference>
> )
> 
> I was hoping that GDAL would treat the file as if it's a GeoTIFF.  But if
> I
> run gdalinfo on the .tif, it doesn't seem to read the coordinate system or
> GCPs.  Instead, I see this:
> 
> Driver: GTiff/GeoTIFF
> Files: USGS.tif
>        USGS.tif.aux.xml
> Size is 11451, 12188
> Coordinate System is `'
> ...
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0,12188.0)
> Upper Right (11451.0,    0.0)
> Lower Right (11451.0,12188.0)
> Center      ( 5725.5, 6094.0)
> ...
> 
> Am I missing something?  I have GDAL_DATA set appropriately and am using
> GDAL 2.1.1 on Windows.
> 
> I would like to either treat the .tif + .tif.aux.xml as a GeoTIFF or else
> translate it to one.
> 
> Thanks very much,
> 
> carl

Hi,

Image is georeferenced with ground control points. I wonder what happens if
you push it through gdalwarp:

gdalwarp -s_srs epsg:xxxx -t_srs epsg:xxxx USGS.tif USGS_warped.tif

-Jukka Rahkonen-




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Question-about-aux-xml-sidecar-file-handling-tp5303876p5303953.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From cgodkin at gmail.com  Wed Jan 18 14:36:58 2017
From: cgodkin at gmail.com (Carl Godkin)
Date: Wed, 18 Jan 2017 14:36:58 -0800
Subject: [gdal-dev] Question about .aux.xml sidecar file handling...
In-Reply-To: <1484776812133-5303953.post@n6.nabble.com>
References: <CAE=8kmk1e+WyxnMB6Ps21wbwooByzpbB4BgESwqzpXn9V1O09A@mail.gmail.com>
 <1484776812133-5303953.post@n6.nabble.com>
Message-ID: <CAE=8kmmrxgQtKUN9AwUwYeaspqj77jiqysJharZzRDjfjeMiyg@mail.gmail.com>

On Wed, Jan 18, 2017 at 2:00 PM, jratike80 <
jukka.rahkonen at maanmittauslaitos.fi> wrote:

> Carl Godkin-2 wrote
> > Hi,
> >
> > I have a geological map in a pair of files called USGS.tif and
> > USGS.tif.aux.xml
> >
>
>
> Hi,
>
> Image is georeferenced with ground control points. I wonder what happens if
> you push it through gdalwarp:
>
> gdalwarp -s_srs epsg:xxxx -t_srs epsg:xxxx USGS.tif USGS_warped.tif
>
> -Jukka Rahkonen-
>
>
>
Hi Jukka,

Good idea, but gdalwarp isn't seeing the GCPs either.

gdalwarp -s_srs epsg:26712 -t_srs epsg:26712 USGS.tif warped.tif
ERROR 1: The transformation is already "north up" or
a transformation between pixel/line and georeferenced
coordinates cannot be computed for USGS.tif.
There is no affine transformation and no GCPs.
Specify transformation option SRC_METHOD=NO_GEOTRANSFORM to bypass this
check.

I don't understand the purpose of the .aux.xml sidecar file.  gdalinfo says
it sees it, but does GDAL not actually read it or use any of the contained
information (GCPs and CRS)?  That's what it seems like.

Thanks,

carl
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170118/7fac4aa6/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Wed Jan 18 23:05:54 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Thu, 19 Jan 2017 00:05:54 -0700 (MST)
Subject: [gdal-dev] Question about .aux.xml sidecar file handling...
In-Reply-To: <CAE=8kmmrxgQtKUN9AwUwYeaspqj77jiqysJharZzRDjfjeMiyg@mail.gmail.com>
References: <CAE=8kmk1e+WyxnMB6Ps21wbwooByzpbB4BgESwqzpXn9V1O09A@mail.gmail.com>
 <1484776812133-5303953.post@n6.nabble.com>
 <CAE=8kmmrxgQtKUN9AwUwYeaspqj77jiqysJharZzRDjfjeMiyg@mail.gmail.com>
Message-ID: <1484809554740-5303972.post@n6.nabble.com>

Carl Godkin-2 wrote
> I don't understand the purpose of the .aux.xml sidecar file.  gdalinfo
> says
> it sees it, but does GDAL not actually read it or use any of the contained
> information (GCPs and CRS)?  That's what it seems like.

Please share your files or prepare a small sample for testing so we do not
need to guess what you have in your hands.

-Jukka Rahkonen-



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Question-about-aux-xml-sidecar-file-handling-tp5303876p5303972.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From nik at nixanz.com  Thu Jan 19 02:21:20 2017
From: nik at nixanz.com (Nik Sands)
Date: Thu, 19 Jan 2017 21:21:20 +1100
Subject: [gdal-dev] Shapefile with one feature and many incrementally-added
 vertices is huge
Message-ID: <9538B926-A94A-45A2-A646-AB586EAE8542@nixanz.com>

Hi,

My iOS app has a feature where it uses GDAL 1.11 to record to two shapefiles simultaneously.  One is a point 2.5D feature class and it writes a point feature to this feature class for every location that iOS sends.  The other is a line 2.5D feature class with a single line feature and a vertex is added to the line for every location that iOS sends.

I’ve found that the line shapefile ends up being huge, while the point shapefile is manageable.  For example, I recently tested it out tracking a walk I did over a few hours and 6,000 vertices in the one line feature resulted in a shapefile of 500 MB (this is the .shp file itself, not the .dbf, etc).  The shapefile is not sync’d to disk in between adding vertices.  Just once at the beginning and once the end.

Is this sort of file size expected?  Can I do this in a way that would use less storage space?

ogr2ogr will copy this 500MB shapefile to a 155KB shapefile.  So it is clearly wasted space.  Is there some way that I can have it write the original shapefil without wasting this space in the first place?

The code used to add vertices is below.

Thanks for any insights that you can provide.

Cheers,
Nik.


Code (Objective-C):
————————————————————
- (BOOL)addVertexAtCoordX:(double)x Y:(double)y Z:(double)z {
	OGRGeometryH geom = OGR_F_GetGeometryRef(_feature);
	
	if ( geom ) {
		geom = OGR_G_Clone(geom);
	} else {
		geom = OGR_G_CreateGeometry(OGR_FD_GetGeomType(OGR_F_GetDefnRef(_feature)));
	}
	
	OGR_G_AddPoint(geom, x, y, z);
	
	if ( OGR_F_SetGeometryDirectly(_feature, geom) != OGRERR_NONE ) {
		OGR_G_DestroyGeometry(geom);
		NSLog(@"Failed to set geometry for feature.");
		return NO;
	}
	if ( OGR_L_SetFeature(_layer.layer, _feature) != OGRERR_NONE ) { 
		NSLog(@"Failed to update feature geometry");
		return NO;
	}
	
	return YES;
}
————————————————————

========================================================
NIK SANDS
Line Tamer | Time Traveller | Space Cadet


From even.rouault at spatialys.com  Thu Jan 19 03:17:11 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 19 Jan 2017 12:17:11 +0100
Subject: [gdal-dev] Question about .aux.xml sidecar file handling...
In-Reply-To: <CAE=8kmk1e+WyxnMB6Ps21wbwooByzpbB4BgESwqzpXn9V1O09A@mail.gmail.com>
References: <CAE=8kmk1e+WyxnMB6Ps21wbwooByzpbB4BgESwqzpXn9V1O09A@mail.gmail.com>
Message-ID: <2874773.FrH93sjt3e@even-i700>

On mercredi 18 janvier 2017 06:55:49 CET Carl Godkin wrote:
> Hi,
> 
> I have a geological map in a pair of files called USGS.tif and
> USGS.tif.aux.xml
> 
> The XML seems to have ground control points (<SourceGCPs>) and a geographic
> coordinate system (<SpatialReference>)

GDAL .aux.xml files do no have <SourceGCPs> or <SpatialReference> elements, so it 
looks like this .aux.xml file is a USGS specific one (yikes!)
The names understood by GDAL are <GCPList> and the SRS is stored as a Projection 
attribute of <GCPList>

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170119/8ed76140/attachment.html>

From even.rouault at spatialys.com  Thu Jan 19 03:31:45 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 19 Jan 2017 12:31:45 +0100
Subject: [gdal-dev] Shapefile with one feature and many
	incrementally-added vertices is huge
In-Reply-To: <9538B926-A94A-45A2-A646-AB586EAE8542@nixanz.com>
References: <9538B926-A94A-45A2-A646-AB586EAE8542@nixanz.com>
Message-ID: <1943720.RkdJRijS39@even-i700>

On jeudi 19 janvier 2017 21:21:20 CET Nik Sands wrote:
> Hi,
> 
> My iOS app has a feature where it uses GDAL 1.11 to record to two shapefiles
> simultaneously.  One is a point 2.5D feature class and it writes a point
> feature to this feature class for every location that iOS sends.  The other
> is a line 2.5D feature class with a single line feature and a vertex is
> added to the line for every location that iOS sends.
> 
> I’ve found that the line shapefile ends up being huge, while the point
> shapefile is manageable.  For example, I recently tested it out tracking a
> walk I did over a few hours and 6,000 vertices in the one line feature
> resulted in a shapefile of 500 MB (this is the .shp file itself, not the
> .dbf, etc).  The shapefile is not sync’d to disk in between adding
> vertices.  Just once at the beginning and once the end.
> 
> Is this sort of file size expected?  Can I do this in a way that would use
> less storage space?

Nik,

When editing a geometry and growing it, the low level shapefile writer code isn't really smart 
and just adds the new version at the end of the .shp. So in your use case, the file size will 
increase quadratically. In that particular case the writer could realize that we are editing the 
last geometry, so it could safely overwrite in place, but this isn't implemented yet.

A workaround is to create a brand new shapefile each time you add a point to your line 
shapefile.
Or (rather equivalently) you could delete the feature, run REPACK and add the new version 
of the feature.

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170119/a1d7868f/attachment-0001.html>

From andrew at aitchison.me.uk  Thu Jan 19 03:43:00 2017
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Thu, 19 Jan 2017 11:43:00 +0000 (GMT)
Subject: [gdal-dev] Question about .aux.xml sidecar file handling...
In-Reply-To: <2874773.FrH93sjt3e@even-i700>
References: <CAE=8kmk1e+WyxnMB6Ps21wbwooByzpbB4BgESwqzpXn9V1O09A@mail.gmail.com>
 <2874773.FrH93sjt3e@even-i700>
Message-ID: <alpine.LRH.2.20.1701191138070.22492@warden.aitchison.me.uk>

On Thu, 19 Jan 2017, Even Rouault wrote:

> On mercredi 18 janvier 2017 06:55:49 CET Carl Godkin wrote:
>> Hi,
>>
>> I have a geological map in a pair of files called USGS.tif and
>> USGS.tif.aux.xml
>>
>> The XML seems to have ground control points (<SourceGCPs>) and a geographic
>> coordinate system (<SpatialReference>)
>
> GDAL .aux.xml files do no have <SourceGCPs> or <SpatialReference> elements,
> so it looks like this .aux.xml file is a USGS specific one (yikes!)

An .aux.xml file with <SourceGCPs> and <SpatialReference> elements
has come up before, as output from ArcGIS; see
http://osgeo-org.1560.x6.nabble.com/gdal-dev-convert-tif-tfwx-aux-xml-to-a-geotiff-td4981730.html#a4982138

> The names understood by GDAL are <GCPList> and the SRS is stored
> as a Projection attribute of <GCPList>

-- 
Andrew C Aitchison


From even.rouault at spatialys.com  Thu Jan 19 04:05:45 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 19 Jan 2017 13:05:45 +0100
Subject: [gdal-dev] Question about .aux.xml sidecar file handling...
In-Reply-To: <alpine.LRH.2.20.1701191138070.22492@warden.aitchison.me.uk>
References: <CAE=8kmk1e+WyxnMB6Ps21wbwooByzpbB4BgESwqzpXn9V1O09A@mail.gmail.com>
 <2874773.FrH93sjt3e@even-i700>
 <alpine.LRH.2.20.1701191138070.22492@warden.aitchison.me.uk>
Message-ID: <5268117.SAYrt29aMg@even-i700>

On jeudi 19 janvier 2017 11:43:00 CET Andrew C Aitchison wrote:
> On Thu, 19 Jan 2017, Even Rouault wrote:
> > On mercredi 18 janvier 2017 06:55:49 CET Carl Godkin wrote:
> >> Hi,
> >> 
> >> I have a geological map in a pair of files called USGS.tif and
> >> USGS.tif.aux.xml
> >> 
> >> The XML seems to have ground control points (<SourceGCPs>) and a
> >> geographic
> >> coordinate system (<SpatialReference>)
> > 
> > GDAL .aux.xml files do no have <SourceGCPs> or <SpatialReference>
> > elements,
> > so it looks like this .aux.xml file is a USGS specific one (yikes!)
> 
> An .aux.xml file with <SourceGCPs> and <SpatialReference> elements
> has come up before, as output from ArcGIS; see
> http://osgeo-org.1560.x6.nabble.com/gdal-dev-convert-tif-tfwx-aux-xml-to-a-g
> eotiff-td4981730.html#a4982138

Ah, good catch. Digging further, I can see that GDAL code has some support for interpreting 
part of this ESRI specific stuff in
https://github.com/OSGeo/gdal/blob/trunk/gdal/gcore/gdalpamdataset.cpp#L416

But that's only for GeodataXform.SpatialReference.WKT, not for GCPs.


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170119/52c94a71/attachment.html>

From CABO at NIRAS.DK  Thu Jan 19 04:25:41 2017
From: CABO at NIRAS.DK (=?iso-8859-1?Q?Casper_B=F8rgesen_=28CABO=29?=)
Date: Thu, 19 Jan 2017 12:25:41 +0000
Subject: [gdal-dev] Strange results of simple polygonising
Message-ID: <BCF6B63AE0B25941A7F56567B58A2805C581C577@allkexa1.NIRAS.INT>

Hi,

I have four simple rasters that I would like to polygonise:

1:
# # #
#    #
# #

2:
# #
#     #
# # #

3:
    # #
#     #
# # #

4:
# # #
#    #
   # #

It's the same shape, just rotated 90, 180, 270 degrees. The resulting polygons for 1 and 2 are simple polygons without holes, where the results for 3 and 4 are polygons with a hole intersecting the exterior ring. Thus 3 and 4 results in invalid geometries with self-intersection.

Is this the intended behavior of the polygoniser?


Regards, Casper
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170119/b152ffc2/attachment.html>

From even.rouault at spatialys.com  Thu Jan 19 05:38:03 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 19 Jan 2017 14:38:03 +0100
Subject: [gdal-dev] Shapefile with one feature and many
	incrementally-added vertices is huge
In-Reply-To: <1943720.RkdJRijS39@even-i700>
References: <9538B926-A94A-45A2-A646-AB586EAE8542@nixanz.com>
 <1943720.RkdJRijS39@even-i700>
Message-ID: <1903966.lS5EkX1vRY@even-i700>

> In that
> particular case the writer could realize that we are editing the last
> geometry, so it could safely overwrite in place, but this isn't 
implemented
> yet.

Well, that was rather simple to implement. So fixed per
https://trac.osgeo.org/gdal/ticket/6787

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170119/d7bc5aec/attachment.html>

From cgodkin at gmail.com  Thu Jan 19 06:15:15 2017
From: cgodkin at gmail.com (Carl Godkin)
Date: Thu, 19 Jan 2017 06:15:15 -0800
Subject: [gdal-dev] Question about .aux.xml sidecar file handling...
In-Reply-To: <2874773.FrH93sjt3e@even-i700>
References: <CAE=8kmk1e+WyxnMB6Ps21wbwooByzpbB4BgESwqzpXn9V1O09A@mail.gmail.com>
 <2874773.FrH93sjt3e@even-i700>
Message-ID: <CAE=8kmmGj9eucnSF1Mbi-mSc7Bg4iOCvFbvyZ894KFtyyRh=Ww@mail.gmail.com>

On Thu, Jan 19, 2017 at 3:17 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> On mercredi 18 janvier 2017 06:55:49 CET Carl Godkin wrote:
>
> > Hi,
>
> >
>
> > I have a geological map in a pair of files called USGS.tif and
>
> > USGS.tif.aux.xml
>
> >
>
> > The XML seems to have ground control points (<SourceGCPs>) and a
> geographic
>
> > coordinate system (<SpatialReference>)
>
>
>
> GDAL .aux.xml files do no have <SourceGCPs> or <SpatialReference>
> elements, so it looks like this .aux.xml file is a USGS specific one
> (yikes!)
>
> The names understood by GDAL are <GCPList> and the SRS is stored as a
> Projection attribute of <GCPList>
>
>
>
>
>
Hi Even & Jukka,

This folder on my Google drive contains the two folders.  They are not
private or anything so please feel free to test with them if you need them:

https://drive.google.com/drive/folders/0B-pQ1UXElObET3Nfbk9qQ1VDZWc

Thanks a lot,

carl
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170119/f88ee114/attachment-0001.html>

From sfkeller at gmail.com  Thu Jan 19 06:31:07 2017
From: sfkeller at gmail.com (Stefan Keller)
Date: Thu, 19 Jan 2017 15:31:07 +0100
Subject: [gdal-dev] Shapefile with one feature and many
 incrementally-added vertices is huge
In-Reply-To: <1903966.lS5EkX1vRY@even-i700>
References: <9538B926-A94A-45A2-A646-AB586EAE8542@nixanz.com>
 <1943720.RkdJRijS39@even-i700> <1903966.lS5EkX1vRY@even-i700>
Message-ID: <CAFcOn2-MTyDBoqfUCwb4ixMqpmP4xaAyTOhia2Vkkm5E_3E0oA@mail.gmail.com>

@Even: Great work!

@Nik: I would avoid using Shapefile in the first place.
IMHO there are other formats which hare better suited for this use
case, like e.g. GeoPackage.

:Stefan

2017-01-19 14:38 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:
>> In that
>
>> particular case the writer could realize that we are editing the last
>
>> geometry, so it could safely overwrite in place, but this isn't
>> implemented
>
>> yet.
>
>
>
> Well, that was rather simple to implement. So fixed per
>
> https://trac.osgeo.org/gdal/ticket/6787
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at spatialys.com  Thu Jan 19 07:55:46 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 19 Jan 2017 16:55:46 +0100
Subject: [gdal-dev] Question about .aux.xml sidecar file handling...
In-Reply-To: <CAE=8kmmGj9eucnSF1Mbi-mSc7Bg4iOCvFbvyZ894KFtyyRh=Ww@mail.gmail.com>
References: <CAE=8kmk1e+WyxnMB6Ps21wbwooByzpbB4BgESwqzpXn9V1O09A@mail.gmail.com>
 <2874773.FrH93sjt3e@even-i700>
 <CAE=8kmmGj9eucnSF1Mbi-mSc7Bg4iOCvFbvyZ894KFtyyRh=Ww@mail.gmail.com>
Message-ID: <1487613.1yIGFpNKMR@even-i700>

On jeudi 19 janvier 2017 06:15:15 CET Carl Godkin wrote:
> On Thu, Jan 19, 2017 at 3:17 AM, Even Rouault <even.rouault at spatialys.com>
> 
> wrote:
> > On mercredi 18 janvier 2017 06:55:49 CET Carl Godkin wrote:
> > > Hi,
> > > 
> > > 
> > > 
> > > I have a geological map in a pair of files called USGS.tif and
> > > 
> > > USGS.tif.aux.xml
> > > 
> > > 
> > > 
> > > The XML seems to have ground control points (<SourceGCPs>) and a
> > 
> > geographic
> > 
> > > coordinate system (<SpatialReference>)
> > 
> > GDAL .aux.xml files do no have <SourceGCPs> or <SpatialReference>
> > elements, so it looks like this .aux.xml file is a USGS specific one
> > (yikes!)
> > 
> > The names understood by GDAL are <GCPList> and the SRS is stored as a
> > Projection attribute of <GCPList>
> 
> Hi Even & Jukka,
> 
> This folder on my Google drive contains the two folders.  They are not
> private or anything so please feel free to test with them if you need them:
> 
> https://drive.google.com/drive/folders/0B-pQ1UXElObET3Nfbk9qQ1VDZWc

It seems that in ArcGIS 9.3, .aux.xml had their <GeodataXform> right at the root of the XML 
tree (so not at all compatible with GDAL .aux.xml formalism), and that in ArcGIS 10, they 
moved it as a GDAL PAM xml:ESRI metadata domain.

I've just added in trunk support for reading those GCPs. The "fun" fact is that the (pixel,line) 
coordinates of GCPs are given not in pixels from the top-left corner of the image but in 
inches from the bottom-left corner...

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170119/6470ba8f/attachment.html>

From nik at nixanz.com  Thu Jan 19 15:45:56 2017
From: nik at nixanz.com (Nik Sands)
Date: Fri, 20 Jan 2017 10:45:56 +1100
Subject: [gdal-dev] Shapefile with one feature and many
	incrementally-added vertices is huge
In-Reply-To: <CAFcOn2-MTyDBoqfUCwb4ixMqpmP4xaAyTOhia2Vkkm5E_3E0oA@mail.gmail.com>
Message-ID: <fa88969d86ff35da72a3664a417e3c7395055942@atmail.dreamhost.com>

Thanks Guys,

I appreciate the great responses, and particularly implementing an
update for this edge case.

Unfortunately, I'm stuck with GDAL 1.x for now (have yet to figure out
how to get 2.x to build for iOS, but will take another look some
time).

As for alternatives to Shapefiles, my preference is for
SQLite/Spatialite, but I'm having other problems with that at present
(haven't defined the problems well enough to post a query here yet).

I will take a look at GeoPackage.  I'm not familiar with this format.

Cheers,
Nik.

----- Original Message -----
From: "Stefan Keller" <sfkeller at gmail.com>
To:"Even Rouault" <even.rouault at spatialys.com>
Cc:"gdal-dev at lists.osgeo.org" <gdal-dev at lists.osgeo.org>
Sent:Thu, 19 Jan 2017 15:31:07 +0100
Subject:Re: [gdal-dev] Shapefile with one feature and many
incrementally-added vertices is huge

 @Even: Great work!

 @Nik: I would avoid using Shapefile in the first place.
 IMHO there are other formats which hare better suited for this use
 case, like e.g. GeoPackage.

 :Stefan

 2017-01-19 14:38 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:
 >> In that
 >
 >> particular case the writer could realize that we are editing the
last
 >
 >> geometry, so it could safely overwrite in place, but this isn't
 >> implemented
 >
 >> yet.
 >
 >
 >
 > Well, that was rather simple to implement. So fixed per
 >
 > https://trac.osgeo.org/gdal/ticket/6787
 >
 >
 >
 > Even
 >
 >
 >
 > --
 >
 > Spatialys - Geospatial professional services
 >
 > http://www.spatialys.com
 >
 >
 > _______________________________________________
 > gdal-dev mailing list
 > gdal-dev at lists.osgeo.org
 > https://lists.osgeo.org/mailman/listinfo/gdal-dev
 _______________________________________________
 gdal-dev mailing list
 gdal-dev at lists.osgeo.org
 https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170120/0fc7d4b1/attachment.html>

From mdsumner at gmail.com  Thu Jan 19 19:50:13 2017
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 20 Jan 2017 03:50:13 +0000
Subject: [gdal-dev] Shapefile with one feature and many
 incrementally-added vertices is huge
In-Reply-To: <fa88969d86ff35da72a3664a417e3c7395055942@atmail.dreamhost.com>
References: <CAFcOn2-MTyDBoqfUCwb4ixMqpmP4xaAyTOhia2Vkkm5E_3E0oA@mail.gmail.com>
 <fa88969d86ff35da72a3664a417e3c7395055942@atmail.dreamhost.com>
Message-ID: <CAAcGz98x5MT6Re3MPq4K79Bqwuxu8TPzhEncdJN-mjWMqNUvtw@mail.gmail.com>

A long shot but does any of this help re Mac?

https://github.com/edzer/sfr/issues/40

On Fri, Jan 20, 2017, 10:46 Nik Sands <nik at nixanz.com> wrote:

> Thanks Guys,
>
> I appreciate the great responses, and particularly implementing an update
> for this edge case.
>
> Unfortunately, I'm stuck with GDAL 1.x for now (have yet to figure out how
> to get 2.x to build for iOS, but will take another look some time).
>
> As for alternatives to Shapefiles, my preference is for SQLite/Spatialite,
> but I'm having other problems with that at present (haven't defined the
> problems well enough to post a query here yet).
>
> I will take a look at GeoPackage.  I'm not familiar with this format.
>
> Cheers,
> Nik.
>
>
> ----- Original Message -----
> From:
> "Stefan Keller" <sfkeller at gmail.com>
>
> To:
> "Even Rouault" <even.rouault at spatialys.com>
> Cc:
> "gdal-dev at lists.osgeo.org" <gdal-dev at lists.osgeo.org>
> Sent:
> Thu, 19 Jan 2017 15:31:07 +0100
> Subject:
> Re: [gdal-dev] Shapefile with one feature and many incrementally-added
> vertices is huge
>
>
>
>
> @Even: Great work!
>
> @Nik: I would avoid using Shapefile in the first place.
> IMHO there are other formats which hare better suited for this use
> case, like e.g. GeoPackage.
>
> :Stefan
>
> 2017-01-19 14:38 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:
> >> In that
> >
> >> particular case the writer could realize that we are editing the last
> >
> >> geometry, so it could safely overwrite in place, but this isn't
> >> implemented
> >
> >> yet.
> >
> >
> >
> > Well, that was rather simple to implement. So fixed per
> >
> > https://trac.osgeo.org/gdal/ticket/6787
> >
> >
> >
> > Even
> >
> >
> >
> > --
> >
> > Spatialys - Geospatial professional services
> >
> > http://www.spatialys.com
> >
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170120/429cf30c/attachment.html>

From gregory.bataille at gmail.com  Thu Jan 19 20:45:28 2017
From: gregory.bataille at gmail.com (=?UTF-8?Q?Gr=C3=A9gory_Bataille?=)
Date: Fri, 20 Jan 2017 05:45:28 +0100
Subject: [gdal-dev] Participating on gdal2tiles
Message-ID: <CACVcCzr6QX+rHEcV21vu7Oefm-C3fy6Dn_E0wtDWocW3Ryp_2Q@mail.gmail.com>

Hi everyone,

I just subscribed to this list. Due to current interest, driven by my
current job, I'd like to participate on gdal2tiles.
However I'm not sure how to go about it and how active the development
still is.
I, for example, encountered an issue, that after investigation led me there
https://trac.osgeo.org/gdal/ticket/6057. It's a ticket with a proposed
solution and code patch, but that has seen no activity in 18 months.

Would you mind advising on the best way to contribute? Is the
development/review process, on gdal2tiles still active and is it worth
investing time on it?

Thanks

---
Gregory Bataille
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170120/86369324/attachment.html>

From even.rouault at spatialys.com  Thu Jan 19 23:49:22 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 20 Jan 2017 08:49:22 +0100
Subject: [gdal-dev] Shapefile with one feature and many
	incrementally-added vertices is huge
In-Reply-To: <fa88969d86ff35da72a3664a417e3c7395055942@atmail.dreamhost.com>
References: <fa88969d86ff35da72a3664a417e3c7395055942@atmail.dreamhost.com>
Message-ID: <1590898.AfRmsavgAG@even-i700>

On vendredi 20 janvier 2017 10:45:56 CET Nik Sands wrote:
> Thanks Guys,
> 
> I appreciate the great responses, and particularly implementing an
> update for this edge case.
> 
> Unfortunately, I'm stuck with GDAL 1.x for now (have yet to figure out
> how to get 2.x to build for iOS, but will take another look some
> time).

You should be able to apply the patch to 1.11 in a rather straightforward way.

> 
> As for alternatives to Shapefiles, my preference is for
> SQLite/Spatialite, but I'm having other problems with that at present
> (haven't defined the problems well enough to post a query here yet).
> 
> I will take a look at GeoPackage.  I'm not familiar with this format.
> 
> Cheers,
> Nik.
> 
> ----- Original Message -----
> From: "Stefan Keller" <sfkeller at gmail.com>
> To:"Even Rouault" <even.rouault at spatialys.com>
> Cc:"gdal-dev at lists.osgeo.org" <gdal-dev at lists.osgeo.org>
> Sent:Thu, 19 Jan 2017 15:31:07 +0100
> Subject:Re: [gdal-dev] Shapefile with one feature and many
> incrementally-added vertices is huge
> 
>  @Even: Great work!
> 
>  @Nik: I would avoid using Shapefile in the first place.
>  IMHO there are other formats which hare better suited for this use
>  case, like e.g. GeoPackage.
> 
>  :Stefan
> 
>  2017-01-19 14:38 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:
>  >> In that
>  >> 
>  >> particular case the writer could realize that we are editing the
> 
> last
> 
>  >> geometry, so it could safely overwrite in place, but this isn't
>  >> implemented
>  >> 
>  >> yet.
>  > 
>  > Well, that was rather simple to implement. So fixed per
>  > 
>  > https://trac.osgeo.org/gdal/ticket/6787
>  > 
>  > 
>  > 
>  > Even
>  > 
>  > 
>  > 
>  > --
>  > 
>  > Spatialys - Geospatial professional services
>  > 
>  > http://www.spatialys.com
>  > 
>  > 
>  > _______________________________________________
>  > gdal-dev mailing list
>  > gdal-dev at lists.osgeo.org
>  > https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
>  _______________________________________________
>  gdal-dev mailing list
>  gdal-dev at lists.osgeo.org
>  https://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170120/bf7fa89f/attachment-0001.html>

From even.rouault at spatialys.com  Thu Jan 19 23:59:48 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 20 Jan 2017 08:59:48 +0100
Subject: [gdal-dev] Participating on gdal2tiles
In-Reply-To: <CACVcCzr6QX+rHEcV21vu7Oefm-C3fy6Dn_E0wtDWocW3Ryp_2Q@mail.gmail.com>
References: <CACVcCzr6QX+rHEcV21vu7Oefm-C3fy6Dn_E0wtDWocW3Ryp_2Q@mail.gmail.com>
Message-ID: <1961741.jzr9SKhdGd@even-i700>

On vendredi 20 janvier 2017 05:45:28 CET Grégory Bataille wrote:
> Hi everyone,
> 
> I just subscribed to this list. Due to current interest, driven by my
> current job, I'd like to participate on gdal2tiles.
> However I'm not sure how to go about it and how active the development
> still is.
> I, for example, encountered an issue, that after investigation led me there
> https://trac.osgeo.org/gdal/ticket/6057. It's a ticket with a proposed
> solution and code patch, but that has seen no activity in 18 months.
> 
> Would you mind advising on the best way to contribute? Is the
> development/review process, on gdal2tiles still active and is it worth
> investing time on it?

Hi Grégory,

To be honest, I haven't processed gdal2tiles tickets for years as an experiment to see how 
much time it would take for an existing or new contributor to step up ;-)
I'd suggest you to submit pull requests on the github mirror so that the Travis-CI tests are run 
on your patches. And I'd strongly encourage you to write new tests in ../autotest/pyscripts/
test_gdal2tiles.py for each issue fixed.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170120/7d53ee0d/attachment.html>

From CABO at NIRAS.DK  Fri Jan 20 00:31:17 2017
From: CABO at NIRAS.DK (=?iso-8859-1?Q?Casper_B=F8rgesen_=28CABO=29?=)
Date: Fri, 20 Jan 2017 08:31:17 +0000
Subject: [gdal-dev] FW: Strange results of simple polygonising
In-Reply-To: <BCF6B63AE0B25941A7F56567B58A2805C581C577@allkexa1.NIRAS.INT>
References: <BCF6B63AE0B25941A7F56567B58A2805C581C577@allkexa1.NIRAS.INT>
Message-ID: <BCF6B63AE0B25941A7F56567B58A2805C581C6FF@allkexa1.NIRAS.INT>

I have looked at the special case of a raster combining situation 3 and 4 below:

3 + 4:
   # #
#    #
#    #
  #  #

The polygoniser handles this fine by return a result with two separate polygons.

For easier reference, I have included the WKT of the 4 + 1 situations and their results:

1:
Input:   POLYGON ((1 1,3 1,3 2,2 2,2 3,3 3,3 2,4 2,4 4,1 4,1 1))
Result: POLYGON ((1 4,1 1,3 1,3 2,2 2,2 3,3 3,3 2,4 2,4 4,1 4))

2:
Input:   POLYGON ((1 1,4 1,4 3,3 3,3 2,2 2,2 3,3 3,3 4,1 4,1 1))
Result: POLYGON ((1 4,1 1,4 1,4 3,3 3,3 2,2 2,2 3,3 3,3 4,1 4))

3:
Input:   POLYGON ((1 1,4 1,4 4,2 4,2 3,3 3,3 2,2 2,2 3,1 3,1 1))
Result: POLYGON ((2 4,2 3,1 3,1 1,3 1,4 1,4 4,2 4),(2 3,2 2,3 2,3 3,2 3))

4:
Input:   POLYGON ((1 4,1 2,2 2,2 3,3 3,3 2,2 2,2 1,4 1,4 4,1 4))
Result: POLYGON ((1 4,1 2,2 2,2 1,4 1,4 4,1 4),(2 3,3 3,3 2,2 2,2 3))

3 + 4:
Input:   MULTIPOLYGON (((1 2,2 2,2 4,1 4,1 2)),((2 1,4 1,4 5,2 5,2 4,3 4,3 2,2 2,2 1)))
Result: POLYGON ((1 4,1 2,2 2,2 4,1 4)) + POLYGON ((2 5,2 4,3 4,3 2,2 2,2 1,3 1,4 1,4 5,2 5))

I have performed the tests on both GDAL 1.11 and GDAL 2.1 and both return the same results.

Can anyone confirm my observations?

Background: The 4 situations are very simplified versions of much more complicated polygons, where the problem occurs. If I save the results from situation 3 or 4 to a shape file with ogr, the hole in the results are converted to an exterior ring in a separate polygon thus creating overlapping results.

Regards, Casper

From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Casper Børgesen (CABO)
Sent: 19. januar 2017 13:26
To: gdal-dev at lists.osgeo.org
Subject: [gdal-dev] Strange results of simple polygonising

Hi,

I have four simple rasters that I would like to polygonise:

1:
# # #
#    #
# #

2:
# #
#     #
# # #

3:
    # #
#     #
# # #

4:
# # #
#    #
   # #

It's the same shape, just rotated 90, 180, 270 degrees. The resulting polygons for 1 and 2 are simple polygons without holes, where the results for 3 and 4 are polygons with a hole intersecting the exterior ring. Thus 3 and 4 results in invalid geometries with self-intersection.

Is this the intended behavior of the polygoniser?


Regards, Casper
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170120/ae86f06e/attachment.html>

From even.rouault at spatialys.com  Fri Jan 20 00:34:05 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 20 Jan 2017 09:34:05 +0100
Subject: [gdal-dev] GDAL 2.1.3 release candiate
Message-ID: <3209902.Trj6BosFSY@even-i700>

Hi,

I have prepared a GDAL/OGR 2.1.3 release candidate.

Peek up an archive among the following ones (by ascending size):

  http://download.osgeo.org/gdal/2.1.3/gdal-2.1.3RC1.tar.xz
  http://download.osgeo.org/gdal/2.1.3/gdal-2.1.3RC1.tar.gz
  http://download.osgeo.org/gdal/2.1.3/gdal213RC1.zip

The GRASS plugin has received a few updates for its build scripts:
  http://download.osgeo.org/gdal/2.1.3/gdal-grass-2.1.3.tar.gz

A snapshot of the gdalautotest suite is also available :

  http://download.osgeo.org/gdal/2.1.3/gdalautotest-2.1.3.tar.gz
  http://download.osgeo.org/gdal/2.1.3/gdalautotest-2.1.3.zip

The NEWS file is here :

  http://trac.osgeo.org/gdal/wiki/Release/2.1.3-News

I'll call for a vote promoting it to final in the middle of next week if no
serious problems are reported before.

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170120/a1d4bbf3/attachment-0001.html>

From gregory.bataille at gmail.com  Fri Jan 20 01:33:13 2017
From: gregory.bataille at gmail.com (=?UTF-8?Q?Gr=C3=A9gory_Bataille?=)
Date: Fri, 20 Jan 2017 10:33:13 +0100
Subject: [gdal-dev] Participating on gdal2tiles
In-Reply-To: <1961741.jzr9SKhdGd@even-i700>
References: <CACVcCzr6QX+rHEcV21vu7Oefm-C3fy6Dn_E0wtDWocW3Ryp_2Q@mail.gmail.com>
 <1961741.jzr9SKhdGd@even-i700>
Message-ID: <CACVcCzpZkCyBBWF_n+SYxciZj2Z571mchR3T9HsDozWykCD3Dw@mail.gmail.com>

youhou... :)
ok, I'll see what I can do then


---
Gregory Bataille

On Fri, Jan 20, 2017 at 8:59 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> On vendredi 20 janvier 2017 05:45:28 CET Grégory Bataille wrote:
>
> > Hi everyone,
>
> >
>
> > I just subscribed to this list. Due to current interest, driven by my
>
> > current job, I'd like to participate on gdal2tiles.
>
> > However I'm not sure how to go about it and how active the development
>
> > still is.
>
> > I, for example, encountered an issue, that after investigation led me
> there
>
> > https://trac.osgeo.org/gdal/ticket/6057. It's a ticket with a proposed
>
> > solution and code patch, but that has seen no activity in 18 months.
>
> >
>
> > Would you mind advising on the best way to contribute? Is the
>
> > development/review process, on gdal2tiles still active and is it worth
>
> > investing time on it?
>
>
>
> Hi Grégory,
>
>
>
> To be honest, I haven't processed gdal2tiles tickets for years as an
> experiment to see how much time it would take for an existing or new
> contributor to step up ;-)
>
> I'd suggest you to submit pull requests on the github mirror so that the
> Travis-CI tests are run on your patches. And I'd strongly encourage you to
> write new tests in ../autotest/pyscripts/test_gdal2tiles.py for each
> issue fixed.
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170120/fdc24da4/attachment.html>

From sean at mapbox.com  Fri Jan 20 01:34:59 2017
From: sean at mapbox.com (Sean Gillies)
Date: Fri, 20 Jan 2017 10:34:59 +0100
Subject: [gdal-dev] Participating on gdal2tiles
In-Reply-To: <1961741.jzr9SKhdGd@even-i700>
References: <CACVcCzr6QX+rHEcV21vu7Oefm-C3fy6Dn_E0wtDWocW3Ryp_2Q@mail.gmail.com>
 <1961741.jzr9SKhdGd@even-i700>
Message-ID: <CADPhZXyf9XfVrhdqGzdRdim9-k1OHHPf9frrmtyz6QO=KarWdw@mail.gmail.com>

Hi Grégory,

On Fri, Jan 20, 2017 at 8:59 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> On vendredi 20 janvier 2017 05:45:28 CET Grégory Bataille wrote:
>
> > Hi everyone,
>
> >
>
> > I just subscribed to this list. Due to current interest, driven by my
>
> > current job, I'd like to participate on gdal2tiles.
>
> > However I'm not sure how to go about it and how active the development
>
> > still is.
>
> > I, for example, encountered an issue, that after investigation led me
> there
>
> > https://trac.osgeo.org/gdal/ticket/6057. It's a ticket with a proposed
>
> > solution and code patch, but that has seen no activity in 18 months.
>
> >
>
> > Would you mind advising on the best way to contribute? Is the
>
> > development/review process, on gdal2tiles still active and is it worth
>
> > investing time on it?
>
>
>
> Hi Grégory,
>
>
>
> To be honest, I haven't processed gdal2tiles tickets for years as an
> experiment to see how much time it would take for an existing or new
> contributor to step up ;-)
>
> I'd suggest you to submit pull requests on the github mirror so that the
> Travis-CI tests are run on your patches. And I'd strongly encourage you to
> write new tests in ../autotest/pyscripts/test_gdal2tiles.py for each
> issue fixed.
>
>
>
> Even
>

If you want an example of how to speed things up with Python's
multiprocessing module, check out
https://github.com/mapbox/rio-mbtiles/blob/master/mbtiles/scripts/cli.py.
I've found in rio-mbtiles that the small amount of inter-process
communication overhead is worth it and multiprocessing is the only good way
to achieve CPU intensive concurrency with Python.

Yours,

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170120/3508afbb/attachment.html>

From gregory.bataille at gmail.com  Fri Jan 20 01:53:36 2017
From: gregory.bataille at gmail.com (=?UTF-8?Q?Gr=C3=A9gory_Bataille?=)
Date: Fri, 20 Jan 2017 10:53:36 +0100
Subject: [gdal-dev] Participating on gdal2tiles
In-Reply-To: <CADPhZXyf9XfVrhdqGzdRdim9-k1OHHPf9frrmtyz6QO=KarWdw@mail.gmail.com>
References: <CACVcCzr6QX+rHEcV21vu7Oefm-C3fy6Dn_E0wtDWocW3Ryp_2Q@mail.gmail.com>
 <1961741.jzr9SKhdGd@even-i700>
 <CADPhZXyf9XfVrhdqGzdRdim9-k1OHHPf9frrmtyz6QO=KarWdw@mail.gmail.com>
Message-ID: <CACVcCzq209JFQaGkeWwWb4kydEuq6tBBGegWSx2XPfvVpDiytg@mail.gmail.com>

yes indeed, that would be one of the things I'd like to try and do...
A few bug fix before though and then I'll see

Thanks


---
Gregory Bataille

On Fri, Jan 20, 2017 at 10:34 AM, Sean Gillies <sean at mapbox.com> wrote:

> Hi Grégory,
>
> On Fri, Jan 20, 2017 at 8:59 AM, Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> On vendredi 20 janvier 2017 05:45:28 CET Grégory Bataille wrote:
>>
>> > Hi everyone,
>>
>> >
>>
>> > I just subscribed to this list. Due to current interest, driven by my
>>
>> > current job, I'd like to participate on gdal2tiles.
>>
>> > However I'm not sure how to go about it and how active the development
>>
>> > still is.
>>
>> > I, for example, encountered an issue, that after investigation led me
>> there
>>
>> > https://trac.osgeo.org/gdal/ticket/6057. It's a ticket with a proposed
>>
>> > solution and code patch, but that has seen no activity in 18 months.
>>
>> >
>>
>> > Would you mind advising on the best way to contribute? Is the
>>
>> > development/review process, on gdal2tiles still active and is it worth
>>
>> > investing time on it?
>>
>>
>>
>> Hi Grégory,
>>
>>
>>
>> To be honest, I haven't processed gdal2tiles tickets for years as an
>> experiment to see how much time it would take for an existing or new
>> contributor to step up ;-)
>>
>> I'd suggest you to submit pull requests on the github mirror so that the
>> Travis-CI tests are run on your patches. And I'd strongly encourage you to
>> write new tests in ../autotest/pyscripts/test_gdal2tiles.py for each
>> issue fixed.
>>
>>
>>
>> Even
>>
>
> If you want an example of how to speed things up with Python's
> multiprocessing module, check out https://github.com/mapbox/rio-
> mbtiles/blob/master/mbtiles/scripts/cli.py. I've found in rio-mbtiles
> that the small amount of inter-process communication overhead is worth it
> and multiprocessing is the only good way to achieve CPU intensive
> concurrency with Python.
>
> Yours,
>
> --
> Sean Gillies
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170120/d17ee1ac/attachment.html>

From cgodkin at gmail.com  Fri Jan 20 11:43:34 2017
From: cgodkin at gmail.com (Carl Godkin)
Date: Fri, 20 Jan 2017 11:43:34 -0800
Subject: [gdal-dev] Question about .aux.xml sidecar file handling...
In-Reply-To: <1487613.1yIGFpNKMR@even-i700>
References: <CAE=8kmk1e+WyxnMB6Ps21wbwooByzpbB4BgESwqzpXn9V1O09A@mail.gmail.com>
 <2874773.FrH93sjt3e@even-i700>
 <CAE=8kmmGj9eucnSF1Mbi-mSc7Bg4iOCvFbvyZ894KFtyyRh=Ww@mail.gmail.com>
 <1487613.1yIGFpNKMR@even-i700>
Message-ID: <CAE=8kmn2TC-NWkYTNdGNcxgjMcUOzpv9gXsRdB=65SZjfFrnqg@mail.gmail.com>

On Thu, Jan 19, 2017 at 7:55 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

>
> It seems that in ArcGIS 9.3, .aux.xml had their <GeodataXform> right at
> the root of the XML tree (so not at all compatible with GDAL .aux.xml
> formalism), and that in ArcGIS 10, they moved it as a GDAL PAM xml:ESRI
> metadata domain.
>
>
>
> I've just added in trunk support for reading those GCPs. The "fun" fact is
> that the (pixel,line) coordinates of GCPs are given not in pixels from the
> top-left corner of the image but in inches from the bottom-left corner...
>
>
>
>
>
Outstanding!  This is just what I need.

I was able to use today's version from GISInternals (great site, by the
way!!) to convert my files to a regular georeferenced GeoTIFF with

gdalwarp -tps USGS.tif output.tif

Thanks very much,

carl
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170120/33aa12ba/attachment-0001.html>

From jmckenna at gatewaygeomatics.com  Fri Jan 20 12:07:17 2017
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Fri, 20 Jan 2017 16:07:17 -0400
Subject: [gdal-dev] GDAL 2.1.3 release candiate
In-Reply-To: <3209902.Trj6BosFSY@even-i700>
References: <3209902.Trj6BosFSY@even-i700>
Message-ID: <a8aee468-f336-5ad1-4b9f-9b647c56cac6@gatewaygeomatics.com>

Hi Even,

I tested on Windows with VS2012.  All was fine (including plugins for 
Python, Java, Oracle, ECW), but the CSharp build gave the following error:

---
ogr\OsrPINVOKE.cs(192,10): error CS0111: Type 'OSGeo.OGR.OsrPINVOKE' 
already defines a member called        'OsrPINVOKE' with the same 
parameter types
ogr\OsrPINVOKE.cs(188,10): (Location of symbol related to previous error)
NMAKE : fatal error U1077: 
'C:\WINDOWS\Microsoft.NET\Framework\v4.0.30319\csc.EXE' : return code '0x1'
Stop.
NMAKE : fatal error U1077: '"C:\Program Files (x86)\Microsoft Visual 
Studio 11.0\VC\BIN\nmake.EXE"' : return code '0x2'
Stop.
---

No issues with GDAL 2.1.2 in this environment.


-jeff


-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/



On 2017-01-20 4:34 AM, Even Rouault wrote:
> Hi,
>
>
>
> I have prepared a GDAL/OGR 2.1.3 release candidate.
>
>
>
> Peek up an archive among the following ones (by ascending size):
>
>
>
> http://download.osgeo.org/gdal/2.1.3/gdal-2.1.3RC1.tar.xz
>
> http://download.osgeo.org/gdal/2.1.3/gdal-2.1.3RC1.tar.gz
>
> http://download.osgeo.org/gdal/2.1.3/gdal213RC1.zip
>
>
>
> The GRASS plugin has received a few updates for its build scripts:
>
> http://download.osgeo.org/gdal/2.1.3/gdal-grass-2.1.3.tar.gz
>
>
>
> A snapshot of the gdalautotest suite is also available :
>
>
>
> http://download.osgeo.org/gdal/2.1.3/gdalautotest-2.1.3.tar.gz
>
> http://download.osgeo.org/gdal/2.1.3/gdalautotest-2.1.3.zip
>
>
>
> The NEWS file is here :
>
>
>
> http://trac.osgeo.org/gdal/wiki/Release/2.1.3-News
>
>
>
> I'll call for a vote promoting it to final in the middle of next week if no
>
> serious problems are reported before.
>
>
>
> Best regards,
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
>
>





From nik at nixanz.com  Fri Jan 20 16:27:49 2017
From: nik at nixanz.com (Nik Sands)
Date: Sat, 21 Jan 2017 11:27:49 +1100
Subject: [gdal-dev] EXC_BAD_ACCESS on 1.11 OGROpen() SQLite or GeoPackage
Message-ID: <96DA6BF7-97E9-41A7-A183-4402DF8DA3D3@nixanz.com>

Hi all,

Using GDAL 1.11, I’m getting a crash when attempting to OGROpen() with either the SQLite driver or the GeoPackage driver (which uses SQLite).  Stack trace is below.

My Googling for answers found no results for the specific search criteria I used.  ("gdal exc_bad_access ogropen sqlite3_auto_extension”)

I get an EXC_BAD_ACCESS at the only line in the OGR2SQLITE_Register() function in ogrsqliteviritualogr.cpp .  Ie at:

void OGR2SQLITE_Register()
{
    sqlite3_auto_extension ((void (*)(void)) OGR2SQLITE_static_register);  //  EXC_BAD_ACCESS HERE
}

Has anybody come across something like this, or has any idea what I’m doing wrong here?  (Stack trace below).

(I’m stuck with GDAL 1.x until I can figure out how to build 2.x for iOS.)

Thanks,
Nik.


Stack trace (top few only) from debugger console:
——————————————————
(lldb) bt
* thread #1: tid = 0x3117268, 0x0000000102423403 GIST`OGR2SQLITE_Register() + 19 at ogrsqlitevirtualogr.cpp:2460, queue = 'com.apple.main-thread', stop reason = EXC_BAD_ACCESS (code=1, address=0x600)
  * frame #0: 0x0000000102423403 GIST`OGR2SQLITE_Register() + 19 at ogrsqlitevirtualogr.cpp:2460 [opt]
    frame #1: 0x000000010240a78c GIST`OGRSQLiteDataSource::OpenOrCreateDB(this=0x0000600000193db0, flags=2) + 28 at ogrsqlitedatasource.cpp:455 [opt]
    frame #2: 0x000000010240b498 GIST`OGRSQLiteDataSource::Open(this=0x0000600000193db0, pszNewName=<unavailable>, bUpdateIn=1) + 180 at ogrsqlitedatasource.cpp:993 [opt]
    frame #3: 0x000000010240fd96 GIST`OGRSQLiteDriver::Open(this=<unavailable>, pszFilename="/Users/nsands/Library/Developer/CoreSimulator/Devices/6D46D041-C9C3-498B-A918-85036F1A7EB0/data/Containers/Data/Application/18E913B4-E19B-4C62-8910-2ACB4136C361/Documents/Tracks", bUpdate=1) + 262 at ogrsqlitedriver.cpp:165 [opt]
    frame #4: 0x0000000102401e31 GIST`OGRSFDriverRegistrar::Open(pszName="/Users/nsands/Library/Developer/CoreSimulator/Devices/6D46D041-C9C3-498B-A918-85036F1A7EB0/data/Containers/Data/Application/18E913B4-E19B-4C62-8910-2ACB4136C361/Documents/Tracks", bUpdate=<unavailable>, ppoDriver=<unavailable>) + 227 at ogrsfdriverregistrar.cpp:226 [opt]
    frame #5: 0x0000000102401f80 GIST`::OGROpen(pszName=<unavailable>, bUpdate=<unavailable>, pahDriverList=<unavailable>) + 35 at ogrsfdriverregistrar.cpp:284 [opt]
    frame #6: 0x0000000101fdf9cd GIST`-[VectorDataSource initWithURL:](self=0x00006000000269c0, _cmd="initWithURL:", url=@"file:///Users/nsands/Library/Developer/CoreSimulator/Devices/6D46D041-C9C3-498B-A918-85036F1A7EB0/data/Containers/Data/Application/18E913B4-E19B-4C62-8910-2ACB4136C361/Documents/Tracks") + 189 at VectorDataSource.m:33

========================================================
NIK SANDS
Line Tamer | Time Traveller | Space Cadet


From nik at nixanz.com  Fri Jan 20 17:15:29 2017
From: nik at nixanz.com (Nik Sands)
Date: Sat, 21 Jan 2017 12:15:29 +1100
Subject: [gdal-dev] EXC_BAD_ACCESS on 1.11 OGROpen() SQLite or GeoPackage
In-Reply-To: <96DA6BF7-97E9-41A7-A183-4402DF8DA3D3@nixanz.com>
References: <96DA6BF7-97E9-41A7-A183-4402DF8DA3D3@nixanz.com>
Message-ID: <3C8726AF-0776-4EBA-880D-B292C5CD27F9@nixanz.com>

Please ignore this one (below).  Sorry for wasting the list's time on this one.  I can now build GDAL 2.x for iOS no trouble, and I do not get the crash with GDAL 2.1.2.

(After not being able to get GDAL 2.x to build for iOS last October, I gave up on it and went back to 1.11.  I’ve just tried 2.1.2 and it built first time, no trouble, just using the same build script that I’d been using for 1.11.  I do not know if it is my build script that has changed since October, or if 2.1.2 fixed something that was causing me problems.  I can’t recall what the issue was back then.)


> On 21 Jan 2017, at 11:27 am, Nik Sands <nik at nixanz.com> wrote:
> 
> Hi all,
> 
> Using GDAL 1.11, I’m getting a crash when attempting to OGROpen() with either the SQLite driver or the GeoPackage driver (which uses SQLite).  Stack trace is below.
> 
> My Googling for answers found no results for the specific search criteria I used.  ("gdal exc_bad_access ogropen sqlite3_auto_extension”)
> 
> I get an EXC_BAD_ACCESS at the only line in the OGR2SQLITE_Register() function in ogrsqliteviritualogr.cpp .  Ie at:
> 
> void OGR2SQLITE_Register()
> {
>    sqlite3_auto_extension ((void (*)(void)) OGR2SQLITE_static_register);  //  EXC_BAD_ACCESS HERE
> }
> 
> Has anybody come across something like this, or has any idea what I’m doing wrong here?  (Stack trace below).
> 
> (I’m stuck with GDAL 1.x until I can figure out how to build 2.x for iOS.)
> 
> Thanks,
> Nik.
> 
> 
> Stack trace (top few only) from debugger console:
> ——————————————————
> (lldb) bt
> * thread #1: tid = 0x3117268, 0x0000000102423403 GIST`OGR2SQLITE_Register() + 19 at ogrsqlitevirtualogr.cpp:2460, queue = 'com.apple.main-thread', stop reason = EXC_BAD_ACCESS (code=1, address=0x600)
>  * frame #0: 0x0000000102423403 GIST`OGR2SQLITE_Register() + 19 at ogrsqlitevirtualogr.cpp:2460 [opt]
>    frame #1: 0x000000010240a78c GIST`OGRSQLiteDataSource::OpenOrCreateDB(this=0x0000600000193db0, flags=2) + 28 at ogrsqlitedatasource.cpp:455 [opt]
>    frame #2: 0x000000010240b498 GIST`OGRSQLiteDataSource::Open(this=0x0000600000193db0, pszNewName=<unavailable>, bUpdateIn=1) + 180 at ogrsqlitedatasource.cpp:993 [opt]
>    frame #3: 0x000000010240fd96 GIST`OGRSQLiteDriver::Open(this=<unavailable>, pszFilename="/Users/nsands/Library/Developer/CoreSimulator/Devices/6D46D041-C9C3-498B-A918-85036F1A7EB0/data/Containers/Data/Application/18E913B4-E19B-4C62-8910-2ACB4136C361/Documents/Tracks", bUpdate=1) + 262 at ogrsqlitedriver.cpp:165 [opt]
>    frame #4: 0x0000000102401e31 GIST`OGRSFDriverRegistrar::Open(pszName="/Users/nsands/Library/Developer/CoreSimulator/Devices/6D46D041-C9C3-498B-A918-85036F1A7EB0/data/Containers/Data/Application/18E913B4-E19B-4C62-8910-2ACB4136C361/Documents/Tracks", bUpdate=<unavailable>, ppoDriver=<unavailable>) + 227 at ogrsfdriverregistrar.cpp:226 [opt]
>    frame #5: 0x0000000102401f80 GIST`::OGROpen(pszName=<unavailable>, bUpdate=<unavailable>, pahDriverList=<unavailable>) + 35 at ogrsfdriverregistrar.cpp:284 [opt]
>    frame #6: 0x0000000101fdf9cd GIST`-[VectorDataSource initWithURL:](self=0x00006000000269c0, _cmd="initWithURL:", url=@"file:///Users/nsands/Library/Developer/CoreSimulator/Devices/6D46D041-C9C3-498B-A918-85036F1A7EB0/data/Containers/Data/Application/18E913B4-E19B-4C62-8910-2ACB4136C361/Documents/Tracks") + 189 at VectorDataSource.m:33
> 
> ========================================================
> NIK SANDS
> Line Tamer | Time Traveller | Space Cadet
> 


========================================================
NIK SANDS
Line Tamer | Time Traveller | Space Cadet

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170121/d27886f0/attachment.html>

From mj10777 at googlemail.com  Fri Jan 20 19:26:19 2017
From: mj10777 at googlemail.com (Mark Johnson)
Date: Sat, 21 Jan 2017 04:26:19 +0100
Subject: [gdal-dev] Participating on gdal2tiles
Message-ID: <CAEEbjBgDy9QdvjAkkmp_x2e797UYahSbZpJ-hXWZ2m33Z8tGTA@mail.gmail.com>

You might also consider incorporating the mbtiles implementation of a fork
of gdal2tiles that can be found here:

https://github.com/mj10777/gdal2mbtiles

Here the goal was to also offer mbtiles as the output-format
- instead of a tiles-directory

It also offered options to use mbtiles as a source
- to create a tiles-directory

or

a tiles-directory to create a mbtiles file.

---
The created mbtiles file is based on the mbtiles-implementation of of the
Geopaparazzi (Android) project
- that also reads/creates mbtiles

https://github.com/geopaparazzi/geopaparazzi/wiki/mbtiles-Implementation

A major goal of this implementation was to avoid the creation of  duplicate
images inside the mbtiles file
- which, depending on the input files, could save a lot of space

The project itself was created so that the Geopaparazzi users could 'port'
their tiles-directories to mbtiles
- since the space needed on sdcard's for tiles-directories is very high and
slow

It was always the intention to incorporate this into gdal2tiles, but not
being a Python expert/fan, I was always hoping that someone could take this
over and maintain it.

Mark Johnson, Berlin Germany
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170121/1315e1a0/attachment-0001.html>

From even.rouault at spatialys.com  Fri Jan 20 21:53:31 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 21 Jan 2017 06:53:31 +0100
Subject: [gdal-dev] GDAL 2.1.3 release candiate
In-Reply-To: <a8aee468-f336-5ad1-4b9f-9b647c56cac6@gatewaygeomatics.com>
References: <3209902.Trj6BosFSY@even-i700>
 <a8aee468-f336-5ad1-4b9f-9b647c56cac6@gatewaygeomatics.com>
Message-ID: <2189779.jL9ZoSA2uT@even-i700>

On vendredi 20 janvier 2017 16:07:17 CET Jeff McKenna wrote:
> Hi Even,
> 
> I tested on Windows with VS2012.  All was fine (including plugins for
> Python, Java, Oracle, ECW), but the CSharp build gave the following error:
> 
> ---
> ogr\OsrPINVOKE.cs(192,10): error CS0111: Type 'OSGeo.OGR.OsrPINVOKE'
> already defines a member called        'OsrPINVOKE' with the same
> parameter types
> ogr\OsrPINVOKE.cs(188,10): (Location of symbol related to previous error)
> NMAKE : fatal error U1077:
> 'C:\WINDOWS\Microsoft.NET\Framework\v4.0.30319\csc.EXE' : return code '0x1'
> Stop.
> NMAKE : fatal error U1077: '"C:\Program Files (x86)\Microsoft Visual
> Studio 11.0\VC\BIN\nmake.EXE"' : return code '0x2'
> Stop.
> ---
> 
> No issues with GDAL 2.1.2 in this environment.

Jeff, are you 200% sure you are using exactly the same build environment ? And in particular 
the same SWIG version. I've reviewed the diff between the gdal-2.1.2.tar.gz and 
gdal-2.1.3RC1.tar.gz and there's no change that is csharp related. I get the same error as you 
on Linux if using SWIG 2 (and other errors if using SWIG 3. You created https://
trac.osgeo.org/gdal/ticket/6465 about that). As far as I know, SWIG 1.3 (verified with SWIG 
1.3.40) is the only version compatible of the (current state of) CSharp bindings. So you have 
to use different SWIG versions depending on the binding language...

Tamas, do you have plans to do updates so we can build with recent SWIG versions ? I guess 
we should go straight to SWIG 3 right now.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170121/3acbdf9c/attachment.html>

From ari.jolma at gmail.com  Sat Jan 21 00:51:32 2017
From: ari.jolma at gmail.com (Ari Jolma)
Date: Sat, 21 Jan 2017 10:51:32 +0200
Subject: [gdal-dev] FW: Strange results of simple polygonising
In-Reply-To: <BCF6B63AE0B25941A7F56567B58A2805C581C6FF@allkexa1.NIRAS.INT>
References: <BCF6B63AE0B25941A7F56567B58A2805C581C577@allkexa1.NIRAS.INT>
 <BCF6B63AE0B25941A7F56567B58A2805C581C6FF@allkexa1.NIRAS.INT>
Message-ID: <f0c9a417-5f08-e2d8-dbb8-8f513e6c1559@gmail.com>

Casper,

The polygonizer can be used in 4 or 8 connected modes. I'm not sure 
which one you used. My results are the following. (I used GeoTransform 
(0,1,0,3,0,-1) for the rasters.

4-connected:

1:
POLYGON ((0 3,0 0,2 0,2 1,1 1,1 2,2 2,2 1,3 1,3 3,0 3))
POLYGON ((1 2,1 1,2 1,2 2,1 2))
POLYGON ((2 1,2 0,3 0,3 1,2 1))
2:
POLYGON ((0 3,0 0,3 0,3 2,2 2,2 1,1 1,1 2,2 2,2 3,0 3))
POLYGON ((2 3,2 2,3 2,3 3,2 3))
POLYGON ((1 2,1 1,2 1,2 2,1 2))
3:
POLYGON ((0 3,0 2,1 2,1 3,0 3))
POLYGON ((1 3,1 2,0 2,0 0,2 0,3 0,3 3,1 3),(1 2,1 1,2 1,2 2,1 2))
POLYGON ((1 2,1 1,2 1,2 2,1 2))
4:
POLYGON ((1 2,1 1,2 1,2 2,1 2))
POLYGON ((0 1,0 0,1 0,1 1,0 1))
POLYGON ((0 3,0 1,1 1,1 0,3 0,3 3,0 3),(1 2,2 2,2 1,1 1,1 2))
3+4:
POLYGON ((0 4,0 3,1 3,1 4,0 4))
POLYGON ((0 3,0 1,1 1,1 3,0 3))
POLYGON ((1 3,1 1,2 1,2 3,1 3))
POLYGON ((0 1,0 0,1 0,1 1,0 1))
POLYGON ((1 4,1 3,2 3,2 1,1 1,1 0,2 0,3 0,3 4,1 4))

8-connected:

1:
POLYGON ((0 3,0 0,2 0,2 1,1 1,1 2,2 2,2 1,3 1,3 3,0 3))
POLYGON ((1 2,1 1,2 1,2 0,3 0,3 1,2 1,2 2,1 2))
2:
POLYGON ((0 3,0 0,3 0,3 2,2 2,2 1,1 1,1 2,2 2,2 3,0 3))
POLYGON ((2 3,2 2,1 2,1 1,2 1,2 2,3 2,3 3,2 3))
3:
POLYGON ((0 3,0 2,1 2,1 1,2 1,2 2,1 2,1 3,0 3))
POLYGON ((1 3,1 2,0 2,0 0,2 0,3 0,3 3,1 3),(1 2,1 1,2 1,2 2,1 2))
4:
POLYGON ((0 3,0 1,1 1,1 0,3 0,3 3,0 3),(1 2,2 2,2 1,1 1,1 2))
POLYGON ((1 2,1 1,0 1,0 0,1 0,1 1,2 1,2 2,1 2))
3+4:
POLYGON ((0 4,0 3,1 3,1 1,0 1,0 0,1 0,1 1,2 1,2 3,1 3,1 4,0 4))
POLYGON ((1 4,1 3,0 3,0 1,1 1,1 0,2 0,3 0,3 4,1 4),(1 3,1 1,2 1,2 3,1 3))

To me the results seem to be correct by manual checking with QGIS.

Can you show the code that you used?

Best,

Ari

the code that I used to generate these results:

use Modern::Perl;
use Geo::GDAL;

sub polygonize {
     my ($b, $name) = @_;
     my $l2 = Geo::OGR::Driver('ESRI 
Shapefile')->Create('.')->CreateLayer($name);
     my $options = {'8CONNECTED' => 1};
     my $l = $b->Polygonize(Options => $options);
     $l->ResetReading();
     while (my $f = $l->GetNextFeature()) {
         $l2->CreateFeature($f);
         my $g = $f->GetGeometry();
         say $g->As(Format => 'WKT');
     }
}

system "rm test*";

my $b = Geo::GDAL::Driver('MEM')->Create(Width => 3, Height => 3)->Band;
$b->Dataset->GeoTransform(0,1,0,3,0,-1);
$b->Dataset->SpatialReference(Geo::OSR::SpatialReference->new(EPSG=>3067));
my $d = $b->ReadTile;

# 1:

$d->[0] = [1,1,1];
$d->[1] = [1,0,1];
$d->[2] = [1,1,0];
$b->WriteTile($d);
$b->Dataset->Translate('test1.tiff');
say "1:";
polygonize($b, 'test1');

$d->[0] = [1,1,0];
$d->[1] = [1,0,1];
$d->[2] = [1,1,1];
$b->WriteTile($d);
$b->Dataset->Translate('test2.tiff');
say "2:";
polygonize($b, 'test2');

$d->[0] = [0,1,1];
$d->[1] = [1,0,1];
$d->[2] = [1,1,1];
$b->WriteTile($d);
$b->Dataset->Translate('test3.tiff');
say "3:";
polygonize($b, 'test3');

$d->[0] = [1,1,1];
$d->[1] = [1,0,1];
$d->[2] = [0,1,1];
$b->WriteTile($d);
$b->Dataset->Translate('test4.tiff');
say "4:";
polygonize($b, 'test4');

$b = Geo::GDAL::Driver('MEM')->Create(Width => 3, Height => 4)->Band;
$b->Dataset->GeoTransform(0,1,0,4,0,-1);
$b->Dataset->SpatialReference(Geo::OSR::SpatialReference->new(EPSG=>3067));
$d = $b->ReadTile;

$d->[0] = [0,1,1];
$d->[1] = [1,0,1];
$d->[2] = [1,0,1];
$d->[3] = [0,1,1];
$b->WriteTile($d);
$b->Dataset->Translate('test3+4.tiff');
say "3+4:";
polygonize($b, 'test3+4');


20.01.2017, 10:31, Casper Børgesen (CABO) kirjoitti:
>
> I have looked at the special case of a raster combining situation 3 
> and 4 below:
>
> 3 + 4:
>
> # #
>
> #   #
>
> #  #
>
> #  #
>
> The polygoniser handles this fine by return a result with two separate 
> polygons.
>
> For easier reference, I have included the WKT of the 4 + 1 situations 
> and their results:
>
> 1:
>
> Input:  POLYGON ((1 1,3 1,3 2,2 2,2 3,3 3,3 2,4 2,4 4,1 4,1 1))
>
> Result: POLYGON ((1 4,1 1,3 1,3 2,2 2,2 3,3 3,3 2,4 2,4 4,1 4))
>
> 2:
>
> Input: POLYGON ((1 1,4 1,4 3,3 3,3 2,2 2,2 3,3 3,3 4,1 4,1 1))
>
> Result: POLYGON ((1 4,1 1,4 1,4 3,3 3,3 2,2 2,2 3,3 3,3 4,1 4))
>
> 3:
>
> Input:   POLYGON ((1 1,4 1,4 4,2 4,2 3,3 3,3 2,2 2,2 3,1 3,1 1))
>
> Result: POLYGON ((2 4,2 3,1 3,1 1,3 1,4 1,4 4,2 4),(2 3,2 2,3 2,3 3,2 3))
>
> 4:
>
> Input: POLYGON ((1 4,1 2,2 2,2 3,3 3,3 2,2 2,2 1,4 1,4 4,1 4))
>
> Result: POLYGON ((1 4,1 2,2 2,2 1,4 1,4 4,1 4),(2 3,3 3,3 2,2 2,2 3))
>
> 3 + 4:
>
> Input: MULTIPOLYGON (((1 2,2 2,2 4,1 4,1 2)),((2 1,4 1,4 5,2 5,2 4,3 
> 4,3 2,2 2,2 1)))
>
> Result: POLYGON ((1 4,1 2,2 2,2 4,1 4)) + POLYGON ((2 5,2 4,3 4,3 2,2 
> 2,2 1,3 1,4 1,4 5,2 5))
>
> I have performed the tests on both GDAL 1.11 and GDAL 2.1 and both 
> return the same results.
>
> Can anyone confirm my observations?
>
> /Background: The 4 situations are very simplified versions of much 
> more complicated polygons, where the problem occurs. If I save the 
> results from situation 3 or 4 to a shape file with ogr, the hole in 
> the results are converted to an exterior ring in a separate polygon 
> thus creating overlapping results./
>
> Regards, Casper
>
> *From:*gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] *On Behalf 
> Of *Casper Børgesen (CABO)
> *Sent:* 19. januar 2017 13:26
> *To:* gdal-dev at lists.osgeo.org
> *Subject:* [gdal-dev] Strange results of simple polygonising
>
> Hi,
>
> I have four simple rasters that I would like to polygonise:
>
> 1:
>
> # # #
>
> #    #
>
> # #
>
> 2:
>
> # #
>
> #     #
>
> # # #
>
> 3:
>
>     # #
>
> #     #
>
> # # #
>
> 4:
>
> # # #
>
> #    #
>
>    # #
>
> It’s the same shape, just rotated 90, 180, 270 degrees. The resulting 
> polygons for 1 and 2 are simple polygons without holes, where the 
> results for 3 and 4 are polygons with a hole intersecting the exterior 
> ring. Thus 3 and 4 results in invalid geometries with self-intersection.
>
> Is this the intended behavior of the polygoniser?
>
> Regards, Casper
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170121/2bbc810e/attachment-0001.html>

From sean at mapbox.com  Sat Jan 21 03:36:18 2017
From: sean at mapbox.com (Sean Gillies)
Date: Sat, 21 Jan 2017 12:36:18 +0100
Subject: [gdal-dev] GDAL 2.1.3 release candiate
In-Reply-To: <3209902.Trj6BosFSY@even-i700>
References: <3209902.Trj6BosFSY@even-i700>
Message-ID: <CADPhZXwnh2bioPe-=zx7zoT-+tNGdiT6R8w15NHGW1wD7ma5Dg@mail.gmail.com>

Even,

All the Rasterio tests pass with 2.1.3RC1.

On Fri, Jan 20, 2017 at 9:34 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
>
>
> I have prepared a GDAL/OGR 2.1.3 release candidate.
>
>
>
> Peek up an archive among the following ones (by ascending size):
>
>
>
> http://download.osgeo.org/gdal/2.1.3/gdal-2.1.3RC1.tar.xz
>
> http://download.osgeo.org/gdal/2.1.3/gdal-2.1.3RC1.tar.gz
>
> http://download.osgeo.org/gdal/2.1.3/gdal213RC1.zip
>
>
>
> The GRASS plugin has received a few updates for its build scripts:
>
> http://download.osgeo.org/gdal/2.1.3/gdal-grass-2.1.3.tar.gz
>
>
>
> A snapshot of the gdalautotest suite is also available :
>
>
>
> http://download.osgeo.org/gdal/2.1.3/gdalautotest-2.1.3.tar.gz
>
> http://download.osgeo.org/gdal/2.1.3/gdalautotest-2.1.3.zip
>
>
>
> The NEWS file is here :
>
>
>
> http://trac.osgeo.org/gdal/wiki/Release/2.1.3-News
>
>
>
> I'll call for a vote promoting it to final in the middle of next week if no
>
> serious problems are reported before.
>
>
>
> Best regards,
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170121/95df8da1/attachment.html>

From jmckenna at gatewaygeomatics.com  Sat Jan 21 04:09:53 2017
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Sat, 21 Jan 2017 08:09:53 -0400
Subject: [gdal-dev] GDAL 2.1.3 release candiate
In-Reply-To: <2189779.jL9ZoSA2uT@even-i700>
References: <3209902.Trj6BosFSY@even-i700>
 <a8aee468-f336-5ad1-4b9f-9b647c56cac6@gatewaygeomatics.com>
 <2189779.jL9ZoSA2uT@even-i700>
Message-ID: <fdad2fab-105b-bafb-1cb2-ff9024950f41@gatewaygeomatics.com>

On 2017-01-21 1:53 AM, Even Rouault wrote:
> On vendredi 20 janvier 2017 16:07:17 CET Jeff McKenna wrote:
>
>> Hi Even,
>
>>
>
>> I tested on Windows with VS2012. All was fine (including plugins for
>
>> Python, Java, Oracle, ECW), but the CSharp build gave the following error:
>
>>
>
>> ---
>
>> ogr\OsrPINVOKE.cs(192,10): error CS0111: Type 'OSGeo.OGR.OsrPINVOKE'
>
>> already defines a member called 'OsrPINVOKE' with the same
>
>> parameter types
>
>> ogr\OsrPINVOKE.cs(188,10): (Location of symbol related to previous error)
>
>> NMAKE : fatal error U1077:
>
>> 'C:\WINDOWS\Microsoft.NET\Framework\v4.0.30319\csc.EXE' : return code
> '0x1'
>
>> Stop.
>
>> NMAKE : fatal error U1077: '"C:\Program Files (x86)\Microsoft Visual
>
>> Studio 11.0\VC\BIN\nmake.EXE"' : return code '0x2'
>
>> Stop.
>
>> ---
>
>>
>
>> No issues with GDAL 2.1.2 in this environment.
>
>
>
> Jeff, are you 200% sure you are using exactly the same build environment
> ? And in particular the same SWIG version. I've reviewed the diff
> between the gdal-2.1.2.tar.gz and gdal-2.1.3RC1.tar.gz and there's no
> change that is csharp related. I get the same error as you on Linux if
> using SWIG 2 (and other errors if using SWIG 3. You created
> https://trac.osgeo.org/gdal/ticket/6465 about that). As far as I know,
> SWIG 1.3 (verified with SWIG 1.3.40) is the only version compatible of
> the (current state of) CSharp bindings. So you have to use different
> SWIG versions depending on the binding language...
>
>
>
> Tamas, do you have plans to do updates so we can build with recent SWIG
> versions ? I guess we should go straight to SWIG 3 right now.
>
>
>

Hi Even,

I had made sure of my correct SWIG 1.3.39 environment yesterday before 
reporting.  But, it was like (my gut feeling) the compiler was finding 
previously compiled SWIG-generated files (as I had noticed yesterday 
that the gdal213RC1.zip contained SWIG-generated files inside 
/swig/csharp/ogr/ from a SWIG 2.1.12 - which I don't have).

So today, thinking on this issue more, I tried to run an "nmake /f 
makefile.vc clean" from inside /swig (which removes all of the SWIG 
2.0.12 files that were included in the original archive) and I am able 
to compile the C# bindings with SWIG 1.3.39

Even: can you be sure to clean that SWIG directory before packaging?

Agreed, it would be nice to avoid all this juggling of SWIG versions for 
bindings, and make sure they all build with SWIG 3.x

-jeff


-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/





From even.rouault at spatialys.com  Sat Jan 21 04:56:55 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 21 Jan 2017 13:56:55 +0100
Subject: [gdal-dev] GDAL 2.1.3 release candiate
In-Reply-To: <fdad2fab-105b-bafb-1cb2-ff9024950f41@gatewaygeomatics.com>
References: <3209902.Trj6BosFSY@even-i700> <2189779.jL9ZoSA2uT@even-i700>
 <fdad2fab-105b-bafb-1cb2-ff9024950f41@gatewaygeomatics.com>
Message-ID: <1652775.4CX3CcVS5I@even-i700>

> Hi Even,
> 
> I had made sure of my correct SWIG 1.3.39 environment yesterday before
> reporting.  But, it was like (my gut feeling) the compiler was finding
> previously compiled SWIG-generated files (as I had noticed yesterday
> that the gdal213RC1.zip contained SWIG-generated files inside
> /swig/csharp/ogr/ from a SWIG 2.1.12 - which I don't have).

Ah indeed, I see that mkgdaldist.sh creates SWIG-generated files for csharp, and on the 
machine I used to generate the tarball SWIG 2.0.12 was used, which explains things.

> 
> So today, thinking on this issue more, I tried to run an "nmake /f
> makefile.vc clean" from inside /swig (which removes all of the SWIG
> 2.0.12 files that were included in the original archive) and I am able
> to compile the C# bindings with SWIG 1.3.39

That or probably running explictly "nmake /f makefile.vc interface" from swig/csharp

> 
> Even: can you be sure to clean that SWIG directory before packaging?

Actually I'm going to comment out the generation of the SWIG-generated files for the csharp 
bindings for now in mkgdaldist.sh for a next time.

I won't issue a new RC just for that though, as the issue was the same for GDAL 2.1.2.

Thanks for your tests.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170121/1ae079b8/attachment.html>

From gdt at lexort.com  Sat Jan 21 08:31:30 2017
From: gdt at lexort.com (Greg Troxel)
Date: Sat, 21 Jan 2017 11:31:30 -0500
Subject: [gdal-dev] GDAL 2.1.3 release candiate
In-Reply-To: <3209902.Trj6BosFSY@even-i700> (Even Rouault's message of "Fri,
 20 Jan 2017 09:34:05 +0100")
References: <3209902.Trj6BosFSY@even-i700>
Message-ID: <smuo9z0wf19.fsf@linuxpal.mit.edu>


(I'm working on upgrading the pkgsrc entry from 2.0.3 to 2.1.2.  Surely
from there 2.1.3 will be easy.  I don't yet have a coherent note about
where I am on this, but wanted to post something quick.  Once I've done
that I'll either test 2.1.3RC or move to 2.1.3 depending on where you
are.  This is not a request to wait for me; I'm behind and that wouldn't
be reasonable.)

I couldn't find how to run tests (which I am assuming exist);
there was not a test or check target.   I didn't find a README in th
sources, and the wiki info which I did find pointed to by docs doesn't
mention running tests.


For 2.1.2 I had to add the following patch.  (I realize this belongs in
configure.in, but we patch configure instead when we aren't already
regenerating it.)  Not a big deal but it will cause configure to fail
with a POSIX-conforming shell without bash extensions, and pkgsrc's
portability check code throws an error.





$NetBSD$

Remediate bashism.
Not yet reported upstream.

--- configure.orig	2016-10-24 11:00:31.000000000 +0000
+++ configure
@@ -16861,7 +16861,7 @@ ac_link='$CC -o conftest$ac_exeext $CFLA
 ac_compiler_gnu=$ac_cv_c_compiler_gnu
 
 
-if test "x$CXX" == x ; then
+if test "x$CXX" = x ; then
   as_fn_error $? "\"You don't have a working C++ compiler.\"" "$LINENO" 5
 fi
 

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 162 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170121/ce8de17b/attachment.sig>

From sebastic at xs4all.nl  Sat Jan 21 08:36:06 2017
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Sat, 21 Jan 2017 17:36:06 +0100
Subject: [gdal-dev] GDAL 2.1.3 release candiate
In-Reply-To: <smuo9z0wf19.fsf@linuxpal.mit.edu>
References: <3209902.Trj6BosFSY@even-i700> <smuo9z0wf19.fsf@linuxpal.mit.edu>
Message-ID: <7d0c07b8-5b7c-9f05-db7f-de04fd4da32d@xs4all.nl>

On 01/21/2017 05:31 PM, Greg Troxel wrote:
> I couldn't find how to run tests (which I am assuming exist);
> there was not a test or check target.   I didn't find a README in th
> sources, and the wiki info which I did find pointed to by docs doesn't
> mention running tests.

https://trac.osgeo.org/gdal/wiki/TestingNotes documents:

"
 The primary means of testing is to run the gdalautotest python
 regression test suite. After building with either the old or new
 generation python bindings, and installing them (or adding them to
 your path from the build tree) do the following:

 % svn checkout https://svn.osgeo.org/gdal/trunk/autotest
 % cd autotest
 % ./run_all.py
"

Kind Regards,

Bas

-- 
 GPG Key ID: 4096R/6750F10AE88D4AF1
Fingerprint: 8182 DE41 7056 408D 6146  50D1 6750 F10A E88D 4AF1

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 833 bytes
Desc: OpenPGP digital signature
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170121/37cd5bd0/attachment-0001.sig>

From even.rouault at spatialys.com  Sat Jan 21 12:04:08 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 21 Jan 2017 21:04:08 +0100
Subject: [gdal-dev] GDAL 2.1.3 release candiate
In-Reply-To: <smuo9z0wf19.fsf@linuxpal.mit.edu>
References: <3209902.Trj6BosFSY@even-i700> <smuo9z0wf19.fsf@linuxpal.mit.edu>
Message-ID: <3135744.47CakTLZbd@even-i700>

On samedi 21 janvier 2017 11:31:30 CET Greg Troxel wrote:
> (I'm working on upgrading the pkgsrc entry from 2.0.3 to 2.1.2.  Surely
> from there 2.1.3 will be easy.  I don't yet have a coherent note about
> where I am on this, but wanted to post something quick.  Once I've done
> that I'll either test 2.1.3RC or move to 2.1.3 depending on where you
> are.  This is not a request to wait for me; I'm behind and that wouldn't
> be reasonable.)
> 
> I couldn't find how to run tests (which I am assuming exist);
> there was not a test or check target.   I didn't find a README in th
> sources, and the wiki info which I did find pointed to by docs doesn't
> mention running tests.
> 
> 
> For 2.1.2 I had to add the following patch. 

Committed. Thanks

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170121/9938f4f2/attachment.html>

From gregory.bataille at gmail.com  Sun Jan 22 00:00:59 2017
From: gregory.bataille at gmail.com (=?UTF-8?Q?Gr=C3=A9gory_Bataille?=)
Date: Sun, 22 Jan 2017 09:00:59 +0100
Subject: [gdal-dev] Participating on gdal2tiles
In-Reply-To: <CAEEbjBgDy9QdvjAkkmp_x2e797UYahSbZpJ-hXWZ2m33Z8tGTA@mail.gmail.com>
References: <CAEEbjBgDy9QdvjAkkmp_x2e797UYahSbZpJ-hXWZ2m33Z8tGTA@mail.gmail.com>
Message-ID: <CACVcCzoJ+9rMeci_1UPjQW2056erT+gvd0hNcJLV6ZikUZBeAg@mail.gmail.com>

Hey all,

2 questions:
seeing that it's complex to build trunk on mac (and that some recent
changes have an impact on gdal2tiles output), I wanted to setup the vagrant
box, but I get this error. Any clue?

> shell provisioner:
> * `path` for shell provisioner does not exist on the host system:
> /Users/gbataille/Documents/Prog/Perso/gdal/gdal/scripts/vagrant/sfcgal.sh


Second question: is there a python style-guide? I can see some consistency
in the way the code is written but it's not following the PEP8 community
standard and my editor is growing red spots all over the place. Any concern
if I try to correct that bit by bit to PEP8?

Thanks


---
Gregory Bataille

On Sat, Jan 21, 2017 at 4:26 AM, Mark Johnson <mj10777 at googlemail.com>
wrote:

> You might also consider incorporating the mbtiles implementation of a fork
> of gdal2tiles that can be found here:
>
> https://github.com/mj10777/gdal2mbtiles
>
> Here the goal was to also offer mbtiles as the output-format
> - instead of a tiles-directory
>
> It also offered options to use mbtiles as a source
> - to create a tiles-directory
>
> or
>
> a tiles-directory to create a mbtiles file.
>
> ---
> The created mbtiles file is based on the mbtiles-implementation of of the
> Geopaparazzi (Android) project
> - that also reads/creates mbtiles
>
> https://github.com/geopaparazzi/geopaparazzi/wiki/mbtiles-Implementation
>
> A major goal of this implementation was to avoid the creation
> of  duplicate images inside the mbtiles file
> - which, depending on the input files, could save a lot of space
>
> The project itself was created so that the Geopaparazzi users could 'port'
> their tiles-directories to mbtiles
> - since the space needed on sdcard's for tiles-directories is very high
> and slow
>
> It was always the intention to incorporate this into gdal2tiles, but not
> being a Python expert/fan, I was always hoping that someone could take this
> over and maintain it.
>
> Mark Johnson, Berlin Germany
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170122/828cc054/attachment.html>

From even.rouault at spatialys.com  Sun Jan 22 02:09:59 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 22 Jan 2017 11:09:59 +0100
Subject: [gdal-dev] Participating on gdal2tiles
In-Reply-To: <CACVcCzoJ+9rMeci_1UPjQW2056erT+gvd0hNcJLV6ZikUZBeAg@mail.gmail.com>
References: <CAEEbjBgDy9QdvjAkkmp_x2e797UYahSbZpJ-hXWZ2m33Z8tGTA@mail.gmail.com>
 <CACVcCzoJ+9rMeci_1UPjQW2056erT+gvd0hNcJLV6ZikUZBeAg@mail.gmail.com>
Message-ID: <1673277.nVqvsxUZsl@even-i700>

On dimanche 22 janvier 2017 09:00:59 CET Grégory Bataille wrote:
> Hey all,
> 
> 2 questions:
> seeing that it's complex to build trunk on mac (and that some recent
> changes have an impact on gdal2tiles output),

is it ? You can have a look at the scripts in ci/travis/osx used for the OsX target on Travis-CI. 
They probably don't drag all dependencies though.

> I wanted to setup the vagrant
> box, but I get this error. Any clue?

I've just committed the missing file. Was missing a svn add at some point during a branch 
merge.

> 
> Second question: is there a python style-guide?

Not that much. https://trac.osgeo.org/gdal/wiki/rfc8_devguide just mentions:
"""
* All Python code in autotest, swig/python/scripts and swig/python/samples should pass 
OK with the Pyflakes checker (version used currently: 0.8.1). This is asserted by Travis-CI 
jobs 
* Python code should be written to be compatible with both Python 2 and Python 3. 
"""

> I can see some consistency
> in the way the code is written but it's not following the PEP8 community
> standard and my editor is growing red spots all over the place. Any concern
> if I try to correct that bit by bit to PEP8?

I don't have a strong personal opinon about PEP8 vs non-PEP8, but it seems that many 
Python projects enforce PEP8 compliance, so why not. The only thing to be careful with is to 
separate pure style change commits from functional change commits. Otherwise it is a 
history mess.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170122/9b02f5f5/attachment.html>

From hellik at web.de  Sun Jan 22 02:19:01 2017
From: hellik at web.de (Helmut Kudrnovsky)
Date: Sun, 22 Jan 2017 03:19:01 -0700 (MST)
Subject: [gdal-dev] Google Summer of Code ideas page: action required latest
 by February 5th!
Message-ID: <1485080341799-5304324.post@n6.nabble.com>

Dear All,

It’s that time of the year again! 

Applications for Google Summer of Code 2017 are now open for would-be mentor
organizations, and we are in the process of applying on behalf of OSGeo. At
this stage, it is extremely important that we put up a nice and informative
ideas page, that Google will look at in order to evaluate OSGeo’s
application. 

*We need your help!* 

As previous years, we will create an OSGeo Ideas page, that links to
software communities ideas pages. If you wish to participate, please, start
listing the ideas and the corresponding mentors of your software community
and send us the link to your wiki page latest by February 5th. 

And spread the word as much as you can!!

*Please note that from this year we have set up a group email for admin
purpose where you can reach all of us OSGeo GSoC admins at once: 
gsoc-admin at osgeo.org.*

For further GSoC-related discussions e.g. inter/cross-project
ideas/proposals, ideas discussions, etc please use the long established
OSGeo’s SoC -- Google Summer of Code Coordination mailing list
(https://lists.osgeo.org/mailman/listinfo/soc).

Thank you 
the OSGeo GSoC Admins Team 2017



-----
best regards
Helmut
--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Google-Summer-of-Code-ideas-page-action-required-latest-by-February-5th-tp5304324.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From gregory.bataille at gmail.com  Sun Jan 22 02:21:06 2017
From: gregory.bataille at gmail.com (=?UTF-8?Q?Gr=C3=A9gory_Bataille?=)
Date: Sun, 22 Jan 2017 11:21:06 +0100
Subject: [gdal-dev] Participating on gdal2tiles
In-Reply-To: <1673277.nVqvsxUZsl@even-i700>
References: <CAEEbjBgDy9QdvjAkkmp_x2e797UYahSbZpJ-hXWZ2m33Z8tGTA@mail.gmail.com>
 <CACVcCzoJ+9rMeci_1UPjQW2056erT+gvd0hNcJLV6ZikUZBeAg@mail.gmail.com>
 <1673277.nVqvsxUZsl@even-i700>
Message-ID: <CACVcCzoVDe6t4uXec7U6LMa4=aOUstpcNtEY2uB6cAjjgx_USg@mail.gmail.com>

Yes it is. There was a commit on the test_gdal2tiles.py changing the
checksum values for test 1 :)

that's odd, it's pyflakes that is throwing me those warnings... well flake8
actually that is pyflakes + pep8. I'll have a look anyway.
And yes, the style commits need to be separate, no worries.

I did launch the vagrant by commenting this missing script. Now what is the
vagrant box supposed to do? my understanding is that is comes with gdal
installed (from trunk?)
I think the gdal2tiles.py test (and maybe some other python ones) are not
working in the vagrant box because those tests are looking for scripts to
test (gdal2tiles.py for example) in relative from the test file
test_gdal2tiles.py and because the Vagrantfile only maps the autotest
folder from the host to the client VM, the source for those python scripts
is not available in the VM.
Is it on purpose? would you see any issue mapping the source gdal folder
inside the vagrant box next to the autotest folder?

Sorry for the questions, it's always hard to enter into a project.

Last one actually for this mail:
I have an issue on a particular image. To test a fix (and non-regression in
the future) I can either try to do some mocking (but seeing how
gdal2tiles.py is not very modular, that might prove a nightmare) or use
some specific image that I know present the issue. If I want to test based
on an image, is it an ok practice to put the image in the repo (I can see
that there are several already but that doesn't seem like a great idea to
me). Any other common storage place (AWS S3 or whatever) that you would
have available or recommend otherwise?

Thanks


---
Gregory Bataille

On Sun, Jan 22, 2017 at 11:09 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> On dimanche 22 janvier 2017 09:00:59 CET Grégory Bataille wrote:
>
> > Hey all,
>
> >
>
> > 2 questions:
>
> > seeing that it's complex to build trunk on mac (and that some recent
>
> > changes have an impact on gdal2tiles output),
>
>
>
> is it ? You can have a look at the scripts in ci/travis/osx used for the
> OsX target on Travis-CI. They probably don't drag all dependencies though.
>
>
>
> > I wanted to setup the vagrant
>
> > box, but I get this error. Any clue?
>
>
>
> I've just committed the missing file. Was missing a svn add at some point
> during a branch merge.
>
>
>
> >
>
> > Second question: is there a python style-guide?
>
>
>
> Not that much. https://trac.osgeo.org/gdal/wiki/rfc8_devguide just
> mentions:
>
> """
>
> * All Python code in autotest, swig/python/scripts and swig/python/samples
> should pass OK with the Pyflakes checker (version used currently: 0.8.1).
> This is asserted by Travis-CI jobs
>
> * Python code should be written to be compatible with both Python 2 and
> Python 3.
>
> """
>
>
>
> > I can see some consistency
>
> > in the way the code is written but it's not following the PEP8 community
>
> > standard and my editor is growing red spots all over the place. Any
> concern
>
> > if I try to correct that bit by bit to PEP8?
>
>
>
> I don't have a strong personal opinon about PEP8 vs non-PEP8, but it seems
> that many Python projects enforce PEP8 compliance, so why not. The only
> thing to be careful with is to separate pure style change commits from
> functional change commits. Otherwise it is a history mess.
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170122/e69b6ef4/attachment-0001.html>

From even.rouault at spatialys.com  Sun Jan 22 02:47:23 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 22 Jan 2017 11:47:23 +0100
Subject: [gdal-dev] Participating on gdal2tiles
In-Reply-To: <CACVcCzoVDe6t4uXec7U6LMa4=aOUstpcNtEY2uB6cAjjgx_USg@mail.gmail.com>
References: <CAEEbjBgDy9QdvjAkkmp_x2e797UYahSbZpJ-hXWZ2m33Z8tGTA@mail.gmail.com>
 <1673277.nVqvsxUZsl@even-i700>
 <CACVcCzoVDe6t4uXec7U6LMa4=aOUstpcNtEY2uB6cAjjgx_USg@mail.gmail.com>
Message-ID: <1774946.8v5mMthUf7@even-i700>

On dimanche 22 janvier 2017 11:21:06 CET Grégory Bataille wrote:
> Yes it is. There was a commit on the test_gdal2tiles.py changing the
> checksum values for test 1 :)

Well, that's the life of a project that test results might change because of other changes. Not 
sure to understand if that's your issue, or if it is something Mac specific.

> 
> that's odd, it's pyflakes that is throwing me those warnings... well flake8
> actually that is pyflakes + pep8. I'll have a look anyway.
> And yes, the style commits need to be separate, no worries.
> 
> I did launch the vagrant by commenting this missing script. Now what is the
> vagrant box supposed to do? my understanding is that is comes with gdal
> installed (from trunk?)
> I think the gdal2tiles.py test (and maybe some other python ones) are not
> working in the vagrant box because those tests are looking for scripts to
> test (gdal2tiles.py for example) in relative from the test file
> test_gdal2tiles.py and because the Vagrantfile only maps the autotest
> folder from the host to the client VM, the source for those python scripts
> is not available in the VM.
> Is it on purpose? would you see any issue mapping the source gdal folder
> inside the vagrant box next to the autotest folder?

Honestly I did the initial crack on setting up the Vagrant things as it was suggested it might 
help other people, but I don't use it personnaly, so it has probably rotten up, or might not be 
optimally done. The root folder (ie the one with the gdal/ and autotest/ directories) should 
probably be done. Feel free to do appropriate changes.

> 
> Sorry for the questions, it's always hard to enter into a project.
> 
> Last one actually for this mail:
> I have an issue on a particular image. To test a fix (and non-regression in
> the future) I can either try to do some mocking (but seeing how
> gdal2tiles.py is not very modular, that might prove a nightmare) or use
> some specific image that I know present the issue. If I want to test based
> on an image, is it an ok practice to put the image in the repo (I can see
> that there are several already but that doesn't seem like a great idea to
> me). Any other common storage place (AWS S3 or whatever) that you would
> have available or recommend otherwise?

We must indeed be careful before adding new binaries (like images) in the repository to 
avoid its size to grow out of control. It is best if one can reuse existing images. Or create 
synthetic images that compress very well to few kilobytes or ten of kilobytes (sometimes the 
creation can be part of the test, so you don't have to store any binary in the repo). If the 
important thing is the size and georeferencing of the image, but not the pixel content, you 
can easily do a small black image with
"gdal_translate in.tif out.tif -scale 0 1 0 0 -co TILED=YES -co SPARSE_OK=YES" (with trunk)
Actually you can also do "gdal_translate in.tif out.vrt -of VRT" and edit the VRT to remove all 
<SimpleSource>. That will be even smaller.

We don't have a project AWS S3 bucket, but we have
http://download.osgeo.org/gdal/data/ where we can put some images. But it is a bit more 
cumbersome than having the images directly accessible from the SVN since you must do 
some checks (you can grep autotest/ for "http://download.osgeo.org/gdal/data/" to see how 
we use them)). And by default in the Travis-CI setups we don't enable those downloads from 
external resources because of the extra time it can take and reliability problems it causes.

One aspect that might impact test is the proj.4 version being used. We don't currently have a 
requirement on the proj.4 version used and I'm pretty sure we have different versions used in 
the various Travis-CI + AppVeyor configs. So we sometimes have to add alternate expected 
checksums when the test result is sensitive to proj.4 changes.

Writing tests might be non-trivial. I'm very well aware of the problem.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170122/9dece6d3/attachment.html>

From gregory.bataille at gmail.com  Sun Jan 22 03:45:04 2017
From: gregory.bataille at gmail.com (=?UTF-8?Q?Gr=C3=A9gory_Bataille?=)
Date: Sun, 22 Jan 2017 12:45:04 +0100
Subject: [gdal-dev] Participating on gdal2tiles
In-Reply-To: <1774946.8v5mMthUf7@even-i700>
References: <CAEEbjBgDy9QdvjAkkmp_x2e797UYahSbZpJ-hXWZ2m33Z8tGTA@mail.gmail.com>
 <1673277.nVqvsxUZsl@even-i700>
 <CACVcCzoVDe6t4uXec7U6LMa4=aOUstpcNtEY2uB6cAjjgx_USg@mail.gmail.com>
 <1774946.8v5mMthUf7@even-i700>
Message-ID: <CACVcCzqpHh9Bxsq3UBhNDGgzL1p-QQVw60aVWbmYGq8RJSW=1w@mail.gmail.com>

 ok thanks :)


---
Gregory Bataille

On Sun, Jan 22, 2017 at 11:47 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> On dimanche 22 janvier 2017 11:21:06 CET Grégory Bataille wrote:
>
> > Yes it is. There was a commit on the test_gdal2tiles.py changing the
>
> > checksum values for test 1 :)
>
>
>
> Well, that's the life of a project that test results might change because
> of other changes. Not sure to understand if that's your issue, or if it is
> something Mac specific.
>
>
>
> >
>
> > that's odd, it's pyflakes that is throwing me those warnings... well
> flake8
>
> > actually that is pyflakes + pep8. I'll have a look anyway.
>
> > And yes, the style commits need to be separate, no worries.
>
> >
>
> > I did launch the vagrant by commenting this missing script. Now what is
> the
>
> > vagrant box supposed to do? my understanding is that is comes with gdal
>
> > installed (from trunk?)
>
> > I think the gdal2tiles.py test (and maybe some other python ones) are not
>
> > working in the vagrant box because those tests are looking for scripts to
>
> > test (gdal2tiles.py for example) in relative from the test file
>
> > test_gdal2tiles.py and because the Vagrantfile only maps the autotest
>
> > folder from the host to the client VM, the source for those python
> scripts
>
> > is not available in the VM.
>
> > Is it on purpose? would you see any issue mapping the source gdal folder
>
> > inside the vagrant box next to the autotest folder?
>
>
>
> Honestly I did the initial crack on setting up the Vagrant things as it
> was suggested it might help other people, but I don't use it personnaly, so
> it has probably rotten up, or might not be optimally done. The root folder
> (ie the one with the gdal/ and autotest/ directories) should probably be
> done. Feel free to do appropriate changes.
>
>
>
> >
>
> > Sorry for the questions, it's always hard to enter into a project.
>
> >
>
> > Last one actually for this mail:
>
> > I have an issue on a particular image. To test a fix (and non-regression
> in
>
> > the future) I can either try to do some mocking (but seeing how
>
> > gdal2tiles.py is not very modular, that might prove a nightmare) or use
>
> > some specific image that I know present the issue. If I want to test
> based
>
> > on an image, is it an ok practice to put the image in the repo (I can see
>
> > that there are several already but that doesn't seem like a great idea to
>
> > me). Any other common storage place (AWS S3 or whatever) that you would
>
> > have available or recommend otherwise?
>
>
>
> We must indeed be careful before adding new binaries (like images) in the
> repository to avoid its size to grow out of control. It is best if one can
> reuse existing images. Or create synthetic images that compress very well
> to few kilobytes or ten of kilobytes (sometimes the creation can be part of
> the test, so you don't have to store any binary in the repo). If the
> important thing is the size and georeferencing of the image, but not the
> pixel content, you can easily do a small black image with
>
> "gdal_translate in.tif out.tif -scale 0 1 0 0 -co TILED=YES -co
> SPARSE_OK=YES" (with trunk)
>
> Actually you can also do "gdal_translate in.tif out.vrt -of VRT" and edit
> the VRT to remove all <SimpleSource>. That will be even smaller.
>
>
>
> We don't have a project AWS S3 bucket, but we have
>
> http://download.osgeo.org/gdal/data/ where we can put some images. But it
> is a bit more cumbersome than having the images directly accessible from
> the SVN since you must do some checks (you can grep autotest/ for "
> http://download.osgeo.org/gdal/data/" to see how we use them)). And by
> default in the Travis-CI setups we don't enable those downloads from
> external resources because of the extra time it can take and reliability
> problems it causes.
>
>
>
> One aspect that might impact test is the proj.4 version being used. We
> don't currently have a requirement on the proj.4 version used and I'm
> pretty sure we have different versions used in the various Travis-CI +
> AppVeyor configs. So we sometimes have to add alternate expected checksums
> when the test result is sensitive to proj.4 changes.
>
>
>
> Writing tests might be non-trivial. I'm very well aware of the problem.
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170122/d15939fd/attachment-0001.html>

From jukka.rahkonen at maanmittauslaitos.fi  Sun Jan 22 08:17:19 2017
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Sun, 22 Jan 2017 16:17:19 +0000
Subject: [gdal-dev] MBTiles from gdal2tiles vs. from gdal_translate
Message-ID: <1485101841644.51812@maanmittauslaitos.fi>

Hi,

In the "Participating on gdal2tiles" thread Mark Johnson wrote:

"You might also consider incorporating the mbtiles implementation of a fork
of gdal2tiles that can be found here:
https://github.com/mj10777/gdal2mbtiles
Here the goal was to also offer mbtiles as the output-format
- instead of a tiles-directory"

I would like to know what advantage/difference there is with saving gdal2tiles output into MBtiles format vs. using gdal_translate with MBTiles driver http://www.gdal.org/frmt_mbtiles.html

-Jukka Rahkonen-

From even.rouault at spatialys.com  Sun Jan 22 09:22:05 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 22 Jan 2017 18:22:05 +0100
Subject: [gdal-dev] MBTiles from gdal2tiles vs. from gdal_translate
In-Reply-To: <1485101841644.51812@maanmittauslaitos.fi>
References: <1485101841644.51812@maanmittauslaitos.fi>
Message-ID: <1977646.W24DBJoleZ@even-i700>

On dimanche 22 janvier 2017 16:17:19 CET Rahkonen Jukka (MML) wrote:
> Hi,
> 
> In the "Participating on gdal2tiles" thread Mark Johnson wrote:
> 
> "You might also consider incorporating the mbtiles implementation of a fork
> of gdal2tiles that can be found here:
> https://github.com/mj10777/gdal2mbtiles
> Here the goal was to also offer mbtiles as the output-format
> - instead of a tiles-directory"
> 
> I would like to know what advantage/difference there is with saving
> gdal2tiles output into MBtiles format vs. using gdal_translate with MBTiles
> driver http://www.gdal.org/frmt_mbtiles.html

If an enhanced gdal2tiles had multiprocessing / multithreading support, that would be one 
advantage.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170122/b8bf0146/attachment.html>

From even.rouault at spatialys.com  Sun Jan 22 11:01:32 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 22 Jan 2017 20:01:32 +0100
Subject: [gdal-dev] MBTiles from gdal2tiles vs. from gdal_translate
In-Reply-To: <1977646.W24DBJoleZ@even-i700>
References: <1485101841644.51812@maanmittauslaitos.fi>
 <1977646.W24DBJoleZ@even-i700>
Message-ID: <2498758.2uqVVdZvAQ@even-i700>

On dimanche 22 janvier 2017 18:22:05 CET Even Rouault wrote:
> On dimanche 22 janvier 2017 16:17:19 CET Rahkonen Jukka (MML) wrote:
> > Hi,
> > 
> > In the "Participating on gdal2tiles" thread Mark Johnson wrote:
> > 
> > "You might also consider incorporating the mbtiles implementation of a
> > fork
> > of gdal2tiles that can be found here:
> > https://github.com/mj10777/gdal2mbtiles
> > Here the goal was to also offer mbtiles as the output-format
> > - instead of a tiles-directory"
> > 
> > I would like to know what advantage/difference there is with saving
> > gdal2tiles output into MBtiles format vs. using gdal_translate with
> > MBTiles
> > driver http://www.gdal.org/frmt_mbtiles.html
> 
> If an enhanced gdal2tiles had multiprocessing / multithreading support, that
> would be one advantage.

Hum actually just realizing that the MBTILES write support uses the warping engine 
underneath (true for GeoPackage with the non CUSTOM tiling schemes as well). So the 
GDAL_NUM_THREADS config option can already be used to speed up the computational 
part.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170122/5887d71a/attachment.html>

From bfraser at geoanalytic.com  Sun Jan 22 19:25:03 2017
From: bfraser at geoanalytic.com (Brent Fraser)
Date: Sun, 22 Jan 2017 20:25:03 -0700
Subject: [gdal-dev] reading MS Access .accdb
Message-ID: <e9e56c7e-e451-638c-6cd3-87401114e3bb@geoanalytic.com>

Hi all,

   I've been trying to get ogrinfo to read some MS Access database 
(.accdb) files so I can link them to some shapefiles.  After some 
digging, I've found that to get ogrinfo to read them, I need to:

1. Rename the .accdb to .mdb

2. Install the MS Access Database Engine Redistributable, such as 
https://www.microsoft.com/en-us/download/details.aspx?id=13255

3. Specify the driver string for the 64-bit driver (I'm using Windows 7 
64-bit and OSGeo4W 64-bit):

     --config MDB_DRIVER_TEMPLATE "DRIVER=Microsoft Access Driver 
(*.mdb, *.accdb);DBQ=%s"

4. Use an explicit path to the file (note the .\ or the full path is 
required):

ogrinfo.exe --config MDB_DRIVER_TEMPLATE "DRIVER=Microsoft Access Driver 
(*.mdb, *.accdb);DBQ=%s"  .\t_408088.mdb

just setting the current dir and specifying "t_408088.mdb" does not work.


I consider 1. and 4. above to be functionality issues/bugs (and 3. is  a 
documentation opportunity).  I see that there was a related issue (and a 
fix) to use the 64-bit driver https://trac.osgeo.org/gdal/ticket/5594

Any comments before I file my bug reports?


-- 
Best Regards,
Brent Fraser



From mj10777 at googlemail.com  Sun Jan 22 21:05:34 2017
From: mj10777 at googlemail.com (Mark Johnson)
Date: Mon, 23 Jan 2017 06:05:34 +0100
Subject: [gdal-dev] MBTiles from gdal2tiles vs. from gdal_translate
Message-ID: <CAEEbjBh=mVuDfg_ggLRF0rx=kmUdS_iW=af_sO7WHa6KKzFUeg@mail.gmail.com>

The main reason (at the time - over 4 years ago) was:
- that there was no write support for mbtiles then
  (as you no doubt saw in the link you provided)

I just tried gdal_translate on a sample file and see:
- that it (seems) to support only 1 zoom level

> Warning 6: driver MBTiles does not support creation option ZOOM_LEVEL
>

Whereas gdal2tiles supports a from/to zoom-levels
- creating the lowest level and then building the upper level from that
-- gdal_translate only does the first, but stops there

Since the main purpose of gdal2tiles is to create a set of tiles
- writing the output to a
-- tile-directory
or
-- a tile-database (which mbtiles is)
is a choice that should be offered.

In this case, the offered code is a full implementation of the mbtiles
specification
- where as gdal_translate seems to have only a minimal support

At the time, the Geopaparazzi Users used gda2tiles heavily
- but due to the restrictions of FAT32 on sdcard's was almost impossible to
use
After the implementation of writing mbtiles directly inside Geopaparazzi
was done
- the reported problems went down to a near 0

Since the need existed for many to use the Application where no Internet
connections exists, with the needed Zoom-Levels, this became a highly used
function.

There has also been no requests the extend the features offered, so the
implementation (which the python version was based upon) seem to fulfill
all the needs.

For gdal2tiles to create a result that is a single file
- is simply easier to employ and use

So the short answer would be:
- one is a full implementation - that would fulfill all needs
- the other a partial implementation - that does not fulfill all needs

Mark
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170123/376bba28/attachment.html>

From geospatialsolutions at gmail.com  Sun Jan 22 23:21:51 2017
From: geospatialsolutions at gmail.com (Jordan Bess)
Date: Mon, 23 Jan 2017 07:21:51 +0000
Subject: [gdal-dev] MBTiles from gdal2tiles vs. from gdal_translate
In-Reply-To: <2498758.2uqVVdZvAQ@even-i700>
References: <1485101841644.51812@maanmittauslaitos.fi>
 <1977646.W24DBJoleZ@even-i700>,<2498758.2uqVVdZvAQ@even-i700>
Message-ID: <BN6PR10MB1603A0F6C10460853EF485DBD4720@BN6PR10MB1603.namprd10.prod.outlook.com>


The work is already multithreaded in several forks of the original gdal2tiles
The one that I use the most is gdal2tiles_parallel.py by Reinventing Geospatial https://gitlab.com/GitLabRGI/geopackage-python/blob/master/Tiling/gdal2tiles_parallel.py

They also have a great python script for making geopackage from a folder of tiles (XYZ or TMS)
It does image processng converting the 32bit RGBA PNG into either hybrid (PNG and JPG) all JPG.
The biggest limitation in the script is does not let you control the table name (tiles) and therefore you can only have one tiles table (can't append to an existing gpkg)
https://gitlab.com/GitLabRGI/geopackage-python/blob/master/Packaging/tiles2gpkg_parallel.py

It would be great to make an equivalent packaging script for mbtiles. (  mbutil and landez python scripts make mbtiles from a folder of tiles)
https://github.com/makinacorpus/landez

Thanks
Jordan

________________________________
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of Even Rouault <even.rouault at spatialys.com>
Sent: Sunday, January 22, 2017 2:01 PM
To: gdal-dev at lists.osgeo.org
Cc: Rahkonen Jukka (MML)
Subject: Re: [gdal-dev] MBTiles from gdal2tiles vs. from gdal_translate


On dimanche 22 janvier 2017 18:22:05 CET Even Rouault wrote:

> On dimanche 22 janvier 2017 16:17:19 CET Rahkonen Jukka (MML) wrote:

> > Hi,

> >

> > In the "Participating on gdal2tiles" thread Mark Johnson wrote:

> >

> > "You might also consider incorporating the mbtiles implementation of a

> > fork

> > of gdal2tiles that can be found here:

> > https://github.com/mj10777/gdal2mbtiles

> > Here the goal was to also offer mbtiles as the output-format

> > - instead of a tiles-directory"

> >

> > I would like to know what advantage/difference there is with saving

> > gdal2tiles output into MBtiles format vs. using gdal_translate with

> > MBTiles

> > driver http://www.gdal.org/frmt_mbtiles.html

>

> If an enhanced gdal2tiles had multiprocessing / multithreading support, that

> would be one advantage.



Hum actually just realizing that the MBTILES write support uses the warping engine underneath (true for GeoPackage with the non CUSTOM tiling schemes as well). So the GDAL_NUM_THREADS config option can already be used to speed up the computational part.



--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170123/2501ba0a/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Mon Jan 23 01:15:00 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Mon, 23 Jan 2017 02:15:00 -0700 (MST)
Subject: [gdal-dev] MBTiles from gdal2tiles vs. from gdal_translate
In-Reply-To: <CAEEbjBh=mVuDfg_ggLRF0rx=kmUdS_iW=af_sO7WHa6KKzFUeg@mail.gmail.com>
References: <1485101841644.51812@maanmittauslaitos.fi>
 <1977646.W24DBJoleZ@even-i700>
 <CAEEbjBh=mVuDfg_ggLRF0rx=kmUdS_iW=af_sO7WHa6KKzFUeg@mail.gmail.com>
Message-ID: <1485162900814-5304403.post@n6.nabble.com>

mj10777 wrote
> The main reason (at the time - over 4 years ago) was:
> - that there was no write support for mbtiles then
>   (as you no doubt saw in the link you provided)

I am interested in what I was asking "what advantage/difference there is
with saving gdal2tiles output into MBtiles format vs. using gdal_translate
with MBTiles driver". That one is older than another is one difference,
though not so important to me. I am not going to claim that one alternative
is better than another. I rather believe that as usual they both have some
stronger and weaker features.


> I just tried gdal_translate on a sample file and see:
> - that it (seems) to support only 1 zoom level

The GDAL way is to run gdaladdo afterwards. It is also documented in
http://www.gdal.org/frmt_mbtiles.html.


> So the short answer would be:
> - one is a full implementation - that would fulfill all needs
> - the other a partial implementation - that does not fulfill all needs

What else is missing from the MBTiles driver in addition to automatic
creation of zoom levels (which probably won't fix)? Perhaps support for
creation option ZOOM_LEVEL for controlling the first level resolution
without a need to use -tr option for setting the target resolution with
gdal_translate? There should be no problem in improving both gdal2tiles.py
and the driver. For example myself I tend to have problems with making a
working GDAL + Python installation.

-Jukka Rahkonen-

Mark






--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-MBTiles-from-gdal2tiles-vs-from-gdal-translate-tp5304349p5304403.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From vladimir.sandoval at yandex.com  Tue Jan 24 08:28:51 2017
From: vladimir.sandoval at yandex.com (Vlad)
Date: Tue, 24 Jan 2017 09:28:51 -0700 (MST)
Subject: [gdal-dev] java.lang.UnsatisfiedLinkError:
 org.gdal.gdal.gdalJNI.Dataset_SWIGUpcast(J)J
Message-ID: <1485275331432-5304636.post@n6.nabble.com>

I have a clean build on RHEL of Gdal 2.1.2.  Java app (as shaded jar) with
the Maven 2.1.0 dependency throws:

Exception in thread "main" java.lang.UnsatisfiedLinkError:
org.gdal.gdal.gdalJNI.Dataset_SWIGUpcast(J)J
        at org.gdal.gdal.gdalJNI.Dataset_SWIGUpcast(Native Method)
        at org.gdal.gdal.Dataset.<init>(Dataset.java:20)
        at org.gdal.gdal.gdal.Open(gdal.java:590)

Reading, I find this is due to a SWIG version incompatibility.  SWIG version
used for the RHEL build was 1.3.40.

Anybody know what SWIG version the Maven 2.1.0 jar was built with?  Also,
assuming someone knows, I can just follow Even's procedure here 

http://osgeo-org.1560.x6.nabble.com/gdal-dev-GDAL-Java-Bindings-Unable-to-use-same-jar-on-linux-and-windows-td5243795.html

to get a "good" build?



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/java-lang-UnsatisfiedLinkError-org-gdal-gdal-gdalJNI-Dataset-SWIGUpcast-J-J-tp5304636.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Tue Jan 24 08:43:37 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 24 Jan 2017 17:43:37 +0100
Subject: [gdal-dev] java.lang.UnsatisfiedLinkError:
	org.gdal.gdal.gdalJNI.Dataset_SWIGUpcast(J)J
In-Reply-To: <1485275331432-5304636.post@n6.nabble.com>
References: <1485275331432-5304636.post@n6.nabble.com>
Message-ID: <2537373.hIB76uLh8L@even-i700>

On mardi 24 janvier 2017 09:28:51 CET Vlad wrote:
> I have a clean build on RHEL of Gdal 2.1.2.  Java app (as shaded jar) with
> the Maven 2.1.0 dependency throws:
> 
> Exception in thread "main" java.lang.UnsatisfiedLinkError:
> org.gdal.gdal.gdalJNI.Dataset_SWIGUpcast(J)J
>         at org.gdal.gdal.gdalJNI.Dataset_SWIGUpcast(Native Method)
>         at org.gdal.gdal.Dataset.<init>(Dataset.java:20)
>         at org.gdal.gdal.gdal.Open(gdal.java:590)
> 
> Reading, I find this is due to a SWIG version incompatibility.  SWIG version
> used for the RHEL build was 1.3.40.
> 
> Anybody know what SWIG version the Maven 2.1.0 jar was built with?

I don't remember unfortunately. The exception you mention is typical of the version 
mismatch indeed, so you could try to generate the cpp part with SWIG 2

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170124/39bdb71e/attachment.html>

From gregory.bataille at gmail.com  Tue Jan 24 20:48:00 2017
From: gregory.bataille at gmail.com (=?UTF-8?Q?Gr=C3=A9gory_Bataille?=)
Date: Wed, 25 Jan 2017 05:48:00 +0100
Subject: [gdal-dev] [gdal2tiles.py] python engineering
Message-ID: <CACVcCzqrHx2DNXUBRxkqP-eoYwJ56QTTSvsFTi6EZcRB_1dRrg@mail.gmail.com>

Hello,

If I want to really spend some time for this utility, I'd like to do some
clean engineering around it.
What I'd like to do is:

- split the script into several files (smaller, single purpose, ...)
--> can you confirm that on all target platform, all .py files are deployed
and the /usr/local/bin/gdal2tiles.py is just an hyperlink on the source
file installed somewhere else?
--> do you see any issue with that?

- Introduce a standard unittesting platform - pytest + tox I guess - (on
top of the autotest thing, I would not attempt to redo them all) that would
be incorporated in the CI

- Clean up the code: follow PEP8 and fix pylint issues. Put PEP8 and pylint
in the CI. Rename the hell out of the variables because I'm banging my head
with rx, ry, lrux and the like :)

Any comments, warnings, problems you can think of?

Cheers

---
Gregory Bataille
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170125/6beba7fd/attachment.html>

From even.rouault at spatialys.com  Wed Jan 25 00:27:06 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 25 Jan 2017 09:27:06 +0100
Subject: [gdal-dev] Motion: Promote 2.1.3RC1 for release
Message-ID: <2037474.ZOKkCMKVsx@even-i700>

Hi,

Motion: GDAL/OGR 2.1.3RC1 is promoted to be the official 2.1.3 final 
release.

---

+1 Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170125/37aae797/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Wed Jan 25 00:44:41 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Wed, 25 Jan 2017 01:44:41 -0700 (MST)
Subject: [gdal-dev] Motion: Promote 2.1.3RC1 for release
In-Reply-To: <2037474.ZOKkCMKVsx@even-i700>
References: <2037474.ZOKkCMKVsx@even-i700>
Message-ID: <1485333881102-5304719.post@n6.nabble.com>

Even Rouault-2 wrote
> Hi,
> 
> Motion: GDAL/OGR 2.1.3RC1 is promoted to be the official 2.1.3 final 
> release.
> 
> ---
> 
> +1 Even

+1

-Jukka Rahkonen-



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Motion-Promote-2-1-3RC1-for-release-tp5304716p5304719.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Wed Jan 25 03:19:46 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 25 Jan 2017 12:19:46 +0100
Subject: [gdal-dev] [gdal2tiles.py] python engineering
In-Reply-To: <CACVcCzqrHx2DNXUBRxkqP-eoYwJ56QTTSvsFTi6EZcRB_1dRrg@mail.gmail.com>
References: <CACVcCzqrHx2DNXUBRxkqP-eoYwJ56QTTSvsFTi6EZcRB_1dRrg@mail.gmail.com>
Message-ID: <14284918.zGBvLDo3T8@even-i700>

On mercredi 25 janvier 2017 05:48:00 CET Grégory Bataille wrote:
> Hello,
> 
> If I want to really spend some time for this utility, I'd like to do some
> clean engineering around it.
> What I'd like to do is:
> 
> - split the script into several files (smaller, single purpose, ...)
> --> can you confirm that on all target platform, all .py files are deployed
> and the /usr/local/bin/gdal2tiles.py is just an hyperlink on the source
> file installed somewhere else?

This depends pretty much on how GDAL is packaged.
On Unix, the default "make install" target will copy any .py file of swig/python/scripts/ to the 
${install_prefix}/bin directory. And for example Debian/Ubuntu packaging follows that.

On OSGeo4W, they do that similarly and have a .bat that creates a .bat shortcut for each 
installed .py file

> --> do you see any issue with that?

Yes, that the sub files would be available as executable scripts, whereas some of them would 
not be.

One could imagine that the code could go to a Python module (gdal_scripts ?), and the top-
level gdal2tiles.py could be something like:
from osgeo import gdal_scripts
gdal_scripts.gdal2tiles(...)

I'm not clear what the effort required / benefit would be however.

> 
> - Introduce a standard unittesting platform - pytest + tox I guess - (on
> top of the autotest thing, I would not attempt to redo them all) that would
> be incorporated in the CI

No opinion on that, having not used any of those. One must keep in mind that GDAL is not a 
pure python project, so not sure how those tools integrate well with the custom approaches 
we might have.

One thing that is missing currently, when comparing to the C++ part, is to get coverage 
information of the Python code.

> 
> - Clean up the code: follow PEP8 and fix pylint issues. Put PEP8 and pylint
> in the CI. Rename the hell out of the variables because I'm banging my head
> with rx, ry, lrux and the like :)
> 
> Any comments, warnings, problems you can think of?

Clearer variable names are always welcome.

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170125/eddb48e0/attachment.html>

From gregory.bataille at gmail.com  Wed Jan 25 03:35:27 2017
From: gregory.bataille at gmail.com (=?UTF-8?Q?Gr=C3=A9gory_Bataille?=)
Date: Wed, 25 Jan 2017 12:35:27 +0100
Subject: [gdal-dev] [gdal2tiles.py] python engineering
In-Reply-To: <14284918.zGBvLDo3T8@even-i700>
References: <CACVcCzqrHx2DNXUBRxkqP-eoYwJ56QTTSvsFTi6EZcRB_1dRrg@mail.gmail.com>
 <14284918.zGBvLDo3T8@even-i700>
Message-ID: <CACVcCzq8yrL_NJbAp+wrM4h5+DSAoVQG8Kic2-NA0KRdPowgrQ@mail.gmail.com>

ok, thansk for the pointers on the deployment side. I'll think about it


---
Gregory Bataille

On Wed, Jan 25, 2017 at 12:19 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> On mercredi 25 janvier 2017 05:48:00 CET Grégory Bataille wrote:
>
> > Hello,
>
> >
>
> > If I want to really spend some time for this utility, I'd like to do some
>
> > clean engineering around it.
>
> > What I'd like to do is:
>
> >
>
> > - split the script into several files (smaller, single purpose, ...)
>
> > --> can you confirm that on all target platform, all .py files are
> deployed
>
> > and the /usr/local/bin/gdal2tiles.py is just an hyperlink on the source
>
> > file installed somewhere else?
>
>
>
> This depends pretty much on how GDAL is packaged.
>
> On Unix, the default "make install" target will copy any .py file of
> swig/python/scripts/ to the ${install_prefix}/bin directory. And for
> example Debian/Ubuntu packaging follows that.
>
>
>
> On OSGeo4W, they do that similarly and have a .bat that creates a .bat
> shortcut for each installed .py file
>
>
>
> > --> do you see any issue with that?
>
>
>
> Yes, that the sub files would be available as executable scripts, whereas
> some of them would not be.
>
>
>
> One could imagine that the code could go to a Python module (gdal_scripts
> ?), and the top-level gdal2tiles.py could be something like:
>
> from osgeo import gdal_scripts
>
> gdal_scripts.gdal2tiles(...)
>
>
>
> I'm not clear what the effort required / benefit would be however.
>
>
>
> >
>
> > - Introduce a standard unittesting platform - pytest + tox I guess - (on
>
> > top of the autotest thing, I would not attempt to redo them all) that
> would
>
> > be incorporated in the CI
>
>
>
> No opinion on that, having not used any of those. One must keep in mind
> that GDAL is not a pure python project, so not sure how those tools
> integrate well with the custom approaches we might have.
>
>
>
> One thing that is missing currently, when comparing to the C++ part, is to
> get coverage information of the Python code.
>
>
>
> >
>
> > - Clean up the code: follow PEP8 and fix pylint issues. Put PEP8 and
> pylint
>
> > in the CI. Rename the hell out of the variables because I'm banging my
> head
>
> > with rx, ry, lrux and the like :)
>
> >
>
> > Any comments, warnings, problems you can think of?
>
>
>
> Clearer variable names are always welcome.
>
>
>
> Even
>
>
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170125/efee2c21/attachment-0001.html>

From jmckenna at gatewaygeomatics.com  Wed Jan 25 05:48:44 2017
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Wed, 25 Jan 2017 09:48:44 -0400
Subject: [gdal-dev] Motion: Promote 2.1.3RC1 for release
In-Reply-To: <2037474.ZOKkCMKVsx@even-i700>
References: <2037474.ZOKkCMKVsx@even-i700>
Message-ID: <cd90c3bd-3939-9b69-c60b-535b7fe91610@gatewaygeomatics.com>


> Motion: GDAL/OGR 2.1.3RC1 is promoted to be the official 2.1.3 final
> release.
>
>
>


+1 jeff





-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/

From ardilgulez at gmail.com  Wed Jan 25 07:35:03 2017
From: ardilgulez at gmail.com (=?UTF-8?Q?Kemal_Ard=C4=B1l_G=C3=BClez?=)
Date: Wed, 25 Jan 2017 18:35:03 +0300
Subject: [gdal-dev] Reading a WFS source with OGR: Most columns don't appear
	in results
Message-ID: <CALdTBvJajAQQ17EVw3Go7g2oncQYBDZrXnX22gjPvuQqMEhRaA@mail.gmail.com>

Hello all,

I'm trying to read a WFS source. The GetFeature request to the WFS source
returns rows in the form of:

<gml:featureMember>
    <groups fid="group.44107041">
        <subgroupno>120</subgroupno>
        <group>288</group>
        <idno>40402578</idno>
        <description>Descripton</description>
        <groundref>56945117</groundref>
        <hoodref>158699</hoodref>
        <surfacearea>804.67</surfacearea>
        <type>2</type>
        <status>2</status>
        <geom>
            <gml:MultiPolygon srsName="
http://www.opengis.net/gml/srs/epsg.xml#4326">
                <gml:polygonMember>
                    <gml:Polygon>
                        <gml:outerBoundaryIs>
                            <gml:LinearRing>
                                <gml:coordinates decimal="." cs="," ts="
">67.58201,80.5654
                                    67.58207,80.5652 67.58187,80.5653
                                    67.58159,80.5654 67.58118,80.5654
                                    67.58118,80.5655 67.58137,80.5655
                                    67.58143,80.5655 67.58159,80.5654
                                    67.58201,80.5654
                                </gml:coordinates>
                            </gml:LinearRing>
                        </gml:outerBoundaryIs>
                    </gml:Polygon>
                </gml:polygonMember>
            </gml:MultiPolygon>
        </geom>
        <createdate>2012-04-08T07:13:10</createdate>
        <netsurfacearea>804.440800604637</netsurfacearea>
        <typeid>2000000000001</typeid>
        <supergroupstatus>2</supergroupstatus>
        <parentstatus>3</parentstatus>
    </groups>
</gml:featureMember>

But when I retrieve it with ogrinfo or ogr-fdw (which also uses OGR for
reading and parsing any ogr data source) for postgres, the only fields that
I can get are:

- fid
- geom
- status
- createdate

Is this some kind of a problem with the WFS driver of OGR or is there
something that I'm doing wrong or I have to do and I'm not doing?

The OGR versions that I tried with are:

- 1.11.4
- 2.1.0
- 2.1.1
- 2.1.2

Thank you all in advance.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170125/5c434870/attachment.html>

From szekerest at gmail.com  Wed Jan 25 07:48:20 2017
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed, 25 Jan 2017 16:48:20 +0100
Subject: [gdal-dev] Motion: Promote 2.1.3RC1 for release
In-Reply-To: <2037474.ZOKkCMKVsx@even-i700>
References: <2037474.ZOKkCMKVsx@even-i700>
Message-ID: <CACALY+Q4cEwWarCgyPQDWiinWAhgTzG_7V8eEGJbaPHvz8E8hQ@mail.gmail.com>

+1

Tamas

2017-01-25 9:27 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:

> Hi,
>
>
>
> Motion: GDAL/OGR 2.1.3RC1 is promoted to be the official 2.1.3 final
> release.
>
>
>
> ---
>
>
>
> +1 Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170125/3cb9ffc7/attachment.html>

From schwehr at gmail.com  Wed Jan 25 10:12:18 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Wed, 25 Jan 2017 10:12:18 -0800
Subject: [gdal-dev] [gdal2tiles.py] python engineering
In-Reply-To: <CACVcCzq8yrL_NJbAp+wrM4h5+DSAoVQG8Kic2-NA0KRdPowgrQ@mail.gmail.com>
References: <CACVcCzqrHx2DNXUBRxkqP-eoYwJ56QTTSvsFTi6EZcRB_1dRrg@mail.gmail.com>
 <14284918.zGBvLDo3T8@even-i700>
 <CACVcCzq8yrL_NJbAp+wrM4h5+DSAoVQG8Kic2-NA0KRdPowgrQ@mail.gmail.com>
Message-ID: <CACmBxyveeHng6PWWkb+cevZgwjE-m50B-2EhQTfu03OcyeHAbg@mail.gmail.com>

Gregory,

Aside: A point of terminology, by hyperlink, I think you mean symbolic link
<https://en.wikipedia.org/wiki/Symbolic_link> or hard link.

As a point of information, I'm using both python unittest and C++ gunit
very effectively for GDAL.  I do use bazel as the build system, but that
doesn't really matter.  A very behind copy of what I've done is here:

https://github.com/schwehr/gdal-autotest2

And, sadly, it looks like I've yet to get any of the python code in there.
I'll try to get at least something in there today.

On Wed, Jan 25, 2017 at 3:35 AM, Grégory Bataille <
gregory.bataille at gmail.com> wrote:

> ok, thansk for the pointers on the deployment side. I'll think about it
>
>
> ---
> Gregory Bataille
>
> On Wed, Jan 25, 2017 at 12:19 PM, Even Rouault <even.rouault at spatialys.com
> > wrote:
>
>> On mercredi 25 janvier 2017 05:48:00 CET Grégory Bataille wrote:
>>
>> > Hello,
>>
>> >
>>
>> > If I want to really spend some time for this utility, I'd like to do
>> some
>>
>> > clean engineering around it.
>>
>> > What I'd like to do is:
>>
>> >
>>
>> > - split the script into several files (smaller, single purpose, ...)
>>
>> > --> can you confirm that on all target platform, all .py files are
>> deployed
>>
>> > and the /usr/local/bin/gdal2tiles.py is just an hyperlink on the source
>>
>> > file installed somewhere else?
>>
>>
>>
>> This depends pretty much on how GDAL is packaged.
>>
>> On Unix, the default "make install" target will copy any .py file of
>> swig/python/scripts/ to the ${install_prefix}/bin directory. And for
>> example Debian/Ubuntu packaging follows that.
>>
>>
>>
>> On OSGeo4W, they do that similarly and have a .bat that creates a .bat
>> shortcut for each installed .py file
>>
>>
>>
>> > --> do you see any issue with that?
>>
>>
>>
>> Yes, that the sub files would be available as executable scripts, whereas
>> some of them would not be.
>>
>>
>>
>> One could imagine that the code could go to a Python module (gdal_scripts
>> ?), and the top-level gdal2tiles.py could be something like:
>>
>> from osgeo import gdal_scripts
>>
>> gdal_scripts.gdal2tiles(...)
>>
>>
>>
>> I'm not clear what the effort required / benefit would be however.
>>
>>
>>
>> >
>>
>> > - Introduce a standard unittesting platform - pytest + tox I guess - (on
>>
>> > top of the autotest thing, I would not attempt to redo them all) that
>> would
>>
>> > be incorporated in the CI
>>
>>
>>
>> No opinion on that, having not used any of those. One must keep in mind
>> that GDAL is not a pure python project, so not sure how those tools
>> integrate well with the custom approaches we might have.
>>
>>
>>
>> One thing that is missing currently, when comparing to the C++ part, is
>> to get coverage information of the Python code.
>>
>>
>>
>> >
>>
>> > - Clean up the code: follow PEP8 and fix pylint issues. Put PEP8 and
>> pylint
>>
>> > in the CI. Rename the hell out of the variables because I'm banging my
>> head
>>
>> > with rx, ry, lrux and the like :)
>>
>> >
>>
>> > Any comments, warnings, problems you can think of?
>>
>>
>>
>> Clearer variable names are always welcome.
>>
>>
>>
>> Even
>>
>>
>>
>>
>>
>> --
>>
>> Spatialys - Geospatial professional services
>>
>> http://www.spatialys.com
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170125/2cf6ae88/attachment-0001.html>

From gregory.bataille at gmail.com  Wed Jan 25 10:52:13 2017
From: gregory.bataille at gmail.com (=?UTF-8?Q?Gr=C3=A9gory_Bataille?=)
Date: Wed, 25 Jan 2017 18:52:13 +0000
Subject: [gdal-dev] [gdal2tiles.py] python engineering
In-Reply-To: <CACmBxyveeHng6PWWkb+cevZgwjE-m50B-2EhQTfu03OcyeHAbg@mail.gmail.com>
References: <CACVcCzqrHx2DNXUBRxkqP-eoYwJ56QTTSvsFTi6EZcRB_1dRrg@mail.gmail.com>
 <14284918.zGBvLDo3T8@even-i700>
 <CACVcCzq8yrL_NJbAp+wrM4h5+DSAoVQG8Kic2-NA0KRdPowgrQ@mail.gmail.com>
 <CACmBxyveeHng6PWWkb+cevZgwjE-m50B-2EhQTfu03OcyeHAbg@mail.gmail.com>
Message-ID: <CACVcCzrSYvD75ZqPx16k54TOx7Xo5pxELJNgrzG21HKQD9QycQ@mail.gmail.com>

You are completely right. Symbolic link. Don't know what I was thinking
about at the time!


On Wed, 25 Jan 2017 at 19:12, Kurt Schwehr <schwehr at gmail.com> wrote:

> Gregory,
>
> Aside: A point of terminology, by hyperlink, I think you mean symbolic
> link <https://en.wikipedia.org/wiki/Symbolic_link> or hard link.
>
> As a point of information, I'm using both python unittest and C++ gunit
> very effectively for GDAL.  I do use bazel as the build system, but that
> doesn't really matter.  A very behind copy of what I've done is here:
>
> https://github.com/schwehr/gdal-autotest2
>
> And, sadly, it looks like I've yet to get any of the python code in
> there.  I'll try to get at least something in there today.
>
> On Wed, Jan 25, 2017 at 3:35 AM, Grégory Bataille <
> gregory.bataille at gmail.com> wrote:
>
> ok, thansk for the pointers on the deployment side. I'll think about it
>
>
> ---
> Gregory Bataille
>
> On Wed, Jan 25, 2017 at 12:19 PM, Even Rouault <even.rouault at spatialys.com
> > wrote:
>
> On mercredi 25 janvier 2017 05:48:00 CET Grégory Bataille wrote:
>
> > Hello,
>
> >
>
> > If I want to really spend some time for this utility, I'd like to do some
>
> > clean engineering around it.
>
> > What I'd like to do is:
>
> >
>
> > - split the script into several files (smaller, single purpose, ...)
>
> > --> can you confirm that on all target platform, all .py files are
> deployed
>
> > and the /usr/local/bin/gdal2tiles.py is just an hyperlink on the source
>
> > file installed somewhere else?
>
>
>
> This depends pretty much on how GDAL is packaged.
>
> On Unix, the default "make install" target will copy any .py file of
> swig/python/scripts/ to the ${install_prefix}/bin directory. And for
> example Debian/Ubuntu packaging follows that.
>
>
>
> On OSGeo4W, they do that similarly and have a .bat that creates a .bat
> shortcut for each installed .py file
>
>
>
> > --> do you see any issue with that?
>
>
>
> Yes, that the sub files would be available as executable scripts, whereas
> some of them would not be.
>
>
>
> One could imagine that the code could go to a Python module (gdal_scripts
> ?), and the top-level gdal2tiles.py could be something like:
>
> from osgeo import gdal_scripts
>
> gdal_scripts.gdal2tiles(...)
>
>
>
> I'm not clear what the effort required / benefit would be however.
>
>
>
> >
>
> > - Introduce a standard unittesting platform - pytest + tox I guess - (on
>
> > top of the autotest thing, I would not attempt to redo them all) that
> would
>
> > be incorporated in the CI
>
>
>
> No opinion on that, having not used any of those. One must keep in mind
> that GDAL is not a pure python project, so not sure how those tools
> integrate well with the custom approaches we might have.
>
>
>
> One thing that is missing currently, when comparing to the C++ part, is to
> get coverage information of the Python code.
>
>
>
> >
>
> > - Clean up the code: follow PEP8 and fix pylint issues. Put PEP8 and
> pylint
>
> > in the CI. Rename the hell out of the variables because I'm banging my
> head
>
> > with rx, ry, lrux and the like :)
>
> >
>
> > Any comments, warnings, problems you can think of?
>
>
>
> Clearer variable names are always welcome.
>
>
>
> Even
>
>
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
> --
> --
> http://schwehr.org
>
-- 
Greg
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170125/e34dac0f/attachment.html>

From even.rouault at spatialys.com  Wed Jan 25 10:54:16 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 25 Jan 2017 19:54:16 +0100
Subject: [gdal-dev] Call for discussion on RFC 67 : Null values in OGR
Message-ID: <5072295.SuT4PmY2Is@even-i700>

Hi,

I've prepared a new RFC regarding the handling of null values in OGR.

https://trac.osgeo.org/gdal/wiki/rfc67_nullfieldvalues

No implementation proposed yet at this stage. I want to check if the 
proposed design choices make sense.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170125/73fd6092/attachment.html>

From even.rouault at spatialys.com  Wed Jan 25 10:57:36 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 25 Jan 2017 19:57:36 +0100
Subject: [gdal-dev] Reading a WFS source with OGR: Most columns don't
	appear in results
In-Reply-To: <CALdTBvJajAQQ17EVw3Go7g2oncQYBDZrXnX22gjPvuQqMEhRaA@mail.gmail.com>
References: <CALdTBvJajAQQ17EVw3Go7g2oncQYBDZrXnX22gjPvuQqMEhRaA@mail.gmail.com>
Message-ID: <1807596.bFfXeXKhHn@even-i700>

On mercredi 25 janvier 2017 18:35:03 CET Kemal Ardıl Gülez wrote:
> Hello all,
> 
> I'm trying to read a WFS source. The GetFeature request to the WFS source
> returns rows in the form of:
> 
> <gml:featureMember>
>     <groups fid="group.44107041">
>         <subgroupno>120</subgroupno>
>         <group>288</group>
>         <idno>40402578</idno>
>         <description>Descripton</description>
>         <groundref>56945117</groundref>
>         <hoodref>158699</hoodref>
>         <surfacearea>804.67</surfacearea>
>         <type>2</type>
>         <status>2</status>
>         <geom>
>             <gml:MultiPolygon srsName="
> http://www.opengis.net/gml/srs/epsg.xml#4326">
>                 <gml:polygonMember>
>                     <gml:Polygon>
>                         <gml:outerBoundaryIs>
>                             <gml:LinearRing>
>                                 <gml:coordinates decimal="." cs="," ts="
> ">67.58201,80.5654
>                                     67.58207,80.5652 67.58187,80.5653
>                                     67.58159,80.5654 67.58118,80.5654
>                                     67.58118,80.5655 67.58137,80.5655
>                                     67.58143,80.5655 67.58159,80.5654
>                                     67.58201,80.5654
>                                 </gml:coordinates>
>                             </gml:LinearRing>
>                         </gml:outerBoundaryIs>
>                     </gml:Polygon>
>                 </gml:polygonMember>
>             </gml:MultiPolygon>
>         </geom>
>         <createdate>2012-04-08T07:13:10</createdate>
>         <netsurfacearea>804.440800604637</netsurfacearea>
>         <typeid>2000000000001</typeid>
>         <supergroupstatus>2</supergroupstatus>
>         <parentstatus>3</parentstatus>
>     </groups>
> </gml:featureMember>
> 
> But when I retrieve it with ogrinfo or ogr-fdw (which also uses OGR for
> reading and parsing any ogr data source) for postgres, the only fields that
> I can get are:
> 
> - fid
> - geom
> - status
> - createdate
> 
> Is this some kind of a problem with the WFS driver of OGR or is there
> something that I'm doing wrong or I have to do and I'm not doing?

Can you show the result of the DescribeFeatureType request, or better just provide the 
endpoint to the WFS server and the layer used ?

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170125/86459d72/attachment-0001.html>

From JPalmer at linz.govt.nz  Wed Jan 25 12:11:18 2017
From: JPalmer at linz.govt.nz (Jeremy Palmer)
Date: Thu, 26 Jan 2017 09:11:18 +1300
Subject: [gdal-dev] Call for discussion on RFC 67 : Null values in OGR
In-Reply-To: <5072295.SuT4PmY2Is@even-i700>
References: <5072295.SuT4PmY2Is@even-i700>
Message-ID: <239522B5-51F2-48B8-9C09-5609F46FA042@linz.govt.nz>

Hi Even,

Change is most welcomed, especially for WFS/GML.

Would there also be changes required to the CSV driver given the new EMPTY_STRING_AS_NULL GDAL 2.1 open option?

Cheers,
Jeremy

On 26/01/2017, at 7:54 AM, Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>> wrote:

Hi,



I've prepared a new RFC regarding the handling of null values in OGR.



https://trac.osgeo.org/gdal/wiki/rfc67_nullfieldvalues



No implementation proposed yet at this stage. I want to check if the proposed design choices make sense.



Even



--
Spatialys - Geospatial professional services
http://www.spatialys.com<http://www.spatialys.com/>
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev


________________________________
This message contains information, which may be in confidence and may be subject to legal privilege. If you are not the intended recipient, you must not peruse, use, disseminate, distribute or copy this message. If you have received this message in error, please notify us immediately (Phone 0800 665 463 or info at linz.govt.nz) and destroy the original message. LINZ accepts no responsibility for changes to this email, or for any attachments, after its transmission from LINZ. Thank You.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170126/af3984a7/attachment.html>

From ari.jolma at gmail.com  Wed Jan 25 12:47:40 2017
From: ari.jolma at gmail.com (Ari Jolma)
Date: Wed, 25 Jan 2017 22:47:40 +0200
Subject: [gdal-dev] Call for discussion on RFC 67 : Null values in OGR
In-Reply-To: <5072295.SuT4PmY2Is@even-i700>
References: <5072295.SuT4PmY2Is@even-i700>
Message-ID: <5018934e-c131-5939-68cf-9412a46760c7@gmail.com>

Even,

In the RFC you write that for JSON OGR currently returns unset fields 
when a field does not exist and when it is null. However, in a simple 
test I wrote this JSON

{ "type": "FeatureCollection", "features": [ { "foo" : "bar" }, { "foo" 
: null }, { } ] }

Opening that as a layer and reading its features I get (in Perl) foo as 
'bar', '', and undef. I.e., null is mapped into an empty string and a 
missing field is mapped as unset (mapped to undef in Perl bindings).

Converting to GML (ogr2ogr -f "GML" test.gml test.json) I get similar 
result - foo is empty string for 2nd feature and missing in 3rd feature. 
Converting it back maps both empty string and missing into JSON null.

For PostgreSQL tables NULL is mapped to unset.

It would be logical if null field would map to null in JSON and NULL in 
SQL but maybe that's not possible in a backwards compatible way.

Ari


25.01.2017, 20:54, Even Rouault kirjoitti:
>
> Hi,
>
> I've prepared a new RFC regarding the handling of null values in OGR.
>
> https://trac.osgeo.org/gdal/wiki/rfc67_nullfieldvalues
>
> No implementation proposed yet at this stage. I want to check if the 
> proposed design choices make sense.
>
> Even
>
> -- 
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170125/7bbd30cd/attachment.html>

From dmorissette at mapgears.com  Wed Jan 25 13:28:36 2017
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Wed, 25 Jan 2017 16:28:36 -0500
Subject: [gdal-dev] Motion: Promote 2.1.3RC1 for release
In-Reply-To: <2037474.ZOKkCMKVsx@even-i700>
References: <2037474.ZOKkCMKVsx@even-i700>
Message-ID: <161189d2-0f6c-615f-b4d4-178801624fed@mapgears.com>

On 2017-01-25 3:27 AM, Even Rouault wrote:
>
> Motion: GDAL/OGR 2.1.3RC1 is promoted to be the official 2.1.3 final
> release.
>
>

+1

Daniel


-- 
Daniel Morissette
http://www.mapgears.com/
T: +1 418-696-5056 #201

http://evouala.com/ - Location Intelligence Made Easy

From ardilgulez at gmail.com  Wed Jan 25 22:08:01 2017
From: ardilgulez at gmail.com (=?UTF-8?Q?Kemal_Ard=C4=B1l_G=C3=BClez?=)
Date: Thu, 26 Jan 2017 09:08:01 +0300
Subject: [gdal-dev] even.rouault@spatialys.com
Message-ID: <CALdTBvLwd0SGv6tsTOmdBjVbH6iDOxqE4Bb+XgG2h5LnM8v05A@mail.gmail.com>

>> Hello all,
>>
>> I'm trying to read a WFS source. The GetFeature request to the WFS source
>> returns rows in the form of:
>>
>> <gml:featureMember>
>>     <groups fid="group.44107041">
>>         <subgroupno>120</subgroupno>
>>         <group>288</group>
>>         <idno>40402578</idno>
>>         <description>Descripton</description>
>>         <groundref>56945117</groundref>
>>         <hoodref>158699</hoodref>
>>         <surfacearea>804.67</surfacearea>
>>         <type>2</type>
>>         <status>2</status>
>>         <geom>
>>             <gml:MultiPolygon srsName="
>> http://www.opengis.net/gml/srs/epsg.xml#4326">
>>                 <gml:polygonMember>
>>                     <gml:Polygon>
>>                         <gml:outerBoundaryIs>
>>                             <gml:LinearRing>
>>                                 <gml:coordinates decimal="." cs="," ts="
>> ">67.58201,80.5654
>>                                     67.58207,80.5652 67.58187,80.5653
>>                                     67.58159,80.5654 67.58118,80.5654
>>                                     67.58118,80.5655 67.58137,80.5655
>>                                     67.58143,80.5655 67.58159,80.5654
>>                                     67.58201,80.5654
>>                                 </gml:coordinates>
>>                             </gml:LinearRing>
>>                         </gml:outerBoundaryIs>
>>                     </gml:Polygon>
>>                 </gml:polygonMember>
>>             </gml:MultiPolygon>
>>         </geom>
>>         <createdate>2012-04-08T07:13:10</createdate>
>>         <netsurfacearea>804.440800604637</netsurfacearea>
>>         <typeid>2000000000001</typeid>
>>         <supergroupstatus>2</supergroupstatus>
>>         <parentstatus>3</parentstatus>
>>     </groups>
>> </gml:featureMember>
>>
>> But when I retrieve it with ogrinfo or ogr-fdw (which also uses OGR for
>> reading and parsing any ogr data source) for postgres, the only fields
that
>> I can get are:
>>
>> - fid
>> - geom
>> - status
>> - createdate
>>
>> Is this some kind of a problem with the WFS driver of OGR or is there
>> something that I'm doing wrong or I have to do and I'm not doing?
>
>Can you show the result of the DescribeFeatureType request, or better just
provide the
>endpoint to the WFS server and the layer used ?

> Even

The WFS server has IP restrictions so even if I provide it, you won't be
able to consume it.

Let me provide the DescribeFeatureType request to you.

<xsd:complexType name="groupsType">
    <xsd:complexContent>
        <xsd:extension base="gml:AbstractFeatureType">
            <xsd:sequence>
                <xsd:element maxOccurs="1" minOccurs="0" name="subgroupno"
nillable="true" type="xsd:string"/>
                <xsd:element maxOccurs="1" minOccurs="0" name="group"
nillable="true" type="xsd:string"/>
                <xsd:element maxOccurs="1" minOccurs="0" name="idno"
nillable="true" type="xsd:long"/>
                <xsd:element maxOccurs="1" minOccurs="0" name="description"
nillable="true" type="xsd:string"/>
                <xsd:element maxOccurs="1" minOccurs="0" name="groundref"
nillable="true" type="xsd:int"/>
                <xsd:element maxOccurs="1" minOccurs="0" name="hoodref"
nillable="true" type="xsd:int"/>
                <xsd:element maxOccurs="1" minOccurs="0" name="surfacearea"
nillable="true" type="xsd:double"/>
                <xsd:element maxOccurs="1" minOccurs="0" name="type"
nillable="true" type="xsd:short"/>
                <xsd:element maxOccurs="1" minOccurs="0" name="status"
nillable="true" type="xsd:short"/>
                <xsd:element maxOccurs="1" minOccurs="0" name="geom"
nillable="true" type="gml:GeometryPropertyType"/>
                <xsd:element maxOccurs="1" minOccurs="0" name="createdate"
nillable="true" type="xsd:dateTime"/>
                <xsd:element maxOccurs="1" minOccurs="0"
name="netsurfacearea" nillable="true" type="xsd:double"/>
                <xsd:element maxOccurs="1" minOccurs="0" name="typeid"
nillable="true" type="xsd:long"/>
                <xsd:element maxOccurs="1" minOccurs="0"
name="supergroupstatus" nillable="true" type="xsd:short"/>
                <xsd:element maxOccurs="1" minOccurs="0"
name="parentstatus" nillable="true" type="xsd:short"/>
            </xsd:sequence>
        </xsd:extension>
    </xsd:complexContent>
</xsd:complexType>
<xsd:element name="groups" substitutionGroup="gml:_Feature"
type="groupsType"/>

Thank you for your response.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170126/76c1b3a2/attachment-0001.html>

From gregory.bataille at gmail.com  Thu Jan 26 01:03:56 2017
From: gregory.bataille at gmail.com (=?UTF-8?Q?Gr=C3=A9gory_Bataille?=)
Date: Thu, 26 Jan 2017 10:03:56 +0100
Subject: [gdal-dev] [gdal2tiles.py] Crash if the asked tile level is from
	too high
Message-ID: <CACVcCzrGN9iRr85DVbX_55YksKzKPDHpmvn427i3aNsT3Jz1cw@mail.gmail.com>

Hey all,

So if you try to launch gdal2tiles.py with an asked tile level that is from
very high, so that the output should be a single tile where not a single
pixel value of the original raster is displayed, gdal2tiles.py simply
crashes (stack trace) when trying to write nothing in the output file

What would you prefer as the "fixed" behaviour?
- some message is displayed on the stderr and then the script exits with a
non-zero exit code
- we generate a single empty (transparent tile) and complete successfully?


To reproduce, you can do this on trunk (with z = 10 or smaller)

> python gdal/swig/python/scripts/gdal2tiles.py
> autotest/pyscripts/data/test_bounds_close_to_tile_bounds_x.vrt
> /tmp/out_small -z 10 -v


(note that starting at a lower level and generating higher level tiles by
downsampling works and generates 1 empty tile --> maybe we should do the
same

> python gdal/swig/python/scripts/gdal2tiles.py
> autotest/pyscripts/data/test_bounds_close_to_tile_bounds_x.vrt
> /tmp/out_small -z 10 -v

)

---
Gregory Bataille
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170126/cc3e7073/attachment.html>

From even.rouault at spatialys.com  Thu Jan 26 01:37:31 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 26 Jan 2017 10:37:31 +0100
Subject: [gdal-dev] even.rouault@spatialys.com
In-Reply-To: <CALdTBvLwd0SGv6tsTOmdBjVbH6iDOxqE4Bb+XgG2h5LnM8v05A@mail.gmail.com>
References: <CALdTBvLwd0SGv6tsTOmdBjVbH6iDOxqE4Bb+XgG2h5LnM8v05A@mail.gmail.com>
Message-ID: <2127841.u4bKL4WHmv@even-i700>

On jeudi 26 janvier 2017 09:08:01 CET Kemal Ardıl Gülez wrote:
> >> Hello all,
> >> 
> >> I'm trying to read a WFS source. The GetFeature request to the WFS source
> >> returns rows in the form of:
> >> 
> >> <gml:featureMember>
> >> 
> >>     <groups fid="group.44107041">
> >>     
> >>         <subgroupno>120</subgroupno>
> >>         <group>288</group>
> >>         <idno>40402578</idno>
> >>         <description>Descripton</description>
> >>         <groundref>56945117</groundref>
> >>         <hoodref>158699</hoodref>
> >>         <surfacearea>804.67</surfacearea>
> >>         <type>2</type>
> >>         <status>2</status>
> >>         <geom>
> >>         
> >>             <gml:MultiPolygon srsName="
> >> 
> >> http://www.opengis.net/gml/srs/epsg.xml#4326">
> >> 
> >>                 <gml:polygonMember>
> >>                 
> >>                     <gml:Polygon>
> >>                     
> >>                         <gml:outerBoundaryIs>
> >>                         
> >>                             <gml:LinearRing>
> >>                             
> >>                                 <gml:coordinates decimal="." cs="," ts="
> >> 
> >> ">67.58201,80.5654
> >> 
> >>                                     67.58207,80.5652 67.58187,80.5653
> >>                                     67.58159,80.5654 67.58118,80.5654
> >>                                     67.58118,80.5655 67.58137,80.5655
> >>                                     67.58143,80.5655 67.58159,80.5654
> >>                                     67.58201,80.5654
> >>                                 
> >>                                 </gml:coordinates>
> >>                             
> >>                             </gml:LinearRing>
> >>                         
> >>                         </gml:outerBoundaryIs>
> >>                     
> >>                     </gml:Polygon>
> >>                 
> >>                 </gml:polygonMember>
> >>             
> >>             </gml:MultiPolygon>
> >>         
> >>         </geom>
> >>         <createdate>2012-04-08T07:13:10</createdate>
> >>         <netsurfacearea>804.440800604637</netsurfacearea>
> >>         <typeid>2000000000001</typeid>
> >>         <supergroupstatus>2</supergroupstatus>
> >>         <parentstatus>3</parentstatus>
> >>     
> >>     </groups>
> >> 
> >> </gml:featureMember>
> >> 
> >> But when I retrieve it with ogrinfo or ogr-fdw (which also uses OGR for
> >> reading and parsing any ogr data source) for postgres, the only fields
> 
> that
> 
> >> I can get are:
> >> 
> >> - fid
> >> - geom
> >> - status
> >> - createdate
> >> 
> >> Is this some kind of a problem with the WFS driver of OGR or is there
> >> something that I'm doing wrong or I have to do and I'm not doing?
> >
> >Can you show the result of the DescribeFeatureType request, or better just
> 
> provide the
> 
> >endpoint to the WFS server and the layer used ?
> >
> > Even
> 
> The WFS server has IP restrictions so even if I provide it, you won't be
> able to consume it.
> 
> Let me provide the DescribeFeatureType request to you.
> 
> <xsd:complexType name="groupsType">
>     <xsd:complexContent>
>         <xsd:extension base="gml:AbstractFeatureType">
>             <xsd:sequence>
>                 <xsd:element maxOccurs="1" minOccurs="0" name="subgroupno"
> nillable="true" type="xsd:string"/>
>                 <xsd:element maxOccurs="1" minOccurs="0" name="group"
> nillable="true" type="xsd:string"/>
>                 <xsd:element maxOccurs="1" minOccurs="0" name="idno"
> nillable="true" type="xsd:long"/>
>                 <xsd:element maxOccurs="1" minOccurs="0" name="description"
> nillable="true" type="xsd:string"/>
>                 <xsd:element maxOccurs="1" minOccurs="0" name="groundref"
> nillable="true" type="xsd:int"/>
>                 <xsd:element maxOccurs="1" minOccurs="0" name="hoodref"
> nillable="true" type="xsd:int"/>
>                 <xsd:element maxOccurs="1" minOccurs="0" name="surfacearea"
> nillable="true" type="xsd:double"/>
>                 <xsd:element maxOccurs="1" minOccurs="0" name="type"
> nillable="true" type="xsd:short"/>
>                 <xsd:element maxOccurs="1" minOccurs="0" name="status"
> nillable="true" type="xsd:short"/>
>                 <xsd:element maxOccurs="1" minOccurs="0" name="geom"
> nillable="true" type="gml:GeometryPropertyType"/>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170126/0f4cd540/attachment-0001.html>

From a.neumann at carto.net  Thu Jan 26 02:13:38 2017
From: a.neumann at carto.net (Neumann, Andreas)
Date: Thu, 26 Jan 2017 11:13:38 +0100
Subject: [gdal-dev] Remove projection information from GeoTiff
Message-ID: <f1f1d4dfb4ab109c25ffc23fe1f8a07a@carto.net>

Hi, 

Is there a way to remove the projection information from a GeoTiff file
without having to copy the whole file with gdal_translate and use the
BASELINE Profile that doesn't write GeoTIFF header? 

Something along the lines of the gdal_edit -unsetgt option, e.g. an
-unsetprj option? 

Thanks for any ideas, 

Andreas 

  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170126/2f72bcf1/attachment.html>

From even.rouault at spatialys.com  Thu Jan 26 02:21:31 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 26 Jan 2017 11:21:31 +0100
Subject: [gdal-dev] Remove projection information from GeoTiff
In-Reply-To: <f1f1d4dfb4ab109c25ffc23fe1f8a07a@carto.net>
References: <f1f1d4dfb4ab109c25ffc23fe1f8a07a@carto.net>
Message-ID: <2688895.vuRPzGLtC2@even-i700>

On jeudi 26 janvier 2017 11:13:38 CET Neumann, Andreas wrote:
> Hi,
> 
> Is there a way to remove the projection information from a GeoTiff file
> without having to copy the whole file with gdal_translate and use the
> BASELINE Profile that doesn't write GeoTIFF header?
> 
> Something along the lines of the gdal_edit -unsetgt option, e.g. an
> -unsetprj option?

Andreas,

Actually you can use -a_srs "" or -a_srs None. I've just extended the doc of the -a_srs option to 
mention that.

Note: as most edit in place operations on TIFF, the previous coordinate system erased that 
way will remain in a ghost state inside the TIFF file. You can see it with an hexadecimal editor.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170126/e0f51f8e/attachment.html>

From even.rouault at spatialys.com  Thu Jan 26 03:24:49 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 26 Jan 2017 12:24:49 +0100
Subject: [gdal-dev] Call for discussion on RFC 67 : Null values in OGR
In-Reply-To: <5018934e-c131-5939-68cf-9412a46760c7@gmail.com>
References: <5072295.SuT4PmY2Is@even-i700>
 <5018934e-c131-5939-68cf-9412a46760c7@gmail.com>
Message-ID: <2077394.RyVEFU8VSZ@even-i700>

Ari,

> In the RFC you write that for JSON OGR currently returns unset fields
> when a field does not exist and when it is null. However, in a simple
> test I wrote this JSON
> 
> { "type": "FeatureCollection", "features": [ { "foo" : "bar" }, { "foo"
> 
> : null }, { } ] }

The above is valid JSON but invalid GeoJSON. There's some logic to deal with attributes that 
wouldn't be properly declared as GeoJSON properties, but it takes a different code path and 
is less advanced regarding null detection.

If I fix it with :

{ "type": "FeatureCollection", "features": [
{ "type": "Feature", "properties" : { "foo" : "bar" } },
{ "type": "Feature", "properties" : { "foo" : null } },
{ "type": "Feature", "properties" : {  } } ] }

I get the current expected behaviour :

$ ogrinfo test.json -al
INFO: Open of `test.json'
      using driver `GeoJSON' successful.

Layer name: test
Geometry: Unknown (any)
Feature Count: 3
Layer SRS WKT:
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563,
            AUTHORITY["EPSG","7030"]],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0,
        AUTHORITY["EPSG","8901"]],
    UNIT["degree",0.0174532925199433,
        AUTHORITY["EPSG","9122"]],
    AUTHORITY["EPSG","4326"]]
foo: String (0.0)
OGRFeature(test):0
  foo (String) = bar

OGRFeature(test):1
  foo (String) = (null)

OGRFeature(test):2
  foo (String) = (null)


The case of the ogrinfo output is interesting. Currently we report unset as (null). I guess that 
with RFC 67 we should rather report

OGRFeature(test):0
  foo (String) = bar

OGRFeature(test):1
  foo (String) = (null)

OGRFeature(test):2


That is not report the foo field in the last field. Or report foo (String ) = (unset) ?


> For PostgreSQL tables NULL is mapped to unset.
> 
> It would be logical if null field would map to null in JSON and NULL in
> SQL 

That's my plan.

> but maybe that's not possible in a backwards compatible way.

Yes, there will be some backward compatibility as raised in the RFC. Basically to get the 
current behaviour when reading a OGR datasource you will need to test both for unset and 
null.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170126/5e6d68a7/attachment.html>

From even.rouault at spatialys.com  Thu Jan 26 03:26:21 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 26 Jan 2017 12:26:21 +0100
Subject: [gdal-dev] Call for discussion on RFC 67 : Null values in OGR
In-Reply-To: <239522B5-51F2-48B8-9C09-5609F46FA042@linz.govt.nz>
References: <5072295.SuT4PmY2Is@even-i700>
 <239522B5-51F2-48B8-9C09-5609F46FA042@linz.govt.nz>
Message-ID: <4072443.zMBX0PsCmZ@even-i700>

On jeudi 26 janvier 2017 09:11:18 CET Jeremy Palmer wrote:
> Hi Even,
> 
> Change is most welcomed, especially for WFS/GML.
> 
> Would there also be changes required to the CSV driver given the new
> EMPTY_STRING_AS_NULL GDAL 2.1 open option?

Good point. Yes in that case, this should be mapped to NULL and no longer as 
unset.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170126/568e9758/attachment-0001.html>

From even.rouault at spatialys.com  Thu Jan 26 06:05:55 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 26 Jan 2017 15:05:55 +0100
Subject: [gdal-dev] [gdal2tiles.py] Crash if the asked tile level is
	from too high
In-Reply-To: <CACVcCzrGN9iRr85DVbX_55YksKzKPDHpmvn427i3aNsT3Jz1cw@mail.gmail.com>
References: <CACVcCzrGN9iRr85DVbX_55YksKzKPDHpmvn427i3aNsT3Jz1cw@mail.gmail.com>
Message-ID: <2177646.PQ8eEer374@even-i700>

On jeudi 26 janvier 2017 10:03:56 CET Grégory Bataille wrote:
> Hey all,
> 
> So if you try to launch gdal2tiles.py with an asked tile level that is from
> very high, so that the output should be a single tile where not a single
> pixel value of the original raster is displayed, gdal2tiles.py simply
> crashes (stack trace) when trying to write nothing in the output file

Python crash, right, not core crash, right ?

Here's what I get:

"""
('\tReadRaster Extent: ', (0, 0, 504, 454), (228, 24, 0, 0))
ERROR 5: Illegal values for buffer size
ERROR 5: Illegal values for buffer size
Traceback (most recent call last):
  File "gdal/swig/python/scripts/gdal2tiles.py", line 2452, in <module>
    main()
  File "gdal/swig/python/scripts/gdal2tiles.py", line 2449, in main
    gdal2tiles.process()
  File "gdal/swig/python/scripts/gdal2tiles.py", line 484, in process
    self.generate_base_tiles()
  File "gdal/swig/python/scripts/gdal2tiles.py", line 1318, in generate_base_tiles
    dsquery.WriteRaster(wx, wy, wxsize, wysize, data, 
band_list=list(range(1,self.dataBandsCount+1)))
  File "/home/even/gdal/trunk/gdal/swig/python/build/lib.linux-x86_64-2.7/osgeo/gdal.py", 
line 2038, in WriteRaster
    buf_pixel_space, buf_line_space, buf_band_space )
TypeError: not a string
"""


> 
> What would you prefer as the "fixed" behaviour?
> - some message is displayed on the stderr and then the script exits with a
> non-zero exit code
> - we generate a single empty (transparent tile) and complete successfully?

Empty tile would seem to be appropriate. Perhaps we could also emit a warning (in non quiet 
mode) indicating that this zoom level and downwards are empty ?

> 
> 
> To reproduce, you can do this on trunk (with z = 10 or smaller)
> 
> > python gdal/swig/python/scripts/gdal2tiles.py
> > autotest/pyscripts/data/test_bounds_close_to_tile_bounds_x.vrt
> > /tmp/out_small -z 10 -v
> 
> (note that starting at a lower level and generating higher level tiles by
> downsampling works and generates 1 empty tile --> maybe we should do the
> same

didn't you mean "starting at a higher level and generating lower level tiles by downsampling" 
instead ?

> 
> > python gdal/swig/python/scripts/gdal2tiles.py
> > autotest/pyscripts/data/test_bounds_close_to_tile_bounds_x.vrt
> > /tmp/out_small -z 10 -v

--> this is the same command as above.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170126/a0b5d76b/attachment.html>

From piero.campa at gmail.com  Thu Jan 26 07:29:14 2017
From: piero.campa at gmail.com (Piero Campalani)
Date: Thu, 26 Jan 2017 16:29:14 +0100
Subject: [gdal-dev] gdalwarp for affine transformation?
In-Reply-To: <3985260.YXQ156Eu6X@even-i700>
References: <CAG4NReL6auA6Q3FYVwAJWV9qibhpKRFzx_9t4mS+u_yZsD72DA@mail.gmail.com>
 <1479287346667-5295980.post@n6.nabble.com> <3985260.YXQ156Eu6X@even-i700>
Message-ID: <CAMp9JaP=uF_NeRAjHfuwdntNVtgHEyhYLnREQoyWg5R2AoqbGw@mail.gmail.com>

​Hi there,
just coming back to confirm that the method is successful.

As described in GDAL API tutorial [1], the GeoTransform matrix elements put
X/Y offsets first in the correspondent raws (quite unusual for my own
experience), so by setting the geo-transform matrix as M_g = [ OffX ScaleX
ShearX OffY ShearY ScaleY ] you can get your correct gdalwarped output.

Note that -- having at hand an affine transformation based on geo-units to
apply to an image, I had to *pre-concatenate* it to the pixel-2-world
transform (that is in the GeoTransform node) to make the math work.

Thanks for helping me out !
-Piero

 [1] http://www.gdal.org/gdal_tutorial.html​

On 16 November 2016 at 11:05, Even Rouault <even.rouault at spatialys.com>
wrote:

> 1) # Create a black image of the right size and SRS
> gdal_translate random.tif temp.vrt -of VRT -outsize ... -a_srs ... -scale
> 0 1 0 0
> 2) Edit the <GeoTransform> node in my.vrt
> 3) gdal_translate my.vrt out.tif
> 4) gdalwarp src.tif out.tif
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170126/09a5b843/attachment.html>

From stoffels at f2e.de  Thu Jan 26 07:28:27 2017
From: stoffels at f2e.de (Nicole Stoffels)
Date: Thu, 26 Jan 2017 16:28:27 +0100
Subject: [gdal-dev] gdalwarp - dataset shifted several metres compared to
	arcgis
Message-ID: <4ebfaf3c-336b-3949-0c5d-8b478b911d1f@f2e.de>

Hi,

I am trying to reproject the CORINE 2012 dataset from LAEA (EPSG:3035) 
to UTM 32 (EPSG:32632). I use the following command:

$ gdalwarp -overwrite -s_srs EPSG:3035 -t_srs EPSG:32632 -tr 100 100 
-tap -dstnodata '-9999' g100_clc12_V18_5.tif corine2012_utm32n_test.tif

In the past years my colleague used ArcGIS for this operation, but since 
we switched to Linux, I have to find a new solution. When I load the new 
dataset generated with gdalwarp to QGIS and compare it with the old 2006 
version built in ArcGIS, I have an offset of approximately 15m south and 
3m east for the single raster squares.

Now I am not sure if I simply forgot an important flag in my 
gdalwarp-command or if the problem simply lies within ArcGIS (my 
colleague used the standard options that were proposed).

Thank you for any ideas,

Nicole

From t.sawka at visimind.pl  Thu Jan 26 07:41:20 2017
From: t.sawka at visimind.pl (Tomasz Sawka)
Date: Thu, 26 Jan 2017 16:41:20 +0100
Subject: [gdal-dev] Windows line endings
Message-ID: <CABUxgwiwS7JfNbONCXG0UTQCLjazVUjxQcxSLRbULtPcgmutWg@mail.gmail.com>

Hello
Is there an option in GDAL to set line endings for text files like ESRI hdr
or GeoTiff ftw files?
We are working on Windows and some software we use expects CRLF and gets
confused when only LF is used. I was looking in global options but could
not find suitable switch. I create files using gdalwarp from  C++ API. Any
tips appreciated.

Best Regards
Tomasz Sawka
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170126/a81d5153/attachment-0001.html>

From even.rouault at spatialys.com  Thu Jan 26 07:45:30 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 26 Jan 2017 16:45:30 +0100
Subject: [gdal-dev] Windows line endings
In-Reply-To: <CABUxgwiwS7JfNbONCXG0UTQCLjazVUjxQcxSLRbULtPcgmutWg@mail.gmail.com>
References: <CABUxgwiwS7JfNbONCXG0UTQCLjazVUjxQcxSLRbULtPcgmutWg@mail.gmail.com>
Message-ID: <2887132.nqUE0PUDNt@even-i700>

On jeudi 26 janvier 2017 16:41:20 CET Tomasz Sawka wrote:
> Hello
> Is there an option in GDAL to set line endings for text files like ESRI hdr
> or GeoTiff ftw files?

Not for those cases.

On the OGR side, this can be available in some drivers, but I'm not aware of much 
configuration currently available on the GDAL side.

> We are working on Windows and some software we use expects CRLF and gets
> confused when only LF is used. I was looking in global options but could
> not find suitable switch. 

There is none indeed.

> I create files using gdalwarp from  C++ API. Any
> tips appreciated.
> 
> Best Regards
> Tomasz Sawka


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170126/7ca17c1c/attachment.html>

From howard at hobu.co  Thu Jan 26 10:24:46 2017
From: howard at hobu.co (Howard Butler)
Date: Thu, 26 Jan 2017 12:24:46 -0600
Subject: [gdal-dev] Motion: Promote 2.1.3RC1 for release
In-Reply-To: <161189d2-0f6c-615f-b4d4-178801624fed@mapgears.com>
References: <2037474.ZOKkCMKVsx@even-i700>
 <161189d2-0f6c-615f-b4d4-178801624fed@mapgears.com>
Message-ID: <B6C2A1F3-D926-474E-9C64-CFD314A40201@hobu.co>


> On Jan 25, 2017, at 3:28 PM, Daniel Morissette <dmorissette at mapgears.com> wrote:
> 
> On 2017-01-25 3:27 AM, Even Rouault wrote:
>> 
>> Motion: GDAL/OGR 2.1.3RC1 is promoted to be the official 2.1.3 final
>> release.
>> 
>> 
> 
> +1
> 

+1

Howard


From cwaigl at alaska.edu  Thu Jan 26 18:04:01 2017
From: cwaigl at alaska.edu (Chris Waigl)
Date: Thu, 26 Jan 2017 17:04:01 -0900
Subject: [gdal-dev] gdalwarp - dataset shifted several metres compared
	to arcgis
In-Reply-To: <4ebfaf3c-336b-3949-0c5d-8b478b911d1f@f2e.de>
References: <4ebfaf3c-336b-3949-0c5d-8b478b911d1f@f2e.de>
Message-ID: <6D9F24F5-F722-4A95-A649-6B82D92EEE6F@alaska.edu>

Hi Nicole,

I have not worked with this dataset or with these exact projections and can only speculate, but since no one takes a stab at it…

Have you tried experimenting with leaving out the -tr and/or -tap parameters? 
My first thought was that it might be a problem with source or target datum, but that seems not so likely. Still, also EPSG:32232, which uses WGS 72. If you have rally old data it might be that.

In any event, I’d advise inspecting the output of gdalinfo for both your target and your 2006 version. 

Chris

-- 
Christine (Chris) Waigl - cwaigl at alaska.edu -  +1-907-474-5483 - Skype: cwaigl_work
Geophysical Institute, UAF, 903 Koyukuk Drive, Fairbanks, AK 99775-7320, USA







> On Jan 26, 2017, at 6:28 AM, Nicole Stoffels <stoffels at f2e.de> wrote:
> 
> Hi,
> 
> I am trying to reproject the CORINE 2012 dataset from LAEA (EPSG:3035) to UTM 32 (EPSG:32632). I use the following command:
> 
> $ gdalwarp -overwrite -s_srs EPSG:3035 -t_srs EPSG:32632 -tr 100 100 -tap -dstnodata '-9999' g100_clc12_V18_5.tif corine2012_utm32n_test.tif
> 
> In the past years my colleague used ArcGIS for this operation, but since we switched to Linux, I have to find a new solution. When I load the new dataset generated with gdalwarp to QGIS and compare it with the old 2006 version built in ArcGIS, I have an offset of approximately 15m south and 3m east for the single raster squares.
> 
> Now I am not sure if I simply forgot an important flag in my gdalwarp-command or if the problem simply lies within ArcGIS (my colleague used the standard options that were proposed).
> 
> Thank you for any ideas,
> 
> Nicole
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170126/7988cfbf/attachment.html>

From traviskirstine at gmail.com  Thu Jan 26 19:44:13 2017
From: traviskirstine at gmail.com (Travis Kirstine)
Date: Thu, 26 Jan 2017 22:44:13 -0500
Subject: [gdal-dev] gdalwarp - dataset shifted several metres compared
	to arcgis
In-Reply-To: <6D9F24F5-F722-4A95-A649-6B82D92EEE6F@alaska.edu>
References: <4ebfaf3c-336b-3949-0c5d-8b478b911d1f@f2e.de>
 <6D9F24F5-F722-4A95-A649-6B82D92EEE6F@alaska.edu>
Message-ID: <CALtm4h2KQMf8jEaJ+MVaNVb5pUghQArf94ts2TPAyVN18fjQVg@mail.gmail.com>

Try including the --debug flag when running the warp, I believe it will
provide details on how the transformation was performed as well

On 26 January 2017 at 21:04, Chris Waigl <cwaigl at alaska.edu> wrote:

> Hi Nicole,
>
> I have not worked with this dataset or with these exact projections and
> can only speculate, but since no one takes a stab at it…
>
>
>    - Have you tried experimenting with leaving out the -tr and/or -tap
>    parameters?
>    - My first thought was that it might be a problem with source or
>    target datum, but that seems not so likely. Still, also EPSG:32232, which
>    uses WGS 72. If you have rally old data it might be that.
>
>
> In any event, I’d advise inspecting the output of gdalinfo for both your
> target and your 2006 version.
>
> Chris
>
> --
> Christine (Chris) Waigl - cwaigl at alaska.edu -  +1-907-474-5483
> <(907)%20474-5483> - Skype: cwaigl_work
> Geophysical Institute, UAF, 903 Koyukuk Drive, Fairbanks, AK 99775-7320,
> USA
>
>
>
>
>
>
>
> On Jan 26, 2017, at 6:28 AM, Nicole Stoffels <stoffels at f2e.de> wrote:
>
> Hi,
>
> I am trying to reproject the CORINE 2012 dataset from LAEA (EPSG:3035) to
> UTM 32 (EPSG:32632). I use the following command:
>
> $ gdalwarp -overwrite -s_srs EPSG:3035 -t_srs EPSG:32632 -tr 100 100 -tap
> -dstnodata '-9999' g100_clc12_V18_5.tif corine2012_utm32n_test.tif
>
> In the past years my colleague used ArcGIS for this operation, but since
> we switched to Linux, I have to find a new solution. When I load the new
> dataset generated with gdalwarp to QGIS and compare it with the old 2006
> version built in ArcGIS, I have an offset of approximately 15m south and 3m
> east for the single raster squares.
>
> Now I am not sure if I simply forgot an important flag in my
> gdalwarp-command or if the problem simply lies within ArcGIS (my colleague
> used the standard options that were proposed).
>
> Thank you for any ideas,
>
> Nicole
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170126/dbe42618/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Fri Jan 27 00:59:30 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Fri, 27 Jan 2017 01:59:30 -0700 (MST)
Subject: [gdal-dev] gdalwarp - dataset shifted several metres compared
 to arcgis
In-Reply-To: <4ebfaf3c-336b-3949-0c5d-8b478b911d1f@f2e.de>
References: <4ebfaf3c-336b-3949-0c5d-8b478b911d1f@f2e.de>
Message-ID: <1485507570353-5305044.post@n6.nabble.com>

Nicole Stoffels wrote
> Hi,
> 
> I am trying to reproject the CORINE 2012 dataset from LAEA (EPSG:3035) 
> to UTM 32 (EPSG:32632). I use the following command:
> 
> $ gdalwarp -overwrite -s_srs EPSG:3035 -t_srs EPSG:32632 -tr 100 100 
> -tap -dstnodata '-9999' g100_clc12_V18_5.tif corine2012_utm32n_test.tif
> 
> In the past years my colleague used ArcGIS for this operation, but since 
> we switched to Linux, I have to find a new solution. When I load the new 
> dataset generated with gdalwarp to QGIS and compare it with the old 2006 
> version built in ArcGIS, I have an offset of approximately 15m south and 
> 3m east for the single raster squares.
> 
> Now I am not sure if I simply forgot an important flag in my 
> gdalwarp-command or if the problem simply lies within ArcGIS (my 
> colleague used the standard options that were proposed).
> 
> Thank you for any ideas,

Shift is small, 15 and 3 meters, compared to the pixel size, 100 m. Anyway,
the reason for the difference is probably in where ArcGIS and GDAL decides
to place the origin when they warp the extents of the image. Target aligned
pixels can for sure shift the origin because that's why the option exists.
ArcGIS and GDAL may still compute the origin into slightly different places
if they do not use exactly same code for warping.

I would have a try by defining the output extents exactly with -te. But
first I would re-think if sub-pixel shifts are meaningful at all.

-Jukka Rahkonen-



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-gdalwarp-dataset-shifted-several-metres-compared-to-arcgis-tp5304949p5305044.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From Ahmed.Tolba at schiebel.net  Fri Jan 27 02:20:36 2017
From: Ahmed.Tolba at schiebel.net (Ahmed Tolba)
Date: Fri, 27 Jan 2017 10:20:36 +0000
Subject: [gdal-dev] WFS-T using OGR
Message-ID: <c75f5580b60247f6b204c44b650b9dbc@SRV046.seg.local>

I followed the example here. http://www.gdal.org/ogr_apitut.html

How would I set a transaction through a webserver. 

The tutorial only shows how to do it on disk. 

Is it possible to write a transaction WFS-T using a server call ? 


m_wfs_t = OGRSFDriverRegistrar::Open("http://192.168.139.128/cgi-bin/tinyows.exe?SERVICE=WFS&VERSION=1.0.0",true); 
        OGRFeature *poFeature;         
        poFeature = OGRFeature::CreateFeature( poLayer->GetLayerDefn() ); 
        poFeature->SetField( "Name", "poiAhmed" ); 
        OGRPoint pt;         
        pt.setX( 120 );         
        pt.setY( 240 );         
        poFeature->SetGeometry( &pt );         
        if( poLayer->CreateFeature( poFeature ) != OGRERR_NONE ) 
        {             
                printf( "Failed to create feature in shapefile.\n" ); 
                exit( 1 );         
        }         

From even.rouault at spatialys.com  Fri Jan 27 02:46:15 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 27 Jan 2017 11:46:15 +0100
Subject: [gdal-dev] gdalwarp - dataset shifted several metres compared
	to arcgis
In-Reply-To: <1485507570353-5305044.post@n6.nabble.com>
References: <4ebfaf3c-336b-3949-0c5d-8b478b911d1f@f2e.de>
 <1485507570353-5305044.post@n6.nabble.com>
Message-ID: <6785940.c6kRuT5V6u@even-i700>

On vendredi 27 janvier 2017 01:59:30 CET jratike80 wrote:
> Nicole Stoffels wrote
> 
> > Hi,
> > 
> > I am trying to reproject the CORINE 2012 dataset from LAEA (EPSG:3035)
> > to UTM 32 (EPSG:32632). I use the following command:
> > 
> > $ gdalwarp -overwrite -s_srs EPSG:3035 -t_srs EPSG:32632 -tr 100 100
> > -tap -dstnodata '-9999' g100_clc12_V18_5.tif corine2012_utm32n_test.tif
> > 
> > In the past years my colleague used ArcGIS for this operation, but since
> > we switched to Linux, I have to find a new solution. When I load the new
> > dataset generated with gdalwarp to QGIS and compare it with the old 2006
> > version built in ArcGIS, I have an offset of approximately 15m south and
> > 3m east for the single raster squares.
> > 
> > Now I am not sure if I simply forgot an important flag in my
> > gdalwarp-command or if the problem simply lies within ArcGIS (my
> > colleague used the standard options that were proposed).
> > 
> > Thank you for any ideas,
> 
> Shift is small, 15 and 3 meters, compared to the pixel size, 100 m. Anyway,
> the reason for the difference is probably in where ArcGIS and GDAL decides
> to place the origin when they warp the extents of the image. Target aligned
> pixels can for sure shift the origin because that's why the option exists.
> ArcGIS and GDAL may still compute the origin into slightly different places
> if they do not use exactly same code for warping.
> 
> I would have a try by defining the output extents exactly with -te. But
> first I would re-think if sub-pixel shifts are meaningful at all.
> 

As nearest neighbour is used here (default resampling), it can easily cause sub-pixel shift. 
Using -r bilinear or -r cubic should improve sub-pixel accuracy.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170127/2839b211/attachment-0001.html>

From even.rouault at spatialys.com  Fri Jan 27 02:50:04 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 27 Jan 2017 11:50:04 +0100
Subject: [gdal-dev] WFS-T using OGR
In-Reply-To: <c75f5580b60247f6b204c44b650b9dbc@SRV046.seg.local>
References: <c75f5580b60247f6b204c44b650b9dbc@SRV046.seg.local>
Message-ID: <5346348.SzerkG8gYQ@even-i700>

On vendredi 27 janvier 2017 10:20:36 CET Ahmed Tolba wrote:
> I followed the example here. http://www.gdal.org/ogr_apitut.html
> 
> How would I set a transaction through a webserver. 
> 
> The tutorial only shows how to do it on disk. 
> 
> Is it possible to write a transaction WFS-T using a server call ? 

Yes WFS-T (1.0.0 or 1.1.0 only. code has not yet been upgraded to support WFS-T 2.0.0 as far 
as I remember) is supported in a similar way as editing other datasources.
> 
> 
> m_wfs_t =
> OGRSFDriverRegistrar::Open("http://192.168.139.128/cgi-bin/tinyows.exe?SERV
> ICE=WFS&VERSION=1.0.0",true); 

Prefix the endpoint with WFS:

so

Open("WFS:http://192.168.139.128/cgi-bin/tinyows.exe?SERVICE=WFS&VERSION=1.0.0", 
true)

 OGRFeature *poFeature;
>         poFeature = OGRFeature::CreateFeature( poLayer->GetLayerDefn() ); 
>         poFeature->SetField( "Name", "poiAhmed" ); 
>         OGRPoint pt;         
>         pt.setX( 120 );         
>         pt.setY( 240 );         
>         poFeature->SetGeometry( &pt );         
>         if( poLayer->CreateFeature( poFeature ) != OGRERR_NONE ) 
>         {             
>                 printf( "Failed to create feature in shapefile.\n" ); 
>                 exit( 1 );         
>         }         
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170127/b3fe9a35/attachment.html>

From even.rouault at spatialys.com  Fri Jan 27 02:53:22 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 27 Jan 2017 11:53:22 +0100
Subject: [gdal-dev] Motion: Promote 2.1.3RC1 for release
In-Reply-To: <2037474.ZOKkCMKVsx@even-i700>
References: <2037474.ZOKkCMKVsx@even-i700>
Message-ID: <14425241.uYqqECkVIK@even-i700>

On mercredi 25 janvier 2017 09:27:06 CET Even Rouault wrote:
> Hi,
> 
> Motion: GDAL/OGR 2.1.3RC1 is promoted to be the official 2.1.3 final
> release.
> 
> ---
> 

I declare this motion passed with support from PSC members JukkaR, TamasS, DanielM, 
HowardB and myself, as well as support from community member Jeff McKenna.

I will proceed soon to renaming the files to final and do the announcement.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170127/eda033e1/attachment.html>

From Ahmed.Tolba at schiebel.net  Fri Jan 27 02:59:21 2017
From: Ahmed.Tolba at schiebel.net (Ahmed Tolba)
Date: Fri, 27 Jan 2017 10:59:21 +0000
Subject: [gdal-dev] WFS-T using OGR
References: <c75f5580b60247f6b204c44b650b9dbc@SRV046.seg.local>
 <5346348.SzerkG8gYQ@even-i700> 
Message-ID: <3e7b6b87f0c9411e8e6a98e809b318d6@SRV046.seg.local>

Hi
Thanks for your answer.

I tried to do what you suggested, but I get " Can not insert the feature, because we didn't manage to parse the .XSD schema "

Here is my code:

m_wfs_t = OGRSFDriverRegistrar::Open("WFS:http://192.168.139.128/cgi-bin/tinyows.exe?SERVICE=WFS&VERSION=1.0.0",true);

      OGRLayer *poLayer;
      poLayer = m_wfs_t->GetLayerByName("tows:poi_ais");

      OGRFeature *poFeature;
      poFeature = OGRFeature::CreateFeature( poLayer->GetLayerDefn() );
      poFeature->SetField( "Name", "poiAhmed" );
      poFeature->SetFID(1000);
      poFeature->SetField("speed",10);

      OGRPoint pt;
      pt.setX( 120 );
      pt.setY( 240 );
      poFeature->SetGeometry( &pt );

      if( poLayer->CreateFeature( poFeature ) != OGRERR_NONE )
      {
            std::cout <<"error creating a feature"<<endl;

      }

From: Even Rouault [mailto:even.rouault at spatialys.com]
Sent: Friday, January 27, 2017 11:50 AM
To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Cc: Ahmed Tolba
Subject: Re: [gdal-dev] WFS-T using OGR


On vendredi 27 janvier 2017 10:20:36 CET Ahmed Tolba wrote:

> I followed the example here. http://www.gdal.org/ogr_apitut.html

>

> How would I set a transaction through a webserver.

>

> The tutorial only shows how to do it on disk.

>

> Is it possible to write a transaction WFS-T using a server call ?



Yes WFS-T (1.0.0 or 1.1.0 only. code has not yet been upgraded to support WFS-T 2.0.0 as far as I remember) is supported in a similar way as editing other datasources.

>

>

> m_wfs_t =

> OGRSFDriverRegistrar::Open("http://192.168.139.128/cgi-bin/tinyows.exe?SERV

> ICE=WFS&VERSION=1.0.0",true);



Prefix the endpoint with WFS:



so



Open("WFS:http://192.168.139.128/cgi-bin/tinyows.exe?SERVICE=WFS&VERSION=1.0.0", true)



OGRFeature *poFeature;

> poFeature = OGRFeature::CreateFeature( poLayer->GetLayerDefn() );

> poFeature->SetField( "Name", "poiAhmed" );

> OGRPoint pt;

> pt.setX( 120 );

> pt.setY( 240 );

> poFeature->SetGeometry( &pt );

> if( poLayer->CreateFeature( poFeature ) != OGRERR_NONE )

> {

> printf( "Failed to create feature in shapefile.\n" );

> exit( 1 );

> }

> _______________________________________________

> gdal-dev mailing list

> gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170127/ddbf72dd/attachment-0001.html>

From even.rouault at spatialys.com  Fri Jan 27 03:14:53 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 27 Jan 2017 12:14:53 +0100
Subject: [gdal-dev] GDAL/OGR 2.1.3 is released
Message-ID: <1841281.RIZGQU6W0h@even-i700>

Hi,

On behalf of the GDAL/OGR development team, I am pleased to announce the release of the 
GDAL/OGR 2.1.3 bug fix version.It contains ~46 bug fixes (including an enhancement for the 
support of the Sentinel2 "SafeCompact" L1C format) since 2.1.2.

The sources are available at:

  http://download.osgeo.org/gdal/2.1.3/gdal-2.1.3.tar.xz
  http://download.osgeo.org/gdal/2.1.3/gdal-2.1.3.tar.gz
  http://download.osgeo.org/gdal/2.1.3/gdal213.zip


The GDAL-GRASS plugin has been updated and is available at:
  http://download.osgeo.org/gdal/2.1.3/gdal-grass-2.1.3.tar.gz



-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170127/694eab44/attachment.html>

From even.rouault at spatialys.com  Fri Jan 27 03:21:43 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 27 Jan 2017 12:21:43 +0100
Subject: [gdal-dev] WFS-T using OGR
In-Reply-To: <3e7b6b87f0c9411e8e6a98e809b318d6@SRV046.seg.local>
References: <c75f5580b60247f6b204c44b650b9dbc@SRV046.seg.local>
 <5346348.SzerkG8gYQ@even-i700>
 <3e7b6b87f0c9411e8e6a98e809b318d6@SRV046.seg.local>
Message-ID: <6433577.9LDBNAqD9F@even-i700>

On vendredi 27 janvier 2017 10:59:21 CET Ahmed Tolba wrote:
> Hi
> Thanks for your answer.
> 
> I tried to do what you suggested, but I get " Can not insert the feature,
> because we didn't manage to parse the .XSD schema "

As the message suggests, the OGR WFS client didn't manage to get or correctly parse 
the schema for the layer. This is a bit surprising as TinyOWS should generate simple 
enough schemas for OGR to understand them. Difficult to know what happens 
without being able to reproduce on my side.

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170127/7263657a/attachment.html>

From Ahmed.Tolba at schiebel.net  Fri Jan 27 03:30:21 2017
From: Ahmed.Tolba at schiebel.net (Ahmed Tolba)
Date: Fri, 27 Jan 2017 11:30:21 +0000
Subject: [gdal-dev] WFS-T using OGR
References: <c75f5580b60247f6b204c44b650b9dbc@SRV046.seg.local>
 <5346348.SzerkG8gYQ@even-i700>
 <3e7b6b87f0c9411e8e6a98e809b318d6@SRV046.seg.local>
 <6433577.9LDBNAqD9F@even-i700> 
Message-ID: <1e7e19cc05164f35b49fe7038c0c4c38@SRV046.seg.local>

This is the schema of that layer:
<FeatureType><Name>tows:poi_ais</Name><Title>AIS POI</Title><SRS>EPSG:4326</SRS><LatLongBoundingBox minx="48.019324" miny="11.762924" maxx="48.031035" maxy="11.808243"/></FeatureType><FeatureType>


From: Even Rouault [mailto:even.rouault at spatialys.com]
Sent: Friday, January 27, 2017 12:22 PM
To: Ahmed Tolba
Cc: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] WFS-T using OGR


On vendredi 27 janvier 2017 10:59:21 CET Ahmed Tolba wrote:

> Hi

> Thanks for your answer.

>

> I tried to do what you suggested, but I get " Can not insert the feature,

> because we didn't manage to parse the .XSD schema "



As the message suggests, the OGR WFS client didn't manage to get or correctly parse the schema for the layer. This is a bit surprising as TinyOWS should generate simple enough schemas for OGR to understand them. Difficult to know what happens without being able to reproduce on my side.



Even





--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170127/e04d8fc0/attachment.html>

From Ahmed.Tolba at schiebel.net  Fri Jan 27 03:59:05 2017
From: Ahmed.Tolba at schiebel.net (Ahmed Tolba)
Date: Fri, 27 Jan 2017 11:59:05 +0000
Subject: [gdal-dev] WFS-T using OGR
In-Reply-To: <6433577.9LDBNAqD9F@even-i700>
References: <c75f5580b60247f6b204c44b650b9dbc@SRV046.seg.local>
 <5346348.SzerkG8gYQ@even-i700>
 <3e7b6b87f0c9411e8e6a98e809b318d6@SRV046.seg.local>
 <6433577.9LDBNAqD9F@even-i700>
Message-ID: <6e0fe92ff0374f0f87ac21e506e7876e@SRV046.seg.local>

Here is the schema for insertion, deletion


<wfs:Transaction xmlns:wfs="http://www.opengis.net/wfs" service="WFS" version="1.1.0" xsi:schemaLocation="http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd http://www.tinyows.org/ http://127.0.0.1/cgi-bin/tinyows.exe?service=wfs&amp;request=DescribeFeatureType&amp;version=1.1.0&amp;typename=tows:poi" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <wfs:Insert>
    <tows:poi xmlns:tows="http://www.tinyows.org/">
      <tows:global>XXX</tows:global>
      <tows:mission>XXX</tows:mission>
      <tows:type>XXX</tows:type>
      <tows:name>XXX</tows:name>
      <tows:description>XXX</tows:description>
      <tows:geom>
        <gml:Point xmlns:gml="http://www.opengis.net/gml" srsName="EPSG:4326">
          <gml:pos>LAT LNG</gml:pos>
        </gml:Point>
      </tows:geom>
      <tows:lat>LAT</tows:lat>
      <tows:lon>LNG</tows:lon>
      <tows:alt></tows:alt>
      <tows:times>XXX</tows:times>
      <tows:category>XXX</tows:category>
      <tows:cog>XXX</tows:cog>
      <tows:decoration>XXX</tows:decoration>
      <tows:distance>XXX</tows:distance>
      <tows:eta>XXX</tows:eta>
      <tows:heading>XXX</tows:heading>
      <tows:icon>XXX</tows:icon>
      <tows:mmsi>XXX</tows:mmsi>
      <tows:slength>XXX</tows:slength>
      <tows:swith>XXX</tows:swith>
      <tows:speed>XXX</tows:speed>
      <tows:tcargo>XXX</tows:tcargo>
      <tows:tship>XXX</tows:tship>
    </tows:poi>
  </wfs:Insert>



From: Even Rouault [mailto:even.rouault at spatialys.com]
Sent: Friday, January 27, 2017 12:22 PM
To: Ahmed Tolba
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] WFS-T using OGR


On vendredi 27 janvier 2017 10:59:21 CET Ahmed Tolba wrote:

> Hi

> Thanks for your answer.

>

> I tried to do what you suggested, but I get " Can not insert the feature,

> because we didn't manage to parse the .XSD schema "



As the message suggests, the OGR WFS client didn't manage to get or correctly parse the schema for the layer. This is a bit surprising as TinyOWS should generate simple enough schemas for OGR to understand them. Difficult to know what happens without being able to reproduce on my side.



Even





--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170127/0a37cacb/attachment-0001.html>

From Rainer at krugs.de  Fri Jan 27 05:28:21 2017
From: Rainer at krugs.de (Rainer M Krug)
Date: Fri, 27 Jan 2017 14:28:21 +0100
Subject: [gdal-dev] compile gdal 2.1.3 with HDF5 support on Debian Lennie
Message-ID: <m2wpdgbohs.fsf@krugs.de>

Hi

We am working on a docker image for spatial analysis using R (see
https://github.com/rocker-org/rocker/issues/213 for the discussion) and
I am struggling to get gdal compiled with HDF5 support.

I install the following dependencies:

--8<---------------cut here---------------start------------->8---
apt-get install -y --no-install-recommends \
  libproj-dev \
  libgeos-dev \
  ## hdf4
  libhdf4-alt-dev \
  ## hdf5
  libhdf5-dev \
  libhdf5-serial-dev \
  zlib1g-dev \
  ## sqlite
  libsqlite3-dev \
  ## freexl
  libfreexl.dev \
  ## odbc
  unixodbc-dev \
  ## diverse
  libexpat1-dev \
  libxerces-c-dev \
  libnetcdf-dev \
  libudunits2-dev \
  ## KML 
  libkml-dev 
--8<---------------cut here---------------end--------------->8---

and use the following configure options

--8<---------------cut here---------------start------------->8---
./configure \
    --with-geotiff \
    --with-sqlite3 \
    --with-freexl \
    --with-spatialite \
    --with-geos \
    --with-hdf4 \
    --with-hdf5 \
    --with-libjson-c \
    --with-netcdf \
    --with-odbc \
    --with-curl \
    --without-grass \
    --without-libgrass
--8<---------------cut here---------------end--------------->8---

But I get the following message in the configure output

,----
| checking for H5Fopen in -lhdf5... no
`----

which than results in

,----
| HDF5 support:              no
`----

Any ideas what I am missing?

Thanks,

Rainer

-- 
Rainer M. Krug
email: Rainer<at>krugs<dot>de
PGP: 0x0F52F982

From andrew at aitchison.me.uk  Fri Jan 27 06:26:14 2017
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Fri, 27 Jan 2017 14:26:14 +0000 (GMT)
Subject: [gdal-dev] compile gdal 2.1.3 with HDF5 support on Debian Lennie
In-Reply-To: <m2wpdgbohs.fsf@krugs.de>
References: <m2wpdgbohs.fsf@krugs.de>
Message-ID: <alpine.LRH.2.20.1701271421080.716@warden.aitchison.me.uk>


Rainer,

I'm not very familiar with Debian or apt-get, but does installing libhdf5
perhaps with something like
 	apt-get install -y --no-install-recommends libhdf5
help ?
If so, the "--no-install-recommends" may be making things harder for you.

Alternatively, the problem *might* be that the commented lines (##)
do not end with a backslash (/).

On Fri, 27 Jan 2017, Rainer M Krug wrote:

> Hi
>
> We am working on a docker image for spatial analysis using R (see
> https://github.com/rocker-org/rocker/issues/213 for the discussion) and
> I am struggling to get gdal compiled with HDF5 support.
>
> I install the following dependencies:
>
> --8<---------------cut here---------------start------------->8---
> apt-get install -y --no-install-recommends \
>  libproj-dev \
>  libgeos-dev \
>  ## hdf4
>  libhdf4-alt-dev \
>  ## hdf5
>  libhdf5-dev \
>  libhdf5-serial-dev \
>  zlib1g-dev \
>  ## sqlite
>  libsqlite3-dev \
>  ## freexl
>  libfreexl.dev \
>  ## odbc
>  unixodbc-dev \
>  ## diverse
>  libexpat1-dev \
>  libxerces-c-dev \
>  libnetcdf-dev \
>  libudunits2-dev \
>  ## KML
>  libkml-dev 
> --8<---------------cut here---------------end--------------->8---
>
> and use the following configure options
>
> --8<---------------cut here---------------start------------->8---
> ./configure \
>    --with-geotiff \
>    --with-sqlite3 \
>    --with-freexl \
>    --with-spatialite \
>    --with-geos \
>    --with-hdf4 \
>    --with-hdf5 \
>    --with-libjson-c \
>    --with-netcdf \
>    --with-odbc \
>    --with-curl \
>    --without-grass \
>    --without-libgrass
> --8<---------------cut here---------------end--------------->8---
>
> But I get the following message in the configure output
>
> ,----
> | checking for H5Fopen in -lhdf5... no
> `----
>
> which than results in
>
> ,----
> | HDF5 support:              no
> `----
>
> Any ideas what I am missing?
>
> Thanks,
>
> Rainer
>
> -- 
> Rainer M. Krug
> email: Rainer<at>krugs<dot>de
> PGP: 0x0F52F982
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at spatialys.com  Fri Jan 27 06:31:49 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 27 Jan 2017 15:31:49 +0100
Subject: [gdal-dev] compile gdal 2.1.3 with HDF5 support on Debian Lennie
In-Reply-To: <m2wpdgbohs.fsf@krugs.de>
References: <m2wpdgbohs.fsf@krugs.de>
Message-ID: <4779207.cHx8mCBVL0@even-i700>

On vendredi 27 janvier 2017 14:28:21 CET Rainer M Krug wrote:
> Hi
> 
> We am working on a docker image for spatial analysis using R (see
> https://github.com/rocker-org/rocker/issues/213 for the discussion) and
> I am struggling to get gdal compiled with HDF5 support.
> 
> Any ideas what I am missing?

Rainer,

Try ./configure --with-hdf5=/usr/lib/x86_64-linux-gnu/hdf5/serial

In trunk HDF5 detection has been improved so that plain --with-hdf5 works, but not in 2.1 
branch.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170127/78b8c019/attachment.html>

From Rainer at krugs.de  Fri Jan 27 06:37:58 2017
From: Rainer at krugs.de (Rainer M Krug)
Date: Fri, 27 Jan 2017 15:37:58 +0100
Subject: [gdal-dev] compile gdal 2.1.3 with HDF5 support on Debian Lennie
In-Reply-To: <4779207.cHx8mCBVL0@even-i700> (Even Rouault's message of "Fri,
 27 Jan 2017 15:31:49 +0100")
References: <m2wpdgbohs.fsf@krugs.de> <4779207.cHx8mCBVL0@even-i700>
Message-ID: <m2sho4bmbd.fsf@krugs.de>

Even Rouault <even.rouault at spatialys.com> writes:

> On vendredi 27 janvier 2017 14:28:21 CET Rainer M Krug wrote:
>
>> Hi
>
>> 
>
>> We am working on a docker image for spatial analysis using R (see
>
>> https://github.com/rocker-org/rocker/issues/213 for the discussion) and
>
>> I am struggling to get gdal compiled with HDF5 support.
>
>> 
>
>> Any ideas what I am missing?
>
> Rainer,
>
> Try ./configure --with-hdf5=/usr/lib/x86_64-linux-gnu/hdf5/serial

Perfect - that works. And I could even remove libhdf5-serial-dev and
zlib1g-dev as dependencies.

>
> In trunk HDF5 detection has been improved so that plain --with-hdf5 works, but not in 2.1 branch.

OK. Thanks a lot,

Rainer

>
> Even

-- 
Rainer M. Krug
email: Rainer<at>krugs<dot>de
PGP: 0x0F52F982
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 454 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170127/e1ba36d4/attachment.sig>

From Rainer at krugs.de  Fri Jan 27 06:43:11 2017
From: Rainer at krugs.de (Rainer M Krug)
Date: Fri, 27 Jan 2017 15:43:11 +0100
Subject: [gdal-dev] compile gdal 2.1.3 with HDF5 support on Debian Lennie
In-Reply-To: <alpine.LRH.2.20.1701271421080.716@warden.aitchison.me.uk>
 (Andrew C. Aitchison's message of "Fri, 27 Jan 2017 14:26:14 +0000
 (GMT)")
References: <m2wpdgbohs.fsf@krugs.de>
 <alpine.LRH.2.20.1701271421080.716@warden.aitchison.me.uk>
Message-ID: <m2o9ysbm2o.fsf@krugs.de>

Thanks for the answer - but the problem was a short coming in the
detection of the library location as Even pinted out.

Thanks,

Rainer

Andrew C Aitchison <andrew at aitchison.me.uk> writes:

> Rainer,
>
> I'm not very familiar with Debian or apt-get, but does installing libhdf5
> perhaps with something like
> 	apt-get install -y --no-install-recommends libhdf5
> help ?
> If so, the "--no-install-recommends" may be making things harder for you.
>
> Alternatively, the problem *might* be that the commented lines (##)
> do not end with a backslash (/).
>
> On Fri, 27 Jan 2017, Rainer M Krug wrote:
>
>> Hi
>>
>> We am working on a docker image for spatial analysis using R (see
>> https://github.com/rocker-org/rocker/issues/213 for the discussion) and
>> I am struggling to get gdal compiled with HDF5 support.
>>
>> I install the following dependencies:
>>
>> --8<---------------cut here---------------start------------->8---
>> apt-get install -y --no-install-recommends \
>>  libproj-dev \
>>  libgeos-dev \
>>  ## hdf4
>>  libhdf4-alt-dev \
>>  ## hdf5
>>  libhdf5-dev \
>>  libhdf5-serial-dev \
>>  zlib1g-dev \
>>  ## sqlite
>>  libsqlite3-dev \
>>  ## freexl
>>  libfreexl.dev \
>>  ## odbc
>>  unixodbc-dev \
>>  ## diverse
>>  libexpat1-dev \
>>  libxerces-c-dev \
>>  libnetcdf-dev \
>>  libudunits2-dev \
>>  ## KML
>>  libkml-dev --8<---------------cut
>> here---------------end--------------->8---
>>
>> and use the following configure options
>>
>> --8<---------------cut here---------------start------------->8---
>> ./configure \
>>    --with-geotiff \
>>    --with-sqlite3 \
>>    --with-freexl \
>>    --with-spatialite \
>>    --with-geos \
>>    --with-hdf4 \
>>    --with-hdf5 \
>>    --with-libjson-c \
>>    --with-netcdf \
>>    --with-odbc \
>>    --with-curl \
>>    --without-grass \
>>    --without-libgrass
>> --8<---------------cut here---------------end--------------->8---
>>
>> But I get the following message in the configure output
>>
>> ,----
>> | checking for H5Fopen in -lhdf5... no
>> `----
>>
>> which than results in
>>
>> ,----
>> | HDF5 support:              no
>> `----
>>
>> Any ideas what I am missing?
>>
>> Thanks,
>>
>> Rainer
>>
>> -- 
>> Rainer M. Krug
>> email: Rainer<at>krugs<dot>de
>> PGP: 0x0F52F982
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>

-- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation Biology, UCT), Dipl. Phys. (Germany)

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug

PGP: 0x0F52F982
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 454 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170127/0ab05462/attachment.sig>

From sebastic at xs4all.nl  Fri Jan 27 06:43:56 2017
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Fri, 27 Jan 2017 15:43:56 +0100
Subject: [gdal-dev] compile gdal 2.1.3 with HDF5 support on Debian Lennie
In-Reply-To: <m2wpdgbohs.fsf@krugs.de>
References: <m2wpdgbohs.fsf@krugs.de>
Message-ID: <691195c2-0bcb-6f73-7981-43b182ea1001@xs4all.nl>

Please upgrade your system to jessie, Debian lenny is EOL since February
6th 2012. See:

 https://wiki.debian.org/DebianReleases

Kind Regards,

Bas

-- 
 GPG Key ID: 4096R/6750F10AE88D4AF1
Fingerprint: 8182 DE41 7056 408D 6146  50D1 6750 F10A E88D 4AF1

From Rainer at krugs.de  Fri Jan 27 08:29:54 2017
From: Rainer at krugs.de (Rainer M Krug)
Date: Fri, 27 Jan 2017 17:29:54 +0100
Subject: [gdal-dev] compile gdal 2.1.3 with HDF5 support on Debian Lennie
In-Reply-To: <691195c2-0bcb-6f73-7981-43b182ea1001@xs4all.nl> (Sebastiaan
 Couwenberg's message of "Fri, 27 Jan 2017 15:43:56 +0100")
References: <m2wpdgbohs.fsf@krugs.de>
 <691195c2-0bcb-6f73-7981-43b182ea1001@xs4all.nl>
Message-ID: <m2k29gbh4t.fsf@krugs.de>

Sebastiaan Couwenberg <sebastic at xs4all.nl> writes:

> Please upgrade your system to jessie, Debian lenny is EOL since February
> 6th 2012. See:

Sorry - they actually use Jessie - I got confused.

Cheers,

Rainer


>
>  https://wiki.debian.org/DebianReleases
>
> Kind Regards,
>
> Bas

-- 
Rainer M. Krug
email: Rainer<at>krugs<dot>de
PGP: 0x0F52F982
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 454 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170127/94f41fe5/attachment-0001.sig>

From lists at mcbsystems.us  Fri Jan 27 10:15:59 2017
From: lists at mcbsystems.us (mccorb)
Date: Fri, 27 Jan 2017 11:15:59 -0700 (MST)
Subject: [gdal-dev] java Dataset.GetRasterBand(i).ComputeRasterMinMax not
 working for float data
Message-ID: <1485540959288-5305118.post@n6.nabble.com>

I have a geotiff image with float data (GDT_Float32).  When I read a tile I
have to case the nodata value to float to make it compare otherwise it
doesn't...here is a reduced snippet of my code

Double[] d = new Double[1];
rb.GetNoDataValue(d);
double noDataVal = d[0];
...
if(rasterBandDataType == gdalconstConstants.GDT_Float32)
{
    float[] array = new float[(rect.height * rect.width)];
    int retVal = rb.ReadRaster(rect.x, rect.y, rect.width, rect.height,
rasterBandDataType, array);
   * float noDataValCast = (float) noDataVal;*
    for(int i = 0; i < array.length; i++)
    {
        if(noDataValCast == buff[i])
            array[i] = Double.NaN;
        else
            array[i] = (scale * buff[i]) + offset;
    }
}

If I don't cast the noDataVal to a float then the value in the returned
array doesn't equal the noData value 
returned from the raster band. 

It seems as though the ComputeRasterMinMax call has the same issue as I was
having before I did the casting. I definitely want to use this method it
because it is much faster than pulling the tiles and processing them myself.

I can provide the geotiff file. It is ~100m and wouldn't upload






--
View this message in context: http://osgeo-org.1560.x6.nabble.com/java-Dataset-GetRasterBand-i-ComputeRasterMinMax-not-working-for-float-data-tp5305118.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Fri Jan 27 10:37:44 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 27 Jan 2017 19:37:44 +0100
Subject: [gdal-dev] java Dataset.GetRasterBand(i).ComputeRasterMinMax
	not working for float data
In-Reply-To: <1485540959288-5305118.post@n6.nabble.com>
References: <1485540959288-5305118.post@n6.nabble.com>
Message-ID: <1954684.KdWBln9h6S@even-i700>

On vendredi 27 janvier 2017 11:15:59 CET mccorb wrote:
> I have a geotiff image with float data (GDT_Float32).  When I read a tile I
> have to case the nodata value to float to make it compare otherwise it
> doesn't...here is a reduced snippet of my code
> 
> Double[] d = new Double[1];
> rb.GetNoDataValue(d);
> double noDataVal = d[0];
> ...
> if(rasterBandDataType == gdalconstConstants.GDT_Float32)
> {
>     float[] array = new float[(rect.height * rect.width)];
>     int retVal = rb.ReadRaster(rect.x, rect.y, rect.width, rect.height,
> rasterBandDataType, array);
>    * float noDataValCast = (float) noDataVal;*
>     for(int i = 0; i < array.length; i++)
>     {
>         if(noDataValCast == buff[i])
>             array[i] = Double.NaN;
>         else
>             array[i] = (scale * buff[i]) + offset;
>     }
> }
> 
> If I don't cast the noDataVal to a float then the value in the returned
> array doesn't equal the noData value
> returned from the raster band.
> 
> It seems as though the ComputeRasterMinMax call has the same issue as I was
> having before I did the casting. I definitely want to use this method it
> because it is much faster than pulling the tiles and processing them myself.

All of that is more or less expected given that GetNoDataValue() and 
ComputeRasterMinMax() return double values. So if you compare to float directly, the float 
get promoted to double (and the double isn't strictly equal to the initial pixel value), and 
tiny precision issues appear. Downcasting to float as you did is the way to go.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170127/680e2d72/attachment.html>

From lists at mcbsystems.us  Fri Jan 27 11:25:43 2017
From: lists at mcbsystems.us (mccorb)
Date: Fri, 27 Jan 2017 12:25:43 -0700 (MST)
Subject: [gdal-dev] java Dataset.GetRasterBand(i).ComputeRasterMinMax
 not working for float data
In-Reply-To: <1954684.KdWBln9h6S@even-i700>
References: <1485540959288-5305118.post@n6.nabble.com>
 <1954684.KdWBln9h6S@even-i700>
Message-ID: <CAD0yCM31MK8nVj+jH60cEMj1ie+QG4tJGr9J3xyG0AVvJXzxHw@mail.gmail.com>

Even,

I agree but the call to  ComputeRasterMinMax() contains nodata values for
the min. It doesn't do the downcast correctly.

thanks,

On Fri, Jan 27, 2017 at 12:38 PM, Even Rouault-2 [via OSGeo.org] <
ml-node+s1560n5305119h48 at n6.nabble.com> wrote:

> On vendredi 27 janvier 2017 11:15:59 CET mccorb wrote:
>
> > I have a geotiff image with float data (GDT_Float32). When I read a tile
> I
>
> > have to case the nodata value to float to make it compare otherwise it
>
> > doesn't...here is a reduced snippet of my code
>
> >
>
> > Double[] d = new Double[1];
>
> > rb.GetNoDataValue(d);
>
> > double noDataVal = d[0];
>
> > ...
>
> > if(rasterBandDataType == gdalconstConstants.GDT_Float32)
>
> > {
>
> > float[] array = new float[(rect.height * rect.width)];
>
> > int retVal = rb.ReadRaster(rect.x, rect.y, rect.width, rect.height,
>
> > rasterBandDataType, array);
>
> > * float noDataValCast = (float) noDataVal;*
>
> > for(int i = 0; i < array.length; i++)
>
> > {
>
> > if(noDataValCast == buff[i])
>
> > array[i] = Double.NaN;
>
> > else
>
> > array[i] = (scale * buff[i]) + offset;
>
> > }
>
> > }
>
> >
>
> > If I don't cast the noDataVal to a float then the value in the returned
>
> > array doesn't equal the noData value
>
> > returned from the raster band.
>
> >
>
> > It seems as though the ComputeRasterMinMax call has the same issue as I
> was
>
> > having before I did the casting. I definitely want to use this method it
>
> > because it is much faster than pulling the tiles and processing them
> myself.
>
>
>
> All of that is more or less expected given that GetNoDataValue() and
> ComputeRasterMinMax() return double values. So if you compare to float
> directly, the float get promoted to double (and the double isn't strictly
> equal to the initial pixel value), and tiny precision issues appear.
> Downcasting to float as you did is the way to go.
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
> _______________________________________________
> gdal-dev mailing list
> [hidden email] <http:///user/SendEmail.jtp?type=node&node=5305119&i=0>
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> ------------------------------
> If you reply to this email, your message will be added to the discussion
> below:
> http://osgeo-org.1560.x6.nabble.com/java-Dataset-GetRasterBand-i-
> ComputeRasterMinMax-not-working-for-float-data-tp5305118p5305119.html
> To unsubscribe from java Dataset.GetRasterBand(i).ComputeRasterMinMax not
> working for float data, click here
> <http://osgeo-org.1560.x6.nabble.com/template/NamlServlet.jtp?macro=unsubscribe_by_code&node=5305118&code=bGlzdHNAbWNic3lzdGVtcy51c3w1MzA1MTE4fDE0Nzc3NDEwNzU=>
> .
> NAML
> <http://osgeo-org.1560.x6.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&id=instant_html%21nabble%3Aemail.naml&base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.NodeNamespace&breadcrumbs=notify_subscribers%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml>
>




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/java-Dataset-GetRasterBand-i-ComputeRasterMinMax-not-working-for-float-data-tp5305118p5305127.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170127/0d9e4589/attachment.html>

From even.rouault at spatialys.com  Fri Jan 27 11:33:10 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 27 Jan 2017 20:33:10 +0100
Subject: [gdal-dev] java Dataset.GetRasterBand(i).ComputeRasterMinMax
	not working for float data
In-Reply-To: <CAD0yCM31MK8nVj+jH60cEMj1ie+QG4tJGr9J3xyG0AVvJXzxHw@mail.gmail.com>
References: <1485540959288-5305118.post@n6.nabble.com>
 <1954684.KdWBln9h6S@even-i700>
 <CAD0yCM31MK8nVj+jH60cEMj1ie+QG4tJGr9J3xyG0AVvJXzxHw@mail.gmail.com>
Message-ID: <2007376.AGSTx8gmeL@even-i700>

On vendredi 27 janvier 2017 12:25:43 CET mccorb wrote:
> Even,
> 
> I agree but the call to  ComputeRasterMinMax() contains nodata values for
> the min. It doesn't do the downcast correctly.

What does gdalinfo -mm report ?

> 
> thanks,
> 
> On Fri, Jan 27, 2017 at 12:38 PM, Even Rouault-2 [via OSGeo.org] <
> 
> ml-node+s1560n5305119h48 at n6.nabble.com> wrote:
> > On vendredi 27 janvier 2017 11:15:59 CET mccorb wrote:
> > > I have a geotiff image with float data (GDT_Float32). When I read a tile
> > 
> > I
> > 
> > > have to case the nodata value to float to make it compare otherwise it
> > > 
> > > doesn't...here is a reduced snippet of my code
> > > 
> > > 
> > > 
> > > Double[] d = new Double[1];
> > > 
> > > rb.GetNoDataValue(d);
> > > 
> > > double noDataVal = d[0];
> > > 
> > > ...
> > > 
> > > if(rasterBandDataType == gdalconstConstants.GDT_Float32)
> > > 
> > > {
> > > 
> > > float[] array = new float[(rect.height * rect.width)];
> > > 
> > > int retVal = rb.ReadRaster(rect.x, rect.y, rect.width, rect.height,
> > > 
> > > rasterBandDataType, array);
> > > 
> > > * float noDataValCast = (float) noDataVal;*
> > > 
> > > for(int i = 0; i < array.length; i++)
> > > 
> > > {
> > > 
> > > if(noDataValCast == buff[i])
> > > 
> > > array[i] = Double.NaN;
> > > 
> > > else
> > > 
> > > array[i] = (scale * buff[i]) + offset;
> > > 
> > > }
> > > 
> > > }
> > > 
> > > 
> > > 
> > > If I don't cast the noDataVal to a float then the value in the returned
> > > 
> > > array doesn't equal the noData value
> > > 
> > > returned from the raster band.
> > > 
> > > 
> > > 
> > > It seems as though the ComputeRasterMinMax call has the same issue as I
> > 
> > was
> > 
> > > having before I did the casting. I definitely want to use this method it
> > > 
> > > because it is much faster than pulling the tiles and processing them
> > 
> > myself.
> > 
> > 
> > 
> > All of that is more or less expected given that GetNoDataValue() and
> > ComputeRasterMinMax() return double values. So if you compare to float
> > directly, the float get promoted to double (and the double isn't strictly
> > equal to the initial pixel value), and tiny precision issues appear.
> > Downcasting to float as you did is the way to go.
> > 
> > 
> > 
> > Even
> > 
> > 
> > 
> > --
> > 
> > Spatialys - Geospatial professional services
> > 
> > http://www.spatialys.com
> > 
> > _______________________________________________
> > gdal-dev mailing list
> > [hidden email] <http:///user/SendEmail.jtp?type=node&node=5305119&i=0>
> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
> > 
> > ------------------------------
> > If you reply to this email, your message will be added to the discussion
> > below:
> > http://osgeo-org.1560.x6.nabble.com/java-Dataset-GetRasterBand-i-> > ComputeRasterMinMax-not-working-for-float-data-tp5305118p5305119.html
> > To unsubscribe from java Dataset.GetRasterBand(i).ComputeRasterMinMax not
> > working for float data, click here
> > <http://osgeo-org.1560.x6.nabble.com/template/NamlServlet.jtp?macro=unsubs
> > 
cribe_by_code&node=5305118&code=bGlzdHNAbWNic3lzdGVtcy51c3w1MzA1MTE4fDE0Nz
> > c3NDEwNzU=> .
> > NAML
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170127/d9ccf200/attachment-0001.html>

From lists at mcbsystems.us  Fri Jan 27 11:43:11 2017
From: lists at mcbsystems.us (mccorb)
Date: Fri, 27 Jan 2017 12:43:11 -0700 (MST)
Subject: [gdal-dev] java Dataset.GetRasterBand(i).ComputeRasterMinMax
 not working for float data
In-Reply-To: <2007376.AGSTx8gmeL@even-i700>
References: <1485540959288-5305118.post@n6.nabble.com>
 <1954684.KdWBln9h6S@even-i700>
 <CAD0yCM31MK8nVj+jH60cEMj1ie+QG4tJGr9J3xyG0AVvJXzxHw@mail.gmail.com>
 <2007376.AGSTx8gmeL@even-i700>
Message-ID: <CAD0yCM0gCej728jbRBf_FPDc2Mem5JnGTzbUnBCWiaFij-GnAQ@mail.gmail.com>

Driver: GTiff/GeoTIFF
Files: elevation.tif
Size is 7195, 5531
Coordinate System is:
PROJCS["NAD_1983_UTM_Zone_17N",
    GEOGCS["NAD83",
        DATUM["North_American_Datum_1983",
            SPHEROID["GRS 1980",6378137,298.2572221010002,
                AUTHORITY["EPSG","7019"]],
            AUTHORITY["EPSG","6269"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4269"]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",-81],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AUTHORITY["EPSG","26917"]]
Origin = (543011.291966574150000,4153822.939761789500000)
Pixel Size = (28.143460884725201,-28.143460884725226)
Metadata:
  AREA_OR_POINT=Area
  DataType=Generic
Image Structure Metadata:
  COMPRESSION=LZW
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (  543011.292, 4153822.940) ( 80d30'47.51"W, 37d31'49.36"N)
Lower Left  (  543011.292, 3998161.458) ( 80d31'19.22"W, 36d 7'37.88"N)
Upper Right (  745503.493, 4153822.940) ( 78d13'22.19"W, 37d29'55.39"N)
Lower Right (  745503.493, 3998161.458) ( 78d16'22.86"W, 36d 5'49.55"N)
Center      (  644257.392, 4075992.199) ( 79d22'57.31"W, 36d49' 7.69"N)
Band 1 Block=128x128 Type=Float32, ColorInterp=Gray
    Computed Min/Max=-340282306073709650000000000000000000000.000,2282.341
  NoData Value=-3.4028229999999999e+038



On Fri, Jan 27, 2017 at 1:34 PM, Even Rouault-2 [via OSGeo.org] <
ml-node+s1560n5305129h58 at n6.nabble.com> wrote:

> On vendredi 27 janvier 2017 12:25:43 CET mccorb wrote:
>
> > Even,
>
> >
>
> > I agree but the call to ComputeRasterMinMax() contains nodata values for
>
> > the min. It doesn't do the downcast correctly.
>
>
>
> What does gdalinfo -mm report ?
>
>
>
> >
>
> > thanks,
>
> >
>
> > On Fri, Jan 27, 2017 at 12:38 PM, Even Rouault-2 [via OSGeo.org] <
>
> >
>
> > [hidden email] <http:///user/SendEmail.jtp?type=node&node=5305129&i=0>>
> wrote:
>
> > > On vendredi 27 janvier 2017 11:15:59 CET mccorb wrote:
>
> > > > I have a geotiff image with float data (GDT_Float32). When I read a
> tile
>
> > >
>
> > > I
>
> > >
>
> > > > have to case the nodata value to float to make it compare otherwise
> it
>
> > > >
>
> > > > doesn't...here is a reduced snippet of my code
>
> > > >
>
> > > >
>
> > > >
>
> > > > Double[] d = new Double[1];
>
> > > >
>
> > > > rb.GetNoDataValue(d);
>
> > > >
>
> > > > double noDataVal = d[0];
>
> > > >
>
> > > > ...
>
> > > >
>
> > > > if(rasterBandDataType == gdalconstConstants.GDT_Float32)
>
> > > >
>
> > > > {
>
> > > >
>
> > > > float[] array = new float[(rect.height * rect.width)];
>
> > > >
>
> > > > int retVal = rb.ReadRaster(rect.x, rect.y, rect.width, rect.height,
>
> > > >
>
> > > > rasterBandDataType, array);
>
> > > >
>
> > > > * float noDataValCast = (float) noDataVal;*
>
> > > >
>
> > > > for(int i = 0; i < array.length; i++)
>
> > > >
>
> > > > {
>
> > > >
>
> > > > if(noDataValCast == buff[i])
>
> > > >
>
> > > > array[i] = Double.NaN;
>
> > > >
>
> > > > else
>
> > > >
>
> > > > array[i] = (scale * buff[i]) + offset;
>
> > > >
>
> > > > }
>
> > > >
>
> > > > }
>
> > > >
>
> > > >
>
> > > >
>
> > > > If I don't cast the noDataVal to a float then the value in the
> returned
>
> > > >
>
> > > > array doesn't equal the noData value
>
> > > >
>
> > > > returned from the raster band.
>
> > > >
>
> > > >
>
> > > >
>
> > > > It seems as though the ComputeRasterMinMax call has the same issue
> as I
>
> > >
>
> > > was
>
> > >
>
> > > > having before I did the casting. I definitely want to use this
> method it
>
> > > >
>
> > > > because it is much faster than pulling the tiles and processing them
>
> > >
>
> > > myself.
>
> > >
>
> > >
>
> > >
>
> > > All of that is more or less expected given that GetNoDataValue() and
>
> > > ComputeRasterMinMax() return double values. So if you compare to float
>
> > > directly, the float get promoted to double (and the double isn't
> strictly
>
> > > equal to the initial pixel value), and tiny precision issues appear.
>
> > > Downcasting to float as you did is the way to go.
>
> > >
>
> > >
>
> > >
>
> > > Even
>
> > >
>
> > >
>
> > >
>
> > > --
>
> > >
>
> > > Spatialys - Geospatial professional services
>
> > >
>
> > > http://www.spatialys.com
>
> > >
>
> > > _______________________________________________
>
> > > gdal-dev mailing list
>
> > > [hidden email] <http:///user/SendEmail.jtp?type=node&node=5305119&i=0>
>
> > > https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> > >
>
> > > ------------------------------
>
> > > If you reply to this email, your message will be added to the
> discussion
>
> > > below:
>
> > > http://osgeo-org.1560.x6.nabble.com/java-Dataset-GetRasterBand-i-
>
> > > ComputeRasterMinMax-not-working-for-float-data-tp5305118p5305119.html
>
> > > To unsubscribe from java Dataset.GetRasterBand(i).ComputeRasterMinMax
> not
>
> > > working for float data, click here
>
> > > <http://osgeo-org.1560.x6.nabble.com/template/
> NamlServlet.jtp?macro=unsubs
>
> > > cribe_by_code&node=5305118&code=bGlzdHNAbWNic3lzdGVtcy51c3w1Mz
> A1MTE4fDE0Nz
>
> > > c3NDEwNzU=> .
>
> > > NAML
>
> > > <http://osgeo-org.1560.x6.nabble.com/template/
> NamlServlet.jtp?macro=macro_
>
> > > viewer&id=instant_html%21nabble%3Aemail.naml&base=
> nabble.naml.namespaces.B
>
> > > asicNamespace-nabble.view.web.template.NabbleNamespace-
> nabble.view.web.tem
>
> > > plate.NodeNamespace&breadcrumbs=notify_subscribers%21nabble%3Aemail.
> naml-i
>
> > > nstant_emails%21nabble%3Aemail.naml-send_instant_
> email%21nabble%3Aemail.na
>
> > > ml>
>
> > --
>
> > View this message in context:
>
> > http://osgeo-org.1560.x6.nabble.com/java-Dataset-
> GetRasterBand-i-ComputeRas
>
> > terMinMax-not-working-for-float-data-tp5305118p5305127.html Sent from
> the
>
> > GDAL - Dev mailing list archive at Nabble.com.
>
>
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
> _______________________________________________
> gdal-dev mailing list
> [hidden email] <http:///user/SendEmail.jtp?type=node&node=5305129&i=1>
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> ------------------------------
> If you reply to this email, your message will be added to the discussion
> below:
> http://osgeo-org.1560.x6.nabble.com/java-Dataset-GetRasterBand-i-
> ComputeRasterMinMax-not-working-for-float-data-tp5305118p5305129.html
> To unsubscribe from java Dataset.GetRasterBand(i).ComputeRasterMinMax not
> working for float data, click here
> <http://osgeo-org.1560.x6.nabble.com/template/NamlServlet.jtp?macro=unsubscribe_by_code&node=5305118&code=bGlzdHNAbWNic3lzdGVtcy51c3w1MzA1MTE4fDE0Nzc3NDEwNzU=>
> .
> NAML
> <http://osgeo-org.1560.x6.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&id=instant_html%21nabble%3Aemail.naml&base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.NodeNamespace&breadcrumbs=notify_subscribers%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml>
>




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/java-Dataset-GetRasterBand-i-ComputeRasterMinMax-not-working-for-float-data-tp5305118p5305130.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170127/cef4c65f/attachment-0001.html>

From lists at mcbsystems.us  Fri Jan 27 11:54:38 2017
From: lists at mcbsystems.us (mccorb)
Date: Fri, 27 Jan 2017 12:54:38 -0700 (MST)
Subject: [gdal-dev] java Dataset.GetRasterBand(i).ComputeRasterMinMax
 not working for float data
In-Reply-To: <2007376.AGSTx8gmeL@even-i700>
References: <1485540959288-5305118.post@n6.nabble.com>
 <1954684.KdWBln9h6S@even-i700>
 <CAD0yCM31MK8nVj+jH60cEMj1ie+QG4tJGr9J3xyG0AVvJXzxHw@mail.gmail.com>
 <2007376.AGSTx8gmeL@even-i700>
Message-ID: <CAD0yCM1heBGai8nKQ6YVS-Cno1OeFK8agBexTS85pxUtBaBLDw@mail.gmail.com>

If you like I can upload the file and send you a google drive link if you
give me the email you want to receive it from.

Thanks,

On Fri, Jan 27, 2017 at 1:34 PM, Even Rouault-2 [via OSGeo.org] <
ml-node+s1560n5305129h58 at n6.nabble.com> wrote:

> On vendredi 27 janvier 2017 12:25:43 CET mccorb wrote:
>
> > Even,
>
> >
>
> > I agree but the call to ComputeRasterMinMax() contains nodata values for
>
> > the min. It doesn't do the downcast correctly.
>
>
>
> What does gdalinfo -mm report ?
>
>
>
> >
>
> > thanks,
>
> >
>
> > On Fri, Jan 27, 2017 at 12:38 PM, Even Rouault-2 [via OSGeo.org] <
>
> >
>
> > [hidden email] <http:///user/SendEmail.jtp?type=node&node=5305129&i=0>>
> wrote:
>
> > > On vendredi 27 janvier 2017 11:15:59 CET mccorb wrote:
>
> > > > I have a geotiff image with float data (GDT_Float32). When I read a
> tile
>
> > >
>
> > > I
>
> > >
>
> > > > have to case the nodata value to float to make it compare otherwise
> it
>
> > > >
>
> > > > doesn't...here is a reduced snippet of my code
>
> > > >
>
> > > >
>
> > > >
>
> > > > Double[] d = new Double[1];
>
> > > >
>
> > > > rb.GetNoDataValue(d);
>
> > > >
>
> > > > double noDataVal = d[0];
>
> > > >
>
> > > > ...
>
> > > >
>
> > > > if(rasterBandDataType == gdalconstConstants.GDT_Float32)
>
> > > >
>
> > > > {
>
> > > >
>
> > > > float[] array = new float[(rect.height * rect.width)];
>
> > > >
>
> > > > int retVal = rb.ReadRaster(rect.x, rect.y, rect.width, rect.height,
>
> > > >
>
> > > > rasterBandDataType, array);
>
> > > >
>
> > > > * float noDataValCast = (float) noDataVal;*
>
> > > >
>
> > > > for(int i = 0; i < array.length; i++)
>
> > > >
>
> > > > {
>
> > > >
>
> > > > if(noDataValCast == buff[i])
>
> > > >
>
> > > > array[i] = Double.NaN;
>
> > > >
>
> > > > else
>
> > > >
>
> > > > array[i] = (scale * buff[i]) + offset;
>
> > > >
>
> > > > }
>
> > > >
>
> > > > }
>
> > > >
>
> > > >
>
> > > >
>
> > > > If I don't cast the noDataVal to a float then the value in the
> returned
>
> > > >
>
> > > > array doesn't equal the noData value
>
> > > >
>
> > > > returned from the raster band.
>
> > > >
>
> > > >
>
> > > >
>
> > > > It seems as though the ComputeRasterMinMax call has the same issue
> as I
>
> > >
>
> > > was
>
> > >
>
> > > > having before I did the casting. I definitely want to use this
> method it
>
> > > >
>
> > > > because it is much faster than pulling the tiles and processing them
>
> > >
>
> > > myself.
>
> > >
>
> > >
>
> > >
>
> > > All of that is more or less expected given that GetNoDataValue() and
>
> > > ComputeRasterMinMax() return double values. So if you compare to float
>
> > > directly, the float get promoted to double (and the double isn't
> strictly
>
> > > equal to the initial pixel value), and tiny precision issues appear.
>
> > > Downcasting to float as you did is the way to go.
>
> > >
>
> > >
>
> > >
>
> > > Even
>
> > >
>
> > >
>
> > >
>
> > > --
>
> > >
>
> > > Spatialys - Geospatial professional services
>
> > >
>
> > > http://www.spatialys.com
>
> > >
>
> > > _______________________________________________
>
> > > gdal-dev mailing list
>
> > > [hidden email] <http:///user/SendEmail.jtp?type=node&node=5305119&i=0>
>
> > > https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> > >
>
> > > ------------------------------
>
> > > If you reply to this email, your message will be added to the
> discussion
>
> > > below:
>
> > > http://osgeo-org.1560.x6.nabble.com/java-Dataset-GetRasterBand-i-
>
> > > ComputeRasterMinMax-not-working-for-float-data-tp5305118p5305119.html
>
> > > To unsubscribe from java Dataset.GetRasterBand(i).ComputeRasterMinMax
> not
>
> > > working for float data, click here
>
> > > <http://osgeo-org.1560.x6.nabble.com/template/
> NamlServlet.jtp?macro=unsubs
>
> > > cribe_by_code&node=5305118&code=bGlzdHNAbWNic3lzdGVtcy51c3w1Mz
> A1MTE4fDE0Nz
>
> > > c3NDEwNzU=> .
>
> > > NAML
>
> > > <http://osgeo-org.1560.x6.nabble.com/template/
> NamlServlet.jtp?macro=macro_
>
> > > viewer&id=instant_html%21nabble%3Aemail.naml&base=
> nabble.naml.namespaces.B
>
> > > asicNamespace-nabble.view.web.template.NabbleNamespace-
> nabble.view.web.tem
>
> > > plate.NodeNamespace&breadcrumbs=notify_subscribers%21nabble%3Aemail.
> naml-i
>
> > > nstant_emails%21nabble%3Aemail.naml-send_instant_
> email%21nabble%3Aemail.na
>
> > > ml>
>
> > --
>
> > View this message in context:
>
> > http://osgeo-org.1560.x6.nabble.com/java-Dataset-
> GetRasterBand-i-ComputeRas
>
> > terMinMax-not-working-for-float-data-tp5305118p5305127.html Sent from
> the
>
> > GDAL - Dev mailing list archive at Nabble.com.
>
>
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
> _______________________________________________
> gdal-dev mailing list
> [hidden email] <http:///user/SendEmail.jtp?type=node&node=5305129&i=1>
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> ------------------------------
> If you reply to this email, your message will be added to the discussion
> below:
> http://osgeo-org.1560.x6.nabble.com/java-Dataset-GetRasterBand-i-
> ComputeRasterMinMax-not-working-for-float-data-tp5305118p5305129.html
> To unsubscribe from java Dataset.GetRasterBand(i).ComputeRasterMinMax not
> working for float data, click here
> <http://osgeo-org.1560.x6.nabble.com/template/NamlServlet.jtp?macro=unsubscribe_by_code&node=5305118&code=bGlzdHNAbWNic3lzdGVtcy51c3w1MzA1MTE4fDE0Nzc3NDEwNzU=>
> .
> NAML
> <http://osgeo-org.1560.x6.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&id=instant_html%21nabble%3Aemail.naml&base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.NodeNamespace&breadcrumbs=notify_subscribers%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml>
>




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/java-Dataset-GetRasterBand-i-ComputeRasterMinMax-not-working-for-float-data-tp5305118p5305131.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170127/fb50d8cb/attachment.html>

From schwehr at gmail.com  Fri Jan 27 16:26:20 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Fri, 27 Jan 2017 16:26:20 -0800
Subject: [gdal-dev] Motion: Promote 2.1.3RC1 for release
In-Reply-To: <14425241.uYqqECkVIK@even-i700>
References: <2037474.ZOKkCMKVsx@even-i700> <14425241.uYqqECkVIK@even-i700>
Message-ID: <CACmBxyvDcLu4U20cBwqLmMUkxNWsiabAd9ZTLrVf2YKpueqnnw@mail.gmail.com>

And a little after the fact :)  Just checked 2.1.3 into fink on the mac.
Thanks Even!

+1 kurt

On Fri, Jan 27, 2017 at 2:53 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> On mercredi 25 janvier 2017 09:27:06 CET Even Rouault wrote:
>
> > Hi,
>
> >
>
> > Motion: GDAL/OGR 2.1.3RC1 is promoted to be the official 2.1.3 final
>
> > release.
>
> >
>
> > ---
>
> >
>
>
>
> I declare this motion passed with support from PSC members JukkaR, TamasS,
> DanielM, HowardB and myself, as well as support from community member Jeff
> McKenna.
>
>
>
> I will proceed soon to renaming the files to final and do the announcement.
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170127/ce5da72e/attachment.html>

From schwehr at gmail.com  Fri Jan 27 17:26:25 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Fri, 27 Jan 2017 17:26:25 -0800
Subject: [gdal-dev] [gdal2tiles.py] python engineering
In-Reply-To: <CACVcCzrSYvD75ZqPx16k54TOx7Xo5pxELJNgrzG21HKQD9QycQ@mail.gmail.com>
References: <CACVcCzqrHx2DNXUBRxkqP-eoYwJ56QTTSvsFTi6EZcRB_1dRrg@mail.gmail.com>
 <14284918.zGBvLDo3T8@even-i700>
 <CACVcCzq8yrL_NJbAp+wrM4h5+DSAoVQG8Kic2-NA0KRdPowgrQ@mail.gmail.com>
 <CACmBxyveeHng6PWWkb+cevZgwjE-m50B-2EhQTfu03OcyeHAbg@mail.gmail.com>
 <CACVcCzrSYvD75ZqPx16k54TOx7Xo5pxELJNgrzG21HKQD9QycQ@mail.gmail.com>
Message-ID: <CACmBxysTyeBg16gpum2LU05gfFYbH8_5d+LvoH_7rP4CvqVXmA@mail.gmail.com>

I just pushed a copy of all of the python unittest based tests that I have
so far to here:

https://github.com/schwehr/gdal-autotest2/tree/master/python

Be warned that I haven't tested them in this form and that in addition to
needing build infrastructure, I am pretty sure the code can't currently
find the test files.  Also a few of the NITF tests do not work in my custom
environment so there are a few untried test files in nitf_test.py.  And I
haven't tried these with python 3.x.

-kurt

On Wed, Jan 25, 2017 at 10:52 AM, Grégory Bataille <
gregory.bataille at gmail.com> wrote:

> You are completely right. Symbolic link. Don't know what I was thinking
> about at the time!
>
>
> On Wed, 25 Jan 2017 at 19:12, Kurt Schwehr <schwehr at gmail.com> wrote:
>
>> Gregory,
>>
>> Aside: A point of terminology, by hyperlink, I think you mean symbolic
>> link <https://en.wikipedia.org/wiki/Symbolic_link> or hard link.
>>
>> As a point of information, I'm using both python unittest and C++ gunit
>> very effectively for GDAL.  I do use bazel as the build system, but that
>> doesn't really matter.  A very behind copy of what I've done is here:
>>
>> https://github.com/schwehr/gdal-autotest2
>>
>> And, sadly, it looks like I've yet to get any of the python code in
>> there.  I'll try to get at least something in there today.
>>
>> On Wed, Jan 25, 2017 at 3:35 AM, Grégory Bataille <
>> gregory.bataille at gmail.com> wrote:
>>
>> ok, thansk for the pointers on the deployment side. I'll think about it
>>
>>
>> ---
>> Gregory Bataille
>>
>> On Wed, Jan 25, 2017 at 12:19 PM, Even Rouault <
>> even.rouault at spatialys.com> wrote:
>>
>> On mercredi 25 janvier 2017 05:48:00 CET Grégory Bataille wrote:
>>
>> > Hello,
>>
>> >
>>
>> > If I want to really spend some time for this utility, I'd like to do
>> some
>>
>> > clean engineering around it.
>>
>> > What I'd like to do is:
>>
>> >
>>
>> > - split the script into several files (smaller, single purpose, ...)
>>
>> > --> can you confirm that on all target platform, all .py files are
>> deployed
>>
>> > and the /usr/local/bin/gdal2tiles.py is just an hyperlink on the source
>>
>> > file installed somewhere else?
>>
>>
>>
>> This depends pretty much on how GDAL is packaged.
>>
>> On Unix, the default "make install" target will copy any .py file of
>> swig/python/scripts/ to the ${install_prefix}/bin directory. And for
>> example Debian/Ubuntu packaging follows that.
>>
>>
>>
>> On OSGeo4W, they do that similarly and have a .bat that creates a .bat
>> shortcut for each installed .py file
>>
>>
>>
>> > --> do you see any issue with that?
>>
>>
>>
>> Yes, that the sub files would be available as executable scripts, whereas
>> some of them would not be.
>>
>>
>>
>> One could imagine that the code could go to a Python module (gdal_scripts
>> ?), and the top-level gdal2tiles.py could be something like:
>>
>> from osgeo import gdal_scripts
>>
>> gdal_scripts.gdal2tiles(...)
>>
>>
>>
>> I'm not clear what the effort required / benefit would be however.
>>
>>
>>
>> >
>>
>> > - Introduce a standard unittesting platform - pytest + tox I guess - (on
>>
>> > top of the autotest thing, I would not attempt to redo them all) that
>> would
>>
>> > be incorporated in the CI
>>
>>
>>
>> No opinion on that, having not used any of those. One must keep in mind
>> that GDAL is not a pure python project, so not sure how those tools
>> integrate well with the custom approaches we might have.
>>
>>
>>
>> One thing that is missing currently, when comparing to the C++ part, is
>> to get coverage information of the Python code.
>>
>>
>>
>> >
>>
>> > - Clean up the code: follow PEP8 and fix pylint issues. Put PEP8 and
>> pylint
>>
>> > in the CI. Rename the hell out of the variables because I'm banging my
>> head
>>
>> > with rx, ry, lrux and the like :)
>>
>> >
>>
>> > Any comments, warnings, problems you can think of?
>>
>>
>>
>> Clearer variable names are always welcome.
>>
>>
>>
>> Even
>>
>>
>>
>>
>>
>> --
>>
>> Spatialys - Geospatial professional services
>>
>> http://www.spatialys.com
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>
>>
>>
>> --
>> --
>> http://schwehr.org
>>
> --
> Greg
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170127/38f0aed3/attachment-0001.html>

From gregory.bataille at gmail.com  Fri Jan 27 23:11:25 2017
From: gregory.bataille at gmail.com (=?UTF-8?Q?Gr=C3=A9gory_Bataille?=)
Date: Sat, 28 Jan 2017 08:11:25 +0100
Subject: [gdal-dev] [gdal2tiles.py] python engineering
In-Reply-To: <CACmBxysTyeBg16gpum2LU05gfFYbH8_5d+LvoH_7rP4CvqVXmA@mail.gmail.com>
References: <CACVcCzqrHx2DNXUBRxkqP-eoYwJ56QTTSvsFTi6EZcRB_1dRrg@mail.gmail.com>
 <14284918.zGBvLDo3T8@even-i700>
 <CACVcCzq8yrL_NJbAp+wrM4h5+DSAoVQG8Kic2-NA0KRdPowgrQ@mail.gmail.com>
 <CACmBxyveeHng6PWWkb+cevZgwjE-m50B-2EhQTfu03OcyeHAbg@mail.gmail.com>
 <CACVcCzrSYvD75ZqPx16k54TOx7Xo5pxELJNgrzG21HKQD9QycQ@mail.gmail.com>
 <CACmBxysTyeBg16gpum2LU05gfFYbH8_5d+LvoH_7rP4CvqVXmA@mail.gmail.com>
Message-ID: <CACVcCzoSR1101X7JvuJ2d0Phce7Y3Trpzhj5fjJbyo9gyviEMw@mail.gmail.com>

ok, I'll try to get a look


---
Gregory Bataille

On Sat, Jan 28, 2017 at 2:26 AM, Kurt Schwehr <schwehr at gmail.com> wrote:

> I just pushed a copy of all of the python unittest based tests that I have
> so far to here:
>
> https://github.com/schwehr/gdal-autotest2/tree/master/python
>
> Be warned that I haven't tested them in this form and that in addition to
> needing build infrastructure, I am pretty sure the code can't currently
> find the test files.  Also a few of the NITF tests do not work in my custom
> environment so there are a few untried test files in nitf_test.py.  And I
> haven't tried these with python 3.x.
>
> -kurt
>
> On Wed, Jan 25, 2017 at 10:52 AM, Grégory Bataille <
> gregory.bataille at gmail.com> wrote:
>
>> You are completely right. Symbolic link. Don't know what I was thinking
>> about at the time!
>>
>>
>> On Wed, 25 Jan 2017 at 19:12, Kurt Schwehr <schwehr at gmail.com> wrote:
>>
>>> Gregory,
>>>
>>> Aside: A point of terminology, by hyperlink, I think you mean symbolic
>>> link <https://en.wikipedia.org/wiki/Symbolic_link> or hard link.
>>>
>>> As a point of information, I'm using both python unittest and C++ gunit
>>> very effectively for GDAL.  I do use bazel as the build system, but that
>>> doesn't really matter.  A very behind copy of what I've done is here:
>>>
>>> https://github.com/schwehr/gdal-autotest2
>>>
>>> And, sadly, it looks like I've yet to get any of the python code in
>>> there.  I'll try to get at least something in there today.
>>>
>>> On Wed, Jan 25, 2017 at 3:35 AM, Grégory Bataille <
>>> gregory.bataille at gmail.com> wrote:
>>>
>>> ok, thansk for the pointers on the deployment side. I'll think about it
>>>
>>>
>>> ---
>>> Gregory Bataille
>>>
>>> On Wed, Jan 25, 2017 at 12:19 PM, Even Rouault <
>>> even.rouault at spatialys.com> wrote:
>>>
>>> On mercredi 25 janvier 2017 05:48:00 CET Grégory Bataille wrote:
>>>
>>> > Hello,
>>>
>>> >
>>>
>>> > If I want to really spend some time for this utility, I'd like to do
>>> some
>>>
>>> > clean engineering around it.
>>>
>>> > What I'd like to do is:
>>>
>>> >
>>>
>>> > - split the script into several files (smaller, single purpose, ...)
>>>
>>> > --> can you confirm that on all target platform, all .py files are
>>> deployed
>>>
>>> > and the /usr/local/bin/gdal2tiles.py is just an hyperlink on the source
>>>
>>> > file installed somewhere else?
>>>
>>>
>>>
>>> This depends pretty much on how GDAL is packaged.
>>>
>>> On Unix, the default "make install" target will copy any .py file of
>>> swig/python/scripts/ to the ${install_prefix}/bin directory. And for
>>> example Debian/Ubuntu packaging follows that.
>>>
>>>
>>>
>>> On OSGeo4W, they do that similarly and have a .bat that creates a .bat
>>> shortcut for each installed .py file
>>>
>>>
>>>
>>> > --> do you see any issue with that?
>>>
>>>
>>>
>>> Yes, that the sub files would be available as executable scripts,
>>> whereas some of them would not be.
>>>
>>>
>>>
>>> One could imagine that the code could go to a Python module
>>> (gdal_scripts ?), and the top-level gdal2tiles.py could be something like:
>>>
>>> from osgeo import gdal_scripts
>>>
>>> gdal_scripts.gdal2tiles(...)
>>>
>>>
>>>
>>> I'm not clear what the effort required / benefit would be however.
>>>
>>>
>>>
>>> >
>>>
>>> > - Introduce a standard unittesting platform - pytest + tox I guess -
>>> (on
>>>
>>> > top of the autotest thing, I would not attempt to redo them all) that
>>> would
>>>
>>> > be incorporated in the CI
>>>
>>>
>>>
>>> No opinion on that, having not used any of those. One must keep in mind
>>> that GDAL is not a pure python project, so not sure how those tools
>>> integrate well with the custom approaches we might have.
>>>
>>>
>>>
>>> One thing that is missing currently, when comparing to the C++ part, is
>>> to get coverage information of the Python code.
>>>
>>>
>>>
>>> >
>>>
>>> > - Clean up the code: follow PEP8 and fix pylint issues. Put PEP8 and
>>> pylint
>>>
>>> > in the CI. Rename the hell out of the variables because I'm banging my
>>> head
>>>
>>> > with rx, ry, lrux and the like :)
>>>
>>> >
>>>
>>> > Any comments, warnings, problems you can think of?
>>>
>>>
>>>
>>> Clearer variable names are always welcome.
>>>
>>>
>>>
>>> Even
>>>
>>>
>>>
>>>
>>>
>>> --
>>>
>>> Spatialys - Geospatial professional services
>>>
>>> http://www.spatialys.com
>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>>
>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>>
>>>
>>>
>>> --
>>> --
>>> http://schwehr.org
>>>
>> --
>> Greg
>>
>
>
>
> --
> --
> http://schwehr.org
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170128/de43f0ae/attachment.html>

From even.rouault at spatialys.com  Sat Jan 28 03:45:15 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 28 Jan 2017 12:45:15 +0100
Subject: [gdal-dev] java Dataset.GetRasterBand(i).ComputeRasterMinMax
	not working for float data
In-Reply-To: <CAD0yCM0gCej728jbRBf_FPDc2Mem5JnGTzbUnBCWiaFij-GnAQ@mail.gmail.com>
References: <1485540959288-5305118.post@n6.nabble.com>
 <2007376.AGSTx8gmeL@even-i700>
 <CAD0yCM0gCej728jbRBf_FPDc2Mem5JnGTzbUnBCWiaFij-GnAQ@mail.gmail.com>
Message-ID: <2434022.6XNbX4XV8f@even-i700>

On vendredi 27 janvier 2017 12:43:11 CET mccorb wrote:
> Driver: GTiff/GeoTIFF
> Files: elevation.tif
> Size is 7195, 5531
> Coordinate System is:
> PROJCS["NAD_1983_UTM_Zone_17N",
>     GEOGCS["NAD83",
>         DATUM["North_American_Datum_1983",
>             SPHEROID["GRS 1980",6378137,298.2572221010002,
>                 AUTHORITY["EPSG","7019"]],
>             AUTHORITY["EPSG","6269"]],
>         PRIMEM["Greenwich",0],
>         UNIT["degree",0.0174532925199433],
>         AUTHORITY["EPSG","4269"]],
>     PROJECTION["Transverse_Mercator"],
>     PARAMETER["latitude_of_origin",0],
>     PARAMETER["central_meridian",-81],
>     PARAMETER["scale_factor",0.9996],
>     PARAMETER["false_easting",500000],
>     PARAMETER["false_northing",0],
>     UNIT["metre",1,
>         AUTHORITY["EPSG","9001"]],
>     AUTHORITY["EPSG","26917"]]
> Origin = (543011.291966574150000,4153822.939761789500000)
> Pixel Size = (28.143460884725201,-28.143460884725226)
> Metadata:
>   AREA_OR_POINT=Area
>   DataType=Generic
> Image Structure Metadata:
>   COMPRESSION=LZW
>   INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  (  543011.292, 4153822.940) ( 80d30'47.51"W, 37d31'49.36"N)
> Lower Left  (  543011.292, 3998161.458) ( 80d31'19.22"W, 36d 7'37.88"N)
> Upper Right (  745503.493, 4153822.940) ( 78d13'22.19"W, 37d29'55.39"N)
> Lower Right (  745503.493, 3998161.458) ( 78d16'22.86"W, 36d 5'49.55"N)
> Center      (  644257.392, 4075992.199) ( 79d22'57.31"W, 36d49' 7.69"N)
> Band 1 Block=128x128 Type=Float32, ColorInterp=Gray
>     Computed Min/Max=-340282306073709650000000000000000000000.000,2282.341
>   NoData Value=-3.4028229999999999e+038
> 
> 

I've pushed a fix for that in
https://trac.osgeo.org/gdal/changeset/37229

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170128/c529941a/attachment-0001.html>

From ari.jolma at gmail.com  Sat Jan 28 03:59:28 2017
From: ari.jolma at gmail.com (Ari Jolma)
Date: Sat, 28 Jan 2017 13:59:28 +0200
Subject: [gdal-dev] java Dataset.GetRasterBand(i).ComputeRasterMinMax
 not working for float data
In-Reply-To: <2434022.6XNbX4XV8f@even-i700>
References: <1485540959288-5305118.post@n6.nabble.com>
 <2007376.AGSTx8gmeL@even-i700>
 <CAD0yCM0gCej728jbRBf_FPDc2Mem5JnGTzbUnBCWiaFij-GnAQ@mail.gmail.com>
 <2434022.6XNbX4XV8f@even-i700>
Message-ID: <d9c8e801-0fd5-5287-2063-48a52304f916@gmail.com>

28.01.2017, 13:45, Even Rouault kirjoitti:
>
> > Computed Min/Max=-340282306073709650000000000000000000000.000,2282.341
>
> > NoData Value=-3.4028229999999999e+038
>
> >
>
> >
>
> I've pushed a fix for that in
>
> https://trac.osgeo.org/gdal/changeset/37229
>

IMO it is not a good idea to use Inf's or such as no data values since 
comparisons of floating point values are non-reliable. I've hit this in 
the case where I set raster data from GDAL raster to a piddle in PDL 
(comparable to NumPy in Python world) for raster algebra. I didn't find 
a good solution then - I'll need to examine this changeset more and see 
if it provides a good solution to the problem.

Thanks,

Ari

> -- 
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170128/0bc19494/attachment.html>

From mkarabacak at meteksan.com  Mon Jan 30 03:47:59 2017
From: mkarabacak at meteksan.com (Mahir Karabacak)
Date: Mon, 30 Jan 2017 13:47:59 +0200 (EET)
Subject: [gdal-dev] Getting Elevation data from GeoTiff file with JAVA
Message-ID: <609466230.596005.1485776879596.JavaMail.zimbra@meteksan.com>

Hi all,

Hope you have a great day... 

I am very new on GDAL. I need to get elevation (altitude) data of a specified location in GeoTiff file. I will give latitude,longitude and it will return elevation. If anybody can help me about that I will really be thankful. 

Thanks in advance. 
Mahir KARABACAK

From michael.smith.erdc at gmail.com  Mon Jan 30 04:07:38 2017
From: michael.smith.erdc at gmail.com (Michael Smith)
Date: Mon, 30 Jan 2017 07:07:38 -0500
Subject: [gdal-dev] Getting Elevation data from GeoTiff file with JAVA
Message-ID: <D4B4968A.148E2E%michael.smith.erdc@gmail.com>

You can use gdallocationinfo utility to get the cell value (elevation) at
a specified location. See http://www.gdal.org/gdallocationinfo.html

Mike

----
Michael Smith

US Army Corps
Remote Sensing GIS/Center
michael.smith at usace.army.mil




-----Original Message-----
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of Mahir
Karabacak <mkarabacak at meteksan.com>
Date: Monday, January 30, 2017 at 6:47 AM
To: gdal-dev <gdal-dev at lists.osgeo.org>
Subject: [gdal-dev] Getting Elevation data from GeoTiff file with JAVA

>Hi all,
>
>Hope you have a great day...
>
>I am very new on GDAL. I need to get elevation (altitude) data of a
>specified location in GeoTiff file. I will give latitude,longitude and it
>will return elevation. If anybody can help me about that I will really be
>thankful. 
>
>Thanks in advance.
>Mahir KARABACAK
>_______________________________________________
>gdal-dev mailing list
>gdal-dev at lists.osgeo.org
>https://lists.osgeo.org/mailman/listinfo/gdal-dev



From battisti at actgate.com  Mon Jan 30 07:56:29 2017
From: battisti at actgate.com (Andrea Battisti)
Date: Mon, 30 Jan 2017 16:56:29 +0100
Subject: [gdal-dev]  shapefile field indexing on OGR 1.x vs 2.1
Message-ID: <f95648df-f47b-77f9-db0d-75226addb386@actgate.com>

Hi all,

I have a shapefile created by GDAL/OGR 1.7 which is using a .ind/.idm 
attribute index on an integer field.

If I SQL-query that integer field on OGR 2.1 I get the following:
ERROR 7: BuildKey(): 8 bytes integer key length not supported

I think that is because the new GDAL interprets that field as Integer64 
while before it was just Integer (and was working fine).

On the other hand if I delete the old index and recreate it using the 
new GDAL I get:
ERROR 1: Indexing not support for the field type of field myfield.

What is the proper way to use new GDAL on the old shapefile without 
modifying it?
Is there a way to explicitly tell GDAL to use that field as Integer and 
to make the field indexing work?


Thanks in advance!

Andrea Battisti
Software Engineer

From even.rouault at spatialys.com  Mon Jan 30 12:01:22 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 30 Jan 2017 21:01:22 +0100
Subject: [gdal-dev] shapefile field indexing on OGR 1.x vs 2.1
In-Reply-To: <f95648df-f47b-77f9-db0d-75226addb386@actgate.com>
References: <f95648df-f47b-77f9-db0d-75226addb386@actgate.com>
Message-ID: <16886756.tisE06jRtd@even-i700>

On lundi 30 janvier 2017 16:56:29 CET Andrea Battisti wrote:
> Hi all,
> 
> I have a shapefile created by GDAL/OGR 1.7 which is using a .ind/.idm
> attribute index on an integer field.
> 
> If I SQL-query that integer field on OGR 2.1 I get the following:
> ERROR 7: BuildKey(): 8 bytes integer key length not supported
> 
> I think that is because the new GDAL interprets that field as Integer64
> while before it was just Integer (and was working fine).
> 
> On the other hand if I delete the old index and recreate it using the
> new GDAL I get:
> ERROR 1: Indexing not support for the field type of field myfield.
> 
> What is the proper way to use new GDAL on the old shapefile without
> modifying it?
> Is there a way to explicitly tell GDAL to use that field as Integer and
> to make the field indexing work?

I'm not sure if MapInfo indexes support 64 bit integers (probably not), but the code does not 
support them indeed.

You can try to open the shapefile with the ADJUST_TYPE=YES open option so that it can 
check if a potential colum with 64 bit integers really contains 64 bit integers or not. If not, it 
will be downgraded to integer and the attribute index will be available.

Another option would be to resize the column to 8 characters or less if the data fits in it (with 
the RESIZE=YES creation option)

Another option is to not use shapefiles and use more powerful alternatives like GeoPackage 
or Spatialite.

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170130/d62db071/attachment.html>

From benjamin.deschamps at canada.ca  Mon Jan 30 12:00:05 2017
From: benjamin.deschamps at canada.ca (Deschamps, Benjamin (AAFC/AAC))
Date: Mon, 30 Jan 2017 20:00:05 +0000
Subject: [gdal-dev] gdal.Rasterize select output type different than Float64
Message-ID: <mailman.1.1485807026.18830.gdal-dev@lists.osgeo.org>

Is it possible to specify the output type for gdal.Rasterize, similar to gdal.Warp and others? I don't see why the option would be available in the command line utility but not through the binding. It looks to be hardcoded in the source (https://github.com/OSGeo/gdal/blob/ba920209a2443b5a8492a23c16dd67fd53114c66/gdal/apps/gdal_rasterize_lib.cpp#L764).

Is it possible to fix or is there a workaround? For me the result is a much file than required (and associated slower I/O, increased memory usage).

Example usage:

myoptions = gdal.RasterizeOptions(attribute="MYATTRIBUTE")
gdal.Rasterize(dst_path, src_path, options=myoptions)

where the paths are direct file names to a Shapefile and a GeoTiff otput.

Thank you,

Benjamin

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170130/8bd4613a/attachment.html>

From asmitawankhede at gmail.com  Mon Jan 30 14:33:28 2017
From: asmitawankhede at gmail.com (asmita)
Date: Mon, 30 Jan 2017 15:33:28 -0700 (MST)
Subject: [gdal-dev] Change of behavior ?? GDALRasterBand:IReadBlock vs
	RasterIO ?
Message-ID: <1485815608022-5305401.post@n6.nabble.com>

Recently seen that GDALRasterBand read for the Mosaics is affected because
the read always trying to default to IReadBlock and we never implemented
IReadBlock because of less generic type support I guess:

our implementation : 
class XRasterBand : public GDALRasterBand
{
  
 public:
  XRasterBand(GDALDataset          *dataset,
                 int                   gdalBandNum,
                 const xyzSize<uint32> &rastersize,
                 const xyzSize<uint32> &blocksize,
                 GDALDataType          gdalDatatype,
                 GDALColorInterp       colorInterp_,
                 const xyzTransferGuard<GDALColorTable> &ctbl_,
                 bool                  haveNoData_,
                 double                noDataValue_);
  virtual CPLErr IRasterIO( GDALRWFlag eRWFlag,
                            int nXOff, int nYOff, int nXSize, int nYSize,
                            void *pData, int nBufXSize, int nBufYSize,
                            GDALDataType eBufType,
                            int nPixelSpace, int nLineSpace,
                            GDALRasterIOExtraArg* sExtraArg);

  virtual CPLErr IReadBlock(int nXBlockOff, int nYBlockOff, void *pabyData){
   CPLError(CE_Failure, CPLE_AppDefined,
             "Internal Error: doesn't support block reading");
    return CE_Failure;
  }

Since we recently upgraded to GDAL 2.1.2 from GDAL 1.1 all the Raster reads
are defaulting to IReadBlock for warping /mosaics.

I referred to Migration Guide, but it does not mention of such a change(
even the RasterIO RFC is unrelated) - ref
:https://svn.osgeo.org/gdal/branches/2.0/gdal/MIGRATION_GUIDE.TXT

My Question is :
1. has anyone seen this issue ? 
2. what has changed that may not be documented ?
3. is there a need to implement IReadBlock 2.0 onwards ?




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Change-of-behavior-GDALRasterBand-IReadBlock-vs-RasterIO-tp5305401.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Mon Jan 30 23:24:28 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 31 Jan 2017 08:24:28 +0100
Subject: [gdal-dev] Change of behavior ?? GDALRasterBand:IReadBlock vs
	RasterIO ?
In-Reply-To: <1485815608022-5305401.post@n6.nabble.com>
References: <1485815608022-5305401.post@n6.nabble.com>
Message-ID: <13269087.dSrpvMvnSZ@even-i700>

On lundi 30 janvier 2017 15:33:28 CET asmita wrote:
> Recently seen that GDALRasterBand read for the Mosaics is affected because
> the read always trying to default to IReadBlock and we never implemented
> IReadBlock because of less generic type support I guess:
> 

IReadBlock() must definitely be implemented. If you've implemented IRasterIO(), you can 
easily redirect IReadBlock() to IRasterIO(). For example like done in
https://github.com/OSGeo/gdal/blob/trunk/gdal/frmts/ecw/ecwdataset.cpp#L911

> 
> Since we recently upgraded to GDAL 2.1.2 from GDAL 1.1 all the Raster reads
> are defaulting to IReadBlock for warping /mosaics.
> 
> I referred to Migration Guide, but it does not mention of such a change(
> even the RasterIO RFC is unrelated) - ref
> 
> :https://svn.osgeo.org/gdal/branches/2.0/gdal/MIGRATION_GUIDE.TXT

> 2. what has changed that may not be documented ?

Probably something that did band per band access and was modified to do block per block 
access. An implementation detail.

> 3. is there a need to implement IReadBlock 2.0 onwards ?

It has been a requirement since GDAL 1.0. You were just lucky to not have triggered code 
paths that needed it before.

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170131/b5f725e1/attachment-0001.html>

From kassies at gmail.com  Tue Jan 31 03:00:50 2017
From: kassies at gmail.com (Rutger)
Date: Tue, 31 Jan 2017 04:00:50 -0700 (MST)
Subject: [gdal-dev] gdal.Rasterize select output type different than
 Float64
In-Reply-To: <20170130201026.BC41E6138CB1@lists.osgeo.org>
References: <20170130201026.BC41E6138CB1@lists.osgeo.org>
Message-ID: <1485860450738-5305466.post@n6.nabble.com>

Hey Benjamin, 

This is fixed with 2.1.3, see (at the bottom):
https://trac.osgeo.org/gdal/wiki/Release/2.1.3-News

A workaround is shown at:
http://osgeo-org.1560.x6.nabble.com/gdal-RasterizeOptions-output-type-tp5293573p5293575.html


Regards,
Rutger



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-gdal-Rasterize-select-output-type-different-than-Float64-tp5305371p5305466.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From ahmed.tolba at schiebel.net  Tue Jan 31 03:01:28 2017
From: ahmed.tolba at schiebel.net (andreahmed)
Date: Tue, 31 Jan 2017 04:01:28 -0700 (MST)
Subject: [gdal-dev] SQL Expression post error
Message-ID: <1485860488000-5305467.post@n6.nabble.com>

 I get a SQL Expression parsing error 

 OE_DEBUG << LC << "SQL: " << expr << std::endl; 
        _resultSetHandle = OGR_DS_ExecuteSQL( _dsHandle, expr.c_str(),
_spatialFilter, 0L ); 

the expr is expr = "SELECT * FROM tows:poi_ais" 

In the database the table name is poi_ais. The layer is tows. Is that a bug
? 



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/SQL-Expression-post-error-tp5305467.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Tue Jan 31 03:02:34 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 31 Jan 2017 12:02:34 +0100
Subject: [gdal-dev] SQL Expression post error
In-Reply-To: <1485860488000-5305467.post@n6.nabble.com>
References: <1485860488000-5305467.post@n6.nabble.com>
Message-ID: <1660918.HoEeKvbkcd@even-i700>

On mardi 31 janvier 2017 04:01:28 CET andreahmed wrote:
>  I get a SQL Expression parsing error
> 
>  OE_DEBUG << LC << "SQL: " << expr << std::endl;
>         _resultSetHandle = OGR_DS_ExecuteSQL( _dsHandle, expr.c_str(),
> _spatialFilter, 0L );
> 
> the expr is expr = "SELECT * FROM tows:poi_ais"
> 
> In the database the table name is poi_ais. The layer is tows. Is that a bug
> ?

towns:poi_ais needs to be escaped between double quotes

> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/SQL-Expression-post-error-tp5305467.htm
> l Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170131/aa0193e2/attachment.html>

From battisti at actgate.com  Tue Jan 31 03:13:14 2017
From: battisti at actgate.com (Andrea Battisti)
Date: Tue, 31 Jan 2017 12:13:14 +0100
Subject: [gdal-dev] shapefile field indexing on OGR 1.x vs 2.1
In-Reply-To: <16886756.tisE06jRtd@even-i700>
References: <f95648df-f47b-77f9-db0d-75226addb386@actgate.com>
 <16886756.tisE06jRtd@even-i700>
Message-ID: <eb9ab0fc-a7c3-a31f-61fe-63e0b746d66a@actgate.com>



>
>> What is the proper way to use new GDAL on the old shapefile without
>
>> modifying it?
>
>> Is there a way to explicitly tell GDAL to use that field as Integer and
>
>> to make the field indexing work?
>
>
>
> I'm not sure if MapInfo indexes support 64 bit integers (probably not),
> but the code does not support them indeed.
>
>
>
> You can try to open the shapefile with the ADJUST_TYPE=YES open option
> so that it can check if a potential colum with 64 bit integers really
> contains 64 bit integers or not. If not, it will be downgraded to
> integer and the attribute index will be available.
>
>
>
> Another option would be to resize the column to 8 characters or less if
> the data fits in it (with the RESIZE=YES creation option)
>
>
>
> Another option is to not use shapefiles and use more powerful
> alternatives like GeoPackage or Spatialite.
>
>


Even,

I tried ogr2ogr -lco RESIZE=YES and indeed the Integer64 field becomes 
Integer, but that changes the original shapefile, I was hoping to use 
the existing shapefile without touching it.

Related to the attribute index: when using SQL WHERE clauses like
WHERE myfield IN (1, 2, 3) on the integer field, it reports on the last 
one only, like if the query was
WHERE myfield = 3
(while there are rows with myfield = 1 and 2 as well...)

This is happening only if using the mapinfo attribute index on 2.1 (was 
working on 1.x). If I manually remove the index files the query executes 
correctly.

I see from here
http://www.gdal.org/drv_shapefile.html
that the index only accelerates "fieldname = value" queries so maybe the 
WHERE IN () is not accelerated but should still work I guess?

Thanks!
Andrea

From jukka.rahkonen at maanmittauslaitos.fi  Tue Jan 31 03:32:18 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Tue, 31 Jan 2017 04:32:18 -0700 (MST)
Subject: [gdal-dev] shapefile field indexing on OGR 1.x vs 2.1
In-Reply-To: <16886756.tisE06jRtd@even-i700>
References: <f95648df-f47b-77f9-db0d-75226addb386@actgate.com>
 <16886756.tisE06jRtd@even-i700>
Message-ID: <1485862338586-5305475.post@n6.nabble.com>

Even Rouault-2 wrote
> Another option is to not use shapefiles and use more powerful alternatives
> like GeoPackage 
> or Spatialite.
> 
> Even

I wonder how usable and reliable this peculiar attribute index is. Would it
be a big loss to stop supporting it?

-Jukka Rahkonen-




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-shapefile-field-indexing-on-OGR-1-x-vs-2-1-tp5305322p5305475.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Tue Jan 31 03:37:05 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 31 Jan 2017 12:37:05 +0100
Subject: [gdal-dev] shapefile field indexing on OGR 1.x vs 2.1
In-Reply-To: <eb9ab0fc-a7c3-a31f-61fe-63e0b746d66a@actgate.com>
References: <f95648df-f47b-77f9-db0d-75226addb386@actgate.com>
 <16886756.tisE06jRtd@even-i700>
 <eb9ab0fc-a7c3-a31f-61fe-63e0b746d66a@actgate.com>
Message-ID: <3098139.U2IlEh0k5T@even-i700>

> Even,
> 
> I tried ogr2ogr -lco RESIZE=YES and indeed the Integer64 field becomes
> Integer, but that changes the original shapefile, I was hoping to use
> the existing shapefile without touching it.

If there are no holes in feature numbering, you could normally reuse the existing .shp and 
.shx files ( or just create a copy of the .dbf, resize it, and rename it to its original name)

> 
> Related to the attribute index: when using SQL WHERE clauses like
> WHERE myfield IN (1, 2, 3) on the integer field, it reports on the last
> one only, like if the query was
> WHERE myfield = 3
> (while there are rows with myfield = 1 and 2 as well...)
> 
> This is happening only if using the mapinfo attribute index on 2.1 (was
> working on 1.x). If I manually remove the index files the query executes
> correctly.
> 

Ah that's indeed a regression. I've just fixed it per
https://trac.osgeo.org/gdal/ticket/6798

You can workaround it by using = and OR : "WHERE myfield = 1 OR myfield = 2 OR myfield = 
3". That or IN (when working) have similar performance.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170131/2eb15b83/attachment.html>

From battisti at actgate.com  Tue Jan 31 04:42:34 2017
From: battisti at actgate.com (Andrea Battisti)
Date: Tue, 31 Jan 2017 13:42:34 +0100
Subject: [gdal-dev] shapefile field indexing on OGR 1.x vs 2.1
In-Reply-To: <3098139.U2IlEh0k5T@even-i700>
References: <f95648df-f47b-77f9-db0d-75226addb386@actgate.com>
 <16886756.tisE06jRtd@even-i700>
 <eb9ab0fc-a7c3-a31f-61fe-63e0b746d66a@actgate.com>
 <3098139.U2IlEh0k5T@even-i700>
Message-ID: <d627cc60-49b9-260a-aef0-f68fe0d9b60e@actgate.com>


>
>> Related to the attribute index: when using SQL WHERE clauses like
>
>> WHERE myfield IN (1, 2, 3) on the integer field, it reports on the last
>
>> one only, like if the query was
>
>> WHERE myfield = 3
>
>> (while there are rows with myfield = 1 and 2 as well...)
>
>>
>
>> This is happening only if using the mapinfo attribute index on 2.1 (was
>
>> working on 1.x). If I manually remove the index files the query executes
>
>> correctly.
>
>>
>
>
>
> Ah that's indeed a regression. I've just fixed it per
>
> https://trac.osgeo.org/gdal/ticket/6798


Thank you!

Andrea


From Ahmed.Tolba at schiebel.net  Tue Jan 31 06:15:38 2017
From: Ahmed.Tolba at schiebel.net (Ahmed Tolba)
Date: Tue, 31 Jan 2017 14:15:38 +0000
Subject: [gdal-dev] WFS-T using OGR
In-Reply-To: <6433577.9LDBNAqD9F@even-i700>
References: <c75f5580b60247f6b204c44b650b9dbc@SRV046.seg.local>
 <5346348.SzerkG8gYQ@even-i700>
 <3e7b6b87f0c9411e8e6a98e809b318d6@SRV046.seg.local>
 <6433577.9LDBNAqD9F@even-i700>
Message-ID: <6f66c61bb46f4fc78cef64e390d10aad@SRV046.seg.local>

Can you please try with that server ?
WFS:http://192.168.139.128/cgi-bin/tinyows.exe?SERVICE=WFS&VERSION=1.1.0&outputFormat=JSON

From: Even Rouault [mailto:even.rouault at spatialys.com]
Sent: Friday, January 27, 2017 12:22 PM
To: Ahmed Tolba
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] WFS-T using OGR


On vendredi 27 janvier 2017 10:59:21 CET Ahmed Tolba wrote:

> Hi

> Thanks for your answer.

>

> I tried to do what you suggested, but I get " Can not insert the feature,

> because we didn't manage to parse the .XSD schema "



As the message suggests, the OGR WFS client didn't manage to get or correctly parse the schema for the layer. This is a bit surprising as TinyOWS should generate simple enough schemas for OGR to understand them. Difficult to know what happens without being able to reproduce on my side.



Even





--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170131/f940d219/attachment.html>

From benjamin.deschamps at canada.ca  Tue Jan 31 06:19:28 2017
From: benjamin.deschamps at canada.ca (Deschamps, Benjamin (AAFC/AAC))
Date: Tue, 31 Jan 2017 14:19:28 +0000
Subject: [gdal-dev] gdal.Rasterize select output type different than
 Float64
In-Reply-To: <1485860450738-5305466.post@n6.nabble.com>
References: <20170130201026.BC41E6138CB1@lists.osgeo.org>
 <1485860450738-5305466.post@n6.nabble.com>
Message-ID: <mailman.2.1485872373.18830.gdal-dev@lists.osgeo.org>

Thank you, should have looked a bit further...

Benjamin

-----Original Message-----
From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Rutger
Sent: January-31-17 6:01 AM
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] gdal.Rasterize select output type different than Float64

Hey Benjamin, 

This is fixed with 2.1.3, see (at the bottom):
https://trac.osgeo.org/gdal/wiki/Release/2.1.3-News

A workaround is shown at:
http://osgeo-org.1560.x6.nabble.com/gdal-RasterizeOptions-output-type-tp5293573p5293575.html


Regards,
Rutger



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-gdal-Rasterize-select-output-type-different-than-Float64-tp5305371p5305466.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at spatialys.com  Tue Jan 31 06:45:11 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 31 Jan 2017 15:45:11 +0100
Subject: [gdal-dev] WFS-T using OGR
In-Reply-To: <6f66c61bb46f4fc78cef64e390d10aad@SRV046.seg.local>
References: <c75f5580b60247f6b204c44b650b9dbc@SRV046.seg.local>
 <6433577.9LDBNAqD9F@even-i700>
 <6f66c61bb46f4fc78cef64e390d10aad@SRV046.seg.local>
Message-ID: <4811245.8qzm00Mg3r@even-i700>

On mardi 31 janvier 2017 14:15:38 CET Ahmed Tolba wrote:
> Can you please try with that server ?
> WFS:http://192.168.139.128/cgi-bin/tinyows.exe?SERVICE=WFS&VERSION=1.1.0&out
> putFormat=JSON

This is a non public URL. And outputFormat=JSON could actually be the cause for issues. You 
should try with default GML output.

> 
> From: Even Rouault [mailto:even.rouault at spatialys.com]
> Sent: Friday, January 27, 2017 12:22 PM
> To: Ahmed Tolba
> Cc: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] WFS-T using OGR
> 
> On vendredi 27 janvier 2017 10:59:21 CET Ahmed Tolba wrote:
> > Hi
> > 
> > Thanks for your answer.
> > 
> > 
> > 
> > I tried to do what you suggested, but I get " Can not insert the feature,
> > 
> > because we didn't manage to parse the .XSD schema "
> 
> As the message suggests, the OGR WFS client didn't manage to get or
> correctly parse the schema for the layer. This is a bit surprising as
> TinyOWS should generate simple enough schemas for OGR to understand them.
> Difficult to know what happens without being able to reproduce on my side.
> 
> 
> 
> Even
> 
> 
> 
> 
> 
> --
> 
> Spatialys - Geospatial professional services
> 
> http://www.spatialys.com


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170131/56b3dcb3/attachment.html>

From Ahmed.Tolba at schiebel.net  Tue Jan 31 07:29:53 2017
From: Ahmed.Tolba at schiebel.net (Ahmed Tolba)
Date: Tue, 31 Jan 2017 15:29:53 +0000
Subject: [gdal-dev] WFS-T using OGR
In-Reply-To: <4811245.8qzm00Mg3r@even-i700>
References: <c75f5580b60247f6b204c44b650b9dbc@SRV046.seg.local>
 <6433577.9LDBNAqD9F@even-i700>
 <6f66c61bb46f4fc78cef64e390d10aad@SRV046.seg.local>
 <4811245.8qzm00Mg3r@even-i700>
Message-ID: <daff8767990640449dd43d9b1ea0e318@SRV046.seg.local>

Hi Evan,

I have tried to debug,
               poFeatureDefn->GetFieldIndex("gml_id") == 0;
This returns -1

What does this mean ?


From: Even Rouault [mailto:even.rouault at spatialys.com]
Sent: Tuesday, January 31, 2017 3:45 PM
To: Ahmed Tolba
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] WFS-T using OGR


On mardi 31 janvier 2017 14:15:38 CET Ahmed Tolba wrote:

> Can you please try with that server ?

> WFS:http://192.168.139.128/cgi-bin/tinyows.exe?SERVICE=WFS&VERSION=1.1.0&out

> putFormat=JSON



This is a non public URL. And outputFormat=JSON could actually be the cause for issues. You should try with default GML output.



>

> From: Even Rouault [mailto:even.rouault at spatialys.com]

> Sent: Friday, January 27, 2017 12:22 PM

> To: Ahmed Tolba

> Cc: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

> Subject: Re: [gdal-dev] WFS-T using OGR

>

> On vendredi 27 janvier 2017 10:59:21 CET Ahmed Tolba wrote:

> > Hi

> >

> > Thanks for your answer.

> >

> >

> >

> > I tried to do what you suggested, but I get " Can not insert the feature,

> >

> > because we didn't manage to parse the .XSD schema "

>

> As the message suggests, the OGR WFS client didn't manage to get or

> correctly parse the schema for the layer. This is a bit surprising as

> TinyOWS should generate simple enough schemas for OGR to understand them.

> Difficult to know what happens without being able to reproduce on my side.

>

>

>

> Even

>

>

>

>

>

> --

>

> Spatialys - Geospatial professional services

>

> http://www.spatialys.com





--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170131/970d7cb6/attachment-0001.html>

From even.rouault at spatialys.com  Tue Jan 31 07:34:54 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 31 Jan 2017 16:34:54 +0100
Subject: [gdal-dev] WFS-T using OGR
In-Reply-To: <daff8767990640449dd43d9b1ea0e318@SRV046.seg.local>
References: <c75f5580b60247f6b204c44b650b9dbc@SRV046.seg.local>
 <4811245.8qzm00Mg3r@even-i700>
 <daff8767990640449dd43d9b1ea0e318@SRV046.seg.local>
Message-ID: <4247954.ghIoiHVnHv@even-i700>

On mardi 31 janvier 2017 15:29:53 CET Ahmed Tolba wrote:
> Hi Evan,
> 
> I have tried to debug,
>                poFeatureDefn->GetFieldIndex("gml_id") == 0;
> This returns -1
> 
> What does this mean ?

That there's no gml_id field found. Which is expected if you indeed use JSON ouput. 
Only GML output can generate a fid / gml_id. And this fid / gml_id is required for WFS-T.
Bottom line: remove &outputFormat=JSON

> 
> 
> From: Even Rouault [mailto:even.rouault at spatialys.com]
> Sent: Tuesday, January 31, 2017 3:45 PM
> To: Ahmed Tolba
> Cc: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] WFS-T using OGR
> 
> On mardi 31 janvier 2017 14:15:38 CET Ahmed Tolba wrote:
> > Can you please try with that server ?
> > 
> > WFS:http://192.168.139.128/cgi-bin/tinyows.exe?SERVICE=WFS&VERSION=1.1.0&o
> > ut
> > 
> > putFormat=JSON
> 
> This is a non public URL. And outputFormat=JSON could actually be the cause
> for issues. You should try with default GML output.
> > From: Even Rouault [mailto:even.rouault at spatialys.com]
> > 
> > Sent: Friday, January 27, 2017 12:22 PM
> > 
> > To: Ahmed Tolba
> > 
> > Cc: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
> > 
> > Subject: Re: [gdal-dev] WFS-T using OGR
> > 
> > On vendredi 27 janvier 2017 10:59:21 CET Ahmed Tolba wrote:
> > > Hi
> > > 
> > > 
> > > 
> > > Thanks for your answer.
> > > 
> > > 
> > > 
> > > 
> > > 
> > > 
> > > 
> > > I tried to do what you suggested, but I get " Can not insert the
> > > feature,
> > > 
> > > 
> > > 
> > > because we didn't manage to parse the .XSD schema "
> > 
> > As the message suggests, the OGR WFS client didn't manage to get or
> > 
> > correctly parse the schema for the layer. This is a bit surprising as
> > 
> > TinyOWS should generate simple enough schemas for OGR to understand them.
> > 
> > Difficult to know what happens without being able to reproduce on my side.
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > Even
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > --
> > 
> > 
> > 
> > Spatialys - Geospatial professional services
> > 
> > 
> > 
> > http://www.spatialys.com
> 
> --
> 
> Spatialys - Geospatial professional services
> 
> http://www.spatialys.com


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170131/2ea6088a/attachment.html>

From sean at mapbox.com  Tue Jan 31 08:33:23 2017
From: sean at mapbox.com (Sean Gillies)
Date: Tue, 31 Jan 2017 17:33:23 +0100
Subject: [gdal-dev] Zip files and VISFileFromMemBuffer()
Message-ID: <CADPhZXwQ_ZOPwxRsr=ArHCVWxL0zwFuxM=3P45TDO9m9ONWGQw@mail.gmail.com>

Hey all,

The tests in
https://svn.osgeo.org/gdal/branches/1.9/autotest/gcore/vsizip.py show how
to create a zip archive in memory and create directories and files within
it. I'm looking for a shortcut.

Given a sequence of bytes representing an existing zip file that contains a
TIFF and a VRT (referencing the TIFF), is it possible to make a VSI file
from this buffer (using VISFileFromMemBuffer()) and then access the VRT
using a path like /vsizip/vsimem/archive.zip/example.vrt protocol?

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170131/a2f012c0/attachment.html>

From even.rouault at spatialys.com  Tue Jan 31 08:42:23 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 31 Jan 2017 17:42:23 +0100
Subject: [gdal-dev] Zip files and VISFileFromMemBuffer()
In-Reply-To: <CADPhZXwQ_ZOPwxRsr=ArHCVWxL0zwFuxM=3P45TDO9m9ONWGQw@mail.gmail.com>
References: <CADPhZXwQ_ZOPwxRsr=ArHCVWxL0zwFuxM=3P45TDO9m9ONWGQw@mail.gmail.com>
Message-ID: <7906214.4ItMEDhMbS@even-i700>

On mardi 31 janvier 2017 17:33:23 CET Sean Gillies wrote:
> Hey all,
> 
> The tests in
> https://svn.osgeo.org/gdal/branches/1.9/autotest/gcore/vsizip.py show how
> to create a zip archive in memory and create directories and files within
> it. I'm looking for a shortcut.
> 
> Given a sequence of bytes representing an existing zip file that contains a
> TIFF and a VRT (referencing the TIFF), is it possible to make a VSI file
> from this buffer (using VISFileFromMemBuffer()) and then access the VRT
> using a path like /vsizip/vsimem/archive.zip/example.vrt protocol?

Hi Sean,

That sounds like you tested it and something went wrong ? Perhaps check the path to the 
source in the VRT and the value of the relativeToVRT attribute.

Your above strategy does work for me:

$ gdal_translate byte.tif byte.vrt -of VRT
Input file size is 20, 20

$ zip byte.tif.zip byte.tif byte.vrt
  adding: byte.tif (deflated 96%)
  adding: byte.vrt (deflated 53%)

$ python
>>> from osgeo import gdal
>>> data = open('byte.tif.zip', 'rb').read()
>>> gdal.FileFromMemBuffer('/vsimem/archive.zip', data)
>>> ds = gdal.Open('/vsizip/vsimem/archive.zip/byte.vrt')
>>> ds.GetRasterBand(1).Checksum()
4672


Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170131/79881c7b/attachment-0001.html>

From Niels.vonFestenberg-Packisch.ext at rohde-schwarz.com  Tue Jan 31 08:46:15 2017
From: Niels.vonFestenberg-Packisch.ext at rohde-schwarz.com (Niels.vonFestenberg-Packisch.ext at rohde-schwarz.com)
Date: Tue, 31 Jan 2017 17:46:15 +0100
Subject: [gdal-dev] Question in orthographic projection usage with PROJ4
Message-ID: <OFABCBD819.AA2457EC-ONC12580B9.00539026-C12580B9.005C203D@rohde-schwarz.com>

Hi all, 
I would like to transform local cartesian coordinates into longitude and 
latitude. According to all the documentation I could find, I tried doing 
this (in C++, specifying a center for the orthographic projection at 56 N 
15 E): 

projPJ cSourceProjection = pj_init_plus("+proj=ortho +ellps=WGS84 
+datum=WGS84 +lat_0=56 +lon_0=15 +no_defs");
projPJ cTargetProjection = pj_init_plus("+proj=longlat +ellps=WGS84 
+datum=WGS84 +no_defs");
projXY pt;
// 1
pt.u = 0; pt.v = 0; 
pj_transform( cSourceProjection, cTargetProjection, 1, 0, &pt.u, &pt.v, 0 
);
printf ("Result 1: %2.6f %2.6f", pt.u, pt.v); 
// 2
pt.u = 0; pt.v = 111120; 
pj_transform( cSourceProjection, cTargetProjection, 1, 0, &pt.u, &pt.v, 0 
);
printf ("Result 2: %2.6f %2.6f", pt.u, pt.v); 

--> Delivers : 
Result 1: 0.26180 0.97738 
Result 2: 0.29295 0.97716
 
However, I would like to get something like 
"Result 1: 56.0.. 15.0.." (i.e. the projection center itself, no matter 
what scaling there might be) and 
"Result 2: 57.0.. 15.." (if pt is interpreted in meters) 
- at least anything that resembles reasonable longitude and latitude 
values, but I don't...

Could you maybe give me a hint what is going wrong here? 

Thank you in advance for any help!

Regards
Niels







-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170131/a3a345eb/attachment.html>

From daniele.romagnoli at geo-solutions.it  Tue Jan 31 09:29:48 2017
From: daniele.romagnoli at geo-solutions.it (Daniele Romagnoli)
Date: Tue, 31 Jan 2017 18:29:48 +0100
Subject: [gdal-dev] Question on 0th IFD offset when producing a
 JPEG-Compressed GeoTIFF (GDAL 1.11 vs 2.x)
In-Reply-To: <CAJaHrDx0K6zgyktOV9-KDMNhxGEHrpGDLj7mSzDCJCn489TNLQ@mail.gmail.com>
References: <CAJaHrDwPP5_1_+oTAi2u=reSYRbjWhb2cKyREXFe0sLfB3XUVQ@mail.gmail.com>
 <5533045.SmJALounZ5@even-i700>
 <CAJaHrDxNew_OffFTXMBkdQut=Mrok=O+=037jEYfrSuO_x5xqw@mail.gmail.com>
 <7413075.dPIrFvsHGm@even-i700>
 <CAJaHrDx0K6zgyktOV9-KDMNhxGEHrpGDLj7mSzDCJCn489TNLQ@mail.gmail.com>
Message-ID: <CAJaHrDwc76v8DRCCQW9OKyH_sB2KiVe3kP7oEB6kmgceAqAfGg@mail.gmail.com>

Hi Even,
I'm back to this topic and I have a couple of questions.
- Is it there any libtiff specific version involvement on that?
- Are all these improvements self contained in GDAL code itself or do them
require some specific libtiff version?

Cheers,
Daniele

On Fri, Dec 16, 2016 at 2:56 PM, Daniele Romagnoli <
daniele.romagnoli at geo-solutions.it> wrote:

>
>
> On Fri, Dec 16, 2016 at 2:48 PM, Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>>
>>
>> > Right,
>>
>> > Indeed, before sending my previous email I have also tried with:
>>
>> > *gdaladdo -r average --config COMPRESS_OVERVIEW DEFLATE --config
>>
>> > PHOTOMETRIC_OVERVIEW RGB*
>>
>> > to understand if it was related to JPEG only but, even with these
>> options,
>>
>> > the output overviews were jpeg compressed (I assume there is some kind
>> of
>>
>> > coherency check in gdaladdo).
>>
>>
>>
>> With internal overviews, the _OVERVIEW configuration options are ignored.
>> Their value is deduced from the settings of the main IFD.
>>
> It makes sense, indeed.
>
>
>> I don't think there's a strong technical reason for that. Mostly a side
>> effect of the fact that there are slightly different code paths to handle
>> creation of internal and external overviews, and the reading of _OVERVIEW
>> config options is done only in the external overview code path.
>>
>>
>>
>> >
>>
>> > > I do reproduce something similar to your findings in 2.1 indeed. This
>> no
>>
>> > > longer happens in trunk due to related improvements (
>>
>> > > https://trac.osgeo.org/gdal/wiki/CloudOptimizedGeoTIFF), I made in
>> the
>>
>> > > last couple of weeks (using the same trick of creating a in-memory
>> TIFF
>>
>> > > file to get the JPEG tables and set them direcly on the overview IFD
>> at
>>
>> > > creation time).
>>
>> >
>>
>> > Do you think this will be available in other series or does it introduce
>>
>> > new API/major changes which makes it available on 2.2.x only?
>>
>>
>>
>> No API change, but this is in the improvement category rather than
>> bugfixing, and my first changeset resulted in some corrupted images in some
>> situations, which was unnoticed for a few weeks, so that's a sign that it
>> is a somewhat risky change (the GeoTIFF driver is a complex beast), not
>> worth the trouble of breaking stable branches.
>>
> Understood. thanks for the feedback.
> Cheers,
> Daniele
>
>
>>
>>
>> Even
>>
>>
>>
>> --
>>
>> Spatialys - Geospatial professional services
>>
>> http://www.spatialys.com
>>
>
>
>
> --
> ==
> GeoServer Professional Services from the experts! Visit
> http://goo.gl/it488V for more information.
> ==
>
> Ing. Daniele Romagnoli
> Senior Software Engineer
>
> GeoSolutions S.A.S.
> Via di Montramito 3/A
> 55054  Massarosa (LU)
> Italy
> phone: +39 0584 962313 <+39%200584%20962313>
> fax:      +39 0584 1660272 <+39%200584%20166%200272>
>
> http://www.geo-solutions.it
> http://twitter.com/geosolutions_it
>
> -------------------------------------------------------
>
> *AVVERTENZE AI SENSI DEL D.Lgs. 196/2003*
>
> Le informazioni contenute in questo messaggio di posta elettronica e/o
> nel/i file/s allegato/i sono da considerarsi strettamente riservate. Il
> loro utilizzo è consentito esclusivamente al destinatario del messaggio,
> per le finalità indicate nel messaggio stesso. Qualora riceviate questo
> messaggio senza esserne il destinatario, Vi preghiamo cortesemente di
> darcene notizia via e-mail e di procedere alla distruzione del messaggio
> stesso, cancellandolo dal Vostro sistema. Conservare il messaggio stesso,
> divulgarlo anche in parte, distribuirlo ad altri soggetti, copiarlo, od
> utilizzarlo per finalità diverse, costituisce comportamento contrario ai
> principi dettati dal D.Lgs. 196/2003.
>
>
>
> The information in this message and/or attachments, is intended solely for
> the attention and use of the named addressee(s) and may be confidential or
> proprietary in nature or covered by the provisions of privacy act
> (Legislative Decree June, 30 2003, no.196 - Italy's New Data Protection
> Code).Any use not in accord with its purpose, any disclosure, reproduction,
> copying, distribution, or either dissemination, either whole or partial, is
> strictly forbidden except previous formal approval of the named
> addressee(s). If you are not the intended recipient, please contact
> immediately the sender by telephone, fax or e-mail and delete the
> information in this message that has been received in error. The sender
> does not give any warranty or accept liability as the content, accuracy or
> completeness of sent messages and accepts no responsibility  for changes
> made after they were sent or for other risks which arise as a result of
> e-mail transmission, viruses, etc.
>
>


-- 
==
GeoServer Professional Services from the experts! Visit
http://goo.gl/it488V for more information.
==

Ing. Daniele Romagnoli
Senior Software Engineer

GeoSolutions S.A.S.
Via di Montramito 3/A
55054  Massarosa (LU)
Italy
phone: +39 0584 962313
fax:      +39 0584 1660272

http://www.geo-solutions.it
http://twitter.com/geosolutions_it

-------------------------------------------------------

*AVVERTENZE AI SENSI DEL D.Lgs. 196/2003*

Le informazioni contenute in questo messaggio di posta elettronica e/o
nel/i file/s allegato/i sono da considerarsi strettamente riservate. Il
loro utilizzo è consentito esclusivamente al destinatario del messaggio,
per le finalità indicate nel messaggio stesso. Qualora riceviate questo
messaggio senza esserne il destinatario, Vi preghiamo cortesemente di
darcene notizia via e-mail e di procedere alla distruzione del messaggio
stesso, cancellandolo dal Vostro sistema. Conservare il messaggio stesso,
divulgarlo anche in parte, distribuirlo ad altri soggetti, copiarlo, od
utilizzarlo per finalità diverse, costituisce comportamento contrario ai
principi dettati dal D.Lgs. 196/2003.



The information in this message and/or attachments, is intended solely for
the attention and use of the named addressee(s) and may be confidential or
proprietary in nature or covered by the provisions of privacy act
(Legislative Decree June, 30 2003, no.196 - Italy's New Data Protection
Code).Any use not in accord with its purpose, any disclosure, reproduction,
copying, distribution, or either dissemination, either whole or partial, is
strictly forbidden except previous formal approval of the named
addressee(s). If you are not the intended recipient, please contact
immediately the sender by telephone, fax or e-mail and delete the
information in this message that has been received in error. The sender
does not give any warranty or accept liability as the content, accuracy or
completeness of sent messages and accepts no responsibility  for changes
made after they were sent or for other risks which arise as a result of
e-mail transmission, viruses, etc.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170131/6d9edfd0/attachment-0001.html>

From even.rouault at spatialys.com  Tue Jan 31 09:34:24 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 31 Jan 2017 18:34:24 +0100
Subject: [gdal-dev] Question on 0th IFD offset when producing a
	JPEG-Compressed GeoTIFF (GDAL 1.11 vs 2.x)
In-Reply-To: <CAJaHrDwc76v8DRCCQW9OKyH_sB2KiVe3kP7oEB6kmgceAqAfGg@mail.gmail.com>
References: <CAJaHrDwPP5_1_+oTAi2u=reSYRbjWhb2cKyREXFe0sLfB3XUVQ@mail.gmail.com>
 <CAJaHrDx0K6zgyktOV9-KDMNhxGEHrpGDLj7mSzDCJCn489TNLQ@mail.gmail.com>
 <CAJaHrDwc76v8DRCCQW9OKyH_sB2KiVe3kP7oEB6kmgceAqAfGg@mail.gmail.com>
Message-ID: <1630066.YYN0yo8X9a@even-i700>

On mardi 31 janvier 2017 18:29:48 CET Daniele Romagnoli wrote:
> Hi Even,
> I'm back to this topic and I have a couple of questions.
> - Is it there any libtiff specific version involvement on that?
> - Are all these improvements self contained in GDAL code itself or do them
> require some specific libtiff version?

Should probably work with any libtiff 4.0.X version

> 
> Cheers,
> Daniele
> 
> On Fri, Dec 16, 2016 at 2:56 PM, Daniele Romagnoli <
> 
> daniele.romagnoli at geo-solutions.it> wrote:
> > On Fri, Dec 16, 2016 at 2:48 PM, Even Rouault <even.rouault at spatialys.com>
> > 
> > wrote:
> >> > Right,
> >> > 
> >> > Indeed, before sending my previous email I have also tried with:
> >> > 
> >> > *gdaladdo -r average --config COMPRESS_OVERVIEW DEFLATE --config
> >> > 
> >> > PHOTOMETRIC_OVERVIEW RGB*
> >> > 
> >> > to understand if it was related to JPEG only but, even with these
> >> 
> >> options,
> >> 
> >> > the output overviews were jpeg compressed (I assume there is some kind
> >> 
> >> of
> >> 
> >> > coherency check in gdaladdo).
> >> 
> >> With internal overviews, the _OVERVIEW configuration options are ignored.
> >> Their value is deduced from the settings of the main IFD.
> > 
> > It makes sense, indeed.
> > 
> >> I don't think there's a strong technical reason for that. Mostly a side
> >> effect of the fact that there are slightly different code paths to handle
> >> creation of internal and external overviews, and the reading of _OVERVIEW
> >> config options is done only in the external overview code path.
> >> 
> >> > > I do reproduce something similar to your findings in 2.1 indeed. This
> >> 
> >> no
> >> 
> >> > > longer happens in trunk due to related improvements (
> >> > > 
> >> > > https://trac.osgeo.org/gdal/wiki/CloudOptimizedGeoTIFF), I made in
> >> 
> >> the
> >> 
> >> > > last couple of weeks (using the same trick of creating a in-memory
> >> 
> >> TIFF
> >> 
> >> > > file to get the JPEG tables and set them direcly on the overview IFD
> >> 
> >> at
> >> 
> >> > > creation time).
> >> > 
> >> > Do you think this will be available in other series or does it
> >> > introduce
> >> > 
> >> > new API/major changes which makes it available on 2.2.x only?
> >> 
> >> No API change, but this is in the improvement category rather than
> >> bugfixing, and my first changeset resulted in some corrupted images in
> >> some
> >> situations, which was unnoticed for a few weeks, so that's a sign that it
> >> is a somewhat risky change (the GeoTIFF driver is a complex beast), not
> >> worth the trouble of breaking stable branches.
> > 
> > Understood. thanks for the feedback.
> > Cheers,
> > Daniele
> > 
> >> Even
> >> 
> >> 
> >> 
> >> --
> >> 
> >> Spatialys - Geospatial professional services
> >> 
> >> http://www.spatialys.com
> > 
> > --
> > ==
> > GeoServer Professional Services from the experts! Visit
> > http://goo.gl/it488V for more information.
> > ==
> > 
> > Ing. Daniele Romagnoli
> > Senior Software Engineer
> > 
> > GeoSolutions S.A.S.
> > Via di Montramito 3/A
> > 55054  Massarosa (LU)
> > Italy
> > phone: +39 0584 962313 <+39%200584%20962313>
> > fax:      +39 0584 1660272 <+39%200584%20166%200272>
> > 
> > http://www.geo-solutions.it
> > http://twitter.com/geosolutions_it
> > 
> > -------------------------------------------------------
> > 
> > *AVVERTENZE AI SENSI DEL D.Lgs. 196/2003*
> > 
> > Le informazioni contenute in questo messaggio di posta elettronica e/o
> > nel/i file/s allegato/i sono da considerarsi strettamente riservate. Il
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170131/5bc752e3/attachment-0001.html>

From cwaigl at alaska.edu  Tue Jan 31 12:02:05 2017
From: cwaigl at alaska.edu (Chris Waigl)
Date: Tue, 31 Jan 2017 11:02:05 -0900
Subject: [gdal-dev] Question in orthographic projection usage with PROJ4
In-Reply-To: <OFABCBD819.AA2457EC-ONC12580B9.00539026-C12580B9.005C203D@rohde-schwarz.com>
References: <OFABCBD819.AA2457EC-ONC12580B9.00539026-C12580B9.005C203D@rohde-schwarz.com>
Message-ID: <12376124-2AB4-4FE1-8ACC-E36BCF0852E5@alaska.edu>




> On Jan 31, 2017, at 7:46 AM, Niels.vonFestenberg-Packisch.ext at rohde-schwarz.com wrote:
> 
> Hi all, 
> I would like to transform local cartesian coordinates into longitude and latitude. According to all the documentation I could find, I tried doing this (in C++, specifying a center for the orthographic projection at 56 N 15 E): 
> 
> projPJ cSourceProjection = pj_init_plus("+proj=ortho +ellps=WGS84 +datum=WGS84 +lat_0=56 +lon_0=15 +no_defs"); 
> projPJ cTargetProjection = pj_init_plus("+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"); 
> projXY pt; 
> // 1 
> pt.u = 0; pt.v = 0; 
> pj_transform( cSourceProjection, cTargetProjection, 1, 0, &pt.u, &pt.v, 0 ); 
> printf ("Result 1: %2.6f %2.6f", pt.u, pt.v); 
> // 2 
> pt.u = 0; pt.v = 111120; 
> pj_transform( cSourceProjection, cTargetProjection, 1, 0, &pt.u, &pt.v, 0 ); 
> printf ("Result 2: %2.6f %2.6f", pt.u, pt.v); 
> 
> --> Delivers : 
> Result 1: 0.26180 0.97738 


Your Result 1 is 15.0° and 56.0° respectively, in radians. 

Chris

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170131/70f2ec49/attachment.html>

From sean at mapbox.com  Tue Jan 31 15:35:31 2017
From: sean at mapbox.com (Sean Gillies)
Date: Wed, 1 Feb 2017 00:35:31 +0100
Subject: [gdal-dev] Zip files and VISFileFromMemBuffer()
In-Reply-To: <7906214.4ItMEDhMbS@even-i700>
References: <CADPhZXwQ_ZOPwxRsr=ArHCVWxL0zwFuxM=3P45TDO9m9ONWGQw@mail.gmail.com>
 <7906214.4ItMEDhMbS@even-i700>
Message-ID: <CADPhZXzVsOKsviicXXR9ptoybLrQvv22EBa0j9h6V2Cd3B=89A@mail.gmail.com>

Thanks for confirming that I was on the right trail, Even! I got it figured
out: I was naively trying to open the /vsizip/vsimem/ file in update mode.

In case you're interested, my new Python usage is like this:

with open(path_zip_file, 'rb') as f:
    with MemoryFile(f) as memfile:
        with memfile.open('white-gemini-iv.vrt') as dataset:
            assert dataset.count == 3

https://github.com/mapbox/rasterio/pull/972/files#diff-d3388b510bd97235e4741b8417cc41e9R148


On Tue, Jan 31, 2017 at 5:42 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> On mardi 31 janvier 2017 17:33:23 CET Sean Gillies wrote:
>
> > Hey all,
>
> >
>
> > The tests in
>
> > https://svn.osgeo.org/gdal/branches/1.9/autotest/gcore/vsizip.py show
> how
>
> > to create a zip archive in memory and create directories and files within
>
> > it. I'm looking for a shortcut.
>
> >
>
> > Given a sequence of bytes representing an existing zip file that
> contains a
>
> > TIFF and a VRT (referencing the TIFF), is it possible to make a VSI file
>
> > from this buffer (using VISFileFromMemBuffer()) and then access the VRT
>
> > using a path like /vsizip/vsimem/archive.zip/example.vrt protocol?
>
>
>
> Hi Sean,
>
>
>
> That sounds like you tested it and something went wrong ? Perhaps check
> the path to the source in the VRT and the value of the relativeToVRT
> attribute.
>
>
>
> Your above strategy does work for me:
>
>
>
> $ gdal_translate byte.tif byte.vrt -of VRT
>
> Input file size is 20, 20
>
>
>
> $ zip byte.tif.zip byte.tif byte.vrt
>
> adding: byte.tif (deflated 96%)
>
> adding: byte.vrt (deflated 53%)
>
>
>
> $ python
>
> >>> from osgeo import gdal
>
> >>> data = open('byte.tif.zip', 'rb').read()
>
> >>> gdal.FileFromMemBuffer('/vsimem/archive.zip', data)
>
> >>> ds = gdal.Open('/vsizip/vsimem/archive.zip/byte.vrt')
>
> >>> ds.GetRasterBand(1).Checksum()
>
> 4672
>
>
>
>
>
> Even
>
>
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>



-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170201/6aa64007/attachment.html>

From schwehr at gmail.com  Tue Jan 31 15:56:41 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Tue, 31 Jan 2017 15:56:41 -0800
Subject: [gdal-dev] Zip files and VISFileFromMemBuffer()
In-Reply-To: <CADPhZXzVsOKsviicXXR9ptoybLrQvv22EBa0j9h6V2Cd3B=89A@mail.gmail.com>
References: <CADPhZXwQ_ZOPwxRsr=ArHCVWxL0zwFuxM=3P45TDO9m9ONWGQw@mail.gmail.com>
 <7906214.4ItMEDhMbS@even-i700>
 <CADPhZXzVsOKsviicXXR9ptoybLrQvv22EBa0j9h6V2Cd3B=89A@mail.gmail.com>
Message-ID: <CACmBxytb+2dawSBm91ZA1urAu=xNQUTW9u433+5z-74a6ky6Dg@mail.gmail.com>

Sean,

Very cool.  One follow up question, do you really need the "with" for
open?  Does this not work (and MemoryFile can drop the file descriptor as
soon as it wants to)?

with MemoryFile(open(path_zip_file, 'rb')) as memfile:
        with memfile.open('white-gemini-iv.vrt') as dataset:
            assert dataset.count == 3

On Tue, Jan 31, 2017 at 3:35 PM, Sean Gillies <sean at mapbox.com> wrote:

> Thanks for confirming that I was on the right trail, Even! I got it
> figured out: I was naively trying to open the /vsizip/vsimem/ file in
> update mode.
>
> In case you're interested, my new Python usage is like this:
>
> with open(path_zip_file, 'rb') as f:
>     with MemoryFile(f) as memfile:
>         with memfile.open('white-gemini-iv.vrt') as dataset:
>             assert dataset.count == 3
>
> https://github.com/mapbox/rasterio/pull/972/files#diff-
> d3388b510bd97235e4741b8417cc41e9R148
>
>
> On Tue, Jan 31, 2017 at 5:42 PM, Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> On mardi 31 janvier 2017 17:33:23 CET Sean Gillies wrote:
>>
>> > Hey all,
>>
>> >
>>
>> > The tests in
>>
>> > https://svn.osgeo.org/gdal/branches/1.9/autotest/gcore/vsizip.py show
>> how
>>
>> > to create a zip archive in memory and create directories and files
>> within
>>
>> > it. I'm looking for a shortcut.
>>
>> >
>>
>> > Given a sequence of bytes representing an existing zip file that
>> contains a
>>
>> > TIFF and a VRT (referencing the TIFF), is it possible to make a VSI file
>>
>> > from this buffer (using VISFileFromMemBuffer()) and then access the VRT
>>
>> > using a path like /vsizip/vsimem/archive.zip/example.vrt protocol?
>>
>>
>>
>> Hi Sean,
>>
>>
>>
>> That sounds like you tested it and something went wrong ? Perhaps check
>> the path to the source in the VRT and the value of the relativeToVRT
>> attribute.
>>
>>
>>
>> Your above strategy does work for me:
>>
>>
>>
>> $ gdal_translate byte.tif byte.vrt -of VRT
>>
>> Input file size is 20, 20
>>
>>
>>
>> $ zip byte.tif.zip byte.tif byte.vrt
>>
>> adding: byte.tif (deflated 96%)
>>
>> adding: byte.vrt (deflated 53%)
>>
>>
>>
>> $ python
>>
>> >>> from osgeo import gdal
>>
>> >>> data = open('byte.tif.zip', 'rb').read()
>>
>> >>> gdal.FileFromMemBuffer('/vsimem/archive.zip', data)
>>
>> >>> ds = gdal.Open('/vsizip/vsimem/archive.zip/byte.vrt')
>>
>> >>> ds.GetRasterBand(1).Checksum()
>>
>> 4672
>>
>>
>>
>>
>>
>> Even
>>
>>
>>
>>
>>
>> --
>>
>> Spatialys - Geospatial professional services
>>
>> http://www.spatialys.com
>>
>
>
>
> --
> Sean Gillies
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170131/fcba19dd/attachment-0001.html>

