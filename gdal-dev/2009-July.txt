From peifer at gmx.eu  Wed Jul  1 04:50:51 2009
From: peifer at gmx.eu (Hermann Peifer)
Date: Wed Jul  1 04:53:08 2009
Subject: [gdal-dev] PackBitsDecode: Not enough data ...
In-Reply-To: <200906302203.26333.even.rouault@mines-paris.org>
References: <h2d65t$k1u$1@ger.gmane.org>
	<200906302203.26333.even.rouault@mines-paris.org>
Message-ID: <4A4B236B.5030501@gmx.eu>

Even Rouault wrote:
> Does gdalinfo -checksum lceugr100_00_pct_epsg4326.tif works ?
>   
Not really:
Warning 1: lceugr100_00_pct_epsg4326.tif:PackBitsDecode: discarding 94 
bytes to avoid buffer overrun
ERROR 1: lceugr100_00_pct_epsg4326.tif:PackBitsDecode: Not enough data 
for scanline 13228
ERROR 1: TIFFReadEncodedStrip() failed.

ERROR 1: IReadBlock failed at X offset 0, Y offset 13228
ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 13228
ERROR 3: Checksum value couldn't be computed due to I/O read error.

> If it doesn't, you might want to try with a recent GDAL (e.g 1.6.1)and internal libtiff support.
>   
OK. I upgraded from version 1.6.0 to 1.6.1. This didn't help. I ran into 
the same error at the same scanline 22054. :-(

I am also not too sure about internal libtiff support, as configure 
tells me:
LIBTIFF support:           external (BigTIFF=no)

Some postings on Internet suggest as a workaround: first warping without 
compression, then compressing afterwards via gdal_translate. This worked 
fine for smaller raster data sets, but eventually, I ran into the error 
that the uncompressed (intermediate) destination file would be larger 
than the limit (4GB).

I am basically stuck now.

:-( Hermann

> Le Tuesday 30 June 2009 16:06:52 Hermann Peifer, vous avez ?crit :
>   
>> Hi.
>>
>> I am trying to warp a GeoTiff from EPSG:3035 to EPSG:4326. After 50%
>> done, I end up with the following errors:
>>
>> $ gdalwarp -t_srs EPSG:4326 lceugr100_00_pct.tif lceugr100_00_pct_epsg4326.tif -co COMPRESS=PACKBITS
>>
>> Copying color table from lceugr100_00_pct.tif to new file.
>> Creating output file that is 121261P x 44229L.
>> Processing input file lceugr100_00_pct.tif.
>>
>> 0...10...20...30...40...50..ERROR 1:
>> lceugr100_00_pct_epsg4326.tif:PackBitsDecode: Not enough data for
>> scanline 22054
>>
>> ERROR 1: TIFFReadEncodedStrip() failed.
>> ERROR 1: IReadBlock failed at X offset 0, Y offset 22054
>> ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 22054
>>
>> Is there any issue with the decoding the PACKBITS compression?
>>
>> Hermann
>>
>>
>>
>> $ gdalinfo lceugr100_00_pct.tif
>>
>> Driver: GTiff/GeoTIFF
>> Files: lceugr100_00_pct.tif
>>         lceugr100_00_pct.aux
>> Size is 67000, 58000
>> Coordinate System is:
>> PROJCS["ETRS_1989_LAEA_L52_M10",
>>      GEOGCS["GCS_ETRS_1989",
>>          DATUM["European_Terrestrial_Reference_System_1989",
>>              SPHEROID["GRS_1980",6378137.0,298.257222101]],
>>          PRIMEM["Greenwich",0.0],
>>          UNIT["Degree",0.0174532925199433]],
>>      PROJECTION["Lambert_Azimuthal_Equal_Area"],
>>      PARAMETER["False_Easting",4321000.0],
>>      PARAMETER["False_Northing",3210000.0],
>>      PARAMETER["Central_Meridian",10.0],
>>      PARAMETER["Latitude_Of_Origin",52.0],
>>      UNIT["Meter",1.0]]
>> Origin = (800000.000000000000000,6500000.000000000000000)
>> Pixel Size = (100.000000000000000,-100.000000000000000)
>> Metadata:
>>    AREA_OR_POINT=Area
>> Image Structure Metadata:
>>    COMPRESSION=PACKBITS
>>    INTERLEAVE=BAND
>> Corner Coordinates:
>> Upper Left  (  800000.000, 6500000.000) ( 72d48'20.05"W, 59d 5'6.85"N)
>> Lower Left  (  800000.000,  700000.000) ( 24d 7'20.21"W, 22d12'54.64"N)
>> Upper Right ( 7500000.000, 6500000.000) ( 90d22'56.28"E, 61d55'58.94"N)
>> Lower Right ( 7500000.000,  700000.000) ( 41d 0'50.13"E, 23d29'5.23"N)
>> Center      ( 4150000.000, 3600000.000) (  7d17'47.28"E, 55d28'33.08"N)
>> Band 1 Block=67000x1 Type=Byte, ColorInterp=Palette
>>    Metadata:
>>      LAYER_TYPE=thematic
>>    Color Table (RGB with 256 entries)
>> ...
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>     
>
>   
From szekerest at gmail.com  Wed Jul  1 06:26:56 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Jul  1 06:26:58 2009
Subject: [gdal-dev] Re: Future compatibility - plugins (C#)
In-Reply-To: <h2dtct$ndb$1@ger.gmane.org>
References: <h2df1n$cm6$1@ger.gmane.org>
	<f3b73b7d0906301216w67d89ack34845dcd97d353a0@mail.gmail.com>
	<h2dtct$ndb$1@ger.gmane.org>
Message-ID: <f3b73b7d0907010326i34aededcxc5aaef3f52546e9@mail.gmail.com>

I think you'd require a better versioning of the assemblies in order to
install that side by side in the Global Assembly Cache (am I right?). The
biggest problem around here is to properly load the the late bound unmanaged
dll versions (loded by LoadLibrary) which uses a different mechanism
(searcing for the dll-s in the executing directory and the PATH environment)
which doesn't allow to have those versions side by side.

We could also try intalling the unmanages dlls in the SxS, and refer to
those files in the assembly manifest (which may cause pre-loading those
dll-s) but I didn't try this solution and I can't confirm whether it works
or not.

Best regards,

Tamas



2009/6/30 Tomas R <monshi@home.se>

> Ok. To clear it out.
>
> I have a plugin which make gdal available for plugins within SportTracks.
> Actually, just adds gdal libraries to the path the plugins find them at
> runtime. That is, late bindings.
>
> In simple words. How do I go about updating the plugin?
> If I have gdal 1.5.1 on the path and  a plugin compiled against gdal 1.6.1
> it fails
> If I have gdal 1.6.1 on the path and a plugin compiled against gdal 1.5.1
> it fails.
> Two independent version of gdal installed, only one of them is loaded and
> available (the one with the lowest GUID actually)
>
> You have added a strong name in gdal 1.6, do this affect this behaviour?
> When moving to gdal 1.7 will  any of the above setting work (switch 1.5 to
> 1.6 and 1.6 to 1.7) or will it always be cumbersome to upgrade?
>
> Any suggestions? It is a bit hard on the developers, and users!,  depending
> in my plugin, me telling them "I will update gdal next week, it will break
> your current version of the plugin".
>
> One of the developers has a solution on his part. He sets up a wrapper that
> tries to bind to gdal 1.5.1 and one wrapper that tries to bind to gdal
> 1.6.1. The one that works he uses and it provides the function calls to gdal
> he needs. This way it will be possible for him to support multiple version,
> two  wrappers should do since I will put the 1.5 version off line at the
> time I upload 1.6.1 version. 1.5 version should die. Other plugin developers
> can of course also use this method and it is not to cumbersome I guess.
>
> Environment. 1.6.1 is compiled with VSE 2008, old version was compiled with
> VSE 2005. Only x86. SportTracks now compiled with an x86 flag, forcing it to
> run in 32 bit mode because of various problem with plugins in 64 bit mode.
>
> Since you (now) have compiled versions on the web perhaps I should give up
> compiling gdal myself?
>
> Thanks for the quick and very good answers both of you.
> Yours
> Tomas
>
> Tamas Szekeres skrev:
>
>>
>>
>> 2009/6/30 Tomas R <monshi@home.se <mailto:monshi@home.se>>
>>
>>
>>    Trying to update my plugin to SportTracks that makes it possible
>>    for other plugins to the great program to make use of Gdal.
>>    Currently the plugin uses Gdal 1.5.1 and the plan is to move to 1.6.1
>>
>>    There seem to not be a "soft" way to upgrade as a move to gdal
>>    1.6.1 will break the other plugin. Are the changes between 1.5.1
>>    and 1.6.1 so great they require a break in compatibility?
>>
>>
>> Tomas,
>>
>>
>> I can't recall how the architecture of SportTracks is looking like (how it
>> handles the plugins) and it seems your question is related to this. Assuming
>> it may use something like late binding to the assemblies may result some
>> kind of independence among the plugins and I suspect reinstalling a new
>> version won't violate the other (quite untelated) assemblies. Or will you
>> intend to keep 2 versions side by side to the application?
>>
>>
>>
>>    In  the future, upgrade to Gdal 1.7 will this also not be backward
>>    compatible? Are there anything I can do when compiling Gdal than
>>    may simplify the transition? Say that a plugin linked to the 1.6.1
>>    C# dlls will also work with the 1.5.1 dlls? That way it will
>>    possible to roll out the other plugins with support of Gdal 1.6.1
>>    and some time later go out with the upgrade.
>>
>>
>> I would discourage mixing the dll-s from different compilations due to a
>> bunch of unpredictable issues may happen. Mixing the versions of the dll-s
>> at the swig side (ie gdal_csharp.dll and gdal_wrap.dll) is almost impossible
>> since the exported functions between the dll-s may be a target of frequent
>> changes. The gdal C API seems to be more invariant but the version change
>> implies different dll names which prevents from loading the newer versions.
>> Moreover you should also use the same compiler to compile these dll-s so
>> as to depend in the same CRT runtime.
>>
>> You might also decide which framework is to be supported and which
>> architecture (x86 or x64) depending on how the host process have been
>> compiled. Most of the possible combinations are covered by the regular
>> builds can be downloaded from this location:
>> http://vbkto.dyndns.org:1280/sdk/Default.aspx
>>
>> Best regards,
>>
>> Tamas
>>
>> ------------------------------------------------------------------------
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090701/ceec8a7e/attachment-0001.html
From narmadhapk at gmail.com  Wed Jul  1 06:29:27 2009
From: narmadhapk at gmail.com (NarmadhaK)
Date: Wed Jul  1 06:36:32 2009
Subject: [gdal-dev] including GCP file for gdal_translate
In-Reply-To: <eb502d880906290547p1f2baad3p5386fb70442c7698@mail.gmail.com>
References: <5ca30fb60906290448i6468a815sb7dce6d4480bd0e2@mail.gmail.com>
	<eb502d880906290547p1f2baad3p5386fb70442c7698@mail.gmail.com>
Message-ID: <5ca30fb60907010329i4641f8a9n1f0b8fafbc48e7ff@mail.gmail.com>

Chaitanya,

I am successful in stacking the images to one file.
Thanks for your help.
But still I am unable to input the GCPs from .txt file.
I just did this.
>gdal_translate -of GTiff -gcp --optfile L5142051_05120060207_GCP.txt
merged_landsat.tif merged_landsat_proj.tif

Result was:
Too many command options.

Am I correct with the command or?
Its is very important for me to input all the 90 GCPs.


Narmadha
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090701/a8605856/attachment.html
From chaitanya.ch at gmail.com  Wed Jul  1 11:07:11 2009
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Wed Jul  1 11:13:14 2009
Subject: [gdal-dev] including GCP file for gdal_translate
In-Reply-To: <5ca30fb60907010329i4641f8a9n1f0b8fafbc48e7ff@mail.gmail.com>
References: <5ca30fb60906290448i6468a815sb7dce6d4480bd0e2@mail.gmail.com>
	<eb502d880906290547p1f2baad3p5386fb70442c7698@mail.gmail.com>
	<5ca30fb60907010329i4641f8a9n1f0b8fafbc48e7ff@mail.gmail.com>
Message-ID: <eb502d880907010807y1e6d9e3ah246fb92950d74ccf@mail.gmail.com>

Narmadha,

The file given with the option --optfile should just contain what the
options should be. It is a way to simplify things in case of long commands.
You will want to have the file (named, for example, options.txt) read
something like this...
---------------------------------------------------------------------------------------------------------------------------------------
-of GTiff -gcp 2 1 80.1 17.2 -gcp 98 99 78.3 18.4 merged_landsat.tif
merged_landsat_proj.tif
---------------------------------------------------------------------------------------------------------------------------------------
,all without a newline character. And you type this in the command line...

gdal_translate --optfile options.txt

And please do tell even if you are succesful.

On Wed, Jul 1, 2009 at 3:59 PM, NarmadhaK <narmadhapk@gmail.com> wrote:

> Chaitanya,
>
> I am successful in stacking the images to one file.
> Thanks for your help.
> But still I am unable to input the GCPs from .txt file.
> I just did this.
> >gdal_translate -of GTiff -gcp --optfile L5142051_05120060207_GCP.txt
> merged_landsat.tif merged_landsat_proj.tif
>
> Result was:
> Too many command options.
>
> Am I correct with the command or?
> Its is very important for me to input all the 90 GCPs.
>
>
> Narmadha
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
Chaitanya kumar CH.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090701/889722d4/attachment.html
From giohappy at gmail.com  Wed Jul  1 11:14:05 2009
From: giohappy at gmail.com (G. Allegri)
Date: Wed Jul  1 11:14:08 2009
Subject: [gdal-dev] best practice to evaluate (fast) point in polygon and
	attribute overlay with python and ogr?
Message-ID: <e12429640907010814v5186e5d5p813eb971d45d6e9e@mail.gmail.com>

Hi list.
I needed to make a simple routine to create a regular point grid (as
csv) on the base of an input polygons layer and its attributes.
I've compined the two needs:

 - verify point/polygon containment
 - extract polygon attribute and attach it to the point feature

so I've used the <layer>.SetSpatialFilter(<geometry>) method. When I
need to evaluate some thousends of points the performance gets really
low.
This is the simple algoithm (I've omitted various error checking here):


	def doGrid(self,spacing=10,fout='pointGrid',attr=None):

		spacingm = spacing*1000 # POINTS SPACING IN METERS
		point = ogr.Geometry(ogr.wkbPoint)
		fout = "%s_%skm.txt" % (fout,spacing)
		header = "lat\tlon\tcode"
		rowtpl = "%s\t%s\t%s"
		try:
			f = open(fout,'w')
		except:
			print "Can't open %s" % s
			exit(1)
			
		if attr:
			header += "\tattr_value"
			rowtpl += "\t%s"
		f.write(header+"\n")
		
		plat = self._mlat
		r = 1
		while (plat < self._Mlat): # start from the lower row
			plon = self._mlon
			r += 1
			c = 1
			while (plon < self._Mlon): # start from the leftmost column
				code = "r"+str(r)+"c"+str(c)
				strpars = (plat,plon,code)
				if attr:
					point.AddPoint_2D(plon,plat)   # I use this to add the actual
point to the Point geometry
					self._inlayer.ResetReading()  # reset the layer pointer
					self._inlayer.SetSpatialFilter(point) # do the filtering. It was
a try and it worked: passing a point geometry is ok, I don't need a
box...
					feat = self._inlayer.GetNextFeature()  # I try to get a feature.
If it fails, the point is out of the layer.
					if feat:
						try:
							val = feat.GetField(attr) # I extract the attribute
							strpars += (val,)
							rowstring = (rowtpl % strpars)+"\n"
						except ValueError:
							print "attribute doesn't belong to feature"
					else:
						rowstring = ""
				else:
					rowstring = (rowtpl % strpars)+"\n"

				f.write(rowstring)
				plon += spacingm
				c += 1
			plat += spacingm
		f.flush()
		f.close()
		print "Punti totali: %s" % ((c-1)*(r-1))


thanks for any suggestion,
giovanni
From even.rouault at mines-paris.org  Wed Jul  1 14:40:48 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Jul  1 14:40:58 2009
Subject: [gdal-dev] PackBitsDecode: Not enough data ...
In-Reply-To: <4A4B236B.5030501@gmx.eu>
References: <h2d65t$k1u$1@ger.gmane.org>
	<200906302203.26333.even.rouault@mines-paris.org>
	<4A4B236B.5030501@gmx.eu>
Message-ID: <200907012040.49312.even.rouault@mines-paris.org>

Le Wednesday 01 July 2009 10:50:51 Hermann Peifer, vous avez ?crit?:
> Even Rouault wrote:
> > Does gdalinfo -checksum lceugr100_00_pct_epsg4326.tif works ?
>
> Not really:
> Warning 1: lceugr100_00_pct_epsg4326.tif:PackBitsDecode: discarding 94
> bytes to avoid buffer overrun
> ERROR 1: lceugr100_00_pct_epsg4326.tif:PackBitsDecode: Not enough data
> for scanline 13228
> ERROR 1: TIFFReadEncodedStrip() failed.
>
> ERROR 1: IReadBlock failed at X offset 0, Y offset 13228
> ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 13228
> ERROR 3: Checksum value couldn't be computed due to I/O read error.
>
> > If it doesn't, you might want to try with a recent GDAL (e.g 1.6.1)and
> > internal libtiff support.
>
> OK. I upgraded from version 1.6.0 to 1.6.1. This didn't help. I ran into
> the same error at the same scanline 22054. :-(
>
> I am also not too sure about internal libtiff support, as configure
> tells me:
> LIBTIFF support:           external (BigTIFF=no)

That tells you that you're using libtiff from your system (probably libtiff 
3.8.2). Try again with : ./configure --with-libtiff=internal, make clean, 
make. If it still doesn't work, you should check (with third-party software 
not using libtiff) if your file is not corrupted. If it is not, then it is a 
bug in libtiff.

>
> Some postings on Internet suggest as a workaround: first warping without
> compression, then compressing afterwards via gdal_translate. This worked
> fine for smaller raster data sets, but eventually, I ran into the error
> that the uncompressed (intermediate) destination file would be larger
> than the limit (4GB).

There's no using trying gdalwarp while gdalinfo -checksum gives errors.

Warping with compression should work in general but may lead to larger files 
than necessary. There are several options :

- add -co BIGTIFF=YES to the gdalwarp command line if BigTIFF is an option for 
your use case, to go beyond the 4GB limit

- do what you mention : gdalwarp then gdal_translate. But the gdal_translate 
might also fail if the compressed data is still larger than 4GB (what it 
cannot anticipate because compression rate is not known). As above, 
adding -co BIGTIFF=YES to the gdal_translate command line will enable you to 
produce file >= 4GB. In your case, the output file (uncompressed) is 121261 x 
44229 = 5.3 GB, so you can hope that once compressed it goes beyond 4GB.

- for the sake of completeness : a variant is to use gdalwarp to produce a VRT 
file and then use gdal_translate to produce a TIFF file. The gdalwarp will 
just run in a few milliseconds. The gdal_translate will take more time than a 
gdal_translate from a standard raster file as it will do the reprojection on 
the fly.
	gdal_warp  -t_srs EPSG:4326 -of VRT input.tif output.vrt
	gdal_translate output.vrt output.tif -co COMPRESS=PACKBITS [-co BIGTIFF=YES]

>
> I am basically stuck now.
>
> :-( Hermann
> :
> > Le Tuesday 30 June 2009 16:06:52 Hermann Peifer, vous avez ?crit :
> >> Hi.
> >>
> >> I am trying to warp a GeoTiff from EPSG:3035 to EPSG:4326. After 50%
> >> done, I end up with the following errors:
> >>
> >> $ gdalwarp -t_srs EPSG:4326 lceugr100_00_pct.tif
> >> lceugr100_00_pct_epsg4326.tif -co COMPRESS=PACKBITS
> >>
> >> Copying color table from lceugr100_00_pct.tif to new file.
> >> Creating output file that is 121261P x 44229L.
> >> Processing input file lceugr100_00_pct.tif.
> >>
> >> 0...10...20...30...40...50..ERROR 1:
> >> lceugr100_00_pct_epsg4326.tif:PackBitsDecode: Not enough data for
> >> scanline 22054
> >>
> >> ERROR 1: TIFFReadEncodedStrip() failed.
> >> ERROR 1: IReadBlock failed at X offset 0, Y offset 22054
> >> ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 22054
> >>
> >> Is there any issue with the decoding the PACKBITS compression?
> >>
> >> Hermann
> >>
> >>
> >>
> >> $ gdalinfo lceugr100_00_pct.tif
> >>
> >> Driver: GTiff/GeoTIFF
> >> Files: lceugr100_00_pct.tif
> >>         lceugr100_00_pct.aux
> >> Size is 67000, 58000
> >> Coordinate System is:
> >> PROJCS["ETRS_1989_LAEA_L52_M10",
> >>      GEOGCS["GCS_ETRS_1989",
> >>          DATUM["European_Terrestrial_Reference_System_1989",
> >>              SPHEROID["GRS_1980",6378137.0,298.257222101]],
> >>          PRIMEM["Greenwich",0.0],
> >>          UNIT["Degree",0.0174532925199433]],
> >>      PROJECTION["Lambert_Azimuthal_Equal_Area"],
> >>      PARAMETER["False_Easting",4321000.0],
> >>      PARAMETER["False_Northing",3210000.0],
> >>      PARAMETER["Central_Meridian",10.0],
> >>      PARAMETER["Latitude_Of_Origin",52.0],
> >>      UNIT["Meter",1.0]]
> >> Origin = (800000.000000000000000,6500000.000000000000000)
> >> Pixel Size = (100.000000000000000,-100.000000000000000)
> >> Metadata:
> >>    AREA_OR_POINT=Area
> >> Image Structure Metadata:
> >>    COMPRESSION=PACKBITS
> >>    INTERLEAVE=BAND
> >> Corner Coordinates:
> >> Upper Left  (  800000.000, 6500000.000) ( 72d48'20.05"W, 59d 5'6.85"N)
> >> Lower Left  (  800000.000,  700000.000) ( 24d 7'20.21"W, 22d12'54.64"N)
> >> Upper Right ( 7500000.000, 6500000.000) ( 90d22'56.28"E, 61d55'58.94"N)
> >> Lower Right ( 7500000.000,  700000.000) ( 41d 0'50.13"E, 23d29'5.23"N)
> >> Center      ( 4150000.000, 3600000.000) (  7d17'47.28"E, 55d28'33.08"N)
> >> Band 1 Block=67000x1 Type=Byte, ColorInterp=Palette
> >>    Metadata:
> >>      LAYER_TYPE=thematic
> >>    Color Table (RGB with 256 entries)
> >> ...
> >>
> >> _______________________________________________
> >> gdal-dev mailing list
> >> gdal-dev@lists.osgeo.org
> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From jorge.arevalo at gmail.com  Wed Jul  1 18:11:01 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Wed Jul  1 18:11:24 2009
Subject: [gdal-dev] GDAL WKT Raster driver: Request for comments
Message-ID: <cb4457700907011511x7623f388vddbb6935dd40e00b@mail.gmail.com>

Hello,
I've published an updated version of my project plan for GDAL WKT Raster
driver implementation. I'll strongly appreciate any comment and suggestion.
Please, if you have login access to GDAL trac, feel free to edit the page.

http://trac.osgeo.org/gdal/wiki/WKTRasterDriver

<http://trac.osgeo.org/gdal/wiki/WKTRasterDriver>Many thanks in advance, and
best regards
Jorge
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090702/5e4f1cf3/attachment.html
From huntc at internode.on.net  Thu Jul  2 00:19:09 2009
From: huntc at internode.on.net (Christopher Hunt)
Date: Thu Jul  2 00:24:24 2009
Subject: [gdal-dev] Big three rules for C++ classes
In-Reply-To: <F74E272F-D375-4D83-9E21-5916F1416B12@internode.on.net>
References: <E268F017-2CDB-4968-A908-63280DA3C4A7@internode.on.net>
	<86A4D80B-9ED4-406F-8293-5BE9E7181CAB@internode.on.net>
	<FB1D14A7-39F2-4B39-86C0-E125C7BE543F@internode.on.net>
	<488F501E.3090608@pobox.com>
	<6FD022B3-B5AE-4D1C-9599-2FFA27BB2980@internode.on.net>
	<488FA29F.10501@pobox.com>
	<DB0F35D0-8235-4512-850C-0F6D8063B920@internode.on.net>
	<27F957A3-702E-4B78-808F-3BAF0AD3246F@internode.on.net>
	<48931775.9010601@pobox.com>
	<507C81FF-9130-4389-904E-5FC32FA36E81@internode.on.net>
	<931f8ea90808152105j56604d67wcdde647ed24b901c@mail.gmail.com>
	<F74E272F-D375-4D83-9E21-5916F1416B12@internode.on.net>
Message-ID: <489BE964-F2CB-4414-9B11-0C875E8C4839@internode.on.net>

Hi there,

I've just started using the classes from the ogr_geometry API and note  
that they do not obey the C++ Rule of Three:

http://en.wikipedia.org/wiki/Rule_of_three_(C%2B%2B_programming)

Perhaps the copy ctor and assignment operators should receive a  
private scope in OGRGeometry unless they are implemented of course.

Kind regards,
Christopher
From sukesh.laghate at gmail.com  Thu Jul  2 03:02:48 2009
From: sukesh.laghate at gmail.com (sukesh laghate)
Date: Thu Jul  2 03:02:50 2009
Subject: [gdal-dev] query on OGR and Database
Message-ID: <f9a3b6900907020002t5bece2cqcd7ca0714b40d767@mail.gmail.com>

Hello,

I am new to OGR/GDAL and have gone through the tutorial listed in the help.
However I could not find example of programeticaly connecting to Database. I
would appreciate if you could provide pointers/examples on how to do so. I
am using Oracle 10g spatial and MySQL databases.

With regards
Sukesh.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090702/288459eb/attachment.html
From belaid_moa at hotmail.com  Thu Jul  2 03:43:00 2009
From: belaid_moa at hotmail.com (Belaid MOA)
Date: Thu Jul  2 03:43:04 2009
Subject: [gdal-dev] moving averaging filter in GDAL.
In-Reply-To: <COL113-W409C2599EBCF5E72F0060AF43A0@phx.gbl>
References: <COL113-W44FA3154200BAA527C946AF43A0@phx.gbl>
	<4A3BC995.6010807@pobox.com>
	<COL113-W55CEE0316231DF928C7B53F43A0@phx.gbl>
	<200906191944.11542.even.rouault@mines-paris.org> 
	<COL113-W409C2599EBCF5E72F0060AF43A0@phx.gbl>
Message-ID: <COL113-W1845229A39AEEDB49AB0FDF42F0@phx.gbl>


Hi,
 As suggested by Frank and Even, I implemented a simple C++ version of gdalfilter.py (based on VRT driver) using the function below. Unfortunately, I keep getting the same data set as the source; no filtering is done at all! The destination file produced have the same content as the source file. Am I doing something wrong? Any help on this is very appreciated. I tried both gdal-1.4.1 and gdal-1.6.1 but no success.

================================================================
/**
* Apply an averaging filter to a GDALDataset
* sFileName: source file name
* dstFileName: destination file name
* size: size of the filter (kernal)
* coefficients: the coefficients of the filter.
**/
int average(char* sFileName, char* dstFileName, int size, const char* coefficients) {
  GDALDriver *poDriver = (GDALDriver *) GDALGetDriverByName( "VRT" );
  if (poDriver ==  NULL) {
      cout <<"VRT Driver not found!"<<endl;
      return -1;
  }
  GDALDataset *poVRTDS, *poSrcDS;
  poSrcDS = (GDALDataset *) GDALOpen( sFileName, GA_ReadOnly);
  poVRTDS = poDriver->CreateCopy( "", poSrcDS, FALSE, NULL, NULL, NULL );
  int   nBand;
  for( nBand = 1; nBand <= poVRTDS->GetRasterCount(); nBand++ ) {
      GDALRasterBand *poBand = poVRTDS->GetRasterBand( nBand );
      char szFilterSourceXML[10000];
      sprintf( szFilterSourceXML,
        "<KernelFilteredSource>"
        "  <SourceFilename>%s</SourceFilename><SourceBand>%d</SourceBand>"
        "  <Kernel>"
        "    <Size>%d</Size>"
        "    <Coefs>%s</Coefs>"
        "  </Kernel>"
        "</KernelFilteredSource>",
        sFileName,nBand,size,coefficients);
      cout << szFilterSourceXML <<endl;
      poBand->SetMetadataItem( "source_0", szFilterSourceXML, "vrt_sources" );
      //poBand->FlushCache();
  }
  GDALDriver *poTIFFDriver = (GDALDriver *) GDALGetDriverByName( "GTiff" );
   if (poTIFFDriver ==  NULL) {
      cout <<"GTIFF Driver not found!"<<endl;
      return -1;
  }
  GDALDataset *poTiffDS;
  poTiffDS = poTIFFDriver->CreateCopy( dstFileName, poVRTDS, FALSE, NULL, NULL, NULL );
  poVRTDS->GetRasterBand( 1 )->FlushCache();

  GDALClose(poSrcDS);
  GDALClose(poTiffDS);
  GDALClose(poVRTDS);
  return 1;
}
===========================================================================
With best regards.
Belaid Moa.

From: belaid_moa@hotmail.com
To: gdal-dev@lists.osgeo.org
Subject: RE: [gdal-dev] moving filter averaging in GDAL.
Date: Fri, 19 Jun 2009 17:50:02 +0000








Thank you very much Even. I was just making sure I am not reinventing the wheel :).
I will then write the C++ version.

With best regards.
~Belaid...

> From: even.rouault@mines-paris.org
> To: gdal-dev@lists.osgeo.org
> Subject: Re: [gdal-dev] moving filter averaging in GDAL.
> Date: Fri, 19 Jun 2009 19:44:10 +0200
> CC: belaid_moa@hotmail.com
> 
> It should be relatively straighforward to transpose from Python to C++, as 
> Python API is mostly deduced from the original C++ one. Look at the 
> documentation of the C++ API on gdal.org
> 
> Le Friday 19 June 2009 19:27:40 Belaid MOA, vous avez ?crit :
> > Thanks a lot Frank. Is there any C/C++ version for that? I am doing the
> > averaging filter from C++ code.
> >
> > With best regards.
> > Belaid Moa.
> >
> > > Date: Fri, 19 Jun 2009 13:23:33 -0400
> > > From: warmerdam@pobox.com
> > > To: belaid_moa@hotmail.com
> > > CC: gdal-dev@lists.osgeo.org
> > > Subject: Re: [gdal-dev] moving filter averaging in GDAL.
> > >
> > > Belaid MOA wrote:
> > > > Hi,
> > > >  Does GDAL have functions for applying an averaging filter of window,
> > > > say 11x11, to an image? This is something that comes up all the time in
> > > > image analysis. So, I suppose GDAL has built-in functions for that.
> > > >
> > > >  Any help on this is very appreciated.
> > >
> > > Belaid,
> > >
> > > There is support for filtering, including average filtering, with the
> > > gdalfilter.py command in gdal/swig/python/samples.  It accomplished
> > > by creating a virtual file using the <KernelFilteredSource> directive -
> > > so ultimately the work is done by the VRT driver.
> > >
> > > Best regards,
> > > --
> > > ---------------------------------------+---------------------------------
> > >----- I set the clouds in motion - turn up   | Frank Warmerdam,
> > > warmerdam@pobox.com light and sound - activate the windows |
> > > http://pobox.com/~warmerdam and watch the world go round - Rush    |
> > > Geospatial Programmer for Rent
> >
> > _________________________________________________________________
> > We are your photos. Share us now with Windows Live Photos.
> > http://go.microsoft.com/?linkid=9666047
> 
> 

Attention all humans. We are your photos.  Free us.
_________________________________________________________________
We are your photos. Share us now with Windows Live Photos.
http://go.microsoft.com/?linkid=9666047
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090702/d1736f16/attachment-0001.html
From narmadhapk at gmail.com  Thu Jul  2 04:29:54 2009
From: narmadhapk at gmail.com (NarmadhaK)
Date: Thu Jul  2 04:29:58 2009
Subject: [gdal-dev] including GCP file for gdal_translate
In-Reply-To: <eb502d880907010807y1e6d9e3ah246fb92950d74ccf@mail.gmail.com>
References: <5ca30fb60906290448i6468a815sb7dce6d4480bd0e2@mail.gmail.com>
	<eb502d880906290547p1f2baad3p5386fb70442c7698@mail.gmail.com>
	<5ca30fb60907010329i4641f8a9n1f0b8fafbc48e7ff@mail.gmail.com>
	<eb502d880907010807y1e6d9e3ah246fb92950d74ccf@mail.gmail.com>
Message-ID: <5ca30fb60907020129k4cb0299dn8b491dfc52ac9e3d@mail.gmail.com>

Thanks a lot Chaitanya.
It worked well for me.
I gave got what I needed finally

Narmadha
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090702/548080f0/attachment.html
From giohappy at gmail.com  Thu Jul  2 04:56:47 2009
From: giohappy at gmail.com (G. Allegri)
Date: Thu Jul  2 05:04:20 2009
Subject: [gdal-dev] Re: best practice to evaluate (fast) point in polygon
	and attribute overlay with python and ogr?
In-Reply-To: <e12429640907010814v5186e5d5p813eb971d45d6e9e@mail.gmail.com>
References: <e12429640907010814v5186e5d5p813eb971d45d6e9e@mail.gmail.com>
Message-ID: <e12429640907020156h3e7e4e27gb0b53370123dbb42@mail.gmail.com>

Here I am, back to office ;-)
I've had support by IRC people. As I supposed there aren't obvious
improvements to the routine code. The only, real, boost is given by
using a spatial index.
My polygonal layer is a shapefile, so I've created a quadtree index
using the shptree mapserver utility, which produces a .qix index file
that OGR can use to gain performance in spatial operations like mine.
More informations (with the fresh add of the shptree option) can be
found at the shapefile format page of gdal:
http://www.gdal.org/ogr/drv_shapefile.html

thanks to christopher schmidt, hobu and the others on IRC.

Have a good day!
giovanni

2009/7/1 G. Allegri <giohappy@gmail.com>:
> Hi list.
> I needed to make a simple routine to create a regular point grid (as
> csv) on the base of an input polygons layer and its attributes.
> I've compined the two needs:
>
> ?- verify point/polygon containment
> ?- extract polygon attribute and attach it to the point feature
>
> so I've used the <layer>.SetSpatialFilter(<geometry>) method. When I
> need to evaluate some thousends of points the performance gets really
> low.
> This is the simple algoithm (I've omitted various error checking here):
>
>
> ? ? ? ?def doGrid(self,spacing=10,fout='pointGrid',attr=None):
>
> ? ? ? ? ? ? ? ?spacingm = spacing*1000 # POINTS SPACING IN METERS
> ? ? ? ? ? ? ? ?point = ogr.Geometry(ogr.wkbPoint)
> ? ? ? ? ? ? ? ?fout = "%s_%skm.txt" % (fout,spacing)
> ? ? ? ? ? ? ? ?header = "lat\tlon\tcode"
> ? ? ? ? ? ? ? ?rowtpl = "%s\t%s\t%s"
> ? ? ? ? ? ? ? ?try:
> ? ? ? ? ? ? ? ? ? ? ? ?f = open(fout,'w')
> ? ? ? ? ? ? ? ?except:
> ? ? ? ? ? ? ? ? ? ? ? ?print "Can't open %s" % s
> ? ? ? ? ? ? ? ? ? ? ? ?exit(1)
>
> ? ? ? ? ? ? ? ?if attr:
> ? ? ? ? ? ? ? ? ? ? ? ?header += "\tattr_value"
> ? ? ? ? ? ? ? ? ? ? ? ?rowtpl += "\t%s"
> ? ? ? ? ? ? ? ?f.write(header+"\n")
>
> ? ? ? ? ? ? ? ?plat = self._mlat
> ? ? ? ? ? ? ? ?r = 1
> ? ? ? ? ? ? ? ?while (plat < self._Mlat): # start from the lower row
> ? ? ? ? ? ? ? ? ? ? ? ?plon = self._mlon
> ? ? ? ? ? ? ? ? ? ? ? ?r += 1
> ? ? ? ? ? ? ? ? ? ? ? ?c = 1
> ? ? ? ? ? ? ? ? ? ? ? ?while (plon < self._Mlon): # start from the leftmost column
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?code = "r"+str(r)+"c"+str(c)
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?strpars = (plat,plon,code)
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?if attr:
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?point.AddPoint_2D(plon,plat) ? # I use this to add the actual
> point to the Point geometry
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?self._inlayer.ResetReading() ?# reset the layer pointer
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?self._inlayer.SetSpatialFilter(point) # do the filtering. It was
> a try and it worked: passing a point geometry is ok, I don't need a
> box...
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?feat = self._inlayer.GetNextFeature() ?# I try to get a feature.
> If it fails, the point is out of the layer.
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?if feat:
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?try:
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?val = feat.GetField(attr) # I extract the attribute
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?strpars += (val,)
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?rowstring = (rowtpl % strpars)+"\n"
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?except ValueError:
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?print "attribute doesn't belong to feature"
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?else:
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?rowstring = ""
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?else:
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?rowstring = (rowtpl % strpars)+"\n"
>
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?f.write(rowstring)
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?plon += spacingm
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?c += 1
> ? ? ? ? ? ? ? ? ? ? ? ?plat += spacingm
> ? ? ? ? ? ? ? ?f.flush()
> ? ? ? ? ? ? ? ?f.close()
> ? ? ? ? ? ? ? ?print "Punti totali: %s" % ((c-1)*(r-1))
>
>
> thanks for any suggestion,
> giovanni
>
From peifer at gmx.eu  Thu Jul  2 11:27:11 2009
From: peifer at gmx.eu (Hermann Peifer)
Date: Thu Jul  2 11:27:14 2009
Subject: [gdal-dev] Re: PackBitsDecode: Not enough data ...
In-Reply-To: <200907012040.49312.even.rouault@mines-paris.org>
References: <h2d65t$k1u$1@ger.gmane.org>	<200906302203.26333.even.rouault@mines-paris.org>	<4A4B236B.5030501@gmx.eu>
	<200907012040.49312.even.rouault@mines-paris.org>
Message-ID: <4A4CD1CF.8070606@gmx.eu>

Even Rouault wrote:
> Le Wednesday 01 July 2009 10:50:51 Hermann Peifer, vous avez ?crit :
>> Even Rouault wrote:
>>> Does gdalinfo -checksum lceugr100_00_pct_epsg4326.tif works ?
>> Not really:
>> Warning 1: lceugr100_00_pct_epsg4326.tif:PackBitsDecode: discarding 94
>> bytes to avoid buffer overrun
>> ERROR 1: lceugr100_00_pct_epsg4326.tif:PackBitsDecode: Not enough data
>> for scanline 13228
>> ERROR 1: TIFFReadEncodedStrip() failed.
>>
>> ERROR 1: IReadBlock failed at X offset 0, Y offset 13228
>> ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 13228
>> ERROR 3: Checksum value couldn't be computed due to I/O read error.
>>
>>> If it doesn't, you might want to try with a recent GDAL (e.g 1.6.1)and
>>> internal libtiff support.
>> OK. I upgraded from version 1.6.0 to 1.6.1. This didn't help. I ran into
>> the same error at the same scanline 22054. :-(
>>
>> I am also not too sure about internal libtiff support, as configure
>> tells me:
>> LIBTIFF support:           external (BigTIFF=no)
> 
> That tells you that you're using libtiff from your system (probably libtiff 
> 3.8.2). Try again with : ./configure --with-libtiff=internal, make clean, 
> make. If it still doesn't work, you should check (with third-party software 
> not using libtiff) if your file is not corrupted. If it is not, then it is a 
> bug in libtiff.
> 

./configure --with-libtiff=internal did the trick. I ended up with:
LIBTIFF support:           internal (BigTIFF=yes)

... and was able to warp the input file directly into a compressed 
output file. No gdalwarp > gdal_translate sequence needed.

Thanks for all hints, Hermann

From maplabs at light42.com  Thu Jul  2 14:23:13 2009
From: maplabs at light42.com (Brian Hamlin)
Date: Thu Jul  2 13:27:16 2009
Subject: [gdal-dev] query on OGR and Database
In-Reply-To: <f9a3b6900907020002t5bece2cqcd7ca0714b40d767@mail.gmail.com>
References: <f9a3b6900907020002t5bece2cqcd7ca0714b40d767@mail.gmail.com>
Message-ID: <674E8E8F-6735-11DE-B3E9-0003936901F0@light42.com>

Sukesh-

   there are several options for connecting to databases in OGR.
Many of these are illustrated in a set of python test scripts. You can 
browse those test scripts via

http://trac.osgeo.org/gdal/browser/trunk/autotest

   best regards
     -Brian

==
OSGeo California Chapter


On Jul 2, 2009, at 12:02 AM, sukesh laghate wrote:

> Hello,
>
> I am new to OGR/GDAL and have gone through the tutorial listed in the 
> help. However I could not find example of programeticaly connecting to 
> Database. I would appreciate if you could provide pointers/examples on 
> how to do so. I am using Oracle 10g spatial and MySQL databases.
>
> With regards
> Sukesh.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at mines-paris.org  Thu Jul  2 14:20:09 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu Jul  2 14:20:20 2009
Subject: [gdal-dev] moving averaging filter in GDAL.
In-Reply-To: <COL113-W1845229A39AEEDB49AB0FDF42F0@phx.gbl>
References: <COL113-W44FA3154200BAA527C946AF43A0@phx.gbl>
	<COL113-W409C2599EBCF5E72F0060AF43A0@phx.gbl>
	<COL113-W1845229A39AEEDB49AB0FDF42F0@phx.gbl>
Message-ID: <200907022020.10614.even.rouault@mines-paris.org>

Belaid Moa,

Good point! Yes it should work as your code is directly derived from the VRT 
tutorial. I discovered that in fact support for SetMetadataItem( "source_0", 
szFilterSourceXML, "vrt_sources" ) was missing in the VRT driver. I've fixed 
that as ticket #3052.

In the meantime you've an easy workaround by using SetMetadata() instead of 
SetMetadataItem(). Here's the modified code snippet :

/**
* Apply an averaging filter to a GDALDataset
* sFileName: source file name
* dstFileName: destination file name
* size: size of the filter (kernal)
* coefficients: the coefficients of the filter.
**/
int average(char* sFileName, char* dstFileName, int size, const char* 
coefficients) {
? GDALDriver *poDriver = (GDALDriver *) GDALGetDriverByName( "VRT" );
? if (poDriver == ?NULL) {
? ? ? cout <<"VRT Driver not found!"<<endl;
? ? ? return -1;
? }
? GDALDataset *poVRTDS, *poSrcDS;
? poSrcDS = (GDALDataset *) GDALOpen( sFileName, GA_ReadOnly);
? poVRTDS = poDriver->CreateCopy( "", poSrcDS, FALSE, NULL, NULL, NULL );
? int ? nBand;
? for( nBand = 1; nBand <= poVRTDS->GetRasterCount(); nBand++ ) {
? ? ? GDALRasterBand *poBand = poVRTDS->GetRasterBand( nBand );
? ? ? char szFilterSourceXML[10000];
/* note the addition of source_0= */
? ? ? sprintf( szFilterSourceXML,
? ? ? ? "source_0=<KernelFilteredSource>" 
? ? ? ? " ?<SourceFilename>%s</SourceFilename><SourceBand>%d</SourceBand>"
? ? ? ? " ?<Kernel>"
? ? ? ? " ? ?<Size>%d</Size>"
? ? ? ? " ? ?<Coefs>%s</Coefs>"
? ? ? ? " ?</Kernel>"
? ? ? ? "</KernelFilteredSource>",
? ? ? ? sFileName,nBand,size,coefficients);
? ? ? cout << szFilterSourceXML <<endl;
? ? ? char* papszMetadata[2] = { (char*)szFilterSourceXML, NULL };
      poBand->SetMetadata( papszMetadata, "vrt_sources" );
? ? ? //poBand->FlushCache();
? }
? GDALDriver *poTIFFDriver = (GDALDriver *) GDALGetDriverByName( "GTiff" );
? ?if (poTIFFDriver == ?NULL) {
? ? ? cout <<"GTIFF Driver not found!"<<endl;
? ? ? return -1;
? }
? GDALDataset *poTiffDS;
? poTiffDS = poTIFFDriver->CreateCopy( dstFileName, poVRTDS, FALSE, NULL, 
NULL, NULL );
? poVRTDS->GetRasterBand( 1 )->FlushCache();

? GDALClose(poSrcDS);
? GDALClose(poTiffDS);
? GDALClose(poVRTDS);
? return 1;
}

Best regards,

Even
From bx_eternal at hotmail.com  Thu Jul  2 14:54:40 2009
From: bx_eternal at hotmail.com (Reflect Thirteen)
Date: Thu Jul  2 14:55:42 2009
Subject: [gdal-dev] gdal2tiles on exported arcgis geotiff
Message-ID: <SNT120-W28F6D2B9F703292FE7F634EF2F0@phx.gbl>


I have a geotiff (exported from arcgis) which has this medata (output from gdalinfo):

Driver: GTiff/GeoTIFF
Files: BasinOverlay.tif
Size is 15488, 9788
Coordinate System is:
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.2572235630016,
            AUTHORITY["EPSG","7030"]],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0],
    UNIT["degree",0.0174532925199433],
    AUTHORITY["EPSG","4326"]]
Origin = (-0.001782845184388,0.001173508094395)
Pixel Size = (0.000000224060325,-0.000000224056112)
Metadata:
  AREA_OR_POINT=Area
  TIFFTAG_XRESOLUTION=1200
  TIFFTAG_YRESOLUTION=1200
  TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
Image Structure Metadata:
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (  -0.0017828,   0.0011735) (  0d 0'6.42"W,  0d 0'4.22"N)
Lower Left  (  -0.0017828,  -0.0010196) (  0d 0'6.42"W,  0d 0'3.67"S)
Upper Right (   0.0016874,   0.0011735) (  0d 0'6.07"E,  0d 0'4.22"N)
Lower Right (   0.0016874,  -0.0010196) (  0d 0'6.07"E,  0d 0'3.67"S)
Center      (  -0.0000477,   0.0000770) (  0d 0'0.17"W,  0d 0'0.28"N)

I tried running gdal_translate to change the "Origin" (and reduce the size) and then ran gdal2tiles.py on the resulting geotif but the resulting tiles do not line up correctly. What is the best way to handle this sort of file? Does anyone familiar with arcgis know the best way to export a geotiff so that it is easier to process using gdal2tiles? Below are the commands I ran:

gdal_translate -a_ullr -180 90 180 -90 -outsize 25% 25% BasinOverlay.tif b14.tif

python gdal2tiles.py -z "5" -t "Basing Overlay" -w google -n  b14.tif
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090702/ba94cd81/attachment.html
From belaid_moa at hotmail.com  Thu Jul  2 15:14:58 2009
From: belaid_moa at hotmail.com (Belaid MOA)
Date: Thu Jul  2 15:15:00 2009
Subject: [gdal-dev] moving averaging filter in GDAL.
In-Reply-To: <200907022020.10614.even.rouault@mines-paris.org>
References: <COL113-W44FA3154200BAA527C946AF43A0@phx.gbl>
	<COL113-W409C2599EBCF5E72F0060AF43A0@phx.gbl>
	<COL113-W1845229A39AEEDB49AB0FDF42F0@phx.gbl>
	<200907022020.10614.even.rouault@mines-paris.org>
Message-ID: <COL113-W50FEC4AFF3AB6E969E4612F42F0@phx.gbl>


Even, you really made my day today!!! Thanks a lot for spotting that out. I spent almost one day staring at my code in vain!   
BTW, in the GDAL VRT tutorial (http://www.gdal.org/gdal_vrttut.html), I noticed that there is an extra character (1)
in the XML description of KernalFilterSource as in: 
"  <SourceFilename>utm.tif</SourceFilename>1<SourceBand>1</SourceBand>"

I think that character (i.e. 1) should not be there, otherwise the XML is not well-formed.

Again, thank you Even for your help.

With best regards.
Belaid Moa.

  
With best regards.
~Belaid...
> From: even.rouault@mines-paris.org
> To: gdal-dev@lists.osgeo.org
> Subject: Re: [gdal-dev] moving averaging filter in GDAL.
> Date: Thu, 2 Jul 2009 20:20:09 +0200
> CC: belaid_moa@hotmail.com
> 
> Belaid Moa,
> 
> Good point! Yes it should work as your code is directly derived from the VRT 
> tutorial. I discovered that in fact support for SetMetadataItem( "source_0", 
> szFilterSourceXML, "vrt_sources" ) was missing in the VRT driver. I've fixed 
> that as ticket #3052.
> 
> In the meantime you've an easy workaround by using SetMetadata() instead of 
> SetMetadataItem(). Here's the modified code snippet :
> 
> /**
> * Apply an averaging filter to a GDALDataset
> * sFileName: source file name
> * dstFileName: destination file name
> * size: size of the filter (kernal)
> * coefficients: the coefficients of the filter.
> **/
> int average(char* sFileName, char* dstFileName, int size, const char* 
> coefficients) {
>   GDALDriver *poDriver = (GDALDriver *) GDALGetDriverByName( "VRT" );
>   if (poDriver ==  NULL) {
>       cout <<"VRT Driver not found!"<<endl;
>       return -1;
>   }
>   GDALDataset *poVRTDS, *poSrcDS;
>   poSrcDS = (GDALDataset *) GDALOpen( sFileName, GA_ReadOnly);
>   poVRTDS = poDriver->CreateCopy( "", poSrcDS, FALSE, NULL, NULL, NULL );
>   int   nBand;
>   for( nBand = 1; nBand <= poVRTDS->GetRasterCount(); nBand++ ) {
>       GDALRasterBand *poBand = poVRTDS->GetRasterBand( nBand );
>       char szFilterSourceXML[10000];
> /* note the addition of source_0= */
>       sprintf( szFilterSourceXML,
>         "source_0=<KernelFilteredSource>" 
>         "  <SourceFilename>%s</SourceFilename><SourceBand>%d</SourceBand>"
>         "  <Kernel>"
>         "    <Size>%d</Size>"
>         "    <Coefs>%s</Coefs>"
>         "  </Kernel>"
>         "</KernelFilteredSource>",
>         sFileName,nBand,size,coefficients);
>       cout << szFilterSourceXML <<endl;
>       char* papszMetadata[2] = { (char*)szFilterSourceXML, NULL };
>       poBand->SetMetadata( papszMetadata, "vrt_sources" );
>       //poBand->FlushCache();
>   }
>   GDALDriver *poTIFFDriver = (GDALDriver *) GDALGetDriverByName( "GTiff" );
>    if (poTIFFDriver ==  NULL) {
>       cout <<"GTIFF Driver not found!"<<endl;
>       return -1;
>   }
>   GDALDataset *poTiffDS;
>   poTiffDS = poTIFFDriver->CreateCopy( dstFileName, poVRTDS, FALSE, NULL, 
> NULL, NULL );
>   poVRTDS->GetRasterBand( 1 )->FlushCache();
> 
>   GDALClose(poSrcDS);
>   GDALClose(poTiffDS);
>   GDALClose(poVRTDS);
>   return 1;
> }
> 
> Best regards,
> 
> Even

_________________________________________________________________
We are your photos. Share us now with Windows Live Photos.
http://go.microsoft.com/?linkid=9666047
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090702/50a391f6/attachment.html
From even.rouault at mines-paris.org  Thu Jul  2 15:33:32 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu Jul  2 15:33:41 2009
Subject: [gdal-dev] moving averaging filter in GDAL.
In-Reply-To: <COL113-W50FEC4AFF3AB6E969E4612F42F0@phx.gbl>
References: <COL113-W44FA3154200BAA527C946AF43A0@phx.gbl>
	<200907022020.10614.even.rouault@mines-paris.org>
	<COL113-W50FEC4AFF3AB6E969E4612F42F0@phx.gbl>
Message-ID: <200907022133.32749.even.rouault@mines-paris.org>

Le Thursday 02 July 2009 21:14:58 Belaid MOA, vous avez ?crit?:
> Even, you really made my day today!!! Thanks a lot for spotting that out. I 
> spent almost one day staring at my code in vain! ? 
> BTW, in the GDAL VRT tutorial (http://www.gdal.org/gdal_vrttut.html), I
> noticed that there is an extra character (1) 
> in the XML description of KernalFilterSource as in: 
> " ?<SourceFilename>utm.tif</SourceFilename>1<SourceBand>1</SourceBand>"
> 
> I think that character (i.e. 1) should not be there, otherwise the XML is
> not well-formed. 

Yes, you're right. I've fixed that too. Thanks.

> 
> Again, thank you Even for your help.
> 
> With best regards.
> Belaid Moa.


From Shawn.Gong at drdc-rddc.gc.ca  Thu Jul  2 15:48:54 2009
From: Shawn.Gong at drdc-rddc.gc.ca (Gong, Shawn (Contractor))
Date: Thu Jul  2 15:49:02 2009
Subject: [gdal-dev] NITF Jpeg 2000 read support
Message-ID: <DF1471B5C308B346BF5A2AEA00C5615E26E9C1@ottawaex02.Ottawa.drdc-rddc.gc.ca>

hi list,

I need to build GDAL with NITF Jpeg 2000 read support on Windows (32
bit) and Linux (32 and/or 64-bit). I need to view the image (using
OpenEV) and extract information. File sizes are large (1 to 2.5 GB).

I did a search on the previous posts and found there are a few options,
JP2KAK, JP2ECW, or JP2MrSID. 

Would you tell me which one is most suitable? 

thanks,
Shawn



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090702/1ec1794b/attachment-0001.html
From huntc at internode.on.net  Fri Jul  3 03:23:18 2009
From: huntc at internode.on.net (Christopher Hunt)
Date: Fri Jul  3 03:23:25 2009
Subject: [gdal-dev] Transform from lat/long/elevation to 3d sphere
Message-ID: <6B1BE935-882E-4688-B0F6-D4338B6B97C5@internode.on.net>

Sorry for the hopefully not so dumb question here.

If I want to transform from one projection to a projection of the  
earth in 3D, how would I set up my target srs?

I want to take a WGS-84 lat/long/elevation and have an x,y,z returned  
in metres.

Here's my present code:

   // Read the image's projection
   OGRSpatialReference projSpatialReference(dataset- 
 >GetProjectionRef());
   scoped_ptr<OGRSpatialReference>  
latLongSpatialReference(projSpatialReference.CloneGeogCS());
   transform =  
OGRCreateCoordinateTransformation(latLongSpatialReference.get(),  
&projSpatialReference);

...and of course that transforms from lat/long/elevation to the  
projection srs nicely. What I'm looking for is a way to specify the  
target srs so that it yields the x, y, z values for WGS84 3d sphere  
i.e. the earth.

Kind regards,
Christopher
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090703/bc158495/attachment.html
From huntc at internode.on.net  Fri Jul  3 05:37:37 2009
From: huntc at internode.on.net (Christopher Hunt)
Date: Fri Jul  3 05:37:39 2009
Subject: [gdal-dev] Transform from lat/long/elevation to 3d sphere
In-Reply-To: <4A4DB6C7.3050405@york.ac.uk>
References: <6B1BE935-882E-4688-B0F6-D4338B6B97C5@internode.on.net>
	<4A4DB6C7.3050405@york.ac.uk>
Message-ID: <38A09EF9-CD99-4387-8B94-E0AD3243035B@internode.on.net>

Hi Peter,

Thanks for your reply - yes, that's exactly what I want to do -  
transform to cartesian coords.

Here's the math that I've already got... I was just wondering if  
GDAL's transform object somehow encapsulated it.

     latitude *= DEG_TO_RAD;
     longitude *= DEG_TO_RAD;

     double sinLatitude = sin(latitude);
     double cosLatitude = cos(latitude);

     double N = wgs84SemiMajorAxis / sqrt(1.0 - sinLatitude *  
sinLatitude * sinAngularEccentricitySq);
     double h = elevation;

     x = (N + h) * cosLatitude * cos(longitude);
     y = (N * cosAngularEccentricitySq + h) * sinLatitude;
     z = (N + h) * cosLatitude * sin(longitude);

Apparently not though given your reply. :-)

Kind regards,
Christopher

On 03/07/2009, at 5:44 PM, Peter J Halls wrote:

> Christopher,
>
>    WGS84 *is* a spherical model.  In any spherical coordinate  
> system, x & y are represented by angles to the centre of the  
> sphere.  No projection equation is going to return you x & y in  
> metres for a sphere: it makes no sense of the maths.  The 'baseline'  
> surface can be obtained from the projection specification - ie the  
> radius or ellipsoid dimensions which, with the angle, enable a  
> surface point to be calculated by simple trigonometry.  Normally,  
> one applies the local datum parameters, in order to resolve the  
> complications of the Earth's irregular surface.  The projection  
> parameters are standard and defined in the GCS table - look in the  
> GDAL/data directory for gcs.csv.
>
>    There is no projection that represents the planet in a solid, 3d  
> space using Cartesian dimensions: it simply does not make sense to  
> attempt.  Maybe it would be useful to look out the 'bible' on map  
> projections - 'Map Projections: a working manual' by the late John P  
> Snyder ... it is available for download from the USGS web site.  The  
> opening chapter of that book explains why and how projections work:  
> I think that may not only help you understand what was wrong with  
> your question but also enable you to see how to achieve your goal.   
> The later chapters give the equations for the various projections.
>
> Best wishes,
>
> Peter
>
> Christopher Hunt wrote:
>> Sorry for the hopefully not so dumb question here.
>> If I want to transform from one projection to a projection of the  
>> earth in 3D, how would I set up my target srs?
>> I want to take a WGS-84 lat/long/elevation and have an x,y,z  
>> returned in metres.
>> Here's my present code:
>>  // Read the image's projection
>>  OGRSpatialReference projSpatialReference(dataset- 
>> >GetProjectionRef());
>>  scoped_ptr<OGRSpatialReference>  
>> latLongSpatialReference(projSpatialReference.CloneGeogCS());
>>  transform =  
>> OGRCreateCoordinateTransformation(latLongSpatialReference.get(),  
>> &projSpatialReference);
>> ...and of course that transforms from lat/long/elevation to the  
>> projection srs nicely. What I'm looking for is a way to specify the  
>> target srs so that it yields the x, y, z values for WGS84 3d sphere  
>> i.e. the earth.
>> Kind regards,
>> Christopher
>> ------------------------------------------------------------------------
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- 
> --------------------------------------------------------------------------------
> Peter J Halls, GIS Advisor, University of York
> Telephone: 01904 433806     Fax: 01904 433740
> Snail mail: Computing Service, University of York, Heslington, York  
> YO10 5DD
> This message has the status of a private and personal communication
> --------------------------------------------------------------------------------

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090703/4446598a/attachment.html
From huntc at internode.on.net  Fri Jul  3 08:25:37 2009
From: huntc at internode.on.net (Christopher Hunt)
Date: Fri Jul  3 08:25:52 2009
Subject: [gdal-dev] Transform from lat/long/elevation to 3d sphere
In-Reply-To: <4A4DF490.9050604@xpam.de>
References: <6B1BE935-882E-4688-B0F6-D4338B6B97C5@internode.on.net>
	<4A4DF490.9050604@xpam.de>
Message-ID: <869AF178-CFAE-4B38-91BA-008D1F1F5568@internode.on.net>

That appears to do exactly what I want. Thanks.

Peter, thoughts?

On 03/07/2009, at 10:07 PM, Adam Nowacki wrote:

> Something like:
> OGRSpatialReference sr;
> sr.SetFromUserInput("+proj=geocent");
From nowak at xpam.de  Fri Jul  3 08:08:40 2009
From: nowak at xpam.de (Adam Nowacki)
Date: Fri Jul  3 08:40:35 2009
Subject: [gdal-dev] Transform from lat/long/elevation to 3d sphere
In-Reply-To: <6B1BE935-882E-4688-B0F6-D4338B6B97C5@internode.on.net>
References: <6B1BE935-882E-4688-B0F6-D4338B6B97C5@internode.on.net>
Message-ID: <4A4DF4C8.80609@xpam.de>

Something like:
OGRSpatialReference sr;
sr.SetFromUserInput("+proj=geocent");

Christopher Hunt wrote:
> Sorry for the hopefully not so dumb question here.
> 
> If I want to transform from one projection to a projection of the earth 
> in 3D, how would I set up my target srs?
> 
> I want to take a WGS-84 lat/long/elevation and have an x,y,z returned in 
> metres.
> 
> Here's my present code:
> 
>   // Read the image's projection
>   OGRSpatialReference projSpatialReference(dataset->GetProjectionRef());
>   scoped_ptr<OGRSpatialReference> 
> latLongSpatialReference(projSpatialReference.CloneGeogCS());
>   transform = 
> OGRCreateCoordinateTransformation(latLongSpatialReference.get(), 
> &projSpatialReference);
> 
> ...and of course that transforms from lat/long/elevation to the 
> projection srs nicely. What I'm looking for is a way to specify the 
> target srs so that it yields the x, y, z values for WGS84 3d sphere i.e. 
> the earth.
From jorge.arevalo at gmail.com  Sat Jul  4 08:00:44 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Sat Jul  4 08:01:07 2009
Subject: [gdal-dev] GDAL WKT Raster driver weekly report #6
Message-ID: <cb4457700907040500y5cf2282cn263297cd3655eb2f@mail.gmail.com>

Hello,

My weekly report:
http://www.gis4free.org/blog/2009/07/04/gsoc-09-weekly-report-6-2606-0307/

As usual, the project page: http://trac.osgeo.org/gdal/wiki/WKTRasterDriver

Best regards
Jorge
<http://www.brainyquote.com/quotes/authors/c/calvin_trillin.html>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090704/856248c0/attachment.html
From jorge.arevalo at gmail.com  Sat Jul  4 15:32:33 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Sat Jul  4 15:32:56 2009
Subject: [gdal-dev] Question about GDALDriverManager + gdal2wktraster
Message-ID: <cb4457700907041232v62da7945nd74dd03a7297746f@mail.gmail.com>

Hello,

I have two versions of GDAL in my machine:

- GDAL 1.7.0 from SVN
- GDAL 1.7.0 with the WKT Raster driver I'm developing

Today, I've updated the wktraster code from svn. I have the revision 4256.
The last one. With this revision, there is a new version of gdal2wktraster
script.

I loaded this image
ftp://ftp.remotesensing.org/geotiff/samples/gdal_eg/cea.tif with and old
version of gdal2wktraster, that allowed GDAL to select the block size for
the tiles. Then, I could load the image with default tiles of 514x15, 35
tiles.

But with the new version of the script, I have to specify the block size by
hand. For example, 514x15 (or 100x100). When I try this:

gdal2wktraster.py -r cea.tif -t table_name -s 4267 -b 1 -k 514x15 -I -M -o
output.sql -v

I get this error:

ERROR 7: Assertion `FALSE' failed
in file `gdaldrivermanager.cpp', line 309

Reviewing the code, I saw that the last script's instruction called is:

pixels = band.ReadAsArray(xoff, yoff, valid_read_block_size[0],
valid_read_block_size[1],
                                  target_block_size[0],
target_block_size[1])

That, somehow, should call the method "GDALDriverManager::RegisterDriver(
GDALDriver * poDriver )" from gdalmanager.cpp. The code of the method is
this:

int GDALDriverManager::RegisterDriver( GDALDriver * poDriver )
{
    CPLMutexHolderD( &hDMMutex );

/* -------------------------------------------------------------------- */
/*      If it is already registered, just return the existing           */
/*      index.                                                          */
/* -------------------------------------------------------------------- */
    if( GetDriverByName( poDriver->GetDescription() ) != NULL )
    {
        int             i;

        for( i = 0; i < nDrivers; i++ )
        {
            if( papoDrivers[i] == poDriver )
            {
                return i;
            }
        }

        CPLAssert( FALSE ); // -------> THE LINE THAT CAUSES THE CRASH
*******************************************
    }

/* -------------------------------------------------------------------- */
/*      Otherwise grow the list to hold the new entry.                  */
/* -------------------------------------------------------------------- */
    papoDrivers = (GDALDriver **)
        VSIRealloc(papoDrivers, sizeof(GDALDriver *) * (nDrivers+1));

    papoDrivers[nDrivers] = poDriver;
    nDrivers++;

    if( poDriver->pfnCreate != NULL )
        poDriver->SetMetadataItem( GDAL_DCAP_CREATE, "YES" );

    if( poDriver->pfnCreateCopy != NULL )
        poDriver->SetMetadataItem( GDAL_DCAP_CREATECOPY, "YES" );

    int iResult = nDrivers - 1;

    return iResult;
}

So, basically, with the base 1.7.0 version of GDAL, I can load the TIFF
file. With my version, crash in the previous method. Clearly, it's my
driver's problem, but I don't know why. I have a test code to create a
dataset using my driver and works... Why could the application crash when
trying to list the registered drivers while loading a TIFF file? I have the
TIFF driver loaded in my GDAL version.

Thanks in advance,

Best regards
Jorge

Paula Poundstone<http://www.brainyquote.com/quotes/authors/p/paula_poundstone.html>
- "I don't have a bank account because I don't know my mother's maiden
name."
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090704/575f5daa/attachment.html
From jorge.arevalo at gmail.com  Sun Jul  5 05:16:35 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Sun Jul  5 05:16:58 2009
Subject: [gdal-dev] GDAL site down?
Message-ID: <cb4457700907050216x988bab1pc6dcdaa273aefc27@mail.gmail.com>

Hello,

GDAL site (http://www.gdal.org) seems to be down, doesn't it?

Regards
Jorge
 <http://www.brainyquote.com/quotes/authors/p/paula_poundstone.html>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090705/b4376184/attachment.html
From jluis at ualg.pt  Sun Jul  5 12:20:31 2009
From: jluis at ualg.pt (jluis@ualg.pt)
Date: Sun Jul  5 12:20:35 2009
Subject: [gdal-dev] Build failure on Mac X
Message-ID: <20090705182031.81335s58y5tj40kc@wmail.ualg.pt>

Hi,

I do this very rarely but it had worked before. However, today's  
attempt to build trunk on OSX is failing at the end with

....
b/libNCSUtil.dylib -lmfhdf -ldf /usr/local/lib/libsz.dylib  
/usr/local/lib/libnetcdf.a -ldl -lcurl -lssl -lcrypto -lz               
   -install_name  /usr/local/lib/libgdal.1.dylib  
-Wl,-compatibility_version -Wl,15 -Wl,-current_version -Wl,15.0
Undefined symbols:
   "OGRGeometry::dumpReadable(__sFILE*, char const*) const", referenced from:
       vtable for OGRMultiPointin ogrmultipoint.o
       vtable for OGRMultiLineStringin ogrmultilinestring.o
ld: symbol(s) not found
collect2: ld returned 1 exit status
make[1]: *** [libgdal.la] Error 1
make: *** [check-lib] Error 2

Joaquim Luis


----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.


From even.rouault at mines-paris.org  Sun Jul  5 13:25:57 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sun Jul  5 13:26:07 2009
Subject: [gdal-dev] Build failure on Mac X
In-Reply-To: <20090705182031.81335s58y5tj40kc@wmail.ualg.pt>
References: <20090705182031.81335s58y5tj40kc@wmail.ualg.pt>
Message-ID: <200907051925.58695.even.rouault@mines-paris.org>

Did you happen to 'svn update' and just 'make' ? If that's the case, you 
should do a 'make clean' before trying 'make' again

Le Sunday 05 July 2009 18:20:31 jluis@ualg.pt, vous avez ?crit?:
> Hi,
>
> I do this very rarely but it had worked before. However, today's
> attempt to build trunk on OSX is failing at the end with
>
> ....
> b/libNCSUtil.dylib -lmfhdf -ldf /usr/local/lib/libsz.dylib
> /usr/local/lib/libnetcdf.a -ldl -lcurl -lssl -lcrypto -lz
>    -install_name  /usr/local/lib/libgdal.1.dylib
> -Wl,-compatibility_version -Wl,15 -Wl,-current_version -Wl,15.0
> Undefined symbols:
>    "OGRGeometry::dumpReadable(__sFILE*, char const*) const", referenced
> from: vtable for OGRMultiPointin ogrmultipoint.o
>        vtable for OGRMultiLineStringin ogrmultilinestring.o
> ld: symbol(s) not found
> collect2: ld returned 1 exit status
> make[1]: *** [libgdal.la] Error 1
> make: *** [check-lib] Error 2
>
> Joaquim Luis
>
>
> ----------------------------------------------------------------
> This message was sent using IMP, the Internet Messaging Program.
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From mattvavrek at hotmail.com  Sun Jul  5 14:04:29 2009
From: mattvavrek at hotmail.com (Matthew Vavrek)
Date: Sun Jul  5 14:05:33 2009
Subject: [gdal-dev] gdalwarp and Molleweide projections
Message-ID: <BLU0-SMTP3322F7F82CF23B3529B560DE2A0@phx.gbl>

I have just started trying to use gdalwarp and gdal_translate to 
reproject some world maps. I have managed to achieve some limited 
success with some projections, but I seem to get strange results with my 
images, especially with Mollweide. The Molleweide gives a horizontally 
flipped image, sometimes with an unreversed strip in the middle, and the 
top and bottom of the image seem stretched rather than compressed as I 
would expect. The code I used to translate is:

gdalwarp -of GTiff -s_srs EPSG:4326 -t_srs EPSG:54009 input.tif 
moll-output.tif

I also tried with -t_srs '+proj=moll +lon_0=0'.
My initial image was a plain jpg, and I have tried creating a world file 
and using gdal_translate to georeference the image. I also tried using:

gdalwarp s_srs EPSG:4326 t_srs EPSG:4326 input.tif output.tif

to see if that would help, which it oddly did for some of the other 
projections I was trying (like polyconic). I have even tried different 
world map images, yet still get these strange results. I can't figure 
out what I'm doing wrong to get these totally bizarre images, so any 
help would be appreciated.

Thanks
Matthew
From jluis at ualg.pt  Sun Jul  5 14:25:54 2009
From: jluis at ualg.pt (jluis@ualg.pt)
Date: Sun Jul  5 14:25:57 2009
Subject: [gdal-dev] Build failure on Mac X
In-Reply-To: <200907051925.58695.even.rouault@mines-paris.org>
References: <20090705182031.81335s58y5tj40kc@wmail.ualg.pt>
	<200907051925.58695.even.rouault@mines-paris.org>
Message-ID: <20090705202554.11870rklt3ub2pf4@wmail.ualg.pt>

Even,

Since it was a long time from last built I had actually rerun the  
configure but did not do a make clean (I normally do it at the end a  
building session). I looks like I had forgotten the other time.
Everything fine again, thanks.

Joaquim

> Did you happen to 'svn update' and just 'make' ? If that's the case, you
> should do a 'make clean' before trying 'make' again
>
> Le Sunday 05 July 2009 18:20:31 jluis@ualg.pt, vous avez ?crit?:
>> Hi,
>>
>> I do this very rarely but it had worked before. However, today's
>> attempt to build trunk on OSX is failing at the end with
>>
>> ....
>> b/libNCSUtil.dylib -lmfhdf -ldf /usr/local/lib/libsz.dylib
>> /usr/local/lib/libnetcdf.a -ldl -lcurl -lssl -lcrypto -lz
>>    -install_name  /usr/local/lib/libgdal.1.dylib
>> -Wl,-compatibility_version -Wl,15 -Wl,-current_version -Wl,15.0
>> Undefined symbols:
>>    "OGRGeometry::dumpReadable(__sFILE*, char const*) const", referenced
>> from: vtable for OGRMultiPointin ogrmultipoint.o
>>        vtable for OGRMultiLineStringin ogrmultilinestring.o
>> ld: symbol(s) not found
>> collect2: ld returned 1 exit status
>> make[1]: *** [libgdal.la] Error 1
>> make: *** [check-lib] Error 2
>>
>> Joaquim Luis
>>
>>
>> ----------------------------------------------------------------
>> This message was sent using IMP, the Internet Messaging Program.
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>



----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.

From neteler at osgeo.org  Sun Jul  5 16:13:13 2009
From: neteler at osgeo.org (Markus Neteler)
Date: Sun Jul  5 16:13:15 2009
Subject: [gdal-dev] resampling techniques in GDAL
In-Reply-To: <451453C181B199458A55B2B1723FAC000260CB1D@SAGE.forestry.oregonstate.edu>
References: <Acnu1ReBFqpd+72bRY6gbxHBbd6cTg==>
	<451453C181B199458A55B2B1723FAC000260CB1D@SAGE.forestry.oregonstate.edu>
Message-ID: <86782b610907051313w5a34153dhc1e438ed926f9a0f@mail.gmail.com>

On Wed, Jun 17, 2009 at 12:52 AM, Gregory,
Matthew<matt.gregory@oregonstate.edu> wrote:
> Hi all,
>
> A recent post got me thinking about resampling techniques. ?I've posted
> a graphic to help illustrate my question.
>
> ?http://www.fsl.orst.edu/lemma/sandbox/resample.png
>
> In the graphic, assume the input image is the 3x3 grid with black
> outlines and blue and yellow dot centers. ?Assume the red outlined
> pixels represent three different output resolutions of a single pixel
> each having its center at the black dot.
>
> Using bilinear interpolation, each of these three output resolutions get
> the same value (tested using gdalwarp) based on the four yellow cell
> centers. ?I understand why this is happening and realize this is the
> expected behavior.
>
> My question, however, is whether or not there is a resampling technique
> (inside or outside GDAL) that uses the proportional weights and values
> of *all* input pixels touched by the output pixel.

This would be a great addition (especially for gdalwarp). I have to
reproject population maps (LatLong, people/pixel) and a weighted
approach should gain more precision, right?

In GRASS, we have
http://grass.itc.it/grass64/manuals/html64_user/r.resamp.stats.html
-w: Weight according to area (slower)

but that's not for reprojecting...

Markus
From warmerdam at pobox.com  Sun Jul  5 20:44:41 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Sun Jul  5 20:44:56 2009
Subject: [gdal-dev] GDAL site down?
In-Reply-To: <cb4457700907050216x988bab1pc6dcdaa273aefc27@mail.gmail.com>
References: <cb4457700907050216x988bab1pc6dcdaa273aefc27@mail.gmail.com>
Message-ID: <4A5148F9.4010801@pobox.com>

Jorge Ar?valo wrote:
> Hello,
> 
> GDAL site (http://www.gdal.org) seems to be down, doesn't it?

Jorge,

Several OSGeo hosted web sites are down due to what appears to be a
server problem.  We are working to resolve the issue.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From szekerest at gmail.com  Mon Jul  6 05:26:32 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Mon Jul  6 05:26:36 2009
Subject: [gdal-dev] Question about GDALDriverManager + gdal2wktraster
In-Reply-To: <cb4457700907041232v62da7945nd74dd03a7297746f@mail.gmail.com>
References: <cb4457700907041232v62da7945nd74dd03a7297746f@mail.gmail.com>
Message-ID: <f3b73b7d0907060226n4b122bdxa23bd444a025e0c6@mail.gmail.com>

Jorge,

I'm not aware much about the changes in the gdal2wktraster script, I can see
a r4226 which may be related to the problem. Please consult with the author
Mateusz Loskot about the possible reasons you've encountered with the
script.

I'll be trying to reproduce your appcrash and gather further information
abot the details soon.

Best regards,

Tamas



2009/7/4 Jorge Ar?valo <jorge.arevalo@gmail.com>

> Hello,
>
> I have two versions of GDAL in my machine:
>
> - GDAL 1.7.0 from SVN
> - GDAL 1.7.0 with the WKT Raster driver I'm developing
>
> Today, I've updated the wktraster code from svn. I have the revision 4256.
> The last one. With this revision, there is a new version of gdal2wktraster
> script.
>
> I loaded this image
> ftp://ftp.remotesensing.org/geotiff/samples/gdal_eg/cea.tif with and old
> version of gdal2wktraster, that allowed GDAL to select the block size for
> the tiles. Then, I could load the image with default tiles of 514x15, 35
> tiles.
>
> But with the new version of the script, I have to specify the block size by
> hand. For example, 514x15 (or 100x100). When I try this:
>
> gdal2wktraster.py -r cea.tif -t table_name -s 4267 -b 1 -k 514x15 -I -M -o
> output.sql -v
>
> I get this error:
>
> ERROR 7: Assertion `FALSE' failed
> in file `gdaldrivermanager.cpp', line 309
>
> Reviewing the code, I saw that the last script's instruction called is:
>
> pixels = band.ReadAsArray(xoff, yoff, valid_read_block_size[0],
> valid_read_block_size[1],
>                                   target_block_size[0],
> target_block_size[1])
>
> That, somehow, should call the method "GDALDriverManager::RegisterDriver(
> GDALDriver * poDriver )" from gdalmanager.cpp. The code of the method is
> this:
>
> int GDALDriverManager::RegisterDriver( GDALDriver * poDriver )
> {
>     CPLMutexHolderD( &hDMMutex );
>
> /* -------------------------------------------------------------------- */
> /*      If it is already registered, just return the existing           */
> /*      index.                                                          */
> /* -------------------------------------------------------------------- */
>     if( GetDriverByName( poDriver->GetDescription() ) != NULL )
>     {
>         int             i;
>
>         for( i = 0; i < nDrivers; i++ )
>         {
>             if( papoDrivers[i] == poDriver )
>             {
>                 return i;
>             }
>         }
>
>         CPLAssert( FALSE ); // -------> THE LINE THAT CAUSES THE CRASH
> *******************************************
>     }
>
> /* -------------------------------------------------------------------- */
> /*      Otherwise grow the list to hold the new entry.                  */
> /* -------------------------------------------------------------------- */
>     papoDrivers = (GDALDriver **)
>         VSIRealloc(papoDrivers, sizeof(GDALDriver *) * (nDrivers+1));
>
>     papoDrivers[nDrivers] = poDriver;
>     nDrivers++;
>
>     if( poDriver->pfnCreate != NULL )
>         poDriver->SetMetadataItem( GDAL_DCAP_CREATE, "YES" );
>
>     if( poDriver->pfnCreateCopy != NULL )
>         poDriver->SetMetadataItem( GDAL_DCAP_CREATECOPY, "YES" );
>
>     int iResult = nDrivers - 1;
>
>     return iResult;
> }
>
> So, basically, with the base 1.7.0 version of GDAL, I can load the TIFF
> file. With my version, crash in the previous method. Clearly, it's my
> driver's problem, but I don't know why. I have a test code to create a
> dataset using my driver and works... Why could the application crash when
> trying to list the registered drivers while loading a TIFF file? I have the
> TIFF driver loaded in my GDAL version.
>
> Thanks in advance,
>
> Best regards
> Jorge
>
> Paula Poundstone<http://www.brainyquote.com/quotes/authors/p/paula_poundstone.html> - "I don't have a bank account because I don't know my mother's maiden
> name."
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090706/529afb10/attachment-0001.html
From crschmidt at metacarta.com  Mon Jul  6 08:50:37 2009
From: crschmidt at metacarta.com (Christopher Schmidt)
Date: Mon Jul  6 09:09:03 2009
Subject: [gdal-dev] GDAL site down?
In-Reply-To: <4A5148F9.4010801@pobox.com>
References: <cb4457700907050216x988bab1pc6dcdaa273aefc27@mail.gmail.com>
	<4A5148F9.4010801@pobox.com>
Message-ID: <20090706125036.GA19425@metacarta.com>

On Sun, Jul 05, 2009 at 08:44:41PM -0400, Frank Warmerdam wrote:
> Jorge Ar?valo wrote:
> >Hello,
> >
> >GDAL site (http://www.gdal.org) seems to be down, doesn't it?
> 
> Jorge,
> 
> Several OSGeo hosted web sites are down due to what appears to be a
> server problem.  We are working to resolve the issue.
This issue is now resolved.

Regards,
-- 
Christopher Schmidt
OSGeo SAC
From jorge.arevalo at gmail.com  Mon Jul  6 10:08:46 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Mon Jul  6 10:09:11 2009
Subject: [gdal-dev] GDAL site down?
In-Reply-To: <20090706125036.GA19425@metacarta.com>
References: <cb4457700907050216x988bab1pc6dcdaa273aefc27@mail.gmail.com> 
	<4A5148F9.4010801@pobox.com> <20090706125036.GA19425@metacarta.com>
Message-ID: <cb4457700907060708qcf2a242u91f0a415bbc45b69@mail.gmail.com>

On Mon, Jul 6, 2009 at 2:50 PM, Christopher Schmidt <crschmidt@metacarta.com
> wrote:

> On Sun, Jul 05, 2009 at 08:44:41PM -0400, Frank Warmerdam wrote:
> > Jorge Ar?valo wrote:
> > >Hello,
> > >
> > >GDAL site (http://www.gdal.org) seems to be down, doesn't it?
> >
> > Jorge,
> >
> > Several OSGeo hosted web sites are down due to what appears to be a
> > server problem.  We are working to resolve the issue.
> This issue is now resolved.
>
> Regards,
> --
> Christopher Schmidt
> OSGeo SAC


Many thanks.

Best regards
Jorge
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090706/fe75677a/attachment.html
From debeaudette at ucdavis.edu  Mon Jul  6 13:10:55 2009
From: debeaudette at ucdavis.edu (Dylan Beaudette)
Date: Mon Jul  6 13:10:04 2009
Subject: [gdal-dev] working with AVIRIS data
Message-ID: <200907061010.55479.dylan.beaudette@gmail.com>

Hi,


Does anyone on the list know how to either convert or extract data as
delivered in the "free data" section [1] of the AVIRIS home page? I
have tried working with the "radiance" data, which when uncompressed
comes with several ".img" files-- however my copy of GDAL (1.7) does not know
what to make of it.

1. http://aviris.jpl.nasa.gov/html/aviris.freedata.html

Thanks!
Dylan

-- 
Dylan Beaudette
Soil Resource Laboratory
http://casoilresource.lawr.ucdavis.edu/
University of California at Davis
530.754.7341
From warmerdam at pobox.com  Mon Jul  6 14:17:36 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon Jul  6 14:17:53 2009
Subject: [gdal-dev] working with AVIRIS data
In-Reply-To: <200907061010.55479.dylan.beaudette@gmail.com>
References: <200907061010.55479.dylan.beaudette@gmail.com>
Message-ID: <4A523FC0.6020004@pobox.com>

Dylan Beaudette wrote:
> Hi,
> 
> 
> Does anyone on the list know how to either convert or extract data as
> delivered in the "free data" section [1] of the AVIRIS home page? I
> have tried working with the "radiance" data, which when uncompressed
> comes with several ".img" files-- however my copy of GDAL (1.7) does not know
> what to make of it.

Dylan,

I downloaded  the cuprite radiance data and the readme says:


*.img      CALIBRATED AVIRIS RADIANCE (IMAGE) DATA

Contents:   AVIRIS calibrated radiance multipled by the gain and stored as
             16-bit integers.
File type:  BINARY 16-bit signed integer IEEE.
Units:      gain times (microwatts per centimeter_squared per nanometer per
             steradian).
Format:     Band interleaved by pixel (channel, sample, line) with dimensions
             (224, 614, 512).  The last scene may be less than 512.  To
             calculate the number of lines divide the file size by 275,072
              bytes per line.

So it is a normal bigendian signed 16bit integer pixel interleaved dataset
with a width of 614, a length of 512 and 224 bands.

Based on the VRT tutorial at http://www.gdal.org/gdal_vrttut.html I wrote
a .vrt file that allows access to the first band.

<VRTDataset rasterXSize="614" rasterYSize="512">
   <VRTRasterBand dataType="Int16" band="1" subClass="VRTRawRasterBand">
     <SourceFilename 
relativetoVRT="1">f970619t01p02_r02_sc01.c.img</SourceFilename>
     <ImageOffset>0</ImageOffset>
     <PixelOffset>448</PixelOffset>
     <LineOffset>275072</LineOffset>
     <ByteOrder>MSB</ByteOrder>
   </VRTRasterBand>
</VRTDataset>

gdalinfo -mm sc01.vrt
Driver: VRT/Virtual Raster
Files: sc01.vrt
Size is 614, 512
Coordinate System is `'
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0,  512.0)
Upper Right (  614.0,    0.0)
Lower Right (  614.0,  512.0)
Center      (  307.0,  256.0)
Band 1 Block=614x1 Type=Int16, ColorInterp=Undefined
     Computed Min/Max=686.000,1381.000

To support more bands just add additional copies of the VRTRasterBand
section changing the band#, and adding two to the ImageOffset each time.
eg.

<VRTDataset rasterXSize="614" rasterYSize="512">
   <VRTRasterBand dataType="Int16" band="1" subClass="VRTRawRasterBand">
     <SourceFilename 
relativetoVRT="1">f970619t01p02_r02_sc01.c.img</SourceFilename>
     <ImageOffset>0</ImageOffset>
     <PixelOffset>448</PixelOffset>
     <LineOffset>275072</LineOffset>
     <ByteOrder>MSB</ByteOrder>
   </VRTRasterBand>
   <VRTRasterBand dataType="Int16" band="2" subClass="VRTRawRasterBand">
     <SourceFilename 
relativetoVRT="1">f970619t01p02_r02_sc01.c.img</SourceFilename>
     <ImageOffset>2</ImageOffset>
     <PixelOffset>448</PixelOffset>
     <LineOffset>275072</LineOffset>
     <ByteOrder>MSB</ByteOrder>
   </VRTRasterBand>
</VRTDataset>

You might want to write a small script to create this for 224 bands.
Note the SourceFilename element - update this for other cubes.

The same approach should work for the reflectance cubes (.rfl) if you
are interested in them.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From debeaudette at ucdavis.edu  Mon Jul  6 16:49:42 2009
From: debeaudette at ucdavis.edu (Dylan Beaudette)
Date: Mon Jul  6 16:48:50 2009
Subject: [gdal-dev] working with AVIRIS data
In-Reply-To: <4A523FC0.6020004@pobox.com>
References: <200907061010.55479.dylan.beaudette@gmail.com>
	<4A523FC0.6020004@pobox.com>
Message-ID: <200907061349.42172.dylan.beaudette@gmail.com>

On Monday 06 July 2009, Frank Warmerdam wrote:
> Dylan Beaudette wrote:
> > Hi,
> >
> >
> > Does anyone on the list know how to either convert or extract data as
> > delivered in the "free data" section [1] of the AVIRIS home page? I
> > have tried working with the "radiance" data, which when uncompressed
> > comes with several ".img" files-- however my copy of GDAL (1.7) does not
> > know what to make of it.
>
> Dylan,
>
> I downloaded  the cuprite radiance data and the readme says:
>
>
> *.img      CALIBRATED AVIRIS RADIANCE (IMAGE) DATA
>
> Contents:   AVIRIS calibrated radiance multipled by the gain and stored as
>              16-bit integers.
> File type:  BINARY 16-bit signed integer IEEE.
> Units:      gain times (microwatts per centimeter_squared per nanometer per
>              steradian).
> Format:     Band interleaved by pixel (channel, sample, line) with
> dimensions (224, 614, 512).  The last scene may be less than 512.  To
> calculate the number of lines divide the file size by 275,072 bytes per
> line.
>
> So it is a normal bigendian signed 16bit integer pixel interleaved dataset
> with a width of 614, a length of 512 and 224 bands.
>
> Based on the VRT tutorial at http://www.gdal.org/gdal_vrttut.html I wrote
> a .vrt file that allows access to the first band.
>
> <VRTDataset rasterXSize="614" rasterYSize="512">
>    <VRTRasterBand dataType="Int16" band="1" subClass="VRTRawRasterBand">
>      <SourceFilename
> relativetoVRT="1">f970619t01p02_r02_sc01.c.img</SourceFilename>
>      <ImageOffset>0</ImageOffset>
>      <PixelOffset>448</PixelOffset>
>      <LineOffset>275072</LineOffset>
>      <ByteOrder>MSB</ByteOrder>
>    </VRTRasterBand>
> </VRTDataset>
>
> gdalinfo -mm sc01.vrt
> Driver: VRT/Virtual Raster
> Files: sc01.vrt
> Size is 614, 512
> Coordinate System is `'
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0,  512.0)
> Upper Right (  614.0,    0.0)
> Lower Right (  614.0,  512.0)
> Center      (  307.0,  256.0)
> Band 1 Block=614x1 Type=Int16, ColorInterp=Undefined
>      Computed Min/Max=686.000,1381.000
>
> To support more bands just add additional copies of the VRTRasterBand
> section changing the band#, and adding two to the ImageOffset each time.
> eg.
>
> <VRTDataset rasterXSize="614" rasterYSize="512">
>    <VRTRasterBand dataType="Int16" band="1" subClass="VRTRawRasterBand">
>      <SourceFilename
> relativetoVRT="1">f970619t01p02_r02_sc01.c.img</SourceFilename>
>      <ImageOffset>0</ImageOffset>
>      <PixelOffset>448</PixelOffset>
>      <LineOffset>275072</LineOffset>
>      <ByteOrder>MSB</ByteOrder>
>    </VRTRasterBand>
>    <VRTRasterBand dataType="Int16" band="2" subClass="VRTRawRasterBand">
>      <SourceFilename
> relativetoVRT="1">f970619t01p02_r02_sc01.c.img</SourceFilename>
>      <ImageOffset>2</ImageOffset>
>      <PixelOffset>448</PixelOffset>
>      <LineOffset>275072</LineOffset>
>      <ByteOrder>MSB</ByteOrder>
>    </VRTRasterBand>
> </VRTDataset>
>
> You might want to write a small script to create this for 224 bands.
> Note the SourceFilename element - update this for other cubes.
>
> The same approach should work for the reflectance cubes (.rfl) if you
> are interested in them.
>
> Best regards,

Thanks Frank. This works well. Now I need to figure out how to apply the 
geo-rectification / distortion corrections from the .nav files... Some ideas 
here: ftp://popo.jpl.nasa.gov/pub/docs/workshops/99_docs/7.pdf

Cheers,
Dylan

-- 
Dylan Beaudette
Soil Resource Laboratory
http://casoilresource.lawr.ucdavis.edu/
University of California at Davis
530.754.7341
From warmerdam at pobox.com  Tue Jul  7 00:32:58 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue Jul  7 00:33:05 2009
Subject: [gdal-dev] Question about GDALDriverManager + gdal2wktraster
In-Reply-To: <cb4457700907041232v62da7945nd74dd03a7297746f@mail.gmail.com>
References: <cb4457700907041232v62da7945nd74dd03a7297746f@mail.gmail.com>
Message-ID: <4A52CFFA.5030001@pobox.com>

Jorge Ar?valo wrote:
> Hello,
> 
> I have two versions of GDAL in my machine:
> 
> - GDAL 1.7.0 from SVN
> - GDAL 1.7.0 with the WKT Raster driver I'm developing
> 
> Today, I've updated the wktraster code from svn. I have the revision 
> 4256. The last one. With this revision, there is a new version of 
> gdal2wktraster script.
...
> /* -------------------------------------------------------------------- */
> /*      If it is already registered, just return the existing           */
> /*      index.                                                          */
> /* -------------------------------------------------------------------- */
>     if( GetDriverByName( poDriver->GetDescription() ) != NULL )
>     {
>         int             i;
> 
>         for( i = 0; i < nDrivers; i++ )
>         {
>             if( papoDrivers[i] == poDriver )
>             {
>                 return i;
>             }
>         }
> 
>         CPLAssert( FALSE ); // -------> THE LINE THAT CAUSES THE CRASH 
> *******************************************
...
> 
> So, basically, with the base 1.7.0 version of GDAL, I can load the TIFF 
> file. With my version, crash in the previous method. Clearly, it's my 
> driver's problem, but I don't know why. I have a test code to create a 
> dataset using my driver and works... Why could the application crash 
> when trying to list the registered drivers while loading a TIFF file? I 
> have the TIFF driver loaded in my GDAL version.

Jorge,

It sounds very much to me like there is more than one driver registered
with a given name (description).

What do you do in your driver for the poDriver->SetDescription() call?
It is imperative that each driver have a unique short driver name for
this.

Looking at:

   http://www.gis4free.org/gdal_wktraster/frmts/wktraster/wktrasterdataset.cpp

I see:

     if( GDALGetDriverByName( "WKTRaster" ) == NULL )
     {
         poDriver = new GDALDriver();

         poDriver->SetDescription( "WKT Raster driver" );

OK, so the problem is that your GetDriverByName() call is
not checking for the short name you set as the description.
Even though it is called Description this is really the
driver short name and it should be a well behaved short
keyword.  So please change it to:

    poDriver->SetDescription( "WKTRaster" );

If you find the driver writing tutorial is unclear on this point please
propose a change to the tutorial.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From jorge.arevalo at gmail.com  Tue Jul  7 06:39:26 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Tue Jul  7 06:39:48 2009
Subject: [gdal-dev] Question about GDALDriverManager + gdal2wktraster
In-Reply-To: <4A52CFFA.5030001@pobox.com>
References: <cb4457700907041232v62da7945nd74dd03a7297746f@mail.gmail.com> 
	<4A52CFFA.5030001@pobox.com>
Message-ID: <cb4457700907070339gca28741t6bf8ccb7d619f01d@mail.gmail.com>

Hello,

2009/7/7 Frank Warmerdam <warmerdam@pobox.com>:

> Looking at:
>
> ?http://www.gis4free.org/gdal_wktraster/frmts/wktraster/wktrasterdataset.cpp
>
> I see:
>
> ? ?if( GDALGetDriverByName( "WKTRaster" ) == NULL )
> ? ?{
> ? ? ? ?poDriver = new GDALDriver();
>
> ? ? ? ?poDriver->SetDescription( "WKT Raster driver" );
>
> OK, so the problem is that your GetDriverByName() call is
> not checking for the short name you set as the description.
> Even though it is called Description this is really the
> driver short name and it should be a well behaved short
> keyword. ?So please change it to:
>
> ? poDriver->SetDescription( "WKTRaster" );

Changed and working :-). Many thanks, Frank

>
> If you find the driver writing tutorial is unclear on this point please
> propose a change to the tutorial.

Re-reading the driver tutorial, I should figure myself out. When you
pass the mouse over "GDALDriverByName" in
http://www.gdal.org/gdal_drivertut.html#gdal_drivertut_addingdriver
you can read "Fetch a driver based on the short name". And the
description "is the short name".

At the most, maybe you can write something like:

"The description is the short name for the format. *The one that you
have to use if you want to fetch the driver by name*. This is a unique
name for this format, often used to identity the driver in scripts and
commandline programs. Normally 3-5 characters in length, and matching
the prefix of the format classes. (mandatory)"

>
> Best regards,

Best regards,
Jorge

> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up ? | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush ? ?| Geospatial Programmer for Rent
>
>
From apachemaven0 at gmail.com  Tue Jul  7 07:38:13 2009
From: apachemaven0 at gmail.com (maven apache)
Date: Tue Jul  7 07:38:15 2009
Subject: [gdal-dev] can java use the jdal
Message-ID: <b6ae15040907070438r5b8f55afyd2ceedf5a1133068@mail.gmail.com>

I wonder if there is a java librariy which can be directly used to handle
the data instead of using the Runtime to call the command(for example
glalinfo......)?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090707/3b5c205f/attachment.html
From Martin.Sommer at eads.com  Tue Jul  7 09:07:59 2009
From: Martin.Sommer at eads.com (Sommer, Martin)
Date: Tue Jul  7 09:09:26 2009
Subject: [gdal-dev] GDAL Windows builds available
Message-ID: <809C01ADEDDDFA4EBA028B5A35A10E0A01AB8360@deimsg41.de.net.world>

Hi All,

 

is the repository of Tamas Szekeres at
http://vbkto.dyndns.org:1280/sdk/index.html still available?

Are there any other sources, where I can get the windows builds?

 

Thanks

Martin

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090707/fb6beea4/attachment.html
From warmerdam at pobox.com  Tue Jul  7 09:21:45 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue Jul  7 09:21:57 2009
Subject: [gdal-dev] GDAL Windows builds available
In-Reply-To: <809C01ADEDDDFA4EBA028B5A35A10E0A01AB8360@deimsg41.de.net.world>
References: <809C01ADEDDDFA4EBA028B5A35A10E0A01AB8360@deimsg41.de.net.world>
Message-ID: <4A534BE9.4030409@pobox.com>

Sommer, Martin wrote:
> Hi All,
> 
>  
> 
> is the repository of Tamas Szekeres at 
> http://vbkto.dyndns.org:1280/sdk/index.html still available?

Martin,

The above link still works for me. Perhaps you suffered a temporary
interruption?

> Are there any other sources, where I can get the windows builds?

   http://download.osgeo.org/gdal/win32/
   http://osgeo4w.osgeo.org/

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Tue Jul  7 09:25:08 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue Jul  7 09:25:18 2009
Subject: [gdal-dev] can java use the jdal
In-Reply-To: <b6ae15040907070438r5b8f55afyd2ceedf5a1133068@mail.gmail.com>
References: <b6ae15040907070438r5b8f55afyd2ceedf5a1133068@mail.gmail.com>
Message-ID: <4A534CB4.6060902@pobox.com>

maven apache wrote:
> I wonder if there is a java librariy which can be directly used to 
> handle the data instead of using the Runtime to call the command(for 
> example glalinfo......)?

Maven,

The GDAL project includes java bindings for the api so it should be
practical to recreate pretty much any of the commandline programs
in Java.  There is already an example for gdalinfo.

   http://trac.osgeo.org/gdal/wiki/GdalOgrInJava

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From dany.geotools at gmail.com  Tue Jul  7 10:30:51 2009
From: dany.geotools at gmail.com (Daniele Romagnoli)
Date: Tue Jul  7 10:30:54 2009
Subject: [gdal-dev] can java use the jdal
In-Reply-To: <4A534CB4.6060902@pobox.com>
References: <b6ae15040907070438r5b8f55afyd2ceedf5a1133068@mail.gmail.com>
	<4A534CB4.6060902@pobox.com>
Message-ID: <7221db410907070730g12f157b5w4eaf4a99d8e183f2@mail.gmail.com>

Hi,
you can also take a look on our imageio-ext project which extends Sun's Java
ImageIO framework, also leveraging on gdal.
See here: https://imageio-ext.dev.java.net/

Hope this helps.
Cheers,
Daniele

On Tue, Jul 7, 2009 at 3:25 PM, Frank Warmerdam <warmerdam@pobox.com> wrote:

> maven apache wrote:
>
>> I wonder if there is a java librariy which can be directly used to handle
>> the data instead of using the Runtime to call the command(for example
>> glalinfo......)?
>>
>
> Maven,
>
> The GDAL project includes java bindings for the api so it should be
> practical to recreate pretty much any of the commandline programs
> in Java.  There is already an example for gdalinfo.
>
>  http://trac.osgeo.org/gdal/wiki/GdalOgrInJava
>
> Best regards,
> --
>
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam<http://pobox.com/%7Ewarmerdam>
> and watch the world go round - Rush    | Geospatial Programmer for Rent
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
-------------------------------------------------------
Eng. Daniele Romagnoli
Software Engineer

GeoSolutions S.A.S.
Via Carignoni 51
55041 Camaiore (LU)
Italy

phone: +39 0584983027
fax:     +39 0584983027
mob:   +39 328 0559267


http://www.geo-solutions.it

-------------------------------------------------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090707/8b0f6172/attachment.html
From matt at klaric.com  Tue Jul  7 10:39:10 2009
From: matt at klaric.com (Matt Klaric)
Date: Tue Jul  7 10:47:02 2009
Subject: [gdal-dev] Parameters to GDAL Pixel Functions?
Message-ID: <eba00f2b0907070739wdfa6f16q2324deb80479081a@mail.gmail.com>

I'm trying to make use of the GDAL Pixel Functions in the virtual dataset
driver.  I have a situation where I would like to construct a pixel function
that is a function of the pixel values as well as some extra piece of
information.  This might be one of the metadata items for the image (which I
could use if the pixel function was able to reference the underlying
GDALDataset).  Alternatively, the pixel function could take these parameters
in just about any other way (being specified in the XML document, etc).

I'm flexible with regard to the mechanism by which this actually might
occur, but I need some way to get additional parameters (that vary on an
image-by-image basis) into the pixel function.

Let me know if any of this is unclear.

Thanks,
Matt
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090707/3db51e01/attachment.html
From jmckenna at gatewaygeomatics.com  Tue Jul  7 11:01:51 2009
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Tue Jul  7 11:08:51 2009
Subject: [gdal-dev] GDAL Windows builds available
In-Reply-To: <4A534BE9.4030409@pobox.com>
References: <809C01ADEDDDFA4EBA028B5A35A10E0A01AB8360@deimsg41.de.net.world>
	<4A534BE9.4030409@pobox.com>
Message-ID: <4A53635F.7090508@gatewaygeomatics.com>


> 
>> Are there any other sources, where I can get the windows builds?
> 
>   http://download.osgeo.org/gdal/win32/
>   http://osgeo4w.osgeo.org/
> 

The GDAL utilities are also included in MapServer for Windows: 
www.maptools.org/ms4w

-jeff



-- 
Jeff McKenna
FOSS4G Consulting and Training Services
http://www.gatewaygeomatics.com/




From warmerdam at pobox.com  Tue Jul  7 13:49:46 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue Jul  7 13:49:54 2009
Subject: [gdal-dev] rfc 24 - jpip
In-Reply-To: <B1B624F7C110834B96594065A74F3A540D01663D@gemini.rsinc.com>
References: <B1B624F7C110834B96594065A74F3A540D01663D@gemini.rsinc.com>
Message-ID: <4A538ABA.7070507@pobox.com>

Norman Barker wrote:
> Hi
> 
>  
> 
> http://trac.osgeo.org/gdal/wiki/rfc24_progressive_data_support
> 
>  
> 
> and the code at
> 
>  
> 
> http://svn.osgeo.org/gdal/sandbox/normanb/

Norman,

I pretty much agree with the things Even mentioned a few weeks ago.  A few
notes:

1) I would like you to provide the developer docs for GDALAsyncRasterIO and
the new methods on GDALDataset.  Well, you can skip the GDALAsyncRasterIO
accessor methods, but it is imperative (IMHO) that details docs be provided
for methods like BeginAsyncRasterIO(), GetNextUpdatedRegion(), LockBuffer(),
and UnlockBuffer().

2) Currently the JPIPKAK dataset does not appear to support normal data
access.  I do not believe this is acceptable.  If nothing else, it will
be educational for the rest of us if you implement the "normal" file
raster access mechanisms by invocation of appropriate async services.

3) I think we should provide a default GDALAsyncRasterIO() implementation
based on calls to the regular raster io functionality that works properly
except that it does not necessarily honour the timeout functionality
properly (it is effectively synchronous).

4) The GDALAsyncRasterIO object should be renamed GDALAsyncRasterReader
or something that does not imply that writing is supported unless that
is intended for the future.

5) The GDALAsyncRasterIO implementation should not be gdaldataset.cpp
(except for the begin call).

I am supportive of the general approach.

PS. I've successfully built the support on linux with only a few minor
changes.  I have yet to test it though.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From jericks at co.pierce.wa.us  Tue Jul  7 14:12:41 2009
From: jericks at co.pierce.wa.us (jericks)
Date: Tue Jul  7 14:12:43 2009
Subject: [Gdal-dev] ArcSDE Raster Offset
Message-ID: <1246990361743-3220887.post@n2.nabble.com>


I know this has been reported before:

http://n2.nabble.com/ArcSDE-Raster-Driver-for-GDAL---displacement-of-exported-images-td2029756.html#a2029756

but, when I do a gdalinfo on an ArcSDE 9.2 JPG2000 Raster Layer, the corner
coordinates are not the same as what ArcMap reports.  Then when I extract a
GeoTiff using gdal_translate I see an offset in the x dimension in QGIS and
UDig. 

ArcMap Corner Coordinates
Top:    764,000
Left:   1,058,000
Right:  1,274,000
Bottom: 527,000

Gdalinfo Corner Coordinates
Top:    764,000
Left:   1,057,944
Right:  1,274,000
Bottom: 527,000

The left numbers are different.  The number of columns and rows are the
same.  So is the cellsize.  My projection is EPSG:2927.  Any ideas?  Is
there any way to override the corner coordinates if Gdal is reading them
incorrectly?

Thanks,
Jared
-- 
View this message in context: http://n2.nabble.com/ArcSDE-Raster-Offset-tp3220887p3220887.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From even.rouault at mines-paris.org  Tue Jul  7 15:35:35 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue Jul  7 15:35:45 2009
Subject: [gdal-dev] Parameters to GDAL Pixel Functions?
In-Reply-To: <eba00f2b0907070739wdfa6f16q2324deb80479081a@mail.gmail.com>
References: <eba00f2b0907070739wdfa6f16q2324deb80479081a@mail.gmail.com>
Message-ID: <200907072135.35784.even.rouault@mines-paris.org>

Matt,

I don't see a way of doing what you want without hacking a bit into GDAL. You 
could easily pass the raster band object ('this') as an additionnal parameter 
to the callback. That way you could call GDALGetMetadataItem() to fetch 
additional parameters from the XML.

Le Tuesday 07 July 2009 16:39:10 Matt Klaric, vous avez ?crit?:
> I'm trying to make use of the GDAL Pixel Functions in the virtual dataset
> driver.  I have a situation where I would like to construct a pixel
> function that is a function of the pixel values as well as some extra piece
> of information.  This might be one of the metadata items for the image
> (which I could use if the pixel function was able to reference the
> underlying GDALDataset).  Alternatively, the pixel function could take
> these parameters in just about any other way (being specified in the XML
> document, etc).
>
> I'm flexible with regard to the mechanism by which this actually might
> occur, but I need some way to get additional parameters (that vary on an
> image-by-image basis) into the pixel function.
>
> Let me know if any of this is unclear.
>
> Thanks,
> Matt


From sorokina at ornl.gov  Tue Jul  7 17:56:21 2009
From: sorokina at ornl.gov (Sorokine, Alexandre)
Date: Tue Jul  7 18:00:10 2009
Subject: [gdal-dev] OGR is not able to determine PostGIS table SRS
Message-ID: <C6793CC5.E2C3%SorokinA@ornl.gov>

Folks,

I am trying to determine an SRS for a table in PostGIS database but I am
getting NULL.  I have a table that in PostGIS that has SRID defined:

usa=# select ST_SRID(the_geom) from census.counties;
 st_srid 
---------
    4326
    4326
...

However, when I try to do OGR_L_GetSpatialRef() or
OGR_L_GetSpatialReference() I am always getting NULL.  Same on ogrinfo:

ogrinfo -al -ro PG:'host=geodb dbname=usa tables=census.counties'
INFO: Open of `PG:host=geodb dbname=usa tables=census.counties'
      using driver `PostgreSQL' successful.
INFO: Internal data source name `PG:host=geodb dbname=usa '
      different from user name `PG:host=geodb dbname=usa tables=census
.counties'.

Layer name: census.counties
Geometry: Unknown (any)
Feature Count: 3141
Extent: (-178.217606, 18.921785) - (-66.969269, 71.406242)
Layer SRS WKT:
(unknown)
FID Column = gid
Geometry Column = the_geom
age_18_21: Integer (0.0)
age_22_29: Integer (0.0)
...

Result is the same on gdal versions 1.4.4, 1.6.0, 1.6.1 on OSX and Ubuntu
8.04.

Am I doing something wrong?

-- 
Alex Sorokine
mailto:SorokinA@ornl.gov


From jorge.arevalo at gmail.com  Tue Jul  7 18:19:52 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Tue Jul  7 18:20:14 2009
Subject: [gdal-dev] How to get the size of a OGRGeometry
Message-ID: <cb4457700907071519u3cba39f8r827d70f46c14c2de@mail.gmail.com>

Hello,

If I have an OGRGeometry object (said poGeom), I can get its coords by:

OGREnvelope * poE = new OGREnvelope();
poGeom->getEnvelope(poE);

// poE->MinX, poE->MinY, poE->MaxX, poE->MaxY are the limit coords

If I want the size of the Geometry:

double dSizeX = poE->MaxX - poE->MinX;
double dSizeY = poE->MaxY - poE->MinY;

Is it the correct way?

Thanks in advance
Jorge
From warmerdam at pobox.com  Tue Jul  7 18:28:04 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue Jul  7 18:28:11 2009
Subject: [gdal-dev] OGR is not able to determine PostGIS table SRS
In-Reply-To: <C6793CC5.E2C3%SorokinA@ornl.gov>
References: <C6793CC5.E2C3%SorokinA@ornl.gov>
Message-ID: <4A53CBF4.9060800@pobox.com>

Sorokine, Alexandre wrote:
> Folks,
> 
> I am trying to determine an SRS for a table in PostGIS database but I am
> getting NULL.  I have a table that in PostGIS that has SRID defined:
> 
> usa=# select ST_SRID(the_geom) from census.counties;
>  st_srid 
> ---------
>     4326
>     4326
>

Alexandre,

OGR doesn't look at the SRID of individual geometries, only at the SRID of
the table as registered in the srid column of the geometry_columns table
for that target table.  Perhaps you didn't set the SRID in the geometry_columns
table?  Or perhaps there is a problem looking up the composite name
census.counties?

You might try running ogrinfo with the --debug on commandline switch to see
some details of what is going on internally.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Tue Jul  7 18:31:06 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue Jul  7 18:31:15 2009
Subject: [gdal-dev] How to get the size of a OGRGeometry
In-Reply-To: <cb4457700907071519u3cba39f8r827d70f46c14c2de@mail.gmail.com>
References: <cb4457700907071519u3cba39f8r827d70f46c14c2de@mail.gmail.com>
Message-ID: <4A53CCAA.5020906@pobox.com>

Jorge Ar?valo wrote:
> Hello,
> 
> If I have an OGRGeometry object (said poGeom), I can get its coords by:
> 
> OGREnvelope * poE = new OGREnvelope();
> poGeom->getEnvelope(poE);
> 
> // poE->MinX, poE->MinY, poE->MaxX, poE->MaxY are the limit coords
> 
> If I want the size of the Geometry:
> 
> double dSizeX = poE->MaxX - poE->MinX;
> double dSizeY = poE->MaxY - poE->MinY;
> 
> Is it the correct way?

Jorge,

This is appropriate for finding the width and height of the
bounding box.  Is that what you mean when you say "size"?   Size
is not a well defined term all on it's own.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From jorge.arevalo at gmail.com  Tue Jul  7 19:08:19 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Tue Jul  7 19:08:42 2009
Subject: [gdal-dev] How to get the size of a OGRGeometry
In-Reply-To: <4A53CCAA.5020906@pobox.com>
References: <cb4457700907071519u3cba39f8r827d70f46c14c2de@mail.gmail.com> 
	<4A53CCAA.5020906@pobox.com>
Message-ID: <cb4457700907071608w5f107cch3b02e1ee14f1b0c2@mail.gmail.com>

2009/7/8 Frank Warmerdam <warmerdam@pobox.com>:
> Jorge Ar?valo wrote:
>>
>> Hello,
>>
>> If I have an OGRGeometry object (said poGeom), I can get its coords by:
>>
>> OGREnvelope * poE = new OGREnvelope();
>> poGeom->getEnvelope(poE);
>>
>> // poE->MinX, poE->MinY, poE->MaxX, poE->MaxY are the limit coords
>>
>> If I want the size of the Geometry:
>>
>> double dSizeX = poE->MaxX - poE->MinX;
>> double dSizeY = poE->MaxY - poE->MinY;
>>
>> Is it the correct way?
>
> Jorge,
>
> This is appropriate for finding the width and height of the
> bounding box. ?Is that what you mean when you say "size"? ? Size
> is not a well defined term all on it's own.

Hello Frank,

I'm talking about the nRasterXSize, nRasterYSize of a GDALDataset
(this is what I mean with "size"). In the context of the GDAL WKT
Raster driver, I can get the extent covered by a raster getting the
"extent" column from RASTER_COLUMNS table. If I read this column like
an OGRGeometry object, with an OGREnvelope, I can get the upper left
coords (poE->MinX, poE->MinY?) and the extent of the raster. But I'm
not sure if my operations are correct or there is a better way to do
this

Many thanks

>
> Best regards,
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up ? | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush ? ?| Geospatial Programmer for Rent
>
>
From jorge.arevalo at gmail.com  Tue Jul  7 20:01:02 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Tue Jul  7 20:01:24 2009
Subject: [gdal-dev] How do we know the number of raster bands of a WKT
	Raster object?
Message-ID: <cb4457700907071701g36e5e4fch287eb3f6a6964f95@mail.gmail.com>

Hello,

I have a doubt: I have a raster loaded in PostgreSQL with
gdal2wktraster, and I'm not sure of the best way to know the number of
raster bands the raster has. The fields "pixel_types" and
"nodata_values" from raster_columns table are arrays with one element
per raster band, so, counting the number of elements of one of these
arrays, I can get the number of raster bands. But it doesn't seem to
be a very "elegant" way. Do we have another way to do this?

Thanks in advance.
Best regards
From warmerdam at pobox.com  Tue Jul  7 20:28:17 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue Jul  7 20:28:22 2009
Subject: [gdal-dev] How to get the size of a OGRGeometry
In-Reply-To: <cb4457700907071608w5f107cch3b02e1ee14f1b0c2@mail.gmail.com>
References: <cb4457700907071519u3cba39f8r827d70f46c14c2de@mail.gmail.com> 
	<4A53CCAA.5020906@pobox.com>
	<cb4457700907071608w5f107cch3b02e1ee14f1b0c2@mail.gmail.com>
Message-ID: <4A53E821.5010305@pobox.com>

Jorge Ar?valo wrote:
> I'm talking about the nRasterXSize, nRasterYSize of a GDALDataset
> (this is what I mean with "size"). In the context of the GDAL WKT
> Raster driver, I can get the extent covered by a raster getting the
> "extent" column from RASTER_COLUMNS table. If I read this column like
> an OGRGeometry object, with an OGREnvelope, I can get the upper left
> coords (poE->MinX, poE->MinY?) and the extent of the raster. But I'm
> not sure if my operations are correct or there is a better way to do
> this

Jorge,

Taking the width and height of the extent geometry envelope and then
dividing by the pixel size values from RASTER_COLUMNS (pixelsize_x
and pixelsize_y) will give you the width and height of the raster in
pixels for regular_blocking rasters.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Tue Jul  7 20:30:11 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue Jul  7 20:30:12 2009
Subject: [gdal-dev] How do we know the number of raster bands of a WKT
	Raster object?
In-Reply-To: <cb4457700907071701g36e5e4fch287eb3f6a6964f95@mail.gmail.com>
References: <cb4457700907071701g36e5e4fch287eb3f6a6964f95@mail.gmail.com>
Message-ID: <4A53E893.6020003@pobox.com>

Jorge Ar?valo wrote:
> Hello,
> 
> I have a doubt: I have a raster loaded in PostgreSQL with
> gdal2wktraster, and I'm not sure of the best way to know the number of
> raster bands the raster has. The fields "pixel_types" and
> "nodata_values" from raster_columns table are arrays with one element
> per raster band, so, counting the number of elements of one of these
> arrays, I can get the number of raster bands. But it doesn't seem to
> be a very "elegant" way. Do we have another way to do this?

Jorge,

I believe taking the count of values in the pixel_types array is the
correct approach to determining the number of bands.

Elegant is in the eye of the beholder.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From sorokina at ornl.gov  Tue Jul  7 22:02:58 2009
From: sorokina at ornl.gov (Sorokine, Alexandre)
Date: Tue Jul  7 23:00:07 2009
Subject: [gdal-dev] OGR is not able to determine PostGIS table SRS
In-Reply-To: <4A53CBF4.9060800@pobox.com>
References: <C6793CC5.E2C3%SorokinA@ornl.gov> <4A53CBF4.9060800@pobox.com>
Message-ID: <F022FD852942F041A4D043E19A4BFFFD028617E2C35C@EXCHMB.ornl.gov>

Franks,

Thank you for your reply, I did some more checks.  Please see my comments below.

> I am trying to determine an SRS for a table in PostGIS database but I am
> getting NULL.  I have a table that in PostGIS that has SRID defined:
>
> usa=# select ST_SRID(the_geom) from census.counties;
>  st_srid
> ---------
>     4326
>     4326
>
> 
> OGR doesn't look at the SRID of individual geometries, only at the SRID of
> the table as registered in the srid column of the geometry_columns table
> for that target table.

I actually tried both for the whole layer (OGR_L_GetSpatialRef) and for each feature, both are NULL.

> Perhaps you didn't set the SRID in the geometry_columns table?

I checked it, all set:

# select srid from geometry_columns where f_table_name='counties' and f_table_schema='census';
 srid 
------
 4326
(1 row)

>  Or perhaps there is a problem looking up the composite name census.counties?

I created another table in the public schema, same problem: 

==========
# select * into tmp from census.counties;
...
$ ogrinfo -al -ro PG:'host=geodb dbname=usa tables=tmp'
INFO: Open of `PG:host=geodb dbname=usa tables=tmp'
      using driver `PostgreSQL' successful.
INFO: Internal data source name `PG:host=geodb dbname=usa '
      different from user name `PG:host=geodb dbname=usa tables=tmp'.

Layer name: tmp
Geometry: Unknown (any)
Feature Count: 3141
Extent: (-178.217606, 18.921785) - (-66.969269, 71.406242)
Layer SRS WKT:
(unknown)
....
==========

(Even though there may be a separate problem when tables with identical names are present in different schemata.)

> You might try running ogrinfo with the --debug on commandline switch to see
> some details of what is going on internally.

Here it is:

==========
$ CPL_DEBUG=ON ogrinfo -al -ro PG:'host=geodb dbname=usa tables=tmp' 
PG: DBName="usa"
PG: PostgreSQL version string : 'PostgreSQL 8.3.7 on x86_64-pc-linux-gnu, compiled by GCC cc (GCC) 4.2.4 (Ubuntu 4.2.4-1ubuntu3)'
PG: PostGIS version string : '1.3 USE_GEOS=1 USE_PROJ=1 USE_STATS=1'
OGR: OGROpen(PG:host=geodb dbname=usa tables=tmp/0x1000b40) succeeded as PostgreSQL.
OGR: GetLayerCount() = 1

PG: PQexec(SELECT count(*) FROM "tmp" )

PG: PQexec(SELECT Extent("the_geom") FROM "tmp")

PG: PQexec(DECLARE OGRPGLayerReader CURSOR for SELECT AsEWKT("the_geom"), "age_18_21", "age_22_29", "age_30_39", "age_40_49", "age_50_64", "age_5_17", "age_65_up", "age_under5", "ameri_es", "asian", "ave_fam_sz", "ave_hh_sz", "avg_sale97", "avg_size97", "black", "cnty_fips", "crop_acr97", "families", "females", "fhh_child", "fips", "gid", "hawn_pi", "hispanic", "households", "hse_units", "hsehld_1_f", "hsehld_1_m", "males", "marhh_chd", "marhh_no_c", "med_age", "med_age_f", "med_age_m", "mhh_child", "mult_race", "name", "no_farms97", "other", "owner_occ", "pop00_sqmi", "pop07_sqmi", "pop2000", "pop2007", "renter_occ", "sqmi", "state_fips", "state_name", "vacant", "white" FROM "tmp" )
INFO: Open of `PG:host=geodb dbname=usa tables=tmp'
      using driver `PostgreSQL' successful.
INFO: Internal data source name `PG:host=geodb dbname=usa '
      different from user name `PG:host=geodb dbname=usa tables=tmp'.

Layer name: tmp
Geometry: Unknown (any)
Feature Count: 3141
Extent: (-178.217606, 18.921785) - (-66.969269, 71.406242)
Layer SRS WKT:
(unknown)
Geometry Column = the_geom
age_18_21: Integer (0.0)
....
==========

Below is another demonstration of the same problem I think.  I am setting an envelope but the whole query fails because ogr sets a wrong SRS (-1/unknow instead of 4326) to the WHERE clause in the cursor:

==========
$ CPL_DEBUG=ON ogrinfo -al -ro PG:'host=geodb dbname=usa tables=census.counties' -spat -178.217606 18.921785 -66.969269 71.406242  
PG: DBName="usa"
PG: PostgreSQL version string : 'PostgreSQL 8.3.7 on x86_64-pc-linux-gnu, compiled by GCC cc (GCC) 4.2.4 (Ubuntu 4.2.4-1ubuntu3)'
PG: PostGIS version string : '1.3 USE_GEOS=1 USE_PROJ=1 USE_STATS=1'
PG: Primary key name (FID): gid
PG: Using column 'gid' as FID for table 'counties'
OGR: OGROpen(PG:host=geodb dbname=usa tables=census.counties/0x1000ad0) succeeded as PostgreSQL.
INFO: Open of `PG:host=geodb dbname=usa tables=census.counties'
      using driver `PostgreSQL' successful.
INFO: Internal data source name `PG:host=geodb dbname=usa '
      different from user name `PG:host=geodb dbname=usa tables=census.counties'.
OGR: GetLayerCount() = 1

PG: bHasPostGISGeometry == TRUE
PG: OGRPGTableLayer::BuildWhere returns: WHERE the_geom && SetSRID('BOX3D(-178.217606000000 18.921785000000, -66.969269000000 71.406242000000)'::box3d,-1) 

Layer name: census.counties
Geometry: Unknown (any)
PG: PQexec(SELECT count(*) FROM "census"."counties" WHERE the_geom && SetSRID('BOX3D(-178.217606000000 18.921785000000, -66.969269000000 71.406242000000)'::box3d,-1) )

PG: SELECT count(*) FROM "census"."counties" WHERE the_geom && SetSRID('BOX3D(-178.217606000000 18.921785000000, -66.969269000000 71.406242000000)'::box3d,-1) ; failed.
Feature Count: 0
PG: PQexec(SELECT Extent("the_geom") FROM "census"."counties")

Extent: (-178.217606, 18.921785) - (-66.969269, 71.406242)
Layer SRS WKT:
(unknown)
FID Column = gid
Geometry Column = the_geom
age_18_21: Integer (0.0)
age_22_29: Integer (0.0)
age_30_39: Integer (0.0)
age_40_49: Integer (0.0)
age_50_64: Integer (0.0)
age_5_17: Integer (0.0)
age_65_up: Integer (0.0)
age_under5: Integer (0.0)
ameri_es: Integer (0.0)
asian: Integer (0.0)
ave_fam_sz: Real (0.0)
ave_hh_sz: Real (0.0)
avg_sale97: Real (0.0)
avg_size97: Integer (0.0)
black: Integer (0.0)
cnty_fips: String (3.0)
crop_acr97: Integer (0.0)
families: Integer (0.0)
females: Integer (0.0)
fhh_child: Integer (0.0)
fips: String (5.0)
hawn_pi: Integer (0.0)
hispanic: Integer (0.0)
households: Integer (0.0)
hse_units: Integer (0.0)
hsehld_1_f: Integer (0.0)
hsehld_1_m: Integer (0.0)
males: Integer (0.0)
marhh_chd: Integer (0.0)
marhh_no_c: Integer (0.0)
med_age: Real (0.0)
med_age_f: Real (0.0)
med_age_m: Real (0.0)
mhh_child: Integer (0.0)
mult_race: Integer (0.0)
name: String (32.0)
no_farms97: Integer (0.0)
other: Integer (0.0)
owner_occ: Integer (0.0)
pop00_sqmi: Real (0.0)
pop07_sqmi: Real (0.0)
pop2000: Integer (0.0)
pop2007: Integer (0.0)
renter_occ: Integer (0.0)
sqmi: Real (0.0)
state_fips: String (2.0)
state_name: String (25.0)
vacant: Integer (0.0)
white: Integer (0.0)
PG: PQexec(DECLARE OGRPGLayerReader CURSOR for SELECT "gid", AsEWKT("the_geom"), "age_18_21", "age_22_29", "age_30_39", "age_40_49", "age_50_64", "age_5_17", "age_65_up", "age_under5", "ameri_es", "asian", "ave_fam_sz", "ave_hh_sz", "avg_sale97", "avg_size97", "black", "cnty_fips", "crop_acr97", "families", "females", "fhh_child", "fips", "hawn_pi", "hispanic", "households", "hse_units", "hsehld_1_f", "hsehld_1_m", "males", "marhh_chd", "marhh_no_c", "med_age", "med_age_f", "med_age_m", "mhh_child", "mult_race", "name", "no_farms97", "other", "owner_occ", "pop00_sqmi", "pop07_sqmi", "pop2000", "pop2007", "renter_occ", "sqmi", "state_fips", "state_name", "vacant", "white" FROM "census"."counties" WHERE the_geom && SetSRID('BOX3D(-178.217606000000 18.921785000000, -66.969269000000 71.406242000000)'::box3d,-1) )
PG: PQclear() on an error condition
==========


From warmerdam at pobox.com  Tue Jul  7 23:10:19 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue Jul  7 23:10:21 2009
Subject: [gdal-dev] OGR is not able to determine PostGIS table SRS
In-Reply-To: <F022FD852942F041A4D043E19A4BFFFD028617E2C35C@EXCHMB.ornl.gov>
References: <C6793CC5.E2C3%SorokinA@ornl.gov> <4A53CBF4.9060800@pobox.com>
	<F022FD852942F041A4D043E19A4BFFFD028617E2C35C@EXCHMB.ornl.gov>
Message-ID: <4A540E1B.9090202@pobox.com>

Sorokine, Alexandre wrote:
> Franks,
> 
> Thank you for your reply, I did some more checks.  Please see my comments below.

Alexandre,

I'm still wondering if this is related to schemas.  I was surprised to not
see any queries against the spatial_ref_sys table.  In my trunk build I see
something like:

PG: PQexec(SELECT srtext FROM spatial_ref_sys WHERE srid = 4326) = 
PGRES_TUPLES_OK, ntuples = 1

Actually, I suspect the debug facilities in trunk for the OGR PG driver
have been upgraded.  Would it be practical for you to try things with trunk?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From jorge.arevalo at gmail.com  Wed Jul  8 02:34:17 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Wed Jul  8 02:34:41 2009
Subject: [gdal-dev] How to get the size of a OGRGeometry
In-Reply-To: <4A53E821.5010305@pobox.com>
References: <cb4457700907071519u3cba39f8r827d70f46c14c2de@mail.gmail.com> 
	<4A53CCAA.5020906@pobox.com>
	<cb4457700907071608w5f107cch3b02e1ee14f1b0c2@mail.gmail.com> 
	<4A53E821.5010305@pobox.com>
Message-ID: <cb4457700907072334m72fbf8bew493c7998a7436d5c@mail.gmail.com>

2009/7/8 Frank Warmerdam <warmerdam@pobox.com>:
> Jorge,
>
> Taking the width and height of the extent geometry envelope and then
> dividing by the pixel size values from RASTER_COLUMNS (pixelsize_x
> and pixelsize_y) will give you the width and height of the raster in
> pixels for regular_blocking rasters.

Ok, thanks Frank.

Best regards
Jorge
From jorge.arevalo at gmail.com  Wed Jul  8 02:38:16 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Wed Jul  8 02:38:38 2009
Subject: [gdal-dev] How do we know the number of raster bands of a WKT 
	Raster object?
In-Reply-To: <4A53E893.6020003@pobox.com>
References: <cb4457700907071701g36e5e4fch287eb3f6a6964f95@mail.gmail.com> 
	<4A53E893.6020003@pobox.com>
Message-ID: <cb4457700907072338n3c214753s5240441c449db2d9@mail.gmail.com>

2009/7/8 Frank Warmerdam <warmerdam@pobox.com>:
> Jorge,
>
> I believe taking the count of values in the pixel_types array is the
> correct approach to determining the number of bands.
>
> Elegant is in the eye of the beholder.

Ok, thanks Frank. I like your point :-)

Best regards
Jorge
From nilesh.gis at gmail.com  Tue Jul  7 02:32:19 2009
From: nilesh.gis at gmail.com (Nilesh Choure)
Date: Wed Jul  8 10:37:20 2009
Subject: [gdal-dev] Getting exception while creating OGR geometry from WKT
	with huge number of vertices
Message-ID: <c907ad1d0907062332r60f27159i510b4da300957b8f@mail.gmail.com>

Hi,

I am trying to write features from shape file into DGN file from my
application. I am using swig generated java interfaces. I am able to write
features with point and simple line geometries without any problem but when
it comes across a feature which is either multilinestring or multipolygon
with very large number of vertices more than 2000 it crashes. Following is a
error log generated.

When I debuged gdal implementation and my application I found that the ogr
implementation does create the geometry object but when it returns from the
function it throws following access violation exception. I have searched the
couple of post on net and found that it is related with size of data.

Any help or suggestion in this regard is appreciated.
Please reply if you need more information if above is not sufficient.



******************************
***************************************************************************************************************************************************

#
# An unexpected error has been detected by Java Runtime Environment:
#
#  EXCEPTION_ACCESS_VIOLATION (0xc0000005) at pc=0x7c92ae22, pid=1012,
tid=3452
#
# Java VM: Java HotSpot(TM) Client VM (11.2-b01 mixed mode windows-x86)
# Problematic frame:
# C  [ntdll.dll+0x2ae22]
#
# If you would like to submit a bug report, please visit:
#   http://java.sun.com/webapps/bugreport/crash.jsp
# The crash happened outside the Java Virtual Machine in native code.
# See problematic frame for where to report the bug.
#

---------------  T H R E A D  ---------------

Current thread (0x00397000):  JavaThread "main" [_thread_in_native, id=3452,
stack(0x003b0000,0x00400000)]

siginfo: ExceptionCode=0xc0000005, reading address 0x37363139

Registers:
EAX=0x3332322e, EBX=0x00000000, ECX=0x37363139, EDX=0x00390608
ESP=0x003feb2c, EBP=0x003febe8, ESI=0x295a71f0, EDI=0x00390000
EIP=0x7c92ae22, EFLAGS=0x00010317

Top of Stack: (sp=0x003feb2c)
0x003feb2c:   00397000 295a7210 251a2180 27790000
0x003feb3c:   000009f6 281d2520 00000000 003fec14
0x003feb4c:   27db5b8c 281c7a68 003fec20 27d37ebb
0x003feb5c:   00000000 27d37f29 00390000 00015218
0x003feb6c:   29592008 37363139 00000000 3332322e
0x003feb7c:   295a71f0 00004400 003feae0 000199c0
0x003feb8c:   003febd4 7c90ee18 7c910570 ffffffff
0x003feb9c:   281c7a68 281c7a68 00390000 00000000

Instructions: (pc=0x7c92ae22)
0x7c92ae12:   75 cc 89 75 94 8b 06 89 45 90 8b 4e 04 89 4d 88
0x7c92ae22:   8b 11 3b 50 04 0f 85 93 d1 ff ff 3b d6 0f 85 8b


Stack: [0x003b0000,0x00400000],  sp=0x003feb2c,  free space=314k
Native frames: (J=compiled Java code, j=interpreted, Vv=VM code, C=native
code)
C  [ntdll.dll+0x2ae22]
C  [msvcr71.dll+0x218a]
V  [jvm.dll+0xd029e]
C  [ogrjni.dll+0x72ef]
j
org.gdal.ogr.ogrJNI.CreateGeometryFromWkt(Ljava/lang/String;JLorg/gdal/osr/SpatialReference;)J+0
j
org.gdal.ogr.ogr.CreateGeometryFromWkt(Ljava/lang/String;Lorg/gdal/osr/SpatialReference;)Lorg/gdal/ogr/Geometry;+6
j
com.rolta.gis.catalog.dgn.export.DGNExportHandler.parseGTGeometry(Lcom/vividsolutions/jts/geom/Geometry;)Lorg/gdal/ogr/Geometry;+106
j
com.rolta.gis.catalog.dgn.export.DGNExportHandler.convertGTFeature(Lorg/gdal/ogr/FeatureDefn;Lorg/opengis/feature/simple/SimpleFeature;)Lorg/gdal/ogr/Feature;+67
j
com.rolta.gis.catalog.dgn.export.DGNExportHandler.store(Ljava/io/File;)V+746
j
com.rolta.gis.catalog.dgn.export.DGNExportHandler.export(Lorg/eclipse/swt/widgets/Shell;)Z+59
j  com.rolta.gis.catalog.dgn.export.ui.DGNExportWizardPage.exportLayer()Z+17
j  com.rolta.gis.catalog.dgn.export.ui.DGNExportWizard.performFinish()Z+4
j  org.eclipse.jface.wizard.WizardDialog.finishPressed()V+4
j  org.eclipse.jface.wizard.WizardDialog.buttonPressed(I)V+54
j
org.eclipse.jface.dialogs.Dialog$2.widgetSelected(Lorg/eclipse/swt/events/SelectionEvent;)V+17
j
org.eclipse.swt.widgets.TypedListener.handleEvent(Lorg/eclipse/swt/widgets/Event;)V+1003
J
org.eclipse.swt.widgets.EventTable.sendEvent(Lorg/eclipse/swt/widgets/Event;)V
J  org.eclipse.swt.widgets.Display.runDeferredEvents()Z
J  org.eclipse.swt.widgets.Display.readAndDispatch()Z
j
org.eclipse.jface.window.Window.runEventLoop(Lorg/eclipse/swt/widgets/Shell;)V+23
j  org.eclipse.jface.window.Window.open()I+49
j
org.eclipse.ui.internal.handlers.WizardHandler$Export.executeHandler(Lorg/eclipse/core/commands/ExecutionEvent;)V+163
j
org.eclipse.ui.internal.handlers.WizardHandler.execute(Lorg/eclipse/core/commands/ExecutionEvent;)Ljava/lang/Object;+20
j
org.eclipse.ui.internal.handlers.HandlerProxy.execute(Lorg/eclipse/core/commands/ExecutionEvent;)Ljava/lang/Object;+33
j
org.eclipse.core.commands.Command.executeWithChecks(Lorg/eclipse/core/commands/ExecutionEvent;)Ljava/lang/Object;+115
j
org.eclipse.core.commands.ParameterizedCommand.executeWithChecks(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;+21
j
org.eclipse.ui.internal.handlers.HandlerService.executeCommand(Lorg/eclipse/core/commands/ParameterizedCommand;Lorg/eclipse/swt/widgets/Event;)Ljava/lang/Object;+6
j
org.eclipse.ui.internal.handlers.SlaveHandlerService.executeCommand(Lorg/eclipse/core/commands/ParameterizedCommand;Lorg/eclipse/swt/widgets/Event;)Ljava/lang/Object;+6
j
org.eclipse.ui.internal.actions.CommandAction.runWithEvent(Lorg/eclipse/swt/widgets/Event;)V+68
j
org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection(Lorg/eclipse/swt/widgets/Event;Z)V+354
j
org.eclipse.jface.action.ActionContributionItem.access$2(Lorg/eclipse/jface/action/ActionContributionItem;Lorg/eclipse/swt/widgets/Event;Z)V+3
j
org.eclipse.jface.action.ActionContributionItem$5.handleEvent(Lorg/eclipse/swt/widgets/Event;)V+60
J
org.eclipse.swt.widgets.EventTable.sendEvent(Lorg/eclipse/swt/widgets/Event;)V
j
org.eclipse.swt.widgets.Widget.sendEvent(Lorg/eclipse/swt/widgets/Event;)V+25
j  org.eclipse.swt.widgets.Display.runDeferredEvents()Z+84
j  org.eclipse.swt.widgets.Display.readAndDispatch()Z+59
j
org.eclipse.ui.internal.Workbench.runEventLoop(Lorg/eclipse/jface/window/Window$IExceptionHandler;Lorg/eclipse/swt/widgets/Display;)V+9
j  org.eclipse.ui.internal.Workbench.runUI()I+393
j
org.eclipse.ui.internal.Workbench.access$4(Lorg/eclipse/ui/internal/Workbench;)I+1
j  org.eclipse.ui.internal.Workbench$5.run()V+23
j
org.eclipse.core.databinding.observable.Realm.runWithDefault(Lorg/eclipse/core/databinding/observable/Realm;Ljava/lang/Runnable;)V+12
j
org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Lorg/eclipse/swt/widgets/Display;Lorg/eclipse/ui/application/WorkbenchAdvisor;)I+18
j
org.eclipse.ui.PlatformUI.createAndRunWorkbench(Lorg/eclipse/swt/widgets/Display;Lorg/eclipse/ui/application/WorkbenchAdvisor;)I+2
j
net.refractions.udig.internal.ui.UDIGApplication.start(Lorg/eclipse/equinox/app/IApplicationContext;)Ljava/lang/Object;+337
j
com.rolta.gis.launcher.RoltaDGISApplication.start(Lorg/eclipse/equinox/app/IApplicationContext;)Ljava/lang/Object;+20
j
org.eclipse.equinox.internal.app.EclipseAppHandle.run(Ljava/lang/Object;)Ljava/lang/Object;+135
j
org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(Ljava/lang/Object;)Ljava/lang/Object;+103
j
org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(Ljava/lang/Object;)Ljava/lang/Object;+29
j
org.eclipse.core.runtime.adaptor.EclipseStarter.run(Ljava/lang/Object;)Ljava/lang/Object;+149
j
org.eclipse.core.runtime.adaptor.EclipseStarter.run([Ljava/lang/String;Ljava/lang/Runnable;)Ljava/lang/Object;+183
v  ~StubRoutines::call_stub

Java frames: (J=compiled Java code, j=interpreted, Vv=VM code)
j
org.gdal.ogr.ogrJNI.CreateGeometryFromWkt(Ljava/lang/String;JLorg/gdal/osr/SpatialReference;)J+0
j
org.gdal.ogr.ogr.CreateGeometryFromWkt(Ljava/lang/String;Lorg/gdal/osr/SpatialReference;)Lorg/gdal/ogr/Geometry;+6
j
com.rolta.gis.catalog.dgn.export.DGNExportHandler.parseGTGeometry(Lcom/vividsolutions/jts/geom/Geometry;)Lorg/gdal/ogr/Geometry;+106
j
com.rolta.gis.catalog.dgn.export.DGNExportHandler.convertGTFeature(Lorg/gdal/ogr/FeatureDefn;Lorg/opengis/feature/simple/SimpleFeature;)Lorg/gdal/ogr/Feature;+67
j
com.rolta.gis.catalog.dgn.export.DGNExportHandler.store(Ljava/io/File;)V+746
j
com.rolta.gis.catalog.dgn.export.DGNExportHandler.export(Lorg/eclipse/swt/widgets/Shell;)Z+59
j  com.rolta.gis.catalog.dgn.export.ui.DGNExportWizardPage.exportLayer()Z+17
j  com.rolta.gis.catalog.dgn.export.ui.DGNExportWizard.performFinish()Z+4
j  org.eclipse.jface.wizard.WizardDialog.finishPressed()V+4
j  org.eclipse.jface.wizard.WizardDialog.buttonPressed(I)V+54
j
org.eclipse.jface.dialogs.Dialog$2.widgetSelected(Lorg/eclipse/swt/events/SelectionEvent;)V+17
j
org.eclipse.swt.widgets.TypedListener.handleEvent(Lorg/eclipse/swt/widgets/Event;)V+1003
J
org.eclipse.swt.widgets.EventTable.sendEvent(Lorg/eclipse/swt/widgets/Event;)V
J  org.eclipse.swt.widgets.Display.runDeferredEvents()Z
J  org.eclipse.swt.widgets.Display.readAndDispatch()Z
j
org.eclipse.jface.window.Window.runEventLoop(Lorg/eclipse/swt/widgets/Shell;)V+23
j  org.eclipse.jface.window.Window.open()I+49
j
org.eclipse.ui.internal.handlers.WizardHandler$Export.executeHandler(Lorg/eclipse/core/commands/ExecutionEvent;)V+163
j
org.eclipse.ui.internal.handlers.WizardHandler.execute(Lorg/eclipse/core/commands/ExecutionEvent;)Ljava/lang/Object;+20
j
org.eclipse.ui.internal.handlers.HandlerProxy.execute(Lorg/eclipse/core/commands/ExecutionEvent;)Ljava/lang/Object;+33
j
org.eclipse.core.commands.Command.executeWithChecks(Lorg/eclipse/core/commands/ExecutionEvent;)Ljava/lang/Object;+115
j
org.eclipse.core.commands.ParameterizedCommand.executeWithChecks(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;+21
j
org.eclipse.ui.internal.handlers.HandlerService.executeCommand(Lorg/eclipse/core/commands/ParameterizedCommand;Lorg/eclipse/swt/widgets/Event;)Ljava/lang/Object;+6
j
org.eclipse.ui.internal.handlers.SlaveHandlerService.executeCommand(Lorg/eclipse/core/commands/ParameterizedCommand;Lorg/eclipse/swt/widgets/Event;)Ljava/lang/Object;+6
j
org.eclipse.ui.internal.actions.CommandAction.runWithEvent(Lorg/eclipse/swt/widgets/Event;)V+68
j
org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection(Lorg/eclipse/swt/widgets/Event;Z)V+354
j
org.eclipse.jface.action.ActionContributionItem.access$2(Lorg/eclipse/jface/action/ActionContributionItem;Lorg/eclipse/swt/widgets/Event;Z)V+3
j
org.eclipse.jface.action.ActionContributionItem$5.handleEvent(Lorg/eclipse/swt/widgets/Event;)V+60
J
org.eclipse.swt.widgets.EventTable.sendEvent(Lorg/eclipse/swt/widgets/Event;)V
j
org.eclipse.swt.widgets.Widget.sendEvent(Lorg/eclipse/swt/widgets/Event;)V+25
j  org.eclipse.swt.widgets.Display.runDeferredEvents()Z+84
j  org.eclipse.swt.widgets.Display.readAndDispatch()Z+59
j
org.eclipse.ui.internal.Workbench.runEventLoop(Lorg/eclipse/jface/window/Window$IExceptionHandler;Lorg/eclipse/swt/widgets/Display;)V+9
j  org.eclipse.ui.internal.Workbench.runUI()I+393
j
org.eclipse.ui.internal.Workbench.access$4(Lorg/eclipse/ui/internal/Workbench;)I+1
j  org.eclipse.ui.internal.Workbench$5.run()V+23
j
org.eclipse.core.databinding.observable.Realm.runWithDefault(Lorg/eclipse/core/databinding/observable/Realm;Ljava/lang/Runnable;)V+12
j
org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Lorg/eclipse/swt/widgets/Display;Lorg/eclipse/ui/application/WorkbenchAdvisor;)I+18
j
org.eclipse.ui.PlatformUI.createAndRunWorkbench(Lorg/eclipse/swt/widgets/Display;Lorg/eclipse/ui/application/WorkbenchAdvisor;)I+2
j
net.refractions.udig.internal.ui.UDIGApplication.start(Lorg/eclipse/equinox/app/IApplicationContext;)Ljava/lang/Object;+337
j
com.rolta.gis.launcher.RoltaDGISApplication.start(Lorg/eclipse/equinox/app/IApplicationContext;)Ljava/lang/Object;+20
j
org.eclipse.equinox.internal.app.EclipseAppHandle.run(Ljava/lang/Object;)Ljava/lang/Object;+135
j
org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(Ljava/lang/Object;)Ljava/lang/Object;+103
j
org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(Ljava/lang/Object;)Ljava/lang/Object;+29
j
org.eclipse.core.runtime.adaptor.EclipseStarter.run(Ljava/lang/Object;)Ljava/lang/Object;+149
j
org.eclipse.core.runtime.adaptor.EclipseStarter.run([Ljava/lang/String;Ljava/lang/Runnable;)Ljava/lang/Object;+183
v  ~StubRoutines::call_stub
j
sun.reflect.NativeMethodAccessorImpl.invoke0(Ljava/lang/reflect/Method;Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;+0
j
sun.reflect.NativeMethodAccessorImpl.invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;+87
j
sun.reflect.DelegatingMethodAccessorImpl.invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;+6
j
java.lang.reflect.Method.invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;+161
j
org.eclipse.equinox.launcher.Main.invokeFramework([Ljava/lang/String;[Ljava/net/URL;)V+211
j  org.eclipse.equinox.launcher.Main.basicRun([Ljava/lang/String;)V+114
j  org.eclipse.equinox.launcher.Main.run([Ljava/lang/String;)I+4
j  org.eclipse.equinox.launcher.Main.main([Ljava/lang/String;)V+10
v  ~StubRoutines::call_stub

---------------  P R O C E S S  ---------------

Java Threads: ( => current thread )
  0x29549000 JavaThread "Worker-3" [_thread_blocked, id=5176,
stack(0x2a7d0000,0x2a820000)]
  0x29547400 JavaThread "AWT-Windows" daemon [_thread_in_vm, id=5768,
stack(0x2a780000,0x2a7d0000)]
  0x29541400 JavaThread "Java2D Disposer" daemon [_thread_blocked, id=2604,
stack(0x2a6e0000,0x2a730000)]
  0x294a5800 JavaThread "Reference Cleaner: 1" [_thread_blocked, id=2516,
stack(0x2a680000,0x2a6d0000)]
  0x2941ac00 JavaThread "pool-3-thread-1" [_thread_blocked, id=4336,
stack(0x2a4a0000,0x2a4f0000)]
  0x29388400 JavaThread "pool-1-thread-1" [_thread_blocked, id=192,
stack(0x29ef0000,0x29f40000)]
  0x2718ec00 JavaThread "Worker-0" [_thread_blocked, id=5664,
stack(0x29980000,0x299d0000)]
  0x27662800 JavaThread "WeakCollectionCleaner" daemon [_thread_blocked,
id=2616, stack(0x28300000,0x28350000)]
  0x274f5400 JavaThread "Timer-0" daemon [_thread_blocked, id=4636,
stack(0x282b0000,0x28300000)]
  0x2718a000 JavaThread "Start Level Event Dispatcher" daemon
[_thread_blocked, id=4396, stack(0x27340000,0x27390000)]
  0x271a7400 JavaThread "Framework Event Dispatcher" daemon
[_thread_blocked, id=3900, stack(0x272f0000,0x27340000)]
  0x2719a800 JavaThread "State Data Manager" daemon [_thread_in_vm, id=1952,
stack(0x272a0000,0x272f0000)]
  0x26c6c800 JavaThread "Low Memory Detector" daemon [_thread_blocked,
id=3308, stack(0x26fb0000,0x27000000)]
  0x26c69c00 JavaThread "CompilerThread0" daemon [_thread_blocked, id=3616,
stack(0x26f60000,0x26fb0000)]
  0x26c5c800 JavaThread "JDWP Command Reader" daemon [_thread_in_vm,
id=3752, stack(0x26f10000,0x26f60000)]
  0x26c5b000 JavaThread "JDWP Event Helper Thread" daemon [_thread_blocked,
id=4968, stack(0x26ec0000,0x26f10000)]
  0x26c58800 JavaThread "JDWP Transport Listener: dt_socket" daemon
[_thread_in_vm, id=3092, stack(0x26e70000,0x26ec0000)]
  0x26c4d800 JavaThread "Attach Listener" daemon [_thread_blocked, id=4296,
stack(0x26e00000,0x26e50000)]
  0x26c4c400 JavaThread "Signal Dispatcher" daemon [_thread_blocked,
id=5044, stack(0x26db0000,0x26e00000)]
  0x26c3c800 JavaThread "Finalizer" daemon [_thread_blocked, id=5700,
stack(0x26d60000,0x26db0000)]
  0x26c37c00 JavaThread "Reference Handler" daemon [_thread_blocked, id=496,
stack(0x26d10000,0x26d60000)]
=>0x00397000 JavaThread "main" [_thread_in_native, id=3452,
stack(0x003b0000,0x00400000)]

Other Threads:
  0x26c34400 VMThread [stack: 0x26cc0000,0x26d10000] [id=4004]
  0x26c80400 WatcherThread [stack: 0x27000000,0x27050000] [id=5116]

VM state:not at safepoint (normal execution)

VM Mutex/Monitor currently owned by a thread: None

Heap
 def new generation   total 2304K, used 414K [0x02970000, 0x02bf0000,
0x050d0000)
  eden space 2048K,   9% used [0x02970000, 0x029a2a60, 0x02b70000)
  from space 256K,  82% used [0x02bb0000, 0x02be5078, 0x02bf0000)
  to   space 256K,   0% used [0x02b70000, 0x02b70000, 0x02bb0000)
 tenured generation   total 29484K, used 20407K [0x050d0000, 0x06d9b000,
0x22970000)
   the space 29484K,  69% used [0x050d0000, 0x064bdf58, 0x064be000,
0x06d9b000)
 compacting perm gen  total 41472K, used 41308K [0x22970000, 0x251f0000,
0x26970000)
   the space 41472K,  99% used [0x22970000, 0x251c7060, 0x251c7200,
0x251f0000)
No shared spaces configured.

Dynamic libraries:
0x00400000 - 0x00424000     C:\java\JDKS\jdk1.6.0_12\bin\javaw.exe
0x7c900000 - 0x7c9b0000     C:\WINDOWS\system32\ntdll.dll
0x7c800000 - 0x7c8f4000     C:\WINDOWS\system32\kernel32.dll
0x77dd0000 - 0x77e6b000     C:\WINDOWS\system32\ADVAPI32.dll
0x77e70000 - 0x77f01000     C:\WINDOWS\system32\RPCRT4.dll
0x77d40000 - 0x77dd0000     C:\WINDOWS\system32\USER32.dll
0x77f10000 - 0x77f56000     C:\WINDOWS\system32\GDI32.dll
0x7c340000 - 0x7c396000     C:\java\JDKS\jdk1.6.0_12\jre\bin\msvcr71.dll
0x6d8b0000 - 0x6db06000     C:\java\JDKS\jdk1.6.0_12\jre\bin\client\jvm.dll
0x76b40000 - 0x76b6d000     C:\WINDOWS\system32\WINMM.dll
0x6d340000 - 0x6d348000     C:\java\JDKS\jdk1.6.0_12\jre\bin\hpi.dll
0x76bf0000 - 0x76bfb000     C:\WINDOWS\system32\PSAPI.DLL
0x6d430000 - 0x6d459000     C:\java\JDKS\jdk1.6.0_12\jre\bin\jdwp.dll
0x6d750000 - 0x6d756000     C:\java\JDKS\jdk1.6.0_12\jre\bin\npt.dll
0x6d860000 - 0x6d86c000     C:\java\JDKS\jdk1.6.0_12\jre\bin\verify.dll
0x6d3e0000 - 0x6d3ff000     C:\java\JDKS\jdk1.6.0_12\jre\bin\java.dll
0x6d8a0000 - 0x6d8af000     C:\java\JDKS\jdk1.6.0_12\jre\bin\zip.dll
0x6d2b0000 - 0x6d2b7000     C:\java\JDKS\jdk1.6.0_12\jre\bin\dt_socket.dll
0x71ab0000 - 0x71ac7000     C:\WINDOWS\system32\WS2_32.dll
0x77c10000 - 0x77c68000     C:\WINDOWS\system32\msvcrt.dll
0x71aa0000 - 0x71aa8000     C:\WINDOWS\system32\WS2HELP.dll
0x71a50000 - 0x71a8f000     C:\WINDOWS\System32\mswsock.dll
0x76f20000 - 0x76f47000     C:\WINDOWS\system32\DNSAPI.dll
0x76fb0000 - 0x76fb8000     C:\WINDOWS\System32\winrnr.dll
0x76f60000 - 0x76f8c000     C:\WINDOWS\system32\WLDAP32.dll
0x76fc0000 - 0x76fc6000     C:\WINDOWS\system32\rasadhlp.dll
0x662b0000 - 0x66308000     C:\WINDOWS\system32\hnetcfg.dll
0x71a90000 - 0x71a98000     C:\WINDOWS\System32\wshtcpip.dll
0x72000000 - 0x72014000
C:\java\RoltaGISDesktop_7.1.0.8_SDK_16-06-2009\plugins\org.eclipse.equinox.launcher.win32.win32.x86_1.0.101.R34x_v20080731\eclipse_1115.dll
0x773d0000 - 0x774d2000
C:\WINDOWS\WinSxS\x86_Microsoft.Windows.Common-Controls_6595b64144ccf1df_6.0.2600.2180_x-ww_a84f1ff9\COMCTL32.dll
0x77f60000 - 0x77fd6000     C:\WINDOWS\system32\SHLWAPI.dll
0x77c00000 - 0x77c08000     C:\WINDOWS\system32\VERSION.dll
0x5ad70000 - 0x5ada8000     C:\WINDOWS\system32\UxTheme.dll
0x27270000 - 0x27298000     C:\WINDOWS\system32\rsaenh.dll
0x769c0000 - 0x76a73000     C:\WINDOWS\system32\USERENV.dll
0x5b860000 - 0x5b8b4000     C:\WINDOWS\system32\netapi32.dll
0x6d6c0000 - 0x6d6d3000     C:\java\JDKS\jdk1.6.0_12\jre\bin\net.dll
0x6d6e0000 - 0x6d6e9000     C:\java\JDKS\jdk1.6.0_12\jre\bin\nio.dll
0x6d0b0000 - 0x6d1fa000     C:\java\JDKS\jdk1.6.0_12\jre\bin\awt.dll
0x73000000 - 0x73026000     C:\WINDOWS\system32\WINSPOOL.DRV
0x76390000 - 0x763ad000     C:\WINDOWS\system32\IMM32.dll
0x774e0000 - 0x7761d000     C:\WINDOWS\system32\ole32.dll
0x277b0000 - 0x277bb000     C:\java\eclipse\jre\bin\clib_jiio_util.dll
0x277d0000 - 0x278dc000     C:\java\eclipse\jre\bin\clib_jiio_sse2.dll
0x278f0000 - 0x27905000     C:\java\eclipse\jre\bin\gdaljni.dll
0x27910000 - 0x2806a000     C:\java\eclipse\jre\bin\gdal14.dll
0x74320000 - 0x7435d000     C:\WINDOWS\system32\ODBC32.dll
0x7c9c0000 - 0x7d1d4000     C:\WINDOWS\system32\SHELL32.dll
0x763b0000 - 0x763f9000     C:\WINDOWS\system32\comdlg32.dll
0x78520000 - 0x785c3000
C:\WINDOWS\WinSxS\x86_Microsoft.VC90.CRT_1fc8b3b9a1e18e3b_9.0.30729.1_x-ww_6f74963e\MSVCR90.dll
0x78480000 - 0x7850e000
C:\WINDOWS\WinSxS\x86_Microsoft.VC90.CRT_1fc8b3b9a1e18e3b_9.0.30729.1_x-ww_6f74963e\MSVCP90.dll
0x7c3a0000 - 0x7c41b000     C:\WINDOWS\system32\MSVCP71.dll
0x28180000 - 0x28197000     C:\WINDOWS\system32\odbcint.dll
0x28350000 - 0x283a5000
E:\SRC\MyWorkspace\.metadata\.plugins\org.eclipse.pde.core\uDig\org.eclipse.osgi\bundles\937\1\.cp\swt-win32-3449.dll
0x77120000 - 0x771ac000     C:\WINDOWS\system32\OLEAUT32.dll
0x74d90000 - 0x74dfb000     C:\WINDOWS\system32\USP10.dll
0x771b0000 - 0x77256000     C:\WINDOWS\system32\WININET.dll
0x77a80000 - 0x77b14000     C:\WINDOWS\system32\CRYPT32.dll
0x77b20000 - 0x77b32000     C:\WINDOWS\system32\MSASN1.dll
0x283f0000 - 0x28404000
E:\SRC\MyWorkspace\.metadata\.plugins\org.eclipse.pde.core\uDig\org.eclipse.osgi\bundles\937\1\.cp\swt-gdip-win32-3449.dll
0x4ec50000 - 0x4edf3000
C:\WINDOWS\WinSxS\x86_Microsoft.Windows.GdiPlus_6595b64144ccf1df_1.0.2600.2180_x-ww_522f9f82\gdiplus.dll
0x28440000 - 0x28448000     C:\java\eclipse\bin\rgisf.dll
0x74c80000 - 0x74cac000     C:\WINDOWS\system32\oleacc.dll
0x76080000 - 0x760e5000     C:\WINDOWS\system32\MSVCP60.dll
0x29af0000 - 0x29db5000     C:\WINDOWS\system32\xpsp2res.dll
0x76380000 - 0x76385000     C:\WINDOWS\system32\msimg32.dll
0x76fd0000 - 0x7704f000     C:\WINDOWS\system32\CLBCATQ.DLL
0x77050000 - 0x77115000     C:\WINDOWS\system32\COMRes.dll
0x77760000 - 0x778cc000     C:\WINDOWS\system32\shdocvw.dll
0x754d0000 - 0x75550000     C:\WINDOWS\system32\CRYPTUI.dll
0x76c30000 - 0x76c5e000     C:\WINDOWS\system32\WINTRUST.dll
0x76c90000 - 0x76cb8000     C:\WINDOWS\system32\IMAGEHLP.dll
0x77fe0000 - 0x77ff1000     C:\WINDOWS\system32\Secur32.dll
0x77260000 - 0x772fc000     C:\WINDOWS\system32\urlmon.dll
0x77b40000 - 0x77b62000     C:\WINDOWS\system32\appHelp.dll
0x77a20000 - 0x77a74000     C:\WINDOWS\System32\cscui.dll
0x76600000 - 0x7661d000     C:\WINDOWS\System32\CSCDLL.dll
0x75f80000 - 0x7607c000     C:\WINDOWS\system32\browseui.dll
0x77920000 - 0x77a13000     C:\WINDOWS\system32\SETUPAPI.dll
0x76980000 - 0x76988000     C:\WINDOWS\system32\LINKINFO.dll
0x76990000 - 0x769b5000     C:\WINDOWS\system32\ntshrui.dll
0x76b20000 - 0x76b31000     C:\WINDOWS\system32\ATL.DLL
0x71b20000 - 0x71b32000     C:\WINDOWS\system32\MPR.dll
0x2a370000 - 0x2a381000     C:\WINDOWS\system32\ccasenp.dll
0x75f60000 - 0x75f67000     C:\WINDOWS\System32\drprov.dll
0x71c10000 - 0x71c1e000     C:\WINDOWS\System32\ntlanman.dll
0x71cd0000 - 0x71ce7000     C:\WINDOWS\System32\NETUI0.dll
0x71c90000 - 0x71cd0000     C:\WINDOWS\System32\NETUI1.dll
0x71c80000 - 0x71c87000     C:\WINDOWS\System32\NETRAP.dll
0x71bf0000 - 0x71c03000     C:\WINDOWS\System32\SAMLIB.dll
0x75f70000 - 0x75f79000     C:\WINDOWS\System32\davclnt.dll
0x6d2e0000 - 0x6d334000     C:\java\JDKS\jdk1.6.0_12\jre\bin\fontmanager.dll
0x4fdd0000 - 0x4ff76000     C:\WINDOWS\system32\d3d9.dll
0x299f0000 - 0x299f6000     C:\WINDOWS\system32\d3d8thk.dll
0x6d250000 - 0x6d273000     C:\java\JDKS\jdk1.6.0_12\jre\bin\dcpr.dll
0x2a970000 - 0x2a982000     C:\java\eclipse\jre\bin\ogrjni.dll

VM Arguments:
jvm_args:
-agentlib:jdwp=transport=dt_socket,suspend=y,address=localhost:4046 -Xmx512m
-Dosgi.parentClassloader=ext -Dfile.encoding=Cp1252
java_command: org.eclipse.equinox.launcher.Main -launcher
C:\java\RoltaGISDesktop_7.1.0.8_SDK_16-06-2009\eclipse.exe -name Eclipse
-showsplash 600 -product com.rolta.gis.launcher.RoltaGISFramework -data
E:\SRC\MyWorkspace/../runtime-New_configuration -configuration
file:E:/SRC/MyWorkspace/.metadata/.plugins/org.eclipse.pde.core/uDig/ -dev
file:E:/SRC/MyWorkspace/.metadata/.plugins/org.eclipse.pde.core/uDig/dev.properties
-os win32 -ws win32 -arch x86 -nl en_US -consoleLog -verbose
Launcher Type: SUN_STANDARD

Environment Variables:
JAVA_HOME=C:\java\JDKS\jdk1.6.0_12
PATH=C:\java\JDKS\jdk1.6.0_12\jre\bin;C:/java/eclipse/jre/bin/client;C:/java/eclipse/jre/bin;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\java\JDKS\jdk1.6.0_12\bin;C:\Ant\bin;C:\Cygwin\bin;C:\Program
Files\Rational\common;C:\Program
Files\Rational\ClearCase\bin;D:\Nilesh\src\RoltaGISFrameWorkLicensing\RoltaGISFrameWorkLicensing\Release
USERNAME=nilesh.choure
OS=Windows_NT
PROCESSOR_IDENTIFIER=x86 Family 15 Model 4 Stepping 1, GenuineIntel



---------------  S Y S T E M  ---------------

OS: Windows XP Build 2600 Service Pack 2

CPU:total 1 (1 cores per cpu, 2 threads per core) family 15 model 4 stepping
1, cmov, cx8, fxsr, mmx, sse, sse2, sse3, ht

Memory: 4k page, physical 1046596k(111732k free), swap 3040608k(1900620k
free)

vm_info: Java HotSpot(TM) Client VM (11.2-b01) for windows-x86 JRE
(1.6.0_12-b04), built on Jan 17 2009 09:57:14 by "java_re" with MS VC++ 7.1

time: Mon Jul 06 11:10:42 2009
elapsed time: 3609 seconds

*********************************************************************************************************************************************************************************************


-- 
Thanks & regards,
Nilesh Choure
nilesh.gis@gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090707/a242f24c/attachment-0001.html
From warmerdam at pobox.com  Wed Jul  8 10:50:21 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Jul  8 10:50:25 2009
Subject: [gdal-dev] Getting exception while creating OGR geometry from
	WKT with huge number of vertices
In-Reply-To: <c907ad1d0907062332r60f27159i510b4da300957b8f@mail.gmail.com>
References: <c907ad1d0907062332r60f27159i510b4da300957b8f@mail.gmail.com>
Message-ID: <4A54B22D.2020409@pobox.com>

Nilesh Choure wrote:
> Hi,
> 
> I am trying to write features from shape file into DGN file from my 
> application. I am using swig generated java interfaces. I am able to 
> write features with point and simple line geometries without any problem 
> but when it comes across a feature which is either multilinestring or 
> multipolygon with very large number of vertices more than 2000 it 
> crashes. Following is a error log generated.
> 
> When I debuged gdal implementation and my application I found that the 
> ogr implementation does create the geometry object but when it returns 
> from the function it throws following access violation exception. I have 
> searched the couple of post on net and found that it is related with 
> size of data.
> 
> Any help or suggestion in this regard is appreciated.
> Please reply if you need more information if above is not sufficient. 

...
> Stack: [0x003b0000,0x00400000],  sp=0x003feb2c,  free space=314k
> Native frames: (J=compiled Java code, j=interpreted, Vv=VM code, 
> C=native code)
> C  [ntdll.dll+0x2ae22]
> C  [msvcr71.dll+0x218a]
> V  [jvm.dll+0xd029e]
> C  [ogrjni.dll+0x72ef]
> j  
> org.gdal.ogr.ogrJNI.CreateGeometryFromWkt(Ljava/lang/String;JLorg/gdal/osr/SpatialReference;)J+0
> j  
> org.gdal.ogr.ogr.CreateGeometryFromWkt(Ljava/lang/String;Lorg/gdal/osr/SpatialReference;)Lorg/gdal/ogr/Geometry;+6
> j  

Nilesh,

For the most part the java vm crash info doesn't help me much.  But if the
crash is specifically in CreateGeometryFromWkt(), perhaps we can reproduce a
problem at the C++ API level.  Can you provide the WKT string that triggers
the crash (perhaps as a zip'ed text file directly to me?)

What version of GDAL/OGR are you using?   Where did you get your build
of GDAL and the java bindings?

If I can't reproduce it at the C++ level, we will likely need to isolate
a demonstration of the problem in a minimal Java program, and try to
establish the particulars of your software version, etc.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From sorokina at ornl.gov  Wed Jul  8 12:24:36 2009
From: sorokina at ornl.gov (Sorokine, Alexandre)
Date: Wed Jul  8 12:25:29 2009
Subject: [gdal-dev] OGR is not able to determine PostGIS table SRS
In-Reply-To: <4A540E1B.9090202@pobox.com>
Message-ID: <C67A4085.E336%SorokinA@ornl.gov>

Frank,

> Actually, I suspect the debug facilities in trunk for the OGR PG driver
> have been upgraded.  Would it be practical for you to try things with trunk?

I did some more debugging with the version from the trunk checked out around
10AM EST today.  I compiled it on OSX with macports as:

/configure --prefix=/Users/sorokine/Documents/appl/gdalsvninst
--with-pg=/opt/local/lib/postgresql83/bin/pg_config
--with-netcdf=/opt/local --enable-debug && make -j7 && make install

Results of running ogrinfo are in the file in the attachment (ogrinfo with
debug plus postgresql staements from logs).  My observations is that trunk
version solves some of the problems but other problems persist:

1.  Trunk version (compared to 1.6.0)  properly sets SRID for the WHERE
clause with the bounding box:

PG: OGRPGTableLayer::BuildWhere returns: WHERE "the_geom" &&
SetSRID('BOX3D(-178.217606000000 18.921785000000, -66.969269000000
71.406242000000)'::box3d,4326)

Compare to 1.6.0:

PG: OGRPGTableLayer::BuildWhere returns: WHERE the_geom &&
SetSRID('BOX3D(-178.217606000000 18.921785000000, -66.969269000000
71.406242000000)'::box3d,-1)

2.  Trunk version does NOT fix reporting of SRS through
OGR_L_GetSpatialRef(layer) or OGR_F_GetSpatialReferemce(feature), both
return NULL.  I've tested it in my code and you can see that in trunk
ogrinfo output:

Layer SRS WKT:
(unknown)

3.  Trunk version doe not properly set bounding box SRS through
OGR_L_SetSpatialFilterRect() function.  I've tested it in my code.  Bounding
box works in ogrinfo but ogrinfo does not use this function (it builds a
geometry).

I hope we will be able to fix it,

On 7/7/09 11:10 PM, "Frank Warmerdam" <warmerdam@pobox.com> wrote:

> Sorokine, Alexandre wrote:
>> Franks,
>> 
>> Thank you for your reply, I did some more checks.  Please see my comments
>> below.
> 
> Alexandre,
> 
> I'm still wondering if this is related to schemas.  I was surprised to not
> see any queries against the spatial_ref_sys table.  In my trunk build I see
> something like:
> 
> PG: PQexec(SELECT srtext FROM spatial_ref_sys WHERE srid = 4326) =
> PGRES_TUPLES_OK, ntuples = 1
> 
> 
> Best regards,
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
> 
> 

-- 
Alex Sorokine
mailto:SorokinA@ornl.gov


-------------- next part --------------
===== gdal svn trunk

$ CPL_DEBUG=ON ../gdalsvninst/bin/ogrinfo -al -ro PG:'host=geodb dbname=usa tables=census.counties' -spat -178.217606 18.921785 -66.969269 71.406242 | head -80
PG: DBName="usa"
PG: PQexec(SELECT version()) = PGRES_TUPLES_OK, ntuples = 1
PG: PostgreSQL version string : 'PostgreSQL 8.3.7 on x86_64-pc-linux-gnu, compiled by GCC cc (GCC) 4.2.4 (Ubuntu 4.2.4-1ubuntu3)'
PG: PQexec(BEGIN) = PGRES_COMMAND_OK
PG: PQexec(SELECT oid FROM pg_type WHERE typname = 'geometry') = PGRES_TUPLES_OK, ntuples = 1
PG: PQexec(SELECT postgis_version()) = PGRES_TUPLES_OK, ntuples = 1
PG: PostGIS version string : '1.3 USE_GEOS=1 USE_PROJ=1 USE_STATS=1'
PG: PQexec(SET ENABLE_SEQSCAN = ON) = PGRES_COMMAND_OK
PG: PQexec(COMMIT) = PGRES_COMMAND_OK
PG: PQexec(SELECT current_schema()) = PGRES_TUPLES_OK, ntuples = 1
PG: PQexec(SELECT a.attname, a.attnum, t.typname, t.typname = ANY(ARRAY['int2','int4','serial']) AS isfid FROM pg_class c, pg_attribute a, pg_type t, pg_namespace n, pg_index i WHERE a.attnum > 0 AND a.attrelid = c.oid AND a.atttypid = t.oid AND c.relnamespace = n.oid AND c.oid = i.indrelid AND i.indisprimary = 't' AND t.typname !~ '^geom' AND c.relname = 'counties' AND (i.indkey[0]=a.attnum OR i.indkey[1]=a.attnum OR i.indkey[2]=a.attnum OR i.indkey[3]=a.attnum OR i.indkey[4]=a.attnum OR i.indkey[5]=a.attnum OR i.indkey[6]=a.attnum OR i.indkey[7]=a.attnum OR i.indkey[8]=a.attnum OR i.indkey[9]=a.attnum) AND n.nspname='census' ORDER BY a.attnum) = PGRES_TUPLES_OK, ntuples = 1
PG: Primary key name (FID): gid
PG: PQexec(BEGIN) = PGRES_COMMAND_OK
PG: PQexec(DECLARE mycursor CURSOR for SELECT DISTINCT a.attname, t.typname, a.attlen,       format_type(a.atttypid,a.atttypmod) FROM pg_class c, pg_attribute a, pg_type t, pg_namespace n WHERE c.relname = 'counties' AND a.attnum > 0 AND a.attrelid = c.oid AND a.atttypid = t.oid AND c.relnamespace=n.oid AND n.nspname='census') = PGRES_COMMAND_OK
PG: PQexec(FETCH ALL in mycursor) = PGRES_TUPLES_OK, ntuples = 51
PG: Using column 'gid' as FID for table 'counties'
PG: PQexec(CLOSE mycursor) = PGRES_COMMAND_OK
PG: PQexec(COMMIT) = PGRES_COMMAND_OK
PG: PQexec(SELECT type, coord_dimension, srid FROM geometry_columns WHERE f_table_name='counties' AND f_geometry_column='the_geom' AND f_table_schema='census') = PGRES_TUPLES_OK, ntuples = 1
PG: Layer 'counties' geometry type: MULTIPOLYGON:Multi Polygon, Dim=2
OGR: OGROpen(PG:host=geodb dbname=usa tables=census.counties/0x1700e50) succeeded as PostgreSQL.
OGR: GetLayerCount() = 1

PG: bHasPostGISGeometry == TRUE
PG: OGRPGTableLayer::BuildWhere returns: WHERE "the_geom" && SetSRID('BOX3D(-178.217606000000 18.921785000000, -66.969269000000 71.406242000000)'::box3d,4326) 
PG: PQexec(SELECT count(*) FROM "census"."counties" WHERE "the_geom" && SetSRID('BOX3D(-178.217606000000 18.921785000000, -66.969269000000 71.406242000000)'::box3d,4326) ) = PGRES_TUPLES_OK, ntuples = 1
PG: PQexec(SELECT Extent("the_geom") FROM "census"."counties") = PGRES_TUPLES_OK, ntuples = 1
PG: PQexec(BEGIN) = PGRES_COMMAND_OK
PG: PQexec(SELECT srtext FROM spatial_ref_sys WHERE srid = 4326) = PGRES_TUPLES_OK, ntuples = 0
PG: PQexec(COMMIT) = PGRES_COMMAND_OK
PG: PQexec(BEGIN) = PGRES_COMMAND_OK
PG: PQexec(DECLARE OGRPGLayerReader CURSOR for SELECT "gid", AsEWKT("the_geom"), "age_18_21", "age_22_29", "age_30_39", "age_40_49", "age_50_64", "age_5_17", "age_65_up", "age_under5", "ameri_es", "asian", "ave_fam_sz", "ave_hh_sz", "avg_sale97", "avg_size97", "black", "cnty_fips", "crop_acr97", "families", "females", "fhh_child", "fips", "hawn_pi", "hispanic", "households", "hse_units", "hsehld_1_f", "hsehld_1_m", "males", "marhh_chd", "marhh_no_c", "med_age", "med_age_f", "med_age_m", "mhh_child", "mult_race", "name", "no_farms97", "other", "owner_occ", "pop00_sqmi", "pop07_sqmi", "pop2000", "pop2007", "renter_occ", "sqmi", "state_fips", "state_name", "vacant", "white" FROM "census"."counties" WHERE "the_geom" && SetSRID('BOX3D(-178.217606000000 18.921785000000, -66.969269000000 71.406242000000)'::box3d,4326) ) = PGRES_COMMAND_OK
PG: PQexec(FETCH 500 in OGRPGLayerReader) = PGRES_TUPLES_OK, ntuples = 500
INFO: Open of `PG:host=geodb dbname=usa tables=census.counties'
      using driver `PostgreSQL' successful.
INFO: Internal data source name `PG:host=geodb dbname=usa '
      different from user name `PG:host=geodb dbname=usa tables=census.counties'.

Layer name: census.counties
Geometry: Multi Polygon
Feature Count: 3141
Extent: (-178.217606, 18.921785) - (-66.969269, 71.406242)
Layer SRS WKT:
(unknown)
FID Column = gid
Geometry Column = the_geom
age_18_21: Integer (0.0)
age_22_29: Integer (0.0)
age_30_39: Integer (0.0)
age_40_49: Integer (0.0)
age_50_64: Integer (0.0)
age_5_17: Integer (0.0)
age_65_up: Integer (0.0)
age_under5: Integer (0.0)
ameri_es: Integer (0.0)
asian: Integer (0.0)
ave_fam_sz: Real (0.0)
ave_hh_sz: Real (0.0)
avg_sale97: Real (0.0)
avg_size97: Integer (0.0)
black: Integer (0.0)
cnty_fips: String (3.0)
crop_acr97: Integer (0.0)
families: Integer (0.0)
females: Integer (0.0)
fhh_child: Integer (0.0)
fips: String (5.0)
hawn_pi: Integer (0.0)
hispanic: Integer (0.0)
households: Integer (0.0)
hse_units: Integer (0.0)
hsehld_1_f: Integer (0.0)
hsehld_1_m: Integer (0.0)
males: Integer (0.0)
marhh_chd: Integer (0.0)
marhh_no_c: Integer (0.0)
med_age: Real (0.0)
med_age_f: Real (0.0)
med_age_m: Real (0.0)
mhh_child: Integer (0.0)
mult_race: Integer (0.0)
name: String (32.0)
no_farms97: Integer (0.0)
other: Integer (0.0)
owner_occ: Integer (0.0)
pop00_sqmi: Real (0.0)
pop07_sqmi: Real (0.0)
pop2000: Integer (0.0)
pop2007: Integer (0.0)
renter_occ: Integer (0.0)
sqmi: Real (0.0)
state_fips: String (2.0)
state_name: String (25.0)
vacant: Integer (0.0)
white: Integer (0.0)
OGRFeature(census.counties):1
  age_18_21 (Integer) = 149
  age_22_29 (Integer) = 282
  age_30_39 (Integer) = 588
....

==== statements from the postgresql log:

2009-07-08 12:03:21 EDT LOG:  statement: set client_encoding to 'UNICODE'
2009-07-08 12:03:21 EDT LOG:  statement: SELECT version()
2009-07-08 12:03:21 EDT LOG:  statement: BEGIN
2009-07-08 12:03:21 EDT LOG:  statement: SELECT oid FROM pg_type WHERE typname = 'geometry'
2009-07-08 12:03:21 EDT LOG:  statement: SELECT postgis_version()
2009-07-08 12:03:21 EDT LOG:  statement: SET ENABLE_SEQSCAN = ON
2009-07-08 12:03:21 EDT LOG:  statement: COMMIT
2009-07-08 12:03:21 EDT LOG:  statement: SELECT current_schema()
2009-07-08 12:03:21 EDT LOG:  statement: SELECT a.attname, a.attnum, t.typname, t.typname = ANY(ARRAY['int2','int4','serial']) AS isfid FROM pg_class c, pg_attribute a, pg_type t, pg_namespace n, pg_index i WHERE a.attnum > 0 AND a.attrelid = c.oid AND a.atttypid = t.oid AND c.relnamespace = n.oid AND c.oid = i.indrelid AND i.indisprimary = 't' AND t.typname !~ '^geom' AND c.relname = 'counties' AND (i.indkey[0]=a.attnum OR i.indkey[1]=a.attnum OR i.indkey[2]=a.attnum OR i.indkey[3]=a.attnum OR i.indkey[4]=a.attnum OR i.indkey[5]=a.attnum OR i.indkey[6]=a.attnum OR i.indkey[7]=a.attnum OR i.indkey[8]=a.attnum OR i.indkey[9]=a.attnum) AND n.nspname='census' ORDER BY a.attnum
2009-07-08 12:03:21 EDT LOG:  statement: BEGIN
2009-07-08 12:03:21 EDT LOG:  statement: DECLARE mycursor CURSOR for SELECT DISTINCT a.attname, t.typname, a.attlen,       format_type(a.atttypid,a.atttypmod) FROM pg_class c, pg_attribute a, pg_type t, pg_namespace n WHERE c.relname = 'counties' AND a.attnum > 0 AND a.attrelid = c.oid AND a.atttypid = t.oid AND c.relnamespace=n.oid AND n.nspname='census'
2009-07-08 12:03:21 EDT LOG:  statement: FETCH ALL in mycursor
2009-07-08 12:03:21 EDT LOG:  statement: CLOSE mycursor
2009-07-08 12:03:21 EDT LOG:  statement: COMMIT
2009-07-08 12:03:21 EDT LOG:  statement: SELECT type, coord_dimension, srid FROM geometry_columns WHERE f_table_name='counties' AND f_geometry_column='the_geom' AND f_table_schema='census'
2009-07-08 12:03:21 EDT LOG:  statement: SELECT count(*) FROM "census"."counties" WHERE "the_geom" && SetSRID('BOX3D(-178.217606000000 18.921785000000, -66.969269000000 71.406242000000)'::box3d,4326) 
2009-07-08 12:03:21 EDT LOG:  statement: SELECT Extent("the_geom") FROM "census"."counties"
2009-07-08 12:03:21 EDT LOG:  statement: BEGIN
2009-07-08 12:03:21 EDT LOG:  statement: SELECT srtext FROM spatial_ref_sys WHERE srid = 4326
2009-07-08 12:03:21 EDT LOG:  statement: COMMIT
2009-07-08 12:03:21 EDT LOG:  statement: BEGIN
2009-07-08 12:03:21 EDT LOG:  statement: DECLARE OGRPGLayerReader CURSOR for SELECT "gid", AsEWKT("the_geom"), "age_18_21", "age_22_29", "age_30_39", "age_40_49", "age_50_64", "age_5_17", "age_65_up", "age_under5", "ameri_es", "asian", "ave_fam_sz", "ave_hh_sz", "avg_sale97", "avg_size97", "black", "cnty_fips", "crop_acr97", "families", "females", "fhh_child", "fips", "hawn_pi", "hispanic", "households", "hse_units", "hsehld_1_f", "hsehld_1_m", "males", "marhh_chd", "marhh_no_c", "med_age", "med_age_f", "med_age_m", "mhh_child", "mult_race", "name", "no_farms97", "other", "owner_occ", "pop00_sqmi", "pop07_sqmi", "pop2000", "pop2007", "renter_occ", "sqmi", "state_fips", "state_name", "vacant", "white" FROM "census"."counties" WHERE "the_geom" && SetSRID('BOX3D(-178.217606000000 18.921785000000, -66.969269000000 71.406242000000)'::box3d,4326) 
2009-07-08 12:03:21 EDT LOG:  statement: FETCH 500 in OGRPGLayerReader
2009-07-08 12:03:21 EDT LOG:  could not receive data from client: Connection reset by peer
2009-07-08 12:03:21 EDT LOG:  unexpected EOF on client connection

==== for comparison gdal 1.6.0

$ CPL_DEBUG=ON ogrinfo -al -ro PG:'host=geodb dbname=usa tables=census.counties' -spat -178.217606 18.921785 -66.969269 71.406242 | head -80
PG: DBName="usa"
PG: PostgreSQL version string : 'PostgreSQL 8.3.7 on x86_64-pc-linux-gnu, compiled by GCC cc (GCC) 4.2.4 (Ubuntu 4.2.4-1ubuntu3)'
PG: PostGIS version string : '1.3 USE_GEOS=1 USE_PROJ=1 USE_STATS=1'
PG: Primary key name (FID): gid
PG: Using column 'gid' as FID for table 'counties'
OGR: OGROpen(PG:host=geodb dbname=usa tables=census.counties/0x1000ad0) succeeded as PostgreSQL.
OGR: GetLayerCount() = 1

PG: bHasPostGISGeometry == TRUE
PG: OGRPGTableLayer::BuildWhere returns: WHERE the_geom && SetSRID('BOX3D(-178.217606000000 18.921785000000, -66.969269000000 71.406242000000)'::box3d,-1) 
PG: PQexec(SELECT count(*) FROM "census"."counties" WHERE the_geom && SetSRID('BOX3D(-178.217606000000 18.921785000000, -66.969269000000 71.406242000000)'::box3d,-1) )

PG: SELECT count(*) FROM "census"."counties" WHERE the_geom && SetSRID('BOX3D(-178.217606000000 18.921785000000, -66.969269000000 71.406242000000)'::box3d,-1) ; failed.
PG: PQexec(SELECT Extent("the_geom") FROM "census"."counties")

PG: PQexec(DECLARE OGRPGLayerReader CURSOR for SELECT "gid", AsEWKT("the_geom"), "age_18_21", "age_22_29", "age_30_39", "age_40_49", "age_50_64", "age_5_17", "age_65_up", "age_under5", "ameri_es", "asian", "ave_fam_sz", "ave_hh_sz", "avg_sale97", "avg_size97", "black", "cnty_fips", "crop_acr97", "families", "females", "fhh_child", "fips", "hawn_pi", "hispanic", "households", "hse_units", "hsehld_1_f", "hsehld_1_m", "males", "marhh_chd", "marhh_no_c", "med_age", "med_age_f", "med_age_m", "mhh_child", "mult_race", "name", "no_farms97", "other", "owner_occ", "pop00_sqmi", "pop07_sqmi", "pop2000", "pop2007", "renter_occ", "sqmi", "state_fips", "state_name", "vacant", "white" FROM "census"."counties" WHERE the_geom && SetSRID('BOX3D(-178.217606000000 18.921785000000, -66.969269000000 71.406242000000)'::box3d,-1) )
PG: PQclear() on an error condition
INFO: Open of `PG:host=geodb dbname=usa tables=census.counties'
      using driver `PostgreSQL' successful.
INFO: Internal data source name `PG:host=geodb dbname=usa '
      different from user name `PG:host=geodb dbname=usa tables=census.counties'.

Layer name: census.counties
Geometry: Unknown (any)
Feature Count: 0
Extent: (-178.217606, 18.921785) - (-66.969269, 71.406242)
Layer SRS WKT:
(unknown)
FID Column = gid
Geometry Column = the_geom
age_18_21: Integer (0.0)
age_22_29: Integer (0.0)
age_30_39: Integer (0.0)
age_40_49: Integer (0.0)
age_50_64: Integer (0.0)
age_5_17: Integer (0.0)
age_65_up: Integer (0.0)
age_under5: Integer (0.0)
ameri_es: Integer (0.0)
asian: Integer (0.0)
ave_fam_sz: Real (0.0)
ave_hh_sz: Real (0.0)
avg_sale97: Real (0.0)
avg_size97: Integer (0.0)
black: Integer (0.0)
cnty_fips: String (3.0)
crop_acr97: Integer (0.0)
families: Integer (0.0)
females: Integer (0.0)
fhh_child: Integer (0.0)
fips: String (5.0)
hawn_pi: Integer (0.0)
hispanic: Integer (0.0)
households: Integer (0.0)
hse_units: Integer (0.0)
hsehld_1_f: Integer (0.0)
hsehld_1_m: Integer (0.0)
males: Integer (0.0)
marhh_chd: Integer (0.0)
marhh_no_c: Integer (0.0)
med_age: Real (0.0)
med_age_f: Real (0.0)
med_age_m: Real (0.0)
mhh_child: Integer (0.0)
mult_race: Integer (0.0)
name: String (32.0)
no_farms97: Integer (0.0)
other: Integer (0.0)
owner_occ: Integer (0.0)
pop00_sqmi: Real (0.0)
pop07_sqmi: Real (0.0)
pop2000: Integer (0.0)
pop2007: Integer (0.0)
renter_occ: Integer (0.0)
sqmi: Real (0.0)
state_fips: String (2.0)
state_name: String (25.0)
vacant: Integer (0.0)
white: Integer (0.0)

====== statements for postgresql log for gdal 1.6.0

2009-07-08 12:05:39 EDT LOG:  statement: set client_encoding to 'UNICODE'
2009-07-08 12:05:39 EDT LOG:  statement: SELECT version()
2009-07-08 12:05:39 EDT LOG:  statement: BEGIN
2009-07-08 12:05:39 EDT LOG:  statement: SELECT oid FROM pg_type WHERE typname = 'geometry'
2009-07-08 12:05:39 EDT LOG:  statement: SELECT postgis_version()
2009-07-08 12:05:39 EDT LOG:  statement: SET ENABLE_SEQSCAN = ON
2009-07-08 12:05:39 EDT LOG:  statement: COMMIT
2009-07-08 12:05:39 EDT LOG:  statement: SELECT current_schema()
2009-07-08 12:05:39 EDT LOG:  statement: SELECT a.attname, a.attnum, t.typname, t.typname = ANY(ARRAY['int2','int4','serial']) AS isfid FROM pg_class c, pg_attribute a, pg_type t, pg_namespace n, pg_index i WHERE a.attnum > 0 AND a.attrelid = c.oid AND a.atttypid = t.oid AND c.relnamespace = n.oid AND c.oid = i.indrelid AND i.indisprimary = 't' AND t.typname !~ '^geom' AND c.relname = 'counties' AND (i.indkey[0]=a.attnum OR i.indkey[1]=a.attnum OR i.indkey[2]=a.attnum OR i.indkey[3]=a.attnum OR i.indkey[4]=a.attnum OR i.indkey[5]=a.attnum OR i.indkey[6]=a.attnum OR i.indkey[7]=a.attnum OR i.indkey[8]=a.attnum OR i.indkey[9]=a.attnum) AND n.nspname='census' ORDER BY a.attnum
2009-07-08 12:05:39 EDT LOG:  statement: BEGIN
2009-07-08 12:05:39 EDT LOG:  statement: DECLARE mycursor CURSOR for SELECT DISTINCT a.attname, t.typname, a.attlen,       format_type(a.atttypid,a.atttypmod) FROM pg_class c, pg_attribute a, pg_type t, pg_namespace n WHERE c.relname = 'counties' AND a.attnum > 0 AND a.attrelid = c.oid AND a.atttypid = t.oid AND c.relnamespace=n.oid AND n.nspname='census'
2009-07-08 12:05:39 EDT LOG:  statement: FETCH ALL in mycursor
2009-07-08 12:05:39 EDT LOG:  statement: CLOSE mycursor
2009-07-08 12:05:39 EDT LOG:  statement: COMMIT
2009-07-08 12:05:39 EDT LOG:  statement: SELECT type, coord_dimension FROM geometry_columns WHERE f_table_name='counties' AND f_geometry_column='the_geom'
2009-07-08 12:05:39 EDT LOG:  statement: SELECT pg_class.relname FROM pg_class WHERE oid = (SELECT pg_inherits.inhparent FROM pg_inherits WHERE inhrelid = (SELECT pg_class.oid FROM pg_class WHERE relname = 'counties'))
2009-07-08 12:05:39 EDT ERROR:  more than one row returned by a subquery used as an expression
2009-07-08 12:05:39 EDT STATEMENT:  SELECT pg_class.relname FROM pg_class WHERE oid = (SELECT pg_inherits.inhparent FROM pg_inherits WHERE inhrelid = (SELECT pg_class.oid FROM pg_class WHERE relname = 'counties'))
2009-07-08 12:05:39 EDT LOG:  statement: BEGIN
2009-07-08 12:05:39 EDT LOG:  statement: SELECT srid FROM geometry_columns WHERE f_table_name = 'counties' AND f_geometry_column = 'the_geom' AND f_table_schema = 'census'
2009-07-08 12:05:39 EDT LOG:  statement: COMMIT
2009-07-08 12:05:39 EDT LOG:  statement: BEGIN
2009-07-08 12:05:39 EDT LOG:  statement: SELECT srtext FROM spatial_ref_sys WHERE srid = 4326
2009-07-08 12:05:39 EDT LOG:  statement: COMMIT
2009-07-08 12:05:39 EDT LOG:  statement: SELECT count(*) FROM "census"."counties" WHERE the_geom && SetSRID('BOX3D(-178.217606000000 18.921785000000, -66.969269000000 71.406242000000)'::box3d,-1) 
2009-07-08 12:05:39 EDT ERROR:  Operation on two geometries with different SRIDs
2009-07-08 12:05:39 EDT STATEMENT:  SELECT count(*) FROM "census"."counties" WHERE the_geom && SetSRID('BOX3D(-178.217606000000 18.921785000000, -66.969269000000 71.406242000000)'::box3d,-1) 
2009-07-08 12:05:39 EDT LOG:  statement: SELECT Extent("the_geom") FROM "census"."counties"
2009-07-08 12:05:39 EDT LOG:  statement: BEGIN
2009-07-08 12:05:39 EDT LOG:  statement: DECLARE OGRPGLayerReader CURSOR for SELECT "gid", AsEWKT("the_geom"), "age_18_21", "age_22_29", "age_30_39", "age_40_49", "age_50_64", "age_5_17", "age_65_up", "age_under5", "ameri_es", "asian", "ave_fam_sz", "ave_hh_sz", "avg_sale97", "avg_size97", "black", "cnty_fips", "crop_acr97", "families", "females", "fhh_child", "fips", "hawn_pi", "hispanic", "households", "hse_units", "hsehld_1_f", "hsehld_1_m", "males", "marhh_chd", "marhh_no_c", "med_age", "med_age_f", "med_age_m", "mhh_child", "mult_race", "name", "no_farms97", "other", "owner_occ", "pop00_sqmi", "pop07_sqmi", "pop2000", "pop2007", "renter_occ", "sqmi", "state_fips", "state_name", "vacant", "white" FROM "census"."counties" WHERE the_geom && SetSRID('BOX3D(-178.217606000000 18.921785000000, -66.969269000000 71.406242000000)'::box3d,-1) 
2009-07-08 12:05:39 EDT LOG:  statement: FETCH 500 in OGRPGLayerReader
2009-07-08 12:05:39 EDT ERROR:  Operation on two geometries with different SRIDs
2009-07-08 12:05:39 EDT STATEMENT:  FETCH 500 in OGRPGLayerReader
2009-07-08 12:05:39 EDT LOG:  statement: COMMIT
From warmerdam at pobox.com  Wed Jul  8 13:20:15 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Jul  8 13:20:20 2009
Subject: [gdal-dev] Re: [SoC] GDAL WKT Raster driver weekly report #6
In-Reply-To: <cb4457700907040500y5cf2282cn263297cd3655eb2f@mail.gmail.com>
References: <cb4457700907040500y5cf2282cn263297cd3655eb2f@mail.gmail.com>
Message-ID: <4A54D54F.9070304@pobox.com>

Jorge Ar?valo wrote:
> Hello,
> 
> My weekly report: 
> http://www.gis4free.org/blog/2009/07/04/gsoc-09-weekly-report-6-2606-0307/
> 
> As usual, the project page: http://trac.osgeo.org/gdal/wiki/WKTRasterDriver

Jorge,

I am reviewing your documents at:

   http://trac.osgeo.org/gdal/wiki/WKTRasterDriver

I will try answer some outstanding questions and provide a few other
comments.

1) -MODE=ONE_FILE_PER_ROW - there is a GDAL concept of subdatasets that
might be applied to this.  To learn more read the "SUBDATASETS Domain"
section of the data model document (http://www.gdal.org/gdal_datamodel.html).
The idea would be for the ONE_FILE_PER_ROW mode to return a set of
subdatasets - one per row - with the row# encoded into the subdatset name.
Perhaps MODE=FIRSTROW would instead become MODE=ROW:# with a number being
the offset in the result set.  The danger to this approach is that if there
are many records in the result set it produces an unmanagable sized
subdatasets list - this is more suitable for dozens or hundreds of
subdatasets than it is for millions of subdatasets.

Will datasets where only a single row in the table is being addressed
also be treated as a single block for GDAL purposes?  That is - will
the whole image be read into RAM and returned to the user?  Or will there
be some attempt to provide a finer grained access?  If fine grained access
is to be supported it will be complicated to keep the image accessor
from one blockread/rasterio request to the next in such a way that
no extra work needs to be done.

2) MODE=WHOLE_TABLE
   - this is really the fully unstructured case.
   - It should be possible to use the extent from RASTER_COLUMNS if it is
     not null instead of scanning the whole table.
   - In combination with the pixelsize_x and pixelsize_y you can compute
     an image size in pixels and lines.  It *may* be desirable to support
     irregular images without even an entry in the RASTER_COLUMNS table
     in which case it might be necessary to scan all the rasters to establish
     a minimum pixel size from the actual images.  Ouch!
   - If/when MODE=WHOLE_TABLE is implemented it is important to understand
     that the whole result image cannot be assembled in memory.  Each time
     a block or RasterIO request is made it will be necessary to issue a
     SELECT statement with a corresponding spatial bounds to pull back
     images in the request region, and then mosaic them into the buffer as
     appropriate.  This will be hard since there isn't much supporting
     machinery in GDAL for this sort of case.

The doc does not seem to be specific on this point, but I assume the proposed
MODE parameter would optionally be part of the datasource name?

3) I agree with Pierre that no effort should be made at this time to
address the multi table tiled image.  I don't really understand that model
yet.

4) "QUESTION: Should the RasterBand? read all the tiles (rows of the raster 
table) and put them consecutives in the same memory area? If I expect this from 
RasterBand? class, the memory allocation is easy."

I'm afraid I do not understand this question.  Is it in regard to
regular_blocking images or one of the other cases?  I definately do not
believe the driver should be holding too much stuff in memory at once
- at most the raster data of one row at a time.  In the regular blocking
case I assume the rasterband blocksize will match the size of each
tile in the table and that access will be all handled via the
IBlockRead() method.

5) "The full set of possible GDALDataType values are declared in gdal.h,
and include GDT_Byte, GDT_UInt16, GDT_Int16, and GDT_Float32, but we,
probably, only are going to consider GDT_Byte to this project. "

I am disappointed with this statement.  I would much rather we leave off
stuff like MODE=WHOLE_TABLE, but do a comprehensive implementation of the
full set of data types.  It really should not add much complexity.  For
the midterm evaluation a byte only prototype would be fine of course.


6) "The data fetched with the Raster Band, is in HEXWKB format? (I think so) I 
should code a method to transform to this format to another ones..."

Yes, I believe you will need to implement a HEXWKB to binary decoding taking
care to convert to local machine byte order if necessary. You might want
to skim the OGRPGLayer::HEXToGeometry() method in ogrpglayer.cpp as a guide.

7) "Do we have to encode the data fetched in PNG/JPEG/TIFF format?"

I do not believe you need to have any awareness of PNG/JPEg/TIFF
or other raster formats unless possibly you do the out-of-db case
in which case GDAL should be used to read the external images
anyways, rather than you needing to know anything about the formats.

8) "May we assume that the tiles stored at the same table are homogeneus? What 
does exactly 'homogeneus' mean here? Only same pixel type?"

In a regular_blocking table you can assume that all types are of the
same pixel type, the same tile size (in pixels and lines), and
the same geographic resolution.

9) "How do we manage the data fetched? Simply copy the raster data
sequentially into the destination? Anf what happens if these raster data
come from tiles with different pixeltype or band configuration?"

When you establish the GDALRasterBand corresponding to a band in
the table you will declare the pixel data type based on the
contents of the RASTER_COLUMNS table.   The IReadBlock() method
will be invoked with a buffer that is the block/tile size and
already of the declared pixel data type.  The tile you get
from the database should also be in this type (assuming
regular_blocking).  There should not be any translation of
pixel type required though you will need to be byte order
aware for non-byte image data.  You will basically decode
the HEXWKB image into the buffer passed into IReadBlock.

With regard to your schedule, you can consider Objective 1 to
be "prototype read only support for regular blocking rasters".
You can cut a few corners such as support of different
pixel data types or worrying about byte swapping as long as
you have an Objective 1.1 following a while later that includes
all this done well.

The schedule does not explicitly address support for the
"MODE=FIRST_ROW" mode.  I would suggest you try and
address that after Objective 3 and before Objectives
4-6.

I can definitely see that your grasp of the issues and
approach is crystalizing!

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From randre at gmail.com  Wed Jul  8 13:25:55 2009
From: randre at gmail.com (=?ISO-8859-1?Q?Roger_Andr=E9?=)
Date: Wed Jul  8 13:25:57 2009
Subject: [gdal-dev] gdalwarp and Molleweide projections
In-Reply-To: <BLU0-SMTP3322F7F82CF23B3529B560DE2A0@phx.gbl>
References: <BLU0-SMTP3322F7F82CF23B3529B560DE2A0@phx.gbl>
Message-ID: <9c2015090907081025h53776761q1adddd9471c55955@mail.gmail.com>

Hi Matthew,

It would be useful to see what your source image looks like.  I have an
image that covers essentially global extents, and which is in EPSG:4326.  I
did a reprojection using gdalwarp in GDAL 1.6.1:

$ gdalwarp -s_srs "EPSG:4326" -t_srs "+proj=moll +lon_0=0" infile outfile

The results that look reasonable, or at least I see no horizontal flipping
or other artifacts in the result.

Any chance you could share a reduced resolution version of the data with the
list?

Roger
--



On Sun, Jul 5, 2009 at 11:04 AM, Matthew Vavrek <mattvavrek@hotmail.com>wrote:

> I have just started trying to use gdalwarp and gdal_translate to reproject
> some world maps. I have managed to achieve some limited success with some
> projections, but I seem to get strange results with my images, especially
> with Mollweide. The Molleweide gives a horizontally flipped image, sometimes
> with an unreversed strip in the middle, and the top and bottom of the image
> seem stretched rather than compressed as I would expect. The code I used to
> translate is:
>
> gdalwarp -of GTiff -s_srs EPSG:4326 -t_srs EPSG:54009 input.tif
> moll-output.tif
>
> I also tried with -t_srs '+proj=moll +lon_0=0'.
> My initial image was a plain jpg, and I have tried creating a world file
> and using gdal_translate to georeference the image. I also tried using:
>
> gdalwarp s_srs EPSG:4326 t_srs EPSG:4326 input.tif output.tif
>
> to see if that would help, which it oddly did for some of the other
> projections I was trying (like polyconic). I have even tried different world
> map images, yet still get these strange results. I can't figure out what I'm
> doing wrong to get these totally bizarre images, so any help would be
> appreciated.
>
> Thanks
> Matthew
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090708/553da39e/attachment.html
From belaid_moa at hotmail.com  Wed Jul  8 13:33:34 2009
From: belaid_moa at hotmail.com (Belaid MOA)
Date: Wed Jul  8 13:33:37 2009
Subject: [gdal-dev] Colored images from grayscale images.
In-Reply-To: <200907072135.35784.even.rouault@mines-paris.org>
References: <eba00f2b0907070739wdfa6f16q2324deb80479081a@mail.gmail.com>
	<200907072135.35784.even.rouault@mines-paris.org>
Message-ID: <COL113-W27F011CF0185AF9F9393CFF4290@phx.gbl>


Hi everyone,
  Is there any easy way to do the following using C++ in GDAL: I have a floating-point image and I'd like to associate arbitrary colors with ranges of the pixel levels. For example: for the pixel values in [0,0.1) associate red, for [0.1, 0.2) associated orange, for [0.2, 0.3) associate light blue, for [0.3,0.4) associate dark blue, for [0.4, 0.5) associate green, etc. I would like also to have this information available in the metadata or as legend so that users know what the colors stand for when they view the image.

 Thanks a lot in advance for any input.

 With best regards.
Belaid Moa.

    

_________________________________________________________________
Create a cool, new character for your Windows Live? Messenger. 
http://go.microsoft.com/?linkid=9656621
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090708/833cea50/attachment.html
From randre at gmail.com  Wed Jul  8 13:48:00 2009
From: randre at gmail.com (=?ISO-8859-1?Q?Roger_Andr=E9?=)
Date: Wed Jul  8 13:48:02 2009
Subject: [gdal-dev] python gdal installation issues
In-Reply-To: <f948885dd0fc.4a2ff19f@wmich.edu>
References: <f948885dd0fc.4a2ff19f@wmich.edu>
Message-ID: <9c2015090907081048p2e9fcd80ie9d9ccd7bd45e8c3@mail.gmail.com>

try adding the path to libgdal.so.1 in /etc/ld.so.conf

$ find /usr -name libgdal.so.1
/usr/local/lib/libgdal.so.1

$ sudo vi /etc/ld.so.conf
--> add
/usr/local/lib

$ ldconfig

$ /sbin/ldconfig -p | grep gdal
    libgdal.so.1 (libc6) => /usr/local/lib/libgdal.so.1
    libgdal.so (libc6) => /usr/local/lib/libgdal.so
--



On Wed, Jun 10, 2009 at 2:47 PM, Benjamin R Welton <
benjamin.r.welton@wmich.edu> wrote:

> Hey all,
>
>    Im having a bit of an issue using the python gdal api's. I keep getting
> an error in python saying that it is unable to find libgdal.so.1. I am not
> having any issues using the various gdal binaries however (gdalinfo works).
>  i looked at PYPI and  changed the gdal-config location setting in the
> setup.cfg file which allowed me to install the python module but when i
> attempt to use it i get the libgdal.so.1 file missing  error.
>
>   Anyone know of a way to fix this issue? I am compiling gdal from source
> on CentOS 5.1 using python 2.4.3.
>
> Thanks,
> Ben
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090708/98d82348/attachment.html
From warmerdam at pobox.com  Wed Jul  8 13:54:43 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Jul  8 13:54:49 2009
Subject: [gdal-dev] Colored images from grayscale images.
In-Reply-To: <COL113-W27F011CF0185AF9F9393CFF4290@phx.gbl>
References: <eba00f2b0907070739wdfa6f16q2324deb80479081a@mail.gmail.com>
	<200907072135.35784.even.rouault@mines-paris.org>
	<COL113-W27F011CF0185AF9F9393CFF4290@phx.gbl>
Message-ID: <4A54DD63.8040108@pobox.com>

Belaid MOA wrote:
> Hi everyone,
>   Is there any easy way to do the following using C++ in GDAL: I have a 
> floating-point image and I'd like to associate arbitrary colors with 
> ranges of the pixel levels. For example: for the pixel values in [0,0.1) 
> associate red, for [0.1, 0.2) associated orange, for [0.2, 0.3) 
> associate light blue, for [0.3,0.4) associate dark blue, for [0.4, 0.5) 
> associate green, etc. I would like also to have this information 
> available in the metadata or as legend so that users know what the 
> colors stand for when they view the image.

Belaid,

This sort of information can be preserved with some images as
a RasterAttrbuteTable:

   http://www.gdal.org/classGDALRasterAttributeTable.html

Since few formats intrinsically support these tables, they will
normally be stored in an associated .aux.xml file.

Note that very few applications take any advantage of raster
attribute tables, so even if you do this it will have little
immediate effect.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From randre at gmail.com  Wed Jul  8 13:59:22 2009
From: randre at gmail.com (=?ISO-8859-1?Q?Roger_Andr=E9?=)
Date: Wed Jul  8 13:59:24 2009
Subject: [gdal-dev] Need some inputs on using GDAL.
In-Reply-To: <COL113-W1C81937CB7EB147E80ED6F4430@phx.gbl>
References: <COL113-W1C81937CB7EB147E80ED6F4430@phx.gbl>
Message-ID: <9c2015090907081059t50e5b1d2o6d6040af2ce5b775@mail.gmail.com>

You might take a look at whether GMT can do what you need by using the
grdmath command.  The documentation for it is here,
http://gmt.soest.hawaii.edu/gmt/doc/gmt/html/man/grdmath.html.  I find that
it is a frustratingly difficult tool to learn how to use, but capable of
things similar to what you've described below.

Roger
--

On Thu, Jun 11, 2009 at 7:14 PM, Belaid MOA <belaid_moa@hotmail.com> wrote:

>  Greetings Everyone,
>
>    I would like to programmtically use GDAL to write a C++ program that
> takes two Geotiff images and uses the first image to create a mask that will
> be applied to the second image. The first image geographically contains the
> second image. The mask is computed from the first image using certain
> criteria on the values of its pixels. The mask is used to limit the
> processing of the second image into only the areas specified by the mask.
> The results of the processing is a new image that has the same projections
> as the second image.
>
>   A first elementray solution I was thinking of is to use *
> GDALCreateGenImgProjTransformer()<http://www.gdal.org/gdal__alg_8h.html#7671696d085085a0bfba3c3df9ffcc0a>
> *  to create the transformer between the first and the second image. Then,
> loop over the pixels of the second image and call *
> GDALGenImgProjTransform()* to find the corresponding pixel in the first
> image, compute the mask, and process the pixel of the first image
> accordingly. The results of the processing are written into disk using *
> Create()*
>
>    1- Any inputs on how to improve this elementray solution? Is it possible
> to use GDALWrapper for that?
>    2- Is there an easy way for creating an output file with the same
> metadata as the second image?
>    3- Is there any code I can look at for doing the masking?
>    **
>   Any help on this is very appreciated.
>
>  Thanks a lot in advance.
>
> ~Belaid...
>
>
>
> ------------------------------
> Windows Live helps you keep up with all your friends, in one place.<http://go.microsoft.com/?linkid=9660824>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090708/a6b4a930/attachment.html
From even.rouault at mines-paris.org  Wed Jul  8 14:02:07 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Jul  8 14:02:16 2009
Subject: [gdal-dev] Colored images from grayscale images.
In-Reply-To: <COL113-W27F011CF0185AF9F9393CFF4290@phx.gbl>
References: <eba00f2b0907070739wdfa6f16q2324deb80479081a@mail.gmail.com>
	<200907072135.35784.even.rouault@mines-paris.org>
	<COL113-W27F011CF0185AF9F9393CFF4290@phx.gbl>
Message-ID: <200907082002.07325.even.rouault@mines-paris.org>

You might want to try gdaldem with the color-relief mode to associate RGB 
values to pixel values. See http://gdal.org/gdaldem.html.

But this will not set metadata. Otherwise you might want to try MapServer if 
you want a nice looking map with a legend.

Le Wednesday 08 July 2009 19:33:34 Belaid MOA, vous avez ?crit?:
> Hi everyone,
>   Is there any easy way to do the following using C++ in GDAL: I have a
> floating-point image and I'd like to associate arbitrary colors with ranges
> of the pixel levels. For example: for the pixel values in [0,0.1) associate
> red, for [0.1, 0.2) associated orange, for [0.2, 0.3) associate light blue,
> for [0.3,0.4) associate dark blue, for [0.4, 0.5) associate green, etc. I
> would like also to have this information available in the metadata or as
> legend so that users know what the colors stand for when they view the
> image.
>
>  Thanks a lot in advance for any input.
>
>  With best regards.
> Belaid Moa.
>
>
>
> _________________________________________________________________
> Create a cool, new character for your Windows Live? Messenger.
> http://go.microsoft.com/?linkid=9656621


From even.rouault at mines-paris.org  Wed Jul  8 14:07:07 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Jul  8 14:07:16 2009
Subject: [gdal-dev] gdalwarp and Molleweide projections
In-Reply-To: <9c2015090907081025h53776761q1adddd9471c55955@mail.gmail.com>
References: <BLU0-SMTP3322F7F82CF23B3529B560DE2A0@phx.gbl>
	<9c2015090907081025h53776761q1adddd9471c55955@mail.gmail.com>
Message-ID: <200907082007.07932.even.rouault@mines-paris.org>

I would also note that the Geotiff driver/libgeotiff don't handle Molleweide 
projection. (In GDAL trunk, the projection is written as an ESRI PE String 
with the full WKT string, so if you only use GDAL trunk, you won't notice any 
problem when reading back the projection)

But this is a different problem than the image having artifacts.
From randre at gmail.com  Wed Jul  8 14:30:17 2009
From: randre at gmail.com (=?ISO-8859-1?Q?Roger_Andr=E9?=)
Date: Wed Jul  8 14:30:18 2009
Subject: [gdal-dev] Colored images from grayscale images.
In-Reply-To: <COL113-W27F011CF0185AF9F9393CFF4290@phx.gbl>
References: <eba00f2b0907070739wdfa6f16q2324deb80479081a@mail.gmail.com>
	<200907072135.35784.even.rouault@mines-paris.org>
	<COL113-W27F011CF0185AF9F9393CFF4290@phx.gbl>
Message-ID: <9c2015090907081130h49e98275xdbaea3252c76591a@mail.gmail.com>

As far as coloring goes, Matt Perry had some C++ tools that included this
ability, see http://www.perrygeo.net/wordpress/?p=7 and look for
color-relief.cpp.  I recall that there was some talk that these would be
included in the GDAL utilities at some point, perhaps they already are.
Depending on what you intend to use the image for, I agree that using
Mapserver might be the best solution for doing this, especially since
generating the legend would be trivial.
--

On Wed, Jul 8, 2009 at 10:33 AM, Belaid MOA <belaid_moa@hotmail.com> wrote:

>  Hi everyone,
>   Is there any easy way to do the following using C++ in GDAL: I have a
> floating-point image and I'd like to associate arbitrary colors with ranges
> of the pixel levels. For example: for the pixel values in [0,0.1) associate
> red, for [0.1, 0.2) associated orange, for [0.2, 0.3) associate light blue,
> for [0.3,0.4) associate dark blue, for [0.4, 0.5) associate green, etc. I
> would like also to have this information available in the metadata or as
> legend so that users know what the colors stand for when they view the
> image.
>
>  Thanks a lot in advance for any input.
>
>  With best regards.
> Belaid Moa.
>
>
>
> ------------------------------
> Create a cool, new character for your Windows Live? Messenger. Check it
> out <http://go.microsoft.com/?linkid=9656621>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090708/c1327cb0/attachment.html
From randre at gmail.com  Wed Jul  8 14:38:28 2009
From: randre at gmail.com (=?ISO-8859-1?Q?Roger_Andr=E9?=)
Date: Wed Jul  8 14:38:30 2009
Subject: [gdal-dev] running gdal_merge for a lot of files
In-Reply-To: <2a37f67a0906260046i908c20hed9eb59aadd84510@mail.gmail.com>
References: <2a37f67a0906260046i908c20hed9eb59aadd84510@mail.gmail.com>
Message-ID: <9c2015090907081138v185b82c7ja242fb87da4340d3@mail.gmail.com>

There are probably several different ways to approach this, the following
are 2 that have worked for me in the past when gdal_merge.py has had
problems.

1) Assuming all of the tiles are in the same projection and resolution, use
gdalwarp to create the mosaic.
or
2) Since you are using version 1.6.1 of gdal, you could try using the
"gdalbuildvrt" utility to create a virtual mosaic.  I suspect it might be
possible to use the VRT as the input source to create overviews.
--


On Fri, Jun 26, 2009 at 12:46 AM, Pavel Iacovlev
<iacovlev.pavel@gmail.com>wrote:

> Good day all,
>
> I am trying to merge a large data set, the input imagery is 1TB RGB
> uncompressed tifs (lots of them). Then I run gdal_merge.py on a small
> data set it runs ok and with -v option I can see whats happening. But
> then I run on a large dataset I don't get no verbose output (I don't
> get no output at all) and it stuck on 8.9 GB image size. I can just
> track that the image is getting bigger but not verbose output
> whatsoever and I can tell why it stops on 8.9 GB.
>
> My command is: gdal_merge.py -v -init 255 -of GTiff -co TILED=YES -co
> COMPRESS=JPEG -co PHOTOMETRIC=YCBCR -co BIGTIFF=YES -o of.tif of/*.tif
>
> The input images are around 160mb each so loading them 1 by 1 into
> memory is not a problem.
>
> I want to join all this imagery into 1 big tif and create overviews to
> serve it via mapserver.
>
> GDAL version: GDAL 1.6.1, released 2009/05/11
>
> --
> http://iap.md, The future is open
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090708/ed216587/attachment.html
From belaid_moa at hotmail.com  Wed Jul  8 14:47:56 2009
From: belaid_moa at hotmail.com (Belaid MOA)
Date: Wed Jul  8 14:47:58 2009
Subject: [gdal-dev] Colored images from grayscale images.
In-Reply-To: <9c2015090907081130h49e98275xdbaea3252c76591a@mail.gmail.com>
References: <eba00f2b0907070739wdfa6f16q2324deb80479081a@mail.gmail.com>
	<200907072135.35784.even.rouault@mines-paris.org>
	<COL113-W27F011CF0185AF9F9393CFF4290@phx.gbl> 
	<9c2015090907081130h49e98275xdbaea3252c76591a@mail.gmail.com>
Message-ID: <COL113-W56F623933D653B6C6C1457F4290@phx.gbl>


Thank you very much Andre for your help. I tried downloading the source code from the website  
http://www.perrygeo.net/download/gdaldemtools_20060207.zip but I am getting a 404 error: resource not found.
Is there any other way to get the source code?

 Thanks a lot in advance Andre.
Belaid Moa. 
Date: Wed, 8 Jul 2009 11:30:17 -0700
Subject: Re: [gdal-dev] Colored images from grayscale images.
From: randre@gmail.com
To: belaid_moa@hotmail.com
CC: gdal-dev@lists.osgeo.org

As far as coloring goes, Matt Perry had some C++ tools that included this ability, see http://www.perrygeo.net/wordpress/?p=7 and look for color-relief.cpp.  I recall that there was some talk that these would be included in the GDAL utilities at some point, perhaps they already are.  Depending on what you intend to use the image for, I agree that using Mapserver might be the best solution for doing this, especially since generating the legend would be trivial.

--

On Wed, Jul 8, 2009 at 10:33 AM, Belaid MOA <belaid_moa@hotmail.com> wrote:






Hi everyone,
  Is there any easy way to do the following using C++ in GDAL: I have a floating-point image and I'd like to associate arbitrary colors with ranges of the pixel levels. For example: for the pixel values in [0,0.1) associate red, for [0.1, 0.2) associated orange, for [0.2, 0.3) associate light blue, for [0.3,0.4) associate dark blue, for [0.4, 0.5) associate green, etc. I would like also to have this information available in the metadata or as legend so that users know what the colors stand for when they view the image.


 Thanks a lot in advance for any input.

 With best regards.
Belaid Moa.

    

Create a cool, new character for your Windows Live? Messenger.  Check it out


_______________________________________________

gdal-dev mailing list

gdal-dev@lists.osgeo.org

http://lists.osgeo.org/mailman/listinfo/gdal-dev


_________________________________________________________________
We are your photos. Share us now with Windows Live Photos.
http://go.microsoft.com/?linkid=9666047
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090708/1be2195c/attachment.html
From even.rouault at mines-paris.org  Wed Jul  8 14:48:08 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Jul  8 14:48:17 2009
Subject: [gdal-dev] Colored images from grayscale images.
In-Reply-To: <COL113-W32E2A9E163AD72A29C77E6F4290@phx.gbl>
References: <eba00f2b0907070739wdfa6f16q2324deb80479081a@mail.gmail.com>
	<200907082002.07325.even.rouault@mines-paris.org>
	<COL113-W32E2A9E163AD72A29C77E6F4290@phx.gbl>
Message-ID: <200907082048.09400.even.rouault@mines-paris.org>

You don't need to change anything. It is just a matter of ("smart") 
configuration of the text file that maps from values to RGB triplets. For 
example if you want to associate (R1,G1,B1) to [0,0.1[, (R2,G2,B2) to [0.1, 
0.2[, etc ..., try this :

0                    R1 G1 B1
0.099999999 R1 G1 B1
0.1                 R2 G2 B2
0.199999999 R2 G2 B2


Le Wednesday 08 July 2009 20:43:56 Belaid MOA, vous avez ?crit?:
> Thanks a lot Even. I looked at the gdaldem doc and it seems it does some
> kind of blending to the image. Unfortunately, I do not want to produce any
> extra information/distortion in the image; only associate ranges to colors.
> The ranges form a partition of the pixel values. So, no
> interpolation/blending is needed. Is gdaldem easy to change to do this?
>
> With best regards.
> Belaid Moa.
>
> > From: even.rouault@mines-paris.org
> > To: gdal-dev@lists.osgeo.org
> > Subject: Re: [gdal-dev] Colored images from grayscale images.
> > Date: Wed, 8 Jul 2009 20:02:07 +0200
> > CC: belaid_moa@hotmail.com
> >
> > You might want to try gdaldem with the color-relief mode to associate RGB
> > values to pixel values. See http://gdal.org/gdaldem.html.
> >
> > But this will not set metadata. Otherwise you might want to try MapServer
> > if you want a nice looking map with a legend.
> >
> > Le Wednesday 08 July 2009 19:33:34 Belaid MOA, vous avez ?crit :
> > > Hi everyone,
> > >   Is there any easy way to do the following using C++ in GDAL: I have a
> > > floating-point image and I'd like to associate arbitrary colors with
> > > ranges of the pixel levels. For example: for the pixel values in
> > > [0,0.1) associate red, for [0.1, 0.2) associated orange, for [0.2, 0.3)
> > > associate light blue, for [0.3,0.4) associate dark blue, for [0.4, 0.5)
> > > associate green, etc. I would like also to have this information
> > > available in the metadata or as legend so that users know what the
> > > colors stand for when they view the image.
> > >
> > >  Thanks a lot in advance for any input.
> > >
> > >  With best regards.
> > > Belaid Moa.
> > >
> > >
> > >
> > > _________________________________________________________________
> > > Create a cool, new character for your Windows Live? Messenger.
> > > http://go.microsoft.com/?linkid=9656621
>
> _________________________________________________________________
> Attention all humans. We are your photos. Free us.
> http://go.microsoft.com/?linkid=9666046


From belaid_moa at hotmail.com  Wed Jul  8 14:43:56 2009
From: belaid_moa at hotmail.com (Belaid MOA)
Date: Wed Jul  8 14:48:43 2009
Subject: [gdal-dev] Colored images from grayscale images.
In-Reply-To: <200907082002.07325.even.rouault@mines-paris.org>
References: <eba00f2b0907070739wdfa6f16q2324deb80479081a@mail.gmail.com>
	<200907072135.35784.even.rouault@mines-paris.org>
	<COL113-W27F011CF0185AF9F9393CFF4290@phx.gbl>
	<200907082002.07325.even.rouault@mines-paris.org>
Message-ID: <COL113-W32E2A9E163AD72A29C77E6F4290@phx.gbl>


Thanks a lot Even. I looked at the gdaldem doc and it seems it does some kind of blending to the image.
Unfortunately, I do not want to produce any extra information/distortion in the image; only associate ranges to colors. The ranges form a partition of the pixel values. So, no interpolation/blending is needed. Is gdaldem easy to change to do this?

With best regards.
Belaid Moa.


> From: even.rouault@mines-paris.org
> To: gdal-dev@lists.osgeo.org
> Subject: Re: [gdal-dev] Colored images from grayscale images.
> Date: Wed, 8 Jul 2009 20:02:07 +0200
> CC: belaid_moa@hotmail.com
> 
> You might want to try gdaldem with the color-relief mode to associate RGB 
> values to pixel values. See http://gdal.org/gdaldem.html.
> 
> But this will not set metadata. Otherwise you might want to try MapServer if 
> you want a nice looking map with a legend.
> 
> Le Wednesday 08 July 2009 19:33:34 Belaid MOA, vous avez ?crit :
> > Hi everyone,
> >   Is there any easy way to do the following using C++ in GDAL: I have a
> > floating-point image and I'd like to associate arbitrary colors with ranges
> > of the pixel levels. For example: for the pixel values in [0,0.1) associate
> > red, for [0.1, 0.2) associated orange, for [0.2, 0.3) associate light blue,
> > for [0.3,0.4) associate dark blue, for [0.4, 0.5) associate green, etc. I
> > would like also to have this information available in the metadata or as
> > legend so that users know what the colors stand for when they view the
> > image.
> >
> >  Thanks a lot in advance for any input.
> >
> >  With best regards.
> > Belaid Moa.
> >
> >
> >
> > _________________________________________________________________
> > Create a cool, new character for your Windows Live? Messenger.
> > http://go.microsoft.com/?linkid=9656621
> 
> 

_________________________________________________________________
Attention all humans. We are your photos. Free us.
http://go.microsoft.com/?linkid=9666046
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090708/915eff52/attachment-0001.html
From even.rouault at mines-paris.org  Wed Jul  8 14:51:08 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Jul  8 14:51:18 2009
Subject: [gdal-dev] Colored images from grayscale images.
In-Reply-To: <COL113-W56F623933D653B6C6C1457F4290@phx.gbl>
References: <eba00f2b0907070739wdfa6f16q2324deb80479081a@mail.gmail.com>
	<9c2015090907081130h49e98275xdbaea3252c76591a@mail.gmail.com>
	<COL113-W56F623933D653B6C6C1457F4290@phx.gbl>
Message-ID: <200907082051.08685.even.rouault@mines-paris.org>

Just to mention that the gdaldem utility, that has landed into GDAL 1.7.0dev 
trunk, is derived from Matt Perry dem tools (derived themselves from 
ancient - public domain - GRASS code ;-)). You can grab it here : 
http://trac.osgeo.org/gdal/browser/trunk/gdal/apps/gdaldem.cpp. It should 
compile fine against GDAL 1.6.X.

Le Wednesday 08 July 2009 20:47:56 Belaid MOA, vous avez ?crit?:
> Thank you very much Andre for your help. I tried downloading the source
> code from the website
> http://www.perrygeo.net/download/gdaldemtools_20060207.zip but I am getting
> a 404 error: resource not found. Is there any other way to get the source
> code?
>
>  Thanks a lot in advance Andre.
> Belaid Moa.
> Date: Wed, 8 Jul 2009 11:30:17 -0700
> Subject: Re: [gdal-dev] Colored images from grayscale images.
> From: randre@gmail.com
> To: belaid_moa@hotmail.com
> CC: gdal-dev@lists.osgeo.org
>
> As far as coloring goes, Matt Perry had some C++ tools that included this
> ability, see http://www.perrygeo.net/wordpress/?p=7 and look for
> color-relief.cpp.  I recall that there was some talk that these would be
> included in the GDAL utilities at some point, perhaps they already are. 
> Depending on what you intend to use the image for, I agree that using
> Mapserver might be the best solution for doing this, especially since
> generating the legend would be trivial.
>
> --
>
> On Wed, Jul 8, 2009 at 10:33 AM, Belaid MOA <belaid_moa@hotmail.com> wrote:
>
>
>
>
>
>
> Hi everyone,
>   Is there any easy way to do the following using C++ in GDAL: I have a
> floating-point image and I'd like to associate arbitrary colors with ranges
> of the pixel levels. For example: for the pixel values in [0,0.1) associate
> red, for [0.1, 0.2) associated orange, for [0.2, 0.3) associate light blue,
> for [0.3,0.4) associate dark blue, for [0.4, 0.5) associate green, etc. I
> would like also to have this information available in the metadata or as
> legend so that users know what the colors stand for when they view the
> image.
>
>
>  Thanks a lot in advance for any input.
>
>  With best regards.
> Belaid Moa.
>
>
>
> Create a cool, new character for your Windows Live? Messenger.  Check it
> out
>
>
> _______________________________________________
>
> gdal-dev mailing list
>
> gdal-dev@lists.osgeo.org
>
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
> _________________________________________________________________
> We are your photos. Share us now with Windows Live Photos.
> http://go.microsoft.com/?linkid=9666047


From belaid_moa at hotmail.com  Wed Jul  8 14:56:17 2009
From: belaid_moa at hotmail.com (Belaid MOA)
Date: Wed Jul  8 14:56:20 2009
Subject: [gdal-dev] Colored images from grayscale images.
In-Reply-To: <200907082051.08685.even.rouault@mines-paris.org>
References: <eba00f2b0907070739wdfa6f16q2324deb80479081a@mail.gmail.com>
	<9c2015090907081130h49e98275xdbaea3252c76591a@mail.gmail.com>
	<COL113-W56F623933D653B6C6C1457F4290@phx.gbl>
	<200907082051.08685.even.rouault@mines-paris.org>
Message-ID: <COL113-W2026DBAE7F3164D246DBDEF4290@phx.gbl>


Thank you very ... very much Even for your help. I will then download gdaldem.cpp and use it to do the job.
With best regards.
Belaid Moa. 

> From: even.rouault@mines-paris.org
> To: gdal-dev@lists.osgeo.org
> Subject: Re: [gdal-dev] Colored images from grayscale images.
> Date: Wed, 8 Jul 2009 20:51:08 +0200
> CC: belaid_moa@hotmail.com; randre@gmail.com
> 
> Just to mention that the gdaldem utility, that has landed into GDAL 1.7.0dev 
> trunk, is derived from Matt Perry dem tools (derived themselves from 
> ancient - public domain - GRASS code ;-)). You can grab it here : 
> http://trac.osgeo.org/gdal/browser/trunk/gdal/apps/gdaldem.cpp. It should 
> compile fine against GDAL 1.6.X.
> 
> Le Wednesday 08 July 2009 20:47:56 Belaid MOA, vous avez ?crit :
> > Thank you very much Andre for your help. I tried downloading the source
> > code from the website
> > http://www.perrygeo.net/download/gdaldemtools_20060207.zip but I am getting
> > a 404 error: resource not found. Is there any other way to get the source
> > code?
> >
> >  Thanks a lot in advance Andre.
> > Belaid Moa.
> > Date: Wed, 8 Jul 2009 11:30:17 -0700
> > Subject: Re: [gdal-dev] Colored images from grayscale images.
> > From: randre@gmail.com
> > To: belaid_moa@hotmail.com
> > CC: gdal-dev@lists.osgeo.org
> >
> > As far as coloring goes, Matt Perry had some C++ tools that included this
> > ability, see http://www.perrygeo.net/wordpress/?p=7 and look for
> > color-relief.cpp.  I recall that there was some talk that these would be
> > included in the GDAL utilities at some point, perhaps they already are. 
> > Depending on what you intend to use the image for, I agree that using
> > Mapserver might be the best solution for doing this, especially since
> > generating the legend would be trivial.
> >
> > --
> >
> > On Wed, Jul 8, 2009 at 10:33 AM, Belaid MOA <belaid_moa@hotmail.com> wrote:
> >
> >
> >
> >
> >
> >
> > Hi everyone,
> >   Is there any easy way to do the following using C++ in GDAL: I have a
> > floating-point image and I'd like to associate arbitrary colors with ranges
> > of the pixel levels. For example: for the pixel values in [0,0.1) associate
> > red, for [0.1, 0.2) associated orange, for [0.2, 0.3) associate light blue,
> > for [0.3,0.4) associate dark blue, for [0.4, 0.5) associate green, etc. I
> > would like also to have this information available in the metadata or as
> > legend so that users know what the colors stand for when they view the
> > image.
> >
> >
> >  Thanks a lot in advance for any input.
> >
> >  With best regards.
> > Belaid Moa.
> >
> >
> >
> > Create a cool, new character for your Windows Live? Messenger.  Check it
> > out
> >
> >
> > _______________________________________________
> >
> > gdal-dev mailing list
> >
> > gdal-dev@lists.osgeo.org
> >
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >
> >
> > _________________________________________________________________
> > We are your photos. Share us now with Windows Live Photos.
> > http://go.microsoft.com/?linkid=9666047
> 
> 

_________________________________________________________________
Internet explorer 8 lets you browse the web faster.
http://go.microsoft.com/?linkid=9655582
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090708/53b99239/attachment.html
From even.rouault at mines-paris.org  Wed Jul  8 15:07:54 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Jul  8 15:08:03 2009
Subject: [gdal-dev] OGR is not able to determine PostGIS table SRS
In-Reply-To: <C67A4085.E336%SorokinA@ornl.gov>
References: <C67A4085.E336%SorokinA@ornl.gov>
Message-ID: <200907082107.54530.even.rouault@mines-paris.org>

Alexandre,

the interesting trace I noted in the gdal-debug.txt file is :

PG: PQexec(SELECT srtext FROM spatial_ref_sys WHERE srid = 4326) = 
PGRES_TUPLES_OK, ntuples = 0

It looks like your spatial_ref_sys table is not correctly filled. You should 
check its content and/or its permissions.

Best regards,
Even

Le Wednesday 08 July 2009 18:24:36 Sorokine, Alexandre, vous avez ?crit?:
> Frank,
>
> > Actually, I suspect the debug facilities in trunk for the OGR PG driver
> > have been upgraded.  Would it be practical for you to try things with
> > trunk?
>
> I did some more debugging with the version from the trunk checked out
> around 10AM EST today.  I compiled it on OSX with macports as:
>
> /configure --prefix=/Users/sorokine/Documents/appl/gdalsvninst
> --with-pg=/opt/local/lib/postgresql83/bin/pg_config
> --with-netcdf=/opt/local --enable-debug && make -j7 && make install
>
> Results of running ogrinfo are in the file in the attachment (ogrinfo with
> debug plus postgresql staements from logs).  My observations is that trunk
> version solves some of the problems but other problems persist:
>
> 1.  Trunk version (compared to 1.6.0)  properly sets SRID for the WHERE
> clause with the bounding box:
>
> PG: OGRPGTableLayer::BuildWhere returns: WHERE "the_geom" &&
> SetSRID('BOX3D(-178.217606000000 18.921785000000, -66.969269000000
> 71.406242000000)'::box3d,4326)
>
> Compare to 1.6.0:
>
> PG: OGRPGTableLayer::BuildWhere returns: WHERE the_geom &&
> SetSRID('BOX3D(-178.217606000000 18.921785000000, -66.969269000000
> 71.406242000000)'::box3d,-1)
>
> 2.  Trunk version does NOT fix reporting of SRS through
> OGR_L_GetSpatialRef(layer) or OGR_F_GetSpatialReferemce(feature), both
> return NULL.  I've tested it in my code and you can see that in trunk
> ogrinfo output:
>
> Layer SRS WKT:
> (unknown)
>
> 3.  Trunk version doe not properly set bounding box SRS through
> OGR_L_SetSpatialFilterRect() function.  I've tested it in my code. 
> Bounding box works in ogrinfo but ogrinfo does not use this function (it
> builds a geometry).
>
> I hope we will be able to fix it,
>
> On 7/7/09 11:10 PM, "Frank Warmerdam" <warmerdam@pobox.com> wrote:
> > Sorokine, Alexandre wrote:
> >> Franks,
> >>
> >> Thank you for your reply, I did some more checks.  Please see my
> >> comments below.
> >
> > Alexandre,
> >
> > I'm still wondering if this is related to schemas.  I was surprised to
> > not see any queries against the spatial_ref_sys table.  In my trunk build
> > I see something like:
> >
> > PG: PQexec(SELECT srtext FROM spatial_ref_sys WHERE srid = 4326) =
> > PGRES_TUPLES_OK, ntuples = 1
> >
> >
> > Best regards,
> > --
> > ---------------------------------------+---------------------------------
> >----- I set the clouds in motion - turn up   | Frank Warmerdam,
> > warmerdam@pobox.com light and sound - activate the windows |
> > http://pobox.com/~warmerdam and watch the world go round - Rush    |
> > Geospatial Programmer for Rent


From randre at gmail.com  Wed Jul  8 16:00:20 2009
From: randre at gmail.com (=?ISO-8859-1?Q?Roger_Andr=E9?=)
Date: Wed Jul  8 16:00:23 2009
Subject: [gdal-dev] Writing georeferencing and projection info to NetCDF
	with Python Scientific.IO.NetCDF
Message-ID: <9c2015090907081300x4ac65f60g72bf1a177179d3a9@mail.gmail.com>

Hi all,

After a considerable delay due to work on other projects, I would like to
get back to exploring the capability of the GDAL netCDF driver.  To that
end, I am trying to create some netCDF files in which I can control variable
names, number of dimensions etc.  I have been exploring the
Scientific.IO.NetCDF
Python module and am able to create generic netCDF files, but they lack
georeferencing and projection info.

Can someone out there point me to some documentation, or cut-and-paste some
code, which shows how this info could be added?

Thanks in advance,

Roger
--
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090708/cdf0cf3b/attachment.html
From sorokina at ornl.gov  Wed Jul  8 16:13:55 2009
From: sorokina at ornl.gov (Sorokine, Alexandre)
Date: Wed Jul  8 16:14:36 2009
Subject: [gdal-dev] OGR is not able to determine PostGIS table SRS
In-Reply-To: <200907082107.54530.even.rouault@mines-paris.org>
Message-ID: <C67A7643.E369%SorokinA@ornl.gov>

Rouault,

Yes, that was the problem.  spatial_ref_sys in my database got damaged somehow.  I have rebuilt it and now all seems to work right, the problem is resolved.

Thank you fro your help!

On 7/8/09 3:07 PM, "Even Rouault" <even.rouault@mines-paris.org> wrote:

Alexandre,

the interesting trace I noted in the gdal-debug.txt file is :

PG: PQexec(SELECT srtext FROM spatial_ref_sys WHERE srid = 4326) =
PGRES_TUPLES_OK, ntuples = 0

It looks like your spatial_ref_sys table is not correctly filled. You should
check its content and/or its permissions.

Best regards,
Even

Le Wednesday 08 July 2009 18:24:36 Sorokine, Alexandre, vous avez ?crit :
> Frank,
>
> > Actually, I suspect the debug facilities in trunk for the OGR PG driver
> > have been upgraded.  Would it be practical for you to try things with
> > trunk?
>
> I did some more debugging with the version from the trunk checked out
> around 10AM EST today.  I compiled it on OSX with macports as:
>
> /configure --prefix=/Users/sorokine/Documents/appl/gdalsvninst
> --with-pg=/opt/local/lib/postgresql83/bin/pg_config
> --with-netcdf=/opt/local --enable-debug && make -j7 && make install
>
> Results of running ogrinfo are in the file in the attachment (ogrinfo with
> debug plus postgresql staements from logs).  My observations is that trunk
> version solves some of the problems but other problems persist:
>
> 1.  Trunk version (compared to 1.6.0)  properly sets SRID for the WHERE
> clause with the bounding box:
>
> PG: OGRPGTableLayer::BuildWhere returns: WHERE "the_geom" &&
> SetSRID('BOX3D(-178.217606000000 18.921785000000, -66.969269000000
> 71.406242000000)'::box3d,4326)
>
> Compare to 1.6.0:
>
> PG: OGRPGTableLayer::BuildWhere returns: WHERE the_geom &&
> SetSRID('BOX3D(-178.217606000000 18.921785000000, -66.969269000000
> 71.406242000000)'::box3d,-1)
>
> 2.  Trunk version does NOT fix reporting of SRS through
> OGR_L_GetSpatialRef(layer) or OGR_F_GetSpatialReferemce(feature), both
> return NULL.  I've tested it in my code and you can see that in trunk
> ogrinfo output:
>
> Layer SRS WKT:
> (unknown)
>
> 3.  Trunk version doe not properly set bounding box SRS through
> OGR_L_SetSpatialFilterRect() function.  I've tested it in my code.
> Bounding box works in ogrinfo but ogrinfo does not use this function (it
> builds a geometry).
>
> I hope we will be able to fix it,
>
> On 7/7/09 11:10 PM, "Frank Warmerdam" <warmerdam@pobox.com> wrote:
> > Sorokine, Alexandre wrote:
> >> Franks,
> >>
> >> Thank you for your reply, I did some more checks.  Please see my
> >> comments below.
> >
> > Alexandre,
> >
> > I'm still wondering if this is related to schemas.  I was surprised to
> > not see any queries against the spatial_ref_sys table.  In my trunk build
> > I see something like:
> >
> > PG: PQexec(SELECT srtext FROM spatial_ref_sys WHERE srid = 4326) =
> > PGRES_TUPLES_OK, ntuples = 1
> >
> >
> > Best regards,
> > --
> > ---------------------------------------+---------------------------------
> >----- I set the clouds in motion - turn up   | Frank Warmerdam,
> > warmerdam@pobox.com light and sound - activate the windows |
> > http://pobox.com/~warmerdam and watch the world go round - Rush    |
> > Geospatial Programmer for Rent



From sjahputerao at missouri.edu  Wed Jul  8 16:35:56 2009
From: sjahputerao at missouri.edu (Ozy Sjahputera)
Date: Wed Jul  8 16:35:59 2009
Subject: [gdal-dev] Blocksize in VRT files
In-Reply-To: <4A3AB56E.7080301@loskot.net>
References: <C482FF98AE985A47B8C982FD429C9E3402F5A6F5@daytonmsg2k3.AERO.BALL.COM>	<4A382B4D.8030103@pobox.com>	<C482FF98AE985A47B8C982FD429C9E3402F5A7B4@daytonmsg2k3.AERO.BALL.COM>	<4A39039A.8030504@loskot.net>	<C482FF98AE985A47B8C982FD429C9E3402F5A7E1@daytonmsg2k3.AERO.BALL.COM>	<4A3924AD.3040301@loskot.net>	<C482FF98AE985A47B8C982FD429C9E3402F5A886@daytonmsg2k3.AERO.BALL.COM>
	<4A3AB56E.7080301@loskot.net>
Message-ID: <4A55032C.9050209@missouri.edu>

I have been using the VRT format a lot lately and loving it!

I created the VRT files in two ways:
1). directly writing the XML file (usually using SimpleSource or 
ComplexSource)
2). using GDALAutoCreateWarpedVRT()

I found out that the VRT files created using the first method has 
blocksize of 128x128. While VRT files created using 
GDALAutoCreateWarpedVRT() has blocksize of 512x128.

Is there a way for the user to specify VRT file blocksize when creating 
the file using the two methods above?

Thanks
Ozy
From Gary.Smart at Goodrich.com  Wed Jul  8 17:17:07 2009
From: Gary.Smart at Goodrich.com (Smart, Gary)
Date: Wed Jul  8 17:17:13 2009
Subject: [gdal-dev] Newbee - pointers needed
Message-ID: <45D1B79D2DCCF34E966D24728765DDB3DF56BB@nhc2ex11.goodrich.root.local>

 

OK - I have been coding c++ raster image display systems on Linux for
years now and long ago developed our own raster map display system based
on CADRG/ASRP files.  Our system effectively maps a huge raster image
space around the world and stitches together tiles from raster map files
as the user moves his view around the globe.

 

I wish to investigate and perhaps use the GDAL as a more generic map
reader.  However, having parsed some tutorial information and a few
example cpp files, I am none the wiser on how it works.

 

I need some pointers to some generic information/example c++ code which
can provide me with answers to the following sorts of questions?

 

1)       How to register map files with the GDAL.

2)       How to request areas of map to populate my raster output space
(and how do I ensure only compatible map sources are brought together)

3)       Are tiles of raster map extracted by specifying geo-space
boundaries?

4)       And a million more questions...

 

Can someone point me to some documentation which can put me in the
picture as to how a user might use the GDAL to display maps on the
screen (the fine details of actual rendering are not required - I just
need to know how to get the information from the input files in a common
display format) and perhaps some example code (e.g. to extract
rasterized tiles of a specific geo-area)?

 

Just some pointers for some reading are all that I'm after really.

 

Gary

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090708/a90c0388/attachment.html
From even.rouault at mines-paris.org  Wed Jul  8 17:49:49 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Jul  8 17:50:01 2009
Subject: [gdal-dev] Newbee - pointers needed
In-Reply-To: <45D1B79D2DCCF34E966D24728765DDB3DF56BB@nhc2ex11.goodrich.root.local>
References: <45D1B79D2DCCF34E966D24728765DDB3DF56BB@nhc2ex11.goodrich.root.local>
Message-ID: <200907082349.50893.even.rouault@mines-paris.org>

Le Wednesday 08 July 2009 23:17:07 Smart, Gary, vous avez ?crit?:
> OK - I have been coding c++ raster image display systems on Linux for
> years now and long ago developed our own raster map display system based
> on CADRG/ASRP files.  Our system effectively maps a huge raster image
> space around the world and stitches together tiles from raster map files
> as the user moves his view around the globe.
>
>
>
> I wish to investigate and perhaps use the GDAL as a more generic map
> reader.  However, having parsed some tutorial information and a few
> example cpp files, I am none the wiser on how it works.
>
>
>
> I need some pointers to some generic information/example c++ code which
> can provide me with answers to the following sorts of questions?
>
>
>
> 1)       How to register map files with the GDAL.

You don't "register" maps with GDAL. You open datasets with GDALOpen()

>
> 2)       How to request areas of map to populate my raster output space
> (and how do I ensure only compatible map sources are brought together)

GDALRasterIO() / GDALDatasetRasterIO() will fetch data from regions expressed 
in pixel space of the raster. You can use the affine transform matrix 
(geotransform) given by GDALGetGeoTransform() to convert between pixel and 
geo spaces.

Not sure what you mean by "compatible map sources".

>
> 3)       Are tiles of raster map extracted by specifying geo-space
> boundaries?

See above

>
> 4)       And a million more questions...
>
>

My understanding of your needs is that MapServer could also be worth 
exploring.

>
> Can someone point me to some documentation which can put me in the
> picture as to how a user might use the GDAL to display maps on the
> screen (the fine details of actual rendering are not required - I just
> need to know how to get the information from the input files in a common
> display format) and perhaps some example code (e.g. to extract
> rasterized tiles of a specific geo-area)?
>
>
>
> Just some pointers for some reading are all that I'm after really.
>
>
>
> Gary


From even.rouault at mines-paris.org  Wed Jul  8 17:51:17 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Jul  8 17:51:26 2009
Subject: [gdal-dev] Blocksize in VRT files
In-Reply-To: <4A55032C.9050209@missouri.edu>
References: <C482FF98AE985A47B8C982FD429C9E3402F5A6F5@daytonmsg2k3.AERO.BALL.COM>
	<4A3AB56E.7080301@loskot.net> <4A55032C.9050209@missouri.edu>
Message-ID: <200907082351.18145.even.rouault@mines-paris.org>

For WarpedVRT, there are the BlockXSize and BlockYSize elements that can be 
changed in the .VRT file.

For regular VRT, you can't, although it might be desirable in some case of 
specifying it also.

Le Wednesday 08 July 2009 22:35:56 Ozy Sjahputera, vous avez ?crit?:
> I have been using the VRT format a lot lately and loving it!
>
> I created the VRT files in two ways:
> 1). directly writing the XML file (usually using SimpleSource or
> ComplexSource)
> 2). using GDALAutoCreateWarpedVRT()
>
> I found out that the VRT files created using the first method has
> blocksize of 128x128. While VRT files created using
> GDALAutoCreateWarpedVRT() has blocksize of 512x128.
>
> Is there a way for the user to specify VRT file blocksize when creating
> the file using the two methods above?
>
> Thanks
> Ozy
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From nbest at ci.uchicago.edu  Wed Jul  8 18:31:12 2009
From: nbest at ci.uchicago.edu (Neil Best)
Date: Wed Jul  8 18:31:12 2009
Subject: [Gdal-dev] building GDAL under cygwin with ODBC
Message-ID: <1247092272012-3228405.post@n2.nabble.com>


Does anyone know if it's possible?

I said:

./configure --with-odbc=/usr/include/w32api

and then make throws a bunch of errors involving .h files in that directory. 
If anyone has tried this I would appreciate hearing from you.

Would it be any different undr MinGW?  I have never worked with it so I
don't know what to expect.  I just want to be able to wrap ogr2ogr in a bash
script on a WinXP machine.

Thanks.


Neil

-- 
View this message in context: http://n2.nabble.com/building-GDAL-under-cygwin-with-ODBC-tp3228405p3228405.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From sjahputerao at missouri.edu  Wed Jul  8 19:55:22 2009
From: sjahputerao at missouri.edu (sjahputerao)
Date: Wed Jul  8 19:58:16 2009
Subject: [gdal-dev] Blocksize in VRT files
References: <C482FF98AE985A47B8C982FD429C9E3402F5A6F5@daytonmsg2k3.AERO.BALL.COM>
	<4A3AB56E.7080301@loskot.net> <4A55032C.9050209@missouri.edu>
	<200907082351.18145.even.rouault@mines-paris.org>
Message-ID: <47AC1680CE7A8D47ADEA137C742D095D9F2606@UM-XMAIL07.um.umsystem.edu>


Evan,

so the blocksize specification in WarpedVRT can be done only after the file is created? 
Is there a way to specify this beforehand? Perhaps there are some fields in WarpOptions that can be used to specify the blocksize before calling GDALAutoCreateWarpedVRT?

Got it, so I am stucked with 128x128 with regular VRT. 
Thanks.

oz

-----Original Message-----
From: Even Rouault [mailto:even.rouault@mines-paris.org]
Sent: Wed 7/8/2009 4:51 PM
To: gdal-dev@lists.osgeo.org
Cc: sjahputerao
Subject: Re: [gdal-dev] Blocksize in VRT files
 
For WarpedVRT, there are the BlockXSize and BlockYSize elements that can be 
changed in the .VRT file.

For regular VRT, you can't, although it might be desirable in some case of 
specifying it also.

Le Wednesday 08 July 2009 22:35:56 Ozy Sjahputera, vous avez ?crit?:
> I have been using the VRT format a lot lately and loving it!
>
> I created the VRT files in two ways:
> 1). directly writing the XML file (usually using SimpleSource or
> ComplexSource)
> 2). using GDALAutoCreateWarpedVRT()
>
> I found out that the VRT files created using the first method has
> blocksize of 128x128. While VRT files created using
> GDALAutoCreateWarpedVRT() has blocksize of 512x128.
>
> Is there a way for the user to specify VRT file blocksize when creating
> the file using the two methods above?
>
> Thanks
> Ozy
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev



From lists at dipole-consulting.com  Wed Jul  8 20:43:00 2009
From: lists at dipole-consulting.com (Didrik Pinte)
Date: Wed Jul  8 20:49:08 2009
Subject: [gdal-dev] thuban/ gdal  : ERROR 4 not recognized format
Message-ID: <1247100180.4403.515.camel@homer.dipole.lan>

Hi,

I am trying to solve an annoying bug in Thuban. Thuban uses a python
gdalwarp module to reproject raster files.

Since gdal 1.5, everything worked fine. But now the following problem
occurs. 

Loading a new raster in Thuban is done like this :
1. Open the file using gdal.Open() to get some info
2. Open the file using gdal.Open() to get the bbox
3. Reproject and draw the file using a python gdalwarp module [1]
 
When loading the first raster, the file is displayed correctly but after
that every trial to load another file gives the following error (even
loading the same file that worked at the first use):

ERROR 4: `[...]/current/thuban/Data/iceland/island.tif' not recognised
as a supported file format.

The gdal.Open methods continuously return None. There seem to be some
corruption of the module there but I really do not know how to debug
that. 

Do someone know how to debug/solve that ? What could be the cause of
this ?

Thanks in advance for any help.

Didrik


[1]
http://wald.intevation.org/plugins/scmsvn/viewcvs.php/trunk/thuban/libraries/thuban/gdalwarp.cpp?rev=2866&root=thuban&view=markup
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: This is a digitally signed message part
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090709/5c2c9237/attachment.bin
From rubinasultan at gmail.com  Wed Jul  8 23:43:29 2009
From: rubinasultan at gmail.com (Rubina Sultan)
Date: Wed Jul  8 23:43:33 2009
Subject: [gdal-dev] RegisterAll for gdal/ogr Throws an exception in C-sharp
Message-ID: <17e121450907082043tb05618co74c9d855eabd4ee@mail.gmail.com>

Hello All,

I am working on display of S57 vector data using C# ,  visual studio 2005.
The Operating system is Xp. The library is gdal/ogr . As a first step, I am
able to use c-sharp swig binding dll as obtained from FWtool 2.4.2...

I have included the required c-sharp dll's in reference of my project.  I
have also placed all wrap dll's and other dll's found in bin of FWTools in
the bin of my application project and the code is compiling well.

 The code I am trying to execute is ogrinfo from c-sharp sample of gdal/ogr
as in the follwoing link while the error is produced on line
70:  Ogr.RegisterAll();

http://trac.osgeo.org/gdal/browser/trunk/gdal/swig/csharp/apps/ogrinfo.cs

When I execute it, the first function (Register All) of gdal/ogr throws an
exception. the error is: ""The type initializer for 'OSGeo.OGR.Ogr' threw an
exception."  "

The issue is somewhat similar to the posted in the following links.
http://n2.nabble.com/question-about-ogr-td2034353.html#a2034353

 <http://trac.osgeo.org/gdal/browser/trunk/gdal/swig/csharp/apps/ogrinfo.cs>

Please help me in rectifying the issue.
-- 
Thanks & Regards
Rubina Sultan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090709/cb1b6b1a/attachment-0001.html
From adeel.raza at crc.gc.ca  Thu Jul  9 09:47:58 2009
From: adeel.raza at crc.gc.ca (Adeel Raza)
Date: Thu Jul  9 09:48:08 2009
Subject: [gdal-dev] Potential bug with the create function for the "GTiff"
	driver
Message-ID: <4A55F50E.4040300@crc.gc.ca>

Hi,

I'm using gdal 1.6.1 for MSVC9.0 on Windows XP (32-bit platform). I'm 
trying to create a .tif file according to the following code:

    GDALDriver *tifDriver;
    GDALDataset *srcDataset;

    tifDriver = (GDALDriver *)GDALGetDriverByName("GTiff");
    assert(tifDriver != NULL);
    srcDataset = tifDriver->Create("srcDataset.tif", nCols, nRows, 1, 
GDALDataType::GDT_Float32, NULL);
    assert(srcDataset != NULL);


"nCols" is defined as an unsigned short and has a value of 2460. 
Similarly "nRows" is also defined as an unsigned short and has a value 
of 2430.
When I run the code shown above the asserts do not fail. The returned 
dataset however, has wrong values assigned to its data members. The 
values for the data members of "srcDataset" are as follows:

eAccess = 2460;
nRasterXSize = 2430;
nRasterYSize = 1;
nBands = 19035560;
papoBands = 0X00000000;
bForceCahcedIO = 1
nRefCount = 0;
bShared = 0;

The values for nRasterXSize, nRasterYSize, and nBands are wrong (I'm not 
sure about the other data members), and should be as follows:
nRasterXSize = 2460;
nRasterYSize = 2430;
nBands = 1;

Is this a bug in the create function for the "GTiff" driver or am I 
doing something wrong?

Best Regards,
Adeel Raza.


From warmerdam at pobox.com  Thu Jul  9 10:18:15 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Jul  9 10:18:19 2009
Subject: [gdal-dev] Potential bug with the create function for the
	"GTiff" driver
In-Reply-To: <4A55F50E.4040300@crc.gc.ca>
References: <4A55F50E.4040300@crc.gc.ca>
Message-ID: <4A55FC27.10204@pobox.com>

Adeel Raza wrote:
> Hi,
> 
> I'm using gdal 1.6.1 for MSVC9.0 on Windows XP (32-bit platform). I'm 
> trying to create a .tif file according to the following code:
> 
>    GDALDriver *tifDriver;
>    GDALDataset *srcDataset;
> 
>    tifDriver = (GDALDriver *)GDALGetDriverByName("GTiff");
>    assert(tifDriver != NULL);
>    srcDataset = tifDriver->Create("srcDataset.tif", nCols, nRows, 1, 
> GDALDataType::GDT_Float32, NULL);
>    assert(srcDataset != NULL);
> 
> 
> "nCols" is defined as an unsigned short and has a value of 2460. 
> Similarly "nRows" is also defined as an unsigned short and has a value 
> of 2430.
> When I run the code shown above the asserts do not fail. The returned 
> dataset however, has wrong values assigned to its data members. The 
> values for the data members of "srcDataset" are as follows:
> 
> eAccess = 2460;
> nRasterXSize = 2430;
> nRasterYSize = 1;
> nBands = 19035560;
> papoBands = 0X00000000;
> bForceCahcedIO = 1
> nRefCount = 0;
> bShared = 0;
> 
> The values for nRasterXSize, nRasterYSize, and nBands are wrong (I'm not 
> sure about the other data members), and should be as follows:
> nRasterXSize = 2460;
> nRasterYSize = 2430;
> nBands = 1;
> 
> Is this a bug in the create function for the "GTiff" driver or am I 
> doing something wrong?

Adeel,

I presume you inspected the member values in the visual studio
debugging environment?  I suspect you have some sort of versioning
mixup - perhaps you have compiled your mainline using a different
version of the include files than correctly apply to the DLL you
end up invoking.  Alternatively, the debugger is getting confused
due to different structure packing options being used in your
main project compared to what was used in building GDAL itself.

Is the created TIFF correct (if you close it)?  If you are having
trouble getting compatible build options between your application
and the underlying library you may find it safer to use only the
GDAL C API instead of the C++ API in order to avoid subtle issues.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From adeel.raza at crc.gc.ca  Thu Jul  9 11:06:26 2009
From: adeel.raza at crc.gc.ca (Adeel Raza)
Date: Thu Jul  9 11:06:29 2009
Subject: [gdal-dev] Potential bug with the create function for the "GTiff"
	driver
In-Reply-To: <4A55FC27.10204@pobox.com>
References: <4A55F50E.4040300@crc.gc.ca> <4A55FC27.10204@pobox.com>
Message-ID: <4A560772.9090301@crc.gc.ca>

Hi Frank,

To answer your questions:

-    " I presume you inspected the member values in the visual studio
    debugging environment?  I suspect you have some sort of versioning
    mixup - perhaps you have compiled your mainline using a different
    version of the include files than correctly apply to the DLL you
    end up invoking. "
Yes I did inspect the member values in the visual studio debugging 
environment. I'm not exactly sure what you mean by the second line, but 
if you mean that my DLL has been compiled from a different version of 
GDAL than from my import library than that is incorrect. I compiled both 
the import library and the DLL using the gdal 1.6.1 source code and I 
set the MSVC_VER variable to 1500 in the "nmake.opt" file so that the 
"nmake /f makefile.vc" file would compile the library for the MSVC9.0.

-   " Alternatively, the debugger is getting confused
    due to different structure packing options being used in your
    main project compared to what was used in building GDAL itself.  "
I have no idea what the structure packing options for GDAL or my project 
are or how to find out what they are? Any pointers in this area would be 
useful.

-   "Is the created TIFF correct (if you close it)?"
No. I used GDALClose() to close the .tif file and then I opened it using 
GDALOpen() and most of the data members retained their original values 
except the following data members which changed to the indicated values:
nBands = 19036392;
bShared = 19076432;

-   "If you are having
    trouble getting compatible build options between your application
    and the underlying library you may find it safer to use only the
    GDAL C API instead of the C++ API in order to avoid subtle issues."
I'll keep that in mind. Thanks.

Thanks Frank.

Best Regards,
Adeel.

Frank Warmerdam wrote:
> Adeel Raza wrote:
>> Hi,
>>
>> I'm using gdal 1.6.1 for MSVC9.0 on Windows XP (32-bit platform). I'm 
>> trying to create a .tif file according to the following code:
>>
>>    GDALDriver *tifDriver;
>>    GDALDataset *srcDataset;
>>
>>    tifDriver = (GDALDriver *)GDALGetDriverByName("GTiff");
>>    assert(tifDriver != NULL);
>>    srcDataset = tifDriver->Create("srcDataset.tif", nCols, nRows, 1, 
>> GDALDataType::GDT_Float32, NULL);
>>    assert(srcDataset != NULL);
>>
>>
>> "nCols" is defined as an unsigned short and has a value of 2460. 
>> Similarly "nRows" is also defined as an unsigned short and has a 
>> value of 2430.
>> When I run the code shown above the asserts do not fail. The returned 
>> dataset however, has wrong values assigned to its data members. The 
>> values for the data members of "srcDataset" are as follows:
>>
>> eAccess = 2460;
>> nRasterXSize = 2430;
>> nRasterYSize = 1;
>> nBands = 19035560;
>> papoBands = 0X00000000;
>> bForceCahcedIO = 1
>> nRefCount = 0;
>> bShared = 0;
>>
>> The values for nRasterXSize, nRasterYSize, and nBands are wrong (I'm 
>> not sure about the other data members), and should be as follows:
>> nRasterXSize = 2460;
>> nRasterYSize = 2430;
>> nBands = 1;
>>
>> Is this a bug in the create function for the "GTiff" driver or am I 
>> doing something wrong?
>
> Adeel,
>
> I presume you inspected the member values in the visual studio
> debugging environment?  I suspect you have some sort of versioning
> mixup - perhaps you have compiled your mainline using a different
> version of the include files than correctly apply to the DLL you
> end up invoking.  Alternatively, the debugger is getting confused
> due to different structure packing options being used in your
> main project compared to what was used in building GDAL itself.
>
> Is the created TIFF correct (if you close it)?  If you are having
> trouble getting compatible build options between your application
> and the underlying library you may find it safer to use only the
> GDAL C API instead of the C++ API in order to avoid subtle issues.
>
> Best regards,
>

From warmerdam at pobox.com  Thu Jul  9 11:16:07 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Jul  9 11:16:04 2009
Subject: [gdal-dev] Potential bug with the create function for the
	"GTiff" driver
In-Reply-To: <4A560772.9090301@crc.gc.ca>
References: <4A55F50E.4040300@crc.gc.ca> <4A55FC27.10204@pobox.com>
	<4A560772.9090301@crc.gc.ca>
Message-ID: <4A5609B7.1010002@pobox.com>

Adeel Raza wrote:
> Hi Frank,
> 
> To answer your questions:
> 
> -    " I presume you inspected the member values in the visual studio
>    debugging environment?  I suspect you have some sort of versioning
>    mixup - perhaps you have compiled your mainline using a different
>    version of the include files than correctly apply to the DLL you
>    end up invoking. "
> Yes I did inspect the member values in the visual studio debugging 
> environment. I'm not exactly sure what you mean by the second line, but 
> if you mean that my DLL has been compiled from a different version of 
> GDAL than from my import library than that is incorrect. I compiled both 
> the import library and the DLL using the gdal 1.6.1 source code and I 
> set the MSVC_VER variable to 1500 in the "nmake.opt" file so that the 
> "nmake /f makefile.vc" file would compile the library for the MSVC9.0.

Adeel,

I was suggesting any number of possible mixups though this is
unlikely to be the case if you have one and only one version
of GDAL on your system.

> -   " Alternatively, the debugger is getting confused
>    due to different structure packing options being used in your
>    main project compared to what was used in building GDAL itself.  "
> I have no idea what the structure packing options for GDAL or my project 
> are or how to find out what they are? Any pointers in this area would be 
> useful.

I'm no expert on how visual studio handles such things.

> -   "Is the created TIFF correct (if you close it)?"
> No. I used GDALClose() to close the .tif file and then I opened it using 
> GDALOpen() and most of the data members retained their original values 
> except the following data members which changed to the indicated values:
> nBands = 19036392;
> bShared = 19076432;

Please, inspect the resulting file with gdalinfo.  I assume
the visual studio reports on GDAL objects will be wrong regardless
of closing and opening files.

In general I have learned to be suspicious of debugging environments
ability to accurately report the contents of variables, and objects.
Particularly when they are really "owned" by another compilation unit
- such as coming from a DLL.  I have had bad experiences with visual
studio and gdb/dbx on unix.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From hzahiri at gmail.com  Thu Jul  9 11:56:31 2009
From: hzahiri at gmail.com (Hani Zahiri)
Date: Thu Jul  9 11:56:55 2009
Subject: [gdal-dev] How can I read ALOS/PALSAR data using GDAL
Message-ID: <1ea066380907090856x3115aca3w4b2671f047ac3fe5@mail.gmail.com>

Hi,

I am quite new in using GDAL and I need a simple instruction, hopefully in
format of an example, for reading ALOS/PALSAR data.

Many Thanks
Cheers,

Hani
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090709/c5f3fba1/attachment.html
From adeel.raza at crc.gc.ca  Thu Jul  9 12:25:20 2009
From: adeel.raza at crc.gc.ca (Adeel Raza)
Date: Thu Jul  9 12:25:23 2009
Subject: [gdal-dev] Potential bug with the create function for the "GTiff"
	driver
In-Reply-To: <4A5609B7.1010002@pobox.com>
References: <4A55F50E.4040300@crc.gc.ca> <4A55FC27.10204@pobox.com>
	<4A560772.9090301@crc.gc.ca> <4A5609B7.1010002@pobox.com>
Message-ID: <4A5619F0.1090606@crc.gc.ca>

Hi Frank,

I used gdalinfo.exe and it seems that the TIFF file has been created 
properly but the debugging environment is reporting the variables 
incorrectly. Thanks a lot for your help.

Best Regards,
Adeel Raza.

Frank Warmerdam wrote:
> Adeel Raza wrote:
>> Hi Frank,
>>
>> To answer your questions:
>>
>> -    " I presume you inspected the member values in the visual studio
>>    debugging environment?  I suspect you have some sort of versioning
>>    mixup - perhaps you have compiled your mainline using a different
>>    version of the include files than correctly apply to the DLL you
>>    end up invoking. "
>> Yes I did inspect the member values in the visual studio debugging 
>> environment. I'm not exactly sure what you mean by the second line, 
>> but if you mean that my DLL has been compiled from a different 
>> version of GDAL than from my import library than that is incorrect. I 
>> compiled both the import library and the DLL using the gdal 1.6.1 
>> source code and I set the MSVC_VER variable to 1500 in the 
>> "nmake.opt" file so that the "nmake /f makefile.vc" file would 
>> compile the library for the MSVC9.0.
>
> Adeel,
>
> I was suggesting any number of possible mixups though this is
> unlikely to be the case if you have one and only one version
> of GDAL on your system.
>
>> -   " Alternatively, the debugger is getting confused
>>    due to different structure packing options being used in your
>>    main project compared to what was used in building GDAL itself.  "
>> I have no idea what the structure packing options for GDAL or my 
>> project are or how to find out what they are? Any pointers in this 
>> area would be useful.
>
> I'm no expert on how visual studio handles such things.
>
>> -   "Is the created TIFF correct (if you close it)?"
>> No. I used GDALClose() to close the .tif file and then I opened it 
>> using GDALOpen() and most of the data members retained their original 
>> values except the following data members which changed to the 
>> indicated values:
>> nBands = 19036392;
>> bShared = 19076432;
>
> Please, inspect the resulting file with gdalinfo.  I assume
> the visual studio reports on GDAL objects will be wrong regardless
> of closing and opening files.
>
> In general I have learned to be suspicious of debugging environments
> ability to accurately report the contents of variables, and objects.
> Particularly when they are really "owned" by another compilation unit
> - such as coming from a DLL.  I have had bad experiences with visual
> studio and gdb/dbx on unix.
>
> Best regards,

From even.rouault at mines-paris.org  Thu Jul  9 13:58:13 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu Jul  9 13:58:23 2009
Subject: [gdal-dev] thuban/ gdal  : ERROR 4 not recognized format
In-Reply-To: <1247100180.4403.515.camel@homer.dipole.lan>
References: <1247100180.4403.515.camel@homer.dipole.lan>
Message-ID: <200907091958.13969.even.rouault@mines-paris.org>

I see in a call to GDALDestroyDriverManager() in 
http://wald.intevation.org/plugins/scmsvn/viewcvs.php/trunk/thuban/libraries/thuban/gdalwarp.cpp?rev=2866&root=thuban&view=markup.

This is a very bad idea if you intend to call the ProjectRasterFile() method 
several times !! This deregisters all drivers, so this might explain why you 
don't manage to open the file afterwards.

The GDALDestroyDriverManager() method is called in the *utilities* to release 
as much memory as possible to make memory checker tools such as Valgrind 
happy, but they should not be used in the context of a library.

Le Thursday 09 July 2009 02:43:00 Didrik Pinte, vous avez ?crit?:
> Hi,
>
> I am trying to solve an annoying bug in Thuban. Thuban uses a python
> gdalwarp module to reproject raster files.
>
> Since gdal 1.5, everything worked fine. But now the following problem
> occurs.
>
> Loading a new raster in Thuban is done like this :
> 1. Open the file using gdal.Open() to get some info
> 2. Open the file using gdal.Open() to get the bbox
> 3. Reproject and draw the file using a python gdalwarp module [1]
>
> When loading the first raster, the file is displayed correctly but after
> that every trial to load another file gives the following error (even
> loading the same file that worked at the first use):
>
> ERROR 4: `[...]/current/thuban/Data/iceland/island.tif' not recognised
> as a supported file format.
>
> The gdal.Open methods continuously return None. There seem to be some
> corruption of the module there but I really do not know how to debug
> that.
>
> Do someone know how to debug/solve that ? What could be the cause of
> this ?
>
> Thanks in advance for any help.
>
> Didrik
>
>
> [1]
> http://wald.intevation.org/plugins/scmsvn/viewcvs.php/trunk/thuban/librarie
>s/thuban/gdalwarp.cpp?rev=2866&root=thuban&view=markup


From even.rouault at mines-paris.org  Thu Jul  9 14:23:31 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu Jul  9 14:23:41 2009
Subject: [gdal-dev] Newbee - pointers needed
In-Reply-To: <45D1B79D2DCCF34E966D24728765DDB3DF56C1@nhc2ex11.goodrich.root.local>
References: <45D1B79D2DCCF34E966D24728765DDB3DF56BB@nhc2ex11.goodrich.root.local>
	<200907082349.50893.even.rouault@mines-paris.org>
	<45D1B79D2DCCF34E966D24728765DDB3DF56C1@nhc2ex11.goodrich.root.local>
Message-ID: <200907092023.31898.even.rouault@mines-paris.org>

Le Thursday 09 July 2009 00:49:23 Smart, Gary, vous avez ?crit?:
> > >
> > > 1)       How to register map files with the GDAL.
> >
> > You don't "register" maps with GDAL. You open datasets with GDALOpen()
>
> I presume a 'dataset' be more than a single georeferenced file?  i.e. it
> could be a suite a files which together form a greater 'image'.  Or is it
> the case that the application is responsible for maintaining the special
> relationships between composite files?  Does GDAL have any inbuilt
> knowledge about the special relationships of map files which conform to
> known naming standards (e.g. geopoint xyz can be found in file
> AABBCC.tiff)?

A dataset is generally a single georeferenced file. But they are some 
exceptions. For example, the RPFTOC driver will handle several NITF tiles 
from a CADRG/CIB product as a single dataset.

You can also use the Virtual Raster format to make a mosaic of several 
datasets that is handled by GDAL as a single dataset. That can makes your 
life easier. See the documentation of the gdalbuildvrt utility and the VRT 
format on gdal.org

Not sure why naming standards you are refering too.

>
> I can't help feeling that someone must have written something generic which
> would explain the scope of the GDAL in this respect?  I haven't found it
> yet though.

The GDAL docs explains what GDAL does, not what you would like GDAL to do ;-)

>
> > > 2)       How to request areas of map to populate my raster output space
> > > (and how do I ensure only compatible map sources are brought together)
> >
> > GDALRasterIO() / GDALDatasetRasterIO() will fetch data from regions
> > expressed
> > in pixel space of the raster. You can use the affine transform matrix
> > (geotransform) given by GDALGetGeoTransform() to convert between pixel
> > and geo spaces.
>
> So is it the responsibility of the client to determine which file needs to
> be accessed in order to supply raster imagery for geopoint xyz? 

Yes.

> There is 
> no master database somehow held within GDAL which maps geospace to filename
> AABBCC.DDD? 

GDAL is not a database. It is relatively a low level library in the chain of 
mapping applications.

> I have noticed some references to SQL queries - to what 
> database do these relate?

SQL queries are supported by some drivers, but for the vector part (OGR).
For the sake of completeness, I should mention there is ongoing work by a GSOC 
student to provide a driver for the new WKTRaster extension of Postgis. But 
this will not likely be production-ready before a moment.

>
> > Not sure what you mean by "compatible map sources".
> >
> > > 3)       Are tiles of raster map extracted by specifying geo-space
> > > boundaries?
> >
> > See above
> >
> > > 4)       And a million more questions...
> >
> > My understanding of your needs is that MapServer could also be worth
> > exploring.
>
> Well - not exactly.  We need to be rendering into our own space so that we
> can add our own vector/raster overlays into the view.

That's not incompatible at all.There are applications that use MapServer to 
extract raster tiles through WMS queries and display them. MapServer 
determines from your spatial request the relevant datasets to open with GDAL 
and take care of doing any resampling necessary to make them fit. QGIS is an 
example of a desktop application that can use MapServer through WMS. They are 
many others.

>
> > > Can someone point me to some documentation which can put me in the
> > > picture as to how a user might use the GDAL to display maps on the
> > > screen (the fine details of actual rendering are not required - I just
> > > need to know how to get the information from the input files in a
> > > common display format) and perhaps some example code (e.g. to extract
> > > rasterized tiles of a specific geo-area)?
>
> Are there no tutorials along the lines of 'using GDAL to display maps'?
>
> :-)
> :
> > > Just some pointers for some reading are all that I'm after really.
> > >
> > >
> > >
> > > Gary


From adeel.raza at crc.gc.ca  Thu Jul  9 14:38:13 2009
From: adeel.raza at crc.gc.ca (Adeel Raza)
Date: Thu Jul  9 14:38:11 2009
Subject: [gdal-dev] Warping an image using GDALAutoCreateWarpedVRT() and
	other questions
Message-ID: <4A563915.1050500@crc.gc.ca>

Hi,

I'm using the "GTiff" driver and using it to create an empty file. 
Afterwards I write data to the (one and only) rasterband using a float 
array as the buffer (the GDALDataType I use for the GDALDataset is 
GDT_Float32 - I believe that should be ok). Then I warp the image  
using  the GDALAutoCreateWarpedVRT() function. I have noticed that after 
the image is warped, the number of pixels are not the same as the 
original TIFF image. Is this normal? I know this sounds like a stupid 
question, but I need to be sure.

Secondly I was also wondering how the GDALRasterBand::RasterIO() 
function feeds data into the raster band. I make a function call to the 
RasterIO function according to the following code:

    GDALDriver *tifDriver;
    GDALDataset *srcDataset;

    tifDriver = (GDALDriver *)GDALGetDriverByName("GTiff");
    assert(tifDriver != NULL);
    srcDataset = tifDriver->Create("srcDataset.tif", nCols, nRows, 1, 
GDALDataType::GDT_Float32, NULL);
    assert(srcDataset != NULL);

    srcDataset->GetRasterBand(1)->RasterIO(GF_Write, 0, 0, nCols, nRows, 
realCellVals, nCols, nRows, GDALDataType::GDT_Float32, 0 , 0);

Both nCols and nRows are unsigned shorts and realCellVals is defined as 
"float *realCellVals = new float[nCols*nRows];". I have filled 
realCellValls so that the row at the top of the raster image is the 
first row and the row at the bottom of the raster image is the last row 
in the array. Also columns indices increase from left to right. Will 
this implementation work properly with the RasterIO() function or do I 
need to arrange my array in another way? The reason why this is critical 
is so that I can create a north up TIFF image, warp it to the desired 
projection system, and get an affine geo transform of the warped north 
up image so that GT[2] and GT[4] are 0 (GT is the returned affine geo 
transform from the function - GDALDataset::GetGeoTransform()).

Lastly I initially tried the same approach using a virtual database and 
creating it in memory using the GDALDriver::Create() function. I tried 
using the GDALRasterBand::RasterIO() function on the database but I got 
an error saying "writing to VRTWarpedRasterBands is not supported". 
Therefore I had to use the tiff format to warp the image. Is there 
anyway to bypass this so that I don't have to create a temporary tiff 
file to warp my image?

Any help would be greatly appreciated. Thanks.

Best Regards,
Adeel.


From even.rouault at mines-paris.org  Thu Jul  9 14:58:43 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu Jul  9 14:58:54 2009
Subject: [gdal-dev] Warping an image using GDALAutoCreateWarpedVRT() and
	other questions
In-Reply-To: <4A563915.1050500@crc.gc.ca>
References: <4A563915.1050500@crc.gc.ca>
Message-ID: <200907092058.43769.even.rouault@mines-paris.org>

Le Thursday 09 July 2009 20:38:13 Adeel Raza, vous avez ?crit?:
> Hi,
>
> I'm using the "GTiff" driver and using it to create an empty file.
> Afterwards I write data to the (one and only) rasterband using a float
> array as the buffer (the GDALDataType I use for the GDALDataset is
> GDT_Float32 - I believe that should be ok). Then I warp the image
> using  the GDALAutoCreateWarpedVRT() function. I have noticed that after
> the image is warped, the number of pixels are not the same as the
> original TIFF image. Is this normal? I know this sounds like a stupid
> question, but I need to be sure.

Yes it is normal if you change projection. The shape and resolutions of the 
output will not be the same as the input.

>
> Secondly I was also wondering how the GDALRasterBand::RasterIO()
> function feeds data into the raster band. I make a function call to the
> RasterIO function according to the following code:
>
>     GDALDriver *tifDriver;
>     GDALDataset *srcDataset;
>
>     tifDriver = (GDALDriver *)GDALGetDriverByName("GTiff");
>     assert(tifDriver != NULL);
>     srcDataset = tifDriver->Create("srcDataset.tif", nCols, nRows, 1,
> GDALDataType::GDT_Float32, NULL);
>     assert(srcDataset != NULL);
>
>     srcDataset->GetRasterBand(1)->RasterIO(GF_Write, 0, 0, nCols, nRows,
> realCellVals, nCols, nRows, GDALDataType::GDT_Float32, 0 , 0);
>
> Both nCols and nRows are unsigned shorts and realCellVals is defined as
> "float *realCellVals = new float[nCols*nRows];". I have filled
> realCellValls so that the row at the top of the raster image is the
> first row and the row at the bottom of the raster image is the last row
> in the array. Also columns indices increase from left to right. Will
> this implementation work properly with the RasterIO() function or do I
> need to arrange my array in another way? 

I guess you could try and check yourself ;-) If I've understood your 
description, this should work as you expect.

> The reason why this is critical 
> is so that I can create a north up TIFF image, warp it to the desired
> projection system, and get an affine geo transform of the warped north
> up image so that GT[2] and GT[4] are 0 (GT is the returned affine geo
> transform from the function - GDALDataset::GetGeoTransform()).

GDALAutoCreateWarpedVRT() will return a dataset with such characteristics. (to 
be exact, it won't necessary be exactly "north up", it depends on the 
destination projection, but I play a bit on words)

>
> Lastly I initially tried the same approach using a virtual database and
> creating it in memory using the GDALDriver::Create() function. I tried
> using the GDALRasterBand::RasterIO() function on the database but I got
> an error saying "writing to VRTWarpedRasterBands is not supported".

A VRT file can be created (the XML description), and data can be read from it. 
But writing pixels into it doesn't make any sense of course, so the error 
message is logical.

> Therefore I had to use the tiff format to warp the image. Is there
> anyway to bypass this so that I don't have to create a temporary tiff
> file to warp my image?

Yes, I see 2 possibilities : 
* use the MEM driver instead of the GTiff driver to create an in-memory source 
dataset (easiest way)
* use the /vsimem virtual filesystem to creaty an in-memory GeoTIFF file

>
> Any help would be greatly appreciated. Thanks.
>
> Best Regards,
> Adeel.
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From adeel.raza at crc.gc.ca  Thu Jul  9 15:47:16 2009
From: adeel.raza at crc.gc.ca (Adeel Raza)
Date: Thu Jul  9 15:47:21 2009
Subject: [gdal-dev] Warping an image using GDALAutoCreateWarpedVRT() and
	other questions
In-Reply-To: <200907092058.43769.even.rouault@mines-paris.org>
References: <4A563915.1050500@crc.gc.ca>
	<200907092058.43769.even.rouault@mines-paris.org>
Message-ID: <4A564944.6080405@crc.gc.ca>

Hi,

You're awesome Even. I suppose I will give the MEM driver a try as you 
suggested. Thanks so much. :)

Regards,
Adeel.

Even Rouault wrote:
> Le Thursday 09 July 2009 20:38:13 Adeel Raza, vous avez ?crit :
>   
>> Hi,
>>
>> I'm using the "GTiff" driver and using it to create an empty file.
>> Afterwards I write data to the (one and only) rasterband using a float
>> array as the buffer (the GDALDataType I use for the GDALDataset is
>> GDT_Float32 - I believe that should be ok). Then I warp the image
>> using  the GDALAutoCreateWarpedVRT() function. I have noticed that after
>> the image is warped, the number of pixels are not the same as the
>> original TIFF image. Is this normal? I know this sounds like a stupid
>> question, but I need to be sure.
>>     
>
> Yes it is normal if you change projection. The shape and resolutions of the 
> output will not be the same as the input.
>
>   
>> Secondly I was also wondering how the GDALRasterBand::RasterIO()
>> function feeds data into the raster band. I make a function call to the
>> RasterIO function according to the following code:
>>
>>     GDALDriver *tifDriver;
>>     GDALDataset *srcDataset;
>>
>>     tifDriver = (GDALDriver *)GDALGetDriverByName("GTiff");
>>     assert(tifDriver != NULL);
>>     srcDataset = tifDriver->Create("srcDataset.tif", nCols, nRows, 1,
>> GDALDataType::GDT_Float32, NULL);
>>     assert(srcDataset != NULL);
>>
>>     srcDataset->GetRasterBand(1)->RasterIO(GF_Write, 0, 0, nCols, nRows,
>> realCellVals, nCols, nRows, GDALDataType::GDT_Float32, 0 , 0);
>>
>> Both nCols and nRows are unsigned shorts and realCellVals is defined as
>> "float *realCellVals = new float[nCols*nRows];". I have filled
>> realCellValls so that the row at the top of the raster image is the
>> first row and the row at the bottom of the raster image is the last row
>> in the array. Also columns indices increase from left to right. Will
>> this implementation work properly with the RasterIO() function or do I
>> need to arrange my array in another way? 
>>     
>
> I guess you could try and check yourself ;-) If I've understood your 
> description, this should work as you expect.
>
>   
>> The reason why this is critical 
>> is so that I can create a north up TIFF image, warp it to the desired
>> projection system, and get an affine geo transform of the warped north
>> up image so that GT[2] and GT[4] are 0 (GT is the returned affine geo
>> transform from the function - GDALDataset::GetGeoTransform()).
>>     
>
> GDALAutoCreateWarpedVRT() will return a dataset with such characteristics. (to 
> be exact, it won't necessary be exactly "north up", it depends on the 
> destination projection, but I play a bit on words)
>
>   
>> Lastly I initially tried the same approach using a virtual database and
>> creating it in memory using the GDALDriver::Create() function. I tried
>> using the GDALRasterBand::RasterIO() function on the database but I got
>> an error saying "writing to VRTWarpedRasterBands is not supported".
>>     
>
> A VRT file can be created (the XML description), and data can be read from it. 
> But writing pixels into it doesn't make any sense of course, so the error 
> message is logical.
>
>   
>> Therefore I had to use the tiff format to warp the image. Is there
>> anyway to bypass this so that I don't have to create a temporary tiff
>> file to warp my image?
>>     
>
> Yes, I see 2 possibilities : 
> * use the MEM driver instead of the GTiff driver to create an in-memory source 
> dataset (easiest way)
> * use the /vsimem virtual filesystem to creaty an in-memory GeoTIFF file
>
>   
>> Any help would be greatly appreciated. Thanks.
>>
>> Best Regards,
>> Adeel.
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>     
>
>
>
>   

From Shawn.Gong at drdc-rddc.gc.ca  Thu Jul  9 16:40:11 2009
From: Shawn.Gong at drdc-rddc.gc.ca (Gong, Shawn (Contractor))
Date: Thu Jul  9 16:40:16 2009
Subject: [gdal-dev] gdal NITF complex driver question
In-Reply-To: <DF1471B5C308B346BF5A2AEA00C5615E26E9E1@ottawaex02.Ottawa.drdc-rddc.gc.ca>
References: <DF1471B5C308B346BF5A2AEA00C5615E26E9E1@ottawaex02.Ottawa.drdc-rddc.gc.ca>
Message-ID: <DF1471B5C308B346BF5A2AEA00C5615E26E9E4@ottawaex02.Ottawa.drdc-rddc.gc.ca>

hi list,

We made a slight modification in gdal/frmts/nitf/nitfdataset.cpp to add
support for RADARSAT-2 NITF Single Look Complex format.

in NITFRasterBand::NITFRasterBand( NITFDataset *poDS, int nBand )
/* --------------------------------------------------------------------
*/
/*      Translate data type(s).
*/
/* --------------------------------------------------------------------
*/
added:
    else if( psImage->nBitsPerSample == 64 
             && EQUAL(psImage->szPVType,"C") )
        eDataType = GDT_CFloat32;


However we found that the real and imaginary fields come out switched.
i.e. the gdal driver put Q in front of I.
We used OpenEV and gdal_translate to confirm that.

Any thoughts and help are appreciated.

thanks,
Shawn



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090709/d60ac07e/attachment.html
From even.rouault at mines-paris.org  Thu Jul  9 17:07:58 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu Jul  9 17:08:11 2009
Subject: [gdal-dev] gdal NITF complex driver question
In-Reply-To: <DF1471B5C308B346BF5A2AEA00C5615E26E9E4@ottawaex02.Ottawa.drdc-rddc.gc.ca>
References: <DF1471B5C308B346BF5A2AEA00C5615E26E9E1@ottawaex02.Ottawa.drdc-rddc.gc.ca>
	<DF1471B5C308B346BF5A2AEA00C5615E26E9E4@ottawaex02.Ottawa.drdc-rddc.gc.ca>
Message-ID: <200907092308.00127.even.rouault@mines-paris.org>

Shawn,

I'm not surprised. Someone already provided quite the same patch in 
http://trac.osgeo.org/gdal/ticket/2526 but I had a doubt about missing 
swapping of real and imaginary fields. As I couldn't test not having test 
data, this wasn't applied.

Could you also apply the attached patch to nitfimage.c (from trunk) and 
confirm if it does correct byte-swapping ? Anyway, attaching test data to the 
above ticket would be really great to avoid blind guessing !

Best regards,
Even


Le Thursday 09 July 2009 22:40:11 Gong, Shawn (Contractor), vous avez ?crit?:
> hi list,
>
> We made a slight modification in gdal/frmts/nitf/nitfdataset.cpp to add
> support for RADARSAT-2 NITF Single Look Complex format.
>
> in NITFRasterBand::NITFRasterBand( NITFDataset *poDS, int nBand )
> /* --------------------------------------------------------------------
> */
> /*      Translate data type(s).
> */
> /* --------------------------------------------------------------------
> */
> added:
>     else if( psImage->nBitsPerSample == 64
>              && EQUAL(psImage->szPVType,"C") )
>         eDataType = GDT_CFloat32;
>
>
> However we found that the real and imaginary fields come out switched.
> i.e. the gdal driver put Q in front of I.
> We used OpenEV and gdal_translate to confirm that.
>
> Any thoughts and help are appreciated.
>
> thanks,
> Shawn


-------------- next part --------------
A non-text attachment was scrubbed...
Name: nitf_complex_byte_swapping.patch
Type: text/x-diff
Size: 5116 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090709/a0c631be/nitf_complex_byte_swapping.bin
From belaid_moa at hotmail.com  Thu Jul  9 18:19:20 2009
From: belaid_moa at hotmail.com (Belaid MOA)
Date: Thu Jul  9 18:20:22 2009
Subject: [gdal-dev] The use of GDALColorTable
Message-ID: <COL113-W1896FC177EDD8B2B68B785F4260@phx.gbl>





Greetings everyone,
  I noticed that some of the GTiff images I am working with are single bands and have a ColorInterp=Palette (they are colored when viewed in tiff viewer). So, I assume they are using a Color Table to achieve that. Am I right? Where can I find some tutorials or C/C++ examples using GDALColorTable to associate a color table with a single band image?

  Any help on this is greatly appreciated!

Thanks a lot in advance.
Belaid Moa.
   


_________________________________________________________________
Attention all humans. We are your photos. Free us.
http://go.microsoft.com/?linkid=9666046
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090709/6b32ce35/attachment.html
From warmerdam at pobox.com  Thu Jul  9 20:59:31 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Jul  9 20:59:27 2009
Subject: [gdal-dev] The use of GDALColorTable
In-Reply-To: <COL113-W1896FC177EDD8B2B68B785F4260@phx.gbl>
References: <COL113-W1896FC177EDD8B2B68B785F4260@phx.gbl>
Message-ID: <4A569273.5040007@pobox.com>

Belaid MOA wrote:
> Greetings everyone,
>   I noticed that some of the GTiff images I am working with are single 
> bands and have a ColorInterp=Palette (they are colored when viewed in 
> tiff viewer). So, I assume they are using a Color Table to achieve that. 
> Am I right? Where can I find some tutorials or C/C++ examples using 
> GDALColorTable to associate a color table with a single band image?

Belaid,


The following is an example of creating a color table:

             // Allocate memory for colour table and read it
             if ( poDS->sInfoHeader.iClrUsed )
                 poDS->nColorTableSize = poDS->sInfoHeader.iClrUsed;
             else
                 poDS->nColorTableSize = 1 << poDS->sInfoHeader.iBitCount;
             poDS->pabyColorTable =
                 (GByte *)VSIMalloc2( poDS->nColorElems, poDS->nColorTableSize );
             if (poDS->pabyColorTable == NULL)
             {
                 CPLError(CE_Failure, CPLE_OutOfMemory, "Color palette will be 
ignored");
                 poDS->nColorTableSize = 0;
                 break;
             }

             VSIFSeekL( poDS->fp, BFH_SIZE + poDS->sInfoHeader.iSize, SEEK_SET );
             VSIFReadL( poDS->pabyColorTable, poDS->nColorElems,
                       poDS->nColorTableSize, poDS->fp );

             GDALColorEntry oEntry;
             poDS->poColorTable = new GDALColorTable();
             for( i = 0; i < poDS->nColorTableSize; i++ )
             {
                 oEntry.c1 = poDS->pabyColorTable[i * poDS->nColorElems + 2]; 
// Red
                 oEntry.c2 = poDS->pabyColorTable[i * poDS->nColorElems + 1]; 
// Green
                 oEntry.c3 = poDS->pabyColorTable[i * poDS->nColorElems]; 
// Blue
                 oEntry.c4 = 255;

                 poDS->poColorTable->SetColorEntry( i, &oEntry );
             }

The color table can be associated with a band using:

   GDALSetColorTable(GDALRasterBandH,GDALColorTableH);

In the case of creating a GeoTIFF file, you may need to
pass the creation option PHOTOMETRIC=PALETTE to ensure the
created file has a palette.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From belaid_moa at hotmail.com  Thu Jul  9 21:39:38 2009
From: belaid_moa at hotmail.com (Belaid MOA)
Date: Thu Jul  9 21:39:41 2009
Subject: [gdal-dev] The use of GDALColorTable
In-Reply-To: <4A569273.5040007@pobox.com>
References: <COL113-W1896FC177EDD8B2B68B785F4260@phx.gbl>
	<4A569273.5040007@pobox.com>
Message-ID: <COL113-W3193FBB8FC4D34E9718673F4270@phx.gbl>


Thank you very very much Frank for your help.
With best regards.
Belaid Moa.
> Date: Thu, 9 Jul 2009 20:59:31 -0400
> From: warmerdam@pobox.com
> To: belaid_moa@hotmail.com
> CC: gdal-dev@lists.osgeo.org
> Subject: Re: [gdal-dev] The use of GDALColorTable
> 
> Belaid MOA wrote:
> > Greetings everyone,
> >   I noticed that some of the GTiff images I am working with are single 
> > bands and have a ColorInterp=Palette (they are colored when viewed in 
> > tiff viewer). So, I assume they are using a Color Table to achieve that. 
> > Am I right? Where can I find some tutorials or C/C++ examples using 
> > GDALColorTable to associate a color table with a single band image?
> 
> Belaid,
> 
> 
> The following is an example of creating a color table:
> 
>              // Allocate memory for colour table and read it
>              if ( poDS->sInfoHeader.iClrUsed )
>                  poDS->nColorTableSize = poDS->sInfoHeader.iClrUsed;
>              else
>                  poDS->nColorTableSize = 1 << poDS->sInfoHeader.iBitCount;
>              poDS->pabyColorTable =
>                  (GByte *)VSIMalloc2( poDS->nColorElems, poDS->nColorTableSize );
>              if (poDS->pabyColorTable == NULL)
>              {
>                  CPLError(CE_Failure, CPLE_OutOfMemory, "Color palette will be 
> ignored");
>                  poDS->nColorTableSize = 0;
>                  break;
>              }
> 
>              VSIFSeekL( poDS->fp, BFH_SIZE + poDS->sInfoHeader.iSize, SEEK_SET );
>              VSIFReadL( poDS->pabyColorTable, poDS->nColorElems,
>                        poDS->nColorTableSize, poDS->fp );
> 
>              GDALColorEntry oEntry;
>              poDS->poColorTable = new GDALColorTable();
>              for( i = 0; i < poDS->nColorTableSize; i++ )
>              {
>                  oEntry.c1 = poDS->pabyColorTable[i * poDS->nColorElems + 2]; 
> // Red
>                  oEntry.c2 = poDS->pabyColorTable[i * poDS->nColorElems + 1]; 
> // Green
>                  oEntry.c3 = poDS->pabyColorTable[i * poDS->nColorElems]; 
> // Blue
>                  oEntry.c4 = 255;
> 
>                  poDS->poColorTable->SetColorEntry( i, &oEntry );
>              }
> 
> The color table can be associated with a band using:
> 
>    GDALSetColorTable(GDALRasterBandH,GDALColorTableH);
> 
> In the case of creating a GeoTIFF file, you may need to
> pass the creation option PHOTOMETRIC=PALETTE to ensure the
> created file has a palette.
> 
> Best regards,
> -- 
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
> 

_________________________________________________________________
Create a cool, new character for your Windows Live? Messenger. 
http://go.microsoft.com/?linkid=9656621
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090710/ef16e0c7/attachment-0001.html
From Shawn.Gong at drdc-rddc.gc.ca  Thu Jul  9 15:39:30 2009
From: Shawn.Gong at drdc-rddc.gc.ca (Gong, Shawn (Contractor))
Date: Fri Jul 10 01:39:40 2009
Subject: [gdal-dev] NITF complex driver question
Message-ID: <DF1471B5C308B346BF5A2AEA00C5615E26E9E1@ottawaex02.Ottawa.drdc-rddc.gc.ca>

hi list,

We made a slight modification in gdal/frmts/nitf/nitfdataset.cpp to add
support for RADARSAT-2 NITF Single Look Complex format.

in NITFRasterBand::NITFRasterBand( NITFDataset *poDS, int nBand )
/* --------------------------------------------------------------------
*/
/*      Translate data type(s).
*/
/* --------------------------------------------------------------------
*/
added:
    else if( psImage->nBitsPerSample == 64 
             && EQUAL(psImage->szPVType,"C") )
        eDataType = GDT_CFloat32;


However we found that the real and imaginary fields come out switched.
i.e. the gdal driver put Q in front of I.
We used OpenEV and gdal_translate to confirm that.

Any thoughts and help are appreciated.

thanks,
Shawn



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090709/c391d679/attachment.html
From lists at dipole-consulting.com  Fri Jul 10 03:07:47 2009
From: lists at dipole-consulting.com (Didrik Pinte)
Date: Fri Jul 10 03:07:42 2009
Subject: [gdal-dev] thuban/ gdal  : ERROR 4 not recognized format
In-Reply-To: <200907091958.13969.even.rouault@mines-paris.org>
References: <1247100180.4403.515.camel@homer.dipole.lan>
	<200907091958.13969.even.rouault@mines-paris.org>
Message-ID: <1247209667.4403.534.camel@homer.dipole.lan>

On Thu, 2009-07-09 at 19:58 +0200, Even Rouault wrote:
> I see in a call to GDALDestroyDriverManager() in 
> http://wald.intevation.org/plugins/scmsvn/viewcvs.php/trunk/thuban/libraries/thuban/gdalwarp.cpp?rev=2866&root=thuban&view=markup.
> 
> This is a very bad idea if you intend to call the ProjectRasterFile() method 
> several times !! This deregisters all drivers, so this might explain why you 
> don't manage to open the file afterwards.
> 
> The GDALDestroyDriverManager() method is called in the *utilities* to release 
> as much memory as possible to make memory checker tools such as Valgrind 
> happy, but they should not be used in the context of a library.

Hi Evan,

You rock ! The problem is solved.

I have removed the call to GDALDestroyDriverManager() and rebuild the
app. It works fine now ! All the tests passes and the app loads multiple
files without any problems.

Thanks for taking the time to have a look at the file and for your help.

-- Didrik
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: This is a digitally signed message part
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090710/6df7e65e/attachment.bin
From lists at fuchsschwanzdomain.de  Fri Jul 10 05:34:32 2009
From: lists at fuchsschwanzdomain.de (Sven Geggus)
Date: Fri Jul 10 05:44:45 2009
Subject: [gdal-dev] ogr2ogr natgrids option ignored?
Message-ID: <h371v8$8oo$1@ultimate100.geggus.net>

Hi there,

looks like ogr2ogr just ignores my nadgrids projection parameters :(

Here is what I have:

ogr2ogr -s_srs '+proj=tmerc +lat_0=0 +lon_0=12 +x_0=4500000 +y_0=0 \
+k=1.000000 +ellps=bessel +units=m +nadgrids=./BETA2007.gsb' \
-t_srs '+proj=longlat +datum=WGS84' -f "ESRI Shapefile" out.shp in.shp

ogr2ogr -s_srs epsg:31468 -t_srs epsg:4326 -f "ESRI Shapefile" out.shp in.shp

While the latter works fine. The first version does not seem to honor the
nadgrids Option. This is at least what strace hints me to. The command does
not even try to open the BETA2007.gsb file.

Testing the same Parameters wirth cs2cs does work as expected and
BETA2007.gsb _is_ honored:

echo 4450457 5487214 | cs2cs -f "%.12f" +proj=tmerc +lat_0=0 +lon_0=12 \
+x_0=4500000 +y_0=0 +k=1.000000 +ellps=bessel +units=m \
+nadgrids=./BETA2007.gsb +to +init=epsg:4326

Regards

Sven

P.S.: I checked with ogr2ogg from gdal 1.5.2 and 1.6.1

-- 
/*
 * Wirzenius wrote this portably, Torvalds fucked it up :-)
 */                        (taken from /usr/src/linux/lib/vsprintf.c)
/me is giggls@ircnet, http://sven.gegg.us/ on the Web
From bartvde at osgis.nl  Fri Jul 10 08:10:03 2009
From: bartvde at osgis.nl (bartvde@osgis.nl)
Date: Fri Jul 10 08:56:56 2009
Subject: [gdal-dev] CSV filesize and OVF
Message-ID: <40814.145.50.39.11.1247227803.squirrel@webmail.hostingdiscounter.nl>

Hi list,

I've got a CSV file with about 50.000 lines.

Running ogrinfo on it directly goes smoothly, but if I access it using an
ovf file it won't work.

It will work if I split up the large file in 2 files.

Is there a known limit I am running into?

Best regards,
Bart

From Shawn.Gong at drdc-rddc.gc.ca  Fri Jul 10 09:54:24 2009
From: Shawn.Gong at drdc-rddc.gc.ca (Gong, Shawn (Contractor))
Date: Fri Jul 10 09:54:28 2009
Subject: [gdal-dev] gdal NITF complex driver question
In-Reply-To: <200907092308.00127.even.rouault@mines-paris.org>
References: <DF1471B5C308B346BF5A2AEA00C5615E26E9E1@ottawaex02.Ottawa.drdc-rddc.gc.ca>
	<DF1471B5C308B346BF5A2AEA00C5615E26E9E4@ottawaex02.Ottawa.drdc-rddc.gc.ca>
	<200907092308.00127.even.rouault@mines-paris.org>
Message-ID: <DF1471B5C308B346BF5A2AEA00C5615E26E9E8@ottawaex02.Ottawa.drdc-rddc.gc.ca>


Thanks Even.

I will try the patch and report back.

Shawn


-----Original Message-----
From: Even Rouault [mailto:even.rouault@mines-paris.org] 
Sent: Thursday, July 09, 2009 5:08 PM
To: gdal-dev@lists.osgeo.org
Cc: Gong, Shawn (Contractor)
Subject: Re: [gdal-dev] gdal NITF complex driver question

Shawn,

I'm not surprised. Someone already provided quite the same patch in 
http://trac.osgeo.org/gdal/ticket/2526 but I had a doubt about missing 
swapping of real and imaginary fields. As I couldn't test not having test 
data, this wasn't applied.

Could you also apply the attached patch to nitfimage.c (from trunk) and 
confirm if it does correct byte-swapping ? Anyway, attaching test data to the 
above ticket would be really great to avoid blind guessing !

Best regards,
Even


Le Thursday 09 July 2009 22:40:11 Gong, Shawn (Contractor), vous avez ?crit?:
> hi list,
>
> We made a slight modification in gdal/frmts/nitf/nitfdataset.cpp to add
> support for RADARSAT-2 NITF Single Look Complex format.
>
> in NITFRasterBand::NITFRasterBand( NITFDataset *poDS, int nBand )
> /* --------------------------------------------------------------------
> */
> /*      Translate data type(s).
> */
> /* --------------------------------------------------------------------
> */
> added:
>     else if( psImage->nBitsPerSample == 64
>              && EQUAL(psImage->szPVType,"C") )
>         eDataType = GDT_CFloat32;
>
>
> However we found that the real and imaginary fields come out switched.
> i.e. the gdal driver put Q in front of I.
> We used OpenEV and gdal_translate to confirm that.
>
> Any thoughts and help are appreciated.
>
> thanks,
> Shawn


From warmerdam at pobox.com  Fri Jul 10 11:09:04 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Jul 10 11:08:53 2009
Subject: [gdal-dev] CSV filesize and OVF
In-Reply-To: <40814.145.50.39.11.1247227803.squirrel@webmail.hostingdiscounter.nl>
References: <40814.145.50.39.11.1247227803.squirrel@webmail.hostingdiscounter.nl>
Message-ID: <4A575990.8020306@pobox.com>

bartvde@osgis.nl wrote:
> Hi list,
> 
> I've got a CSV file with about 50.000 lines.
> 
> Running ogrinfo on it directly goes smoothly, but if I access it using an
> ovf file it won't work.
> 
> It will work if I split up the large file in 2 files.
> 
> Is there a known limit I am running into?

Bart,

I have no idea why this would happen.  Perhaps you could file a ticket
and point to the data and we could dig into it.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Fri Jul 10 11:13:08 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Jul 10 11:13:00 2009
Subject: [gdal-dev] ogr2ogr natgrids option ignored?
In-Reply-To: <h371v8$8oo$1@ultimate100.geggus.net>
References: <h371v8$8oo$1@ultimate100.geggus.net>
Message-ID: <4A575A84.7040903@pobox.com>

Sven Geggus wrote:
> Hi there,
> 
> looks like ogr2ogr just ignores my nadgrids projection parameters :(
> 
> Here is what I have:
> 
> ogr2ogr -s_srs '+proj=tmerc +lat_0=0 +lon_0=12 +x_0=4500000 +y_0=0 \
> +k=1.000000 +ellps=bessel +units=m +nadgrids=./BETA2007.gsb' \
> -t_srs '+proj=longlat +datum=WGS84' -f "ESRI Shapefile" out.shp in.shp
> 
> ogr2ogr -s_srs epsg:31468 -t_srs epsg:4326 -f "ESRI Shapefile" out.shp in.shp
> 
> While the latter works fine. The first version does not seem to honor the
> nadgrids Option. This is at least what strace hints me to. The command does
> not even try to open the BETA2007.gsb file.
> 
> Testing the same Parameters wirth cs2cs does work as expected and
> BETA2007.gsb _is_ honored:
> 
> echo 4450457 5487214 | cs2cs -f "%.12f" +proj=tmerc +lat_0=0 +lon_0=12 \
> +x_0=4500000 +y_0=0 +k=1.000000 +ellps=bessel +units=m \
> +nadgrids=./BETA2007.gsb +to +init=epsg:4326

Sven,

The thing to know about using PROJ.4 strings with GDAL/OGR is that GDAL/OGR
internally turns them into WKT.  Anything in a PROJ.4 string that is not
preserved in the WKT is lost - and this includes nadgrids directives for
which there is no obvious WKT analog.

One workaround is to add +wktext to the PROJ.4 definition.  This tells
GDAL to embed a complete copy of the PROJ.4 definition in the WKT as
an EXTENSION element so the original PROJ.4 string can be reconsistuted
exactly later.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From scott.sinclair.za at gmail.com  Fri Jul 10 11:45:50 2009
From: scott.sinclair.za at gmail.com (Scott Sinclair)
Date: Fri Jul 10 11:45:53 2009
Subject: [gdal-dev] can't open grib2 files
In-Reply-To: <4A572783.3010406@meteogalicia.es>
References: <4A48A2F3.6080804@meteogalicia.es>
	<6a17e9ee0906290608v6b5d7f2ewda769988ff1f0e12@mail.gmail.com>
	<4A48C173.9060802@meteogalicia.es>
	<6a17e9ee0906300432y1afd10ccqb92f3c9b500a9c5b@mail.gmail.com>
	<4A572783.3010406@meteogalicia.es>
Message-ID: <6a17e9ee0907100845l6233825dob07f230638f1c3e@mail.gmail.com>

Hi Alberto,

I'm not sure what's going on, without poking into the GDAL source code
(with which I'm really not that familiar).

I typically use the pygrib2 package to handle GRIB2 data
(http://code.google.com/p/pygrib2). Under the hood this package uses
g2clib (found at http://www.nco.ncep.noaa.gov/pmb/codes/GRIB2). The
GDAL GRIB driver uses degrib (http://www.nws.noaa.gov/mdl/degrib),
which is also based on (an older version of) g2clib.

I had noticed that the outputs from gdal_translate for the EUMETSAT
MPE data appeared binary in nature, but didn't spend much time
investigating and assumed that my viewer program was just having
trouble representing the large range of values properly (no-data
values are very different from the rainfall values).

I believe that a robust GDAL GRIB driver may be tricky to implement
properly, because the GRIB1/2 data model is more flexible than a GDAL
Raster Dataset. I would still expect the current driver to give
sensible results in this case though, perhaps someone more
knowledgeable could comment..

No problem bothering me directly, but it's usually more likely that
you'll get the best information from a larger audience. If you could
make your example files available on the web, it will probably be
useful, I haven't attached them to this mail.

Cheers,
Scott

> 2009/7/10 Alberto Pettazzi <alberto.pettazzi@meteogalicia.es>:
> Dear Scott,
>
> sorry for disturbing you once more, but I am still having problems with the
> grib files of rainfall estimates...
> I created a tif file from the grib2 file, with the command you suggested me
>
> gdal_translate -b 1 MPE_20090709_1200_M9_00.grb MPE_20090709_1200_M9_00.tif
>
> It works fine. But, when I try to open with a Geotiff viewer (for example,
> QGis or typing gdalinfo -mm) in order to look at the values, I realize that
> the image only contains 0 or 9999. The tiff should appear like the .jpg I
> attached (actually, the jpeg corresponds to the grib file I attached).
> I tried also different options, in the gdal_translate command, for example
> gdal_translate -b 1 MPE_20090709_1200_M9_00.grb MPE_20090709_1200_M9_00.tif
> -a_nodata 111 -ot Float32 -strict
> but with no success.
>
> Any idea?
>
> thank you and sorry for bothering you
>
> Alberto Pettazzi
>
>
> MeteoGalicia - Departamento de Climatolog?a y Observaci?n
>
> Conseller?a de Medio Ambiente, Territorio e Infraestruturas
>
> R?a de Roma, 6
>
> 15707 Santiago de Compostela. A Coru?a
>
>
> Tel?fono: +34-881-999646
>
>
> e-mail: alberto.pettazzi@meteogalicia.es
> <mailto:alberto.pettazzi@meteogalicia.es>
>
>
>
>
> Scott Sinclair escribi?:
>>
>> When you run gdalinfo on the input file you'll see that the GRIB file
>> has 3 bands. The last two are quality flags at a different spatial
>> resolution to the rainfall estimates (it seems that's what causes the
>> GRIB driver to choke). See
>>
>> http://www.eumetsat.int/groups/ops/documents/document/pdf_metprod_mpe_quality_info.pdf
>>
>> Using the -b flag to gdal_translate works for me:
>>
>> $ gdalinfo --version
>> GDAL 1.6.1, released 2009/05/11
>> $ gdal_translate -b 1 MPE_20090629_0900_M9_00.grb
>> MPE_20090629_0900_M9_00.tif
>> $ gdalinfo MPE_20090629_0900_M9_00.tif
>> Driver: GTiff/GeoTIFF
>> Files: MPE_20090629_0900_M9_00.tif
>> Size is 3712, 3712
>> Coordinate System is:
>> LOCAL_CS["unnamed",
>> ? ?UNIT["metre",1,
>> ? ? ? ?AUTHORITY["EPSG","9001"]]]
>> Origin = (-5568748.275999999605119,5568748.275999999605119)
>> Pixel Size = (3000.403165948275728,-3000.403165948275728)
>> Metadata:
>> ?AREA_OR_POINT=Area
>> Image Structure Metadata:
>> ?INTERLEAVE=BAND
>> Corner Coordinates:
>> Upper Left ?(-5568748.276, 5568748.276)
>> Lower Left ?(-5568748.276,-5568748.276)
>> Upper Right ( 5568748.276, 5568748.276)
>> Lower Right ( 5568748.276,-5568748.276)
>> Center ? ? ?( ? 0.0000000, ?-0.0000000)
>> Band 1 Block=3712x1 Type=Float64, ColorInterp=Gray
>> ?Metadata:
>> ? ?GRIB_UNIT=[kg/(m^2*s)]
>> ? ?GRIB_COMMENT=Instantaneous rain rate [kg/(m^2*s)]
>> ? ?GRIB_SHORT_NAME=0 undefined
>> ? ?GRIB_REF_TIME=1246266000 sec UTC
>> ? ?GRIB_VALID_TIME=1246266000 sec UTC
>> ? ?GRIB_FORECAST_SECONDS=0 sec
>> ? ?GRIB_PDS_PDTN=30
>> ? ?GRIB_PDS_TEMPLATE_NUMBERS=1 1 8 7 1 1 77 0 56 207 255 255 255 255 255
>>
>> Cheers,
>> Scott
>>
>>
>
From gfiske at whrc.org  Fri Jul 10 12:39:07 2009
From: gfiske at whrc.org (Greg Fiske)
Date: Fri Jul 10 12:54:30 2009
Subject: [gdal-dev] mean of pixel stack
Message-ID: <002f01ca017c$f1d45f40$d57d1dc0$@org>

Dear list,

 

Does anyone have some code (or methodology) that they are willing to share
that will take a stack of images and

return the mean or std dev. of each pixel stack (pixels that occupy the same
space), while ignoring a user define pixel value?

 

Thanks for any advice,

 

Greg

 

 

Greg Fiske

Research Associate/GIS Manager

The Woods Hole Research Center

149 Woods Hole Road

Falmouth MA, 02540

508-540-9900x139

gfiske@whrc.org

http://whrc.org

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090710/75d10740/attachment.html
From jorge.arevalo at gmail.com  Fri Jul 10 13:13:08 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Fri Jul 10 13:13:30 2009
Subject: [gdal-dev] Questions about SQL cursors in GDAL driver
Message-ID: <cb4457700907101013m19752e8epe267f993648192f4@mail.gmail.com>

Hello,

Context: GDAL WKTRaster Driver. When creating Dataset, I declare a
cursor to read all the rows (tiles) of a table with a raster column
(DECLARE cursor CURSOR FOR SELECT * FROM TABLE). The RasterBand should
read one of the rows' band

Question 1: The cursor is created during the Dataset creation, and
stored in it. Should I start a transaction before? If yes, when should
I close the cursor and end the transaction? When calling to Dataset's
destructor?
Question 2: What approach is better?
     a) The Dataset fetchs all the rows (tiles) of the table just
after declaring the cursor, and the RasterBand moves over the
resultset using PQgetvalue and read one band of the read raster
     b) The Dataset declare the cursor and the RasterBand fetchs the
row that needs to read one of its bands

Thanks in advance.

Best regards
Jorge
From jorge.arevalo at gmail.com  Fri Jul 10 13:30:29 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Fri Jul 10 13:30:51 2009
Subject: [gdal-dev] Re: Questions about SQL cursors in GDAL driver
In-Reply-To: <cb4457700907101013m19752e8epe267f993648192f4@mail.gmail.com>
References: <cb4457700907101013m19752e8epe267f993648192f4@mail.gmail.com>
Message-ID: <cb4457700907101030w1d87bab1k533dccd3920cb941@mail.gmail.com>

Answering myself...

2009/7/10 Jorge Ar?valo <jorge.arevalo@gmail.com>:
> Hello,
>
> Context: GDAL WKTRaster Driver. When creating Dataset, I declare a
> cursor to read all the rows (tiles) of a table with a raster column
> (DECLARE cursor CURSOR FOR SELECT * FROM TABLE). The RasterBand should
> read one of the rows' band
>
> Question 1: The cursor is created during the Dataset creation, and
> stored in it. Should I start a transaction before? If yes, when should
> I close the cursor and end the transaction? When calling to Dataset's
> destructor?
Answer: Of course, I should create a transaction to declare a cursor
(stupid question). This question remains: when should I close the
cursor and end transaction?


> Question 2: What approach is better?
> ? ? a) The Dataset fetchs all the rows (tiles) of the table just
> after declaring the cursor, and the RasterBand moves over the
> resultset using PQgetvalue and read one band of the read raster
> ? ? b) The Dataset declare the cursor and the RasterBand fetchs the
> row that needs to read one of its bands
>
> Thanks in advance.
>
> Best regards
> Jorge
>
From warmerdam at pobox.com  Fri Jul 10 14:22:20 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Jul 10 14:22:12 2009
Subject: [gdal-dev] Questions about SQL cursors in GDAL driver
In-Reply-To: <cb4457700907101013m19752e8epe267f993648192f4@mail.gmail.com>
References: <cb4457700907101013m19752e8epe267f993648192f4@mail.gmail.com>
Message-ID: <4A5786DC.1090807@pobox.com>

Jorge Ar?valo wrote:
> Hello,
> 
> Context: GDAL WKTRaster Driver. When creating Dataset, I declare a
> cursor to read all the rows (tiles) of a table with a raster column
> (DECLARE cursor CURSOR FOR SELECT * FROM TABLE). The RasterBand should
> read one of the rows' band
> 
> Question 1: The cursor is created during the Dataset creation, and
> stored in it. Should I start a transaction before? If yes, when should
> I close the cursor and end the transaction? When calling to Dataset's
> destructor?

Jorge,

Ideally you would issue the query when the resultset is first needed
which would presumably be when the first IReadBlock() call is made.
This would keep down overhead for lightweight open's (ie. for gdalinfo)
that don't really need the raster data.

Presumably the cursor would be closed in the dataset descructor.

> Question 2: What approach is better?
>      a) The Dataset fetchs all the rows (tiles) of the table just
> after declaring the cursor, and the RasterBand moves over the
> resultset using PQgetvalue and read one band of the read raster

>      b) The Dataset declare the cursor and the RasterBand fetchs the
> row that needs to read one of its bands

Hmm, thinking slightly deeper here, for the regular_blocking
case I believe you should be issuing a new query for each
IReadBlock() call.  I see this as the only way to ensure you
only read the rows/blocks that are requested by the application.

In particular, I am imagining IReadBlock() would issue a spatial
query for rows intersecting the bounding box of the requested
block for which there should only be one that matches.  I am
assuming there is no other way to get a particular block other
than a spatial query.

You will also want to use the trick used in the JPEG driver where
when you read a block in your RasterBand::IReadBlock() method that
you should shove the unneeded bands for that block into the block
cache to avoid having to refetch them from the database when the
other bands are finally requested.  You can treat this as an
optimization to do after you have the basics working.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From jorge.arevalo at gmail.com  Fri Jul 10 14:52:46 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Fri Jul 10 14:53:09 2009
Subject: [gdal-dev] Questions about SQL cursors in GDAL driver
In-Reply-To: <4A5786DC.1090807@pobox.com>
References: <cb4457700907101013m19752e8epe267f993648192f4@mail.gmail.com> 
	<4A5786DC.1090807@pobox.com>
Message-ID: <cb4457700907101152s2a271335yebc9eaa079d3fd2a@mail.gmail.com>

Hello,

2009/7/10 Frank Warmerdam <warmerdam@pobox.com>:
> Jorge Ar?valo wrote:
>>
>> Hello,
>>
>> Context: GDAL WKTRaster Driver. When creating Dataset, I declare a
>> cursor to read all the rows (tiles) of a table with a raster column
>> (DECLARE cursor CURSOR FOR SELECT * FROM TABLE). The RasterBand should
>> read one of the rows' band
>>
>> Question 1: The cursor is created during the Dataset creation, and
>> stored in it. Should I start a transaction before? If yes, when should
>> I close the cursor and end the transaction? When calling to Dataset's
>> destructor?
>
> Jorge,
>
> Ideally you would issue the query when the resultset is first needed
> which would presumably be when the first IReadBlock() call is made.
> This would keep down overhead for lightweight open's (ie. for gdalinfo)
> that don't really need the raster data.
>
> Presumably the cursor would be closed in the dataset descructor.

Ok, I'm working with this approach, actually.

>
>> Question 2: What approach is better?
>> ? ? a) The Dataset fetchs all the rows (tiles) of the table just
>> after declaring the cursor, and the RasterBand moves over the
>> resultset using PQgetvalue and read one band of the read raster
>
>> ? ? b) The Dataset declare the cursor and the RasterBand fetchs the
>> row that needs to read one of its bands
>
> Hmm, thinking slightly deeper here, for the regular_blocking
> case I believe you should be issuing a new query for each
> IReadBlock() call. ?I see this as the only way to ensure you
> only read the rows/blocks that are requested by the application.
>
> In particular, I am imagining IReadBlock() would issue a spatial
> query for rows intersecting the bounding box of the requested
> block for which there should only be one that matches. ?I am
> assuming there is no other way to get a particular block other
> than a spatial query.

If I understand, I should perform a spatial query to get the blocks
that intersect with the requested block. In case of regular_blocking,
only one matchs: the requested block itself. I think that's the
approach.


>
> You will also want to use the trick used in the JPEG driver where
> when you read a block in your RasterBand::IReadBlock() method that
> you should shove the unneeded bands for that block into the block
> cache to avoid having to refetch them from the database when the
> other bands are finally requested. ?You can treat this as an
> optimization to do after you have the basics working.

Ok. Added to TODO list. And I have two small more questions:

- In the IReadBlock method of several RasterBands I saw CPLAssert(
nBlockXOff == 0 ); This ensure that you always read a band starting on
the most left block. I think that this is necessary with untiled
rasters. Am I right?

- What's the minimum set of methods of RasterBand that should be
implemented? IReadBlock, GDALColorInterp, GDALColorTable...

Thanks again
Best regards
Jorge
From woklist at kyngchaos.com  Fri Jul 10 15:14:18 2009
From: woklist at kyngchaos.com (William Kyngesburye)
Date: Fri Jul 10 15:14:23 2009
Subject: [gdal-dev] gdalbuildvrt and nulls again - now from Photoshop
Message-ID: <4914D929-EBF9-4F31-A36A-9D4BFB62D1B7@kyngchaos.com>

This time I'm taking some Photoshop-created tiffs that I georeference  
with a TFW.  These tiffs I save with transparency mask (not layers) to  
handle nulls.

Reported by gdalinfo, they appear as:

Band 1 Block=12775x5 Type=Byte, ColorInterp=Red
   Mask Flags: PER_DATASET ALPHA
Band 2 Block=12775x5 Type=Byte, ColorInterp=Green
   Mask Flags: PER_DATASET ALPHA
Band 3 Block=12775x5 Type=Byte, ColorInterp=Blue
   Mask Flags: PER_DATASET ALPHA
Band 4 Block=12775x5 Type=Byte, ColorInterp=Alpha

But when I run gdalbuildvrt on them, they are skipped:

gdalbuildvrt does not support heterogenous band numbers. Skipping  
[sometiff].

If I save it with layers instead of transparency, GDAL doesn't see the  
alpha mask on the layer:

Band 1 Block=12775x6 Type=Byte, ColorInterp=Red
Band 2 Block=12775x6 Type=Byte, ColorInterp=Green
Band 3 Block=12775x6 Type=Byte, ColorInterp=Blue


Is there a way I can get gdalbuildvrt to recognize the transparency as  
null, without converting them with gdal_translate first?  Maybe a  
different way to save the tiff with a mask from Photoshop?

Does the vrt format support a tiff transparency mask as null (and it's  
just gdalbuildvrt that doesn't)?

-----
William Kyngesburye <kyngchaos*at*kyngchaos*dot*com>
http://www.kyngchaos.com/

"History is an illusion caused by the passage of time, and time is an  
illusion caused by the passage of history."

- Hitchhiker's Guide to the Galaxy


From adeel.raza at crc.gc.ca  Fri Jul 10 17:18:39 2009
From: adeel.raza at crc.gc.ca (Adeel Raza)
Date: Fri Jul 10 17:18:34 2009
Subject: [gdal-dev] Question about GDALDataType::GDT_Float32
Message-ID: <4A57B02F.50505@crc.gc.ca>

Hi,

I'm using the GDALRasterBand::RasterIO() function to write a buffer of 
C/C++ float types to a raster band of data type 
GDALDataType::GDT_Float32. I assumed that this conversion would not be 
problem since the size of a C/C++ float is also 32 bits, but I wanted to 
be sure. If the conversion will be problematic, how would I resolve the 
issue (ex: a potential cast maybe).

Best Regards,
Adeel Raza.



From szekerest at gmail.com  Fri Jul 10 17:25:44 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Fri Jul 10 17:25:49 2009
Subject: [gdal-dev] Questions about SQL cursors in GDAL driver
In-Reply-To: <cb4457700907101013m19752e8epe267f993648192f4@mail.gmail.com>
References: <cb4457700907101013m19752e8epe267f993648192f4@mail.gmail.com>
Message-ID: <f3b73b7d0907101425k28feb2ccgc854ca66d4ec0e44@mail.gmail.com>

Jorge,

I'm a bit hesitant to think using a server cursor would be the best approach
here. Could you explain why is this needed?
I my understanding each IReadBlock would trigger a normal "SELECT" without
the cursor, this will give you all the data at once, just like FETCH ALL.
This select would in fact be a spatial select according to the extent of the
block required by the client.

Best regards,

Tamas




2009/7/10 Jorge Ar?valo <jorge.arevalo@gmail.com>

> Hello,
>
> Context: GDAL WKTRaster Driver. When creating Dataset, I declare a
> cursor to read all the rows (tiles) of a table with a raster column
> (DECLARE cursor CURSOR FOR SELECT * FROM TABLE). The RasterBand should
> read one of the rows' band
>
> Question 1: The cursor is created during the Dataset creation, and
> stored in it. Should I start a transaction before? If yes, when should
> I close the cursor and end the transaction? When calling to Dataset's
> destructor?
> Question 2: What approach is better?
>     a) The Dataset fetchs all the rows (tiles) of the table just
> after declaring the cursor, and the RasterBand moves over the
> resultset using PQgetvalue and read one band of the read raster
>     b) The Dataset declare the cursor and the RasterBand fetchs the
> row that needs to read one of its bands
>
> Thanks in advance.
>
> Best regards
> Jorge
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090710/801666b5/attachment-0001.html
From warmerdam at pobox.com  Fri Jul 10 17:28:36 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Jul 10 17:28:27 2009
Subject: [gdal-dev] Question about GDALDataType::GDT_Float32
In-Reply-To: <4A57B02F.50505@crc.gc.ca>
References: <4A57B02F.50505@crc.gc.ca>
Message-ID: <4A57B284.4030203@pobox.com>

Adeel Raza wrote:
> Hi,
> 
> I'm using the GDALRasterBand::RasterIO() function to write a buffer of 
> C/C++ float types to a raster band of data type 
> GDALDataType::GDT_Float32. I assumed that this conversion would not be 
> problem since the size of a C/C++ float is also 32 bits, but I wanted to 
> be sure. If the conversion will be problematic, how would I resolve the 
> issue (ex: a potential cast maybe).

Adeel,

There is no problem.  The GDT_Float32 enumeration value refers to the
normal 32bit system "float" type in C/C++.

I would add that you should expect, and provide float's in native
machine order.  GDAL will take care of byte swapping during io if
needed.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From adeel.raza at crc.gc.ca  Fri Jul 10 17:31:44 2009
From: adeel.raza at crc.gc.ca (Adeel Raza)
Date: Fri Jul 10 17:31:37 2009
Subject: [gdal-dev] Question about GDALDataType::GDT_Float32
In-Reply-To: <4A57B284.4030203@pobox.com>
References: <4A57B02F.50505@crc.gc.ca> <4A57B284.4030203@pobox.com>
Message-ID: <4A57B340.9030704@crc.gc.ca>

Hi,

Thanks for the quick reply Frank.

Frank Warmerdam wrote:
> Adeel Raza wrote:
>> Hi,
>>
>> I'm using the GDALRasterBand::RasterIO() function to write a buffer 
>> of C/C++ float types to a raster band of data type 
>> GDALDataType::GDT_Float32. I assumed that this conversion would not 
>> be problem since the size of a C/C++ float is also 32 bits, but I 
>> wanted to be sure. If the conversion will be problematic, how would I 
>> resolve the issue (ex: a potential cast maybe).
>
> Adeel,
>
> There is no problem.  The GDT_Float32 enumeration value refers to the
> normal 32bit system "float" type in C/C++.
>
> I would add that you should expect, and provide float's in native
> machine order.  GDAL will take care of byte swapping during io if
> needed.
>
> Best regards,

From user-12363014.030832-1 at xing.com  Fri Jul 10 17:25:19 2009
From: user-12363014.030832-1 at xing.com (Gokul Kartha )
Date: Fri Jul 10 17:49:29 2009
Subject: [gdal-dev] Invitation to my XING network
Message-ID: <20090710212519.7A2E718012A8@obc-wrk42-3.rz.xing.com>

Hi,

I'd like to invite you to be part of my XING network. 
 
I use XING to manage my professional contacts and get in touch with other people in my industry. Take a look--it has paid off for me. 
 
Kind regards, 
 
Gokul Kartha

-----------------------------------------------------------------------

Gokul Kartha is inviting you to become a member of the XING network:
http://www.xing.com/go/inv/25022717.877881?reagent=systemmail/invite



I no longer wish to receive invitations to XING:	 
http://www.xing.com/go/opt_out_invite/U2FsdGVkX1-raVWSYQLIe8HvcYUMWPdYoj5F1TllaeyVG-bDvDOGfbRBFc52xhbW
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090710/f7c9a999/attachment.html
From jorge.arevalo at gmail.com  Fri Jul 10 19:02:03 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Fri Jul 10 19:02:25 2009
Subject: [gdal-dev] Questions about SQL cursors in GDAL driver
In-Reply-To: <f3b73b7d0907101425k28feb2ccgc854ca66d4ec0e44@mail.gmail.com>
References: <cb4457700907101013m19752e8epe267f993648192f4@mail.gmail.com> 
	<f3b73b7d0907101425k28feb2ccgc854ca66d4ec0e44@mail.gmail.com>
Message-ID: <cb4457700907101602p72a0a853gd8b5e6c346598696@mail.gmail.com>

Hello,

2009/7/10 Tamas Szekeres <szekerest@gmail.com>:
> Jorge,
>
> I'm a bit hesitant to think using a server cursor would be the best approach
> here. Could you explain why is this needed?

Yes. As now I'm working basically with regularly tiled coverages, an
operation like SELECT rast FROM table gives me all the tiles. These
tiles don't overlap, and its size can be the size of a block read for
IReadBlock method. So, if I have a cursor, I can fetch the tile that
the IRasterBlock needs as one of the rows of the resultset without
having all the tiles loaded in memory at same time.

Ok, this isn't a generic approach. I should perform a spatial query
for rows intersecting the bounding box of the requested block, as
Frank said. In case of regularly tiled coverage, the result of this
query will be one row. And maybe it's faster to perform only one query
and fetch all the rows from a cursor, instead of a lot of spatial
queries for this particular case.

Maybe is it a bad approach?


> I my understanding each IReadBlock would trigger a normal "SELECT" without
> the cursor, this will give you all the data at once, just like FETCH ALL.
> This select would in fact be a spatial select according to the extent of the
> block required by the client.
>
Ok, correct me if I'm wrong, please: Each IReadBlock will query for a
part of the raster. As we can set the band block size when creating
the Dataset (passing parameters to constructor), we can force the
blocks to be the same size of our tiles (rows). So, we have to
transform the 2D coordinate system of IReadBlock (nXBlockOff,
nYBlockOff) to the 1D system of result set. Then, if we call
IReadBlock(0, 0, buffer), this will be the first row of the resultset.
IReadBlock(0,1, buffer) will be the second row, and so on. We simply
have to read the matching band of each row (tile) in each IReadBlock
petition. I think that, in this particular case, it's faster than a
spatial query.

If we accept that, the question is:
- Should I fetch the data in the Dataset (FETCH ALL) and simply get
each row by calling PQgetvalue over the resultset?
- Should I fetch the data only in IReadBlock method, getting the row I need?

Am I talking nosense? Could be a good approach?

Many thanks

Best regards
Jorge


> Best regards,
>
> Tamas
>
>
>
>
> 2009/7/10 Jorge Ar?valo <jorge.arevalo@gmail.com>
>>
>> Hello,
>>
>> Context: GDAL WKTRaster Driver. When creating Dataset, I declare a
>> cursor to read all the rows (tiles) of a table with a raster column
>> (DECLARE cursor CURSOR FOR SELECT * FROM TABLE). The RasterBand should
>> read one of the rows' band
>>
>> Question 1: The cursor is created during the Dataset creation, and
>> stored in it. Should I start a transaction before? If yes, when should
>> I close the cursor and end the transaction? When calling to Dataset's
>> destructor?
>> Question 2: What approach is better?
>> ? ? a) The Dataset fetchs all the rows (tiles) of the table just
>> after declaring the cursor, and the RasterBand moves over the
>> resultset using PQgetvalue and read one band of the read raster
>> ? ? b) The Dataset declare the cursor and the RasterBand fetchs the
>> row that needs to read one of its bands
>>
>> Thanks in advance.
>>
>> Best regards
>> Jorge
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
From warmerdam at pobox.com  Fri Jul 10 19:18:19 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Jul 10 19:18:08 2009
Subject: [gdal-dev] Questions about SQL cursors in GDAL driver
In-Reply-To: <cb4457700907101602p72a0a853gd8b5e6c346598696@mail.gmail.com>
References: <cb4457700907101013m19752e8epe267f993648192f4@mail.gmail.com> 
	<f3b73b7d0907101425k28feb2ccgc854ca66d4ec0e44@mail.gmail.com>
	<cb4457700907101602p72a0a853gd8b5e6c346598696@mail.gmail.com>
Message-ID: <4A57CC3B.8040805@pobox.com>

Jorge Ar?valo wrote:
> Hello,
> 
> 2009/7/10 Tamas Szekeres <szekerest@gmail.com>:
>> Jorge,
>>
>> I'm a bit hesitant to think using a server cursor would be the best approach
>> here. Could you explain why is this needed?
> 
> Yes. As now I'm working basically with regularly tiled coverages, an
> operation like SELECT rast FROM table gives me all the tiles. These
> tiles don't overlap, and its size can be the size of a block read for
> IReadBlock method. So, if I have a cursor, I can fetch the tile that
> the IRasterBlock needs as one of the rows of the resultset without
> having all the tiles loaded in memory at same time.

Jorge,

I'm not clear on how you know what row to take out of the resultset
for a given IReadBlock() call?  How do you translate the x/y block
index into a resultset row offset?

I would note that spatial searches *should* be quite fast if the
raster row is spatially indexed.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From szekerest at gmail.com  Fri Jul 10 19:32:21 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Fri Jul 10 19:32:24 2009
Subject: [gdal-dev] Questions about SQL cursors in GDAL driver
In-Reply-To: <4A57CC3B.8040805@pobox.com>
References: <cb4457700907101013m19752e8epe267f993648192f4@mail.gmail.com>
	<f3b73b7d0907101425k28feb2ccgc854ca66d4ec0e44@mail.gmail.com>
	<cb4457700907101602p72a0a853gd8b5e6c346598696@mail.gmail.com>
	<4A57CC3B.8040805@pobox.com>
Message-ID: <f3b73b7d0907101632h6aa05d25x1b1a84a91223b94a@mail.gmail.com>

2009/7/11 Frank Warmerdam <warmerdam@pobox.com>

> Jorge Ar?valo wrote:
>
>> Hello,
>>
>> 2009/7/10 Tamas Szekeres <szekerest@gmail.com>:
>>
>>> Jorge,
>>>
>>> I'm a bit hesitant to think using a server cursor would be the best
>>> approach
>>> here. Could you explain why is this needed?
>>>
>>
>> Yes. As now I'm working basically with regularly tiled coverages, an
>> operation like SELECT rast FROM table gives me all the tiles. These
>> tiles don't overlap, and its size can be the size of a block read for
>> IReadBlock method. So, if I have a cursor, I can fetch the tile that
>> the IRasterBlock needs as one of the rows of the resultset without
>> having all the tiles loaded in memory at same time.
>>
>
> Jorge,
>
> I'm not clear on how you know what row to take out of the resultset
> for a given IReadBlock() call?  How do you translate the x/y block
> index into a resultset row offset?
>
> I would note that spatial searches *should* be quite fast if the
> raster row is spatially indexed.
>

Jorge,

I'm thinking of exactly the same as Frank. It's ok you have the same block
size in GDAL as the block size in the database but you might have to
construct a different SQL query to select the corresponding block even if a
single row is retrieved in a single IReadBlock call.

Best regards,

Tamas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090711/63f749a5/attachment.html
From jorge.arevalo at gmail.com  Fri Jul 10 20:02:10 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Fri Jul 10 20:02:32 2009
Subject: [gdal-dev] Questions about SQL cursors in GDAL driver
In-Reply-To: <f3b73b7d0907101632h6aa05d25x1b1a84a91223b94a@mail.gmail.com>
References: <cb4457700907101013m19752e8epe267f993648192f4@mail.gmail.com> 
	<f3b73b7d0907101425k28feb2ccgc854ca66d4ec0e44@mail.gmail.com> 
	<cb4457700907101602p72a0a853gd8b5e6c346598696@mail.gmail.com> 
	<4A57CC3B.8040805@pobox.com>
	<f3b73b7d0907101632h6aa05d25x1b1a84a91223b94a@mail.gmail.com>
Message-ID: <cb4457700907101702m45183190g51c223093ec9867a@mail.gmail.com>

On Sat, Jul 11, 2009 at 1:32 AM, Tamas Szekeres<szekerest@gmail.com> wrote:
>
>
> 2009/7/11 Frank Warmerdam <warmerdam@pobox.com>
>>
>> Jorge Ar?valo wrote:
>>>
>>> Hello,
>>>
>>> 2009/7/10 Tamas Szekeres <szekerest@gmail.com>:
>>>>
>>>> Jorge,
>>>>
>>>> I'm a bit hesitant to think using a server cursor would be the best
>>>> approach
>>>> here. Could you explain why is this needed?
>>>
>>> Yes. As now I'm working basically with regularly tiled coverages, an
>>> operation like SELECT rast FROM table gives me all the tiles. These
>>> tiles don't overlap, and its size can be the size of a block read for
>>> IReadBlock method. So, if I have a cursor, I can fetch the tile that
>>> the IRasterBlock needs as one of the rows of the resultset without
>>> having all the tiles loaded in memory at same time.
>>
>> Jorge,
>>
>> I'm not clear on how you know what row to take out of the resultset
>> for a given IReadBlock() call? ?How do you translate the x/y block
>> index into a resultset row offset?
>>
>> I would note that spatial searches *should* be quite fast if the
>> raster row is spatially indexed.
>
> Jorge,
>
> I'm thinking of exactly the same as Frank. It's ok you have the same block
> size in GDAL as the block size in the database but you might have to
> construct a different SQL query to select the corresponding block even if a
> single row is retrieved in a single IReadBlock call.

So, clearly, I have a mistake. Think in a table with tiles of 100x100
px. We have 30 tiles. When I create RasterBands, their block size will
be 100x100. So, IReadBlock(0, 0, bufffer) indicates the block going
from (0, 0) to (100, 100). Does it mean that the block from (0, 0) to
(100, 100) must be the first one in the table if I get the rows
ordered by rid? It depends on how the tiles have been loaded. So,
instead of making hypothesis, Should I query the block that matchs the
extent from (0, 0) to (100, 100)?

Many thanks

Jorge
From warmerdam at pobox.com  Fri Jul 10 21:14:55 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Jul 10 21:14:43 2009
Subject: [gdal-dev] Questions about SQL cursors in GDAL driver
In-Reply-To: <cb4457700907101702m45183190g51c223093ec9867a@mail.gmail.com>
References: <cb4457700907101013m19752e8epe267f993648192f4@mail.gmail.com> 
	<f3b73b7d0907101425k28feb2ccgc854ca66d4ec0e44@mail.gmail.com> 
	<cb4457700907101602p72a0a853gd8b5e6c346598696@mail.gmail.com> 
	<4A57CC3B.8040805@pobox.com>
	<f3b73b7d0907101632h6aa05d25x1b1a84a91223b94a@mail.gmail.com>
	<cb4457700907101702m45183190g51c223093ec9867a@mail.gmail.com>
Message-ID: <4A57E78F.6090000@pobox.com>

Jorge Ar?valo wrote:
> So, clearly, I have a mistake. Think in a table with tiles of 100x100
> px. We have 30 tiles. When I create RasterBands, their block size will
> be 100x100. So, IReadBlock(0, 0, bufffer) indicates the block going
> from (0, 0) to (100, 100). Does it mean that the block from (0, 0) to
> (100, 100) must be the first one in the table if I get the rows
> ordered by rid? 

No, I do not see how you could depend on this.

> It depends on how the tiles have been loaded. So,
> instead of making hypothesis, Should I query the block that matchs the
> extent from (0, 0) to (100, 100)?

Yes, but furthermore, you will need to transform the pixel bounds into
georeferenced coordinates to do the spatial query.  I would also note that
you might be best to reduce the query rectangle to just be a small central
area of the tile to avoid fetching adjacent tiles or even forcing
postgres to fetch them to check their bounds against your point.  Spatial
index tend to have a certain granularity.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From jorge.arevalo at gmail.com  Sat Jul 11 03:45:04 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Sat Jul 11 03:45:26 2009
Subject: [gdal-dev] Questions about SQL cursors in GDAL driver
In-Reply-To: <4A57E78F.6090000@pobox.com>
References: <cb4457700907101013m19752e8epe267f993648192f4@mail.gmail.com> 
	<f3b73b7d0907101425k28feb2ccgc854ca66d4ec0e44@mail.gmail.com> 
	<cb4457700907101602p72a0a853gd8b5e6c346598696@mail.gmail.com> 
	<4A57CC3B.8040805@pobox.com>
	<f3b73b7d0907101632h6aa05d25x1b1a84a91223b94a@mail.gmail.com> 
	<cb4457700907101702m45183190g51c223093ec9867a@mail.gmail.com> 
	<4A57E78F.6090000@pobox.com>
Message-ID: <cb4457700907110045i6605d81eo552a3c66ff2be3a1@mail.gmail.com>

2009/7/11 Frank Warmerdam <warmerdam@pobox.com>:
> Jorge Ar?valo wrote:
>>
>> So, clearly, I have a mistake. Think in a table with tiles of 100x100
>> px. We have 30 tiles. When I create RasterBands, their block size will
>> be 100x100. So, IReadBlock(0, 0, bufffer) indicates the block going
>> from (0, 0) to (100, 100). Does it mean that the block from (0, 0) to
>> (100, 100) must be the first one in the table if I get the rows
>> ordered by rid?
>
> No, I do not see how you could depend on this.

OK, understood.

>
>> It depends on how the tiles have been loaded. So,
>> instead of making hypothesis, Should I query the block that matchs the
>> extent from (0, 0) to (100, 100)?
>
> Yes, but furthermore, you will need to transform the pixel bounds into
> georeferenced coordinates to do the spatial query. ?I would also note that
> you might be best to reduce the query rectangle to just be a small central
> area of the tile to avoid fetching adjacent tiles or even forcing
> postgres to fetch them to check their bounds against your point. ?Spatial
> index tend to have a certain granularity.

I can get the center pixel coordinates of the block, transform them
into georeferenced coordinates (a point) and test which tile's
envelope contains this point. Right?

Many thanks again

Best regards
Jorge
From szekerest at gmail.com  Sat Jul 11 09:12:47 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Sat Jul 11 09:12:51 2009
Subject: [gdal-dev] Questions about SQL cursors in GDAL driver
In-Reply-To: <cb4457700907110045i6605d81eo552a3c66ff2be3a1@mail.gmail.com>
References: <cb4457700907101013m19752e8epe267f993648192f4@mail.gmail.com>
	<f3b73b7d0907101425k28feb2ccgc854ca66d4ec0e44@mail.gmail.com>
	<cb4457700907101602p72a0a853gd8b5e6c346598696@mail.gmail.com>
	<4A57CC3B.8040805@pobox.com>
	<f3b73b7d0907101632h6aa05d25x1b1a84a91223b94a@mail.gmail.com>
	<cb4457700907101702m45183190g51c223093ec9867a@mail.gmail.com>
	<4A57E78F.6090000@pobox.com>
	<cb4457700907110045i6605d81eo552a3c66ff2be3a1@mail.gmail.com>
Message-ID: <f3b73b7d0907110612p6b348180s4e9848cf38dd2081@mail.gmail.com>

Jorge,

I think this driver is in a special situation comparing to the file based
raster data sources, that is: we should minimize the round trips to the
server as much as possible which is costly. Therefore in addition to write
IReadBlock correctly (required to fetch a single row in each call or
multiple rows with the non-regular blocking option) we should also consider
to implement some further optimizations.

In the current case GDALRasterBand::IRasterIO would trigger a number of
IReadBlocks to the driver which will cause many individual round-trips to
the server which is a 'sub-optimal' solution in our case.

In this driver - I think - we should actually override
GDALRasterBand::IRasterIO and try to fetch all the blocks by using a spatial
query according to the area requested by the user. Then the driver should
feed the returned blocks into the band block cache by creating a new
GDALRasterBlock for each returned row, and call  GDALRasterBand::AdoptBlock
to add the block to the cache. (see GDALRasterBand::GetLockedBlockRef for
more details how the block handling is done in general). Then you could call
the IRasterIO on the base class to do the rest of the IO operation.
By feeding up the cache with the blocks the base RasterIO will be served
from the block cache instead of calling the IReadBlock-s individually.

But this option doesn't invalidate the requirement of implementing
IReadBlock which is compulsory for each driver to provide the block based
access.


With regards to the cursors it should also be avoided here, because (in
addition to the roundtrips) it requires further resource allocations at the
server which decreases the scalability and by using random access to the
rows may not perform better than accessing the data by using a (clustered)
index search for example.


Best regards,

Tamas




2009/7/11 Jorge Ar?valo <jorge.arevalo@gmail.com>

> 2009/7/11 Frank Warmerdam <warmerdam@pobox.com>:
> > Jorge Ar?valo wrote:
> >>
> >> So, clearly, I have a mistake. Think in a table with tiles of 100x100
> >> px. We have 30 tiles. When I create RasterBands, their block size will
> >> be 100x100. So, IReadBlock(0, 0, bufffer) indicates the block going
> >> from (0, 0) to (100, 100). Does it mean that the block from (0, 0) to
> >> (100, 100) must be the first one in the table if I get the rows
> >> ordered by rid?
> >
> > No, I do not see how you could depend on this.
>
> OK, understood.
>
> >
> >> It depends on how the tiles have been loaded. So,
> >> instead of making hypothesis, Should I query the block that matchs the
> >> extent from (0, 0) to (100, 100)?
> >
> > Yes, but furthermore, you will need to transform the pixel bounds into
> > georeferenced coordinates to do the spatial query.  I would also note
> that
> > you might be best to reduce the query rectangle to just be a small
> central
> > area of the tile to avoid fetching adjacent tiles or even forcing
> > postgres to fetch them to check their bounds against your point.  Spatial
> > index tend to have a certain granularity.
>
> I can get the center pixel coordinates of the block, transform them
> into georeferenced coordinates (a point) and test which tile's
> envelope contains this point. Right?
>
> Many thanks again
>
> Best regards
> Jorge
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090711/41168641/attachment.html
From jorge.arevalo at gmail.com  Sat Jul 11 12:22:25 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Sat Jul 11 12:22:48 2009
Subject: [gdal-dev] Questions about SQL cursors in GDAL driver
In-Reply-To: <f3b73b7d0907110612p6b348180s4e9848cf38dd2081@mail.gmail.com>
References: <cb4457700907101013m19752e8epe267f993648192f4@mail.gmail.com> 
	<f3b73b7d0907101425k28feb2ccgc854ca66d4ec0e44@mail.gmail.com> 
	<cb4457700907101602p72a0a853gd8b5e6c346598696@mail.gmail.com> 
	<4A57CC3B.8040805@pobox.com>
	<f3b73b7d0907101632h6aa05d25x1b1a84a91223b94a@mail.gmail.com> 
	<cb4457700907101702m45183190g51c223093ec9867a@mail.gmail.com> 
	<4A57E78F.6090000@pobox.com>
	<cb4457700907110045i6605d81eo552a3c66ff2be3a1@mail.gmail.com> 
	<f3b73b7d0907110612p6b348180s4e9848cf38dd2081@mail.gmail.com>
Message-ID: <cb4457700907110922nadbbd6fpbd9e3a598b7b44ac@mail.gmail.com>

2009/7/11 Tamas Szekeres <szekerest@gmail.com>:
> Jorge,
>
> I think this driver is in a special situation comparing to the file based
> raster data sources, that is: we should minimize the round trips to the
> server as much as possible which is costly. Therefore in addition to write
> IReadBlock correctly (required to fetch a single row in each call or
> multiple rows with the non-regular blocking option) we should also consider
> to implement some further optimizations.
>
> In the current case GDALRasterBand::IRasterIO would trigger a number of
> IReadBlocks to the driver which will cause many individual round-trips to
> the server which is a 'sub-optimal' solution in our case.
>
> In this driver - I think - we should actually override
> GDALRasterBand::IRasterIO and try to fetch all the blocks by using a spatial
> query according to the area requested by the user. Then the driver should
> feed the returned blocks into the band block cache by creating a new
> GDALRasterBlock for each returned row, and call? GDALRasterBand::AdoptBlock
> to add the block to the cache. (see GDALRasterBand::GetLockedBlockRef for
> more details how the block handling is done in general). Then you could call
> the IRasterIO on the base class to do the rest of the IO operation.
> By feeding up the cache with the blocks the base RasterIO will be served
> from the block cache instead of calling the IReadBlock-s individually.
>
> But this option doesn't invalidate the requirement of implementing
> IReadBlock which is compulsory for each driver to provide the block based
> access.
>
Added to TODO list. I think a deeper investigation on the internals of
how and when are the methods of RasterBand called could help me a lot.
Maybe I should review the code of gdalinfo, or other GDAL apps. Any
suggestion?

>
> With regards to the cursors it should also be avoided here, because (in
> addition to the roundtrips) it requires further resource allocations at the
> server which decreases the scalability and by using random access to the
> rows may not perform better than accessing the data by using a (clustered)
> index search for example.

Ok. No cursors. Index based search. That's my point just now.

Many thanks

Best regards
Jorge
From mateusz at loskot.net  Sat Jul 11 20:56:34 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sat Jul 11 20:56:53 2009
Subject: [gdal-dev] Big three rules for C++ classes
In-Reply-To: <489BE964-F2CB-4414-9B11-0C875E8C4839@internode.on.net>
References: <E268F017-2CDB-4968-A908-63280DA3C4A7@internode.on.net>
	<86A4D80B-9ED4-406F-8293-5BE9E7181CAB@internode.on.net>
	<FB1D14A7-39F2-4B39-86C0-E125C7BE543F@internode.on.net>
	<488F501E.3090608@pobox.com>
	<6FD022B3-B5AE-4D1C-9599-2FFA27BB2980@internode.on.net>
	<488FA29F.10501@pobox.com>
	<DB0F35D0-8235-4512-850C-0F6D8063B920@internode.on.net>
	<27F957A3-702E-4B78-808F-3BAF0AD3246F@internode.on.net>
	<48931775.9010601@pobox.com>
	<507C81FF-9130-4389-904E-5FC32FA36E81@internode.on.net>
	<931f8ea90808152105j56604d67wcdde647ed24b901c@mail.gmail.com>
	<F74E272F-D375-4D83-9E21-5916F1416B12@internode.on.net>
	<489BE964-F2CB-4414-9B11-0C875E8C4839@internode.on.net>
Message-ID: <54910.90.195.2.157.1247360194.squirrel@loskot.net>

Christopher Hunt wrote:
> Hi there,
>
> I've just started using the classes from the ogr_geometry API and note
> that they do not obey the C++ Rule of Three:
>
> http://en.wikipedia.org/wiki/Rule_of_three_(C%2B%2B_programming)

Christopher,

Yes, you are right.
When working with GDAL/OGR classes, it's reasonable to be kind of
suspicious and sensitive to implicit assumptions not reflected in the code
itself. Personally, I consider them as "C with classes" than full-blown
super-duper modern-fancy C++ :-)

It's a good idea to scan the archives to learn more about that. For instance:

http://lists.osgeo.org/pipermail/gdal-dev/2001-July/003082.html
http://lists.osgeo.org/pipermail/gdal-dev/2006-May/009100.html
http://lists.osgeo.org/pipermail/gdal-dev/2005-January/004916.html
...

> Perhaps the copy ctor and assignment operators should receive a
> private scope in OGRGeometry unless they are implemented of course.

Safe implicit assumption: all GDAL/OGR classes are not CopyConstructible
nor Assignable types, in terms of of the C++ standard.

Best regards,
-- 
Mateusz Loskot
http://mateusz.loskot.net

From monshi at home.se  Sun Jul 12 04:11:01 2009
From: monshi at home.se (Tomas R)
Date: Sun Jul 12 04:11:25 2009
Subject: [gdal-dev] C# Nad27 to WGS 84
Message-ID: <h3c5r1$kmo$1@ger.gmane.org>

Hi again,

New problems arises as the world of Gdal is quite complex to grasp.

Have understood that the transformation of coordinates from Nad 27 datum 
to WGS 84 requires some look up tables to be done correctly, tables that 
differ with the are the Nad 27 is valid in.

Simple question is, how to set up a general solution in C# that uses 
these shift tables.
I have in code a simple test:
           SpatialReference spatNad27 = new SpatialReference("");
            spatNad27.SetWellKnownGeogCS("Nad27");
            SpatialReference spatNad83 = new SpatialReference("");
            spatNad83.SetWellKnownGeogCS("Nad83");
           
            CoordinateTransformation trans = new 
CoordinateTransformation(spatNad27, spatNad83);
            double[] p = new double[3];
            trans.TransformPoint(p, -117, 30, 0);

that gives back
-117, 30,0000000008175
which I believe is not correct ( see http://proj.maptools.org/faq.html )

I have Proj4.dll, I have set an environment path to PROJ_LIB where the 
nad shift tables should exist. Must I do something else in the setup or 
is the call to the transform different? or have I done correctly but 
misinterpreted the results?

What I in reality is interested is transforming whatever coordinate in 
whatever projection/datum to and from WGS84 without any extra hassle 
fast and easy via the C# interface. That should not be to hard? Or?

Yours
Tomas

From mateusz at loskot.net  Sun Jul 12 10:21:03 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sun Jul 12 10:21:27 2009
Subject: [gdal-dev] Big three rules for C++ classes
In-Reply-To: <C55CF272-1F41-4D42-BFE8-6DC4BC226621@internode.on.net>
References: <E268F017-2CDB-4968-A908-63280DA3C4A7@internode.on.net>
	<86A4D80B-9ED4-406F-8293-5BE9E7181CAB@internode.on.net>
	<FB1D14A7-39F2-4B39-86C0-E125C7BE543F@internode.on.net>
	<488F501E.3090608@pobox.com>
	<6FD022B3-B5AE-4D1C-9599-2FFA27BB2980@internode.on.net>
	<488FA29F.10501@pobox.com>
	<DB0F35D0-8235-4512-850C-0F6D8063B920@internode.on.net>
	<27F957A3-702E-4B78-808F-3BAF0AD3246F@internode.on.net>
	<48931775.9010601@pobox.com>
	<507C81FF-9130-4389-904E-5FC32FA36E81@internode.on.net>
	<931f8ea90808152105j56604d67wcdde647ed24b901c@mail.gmail.com>
	<F74E272F-D375-4D83-9E21-5916F1416B12@internode.on.net>
	<489BE964-F2CB-4414-9B11-0C875E8C4839@internode.on.net>
	<54910.90.195.2.157.1247360194.squirrel@loskot.net>
	<C55CF272-1F41-4D42-BFE8-6DC4BC226621@internode.on.net>
Message-ID: <46255.90.195.2.87.1247408463.squirrel@loskot.net>

Christopher Hunt wrote:
> Hi Mateusz,
>
> Thank you for your email and confirmation of GDAL's use of C++.

Hi Christopher,

Welcome.

By the way, I usually wrap GDAL with some *very* thin class
(holder/surrogate) that manages all the basic C++ principles and idioms
for me. Sometimes, boost::shared_ptr does the job very well. It's been
ages since I planned to publish a thing wrapper around GDAL/OGR classes,
may be one day...

p.s. I'd suggest to reply to the list than privately.
-- 
Mateusz Loskot
http://mateusz.loskot.net

From warmerdam at pobox.com  Sun Jul 12 12:12:23 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Sun Jul 12 12:12:00 2009
Subject: [gdal-dev] C# Nad27 to WGS 84
In-Reply-To: <h3c5r1$kmo$1@ger.gmane.org>
References: <h3c5r1$kmo$1@ger.gmane.org>
Message-ID: <4A5A0B67.10309@pobox.com>

Tomas R wrote:
> Hi again,
> 
> New problems arises as the world of Gdal is quite complex to grasp.
> 
> Have understood that the transformation of coordinates from Nad 27 datum 
> to WGS 84 requires some look up tables to be done correctly, tables that 
> differ with the are the Nad 27 is valid in.
> 
> Simple question is, how to set up a general solution in C# that uses 
> these shift tables.
> I have in code a simple test:
>           SpatialReference spatNad27 = new SpatialReference("");
>            spatNad27.SetWellKnownGeogCS("Nad27");
>            SpatialReference spatNad83 = new SpatialReference("");
>            spatNad83.SetWellKnownGeogCS("Nad83");
>                      CoordinateTransformation trans = new 
> CoordinateTransformation(spatNad27, spatNad83);
>            double[] p = new double[3];
>            trans.TransformPoint(p, -117, 30, 0);
> 
> that gives back
> -117, 30,0000000008175
> which I believe is not correct ( see http://proj.maptools.org/faq.html )
> 
> I have Proj4.dll, I have set an environment path to PROJ_LIB where the 
> nad shift tables should exist. Must I do something else in the setup or 
> is the call to the transform different? or have I done correctly but 
> misinterpreted the results?
> 
> What I in reality is interested is transforming whatever coordinate in 
> whatever projection/datum to and from WGS84 without any extra hassle 
> fast and easy via the C# interface. That should not be to hard? Or?

Tomas,

If I test with the testepsg program (using GDAL services) with
CPL_DEBUG and PROJ_DEBUG defined ON I get the following output.

warmerda@gdal64[264]% setenv PROJ_DEBUG
warmerda@gdal64[265]% testepsg -t NAD27 NAD83 -117 30
OGRCT: Source: +proj=longlat +ellps=clrk66 +datum=NAD27 +no_defs
OGRCT: Target: +proj=longlat +ellps=GRS80 +datum=NAD83 +no_defs
pj_open_lib(conus): call fopen(/wrk/home/warmerda/bld/share/proj/conus) - succeeded
Ctable Conterminous United States 273x121: LL=(-131,20) UR=(-63,50)
pj_open_lib(alaska): call fopen(/wrk/home/warmerda/bld/share/proj/alaska) - 
succeeded
Ctable Alaska 529x249: LL=(-194,46) UR=(-128,77)
pj_open_lib(ntv2_0.gsb): call 
fopen(/wrk/home/warmerda/bld/share/proj/ntv2_0.gsb) - failed
pj_open_lib(ntv1_can.dat): call 
fopen(/wrk/home/warmerda/bld/share/proj/ntv1_can.dat) - succeeded
NTv1 393x177: LL=(-142,40) UR=(-44,84)
pj_open_lib(conus): call fopen(/wrk/home/warmerda/bld/share/proj/conus) - succeeded
pj_apply_gridshift(): used Conterminous United States
(-117.000000,30.000000,0.000000) -> (-117.000806,30.000113,0.000026)

I don't know if it is practical for you to enable debugging and see
stderr output, but if you can it might help you deduce what is
or is not working.

It *sounds* like you have done what is necessary, but it is hard
for me to know if you have made some mistake, such as preprocessing
the grid shift file into binary form.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From monshi at home.se  Sun Jul 12 14:30:44 2009
From: monshi at home.se (Tomas R)
Date: Sun Jul 12 14:30:59 2009
Subject: [gdal-dev] Re: C# Nad27 to WGS 84
In-Reply-To: <4A5A0B67.10309@pobox.com>
References: <h3c5r1$kmo$1@ger.gmane.org> <4A5A0B67.10309@pobox.com>
Message-ID: <h3da4j$7dg$1@ger.gmane.org>

I might do something wrong...
 I just grab whatever Proj-file I find, I have not compiled it myself. 
Unsure witch version I was using when I posted the Q but now I use the 
one found in the latest build at http://trac.osgeo.org/proj/ 
(proj446_win32_bin.zip)
With that version I get a promising error: failed to load NAD27-83 
correction file
one step in the right direction....I fails to load....

What do I miss? Wrong version of Proj4? Do I need to compile the 
proj-file also? Perhaps should try one of your builds of gdal...
Miss in the setting of the environment variable?  I do it in the same 
way I set the GDal path, that is.
nadPath = 
Path.Combine(Path.GetDirectoryName(this.GetType().Assembly.Location), 
@"Gdalbin\Nad");
Environment.SetEnvironmentVariable("PROJ_LIB", nadPath);

and it checks out as expected if I try to grab the PROJ_LIB environment 
variable.

Note, the previous used (unknown version at this time) do not throw that 
error, any error than the erroneous result that is.

Thank for the, as always, quick and informative reply.

Yours
Tomas
Frank Warmerdam skrev:
> Tomas R wrote:
>> Hi again,
>>
>> New problems arises as the world of Gdal is quite complex to grasp.
>>
>> Have understood that the transformation of coordinates from Nad 27 
>> datum to WGS 84 requires some look up tables to be done correctly, 
>> tables that differ with the are the Nad 27 is valid in.
>>
>> Simple question is, how to set up a general solution in C# that uses 
>> these shift tables.
>> I have in code a simple test:
>>           SpatialReference spatNad27 = new SpatialReference("");
>>            spatNad27.SetWellKnownGeogCS("Nad27");
>>            SpatialReference spatNad83 = new SpatialReference("");
>>            spatNad83.SetWellKnownGeogCS("Nad83");
>>                      CoordinateTransformation trans = new 
>> CoordinateTransformation(spatNad27, spatNad83);
>>            double[] p = new double[3];
>>            trans.TransformPoint(p, -117, 30, 0);
>>
>> that gives back
>> -117, 30,0000000008175
>> which I believe is not correct ( see http://proj.maptools.org/faq.html )
>>
>> I have Proj4.dll, I have set an environment path to PROJ_LIB where 
>> the nad shift tables should exist. Must I do something else in the 
>> setup or is the call to the transform different? or have I done 
>> correctly but misinterpreted the results?
>>
>> What I in reality is interested is transforming whatever coordinate 
>> in whatever projection/datum to and from WGS84 without any extra 
>> hassle fast and easy via the C# interface. That should not be to 
>> hard? Or?
>
> Tomas,
>
> If I test with the testepsg program (using GDAL services) with
> CPL_DEBUG and PROJ_DEBUG defined ON I get the following output.
>
> warmerda@gdal64[264]% setenv PROJ_DEBUG
> warmerda@gdal64[265]% testepsg -t NAD27 NAD83 -117 30
> OGRCT: Source: +proj=longlat +ellps=clrk66 +datum=NAD27 +no_defs
> OGRCT: Target: +proj=longlat +ellps=GRS80 +datum=NAD83 +no_defs
> pj_open_lib(conus): call 
> fopen(/wrk/home/warmerda/bld/share/proj/conus) - succeeded
> Ctable Conterminous United States 273x121: LL=(-131,20) UR=(-63,50)
> pj_open_lib(alaska): call 
> fopen(/wrk/home/warmerda/bld/share/proj/alaska) - succeeded
> Ctable Alaska 529x249: LL=(-194,46) UR=(-128,77)
> pj_open_lib(ntv2_0.gsb): call 
> fopen(/wrk/home/warmerda/bld/share/proj/ntv2_0.gsb) - failed
> pj_open_lib(ntv1_can.dat): call 
> fopen(/wrk/home/warmerda/bld/share/proj/ntv1_can.dat) - succeeded
> NTv1 393x177: LL=(-142,40) UR=(-44,84)
> pj_open_lib(conus): call 
> fopen(/wrk/home/warmerda/bld/share/proj/conus) - succeeded
> pj_apply_gridshift(): used Conterminous United States
> (-117.000000,30.000000,0.000000) -> (-117.000806,30.000113,0.000026)
>
> I don't know if it is practical for you to enable debugging and see
> stderr output, but if you can it might help you deduce what is
> or is not working.
>
> It *sounds* like you have done what is necessary, but it is hard
> for me to know if you have made some mistake, such as preprocessing
> the grid shift file into binary form.
>
> Best regards,

From mateusz at loskot.net  Sun Jul 12 17:47:41 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sun Jul 12 17:47:47 2009
Subject: [gdal-dev] Question about GDALDriverManager + gdal2wktraster
In-Reply-To: <f3b73b7d0907060226n4b122bdxa23bd444a025e0c6@mail.gmail.com>
References: <cb4457700907041232v62da7945nd74dd03a7297746f@mail.gmail.com>
	<f3b73b7d0907060226n4b122bdxa23bd444a025e0c6@mail.gmail.com>
Message-ID: <4A5A59FD.1080407@loskot.net>

Tamas Szekeres wrote:
> Jorge,
> 
> I'm not aware much about the changes in the gdal2wktraster script, I can see
> a r4226 which may be related to the problem. Please consult with the author
> Mateusz Loskot about the possible reasons you've encountered with the
> script.

Tamas,

I believe Jorge's problem with driver registration is not related to
recent changes to the gdal2wktraster.

Though, new version of the script still needs testing with various
datasets and use cases - bugs are expected.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From mateusz at loskot.net  Sun Jul 12 17:53:01 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sun Jul 12 17:53:09 2009
Subject: [gdal-dev] How do we know the number of raster bands of a WKT
	Raster object?
In-Reply-To: <4A53E893.6020003@pobox.com>
References: <cb4457700907071701g36e5e4fch287eb3f6a6964f95@mail.gmail.com>
	<4A53E893.6020003@pobox.com>
Message-ID: <4A5A5B3D.10406@loskot.net>

Frank Warmerdam wrote:
> Jorge Ar?valo wrote:
>> Hello,
>>
>> I have a doubt: I have a raster loaded in PostgreSQL with
>> gdal2wktraster, and I'm not sure of the best way to know the number of
>> raster bands the raster has. The fields "pixel_types" and
>> "nodata_values" from raster_columns table are arrays with one element
>> per raster band, so, counting the number of elements of one of these
>> arrays, I can get the number of raster bands. But it doesn't seem to
>> be a very "elegant" way. Do we have another way to do this?
> 
> Jorge,
> 
> I believe taking the count of values in the pixel_types array is the
> correct approach to determining the number of bands.

Yes, I can confirm this is the way to find number of bands of raster
(raster coverage) registered in RASTER_COLUMNS table.

Number of bands per single raster BLOB (row) can be retrieved
using SQL function ST_NumBands
(http://trac.osgeo.org/postgis/browser/spike/wktraster/rt_pg/rtpostgis.sql.in.c?rev=4146#L167)

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From jorge.arevalo at gmail.com  Sun Jul 12 19:01:28 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Sun Jul 12 19:01:51 2009
Subject: [gdal-dev] Question about gdal2wktraster
Message-ID: <cb4457700907121601m113aecc9ie89130cce918e564@mail.gmail.com>

Hello,

Context: GDAL WKT Raster driver

I've loaded the tif image
ftp://ftp.remotesensing.org/geotiff/samples/gdal_eg/cea.tif on PostGIS
using gdal2wktraster script using this line: gdal2wktraster.py -r
cea.tif -t usa_mountain_one_band -s 4267 -b 1 -k 514x15 -I -M -o
usa_raster_one_band.sql

I used the srid 4267 because the information given for "gdalinfo
cea.tif" (Maybe it is my error).

The problem is: If I execute gdalinfo over the table created in
PostGIS using my driver, I get this:

(...)
GEOGCS["NAD27",
    DATUM["North_American_Datum_1927",
        SPHEROID["Clarke 1866",6378206.4,294.9786982138982,
            AUTHORITY["EPSG","7008"]],
        AUTHORITY["EPSG","6267"]],
    PRIMEM["Greenwich",0,
        AUTHORITY["EPSG","8901"]],
    UNIT["degree",0.01745329251994328,
        AUTHORITY["EPSG","9122"]],
    AUTHORITY["EPSG","4267"]]
(...)
Corner Coordinates:
Upper Left  (  -28493.168, 4224973.000) (Invalid angle,Invalid angle)
Lower Left  (  -28493.168, 4194061.600) (Invalid angle,Invalid angle)
Upper Right (    2358.210, 4224973.000) (Invalid angle,Invalid angle)
Lower Right (    2358.210, 4194061.600) (Invalid angle,Invalid angle)
Center      (  -13067.479, 4209517.300) (Invalid angle,Invalid angle)
(...)

Look at "Invalid angle error". If I execute gdalinfo over the tif
image, I get this:
(...)
PROJCS["unnamed",
    GEOGCS["NAD27",
        DATUM["North_American_Datum_1927",
            SPHEROID["Clarke 1866",6378206.4,294.9786982138982,
                AUTHORITY["EPSG","7008"]],
            AUTHORITY["EPSG","6267"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4267"]],
    PROJECTION["Cylindrical_Equal_Area"],
    PARAMETER["standard_parallel_1",33.75],
    PARAMETER["central_meridian",-117.333333333333],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]]]
(...)
Corner Coordinates:
Upper Left  (  -28493.167, 4255884.544) (117d38'28.21"W, 33d54'13.08"N)
Lower Left  (  -28493.167, 4224973.143) (117d38'28.21"W, 33d37'30.66"N)
Upper Right (    2358.212, 4255884.544) (117d18'28.28"W, 33d54'13.08"N)
Lower Right (    2358.212, 4224973.143) (117d18'28.28"W, 33d37'30.66"N)
Center      (  -13067.478, 4240428.844) (117d28'28.24"W, 33d45'51.47"N)
(...)

The important thing is the "UNIT["metre",1,AUTHORITY["EPSG","9001"]]]
part of the string that doesn't appear in my driver. For this reason,
the transformation between utm (the original coords of the tif image)
and lat,long doesn't take place. Then, the UTM coordinates are
considered as invalid angles, of course.

I think that my great mistake, as I said, was to choose 4267 as srid
(I wasn't sure). Am I right? If yes, What srid should I use? If not,
maybe the error is in my driver's code...

Many thanks in advance
Best regards,

Jorge
From jorge.arevalo at gmail.com  Sun Jul 12 19:55:02 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Sun Jul 12 20:02:16 2009
Subject: [gdal-dev] GDAL WKT Raster driver weekly report #7
Message-ID: <cb4457700907121655o73e88742l675fa9c3908b57c3@mail.gmail.com>

Hello,

Here, the report for this week:
http://www.gis4free.org/blog/2009/07/13/gsoc-09-weekly-report-7-0307-1007/

The project can be followed here:
http://trac.osgeo.org/gdal/wiki/WKTRasterDriver

Best regards,
Jorge
From jorge.arevalo at gmail.com  Sun Jul 12 20:02:31 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Sun Jul 12 20:02:53 2009
Subject: [gdal-dev] Question about GDALDriverManager + gdal2wktraster
In-Reply-To: <4A5A59FD.1080407@loskot.net>
References: <cb4457700907041232v62da7945nd74dd03a7297746f@mail.gmail.com> 
	<f3b73b7d0907060226n4b122bdxa23bd444a025e0c6@mail.gmail.com> 
	<4A5A59FD.1080407@loskot.net>
Message-ID: <cb4457700907121702xe292b13r18e99661ef3cdf3@mail.gmail.com>

Hello,

On Sun, Jul 12, 2009 at 11:47 PM, Mateusz Loskot<mateusz@loskot.net> wrote:
> Tamas Szekeres wrote:
>> Jorge,
>>
>> I'm not aware much about the changes in the gdal2wktraster script, I can see
>> a r4226 which may be related to the problem. Please consult with the author
>> Mateusz Loskot about the possible reasons you've encountered with the
>> script.
>
> Tamas,
>
> I believe Jorge's problem with driver registration is not related to
> recent changes to the gdal2wktraster.
>
> Though, new version of the script still needs testing with various
> datasets and use cases - bugs are expected.
>
Don't worry: the problem was only an small error in my code: I was
setting the driver's name incorrectly. So, it was never found. Fixed
and working now :-)

Many thanks
Best regards

Jorge
From jorge.arevalo at gmail.com  Sun Jul 12 20:12:06 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Sun Jul 12 20:13:30 2009
Subject: [gdal-dev] How do we know the number of raster bands of a WKT 
	Raster object?
In-Reply-To: <4A5A5B3D.10406@loskot.net>
References: <cb4457700907071701g36e5e4fch287eb3f6a6964f95@mail.gmail.com> 
	<4A53E893.6020003@pobox.com> <4A5A5B3D.10406@loskot.net>
Message-ID: <cb4457700907121712i68a93e05l7e6202e81950f124@mail.gmail.com>

Hello,

On Sun, Jul 12, 2009 at 11:53 PM, Mateusz Loskot<mateusz@loskot.net> wrote:
> Frank Warmerdam wrote:
>> Jorge Ar?valo wrote:
>>> Hello,
>>>
>>> I have a doubt: I have a raster loaded in PostgreSQL with
>>> gdal2wktraster, and I'm not sure of the best way to know the number of
>>> raster bands the raster has. The fields "pixel_types" and
>>> "nodata_values" from raster_columns table are arrays with one element
>>> per raster band, so, counting the number of elements of one of these
>>> arrays, I can get the number of raster bands. But it doesn't seem to
>>> be a very "elegant" way. Do we have another way to do this?
>>
>> Jorge,
>>
>> I believe taking the count of values in the pixel_types array is the
>> correct approach to determining the number of bands.
>
> Yes, I can confirm this is the way to find number of bands of raster
> (raster coverage) registered in RASTER_COLUMNS table.
>
> Number of bands per single raster BLOB (row) can be retrieved
> using SQL function ST_NumBands
> (http://trac.osgeo.org/postgis/browser/spike/wktraster/rt_pg/rtpostgis.sql.in.c?rev=4146#L167)
>

Thanks Mateusz. And this has remainded me of something always make me
to doubt, in the context of GDAL WKTRaster driver.

I can get information about raster properties in RASTER_COLUMNS table,
but I can get this information from each row too. So, in which
information source should I trust? If they both have sync problems
(for example, if the number of raster bands in RASTER_COLUMNS table
doesn't match the number of bands in the header of each raster), what
should I do?.

My logic says that the information stored in rasters is the good one,
and it may be used to correct the information read from RASTER_COLUMNS
table, if needed. AFAIK, there's no automatic update of RASTER_COLUMNS
table. Then, this table can easily be out of date. Am I right?

Best regards
Jorge
From botany at strato.net  Sun Jul 12 19:56:49 2009
From: botany at strato.net (Kris R. DeLaney)
Date: Sun Jul 12 20:15:27 2009
Subject: [gdal-dev] SQL "LEFT JOIN"
Message-ID: <001801ca034c$6c49bc90$6400a8c0@ORCHID>

Re:  GDAL 1.6.0, released 2008/11/26

I have be unable to use OGR2OGR to accomplish an SQL LEFT JOIN of a shapefile with the attributes of a master dbf table.  If my syntax is not correct, I hope someone can show me where it is wrong.

The files I am using are all in the same directory.  I have tried countless variation of syntax, but the two which seem correct, but don't work, are:

(1)  ogr2ogr -sql "SELECT test.*, master.DRCLASSDCD FROM test LEFT JOIN master.dbf.MUKEY ON test.MUKEY = master.MUKEY" outshpdir test.shp

(2)  ogr2ogr -sql "SELECT test.*, master.DRCLASSDCD FROM test LEFT JOIN 'x:/JUNK/JOIN/master.dbf'.MUKEY ON test.MUKEY = master.MUKEY" outfiles test.shp

Small test files of actual data being tried are at:  http://botanicalexplorer.com/gdal/test_files.zip

Any assistance would be greatly appreciated.


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090712/494daebc/attachment.html
From mateusz at loskot.net  Sun Jul 12 21:05:21 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sun Jul 12 21:05:35 2009
Subject: [gdal-dev] How do we know the number of raster bands of a WKT
	Raster object?
In-Reply-To: <cb4457700907121712i68a93e05l7e6202e81950f124@mail.gmail.com>
References: <cb4457700907071701g36e5e4fch287eb3f6a6964f95@mail.gmail.com>
	<4A53E893.6020003@pobox.com> <4A5A5B3D.10406@loskot.net>
	<cb4457700907121712i68a93e05l7e6202e81950f124@mail.gmail.com>
Message-ID: <4A5A8851.6060209@loskot.net>

Jorge Ar?valo wrote:
> Hello,
> 
> On Sun, Jul 12, 2009 at 11:53 PM, Mateusz Loskot<mateusz@loskot.net> wrote:
>> Frank Warmerdam wrote:
>>> Jorge Ar?valo wrote:
>>>> Hello,
>>>>
>>>> I have a doubt: I have a raster loaded in PostgreSQL with
>>>> gdal2wktraster, and I'm not sure of the best way to know the number of
>>>> raster bands the raster has. The fields "pixel_types" and
>>>> "nodata_values" from raster_columns table are arrays with one element
>>>> per raster band, so, counting the number of elements of one of these
>>>> arrays, I can get the number of raster bands. But it doesn't seem to
>>>> be a very "elegant" way. Do we have another way to do this?
>>> Jorge,
>>>
>>> I believe taking the count of values in the pixel_types array is the
>>> correct approach to determining the number of bands.
>> Yes, I can confirm this is the way to find number of bands of raster
>> (raster coverage) registered in RASTER_COLUMNS table.
>>
>> Number of bands per single raster BLOB (row) can be retrieved
>> using SQL function ST_NumBands
>> (http://trac.osgeo.org/postgis/browser/spike/wktraster/rt_pg/rtpostgis.sql.in.c?rev=4146#L167)
>>
> 
> Thanks Mateusz. And this has remainded me of something always make me
> to doubt, in the context of GDAL WKTRaster driver.
> 
> I can get information about raster properties in RASTER_COLUMNS table,
> but I can get this information from each row too. So, in which
> information source should I trust? If they both have sync problems
> (for example, if the number of raster bands in RASTER_COLUMNS table
> doesn't match the number of bands in the header of each raster), what
> should I do?.

In my opinion, you should always trust RASTER_COLUMNS.
This is a metadata table with all raster tables registered. Plus, for
regular blocking it stores additional information required for
manipulating collection of tiles (coverage, matrix of raster tiles).

Actually, I believe that one day WKT Raster should provide validation
functions on SQL level, so it's possible to (optionally|obligatorily)
validate rasters being loaded into table.

Some simple validation has been implemented on metadata level in
AddRasterColumn

http://trac.osgeo.org/postgis/browser/spike/wktraster/rt_pg/rtpostgis.sql.in.c?rev=4146#L412

> My logic says that the information stored in rasters is the good one,
> and it may be used to correct the information read from RASTER_COLUMNS
> table, if needed. AFAIK, there's no automatic update of RASTER_COLUMNS
> table. Then, this table can easily be out of date. Am I right?

The problem is that...it's hard to say which approach is correct.
There has been some discussion about that and AFAIR there was no
consensus reached so far.

For myself, regular blocking applications have higher priority and as
such I consider RASTER_COLUMNS as valid and overriding.

If WKT Raster driver for GDAL is supposed to work with regular blocking
(RB), then if querying RB-enabled tables, you must assume all rasters
(tiles,rows) have common properties - as stated in the specification.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From AMBROSE.J.LEWIS at saic.com  Mon Jul 13 07:55:42 2009
From: AMBROSE.J.LEWIS at saic.com (Lewis, Ambrose J.)
Date: Mon Jul 13 08:10:59 2009
Subject: [gdal-dev] polygon to grid?
Message-ID: <3D807689CC0B144B8A15A477B60C25D401925863@0015-its-exmb10.us.saic.com>

Hi All:

I'm relatively new to GDAL/OGR, so please forgive a dumb question!

I have a grid file (DTED elevations) and a shapefile of polygons
(building locations and an APEX attribute representing their height).

I'd like to combine these together so that my new[x,y] = DTED
elevation[x,y] + building apex[x,y] (assuming the building apex is zero
if the loc was outside any of the shapefile's polygon)

How can I convert the polygons to a grid compatible with DTED?

THANXS!

amb

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090713/dc50b838/attachment.html
From warmerdam at pobox.com  Mon Jul 13 11:12:58 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon Jul 13 11:12:35 2009
Subject: [gdal-dev] polygon to grid?
In-Reply-To: <3D807689CC0B144B8A15A477B60C25D401925863@0015-its-exmb10.us.saic.com>
References: <3D807689CC0B144B8A15A477B60C25D401925863@0015-its-exmb10.us.saic.com>
Message-ID: <4A5B4EFA.7010006@pobox.com>

Lewis, Ambrose J. wrote:
> Hi All:
> 
> I?m relatively new to GDAL/OGR, so please forgive a dumb question!
> 
> I have a grid file (DTED elevations) and a shapefile of polygons 
> (building locations and an APEX attribute representing their height).
> 
> I?d like to combine these together so that my new[x,y] = DTED 
> elevation[x,y] + building apex[x,y] (assuming the building apex is zero 
> if the loc was outside any of the shapefile?s polygon)
> 
> How can I convert the polygons to a grid compatible with DTED?

Ambrose,

You can use the gdal_rasterize to burn the building elevations into an
empty file.  You will need a zeroed file of the right extents and resolution.
It may be helpful to create that by scaling your target dted tile to zero.

eg.

gdal_translate -scale 0 10000 0 0 src.dt2 apex_work.tif
gdal_rasterize -a buildapex \
    building_footprints.shp -l building_footprints \
    apex_work.tif
... your own script to add the apex_work.tif to src.dt2 ...

The above would create a GeoTIFF file named apex_work.tif
with the same resolution and extents as the DTED "src.dt2".

Then gdal_rasterize will burn all the polygons from building_footprints.shp
into the file using the attribute "buildapex" as the source of the
elevations to burn into the file.

There is no particular program available to add the building eleations
into the dted so you might need to write a python numpy script or something
like that.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From maplabs at light42.com  Mon Jul 13 14:39:53 2009
From: maplabs at light42.com (Brian Hamlin)
Date: Mon Jul 13 13:43:30 2009
Subject: [gdal-dev] SQL "LEFT JOIN"
In-Reply-To: <001801ca034c$6c49bc90$6400a8c0@ORCHID>
References: <001801ca034c$6c49bc90$6400a8c0@ORCHID>
Message-ID: <8DED5250-6FDC-11DE-B3E9-0003936901F0@light42.com>

On Jul 12, 2009, at 4:56 PM, Kris R. DeLaney wrote:

> Re:? GDAL 1.6.0, released 2008/11/26
> ?
> I have be unable to use OGR2OGR to accomplish an SQL?LEFT JOIN of a 
> shapefile with the attributes of a master dbf table.? If my syntax is 
> not correct, I hope someone can show me where it is wrong.
> ?
> The files I am using are all in the same directory.? I have tried 
> countless variation of syntax, but the two which seem correct, but 
> don't work,?are:
> ?
> (1)? ogr2ogr -sql "SELECT test.*, master.DRCLASSDCD FROM test LEFT 
> JOIN master.dbf.MUKEY ON test.MUKEY = master.MUKEY" outshpdir test.shp
> ?
> (2)? ogr2ogr -sql "SELECT test.*, master.DRCLASSDCD FROM test LEFT 
> JOIN 'x:/JUNK/JOIN/master.dbf'.MUKEY ON test.MUKEY = master.MUKEY" 
> outfiles test.shp
> ?
> Small?test files of actual data being tried are at:? 
> http://botanicalexplorer.com/gdal/test_files.zip
> ?
> Any assistance would be greatly appreciated.
> ?
>


without knowing any better, I set up the data and tried

ogr2ogr -sql "SELECT test.*, master.DRCLASSDCD FROM test LEFT JOIN 
master.MUKEY ON test.MUKEY = master.MUKEY" -f geoJSON out.json 
soils.shp

as a simple way of testing.. (geoJSON is an easy human readable format)

I suspect that ogr2ogr isnt bringing in the 2nd data file at all. 
though others would know better
I suspect that bringing it into Postgres (or other supperted db) would 
change that

   -Brian


> ?
> ?
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
From adeel.raza at crc.gc.ca  Mon Jul 13 13:59:53 2009
From: adeel.raza at crc.gc.ca (Adeel Raza)
Date: Mon Jul 13 13:59:41 2009
Subject: [gdal-dev] GDALClose
Message-ID: <4A5B7619.6070602@crc.gc.ca>

Hi,

Should GDALClose() be called on virtual or MEM datasets?

Regards,
Adeel Raza.
From warmerdam at pobox.com  Mon Jul 13 14:15:15 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon Jul 13 14:14:51 2009
Subject: [gdal-dev] GDALClose
In-Reply-To: <4A5B7619.6070602@crc.gc.ca>
References: <4A5B7619.6070602@crc.gc.ca>
Message-ID: <4A5B79B3.5040109@pobox.com>

Adeel Raza wrote:
> Hi,
> 
> Should GDALClose() be called on virtual or MEM datasets?
> 

Adeel,

Yes, it will generally result in release of associated resources.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From debeaudette at ucdavis.edu  Mon Jul 13 14:13:21 2009
From: debeaudette at ucdavis.edu (Dylan Beaudette)
Date: Mon Jul 13 14:20:12 2009
Subject: [gdal-dev] SQL "LEFT JOIN"
In-Reply-To: <8DED5250-6FDC-11DE-B3E9-0003936901F0@light42.com>
References: <001801ca034c$6c49bc90$6400a8c0@ORCHID>
	<8DED5250-6FDC-11DE-B3E9-0003936901F0@light42.com>
Message-ID: <200907131113.21806.dylan.beaudette@gmail.com>

On Monday 13 July 2009, Brian Hamlin wrote:
> On Jul 12, 2009, at 4:56 PM, Kris R. DeLaney wrote:
> > Re:? GDAL 1.6.0, released 2008/11/26
> > ?
> > I have be unable to use OGR2OGR to accomplish an SQL?LEFT JOIN of a
> > shapefile with the attributes of a master dbf table.? If my syntax is
> > not correct, I hope someone can show me where it is wrong.
> > ?
> > The files I am using are all in the same directory.? I have tried
> > countless variation of syntax, but the two which seem correct, but
> > don't work,?are:
> > ?
> > (1)? ogr2ogr -sql "SELECT test.*, master.DRCLASSDCD FROM test LEFT
> > JOIN master.dbf.MUKEY ON test.MUKEY = master.MUKEY" outshpdir test.shp
> > ?
> > (2)? ogr2ogr -sql "SELECT test.*, master.DRCLASSDCD FROM test LEFT
> > JOIN 'x:/JUNK/JOIN/master.dbf'.MUKEY ON test.MUKEY = master.MUKEY"
> > outfiles test.shp
> > ?
> > Small?test files of actual data being tried are at:?
> > http://botanicalexplorer.com/gdal/test_files.zip
> > ?
> > Any assistance would be greatly appreciated.
> > ?
>
> without knowing any better, I set up the data and tried
>
> ogr2ogr -sql "SELECT test.*, master.DRCLASSDCD FROM test LEFT JOIN
> master.MUKEY ON test.MUKEY = master.MUKEY" -f geoJSON out.json
> soils.shp
>
> as a simple way of testing.. (geoJSON is an easy human readable format)
>
> I suspect that ogr2ogr isnt bringing in the 2nd data file at all.
> though others would know better
> I suspect that bringing it into Postgres (or other supperted db) would
> change that
>
>    -Brian

Hi,

I would second Brian's suggestion to perform these type of operations in a 
relational database. Since you are working with SSURGO data, I may be able to 
send you some Postgresql database templates that we use.

Cheers,
Dylan




-- 
Dylan Beaudette
Soil Resource Laboratory
http://casoilresource.lawr.ucdavis.edu/
University of California at Davis
530.754.7341
From adeel.raza at crc.gc.ca  Mon Jul 13 14:31:58 2009
From: adeel.raza at crc.gc.ca (Adeel Raza)
Date: Mon Jul 13 14:31:46 2009
Subject: [gdal-dev] GDALClose
In-Reply-To: <4A5B79B3.5040109@pobox.com>
References: <4A5B7619.6070602@crc.gc.ca> <4A5B79B3.5040109@pobox.com>
Message-ID: <4A5B7D9E.4050600@crc.gc.ca>

Hi Frank,

I recently called GDALClose() on a virtual dataset (created from 
GDALAutoCreateWarpedVRT()), and it was causing writing violation errors 
and privileged instruction errors on the line following the GDALClose() 
call. Can you shed any light on this matter? Thanks.

Best Regards,
Adeel Raza.

Frank Warmerdam wrote:
> Adeel Raza wrote:
>> Hi,
>>
>> Should GDALClose() be called on virtual or MEM datasets?
>>
>
> Adeel,
>
> Yes, it will generally result in release of associated resources.
>
> Best regards,
From warmerdam at pobox.com  Mon Jul 13 14:49:45 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon Jul 13 14:55:10 2009
Subject: [gdal-dev] GDALClose
In-Reply-To: <4A5B7D9E.4050600@crc.gc.ca>
References: <4A5B7619.6070602@crc.gc.ca> <4A5B79B3.5040109@pobox.com>
	<4A5B7D9E.4050600@crc.gc.ca>
Message-ID: <4A5B81C9.1080808@pobox.com>

Adeel Raza wrote:
> Hi Frank,
> 
> I recently called GDALClose() on a virtual dataset (created from 
> GDALAutoCreateWarpedVRT()), and it was causing writing violation errors 
> and privileged instruction errors on the line following the GDALClose() 
> call. Can you shed any light on this matter? Thanks.

Adeel,

Not really - at least not without further information about what your code
was doing.

One possibility is that you were explicitly closing the datasets referenced
by the virtual dataset and when it closed and tried to deallocate them a
double free occurred.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From zhaops at hotmail.com  Mon Jul 13 16:03:19 2009
From: zhaops at hotmail.com (Peisheng Zhao)
Date: Mon Jul 13 16:04:21 2009
Subject: [gdal-dev] Building GDAL error
Message-ID: <BAY121-W9A428BFAE8D47BFC4F5CED0220@phx.gbl>


Hi all,

I am trying to compile GDAL-1.6.1 with lipdap 3.8.2:

./configure --with-threads --with-ogr --with-geos --without-libtool --with-proj=/tools/share/COTS/proj-4.6.1
--without-python --without-perl --with-libtiff=internal --with-geotiff=internal
--with-hdf4=/tools/share/COTS/HDF4.2r4 --with-hdf5=/tools/share/COTS/hdf5-1.8.2
--with-pg=/usr/bin/pg_config --with-dods-root=/var/tmp/www/libdap-3.8.2 --without-ogdi
--without-geos --prefix=/var/tmp/www/gdal-1.6.1

But I always get the error:

/var/tmp/www/gdal-1.6.1/libgdal.so: undefined reference to `libdap::DAS::DAS(libdap::AttrTable*, unsigned int)'

Who can help me figure it out? Thanks a lot.

Peisheng

_________________________________________________________________
Lauren found her dream laptop. Find the PC that?s right for you.
http://www.microsoft.com/windows/choosepc/?ocid=ftp_val_wl_290
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090713/782ceea1/attachment.html
From ksshannon at gmail.com  Mon Jul 13 16:19:09 2009
From: ksshannon at gmail.com (Kyle Shannon)
Date: Mon Jul 13 16:26:48 2009
Subject: [gdal-dev] Python ReprojectImage()
Message-ID: <c28f2e140907131319v1d2f0f94o4627223d4d212049@mail.gmail.com>

Hello all,
I can seem to get idle to display the function prototype for
ReprojectImage().  Are the arguments the same as the C++ function?  I have
noticed some of the Python bindings take slightly different args. Thanks

regards,

Kyle
# ===================
Kyle Shannon
Physical Science Technician
RMRS Fire Sciences Lab
Fire, Fuels & Smoke - RWU 4405
5775 Highway 10 W.
Missoula, MT 59808
(406)829-6954
kshannon@fs.fed.us
ksshannon@gmail.com
# ===================
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090713/f9de0a92/attachment.html
From Pierre.Racine at sbf.ulaval.ca  Mon Jul 13 16:32:32 2009
From: Pierre.Racine at sbf.ulaval.ca (Pierre Racine)
Date: Mon Jul 13 16:32:35 2009
Subject: [gdal-dev] Question about gdal2wktraster
In-Reply-To: <cb4457700907121601m113aecc9ie89130cce918e564@mail.gmail.com>
References: <cb4457700907121601m113aecc9ie89130cce918e564@mail.gmail.com>
Message-ID: <D58FF82475EA0A4A9347D3CE16B46E5F9D5804@exch-be03.ulaval.ca>

Jorge,

4267 should be the right CS (http://spatialreference.org/ref/epsg/4267/).

however, the bounding box seems different also. You should compare what bounding box you get using your driver with "SELECT astext(extent) FROM raster_columns" in PostGIS...

"SELECT astext(extent) FROM raster_columns" should match what you get from gdalinfo over the tif image.

Pierre

>-----Original Message-----
>From: gdal-dev-bounces@lists.osgeo.org [mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Jorge
>Ar?valo
>Sent: 12 juillet 2009 19:01
>To: gdal-dev@lists.osgeo.org; PostGIS Development Discussion
>Subject: [gdal-dev] Question about gdal2wktraster
>
>Hello,
>
>Context: GDAL WKT Raster driver
>
>I've loaded the tif image
>ftp://ftp.remotesensing.org/geotiff/samples/gdal_eg/cea.tif on PostGIS
>using gdal2wktraster script using this line: gdal2wktraster.py -r
>cea.tif -t usa_mountain_one_band -s 4267 -b 1 -k 514x15 -I -M -o
>usa_raster_one_band.sql
>
>I used the srid 4267 because the information given for "gdalinfo
>cea.tif" (Maybe it is my error).
>
>The problem is: If I execute gdalinfo over the table created in
>PostGIS using my driver, I get this:
>
>(...)
>GEOGCS["NAD27",
>    DATUM["North_American_Datum_1927",
>        SPHEROID["Clarke 1866",6378206.4,294.9786982138982,
>            AUTHORITY["EPSG","7008"]],
>        AUTHORITY["EPSG","6267"]],
>    PRIMEM["Greenwich",0,
>        AUTHORITY["EPSG","8901"]],
>    UNIT["degree",0.01745329251994328,
>        AUTHORITY["EPSG","9122"]],
>    AUTHORITY["EPSG","4267"]]
>(...)
>Corner Coordinates:
>Upper Left  (  -28493.168, 4224973.000) (Invalid angle,Invalid angle)
>Lower Left  (  -28493.168, 4194061.600) (Invalid angle,Invalid angle)
>Upper Right (    2358.210, 4224973.000) (Invalid angle,Invalid angle)
>Lower Right (    2358.210, 4194061.600) (Invalid angle,Invalid angle)
>Center      (  -13067.479, 4209517.300) (Invalid angle,Invalid angle)
>(...)
>
>Look at "Invalid angle error". If I execute gdalinfo over the tif
>image, I get this:
>(...)
>PROJCS["unnamed",
>    GEOGCS["NAD27",
>        DATUM["North_American_Datum_1927",
>            SPHEROID["Clarke 1866",6378206.4,294.9786982138982,
>                AUTHORITY["EPSG","7008"]],
>            AUTHORITY["EPSG","6267"]],
>        PRIMEM["Greenwich",0],
>        UNIT["degree",0.0174532925199433],
>        AUTHORITY["EPSG","4267"]],
>    PROJECTION["Cylindrical_Equal_Area"],
>    PARAMETER["standard_parallel_1",33.75],
>    PARAMETER["central_meridian",-117.333333333333],
>    PARAMETER["false_easting",0],
>    PARAMETER["false_northing",0],
>    UNIT["metre",1,
>        AUTHORITY["EPSG","9001"]]]
>(...)
>Corner Coordinates:
>Upper Left  (  -28493.167, 4255884.544) (117d38'28.21"W, 33d54'13.08"N)
>Lower Left  (  -28493.167, 4224973.143) (117d38'28.21"W, 33d37'30.66"N)
>Upper Right (    2358.212, 4255884.544) (117d18'28.28"W, 33d54'13.08"N)
>Lower Right (    2358.212, 4224973.143) (117d18'28.28"W, 33d37'30.66"N)
>Center      (  -13067.478, 4240428.844) (117d28'28.24"W, 33d45'51.47"N)
>(...)
>
>The important thing is the "UNIT["metre",1,AUTHORITY["EPSG","9001"]]]
>part of the string that doesn't appear in my driver. For this reason,
>the transformation between utm (the original coords of the tif image)
>and lat,long doesn't take place. Then, the UTM coordinates are
>considered as invalid angles, of course.
>
>I think that my great mistake, as I said, was to choose 4267 as srid
>(I wasn't sure). Am I right? If yes, What srid should I use? If not,
>maybe the error is in my driver's code...
>
>Many thanks in advance
>Best regards,
>
>Jorge
>_______________________________________________
>gdal-dev mailing list
>gdal-dev@lists.osgeo.org
>http://lists.osgeo.org/mailman/listinfo/gdal-dev
From mateusz at loskot.net  Mon Jul 13 18:14:00 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Mon Jul 13 18:14:07 2009
Subject: [gdal-dev] Question about gdal2wktraster
In-Reply-To: <D58FF82475EA0A4A9347D3CE16B46E5F9D5804@exch-be03.ulaval.ca>
References: <cb4457700907121601m113aecc9ie89130cce918e564@mail.gmail.com>
	<D58FF82475EA0A4A9347D3CE16B46E5F9D5804@exch-be03.ulaval.ca>
Message-ID: <4A5BB1A8.10403@loskot.net>

Pierre Racine wrote:
> Jorge,
> 
> 4267 should be the right CS (http://spatialreference.org/ref/epsg/4267/).

Actually, it isn't.
What gdalinfo reports for the file cea.tif is a projected CS,
this one to be precise:

http://www.remotesensing.org/geotiff/proj_list/cylindrical_equal_area.html

"There does not seem to be an EPSG equivelent."

Check this too:

http://lists.maptools.org/pipermail/geotiff/2005-March/000138.html

Jorge,

I'd suggest to test datasets based on EPSG 4326 first.
After these work for you, then switch to projected ones.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From botany at strato.net  Mon Jul 13 20:37:36 2009
From: botany at strato.net (Kris R. DeLaney)
Date: Mon Jul 13 20:37:43 2009
Subject: [gdal-dev] SQL "LEFT JOIN"
References: <001801ca034c$6c49bc90$6400a8c0@ORCHID>
	<8DED5250-6FDC-11DE-B3E9-0003936901F0@light42.com>
Message-ID: <002601ca041b$494d20e0$6400a8c0@ORCHID>

et al:

Actually, the SQL page at the OGR2OGR site shows syntax for DBF joins:

http://www.gdal.org/ogr/ogr_sql.html  (scroll down the page a ways for 
actual examples)

Unfortunately, I could not get any of these examples to work either.  Maybe 
someone else can ???

I am trying to avoid going through the extra hoops of Postgre/PostGIS. 
Tentatively, before I read that OGR2OGR should do the join, I had composed 
an application in VBA using the MS Jet driver.  It works fine for batch 
joining and creating renamed DBF's (by first importing them to Access) but, 
unfortunately, the Jet driver has an 8.3 filename limitation ... so it 
creates other problems and additional work.

OGR2OGR has proved very powerful for many other tasks.  If I can get to also 
do DBF joins, I can perform all of necessary shapefile operations in one 
step.

Thanks,
Kris R. DeLaney



----- Original Message ----- 
From: "Brian Hamlin" <maplabs@light42.com>
To: "Kris R. DeLaney" <botany@strato.net>
Cc: <gdal-dev@lists.osgeo.org>
Sent: Monday, July 13, 2009 2:39 PM
Subject: Re: [gdal-dev] SQL "LEFT JOIN"


On Jul 12, 2009, at 4:56 PM, Kris R. DeLaney wrote:

> Re: GDAL 1.6.0, released 2008/11/26
>
> I have be unable to use OGR2OGR to accomplish an SQL LEFT JOIN of a 
> shapefile with the attributes of a master dbf table. If my syntax is not 
> correct, I hope someone can show me where it is wrong.
>
> The files I am using are all in the same directory. I have tried countless 
> variation of syntax, but the two which seem correct, but don't work, are:
>
> (1) ogr2ogr -sql "SELECT test.*, master.DRCLASSDCD FROM test LEFT JOIN 
> master.dbf.MUKEY ON test.MUKEY = master.MUKEY" outshpdir test.shp
>
> (2) ogr2ogr -sql "SELECT test.*, master.DRCLASSDCD FROM test LEFT JOIN 
> 'x:/JUNK/JOIN/master.dbf'.MUKEY ON test.MUKEY = master.MUKEY" outfiles 
> test.shp
>
> Small test files of actual data being tried are at: 
> http://botanicalexplorer.com/gdal/test_files.zip
>
> Any assistance would be greatly appreciated.
>
>


without knowing any better, I set up the data and tried

ogr2ogr -sql "SELECT test.*, master.DRCLASSDCD FROM test LEFT JOIN
master.MUKEY ON test.MUKEY = master.MUKEY" -f geoJSON out.json
soils.shp

as a simple way of testing.. (geoJSON is an easy human readable format)

I suspect that ogr2ogr isnt bringing in the 2nd data file at all.
though others would know better
I suspect that bringing it into Postgres (or other supperted db) would
change that

   -Brian


>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From emiliomayorga at gmail.com  Mon Jul 13 21:53:48 2009
From: emiliomayorga at gmail.com (Emilio Mayorga)
Date: Mon Jul 13 21:53:50 2009
Subject: [gdal-dev] SQL "LEFT JOIN"
In-Reply-To: <002601ca041b$494d20e0$6400a8c0@ORCHID>
References: <001801ca034c$6c49bc90$6400a8c0@ORCHID>
	<8DED5250-6FDC-11DE-B3E9-0003936901F0@light42.com>
	<002601ca041b$494d20e0$6400a8c0@ORCHID>
Message-ID: <b0d146420907131853g5bc6bd9dweca7e037fc9495b4@mail.gmail.com>

Kris,

This statement worked for me a few months back:

ogr2ogr -sql "SELECT
basinid,basinname,area,basinorder,mouth_lon,mouth_lat FROM stn30test
srcgeom LEFT JOIN 'dbffilelongname.dbf'.dbffilelongname jointbl ON
srcgeom.basinid = jointbl.basinid" -f "ESRI Shapefile"
stn30test_join.shp stn30test.shp

I can't find the exact GDAL version, but I'm pretty sure it's 1.5.x;
it's from FWTools2.2.8 (on Windows). stn30test.shp is the source shape
file, dbffilelongname.dbf the joined dbf, and stn30test_join.shp the
output. I didn't qualify the select fields with a table alias b/c
they're all coming from the dbf file, so I don't know if that would
have an impact. All files are in the same folder.

Hope that helps.

-Emilio Mayorga



On Mon, Jul 13, 2009 at 5:37 PM, Kris R. DeLaney<botany@strato.net> wrote:
> et al:
>
> Actually, the SQL page at the OGR2OGR site shows syntax for DBF joins:
>
> http://www.gdal.org/ogr/ogr_sql.html ?(scroll down the page a ways for
> actual examples)
>
> Unfortunately, I could not get any of these examples to work either. ?Maybe
> someone else can ???
>
> I am trying to avoid going through the extra hoops of Postgre/PostGIS.
> Tentatively, before I read that OGR2OGR should do the join, I had composed
> an application in VBA using the MS Jet driver. ?It works fine for batch
> joining and creating renamed DBF's (by first importing them to Access) but,
> unfortunately, the Jet driver has an 8.3 filename limitation ... so it
> creates other problems and additional work.
>
> OGR2OGR has proved very powerful for many other tasks. ?If I can get to also
> do DBF joins, I can perform all of necessary shapefile operations in one
> step.
>
> Thanks,
> Kris R. DeLaney
>
>
>
> ----- Original Message ----- From: "Brian Hamlin" <maplabs@light42.com>
> To: "Kris R. DeLaney" <botany@strato.net>
> Cc: <gdal-dev@lists.osgeo.org>
> Sent: Monday, July 13, 2009 2:39 PM
> Subject: Re: [gdal-dev] SQL "LEFT JOIN"
>
>
> On Jul 12, 2009, at 4:56 PM, Kris R. DeLaney wrote:
>
>> Re: GDAL 1.6.0, released 2008/11/26
>>
>> I have be unable to use OGR2OGR to accomplish an SQL LEFT JOIN of a
>> shapefile with the attributes of a master dbf table. If my syntax is not
>> correct, I hope someone can show me where it is wrong.
>>
>> The files I am using are all in the same directory. I have tried countless
>> variation of syntax, but the two which seem correct, but don't work, are:
>>
>> (1) ogr2ogr -sql "SELECT test.*, master.DRCLASSDCD FROM test LEFT JOIN
>> master.dbf.MUKEY ON test.MUKEY = master.MUKEY" outshpdir test.shp
>>
>> (2) ogr2ogr -sql "SELECT test.*, master.DRCLASSDCD FROM test LEFT JOIN
>> 'x:/JUNK/JOIN/master.dbf'.MUKEY ON test.MUKEY = master.MUKEY" outfiles
>> test.shp
>>
>> Small test files of actual data being tried are at:
>> http://botanicalexplorer.com/gdal/test_files.zip
>>
>> Any assistance would be greatly appreciated.
>>
>>
>
>
> without knowing any better, I set up the data and tried
>
> ogr2ogr -sql "SELECT test.*, master.DRCLASSDCD FROM test LEFT JOIN
> master.MUKEY ON test.MUKEY = master.MUKEY" -f geoJSON out.json
> soils.shp
>
> as a simple way of testing.. (geoJSON is an easy human readable format)
>
> I suspect that ogr2ogr isnt bringing in the 2nd data file at all.
> though others would know better
> I suspect that bringing it into Postgres (or other supperted db) would
> change that
>
> ?-Brian
From maplabs at light42.com  Tue Jul 14 02:53:22 2009
From: maplabs at light42.com (Brian Hamlin)
Date: Tue Jul 14 01:56:54 2009
Subject: [gdal-dev] SQL "LEFT JOIN"
In-Reply-To: <b0d146420907131853g5bc6bd9dweca7e037fc9495b4@mail.gmail.com>
References: <001801ca034c$6c49bc90$6400a8c0@ORCHID>
	<8DED5250-6FDC-11DE-B3E9-0003936901F0@light42.com>
	<002601ca041b$494d20e0$6400a8c0@ORCHID>
	<b0d146420907131853g5bc6bd9dweca7e037fc9495b4@mail.gmail.com>
Message-ID: <05548AC3-7043-11DE-B3E9-0003936901F0@light42.com>

ok, well n that case, given your test data, an expression that works is

ogr2ogr -sql "SELECT soils.*, DRCLASSDCD FROM soils soils LEFT JOIN 
'master.dbf'.master master  ON soils.MUKEY = master.MUKEY" -f geoJSON 
out.json soils.shp

   substitute a Shp file directory, etc to suit your purposes

    -Brian


On Jul 13, 2009, at 6:53 PM, Emilio Mayorga wrote:

> Kris,
>
> This statement worked for me a few months back:
>
> ogr2ogr -sql "SELECT
> basinid,basinname,area,basinorder,mouth_lon,mouth_lat FROM stn30test
> srcgeom LEFT JOIN 'dbffilelongname.dbf'.dbffilelongname jointbl ON
> srcgeom.basinid = jointbl.basinid" -f "ESRI Shapefile"
> stn30test_join.shp stn30test.shp
>
> I can't find the exact GDAL version, but I'm pretty sure it's 1.5.x;
> it's from FWTools2.2.8 (on Windows). stn30test.shp is the source shape
> file, dbffilelongname.dbf the joined dbf, and stn30test_join.shp the
> output. I didn't qualify the select fields with a table alias b/c
> they're all coming from the dbf file, so I don't know if that would
> have an impact. All files are in the same folder.
>
> Hope that helps.
>
> -Emilio Mayorga
>
>
>
> On Mon, Jul 13, 2009 at 5:37 PM, Kris R. DeLaney<botany@strato.net> 
> wrote:
>> et al:
>>
>> Actually, the SQL page at the OGR2OGR site shows syntax for DBF joins:
>>
>> http://www.gdal.org/ogr/ogr_sql.html ?(scroll down the page a ways for
>> actual examples)
>>
>> Unfortunately, I could not get any of these examples to work either. 
>> ?Maybe
>> someone else can ???
>>
>> I am trying to avoid going through the extra hoops of Postgre/PostGIS.
>> Tentatively, before I read that OGR2OGR should do the join, I had 
>> composed
>> an application in VBA using the MS Jet driver. ?It works fine for 
>> batch
>> joining and creating renamed DBF's (by first importing them to 
>> Access) but,
>> unfortunately, the Jet driver has an 8.3 filename limitation ... so it
>> creates other problems and additional work.
>>
>> OGR2OGR has proved very powerful for many other tasks. ?If I can get 
>> to also
>> do DBF joins, I can perform all of necessary shapefile operations in 
>> one
>> step.
>>
>> Thanks,
>> Kris R. DeLaney
>>
>>
>>
>> ----- Original Message ----- From: "Brian Hamlin" 
>> <maplabs@light42.com>
>> To: "Kris R. DeLaney" <botany@strato.net>
>> Cc: <gdal-dev@lists.osgeo.org>
>> Sent: Monday, July 13, 2009 2:39 PM
>> Subject: Re: [gdal-dev] SQL "LEFT JOIN"
>>
>>
>> On Jul 12, 2009, at 4:56 PM, Kris R. DeLaney wrote:
>>
>>> Re: GDAL 1.6.0, released 2008/11/26
>>>
>>> I have be unable to use OGR2OGR to accomplish an SQL LEFT JOIN of a
>>> shapefile with the attributes of a master dbf table. If my syntax is 
>>> not
>>> correct, I hope someone can show me where it is wrong.
>>>
>>> The files I am using are all in the same directory. I have tried 
>>> countless
>>> variation of syntax, but the two which seem correct, but don't work, 
>>> are:
>>>
>>> (1) ogr2ogr -sql "SELECT test.*, master.DRCLASSDCD FROM test LEFT 
>>> JOIN
>>> master.dbf.MUKEY ON test.MUKEY = master.MUKEY" outshpdir test.shp
>>>
>>> (2) ogr2ogr -sql "SELECT test.*, master.DRCLASSDCD FROM test LEFT 
>>> JOIN
>>> 'x:/JUNK/JOIN/master.dbf'.MUKEY ON test.MUKEY = master.MUKEY" 
>>> outfiles
>>> test.shp
>>>
>>> Small test files of actual data being tried are at:
>>> http://botanicalexplorer.com/gdal/test_files.zip
>>>
>>> Any assistance would be greatly appreciated.
>>>
>>>
>>
>>
>> without knowing any better, I set up the data and tried
>>
>> ogr2ogr -sql "SELECT test.*, master.DRCLASSDCD FROM test LEFT JOIN
>> master.MUKEY ON test.MUKEY = master.MUKEY" -f geoJSON out.json
>> soils.shp
>>
>> as a simple way of testing.. (geoJSON is an easy human readable 
>> format)
>>
>> I suspect that ogr2ogr isnt bringing in the 2nd data file at all.
>> though others would know better
>> I suspect that bringing it into Postgres (or other supperted db) would
>> change that
>>
>> ?-Brian
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From schut at sarvision.nl  Tue Jul 14 03:37:50 2009
From: schut at sarvision.nl (Vincent Schut)
Date: Tue Jul 14 03:37:53 2009
Subject: [gdal-dev] Question about gdal2wktraster
In-Reply-To: <cb4457700907130801q14a850eeqaa042e48050d2de6@mail.gmail.com>
References: <cb4457700907121601m113aecc9ie89130cce918e564@mail.gmail.com>
	<4A5AE0DD.2060506@sarvision.nl>
	<cb4457700907130801q14a850eeqaa042e48050d2de6@mail.gmail.com>
Message-ID: <4A5C35CE.6010609@sarvision.nl>

Jorge Ar?valo wrote:
> Hi Vincent,
>
> 2009/7/13 Vincent Schut <schut@sarvision.nl>:
>   
>> Hi Jorge,
>>
>> I'm not sure what projection your cea.tif was in (it seems you've not pasted
>> the full wkt output from gdalinfo on cea.tif?), but you say in your message
>> that it is supposed to be UTM. For UTM, it is very easy to get the right
>> EPSG code:
>>     
>
> Right. The whole output is:
>
> Driver: GTiff/GeoTIFF
> Files: gsoc09/test_data/tiff_files/cea.tif
> Size is 514, 515
> Coordinate System is:
> PROJCS["unnamed",
>     GEOGCS["NAD27",
>         DATUM["North_American_Datum_1927",
>             SPHEROID["Clarke 1866",6378206.4,294.9786982138982,
>                 AUTHORITY["EPSG","7008"]],
>             AUTHORITY["EPSG","6267"]],
>         PRIMEM["Greenwich",0],
>         UNIT["degree",0.0174532925199433],
>         AUTHORITY["EPSG","4267"]],
>     PROJECTION["Cylindrical_Equal_Area"],
>     PARAMETER["standard_parallel_1",33.75],
>     PARAMETER["central_meridian",-117.333333333333],
>     PARAMETER["false_easting",0],
>     PARAMETER["false_northing",0],
>     UNIT["metre",1,
>         AUTHORITY["EPSG","9001"]]]
> Origin = (-28493.166784412522247,4255884.543802191503346)
> Pixel Size = (60.022136983193739,-60.022136983193739)
> Metadata:
>   AREA_OR_POINT=Area
> Image Structure Metadata:
>   INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  (  -28493.167, 4255884.544) (117d38'28.21"W, 33d54'13.08"N)
> Lower Left  (  -28493.167, 4224973.143) (117d38'28.21"W, 33d37'30.66"N)
> Upper Right (    2358.212, 4255884.544) (117d18'28.28"W, 33d54'13.08"N)
> Lower Right (    2358.212, 4224973.143) (117d18'28.28"W, 33d37'30.66"N)
> Center      (  -13067.478, 4240428.844) (117d28'28.24"W, 33d45'51.47"N)
> Band 1 Block=514x15 Type=Byte, ColorInterp=Gray
>
>   
Right, I'm really no projections expert, and this could very well be 
another way to describe an UTM projection, but is does not seem to be 
the standard WKT for an UTM zone projection. At least the PROJCS is 
'unnamed', and should otherwise be something like 'UTM 31N', I think... 
Your filename is 'cea' and your PROJECTION string is 'Cylinderical Equal 
Area', while for an UTM projection it should read 'Transverse Mercator'. 
Are you sure the image is in UTM, and not in CEA projection? (For a fast 
overview of projection types, see e.g. 
http://www.colorado.edu/geography/gcraft/notes/mapproj/mapproj.html)
If you're sure it's UTM, you can just use an UTM EPSG code. However, 
have you considered that it might not be you neither your projection 
info that is faulty, but the gdal wktraster driver? As gdalinfo does 
report the correct coordinates on the input file, I think something goes 
wrong either importing the projection stuff into the pg tables, or at 
reading/translating it back into gdal when running gdalinfo on it. I'd 
say, rephrase your question and ask it again at the gdal list. Hopefully 
someone more knowledgeable on wktraster (which I know next to nothing 
about) will have something to say.

> I'm not sure of the UTM zone of my data. How could I can get it? From
> gdalinfo output?
>   
Nope. By googling :-)
Search for 'utm zones', click on the images tab, and choose one you like 
best :-)

Btw, it's considered good practise to not only reply to the sender of an 
email (me), but CC also to the gdal list, so others might chime in 
and/or learn useful stuff from our conversation. As a bonus it will be 
indexed by search engines and you'll be able to find your answer later 
again by searching the web :-)

cheers,
Vincent.
> Best regards
> Jorge
>
>   
>> Vincent.
>>
>> Jorge Ar?valo wrote:
>>     
>>> Hello,
>>>
>>> Context: GDAL WKT Raster driver
>>>
>>> I've loaded the tif image
>>> ftp://ftp.remotesensing.org/geotiff/samples/gdal_eg/cea.tif on PostGIS
>>> using gdal2wktraster script using this line: gdal2wktraster.py -r
>>> cea.tif -t usa_mountain_one_band -s 4267 -b 1 -k 514x15 -I -M -o
>>> usa_raster_one_band.sql
>>>
>>> I used the srid 4267 because the information given for "gdalinfo
>>> cea.tif" (Maybe it is my error).
>>>
>>> The problem is: If I execute gdalinfo over the table created in
>>> PostGIS using my driver, I get this:
>>>
>>> (...)
>>> GEOGCS["NAD27",
>>>    DATUM["North_American_Datum_1927",
>>>        SPHEROID["Clarke 1866",6378206.4,294.9786982138982,
>>>            AUTHORITY["EPSG","7008"]],
>>>        AUTHORITY["EPSG","6267"]],
>>>    PRIMEM["Greenwich",0,
>>>        AUTHORITY["EPSG","8901"]],
>>>    UNIT["degree",0.01745329251994328,
>>>        AUTHORITY["EPSG","9122"]],
>>>    AUTHORITY["EPSG","4267"]]
>>> (...)
>>> Corner Coordinates:
>>> Upper Left  (  -28493.168, 4224973.000) (Invalid angle,Invalid angle)
>>> Lower Left  (  -28493.168, 4194061.600) (Invalid angle,Invalid angle)
>>> Upper Right (    2358.210, 4224973.000) (Invalid angle,Invalid angle)
>>> Lower Right (    2358.210, 4194061.600) (Invalid angle,Invalid angle)
>>> Center      (  -13067.479, 4209517.300) (Invalid angle,Invalid angle)
>>> (...)
>>>
>>> Look at "Invalid angle error". If I execute gdalinfo over the tif
>>> image, I get this:
>>> (...)
>>> PROJCS["unnamed",
>>>    GEOGCS["NAD27",
>>>        DATUM["North_American_Datum_1927",
>>>            SPHEROID["Clarke 1866",6378206.4,294.9786982138982,
>>>                AUTHORITY["EPSG","7008"]],
>>>            AUTHORITY["EPSG","6267"]],
>>>        PRIMEM["Greenwich",0],
>>>        UNIT["degree",0.0174532925199433],
>>>        AUTHORITY["EPSG","4267"]],
>>>    PROJECTION["Cylindrical_Equal_Area"],
>>>    PARAMETER["standard_parallel_1",33.75],
>>>    PARAMETER["central_meridian",-117.333333333333],
>>>    PARAMETER["false_easting",0],
>>>    PARAMETER["false_northing",0],
>>>    UNIT["metre",1,
>>>        AUTHORITY["EPSG","9001"]]]
>>> (...)
>>> Corner Coordinates:
>>> Upper Left  (  -28493.167, 4255884.544) (117d38'28.21"W, 33d54'13.08"N)
>>> Lower Left  (  -28493.167, 4224973.143) (117d38'28.21"W, 33d37'30.66"N)
>>> Upper Right (    2358.212, 4255884.544) (117d18'28.28"W, 33d54'13.08"N)
>>> Lower Right (    2358.212, 4224973.143) (117d18'28.28"W, 33d37'30.66"N)
>>> Center      (  -13067.478, 4240428.844) (117d28'28.24"W, 33d45'51.47"N)
>>> (...)
>>>
>>> The important thing is the "UNIT["metre",1,AUTHORITY["EPSG","9001"]]]
>>> part of the string that doesn't appear in my driver. For this reason,
>>> the transformation between utm (the original coords of the tif image)
>>> and lat,long doesn't take place. Then, the UTM coordinates are
>>> considered as invalid angles, of course.
>>>
>>> I think that my great mistake, as I said, was to choose 4267 as srid
>>> (I wasn't sure). Am I right? If yes, What srid should I use? If not,
>>> maybe the error is in my driver's code...
>>>
>>> Many thanks in advance
>>> Best regards,
>>>
>>> Jorge
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev@lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>>       
>>     

From monshi at home.se  Tue Jul 14 05:19:52 2009
From: monshi at home.se (Tomas R)
Date: Tue Jul 14 05:20:12 2009
Subject: [gdal-dev] Re: C# Nad27 to WGS 84
In-Reply-To: <4A5A0B67.10309@pobox.com>
References: <h3c5r1$kmo$1@ger.gmane.org> <4A5A0B67.10309@pobox.com>
Message-ID: <h3hijq$pnv$1@ger.gmane.org>

I have no luck

Downloaded compiled package form http://vbkto.dyndns.org:1280/sdk/ 
(MSVC2008 (Win32) -stable, v 1500).

I set the path as described before, that is:

nadPath = 
Path.Combine(Path.GetDirectoryName(this.GetType().Assembly.Location), 
@"Gdalbin\Nad");
Environment.SetEnvironmentVariable("PROJ_LIB", nadPath);

If I check the environment variable it is set. But proj.dll perhaps do 
not share the environment variables with the C#-project? Must it perhaps 
be set globally?

I also try setting a GDAL setting with same arguments:

OSGeo.GDAL.Gdal.SetConfigOption("PROJ_LIB", nadPath);

and also that one checks out OK afterwards, that is, the setting exists 
in Gdal.

The result of the code is the same with my first version, with an 
unknown version of proj.dll. That is just de given values back. (no 
matter what target projection I use). No exception thrown as with the 
latest version of Proj4 from their website.

And the, the same as before:
            SpatialReference spatNad27 = new SpatialReference("");
            spatNad27.SetWellKnownGeogCS("Nad27");
            SpatialReference spatNad83 = new SpatialReference("");
            spatNad83.SetWellKnownGeogCS("WGS84");
            CoordinateTransformation trans = new 
CoordinateTransformation(spatNad27, spatNad83);
            double[] p = new double[3];
            trans.TransformPoint(p, -117, 30, 0);
            this.textBox1.Text = p[0] + ", " + p[1] + ", " + p[2];


and the result in the textbox is
-117
30.0000000008175
2.61394307017326E-05
which is the same result  as I get if I remove the path setting or 
remove all of Projs data files. Something is amiss.

Gdal-test env. Unsure how to set up. Should not the code above be enough?
A friend did a test in Python and he could do the transform, but that is 
no big help for me.

Any ideas what I miss or what I should test?

/Tomas
Frank Warmerdam skrev:
> Tomas R wrote:
>> Hi again,
>>
>> New problems arises as the world of Gdal is quite complex to grasp.
>>
>> Have understood that the transformation of coordinates from Nad 27 
>> datum to WGS 84 requires some look up tables to be done correctly, 
>> tables that differ with the are the Nad 27 is valid in.
>>
>> Simple question is, how to set up a general solution in C# that uses 
>> these shift tables.
>> I have in code a simple test:
>>           SpatialReference spatNad27 = new SpatialReference("");
>>            spatNad27.SetWellKnownGeogCS("Nad27");
>>            SpatialReference spatNad83 = new SpatialReference("");
>>            spatNad83.SetWellKnownGeogCS("Nad83");
>>                      CoordinateTransformation trans = new 
>> CoordinateTransformation(spatNad27, spatNad83);
>>            double[] p = new double[3];
>>            trans.TransformPoint(p, -117, 30, 0);
>>
>> that gives back
>> -117, 30,0000000008175
>> which I believe is not correct ( see http://proj.maptools.org/faq.html )
>>
>> I have Proj4.dll, I have set an environment path to PROJ_LIB where 
>> the nad shift tables should exist. Must I do something else in the 
>> setup or is the call to the transform different? or have I done 
>> correctly but misinterpreted the results?
>>
>> What I in reality is interested is transforming whatever coordinate 
>> in whatever projection/datum to and from WGS84 without any extra 
>> hassle fast and easy via the C# interface. That should not be to 
>> hard? Or?
>
> Tomas,
>
> If I test with the testepsg program (using GDAL services) with
> CPL_DEBUG and PROJ_DEBUG defined ON I get the following output.
>
> warmerda@gdal64[264]% setenv PROJ_DEBUG
> warmerda@gdal64[265]% testepsg -t NAD27 NAD83 -117 30
> OGRCT: Source: +proj=longlat +ellps=clrk66 +datum=NAD27 +no_defs
> OGRCT: Target: +proj=longlat +ellps=GRS80 +datum=NAD83 +no_defs
> pj_open_lib(conus): call 
> fopen(/wrk/home/warmerda/bld/share/proj/conus) - succeeded
> Ctable Conterminous United States 273x121: LL=(-131,20) UR=(-63,50)
> pj_open_lib(alaska): call 
> fopen(/wrk/home/warmerda/bld/share/proj/alaska) - succeeded
> Ctable Alaska 529x249: LL=(-194,46) UR=(-128,77)
> pj_open_lib(ntv2_0.gsb): call 
> fopen(/wrk/home/warmerda/bld/share/proj/ntv2_0.gsb) - failed
> pj_open_lib(ntv1_can.dat): call 
> fopen(/wrk/home/warmerda/bld/share/proj/ntv1_can.dat) - succeeded
> NTv1 393x177: LL=(-142,40) UR=(-44,84)
> pj_open_lib(conus): call 
> fopen(/wrk/home/warmerda/bld/share/proj/conus) - succeeded
> pj_apply_gridshift(): used Conterminous United States
> (-117.000000,30.000000,0.000000) -> (-117.000806,30.000113,0.000026)
>
> I don't know if it is practical for you to enable debugging and see
> stderr output, but if you can it might help you deduce what is
> or is not working.
>
> It *sounds* like you have done what is necessary, but it is hard
> for me to know if you have made some mistake, such as preprocessing
> the grid shift file into binary form.
>
> Best regards,

From jorge.arevalo at gmail.com  Tue Jul 14 09:03:00 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Tue Jul 14 09:03:23 2009
Subject: [postgis-devel] [gdal-dev] Question about gdal2wktraster
In-Reply-To: <4A5BB1A8.10403@loskot.net>
References: <cb4457700907121601m113aecc9ie89130cce918e564@mail.gmail.com> 
	<D58FF82475EA0A4A9347D3CE16B46E5F9D5804@exch-be03.ulaval.ca> 
	<4A5BB1A8.10403@loskot.net>
Message-ID: <cb4457700907140603g2561b396if1c609f5c01f1947@mail.gmail.com>

Hello,

On Tue, Jul 14, 2009 at 12:14 AM, Mateusz Loskot<mateusz@loskot.net> wrote:
> Pierre Racine wrote:
>> Jorge,
>>
>> 4267 should be the right CS (http://spatialreference.org/ref/epsg/4267/).
>
> Actually, it isn't.
> What gdalinfo reports for the file cea.tif is a projected CS,
> this one to be precise:
>
> http://www.remotesensing.org/geotiff/proj_list/cylindrical_equal_area.html
>
> "There does not seem to be an EPSG equivelent."
>
> Check this too:
>
> http://lists.maptools.org/pipermail/geotiff/2005-March/000138.html
>
> Jorge,
>
> I'd suggest to test datasets based on EPSG 4326 first.
> After these work for you, then switch to projected ones.

Do you know where can I find geotiff images based on EPSG:4326?

Many thanks in advance

Best Regards
Jorge
From mateusz at loskot.net  Tue Jul 14 09:28:24 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue Jul 14 09:26:38 2009
Subject: [postgis-devel] [gdal-dev] Question about gdal2wktraster
In-Reply-To: <cb4457700907140603g2561b396if1c609f5c01f1947@mail.gmail.com>
References: <cb4457700907121601m113aecc9ie89130cce918e564@mail.gmail.com>
	<D58FF82475EA0A4A9347D3CE16B46E5F9D5804@exch-be03.ulaval.ca>
	<4A5BB1A8.10403@loskot.net>
	<cb4457700907140603g2561b396if1c609f5c01f1947@mail.gmail.com>
Message-ID: <4A5C87F8.7040704@loskot.net>

Jorge Ar?valo wrote:
> Hello,
> 
> On Tue, Jul 14, 2009 at 12:14 AM, Mateusz Loskot<mateusz@loskot.net> wrote:
>> Pierre Racine wrote:
>>> Jorge,
>>>
>>> 4267 should be the right CS (http://spatialreference.org/ref/epsg/4267/).
>> Actually, it isn't.
>> What gdalinfo reports for the file cea.tif is a projected CS,
>> this one to be precise:
>>
>> http://www.remotesensing.org/geotiff/proj_list/cylindrical_equal_area.html
>>
>> "There does not seem to be an EPSG equivelent."
>>
>> Check this too:
>>
>> http://lists.maptools.org/pipermail/geotiff/2005-March/000138.html
>>
>> Jorge,
>>
>> I'd suggest to test datasets based on EPSG 4326 first.
>> After these work for you, then switch to projected ones.
> 
> Do you know where can I find geotiff images based on EPSG:4326?

Jorge,

My favorite images for initial and basic testing of WKT Raster are here:

http://download.osgeo.org/gdal/data/gtiff/

First, I use utm.tif to test if 1 band raster works.
This one is UTM (EPSG:26711) not WGS 84, but it's perfectly usable as 
such. Also, you can easily transform it to WGS84 with GDAL utils if you 
like.

Next, I switch to >1 bands datasets and for this purpose I use 
small_world.tif. This one is WGS 84 (EPSG:4326).

When my WKT Raster software works with these two images, I start playing 
with other and big datasets.

I think that small files will make it easier to debug your driver.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
From jorge.arevalo at gmail.com  Tue Jul 14 11:13:05 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Tue Jul 14 11:13:27 2009
Subject: [postgis-devel] [gdal-dev] Question about gdal2wktraster
In-Reply-To: <4A5C87F8.7040704@loskot.net>
References: <cb4457700907121601m113aecc9ie89130cce918e564@mail.gmail.com> 
	<D58FF82475EA0A4A9347D3CE16B46E5F9D5804@exch-be03.ulaval.ca> 
	<4A5BB1A8.10403@loskot.net>
	<cb4457700907140603g2561b396if1c609f5c01f1947@mail.gmail.com> 
	<4A5C87F8.7040704@loskot.net>
Message-ID: <cb4457700907140813r6e4d4444s5e0430c87ddb1523@mail.gmail.com>

Hello,

On Tue, Jul 14, 2009 at 3:28 PM, Mateusz Loskot<mateusz@loskot.net> wrote:
>>> I'd suggest to test datasets based on EPSG 4326 first.
>>> After these work for you, then switch to projected ones.
>>
>> Do you know where can I find geotiff images based on EPSG:4326?
>
> Jorge,
>
> My favorite images for initial and basic testing of WKT Raster are here:
>
> http://download.osgeo.org/gdal/data/gtiff/
>
> First, I use utm.tif to test if 1 band raster works.
> This one is UTM (EPSG:26711) not WGS 84, but it's perfectly usable as such.
> Also, you can easily transform it to WGS84 with GDAL utils if you like.

Actually, this is the same image I was using (cea.tif), but mine has
wrong srid... Thanks a lot for the info!


>
> Next, I switch to >1 bands datasets and for this purpose I use
> small_world.tif. This one is WGS 84 (EPSG:4326).
>
> When my WKT Raster software works with these two images, I start playing
> with other and big datasets.
>
> I think that small files will make it easier to debug your driver.

Yes. Just now, I'm debugging :-)

Thanks again, and best regards
Jorge
From mateusz at loskot.net  Tue Jul 14 11:21:14 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue Jul 14 11:19:27 2009
Subject: [postgis-devel] [gdal-dev] Question about gdal2wktraster
In-Reply-To: <cb4457700907140813r6e4d4444s5e0430c87ddb1523@mail.gmail.com>
References: <cb4457700907121601m113aecc9ie89130cce918e564@mail.gmail.com>
	<D58FF82475EA0A4A9347D3CE16B46E5F9D5804@exch-be03.ulaval.ca>
	<4A5BB1A8.10403@loskot.net>	<cb4457700907140603g2561b396if1c609f5c01f1947@mail.gmail.com>
	<4A5C87F8.7040704@loskot.net>
	<cb4457700907140813r6e4d4444s5e0430c87ddb1523@mail.gmail.com>
Message-ID: <4A5CA26A.90900@loskot.net>

Jorge Ar?valo wrote:
> Hello,
> 
> On Tue, Jul 14, 2009 at 3:28 PM, Mateusz Loskot<mateusz@loskot.net> wrote:
>>>> I'd suggest to test datasets based on EPSG 4326 first.
>>>> After these work for you, then switch to projected ones.
>>> Do you know where can I find geotiff images based on EPSG:4326?
>> Jorge,
>>
>> My favorite images for initial and basic testing of WKT Raster are here:
>>
>> http://download.osgeo.org/gdal/data/gtiff/
>>
>> First, I use utm.tif to test if 1 band raster works.
>> This one is UTM (EPSG:26711) not WGS 84, but it's perfectly usable as such.
>> Also, you can easily transform it to WGS84 with GDAL utils if you like.
> 
> Actually, this is the same image I was using (cea.tif), but mine has
> wrong srid... Thanks a lot for the info!

Yes, I know. utm.tif and cea.tif have the same content
but these datasets are different, not the same because of projection.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
From nbest at ci.uchicago.edu  Tue Jul 14 11:19:42 2009
From: nbest at ci.uchicago.edu (Neil Best)
Date: Tue Jul 14 11:19:44 2009
Subject: [Gdal-dev] mean of pixel stack
In-Reply-To: <002f01ca017c$f1d45f40$d57d1dc0$@org>
References: <002f01ca017c$f1d45f40$d57d1dc0$@org>
Message-ID: <1247584782837-3257397.post@n2.nabble.com>




Greg Fiske wrote:
> 
> 
> Does anyone have some code (or methodology) that they are willing to share
> that will take a stack of images and return the mean or std dev. of each
> pixel stack (pixels that occupy the same space), while ignoring a user
> define pixel value?
> 

Greg, I am pretty sure that you could do this in GRASS by first applying
MASKs to your input layers so that the values that you want to ignore appear
NULL and then use r.series method=average, off the top of my head.  Of
course this might mean installing GRASS, loading your data, etc.  Are you
comfortable with that prospect?  I can help you with that off-list if you
like.

Neil
-- 
View this message in context: http://n2.nabble.com/mean-of-pixel-stack-tp3240160p3257397.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From nbest at ci.uchicago.edu  Tue Jul 14 11:50:36 2009
From: nbest at ci.uchicago.edu (Neil Best)
Date: Tue Jul 14 11:50:39 2009
Subject: [Gdal-dev] building GDAL under cygwin with ODBC
In-Reply-To: <1247092272012-3228405.post@n2.nabble.com>
References: <1247092272012-3228405.post@n2.nabble.com>
Message-ID: <1247586636964-3257609.post@n2.nabble.com>




Neil Best wrote:
> 
> Does anyone know if it's possible?
> 
> I said:  ./configure --with-odbc=/usr/include/w32api
> 

It doesn't seem possible, so I am resigned to making it work in the FWTools
DOS shell.  Is it possible to make a DSN-less ODBC connection?  In other
words, can I specify my data source on the fly without having to go through
the ODBC Administrator and setting up every single Access file as a DSN? 
Something along the lines of:

ODBC:"Driver={Microsoft Access Driver (*.mdb)};Dbq=c:\somepath\mydb.mdb;" 

(Lifted from
http://www.carlprothman.net/Default.aspx?tabid=90#ODBCDriverForAccess )

Otherwise I'll have to write something in Perl using Win32::ODBC to loop
through all of my Access files and set up a DSN for each one.
-- 
View this message in context: http://n2.nabble.com/building-GDAL-under-cygwin-with-ODBC-tp3228405p3257609.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From warmerdam at pobox.com  Tue Jul 14 12:09:26 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue Jul 14 12:09:28 2009
Subject: [Gdal-dev] building GDAL under cygwin with ODBC
In-Reply-To: <1247586636964-3257609.post@n2.nabble.com>
References: <1247092272012-3228405.post@n2.nabble.com>
	<1247586636964-3257609.post@n2.nabble.com>
Message-ID: <4A5CADB6.5070700@pobox.com>

Neil Best wrote:
> 
> 
> Neil Best wrote:
>> Does anyone know if it's possible?
>>
>> I said:  ./configure --with-odbc=/usr/include/w32api
>>
> 
> It doesn't seem possible, so I am resigned to making it work in the FWTools
> DOS shell.  Is it possible to make a DSN-less ODBC connection?  In other
> words, can I specify my data source on the fly without having to go through
> the ODBC Administrator and setting up every single Access file as a DSN? 
> Something along the lines of:
> 
> ODBC:"Driver={Microsoft Access Driver (*.mdb)};Dbq=c:\somepath\mydb.mdb;" 
> 
> (Lifted from
> http://www.carlprothman.net/Default.aspx?tabid=90#ODBCDriverForAccess )
> 
> Otherwise I'll have to write something in Perl using Win32::ODBC to loop
> through all of my Access files and set up a DSN for each one.

Neil,

I have reviewed the current OGR ODBC driver and it does not seem to be
possible to pass in datasource names of the form you suggest though it is
vaguely possible that some appropriate magic quoting might get it to work.

I will say that the PGeo driver internally uses exactly this form to
access .mdb files through the same underlying ODBC machinery without
creating a DSN.  So at most the OGR ODBC driver would need some adjustments
to support it.

I will take a crack at this today, and if it I get it working I'll push out
a new FWTools release with the support.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From jorge.arevalo at gmail.com  Tue Jul 14 12:48:51 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Tue Jul 14 12:49:14 2009
Subject: [postgis-devel] [gdal-dev] Question about gdal2wktraster
In-Reply-To: <4A5CA26A.90900@loskot.net>
References: <cb4457700907121601m113aecc9ie89130cce918e564@mail.gmail.com> 
	<D58FF82475EA0A4A9347D3CE16B46E5F9D5804@exch-be03.ulaval.ca> 
	<4A5BB1A8.10403@loskot.net>
	<cb4457700907140603g2561b396if1c609f5c01f1947@mail.gmail.com> 
	<4A5C87F8.7040704@loskot.net>
	<cb4457700907140813r6e4d4444s5e0430c87ddb1523@mail.gmail.com> 
	<4A5CA26A.90900@loskot.net>
Message-ID: <cb4457700907140948w4b960d34x5973ac4f8a934447@mail.gmail.com>

Hello,

On Tue, Jul 14, 2009 at 5:21 PM, Mateusz Loskot<mateusz@loskot.net> wrote:
> Jorge Ar?valo wrote:
>>
>> Hello,
>>
>> On Tue, Jul 14, 2009 at 3:28 PM, Mateusz Loskot<mateusz@loskot.net> wrote:
>>>>>
>>>>> I'd suggest to test datasets based on EPSG 4326 first.
>>>>> After these work for you, then switch to projected ones.
>>>>
>>>> Do you know where can I find geotiff images based on EPSG:4326?
>>>
>>> Jorge,
>>>
>>> My favorite images for initial and basic testing of WKT Raster are here:
>>>
>>> http://download.osgeo.org/gdal/data/gtiff/
>>>
>>> First, I use utm.tif to test if 1 band raster works.
>>> This one is UTM (EPSG:26711) not WGS 84, but it's perfectly usable as
>>> such.
>>> Also, you can easily transform it to WGS84 with GDAL utils if you like.
>>
>> Actually, this is the same image I was using (cea.tif), but mine has
>> wrong srid... Thanks a lot for the info!
>
> Yes, I know. utm.tif and cea.tif have the same content
> but these datasets are different, not the same because of projection.

Ok, here are the Corner coordinates of the utm.tif file (gdalinfo output):

Corner Coordinates:
Upper Left  (  440720.000, 3751320.000) (117d38'28.21"W, 33d54'8.47"N)
Lower Left  (  440720.000, 3720600.000) (117d38'20.79"W, 33d37'31.04"N)
Upper Right (  471440.000, 3751320.000) (117d18'32.07"W, 33d54'13.08"N)
Lower Right (  471440.000, 3720600.000) (117d18'28.50"W, 33d37'35.61"N)
Center      (  456080.000, 3735960.000) (117d28'27.39"W, 33d45'52.46"N)

After loading the raster in PostGIS, the Corner Coordinates set by my
driver (gdalinfo ouptut):

Corner Coordinates:
Upper Left  (  440720.000, 3720600.000) (117d38'20.79"W, 33d37'31.04"N)
Lower Left  (  440720.000, 3689880.000) (117d38'13.48"W, 33d20'53.57"N)
Upper Right (  471440.000, 3720600.000) (117d18'28.50"W, 33d37'35.61"N)
Lower Right (  471440.000, 3689880.000) (117d18'24.98"W, 33d20'58.09"N)
Center      (  456080.000, 3705240.000) (117d28'21.94"W, 33d29'14.98"N)

As you can see, there are small differences in Y coordinate. I
populate the raster info in this way:

(...)
pszProjectionRef = (char *) GetProjectionRef(); // returns the correct
projection ref for srid 26711

poSR = new OGRSpatialReference(pszProjectionRef);

// pszWKTRaster has the extent of the raster, got by ST_AsText(extent)
from raster_columns
// poGeom will store the geometry
poOgrErr = OGRGeometryFactory::createFromWkt(&pszWKTRaster, poSR,
&poGeom);

poE = new OGREnvelope();
poGeom->getEnvelope(poE);

// raster coordinates
fUpperLeftX = poE->MinX;
fUpperLeftY = poE->MinY;

// fPixelSizeX and fPixelSizeY got from raster_columns
nRasterXSize = (int) fabs(rint((poE->MaxX - poE->MinX) / fPixelSizeX));
nRasterYSize = (int) fabs(rint((poE->MaxY - poE->MinY) / fPixelSizeY));
(...)

Then, I suppose that gdalinfo obtains corner coordinates from upper
left coordinates and raster size. Is there any obvious problem in this
code? Maybe the rint function?

Thanks in advance

Best regards
Jorge


>
> Best regards,
> --
> Mateusz Loskot, http://mateusz.loskot.net
> _______________________________________________
> postgis-devel mailing list
> postgis-devel@postgis.refractions.net
> http://postgis.refractions.net/mailman/listinfo/postgis-devel
>
From adeel.raza at crc.gc.ca  Tue Jul 14 13:11:31 2009
From: adeel.raza at crc.gc.ca (Adeel Raza)
Date: Tue Jul 14 13:11:15 2009
Subject: [gdal-dev] Is it possible to perform a warp operation on an MEM
	dataset?
Message-ID: <4A5CBC43.6020804@crc.gc.ca>

Hi,

Is it possible to perform a warp operation on an MEM dataset? And if it 
is possible should I just follow the guidelines suggested in the Warp 
API tutorial on the GDAL website? The reason why I want to do this is 
because recently I have discovered that Read/Write operations to an MEM 
dataset are much quicker than to a VRT dataset created from 
GDALAutoCreatWarpedVRT().

Best Regards,
Adeel Raza.

From jorge.arevalo at gmail.com  Tue Jul 14 13:46:22 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Tue Jul 14 13:46:45 2009
Subject: [postgis-devel] [gdal-dev] Question about gdal2wktraster
In-Reply-To: <cb4457700907140948w4b960d34x5973ac4f8a934447@mail.gmail.com>
References: <cb4457700907121601m113aecc9ie89130cce918e564@mail.gmail.com> 
	<D58FF82475EA0A4A9347D3CE16B46E5F9D5804@exch-be03.ulaval.ca> 
	<4A5BB1A8.10403@loskot.net>
	<cb4457700907140603g2561b396if1c609f5c01f1947@mail.gmail.com> 
	<4A5C87F8.7040704@loskot.net>
	<cb4457700907140813r6e4d4444s5e0430c87ddb1523@mail.gmail.com> 
	<4A5CA26A.90900@loskot.net>
	<cb4457700907140948w4b960d34x5973ac4f8a934447@mail.gmail.com>
Message-ID: <cb4457700907141046u76d875bfu5accfc70abe88deb@mail.gmail.com>

Hello,

2009/7/14 Jorge Ar?valo <jorge.arevalo@gmail.com>:
> Ok, here are the Corner coordinates of the utm.tif file (gdalinfo output):
>
> Corner Coordinates:
> Upper Left ?( ?440720.000, 3751320.000) (117d38'28.21"W, 33d54'8.47"N)
> Lower Left ?( ?440720.000, 3720600.000) (117d38'20.79"W, 33d37'31.04"N)
> Upper Right ( ?471440.000, 3751320.000) (117d18'32.07"W, 33d54'13.08"N)
> Lower Right ( ?471440.000, 3720600.000) (117d18'28.50"W, 33d37'35.61"N)
> Center ? ? ?( ?456080.000, 3735960.000) (117d28'27.39"W, 33d45'52.46"N)
>
> After loading the raster in PostGIS, the Corner Coordinates set by my
> driver (gdalinfo ouptut):
>
> Corner Coordinates:
> Upper Left ?( ?440720.000, 3720600.000) (117d38'20.79"W, 33d37'31.04"N)
> Lower Left ?( ?440720.000, 3689880.000) (117d38'13.48"W, 33d20'53.57"N)
> Upper Right ( ?471440.000, 3720600.000) (117d18'28.50"W, 33d37'35.61"N)
> Lower Right ( ?471440.000, 3689880.000) (117d18'24.98"W, 33d20'58.09"N)
> Center ? ? ?( ?456080.000, 3705240.000) (117d28'21.94"W, 33d29'14.98"N)
>
> As you can see, there are small differences in Y coordinate. I
> populate the raster info in this way:
>
> (...)
> pszProjectionRef = (char *) GetProjectionRef(); // returns the correct
> projection ref for srid 26711
>
> poSR = new OGRSpatialReference(pszProjectionRef);
>
> // pszWKTRaster has the extent of the raster, got by ST_AsText(extent)
> from raster_columns
> // poGeom will store the geometry
> poOgrErr = OGRGeometryFactory::createFromWkt(&pszWKTRaster, poSR,
> &poGeom);
>
> poE = new OGREnvelope();
> poGeom->getEnvelope(poE);
>
> // raster coordinates
> fUpperLeftX = poE->MinX;
> fUpperLeftY = poE->MinY;
>
> // fPixelSizeX and fPixelSizeY got from raster_columns
> nRasterXSize = (int) fabs(rint((poE->MaxX - poE->MinX) / fPixelSizeX));
> nRasterYSize = (int) fabs(rint((poE->MaxY - poE->MinY) / fPixelSizeY));
> (...)
>
> Then, I suppose that gdalinfo obtains corner coordinates from upper
> left coordinates and raster size. Is there any obvious problem in this
> code? Maybe the rint function?

Solution:
 fUpperLeftX = poE->MinX;
 fUpperLeftY = poE->MaxY; // Not min!!!!!!!!


Sometimes I feel sooooooo stupid....

Best regards
Jorge
From even.rouault at mines-paris.org  Tue Jul 14 14:28:09 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue Jul 14 14:28:19 2009
Subject: [gdal-dev] gdalbuildvrt and nulls again - now from Photoshop
In-Reply-To: <4914D929-EBF9-4F31-A36A-9D4BFB62D1B7@kyngchaos.com>
References: <4914D929-EBF9-4F31-A36A-9D4BFB62D1B7@kyngchaos.com>
Message-ID: <200907142028.10239.even.rouault@mines-paris.org>

Le Friday 10 July 2009 21:14:18 William Kyngesburye, vous avez ?crit?:
> This time I'm taking some Photoshop-created tiffs that I georeference
> with a TFW.  These tiffs I save with transparency mask (not layers) to
> handle nulls.
>
> Reported by gdalinfo, they appear as:
>
> Band 1 Block=12775x5 Type=Byte, ColorInterp=Red
>    Mask Flags: PER_DATASET ALPHA
> Band 2 Block=12775x5 Type=Byte, ColorInterp=Green
>    Mask Flags: PER_DATASET ALPHA
> Band 3 Block=12775x5 Type=Byte, ColorInterp=Blue
>    Mask Flags: PER_DATASET ALPHA
> Band 4 Block=12775x5 Type=Byte, ColorInterp=Alpha
>
> But when I run gdalbuildvrt on them, they are skipped:
>
> gdalbuildvrt does not support heterogenous band numbers. Skipping
> [sometiff].

This warning means that you are giving a list of datasets that don't have the 
same number of bands. For example, if the first dataset examined by 
gdalbuildvrt has only 3 bands, it will ignore any further dataset whose band 
number is not 3. (if the error message isn't clear, you're welcome to suggest 
a better one)

>
> If I save it with layers instead of transparency, GDAL doesn't see the
> alpha mask on the layer:
>
> Band 1 Block=12775x6 Type=Byte, ColorInterp=Red
> Band 2 Block=12775x6 Type=Byte, ColorInterp=Green
> Band 3 Block=12775x6 Type=Byte, ColorInterp=Blue

I'm not sure what a 'layer' is for photoshop, but it is something apparently 
ignored by GDAL. Would 'tiffdump' show something interesting on those files ?

>
>
> Is there a way I can get gdalbuildvrt to recognize the transparency as
> null, without converting them with gdal_translate first?  Maybe a
> different way to save the tiff with a mask from Photoshop?

Just run gdalbuildvrt on a list of datasets that have all 4 bands.

>
> Does the vrt format support a tiff transparency mask as null (and it's
> just gdalbuildvrt that doesn't)?
>
> -----
> William Kyngesburye <kyngchaos*at*kyngchaos*dot*com>
> http://www.kyngchaos.com/
>
> "History is an illusion caused by the passage of time, and time is an
> illusion caused by the passage of history."
>
> - Hitchhiker's Guide to the Galaxy
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From woklist at kyngchaos.com  Tue Jul 14 14:50:14 2009
From: woklist at kyngchaos.com (William Kyngesburye)
Date: Tue Jul 14 14:50:20 2009
Subject: [gdal-dev] gdalbuildvrt and nulls again - now from Photoshop
In-Reply-To: <200907142028.10239.even.rouault@mines-paris.org>
References: <4914D929-EBF9-4F31-A36A-9D4BFB62D1B7@kyngchaos.com>
	<200907142028.10239.even.rouault@mines-paris.org>
Message-ID: <EB336ABD-E6D7-4623-919C-D44BDEBB43E8@kyngchaos.com>

On Jul 14, 2009, at 1:28 PM, Even Rouault wrote:

> Le Friday 10 July 2009 21:14:18 William Kyngesburye, vous avez ?crit :
>> This time I'm taking some Photoshop-created tiffs that I georeference
>> with a TFW.  These tiffs I save with transparency mask (not layers)  
>> to
>> handle nulls.
>>
>> Reported by gdalinfo, they appear as:
>>
>> Band 1 Block=12775x5 Type=Byte, ColorInterp=Red
>>   Mask Flags: PER_DATASET ALPHA
>> Band 2 Block=12775x5 Type=Byte, ColorInterp=Green
>>   Mask Flags: PER_DATASET ALPHA
>> Band 3 Block=12775x5 Type=Byte, ColorInterp=Blue
>>   Mask Flags: PER_DATASET ALPHA
>> Band 4 Block=12775x5 Type=Byte, ColorInterp=Alpha
>>
>> But when I run gdalbuildvrt on them, they are skipped:
>>
>> gdalbuildvrt does not support heterogenous band numbers. Skipping
>> [sometiff].
>
> This warning means that you are giving a list of datasets that don't  
> have the
> same number of bands. For example, if the first dataset examined by
> gdalbuildvrt has only 3 bands, it will ignore any further dataset  
> whose band
> number is not 3. (if the error message isn't clear, you're welcome  
> to suggest
> a better one)


Ah, yes, some of the images don't have nulls, and so I didn't save the  
transparency.

Is it to generate the vrt with mixed rasters?  Maybe merge the vrts of  
one set of no-null rasters and one set of rasters with nulls in a text  
editor?

Is there a technical reason (in the vrt format) that gdalbuildvrt  
can't mix 3-band (no nulls) and 4-band (nulls) rasters?  Or is it just  
rejecting the mismatches for simplicity?

-----
William Kyngesburye <kyngchaos*at*kyngchaos*dot*com>
http://www.kyngchaos.com/

"Time is an illusion - lunchtime doubly so."

- Ford Prefect


From Gary.Smart at goodrich.com  Tue Jul 14 14:58:01 2009
From: Gary.Smart at goodrich.com (Smart, Gary)
Date: Tue Jul 14 14:58:17 2009
Subject: [gdal-dev] Converting raster pixel space to geospace
Message-ID: <45D1B79D2DCCF34E966D24728765DDB3DF5A9B@nhc2ex11.goodrich.root.local>

OK - having messed with GDAL for a couple of days now, I can display
imagery using the GDAL c++ classes to extract raster tiles.

 

However, I now need to be able to convert xPixel/Line couplets to
geo-positions (UTM, LL or whatever).  I have scanned the classes and
have failed to come across a method that maps from pixel space to
geo-space (and the inverse for that matter).  I presume such methods
exists - can anyone point me to them?

 

Gary

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090714/1f2ffbfb/attachment-0001.html
From even.rouault at mines-paris.org  Tue Jul 14 15:08:28 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue Jul 14 15:08:37 2009
Subject: [gdal-dev] gdalbuildvrt and nulls again - now from Photoshop
In-Reply-To: <EB336ABD-E6D7-4623-919C-D44BDEBB43E8@kyngchaos.com>
References: <4914D929-EBF9-4F31-A36A-9D4BFB62D1B7@kyngchaos.com>
	<200907142028.10239.even.rouault@mines-paris.org>
	<EB336ABD-E6D7-4623-919C-D44BDEBB43E8@kyngchaos.com>
Message-ID: <200907142108.29094.even.rouault@mines-paris.org>

Le Tuesday 14 July 2009 20:50:14 William Kyngesburye, vous avez ?crit?:
> Ah, yes, some of the images don't have nulls, and so I didn't save the
> transparency.
>
> Is it to generate the vrt with mixed rasters?  Maybe merge the vrts of
> one set of no-null rasters and one set of rasters with nulls in a text
> editor?
>
> Is there a technical reason (in the vrt format) that gdalbuildvrt
> can't mix 3-band (no nulls) and 4-band (nulls) rasters?

No, not really. You could create a VRT with 4 bands, and only add 3 bands as 
source when the dataset has only 3 bands. But I think that the 4th band will 
be filled with 0 (transparent) whereas you would generally expect 255 (full 
opacity), so there won't be any real interest in making gdalbuildvrt more 
clever in the current state of VRT capabilities. We would probably need 
something like a ConstantSource for that use case.

> Or is it just 
> rejecting the mismatches for simplicity?

That was the main reason actually. But you could file an enhancement ticket to 
track that need.

>
> -----
> William Kyngesburye <kyngchaos*at*kyngchaos*dot*com>
> http://www.kyngchaos.com/
>
> "Time is an illusion - lunchtime doubly so."
>
> - Ford Prefect


From even.rouault at mines-paris.org  Tue Jul 14 15:18:22 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue Jul 14 15:18:32 2009
Subject: [gdal-dev] Converting raster pixel space to geospace
In-Reply-To: <45D1B79D2DCCF34E966D24728765DDB3DF5A9B@nhc2ex11.goodrich.root.local>
References: <45D1B79D2DCCF34E966D24728765DDB3DF5A9B@nhc2ex11.goodrich.root.local>
Message-ID: <200907142118.23370.even.rouault@mines-paris.org>

Le Tuesday 14 July 2009 20:58:01 Smart, Gary, vous avez ?crit?:
> OK - having messed with GDAL for a couple of days now, I can display
> imagery using the GDAL c++ classes to extract raster tiles.
>
>
>
> However, I now need to be able to convert xPixel/Line couplets to
> geo-positions (UTM, LL or whatever).  I have scanned the classes and
> have failed to come across a method that maps from pixel space to
> geo-space (and the inverse for that matter).  I presume such methods
> exists - can anyone point me to them?

GDALApplyGeoTransform() will convert from pixels to georeferenced positions 
and GDALInvGeoTransform() will invert the geotransform matrix, so using 
GDALApplyGeoTransform() on that inverted matrix will do the reverse 
conversion (georeferenced positions --> pixel positions)

See http://gdal.org/gdal_8h.html for all info.

>
>
>
> Gary


From botany at strato.net  Tue Jul 14 15:38:46 2009
From: botany at strato.net (Kris R. DeLaney)
Date: Tue Jul 14 15:38:54 2009
Subject: [gdal-dev] SQL "LEFT JOIN"
References: <001801ca034c$6c49bc90$6400a8c0@ORCHID>
	<8DED5250-6FDC-11DE-B3E9-0003936901F0@light42.com>
	<002601ca041b$494d20e0$6400a8c0@ORCHID>
	<b0d146420907131853g5bc6bd9dweca7e037fc9495b4@mail.gmail.com>
	<05548AC3-7043-11DE-B3E9-0003936901F0@light42.com>
Message-ID: <000501ca04ba$b448f9b0$6400a8c0@ORCHID>

O.K.:

The following syntax for a ogr2ogr dbf LEFT JOIN works:


ogr2ogr -sql "SELECT AREASYMBOL, MUKEY, DRCLASSDCD FROM soils LEFT JOIN 
'master.dbf'.master ON soils.MUKEY = master.MUKEY" outshpdir soils.shp


Thanks to all for your help in figuring this out.

Kris R. DeLaney





----- Original Message ----- 
From: "Brian Hamlin" <maplabs@light42.com>
To: "Emilio Mayorga" <emiliomayorga@gmail.com>
Cc: "Kris R. DeLaney" <botany@strato.net>; <gdal-dev@lists.osgeo.org>
Sent: Tuesday, July 14, 2009 2:53 AM
Subject: Re: [gdal-dev] SQL "LEFT JOIN"


ok, well n that case, given your test data, an expression that works is

ogr2ogr -sql "SELECT soils.*, DRCLASSDCD FROM soils soils LEFT JOIN
'master.dbf'.master master  ON soils.MUKEY = master.MUKEY" -f geoJSON
out.json soils.shp

   substitute a Shp file directory, etc to suit your purposes

    -Brian


On Jul 13, 2009, at 6:53 PM, Emilio Mayorga wrote:

> Kris,
>
> This statement worked for me a few months back:
>
> ogr2ogr -sql "SELECT
> basinid,basinname,area,basinorder,mouth_lon,mouth_lat FROM stn30test
> srcgeom LEFT JOIN 'dbffilelongname.dbf'.dbffilelongname jointbl ON
> srcgeom.basinid = jointbl.basinid" -f "ESRI Shapefile"
> stn30test_join.shp stn30test.shp
>
> I can't find the exact GDAL version, but I'm pretty sure it's 1.5.x;
> it's from FWTools2.2.8 (on Windows). stn30test.shp is the source shape
> file, dbffilelongname.dbf the joined dbf, and stn30test_join.shp the
> output. I didn't qualify the select fields with a table alias b/c
> they're all coming from the dbf file, so I don't know if that would
> have an impact. All files are in the same folder.
>
> Hope that helps.
>
> -Emilio Mayorga
>
>
>
> On Mon, Jul 13, 2009 at 5:37 PM, Kris R. DeLaney<botany@strato.net> wrote:
>> et al:
>>
>> Actually, the SQL page at the OGR2OGR site shows syntax for DBF joins:
>>
>> http://www.gdal.org/ogr/ogr_sql.html (scroll down the page a ways for
>> actual examples)
>>
>> Unfortunately, I could not get any of these examples to work either. 
>> Maybe
>> someone else can ???
>>
>> I am trying to avoid going through the extra hoops of Postgre/PostGIS.
>> Tentatively, before I read that OGR2OGR should do the join, I had 
>> composed
>> an application in VBA using the MS Jet driver. It works fine for batch
>> joining and creating renamed DBF's (by first importing them to Access) 
>> but,
>> unfortunately, the Jet driver has an 8.3 filename limitation ... so it
>> creates other problems and additional work.
>>
>> OGR2OGR has proved very powerful for many other tasks. If I can get to 
>> also
>> do DBF joins, I can perform all of necessary shapefile operations in one
>> step.
>>
>> Thanks,
>> Kris R. DeLaney
>>
>>
>>
>> ----- Original Message ----- From: "Brian Hamlin" <maplabs@light42.com>
>> To: "Kris R. DeLaney" <botany@strato.net>
>> Cc: <gdal-dev@lists.osgeo.org>
>> Sent: Monday, July 13, 2009 2:39 PM
>> Subject: Re: [gdal-dev] SQL "LEFT JOIN"
>>
>>
>> On Jul 12, 2009, at 4:56 PM, Kris R. DeLaney wrote:
>>
>>> Re: GDAL 1.6.0, released 2008/11/26
>>>
>>> I have be unable to use OGR2OGR to accomplish an SQL LEFT JOIN of a
>>> shapefile with the attributes of a master dbf table. If my syntax is not
>>> correct, I hope someone can show me where it is wrong.
>>>
>>> The files I am using are all in the same directory. I have tried 
>>> countless
>>> variation of syntax, but the two which seem correct, but don't work, 
>>> are:
>>>
>>> (1) ogr2ogr -sql "SELECT test.*, master.DRCLASSDCD FROM test LEFT JOIN
>>> master.dbf.MUKEY ON test.MUKEY = master.MUKEY" outshpdir test.shp
>>>
>>> (2) ogr2ogr -sql "SELECT test.*, master.DRCLASSDCD FROM test LEFT JOIN
>>> 'x:/JUNK/JOIN/master.dbf'.MUKEY ON test.MUKEY = master.MUKEY" outfiles
>>> test.shp
>>>
>>> Small test files of actual data being tried are at:
>>> http://botanicalexplorer.com/gdal/test_files.zip
>>>
>>> Any assistance would be greatly appreciated.
>>>
>>>
>>
>>
>> without knowing any better, I set up the data and tried
>>
>> ogr2ogr -sql "SELECT test.*, master.DRCLASSDCD FROM test LEFT JOIN
>> master.MUKEY ON test.MUKEY = master.MUKEY" -f geoJSON out.json
>> soils.shp
>>
>> as a simple way of testing.. (geoJSON is an easy human readable format)
>>
>> I suspect that ogr2ogr isnt bringing in the 2nd data file at all.
>> though others would know better
>> I suspect that bringing it into Postgres (or other supperted db) would
>> change that
>>
>> -Brian
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev



From rocky at google.com  Tue Jul 14 21:21:36 2009
From: rocky at google.com (Rocky Rhodes)
Date: Tue Jul 14 21:21:37 2009
Subject: [Gdal-dev] jpeg 2000 component precision
Message-ID: <1247620896041-3260339.post@n2.nabble.com>


I'm dealing with jpeg2000 images that have 12 bit components and have been
going through the jp2kak Kakadu driver.  Earlier versions of this code
truncated my 12 bit values to 8 bits, but the latest code returns all 12
bits to me, but I get my 12 bits in the lower 12 bits of the 16 bit data
value.  For this to be interpreted sensibly as an image, these 12 bits
should either be shifted into the top 12 bits of the 16 bit data value or
there should be a way to query the raster band and get its precision,
independent of the type of the data value.  I looked briefly at the Jasper
implementation and I think it would also return the 12 bits in the low 12
bits of a 16 bit data value.

I have modified a version of the kakadu driver code to shift the bits
appropriately, but am not sure what the "correct" solution to this problem
really should be.  Any thoughts from folks with more gdal experience?
-- 
View this message in context: http://n2.nabble.com/jpeg-2000-component-precision-tp3260339p3260339.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From jorn at spacetec.no  Wed Jul 15 07:12:38 2009
From: jorn at spacetec.no (=?iso-8859-1?q?J=F8rn_Vegard_R=F8snes?=)
Date: Wed Jul 15 07:19:26 2009
Subject: [gdal-dev] Failed to process SRS definition
Message-ID: <200907151312.39193.jorn@spacetec.no>

Hi all,

can you see the problem (this works with proj4)?
It works if I remove "+a=6378273" from proj4-string, but I assume the output 
will be wrong.

./ogr2ogr -s_srs EPSG:4326 -t_srs "+proj=stere +lat_0=90 +lon_0=315 +lat_ts=70 
+units=m +a=6378273 +e=0.081816153" -f "ESRI Shapefile" gshhs_land_stere 
~/download/gshhs_1.3_shapefiles/gshhs_land/


All binaries (proj4, ogr2ogr) from FWTools 2.0.6

cheers
J?rn Vegard
From warmerdam at pobox.com  Wed Jul 15 12:12:04 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Jul 15 12:11:30 2009
Subject: [Gdal-dev] building GDAL under cygwin with ODBC
In-Reply-To: <1247586636964-3257609.post@n2.nabble.com>
References: <1247092272012-3228405.post@n2.nabble.com>
	<1247586636964-3257609.post@n2.nabble.com>
Message-ID: <4A5DFFD4.5080503@pobox.com>

Neil Best wrote:
> 
> 
> Neil Best wrote:
>> Does anyone know if it's possible?
>>
>> I said:  ./configure --with-odbc=/usr/include/w32api
>>
> 
> It doesn't seem possible, so I am resigned to making it work in the FWTools
> DOS shell.  Is it possible to make a DSN-less ODBC connection?  In other
> words, can I specify my data source on the fly without having to go through
> the ODBC Administrator and setting up every single Access file as a DSN? 
> Something along the lines of:
> 
> ODBC:"Driver={Microsoft Access Driver (*.mdb)};Dbq=c:\somepath\mydb.mdb;" 
> 
> (Lifted from
> http://www.carlprothman.net/Default.aspx?tabid=90#ODBCDriverForAccess )
> 
> Otherwise I'll have to write something in Perl using Win32::ODBC to loop
> through all of my Access files and set up a DSN for each one.

Neil,

To my surprise, this syntax does work now though it is very fragile.
For instance, I did the following successfully:

   ogrinfo "ODBC:DRIVER=Microsoft Access Driver (*.mdb);DBQ=FWTest.mdb"

The danger is that the datasource name parser is looking for commas,
and colons for the general syntax:

userid/password@dsn,tablename(geometrycolname),...:srs_tablename(sridcolumn,srtextcolumn)

So it would be easy to end up with things getting confused and things
split up wrong if the "dsn" component is not a simple token.  I'm going
to see if I can make it more bulletproof.

But you should be able to get going already.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From cjanssen at iavo-rs.com  Wed Jul 15 15:09:17 2009
From: cjanssen at iavo-rs.com (Christiaan Janssen)
Date: Wed Jul 15 15:09:21 2009
Subject: [gdal-dev] 64-bit int data type support
Message-ID: <30FBCC84-0171-435A-ABF6-BF5AB6B76657@iavo-rs.com>

I'm just checking, but am I correct in my understanding that GDAL currently has no support for 64-bit integer data types (long long). And if not is there any plan to implement support. Just curious, thanks.
Christiaan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090715/bdca6270/attachment.html
From warmerdam at pobox.com  Wed Jul 15 15:21:04 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Jul 15 15:20:27 2009
Subject: [gdal-dev] 64-bit int data type support
In-Reply-To: <30FBCC84-0171-435A-ABF6-BF5AB6B76657@iavo-rs.com>
References: <30FBCC84-0171-435A-ABF6-BF5AB6B76657@iavo-rs.com>
Message-ID: <4A5E2C20.5090805@pobox.com>

Christiaan Janssen wrote:
> I'm just checking, but am I correct in my understanding that GDAL 
> currently has no support for 64-bit integer data types (long long). And 
> if not is there any plan to implement support. Just curious, thanks.

Christiaan,

GDAL has no support for 64bit integer pixel types, nor for 64bit integer
attributes fields in OGR on features.  However, internally it does have
a 64bit integer type (GIntBig) used for file offsets and such.

I assume you were interested in it as a pixel data type, is that right?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From Gary.Smart at goodrich.com  Wed Jul 15 15:24:32 2009
From: Gary.Smart at goodrich.com (Smart, Gary)
Date: Wed Jul 15 15:24:39 2009
Subject: [gdal-dev] MapServer interface
Message-ID: <45D1B79D2DCCF34E966D24728765DDB3DF5BD5@nhc2ex11.goodrich.root.local>

Still a newbee to this so forgive any daft questions.

 

In an answer to a previous question of mine, it was hinted (thank you
Even)  that I could possibly MapServer to return tiles of rasterised
maps for display using my display application.  From my initial studies,
MapServer seems to be aimed at HTML based applications.  However, I want
it to return tiles of imagery which I can render using my C++
application. 

 

Am I right in thinking that this must be done via XML, scripts and files
(e.g. I request a tile from the server (not sure how) and it returns a
rasterised map file which I could open via GDAL).

 

Really, I was hoping for a more direct API whereby I can generate a
server request directly from my C++ code and get the raster tile back
similar to the GDALDataSet::RasterIO call?

 

Any clues?

 

Gary

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090715/ba28a040/attachment.html
From even.rouault at mines-paris.org  Wed Jul 15 16:13:30 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Jul 15 16:13:41 2009
Subject: [gdal-dev] Converting raster pixel space to geospace
In-Reply-To: <45D1B79D2DCCF34E966D24728765DDB3DF5BD3@nhc2ex11.goodrich.root.local>
References: <45D1B79D2DCCF34E966D24728765DDB3DF5A9B@nhc2ex11.goodrich.root.local>
	<200907142118.23370.even.rouault@mines-paris.org>
	<45D1B79D2DCCF34E966D24728765DDB3DF5BD3@nhc2ex11.goodrich.root.local>
Message-ID: <200907152213.31330.even.rouault@mines-paris.org>

Le Wednesday 15 July 2009 20:50:15 Smart, Gary, vous avez ?crit?:
> Thanks for that! :-)
>
> ... without appearing too cheeky,
> Could you point me to a page which would help me translate the x/y returned
> from the transformation (presumably easting/northing in metres?), into
> WGS84 Lat/Long?

The x,y returned by the translation depend of the coordinate system of the 
raster (returned by GDALGetProjectionRef()). For a geographic coordinate 
system, generally you get x = longitude, y = latitude. For a UTM projection, 
x = easting, y = northing. For other projections, it depends on the units of 
the projection system.

For conversion between coordinate systems, you're interested in OSR then. See 
http://gdal.org/ogr/osr_tutorial.html and 
http://gdal.org/ogr/ogr__srs__api_8h.html

From cchung at draper.com  Wed Jul 15 18:21:05 2009
From: cchung at draper.com (Charles Chung)
Date: Wed Jul 15 18:21:07 2009
Subject: [Gdal-dev] gdaladdo for large RPF
Message-ID: <1247696465620-3266107.post@n2.nabble.com>


When I try to build an overview of a.toc file that is associated with 10 GB
(38K files) NITF files, I get the following error message.

c:\>gdaladdo --config COMPRESS_OVERVIEW DEFLATE
NITF_TOC_ENTRY:CIB__1M_1_0:C:\aOI\rpf\a.toc 2 4 8 16
ERROR 1: TIFFFetchStripThing:Sanity check on size of "TileOffsets" value
failed
ERROR 1: TIFFFetchStripThing:Sanity check on size of "TileOffsets" value
failed
Overview building failed.

Is it possible to build an overview for this big file?
FYI, I will use the overview file with MapServer to increase the
performance.

Thanks in advance.

Charles Chung


c:\>gdalinfo c:\aoi\rpf\a.toc
Driver: NITF/National Imagery Transmission Format
Files: ???????.???
Size is 366028, 466944
Coordinate System is:
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563,
            AUTHORITY["EPSG","7030"]],
        TOWGS84[0,0,0,0,0,0,0],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0,
        AUTHORITY["EPSG","8901"]],
    UNIT["degree",0.0174532925199433,
        AUTHORITY["EPSG","9108"]],
    AUTHORITY["EPSG","4326"]]
Origin = (?????)
Pixel Size = (0.000011897208122,-0.000008991368286)
Metadata:
   ???????
Subdatasets:
  SUBDATASET_1_NAME=NITF_TOC_ENTRY:CIB__1M_1_0:c:\aoi\rpf\a.toc
  SUBDATASET_1_DESC=CIB::Imagery, 1 meter resolution:1M:1:0
  SUBDATASET_2_NAME=NITF_TOC_ENTRY:CIB__1M_2_1:f:\aoi\rpf\a.toc
  SUBDATASET_2_DESC=CIB::Imagery, 1 meter resolution:1M:2:1
Corner Coordinates:
  ????



c:\>gdalinfo NITF_TOC_ENTRY:CIB__1M_1_0:c:\aoi\rpf\a.toc
  FILENAME=?????
  NITF_SCALE=1M
  NITF_SERIES_ABBREVIATION=
  NITF_SERIES_NAME=Imagery, 1 meter resolution
Corner Coordinates:
  ????
Band 1 Block=128x128 Type=Byte, ColorInterp=Palette
  NoData Value=216
  Overviews: 208128x157440, 104064x78720, 52032x39360, 26016x19680
  Color Table (RGB with 217 entries)

-- 
View this message in context: http://n2.nabble.com/gdaladdo-for-large-RPF-tp3266107p3266107.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From nhatkyoto at gmail.com  Wed Jul 15 21:03:30 2009
From: nhatkyoto at gmail.com (Le minh NHAT)
Date: Wed Jul 15 21:03:37 2009
Subject: [gdal-dev] (no subject)
Message-ID: <000301ca05b1$3dcc9b50$b965d1f0$@com>

Thank you

 

Le MINH NHAT  Dr. Eng. 
Disaster Management Center (DMC) 
Central Committe for Flood and Storm Control (CCFSC) 
Ministry of Agriculture and Rural Development (MARD) 
A4 No. 2 Ngoc Ha Str., Hanoi, Vietnam
Tel.: (84-4) 3 733 5686 / 3733 5805
Fax.: (84-4) 3733 6647 / 3733 5701          
Cel.: 0123 6073 898 
Email: minhnhat@ccfsc.org.vn / nhatkyoto@gmail.com

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090716/f452ba8c/attachment.html
From mrxonx at hotmail.com  Thu Jul 16 00:15:51 2009
From: mrxonx at hotmail.com (ogr user)
Date: Thu Jul 16 00:22:24 2009
Subject: [gdal-dev] Computing transformation matrix from set of points
Message-ID: <4A5EA977.9050404@hotmail.com>

Sorry to butt in with a question that must have been answered a few
times before.

I am looking for a solver (ready made or an algorithm to implement) to
derive an affine transformation matrix for a given coordinate
transformation based on a set of points with coordinates in each system.

Any help or ideas would be very much appreciated!
--Mike
From warmerdam at pobox.com  Thu Jul 16 00:46:40 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Jul 16 00:45:52 2009
Subject: [gdal-dev] Computing transformation matrix from set of points
In-Reply-To: <4A5EA977.9050404@hotmail.com>
References: <4A5EA977.9050404@hotmail.com>
Message-ID: <4A5EB0B0.7010707@pobox.com>

ogr user wrote:
> Sorry to butt in with a question that must have been answered a few
> times before.
> 
> I am looking for a solver (ready made or an algorithm to implement) to
> derive an affine transformation matrix for a given coordinate
> transformation based on a set of points with coordinates in each system.

Mike,

I think you are looking for:

  int CPL_DLL CPL_STDCALL
  GDALGCPsToGeoTransform( int nGCPCount, const GDAL_GCP *pasGCPs,
                          double *padfGeoTransform, int bApproxOK );


  http://www.gdal.org/gdal_8h.html#e6bc0eeea40d1645fbd44d7431c8db07

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From jorn at spacetec.no  Thu Jul 16 04:14:27 2009
From: jorn at spacetec.no (=?iso-8859-1?q?J=F8rn_Vegard_R=F8snes?=)
Date: Thu Jul 16 04:14:34 2009
Subject: [gdal-dev] Failed to process SRS definition
In-Reply-To: <200907151312.39193.jorn@spacetec.no>
References: <200907151312.39193.jorn@spacetec.no>
Message-ID: <200907161014.28416.jorn@spacetec.no>

Hi again,

On Wednesday 15 July 2009 13:12:38 J?rn Vegard R?snes wrote:
> Hi all,
>
> can you see the problem (this works with proj4)?
> It works if I remove "+a=6378273" from proj4-string, but I assume the
> output will be wrong.
>
> ./ogr2ogr -s_srs EPSG:4326 -t_srs "+proj=stere +lat_0=90 +lon_0=315
> +lat_ts=70 +units=m +a=6378273 +e=0.081816153" -f "ESRI Shapefile"
> gshhs_land_stere ~/download/gshhs_1.3_shapefiles/gshhs_land/
>
I have downloaded v1.6.1, added some debug and compiled (--enable-debug).

It seems that

ogr/ogr_srs_proj4.cpp OGRSpatialReference::importFromProj4, line 847 - 945

does not read the +e proj4 parameter (neither +f and +es), ref. page 9 in 
proj4 doc (ftp://ftp.remotesensing.org/proj/OF90-284.pdf).

+b and +rf is read by the code, so maybe there is a math. workaround?

cheers
J?rn Vegard

>
> All binaries (proj4, ogr2ogr) from FWTools 2.0.6
>
> cheers
> J?rn Vegard
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From Gary.Smart at Goodrich.com  Thu Jul 16 04:41:02 2009
From: Gary.Smart at Goodrich.com (Smart, Gary)
Date: Thu Jul 16 04:41:08 2009
Subject: [gdal-dev] Converting raster pixel space to geospace
In-Reply-To: <200907152213.31330.even.rouault@mines-paris.org>
References: <45D1B79D2DCCF34E966D24728765DDB3DF5A9B@nhc2ex11.goodrich.root.local>
	<200907142118.23370.even.rouault@mines-paris.org>
	<45D1B79D2DCCF34E966D24728765DDB3DF5BD3@nhc2ex11.goodrich.root.local>
	<200907152213.31330.even.rouault@mines-paris.org>
Message-ID: <45D1B79D2DCCF34E966D24728765DDB3DF5BFA@nhc2ex11.goodrich.root.local>


> -----Original Message-----
> From: Even Rouault [mailto:even.rouault@mines-paris.org]
> Sent: 15 July 2009 21:14
> To: Smart, Gary
> Cc: gdal-dev@lists.osgeo.org
> Subject: Re: [gdal-dev] Converting raster pixel space to geospace
> 
> Le Wednesday 15 July 2009 20:50:15 Smart, Gary, vous avez ?crit?:
> > Thanks for that! :-)
> >
> > ... without appearing too cheeky,
> > Could you point me to a page which would help me translate the x/y
> returned
> > from the transformation (presumably easting/northing in metres?), into
> > WGS84 Lat/Long?
> 
> The x,y returned by the translation depend of the coordinate system of the
> raster (returned by GDALGetProjectionRef()). For a geographic coordinate
> system, generally you get x = longitude, y = latitude. For a UTM
> projection,
> x = easting, y = northing. For other projections, it depends on the units
> of
> the projection system.
> 
> For conversion between coordinate systems, you're interested in OSR then.
> See
> http://gdal.org/ogr/osr_tutorial.html and
> http://gdal.org/ogr/ogr__srs__api_8h.html

Thanks, this is certainly what I'm looking for Even.

But how do I load a OGRSpatialRef object with the output from the GDALApplyGeoTransform?  Presumably I can prime the OGRSpatialReference using the result of GDALDataset::GetProjectionRef?  I'm not yet sure of my terminology but is the GetProjectionRef supposed to satisfy the OGR importFromWkt (the types seem to clash though - char* vs char**)?

I suspect my output projection could then be set up with SetWellKnownGeogCS("WGS84") in order to convert from whatever input projection prevails, to a standard WGS84 lat/long representation (using        OGRCreateCoordinateTransformation::Transform)?

From jorge.arevalo at gmail.com  Thu Jul 16 06:12:09 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Thu Jul 16 06:12:33 2009
Subject: [gdal-dev] Use of CPLAssert macro
Message-ID: <cb4457700907160312u1048f82dlc364cfdcd5364e18@mail.gmail.com>

Hello,

Please, correct me if I'm wrong:

The CPLAssert macro should be used only to report errors that force
application to abort, like when we can't read a raster band, for
example. For errors that only has sense in the context of the code
that we're developing, we may perform a "common" error checking and,
if fails, call CPLError with the severity needed (CE_Failure...).

I mean, if in my code (GDAL WKT Raster driver), I only want to read
raster with regular_blocking arrangement, for example, this isn't an
"error", but I want to force a fail, and abort. Then, I check the
arrangement, and call CPLError if fails.

Am I right? Is this the point to difference between calling CPLAssert
and check the error by myself and call CPLError?

Thanks in advance

Best regards,
Jorge
From Gary.Smart at goodrich.com  Thu Jul 16 10:34:46 2009
From: Gary.Smart at goodrich.com (Smart, Gary)
Date: Thu Jul 16 11:03:10 2009
Subject: [gdal-dev] MapServer interface
In-Reply-To: <BAY120-DS51A35417E469D5D8639A6F9200@phx.gbl>
References: <45D1B79D2DCCF34E966D24728765DDB3DF5BD5@nhc2ex11.goodrich.root.local>
	<BAY120-DS51A35417E469D5D8639A6F9200@phx.gbl>
Message-ID: <45D1B79D2DCCF34E966D24728765DDB3DF5C66@nhc2ex11.goodrich.root.local>

Thanks Craig, 

 

But perhaps you can give me a clue as to how to set up a WMS and
interface with it (or where some documentation may exist online)?

I got the impression the WMS was only driven from XML files?  I'm afraid
I still haven't got my head around what is a WMS and what is MapServer!

 

________________________________

From: Craig Miller [mailto:craig.miller@spatialminds.com] 
Sent: 15 July 2009 21:20
To: Smart, Gary
Subject: RE: [gdal-dev] MapServer interface

 

Would it work for you to setup MapServer as a WMS, then use the GDAL WMS
driver?

 

From: gdal-dev-bounces@lists.osgeo.org
[mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Smart, Gary
Sent: Wednesday, July 15, 2009 12:25 PM
To: gdal-dev@lists.osgeo.org
Subject: [gdal-dev] MapServer interface

 

Still a newbee to this so forgive any daft questions.

 

In an answer to a previous question of mine, it was hinted (thank you
Even)  that I could possibly MapServer to return tiles of rasterised
maps for display using my display application.  From my initial studies,
MapServer seems to be aimed at HTML based applications.  However, I want
it to return tiles of imagery which I can render using my C++
application. 

 

Am I right in thinking that this must be done via XML, scripts and files
(e.g. I request a tile from the server (not sure how) and it returns a
rasterised map file which I could open via GDAL).

 

Really, I was hoping for a more direct API whereby I can generate a
server request directly from my C++ code and get the raster tile back
similar to the GDALDataSet::RasterIO call?

 

Any clues?

 

Gary

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090716/700c3fe2/attachment.html
From jdt113 at msstate.edu  Thu Jul 16 12:08:33 2009
From: jdt113 at msstate.edu (jteasis)
Date: Thu Jul 16 12:08:35 2009
Subject: [Gdal-dev] GDAL and ECW
Message-ID: <1247760513945-3268583.post@n2.nabble.com>


I am working towards getting a program using ECW and other formats. I have
gotten my GDAL 1.5.4 to install with the rest but ECW is giving me problems.
I was wondering if there was somebody who could help me figure out how to
compile GDAL with ECW correctly. I would greatly appreciate it. Thank you.
-- 
View this message in context: http://n2.nabble.com/GDAL-and-ECW-tp3268583p3268583.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From chaitanya.ch at gmail.com  Thu Jul 16 12:30:45 2009
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Thu Jul 16 12:30:47 2009
Subject: [gdal-dev] MapServer interface
In-Reply-To: <45D1B79D2DCCF34E966D24728765DDB3DF5C66@nhc2ex11.goodrich.root.local>
References: <45D1B79D2DCCF34E966D24728765DDB3DF5BD5@nhc2ex11.goodrich.root.local>
	<BAY120-DS51A35417E469D5D8639A6F9200@phx.gbl>
	<45D1B79D2DCCF34E966D24728765DDB3DF5C66@nhc2ex11.goodrich.root.local>
Message-ID: <eb502d880907160930u73e429b3u2aa4731936e70387@mail.gmail.com>

Gary,

I think it would be better if you give the requirements for your
application, the general way you would like to develop it and the
technologies you are comfortable with.

Best regards,
-- 
Chaitanya kumar CH.


On Thu, Jul 16, 2009 at 8:04 PM, Smart, Gary <Gary.Smart@goodrich.com>wrote:

>  Thanks Craig,
>
>
>
> But perhaps you can give me a clue as to how to set up a WMS and interface
> with it (or where some documentation may exist online)?
>
> I got the impression the WMS was only driven from XML files?  I?m afraid I
> still haven?t got my head around what is a WMS and what is MapServer!
>
>
>   ------------------------------
>
> *From:* Craig Miller [mailto:craig.miller@spatialminds.com]
> *Sent:* 15 July 2009 21:20
> *To:* Smart, Gary
> *Subject:* RE: [gdal-dev] MapServer interface
>
>
>
> Would it work for you to setup MapServer as a WMS, then use the GDAL WMS
> driver?
>
>
>
> *From:* gdal-dev-bounces@lists.osgeo.org [mailto:
> gdal-dev-bounces@lists.osgeo.org] *On Behalf Of *Smart, Gary
> *Sent:* Wednesday, July 15, 2009 12:25 PM
> *To:* gdal-dev@lists.osgeo.org
> *Subject:* [gdal-dev] MapServer interface
>
>
>
> Still a newbee to this so forgive any daft questions.
>
>
>
> In an answer to a previous question of mine, it was hinted (thank you Even)
>  that I could possibly MapServer to return tiles of rasterised maps for
> display using my display application.  From my initial studies, MapServer
> seems to be aimed at HTML based applications.  However, I want it to return
> tiles of imagery which I can render using my C++ application.
>
>
>
> Am I right in thinking that this must be done via XML, scripts and files
> (e.g. I request a tile from the server (not sure how) and it returns a
> rasterised map file which I could open via GDAL).
>
>
>
> Really, I was hoping for a more direct API whereby I can generate a server
> request directly from my C++ code and get the raster tile back similar to
> the GDALDataSet::RasterIO call?
>
>
>
> Any clues?
>
>
>
> *Gary***
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090716/6f0a7973/attachment.html
From even.rouault at mines-paris.org  Thu Jul 16 14:28:50 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu Jul 16 14:29:01 2009
Subject: [gdal-dev] Use of CPLAssert macro
In-Reply-To: <cb4457700907160312u1048f82dlc364cfdcd5364e18@mail.gmail.com>
References: <cb4457700907160312u1048f82dlc364cfdcd5364e18@mail.gmail.com>
Message-ID: <200907162028.51030.even.rouault@mines-paris.org>

Jorge,

CPLAssert should be rarely used. You should generally use CPLError instead. 
I've regularly removed remaining CPLAssert from GDAL code base to replace 
them with CPLError when it was appropriate.

As you noted, CPLAssert causes an abort to the process, which is generally a 
bad thing from users point of view. Furthermore, CPLAssert expands to nothing 
for non-DEBUG builds of GDAL, which means that you can't rely on it to detect 
error situations for production builds of GDAL. It's really a debug-only 
thing for developers to detect early logic errors, "impossible" conditions.

In all other situations (bad user input, unexpected/corrupted input data, 
etc..), an appropriate error message should be issued with CPLError() and you 
should properly return (!= abort) from the function. For example, if it 
occurs in the ::Open() method of a dataset, you should delete any still 
allocated memory and return NULL.

In your example, if you only support regular_blocking arrangement, you should 
use CPLError() and not CPLAssert(). It's not a logic error, but rather 
unexpected/unsupported form of data. The CPLE_NotSupported error code would 
be the most appropriate.

Best regards,

Even

Le Thursday 16 July 2009 12:12:09 Jorge Ar?valo, vous avez ?crit?:
> Hello,
>
> Please, correct me if I'm wrong:
>
> The CPLAssert macro should be used only to report errors that force
> application to abort, like when we can't read a raster band, for
> example. For errors that only has sense in the context of the code
> that we're developing, we may perform a "common" error checking and,
> if fails, call CPLError with the severity needed (CE_Failure...).
>
> I mean, if in my code (GDAL WKT Raster driver), I only want to read
> raster with regular_blocking arrangement, for example, this isn't an
> "error", but I want to force a fail, and abort. Then, I check the
> arrangement, and call CPLError if fails.
>
> Am I right? Is this the point to difference between calling CPLAssert
> and check the error by myself and call CPLError?
>
> Thanks in advance
>
> Best regards,
> Jorge
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From even.rouault at mines-paris.org  Thu Jul 16 14:31:44 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu Jul 16 14:31:53 2009
Subject: [Gdal-dev] GDAL and ECW
In-Reply-To: <1247760513945-3268583.post@n2.nabble.com>
References: <1247760513945-3268583.post@n2.nabble.com>
Message-ID: <200907162031.44821.even.rouault@mines-paris.org>

Le Thursday 16 July 2009 18:08:33 jteasis, vous avez ?crit?:
> I am working towards getting a program using ECW and other formats. I have
> gotten my GDAL 1.5.4 to install with the rest but ECW is giving me
> problems. I was wondering if there was somebody who could help me figure
> out how to compile GDAL with ECW correctly. I would greatly appreciate it.
> Thank you.

See http://trac.osgeo.org/gdal/wiki/BuildHints, section 'External Library 
Issues'.
You could also fetch precompiled binaries with ECW support. See 
http://trac.osgeo.org/gdal/wiki/DownloadingGdalBinaries (not all of them have 
ECW support, but some yes)
And note that the latest stable version is GDAL 1.6.1.
From even.rouault at mines-paris.org  Thu Jul 16 14:43:39 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu Jul 16 14:43:48 2009
Subject: [gdal-dev] Converting raster pixel space to geospace
In-Reply-To: <45D1B79D2DCCF34E966D24728765DDB3DF5BFA@nhc2ex11.goodrich.root.local>
References: <45D1B79D2DCCF34E966D24728765DDB3DF5A9B@nhc2ex11.goodrich.root.local>
	<200907152213.31330.even.rouault@mines-paris.org>
	<45D1B79D2DCCF34E966D24728765DDB3DF5BFA@nhc2ex11.goodrich.root.local>
Message-ID: <200907162043.39644.even.rouault@mines-paris.org>

Le Thursday 16 July 2009 10:41:02 Smart, Gary, vous avez ?crit?:
>
> But how do I load a OGRSpatialRef object with the output from the
> GDALApplyGeoTransform?  Presumably I can prime the OGRSpatialReference
> using the result of GDALDataset::GetProjectionRef? 

Yes, almost. See below

> I'm not yet sure of my 
> terminology but is the GetProjectionRef supposed to satisfy the OGR
> importFromWkt (the types seem to clash though - char* vs char**)?

Maybe the doc of OGRSpatialReference::importFromWkt() (see
http://gdal.org/ogr/classOGRSpatialReference.html#b74cfc985bd05404a4c61d2d633a6343) 
isn't clear enough ? I must confess that the prototype is a bit weird. You 
don't pass the string itself, but a pointer to a string. The pointer will be 
modified to point to the remaining (unused) input, what you generally don't 
care about. 

Ok, here's a sample snippet :

OGRSpatialReferenceH hSRS = OSRNewSpatialReference(NULL);
const char* pszWkt = GDALGetProjectionRef(hDS);
OSRImportFromWkt(hSRS, (char**) pszWkt);

(For the purists, a more correct prototype of importFromWkt () would have 
relied on 'const char**' to avoid the above cast)

But a simpler approach would be just :

OGRSpatialReferenceH hSRS;
hSRS = OSRNewSpatialReference(pszWKT);

which instanciates the OGRSpatialReferenceH object and call internally 
importFromWkt()

>
> I suspect my output projection could then be set up with
> SetWellKnownGeogCS("WGS84") in order to convert from whatever input
> projection prevails, to a standard WGS84 lat/long representation (using    
>    OGRCreateCoordinateTransformation::Transform)?

Yes. Actually, it will be long/lat in term of the order of the coordinates.


From even.rouault at mines-paris.org  Thu Jul 16 14:59:55 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu Jul 16 15:00:04 2009
Subject: [gdal-dev] Failed to process SRS definition
In-Reply-To: <200907161014.28416.jorn@spacetec.no>
References: <200907151312.39193.jorn@spacetec.no>
	<200907161014.28416.jorn@spacetec.no>
Message-ID: <200907162059.55712.even.rouault@mines-paris.org>

Le Thursday 16 July 2009 10:14:27 J?rn Vegard R?snes, vous avez ?crit?:
> Hi again,
>
> On Wednesday 15 July 2009 13:12:38 J?rn Vegard R?snes wrote:
> > Hi all,
> >
> > can you see the problem (this works with proj4)?
> > It works if I remove "+a=6378273" from proj4-string, but I assume the
> > output will be wrong.
> >
> > ./ogr2ogr -s_srs EPSG:4326 -t_srs "+proj=stere +lat_0=90 +lon_0=315
> > +lat_ts=70 +units=m +a=6378273 +e=0.081816153" -f "ESRI Shapefile"
> > gshhs_land_stere ~/download/gshhs_1.3_shapefiles/gshhs_land/
>
> I have downloaded v1.6.1, added some debug and compiled (--enable-debug).
>
> It seems that
>
> ogr/ogr_srs_proj4.cpp OGRSpatialReference::importFromProj4, line 847 - 945
>
> does not read the +e proj4 parameter (neither +f and +es), ref. page 9 in
> proj4 doc (ftp://ftp.remotesensing.org/proj/OF90-284.pdf).
>
> +b and +rf is read by the code, so maybe there is a math. workaround?

Yes, the a,b,e,f and rf parameters are tied by math relations.

See http://www.arsitech.com/mapping/geodetic_datum. (rf is reverse flattening 
= inverse flattening)

>
> cheers
> J?rn Vegard
>
> > All binaries (proj4, ogr2ogr) from FWTools 2.0.6
> >
> > cheers
> > J?rn Vegard
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From Steve.Toutant at inspq.qc.ca  Thu Jul 16 15:56:52 2009
From: Steve.Toutant at inspq.qc.ca (Steve.Toutant@inspq.qc.ca)
Date: Thu Jul 16 16:11:34 2009
Subject: [gdal-dev] crop an image
Message-ID: <OF1E0D9B22.BAB7687E-ON852575F5.006CFD1D-852575F5.006D93B7@ssss.gouv.qc.ca>

Hello,
I need to crop an image based on a polygon from a shapefile.
Could not figure how to do it so I used gdal_translate and I specified the 
extent of the shapefile like this
gdal_translate -projwin -428734.998712 20337 1.497532 -387578.449250 
172036.180727 EstMtl.img rssMtl.img

But the polygon is irregular. So the new image contains the region I need 
with some extra.  From this new image Is there a way to assign "nodata" to 
pixels outside the irregular polygon?

Or maybe there is a way to crop an image from an irregular polygon?
thanks
Steve


Steve Toutant, M. Sc.
Analyste en g?omatique
Secteur environnement
Direction des risques biologiques, environnementaux et occupationnels
Institut national de sant? publique du Qu?bec
945, avenue Wolfe
Qu?bec, Qc G1V 5B3 
T?l.: (418) 650-5115 #5281
Fax.: (418) 654-3144
steve.toutant@inspq.qc.ca
http://www.inspq.qc.ca
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090716/70664fec/attachment-0001.html
From warmerdam at pobox.com  Thu Jul 16 16:16:36 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Jul 16 16:16:10 2009
Subject: [gdal-dev] Unix VSIL Optimization
Message-ID: <4A5F8AA4.5050609@pobox.com>

Folks,

Some folks have experienced poor performance with some GDAL drivers,
particularly on network disks, due to the high cost of fseek() and
ftell() operations.  I have reworked the VSIL implementation used for
IO on non-win32 operating systems to try and keep track of the current
file offset, and whether file access is already at the end of file
in order to short circuit some fseek() and ftell() operations.

The one serious concern I have about this is that we will never know if
another process and opened and extended a file while we are accessing it.
For most drivers this would cost lots of other problems anyways, but there
could be places VSIL IO is used that it would be quite acceptable.

The change is:
   http://trac.osgeo.org/gdal/changeset/17402

I'd appreciate people letting me know if they believe this change is causing
them problems.

We could potentially do something similar for the win32 implementation but
for now the painpoint happened to be on linux.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Thu Jul 16 16:24:51 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Jul 16 16:24:05 2009
Subject: [gdal-dev] crop an image
In-Reply-To: <OF1E0D9B22.BAB7687E-ON852575F5.006CFD1D-852575F5.006D93B7@ssss.gouv.qc.ca>
References: <OF1E0D9B22.BAB7687E-ON852575F5.006CFD1D-852575F5.006D93B7@ssss.gouv.qc.ca>
Message-ID: <4A5F8C93.6040902@pobox.com>

Steve.Toutant@inspq.qc.ca wrote:
> 
> Hello,
> I need to crop an image based on a polygon from a shapefile.
> Could not figure how to do it so I used gdal_translate and I specified 
> the extent of the shapefile like this
> gdal_translate -projwin -428734.998712 20337 1.497532 -387578.449250 
> 172036.180727 EstMtl.img rssMtl.img
> 
> But the polygon is irregular. So the new image contains the region I 
> need with some extra.  From this new image Is there a way to assign 
> "nodata" to pixels outside the irregular polygon?
> 
> Or maybe there is a way to crop an image from an irregular polygon?
> thanks

Steve,

You can use the gdal_rasterize command to burn a nodata value to all
pixels outside a target polygon.

eg.
   gdal_rasterize -burn 0 -i -l polygon polygon.shp rssMtl.img

Note the -i flag meets to invert - that is assign all pixels outside
the polygon instead of all the pixels inside the polygon.

Docs at:
   http://www.gdal.org/gdal_rasterize.html

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From monshi at home.se  Thu Jul 16 16:38:11 2009
From: monshi at home.se (Tomas R)
Date: Thu Jul 16 16:38:32 2009
Subject: [gdal-dev] Re: C# Nad27 to WGS 84
In-Reply-To: <h3hijq$pnv$1@ger.gmane.org>
References: <h3c5r1$kmo$1@ger.gmane.org> <4A5A0B67.10309@pobox.com>
	<h3hijq$pnv$1@ger.gmane.org>
Message-ID: <h3o33n$g4a$1@ger.gmane.org>

no one?

To bad, well, I will see what I can do on my own.

/Tomas

Tomas R skrev:
> I have no luck
>
> Downloaded compiled package form http://vbkto.dyndns.org:1280/sdk/ 
> (MSVC2008 (Win32) -stable, v 1500).
>
> I set the path as described before, that is:
>
> nadPath = 
> Path.Combine(Path.GetDirectoryName(this.GetType().Assembly.Location), 
> @"Gdalbin\Nad");
> Environment.SetEnvironmentVariable("PROJ_LIB", nadPath);
>
> If I check the environment variable it is set. But proj.dll perhaps do 
> not share the environment variables with the C#-project? Must it 
> perhaps be set globally?
>
> I also try setting a GDAL setting with same arguments:
>
> OSGeo.GDAL.Gdal.SetConfigOption("PROJ_LIB", nadPath);
>
> and also that one checks out OK afterwards, that is, the setting 
> exists in Gdal.
>
> The result of the code is the same with my first version, with an 
> unknown version of proj.dll. That is just de given values back. (no 
> matter what target projection I use). No exception thrown as with the 
> latest version of Proj4 from their website.
>
> And the, the same as before:
>            SpatialReference spatNad27 = new SpatialReference("");
>            spatNad27.SetWellKnownGeogCS("Nad27");
>            SpatialReference spatNad83 = new SpatialReference("");
>            spatNad83.SetWellKnownGeogCS("WGS84");
>            CoordinateTransformation trans = new 
> CoordinateTransformation(spatNad27, spatNad83);
>            double[] p = new double[3];
>            trans.TransformPoint(p, -117, 30, 0);
>            this.textBox1.Text = p[0] + ", " + p[1] + ", " + p[2];
>
>
> and the result in the textbox is
> -117
> 30.0000000008175
> 2.61394307017326E-05
> which is the same result  as I get if I remove the path setting or 
> remove all of Projs data files. Something is amiss.
>
> Gdal-test env. Unsure how to set up. Should not the code above be enough?
> A friend did a test in Python and he could do the transform, but that 
> is no big help for me.
>
> Any ideas what I miss or what I should test?
>
> /Tomas
> Frank Warmerdam skrev:
>> Tomas R wrote:
>>> Hi again,
>>>
>>> New problems arises as the world of Gdal is quite complex to grasp.
>>>
>>> Have understood that the transformation of coordinates from Nad 27 
>>> datum to WGS 84 requires some look up tables to be done correctly, 
>>> tables that differ with the are the Nad 27 is valid in.
>>>
>>> Simple question is, how to set up a general solution in C# that uses 
>>> these shift tables.
>>> I have in code a simple test:
>>>           SpatialReference spatNad27 = new SpatialReference("");
>>>            spatNad27.SetWellKnownGeogCS("Nad27");
>>>            SpatialReference spatNad83 = new SpatialReference("");
>>>            spatNad83.SetWellKnownGeogCS("Nad83");
>>>                      CoordinateTransformation trans = new 
>>> CoordinateTransformation(spatNad27, spatNad83);
>>>            double[] p = new double[3];
>>>            trans.TransformPoint(p, -117, 30, 0);
>>>
>>> that gives back
>>> -117, 30,0000000008175
>>> which I believe is not correct ( see 
>>> http://proj.maptools.org/faq.html )
>>>
>>> I have Proj4.dll, I have set an environment path to PROJ_LIB where 
>>> the nad shift tables should exist. Must I do something else in the 
>>> setup or is the call to the transform different? or have I done 
>>> correctly but misinterpreted the results?
>>>
>>> What I in reality is interested is transforming whatever coordinate 
>>> in whatever projection/datum to and from WGS84 without any extra 
>>> hassle fast and easy via the C# interface. That should not be to 
>>> hard? Or?
>>
>> Tomas,
>>
>> If I test with the testepsg program (using GDAL services) with
>> CPL_DEBUG and PROJ_DEBUG defined ON I get the following output.
>>
>> warmerda@gdal64[264]% setenv PROJ_DEBUG
>> warmerda@gdal64[265]% testepsg -t NAD27 NAD83 -117 30
>> OGRCT: Source: +proj=longlat +ellps=clrk66 +datum=NAD27 +no_defs
>> OGRCT: Target: +proj=longlat +ellps=GRS80 +datum=NAD83 +no_defs
>> pj_open_lib(conus): call 
>> fopen(/wrk/home/warmerda/bld/share/proj/conus) - succeeded
>> Ctable Conterminous United States 273x121: LL=(-131,20) UR=(-63,50)
>> pj_open_lib(alaska): call 
>> fopen(/wrk/home/warmerda/bld/share/proj/alaska) - succeeded
>> Ctable Alaska 529x249: LL=(-194,46) UR=(-128,77)
>> pj_open_lib(ntv2_0.gsb): call 
>> fopen(/wrk/home/warmerda/bld/share/proj/ntv2_0.gsb) - failed
>> pj_open_lib(ntv1_can.dat): call 
>> fopen(/wrk/home/warmerda/bld/share/proj/ntv1_can.dat) - succeeded
>> NTv1 393x177: LL=(-142,40) UR=(-44,84)
>> pj_open_lib(conus): call 
>> fopen(/wrk/home/warmerda/bld/share/proj/conus) - succeeded
>> pj_apply_gridshift(): used Conterminous United States
>> (-117.000000,30.000000,0.000000) -> (-117.000806,30.000113,0.000026)
>>
>> I don't know if it is practical for you to enable debugging and see
>> stderr output, but if you can it might help you deduce what is
>> or is not working.
>>
>> It *sounds* like you have done what is necessary, but it is hard
>> for me to know if you have made some mistake, such as preprocessing
>> the grid shift file into binary form.
>>
>> Best regards,

From zhaops at hotmail.com  Thu Jul 16 18:12:19 2009
From: zhaops at hotmail.com (Peisheng Zhao)
Date: Thu Jul 16 18:12:22 2009
Subject: [gdal-dev] GDAL building error with libdap
Message-ID: <BAY121-W4693ACCA9E6C2CC6A7F6B9D0210@phx.gbl>


Hi all,

I am trying to compiling GDAL 1.6.1 with libdap. I find libdap 3.9.2 is not compatible with GDAL because the object relationships are changed in libdap 3.9.2. I have to use libdap 3.8.2 and still get the error.

For libdap: ./configure --prefix=/var/tmp/www/libdap-3.8.2
For GDAL:  ./configure --prefix=/var/tmp/www/gdal-1.6.1 --with-dods-root=/var/tmp/www/libdap-3.8.2 ....

Reported error: /var/tmp/www/gdal-1.6.1/.libs/libgdal.so: undefined reference to `libdap::DAS::DAS(libdap::AttrTable*, unsigned int)'

Who can I help me figure it out? Thanks a lot.

Peisheng

_________________________________________________________________
Windows Live? SkyDrive?: Get 25 GB of free online storage.
http://windowslive.com/online/skydrive?ocid=TXT_TAGLM_WL_SD_25GB_062009
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090716/8310712e/attachment.html
From apachemaven0 at gmail.com  Thu Jul 16 20:51:46 2009
From: apachemaven0 at gmail.com (maven apache)
Date: Thu Jul 16 20:51:49 2009
Subject: [gdal-dev] Fwd: [GRASS-user] The geotiff format problem
In-Reply-To: <b6ae15040907161751y62ffb36dj566fdd8684c6d8ee@mail.gmail.com>
References: <b6ae15040907160610h71a3c666o5d97fabf0bbb2080@mail.gmail.com>
	<86782b610907161333q58106914w66ae2ea979f5e6b1@mail.gmail.com>
	<b6ae15040907161751y62ffb36dj566fdd8684c6d8ee@mail.gmail.com>
Message-ID: <b6ae15040907161751p3422c198xd82026736875b5d2@mail.gmail.com>

---------- Forwarded message ----------
From: maven apache <apachemaven0@gmail.com>
Date: 2009/7/17
Subject: Re: [GRASS-user] The geotiff format problem
To:
Cc: grass-user@lists.osgeo.org




2009/7/17 Markus Neteler <neteler@osgeo.org>

> On Thu, Jul 16, 2009 at 3:10 PM, maven apache<apachemaven0@gmail.com>
> wrote:
> > Hi all:
> > I have exported the roads in the Spanish example DataBase to a geotiff
> and
> > post it through the wcs.
> > Then I want to handle it :
> > 1)download the tiff in my webservice.
> > 2)use the geotools to parser the tiff,however I got the errors:GeoKey
> > directory does not exist.
> > So I wonder the geotiff from the grass is not identified by the geotools?
>
> Did you use r.out.gdal? (which GRASS version)?

Yes, I use the r.out.gdal

>
> If yes, then the GDAL library is responsible since GRASS calls GDAL to
> generate the file. In that case the gdal-dev list may be of better help.

I will call the gdal-user list
Thank you!

>
> If no, please tell us how you exported.
>
> Markus
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090717/d125faba/attachment.html
From jorn at spacetec.no  Fri Jul 17 03:16:47 2009
From: jorn at spacetec.no (=?iso-8859-1?q?J=F8rn_Vegard_R=F8snes?=)
Date: Fri Jul 17 03:16:54 2009
Subject: [gdal-dev] Failed to process SRS definition
In-Reply-To: <200907162059.55712.even.rouault@mines-paris.org>
References: <200907151312.39193.jorn@spacetec.no>
	<200907161014.28416.jorn@spacetec.no>
	<200907162059.55712.even.rouault@mines-paris.org>
Message-ID: <200907170916.48695.jorn@spacetec.no>

On Thursday 16 July 2009 20:59:55 Even Rouault wrote:
> Le Thursday 16 July 2009 10:14:27 J?rn Vegard R?snes, vous avez ?crit?:
> > Hi again,
> >
> > On Wednesday 15 July 2009 13:12:38 J?rn Vegard R?snes wrote:
> > > Hi all,
> > >
> > > can you see the problem (this works with proj4)?
> > > It works if I remove "+a=6378273" from proj4-string, but I assume the
> > > output will be wrong.
> > >
> > > ./ogr2ogr -s_srs EPSG:4326 -t_srs "+proj=stere +lat_0=90 +lon_0=315
> > > +lat_ts=70 +units=m +a=6378273 +e=0.081816153" -f "ESRI Shapefile"
> > > gshhs_land_stere ~/download/gshhs_1.3_shapefiles/gshhs_land/
> >
> > I have downloaded v1.6.1, added some debug and compiled (--enable-debug).
> >
> > It seems that
> >
> > ogr/ogr_srs_proj4.cpp OGRSpatialReference::importFromProj4, line 847 -
> > 945
> >
> > does not read the +e proj4 parameter (neither +f and +es), ref. page 9 in
> > proj4 doc (ftp://ftp.remotesensing.org/proj/OF90-284.pdf).
> >
> > +b and +rf is read by the code, so maybe there is a math. workaround?
>
> Yes, the a,b,e,f and rf parameters are tied by math relations.
>
> See http://www.arsitech.com/mapping/geodetic_datum. (rf is reverse
> flattening = inverse flattening)
>
Yes, I found 
http://en.wikipedia.org/wiki/Angular_eccentricity#Elliptic_parameters
and calculated b, yesterday.

Then I found something I do not know if is a feature or bug.

ogr/ogrct.cpp OCTProj4Normalize 
strips away the b (, f and rf) parameter in the proj4 string. It is the call 
to  pszNewProj4Def = pfn_pj_get_def( psPJSource, 0 ); line 245 
that does this. 
I think this is a call to the proj4 libs and it seems that the proj4 libs 
removes the b parameter from the proj4 string, because proj4 is satisfied 
with the a and e params. OGR seems to require a and b, e is not used by OGR.
I solved this by calling
return CPLStrdup( pszProj4Src );
in the start of the OCTProj4Normalize function.

Note that I haven't downloaded the proj4 source, and I just assume in the text 
above.

cheers
J?rn Vegard



> > cheers
> > J?rn Vegard
> >
> > > All binaries (proj4, ogr2ogr) from FWTools 2.0.6
> > >
> > > cheers
> > > J?rn Vegard
> > > _______________________________________________
> > > gdal-dev mailing list
> > > gdal-dev@lists.osgeo.org
> > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev


From jorge.arevalo at gmail.com  Fri Jul 17 05:09:48 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Fri Jul 17 05:10:10 2009
Subject: [gdal-dev] Use of CPLAssert macro
In-Reply-To: <200907162028.51030.even.rouault@mines-paris.org>
References: <cb4457700907160312u1048f82dlc364cfdcd5364e18@mail.gmail.com> 
	<200907162028.51030.even.rouault@mines-paris.org>
Message-ID: <cb4457700907170209k7b3e6e80ofd7497005548d700@mail.gmail.com>

Hello,

2009/7/16 Even Rouault <even.rouault@mines-paris.org>:
> Jorge,
>
> CPLAssert should be rarely used. You should generally use CPLError instead.
> I've regularly removed remaining CPLAssert from GDAL code base to replace
> them with CPLError when it was appropriate.
>
> As you noted, CPLAssert causes an abort to the process, which is generally a
> bad thing from users point of view. Furthermore, CPLAssert expands to nothing
> for non-DEBUG builds of GDAL, which means that you can't rely on it to detect
> error situations for production builds of GDAL. It's really a debug-only
> thing for developers to detect early logic errors, "impossible" conditions.
>
> In all other situations (bad user input, unexpected/corrupted input data,
> etc..), an appropriate error message should be issued with CPLError() and you
> should properly return (!= abort) from the function. For example, if it
> occurs in the ::Open() method of a dataset, you should delete any still
> allocated memory and return NULL.

Yes, that's what I've done.

>
> In your example, if you only support regular_blocking arrangement, you should
> use CPLError() and not CPLAssert(). It's not a logic error, but rather
> unexpected/unsupported form of data. The CPLE_NotSupported error code would
> be the most appropriate.

Ok, I'm using CPLE_AppDefined, but CPLE_NotSupported is a much better
idea in that case. Many thanks.


Best regards
Jorge




> Le Thursday 16 July 2009 12:12:09 Jorge Ar?valo, vous avez ?crit?:
>> Hello,
>>
>> Please, correct me if I'm wrong:
>>
>> The CPLAssert macro should be used only to report errors that force
>> application to abort, like when we can't read a raster band, for
>> example. For errors that only has sense in the context of the code
>> that we're developing, we may perform a "common" error checking and,
>> if fails, call CPLError with the severity needed (CE_Failure...).
>>
>> I mean, if in my code (GDAL WKT Raster driver), I only want to read
>> raster with regular_blocking arrangement, for example, this isn't an
>> "error", but I want to force a fail, and abort. Then, I check the
>> arrangement, and call CPLError if fails.
>>
>> Am I right? Is this the point to difference between calling CPLAssert
>> and check the error by myself and call CPLError?
>>
>> Thanks in advance
>>
>> Best regards,
>> Jorge
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
From nilesh.gis at gmail.com  Fri Jul 17 05:11:04 2009
From: nilesh.gis at gmail.com (Nilesh Choure)
Date: Fri Jul 17 05:11:06 2009
Subject: [gdal-dev] DGN Data set creation options : Need details
Message-ID: <c907ad1d0907170211s54146b90u8bd0f4d8e82da90b@mail.gmail.com>

Hi ALL,

I am working on exporting features from other file formats into DGN and new
to GIS field. From the ogr documentation I found that there are significant
limitations on DGN writer part.
But can anyone explain me or show link to what is the meaning of each data
set creation option, what is the role of seed file in data set creation, Do
altering data set creation options provide better data set.

-- 
Thanks & regards,
Nilesh Choure
nilesh.gis@gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090717/cc2ae6ae/attachment.html
From srikanth1947 at gmail.com  Fri Jul 17 05:34:13 2009
From: srikanth1947 at gmail.com (Srikanth)
Date: Fri Jul 17 05:34:15 2009
Subject: [gdal-dev] Regarding using OCI
Message-ID: <7a566dfe0907170234p2d420e58m6f3acc72d967446@mail.gmail.com>

Dear All,

I want to connect to Oracle and save/retrieve the vector/raster files using OCI.
I have identified the classes ( ogrocidriver, ogrocistatement,
ogrocitablelayer, etc) in GDAL to achieve this.But I did not find any
documentation or examples to guide.
I would be thankful if anyone can provide me suitable examples or
guide me in locating suitable documenation.

-- 
Regards,
Srikanth K.
From P.Halls at york.ac.uk  Fri Jul 17 05:50:47 2009
From: P.Halls at york.ac.uk (Peter Halls)
Date: Fri Jul 17 06:22:49 2009
Subject: [gdal-dev] Regarding using OCI
In-Reply-To: <7a566dfe0907170234p2d420e58m6f3acc72d967446@mail.gmail.com>
References: <7a566dfe0907170234p2d420e58m6f3acc72d967446@mail.gmail.com>
Message-ID: <Prayer.1.2.3.0907171050470.24595@webmail3.york.ac.uk>

Srikanth,

   with the driver documentation, Frank has provided a simple overview 
example. Otherwise, the OCI driver works just like any other. Look 
carefully at Frank's syntax for the connection string, though.

   I've been using this driver for a couple of years now with very good 
results - indeed, this seems more convenient than using the ArcSDE driver 
interface and is a good test that the SDE environment is properly set up to 
share data through Oracle.

   I'm not in my office at the moment, however when I'm back I could dig 
out some examples of how my code uses the OCI driver, if that would be any 
help to you.

Best wishes,

Peter

On Jul 17 2009, Srikanth wrote:

>Dear All,
>
> I want to connect to Oracle and save/retrieve the vector/raster files 
> using OCI. I have identified the classes ( ogrocidriver, ogrocistatement, 
> ogrocitablelayer, etc) in GDAL to achieve this.But I did not find any 
> documentation or examples to guide. I would be thankful if anyone can 
> provide me suitable examples or guide me in locating suitable 
> documenation.
>
>

-- 
--------------------------------------------------------------------------
Peter Halls, University of York GIS Advisor
Snail Mail: Computing Service, Heslington, York YO10 5DD, England
Telephone: 01904 433806   FAX: 01904 433740

This message has the status of a private & personal communication
--------------------------------------------------------------------------



From monshi at home.se  Fri Jul 17 06:35:07 2009
From: monshi at home.se (Tomas R)
Date: Fri Jul 17 06:35:29 2009
Subject: [gdal-dev] Re: C# Nad27 to WGS 84
In-Reply-To: <4A5A0B67.10309@pobox.com>
References: <h3c5r1$kmo$1@ger.gmane.org> <4A5A0B67.10309@pobox.com>
Message-ID: <h3pk50$5p3$1@ger.gmane.org>

Ok. my bad perhaps.

Grabbed the shift-files from FWTools, and yes, now it works.  It was, 
not to soon, I noticed the line
> such as preprocessing the grid shift file into binary form. 
I realized I had probably missed a step. But how-to do that? No idea. 
Try compiling Proj4, yes that works, but compiling also the nadshift 
files? Nope, do not work. 
Well, one option that always works, I grabbed them from FWTools...

Yours
Tomas

Frank Warmerdam skrev:
> Tomas R wrote:
>> Hi again,
>>
>> New problems arises as the world of Gdal is quite complex to grasp.
>>
>> Have understood that the transformation of coordinates from Nad 27 
>> datum to WGS 84 requires some look up tables to be done correctly, 
>> tables that differ with the are the Nad 27 is valid in.
>>
>> Simple question is, how to set up a general solution in C# that uses 
>> these shift tables.
>> I have in code a simple test:
>>           SpatialReference spatNad27 = new SpatialReference("");
>>            spatNad27.SetWellKnownGeogCS("Nad27");
>>            SpatialReference spatNad83 = new SpatialReference("");
>>            spatNad83.SetWellKnownGeogCS("Nad83");
>>                      CoordinateTransformation trans = new 
>> CoordinateTransformation(spatNad27, spatNad83);
>>            double[] p = new double[3];
>>            trans.TransformPoint(p, -117, 30, 0);
>>
>> that gives back
>> -117, 30,0000000008175
>> which I believe is not correct ( see http://proj.maptools.org/faq.html )
>>
>> I have Proj4.dll, I have set an environment path to PROJ_LIB where 
>> the nad shift tables should exist. Must I do something else in the 
>> setup or is the call to the transform different? or have I done 
>> correctly but misinterpreted the results?
>>
>> What I in reality is interested is transforming whatever coordinate 
>> in whatever projection/datum to and from WGS84 without any extra 
>> hassle fast and easy via the C# interface. That should not be to 
>> hard? Or?
>
> Tomas,
>
> If I test with the testepsg program (using GDAL services) with
> CPL_DEBUG and PROJ_DEBUG defined ON I get the following output.
>
> warmerda@gdal64[264]% setenv PROJ_DEBUG
> warmerda@gdal64[265]% testepsg -t NAD27 NAD83 -117 30
> OGRCT: Source: +proj=longlat +ellps=clrk66 +datum=NAD27 +no_defs
> OGRCT: Target: +proj=longlat +ellps=GRS80 +datum=NAD83 +no_defs
> pj_open_lib(conus): call 
> fopen(/wrk/home/warmerda/bld/share/proj/conus) - succeeded
> Ctable Conterminous United States 273x121: LL=(-131,20) UR=(-63,50)
> pj_open_lib(alaska): call 
> fopen(/wrk/home/warmerda/bld/share/proj/alaska) - succeeded
> Ctable Alaska 529x249: LL=(-194,46) UR=(-128,77)
> pj_open_lib(ntv2_0.gsb): call 
> fopen(/wrk/home/warmerda/bld/share/proj/ntv2_0.gsb) - failed
> pj_open_lib(ntv1_can.dat): call 
> fopen(/wrk/home/warmerda/bld/share/proj/ntv1_can.dat) - succeeded
> NTv1 393x177: LL=(-142,40) UR=(-44,84)
> pj_open_lib(conus): call 
> fopen(/wrk/home/warmerda/bld/share/proj/conus) - succeeded
> pj_apply_gridshift(): used Conterminous United States
> (-117.000000,30.000000,0.000000) -> (-117.000806,30.000113,0.000026)
>
> I don't know if it is practical for you to enable debugging and see
> stderr output, but if you can it might help you deduce what is
> or is not working.
>
> It *sounds* like you have done what is necessary, but it is hard
> for me to know if you have made some mistake, such as preprocessing
> the grid shift file into binary form.
>
> Best regards,

From monshi at home.se  Fri Jul 17 07:02:48 2009
From: monshi at home.se (Tomas R)
Date: Fri Jul 17 07:03:09 2009
Subject: [gdal-dev] Re: C# Nad27 to WGS 84
In-Reply-To: <4A5A0B67.10309@pobox.com>
References: <h3c5r1$kmo$1@ger.gmane.org> <4A5A0B67.10309@pobox.com>
Message-ID: <h3plot$aap$1@ger.gmane.org>

Hi again

Seems like I have solved the problem... the line
> such as preprocessing the grid shift file into binary form. 
gave me (finally) the hint I needed. Tried to compile Proj4 and the 
shift files but managed only compile the first part. Then I finally went 
for the easy solution, I grabbed the binary files from FWTools and 
finally I got it working.

Compiling the shift files on Windows? How? Well, not at big issue at the 
moment.

Yours
Tomas

Frank Warmerdam skrev:
> Tomas R wrote:
>> Hi again,
>>
>> New problems arises as the world of Gdal is quite complex to grasp.
>>
>> Have understood that the transformation of coordinates from Nad 27 
>> datum to WGS 84 requires some look up tables to be done correctly, 
>> tables that differ with the are the Nad 27 is valid in.
>>
>> Simple question is, how to set up a general solution in C# that uses 
>> these shift tables.
>> I have in code a simple test:
>>           SpatialReference spatNad27 = new SpatialReference("");
>>            spatNad27.SetWellKnownGeogCS("Nad27");
>>            SpatialReference spatNad83 = new SpatialReference("");
>>            spatNad83.SetWellKnownGeogCS("Nad83");
>>                      CoordinateTransformation trans = new 
>> CoordinateTransformation(spatNad27, spatNad83);
>>            double[] p = new double[3];
>>            trans.TransformPoint(p, -117, 30, 0);
>>
>> that gives back
>> -117, 30,0000000008175
>> which I believe is not correct ( see http://proj.maptools.org/faq.html )
>>
>> I have Proj4.dll, I have set an environment path to PROJ_LIB where 
>> the nad shift tables should exist. Must I do something else in the 
>> setup or is the call to the transform different? or have I done 
>> correctly but misinterpreted the results?
>>
>> What I in reality is interested is transforming whatever coordinate 
>> in whatever projection/datum to and from WGS84 without any extra 
>> hassle fast and easy via the C# interface. That should not be to 
>> hard? Or?
>
> Tomas,
>
> If I test with the testepsg program (using GDAL services) with
> CPL_DEBUG and PROJ_DEBUG defined ON I get the following output.
>
> warmerda@gdal64[264]% setenv PROJ_DEBUG
> warmerda@gdal64[265]% testepsg -t NAD27 NAD83 -117 30
> OGRCT: Source: +proj=longlat +ellps=clrk66 +datum=NAD27 +no_defs
> OGRCT: Target: +proj=longlat +ellps=GRS80 +datum=NAD83 +no_defs
> pj_open_lib(conus): call 
> fopen(/wrk/home/warmerda/bld/share/proj/conus) - succeeded
> Ctable Conterminous United States 273x121: LL=(-131,20) UR=(-63,50)
> pj_open_lib(alaska): call 
> fopen(/wrk/home/warmerda/bld/share/proj/alaska) - succeeded
> Ctable Alaska 529x249: LL=(-194,46) UR=(-128,77)
> pj_open_lib(ntv2_0.gsb): call 
> fopen(/wrk/home/warmerda/bld/share/proj/ntv2_0.gsb) - failed
> pj_open_lib(ntv1_can.dat): call 
> fopen(/wrk/home/warmerda/bld/share/proj/ntv1_can.dat) - succeeded
> NTv1 393x177: LL=(-142,40) UR=(-44,84)
> pj_open_lib(conus): call 
> fopen(/wrk/home/warmerda/bld/share/proj/conus) - succeeded
> pj_apply_gridshift(): used Conterminous United States
> (-117.000000,30.000000,0.000000) -> (-117.000806,30.000113,0.000026)
>
> I don't know if it is practical for you to enable debugging and see
> stderr output, but if you can it might help you deduce what is
> or is not working.
>
> It *sounds* like you have done what is necessary, but it is hard
> for me to know if you have made some mistake, such as preprocessing
> the grid shift file into binary form.
>
> Best regards,

From srikanth1947 at gmail.com  Fri Jul 17 07:07:01 2009
From: srikanth1947 at gmail.com (Srikanth)
Date: Fri Jul 17 07:07:03 2009
Subject: [gdal-dev] Regarding using OCI
In-Reply-To: <Prayer.1.2.3.0907171050470.24595@webmail3.york.ac.uk>
References: <7a566dfe0907170234p2d420e58m6f3acc72d967446@mail.gmail.com>
	<Prayer.1.2.3.0907171050470.24595@webmail3.york.ac.uk>
Message-ID: <7a566dfe0907170407p70a680a3p9a6ee3dfd85cf444@mail.gmail.com>

Peter ,

To be more specific, I want to store a ESRI shape file into the oracle
database. I would like to know whether gdal provides such a kind of
direct method where in if one passes the shape file name it gets
stored in the database handling the conversion of SDO_GEOM type
internally.

I have gone through the example provided by Mr.Frank ( fastload.cpp
and ocitest.cpp ) but he I do not want handle the oci calls by myself.

Is there any possibilty to meet my requirement.

Regards,
Srikanth

On Fri, Jul 17, 2009 at 3:20 PM, Peter Halls<P.Halls@york.ac.uk> wrote:
> Srikanth,
>
> ?with the driver documentation, Frank has provided a simple overview
> example. Otherwise, the OCI driver works just like any other. Look carefully
> at Frank's syntax for the connection string, though.
>
> ?I've been using this driver for a couple of years now with very good
> results - indeed, this seems more convenient than using the ArcSDE driver
> interface and is a good test that the SDE environment is properly set up to
> share data through Oracle.
>
> ?I'm not in my office at the moment, however when I'm back I could dig out
> some examples of how my code uses the OCI driver, if that would be any help
> to you.
>
> Best wishes,
>
> Peter
>
> On Jul 17 2009, Srikanth wrote:
>
>> Dear All,
>>
>> I want to connect to Oracle and save/retrieve the vector/raster files
>> using OCI. I have identified the classes ( ogrocidriver, ogrocistatement,
>> ogrocitablelayer, etc) in GDAL to achieve this.But I did not find any
>> documentation or examples to guide. I would be thankful if anyone can
>> provide me suitable examples or guide me in locating suitable documenation.
>>
>>
>
> --
> --------------------------------------------------------------------------
> Peter Halls, University of York GIS Advisor
> Snail Mail: Computing Service, Heslington, York YO10 5DD, England
> Telephone: 01904 433806 ? FAX: 01904 433740
>
> This message has the status of a private & personal communication
> --------------------------------------------------------------------------
>
>
>
>



-- 
Regards,
Srikanth K.
www.servetheneedy.org
From chaitanya.ch at gmail.com  Fri Jul 17 07:15:48 2009
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Fri Jul 17 07:23:42 2009
Subject: [gdal-dev] Regarding using OCI
In-Reply-To: <7a566dfe0907170407p70a680a3p9a6ee3dfd85cf444@mail.gmail.com>
References: <7a566dfe0907170234p2d420e58m6f3acc72d967446@mail.gmail.com>
	<Prayer.1.2.3.0907171050470.24595@webmail3.york.ac.uk>
	<7a566dfe0907170407p70a680a3p9a6ee3dfd85cf444@mail.gmail.com>
Message-ID: <eb502d880907170415n720e1ab5x33a3370280b7e0ac@mail.gmail.com>

Srikanth,

The ogr2ogr utility might be of help to you.
Docs: http://gdal.org/ogr2ogr.html
Download: http://trac.osgeo.org/gdal/wiki/DownloadingGdalBinaries

On Fri, Jul 17, 2009 at 4:37 PM, Srikanth <srikanth1947@gmail.com> wrote:

> Peter ,
>
> To be more specific, I want to store a ESRI shape file into the oracle
> database. I would like to know whether gdal provides such a kind of
> direct method where in if one passes the shape file name it gets
> stored in the database handling the conversion of SDO_GEOM type
> internally.
>
> I have gone through the example provided by Mr.Frank ( fastload.cpp
> and ocitest.cpp ) but he I do not want handle the oci calls by myself.
>
> Is there any possibilty to meet my requirement.
>
> Regards,
> Srikanth
>
> On Fri, Jul 17, 2009 at 3:20 PM, Peter Halls<P.Halls@york.ac.uk> wrote:
> > Srikanth,
> >
> >  with the driver documentation, Frank has provided a simple overview
> > example. Otherwise, the OCI driver works just like any other. Look
> carefully
> > at Frank's syntax for the connection string, though.
> >
> >  I've been using this driver for a couple of years now with very good
> > results - indeed, this seems more convenient than using the ArcSDE driver
> > interface and is a good test that the SDE environment is properly set up
> to
> > share data through Oracle.
> >
> >  I'm not in my office at the moment, however when I'm back I could dig
> out
> > some examples of how my code uses the OCI driver, if that would be any
> help
> > to you.
> >
> > Best wishes,
> >
> > Peter
> >
> > On Jul 17 2009, Srikanth wrote:
> >
> >> Dear All,
> >>
> >> I want to connect to Oracle and save/retrieve the vector/raster files
> >> using OCI. I have identified the classes ( ogrocidriver,
> ogrocistatement,
> >> ogrocitablelayer, etc) in GDAL to achieve this.But I did not find any
> >> documentation or examples to guide. I would be thankful if anyone can
> >> provide me suitable examples or guide me in locating suitable
> documenation.
> >>
> >>
> >
> > --
> >
> --------------------------------------------------------------------------
> > Peter Halls, University of York GIS Advisor
> > Snail Mail: Computing Service, Heslington, York YO10 5DD, England
> > Telephone: 01904 433806   FAX: 01904 433740
> >
> > This message has the status of a private & personal communication
> >
> --------------------------------------------------------------------------
> >
> >
> >
> >
>
>
>
> --
> Regards,
> Srikanth K.
> www.servetheneedy.org
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


Best regards,
-- 
Chaitanya kumar CH.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090717/939362fa/attachment-0001.html
From chaitanya.ch at gmail.com  Fri Jul 17 07:46:28 2009
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Fri Jul 17 07:46:31 2009
Subject: [gdal-dev] DGN Data set creation options : Need details
In-Reply-To: <c907ad1d0907170211s54146b90u8bd0f4d8e82da90b@mail.gmail.com>
References: <c907ad1d0907170211s54146b90u8bd0f4d8e82da90b@mail.gmail.com>
Message-ID: <eb502d880907170446x478a73aah6dc739fdd4952c84@mail.gmail.com>

Nilesh,

Refer to the various links from http://www.gdal.org/ogr/
The datasource creation options are specific to each driver and often there
are no options and simply NULL is passed. You use them when the datasource
can be opened in different modes. I see that the current DGN driver supports
some options. You can start your search for your other doubts at
http://dgnlib.maptools.org/

On Fri, Jul 17, 2009 at 2:41 PM, Nilesh Choure <nilesh.gis@gmail.com> wrote:

> Hi ALL,
>
> I am working on exporting features from other file formats into DGN and new
> to GIS field. From the ogr documentation I found that there are significant
> limitations on DGN writer part.
> But can anyone explain me or show link to what is the meaning of each data
> set creation option, what is the role of seed file in data set creation, Do
> altering data set creation options provide better data set.
>
> --
> Thanks & regards,
> Nilesh Choure
> nilesh.gis@gmail.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


Best regards,
-- 
Chaitanya kumar CH.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090717/58cdb1c9/attachment.html
From P.Halls at york.ac.uk  Fri Jul 17 07:19:04 2009
From: P.Halls at york.ac.uk (Peter J Halls)
Date: Fri Jul 17 07:50:25 2009
Subject: [gdal-dev] Regarding using OCI
In-Reply-To: <7a566dfe0907170407p70a680a3p9a6ee3dfd85cf444@mail.gmail.com>
References: <7a566dfe0907170234p2d420e58m6f3acc72d967446@mail.gmail.com>	
	<Prayer.1.2.3.0907171050470.24595@webmail3.york.ac.uk>
	<7a566dfe0907170407p70a680a3p9a6ee3dfd85cf444@mail.gmail.com>
Message-ID: <4A605E28.80004@york.ac.uk>

Srikanth,

Srikanth wrote:
> Peter ,
> 
> To be more specific, I want to store a ESRI shape file into the oracle
> database. I would like to know whether gdal provides such a kind of
> direct method where in if one passes the shape file name it gets
> stored in the database handling the conversion of SDO_GEOM type
> internally.
> 
> I have gone through the example provided by Mr.Frank ( fastload.cpp
> and ocitest.cpp ) but he I do not want handle the oci calls by myself.
> 
> Is there any possibilty to meet my requirement.

All you need is the ogr2ogr utility.  See the example in the driver 
documentation which shows how to specify an OCI output.

Peter

> 
> Regards,
> Srikanth
> 
> On Fri, Jul 17, 2009 at 3:20 PM, Peter Halls<P.Halls@york.ac.uk> wrote:
>> Srikanth,
>>
>>  with the driver documentation, Frank has provided a simple overview
>> example. Otherwise, the OCI driver works just like any other. Look carefully
>> at Frank's syntax for the connection string, though.
>>
>>  I've been using this driver for a couple of years now with very good
>> results - indeed, this seems more convenient than using the ArcSDE driver
>> interface and is a good test that the SDE environment is properly set up to
>> share data through Oracle.
>>
>>  I'm not in my office at the moment, however when I'm back I could dig out
>> some examples of how my code uses the OCI driver, if that would be any help
>> to you.
>>
>> Best wishes,
>>
>> Peter
>>
>> On Jul 17 2009, Srikanth wrote:
>>
>>> Dear All,
>>>
>>> I want to connect to Oracle and save/retrieve the vector/raster files
>>> using OCI. I have identified the classes ( ogrocidriver, ogrocistatement,
>>> ogrocitablelayer, etc) in GDAL to achieve this.But I did not find any
>>> documentation or examples to guide. I would be thankful if anyone can
>>> provide me suitable examples or guide me in locating suitable documenation.
>>>
>>>
>> --
>> --------------------------------------------------------------------------
>> Peter Halls, University of York GIS Advisor
>> Snail Mail: Computing Service, Heslington, York YO10 5DD, England
>> Telephone: 01904 433806   FAX: 01904 433740
>>
>> This message has the status of a private & personal communication
>> --------------------------------------------------------------------------
>>
>>
>>
>>
> 
> 
> 

-- 
--------------------------------------------------------------------------------
Peter J Halls, GIS Advisor, University of York
Telephone: 01904 433806     Fax: 01904 433740
Snail mail: Computing Service, University of York, Heslington, York YO10 5DD
This message has the status of a private and personal communication
--------------------------------------------------------------------------------
From amanda.m.henneke at boeing.com  Fri Jul 17 08:38:59 2009
From: amanda.m.henneke at boeing.com (Henneke, Amanda M)
Date: Fri Jul 17 09:08:33 2009
Subject: [gdal-dev] Creating a new raster and adding data
Message-ID: <A4A1B61586638F4C90EBCAC780B06174090C7FAB@XCH-MW-2V2.mw.nos.boeing.com>

Hello all-

Using the C# gdal libraries, I'm trying to create a new raster dataset with 5 bands and then use the WriteRaster method to add data to each of those 5 bands.

This is what I have so far...

Dataset ds = Gdal.Open("F:\\Mat_Class\\Alaska\\new_tifs\\class_ak_sheet_8a.tif", Access.GA_Update);
Dataset ds_new = drv.Create("F:\\Mat_Class\\Alaska\\new_tifs\\class_ak_sheet_8a_test.tif", ds.RasterXSize, ds.RasterYSize, 5, DataType.GDT_Byte, new string[] { });

byte[] r_buffer = new byte[iWidth * iHeight];
byte[] g_buffer = new byte[iWidth * iHeight];
byte[] b_buffer = new byte[iWidth * iHeight];


<get/set values for r_buffer, g_buffer and b_buffer>

int[] iBandMap = { 1, 2, 3, 4, 5 };
ds_new.WriteRaster(0, 0, iWidth, iHeight, r_buffer, iWidth, iHeight, 1, iBandMap, 0, 0, 0);
ds_new.WriteRaster(0, 0, iWidth, iHeight, g_buffer, iWidth, iHeight, 2, iBandMap, 0, 0, 0);
ds_new.WriteRaster(0, 0, iWidth, iHeight, b_buffer, iWidth, iHeight, 3, iBandMap, 0, 0, 0);


I'm getting an exception that says "AccessViolationException was unhandled.  Attemped to read or write protected memory.  This is often an indication that other memory is corrupt."

Any one have any ideas what I'm doing wrong?

Thanks for any help!

Amanda M. Henneke


 
When One tugs at a single thing in Nature, he finds it attached to the rest of the world. -John Muir
  Please consider the environment before printing this e-mail.

From szekerest at gmail.com  Fri Jul 17 09:18:23 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Fri Jul 17 09:18:25 2009
Subject: [gdal-dev] Re: C# Nad27 to WGS 84
In-Reply-To: <h3plot$aap$1@ger.gmane.org>
References: <h3c5r1$kmo$1@ger.gmane.org> <4A5A0B67.10309@pobox.com>
	<h3plot$aap$1@ger.gmane.org>
Message-ID: <f3b73b7d0907170618r7a1e6ffbn661bb2fbfa8a83ef@mail.gmail.com>

2009/7/17 Tomas R <monshi@home.se>

> Hi again
>
> Seems like I have solved the problem... the line
>
>> such as preprocessing the grid shift file into binary form.
>>
> gave me (finally) the hint I needed. Tried to compile Proj4 and the shift
> files but managed only compile the first part. Then I finally went for the
> easy solution, I grabbed the binary files from FWTools and finally I got it
> working.
>
> Compiling the shift files on Windows? How? Well, not at big issue at the
> moment.
>

Tomas,


That would be something like:

nmake /f makefile.vc nadshift

in the proj source directory.

If you download the SDK http://vbkto.dyndns.org:1280/sdk/Default.aspx

copy the proj sources into the root directory (ie: \proj-4.6.1) of the SDK
and use:

nmake proj PROJ_DIR=proj-4.6.1

in the VS Command prompt, which should compile the nadshift files as well.


Best regards,

Tamas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090717/abf2116e/attachment.html
From Steve.Toutant at inspq.qc.ca  Fri Jul 17 11:26:03 2009
From: Steve.Toutant at inspq.qc.ca (Steve.Toutant@inspq.qc.ca)
Date: Fri Jul 17 11:26:14 2009
Subject: [gdal-dev] clip intersected 
Message-ID: <OFF0F2BD30.4401094A-ON852575F6.0054A79B-852575F6.0054C65C@ssss.gouv.qc.ca>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/gif
Size: 10435 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090717/bba0410a/attachment-0001.gif
From Steve.Toutant at inspq.qc.ca  Fri Jul 17 12:31:02 2009
From: Steve.Toutant at inspq.qc.ca (Steve.Toutant@inspq.qc.ca)
Date: Fri Jul 17 12:31:11 2009
Subject: [gdal-dev] RE clip intersected 
In-Reply-To: <OFF0F2BD30.4401094A-ON852575F6.0054A79B-852575F6.0054C65C@LocalDomain>
Message-ID: <OF5F74F281.87358CAA-ON852575F6.005965E0-852575F6.005AB977@ssss.gouv.qc.ca>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/gif
Size: 10435 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090717/3c93b799/attachment.gif
From warmerdam at pobox.com  Fri Jul 17 13:24:44 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Jul 17 13:23:54 2009
Subject: [gdal-dev] RE clip intersected
In-Reply-To: <OF5F74F281.87358CAA-ON852575F6.005965E0-852575F6.005AB977@ssss.gouv.qc.ca>
References: <OF5F74F281.87358CAA-ON852575F6.005965E0-852575F6.005AB977@ssss.gouv.qc.ca>
Message-ID: <4A60B3DC.6080901@pobox.com>

Steve.Toutant@inspq.qc.ca wrote:
> 
> I might try this..is it the good way to do what I need?
> 
> 1- Use gdal_polygonize.py to create a boundary (excluding pixels with no 
> value) of each image and save the boundary as a .shp
> 2- Somehow find the intersected region of the 2 polygons (boundaries) 
> created above and save the result to .shp
> 3- Use gdal_rasterize on one of the original image  to burn a nodata 
> value based on the polygon representing the intersection area
> 
> I didn't try yet because I don't have gdal_polygonize.py
> My installation is from MS4W and this script is not there. I just 
> install GDAL with OSGEO4w and it seems that this script doesn't exist.
> 
> If the method above is valid,
> - how can I create a boundary excluding pixels with nodata?
> - And, of course, where can I get  gdal_polygonize.py

Steve,

I would be tempted to do this process in raster space.  Perhaps by warping
both images into different bands of a mosaic file to get everything overlaying
and then using some sort of raster modelling (perhaps via numpy in a python
script) to zero out the one image where the other is set.

I think the vector mask approach would be difficult, in part because the mask
produced would be very fine grained.  Depending on your need for precision you
could just hand digitize a vector mask suitable to wipe out the overlapping
area.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Fri Jul 17 13:33:07 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Jul 17 13:32:15 2009
Subject: [gdal-dev] Creating a new raster and adding data
In-Reply-To: <A4A1B61586638F4C90EBCAC780B06174090C7FAB@XCH-MW-2V2.mw.nos.boeing.com>
References: <A4A1B61586638F4C90EBCAC780B06174090C7FAB@XCH-MW-2V2.mw.nos.boeing.com>
Message-ID: <4A60B5D3.3080400@pobox.com>

Henneke, Amanda M wrote:
...
> This is what I have so far...
> 
> Dataset ds = Gdal.Open("F:\\Mat_Class\\Alaska\\new_tifs\\class_ak_sheet_8a.tif", Access.GA_Update);
> Dataset ds_new = drv.Create("F:\\Mat_Class\\Alaska\\new_tifs\\class_ak_sheet_8a_test.tif", ds.RasterXSize, ds.RasterYSize, 5, DataType.GDT_Byte, new string[] { });
> 
> byte[] r_buffer = new byte[iWidth * iHeight];
> byte[] g_buffer = new byte[iWidth * iHeight];
> byte[] b_buffer = new byte[iWidth * iHeight];
> 
> 
> <get/set values for r_buffer, g_buffer and b_buffer>
> 
> int[] iBandMap = { 1, 2, 3, 4, 5 };
> ds_new.WriteRaster(0, 0, iWidth, iHeight, r_buffer, iWidth, iHeight, 1, iBandMap, 0, 0, 0);
> ds_new.WriteRaster(0, 0, iWidth, iHeight, g_buffer, iWidth, iHeight, 2, iBandMap, 0, 0, 0);
> ds_new.WriteRaster(0, 0, iWidth, iHeight, b_buffer, iWidth, iHeight, 3, iBandMap, 0, 0, 0);

Amanda,

When I look in gdal/swig/include/csharp/gdal_csharp.i I see this defintion:

public CPLErr WriteRaster(int xOff, int yOff, int xSize, int ySize,
      CSTYPE[] buffer, int buf_xSize, int buf_ySize,
      int bandCount, int[] bandMap, int pixelSpace, int lineSpace, int bandSpace)

I think the problem is that you are passing 1, 2, and 3 as the bandCount
value when you are really only passing a buffer (ie. b_buffer) large enough
for one band.

I suspect you should be passing "1" for bandCount each time, but passing
different offets into iBandMap however that is most appopriately done
in C#.  In C/C++ I could do:

  int[] iBandMap = { 1, 2, 3, 4, 5 };
  ds_new.WriteRaster(0, 0, iWidth, iHeight, r_buffer, iWidth, iHeight,
                     1, &(iBandMap[0]), 0, 0, 0);
  ds_new.WriteRaster(0, 0, iWidth, iHeight, g_buffer, iWidth, iHeight,
                     1, &(iBandMap[1]), 0, 0, 0);
  ds_new.WriteRaster(0, 0, iWidth, iHeight, b_buffer, iWidth, iHeight,
                     1, &(iBandMap[2]), 0, 0, 0);


I'm not sure how this idiom translates into C#.

Good luck,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From Steve.Toutant at inspq.qc.ca  Fri Jul 17 14:59:39 2009
From: Steve.Toutant at inspq.qc.ca (Steve.Toutant@inspq.qc.ca)
Date: Fri Jul 17 15:00:02 2009
Subject: [gdal-dev] RE clip intersected
In-Reply-To: <4A60B3DC.6080901@pobox.com>
Message-ID: <OF74DF1719.D721A250-ON852575F6.0067E2E5-852575F6.006854A4@ssss.gouv.qc.ca>

I finally got gdal_polygonize.py and tried it and generate a shapefile. I 
might not use it as a solution for what I described below but I would like 
to use it for other purpose.
My understanding is this function merge contiguous cells with the same 
pixel value.

Can I use this function and specify a range of value?
Example: merge contiguous cells having a value > 16 and < 19

thanks
Steve


Steve Toutant, M. Sc.
Analyste en g?omatique
Secteur environnement
Direction des risques biologiques, environnementaux et occupationnels
Institut national de sant? publique du Qu?bec
945, avenue Wolfe
Qu?bec, Qc G1V 5B3 
T?l.: (418) 650-5115 #5281
Fax.: (418) 654-3144
steve.toutant@inspq.qc.ca
http://www.inspq.qc.ca
 




Frank Warmerdam <warmerdam@pobox.com>@lists.osgeo.org 
Envoy? par : gdal-dev-bounces@lists.osgeo.org
17/07/2009 01:24 PM

A
Steve.Toutant@inspq.qc.ca
cc
gdal-dev@lists.osgeo.org
Objet
Re: [gdal-dev] RE clip intersected








Steve.Toutant@inspq.qc.ca wrote:
> 
> I might try this..is it the good way to do what I need?
> 
> 1- Use gdal_polygonize.py to create a boundary (excluding pixels with no 

> value) of each image and save the boundary as a .shp
> 2- Somehow find the intersected region of the 2 polygons (boundaries) 
> created above and save the result to .shp
> 3- Use gdal_rasterize on one of the original image  to burn a nodata 
> value based on the polygon representing the intersection area
> 
> I didn't try yet because I don't have gdal_polygonize.py
> My installation is from MS4W and this script is not there. I just 
> install GDAL with OSGEO4w and it seems that this script doesn't exist.
> 
> If the method above is valid,
> - how can I create a boundary excluding pixels with nodata?
> - And, of course, where can I get  gdal_polygonize.py

Steve,

I would be tempted to do this process in raster space.  Perhaps by warping
both images into different bands of a mosaic file to get everything 
overlaying
and then using some sort of raster modelling (perhaps via numpy in a 
python
script) to zero out the one image where the other is set.

I think the vector mask approach would be difficult, in part because the 
mask
produced would be very fine grained.  Depending on your need for precision 
you
could just hand digitize a vector mask suitable to wipe out the 
overlapping
area.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, 
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

_______________________________________________
gdal-dev mailing list
gdal-dev@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090717/028462b5/attachment.html
From gfiske at whrc.org  Fri Jul 17 15:45:49 2009
From: gfiske at whrc.org (Greg Fiske)
Date: Fri Jul 17 15:42:27 2009
Subject: [gdal-dev] AttributeError: 'MaskedArray' object has no attribute
	'typecode' -- when writing GeoTiff
Message-ID: <009801ca0717$2f49fa20$8dddee60$@org>

Dear list,

In python, I'm writing GeoTiff files from numpy arrays.  I keep getting the
error:
AttributeError: 'MaskedArray' object has no attribute 'typecode'

Of which I cannot find any good description.  Can anybody suggest a reason?

Thanks in advance for any advice, I've pasted my code below,

Greg

Research Associate/GIS Manager
The Woods Hole Research Center
149 Woods Hole Road
Falmouth MA, 02540
508-540-9900x139
gfiske@whrc.org
http://whrc.org


-------------------------
import os, sys, glob
import gdal
import osr
import numpy as np
import numpy.ma as ma

mylist = glob.glob(indir + "Y*lengthgrowseas.img")

MyArrayList = []
increment = 0

def WriteRaster (dst_filename, raster):
        format = "GTiff"
        driver = gdal.GetDriverByName( format )
        dst_ds = driver.Create( dst_filename, 1638, 660,1,gdal.GDT_Byte)
        srs = osr.SpatialReference()
        srs.ImportFromEPSG(4326) #WGS84 lat long.
        dst_ds.SetProjection( srs.ExportToWkt() )
        dst_ds.GetRasterBand(1).WriteArray(raster)
        dst_ds = None

for i in mylist:
        increment = increment + 1
        name, ext = i.split("ims/")
        ext2, ext3 = ext.split(".")
        dataset = gdal.Open(i)
        a = dataset.ReadAsArray().astype(Numeric.Float32)
        MyArrayList.append(a)
        del a

b = np.vstack([MyArrayList])
c = np.ma.masked_array(b, -9999)
d = c.mean(axis=0)

WriteRaster("test.tif",d)

del i


From amanda.m.henneke at boeing.com  Fri Jul 17 16:00:10 2009
From: amanda.m.henneke at boeing.com (Henneke, Amanda M)
Date: Fri Jul 17 16:01:43 2009
Subject: [gdal-dev] Creating a new raster and adding data
In-Reply-To: <4A60B5D3.3080400@pobox.com>
References: <A4A1B61586638F4C90EBCAC780B06174090C7FAB@XCH-MW-2V2.mw.nos.boeing.com>
	<4A60B5D3.3080400@pobox.com>
Message-ID: <A4A1B61586638F4C90EBCAC780B06174090C84A2@XCH-MW-2V2.mw.nos.boeing.com>

Thanks Frank for your help, I think I'm further, but still not quite
there.

The definition requires me to send the iBandMap as an array, I cannot
insert the index of the band I wish to write, because then I'm just
passing an integer.  So with that said, I decided to combine all my byte
arrays (buffers) of data into one array and call Write Raster as
follows:

byte[] buffers = new byte[(iHeight * iWidth) * 3];
r_buffer.CopyTo(buffers, 0);
g_buffer.CopyTo(buffers, r_buffer.Length);
b_buffer.CopyTo(buffers, r_buffer.Length * 2);

ds_new.WriteRaster(0, 0, iWidth, iHeight, buffers, iWidth, iHeight, 3,
iBandMap, 0, 0, 0);

But I'm still getting the same exception, so something else must not be
quite right.  I've tried playing around with the pixelSpace, lineSpace
and bandSpace parameters and still no success...any other ideas what I'm
still missing?

Thanks for any assistance!!

Amanda M. Henneke

-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: Friday, July 17, 2009 12:33 PM
To: Henneke, Amanda M
Cc: gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] Creating a new raster and adding data

Henneke, Amanda M wrote:
...
> This is what I have so far...
> 
> Dataset ds = 
> Gdal.Open("F:\\Mat_Class\\Alaska\\new_tifs\\class_ak_sheet_8a.tif", 
> Access.GA_Update); Dataset ds_new = 
> drv.Create("F:\\Mat_Class\\Alaska\\new_tifs\\class_ak_sheet_8a_test.ti
> f", ds.RasterXSize, ds.RasterYSize, 5, DataType.GDT_Byte, new string[]

> { });
> 
> byte[] r_buffer = new byte[iWidth * iHeight]; byte[] g_buffer = new 
> byte[iWidth * iHeight]; byte[] b_buffer = new byte[iWidth * iHeight];
> 
> 
> <get/set values for r_buffer, g_buffer and b_buffer>
> 
> int[] iBandMap = { 1, 2, 3, 4, 5 };
> ds_new.WriteRaster(0, 0, iWidth, iHeight, r_buffer, iWidth, iHeight, 
> 1, iBandMap, 0, 0, 0); ds_new.WriteRaster(0, 0, iWidth, iHeight, 
> g_buffer, iWidth, iHeight, 2, iBandMap, 0, 0, 0); 
> ds_new.WriteRaster(0, 0, iWidth, iHeight, b_buffer, iWidth, iHeight, 
> 3, iBandMap, 0, 0, 0);

Amanda,

When I look in gdal/swig/include/csharp/gdal_csharp.i I see this
defintion:

public CPLErr WriteRaster(int xOff, int yOff, int xSize, int ySize,
      CSTYPE[] buffer, int buf_xSize, int buf_ySize,
      int bandCount, int[] bandMap, int pixelSpace, int lineSpace, int
bandSpace)

I think the problem is that you are passing 1, 2, and 3 as the bandCount
value when you are really only passing a buffer (ie. b_buffer) large
enough for one band.

I suspect you should be passing "1" for bandCount each time, but passing
different offets into iBandMap however that is most appopriately done in
C#.  In C/C++ I could do:

  int[] iBandMap = { 1, 2, 3, 4, 5 };
  ds_new.WriteRaster(0, 0, iWidth, iHeight, r_buffer, iWidth, iHeight,
                     1, &(iBandMap[0]), 0, 0, 0);
  ds_new.WriteRaster(0, 0, iWidth, iHeight, g_buffer, iWidth, iHeight,
                     1, &(iBandMap[1]), 0, 0, 0);
  ds_new.WriteRaster(0, 0, iWidth, iHeight, b_buffer, iWidth, iHeight,
                     1, &(iBandMap[2]), 0, 0, 0);


I'm not sure how this idiom translates into C#.

Good luck,
-- 
---------------------------------------+--------------------------------
---------------------------------------+------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Fri Jul 17 16:25:25 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Jul 17 16:24:31 2009
Subject: [gdal-dev] RE clip intersected
In-Reply-To: <OF74DF1719.D721A250-ON852575F6.0067E2E5-852575F6.006854A4@ssss.gouv.qc.ca>
References: <OF74DF1719.D721A250-ON852575F6.0067E2E5-852575F6.006854A4@ssss.gouv.qc.ca>
Message-ID: <4A60DE35.2080105@pobox.com>

Steve.Toutant@inspq.qc.ca wrote:
> 
> I finally got gdal_polygonize.py and tried it and generate a shapefile. 
> I might not use it as a solution for what I described below but I would 
> like to use it for other purpose.
> My understanding is this function merge contiguous cells with the same 
> pixel value.

Steve,

That is correct.

> Can I use this function and specify a range of value?
> Example: merge contiguous cells having a value > 16 and < 19

No, it does not support any mechanism like that.  It is assumed the
user would do preprocessing to turn ranges into a mask.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From even.rouault at mines-paris.org  Fri Jul 17 16:41:18 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri Jul 17 16:41:29 2009
Subject: [gdal-dev] Failed to process SRS definition
In-Reply-To: <200907170916.48695.jorn@spacetec.no>
References: <200907151312.39193.jorn@spacetec.no>
	<200907162059.55712.even.rouault@mines-paris.org>
	<200907170916.48695.jorn@spacetec.no>
Message-ID: <200907172241.19361.even.rouault@mines-paris.org>

OGR only supports the "+a=xxxxx +b=yyyyy"  and "+a=xxxx +rf=zzzzz" 
combinations. It could be extended to support more combinations, but those 2 
ones are the most common to describe an ellipsoid. Patches welcome if your 
needs go beyond that.

I don't think OCTProj4Normalize() strips the b parameter. It's just, that OGR 
transforms (a, b) into equivalent (a, rf) in importFromWkt(), as the WKT 
modelling of an ellipsoid requires those later parameters.
And in exportToProj4() it will generate "+a=xxxx +b=yyyyy"

2 working examples :

1) testepsg "+proj=stere +lat_0=90 +lon_0=315 +lat_ts=70 +units=m +a=6378273 
+rf=278"

--> PROJ.4 rendering of [+proj=stere +lat_0=90 +lon_0=315 +lat_ts=70 +units=m 
+a=6378273 +rf=278] = +proj=stere +lat_0=90 +lat_ts=70 +lon_0=315 +k=1 +x_0=0 
+y_0=0 +a=6378273 +b=6355329.571942446 +units=m +no_defs

2) testepsg "+proj=stere +lat_0=90 +lon_0=315 +lat_ts=70 +units=m +a=6378273 
+b=6355329.571942446"

--> PROJ.4 rendering of [+proj=stere +lat_0=90 +lon_0=315 +lat_ts=70 +units=m 
+a=6378273 +b=6355329.571942446] = +proj=stere +lat_0=90 +lat_ts=70 
+lon_0=315 +k=1 +x_0=0 +y_0=0 +a=6378273 +b=6355329.571942446 +units=m 
+no_defs



Le Friday 17 July 2009 09:16:47 J?rn Vegard R?snes, vous avez ?crit?:
> On Thursday 16 July 2009 20:59:55 Even Rouault wrote:
> > Le Thursday 16 July 2009 10:14:27 J?rn Vegard R?snes, vous avez ?crit?:
> > > Hi again,
> > >
> > > On Wednesday 15 July 2009 13:12:38 J?rn Vegard R?snes wrote:
> > > > Hi all,
> > > >
> > > > can you see the problem (this works with proj4)?
> > > > It works if I remove "+a=6378273" from proj4-string, but I assume the
> > > > output will be wrong.
> > > >
> > > > ./ogr2ogr -s_srs EPSG:4326 -t_srs "+proj=stere +lat_0=90 +lon_0=315
> > > > +lat_ts=70 +units=m +a=6378273 +e=0.081816153" -f "ESRI Shapefile"
> > > > gshhs_land_stere ~/download/gshhs_1.3_shapefiles/gshhs_land/
> > >
> > > I have downloaded v1.6.1, added some debug and compiled
> > > (--enable-debug).
> > >
> > > It seems that
> > >
> > > ogr/ogr_srs_proj4.cpp OGRSpatialReference::importFromProj4, line 847 -
> > > 945
> > >
> > > does not read the +e proj4 parameter (neither +f and +es), ref. page 9
> > > in proj4 doc (ftp://ftp.remotesensing.org/proj/OF90-284.pdf).
> > >
> > > +b and +rf is read by the code, so maybe there is a math. workaround?
> >
> > Yes, the a,b,e,f and rf parameters are tied by math relations.
> >
> > See http://www.arsitech.com/mapping/geodetic_datum. (rf is reverse
> > flattening = inverse flattening)
>
> Yes, I found
> http://en.wikipedia.org/wiki/Angular_eccentricity#Elliptic_parameters
> and calculated b, yesterday.
>
> Then I found something I do not know if is a feature or bug.
>
> ogr/ogrct.cpp OCTProj4Normalize
> strips away the b (, f and rf) parameter in the proj4 string. It is the
> call to  pszNewProj4Def = pfn_pj_get_def( psPJSource, 0 ); line 245
> that does this.
> I think this is a call to the proj4 libs and it seems that the proj4 libs
> removes the b parameter from the proj4 string, because proj4 is satisfied
> with the a and e params. OGR seems to require a and b, e is not used by
> OGR. I solved this by calling
> return CPLStrdup( pszProj4Src );
> in the start of the OCTProj4Normalize function.
>
> Note that I haven't downloaded the proj4 source, and I just assume in the
> text above.
>
> cheers
> J?rn Vegard
>
> > > cheers
> > > J?rn Vegard
> > >
> > > > All binaries (proj4, ogr2ogr) from FWTools 2.0.6
> > > >
> > > > cheers
> > > > J?rn Vegard
> > > > _______________________________________________
> > > > gdal-dev mailing list
> > > > gdal-dev@lists.osgeo.org
> > > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > >
> > > _______________________________________________
> > > gdal-dev mailing list
> > > gdal-dev@lists.osgeo.org
> > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From jorge.arevalo at gmail.com  Sun Jul 19 18:50:33 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Sun Jul 19 18:50:57 2009
Subject: [gdal-dev] GDAL WKT Raster driver weekly report #8
Message-ID: <cb4457700907191550s49988c89x3936d48509dffd4c@mail.gmail.com>

Hello,

The report: http://www.gis4free.org/blog/2009/07/20/gsoc-09-weekly-report-8-1007-1707/

The project page: http://trac.osgeo.org/gdal/wiki/WKTRasterDriver

Best regards
Jorge
From srikanth1947 at gmail.com  Mon Jul 20 05:50:33 2009
From: srikanth1947 at gmail.com (Srikanth)
Date: Mon Jul 20 05:50:37 2009
Subject: [gdal-dev] P.Halls@york.ac.uk,chaitanya.ch@gmail.com
Message-ID: <7a566dfe0907200250q15e184d3vc985d3e89c419163@mail.gmail.com>

Dear All,

I am trying to build gdal library on windows using Cygwin with OCI support.
I have Oracle client installed on my machine and ORACLE_HOME is set. I
have enabled the oci support using --with-oci=yes and even provided
-include and -lib paths.
It is able to locate the include files but is not able to find the libraries.

error thrown:
----------------------------
checking if Expat XML Parser version is >= 1.95.0... yes
checking for SQLConnect in -lodbc... no
checking for SQLInstallDriverEx in -lodbcinst... no
checking for Oracle OCI headers in C:/oracle/product/10.2.0/client_2/rdbms/publi
c... yes
checking for Oracle OCI libraries in C:/oracle/product/10.2.0/client_2/lib... no
t found
checking if Oracle support is enabled... no
checking Checking for DODS... disabled
checking for curl-config... no
checking for SQLite3 library >= 3.0.0... not found
checking Checking for DWGdirect... disabled
configure: IBM Informix DataBlade not supported.
configure: checking whether we should include ESRI SDE support...
       ESRI SDE support not requested.


I have pasted config.log (as config.log is exceeding the file size
limit of 50KB , Icould not attach)  file for your reference. My
understanding by looking at the log file is it is not able to locate
libclntsh library.I am not able to find the equivalent library on
windows.

Any help in this regard is appreciated.

config.log :
------------------------------

configure:23652: checking for Oracle OCI headers in
C:/oracle/product/10.2.0/client_2/rdbms/public
configure:23695: g++ -c -g -O2
-IC:/oracle/product/10.2.0/client_2/rdbms/public
-IC:/oracle/product/10.2.0/client_2/rdbms/demo conftest.cpp >&5
configure:23701: $? = 0
configure:23714: result: yes
configure:23739: checking for Oracle OCI libraries in
C:/oracle/product/10.2.0/client_2/lib
configure:23775: g++ -o conftest.exe -g -O2
-IC:/oracle/product/10.2.0/client_2/rdbms/public
-IC:/oracle/product/10.2.0/client_2/rdbms/demo
-LC:/oracle/product/10.2.0/client_2/lib -lclntsh conftest.cpp -ljasper
-lhdf5 -ljpeg -ltiff -lpng -lz  -ldl  >&5
/usr/lib/gcc/i686-pc-cygwin/3.4.4/../../../../i686-pc-cygwin/bin/ld:
cannot find -lclntsh
collect2: ld returned 1 exit status
configure:23781: $? = 1


-- 
Regards,
Srikanth K.
www.servetheneedy.org
From Gary.Smart at goodrich.com  Mon Jul 20 09:37:47 2009
From: Gary.Smart at goodrich.com (Smart, Gary)
Date: Mon Jul 20 09:37:58 2009
Subject: [gdal-dev] Converting raster pixel space to geospace
In-Reply-To: <200907162043.39644.even.rouault@mines-paris.org>
References: <45D1B79D2DCCF34E966D24728765DDB3DF5A9B@nhc2ex11.goodrich.root.local>
	<200907152213.31330.even.rouault@mines-paris.org>
	<45D1B79D2DCCF34E966D24728765DDB3DF5BFA@nhc2ex11.goodrich.root.local>
	<200907162043.39644.even.rouault@mines-paris.org>
Message-ID: <45D1B79D2DCCF34E966D24728765DDB3DF5E31@nhc2ex11.goodrich.root.local>

 

 

OK - I can get it to compile and not crash instantly (bonanza!)

 

However, when I try to create the OGR transform using importFromWkt, 

I get the following:

 

ERROR 6: Unable to load PROJ.4 library (libproj.so), creation of

OGRCoordinateTransformation failed.

 

Does anyone know what this means?  Is there some part of OGR/GDAL I have yet to install?

 

My input projection is:

GTiff/GeoTIFF Projection PROJCS["TM          D-01",GEOGCS["NAD27",DATUM["North_American_Datum_1927",SPHEROID["Clarke 1866",6378206.4,294.9786982139006,AUTHORITY["EPSG","7008"]],AUTHORITY["EPSG","6267"]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433],AUTHORITY["EPSG","4267"]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",-124.5],PARAMETER["scale_factor",1],PARAMETER["false_easting",0],PARAMETER["false_northing",0],UNIT["metre",1,AUTHORITY["EPSG","9001"]]]

 

...and I am looking to output WGS84 lat/longs.

 

 

> -----Original Message-----

> From: Even Rouault [mailto:even.rouault@mines-paris.org]

> Sent: 16 July 2009 19:44

> To: Smart, Gary

> Cc: gdal-dev@lists.osgeo.org

> Subject: Re: [gdal-dev] Converting raster pixel space to geospace

> 

> Le Thursday 16 July 2009 10:41:02 Smart, Gary, vous avez ?crit :

> >

> > But how do I load a OGRSpatialRef object with the output from the

> > GDALApplyGeoTransform?  Presumably I can prime the OGRSpatialReference

> > using the result of GDALDataset::GetProjectionRef?

> 

> Yes, almost. See below

> 

> > I'm not yet sure of my

> > terminology but is the GetProjectionRef supposed to satisfy the OGR

> > importFromWkt (the types seem to clash though - char* vs char**)?

> 

> Maybe the doc of OGRSpatialReference::importFromWkt() (see

> http://gdal.org/ogr/classOGRSpatialReference.html#b74cfc985bd05404a4c61d2d

> 633a6343)

> isn't clear enough ? I must confess that the prototype is a bit weird. You

> don't pass the string itself, but a pointer to a string. The pointer will

> be

> modified to point to the remaining (unused) input, what you generally

> don't

> care about.

> 

> Ok, here's a sample snippet :

> 

> OGRSpatialReferenceH hSRS = OSRNewSpatialReference(NULL);

> const char* pszWkt = GDALGetProjectionRef(hDS);

> OSRImportFromWkt(hSRS, (char**) pszWkt);

> 

> (For the purists, a more correct prototype of importFromWkt () would have

> relied on 'const char**' to avoid the above cast)

> 

> But a simpler approach would be just :

> 

> OGRSpatialReferenceH hSRS;

> hSRS = OSRNewSpatialReference(pszWKT);

> 

> which instanciates the OGRSpatialReferenceH object and call internally

> importFromWkt()

> 

> >

> > I suspect my output projection could then be set up with

> > SetWellKnownGeogCS("WGS84") in order to convert from whatever input

> > projection prevails, to a standard WGS84 lat/long representation (using

> >    OGRCreateCoordinateTransformation::Transform)?

> 

> Yes. Actually, it will be long/lat in term of the order of the

> coordinates.

> 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090720/05162a68/attachment.html
From jdt113 at msstate.edu  Mon Jul 20 09:50:23 2009
From: jdt113 at msstate.edu (jteasis)
Date: Mon Jul 20 09:50:26 2009
Subject: [Gdal-dev] GDAL and ECW
In-Reply-To: <200907162031.44821.even.rouault@mines-paris.org>
References: <1247760513945-3268583.post@n2.nabble.com>
	<200907162031.44821.even.rouault@mines-paris.org>
Message-ID: <1248097823886-3288913.post@n2.nabble.com>


I looked at the gdal website about hooking up ECW with GDAL on windows but it
says it needs to be done. Who can do this and where do I get these
instructions?


Even Rouault wrote:
> 
> Le Thursday 16 July 2009 18:08:33 jteasis, vous avez ?crit?:
>> I am working towards getting a program using ECW and other formats. I
>> have
>> gotten my GDAL 1.5.4 to install with the rest but ECW is giving me
>> problems. I was wondering if there was somebody who could help me figure
>> out how to compile GDAL with ECW correctly. I would greatly appreciate
>> it.
>> Thank you.
> 
> See http://trac.osgeo.org/gdal/wiki/BuildHints, section 'External Library 
> Issues'.
> You could also fetch precompiled binaries with ECW support. See 
> http://trac.osgeo.org/gdal/wiki/DownloadingGdalBinaries (not all of them
> have 
> ECW support, but some yes)
> And note that the latest stable version is GDAL 1.6.1.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 

-- 
View this message in context: http://n2.nabble.com/GDAL-and-ECW-tp3268583p3288913.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From chapmanm at pixia.com  Mon Jul 20 09:48:31 2009
From: chapmanm at pixia.com (Martin Chapman)
Date: Mon Jul 20 09:57:15 2009
Subject: [gdal-dev] Converting raster pixel space to geospace
In-Reply-To: <45D1B79D2DCCF34E966D24728765DDB3DF5E31@nhc2ex11.goodrich.root.local>
References: <45D1B79D2DCCF34E966D24728765DDB3DF5A9B@nhc2ex11.goodrich.root.local>	<200907152213.31330.even.rouault@mines-paris.org>	<45D1B79D2DCCF34E966D24728765DDB3DF5BFA@nhc2ex11.goodrich.root.local>	<200907162043.39644.even.rouault@mines-paris.org>
	<45D1B79D2DCCF34E966D24728765DDB3DF5E31@nhc2ex11.goodrich.root.local>
Message-ID: <000b01ca0940$c51ba280$4f52e780$@com>

Gary,

 

Set your paths like such on startup or as an environment variable:

 

GDAL_DATA points at the data dir that comes with gdal source.

PROJ_LIB point to the nad directory that you download from proj4 website.

 

string env = string("GDAL_DATA=") + dataPath;

_putenv(env.c_str());

env = string("PROJ_LIB=") + nadPath;

_putenv(env.c_str());

 

and / or

 

CPLSetConfigOption("GDAL_DATA", dataPath.c_str());

CPLSetConfigOption("PROJ_LIB", nadPath.c_str());

 

Martin

 

From: gdal-dev-bounces@lists.osgeo.org
[mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Smart, Gary
Sent: Monday, July 20, 2009 7:38 AM
To: gdal-dev@lists.osgeo.org
Subject: RE: [gdal-dev] Converting raster pixel space to geospace

 

 

 

OK - I can get it to compile and not crash instantly (bonanza!)

 

However, when I try to create the OGR transform using importFromWkt, 

I get the following:

 

ERROR 6: Unable to load PROJ.4 library (libproj.so), creation of

OGRCoordinateTransformation failed.

 

Does anyone know what this means?  Is there some part of OGR/GDAL I have yet
to install?

 

My input projection is:

GTiff/GeoTIFF Projection PROJCS["TM
D-01",GEOGCS["NAD27",DATUM["North_American_Datum_1927",SPHEROID["Clarke
1866",6378206.4,294.9786982139006,AUTHORITY["EPSG","7008"]],AUTHORITY["EPSG"
,"6267"]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433],AUTHORITY[
"EPSG","4267"]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_ori
gin",0],PARAMETER["central_meridian",-124.5],PARAMETER["scale_factor",1],PAR
AMETER["false_easting",0],PARAMETER["false_northing",0],UNIT["metre",1,AUTHO
RITY["EPSG","9001"]]]

 

...and I am looking to output WGS84 lat/longs.

 

 

> -----Original Message-----

> From: Even Rouault [mailto:even.rouault@mines-paris.org]

> Sent: 16 July 2009 19:44

> To: Smart, Gary

> Cc: gdal-dev@lists.osgeo.org

> Subject: Re: [gdal-dev] Converting raster pixel space to geospace

> 

> Le Thursday 16 July 2009 10:41:02 Smart, Gary, vous avez ?crit :

> >

> > But how do I load a OGRSpatialRef object with the output from the

> > GDALApplyGeoTransform?  Presumably I can prime the OGRSpatialReference

> > using the result of GDALDataset::GetProjectionRef?

> 

> Yes, almost. See below

> 

> > I'm not yet sure of my

> > terminology but is the GetProjectionRef supposed to satisfy the OGR

> > importFromWkt (the types seem to clash though - char* vs char**)?

> 

> Maybe the doc of OGRSpatialReference::importFromWkt() (see

> http://gdal.org/ogr/classOGRSpatialReference.html#b74cfc985bd05404a4c61d2d

> 633a6343)

> isn't clear enough ? I must confess that the prototype is a bit weird. You

> don't pass the string itself, but a pointer to a string. The pointer will

> be

> modified to point to the remaining (unused) input, what you generally

> don't

> care about.

> 

> Ok, here's a sample snippet :

> 

> OGRSpatialReferenceH hSRS = OSRNewSpatialReference(NULL);

> const char* pszWkt = GDALGetProjectionRef(hDS);

> OSRImportFromWkt(hSRS, (char**) pszWkt);

> 

> (For the purists, a more correct prototype of importFromWkt () would have

> relied on 'const char**' to avoid the above cast)

> 

> But a simpler approach would be just :

> 

> OGRSpatialReferenceH hSRS;

> hSRS = OSRNewSpatialReference(pszWKT);

> 

> which instanciates the OGRSpatialReferenceH object and call internally

> importFromWkt()

> 

> >

> > I suspect my output projection could then be set up with

> > SetWellKnownGeogCS("WGS84") in order to convert from whatever input

> > projection prevails, to a standard WGS84 lat/long representation (using

> >    OGRCreateCoordinateTransformation::Transform)?

> 

> Yes. Actually, it will be long/lat in term of the order of the

> coordinates.

> 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090720/edcc53f0/attachment-0001.html
From daniele.romagnoli at geo-solutions.it  Mon Jul 20 09:58:48 2009
From: daniele.romagnoli at geo-solutions.it (Daniele Romagnoli)
Date: Mon Jul 20 09:58:51 2009
Subject: [Gdal-dev] GDAL and ECW
In-Reply-To: <1248097823886-3288913.post@n2.nabble.com>
References: <1247760513945-3268583.post@n2.nabble.com>
	<200907162031.44821.even.rouault@mines-paris.org>
	<1248097823886-3288913.post@n2.nabble.com>
Message-ID: <7221db410907200658u6878bab2xbc9fc74ab619d00b@mail.gmail.com>

Hi,
we have already done it for ImageIO-Ext (a Java project which uses GDAL).
You can take a look on the Imageio-ext setup guide which is available at
[1].
It contains instructions to setup and build GDAL to support several external
formats, as well as instructions to build the java project.
You don't need to read all the guide but you could take a better look to the
following sections:
2.7.1.3, 2.7.2.4 , 2.7.3 (Only the introduction, no need to proceed with
2.7.3.1).

Hope this helps.
Regards,
Daniele

[1]:
https://imageio-ext.dev.java.net/files/documents/7505/124115/ImageioExt-SetupGuide.pdf


On Mon, Jul 20, 2009 at 3:50 PM, jteasis <jdt113@msstate.edu> wrote:

>
> I looked at the gdal website about hooking up ECW with GDAL on windows but
> it
> says it needs to be done. Who can do this and where do I get these
> instructions?
>
>
> Even Rouault wrote:
> >
> > Le Thursday 16 July 2009 18:08:33 jteasis, vous avez ?crit :
> >> I am working towards getting a program using ECW and other formats. I
> >> have
> >> gotten my GDAL 1.5.4 to install with the rest but ECW is giving me
> >> problems. I was wondering if there was somebody who could help me figure
> >> out how to compile GDAL with ECW correctly. I would greatly appreciate
> >> it.
> >> Thank you.
> >
> > See http://trac.osgeo.org/gdal/wiki/BuildHints, section 'External
> Library
> > Issues'.
> > You could also fetch precompiled binaries with ECW support. See
> > http://trac.osgeo.org/gdal/wiki/DownloadingGdalBinaries (not all of them
> > have
> > ECW support, but some yes)
> > And note that the latest stable version is GDAL 1.6.1.
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >
> >
>
> --
> View this message in context:
> http://n2.nabble.com/GDAL-and-ECW-tp3268583p3288913.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
-------------------------------------------------------
Eng. Daniele Romagnoli
Software Engineer

GeoSolutions S.A.S.
Via Carignoni 51
55041 Camaiore (LU)
Italy

phone: +39 0584983027
fax:     +39 0584983027
mob:   +39 328 0559267


http://www.geo-solutions.it

-------------------------------------------------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090720/9fa44d7a/attachment.html
From Gary.Smart at Goodrich.com  Mon Jul 20 10:49:33 2009
From: Gary.Smart at Goodrich.com (Smart, Gary)
Date: Mon Jul 20 10:49:43 2009
Subject: [gdal-dev] Converting raster pixel space to geospace
In-Reply-To: <000b01ca0940$c51ba280$4f52e780$@com>
References: <45D1B79D2DCCF34E966D24728765DDB3DF5A9B@nhc2ex11.goodrich.root.local>	<200907152213.31330.even.rouault@mines-paris.org>	<45D1B79D2DCCF34E966D24728765DDB3DF5BFA@nhc2ex11.goodrich.root.local>	<200907162043.39644.even.rouault@mines-paris.org>
	<45D1B79D2DCCF34E966D24728765DDB3DF5E31@nhc2ex11.goodrich.root.local>
	<000b01ca0940$c51ba280$4f52e780$@com>
Message-ID: <45D1B79D2DCCF34E966D24728765DDB3DF5E50@nhc2ex11.goodrich.root.local>

Thanks Martin, but now to the next problem...

 

I downloaded PRROJ.4 which seemed to configure and compile OK.

Having set the PROJ_LIB as you proposed, I now get:

 

ERROR 1: No PROJ.4 translation for source SRS, coordinate transformation initialization has failed.

 

I guess I am still missing comething.  The failure came from the same geotiff file as below.

 

I also couldn't find a 'data dir' in the GDAL source and therefore GDAL_DATA env var remained unset.  We installed everything from the FWTools download for our Linux SUSE10 system.  Should there be a 'data' directory under the FWTools directory somewhere?  There is no GDAL source in this directory - just include files and libraries.  I presumed this was all that was needed to use GDAL?   

 

________________________________

From: Martin Chapman [mailto:chapmanm@pixia.com] 
Sent: 20 July 2009 14:49
To: Smart, Gary; gdal-dev@lists.osgeo.org
Subject: RE: [gdal-dev] Converting raster pixel space to geospace

 

Gary,

 

Set your paths like such on startup or as an environment variable:

 

GDAL_DATA points at the data dir that comes with gdal source.

PROJ_LIB point to the nad directory that you download from proj4 website.

 

string env = string("GDAL_DATA=") + dataPath;

_putenv(env.c_str());

env = string("PROJ_LIB=") + nadPath;

_putenv(env.c_str());

 

and / or

 

CPLSetConfigOption("GDAL_DATA", dataPath.c_str());

CPLSetConfigOption("PROJ_LIB", nadPath.c_str());

 

Martin

 

From: gdal-dev-bounces@lists.osgeo.org [mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Smart, Gary
Sent: Monday, July 20, 2009 7:38 AM
To: gdal-dev@lists.osgeo.org
Subject: RE: [gdal-dev] Converting raster pixel space to geospace

 

 

 

OK - I can get it to compile and not crash instantly (bonanza!)

 

However, when I try to create the OGR transform using importFromWkt, 

I get the following:

 

ERROR 6: Unable to load PROJ.4 library (libproj.so), creation of

OGRCoordinateTransformation failed.

 

Does anyone know what this means?  Is there some part of OGR/GDAL I have yet to install?

 

My input projection is:

GTiff/GeoTIFF Projection PROJCS["TM          D-01",GEOGCS["NAD27",DATUM["North_American_Datum_1927",SPHEROID["Clarke 1866",6378206.4,294.9786982139006,AUTHORITY["EPSG","7008"]],AUTHORITY["EPSG","6267"]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433],AUTHORITY["EPSG","4267"]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",-124.5],PARAMETER["scale_factor",1],PARAMETER["false_easting",0],PARAMETER["false_northing",0],UNIT["metre",1,AUTHORITY["EPSG","9001"]]]

 

...and I am looking to output WGS84 lat/longs.

 

 

> -----Original Message-----

> From: Even Rouault [mailto:even.rouault@mines-paris.org]

> Sent: 16 July 2009 19:44

> To: Smart, Gary

> Cc: gdal-dev@lists.osgeo.org

> Subject: Re: [gdal-dev] Converting raster pixel space to geospace

> 

> Le Thursday 16 July 2009 10:41:02 Smart, Gary, vous avez ?crit :

> >

> > But how do I load a OGRSpatialRef object with the output from the

> > GDALApplyGeoTransform?  Presumably I can prime the OGRSpatialReference

> > using the result of GDALDataset::GetProjectionRef?

> 

> Yes, almost. See below

> 

> > I'm not yet sure of my

> > terminology but is the GetProjectionRef supposed to satisfy the OGR

> > importFromWkt (the types seem to clash though - char* vs char**)?

> 

> Maybe the doc of OGRSpatialReference::importFromWkt() (see

> http://gdal.org/ogr/classOGRSpatialReference.html#b74cfc985bd05404a4c61d2d

> 633a6343)

> isn't clear enough ? I must confess that the prototype is a bit weird. You

> don't pass the string itself, but a pointer to a string. The pointer will

> be

> modified to point to the remaining (unused) input, what you generally

> don't

> care about.

> 

> Ok, here's a sample snippet :

> 

> OGRSpatialReferenceH hSRS = OSRNewSpatialReference(NULL);

> const char* pszWkt = GDALGetProjectionRef(hDS);

> OSRImportFromWkt(hSRS, (char**) pszWkt);

> 

> (For the purists, a more correct prototype of importFromWkt () would have

> relied on 'const char**' to avoid the above cast)

> 

> But a simpler approach would be just :

> 

> OGRSpatialReferenceH hSRS;

> hSRS = OSRNewSpatialReference(pszWKT);

> 

> which instanciates the OGRSpatialReferenceH object and call internally

> importFromWkt()

> 

> >

> > I suspect my output projection could then be set up with

> > SetWellKnownGeogCS("WGS84") in order to convert from whatever input

> > projection prevails, to a standard WGS84 lat/long representation (using

> >    OGRCreateCoordinateTransformation::Transform)?

> 

> Yes. Actually, it will be long/lat in term of the order of the

> coordinates.

> 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090720/73c39dcb/attachment-0001.html
From jdt113 at msstate.edu  Mon Jul 20 11:02:34 2009
From: jdt113 at msstate.edu (jteasis)
Date: Mon Jul 20 11:02:35 2009
Subject: [Gdal-dev] GDAL and ECW
In-Reply-To: <7221db410907200658u6878bab2xbc9fc74ab619d00b@mail.gmail.com>
References: <1247760513945-3268583.post@n2.nabble.com>
	<200907162031.44821.even.rouault@mines-paris.org>
	<1248097823886-3288913.post@n2.nabble.com>
	<7221db410907200658u6878bab2xbc9fc74ab619d00b@mail.gmail.com>
Message-ID: <1248102154729-3289319.post@n2.nabble.com>


I got the files but all I have is Extract.exe and a batch file. Is this
correct and is there a place I need to put them or do I need to put them in
a specific location? Thank you so much for the help. It is greatly
appreciated. 


Daniele Romagnoli wrote:
> 
> Hi,
> we have already done it for ImageIO-Ext (a Java project which uses GDAL).
> You can take a look on the Imageio-ext setup guide which is available at
> [1].
> It contains instructions to setup and build GDAL to support several
> external
> formats, as well as instructions to build the java project.
> You don't need to read all the guide but you could take a better look to
> the
> following sections:
> 2.7.1.3, 2.7.2.4 , 2.7.3 (Only the introduction, no need to proceed with
> 2.7.3.1).
> 
> Hope this helps.
> Regards,
> Daniele
> 
> [1]:
> https://imageio-ext.dev.java.net/files/documents/7505/124115/ImageioExt-SetupGuide.pdf
> 
> 
> On Mon, Jul 20, 2009 at 3:50 PM, jteasis <jdt113@msstate.edu> wrote:
> 
>>
>> I looked at the gdal website about hooking up ECW with GDAL on windows
>> but
>> it
>> says it needs to be done. Who can do this and where do I get these
>> instructions?
>>
>>
>> Even Rouault wrote:
>> >
>> > Le Thursday 16 July 2009 18:08:33 jteasis, vous avez ?crit :
>> >> I am working towards getting a program using ECW and other formats. I
>> >> have
>> >> gotten my GDAL 1.5.4 to install with the rest but ECW is giving me
>> >> problems. I was wondering if there was somebody who could help me
>> figure
>> >> out how to compile GDAL with ECW correctly. I would greatly appreciate
>> >> it.
>> >> Thank you.
>> >
>> > See http://trac.osgeo.org/gdal/wiki/BuildHints, section 'External
>> Library
>> > Issues'.
>> > You could also fetch precompiled binaries with ECW support. See
>> > http://trac.osgeo.org/gdal/wiki/DownloadingGdalBinaries (not all of
>> them
>> > have
>> > ECW support, but some yes)
>> > And note that the latest stable version is GDAL 1.6.1.
>> > _______________________________________________
>> > gdal-dev mailing list
>> > gdal-dev@lists.osgeo.org
>> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>> >
>> >
>>
>> --
>> View this message in context:
>> http://n2.nabble.com/GDAL-and-ECW-tp3268583p3288913.html
>> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
> 
> 
> 
> -- 
> -------------------------------------------------------
> Eng. Daniele Romagnoli
> Software Engineer
> 
> GeoSolutions S.A.S.
> Via Carignoni 51
> 55041 Camaiore (LU)
> Italy
> 
> phone: +39 0584983027
> fax:     +39 0584983027
> mob:   +39 328 0559267
> 
> 
> http://www.geo-solutions.it
> 
> -------------------------------------------------------
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 

-- 
View this message in context: http://n2.nabble.com/GDAL-and-ECW-tp3268583p3289319.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From jorge.arevalo at gmail.com  Mon Jul 20 11:24:26 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Mon Jul 20 11:30:42 2009
Subject: [gdal-dev] DWG support in gdal
Message-ID: <cb4457700907200824l23c3f437n5210ec75c93722dc@mail.gmail.com>

Hello,

I know that GDAL can be compiled with support for DWG format, but you
need DWG direct support. I've tried to download the OpenDWG libraries
from http://www.opendwg.org/the_oda_platform/dwgdirect, but you need
membership, and it's not free.

Is there any way to have DWG support in GDAL using any open source
library? Or do you know any dwg2shp converter?

Thanks a lot

Best regards
Jorge
From P.Halls at york.ac.uk  Mon Jul 20 11:37:02 2009
From: P.Halls at york.ac.uk (Peter J Halls)
Date: Mon Jul 20 11:37:08 2009
Subject: [gdal-dev] Re: Problem building gdal library using OCI
In-Reply-To: <7a566dfe0907200241q51ce4aa2p440e519dcbc1e805@mail.gmail.com>
References: <7a566dfe0907200241q51ce4aa2p440e519dcbc1e805@mail.gmail.com>
Message-ID: <4A648F1E.5040306@york.ac.uk>

Srikanth,

    check the path config is generating (config.status) for the library area and 
correct it, if necessary.  On Solaris I seem to remember that it added a suffix 
(rdbms?) to the path I specified and so could not find the libraries.

Peter

Srikanth wrote:
> Dear All,
> 
> I am trying to build gdal library on windows using Cygwin with OCI support.
> I have Oracle client installed on my machine and ORACLE_HOME is set. I
> have enabled the oci support using --with-oci=yes and even provided
> -include and -lib paths.
> It is able to locate the include files but is not able to find the libraries.
> 
> error thrown:
> 
> checking if Expat XML Parser version is >= 1.95.0... yes
> checking for SQLConnect in -lodbc... no
> checking for SQLInstallDriverEx in -lodbcinst... no
> checking for Oracle OCI headers in C:/oracle/product/10.2.0/client_2/rdbms/publi
> c... yes
> checking for Oracle OCI libraries in C:/oracle/product/10.2.0/client_2/lib... no
> t found
> checking if Oracle support is enabled... no
> checking Checking for DODS... disabled
> checking for curl-config... no
> checking for SQLite3 library >= 3.0.0... not found
> checking Checking for DWGdirect... disabled
> configure: IBM Informix DataBlade not supported.
> configure: checking whether we should include ESRI SDE support...
>         ESRI SDE support not requested.
> 
> 
> I am also attaching the config.log file for you reference. My
> understanding by looking at the log file is it is not able to locate
> libclntsh library.I am not able to find the equivalent library on
> windows.
> 
> Any help in this regard is appreciated.
> 

-- 
--------------------------------------------------------------------------------
Peter J Halls, GIS Advisor, University of York
Telephone: 01904 433806     Fax: 01904 433740
Snail mail: Computing Service, University of York, Heslington, York YO10 5DD
This message has the status of a private and personal communication
--------------------------------------------------------------------------------
From anja.roesel at zmaw.de  Mon Jul 20 12:13:22 2009
From: anja.roesel at zmaw.de (Anja Roesel)
Date: Mon Jul 20 12:35:06 2009
Subject: [gdal-dev] utm to geographic coordinates with gdalwarp
Message-ID: <4A6497A2.7040700@zmaw.de>

Hi list,

My plan is to calculate UTM coordinates in geographic coordinates
(lat/lon), but I am not sure which parameters I need for the gdalwarp
command: gdalwarp -t_srs '+proj=?
May be some of you did this before and an help.
Thank you in advance,
Anja
From amanda.m.henneke at boeing.com  Mon Jul 20 12:36:27 2009
From: amanda.m.henneke at boeing.com (Henneke, Amanda M)
Date: Mon Jul 20 13:01:40 2009
Subject: [gdal-dev] Creating a new raster and adding data
In-Reply-To: <4A60DFF3.2070604@pobox.com>
References: <A4A1B61586638F4C90EBCAC780B06174090C7FAB@XCH-MW-2V2.mw.nos.boeing.com><4A60B5D3.3080400@pobox.com><A4A1B61586638F4C90EBCAC780B06174090C84A2@XCH-MW-2V2.mw.nos.boeing.com>
	<4A60DFF3.2070604@pobox.com>
Message-ID: <A4A1B61586638F4C90EBCAC780B061740910BC07@XCH-MW-2V2.mw.nos.boeing.com>

Ok, so after some more experimentation, I think I found that the reason
it was dying was due to a file being too large.  When I run it on a
smaller dataset, it seems I am successful in getting past the
WriteRaster command in my code.

The bad news is that it doesn't seem to be working properly.  It seems
to write the first band correctly, but bands 2-5 are written
incorrectly.  The buffer I'm using checks out before and after the
WriteRaster command.  So it has got to be something with the WriteRaster
command that is not working.  I've played with the offsets and all,
especially the bandspace, linespace and rasterspace arguments.   Anyone
have similar problems, or any ideas as to why I can't get the
WriteRaster to work?

Thanks!


Amanda M. Henneke
 
When One tugs at a single thing in Nature, he finds it attached to the
rest of the world. -John Muir
  Please consider the environment before printing this e-mail.

-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: Friday, July 17, 2009 3:33 PM
To: Henneke, Amanda M
Subject: Re: [gdal-dev] Creating a new raster and adding data

Henneke, Amanda M wrote:
> Thanks Frank for your help, I think I'm further, but still not quite 
> there.
> 
> The definition requires me to send the iBandMap as an array, I cannot 
> insert the index of the band I wish to write, because then I'm just 
> passing an integer.  So with that said, I decided to combine all my 
> byte arrays (buffers) of data into one array and call Write Raster as
> follows:
> 
> byte[] buffers = new byte[(iHeight * iWidth) * 3]; 
> r_buffer.CopyTo(buffers, 0); g_buffer.CopyTo(buffers, 
> r_buffer.Length); b_buffer.CopyTo(buffers, r_buffer.Length * 2);
> 
> ds_new.WriteRaster(0, 0, iWidth, iHeight, buffers, iWidth, iHeight, 3,

> iBandMap, 0, 0, 0);
> 
> But I'm still getting the same exception, so something else must not 
> be quite right.  I've tried playing around with the pixelSpace, 
> lineSpace and bandSpace parameters and still no success...any other 
> ideas what I'm still missing?

Amanda,

Your new approach looks reasonable.  I don't know what is going wrong.

Best regards,
-- 
---------------------------------------+--------------------------------
---------------------------------------+------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From chapmanm at pixia.com  Mon Jul 20 13:10:22 2009
From: chapmanm at pixia.com (Martin Chapman)
Date: Mon Jul 20 13:10:46 2009
Subject: [gdal-dev] Converting raster pixel space to geospace
In-Reply-To: <45D1B79D2DCCF34E966D24728765DDB3DF5E50@nhc2ex11.goodrich.root.local>
References: <45D1B79D2DCCF34E966D24728765DDB3DF5A9B@nhc2ex11.goodrich.root.local>	<200907152213.31330.even.rouault@mines-paris.org>	<45D1B79D2DCCF34E966D24728765DDB3DF5BFA@nhc2ex11.goodrich.root.local>	<200907162043.39644.even.rouault@mines-paris.org>	<45D1B79D2DCCF34E966D24728765DDB3DF5E31@nhc2ex11.goodrich.root.local>	<000b01ca0940$c51ba280$4f52e780$@com>
	<45D1B79D2DCCF34E966D24728765DDB3DF5E50@nhc2ex11.goodrich.root.local>
Message-ID: <005201ca095c$f7f76fb0$e7e64f10$@com>

Gary,

 

Can you send me the projection definition (string) and I will see if it
works on my box.  I?m not sure what you get when you download Frank Tools
because I always just get the source code but see if you can find a file
named ?prime_meridian.csv?.  That would be the data dir.  Are you building
gdal from source or does Frank Tools come with a gdal1x.dll already there?
If you are not building from source then maybe you don?t need the proj4 nad
files.  I think you do though because usually when the transformation init
fails it?s because it can?t find those files or the files are from a
different version.  Sorry if I?m not being much help. J

 

Martin 

 

From: gdal-dev-bounces@lists.osgeo.org
[mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Smart, Gary
Sent: Monday, July 20, 2009 8:50 AM
To: gdal-dev@lists.osgeo.org
Subject: RE: [gdal-dev] Converting raster pixel space to geospace

 

Thanks Martin, but now to the next problem


 

I downloaded PRROJ.4 which seemed to configure and compile OK.

Having set the PROJ_LIB as you proposed, I now get:

 

ERROR 1: No PROJ.4 translation for source SRS, coordinate transformation
initialization has failed.

 

I guess I am still missing comething.  The failure came from the same
geotiff file as below.

 

I also couldn?t find a ?data dir? in the GDAL source and therefore GDAL_DATA
env var remained unset.  We installed everything from the FWTools download
for our Linux SUSE10 system.  Should there be a ?data? directory under the
FWTools directory somewhere?  There is no GDAL source in this directory ?
just include files and libraries.  I presumed this was all that was needed
to use GDAL?   

 

  _____  

From: Martin Chapman [mailto:chapmanm@pixia.com] 
Sent: 20 July 2009 14:49
To: Smart, Gary; gdal-dev@lists.osgeo.org
Subject: RE: [gdal-dev] Converting raster pixel space to geospace

 

Gary,

 

Set your paths like such on startup or as an environment variable:

 

GDAL_DATA points at the data dir that comes with gdal source.

PROJ_LIB point to the nad directory that you download from proj4 website.

 

string env = string("GDAL_DATA=") + dataPath;

_putenv(env.c_str());

env = string("PROJ_LIB=") + nadPath;

_putenv(env.c_str());

 

and / or

 

CPLSetConfigOption("GDAL_DATA", dataPath.c_str());

CPLSetConfigOption("PROJ_LIB", nadPath.c_str());

 

Martin

 

From: gdal-dev-bounces@lists.osgeo.org
[mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Smart, Gary
Sent: Monday, July 20, 2009 7:38 AM
To: gdal-dev@lists.osgeo.org
Subject: RE: [gdal-dev] Converting raster pixel space to geospace

 

 

 

OK - I can get it to compile and not crash instantly (bonanza!)

 

However, when I try to create the OGR transform using importFromWkt, 

I get the following:

 

ERROR 6: Unable to load PROJ.4 library (libproj.so), creation of

OGRCoordinateTransformation failed.

 

Does anyone know what this means?  Is there some part of OGR/GDAL I have yet
to install?

 

My input projection is:

GTiff/GeoTIFF Projection PROJCS["TM
D-01",GEOGCS["NAD27",DATUM["North_American_Datum_1927",SPHEROID["Clarke
1866",6378206.4,294.9786982139006,AUTHORITY["EPSG","7008"]],AUTHORITY["EPSG"
,"6267"]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433],AUTHORITY[
"EPSG","4267"]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_ori
gin",0],PARAMETER["central_meridian",-124.5],PARAMETER["scale_factor",1],PAR
AMETER["false_easting",0],PARAMETER["false_northing",0],UNIT["metre",1,AUTHO
RITY["EPSG","9001"]]]

 

...and I am looking to output WGS84 lat/longs.

 

 

> -----Original Message-----

> From: Even Rouault [mailto:even.rouault@mines-paris.org]

> Sent: 16 July 2009 19:44

> To: Smart, Gary

> Cc: gdal-dev@lists.osgeo.org

> Subject: Re: [gdal-dev] Converting raster pixel space to geospace

> 

> Le Thursday 16 July 2009 10:41:02 Smart, Gary, vous avez ?crit :

> >

> > But how do I load a OGRSpatialRef object with the output from the

> > GDALApplyGeoTransform?  Presumably I can prime the OGRSpatialReference

> > using the result of GDALDataset::GetProjectionRef?

> 

> Yes, almost. See below

> 

> > I'm not yet sure of my

> > terminology but is the GetProjectionRef supposed to satisfy the OGR

> > importFromWkt (the types seem to clash though - char* vs char**)?

> 

> Maybe the doc of OGRSpatialReference::importFromWkt() (see

> http://gdal.org/ogr/classOGRSpatialReference.html#b74cfc985bd05404a4c61d2d

> 633a6343)

> isn't clear enough ? I must confess that the prototype is a bit weird. You

> don't pass the string itself, but a pointer to a string. The pointer will

> be

> modified to point to the remaining (unused) input, what you generally

> don't

> care about.

> 

> Ok, here's a sample snippet :

> 

> OGRSpatialReferenceH hSRS = OSRNewSpatialReference(NULL);

> const char* pszWkt = GDALGetProjectionRef(hDS);

> OSRImportFromWkt(hSRS, (char**) pszWkt);

> 

> (For the purists, a more correct prototype of importFromWkt () would have

> relied on 'const char**' to avoid the above cast)

> 

> But a simpler approach would be just :

> 

> OGRSpatialReferenceH hSRS;

> hSRS = OSRNewSpatialReference(pszWKT);

> 

> which instanciates the OGRSpatialReferenceH object and call internally

> importFromWkt()

> 

> >

> > I suspect my output projection could then be set up with

> > SetWellKnownGeogCS("WGS84") in order to convert from whatever input

> > projection prevails, to a standard WGS84 lat/long representation (using

> >    OGRCreateCoordinateTransformation::Transform)?

> 

> Yes. Actually, it will be long/lat in term of the order of the

> coordinates.

> 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090720/1ef53746/attachment-0001.html
From BCassanova at weather.com  Mon Jul 20 13:24:27 2009
From: BCassanova at weather.com (Cassanova, Bill)
Date: Mon Jul 20 13:39:37 2009
Subject: [gdal-dev] General Questions about gdal usage with Grib1 Data Set
Message-ID: <1D5F4E64B8C04F4C868B94AC9A532AF80AB39EEB@ATLMAIL01.corp.weather.com>

Hi,

I am new to GDal and just beginning to dig into the intricacies of the
library and would like some guidance on the best way to proceed.

I have a data set that is in a grib1 format but with a Lambert Conformal
Projection.  If need be this file can be converted to either grib2 or
shape file using an application called degrib.

My task is given this data-set I need to be able to extract values from
the file for a given lat-lon and don't necessarily want to code the
intricacies of the Lambert-Conformal-SP2 projection.  So in other words
given a lat-lon of 38.59, - 97.61 I want to be able to interrogate the
raster and extract a value for that given coordinate.

There seem to be a few options and just need advice from the season GDAL
guru's of the best way to proceed:

(1)	Convert the lambert-conformal grib1 to a cylindrical equidistant
grib1 or tiff using gdalwarp and do the simpler ratio based math on the
rectangular grid as opposed to the projected grid.

(2)	Use OGRCreateCoordinateTransformation specifying the source as
Lambert Conformal and the destination as cylindrical equidistant.  My
presumption at this point is that the
OGRCoordinateTransformation->Transform( 1, &x, &y ) method call could
take a longitude as the x-argument, and latitude as the y-argument.  A
successful transform call would replace the original lat-lon with the
new lat-lon and from this point the data grid ( I, J ) offsets could be
calculated using simply ratios.
		
(3)	Are they any more direct simpler ways of accomplishing the same
thing?  
		
Thanks in advance for the help,
Bill
		

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090720/a2333890/attachment.html
From rykovd at gmail.com  Mon Jul 20 13:44:45 2009
From: rykovd at gmail.com (Denis Rykov)
Date: Mon Jul 20 13:44:47 2009
Subject: [gdal-dev] Gdal_merge
Message-ID: <2c9bd88a0907201044o180057c6o5506e8d7d150bb12@mail.gmail.com>

Hi!
I need merge two images - the first image is mutiband and second image is
singleband.
Can I do this operation with gdal_merge or gdal_merge works only with images
with same number of bands?
What utility from gdal library I can use for separate multiband image into
some singleband images?
Thanks.
-DR
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090720/a29f591e/attachment.html
From warmerdam at pobox.com  Mon Jul 20 14:34:49 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon Jul 20 14:33:43 2009
Subject: [gdal-dev] Gdal_merge
In-Reply-To: <2c9bd88a0907201044o180057c6o5506e8d7d150bb12@mail.gmail.com>
References: <2c9bd88a0907201044o180057c6o5506e8d7d150bb12@mail.gmail.com>
Message-ID: <4A64B8C9.2080800@pobox.com>

Denis Rykov wrote:
> Hi!
> I need merge two images - the first image is mutiband and second image 
> is singleband.
> Can I do this operation with gdal_merge or gdal_merge works only with 
> images with same number of bands?
> What utility from gdal library I can use for separate multiband image 
> into some singleband images?

Denis,

You can use gdal_translate to extract a subset of bands from an image.

The following would copy just band 2 from in.tif into a new file, out.tif.

   gdal_translate -b 2 in.tif out.tif

The following would take the first three bands from a 4 band input file.

   gdal_translate -b 1 -b 2 -b 3 rgba.tif rgb.tif

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From neteler at osgeo.org  Mon Jul 20 15:10:44 2009
From: neteler at osgeo.org (Markus Neteler)
Date: Mon Jul 20 15:10:55 2009
Subject: [gdal-dev] utm to geographic coordinates with gdalwarp
In-Reply-To: <4A6497A2.7040700@zmaw.de>
References: <4A6497A2.7040700@zmaw.de>
Message-ID: <86782b610907201210t718b35fcv4d89f9cd35a6fb2e@mail.gmail.com>

On Mon, Jul 20, 2009 at 6:13 PM, Anja Roesel<anja.roesel@zmaw.de> wrote:
> Hi list,
>
> My plan is to calculate UTM coordinates in geographic coordinates
> (lat/lon), but I am not sure which parameters I need for the gdalwarp
> command: gdalwarp -t_srs '+proj=?
> May be some of you did this before and an help.

This should work:

gdalwarp -t_srs epsg:4236 infile outfile

See also
http://www.spatialreference.org/ref/epsg/4326/

Hope this helps
Markus
From even.rouault at mines-paris.org  Mon Jul 20 15:17:09 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon Jul 20 15:17:42 2009
Subject: [gdal-dev] Creating a new raster and adding data
In-Reply-To: <A4A1B61586638F4C90EBCAC780B061740910BC07@XCH-MW-2V2.mw.nos.boeing.com>
References: <A4A1B61586638F4C90EBCAC780B06174090C7FAB@XCH-MW-2V2.mw.nos.boeing.com>
	<4A60DFF3.2070604@pobox.com>
	<A4A1B61586638F4C90EBCAC780B061740910BC07@XCH-MW-2V2.mw.nos.boeing.com>
Message-ID: <200907202117.09798.even.rouault@mines-paris.org>

Amanda,

you're not doing anything wrong now. It's rather a defect of the current C# 
GDAL bindings when dealing with multiple bands. See ticket 
http://trac.osgeo.org/gdal/ticket/3073 that contains a proposed fix for the 
issue.

In the meantime, you can use the WriteRaster() method on each band instead. 
For most drivers, it will have similar performance to WriteRaster() on the 
dataset itself.

Best regards,
Even

Le Monday 20 July 2009 18:36:27 Henneke, Amanda M, vous avez ?crit?:
> Ok, so after some more experimentation, I think I found that the reason
> it was dying was due to a file being too large.  When I run it on a
> smaller dataset, it seems I am successful in getting past the
> WriteRaster command in my code.
>
> The bad news is that it doesn't seem to be working properly.  It seems
> to write the first band correctly, but bands 2-5 are written
> incorrectly.  The buffer I'm using checks out before and after the
> WriteRaster command.  So it has got to be something with the WriteRaster
> command that is not working.  I've played with the offsets and all,
> especially the bandspace, linespace and rasterspace arguments.   Anyone
> have similar problems, or any ideas as to why I can't get the
> WriteRaster to work?
>
> Thanks!
>
>
> Amanda M. Henneke
>
> When One tugs at a single thing in Nature, he finds it attached to the
> rest of the world. -John Muir
>   Please consider the environment before printing this e-mail.
>
> -----Original Message-----
> From: Frank Warmerdam [mailto:warmerdam@pobox.com]
> Sent: Friday, July 17, 2009 3:33 PM
> To: Henneke, Amanda M
> Subject: Re: [gdal-dev] Creating a new raster and adding data
>
> Henneke, Amanda M wrote:
> > Thanks Frank for your help, I think I'm further, but still not quite
> > there.
> >
> > The definition requires me to send the iBandMap as an array, I cannot
> > insert the index of the band I wish to write, because then I'm just
> > passing an integer.  So with that said, I decided to combine all my
> > byte arrays (buffers) of data into one array and call Write Raster as
> > follows:
> >
> > byte[] buffers = new byte[(iHeight * iWidth) * 3];
> > r_buffer.CopyTo(buffers, 0); g_buffer.CopyTo(buffers,
> > r_buffer.Length); b_buffer.CopyTo(buffers, r_buffer.Length * 2);
> >
> > ds_new.WriteRaster(0, 0, iWidth, iHeight, buffers, iWidth, iHeight, 3,
> >
> > iBandMap, 0, 0, 0);
> >
> > But I'm still getting the same exception, so something else must not
> > be quite right.  I've tried playing around with the pixelSpace,
> > lineSpace and bandSpace parameters and still no success...any other
> > ideas what I'm still missing?
>
> Amanda,
>
> Your new approach looks reasonable.  I don't know what is going wrong.
>
> Best regards,


From warmerdam at pobox.com  Mon Jul 20 15:52:00 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon Jul 20 15:50:56 2009
Subject: [gdal-dev] General Questions about gdal usage with Grib1 Data Set
In-Reply-To: <1D5F4E64B8C04F4C868B94AC9A532AF80AB39EEB@ATLMAIL01.corp.weather.com>
References: <1D5F4E64B8C04F4C868B94AC9A532AF80AB39EEB@ATLMAIL01.corp.weather.com>
Message-ID: <4A64CAE0.50306@pobox.com>

Cassanova, Bill wrote:
> Hi,
> 
> I am new to GDal and just beginning to dig into the intricacies of the 
> library and would like some guidance on the best way to proceed.
> 
> I have a data set that is in a grib1 format but with a Lambert Conformal 
> Projection.  If need be this file can be converted to either grib2 or 
> shape file using an application called degrib.
> 
> My task is given this data-set I need to be able to extract values from 
> the file for a given lat-lon and don?t necessarily want to code the 
> intricacies of the Lambert-Conformal-SP2 projection.  So in other words 
> given a lat-lon of 38.59, - 97.61 I want to be able to interrogate the 
> raster and extract a value for that given coordinate.
> 
> There seem to be a few options and just need advice from the season GDAL 
> guru?s of the best way to proceed:
> 
> (1)     Convert the lambert-conformal grib1 to a cylindrical equidistant 
> grib1 or tiff using gdalwarp and do the simpler ratio based math on the 
> rectangular grid as opposed to the projected grid.
> 
> (2)     Use OGRCreateCoordinateTransformation specifying the source as 
> Lambert Conformal and the destination as cylindrical equidistant.  My 
> presumption at this point is that the 
> OGRCoordinateTransformation->Transform( 1, &x, &y ) method call could 
> take a longitude as the x-argument, and latitude as the y-argument.  A 
> successful transform call would replace the original lat-lon with the 
> new lat-lon and from this point the data grid ( I, J ) offsets could be 
> calculated using simply ratios.
> 
> (3)     Are they any more direct simpler ways of accomplishing the same 
> thing? 

Bill,

I would suggest a variation on (2).  You can call
GDALCreateGenImgProjTransformer to create a transformer from image pixel/line
to long/lat.  The call is:

void CPL_DLL *
GDALCreateGenImgProjTransformer( GDALDatasetH hSrcDS, const char *pszSrcWKT,
                                  GDALDatasetH hDstDS, const char *pszDstWKT,
                                  int bGCPUseOK, double dfGCPErrorThreshold,
                                  int nOrder );

But you can leave the hDstDS as NULL, and provide the WGS84 pszDstWKT
yourself.  If the source file coordinate system is already known by GDAL
(check gdalinfo report) then you could leave pszSrcWKT NULL and it will
be picked up from the dataset.  The bGCPUseOK can be FALSE, and the
GCPErrorThreshold 0.0, and nOrder 0.

The pointer you get back can be used with GDALGenImgProjTransform():

int CPL_DLL GDALGenImgProjTransform(
     void *pTransformArg, int bDstToSrc, int nPointCount,
     double *x, double *y, double *z, int *panSuccess );

In your case you want to pass in long/lat, and get back image
pixel/line so you would pass bDstToSrc=TRUE.

This approach is somewhat easier than OGRCreateCoordinateTransformation
because the GenImgProj stuff knows also how to apply the geotransform
step.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From amanda.m.henneke at boeing.com  Mon Jul 20 15:51:40 2009
From: amanda.m.henneke at boeing.com (Henneke, Amanda M)
Date: Mon Jul 20 15:51:38 2009
Subject: [gdal-dev] Creating a new raster and adding data
In-Reply-To: <200907202117.09798.even.rouault@mines-paris.org>
References: <A4A1B61586638F4C90EBCAC780B06174090C7FAB@XCH-MW-2V2.mw.nos.boeing.com>
	<4A60DFF3.2070604@pobox.com>
	<A4A1B61586638F4C90EBCAC780B061740910BC07@XCH-MW-2V2.mw.nos.boeing.com>
	<200907202117.09798.even.rouault@mines-paris.org>
Message-ID: <A4A1B61586638F4C90EBCAC780B061740910BE6B@XCH-MW-2V2.mw.nos.boeing.com>

Thanks Even!  Your suggestion worked, adding each band individually!!  
Also, thanks for writing up that ticket, I'm glad to know I wasn't going crazy!!


Amanda M. Henneke

 
When One tugs at a single thing in Nature, he finds it attached to the rest of the world. -John Muir
  Please consider the environment before printing this e-mail.

-----Original Message-----
From: Even Rouault [mailto:even.rouault@mines-paris.org] 
Sent: Monday, July 20, 2009 2:17 PM
To: gdal-dev@lists.osgeo.org
Cc: Henneke, Amanda M; Tamas Szekeres
Subject: Re: [gdal-dev] Creating a new raster and adding data

Amanda,

you're not doing anything wrong now. It's rather a defect of the current C# GDAL bindings when dealing with multiple bands. See ticket
http://trac.osgeo.org/gdal/ticket/3073 that contains a proposed fix for the issue.

In the meantime, you can use the WriteRaster() method on each band instead. 
For most drivers, it will have similar performance to WriteRaster() on the dataset itself.

Best regards,
Even

Le Monday 20 July 2009 18:36:27 Henneke, Amanda M, vous avez ?crit?:
> Ok, so after some more experimentation, I think I found that the 
> reason it was dying was due to a file being too large.  When I run it 
> on a smaller dataset, it seems I am successful in getting past the 
> WriteRaster command in my code.
>
> The bad news is that it doesn't seem to be working properly.  It seems 
> to write the first band correctly, but bands 2-5 are written 
> incorrectly.  The buffer I'm using checks out before and after the 
> WriteRaster command.  So it has got to be something with the 
> WriteRaster command that is not working.  I've played with the offsets and all,
> especially the bandspace, linespace and rasterspace arguments.   Anyone
> have similar problems, or any ideas as to why I can't get the 
> WriteRaster to work?
>
> Thanks!
>
>
> Amanda M. Henneke
>
> When One tugs at a single thing in Nature, he finds it attached to the 
> rest of the world. -John Muir
>   Please consider the environment before printing this e-mail.
>
> -----Original Message-----
> From: Frank Warmerdam [mailto:warmerdam@pobox.com]
> Sent: Friday, July 17, 2009 3:33 PM
> To: Henneke, Amanda M
> Subject: Re: [gdal-dev] Creating a new raster and adding data
>
> Henneke, Amanda M wrote:
> > Thanks Frank for your help, I think I'm further, but still not quite 
> > there.
> >
> > The definition requires me to send the iBandMap as an array, I 
> > cannot insert the index of the band I wish to write, because then 
> > I'm just passing an integer.  So with that said, I decided to 
> > combine all my byte arrays (buffers) of data into one array and call 
> > Write Raster as
> > follows:
> >
> > byte[] buffers = new byte[(iHeight * iWidth) * 3]; 
> > r_buffer.CopyTo(buffers, 0); g_buffer.CopyTo(buffers, 
> > r_buffer.Length); b_buffer.CopyTo(buffers, r_buffer.Length * 2);
> >
> > ds_new.WriteRaster(0, 0, iWidth, iHeight, buffers, iWidth, iHeight, 
> > 3,
> >
> > iBandMap, 0, 0, 0);
> >
> > But I'm still getting the same exception, so something else must not 
> > be quite right.  I've tried playing around with the pixelSpace, 
> > lineSpace and bandSpace parameters and still no success...any other 
> > ideas what I'm still missing?
>
> Amanda,
>
> Your new approach looks reasonable.  I don't know what is going wrong.
>
> Best regards,


From Gary.Smart at Goodrich.com  Mon Jul 20 16:51:13 2009
From: Gary.Smart at Goodrich.com (Smart, Gary)
Date: Mon Jul 20 16:51:18 2009
Subject: [gdal-dev] How do I open vector files (e.g. shp) using GDAL
Message-ID: <45D1B79D2DCCF34E966D24728765DDB3DF5E8B@nhc2ex11.goodrich.root.local>

I understand that GDAL can open vector formats as if they were a
dataset?

 

E.g. I read that it is possible to pass the GDALOpen either a single
.shp file (in which case it treats it as if it only had one layer) or a
directory containing multiple .shp files - which presumably it opens as
multi layered?

 

However, whenever I try to open vector files in this way (directory or
file) I get...

 

ERROR 4  - blah blah is not recognised as a supported file format"

 

I am still new to all this (having only just conquered raster formats)
so I suspect I am doing something pretty dumb.

Perhaps someone can help?

 

Gary

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090720/82f37abb/attachment.html
From BCassanova at weather.com  Mon Jul 20 16:57:26 2009
From: BCassanova at weather.com (Cassanova, Bill)
Date: Mon Jul 20 16:57:28 2009
Subject: [gdal-dev] General Questions about gdal usage with Grib1 Data Set
In-Reply-To: <4A64CAE0.50306@pobox.com>
References: <1D5F4E64B8C04F4C868B94AC9A532AF80AB39EEB@ATLMAIL01.corp.weather.com>
	<4A64CAE0.50306@pobox.com>
Message-ID: <1D5F4E64B8C04F4C868B94AC9A532AF80AB3A060@ATLMAIL01.corp.weather.com>

Thank you for your help.

Couple more questions:

(1)

After the call to  GDALGenImgProjTransform( ..., ..., ...,  double *x,
double *y, ..., ... );

I am assuming that the x and y arguments contain the new lat-lon values
from the new projection and does not contain the data from the grid.  In
other words I would need to maintain the data in a matrix of my own and
then given the results of X and Y determine an appropriate offset into
the rows and columns of that matrix.  That being said, I would assume
that when data is re-projected that the raster now has a new set of
corner points but the same number of rows and columns of data as was
original.  Am I correct? Do I have anyway of determining the new corner
points?  Has the original number of rows and columns changed?

(2)  My assumption is the C API GDALCreateGenImgProjTransformer and
GDALGenImgProjTransform function calls do not have C++ equivalents
buried in one of the classes somewhere.  I looked briefly at gdalwarper
and saw a few methods that looked similar but nothing that matches the
functionality of these calls.


Thanks,
Bill

-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: Monday, July 20, 2009 3:52 PM
To: Cassanova, Bill
Cc: gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] General Questions about gdal usage with Grib1
Data Set

Cassanova, Bill wrote:
> Hi,
> 
> I am new to GDal and just beginning to dig into the intricacies of the

> library and would like some guidance on the best way to proceed.
> 
> I have a data set that is in a grib1 format but with a Lambert
Conformal 
> Projection.  If need be this file can be converted to either grib2 or 
> shape file using an application called degrib.
> 
> My task is given this data-set I need to be able to extract values
from 
> the file for a given lat-lon and don't necessarily want to code the 
> intricacies of the Lambert-Conformal-SP2 projection.  So in other
words 
> given a lat-lon of 38.59, - 97.61 I want to be able to interrogate the

> raster and extract a value for that given coordinate.
> 
> There seem to be a few options and just need advice from the season
GDAL 
> guru's of the best way to proceed:
> 
> (1)     Convert the lambert-conformal grib1 to a cylindrical
equidistant 
> grib1 or tiff using gdalwarp and do the simpler ratio based math on
the 
> rectangular grid as opposed to the projected grid.
> 
> (2)     Use OGRCreateCoordinateTransformation specifying the source as

> Lambert Conformal and the destination as cylindrical equidistant.  My 
> presumption at this point is that the 
> OGRCoordinateTransformation->Transform( 1, &x, &y ) method call could 
> take a longitude as the x-argument, and latitude as the y-argument.  A

> successful transform call would replace the original lat-lon with the 
> new lat-lon and from this point the data grid ( I, J ) offsets could
be 
> calculated using simply ratios.
> 
> (3)     Are they any more direct simpler ways of accomplishing the
same 
> thing? 

Bill,

I would suggest a variation on (2).  You can call
GDALCreateGenImgProjTransformer to create a transformer from image
pixel/line
to long/lat.  The call is:

void CPL_DLL *
GDALCreateGenImgProjTransformer( GDALDatasetH hSrcDS, const char
*pszSrcWKT,
                                  GDALDatasetH hDstDS, const char
*pszDstWKT,
                                  int bGCPUseOK, double
dfGCPErrorThreshold,
                                  int nOrder );

But you can leave the hDstDS as NULL, and provide the WGS84 pszDstWKT
yourself.  If the source file coordinate system is already known by GDAL
(check gdalinfo report) then you could leave pszSrcWKT NULL and it will
be picked up from the dataset.  The bGCPUseOK can be FALSE, and the
GCPErrorThreshold 0.0, and nOrder 0.

The pointer you get back can be used with GDALGenImgProjTransform():

int CPL_DLL GDALGenImgProjTransform(
     void *pTransformArg, int bDstToSrc, int nPointCount,
     double *x, double *y, double *z, int *panSuccess );

In your case you want to pass in long/lat, and get back image
pixel/line so you would pass bDstToSrc=TRUE.

This approach is somewhat easier than OGRCreateCoordinateTransformation
because the GenImgProj stuff knows also how to apply the geotransform
step.

Best regards,
-- 
---------------------------------------+--------------------------------
------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From even.rouault at mines-paris.org  Mon Jul 20 17:03:21 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon Jul 20 17:03:38 2009
Subject: [gdal-dev] How do I open vector files (e.g. shp) using GDAL
In-Reply-To: <45D1B79D2DCCF34E966D24728765DDB3DF5E8B@nhc2ex11.goodrich.root.local>
References: <45D1B79D2DCCF34E966D24728765DDB3DF5E8B@nhc2ex11.goodrich.root.local>
Message-ID: <200907202303.22437.even.rouault@mines-paris.org>

Le Monday 20 July 2009 22:51:13 Smart, Gary, vous avez ?crit?:
> I understand that GDAL can open vector formats as if they were a
> dataset?
>

No, not exactly. GDAL is for the raster formats. OGR is for the vector 
formats. They have each their concepts, API and notions. See the OGR 
documentation : http://gdal.org/ogr/

>
>
> E.g. I read that it is possible to pass the GDALOpen either a single
> .shp file (in which case it treats it as if it only had one layer) or a
> directory containing multiple .shp files - which presumably it opens as
> multi layered?
>
>
>
> However, whenever I try to open vector files in this way (directory or
> file) I get...
>
>
>
> ERROR 4  - blah blah is not recognised as a supported file format"
>
>
>
> I am still new to all this (having only just conquered raster formats)
> so I suspect I am doing something pretty dumb.
>
> Perhaps someone can help?
>
>
>
> Gary


From warmerdam at pobox.com  Mon Jul 20 17:12:12 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon Jul 20 17:11:19 2009
Subject: [gdal-dev] How do I open vector files (e.g. shp) using GDAL
In-Reply-To: <45D1B79D2DCCF34E966D24728765DDB3DF5E8B@nhc2ex11.goodrich.root.local>
References: <45D1B79D2DCCF34E966D24728765DDB3DF5E8B@nhc2ex11.goodrich.root.local>
Message-ID: <4A64DDAC.2020407@pobox.com>

Smart, Gary wrote:
> I understand that GDAL can open vector formats as if they were a dataset?
> 
>  
> 
> E.g. I read that it is possible to pass the GDALOpen either a single 
> .shp file (in which case it treats it as if it only had one layer) or a 
> directory containing multiple .shp files ? which presumably it opens as 
> multi layered?
> 
>  
> 
> However, whenever I try to open vector files in this way (directory or 
> file) I get?
> 
>  
> 
> ERROR 4  - blah blah is not recognised as a supported file format?

Gary,

The GDAL library can open vector files, but it is not accomplished with
GDALOpen().  Instead you need to call OGROpen(), and use the OGR API
for vector (feature) datasets.

   http://www.gdal.org/ogr

Good luck,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Mon Jul 20 17:14:27 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon Jul 20 17:13:18 2009
Subject: [gdal-dev] General Questions about gdal usage with Grib1 Data Set
In-Reply-To: <1D5F4E64B8C04F4C868B94AC9A532AF80AB3A060@ATLMAIL01.corp.weather.com>
References: <1D5F4E64B8C04F4C868B94AC9A532AF80AB39EEB@ATLMAIL01.corp.weather.com>
	<4A64CAE0.50306@pobox.com>
	<1D5F4E64B8C04F4C868B94AC9A532AF80AB3A060@ATLMAIL01.corp.weather.com>
Message-ID: <4A64DE33.1000707@pobox.com>

Cassanova, Bill wrote:
> Thank you for your help.
> 
> Couple more questions:
> 
> (1)
> 
> After the call to  GDALGenImgProjTransform( ..., ..., ...,  double *x,
> double *y, ..., ... );
> 
> I am assuming that the x and y arguments contain the new lat-lon values
> from the new projection and does not contain the data from the grid.  In
> other words I would need to maintain the data in a matrix of my own and
> then given the results of X and Y determine an appropriate offset into
> the rows and columns of that matrix.  That being said, I would assume
> that when data is re-projected that the raster now has a new set of
> corner points but the same number of rows and columns of data as was
> original.  Am I correct? Do I have anyway of determining the new corner
> points?  Has the original number of rows and columns changed?

Bill,

The function does not warp the raster.  It is just a transformer to make
it easy to get from some georeferenced image space back to a particular
pixel/line location.  So you would feed in long/lat coordinates in
x/y and after the trasnform function returns these variables will
hold pixel/line locations.  You could then use GDAL's RasterIO() to
read the actual pixel values at that location - or you could have read
the whole image into RAM and pull it from an array in memory.

> (2)  My assumption is the C API GDALCreateGenImgProjTransformer and
> GDALGenImgProjTransform function calls do not have C++ equivalents
> buried in one of the classes somewhere.  I looked briefly at gdalwarper
> and saw a few methods that looked similar but nothing that matches the
> functionality of these calls.

That is correct, just use the C entry points.


-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From chapmanm at pixia.com  Mon Jul 20 17:48:11 2009
From: chapmanm at pixia.com (Martin Chapman)
Date: Mon Jul 20 17:48:27 2009
Subject: [gdal-dev] How do I open vector files (e.g. shp) using GDAL
In-Reply-To: <45D1B79D2DCCF34E966D24728765DDB3DF5E8B@nhc2ex11.goodrich.root.local>
References: <45D1B79D2DCCF34E966D24728765DDB3DF5E8B@nhc2ex11.goodrich.root.local>
Message-ID: <008a01ca0983$c73908d0$55ab1a70$@com>

Call OGRRegisterAll(); on the line right before GDALOpen();

 

Martin

 

From: gdal-dev-bounces@lists.osgeo.org
[mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Smart, Gary
Sent: Monday, July 20, 2009 2:51 PM
To: gdal-dev@lists.osgeo.org
Subject: [gdal-dev] How do I open vector files (e.g. shp) using GDAL

 

I understand that GDAL can open vector formats as if they were a dataset?

 

E.g. I read that it is possible to pass the GDALOpen either a single .shp
file (in which case it treats it as if it only had one layer) or a directory
containing multiple .shp files - which presumably it opens as multi layered?

 

However, whenever I try to open vector files in this way (directory or file)
I get.

 

ERROR 4  - blah blah is not recognised as a supported file format"

 

I am still new to all this (having only just conquered raster formats) so I
suspect I am doing something pretty dumb.

Perhaps someone can help?

 

Gary

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090720/68a4473c/attachment.html
From chapmanm at pixia.com  Mon Jul 20 17:50:33 2009
From: chapmanm at pixia.com (Martin Chapman)
Date: Mon Jul 20 17:50:49 2009
Subject: [gdal-dev] How do I open vector files (e.g. shp) using GDAL
References: <45D1B79D2DCCF34E966D24728765DDB3DF5E8B@nhc2ex11.goodrich.root.local>
Message-ID: <009501ca0984$1c28cf10$547a6d30$@com>

Sorry, the call GDALOpen will not work for shape files:

 

Use

 OGRRegisterAll();

dataSource = OGRSFDriverRegistrar::Open((const char*) filePath.c_str());

for c++;

 

and 

 

hDS = OGROpen
<http://www.gdal.org/ogr/ogr__api_8h.html#123bb02ac8c5cfe143e132f627531125>
( "point.shp", FALSE, NULL );

 

 

for c.

 

see http://www.gdal.org/ogr/ogr_apitut.html for more info

 

Martin

 

From: Martin Chapman [mailto:chapmanm@pixia.com] 
Sent: Monday, July 20, 2009 3:48 PM
To: 'Smart, Gary'; 'gdal-dev@lists.osgeo.org'
Subject: RE: [gdal-dev] How do I open vector files (e.g. shp) using GDAL

 

Call OGRRegisterAll(); on the line right before GDALOpen();

 

Martin

 

From: gdal-dev-bounces@lists.osgeo.org
[mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Smart, Gary
Sent: Monday, July 20, 2009 2:51 PM
To: gdal-dev@lists.osgeo.org
Subject: [gdal-dev] How do I open vector files (e.g. shp) using GDAL

 

I understand that GDAL can open vector formats as if they were a dataset?

 

E.g. I read that it is possible to pass the GDALOpen either a single .shp
file (in which case it treats it as if it only had one layer) or a directory
containing multiple .shp files - which presumably it opens as multi layered?

 

However, whenever I try to open vector files in this way (directory or file)
I get.

 

ERROR 4  - blah blah is not recognised as a supported file format"

 

I am still new to all this (having only just conquered raster formats) so I
suspect I am doing something pretty dumb.

Perhaps someone can help?

 

Gary

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090720/5f5e3af5/attachment.html
From warmerdam at pobox.com  Mon Jul 20 20:16:37 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon Jul 20 20:15:21 2009
Subject: [gdal-dev] /vsigzip/ write support in trunk
Message-ID: <4A6508E5.6050901@pobox.com>

Folks,

I have extended Even's /vsigzip/ driver in trunk to support writing as
well as reading.  This means it is possible to write a file in compressed
format by using a filename like /vsigzip/out.asc.gz.  Note that the /vsigzip/
write driver does not support seeking around in the output stream so only
output drivers that use VSI*L *and* that do not do seeks will work.  So it
can't be used for GeoTIFF, but can be used for formats like AAIGRID.

I implemented this primarily so that the new R driver could directly create
a compressed object file.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From scott.sinclair.za at gmail.com  Tue Jul 21 02:14:05 2009
From: scott.sinclair.za at gmail.com (Scott Sinclair)
Date: Tue Jul 21 02:14:17 2009
Subject: [gdal-dev] Python bindings on RedHat cluster (was: 
	AttributeError: 'MaskedArray' object has no attribute 'typecode' --
	when writing GeoTiff)
Message-ID: <6a17e9ee0907202314j10845f44hc9b6f79942dfe5c5@mail.gmail.com>

Hi Greg,

It's always a good idea to communicate via the list, there are more
eyes and skills there. The conversations are also publicly archived,
making it easier for others having similar problems to search for
help.

In this case, the mistake is mine, I see that this list behaves
differently to others I am used to and I forgot to "Reply to all".

On my machine _gdal_array is a shared library module. It sounds like
there's a problem with the way GDAL (python bindings at least) is set
up on your cluster, because Python can't find this module.

I don't have any experience here, but if you go to a Python prompt and do

>>> import osgeo
>>> print(osgeo)

You should be able to work out where the GDAL bindings are installed
and then set up the paths for your cluster appropriately.

Cheers,
Scott

2009/7/20 Greg Fiske <gfiske@whrc.org>:
> Hi Scott - thanks very much for your response. ?It is probably obvious that
> I'm new to working with numpy and gdal.
>
> I am working with python 2.6 running gdal version 1.6 and numpy version
> 1.3.0 on a Linux RedHat cluster. ?When I run your code I get an error
> labeled: ?"ImportError: No module named _gdal_array"
>
> Have you seen this before? ?Any thoughts?
>
> Thanks and best regards,
>
> Greg
>
> -----Original Message-----
> From: Scott Sinclair [mailto:scott.sinclair.za@gmail.com]
> Sent: Monday, July 20, 2009 3:58 AM
> To: Greg Fiske
> Subject: Re: [gdal-dev] AttributeError: 'MaskedArray' object has no
> attribute 'typecode' -- when writing GeoTiff
>
>> 2009/7/17 Greg Fiske <gfiske@whrc.org>:
>> In python, I'm writing GeoTiff files from numpy arrays. ?I keep getting
> the
>> error:
>> AttributeError: 'MaskedArray' object has no attribute 'typecode'
>
> Hi Greg,
>
> What versions of the GDAL bindings and NumPy are you using?
>
> Perhaps your GDAL bindings don't have masked array support, you might
> try passing a view of the MaskedArray to WriteRaster() e.g.
> WriteRaster(dst_filename, d.view(type=np.ndarray)).
>
> The following standalone version of your example works for me with
> GDAL 1.6.1 and a recent SVN version of NumPy:
>
> -------------------------------------------------------
> import numpy as np
> import numpy.ma as ma
>
> try:
> ? ?from osgeo import gdal
> ? ?from osgeo import osr
> except ImportError:
> ? ?import gdal
> ? ?import osr
>
> def WriteRaster(dst_filename, raster):
> ? ?format = "GTiff"
> ? ?driver = gdal.GetDriverByName(format)
>
> ? ?ysize, xsize = raster.shape
>
> ? ?dst_ds = driver.Create(dst_filename, xsize, ysize, 1, gdal.GDT_Float32)
>
> ? ?srs = osr.SpatialReference()
> ? ?srs.ImportFromEPSG(4326) #WGS84 lat long.
> ? ?dst_ds.SetProjection(srs.ExportToWkt())
>
> ? ?dst_ds.GetRasterBand(1).WriteArray(raster)
> ? ?dst_ds = None
>
> fname = 'test.tif'
>
> stack_size = 3
> rows = 5
> cols = 5
>
> array_list = []
>
> for i in range(stack_size):
> ? ?a = np.arange(25, dtype=np.float32)
> ? ?a = a.reshape((rows, cols))
> ? ?a[i, 2] = -9999
>
> ? ?array_list.append(a)
>
> b = np.vstack([array_list])
> c = np.ma.masked_array(b, -9999)
> d = c.mean(axis=0)
>
> # default fill value is different from -9999
> ma.set_fill_value(d, -9999)
>
> WriteRaster(fname, d)
> -------------------------------------------------------
>
> I'm fairly sure that this doesn't do what you want though. The line 'c
> = np.ma.masked_array(b, -9999)' masks all the values in the array c
> and should probably be changed to 'c = np.ma.masked_values(b, -9999)'.
> See
> http://docs.scipy.org/doc/numpy/reference/generated/numpy.ma.masked_values.h
> tml
>
> To avoid other surprises, it's probably also worth checking that the
> data type in your call to driver.Create() matches the data type of the
> array you're trying to write.
>
> Cheers,
> Scott
>
>
From Gary.Smart at Goodrich.com  Tue Jul 21 03:38:14 2009
From: Gary.Smart at Goodrich.com (Smart, Gary)
Date: Tue Jul 21 03:38:19 2009
Subject: [gdal-dev] How do I open vector files (e.g. shp) using GDAL
In-Reply-To: <200907202303.22437.even.rouault@mines-paris.org>
References: <45D1B79D2DCCF34E966D24728765DDB3DF5E8B@nhc2ex11.goodrich.root.local>
	<200907202303.22437.even.rouault@mines-paris.org>
Message-ID: <45D1B79D2DCCF34E966D24728765DDB3DF5E94@nhc2ex11.goodrich.root.local>


Oh - I see.  I can open them now and wander through their layers and vector points.  Thank you.

I don't suppose there is a utility/convience function to 'rasterize' the information within a 2D vector file (e.g. vector map) by any chance (i.e. rather than drawing them using OpenGL or something)?

Gary

> -----Original Message-----
> From: Even Rouault [mailto:even.rouault@mines-paris.org]
> Sent: 20 July 2009 22:03
> To: gdal-dev@lists.osgeo.org
> Cc: Smart, Gary
> Subject: Re: [gdal-dev] How do I open vector files (e.g. shp) using GDAL
> 
> Le Monday 20 July 2009 22:51:13 Smart, Gary, vous avez ?crit?:
> > I understand that GDAL can open vector formats as if they were a
> > dataset?
> >
> 
> No, not exactly. GDAL is for the raster formats. OGR is for the vector
> formats. They have each their concepts, API and notions. See the OGR
> documentation : http://gdal.org/ogr/
> 
> >
> >
> > E.g. I read that it is possible to pass the GDALOpen either a single
> > .shp file (in which case it treats it as if it only had one layer) or a
> > directory containing multiple .shp files - which presumably it opens as
> > multi layered?
> >
> >
> >
> > However, whenever I try to open vector files in this way (directory or
> > file) I get...
> >
> >
> >
> > ERROR 4  - blah blah is not recognised as a supported file format"
> >
> >
> >
> > I am still new to all this (having only just conquered raster formats)
> > so I suspect I am doing something pretty dumb.
> >
> > Perhaps someone can help?
> >
> >
> >
> > Gary
> 

From Gary.Smart at Goodrich.com  Tue Jul 21 03:45:53 2009
From: Gary.Smart at Goodrich.com (Smart, Gary)
Date: Tue Jul 21 03:46:01 2009
Subject: [gdal-dev] Converting raster pixel space to geospace
In-Reply-To: <008501ca0983$702e51d0$508af570$@com>
References: <45D1B79D2DCCF34E966D24728765DDB3DF5A9B@nhc2ex11.goodrich.root.local>	<200907152213.31330.even.rouault@mines-paris.org>	<45D1B79D2DCCF34E966D24728765DDB3DF5BFA@nhc2ex11.goodrich.root.local>	<200907162043.39644.even.rouault@mines-paris.org>	<45D1B79D2DCCF34E966D24728765DDB3DF5E31@nhc2ex11.goodrich.root.local>	<000b01ca0940$c51ba280$4f52e780$@com>
	<45D1B79D2DCCF34E966D24728765DDB3DF5E50@nhc2ex11.goodrich.root.local>
	<005201ca095c$f7f76fb0$e7e64f10$@com>
	<45D1B79D2DCCF34E966D24728765DDB3DF5E89@nhc2ex11.goodrich.root.local>
	<008501ca0983$702e51d0$508af570$@com>
Message-ID: <45D1B79D2DCCF34E966D24728765DDB3DF5E97@nhc2ex11.goodrich.root.local>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: georef.c++
Type: application/octet-stream
Size: 3628 bytes
Desc: georef.c++
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090721/87028baa/georef-0001.obj
From P.Halls at york.ac.uk  Tue Jul 21 04:02:04 2009
From: P.Halls at york.ac.uk (Peter J Halls)
Date: Tue Jul 21 04:02:23 2009
Subject: [gdal-dev] How do I open vector files (e.g. shp) using GDAL
In-Reply-To: <45D1B79D2DCCF34E966D24728765DDB3DF5E94@nhc2ex11.goodrich.root.local>
References: <45D1B79D2DCCF34E966D24728765DDB3DF5E8B@nhc2ex11.goodrich.root.local>	<200907202303.22437.even.rouault@mines-paris.org>
	<45D1B79D2DCCF34E966D24728765DDB3DF5E94@nhc2ex11.goodrich.root.local>
Message-ID: <4A6575FC.1060909@york.ac.uk>

There is the GDAL rasterize method, however that is designed to translate vector 
polygons into raster representations.  Converting points to raster is a very 
simple task and does not really need a method; converting lines is slightly less 
trivial, however these are issues with regard to how to represent phenomena that 
have no width in a cellular environment which the user will need to consider.

Peter

Smart, Gary wrote:
> Oh - I see.  I can open them now and wander through their layers and vector points.  Thank you.
> 
> I don't suppose there is a utility/convience function to 'rasterize' the information within a 2D vector file (e.g. vector map) by any chance (i.e. rather than drawing them using OpenGL or something)?
> 
> Gary
> 
>> -----Original Message-----
>> From: Even Rouault [mailto:even.rouault@mines-paris.org]
>> Sent: 20 July 2009 22:03
>> To: gdal-dev@lists.osgeo.org
>> Cc: Smart, Gary
>> Subject: Re: [gdal-dev] How do I open vector files (e.g. shp) using GDAL
>>
>> Le Monday 20 July 2009 22:51:13 Smart, Gary, vous avez ?crit :
>>> I understand that GDAL can open vector formats as if they were a
>>> dataset?
>>>
>> No, not exactly. GDAL is for the raster formats. OGR is for the vector
>> formats. They have each their concepts, API and notions. See the OGR
>> documentation : http://gdal.org/ogr/
>>
>>>
>>> E.g. I read that it is possible to pass the GDALOpen either a single
>>> .shp file (in which case it treats it as if it only had one layer) or a
>>> directory containing multiple .shp files - which presumably it opens as
>>> multi layered?
>>>
>>>
>>>
>>> However, whenever I try to open vector files in this way (directory or
>>> file) I get...
>>>
>>>
>>>
>>> ERROR 4  - blah blah is not recognised as a supported file format"
>>>
>>>
>>>
>>> I am still new to all this (having only just conquered raster formats)
>>> so I suspect I am doing something pretty dumb.
>>>
>>> Perhaps someone can help?
>>>
>>>
>>>
>>> Gary
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
--------------------------------------------------------------------------------
Peter J Halls, GIS Advisor, University of York
Telephone: 01904 433806     Fax: 01904 433740
Snail mail: Computing Service, University of York, Heslington, York YO10 5DD
This message has the status of a private and personal communication
--------------------------------------------------------------------------------
From adam.fowler at actionfinder.co.uk  Tue Jul 21 06:27:16 2009
From: adam.fowler at actionfinder.co.uk (Adam Fowler)
Date: Tue Jul 21 06:27:19 2009
Subject: [gdal-dev] Ruby bindings and geotiff...
Message-ID: <154730e10907210327h2a025e65jcc7979a4b1213845@mail.gmail.com>

Hi All,

I'm trying to write a Ruby app to read the new and fantastic NASA
ASTER Elevation DEM. This is of course in GeoTiff format.

I'm wondering if anyone has examples in any language of using GDAL to
read a particular location's data from a geotiff file? I can do the
calculations to figure out which of the 3601x3601 data elements I need
to read is, but I can't find an example of using GDAL to load only
that pixel's information.

If anyone has an example that would be great.

I'm also having issues installing GDAL on OS X even when using
macports. I can build and install fine without the ruby bindings, but
using them (via editing the port file to include --with-ruby) gives
me:

libtool: link: /usr/bin/g++-4.0 gdal_wrap.o -o gdal.so
-L/opt/local/lib
-L/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib
-L/opt/local -L/usr/X11/lib
-L/opt/local/var/macports/build/_opt_local_var_macports_sources_rsync.macports.org_release_ports_science_gdal/work/gdal-1.6.0
/opt/local/lib/libgdal.dylib /opt/local/lib/libproj.dylib -lm
/opt/local/lib/libgif.dylib /opt/local/lib/libSM.dylib
/opt/local/lib/libICE.dylib /opt/local/lib/libX11.dylib
/opt/local/lib/libXau.dylib /opt/local/lib/libXdmcp.dylib -lgeotiff
/opt/local/lib/libtiff.dylib /opt/local/lib/libjpeg.dylib -lc
/opt/local/lib/libpng12.dylib -lz -ldl -lruby
Undefined symbols:
 "_main", referenced from:
    start in crt1.10.5.o
ld: symbol(s) not found
collect2: ld returned 1 exit status
make[3]: *** [gdal.so] Error 1
make[2]: *** [build] Error 2
make[1]: *** [build] Error 2
make: *** [swig-modules] Error 2

Error: Status 1 encountered during processing.

I'm assuming it can't find ruby to link to, but not quite sure how to
resolve this. Does --with-ruby have any extra undocumented options?

If I figure it out I'd be happy to add to the Ruby WIKI page - who
should I email to get access/contribute information?

Thanks in advance.

Regards,

Adam.
From warmerdam at pobox.com  Tue Jul 21 10:56:07 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue Jul 21 10:54:58 2009
Subject: [gdal-dev] FOSS4G Abstracts announced + Early Bird registration
	looming
In-Reply-To: <486f11580907200256l6a5dd10cj6845e17250f20719@mail.gmail.com>
References: <486f11580907200256l6a5dd10cj6845e17250f20719@mail.gmail.com>
Message-ID: <4A65D707.4090004@pobox.com>

FOSS4G Abstracts announced + Early Bird registration looming
Sydney, Australia. 20 July 2009. http://2009.foss4g.org

Abstracts Announced

A comprehensive list of presentations has been announced for the
international Free and Open Source Software for Geospatial conference,
in Sydney, Australia, 20-23 October 2009.

Abstracts presented by the world's best Developers, Policy Makers,
Sponsors and Geospatial Professionals include the latest geospatial
applications, standards, government programs, business processes and
case studies.

Topics include mobile platforms, location based applications, crowd
sourcing, cloud computing, development, spatial standards, integration
of cross-agency data, Spatial Data Infrastructures, Sensor Webs, Web
Processing Services, Integration of Open Source and Proprietary
Software and more.

For the full list of quality abstracts, view: http://2009.foss4g.org/presentations/

Community participation in the abstract selection was impressive, with
over 150 community members selecting 85 general track abstracts from
the 183 submitted and a further 12 academic abstracts selected by 52
academic peers.

Early Bird Registration

After getting inspired from the breadth of abstracts, be sure to
register for the FOSS4G conference. Early Bird registration closes in
just over two weeks, on 7 August, 2009. http://2009.foss4g.org/registration/

Upcoming milestones

7 Aug 2009, Early bird registration deadline
14 Sep 2009, Completed program available
20 Oct 2009, FOSS4G Workshop
21-23 Oct 2009, FOSS4G Presentations and Tutorials
24 Oct 2009, FOSS4G Code Sprint

Media Sponsors

Position Magazine: http://www.positionmag.com.au/
Asian Surveying and Mapping Newsletter: http://www.asmmag.com
Geoconnexions Magazine: http://www.geoconnexion.com/
Directions Magazine: http://directionsmag.com/
GIS Development: http://gisdevelopment.net/
Baliz Media: http://www.BALIZ-MEDIA.com/
For more information or to keep informed from the FOSS4G Organising
Committee, join our email list or twitter feed at: http://2009.foss4g.org/contacts/

or contact:

Cameron Shorter, Chair of the FOSS4G Organising Committee and
Geospatial Systems Architect at LISAsoft

tel +61-2-8570-5050

c a m e r o n . s h o r t e r @ l i s a s o f t . c o m

From Steve.Toutant at inspq.qc.ca  Tue Jul 21 11:38:28 2009
From: Steve.Toutant at inspq.qc.ca (Steve.Toutant@inspq.qc.ca)
Date: Tue Jul 21 11:38:41 2009
Subject: [gdal-dev] Messages: gdal_translate and gdal_rasterize
In-Reply-To: <4A60DE35.2080105@pobox.com>
Message-ID: <OFEE8E8B90.7FBB19AA-ON852575FA.00559699-852575FA.0055EB86@ssss.gouv.qc.ca>

Hello!!!
When I launch this command 
gdal_translate -projwin -428734.998712 20337 1.497532 -387578.449250 
172036.180727 EstMtl.img rssMtl.img

I get this message
Input file size is 7771, 7410
Computed -srcwin 1204 4838 1372 1045 from projected window.
0Warning 1: Lost metadata writing to GeoTIFF ... too large to fit in tag.
Warning 1: Lost metadata writing to GeoTIFF ... too large to fit in tag.
...10...20...30...40...50...60...70...80...90...100 - done.
Warning 1: Lost metadata writing to GeoTIFF ... too large to fit in tag.

When I launch this command 
gdal_rasterize -burn 0 -i -l rssMtl_32198 
Z:\MSSS\rssmrn\2005\shapefile\32198\rssMtl_32198.shp rssMtl.img

I get this message
Warning : the output raster dataset has a SRS, but the input vector layer 
not. Results will be probably incorrect.
0...10...20...30...40...50...60...70...80...90...100 - done.

The results seam ok. But should I care about these messages? Is there a 
parameter missing in my commands?

Thanks a lot for your help!!
Steve

Steve Toutant, M. Sc.
Analyste en g?omatique
Secteur environnement
Direction des risques biologiques, environnementaux et occupationnels
Institut national de sant? publique du Qu?bec
945, avenue Wolfe
Qu?bec, Qc G1V 5B3 
T?l.: (418) 650-5115 #5281
Fax.: (418) 654-3144
steve.toutant@inspq.qc.ca
http://www.inspq.qc.ca
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090721/6ee69483/attachment.html
From warmerdam at pobox.com  Tue Jul 21 11:53:52 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue Jul 21 11:52:41 2009
Subject: [gdal-dev] Messages: gdal_translate and gdal_rasterize
In-Reply-To: <OFEE8E8B90.7FBB19AA-ON852575FA.00559699-852575FA.0055EB86@ssss.gouv.qc.ca>
References: <OFEE8E8B90.7FBB19AA-ON852575FA.00559699-852575FA.0055EB86@ssss.gouv.qc.ca>
Message-ID: <4A65E490.1070803@pobox.com>

Steve.Toutant@inspq.qc.ca wrote:
> 
> Hello!!!
> When I launch this command
> gdal_translate -projwin -428734.998712 20337 1.497532 -387578.449250 
> 172036.180727 EstMtl.img rssMtl.img
> 
> I get this message
> Input file size is 7771, 7410
> Computed -srcwin 1204 4838 1372 1045 from projected window.
> 0Warning 1: Lost metadata writing to GeoTIFF ... too large to fit in tag.
> Warning 1: Lost metadata writing to GeoTIFF ... too large to fit in tag.
> ...10...20...30...40...50...60...70...80...90...100 - done.
> Warning 1: Lost metadata writing to GeoTIFF ... too large to fit in tag.

Steve,

First, you may not be aware that gdal_translate writes TIFF by default,
even if you use the extension .img.  So if you want a .img output you
would need to specify -of HFA on the commandline.

The warning indicates that there was too much metadata in the source
file to properly store in the GeoTIFF so it was discarded.  Often
this won't matter to you.

> When I launch this command
> gdal_rasterize -burn 0 -i -l rssMtl_32198 
> Z:\MSSS\rssmrn\2005\shapefile\32198\rssMtl_32198.shp rssMtl.img
> 
> I get this message
> Warning : the output raster dataset has a SRS, but the input vector 
> layer not. Results will be probably incorrect.
> 0...10...20...30...40...50...60...70...80...90...100 - done.

This means it is your responsibility to ensure that the shapefile
and the .img file are in the same coordinate system since the command
cannot determine it from the .shp file.  The warning is perhaps a bit
too dramatic.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From Steve.Toutant at inspq.qc.ca  Tue Jul 21 12:03:29 2009
From: Steve.Toutant at inspq.qc.ca (Steve.Toutant@inspq.qc.ca)
Date: Tue Jul 21 12:03:46 2009
Subject: [gdal-dev] Messages: gdal_translate and gdal_rasterize
In-Reply-To: <4A65E490.1070803@pobox.com>
Message-ID: <OFBE283710.44D69E1F-ON852575FA.0057DD5D-852575FA.005835DF@ssss.gouv.qc.ca>

Thanks Frank,
".... the command cannot determine it from the .shp file"
Why? Is it because the EPSG code of this .shp is unknown to GDAL or GDAL 
can't get any SRS from a .shp? 
Should I add the EPSG code somewhere in a configuration file?

Best regards,
Steve


Steve Toutant, M. Sc.
Analyste en g?omatique
Secteur environnement
Direction des risques biologiques, environnementaux et occupationnels
Institut national de sant? publique du Qu?bec
945, avenue Wolfe
Qu?bec, Qc G1V 5B3 
T?l.: (418) 650-5115 #5281
Fax.: (418) 654-3144
steve.toutant@inspq.qc.ca
http://www.inspq.qc.ca
 




Frank Warmerdam <warmerdam@pobox.com> 
21/07/2009 11:53 AM

A
Steve.Toutant@inspq.qc.ca
cc
gdal-dev@lists.osgeo.org
Objet
Re: [gdal-dev] Messages: gdal_translate and gdal_rasterize








Steve.Toutant@inspq.qc.ca wrote:
> 
> Hello!!!
> When I launch this command
> gdal_translate -projwin -428734.998712 20337 1.497532 -387578.449250 
> 172036.180727 EstMtl.img rssMtl.img
> 
> I get this message
> Input file size is 7771, 7410
> Computed -srcwin 1204 4838 1372 1045 from projected window.
> 0Warning 1: Lost metadata writing to GeoTIFF ... too large to fit in 
tag.
> Warning 1: Lost metadata writing to GeoTIFF ... too large to fit in tag.
> ...10...20...30...40...50...60...70...80...90...100 - done.
> Warning 1: Lost metadata writing to GeoTIFF ... too large to fit in tag.

Steve,

First, you may not be aware that gdal_translate writes TIFF by default,
even if you use the extension .img.  So if you want a .img output you
would need to specify -of HFA on the commandline.

The warning indicates that there was too much metadata in the source
file to properly store in the GeoTIFF so it was discarded.  Often
this won't matter to you.

> When I launch this command
> gdal_rasterize -burn 0 -i -l rssMtl_32198 
> Z:\MSSS\rssmrn\2005\shapefile\32198\rssMtl_32198.shp rssMtl.img
> 
> I get this message
> Warning : the output raster dataset has a SRS, but the input vector 
> layer not. Results will be probably incorrect.
> 0...10...20...30...40...50...60...70...80...90...100 - done.

This means it is your responsibility to ensure that the shapefile
and the .img file are in the same coordinate system since the command
cannot determine it from the .shp file.  The warning is perhaps a bit
too dramatic.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, 
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent




-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090721/c4e08ddb/attachment.html
From warmerdam at pobox.com  Tue Jul 21 12:14:39 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue Jul 21 12:13:29 2009
Subject: [gdal-dev] Messages: gdal_translate and gdal_rasterize
In-Reply-To: <OFBE283710.44D69E1F-ON852575FA.0057DD5D-852575FA.005835DF@ssss.gouv.qc.ca>
References: <OFBE283710.44D69E1F-ON852575FA.0057DD5D-852575FA.005835DF@ssss.gouv.qc.ca>
Message-ID: <4A65E96F.9070504@pobox.com>

Steve.Toutant@inspq.qc.ca wrote:
> 
> Thanks Frank,
> ".... the command cannot determine it from the .shp file"
> Why? Is it because the EPSG code of this .shp is unknown to GDAL or GDAL 
> can't get any SRS from a .shp?
> Should I add the EPSG code somewhere in a configuration file?

Steve,

Presumably it is because there is no .prj file with the .shp file.  This
is quite common.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From BCassanova at weather.com  Tue Jul 21 15:15:45 2009
From: BCassanova at weather.com (Cassanova, Bill)
Date: Tue Jul 21 15:15:48 2009
Subject: [gdal-dev] General Questions about gdal usage with Grib1 Data Set
In-Reply-To: <4A64CAE0.50306@pobox.com>
References: <1D5F4E64B8C04F4C868B94AC9A532AF80AB39EEB@ATLMAIL01.corp.weather.com>
	<4A64CAE0.50306@pobox.com>
Message-ID: <1D5F4E64B8C04F4C868B94AC9A532AF80AB3A367@ATLMAIL01.corp.weather.com>

There is now an additional wrinkle to the project.  We need to now
extract the 4 closest values for a given lat-lon point
to complete a bilinear interpolation for added accuracy.

Would the correct method be:

(1)  Use the suggestion that Frank made below about a hybrid approach to
my original (2).  From this value I can easily determine the 4 closest
neighbors in raster space.  Since I need to know the distance between my
original query point and these 4 corner points I could create a reverse
transformation and push the 4 corner points back through the reverse
transformation and extract the lat-lon to calculate distance.

It would seem as rich as GDAL is that there may be a better way to do
this but perhaps not.

In a second related question.  Has a book ever been produced by anyone
that describes "GDAL cookbook" type of solutions?  It would seem that
the type of question I am asking come up often and a book written to an
audience that includes both GIS professionals as well as general
programmers with limited GIS knowledge would be helpful.

Thanks,
Bill

-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: Monday, July 20, 2009 3:52 PM
To: Cassanova, Bill
Cc: gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] General Questions about gdal usage with Grib1
Data Set

Cassanova, Bill wrote:
> Hi,
> 
> I am new to GDal and just beginning to dig into the intricacies of the

> library and would like some guidance on the best way to proceed.
> 
> I have a data set that is in a grib1 format but with a Lambert
Conformal 
> Projection.  If need be this file can be converted to either grib2 or 
> shape file using an application called degrib.
> 
> My task is given this data-set I need to be able to extract values
from 
> the file for a given lat-lon and don't necessarily want to code the 
> intricacies of the Lambert-Conformal-SP2 projection.  So in other
words 
> given a lat-lon of 38.59, - 97.61 I want to be able to interrogate the

> raster and extract a value for that given coordinate.
> 
> There seem to be a few options and just need advice from the season
GDAL 
> guru's of the best way to proceed:
> 
> (1)     Convert the lambert-conformal grib1 to a cylindrical
equidistant 
> grib1 or tiff using gdalwarp and do the simpler ratio based math on
the 
> rectangular grid as opposed to the projected grid.
> 
> (2)     Use OGRCreateCoordinateTransformation specifying the source as

> Lambert Conformal and the destination as cylindrical equidistant.  My 
> presumption at this point is that the 
> OGRCoordinateTransformation->Transform( 1, &x, &y ) method call could 
> take a longitude as the x-argument, and latitude as the y-argument.  A

> successful transform call would replace the original lat-lon with the 
> new lat-lon and from this point the data grid ( I, J ) offsets could
be 
> calculated using simply ratios.
> 
> (3)     Are they any more direct simpler ways of accomplishing the
same 
> thing? 

Bill,

I would suggest a variation on (2).  You can call
GDALCreateGenImgProjTransformer to create a transformer from image
pixel/line
to long/lat.  The call is:

void CPL_DLL *
GDALCreateGenImgProjTransformer( GDALDatasetH hSrcDS, const char
*pszSrcWKT,
                                  GDALDatasetH hDstDS, const char
*pszDstWKT,
                                  int bGCPUseOK, double
dfGCPErrorThreshold,
                                  int nOrder );

But you can leave the hDstDS as NULL, and provide the WGS84 pszDstWKT
yourself.  If the source file coordinate system is already known by GDAL
(check gdalinfo report) then you could leave pszSrcWKT NULL and it will
be picked up from the dataset.  The bGCPUseOK can be FALSE, and the
GCPErrorThreshold 0.0, and nOrder 0.

The pointer you get back can be used with GDALGenImgProjTransform():

int CPL_DLL GDALGenImgProjTransform(
     void *pTransformArg, int bDstToSrc, int nPointCount,
     double *x, double *y, double *z, int *panSuccess );

In your case you want to pass in long/lat, and get back image
pixel/line so you would pass bDstToSrc=TRUE.

This approach is somewhat easier than OGRCreateCoordinateTransformation
because the GenImgProj stuff knows also how to apply the geotransform
step.

Best regards,
-- 
---------------------------------------+--------------------------------
------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From adeel.raza at crc.gc.ca  Tue Jul 21 15:17:23 2009
From: adeel.raza at crc.gc.ca (Adeel Raza)
Date: Tue Jul 21 15:16:56 2009
Subject: [gdal-dev] Problem closing VRT GDALDataset *
Message-ID: <4A661443.2020203@crc.gc.ca>

Hi,

I 'm using the GDALAutoCreateWarpedVRT() function to warp a MEM 
GDALDataset. When I use the GDALClose() function to close the source 
(MEM) dataset nothing happens. However, when I close the warped (VRT) 
dataset using GDALClose() I get the following error:
"Unhandled exception at 0x01226b6e in Import Routine Test.exe: 
0xC0000005: Access violation writing location 0x238dd369."
What could be going wrong?

Best Regards,
Adeel Raza.

From warmerdam at pobox.com  Tue Jul 21 15:48:12 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue Jul 21 15:46:55 2009
Subject: [gdal-dev] General Questions about gdal usage with Grib1 Data Set
In-Reply-To: <1D5F4E64B8C04F4C868B94AC9A532AF80AB3A367@ATLMAIL01.corp.weather.com>
References: <1D5F4E64B8C04F4C868B94AC9A532AF80AB39EEB@ATLMAIL01.corp.weather.com>
	<4A64CAE0.50306@pobox.com>
	<1D5F4E64B8C04F4C868B94AC9A532AF80AB3A367@ATLMAIL01.corp.weather.com>
Message-ID: <4A661B7C.6030907@pobox.com>

Cassanova, Bill wrote:
> There is now an additional wrinkle to the project.  We need to now
> extract the 4 closest values for a given lat-lon point
> to complete a bilinear interpolation for added accuracy.
> 
> Would the correct method be:
> 
> (1)  Use the suggestion that Frank made below about a hybrid approach to
> my original (2).  From this value I can easily determine the 4 closest
> neighbors in raster space.  Since I need to know the distance between my
> original query point and these 4 corner points I could create a reverse
> transformation and push the 4 corner points back through the reverse
> transformation and extract the lat-lon to calculate distance.

Bill,

Normally you would transform your one sample point back to source
raster space, and use that to identify the four nearest pixels.
But you can normally interpolate based on the distance in raster
space, so there should be no need to forward transform those points.

For instance, if the location transforms back to (5.25,7.0) in source
raster space you would want pixels (4,6), (5,6), (4,7), (5,7).  For
distance purposes the location of a pixel is it's center so, for instance,
the (4,6) pixel is really at (4.5,6.5) and the distance in x would be
0.75, and in y would be 0.5), etc.

> It would seem as rich as GDAL is that there may be a better way to do
> this but perhaps not.
> 
> In a second related question.  Has a book ever been produced by anyone
> that describes "GDAL cookbook" type of solutions?  It would seem that
> the type of question I am asking come up often and a book written to an
> audience that includes both GIS professionals as well as general
> programmers with limited GIS knowledge would be helpful.

There are a few books with some material on GDAL.  Tyler's Web Mapping
Illustrated and Gary's Desktop GIS book come to mind. But I believe they
are both focused on the commandline tools, not the programming api.

Sometimes the samples directories for the different scripting languages
can be a good source of programming ideas.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Tue Jul 21 15:54:55 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue Jul 21 15:53:40 2009
Subject: [gdal-dev] Problem closing VRT GDALDataset *
In-Reply-To: <4A661443.2020203@crc.gc.ca>
References: <4A661443.2020203@crc.gc.ca>
Message-ID: <4A661D0F.1040602@pobox.com>

Adeel Raza wrote:
> Hi,
> 
> I 'm using the GDALAutoCreateWarpedVRT() function to warp a MEM 
> GDALDataset. When I use the GDALClose() function to close the source 
> (MEM) dataset nothing happens. However, when I close the warped (VRT) 
> dataset using GDALClose() I get the following error:
> "Unhandled exception at 0x01226b6e in Import Routine Test.exe: 
> 0xC0000005: Access violation writing location 0x238dd369."
> What could be going wrong?

Adeel,

I believe the problem is that the MEM dataset is getting destroyed twice.

GDALAutoCreateWarpedVRT() adds a reference to the passed in dataset to
indicate that something other than the main application code is also using
that dataset.  But the GDALClose() will close it regardless of additional
references.

The safer way is:

     if( GDALDeferenceDataset( hMemDS ) == 0 )
         GDALClose( hMemDS );


In your particular case you know the VRT will hold a reference, so it would
be sufficient for you to drop your reference on the dataset using
GDALDereferenceDataset().

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From BCassanova at weather.com  Tue Jul 21 16:08:35 2009
From: BCassanova at weather.com (Cassanova, Bill)
Date: Tue Jul 21 16:08:38 2009
Subject: [gdal-dev] General Questions about gdal usage with Grib1 Data Set
In-Reply-To: <4A661B7C.6030907@pobox.com>
References: <1D5F4E64B8C04F4C868B94AC9A532AF80AB39EEB@ATLMAIL01.corp.weather.com>
	<4A64CAE0.50306@pobox.com>
	<1D5F4E64B8C04F4C868B94AC9A532AF80AB3A367@ATLMAIL01.corp.weather.com>
	<4A661B7C.6030907@pobox.com>
Message-ID: <1D5F4E64B8C04F4C868B94AC9A532AF80AB3A3B5@ATLMAIL01.corp.weather.com>

I had considered that but was a little concerned about accuracy.  So for
example:

Original lat-lon point --> -77.78, 36.01
Extracted i-j          --> 1015.63, 404.964

The 4 closest are the ceil/floor of both so:
1015 and 1016 for X and 404 and 405 for Y. 

However, the resolution of the data is 12km.  So.  It would seem more
accurate to reverse transform the 1015 and 1016 and 404 and 405
Back to lat-lon, and then determine separation in degrees as opposed to
rounded off mid-points in raster space.  Does this make sense or is my
relative newness to GIS beginning to show?

Regardless it seems like what I am suggesting should be possible is I
set up the backward projection correctly...Right?



-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: Tuesday, July 21, 2009 3:48 PM
To: Cassanova, Bill
Cc: gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] General Questions about gdal usage with Grib1
Data Set

Cassanova, Bill wrote:
> There is now an additional wrinkle to the project.  We need to now
> extract the 4 closest values for a given lat-lon point
> to complete a bilinear interpolation for added accuracy.
> 
> Would the correct method be:
> 
> (1)  Use the suggestion that Frank made below about a hybrid approach
to
> my original (2).  From this value I can easily determine the 4 closest
> neighbors in raster space.  Since I need to know the distance between
my
> original query point and these 4 corner points I could create a
reverse
> transformation and push the 4 corner points back through the reverse
> transformation and extract the lat-lon to calculate distance.

Bill,

Normally you would transform your one sample point back to source
raster space, and use that to identify the four nearest pixels.
But you can normally interpolate based on the distance in raster
space, so there should be no need to forward transform those points.

For instance, if the location transforms back to (5.25,7.0) in source
raster space you would want pixels (4,6), (5,6), (4,7), (5,7).  For
distance purposes the location of a pixel is it's center so, for
instance,
the (4,6) pixel is really at (4.5,6.5) and the distance in x would be
0.75, and in y would be 0.5), etc.

> It would seem as rich as GDAL is that there may be a better way to do
> this but perhaps not.
> 
> In a second related question.  Has a book ever been produced by anyone
> that describes "GDAL cookbook" type of solutions?  It would seem that
> the type of question I am asking come up often and a book written to
an
> audience that includes both GIS professionals as well as general
> programmers with limited GIS knowledge would be helpful.

There are a few books with some material on GDAL.  Tyler's Web Mapping
Illustrated and Gary's Desktop GIS book come to mind. But I believe they
are both focused on the commandline tools, not the programming api.

Sometimes the samples directories for the different scripting languages
can be a good source of programming ideas.

Best regards,
-- 
---------------------------------------+--------------------------------
------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From adeel.raza at crc.gc.ca  Tue Jul 21 16:13:53 2009
From: adeel.raza at crc.gc.ca (Adeel Raza)
Date: Tue Jul 21 16:13:24 2009
Subject: [gdal-dev] Problem closing VRT GDALDataset *
In-Reply-To: <4A661D0F.1040602@pobox.com>
References: <4A661443.2020203@crc.gc.ca> <4A661D0F.1040602@pobox.com>
Message-ID: <4A662181.3020001@crc.gc.ca>

Hi Frank,

Thanks for the help. It seems like you were correct. When I dereference 
the MEM dataset the post-decrement reference count is not 0. My question 
is: do I not close the MEM dataset since its reference count is not 0?

Best Regards,
Adeel Raza.

Frank Warmerdam wrote:
> Adeel Raza wrote:
>> Hi,
>>
>> I 'm using the GDALAutoCreateWarpedVRT() function to warp a MEM 
>> GDALDataset. When I use the GDALClose() function to close the source 
>> (MEM) dataset nothing happens. However, when I close the warped (VRT) 
>> dataset using GDALClose() I get the following error:
>> "Unhandled exception at 0x01226b6e in Import Routine Test.exe: 
>> 0xC0000005: Access violation writing location 0x238dd369."
>> What could be going wrong?
>
> Adeel,
>
> I believe the problem is that the MEM dataset is getting destroyed twice.
>
> GDALAutoCreateWarpedVRT() adds a reference to the passed in dataset to
> indicate that something other than the main application code is also 
> using
> that dataset.  But the GDALClose() will close it regardless of additional
> references.
>
> The safer way is:
>
>     if( GDALDeferenceDataset( hMemDS ) == 0 )
>         GDALClose( hMemDS );
>
>
> In your particular case you know the VRT will hold a reference, so it 
> would
> be sufficient for you to drop your reference on the dataset using
> GDALDereferenceDataset().
>
> Best regards,

From warmerdam at pobox.com  Tue Jul 21 16:19:31 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue Jul 21 16:18:25 2009
Subject: [gdal-dev] General Questions about gdal usage with Grib1 Data Set
In-Reply-To: <1D5F4E64B8C04F4C868B94AC9A532AF80AB3A3B5@ATLMAIL01.corp.weather.com>
References: <1D5F4E64B8C04F4C868B94AC9A532AF80AB39EEB@ATLMAIL01.corp.weather.com>
	<4A64CAE0.50306@pobox.com>
	<1D5F4E64B8C04F4C868B94AC9A532AF80AB3A367@ATLMAIL01.corp.weather.com>
	<4A661B7C.6030907@pobox.com>
	<1D5F4E64B8C04F4C868B94AC9A532AF80AB3A3B5@ATLMAIL01.corp.weather.com>
Message-ID: <4A6622D3.2040402@pobox.com>

Cassanova, Bill wrote:
> I had considered that but was a little concerned about accuracy.  So for
> example:
> 
> Original lat-lon point --> -77.78, 36.01
> Extracted i-j          --> 1015.63, 404.964
> 
> The 4 closest are the ceil/floor of both so:
> 1015 and 1016 for X and 404 and 405 for Y. 
> 
> However, the resolution of the data is 12km.  So.  It would seem more
> accurate to reverse transform the 1015 and 1016 and 404 and 405
> Back to lat-lon, and then determine separation in degrees as opposed to
> rounded off mid-points in raster space.  Does this make sense or is my
> relative newness to GIS beginning to show?

Bill,

I don't see that the distances are likely to be more meaningful
in decimal degrees than in pixels.  If you wanted to do something
really accurate you would need to compute the distances in a locally
accurate projected coordinate system.

> Regardless it seems like what I am suggesting should be possible is I
> set up the backward projection correctly...Right?

Yes

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Tue Jul 21 16:31:46 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue Jul 21 16:30:32 2009
Subject: [gdal-dev] Problem closing VRT GDALDataset *
In-Reply-To: <4A662181.3020001@crc.gc.ca>
References: <4A661443.2020203@crc.gc.ca> <4A661D0F.1040602@pobox.com>
	<4A662181.3020001@crc.gc.ca>
Message-ID: <4A6625B2.6020708@pobox.com>

Adeel Raza wrote:
> Hi Frank,
> 
> Thanks for the help. It seems like you were correct. When I dereference 
> the MEM dataset the post-decrement reference count is not 0. My question 
> is: do I not close the MEM dataset since its reference count is not 0?

Adeel,

You should not be closing the MEM dataset while it is still referenced
by the VRT dataset.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From adeel.raza at crc.gc.ca  Tue Jul 21 16:50:10 2009
From: adeel.raza at crc.gc.ca (Adeel Raza)
Date: Tue Jul 21 16:49:39 2009
Subject: [gdal-dev] Problem closing VRT GDALDataset *
In-Reply-To: <4A6625B2.6020708@pobox.com>
References: <4A661443.2020203@crc.gc.ca> <4A661D0F.1040602@pobox.com>
	<4A662181.3020001@crc.gc.ca> <4A6625B2.6020708@pobox.com>
Message-ID: <4A662A02.5070004@crc.gc.ca>

Hi Frank,

OK - my next question then is: If I close the VRT dataset if it 
references the MEM dataset using GDALClose(), would that operation also 
close the MEM dataset or would I need to close the MEM dataset after I 
close the VRT dataset?

Best Regards,
Adeel.

Frank Warmerdam wrote:
> Adeel Raza wrote:
>> Hi Frank,
>>
>> Thanks for the help. It seems like you were correct. When I 
>> dereference the MEM dataset the post-decrement reference count is not 
>> 0. My question is: do I not close the MEM dataset since its reference 
>> count is not 0?
>
> Adeel,
>
> You should not be closing the MEM dataset while it is still referenced
> by the VRT dataset.
>
> Best regards,

From even.rouault at mines-paris.org  Tue Jul 21 17:55:15 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue Jul 21 17:55:26 2009
Subject: [gdal-dev] Problem closing VRT GDALDataset *
In-Reply-To: <4A662A02.5070004@crc.gc.ca>
References: <4A661443.2020203@crc.gc.ca> <4A6625B2.6020708@pobox.com>
	<4A662A02.5070004@crc.gc.ca>
Message-ID: <200907212355.16642.even.rouault@mines-paris.org>

Le Tuesday 21 July 2009 22:50:10 Adeel Raza, vous avez ?crit?:
> Hi Frank,
>
> OK - my next question then is: If I close the VRT dataset if it
> references the MEM dataset using GDALClose(), would that operation also
> close the MEM dataset

It depends if you drop the reference on the MEM dataset before or after 
closing the VRT.
GDALAutoCreateWarpedVRT() took an extra reference on the MEM dataset, so the 
GDALClose() on this VRT will drop the extra reference on the MEM dataset. If 
there's no more reference on it, it will be closed, otherwise you'll have to 
do it yourself afterwards

> or would I need to close the MEM dataset after I 
> close the VRT dataset?

The order of closing doesn't matter provided you do as Frank suggested before.

So you can use safely one of the 2 below possible solutions :

hMemDS = GDALCreate(...);
hVRTDS = GDALAutoCreateWarpedVRT(hMEMDS, ...) ; // now refcount(hMemDS) == 2
if( GDALDereferenceDataset(hMemDS ) == 0 ) // now refcount(hMemDS) == 1
? ? ? ? ?GDALClose( hMemDS ); // won't be executed in fact
GDALClose(hVRTDS); // will drop the remaining ref on hMemDS and take care of 
closing it

or invert the order of the last 2 operations :

hMemDS = GDALCreate(...);
hVRTDS = GDALAutoCreateWarpedVRT(hMemDS, ...) ; // now refcount(hMemDS) == 2
GDALClose(hVRTDS); // now refcount(hMemDS) == 1
if( GDALDereferenceDataset(hMemDS ) == 0 ) // now refcount(hMemDS) == 0
         GDALClose( hMemDS ); // will be executed
>
> Best Regards,
> Adeel.
>
> Frank Warmerdam wrote:
> > Adeel Raza wrote:
> >> Hi Frank,
> >>
> >> Thanks for the help. It seems like you were correct. When I
> >> dereference the MEM dataset the post-decrement reference count is not
> >> 0. My question is: do I not close the MEM dataset since its reference
> >> count is not 0?
> >
> > Adeel,
> >
> > You should not be closing the MEM dataset while it is still referenced
> > by the VRT dataset.
> >
> > Best regards,
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From jason.roberts at duke.edu  Tue Jul 21 20:57:35 2009
From: jason.roberts at duke.edu (Jason Roberts)
Date: Tue Jul 21 20:57:43 2009
Subject: [gdal-dev] Reading ArcInfo binary grids with the R rgdal package
	fails with "GDAL Error 3: Attempt to read past EOF in ..../arc.dir"
Message-ID: <008601ca0a67$67db1240$379136c0$@roberts@duke.edu>

I have some R code that reads ArcInfo binary grids using the rgdal package.
This code has worked for a long time. Now, with the latest versions of
everything it is failing with the message:

 

GDAL Error 3: Attempt to read past EOF in
C:\Temp\GeoEcoTemp_Jason\tmphrgwuo\projected0/../info/arc.dir.

 

A transcript of the R session appears below, showing the version numbers of
everything. The grids were generated by ArcGIS 9.3.1. I have not tried with
other versions of ArcGIS (I suspect that ESRI hasn't changed this code in a
while).

 

Note that there are several grids stored in the directory and rgdal can read
some of them but not others. The first one that failed, projected0, can be
read by gdalinfo 1.6.0. I do not have gdalinfo 1.6.1 because I could not
locate prebuilt Windows binaries for it. If somebody has them, I can try
again with 1.6.1.

 

Because my code has worked for a long time and I haven't changed it, I
suspect a bug in either rgdal or gdal itself. Can you advise me on how to
follow up with this?

 

I can provide a zipped copy of the directory containing the rasters
(probably 1 MB zipped). 

 

Thanks,

Jason

 

Here is the R transcript:

 

R version 2.9.1 (2009-06-26)

Copyright (C) 2009 The R Foundation for Statistical Computing

ISBN 3-900051-07-0

 

R is free software and comes with ABSOLUTELY NO WARRANTY.

You are welcome to redistribute it under certain conditions.

Type 'license()' or 'licence()' for distribution details.

 

  Natural language support but running in an English locale

 

R is a collaborative project with many contributors.

Type 'contributors()' for more information and

'citation()' on how to cite R or R packages in publications.

 

Type 'demo()' for some demos, 'help()' for on-line help, or

'help.start()' for an HTML browser interface to help.

Type 'q()' to quit R.

 

> utils:::menuInstallPkgs()

--- Please select a CRAN mirror for use in this session ---

also installing the dependency 'sp'

 

trying URL
'http://cran.cnr.Berkeley.edu/bin/windows/contrib/2.9/sp_0.9-43.zip'

Content type 'application/zip' length 869722 bytes (849 Kb)

opened URL

downloaded 849 Kb

 

trying URL
'http://cran.cnr.Berkeley.edu/bin/windows/contrib/2.9/rgdal_0.6-10.zip'

Content type 'application/zip' length 7767149 bytes (7.4 Mb)

opened URL

downloaded 7.4 Mb

 

package 'sp' successfully unpacked and MD5 sums checked

package 'rgdal' successfully unpacked and MD5 sums checked

 

The downloaded packages are in

        C:\Users\Jason\AppData\Local\Temp\RtmpbhzZ6p\downloaded_packages

updating HTML package descriptions

> library(rgdal)

Loading required package: sp

Geospatial Data Abstraction Library extensions to R successfully loaded

Loaded GDAL runtime: GDAL 1.6.1, released 2009/05/11

Path to GDAL shared files: C:/PROGRA~1/R/R-29~1.1/library/rgdal/gdal

Loaded PROJ.4 runtime: Rel. 4.6.1, 21 August 2008

Path to PROJ.4 shared files: C:/PROGRA~1/R/R-29~1.1/library/rgdal/proj

> rasterInfo <-
open.SpatialGDAL("C:\\Temp\\GeoEcoTemp_Jason\\tmphrgwuo\\projected0")

Error in .local(.Object, ...) : 

        GDAL Error 3: Attempt to read past EOF in
C:\Temp\GeoEcoTemp_Jason\tmphrgwuo\projected0/../info/arc.dir.

> traceback()

7: .Call("RGDAL_OpenDataset", as.character(filename), TRUE, PACKAGE =
"rgdal")

6: .local(.Object, ...)

5: initialize(value, ...)

4: initialize(value, ...)

3: new("GDALReadOnlyDataset", filename)

2: GDAL.open(con, read.only = TRUE)

1: open.SpatialGDAL("C:\\Temp\\GeoEcoTemp_Jason\\tmphrgwuo\\projected0")

> rasterInfo <-
open.SpatialGDAL("C:\\Temp\\GeoEcoTemp_Jason\\tmphrgwuo\\projected0a")

Error in .local(.Object, ...) : 

        GDAL Error 3: Attempt to read past EOF in
C:\Temp\GeoEcoTemp_Jason\tmphrgwuo\projected0a/../info/arc.dir.

> rasterInfo <-
open.SpatialGDAL("C:\\Temp\\GeoEcoTemp_Jason\\tmphrgwuo\\projected2")

C:\Temp\GeoEcoTemp_Jason\tmphrgwuo\projected2 has GDAL driver AIG 

and has 157 rows and 96 columns

> rasterInfo <-
open.SpatialGDAL("C:\\Temp\\GeoEcoTemp_Jason\\tmphrgwuo\\projected2a")

C:\Temp\GeoEcoTemp_Jason\tmphrgwuo\projected2a has GDAL driver AIG 

and has 156 rows and 96 columns

> rasterInfo <-
open.SpatialGDAL("C:\\Temp\\GeoEcoTemp_Jason\\tmphrgwuo\\clipped1")

Error in .local(.Object, ...) : 

        GDAL Error 3: Attempt to read past EOF in
C:\Temp\GeoEcoTemp_Jason\tmphrgwuo\clipped1/../info/arc.dir.

> rasterInfo <-
open.SpatialGDAL("C:\\Temp\\GeoEcoTemp_Jason\\tmphrgwuo\\clipped1a")

Error in .local(.Object, ...) : 

        GDAL Error 3: Attempt to read past EOF in
C:\Temp\GeoEcoTemp_Jason\tmphrgwuo\clipped1a/../info/arc.dir.

> 

 

But gdalinfo 1.6.0 can successfully open projected0:

 

Microsoft Windows [Version 6.0.6001]

Copyright (c) 2006 Microsoft Corporation.  All rights reserved.

 

C:\Users\Jason>C:\Temp2\gdalwin32-1.6\bin\gdalinfo
C:\Temp\GeoEcoTemp_Jason\tmphrgwuo\projected0

Driver: AIG/Arc/Info Binary Grid

Files: C:\Temp\GeoEcoTemp_Jason\tmphrgwuo\projected0

       C:\Temp\GeoEcoTemp_Jason\tmphrgwuo\projected0.aux

       C:\Temp\GeoEcoTemp_Jason\tmphrgwuo\projected0\dblbnd.adf

       C:\Temp\GeoEcoTemp_Jason\tmphrgwuo\projected0\hdr.adf

       C:\Temp\GeoEcoTemp_Jason\tmphrgwuo\projected0\metadata.xml

       C:\Temp\GeoEcoTemp_Jason\tmphrgwuo\projected0\prj.adf

       C:\Temp\GeoEcoTemp_Jason\tmphrgwuo\projected0\sta.adf

       C:\Temp\GeoEcoTemp_Jason\tmphrgwuo\projected0\w001001.adf

       C:\Temp\GeoEcoTemp_Jason\tmphrgwuo\projected0\w001001x.adf

Size is 96, 157

Coordinate System is:

GEOGCS["WGS 84",

    DATUM["WGS_1984",

        SPHEROID["WGS 84",6378137,298.257223563,

            AUTHORITY["EPSG","7030"]],

        TOWGS84[0,0,0,0,0,0,0],

        AUTHORITY["EPSG","6326"]],

    PRIMEM["Greenwich",0,

        AUTHORITY["EPSG","8901"]],

    UNIT["degree",0.0174532925199433,

        AUTHORITY["EPSG","9108"]],

    AUTHORITY["EPSG","4326"]]

Origin = (-81.000000000000000,39.000000000000028)

Pixel Size = (0.083333333333333,-0.083333333333333)

Corner Coordinates:

Upper Left  ( -81.0000000,  39.0000000)

Lower Left  ( -81.0000000,  25.9166667)

Upper Right ( -73.0000000,  39.0000000)

Lower Right ( -73.0000000,  25.9166667)

Center      ( -77.0000000,  32.4583333)

Band 1 Block=256x4 Type=Float32, ColorInterp=Undefined

  Min=6.375 Max=34.800

  NoData Value=-3.4028234663852886e+038

  Metadata:

    LAYER_TYPE=athematic

 

C:\Users\Jason>C:\Temp2\gdalwin32-1.6\bin\gdalinfo --version

GDAL 1.6.0, released 2008/12/04

 

C:\Users\Jason>

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090721/5d265246/attachment-0001.html
From pintj at hotmail.com  Tue Jul 21 23:28:32 2009
From: pintj at hotmail.com (Trent Pingenot)
Date: Tue Jul 21 23:29:35 2009
Subject: [gdal-dev] PG Driver for OGR 1.6
Message-ID: <BAY105-W28C33FAA67B62E29D79680A61B0@phx.gbl>


Hello,

I'm looking for the gdalplugin (ogr_PG.dll) for OGR for the PostGres/PostGIS for OGR 1.6 for Windows. I had a copy before for an older version, but have upgraded to 1.6 and can't seem to find one in the usual places.

I had looked here 

http://download.osgeo.org/gdal/win32/1.6/

but don't see it, is there somewhere else it would live on the osgeo site.

Thanks in advance.

Trent


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090721/ae2aa224/attachment.html
From neteler at osgeo.org  Wed Jul 22 08:57:53 2009
From: neteler at osgeo.org (Markus Neteler)
Date: Wed Jul 22 08:57:56 2009
Subject: [gdal-dev] Reading ArcInfo binary grids with the R rgdal package 
	fails with "GDAL Error 3: Attempt to read past EOF in ..../arc.dir"
In-Reply-To: <4548079684472807206@unknownmsgid>
References: <4548079684472807206@unknownmsgid>
Message-ID: <86782b610907220557i47c157b4ka8265c7bdcf1fe0a@mail.gmail.com>

On Wed, Jul 22, 2009 at 2:57 AM, Jason Roberts<jason.roberts@duke.edu> wrote:
> I have some R code that reads ArcInfo binary grids using the rgdal package.
> This code has worked for a long time. Now, with the latest versions of
> everything it is failing with the message:
>
>
>
> GDAL Error 3: Attempt to read past EOF in
> C:\Temp\GeoEcoTemp_Jason\tmphrgwuo\projected0/../info/arc.dir.
>

I have the same problem (Linux). Apparently it is no real problem,
the data appear to be complete. However, it would be nicer to not see
such an error message :)

See also
http://trac.osgeo.org/gdal/ticket/2447
http://trac.osgeo.org/gdal/ticket/3031

Markus
From jason.roberts at duke.edu  Wed Jul 22 09:19:05 2009
From: jason.roberts at duke.edu (Jason Roberts)
Date: Wed Jul 22 09:19:10 2009
Subject: [gdal-dev] Reading ArcInfo binary grids with the R rgdal
	package	fails with "GDAL Error 3: Attempt to read past EOF in
	..../arc.dir"
In-Reply-To: <86782b610907220557i47c157b4ka8265c7bdcf1fe0a@mail.gmail.com>
References: <4548079684472807206@unknownmsgid>
	<86782b610907220557i47c157b4ka8265c7bdcf1fe0a@mail.gmail.com>
Message-ID: <00c601ca0ace$fd1c46f0$f754d4d0$@roberts@duke.edu>

Markus - thanks for the links to those tickets. Those tickets seem to imply
this is a minor annoyance. Unfortunately, for me, it means I can't read the
grids at all from R. Perhaps if I was using the C interface there would be a
workaround (just ignore the error?) but this is not possible using the R
interface, as far as I can tell. For example, the rgdal GDAL.open API fails
with the same message.

Is the right solution to get the rgdal developers to code a workaround to
ignore the error somehow? Or is it to determine the underlying problem in
GDAL? Or perhaps ESRI is generating grids that violate the AIG format
specification?

Thanks again,
Jason

-----Original Message-----
From: neteler.osgeo@gmail.com [mailto:neteler.osgeo@gmail.com] On Behalf Of
Markus Neteler
Sent: Wednesday, July 22, 2009 8:58 AM
To: Jason Roberts
Cc: gdal-dev
Subject: Re: [gdal-dev] Reading ArcInfo binary grids with the R rgdal
package fails with "GDAL Error 3: Attempt to read past EOF in ..../arc.dir"

On Wed, Jul 22, 2009 at 2:57 AM, Jason Roberts<jason.roberts@duke.edu>
wrote:
> I have some R code that reads ArcInfo binary grids using the rgdal
package.
> This code has worked for a long time. Now, with the latest versions of
> everything it is failing with the message:
>
>
>
> GDAL Error 3: Attempt to read past EOF in
> C:\Temp\GeoEcoTemp_Jason\tmphrgwuo\projected0/../info/arc.dir.
>

I have the same problem (Linux). Apparently it is no real problem,
the data appear to be complete. However, it would be nicer to not see
such an error message :)

See also
http://trac.osgeo.org/gdal/ticket/2447
http://trac.osgeo.org/gdal/ticket/3031

Markus

From mdekauwe at gmail.com  Wed Jul 22 09:35:01 2009
From: mdekauwe at gmail.com (mdekauwe)
Date: Wed Jul 22 09:35:02 2009
Subject: [Gdal-dev] compiling gdal - error with lib check
Message-ID: <1248269701835-3303130.post@n2.nabble.com>


 Hi,

Would anyone be able to point me in the direction of a solution to my build
error on Solaris?

gmake libgdal.la
gmake[1]: Entering directory `gdal-1.6.0'
gmake[1]: *** No rule to make target `gdal-1.6.0/frmts/o/*.lo', needed by
`libgdal.la'.  Stop.
gmake[1]: Leaving directory `gdal-1.6.0'
gmake: *** [check-lib] Error 2

I have no idea why it doesn't know how to build the libraries, any
suggestions would be much appreciated!!

Thanks

Martin
-- 
View this message in context: http://n2.nabble.com/compiling-gdal---error-with-lib-check-tp3303130p3303130.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From gfiske at whrc.org  Wed Jul 22 10:31:12 2009
From: gfiske at whrc.org (Greg Fiske)
Date: Wed Jul 22 10:30:34 2009
Subject: [gdal-dev] RE: Python bindings on RedHat cluster
	(was:AttributeError: 'MaskedArray' object has no attribute
	'typecode' -- when writing GeoTiff)
In-Reply-To: <20090721061426.2CFA0E01744@lists.osgeo.org>
References: <20090721061426.2CFA0E01744@lists.osgeo.org>
Message-ID: <003801ca0ad9$100bcbf0$302363d0$@org>

Scott - indeed, it turned out to be permissions issue with the module
gdal_array on our cluster. 

Thanks and best regards,

Greg

-----Original Message-----

Date: Tue, 21 Jul 2009 08:14:05 +0200
From: Scott Sinclair <scott.sinclair.za@gmail.com>
Subject: Re: [gdal-dev] Python bindings on RedHat cluster (was:
	AttributeError: 'MaskedArray' object has no attribute 'typecode' --
	when writing GeoTiff)
To: gdal-dev@lists.osgeo.org
Cc: Greg Fiske <gfiske@whrc.org>

Hi Greg,

It's always a good idea to communicate via the list, there are more
eyes and skills there. The conversations are also publicly archived,
making it easier for others having similar problems to search for
help.

In this case, the mistake is mine, I see that this list behaves
differently to others I am used to and I forgot to "Reply to all".

On my machine _gdal_array is a shared library module. It sounds like
there's a problem with the way GDAL (python bindings at least) is set
up on your cluster, because Python can't find this module.

I don't have any experience here, but if you go to a Python prompt and do

>>> import osgeo
>>> print(osgeo)

You should be able to work out where the GDAL bindings are installed
and then set up the paths for your cluster appropriately.

Cheers,
Scott



From matt.gregory at oregonstate.edu  Wed Jul 22 12:09:28 2009
From: matt.gregory at oregonstate.edu (Gregory, Matthew)
Date: Wed Jul 22 12:09:31 2009
Subject: [gdal-dev] Reading ArcInfo binary grids with the R
	rgdalpackage	fails with "GDAL Error 3: Attempt to read past EOF
	in..../arc.dir"
In-Reply-To: <00c601ca0ace$fd1c46f0$f754d4d0$@roberts@duke.edu>
References: <4548079684472807206@unknownmsgid><86782b610907220557i47c157b4ka8265c7bdcf1fe0a@mail.gmail.com>
	<00c601ca0ace$fd1c46f0$f754d4d0$@roberts@duke.edu>
Message-ID: <451453C181B199458A55B2B1723FAC000260D181@SAGE.forestry.oregonstate.edu>

Hi Jason,

Jason Roberts wrote:
> Markus - thanks for the links to those tickets. Those tickets 
> seem to imply this is a minor annoyance. Unfortunately, for 
> me, it means I can't read the grids at all from R. Perhaps if 
> I was using the C interface there would be a workaround (just 
> ignore the error?) but this is not possible using the R 
> interface, as far as I can tell. For example, the rgdal 
> GDAL.open API fails with the same message.

I was one of the people that wrote up a ticket on this.  Ironically, it
looks like it was a bug fix that Even implemented (rev. 16460) that
allowed the INFO directory to be read correctly (so that the VAT is
read), which exposed the source of these errors.  

> Is the right solution to get the rgdal developers to code a 
> workaround to ignore the error somehow? Or is it to determine 
> the underlying problem in GDAL? Or perhaps ESRI is generating 
> grids that violate the AIG format specification?

I hadn't worked with this outside of the C interface, but I'm noticing
now that the same problems crop up in the Python bindings:

  >>> from osgeo import gdal
  >>> ds = gdal.Open("D:/matt/vat_test/grid1")
  ERROR 3: Attempt to read past EOF in
D:/matt/vat_test/grid1/../info/../grid1/vat
  .adf.
  >>> type(ds)
  <type 'NoneType'>

So it seems like either all bindings need to silently ignore this error
or have it fixed in the GDAL source.  I'll admit that my understanding
of what really needs to happen is often shaky ...

matt
From jason.roberts at duke.edu  Wed Jul 22 13:14:40 2009
From: jason.roberts at duke.edu (Jason Roberts)
Date: Wed Jul 22 13:14:44 2009
Subject: [gdal-dev] Reading ArcInfo binary grids with the R
	rgdalpackage	fails with "GDAL Error 3: Attempt to read past EOF
	in..../arc.dir"
In-Reply-To: <451453C181B199458A55B2B1723FAC000260D181@SAGE.forestry.oregonstate.edu>
References: <4548079684472807206@unknownmsgid>
	<86782b610907220557i47c157b4ka8265c7bdcf1fe0a@mail.gmail.com>
	<00c601ca0ace$fd1c46f0$f754d4d0$%roberts@duke.edu>
	<451453C181B199458A55B2B1723FAC000260D181@SAGE.forestry.oregonstate.edu>
Message-ID: <001d01ca0aef$e6663580$b332a080$@roberts@duke.edu>

Thanks Matt, that is very interesting to know that the Python bindings fail
with the same problem. Which version of GDAL are you using with the Python
bindings?

> So it seems like either all bindings need to silently ignore this error
> or have it fixed in the GDAL source.

Even and other GDAL devs, can you advise us on this?

Thanks,

Jason

-----Original Message-----
From: Gregory, Matthew [mailto:matt.gregory@oregonstate.edu] 
Sent: Wednesday, July 22, 2009 12:09 PM
To: Jason Roberts
Cc: gdal-dev
Subject: RE: [gdal-dev] Reading ArcInfo binary grids with the R rgdalpackage
fails with "GDAL Error 3: Attempt to read past EOF in..../arc.dir"

Hi Jason,

Jason Roberts wrote:
> Markus - thanks for the links to those tickets. Those tickets 
> seem to imply this is a minor annoyance. Unfortunately, for 
> me, it means I can't read the grids at all from R. Perhaps if 
> I was using the C interface there would be a workaround (just 
> ignore the error?) but this is not possible using the R 
> interface, as far as I can tell. For example, the rgdal 
> GDAL.open API fails with the same message.

I was one of the people that wrote up a ticket on this.  Ironically, it
looks like it was a bug fix that Even implemented (rev. 16460) that
allowed the INFO directory to be read correctly (so that the VAT is
read), which exposed the source of these errors.  

> Is the right solution to get the rgdal developers to code a 
> workaround to ignore the error somehow? Or is it to determine 
> the underlying problem in GDAL? Or perhaps ESRI is generating 
> grids that violate the AIG format specification?

I hadn't worked with this outside of the C interface, but I'm noticing
now that the same problems crop up in the Python bindings:

  >>> from osgeo import gdal
  >>> ds = gdal.Open("D:/matt/vat_test/grid1")
  ERROR 3: Attempt to read past EOF in
D:/matt/vat_test/grid1/../info/../grid1/vat
  .adf.
  >>> type(ds)
  <type 'NoneType'>

So it seems like either all bindings need to silently ignore this error
or have it fixed in the GDAL source.  I'll admit that my understanding
of what really needs to happen is often shaky ...

matt

From even.rouault at mines-paris.org  Wed Jul 22 13:42:52 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Jul 22 13:43:04 2009
Subject: [gdal-dev] Reading ArcInfo binary grids with the R
	=?iso-8859-1?q?rgdalpackage=09fails_with?= "GDAL Error 3:
	Attempt to read past EOF in..../arc.dir"
In-Reply-To: <451453C181B199458A55B2B1723FAC000260D181@SAGE.forestry.oregonstate.edu>
References: <4548079684472807206@unknownmsgid>
	<00c601ca0ace$fd1c46f0$f754d4d0$@roberts@duke.edu>
	<451453C181B199458A55B2B1723FAC000260D181@SAGE.forestry.oregonstate.edu>
Message-ID: <200907221942.53262.even.rouault@mines-paris.org>

Le Wednesday 22 July 2009 18:09:28 Gregory, Matthew, vous avez ?crit?:
> Hi Jason,
>
> Jason Roberts wrote:
> > Markus - thanks for the links to those tickets. Those tickets
> > seem to imply this is a minor annoyance. Unfortunately, for
> > me, it means I can't read the grids at all from R. Perhaps if
> > I was using the C interface there would be a workaround (just
> > ignore the error?) but this is not possible using the R
> > interface, as far as I can tell. For example, the rgdal
> > GDAL.open API fails with the same message.
>
> I was one of the people that wrote up a ticket on this.  Ironically, it
> looks like it was a bug fix that Even implemented (rev. 16460) that
> allowed the INFO directory to be read correctly (so that the VAT is
> read), which exposed the source of these errors.

Yeah, exactly... 

>
> > Is the right solution to get the rgdal developers to code a
> > workaround to ignore the error somehow? Or is it to determine
> > the underlying problem in GDAL? Or perhaps ESRI is generating
> > grids that violate the AIG format specification?
>
> I hadn't worked with this outside of the C interface, but I'm noticing
>
> now that the same problems crop up in the Python bindings:
>   >>> from osgeo import gdal
>   >>> ds = gdal.Open("D:/matt/vat_test/grid1")
>
>   ERROR 3: Attempt to read past EOF in
> D:/matt/vat_test/grid1/../info/../grid1/vat
>   .adf.
>
>   >>> type(ds)
>
>   <type 'NoneType'>
>
> So it seems like either all bindings need to silently ignore this error
> or have it fixed in the GDAL source.  I'll admit that my understanding
> of what really needs to happen is often shaky ...

I've pushed in trunk (r17430) and branches/1.6 (r17431) a workaround to enable 
users to open those datasets that trigger the error with binding languages. 
As Open() in swig/include/gdal.i checks that there is no failure returned by 
CPLGetLastErrorType() even if the dataset is not NULL, the workaround is just 
to reset the error state before returning the dataset.

For people affected by the issue, not being able to build GDAL from source and 
not interested in the raster attribute table, they can just rename the 'info' 
directory, so it won't be read at all and won't trigger the error.

See http://trac.osgeo.org/gdal/ticket/3031

>
> matt
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From matt.gregory at oregonstate.edu  Wed Jul 22 14:17:43 2009
From: matt.gregory at oregonstate.edu (Gregory, Matthew)
Date: Wed Jul 22 14:17:47 2009
Subject: [gdal-dev] Reading ArcInfo binary grids with the R
	rgdalpackage	fails with "GDAL Error 3: Attempt to read past EOF
	in..../arc.dir"
In-Reply-To: <200907221942.53262.even.rouault@mines-paris.org>
References: <4548079684472807206@unknownmsgid>
	<00c601ca0ace$fd1c46f0$f754d4d0$@roberts@duke.edu>
	<451453C181B199458A55B2B1723FAC000260D181@SAGE.forestry.oregonstate.edu>
	<200907221942.53262.even.rouault@mines-paris.org>
Message-ID: <451453C181B199458A55B2B1723FAC000260D18D@SAGE.forestry.oregonstate.edu>

Hi Even,

Even Rouault wrote:
> I've pushed in trunk (r17430) and branches/1.6 (r17431) a 
> workaround to enable users to open those datasets that 
> trigger the error with binding languages. 
> As Open() in swig/include/gdal.i checks that there is no 
> failure returned by
> CPLGetLastErrorType() even if the dataset is not NULL, the 
> workaround is just to reset the error state before returning 
> the dataset.

Thanks much, Even.  I've tested at r17432 and it seems to work for
Python:

  >>> from osgeo import gdal
  >>> ds = gdal.Open('D:/matt/vat_test/grid1')
  >>> type(ds)
  <class 'osgeo.gdal.Dataset'>
  >>> rb = ds.GetRasterBand(1)
  >>> rat = rb.GetDefaultRAT()
  ERROR 3: Attempt to read past EOF in 
  D:/matt/vat_test/grid1/../info/../grid1/vat.adf.
  >>> rat.GetRowCount()
  1280
  >>> rat.GetColumnCount()
  2
  >>> rat.GetValueAsInt(4, 1)
  72134

By the way, having RAT (VAT) support for AIG datasets is just great.
Thanks so much for implementing the initial fix.
 
> For people affected by the issue, not being able to build 
> GDAL from source and not interested in the raster attribute 
> table, they can just rename the 'info' 
> directory, so it won't be read at all and won't trigger the error.
> 
> See http://trac.osgeo.org/gdal/ticket/3031

Um, this makes me really nervous to advocate renaming the INFO
directory, but maybe I'm overreacting.  I think your recent fix of not
calling ReadRAT() in AIGDataset::Open() eliminates this workaround,
correct?  Just as long as the user doesn't call GetDefaultRAT()?

matt
From even.rouault at mines-paris.org  Wed Jul 22 14:24:51 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Jul 22 14:25:01 2009
Subject: [gdal-dev] Reading ArcInfo binary grids with the R
	=?iso-8859-1?q?rgdalpackage=09fails_with?= "GDAL Error 3:
	Attempt to read past EOF in..../arc.dir"
In-Reply-To: <451453C181B199458A55B2B1723FAC000260D18D@SAGE.forestry.oregonstate.edu>
References: <4548079684472807206@unknownmsgid>
	<200907221942.53262.even.rouault@mines-paris.org>
	<451453C181B199458A55B2B1723FAC000260D18D@SAGE.forestry.oregonstate.edu>
Message-ID: <200907222024.52302.even.rouault@mines-paris.org>

Le Wednesday 22 July 2009 20:17:43 Gregory, Matthew, vous avez ?crit?:
>
> > For people affected by the issue, not being able to build
> > GDAL from source and not interested in the raster attribute
> > table, they can just rename the 'info'
> > directory, so it won't be read at all and won't trigger the error.
> >
> > See http://trac.osgeo.org/gdal/ticket/3031
>
> Um, this makes me really nervous to advocate renaming the INFO
> directory, but maybe I'm overreacting. 

This is just a workaround for people stuck with a version affected by the 
issue.

> I think your recent fix of not 
> calling ReadRAT() in AIGDataset::Open() eliminates this workaround,
> correct?

The workaround is still there, but yeah, the latest change in trunk makes it 
more or less useless. 

> Just as long as the user doesn't call GetDefaultRAT()? 

There's no point trying to read the RAT until it is really needed. And the 
entry point for it is GetDefaultRAT(), hence the late opening of the RAT 
through the AVC driver in this method.

>
> matt


From jason.roberts at duke.edu  Wed Jul 22 14:53:31 2009
From: jason.roberts at duke.edu (Jason Roberts)
Date: Wed Jul 22 14:53:36 2009
Subject: [gdal-dev] Reading ArcInfo binary grids with the
	R	rgdalpackage	fails with "GDAL Error 3:	Attempt to read past
	EOF in..../arc.dir"
In-Reply-To: <200907222024.52302.even.rouault@mines-paris.org>
References: <4548079684472807206@unknownmsgid>
	<200907221942.53262.even.rouault@mines-paris.org>
	<451453C181B199458A55B2B1723FAC000260D18D@SAGE.forestry.oregonstate.edu>
	<200907222024.52302.even.rouault@mines-paris.org>
Message-ID: <003501ca0afd$b6225f30$22671d90$@roberts@duke.edu>

It sounds like you have figured out the problem. Is now the moment that I
should contact the rgdal developers and ask them to build rgdal against the
1.6 branch?

Currently it looks like rgdal is built against the 1.6.1 release. I'm not
sure if they'll want to build against the current 1.6 branch or want to wait
until 1.6.2. Do you know when 1.6.2 might be issued?

Jason

-----Original Message-----
From: gdal-dev-bounces@lists.osgeo.org
[mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Even Rouault
Sent: Wednesday, July 22, 2009 2:25 PM
To: Gregory, Matthew
Cc: gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] Reading ArcInfo binary grids with the R rgdalpackage
fails with "GDAL Error 3: Attempt to read past EOF in..../arc.dir"

Le Wednesday 22 July 2009 20:17:43 Gregory, Matthew, vous avez ?crit?:
>
> > For people affected by the issue, not being able to build
> > GDAL from source and not interested in the raster attribute
> > table, they can just rename the 'info'
> > directory, so it won't be read at all and won't trigger the error.
> >
> > See http://trac.osgeo.org/gdal/ticket/3031
>
> Um, this makes me really nervous to advocate renaming the INFO
> directory, but maybe I'm overreacting. 

This is just a workaround for people stuck with a version affected by the 
issue.

> I think your recent fix of not 
> calling ReadRAT() in AIGDataset::Open() eliminates this workaround,
> correct?

The workaround is still there, but yeah, the latest change in trunk makes it

more or less useless. 

> Just as long as the user doesn't call GetDefaultRAT()? 

There's no point trying to read the RAT until it is really needed. And the 
entry point for it is GetDefaultRAT(), hence the late opening of the RAT 
through the AVC driver in this method.

>
> matt


_______________________________________________
gdal-dev mailing list
gdal-dev@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at mines-paris.org  Wed Jul 22 15:06:38 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Jul 22 15:06:48 2009
Subject: [gdal-dev] Reading ArcInfo binary grids with the
	=?iso-8859-1?q?R=09rgdalpackage=09fails_with?= "GDAL Error
	=?iso-8859-1?q?3=3A=09Attempt_to_read_past_EOF?= in..../arc.dir"
In-Reply-To: <003501ca0afd$b6225f30$22671d90$@roberts@duke.edu>
References: <4548079684472807206@unknownmsgid>
	<200907222024.52302.even.rouault@mines-paris.org>
	<003501ca0afd$b6225f30$22671d90$@roberts@duke.edu>
Message-ID: <200907222106.38629.even.rouault@mines-paris.org>

Le Wednesday 22 July 2009 20:53:31 Jason Roberts, vous avez ?crit?:
> It sounds like you have figured out the problem. Is now the moment that I
> should contact the rgdal developers and ask them to build rgdal against the
> 1.6 branch?

It's up to them. I don't know what their policy is. I doubt though that they 
would build against an unreleased version.

>
> Currently it looks like rgdal is built against the 1.6.1 release. I'm not
> sure if they'll want to build against the current 1.6 branch or want to
> wait until 1.6.2.

> Do you know when 1.6.2 might be issued? 

No, nothing planned for the moment AFAIK

>
> Jason
>
> -----Original Message-----
> From: gdal-dev-bounces@lists.osgeo.org
> [mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Even Rouault
> Sent: Wednesday, July 22, 2009 2:25 PM
> To: Gregory, Matthew
> Cc: gdal-dev@lists.osgeo.org
> Subject: Re: [gdal-dev] Reading ArcInfo binary grids with the R
> rgdalpackage fails with "GDAL Error 3: Attempt to read past EOF
> in..../arc.dir"
>
> Le Wednesday 22 July 2009 20:17:43 Gregory, Matthew, vous avez ?crit?:
> > > For people affected by the issue, not being able to build
> > > GDAL from source and not interested in the raster attribute
> > > table, they can just rename the 'info'
> > > directory, so it won't be read at all and won't trigger the error.
> > >
> > > See http://trac.osgeo.org/gdal/ticket/3031
> >
> > Um, this makes me really nervous to advocate renaming the INFO
> > directory, but maybe I'm overreacting.
>
> This is just a workaround for people stuck with a version affected by the
> issue.
>
> > I think your recent fix of not
> > calling ReadRAT() in AIGDataset::Open() eliminates this workaround,
> > correct?
>
> The workaround is still there, but yeah, the latest change in trunk makes
> it
>
> more or less useless.
>
> > Just as long as the user doesn't call GetDefaultRAT()?
>
> There's no point trying to read the RAT until it is really needed. And the
> entry point for it is GetDefaultRAT(), hence the late opening of the RAT
> through the AVC driver in this method.
>
> > matt
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From Roger.Bivand at nhh.no  Wed Jul 22 16:16:33 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed Jul 22 16:16:36 2009
Subject: [Gdal-dev] Reading ArcInfo binary grids with the R	rgdalpackage
	fails with "GDAL Error 3:	Attempt to read past EOF in..../arc.dir"
In-Reply-To: <200907222106.38629.even.rouault@mines-paris.org>
References: <86782b610907220557i47c157b4ka8265c7bdcf1fe0a@mail.gmail.com>
	<00c601ca0ace$fd1c46f0$f754d4d0$@roberts@duke.edu>
	<451453C181B199458A55B2B1723FAC000260D181@SAGE.forestry.oregonstate.edu>
	<200907221942.53262.even.rouault@mines-paris.org>
	<451453C181B199458A55B2B1723FAC000260D18D@SAGE.forestry.oregonstate.edu>
	<200907222024.52302.even.rouault@mines-paris.org>
	<003501ca0afd$b6225f30$22671d90$@roberts@duke.edu>
	<200907222106.38629.even.rouault@mines-paris.org>
Message-ID: <1248293793635-3305575.post@n2.nabble.com>


Comments inline below:


Even Rouault wrote:
> 
> Le Wednesday 22 July 2009 20:53:31 Jason Roberts, vous avez ?crit?:
>> It sounds like you have figured out the problem. Is now the moment that I
>> should contact the rgdal developers and ask them to build rgdal against
>> the
>> 1.6 branch?
> 
> It's up to them. I don't know what their policy is. I doubt though that
> they 
> would build against an unreleased version.
> 
> "Comment RSB - Right. Windows 32-bit users who are not able to build their
> GDAL, or to build rgdal from source against either FWTools or OSGEO4W DLLs
> are provided with an automatic build using DLLs for GDAL, PROJ, and lately
> EXPAT produced locally under MSYS. I would prefer not to have to build a
> one-off MSYS version of the DLLs against an unreleased GDAL, because other
> commits may have broken other things."
> 
>>
>> Currently it looks like rgdal is built against the 1.6.1 release. I'm not
>> sure if they'll want to build against the current 1.6 branch or want to
>> wait until 1.6.2.
> 
>> Do you know when 1.6.2 might be issued? 
> 
> No, nothing planned for the moment AFAIK
> 
> "Comment RSB - The failure is happening in the very simple function
> RGDAL_OpenDataset() at line 408 in:
> 
> http://rgdal.cvs.sourceforge.net/viewvc/rgdal/rgdal/src/gdal-bindings.cpp?revision=1.32&view=markup
> 
> calling (GDALDataset *) GDALOpen. If there was a way to trap the error by
> passing some setting out before the GDALOpen call, I could do that. The
> alternative is for Jason to build rgdal from source against some other
> GDAL, PROJ, and EXPAT DLLs as suggested in the README.windows file in the
> package until 1.6.2 or the next released version."
> 
> Roger
> 
> 
>>
>> Jason
>>
>> -----Original Message-----
>> From: gdal-dev-bounces@lists.osgeo.org
>> [mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Even Rouault
>> Sent: Wednesday, July 22, 2009 2:25 PM
>> To: Gregory, Matthew
>> Cc: gdal-dev@lists.osgeo.org
>> Subject: Re: [gdal-dev] Reading ArcInfo binary grids with the R
>> rgdalpackage fails with "GDAL Error 3: Attempt to read past EOF
>> in..../arc.dir"
>>
>> Le Wednesday 22 July 2009 20:17:43 Gregory, Matthew, vous avez ?crit?:
>> > > For people affected by the issue, not being able to build
>> > > GDAL from source and not interested in the raster attribute
>> > > table, they can just rename the 'info'
>> > > directory, so it won't be read at all and won't trigger the error.
>> > >
>> > > See http://trac.osgeo.org/gdal/ticket/3031
>> >
>> > Um, this makes me really nervous to advocate renaming the INFO
>> > directory, but maybe I'm overreacting.
>>
>> This is just a workaround for people stuck with a version affected by the
>> issue.
>>
>> > I think your recent fix of not
>> > calling ReadRAT() in AIGDataset::Open() eliminates this workaround,
>> > correct?
>>
>> The workaround is still there, but yeah, the latest change in trunk makes
>> it
>>
>> more or less useless.
>>
>> > Just as long as the user doesn't call GetDefaultRAT()?
>>
>> There's no point trying to read the RAT until it is really needed. And
>> the
>> entry point for it is GetDefaultRAT(), hence the late opening of the RAT
>> through the AVC driver in this method.
>>
>> > matt
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 


-----
Roger Bivand
Economic Geography Section
Department of Economics
Norwegian School of Economics and Business Administration
Helleveien 30
N-5045 Bergen, Norway

-- 
View this message in context: http://n2.nabble.com/Re%3A-Reading-ArcInfo-binary-grids-with-the-R-rgdal-package--fails-with-%22GDAL-Error-3%3A-Attempt-to-read-past-EOF-in-....-arc.dir%22-tp3302915p3305575.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From jorge.arevalo at gmail.com  Wed Jul 22 19:01:59 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Wed Jul 22 19:02:21 2009
Subject: [gdal-dev] Precission problem with atof
Message-ID: <cb4457700907221601ye87d073u6e0765964dfb5216@mail.gmail.com>

Hello,

Context: GDAL WKT Raster Driver

While creating the Dataset, I execute this query:

SELECT srid, ST_AsText(extent), pixelsize_x, pixelsize_y, blocksize_x,
blocksize_y FROM raster_columns WHERE r_table_name = 'table' AND
r_column = 'rast'

I have loaded a 3-band tiff file with gdal2tiles. Its pixel size is
0.9. If I execute this line (over the result of the previous query):

 fPixelSizeX = atof(PQgetvalue(hPGresult, 0, 2));

I get 0.899999976158142 instead of 0.9.

The string obtained wiht PQgetvalue is "0.9", but, for any reason,
atof transform this string in 0.899999976158142.  So, seems to be a
precission problem. think the string used by atof has any problem, but
I'm not sure. Oh, if I execute double f = atof("0.9") f is 0.9000002
(obtained in gdb).

What should I do? I tried to change atof(nptr) for strtod(nptr,
(char**)NULL), but it didn't work...

Thanks in advance
Jorge
From nowak at xpam.de  Wed Jul 22 19:17:25 2009
From: nowak at xpam.de (Adam Nowacki)
Date: Wed Jul 22 19:17:34 2009
Subject: [gdal-dev] Precission problem with atof
In-Reply-To: <cb4457700907221601ye87d073u6e0765964dfb5216@mail.gmail.com>
References: <cb4457700907221601ye87d073u6e0765964dfb5216@mail.gmail.com>
Message-ID: <4A679E05.6040203@xpam.de>

Jorge Ar?valo wrote:
>  fPixelSizeX = atof(PQgetvalue(hPGresult, 0, 2));
> 
> I get 0.899999976158142 instead of 0.9.

0.899999976158142... is the value closest to 0.9 that a single precision 
float variable can store.
Using 'double' should give 0.90000000000000002220...

From BCassanova at weather.com  Wed Jul 22 19:23:07 2009
From: BCassanova at weather.com (Cassanova, Bill)
Date: Wed Jul 22 19:23:54 2009
Subject: [gdal-dev] Grib1 DataSet Oddities
References: <1D5F4E64B8C04F4C868B94AC9A532AF80AB39EEB@ATLMAIL01.corp.weather.com>
	<4A64CAE0.50306@pobox.com>
	<1D5F4E64B8C04F4C868B94AC9A532AF80AB3A367@ATLMAIL01.corp.weather.com>
	<4A661B7C.6030907@pobox.com>
	<1D5F4E64B8C04F4C868B94AC9A532AF80AB3A3B5@ATLMAIL01.corp.weather.com>
	<4A6622D3.2040402@pobox.com>
Message-ID: <1D5F4E64B8C04F4C868B94AC9A532AF809B1A0DE@ATLMAIL01.corp.weather.com>

 
Hi All,
 
I have an oddity when trying to read a grib1 dataset.
 
When I extract the data using code:
 
 hBand = GDALGetRasterBand(hSrcDS, 1 );
 float *pafScanline;
 int   nXSize = GDALGetRasterBandXSize( hBand );
 pafScanline = (float *) CPLMalloc(sizeof(float)*nXSize);
 GDALRasterIO( hBand, GF_Read, 0, 0, nXSize, 1,
                      pafScanline, nXSize, 1, GDT_Float32,
                      0, 0 );
 
 for( int j = 0; j < nXSize; j++ )
        std::cout << pafScanline[j] << std::endl;
 
I am seeing values that are along the lines of:
12.86
12.802
12.734
12.671
12.562
12.425
12.241
12.12
12.043
12.035
11.986
11.917
11.83
11.776
 
The same grib1 file when dumped using wgrib produces values ( degrees Kelvin ):
295.552
295.565
295.577
295.589
295.6
295.61
295.619
295.626
295.633
295.639
 
As an additional piece of information when I use the same above code and extract values that are less that 1 the values are appearing correct.  It is almost as if there is some sort of scaling issue
with values greater than 1.  
 
I have tried changing the pafScanline to a double and made the appropriate GDT_Float64 changes to GDALRasterIO and I get the same results.
 
Am I missing something fundamental here?
 
Thanks,
Bill

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090722/536ce21e/attachment.html
From jorge.arevalo at gmail.com  Wed Jul 22 19:30:29 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Wed Jul 22 19:30:51 2009
Subject: [gdal-dev] Precission problem with atof
In-Reply-To: <4A679E05.6040203@xpam.de>
References: <cb4457700907221601ye87d073u6e0765964dfb5216@mail.gmail.com> 
	<4A679E05.6040203@xpam.de>
Message-ID: <cb4457700907221630na17382dpd8f3a6f3f237d8e7@mail.gmail.com>

Hello,

2009/7/23 Adam Nowacki <nowak@xpam.de>:
> Jorge Ar?valo wrote:
>>
>> ?fPixelSizeX = atof(PQgetvalue(hPGresult, 0, 2));
>>
>> I get 0.899999976158142 instead of 0.9.
>
> 0.899999976158142... is the value closest to 0.9 that a single precision
> float variable can store.
> Using 'double' should give 0.90000000000000002220...
>

Wow, How could I be so stupid... I defined pixel size as float... I'm
gonna correct it and test again.

Many thanks!

Best regards
Jorge
From mateusz at loskot.net  Wed Jul 22 19:40:54 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Jul 22 19:41:23 2009
Subject: [gdal-dev] Precission problem with atof
In-Reply-To: <cb4457700907221601ye87d073u6e0765964dfb5216@mail.gmail.com>
References: <cb4457700907221601ye87d073u6e0765964dfb5216@mail.gmail.com>
Message-ID: <44062.90.211.11.4.1248306054.squirrel@loskot.net>

Jorge Ar??valo wrote::
> Hello,
>
> Context: GDAL WKT Raster Driver
>
> While creating the Dataset, I execute this query:
>
> SELECT srid, ST_AsText(extent), pixelsize_x, pixelsize_y, blocksize_x,
> blocksize_y FROM raster_columns WHERE r_table_name = 'table' AND
> r_column = 'rast'
>
> I have loaded a 3-band tiff file with gdal2tiles. Its pixel size is
> 0.9. If I execute this line (over the result of the previous query):
>
>  fPixelSizeX = atof(PQgetvalue(hPGresult, 0, 2));
>
> I get 0.899999976158142 instead of 0.9.

Good.

> The string obtained wiht PQgetvalue is "0.9", but, for any reason,
> atof transform this string in 0.899999976158142.

http://docs.sun.com/source/806-3568/ncg_goldberg.html

> So, seems to be a
> precission problem. think the string used by atof has any problem, but
> I'm not sure

Most computers suffer of this problem.

> What should I do?

You need to learn how to live with that problem :-)

> I tried to change atof(nptr) for strtod(nptr,
> (char**)NULL), but it didn't work...

And it won't help.

Best regards,
-- 
Mateusz Loskot
http://mateusz.loskot.net

From jorge.arevalo at gmail.com  Wed Jul 22 19:57:21 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Wed Jul 22 19:57:43 2009
Subject: [gdal-dev] Precission problem with atof
In-Reply-To: <44062.90.211.11.4.1248306054.squirrel@loskot.net>
References: <cb4457700907221601ye87d073u6e0765964dfb5216@mail.gmail.com> 
	<44062.90.211.11.4.1248306054.squirrel@loskot.net>
Message-ID: <cb4457700907221657m48763ed4s9346684f5cc8d754@mail.gmail.com>

Hello Mateusz,

2009/7/23 Mateusz Loskot <mateusz@loskot.net>:
> Jorge Ar??valo wrote::
>> Hello,
>>
>> Context: GDAL WKT Raster Driver
>>
>> While creating the Dataset, I execute this query:
>>
>> SELECT srid, ST_AsText(extent), pixelsize_x, pixelsize_y, blocksize_x,
>> blocksize_y FROM raster_columns WHERE r_table_name = 'table' AND
>> r_column = 'rast'
>>
>> I have loaded a 3-band tiff file with gdal2tiles. Its pixel size is
>> 0.9. If I execute this line (over the result of the previous query):
>>
>> ?fPixelSizeX = atof(PQgetvalue(hPGresult, 0, 2));
>>
>> I get 0.899999976158142 instead of 0.9.
>
> Good.
>
>> The string obtained wiht PQgetvalue is "0.9", but, for any reason,
>> atof transform this string in 0.899999976158142.
>
> http://docs.sun.com/source/806-3568/ncg_goldberg.html
>
>> So, seems to be a
>> precission problem. think the string used by atof has any problem, but
>> I'm not sure
>
> Most computers suffer of this problem.
>
>> What should I do?
>
> You need to learn how to live with that problem :-)
>
>> I tried to change atof(nptr) for strtod(nptr,
>> (char**)NULL), but it didn't work...
>
> And it won't help.
>
> Best regards,
> --
> Mateusz Loskot
> http://mateusz.loskot.net
>
>

Yes, a stupid problem. I used float instead of double.

Actually, last year at university, I had a similar problem, but adding
really small numbers to a big one. I should remember this kind of
things. Normally, I remember them just after clicking on "Send"
button... :-)

I'm very sorry. And many thanks for the link!

Best regards
Jorge
From mateusz at loskot.net  Wed Jul 22 20:17:28 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Jul 22 20:17:54 2009
Subject: [gdal-dev] Precission problem with atof
In-Reply-To: <cb4457700907221657m48763ed4s9346684f5cc8d754@mail.gmail.com>
References: <cb4457700907221601ye87d073u6e0765964dfb5216@mail.gmail.com>
	<44062.90.211.11.4.1248306054.squirrel@loskot.net>
	<cb4457700907221657m48763ed4s9346684f5cc8d754@mail.gmail.com>
Message-ID: <36934.90.211.11.4.1248308248.squirrel@loskot.net>

Jorge Ar??valo wrote:
> 2009/7/23 Mateusz Loskot <mateusz@loskot.net>:
>> Jorge Ar?&#65533;??valo wrote::
>>> Hello,
>>>
>>> Context: GDAL WKT Raster Driver
>>>
>>> While creating the Dataset, I execute this query:
>>>
>>> SELECT srid, ST_AsText(extent), pixelsize_x, pixelsize_y, blocksize_x,
>>> blocksize_y FROM raster_columns WHERE r_table_name = 'table' AND
>>> r_column = 'rast'
>>>
>>> I have loaded a 3-band tiff file with gdal2tiles. Its pixel size is
>>> 0.9. If I execute this line (over the result of the previous query):
>>>
>>> ??fPixelSizeX = atof(PQgetvalue(hPGresult, 0, 2));
>>>
>>> I get 0.899999976158142 instead of 0.9.
>>
>> Good.
>>
>>> The string obtained wiht PQgetvalue is "0.9", but, for any reason,
>>> atof transform this string in 0.899999976158142.
>>
>> http://docs.sun.com/source/806-3568/ncg_goldberg.html
>>
>>> So, seems to be a
>>> precission problem. think the string used by atof has any problem, but
>>> I'm not sure
>>
>> Most computers suffer of this problem.
>>
>>> What should I do?
>>
>> You need to learn how to live with that problem :-)
>>
>>> I tried to change atof(nptr) for strtod(nptr,
>>> (char**)NULL), but it didn't work...
>>
>> And it won't help.
>>
>> Best regards,
>> --
>> Mateusz Loskot
>> http://mateusz.loskot.net
>>
>>
>
> Yes, a stupid problem. I used float instead of double.

It's not a problem of float vs double.
Replacing float with double does not guarantee that
value 0.9 will be represented in memory as 0.9.
It still can be 0.89999997...

The float-point term in the docs I suggested does not mean C/C++ type float.
It means float-point number in arithmetic, which in C/C++ can be float or
double.

Best regards
-- 
Mateusz Loskot
http://mateusz.loskot.net

From enrico.sartorello at gmail.com  Thu Jul 23 04:56:04 2009
From: enrico.sartorello at gmail.com (Enrico Sartorello)
Date: Thu Jul 23 05:01:16 2009
Subject: [gdal-dev] Extract BIGTiff libraries from GDAL source package
Message-ID: <1168e7300907230156o689103fcj26fd419bce1a4544@mail.gmail.com>

Hi all,
i need to have a correct BIGTiff package for using it in a program i've
written in C.

As far as i can see, the bigtiff package distributed on
http://www.aperio.com/bigtiff/ is old and can't be correctly compiled, so i
thought i would get it from GDAL.
I've seen that BIGTiff is under gdal/frmts/gtiff/libtiff, and i'm even able
to make it separately from the rest of GDAL.
But make just create a bunch of *.o files from the sources on that dir and
nothing more i can use to replace a normal libtiff installation.

What do i have to do to get my ready-to-use BIGTiff distribution?
Thanks in advance

-- 
Enrico Sartorello
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090723/62dc99f1/attachment-0001.html
From jdt113 at msstate.edu  Thu Jul 23 10:07:39 2009
From: jdt113 at msstate.edu (jteasis)
Date: Thu Jul 23 10:07:40 2009
Subject: [Gdal-dev] GDAL and ECW
In-Reply-To: <7221db410907200658u6878bab2xbc9fc74ab619d00b@mail.gmail.com>
References: <1247760513945-3268583.post@n2.nabble.com>
	<200907162031.44821.even.rouault@mines-paris.org>
	<1248097823886-3288913.post@n2.nabble.com>
	<7221db410907200658u6878bab2xbc9fc74ab619d00b@mail.gmail.com>
Message-ID: <1248358059330-3309788.post@n2.nabble.com>


When I tried to compile the NCSEcw it gives me two types of errors. 
1. Error	1	error C2059: syntax error : '<L_TYPE_raw>'
2. Error	2	error C2238: unexpected token(s) preceding ';'

I am compiling it on Visual Studio 2008 on Windows XP. Do you or anybody
know the reasons for the errors. There are like 4 for each error.


Daniele Romagnoli wrote:
> 
> Hi,
> we have already done it for ImageIO-Ext (a Java project which uses GDAL).
> You can take a look on the Imageio-ext setup guide which is available at
> [1].
> It contains instructions to setup and build GDAL to support several
> external
> formats, as well as instructions to build the java project.
> You don't need to read all the guide but you could take a better look to
> the
> following sections:
> 2.7.1.3, 2.7.2.4 , 2.7.3 (Only the introduction, no need to proceed with
> 2.7.3.1).
> 
> Hope this helps.
> Regards,
> Daniele
> 
> [1]:
> https://imageio-ext.dev.java.net/files/documents/7505/124115/ImageioExt-SetupGuide.pdf
> 
> 
> On Mon, Jul 20, 2009 at 3:50 PM, jteasis <jdt113@msstate.edu> wrote:
> 
>>
>> I looked at the gdal website about hooking up ECW with GDAL on windows
>> but
>> it
>> says it needs to be done. Who can do this and where do I get these
>> instructions?
>>
>>
>> Even Rouault wrote:
>> >
>> > Le Thursday 16 July 2009 18:08:33 jteasis, vous avez ?crit :
>> >> I am working towards getting a program using ECW and other formats. I
>> >> have
>> >> gotten my GDAL 1.5.4 to install with the rest but ECW is giving me
>> >> problems. I was wondering if there was somebody who could help me
>> figure
>> >> out how to compile GDAL with ECW correctly. I would greatly appreciate
>> >> it.
>> >> Thank you.
>> >
>> > See http://trac.osgeo.org/gdal/wiki/BuildHints, section 'External
>> Library
>> > Issues'.
>> > You could also fetch precompiled binaries with ECW support. See
>> > http://trac.osgeo.org/gdal/wiki/DownloadingGdalBinaries (not all of
>> them
>> > have
>> > ECW support, but some yes)
>> > And note that the latest stable version is GDAL 1.6.1.
>> > _______________________________________________
>> > gdal-dev mailing list
>> > gdal-dev@lists.osgeo.org
>> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>> >
>> >
>>
>> --
>> View this message in context:
>> http://n2.nabble.com/GDAL-and-ECW-tp3268583p3288913.html
>> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
> 
> 
> 
> -- 
> -------------------------------------------------------
> Eng. Daniele Romagnoli
> Software Engineer
> 
> GeoSolutions S.A.S.
> Via Carignoni 51
> 55041 Camaiore (LU)
> Italy
> 
> phone: +39 0584983027
> fax:     +39 0584983027
> mob:   +39 328 0559267
> 
> 
> http://www.geo-solutions.it
> 
> -------------------------------------------------------
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 

-- 
View this message in context: http://n2.nabble.com/GDAL-and-ECW-tp3268583p3309788.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From dburken at comcast.net  Thu Jul 23 10:31:22 2009
From: dburken at comcast.net (David Burken)
Date: Thu Jul 23 10:32:27 2009
Subject: [gdal-dev] Extract BIGTiff libraries from GDAL source package
In-Reply-To: <1168e7300907230156o689103fcj26fd419bce1a4544@mail.gmail.com>
References: <1168e7300907230156o689103fcj26fd419bce1a4544@mail.gmail.com>
Message-ID: <4A68743A.4020403@comcast.net>

Enrico,

I like to build straight from cvs:

cvs -d :pserver:cvsanon@cvs.maptools.org:/cvs/maptools/cvsroot co libtiff

Take care,
Dave


On 07/23/2009 04:56 AM, Enrico Sartorello wrote:
> Hi all,
> i need to have a correct BIGTiff package for using it in a program 
> i've written in C.
>
> As far as i can see, the bigtiff package distributed on 
> http://www.aperio.com/bigtiff/ is old and can't be correctly compiled, 
> so i thought i would get it from GDAL.
> I've seen that BIGTiff is under gdal/frmts/gtiff/libtiff, and i'm even 
> able to make it separately from the rest of GDAL.
> But make just create a bunch of *.o files from the sources on that dir 
> and nothing more i can use to replace a normal libtiff installation.
>
> What do i have to do to get my ready-to-use BIGTiff distribution?
> Thanks in advance
>
> -- 
> Enrico Sartorello
> ------------------------------------------------------------------------
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090723/7284755b/attachment.html
From mateusz at loskot.net  Thu Jul 23 11:01:57 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu Jul 23 11:00:11 2009
Subject: [Gdal-dev] GDAL and ECW
In-Reply-To: <1248358059330-3309788.post@n2.nabble.com>
References: <1247760513945-3268583.post@n2.nabble.com>	<200907162031.44821.even.rouault@mines-paris.org>	<1248097823886-3288913.post@n2.nabble.com>	<7221db410907200658u6878bab2xbc9fc74ab619d00b@mail.gmail.com>
	<1248358059330-3309788.post@n2.nabble.com>
Message-ID: <4A687B65.2060503@loskot.net>

jteasis wrote:
> When I tried to compile the NCSEcw it gives me two types of errors. 
> 1. Error	1	error C2059: syntax error : '<L_TYPE_raw>'
> 2. Error	2	error C2238: unexpected token(s) preceding ';'
> 
> I am compiling it on Visual Studio 2008 on Windows XP. Do you or anybody
> know the reasons for the errors. There are like 4 for each error.

Yes, it's a very well-known issue that the ECW code is ugly and
and far from being portable.


Similar issues were discussed on the list and reported:

http://trac.osgeo.org/gdal/ticket/1347
http://trac.osgeo.org/gdal/ticket/2032

Basically, types like UINT32 are not defined as well as plenty of extra 
qualifications around is used (ie. CNCSJPCBuffer::) in the code.
It's been patched [1] and reported [2] directly to ER Mapper
(and big thanks we got for that) but fixed version of code of
the library were never released by ECW implementor.
That's a shame, but we have to live with that, so I'd suggest you
to try to apply Daniel's patch [1]. It's a big patch, as the code is
broken in many places :-)

End of the Rant.

[1] http://lists.osgeo.org/pipermail/gdal-dev/2007-March/011943.html
[2] http://lists.osgeo.org/pipermail/gdal-dev/2007-March/011944.html

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
From jdt113 at msstate.edu  Thu Jul 23 11:39:57 2009
From: jdt113 at msstate.edu (jteasis)
Date: Thu Jul 23 11:39:59 2009
Subject: [Gdal-dev] GDAL and ECW
In-Reply-To: <4A687B65.2060503@loskot.net>
References: <1247760513945-3268583.post@n2.nabble.com>
	<200907162031.44821.even.rouault@mines-paris.org>
	<1248097823886-3288913.post@n2.nabble.com>
	<7221db410907200658u6878bab2xbc9fc74ab619d00b@mail.gmail.com>
	<1248358059330-3309788.post@n2.nabble.com>
	<4A687B65.2060503@loskot.net>
Message-ID: <1248363597995-3310327.post@n2.nabble.com>


Well I fixed those 4 changes that i saw in the bin file, but still have the
same errors. Would any other problems cause the error?

Mateusz Loskot wrote:
> 
> jteasis wrote:
>> When I tried to compile the NCSEcw it gives me two types of errors. 
>> 1. Error	1	error C2059: syntax error : '<L_TYPE_raw>'
>> 2. Error	2	error C2238: unexpected token(s) preceding ';'
>> 
>> I am compiling it on Visual Studio 2008 on Windows XP. Do you or anybody
>> know the reasons for the errors. There are like 4 for each error.
> 
> Yes, it's a very well-known issue that the ECW code is ugly and
> and far from being portable.
> 
> 
> Similar issues were discussed on the list and reported:
> 
> http://trac.osgeo.org/gdal/ticket/1347
> http://trac.osgeo.org/gdal/ticket/2032
> 
> Basically, types like UINT32 are not defined as well as plenty of extra 
> qualifications around is used (ie. CNCSJPCBuffer::) in the code.
> It's been patched [1] and reported [2] directly to ER Mapper
> (and big thanks we got for that) but fixed version of code of
> the library were never released by ECW implementor.
> That's a shame, but we have to live with that, so I'd suggest you
> to try to apply Daniel's patch [1]. It's a big patch, as the code is
> broken in many places :-)
> 
> End of the Rant.
> 
> [1] http://lists.osgeo.org/pipermail/gdal-dev/2007-March/011943.html
> [2] http://lists.osgeo.org/pipermail/gdal-dev/2007-March/011944.html
> 
> Best regards,
> -- 
> Mateusz Loskot, http://mateusz.loskot.net
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 

-- 
View this message in context: http://n2.nabble.com/GDAL-and-ECW-tp3268583p3310327.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From mateusz at loskot.net  Thu Jul 23 12:08:51 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu Jul 23 12:07:05 2009
Subject: [Gdal-dev] GDAL and ECW
In-Reply-To: <1248363597995-3310327.post@n2.nabble.com>
References: <1247760513945-3268583.post@n2.nabble.com>	<200907162031.44821.even.rouault@mines-paris.org>	<1248097823886-3288913.post@n2.nabble.com>	<7221db410907200658u6878bab2xbc9fc74ab619d00b@mail.gmail.com>	<1248358059330-3309788.post@n2.nabble.com>	<4A687B65.2060503@loskot.net>
	<1248363597995-3310327.post@n2.nabble.com>
Message-ID: <4A688B13.2010707@loskot.net>

jteasis wrote:
> Well I fixed those 4 changes that i saw in the bin file, but still have the
> same errors. Would any other problems cause the error?

Sorry, I'm not a wizard. You quoted incomplete error messages:

1. Error	1	error C2059: syntax error : '<L_TYPE_raw>'
2. Error	2	error C2238: unexpected token(s) preceding ';'

These tell what happens but don't tell where (file, line).

Let me guess, the problem is caused by macros.

In file NCSJPCBuffer.h there is CNCSJPCBuffer wich static data members
which use the same names as Microsoft-specific macros defined by
Windows API / Visual C++:

static const UINT32 MAXUINT8

MAXUINT8 is a macro defined in BaseTsd.h file of Windows API.
Unfortunately, ECW does include BaseTsd.h indirectly (see stdafx.h which 
sucks in ATL stuff).

Bad luck!

p.s. Another good reason for C/C++ hackers to believe
that macros *are* evil :-)

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
From matt.wilkie at gov.yk.ca  Thu Jul 23 13:13:42 2009
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Thu Jul 23 13:28:51 2009
Subject: [gdal-dev] gdal/ogr/proj and NAD83(CSRS)
Message-ID: <4A689A46.3000405@gov.yk.ca>

Hello All,

I've recently noticed that projecting with ogr2ogr (and I presume 
gdalwarp since they share so much) and using epsg codes adds information 
to .prj files that apparently proj doesn't know about. For example:

   # ogr2ogr -f "esri shapefile" -t_srs epsg:3579 (...)

will write this .prj (note "D_North_American_1983_CSRS98"):

   PROJCS["NAD83(CSRS) / Yukon 
Albers",GEOGCS["NAD83(CSRS)",DATUM["D_North_American_1983_CSRS98",SPHEROID["GRS_1980",6378137,298.257222101]],PRIMEM["Greenwich",0],UNIT["Degree",0.017453292519943295]],PROJECTION["Albers"],PARAMETER["standard_parallel_1",61.66666666666666],PARAMETER["standard_parallel_2",68],PARAMETER["latitude_of_origin",59],PARAMETER["central_meridian",-132.5],PARAMETER["false_easting",500000],PARAMETER["false_northing",500000],UNIT["Meter",1]]

However asking proj to list the datums it knows about, there is nothing 
about NAD83CSRS:
   # proj -ld|grep -i --after-context=1 nad
   NAD83 GRS80   towgs84=0,0,0
                 North_American_Datum_1983
   NAD27 clrk66  nadgrids=@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat
                 North_American_Datum_1927

Environment:
    osgeo4w on WinXPx64
    Proj version: Rel. 4.6.1, 21 August 2008
    ogr2ogr version: unknown, but gdal utilities report "GDAL 1.5.4, 
released 2009/01/07"


I came across this curiosity while trying to figure out what the 
equivalent proj4 parameters were to epsg:3579. Using 
"+datum=nad83(csrs)" and combinations thereof result in "datum_unknown" 
being written to the .prj file.
((if there are no equivalent proj4 strings for the NAD83(CSRS) datum, 
then the proj4 reference files at spatialreference.org are in error and 
should probably be removed, or something.))

So now I'm wondering if transforming a file with gdal/ogr actually 
results in NAD83(CSRS) data, or if it really puts out NAD83 and blindly 
writes out the epsg code? 

cheers,

-- 
matt wilkie
--------------------------------------------
Geomatics Analyst
Information Management and Technology
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
http://environmentyukon.gov.yk.ca/geomatics/
-------------------------------------------- 

From Witt.Sparks at nrel.gov  Thu Jul 23 14:04:14 2009
From: Witt.Sparks at nrel.gov (Sparks, Witt)
Date: Thu Jul 23 14:05:22 2009
Subject: [gdal-dev] Opening an oracle datasource
Message-ID: <CF862E5BFA289747B196A8B4E54F1CC105A3CF2545@MAILBOX1.nrel.gov>

Hello,

I'm attempting to use an Oracale database as an OGR datasource with feature server. I've specified my dns as "OCI:user/password@db_instance"

When this string gets passed to _gdal.OGROpen (line 127 of my copy of ogr.py), I receive the following error:

An error occurred: Unable to open: OCI:user/password@db_instance
  File "/usr/lib/cgi-bin/fserv/FeatureServer/Server.py", line 247, in cgiHandler
    service = Server.load(*cfgfiles)
  File "/usr/lib/cgi-bin/fserv/FeatureServer/Server.py", line 69, in _load
    config, section, 'DataSource')
  File "/usr/lib/cgi-bin/fserv/FeatureServer/Server.py", line 49, in _loadFromSection
    return objclass(section, **objargs)
  File "/usr/lib/cgi-bin/fserv/FeatureServer/DataSource/OGR.py", line 53, in __init__
    self.ds     = ogr.Open( dsn, int(writable) )
  File "/usr/lib/python2.5/site-packages/ogr.py", line 127, in Open
    raise OGRError, 'Unable to open: ' + filename

I can run ogrinfo from the command line, passing the same datasource name as above, successfully.

Thanks for any assistance.

______________________________________________________________________
Witt Sparks
National Renewable Energy Laboratory
Center for Transportation Technologies and Systems
witt_sparks@nrel.gov<mailto:witt_sparks@nrel.gov>
303-275-4494
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090723/c7a5977c/attachment.html
From even.rouault at mines-paris.org  Thu Jul 23 14:13:25 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu Jul 23 14:14:01 2009
Subject: [gdal-dev] gdal/ogr/proj and NAD83(CSRS)
In-Reply-To: <4A689A46.3000405@gov.yk.ca>
References: <4A689A46.3000405@gov.yk.ca>
Message-ID: <200907232013.36890.even.rouault@mines-paris.org>

Matt,

testepsg EPSG:3579 shows : +proj=aea +lat_1=61.66666666666666 +lat_2=68 
+lat_0=59 +lon_0=-132.5 +x_0=500000 +y_0=500000 +ellps=GRS80 +units=m 
+no_defs 

So it looks like it doesn't have the datum information. I think proj won't 
make any datum transformation then. If your input data is already in NAD83 
CSRS, the end result should be OK though.

Is there a difference between NAD83 and NAD83 CSRS ? (the difference between 
NAD83/GRS80 and WGS84/WGS84 is usually neglectable). If none or not very 
significant, you could try using -t_srs "+proj=aea +lat_1=61.66666666666666 
+lat_2=68 +lat_0=59 +lon_0=-132.5 +x_0=500000 +y_0=500000 +ellps=GRS80 
+datum=NAD83 +units=m +no_defs" (I've added +datum=NAD83 to the testepsg 
output)

Another thing to know, the WKT in a .prj file is in ESRI WKT form, not OGC 
WKT. There are differences in the citation strings and projection parameter 
names. Don't ask me more than that! There has been recently changes commited 
in trunk from ESRI to improve OGC WKT <--> ESRI WKT translation (the output 
in trunk and GDAL 1.6.1 are not the same for testeps EPSG:3579). But that 
doesn't really matter here for your use case, as the .prj file that is 
written by ogr2ogr has no influence in the reprojection process.

Best regards,
Even

Le Thursday 23 July 2009 19:13:42 Matt Wilkie, vous avez ?crit?:
> Hello All,
>
> I've recently noticed that projecting with ogr2ogr (and I presume
> gdalwarp since they share so much) and using epsg codes adds information
> to .prj files that apparently proj doesn't know about. For example:
>
>    # ogr2ogr -f "esri shapefile" -t_srs epsg:3579 (...)
>
> will write this .prj (note "D_North_American_1983_CSRS98"):
>
>    PROJCS["NAD83(CSRS) / Yukon
> Albers",GEOGCS["NAD83(CSRS)",DATUM["D_North_American_1983_CSRS98",SPHEROID[
>"GRS_1980",6378137,298.257222101]],PRIMEM["Greenwich",0],UNIT["Degree",0.017
>453292519943295]],PROJECTION["Albers"],PARAMETER["standard_parallel_1",61.66
>666666666666],PARAMETER["standard_parallel_2",68],PARAMETER["latitude_of_ori
>gin",59],PARAMETER["central_meridian",-132.5],PARAMETER["false_easting",5000
>00],PARAMETER["false_northing",500000],UNIT["Meter",1]]
>
> However asking proj to list the datums it knows about, there is nothing
> about NAD83CSRS:
>    # proj -ld|grep -i --after-context=1 nad
>    NAD83 GRS80   towgs84=0,0,0
>                  North_American_Datum_1983
>    NAD27 clrk66  nadgrids=@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat
>                  North_American_Datum_1927
>
> Environment:
>     osgeo4w on WinXPx64
>     Proj version: Rel. 4.6.1, 21 August 2008
>     ogr2ogr version: unknown, but gdal utilities report "GDAL 1.5.4,
> released 2009/01/07"
>
>
> I came across this curiosity while trying to figure out what the
> equivalent proj4 parameters were to epsg:3579. Using
> "+datum=nad83(csrs)" and combinations thereof result in "datum_unknown"
> being written to the .prj file.
> ((if there are no equivalent proj4 strings for the NAD83(CSRS) datum,
> then the proj4 reference files at spatialreference.org are in error and
> should probably be removed, or something.))
>
> So now I'm wondering if transforming a file with gdal/ogr actually
> results in NAD83(CSRS) data, or if it really puts out NAD83 and blindly
> writes out the epsg code?
>
> cheers,


From randre at gmail.com  Thu Jul 23 15:31:46 2009
From: randre at gmail.com (=?ISO-8859-1?Q?Roger_Andr=E9?=)
Date: Thu Jul 23 15:31:48 2009
Subject: [gdal-dev] Ruby bindings and geotiff...
In-Reply-To: <154730e10907210327h2a025e65jcc7979a4b1213845@mail.gmail.com>
References: <154730e10907210327h2a025e65jcc7979a4b1213845@mail.gmail.com>
Message-ID: <9c2015090907231231t64980b37j9295cb3aebb9ea55@mail.gmail.com>

Assuming that you know the row and column of the pixel you want, and
that column = iX, and row = iY, something like this example in Python
should work:

      # GET RASTER VALUE AT SPECIFIC ROW/COLUMN OFFSET IN RASTER
      iX = offset[0]
      iY = offset[1]
      src_data = src_band.ReadAsArray(0,iY,src_ds.RasterXSize,1)
      col_values = src_data[0]
      raster_value = col_values[iX]
      print "%s|%f" % (city.strip(), raster_value)
-----------

On Tue, Jul 21, 2009 at 3:27 AM, Adam
Fowler<adam.fowler@actionfinder.co.uk> wrote:
> Hi All,
>
> I'm trying to write a Ruby app to read the new and fantastic NASA
> ASTER Elevation DEM. This is of course in GeoTiff format.
>
> I'm wondering if anyone has examples in any language of using GDAL to
> read a particular location's data from a geotiff file? I can do the
> calculations to figure out which of the 3601x3601 data elements I need
> to read is, but I can't find an example of using GDAL to load only
> that pixel's information.
>
> If anyone has an example that would be great.
>
> I'm also having issues installing GDAL on OS X even when using
> macports. I can build and install fine without the ruby bindings, but
> using them (via editing the port file to include --with-ruby) gives
> me:
>
> libtool: link: /usr/bin/g++-4.0 gdal_wrap.o -o gdal.so
> -L/opt/local/lib
> -L/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib
> -L/opt/local -L/usr/X11/lib
> -L/opt/local/var/macports/build/_opt_local_var_macports_sources_rsync.macports.org_release_ports_science_gdal/work/gdal-1.6.0
> /opt/local/lib/libgdal.dylib /opt/local/lib/libproj.dylib -lm
> /opt/local/lib/libgif.dylib /opt/local/lib/libSM.dylib
> /opt/local/lib/libICE.dylib /opt/local/lib/libX11.dylib
> /opt/local/lib/libXau.dylib /opt/local/lib/libXdmcp.dylib -lgeotiff
> /opt/local/lib/libtiff.dylib /opt/local/lib/libjpeg.dylib -lc
> /opt/local/lib/libpng12.dylib -lz -ldl -lruby
> Undefined symbols:
> ?"_main", referenced from:
> ? ?start in crt1.10.5.o
> ld: symbol(s) not found
> collect2: ld returned 1 exit status
> make[3]: *** [gdal.so] Error 1
> make[2]: *** [build] Error 2
> make[1]: *** [build] Error 2
> make: *** [swig-modules] Error 2
>
> Error: Status 1 encountered during processing.
>
> I'm assuming it can't find ruby to link to, but not quite sure how to
> resolve this. Does --with-ruby have any extra undocumented options?
>
> If I figure it out I'd be happy to add to the Ruby WIKI page - who
> should I email to get access/contribute information?
>
> Thanks in advance.
>
> Regards,
>
> Adam.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
From mdekauwe at gmail.com  Thu Jul 23 17:06:39 2009
From: mdekauwe at gmail.com (mdekauwe)
Date: Thu Jul 23 17:06:41 2009
Subject: [Gdal-dev] compiling GDAL on solaris - error?!
Message-ID: <1248383199586-3312297.post@n2.nabble.com>


Hi, 

Would anyone be able to point me in the direction of a solution to my build
error on Solaris? 

gmake libgdal.la 
gmake[1]: Entering directory `gdal-1.6.0' 
gmake[1]: *** No rule to make target `gdal-1.6.0/frmts/o/*.lo', needed by
`libgdal.la'.  Stop. 
gmake[1]: Leaving directory `gdal-1.6.0' 
gmake: *** [check-lib] Error 2 

I have no idea why it doesn't know how to build the libraries, any
suggestions would be much appreciated!! 

Thanks 

Martin
-- 
View this message in context: http://n2.nabble.com/compiling-GDAL-on-solaris---error-%21-tp3312297p3312297.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From even.rouault at mines-paris.org  Thu Jul 23 17:07:49 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu Jul 23 17:08:01 2009
Subject: [Gdal-dev] compiling GDAL on solaris - error?!
In-Reply-To: <1248383199586-3312297.post@n2.nabble.com>
References: <1248383199586-3312297.post@n2.nabble.com>
Message-ID: <200907232307.50844.even.rouault@mines-paris.org>

Might be a libtool issue. Try ./configure --without-libtool

Le Thursday 23 July 2009 23:06:39 mdekauwe, vous avez ?crit?:
> Hi,
>
> Would anyone be able to point me in the direction of a solution to my build
> error on Solaris?
>
> gmake libgdal.la
> gmake[1]: Entering directory `gdal-1.6.0'
> gmake[1]: *** No rule to make target `gdal-1.6.0/frmts/o/*.lo', needed by
> `libgdal.la'.  Stop.
> gmake[1]: Leaving directory `gdal-1.6.0'
> gmake: *** [check-lib] Error 2
>
> I have no idea why it doesn't know how to build the libraries, any
> suggestions would be much appreciated!!
>
> Thanks
>
> Martin


From matt.gregory at oregonstate.edu  Thu Jul 23 17:19:06 2009
From: matt.gregory at oregonstate.edu (Gregory, Matthew)
Date: Thu Jul 23 17:19:38 2009
Subject: [gdal-dev] corrupt block on AIG dataset
Message-ID: <451453C181B199458A55B2B1723FAC000260D1C8@SAGE.forestry.oregonstate.edu>

Hi all,

When I do a simple RasterIO read over various ArcInfo grids (using the
AIG driver), I am getting sporadic "Corrupt block" errors from line 636
in gridlib.c (r17432) on grids that I think should be fine.  This
relevant chunk of code in gridlib.c is this:

-------------------------

/* The 4 is to be safe... In theory for a very small block (2x2 or
less),
   and nMinSize < 4, nDataSize could be smaller... */
if (nDataSize < 2 + 4)
{
  CPLError( CE_Failure, CPLE_AppDefined, "Corrupt block");
  CPLFree( pabyRaw );
  return CE_Failure;
}

-------------------------

I'm erroring out with nDataSize of 4.  I won't even pretend to
understand the intracacies of the driver, but I'm getting this error on
many grids, all of which I believe are fine.  I will file a ticket and
post sample data if desired.

thanks, matt
From mdekauwe at gmail.com  Thu Jul 23 17:44:32 2009
From: mdekauwe at gmail.com (mdekauwe)
Date: Thu Jul 23 17:44:34 2009
Subject: [Gdal-dev] compiling GDAL on solaris - error?!
In-Reply-To: <200907232307.50844.even.rouault@mines-paris.org>
References: <1248383199586-3312297.post@n2.nabble.com>
	<200907232307.50844.even.rouault@mines-paris.org>
Message-ID: <1248385472674-3312449.post@n2.nabble.com>


Hi,

I tried your suggestion and I got exactly the same error?!

Thanks though, any other thoughts?


Even Rouault wrote:
> 
> Might be a libtool issue. Try ./configure --without-libtool
> 
> Le Thursday 23 July 2009 23:06:39 mdekauwe, vous avez ?crit?:
>> Hi,
>>
>> Would anyone be able to point me in the direction of a solution to my
>> build
>> error on Solaris?
>>
>> gmake libgdal.la
>> gmake[1]: Entering directory `gdal-1.6.0'
>> gmake[1]: *** No rule to make target `gdal-1.6.0/frmts/o/*.lo', needed by
>> `libgdal.la'.  Stop.
>> gmake[1]: Leaving directory `gdal-1.6.0'
>> gmake: *** [check-lib] Error 2
>>
>> I have no idea why it doesn't know how to build the libraries, any
>> suggestions would be much appreciated!!
>>
>> Thanks
>>
>> Martin
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 

-- 
View this message in context: http://n2.nabble.com/compiling-GDAL-on-solaris---error-%21-tp3312297p3312449.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From even.rouault at mines-paris.org  Thu Jul 23 18:40:46 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu Jul 23 18:40:57 2009
Subject: [gdal-dev] corrupt block on AIG dataset
In-Reply-To: <451453C181B199458A55B2B1723FAC000260D1C8@SAGE.forestry.oregonstate.edu>
References: <451453C181B199458A55B2B1723FAC000260D1C8@SAGE.forestry.oregonstate.edu>
Message-ID: <200907240040.47143.even.rouault@mines-paris.org>

Should be fixed by r17435 now. Trunk only issue.

Thanks for reporting Matt

Le Thursday 23 July 2009 23:19:06 Gregory, Matthew, vous avez ?crit?:
> Hi all,
>
> When I do a simple RasterIO read over various ArcInfo grids (using the
> AIG driver), I am getting sporadic "Corrupt block" errors from line 636
> in gridlib.c (r17432) on grids that I think should be fine.  This
> relevant chunk of code in gridlib.c is this:
>
> -------------------------
>
> /* The 4 is to be safe... In theory for a very small block (2x2 or
> less),
>    and nMinSize < 4, nDataSize could be smaller... */
> if (nDataSize < 2 + 4)
> {
>   CPLError( CE_Failure, CPLE_AppDefined, "Corrupt block");
>   CPLFree( pabyRaw );
>   return CE_Failure;
> }
>
> -------------------------
>
> I'm erroring out with nDataSize of 4.  I won't even pretend to
> understand the intracacies of the driver, but I'm getting this error on
> many grids, all of which I believe are fine.  I will file a ticket and
> post sample data if desired.
>
> thanks, matt
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From warmerdam at pobox.com  Thu Jul 23 21:12:01 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Jul 23 21:12:17 2009
Subject: [gdal-dev] Extract BIGTiff libraries from GDAL source package
In-Reply-To: <4A68743A.4020403@comcast.net>
References: <1168e7300907230156o689103fcj26fd419bce1a4544@mail.gmail.com>
	<4A68743A.4020403@comcast.net>
Message-ID: <4A690A61.1090300@pobox.com>

David Burken wrote:
> Enrico,
> 
> I like to build straight from cvs:
> 
> cvs -d :pserver:cvsanon@cvs.maptools.org:/cvs/maptools/cvsroot co libtiff

Enrico,

I concur with Dave.  The best place to get the latest libtiff4 with
bigtiff support is CVS.  Please note that the Aperio code is a distinct
fork of libtiff and not supported or encouraged for use by the core
libtiff maintainers (ie. me).  It is unfortunate that it places well on
a BigTIFF google search as it has lead several folks astray, including
at least one sizable commercial organization who helped fund the
official libtiff BigTIFF port!

Best regards,

> On 07/23/2009 04:56 AM, Enrico Sartorello wrote:
>> Hi all,
>> i need to have a correct BIGTiff package for using it in a program 
>> i've written in C.
>>
>> As far as i can see, the bigtiff package distributed on 
>> http://www.aperio.com/bigtiff/ is old and can't be correctly compiled, 
>> so i thought i would get it from GDAL.
>> I've seen that BIGTiff is under gdal/frmts/gtiff/libtiff, and i'm even 
>> able to make it separately from the rest of GDAL.
>> But make just create a bunch of *.o files from the sources on that dir 
>> and nothing more i can use to replace a normal libtiff installation.
>>
>> What do i have to do to get my ready-to-use BIGTiff distribution?
>> Thanks in advance
>>
>> -- 
>> Enrico Sartorello
>> ------------------------------------------------------------------------
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From xiaodong666 at gmail.com  Thu Jul 23 23:26:44 2009
From: xiaodong666 at gmail.com (chen xiaodong)
Date: Thu Jul 23 23:35:02 2009
Subject: [gdal-dev] does gdal can read large file faster?
Message-ID: <ef926de40907232026w2af19fd7ve41699d8ee3ca7ea@mail.gmail.com>

On our company's platform ,we use gdal to read/write geo raster files.There
is a problem I acount with is that when process a little larger file beyond
1G ,the performance is poor that a  file with a 1.5G compacity and tiff
format resampling can consume more then 20 minutes!It troubles me for a long
time,so appreciate for any idea!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090724/93a0b62e/attachment.html
From spbhasker at gmail.com  Fri Jul 24 03:13:38 2009
From: spbhasker at gmail.com (spbhasker bachi)
Date: Fri Jul 24 03:14:01 2009
Subject: [gdal-dev] oralce georaster support
Message-ID: <2b5309940907240013w241dabds66968d68516d6ea6@mail.gmail.com>

hello.

i have dumped few images using the georaster plugin build on gdal 1.6.1

pl let me know the syntax to extract the images from georaster

presume gdal_translate has some functionality.. can anyone let me know the
syntax to clip the image from oracle database and write to an output tiff
image..

bhasker
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090724/b3ee7df3/attachment.html
From bartvde at osgis.nl  Fri Jul 24 03:18:41 2009
From: bartvde at osgis.nl (bartvde@osgis.nl)
Date: Fri Jul 24 03:18:53 2009
Subject: [gdal-dev] oralce georaster support
In-Reply-To: <2b5309940907240013w241dabds66968d68516d6ea6@mail.gmail.com>
References: <2b5309940907240013w241dabds66968d68516d6ea6@mail.gmail.com>
Message-ID: <31998.145.50.39.11.1248419921.squirrel@webmail.hostingdiscounter.nl>

Hi,

please read:

http://gdal.org/frmt_georaster.html

Best regards,
Bart

> hello.
>
> i have dumped few images using the georaster plugin build on gdal 1.6.1
>
> pl let me know the syntax to extract the images from georaster
>
> presume gdal_translate has some functionality.. can anyone let me know the
> syntax to clip the image from oracle database and write to an output tiff
> image..
>
> bhasker
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From enrico.sartorello at gmail.com  Fri Jul 24 07:40:45 2009
From: enrico.sartorello at gmail.com (Enrico Sartorello)
Date: Fri Jul 24 07:40:49 2009
Subject: [gdal-dev] Extract BIGTiff libraries from GDAL source package
In-Reply-To: <4A690A61.1090300@pobox.com>
References: <1168e7300907230156o689103fcj26fd419bce1a4544@mail.gmail.com>
	<4A68743A.4020403@comcast.net> <4A690A61.1090300@pobox.com>
Message-ID: <1168e7300907240440u2589a07aj10b19400558b1bfb@mail.gmail.com>

Hi Frank and David,
thank you very much for your informations.

As you've correctly told, my searches on Google lead me thinking that the
Aperio distribution was the right side to get BIGTiff libraries.
Now everything is clear to me, thanks for your clarification!

Best regards,

On Fri, Jul 24, 2009 at 3:12 AM, Frank Warmerdam <warmerdam@pobox.com>wrote:

> David Burken wrote:
>
>> Enrico,
>>
>> I like to build straight from cvs:
>>
>> cvs -d :pserver:cvsanon@cvs.maptools.org:/cvs/maptools/cvsroot co libtiff
>>
>
> Enrico,
>
> I concur with Dave.  The best place to get the latest libtiff4 with
> bigtiff support is CVS.  Please note that the Aperio code is a distinct
> fork of libtiff and not supported or encouraged for use by the core
> libtiff maintainers (ie. me).  It is unfortunate that it places well on
> a BigTIFF google search as it has lead several folks astray, including
> at least one sizable commercial organization who helped fund the
> official libtiff BigTIFF port!
>
> Best regards,
>
>  On 07/23/2009 04:56 AM, Enrico Sartorello wrote:
>>
>>> Hi all,
>>> i need to have a correct BIGTiff package for using it in a program i've
>>> written in C.
>>>
>>> As far as i can see, the bigtiff package distributed on
>>> http://www.aperio.com/bigtiff/ is old and can't be correctly compiled,
>>> so i thought i would get it from GDAL.
>>> I've seen that BIGTiff is under gdal/frmts/gtiff/libtiff, and i'm even
>>> able to make it separately from the rest of GDAL.
>>> But make just create a bunch of *.o files from the sources on that dir
>>> and nothing more i can use to replace a normal libtiff installation.
>>>
>>> What do i have to do to get my ready-to-use BIGTiff distribution?
>>> Thanks in advance
>>>
>>> --
>>> Enrico Sartorello
>>> ------------------------------------------------------------------------
>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev@lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>
>> ------------------------------------------------------------------------
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
> --
>
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam<http://pobox.com/%7Ewarmerdam>
> and watch the world go round - Rush    | Geospatial Programmer for Rent
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
Enrico Sartorello
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090724/5a6cdec5/attachment-0001.html
From r.m.krug at gmail.com  Fri Jul 24 09:20:33 2009
From: r.m.krug at gmail.com (Rainer M Krug)
Date: Fri Jul 24 09:20:36 2009
Subject: [gdal-dev] Problem with nodata values
Message-ID: <fb7c7e870907240620m1ebcfac7sbe1b25325179135@mail.gmail.com>

Hi

I have a geotiff and want to use gdalwarp to warp to it into a
different projection.
I do the following:

gdalwarp -s_srs EPSG:32734 -t_srs '+proj=longlat +ellps=WGS84
+no_defs' Outeniqua.tiff Outeniqua_wgs84.tiff

The problem is, that in Outeniqua_wgs84.tiff, the nodata values from
Outeniqua.tiff become translated into -9999. In addition, the areas
new to Outeniqua_wgs84.tiff (due to the warping) become 1.

Which options do I have to use to keep the nodata values and to make
the values of the "new areas" also as nodata values?

Thanks

Rainer
-- 
Rainer M. Krug, Centre of Excellence for Invasion Biology,
Stellenbosch University, South Africa
From spbhasker at gmail.com  Fri Jul 24 10:05:34 2009
From: spbhasker at gmail.com (spbhasker bachi)
Date: Fri Jul 24 10:05:56 2009
Subject: [gdal-dev] Polynomials in GDAL : 4th Order to 10th Order..
Message-ID: <2b5309940907240705p3e1668c0y40195ca1cbabc288@mail.gmail.com>

Hi.


Need help on 4th , 5th , 6th upto 10 Order Polynomials.

I have succesfully used the 1st to 3rd Polynomials provided in GDAL and
warped both Vectors and Images based on custom Coding..

Can anyone help me Code the 4th to 10th Order

Any source from any website which will help me out is welcome..

Need it desperately


Regards

Bhasker
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090724/ce8f4a2a/attachment.html
From neteler at osgeo.org  Fri Jul 24 10:31:59 2009
From: neteler at osgeo.org (Markus Neteler)
Date: Fri Jul 24 10:32:02 2009
Subject: [gdal-dev] Slovenia vector data reprojection issue
Message-ID: <86782b610907240731i3569b385tf4ec04213124caec@mail.gmail.com>

Hi,

I am trying to reproject Slovenian country data from D48 (WKT attached)
and Italian ISTAT national vector data (UTM32/ED50) into a common
projection.

While the map "attach" rather well in Latlong/WGS84 using GDAL 1.6.svn,
they don't in EU LAEA (EPSG 3035). This is a bit suprising for me.
Any trick to get this done?

The input SHAPE files have each a .prj file (attached), the target SRS
I request by -t_srs epsg:4326 or -t_srs epsg:3035.

My preferred SRS would be EU LAEA to match the EU CORINE data.

thanks
Markus
-------------- next part --------------
A non-text attachment was scrubbed...
Name: epsgD48_3787.prj
Type: application/octet-stream
Size: 680 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090724/f9276f82/epsgD48_3787.obj
-------------- next part --------------
A non-text attachment was scrubbed...
Name: eu_etrs89_laea.prj
Type: application/octet-stream
Size: 341 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090724/f9276f82/eu_etrs89_laea.obj
From scott.sinclair.za at gmail.com  Fri Jul 24 10:36:21 2009
From: scott.sinclair.za at gmail.com (Scott Sinclair)
Date: Fri Jul 24 10:36:22 2009
Subject: [gdal-dev] Polynomials in GDAL : 4th Order to 10th Order..
In-Reply-To: <2b5309940907240705p3e1668c0y40195ca1cbabc288@mail.gmail.com>
References: <2b5309940907240705p3e1668c0y40195ca1cbabc288@mail.gmail.com>
Message-ID: <6a17e9ee0907240736nd3a5c16n51ce787dc9eb6a5f@mail.gmail.com>

> 2009/7/24 spbhasker bachi <spbhasker@gmail.com>:
> Need help on 4th , 5th , 6th upto 10 Order Polynomials.
>
> I have succesfully used the 1st to 3rd Polynomials provided in GDAL and
> warped both Vectors and Images based on custom Coding..
>
> Can anyone help me Code the 4th to 10th Order

You probably don't want to do that. See:

http://en.wikipedia.org/wiki/Runge%27s_phenomenon
http://en.wikipedia.org/wiki/Spline_(mathematics)
http://mathworld.wolfram.com/CubicSpline.html

Cheers,
Scott
From frankie at debian.org  Fri Jul 24 10:56:18 2009
From: frankie at debian.org (Francesco P. Lovergine)
Date: Fri Jul 24 10:56:24 2009
Subject: [gdal-dev] BigTIFF status [Was: Extract BIGTiff libraries from GDAL
 source package]
In-Reply-To: <4A690A61.1090300@pobox.com>
References: <1168e7300907230156o689103fcj26fd419bce1a4544@mail.gmail.com>
	<4A68743A.4020403@comcast.net> <4A690A61.1090300@pobox.com>
Message-ID: <20090724145618.GD14401@mithrandir>

On Thu, Jul 23, 2009 at 09:12:01PM -0400, Frank Warmerdam wrote:
> 
> Enrico,
> 
> I concur with Dave.  The best place to get the latest libtiff4 with
> bigtiff support is CVS.  Please note that the Aperio code is a distinct
> fork of libtiff and not supported or encouraged for use by the core
> libtiff maintainers (ie. me).  It is unfortunate that it places well on
> a BigTIFF google search as it has lead several folks astray, including
> at least one sizable commercial organization who helped fund the
> official libtiff BigTIFF port!
> 

Frank

is there some sort-of tentative/possible roadmap about an official bigtiff 
merging in libtiff? It seems a forever pending feature currently... 

-- 
Francesco P. Lovergine
From warmerdam at pobox.com  Fri Jul 24 11:09:57 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Jul 24 11:10:18 2009
Subject: [gdal-dev] Re: BigTIFF status [Was: Extract BIGTiff libraries from
 GDAL source package]
In-Reply-To: <20090724145618.GD14401@mithrandir>
References: <1168e7300907230156o689103fcj26fd419bce1a4544@mail.gmail.com>
	<4A68743A.4020403@comcast.net> <4A690A61.1090300@pobox.com>
	<20090724145618.GD14401@mithrandir>
Message-ID: <4A69CEC5.3050204@pobox.com>

Francesco P. Lovergine wrote:
> On Thu, Jul 23, 2009 at 09:12:01PM -0400, Frank Warmerdam wrote:
>> Enrico,
>>
>> I concur with Dave.  The best place to get the latest libtiff4 with
>> bigtiff support is CVS.  Please note that the Aperio code is a distinct
>> fork of libtiff and not supported or encouraged for use by the core
>> libtiff maintainers (ie. me).  It is unfortunate that it places well on
>> a BigTIFF google search as it has lead several folks astray, including
>> at least one sizable commercial organization who helped fund the
>> official libtiff BigTIFF port!
>>
> 
> Frank
> 
> is there some sort-of tentative/possible roadmap about an official bigtiff 
> merging in libtiff? It seems a forever pending feature currently... 

Frankie,

There is no issue of merging - it is in libtiff CVS HEAD.  So I assume the
question is when will there be an official libtiff 4.0.0 release.  It could
really be done any time, but I have be slothful and the other libtiff
maintainers have also not come forward to make it happen.

I don't know how to answer when a release will happen.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From frankie at debian.org  Fri Jul 24 11:21:58 2009
From: frankie at debian.org (Francesco P. Lovergine)
Date: Fri Jul 24 11:22:03 2009
Subject: [gdal-dev] gdal/ogr/proj and NAD83(CSRS)
In-Reply-To: <4A689A46.3000405@gov.yk.ca>
References: <4A689A46.3000405@gov.yk.ca>
Message-ID: <20090724152158.GE14401@mithrandir>

On Thu, Jul 23, 2009 at 10:13:42AM -0700, Matt Wilkie wrote:
> 
> I came across this curiosity while trying to figure out what the
> equivalent proj4 parameters were to epsg:3579. Using
> "+datum=nad83(csrs)" and combinations thereof result in
> "datum_unknown" being written to the .prj file.
> ((if there are no equivalent proj4 strings for the NAD83(CSRS)
> datum, then the proj4 reference files at spatialreference.org are in
> error and should probably be removed, or something.))
> 
> So now I'm wondering if transforming a file with gdal/ogr actually
> results in NAD83(CSRS) data, or if it really puts out NAD83 and
> blindly writes out the epsg code?
> 

I suspect EPSG does not define a NAD83(CSRS) datum because it needs
a dynamic reference frame definition, which cannot be approximated
decently with a seven parameters transformation, anyway. 
So it would be not a proper approach.

See 

ftp://geod.nrcan.gc.ca/pub/GSD/craymer/pubs/nad83_hydroscan2006.pdf
ftp://geod.nrcan.gc.ca/pub/GSD/craymer/pubs/nad83_geomatica2006.pdf

for reference. Maybe someone more expert on the proj list could be more 
precise about that.

-- 
Francesco P. Lovergine
From warmerdam at pobox.com  Fri Jul 24 11:41:27 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Jul 24 11:41:50 2009
Subject: [gdal-dev] does gdal can read large file faster?
In-Reply-To: <ef926de40907232026w2af19fd7ve41699d8ee3ca7ea@mail.gmail.com>
References: <ef926de40907232026w2af19fd7ve41699d8ee3ca7ea@mail.gmail.com>
Message-ID: <4A69D627.8090700@pobox.com>

chen xiaodong wrote:
> On our company's platform ,we use gdal to read/write geo raster 
> files.There is a problem I acount with is that when process a little 
> larger file beyond 1G ,the performance is poor that a  file with a 1.5G 
> compacity and tiff format resampling can consume more then 20 minutes!It 
> troubles me for a long time,so appreciate for any idea!

Hi,

One possible reason for this might be "cache thrashing" in the GDAL block
cache.  This occurs in a number of circumstances.  One example would be
when one whole row of tiles from an input file will not fit in the block
cache at the same time, and when data is fetched one scanline at a time.

Then, for each scanline the full set of intersecting tiles will get discarded
and re-read.

The most direct solution is to increase the block cache size with the
GDALSetCacheMax() function:

   http://www.gdal.org/gdal_8h.html#dfb1e95703ee577f012935869852d96c

It can also be helpful to enable debug output, and if you see a message about
cache thrashing when a dataset is closed that indicates that there are signs
of cache thrashing.

Best regards,
-
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Fri Jul 24 11:44:16 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Jul 24 11:44:46 2009
Subject: [gdal-dev] Problem with nodata values
In-Reply-To: <fb7c7e870907240620m1ebcfac7sbe1b25325179135@mail.gmail.com>
References: <fb7c7e870907240620m1ebcfac7sbe1b25325179135@mail.gmail.com>
Message-ID: <4A69D6D0.4040903@pobox.com>

Rainer M Krug wrote:
> Hi
> 
> I have a geotiff and want to use gdalwarp to warp to it into a
> different projection.
> I do the following:
> 
> gdalwarp -s_srs EPSG:32734 -t_srs '+proj=longlat +ellps=WGS84
> +no_defs' Outeniqua.tiff Outeniqua_wgs84.tiff
> 
> The problem is, that in Outeniqua_wgs84.tiff, the nodata values from
> Outeniqua.tiff become translated into -9999. In addition, the areas
> new to Outeniqua_wgs84.tiff (due to the warping) become 1.
> 
> Which options do I have to use to keep the nodata values and to make
> the values of the "new areas" also as nodata values?

Rainer,

I believe you want to pass the warp option INIT_DEST=-9999 to set all pixels
that do not come from the source file to -9999.

This is done with the -wo flag to gdalwarp.

eg.

gdalwarp -wo INIT_DEST=-9999 ...

The avalilable warp options are described in a web page available linked off
the gdalwarp utility page.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From maphew at gmail.com  Fri Jul 24 12:09:27 2009
From: maphew at gmail.com (Matt Wilkie)
Date: Fri Jul 24 12:09:30 2009
Subject: [Gdal-dev] gdal/ogr/proj and NAD83(CSRS)
In-Reply-To: <200907232013.36890.even.rouault@mines-paris.org>
References: <4A689A46.3000405@gov.yk.ca>
	<200907232013.36890.even.rouault@mines-paris.org>
Message-ID: <1248451767699-3316518.post@n2.nabble.com>


> Is there a difference between NAD83 and NAD83 CSRS ?
> (the difference between NAD83/GRS80 and WGS84/WGS84 
> is usually neglectable).

I have been operating on the presumption there must be _some_ kind of
important difference else they wouldn't have gone through the bother of
formulating and establishing a new standard. It would have been a long
process. In any case, I've done some more research and learned some things.
There's much more than I've quoted and a good graphics to visualise the
shape of the distortions. Most of the page is going to be required reading
in our shop ('twas hard to refrain from pasting the page entire!).

On WGS84 vs NAD83: "...From 1986 to 1994, WGS84 was considered the same as
NAD83. ...it turns out that "NAD83/WGS84" was mis-scaled, its origin was
offset and its axes were misaligned resulting in a coordinate shift in
Canada of 1 to 1.5 m. ... so on Jan 2, 1994, WGS84 was realigned to ITRF91
and was no longer compatible with NAD83.  This new realization of WGS84 was
called WGS84(G730) ...With low-cost recreational GPS receiver this 1.5 m
datum difference is inconsequential.  But when using higher-end GPS
receivers and/or correction techniques that provide metre accuracy and
better it must be considered."   -- http://www.geod.nrcan.gc.ca/faq_e.php#23 

The discussion on NAD83 vs NAD83(CSRS) is not as clear (to me anyway):
"...NAD83(CSRS) is consequently a more accurate and stable realization of
NAD83 ... The absolute accuracy of NAD83(CSRS) is of the order of a couple
of cm or better ... NAD83(Original) and NAD83(CSRS) are based on the same
fundamental NAD83 reference system. They are merely different realizations
or adjustments with different levels of accuracy.  Taking into account these
errors, NAD83(Original) and NAD83(CSRS) are completely compatible with one
another." -- http://www.geod.nrcan.gc.ca/faq_e.php#21

So my take on this is that it is fine to use NAD83 if the accuracy is 1m or
lower, but one should use NAD83(CSRS) (in Canada that is) when coordinate
accuracy is sub-meter. However even if the data in question is not sub-meter
if it is transformed one time with NAD83(CSRS) and another with NAD83 the
results will differ, so perhaps more important is to always use the same
datum (on data sharing a common lineage).

Now back to GDAL and related projects: does the fact that there is no proj4
NAD83(CSRS) datum parameter mean the X-to-NAD83(CSRS) transformation is not
happening? 

-matt
-- 
View this message in context: http://n2.nabble.com/gdal-ogr-proj-and-NAD83%28CSRS%29-tp3311110p3316518.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From maphew at gmail.com  Fri Jul 24 12:59:46 2009
From: maphew at gmail.com (Matt Wilkie)
Date: Fri Jul 24 12:59:48 2009
Subject: [Gdal-dev] gdal/ogr/proj and NAD83(CSRS)
In-Reply-To: <20090724152158.GE14401@mithrandir>
References: <4A689A46.3000405@gov.yk.ca> <20090724152158.GE14401@mithrandir>
Message-ID: <1248454786205-3316819.post@n2.nabble.com>


> I suspect EPSG does not define a NAD83(CSRS) datum 
> because it needs a dynamic reference frame definition, 
> which cannot be approximated decently with a seven parameters 
> transformation, anyway. So it would be not a proper approach.

For clarity, EPSG does define a NAD83(CSRS) datum, it's proj that isn't. As
for the second part of your comment: does this mean GDAL et al. only does 3
and 7 parameter transformations? and not any of the ITRF stuff? 

> ftp://geod.nrcan.gc.ca/pub/GSD/craymer/pubs/nad83_hydroscan2006.pdf
> ftp://geod.nrcan.gc.ca/pub/GSD/craymer/pubs/nad83_geomatica2006.pdf

Thanks for those Francesco. It is clear I have yet more studying to do!

-matt

-- 
View this message in context: http://n2.nabble.com/gdal-ogr-proj-and-NAD83%28CSRS%29-tp3311110p3316819.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From jorge.arevalo at gmail.com  Fri Jul 24 13:18:36 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Fri Jul 24 13:18:58 2009
Subject: [gdal-dev] Precission problem with atof
In-Reply-To: <36934.90.211.11.4.1248308248.squirrel@loskot.net>
References: <cb4457700907221601ye87d073u6e0765964dfb5216@mail.gmail.com> 
	<44062.90.211.11.4.1248306054.squirrel@loskot.net>
	<cb4457700907221657m48763ed4s9346684f5cc8d754@mail.gmail.com> 
	<36934.90.211.11.4.1248308248.squirrel@loskot.net>
Message-ID: <cb4457700907241018m3ac7e37el74f4efe0c7352ad3@mail.gmail.com>

2009/7/23 Mateusz Loskot <mateusz@loskot.net>:
> Jorge Ar??valo wrote:
>> 2009/7/23 Mateusz Loskot <mateusz@loskot.net>:
>>> Jorge Ar?&#65533;??valo wrote::
>>>> Hello,
>>>>
>>>> Context: GDAL WKT Raster Driver
>>>>
>>>> While creating the Dataset, I execute this query:
>>>>
>>>> SELECT srid, ST_AsText(extent), pixelsize_x, pixelsize_y, blocksize_x,
>>>> blocksize_y FROM raster_columns WHERE r_table_name = 'table' AND
>>>> r_column = 'rast'
>>>>
>>>> I have loaded a 3-band tiff file with gdal2tiles. Its pixel size is
>>>> 0.9. If I execute this line (over the result of the previous query):
>>>>
>>>> ??fPixelSizeX = atof(PQgetvalue(hPGresult, 0, 2));
>>>>
>>>> I get 0.899999976158142 instead of 0.9.
>>>
>>> Good.
>>>
>>>> The string obtained wiht PQgetvalue is "0.9", but, for any reason,
>>>> atof transform this string in 0.899999976158142.
>>>
>>> http://docs.sun.com/source/806-3568/ncg_goldberg.html
>>>
>>>> So, seems to be a
>>>> precission problem. think the string used by atof has any problem, but
>>>> I'm not sure
>>>
>>> Most computers suffer of this problem.
>>>
>>>> What should I do?
>>>
>>> You need to learn how to live with that problem :-)
>>>
>>>> I tried to change atof(nptr) for strtod(nptr,
>>>> (char**)NULL), but it didn't work...
>>>
>>> And it won't help.
>>>
>>> Best regards,
>>> --
>>> Mateusz Loskot
>>> http://mateusz.loskot.net
>>>
>>>
>>
>> Yes, a stupid problem. I used float instead of double.
>
> It's not a problem of float vs double.
> Replacing float with double does not guarantee that
> value 0.9 will be represented in memory as 0.9.
> It still can be 0.89999997...
>
> The float-point term in the docs I suggested does not mean C/C++ type float.
> It means float-point number in arithmetic, which in C/C++ can be float or
> double.

Ok. I changed float for double and now fPixelSize has 0.9, as I want.
But I understand, as you said, that "replacing float with double does
not guarantee that value 0.9 will be represented in memory as 0.9".
So, I'll read again the docs. I find them really interesting.

Many thanks again, Mateusz!

Best regards
Jorge



>
> Best regards
> --
> Mateusz Loskot
> http://mateusz.loskot.net
>
>
From frankie at debian.org  Fri Jul 24 15:46:54 2009
From: frankie at debian.org (Francesco Paolo Lovergine)
Date: Fri Jul 24 15:49:26 2009
Subject: [Gdal-dev] gdal/ogr/proj and NAD83(CSRS)
In-Reply-To: <1248451767699-3316518.post@n2.nabble.com>
References: <4A689A46.3000405@gov.yk.ca>
	<200907232013.36890.even.rouault@mines-paris.org>
	<1248451767699-3316518.post@n2.nabble.com>
Message-ID: <20090724194654.GB3933@frankie.is-a-geek.org>

On Fri, Jul 24, 2009 at 09:09:27AM -0700, Matt Wilkie wrote:
> 
> Now back to GDAL and related projects: does the fact that there is no proj4
> NAD83(CSRS) datum parameter mean the X-to-NAD83(CSRS) transformation is not
> happening? 
> 

AFAIK for Canada you can download the freely available NTv2 file from the 
CSRS database and use it with the +nadgrid parameter, if your
application requires high precision fitting. 

-- 
Francesco P. Lovergine
From jorge.arevalo at gmail.com  Sat Jul 25 04:41:28 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Sat Jul 25 04:41:51 2009
Subject: [gdal-dev] Re: 3 doubts on GDAL WKT Raster driver
In-Reply-To: <4A6A5B41.3080001@pobox.com>
References: <cb4457700907241000w42f338efq7c3d4bc3f89119b7@mail.gmail.com> 
	<4A6A5B41.3080001@pobox.com>
Message-ID: <cb4457700907250141p55f60befke6838a3f6946f9de@mail.gmail.com>

Hello Frank, I put these questions on the list too.

2009/7/25 Frank Warmerdam <warmerdam@pobox.com>:
> Jorge Ar?valo wrote:
>>
>> On one hand, if I want a driver that supports user-defined (or
>> raster_columns-defined, in this case) nodata values, I should
>> implement SetNoDataValue and GetNoDataValue methods on
>> RasterBand-derived class. SetNoDataValue method could simply store the
>> argument in a class property called "fNoDataValue", for example. And
>> GetNoDataValue could return this property. Ok, but... Don't I need
>> something more? Maybe a metadata entry? Which methods use this concept
>> of "NoDataValue" to perform any operation, or to take any decission? I
>> saw in PNG driver that only the method that create new datasets use
>> this nodata value. And it drives me to the next doubt...
>
> Jorge,
>
> I anticipate a few items needed for nodata support.
>
> 1) You need to initially read the nodata values for the different
> bands from the nodata_values array in the RASTER_COLUMNS table, and
> keep track of it on the band objects.

Yes, done. A property called "fNoDataValue" in the RasterBand keeps
the value. Enough?


>
> 2) You need to implement GetNoDataValue() to return that.

Done.

>
> 3) You need to implement SetNoDataValue() to update the value kept
> on the band, *and* to update the value in the RASTER_COLUMNS table.

Half-done :-). Easy to end.

>
> 4) The IReadBlock() method should fill the raster array with the
> nodata value if there is no corresponding block in the table.

OK, but only if the read nodata value for this block is different from
the nodata value in the raster_columns table, right? Oh, and the fact
that there's no corresponding block in the table is possible only in
cases of missing tiles, I suppose.

>
> Somewhat similarly, at some point you should implement SetGeoTransform()
> and SetProjection() in such a way that they update the
> pixelsize_x, pixelsize_y, extent and srid columns properly in
> the RASTER_COLUMNS table. ?I'm not sure if there would need to be
> a bulk update of blocks in the table - I imagine so. ?Ouch, I'm not
> sure if that should be high priority.

Understood. I think in common situations these values read from the
block will match the values in raster_column. So, I could set a lower
priority for this task. My high-priority tasks now are inplace update
and support for outdb rasters, plus correcting found errors (this is a
transversal task with highest priority always). I'm on the way :-)

>
>> The inplace update concept implies that I may want to update any
>> block/band information. For this reason, I've implemented the
>> IWriteBlock method on RasterBand-derived class. This concept is
>> different to the concept of creating new Datasets. Right?
>
> Right, this is not like creating a new dataset (table), or band
> on a dataset. ?All IWriteBlock does is replace the raster value
> of an existing row, or create a new row with the new raster value
> for the block if the block did not already exist.

OK. Done and testing.



>
>> ? If I want
>>
>> to support creating new datasets, I should implement the Create and/or
>> CreateCopy methods in Dataset class. Do I need to implement these
>> methods to support inplace update?
>
> Create() and/or CreateCopy() are not needed for inplace update. ?However,
> you may find you need to extend the Open() method to track whether the
> dataset is being opened for read-only or read-write access.

Yes, done.


>
>> Finally, the concept of overviews. I've written the code to support
>> overview creation. This is: The Dataset-derived class has an array of
>> Datasets as a class property. I create as many sub-datasets as
>> overview tables related with the WKT raster table are. All the
>> datasets have a pixel size reduced by its overview_factor, and all of
>> them are stored in the array. Should I do anything more? I'm not
>> really sure.
>
> I do not think it makes sense to support creating overviews until
> such time as you have implemented Create or CreateCopy since I
> imagine alot of common mechanics will be needed.

OK, but I've written the code for reading overviews in the way I've
described. Do you think that's the correct way...


>
>> Summarizing, I've implemented these Dataset methods:
>>
>> - Open
>> - GetProjectionRef
>> - GetGeoTransform
>>
>> And these RasterBand methods:
>>
>> - IReadBlock
>> - IWriteBlock
>> - GetColorInterpretation
>> - SetNoDataValue
>> - GetNoDataValue
>
> How did you implement GetColorInterpretation()? ?I was not aware
> that WKTRaster included any metadata about band color interpretation.
> If it does not, then you just leave the default implementation in
> place and avoid overriding it.

Yes, that was a doubt. I left the default implementation, because, as
you said, the WKT Raster don't include metadata about band color
interpretation, but later, I did a "default" interpretation. Simply,
if I have one band, I return Grey color, if I have 3 bands, RGB, and
if I have 4 bands, ARGB. Ok, they are only suppositions. 4 bands could
be CMYK scheme, instead of ARGB. I'll delete this implementation.


>
>> Plus additional auxiliary methods, and constructors/destructors.
>>
>> Should I implement any additional method if I want to support nodata
>> values, inplace update and overviews support? In addition to the
>> basis, of course (read-only support for regularly-blocking multiband
>> rasters)
>
> I believe overview creation is pretty involved. ?Do you already have
> overview reading implemented? ?Do you know if Mateusz has added support
> in his loader script to build overviews?

Yes, I've implemented overview reading. And Mateusz' script allow
building overview tables and overview metadata table.

>
> BTW, I think the above questions would be good ones to have asked on
> the list - adding the possibility of other useful feedback.

Done :-)

Thanks for responses.

Best regards
Jorge
From enrico.sartorello at gmail.com  Sat Jul 25 09:14:11 2009
From: enrico.sartorello at gmail.com (Enrico Sartorello)
Date: Sat Jul 25 09:19:45 2009
Subject: [gdal-dev] Extract BIGTiff libraries from GDAL source package
In-Reply-To: <1168e7300907240440u2589a07aj10b19400558b1bfb@mail.gmail.com>
References: <1168e7300907230156o689103fcj26fd419bce1a4544@mail.gmail.com>
	<4A68743A.4020403@comcast.net> <4A690A61.1090300@pobox.com>
	<1168e7300907240440u2589a07aj10b19400558b1bfb@mail.gmail.com>
Message-ID: <1168e7300907250614h532f125cw3237ce84a94a3c00@mail.gmail.com>

Another question: i've succesfully install BIGTiff from cvs using the usual
configure-make-make install process.
But how can i install the header files as well? I've looked on the Makefile
but can't understand if there's a particular directive to use.

Thanks in advance,

On Fri, Jul 24, 2009 at 1:40 PM, Enrico Sartorello <
enrico.sartorello@gmail.com> wrote:

> Hi Frank and David,
> thank you very much for your informations.
>
> As you've correctly told, my searches on Google lead me thinking that the
> Aperio distribution was the right side to get BIGTiff libraries.
> Now everything is clear to me, thanks for your clarification!
>
> Best regards,
>
>
> On Fri, Jul 24, 2009 at 3:12 AM, Frank Warmerdam <warmerdam@pobox.com>wrote:
>
>> David Burken wrote:
>>
>>> Enrico,
>>>
>>> I like to build straight from cvs:
>>>
>>> cvs -d :pserver:cvsanon@cvs.maptools.org:/cvs/maptools/cvsroot co
>>> libtiff
>>>
>>
>> Enrico,
>>
>> I concur with Dave.  The best place to get the latest libtiff4 with
>> bigtiff support is CVS.  Please note that the Aperio code is a distinct
>> fork of libtiff and not supported or encouraged for use by the core
>> libtiff maintainers (ie. me).  It is unfortunate that it places well on
>> a BigTIFF google search as it has lead several folks astray, including
>> at least one sizable commercial organization who helped fund the
>> official libtiff BigTIFF port!
>>
>> Best regards,
>>
>>  On 07/23/2009 04:56 AM, Enrico Sartorello wrote:
>>>
>>>> Hi all,
>>>> i need to have a correct BIGTiff package for using it in a program i've
>>>> written in C.
>>>>
>>>> As far as i can see, the bigtiff package distributed on
>>>> http://www.aperio.com/bigtiff/ is old and can't be correctly compiled,
>>>> so i thought i would get it from GDAL.
>>>> I've seen that BIGTiff is under gdal/frmts/gtiff/libtiff, and i'm even
>>>> able to make it separately from the rest of GDAL.
>>>> But make just create a bunch of *.o files from the sources on that dir
>>>> and nothing more i can use to replace a normal libtiff installation.
>>>>
>>>> What do i have to do to get my ready-to-use BIGTiff distribution?
>>>> Thanks in advance
>>>>
>>>> --
>>>> Enrico Sartorello
>>>> ------------------------------------------------------------------------
>>>>
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev@lists.osgeo.org
>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>
>>>
>>> ------------------------------------------------------------------------
>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev@lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>
>>
>> --
>>
>> ---------------------------------------+--------------------------------------
>> I set the clouds in motion - turn up   | Frank Warmerdam,
>> warmerdam@pobox.com
>> light and sound - activate the windows | http://pobox.com/~warmerdam<http://pobox.com/%7Ewarmerdam>
>> and watch the world go round - Rush    | Geospatial Programmer for Rent
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>
> --
> Enrico Sartorello
>



-- 
Enrico Sartorello
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090725/56be8bff/attachment-0001.html
From even.rouault at mines-paris.org  Sat Jul 25 09:28:21 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat Jul 25 09:28:33 2009
Subject: [gdal-dev] Extract BIGTiff libraries from GDAL source package
In-Reply-To: <1168e7300907250614h532f125cw3237ce84a94a3c00@mail.gmail.com>
References: <1168e7300907230156o689103fcj26fd419bce1a4544@mail.gmail.com>
	<1168e7300907240440u2589a07aj10b19400558b1bfb@mail.gmail.com>
	<1168e7300907250614h532f125cw3237ce84a94a3c00@mail.gmail.com>
Message-ID: <200907251528.22696.even.rouault@mines-paris.org>

make install will also install the headers in $PREFIX/include

Le Saturday 25 July 2009 15:14:11 Enrico Sartorello, vous avez ?crit?:
> Another question: i've succesfully install BIGTiff from cvs using the usual
> configure-make-make install process.
> But how can i install the header files as well? I've looked on the Makefile
> but can't understand if there's a particular directive to use.
>
> Thanks in advance,
>
> On Fri, Jul 24, 2009 at 1:40 PM, Enrico Sartorello <
>
> enrico.sartorello@gmail.com> wrote:
> > Hi Frank and David,
> > thank you very much for your informations.
> >
> > As you've correctly told, my searches on Google lead me thinking that the
> > Aperio distribution was the right side to get BIGTiff libraries.
> > Now everything is clear to me, thanks for your clarification!
> >
> > Best regards,
> >
> > On Fri, Jul 24, 2009 at 3:12 AM, Frank Warmerdam 
<warmerdam@pobox.com>wrote:
> >> David Burken wrote:
> >>> Enrico,
> >>>
> >>> I like to build straight from cvs:
> >>>
> >>> cvs -d :pserver:cvsanon@cvs.maptools.org:/cvs/maptools/cvsroot co
> >>> libtiff
> >>
> >> Enrico,
> >>
> >> I concur with Dave.  The best place to get the latest libtiff4 with
> >> bigtiff support is CVS.  Please note that the Aperio code is a distinct
> >> fork of libtiff and not supported or encouraged for use by the core
> >> libtiff maintainers (ie. me).  It is unfortunate that it places well on
> >> a BigTIFF google search as it has lead several folks astray, including
> >> at least one sizable commercial organization who helped fund the
> >> official libtiff BigTIFF port!
> >>
> >> Best regards,
> >>
> >>  On 07/23/2009 04:56 AM, Enrico Sartorello wrote:
> >>>> Hi all,
> >>>> i need to have a correct BIGTiff package for using it in a program
> >>>> i've written in C.
> >>>>
> >>>> As far as i can see, the bigtiff package distributed on
> >>>> http://www.aperio.com/bigtiff/ is old and can't be correctly compiled,
> >>>> so i thought i would get it from GDAL.
> >>>> I've seen that BIGTiff is under gdal/frmts/gtiff/libtiff, and i'm even
> >>>> able to make it separately from the rest of GDAL.
> >>>> But make just create a bunch of *.o files from the sources on that dir
> >>>> and nothing more i can use to replace a normal libtiff installation.
> >>>>
> >>>> What do i have to do to get my ready-to-use BIGTiff distribution?
> >>>> Thanks in advance
> >>>>
> >>>> --
> >>>> Enrico Sartorello
> >>>> ----------------------------------------------------------------------
> >>>>--
> >>>>
> >>>> _______________________________________________
> >>>> gdal-dev mailing list
> >>>> gdal-dev@lists.osgeo.org
> >>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >>>
> >>> -----------------------------------------------------------------------
> >>>-
> >>>
> >>> _______________________________________________
> >>> gdal-dev mailing list
> >>> gdal-dev@lists.osgeo.org
> >>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >>
> >> --
> >>
> >> ---------------------------------------+--------------------------------
> >>------ I set the clouds in motion - turn up   | Frank Warmerdam,
> >> warmerdam@pobox.com
> >> light and sound - activate the windows |
> >> http://pobox.com/~warmerdam<http://pobox.com/%7Ewarmerdam> and watch the
> >> world go round - Rush    | Geospatial Programmer for Rent
> >>
> >>
> >> _______________________________________________
> >> gdal-dev mailing list
> >> gdal-dev@lists.osgeo.org
> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >
> > --
> > Enrico Sartorello


From peifer at gmx.eu  Sat Jul 25 12:27:45 2009
From: peifer at gmx.eu (Hermann Peifer)
Date: Sat Jul 25 12:26:48 2009
Subject: [gdal-dev] Re: Problem with nodata values
In-Reply-To: <4A69D6D0.4040903@pobox.com>
References: <fb7c7e870907240620m1ebcfac7sbe1b25325179135@mail.gmail.com>
	<4A69D6D0.4040903@pobox.com>
Message-ID: <h4fbnq$qbf$1@ger.gmane.org>

Frank Warmerdam wrote:
> 
> I believe you want to pass the warp option INIT_DEST=-9999 to set all 
> pixels that do not come from the source file to -9999.
> 
> This is done with the -wo flag to gdalwarp.
> 
> eg.
> 
> gdalwarp -wo INIT_DEST=-9999 ...
> 

Frank, 

is the above warp option different to dstnodata -9999  ?

Hermann

From warmerdam at pobox.com  Sat Jul 25 13:44:49 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Sat Jul 25 13:44:57 2009
Subject: [gdal-dev] Re: Problem with nodata values
In-Reply-To: <h4fbnq$qbf$1@ger.gmane.org>
References: <fb7c7e870907240620m1ebcfac7sbe1b25325179135@mail.gmail.com>
	<4A69D6D0.4040903@pobox.com> <h4fbnq$qbf$1@ger.gmane.org>
Message-ID: <4A6B4491.2070905@pobox.com>

Hermann Peifer wrote:
> Frank Warmerdam wrote:
>>
>> I believe you want to pass the warp option INIT_DEST=-9999 to set all 
>> pixels that do not come from the source file to -9999.
>>
>> This is done with the -wo flag to gdalwarp.
>>
>> eg.
>>
>> gdalwarp -wo INIT_DEST=-9999 ...
>>
> 
> Frank,
> is the above warp option different to dstnodata -9999  ?

Hermann,

It appears they are distinct items.  The INIT_DEST essentially sets
the output file completely to the indicated value when it is created
while the dstnodata switch determines whether the warper considers an
existing pixel to be set in the output file yet or not when attempting
to do alpha blending and such.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From peifer at gmx.eu  Sat Jul 25 14:02:22 2009
From: peifer at gmx.eu (Hermann Peifer)
Date: Sat Jul 25 14:01:18 2009
Subject: [gdal-dev] Re: Problem with nodata values
In-Reply-To: <4A6B4491.2070905@pobox.com>
References: <fb7c7e870907240620m1ebcfac7sbe1b25325179135@mail.gmail.com>
	<4A69D6D0.4040903@pobox.com> <h4fbnq$qbf$1@ger.gmane.org>
	<4A6B4491.2070905@pobox.com>
Message-ID: <4A6B48AE.3050108@gmx.eu>

> 
> Hermann,
> 
> It appears they are distinct items.  The INIT_DEST essentially sets
> the output file completely to the indicated value when it is created
> while the dstnodata switch determines whether the warper considers an
> existing pixel to be set in the output file yet or not when attempting
> to do alpha blending and such.

Aha. Then the gdalwarp man page might be misleading. It says:

-dstnodata value [value...]:
   (...) New files will be initialized to this value and ...


On the other hand:
I am currently warping quite a lot of DEM files with '-srcnodata -9999 -dstnodata -9999' and the result is what I expected: both nodata values that existed in the source file and the additional ones generated through warping appear as -9999 in the destination file.

Hermann
From chaitanya.ch at gmail.com  Sat Jul 25 14:26:42 2009
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Sat Jul 25 14:26:44 2009
Subject: [gdal-dev] Possible error in the commit 14983
In-Reply-To: <eb502d880907251125o1cfe7f61ld356e61172815f7d@mail.gmail.com>
References: <eb502d880907251125o1cfe7f61ld356e61172815f7d@mail.gmail.com>
Message-ID: <eb502d880907251126n221130e5q3655f350f204a3e1@mail.gmail.com>

Daniel,

You added some code in MIFFile::AddFieldNative() in mitab_miffile.cpp in the
revision 14983<http://trac.osgeo.org/gdal/changeset/14983/trunk/gdal/ogr/ogrsf_frmts/mitab/mitab_miffile.cpp>.
(
http://trac.osgeo.org/gdal/changeset/14983/trunk/gdal/ogr/ogrsf_frmts/mitab/mitab_miffile.cpp)

In the line 1742 of the new version, the statement "m_nVersion =
MAX(m_nVersion, 900);" comes after the "break;" making it unreachable. Can
you check if it is desirable? Shall I move it to above the "break;"
statement?

Best regards,
-- 
Chaitanya kumar CH.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090725/d472d21e/attachment.html
From jopen at informatik.uni-bonn.de  Sun Jul 26 06:23:48 2009
From: jopen at informatik.uni-bonn.de (Sascha Alexander Jopen)
Date: Sun Jul 26 05:34:57 2009
Subject: [gdal-dev] Java bindings RuntimeException
Message-ID: <42701.92.204.8.94.1248600228.squirrel@webmail.iai.uni-bonn.de>

Hello,

i had to replace the gdal libraries and java bindings for an existing
application. I use the current svn trunk revision. But now i get a
RuntimeException whenever i try to use gdal.Open():

Exception in thread "main" java.lang.RuntimeException
	at org.gdal.gdal.MajorObject.<init>(MajorObject.java:17)
	at org.gdal.gdal.Dataset.<init>(Dataset.java:15)
	at org.gdal.gdal.gdal.Open(gdal.java:527)
	at gui.trackingGUI.openAndProcessOptionsDialog(trackingGUI.java:877)

This basically means, that the constructor MajorObject() receives a null
pointer as its cPtr argument. The inherited class' Dataset constructors
cPtr is non-null, however. So gdalJNI.SWIGDatasetUpcast(cPtr) produces
this null pointer. I can not debug this method, because it is executing
JNI native code.
The method in question is defined in gdal_wrap.cpp, and i can't see, why a
non-null pointer cast results in a null pointer.

Maybe some knows how to solve this problem or can me give some hints on
further debugging.

Thanks in advance,
Sascha Jopen

From jorge.arevalo at gmail.com  Sun Jul 26 06:23:00 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Sun Jul 26 06:23:24 2009
Subject: [gdal-dev] GDAL WKTRaster weekly report #9
Message-ID: <cb4457700907260323n25c80a6dxae52f5fd2994d051@mail.gmail.com>

Hello,

Here, the report:
http://www.gis4free.org/blog/2009/07/26/gsoc-09-weekly-report-9-1707-2407/

And here, the project page: http://trac.osgeo.org/gdal/wiki/WKTRasterDriver

Best regards
Jorge
From even.rouault at mines-paris.org  Sun Jul 26 13:02:37 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sun Jul 26 13:02:48 2009
Subject: [gdal-dev] Java bindings RuntimeException
In-Reply-To: <42701.92.204.8.94.1248600228.squirrel@webmail.iai.uni-bonn.de>
References: <42701.92.204.8.94.1248600228.squirrel@webmail.iai.uni-bonn.de>
Message-ID: <200907261902.38700.even.rouault@mines-paris.org>

Sascha,

I guess you are compiling with GCC ? If so, it appears that I accidently 
removed some weeks ago a very important compilation flag that I added a few 
months ago, namely -fno-strict-aliasing, that is necessary when compiling 
with -O2. It appears that SWIG generates not-so-correct code in regards to 
the C standard in the upcast methods (  *(foo**)&a = *(bar**)&b ) that the 
compiler can happily completely remove ! 

See http://trac.osgeo.org/gdal/changeset/16006 for the revision where it was 
introduced and http://trac.osgeo.org/gdal/changeset/17456 where it has come 
back.

Thanks for reporting this !

Best regards,
Even
From jopen at informatik.uni-bonn.de  Sun Jul 26 17:00:27 2009
From: jopen at informatik.uni-bonn.de (Sascha Alexander Jopen)
Date: Sun Jul 26 17:00:12 2009
Subject: [gdal-dev] Java bindings RuntimeException
In-Reply-To: <200907261902.38700.even.rouault@mines-paris.org>
References: <42701.92.204.8.94.1248600228.squirrel@webmail.iai.uni-bonn.de>
	<200907261902.38700.even.rouault@mines-paris.org>
Message-ID: <4A6CC3EB.5040709@informatik.uni-bonn.de>

Hello,

i was indeed using GCC. Thank you for fixing and commiting the changes
that fast. Know everything works as expected. At least those few methods
i am using.

Sincerely,
Sascha

> Sascha,
> 
> I guess you are compiling with GCC ? If so, it appears that I accidently 
> removed some weeks ago a very important compilation flag that I added a few 
> months ago, namely -fno-strict-aliasing, that is necessary when compiling 
> with -O2. It appears that SWIG generates not-so-correct code in regards to 
> the C standard in the upcast methods (  *(foo**)&a = *(bar**)&b ) that the 
> compiler can happily completely remove ! 
> 
> See http://trac.osgeo.org/gdal/changeset/16006 for the revision where it was 
> introduced and http://trac.osgeo.org/gdal/changeset/17456 where it has come 
> back.
> 
> Thanks for reporting this !
> 
> Best regards,
> Even

From dmorissette at mapgears.com  Mon Jul 27 10:11:30 2009
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Mon Jul 27 10:11:33 2009
Subject: [gdal-dev] Re: Possible error in the commit 14983
In-Reply-To: <eb502d880907251125o1cfe7f61ld356e61172815f7d@mail.gmail.com>
References: <eb502d880907251125o1cfe7f61ld356e61172815f7d@mail.gmail.com>
Message-ID: <4A6DB592.4000502@mapgears.com>

Hi Chaitanya,

Good catch! Yes, this was a silly mistake, the line should have been
above the break. I have fixed this in the master version. Will you apply
this fix in the OGR copy or should I do it?

Daniel

Chaitanya kumar CH wrote:
> Daniel,
> 
> You added some code in MIFFile::AddFieldNative() in mitab_miffile.cpp in 
> the revision 14983 
> <http://trac.osgeo.org/gdal/changeset/14983/trunk/gdal/ogr/ogrsf_frmts/mitab/mitab_miffile.cpp>. 
> ( 
> http://trac.osgeo.org/gdal/changeset/14983/trunk/gdal/ogr/ogrsf_frmts/mitab/mitab_miffile.cpp 
> )
> 
> In the line 1742 of the new version, the statement "m_nVersion = 
> MAX(m_nVersion, 900);" comes after the "break;" making it unreachable. 
> Can you check if it is desirable? Shall I move it to above the "break;" 
> statement?
> 
> Best regards,
> -- 
> Chaitanya kumar CH.


-- 
Daniel Morissette
http://www.mapgears.com/
From dmorissette at mapgears.com  Mon Jul 27 11:39:17 2009
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Mon Jul 27 11:39:19 2009
Subject: [gdal-dev] Re: Possible error in the commit 14983
In-Reply-To: <eb502d880907270804u5557a174k805d44410d77eb17@mail.gmail.com>
References: <eb502d880907251125o1cfe7f61ld356e61172815f7d@mail.gmail.com>	
	<4A6DB592.4000502@mapgears.com>
	<eb502d880907270804u5557a174k805d44410d77eb17@mail.gmail.com>
Message-ID: <4A6DCA25.9070000@mapgears.com>

Chaitanya kumar CH wrote:
> Daniel,
> 
> I caught this bug while I was going through Win32 compile warnings.
> I am attaching a patch for the other modifications in the mitab driver. 
> Please go through this apply to the master version. I'll apply both in 
> the GDAL/OGR trunk after your review this.
> 

Can you please create a OGR ticket for this? There are too many changes 
to apply without a ticket to justify. I can't imagine we need that many 
type casts, so there must be something else that's wrong there and I 
need to look deeper.

-- 
Daniel Morissette
http://www.mapgears.com/
From markus.reinhold at uni-jena.de  Mon Jul 27 21:02:48 2009
From: markus.reinhold at uni-jena.de (Markus Reinhold)
Date: Mon Jul 27 21:02:49 2009
Subject: [gdal-dev] Python 1.6 bindings under Windows
Message-ID: <4A6E4E38.2020402@uni-jena.de>

Dear all,
I'm pretty sure it has been asked before, however I wasn't able to find 
an answer to my question in the archive, so please bear with me...
I'm using a number of oss geo tools under Windows using the OSGeo4W 
binary distribution. I have installed the 1.6-version of GDAL and can 
find it under c:\osgeo4w\apps\gdal-16. This directory also includes the 
Python bindings that I want to use instead of my current ones. Now I'm 
stuck on how to achieve this. The usual *from osgeo import gdal* always 
supplies me with the current 1.5-version of the bindings, so I somehow 
suspect that I have to tell Python to prefer the 1.6-pymod directory 
over the one it usually uses - but how so?
A second question that is related to the first one: Is there any way to 
check the version of the bindings that have been imported by a script - 
anything analogous to "--version" on the command line?
I'd appreciate any help.
Thank you in advance.
Regards,
Markus

From hobu.inc at gmail.com  Mon Jul 27 21:48:22 2009
From: hobu.inc at gmail.com (Howard Butler)
Date: Mon Jul 27 21:49:51 2009
Subject: [gdal-dev] 1.6.2 release candidate due July 31st
Message-ID: <FF1C2B46-13CE-4FE0-93DF-2A02F36C05C2@gmail.com>

All,

Continuing my release manager role from the 1.6.1 release, I would  
like to produce a 1.6.2RC1 on July 31st.  Consider this your notice to  
complete any bugs or backports for the 1.6 branch.

http://trac.osgeo.org/gdal/milestone/1.6.2

Howard

From warmerdam at pobox.com  Mon Jul 27 22:40:50 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon Jul 27 22:40:55 2009
Subject: [gdal-dev] Python 1.6 bindings under Windows
In-Reply-To: <4A6E4E38.2020402@uni-jena.de>
References: <4A6E4E38.2020402@uni-jena.de>
Message-ID: <4A6E6532.1020102@pobox.com>

Markus Reinhold wrote:
> Dear all,
> I'm pretty sure it has been asked before, however I wasn't able to find 
> an answer to my question in the archive, so please bear with me...
> I'm using a number of oss geo tools under Windows using the OSGeo4W 
> binary distribution. I have installed the 1.6-version of GDAL and can 
> find it under c:\osgeo4w\apps\gdal-16. This directory also includes the 
> Python bindings that I want to use instead of my current ones. Now I'm 
> stuck on how to achieve this. The usual *from osgeo import gdal* always 
> supplies me with the current 1.5-version of the bindings, so I somehow 
> suspect that I have to tell Python to prefer the 1.6-pymod directory 
> over the one it usually uses - but how so?

Markus,

Normally this is accomplished as a side effect of running gdal16.bat to
switch to the GDAL 1.6 environment.  If you look at osgeo4w\bin\gdal16.bat
you will see it does:

   SET PYTHONPATH=%OSGEO4W_ROOT%\apps\gdal-16\pymod;%PYTHONPATH%

> A second question that is related to the first one: Is there any way to 
> check the version of the bindings that have been imported by a script - 
> anything analogous to "--version" on the command line?
> I'd appreciate any help.

The gdal.VersionInfo() function returns the version using GDALVersionInfo().
If no argument is passed "VERSION_NUM" is assumed, otherwise use the
following:

  * <ul>
  * <li> "VERSION_NUM": Returns GDAL_VERSION_NUM formatted as a string.  ie. "1170"
  * <li> "RELEASE_DATE": Returns GDAL_RELEASE_DATE formatted as a string.
  * ie. "20020416".
  * <li> "RELEASE_NAME": Returns the GDAL_RELEASE_NAME. ie. "1.1.7"
  * <li> "--version": Returns one line version message suitable for use in
  * response to --version requests.  ie. "GDAL 1.1.7, released 2002/04/16"
  * <li> "LICENCE": Returns the content of the LICENSE.TXT file from the 
GDAL_DATA directory.
  *      Before GDAL 1.7.0, the returned string was leaking memory but this is 
now resolved.
  *      So the result should not been freed by the caller.
  * </ul>

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From markus.reinhold at uni-jena.de  Tue Jul 28 04:41:36 2009
From: markus.reinhold at uni-jena.de (Markus Reinhold)
Date: Tue Jul 28 04:41:39 2009
Subject: [gdal-dev] Python 1.6 bindings under Windows
In-Reply-To: <4A6E6532.1020102@pobox.com>
References: <4A6E4E38.2020402@uni-jena.de> <4A6E6532.1020102@pobox.com>
Message-ID: <4A6EB9C0.7080207@uni-jena.de>

Hej again,
thank you for the suggestions.

> Normally this is accomplished as a side effect of running gdal16.bat to
> switch to the GDAL 1.6 environment.  If you look at osgeo4w\bin\gdal16.bat
> you will see it does:
> 
>   SET PYTHONPATH=%OSGEO4W_ROOT%\apps\gdal-16\pymod;%PYTHONPATH%
> 

As a matter of fact I have run gdal16.bat before, however the changes 
were only in effect within the shell of OSGeo4W. So to make the switch 
permanent one would have to set and/or change the environment variables 
used in the batch for the whole system accordingly?

> The gdal.VersionInfo() function returns the version using 
> GDALVersionInfo().

I'm pretty sure I had searched gdal.py for some sort of version property 
but at that time to no avail. Turns out I haven't looked thoroughly 
enough... Sorry to bother you.

Thanks again.
Regards,
Markus

From agnesyipck at gmail.com  Tue Jul 28 07:30:31 2009
From: agnesyipck at gmail.com (agnes123)
Date: Tue Jul 28 07:30:33 2009
Subject: [Gdal-dev] default pixel size in gdalwarp
Message-ID: <1248780631116-3341802.post@n2.nabble.com>



Dear all,

i have one question on the default pixel size in gdalwarp. 

In gdalwarp, we can use -tr to determine output pixel size in x and y
direction, however, if i omit the argument -tr , gdal will have a default
pixel size value which is in target projection units. 

For example, if the orginal input raster which has geodetic projection with
pixel size 0.000277778 (decimal degree), after projecting to Lambert
Conformal Conic without typing the argument -tr, gdal will have output
raster pixel size 28.793808m. What is the algorithm behind to obtain the
value 28.793808? 

I was wondering if there is somebody who knows it. I would greatly
appreciate it.Thanks!

Regards,
Agnes

-- 
View this message in context: http://n2.nabble.com/default-pixel-size-in-gdalwarp-tp3341802p3341802.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From patsv at bredband.net  Tue Jul 28 10:23:47 2009
From: patsv at bredband.net (patsv)
Date: Tue Jul 28 10:44:40 2009
Subject: [gdal-dev] BSB borders
Message-ID: <000801ca0f8f$05b7ec00$1127c400$@net>

Hi, I am having some problems with finding information about the size of the
map without the borders in the BSB dataset.

Is this information available or should I use the GCP points.

 

Regards

Patrik Svensson

 

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090728/84fb76da/attachment.html
From warmerdam at pobox.com  Tue Jul 28 11:10:00 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue Jul 28 11:10:12 2009
Subject: [gdal-dev] Python 1.6 bindings under Windows
In-Reply-To: <4A6EB9C0.7080207@uni-jena.de>
References: <4A6E4E38.2020402@uni-jena.de> <4A6E6532.1020102@pobox.com>
	<4A6EB9C0.7080207@uni-jena.de>
Message-ID: <4A6F14C8.5050606@pobox.com>

Markus Reinhold wrote:
> Hej again,
> thank you for the suggestions.
> 
>> Normally this is accomplished as a side effect of running gdal16.bat to
>> switch to the GDAL 1.6 environment.  If you look at 
>> osgeo4w\bin\gdal16.bat
>> you will see it does:
>>
>>   SET PYTHONPATH=%OSGEO4W_ROOT%\apps\gdal-16\pymod;%PYTHONPATH%
>>
> 
> As a matter of fact I have run gdal16.bat before, however the changes 
> were only in effect within the shell of OSGeo4W. So to make the switch 
> permanent one would have to set and/or change the environment variables 
> used in the batch for the whole system accordingly?

Markus,

OSGeo4W is setup so that the python stuff works either from the shell
or from the apache environment.  It is not really intended to be
"system wide".  For instance, the OSGeo4W python can coexist with other
system python versions as long as you don't mix things.

If you want to use OSGeo4W Python stuff at the system level you are
mostly on your own.   But if your system python is a compatible version
you should be able to just set the PYTHONPATH at the system level similarly
to how OSGeo4W (and gdal16.bat) set it.

>> The gdal.VersionInfo() function returns the version using 
>> GDALVersionInfo().
> 
> I'm pretty sure I had searched gdal.py for some sort of version property 
> but at that time to no avail. Turns out I haven't looked thoroughly 
> enough... Sorry to bother you.

no problem.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From mitchelljj98 at gmail.com  Tue Jul 28 12:14:26 2009
From: mitchelljj98 at gmail.com (John Mitchell)
Date: Tue Jul 28 12:14:27 2009
Subject: [gdal-dev] Can google earth skin format be converted by GDAL to be
	used within MapServer?
Message-ID: <fa2ac0580907280914rdb4aba1u3622216c4f04ae71@mail.gmail.com>

Hi,
Can google earth skin format be converted by GDAL to be used within
MapServer?

Thanks,

John J. Mitchell

-- 
John J. Mitchell
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090728/d72eb254/attachment.html
From maphew at gmail.com  Tue Jul 28 13:25:07 2009
From: maphew at gmail.com (Matt Wilkie)
Date: Tue Jul 28 13:25:09 2009
Subject: [Gdal-dev] gdal/ogr/proj and NAD83(CSRS)
In-Reply-To: <20090724194654.GB3933@frankie.is-a-geek.org>
References: <4A689A46.3000405@gov.yk.ca>
	<200907232013.36890.even.rouault@mines-paris.org>
	<1248451767699-3316518.post@n2.nabble.com>
	<20090724194654.GB3933@frankie.is-a-geek.org>
Message-ID: <1248801907212-3344691.post@n2.nabble.com>


Let's see if I have this straight then: if I specify -t_srs epsg:4617 and not
+nadgrid, no datum transformation occurs, even though the output .prj file
says it has?

-matt


Francesco P. Lovergine wrote:
> 
> On Fri, Jul 24, 2009 at 09:09:27AM -0700, Matt Wilkie wrote:
>> 
>> Now back to GDAL and related projects: does the fact that there is no
>> proj4
>> NAD83(CSRS) datum parameter mean the X-to-NAD83(CSRS) transformation is
>> not
>> happening? 
> 
> AFAIK for Canada you can download the freely available NTv2 file from the 
> CSRS database and use it with the +nadgrid parameter, if your
> application requires high precision fitting. 
> 


-- 
View this message in context: http://n2.nabble.com/gdal-ogr-proj-and-NAD83%28CSRS%29-tp3311110p3344691.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From robert.coup at koordinates.com  Tue Jul 28 15:47:36 2009
From: robert.coup at koordinates.com (Robert Coup)
Date: Tue Jul 28 15:47:40 2009
Subject: [Gdal-dev] gdal/ogr/proj and NAD83(CSRS)
In-Reply-To: <1248801907212-3344691.post@n2.nabble.com>
References: <4A689A46.3000405@gov.yk.ca>
	<200907232013.36890.even.rouault@mines-paris.org>
	<1248451767699-3316518.post@n2.nabble.com>
	<20090724194654.GB3933@frankie.is-a-geek.org>
	<1248801907212-3344691.post@n2.nabble.com>
Message-ID: <c5097ac40907281247n6a3d2beer8587ab2b35df4aca@mail.gmail.com>

On Wed, Jul 29, 2009 at 5:25 AM, Matt Wilkie <maphew@gmail.com> wrote:

>
> Let's see if I have this straight then: if I specify -t_srs epsg:4617 and
> not
> +nadgrid, no datum transformation occurs, even though the output .prj file
> says it has?


If your projection definition in Proj4/OGR has a datum defined it will go
through one of the following (in order of preference) if the datum's are
different:

 - a gridshift (the first matching one if there are >1)
 - or a 7 parameter transform (+towgs84=#,#,#,#,#,#,# if specified)
 - or a 3 parameter transform (+towgs84=#,#,# if specified)
 - or do nothing

It does that from source-datum to WGS84, then from WGS84 to the dest-datum.
A datum in Proj is defined as an ellipse and a towgs84 or gridshift
combination, +datum= just pre-populates this info. For Proj's purposes,
GRS80 and WGS84 are the same ellipse.

cs2cs -v is quite clear about what it's doing, OGR not so much.

Using the "straight" Proj EPSG defs on my system:

$ cs2cs -v +init=epsg:3579 +to +init=epsg:4617
# ---- From Coordinate System ----
#Albers Equal Area
#       Conic Sph&Ell
#       lat_1= lat_2=
# +init=epsg:3579 +proj=aea +lat_1=61.66666666666666 +lat_2=68 +lat_0=59
# +lon_0=-132.5 +x_0=500000 +y_0=500000 +ellps=GRS80 +units=m +no_defs
# ---- To Coordinate System ----
#Lat/long (Geodetic alias)
#
# +init=epsg:4617 +proj=longlat +ellps=GRS80 +no_defs

No datum transform will happen (ellipses match, and +towgs84 is ommitted (ie
==0)).

HTH,

Rob :)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090729/853d6108/attachment.html
From maphew at gmail.com  Tue Jul 28 17:48:31 2009
From: maphew at gmail.com (Matt Wilkie)
Date: Tue Jul 28 17:48:33 2009
Subject: [Gdal-dev] gdal/ogr/proj and NAD83(CSRS)
In-Reply-To: <c5097ac40907281247n6a3d2beer8587ab2b35df4aca@mail.gmail.com>
References: <4A689A46.3000405@gov.yk.ca>
	<200907232013.36890.even.rouault@mines-paris.org>
	<1248451767699-3316518.post@n2.nabble.com>
	<20090724194654.GB3933@frankie.is-a-geek.org>
	<1248801907212-3344691.post@n2.nabble.com>
	<c5097ac40907281247n6a3d2beer8587ab2b35df4aca@mail.gmail.com>
Message-ID: <1248817711472-3346244.post@n2.nabble.com>


Hi Robert, thank you for contributing your insight, it helps!

> cs2cs -v is quite clear about what it's doing, OGR not so much.
>
> Using the "straight" Proj EPSG defs on my system:
> $ cs2cs -v +init=epsg:3579 +to +init=epsg:4617
...
> No datum transform will happen  (ellipses match, and +towgs84 is ommitted (ie ==0)).

Then I would say it is improper for ogr2ogr to write NAD83(CSRS) in
the output .prj. Proj4 and dependant projects may think WGS84, NAD83
and NAD83(CSRS) are synonymous but from my reading over the last
couple of weeks it is clear that while the first two were
interchangeable at one time, they are not now.

In future a person or program using data defined as NAD83(CSRS) will
reasonably expect sub-meter datum accuracy, for that is the purpose of
the datum. if this is not the case, it should not call itself such.

best regards,

-matt

-- 
View this message in context: http://n2.nabble.com/gdal-ogr-proj-and-NAD83%28CSRS%29-tp3311110p3346244.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090728/a005bded/attachment.html
From robert.coup at onetrackmind.co.nz  Tue Jul 28 18:21:53 2009
From: robert.coup at onetrackmind.co.nz (Robert Coup)
Date: Tue Jul 28 18:21:56 2009
Subject: [Gdal-dev] gdal/ogr/proj and NAD83(CSRS)
In-Reply-To: <1248817711472-3346244.post@n2.nabble.com>
References: <4A689A46.3000405@gov.yk.ca>
	<200907232013.36890.even.rouault@mines-paris.org>
	<1248451767699-3316518.post@n2.nabble.com>
	<20090724194654.GB3933@frankie.is-a-geek.org>
	<1248801907212-3344691.post@n2.nabble.com>
	<c5097ac40907281247n6a3d2beer8587ab2b35df4aca@mail.gmail.com>
	<1248817711472-3346244.post@n2.nabble.com>
Message-ID: <c5097ac40907281521s1a07af60ycb262a01c9ec9454@mail.gmail.com>

On Wed, Jul 29, 2009 at 9:48 AM, Matt Wilkie <maphew@gmail.com> wrote:

> Hi Robert, thank you for contributing your insight, it helps!
>
> > cs2cs -v is quite clear about what it's doing, OGR not so much.
> >
> > Using the "straight" Proj EPSG defs on my system:
> > $ cs2cs -v +init=epsg:3579 +to +init=epsg:4617
> ...
> > No datum transform will happen  (ellipses match, and +towgs84 is ommitted
> (ie ==0)).
>
> Then I would say it is improper for ogr2ogr to write NAD83(CSRS) in
> the output .prj. Proj4 and dependant projects may think WGS84, NAD83
> and NAD83(CSRS) are synonymous but from my reading over the last
> couple of weeks it is clear that while the first two were
> interchangeable at one time, they are not now.
>
> In future a person or program using data defined as NAD83(CSRS) will
> reasonably expect sub-meter datum accuracy, for that is the purpose of
> the datum. if this is not the case, it should not call itself such.


The accuracy of any data is irrelevant to the projection it's in though. I
can digitize data from satellite images that are up to 100m off
horizontally, or from paper maps at 1:500K with cartographic license taken.
Whether I do it in NAD83(CSRS) or any other projection/datum - that doesn't
impact the data quality - that's based off where the information comes from
and what I've done to it.

Whenever i convert datums I will lose information, that's reality. People
tend to convert datums via magic commands and assume it's all perfect but it
needs to be pretty carefully understood what it means (which i think you now
do).

Proj4 just converts numbers. Where the numbers are defined from (EPSG
definitions or your own) and what they mean is a whole other kettle of fish.

Rob :)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090729/f536dd5a/attachment.html
From maphew at gmail.com  Tue Jul 28 19:46:55 2009
From: maphew at gmail.com (Matt Wilkie)
Date: Tue Jul 28 19:46:57 2009
Subject: [Gdal-dev] gdal/ogr/proj and NAD83(CSRS)
In-Reply-To: <c5097ac40907281521s1a07af60ycb262a01c9ec9454@mail.gmail.com>
References: <4A689A46.3000405@gov.yk.ca>
	<200907232013.36890.even.rouault@mines-paris.org>
	<1248451767699-3316518.post@n2.nabble.com>
	<20090724194654.GB3933@frankie.is-a-geek.org>
	<1248801907212-3344691.post@n2.nabble.com>
	<c5097ac40907281247n6a3d2beer8587ab2b35df4aca@mail.gmail.com>
	<1248817711472-3346244.post@n2.nabble.com>
	<c5097ac40907281521s1a07af60ycb262a01c9ec9454@mail.gmail.com>
Message-ID: <c61d98af0907281646w5a1be4bic5c1b10686123bd8@mail.gmail.com>

>> In future a person or program using data defined as NAD83(CSRS) will
>> reasonably expect sub-meter datum accuracy, for that is the purpose of
>> the datum. if this is not the case, it should not call itself such.
>
> The accuracy of any data is irrelevant to the projection it's in though. I
> can digitize data from satellite images that are up to 100m off
> horizontally, or from paper maps at 1:500K with cartographic license taken.
> Whether I do it in NAD83(CSRS) or any other projection/datum - that doesn't
> impact the data quality - that's based off where the information comes from
> and what I've done to it.

Yes exactly, that's why I said *datum* accuracy, as distinct from
coordinate or projection accuracy.

> Whenever i convert datums I will lose information, that's reality. People
> tend to convert datums via magic commands and assume it's all perfect but it
> needs to be pretty carefully understood what it means (which i think you now
> do).

Well I certainly have a lot more facts and figures in my head. It
remains to be seen whether it has resulted in greater understanding!
:)  I'm okay with magic commands losing information when it's just
part of the way things work and documented. I'm not so comfortable
when loss is not apparent, or worse obscured, which is what I see
happening here and why I'm continuing to pick at it.

I'd like to return to something touched on earlier but not explored
fully. In the background of ogr2ogr, cs2cs, etc. what parameters are
actually used in the conversion/transformation? One can use any of
proj4 strings, EPSG:nnn, OGC or ESRI WKT and maybe some others on the
command line, but as this thread reveals there are parameters within
these syntax which are silently passed by. What or where is the
authoritive list of supported parameters? (or the list of ignored ones
if that is shorter)

thanks,

-- 
-matt
From maplabs at light42.com  Wed Jul 29 00:22:52 2009
From: maplabs at light42.com (Brian Hamlin)
Date: Tue Jul 28 23:27:41 2009
Subject: [gdal-dev] fail gdal autotest rev-17474
Message-ID: <7B4C2B9E-7BF7-11DE-8D17-0003936901F0@light42.com>

its SegFaulting at    gcore/mask.py   mask_5

http://paste.debian.net/42924/



==
Brian Hamlin
ISDE5 Steering Committee
Planetwork.net
OSGeo California Chapter

From warmerdam at pobox.com  Tue Jul 28 23:44:38 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue Jul 28 23:44:40 2009
Subject: [gdal-dev] fail gdal autotest rev-17474
In-Reply-To: <7B4C2B9E-7BF7-11DE-8D17-0003936901F0@light42.com>
References: <7B4C2B9E-7BF7-11DE-8D17-0003936901F0@light42.com>
Message-ID: <4A6FC5A6.3020208@pobox.com>

Brian Hamlin wrote:
> its SegFaulting at    gcore/mask.py   mask_5
> 
> http://paste.debian.net/42924/

Brian,

I'm not seeing that problem here.  This this just happen to you recently
after things were working?  Are you using an external system libtiff?  If
so, the problem may be that the test exposes bugs in older libtiffs.
Building with an internal libtiff may be more appropriate for the test
suite.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Wed Jul 29 01:14:15 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Jul 29 01:14:24 2009
Subject: [gdal-dev] Re: [SoC] GDAL WKTRaster weekly report #9
In-Reply-To: <cb4457700907260323n25c80a6dxae52f5fd2994d051@mail.gmail.com>
References: <cb4457700907260323n25c80a6dxae52f5fd2994d051@mail.gmail.com>
Message-ID: <4A6FDAA7.1020903@pobox.com>

Jorge Ar?valo wrote:
> Hello,
> 
> Here, the report:
> http://www.gis4free.org/blog/2009/07/26/gsoc-09-weekly-report-9-1707-2407/
> 
> And here, the project page: http://trac.osgeo.org/gdal/wiki/WKTRasterDriver

Jorge,

The progress looks good. You mentioned adding overviews tables as
subdatasets of the general dataset.  This isn't the usual way of
representing overviews which should be accessable via GetOverview() on
the GDALRasterBand.  Was this aspect done as well?

Is there any mechanism currently for creating overviews?  How have
you been testing overviews?

Under DOUBTs you ask what happens if the bounding box of a block
does not match any real block in the table, what should happen.  In this
case IReadBlock() should fill the buffer with the nodata value (zero if
nodata is not set).

You also mention a doubt about how to handle the 16BF type, which is
apparently "16-bit float".  I have never seen such a thing before and I'm
not sure why it is part of the WKTRaster specification. I would suggest
removing it.

However, if we wanted to support it (and you could figure out what it
actually is), then I think it would be most appropriate to transform it
into a 32bit float as it is read in IReadBlock().  Presumably the full
range of a 16bit float could not be kept in a 16 bit integer.

Likewise, 1BB, 2BUI, and 4BUI values (if supported) should be
translated on the fly into GDT_Byte values.  However, there is a special
NBITS metadata item in the IMAGE_STRUCTURE metadata domain that can
be set in these cases to represent the special nature of the image data.
Likewise there is a special value to indicate signed eight bit integers.
These values are discussed in:

   http://trac.osgeo.org/gdal/wiki/rfc14_imagestructure

However, I consider implementation of these esoteric types optional given
the relatively limited time remaining.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Wed Jul 29 01:26:29 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Jul 29 01:26:32 2009
Subject: [gdal-dev] BSB borders
In-Reply-To: <000801ca0f8f$05b7ec00$1127c400$@net>
References: <000801ca0f8f$05b7ec00$1127c400$@net>
Message-ID: <4A6FDD85.4010908@pobox.com>

patsv wrote:
> Hi, I am having some problems with finding information about the size of 
> the map without the borders in the BSB dataset.
> 
> Is this information available or should I use the GCP points.

Patrik,

I am not sure of a way to identify what is the map collar in a BSB file.
It may be that the information is in the header, but not made available
through GDAL.  I do not believe you can trust the GCPs to define the
map edges for all map sources.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Wed Jul 29 01:29:53 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Jul 29 01:29:53 2009
Subject: [Gdal-dev] default pixel size in gdalwarp
In-Reply-To: <1248780631116-3341802.post@n2.nabble.com>
References: <1248780631116-3341802.post@n2.nabble.com>
Message-ID: <4A6FDE51.6020505@pobox.com>

agnes123 wrote:
> 
> Dear all,
> 
> i have one question on the default pixel size in gdalwarp. 
> 
> In gdalwarp, we can use -tr to determine output pixel size in x and y
> direction, however, if i omit the argument -tr , gdal will have a default
> pixel size value which is in target projection units. 
> 
> For example, if the orginal input raster which has geodetic projection with
> pixel size 0.000277778 (decimal degree), after projecting to Lambert
> Conformal Conic without typing the argument -tr, gdal will have output
> raster pixel size 28.793808m. What is the algorithm behind to obtain the
> value 28.793808? 
> 
> I was wondering if there is somebody who knows it. I would greatly
> appreciate it.Thanks!
> 
> Regards,
> Agnes
> 

Agnes,

The computation is done by the GDALSuggestedWarpOutput2() function.  I would
suggest you read it's documentation and if still in doubt scan through the
code.

   http://trac.osgeo.org/gdal/browser/trunk/gdal/alg/gdaltransformer.cpp#L162

It is basically a heuristic to maintain approximately the same diagonal
size of a pixel in the destination coordinate system as it was in the
source coordinate system.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From maplabs at light42.com  Wed Jul 29 03:05:28 2009
From: maplabs at light42.com (Brian Hamlin)
Date: Wed Jul 29 02:10:19 2009
Subject: [gdal-dev] fail gdal autotest rev-17474
In-Reply-To: <4A6FC5A6.3020208@pobox.com>
References: <7B4C2B9E-7BF7-11DE-8D17-0003936901F0@light42.com>
	<4A6FC5A6.3020208@pobox.com>
Message-ID: <3258EFE2-7C0E-11DE-8D17-0003936901F0@light42.com>

On Jul 28, 2009, at 8:44 PM, Frank Warmerdam wrote:

> Brian Hamlin wrote:
>> its SegFaulting at    gcore/mask.py   mask_5
>> http://paste.debian.net/42924/
>
> Brian,
>
> I'm not seeing that problem here.  This this just happen to you 
> recently
> after things were working?  Are you using an external system libtiff?  
> If
> so, the problem may be that the test exposes bugs in older libtiffs.
> Building with an internal libtiff may be more appropriate for the test
> suite.
>

ok, I hadnt needed to call out libtiff=internal previously, it seemed 
to be doing that already
but, after make clean and a new configure --with-libtiff=internal
the symptom went away...  thanks!

   -Brian

From r.m.krug at gmail.com  Wed Jul 29 03:08:49 2009
From: r.m.krug at gmail.com (Rainer M Krug)
Date: Wed Jul 29 03:08:54 2009
Subject: [gdal-dev] Problem with nodata values
In-Reply-To: <4A69D6D0.4040903@pobox.com>
References: <fb7c7e870907240620m1ebcfac7sbe1b25325179135@mail.gmail.com>
	<4A69D6D0.4040903@pobox.com>
Message-ID: <fb7c7e870907290008q709c9426j7da5029b87768d8c@mail.gmail.com>

On Fri, Jul 24, 2009 at 5:44 PM, Frank Warmerdam<warmerdam@pobox.com> wrote:
> Rainer M Krug wrote:
>>
>> Hi
>>
>> I have a geotiff and want to use gdalwarp to warp to it into a
>> different projection.
>> I do the following:
>>
>> gdalwarp -s_srs EPSG:32734 -t_srs '+proj=longlat +ellps=WGS84
>> +no_defs' Outeniqua.tiff Outeniqua_wgs84.tiff
>>
>> The problem is, that in Outeniqua_wgs84.tiff, the nodata values from
>> Outeniqua.tiff become translated into -9999. In addition, the areas
>> new to Outeniqua_wgs84.tiff (due to the warping) become 1.
>>
>> Which options do I have to use to keep the nodata values and to make
>> the values of the "new areas" also as nodata values?
>
> Rainer,
>
> I believe you want to pass the warp option INIT_DEST=-9999 to set all pixels
> that do not come from the source file to -9999.

Thanks a lot - that solved it partly. I now have all original pixels
unequal to NULL now warped as they should be. Only slight problemk
now: all NULL values from the input file, are now -9999 and I would
prefer to heve them as NULL. I managed that by using gdal_translate
and the -a_nulldata option, but shouldn't that be possible in
gralwarp?

Rainer

>
> This is done with the -wo flag to gdalwarp.
>
> eg.
>
> gdalwarp -wo INIT_DEST=-9999 ...
>
> The avalilable warp options are described in a web page available linked off
> the gdalwarp utility page.
>
> Best regards,
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up ? | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush ? ?| Geospatial Programmer for Rent
>
>



-- 
Rainer M. Krug, Centre of Excellence for Invasion Biology,
Stellenbosch University, South Africa
From jachym.cepicky at gmail.com  Wed Jul 29 03:48:35 2009
From: jachym.cepicky at gmail.com (Jachym Cepicky)
Date: Wed Jul 29 03:48:41 2009
Subject: [gdal-dev] python gdal gdal.ReprojectImage produces no data
Message-ID: <20090729074835.GB17404@kocour>

Hi

I would like to write "custom" version of the gdalwarp tool in Python
using gdal.ReprojectImage() function, but the only result I get, is just
a empty "black" image.

The code would look like this:

# -------     python code start  -------
from osgeo import gdal

# let's have georeferenced geotiff
inds = gdal.Open("filename.tif")

# it *is* georeferenced
inds.GetProjection()
# 'GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS 84",6378137,298.2572235629972,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433],AUTHORITY["EPSG","4326"]]'

# create the driver
driver = gdal.GetDriverByName("GTiff")

# create new output file
outds = driver.Create("outfile.tif",inds.RasterXSize, inds.RasterYSize)

# do the transformation - actually no transformation at all
gdal.ReprojectImage(inds, outds, inds.GetProjection(), inds.GetProjection())

# close
outds = None
inds = None
# -------     python code end  -------

As result, the new created file should be the same, like to original
file was.

When I run gdalinfo on the original file, I get 

Driver: GTiff/GeoTIFF
Files: /tmp/elevationwgs.tif
Size is 709, 386
Coordinate System is:
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.2572235629972,
            AUTHORITY["EPSG","7030"]],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0],
    UNIT["degree",0.0174532925199433],
    AUTHORITY["EPSG","4326"]]
Origin = (-103.871109718285695,44.501735270606410)
Pixel Size = (0.000340671212621,-0.000340671212621)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (-103.8711097,  44.5017353) (103d52'15.99"W, 44d30'6.25"N)
Lower Left  (-103.8711097,  44.3702362) (103d52'15.99"W, 44d22'12.85"N)
Upper Right (-103.6295738,  44.5017353) (103d37'46.47"W, 44d30'6.25"N)
Lower Right (-103.6295738,  44.3702362) (103d37'46.47"W, 44d22'12.85"N)
Center      (-103.7503418,  44.4359857) (103d45'1.23"W, 44d26'9.55"N)
Band 1 Block=709x5 Type=UInt16, ColorInterp=Palette
  Color Table (RGB with 65536 entries)
    0: 255,255,255,255
    1: 255,255,255,255
    [...]
    65535: 0,0,0,255

When I run gdalinfo on the new created file file, I get 

Driver: GTiff/GeoTIFF
Files: /tmp/pokus12
Size is 709, 386
Coordinate System is `'
Image Structure Metadata:
  INTERLEAVE=BAND
  Corner Coordinates:
  Upper Left  (    0.0,    0.0)
  Lower Left  (    0.0,  386.0)
  Upper Right (  709.0,    0.0)
  Lower Right (  709.0,  386.0)
  Center      (  354.5,  193.0)
  Band 1 Block=709x11 Type=Byte, ColorInterp=Gray


That was all :-( Projection and coordinates can be set using
dsout.SetProjection and dsout.SetGeoTransform - that would not be a
problem. The problem are the data, which were not copied.

I'm I missing something? Could this be a problem of my GDAL
installation?

gdalinfo --version
GDAL 1.6.1, released 2009/05/11

(gdal.__version__  is not existing in python)

Thanks

Jachym
-- 
Jachym Cepicky
e-mail: jachym.cepicky gmail com
URL: http://les-ejk.cz
GPG: http://www.les-ejk.cz/pgp/JachymCepicky.pgp
Key fingerprint: 0C6D 0EAE 76BD 506C F299  ED8A C8AB 74B8 08D4 E08F
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090729/961437bc/attachment.bin
From j.donovan at virtalis.com  Wed Jul 29 04:33:54 2009
From: j.donovan at virtalis.com (John Donovan)
Date: Wed Jul 29 04:34:04 2009
Subject: [gdal-dev] RE: GDAL WKTRaster weekly report #9
Message-ID: <C8891C79DFCAB347B9221DF3890EDD2F195BCD@topdog.Virtalis.local>

> You also mention a doubt about how to handle the 16BF type, which is
> apparently "16-bit float".  I have never seen such a thing before and
I'm not
> sure why it is part of the WKTRaster specification. I would suggest
removing
> it.

It is a format, also called a half-float, used by the likes of ATI and
nVidia. Useful for low-precision stuff in realtime graphics and GPGPU,
but probably of limited use to everyone else.

-JD

______________________________________________________________________
This email has been scanned for Virtalis Ltd by the MessageLabs Email Security System. ______________________________________________________________________
From mateusz at loskot.net  Wed Jul 29 09:10:23 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Jul 29 09:08:39 2009
Subject: [gdal-dev] Re: [SoC] GDAL WKTRaster weekly report #9
In-Reply-To: <4A6FDAA7.1020903@pobox.com>
References: <cb4457700907260323n25c80a6dxae52f5fd2994d051@mail.gmail.com>
	<4A6FDAA7.1020903@pobox.com>
Message-ID: <4A704A3F.1030804@loskot.net>

Frank Warmerdam wrote:
> Is there any mechanism currently for creating overviews?  How have
> you been testing overviews?

Frank,

I suppose you are asking for the GDAL driver.
However, just to confirm, gdal2wktraster can generate
WKT Raster datasets with overviews (in regular blocking mode).

> Under DOUBTs you ask what happens if the bounding box of a block
> does not match any real block in the table, what should happen.  In this
> case IReadBlock() should fill the buffer with the nodata value (zero if
> nodata is not set).

This is exactly what gdal2wktraster does when tiles (blocks) of
downsampled rasters have to get some padding along right-most
or bottom-most column:

http://trac.osgeo.org/postgis/browser/spike/wktraster/scripts/gdal2wktraster.py#L801

Certainly, it's client's (or perhaps GDAL driver too) responsibility to
clip padded tiles and remove such areas of invalid raster data.

> You also mention a doubt about how to handle the 16BF type, which is
> apparently "16-bit float".  I have never seen such a thing before and I'm
> not sure why it is part of the WKTRaster specification. I would suggest
> removing it.

I had same impression and I simply don't use this data anywhere in
gdal2wktraster script.

I believe the right person to ask about this 16-bit float type is
Sandro (strk) - he is the author of original specification documents:

http://trac.osgeo.org/postgis/browser/spike/wktraster/doc

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From mateusz at loskot.net  Wed Jul 29 09:26:17 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Jul 29 09:24:33 2009
Subject: [gdal-dev] Re: [SoC] GDAL WKTRaster weekly report #9
In-Reply-To: <4A704A3F.1030804@loskot.net>
References: <cb4457700907260323n25c80a6dxae52f5fd2994d051@mail.gmail.com>	<4A6FDAA7.1020903@pobox.com>
	<4A704A3F.1030804@loskot.net>
Message-ID: <4A704DF9.6000403@loskot.net>

Mateusz Loskot wrote:
> Frank Warmerdam wrote:
>> You also mention a doubt about how to handle the 16BF type, which
>> is apparently "16-bit float".  I have never seen such a thing
>> before and I'm not sure why it is part of the WKTRaster
>> specification. I would suggest removing it.
> 
> I had same impression and I simply don't use this data anywhere in 
> gdal2wktraster script.
> 
> I believe the right person to ask about this 16-bit float type is 
> Sandro (strk) - he is the author of original specification documents:
> 
> 
> http://trac.osgeo.org/postgis/browser/spike/wktraster/doc

I've submitted ticket suggesting to officially remove the PT_16BF type
from WKT Raster:

http://trac.osgeo.org/postgis/ticket/226

Let's agree on that there.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From warmerdam at pobox.com  Wed Jul 29 10:29:28 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Jul 29 10:29:42 2009
Subject: [gdal-dev] python gdal gdal.ReprojectImage produces no data
In-Reply-To: <20090729074835.GB17404@kocour>
References: <20090729074835.GB17404@kocour>
Message-ID: <4A705CC8.8080100@pobox.com>

Jachym Cepicky wrote:
> Hi
> 
> I would like to write "custom" version of the gdalwarp tool in Python
> using gdal.ReprojectImage() function, but the only result I get, is just
> a empty "black" image.
> 
> The code would look like this:
> 
> # -------     python code start  -------
> from osgeo import gdal
> 
> # let's have georeferenced geotiff
> inds = gdal.Open("filename.tif")
> 
> # it *is* georeferenced
> inds.GetProjection()
> # 'GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS 84",6378137,298.2572235629972,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433],AUTHORITY["EPSG","4326"]]'
> 
> # create the driver
> driver = gdal.GetDriverByName("GTiff")
> 
> # create new output file
> outds = driver.Create("outfile.tif",inds.RasterXSize, inds.RasterYSize)
> 
> # do the transformation - actually no transformation at all
> gdal.ReprojectImage(inds, outds, inds.GetProjection(), inds.GetProjection())
....
> That was all :-( Projection and coordinates can be set using
> dsout.SetProjection and dsout.SetGeoTransform - that would not be a
> problem. The problem are the data, which were not copied.
> 
> I'm I missing something? Could this be a problem of my GDAL
> installation?


Jachym,

The problem is that your output file does not have a geotransform set,
so ReprojectImage() does not realize the output file overlaps the
area available from the input file.  You need to set the geotransform
before calling ReprojectImage().  Setting the coordinate system is not
critical since ReprojectImage() allows you to pass in an output coordinate
system.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From nicolas.simon at spw.wallonie.be  Wed Jul 29 11:15:47 2009
From: nicolas.simon at spw.wallonie.be (Nicolas Simon)
Date: Wed Jul 29 11:43:41 2009
Subject: [gdal-dev] OGR OCI Driver improvement
Message-ID: <8C7DAE7B21100F4CABDD600FAAD339D003C4B5DB@DGA-EXC01.mrw.wallonie.int>

Dear developpers,

I use OCI driver for a while and I found some problems

These problems are blocking for me and I already have solution for some of them.

My firsts questions are organisational. 
What to do to have the code I proposed tested by other people sharing the same problem ?
How to get these patch included in the main trunk for a future release of GDAL ?

I'm conscientious that the development team could not provide solution to all problems in a short delay, so how can I help to get quick (and stable) adaptation  ?

Problems are
	1)	Bad dimension support when using existing layer (DIM parameter is only valid during Creation)  Ticket #3025 => I have solution

	2)	When adding new feature in multi-user environment, FID generated by different client may conflict. 
	  
	Proposition
	 Let existing FID generation for compatibility purpose.
	 When FID are generated on the basis of an oracle sequence (my situation)  retrieving the FID through INSERT ... RETURNING FID_FIELD INTO :variable
	And using this variable to set the FID's Feature

	Note: this proposition fix a problem  when poFeature->GetFID() == OGRNullFID because SetFID is not called in this case.

	=> I have solution

	3)	OCITableLayer.SetFeature() not compliant with OGR Documentation

	Documentation says that SetFeature Rewrite an existing feature.  
	3.1) Actual implementation try to make a delete before an insert and doesn't test if delete effectively delete one row. 
	3.2) Implementation with delete + insert is not nice if we have 
	-	logic to generate new FID
	-	trigger on update    

	I write a code that translate SetFeature in an update statement.
=> I have solution

	Concerning compliance with the documentation, documentation should by updated if  inserting new feature is permitted. In this case,  I could adapt my code to make an insert if no row is processed by the update. 

	4)	Presently, driver return that it support Transactions in TestCapability. It is not the case. It should return false until true transaction support will be implemented.
	  
	Thanks a lot, and I expect that I could contribute in the improvement of the OCI driver

================================================== 
Nicolas Simon, Informaticien 
Service Public de Wallonie (SPW)
Direction g?n?rale op?rationnelle Agriculture, Ressources Naturelles et Environnement (DGARNE)
D?partement des Aides
Direction de l'Octroi des Aides agricoles - Service Informatique
14, Chauss?e de Louvain - 4e ?tage 
5000 Namur 
BELGIUM 



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090729/819bba36/attachment.html
From warmerdam at pobox.com  Wed Jul 29 12:01:24 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Jul 29 12:01:28 2009
Subject: [gdal-dev] OGR OCI Driver improvement
In-Reply-To: <8C7DAE7B21100F4CABDD600FAAD339D003C4B5DB@DGA-EXC01.mrw.wallonie.int>
References: <8C7DAE7B21100F4CABDD600FAAD339D003C4B5DB@DGA-EXC01.mrw.wallonie.int>
Message-ID: <4A707254.4060709@pobox.com>

Nicolas Simon wrote:
> Dear developpers,
> 
> I use OCI driver for a while and I found some problems
> 
> These problems are blocking for me and I already have solution for some 
> of them.
> 
> My firsts questions are organisational.
> What to do to have the code I proposed tested by other people sharing 
> the same problem ?
> How to get these patch included in the main trunk for a future release 
> of GDAL ?

Nicolas,

Please attach the fixes to the tickets in question (and add yourself to the
cc:list).  Create new tickets for issues for which tickets do not yet exist.
Please ensure fixes are provided against trunk if possible.

If you are interested in becoming a longer term contributor - perhaps with
primary responsibility for the OCI driver - we could pursue that issue after
some of these fixes have at least been reviewed.

Unfortunately, my oracle development environment isn't that conveniently
accessable, but I could drop into it for a bit to try and test and apply
your patches when they are all available.  It would be very helpful for you
to include simple means to demonstrate the problems and confirm the fixes
- ideally leading to additional test suite tests.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From belaid_moa at hotmail.com  Wed Jul 29 13:44:41 2009
From: belaid_moa at hotmail.com (Belaid MOA)
Date: Wed Jul 29 13:44:42 2009
Subject: [gdal-dev] JPEG format.
Message-ID: <COL113-W35C8D726F1640BCBA2062EF4120@phx.gbl>


Hi Everyone,
  When I try to use GDALCreate() on the JPEG driver, I got the following error: "GDALDriver::Create() ... no create method implemented for this format."
  Does is this mean that JPEG driver does not have its GDALCreate() function implemented? Any example on how to use JPEG driver is appreciated.

  As always, any help on this is very appreciated.

With best regards.
~Belaid

_________________________________________________________________
Stay in the loop and chat with friends, right from your inbox!
http://go.microsoft.com/?linkid=9671354
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090729/719dbad9/attachment.html
From lran at unc.edu  Wed Jul 29 12:53:10 2009
From: lran at unc.edu (Limei Ran)
Date: Wed Jul 29 13:50:08 2009
Subject: [gdal-dev] Error in GDAL compiling with HDF4
Message-ID: <4A707E76.9000205@unc.edu>

Hi:

I am having the following errors when I was compiling GDAL with HDF4 on 
a 64bits Linux server:
==========================
Command:
 >./configure 
--prefix=/nas/uncch/depts/cep/emc/lran/mims/sa_06_2009/src/libs/gdal-1.6.1/local 
--with-static-proj4=/nas/uncch/depts/cep/emc/lran/mims/sa_06_2009/src/libs/proj-4.6.1/local 
--with-hdf5=/nas/uncch/depts/cep/emc/lran/mims/sa_06_2009/src/libs/hdf5-1.8.3/local 
--with-hdf4=/nas/uncch/depts/cep/emc/lran/mims/sa_06_2009/src/libs/HDF4.2r4/local 
--without-curl --without-expat --without-mysql --without-dwgdirect 
--without-odbc --without-python

Error:
.......
using pre-installed libgif.
checking for cln_GetLayerCapabilities in -logdi31... no
checking for FMEObjects... no
checking for SDreaddata in -lmfhdf... no
checking for SDreaddata in -lhdf4... no
checking for SDreaddata in -lmfhdf... no
checking for SDreaddata in -lmfhdf... no
configure: error: HDF4 support requested with arg 
"/nas/uncch/depts/cep/emc/lran/mims/sa_06_2009/src/libs/HDF4.2r4/local", 
but neither hdf4 nor mfhdf lib found
===========================

I compiled HDF4 with: --disable-netcdf --disable-fortran and I did not 
compile GDAL with netcdf.  When I got rid of HDF4 in gdal configure, the 
configuration went through.

The config.log has a lot of errors related to conftest.c like:
================
configure:7122: checking how to run the C preprocessor
configure:7162: gcc -E  conftest.c
configure:7168: $? = 0
configure:7199: gcc -E  conftest.c
conftest.c:8:28: error: ac_nonexistent.h: No such file or directory
configure:7205: $? = 1
configure: failed program was:
===============


Could you tell me what went wrong in this gdal compiling with hdf4 ?

Thanks,

Limei

From even.rouault at mines-paris.org  Wed Jul 29 13:55:46 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Jul 29 13:55:57 2009
Subject: [gdal-dev] JPEG format.
In-Reply-To: <COL113-W35C8D726F1640BCBA2062EF4120@phx.gbl>
References: <COL113-W35C8D726F1640BCBA2062EF4120@phx.gbl>
Message-ID: <200907291955.47339.even.rouault@mines-paris.org>

Le Wednesday 29 July 2009 19:44:41 Belaid MOA, vous avez ?crit?:
> Hi Everyone,
>   When I try to use GDALCreate() on the JPEG driver, I got the following
> error: "GDALDriver::Create() ... no create method implemented for this
> format." Does is this mean that JPEG driver does not have its GDALCreate()
> function implemented?

Hum, I can admit that sometimes error messages are not particularly clear, but 
here .... !

> Any example on how to use JPEG driver is appreciated. 

The JPEG is no different from other drivers. The fact that the Create() method 
is not implemented just reflect the fact that you can't write data at random 
scanlines in a JPEG file, it must be created scanline by scanline, from top 
to bottom. So you want to use the CreateCopy() method instead. As a source 
raster for the CreateCopy(), you can use a dataset created with the MEM 
driver (that supports the Create() method), or any other disk-based format 
like GTIFF that supports the Create() method.

Schematically (in Python) :

mem_ds = gdal.GetDriverByName('MEM').Create(....)
mem_ds.WriteRaster(....)

jpeg_ds = gdal.GetDriverByName('JPEG').CreateCopy(mem_ds, "out.jpg")
jpeg_ds = None
mem_ds = None

>
>   As always, any help on this is very appreciated.
>
> With best regards.
> ~Belaid
>
> _________________________________________________________________
> Stay in the loop and chat with friends, right from your inbox!
> http://go.microsoft.com/?linkid=9671354


From chapmanm at pixia.com  Wed Jul 29 13:56:04 2009
From: chapmanm at pixia.com (Martin Chapman)
Date: Wed Jul 29 13:56:22 2009
Subject: [gdal-dev] JPEG format.
In-Reply-To: <COL113-W35C8D726F1640BCBA2062EF4120@phx.gbl>
References: <COL113-W35C8D726F1640BCBA2062EF4120@phx.gbl>
Message-ID: <002401ca1075$d8208b70$8861a250$@com>

Use:

 

if (!pDriver->TestCapability(ODrCCreateDataSource))

 

to test create capabilties of the driver.

 

I think jpeg driver only supports CreateCopy().

 

You could use the Memory dataset to create a different size dataset and then
use the jpeg driver to save it to disk.

 

Martin

 

From: gdal-dev-bounces@lists.osgeo.org
[mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Belaid MOA
Sent: Wednesday, July 29, 2009 11:45 AM
To: gdal-dev@lists.osgeo.org
Subject: [gdal-dev] JPEG format.

 

Hi Everyone,
  When I try to use GDALCreate() on the JPEG driver, I got the following
error: "GDALDriver::Create() ... no create method implemented for this
format."
  Does is this mean that JPEG driver does not have its GDALCreate() function
implemented? Any example on how to use JPEG driver is appreciated.

  As always, any help on this is very appreciated.

With best regards.
~Belaid

  _____  

Stay in the loop and chat with friends, right from your inbox! Learn how!
<http://go.microsoft.com/?linkid=9671349> 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090729/fd353130/attachment.html
From jachym.cepicky at gmail.com  Wed Jul 29 12:02:47 2009
From: jachym.cepicky at gmail.com (Jachym Cepicky)
Date: Wed Jul 29 14:09:04 2009
Subject: [gdal-dev] python gdal gdal.ReprojectImage produces no data
In-Reply-To: <4A705CC8.8080100@pobox.com>
References: <20090729074835.GB17404@kocour> <4A705CC8.8080100@pobox.com>
Message-ID: <20090729160247.GC17404@kocour>

Hi Frank (and others),

> Jachym,
>
> The problem is that your output file does not have a geotransform set,
> so ReprojectImage() does not realize the output file overlaps the
> area available from the input file.  You need to set the geotransform
> before calling ReprojectImage().  Setting the coordinate system is not
> critical since ReprojectImage() allows you to pass in an output coordinate
> system.
>
> Best regards,

Thanks, it helped. Just for the record:


from osgeo import gdal
from osgeo.gdalconst import *

# let's have georeferenced geotiff
inds = gdal.Open("elevationwgs.tif")

# create the driver
driver = gdal.GetDriverByName("GTiff")

# create new output file, note the datatype must be set
outds = driver.Create("outfile.tif",inds.RasterXSize, inds.RasterYSize,
        1,GDT_UInt16)

# set geotransform parameter
outds.SetGeoTransform(inds.GetGeoTransform())

# set the projection
outds.SetProjection(inds.GetProjection())

# do the transformation - actually no transformation at all
# projections are no longer needed, since both datasets are projected
gdal.ReprojectImage(inds, outds)

# close
outds = None
inds = None

-- 
Jachym Cepicky
e-mail: jachym.cepicky gmail com
URL: http://les-ejk.cz
GPG: http://www.les-ejk.cz/pgp/JachymCepicky.pgp
Key fingerprint: 0C6D 0EAE 76BD 506C F299  ED8A C8AB 74B8 08D4 E08F
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090729/068e89c2/attachment.bin
From belaid_moa at hotmail.com  Wed Jul 29 14:42:17 2009
From: belaid_moa at hotmail.com (Belaid MOA)
Date: Wed Jul 29 14:43:16 2009
Subject: [gdal-dev] JPEG format.
In-Reply-To: <200907291955.47339.even.rouault@mines-paris.org>
References: <COL113-W35C8D726F1640BCBA2062EF4120@phx.gbl>
	<200907291955.47339.even.rouault@mines-paris.org> 
Message-ID: <COL113-W56C74CC50AB9D4D6BB44DF4120@phx.gbl>





Special thanks Even. You are always quick and to the point! Thank you very much. 
As you pointed out, I was handling JPEG in the same manner as GTiff; I did not use the MEM driver first. 

With best regards.
~Belaid.

> From: even.rouault@mines-paris.org
> To: gdal-dev@lists.osgeo.org
> Subject: Re: [gdal-dev] JPEG format.
> Date: Wed, 29 Jul 2009 19:55:46 +0200
> CC: belaid_moa@hotmail.com
> 
> Le Wednesday 29 July 2009 19:44:41 Belaid MOA, vous avez ?crit :
> > Hi Everyone,
> >   When I try to use GDALCreate() on the JPEG driver, I got the following
> > error: "GDALDriver::Create() ... no create method implemented for this
> > format." Does is this mean that JPEG driver does not have its GDALCreate()
> > function implemented?
> 
> Hum, I can admit that sometimes error messages are not particularly clear, but 
> here .... !
> 
> > Any example on how to use JPEG driver is appreciated. 
> 
> The JPEG is no different from other drivers. The fact that the Create() method 
> is not implemented just reflect the fact that you can't write data at random 
> scanlines in a JPEG file, it must be created scanline by scanline, from top 
> to bottom. So you want to use the CreateCopy() method instead. As a source 
> raster for the CreateCopy(), you can use a dataset created with the MEM 
> driver (that supports the Create() method), or any other disk-based format 
> like GTIFF that supports the Create() method.
> 
> Schematically (in Python) :
> 
> mem_ds = gdal.GetDriverByName('MEM').Create(....)
> mem_ds.WriteRaster(....)
> 
> jpeg_ds = gdal.GetDriverByName('JPEG').CreateCopy(mem_ds, "out.jpg")
> jpeg_ds = None
> mem_ds = None
> 
> >
> >   As always, any help on this is very appreciated.
> >
> > With best regards.
> > ~Belaid
> >
> > _________________________________________________________________
> > Stay in the loop and chat with friends, right from your inbox!
> > http://go.microsoft.com/?linkid=9671354
> 
> 

More storage. Better anti-spam and antivirus protection. Hotmail makes it simple.
_________________________________________________________________
Send and receive email from all of your webmail accounts.
http://go.microsoft.com/?linkid=9671356
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090729/183ebef2/attachment-0001.html
From jaadfoo at gmail.com  Wed Jul 29 14:22:43 2009
From: jaadfoo at gmail.com (Jamie Adams)
Date: Wed Jul 29 14:48:37 2009
Subject: [gdal-dev] gdal2tiles altitude mode clampToSeaFloor ?
Message-ID: <f4339510907291122g524ed9dek3e95a6f0898ece69@mail.gmail.com>

Hello all,

Is there a way to get the 1.6 version of gdal2tiles to clamp tiles to the
seafloor?  I've tried modifying the script with <altitudeMode> &
<gx:altitudeMode>, but the tiles remain clamped to z=0.  What's the correct
approach?

- Jamie
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090729/ff3322a1/attachment.html
From chapmanm at pixia.com  Wed Jul 29 14:46:47 2009
From: chapmanm at pixia.com (Martin Chapman)
Date: Wed Jul 29 14:49:28 2009
Subject: [gdal-dev] JPEG format.
In-Reply-To: <COL113-W398DBB4EC429D977F1A76AF4120@phx.gbl>
References: <COL113-W35C8D726F1640BCBA2062EF4120@phx.gbl><002401ca1075$d8208b70$8861a250$@com>
	<COL113-W398DBB4EC429D977F1A76AF4120@phx.gbl>
Message-ID: <397121586-1248893303-cardhu_decombobulator_blackberry.rim.net-658455891-@bxe1311.bisx.prod.on.blackberry>

Good question.  I imagine it is extra work for Frank that falls low on the priority list. :)

Martin

-----Original Message-----
From: Belaid MOA <belaid_moa@hotmail.com>

Date: Wed, 29 Jul 2009 18:46:28 
To: <chapmanm@pixia.com>; <gdal-dev@lists.osgeo.org>
Subject: RE: [gdal-dev] JPEG format.









That's excellent to know! Thanks a lot Martin. Instead of getting
segfault, 
I could use that to exist peacefully in case the driver does support the Create() function.

Just of out of curiosity, why JPEG driver does not have the create function and only supports CreateCopy()? 
The Create() function could be easily implemented using MEM and CreateCopy(); instead of relying on the user to do this every time a JPEG driver is used.

With best regards.
~Belaid.
From: chapmanm@pixia.com
To: belaid_moa@hotmail.com; gdal-dev@lists.osgeo.org
Subject: RE: [gdal-dev] JPEG format.
Date: Wed, 29 Jul 2009 11:56:04 -0600



















Use:

 

if
(!pDriver->TestCapability(ODrCCreateDataSource))

 

to
test create capabilties of the driver.

 

I
think jpeg driver only supports CreateCopy().

 

You
could use the Memory dataset to create a different size dataset and then use
the jpeg driver to save it to disk.

 

Martin

 





From:
gdal-dev-bounces@lists.osgeo.org [mailto:gdal-dev-bounces@lists.osgeo.org] On
Behalf Of Belaid MOA

Sent: Wednesday, July 29, 2009 11:45 AM

To: gdal-dev@lists.osgeo.org

Subject: [gdal-dev] JPEG format.





 

Hi Everyone,

  When I try to use GDALCreate() on the JPEG driver, I got the following
error: "GDALDriver::Create() ... no create method implemented for this
format."

  Does is this mean that JPEG driver does not have its GDALCreate()
function implemented? Any example on how to use JPEG driver is appreciated.



  As always, any help on this is very appreciated.



With best regards.

~Belaid







Stay
in the loop and chat with friends, right from your inbox! Learn how!


_________________________________________________________________
Stay in the loop and chat with friends, right from your inbox!
http://go.microsoft.com/?linkid=9671354
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090729/b026d856/attachment.html
From belaid_moa at hotmail.com  Wed Jul 29 14:46:28 2009
From: belaid_moa at hotmail.com (Belaid MOA)
Date: Wed Jul 29 14:50:28 2009
Subject: [gdal-dev] JPEG format.
In-Reply-To: <002401ca1075$d8208b70$8861a250$@com>
References: <COL113-W35C8D726F1640BCBA2062EF4120@phx.gbl>
	<002401ca1075$d8208b70$8861a250$@com> 
Message-ID: <COL113-W398DBB4EC429D977F1A76AF4120@phx.gbl>








That's excellent to know! Thanks a lot Martin. Instead of getting
segfault, 
I could use that to exist peacefully in case the driver does support the Create() function.

Just of out of curiosity, why JPEG driver does not have the create function and only supports CreateCopy()? 
The Create() function could be easily implemented using MEM and CreateCopy(); instead of relying on the user to do this every time a JPEG driver is used.

With best regards.
~Belaid.
From: chapmanm@pixia.com
To: belaid_moa@hotmail.com; gdal-dev@lists.osgeo.org
Subject: RE: [gdal-dev] JPEG format.
Date: Wed, 29 Jul 2009 11:56:04 -0600



















Use:

 

if
(!pDriver->TestCapability(ODrCCreateDataSource))

 

to
test create capabilties of the driver.

 

I
think jpeg driver only supports CreateCopy().

 

You
could use the Memory dataset to create a different size dataset and then use
the jpeg driver to save it to disk.

 

Martin

 





From:
gdal-dev-bounces@lists.osgeo.org [mailto:gdal-dev-bounces@lists.osgeo.org] On
Behalf Of Belaid MOA

Sent: Wednesday, July 29, 2009 11:45 AM

To: gdal-dev@lists.osgeo.org

Subject: [gdal-dev] JPEG format.





 

Hi Everyone,

  When I try to use GDALCreate() on the JPEG driver, I got the following
error: "GDALDriver::Create() ... no create method implemented for this
format."

  Does is this mean that JPEG driver does not have its GDALCreate()
function implemented? Any example on how to use JPEG driver is appreciated.



  As always, any help on this is very appreciated.



With best regards.

~Belaid







Stay
in the loop and chat with friends, right from your inbox! Learn how!


_________________________________________________________________
Stay in the loop and chat with friends, right from your inbox!
http://go.microsoft.com/?linkid=9671354
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090729/250fcc2d/attachment.html
From even.rouault at mines-paris.org  Wed Jul 29 15:20:01 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Jul 29 15:20:14 2009
Subject: [gdal-dev] JPEG format.
In-Reply-To: <397121586-1248893303-cardhu_decombobulator_blackberry.rim.net-658455891-@bxe1311.bisx.prod.on.blackberry>
References: <COL113-W35C8D726F1640BCBA2062EF4120@phx.gbl>
	<COL113-W398DBB4EC429D977F1A76AF4120@phx.gbl>
	<397121586-1248893303-cardhu_decombobulator_blackberry.rim.net-658455891-@bxe1311.bisx.prod.on.blackberry>
Message-ID: <200907292120.02526.even.rouault@mines-paris.org>

Le Wednesday 29 July 2009 20:46:47 Martin Chapman, vous avez ?crit?:
> Good question.  I imagine it is extra work for Frank that falls low on the
> priority list. :)

Another problem is that if you want to create a big raster, it might not hold 
entirely into RAM (a JPEG file  uncompressed into RAM can use up to 
65000x65000x3=12 GB). The general GDAL policy is to minimize the use of RAM.

>
> Martin
>
> -----Original Message-----
> From: Belaid MOA <belaid_moa@hotmail.com>
>
> Date: Wed, 29 Jul 2009 18:46:28
> To: <chapmanm@pixia.com>; <gdal-dev@lists.osgeo.org>
> Subject: RE: [gdal-dev] JPEG format.
>
>
>
>
>
>
>
>
>
> That's excellent to know! Thanks a lot Martin. Instead of getting
> segfault,
> I could use that to exist peacefully in case the driver does support the
> Create() function.
>
> Just of out of curiosity, why JPEG driver does not have the create function
> and only supports CreateCopy()? The Create() function could be easily
> implemented using MEM and CreateCopy(); instead of relying on the user to
> do this every time a JPEG driver is used.
>
> With best regards.
> ~Belaid.
> From: chapmanm@pixia.com
> To: belaid_moa@hotmail.com; gdal-dev@lists.osgeo.org
> Subject: RE: [gdal-dev] JPEG format.
> Date: Wed, 29 Jul 2009 11:56:04 -0600
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
> Use:
>
>
>
> if
> (!pDriver->TestCapability(ODrCCreateDataSource))
>
>
>
> to
> test create capabilties of the driver.
>
>
>
> I
> think jpeg driver only supports CreateCopy().
>
>
>
> You
> could use the Memory dataset to create a different size dataset and then
> use the jpeg driver to save it to disk.
>
>
>
> Martin
>
>
>
>
>
>
>
> From:
> gdal-dev-bounces@lists.osgeo.org [mailto:gdal-dev-bounces@lists.osgeo.org]
> On Behalf Of Belaid MOA
>
> Sent: Wednesday, July 29, 2009 11:45 AM
>
> To: gdal-dev@lists.osgeo.org
>
> Subject: [gdal-dev] JPEG format.
>
>
>
>
>
>
>
> Hi Everyone,
>
>   When I try to use GDALCreate() on the JPEG driver, I got the following
> error: "GDALDriver::Create() ... no create method implemented for this
> format."
>
>   Does is this mean that JPEG driver does not have its GDALCreate()
> function implemented? Any example on how to use JPEG driver is appreciated.
>
>
>
>   As always, any help on this is very appreciated.
>
>
>
> With best regards.
>
> ~Belaid
>
>
>
>
>
>
>
> Stay
> in the loop and chat with friends, right from your inbox! Learn how!
>
>
> _________________________________________________________________
> Stay in the loop and chat with friends, right from your inbox!
> http://go.microsoft.com/?linkid=9671354


From warmerdam at pobox.com  Wed Jul 29 15:27:35 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Jul 29 16:05:54 2009
Subject: [gdal-dev] JPEG format.
In-Reply-To: <COL113-W398DBB4EC429D977F1A76AF4120@phx.gbl>
References: <COL113-W35C8D726F1640BCBA2062EF4120@phx.gbl>
	<002401ca1075$d8208b70$8861a250$@com>
	<COL113-W398DBB4EC429D977F1A76AF4120@phx.gbl>
Message-ID: <4A70A2A7.4060801@pobox.com>

Belaid MOA wrote:
> That's excellent to know! Thanks a lot Martin. Instead of getting segfault,
> I could use that to exist peacefully in case the driver does support the 
> Create() function.
> 
> Just of out of curiosity, why JPEG driver does not have the create 
> function and only supports CreateCopy()?
> The Create() function could be easily implemented using MEM and 
> CreateCopy(); instead of relying on the user to do this every time a 
> JPEG driver is used.

Belaid,

Many of us work with images that would be impractical to hold in memory,
and that might be quite inefficient to first marshall on disk in a directly
creatable format like TIFF.

The Create/CreateCopy distinction in writing with drivers is an important
one within GDAL and something that developers (and even to some extent
users) are expected to learn something about even if it is not immediately
obvious.  I do think it is addressed in the FAQ.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From belaid_moa at hotmail.com  Wed Jul 29 16:23:00 2009
From: belaid_moa at hotmail.com (Belaid MOA)
Date: Wed Jul 29 16:23:02 2009
Subject: [gdal-dev] JPEG format - TestCapability
In-Reply-To: <4A70A2A7.4060801@pobox.com>
References: <COL113-W35C8D726F1640BCBA2062EF4120@phx.gbl>
	<002401ca1075$d8208b70$8861a250$@com>
	<COL113-W398DBB4EC429D977F1A76AF4120@phx.gbl>
	<4A70A2A7.4060801@pobox.com>
Message-ID: <COL113-W56D8747CBB8A4745B3E8F7F4120@phx.gbl>


Thank you all for your reply.
 
Somehow I could not get TestCapability to work.  I get the compilation error: "class GDALDriver has no member named TestCapability". According to the gdal_priv.h and GDAL Doc, the GDALDriver class does not have TestCapability function. 
Am I missing something?

With best regards.
~Belaid.

> Date: Wed, 29 Jul 2009 15:27:35 -0400
> From: warmerdam@pobox.com
> To: belaid_moa@hotmail.com
> CC: gdal-dev@lists.osgeo.org
> Subject: Re: [gdal-dev] JPEG format.
> 
> Belaid MOA wrote:
> > That's excellent to know! Thanks a lot Martin. Instead of getting segfault,
> > I could use that to exist peacefully in case the driver does support the 
> > Create() function.
> > 
> > Just of out of curiosity, why JPEG driver does not have the create 
> > function and only supports CreateCopy()?
> > The Create() function could be easily implemented using MEM and 
> > CreateCopy(); instead of relying on the user to do this every time a 
> > JPEG driver is used.
> 
> Belaid,
> 
> Many of us work with images that would be impractical to hold in memory,
> and that might be quite inefficient to first marshall on disk in a directly
> creatable format like TIFF.
> 
> The Create/CreateCopy distinction in writing with drivers is an important
> one within GDAL and something that developers (and even to some extent
> users) are expected to learn something about even if it is not immediately
> obvious.  I do think it is addressed in the FAQ.
> 
> Best regards,
> -- 
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
> 

_________________________________________________________________
More storage. Better anti-spam and antivirus protection. Hotmail makes it simple.
http://go.microsoft.com/?linkid=9671357
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090729/0b7ec0e2/attachment.html
From warmerdam at pobox.com  Wed Jul 29 16:35:16 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Jul 29 16:35:34 2009
Subject: [gdal-dev] JPEG format - TestCapability
In-Reply-To: <COL113-W56D8747CBB8A4745B3E8F7F4120@phx.gbl>
References: <COL113-W35C8D726F1640BCBA2062EF4120@phx.gbl>
	<002401ca1075$d8208b70$8861a250$@com>
	<COL113-W398DBB4EC429D977F1A76AF4120@phx.gbl>
	<4A70A2A7.4060801@pobox.com>
	<COL113-W56D8747CBB8A4745B3E8F7F4120@phx.gbl>
Message-ID: <4A70B284.5050008@pobox.com>

Belaid MOA wrote:
> Thank you all for your reply.
>  
> Somehow I could not get TestCapability to work.  I get the compilation 
> error: "class GDALDriver has no member named TestCapability". According 
> to the gdal_priv.h and GDAL Doc, the GDALDriver class does not have 
> TestCapability function.
> Am I missing something?

Belaid,

TestCapability() is actually an OGR method.  In GDAL we test for particular
capability related metadata items. In GDAL you could test for the Create()
method being supported with the following:

         if( GDALGetMetadataItem( hDriver, GDAL_DCAP_CREATE, NULL ) != NULL )
             ... we have Create support ...

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Wed Jul 29 16:40:40 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Jul 29 16:40:48 2009
Subject: [gdal-dev] Error in GDAL compiling with HDF4
In-Reply-To: <4A707E76.9000205@unc.edu>
References: <4A707E76.9000205@unc.edu>
Message-ID: <4A70B3C8.4000301@pobox.com>

Limei Ran wrote:
...
> checking for FMEObjects... no
> checking for SDreaddata in -lmfhdf... no
> checking for SDreaddata in -lhdf4... no
> checking for SDreaddata in -lmfhdf... no
> checking for SDreaddata in -lmfhdf... no
> configure: error: HDF4 support requested with arg 
> "/nas/uncch/depts/cep/emc/lran/mims/sa_06_2009/src/libs/HDF4.2r4/local", 
> but neither hdf4 nor mfhdf lib found
> ===========================
> 
> I compiled HDF4 with: --disable-netcdf --disable-fortran and I did not 
> compile GDAL with netcdf.  When I got rid of HDF4 in gdal configure, the 
> configuration went through.
> 
> The config.log has a lot of errors related to conftest.c like:
...
> Could you tell me what went wrong in this gdal compiling with hdf4 ?

Limei,

I think you need to find the part of the config.log that relates to hdf to
find out what went wrong.  I think one common problem is building the HDF
library without -fPIC.

You might also check:
  http://trac.osgeo.org/gdal/wiki/HDF

and consider updating it if you learn something likely to be of broader use.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From belaid_moa at hotmail.com  Wed Jul 29 16:44:59 2009
From: belaid_moa at hotmail.com (Belaid MOA)
Date: Wed Jul 29 16:45:01 2009
Subject: [gdal-dev] JPEG format - TestCapability
In-Reply-To: <4A70B284.5050008@pobox.com>
References: <COL113-W35C8D726F1640BCBA2062EF4120@phx.gbl>
	<002401ca1075$d8208b70$8861a250$@com>
	<COL113-W398DBB4EC429D977F1A76AF4120@phx.gbl>
	<4A70A2A7.4060801@pobox.com>
	<COL113-W56D8747CBB8A4745B3E8F7F4120@phx.gbl>
	<4A70B284.5050008@pobox.com>
Message-ID: <COL113-W64AE2D67B4BEE195A4F8B3F4120@phx.gbl>


Thank you very much Frank. 
With best regards.
Belaid Moa.

> Date: Wed, 29 Jul 2009 16:35:16 -0400
> From: warmerdam@pobox.com
> To: belaid_moa@hotmail.com
> CC: gdal-dev@lists.osgeo.org
> Subject: Re: [gdal-dev] JPEG format - TestCapability
> 
> Belaid MOA wrote:
> > Thank you all for your reply.
> >  
> > Somehow I could not get TestCapability to work.  I get the compilation 
> > error: "class GDALDriver has no member named TestCapability". According 
> > to the gdal_priv.h and GDAL Doc, the GDALDriver class does not have 
> > TestCapability function.
> > Am I missing something?
> 
> Belaid,
> 
> TestCapability() is actually an OGR method.  In GDAL we test for particular
> capability related metadata items. In GDAL you could test for the Create()
> method being supported with the following:
> 
>          if( GDALGetMetadataItem( hDriver, GDAL_DCAP_CREATE, NULL ) != NULL )
>              ... we have Create support ...
> 
> Best regards,
> -- 
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
> 

_________________________________________________________________
Stay in the loop and chat with friends, right from your inbox!
http://go.microsoft.com/?linkid=9671354
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090729/d3cd1536/attachment.html
From belaid_moa at hotmail.com  Wed Jul 29 19:38:06 2009
From: belaid_moa at hotmail.com (Belaid MOA)
Date: Wed Jul 29 19:38:08 2009
Subject: [gdal-dev] Subsetting based on geo-coordinates.
In-Reply-To: <4A70B284.5050008@pobox.com>
References: <COL113-W35C8D726F1640BCBA2062EF4120@phx.gbl>
	<002401ca1075$d8208b70$8861a250$@com>
	<COL113-W398DBB4EC429D977F1A76AF4120@phx.gbl>
	<4A70A2A7.4060801@pobox.com>
	<COL113-W56D8747CBB8A4745B3E8F7F4120@phx.gbl>
	<4A70B284.5050008@pobox.com>
Message-ID: <COL113-W13302BBD0F608505279FA8F4120@phx.gbl>


Hi Everyone,
 Sorry to bother again! I am looking for a cheap/dirty way of subsetting a GTiff image based on a rectangle specified in the geo-coordinates. Does GDAL has already something for that?   

 Thank you very much in advance.

With best regards.
~Belaid.
> Date: Wed, 29 Jul 2009 16:35:16 -0400
> From: warmerdam@pobox.com
> To: belaid_moa@hotmail.com
> CC: gdal-dev@lists.osgeo.org
> Subject: Re: [gdal-dev] JPEG format - TestCapability
> 
> Belaid MOA wrote:
> > Thank you all for your reply.
> >  
> > Somehow I could not get TestCapability to work.  I get the compilation 
> > error: "class GDALDriver has no member named TestCapability". According 
> > to the gdal_priv.h and GDAL Doc, the GDALDriver class does not have 
> > TestCapability function.
> > Am I missing something?
> 
> Belaid,
> 
> TestCapability() is actually an OGR method.  In GDAL we test for particular
> capability related metadata items. In GDAL you could test for the Create()
> method being supported with the following:
> 
>          if( GDALGetMetadataItem( hDriver, GDAL_DCAP_CREATE, NULL ) != NULL )
>              ... we have Create support ...
> 
> Best regards,
> -- 
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
> 

_________________________________________________________________
Stay in the loop and chat with friends, right from your inbox!
http://go.microsoft.com/?linkid=9671354
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090729/fcc2be90/attachment.html
From warmerdam at pobox.com  Wed Jul 29 20:38:09 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Jul 29 20:38:06 2009
Subject: [gdal-dev] Subsetting based on geo-coordinates.
In-Reply-To: <COL113-W13302BBD0F608505279FA8F4120@phx.gbl>
References: <COL113-W35C8D726F1640BCBA2062EF4120@phx.gbl>
	<002401ca1075$d8208b70$8861a250$@com>
	<COL113-W398DBB4EC429D977F1A76AF4120@phx.gbl>
	<4A70A2A7.4060801@pobox.com>
	<COL113-W56D8747CBB8A4745B3E8F7F4120@phx.gbl>
	<4A70B284.5050008@pobox.com>
	<COL113-W13302BBD0F608505279FA8F4120@phx.gbl>
Message-ID: <4A70EB71.5020809@pobox.com>

Belaid MOA wrote:
> Hi Everyone,
>  Sorry to bother again! I am looking for a cheap/dirty way of subsetting 
> a GTiff image based on a rectangle specified in the geo-coordinates. 
> Does GDAL has already something for that?  

Belaid,

You want the -projwin switch for gdal_translate.  It will take the window
in georeferenced coordinates into an internal window in pixel coordinates and
create a subset of the file for that region.

Details at:

   http://www.gdal.org/gdal_translate.html

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From cchung at draper.com  Thu Jul 30 09:35:39 2009
From: cchung at draper.com (Charles Chung)
Date: Thu Jul 30 09:35:42 2009
Subject: [Gdal-dev] gdaladdo for large RPF
In-Reply-To: <1247696465620-3266107.post@n2.nabble.com>
References: <1247696465620-3266107.post@n2.nabble.com>
Message-ID: <1248960939670-3356327.post@n2.nabble.com>


Does anyone know about how to work with large RPF?
Any help is appreciated.

Thanks.


Charles Chung wrote:
> 
> When I try to build an overview of a.toc file that is associated with 10
> GB (38K files) NITF files, I get the following error message.
> 
> c:\>gdaladdo --config COMPRESS_OVERVIEW DEFLATE
> NITF_TOC_ENTRY:CIB__1M_1_0:C:\aOI\rpf\a.toc 2 4 8 16
> ERROR 1: TIFFFetchStripThing:Sanity check on size of "TileOffsets" value
> failed
> ERROR 1: TIFFFetchStripThing:Sanity check on size of "TileOffsets" value
> failed
> Overview building failed.
> 
> Is it possible to build an overview for this big file?
> FYI, I will use the overview file with MapServer to increase the
> performance.
> 
> Thanks in advance.
> 
> Charles Chung
> 
> 
> c:\>gdalinfo c:\aoi\rpf\a.toc
> Driver: NITF/National Imagery Transmission Format
> Files: ???????.???
> Size is 366028, 466944
> Coordinate System is:
> GEOGCS["WGS 84",
>     DATUM["WGS_1984",
>         SPHEROID["WGS 84",6378137,298.257223563,
>             AUTHORITY["EPSG","7030"]],
>         TOWGS84[0,0,0,0,0,0,0],
>         AUTHORITY["EPSG","6326"]],
>     PRIMEM["Greenwich",0,
>         AUTHORITY["EPSG","8901"]],
>     UNIT["degree",0.0174532925199433,
>         AUTHORITY["EPSG","9108"]],
>     AUTHORITY["EPSG","4326"]]
> Origin = (?????)
> Pixel Size = (0.000011897208122,-0.000008991368286)
> Metadata:
>    ???????
> Subdatasets:
>   SUBDATASET_1_NAME=NITF_TOC_ENTRY:CIB__1M_1_0:c:\aoi\rpf\a.toc
>   SUBDATASET_1_DESC=CIB::Imagery, 1 meter resolution:1M:1:0
>   SUBDATASET_2_NAME=NITF_TOC_ENTRY:CIB__1M_2_1:f:\aoi\rpf\a.toc
>   SUBDATASET_2_DESC=CIB::Imagery, 1 meter resolution:1M:2:1
> Corner Coordinates:
>   ????
> 
> 
> 
> c:\>gdalinfo NITF_TOC_ENTRY:CIB__1M_1_0:c:\aoi\rpf\a.toc
>   FILENAME=?????
>   NITF_SCALE=1M
>   NITF_SERIES_ABBREVIATION=
>   NITF_SERIES_NAME=Imagery, 1 meter resolution
> Corner Coordinates:
>   ????
> Band 1 Block=128x128 Type=Byte, ColorInterp=Palette
>   NoData Value=216
>   Overviews: 208128x157440, 104064x78720, 52032x39360, 26016x19680
>   Color Table (RGB with 217 entries)
> 
> 

-- 
View this message in context: http://n2.nabble.com/gdaladdo-for-large-RPF-tp3266107p3356327.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From Steve.Toutant at inspq.qc.ca  Thu Jul 30 09:52:34 2009
From: Steve.Toutant at inspq.qc.ca (Steve.Toutant@inspq.qc.ca)
Date: Thu Jul 30 09:52:49 2009
Subject: [gdal-dev] Numeric package
In-Reply-To: <4A65E96F.9070504@pobox.com>
Message-ID: <OFA052ACF4.FF37167D-ON85257603.004BF9A2-85257603.004C39D0@ssss.gouv.qc.ca>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/gif
Size: 5133 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090730/65852aed/attachment.gif
From scott.sinclair.za at gmail.com  Thu Jul 30 10:07:00 2009
From: scott.sinclair.za at gmail.com (Scott Sinclair)
Date: Thu Jul 30 10:15:09 2009
Subject: [gdal-dev] Numeric package
In-Reply-To: <OFA052ACF4.FF37167D-ON85257603.004BF9A2-85257603.004C39D0@ssss.gouv.qc.ca>
References: <4A65E96F.9070504@pobox.com>
	<OFA052ACF4.FF37167D-ON85257603.004BF9A2-85257603.004C39D0@ssss.gouv.qc.ca>
Message-ID: <6a17e9ee0907300707q718792ccl334fdcd2ffca8d49@mail.gmail.com>

>2009/7/30  <Steve.Toutant@inspq.qc.ca>:
> In a script I have this
> ? ? try:
> ? ? ? ? import numpy as Numeric
> ? ? except ImportError:
> ? ? ? ? import Numeric
>
> I got this error when running the script
> ? ? import Numeric
> ImportError: No module named Numeric
>
> I'm on windows
> Under C:\Python26\Lib\site-packages
> I have this
>
>
> I though numpy and numeric package were installed but it seems not.
> How can I install the numeric package properly?

You probably don't need to.

Numeric has been superseded by NumPy and is no longer actively
developed. You should use NumPy instead, whenever you have a choice
(the first part of your script is trying to do this by importing the
numpy package and calling it by the name Numeric).

It's not clear from your description where your script is failing.
What happens when you type the following at a Python prompt?

>>> import numpy
>>> numpy.__version__

Cheers,
Scott
From BCassanova at weather.com  Thu Jul 30 10:21:59 2009
From: BCassanova at weather.com (Cassanova, Bill)
Date: Thu Jul 30 10:22:09 2009
Subject: [gdal-dev] Help Understanding Building Geo Transformation from
	scratch.
Message-ID: <1D5F4E64B8C04F4C868B94AC9A532AF80AD05E40@ATLMAIL01.corp.weather.com>

Hi all,

I am looking for some advice.

I have a netcdf file that contains meteorology information.  I know the
number of rows and columns of the data as well as the corner points.
The data is cylindrical-equidistant and un-projected.

I need to be able to extract data from the grid based on lat-lon
information.  Since the data is un-projected it would be easy to built a
simple ratio based on lat and lon differences between corner points and
then using simple ratio math navigate into the grid...However, I was
hoping there was a way for GDAL to do this for me.

Since the netcdf cannot be natively understood by GDAL my assumptions
are that I will need to build my own projection and create a projection
transformer.  Since I am not using GDAL to read the data source it would
seem that I can set the hSrcDS dataset to NULL.

GDALDatasetH hSrcDS, hDstDS;
char *pszDstWKT = NULL;
const char *pszSrcWKT = NULL;

hSrcDS = hDstDS = NULL;

OGRSpatialReferenceH hDEST;
hDEST = OSRNewSpatialReference(NULL);

OSRSetWellKnownGeogCS(hDEST, "WGS84");

OSRExportToWkt(hDEST, &pszDstWKT);
OSRExportToWkt(hDEST, &pszSrcWKT);

OSRDestroySpatialReference(hDEST);


void *my_transformer = GDALCreateGenImgProjTransformer(NULL,       //
Since GDAL is not reading the data-set
                                                       pszSrcWKT,  //
WGS84 is unprojected
                                                       NULL,       //
There is no output
                                                       pszDstWKT,  //
This is the big question?  What should be here?
                                                       FALSE, 0.0, 0);


// Test the corner point.  The output should be 0, 0 since this is the
origin of the grid
double x_coord = -127.0;
double y_coord = 51.0;

// Transform.

int my_result = GDALGenImgProjTransform(my_transformer, TRUE, 1,
&x_coord, &y_coord,
                              NULL, &projSuccess);



Not unexpectedly the results of x_coord, and y_coord are the original
values.  What I don't understand is what parameters should be passed
into GDALCreateGenImgProjTransformer when what I want as output is the
Cartesian coordinates in I,J format that indicate how I am supposed to
index into my 2 dimensional array of data.

Thanks in advance for the help,
Bill


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090730/fb3fc2fa/attachment-0001.html
From mateusz at loskot.net  Thu Jul 30 10:32:36 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu Jul 30 10:30:51 2009
Subject: [gdal-dev] Numeric package
In-Reply-To: <OFA052ACF4.FF37167D-ON85257603.004BF9A2-85257603.004C39D0@ssss.gouv.qc.ca>
References: <OFA052ACF4.FF37167D-ON85257603.004BF9A2-85257603.004C39D0@ssss.gouv.qc.ca>
Message-ID: <4A71AF04.3030002@loskot.net>

Steve.Toutant@inspq.qc.ca wrote:
> 
> Hello,
> In a script I have this
>     try:
>         import numpy as Numeric
>     except ImportError:
>         import Numeric
> 
> I got this error when running the script
>     import Numeric
> ImportError: No module named Numeric
> 
> I'm on windows
> Under C:\Python26\Lib\site-packages
> I have this

Looks like NumPy is installed.
Check if you can use NumPy package from Python cmd line:

C:\> python
 >>> import numpy

or just run

python -c "import numpy"

All in windows prompt/console/command line.

BTW, on mailing lists, plain ASCII format is used. It means
that your image does most likely not appear exactly below "I have this".
It's better to not rely on any HTML/RTF formatting. Keep e-mails plain.

-- 
Mateusz Loskot, http://mateusz.loskot.net
From arb at sat.dundee.ac.uk  Thu Jul 30 10:35:35 2009
From: arb at sat.dundee.ac.uk (Andrew Brooks)
Date: Thu Jul 30 10:38:04 2009
Subject: [gdal-dev] Programmatically writing VRT files
Message-ID: <op.uxvxhlsbqw3wu1@titan>

Hello

I'm trying to write a program to create a VRT file that represents
raw data held in separate files by following the example in
http://www.gdal.org/gdal_vrttut.html

I put a SimpleSource or a VRTRasterBand piece of XML into xml_string
then, as per the example, I call

  GDALRasterBand *poBand = poDstDS->GetRasterBand( 1 );
  poBand->SetMetadataItem( "source_0", xml_string, "vrt_sources" );

But this gives the error:
ERROR 1: source_0 metadata item name is not recognized. Should be between source_0 and source_-1

If I use "new_vrt_sources" then I get no error, but still xml_string
is not in the output, only <VRTRasterBand dataType="UInt16" band="1"/>

I've seen the bug  https://trac.osgeo.org/gdal/ticket/3052
which suggests it is fixed in trunk and I'm using trunk.
Any other ideas?

Andrew

From Steve.Toutant at inspq.qc.ca  Thu Jul 30 10:41:20 2009
From: Steve.Toutant at inspq.qc.ca (Steve.Toutant@inspq.qc.ca)
Date: Thu Jul 30 10:41:36 2009
Subject: [gdal-dev] Numeric package SOLVEd
In-Reply-To: <6a17e9ee0907300707q718792ccl334fdcd2ffca8d49@mail.gmail.com>
Message-ID: <OF4C78A608.D6D588C7-ON85257603.004FE364-85257603.0050B083@ssss.gouv.qc.ca>

Thanks Scott
The numpy version installed on the server wasn't for win32.
I download the correct version and it is working.
Thanks again for your help,
Steve

Steve Toutant, M. Sc.
Analyste en g?omatique
Secteur environnement
Direction des risques biologiques, environnementaux et occupationnels
Institut national de sant? publique du Qu?bec
945, avenue Wolfe
Qu?bec, Qc G1V 5B3 
T?l.: (418) 650-5115 #5281
Fax.: (418) 654-3144
steve.toutant@inspq.qc.ca
http://www.inspq.qc.ca
 




Scott Sinclair <scott.sinclair.za@gmail.com>@lists.osgeo.org 
Envoy? par : gdal-dev-bounces@lists.osgeo.org
30/07/2009 10:07 AM

A
gdal-dev@lists.osgeo.org
cc

Objet
Re: [gdal-dev] Numeric package








>2009/7/30  <Steve.Toutant@inspq.qc.ca>:
> In a script I have this
>     try:
>         import numpy as Numeric
>     except ImportError:
>         import Numeric
>
> I got this error when running the script
>     import Numeric
> ImportError: No module named Numeric
>
> I'm on windows
> Under C:\Python26\Lib\site-packages
> I have this
>
>
> I though numpy and numeric package were installed but it seems not.
> How can I install the numeric package properly?

You probably don't need to.

Numeric has been superseded by NumPy and is no longer actively
developed. You should use NumPy instead, whenever you have a choice
(the first part of your script is trying to do this by importing the
numpy package and calling it by the name Numeric).

It's not clear from your description where your script is failing.
What happens when you type the following at a Python prompt?

>>> import numpy
>>> numpy.__version__

Cheers,
Scott
_______________________________________________
gdal-dev mailing list
gdal-dev@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090730/774ca786/attachment.html
From lran at unc.edu  Thu Jul 30 11:22:37 2009
From: lran at unc.edu (Limei Ran)
Date: Thu Jul 30 11:23:16 2009
Subject: [gdal-dev] Error in GDAL compiling with HDF4
In-Reply-To: <4A70B3C8.4000301@pobox.com>
References: <4A707E76.9000205@unc.edu> <4A70B3C8.4000301@pobox.com>
Message-ID: <4A71BABD.6050003@unc.edu>

Hi Frank:

I tried setting -fPIC based on the web site.  But, it failed as well.  I 
checked config.log file and it has errors like:
==============
/nas/uncch/depts/cep/emc/lran/mims/sa_06_2009/src/libs/HDF4.2r4/local/lib/libdf.a(cszip.o): 
In function `HCIcszip_term':
cszip.c:(.text+0x2ae): undefined reference to `SZ_BufftoBuffCompress'
===============

It appears that szip is causing the problem.  I compiled HDF5 and HDF4 
with szip-2.1.  After I compiled HDF4 without szip.  GDAL compiling 
worked. 

But, I am wondering whether I have to compile HDF5 and HDF4 with szip to 
be used  in GDAL.

Thank you,

Limei


Frank Warmerdam wrote:

> Limei Ran wrote:
> ...
>
>> checking for FMEObjects... no
>> checking for SDreaddata in -lmfhdf... no
>> checking for SDreaddata in -lhdf4... no
>> checking for SDreaddata in -lmfhdf... no
>> checking for SDreaddata in -lmfhdf... no
>> configure: error: HDF4 support requested with arg 
>> "/nas/uncch/depts/cep/emc/lran/mims/sa_06_2009/src/libs/HDF4.2r4/local", 
>> but neither hdf4 nor mfhdf lib found
>> ===========================
>>
>> I compiled HDF4 with: --disable-netcdf --disable-fortran and I did 
>> not compile GDAL with netcdf.  When I got rid of HDF4 in gdal 
>> configure, the configuration went through.
>>
>> The config.log has a lot of errors related to conftest.c like:
>
> ...
>
>> Could you tell me what went wrong in this gdal compiling with hdf4 ?
>
>
> Limei,
>
> I think you need to find the part of the config.log that relates to 
> hdf to
> find out what went wrong.  I think one common problem is building the HDF
> library without -fPIC.
>
> You might also check:
>  http://trac.osgeo.org/gdal/wiki/HDF
>
> and consider updating it if you learn something likely to be of 
> broader use.
>
> Best regards,


From warmerdam at pobox.com  Thu Jul 30 11:52:11 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Jul 30 11:52:11 2009
Subject: [gdal-dev] Error in GDAL compiling with HDF4
In-Reply-To: <4A71BABD.6050003@unc.edu>
References: <4A707E76.9000205@unc.edu> <4A70B3C8.4000301@pobox.com>
	<4A71BABD.6050003@unc.edu>
Message-ID: <4A71C1AB.2070409@pobox.com>

Limei Ran wrote:
> Hi Frank:
> 
> I tried setting -fPIC based on the web site.  But, it failed as well.  I 
> checked config.log file and it has errors like:
> ==============
> /nas/uncch/depts/cep/emc/lran/mims/sa_06_2009/src/libs/HDF4.2r4/local/lib/libdf.a(cszip.o): 
> In function `HCIcszip_term':
> cszip.c:(.text+0x2ae): undefined reference to `SZ_BufftoBuffCompress'
> ===============
> 
> It appears that szip is causing the problem.  I compiled HDF5 and HDF4 
> with szip-2.1.  After I compiled HDF4 without szip.  GDAL compiling worked.
> But, I am wondering whether I have to compile HDF5 and HDF4 with szip to 
> be used  in GDAL.

Limei,

I normally avoid szip support as it seems rarely used and just extra
complexity.  However, if you are using static libraries for the HDF and
it depends on szip then somehow you need to introduce that into the GDAL
build.

Hmm, looking in the configure code, it appears there is a case to try with
-lsz - I'm not sure why that does not kick in.

In any event, building without szip would be my suggestion.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Thu Jul 30 12:22:31 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Jul 30 12:22:35 2009
Subject: [gdal-dev] Programmatically writing VRT files
In-Reply-To: <op.uxvxhlsbqw3wu1@titan>
References: <op.uxvxhlsbqw3wu1@titan>
Message-ID: <4A71C8C7.80807@pobox.com>

Andrew Brooks wrote:
> Hello
> 
> I'm trying to write a program to create a VRT file that represents
> raw data held in separate files by following the example in
> http://www.gdal.org/gdal_vrttut.html
> 
> I put a SimpleSource or a VRTRasterBand piece of XML into xml_string
> then, as per the example, I call
> 
>   GDALRasterBand *poBand = poDstDS->GetRasterBand( 1 );
>   poBand->SetMetadataItem( "source_0", xml_string, "vrt_sources" );
> 
> But this gives the error:
> ERROR 1: source_0 metadata item name is not recognized. Should be between source_0 and source_-1
> 
> If I use "new_vrt_sources" then I get no error, but still xml_string
> is not in the output, only <VRTRasterBand dataType="UInt16" band="1"/>
> 
> I've seen the bug  https://trac.osgeo.org/gdal/ticket/3052
> which suggests it is fixed in trunk and I'm using trunk.
> Any other ideas?

Andrew,

Perhaps you could file a ticket with a small script demonstrating the problem?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From even.rouault at mines-paris.org  Thu Jul 30 13:14:47 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu Jul 30 13:14:58 2009
Subject: [Gdal-dev] gdaladdo for large RPF
In-Reply-To: <1247696465620-3266107.post@n2.nabble.com>
References: <1247696465620-3266107.post@n2.nabble.com>
Message-ID: <200907301914.48777.even.rouault@mines-paris.org>

Charles,

sorry for the late answer.

Given the dimension of the RPF dataset, 366028x 466944, the overview file 
should be around 57 GB ( the total size of the overviews of factor 1/2, 1/4, 
1/8, 1/2^n .... is the size of the full resolution dataset divided by 3), 
which cannot fit into a traditionnal TIFF file because of the 4 GB 
limitation.

Support for creating external BigTIFF overview files has been added in trunk 
(GDAL 1.7.0dev). If you use a recent fwtools or osgeo4w package, you should 
benefit from it. But be prepared to wait for several hours / days !

See http://trac.osgeo.org/gdal/ticket/2785

Best regards,

Even
From pythonquestion at gmail.com  Thu Jul 30 13:27:51 2009
From: pythonquestion at gmail.com (python question)
Date: Thu Jul 30 13:27:54 2009
Subject: [gdal-dev] Calculate image band values within a vector
Message-ID: <6721f4330907301027n66087af2vdff04c2d3d7cabbe@mail.gmail.com>

I am very much a beginner at python and programming altogether. I have read
an introductory book, attempted many exercises and even attended a python
course. Although without applying it to something I am doing I don?t seem to
be picking it up.



I would like to jump straight in and start doing something useful with
python.

I have many georectified images each with 51 bands ranging visible to TIR.
The images are floating point BSQ and I am using ENVI and ArcGIS for
processing.I also have two complex shapefiles.

I would like to calculate the min, max, mean and SD values of each band for
within each of the two vectors.

If someone could help get started on this or point me in the right direction
for help I would really appreciate it.

Thank you
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090730/dde994ff/attachment.html
From javierurien+gdal at gmail.com  Thu Jul 30 13:32:48 2009
From: javierurien+gdal at gmail.com (Javier Urien)
Date: Thu Jul 30 13:33:10 2009
Subject: [gdal-dev] Dataset files
Message-ID: <d2595b180907301032n721a8419r5234581cb64815c@mail.gmail.com>

Is there an equivalent of GDALPamDataset::GetFileList for OGR?
something like OGRDataSource::GetFileList.

I need to know which files are part of a dataset.

Thanks in Advance!
From even.rouault at mines-paris.org  Thu Jul 30 13:38:22 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu Jul 30 13:38:36 2009
Subject: [gdal-dev] Programmatically writing VRT files
In-Reply-To: <op.uxvxhlsbqw3wu1@titan>
References: <op.uxvxhlsbqw3wu1@titan>
Message-ID: <200907301938.25210.even.rouault@mines-paris.org>

Le Thursday 30 July 2009 16:35:35 Andrew Brooks, vous avez ?crit?:
> Hello
>
> I'm trying to write a program to create a VRT file that represents
> raw data held in separate files by following the example in
> http://www.gdal.org/gdal_vrttut.html
>
> I put a SimpleSource or a VRTRasterBand piece of XML into xml_string
> then, as per the example, I call
>
>   GDALRasterBand *poBand = poDstDS->GetRasterBand( 1 );
>   poBand->SetMetadataItem( "source_0", xml_string, "vrt_sources" );
>
> But this gives the error:
> ERROR 1: source_0 metadata item name is not recognized. Should be between
> source_0 and source_-1

This error means that you had no existing source for that band. The metadata 
domain "vrt_sources" is used to replace an existing source, 
whereas "new_vrt_sources" should be used to add a new source.

>
> If I use "new_vrt_sources" then I get no error, but still xml_string
> is not in the output, only <VRTRasterBand dataType="UInt16" band="1"/>

Perhaps your xml_string is not a valid source xml. See 
http://trac.osgeo.org/gdal/changeset/17334 for examples of tested (and 
working) use of those capabilities

>
> I've seen the bug  https://trac.osgeo.org/gdal/ticket/3052
> which suggests it is fixed in trunk and I'm using trunk.
> Any other ideas?
>
> Andrew
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From even.rouault at mines-paris.org  Thu Jul 30 13:46:03 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu Jul 30 13:46:12 2009
Subject: [gdal-dev] Dataset files
In-Reply-To: <d2595b180907301032n721a8419r5234581cb64815c@mail.gmail.com>
References: <d2595b180907301032n721a8419r5234581cb64815c@mail.gmail.com>
Message-ID: <200907301946.04080.even.rouault@mines-paris.org>

Le Thursday 30 July 2009 19:32:48 Javier Urien, vous avez ?crit?:
> Is there an equivalent of GDALPamDataset::GetFileList for OGR?
> something like OGRDataSource::GetFileList.

Short and long answer : no

>
> I need to know which files are part of a dataset.
>
> Thanks in Advance!
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From Steve.Toutant at inspq.qc.ca  Thu Jul 30 14:10:35 2009
From: Steve.Toutant at inspq.qc.ca (Steve.Toutant@inspq.qc.ca)
Date: Thu Jul 30 14:10:53 2009
Subject: [gdal-dev] merge with gdalwrap
Message-ID: <OFA9B194CF.246F82BB-ON85257603.0062DDA0-85257603.0063D8DE@ssss.gouv.qc.ca>

Hi,
I tried gdal_merge.py but I got a memory Error because I use the -n nodata 
value option. Several threads sugest that I must use gdalwrap instead.
This behavior of gdal_merge.py is very important to me in this particular 
case
"In areas of overlap, the last image will be copied over earlier ones".

Does gdalwrap has the same behavior? (I ask because it is difficult to 
test and validate with my data)?

Also, the doc says "Mosaicing into an existing output file is supported if 
the output file already exists." 
But how? What is the option to append data? When launching a command for 
another image it says that I must delete the output file.

I would appreciate if someone could validate if this 
gdalwarp -srcnodata -3.4028234663852886e+38 -dstnodata 
-3.4028234663852886e+38 -of "GTiff" EstRN.img icu.tif

is the equivalent of this 
gdal_merge.py -n -3.4028234663852886e+38 -o icu.tif -of "GTiff" EstRN.img 
EstSh.img

It works but maybe some more parameters are important. 

Thanks for your help,
Steve



Steve Toutant, M. Sc.
Analyste en g?omatique
Secteur environnement
Direction des risques biologiques, environnementaux et occupationnels
Institut national de sant? publique du Qu?bec
945, avenue Wolfe
Qu?bec, Qc G1V 5B3 
T?l.: (418) 650-5115 #5281
Fax.: (418) 654-3144
steve.toutant@inspq.qc.ca
http://www.inspq.qc.ca
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090730/72e65c08/attachment.html
From warmerdam at pobox.com  Thu Jul 30 14:19:07 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Jul 30 14:19:10 2009
Subject: [gdal-dev] merge with gdalwrap
In-Reply-To: <OFA9B194CF.246F82BB-ON85257603.0062DDA0-85257603.0063D8DE@ssss.gouv.qc.ca>
References: <OFA9B194CF.246F82BB-ON85257603.0062DDA0-85257603.0063D8DE@ssss.gouv.qc.ca>
Message-ID: <4A71E41B.1040408@pobox.com>

Steve.Toutant@inspq.qc.ca wrote:
> 
> Hi,
> I tried gdal_merge.py but I got a memory Error because I use the -n 
> nodata value option. Several threads sugest that I must use gdalwrap 
> instead.
> This behavior of gdal_merge.py is very important to me in this 
> particular case
> "In areas of overlap, the last image will be copied over earlier ones".
> 
> Does gdalwrap has the same behavior? (I ask because it is difficult to 
> test and validate with my data)?

Steve,

Yes, gdalwarp will overlay valid new data over existing data with the
last gdalwarp overlaying previous data.

> Also, the doc says "Mosaicing into an existing output file is supported 
> if the output file already exists."
> But how? What is the option to append data? When launching a command for 
> another image it says that I must delete the output file.

If you pass an output file to gdalwarp and it already exists then it
will be mosaiced into.  If the output file does not already exist
then one is created.  This is different than gdal_translate which
always creates a new file.

> I would appreciate if someone could validate if this
> gdalwarp -srcnodata -3.4028234663852886e+38 -dstnodata 
> -3.4028234663852886e+38 -of "GTiff" EstRN.img icu.tif
> 
> is the equivalent of this
> gdal_merge.py -n -3.4028234663852886e+38 -o icu.tif -of "GTiff" 
> EstRN.img EstSh.img

Well, it doesn't mention EstSH.img - so no it does not seem
to be the same thing.  If you did:

gdalwarp -srcnodata -3.4028234663852886e+38 \
          EstRN.img EstSh.img icu.tif

then it should be pretty similar.  There are subtle differences
of course.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From javierurien+gdal at gmail.com  Thu Jul 30 14:24:57 2009
From: javierurien+gdal at gmail.com (Javier Urien)
Date: Thu Jul 30 14:25:19 2009
Subject: [gdal-dev] Dataset files
In-Reply-To: <200907301946.04080.even.rouault@mines-paris.org>
References: <d2595b180907301032n721a8419r5234581cb64815c@mail.gmail.com> 
	<200907301946.04080.even.rouault@mines-paris.org>
Message-ID: <d2595b180907301124y28c35db1i60cd405d316a9411@mail.gmail.com>

On Thu, Jul 30, 2009 at 14:46, Even Rouault<even.rouault@mines-paris.org> wrote:
> Le Thursday 30 July 2009 19:32:48 Javier Urien, vous avez ?crit?:
>> Is there an equivalent of GDALPamDataset::GetFileList for OGR?
>> something like OGRDataSource::GetFileList.
>
> Short and long answer : no
>

Are there any plans to add this functionality?

Should I report a Bug/Wish?

Regards
From warmerdam at pobox.com  Thu Jul 30 14:35:00 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Jul 30 14:34:58 2009
Subject: [gdal-dev] Dataset files
In-Reply-To: <d2595b180907301124y28c35db1i60cd405d316a9411@mail.gmail.com>
References: <d2595b180907301032n721a8419r5234581cb64815c@mail.gmail.com> 
	<200907301946.04080.even.rouault@mines-paris.org>
	<d2595b180907301124y28c35db1i60cd405d316a9411@mail.gmail.com>
Message-ID: <4A71E7D4.8070803@pobox.com>

Javier Urien wrote:
> On Thu, Jul 30, 2009 at 14:46, Even Rouault<even.rouault@mines-paris.org> wrote:
>> Le Thursday 30 July 2009 19:32:48 Javier Urien, vous avez ?crit :
>>> Is there an equivalent of GDALPamDataset::GetFileList for OGR?
>>> something like OGRDataSource::GetFileList.
>> Short and long answer : no
>>
> 
> Are there any plans to add this functionality?
> 
> Should I report a Bug/Wish?

Javier,

There are no immediate plans to implement this.  However, I would like to
think that if we eventually did a "grand unification" of GDAL and OGR, then
feature drivers would also have this method.  That is pretty long term though.

I do not think filing a bug/wish ticket would be particularly helpful.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From Steve.Toutant at inspq.qc.ca  Thu Jul 30 14:49:05 2009
From: Steve.Toutant at inspq.qc.ca (Steve.Toutant@inspq.qc.ca)
Date: Thu Jul 30 14:49:22 2009
Subject: [gdal-dev] merge with gdalwrap
In-Reply-To: <4A71E41B.1040408@pobox.com>
Message-ID: <OF8446F52F.A4105462-ON85257603.0066C14E-85257603.00675F45@ssss.gouv.qc.ca>

gdalwarp -srcnodata -3.4028234663852886e+38 \
          EstRN.img EstSh.img icu.tif

I thought I must launch gdalwrap once for each file. Didn't know I could 
specify several input files

I think I need to specify the extent and the resolution.
- Is the resolution is the pixel size get by gdalinfo?

- The Pixel Size is not the same for all images. Per example I got 
 (30.000000000000099,-30.000000000000103)
and 
this for another image
Pixel Size = (30.000000000000000,-30.000000000000000)

What will append if I specify -tr 30 -30 as resolution in this case

thanks
Steve
Steve Toutant, M. Sc.
Analyste en g?omatique
Secteur environnement
Direction des risques biologiques, environnementaux et occupationnels
Institut national de sant? publique du Qu?bec
945, avenue Wolfe
Qu?bec, Qc G1V 5B3 
T?l.: (418) 650-5115 #5281
Fax.: (418) 654-3144
steve.toutant@inspq.qc.ca
http://www.inspq.qc.ca
 




Frank Warmerdam <warmerdam@pobox.com> 
30/07/2009 02:19 PM

A
Steve.Toutant@inspq.qc.ca
cc
gdal-dev@lists.osgeo.org
Objet
Re: [gdal-dev] merge with gdalwrap








Steve.Toutant@inspq.qc.ca wrote:
> 
> Hi,
> I tried gdal_merge.py but I got a memory Error because I use the -n 
> nodata value option. Several threads sugest that I must use gdalwrap 
> instead.
> This behavior of gdal_merge.py is very important to me in this 
> particular case
> "In areas of overlap, the last image will be copied over earlier ones".
> 
> Does gdalwrap has the same behavior? (I ask because it is difficult to 
> test and validate with my data)?

Steve,

Yes, gdalwarp will overlay valid new data over existing data with the
last gdalwarp overlaying previous data.

> Also, the doc says "Mosaicing into an existing output file is supported 
> if the output file already exists."
> But how? What is the option to append data? When launching a command for 

> another image it says that I must delete the output file.

If you pass an output file to gdalwarp and it already exists then it
will be mosaiced into.  If the output file does not already exist
then one is created.  This is different than gdal_translate which
always creates a new file.

> I would appreciate if someone could validate if this
> gdalwarp -srcnodata -3.4028234663852886e+38 -dstnodata 
> -3.4028234663852886e+38 -of "GTiff" EstRN.img icu.tif
> 
> is the equivalent of this
> gdal_merge.py -n -3.4028234663852886e+38 -o icu.tif -of "GTiff" 
> EstRN.img EstSh.img

Well, it doesn't mention EstSH.img - so no it does not seem
to be the same thing.  If you did:

gdalwarp -srcnodata -3.4028234663852886e+38 \
          EstRN.img EstSh.img icu.tif

then it should be pretty similar.  There are subtle differences
of course.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, 
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent




-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090730/04b292bc/attachment.html
From warmerdam at pobox.com  Thu Jul 30 14:56:09 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Jul 30 14:56:05 2009
Subject: [gdal-dev] merge with gdalwrap
In-Reply-To: <OF8446F52F.A4105462-ON85257603.0066C14E-85257603.00675F45@ssss.gouv.qc.ca>
References: <OF8446F52F.A4105462-ON85257603.0066C14E-85257603.00675F45@ssss.gouv.qc.ca>
Message-ID: <4A71ECC9.20308@pobox.com>

Steve.Toutant@inspq.qc.ca wrote:
> 
> gdalwarp -srcnodata -3.4028234663852886e+38 \
>          EstRN.img EstSh.img icu.tif
> 
> I thought I must launch gdalwrap once for each file. Didn't know I could 
> specify several input files

Steve,

This is a relatively new feature - likely new in 1.6.0.

> I think I need to specify the extent and the resolution.
> - Is the resolution is the pixel size get by gdalinfo?
> 
> - The Pixel Size is not the same for all images. Per example I got
>  (30.000000000000099,-30.000000000000103)
> and
> this for another image
> Pixel Size = (30.000000000000000,-30.000000000000000)
> 
> What will append if I specify -tr 30 -30 as resolution in this case

I do not believe you should be using a negative for the y pixel size.
In this regard it is a bit different than the way things appear in the
geotransform.

If you want an output image with 30m pixels, you would indeed specify
"-tr 30 30"

If you don't specify, gdalwarp will pick a resolution - possibly based
on the first file, or perhaps the highest resolution file.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From mikhail.itkin at zmaw.de  Thu Jul 30 14:43:48 2009
From: mikhail.itkin at zmaw.de (Mikhail Itkin)
Date: Thu Jul 30 15:05:04 2009
Subject: [gdal-dev] Writing support for netCDF, HDF4, HDF5
Message-ID: <4A71E9E4.5080604@zmaw.de>

Hi,

Is it possible to write HDF5 files with gdal? Is it possible to create 
NetCDF files without having a "prototype" file?

I am currently trying how GDAL works with python, to see if it can fit 
our research group needs. All three formats NetCDF, HDF4 and HDF5 have 
writing support according to the description on the gdal.org. However 
it's not that easy to find how it really works.

After reading GDAL API tutorial i found that HDF4 driver doesn't have 
neither Create() nor CreateCopy() methods, netCDF has only CreateCopy(), 
and HDF5 doesn't have any. And surprisingly there is another driver, 
called "HDF4Image" which does have Create method.

I have put a short summary here: 
http://wiki.zmaw.de/mpimet/MikhailItkin/WorkAndCodeNotes/Gdal/DataFormats

Does this mean creating HDF5 by gdal means is not possible at the 
moment? What is the difference between HDF4 and HDF4Image?

Sorry, i am only a beginner in using gdal and any help or pointers to 
related documentation is appreciated.

Regards,
Mikhail
From javierurien+gdal at gmail.com  Thu Jul 30 15:20:44 2009
From: javierurien+gdal at gmail.com (Javier Urien)
Date: Thu Jul 30 15:26:07 2009
Subject: [gdal-dev] Dataset files
In-Reply-To: <4A71E7D4.8070803@pobox.com>
References: <d2595b180907301032n721a8419r5234581cb64815c@mail.gmail.com> 
	<200907301946.04080.even.rouault@mines-paris.org>
	<d2595b180907301124y28c35db1i60cd405d316a9411@mail.gmail.com> 
	<4A71E7D4.8070803@pobox.com>
Message-ID: <d2595b180907301220n744a78d7v137f6c330bea62a5@mail.gmail.com>

On Thu, Jul 30, 2009 at 15:35, Frank Warmerdam<warmerdam@pobox.com> wrote:

> Javier,
>
> There are no immediate plans to implement this. ?However, I would like to
> think that if we eventually did a "grand unification" of GDAL and OGR, then
> feature drivers would also have this method. ?That is pretty long term
> though.
>
> I do not think filing a bug/wish ticket would be particularly helpful.
>

Roger that!
Regards!
From even.rouault at mines-paris.org  Thu Jul 30 15:27:17 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu Jul 30 15:27:27 2009
Subject: [gdal-dev] Writing support for netCDF, HDF4, HDF5
In-Reply-To: <4A71E9E4.5080604@zmaw.de>
References: <4A71E9E4.5080604@zmaw.de>
Message-ID: <200907302127.18053.even.rouault@mines-paris.org>

Le Thursday 30 July 2009 20:43:48 Mikhail Itkin, vous avez ?crit?:
> Hi,
>
> Is it possible to write HDF5 files with gdal?

No, this was an error in the format page. Rectified now.

> Is it possible to create 
> NetCDF files without having a "prototype" file?

Not sure what you mean by a prototype file : a source dataset for 
CreateCopy() ? NetCDF has only CreateCopy() implemented, so you need a source 
dataset

>
> I am currently trying how GDAL works with python, to see if it can fit
> our research group needs. All three formats NetCDF, HDF4 and HDF5 have
> writing support according to the description on the gdal.org. However
> it's not that easy to find how it really works.
>
> After reading GDAL API tutorial i found that HDF4 driver doesn't have
> neither Create() nor CreateCopy() methods, netCDF has only CreateCopy(),
> and HDF5 doesn't have any. And surprisingly there is another driver,
> called "HDF4Image" which does have Create method.
>
> I have put a short summary here:
> http://wiki.zmaw.de/mpimet/MikhailItkin/WorkAndCodeNotes/Gdal/DataFormats
>
> Does this mean creating HDF5 by gdal means is not possible at the
> moment?

> What is the difference between HDF4 and HDF4Image? 

HDF4 can report several subdatasets, which are opened by the HDF4Image driver. 
To create a HDF4 dataset, you must use Create()/CreateCopy() on the HDF4Image 
driver.

>
> Sorry, i am only a beginner in using gdal and any help or pointers to
> related documentation is appreciated.

You can look at several examples in GDAL python autotest suite :

http://trac.osgeo.org/gdal/browser/trunk/autotest/gcore/hdf4_read.py
http://trac.osgeo.org/gdal/browser/trunk/autotest/gcore/hdf4_write.py
http://trac.osgeo.org/gdal/browser/trunk/autotest/gdrivers/netcdf.py
http://trac.osgeo.org/gdal/browser/trunk/autotest/gdrivers/hdf5.py

>
> Regards,
> Mikhail
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From pythonquestion at gmail.com  Thu Jul 30 16:53:56 2009
From: pythonquestion at gmail.com (python question)
Date: Thu Jul 30 16:54:00 2009
Subject: [gdal-dev] open satellite image and display
Message-ID: <6721f4330907301353r6a40c415pfffdc58da60fb394@mail.gmail.com>

How can I open an ENVI image using python and display different band
combinations?
Is there some where I can go to see examples of this?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090730/6802145e/attachment-0001.html
From neteler at osgeo.org  Thu Jul 30 17:50:58 2009
From: neteler at osgeo.org (Markus Neteler)
Date: Thu Jul 30 17:51:00 2009
Subject: [gdal-dev] open satellite image and display
In-Reply-To: <6721f4330907301353r6a40c415pfffdc58da60fb394@mail.gmail.com>
References: <6721f4330907301353r6a40c415pfffdc58da60fb394@mail.gmail.com>
Message-ID: <86782b610907301450l1813d356le79e287274c96d04@mail.gmail.com>

On Thu, Jul 30, 2009 at 10:53 PM, python
question<pythonquestion@gmail.com> wrote:
> How can I open an ENVI image using python and display different band
> combinations?
> Is there some where I can go to see examples of this?

python question,
you need a GIS application for that which uses GDAL like
GRASS or QGIS. See www.osgeo.org for links.

Both support Python.

Markus
From tuna_balik at yahoo.com  Thu Jul 30 23:21:09 2009
From: tuna_balik at yahoo.com (tunabalik)
Date: Thu Jul 30 23:27:51 2009
Subject: [gdal-dev] NITF creation
Message-ID: <323967.28662.qm@web56306.mail.re3.yahoo.com>

I know this is very simple. I RTFMed as much as I could. 
I have RPC as well as offset and scale values. I want to create NITF files out of TIFFs. I sense gdalwarp is the command, but I really cannot figure out how to embed these coefficients to the header file. I am not asking for step by step explanation. Any link to a help file will do.
Thanks.
?



      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090730/fa04d467/attachment.html
From chaitanya.ch at gmail.com  Fri Jul 31 00:41:02 2009
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Fri Jul 31 00:41:05 2009
Subject: [gdal-dev] NITF creation
In-Reply-To: <323967.28662.qm@web56306.mail.re3.yahoo.com>
References: <323967.28662.qm@web56306.mail.re3.yahoo.com>
Message-ID: <eb502d880907302141j3c31d2demf19cd8d3774e95a4@mail.gmail.com>

tunabalik,

Try gdal_translate instead of gdalwarp.

Best regards,
-- 
Chaitanya kumar CH.

On Fri, Jul 31, 2009 at 8:51 AM, tunabalik <tuna_balik@yahoo.com> wrote:

> I know this is very simple. I RTFMed as much as I could.
> I have RPC as well as offset and scale values. I want to create NITF files
> out of TIFFs. I sense gdalwarp is the command, but I really cannot figure
> out how to embed these coefficients to the header file. I am not asking for
> step by step explanation. Any link to a help file will do.
> Thanks.
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090731/67ae9008/attachment.html
From ariasgore at gmx.de  Fri Jul 31 04:12:46 2009
From: ariasgore at gmx.de (ariasgore@gmx.de)
Date: Fri Jul 31 04:12:55 2009
Subject: [gdal-dev] PNG usage issues
Message-ID: <20090731081246.102180@gmx.net>

Hello,

we have been using an old gdal version (1.0.x) with our projects, there was the png support compiled into the gdal library. Dependency Walker proved there were global png_* functions in the gdal library (.dll at this point)

Due to some issues with png I had to update the png format directory and replaced all old png lib files with new ones (the gdal version remained unchanged)
but now the compiled lib does not contain any png related functions anymore.

Same goes for the latest gdal 1.6.x version.

I was trying to read a png file by including 
png/pngdataset.h which is provided by gdal. during compile and link-time this action fails with unresolved symbol errors (in VC it's LNK2019).
Missing functions are png_create_struct and so on, basically it looks like even if the nmake.opt should build and include png as internal lib, there are no functions exported with it.

nmake and everything else have been left with their default values, so I dont get, how gdal is supposed to handle png now.

Thanks
Sam
-- 
Neu: GMX Doppel-FLAT mit Internet-Flatrate + Telefon-Flatrate
f?r nur 19,99 Euro/mtl.!* http://portal.gmx.net/de/go/dsl02
From chaitanya.ch at gmail.com  Fri Jul 31 06:52:39 2009
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Fri Jul 31 06:52:42 2009
Subject: [gdal-dev] PNG usage issues
In-Reply-To: <20090731081246.102180@gmx.net>
References: <20090731081246.102180@gmx.net>
Message-ID: <eb502d880907310352p28a34628w1f54d20aec92cd8b@mail.gmail.com>

Sam,

This looks like a PNG issue rather than a GDAL one. FYI, versions of libpng
used are libpng1.2.15 in GDAL1.6 and libpng1.2.35 in GDAL trunk. You may
also want to checkout libpng.org

Best regards,
-- 
Chaitanya kumar CH.

On Fri, Jul 31, 2009 at 1:42 PM, <ariasgore@gmx.de> wrote:

> Hello,
>
> we have been using an old gdal version (1.0.x) with our projects, there was
> the png support compiled into the gdal library. Dependency Walker proved
> there were global png_* functions in the gdal library (.dll at this point)
>
> Due to some issues with png I had to update the png format directory and
> replaced all old png lib files with new ones (the gdal version remained
> unchanged)
> but now the compiled lib does not contain any png related functions
> anymore.
>
> Same goes for the latest gdal 1.6.x version.
>
> I was trying to read a png file by including
> png/pngdataset.h which is provided by gdal. during compile and link-time
> this action fails with unresolved symbol errors (in VC it's LNK2019).
> Missing functions are png_create_struct and so on, basically it looks like
> even if the nmake.opt should build and include png as internal lib, there
> are no functions exported with it.
>
> nmake and everything else have been left with their default values, so I
> dont get, how gdal is supposed to handle png now.
>
> Thanks
> Sam
> --
> Neu: GMX Doppel-FLAT mit Internet-Flatrate + Telefon-Flatrate
> f?r nur 19,99 Euro/mtl.!* http://portal.gmx.net/de/go/dsl02
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090731/50614934/attachment.html
From Martin.Sommer at eads.com  Fri Jul 31 07:47:00 2009
From: Martin.Sommer at eads.com (Sommer, Martin)
Date: Fri Jul 31 07:47:25 2009
Subject: AW: [gdal-dev] PNG usage issues
In-Reply-To: <eb502d880907310352p28a34628w1f54d20aec92cd8b@mail.gmail.com>
References: <20090731081246.102180@gmx.net>
	<eb502d880907310352p28a34628w1f54d20aec92cd8b@mail.gmail.com>
Message-ID: <809C01ADEDDDFA4EBA028B5A35A10E0A01AB90CA@deimsg41.de.net.world>

The old one was possibly statically linked. The newer libs are just dynamic lib files.

 

________________________________

Von: gdal-dev-bounces@lists.osgeo.org [mailto:gdal-dev-bounces@lists.osgeo.org] Im Auftrag von Chaitanya kumar CH
Gesendet: Freitag, 31. Juli 2009 12:53
An: ariasgore@gmx.de
Cc: gdal-dev@lists.osgeo.org
Betreff: Re: [gdal-dev] PNG usage issues

 

Sam,

This looks like a PNG issue rather than a GDAL one. FYI, versions of libpng used are libpng1.2.15 in GDAL1.6 and libpng1.2.35 in GDAL trunk. You may also want to checkout libpng.org

Best regards,
-- 
Chaitanya kumar CH.

On Fri, Jul 31, 2009 at 1:42 PM, <ariasgore@gmx.de> wrote:

Hello,

we have been using an old gdal version (1.0.x) with our projects, there was the png support compiled into the gdal library. Dependency Walker proved there were global png_* functions in the gdal library (.dll at this point)

Due to some issues with png I had to update the png format directory and replaced all old png lib files with new ones (the gdal version remained unchanged)
but now the compiled lib does not contain any png related functions anymore.

Same goes for the latest gdal 1.6.x version.

I was trying to read a png file by including
png/pngdataset.h which is provided by gdal. during compile and link-time this action fails with unresolved symbol errors (in VC it's LNK2019).
Missing functions are png_create_struct and so on, basically it looks like even if the nmake.opt should build and include png as internal lib, there are no functions exported with it.

nmake and everything else have been left with their default values, so I dont get, how gdal is supposed to handle png now.

Thanks
Sam
--
Neu: GMX Doppel-FLAT mit Internet-Flatrate + Telefon-Flatrate
f?r nur 19,99 Euro/mtl.!* http://portal.gmx.net/de/go/dsl02
_______________________________________________
gdal-dev mailing list
gdal-dev@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev





-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090731/09a3e674/attachment-0001.html
From marco.hugentobler at karto.baug.ethz.ch  Fri Jul 31 08:42:09 2009
From: marco.hugentobler at karto.baug.ethz.ch (Hugentobler  Marco)
Date: Fri Jul 31 08:43:14 2009
Subject: [gdal-dev] Shapefile spatial index and updates
Message-ID: <04DA676AA276F045B32D0F95783D7844948980@EX6.d.ethz.ch>

Hi gdal/ogr devs

In QGIS, there is a bug where updates to shapefiles are not displayed until the spatial index of a shapefile is recreated (http://trac.osgeo.org/qgis/ticket/1572).

It seems to me that OGR does not update the index automatically when calling e.g. OGR_L_CreateFeature and then OGR_L_SyncToDisk.

What I did is to check (in the ogr provider of qgis) if the shapefile already has an index file and, if yes, create a new spatial index. But this way, the whole index needs to be recreated, so I wanted to ask here on the list if you know about any more efficient and / or more elegant way to solve this problem.


Thanks for your help,
Marco 
From chaitanya.ch at gmail.com  Fri Jul 31 08:47:46 2009
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Fri Jul 31 08:55:01 2009
Subject: [gdal-dev] Shapefile spatial index and updates
In-Reply-To: <04DA676AA276F045B32D0F95783D7844948980@EX6.d.ethz.ch>
References: <04DA676AA276F045B32D0F95783D7844948980@EX6.d.ethz.ch>
Message-ID: <eb502d880907310547l79e0dceeo587718b8dee17c9e@mail.gmail.com>

Marco,

I have been working on this. http://trac.osgeo.org/gdal/ticket/2798

On Fri, Jul 31, 2009 at 6:12 PM, Hugentobler Marco <
marco.hugentobler@karto.baug.ethz.ch> wrote:

> Hi gdal/ogr devs
>
> In QGIS, there is a bug where updates to shapefiles are not displayed until
> the spatial index of a shapefile is recreated (
> http://trac.osgeo.org/qgis/ticket/1572).
>
> It seems to me that OGR does not update the index automatically when
> calling e.g. OGR_L_CreateFeature and then OGR_L_SyncToDisk.
>
> What I did is to check (in the ogr provider of qgis) if the shapefile
> already has an index file and, if yes, create a new spatial index. But this
> way, the whole index needs to be recreated, so I wanted to ask here on the
> list if you know about any more efficient and / or more elegant way to solve
> this problem.
>
>
> Thanks for your help,
> Marco
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


Best regards,
-- 
Chaitanya kumar CH.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090731/f9d1b246/attachment.html
From marco.hugentobler at karto.baug.ethz.ch  Fri Jul 31 08:55:13 2009
From: marco.hugentobler at karto.baug.ethz.ch (Hugentobler  Marco)
Date: Fri Jul 31 08:57:49 2009
Subject: AW: [gdal-dev] Shapefile spatial index and updates
References: <04DA676AA276F045B32D0F95783D7844948980@EX6.d.ethz.ch>
	<eb502d880907310547l79e0dceeo587718b8dee17c9e@mail.gmail.com>
Message-ID: <04DA676AA276F045B32D0F95783D7844948981@EX6.d.ethz.ch>

Hi Chaitanya

Thanks for this information. So I'm going to commit the workaround to QGIS for now and remove it later once your work is finished (and the corresponding OGR version found it's way into most standard distros).

Regards,
Marco

-----Urspr?ngliche Nachricht-----
Von: Chaitanya kumar CH [mailto:chaitanya.ch@gmail.com]
Gesendet: Fr 31.07.2009 14:47
An: Hugentobler  Marco
Cc: gdal-dev@lists.osgeo.org
Betreff: Re: [gdal-dev] Shapefile spatial index and updates
 
Marco,

I have been working on this. http://trac.osgeo.org/gdal/ticket/2798

On Fri, Jul 31, 2009 at 6:12 PM, Hugentobler Marco <
marco.hugentobler@karto.baug.ethz.ch> wrote:

> Hi gdal/ogr devs
>
> In QGIS, there is a bug where updates to shapefiles are not displayed until
> the spatial index of a shapefile is recreated (
> http://trac.osgeo.org/qgis/ticket/1572).
>
> It seems to me that OGR does not update the index automatically when
> calling e.g. OGR_L_CreateFeature and then OGR_L_SyncToDisk.
>
> What I did is to check (in the ogr provider of qgis) if the shapefile
> already has an index file and, if yes, create a new spatial index. But this
> way, the whole index needs to be recreated, so I wanted to ask here on the
> list if you know about any more efficient and / or more elegant way to solve
> this problem.
>
>
> Thanks for your help,
> Marco
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


Best regards,
-- 
Chaitanya kumar CH.

From chaitanya.ch at gmail.com  Fri Jul 31 09:11:35 2009
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Fri Jul 31 09:11:39 2009
Subject: [gdal-dev] Calculate image band values within a vector
In-Reply-To: <6721f4330907301027n66087af2vdff04c2d3d7cabbe@mail.gmail.com>
References: <6721f4330907301027n66087af2vdff04c2d3d7cabbe@mail.gmail.com>
Message-ID: <eb502d880907310611l76ed6304w246268d9d4660c8e@mail.gmail.com>

python question,

http://trac.osgeo.org/gdal/browser/trunk/autotest/gdrivers is a good place
for simple and powerful examples involving GDAL drivers.

BTW, nice mail-id!

On Thu, Jul 30, 2009 at 10:57 PM, python question
<pythonquestion@gmail.com>wrote:

> I am very much a beginner at python and programming altogether. I have read
> an introductory book, attempted many exercises and even attended a python
> course. Although without applying it to something I am doing I don?t seem to
> be picking it up.
>
>
>
> I would like to jump straight in and start doing something useful with
> python.
>
> I have many georectified images each with 51 bands ranging visible to TIR.
> The images are floating point BSQ and I am using ENVI and ArcGIS for
> processing.I also have two complex shapefiles.
>
> I would like to calculate the min, max, mean and SD values of each band for
> within each of the two vectors.
>
> If someone could help get started on this or point me in the right
> direction for help I would really appreciate it.
>
> Thank you
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
Best regards,
Chaitanya kumar CH.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090731/a25b4398/attachment.html
From Steve.Toutant at inspq.qc.ca  Fri Jul 31 09:53:30 2009
From: Steve.Toutant at inspq.qc.ca (Steve.Toutant@inspq.qc.ca)
Date: Fri Jul 31 09:53:46 2009
Subject: [gdal-dev] gdalwarp merge problem
Message-ID: <OFAA940988.49670403-ON85257604.004C253F-85257604.004C4F5B@ssss.gouv.qc.ca>

Hi,
Still trying to merge images...
I need to merge several images. As an example The image EstMtl.tif must be 
over the image EstGa.tif.

Here is the command
gdalwarp -srcnodata -3.4028234663852886e+038 -dstnodata 0 -of "GTiff" -te 
-931841.246 126213 241462 805816 -tr 30.0 30.0 EstGa.tif icu.tif
gdalwarp -srcnodata -3.4028234663852886e+038 -dstnodata 0 EstMtl.tif 
icu.tif

I think the pixels with novalue of the overlay image are hiding the pixels 
with value of the image under.
Is there a way to avoid this?

Thanks
Steve


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090731/0ba05f90/attachment.html
From hobu.inc at gmail.com  Fri Jul 31 10:08:02 2009
From: hobu.inc at gmail.com (Howard Butler)
Date: Fri Jul 31 10:09:47 2009
Subject: [gdal-dev] GDAL 1.6.2 RC1 Released
In-Reply-To: <FF1C2B46-13CE-4FE0-93DF-2A02F36C05C2@gmail.com>
References: <FF1C2B46-13CE-4FE0-93DF-2A02F36C05C2@gmail.com>
Message-ID: <7C011ACC-ADA4-45DB-B9C4-6801973154FC@gmail.com>

All,

The GDAL team is pleased to announce the release of GDAL 1.6.2 RC1.

* http://download.osgeo.org/gdal/gdal-1.6.2-RC1.tar.gz
* http://download.osgeo.org/gdal/gdal162-RC1.zip

The following issues were addressed in this release:

General:
  * OGR expression parser causes access violations with large  
expressions (#2996)
  * OGR cannot open/handle .DBF files > 2 GB (#3011)
  * crash in cpl_vsil_win32.cpp when compiling as x64 under Windows  
(#3035)
  * create index sql execute problem (#3044)
  * GTiffDataset::FlushCache() cause crashes when used just after  
dataset creation (#3067)
  * GDALDefaultOverviews::BuildOverviews() causes out-of-bounds writes  
for a 1x1 dataset (#3069)
  * gdaladdo crashes on a 16-bit dataset when external overviews are  
requested to have JPEG compression (#3070)
  * Corrupt EXIF info can cause stack buffer overflow in JPEG driver  
(#3078)

GDAL:
  * GenBin driver problems (#2730)
  * Additional dependency to libgdal.so added during linking in gdal/ 
apps (#2970)
  * This NITF Can not be opened (endless loop) with recent GDAL (#3001)
  * This NITF Can not be opened (endless loop) with recent GDAL (#3002)
  * PPM Driver 16bit Support Byte Order Decision Questionable (#3012)
  * GDAL changes projection parameter values (#3017)
  * bad reading of AAIGRID dataset whose last line doesn't have a  
linebreak character (#3022)
  * HDF5 Subdataset Issue (#3024)
  * jp2kak driver can't display this unsigned 16 bit J2K image (#3027)
  * NITF PRJPSB TRE handling wrong for Transverse Mercator (#3029)
  * gdaladdo not producing correct overviews for greyscale+alpha image  
(#3033)
  * GDALLoadRPB/IMDFile fails with path (#3047)
  * Setting stats and histogram to JP2 compressed NITF corrupts the  
aux.xml (#3051)
  * poBand->SetMetadataItem( "source_0", szFilterSourceXML,  
"vrt_sources" ) not supported as expected (#3052)
  * gdaladdo fails with JPEG YCBCR when interleaving is not specified  
to be pixel (#3064)
  * georaster - NLS problem with XML metadata (#3066)
  * gdalwarp can crash when reprojecting into an irrelevant SRS (#3079)

OGR:
  * Relax KML driver about xmlns (#3004)
  * KML driver painfully slow when reading huge geometries (#3005)
  * PG driver does not recognize 'real' data type (#3006)
  * X-Plane reader: Bezier curves in Pavement and APTLinefeature not  
curved (#3030)

OGR Spatial References:
  * Mercator with scale=1 at non-equatoral latitude handled  
improperly. (#3026)
  * Hotine Oblique Mercator translation to PROJ.4 format looses scale  
factor. (#3032)
  * Equidistant Conic ESRI Morphing Broken (#3086)

Python:
  * OGRFeature.SetField segfault (#3000)

.NET:
  * C# Osr.GetProjectionMethodParameterList / OPTGetParameterList  
Access Violation (#3018)
  * [PATCH - C#] Dataset.ReadRaster()/WriteRaster() doesn't work on  
multi-band datasets (#3073)


If no significant issues are identified, a PSC vote will be called for  
to promote this RC to final on Wednesday or Thursday next week.

Howard

From Steve.Toutant at inspq.qc.ca  Fri Jul 31 10:52:56 2009
From: Steve.Toutant at inspq.qc.ca (Steve.Toutant@inspq.qc.ca)
Date: Fri Jul 31 10:53:18 2009
Subject: [gdal-dev] Re: gdalwarp merge problem (SOLVED)
In-Reply-To: <4A72FDD2.6050702@mapgears.com>
Message-ID: <OF8750D589.56588CFF-ON85257604.00514883-85257604.0051C03C@ssss.gouv.qc.ca>

Good catch Daniel!
Daniel knew that my orginal images were in HFA (.img) float32 and was 
translated to byte and scaled . I'm trying to merge those byte-scaled 
images.
The nodata value for these file is 0 and not -3.4028234663852886e+038 
anymore.

What confused me is gdalinfo on those new images. Even if they are in 
BYTE, gdalinfo returns the nodata value, Min, Max, etc. of the original 
images in float32.

Is that a bug?
thanks
Steve


Steve Toutant, M. Sc.
Analyste en g?omatique
Secteur environnement
Direction des risques biologiques, environnementaux et occupationnels
Institut national de sant? publique du Qu?bec
945, avenue Wolfe
Qu?bec, Qc G1V 5B3 
T?l.: (418) 650-5115 #5281
Fax.: (418) 654-3144
steve.toutant@inspq.qc.ca
http://www.inspq.qc.ca
 




Daniel Morissette <dmorissette@mapgears.com> 
31/07/2009 10:21 AM

A
Steve.Toutant@inspq.qc.ca
cc

Objet
Re: gdalwarp merge problem








Steve.Toutant@inspq.qc.ca wrote:
> 
> Hi,
> Still trying to merge images...
> I need to merge several images. As an example The image EstMtl.tif must 
> be over the image EstGa.tif.
> 
> Here is the command
> gdalwarp -srcnodata -3.4028234663852886e+038 -dstnodata 0 -of "GTiff" 
> -te -931841.246 126213 241462 805816 -tr 30.0 30.0 EstGa.tif icu.tif
> gdalwarp -srcnodata -3.4028234663852886e+038 -dstnodata 0 EstMtl.tif 
> icu.tif
> 
>

Steve,

Dans ton courriel hier ? ce sujet tu ?crivais:

"Voici une image suite au merge originaux-scaled-google"

Est-ce que tu fais ton merge sur les originaux ou sur les images "scaled"?

Si tu travailles avec les images scaled, alors il faudrait utiliser 
"-scrnodata 0" puisque la valeur de nodata -3.4028234663852886e+038 
s'applique seulement aux images originales en float et il me semblait 
qu'apr?s le scale les nodata ?taient ? 0.

Peux-tu SVP v?rifier ?a?

Daniel
-- 
Daniel Morissette
http://www.mapgears.com/



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090731/8cc5ca7b/attachment-0001.html
From nicolas.simon at spw.wallonie.be  Fri Jul 31 11:08:34 2009
From: nicolas.simon at spw.wallonie.be (Nicolas Simon)
Date: Fri Jul 31 11:08:39 2009
Subject: [gdal-dev] OGR OCI Driver improvement
In-Reply-To: <4A707254.4060709@pobox.com>
Message-ID: <8C7DAE7B21100F4CABDD600FAAD339D003C4B60F@DGA-EXC01.mrw.wallonie.int>

Franck,

	I'm interested in becoming a longer term contributor for the OCI driver.
	
	What format do you prefer for fixes ?  Patch format against main trunk ?
	I 'll also provide test to demonstrate the problem and the fix.

	Is there a standard way to provide test suite ?
	
	Thanks for your advice. 

	Nicolas
  
-----Message d'origine-----
De : Frank Warmerdam [mailto:warmerdam@pobox.com]
Envoy? : mercredi 29 juillet 2009 18:01
? : Nicolas Simon
Cc : gdal-dev@lists.osgeo.org
Objet : Re: [gdal-dev] OGR OCI Driver improvement

Nicolas Simon wrote:
> Dear developpers,
> 
> I use OCI driver for a while and I found some problems
> 
> These problems are blocking for me and I already have solution for some 
> of them.
> 
> My firsts questions are organisational.
> What to do to have the code I proposed tested by other people sharing 
> the same problem ?
> How to get these patch included in the main trunk for a future release 
> of GDAL ?

Nicolas,

Please attach the fixes to the tickets in question (and add yourself to the
cc:list).  Create new tickets for issues for which tickets do not yet exist.
Please ensure fixes are provided against trunk if possible.

If you are interested in becoming a longer term contributor - perhaps with
primary responsibility for the OCI driver - we could pursue that issue after
some of these fixes have at least been reviewed.

Unfortunately, my oracle development environment isn't that conveniently
accessable, but I could drop into it for a bit to try and test and apply
your patches when they are all available.  It would be very helpful for you
to include simple means to demonstrate the problems and confirm the fixes
- ideally leading to additional test suite tests.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent





From jorge.arevalo at gmail.com  Fri Jul 31 12:04:14 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Fri Jul 31 12:04:37 2009
Subject: [gdal-dev] Re: [SoC] GDAL WKTRaster weekly report #9
In-Reply-To: <4A6FDAA7.1020903@pobox.com>
References: <cb4457700907260323n25c80a6dxae52f5fd2994d051@mail.gmail.com> 
	<4A6FDAA7.1020903@pobox.com>
Message-ID: <cb4457700907310904h1a8136e5jaa671e5eb26d0f87@mail.gmail.com>

Hello,

2009/7/29 Frank Warmerdam <warmerdam@pobox.com>:
> Jorge Ar?valo wrote:
>>
>> Hello,
>>
>> Here, the report:
>> http://www.gis4free.org/blog/2009/07/26/gsoc-09-weekly-report-9-1707-2407/
>>
>> And here, the project page:
>> http://trac.osgeo.org/gdal/wiki/WKTRasterDriver
>
> Jorge,
>
> The progress looks good. You mentioned adding overviews tables as
> subdatasets of the general dataset. ?This isn't the usual way of
> representing overviews which should be accessable via GetOverview() on
> the GDALRasterBand. ?Was this aspect done as well?

Yes, it's not commited yet. But, where do you store the overviews? The
overviews are a kind of datasets exposed via GetOverview method and
based in the first level dataset, right? So, when I'm creating a
dataset, I can create overviews as other datasets that are stored in
an array in the more general dataset. Then, they are like "children
datasets". Is this point incorrect?

>
> Is there any mechanism currently for creating overviews? ?How have
> you been testing overviews?

gdal2wktraster script is able to construct overview tables, as Mateusz
said. I tested the code by creating an overview of a dataset (with
gdal2wktraster script) and reading it with gdalinfo as metadata of
SUBDATASETS domain. I need more testing at this point, to somehow read
each overview and maybe store it as out-db raster. I'm not sure on how
to test it properly.


>
> Under DOUBTs you ask what happens if the bounding box of a block
> does not match any real block in the table, what should happen. ?In this
> case IReadBlock() should fill the buffer with the nodata value (zero if
> nodata is not set).

Ok, understood.

>
> You also mention a doubt about how to handle the 16BF type, which is
> apparently "16-bit float". ?I have never seen such a thing before and I'm
> not sure why it is part of the WKTRaster specification. I would suggest
> removing it.
>
> However, if we wanted to support it (and you could figure out what it
> actually is), then I think it would be most appropriate to transform it
> into a 32bit float as it is read in IReadBlock(). ?Presumably the full
> range of a 16bit float could not be kept in a 16 bit integer.

Actually, now I transform it in a 32bit float

>
> Likewise, 1BB, 2BUI, and 4BUI values (if supported) should be
> translated on the fly into GDT_Byte values. ?However, there is a special
> NBITS metadata item in the IMAGE_STRUCTURE metadata domain that can
> be set in these cases to represent the special nature of the image data.
> Likewise there is a special value to indicate signed eight bit integers.
> These values are discussed in:
>
> ?http://trac.osgeo.org/gdal/wiki/rfc14_imagestructure
>
> However, I consider implementation of these esoteric types optional given
> the relatively limited time remaining.

Ok. Added to my todo list.


Thanks Frank

Best regards,
Jorge

>
> Best regards,
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up ? | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush ? ?| Geospatial Programmer for Rent
>
>
From BCassanova at weather.com  Fri Jul 31 13:56:39 2009
From: BCassanova at weather.com (Cassanova, Bill)
Date: Fri Jul 31 13:58:27 2009
Subject: [gdal-dev] Help understanding GDALApplyGeoTransform and
	GDALInvGeoTransform
Message-ID: <1D5F4E64B8C04F4C868B94AC9A532AF80AD0636A@ATLMAIL01.corp.weather.com>

Hi All,

I found a post a while back regarding GDALApplyGeoTransform and
GDALInvGeoTransform
(http://n2.nabble.com/Converting-raster-pixel-space-to-geospace-td325875
1.html )

GDALApplyGeoTransform() will convert from pixels to georeferenced
positions 
and GDALInvGeoTransform() will invert the geotransform matrix, so using 
GDALApplyGeoTransform() on that inverted matrix will do the reverse 
conversion (georeferenced positions --> pixel positions)


I have written some test code that for some reason is not returning the
correct results:

double adfGeoTransform[6] = { -127, .011571482, 0, 51, 0, -.008993 };

double adfReverseGeoTransform[6] = { 0, 0, 0, 0, 0, 0 };

GDALInvGeoTransform( adfGeoTransform, adfReverseGeoTransform );

double dfPixel = 0;
double dfLine = 0;
double x;
double y;

GDALApplyGeoTransform(   adfGeoTransform, dfPixel, dfLine, &x, &y );

std::cout << "lat-lon " << x << ", " << y << std::endl;

double new_x;
double new_y;

GDALApplyGeoTransform(   adfReverseGeoTransform, x, y, &new_x, &new_y );

std::cout << new_x << ", " << new_y << std::endl;


========================================================================
============
Output

lat-lon -127, 51  This result is correct as I have requested the lat-lon
of the first point.

This result is NOT correct.  I pushed the values -127, and 51 through
the inverse transform.  I would have thought the answer
Would have been 0, 0.  

10975.3, 5671.08

Thanks,
Bill
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090731/c85114b8/attachment.html
From even.rouault at mines-paris.org  Fri Jul 31 14:20:46 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri Jul 31 14:20:59 2009
Subject: [gdal-dev] Help understanding GDALApplyGeoTransform and
	GDALInvGeoTransform
In-Reply-To: <1D5F4E64B8C04F4C868B94AC9A532AF80AD0636A@ATLMAIL01.corp.weather.com>
References: <1D5F4E64B8C04F4C868B94AC9A532AF80AD0636A@ATLMAIL01.corp.weather.com>
Message-ID: <200907312020.48254.even.rouault@mines-paris.org>

Bill,

that's weird. Your code looks correct and I've just compiled it and I get the 
following results :

lat-lon -127, 51
7.24754e-13, 4.12115e-13

The new_x, new_y values are almost 0 as expected (the small difference is due 
to numerical imprecision when computing the inverse geotransform).

I can't understand why you get such wrong values.

Le Friday 31 July 2009 19:56:39 Cassanova, Bill, vous avez ?crit?:
> double adfGeoTransform[6] = { -127, .011571482, 0, 51, 0, -.008993 };
>
> double adfReverseGeoTransform[6] = { 0, 0, 0, 0, 0, 0 };
>
> GDALInvGeoTransform( adfGeoTransform, adfReverseGeoTransform );
>
> double dfPixel = 0;
> double dfLine = 0;
> double x;
> double y;
>
> GDALApplyGeoTransform( ? adfGeoTransform, dfPixel, dfLine, &x, &y );
>
> std::cout << "lat-lon " << x << ", " << y << std::endl;
>
> double new_x;
> double new_y;
>
> GDALApplyGeoTransform( ? adfReverseGeoTransform, x, y, &new_x, &new_y );
>
> std::cout << new_x << ", " << new_y << std::endl;


From even.rouault at mines-paris.org  Fri Jul 31 14:25:36 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri Jul 31 14:25:44 2009
Subject: [gdal-dev] GDAL 1.6.2 RC1 Released
In-Reply-To: <7C011ACC-ADA4-45DB-B9C4-6801973154FC@gmail.com>
References: <FF1C2B46-13CE-4FE0-93DF-2A02F36C05C2@gmail.com>
	<7C011ACC-ADA4-45DB-B9C4-6801973154FC@gmail.com>
Message-ID: <200907312025.36356.even.rouault@mines-paris.org>

Howard,

I'm afraid you will have to make a RC2 : gcore/gdal_version.h hasn't been 
updated.

Even

Le Friday 31 July 2009 16:08:02 Howard Butler, vous avez ?crit?:
> All,
>
> The GDAL team is pleased to announce the release of GDAL 1.6.2 RC1.
>
> * http://download.osgeo.org/gdal/gdal-1.6.2-RC1.tar.gz
> * http://download.osgeo.org/gdal/gdal162-RC1.zip
>
> The following issues were addressed in this release:
>
> General:
>   * OGR expression parser causes access violations with large
> expressions (#2996)
>   * OGR cannot open/handle .DBF files > 2 GB (#3011)
>   * crash in cpl_vsil_win32.cpp when compiling as x64 under Windows
> (#3035)
>   * create index sql execute problem (#3044)
>   * GTiffDataset::FlushCache() cause crashes when used just after
> dataset creation (#3067)
>   * GDALDefaultOverviews::BuildOverviews() causes out-of-bounds writes
> for a 1x1 dataset (#3069)
>   * gdaladdo crashes on a 16-bit dataset when external overviews are
> requested to have JPEG compression (#3070)
>   * Corrupt EXIF info can cause stack buffer overflow in JPEG driver
> (#3078)
>
> GDAL:
>   * GenBin driver problems (#2730)
>   * Additional dependency to libgdal.so added during linking in gdal/
> apps (#2970)
>   * This NITF Can not be opened (endless loop) with recent GDAL (#3001)
>   * This NITF Can not be opened (endless loop) with recent GDAL (#3002)
>   * PPM Driver 16bit Support Byte Order Decision Questionable (#3012)
>   * GDAL changes projection parameter values (#3017)
>   * bad reading of AAIGRID dataset whose last line doesn't have a
> linebreak character (#3022)
>   * HDF5 Subdataset Issue (#3024)
>   * jp2kak driver can't display this unsigned 16 bit J2K image (#3027)
>   * NITF PRJPSB TRE handling wrong for Transverse Mercator (#3029)
>   * gdaladdo not producing correct overviews for greyscale+alpha image
> (#3033)
>   * GDALLoadRPB/IMDFile fails with path (#3047)
>   * Setting stats and histogram to JP2 compressed NITF corrupts the
> aux.xml (#3051)
>   * poBand->SetMetadataItem( "source_0", szFilterSourceXML,
> "vrt_sources" ) not supported as expected (#3052)
>   * gdaladdo fails with JPEG YCBCR when interleaving is not specified
> to be pixel (#3064)
>   * georaster - NLS problem with XML metadata (#3066)
>   * gdalwarp can crash when reprojecting into an irrelevant SRS (#3079)
>
> OGR:
>   * Relax KML driver about xmlns (#3004)
>   * KML driver painfully slow when reading huge geometries (#3005)
>   * PG driver does not recognize 'real' data type (#3006)
>   * X-Plane reader: Bezier curves in Pavement and APTLinefeature not
> curved (#3030)
>
> OGR Spatial References:
>   * Mercator with scale=1 at non-equatoral latitude handled
> improperly. (#3026)
>   * Hotine Oblique Mercator translation to PROJ.4 format looses scale
> factor. (#3032)
>   * Equidistant Conic ESRI Morphing Broken (#3086)
>
> Python:
>   * OGRFeature.SetField segfault (#3000)
>
> .NET:
>   * C# Osr.GetProjectionMethodParameterList / OPTGetParameterList
> Access Violation (#3018)
>   * [PATCH - C#] Dataset.ReadRaster()/WriteRaster() doesn't work on
> multi-band datasets (#3073)
>
>
> If no significant issues are identified, a PSC vote will be called for
> to promote this RC to final on Wednesday or Thursday next week.
>
> Howard
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From even.rouault at mines-paris.org  Fri Jul 31 14:41:47 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri Jul 31 14:42:00 2009
Subject: [gdal-dev] Re: [SoC] GDAL WKTRaster weekly report #9
In-Reply-To: <cb4457700907310904h1a8136e5jaa671e5eb26d0f87@mail.gmail.com>
References: <cb4457700907260323n25c80a6dxae52f5fd2994d051@mail.gmail.com>
	<4A6FDAA7.1020903@pobox.com>
	<cb4457700907310904h1a8136e5jaa671e5eb26d0f87@mail.gmail.com>
Message-ID: <200907312041.48228.even.rouault@mines-paris.org>

Le Friday 31 July 2009 18:04:14 Jorge Ar?valo, vous avez ?crit?:
>
> Yes, it's not commited yet. But, where do you store the overviews? The
> overviews are a kind of datasets exposed via GetOverview method and
> based in the first level dataset, right? So, when I'm creating a
> dataset, I can create overviews as other datasets that are stored in
> an array in the more general dataset. Then, they are like "children
> datasets". Is this point incorrect?

You can have a look at the GTiff driver (but just a quick one as it is an 
horrible complex thing. I don't want you to have an headache ;-)), for an 
example of a driver that support its own overviews, especially 
GTiffRasterBand::GetOverviewCount() and GTiffRasterBand::GetOverview() in 
frmts/gtiff/geotiff.cpp

It works exactly the way you've described : the base dataset has an array of 
children datasets, one for each overview level. It is responsible for 
instanciating them and destroying them in its own destructor.

>
> > Is there any mechanism currently for creating overviews? ?How have
> > you been testing overviews?
>
> gdal2wktraster script is able to construct overview tables, as Mateusz
> said. I tested the code by creating an overview of a dataset (with
> gdal2wktraster script) and reading it with gdalinfo as metadata of
> SUBDATASETS domain. I need more testing at this point, to somehow read
> each overview and maybe store it as out-db raster. I'm not sure on how
> to test it properly.

If you support overviews with the standard GetOverview() mechanism of a raster 
band, you should be able to display them by using any GDAL based viewer 
(qgis, openev) and zooming out the raster by the appropriate factor. Or 
gdal_translate -outsize 50% 50% in_dataset out_ovr_2.tif, will just extract 
the overview of factor 2.

>
> > Under DOUBTs you ask what happens if the bounding box of a block
> > does not match any real block in the table, what should happen. ?In this
> > case IReadBlock() should fill the buffer with the nodata value (zero if
> > nodata is not set).
>
> Ok, understood.
>
> > You also mention a doubt about how to handle the 16BF type, which is
> > apparently "16-bit float". ?I have never seen such a thing before and I'm
> > not sure why it is part of the WKTRaster specification. I would suggest
> > removing it.
> >
> > However, if we wanted to support it (and you could figure out what it
> > actually is), then I think it would be most appropriate to transform it
> > into a 32bit float as it is read in IReadBlock(). ?Presumably the full
> > range of a 16bit float could not be kept in a 16 bit integer.
>
> Actually, now I transform it in a 32bit float
>
> > Likewise, 1BB, 2BUI, and 4BUI values (if supported) should be
> > translated on the fly into GDT_Byte values. ?However, there is a special
> > NBITS metadata item in the IMAGE_STRUCTURE metadata domain that can
> > be set in these cases to represent the special nature of the image data.
> > Likewise there is a special value to indicate signed eight bit integers.
> > These values are discussed in:
> >
> > ?http://trac.osgeo.org/gdal/wiki/rfc14_imagestructure
> >
> > However, I consider implementation of these esoteric types optional given
> > the relatively limited time remaining.
>
> Ok. Added to my todo list.
>
>
> Thanks Frank
>
> Best regards,
> Jorge
>
> > Best regards,
> > --
> > ---------------------------------------+---------------------------------
> >----- I set the clouds in motion - turn up ? | Frank Warmerdam,
> > warmerdam@pobox.com
> > light and sound - activate the windows | http://pobox.com/~warmerdam
> > and watch the world go round - Rush ? ?| Geospatial Programmer for Rent
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From hobu.inc at gmail.com  Fri Jul 31 15:15:05 2009
From: hobu.inc at gmail.com (Howard Butler)
Date: Fri Jul 31 15:23:27 2009
Subject: [gdal-dev] GDAL 1.6.2 RC2 Released (was GDAL 1.6.2 RC1 Released)
In-Reply-To: <200907312025.36356.even.rouault@mines-paris.org>
References: <FF1C2B46-13CE-4FE0-93DF-2A02F36C05C2@gmail.com>
	<7C011ACC-ADA4-45DB-B9C4-6801973154FC@gmail.com>
	<200907312025.36356.even.rouault@mines-paris.org>
Message-ID: <7D142F9C-270D-4904-8FAB-6855E57A358E@gmail.com>

do'h.

* http://download.osgeo.org/gdal/gdal-1.6.2-RC2.tar.gz
* http://download.osgeo.org/gdal/gdal162-RC2.zip


On Jul 31, 2009, at 1:25 PM, Even Rouault wrote:

> Howard,
>
> I'm afraid you will have to make a RC2 : gcore/gdal_version.h hasn't  
> been
> updated.
>
> Even
>
> Le Friday 31 July 2009 16:08:02 Howard Butler, vous avez ?crit :
>> All,
>>
>> The GDAL team is pleased to announce the release of GDAL 1.6.2 RC1.
>>
>> * http://download.osgeo.org/gdal/gdal-1.6.2-RC1.tar.gz
>> * http://download.osgeo.org/gdal/gdal162-RC1.zip
>>
>> The following issues were addressed in this release:
>>
>> General:
>>  * OGR expression parser causes access violations with large
>> expressions (#2996)
>>  * OGR cannot open/handle .DBF files > 2 GB (#3011)
>>  * crash in cpl_vsil_win32.cpp when compiling as x64 under Windows
>> (#3035)
>>  * create index sql execute problem (#3044)
>>  * GTiffDataset::FlushCache() cause crashes when used just after
>> dataset creation (#3067)
>>  * GDALDefaultOverviews::BuildOverviews() causes out-of-bounds writes
>> for a 1x1 dataset (#3069)
>>  * gdaladdo crashes on a 16-bit dataset when external overviews are
>> requested to have JPEG compression (#3070)
>>  * Corrupt EXIF info can cause stack buffer overflow in JPEG driver
>> (#3078)
>>
>> GDAL:
>>  * GenBin driver problems (#2730)
>>  * Additional dependency to libgdal.so added during linking in gdal/
>> apps (#2970)
>>  * This NITF Can not be opened (endless loop) with recent GDAL  
>> (#3001)
>>  * This NITF Can not be opened (endless loop) with recent GDAL  
>> (#3002)
>>  * PPM Driver 16bit Support Byte Order Decision Questionable (#3012)
>>  * GDAL changes projection parameter values (#3017)
>>  * bad reading of AAIGRID dataset whose last line doesn't have a
>> linebreak character (#3022)
>>  * HDF5 Subdataset Issue (#3024)
>>  * jp2kak driver can't display this unsigned 16 bit J2K image (#3027)
>>  * NITF PRJPSB TRE handling wrong for Transverse Mercator (#3029)
>>  * gdaladdo not producing correct overviews for greyscale+alpha image
>> (#3033)
>>  * GDALLoadRPB/IMDFile fails with path (#3047)
>>  * Setting stats and histogram to JP2 compressed NITF corrupts the
>> aux.xml (#3051)
>>  * poBand->SetMetadataItem( "source_0", szFilterSourceXML,
>> "vrt_sources" ) not supported as expected (#3052)
>>  * gdaladdo fails with JPEG YCBCR when interleaving is not specified
>> to be pixel (#3064)
>>  * georaster - NLS problem with XML metadata (#3066)
>>  * gdalwarp can crash when reprojecting into an irrelevant SRS  
>> (#3079)
>>
>> OGR:
>>  * Relax KML driver about xmlns (#3004)
>>  * KML driver painfully slow when reading huge geometries (#3005)
>>  * PG driver does not recognize 'real' data type (#3006)
>>  * X-Plane reader: Bezier curves in Pavement and APTLinefeature not
>> curved (#3030)
>>
>> OGR Spatial References:
>>  * Mercator with scale=1 at non-equatoral latitude handled
>> improperly. (#3026)
>>  * Hotine Oblique Mercator translation to PROJ.4 format looses scale
>> factor. (#3032)
>>  * Equidistant Conic ESRI Morphing Broken (#3086)
>>
>> Python:
>>  * OGRFeature.SetField segfault (#3000)
>>
>> .NET:
>>  * C# Osr.GetProjectionMethodParameterList / OPTGetParameterList
>> Access Violation (#3018)
>>  * [PATCH - C#] Dataset.ReadRaster()/WriteRaster() doesn't work on
>> multi-band datasets (#3073)
>>
>>
>> If no significant issues are identified, a PSC vote will be called  
>> for
>> to promote this RC to final on Wednesday or Thursday next week.
>>
>> Howard
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>

From belaid_moa at hotmail.com  Fri Jul 31 16:04:23 2009
From: belaid_moa at hotmail.com (Belaid MOA)
Date: Fri Jul 31 16:04:26 2009
Subject: [gdal-dev] Help understanding GDALApplyGeoTransform and
	GDALInvGeoTransform
In-Reply-To: <200907312020.48254.even.rouault@mines-paris.org>
References: <1D5F4E64B8C04F4C868B94AC9A532AF80AD0636A@ATLMAIL01.corp.weather.com>
	<200907312020.48254.even.rouault@mines-paris.org>
Message-ID: <COL113-W1186D79C194859AECD2AF1F4100@phx.gbl>


Just out of curiosity, I ran your code on my machine and I got exactly the same results as Even.
I do not think that Endianity will cause such wrong results. Are you sure you are not changing the values
of new_x and new_y before printing them out?

~Belaid.

> From: even.rouault@mines-paris.org
> To: gdal-dev@lists.osgeo.org
> Subject: Re: [gdal-dev] Help understanding GDALApplyGeoTransform and	GDALInvGeoTransform
> Date: Fri, 31 Jul 2009 20:20:46 +0200
> CC: BCassanova@weather.com
> 
> Bill,
> 
> that's weird. Your code looks correct and I've just compiled it and I get the 
> following results :
> 
> lat-lon -127, 51
> 7.24754e-13, 4.12115e-13
> 
> The new_x, new_y values are almost 0 as expected (the small difference is due 
> to numerical imprecision when computing the inverse geotransform).
> 
> I can't understand why you get such wrong values.
> 
> Le Friday 31 July 2009 19:56:39 Cassanova, Bill, vous avez ?crit :
> > double adfGeoTransform[6] = { -127, .011571482, 0, 51, 0, -.008993 };
> >
> > double adfReverseGeoTransform[6] = { 0, 0, 0, 0, 0, 0 };
> >
> > GDALInvGeoTransform( adfGeoTransform, adfReverseGeoTransform );
> >
> > double dfPixel = 0;
> > double dfLine = 0;
> > double x;
> > double y;
> >
> > GDALApplyGeoTransform(   adfGeoTransform, dfPixel, dfLine, &x, &y );
> >
> > std::cout << "lat-lon " << x << ", " << y << std::endl;
> >
> > double new_x;
> > double new_y;
> >
> > GDALApplyGeoTransform(   adfReverseGeoTransform, x, y, &new_x, &new_y );
> >
> > std::cout << new_x << ", " << new_y << std::endl;
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

_________________________________________________________________
More storage. Better anti-spam and antivirus protection. Hotmail makes it simple.
http://go.microsoft.com/?linkid=9671357
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090731/bc03c663/attachment.html
From BCassanova at weather.com  Fri Jul 31 16:11:47 2009
From: BCassanova at weather.com (Cassanova, Bill)
Date: Fri Jul 31 16:12:29 2009
Subject: [gdal-dev] Help understanding GDALApplyGeoTransform
	andGDALInvGeoTransform
In-Reply-To: <COL113-W1186D79C194859AECD2AF1F4100@phx.gbl>
References: <1D5F4E64B8C04F4C868B94AC9A532AF80AD0636A@ATLMAIL01.corp.weather.com><200907312020.48254.even.rouault@mines-paris.org>
	<COL113-W1186D79C194859AECD2AF1F4100@phx.gbl>
Message-ID: <1D5F4E64B8C04F4C868B94AC9A532AF80AD06422@ATLMAIL01.corp.weather.com>

I must have been doing something like that.  I got frustrated and started from scratch and am now getting the correct results.

 

Thank you guys help immensely.  GDAL is great but the learning curve is a bit steep at times.

 

From: gdal-dev-bounces@lists.osgeo.org [mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Belaid MOA
Sent: Friday, July 31, 2009 4:04 PM
To: gdal-dev@lists.osgeo.org
Subject: RE: [gdal-dev] Help understanding GDALApplyGeoTransform andGDALInvGeoTransform

 

Just out of curiosity, I ran your code on my machine and I got exactly the same results as Even.
I do not think that Endianity will cause such wrong results. Are you sure you are not changing the values
of new_x and new_y before printing them out?

~Belaid.

> From: even.rouault@mines-paris.org
> To: gdal-dev@lists.osgeo.org
> Subject: Re: [gdal-dev] Help understanding GDALApplyGeoTransform and GDALInvGeoTransform
> Date: Fri, 31 Jul 2009 20:20:46 +0200
> CC: BCassanova@weather.com
> 
> Bill,
> 
> that's weird. Your code looks correct and I've just compiled it and I get the 
> following results :
> 
> lat-lon -127, 51
> 7.24754e-13, 4.12115e-13
> 
> The new_x, new_y values are almost 0 as expected (the small difference is due 
> to numerical imprecision when computing the inverse geotransform).
> 
> I can't understand why you get such wrong values.
> 
> Le Friday 31 July 2009 19:56:39 Cassanova, Bill, vous avez ?crit :
> > double adfGeoTransform[6] = { -127, .011571482, 0, 51, 0, -.008993 };
> >
> > double adfReverseGeoTransform[6] = { 0, 0, 0, 0, 0, 0 };
> >
> > GDALInvGeoTransform( adfGeoTransform, adfReverseGeoTransform );
> >
> > double dfPixel = 0;
> > double dfLine = 0;
> > double x;
> > double y;
> >
> > GDALApplyGeoTransform(   adfGeoTransform, dfPixel, dfLine, &x, &y );
> >
> > std::cout << "lat-lon " << x << ", " << y << std::endl;
> >
> > double new_x;
> > double new_y;
> >
> > GDALApplyGeoTransform(   adfReverseGeoTransform, x, y, &new_x, &new_y );
> >
> > std::cout << new_x << ", " << new_y << std::endl;
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

________________________________

More storage. Better anti-spam and antivirus protection. Hotmail makes it simple. <http://go.microsoft.com/?linkid=9671352> 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090731/1e5e098c/attachment.html
From warmerdam at pobox.com  Fri Jul 31 16:56:34 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Jul 31 16:56:30 2009
Subject: [gdal-dev] OGR OCI Driver improvement
In-Reply-To: <8C7DAE7B21100F4CABDD600FAAD339D003C4B60F@DGA-EXC01.mrw.wallonie.int>
References: <8C7DAE7B21100F4CABDD600FAAD339D003C4B60F@DGA-EXC01.mrw.wallonie.int>
Message-ID: <4A735A82.1050906@pobox.com>

Nicolas Simon wrote:
> Franck,
> 
> 	I'm interested in becoming a longer term contributor for the OCI driver.
> 	
> 	What format do you prefer for fixes ?  Patch format against main trunk ?

Nicolas,

An "svn diff" patch against trunk is the most convenient form for
patches.

> 	I 'll also provide test to demonstrate the problem and the fix.
> 
> 	Is there a standard way to provide test suite ?

There is a standard form for test suite entries, but for the
purposes of demonstrating things I'm flexible.  The test suite
is in Python so if you needed to script a demonstration doing
it in Python would be convenient.

FYI, the existing oracle suite suite script is at:

  	http://svn.osgeo.org/gdal/trunk/autotest/ogr/ogr_oci.py

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

