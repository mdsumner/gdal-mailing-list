From andre+joost at nurfuerspam.de  Fri Sep  1 10:35:34 2017
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Fri, 01 Sep 2017 19:35:34 +0200
Subject: [gdal-dev] Which Proj.4 transforms are available in GDAL?
In-Reply-To: <9459999.8dFvGKNm6J@even-i700>
References: <op.y5hrr20edbaoe8@macmarilu> <9459999.8dFvGKNm6J@even-i700>
Message-ID: <ooc5qs$h8n$1@blaine.gmane.org>

Am 25.08.2017 um 13:52 schrieb Even Rouault:

>
> For unsupported projections, add +wktext. A dummy WKT representation
> is then built that captures the full proj.4 string in a EXTENSION
> node. Can also serve for supported projections if you want to
> overrite the WKT -> proj.4 string conversion done by GDAL
>

This seems to work arbitrary.

gdalwarp -overwrite -dstnodata 0 -s_srs EPSG:3857 -t_srs "+proj=lcc 
+lat_1=13.31666666666667 +lat_2=14.25 +lat_0=13.783333 +lon_0=-89 
+x_0=500000 +y_0=295809.184 +k_0=0.99996704 +ellps=clrk66 +units=m 
+no_defs +towgs84=0,125,194,0,0,0,0 +wktext" -of GTiff ElSalvador.png 
ElSalvadorNAD27.tif
gdalsrsinfo ElSalvadorNAD27.tif >out.txt

does not add an EXTENSION to the WKT, but preserves the TOWGS84 values


ogr2ogr -s_srs EPSG:4326 -t_srs "+proj=lcc +lat_1=13.31666666666667 
+lat_2=14.25 +lat_0=13.783333 +lon_0=-89 +x_0=500000 +y_0=295809.184 
+k_0=0.99996704 +ellps=clrk66 +units=m +no_defs 
+towgs84=0,125,194,0,0,0,0 +wktext" LimitesNAD27.shp dptoA_WGS_1984.shp
gdalsrsinfo LimitesNAD27.prj >>out.txt

neither saves towgs84 or wktext

gdalsrsinfo "+proj=lcc +lat_1=13.31666666666667 +lat_2=14.25 
+lat_0=13.783333 +lon_0=-89 +x_0=500000 +y_0=295809.184 +k_0=0.99996704 
+ellps=clrk66 +units=m +no_defs +towgs84=0,125,194,0,0,0,0 +wktext"

adds TOWGS84 and EXTENSION.

Tested with GDAL 2.2.1

Perhaps you like to comment on 
https://gis.stackexchange.com/questions/253475/results-of-layers-created-with-a-custom-crs-are-loaded-with-a-generated-crs-in-q 
(with links to data).

Still confused,
André Joost


From even.rouault at spatialys.com  Fri Sep  1 11:14:33 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 01 Sep 2017 20:14:33 +0200
Subject: [gdal-dev] Which Proj.4 transforms are available in GDAL?
In-Reply-To: <ooc5qs$h8n$1@blaine.gmane.org>
References: <op.y5hrr20edbaoe8@macmarilu> <9459999.8dFvGKNm6J@even-i700>
 <ooc5qs$h8n$1@blaine.gmane.org>
Message-ID: <2994063.mpUTl4cJWF@even-i700>

> This seems to work arbitrary.

Not really. GDAL is an abstraction of a lot of imperfections, so losses can happen for various 
(more or less well documented) reasons each time you export & import.

> 
> gdalwarp -overwrite -dstnodata 0 -s_srs EPSG:3857 -t_srs "+proj=lcc
> +lat_1=13.31666666666667 +lat_2=14.25 +lat_0=13.783333 +lon_0=-89
> +x_0=500000 +y_0=295809.184 +k_0=0.99996704 +ellps=clrk66 +units=m
> +no_defs +towgs84=0,125,194,0,0,0,0 +wktext" -of GTiff ElSalvador.png
> ElSalvadorNAD27.tif
> gdalsrsinfo ElSalvadorNAD27.tif >out.txt
> 
> does not add an EXTENSION to the WKT, but preserves the TOWGS84 values
> 

Yes, the GeoTIFF format isn't WKT based. So the GDAL WKT representation gets translated as 
best as possible into GeoTIFF keys, which don't support EXTENSION. TOWGS84 was added as 
an extra GeoTIFF key a few years ago by Frank, although not part of the original GeoTIFF 
specification.

> 
> ogr2ogr -s_srs EPSG:4326 -t_srs "+proj=lcc +lat_1=13.31666666666667
> +lat_2=14.25 +lat_0=13.783333 +lon_0=-89 +x_0=500000 +y_0=295809.184
> +k_0=0.99996704 +ellps=clrk66 +units=m +no_defs
> +towgs84=0,125,194,0,0,0,0 +wktext" LimitesNAD27.shp dptoA_WGS_1984.shp
> gdalsrsinfo LimitesNAD27.prj >>out.txt
> 
> neither saves towgs84 or wktext

Yes, a .prj file contains a ESRI flavour of WKT, which supports neither TOWGS84 or 
EXTENSION, so they get stripped.

> 
> gdalsrsinfo "+proj=lcc +lat_1=13.31666666666667 +lat_2=14.25
> +lat_0=13.783333 +lon_0=-89 +x_0=500000 +y_0=295809.184 +k_0=0.99996704
> +ellps=clrk66 +units=m +no_defs +towgs84=0,125,194,0,0,0,0 +wktext"
> 
> adds TOWGS84 and EXTENSION.

Yes, you completely stay in GDAL realm here without import/export issues

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170901/5c8cba84/attachment.html>

From andre+joost at nurfuerspam.de  Fri Sep  1 11:42:34 2017
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Fri, 01 Sep 2017 20:42:34 +0200
Subject: [gdal-dev] Which Proj.4 transforms are available in GDAL?
In-Reply-To: <2994063.mpUTl4cJWF@even-i700>
References: <op.y5hrr20edbaoe8@macmarilu> <9459999.8dFvGKNm6J@even-i700>
 <ooc5qs$h8n$1@blaine.gmane.org> <2994063.mpUTl4cJWF@even-i700>
Message-ID: <ooc9p5$rpf$1@blaine.gmane.org>

Am 01.09.2017 um 20:14 schrieb Even Rouault:

>
>>
>> ogr2ogr -s_srs EPSG:4326 -t_srs "+proj=lcc +lat_1=13.31666666666667
>> +lat_2=14.25 +lat_0=13.783333 +lon_0=-89 +x_0=500000 +y_0=295809.184
>> +k_0=0.99996704 +ellps=clrk66 +units=m +no_defs
>> +towgs84=0,125,194,0,0,0,0 +wktext" LimitesNAD27.shp dptoA_WGS_1984.shp
>> gdalsrsinfo LimitesNAD27.prj >>out.txt
>>
>> neither saves towgs84 or wktext
>
> Yes, a .prj file contains a ESRI flavour of WKT, which supports neither TOWGS84 or
> EXTENSION, so they get stripped.
>

So how is a datum shift outside of the EPSG code world supposed to be 
applied to a shapefile with ogr2ogr?

Greetings,
André Joost



From even.rouault at spatialys.com  Fri Sep  1 12:05:04 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 01 Sep 2017 21:05:04 +0200
Subject: [gdal-dev] Which Proj.4 transforms are available in GDAL?
In-Reply-To: <ooc9p5$rpf$1@blaine.gmane.org>
References: <op.y5hrr20edbaoe8@macmarilu> <2994063.mpUTl4cJWF@even-i700>
 <ooc9p5$rpf$1@blaine.gmane.org>
Message-ID: <2832921.s9oqiVVp4L@even-i700>

On vendredi 1 septembre 2017 20:42:34 CEST Andre Joost wrote:
> Am 01.09.2017 um 20:14 schrieb Even Rouault:
> >> ogr2ogr -s_srs EPSG:4326 -t_srs "+proj=lcc +lat_1=13.31666666666667
> >> +lat_2=14.25 +lat_0=13.783333 +lon_0=-89 +x_0=500000 +y_0=295809.184
> >> +k_0=0.99996704 +ellps=clrk66 +units=m +no_defs
> >> +towgs84=0,125,194,0,0,0,0 +wktext" LimitesNAD27.shp dptoA_WGS_1984.shp
> >> gdalsrsinfo LimitesNAD27.prj >>out.txt
> >> 
> >> neither saves towgs84 or wktext
> > 
> > Yes, a .prj file contains a ESRI flavour of WKT, which supports neither
> > TOWGS84 or EXTENSION, so they get stripped.
> 

And more importantly the original EPSG code is also missing in ESRI WKT.

> So how is a datum shift outside of the EPSG code world supposed to be
> applied to a shapefile with ogr2ogr?

You have to override the source SRS with -s_srs EPSG:XXXX if you know the code. One could 
potentially improve the situation by trying to match the .prj CRS name with the entries in the 
EPSG database to try recovering which code the ESRI WKT corresponds too (if there's a 
match)

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170901/7c1f45bd/attachment.html>

From andre+joost at nurfuerspam.de  Sat Sep  2 09:04:06 2017
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Sat, 02 Sep 2017 18:04:06 +0200
Subject: [gdal-dev] Adding missing EPSG codes to PROJ.4 and GDAL
Message-ID: <ooekt1$tfv$1@blaine.gmane.org>

Dear all,

I have recently compared the downloadable SQL files of the EPSG database 
(v9.1) with the output of gdalsrsinfo (v2.2.1). There are currently 368 
CRS_codes missing, and I would like to have them reduced.

You can find a csv list at 
https://github.com/Andre-J/EPSG/blob/master/missing_epsg.csv

Some CRS might fail due to exotic projection definitions, but there are 
also several transverse mercator based projections, which should be 
integrateable into PROJ.4 and GDAL.

Has there anybody worked lately on integrating them, and what would be 
the safest way to do that without them getting kicked out with the next 
EPSG database update?. And where should doubts be discussed: on the 
Proj.4 mailing list, the gdal-dev mailing list or as Github issues?

There are a number of Colombian MAGNA-SIRGAS local grids, based on a 
projection plane *above* the ellipsoid (unfortunately different for 
every grid). This is similiar to the (now deprecated) NAD27 Michigan 
based CRS EPSG:26811, 26812 and 26813. The solution there was to create 
a new ellipsoid (EPSG:4268) with a and b increased by the projection 
plane heigt above ellipsoid. This could be applied to the MAGNA SIRGAS 
local grids as well, but would possibly need the creation of Geografic 
CRS (without a EPSG code) for each case.

The list also contains a number of "NAD83(HARN) / WISCRS" for Wisconsin 
counties. I wonder why those got dropped, while the "NAD83(2011) / 
WISCRS" codes for the same counties are included.

Greetings,
André Joost


From even.rouault at spatialys.com  Sat Sep  2 11:31:08 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 02 Sep 2017 20:31:08 +0200
Subject: [gdal-dev] Adding missing EPSG codes to PROJ.4 and GDAL
In-Reply-To: <ooekt1$tfv$1@blaine.gmane.org>
References: <ooekt1$tfv$1@blaine.gmane.org>
Message-ID: <2610448.U2XOFVNane@even-i700>

Hi,

> 
> I have recently compared the downloadable SQL files of the EPSG database
> (v9.1) with the output of gdalsrsinfo (v2.2.1). There are currently 368
> CRS_codes missing, and I would like to have them reduced.
> 
> You can find a csv list at
> https://github.com/Andre-J/EPSG/blob/master/missing_epsg.csv
> 
> Some CRS might fail due to exotic projection definitions, but there are
> also several transverse mercator based projections, which should be
> integrateable into PROJ.4 and GDAL.
> 
> Has there anybody worked lately on integrating them, and what would be
> the safest way to do that without them getting kicked out with the next
> EPSG database update?.

The procedure to integrate a new EPSG database in libgeotiff ==> GDAL ==> proj.4 + PostGIS 
is described at:
https://trac.osgeo.org/geotiff/browser/trunk/libgeotiff/csv/README

If not done by anyone else, I generally run it a couple of months before each GDAL major 
release to avoid doing it too often.

> And where should doubts be discussed: on the
> Proj.4 mailing list, the gdal-dev mailing list or as Github issues?

Depends on the issue... Technically if it is an issue in the initial python import script, should be 
in geotiff Trac. If it is an issue in the GDAL epsg_tr.py script / importFromEPSG() / missing 
mapping from a method, then in GDAL. If it is missing support for a projection in proj.4, in 
proj github issues.

> 
> There are a number of Colombian MAGNA-SIRGAS local grids, based on a
> projection plane *above* the ellipsoid (unfortunately different for
> every grid). This is similiar to the (now deprecated) NAD27 Michigan
> based CRS EPSG:26811, 26812 and 26813. The solution there was to create
> a new ellipsoid (EPSG:4268) with a and b increased by the projection
> plane heigt above ellipsoid. This could be applied to the MAGNA SIRGAS
> local grids as well, but would possibly need the creation of Geografic
> CRS (without a EPSG code) for each case.

It isn't obvious to me that the trick you describe above can be reused for those grids, but 
they will indeed require code additions in proj.4 and GDAL. Looking at
https://www.epsg-registry.org/export.htm?wkt=urn:ogc:def:crs:EPSG::6244
and
https://www.epsg-registry.org/export.htm?wkt=urn:ogc:def:crs:EPSG::6245
use a "Colombia Urban" projection method that isn't AFAIK currently handled by proj.4 and 
GDAL.

This Columbian Urban projection is described in paragraph 1.3.19 of
http://www.epsg.org/Portals/0/373-07-2.pdf , so could be served as the base to add support 
for it in proj.4

> 
> The list also contains a number of "NAD83(HARN) / WISCRS" for Wisconsin
> counties. I wonder why those got dropped, while the "NAD83(2011) /
> WISCRS" codes for the same counties are included.

They didn't get dropped. As far as I can see they are new in EPSG v9.1. "http://www.epsg.org/
EPSGDataset/WhatIsNew.aspx" : "New data for ... United States (AZ and WI)"

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170902/f9278b61/attachment.html>

From szekerest at gmail.com  Mon Sep  4 23:25:10 2017
From: szekerest at gmail.com (Tamas Szekeres)
Date: Tue, 5 Sep 2017 08:25:10 +0200
Subject: [gdal-dev] Call for discussion on RFC68: C++11 compilation mode
In-Reply-To: <82F0A4A3-A633-4CAA-BC86-56670D0A8289@gmail.com>
References: <CACmBxysbymV6N6p4updUoW3bmLaM80gqGY0AFj5-HRZbnoEHdw@mail.gmail.com>
 <22451425.pbmFVvQ3Z5@even-i700>
 <82F0A4A3-A633-4CAA-BC86-56670D0A8289@gmail.com>
Message-ID: <CACALY+QFw97ANrRx2eRHBqvxwvR29LoBi0t9xpFQS=zSuM3XNA@mail.gmail.com>

Hi Even,

The new SDK-s have now been added.

Best regards,

Tamas


2017-08-29 15:18 GMT+02:00 Tamas Szekeres <szekerest at gmail.com>:

> Hi Even,
>
> Yes, I'm planning to include msvc2015/2017 versions shortly.
>
> Best regards,
> Tamas
>
> Sent from my iPhone
>
> 2017. aug. 14. dátummal, 19:02 időpontban Even Rouault <
> even.rouault at spatialys.com> írta:
>
> > Hi Tamas,
> >
> > Unless I'm mistaken your gisinternals.com builds don't include MSVC
> 2015 currently. Right ? Do you have any plans to do so ? Currently the GDAL
> AppVeyor target uses SDKSs from gisinternals to do builds with a number of
> third-party libraries.
> >
> > Even
> >
> > >
> > > This is a call for discussion on RFC68 to set C++11 to be the minimum
> C++
> > > language version for GDAL trunk. I've drafted the RFC based on work by
> > > Mateusz.
> > >
> > > https://trac.osgeo.org/gdal/wiki/rfc68_cplusplus11
> > >
> > > There was initial discussions back in January of this year:
> > >
> > > https://lists.osgeo.org/pipermail/gdal-dev/2017-
> January/thread.html#45786
> > >
> > > Cheers,
> > > -kurt
> > > Engineer at Google
> >
> >
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170905/54ce6d6d/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Tue Sep  5 01:44:23 2017
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Tue, 5 Sep 2017 08:44:23 +0000
Subject: [gdal-dev] Tilesize in JPEG2000 and gdalinfo
Message-ID: <38ca7bbb3a924f1283e3fef1a70fdbe8@C119S212VM042.msvyvi.vaha.local>

Hi,

If I run gdalinfo against the JPEG2000 image in http://kartat.kapsi.fi/files/orto/etrs-tm35fin/mara_v_25000_50/2013/N53/02m/1/N5144H.jp2
the JP2ECW driver reports the blocksize as (256x256) and JPEG2000OpenJPEG driver reports that the block size is (1024x1024).

What interests me would be to know the fact that this image has only one JPEG2000 tile with a tilesize of (11754x11754). Is there any driver-independent way for getting this information?

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170905/31a35deb/attachment.html>

From even.rouault at spatialys.com  Tue Sep  5 02:09:27 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 05 Sep 2017 11:09:27 +0200
Subject: [gdal-dev] Tilesize in JPEG2000 and gdalinfo
In-Reply-To: <38ca7bbb3a924f1283e3fef1a70fdbe8@C119S212VM042.msvyvi.vaha.local>
References: <38ca7bbb3a924f1283e3fef1a70fdbe8@C119S212VM042.msvyvi.vaha.local>
Message-ID: <1995703.2jcGRzDoQW@even-i700>

Hi Jukka,

> 
> If I run gdalinfo against the JPEG2000 image in
> http://kartat.kapsi.fi/files/orto/etrs-tm35fin/mara_v_25000_50/2013/N53/02m
> /1/N5144H.jp2 the JP2ECW driver reports the blocksize as (256x256) and
> JPEG2000OpenJPEG driver reports that the block size is (1024x1024).

Yes for single tiled images, all JPEG2000 drivers will report a block size
of much smaller dimension to avoid GDAL consuming too much memory.

> 
> What interests me would be to know the fact that this image has only one
> JPEG2000 tile with a tilesize of (11754x11754). Is there any
> driver-independent way for getting this information?

You can use the opj_dump utility from openjpeg, or a GDAL Python script
https://svn.osgeo.org/gdal/trunk/gdal/swig/python/samples/dump_jp2.py

$ python swig/python/samples/dump_jp2.py /vsicurl/http://kartat.kapsi.fi/files/orto/etrs-tm35fin/mara_v_25000_50/2013/N53/02m/1/N5144H.jp2 | grep "siz\""

        <Field name="Rsiz" type="uint16" description="Unrestricted profile">0</Field>
        <Field name="Xsiz" type="uint32">11754</Field>     <-- image width
        <Field name="Ysiz" type="uint32">11754</Field>     <-- image height
        <Field name="XOsiz" type="uint32">0</Field>
        <Field name="YOsiz" type="uint32">0</Field>
        <Field name="XTsiz" type="uint32">11754</Field>    <-- tile width
        <Field name="YTsiz" type="uint32">11754</Field>    <-- tile height
        <Field name="Csiz" type="uint16">3</Field>


Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170905/4bf08208/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Tue Sep  5 02:20:14 2017
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Tue, 5 Sep 2017 09:20:14 +0000
Subject: [gdal-dev] Tilesize in JPEG2000 and gdalinfo
Message-ID: <c49bcdafa2df41c5a68098644a901508@C119S212VM042.msvyvi.vaha.local>

Thanks, Even.

This information may be less interesting once we have a released OpenJPEG driver that can handle big tiles properly.
The reason for my question was this error message that I got from my colleague who is cutting excerpts from a big VRT


Input file size is 1332094, 2304162

0...10...20...30...ERROR 1: Cannot decode tile, memory error



ERROR 1: opj_decode() failed

ERROR 1:

/vsicurl/http://kartat.kapsi.fi/files/orto/etrs-tm35fin/mara_v_25000_50/2013/N53/02m/1/N5144H.jp2,

band 1: IReadBlock failed at X offset 0, Y offset 0: opj_decode() failed

My guess is that error is due to this single tiled image.  Most JPEG2000 images in the VRT are written with tilesize 1024x1024.

-Jukka-


Lähettäjä: Even Rouault [mailto:even.rouault at spatialys.com]
Lähetetty: 5. syyskuuta 2017 12:09
Vastaanottaja: gdal-dev at lists.osgeo.org
Kopio: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Aihe: Re: [gdal-dev] Tilesize in JPEG2000 and gdalinfo


Hi Jukka,



>

> If I run gdalinfo against the JPEG2000 image in

> http://kartat.kapsi.fi/files/orto/etrs-tm35fin/mara_v_25000_50/2013/N53/02m

> /1/N5144H.jp2 the JP2ECW driver reports the blocksize as (256x256) and

> JPEG2000OpenJPEG driver reports that the block size is (1024x1024).



Yes for single tiled images, all JPEG2000 drivers will report a block size

of much smaller dimension to avoid GDAL consuming too much memory.



>

> What interests me would be to know the fact that this image has only one

> JPEG2000 tile with a tilesize of (11754x11754). Is there any

> driver-independent way for getting this information?



You can use the opj_dump utility from openjpeg, or a GDAL Python script

https://svn.osgeo.org/gdal/trunk/gdal/swig/python/samples/dump_jp2.py



$ python swig/python/samples/dump_jp2.py /vsicurl/http://kartat.kapsi.fi/files/orto/etrs-tm35fin/mara_v_25000_50/2013/N53/02m/1/N5144H.jp2 | grep "siz\""



<Field name="Rsiz" type="uint16" description="Unrestricted profile">0</Field>

<Field name="Xsiz" type="uint32">11754</Field> <-- image width

<Field name="Ysiz" type="uint32">11754</Field> <-- image height

<Field name="XOsiz" type="uint32">0</Field>

<Field name="YOsiz" type="uint32">0</Field>

<Field name="XTsiz" type="uint32">11754</Field> <-- tile width

<Field name="YTsiz" type="uint32">11754</Field> <-- tile height

<Field name="Csiz" type="uint16">3</Field>





Even



--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170905/6b818812/attachment-0001.html>

From even.rouault at spatialys.com  Tue Sep  5 02:44:40 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 05 Sep 2017 11:44:40 +0200
Subject: [gdal-dev] Tilesize in JPEG2000 and gdalinfo
In-Reply-To: <c49bcdafa2df41c5a68098644a901508@C119S212VM042.msvyvi.vaha.local>
References: <c49bcdafa2df41c5a68098644a901508@C119S212VM042.msvyvi.vaha.local>
Message-ID: <1740707.vX5XZl8iuF@even-i700>

On mardi 5 septembre 2017 09:20:14 CEST Rahkonen Jukka (MML) wrote:
> This information may be less interesting once we have a released OpenJPEG
> driver that can handle big tiles properly.

Agreed. Sub-tile decoding with much more efficient RAM use is now implemented per
https://github.com/uclouvain/openjpeg/pull/1010 . It is currently under review
and should hopefully be merged into openjpeg master soon. A openjpeg 2.2.1 release
with it should follow. I'll keep the list informed.

In your use case, I see the image has RPCL progression order, which is, in theory,
not so bad for efficient sub-window decoding when using network access (PCRL would
probably be better here if doing only partial decoding at full resolution. RPCL allows
for efficient sub-resolution decoding), but currently openjpeg ingests the whole
codestream for the tiles it must decode totally or partially, so I/O wise,
in a network context, this is not friendly for big single tiled images. I know some
people would be interested in improving this. We'll see.

With openjpeg + above mentionned pull request 1010, I tested

gdal_translate /vsicurl/http://kartat.kapsi.fi/files/orto/etrs-tm35fin/mara_v_25000_50/2013/N53/02m/1/N5144H.jp2 out.tif -srcwin 0 0 1024 1024

Took 1m42 in total, for just 4s of CPU time. So mostly the download time of 150 MB

If you remove the /vsicurl/ prefix, then the image is completely downloaded in a single HTTP
GET request (through the intermediate HTTP driver), which enables generally better throughput
if you know that at the end the file will be entirely downloaded (so only for single
tiled images). Note that this will consume 2 times the file size of RAM (once by the HTTP driver,
and once by openjpeg)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170905/2191ee04/attachment.html>

From even.rouault at spatialys.com  Tue Sep  5 02:46:39 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 05 Sep 2017 11:46:39 +0200
Subject: [gdal-dev] Call for discussion on RFC68: C++11 compilation mode
In-Reply-To: <CACALY+QFw97ANrRx2eRHBqvxwvR29LoBi0t9xpFQS=zSuM3XNA@mail.gmail.com>
References: <CACmBxysbymV6N6p4updUoW3bmLaM80gqGY0AFj5-HRZbnoEHdw@mail.gmail.com>
 <82F0A4A3-A633-4CAA-BC86-56670D0A8289@gmail.com>
 <CACALY+QFw97ANrRx2eRHBqvxwvR29LoBi0t9xpFQS=zSuM3XNA@mail.gmail.com>
Message-ID: <1717444.ZvXW0L2XkC@even-i700>

Hi Tamas,

this is great! Thanks

Even

> Hi Even,
> 
> The new SDK-s have now been added.
> 
> Best regards,
> 
> Tamas
> 
> 2017-08-29 15:18 GMT+02:00 Tamas Szekeres <szekerest at gmail.com>:
> > Hi Even,
> > 
> > Yes, I'm planning to include msvc2015/2017 versions shortly.
> > 
> > Best regards,
> > Tamas
> > 
> > Sent from my iPhone
> > 
> > 2017. aug. 14. dátummal, 19:02 időpontban Even Rouault <
> > 
> > even.rouault at spatialys.com> írta:
> > > Hi Tamas,
> > > 
> > > Unless I'm mistaken your gisinternals.com builds don't include MSVC
> > 
> > 2015 currently. Right ? Do you have any plans to do so ? Currently the
> > GDAL
> > AppVeyor target uses SDKSs from gisinternals to do builds with a number of
> > third-party libraries.
> > 
> > > Even
> > > 
> > > > This is a call for discussion on RFC68 to set C++11 to be the minimum
> > 
> > C++
> > 
> > > > language version for GDAL trunk. I've drafted the RFC based on work by
> > > > Mateusz.
> > > > 
> > > > https://trac.osgeo.org/gdal/wiki/rfc68_cplusplus11
> > > > 
> > > > There was initial discussions back in January of this year:
> > > > 
> > > > https://lists.osgeo.org/pipermail/gdal-dev/2017-> > 
> > January/thread.html#45786
> > 
> > > > Cheers,
> > > > -kurt
> > > > Engineer at Google
> > > 
> > > --
> > > Spatialys - Geospatial professional services
> > > http://www.spatialys.com


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170905/84a18304/attachment.html>

From andrew.bell.ia at gmail.com  Tue Sep  5 05:02:14 2017
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Tue, 5 Sep 2017 08:02:14 -0400
Subject: [gdal-dev] Return from Set/GetNoDataValue
Message-ID: <CACJ51z3bxRwa0c=K0Smi-9pZhpBBGA=qn6CNzk3b=g1ZjwKFkA@mail.gmail.com>

Perhaps this is a documentation issue, but I ran into:

double BTRasterBand::GetNoDataValue( int* pbSuccess /*= NULL */ )
{
    if(pbSuccess != NULL)
        *pbSuccess = TRUE;

    return -32768;
}

CPLErr BTRasterBand::SetNoDataValue( double )

{
    return CE_None;
}

It seems as if you can't set or fetch a nodata value, an error should be
returned.  In this case, the code indicates no error.  How is one supposed
to know (other than reading the code) that you can't set a value if success
is returned if this operation isn't supported?

Thanks,

-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170905/85eadd31/attachment-0001.html>

From even.rouault at spatialys.com  Tue Sep  5 05:27:33 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 05 Sep 2017 14:27:33 +0200
Subject: [gdal-dev] Return from Set/GetNoDataValue
In-Reply-To: <CACJ51z3bxRwa0c=K0Smi-9pZhpBBGA=qn6CNzk3b=g1ZjwKFkA@mail.gmail.com>
References: <CACJ51z3bxRwa0c=K0Smi-9pZhpBBGA=qn6CNzk3b=g1ZjwKFkA@mail.gmail.com>
Message-ID: <2642438.xQTMEQksJC@even-i700>

Hi Andrew,

> Perhaps this is a documentation issue, 

I think this is mostly an implementation issue in a niche driver. The changeset that 
introduced this ( https://trac.osgeo.org/gdal/changeset/21821 ) isn't very verbose of the 
motivation. I suspect that the intent was to benefit from PAM for a few things, but not 
wanting to generate a .aux.xml file when SetNoDataValue() is called.

I've changed this in https://trac.osgeo.org/gdal/changeset/40003 to use the PAM 
.aux.xml file to laod non-default nodata value on GetNoDataValue(), and write into PAM 
on SetNoDataValue() if the value is different than the default one. Should be a 
reasonable compromise on the presumed original intent.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170905/b9422d11/attachment.html>

From andre+joost at nurfuerspam.de  Tue Sep  5 07:33:40 2017
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Tue, 05 Sep 2017 16:33:40 +0200
Subject: [gdal-dev] Which Proj.4 transforms are available in GDAL?
In-Reply-To: <2832921.s9oqiVVp4L@even-i700>
References: <op.y5hrr20edbaoe8@macmarilu> <2994063.mpUTl4cJWF@even-i700>
 <ooc9p5$rpf$1@blaine.gmane.org> <2832921.s9oqiVVp4L@even-i700>
Message-ID: <oomclm$mbc$1@blaine.gmane.org>

Am 01.09.2017 um 21:05 schrieb Even Rouault:
> On vendredi 1 septembre 2017 20:42:34 CEST Andre Joost wrote:
>> Am 01.09.2017 um 20:14 schrieb Even Rouault:
>>>> ogr2ogr -s_srs EPSG:4326 -t_srs "+proj=lcc +lat_1=13.31666666666667
>>>> +lat_2=14.25 +lat_0=13.783333 +lon_0=-89 +x_0=500000 +y_0=295809.184
>>>> +k_0=0.99996704 +ellps=clrk66 +units=m +no_defs
>>>> +towgs84=0,125,194,0,0,0,0 +wktext" LimitesNAD27.shp dptoA_WGS_1984.shp
>>>> gdalsrsinfo LimitesNAD27.prj >>out.txt
>>>>
>>>> neither saves towgs84 or wktext
>>>
>>> Yes, a .prj file contains a ESRI flavour of WKT, which supports neither
>>> TOWGS84 or EXTENSION, so they get stripped.
>>
>
> And more importantly the original EPSG code is also missing in ESRI WKT.
>
>> So how is a datum shift outside of the EPSG code world supposed to be
>> applied to a shapefile with ogr2ogr?
>
> You have to override the source SRS with -s_srs EPSG:XXXX if you know the code. One could
> potentially improve the situation by trying to match the .prj CRS name with the entries in the
> EPSG database to try recovering which code the ESRI WKT corresponds too (if there's a
> match)
>

The problem is that there is no EPSG code for the projection, and NAD27 
datum is handled badly outside the US and Canada. The country in 
question is El Salvador, where they adopted NAD27, but it's not part of 
the NAD27 datum shift files. EPSG suggests a Ocotepeque datum, which is 
shifted to NAD27.

greetings,
André Joost



From even.rouault at spatialys.com  Tue Sep  5 07:56:00 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 05 Sep 2017 16:56:00 +0200
Subject: [gdal-dev] Which Proj.4 transforms are available in GDAL?
In-Reply-To: <oomclm$mbc$1@blaine.gmane.org>
References: <op.y5hrr20edbaoe8@macmarilu> <2832921.s9oqiVVp4L@even-i700>
 <oomclm$mbc$1@blaine.gmane.org>
Message-ID: <7289870.ohNKXupm3P@even-i700>

> The problem is that there is no EPSG code for the projection,

Ah, the -s_srs syntax is not limited to EPSG:XXXX. You can use a proj.4 string, inlined WKT, a 
filename that has WKT or proj.4 string in it, etc.
See http://gdal.org/gdal_utilities.html

> and NAD27
> datum is handled badly outside the US and Canada. The country in
> question is El Salvador, where they adopted NAD27, but it's not part of
> the NAD27 datum shift files. EPSG suggests a Ocotepeque datum, which is
> shifted to NAD27.


Isn'it the datum used by ?

$ gdalsrsinfo EPSG:5451

PROJ.4 : +proj=longlat +ellps=clrk66 +towgs84=205,96,-98,0,0,0,0 +no_defs 

OGC WKT :
GEOGCS["Ocotepeque 1935",
    DATUM["Ocotepeque_1935",
        SPHEROID["Clarke 1866",6378206.4,294.9786982138982,
            AUTHORITY["EPSG","7008"]],
        TOWGS84[205,96,-98,0,0,0,0],
        AUTHORITY["EPSG","1070"]],
    PRIMEM["Greenwich",0,
        AUTHORITY["EPSG","8901"]],
    UNIT["degree",0.0174532925199433,
        AUTHORITY["EPSG","9122"]],
    AUTHORITY["EPSG","5451"]]

The TOWGS84 parameters are the ones of transformation http://epsg.io/6891 that is valid 
for El Savador (and neighbouring countries). There are other transformations from 
Octopeque 35 to WGS 84, but none have an area of use that include El Savador.
They are also transformations from Octopeque 35 to NAD 27.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170905/e2db99c2/attachment.html>

From andre+joost at nurfuerspam.de  Tue Sep  5 09:53:19 2017
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Tue, 05 Sep 2017 18:53:19 +0200
Subject: [gdal-dev] Which Proj.4 transforms are available in GDAL?
In-Reply-To: <7289870.ohNKXupm3P@even-i700>
References: <op.y5hrr20edbaoe8@macmarilu> <2832921.s9oqiVVp4L@even-i700>
 <oomclm$mbc$1@blaine.gmane.org> <7289870.ohNKXupm3P@even-i700>
Message-ID: <oomkrv$sg8$1@blaine.gmane.org>

Am 05.09.2017 um 16:56 schrieb Even Rouault:
>> The problem is that there is no EPSG code for the projection,
>
> Ah, the -s_srs syntax is not limited to EPSG:XXXX. You can use a proj.4 string, inlined WKT, a
> filename that has WKT or proj.4 string in it, etc.
> See http://gdal.org/gdal_utilities.html
>
>> and NAD27
>> datum is handled badly outside the US and Canada. The country in
>> question is El Salvador, where they adopted NAD27, but it's not part of
>> the NAD27 datum shift files. EPSG suggests a Ocotepeque datum, which is
>> shifted to NAD27.
>
>
> Isn'it the datum used by ?
>
> $ gdalsrsinfo EPSG:5451
>
> PROJ.4 : +proj=longlat +ellps=clrk66 +towgs84=205,96,-98,0,0,0,0 +no_defs
>
> OGC WKT :
> GEOGCS["Ocotepeque 1935",
>      DATUM["Ocotepeque_1935",
>          SPHEROID["Clarke 1866",6378206.4,294.9786982138982,
>              AUTHORITY["EPSG","7008"]],
>          TOWGS84[205,96,-98,0,0,0,0],
>          AUTHORITY["EPSG","1070"]],
>      PRIMEM["Greenwich",0,
>          AUTHORITY["EPSG","8901"]],
>      UNIT["degree",0.0174532925199433,
>          AUTHORITY["EPSG","9122"]],
>      AUTHORITY["EPSG","5451"]]
>
> The TOWGS84 parameters are the ones of transformation http://epsg.io/6891 that is valid
> for El Savador (and neighbouring countries). There are other transformations from
> Octopeque 35 to WGS 84, but none have an area of use that include El Savador.
> They are also transformations from Octopeque 35 to NAD 27.
>

The shapefile clearly states DATUM["D_North_American_1927", and the 
download page (from the official agency) 
http://www.cnr.gob.sv/geoportal-cnr/ tells the same.

In fact, I have not found any Ocotepeque based GIS data available from 
El Salvador, only from the surrounding countries.

Greetings,
André Joost



From even.rouault at spatialys.com  Tue Sep  5 10:43:15 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 05 Sep 2017 19:43:15 +0200
Subject: [gdal-dev] Which Proj.4 transforms are available in GDAL?
In-Reply-To: <oomkrv$sg8$1@blaine.gmane.org>
References: <op.y5hrr20edbaoe8@macmarilu> <7289870.ohNKXupm3P@even-i700>
 <oomkrv$sg8$1@blaine.gmane.org>
Message-ID: <4055028.9OobKpm0nY@even-i700>

> 
> The shapefile clearly states DATUM["D_North_American_1927", and the
> download page (from the official agency)
> http://www.cnr.gob.sv/geoportal-cnr/ tells the same.

Hum, actually looking at the full .prj, it looks similar to EPSG:5460

See:

$ gdalsrsinfo ESRI::dptoA_Lambert_NAD27.prj

PROJ.4 : +proj=lcc +lat_1=13.31666666666667 +lat_2=14.25 +lat_0=13.783333 +lon_0=-89 +x_0=500000 +y_0=295809.184 +datum=NAD27 +units=m +no_defs 

OGC WKT :
PROJCS["IDGES_rev",
    GEOGCS["GCS_North_American_1927",
        DATUM["North_American_Datum_1927",
            SPHEROID["Clarke_1866",6378206.4,294.9786982]],
        PRIMEM["Greenwich",0.0],
        UNIT["Degree",0.0174532925199433]],
    PROJECTION["Lambert_Conformal_Conic_2SP"],
    PARAMETER["False_Easting",500000.0],
    PARAMETER["False_Northing",295809.184],
    PARAMETER["Central_Meridian",-89.0],
    PARAMETER["Standard_Parallel_1",13.31666666666667],
    PARAMETER["Standard_Parallel_2",14.25],
    PARAMETER["Scale_Factor",0.99996704],
    PARAMETER["Latitude_Of_Origin",13.783333],
    UNIT["Meter",1.0]]

$ gdalsrsinfo EPSG:5460

PROJ.4 : +proj=lcc +lat_1=13.78333333333333 +lat_0=13.78333333333333 +lon_0=-89 +k_0=0.99996704 +x_0=500000 +y_0=295809.184 +ellps=clrk66 +towgs84=205,96,-98,0,0,0,0 +units=m +no_defs 

OGC WKT :
PROJCS["Ocotepeque 1935 / El Salvador Lambert",
    GEOGCS["Ocotepeque 1935",
        DATUM["Ocotepeque_1935",
            SPHEROID["Clarke 1866",6378206.4,294.9786982138982,
                AUTHORITY["EPSG","7008"]],
            TOWGS84[205,96,-98,0,0,0,0],
            AUTHORITY["EPSG","1070"]],
        PRIMEM["Greenwich",0,
            AUTHORITY["EPSG","8901"]],
        UNIT["degree",0.0174532925199433,
            AUTHORITY["EPSG","9122"]],
        AUTHORITY["EPSG","5451"]],
    PROJECTION["Lambert_Conformal_Conic_1SP"],
    PARAMETER["latitude_of_origin",13.78333333333333],
    PARAMETER["central_meridian",-89],
    PARAMETER["scale_factor",0.99996704],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",295809.184],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AXIS["X",EAST],
    AXIS["Y",NORTH],
    AUTHORITY["EPSG","5460"]]

So beside the datum difference, they are equivalent. The .prj one uses a
LCC2SP formulation of LCC, and the EPSG one a LCC1SP one. One can easily
check they are equivalent with:

$ gdaltransform -s_srs "+proj=longlat +ellps=clrk66" -t_srs ESRI::dptoA_Lambert_NAD27.prj
-88 14
608032.297052867 320003.359813003 0

$ gdaltransform -s_srs "+proj=longlat +ellps=clrk66" -t_srs EPSG:5460
-88 14
608032.297913122 320003.32045602 0

(the slight difference in northing might come from the .prj having a limited number
of digits for Latitude_of_origin compared to the EPSG one)

So the NAD27 datum might be just an artifact of something in their production
chain not being able to handle Octopeque 1935. Or just a matter of habit. My
knowledge of El Salvador geodesy is rather limited ;-)

Or if it is really NAD27 datum, I can indeed see that they are 3 NAD27->WGS84 transforms available
for central America.

$ ogrinfo pg:dbname=epsg -sql "select c.*, a.area_code, a.area_name from epsg_coordoperation c join epsg_area a on c.area_of_use_code = a.area_code where c.source_crs_code = 4267 and c.target_crs_code=4326 and area_south_bound_lat > 0 and area_north_bound_lat < 20 and area_west_bound_lon > -95 and area_east_bound_lon < -75"

Two of them are specific of Panama. The remaining one is EPSG:1171 that applies to
"Central America - Belize to Costa Rica"

Its TOWGS84 params are 0.0, 125.0, 194.0, 0.0, 0.0, 0.0, 0.0


Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170905/e9418654/attachment-0001.html>

From andre+joost at nurfuerspam.de  Tue Sep  5 11:14:59 2017
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Tue, 05 Sep 2017 20:14:59 +0200
Subject: [gdal-dev] Which Proj.4 transforms are available in GDAL?
In-Reply-To: <4055028.9OobKpm0nY@even-i700>
References: <op.y5hrr20edbaoe8@macmarilu> <7289870.ohNKXupm3P@even-i700>
 <oomkrv$sg8$1@blaine.gmane.org> <4055028.9OobKpm0nY@even-i700>
Message-ID: <oompkm$r0p$1@blaine.gmane.org>

Am 05.09.2017 um 19:43 schrieb Even Rouault:
>>
>> The shapefile clearly states DATUM["D_North_American_1927", and the
>> download page (from the official agency)
>> http://www.cnr.gob.sv/geoportal-cnr/ tells the same.
>
> Hum, actually looking at the full .prj, it looks similar to EPSG:5460

Yes, projection parameter values are the same, and the datum shift is 
not stored inside the Shapefile definition.

>
> See:
>
> $ gdalsrsinfo ESRI::dptoA_Lambert_NAD27.prj
>
> PROJ.4 : +proj=lcc +lat_1=13.31666666666667 +lat_2=14.25 +lat_0=13.783333 +lon_0=-89 +x_0=500000 +y_0=295809.184 +datum=NAD27 +units=m +no_defs

... and that's the pitfall for Proj.4, resulting in zero datum shift 
because the grid shift files don't cover El Salvador.

>
> OGC WKT :
> PROJCS["IDGES_rev",
>      GEOGCS["GCS_North_American_1927",
>          DATUM["North_American_Datum_1927",
>              SPHEROID["Clarke_1866",6378206.4,294.9786982]],
>          PRIMEM["Greenwich",0.0],
>          UNIT["Degree",0.0174532925199433]],
>      PROJECTION["Lambert_Conformal_Conic_2SP"],
>      PARAMETER["False_Easting",500000.0],
>      PARAMETER["False_Northing",295809.184],
>      PARAMETER["Central_Meridian",-89.0],
>      PARAMETER["Standard_Parallel_1",13.31666666666667],
>      PARAMETER["Standard_Parallel_2",14.25],
>      PARAMETER["Scale_Factor",0.99996704],
>      PARAMETER["Latitude_Of_Origin",13.783333],
>      UNIT["Meter",1.0]]
>

>
> So beside the datum difference, they are equivalent. The .prj one uses a
> LCC2SP formulation of LCC, and the EPSG one a LCC1SP one.

Except that they have a scale factor with LCC 2SP, but it gets silently 
dropped by GDAL/PROJ.4.

>
> So the NAD27 datum might be just an artifact of something in their production
> chain not being able to handle Octopeque 1935. Or just a matter of habit. My
> knowledge of El Salvador geodesy is rather limited ;-)

... or they keep a kind of mistery on it. El Salvador should have moved 
to SIRGAS-ES2007.8 by now, but I have not found any projected CRS based 
on that.

>
> Or if it is really NAD27 datum, I can indeed see that they are 3 NAD27->WGS84 transforms available
> for central America.
>
> $ ogrinfo pg:dbname=epsg -sql "select c.*, a.area_code, a.area_name from epsg_coordoperation c join epsg_area a on c.area_of_use_code = a.area_code where c.source_crs_code = 4267 and c.target_crs_code=4326 and area_south_bound_lat > 0 and area_north_bound_lat < 20 and area_west_bound_lon > -95 and area_east_bound_lon < -75"
>
> Two of them are specific of Panama. The remaining one is EPSG:1171 that applies to
> "Central America - Belize to Costa Rica"
>
> Its TOWGS84 params are 0.0, 125.0, 194.0, 0.0, 0.0, 0.0, 0.0
>

... and that looks nothing similar to the Ocotepeque datum shift. They 
are about 400 meters apart.

Greetings,
André Joost



From even.rouault at spatialys.com  Tue Sep  5 11:50:08 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 05 Sep 2017 20:50:08 +0200
Subject: [gdal-dev] Which Proj.4 transforms are available in GDAL?
In-Reply-To: <oompkm$r0p$1@blaine.gmane.org>
References: <op.y5hrr20edbaoe8@macmarilu> <4055028.9OobKpm0nY@even-i700>
 <oompkm$r0p$1@blaine.gmane.org>
Message-ID: <2003553.hi7nWLJ1Xq@even-i700>

> Except that they have a scale factor with LCC 2SP, but it gets silently
> dropped by GDAL/PROJ.4.

Which is OK. The LCC 2SP formulation just needs the 2 standard parallels and the latitude of 
origin. Basically when GDAL imports a ESRI WKT and sees that there's 2 standard parallel, it 
considers it is a LCC_2SP. The scale factor is redundant there. proj.4 doesn't need it when the 
2 standard parallels are provided; You need either the 2 standard parallels, or 1 standard 
parallel + the scale factor, and with some maths you can go from one form to the equivalent 
other one (the importFromESRI() method could probably be enhanced to check the 
consistency of the 4 parameters when present and emit a warning in case they are not 
consistent. Exercice left to contributors)

Actually looking at proj.4 code, you must *not* include a +k_0 (other than 1) when using the 
+lat_1 +lat_2 formulation, otherwise the scale factor would be applied twice.

> ... and that looks nothing similar to the Ocotepeque datum shift. They
> are about 400 meters apart.

Well that's expected if NAD27 and Octopeque are indeed 2 different datums: there must be 
a shift between. The EPSG database has also shifts from Octopeque to NAD27. Apparently 
they also offer the datasets in WGS 84, so you can perhaps check which hypothesis is right 
from that.


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170905/3f77a473/attachment.html>

From matt.amato at gmail.com  Tue Sep  5 13:23:17 2017
From: matt.amato at gmail.com (Matthew Amato)
Date: Tue, 5 Sep 2017 16:23:17 -0400
Subject: [gdal-dev] OGRSpatialReference::IsSame returning TRUE unexpectedly
Message-ID: <CAO7bkPy6KdA92NP+nUbwu_8COCuYJpVTqmvwK-2EBPWwO6FA3w@mail.gmail.com>

Short version:

I don't understand why the below code snippet is returning TRUE.  Unless
I'm missing something, EPSG 3857 is not the same as 3395, why is GDAL
reporting that they are?

            auto epsg3857 = OGRSpatialReference();
            epsg3857.importFromEPSG(3857);

            auto epsg3395 = OGRSpatialReference();
            epsg3395.importFromEPSG(3395);

            if (epsg3857.IsSame(&epsg3395) == TRUE) {
                std::cout << "Bug?" << std::endl;
            }

Longer version:

I'm attempting to load in a GeoTIFF and detect whether it is already in
EPSG:3857 or needs to be reprojected.  My function looks like this:

        bool isSpatialReferenceSystem(GDALDataset &dataset, int epsg)
        {
            std::string in_srs_wkt = dataset.GetProjectionRef();

            if (in_srs_wkt.length() == 0)
            {
                return false;
            }

            auto dataset_srs = OGRSpatialReference(in_srs_wkt.c_str());
            auto target_srs = OGRSpatialReference();
            target_srs.importFromEPSG(epsg);
            return dataset_srs.IsSame(&target_srs) == TRUE;
        }

This function worked as expected until a few days ago when I was given a
GeoTIFF with the following information (via gdalinfo):

Driver: GTiff/GeoTIFF
Files: data.tif
Size is 11779, 8832
Coordinate System is:
PROJCS["WGS 84 / World Mercator",
    GEOGCS["WGS 84",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.257223563,
                AUTHORITY["EPSG","7030"]],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0,
            AUTHORITY["EPSG","8901"]],
        UNIT["degree",0.0174532925199433,
            AUTHORITY["EPSG","9122"]],
        AUTHORITY["EPSG","4326"]],
    PROJECTION["Mercator_1SP"],
    PARAMETER["central_meridian",0],
    PARAMETER["scale_factor",1],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AXIS["Easting",EAST],
    AXIS["Northing",NORTH],
    AUTHORITY["EPSG","3395"]]
Origin = (723576.685867484660000,5474400.172804606100000)
Pixel Size = (33.077567560570841,-33.077567560572312)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (  723576.686, 5474400.173) (  6d30' 0.00"E, 44d15' 0.34"N)
Lower Left  (  723576.686, 5182259.096) (  6d30' 0.00"E, 42d20' 0.00"N)
Upper Right ( 1113197.354, 5474400.173) ( 10d 0' 0.08"E, 44d15' 0.34"N)
Lower Right ( 1113197.354, 5182259.096) ( 10d 0' 0.08"E, 42d20' 0.00"N)
Center      (  918387.020, 5328329.634) (  8d15' 0.04"E, 43d17'57.55"N)
Band 1 Block=11779x1 Type=Byte, ColorInterp=Red
  Mask Flags: PER_DATASET ALPHA
Band 2 Block=11779x1 Type=Byte, ColorInterp=Green
  Mask Flags: PER_DATASET ALPHA
Band 3 Block=11779x1 Type=Byte, ColorInterp=Blue
  Mask Flags: PER_DATASET ALPHA
Band 4 Block=11779x1 Type=Byte, ColorInterp=Alpha

Creating a GDALDataset from the image and calling my function returns TRUE
when I expect it to return false, after some debugging, I traced it back to
my simpler code snippet that shows 3857 and 3395 being treated as the same.

The odd thing is that if I tell GDAL to reproject the image to 3857 (via a
VRT), everything works.  So GDAL clearly knows they are different under the
hood.

I assume my understanding of IsSame is flawed so any clarification would be
a big help.

Thanks,

Matt
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170905/894afe14/attachment.html>

From even.rouault at spatialys.com  Tue Sep  5 14:02:29 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 05 Sep 2017 23:02:29 +0200
Subject: [gdal-dev] OGRSpatialReference::IsSame returning TRUE
	unexpectedly
In-Reply-To: <CAO7bkPy6KdA92NP+nUbwu_8COCuYJpVTqmvwK-2EBPWwO6FA3w@mail.gmail.com>
References: <CAO7bkPy6KdA92NP+nUbwu_8COCuYJpVTqmvwK-2EBPWwO6FA3w@mail.gmail.com>
Message-ID: <1642544.ZiFfKECYzQ@even-i700>

> I assume my understanding of IsSame is flawed so any clarification would be
> a big help.
>

Matt,

Your understanding of IsSame() is correct. You just hit a bug. I've fixed it per https://
trac.osgeo.org/gdal/ticket/7029. You can see the changeset code as a workaround to add in 
your own code if you need.

IsSame() is a "smart" comparison, ie it tries to abstract away unsignificant differences like the 
PROJCS text value that don't participate really to the SRS and can vary over formats, data 
producers, etc... The issue here is that web-mercator (EPSG:3857) and WGS84-mercator 
(EPSG:3395) are represented the same way at the GEOGCS and projection levels. The only 
difference is that GDAL creates a EXTENSION["PROJ4", ...] node in the web-mercator case to 
really use the spherical definition. And IsSame() before my fix neglected to compare that 
extension node. So you were a bit unlucky since that must be pretty much the only pair of 
EPSG entries in that situation.

My initial tought was to compare the authority codes/nodes when they exist on both sides, 
but I was wondering if there are not cases where you'd have the same SRS registered in 2 
different catalogs. Presumably within the same catalog, a different code should mean a 
different CRS, but I'm not even completely sure you couldn't find oddities. I was thinking to 
EPSG:3857 vs the deprecated EPSG:3785, but this isn't a good example, since they differ on 
the DATUM. So currently IsSame() returns FALSE on that pair, although I guess one might 
consider them as equivalent (the deprecated version is just a buggy expression on the 
current EPSG:3857). Or not...
You also have the situation where really different CRS (IsSame() == FALSE) ends up being 
translated the same way as proj.4 strings...

So it is actually not obvious to define the semantics of IsSame(). It should at least return 
FALSE for CRS that are clearly different (coordinate transformation results in differences).

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170905/38d552f8/attachment.html>

From matt.amato at gmail.com  Tue Sep  5 17:21:17 2017
From: matt.amato at gmail.com (Matthew Amato)
Date: Tue, 5 Sep 2017 20:21:17 -0400
Subject: [gdal-dev] OGRSpatialReference::IsSame returning TRUE
	unexpectedly
In-Reply-To: <1642544.ZiFfKECYzQ@even-i700>
References: <CAO7bkPy6KdA92NP+nUbwu_8COCuYJpVTqmvwK-2EBPWwO6FA3w@mail.gmail.com>
 <1642544.ZiFfKECYzQ@even-i700>
Message-ID: <CAO7bkPz+pKg7e7CmEsAqC_N08z3hpbxruD2hO4smMw0bHYUVcw@mail.gmail.com>

Thanks for the detailed write up and quick fix!

Just to clarify your last sentence, are you saying there are still
potential cases where IsSame returns TRUE when it shouldn't?  Or were you
just emphasizing that this is a very tricky check to get right in all
cases?  I'm just wondering if I should ditch my optimization of checking
the spatial reference and always do a reproject (via VRT) even if it
results in a no-op in some cases.  I assume the overhead of a no-op VRT is
fairly small and I'm concerned with correctness more than anything else.

Thanks again.

On Tue, Sep 5, 2017 at 5:02 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> > I assume my understanding of IsSame is flawed so any clarification would
> be
>
> > a big help.
>
> >
>
>
>
> Matt,
>
>
>
> Your understanding of IsSame() is correct. You just hit a bug. I've fixed
> it per https://trac.osgeo.org/gdal/ticket/7029. You can see the changeset
> code as a workaround to add in your own code if you need.
>
>
>
> IsSame() is a "smart" comparison, ie it tries to abstract away
> unsignificant differences like the PROJCS text value that don't participate
> really to the SRS and can vary over formats, data producers, etc... The
> issue here is that web-mercator (EPSG:3857) and WGS84-mercator (EPSG:3395)
> are represented the same way at the GEOGCS and projection levels. The only
> difference is that GDAL creates a EXTENSION["PROJ4", ...] node in the
> web-mercator case to really use the spherical definition. And IsSame()
> before my fix neglected to compare that extension node. So you were a bit
> unlucky since that must be pretty much the only pair of EPSG entries in
> that situation.
>
>
>
> My initial tought was to compare the authority codes/nodes when they exist
> on both sides, but I was wondering if there are not cases where you'd have
> the same SRS registered in 2 different catalogs. Presumably within the same
> catalog, a different code should mean a different CRS, but I'm not even
> completely sure you couldn't find oddities. I was thinking to EPSG:3857 vs
> the deprecated EPSG:3785, but this isn't a good example, since they differ
> on the DATUM. So currently IsSame() returns FALSE on that pair, although I
> guess one might consider them as equivalent (the deprecated version is just
> a buggy expression on the current EPSG:3857). Or not...
>
> You also have the situation where really different CRS (IsSame() == FALSE)
> ends up being translated the same way as proj.4 strings...
>
>
>
> So it is actually not obvious to define the semantics of IsSame(). It
> should at least return FALSE for CRS that are clearly different (coordinate
> transformation results in differences).
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170905/6ae3a2c5/attachment-0001.html>

From andre+joost at nurfuerspam.de  Tue Sep  5 23:21:00 2017
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Wed, 06 Sep 2017 08:21:00 +0200
Subject: [gdal-dev] Which Proj.4 transforms are available in GDAL?
In-Reply-To: <2003553.hi7nWLJ1Xq@even-i700>
References: <op.y5hrr20edbaoe8@macmarilu> <4055028.9OobKpm0nY@even-i700>
 <oompkm$r0p$1@blaine.gmane.org> <2003553.hi7nWLJ1Xq@even-i700>
Message-ID: <ooo46a$k6d$1@blaine.gmane.org>

Am 05.09.2017 um 20:50 schrieb Even Rouault:
>Apparently
> they also offer the datasets in WGS 84, so you can perhaps check which hypothesis is right
> from that.
>

Both datasets align with the Custom CRS including 3-parms datum shift I 
included earlier in this thread.

Greetings,
André Joost



From even.rouault at spatialys.com  Tue Sep  5 23:29:57 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 06 Sep 2017 08:29:57 +0200
Subject: [gdal-dev] OGRSpatialReference::IsSame returning TRUE
	unexpectedly
In-Reply-To: <CAO7bkPz+pKg7e7CmEsAqC_N08z3hpbxruD2hO4smMw0bHYUVcw@mail.gmail.com>
References: <CAO7bkPy6KdA92NP+nUbwu_8COCuYJpVTqmvwK-2EBPWwO6FA3w@mail.gmail.com>
 <1642544.ZiFfKECYzQ@even-i700>
 <CAO7bkPz+pKg7e7CmEsAqC_N08z3hpbxruD2hO4smMw0bHYUVcw@mail.gmail.com>
Message-ID: <12254324.9GKG5Mub3D@even-i700>

On mardi 5 septembre 2017 20:21:17 CEST Matthew Amato wrote:
> Thanks for the detailed write up and quick fix!
> 
> Just to clarify your last sentence, are you saying there are still
> potential cases where IsSame returns TRUE when it shouldn't? 

Hopefully not.

> I'm just wondering if I should ditch my optimization of checking
> the spatial reference and always do a reproject (via VRT) even if it
> results in a no-op in some cases.  I assume the overhead of a no-op VRT is
> fairly small and I'm concerned with correctness more than anything else.

If "same for reprojection" is what matters for you, a safe way of checking is calling 
exportToProj4() on both SRS and checking for equality on the returned strings.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170906/7404b90f/attachment.html>

From even.rouault at spatialys.com  Wed Sep  6 02:26:42 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 06 Sep 2017 11:26:42 +0200
Subject: [gdal-dev] GDAL 2.2.2 schedule
Message-ID: <1838417.iziFTJCK21@even-i700>

Hi,

I'm considering preparing a 2.2.2 release candidate for end of next 
week. Speak if you need more time to push a fix in it. Or if there are 
bugs that aren't yet fixed in the branch and ought to (no promise 
here)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170906/1f3493c6/attachment.html>

From even.rouault at spatialys.com  Wed Sep  6 06:14:26 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 06 Sep 2017 15:14:26 +0200
Subject: [gdal-dev] git(hub) migration ?
Message-ID: <5104617.fMlcYK0Juz@even-i700>

Hi,

I've heard a few voices speaking/asking/begging for a git/github migration. At some point 
we'll certainly have to do it, as SVN vs git is beginning to feel more and more like CVS vs SVN 
15 years ago.

I can see different options :

1) migrate to git, and remain within the OSGeo infrastructure. This is for example the case of 
GEOS which uses the Trac git plugin and the GOGS (or is gitea?) git hosting (https://
git.osgeo.org/gogs/geos/geos.git). gogs/gitea tries to replicate most github functionalities, 
but feature parity is still not there (you cannot comment on a commit e.g). We could still 
offer github as a mirror, which would ease contributions a bit compared to the current git-
>svn situation, but the "Merge" button from github couldn't (shouldn't) be used.

2) migrate code to github, accept pull requests (PR) directly there. Tickets still managed in 
Trac. But then we have no automated link between Trac and github (unless there's a Trac 
plugin for that). A few other OSGeo projects are in a similar situation: QGIS with Redmine for 
tickets and github for PR&code, GeoServer with JIRA for tickets and github for PR&code. I've 
some experience with the QGIS situation: Redmine can include github commit references if 
the git commit message includes the ticket number. But, of course, the other way doesn't 
work: from github UI, the #XXXX link doesn't work (or would point to a unrelated PR with 
same number). So this is middly satisfactory, and a regression from our current situation.

3) migrate code and tickets to github. I guess this would match most (especially occasional) 
contributor wishes regarding the "social" aspect. What would be needed is Trac -> github 
ticket migration. Thomas Bonfort did it for MapServer at some point, but he lost the script if I 
remember well (I can see in https://stackoverflow.com/questions/6671584/how-to-export-trac-to-github-issues a number of possibilities listed). One issue also is we have numbers 
taken by existing github pull requests, so there would be collisions on import (we could 
decide either to sacrifice colliding Trac tickets, as there are really old, currently the colision 
appear for tickets older than 2003, or move them to an available github ticket number. Or to 
sacrifice existing PR, but there are a few pending ones)
There's also the valid concern about being tied with github.com regarding tickets. Recently I 
found https://github.com/josegonzalez/python-github-backup 
which can backup code, issues, pull requests, etc.. using the github API. 
Quickly tested it on their own repo. Seems to work (**), although a bit slow ( requires 2 GET 
per issue / pull request to retrieve extra details that are not retrieved by the global request 
you showed above). It has an incremental mode though which should make it efficient.

My synthetic view of the situation:
1) is a pure free sofware & free hosting approach. Relies on SAC being appropriately man and 
machine powered (same as with SVN / Trac currently)
2) mixed solution. we still have ownership on all our data (code & tickets). but the separation 
between a ticket system and code+PR isn't ideal from a usability point of view
3) offers probably the best contributor experience. We loose a bit of control, but a backup(*) 
strategy exists (at least for now). I'd tend to favor this approach.

I'm not sure if the current git mirror shouldn't be re-done from scratch. Its main drawback is 
that svn tags are reported as git branches, instead of git tags. I probably mis-configured 
things when I initiated the mirror a few years ago. Not completely sure this is worth the 
effort though. We can probably live with those existing mis-created tags, and use proper git 
tags for the future.

The release procedure / script would also have to be updated. Probably other things too.

There's also the question of the Trac Wiki, although this one might be defered for a later 
stage.

So this email is mostly to say I'm open to the idea, but I'd appreciate if someone else could 
take the lead on this. I'd be happy to help. A RFC to formalize the move would be needed.

Even

(*) Backup might not be the inappropriate term, since this implies that you can easily restore 
things. If github closes or requires (insane) fees for open source projects, those saved tickets 
will have to be re-injected in some to-be-defined alternative, but at least their content is 
readable (json)

(**) steps:
1) pip install github-backup
2) in github UI, create a personnal access token, so as to be able to use authenticated 
requests to github API, to bypass the rate limit of unauthenticated requests (you can use it 
even for repositories that you don't own)
3) github-backup -i -R python-github-backup josegonzalez --issues --issue-comments --issue-
events --pulls --pull-comments --pull-commits -t ${your_github_token}


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170906/efe9faac/attachment-0001.html>

From norman.barker at gmail.com  Wed Sep  6 06:39:34 2017
From: norman.barker at gmail.com (Norman Barker)
Date: Wed, 6 Sep 2017 08:39:34 -0500
Subject: [gdal-dev] Representing a grib file as a netCDF
Message-ID: <CAN_Dn-F9bMSW=f5XccWsdsc4VhMHr8MXawpdqxbncs==qA9c=A@mail.gmail.com>

Hi,

I am currently working on representing a grib file as a netCDF file within
GDAL. My plan is that if a user specifies the netCDF driver and opens a
grib file then the metadata from the grib will be represented as a netCDF
and the data can be read through that driver.

It may seem a bit odd since GDAL has a fully functional grib driver but it
matches the use of the netCDF model when reading grib within most
meteorological packages and enables me (and hopefully others) to match the
metadata conventions in other packages.

Any feedback appreciated, I am working on this now and will have code for
review shortly.

Thanks,

Norman
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170906/8941c97c/attachment.html>

From schwehr at gmail.com  Wed Sep  6 09:14:10 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Wed, 6 Sep 2017 09:14:10 -0700
Subject: [gdal-dev] RFC68: C++11 compilation mode - Call for vote on adoption
Message-ID: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>

Now that Tamas has added the msvc2015/2-17SDK's, I'd like to call a vote by
the PSC on RFC68: C++11 compilation mode.

The draft is here:

 https://trac.osgeo.org/gdal/wiki/rfc68_cplusplus11

-Kurt


>
> > Hi Even,
>
> >
>
> > The new SDK-s have now been added.
>
> >
>
> > Best regards,
>
> >
>
> > Tamas
>
> >
>
> > 2017-08-29 15:18 GMT+02:00 Tamas Szekeres <szekerest at gmail.com>:
>
> > > Hi Even,
>
> > >
>
> > > Yes, I'm planning to include msvc2015/2017 versions shortly.
>
> > >
>
> > > Best regards,
>
> > > Tamas
>
> > >
>
> > >
>
> > > 2017. aug. 14. dátummal, 19:02 időpontban Even Rouault <
>
> > >
>
> > > even.rouault at spatialys.com> írta:
>
> > > > Hi Tamas,
>
> > > >
>
> > > > Unless I'm mistaken your gisinternals.com builds don't include MSVC
>
> > >
>
> > > 2015 currently. Right ? Do you have any plans to do so ? Currently the
>
> > > GDAL
>
> > > AppVeyor target uses SDKSs from gisinternals to do builds with a
> number of
>
> > > third-party libraries.
>
> > >
>
> > > > Even
>
> > > >
>
> > > > > This is a call for discussion on RFC68 to set C++11 to be the
> minimum
>
> > >
>
> > > C++
>
> > >
>
> > > > > language version for GDAL trunk. I've drafted the RFC based on
> work by
>
> > > > > Mateusz.
>
> > > > >
>
> > > > > https://trac.osgeo.org/gdal/wiki/rfc68_cplusplus11
>
> > > > >
>
> > > > > There was initial discussions back in January of this year:
>
> > > > >
>
> > > > >
> https://lists.osgeo.org/pipermail/gdal-dev/2017January/thread.html#45786
>
> > >
>
> > > > > Cheers,
>
> > > > > -kurt
>
> > > > > Engineer at Google
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170906/1021e60a/attachment.html>

From even.rouault at spatialys.com  Wed Sep  6 09:38:01 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 06 Sep 2017 18:38:01 +0200
Subject: [gdal-dev] RFC68: C++11 compilation mode - Call for vote on
	adoption
In-Reply-To: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
References: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
Message-ID: <27379629.1S2nbtXvIU@even-i700>

On mercredi 6 septembre 2017 09:14:10 CEST Kurt Schwehr wrote:
> Now that Tamas has added the msvc2015/2-17SDK's, I'd like to call a vote by
> the PSC on RFC68: C++11 compilation mode.
> 
> The draft is here:
> 
>  https://trac.osgeo.org/gdal/wiki/rfc68_cplusplus11

+1

Just a comment regarding "Remove continuous build targets that do not support C++11 
from Travis-CI and AppVeyor". We'll have to be careful as there are subtle differences in 
configurations / drivers tested in some of the non C++11 capable configurations that would 
be good to keep. But that should indeed reduce the number of configurations.

Even

> 
> -Kurt
> 
> > > Hi Even,
> > > 
> > > 
> > > 
> > > The new SDK-s have now been added.
> > > 
> > > 
> > > 
> > > Best regards,
> > > 
> > > 
> > > 
> > > Tamas
> > > 
> > > 2017-08-29 15:18 GMT+02:00 Tamas Szekeres <szekerest at gmail.com>:
> > > > Hi Even,
> > > > 
> > > > 
> > > > 
> > > > Yes, I'm planning to include msvc2015/2017 versions shortly.
> > > > 
> > > > 
> > > > 
> > > > Best regards,
> > > > 
> > > > Tamas
> > > > 
> > > > 
> > > > 
> > > > 
> > > > 
> > > > 2017. aug. 14. dátummal, 19:02 időpontban Even Rouault <
> > > > 
> > > > even.rouault at spatialys.com> írta:
> > > > > Hi Tamas,
> > > > > 
> > > > > 
> > > > > 
> > > > > Unless I'm mistaken your gisinternals.com builds don't include MSVC
> > > > 
> > > > 2015 currently. Right ? Do you have any plans to do so ? Currently the
> > > > 
> > > > GDAL
> > > > 
> > > > AppVeyor target uses SDKSs from gisinternals to do builds with a
> > 
> > number of
> > 
> > > > third-party libraries.
> > > > 
> > > > > Even
> > > > > 
> > > > > > This is a call for discussion on RFC68 to set C++11 to be the
> > 
> > minimum
> > 
> > > > C++
> > > > 
> > > > > > language version for GDAL trunk. I've drafted the RFC based on
> > 
> > work by
> > 
> > > > > > Mateusz.
> > > > > > 
> > > > > > 
> > > > > > 
> > > > > > https://trac.osgeo.org/gdal/wiki/rfc68_cplusplus11
> > 
> > > > > > There was initial discussions back in January of this year:
> > https://lists.osgeo.org/pipermail/gdal-dev/2017January/thread.html#45786
> > 
> > > > > > Cheers,
> > > > > > 
> > > > > > -kurt
> > > > > > 
> > > > > > Engineer at Google


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170906/27cab3bc/attachment-0001.html>

From andrew.bell.ia at gmail.com  Wed Sep  6 09:58:49 2017
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Wed, 6 Sep 2017 12:58:49 -0400
Subject: [gdal-dev] RFC68: C++11 compilation mode - Call for vote on
	adoption
In-Reply-To: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
References: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
Message-ID: <CACJ51z1+n8-yk==Y0RLe5sBe+9LmMBuB21cojL6f=zOmn=EfmQ@mail.gmail.com>

On Wed, Sep 6, 2017 at 12:14 PM, Kurt Schwehr <schwehr at gmail.com> wrote:

> Now that Tamas has added the msvc2015/2-17SDK's, I'd like to call a vote
> by the PSC on RFC68: C++11 compilation mode.
>
> The draft is here:
>
>  https://trac.osgeo.org/gdal/wiki/rfc68_cplusplus11
>

I'm late to the party, but I guess I don't understand a few things in the
RFC.

In Plan:  If c++11 mode is enabled, won't ALL code need to be C++11
compliant, rather than just new code?

In Core changes and Potential changes: It's not clear to me how these are
related to turning on C++ 11 mode.  Are the "Core changes" the NECESSARY
changes to support the C++11 standard?  Are the "not included" features
DISALLOWED in future code, or...?

Thanks for the clarification.

-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170906/a9004052/attachment.html>

From mateusz at loskot.net  Wed Sep  6 10:04:34 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed, 6 Sep 2017 19:04:34 +0200
Subject: [gdal-dev] RFC68: C++11 compilation mode - Call for vote on
	adoption
In-Reply-To: <CACJ51z1+n8-yk==Y0RLe5sBe+9LmMBuB21cojL6f=zOmn=EfmQ@mail.gmail.com>
References: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
 <CACJ51z1+n8-yk==Y0RLe5sBe+9LmMBuB21cojL6f=zOmn=EfmQ@mail.gmail.com>
Message-ID: <CABUeae_6-ooKnT6=eZ-jWAyPSwVhV8YOWZgn+4X4YzEcV-O6ig@mail.gmail.com>

On 6 September 2017 at 18:58, Andrew Bell <andrew.bell.ia at gmail.com> wrote:
> On Wed, Sep 6, 2017 at 12:14 PM, Kurt Schwehr <schwehr at gmail.com> wrote:
>>
>> Now that Tamas has added the msvc2015/2-17SDK's, I'd like to call a vote
>> by the PSC on RFC68: C++11 compilation mode.
>>
>> The draft is here:
>>
>>  https://trac.osgeo.org/gdal/wiki/rfc68_cplusplus11
>
>
> I'm late to the party, but I guess I don't understand a few things in the
> RFC.
>
> In Plan:  If c++11 mode is enabled, won't ALL code need to be C++11
> compliant, rather than just new code?

Any existing code which does not compile as C++11 will have to be updated.

C++11 for new code means, we are now allowed to use C++11 features
(eg. you can write range-based loops now).

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From even.rouault at spatialys.com  Wed Sep  6 10:11:44 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 06 Sep 2017 19:11:44 +0200
Subject: [gdal-dev] RFC68: C++11 compilation mode - Call for vote on
	adoption
In-Reply-To: <CABUeae_6-ooKnT6=eZ-jWAyPSwVhV8YOWZgn+4X4YzEcV-O6ig@mail.gmail.com>
References: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
 <CACJ51z1+n8-yk==Y0RLe5sBe+9LmMBuB21cojL6f=zOmn=EfmQ@mail.gmail.com>
 <CABUeae_6-ooKnT6=eZ-jWAyPSwVhV8YOWZgn+4X4YzEcV-O6ig@mail.gmail.com>
Message-ID: <2102373.pfxVO0sF5I@even-i700>

On mercredi 6 septembre 2017 19:04:34 CEST Mateusz Loskot wrote:
> On 6 September 2017 at 18:58, Andrew Bell <andrew.bell.ia at gmail.com> wrote:
> > On Wed, Sep 6, 2017 at 12:14 PM, Kurt Schwehr <schwehr at gmail.com> wrote:
> >> Now that Tamas has added the msvc2015/2-17SDK's, I'd like to call a vote
> >> by the PSC on RFC68: C++11 compilation mode.
> >> 
> >> The draft is here:
> >>  https://trac.osgeo.org/gdal/wiki/rfc68_cplusplus11
> > 
> > I'm late to the party, but I guess I don't understand a few things in the
> > RFC.
> > 
> > In Plan:  If c++11 mode is enabled, won't ALL code need to be C++11
> > compliant, rather than just new code?
> 
> Any existing code which does not compile as C++11 will have to be updated.

This is mostly a theoretical case. We have buildbots that compile in C++11 and ran tests for a 
couple of years now (and one in C++14). And by default (since GDAL 2.2 I think) ./configure 
already enables C++11 on all C++11 capable compilers.

There are perhaps a few niche drivers that depend on third-party SDKs and that people have 
not compiled in years, but they might be broken in other aspects, so not much of a concern.


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170906/7ed37f6f/attachment.html>

From jluis at ualg.pt  Wed Sep  6 10:14:05 2017
From: jluis at ualg.pt (Joaquim Luis)
Date: Wed, 06 Sep 2017 18:14:05 +0100
Subject: [gdal-dev] RFC68: C++11 compilation mode - Call for vote on
 adoption
In-Reply-To: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
References: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
Message-ID: <op.y55l5rzbdbaoe8@macmarilu>

Wait, does this means that VS2013 will no longer be supported?
That's awful because I'll have to rebuild all my dependencies and honestly  
do not understand what compiler dlls must be distributed with the code  
(with VS2013 I only has to ship in 2 dlls) and the last thing I want is to  
force users to go previously install the MS distributable file (I maintain  
the GMR Windows installer).

Joaquim


> Now that Tamas has added the msvc2015/2-17SDK's, I'd like to call a vote  
> by the PSC on RFC68: C++11 compilation mode.
>
> The draft is here:
>
> https://trac.osgeo.org/gdal/wiki/rfc68_cplusplus11
>
> -Kurt
>
>>
>>
>>> Hi Even,
>>
>>>
>>
>>> The new SDK-s have now been added.
>>
>>>
>>
>>> Best regards,
>>
>>>
>>
>>> Tamas
>>
>>>
>>
>>> 2017-08-29 15:18 GMT+02:00 Tamas Szekeres <szekerest at gmail.com>:
>>
>>> > Hi Even,
>>
>>> >
>>
>>> > Yes, I'm planning to include msvc2015/2017 versions shortly.
>>
>>> >
>>
>>> > Best regards,
>>
>>> > Tamas
>>
>>> >
>>
>>> >
>>
>>> > 2017. aug. 14. dátummal, 19:02 időpontban Even Rouault <
>>
>>> >
>>
>>> > even.rouault at spatialys.com> írta:
>>
>>> > > Hi Tamas,
>>
>>> > >
>>
>>> > > Unless I'm mistaken your gisinternals.com builds don't include MSVC
>>
>>> >
>>
>>> > 2015 currently. Right ? Do you have any plans to do so ? Currently  
>>> the
>>
>>> > GDAL
>>
>>> > AppVeyor target uses SDKSs from gisinternals to do builds with a  
>>> number of
>>
>>> > third-party libraries.
>>
>>> >
>>
>>> > > Even
>>
>>> > >
>>
>>> > > > This is a call for discussion on RFC68 to set C++11 to be the  
>>> minimum
>>
>>> >
>>
>>> > C++
>>
>>> >
>>
>>> > > > language version for GDAL trunk. I've drafted the RFC based on  
>>> work by
>>
>>> > > > Mateusz.
>>
>>> > > >
>>
>>> > > > https://trac.osgeo.org/gdal/wiki/rfc68_cplusplus11
>>
>>> > > >
>>
>>> > > > There was initial discussions back in January of this year:
>>
>>> > > >
>>
>>> > > >  
>>> https://lists.osgeo.org/pipermail/gdal-dev/2017January/thread.html#45786
>>
>>> >
>>
>>> > > > Cheers,
>>
>>> > > > -kurt
>>
>>> > > > Engineer at Google
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170906/cbb0e7b0/attachment-0001.html>

From mateusz at loskot.net  Wed Sep  6 10:33:06 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed, 6 Sep 2017 19:33:06 +0200
Subject: [gdal-dev] RFC68: C++11 compilation mode - Call for vote on
	adoption
In-Reply-To: <2102373.pfxVO0sF5I@even-i700>
References: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
 <CACJ51z1+n8-yk==Y0RLe5sBe+9LmMBuB21cojL6f=zOmn=EfmQ@mail.gmail.com>
 <CABUeae_6-ooKnT6=eZ-jWAyPSwVhV8YOWZgn+4X4YzEcV-O6ig@mail.gmail.com>
 <2102373.pfxVO0sF5I@even-i700>
Message-ID: <CABUeae9NqRZzNtxMb0eWjPJt98dnbuUDu0ExNQs-1xFKiGJToQ@mail.gmail.com>

On 6 September 2017 at 19:11, Even Rouault <even.rouault at spatialys.com> wrote:
> On mercredi 6 septembre 2017 19:04:34 CEST Mateusz Loskot wrote:
>> On 6 September 2017 at 18:58, Andrew Bell <andrew.bell.ia at gmail.com> wrote:
>> > On Wed, Sep 6, 2017 at 12:14 PM, Kurt Schwehr <schwehr at gmail.com> wrote:
>
>> >> Now that Tamas has added the msvc2015/2-17SDK's, I'd like to call a
>> >> vote
>
>> >> by the PSC on RFC68: C++11 compilation mode.
>
>> >>
>
>> >> The draft is here:
>
>> >> https://trac.osgeo.org/gdal/wiki/rfc68_cplusplus11
>
>> >
>
>> > I'm late to the party, but I guess I don't understand a few things in
>> > the
>
>> > RFC.
>
>> >
>
>> > In Plan: If c++11 mode is enabled, won't ALL code need to be C++11
>
>> > compliant, rather than just new code?
>
>>
>
>> Any existing code which does not compile as C++11 will have to be updated.
>
>
>
> This is mostly a theoretical case. We have buildbots that compile in C++11
> and ran tests for a couple of years now (and one in C++14). And by default
> (since GDAL 2.2 I think) ./configure already enables C++11 on all C++11
> capable compilers.

Yes, indeed.

I gave a 'generic' answer.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From mateusz at loskot.net  Wed Sep  6 10:34:06 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed, 6 Sep 2017 19:34:06 +0200
Subject: [gdal-dev] RFC68: C++11 compilation mode - Call for vote on
	adoption
In-Reply-To: <op.y55l5rzbdbaoe8@macmarilu>
References: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
 <op.y55l5rzbdbaoe8@macmarilu>
Message-ID: <CABUeae8W=f_bBVCpDk-sKm69Cn8_iBzELF4Gsjffh8iorNkCPQ@mail.gmail.com>

On 6 September 2017 at 19:14, Joaquim Luis <jluis at ualg.pt> wrote:
> Wait, does this means that VS2013 will no longer be supported?

With respect, Kurt has been asking for comments for very long time.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From bishop.dev at gmail.com  Wed Sep  6 11:16:46 2017
From: bishop.dev at gmail.com (Dmitry Baryshnikov)
Date: Wed, 6 Sep 2017 21:16:46 +0300
Subject: [gdal-dev] git(hub) migration ?
In-Reply-To: <5104617.fMlcYK0Juz@even-i700>
References: <5104617.fMlcYK0Juz@even-i700>
Message-ID: <0860edd9-b8e7-c496-f60c-c1bbe1dbe54f@gmail.com>

Hi Even,

I think this is great proposal. Github is modern tool for develop, code 
review and test software.

I like idea to migrate code and tickets (3). Not sure we need to migrate 
closed tickets. Also it worth thinking to migrate only the 2.x code 
tree. There are not so many releases in 2.x, so branches can be convert 
to tags manually.

Anyhow you made me thinking about this.
By the way this work may be the subject of GSoC 2018 (not sure if this 
allowed by program).

Best regards,
     Dmitry

06.09.17 16:14, Even Rouault пишет:
> Hi,
>
> I've heard a few voices speaking/asking/begging for a git/github migration. At some point
> we'll certainly have to do it, as SVN vs git is beginning to feel more and more like CVS vs SVN
> 15 years ago.
>
> I can see different options :
>
> 1) migrate to git, and remain within the OSGeo infrastructure. This is for example the case of
> GEOS which uses the Trac git plugin and the GOGS (or is gitea?) git hosting (https://
> git.osgeo.org/gogs/geos/geos.git). gogs/gitea tries to replicate most github functionalities,
> but feature parity is still not there (you cannot comment on a commit e.g). We could still
> offer github as a mirror, which would ease contributions a bit compared to the current git-
>> svn situation, but the "Merge" button from github couldn't (shouldn't) be used.
> 2) migrate code to github, accept pull requests (PR) directly there. Tickets still managed in
> Trac. But then we have no automated link between Trac and github (unless there's a Trac
> plugin for that). A few other OSGeo projects are in a similar situation: QGIS with Redmine for
> tickets and github for PR&code, GeoServer with JIRA for tickets and github for PR&code. I've
> some experience with the QGIS situation: Redmine can include github commit references if
> the git commit message includes the ticket number. But, of course, the other way doesn't
> work: from github UI, the #XXXX link doesn't work (or would point to a unrelated PR with
> same number). So this is middly satisfactory, and a regression from our current situation.
>
> 3) migrate code and tickets to github. I guess this would match most (especially occasional)
> contributor wishes regarding the "social" aspect. What would be needed is Trac -> github
> ticket migration. Thomas Bonfort did it for MapServer at some point, but he lost the script if I
> remember well (I can see in https://stackoverflow.com/questions/6671584/how-to-export-trac-to-github-issues a number of possibilities listed). One issue also is we have numbers
> taken by existing github pull requests, so there would be collisions on import (we could
> decide either to sacrifice colliding Trac tickets, as there are really old, currently the colision
> appear for tickets older than 2003, or move them to an available github ticket number. Or to
> sacrifice existing PR, but there are a few pending ones)
> There's also the valid concern about being tied with github.com regarding tickets. Recently I
> found https://github.com/josegonzalez/python-github-backup
> which can backup code, issues, pull requests, etc.. using the github API.
> Quickly tested it on their own repo. Seems to work (**), although a bit slow ( requires 2 GET
> per issue / pull request to retrieve extra details that are not retrieved by the global request
> you showed above). It has an incremental mode though which should make it efficient.
>
> My synthetic view of the situation:
> 1) is a pure free sofware & free hosting approach. Relies on SAC being appropriately man and
> machine powered (same as with SVN / Trac currently)
> 2) mixed solution. we still have ownership on all our data (code & tickets). but the separation
> between a ticket system and code+PR isn't ideal from a usability point of view
> 3) offers probably the best contributor experience. We loose a bit of control, but a backup(*)
> strategy exists (at least for now). I'd tend to favor this approach.
>
> I'm not sure if the current git mirror shouldn't be re-done from scratch. Its main drawback is
> that svn tags are reported as git branches, instead of git tags. I probably mis-configured
> things when I initiated the mirror a few years ago. Not completely sure this is worth the
> effort though. We can probably live with those existing mis-created tags, and use proper git
> tags for the future.
>
> The release procedure / script would also have to be updated. Probably other things too.
>
> There's also the question of the Trac Wiki, although this one might be defered for a later
> stage.
>
> So this email is mostly to say I'm open to the idea, but I'd appreciate if someone else could
> take the lead on this. I'd be happy to help. A RFC to formalize the move would be needed.
>
> Even
>
> (*) Backup might not be the inappropriate term, since this implies that you can easily restore
> things. If github closes or requires (insane) fees for open source projects, those saved tickets
> will have to be re-injected in some to-be-defined alternative, but at least their content is
> readable (json)
>
> (**) steps:
> 1) pip install github-backup
> 2) in github UI, create a personnal access token, so as to be able to use authenticated
> requests to github API, to bypass the rate limit of unauthenticated requests (you can use it
> even for repositories that you don't own)
> 3) github-backup -i -R python-github-backup josegonzalez --issues --issue-comments --issue-
> events --pulls --pull-comments --pull-commits -t ${your_github_token}
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170906/9c94d579/attachment.html>

From jluis at ualg.pt  Wed Sep  6 11:18:30 2017
From: jluis at ualg.pt (Joaquim Luis)
Date: Wed, 06 Sep 2017 19:18:30 +0100
Subject: [gdal-dev] RFC68: C++11 compilation mode - Call for vote on
 adoption
In-Reply-To: <CABUeae8W=f_bBVCpDk-sKm69Cn8_iBzELF4Gsjffh8iorNkCPQ@mail.gmail.com>
References: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
 <op.y55l5rzbdbaoe8@macmarilu>
 <CABUeae8W=f_bBVCpDk-sKm69Cn8_iBzELF4Gsjffh8iorNkCPQ@mail.gmail.com>
Message-ID: <op.y55o44kbdbaoe8@macmarilu>

On Wed, 06 Sep 2017 18:34:06 +0100, Mateusz Loskot <mateusz at loskot.net>  
wrote:

> On 6 September 2017 at 19:14, Joaquim Luis <jluis at ualg.pt> wrote:
>> Wait, does this means that VS2013 will no longer be supported?
>
> With respect, Kurt has been asking for comments for very long time.
>
> Best regards,

Yes that's true, but always understood that VS2013 would be the minimum.

From bishop.dev at gmail.com  Wed Sep  6 11:21:14 2017
From: bishop.dev at gmail.com (Dmitry Baryshnikov)
Date: Wed, 6 Sep 2017 21:21:14 +0300
Subject: [gdal-dev] RFC68: C++11 compilation mode - Call for vote on
 adoption
In-Reply-To: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
References: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
Message-ID: <bc0434a3-6b8a-70f6-e807-c58f1da57b1b@gmail.com>

Hi,

I'm not a PSC member, but like to note the great work Kurt has done on 
C++11 compilation mode.

I strongly support this RFC.

Best regards,
     Dmitry

06.09.17 19:14, Kurt Schwehr пишет:
> Now that Tamas has added the msvc2015/2-17SDK's, I'd like to call a vote by
> the PSC on RFC68: C++11 compilation mode.
>
> The draft is here:
>
>   https://trac.osgeo.org/gdal/wiki/rfc68_cplusplus11
>
> -Kurt
>
>
>>> Hi Even,
>>> The new SDK-s have now been added.
>>> Best regards,
>>> Tamas
>>> 2017-08-29 15:18 GMT+02:00 Tamas Szekeres <szekerest at gmail.com>:
>>>> Hi Even,
>>>> Yes, I'm planning to include msvc2015/2017 versions shortly.
>>>> Best regards,
>>>> Tamas
>>>> 2017. aug. 14. dátummal, 19:02 időpontban Even Rouault <
>>>> even.rouault at spatialys.com> írta:
>>>>> Hi Tamas,
>>>>> Unless I'm mistaken your gisinternals.com builds don't include MSVC
>>>> 2015 currently. Right ? Do you have any plans to do so ? Currently the
>>>> GDAL
>>>> AppVeyor target uses SDKSs from gisinternals to do builds with a
>> number of
>>
>>>> third-party libraries.
>>>>> Even
>>>>>> This is a call for discussion on RFC68 to set C++11 to be the
>> minimum
>>
>>>> C++
>>>>>> language version for GDAL trunk. I've drafted the RFC based on
>> work by
>>
>>>>>> Mateusz.
>>>>>> https://trac.osgeo.org/gdal/wiki/rfc68_cplusplus11
>>>>>> There was initial discussions back in January of this year:
>> https://lists.osgeo.org/pipermail/gdal-dev/2017January/thread.html#45786
>>
>>>>>> Cheers,
>>>>>> -kurt
>>>>>> Engineer at Google
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170906/19616c8f/attachment-0001.html>

From mateusz at loskot.net  Wed Sep  6 11:23:19 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed, 6 Sep 2017 20:23:19 +0200
Subject: [gdal-dev] RFC68: C++11 compilation mode - Call for vote on
	adoption
In-Reply-To: <op.y55o44kbdbaoe8@macmarilu>
References: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
 <op.y55l5rzbdbaoe8@macmarilu>
 <CABUeae8W=f_bBVCpDk-sKm69Cn8_iBzELF4Gsjffh8iorNkCPQ@mail.gmail.com>
 <op.y55o44kbdbaoe8@macmarilu>
Message-ID: <CABUeae_R=veCYmiDc3ng+FHDdjXwY2=u6zh-b3GYCk=1j5Jhqg@mail.gmail.com>

On 6 September 2017 at 20:18, Joaquim Luis <jluis at ualg.pt> wrote:
> On Wed, 06 Sep 2017 18:34:06 +0100, Mateusz Loskot <mateusz at loskot.net> wrote:
>> On 6 September 2017 at 19:14, Joaquim Luis <jluis at ualg.pt> wrote:
>>>
>>> Wait, does this means that VS2013 will no longer be supported?
>>
>> With respect, Kurt has been asking for comments for very long time.
>
> Yes that's true, but always understood that VS2013 would be the minimum.

Kurt posted [1] updated RFC 68 three weeks ago.
It would be enough to have a glance to see VS2015.

[1] https://lists.osgeo.org/pipermail/gdal-dev/2017-August/046951.html

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From mateusz at loskot.net  Wed Sep  6 11:36:13 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed, 6 Sep 2017 20:36:13 +0200
Subject: [gdal-dev] git(hub) migration ?
In-Reply-To: <5104617.fMlcYK0Juz@even-i700>
References: <5104617.fMlcYK0Juz@even-i700>
Message-ID: <CABUeae9M1djnn24Oa3UWc_xeju-L5mOZL3Mmv44ZfGYH=x5LPw@mail.gmail.com>

On 6 September 2017 at 15:14, Even Rouault <even.rouault at spatialys.com> wrote:
> Hi,
>
> I've heard a few voices speaking/asking/begging for a git/github migration.
> At some point we'll certainly have to do it, as SVN vs git is beginning to
> feel more and more like CVS vs SVN 15 years ago.
>
> I can see different options :
> [...]
>
> 3) migrate code and tickets to github. I guess this would match most
> (especially occasional) contributor wishes regarding the "social" aspect.
> What would be needed is Trac -> github ticket migration. Thomas Bonfort did
> it for MapServer at some point, but he lost the script if I remember well (I
> can see in
> https://stackoverflow.com/questions/6671584/how-to-export-trac-to-github-issues
> a number of possibilities listed). One issue also is we have numbers taken
> by existing github pull requests, so there would be collisions on import (we
> could decide either to sacrifice colliding Trac tickets, as there are really
> old, currently the colision appear for tickets older than 2003, or move them
> to an available github ticket number. Or to sacrifice existing PR, but there
> are a few pending ones)
>
> There's also the valid concern about being tied with github.com regarding
> tickets. Recently I found
> https://github.com/josegonzalez/python-github-backup
>
> which can backup code, issues, pull requests, etc.. using the github API.
>
>
> My synthetic view of the situation:
> [...]
> 3) offers probably the best contributor experience. We loose a bit of
> control, but a backup(*) strategy exists (at least for now). I'd tend to
> favor this approach.


As member of the development team, I'm very much support this motion
and move to GitHub.


> So this email is mostly to say I'm open to the idea, but I'd appreciate if
> someone else could take the lead on this. I'd be happy to help. A RFC to
> formalize the move would be needed.

If no one offers her/him-self to do it earlier, I am willing to offer myself to
migrate GDAL to GitHub in mid October.

Then, I will prepare RFC, ask for comments and voting,
develop Trac to GitHub workflow using existing tools and/or custom
scripting in Python,
test with sandbox mirror and push final migration.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From even.rouault at spatialys.com  Wed Sep  6 11:40:23 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 06 Sep 2017 20:40:23 +0200
Subject: [gdal-dev] git(hub) migration ?
In-Reply-To: <0860edd9-b8e7-c496-f60c-c1bbe1dbe54f@gmail.com>
References: <5104617.fMlcYK0Juz@even-i700>
 <0860edd9-b8e7-c496-f60c-c1bbe1dbe54f@gmail.com>
Message-ID: <6620822.IXWS0tn4ot@even-i700>

On mercredi 6 septembre 2017 21:16:46 CEST Dmitry Baryshnikov wrote:
> Hi Even,
> 
> I think this is great proposal. Github is modern tool for develop, code
> review and test software.
> 
> I like idea to migrate code and tickets (3). Not sure we need to migrate
> closed tickets.

I'd wish closed tickets to be migrated as well (I don't think this is more complicated to 
migrate both opened+closed tickets than just opened tickets). More than once I had to "svn 
blame" and was happy to be able to find a reference to a >10 year old ticket that gives some 
context for a change. Tickets are true assets of a project (at least for the developpers) (I was 
thinking to suggest the "fossil" SCM (*) which has the big advantage of including tickets in 
the repository, but of course we would miss the increased social collaboration aspect with 
such a choice :-))

> Also it worth thinking to migrate only the 2.x code
> tree.

I'd like the whole history to be preserved in the migration.

> There are not so many releases in 2.x, so branches can be convert
> to tags manually.

We could indeed probably create the tags manually without recreating the whole clone.

> 
> Anyhow you made me thinking about this.
> By the way this work may be the subject of GSoC 2018 (not sure if this
> allowed by program).

I don't think that would be appropriate for GSoc which requires coding for a project. 
Infrastructure work like this is not allowed AFAIK.

Even


(*) https://www.fossil-scm.org/xfer/doc/trunk/www/index.wiki

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170906/1d2b3964/attachment.html>

From schwehr at gmail.com  Wed Sep  6 11:46:03 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Wed, 6 Sep 2017 11:46:03 -0700
Subject: [gdal-dev] RFC68: C++11 compilation mode - Call for vote on
	adoption
In-Reply-To: <CABUeae_R=veCYmiDc3ng+FHDdjXwY2=u6zh-b3GYCk=1j5Jhqg@mail.gmail.com>
References: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
 <op.y55l5rzbdbaoe8@macmarilu>
 <CABUeae8W=f_bBVCpDk-sKm69Cn8_iBzELF4Gsjffh8iorNkCPQ@mail.gmail.com>
 <op.y55o44kbdbaoe8@macmarilu>
 <CABUeae_R=veCYmiDc3ng+FHDdjXwY2=u6zh-b3GYCk=1j5Jhqg@mail.gmail.com>
Message-ID: <CACmBxytcA-2nA+O96=mBBeF=JRo0ofY8n6tGfrf1CCqY62zaEw@mail.gmail.com>

Joaquim,

Please give it another go at explaining what this use case is and the
issues with it.  I didn't follow your comments about the need for VS2013.
If users are on a legacy compiler (w.r.t. to C++11), can they not be served
by the 2.2 branch?  How does that use case fair with the impending GEOS
3.7.0 requiring a minimum of C++11?

Thanks,
-kurt

P.S. Doesn't really matter, but here is where I upped the version for VS on
Aug 14 after some discussion with Even:

https://trac.osgeo.org/gdal/wiki/rfc68_cplusplus11?action=diff&version=9&old_version=8


On Wed, Sep 6, 2017 at 11:23 AM, Mateusz Loskot <mateusz at loskot.net> wrote:

> On 6 September 2017 at 20:18, Joaquim Luis <jluis at ualg.pt> wrote:
> > On Wed, 06 Sep 2017 18:34:06 +0100, Mateusz Loskot <mateusz at loskot.net>
> wrote:
> >> On 6 September 2017 at 19:14, Joaquim Luis <jluis at ualg.pt> wrote:
> >>>
> >>> Wait, does this means that VS2013 will no longer be supported?
> >>
> >> With respect, Kurt has been asking for comments for very long time.
> >
> > Yes that's true, but always understood that VS2013 would be the minimum.
>
> Kurt posted [1] updated RFC 68 three weeks ago.
> It would be enough to have a glance to see VS2015.
>
> [1] https://lists.osgeo.org/pipermail/gdal-dev/2017-August/046951.html
>
> Best regards,
> --
> Mateusz Loskot, http://mateusz.loskot.net
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170906/22cfffdc/attachment.html>

From szekerest at gmail.com  Wed Sep  6 11:54:03 2017
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed, 6 Sep 2017 20:54:03 +0200
Subject: [gdal-dev] git(hub) migration ?
In-Reply-To: <5104617.fMlcYK0Juz@even-i700>
References: <5104617.fMlcYK0Juz@even-i700>
Message-ID: <CACALY+QoE55CU=9g_=0A5irGFEb845nRgOzaup4=tPSghmK3rQ@mail.gmail.com>

I would also prefer to go for #3 if possible, though I don't have enough
experience how to make it happen.

Best regards,

Tamas


2017-09-06 15:14 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:

> Hi,
>
>
>
> I've heard a few voices speaking/asking/begging for a git/github
> migration. At some point we'll certainly have to do it, as SVN vs git is
> beginning to feel more and more like CVS vs SVN 15 years ago.
>
>
>
> I can see different options :
>
>
>
> 1) migrate to git, and remain within the OSGeo infrastructure. This is for
> example the case of GEOS which uses the Trac git plugin and the GOGS (or is
> gitea?) git hosting (https://git.osgeo.org/gogs/geos/geos.git).
> gogs/gitea tries to replicate most github functionalities, but feature
> parity is still not there (you cannot comment on a commit e.g). We could
> still offer github as a mirror, which would ease contributions a bit
> compared to the current git->svn situation, but the "Merge" button from
> github couldn't (shouldn't) be used.
>
>
>
> 2) migrate code to github, accept pull requests (PR) directly there.
> Tickets still managed in Trac. But then we have no automated link between
> Trac and github (unless there's a Trac plugin for that). A few other OSGeo
> projects are in a similar situation: QGIS with Redmine for tickets and
> github for PR&code, GeoServer with JIRA for tickets and github for PR&code.
> I've some experience with the QGIS situation: Redmine can include github
> commit references if the git commit message includes the ticket number.
> But, of course, the other way doesn't work: from github UI, the #XXXX link
> doesn't work (or would point to a unrelated PR with same number). So this
> is middly satisfactory, and a regression from our current situation.
>
>
>
> 3) migrate code and tickets to github. I guess this would match most
> (especially occasional) contributor wishes regarding the "social" aspect.
> What would be needed is Trac -> github ticket migration. Thomas Bonfort did
> it for MapServer at some point, but he lost the script if I remember well
> (I can see in https://stackoverflow.com/questions/6671584/how-to-
> export-trac-to-github-issues a number of possibilities listed). One issue
> also is we have numbers taken by existing github pull requests, so there
> would be collisions on import (we could decide either to sacrifice
> colliding Trac tickets, as there are really old, currently the colision
> appear for tickets older than 2003, or move them to an available github
> ticket number. Or to sacrifice existing PR, but there are a few pending
> ones)
>
> There's also the valid concern about being tied with github.com regarding
> tickets. Recently I found https://github.com/josegonzalez/python-github-
> backup
>
> which can backup code, issues, pull requests, etc.. using the github API.
>
> Quickly tested it on their own repo. Seems to work (**), although a bit
> slow ( requires 2 GET per issue / pull request to retrieve extra details
> that are not retrieved by the global request you showed above). It has an
> incremental mode though which should make it efficient.
>
>
>
> My synthetic view of the situation:
>
> 1) is a pure free sofware & free hosting approach. Relies on SAC being
> appropriately man and machine powered (same as with SVN / Trac currently)
>
> 2) mixed solution. we still have ownership on all our data (code &
> tickets). but the separation between a ticket system and code+PR isn't
> ideal from a usability point of view
>
> 3) offers probably the best contributor experience. We loose a bit of
> control, but a backup(*) strategy exists (at least for now). I'd tend to
> favor this approach.
>
>
>
> I'm not sure if the current git mirror shouldn't be re-done from scratch.
> Its main drawback is that svn tags are reported as git branches, instead of
> git tags. I probably mis-configured things when I initiated the mirror a
> few years ago. Not completely sure this is worth the effort though. We can
> probably live with those existing mis-created tags, and use proper git tags
> for the future.
>
>
>
> The release procedure / script would also have to be updated. Probably
> other things too.
>
>
>
> There's also the question of the Trac Wiki, although this one might be
> defered for a later stage.
>
>
>
> So this email is mostly to say I'm open to the idea, but I'd appreciate if
> someone else could take the lead on this. I'd be happy to help. A RFC to
> formalize the move would be needed.
>
>
>
> Even
>
>
>
> (*) Backup might not be the inappropriate term, since this implies that
> you can easily restore things. If github closes or requires (insane) fees
> for open source projects, those saved tickets will have to be re-injected
> in some to-be-defined alternative, but at least their content is readable
> (json)
>
>
>
> (**) steps:
>
> 1) pip install github-backup
>
> 2) in github UI, create a personnal access token, so as to be able to use
> authenticated requests to github API, to bypass the rate limit of
> unauthenticated requests (you can use it even for repositories that you
> don't own)
>
> 3) github-backup -i -R python-github-backup josegonzalez --issues
> --issue-comments --issue-events --pulls --pull-comments --pull-commits -t
> ${your_github_token}
>
>
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170906/863dfaea/attachment-0001.html>

From jluis at ualg.pt  Wed Sep  6 12:21:24 2017
From: jluis at ualg.pt (Joaquim Luis)
Date: Wed, 06 Sep 2017 20:21:24 +0100
Subject: [gdal-dev] RFC68: C++11 compilation mode - Call for vote on
 adoption
In-Reply-To: <CACmBxytcA-2nA+O96=mBBeF=JRo0ofY8n6tGfrf1CCqY62zaEw@mail.gmail.com>
References: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
 <op.y55l5rzbdbaoe8@macmarilu>
 <CABUeae8W=f_bBVCpDk-sKm69Cn8_iBzELF4Gsjffh8iorNkCPQ@mail.gmail.com>
 <op.y55o44kbdbaoe8@macmarilu>
 <CABUeae_R=veCYmiDc3ng+FHDdjXwY2=u6zh-b3GYCk=1j5Jhqg@mail.gmail.com>
 <CACmBxytcA-2nA+O96=mBBeF=JRo0ofY8n6tGfrf1CCqY62zaEw@mail.gmail.com>
Message-ID: <op.y55r1yqndbaoe8@macmarilu>

Kurt,

The Tamas SDKs are not enough as to provide all the dependencies to a GDAL  
Win installation. It miss all those dlls (didn't check if the list is  
complete) that the VS2015/17 builds now depend on. So if one wants to  
distribute a program that depends on GDAL (GMT, in y case) that long list  
of dlls must be supplied as well or otherwise tell users that they have to  
install a MS distributable package.

Not a killer feature but annoying certainly.

Yes, if one remains at GDAL <= 2.2 this issue does not exist.
I'm not building GDAL against GEOS so didn't know about it C++11  
requirement.

Side and non relevant info, 3 weeks ago I was at the Southern Hemisphere.


Joaquim

api-ms-win-core-console-l1-1-0.dll
api-ms-win-core-datetime-l1-1-0.dll
api-ms-win-core-debug-l1-1-0.dll
api-ms-win-core-errorhandling-l1-1-0.dll
api-ms-win-core-file-l1-1-0.dll
api-ms-win-core-file-l1-2-0.dll
api-ms-win-core-file-l2-1-0.dll
api-ms-win-core-handle-l1-1-0.dll
api-ms-win-core-heap-l1-1-0.dll
api-ms-win-core-interlocked-l1-1-0.dll
api-ms-win-core-libraryloader-l1-1-0.dll
api-ms-win-core-localization-l1-2-0.dll
api-ms-win-core-memory-l1-1-0.dll
api-ms-win-core-namedpipe-l1-1-0.dll
api-ms-win-core-processenvironment-l1-1-0.dll
api-ms-win-core-processthreads-l1-1-0.dll
api-ms-win-core-processthreads-l1-1-1.dll
api-ms-win-core-profile-l1-1-0.dll
api-ms-win-core-rtlsupport-l1-1-0.dll
api-ms-win-core-string-l1-1-0.dll
api-ms-win-core-synch-l1-1-0.dll
api-ms-win-core-synch-l1-2-0.dll
api-ms-win-core-sysinfo-l1-1-0.dll
api-ms-win-core-timezone-l1-1-0.dll
api-ms-win-core-util-l1-1-0.dll
api-ms-win-crt-conio-l1-1-0.dll
api-ms-win-crt-convert-l1-1-0.dll
api-ms-win-crt-environment-l1-1-0.dll
api-ms-win-crt-filesystem-l1-1-0.dll
api-ms-win-crt-heap-l1-1-0.dll
api-ms-win-crt-locale-l1-1-0.dll
api-ms-win-crt-math-l1-1-0.dll
api-ms-win-crt-multibyte-l1-1-0.dll
api-ms-win-crt-private-l1-1-0.dll
api-ms-win-crt-process-l1-1-0.dll
api-ms-win-crt-runtime-l1-1-0.dll
api-ms-win-crt-stdio-l1-1-0.dll
api-ms-win-crt-string-l1-1-0.dll
api-ms-win-crt-time-l1-1-0.dll
api-ms-win-crt-utility-l1-1-0.dll


> Joaquim,
>
> Please give it another go at explaining what this use case is and the  
> issues with it.  I didn't follow your comments about the need for  
> VS2013.  If users >are on a legacy compiler (w.r.t. to C++11), can they  
> not be served by the 2.2 branch?  How does that use case fair with the  
> impending GEOS 3.7.0 >requiring a minimum of C++11?
>
> Thanks,
> -kurt
>
> P.S. Doesn't really matter, but here is where I upped the version for VS  
> on Aug 14 after some discussion with Even:
>
> https://trac.osgeo.org/gdal/wiki/rfc68_cplusplus11?action=diff&version=9&old_version=8
>
>
> On Wed, Sep 6, 2017 at 11:23 AM, Mateusz Loskot <mateusz at loskot.net>  
> wrote:
>> On 6 September 2017 at 20:18, Joaquim Luis <jluis at ualg.pt> wrote:
>>> On Wed, 06 Sep 2017 18:34:06 +0100, Mateusz Loskot  
>>> <mateusz at loskot.net> wrote:
>>>> On 6 September 2017 at 19:14, Joaquim Luis <jluis at ualg.pt> wrote:
>>>>>
>>>>> Wait, does this means that VS2013 will no longer be supported?
>>>>
>>>> With respect, Kurt has been asking for comments for very long time.
>>>
>>> Yes that's true, but always understood that VS2013 would be the  
>>> minimum.
>>
>> Kurt posted [1] updated RFC 68 three weeks ago.
>> It would be enough to have a glance to see VS2015.
>>
>> [1] https://lists.osgeo.org/pipermail/gdal-dev/2017-August/046951.html
>>
>> Best regards,
>> --
>> Mateusz Loskot, http://mateusz.loskot.net
>
>
>
> ----
> http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170906/e1f60cdb/attachment.html>

From mateusz at loskot.net  Wed Sep  6 12:48:11 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed, 6 Sep 2017 21:48:11 +0200
Subject: [gdal-dev] RFC68: C++11 compilation mode - Call for vote on
	adoption
In-Reply-To: <op.y55r1yqndbaoe8@macmarilu>
References: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
 <op.y55l5rzbdbaoe8@macmarilu>
 <CABUeae8W=f_bBVCpDk-sKm69Cn8_iBzELF4Gsjffh8iorNkCPQ@mail.gmail.com>
 <op.y55o44kbdbaoe8@macmarilu>
 <CABUeae_R=veCYmiDc3ng+FHDdjXwY2=u6zh-b3GYCk=1j5Jhqg@mail.gmail.com>
 <CACmBxytcA-2nA+O96=mBBeF=JRo0ofY8n6tGfrf1CCqY62zaEw@mail.gmail.com>
 <op.y55r1yqndbaoe8@macmarilu>
Message-ID: <CABUeae-pq3ViySUOnCr_FPqJb+70af0kYrGhL96Kk89UwrJ9LA@mail.gmail.com>

On 6 September 2017 at 21:21, Joaquim Luis <jluis at ualg.pt> wrote:
> Kurt,
>
> The Tamas SDKs are not enough as to provide all the dependencies to a GDAL
> Win installation. It miss all those dlls (didn't check if the list is
> complete) that the VS2015/17 builds now depend on. So if one wants to
> distribute a program that depends on GDAL (GMT, in y case) that long list of
> dlls must be supplied as well or otherwise tell users that they have to
> install a MS distributable package.
>
> Not a killer feature but annoying certainly.
>
> Yes, if one remains at GDAL <= 2.2 this issue does not exist.
> I'm not building GDAL against GEOS so didn't know about it C++11
> requirement.
>
> Side and non relevant info, 3 weeks ago I was at the Southern Hemisphere.
>
>
> Joaquim
>
> api-ms-win-core-console-l1-1-0.dll
> api-ms-win-core-datetime-l1-1-0.dll
> api-ms-win-core-debug-l1-1-0.dll
> [...]

Those belong to Windows Universal Windows Platform API.
Those are NOT required by any C/C++ native classic software
developed for Windows using VS2015/2017.
Check [2] for details.

I suggest you do a test: install Python 3.6.2 or later (built using VS2015)
on Windows w/o VS2015/2017 and check what VC++ CRT DLLs it deploys.

[1] https://en.wikipedia.org/wiki/Universal_Windows_Platform
[2] https://www.visualstudio.com/en-us/productinfo/vs2017-compatibility-vs

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From schwehr at gmail.com  Wed Sep  6 12:53:09 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Wed, 6 Sep 2017 12:53:09 -0700
Subject: [gdal-dev] RFC68: C++11 compilation mode - Call for vote on
	adoption
In-Reply-To: <CABUeae-pq3ViySUOnCr_FPqJb+70af0kYrGhL96Kk89UwrJ9LA@mail.gmail.com>
References: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
 <op.y55l5rzbdbaoe8@macmarilu>
 <CABUeae8W=f_bBVCpDk-sKm69Cn8_iBzELF4Gsjffh8iorNkCPQ@mail.gmail.com>
 <op.y55o44kbdbaoe8@macmarilu>
 <CABUeae_R=veCYmiDc3ng+FHDdjXwY2=u6zh-b3GYCk=1j5Jhqg@mail.gmail.com>
 <CACmBxytcA-2nA+O96=mBBeF=JRo0ofY8n6tGfrf1CCqY62zaEw@mail.gmail.com>
 <op.y55r1yqndbaoe8@macmarilu>
 <CABUeae-pq3ViySUOnCr_FPqJb+70af0kYrGhL96Kk89UwrJ9LA@mail.gmail.com>
Message-ID: <CACmBxyu_LcX6EnPw4yc9aKoQNMm-ubh_DfKJmQAZ1==x7Br=1A@mail.gmail.com>

I was just about to write something along the lines that follow, but
Mateusz looks to have more of an understanding.

My best guess was that it is an incomplete install of Windows?  e.g.

https://support.microsoft.com/en-us/help/2999226/update-for-universal-c-runtime-in-windows

I haven't done Windows dev since the late 90s, so it helps to lay out more
for me or I get lost.


On Wed, Sep 6, 2017 at 12:48 PM, Mateusz Loskot <mateusz at loskot.net> wrote:

> On 6 September 2017 at 21:21, Joaquim Luis <jluis at ualg.pt> wrote:
> > Kurt,
> >
> > The Tamas SDKs are not enough as to provide all the dependencies to a
> GDAL
> > Win installation. It miss all those dlls (didn't check if the list is
> > complete) that the VS2015/17 builds now depend on. So if one wants to
> > distribute a program that depends on GDAL (GMT, in y case) that long
> list of
> > dlls must be supplied as well or otherwise tell users that they have to
> > install a MS distributable package.
> >
> > Not a killer feature but annoying certainly.
> >
> > Yes, if one remains at GDAL <= 2.2 this issue does not exist.
> > I'm not building GDAL against GEOS so didn't know about it C++11
> > requirement.
> >
> > Side and non relevant info, 3 weeks ago I was at the Southern Hemisphere.
> >
> >
> > Joaquim
> >
> > api-ms-win-core-console-l1-1-0.dll
> > api-ms-win-core-datetime-l1-1-0.dll
> > api-ms-win-core-debug-l1-1-0.dll
> > [...]
>
> Those belong to Windows Universal Windows Platform API.
> Those are NOT required by any C/C++ native classic software
> developed for Windows using VS2015/2017.
> Check [2] for details.
>
> I suggest you do a test: install Python 3.6.2 or later (built using VS2015)
> on Windows w/o VS2015/2017 and check what VC++ CRT DLLs it deploys.
>
> [1] https://en.wikipedia.org/wiki/Universal_Windows_Platform
> [2] https://www.visualstudio.com/en-us/productinfo/vs2017-compatibility-vs
>
> Best regards,
> --
> Mateusz Loskot, http://mateusz.loskot.net
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170906/ec21a304/attachment.html>

From mateusz at loskot.net  Wed Sep  6 13:22:18 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed, 6 Sep 2017 22:22:18 +0200
Subject: [gdal-dev] RFC68: C++11 compilation mode - Call for vote on
	adoption
In-Reply-To: <CACmBxyu_LcX6EnPw4yc9aKoQNMm-ubh_DfKJmQAZ1==x7Br=1A@mail.gmail.com>
References: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
 <op.y55l5rzbdbaoe8@macmarilu>
 <CABUeae8W=f_bBVCpDk-sKm69Cn8_iBzELF4Gsjffh8iorNkCPQ@mail.gmail.com>
 <op.y55o44kbdbaoe8@macmarilu>
 <CABUeae_R=veCYmiDc3ng+FHDdjXwY2=u6zh-b3GYCk=1j5Jhqg@mail.gmail.com>
 <CACmBxytcA-2nA+O96=mBBeF=JRo0ofY8n6tGfrf1CCqY62zaEw@mail.gmail.com>
 <op.y55r1yqndbaoe8@macmarilu>
 <CABUeae-pq3ViySUOnCr_FPqJb+70af0kYrGhL96Kk89UwrJ9LA@mail.gmail.com>
 <CACmBxyu_LcX6EnPw4yc9aKoQNMm-ubh_DfKJmQAZ1==x7Br=1A@mail.gmail.com>
Message-ID: <CABUeae_bJ_EQ+iw=9xih-=c=Z6JXL2H3eCq4krj1ckn=M5VrwA@mail.gmail.com>

On 6 September 2017 at 21:53, Kurt Schwehr <schwehr at gmail.com> wrote:
> I was just about to write something along the lines that follow, but Mateusz
> looks to have more of an understanding.
>
> My best guess was that it is an incomplete install of Windows?  e.g.
>
> https://support.microsoft.com/en-us/help/2999226/update-for-universal-c-runtime-in-windows

Universal C Runtime and Universal Windows Platform are two different beasts.
Universal C Runtime is part of Windows 10+ system
Kurt's link above leads to installer of Universal CRT for older
Windows versions.

Here is into to Universal CRT
https://blogs.msdn.microsoft.com/vcblog/2015/03/03/introducing-the-universal-crt/

It is all related to the fact that VS2015 and VS2017 are binary compatible.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From luipir at gmail.com  Wed Sep  6 13:26:41 2017
From: luipir at gmail.com (Luigi Pirelli)
Date: Wed, 6 Sep 2017 22:26:41 +0200
Subject: [gdal-dev] git(hub) migration ?
In-Reply-To: <CABUeae9M1djnn24Oa3UWc_xeju-L5mOZL3Mmv44ZfGYH=x5LPw@mail.gmail.com>
References: <5104617.fMlcYK0Juz@even-i700>
 <CABUeae9M1djnn24Oa3UWc_xeju-L5mOZL3Mmv44ZfGYH=x5LPw@mail.gmail.com>
Message-ID: <CAFO80_pwTudB0=r-ynen5Qyj6xXdARmLyzACsWX++a0CApvmrQ@mail.gmail.com>

FYI in QGIS dev world we still not have found a clear and complete way
to migrate tracker from redmine to GH or GitLab.
More info and details can be asked to the key people that investigated
the problem... just asking in Dev list.

FYI we are still in a new updated redmine :/
Luigi Pirelli

**************************************************************************************************
* Boundless QGIS Support/Development: lpirelli AT boundlessgeo DOT com
* LinkedIn: https://www.linkedin.com/in/luigipirelli
* Stackexchange: http://gis.stackexchange.com/users/19667/luigi-pirelli
* GitHub: https://github.com/luipir
* Mastering QGIS 2nd Edition:
* https://www.packtpub.com/big-data-and-business-intelligence/mastering-qgis-second-edition
**************************************************************************************************


On 6 September 2017 at 20:36, Mateusz Loskot <mateusz at loskot.net> wrote:
> On 6 September 2017 at 15:14, Even Rouault <even.rouault at spatialys.com> wrote:
>> Hi,
>>
>> I've heard a few voices speaking/asking/begging for a git/github migration.
>> At some point we'll certainly have to do it, as SVN vs git is beginning to
>> feel more and more like CVS vs SVN 15 years ago.
>>
>> I can see different options :
>> [...]
>>
>> 3) migrate code and tickets to github. I guess this would match most
>> (especially occasional) contributor wishes regarding the "social" aspect.
>> What would be needed is Trac -> github ticket migration. Thomas Bonfort did
>> it for MapServer at some point, but he lost the script if I remember well (I
>> can see in
>> https://stackoverflow.com/questions/6671584/how-to-export-trac-to-github-issues
>> a number of possibilities listed). One issue also is we have numbers taken
>> by existing github pull requests, so there would be collisions on import (we
>> could decide either to sacrifice colliding Trac tickets, as there are really
>> old, currently the colision appear for tickets older than 2003, or move them
>> to an available github ticket number. Or to sacrifice existing PR, but there
>> are a few pending ones)
>>
>> There's also the valid concern about being tied with github.com regarding
>> tickets. Recently I found
>> https://github.com/josegonzalez/python-github-backup
>>
>> which can backup code, issues, pull requests, etc.. using the github API.
>>
>>
>> My synthetic view of the situation:
>> [...]
>> 3) offers probably the best contributor experience. We loose a bit of
>> control, but a backup(*) strategy exists (at least for now). I'd tend to
>> favor this approach.
>
>
> As member of the development team, I'm very much support this motion
> and move to GitHub.
>
>
>> So this email is mostly to say I'm open to the idea, but I'd appreciate if
>> someone else could take the lead on this. I'd be happy to help. A RFC to
>> formalize the move would be needed.
>
> If no one offers her/him-self to do it earlier, I am willing to offer myself to
> migrate GDAL to GitHub in mid October.
>
> Then, I will prepare RFC, ask for comments and voting,
> develop Trac to GitHub workflow using existing tools and/or custom
> scripting in Python,
> test with sandbox mirror and push final migration.
>
> Best regards,
> --
> Mateusz Loskot, http://mateusz.loskot.net
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From jluis at ualg.pt  Wed Sep  6 16:01:22 2017
From: jluis at ualg.pt (Joaquim Luis)
Date: Thu, 07 Sep 2017 00:01:22 +0100
Subject: [gdal-dev] RFC68: C++11 compilation mode - Call for vote on
 adoption
In-Reply-To: <CABUeae_bJ_EQ+iw=9xih-=c=Z6JXL2H3eCq4krj1ckn=M5VrwA@mail.gmail.com>
References: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
 <op.y55l5rzbdbaoe8@macmarilu>
 <CABUeae8W=f_bBVCpDk-sKm69Cn8_iBzELF4Gsjffh8iorNkCPQ@mail.gmail.com>
 <op.y55o44kbdbaoe8@macmarilu>
 <CABUeae_R=veCYmiDc3ng+FHDdjXwY2=u6zh-b3GYCk=1j5Jhqg@mail.gmail.com>
 <CACmBxytcA-2nA+O96=mBBeF=JRo0ofY8n6tGfrf1CCqY62zaEw@mail.gmail.com>
 <op.y55r1yqndbaoe8@macmarilu>
 <CABUeae-pq3ViySUOnCr_FPqJb+70af0kYrGhL96Kk89UwrJ9LA@mail.gmail.com>
 <CACmBxyu_LcX6EnPw4yc9aKoQNMm-ubh_DfKJmQAZ1==x7Br=1A@mail.gmail.com>
 <CABUeae_bJ_EQ+iw=9xih-=c=Z6JXL2H3eCq4krj1ckn=M5VrwA@mail.gmail.com>
Message-ID: <op.y5518krqdbaoe8@macmarilu>

On Wed, 06 Sep 2017 21:22:18 +0100, Mateusz Loskot <mateusz at loskot.net>  
wrote:

> On 6 September 2017 at 21:53, Kurt Schwehr <schwehr at gmail.com> wrote:
>> I was just about to write something along the lines that follow, but  
>> Mateusz
>> looks to have more of an understanding.
>>
>> My best guess was that it is an incomplete install of Windows?  e.g.
>>
>> https://support.microsoft.com/en-us/help/2999226/update-for-universal-c-runtime-in-windows
>
> Universal C Runtime and Universal Windows Platform are two different  
> beasts.
> Universal C Runtime is part of Windows 10+ system
> Kurt's link above leads to installer of Universal CRT for older
> Windows versions.
>
> Here is into to Universal CRT
> https://blogs.msdn.microsoft.com/vcblog/2015/03/03/introducing-the-universal-crt/
>
> It is all related to the fact that VS2015 and VS2017 are binary  
> compatible.


Well, this is in the minimum confusing and I may have been mislead by my  
TortoiseSVN installation that ships those dlls. The link says:

"If you build software designed for use on Windows operating systems where  
the Universal CRT is not guaranteed to be installed (i.e., Windows 8.1 and  
below), your software will need to depend on the above mentioned Windows  
Update packages to install the Universal CRT."

Which means that below Win10 they are nor guarantied to be installed

But I only find those DLLs in my system in (as also mentioned in that link)

C:\Program Files (x86)\Microsoft Visual Studio 14.0\VC
and
C:\Program Files (x86)\Windows Kits\10

as well as under

C:\Program Files (x86)\Mozilla Firefox

or

C:\programs\TortoiseSVN\bin

and Dependency Walker shows me that VCRUNTIME140.DLL depend on those dlls

From zac at weatherwary.com  Wed Sep  6 17:54:06 2017
From: zac at weatherwary.com (Zachary Flamig)
Date: Wed, 6 Sep 2017 21:54:06 -0300
Subject: [gdal-dev] Representing a grib file as a netCDF
In-Reply-To: <CAN_Dn-F9bMSW=f5XccWsdsc4VhMHr8MXawpdqxbncs==qA9c=A@mail.gmail.com>
References: <CAN_Dn-F9bMSW=f5XccWsdsc4VhMHr8MXawpdqxbncs==qA9c=A@mail.gmail.com>
Message-ID: <77FC5056-DD78-468C-A6D9-3327F0085F2D@weatherwary.com>

Hey Norman,

Interesting idea. I think it will be a little bit tricky because it is hard to uniquely label each band in a grib file.

I actually use a modified version of gdal_translate where I can specify the GRIB_ELEMENT, GRIB_SHORTNAME, and GRIB_FORECAST seconds that I want to match to extract specific bands. This lets me process similar grib files without having to map band numbers explicitly. I probably didn’t do this the best way, maybe it could use an SQL format like -where uses.

Just some quick thoughts,
Zac


> On Sep 6, 2017, at 10:39 AM, Norman Barker <norman.barker at gmail.com> wrote:
> 
> Hi,
> 
> I am currently working on representing a grib file as a netCDF file within GDAL. My plan is that if a user specifies the netCDF driver and opens a grib file then the metadata from the grib will be represented as a netCDF and the data can be read through that driver.
> 
> It may seem a bit odd since GDAL has a fully functional grib driver but it matches the use of the netCDF model when reading grib within most meteorological packages and enables me (and hopefully others) to match the metadata conventions in other packages.
> 
> Any feedback appreciated, I am working on this now and will have code for review shortly.
> 
> Thanks,
> 
> Norman
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


From mateusz at loskot.net  Wed Sep  6 22:47:40 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu, 7 Sep 2017 07:47:40 +0200
Subject: [gdal-dev] RFC68: C++11 compilation mode - Call for vote on
	adoption
In-Reply-To: <op.y5518krqdbaoe8@macmarilu>
References: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
 <op.y55l5rzbdbaoe8@macmarilu>
 <CABUeae8W=f_bBVCpDk-sKm69Cn8_iBzELF4Gsjffh8iorNkCPQ@mail.gmail.com>
 <op.y55o44kbdbaoe8@macmarilu>
 <CABUeae_R=veCYmiDc3ng+FHDdjXwY2=u6zh-b3GYCk=1j5Jhqg@mail.gmail.com>
 <CACmBxytcA-2nA+O96=mBBeF=JRo0ofY8n6tGfrf1CCqY62zaEw@mail.gmail.com>
 <op.y55r1yqndbaoe8@macmarilu>
 <CABUeae-pq3ViySUOnCr_FPqJb+70af0kYrGhL96Kk89UwrJ9LA@mail.gmail.com>
 <CACmBxyu_LcX6EnPw4yc9aKoQNMm-ubh_DfKJmQAZ1==x7Br=1A@mail.gmail.com>
 <CABUeae_bJ_EQ+iw=9xih-=c=Z6JXL2H3eCq4krj1ckn=M5VrwA@mail.gmail.com>
 <op.y5518krqdbaoe8@macmarilu>
Message-ID: <CABUeae-Jh-_uQ7f1Ki0qEpTsqsgQ8wfxFB0pivYRC8WYLLsAig@mail.gmail.com>

On 7 September 2017 at 01:01, Joaquim Luis <jluis at ualg.pt> wrote:
> On Wed, 06 Sep 2017 21:22:18 +0100, Mateusz Loskot <mateusz at loskot.net> wrote:
>> On 6 September 2017 at 21:53, Kurt Schwehr <schwehr at gmail.com> wrote:
>>>
>>> I was just about to write something along the lines that follow, but
>>> Mateusz
>>> looks to have more of an understanding.
>>>
>>> My best guess was that it is an incomplete install of Windows?  e.g.
>>>
>>>
>>> https://support.microsoft.com/en-us/help/2999226/update-for-universal-c-runtime-in-windows
>>
>>
>> Universal C Runtime and Universal Windows Platform are two different
>> beasts.
>> Universal C Runtime is part of Windows 10+ system
>> Kurt's link above leads to installer of Universal CRT for older
>> Windows versions.
>>
>> Here is into to Universal CRT
>>
>> https://blogs.msdn.microsoft.com/vcblog/2015/03/03/introducing-the-universal-crt/
>>
>> It is all related to the fact that VS2015 and VS2017 are binary
>> compatible.
>
>
>
> Well, this is in the minimum confusing and I may have been mislead by my
> TortoiseSVN installation that ships those dlls. The link says:
>
> "If you build software designed for use on Windows operating systems where
> the Universal CRT is not guaranteed to be installed (i.e., Windows 8.1 and
> below), your software will need to depend on the above mentioned Windows
> Update packages to install the Universal CRT."

Yes, it is confusing. I also completely ignored the fact that I'm on Windows 10.
where the Universal CRT is a system component, and since for others there is
system update, I assumed everyone with up-to-date older Windows system
has got that too.

The [1] says
"Microsoft Visual Studio 2015 creates a dependency on the Universal CRT when
applications are built by using the Windows 10 Software Development Kit (SDK). "

I'm not sure what if software is built w/ VS2015 using Windows SDK 8,
for example.

The [2] says more on upgrading to the Universal CRT.

James McNellis (Microsoft) explains in comments to [3]:

"One of the design goals for the Universal CRT was to produce a single
CRT that could run on all Windows platforms.
This includes ancient Windows platforms like Windows XP and recent
Windows platforms like Windows Phone or the Windows for IoT.
This is the reason that the numerous APISet forwarders (the
api-ms-win-*.dll DLLs) are required:
On legacy platforms like Windows XP, we need to depend on
kernel32.dll, whereas on “modern” platforms like Windows 10 we need to
depend on APISets"

I'd dare a suspicion that targetting Windows 8 SDK with VS2015 may not
require (some) those forwarders.


Finally, James McNellis explains in [3]:

"Updated September 11, 2015:
App-local deployment of the Universal CRT issupported.
To obtain the binaries for app-local deployment, install the Windows
Software Development Kit (SDK) for Windows 10.
The binaries will be installed to C:\Program Files (x86)\Windows
Kits\10\Redist\ucrt.
You will need to copy all of the DLLs with your app (note that the set
of DLLs are necessary is different on different versions of Windows,
so you must include all of the DLLs in order for your program to run
on all supported versions of Windows)."


AFAIU, Universal CRT must be installed as Windows Update.
Then, VCRedist package can be included in your installer from merge
modules (.msm).


My sincere apologies for confusion.

I always upgrade to latest Visual Studio + Windows as soon as they are
out, so I've been a bit of an ignorant.


[1] https://support.microsoft.com/en-us/help/2999226/update-for-universal-c-runtime-in-windows
[2] https://docs.microsoft.com/en-us/cpp/porting/upgrade-your-code-to-the-universal-crt
[3] https://blogs.msdn.microsoft.com/vcblog/2015/03/03/introducing-the-universal-crt/

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From jukka.rahkonen at maanmittauslaitos.fi  Wed Sep  6 23:38:21 2017
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Thu, 7 Sep 2017 06:38:21 +0000
Subject: [gdal-dev] How to read CSV with GeoJSON correctly?
Message-ID: <1504766318081.26029@maanmittauslaitos.fi>

Hi,

I was thinking about this question on gis.stackexchange https://gis.stackexchange.com/questions/254536/how-to-convert-txt-containing-two-columns-id-and-geojson-geometry

I copy-pasted the CSV example and edited it to use semicolon as field separator. Then I read http://www.gdal.org/drv_csv.html and had a try with ogrinfo 

ogrinfo geojson_csv.csv -al -oo GEOM_POSSIBLE_NAMES=geoJSON
INFO: Open of `geojson_csv.csv'
      using driver `CSV' successful.

Layer name: geojson_csv
Geometry: Unknown (any)
Feature Count: 1
Layer SRS WKT:
(unknown)
Geometry Column = geoJSON
Id: String (0.0)
geoJSON: String (0.0)
OGRFeature(geojson_csv):1
  Id (String) = 49518
  geoJSON (String) = {type:Polygon,coordinates:[[[29.9596,-2.3272],[29.9189,-2.7
9],[29.3706,-2.8401],[29.1497,-2.5917],[29.0405,-2.7447],[28.8619,-2.5309],[29.1
1,-1.8602],[29.3616,-1.5092],[29.8237,-1.3089],[29.9149,-1.4825],[30.0524,-1.431
,[30.8394,-1.6514],[30.8567,-2.3151],[30.1356,-2.4382],[29.9596,-2.3272]]]}

The GeoJSON geometry is not recognized but ogrinfo converts it into a string, with double quetes removed. Is there something wrong in the CSV or in my syntax?

-Jukka Rahkonen-

From ijturton at gmail.com  Thu Sep  7 01:45:29 2017
From: ijturton at gmail.com (Ian Turton)
Date: Thu, 7 Sep 2017 09:45:29 +0100
Subject: [gdal-dev] How to read CSV with GeoJSON correctly?
In-Reply-To: <1504766318081.26029@maanmittauslaitos.fi>
References: <1504766318081.26029@maanmittauslaitos.fi>
Message-ID: <CA+=cGJk5MEytX8e26Pv=6SuhPUcD_wvzQiFsuEqkJt7ddVWXxw@mail.gmail.com>

As i said in my answer to the question the GeoJSON is invalid due to the
ring order, but I'm not sure if OGR checks for that.

Ian

On 7 September 2017 at 07:38, Rahkonen Jukka (MML) <
jukka.rahkonen at maanmittauslaitos.fi> wrote:

> Hi,
>
> I was thinking about this question on gis.stackexchange
> https://gis.stackexchange.com/questions/254536/how-to-
> convert-txt-containing-two-columns-id-and-geojson-geometry
>
> I copy-pasted the CSV example and edited it to use semicolon as field
> separator. Then I read http://www.gdal.org/drv_csv.html and had a try
> with ogrinfo
>
> ogrinfo geojson_csv.csv -al -oo GEOM_POSSIBLE_NAMES=geoJSON
> INFO: Open of `geojson_csv.csv'
>       using driver `CSV' successful.
>
> Layer name: geojson_csv
> Geometry: Unknown (any)
> Feature Count: 1
> Layer SRS WKT:
> (unknown)
> Geometry Column = geoJSON
> Id: String (0.0)
> geoJSON: String (0.0)
> OGRFeature(geojson_csv):1
>   Id (String) = 49518
>   geoJSON (String) = {type:Polygon,coordinates:[[[
> 29.9596,-2.3272],[29.9189,-2.7
> 9],[29.3706,-2.8401],[29.1497,-2.5917],[29.0405,-2.7447],[
> 28.8619,-2.5309],[29.1
> 1,-1.8602],[29.3616,-1.5092],[29.8237,-1.3089],[29.9149,-1.
> 4825],[30.0524,-1.431
> ,[30.8394,-1.6514],[30.8567,-2.3151],[30.1356,-2.4382],[29.
> 9596,-2.3272]]]}
>
> The GeoJSON geometry is not recognized but ogrinfo converts it into a
> string, with double quetes removed. Is there something wrong in the CSV or
> in my syntax?
>
> -Jukka Rahkonen-
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev




-- 
Ian Turton
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170907/16159846/attachment.html>

From even.rouault at spatialys.com  Thu Sep  7 02:37:25 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 07 Sep 2017 11:37:25 +0200
Subject: [gdal-dev] How to read CSV with GeoJSON correctly?
In-Reply-To: <1504766318081.26029@maanmittauslaitos.fi>
References: <1504766318081.26029@maanmittauslaitos.fi>
Message-ID: <2322041.hayLPE7xdu@even-i700>

Hi Jukka,

> 
> I copy-pasted the CSV example and edited it to use semicolon as field
> separator. 

That's not enough. As there are quoted strings in the GeoJSON content, they
confuse the CSV reader. So you need to surround the whole GeoJSON content
by double-quotes, and escape the inside double quotes with a repeated double quote character
(You can the use regular comma for separator, but semicolon is fine too)

Id;geoJSON
49518;"{""type"":""Polygon"",""coordinates"":[[[29.9596,-2.3272],[29.9189,-2.7028],[29.7235,-2.8189],[29.3706,-2.8401],[29.1497,-2.5917],[29.0405,-2.7447],[28.8619,-2.5309],[29.1194,-2.2488],[29.1361,-1.8602],[29.3616,-1.5092],[29.8237,-1.3089],[29.9149,-1.4825],[30.0524,-1.4314],[30.4704,-1.0525],[30.8394,-1.6514],[30.8567,-2.3151],[30.1356,-2.4382],[29.9596,-2.3272]]]}"


$ ogrinfo test.csv -al  -oo GEOM_POSSIBLE_NAMES=geoJSON -fields=no -q

Layer name: test
OGRFeature(test):1
  POLYGON ((29.9596 -2.3272,29.9189 -2.7028,29.7235 -2.8189,29.3706 -2.8401,29.1497 -2.5917,29.0405 -2.7447,28.8619 -2.5309,29.1194 -2.2488,29.1361 -1.8602,29.3616 -1.5092,29.8237 -1.3089,29.9149 -1.4825,30.0524 -1.4314,30.4704 -1.0525,30.8394 -1.6514,30.8567 -2.3151,30.1356 -2.4382,29.9596 -2.3272))

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170907/039eef03/attachment-0001.html>

From even.rouault at spatialys.com  Thu Sep  7 02:58:37 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 07 Sep 2017 11:58:37 +0200
Subject: [gdal-dev] RFC68: C++11 compilation mode - Call for vote on
	adoption
In-Reply-To: <CABUeae-Jh-_uQ7f1Ki0qEpTsqsgQ8wfxFB0pivYRC8WYLLsAig@mail.gmail.com>
References: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
 <op.y5518krqdbaoe8@macmarilu>
 <CABUeae-Jh-_uQ7f1Ki0qEpTsqsgQ8wfxFB0pivYRC8WYLLsAig@mail.gmail.com>
Message-ID: <35849214.aPCVbheXaQ@even-i700>

On jeudi 7 septembre 2017 07:47:40 CEST Mateusz Loskot wrote:
> On 7 September 2017 at 01:01, Joaquim Luis <jluis at ualg.pt> wrote:
> > On Wed, 06 Sep 2017 21:22:18 +0100, Mateusz Loskot <mateusz at loskot.net> wrote:
> >> On 6 September 2017 at 21:53, Kurt Schwehr <schwehr at gmail.com> wrote:
> >>> I was just about to write something along the lines that follow, but
> >>> Mateusz
> >>> looks to have more of an understanding.
> >>> 
> >>> My best guess was that it is an incomplete install of Windows?  e.g.
> >>> 
> >>> 
> >>> https://support.microsoft.com/en-us/help/2999226/update-for-universal-c-> >>> runtime-in-windows>> 
> >> Universal C Runtime and Universal Windows Platform are two different
> >> beasts.
> >> Universal C Runtime is part of Windows 10+ system
> >> Kurt's link above leads to installer of Universal CRT for older
> >> Windows versions.
> >> 
> >> Here is into to Universal CRT
> >> 
> >> https://blogs.msdn.microsoft.com/vcblog/2015/03/03/introducing-the-univer
> >> sal-crt/
> >> 
> >> It is all related to the fact that VS2015 and VS2017 are binary
> >> compatible.
> > 
> > Well, this is in the minimum confusing and I may have been mislead by my
> > TortoiseSVN installation that ships those dlls. The link says:
> > 
> > "If you build software designed for use on Windows operating systems where
> > the Universal CRT is not guaranteed to be installed (i.e., Windows 8.1 and
> > below), your software will need to depend on the above mentioned Windows
> > Update packages to install the Universal CRT."
> 
> Yes, it is confusing. I also completely ignored the fact that I'm on Windows
> 10. where the Universal CRT is a system component, and since for others
> there is system update, I assumed everyone with up-to-date older Windows
> system has got that too.

I can give you some feedback regarding this. My Ubuntu 16.04 ship by default with wine 1.6 
and I tried newest Tamas GDAL builds for VS2017 and it didn't work because 
vcruntime140.dll that is provided in the zip requires linking against those api-ms-win-crt-*.dll 
that weren't included in it. I tried to install with winetricks the vs2015 redistribuable but 
didn't work because wine was too old, and it suggested to use Wine 2. Which I compiled from 
source, and then the GDAL builds worked there out of the box (no need to install the vs2015 
redistribuable) since this version of Wine provides the api-ms-win-crt-*.dll (their Wine 
implementation, not the MS binaries themselves)
I also see that OSGeo4W that now compiles GDAL & QGIS master against VS2015 has a 
package for the VS2015 redistribuable:
http://download.osgeo.org/osgeo4w/x86_64/release/msvcrt/msvcrt2015/
So I suspect the situation is the following :
* ship the api-ms-win-crt-*.dll next to your binaries and that should work everywhere
* if not shippig the api-ms-win-crt-*.dll next to your binaries:
  - Win7: install the VS2015 redistribuable
  - Win8: Windows update
  - Win10: works out of the box

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170907/45613020/attachment.html>

From mateusz at loskot.net  Thu Sep  7 03:02:24 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu, 7 Sep 2017 12:02:24 +0200
Subject: [gdal-dev] RFC68: C++11 compilation mode - Call for vote on
	adoption
In-Reply-To: <35849214.aPCVbheXaQ@even-i700>
References: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
 <op.y5518krqdbaoe8@macmarilu>
 <CABUeae-Jh-_uQ7f1Ki0qEpTsqsgQ8wfxFB0pivYRC8WYLLsAig@mail.gmail.com>
 <35849214.aPCVbheXaQ@even-i700>
Message-ID: <CABUeae8jCh7h+E_z3Y0+kagYVhPbcLoCAMg-AbBRpF4BfLRA2A@mail.gmail.com>

On 7 September 2017 at 11:58, Even Rouault <even.rouault at spatialys.com> wrote:
>
> I can give you some feedback regarding this.
> [...]
> So I suspect the situation is the following :
>
> * ship the api-ms-win-crt-*.dll next to your binaries and that should work
> everywhere
> * if not shippig the api-ms-win-crt-*.dll next to your binaries:
> - Win7: install the VS2015 redistribuable
> - Win8: Windows update
> - Win10: works out of the box

Even,

Thanks for the update.
It kills it right, I think.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From jukka.rahkonen at maanmittauslaitos.fi  Thu Sep  7 03:16:03 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Thu, 7 Sep 2017 03:16:03 -0700 (MST)
Subject: [gdal-dev] How to read CSV with GeoJSON correctly?
In-Reply-To: <2322041.hayLPE7xdu@even-i700>
References: <1504766318081.26029@maanmittauslaitos.fi>
 <2322041.hayLPE7xdu@even-i700>
Message-ID: <1504779363921-0.post@n6.nabble.com>

Even Rouault-2 wrote
> Hi Jukka,
> ...
> That's not enough. As there are quoted strings in the GeoJSON content,
> they
> confuse the CSV reader. So you need to surround the whole GeoJSON content
> by double-quotes, and escape the inside double quotes with a repeated
> double quote character
> (You can the use regular comma for separator, but semicolon is fine too)
> ...

Thanks. It is actually well documented in one place of
http://www.gdal.org/drv_csv.html
"Complex attribute values (such as those containing commas, quotes or
newlines) may be placed in double quotes. Any occurrences of double quotes
within the quoted string should be doubled up to "escape" them."

However, it contradicts with what is said about reading spatial information
from CSV
"...Otherwise, if one or several columns contain a geometry definition
encoded as WKT, WKB (encoded in hexadecimal) or GeoJSON, the name of such
column(s) the GEOM_POSSIBLE_NAMES open option." 

Adding extra double quotes inside GeoJSON make it invalid as GeoJSON and
JSON as well. I would say that CSV driver does not support GeoJSON encoding
at the moment.

-Jukka-






--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From even.rouault at spatialys.com  Thu Sep  7 03:27:27 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 07 Sep 2017 12:27:27 +0200
Subject: [gdal-dev] How to read CSV with GeoJSON correctly?
In-Reply-To: <1504779363921-0.post@n6.nabble.com>
References: <1504766318081.26029@maanmittauslaitos.fi>
 <2322041.hayLPE7xdu@even-i700> <1504779363921-0.post@n6.nabble.com>
Message-ID: <37640660.umxlenAxph@even-i700>

On jeudi 7 septembre 2017 03:16:03 CEST jratike80 wrote:
> Even Rouault-2 wrote
> 
> > Hi Jukka,
> > ...
> > That's not enough. As there are quoted strings in the GeoJSON content,
> > they
> > confuse the CSV reader. So you need to surround the whole GeoJSON content
> > by double-quotes, and escape the inside double quotes with a repeated
> > double quote character
> > (You can the use regular comma for separator, but semicolon is fine too)
> > ...
> 
> Thanks. It is actually well documented in one place of
> http://www.gdal.org/drv_csv.html
> "Complex attribute values (such as those containing commas, quotes or
> newlines) may be placed in double quotes. Any occurrences of double quotes
> within the quoted string should be doubled up to "escape" them."
> 
> However, it contradicts with what is said about reading spatial information
> from CSV
> "...Otherwise, if one or several columns contain a geometry definition
> encoded as WKT, WKB (encoded in hexadecimal) or GeoJSON, the name of such
> column(s) the GEOM_POSSIBLE_NAMES open option."
> 
> Adding extra double quotes inside GeoJSON make it invalid as GeoJSON and
> JSON as well. I would say that CSV driver does not support GeoJSON encoding
> at the moment.

Hard to support 2 unrelated/incompatible formats at the same time. It supports GeoJSON 
serialized as a valid CSV string, with CSV quoting and escaping rules (I've just edited the doc 
to mention that). If you use a graphical editor / spreadsheet and paste the GeoJSON content 
and save as CSV it should work (which I just did with LibreOffice calc). It is just when you edit 
directly the format at hand that things get more tricky ;-)

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170907/a1e80a5c/attachment-0001.html>

From even.rouault at spatialys.com  Thu Sep  7 04:54:50 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 07 Sep 2017 13:54:50 +0200
Subject: [gdal-dev] Shapefile corruption issue affecting GDAL >= 2.1.3 and
	GDAL >= 2.2.0
Message-ID: <2122814.rrV7QohKk9@even-i700>

Hi,

I want to notify those using OGR to do edition of shapefiles (modifications of 
existing shape / SetFeature() + creation of new shape / CreateFeature()) that a 
bug was found in a particular scenario: if you edit the last shape of the file to be 
larger than its previous version (addition of a new vertex of a line/polygon), and 
then add a new shape (in the same editing session), the previously last shape will 
be corruped (the new last shape will start in the middle of it), and likely new 
added shapes in the same editing session will corrupt their previous shape.

See https://trac.osgeo.org/gdal/ticket/7031 for details and patch

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170907/2444fbd0/attachment.html>

From farookrceg at gmail.com  Thu Sep  7 06:53:06 2017
From: farookrceg at gmail.com (Farook)
Date: Thu, 7 Sep 2017 06:53:06 -0700 (MST)
Subject: [gdal-dev] Error while compiling gdal 1.9.2 in Ubuntu16.04
Message-ID: <1504792386756-0.post@n6.nabble.com>

I am trying to compile and build gdal 1.9.2 in Ubuntu 16.04.3. I am doing the
below steps

sudo wget http://download.osgeo.org/gdal/gdal192.zip
unzip gdal192.zip -d gdal
cd gdal
cd gdal-1.9.2/
sudo ./configure
make
When i run make, i am getting the below error

In file included from /usr/include/string.h:630:0,
             from /home/kcube/gdal/gdal-1.9.2/port/cpl_port.h:132,
             from /home/kcube/gdal/gdal-1.9.2/port/cpl_conv.h:34,
             from json_object.c:12:
json_object.c:29:9: error: expected identifier or '(' before '__extension__'
char* strndup(const char* str, size_t n);
     ^
GNUmakefile:23: recipe for target '../../o/json_object.lo' failed
make[4]: *** [../../o/json_object.lo] Error 1
make[4]: Leaving directory
'/home/kcube/gdal/gdal-1.9.2/ogr/ogrsf_frmts/geojson/jsonc'
../../../GDALmake.opt:539: recipe for target 'jsonc-target' failed
make[3]: *** [jsonc-target] Error 2
make[3]: Leaving directory
'/home/kcube/gdal/gdal-1.9.2/ogr/ogrsf_frmts/geojson'
../../GDALmake.opt:539: recipe for target 'geojson-target' failed
make[2]: *** [geojson-target] Error 2
make[2]: Leaving directory '/home/kcube/gdal/gdal-1.9.2/ogr/ogrsf_frmts'
GNUmakefile:51: recipe for target 'sublibs' failed
make[1]: *** [sublibs] Error 2
make[1]: Leaving directory '/home/kcube/gdal/gdal-1.9.2/ogr'
GNUmakefile:56: recipe for target 'ogr-target' failed
make: *** [ogr-target] Error 2
Any idea how to solve this error? I badly needs gdal 1.9.2 compilation to
setup ECW suuport in geoserver.



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From even.rouault at spatialys.com  Thu Sep  7 07:15:43 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 07 Sep 2017 16:15:43 +0200
Subject: [gdal-dev] Error while compiling gdal 1.9.2 in Ubuntu16.04
In-Reply-To: <1504792386756-0.post@n6.nabble.com>
References: <1504792386756-0.post@n6.nabble.com>
Message-ID: <1700616.qIdleJHQ5p@even-i700>

On jeudi 7 septembre 2017 06:53:06 CEST Farook wrote:
> I am trying to compile and build gdal 1.9.2 in Ubuntu 16.04.3. I am doing
> the below steps

Be aware that this is a totally unsupported combination. 1.9.2 is really anciant, but yes I'm 
aware that Geoserver still requires it...

Anyway, I think you should probably first install the libjson-c dev package with
sudo apt-get install libjson-c-dev
(note: I didn't try with gdal 1.9.2 + ubuntu 16.04, so this might fail)

before ./configure again (you don't need / shouldn't do ./configure as sudo by the way)

For ECW support, read carefully https://trac.osgeo.org/gdal/wiki/ECW

Remember to do "make clean" before make each time you re-run configure

Even


> 
> sudo wget http://download.osgeo.org/gdal/gdal192.zip
> unzip gdal192.zip -d gdal
> cd gdal
> cd gdal-1.9.2/
> sudo ./configure
> make
> When i run make, i am getting the below error
> 
> In file included from /usr/include/string.h:630:0,
>              from /home/kcube/gdal/gdal-1.9.2/port/cpl_port.h:132,
>              from /home/kcube/gdal/gdal-1.9.2/port/cpl_conv.h:34,
>              from json_object.c:12:
> json_object.c:29:9: error: expected identifier or '(' before '__extension__'
> char* strndup(const char* str, size_t n);
>      ^
> GNUmakefile:23: recipe for target '../../o/json_object.lo' failed
> make[4]: *** [../../o/json_object.lo] Error 1
> make[4]: Leaving directory
> '/home/kcube/gdal/gdal-1.9.2/ogr/ogrsf_frmts/geojson/jsonc'
> ../../../GDALmake.opt:539: recipe for target 'jsonc-target' failed
> make[3]: *** [jsonc-target] Error 2
> make[3]: Leaving directory
> '/home/kcube/gdal/gdal-1.9.2/ogr/ogrsf_frmts/geojson'
> ../../GDALmake.opt:539: recipe for target 'geojson-target' failed
> make[2]: *** [geojson-target] Error 2
> make[2]: Leaving directory '/home/kcube/gdal/gdal-1.9.2/ogr/ogrsf_frmts'
> GNUmakefile:51: recipe for target 'sublibs' failed
> make[1]: *** [sublibs] Error 2
> make[1]: Leaving directory '/home/kcube/gdal/gdal-1.9.2/ogr'
> GNUmakefile:56: recipe for target 'ogr-target' failed
> make: *** [ogr-target] Error 2
> Any idea how to solve this error? I badly needs gdal 1.9.2 compilation to
> setup ECW suuport in geoserver.
> 
> 
> 
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170907/5b1e1a14/attachment.html>

From cmartinez at scolab.es  Thu Sep  7 07:21:51 2017
From: cmartinez at scolab.es (=?UTF-8?B?Q8Opc2FyIE1hcnTDrW5leg==?=)
Date: Thu, 7 Sep 2017 16:21:51 +0200
Subject: [gdal-dev] ogr2ogr, preserve_fid and Postgres sequences
Message-ID: <CA+RzLkbupRScEieE9qGyFmqN3R5NS=s05Eg0qyumHtTLppyBwg@mail.gmail.com>

Hi,

When loading a layer on PostGIS using ogr2ogr, a sequence is created for
the serial primary key.
If -preserve_fid paramenter is provided, the sequence start is not properly
initialized (i. e. sequence starts on 1). This leads to problems if the
layer is later edited. Is this an intended behaviour or should be
considered a bug?

Note that I am using GDAL version 1.11.3.

Example:

# Using -preserve_fid
ogr2ogr -preserve_fid -update -f PostgreSQL "PG:host='localhost'
dbname='test'" myshp.shp  myshp -nln "test1"

# SELECT last_value from test1_ogc_fid_seq ;
 last_value
------------
          1
(1 row)

# Not using -preserve_fid: sequence properly initialized to 102
ogr2ogr -update -f PostgreSQL "PG:host='localhost' dbname='test'"
myshp.shp  myshp  -nln "test2"

# SELECT last_value from test2_ogc_fid_seq ;
 last_value
------------
        102
(1 row)

Thanks in advance,

César

-- 
SCOLAB
http://scolab.es
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170907/ff8442d7/attachment-0001.html>

From jukka.rahkonen at maanmittauslaitos.fi  Thu Sep  7 07:48:45 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Thu, 7 Sep 2017 07:48:45 -0700 (MST)
Subject: [gdal-dev] ogr2ogr, preserve_fid and Postgres sequences
In-Reply-To: <CA+RzLkbupRScEieE9qGyFmqN3R5NS=s05Eg0qyumHtTLppyBwg@mail.gmail.com>
References: <CA+RzLkbupRScEieE9qGyFmqN3R5NS=s05Eg0qyumHtTLppyBwg@mail.gmail.com>
Message-ID: <1504795725464-0.post@n6.nabble.com>

Hi César,

What are the problems you face when editing such layer? Do you have an
alternative suggestion about what to do for the sequence?

-Jukka Rahkonen-



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From cmartinez at scolab.es  Thu Sep  7 08:05:36 2017
From: cmartinez at scolab.es (=?UTF-8?B?Q8Opc2FyIE1hcnTDrW5leg==?=)
Date: Thu, 7 Sep 2017 17:05:36 +0200
Subject: [gdal-dev] ogr2ogr, preserve_fid and Postgres sequences
In-Reply-To: <1504795725464-0.post@n6.nabble.com>
References: <CA+RzLkbupRScEieE9qGyFmqN3R5NS=s05Eg0qyumHtTLppyBwg@mail.gmail.com>
 <1504795725464-0.post@n6.nabble.com>
Message-ID: <CA+RzLkYA5cPKwPmuvtB8birL96i7_6fXaP+A_dv2BJaHesXUug@mail.gmail.com>

Hi Jukka, see answer inline:

2017-09-07 16:48 GMT+02:00 jratike80 <jukka.rahkonen at maanmittauslaitos.fi>:

> Hi César,
>
> What are the problems you face when editing such layer?



If you later try to add a new record to the layer without providing an id,
it will raise an error, defeating the purpose of having a serial PK. For
instance:

INSERT INTO test1 (wkb_geometry)
VALUES (ST_GeomFromText('MULTIPOINT(-5.34510248270791 36.1506091987899)',
4258)) ;

ERROR: duplicate key value violates unique constraint "test1_pkey"
SQL state: 23505
Detail: Key (ogc_fid)=(1) already exists.

They you must provide the ogc_fid by hand:

INSERT INTO test1 (ogc_fid, wkb_geometry)
VALUES (102, ST_GeomFromText('MULTIPOINT(-5.34510248270791
36.1506091987899)', 4258)) ;



> Do you have an
> alternative suggestion about what to do for the sequence?
>

The sequence should be initialized in the same way as it is done when
-preserve_fid is not provided.
For the layer & sequence in the example, the following SQL statement would
work:

SELECT set_val('test1_ogc_fid_seq', max(ogc_fid)) FROM test1 ;

César


>
> -Jukka Rahkonen-
>
>
>
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev




-- 
SCOLAB
http://scolab.es
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170907/4708a020/attachment.html>

From farookrceg at gmail.com  Thu Sep  7 08:11:41 2017
From: farookrceg at gmail.com (Farook)
Date: Thu, 7 Sep 2017 08:11:41 -0700 (MST)
Subject: [gdal-dev] Error while compiling gdal 1.9.2 in Ubuntu16.04
In-Reply-To: <1700616.qIdleJHQ5p@even-i700>
References: <1504792386756-0.post@n6.nabble.com> <1700616.qIdleJHQ5p@even-i700>
Message-ID: <1504797101944-0.post@n6.nabble.com>

I tried installing libjson as per the suggestion 
sudo apt-get install libjson-c-dev
and did 
wget http://download.osgeo.org/gdal/gdal192.zip
unzip gdal192.zip -d gdal
cd gdal
cd gdal-1.9.2/
./configure
make clean
make
again am getting the same error 



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From even.rouault at spatialys.com  Thu Sep  7 08:41:11 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 07 Sep 2017 17:41:11 +0200
Subject: [gdal-dev] ogr2ogr, preserve_fid and Postgres sequences
In-Reply-To: <CA+RzLkYA5cPKwPmuvtB8birL96i7_6fXaP+A_dv2BJaHesXUug@mail.gmail.com>
References: <CA+RzLkbupRScEieE9qGyFmqN3R5NS=s05Eg0qyumHtTLppyBwg@mail.gmail.com>
 <1504795725464-0.post@n6.nabble.com>
 <CA+RzLkYA5cPKwPmuvtB8birL96i7_6fXaP+A_dv2BJaHesXUug@mail.gmail.com>
Message-ID: <79221099.Q2cWA66EVX@even-i700>

On jeudi 7 septembre 2017 17:05:36 CEST César Martínez wrote:
> Hi Jukka, see answer inline:
> 
> 2017-09-07 16:48 GMT+02:00 jratike80 <jukka.rahkonen at maanmittauslaitos.fi>:
> > Hi César,
> > 
> > What are the problems you face when editing such layer?
> 
> If you later try to add a new record to the layer without providing an id,
> it will raise an error, defeating the purpose of having a serial PK. For
> instance:
> 
> INSERT INTO test1 (wkb_geometry)
> VALUES (ST_GeomFromText('MULTIPOINT(-5.34510248270791 36.1506091987899)',
> 4258)) ;
> 
> ERROR: duplicate key value violates unique constraint "test1_pkey"
> SQL state: 23505
> Detail: Key (ogc_fid)=(1) already exists.
> 
> They you must provide the ogc_fid by hand:
> 
> INSERT INTO test1 (ogc_fid, wkb_geometry)
> VALUES (102, ST_GeomFromText('MULTIPOINT(-5.34510248270791
> 36.1506091987899)', 4258)) ;
> 
> > Do you have an
> > alternative suggestion about what to do for the sequence?
> 
> The sequence should be initialized in the same way as it is done when
> -preserve_fid is not provided.
> For the layer & sequence in the example, the following SQL statement would
> work:
> 
> SELECT set_val('test1_ogc_fid_seq', max(ogc_fid)) FROM test1 ;

Would you mind opening a ticket in Trac about that
https://trac.osgeo.org/gdal/newticket

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170907/28e02fcf/attachment.html>

From cmartinez at scolab.es  Thu Sep  7 08:55:40 2017
From: cmartinez at scolab.es (=?UTF-8?B?Q8Opc2FyIE1hcnTDrW5leg==?=)
Date: Thu, 7 Sep 2017 17:55:40 +0200
Subject: [gdal-dev] ogr2ogr, preserve_fid and Postgres sequences
In-Reply-To: <79221099.Q2cWA66EVX@even-i700>
References: <CA+RzLkbupRScEieE9qGyFmqN3R5NS=s05Eg0qyumHtTLppyBwg@mail.gmail.com>
 <1504795725464-0.post@n6.nabble.com>
 <CA+RzLkYA5cPKwPmuvtB8birL96i7_6fXaP+A_dv2BJaHesXUug@mail.gmail.com>
 <79221099.Q2cWA66EVX@even-i700>
Message-ID: <CA+RzLkbzgjQnYndkTy5oU-XDRpGanaO7Zea9BndAyBXoFrEzFA@mail.gmail.com>

Done, thanks for the support:

https://trac.osgeo.org/gdal/ticket/7032

César

2017-09-07 17:41 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:

> On jeudi 7 septembre 2017 17:05:36 CEST César Martínez wrote:
>
> > Hi Jukka, see answer inline:
>
> >
>
> > 2017-09-07 16:48 GMT+02:00 jratike80 <jukka.rahkonen@
> maanmittauslaitos.fi>:
>
> > > Hi César,
>
> > >
>
> > > What are the problems you face when editing such layer?
>
> >
>
> > If you later try to add a new record to the layer without providing an
> id,
>
> > it will raise an error, defeating the purpose of having a serial PK. For
>
> > instance:
>
> >
>
> > INSERT INTO test1 (wkb_geometry)
>
> > VALUES (ST_GeomFromText('MULTIPOINT(-5.34510248270791
> 36.1506091987899)',
>
> > 4258)) ;
>
> >
>
> > ERROR: duplicate key value violates unique constraint "test1_pkey"
>
> > SQL state: 23505
>
> > Detail: Key (ogc_fid)=(1) already exists.
>
> >
>
> > They you must provide the ogc_fid by hand:
>
> >
>
> > INSERT INTO test1 (ogc_fid, wkb_geometry)
>
> > VALUES (102, ST_GeomFromText('MULTIPOINT(-5.34510248270791
>
> > 36.1506091987899)', 4258)) ;
>
> >
>
> > > Do you have an
>
> > > alternative suggestion about what to do for the sequence?
>
> >
>
> > The sequence should be initialized in the same way as it is done when
>
> > -preserve_fid is not provided.
>
> > For the layer & sequence in the example, the following SQL statement
> would
>
> > work:
>
> >
>
> > SELECT set_val('test1_ogc_fid_seq', max(ogc_fid)) FROM test1 ;
>
>
>
> Would you mind opening a ticket in Trac about that
>
> https://trac.osgeo.org/gdal/newticket
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
SCOLAB
http://scolab.es
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170907/393c2c42/attachment-0001.html>

From jluis at ualg.pt  Thu Sep  7 08:59:57 2017
From: jluis at ualg.pt (Joaquim Luis)
Date: Thu, 07 Sep 2017 16:59:57 +0100
Subject: [gdal-dev] RFC68: C++11 compilation mode - Call for vote on
 adoption
In-Reply-To: <35849214.aPCVbheXaQ@even-i700>
References: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
 <op.y5518krqdbaoe8@macmarilu>
 <CABUeae-Jh-_uQ7f1Ki0qEpTsqsgQ8wfxFB0pivYRC8WYLLsAig@mail.gmail.com>
 <35849214.aPCVbheXaQ@even-i700>
Message-ID: <op.y57dd7w7dbaoe8@macmarilu>

Thanks Even and Mateusz for clarifying this.

And since more people are probably confused as well I find 16 copies of  
api-ms-win-crt-runtime-l1-1-0.dll in my machine that has a updated Win10 +  
VS compilers. Among them, those installed by

Firefox
TortoiseSVN
MikTex
VScode
OneDrive
and others

curiously I have none in the Windows directory but looked at another Win  
10 computer that has no Compilers installed, and found them only under  
System32, SysWOW64 and an Windows Avast subdir.
Well, the usual Windows mess.

In summary, it seams fair to require that Win7 users will need to install  
the the VS2015 redistribuable while the others should not need to install  
anything else.

Joaquim


>
>
> On jeudi 7 septembre 2017 07:47:40 CEST Mateusz Loskot wrote:
>
>
>
>> On 7 September 2017 at 01:01, Joaquim Luis <jluis at ualg.pt> wrote:
>
>
>
>> > On Wed, 06 Sep 2017 21:22:18 +0100, Mateusz Loskot  
>> <mateusz at loskot.net> wrote:
>
>
>
>> >> On 6 September 2017 at 21:53, Kurt Schwehr <schwehr at gmail.com> wrote:
>
>
>
>> >>> I was just about to write something along the lines that follow, but
>
>
>
>> >>> Mateusz
>
>
>
>> >>> looks to have more of an understanding.
>
>
>
>> >>>
>
>
>
>> >>> My best guess was that it is an incomplete install of Windows?  e.g.
>
>
>
>> >>>
>
>
>
>> >>>
>
>
>
>> >>>  
>> https://support.microsoft.com/en-us/help/2999226/update-for-universal-c-
>
>
>
>> >>> runtime-in-windows>>
>
>
>
>> >> Universal C Runtime and Universal Windows Platform are two different
>
>
>
>> >> beasts.
>
>
>
>> >> Universal C Runtime is part of Windows 10+ system
>
>
>
>> >> Kurt's link above leads to installer of Universal CRT for older
>
>
>
>> >> Windows versions.
>
>
>
>> >>
>
>
>
>> >> Here is into to Universal CRT
>
>
>
>> >>
>
>
>
>> >>  
>> https://blogs.msdn.microsoft.com/vcblog/2015/03/03/introducing-the-univer
>
>
>
>> >> sal-crt/
>
>
>
>> >>
>
>
>
>> >> It is all related to the fact that VS2015 and VS2017 are binary
>
>
>
>> >> compatible.
>
>
>
>> >
>
>
>
>> > Well, this is in the minimum confusing and I may have been mislead by  
>> my
>
>
>
>> > TortoiseSVN installation that ships those dlls. The link says:
>
>
>
>> >
>
>
>
>> > "If you build software designed for use on Windows operating systems  
>> where
>
>
>
>> > the Universal CRT is not guaranteed to be installed (i.e., Windows  
>> 8.1 and
>
>
>
>> > below), your software will need to depend on the above mentioned  
>> Windows
>
>
>
>> > Update packages to install the Universal CRT."
>
>
>
>>
>
>
>
>> Yes, it is confusing. I also completely ignored the fact that I'm on  
>> Windows
>
>
>
>> 10. where the Universal CRT is a system component, and since for others
>
>
>
>> there is system update, I assumed everyone with up-to-date older Windows
>
>
>
>> system has got that too.
>
>
>
>
>
>
> I can give you some feedback regarding this. My Ubuntu 16.04 ship by  
> default with wine 1.6 and I >tried newest Tamas GDAL builds for VS2017  
> and it didn't work because vcruntime140.dll that is >provided in the zip  
> requires linking against those api-ms-win-crt-*.dll that weren't  
> included in >it. I tried to install with winetricks the vs2015  
> redistribuable but didn't work because wine was >too old, and it  
> suggested to use Wine 2. Which I compiled from source, and then the GDAL  
> builds >worked there out of the box (no need to install the vs2015  
> redistribuable) since this version of >Wine provides the  
> api-ms-win-crt-*.dll (their Wine implementation, not the MS binaries  
> themselves)
>
>
>
> I also see that OSGeo4W that now compiles GDAL & QGIS master against  
> VS2015 has a package for the >VS2015 redistribuable:
>
>
>
> http://download.osgeo.org/osgeo4w/x86_64/release/msvcrt/msvcrt2015/
>
>
>
> So I suspect the situation is the following :
>
>
>
> * ship the api-ms-win-crt-*.dll next to your binaries and that should  
> work everywhere
>
>
>
> * if not shippig the api-ms-win-crt-*.dll next to your binaries:
>
>
>
>  - Win7: install the VS2015 redistribuable
>
>
>
>  - Win8: Windows update
>
>
>
>  - Win10: works out of the box
>
>
>
>
>
>
> Even
>
>
>
>
>
>
> --
>
>
> Spatialys - Geospatial professional services
>
>
>
> http://www.spatialys.com

From gdal at stripfamily.net  Thu Sep  7 09:44:01 2017
From: gdal at stripfamily.net (David Strip)
Date: Thu, 7 Sep 2017 10:44:01 -0600
Subject: [gdal-dev] RFC68: C++11 compilation mode - Call for vote on
 adoption
In-Reply-To: <op.y57dd7w7dbaoe8@macmarilu>
References: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
 <op.y5518krqdbaoe8@macmarilu>
 <CABUeae-Jh-_uQ7f1Ki0qEpTsqsgQ8wfxFB0pivYRC8WYLLsAig@mail.gmail.com>
 <35849214.aPCVbheXaQ@even-i700> <op.y57dd7w7dbaoe8@macmarilu>
Message-ID: <13af6d37-83d3-0a28-6c44-307443b4072b@stripfamily.net>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170907/33f31fe0/attachment.html>

From mateusz at loskot.net  Thu Sep  7 11:39:59 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu, 7 Sep 2017 20:39:59 +0200
Subject: [gdal-dev] RFC68: C++11 compilation mode - Call for vote on
	adoption
In-Reply-To: <op.y57dd7w7dbaoe8@macmarilu>
References: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
 <op.y5518krqdbaoe8@macmarilu>
 <CABUeae-Jh-_uQ7f1Ki0qEpTsqsgQ8wfxFB0pivYRC8WYLLsAig@mail.gmail.com>
 <35849214.aPCVbheXaQ@even-i700> <op.y57dd7w7dbaoe8@macmarilu>
Message-ID: <CABUeae8kd0XHki0_zZ=989qs07SVZhhk8hZRMNvxM=9t2+4zmQ@mail.gmail.com>

On 7 September 2017 at 17:59, Joaquim Luis <jluis at ualg.pt> wrote:
> Thanks Even and Mateusz for clarifying this.
>

Thanks to your persistence that helped to dig the issue further :-)

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From mateusz at loskot.net  Thu Sep  7 11:42:59 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu, 7 Sep 2017 20:42:59 +0200
Subject: [gdal-dev] RFC68: C++11 compilation mode - Call for vote on
	adoption
In-Reply-To: <13af6d37-83d3-0a28-6c44-307443b4072b@stripfamily.net>
References: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
 <op.y5518krqdbaoe8@macmarilu>
 <CABUeae-Jh-_uQ7f1Ki0qEpTsqsgQ8wfxFB0pivYRC8WYLLsAig@mail.gmail.com>
 <35849214.aPCVbheXaQ@even-i700> <op.y57dd7w7dbaoe8@macmarilu>
 <13af6d37-83d3-0a28-6c44-307443b4072b@stripfamily.net>
Message-ID: <CABUeae_3tNzUVNBmk_Z=qqEDSq-3BbTi94YJ+k8Vyfs0fx+Ddg@mail.gmail.com>

On 7 September 2017 at 18:44, David Strip <gdal at stripfamily.net> wrote:
>
> For a while now the Windows dll search order starts with the directory that
> the app was loaded from. This was in response to the "dll hell" phenomenon
> in earlier editions that was created when an app overrode a dll version
> expected by a previously installed app. So, at the expense of extra space,
> it is now common to distribute the required dlls with an app to control the
> version the app uses.

Interestingly, Microsoft initially removed possibility of the app-local
deployment for UniversalCRT, as per [1]

"The design is not ideal for an app-local deployment mechanism,
but support for app-local deployment was not part of the original design."

Then, crowd appealed to Microsoft strongly enough that Microsoft later
decided to allow it as an option, as per "Updated September 11, 2015" in [1]

[1] https://blogs.msdn.microsoft.com/vcblog/2015/03/03/introducing-the-universal-crt/

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From norman.barker at gmail.com  Thu Sep  7 12:59:37 2017
From: norman.barker at gmail.com (Norman Barker)
Date: Thu, 7 Sep 2017 14:59:37 -0500
Subject: [gdal-dev] gpkg tests and gdalinfo
Message-ID: <CAN_Dn-GHX7FYQw8CwnxP52TxOakkq=MWgL-p_cy406K8YGkZ5A@mail.gmail.com>

Hi,

I am building the current trunk (the osgeo master from the github mirror of
svn), I am running on centos.

Running `python gpkg.py` from the autotest suite gives (with CPL_DEBUG ON)

GNM: GNMRegisterAllInternal
GNM: RegisterGNMFile
GNM: RegisterGNMdatabase
  TEST: gpkg_init ... success
  TEST: gpkg_1 ... GTiff: Reopen with strip chop enabled
GDAL: GDALOpen(data/byte.tif, this=0x1ef29a0) succeeds as GTiff.
GDAL: GDAL_CACHEMAX = 99 MB
GDAL: GDALDriver::Create(MEM,,256,256,1,Byte,(nil))
GDAL: GDALClose(, this=0x2522260)
GDAL: GDALClose(/vsimem/tmp.PNG, this=0x25843c0)
GDAL: Using default GDALDriver::CreateCopy implementation.
GDAL: GDALDriver::Create(GPKG,/vsimem/tmp.gpkg,20,20,1,Byte,0x25f9e50)
GDAL: GDALDatasetCopyWholeRaster(): 20*20 swaths, bInterleave=1
GDAL: GDALClose(/vsimem/tmp.gpkg, this=0x2585ec0)
GDAL: GDALClose(data/byte.tif, this=0x1ef29a0)
Segmentation fault

I can and will dig into it some more but is it is a known error with a
workaround?

ogrinfo works to list the tables, but how do I use gdalinfo to list a
tileset?

Thanks,

Norman
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170907/9919233c/attachment.html>

From even.rouault at spatialys.com  Thu Sep  7 13:08:12 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 07 Sep 2017 22:08:12 +0200
Subject: [gdal-dev] gpkg tests and gdalinfo
In-Reply-To: <CAN_Dn-GHX7FYQw8CwnxP52TxOakkq=MWgL-p_cy406K8YGkZ5A@mail.gmail.com>
References: <CAN_Dn-GHX7FYQw8CwnxP52TxOakkq=MWgL-p_cy406K8YGkZ5A@mail.gmail.com>
Message-ID: <1760829.GzgH0TECvS@even-i700>

On jeudi 7 septembre 2017 14:59:37 CEST Norman Barker wrote:
> Hi,
> 
> I am building the current trunk (the osgeo master from the github mirror of
> svn), I am running on centos.
> 
> Running `python gpkg.py` from the autotest suite gives (with CPL_DEBUG ON)
> 
> GNM: GNMRegisterAllInternal
> GNM: RegisterGNMFile
> GNM: RegisterGNMdatabase
>   TEST: gpkg_init ... success
>   TEST: gpkg_1 ... GTiff: Reopen with strip chop enabled
> GDAL: GDALOpen(data/byte.tif, this=0x1ef29a0) succeeds as GTiff.
> GDAL: GDAL_CACHEMAX = 99 MB
> GDAL: GDALDriver::Create(MEM,,256,256,1,Byte,(nil))
> GDAL: GDALClose(, this=0x2522260)
> GDAL: GDALClose(/vsimem/tmp.PNG, this=0x25843c0)
> GDAL: Using default GDALDriver::CreateCopy implementation.
> GDAL: GDALDriver::Create(GPKG,/vsimem/tmp.gpkg,20,20,1,Byte,0x25f9e50)
> GDAL: GDALDatasetCopyWholeRaster(): 20*20 swaths, bInterleave=1
> GDAL: GDALClose(/vsimem/tmp.gpkg, this=0x2585ec0)
> GDAL: GDALClose(data/byte.tif, this=0x1ef29a0)
> Segmentation fault
> 
> I can and will dig into it some more but is it is a known error with a
> workaround?

No, I'm not aware of such issue. Autotest suite passes fine on our tested Travis-CI + AppVeyor 
configurations.

Perhaps you can just test
gdal_translate autotest/gcore/data/byte.tif byte.gpkg -of GPKG
and see if that crashes too. And if that doesn't, then
gdalinfo -checksum byte.gpkg
And if that still doesn't cras, then investigate in the context of the actual autotest steps.

> 
> ogrinfo works to list the tables, but how do I use gdalinfo to list a
> tileset?

If there's just one raster tileset, this will the regular dataset. If there are several, they will be 
listed as subdatasets


$ gdal_translate autotest/gcore/data/byte.tif test.gpkg -of GPKG -co 
APPEND_SUBDATASET=YES -co RASTER_TABLE=foo
Input file size is 20, 20
0...10...20...30...40...50...60...70...80...90...100 - done.

$ gdal_translate autotest/gcore/data/byte.tif test.gpkg -of GPKG -co 
APPEND_SUBDATASET=YES -co RASTER_TABLE=bar
Input file size is 20, 20
0...10...20...30...40...50...60...70...80...90...100 - done.

$ gdalinfo test.gpkg
Driver: GPKG/GeoPackage
Files: test.gpkg
Size is 512, 512
Coordinate System is `'
Subdatasets:
  SUBDATASET_1_NAME=GPKG:test.gpkg:foo
  SUBDATASET_1_DESC=foo - foo
  SUBDATASET_2_NAME=GPKG:test.gpkg:bar
  SUBDATASET_2_DESC=bar - bar
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0,  512.0)
Upper Right (  512.0,    0.0)
Lower Right (  512.0,  512.0)
Center      (  256.0,  256.0)

$ gdalinfo GPKG:test.gpkg:foo
Driver: GPKG/GeoPackage
Files: test.gpkg
Size is 20, 20
Coordinate System is:
PROJCS["NAD27 / UTM zone 11N",
    GEOGCS["NAD27",
        DATUM["North_American_Datum_1927",
            SPHEROID["Clarke 1866",6378206.4,294.9786982138982,
                AUTHORITY["EPSG","7008"]],
            AUTHORITY["EPSG","6267"]],
        PRIMEM["Greenwich",0,
            AUTHORITY["EPSG","8901"]],
        UNIT["degree",0.0174532925199433,
            AUTHORITY["EPSG","9122"]],
        AUTHORITY["EPSG","4267"]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",-117],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AXIS["Easting",EAST],
    AXIS["Northing",NORTH],
    AUTHORITY["EPSG","26711"]]
Origin = (440720.000000000000000,3751320.000000000000000)
Pixel Size = (60.000000000000000,-60.000000000000000)
Metadata:
  AREA_OR_POINT=Area
  IDENTIFIER=foo
  ZOOM_LEVEL=0
Image Structure Metadata:
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (  440720.000, 3751320.000) (117d38'28.21"W, 33d54' 8.47"N)
Lower Left  (  440720.000, 3750120.000) (117d38'27.92"W, 33d53'29.51"N)
Upper Right (  441920.000, 3751320.000) (117d37'41.48"W, 33d54' 8.71"N)
Lower Right (  441920.000, 3750120.000) (117d37'41.20"W, 33d53'29.75"N)
Center      (  441320.000, 3750720.000) (117d38' 4.70"W, 33d53'49.11"N)
Band 1 Block=256x256 Type=Byte, ColorInterp=Red
  Mask Flags: PER_DATASET ALPHA 
Band 2 Block=256x256 Type=Byte, ColorInterp=Green
  Mask Flags: PER_DATASET ALPHA 
Band 3 Block=256x256 Type=Byte, ColorInterp=Blue
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170907/0fed1a30/attachment-0001.html>

From asmitawankhede at gmail.com  Fri Sep  8 02:13:42 2017
From: asmitawankhede at gmail.com (Asmita Amol Wankhede)
Date: Fri, 8 Sep 2017 02:13:42 -0700
Subject: [gdal-dev] OpenEx not found - gdal_edit.py
Message-ID: <CAJYydMVXY5qxs3Ai-afCb0rpMBoBpaN6vwcgKOR_is0y5ZbfsA@mail.gmail.com>

Enviroment /OS -

Ubuntu 16.04  - gdal 2.1.2 already installed with Python2.7 used to build
GDAL.

VERSIONS -

gdal 2.1.2 when installed bundled with the code :
'--with-python=%s '
where s% is gdal_env['python_bin'],

ISSUE-
Trying to execute gdal_edit.py (or gdal2tiles.py, gdal_retile.py etc.) ,
fails to find osgeo module. ImportError: No module named osgeo

Fix1:  sudo apt-get install python-gdal
This fixed the issue of osgeo, but specifically, when I am trying to run
gdal_edit.py ,it does not find some of the methods from 2.1.2

RUN gdal_edit.py

/opt/google/bin/gdal_edit.py -a_srs EPSG:3857 RGB-corrected.tif
Traceback (most recent call last):
  File "/opt/google/bin/gdal_edit.py", line 274, in <module>
    sys.exit(gdal_edit(sys.argv))
  File "/opt/google/bin/gdal_edit.py", line 191, in gdal_edit
    ds = gdal.OpenEx(datasetname, gdal.OF_RASTER | gdal.OF_UPDATE,
open_options = open_options)
AttributeError: 'module' object has no attribute 'OpenEx'

OpenEx is part of 2.1.2 as I remember , please confirm how to check if I
installed correct version of python-gdal

-- 
Thanks,
Asmita
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170908/139661a1/attachment.html>

From even.rouault at spatialys.com  Fri Sep  8 02:49:59 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 08 Sep 2017 11:49:59 +0200
Subject: [gdal-dev] OpenEx not found - gdal_edit.py
In-Reply-To: <CAJYydMVXY5qxs3Ai-afCb0rpMBoBpaN6vwcgKOR_is0y5ZbfsA@mail.gmail.com>
References: <CAJYydMVXY5qxs3Ai-afCb0rpMBoBpaN6vwcgKOR_is0y5ZbfsA@mail.gmail.com>
Message-ID: <5301384.GhG0SL3WeL@even-i700>

On vendredi 8 septembre 2017 02:13:42 CEST Asmita Amol Wankhede wrote:
> Enviroment /OS -
> 
> Ubuntu 16.04  - gdal 2.1.2 already installed with Python2.7 used to build
> GDAL.
> 
> VERSIONS -
> 
> gdal 2.1.2 when installed bundled with the code :
> '--with-python=%s '
> where s% is gdal_env['python_bin'],
> 
> ISSUE-
> Trying to execute gdal_edit.py (or gdal2tiles.py, gdal_retile.py etc.) ,
> fails to find osgeo module. ImportError: No module named osgeo
> 
> Fix1:  sudo apt-get install python-gdal

This has certainly install the python bindings for GDAL 1.11, which is the default on 16.04

You likely need to adjust the PYTHONPATH to point where the python bindings of your 2.1.2 
builds have been installed

Or alternatively just add the
https://launchpad.net/~ubuntugis/+archive/ubuntu/ppa to your APT sources and use 
uptodate GDAL from it.

> This fixed the issue of osgeo, but specifically, when I am trying to run
> gdal_edit.py ,it does not find some of the methods from 2.1.2
> 
> RUN gdal_edit.py
> 
> /opt/google/bin/gdal_edit.py -a_srs EPSG:3857 RGB-corrected.tif
> Traceback (most recent call last):
>   File "/opt/google/bin/gdal_edit.py", line 274, in <module>
>     sys.exit(gdal_edit(sys.argv))
>   File "/opt/google/bin/gdal_edit.py", line 191, in gdal_edit
>     ds = gdal.OpenEx(datasetname, gdal.OF_RASTER | gdal.OF_UPDATE,
> open_options = open_options)
> AttributeError: 'module' object has no attribute 'OpenEx'
> 
> OpenEx is part of 2.1.2 as I remember , please confirm how to check if I
> installed correct version of python-gdal


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170908/212874f1/attachment.html>

From dtardon at redhat.com  Fri Sep  8 03:04:46 2017
From: dtardon at redhat.com (David Tardon)
Date: Fri, 8 Sep 2017 12:04:46 +0200
Subject: [gdal-dev] fix build with poppler 0.58.0
Message-ID: <20170908100445.GI1132@localhost.localdomain>

Hi,

As a part of update of poppler to 0.59.0 in Fedora, I patched all
depending packages to build with the new Object API. You can find the
patch for gdal here:
https://src.fedoraproject.org/rpms/gdal/blob/f17cd7bb3ffb6e141cb0335393bee9a571f85b5b/f/0001-ad
+apt-to-poppler-0.58.patch
. Disclaimer: it is completely untested.

D.

From even.rouault at spatialys.com  Fri Sep  8 04:39:41 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 08 Sep 2017 13:39:41 +0200
Subject: [gdal-dev] fix build with poppler 0.58.0
In-Reply-To: <20170908100445.GI1132@localhost.localdomain>
References: <20170908100445.GI1132@localhost.localdomain>
Message-ID: <2247299.IScNvQCr6j@even-i700>

David,

Funny, because while you were sending this email, I was just working on this!, since someone 
else reported the issue in
https://trac.osgeo.org/gdal/ticket/7033

Thanks for the patch. I've committed a changeset that is a bit a mix of your and my work (see 
ticket). Note that your original patch fails to open PDF files at runtime (likely due to issues in 
GDALPDFDictionaryPoppler::Get() / GDALPDFArrayPoppler::Get()). I've also added the 
needed change in GDALmake.opt.in and in Windows makefiles.

You can check good behaviour of the PDF driver by running autotest/gdrivers/pdf.py and 
autotest/ogr/ogr_pdf.py
I'd suggest packagers to run the whole testsuite (python run_all.py in autotest/) before 
releasing their packages. There can be some occasional failures due to network issues, or 
checksum differences du to slightly third-party lib version differency, but at least that can 
give a picture if things are completely broken or not.

Even


> Hi,
> 
> As a part of update of poppler to 0.59.0 in Fedora, I patched all
> depending packages to build with the new Object API. You can find the
> patch for gdal here:
> https://src.fedoraproject.org/rpms/gdal/blob/f17cd7bb3ffb6e141cb0335393bee9a
> 571f85b5b/f/0001-ad +apt-to-poppler-0.58.patch
> . Disclaimer: it is completely untested.
> 
> D.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170908/5d2cd591/attachment-0001.html>

From even.rouault at spatialys.com  Fri Sep  8 05:18:42 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 08 Sep 2017 14:18:42 +0200
Subject: [gdal-dev] RFC68: C++11 compilation mode - Call for vote on
	adoption
In-Reply-To: <CACmBxytcA-2nA+O96=mBBeF=JRo0ofY8n6tGfrf1CCqY62zaEw@mail.gmail.com>
References: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
 <CABUeae_R=veCYmiDc3ng+FHDdjXwY2=u6zh-b3GYCk=1j5Jhqg@mail.gmail.com>
 <CACmBxytcA-2nA+O96=mBBeF=JRo0ofY8n6tGfrf1CCqY62zaEw@mail.gmail.com>
Message-ID: <2161803.ibSGqC0XJS@even-i700>

On mercredi 6 septembre 2017 11:46:03 CEST Kurt Schwehr wrote:
> Joaquim,
> 
> Please give it another go at explaining what this use case is and the
> issues with it.  I didn't follow your comments about the need for VS2013.
> If users are on a legacy compiler (w.r.t. to C++11), can they not be served
> by the 2.2 branch?  How does that use case fair with the impending GEOS
> 3.7.0 requiring a minimum of C++11?

FYI, just discovered today that Poppler 0.58 requires C++11 as well.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170908/7f423b91/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Fri Sep  8 05:43:51 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Fri, 8 Sep 2017 05:43:51 -0700 (MST)
Subject: [gdal-dev] RFC68: C++11 compilation mode - Call for vote on
 adoption
In-Reply-To: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
References: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
Message-ID: <1504874631052-0.post@n6.nabble.com>

Kurt Schwehr-2 wrote
> Now that Tamas has added the msvc2015/2-17SDK's, I'd like to call a vote
> by
> the PSC on RFC68: C++11 compilation mode.

+1 

-Jukka Rahkonen-



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From jmckenna at gatewaygeomatics.com  Fri Sep  8 07:51:22 2017
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Fri, 8 Sep 2017 11:51:22 -0300
Subject: [gdal-dev] RFC68: C++11 compilation mode - Call for vote on
 adoption
In-Reply-To: <1504874631052-0.post@n6.nabble.com>
References: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
 <1504874631052-0.post@n6.nabble.com>
Message-ID: <5ceb99d4-e978-1020-03b2-5c671a58c3fa@gatewaygeomatics.com>

On 2017-09-08 9:43 AM, jratike80 wrote:
> Kurt Schwehr-2 wrote
>> Now that Tamas has added the msvc2015/2-17SDK's, I'd like to call a vote
>> by
>> the PSC on RFC68: C++11 compilation mode.
> 

MS4W binaries for GDAL based on MSVC 2015 have been out there since 
almost a year now; although the current stable MS4W is still based on 
MSVC 2012 (stable MS4W is downloaded 6,000 times per month), I'll be 
moving stable to MSVC 2015 shortly, as it gives proper support for both 
PHP7 and Python3 builds.  As mentioned already, many other GDAL 
dependencies are moving to C++11, even the latest MrSID SDK requires 
this.  My opinion: this new GDAL requirement for C++11 can be annoying 
to packagers, but it is necessary.

+1

-jeff




-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/





From gr.pomadchin at gmail.com  Fri Sep  8 08:50:36 2017
From: gr.pomadchin at gmail.com (daunnc)
Date: Fri, 8 Sep 2017 08:50:36 -0700 (MST)
Subject: [gdal-dev] Cloud Optimised GeoTiff format
Message-ID: <1504885836087-0.post@n6.nabble.com>

Hi again! 

According to the validate_cloud_optimized_geotiff.py script, overviews can't
be stored in a separate .ovr files. Are there any reasons why it was done?
Can in theory there be any problems related to overviews storage in a
separate .ovr file? 

Thanks a lot in advance.



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From even.rouault at spatialys.com  Fri Sep  8 09:25:45 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 08 Sep 2017 18:25:45 +0200
Subject: [gdal-dev] Cloud Optimised GeoTiff format
In-Reply-To: <1504885836087-0.post@n6.nabble.com>
References: <1504885836087-0.post@n6.nabble.com>
Message-ID: <3169460.vPJmCV4llc@even-i700>

On vendredi 8 septembre 2017 08:50:36 CEST daunnc wrote:
> Hi again!
> 
> According to the validate_cloud_optimized_geotiff.py script, overviews can't
> be stored in a separate .ovr files. Are there any reasons why it was done?

Because as the dictator of the cloud optimized geotiff spec, I decided so ;-) More seriously, 
the whole idea of C.O.G is to minimize the number of HTTP GET requests and the amount of 
bytes transferred. If the overviews are in a separate file, that increases it a bit. But yes, it 
could be discussed if it is allowed or not (similarly it will require files to be tiled starting with 
a certain dimension. strip organization could probably be considered valid in some context 
too). There could also be several levels of compliance/optimization. The current script is a bit 
black&white currently.

> Can in theory there be any problems related to overviews storage in a
> separate .ovr file?

That works fine too. Will require at least one extra GET request.

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170908/30058d31/attachment.html>

From gr.pomadchin at gmail.com  Fri Sep  8 09:35:33 2017
From: gr.pomadchin at gmail.com (daunnc)
Date: Fri, 8 Sep 2017 09:35:33 -0700 (MST)
Subject: [gdal-dev] Cloud Optimised GeoTiff format
In-Reply-To: <3169460.vPJmCV4llc@even-i700>
References: <1504885836087-0.post@n6.nabble.com> <3169460.vPJmCV4llc@even-i700>
Message-ID: <1504888533100-0.post@n6.nabble.com>

Haha, awesome!

A bit more context: I think that it could be a great thing to query TIFFs
directly (for instance) from AWS landsat bucket, and they already have
generated .ovr files which can be used, probably an additional extra query
would be not that bad. I didn't check segments ordering yet in their data,
but I hope it can work.

Thanks for your help! 



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From even.rouault at spatialys.com  Fri Sep  8 09:46:22 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 08 Sep 2017 18:46:22 +0200
Subject: [gdal-dev] Cloud Optimised GeoTiff format
In-Reply-To: <1504888533100-0.post@n6.nabble.com>
References: <1504885836087-0.post@n6.nabble.com>
 <3169460.vPJmCV4llc@even-i700> <1504888533100-0.post@n6.nabble.com>
Message-ID: <2214875.sA4NODb5um@even-i700>

On vendredi 8 septembre 2017 09:35:33 CEST daunnc wrote:
> Haha, awesome!
> 
> A bit more context: I think that it could be a great thing to query TIFFs
> directly (for instance) from AWS landsat bucket, and they already have
> generated .ovr files which can be used, probably an additional extra query
> would be not that bad. I didn't check segments ordering yet in their data,
> but I hope it can work.

The .ovr from landsat-pds are standard overviews, ie not ideal from a cloud-optimized point 
of view. Their organization is : IFD1, IFD2, ... IFDn, data_of_IFD1 data_of_IFD2, ... 
data_of_IFDn instead of the expected ideal IFD1, IFD2, ... IFDn, data_of_IFDn, ... 
data_of_IFD2, data_of_IFD1 order that is a progressive rendering streaming friendly order. 
That said, for most use cases where you just access to one resolution level, this is OK. 
Another aspect into which the current script is really pedantic.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170908/b0f19d35/attachment.html>

From gr.pomadchin at gmail.com  Fri Sep  8 09:54:39 2017
From: gr.pomadchin at gmail.com (daunnc)
Date: Fri, 8 Sep 2017 09:54:39 -0700 (MST)
Subject: [gdal-dev] Cloud Optimised GeoTiff format
In-Reply-To: <2214875.sA4NODb5um@even-i700>
References: <1504885836087-0.post@n6.nabble.com>
 <3169460.vPJmCV4llc@even-i700> <1504888533100-0.post@n6.nabble.com>
 <2214875.sA4NODb5um@even-i700>
Message-ID: <1504889679326-0.post@n6.nabble.com>

Clear, great!

Sounds a bit sad though. My dreams faced with reality. 
At least it's definitely obvious how COG should be formed in a perfect
world.

Thanks again!



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From dmorissette at mapgears.com  Fri Sep  8 11:16:22 2017
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Fri, 8 Sep 2017 14:16:22 -0400
Subject: [gdal-dev] RFC68: C++11 compilation mode - Call for vote on
 adoption
In-Reply-To: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
References: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
Message-ID: <de1bd5bd-c631-b576-83d2-30e828373d30@mapgears.com>

On 2017-09-06 12:14 PM, Kurt Schwehr wrote:
> Now that Tamas has added the msvc2015/2-17SDK's, I'd like to call a vote 
> by the PSC on RFC68: C++11 compilation mode.
> 
> The draft is here:
> 
> https://trac.osgeo.org/gdal/wiki/rfc68_cplusplus11
> 
> -Kurt
> 


+0

It's not clear to me that the benefits of the C++11 requirement justify 
the potential trouble for those who have to support platforms with older 
compilers. I do care about portability, it was one of the founding 
principles of the project 20 years ago and I do not think that "stick to 
GDAL 2.2" is an acceptable answer to the portability question. The fact 
that other SDKs or apps may have the C++11 requirement is also not a 
justification in my mind either for a core piece as important as GDAL.

That being said, I don't think I will be directly affected by the 
change, and there seem to be enough contributors who are keen on dealing 
with this that I do not need to worry about the problems and should not 
block progress.

Daniel
-- 
Daniel Morissette
Mapgears Inc
T: +1 418-696-5056 #201

From even.rouault at spatialys.com  Fri Sep  8 13:29:22 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 08 Sep 2017 22:29:22 +0200
Subject: [gdal-dev] RFC68: C++11 compilation mode - Call for vote on
	adoption
In-Reply-To: <de1bd5bd-c631-b576-83d2-30e828373d30@mapgears.com>
References: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
 <de1bd5bd-c631-b576-83d2-30e828373d30@mapgears.com>
Message-ID: <16202906.4nNSroQgz0@even-i700>

Daniel,

> It's not clear to me that the benefits of the C++11 requirement justify
> the potential trouble for those who have to support platforms with older
> compilers.

I can understand your concerns, and I would personnaly have been fine with sticking with 
oldish C++ as well, but we must also take into account the appealing of the project 
environment to other developers for its long term viability.

> I do care about portability, it was one of the founding
> principles of the project 20 years ago and I do not think that "stick to
> GDAL 2.2" is an acceptable answer to the portability question. The fact
> that other SDKs or apps may have the C++11 requirement is also not a
> justification in my mind either for a core piece as important as GDAL.

If you look at Linux platforms that have not a default C++11-ready compiler (ie gcc < 4.8) and 
are still security maintained, I don't think there are that many. In Ubuntu world, 12.04 is no 
longer security maintained since April or May this year. And 14.04 old-LTS has GCC 4.8
Debian old-old-stable wheezy has gcc 4.7 but will be end-of-life May 2018, so when GDAL 
trunk will be released. Debian old-stable jessie has gcc 4.9, so it is fine.
RHEL/Centos 6 with gcc 4.4 and its super long support cycle is probably the only Linux distro 
that don't have the requirements out-of-the-box and still be security maintained at the time 
GDAL trunk is released.

Supporting old platforms means also supporting old versions of various dependencies. I do 
not really see a lot of funding coming for those activities, perhaps because people get it for 
free in all meaning of the term, like most maintainance tasks. If people really need to have 
recent GDAL on old platforms, they can use backported toolchains, hire developers to 
backport the features they need to older branches, etc...

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170908/d0127f1b/attachment.html>

From howard at hobu.co  Fri Sep  8 14:49:27 2017
From: howard at hobu.co (Howard Butler)
Date: Fri, 8 Sep 2017 16:49:27 -0500
Subject: [gdal-dev] RFC68: C++11 compilation mode - Call for vote on
 adoption
In-Reply-To: <16202906.4nNSroQgz0@even-i700>
References: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
 <de1bd5bd-c631-b576-83d2-30e828373d30@mapgears.com>
 <16202906.4nNSroQgz0@even-i700>
Message-ID: <15DC8C82-E3C0-43C8-A352-8A2688420526@hobu.co>


> On Sep 8, 2017, at 3:29 PM, Even Rouault <even.rouault at spatialys.com> wrote:
> 
> If people really need to have recent GDAL on old platforms, they can use backported toolchains, hire developers to backport the features they need to older branches, etc...

+1 for C++11

Howard


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170908/2bd53166/attachment.html>

From andrew at aitchison.me.uk  Fri Sep  8 23:30:31 2017
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Sat, 9 Sep 2017 07:30:31 +0100 (BST)
Subject: [gdal-dev] RFC68: C++11 compilation mode - Call for vote on
 adoption
In-Reply-To: <16202906.4nNSroQgz0@even-i700>
References: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
 <de1bd5bd-c631-b576-83d2-30e828373d30@mapgears.com>
 <16202906.4nNSroQgz0@even-i700>
Message-ID: <alpine.LRH.2.21.1709090712120.11613@warden.aitchison.me.uk>

On Fri, 8 Sep 2017, Even Rouault wrote:

> If you look at Linux platforms that have not a default C++11-ready compiler (ie gcc < 4.8) and
> are still security maintained, I don't think there are that many. In Ubuntu world, 12.04 is no
> longer security maintained since April or May this year. And 14.04 old-LTS has GCC 4.8
> Debian old-old-stable wheezy has gcc 4.7 but will be end-of-life May 2018, so when GDAL
> trunk will be released. Debian old-stable jessie has gcc 4.9, so it is fine.
> RHEL/Centos 6 with gcc 4.4 and its super long support cycle is probably the only Linux distro
> that don't have the requirements out-of-the-box and still be security maintained at the time
> GDAL trunk is released.

Red Hat have "Software Collections" with several newer version of gcc
(up to 4.9.2 and 5.3.1) that can be installed on RHEL/CentOS 6 alongside
the system compilers; these build code which is compatible with the system 
libraries.

C++11 should not be a major problem for RHEL/CentOS 6.

-- 
Andrew C. Aitchison					Cambridge, UK
 			andrew at aitchison.me.uk

From schwehr at gmail.com  Sat Sep  9 07:29:23 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Sat, 9 Sep 2017 07:29:23 -0700
Subject: [gdal-dev] git(hub) migration ?
In-Reply-To: <CAFO80_pwTudB0=r-ynen5Qyj6xXdARmLyzACsWX++a0CApvmrQ@mail.gmail.com>
References: <5104617.fMlcYK0Juz@even-i700>
 <CABUeae9M1djnn24Oa3UWc_xeju-L5mOZL3Mmv44ZfGYH=x5LPw@mail.gmail.com>
 <CAFO80_pwTudB0=r-ynen5Qyj6xXdARmLyzACsWX++a0CApvmrQ@mail.gmail.com>
Message-ID: <CACmBxytHdA0Tne-pMOBPok2O_xOh0_3wDhn845Oa3j52gC=-Bw@mail.gmail.com>

I have a bunch of svn based scripts that I use daily, but I would be
happily trash my current work flow for github.

I would prefer option 3, but option 2 would be okay too.

I think that the utility of github pull requests is just too valuable to go
with option 1.

I really need to rewatch the classic "Git for Ages 4 and up"...
https://www.youtube.com/watch?v=1ffBJ4sVUb4

On Wed, Sep 6, 2017 at 1:26 PM, Luigi Pirelli <luipir at gmail.com> wrote:

> FYI in QGIS dev world we still not have found a clear and complete way
> to migrate tracker from redmine to GH or GitLab.
> More info and details can be asked to the key people that investigated
> the problem... just asking in Dev list.
>
> FYI we are still in a new updated redmine :/
> Luigi Pirelli
>
> ************************************************************
> **************************************
> * Boundless QGIS Support/Development: lpirelli AT boundlessgeo DOT com
> * LinkedIn: https://www.linkedin.com/in/luigipirelli
> * Stackexchange: http://gis.stackexchange.com/users/19667/luigi-pirelli
> * GitHub: https://github.com/luipir
> * Mastering QGIS 2nd Edition:
> * https://www.packtpub.com/big-data-and-business-
> intelligence/mastering-qgis-second-edition
> ************************************************************
> **************************************
>
>
> On 6 September 2017 at 20:36, Mateusz Loskot <mateusz at loskot.net> wrote:
> > On 6 September 2017 at 15:14, Even Rouault <even.rouault at spatialys.com>
> wrote:
> >> Hi,
> >>
> >> I've heard a few voices speaking/asking/begging for a git/github
> migration.
> >> At some point we'll certainly have to do it, as SVN vs git is beginning
> to
> >> feel more and more like CVS vs SVN 15 years ago.
> >>
> >> I can see different options :
> >> [...]
> >>
> >> 3) migrate code and tickets to github. I guess this would match most
> >> (especially occasional) contributor wishes regarding the "social"
> aspect.
> >> What would be needed is Trac -> github ticket migration. Thomas Bonfort
> did
> >> it for MapServer at some point, but he lost the script if I remember
> well (I
> >> can see in
> >> https://stackoverflow.com/questions/6671584/how-to-
> export-trac-to-github-issues
> >> a number of possibilities listed). One issue also is we have numbers
> taken
> >> by existing github pull requests, so there would be collisions on
> import (we
> >> could decide either to sacrifice colliding Trac tickets, as there are
> really
> >> old, currently the colision appear for tickets older than 2003, or move
> them
> >> to an available github ticket number. Or to sacrifice existing PR, but
> there
> >> are a few pending ones)
> >>
> >> There's also the valid concern about being tied with github.com
> regarding
> >> tickets. Recently I found
> >> https://github.com/josegonzalez/python-github-backup
> >>
> >> which can backup code, issues, pull requests, etc.. using the github
> API.
> >>
> >>
> >> My synthetic view of the situation:
> >> [...]
> >> 3) offers probably the best contributor experience. We loose a bit of
> >> control, but a backup(*) strategy exists (at least for now). I'd tend to
> >> favor this approach.
> >
> >
> > As member of the development team, I'm very much support this motion
> > and move to GitHub.
> >
> >
> >> So this email is mostly to say I'm open to the idea, but I'd appreciate
> if
> >> someone else could take the lead on this. I'd be happy to help. A RFC to
> >> formalize the move would be needed.
> >
> > If no one offers her/him-self to do it earlier, I am willing to offer
> myself to
> > migrate GDAL to GitHub in mid October.
> >
> > Then, I will prepare RFC, ask for comments and voting,
> > develop Trac to GitHub workflow using existing tools and/or custom
> > scripting in Python,
> > test with sandbox mirror and push final migration.
> >
> > Best regards,
> > --
> > Mateusz Loskot, http://mateusz.loskot.net
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170909/56d1ec7e/attachment-0001.html>

From even.rouault at spatialys.com  Sat Sep  9 08:27:33 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 09 Sep 2017 17:27:33 +0200
Subject: [gdal-dev] git(hub) migration ?
In-Reply-To: <CACmBxytHdA0Tne-pMOBPok2O_xOh0_3wDhn845Oa3j52gC=-Bw@mail.gmail.com>
References: <5104617.fMlcYK0Juz@even-i700>
 <CAFO80_pwTudB0=r-ynen5Qyj6xXdARmLyzACsWX++a0CApvmrQ@mail.gmail.com>
 <CACmBxytHdA0Tne-pMOBPok2O_xOh0_3wDhn845Oa3j52gC=-Bw@mail.gmail.com>
Message-ID: <1888368.VznJ94Mabd@even-i700>

On samedi 9 septembre 2017 07:29:23 CEST Kurt Schwehr wrote:
> I have a bunch of svn based scripts that I use daily, but I would be
> happily trash my current work flow for github.
> 
> I would prefer option 3, but option 2 would be okay too.
> 
> I think that the utility of github pull requests is just too valuable to go
> with option 1.
> 
> I really need to rewatch the classic "Git for Ages 4 and up"...
> https://www.youtube.com/watch?v=1ffBJ4sVUb4
> 

We'll probably have to do a CONTRIBUTING.md whose one part would give hints for the 
common commands and workflows. Like recommandations for contributors to how to clean 
their pull requests to squash meaningless iterations (thinking to "try to fix Travis", "attempt 
2", "hopefully this is good now", "arf, still not quite", ... style commits) into a clean history. 

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170909/d945c714/attachment.html>

From mateusz at loskot.net  Sat Sep  9 11:44:22 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sat, 9 Sep 2017 20:44:22 +0200
Subject: [gdal-dev] git(hub) migration ?
In-Reply-To: <1888368.VznJ94Mabd@even-i700>
References: <5104617.fMlcYK0Juz@even-i700>
 <CAFO80_pwTudB0=r-ynen5Qyj6xXdARmLyzACsWX++a0CApvmrQ@mail.gmail.com>
 <CACmBxytHdA0Tne-pMOBPok2O_xOh0_3wDhn845Oa3j52gC=-Bw@mail.gmail.com>
 <1888368.VznJ94Mabd@even-i700>
Message-ID: <CABUeae_UBj_uQR9sdzZMqFKjy+2+yP5R2=AYQY+FuhMOq4K0KA@mail.gmail.com>

On 9 September 2017 at 17:27, Even Rouault <even.rouault at spatialys.com> wrote:
> On samedi 9 septembre 2017 07:29:23 CEST Kurt Schwehr wrote:
>
>> I have a bunch of svn based scripts that I use daily, but I would be
>> happily trash my current work flow for github.
>> I would prefer option 3, but option 2 would be okay too.
>> I think that the utility of github pull requests is just too valuable to go
>> with option 1.
>> I really need to rewatch the classic "Git for Ages 4 and up"...
>> https://www.youtube.com/watch?v=1ffBJ4sVUb4
>
>
> We'll probably have to do a CONTRIBUTING.md whose one part would give hints
> for the common commands and workflows.

Yes, good idea.

If GDAL moves to GitHub according to the 3rd option, I think this could be
achieved via GitHub Issues and Pull Request templates,
along with the CONTRIBUTING and SUPPORT files.

https://help.github.com/articles/helping-people-contribute-to-your-project/

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From bontepaarden at gmail.com  Mon Sep 11 02:09:12 2017
From: bontepaarden at gmail.com (Paul Meems)
Date: Mon, 11 Sep 2017 11:09:12 +0200
Subject: [gdal-dev] Improve clipping of shapefiles
Message-ID: <CAHNf2YTQZeL998M0G-n7gD-YGvdpbgA7XX9jW91RyRwikfwA=A@mail.gmail.com>

I have a large shapefile with over 2.8 million shapes (fishnet) and I have
a border file with only 1 multipolygon.

I'm trying to clip the fishnet with the border.
Using code is takes about 5 min. using command line it takes even longer.

This is my command:
ogr2ogr fishnetClipped.shp fishnet.shp -clipsrc border.shp

And this is my C# code:
using (var dsFishnet = Ogr.Open(fishnetFilename, 0))
{
    // Select first layer:
    using (var layerFishnet = dsFishnet.GetLayerByIndex(0))
    {
        // Open border:
        using (var dsBorder = Ogr.Open(borderFilename, 0))
        {
            // Select first layer:
            using (var layerBorder = dsBorder.GetLayerByIndex(0))
            {
                // Get ESRI driver:
                using (var driver = Ogr.GetDriverByName("ESRI Shapefile"))
                {
                    // Create new shapefile:
                    using (var dsClipped =
driver.CreateDataSource(outputFilename, new string[] { }))
                    {
                        // Create new layer:
                        var layerName =
Path.GetFileNameWithoutExtension(outputFilename);
                        using (var layerClipped =
dsClipped.CreateLayer(layerName, layerFishnet.GetSpatialRef(),
layerFishnet.GetGeomType(), new string[] { }))
                        {
                            if (layerClipped == null)
                            {
                                throw new Exception("Layer creation
failed.");
                            }

                            // Clip the layer:
                            layerFishnet.Clip(layerBorder, layerClipped,
null, null, null);
                        }
                    }
                }
            }
        }
    }
}

I'm using GDAL 2.1.3

Can I somehow improve the speed?
I read something about putting one of the layers in memory or using a
spatial filter.
But I can't find an example of how to do this.

Please advise.

Thanks,
Paul
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170911/a0381b2f/attachment.html>

From jan.heckman at gmail.com  Mon Sep 11 03:41:39 2017
From: jan.heckman at gmail.com (Jan Heckman)
Date: Mon, 11 Sep 2017 12:41:39 +0200
Subject: [gdal-dev] Improve clipping of shapefiles
In-Reply-To: <CAHNf2YTQZeL998M0G-n7gD-YGvdpbgA7XX9jW91RyRwikfwA=A@mail.gmail.com>
References: <CAHNf2YTQZeL998M0G-n7gD-YGvdpbgA7XX9jW91RyRwikfwA=A@mail.gmail.com>
Message-ID: <CAKMUAtDaFkAotvs+YUGTEuxgCf=7d3tdhrhwHFU=P4ymcpzo7w@mail.gmail.com>

Can't really help you with the OGR part, however, I wrote utilities do
solve this (really) fast for calculating grids based on this type of
intersection.
Speed is often a matter of using specific tools utilizing the
characteristics of the problem, i.c. the fishnet regularities.
Can you share the shapesfiles so I can try?
Regards,
Jan

On Mon, Sep 11, 2017 at 11:09 AM, Paul Meems <bontepaarden at gmail.com> wrote:

> I have a large shapefile with over 2.8 million shapes (fishnet) and I have
> a border file with only 1 multipolygon.
>
> I'm trying to clip the fishnet with the border.
> Using code is takes about 5 min. using command line it takes even longer.
>
> This is my command:
> ogr2ogr fishnetClipped.shp fishnet.shp -clipsrc border.shp
>
> And this is my C# code:
> using (var dsFishnet = Ogr.Open(fishnetFilename, 0))
> {
>     // Select first layer:
>     using (var layerFishnet = dsFishnet.GetLayerByIndex(0))
>     {
>         // Open border:
>         using (var dsBorder = Ogr.Open(borderFilename, 0))
>         {
>             // Select first layer:
>             using (var layerBorder = dsBorder.GetLayerByIndex(0))
>             {
>                 // Get ESRI driver:
>                 using (var driver = Ogr.GetDriverByName("ESRI Shapefile"))
>                 {
>                     // Create new shapefile:
>                     using (var dsClipped = driver.CreateDataSource(outputFilename,
> new string[] { }))
>                     {
>                         // Create new layer:
>                         var layerName = Path.GetFileNameWithoutExtension(
> outputFilename);
>                         using (var layerClipped = dsClipped.CreateLayer(layerName,
> layerFishnet.GetSpatialRef(), layerFishnet.GetGeomType(), new string[] { }))
>                         {
>                             if (layerClipped == null)
>                             {
>                                 throw new Exception("Layer creation
> failed.");
>                             }
>
>                             // Clip the layer:
>                             layerFishnet.Clip(layerBorder, layerClipped,
> null, null, null);
>                         }
>                     }
>                 }
>             }
>         }
>     }
> }
>
> I'm using GDAL 2.1.3
>
> Can I somehow improve the speed?
> I read something about putting one of the layers in memory or using a
> spatial filter.
> But I can't find an example of how to do this.
>
> Please advise.
>
> Thanks,
> Paul
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170911/9e62493b/attachment.html>

From a.neumann at carto.net  Mon Sep 11 06:43:47 2017
From: a.neumann at carto.net (Andreas Neumann)
Date: Mon, 11 Sep 2017 15:43:47 +0200
Subject: [gdal-dev] Opening gridded xyz data that is out of order
Message-ID: <a3a5d446-4147-97e6-5581-3e94b1b65343@carto.net>

Hi,

I received a DTM from a Swiss province (OpenData) which is of the 
following format:

One coordinate per line, already gridded. See f.e.

2708001.00 1218001.00 1541.52
2708003.00 1218001.00 1542.35
2708005.00 1218001.00 1542.98
2708007.00 1218001.00 1543.58
2708009.00 1218001.00 1544.20
2708011.00 1218001.00 1545.13
2708013.00 1218001.00 1545.88

The issue is that further down the file there seems to be an issue of 
ordering the coordinates. gdalinfo produces the following error:

ERROR 1: Ungridded dataset: At line 4125001, change of Y direction
gdalinfo failed - unable to open 'DTM_swissALTI3D_XYZ.txt'.

If GDAL could open the data - it would open as ungridded data - right? 
Issue is, this data is already gridded as you can see above. I actually 
want to save this is a gridded GeoTIFF file for later usage in QGIS.

Is there still a chance that GDAL can open this data set, even if 
coordinates are out of order?

How about the gridded vs ungridded aspect of xyz files?

Thanks,

Andreas




From a.neumann at carto.net  Mon Sep 11 06:51:26 2017
From: a.neumann at carto.net (Andreas Neumann)
Date: Mon, 11 Sep 2017 15:51:26 +0200
Subject: [gdal-dev] Opening gridded xyz data that is out of order
In-Reply-To: <a3a5d446-4147-97e6-5581-3e94b1b65343@carto.net>
References: <a3a5d446-4147-97e6-5581-3e94b1b65343@carto.net>
Message-ID: <1cc68b55-917e-4f9f-cad3-0f371cf9576b@carto.net>

Hi,

Forgot to mention the link to the file, just in case you have time 
testing - see https://services.geo.zg.ch/temp/dtmav.zip (138 MB zipped 
file).

Thanks,

Andreas


On 11.09.2017 15:43, Andreas Neumann wrote:
> Hi,
>
> I received a DTM from a Swiss province (OpenData) which is of the 
> following format:
>
> One coordinate per line, already gridded. See f.e.
>
> 2708001.00 1218001.00 1541.52
> 2708003.00 1218001.00 1542.35
> 2708005.00 1218001.00 1542.98
> 2708007.00 1218001.00 1543.58
> 2708009.00 1218001.00 1544.20
> 2708011.00 1218001.00 1545.13
> 2708013.00 1218001.00 1545.88
>
> The issue is that further down the file there seems to be an issue of 
> ordering the coordinates. gdalinfo produces the following error:
>
> ERROR 1: Ungridded dataset: At line 4125001, change of Y direction
> gdalinfo failed - unable to open 'DTM_swissALTI3D_XYZ.txt'.
>
> If GDAL could open the data - it would open as ungridded data - right? 
> Issue is, this data is already gridded as you can see above. I 
> actually want to save this is a gridded GeoTIFF file for later usage 
> in QGIS.
>
> Is there still a chance that GDAL can open this data set, even if 
> coordinates are out of order?
>
> How about the gridded vs ungridded aspect of xyz files?
>
> Thanks,
>
> Andreas
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


From schwehr at gmail.com  Mon Sep 11 06:52:58 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Mon, 11 Sep 2017 06:52:58 -0700
Subject: [gdal-dev] Opening gridded xyz data that is out of order
In-Reply-To: <1cc68b55-917e-4f9f-cad3-0f371cf9576b@carto.net>
References: <a3a5d446-4147-97e6-5581-3e94b1b65343@carto.net>
 <1cc68b55-917e-4f9f-cad3-0f371cf9576b@carto.net>
Message-ID: <CACmBxytPYSjJqY-G_x_KBz-9-4PVrp1GeR_0S5C2E3jag7zwnQ@mail.gmail.com>

Can you transform the file and swap the y & x when they are in an
alternative order with your choice of python/perl/awk?

On Mon, Sep 11, 2017 at 6:51 AM, Andreas Neumann <a.neumann at carto.net>
wrote:

> Hi,
>
> Forgot to mention the link to the file, just in case you have time testing
> - see https://services.geo.zg.ch/temp/dtmav.zip (138 MB zipped file).
>
> Thanks,
>
> Andreas
>
>
>
> On 11.09.2017 15:43, Andreas Neumann wrote:
>
>> Hi,
>>
>> I received a DTM from a Swiss province (OpenData) which is of the
>> following format:
>>
>> One coordinate per line, already gridded. See f.e.
>>
>> 2708001.00 1218001.00 1541.52
>> 2708003.00 1218001.00 1542.35
>> 2708005.00 1218001.00 1542.98
>> 2708007.00 1218001.00 1543.58
>> 2708009.00 1218001.00 1544.20
>> 2708011.00 1218001.00 1545.13
>> 2708013.00 1218001.00 1545.88
>>
>> The issue is that further down the file there seems to be an issue of
>> ordering the coordinates. gdalinfo produces the following error:
>>
>> ERROR 1: Ungridded dataset: At line 4125001, change of Y direction
>> gdalinfo failed - unable to open 'DTM_swissALTI3D_XYZ.txt'.
>>
>> If GDAL could open the data - it would open as ungridded data - right?
>> Issue is, this data is already gridded as you can see above. I actually
>> want to save this is a gridded GeoTIFF file for later usage in QGIS.
>>
>> Is there still a chance that GDAL can open this data set, even if
>> coordinates are out of order?
>>
>> How about the gridded vs ungridded aspect of xyz files?
>>
>> Thanks,
>>
>> Andreas
>>
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170911/b7f23d2b/attachment.html>

From even.rouault at spatialys.com  Mon Sep 11 07:04:48 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 11 Sep 2017 16:04:48 +0200
Subject: [gdal-dev] Opening gridded xyz data that is out of order
In-Reply-To: <a3a5d446-4147-97e6-5581-3e94b1b65343@carto.net>
References: <a3a5d446-4147-97e6-5581-3e94b1b65343@carto.net>
Message-ID: <1617276.cpVtzdLyI2@even-i700>

On lundi 11 septembre 2017 15:43:47 CEST Andreas Neumann wrote:
> Hi,
> 
> I received a DTM from a Swiss province (OpenData) which is of the
> following format:
> 
> One coordinate per line, already gridded. See f.e.
> 
> 2708001.00 1218001.00 1541.52
> 2708003.00 1218001.00 1542.35
> 2708005.00 1218001.00 1542.98
> 2708007.00 1218001.00 1543.58
> 2708009.00 1218001.00 1544.20
> 2708011.00 1218001.00 1545.13
> 2708013.00 1218001.00 1545.88
> 
> The issue is that further down the file there seems to be an issue of
> ordering the coordinates. gdalinfo produces the following error:
> 
> ERROR 1: Ungridded dataset: At line 4125001, change of Y direction
> gdalinfo failed - unable to open 'DTM_swissALTI3D_XYZ.txt'.

Andreas,

the message is probably misleading. It means that from the XYZ point of view, it cannot 
handle the dataset since it doesn't match its expectations: ie successive lines with same Y and 
constant positive X step, and when changing lines, with a constant positive or negative Y 
step. The driver says probably a bit quickly that the dataset is ungridded.

> 
> If GDAL could open the data - it would open as ungridded data - right?
> Issue is, this data is already gridded as you can see above. I actually
> want to save this is a gridded GeoTIFF file for later usage in QGIS.
> 
> Is there still a chance that GDAL can open this data set, even if
> coordinates are out of order?

Not by the XYZ driver in its current design where it tries to not ingest the full file into 
memory. It does a preliminary scan to check that the file organization meets its criteria, but 
then reads its progressively efficiently. One could perhaps have a more relaxed mode that 
would require more memory and/or be less I/O efficient for datasets such as the one you 
tried.

You might try to open this file with the CSV driver and use gdal_grid (with a search radius of 2 
since this apparently the horizontal resolution) to produce a GeoTIFF. You might possibly do a 
preliminary conversions of the CSV to shapefile with spatial index or GPKG to improve 
performance of gdal_grid.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170911/66abc43a/attachment.html>

From mj10777 at googlemail.com  Mon Sep 11 07:12:10 2017
From: mj10777 at googlemail.com (Mark Johnson)
Date: Mon, 11 Sep 2017 16:12:10 +0200
Subject: [gdal-dev] Opening gridded xyz data that is out of order
Message-ID: <CAEEbjBgFHm4H3u6NH2+YwUcX-oxxKb7_QHiWagp1srMy6bxVow@mail.gmail.com>

You must sort the data beforehand
- the y position must be sorted properly (ASC or DESC)

Standard linux sort program:

sort -k2 -n -k1 392_5810.xyz -o 392_5810.sort.xyz

(2nd column (y) as numeric, then first column (x) -o = output file

As a zip file you can also do:

unzip -p 390_5820.zip | sort -k2 -n -k1 -o ../xyz/390_5820.dhhn92.txt

that would deal with problem in 1 step.

ogr needs to know the range/area to build (minx,miny,maxx, maxy), so when
the y switches it assumes a new column.

Mark
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170911/5a1e2b75/attachment.html>

From a.neumann at carto.net  Mon Sep 11 07:32:42 2017
From: a.neumann at carto.net (Andreas Neumann)
Date: Mon, 11 Sep 2017 16:32:42 +0200
Subject: [gdal-dev] Opening gridded xyz data that is out of order
In-Reply-To: <CAEEbjBgFHm4H3u6NH2+YwUcX-oxxKb7_QHiWagp1srMy6bxVow@mail.gmail.com>
References: <CAEEbjBgFHm4H3u6NH2+YwUcX-oxxKb7_QHiWagp1srMy6bxVow@mail.gmail.com>
Message-ID: <a3571bcb-0519-54c0-ad23-c4b2747174fc@carto.net>

Hi Mark (and others),

Your sort command worked like a charm. It was also very fast!

Now gdalinfo produces this nice information output:

Driver: XYZ/ASCII Gridded XYZ
Files: dtmav_sorted.xyz
Size is 5000, 5000
Coordinate System is `'
Origin = (2708000.000000000000000,1210000.000000000000000)
Pixel Size = (2.000000000000000,2.000000000000000)
Corner Coordinates:
Upper Left  ( 2708000.000, 1210000.000)
Lower Left  ( 2708000.000, 1220000.000)
Upper Right ( 2718000.000, 1210000.000)
Lower Right ( 2718000.000, 1220000.000)
Center      ( 2713000.000, 1215000.000)
Band 1 Block=5000x1 Type=Float32, ColorInterp=Undefined
   Min=728.210 Max=2294.290
   NoData Value=0

Now I can open this in QGIS as a normal data source and simply safe as a 
GeoTIFF file.

Thanks a lot to all who answered so quickly!

Glad that a simple sort command on the command line helped to solve the 
issue! I will contact the data provider and ask them if they could 
deliver this data in an already sorted form so that GDAL recognizes it 
as gridded data.

Andreas


On 11.09.2017 16:12, Mark Johnson wrote:
> You must sort the data beforehand
> - the y position must be sorted properly (ASC or DESC)
>
> Standard linux sort program:
>
> sort -k2 -n -k1 392_5810.xyz <http://392_5810.xyz> -o 
> 392_5810.sort.xyz <http://392_5810.sort.xyz>
>
> (2nd column (y) as numeric, then first column (x) -o = output file
>
> As a zip file you can also do:
>
> unzip -p 390_5820.zip | sort -k2 -n -k1 -o ../xyz/390_5820.dhhn92.txt
>
> that would deal with problem in 1 step.
>
> ogr needs to know the range/area to build (minx,miny,maxx, maxy), so 
> when the y switches it assumes a new column.
>
> Mark
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170911/104f7d51/attachment-0001.html>

From mj10777 at googlemail.com  Mon Sep 11 07:44:52 2017
From: mj10777 at googlemail.com (Mark Johnson)
Date: Mon, 11 Sep 2017 16:44:52 +0200
Subject: [gdal-dev] Opening gridded xyz data that is out of order
Message-ID: <CAEEbjBhE569JOG38ZjGanvzQnKsqJNxZCk5XUaHkXBi_F1TD+A@mail.gmail.com>

This will do the same, just replace the EPSG code number:

gdal_translate -ot Float32 -a_srs EPSG:25833 ../xyz/390_5820.dhhn92.txt
../2007.390_5820.dhhn92.25833.tif

Mark
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170911/9146091f/attachment.html>

From jluis at ualg.pt  Mon Sep 11 07:45:46 2017
From: jluis at ualg.pt (Joaquim Luis)
Date: Mon, 11 Sep 2017 15:45:46 +0100
Subject: [gdal-dev] Opening gridded xyz data that is out of order
In-Reply-To: <a3571bcb-0519-54c0-ad23-c4b2747174fc@carto.net>
References: <CAEEbjBgFHm4H3u6NH2+YwUcX-oxxKb7_QHiWagp1srMy6bxVow@mail.gmail.com>
 <a3571bcb-0519-54c0-ad23-c4b2747174fc@carto.net>
Message-ID: <op.y6eomoe2dbaoe8@macmarilu>

You could have done it with GMT as well

gmtinfo DTM_swissALTI3D_XYZ.txt -I2
-R2708001/2717999/1210001/1219999

xyz2grd -R2708001/2717999/1210001/1219999 -I2 -GDTM_swissALTI3D_XYZ.grd  
DTM_swissALTI3D_XYZ.txt

and you get a netCDF grid (it can do GeoTIFs too but would need to go see  
the docs)

The grid misses a tile of data at the lower right corner

Joaquim

>
> Hi Mark (and others),
>
> Your sort command worked like a charm. It was also very fast!
>
> Now gdalinfo produces this nice information output:
>
> Driver: XYZ/ASCII Gridded XYZ
> Files: dtmav_sorted.xyz
> Size is 5000, 5000
> Coordinate System is `'
> Origin = (2708000.000000000000000,1210000.000000000000000)
> Pixel Size = (2.000000000000000,2.000000000000000)
> Corner Coordinates:
> Upper Left  ( 2708000.000, 1210000.000)Lower Left  ( 2708000.000,  
> 1220000.000)Upper Right ( 2718000.000, 1210000.000)Lower Right (  
> 2718000.000, 1220000.000)Center      ( 2713000.000, 1215000.000)Band 1  
> Block=5000x1 Type=Float32, ColorInterp=Undefined
>  Min=728.210 Max=2294.290 NoData Value=0
>
> Now I can open this in QGIS as a normal data source and simply safe as a  
> GeoTIFF file.
>
> Thanks a lot to all who answered so quickly!
>
> Glad that a simple sort command on the command line helped to solve the  
> issue! I will contact the data provider and ask them if they could  
> deliver this >data in an already sorted form so that GDAL recognizes it  
> as gridded data.
>
> Andreas
>
> On 11.09.2017 16:12, Mark Johnson wrote:
>> You must sort the data beforehand- the y position must be sorted  
>> properly (ASC or DESC)
>>
>> Standard linux sort program:
>>
>> sort -k2 -n -k1 392_5810.xyz -o 392_5810.sort.xyz
>>
>> (2nd column (y) as numeric, then first column (x) -o = output file
>>
>> As a zip file you can also do:
>>
>> unzip -p 390_5820.zip | sort -k2 -n -k1 -o ../xyz/390_5820.dhhn92.txt
>>
>> that would deal with problem in 1 step.
>>
>> ogr needs to know the range/area to build (minx,miny,maxx, maxy), so  
>> when the y switches it assumes a new column.
>>
>> Mark
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170911/3102f0a8/attachment.html>

From a.neumann at carto.net  Mon Sep 11 07:52:07 2017
From: a.neumann at carto.net (Andreas Neumann)
Date: Mon, 11 Sep 2017 16:52:07 +0200
Subject: [gdal-dev] Opening gridded xyz data that is out of order
In-Reply-To: <CAEEbjBhE569JOG38ZjGanvzQnKsqJNxZCk5XUaHkXBi_F1TD+A@mail.gmail.com>
References: <CAEEbjBhE569JOG38ZjGanvzQnKsqJNxZCk5XUaHkXBi_F1TD+A@mail.gmail.com>
Message-ID: <b7533154-b802-df04-80c2-3b4f794b9b1c@carto.net>

Yes - I am aware of gdal_translate and gdalwarp to translate formats.

Thanks a lot. I am very happy that this was so easy to solve and now I 
can use this data in QGIS.

I think the data provider just concatenated chunks of existing files and 
did not care about the order. I will ask them to run the magic sort 
command you provided before delivering the data to their clients.

Thanks,
Andreas

On 11.09.2017 16:44, Mark Johnson wrote:
> This will do the same, just replace the EPSG code number:
>
> gdal_translate -ot Float32 -a_srs EPSG:25833 
> ../xyz/390_5820.dhhn92.txt ../2007.390_5820.dhhn92.25833.tif
>
> Mark
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170911/461e4b7c/attachment.html>

From a.neumann at carto.net  Mon Sep 11 08:04:27 2017
From: a.neumann at carto.net (Andreas Neumann)
Date: Mon, 11 Sep 2017 17:04:27 +0200
Subject: [gdal-dev] Opening gridded xyz data that is out of order
In-Reply-To: <op.y6eomoe2dbaoe8@macmarilu>
References: <CAEEbjBgFHm4H3u6NH2+YwUcX-oxxKb7_QHiWagp1srMy6bxVow@mail.gmail.com>
 <a3571bcb-0519-54c0-ad23-c4b2747174fc@carto.net>
 <op.y6eomoe2dbaoe8@macmarilu>
Message-ID: <0843ae25-eb94-7f49-c3c9-3db3199fac06@carto.net>

Hi Joaquim,

Interesting. Thanks for sharing. As always with OpenSource there are 
more solutions than just one ;-)

Yes, I am aware about the missing data in the lower right corner - this 
is outside of the province and outside of my area of interest.

Thanks and greetings,

Andreas


On 11.09.2017 16:45, Joaquim Luis wrote:
> You could have done it with GMT as well
>
> gmtinfo DTM_swissALTI3D_XYZ.txt -I2
> -R2708001/2717999/1210001/1219999
>
> xyz2grd -R2708001/2717999/1210001/1219999 -I2 
> -GDTM_swissALTI3D_XYZ.grd DTM_swissALTI3D_XYZ.txt
>
> and you get a netCDF grid (it can do GeoTIFs too but would need to go 
> see the docs)
>
> The grid misses a tile of data at the lower right corner
>
> Joaquim
>
>     Hi Mark (and others),
>
>     Your sort command worked like a charm. It was also very fast!
>
>     Now gdalinfo produces this nice information output:
>
>     Driver: XYZ/ASCII Gridded XYZ
>     Files: dtmav_sorted.xyz
>     Size is 5000, 5000
>     Coordinate System is `'
>     Origin = (2708000.000000000000000,1210000.000000000000000)
>     Pixel Size = (2.000000000000000,2.000000000000000)
>     Corner Coordinates:
>     Upper Left  ( 2708000.000, 1210000.000)
>     Lower Left  ( 2708000.000, 1220000.000)
>     Upper Right ( 2718000.000, 1210000.000)
>     Lower Right ( 2718000.000, 1220000.000)
>     Center      ( 2713000.000, 1215000.000)
>     Band 1 Block=5000x1 Type=Float32, ColorInterp=Undefined
>       Min=728.210 Max=2294.290
>       NoData Value=0
>
>     Now I can open this in QGIS as a normal data source and simply
>     safe as a GeoTIFF file.
>
>     Thanks a lot to all who answered so quickly!
>
>     Glad that a simple sort command on the command line helped to
>     solve the issue! I will contact the data provider and ask them if
>     they could deliver this data in an already sorted form so that
>     GDAL recognizes it as gridded data.
>
>     Andreas
>
>
>     On 11.09.2017 16:12, Mark Johnson wrote:
>>     You must sort the data beforehand
>>     - the y position must be sorted properly (ASC or DESC)
>>
>>     Standard linux sort program:
>>
>>     sort -k2 -n -k1 392_5810.xyz <http://392_5810.xyz> -o
>>     392_5810.sort.xyz <http://392_5810.sort.xyz>
>>
>>     (2nd column (y) as numeric, then first column (x) -o = output file
>>
>>     As a zip file you can also do:
>>
>>     unzip -p 390_5820.zip | sort -k2 -n -k1 -o ../xyz/390_5820.dhhn92.txt
>>
>>     that would deal with problem in 1 step.
>>
>>     ogr needs to know the range/area to build (minx,miny,maxx, maxy),
>>     so when the y switches it assumes a new column.
>>
>>     Mark
>>
>>
>>     _______________________________________________
>>     gdal-dev mailing list
>>     gdal-dev at lists.osgeo.org
>>     https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170911/9b6f70ca/attachment.html>

From schwehr at gmail.com  Mon Sep 11 08:39:49 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Mon, 11 Sep 2017 08:39:49 -0700
Subject: [gdal-dev] RFC68: C++11 compilation mode - Call for vote on
	adoption
In-Reply-To: <15DC8C82-E3C0-43C8-A352-8A2688420526@hobu.co>
References: <CACmBxyvKSibfcNsFcThnjz=0RUAFeeDrGxAjT+vAghOaxSRc1w@mail.gmail.com>
 <de1bd5bd-c631-b576-83d2-30e828373d30@mapgears.com>
 <16202906.4nNSroQgz0@even-i700>
 <15DC8C82-E3C0-43C8-A352-8A2688420526@hobu.co>
Message-ID: <CACmBxyst=pZfK56xOO415xK=isa0_3=doas0c-CUM1mMsAmQCA@mail.gmail.com>

I declare RFC68 passed with the following votes:

Even +1
Jukka +1
Daniel +0
Howard +1
Kurt +1

I appreciate all the discussion and the non-PSC folks who weighed in.  I
will update the RFC and begin staging a pull request targeted for Oct 1 or
shortly thereafter.

-kurt

On Fri, Sep 8, 2017 at 2:49 PM, Howard Butler <howard at hobu.co> wrote:

>
> On Sep 8, 2017, at 3:29 PM, Even Rouault <even.rouault at spatialys.com>
> wrote:
>
> If people really need to have recent GDAL on old platforms, they can use
> backported toolchains, hire developers to backport the features they need
> to older branches, etc...
>
>
> +1 for C++11
>
> Howard
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170911/abc43911/attachment-0001.html>

From dmorissette at mapgears.com  Mon Sep 11 09:09:53 2017
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Mon, 11 Sep 2017 12:09:53 -0400
Subject: [gdal-dev] git(hub) migration ?
In-Reply-To: <6620822.IXWS0tn4ot@even-i700>
References: <5104617.fMlcYK0Juz@even-i700>
 <0860edd9-b8e7-c496-f60c-c1bbe1dbe54f@gmail.com>
 <6620822.IXWS0tn4ot@even-i700>
Message-ID: <e0ef45a4-d71e-4977-53ab-349a88a401d7@mapgears.com>

Whatever option we go with, I agree that it is important to maintain the 
full history of code and tickets. In addition to the "svn blame" example 
that Even gave, being able to track the provenance of each line of code 
is also good practice for legal reasons.

Daniel


On 2017-09-06 2:40 PM, Even Rouault wrote:
>
> On mercredi 6 septembre 2017 21:16:46 CEST Dmitry Baryshnikov wrote:
>
> > Hi Even,
>
> >
>
> > I think this is great proposal. Github is modern tool for develop, code
>
> > review and test software.
>
> >
>
> > I like idea to migrate code and tickets (3). Not sure we need to migrate
>
> > closed tickets.
>
> I'd wish closed tickets to be migrated as well (I don't think this is 
> more complicated to migrate both opened+closed tickets than just 
> opened tickets). More than once I had to "svn blame" and was happy to 
> be able to find a reference to a >10 year old ticket that gives some 
> context for a change. Tickets are true assets of a project (at least 
> for the developpers) (I was thinking to suggest the "fossil" SCM (*) 
> which has the big advantage of including tickets in the repository, 
> but of course we would miss the increased social collaboration aspect 
> with such a choice :-))
>
> > Also it worth thinking to migrate only the 2.x code
>
> > tree.
>
> I'd like the whole history to be preserved in the migration.
>
> > There are not so many releases in 2.x, so branches can be convert
>
> > to tags manually.
>
> We could indeed probably create the tags manually without recreating 
> the whole clone.
>
> >
>
> > Anyhow you made me thinking about this.
>
> > By the way this work may be the subject of GSoC 2018 (not sure if this
>
> > allowed by program).
>
> I don't think that would be appropriate for GSoc which requires coding 
> for a project. Infrastructure work like this is not allowed AFAIK.
>
> Even
>
> (*) https://www.fossil-scm.org/xfer/doc/trunk/www/index.wiki
>
> -- 
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Daniel Morissette
Mapgears Inc
T: +1 418-696-5056 #201

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170911/e33e3ab2/attachment.html>

From rbarnes at umn.edu  Mon Sep 11 09:17:31 2017
From: rbarnes at umn.edu (Richard Barnes)
Date: Mon, 11 Sep 2017 09:17:31 -0700
Subject: [gdal-dev] Opening gridded xyz data that is out of order
In-Reply-To: <a3571bcb-0519-54c0-ad23-c4b2747174fc@carto.net>
References: <CAEEbjBgFHm4H3u6NH2+YwUcX-oxxKb7_QHiWagp1srMy6bxVow@mail.gmail.com>
 <a3571bcb-0519-54c0-ad23-c4b2747174fc@carto.net>
Message-ID: <CAARRkRq__PSDBM7i1inR8+uNHurLo2kWbTHQg+hrzdzU1Cba+w@mail.gmail.com>

I wonder if GDAL shouldn't suggest sorting as a means of fixing the issue,
possibly with Mark's command?

On Sep 11, 2017 7:32 AM, "Andreas Neumann" <a.neumann at carto.net> wrote:

> Hi Mark (and others),
>
> Your sort command worked like a charm. It was also very fast!
>
> Now gdalinfo produces this nice information output:
>
> Driver: XYZ/ASCII Gridded XYZ
> Files: dtmav_sorted.xyz
> Size is 5000, 5000
> Coordinate System is `'
> Origin = (2708000.000000000000000,1210000.000000000000000)
> Pixel Size = (2.000000000000000,2.000000000000000)
> Corner Coordinates:
> Upper Left  ( 2708000.000, 1210000.000)
> Lower Left  ( 2708000.000, 1220000.000)
> Upper Right ( 2718000.000, 1210000.000)
> Lower Right ( 2718000.000, 1220000.000)
> Center      ( 2713000.000, 1215000.000)
> Band 1 Block=5000x1 Type=Float32, ColorInterp=Undefined
>   Min=728.210 Max=2294.290
>   NoData Value=0
>
> Now I can open this in QGIS as a normal data source and simply safe as a
> GeoTIFF file.
>
> Thanks a lot to all who answered so quickly!
>
> Glad that a simple sort command on the command line helped to solve the
> issue! I will contact the data provider and ask them if they could deliver
> this data in an already sorted form so that GDAL recognizes it as gridded
> data.
>
> Andreas
>
> On 11.09.2017 16:12, Mark Johnson wrote:
>
> You must sort the data beforehand
> - the y position must be sorted properly (ASC or DESC)
>
> Standard linux sort program:
>
> sort -k2 -n -k1 392_5810.xyz -o 392_5810.sort.xyz
>
> (2nd column (y) as numeric, then first column (x) -o = output file
>
> As a zip file you can also do:
>
> unzip -p 390_5820.zip | sort -k2 -n -k1 -o ../xyz/390_5820.dhhn92.txt
>
> that would deal with problem in 1 step.
>
> ogr needs to know the range/area to build (minx,miny,maxx, maxy), so when
> the y switches it assumes a new column.
>
> Mark
>
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170911/b31a2ebd/attachment.html>

From mwtoews at gmail.com  Mon Sep 11 14:34:34 2017
From: mwtoews at gmail.com (Mike Toews)
Date: Tue, 12 Sep 2017 09:34:34 +1200
Subject: [gdal-dev] Improve clipping of shapefiles
In-Reply-To: <CAHNf2YTQZeL998M0G-n7gD-YGvdpbgA7XX9jW91RyRwikfwA=A@mail.gmail.com>
References: <CAHNf2YTQZeL998M0G-n7gD-YGvdpbgA7XX9jW91RyRwikfwA=A@mail.gmail.com>
Message-ID: <CAM2FmMqrPBfgr4NdiB6fRg0ox-8+cWF9L=OfNrJoznSeNJQ0pQ@mail.gmail.com>

On 11 September 2017 at 21:09, Paul Meems <bontepaarden at gmail.com> wrote:
> I have a large shapefile with over 2.8 million shapes (fishnet) and I have a
> border file with only 1 multipolygon.
>
> I'm trying to clip the fishnet with the border.
> Using code is takes about 5 min. using command line it takes even longer.
>
> This is my command:
> ogr2ogr fishnetClipped.shp fishnet.shp -clipsrc border.shp
> ...
> Can I somehow improve the speed?

If the fishnet shapefile does not have a spatial index, try creating
one. There are a few ways to do this:
http://www.gdal.org/drv_shapefile.html

I'm not sure if -clipsrc datasource will use the spatial index, but
it's worth trying.

From schwehr at gmail.com  Mon Sep 11 16:17:40 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Mon, 11 Sep 2017 16:17:40 -0700
Subject: [gdal-dev] Call for discussion on RFC68: C++11 compilation mode
In-Reply-To: <1717444.ZvXW0L2XkC@even-i700>
References: <CACmBxysbymV6N6p4updUoW3bmLaM80gqGY0AFj5-HRZbnoEHdw@mail.gmail.com>
 <82F0A4A3-A633-4CAA-BC86-56670D0A8289@gmail.com>
 <CACALY+QFw97ANrRx2eRHBqvxwvR29LoBi0t9xpFQS=zSuM3XNA@mail.gmail.com>
 <1717444.ZvXW0L2XkC@even-i700>
Message-ID: <CACmBxysg9DWKi=LKs-2z4Hfq+Gu1QCZEN6vvSco9YD=Xo_F7Bg@mail.gmail.com>

RFC68 was voted on and adopted:
https://lists.osgeo.org/pipermail/gdal-dev/2017-September/047139.html

On Tue, Sep 5, 2017 at 2:46 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi Tamas,
>
>
>
> this is great! Thanks
>
>
>
> Even
>
>
>
> > Hi Even,
>
> >
>
> > The new SDK-s have now been added.
>
> >
>
> > Best regards,
>
> >
>
> > Tamas
>
> >
>
> > 2017-08-29 15:18 GMT+02:00 Tamas Szekeres <szekerest at gmail.com>:
>
> > > Hi Even,
>
> > >
>
> > > Yes, I'm planning to include msvc2015/2017 versions shortly.
>
> > >
>
> > > Best regards,
>
> > > Tamas
>
> > >
>
> > > Sent from my iPhone
>
> > >
>
> > > 2017. aug. 14. dátummal, 19:02 időpontban Even Rouault <
>
> > >
>
> > > even.rouault at spatialys.com> írta:
>
> > > > Hi Tamas,
>
> > > >
>
> > > > Unless I'm mistaken your gisinternals.com builds don't include MSVC
>
> > >
>
> > > 2015 currently. Right ? Do you have any plans to do so ? Currently the
>
> > > GDAL
>
> > > AppVeyor target uses SDKSs from gisinternals to do builds with a
> number of
>
> > > third-party libraries.
>
> > >
>
> > > > Even
>
> > > >
>
> > > > > This is a call for discussion on RFC68 to set C++11 to be the
> minimum
>
> > >
>
> > > C++
>
> > >
>
> > > > > language version for GDAL trunk. I've drafted the RFC based on
> work by
>
> > > > > Mateusz.
>
> > > > >
>
> > > > > https://trac.osgeo.org/gdal/wiki/rfc68_cplusplus11
>
> > > > >
>
> > > > > There was initial discussions back in January of this year:
>
> > > > >
>
> > > > > https://lists.osgeo.org/pipermail/gdal-dev/2017-
>
> > >
>
> > > January/thread.html#45786
>
> > >
>
> > > > > Cheers,
>
> > > > > -kurt
>
> > > > > Engineer at Google
>
> > > >
>
> > > > --
>
> > > > Spatialys - Geospatial professional services
>
> > > > http://www.spatialys.com
>
>
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170911/57f1e602/attachment.html>

From bontepaarden at gmail.com  Tue Sep 12 01:45:02 2017
From: bontepaarden at gmail.com (Paul Meems)
Date: Tue, 12 Sep 2017 10:45:02 +0200
Subject: [gdal-dev] Improve clipping of shapefiles
In-Reply-To: <CAM2FmMqrPBfgr4NdiB6fRg0ox-8+cWF9L=OfNrJoznSeNJQ0pQ@mail.gmail.com>
References: <CAHNf2YTQZeL998M0G-n7gD-YGvdpbgA7XX9jW91RyRwikfwA=A@mail.gmail.com>
 <CAM2FmMqrPBfgr4NdiB6fRg0ox-8+cWF9L=OfNrJoznSeNJQ0pQ@mail.gmail.com>
Message-ID: <CAHNf2YRmAHaimQOttf096Q7=4Gwx4uq9vPmNYMZiOgiJv3svRQ@mail.gmail.com>

Thanks Mike for your reply.

After clipping I'm doing a dissolve. The clipping takes 5 min, which is
more or less acceptable for 2.8 million shapes.
But the dissolve is taking over 30 min. for 680k shapes.

I've added a spatial index using
dsShapefile.ExecuteSQL("CREATE SPATIAL INDEX ON " + layerName, null,
"sqlite");
but this didn't help with the clipping.

Before dissolving I add an attribute index:
dsShapefile.ExecuteSQL($"CREATE INDEX ON {layerName} USING Avg1", null,
null);
and to dissolve I use
.OpenEx(input, 4, null, null, null);
.wrapper_GDALVectorTranslateDestName();

with these options:
var options = new[]
{
    "-f", "ESRI Shapefile",
    "-overwrite",
    "-explodecollections",
    "-dialect", "sqlite",
    "-sql", "SELECT ST_Union(geometry), Avg1 FROM {layerName} GROUP BY Avg1"
};

When I import the shapefile in PostGIS and do the same query it just takes
6 min.
So I keep thinking I'm not doing it right with GDAL/OGR.

As Jan Heckman suggested I tried using the Clipper library. Luckily it is
implemented in MapWinGIS as well.
The dissolve using Clipper is just taking 4 min.
I prefer not to use yet another library.

So I'm still open for more suggestions.




Paul

*Paul Meems *
Release manager, configuration manager
and forum moderator of MapWindow GIS.
www.mapwindow.org

Owner of MapWindow.nl - Support for
Dutch speaking users.
www.mapwindow.nl


*The MapWindow GIS project has moved to GitHub
<https://github.com/MapWindow>!*


Download the latest MapWinGIS mapping engine.
<https://github.com/MapWindow/MapWinGIS/releases>

Download the latest MapWindow 5 open source desktop application.
<https://github.com/MapWindow/MapWindow5/releases>

2017-09-11 23:34 GMT+02:00 Mike Toews <mwtoews at gmail.com>:

> On 11 September 2017 at 21:09, Paul Meems <bontepaarden at gmail.com> wrote:
> > I have a large shapefile with over 2.8 million shapes (fishnet) and I
> have a
> > border file with only 1 multipolygon.
> >
> > I'm trying to clip the fishnet with the border.
> > Using code is takes about 5 min. using command line it takes even longer.
> >
> > This is my command:
> > ogr2ogr fishnetClipped.shp fishnet.shp -clipsrc border.shp
> > ...
> > Can I somehow improve the speed?
>
> If the fishnet shapefile does not have a spatial index, try creating
> one. There are a few ways to do this:
> http://www.gdal.org/drv_shapefile.html
>
> I'm not sure if -clipsrc datasource will use the spatial index, but
> it's worth trying.
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170912/48e87c12/attachment-0001.html>

From nickmcummins at icloud.com  Tue Sep 12 14:55:31 2017
From: nickmcummins at icloud.com (Nick Cummins)
Date: Tue, 12 Sep 2017 21:55:31 +0000 (GMT)
Subject: [gdal-dev] illegal axis orientation combination when re-projecting
Message-ID: <3eb5448f-0cd4-4ff3-8d79-6ce58fea63c1@me.com>

I'm trying to re-project a lidar point cloud file using PDAL, which uses GDAL under the hood. When re-projecting a .las tile which I was previously able to successfully transform the coordinate system from EPSG:4269 (lat/lon) to a US state plane projection, EPSG:102749, I now get the following error:

(pdal pipeline filters.reprojection Error) GDAL failure (1) illegal axis orientation combination
(pdal pipeline filters.reprojection Error) GDAL failure (1) Reprojection failed, err = -47, further errors will be suppressed on the transform object.
*** Error in `pdal': munmap_chunk(): invalid pointer: 0x00007f4ab1fec400 ***

I was looking online and found someone with a similar issue when running ogr2ogr to re-project a shapefile. I am able to reproduce an error running the command and data described:


ogr2ogr -f "GeoJSON" -t_srs EPSG:4326 dest.json TOWNSSURVEY_POLY.shp
*** Error in `ogr2ogr': munmap_chunk(): invalid pointer: 0x00007fced25ef400 ***
[1]    21243 abort (core dumped)  ogr2ogr -f "GeoJSON" -t_srs EPSG:4326 dest.json TOWNSSURVEY_POLY.shp

Any ideas on what could be going wrong, or at least some pointers as to how I can pinpoint the source of the problem? My gdal-config --version is 2.2.1.

Thanks,
Nick
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170912/8dd32a9d/attachment.html>

From even.rouault at spatialys.com  Tue Sep 12 16:00:28 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 13 Sep 2017 01:00:28 +0200
Subject: [gdal-dev] illegal axis orientation combination when
	re-projecting
In-Reply-To: <3eb5448f-0cd4-4ff3-8d79-6ce58fea63c1@me.com>
References: <3eb5448f-0cd4-4ff3-8d79-6ce58fea63c1@me.com>
Message-ID: <2036228.LFIOJGHxM5@even-i700>

On mardi 12 septembre 2017 21:55:31 CEST Nick Cummins wrote:
> I'm trying to re-project a lidar point cloud file using PDAL, which uses
> GDAL under the hood. When re-projecting a .las tile which I was previously
> able to successfully transform the coordinate system from EPSG:4269
> (lat/lon) to a US state plane projection, EPSG:102749, I now get the
> following error:
> 
> (pdal pipeline filters.reprojection Error) GDAL failure (1) illegal axis
> orientation combination (pdal pipeline filters.reprojection Error) GDAL
> failure (1) Reprojection failed, err = -47, further errors will be
> suppressed on the transform object. *** Error in `pdal': munmap_chunk():
> invalid pointer: 0x00007f4ab1fec400 ***
> 
> I was looking online and found someone with a similar issue when running
> ogr2ogr to re-project a shapefile. I am able to reproduce an error running
> the command and data described:

Nick,

Can you point to a link to the source shapefile that triggers the crash ?

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170913/37eaace7/attachment.html>

From nickmcummins at icloud.com  Tue Sep 12 16:06:28 2017
From: nickmcummins at icloud.com (Nick Cummins)
Date: Tue, 12 Sep 2017 23:06:28 +0000 (GMT)
Subject: [gdal-dev]
 =?utf-8?q?illegal_axis_orientation_combination_when_re?=
 =?utf-8?q?-projecting?=
Message-ID: <1c2799df-57b6-4e46-93d6-cdce858a2eb6@me.com>

TOWNSSURVEY_POLY.shp in

http://wsgw.mass.gov/data/gispub/shape/state/townssurvey_shp.zip


ogr2ogr -f "GeoJSON" -t_srs EPSG:4326 dest.json TOWNSSURVEY_POLY.shp
produces the error for me

On Sep 12, 2017, at 04:01 PM, Even Rouault <even.rouault at spatialys.com> wrote:



On mardi 12 septembre 2017 21:55:31 CEST Nick Cummins wrote:

> I'm trying to re-project a lidar point cloud file using PDAL, which uses

> GDAL under the hood. When re-projecting a .las tile which I was previously

> able to successfully transform the coordinate system from EPSG:4269

> (lat/lon) to a US state plane projection, EPSG:102749, I now get the

> following error:

>

> (pdal pipeline filters.reprojection Error) GDAL failure (1) illegal axis

> orientation combination (pdal pipeline filters.reprojection Error) GDAL

> failure (1) Reprojection failed, err = -47, further errors will be

> suppressed on the transform object. *** Error in `pdal': munmap_chunk():

> invalid pointer: 0x00007f4ab1fec400 ***

>

> I was looking online and found someone with a similar issue when running

> ogr2ogr to re-project a shapefile. I am able to reproduce an error running

> the command and data described:

 

Nick,

 

Can you point to a link to the source shapefile that triggers the crash ?

 

Even

 

 

--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170912/6c2d18b9/attachment.html>

From nickmcummins at icloud.com  Tue Sep 12 16:08:13 2017
From: nickmcummins at icloud.com (Nick Cummins)
Date: Tue, 12 Sep 2017 23:08:13 +0000 (GMT)
Subject: [gdal-dev]
 =?utf-8?q?illegal_axis_orientation_combination_when_re?=
 =?utf-8?q?-projecting?=
Message-ID: <09032598-1d22-4b5e-a444-94bb05dd5893@me.com>

The source projection is contained in the accompanying .prj file in the zip, so it's probably easiest just to download and extract the zip.


On Sep 12, 2017, at 04:06 PM, Nick Cummins <nickmcummins at icloud.com> wrote:


TOWNSSURVEY_POLY.shp in

http://wsgw.mass.gov/data/gispub/shape/state/townssurvey_shp.zip


ogr2ogr -f "GeoJSON" -t_srs EPSG:4326 dest.json TOWNSSURVEY_POLY.shp
produces the error for me

On Sep 12, 2017, at 04:01 PM, Even Rouault <even.rouault at spatialys.com> wrote:



On mardi 12 septembre 2017 21:55:31 CEST Nick Cummins wrote:

> I'm trying to re-project a lidar point cloud file using PDAL, which uses

> GDAL under the hood. When re-projecting a .las tile which I was previously

> able to successfully transform the coordinate system from EPSG:4269

> (lat/lon) to a US state plane projection, EPSG:102749, I now get the

> following error:

>

> (pdal pipeline filters.reprojection Error) GDAL failure (1) illegal axis

> orientation combination (pdal pipeline filters.reprojection Error) GDAL

> failure (1) Reprojection failed, err = -47, further errors will be

> suppressed on the transform object. *** Error in `pdal': munmap_chunk():

> invalid pointer: 0x00007f4ab1fec400 ***

>

> I was looking online and found someone with a similar issue when running

> ogr2ogr to re-project a shapefile. I am able to reproduce an error running

> the command and data described:

 

Nick,

 

Can you point to a link to the source shapefile that triggers the crash ?

 

Even

 

 

--

Spatialys - Geospatial professional services

http://www.spatialys.com


_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170912/5f5548b0/attachment-0001.html>

From even.rouault at spatialys.com  Tue Sep 12 16:28:07 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 13 Sep 2017 01:28:07 +0200
Subject: [gdal-dev] illegal axis orientation combination when
	re-projecting
In-Reply-To: <09032598-1d22-4b5e-a444-94bb05dd5893@me.com>
References: <09032598-1d22-4b5e-a444-94bb05dd5893@me.com>
Message-ID: <4940305.okcIaXejWW@even-i700>

On mardi 12 septembre 2017 23:08:13 CEST you wrote:
> The source projection is contained in the accompanying .prj file in the zip,
> so it's probably easiest just to download and extract the zip.

I can't reproduce any crash nor error on Ubuntu 16.04 with gdal trunk, head of 2.2 
branch or 2.2.1 release.
Which OS do you run ?
If you build GDAL yourself, which configure command line did you use ?
Which proj.4 version do you use ?
Since you probably run Linux from the crash message, can you install valgrind if not 
already done and run

valgrind ogr2ogr -f "GeoJSON" -t_srs EPSG:4326 dest.json 
TOWNSSURVEY_POLY.shp

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170913/e6aeac8e/attachment.html>

From nickmcummins at icloud.com  Tue Sep 12 16:47:09 2017
From: nickmcummins at icloud.com (Nick Cummins)
Date: Tue, 12 Sep 2017 23:47:09 +0000 (GMT)
Subject: [gdal-dev]
 =?utf-8?q?illegal_axis_orientation_combination_when_re?=
 =?utf-8?q?-projecting?=
Message-ID: <8dd5c071-58e6-4b56-8387-6fcad0cfe1ea@me.com>

I am using Arch Linux (continuous/rolling distro), using gdal from the official repositories.

Using proj. 4.9.3-1 from official repos.
As mentioned, previously (within the past month) the first re-projection example was working fine. Suddenly today I was analyzing a different tile and ran into the error, and I have not made any changes to my setup that I am aware of that would change behavior. 

Output of running ogr2ogr with valgrind in attached file.

Thanks,
Nick

On Sep 12, 2017, at 04:28 PM, Even Rouault <even.rouault at spatialys.com> wrote:



On mardi 12 septembre 2017 23:08:13 CEST you wrote:

> The source projection is contained in the accompanying .prj file in the zip,

> so it's probably easiest just to download and extract the zip.

 

I can't reproduce any crash nor error on Ubuntu 16.04 with gdal trunk, head of 2.2 branch or 2.2.1 release.

Which OS do you run ?

If you build GDAL yourself, which configure command line did you use ?

Which proj.4 version do you use ?

Since you probably run Linux from the crash message, can you install valgrind if not already done and run

 

valgrind ogr2ogr -f "GeoJSON" -t_srs EPSG:4326 dest.json TOWNSSURVEY_POLY.shp

 

--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170912/ce137632/attachment.html>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: valgrind-ogr2ogr-reproject.txt
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170912/ce137632/attachment.txt>

From aperi2007 at gmail.com  Tue Sep 12 23:05:04 2017
From: aperi2007 at gmail.com (Andrea Peri)
Date: Wed, 13 Sep 2017 08:05:04 +0200
Subject: [gdal-dev] Ogrinfo how to execute remotelly a query on oracle.
Message-ID: <CABqTJk-Rb1hVONQ0cJbwzMxwUEVVztAsuABfYL0Di3u6y7j3EA@mail.gmail.com>

Hi,
I'm try-ing to execut this query on an oracle dbms
select SUM(AREA) from dbti_user.rt_dati_terreni

To do this I need to use ogrinfo.

So I try t execute this ogrinfo call:

ogrinfo "OCI:username/password@(DESCRIPTION = (ADDRESS_LIST = (ADDRESS
= (PROTOCOL = TCP)(HOST = xx.xx.xx.xx)(PORT = 1521)))(CONNECT_DATA =
(SID =xxxxxx)))" -sql "select SUM(AREA) from
dbti_user.rt_dati_terreni"

But the ogrinfo report an error:

I'm not well understand but it seem due to the ogrinfo that try to
execute the query programmatically insted of ask to the oracle to do
the SUM.

Is possibile set ogrinfo to send the query sql to the oracle executing
it on the dbms ?

I report the log fragment with the error.

INFO: Open of `OCI:username/password@(DESCRIPTION = (ADDRESS_LIST =
(ADDRESS = (PROTOCOL = TCP)(HOST = xx.xx.xx.xx)(PORT =
1521)))(CONNECT_DATA = (SID =xxxxxx)))'
      using driver `OCI' successful.

Layer name: select SUM(AREA) from dbti_user.rt_dati_terreni
Geometry: None
ERROR 1: COMMIT transaction failed: disk I/O error
ERROR 1: Transaction already established
ERROR 1: sqlite3_step() failed:
  attempt to write a readonly database (8)
ERROR 1: Unable to write feature 19999 from layer select COD_COM, SEZ,
SEZ_URBANA, ZONA, FOGLIO, NUMERO, SUBALTERNO, CATEGORIA, CLASSE,
CONSISTENZA, UNITA_MISURA_CONSISTENZA, SUPERFICIE, RENDITA, INDIRIZZO,
CIVICO, TOPONIMO, PROT_ULTIMO_AGG from dbti_user.rt_dati_fabbricati.

ERROR 1: Terminating translation prematurely after failed
translation from sql statement.
ERROR 1: Transaction not established
Warning 1: Value '2405950.3164' of field select SUM(AREA) from
dbti_user.rt_dati_terreni.SUM(AREA) parsed incompletely to integer
2405950.
Feature Count: 1
Layer SRS WKT:
(unknown)
SUM(AREA): Integer (0.0)


Many thx.

-- 
-----------------
Andrea Peri
. . . . . . . . .
qwerty àèìòù
-----------------

From ari.jolma at gmail.com  Wed Sep 13 00:39:50 2017
From: ari.jolma at gmail.com (Ari Jolma)
Date: Wed, 13 Sep 2017 10:39:50 +0300
Subject: [gdal-dev] GDAL GML and OpenLayers
Message-ID: <6e98f255-1781-5bb4-eb91-12229647ca34@gmail.com>

Hi,

I'm trying to get OpenLayers (v4.3.2) understand GML made by GDAL (in 
the context of a WFS). GDAL has a lot of creation options for GML and 
the best results I've got with TARGET_NAMESPACE = 
http://ogr.maptools.org/, PREFIX = ogr, and FORMAT = GML2. That has 
worked with earlier (v2) OpenLayers but with v4 the features are 
understood but not their geometries. This may not be the full issue but 
if I produce the geometries the way geoserver seems to do, I get OL to 
understand them.

Geometry produced by GDAL as GML2, not working with new OL:

<ogr:geometryProperty>
<gml:Polygon srsName="EPSG:3857">
<gml:outerBoundaryIs>
<gml:LinearRing>
<gml:coordinates>2423495.53212975,9236910.2942792 
2487091.13966301,9293167.94709709 2491983.10947327,9276046.05276121 
2440617.42646563,9212450.44522794 
2423495.53212975,9236910.2942792</gml:coordinates>
</gml:LinearRing>
</gml:outerBoundaryIs>
</gml:Polygon>
</ogr:geometryProperty>

Geometry that works with new OL:

<ogr:geometry>
<gml:Polygon srsName="http://www.opengis.net/gml/srs/epsg.xml#3857" 
srsDimension="2">
<gml:exterior>
<gml:LinearRing>
<gml:posList>2423495.53212975 9236910.2942792 2487091.13966301 
9293167.94709709 2491983.10947327 9276046.05276121 2440617.42646563 
9212450.44522794 2423495.53212975 9236910.2942792</gml:posList>
</gml:LinearRing>
</gml:exterior>
</gml:Polygon>
</ogr:geometry>

I'm using ol.format.WFS to parse the GML. If I give it a constructor 
option gmlFormat:ol.format.GML2, the parsing causes an error because 
ol.format.GML2 does not have a feature collection parser.

Ari



From even.rouault at spatialys.com  Wed Sep 13 02:21:43 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 13 Sep 2017 11:21:43 +0200
Subject: [gdal-dev] illegal axis orientation combination when
	re-projecting
In-Reply-To: <8dd5c071-58e6-4b56-8387-6fcad0cfe1ea@me.com>
References: <8dd5c071-58e6-4b56-8387-6fcad0cfe1ea@me.com>
Message-ID: <2147281.gTrnR4Giik@even-i700>

On mardi 12 septembre 2017 23:47:09 CEST Nick Cummins wrote:
> I am using Arch Linux (continuous/rolling distro), using gdal from the
> official repositories.
> 
> Using proj. 4.9.3-1 from official repos.
> As mentioned, previously (within the past month) the first re-projection
> example was working fine. Suddenly today I was analyzing a different tile
> and ran into the error, and I have not made any changes to my setup that I
> am aware of that would change behavior. 
> 
> Output of running ogr2ogr with valgrind in attached file.

It crashes in proj.4. But the lines mentionned are weird : pj_free (pj_init.c:496). At line 496 of 
pj_init.c, this is not the pj_free() function. Perhaps due to optimizations that mess up line 
reporting. I tried with proj 4.9.3 and it works fine for me.

I see from
https://git.archlinux.org/svntogit/community.git/tree/trunk/PKGBUILD?h=packages/gdal 
that archlinux doesn't build with GDAL with --with-static-proj4, so I'm wondering if there isn't 
a mix of proj.4 versions. Isn't there a chance that one of the dependencies of GDAL links 
against a libproj.so.X (spatialite could be a good candidate) and that GDAL then loads a 
libproj.so that is a symlink to libproj.so.Y
Can you check your /usr/lib/libproj.so* files ?

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170913/384291e7/attachment.html>

From even.rouault at spatialys.com  Wed Sep 13 02:50:41 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 13 Sep 2017 11:50:41 +0200
Subject: [gdal-dev] Ogrinfo how to execute remotelly a query on oracle.
In-Reply-To: <CABqTJk-Rb1hVONQ0cJbwzMxwUEVVztAsuABfYL0Di3u6y7j3EA@mail.gmail.com>
References: <CABqTJk-Rb1hVONQ0cJbwzMxwUEVVztAsuABfYL0Di3u6y7j3EA@mail.gmail.com>
Message-ID: <60233008.XPCm8L56z6@even-i700>

On mercredi 13 septembre 2017 08:05:04 CEST Andrea Peri wrote:
> Hi,
> I'm try-ing to execut this query on an oracle dbms
> select SUM(AREA) from dbti_user.rt_dati_terreni
> 
> To do this I need to use ogrinfo.

Andrea,

The error message shows sqlite3 being involved. Two hypothesis:
- either the error message doesn't relate to ogrinfo, but rather ogr2ogr converting from 
OCI to sqlite. And I think that must be the case here given the "Unable to write feature..." 
message
- either you added -dialect sqlite to your ogrinfo command line.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170913/083be026/attachment.html>

From even.rouault at spatialys.com  Wed Sep 13 02:53:38 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 13 Sep 2017 11:53:38 +0200
Subject: [gdal-dev] GDAL GML and OpenLayers
In-Reply-To: <6e98f255-1781-5bb4-eb91-12229647ca34@gmail.com>
References: <6e98f255-1781-5bb4-eb91-12229647ca34@gmail.com>
Message-ID: <1699304.yWdSTTxfnS@even-i700>

On mercredi 13 septembre 2017 10:39:50 CEST Ari Jolma wrote:
> Hi,
> 
> I'm trying to get OpenLayers (v4.3.2) understand GML made by GDAL (in
> the context of a WFS). GDAL has a lot of creation options for GML and
> the best results I've got with TARGET_NAMESPACE =
> http://ogr.maptools.org/, PREFIX = ogr, and FORMAT = GML2. That has
> worked with earlier (v2) OpenLayers but with v4 the features are
> understood but not their geometries. This may not be the full issue but
> if I produce the geometries the way geoserver seems to do, I get OL to
> understand them.
> 
> Geometry produced by GDAL as GML2, not working with new OL:
> 
> <ogr:geometryProperty>
> <gml:Polygon srsName="EPSG:3857">
> <gml:outerBoundaryIs>
> <gml:LinearRing>
> <gml:coordinates>2423495.53212975,9236910.2942792
> 2487091.13966301,9293167.94709709 2491983.10947327,9276046.05276121
> 2440617.42646563,9212450.44522794
> 2423495.53212975,9236910.2942792</gml:coordinates>
> </gml:LinearRing>
> </gml:outerBoundaryIs>
> </gml:Polygon>
> </ogr:geometryProperty>
> 
> Geometry that works with new OL:
> 
> <ogr:geometry>
> <gml:Polygon srsName="http://www.opengis.net/gml/srs/epsg.xml#3857"
> srsDimension="2">
> <gml:exterior>

--> gml:exterior isn't GML2, but GML3. Perhaps you should try FORMAT=GML3 instead then.

> <gml:LinearRing>
> <gml:posList>2423495.53212975 9236910.2942792 2487091.13966301
> 9293167.94709709 2491983.10947327 9276046.05276121 2440617.42646563
> 9212450.44522794 2423495.53212975 9236910.2942792</gml:posList>
> </gml:LinearRing>
> </gml:exterior>
> </gml:Polygon>
> </ogr:geometry>
> 
> I'm using ol.format.WFS to parse the GML. If I give it a constructor
> option gmlFormat:ol.format.GML2, the parsing causes an error because
> ol.format.GML2 does not have a feature collection parser.
> 
> Ari
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170913/9b6cac0a/attachment.html>

From even.rouault at spatialys.com  Wed Sep 13 06:27:43 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 13 Sep 2017 15:27:43 +0200
Subject: [gdal-dev] GDAL GML and OpenLayers
In-Reply-To: <2eba7e8d-be79-9502-710f-3ea4aa50fff4@gmail.com>
References: <6e98f255-1781-5bb4-eb91-12229647ca34@gmail.com>
 <1699304.yWdSTTxfnS@even-i700>
 <2eba7e8d-be79-9502-710f-3ea4aa50fff4@gmail.com>
Message-ID: <4908526.FtLmhFJ2GP@even-i700>

> It don't work - no features at all - with GML3 and other default
> options. But, when I set FORMAT = GML3, TARGET_NAMESPACE =
> http://www.opengis.net/gml, and PREFIX = ogr (to avoid a namespace
> collision) then it works.
> 

Note that if you throw this in a reader that validates against the schema, it will error out 
because the generated .xsd will have targetNamespace="http://www.opengis.net/gml" 
which will conflict with the OGC GML schemas... So this is definitely a hack and I would not 
recommend distributing widely such datasets.

> I don't understand why the default is to put FeatureCollection etc into
> 'http://ogr.maptools.org/'?

Excellent question. Short answer: GML is a mess

Long answer:

gml:FeatureCollection didn't exist in GML 2.1.2. There was only an abstract 
_FeatureCollection element of type gml:AbstractFeatureCollectionType, so you had to 
subclass it. Then GML 3.1 brought a new gml:FeatureCollection element. Which GML 3.2.1 
immediately deprecated ! (it is now in
http://schemas.opengis.net/gml/3.2.1/deprecatedTypes.xsd ), probably for some pedantic 
reasons.

When the GML driver was upgraded for GML 3.1, it tried to follow the recommandations of 
the OGC 06-049r1 "Geography Markup Language (GML) simple features profile" (for GML 
3.1.1) and OGC 10-100r3 "Geography Markup Language (GML) simple features
profile (with Corrigendum)" (for GML 3.2), that both mention

"""This FeatureCollectionNameType does NOT extend gml:AbstractFeatureCollectionType 
because that type has been deprecated in GML 3.2."""

So basically they ask to define in your own namespace an element that is a substitution 
group of gml:AbstractFeature (for GML 3.2) or gml:_GML (for GML 3.1.1)

I guess OpenLayers doesn't try to read & understand the .xsd that comes with the .gml, and 
even if it does, it can actually be challenging to understand that the type that is defined is 
actually a feature collection (apart from having FeatureCollection in its name).

~~~~~

Anyway, I've just committed a new dataset creation option, 
GML_FEATURE_COLLECTION=YES/NO, that applies only for GML >= 3, and will use 
gml:FeatureCollection and gml:featureMember, whatever they are deprecated or not... 


Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170913/40e6b3ba/attachment-0001.html>

From nickmcummins at icloud.com  Wed Sep 13 09:58:14 2017
From: nickmcummins at icloud.com (Nick Cummins)
Date: Wed, 13 Sep 2017 16:58:14 +0000 (GMT)
Subject: [gdal-dev]
 =?utf-8?q?illegal_axis_orientation_combination_when_re?=
 =?utf-8?q?-projecting?=
Message-ID: <7942c0b8-1f65-41e5-865a-889f6ce4d586@me.com>

➜ ls -lah /usr/lib/ | grep -i libproj  
lrwxrwxrwx   1 root root    17 Sep 14  2016 libproj.so -> libproj.so.12.0.0
lrwxrwxrwx   1 root root    17 Sep 14  2016 libproj.so.12 -> libproj.so.12.0.0
-rwxr-xr-x   1 root root  423K Sep 14  2016 libproj.so.12.0.0

Also,
➜ ldd /usr/bin/ogr2ogr | grep -i proj
libproj.so.12 => /usr/lib/libproj.so.12 (0x00007fcbcfd92000)
➜ /usr/bin/ogr2ogr | grep -i spatial
libspatialite.so.7 => /usr/lib/libspatialite.so.7 (0x00007f20274ad000)
➜ ldd /usr/lib/libspatialite.so.7 | grep -i proj
libproj.so.12 => /usr/lib/libproj.so.12 (0x00007f7c7a032000)

➜ print $LD_LIBRARY_PATH
/usr/lib:/usr/lib32


On Sep 13, 2017, at 02:22 AM, Even Rouault <even.rouault at spatialys.com> wrote:



On mardi 12 septembre 2017 23:47:09 CEST Nick Cummins wrote:

> I am using Arch Linux (continuous/rolling distro), using gdal from the

> official repositories.

>

> Using proj. 4.9.3-1 from official repos.

> As mentioned, previously (within the past month) the first re-projection

> example was working fine. Suddenly today I was analyzing a different tile

> and ran into the error, and I have not made any changes to my setup that I

> am aware of that would change behavior. 

>

> Output of running ogr2ogr with valgrind in attached file.

 

It crashes in proj.4. But the lines mentionned are weird : pj_free (pj_init.c:496). At line 496 of pj_init.c, this is not the pj_free() function. Perhaps due to optimizations that mess up line reporting. I tried with proj 4.9.3 and it works fine for me.

 

I see from

https://git.archlinux.org/svntogit/community.git/tree/trunk/PKGBUILD?h=packages/gdal that archlinux doesn't build with GDAL with --with-static-proj4, so I'm wondering if there isn't a mix of proj.4 versions. Isn't there a chance that one of the dependencies of GDAL links against a libproj.so.X (spatialite could be a good candidate) and that GDAL then loads a libproj.so that is a symlink to libproj.so.Y

Can you check your /usr/lib/libproj.so* files ?

 

Even

 

--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170913/afffa83c/attachment.html>

From roarke.gaskill at weather.com  Wed Sep 13 13:38:55 2017
From: roarke.gaskill at weather.com (Roarke Gaskill)
Date: Wed, 13 Sep 2017 15:38:55 -0500
Subject: [gdal-dev] Fwd: GeoPKG Zoom Level Calculation
In-Reply-To: <mailman.5250.1505334643.21183.gdal-dev@lists.osgeo.org>
References: <mailman.5250.1505334643.21183.gdal-dev@lists.osgeo.org>
Message-ID: <CADyWFeVdkUc8LKdzBzEoHFtUk5eB=p-=mTObDeRCC7MNMpim6Q@mail.gmail.com>

Hi,

In the GDALGeoPackageDataset
<https://github.com/OSGeo/gdal/blob/65dea1c999b6b5f692c945ea074b04cb5e43eca4/gdal/ogr/ogrsf_frmts/gpkg/ogrgeopackagedatasource.cpp#L1819>
class it appears the zoom level in the SetGeoTransform function does not
calculate the zoom level correctly.  Also, it is different from the zoom
level calculation in CreateCopy
<https://github.com/OSGeo/gdal/blob/65dea1c999b6b5f692c945ea074b04cb5e43eca4/gdal/ogr/ogrsf_frmts/gpkg/ogrgeopackagedatasource.cpp#L4079>
function.  The zoom level calculation in the CreateCopy appears to work as
I would expect.

The transform I am using to test is:
[-20037508.342789248, 6176.637812966647, 0.0, 19971868.880408563, 0.0,
-6177.590116052211]

The CreateCopy zoom level logic produces level 5.  Which is what I would
expect.

The SetGeoTransform zoom level logic is not able to identify a zoom level.

Is the SetGeoTransform zoom level calculation logic wrong?

Thanks,
Roarke
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170913/8a186131/attachment.html>

From even.rouault at spatialys.com  Wed Sep 13 13:50:01 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 13 Sep 2017 22:50:01 +0200
Subject: [gdal-dev] Fwd: GeoPKG Zoom Level Calculation
In-Reply-To: <CADyWFeVdkUc8LKdzBzEoHFtUk5eB=p-=mTObDeRCC7MNMpim6Q@mail.gmail.com>
References: <mailman.5250.1505334643.21183.gdal-dev@lists.osgeo.org>
 <CADyWFeVdkUc8LKdzBzEoHFtUk5eB=p-=mTObDeRCC7MNMpim6Q@mail.gmail.com>
Message-ID: <1895798.IckIYZ77e6@even-i700>

On mercredi 13 septembre 2017 15:38:55 CEST Roarke Gaskill wrote:
> Hi,
> 
> In the GDALGeoPackageDataset
> <https://github.com/OSGeo/gdal/blob/65dea1c999b6b5f692c945ea074b04cb5e43eca4
> /gdal/ogr/ogrsf_frmts/gpkg/ogrgeopackagedatasource.cpp#L1819> class it
> appears the zoom level in the SetGeoTransform function does not calculate
> the zoom level correctly.  Also, it is different from the zoom level
> calculation in CreateCopy
> <https://github.com/OSGeo/gdal/blob/65dea1c999b6b5f692c945ea074b04cb5e43eca4
> /gdal/ogr/ogrsf_frmts/gpkg/ogrgeopackagedatasource.cpp#L4079> function.  The
> zoom level calculation in the CreateCopy appears to work as I would expect.
> 
> The transform I am using to test is:
> [-20037508.342789248, 6176.637812966647, 0.0, 19971868.880408563, 0.0,
> -6177.590116052211]
> 
> The CreateCopy zoom level logic produces level 5.  Which is what I would
> expect.
> 
> The SetGeoTransform zoom level logic is not able to identify a zoom level.
> 
> Is the SetGeoTransform zoom level calculation logic wrong?

Roarke,

when using SetGeoTransform() and a pre-defined tiling scheme (here I assume you must use 
GoogleMapsCompatible), the resolution of the geotransform matrix passed to 
SetGeoTransform() must exactly match the base resolution of the tiling scheme divided by a 
power of 2

>>> 156543.0339280410 / 6176.637812966647
25.344376450147266

which is not a power of 2.

CreateCopy() in the GPKG implementation with a pre-defined tiling scheme identifies the 
closest zoom level for your source dataset and then resample it  so its resolution matches 
exactly one of the zoom levels.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170913/7995784b/attachment.html>

From nickmcummins at icloud.com  Wed Sep 13 20:41:33 2017
From: nickmcummins at icloud.com (Nick Cummins)
Date: Thu, 14 Sep 2017 03:41:33 +0000 (GMT)
Subject: [gdal-dev]
 =?utf-8?q?illegal_axis_orientation_combination_when_re?=
 =?utf-8?q?-projecting?=
Message-ID: <56fa8b43-609f-479c-85a1-85e0d5f43470@me.com>

Hey, I was able to solve by issue by compiling and installing GDAL from source with --with-static-proj4 set. Thanks for the help.


On Sep 13, 2017, at 09:58 AM, Nick Cummins <nickmcummins at icloud.com> wrote:


➜ ls -lah /usr/lib/ | grep -i libproj  
lrwxrwxrwx   1 root root    17 Sep 14  2016 libproj.so -> libproj.so.12.0.0
lrwxrwxrwx   1 root root    17 Sep 14  2016 libproj.so.12 -> libproj.so.12.0.0
-rwxr-xr-x   1 root root  423K Sep 14  2016 libproj.so.12.0.0

Also,
➜ ldd /usr/bin/ogr2ogr | grep -i proj
libproj.so.12 => /usr/lib/libproj.so.12 (0x00007fcbcfd92000)
➜ /usr/bin/ogr2ogr | grep -i spatial
libspatialite.so.7 => /usr/lib/libspatialite.so.7 (0x00007f20274ad000)
➜ ldd /usr/lib/libspatialite.so.7 | grep -i proj
libproj.so.12 => /usr/lib/libproj.so.12 (0x00007f7c7a032000)

➜ print $LD_LIBRARY_PATH
/usr/lib:/usr/lib32


On Sep 13, 2017, at 02:22 AM, Even Rouault <even.rouault at spatialys.com> wrote:



On mardi 12 septembre 2017 23:47:09 CEST Nick Cummins wrote:

> I am using Arch Linux (continuous/rolling distro), using gdal from the

> official repositories.

>

> Using proj. 4.9.3-1 from official repos.

> As mentioned, previously (within the past month) the first re-projection

> example was working fine. Suddenly today I was analyzing a different tile

> and ran into the error, and I have not made any changes to my setup that I

> am aware of that would change behavior. 

>

> Output of running ogr2ogr with valgrind in attached file.

 

It crashes in proj.4. But the lines mentionned are weird : pj_free (pj_init.c:496). At line 496 of pj_init.c, this is not the pj_free() function. Perhaps due to optimizations that mess up line reporting. I tried with proj 4.9.3 and it works fine for me.

 

I see from

https://git.archlinux.org/svntogit/community.git/tree/trunk/PKGBUILD?h=packages/gdal that archlinux doesn't build with GDAL with --with-static-proj4, so I'm wondering if there isn't a mix of proj.4 versions. Isn't there a chance that one of the dependencies of GDAL links against a libproj.so.X (spatialite could be a good candidate) and that GDAL then loads a libproj.so that is a symlink to libproj.so.Y

Can you check your /usr/lib/libproj.so* files ?

 

Even

 

--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170914/825026aa/attachment-0001.html>

From roarke.gaskill at weather.com  Thu Sep 14 04:26:40 2017
From: roarke.gaskill at weather.com (Roarke Gaskill)
Date: Thu, 14 Sep 2017 06:26:40 -0500
Subject: [gdal-dev] Fwd: GeoPKG Zoom Level Calculation
In-Reply-To: <1895798.IckIYZ77e6@even-i700>
References: <mailman.5250.1505334643.21183.gdal-dev@lists.osgeo.org>
 <CADyWFeVdkUc8LKdzBzEoHFtUk5eB=p-=mTObDeRCC7MNMpim6Q@mail.gmail.com>
 <1895798.IckIYZ77e6@even-i700>
Message-ID: <CADyWFeVgZXmQOEYixZ5qUt8jBoaVg2fiC6pvB-v6y7CtPUOYHQ@mail.gmail.com>

Even,

Thanks for your reply.  I get it now.  :)

I am new to gdal in general.  For context, why does CreateCopy() choose the
nearest zoom level and not SetGeoTransform()?  As a new user, it seems to
me the ZOOM_LEVEL_STRATEGY should apply to both the SetGeoTransform() and
CreateCopy().

Thanks again,
Roarke

On Wed, Sep 13, 2017 at 3:50 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> On mercredi 13 septembre 2017 15:38:55 CEST Roarke Gaskill wrote:
>
> > Hi,
>
> >
>
> > In the GDALGeoPackageDataset
>
> > <https://github.com/OSGeo/gdal/blob/65dea1c999b6b5f692c945ea074b04
> cb5e43eca4
>
> > /gdal/ogr/ogrsf_frmts/gpkg/ogrgeopackagedatasource.cpp#L1819> class it
>
> > appears the zoom level in the SetGeoTransform function does not calculate
>
> > the zoom level correctly. Also, it is different from the zoom level
>
> > calculation in CreateCopy
>
> > <https://github.com/OSGeo/gdal/blob/65dea1c999b6b5f692c945ea074b04
> cb5e43eca4
>
> > /gdal/ogr/ogrsf_frmts/gpkg/ogrgeopackagedatasource.cpp#L4079> function.
> The
>
> > zoom level calculation in the CreateCopy appears to work as I would
> expect.
>
> >
>
> > The transform I am using to test is:
>
> > [-20037508.342789248, 6176.637812966647, 0.0, 19971868.880408563, 0.0,
>
> > -6177.590116052211]
>
> >
>
> > The CreateCopy zoom level logic produces level 5. Which is what I would
>
> > expect.
>
> >
>
> > The SetGeoTransform zoom level logic is not able to identify a zoom
> level.
>
> >
>
> > Is the SetGeoTransform zoom level calculation logic wrong?
>
>
>
> Roarke,
>
>
>
> when using SetGeoTransform() and a pre-defined tiling scheme (here I
> assume you must use GoogleMapsCompatible), the resolution of the
> geotransform matrix passed to SetGeoTransform() must exactly match the base
> resolution of the tiling scheme divided by a power of 2
>
>
>
> >>> 156543.0339280410 / 6176.637812966647
>
> 25.344376450147266
>
>
>
> which is not a power of 2.
>
>
>
> CreateCopy() in the GPKG implementation with a pre-defined tiling scheme
> identifies the closest zoom level for your source dataset and then resample
> it so its resolution matches exactly one of the zoom levels.
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>



-- 
*Roarke **Gaskill  *|Senior Software Engineer
*e:* roarke.gaskill at weather.com
<http://weather.com/apps> <http://weather.com/apps>
<http://weather.com/apps> <http://weather.com/apps>
<http://weather.com/apps> <http://weather.com/apps>
<http://weather.com/apps> <http://weather.com/apps>
<http://weather.com/apps> <http://weather.com/apps>
<http://weather.com/apps> <http://weather.com/apps>
<http://weather.com/apps> <http://weather.com/apps>
<http://weather.com/apps> <http://weather.com/apps>
<http://weather.com/apps>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170914/884e4e6d/attachment.html>

From even.rouault at spatialys.com  Thu Sep 14 04:42:08 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 14 Sep 2017 13:42:08 +0200
Subject: [gdal-dev] Fwd: GeoPKG Zoom Level Calculation
In-Reply-To: <CADyWFeVgZXmQOEYixZ5qUt8jBoaVg2fiC6pvB-v6y7CtPUOYHQ@mail.gmail.com>
References: <mailman.5250.1505334643.21183.gdal-dev@lists.osgeo.org>
 <1895798.IckIYZ77e6@even-i700>
 <CADyWFeVgZXmQOEYixZ5qUt8jBoaVg2fiC6pvB-v6y7CtPUOYHQ@mail.gmail.com>
Message-ID: <2212409.heke9QuWfr@even-i700>

On jeudi 14 septembre 2017 06:26:40 CEST Roarke Gaskill wrote:
> Even,
> 
> Thanks for your reply.  I get it now.  :)
> 
> I am new to gdal in general.  For context, why does CreateCopy() choose the
> nearest zoom level and not SetGeoTransform()?  

Most drivers don't handle directly this concept of predefined tiling schemes, and if you want 
to apply one, you need to use gdalwarp and setting correctly the extent, resolution, etc... The 
CreateCopy() implementation in the GPKG driver, when tiling scheme is specified, does that 
automatically for you.

But if you do SetGeoTransform() manually and then use the RasterIO() API, no resampling 
can occur at that level of the driver (like any other drivers), so you have to specify a 
resolution that respect the constraints of the tiling scheme.

> As a new user, it seems to
> me the ZOOM_LEVEL_STRATEGY should apply to both the SetGeoTransform() and
> CreateCopy().

I've just added a precision in the doc to mention that ZOOM_LEVEL_STRATEGY only applies 
to CreateCopy()

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170914/4be7f7bb/attachment.html>

From roarke.gaskill at weather.com  Thu Sep 14 05:08:06 2017
From: roarke.gaskill at weather.com (Roarke Gaskill)
Date: Thu, 14 Sep 2017 07:08:06 -0500
Subject: [gdal-dev] Fwd: GeoPKG Zoom Level Calculation
In-Reply-To: <2212409.heke9QuWfr@even-i700>
References: <mailman.5250.1505334643.21183.gdal-dev@lists.osgeo.org>
 <1895798.IckIYZ77e6@even-i700>
 <CADyWFeVgZXmQOEYixZ5qUt8jBoaVg2fiC6pvB-v6y7CtPUOYHQ@mail.gmail.com>
 <2212409.heke9QuWfr@even-i700>
Message-ID: <CADyWFeVcWsQU6xysBXpczc1ybDOAWskev4Wp91TGcGvX61vxFg@mail.gmail.com>

Very cool, thank you for the explanation and the doc update.



On Thu, Sep 14, 2017 at 6:42 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> On jeudi 14 septembre 2017 06:26:40 CEST Roarke Gaskill wrote:
>
> > Even,
>
> >
>
> > Thanks for your reply. I get it now. :)
>
> >
>
> > I am new to gdal in general. For context, why does CreateCopy() choose
> the
>
> > nearest zoom level and not SetGeoTransform()?
>
>
>
> Most drivers don't handle directly this concept of predefined tiling
> schemes, and if you want to apply one, you need to use gdalwarp and setting
> correctly the extent, resolution, etc... The CreateCopy() implementation in
> the GPKG driver, when tiling scheme is specified, does that automatically
> for you.
>
>
>
> But if you do SetGeoTransform() manually and then use the RasterIO() API,
> no resampling can occur at that level of the driver (like any other
> drivers), so you have to specify a resolution that respect the constraints
> of the tiling scheme.
>
>
>
> > As a new user, it seems to
>
> > me the ZOOM_LEVEL_STRATEGY should apply to both the SetGeoTransform() and
>
> > CreateCopy().
>
>
>
> I've just added a precision in the doc to mention that ZOOM_LEVEL_STRATEGY
> only applies to CreateCopy()
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>



-- 
*Roarke **Gaskill  *|Senior Software Engineer
*e:* roarke.gaskill at weather.com
<http://weather.com/apps> <http://weather.com/apps>
<http://weather.com/apps> <http://weather.com/apps>
<http://weather.com/apps> <http://weather.com/apps>
<http://weather.com/apps> <http://weather.com/apps>
<http://weather.com/apps> <http://weather.com/apps>
<http://weather.com/apps> <http://weather.com/apps>
<http://weather.com/apps> <http://weather.com/apps>
<http://weather.com/apps> <http://weather.com/apps>
<http://weather.com/apps>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170914/fa140b1f/attachment-0001.html>

From even.rouault at spatialys.com  Thu Sep 14 07:59:04 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 14 Sep 2017 16:59:04 +0200
Subject: [gdal-dev] shapelib 1.4.1 release
Message-ID: <2156479.X1kzvuPtlQ@even-i700>

Hi,

(CC'ing gdal-dev as well, since shapelib at lists.maptools.org has likely lower audience)

I've released shapelib 1.4.1

The main change is a fix for a regression that affects 1.4.0 regarding re-writing the last 
shape of a file (https://trac.osgeo.org/gdal/ticket/7031)

The tarballs are available at:
http://download.osgeo.org/shapelib/shapelib-1.4.1.tar.gz
http://download.osgeo.org/shapelib/shapelib-1.4.1.zip

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170914/30a5fd55/attachment.html>

From jmckenna at gatewaygeomatics.com  Thu Sep 14 09:56:28 2017
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Thu, 14 Sep 2017 13:56:28 -0300
Subject: [gdal-dev] shapelib 1.4.1 release
In-Reply-To: <2156479.X1kzvuPtlQ@even-i700>
References: <2156479.X1kzvuPtlQ@even-i700>
Message-ID: <84cdd118-5027-4ca1-3e6d-b9bcfada9147@gatewaygeomatics.com>

On 2017-09-14 11:59 AM, Even Rouault wrote:
> Hi,
> 
> (CC'ing gdal-dev as well, since shapelib at lists.maptools.org has likely 
> lower audience)
> 
> I've released shapelib 1.4.1
> 
> The main change is a fix for a regression that affects 1.4.0 regarding 
> re-writing the last shape of a file 
> (https://trac.osgeo.org/gdal/ticket/7031)
> 
> The tarballs are available at:
> 
> http://download.osgeo.org/shapelib/shapelib-1.4.1.tar.gz
> 
> http://download.osgeo.org/shapelib/shapelib-1.4.1.zip
> 

Thanks Even.  For the record MS4W still distributes shapelib and its 14 
commandline utilities, on Windows.  I'll be sure to upgrade this to 
1.4.1 (http://www.ms4w.com/trac/ticket/134).

-jeff




-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/






From even.rouault at spatialys.com  Thu Sep 14 12:23:32 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 14 Sep 2017 21:23:32 +0200
Subject: [gdal-dev] illegal axis orientation combination when
	re-projecting
In-Reply-To: <56fa8b43-609f-479c-85a1-85e0d5f43470@me.com>
References: <56fa8b43-609f-479c-85a1-85e0d5f43470@me.com>
Message-ID: <7437006.jSdse4TMhQ@even-i700>

On jeudi 14 septembre 2017 03:41:33 CEST Nick Cummins wrote:
> Hey, I was able to solve by issue by compiling and installing GDAL from
> source with --with-static-proj4 set. Thanks for the help.
> 

Hum this could well be a sign that there's another libproj.so lying in your filesystem in a 
directory in the library search paths, perhaps in /usr/local/lib or LD_LIBRARY_PATH or in one 
of the directories pointed by ld.so.conf. Otherwise I don't have an explanation why this would 
crash.

> 
> On Sep 13, 2017, at 09:58 AM, Nick Cummins <nickmcummins at icloud.com> wrote:
> 
> 
> ➜ ls -lah /usr/lib/ | grep -i libproj  
> lrwxrwxrwx   1 root root    17 Sep 14  2016 libproj.so -> libproj.so.12.0.0
> lrwxrwxrwx   1 root root    17 Sep 14  2016 libproj.so.12 ->
> libproj.so.12.0.0 -rwxr-xr-x   1 root root  423K Sep 14  2016
> libproj.so.12.0.0
> 
> Also,
> ➜ ldd /usr/bin/ogr2ogr | grep -i proj
> libproj.so.12 => /usr/lib/libproj.so.12 (0x00007fcbcfd92000)
> ➜ /usr/bin/ogr2ogr | grep -i spatial
> libspatialite.so.7 => /usr/lib/libspatialite.so.7 (0x00007f20274ad000)
> ➜ ldd /usr/lib/libspatialite.so.7 | grep -i proj
> libproj.so.12 => /usr/lib/libproj.so.12 (0x00007f7c7a032000)
> 
> ➜ print $LD_LIBRARY_PATH
> /usr/lib:/usr/lib32
> 
> 
> On Sep 13, 2017, at 02:22 AM, Even Rouault <even.rouault at spatialys.com>
> wrote:
> On mardi 12 septembre 2017 23:47:09 CEST Nick Cummins wrote:
> > I am using Arch Linux (continuous/rolling distro), using gdal from the
> > 
> > official repositories.
> > 
> > 
> > 
> > Using proj. 4.9.3-1 from official repos.
> > 
> > As mentioned, previously (within the past month) the first re-projection
> > 
> > example was working fine. Suddenly today I was analyzing a different tile
> > 
> > and ran into the error, and I have not made any changes to my setup that I
> > 
> > am aware of that would change behavior. 
> > 
> > 
> > 
> > Output of running ogr2ogr with valgrind in attached file.
> 
>  
> 
> It crashes in proj.4. But the lines mentionned are weird : pj_free
> (pj_init.c:496). At line 496 of pj_init.c, this is not the pj_free()
> function. Perhaps due to optimizations that mess up line reporting. I tried
> with proj 4.9.3 and it works fine for me.
> 
>  
> 
> I see from
> 
> https://git.archlinux.org/svntogit/community.git/tree/trunk/PKGBUILD?h=packa
> ges/gdal that archlinux doesn't build with GDAL with --with-static-proj4, so
> I'm wondering if there isn't a mix of proj.4 versions. Isn't there a chance
> that one of the dependencies of GDAL links against a libproj.so.X
> (spatialite could be a good candidate) and that GDAL then loads a
> libproj.so that is a symlink to libproj.so.Y
> 
> Can you check your /usr/lib/libproj.so* files ?
> 
>  
> 
> Even
> 
>  
> 
> --
> 
> Spatialys - Geospatial professional services
> 
> http://www.spatialys.com


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170914/ece28a1e/attachment.html>

From even.rouault at spatialys.com  Fri Sep 15 03:53:05 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 15 Sep 2017 12:53:05 +0200
Subject: [gdal-dev] GDAL 2.2.2 release candidate
Message-ID: <8115098.YC0iDY7Ket@even-i700>

Hi,

I have prepared a GDAL/OGR 2.2.2 release candidate.

Peek up an archive among the following ones (by ascending size):

  http://download.osgeo.org/gdal/2.2.2/gdal-2.2.2RC1.tar.xz
  http://download.osgeo.org/gdal/2.2.2/gdal-2.2.2RC1.tar.gz
  http://download.osgeo.org/gdal/2.2.2/gdal222RC1.zip

A snapshot of the gdalautotest suite is also available :

  http://download.osgeo.org/gdal/2.2.2/gdalautotest-2.2.2.tar.gz
  http://download.osgeo.org/gdal/2.2.2/gdalautotest-2.2.2.zip

The NEWS file is here :

  http://trac.osgeo.org/gdal/wiki/Release/2.2.2-News

I'll call for a vote promoting them to final in the middle of next week if no
serious problems are reported before.

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170915/03a49af8/attachment.html>

From jmckenna at gatewaygeomatics.com  Fri Sep 15 09:52:06 2017
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Fri, 15 Sep 2017 13:52:06 -0300
Subject: [gdal-dev] GDAL 2.2.2 release candidate
In-Reply-To: <8115098.YC0iDY7Ket@even-i700>
References: <8115098.YC0iDY7Ket@even-i700>
Message-ID: <4b0ec40c-66e3-2fe6-01bb-0a74da178538@gatewaygeomatics.com>

On 2017-09-15 7:53 AM, Even Rouault wrote:
> Hi,
> 
> I have prepared a GDAL/OGR 2.2.2 release candidate.
> 
> Peek up an archive among the following ones (by ascending size):
> 
> http://download.osgeo.org/gdal/2.2.2/gdal-2.2.2RC1.tar.xz
> 
> http://download.osgeo.org/gdal/2.2.2/gdal-2.2.2RC1.tar.gz
> 
> http://download.osgeo.org/gdal/2.2.2/gdal222RC1.zip
> 
> A snapshot of the gdalautotest suite is also available :
> 
> http://download.osgeo.org/gdal/2.2.2/gdalautotest-2.2.2.tar.gz
> 
> http://download.osgeo.org/gdal/2.2.2/gdalautotest-2.2.2.zip
> 
> The NEWS file is here :
> 
> http://trac.osgeo.org/gdal/wiki/Release/2.2.2-News
> 
> I'll call for a vote promoting them to final in the middle of next week 
> if no
> 
> serious problems are reported before.
> 

Seems to work well on Windows (my tests are pointing to a poppler lib).

-jeff



-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/





From even.rouault at spatialys.com  Fri Sep 15 10:04:27 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 15 Sep 2017 19:04:27 +0200
Subject: [gdal-dev] GDAL 2.2.2 release candidate
In-Reply-To: <4b0ec40c-66e3-2fe6-01bb-0a74da178538@gatewaygeomatics.com>
References: <8115098.YC0iDY7Ket@even-i700>
 <4b0ec40c-66e3-2fe6-01bb-0a74da178538@gatewaygeomatics.com>
Message-ID: <11601890.dDhpQ7liGW@even-i700>

> Seems to work well on Windows (my tests are pointing to a 
poppler lib).

Jeff,

what do you mean with "my tests are pointing to a poppler lib" ?

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170915/a5ecd14d/attachment.html>

From jmckenna at gatewaygeomatics.com  Fri Sep 15 10:06:13 2017
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Fri, 15 Sep 2017 14:06:13 -0300
Subject: [gdal-dev] GDAL 2.2.2 release candidate
In-Reply-To: <4b0ec40c-66e3-2fe6-01bb-0a74da178538@gatewaygeomatics.com>
References: <8115098.YC0iDY7Ket@even-i700>
 <4b0ec40c-66e3-2fe6-01bb-0a74da178538@gatewaygeomatics.com>
Message-ID: <d66ecd02-2867-82c4-4d31-a6b9bfe490a0@gatewaygeomatics.com>

On 2017-09-15 1:52 PM, Jeff McKenna wrote:
> On 2017-09-15 7:53 AM, Even Rouault wrote:
>> Hi,
>>
>> I have prepared a GDAL/OGR 2.2.2 release candidate.
>>
>> Peek up an archive among the following ones (by ascending size):
>>
>> http://download.osgeo.org/gdal/2.2.2/gdal-2.2.2RC1.tar.xz
>>
>> http://download.osgeo.org/gdal/2.2.2/gdal-2.2.2RC1.tar.gz
>>
>> http://download.osgeo.org/gdal/2.2.2/gdal222RC1.zip
>>
>> A snapshot of the gdalautotest suite is also available :
>>
>> http://download.osgeo.org/gdal/2.2.2/gdalautotest-2.2.2.tar.gz
>>
>> http://download.osgeo.org/gdal/2.2.2/gdalautotest-2.2.2.zip
>>
>> The NEWS file is here :
>>
>> http://trac.osgeo.org/gdal/wiki/Release/2.2.2-News
>>
>> I'll call for a vote promoting them to final in the middle of next 
>> week if no
>>
>> serious problems are reported before.
>>
> 
> Seems to work well on Windows (my tests are pointing to a poppler lib).
> 
> -jeff
> 
> 
> 

More feedback: without poppler, the driver status is displayed as "PDF - 
raster,vector- (w+): Geospatial PDF"

Actually I was expecting to not see "(w+)" but "(ro)" instead, according 
to the NEWS for this release.

-jeff



-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/






From jmckenna at gatewaygeomatics.com  Fri Sep 15 10:07:39 2017
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Fri, 15 Sep 2017 14:07:39 -0300
Subject: [gdal-dev] GDAL 2.2.2 release candidate
In-Reply-To: <11601890.dDhpQ7liGW@even-i700>
References: <8115098.YC0iDY7Ket@even-i700>
 <4b0ec40c-66e3-2fe6-01bb-0a74da178538@gatewaygeomatics.com>
 <11601890.dDhpQ7liGW@even-i700>
Message-ID: <6d4688d1-9252-1d31-4fe3-e42bc9b343f7@gatewaygeomatics.com>

On 2017-09-15 2:04 PM, Even Rouault wrote:
>  > Seems to work well on Windows (my tests are pointing to a poppler lib).
> 
> Jeff,
> 
> what do you mean with "my tests are pointing to a poppler lib" ?
> 
> Even
>

Sorry, I mean I am compiling against a build of the poppler library.

My previous message tests without that library.

-jeff



-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/

From jmckenna at gatewaygeomatics.com  Fri Sep 15 10:12:04 2017
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Fri, 15 Sep 2017 14:12:04 -0300
Subject: [gdal-dev] GDAL 2.2.2 release candidate
In-Reply-To: <d66ecd02-2867-82c4-4d31-a6b9bfe490a0@gatewaygeomatics.com>
References: <8115098.YC0iDY7Ket@even-i700>
 <4b0ec40c-66e3-2fe6-01bb-0a74da178538@gatewaygeomatics.com>
 <d66ecd02-2867-82c4-4d31-a6b9bfe490a0@gatewaygeomatics.com>
Message-ID: <7dbbd0a8-a8be-e6dd-d4af-a819c1b495a4@gatewaygeomatics.com>

On 2017-09-15 2:06 PM, Jeff McKenna wrote:
> On 2017-09-15 1:52 PM, Jeff McKenna wrote:
>> On 2017-09-15 7:53 AM, Even Rouault wrote:
>>> Hi,
>>>
>>> I have prepared a GDAL/OGR 2.2.2 release candidate.
>>>
>>> Peek up an archive among the following ones (by ascending size):
>>>
>>> http://download.osgeo.org/gdal/2.2.2/gdal-2.2.2RC1.tar.xz
>>>
>>> http://download.osgeo.org/gdal/2.2.2/gdal-2.2.2RC1.tar.gz
>>>
>>> http://download.osgeo.org/gdal/2.2.2/gdal222RC1.zip
>>>
>>> A snapshot of the gdalautotest suite is also available :
>>>
>>> http://download.osgeo.org/gdal/2.2.2/gdalautotest-2.2.2.tar.gz
>>>
>>> http://download.osgeo.org/gdal/2.2.2/gdalautotest-2.2.2.zip
>>>
>>> The NEWS file is here :
>>>
>>> http://trac.osgeo.org/gdal/wiki/Release/2.2.2-News
>>>
>>> I'll call for a vote promoting them to final in the middle of next 
>>> week if no
>>>
>>> serious problems are reported before.
>>>
>>
>> Seems to work well on Windows (my tests are pointing to a poppler lib).
>>
>> -jeff
>>
>>
>>
> 
> More feedback: without poppler, the driver status is displayed as "PDF - 
> raster,vector- (w+): Geospatial PDF"
> 
> Actually I was expecting to not see "(w+)" but "(ro)" instead, according 
> to the NEWS for this release.
> 
> -jeff
> 
> 
> 

My apologies, I misread the NEWS on the release, "(w+)" is expected. 
Ignore my messages :)

-jeff



-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/

From schwehr at gmail.com  Fri Sep 15 15:18:48 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Fri, 15 Sep 2017 15:18:48 -0700
Subject: [gdal-dev] Kakadu 7.10 (7_A)
In-Reply-To: <CACmBxyuWrvYHtmL8yOjc_BVTEGRxsWFWeAD2Gh9i0AdBUwiWOQ@mail.gmail.com>
References: <CACmBxysqiefhE_yxqOsv7489FYfXQ_9mB6y-YQ_AG2jiNh2QKg@mail.gmail.com>
 <CACmBxyuTyvFM21N5BzS99ASnN=N5G90W5-YqmpfXRXcL3hnjNg@mail.gmail.com>
 <CACmBxyuRC0NXTccLrns3XYqVG4YodtbD8xztCiVyBEhnVBmqyQ@mail.gmail.com>
 <CACmBxytaPDbHgJ7_uiyTQjkLhrAjhCOodBu-gnQQ3_sRt7=nVA@mail.gmail.com>
 <CACmBxytWB_L1YGjqgfnBb+jhayWq4CTMe=HZEQr-2KFVuW41wA@mail.gmail.com>
 <CACmBxyuWrvYHtmL8yOjc_BVTEGRxsWFWeAD2Gh9i0AdBUwiWOQ@mail.gmail.com>
Message-ID: <CACmBxyvDA1Ux+fcfPO6PqbOdCNU9aMB1-u7hU7wUAT1wxBSXrQ@mail.gmail.com>

7_A_2 is out...

---------- Forwarded message ----------
From: nick.howden at utas.utc.com [kakadu_jpeg2000] <
kakadu_jpeg2000 at yahoogroups.com>
Date: Fri, Sep 15, 2017 at 8:39 AM
Subject: [kakadu_jpeg2000] Re: Error compiling GDAL with Kakadu vs7_A_2
To: kakadu_jpeg2000 at yahoogroups.com


Sorry, realised the answer to my own question

Within the GDAL sources, frmts/jp2kak/jp2kak.lst needs to be patched to
support the latest Kakadu


KAK_OBJ += ${KAKDIR}/apps/make/supp_local.o" >> frmts/jp2kak/jp2kak.lst


I'll log an issue with GDAL to implement this properly

On Mon, Aug 21, 2017 at 8:40 AM, Kurt Schwehr <schwehr at gmail.com> wrote:

> And (as of yesterday) there is new a 7.10.1 (v7_A_1) that has integer math
> overflow detection.
>
> On Wed, Aug 16, 2017 at 7:41 AM, Kurt Schwehr <schwehr at gmail.com> wrote:
>
>> Hi all,
>>
>> Kakadu 7.10 just came out. It's a major rework of memory management to
>> allow callers to constrain how much memory is used. My initial testing
>> gives me a couple crashes.  I was able to trigger a few of the asserts
>> pretty quickly.  I will be investigating over the next week or two and will
>> share what I can.
>>
>> -kurt
>>
>
>
>
> --
> --
> http://schwehr.org
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170915/9399f61b/attachment.html>

From andrew at aitchison.me.uk  Sun Sep 17 02:37:29 2017
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Sun, 17 Sep 2017 10:37:29 +0100 (BST)
Subject: [gdal-dev] GDAL 2.2.2 release candidate
In-Reply-To: <8115098.YC0iDY7Ket@even-i700>
References: <8115098.YC0iDY7Ket@even-i700>
Message-ID: <alpine.LRH.2.21.1709161717030.15789@warden.aitchison.me.uk>

On Fri, 15 Sep 2017, Even Rouault wrote:

> Hi,
>
> I have prepared a GDAL/OGR 2.2.2 release candidate.
>
> Peek up an archive among the following ones (by ascending size):
>
>  http://download.osgeo.org/gdal/2.2.2/gdal-2.2.2RC1.tar.xz
>  http://download.osgeo.org/gdal/2.2.2/gdal-2.2.2RC1.tar.gz
>  http://download.osgeo.org/gdal/2.2.2/gdal222RC1.zip

No build problems on Scientific Linux 6 with system compiler.

No problems using it so far.

-- 
Andrew C Aitchison


From mateusz at loskot.net  Sun Sep 17 11:51:50 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sun, 17 Sep 2017 20:51:50 +0200
Subject: [gdal-dev] GDAL 2.2.2 release candidate
In-Reply-To: <alpine.LRH.2.21.1709161717030.15789@warden.aitchison.me.uk>
References: <8115098.YC0iDY7Ket@even-i700>
 <alpine.LRH.2.21.1709161717030.15789@warden.aitchison.me.uk>
Message-ID: <CABUeae_x30f0cc5RtODkYo0_W7RrKA16dpOLj=QK_ZhUG+=hRA@mail.gmail.com>

On 17 September 2017 at 11:37, Andrew C Aitchison
<andrew at aitchison.me.uk> wrote:
> On Fri, 15 Sep 2017, Even Rouault wrote:
>>
>> I have prepared a GDAL/OGR 2.2.2 release candidate.
>>
>> Peek up an archive among the following ones (by ascending size):
>>
>>  http://download.osgeo.org/gdal/2.2.2/gdal-2.2.2RC1.tar.xz
>>  http://download.osgeo.org/gdal/2.2.2/gdal-2.2.2RC1.tar.gz
>>  http://download.osgeo.org/gdal/2.2.2/gdal222RC1.zip
>
>
> No build problems on Scientific Linux 6 with system compiler.
>
> No problems using it so far.

I've run quick check building basic configuration inside "Bash on Windows",
environment based on Ubuntu 14.04.5 LTS, using GCC 7.2.

All fine.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From nik at nixanz.com  Sun Sep 17 19:50:42 2017
From: nik at nixanz.com (Nik Sands)
Date: Mon, 18 Sep 2017 12:50:42 +1000
Subject: [gdal-dev] Attempt to delete layer fails - table locked
Message-ID: <1F1A9B88-F6CA-4BC5-9A8C-B3F47D3EA2F7@nixanz.com>

Hi Dev list,

I’m attempting to delete a layer using OGR_DS_DeleteLayer(), however, it results in errors like:

ERROR 1: sqlite3_exec(DROP TABLE "rtree_Track_2017_09_18_12_41_03_Line_geom") failed: database table is locked
ERROR 1: sqlite3_exec(DROP TABLE 'Track_2017_09_18_12_41_03_Line') failed: database table is locked

I presume that this is because recently new features were added to the layer and it is still considered open/locked.

What is the correct way to release locks so that I can then delete the layer?

Cheers,
Nik.

========================================================
NIK SANDS
Line Tamer | Time Traveller | Space Cadet


From kai.muehlbauer at uni-bonn.de  Sun Sep 17 22:32:10 2017
From: kai.muehlbauer at uni-bonn.de (Kai Muehlbauer)
Date: Mon, 18 Sep 2017 07:32:10 +0200
Subject: [gdal-dev] shapelib 1.4.1 release
In-Reply-To: <84cdd118-5027-4ca1-3e6d-b9bcfada9147@gatewaygeomatics.com>
References: <2156479.X1kzvuPtlQ@even-i700>
 <84cdd118-5027-4ca1-3e6d-b9bcfada9147@gatewaygeomatics.com>
Message-ID: <146dff2c-e816-3379-566f-8092eb35b88b@uni-bonn.de>

Hi,

Am 14.09.2017 um 18:56 schrieb Jeff McKenna:
> On 2017-09-14 11:59 AM, Even Rouault wrote:
>> Hi,
>>
>> (CC'ing gdal-dev as well, since shapelib at lists.maptools.org has likely
>> lower audience)
>>
>> I've released shapelib 1.4.1

[snip]

> 
> Thanks Even.  For the record MS4W still distributes shapelib and its 14
> commandline utilities, on Windows.  I'll be sure to upgrade this to
> 1.4.1 (http://www.ms4w.com/trac/ticket/134).
> 
> -jeff

just for the sake of completeness, the conda-forge community channel
(https://anaconda.org/conda-forge/shapelib) is building shapelib for
linux, macosx and windows (32 & 64). Version 1.4.1 is already available.

- Kai

From even.rouault at spatialys.com  Mon Sep 18 00:40:08 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 18 Sep 2017 09:40:08 +0200
Subject: [gdal-dev] Attempt to delete layer fails - table locked
In-Reply-To: <1F1A9B88-F6CA-4BC5-9A8C-B3F47D3EA2F7@nixanz.com>
References: <1F1A9B88-F6CA-4BC5-9A8C-B3F47D3EA2F7@nixanz.com>
Message-ID: <8433004.cGS9L4nCTo@even-i700>

Nik,

You didn't mention which GDAL version you use, and the file format (from the error message, 
I presume it is GeoPackage)

I didn't manage to reproduce with trunk, 2.2 or 2.1 or even 2.0 and the following actions:

$ ogr2ogr -f gpkg poly.gpkg poly.shp
$ python
from osgeo import ogr
ds = ogr.Open('poly.gpkg', update = 1)
sql_lyr = ds.ExecuteSQL('SELECT * from poly')
lyr = ds.GetLayer(0)
lyr.CreateFeature(ogr.Feature(lyr.GetLayerDefn()))
lyr  = None
ds.DeleteLayer(0)
ds = None

DeleteLayer() normally cleans up the read and write sqlite3 statements still active on that 
layer

But if you do:
from osgeo import ogr
ds = ogr.Open('poly.gpkg', update = 1)
sql_lyr = ds.ExecuteSQL('SELECT * from poly') <-- new command added
lyr = ds.GetLayer(0)
lyr.CreateFeature(ogr.Feature(lyr.GetLayerDefn()))
lyr  = None
ds.DeleteLayer(0)
ds = None

I do get those errors since the ExecuteSQL() layer still holds a sqlite3 statement that the 
layer isn't aware of.

Another variation that gives the error:

$ ogr2ogr -f gpkg poly.gpkg poly.shp
$ ogr2ogr -update poly.gpkg poly.shp -nln another_layer
$ python
from osgeo import ogr
ds = ogr.Open('poly.gpkg', update = 1)

lyr2 = ds.GetLayerByName('another_layer')
lyr2.GetNextFeature() <-- will start a new sqlite3 statement

lyr = ds.GetLayerByName('poly')
lyr.CreateFeature(ogr.Feature(lyr.GetLayerDefn()))
lyr  = None

ds.DeleteLayer(0)
ds = None

So any pending sqlite3 statement, not only those on the layer, prevents the table from being 
deleted. I presume your complete use case must be close to the 2 last above cases

The workaround is to explicitly call ResetReading() on all layers that you have read and/or 
write, and ReleaseResultSet() on all layers returned by ExecuteSQL().
I'm pondering whether the driver shouldn't do that automatically (of course that wouldn't 
help if another dataset object is opened on the same file in the same or a different process)


Een

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170918/c85cf4af/attachment.html>

From nik at nixanz.com  Sun Sep 17 19:25:47 2017
From: nik at nixanz.com (Nik Sands)
Date: Mon, 18 Sep 2017 12:25:47 +1000
Subject: [gdal-dev] Cannot delete layer - table is locked
Message-ID: <93FC07FF-98DF-4F36-885E-63E5DC27063F@nixanz.com>

Hi GDAL devs,

What is the correct way in GDAL/OGR to release locks on the layer (in this case the SQLite tables in a geopackage) so that the layer can be deleted from the data source?

My issue is that after writing new features to a layer, I may want to delete the layer completely, but when I do so using:

	OGR_DS_DeleteLayer()

I get errors like:

ERROR 1: sqlite3_exec(DROP TABLE "rtree_Track_2017_09_18_12_14_09_Line_geom") failed: database table is locked
ERROR 1: sqlite3_exec(DROP TABLE 'Track_2017_09_18_12_14_09_Line') failed: database table is locked

What is the correct way to handle this situation, so that I can add features to a layer, but then delete it?

Cheers,
Nik.


========================================================
NIK SANDS
Line Tamer | Time Traveller | Space Cadet


From schwehr at gmail.com  Mon Sep 18 08:02:35 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Mon, 18 Sep 2017 08:02:35 -0700
Subject: [gdal-dev] GDAL 2.2.2 release candidate
In-Reply-To: <CABUeae_x30f0cc5RtODkYo0_W7RrKA16dpOLj=QK_ZhUG+=hRA@mail.gmail.com>
References: <8115098.YC0iDY7Ket@even-i700>
 <alpine.LRH.2.21.1709161717030.15789@warden.aitchison.me.uk>
 <CABUeae_x30f0cc5RtODkYo0_W7RrKA16dpOLj=QK_ZhUG+=hRA@mail.gmail.com>
Message-ID: <CACmBxyuLxWQj8KsYCbv+aBrEpLKYPvWNwVkg2yr7P5ZD8EEubg@mail.gmail.com>

+1 on RC1

I tested the build with fink and think all of these failures are likely
just from old libs being used in the fink config on Mac OSX 10.12.

-kurt

 ------------ Failures ------------
Script: ogr/ogr_gft.py
  TEST: ogr_gft_read ... fail
    line 97: did not get expected feature count
Script: ogr/ogr_gpkg.py
  TEST: ogr_gpkg_18 ... fail
    line 1560: validation unexpectedly succeeded
Script: ogr/ogr_ogdi.py
  TEST: ogr_ogdi_4 ... fail
    line 194: cannot open dataset
Script: gcore/basic_test.py
  TEST: basic_test_8 ... fail
    line 173: fail
Script: gcore/tiff_write.py
  TEST: tiff_write_87 ... fail (blowup)
  TEST: tiff_write_126 ... fail
    line 5245: fail
Script: gdrivers/jpeg.py
  TEST: jpeg_1 ... fail
    line 566: Checksum for band 2 in "albania.jpg" is 34296, but expected
17016.
  TEST: jpeg_16 ... fail
    line 580: fail
Script: gdrivers/mbtiles.py
  TEST: mbtiles_2 ... fail
    line 84: for band 2, cs = 14034, different from expected_cs = 19386
Script: gdrivers/mrf.py
  TEST: myTestCreateCopy: 12bit_rose_extract.jpg ['COMPRESS=JPEG'] ... fail
    line 626: Failed to create test file using CreateCopy method.
Can't create tmp/12bit_rose_extract.jpg.tst
Script: gdrivers/rasterlite.py
  TEST: rasterlite_2 ... fail
    line 116: for band 2, cs = 20083, different from expected_cs = 19843
Script: gdrivers/vrtderived.py
  TEST: vrtderived_7 ... fail
    line 264: fail
Script: utilities/test_gdalwarp.py
  TEST: test_gdalwarp_28 ... fail
    line 735: Bad checksum
Script: pyscripts/test_gdal_retile.py
  TEST: test_gdal_retile_cleanup ... fail (blowup)

otool -L /sw/bin/gdalinfo
/sw/bin/gdalinfo:
/sw/lib/libgdal.20.dylib (compatibility version 24.0.0, current version
24.1.0)
/sw/lib/libproj.9.dylib (compatibility version 11.0.0, current version
11.0.0)
/sw/lib/libjson-c.2.dylib (compatibility version 3.0.0, current version
3.2.0)
/sw/lib/libfreexl.1.dylib (compatibility version 3.0.0, current version
3.0.0)
/sw/opt/libgeos3.5.0/lib/libgeos_c.1.dylib (compatibility version 11.0.0,
current version 11.0.0)
/sw/lib/webp7/libwebp.7.dylib (compatibility version 8.0.0, current version
8.0.0)
/sw/lib/libsqlite3.0.dylib (compatibility version 9.0.0, current version
9.6.0)
/sw/lib/libodbc.2.dylib (compatibility version 3.0.0, current version 3.0.0)
/sw/lib/libodbcinst.2.dylib (compatibility version 3.0.0, current version
3.0.0)
/sw/lib/libexpat.1.dylib (compatibility version 8.0.0, current version
8.5.0)
/sw/lib/libxerces-c-3.1.dylib (compatibility version 3.1.1, current version
3.1.1)
/sw/lib/libopenjp2.7.dylib (compatibility version 7.0.0, current version
2.1.1)
/sw/lib/libjasper.1.dylib (compatibility version 2.0.0, current version
2.0.0)
/sw/lib/libnetcdf.11.dylib (compatibility version 12.0.0, current version
12.4.0)
/sw/lib/libhdf5.10.dylib (compatibility version 12.0.0, current version
12.0.0)
/sw/lib/libogdi31.dylib (compatibility version 3.1.0, current version 3.1.5)
/sw/lib/libgif.7.dylib (compatibility version 8.0.0, current version 8.0.0)
/sw/lib/libjpeg.9.dylib (compatibility version 12.0.0, current version
12.0.0)
/sw/lib/libgeotiff.2.dylib (compatibility version 4.0.0, current version
4.1.0)
/sw/lib/libtiff.5.dylib (compatibility version 8.0.0, current version 8.6.0)
/sw/lib/libpng16.16.dylib (compatibility version 47.0.0, current version
47.0.0)
/sw/lib/liblzma.5.dylib (compatibility version 8.0.0, current version 8.3.0)
/usr/lib/libz.1.dylib (compatibility version 1.0.0, current version 1.2.8)
/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version
1238.60.2)
/sw/lib/libspatialite.7.dylib (compatibility version 9.0.0, current version
9.0.0)
/sw/lib/libpcre1/libpcre.1.dylib (compatibility version 4.0.0, current
version 4.9.0)
/sw/lib/libcurl.4.dylib (compatibility version 9.0.0, current version 9.0.0)
/sw/lib/libiconv.2.dylib (compatibility version 8.0.0, current version
8.1.0)
/sw/lib/libxml2.2.dylib (compatibility version 12.0.0, current version
12.4.0)
/usr/lib/libc++.1.dylib (compatibility version 1.0.0, current version
307.5.0)


On Sun, Sep 17, 2017 at 11:51 AM, Mateusz Loskot <mateusz at loskot.net> wrote:

> On 17 September 2017 at 11:37, Andrew C Aitchison
> <andrew at aitchison.me.uk> wrote:
> > On Fri, 15 Sep 2017, Even Rouault wrote:
> >>
> >> I have prepared a GDAL/OGR 2.2.2 release candidate.
> >>
> >> Peek up an archive among the following ones (by ascending size):
> >>
> >>  http://download.osgeo.org/gdal/2.2.2/gdal-2.2.2RC1.tar.xz
> >>  http://download.osgeo.org/gdal/2.2.2/gdal-2.2.2RC1.tar.gz
> >>  http://download.osgeo.org/gdal/2.2.2/gdal222RC1.zip
> >
> >
> > No build problems on Scientific Linux 6 with system compiler.
> >
> > No problems using it so far.
>
> I've run quick check building basic configuration inside "Bash on Windows",
> environment based on Ubuntu 14.04.5 LTS, using GCC 7.2.
>
> All fine.
>
> Best regards,
> --
> Mateusz Loskot, http://mateusz.loskot.net
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170918/e6615e27/attachment-0001.html>

From a.furieri at lqt.it  Mon Sep 18 08:01:21 2017
From: a.furieri at lqt.it (a.furieri at lqt.it)
Date: Mon, 18 Sep 2017 17:01:21 +0200
Subject: [gdal-dev] Cannot delete layer - table is locked
In-Reply-To: <93FC07FF-98DF-4F36-885E-63E5DC27063F@nixanz.com>
References: <93FC07FF-98DF-4F36-885E-63E5DC27063F@nixanz.com>
Message-ID: <6ca20f08f78ae4d96237ff7d40dadc14@lqt.it>

On Mon, 18 Sep 2017 12:25:47 +1000, Nik Sands wrote:
> Hi GDAL devs,
>
> What is the correct way in GDAL/OGR to release locks on the layer (in
> this case the SQLite tables in a geopackage) so that the layer can be
> deleted from the data source?
>
> My issue is that after writing new features to a layer, I may want to
> delete the layer completely, but when I do so using:
>
> 	OGR_DS_DeleteLayer()
>
> I get errors like:
>
> ERROR 1: sqlite3_exec(DROP TABLE
> "rtree_Track_2017_09_18_12_14_09_Line_geom") failed: database table 
> is
> locked
> ERROR 1: sqlite3_exec(DROP TABLE 'Track_2017_09_18_12_14_09_Line')
> failed: database table is locked
>
> What is the correct way to handle this situation, so that I can add
> features to a layer, but then delete it?
>

Hi Nik,

SQLite always refuses to DROP any table still being required
by an ongoing SQL query; in this case a SQLITE_LOCKED error
will be raised, corresponding to the message "database table
is locked".

useful reading:
https://stackoverflow.com/questions/30081581/sqlite-error-database-is-locked-when-using-sqlite3-command-line

bye Sandro

From jukka.rahkonen at maanmittauslaitos.fi  Mon Sep 18 14:10:33 2017
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Mon, 18 Sep 2017 21:10:33 +0000
Subject: [gdal-dev] Case sensitive open option in GMLAS?
Message-ID: <1505769034411.41514@maanmittauslaitos.fi>

Hi,

I get this error with GMLAS driver and "-oo remove_unused_layers=yes"

Warning 6: driver GMLAS does not support open option remove_usused_layers

Warning disappears with -oo REMOVE_UNUSED_LAYERS=yes. 
The very similar open option "-oo remove_unused_fields" does not give an error.

-Jukka Rahkonen-

From even.rouault at spatialys.com  Mon Sep 18 14:42:52 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 18 Sep 2017 23:42:52 +0200
Subject: [gdal-dev] Case sensitive open option in GMLAS?
In-Reply-To: <1505769034411.41514@maanmittauslaitos.fi>
References: <1505769034411.41514@maanmittauslaitos.fi>
Message-ID: <37647278.xmcYZsATiT@even-i700>

On lundi 18 septembre 2017 21:10:33 CEST Rahkonen Jukka (MML) wrote:
> Hi,
> 
> I get this error with GMLAS driver and "-oo remove_unused_layers=yes"
> 
> Warning 6: driver GMLAS does not support open option remove_usused_layers

Jukka,

This is a typo from your side. See the error message which reflects the typo: 
"remove_USUed_layers" (I put in upper case the location of the typo)

"-oo remove_unused_layers=yes" correctly spelled works fine for me.

Bonus point for contributors: add a GDAL-isense functionnality in 
GDALValidateOpenOptions() to suggest the appropriate option name when there's a typo ;-)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170918/a96ebab2/attachment.html>

From roarke.gaskill at weather.com  Tue Sep 19 13:19:26 2017
From: roarke.gaskill at weather.com (Roarke Gaskill)
Date: Tue, 19 Sep 2017 15:19:26 -0500
Subject: [gdal-dev] Overview Pixils don't line up.
Message-ID: <CADyWFeWgV=ngVGnCO_evEkGRxtgViCcJo9v52amGJmaCcMm1Fg@mail.gmail.com>

Hi,

I am seeing an issue where after I create an overview the pixels at the
lower zoom_level are slightly shifted as compared to if I don't create an
overview.

You can reproduce by running the following and comparing overview1.tif with
overview2.tif.  They don't quite line up.  You will find overview1.tif and
overview3.tif do line up.

https://eoimages.gsfc.nasa.gov/images/imagerecords/57000/57752/land_shallow_topo_8192.tif
gdal_translate -a_srs EPSG:4326 -a_ullr -180 -90 180 90
land_shallow_topo_8192.tif marble.tif

gdal_translate -of GPKG marble.tif marble.gpkg -co
TILING_SCHEME=GoogleMapsCompatible
gdal_translate -r nearest -of GTIFF -tr 156543.0339280410 156543.0339280410
 marble.gpkg overview1.tif
gdaladdo -r near  marble.gpkg
gdal_translate -r nearest -of GTIFF -tr 156543.0339280410 156543.0339280410
 marble.gpkg overview2.tif
gdalwarp -r near -of GTIFF -tr 156543.0339280410 156543.0339280410
marble.gpkg overview3.tif


Why would the pixels shift because of the overview creation?


Thanks,
Roarke
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170919/396825a5/attachment.html>

From even.rouault at spatialys.com  Tue Sep 19 14:34:29 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 19 Sep 2017 23:34:29 +0200
Subject: [gdal-dev] Overview Pixils don't line up.
In-Reply-To: <CADyWFeWgV=ngVGnCO_evEkGRxtgViCcJo9v52amGJmaCcMm1Fg@mail.gmail.com>
References: <CADyWFeWgV=ngVGnCO_evEkGRxtgViCcJo9v52amGJmaCcMm1Fg@mail.gmail.com>
Message-ID: <1862893.aGGazOQfoe@even-i700>

On mardi 19 septembre 2017 15:19:26 CEST Roarke Gaskill wrote:
> Hi,
> 
> I am seeing an issue where after I create an overview the pixels at the
> lower zoom_level are slightly shifted as compared to if I don't create an
> overview.
> 
> You can reproduce by running the following and comparing overview1.tif with
> overview2.tif.  They don't quite line up.  You will find overview1.tif and
> overview3.tif do line up.
> 
> https://eoimages.gsfc.nasa.gov/images/imagerecords/57000/57752/land_shallow_
> topo_8192.tif gdal_translate -a_srs EPSG:4326 -a_ullr -180 -90 180 90
> land_shallow_topo_8192.tif marble.tif
> 
> gdal_translate -of GPKG marble.tif marble.gpkg -co
> TILING_SCHEME=GoogleMapsCompatible
> gdal_translate -r nearest -of GTIFF -tr 156543.0339280410 156543.0339280410
>  marble.gpkg overview1.tif
> gdaladdo -r near  marble.gpkg
> gdal_translate -r nearest -of GTIFF -tr 156543.0339280410 156543.0339280410
>  marble.gpkg overview2.tif
> gdalwarp -r near -of GTIFF -tr 156543.0339280410 156543.0339280410
> marble.gpkg overview3.tif
> 
> 
> Why would the pixels shift because of the overview creation?

I could reproduce. The issue specifically comes from nearest resampling. My suspicion is that 
the choice of the source pixel for a target pixel is slightly different in the algorithm that does 
overview building than the one used by gdal_translate (that's not the same code)

If you use -r bilinear (or cubic, lanczos), you won't get this effect since all source pixels 
contributing to the target pixel are taken into account (and actually gdal_translate -r 
something_not_near uses the same code as overview building)

> 
> 
> Thanks,
> Roarke


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170919/fb8c4811/attachment.html>

From even.rouault at spatialys.com  Wed Sep 20 04:01:14 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 20 Sep 2017 13:01:14 +0200
Subject: [gdal-dev] Motion: promote GDAL 2.2.2 RC1 for release
Message-ID: <12373400.spd0dxNe7i@even-i700>

Hi,

Motion: GDAL/OGR 2.2.2 RC1 is promoted to be the official 2.2.2 
release.

----

+1 Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170920/f9214860/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Wed Sep 20 04:18:46 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Wed, 20 Sep 2017 04:18:46 -0700 (MST)
Subject: [gdal-dev] Motion: promote GDAL 2.2.2 RC1 for release
In-Reply-To: <12373400.spd0dxNe7i@even-i700>
References: <12373400.spd0dxNe7i@even-i700>
Message-ID: <1505906326071-0.post@n6.nabble.com>

Even Rouault-2 wrote
> Hi,
> 
> Motion: GDAL/OGR 2.2.2 RC1 is promoted to be the official 2.2.2 
> release.

+1

-Jukka Rahkonen-



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From jmckenna at gatewaygeomatics.com  Wed Sep 20 05:04:39 2017
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Wed, 20 Sep 2017 09:04:39 -0300
Subject: [gdal-dev] Motion: promote GDAL 2.2.2 RC1 for release
In-Reply-To: <12373400.spd0dxNe7i@even-i700>
References: <12373400.spd0dxNe7i@even-i700>
Message-ID: <de4c03bf-7581-54ea-8272-103225360e02@gatewaygeomatics.com>

On 2017-09-20 8:01 AM, Even Rouault wrote:
> Hi,
> 
> Motion: GDAL/OGR 2.2.2 RC1 is promoted to be the official 2.2.2 release.
> 

+1 jeff



-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/

From howard at hobu.co  Wed Sep 20 05:29:44 2017
From: howard at hobu.co (Howard Butler)
Date: Wed, 20 Sep 2017 07:29:44 -0500
Subject: [gdal-dev] Motion: promote GDAL 2.2.2 RC1 for release
In-Reply-To: <de4c03bf-7581-54ea-8272-103225360e02@gatewaygeomatics.com>
References: <12373400.spd0dxNe7i@even-i700>
 <de4c03bf-7581-54ea-8272-103225360e02@gatewaygeomatics.com>
Message-ID: <1D331DCB-2758-492E-8FC9-527415943E3F@hobu.co>


> On Sep 20, 2017, at 7:04 AM, Jeff McKenna <jmckenna at gatewaygeomatics.com> wrote:
> 
> On 2017-09-20 8:01 AM, Even Rouault wrote:
>> Hi,
>> Motion: GDAL/OGR 2.2.2 RC1 is promoted to be the official 2.2.2 release.
> 
> +1 jeff

+1 Howard

From schwehr at gmail.com  Wed Sep 20 06:38:13 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Wed, 20 Sep 2017 06:38:13 -0700
Subject: [gdal-dev] Motion: promote GDAL 2.2.2 RC1 for release
In-Reply-To: <1D331DCB-2758-492E-8FC9-527415943E3F@hobu.co>
References: <12373400.spd0dxNe7i@even-i700>
 <de4c03bf-7581-54ea-8272-103225360e02@gatewaygeomatics.com>
 <1D331DCB-2758-492E-8FC9-527415943E3F@hobu.co>
Message-ID: <CACmBxyu0avAJDNkQVkSEuSK-bhDo6HwrzTQwv-zhOHc-zU_JUg@mail.gmail.com>

+1 Kurt

On Wed, Sep 20, 2017 at 5:29 AM, Howard Butler <howard at hobu.co> wrote:

>
> > On Sep 20, 2017, at 7:04 AM, Jeff McKenna <jmckenna at gatewaygeomatics.com>
> wrote:
> >
> > On 2017-09-20 8:01 AM, Even Rouault wrote:
> >> Hi,
> >> Motion: GDAL/OGR 2.2.2 RC1 is promoted to be the official 2.2.2 release.
> >
> > +1 jeff
>
> +1 Howard
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170920/175136fa/attachment-0001.html>

From dmorissette at mapgears.com  Wed Sep 20 06:55:51 2017
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Wed, 20 Sep 2017 09:55:51 -0400
Subject: [gdal-dev] Motion: promote GDAL 2.2.2 RC1 for release
In-Reply-To: <12373400.spd0dxNe7i@even-i700>
References: <12373400.spd0dxNe7i@even-i700>
Message-ID: <d612b87b-901d-337c-ff75-974b188574bf@mapgears.com>

On 2017-09-20 7:01 AM, Even Rouault wrote:
> Hi,
> 
> Motion: GDAL/OGR 2.2.2 RC1 is promoted to be the official 2.2.2 release.
> 

+1

Daniel
-- 
Daniel Morissette
Mapgears Inc
T: +1 418-696-5056 #201

From johan.vandewauw at gmail.com  Wed Sep 20 13:56:29 2017
From: johan.vandewauw at gmail.com (Johan Van de Wauw)
Date: Wed, 20 Sep 2017 22:56:29 +0200
Subject: [gdal-dev] Binary of the latest released GDAL for travis?
In-Reply-To: <84117854-a9b7-161f-787a-8036691136c4@gmail.com>
References: <687680c4-bd24-2729-942c-81e5ef8b01a4@gmail.com>
 <d0c382f9bd2f96f8ec22d2b5df5a9f31@xs4all.nl>
 <4723b83d-fc99-e19b-1c84-7859f575151c@gmail.com>
 <3edc65ff-439c-2db8-b769-363aaf970801@gmail.com>
 <e767fe77-8f55-323b-9c94-6a87ce7f14c9@gmail.com>
 <747e351433ac6896b9a0bb85c38df781@xs4all.nl>
 <84117854-a9b7-161f-787a-8036691136c4@gmail.com>
Message-ID: <CAJOp35=yYb+3w=C=wpEATTBYU5pvVAyiG8xYqAt215WA9sTe3g@mail.gmail.com>

Hi all,

Sorry for reviving an old discussion, but I was in need of a recent
gdal package today for travis. I have added this to my own ppa:
https://launchpad.net/~johanvdw/+archive/ubuntu/gdal

Angelos, Bas, do you have a list of gdal dependencies and the order in
which they need to be built? I'm thinking about uploading my packages
to ubuntugis/unstable.

Kind Regards,
Johan

On Tue, Apr 11, 2017 at 12:48 PM, Ari Jolma <ari.jolma at gmail.com> wrote:
> 11.04.2017, 13:28, Bas Couwenberg kirjoitti:
>>
>> On 2017-04-11 12:22, Ari Jolma wrote:
>>>
>>> 11.04.2017, 13:05, Angelos Tzotsos kirjoitti:
>>>>
>>>> Hi Ari,
>>>>
>>>> sudo add-apt-repository ppa:ubuntugis/ubuntugis-unstable
>>>> sudo apt-get update
>>>> sudo apt-get install libgdal-dev
>>>>
>>>> This should do it.
>>>
>>>
>>> No. I tried that before (found it in my .travis.yml file...) and it
>>> pulls in older version 1.10.0.
>>
>>
>> You can install the 2.1.3 version explicitly with:
>>
>>  sudo apt-get install libgdal-dev=2.1.3+dfsg-1~xenial2
>
>
> It seems it did not even try this. Probably because it is precise?
>
>>
>> But this will fail when the version is updated in the PPA.
>>
>> Is the travis environment using Ubuntu xenial, and not an older LTS like
>> trusty or precise? It's probably trusty since that ships with GDAL 1.10.1.
>
>
> It is precise. Trusty build environment is in beta.
>
>
>>
>> For those older LTS releases the UbuntuGIS packages haven't been updated
>> yet. Depending on manpower and motivation we may be able to updated the
>> trusty packages in the near future.
>
>
> It would save a lot of build time at least for me.
>
> The reason for me is that many of my project use the GDAL Perl bindings and
> for the tests I pull in the latest from CPAN, which is based on the latest
> released GDAL.
>
>>
>> Ideally the travis environment is upgraded to xenial for which the best
>> support is available and the default packages in Ubuntu itself are much more
>> current.
>
>
> ok
>
> Thanks,
>
> Ari
>
>
>>
>> Kind Regards,
>>
>> Bas
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From sebastic at xs4all.nl  Wed Sep 20 14:04:06 2017
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Wed, 20 Sep 2017 23:04:06 +0200
Subject: [gdal-dev] [Ubuntu] Binary of the latest released GDAL for
 travis?
In-Reply-To: <CAJOp35=yYb+3w=C=wpEATTBYU5pvVAyiG8xYqAt215WA9sTe3g@mail.gmail.com>
References: <687680c4-bd24-2729-942c-81e5ef8b01a4@gmail.com>
 <d0c382f9bd2f96f8ec22d2b5df5a9f31@xs4all.nl>
 <4723b83d-fc99-e19b-1c84-7859f575151c@gmail.com>
 <3edc65ff-439c-2db8-b769-363aaf970801@gmail.com>
 <e767fe77-8f55-323b-9c94-6a87ce7f14c9@gmail.com>
 <747e351433ac6896b9a0bb85c38df781@xs4all.nl>
 <84117854-a9b7-161f-787a-8036691136c4@gmail.com>
 <CAJOp35=yYb+3w=C=wpEATTBYU5pvVAyiG8xYqAt215WA9sTe3g@mail.gmail.com>
Message-ID: <779eedd7-0212-f6a1-60fb-b63d5cff9e0a@xs4all.nl>

On 09/20/2017 10:56 PM, Johan Van de Wauw wrote:
> Angelos, Bas, do you have a list of gdal dependencies and the order in
> which they need to be built? I'm thinking about uploading my packages
> to ubuntugis/unstable.
The the transition tracker:

 http://linuxminded.nl/tmp/pkg-grass-transitions/html/gdal.html

The UbuntuGIS specific transition trackers are broken due to some issue
in ben that was introduced in the stretch version. It always uses the
data for Debian unstable instead of those configured in the config file.

Kind Regards,

Bas

-- 
 GPG Key ID: 4096R/6750F10AE88D4AF1
Fingerprint: 8182 DE41 7056 408D 6146  50D1 6750 F10A E88D 4AF1

From even.rouault at spatialys.com  Fri Sep 22 05:00:27 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 22 Sep 2017 14:00:27 +0200
Subject: [gdal-dev] Motion: promote GDAL 2.2.2 RC1 for release
In-Reply-To: <12373400.spd0dxNe7i@even-i700>
References: <12373400.spd0dxNe7i@even-i700>
Message-ID: <2913413.czYyl25vT3@even-i700>

On mercredi 20 septembre 2017 13:01:14 CEST Even Rouault wrote:
> Hi,
> 
> Motion: GDAL/OGR 2.2.2 RC1 is promoted to be the official 2.2.2
> release.
> 

I declare this motion passed with +1 from PSC members JukkaR, HowardB, 
KurtS, DanielM and myself, as well from community member Jeff McKenna

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170922/b76b1be9/attachment.html>

From even.rouault at spatialys.com  Fri Sep 22 05:10:18 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 22 Sep 2017 14:10:18 +0200
Subject: [gdal-dev] GDAL/OGR 2.2.2 is released
Message-ID: <8033737.YZRx8hfWYx@even-i700>

Hi,

On behalf of the GDAL/OGR development team, I am pleased to announce the release of the 
GDAL/OGR 2.2.2 bug fix version. 

Consult the release notes for the list of issues addressed :
  https://trac.osgeo.org/gdal/wiki/Release/2.2.2-News

The sources are available at:

  http://download.osgeo.org/gdal/2.2.2/gdal-2.2.2.tar.xz
  http://download.osgeo.org/gdal/2.2.2/gdal-2.2.2.tar.gz
  http://download.osgeo.org/gdal/2.2.2/gdal222.zip

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170922/7b8362e6/attachment.html>

From andrew.bell.ia at gmail.com  Fri Sep 22 13:54:00 2017
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Fri, 22 Sep 2017 16:54:00 -0400
Subject: [gdal-dev] OGR_L_SetSpatialFilter
Message-ID: <CACJ51z1eZwjh8YgC4q+sQet6gv8KGm35E_x5dkPz6LsGV3uUkQ@mail.gmail.com>

Hi,

Is there any reason to use OGR_L_SetSpatialFilter if you're fetching a
layer using OGR_DS_Execute_SQL?  Am I missing something or can I place
whatever filter (via a where clause) on the SQL statement that I might
otherwise use in a call to OGR_L_SetSpatialFilter?

Thanks,

-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170922/46f87baa/attachment.html>

From volker27 at gmx.at  Fri Sep 22 14:16:37 2017
From: volker27 at gmx.at (=?UTF-8?Q?Volker_Fr=c3=b6hlich?=)
Date: Fri, 22 Sep 2017 23:16:37 +0200
Subject: [gdal-dev] GDAL/OGR 2.2.2 is released
In-Reply-To: <8033737.YZRx8hfWYx@even-i700>
References: <8033737.YZRx8hfWYx@even-i700>
Message-ID: <6fa1d029-4128-a2ea-8f48-8a11c07bf7e5@gmx.at>

Hello!

The release tarball (at least xz) contains the .git directory! You may 
want to avoid this for the next release!

Greetings,

Volker Fröhlich


Am 2017-09-22 um 14:10 schrieb Even Rouault:
> Hi,
> 
> On behalf of the GDAL/OGR development team, I am pleased to announce the 
> release of the GDAL/OGR 2.2.2 bug fix version.
> 
> Consult the release notes for the list of issues addressed :
> 
> https://trac.osgeo.org/gdal/wiki/Release/2.2.2-News
> 
> The sources are available at:
> 
> http://download.osgeo.org/gdal/2.2.2/gdal-2.2.2.tar.xz
> 
> http://download.osgeo.org/gdal/2.2.2/gdal-2.2.2.tar.gz
> 
> http://download.osgeo.org/gdal/2.2.2/gdal222.zip
> 
> Best regards,
> 
> Even
> 
> -- 
> 
> Spatialys - Geospatial professional services
> 
> http://www.spatialys.com
> 
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 


From volker27 at gmx.at  Fri Sep 22 14:22:44 2017
From: volker27 at gmx.at (=?UTF-8?Q?Volker_Fr=c3=b6hlich?=)
Date: Fri, 22 Sep 2017 23:22:44 +0200
Subject: [gdal-dev] GDAL/OGR 2.2.2 is released
In-Reply-To: <6fa1d029-4128-a2ea-8f48-8a11c07bf7e5@gmx.at>
References: <8033737.YZRx8hfWYx@even-i700>
 <6fa1d029-4128-a2ea-8f48-8a11c07bf7e5@gmx.at>
Message-ID: <487b676f-c342-fb0e-d84f-67e8ad2b210e@gmx.at>

Nevermind what I said, that was 2.2.0!

Volker

Am 2017-09-22 um 23:16 schrieb Volker Fröhlich:
> Hello!
> 
> The release tarball (at least xz) contains the .git directory! You may 
> want to avoid this for the next release!
> 
> Greetings,
> 
> Volker Fröhlich
> 
> 
> Am 2017-09-22 um 14:10 schrieb Even Rouault:
>> Hi,
>>
>> On behalf of the GDAL/OGR development team, I am pleased to announce 
>> the release of the GDAL/OGR 2.2.2 bug fix version.
>>
>> Consult the release notes for the list of issues addressed :
>>
>> https://trac.osgeo.org/gdal/wiki/Release/2.2.2-News
>>
>> The sources are available at:
>>
>> http://download.osgeo.org/gdal/2.2.2/gdal-2.2.2.tar.xz
>>
>> http://download.osgeo.org/gdal/2.2.2/gdal-2.2.2.tar.gz
>>
>> http://download.osgeo.org/gdal/2.2.2/gdal222.zip
>>
>> Best regards,
>>
>> Even
>>
>> -- 
>>
>> Spatialys - Geospatial professional services
>>
>> http://www.spatialys.com
>>
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
> 


From even.rouault at spatialys.com  Fri Sep 22 14:45:10 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 22 Sep 2017 23:45:10 +0200
Subject: [gdal-dev] OGR_L_SetSpatialFilter
In-Reply-To: <CACJ51z1eZwjh8YgC4q+sQet6gv8KGm35E_x5dkPz6LsGV3uUkQ@mail.gmail.com>
References: <CACJ51z1eZwjh8YgC4q+sQet6gv8KGm35E_x5dkPz6LsGV3uUkQ@mail.gmail.com>
Message-ID: <3282654.V5oqGFxtzk@even-i700>

On vendredi 22 septembre 2017 16:54:00 CEST Andrew Bell wrote:
> Hi,
> 
> Is there any reason to use OGR_L_SetSpatialFilter if you're fetching a
> layer using OGR_DS_Execute_SQL?  Am I missing something or can I place
> whatever filter (via a where clause) on the SQL statement that I might
> otherwise use in a call to OGR_L_SetSpatialFilter?
> 

(There would be even as third option, pass the spatial filter object as third argument of 
OGR_DS_Execute_SQL(), which in general should do the same as calling 
OGR_L_SetSpatialFilter() afterwards.)

The reason for those dedicated way of expressing a spatial filter is that not all OGR drivers 
support expressing a spatial filter as a SQL statement. In fact only the drivers that connect to 
engines with spatial capabilites can (PostGIS, Oracle, etc..) and for which OGR passes directly 
the SQL statement, but shapefiles, mapinfo files etc cannot. So you're absolutely free to 
enclose a spatial filter in the SQL itself when the underlying database support it. This will 
even allow you to do spatial filtering for complex queries (with joins, etc) where adding it as a 
post filter would be less efficient.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170922/89d00d2c/attachment.html>

From ap.joseph at live.com  Fri Sep 22 19:36:46 2017
From: ap.joseph at live.com (Andrew Joseph)
Date: Fri, 22 Sep 2017 19:36:46 -0700 (MST)
Subject: [gdal-dev] Achieving Better WKT -> EPSG Code Autodetection When
 Importing Layers to Postgis
Message-ID: <1506134206164-0.post@n6.nabble.com>

I am having issues with OGR being unable to autodetect the correct EPSG code
for arbitrary .prj files. I haven't dealt with any data I'd consider to have
an "exotic" projection -usually just your typical state plane coordinate
systems that are typically used for most publicly available GIS datasets in
the US. 

For example:

PROJCS["NAD_1983_StatePlane_Texas_Central_FIPS_4203_Feet",GEOGCS["GCS_North_American_1983",DATUM["D_North_American_1983",SPHEROID["GRS_1980",6378137.0,298.257222101]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Lambert_Conformal_Conic"],PARAMETER["False_Easting",2296583.333333333],PARAMETER["False_Northing",9842500.0],PARAMETER["Central_Meridian",-100.3333333333333],PARAMETER["Standard_Parallel_1",30.11666666666667],PARAMETER["Standard_Parallel_2",31.88333333333333],PARAMETER["Latitude_Of_Origin",29.66666666666667],UNIT["Foot_US",0.3048006096012192]]


When dealing with Postgis -this is a HUGE problem. If an invalid or
nonexistent EPSG code is provided by OGR, your table is basically unusable
until/unless you either write a script utilizing other software such as
geotools OR lookup your SRIDs manually by copying the .prj file contents
into prj2epsg. While writing an external script is not a massive undertaking
by any means -it would be helpful if external tools/additional processes
could be avoided (in common cases) to get the correct EPSG code for a given
layer. 

The EPSG detection issue also renders it difficult to use tools like the
awesome ogr_fdw (https://github.com/pramsey/pgsql-ogr-fdw), particularly
with IMPORT FOREIGN SCHEMA (see
https://github.com/pramsey/pgsql-ogr-fdw/issues/131) on shapefiles.

Perhaps a JNI bridge could be used,like with the MDB driver, given that the
Geotools projection library (gt-referencing) seems to work with the
projections I have tested -and is also what backs prj2epsg which is what is
typically used as a manual last resort when all else fails. 

I've had this issue for years, but concede I might be missing something. Is
there anything that can remedy this issue utilizing existing functionality?





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From ari.jolma at gmail.com  Fri Sep 22 23:39:32 2017
From: ari.jolma at gmail.com (Ari Jolma)
Date: Sat, 23 Sep 2017 09:39:32 +0300
Subject: [gdal-dev] Fwd: Multi-layered tiff reading in gdal
In-Reply-To: <CADnN3yWp+J8147nUu=+G+f1sM83AW7S6U5HEK2iipC5umEO-aA@mail.gmail.com>
References: <CADnN3yWp+J8147nUu=+G+f1sM83AW7S6U5HEK2iipC5umEO-aA@mail.gmail.com>
Message-ID: <3673d80c-ff85-938b-ca5a-29700e4c2809@gmail.com>

-------- Välitetty viesti / Fwd.Msg --------
Aihe: 	Multi-layered tiff reading in gdal
Päiväys: 	Fri, 22 Sep 2017 09:55:10 -0400
Lähettäjä: 	Isaac Gerg <isaac.gerg-at-gergltd.com>
Vastaanottaja: 	gdal-dev-owner at lists.osgeo.org



Hi,

I have a multi-layered geotiff (as opposed to a multiband geotiff, i 
only have a single band).  When i try to read it in using gdal, it only 
returns a 2d raster.  Is there a way to access the whold data cube (3d)?

Thanks in advance,
Isaac
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170923/ce572930/attachment.html>

From even.rouault at spatialys.com  Sat Sep 23 02:19:55 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 23 Sep 2017 11:19:55 +0200
Subject: [gdal-dev] Achieving Better WKT -> EPSG Code Autodetection When
	Importing Layers to Postgis
In-Reply-To: <1506134206164-0.post@n6.nabble.com>
References: <1506134206164-0.post@n6.nabble.com>
Message-ID: <3533520.CY8p2NVF59@even-i700>

> I've had this issue for years, but concede I might be missing something. Is
> there anything that can remedy this issue utilizing existing functionality?

No need for a complicated thing like a JNI bridge, but someone has to code it in GDAL. All the 
basic functionnality is there. Just needs to be put together. A basic approach would be to 
iterate over the EPSG codes from the gcs.csv and pcs.csv files, use importFromEPSG() and 
compare the resulting WKT with the user WKT. Some fuzzing would be needed to be robust 
to slight naming variations, etc. This was actually an idea for a GSoc project, but anyone is 
free to pick it up and bring his/her contribution.

In the .prj you pointed, prj2epsg first suggestion, EPSG:32139, is actually completely 
inappropriate given it uses meter as linear unit, whereas the .prj uses foot_us. EPSG:2277 
looks to be the exact match. And another interesting thing is that the .prj has 
Standard_Parallel_1 = 30.11666666666667 and Standard_Parallel_2 = 31.88333333333333. 
Whereas EPSG:2277 has them in the reverse order. Which is equivalent mathematically, but a 
matcher should be aware of that equivalence. So not completely a trivial task.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170923/1f4545a0/attachment-0001.html>

From andrea.aime at geo-solutions.it  Sat Sep 23 06:00:34 2017
From: andrea.aime at geo-solutions.it (Andrea Aime)
Date: Sat, 23 Sep 2017 15:00:34 +0200
Subject: [gdal-dev] Achieving Better WKT -> EPSG Code Autodetection When
 Importing Layers to Postgis
In-Reply-To: <3533520.CY8p2NVF59@even-i700>
References: <1506134206164-0.post@n6.nabble.com> <3533520.CY8p2NVF59@even-i700>
Message-ID: <CA+nxMTs2dgX6KETeSTxwvahGtJUsLu3tQrqBSDEFKv1Nd8XGHA@mail.gmail.com>

Hi Even,
just a quick note about GeoTools and http://prj2epsg.org

In terms of matching via GeoTools, we have spent quite some time building
tables of aliases and
some lax equivalence rules, think DMS is same a deegree, some tolerance on
the parameter
values, and so on.

prj2epsg.org uses that (a much older version of it actually) along with
pure and simple full text search matches.

It basically extracts a set of keywords from the WKT and searches against a
similar database
built by indexing all of the EPSG database contents. This is actually what
happens when you put
in that prj file, the result you're pointing to is the 3rd match.
If you input instead something that is actually equivalent, then you'll get
a single result.

Looks like Boundless made the old code for the site publicly available on
github really recently:
https://github.com/boundlessgeo/prj2epsg
Still using a GeoTools 2.6.6, oh dear! :-)

Cheers
Andrea


On Sat, Sep 23, 2017 at 11:19 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> > I've had this issue for years, but concede I might be missing something.
> Is
>
> > there anything that can remedy this issue utilizing existing
> functionality?
>
>
>
> No need for a complicated thing like a JNI bridge, but someone has to code
> it in GDAL. All the basic functionnality is there. Just needs to be put
> together. A basic approach would be to iterate over the EPSG codes from the
> gcs.csv and pcs.csv files, use importFromEPSG() and compare the resulting
> WKT with the user WKT. Some fuzzing would be needed to be robust to slight
> naming variations, etc. This was actually an idea for a GSoc project, but
> anyone is free to pick it up and bring his/her contribution.
>
>
>
> In the .prj you pointed, prj2epsg first suggestion, EPSG:32139, is
> actually completely inappropriate given it uses meter as linear unit,
> whereas the .prj uses foot_us. EPSG:2277 looks to be the exact match. And
> another interesting thing is that the .prj has Standard_Parallel_1 =
> 30.11666666666667 and Standard_Parallel_2 = 31.88333333333333. Whereas
> EPSG:2277 has them in the reverse order. Which is equivalent
> mathematically, but a matcher should be aware of that equivalence. So not
> completely a trivial task.
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 

Regards,

Andrea Aime

==
GeoServer Professional Services from the experts! Visit http://goo.gl/it488V
for more information.
==

Ing. Andrea Aime
@geowolf
Technical Lead

GeoSolutions S.A.S.
Via di Montramito 3/A
55054  Massarosa (LU)
phone: +39 0584 962313
fax: +39 0584 1660272
mob: +39  339 8844549

http://www.geo-solutions.it
http://twitter.com/geosolutions_it

AVVERTENZE AI SENSI DEL D.Lgs. 196/2003

Le informazioni contenute in questo messaggio di posta elettronica e/o
nel/i file/s allegato/i sono da considerarsi strettamente riservate. Il
loro utilizzo è consentito esclusivamente al destinatario del messaggio,
per le finalità indicate nel messaggio stesso. Qualora riceviate questo
messaggio senza esserne il destinatario, Vi preghiamo cortesemente di
darcene notizia via e-mail e di procedere alla distruzione del messaggio
stesso, cancellandolo dal Vostro sistema. Conservare il messaggio stesso,
divulgarlo anche in parte, distribuirlo ad altri soggetti, copiarlo, od
utilizzarlo per finalità diverse, costituisce comportamento contrario ai
principi dettati dal D.Lgs. 196/2003.

The information in this message and/or attachments, is intended solely for
the attention and use of the named addressee(s) and may be confidential or
proprietary in nature or covered by the provisions of privacy act
(Legislative Decree June, 30 2003, no.196 - Italy's New Data Protection
Code).Any use not in accord with its purpose, any disclosure, reproduction,
copying, distribution, or either dissemination, either whole or partial, is
strictly forbidden except previous formal approval of the named
addressee(s). If you are not the intended recipient, please contact
immediately the sender by telephone, fax or e-mail and delete the
information in this message that has been received in error. The sender
does not give any warranty or accept liability as the content, accuracy or
completeness of sent messages and accepts no responsibility  for changes
made after they were sent or for other risks which arise as a result of
e-mail transmission, viruses, etc.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170923/d218b859/attachment.html>

From ap.joseph at live.com  Sat Sep 23 10:41:54 2017
From: ap.joseph at live.com (Andrew Joseph)
Date: Sat, 23 Sep 2017 12:41:54 -0500
Subject: [gdal-dev] Achieving Better WKT -> EPSG Code Autodetection When
 Importing Layers to Postgis
In-Reply-To: <CA+nxMTs2dgX6KETeSTxwvahGtJUsLu3tQrqBSDEFKv1Nd8XGHA@mail.gmail.com>
References: <1506134206164-0.post@n6.nabble.com> <3533520.CY8p2NVF59@even-i700>
 <CA+nxMTs2dgX6KETeSTxwvahGtJUsLu3tQrqBSDEFKv1Nd8XGHA@mail.gmail.com>
Message-ID: <CAHDApB7qeO7kaLiKNOkAFUmPsn1BNsdjMrTRi5pkYKKLdNg6KA@mail.gmail.com>

Even:

> No need for a complicated thing like a JNI bridge, but someone has to
code it in GDAL. All the basic functionnality is there. Just needs to be
put together.

The main reason I suggested geotools is that one only needs to write only a
few trivial lines of code to get the correct EPSG identifier for a given
WKT string -so in theory, most of the work would be the JNI bindings
themselves. I provided a working sample below that would autodetect the
example SRID correctly as 2277. The only downside I have encountered so far
is the slow search speed -but that could be mitigated by caching strings
that have already been mapped. I wonder if there is a repository somewhere
that has a large number of arbitrary WKT strings from "the wild" mapped to
the correct EPSG code -would be useful for getting at least a rough sense
of accuracy for any given wkt -> epsg conversion solution.

Andrea:

> prj2epsg.org uses that (a much older version of it actually) along with
pure and simple full text search matches.

I was actually the person who asked them to put up that repo up on github
because I initially wanted to try their codebase for wkt -> epsg
conversion, thinking that it would be superior (and faster) than raw
geotools -but was astounded when I saw the wrong projection come back for
the WKT string. It might be worth submitting a pull request with updated
dependencies -since prj2epsg is typically referenced in various open source
GIS documentation and on gis.stackexchange as the simplest way to upload a
.prj file and get back the correct EPSG code.

import org.geotools.factory.Hints;
import org.geotools.referencing.CRS;
import org.opengis.referencing.FactoryException;

public class BasicWktParser {

  static {
    System.setProperty("org.geotools.referencing.forceXY", "true");
    Hints.putSystemDefault(Hints.FORCE_AXIS_ORDER_HONORING, "http");
    Hints.putSystemDefault(Hints.COMPARISON_TOLERANCE, 1e-9);
  }

  public static void main(String[] args) throws FactoryException {
    String identifier = CRS.lookupIdentifier(CRS.parseWKT(args[0]), true);
    System.out.println(identifier);
  }

}

 relevant build.gradle declarations:

dependencies {
    compile (group: 'org.geotools', name: 'gt-epsg-hsql', version: '17.2') {
        exclude module: 'jai_core'
    }
    compile (group: 'org.geotools', name: 'gt-epsg-extension', version:
'17.2') {
        exclude module: 'jai_core'
    }
}

repositories {

        mavenCentral()

        maven {
            url "http://repo.boundlessgeo.com/main/"
        }

        maven {
            url "http://download.osgeo.org/webdav/geotools/"
        }
}


On Sat, Sep 23, 2017 at 8:00 AM, Andrea Aime <andrea.aime at geo-solutions.it>
wrote:

> Hi Even,
> just a quick note about GeoTools and http://prj2epsg.org
>
> In terms of matching via GeoTools, we have spent quite some time building
> tables of aliases and
> some lax equivalence rules, think DMS is same a deegree, some tolerance on
> the parameter
> values, and so on.
>
> prj2epsg.org uses that (a much older version of it actually) along with
> pure and simple full text search matches.
>
> It basically extracts a set of keywords from the WKT and searches against
> a similar database
> built by indexing all of the EPSG database contents. This is actually what
> happens when you put
> in that prj file, the result you're pointing to is the 3rd match.
> If you input instead something that is actually equivalent, then you'll
> get a single result.
>
> Looks like Boundless made the old code for the site publicly available on
> github really recently:
> https://github.com/boundlessgeo/prj2epsg
> Still using a GeoTools 2.6.6, oh dear! :-)
>
> Cheers
> Andrea
>
>
> On Sat, Sep 23, 2017 at 11:19 AM, Even Rouault <even.rouault at spatialys.com
> > wrote:
>
>> > I've had this issue for years, but concede I might be missing
>> something. Is
>>
>> > there anything that can remedy this issue utilizing existing
>> functionality?
>>
>>
>>
>> No need for a complicated thing like a JNI bridge, but someone has to
>> code it in GDAL. All the basic functionnality is there. Just needs to be
>> put together. A basic approach would be to iterate over the EPSG codes from
>> the gcs.csv and pcs.csv files, use importFromEPSG() and compare the
>> resulting WKT with the user WKT. Some fuzzing would be needed to be robust
>> to slight naming variations, etc. This was actually an idea for a GSoc
>> project, but anyone is free to pick it up and bring his/her contribution.
>>
>>
>>
>> In the .prj you pointed, prj2epsg first suggestion, EPSG:32139, is
>> actually completely inappropriate given it uses meter as linear unit,
>> whereas the .prj uses foot_us. EPSG:2277 looks to be the exact match. And
>> another interesting thing is that the .prj has Standard_Parallel_1 =
>> 30.11666666666667 and Standard_Parallel_2 = 31.88333333333333. Whereas
>> EPSG:2277 has them in the reverse order. Which is equivalent
>> mathematically, but a matcher should be aware of that equivalence. So not
>> completely a trivial task.
>>
>>
>>
>> Even
>>
>>
>>
>> --
>>
>> Spatialys - Geospatial professional services
>>
>> http://www.spatialys.com
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>
> --
>
> Regards,
>
> Andrea Aime
>
> ==
> GeoServer Professional Services from the experts! Visit
> http://goo.gl/it488V for more information.
> ==
>
> Ing. Andrea Aime
> @geowolf
> Technical Lead
>
> GeoSolutions S.A.S.
> Via di Montramito 3/A
> <https://maps.google.com/?q=Via+di+Montramito+3/A+%0D+55054+%C2%A0Massarosa&entry=gmail&source=g>
> 55054
> <https://maps.google.com/?q=Via+di+Montramito+3/A+%0D+55054+%C2%A0Massarosa&entry=gmail&source=g>
>  Massarosa
> <https://maps.google.com/?q=Via+di+Montramito+3/A+%0D+55054+%C2%A0Massarosa&entry=gmail&source=g>
> (LU)
> phone: +39 0584 962313 <+39%200584%20962313>
> fax: +39 0584 1660272 <+39%200584%20166%200272>
> mob: +39  339 8844549 <+39%20339%20884%204549>
>
> http://www.geo-solutions.it
> http://twitter.com/geosolutions_it
>
> AVVERTENZE AI SENSI DEL D.Lgs. 196/2003
>
> Le informazioni contenute in questo messaggio di posta elettronica e/o
> nel/i file/s allegato/i sono da considerarsi strettamente riservate. Il
> loro utilizzo è consentito esclusivamente al destinatario del messaggio,
> per le finalità indicate nel messaggio stesso. Qualora riceviate questo
> messaggio senza esserne il destinatario, Vi preghiamo cortesemente di
> darcene notizia via e-mail e di procedere alla distruzione del messaggio
> stesso, cancellandolo dal Vostro sistema. Conservare il messaggio stesso,
> divulgarlo anche in parte, distribuirlo ad altri soggetti, copiarlo, od
> utilizzarlo per finalità diverse, costituisce comportamento contrario ai
> principi dettati dal D.Lgs. 196/2003.
>
> The information in this message and/or attachments, is intended solely for
> the attention and use of the named addressee(s) and may be confidential or
> proprietary in nature or covered by the provisions of privacy act
> (Legislative Decree June, 30 2003, no.196 - Italy's New Data Protection
> Code).Any use not in accord with its purpose, any disclosure, reproduction,
> copying, distribution, or either dissemination, either whole or partial, is
> strictly forbidden except previous formal approval of the named
> addressee(s). If you are not the intended recipient, please contact
> immediately the sender by telephone, fax or e-mail and delete the
> information in this message that has been received in error. The sender
> does not give any warranty or accept liability as the content, accuracy or
> completeness of sent messages and accepts no responsibility  for changes
> made after they were sent or for other risks which arise as a result of
> e-mail transmission, viruses, etc.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170923/b2722032/attachment.html>

From even.rouault at spatialys.com  Sat Sep 23 14:21:14 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 23 Sep 2017 23:21:14 +0200
Subject: [gdal-dev] Fwd: Multi-layered tiff reading in gdal
In-Reply-To: <3673d80c-ff85-938b-ca5a-29700e4c2809@gmail.com>
References: <CADnN3yWp+J8147nUu=+G+f1sM83AW7S6U5HEK2iipC5umEO-aA@mail.gmail.com>
 <3673d80c-ff85-938b-ca5a-29700e4c2809@gmail.com>
Message-ID: <22172686.ySYnRyWkgQ@even-i700>

Isaac,

I guess multi-layered here must mean multi-pages / multi-IFD in TIFF language. Those should 
normally be exposed as subdatasets by GDAL. You can access them individually with dataset 
names like "GTIFF_DIR:your.tiff:XXXX" where XXXX is 1, 2, ... . 

Even

On samedi 23 septembre 2017 09:39:32 CEST Ari Jolma wrote:
> -------- Välitetty viesti / Fwd.Msg --------
> Aihe: 	Multi-layered tiff reading in gdal
> Päiväys: 	Fri, 22 Sep 2017 09:55:10 -0400
> Lähettäjä: 	Isaac Gerg <isaac.gerg-at-gergltd.com>
> Vastaanottaja: 	gdal-dev-owner at lists.osgeo.org
> 
> 
> 
> Hi,
> 
> I have a multi-layered geotiff (as opposed to a multiband geotiff, i
> only have a single band).  When i try to read it in using gdal, it only
> returns a 2d raster.  Is there a way to access the whold data cube (3d)?
> 
> Thanks in advance,
> Isaac


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170923/47efea2c/attachment-0001.html>

From even.rouault at spatialys.com  Sun Sep 24 06:55:40 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 24 Sep 2017 15:55:40 +0200
Subject: [gdal-dev] Fwd: Multi-layered tiff reading in gdal
In-Reply-To: <CADnN3yXPnuOU5ZzeP4o122QTLYELEFLzGV7=G+DiB8ub-akfhg@mail.gmail.com>
References: <CADnN3yWp+J8147nUu=+G+f1sM83AW7S6U5HEK2iipC5umEO-aA@mail.gmail.com>
 <22172686.ySYnRyWkgQ@even-i700>
 <CADnN3yXPnuOU5ZzeP4o122QTLYELEFLzGV7=G+DiB8ub-akfhg@mail.gmail.com>
Message-ID: <2012439.CQpmHsrmpk@even-i700>

On dimanche 24 septembre 2017 09:28:52 CEST Isaac Gerg wrote:
> Hi Even, thanks for your reply.  I do not understand your syntax,
> "GTIFF_DIR:your.tiff:XXXX" 

Actually I was wrong, it is "GTIFF_DIR:XXXX:your.tiff"

> I am using GDAL via python.  Is there a way to
> access these layers via that interface.  Attached is a sample file.

Demo:

$ python

>>> from osgeo import gdal
>>> ds = gdal.Open('/tmp/sample.tif')
>>> ds.GetSubDatasets()
[('GTIFF_DIR:1:/tmp/sample.tif', 'Page 1 (80P x 400L x 1B)'), ('GTIFF_DIR:2:/tmp/sample.tif', 
'Page 2 (80P x 400L x 1B)'), ('GTIFF_DIR:3:/tmp/sample.tif', 'Page 3 (80P x 400L x 1B)'), 
('GTIFF_DIR:4:/tmp/sample.tif', 'Page 4 (80P x 400L x 1B)'), ('GTIFF_DIR:5:/tmp/sample.tif', 
'Page 5 (80P x 400L x 1B)'), ('GTIFF_DIR:6:/tmp/sample.tif', 'Page 6 (80P x 400L x 1B)'), 
('GTIFF_DIR:7:/tmp/sample.tif', 'Page 7 (80P x 400L x 1B)'), ('GTIFF_DIR:8:/tmp/sample.tif', 
'Page 8 (80P x 400L x 1B)'), ('GTIFF_DIR:9:/tmp/sample.tif', 'Page 9 (80P x 400L x 1B)'), 
('GTIFF_DIR:10:/tmp/sample.tif', 'Page 10 (80P x 400L x 1B)'), ('GTIFF_DIR:11:/tmp/sample.tif', 
'Page 11 (80P x 400L x 1B)'), ('GTIFF_DIR:12:/tmp/sample.tif', 'Page 12 (80P x 400L x 1B)'), 
('GTIFF_DIR:13:/tmp/sample.tif', 'Page 13 (80P x 400L x 1B)'), ('GTIFF_DIR:14:/tmp/sample.tif', 
'Page 14 (80P x 400L x 1B)'), ('GTIFF_DIR:15:/tmp/sample.tif', 'Page 15 (80P x 400L x 1B)'), 
('GTIFF_DIR:16:/tmp/sample.tif', 'Page 16 (80P x 400L x 1B)'), ('GTIFF_DIR:17:/tmp/sample.tif', 
'Page 17 (80P x 400L x 1B)'), ('GTIFF_DIR:18:/tmp/sample.tif', 'Page 18 (80P x 400L x 1B)'), 
('GTIFF_DIR:19:/tmp/sample.tif', 'Page 19 (80P x 400L x 1B)'), ('GTIFF_DIR:20:/tmp/sample.tif', 
'Page 20 (80P x 400L x 1B)'), ('GTIFF_DIR:21:/tmp/sample.tif', 'Page 21 (80P x 400L x 1B)')]

>>> subds = gdal.Open('GTIFF_DIR:1:/tmp/sample.tif')
>>> gdal.Info(subds, format = 'json')
{u'files': [u'/tmp/sample.tif'], u'cornerCoordinates': {u'upperRight': [-77.6741449, 
41.0051153], u'lowerLeft': [-77.6739868, 41.0049763], u'lowerRight': [-77.6739574, 
41.0050046], u'upperLeft': [-77.6741742, 41.0050871], u'center': [-77.6740658, 41.0050458]}
[...snipped....]

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170924/683630a0/attachment.html>

From strk at kbt.io  Mon Sep 25 01:01:06 2017
From: strk at kbt.io (Sandro Santilli)
Date: Mon, 25 Sep 2017 10:01:06 +0200
Subject: [gdal-dev] git(hub) migration ?
In-Reply-To: <5104617.fMlcYK0Juz@even-i700>
References: <5104617.fMlcYK0Juz@even-i700>
Message-ID: <20170925080106.yu75gghzyvbapigl@liz>

On Wed, Sep 06, 2017 at 03:14:26PM +0200, Even Rouault wrote:

> 1) migrate to git, and remain within the OSGeo infrastructure. This is for example the case of 
> GEOS which uses the Trac git plugin and the GOGS (or is gitea?) git hosting (https://
> git.osgeo.org/gogs/geos/geos.git).

It is still Gogs.
The plan is to switch to Gitea (http://gitea.io) but I hadn't
found the time to do that yet, and nobody seems to be really
interested in that (github bought all mindshares!)

> gogs/gitea tries to replicate most github functionalities, 
> but feature parity is still not there (you cannot comment on a commit e.g).

There's also a GitLab experimental service under OSGeo:
https://git.osgeo.org/gitea
It does provide comment on commits and CI.
Currently maintained by Björn (in Cc).

> the "Merge" button from github couldn't (shouldn't) be used.

This seems to be about the only issue making full switch to GitHub
preferred over a simple mirror. I don't know if you're aware but
there's a command line github client (it's called "hub") which
lets you do things like this:

  git hub merge https://github.com/osgeo/gdal/pull/12

It's surely more typing than clicking a button, but if you already
prefer command line it could make the button need go away...

--strk;

From lr at pcorp.us  Mon Sep 25 01:56:02 2017
From: lr at pcorp.us (Regina Obe)
Date: Mon, 25 Sep 2017 04:56:02 -0400
Subject: [gdal-dev] git(hub) migration
Message-ID: <002701d335dc$1e2f4d10$5a8de730$@pcorp.us>

> 1) migrate to git, and remain within the OSGeo infrastructure. This is for
example the case of 
> GEOS which uses the Trac git plugin and the GOGS (or is gitea?) git
hosting (https://
> git.osgeo.org/gogs/geos/geos.git). gogs/gitea tries to replicate most
github functionalities, 
> but feature parity is still not there (you cannot comment on a commit
e.g). We could still 
> offer github as a mirror, which would ease contributions a bit compared to
the current git-
>svn situation, but the "Merge" button from github couldn't (shouldn't) be
used.

If this option is still on the table, I'd be willing to do the work of
moving GDAL svn and trac to OSGeo gogs/gitea infrastructure.
Note interested in helping with move to github, though I would be willing to
help out with fixing the mirroring on github so that tags are correctly
setup as tags (similar to how they are on PostGIS mirror)
https://github.com/postgis/postgis


Sandro already did a proof of concept with GEOS though he didn't officially
move the tickets off of trac.  I have on my list to experiment moving Gogs
to gitea and iron out any issues.

I was thinking trac/git integration might be another possibility though it
sounds from this page, the performance might not be there yet.

https://trac.edgewall.org/wiki/TracGit#DownloadandInstallation


Thanks,
Regina









From even.rouault at spatialys.com  Mon Sep 25 05:10:46 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 25 Sep 2017 14:10:46 +0200
Subject: [gdal-dev] git(hub) migration ?
In-Reply-To: <20170925080106.yu75gghzyvbapigl@liz>
References: <5104617.fMlcYK0Juz@even-i700>
 <20170925080106.yu75gghzyvbapigl@liz>
Message-ID: <2593210.d8lsCHCZL8@even-i700>

Hi Sandro,

Thanks for your feedback.

> It is still Gogs.
> The plan is to switch to Gitea (http://gitea.io)

There's some irony that gitea.io points to github.com for their own code. Not particularly 
reassuring regarding the maturity of the solution.

> 
> > gogs/gitea tries to replicate most github functionalities,
> > but feature parity is still not there (you cannot comment on a commit
> > e.g).
> 
> There's also a GitLab experimental service under OSGeo:

The correct link is: https://git.osgeo.org/gitlab

> It does provide comment on commits and CI.
> Currently maintained by Björn (in Cc).

How is the situation of gitlab community edition (which I guess is the one installed on that 
server) vs gitlab enterprise ? I heard (maybe last year) that gitlab CE may have "scaling" issues 
with a number of users.

> 
> > the "Merge" button from github couldn't (shouldn't) be used.
> 
> This seems to be about the only issue making full switch to GitHub
> preferred over a simple mirror.

No, that's definitely not the only one reason. As far as I'm concerned, there are several 
aspects :

* social one: GH is (may be my biased perception) currently the place by default to host your 
FOSS project. It might change in future years (as sourceforge or google code have faded 
away). I'd note that a number of people already find by themselves the github GDAL mirror, 
although it is not advertized very prominently.

* technical one: sufficiently rich set of features. One of my past grief that you couldn't attach 
files to tickets has been removed a few months ago (you can attach zip)

* availability/maintainance one. With all respect due to SAC (and SAC members deserve a lot), 
I don't expect volunteers to be available 24h/24 365.24days/year to make sure servers go 
fine. And I don't think OSGeo could afford hiring a team to do that. Or the cost would be such 
that it should be considered if it would not be better spent on other missions. It is hard to 
compete against GH on that (or any other hosted solution which has consumers paying for 
that service)

* user experience feeling: my quick playing with https://git.osgeo.org/gitlab shows that it is 
significantly slower than the GH UI. Probably the effect of not being hosted on a sufficiently 
powerful machine.

* maturity one: migrations always mean some uncertainty, so I'd prefer migrating to 
something "combat proven" to decrease this factor. As far as I can see, only GEOS has 
migrated to https://git.osgeo.org/gogs and
https://git.osgeo.org/gitlab is only used as a mirror for now.

> I don't know if you're aware but
> there's a command line github client (it's called "hub") which
> lets you do things like this:

Interesting. Probably this one https://github.com/github/hub ?

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170925/58a6be20/attachment.html>

From strk at kbt.io  Mon Sep 25 06:55:43 2017
From: strk at kbt.io (Sandro Santilli)
Date: Mon, 25 Sep 2017 15:55:43 +0200
Subject: [gdal-dev] git(hub) migration ?
In-Reply-To: <2593210.d8lsCHCZL8@even-i700>
References: <5104617.fMlcYK0Juz@even-i700>
 <20170925080106.yu75gghzyvbapigl@liz>
 <2593210.d8lsCHCZL8@even-i700>
Message-ID: <20170925135543.p2jycbdgijen4siy@liz>

On Mon, Sep 25, 2017 at 02:10:46PM +0200, Even Rouault wrote:
> Hi Sandro,
> 
> Thanks for your feedback.
> 
> > It is still Gogs.
> > The plan is to switch to Gitea (http://gitea.io)
> 
> There's some irony that gitea.io points to github.com for their own code. Not particularly 
> reassuring regarding the maturity of the solution.

Yeah, it's not a mature solution. The same applies to Gogs, but
Gitea has a larger community, which should help in the long run.

If anyone want to follow the road to self-hosting, here's the
relevant ticket: https://github.com/go-gitea/gitea/issues/1029

> * social one: GH is (may be my biased perception) currently the place by default to host your 
> FOSS project. It might change in future years (as sourceforge or google code have faded 
> away). I'd note that a number of people already find by themselves the github GDAL mirror, 
> although it is not advertized very prominently.

So this part is already covered.

> * technical one: sufficiently rich set of features. One of my past grief that you couldn't attach 
> files to tickets has been removed a few months ago (you can attach zip)

Yes, Gogs/Gitea are not as mature as Trac. That's why GEOS
kept Trac for ticketting.

> It is hard to compete against GH on that (or any other hosted solution
> which has consumers paying for that service)

It is hard, I know. I've no intention to compete, only hope that
OSGeo will still provide infrastructure to those who feel the need
for it.

> As far as I can see, only GEOS has 
> migrated to https://git.osgeo.org/gogs

Librttopo has its official home there too:
https://git.osgeo.org/gogs/rttopo/librttopo

> https://git.osgeo.org/gitlab is only used as a mirror for now.

As far as I know, yes. Nobody seemed to be interested in using it
for real work (I briefly tried to setup gitlab-ci but gave up on
first failure - "open-core" business model wasn't appealing for me)

> > there's a command line github client (it's called "hub") which
> 
> Interesting. Probably this one https://github.com/github/hub ?

Yes.

--strk;

From even.rouault at spatialys.com  Mon Sep 25 10:30:14 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 25 Sep 2017 19:30:14 +0200
Subject: [gdal-dev] Shapefile: automatic retrieval of EPSG code
Message-ID: <2383728.HQR2PD9DBf@even-i700>

Hi,

As part of a AWEOC (*), following a recent email thread about year-long issues when 
importing shapefiles, I've committed a first version of a OSRFindMatches() function that 
iterates through the EPSG database to check for one or several matches between the input 
SRS and the catalog.

The shapefile driver now uses this function, instead of the more simple AutoIdentifyEPSG(), 
which only worked on a tiny subset of SRS. When a single match is found by 
OSRFindMatches() with an excellent match quality (meaning IsSame() returning TRUE), it is 
automatically picked up by the Shapefile driver.

OSRFindMatches() returns both a list of candidate SRS and a confidence value: 0=bad, 
100=perfect . Currently if several candidates pass IsSame(), they will be returned with 90% 
confidence. If a SRS doesn't pass IsSame() but is the single one to have a PROJCS/GEOGCS 
name matching the input SRS name (name matching is done with a few hardcoded 
approximation rules), it is returned with 50% confidence.

OSRFindMatches() execution time is :
- first execution ever: around 500 ms. It will then create files in
~/.gdal/$(GDAL_VERSION_MAJOR).$(GDAL_VERSION_MINOR)/srs_cache to speed-up later 
executions
- first execution in a process, using the above cache: around 100ms
- later executions in the process: around 10 ms per SRS (55s to identify the 5216 entries of 
GEOGCS and PROJCS from the EPSG database that are valid for GDAL)

So I feel this is good enough to be enabled by default in the shapefile driver.

I've tested & tuned the function:
- the 5216 above mentionned SRS exported from OGC WKT to ESRI WKT, and reimported 
from ESRI WKT to OGC WKT. 100% confidence single match is obtained for most SRS. Except 
occurences using Polar_Stereographic where ESRI WKT lose the scale_factor and other using 
Hotine_Oblique_Mercator where the rectified_grid_angle parametr is lost. But those are 
probably issues with morphToESRI() / morphFromESRI()
- the SRS definitions at
http://help.arcgis.com/en/arcgisserver/10.0/apis/rest/pcs.html . Results are less good there. 
Sometimes for good reason: no entry in the EPSG code, different projection or datum 
parameters, etc.

It could certainly be improved. For example by using instead of the back&white IsSame() 
method a (to-be-created) GetSimilarityLevel() method that would compare how different 2 
SRS are. More relaxed SRS name comparisons would also help (as the 'tokens' making SRS 
names are separated with underscore once 'massaged', you could split on that, and then 
compare how many tokens are in common (or have partial match), and sum the number of 
identical characters, etc..).


The gdalsrsinfo utility is also enhanced to use the new OSRFindMatches() function if you use 
the -e switch (for epsg).

For example, with some.prj containing: 
PROJCS["NAD_1983_StatePlane_Texas_Central_FIPS_4203_Feet",GEOGCS["GCS_North_Ame
rican_1983",DATUM["D_North_American_1983",SPHEROID["GRS_1980",
6378137.0,298.257222101]],PRIMEM["Greenwich",0.0],UNIT["Degree",
0.0174532925199433]],PROJECTION["Lambert_Conformal_Conic"],PARAMETER["False_Easti
ng",2296583.333333333],PARAMETER["False_Northing",
9842500.0],PARAMETER["Central_Meridian",-100.3333333333333],PARAMETER["Standard_P
arallel_1",30.11666666666667],PARAMETER["Standard_Parallel_2",
31.88333333333333],PARAMETER["Latitude_Of_Origin",
29.66666666666667],UNIT["Foot_US",0.3048006096012192]]

$ gdalsrsinfo -e ESRI::some.prj

EPSG:2277

PROJ.4 : +proj=lcc +lat_1=31.88333333333333 +lat_2=30.11666666666667 
+lat_0=29.66666666666667 +lon_0=-100.3333333333333 +x_0=699999.9998983998 
+y_0=3000000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=us-ft +no_defs 

OGC WKT :
PROJCS["NAD83 / Texas Central (ftUS)",
    GEOGCS["NAD83",
        DATUM["North_American_Datum_1983",
            SPHEROID["GRS 1980",6378137,298.257222101,
                AUTHORITY["EPSG","7019"]],
            TOWGS84[0,0,0,0,0,0,0],
            AUTHORITY["EPSG","6269"]],
        PRIMEM["Greenwich",0,
            AUTHORITY["EPSG","8901"]],
        UNIT["degree",0.0174532925199433,
            AUTHORITY["EPSG","9122"]],
        AUTHORITY["EPSG","4269"]],
    PROJECTION["Lambert_Conformal_Conic_2SP"],
    PARAMETER["standard_parallel_1",31.88333333333333],
    PARAMETER["standard_parallel_2",30.11666666666667],
    PARAMETER["latitude_of_origin",29.66666666666667],
    PARAMETER["central_meridian",-100.3333333333333],
    PARAMETER["false_easting",2296583.333],
    PARAMETER["false_northing",9842500.000000002],
    UNIT["US survey foot",0.3048006096012192,
        AUTHORITY["EPSG","9003"]],
    AXIS["X",EAST],
    AXIS["Y",NORTH],
    AUTHORITY["EPSG","2277"]]


It can also return several occurences if there isn't a single candidate

For example:
$ gdalsrsinfo  -e 
'PROJCS["undefined",GEOGCS["ETRS89",DATUM["European_Terrestrial_Reference_System_
1989",SPHEROID["GRS 1980",6378137,298.257222101]],PRIMEM["Greenwich",
0],UNIT["degree",
0.0174532925199433]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origi
n",0],PARAMETER["central_meridian",27],PARAMETER["scale_factor",
0.9996],PARAMETER["false_easting",500000],PARAMETER["false_northing",0],UNIT["metre",
1]]'

Confidence in this match: 90 %

EPSG:3047

PROJ.4 : +proj=utm +zone=35 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 

OGC WKT :
PROJCS["ETRS89 / UTM zone 35N (N-E)",
    GEOGCS["ETRS89",
        DATUM["European_Terrestrial_Reference_System_1989",
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170925/25ec8fb2/attachment-0001.html>

From andrea.aime at geo-solutions.it  Mon Sep 25 10:39:57 2017
From: andrea.aime at geo-solutions.it (Andrea Aime)
Date: Mon, 25 Sep 2017 19:39:57 +0200
Subject: [gdal-dev] Shapefile: automatic retrieval of EPSG code
In-Reply-To: <2383728.HQR2PD9DBf@even-i700>
References: <2383728.HQR2PD9DBf@even-i700>
Message-ID: <CA+nxMTs6M08c359jCcP+jiF82-0DLdWissHuNnff=z3nd0z5aw@mail.gmail.com>

On Mon, Sep 25, 2017 at 7:30 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
>
>
> As part of a AWEOC (*)
>

AWE... some I'd say! (that made me laugh :-p )
And congrants for the good progress!

Cheers
Andrea

==

GeoServer Professional Services from the experts! Visit http://goo.gl/it488V
for more information.
==

Ing. Andrea Aime
@geowolf
Technical Lead

GeoSolutions S.A.S.
Via di Montramito 3/A
55054  Massarosa (LU)
phone: +39 0584 962313
fax: +39 0584 1660272
mob: +39  339 8844549

http://www.geo-solutions.it
http://twitter.com/geosolutions_it

AVVERTENZE AI SENSI DEL D.Lgs. 196/2003

Le informazioni contenute in questo messaggio di posta elettronica e/o
nel/i file/s allegato/i sono da considerarsi strettamente riservate. Il
loro utilizzo è consentito esclusivamente al destinatario del messaggio,
per le finalità indicate nel messaggio stesso. Qualora riceviate questo
messaggio senza esserne il destinatario, Vi preghiamo cortesemente di
darcene notizia via e-mail e di procedere alla distruzione del messaggio
stesso, cancellandolo dal Vostro sistema. Conservare il messaggio stesso,
divulgarlo anche in parte, distribuirlo ad altri soggetti, copiarlo, od
utilizzarlo per finalità diverse, costituisce comportamento contrario ai
principi dettati dal D.Lgs. 196/2003.

The information in this message and/or attachments, is intended solely for
the attention and use of the named addressee(s) and may be confidential or
proprietary in nature or covered by the provisions of privacy act
(Legislative Decree June, 30 2003, no.196 - Italy's New Data Protection
Code).Any use not in accord with its purpose, any disclosure, reproduction,
copying, distribution, or either dissemination, either whole or partial, is
strictly forbidden except previous formal approval of the named
addressee(s). If you are not the intended recipient, please contact
immediately the sender by telephone, fax or e-mail and delete the
information in this message that has been received in error. The sender
does not give any warranty or accept liability as the content, accuracy or
completeness of sent messages and accepts no responsibility  for changes
made after they were sent or for other risks which arise as a result of
e-mail transmission, viruses, etc.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170925/a1d46b48/attachment.html>

From even.rouault at spatialys.com  Mon Sep 25 11:45:17 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 25 Sep 2017 20:45:17 +0200
Subject: [gdal-dev] [SAC] Access to GDAL Trac database
In-Reply-To: <6C95C682-E782-42B2-9685-810ADC4EF7E6@astrodoggroup.com>
References: <CABUeae9DZ4BQt22PfbPCwx7nmpMw=ZrQtrUJRfFQhtpgP9s3JA@mail.gmail.com>
 <4AF92788-AD74-4026-9A32-3660F30DAF73@hobu.co>
 <6C95C682-E782-42B2-9685-810ADC4EF7E6@astrodoggroup.com>
Message-ID: <2012576.ULge7Ty7Xy@even-i700>

> I think SAC can be a significant asset for the member projects by mitigating
> the risk in things like GitHub. If we were to develop an automated way to
> clone things like the projects' GH repos, issues, etc. it would allow the
> member projects to take advantage of these services, knowing that they
> cannot end up stuck in a dead end simply because someone else's business
> model didn't pan out.

There are tools you can use to do that
https://github.com/josegonzalez/python-github-backup 

See https://lists.osgeo.org/pipermail/gdal-dev/2017-September/047060.html for more 
details

Mostly you need to setup a cron job invoking the tool to do ingestion of new GH tickets and 
pull requests (backuping up the code itself is probably not even needed given how git works). 
With normal rate of activity, it should run in a few seconds in incremental mode, once you've 
done the initial import.

It would be my intent to set up one on my PC if/once we have migrated to GH, but would 
indeed makes sense to run on a OSGeo server for several projects that have already gone 
through the full GH way (thinking to mapserver, proj.4, openlayers, etc...)

I also found that GitLab has a functionnality to migrate from GitHub
https://docs.gitlab.com/ce/user/project/import/github.html
which could be used as an exit road if/when things turn bad.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170925/9ec214a0/attachment.html>

From cgodkin at gmail.com  Mon Sep 25 12:14:00 2017
From: cgodkin at gmail.com (Carl Godkin)
Date: Mon, 25 Sep 2017 12:14:00 -0700
Subject: [gdal-dev] Shapefile: automatic retrieval of EPSG code
In-Reply-To: <2383728.HQR2PD9DBf@even-i700>
References: <2383728.HQR2PD9DBf@even-i700>
Message-ID: <CAE=8km=guqHoT5dCWY-DrK_WTsXf_mApvESG+fvC2fgfBrr0Fg@mail.gmail.com>

On behalf of everyone who has considered written their own code to do
something like this themselves, THANKS!  I'm looking forward to using this
in our code.

carl

On Mon, Sep 25, 2017 at 10:30 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
>
>
> As part of a AWEOC (*), following a recent email thread about year-long
> issues when importing shapefiles, I've committed a first version of a
> OSRFindMatches() function that iterates through the EPSG database to check
> for one or several matches between the input SRS and the catalog.
>
>
>
> The shapefile driver now uses this function, instead of the more simple
> AutoIdentifyEPSG(), which only worked on a tiny subset of SRS. When a
> single match is found by OSRFindMatches() with an excellent match quality
> (meaning IsSame() returning TRUE), it is automatically picked up by the
> Shapefile driver.
>
>
>
> OSRFindMatches() returns both a list of candidate SRS and a confidence
> value: 0=bad, 100=perfect . Currently if several candidates pass IsSame(),
> they will be returned with 90% confidence. If a SRS doesn't pass IsSame()
> but is the single one to have a PROJCS/GEOGCS name matching the input SRS
> name (name matching is done with a few hardcoded approximation rules), it
> is returned with 50% confidence.
>
>
>
> OSRFindMatches() execution time is :
>
> - first execution ever: around 500 ms. It will then create files in
>
> ~/.gdal/$(GDAL_VERSION_MAJOR).$(GDAL_VERSION_MINOR)/srs_cache to speed-up
> later executions
>
> - first execution in a process, using the above cache: around 100ms
>
> - later executions in the process: around 10 ms per SRS (55s to identify
> the 5216 entries of GEOGCS and PROJCS from the EPSG database that are valid
> for GDAL)
>
>
>
> So I feel this is good enough to be enabled by default in the shapefile
> driver.
>
>
>
> I've tested & tuned the function:
>
> - the 5216 above mentionned SRS exported from OGC WKT to ESRI WKT, and
> reimported from ESRI WKT to OGC WKT. 100% confidence single match is
> obtained for most SRS. Except occurences using Polar_Stereographic where
> ESRI WKT lose the scale_factor and other using Hotine_Oblique_Mercator
> where the rectified_grid_angle parametr is lost. But those are probably
> issues with morphToESRI() / morphFromESRI()
>
> - the SRS definitions at
>
> http://help.arcgis.com/en/arcgisserver/10.0/apis/rest/pcs.html . Results
> are less good there. Sometimes for good reason: no entry in the EPSG code,
> different projection or datum parameters, etc.
>
>
>
> It could certainly be improved. For example by using instead of the
> back&white IsSame() method a (to-be-created) GetSimilarityLevel() method
> that would compare how different 2 SRS are. More relaxed SRS name
> comparisons would also help (as the 'tokens' making SRS names are separated
> with underscore once 'massaged', you could split on that, and then compare
> how many tokens are in common (or have partial match), and sum the number
> of identical characters, etc..).
>
>
>
>
>
> The gdalsrsinfo utility is also enhanced to use the new OSRFindMatches()
> function if you use the -e switch (for epsg).
>
>
>
> For example, with some.prj containing: PROJCS["NAD_1983_StatePlane_
> Texas_Central_FIPS_4203_Feet",GEOGCS["GCS_North_American_
> 1983",DATUM["D_North_American_1983",SPHEROID["GRS_1980",
> 6378137.0,298.257222101]],PRIMEM["Greenwich",0.0],UNIT["
> Degree",0.0174532925199433]],PROJECTION["Lambert_Conformal_
> Conic"],PARAMETER["False_Easting",2296583.333333333],
> PARAMETER["False_Northing",9842500.0],PARAMETER["Central_
> Meridian",-100.3333333333333],PARAMETER["Standard_Parallel_
> 1",30.11666666666667],PARAMETER["Standard_Parallel_2",31.88333333333333],
> PARAMETER["Latitude_Of_Origin",29.66666666666667],UNIT["
> Foot_US",0.3048006096012192]]
>
>
>
> $ gdalsrsinfo -e ESRI::some.prj
>
>
>
> EPSG:2277
>
>
>
> PROJ.4 : +proj=lcc +lat_1=31.88333333333333 +lat_2=30.11666666666667
> +lat_0=29.66666666666667 +lon_0=-100.3333333333333 +x_0=699999.9998983998
> +y_0=3000000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=us-ft +no_defs
>
>
>
> OGC WKT :
>
> PROJCS["NAD83 / Texas Central (ftUS)",
>
> GEOGCS["NAD83",
>
> DATUM["North_American_Datum_1983",
>
> SPHEROID["GRS 1980",6378137,298.257222101,
>
> AUTHORITY["EPSG","7019"]],
>
> TOWGS84[0,0,0,0,0,0,0],
>
> AUTHORITY["EPSG","6269"]],
>
> PRIMEM["Greenwich",0,
>
> AUTHORITY["EPSG","8901"]],
>
> UNIT["degree",0.0174532925199433,
>
> AUTHORITY["EPSG","9122"]],
>
> AUTHORITY["EPSG","4269"]],
>
> PROJECTION["Lambert_Conformal_Conic_2SP"],
>
> PARAMETER["standard_parallel_1",31.88333333333333],
>
> PARAMETER["standard_parallel_2",30.11666666666667],
>
> PARAMETER["latitude_of_origin",29.66666666666667],
>
> PARAMETER["central_meridian",-100.3333333333333],
>
> PARAMETER["false_easting",2296583.333],
>
> PARAMETER["false_northing",9842500.000000002],
>
> UNIT["US survey foot",0.3048006096012192,
>
> AUTHORITY["EPSG","9003"]],
>
> AXIS["X",EAST],
>
> AXIS["Y",NORTH],
>
> AUTHORITY["EPSG","2277"]]
>
>
>
>
>
> It can also return several occurences if there isn't a single candidate
>
>
>
> For example:
>
> $ gdalsrsinfo -e 'PROJCS["undefined",GEOGCS["ETRS89",DATUM["European_
> Terrestrial_Reference_System_1989",SPHEROID["GRS
> 1980",6378137,298.257222101]],PRIMEM["Greenwich",0],UNIT["
> degree",0.0174532925199433]],PROJECTION["Transverse_Mercator"],PARAMETER["
> latitude_of_origin",0],PARAMETER["central_meridian",
> 27],PARAMETER["scale_factor",0.9996],PARAMETER["false_
> easting",500000],PARAMETER["false_northing",0],UNIT["metre",1]]'
>
>
>
> Confidence in this match: 90 %
>
>
>
> EPSG:3047
>
>
>
> PROJ.4 : +proj=utm +zone=35 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m
> +no_defs
>
>
>
> OGC WKT :
>
> PROJCS["ETRS89 / UTM zone 35N (N-E)",
>
> GEOGCS["ETRS89",
>
> DATUM["European_Terrestrial_Reference_System_1989",
>
> SPHEROID["GRS 1980",6378137,298.257222101,
>
> AUTHORITY["EPSG","7019"]],
>
> TOWGS84[0,0,0,0,0,0,0],
>
> AUTHORITY["EPSG","6258"]],
>
> PRIMEM["Greenwich",0,
>
> AUTHORITY["EPSG","8901"]],
>
> UNIT["degree",0.0174532925199433,
>
> AUTHORITY["EPSG","9122"]],
>
> AUTHORITY["EPSG","4258"]],
>
> PROJECTION["Transverse_Mercator"],
>
> PARAMETER["latitude_of_origin",0],
>
> PARAMETER["central_meridian",27],
>
> PARAMETER["scale_factor",0.9996],
>
> PARAMETER["false_easting",500000],
>
> PARAMETER["false_northing",0],
>
> UNIT["metre",1,
>
> AUTHORITY["EPSG","9001"]],
>
> AUTHORITY["EPSG","3047"]]
>
>
>
> Confidence in this match: 90 %
>
>
>
> EPSG:3067
>
>
>
> PROJ.4 : +proj=utm +zone=35 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m
> +no_defs
>
>
>
> OGC WKT :
>
> PROJCS["ETRS89 / TM35FIN(E,N)",
>
> GEOGCS["ETRS89",
>
> DATUM["European_Terrestrial_Reference_System_1989",
>
> SPHEROID["GRS 1980",6378137,298.257222101,
>
> AUTHORITY["EPSG","7019"]],
>
> TOWGS84[0,0,0,0,0,0,0],
>
> AUTHORITY["EPSG","6258"]],
>
> PRIMEM["Greenwich",0,
>
> AUTHORITY["EPSG","8901"]],
>
> UNIT["degree",0.0174532925199433,
>
> AUTHORITY["EPSG","9122"]],
>
> AUTHORITY["EPSG","4258"]],
>
> PROJECTION["Transverse_Mercator"],
>
> PARAMETER["latitude_of_origin",0],
>
> PARAMETER["central_meridian",27],
>
> PARAMETER["scale_factor",0.9996],
>
> PARAMETER["false_easting",500000],
>
> PARAMETER["false_northing",0],
>
> UNIT["metre",1,
>
> AUTHORITY["EPSG","9001"]],
>
> AXIS["Easting",EAST],
>
> AXIS["Northing",NORTH],
>
> AUTHORITY["EPSG","3067"]]
>
>
>
> Confidence in this match: 90 %
>
>
>
> EPSG:5048
>
>
>
> PROJ.4 : +proj=utm +zone=35 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m
> +no_defs
>
>
>
> OGC WKT :
>
> PROJCS["ETRS89 / TM35FIN(N,E)",
>
> GEOGCS["ETRS89",
>
> DATUM["European_Terrestrial_Reference_System_1989",
>
> SPHEROID["GRS 1980",6378137,298.257222101,
>
> AUTHORITY["EPSG","7019"]],
>
> TOWGS84[0,0,0,0,0,0,0],
>
> AUTHORITY["EPSG","6258"]],
>
> PRIMEM["Greenwich",0,
>
> AUTHORITY["EPSG","8901"]],
>
> UNIT["degree",0.0174532925199433,
>
> AUTHORITY["EPSG","9122"]],
>
> AUTHORITY["EPSG","4258"]],
>
> PROJECTION["Transverse_Mercator"],
>
> PARAMETER["latitude_of_origin",0],
>
> PARAMETER["central_meridian",27],
>
> PARAMETER["scale_factor",0.9996],
>
> PARAMETER["false_easting",500000],
>
> PARAMETER["false_northing",0],
>
> UNIT["metre",1,
>
> AUTHORITY["EPSG","9001"]],
>
> AUTHORITY["EPSG","5048"]]
>
>
>
> Confidence in this match: 90 %
>
>
>
> EPSG:25835
>
>
>
> PROJ.4 : +proj=utm +zone=35 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m
> +no_defs
>
>
>
> OGC WKT :
>
> PROJCS["ETRS89 / UTM zone 35N",
>
> GEOGCS["ETRS89",
>
> DATUM["European_Terrestrial_Reference_System_1989",
>
> SPHEROID["GRS 1980",6378137,298.257222101,
>
> AUTHORITY["EPSG","7019"]],
>
> TOWGS84[0,0,0,0,0,0,0],
>
> AUTHORITY["EPSG","6258"]],
>
> PRIMEM["Greenwich",0,
>
> AUTHORITY["EPSG","8901"]],
>
> UNIT["degree",0.0174532925199433,
>
> AUTHORITY["EPSG","9122"]],
>
> AUTHORITY["EPSG","4258"]],
>
> PROJECTION["Transverse_Mercator"],
>
> PARAMETER["latitude_of_origin",0],
>
> PARAMETER["central_meridian",27],
>
> PARAMETER["scale_factor",0.9996],
>
> PARAMETER["false_easting",500000],
>
> PARAMETER["false_northing",0],
>
> UNIT["metre",1,
>
> AUTHORITY["EPSG","9001"]],
>
> AXIS["Easting",EAST],
>
> AXIS["Northing",NORTH],
>
> AUTHORITY["EPSG","25835"]]
>
>
>
> Regards,
>
>
>
> Even
>
>
>
> (*) Autumn Week-End Of Code
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170925/54549ba3/attachment-0001.html>

From afalciano at yahoo.it  Mon Sep 25 12:37:28 2017
From: afalciano at yahoo.it (Antonio Falciano)
Date: Mon, 25 Sep 2017 21:37:28 +0200
Subject: [gdal-dev] Shapefile: automatic retrieval of EPSG code
In-Reply-To: <2383728.HQR2PD9DBf@even-i700>
References: <2383728.HQR2PD9DBf@even-i700>
Message-ID: <f823bfe6-4c70-3312-a597-130b95d9bae4@yahoo.it>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170925/f4a06d73/attachment-0001.html>

From even.rouault at spatialys.com  Mon Sep 25 12:43:21 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 25 Sep 2017 21:43:21 +0200
Subject: [gdal-dev] Shapefile: automatic retrieval of EPSG code
In-Reply-To: <f823bfe6-4c70-3312-a597-130b95d9bae4@yahoo.it>
References: <2383728.HQR2PD9DBf@even-i700>
 <f823bfe6-4c70-3312-a597-130b95d9bae4@yahoo.it>
Message-ID: <2870239.H8658Uny8v@even-i700>

> 
> Thank you very much, Even! I have only one observation about the first
> example: the standard parallels values are switched in the gdalsrsinfo
> results. So, it seems like that they don't match at all, excluding the
> mapped CRS name. Definitively the confidence in this match, according to
> your definition, should be only 50%.

This is indeed an exception. For Lambert_Conformal_Conic_2SP, the order of 
standard parallel is indifferent (and EPSG and ESRI don't use the same order. 
Same with MapInfo as far as I remember). This results in the same 
mathematical projection. So I've added an exception in IsSame() to accept that 
difference.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170925/c86ae122/attachment.html>

From afalciano at yahoo.it  Mon Sep 25 13:01:17 2017
From: afalciano at yahoo.it (Antonio Falciano)
Date: Mon, 25 Sep 2017 22:01:17 +0200
Subject: [gdal-dev] Shapefile: automatic retrieval of EPSG code
In-Reply-To: <2870239.H8658Uny8v@even-i700>
References: <2383728.HQR2PD9DBf@even-i700>
 <f823bfe6-4c70-3312-a597-130b95d9bae4@yahoo.it>
 <2870239.H8658Uny8v@even-i700>
Message-ID: <10bb46eb-1623-72a8-47f5-df2df4825799@yahoo.it>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170925/28fb2706/attachment.html>

From Jacob.Adams at cachecounty.org  Mon Sep 25 15:16:26 2017
From: Jacob.Adams at cachecounty.org (Jacob Adams)
Date: Mon, 25 Sep 2017 16:16:26 -0600
Subject: [gdal-dev] Compression Artifacts After Merging Imagery
Message-ID: <59C92BDA020000AC0001654B@mail.cachecounty.org>

Oh ye great minds of the GDAL world, I've run into a problem that I've not been able to solve.

I have aerial imagery comprised of about 1500 jpegs that I am trying to merge together into three large (~18gb) jpeg-compressed geotiffs to be served by Geoserver. The images are tiled such that they shift down about 100 pixels (out of ~7000) every so often. With a pure gdal_merge or gdalwarp mosaic, this leaves compression artifacts in the nodata spaces along the borders. The cause of these artifacts seems to be explained in Evan's comments on this ticket: https://trac.osgeo.org/gdal/ticket/5102).  

I tried pre-processing a handful of the tilesinto geotiffs with the following three commands based on a similar discussion in February (http://lists.osgeo.org/pipermail/gdal-dev/2017-February/046027.html):
    nearblack -co TILED=YES -of Gtiff -nb 0 -near 0 -setmask -o temp1.tif Tile1.jpeg
    gdalwarp -t_srs EPSG:3560 -dstalpha -co TILED=YES temp1.tif temp2.tif
    gdal_translate -co TILED=YES -co COMPRESS=JPEG -co PHOTOMETRIC=YCBCR -b 1 -b 2 -b 3 -mask 4 --config GDAL_TIFF_INTERNAL_MASK YES temp2.tif Tile1_out.tif 

However, I still get the artifacts when I then try to mosaic the resulting tiffs using either gdalwarp or gdal_merge.py:
    python gdal_merge.py -co TILED=YES -co COMPRESS=JPEG -co PHOTOMETRIC=YCBCR --config GDAL_TIFF_INTERNAL_MASK YES -o merged.tif Tile1_out.tif Tile2_out.tif (etc)

Leaving the compression out of the gdal_translate call (leaving all the compression to the gdal_merge command) does not make a difference in the artifacts.

I've also tried to merge the images and cut the resulting compressed tiffs with cutlines,:
    python gdal_merge.py -ot Byte -of Gtiff -co COMPRESS=JPEG -co PHOTOMETRIC=YCBCR -co TILED=YES -co BIGTIFF=YES -o "f:\imagery\trimmed_merged_jpegs\0.tif" --optfile f:\imagery\0.txt
    gdalwarp.exe -co COMPRESS=JPEG -co PHOTOMETRIC=YCBCR -co TILED=YES -co BIGTIFF=YES -cutline f:\imagery_footprints\threeinch0.shp -crop_to_cutline "f:\imagery\trimmed_merged_jpegs\0.tif" "f:\imagery\trimmed_merged_jpegs\trimmed0.tif"

But this also fails to remove the artifacts.

My understanding of the problem is that the jpeg compression occurs as the last step of any command, and thus even when fed a properly-masked file the final compression still mangles the output.

Is there a way to remove these artifacts in a format amenable to Geoserver while preserving the compression levels achievable with ycbcr-based jpeg compression?

Thanks,

Jacob Adams
GIS Specialist, Cache County
 



From even.rouault at spatialys.com  Mon Sep 25 16:01:30 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 26 Sep 2017 01:01:30 +0200
Subject: [gdal-dev] Compression Artifacts After Merging Imagery
In-Reply-To: <59C92BDA020000AC0001654B@mail.cachecounty.org>
References: <59C92BDA020000AC0001654B@mail.cachecounty.org>
Message-ID: <3214146.MsjjPYqiPg@even-i700>

On lundi 25 septembre 2017 16:16:26 CEST Jacob Adams wrote:
> Oh ye great minds of the GDAL world, I've run into a problem that I've not
> been able to solve.
> 
> I have aerial imagery comprised of about 1500 jpegs that I am trying to
> merge together into three large (~18gb) jpeg-compressed geotiffs to be
> served by Geoserver. The images are tiled such that they shift down about
> 100 pixels (out of ~7000) every so often. With a pure gdal_merge or
> gdalwarp mosaic, this leaves compression artifacts in the nodata spaces
> along the borders. The cause of these artifacts seems to be explained in
> Evan's comments on this ticket: https://trac.osgeo.org/gdal/ticket/5102).
> 
> I tried pre-processing a handful of the tilesinto geotiffs with the
> following three commands based on a similar discussion in February
> (http://lists.osgeo.org/pipermail/gdal-dev/2017-February/046027.html):

> nearblack -co TILED=YES -of Gtiff -nb 0 -near 0 -setmask -o temp1.tif  Tile1.jpeg

I think one issue is in the above nearblack invocation. Did you check temp1.tif is "clean" by 
displaying it ?
Basically by setting -near 0, you say that nearblack should expect a very clean frontier 
between nodata areas and valid areas. Whereas JPEG decompression artifacts in such a 
situation will result in intermediate values in a few pixels beyond the border.
I'd suggest trying with the default of nearblack, -near 15 and -nb 2, and tune them if needed.


>     gdal_translate -co TILED=YES -co COMPRESS=JPEG -co PHOTOMETRIC=YCBCR -b 1 -b 2 -b 
3 -mask 4 --config GDAL_TIFF_INTERNAL_MASK YES temp2.tif Tile1_out.tif 

You shouldn't JPEG compress intermediate products. This will decrease image quality. Only 
apply it to the final stage of your workflow.


Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170926/964a6c66/attachment.html>

From strk at kbt.io  Mon Sep 25 22:37:45 2017
From: strk at kbt.io (Sandro Santilli)
Date: Tue, 26 Sep 2017 07:37:45 +0200
Subject: [gdal-dev] git(hub) migration ?
In-Reply-To: <20170925135543.p2jycbdgijen4siy@liz>
References: <5104617.fMlcYK0Juz@even-i700>
 <20170925080106.yu75gghzyvbapigl@liz>
 <2593210.d8lsCHCZL8@even-i700>
 <20170925135543.p2jycbdgijen4siy@liz>
Message-ID: <20170926053745.GA10749@tuscia.pallamondo.net>

On Mon, Sep 25, 2017 at 03:55:43PM +0200, Sandro Santilli wrote:
> On Mon, Sep 25, 2017 at 02:10:46PM +0200, Even Rouault wrote:

> > As far as I can see, only GEOS has 
> > migrated to https://git.osgeo.org/gogs
> 
> Librttopo has its official home there too:
> https://git.osgeo.org/gogs/rttopo/librttopo

As I stumbled upon an old mail announcing FOSS4G use of Gogs,
I though I'd add more uses of Gogs, beside "migrated" projects:

  - FOSS4G material: https://git.osgeo.org/gogs/foss4g/
  - SAC system configurations: https://git.osgeo.org/gogs/sac/
    (most repos are private so won't be listed for those who do
     not have access)
  - More project-private repos
  - More project side-repos (like postgis website, bots, dockers)

--strk;

From strk at kbt.io  Mon Sep 25 22:42:16 2017
From: strk at kbt.io (Sandro Santilli)
Date: Tue, 26 Sep 2017 07:42:16 +0200
Subject: [gdal-dev] git(hub) migration
In-Reply-To: <002701d335dc$1e2f4d10$5a8de730$@pcorp.us>
References: <002701d335dc$1e2f4d10$5a8de730$@pcorp.us>
Message-ID: <20170926054216.GB10749@tuscia.pallamondo.net>

On Mon, Sep 25, 2017 at 04:56:02AM -0400, Regina Obe wrote:

> Sandro already did a proof of concept with GEOS though he didn't officially
> move the tickets off of trac.

This was the result of last "import" from trac, if you're curious:
https://git.osgeo.org/gogs/strk/geos-migration-test/issues
(I've added more items in the migrator code [1] after that import)

[1] http://strk.kbt.io/projects/go/trac2gogs/

> I was thinking trac/git integration might be another possibility though it
> sounds from this page, the performance might not be there yet.

FYI: Trac can already be integrated with GIT.
You can see it in action with GEOS:

   https://trac.osgeo.org/geos/browser/git

The repo being browsed is the one under Gogs access control.

--strk;

From lr at pcorp.us  Mon Sep 25 23:10:18 2017
From: lr at pcorp.us (Regina Obe)
Date: Tue, 26 Sep 2017 02:10:18 -0400
Subject: [gdal-dev] git(hub) migration
In-Reply-To: <20170926054216.GB10749@tuscia.pallamondo.net>
References: <002701d335dc$1e2f4d10$5a8de730$@pcorp.us>
 <20170926054216.GB10749@tuscia.pallamondo.net>
Message-ID: <000001d3368e$21220550$63660ff0$@pcorp.us>

>> I was thinking trac/git integration might be another possibility 
>> though it sounds from this page, the performance might not be there yet.

> FYI: Trac can already be integrated with GIT.
> You can see it in action with GEOS:

 >   https://trac.osgeo.org/geos/browser/git

> The repo being browsed is the one under Gogs access control.

> --strk;

That's great I'll take a look sometime next week.


From jef at norbit.de  Tue Sep 26 02:53:03 2017
From: jef at norbit.de (=?iso-8859-1?B?SvxyZ2VuIEUu?= Fischer)
Date: Tue, 26 Sep 2017 11:53:03 +0200
Subject: [gdal-dev] git(hub) migration ?
In-Reply-To: <CAFO80_pwTudB0=r-ynen5Qyj6xXdARmLyzACsWX++a0CApvmrQ@mail.gmail.com>
References: <5104617.fMlcYK0Juz@even-i700>
 <CABUeae9M1djnn24Oa3UWc_xeju-L5mOZL3Mmv44ZfGYH=x5LPw@mail.gmail.com>
 <CAFO80_pwTudB0=r-ynen5Qyj6xXdARmLyzACsWX++a0CApvmrQ@mail.gmail.com>
Message-ID: <20170926095303.cptuuv563kknlhac@norbit.de>

Hi Luigi,

On Wed, 06. Sep 2017 at 22:26:41 +0200, Luigi Pirelli wrote:
> FYI in QGIS dev world we still not have found a clear and complete way
> to migrate tracker from redmine to GH or GitLab.

That's implies that we want to switch bugtracking to github.  There never was
consensus about that and we decided to stick with redmine.  We just upgrade and
moved it to a non-osgeo machine to fix the performance issues we experienced on
the osgeo-vm it was running on.

That redmine doesn't integrate as well with gh as it's native issues to me is
more a problem of the non-free nature of gh than anything else.  I guess using
separate counters and prefixes for issues and pull requests wouldn't be too
difficult to do.


Jürgen

-- 
Jürgen E. Fischer         norBIT GmbH               Tel. +49-4931-918175-31
Dipl.-Inf. (FH)           Rheinstraße 13            Fax. +49-4931-918175-50
Software Engineer         D-26506 Norden               http://www.norbit.de
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 827 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170926/7978d0e4/attachment.sig>

From andrew.bell.ia at gmail.com  Tue Sep 26 05:28:04 2017
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Tue, 26 Sep 2017 08:28:04 -0400
Subject: [gdal-dev] Running Tests
Message-ID: <CACJ51z2YMFhnQYmWF7NtHCF1SGdS7q-aHP6fZhswVqXneb=r+Q@mail.gmail.com>

I'm trying to enable autotest so that I can easily verify changes I make to
GDAL.  I'm having difficulty as my familiarity with the python environment
is limited.  I don't think I want to install the swig bindings OVER the
current GDAL interface code that I may have in my system python
installation.  I would think I could build the bindings, have the
associated .so's (or .dylib's) reference the GDAL build tree and install
the python modules/shared objects in a location I can invoke from autotest
by setting PYTHONPATH accordingly.

This seems difficult to accomplish given the setup so it makes me think I'm
doing something wrong.  Is there a standard (and easy) way to get tests
going on a local GDAL build tree that I'm missing?

P.S. - It seems strange to use python as a CI interface to a C/C++
library.  Is there a reason the test harness isn't in C/C++?

-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170926/7f11e02d/attachment.html>

From mateusz at loskot.net  Tue Sep 26 05:42:22 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue, 26 Sep 2017 14:42:22 +0200
Subject: [gdal-dev] Running Tests
In-Reply-To: <CACJ51z2YMFhnQYmWF7NtHCF1SGdS7q-aHP6fZhswVqXneb=r+Q@mail.gmail.com>
References: <CACJ51z2YMFhnQYmWF7NtHCF1SGdS7q-aHP6fZhswVqXneb=r+Q@mail.gmail.com>
Message-ID: <CABUeae8LsL7LxFaM4au5K39nWyCNhh=9X5QN=LMLChb51xtqfg@mail.gmail.com>

On 26 September 2017 at 14:28, Andrew Bell <andrew.bell.ia at gmail.com> wrote:
>
> P.S. - It seems strange to use python as a CI interface to a C/C++ library.
> Is there a reason the test harness isn't in C/C++?

Historical.
Python was obvious choice as simple platform.
Python kills two targets (three) at the same time: Python API and C/C++API

Decade ago I realised limitations of Python-only tests and started
scratching basic C++ tests suite
https://trac.osgeo.org/gdal/changeset/10613/

It's still there and its fairly convenient to use, if you need to
run/test/debug GDAL at C/C++ level.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From even.rouault at spatialys.com  Tue Sep 26 06:33:01 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 26 Sep 2017 15:33:01 +0200
Subject: [gdal-dev] Running Tests
In-Reply-To: <CACJ51z2YMFhnQYmWF7NtHCF1SGdS7q-aHP6fZhswVqXneb=r+Q@mail.gmail.com>
References: <CACJ51z2YMFhnQYmWF7NtHCF1SGdS7q-aHP6fZhswVqXneb=r+Q@mail.gmail.com>
Message-ID: <3798182.CrvBTv3Kel@even-i700>

Hi Andrew,

> I'm trying to enable autotest so that I can easily verify changes I make to
> GDAL.  I'm having difficulty as my familiarity with the python environment
> is limited.  I don't think I want to install the swig bindings OVER the
> current GDAL interface code that I may have in my system python
> installation.  I would think I could build the bindings, have the
> associated .so's (or .dylib's) reference the GDAL build tree and install
> the python modules/shared objects in a location I can invoke from autotest
> by setting PYTHONPATH accordingly.
> 
> This seems difficult to accomplish given the setup so it makes me think I'm
> doing something wrong.  Is there a standard (and easy) way to get tests
> going on a local GDAL build tree that I'm missing?

In each of my GDAL trees, I have in gdal root (where you invoke ./configure) a setenv.sh script 
with the following content

export PATH=$PWD/apps:$PATH
export LD_LIBRARY_PATH=$PWD:$LD_LIBRARY_PATH
export GDAL_DATA=$PWD/data
export PYTHONPATH=$PWD/swig/python/build/lib.linux-x86_64-2.7

which I source. So that way I don't need to run "make install"

This is for a --without-libtool build. For a libtool build, you need to modify to
export PATH=$PWD/apps/.libs:$PATH
export LD_LIBRARY_PATH=$PWD/.libs:$LD_LIBRARY_PATH

> 
> P.S. - It seems strange to use python as a CI interface to a C/C++
> library.  Is there a reason the test harness isn't in C/C++?

Mateusz already answered on that. Writing Python tests is faster/easier than C/C++ ones. 
We/I tend to limit C/C++ written tests to part of the API not available through the Python 
API.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170926/51220ccb/attachment.html>

From jluis at ualg.pt  Tue Sep 26 07:08:09 2017
From: jluis at ualg.pt (Joaquim Luis)
Date: Tue, 26 Sep 2017 15:08:09 +0100
Subject: [gdal-dev] Running Tests
In-Reply-To: <3798182.CrvBTv3Kel@even-i700>
References: <CACJ51z2YMFhnQYmWF7NtHCF1SGdS7q-aHP6fZhswVqXneb=r+Q@mail.gmail.com>
 <3798182.CrvBTv3Kel@even-i700>
Message-ID: <op.y66evvdddbaoe8@macmarilu>


>
>> P.S. - It seems strange to use python as a CI interface to a C/C++
>
>> library.  Is there a reason the test harness isn't in C/C++?
>
>
> Mateusz already answered on that. Writing Python tests is faster/easier  
> than C/C++ ones. We/I tend to limit C/C++ written tests to part of the  
> API not available >through the Python API.
>
>

That's where Julia might help. From Julia we can call any of the C  
functions directly from the gdal lib without needing to compile anything.
There is this Julia wrapper https://github.com/visr/GDAL.jl but I confess  
that never used it and it probably does not provide wrappers to all  
functions. Bur new ones are not difficult to write.

Joaquim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170926/6a2181d5/attachment-0001.html>

From even.rouault at spatialys.com  Tue Sep 26 07:27:59 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 26 Sep 2017 16:27:59 +0200
Subject: [gdal-dev] Running Tests
In-Reply-To: <op.y66evvdddbaoe8@macmarilu>
References: <CACJ51z2YMFhnQYmWF7NtHCF1SGdS7q-aHP6fZhswVqXneb=r+Q@mail.gmail.com>
 <3798182.CrvBTv3Kel@even-i700> <op.y66evvdddbaoe8@macmarilu>
Message-ID: <2843703.c0VHQc5Ecr@even-i700>

On mardi 26 septembre 2017 15:08:09 CEST Joaquim Luis wrote:
> >> P.S. - It seems strange to use python as a CI interface to a C/C++
> >> 
> >> library.  Is there a reason the test harness isn't in C/C++?
> > 
> > Mateusz already answered on that. Writing Python tests is faster/easier
> > than C/C++ ones. We/I tend to limit C/C++ written tests to part of the
> > API not available >through the Python API.
> 
> That's where Julia might help. From Julia we can call any of the C
> functions directly from the gdal lib without needing to compile anything.
> There is this Julia wrapper https://github.com/visr/GDAL.jl but I confess
> that never used it and it probably does not provide wrappers to all
> functions. Bur new ones are not difficult to write.

Actually there's a similar mechanism in Python with the ctypes module:
https://docs.python.org/3/library/ctypes.html

I had used it a bit. For example in
https://trac.osgeo.org/gdal/browser/trunk/autotest/gcore/testnonboundtoswig.py#L166

Downside of this approach is that if you could get the function prototype wrong
and a runtime crash, as there's no checking against the .h files.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170926/34f6a757/attachment.html>

From ari.jolma at gmail.com  Tue Sep 26 08:31:43 2017
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 26 Sep 2017 18:31:43 +0300
Subject: [gdal-dev] Binary of the latest released GDAL for travis?
Message-ID: <05ec7b7d-ce28-6e82-7253-66e073d8b303@gmail.com>

Johan Van de Wauw wrote:


> Sorry for reviving an old discussion, but I was in need of a recent
> gdal package today for travis. I have added this to my own ppa:
> https://launchpad.net/~johanvdw/+archive/ubuntu/gdal 
> <https://launchpad.net/%7Ejohanvdw/+archive/ubuntu/gdal>
>
Thanks,

This cuts down significantly the build time in Travis for my projects.

Ari


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170926/1c167faf/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Tue Sep 26 08:49:37 2017
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Tue, 26 Sep 2017 15:49:37 +0000
Subject: [gdal-dev] ESRI json REST service and first page of data
Message-ID: <a40c309ea67148c282ee2f7d92edfe94@C119S212VM042.msvyvi.vaha.local>

Hi,

Based on https://gis.stackexchange.com/questions/256668/ogr2ogr-get-geojson-from-map-server-misses-features-and-creates-duplicates it is possible that ESRI REST service may return different first features when query is sent without "resultRecordCount" and "resultOffset" than if the query includes resultRecordCount=xxxx&resultOffset=0.  I know that the same happens with Geoserver WFS so I would not be very surprised.

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170926/ad7f0e84/attachment.html>

From even.rouault at spatialys.com  Tue Sep 26 09:28:12 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 26 Sep 2017 18:28:12 +0200
Subject: [gdal-dev] ESRI json REST service and first page of data
In-Reply-To: <a40c309ea67148c282ee2f7d92edfe94@C119S212VM042.msvyvi.vaha.local>
References: <a40c309ea67148c282ee2f7d92edfe94@C119S212VM042.msvyvi.vaha.local>
Message-ID: <1578905.dPSsrzL9sk@even-i700>

On mardi 26 septembre 2017 15:49:37 CEST Rahkonen Jukka (MML) wrote:
> Hi,
> 
> Based on
> https://gis.stackexchange.com/questions/256668/ogr2ogr-get-geojson-from-map
> -server-misses-features-and-creates-duplicates it is possible that ESRI REST
> service may return different first features when query is sent without
> "resultRecordCount" and "resultOffset" than if the query includes
> resultRecordCount=xxxx&resultOffset=0.  I know that the same happens with
> Geoserver WFS so I would not be very surprised.

Jukka,

I managed to get it working with :
ogrinfo -ro -al --debug on "http://geoportal.menlhk.go.id/arcgis/rest/services/KLHK/Deforestasi_2006_2009/MapServer/0/query?where=objectid>0&outfields=*&f=json&resultOffset=0"  -oo FEATURE_SERVER_PAGING=YES

(you can also include a &resultRecordCount=XXX but that's not necessary)

But OGR should probably better behave by default, and probably auto-add the resultOffset=0
in the inital query. You may file a ticket about that

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170926/f16b941d/attachment.html>

From jluis at ualg.pt  Tue Sep 26 10:01:24 2017
From: jluis at ualg.pt (Joaquim Luis)
Date: Tue, 26 Sep 2017 18:01:24 +0100
Subject: [gdal-dev] Running Tests
In-Reply-To: <2843703.c0VHQc5Ecr@even-i700>
References: <CACJ51z2YMFhnQYmWF7NtHCF1SGdS7q-aHP6fZhswVqXneb=r+Q@mail.gmail.com>
 <3798182.CrvBTv3Kel@even-i700> <op.y66evvdddbaoe8@macmarilu>
 <2843703.c0VHQc5Ecr@even-i700>
Message-ID: <op.y66mwmb3dbaoe8@macmarilu>

On Tue, 26 Sep 2017 15:27:59 +0100, Even Rouault  
<even.rouault at spatialys.com> wrote:

>
> On mardi 26 septembre 2017 15:08:09 CEST Joaquim Luis wrote:
>
>> >> P.S. - It seems strange to use python as a CI interface to a C/C++
>
>> >>
>
>> >> library.  Is there a reason the test harness isn't in C/C++?
>
>> >
>
>> > Mateusz already answered on that. Writing Python tests is  
>> faster/easier
>
>> > than C/C++ ones. We/I tend to limit C/C++ written tests to part of the
>
>> > API not available >through the Python API.
>
>>
>
>> That's where Julia might help. From Julia we can call any of the C
>
>> functions directly from the gdal lib without needing to compile  
>> anything.
>
>> There is this Julia wrapper https://github.com/visr/GDAL.jl but I  
>> confess
>
>> that never used it and it probably does not provide wrappers to all
>
>> functions. Bur new ones are not difficult to write.
>
>


>
> Actually there's a similar mechanism in Python with the ctypes module:
>
> https://docs.python.org/3/library/ctypes.html
>
>
> I had used it a bit. For example in
>
> https://trac.osgeo.org/gdal/browser/trunk/autotest/gcore/testnonboundtoswig.py#L166
>
>
> Downside of this approach is that if you could get the function  
> prototype wrong
>
> and a runtime crash, as there's no checking against the .h files.
>
>
> Even


Right, but in Julia a function wrapper may be as simple as
  function getdriverbyname(arg1)

      checknull(ccall((:GDALGetDriverByName,libgdal),Ptr{GDALDriverH},(Cstring,),arg1))


end
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170926/453e2006/attachment-0001.html>

From saarko at alaska.edu  Tue Sep 26 14:08:18 2017
From: saarko at alaska.edu (Scott Arko)
Date: Tue, 26 Sep 2017 13:08:18 -0800
Subject: [gdal-dev] Opening VRT files within zip archive using /vsizip
Message-ID: <CAFCnYQMY6Dxhz+u9EOcL=9X+i4VyfkZMh_6CakUmw7gKW+f7KA@mail.gmail.com>

Hello,


I have found an odd behavior using the /vsizip driver and I'm hoping
someone on this list can explain what is happening.

I have a zip file containing a number of files of various types.  For each
different dataset there is also a vrt file that is generated by the
processing software to access the various binary data files.  If I access
one of the vrt files via the command line tools I get something along the
lines of:

/opt/local/bin/gdalinfo
/vsizip/S1-IFG_RM_M1S2_TN027_20170301T132816-20170217T132724_s2-poeorb-76d1-v1.1.3-asf.zip/S1-IFG_RM_M1S2_TN027_20170301T132816-20170217T132724_s2-poeorb-76d1-v1.1.3-asf/merged/phsig.cor.geo.vrt
ERROR 1: Random access not supported for /vsizip
Driver: VRT/Virtual Raster
Files:
/vsizip/S1-IFG_RM_M1S2_TN027_20170301T132816-20170217T132724_s2-poeorb-76d1-v1.1.3-asf.zip/S1-IFG_RM_M1S2_TN027_20170301T132816-20170217T132724_s2-poeorb-76d1-v1.1.3-asf/merged/phsig.cor.geo.vrt

 /vsizip/S1-IFG_RM_M1S2_TN027_20170301T132816-20170217T132724_s2-poeorb-76d1-v1.1.3-asf.zip/S1-IFG_RM_M1S2_TN027_20170301T132816-20170217T132724_s2-poeorb-76d1-v1.1.3-asf/merged/phsig.cor.geo
Size is 5139, 6060
Coordinate System is:
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563,
            AUTHORITY["EPSG","7030"]],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0,
        AUTHORITY["EPSG","8901"]],
    UNIT["degree",0.0174532925199433,
        AUTHORITY["EPSG","9122"]],
    AUTHORITY["EPSG","4326"]]
Origin = (-112.731111111111105,33.272777777777776)
Pixel Size = (0.000277777777778,-0.000277777777778)
Corner Coordinates:
Upper Left  (-112.7311111,  33.2727778) (112d43'52.00"W, 33d16'22.00"N)
Lower Left  (-112.7311111,  31.5894444) (112d43'52.00"W, 31d35'22.00"N)
Upper Right (-111.3036111,  33.2727778) (111d18'13.00"W, 33d16'22.00"N)
Lower Right (-111.3036111,  31.5894444) (111d18'13.00"W, 31d35'22.00"N)
Center      (-112.0173611,  32.4311111) (112d 1' 2.50"W, 32d25'52.00"N)
Band 1 Block=5139x1 Type=Float32, ColorInterp=Undefined


This seems perfectly normal and if I use gdal_translate to convert the file
to geotiff it looks fine.  Note that I do get the Error 1 message, but this
does not seem to impact access.  The problem enters when I try to access
the file via the gdal python module.

>>> from osgeo import gdal
>>> han =
gdal.Open('/vsizip/S1-IFG_RM_M1S2_TN027_20170301T132816-20170217T132724_s2-poeorb-76d1-v1.1.3-asf.zip/S1-IFG_RM_M1S2_TN027_20170301T132816-20170217T132724_s2-poeorb-76d1-v1.1.3-asf/merged/phsig.cor.geo.vrt',gdal.GA_ReadOnly)
ERROR 1: Random access not supported for /vsizip

Notice the filename is exactly the same as I used with gdalinfo.  I also
get the same Error 1 message.  However, this does not actually open the
file.  I have tried using the GA_ReadOnly flag and not using it with the
same result.

>>> print han
None
>>> print han.GetGeoTransform()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: 'NoneType' object has no attribute 'GetGeoTransform'

The VRT file looks like this:

VRTDataset rasterXSize="5139" rasterYSize="6060">
    <SRS>EPSG:4326</SRS>
    <GeoTransform>-112.7311111111111, 0.0002777777777777778, 0.0,
33.272777777777776, 0.0, -0.0002777777777777778</GeoTransform>
    <VRTRasterBand band="1" dataType="Float32" subClass="VRTRawRasterBand">
        <SourceFilename relativeToVRT="1">phsig.cor.geo</SourceFilename>
        <ByteOrder>LSB</ByteOrder>
        <ImageOffset>0</ImageOffset>
        <PixelOffset>4</PixelOffset>
        <LineOffset>20556</LineOffset>
    </VRTRasterBand>
</VRTDataset>


I initially thought the problem might be the relativeToVRT=1 flag, since I
found an ealier thread in this email list that seems to say that relative
paths are not allowed in the /vsizip driver.  However, if that were the
case I would have expected the gdalinfo call to fail as well, but it does
not.

Apologies if this is not the right list for this type of question.  I have
been fighting with variants of this problem for a while now and am a bit
frustrated.  We want to provide these data files to our users and allow
them to access the various layers in place, without unzipping the files.
However, I just can't seem to get this to work.  I would appreciate any
comments or thoughts.

Thank you,
Scott




-- 
Scott Arko
Alaska Satellite Facility Deputy Director
University of Alaska Fairbanks

903 Koyukuk Drive
Fairbanks, AK 99775
Phone: (907) 474 - 5570
email:  saarko at alaska.edu
http://www.asf.alaska.edu
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170926/7947c49c/attachment.html>

From even.rouault at spatialys.com  Tue Sep 26 14:21:09 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 26 Sep 2017 23:21:09 +0200
Subject: [gdal-dev] Opening VRT files within zip archive using /vsizip
In-Reply-To: <CAFCnYQMY6Dxhz+u9EOcL=9X+i4VyfkZMh_6CakUmw7gKW+f7KA@mail.gmail.com>
References: <CAFCnYQMY6Dxhz+u9EOcL=9X+i4VyfkZMh_6CakUmw7gKW+f7KA@mail.gmail.com>
Message-ID: <3895312.ROLBxaGJJI@even-i700>

On mardi 26 septembre 2017 13:08:18 CEST Scott Arko wrote:
> Hello,
> 
> 
> I have found an odd behavior using the /vsizip driver and I'm hoping
> someone on this list can explain what is happening.

Scott,

this is a GDAL bug. I've just fixed it per
https://trac.osgeo.org/gdal/ticket/7056

The Python bindings are more sensitive to errors than the C/C++ code, so when an error is 
emitted and not cleared, they will refuse to open the dataset.

No workaround I can think of, apart applying the fix in the ticket, or unzipping the file.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170926/22858990/attachment.html>

From saarko at alaska.edu  Tue Sep 26 14:25:50 2017
From: saarko at alaska.edu (Scott Arko)
Date: Tue, 26 Sep 2017 13:25:50 -0800
Subject: [gdal-dev] Opening VRT files within zip archive using /vsizip
In-Reply-To: <3895312.ROLBxaGJJI@even-i700>
References: <CAFCnYQMY6Dxhz+u9EOcL=9X+i4VyfkZMh_6CakUmw7gKW+f7KA@mail.gmail.com>
 <3895312.ROLBxaGJJI@even-i700>
Message-ID: <CAFCnYQNVpahsdxKgsNdaKqT35zFi2Bio509OUzkwxiXpsWyfHw@mail.gmail.com>

Thank you so much Even.  That is an amazing fast turnaround.



On Tue, Sep 26, 2017 at 1:21 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> On mardi 26 septembre 2017 13:08:18 CEST Scott Arko wrote:
>
> > Hello,
>
> >
>
> >
>
> > I have found an odd behavior using the /vsizip driver and I'm hoping
>
> > someone on this list can explain what is happening.
>
>
>
> Scott,
>
>
>
> this is a GDAL bug. I've just fixed it per
>
> https://trac.osgeo.org/gdal/ticket/7056
>
>
>
> The Python bindings are more sensitive to errors than the C/C++ code, so
> when an error is emitted and not cleared, they will refuse to open the
> dataset.
>
>
>
> No workaround I can think of, apart applying the fix in the ticket, or
> unzipping the file.
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>



-- 
Scott Arko
Alaska Satellite Facility Deputy Director
University of Alaska Fairbanks

903 Koyukuk Drive
Fairbanks, AK 99775
Phone: (907) 474 - 5570
email:  saarko at alaska.edu
http://www.asf.alaska.edu
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170926/27dfb8f3/attachment.html>

From ap.joseph at live.com  Tue Sep 26 16:34:21 2017
From: ap.joseph at live.com (Andrew Joseph)
Date: Tue, 26 Sep 2017 18:34:21 -0500
Subject: [gdal-dev] Shapefile: automatic retrieval of EPSG code
In-Reply-To: <2383728.HQR2PD9DBf@even-i700>
References: <2383728.HQR2PD9DBf@even-i700>
Message-ID: <CAHDApB6si=V4re+TBKZ0Jix-XueD_nXAxVOirCXnnDt8FjBJ_g@mail.gmail.com>

This is incredibly useful! Hopefully I will get around to recompiling my
docker image to test this out soon!

On Mon, Sep 25, 2017 at 12:30 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
>
>
> As part of a AWEOC (*), following a recent email thread about year-long
> issues when importing shapefiles, I've committed a first version of a
> OSRFindMatches() function that iterates through the EPSG database to check
> for one or several matches between the input SRS and the catalog.
>
>
>
> The shapefile driver now uses this function, instead of the more simple
> AutoIdentifyEPSG(), which only worked on a tiny subset of SRS. When a
> single match is found by OSRFindMatches() with an excellent match quality
> (meaning IsSame() returning TRUE), it is automatically picked up by the
> Shapefile driver.
>
>
>
> OSRFindMatches() returns both a list of candidate SRS and a confidence
> value: 0=bad, 100=perfect . Currently if several candidates pass IsSame(),
> they will be returned with 90% confidence. If a SRS doesn't pass IsSame()
> but is the single one to have a PROJCS/GEOGCS name matching the input SRS
> name (name matching is done with a few hardcoded approximation rules), it
> is returned with 50% confidence.
>
>
>
> OSRFindMatches() execution time is :
>
> - first execution ever: around 500 ms. It will then create files in
>
> ~/.gdal/$(GDAL_VERSION_MAJOR).$(GDAL_VERSION_MINOR)/srs_cache to speed-up
> later executions
>
> - first execution in a process, using the above cache: around 100ms
>
> - later executions in the process: around 10 ms per SRS (55s to identify
> the 5216 entries of GEOGCS and PROJCS from the EPSG database that are valid
> for GDAL)
>
>
>
> So I feel this is good enough to be enabled by default in the shapefile
> driver.
>
>
>
> I've tested & tuned the function:
>
> - the 5216 above mentionned SRS exported from OGC WKT to ESRI WKT, and
> reimported from ESRI WKT to OGC WKT. 100% confidence single match is
> obtained for most SRS. Except occurences using Polar_Stereographic where
> ESRI WKT lose the scale_factor and other using Hotine_Oblique_Mercator
> where the rectified_grid_angle parametr is lost. But those are probably
> issues with morphToESRI() / morphFromESRI()
>
> - the SRS definitions at
>
> http://help.arcgis.com/en/arcgisserver/10.0/apis/rest/pcs.html . Results
> are less good there. Sometimes for good reason: no entry in the EPSG code,
> different projection or datum parameters, etc.
>
>
>
> It could certainly be improved. For example by using instead of the
> back&white IsSame() method a (to-be-created) GetSimilarityLevel() method
> that would compare how different 2 SRS are. More relaxed SRS name
> comparisons would also help (as the 'tokens' making SRS names are separated
> with underscore once 'massaged', you could split on that, and then compare
> how many tokens are in common (or have partial match), and sum the number
> of identical characters, etc..).
>
>
>
>
>
> The gdalsrsinfo utility is also enhanced to use the new OSRFindMatches()
> function if you use the -e switch (for epsg).
>
>
>
> For example, with some.prj containing: PROJCS["NAD_1983_StatePlane_Te
> xas_Central_FIPS_4203_Feet",GEOGCS["GCS_North_American_1983"
> ,DATUM["D_North_American_1983",SPHEROID["GRS_1980",6378137.
> 0,298.257222101]],PRIMEM["Greenwich",0.0],UNIT["Degree",
> 0.0174532925199433]],PROJECTION["Lambert_Conformal_Conic"],
> PARAMETER["False_Easting",2296583.333333333],PARAMETER["
> False_Northing",9842500.0],PARAMETER["Central_Meridian",-
> 100.3333333333333],PARAMETER["Standard_Parallel_1",30.
> 11666666666667],PARAMETER["Standard_Parallel_2",31.
> 88333333333333],PARAMETER["Latitude_Of_Origin",29.
> 66666666666667],UNIT["Foot_US",0.3048006096012192]]
>
>
>
> $ gdalsrsinfo -e ESRI::some.prj
>
>
>
> EPSG:2277
>
>
>
> PROJ.4 : +proj=lcc +lat_1=31.88333333333333 +lat_2=30.11666666666667
> +lat_0=29.66666666666667 +lon_0=-100.3333333333333 +x_0=699999.9998983998
> +y_0=3000000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=us-ft +no_defs
>
>
>
> OGC WKT :
>
> PROJCS["NAD83 / Texas Central (ftUS)",
>
> GEOGCS["NAD83",
>
> DATUM["North_American_Datum_1983",
>
> SPHEROID["GRS 1980",6378137,298.257222101,
>
> AUTHORITY["EPSG","7019"]],
>
> TOWGS84[0,0,0,0,0,0,0],
>
> AUTHORITY["EPSG","6269"]],
>
> PRIMEM["Greenwich",0,
>
> AUTHORITY["EPSG","8901"]],
>
> UNIT["degree",0.0174532925199433,
>
> AUTHORITY["EPSG","9122"]],
>
> AUTHORITY["EPSG","4269"]],
>
> PROJECTION["Lambert_Conformal_Conic_2SP"],
>
> PARAMETER["standard_parallel_1",31.88333333333333],
>
> PARAMETER["standard_parallel_2",30.11666666666667],
>
> PARAMETER["latitude_of_origin",29.66666666666667],
>
> PARAMETER["central_meridian",-100.3333333333333],
>
> PARAMETER["false_easting",2296583.333],
>
> PARAMETER["false_northing",9842500.000000002],
>
> UNIT["US survey foot",0.3048006096012192,
>
> AUTHORITY["EPSG","9003"]],
>
> AXIS["X",EAST],
>
> AXIS["Y",NORTH],
>
> AUTHORITY["EPSG","2277"]]
>
>
>
>
>
> It can also return several occurences if there isn't a single candidate
>
>
>
> For example:
>
> $ gdalsrsinfo -e 'PROJCS["undefined",GEOGCS["ET
> RS89",DATUM["European_Terrestrial_Reference_System_1989",SPHEROID["GRS
> 1980",6378137,298.257222101]],PRIMEM["Greenwich",0],UNIT["de
> gree",0.0174532925199433]],PROJECTION["Transverse_Mercator"]
> ,PARAMETER["latitude_of_origin",0],PARAMETER["central_
> meridian",27],PARAMETER["scale_factor",0.9996],PARAMETER["false_easting",
> 500000],PARAMETER["false_northing",0],UNIT["metre",1]]'
>
>
>
> Confidence in this match: 90 %
>
>
>
> EPSG:3047
>
>
>
> PROJ.4 : +proj=utm +zone=35 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m
> +no_defs
>
>
>
> OGC WKT :
>
> PROJCS["ETRS89 / UTM zone 35N (N-E)",
>
> GEOGCS["ETRS89",
>
> DATUM["European_Terrestrial_Reference_System_1989",
>
> SPHEROID["GRS 1980",6378137,298.257222101,
>
> AUTHORITY["EPSG","7019"]],
>
> TOWGS84[0,0,0,0,0,0,0],
>
> AUTHORITY["EPSG","6258"]],
>
> PRIMEM["Greenwich",0,
>
> AUTHORITY["EPSG","8901"]],
>
> UNIT["degree",0.0174532925199433,
>
> AUTHORITY["EPSG","9122"]],
>
> AUTHORITY["EPSG","4258"]],
>
> PROJECTION["Transverse_Mercator"],
>
> PARAMETER["latitude_of_origin",0],
>
> PARAMETER["central_meridian",27],
>
> PARAMETER["scale_factor",0.9996],
>
> PARAMETER["false_easting",500000],
>
> PARAMETER["false_northing",0],
>
> UNIT["metre",1,
>
> AUTHORITY["EPSG","9001"]],
>
> AUTHORITY["EPSG","3047"]]
>
>
>
> Confidence in this match: 90 %
>
>
>
> EPSG:3067
>
>
>
> PROJ.4 : +proj=utm +zone=35 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m
> +no_defs
>
>
>
> OGC WKT :
>
> PROJCS["ETRS89 / TM35FIN(E,N)",
>
> GEOGCS["ETRS89",
>
> DATUM["European_Terrestrial_Reference_System_1989",
>
> SPHEROID["GRS 1980",6378137,298.257222101,
>
> AUTHORITY["EPSG","7019"]],
>
> TOWGS84[0,0,0,0,0,0,0],
>
> AUTHORITY["EPSG","6258"]],
>
> PRIMEM["Greenwich",0,
>
> AUTHORITY["EPSG","8901"]],
>
> UNIT["degree",0.0174532925199433,
>
> AUTHORITY["EPSG","9122"]],
>
> AUTHORITY["EPSG","4258"]],
>
> PROJECTION["Transverse_Mercator"],
>
> PARAMETER["latitude_of_origin",0],
>
> PARAMETER["central_meridian",27],
>
> PARAMETER["scale_factor",0.9996],
>
> PARAMETER["false_easting",500000],
>
> PARAMETER["false_northing",0],
>
> UNIT["metre",1,
>
> AUTHORITY["EPSG","9001"]],
>
> AXIS["Easting",EAST],
>
> AXIS["Northing",NORTH],
>
> AUTHORITY["EPSG","3067"]]
>
>
>
> Confidence in this match: 90 %
>
>
>
> EPSG:5048
>
>
>
> PROJ.4 : +proj=utm +zone=35 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m
> +no_defs
>
>
>
> OGC WKT :
>
> PROJCS["ETRS89 / TM35FIN(N,E)",
>
> GEOGCS["ETRS89",
>
> DATUM["European_Terrestrial_Reference_System_1989",
>
> SPHEROID["GRS 1980",6378137,298.257222101,
>
> AUTHORITY["EPSG","7019"]],
>
> TOWGS84[0,0,0,0,0,0,0],
>
> AUTHORITY["EPSG","6258"]],
>
> PRIMEM["Greenwich",0,
>
> AUTHORITY["EPSG","8901"]],
>
> UNIT["degree",0.0174532925199433,
>
> AUTHORITY["EPSG","9122"]],
>
> AUTHORITY["EPSG","4258"]],
>
> PROJECTION["Transverse_Mercator"],
>
> PARAMETER["latitude_of_origin",0],
>
> PARAMETER["central_meridian",27],
>
> PARAMETER["scale_factor",0.9996],
>
> PARAMETER["false_easting",500000],
>
> PARAMETER["false_northing",0],
>
> UNIT["metre",1,
>
> AUTHORITY["EPSG","9001"]],
>
> AUTHORITY["EPSG","5048"]]
>
>
>
> Confidence in this match: 90 %
>
>
>
> EPSG:25835
>
>
>
> PROJ.4 : +proj=utm +zone=35 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m
> +no_defs
>
>
>
> OGC WKT :
>
> PROJCS["ETRS89 / UTM zone 35N",
>
> GEOGCS["ETRS89",
>
> DATUM["European_Terrestrial_Reference_System_1989",
>
> SPHEROID["GRS 1980",6378137,298.257222101,
>
> AUTHORITY["EPSG","7019"]],
>
> TOWGS84[0,0,0,0,0,0,0],
>
> AUTHORITY["EPSG","6258"]],
>
> PRIMEM["Greenwich",0,
>
> AUTHORITY["EPSG","8901"]],
>
> UNIT["degree",0.0174532925199433,
>
> AUTHORITY["EPSG","9122"]],
>
> AUTHORITY["EPSG","4258"]],
>
> PROJECTION["Transverse_Mercator"],
>
> PARAMETER["latitude_of_origin",0],
>
> PARAMETER["central_meridian",27],
>
> PARAMETER["scale_factor",0.9996],
>
> PARAMETER["false_easting",500000],
>
> PARAMETER["false_northing",0],
>
> UNIT["metre",1,
>
> AUTHORITY["EPSG","9001"]],
>
> AXIS["Easting",EAST],
>
> AXIS["Northing",NORTH],
>
> AUTHORITY["EPSG","25835"]]
>
>
>
> Regards,
>
>
>
> Even
>
>
>
> (*) Autumn Week-End Of Code
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170926/c345c2d7/attachment-0001.html>

From ap.joseph at live.com  Tue Sep 26 17:16:28 2017
From: ap.joseph at live.com (Andrew Joseph)
Date: Tue, 26 Sep 2017 17:16:28 -0700 (MST)
Subject: [gdal-dev] Determining Native Data Field Type Names for a Given
 Layer or Driver
Message-ID: <1506471388803-0.post@n6.nabble.com>

I'm using the GDAL Java Bindings (most recent dev version 2.3.0) and looking
to determine the native datatype of a given layer field -or at least the
default mapping of the driver. For example I have manually written code like
the following for Postgres/Postgis:

  private static final BiMap<String,Integer> PG_OGR_GOMETRY_TYPE_MAP =
      new ImmutableBiMap.Builder<String, Integer>()
        .put("Point",wkbPoint)
        .put("LineString",wkbLineString)
        .put("Polygon",wkbPolygon)
        .put("Surface",wkbSurface)
        .put("Curve",wkbCurve)
        .put("MultiPoint",wkbMultiPoint)
        .put("MultiLineString",wkbMultiLineString)
        .put("MultiPolygon",wkbMultiPolygon)
        .put("GeometryCollection",wkbGeometryCollection)
        .put("CircularString",wkbCircularString)
        .put("CompoundCurve",wkbCompoundCurve)
        .put("CurvePolygon",wkbCurvePolygon)
        .put("MultiCurve",wkbMultiCurve)
        .put("MultiSurface",wkbMultiSurface)
        .put("PolyhedralSurface",wkbPolyhedralSurface)
        .build();

  private static final BiMap<String,Integer> POSTGIS_OGR_DATATYPE_MAP =
      new ImmutableBiMap.Builder<String, Integer>()
          .put("integer",OFTInteger)
          .put("real",OFTReal)
          .put("varchar",OFTString)
          .put("bytea",OFTBinary)
          .put("date",OFTDate)
          .put("time",OFTTime)
          .put("timestamp",OFTDateTime)
          .put("bigint",OFTInteger64)
          .put("integer[]",OFTIntegerList)
          .put("real[]",OFTRealList)
          .put("varchar[]",OFTStringList)
          .put("bigint[]",OFTInteger64List)
          .put("text",OFTWideString)
          .put("text[]",OFTWideStringList)
          .build();

However, it would obviously be orders of magnitude more
convenient/future-proofed to simply retrieve these mappings from the
driver/layer itself since each driver/layer must logically already have such
a mapping. In addition, is it possible to get the native datatypes that
would be generated when copying, say a shapefile to postgres without
actually copying the data itself?

I've tried layer.GetMetadata_Dict() and driver.GetMetadata_Dict() but have
come up bereft of the datatype mappings.






--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From jukka.rahkonen at maanmittauslaitos.fi  Tue Sep 26 22:59:07 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Tue, 26 Sep 2017 22:59:07 -0700 (MST)
Subject: [gdal-dev] Running Tests
In-Reply-To: <3798182.CrvBTv3Kel@even-i700>
References: <CACJ51z2YMFhnQYmWF7NtHCF1SGdS7q-aHP6fZhswVqXneb=r+Q@mail.gmail.com>
 <3798182.CrvBTv3Kel@even-i700>
Message-ID: <1506491947536-0.post@n6.nabble.com>

Even Rouault-2 wrote
> Mateusz already answered on that. Writing Python tests is faster/easier
> than C/C++ ones. 
> We/I tend to limit C/C++ written tests to part of the API not available
> through the Python 
> API.

Another point of view: Based on the number of questions that I have seen on
the mailing lists there seems to be much more people who use GDAL through
Python than through C/C++ for their own processes. Rather often their
problem has been solved by pointing out some related Python test from the
autotest directory.

-Jukka Rahkonen-



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From gdal at zeidlers.de  Wed Sep 27 01:00:23 2017
From: gdal at zeidlers.de (Julian Zeidler)
Date: Wed, 27 Sep 2017 10:00:23 +0200
Subject: [gdal-dev] Fillvalue set incorrectly on gdal_translate to NetCDF
	for Byte
Message-ID: <99549bdb-0389-9cd9-7a85-cbad89909c41@zeidlers.de>

Hi all,

I noticed, what I believe is an Error when converting a Byte Image from 
geotiff to Netcdf. In the newest Gdal Version (trunk from Monday),  it 
reports the correkt NoData Value (in older gdal Version  i tested this 
1.11 this was also incorrekt) but it reports the _FillValue as -1 while 
reporting that the Dataset is _Unsigned. This looks like the FillValue 
is written as a signed byte (For Na=254 it reports fillvalue=-2).

Is this difference between noData and _FillValue intentional? And is 
there any way to "fix" the FillValue in my Netcdf ?

I ran  gdal_translate example.tif example.nc -of netCDF

The tiff reports the (korrekt) NaValue as :

Band 1 Block=2000x4 Type=Byte, ColorInterp=Gray
   NoData Value=255

While in the NetCDF I get :

Band 1 Block=2000x1 Type=Byte, ColorInterp=Undefined
   NoData Value=255
   Metadata:
     grid_mapping=transverse_mercator
     long_name=GDAL Band Number 1
     NETCDF_VARNAME=Band1
     valid_range={0,255}
     _FillValue=-1
     _Unsigned=true

Best


Julian


From even.rouault at spatialys.com  Wed Sep 27 03:27:53 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 27 Sep 2017 12:27:53 +0200
Subject: [gdal-dev] Fillvalue set incorrectly on gdal_translate to
	NetCDF for Byte
In-Reply-To: <99549bdb-0389-9cd9-7a85-cbad89909c41@zeidlers.de>
References: <99549bdb-0389-9cd9-7a85-cbad89909c41@zeidlers.de>
Message-ID: <3206655.K1XBm9V604@even-i700>

On mercredi 27 septembre 2017 10:00:23 CEST Julian Zeidler wrote:
> Hi all,
> 
> I noticed, what I believe is an Error when converting a Byte Image from
> geotiff to Netcdf. In the newest Gdal Version (trunk from Monday),  it
> reports the correkt NoData Value (in older gdal Version  i tested this
> 1.11 this was also incorrekt) but it reports the _FillValue as -1 while
> reporting that the Dataset is _Unsigned. This looks like the FillValue
> is written as a signed byte (For Na=254 it reports fillvalue=-2).
> 
> Is this difference between noData and _FillValue intentional? And is
> there any way to "fix" the FillValue in my Netcdf ?
> 
> I ran  gdal_translate example.tif example.nc -of netCDF
> 
> The tiff reports the (korrekt) NaValue as :
> 
> Band 1 Block=2000x4 Type=Byte, ColorInterp=Gray
>    NoData Value=255
> 
> While in the NetCDF I get :
> 
> Band 1 Block=2000x1 Type=Byte, ColorInterp=Undefined
>    NoData Value=255
>    Metadata:
>      grid_mapping=transverse_mercator
>      long_name=GDAL Band Number 1
>      NETCDF_VARNAME=Band1
>      valid_range={0,255}
>      _FillValue=-1
>      _Unsigned=true

Julian,

this is an artifact of the old netCDF3 format (which is the default when reating a file with 
GDAL), which doesn't support unsigned byte, but signed byte. So GDAL has to use hacks to 
put unsigned byte to signed byte.
It sets a Band1:_Unsigned = "true" metadata, and then on reading, it knows that it must 
interpret signed as unsigned. The _FillValue=-1 just reflects that. That is what you will get if 
you use the "ncdump" utility. I'm ambivalent if GDAL should "fix" it or not.
Recent versions of GDAL do fix the NoData value since that's what users should use. The 
_FillValue is more an internal implementation detail.

As netCDF 4 is quite widespread now, you could also just do

gdal_translate example.tif example.nc -of netCDF -co FORMAT=NC4

and then everything will be unsigned.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170927/fde67da6/attachment.html>

From even.rouault at spatialys.com  Wed Sep 27 03:48:22 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 27 Sep 2017 12:48:22 +0200
Subject: [gdal-dev] Determining Native Data Field Type Names for a Given
	Layer or Driver
In-Reply-To: <1506471388803-0.post@n6.nabble.com>
References: <1506471388803-0.post@n6.nabble.com>
Message-ID: <3579725.pbMrCLjcMf@even-i700>

On mardi 26 septembre 2017 17:16:28 CEST Andrew Joseph wrote:
> I'm using the GDAL Java Bindings (most recent dev version 2.3.0) and looking
> to determine the native datatype of a given layer field -or at least the
> default mapping of the driver. For example I have manually written code
> like the following for Postgres/Postgis:
> 
>   private static final BiMap<String,Integer> PG_OGR_GOMETRY_TYPE_MAP =
>       new ImmutableBiMap.Builder<String, Integer>()
>         .put("Point",wkbPoint)
>         .put("LineString",wkbLineString)
>         .put("Polygon",wkbPolygon)
>         .put("Surface",wkbSurface)
>         .put("Curve",wkbCurve)
>         .put("MultiPoint",wkbMultiPoint)
>         .put("MultiLineString",wkbMultiLineString)
>         .put("MultiPolygon",wkbMultiPolygon)
>         .put("GeometryCollection",wkbGeometryCollection)
>         .put("CircularString",wkbCircularString)
>         .put("CompoundCurve",wkbCompoundCurve)
>         .put("CurvePolygon",wkbCurvePolygon)
>         .put("MultiCurve",wkbMultiCurve)
>         .put("MultiSurface",wkbMultiSurface)
>         .put("PolyhedralSurface",wkbPolyhedralSurface)
>         .build();
> 
>   private static final BiMap<String,Integer> POSTGIS_OGR_DATATYPE_MAP =
>       new ImmutableBiMap.Builder<String, Integer>()
>           .put("integer",OFTInteger)
>           .put("real",OFTReal)
>           .put("varchar",OFTString)
>           .put("bytea",OFTBinary)
>           .put("date",OFTDate)
>           .put("time",OFTTime)
>           .put("timestamp",OFTDateTime)
>           .put("bigint",OFTInteger64)
>           .put("integer[]",OFTIntegerList)
>           .put("real[]",OFTRealList)
>           .put("varchar[]",OFTStringList)
>           .put("bigint[]",OFTInteger64List)
>           .put("text",OFTWideString)

--> OFTWideString is unused. Will be OFTString

>           .put("text[]",OFTWideStringList)

--> same here. OFTStringList

>           .build();
> 
> However, it would obviously be orders of magnitude more
> convenient/future-proofed to simply retrieve these mappings from the
> driver/layer itself since each driver/layer must logically already have such
> a mapping.

That's really an implementation detail. Not sure it is a good idea to expose it,
and that only makes sense for SQL-like drivers. And it is generally not as simple
as a bidirectionnal map. Several postgres types can map to the same OGR field type.

You'll find the postgres->OGR logic in
https://trac.osgeo.org/gdal/browser/trunk/gdal/ogr/ogrsf_frmts/pgdump/ogrpgdumplayer.cpp#L1287

As you can see it also takes into account the field width and precision to decide
if a numeric must be mapped to a OFTReal, OFTInteger or OFTInteger64.

> In addition, is it possible to get the native datatypes that
> would be generated when copying, say a shapefile to postgres without
> actually copying the data itself?

You could just instanciate a target postgres table and add fields from the
source layer field definition, without copying any record. But that would create the table.
Alternatively you could use the PGDump driver for that, that is really close to what the Postgresql
driver does, but that would only write in a file, instead
of modifying a PG db.

$ ogr2ogr -f pgdump /vsistdout/ poly.shp -where "0=1"
SET standard_conforming_strings = OFF;
DROP TABLE IF EXISTS "public"."poly" CASCADE;
DELETE FROM geometry_columns WHERE f_table_name = 'poly' AND f_table_schema = 'public';
BEGIN;
CREATE TABLE "public"."poly" ( "ogc_fid" SERIAL, CONSTRAINT "poly_pk" PRIMARY KEY ("ogc_fid") );
SELECT AddGeometryColumn('public','poly','wkb_geometry',27700,'POLYGON',2);
CREATE INDEX "poly_wkb_geometry_geom_idx" ON "public"."poly" USING GIST ("wkb_geometry");
ALTER TABLE "public"."poly" ADD COLUMN "area" NUMERIC(12,3);
ALTER TABLE "public"."poly" ADD COLUMN "eas_id" NUMERIC(11,0);
ALTER TABLE "public"."poly" ADD COLUMN "prfedea" VARCHAR(16);
COMMIT;

You could probably use gdal.VectorTranslate() for that
http://gdal.org/java/org/gdal/gdal/gdal.html#VectorTranslate-org.gdal.gdal.Dataset-org.gdal.gdal.Dataset-org.gdal.gdal.VectorTranslateOptions-

although I don't think I've tested that the Java bindings for it work correctly

something like

shapefile_ds = gdal.OpenEx("my.shp");
gdal.VectorTranslate("tmp/out.txt", shapefile_ds, new gdal.VectorTranslateOptions(new Vector(Arrays.asList(new String[]{"-of", "PGDump", "-where", "0=1"}))));



Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170927/ab530260/attachment-0001.html>

From gdal at zeidlers.de  Wed Sep 27 05:12:25 2017
From: gdal at zeidlers.de (Julian Zeidler)
Date: Wed, 27 Sep 2017 14:12:25 +0200
Subject: [gdal-dev] Fillvalue set incorrectly on gdal_translate to
 NetCDF for Byte
In-Reply-To: <3206655.K1XBm9V604@even-i700>
References: <99549bdb-0389-9cd9-7a85-cbad89909c41@zeidlers.de>
 <3206655.K1XBm9V604@even-i700>
Message-ID: <250319db-8a03-3034-94a5-dd1ca48780bd@zeidlers.de>

Am 27.09.2017 um 12:27 schrieb Even Rouault:
>
> On mercredi 27 septembre 2017 10:00:23 CEST Julian Zeidler wrote:
>
> > Hi all,
>
> >
>
> > I noticed, what I believe is an Error when converting a Byte Image from
>
> > geotiff to Netcdf. In the newest Gdal Version (trunk from Monday),  it
>
> > reports the correkt NoData Value (in older gdal Version  i tested this
>
> > 1.11 this was also incorrekt) but it reports the _FillValue as -1 while
>
> > reporting that the Dataset is _Unsigned. This looks like the FillValue
>
> > is written as a signed byte (For Na=254 it reports fillvalue=-2).
>
> >
>
> > Is this difference between noData and _FillValue intentional? And is
>
> > there any way to "fix" the FillValue in my Netcdf ?
>
> >
>
> > I ran  gdal_translate example.tif example.nc -of netCDF
>
> >
>
> > The tiff reports the (korrekt) NaValue as :
>
> >
>
> > Band 1 Block=2000x4 Type=Byte, ColorInterp=Gray
>
> >   NoData Value=255
>
> >
>
> > While in the NetCDF I get :
>
> >
>
> > Band 1 Block=2000x1 Type=Byte, ColorInterp=Undefined
>
> >   NoData Value=255
>
> >   Metadata:
>
> >     grid_mapping=transverse_mercator
>
> >     long_name=GDAL Band Number 1
>
> >     NETCDF_VARNAME=Band1
>
> >     valid_range={0,255}
>
> >     _FillValue=-1
>
> >     _Unsigned=true
>
> Julian,
>
> this is an artifact of the old netCDF3 format (which is the default 
> when reating a file with GDAL), which doesn't support unsigned byte, 
> but signed byte. So GDAL has to use hacks to put unsigned byte to 
> signed byte.
>
> It sets a Band1:_Unsigned = "true" metadata, and then on reading, it 
> knows that it must interpret signed as unsigned. The _FillValue=-1 
> just reflects that. That is what you will get if you use the "ncdump" 
> utility. I'm ambivalent if GDAL should "fix" it or not.
>
> Recent versions of GDAL do fix the NoData value since that's what 
> users should use. The _FillValue is more an internal implementation 
> detail.
>
> As netCDF 4 is quite widespread now, you could also just do
>
> gdal_translate example.tif example.nc -of netCDF -co FORMAT=NC4
>
> and then everything will be unsigned.
>
> Even
>
> -- 
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
Hi Even,

Thanks for the quick reply.

I was aktually running it with -co FORMAT=NC4, but on Version 2.11.3, 
where there was no difference with or without this option. So i 
simplified it when testing on trunk. My Bad. Will migrate to a more 
recent Version.

Thanks

Julian

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170927/438aa8b0/attachment.html>

From even.rouault at spatialys.com  Wed Sep 27 12:38:15 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 27 Sep 2017 21:38:15 +0200
Subject: [gdal-dev] /MD vs /MDd for DEBUG MSVC builds
Message-ID: <5929234.EW3oT5kK1v@even-i700>

Hi,

For those who don't understand the title, you may skip this email ;-)

Once again someone raised an issue about the MSVC runtime we use for DEBUG=1 builds:
https://trac.osgeo.org/gdal/ticket/7059

and in https://trac.osgeo.org/gdal/ticket/6384 about the same issue, there are 4 similar 
tickets raised.

So it seems our default is a recurring problem.

Personnaly I believe I've never used a Windows build, so I'm mostly indifferent

Any opinion about using the debug MSVC runtime (/MDd) for DEBUG=1 builds instead of the 
current release runtime (/MD) ?

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170927/8b7dcad4/attachment.html>

From mateusz at loskot.net  Wed Sep 27 12:52:45 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed, 27 Sep 2017 21:52:45 +0200
Subject: [gdal-dev] /MD vs /MDd for DEBUG MSVC builds
In-Reply-To: <5929234.EW3oT5kK1v@even-i700>
References: <5929234.EW3oT5kK1v@even-i700>
Message-ID: <CABUeae8xQpZ3ORROb9Oc1E5dj9oZeAn6E70GV=4vpxLsyi8_EQ@mail.gmail.com>

On 27 September 2017 at 21:38, Even Rouault <even.rouault at spatialys.com> wrote:
>
> Once again someone raised an issue about the MSVC runtime we use for DEBUG=1
> builds: https://trac.osgeo.org/gdal/ticket/7059
>
> [...]
> Personnaly I believe I've never used a Windows build, so I'm mostly
> indifferent
>
> Any opinion about using the debug MSVC runtime (/MDd) for DEBUG=1 builds
> instead of the current release runtime (/MD) ?

Even,

Yesterday, I started thinking about adding an extra build configuration to NMAKE
makefile, controlled via command line defines, to enable such proper/full debug
build for Windows.

IMO, debug builds w/o /MDd are somewhat unexpected or exotic.
As one of Windows users and developers, I'd vote for the default
MSVC configuration for debug builds of GDAL.

This would also help a bit with binary packages for Visual C++,
currently, it requires nmake.opt patching.
https://github.com/Microsoft/vcpkg/pull/1879

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From even.rouault at spatialys.com  Wed Sep 27 13:32:23 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 27 Sep 2017 22:32:23 +0200
Subject: [gdal-dev] Determining Native Data Field Type Names for a Given
	Layer or Driver
In-Reply-To: <CAHDApB43r4mRD_kLBkFxHjLei_bgMHg8TS1sf-du+nwAnc6hkA@mail.gmail.com>
References: <1506471388803-0.post@n6.nabble.com> <3579725.pbMrCLjcMf@even-i700>
 <CAHDApB43r4mRD_kLBkFxHjLei_bgMHg8TS1sf-du+nwAnc6hkA@mail.gmail.com>
Message-ID: <1712076.mIpcWRE8p1@even-i700>

On mercredi 27 septembre 2017 15:22:15 CEST Andrew Joseph wrote:
>   Thanks, this worked out better than I could have hoped! I used:
> 
>     final String url = "/test_data/shapefiles/myshp.shp";
>     final Dataset shapefileDs = gdal.OpenEx(url);
>     final Vector<String> options = new Vector<>(Arrays.asList(
>         "-of", "PGDump",
>         "-where", "0=1",
>         "-lco", "FID=fid",
>         "-lco","GEOMETRY_NAME=geom",
>         "-lco","LAUNDER=NO"));
> 
>     gdal.VectorTranslate("/vsistdout", shapefileDs, new
> VectorTranslateOptions(options));
> 
> In terms of efficiency, is it better to use -limit 0 or -where FALSE?

Ah yes, -limit 0 will work much faster.

> 
> Also, is there any means of removing the BEGIN; and COMMIT; statements? 

I don't think so.

> 
> As a side note, I noticed that the BEGIN; statement in the dump is  issued
> after the DROP TABLE -which would mean the relevant table would be deleted
> even if the data load transaction failed -not sure if this is intended
> behavior or a bug.

I'm not completely sure if it is intended or not. From what I see, the PG driver does the same 
thing. There are perhaps issues with dropping a table in a transaction. I remember having 
some issues recently when creating (and perhaps overwriting) hundreds/thousands of tables 
in the same ogr2ogr invokation. This exhausted some PG server limitation.


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170927/09c3bba7/attachment.html>

From jmckenna at gatewaygeomatics.com  Wed Sep 27 15:05:12 2017
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Wed, 27 Sep 2017 19:05:12 -0300
Subject: [gdal-dev] /MD vs /MDd for DEBUG MSVC builds
In-Reply-To: <5929234.EW3oT5kK1v@even-i700>
References: <5929234.EW3oT5kK1v@even-i700>
Message-ID: <c090f7be-4069-bdbe-9920-beb5eaace6c9@gatewaygeomatics.com>

On 2017-09-27 4:38 PM, Even Rouault wrote:
> Hi,
> 
> For those who don't understand the title, you may skip this email ;-)
> 
> Once again someone raised an issue about the MSVC runtime we use for 
> DEBUG=1 builds:
> 
> https://trac.osgeo.org/gdal/ticket/7059
> 
> and in https://trac.osgeo.org/gdal/ticket/6384 about the same issue, 
> there are 4 similar tickets raised.
> 
> So it seems our default is a recurring problem.
> 
> Personnaly I believe I've never used a Windows build, so I'm mostly 
> indifferent
> 
> Any opinion about using the debug MSVC runtime (/MDd) for DEBUG=1 builds 
> instead of the current release runtime (/MD) ?
> 
> Even
> 

The fix proposed in ticket 7059 makes sense, I see the problem here in 
my local nmake, so +1

But I don't understand Mateusz's response.  I think the change in ticket 
7059 should be made, and no changes to any defaults, because packagers 
by default are not sharing default builds.  Again, maybe I am 
misunderstanding Mateusz's message.

-jeff



-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/

From cgodkin at gmail.com  Wed Sep 27 15:08:28 2017
From: cgodkin at gmail.com (Carl Godkin)
Date: Wed, 27 Sep 2017 15:08:28 -0700
Subject: [gdal-dev] /MD vs /MDd for DEBUG MSVC builds
In-Reply-To: <5929234.EW3oT5kK1v@even-i700>
References: <5929234.EW3oT5kK1v@even-i700>
Message-ID: <CAE=8km=k03jw4h+O2iB1NoAREfmgJs7kAYz8zLoci-i7L_NN9A@mail.gmail.com>

On Wed, Sep 27, 2017 at 12:38 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
>
>
> For those who don't understand the title, you may skip this email ;-)
>
>
>
> Once again someone raised an issue about the MSVC runtime we use for
> DEBUG=1 builds:
>
> https://trac.osgeo.org/gdal/ticket/7059
>
>
>
> and in https://trac.osgeo.org/gdal/ticket/6384 about the same issue,
> there are 4 similar tickets raised.
>
>
>
> So it seems our default is a recurring problem.
>
>
>
> Personnaly I believe I've never used a Windows build, so I'm mostly
> indifferent
>
>
>
> Any opinion about using the debug MSVC runtime (/MDd) for DEBUG=1 builds
> instead of the current release runtime (/MD) ?
>
>
>
>
>
Hi Even,

Since you ask, I can tell you that changing "/MD" to "/MDd" is one of just
two remaining edits that I have to make to nmake.opt before I build a new
version of GDAL.  We do most of our development on Windows and port to
Linux so I think we do the opposite of how it sounds like you work.

So we'd prefer /MDd.

(By the way, the other item in nmake.opt that I can't override with an
EXT_NMAKE_OPT
file is that we don't want to build with

ODBC_SUPPORTED = 1

If that were changed to use the !IFNDEF ODBC_SUPPORTED then I wouldn't have
to edit nmake.opt at all which would be very handy.)

Thanks very much,

carl
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170927/1b233e13/attachment-0001.html>

From jmckenna at gatewaygeomatics.com  Wed Sep 27 15:10:16 2017
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Wed, 27 Sep 2017 19:10:16 -0300
Subject: [gdal-dev] /MD vs /MDd for DEBUG MSVC builds
In-Reply-To: <CABUeae8xQpZ3ORROb9Oc1E5dj9oZeAn6E70GV=4vpxLsyi8_EQ@mail.gmail.com>
References: <5929234.EW3oT5kK1v@even-i700>
 <CABUeae8xQpZ3ORROb9Oc1E5dj9oZeAn6E70GV=4vpxLsyi8_EQ@mail.gmail.com>
Message-ID: <39e09928-5d16-25e3-c7cc-da39e02de9ae@gatewaygeomatics.com>

On 2017-09-27 4:52 PM, Mateusz Loskot wrote:
> On 27 September 2017 at 21:38, Even Rouault <even.rouault at spatialys.com> wrote:
>>
>> Once again someone raised an issue about the MSVC runtime we use for DEBUG=1
>> builds: https://trac.osgeo.org/gdal/ticket/7059
>>
>> [...]
>> Personnaly I believe I've never used a Windows build, so I'm mostly
>> indifferent
>>
>> Any opinion about using the debug MSVC runtime (/MDd) for DEBUG=1 builds
>> instead of the current release runtime (/MD) ?
> 
> Even,
> 
> Yesterday, I started thinking about adding an extra build configuration to NMAKE
> makefile, controlled via command line defines, to enable such proper/full debug
> build for Windows.
> 
> IMO, debug builds w/o /MDd are somewhat unexpected or exotic.
> As one of Windows users and developers, I'd vote for the default
> MSVC configuration for debug builds of GDAL.
> 
> This would also help a bit with binary packages for Visual C++,
> currently, it requires nmake.opt patching.
> https://github.com/Microsoft/vcpkg/pull/1879
> 
> Best regards,
> 

To clarify: Mateusz you mean that debug builds should be changed to 
/MDd, correct?  I somehow read your response as you also want to change 
the default build in nmake to be the debug build.  Or, maybe my brain is 
tired ha :)  -jeff


From even.rouault at spatialys.com  Wed Sep 27 15:11:12 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 28 Sep 2017 00:11:12 +0200
Subject: [gdal-dev] /MD vs /MDd for DEBUG MSVC builds
In-Reply-To: <c090f7be-4069-bdbe-9920-beb5eaace6c9@gatewaygeomatics.com>
References: <5929234.EW3oT5kK1v@even-i700>
 <c090f7be-4069-bdbe-9920-beb5eaace6c9@gatewaygeomatics.com>
Message-ID: <2765401.71tuoFKTAT@even-i700>

On mercredi 27 septembre 2017 19:05:12 CEST Jeff McKenna wrote:
> On 2017-09-27 4:38 PM, Even Rouault wrote:
> > Hi,
> > 
> > For those who don't understand the title, you may skip this email ;-)
> > 
> > Once again someone raised an issue about the MSVC runtime we use for
> > DEBUG=1 builds:
> > 
> > https://trac.osgeo.org/gdal/ticket/7059
> > 
> > and in https://trac.osgeo.org/gdal/ticket/6384 about the same issue,
> > there are 4 similar tickets raised.
> > 
> > So it seems our default is a recurring problem.
> > 
> > Personnaly I believe I've never used a Windows build, so I'm mostly
> > indifferent
> > 
> > Any opinion about using the debug MSVC runtime (/MDd) for DEBUG=1 builds
> > instead of the current release runtime (/MD) ?
> > 
> > Even
> 
> The fix proposed in ticket 7059 makes sense, I see the problem here in
> my local nmake, so +1
> 
> But I don't understand Mateusz's response.  I think the change in ticket
> 7059 should be made, and no changes to any defaults, because packagers
> by default are not sharing default builds.  Again, maybe I am
> misunderstanding Mateusz's message.
> 

So things are clear, I was thinking to this change


$ svn diff nmake.opt
Index: nmake.opt
===================================================================
--- nmake.opt	(revision 40206)
+++ nmake.opt	(working copy)
@@ -132,13 +132,13 @@
 !IFNDEF DEBUG
 OPTFLAGS= $(CXX_ANALYZE_FLAGS) $(CXX_PDB_FLAGS) /nologo /MP /MD /EHsc /Ox /FC /D_CRT_SECURE_NO_DEPRECATE /D_CRT_NONSTDC_NO_DEPRECATE /DNDEBUG
 !ELSE
-OPTFLAGS= $(CXX_ANALYZE_FLAGS) $(CXX_PDB_FLAGS) /nologo /MP /MD /EHsc /FC /D_CRT_SECURE_NO_DEPRECATE /D_CRT_NONSTDC_NO_DEPRECATE /DDEBUG
+OPTFLAGS= $(CXX_ANALYZE_FLAGS) $(CXX_PDB_FLAGS) /nologo /MP /MDd /EHsc /FC /D_CRT_SECURE_NO_DEPRECATE /D_CRT_NONSTDC_NO_DEPRECATE /DDEBUG
 !ENDIF
 !ELSE
 !IFNDEF DEBUG
 OPTFLAGS= $(CXX_PDB_FLAGS) /nologo /MD /EHsc /GR /Ox /FC /DNDEBUG
 !ELSE
-OPTFLAGS= $(CXX_PDB_FLAGS) /nologo /MD /EHsc /GR /FC /DDEBUG
+OPTFLAGS= $(CXX_PDB_FLAGS) /nologo /MDd /EHsc /GR /FC /DDEBUG
 !ENDIF
 !ENDIF  #MSVC_VER
 !ENDIF  # OPTFLAGS


(ah and I mistyped my initial message. I have sometimes done Windows builds,
just not *debug* builds)


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170928/4d69a999/attachment.html>

From mateusz at loskot.net  Wed Sep 27 15:20:34 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu, 28 Sep 2017 00:20:34 +0200
Subject: [gdal-dev] /MD vs /MDd for DEBUG MSVC builds
In-Reply-To: <39e09928-5d16-25e3-c7cc-da39e02de9ae@gatewaygeomatics.com>
References: <5929234.EW3oT5kK1v@even-i700>
 <CABUeae8xQpZ3ORROb9Oc1E5dj9oZeAn6E70GV=4vpxLsyi8_EQ@mail.gmail.com>
 <39e09928-5d16-25e3-c7cc-da39e02de9ae@gatewaygeomatics.com>
Message-ID: <CABUeae_v1Tdh8neG-1txFFJO32Tde8h9zA3DUeMoiSCWkg_b8w@mail.gmail.com>

On 28 Sep 2017 00:10, "Jeff McKenna" <jmckenna at gatewaygeomatics.com> wrote:

On 2017-09-27 4:52 PM, Mateusz Loskot wrote:

> On 27 September 2017 at 21:38, Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>>
>> Once again someone raised an issue about the MSVC runtime we use for
>> DEBUG=1
>> builds: https://trac.osgeo.org/gdal/ticket/7059
>>
>> [...]
>> Personnaly I believe I've never used a Windows build, so I'm mostly
>> indifferent
>>
>> Any opinion about using the debug MSVC runtime (/MDd) for DEBUG=1 builds
>> instead of the current release runtime (/MD) ?
>>
>
> Even,
>
> Yesterday, I started thinking about adding an extra build configuration to
> NMAKE
> makefile, controlled via command line defines, to enable such proper/full
> debug
> build for Windows.
>
> IMO, debug builds w/o /MDd are somewhat unexpected or exotic.
> As one of Windows users and developers, I'd vote for the default
> MSVC configuration for debug builds of GDAL.
>
> This would also help a bit with binary packages for Visual C++,
> currently, it requires nmake.opt patching.
> https://github.com/Microsoft/vcpkg/pull/1879
>
> Best regards,
>
>
To clarify: Mateusz you mean that debug builds should be changed to /MDd,
correct?  I somehow read your response as you also want to change the
default build in nmake to be the debug build.  Or, maybe my brain is tired
ha :)  -jeff



Jeff, yes that is what I was trying to say,  to change the debug defaults
only.

Perhaps I shouldn't paste the link to vcpkg as the flags patched there are
different, not relevant here.

However, one may want to also package and offer debug binaries for MSVC
like Python 3.5 or 3.6+, and /MDd would definitely be a must as that is the
MSVC way.

Mat
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170928/a0465b72/attachment.html>

From mateusz at loskot.net  Wed Sep 27 15:31:51 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu, 28 Sep 2017 00:31:51 +0200
Subject: [gdal-dev] /MD vs /MDd for DEBUG MSVC builds
In-Reply-To: <CAE=8km=k03jw4h+O2iB1NoAREfmgJs7kAYz8zLoci-i7L_NN9A@mail.gmail.com>
References: <5929234.EW3oT5kK1v@even-i700>
 <CAE=8km=k03jw4h+O2iB1NoAREfmgJs7kAYz8zLoci-i7L_NN9A@mail.gmail.com>
Message-ID: <CABUeae_935Y4Z2UiJf1REq1Eurg3SXca807gA7+1pmALofPAtA@mail.gmail.com>

On 28 Sep 2017 00:08, "Carl Godkin" <cgodkin at gmail.com> wrote:



On Wed, Sep 27, 2017 at 12:38 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
>
>
> For those who don't understand the title, you may skip this email ;-)
>
>
>
> Once again someone raised an issue about the MSVC runtime we use for
> DEBUG=1 builds:
>
> https://trac.osgeo.org/gdal/ticket/7059
>
>
>
> and in https://trac.osgeo.org/gdal/ticket/6384 about the same issue,
> there are 4 similar tickets raised.
>
>
>
> So it seems our default is a recurring problem.
>
>
>
> Personnaly I believe I've never used a Windows build, so I'm mostly
> indifferent
>
>
>
> Any opinion about using the debug MSVC runtime (/MDd) for DEBUG=1 builds
> instead of the current release runtime (/MD) ?
>
>
>
>
>
Hi Even,

Since you ask, I can tell you that changing "/MD" to "/MDd" is one of just
two remaining edits that I have to make to nmake.opt before I build a new
version of GDAL.



Yup, me too and I think most GDAL as library users on Windows do it as
well.



(By the way, the other item in nmake.opt that I can't override with an
EXT_NMAKE_OPT
file is that we don't want to build with

ODBC_SUPPORTED = 1

If that were changed to use the !IFNDEF ODBC_SUPPORTED then I wouldn't have
to edit nmake.opt at all which would be very handy.)



Then, why not submit a patch or pull request. I think it's good idea.

Mateusz
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170928/f921f568/attachment-0001.html>

From ivar at avenza.com  Wed Sep 27 15:38:02 2017
From: ivar at avenza.com (Ilya Varaev)
Date: Wed, 27 Sep 2017 18:38:02 -0400
Subject: [gdal-dev] gdal-dev Digest, Vol 160, Issue 61
In-Reply-To: <mailman.8178.1506550110.21183.gdal-dev@lists.osgeo.org>
References: <mailman.8178.1506550110.21183.gdal-dev@lists.osgeo.org>
Message-ID: <CAA2mus53P1gprvWvrJcd14jgk5B_=gtkh-7LhY9epgeKvNNsyA@mail.gmail.com>

+1 here. One of a few changes in.the opt file we've had for many years is
"/MD" to "/MDd" in debug, so yes, it makes perfect sense.
ivar

> Hi Even,
>
>
> Since you ask, I can tell you that changing "/MD" to "/MDd" is one of just
> two remaining edits that I have to make to nmake.opt before I build a new
> version of GDAL.  We do most of our development on Windows and port to
> Linux so I think we do the opposite of how it sounds like you work.
>
> So we'd prefer /MDd.

On Wed, Sep 27, 2017 at 6:08 PM, <gdal-dev-request at lists.osgeo.org> wrote:

> Send gdal-dev mailing list submissions to
>         gdal-dev at lists.osgeo.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
>         https://lists.osgeo.org/mailman/listinfo/gdal-dev
> or, via email, send a message with subject or body 'help' to
>         gdal-dev-request at lists.osgeo.org
>
> You can reach the person managing the list at
>         gdal-dev-owner at lists.osgeo.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of gdal-dev digest..."
>
>
> Today's Topics:
>
>    1. /MD vs /MDd for DEBUG MSVC builds (Even Rouault)
>    2. Re: /MD vs /MDd for DEBUG MSVC builds (Mateusz Loskot)
>    3. Re: Determining Native Data Field Type Names for a Given
>       Layer or Driver (Even Rouault)
>    4. Re: /MD vs /MDd for DEBUG MSVC builds (Jeff McKenna)
>    5. Re: /MD vs /MDd for DEBUG MSVC builds (Carl Godkin)
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Wed, 27 Sep 2017 21:38:15 +0200
> From: Even Rouault <even.rouault at spatialys.com>
> To: gdal-dev at lists.osgeo.org
> Subject: [gdal-dev] /MD vs /MDd for DEBUG MSVC builds
> Message-ID: <5929234.EW3oT5kK1v at even-i700>
> Content-Type: text/plain; charset="utf-8"
>
> Hi,
>
> For those who don't understand the title, you may skip this email ;-)
>
> Once again someone raised an issue about the MSVC runtime we use for
> DEBUG=1 builds:
> https://trac.osgeo.org/gdal/ticket/7059
>
> and in https://trac.osgeo.org/gdal/ticket/6384 about the same issue,
> there are 4 similar
> tickets raised.
>
> So it seems our default is a recurring problem.
>
> Personnaly I believe I've never used a Windows build, so I'm mostly
> indifferent
>
> Any opinion about using the debug MSVC runtime (/MDd) for DEBUG=1 builds
> instead of the
> current release runtime (/MD) ?
>
> Even
>
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.osgeo.org/pipermail/gdal-dev/
> attachments/20170927/8b7dcad4/attachment-0001.html>
>
> ------------------------------
>
> Message: 2
> Date: Wed, 27 Sep 2017 21:52:45 +0200
> From: Mateusz Loskot <mateusz at loskot.net>
> To: Even Rouault <even.rouault at spatialys.com>
> Cc: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] /MD vs /MDd for DEBUG MSVC builds
> Message-ID:
>         <CABUeae8xQpZ3ORROb9Oc1E5dj9oZeAn6E70GV=4vpxLsyi8_EQ at mail.
> gmail.com>
> Content-Type: text/plain; charset="UTF-8"
>
> On 27 September 2017 at 21:38, Even Rouault <even.rouault at spatialys.com>
> wrote:
> >
> > Once again someone raised an issue about the MSVC runtime we use for
> DEBUG=1
> > builds: https://trac.osgeo.org/gdal/ticket/7059
> >
> > [...]
> > Personnaly I believe I've never used a Windows build, so I'm mostly
> > indifferent
> >
> > Any opinion about using the debug MSVC runtime (/MDd) for DEBUG=1 builds
> > instead of the current release runtime (/MD) ?
>
> Even,
>
> Yesterday, I started thinking about adding an extra build configuration to
> NMAKE
> makefile, controlled via command line defines, to enable such proper/full
> debug
> build for Windows.
>
> IMO, debug builds w/o /MDd are somewhat unexpected or exotic.
> As one of Windows users and developers, I'd vote for the default
> MSVC configuration for debug builds of GDAL.
>
> This would also help a bit with binary packages for Visual C++,
> currently, it requires nmake.opt patching.
> https://github.com/Microsoft/vcpkg/pull/1879
>
> Best regards,
> --
> Mateusz Loskot, http://mateusz.loskot.net
>
>
> ------------------------------
>
> Message: 3
> Date: Wed, 27 Sep 2017 22:32:23 +0200
> From: Even Rouault <even.rouault at spatialys.com>
> To: Andrew Joseph <ap.joseph1337 at gmail.com>
> Cc: "gdal-dev at lists.osgeo.org" <gdal-dev at lists.osgeo.org>
> Subject: Re: [gdal-dev] Determining Native Data Field Type Names for a
>         Given   Layer or Driver
> Message-ID: <1712076.mIpcWRE8p1 at even-i700>
> Content-Type: text/plain; charset="utf-8"
>
> On mercredi 27 septembre 2017 15:22:15 CEST Andrew Joseph wrote:
> >   Thanks, this worked out better than I could have hoped! I used:
> >
> >     final String url = "/test_data/shapefiles/myshp.shp";
> >     final Dataset shapefileDs = gdal.OpenEx(url);
> >     final Vector<String> options = new Vector<>(Arrays.asList(
> >         "-of", "PGDump",
> >         "-where", "0=1",
> >         "-lco", "FID=fid",
> >         "-lco","GEOMETRY_NAME=geom",
> >         "-lco","LAUNDER=NO"));
> >
> >     gdal.VectorTranslate("/vsistdout", shapefileDs, new
> > VectorTranslateOptions(options));
> >
> > In terms of efficiency, is it better to use -limit 0 or -where FALSE?
>
> Ah yes, -limit 0 will work much faster.
>
> >
> > Also, is there any means of removing the BEGIN; and COMMIT; statements?
>
> I don't think so.
>
> >
> > As a side note, I noticed that the BEGIN; statement in the dump is
> issued
> > after the DROP TABLE -which would mean the relevant table would be
> deleted
> > even if the data load transaction failed -not sure if this is intended
> > behavior or a bug.
>
> I'm not completely sure if it is intended or not. From what I see, the PG
> driver does the same
> thing. There are perhaps issues with dropping a table in a transaction. I
> remember having
> some issues recently when creating (and perhaps overwriting)
> hundreds/thousands of tables
> in the same ogr2ogr invokation. This exhausted some PG server limitation.
>
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.osgeo.org/pipermail/gdal-dev/
> attachments/20170927/09c3bba7/attachment-0001.html>
>
> ------------------------------
>
> Message: 4
> Date: Wed, 27 Sep 2017 19:05:12 -0300
> From: Jeff McKenna <jmckenna at gatewaygeomatics.com>
> To: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] /MD vs /MDd for DEBUG MSVC builds
> Message-ID:
>         <c090f7be-4069-bdbe-9920-beb5eaace6c9 at gatewaygeomatics.com>
> Content-Type: text/plain; charset=windows-1252; format=flowed
>
> On 2017-09-27 4:38 PM, Even Rouault wrote:
> > Hi,
> >
> > For those who don't understand the title, you may skip this email ;-)
> >
> > Once again someone raised an issue about the MSVC runtime we use for
> > DEBUG=1 builds:
> >
> > https://trac.osgeo.org/gdal/ticket/7059
> >
> > and in https://trac.osgeo.org/gdal/ticket/6384 about the same issue,
> > there are 4 similar tickets raised.
> >
> > So it seems our default is a recurring problem.
> >
> > Personnaly I believe I've never used a Windows build, so I'm mostly
> > indifferent
> >
> > Any opinion about using the debug MSVC runtime (/MDd) for DEBUG=1 builds
> > instead of the current release runtime (/MD) ?
> >
> > Even
> >
>
> The fix proposed in ticket 7059 makes sense, I see the problem here in
> my local nmake, so +1
>
> But I don't understand Mateusz's response.  I think the change in ticket
> 7059 should be made, and no changes to any defaults, because packagers
> by default are not sharing default builds.  Again, maybe I am
> misunderstanding Mateusz's message.
>
> -jeff
>
>
>
> --
> Jeff McKenna
> MapServer Consulting and Training Services
> http://www.gatewaygeomatics.com/
>
>
> ------------------------------
>
> Message: 5
> Date: Wed, 27 Sep 2017 15:08:28 -0700
> From: Carl Godkin <cgodkin at gmail.com>
> To: Even Rouault <even.rouault at spatialys.com>
> Cc: "gdal-dev at lists.osgeo.org" <gdal-dev at lists.osgeo.org>
> Subject: Re: [gdal-dev] /MD vs /MDd for DEBUG MSVC builds
> Message-ID:
>         <CAE=8km=k03jw4h+O2iB1NoAREfmgJs7kAYz8zLoci-
> i7L_NN9A at mail.gmail.com>
> Content-Type: text/plain; charset="utf-8"
>
> On Wed, Sep 27, 2017 at 12:38 PM, Even Rouault <even.rouault at spatialys.com
> >
> wrote:
>
> > Hi,
> >
> >
> >
> > For those who don't understand the title, you may skip this email ;-)
> >
> >
> >
> > Once again someone raised an issue about the MSVC runtime we use for
> > DEBUG=1 builds:
> >
> > https://trac.osgeo.org/gdal/ticket/7059
> >
> >
> >
> > and in https://trac.osgeo.org/gdal/ticket/6384 about the same issue,
> > there are 4 similar tickets raised.
> >
> >
> >
> > So it seems our default is a recurring problem.
> >
> >
> >
> > Personnaly I believe I've never used a Windows build, so I'm mostly
> > indifferent
> >
> >
> >
> > Any opinion about using the debug MSVC runtime (/MDd) for DEBUG=1 builds
> > instead of the current release runtime (/MD) ?
> >
> >
> >
> >
> >
> Hi Even,
>
> Since you ask, I can tell you that changing "/MD" to "/MDd" is one of just
> two remaining edits that I have to make to nmake.opt before I build a new
> version of GDAL.  We do most of our development on Windows and port to
> Linux so I think we do the opposite of how it sounds like you work.
>
> So we'd prefer /MDd.
>
> (By the way, the other item in nmake.opt that I can't override with an
> EXT_NMAKE_OPT
> file is that we don't want to build with
>
> ODBC_SUPPORTED = 1
>
> If that were changed to use the !IFNDEF ODBC_SUPPORTED then I wouldn't have
> to edit nmake.opt at all which would be very handy.)
>
> Thanks very much,
>
> carl
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.osgeo.org/pipermail/gdal-dev/
> attachments/20170927/1b233e13/attachment.html>
>
> ------------------------------
>
> Subject: Digest Footer
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> ------------------------------
>
> End of gdal-dev Digest, Vol 160, Issue 61
> *****************************************
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170927/a7983cda/attachment.html>

From Piyush.Agram at jpl.nasa.gov  Wed Sep 27 19:14:53 2017
From: Piyush.Agram at jpl.nasa.gov (Agram, Piyush S (334D))
Date: Thu, 28 Sep 2017 02:14:53 +0000
Subject: [gdal-dev] Geolocation arrays - location interpretation
Message-ID: <7500F9FD-A333-429F-969B-F54D0C19D680@jpl.nasa.gov>

Hi,
     I’m trying to track down systematic pixel shift effects observed with warping data using geolocation arrays:
https://trac.osgeo.org/gdal/ticket/6959

Essentially, the same data (image and location) provided as geolocation arrays is warped to a different output depending on how the arrays are laid out – WESN, WENS, EWSN, EWNS.
Gdalwarp produces least shift in warped data when the input arrays themselves are oriented WENS.

Is there a definitive definition for interpretation of lat,lon,value when geolocation arrays – i.e, are the lat/lon representative of pixel center (which I think should be the intent)?
Does GDAL by default assume that the geolocation value corresponds to the top/left of the pixel? Could this confusion result in the observed systematic shift?

Alternately, could the input arrays be reoriented to WENS using VRTs instead of rewriting large raster files?

Piyush
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170928/53901a73/attachment-0001.html>

From even.rouault at spatialys.com  Thu Sep 28 02:55:27 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 28 Sep 2017 11:55:27 +0200
Subject: [gdal-dev] Geolocation arrays - location interpretation
In-Reply-To: <7500F9FD-A333-429F-969B-F54D0C19D680@jpl.nasa.gov>
References: <7500F9FD-A333-429F-969B-F54D0C19D680@jpl.nasa.gov>
Message-ID: <16048810.lNPURtQZd3@even-i700>

On jeudi 28 septembre 2017 02:14:53 CEST Agram, Piyush S (334D) wrote:
> Hi,
>      I’m trying to track down systematic pixel shift effects observed with
> warping data using geolocation arrays:
> https://trac.osgeo.org/gdal/ticket/6959
> 
> Essentially, the same data (image and location) provided as geolocation
> arrays is warped to a different output depending on how the arrays are laid
> out – WESN, WENS, EWSN, EWNS.
 Gdalwarp produces least shift in warped data
> when the input arrays themselves are oriented WENS. 
> Is there a definitive definition for interpretation of lat,lon,value when
> geolocation arrays – i.e, are the lat/lon representative of pixel center
> (which I think should be the intent)?

That's a good question. I would assume that center of pixel would be what is expected in the 
gdalgeoloc code. I don't see anything explicitly said about that in
https://trac.osgeo.org/gdal/wiki/rfc4_geolocate

During your examination of the code, could you find what was expected ?

I assume you are using geolocation transformer with one of the drivers that support 
reporting geolocation arrays ? One possibility would be an inconsistency in the convention 
this driver (or the datasource itself) reports the lon,lat values with what the geolocation 
transformer expects.


 Does GDAL by default assume that the
> geolocation value corresponds to the top/left of the pixel? Could this
> confusion result in the observed systematic shift? 
> Alternately, could the input arrays be reoriented to WENS using VRTs instead
> of rewriting large raster files?

X_DATASET and Y_DATASET can point to any valid GDAL dataset, so a VRT should be possible 
(and you'll need a VRT to modify the values of X_DATASET and Y_DATASET ;-))

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170928/bc32afed/attachment.html>

From even.rouault at spatialys.com  Thu Sep 28 02:56:01 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 28 Sep 2017 11:56:01 +0200
Subject: [gdal-dev] Geolocation arrays - location interpretation
In-Reply-To: <7500F9FD-A333-429F-969B-F54D0C19D680@jpl.nasa.gov>
References: <7500F9FD-A333-429F-969B-F54D0C19D680@jpl.nasa.gov>
Message-ID: <1935578.XrQH1hHzKO@even-i700>

On jeudi 28 septembre 2017 02:14:53 CEST Agram, Piyush S (334D) wrote:
> Hi,
>      I’m trying to track down systematic pixel shift effects observed with
> warping data using geolocation arrays:
> https://trac.osgeo.org/gdal/ticket/6959
> 
> Essentially, the same data (image and location) provided as geolocation
> arrays is warped to a different output depending on how the arrays are laid
> out – WESN, WENS, EWSN, EWNS.
 Gdalwarp produces least shift in warped data
> when the input arrays themselves are oriented WENS. 
> Is there a definitive definition for interpretation of lat,lon,value when
> geolocation arrays – i.e, are the lat/lon representative of pixel center
> (which I think should be the intent)?

That's a good question. I would assume that center of pixel would be what is expected in the 
gdalgeoloc code. I don't see anything explicitly said about that in
https://trac.osgeo.org/gdal/wiki/rfc4_geolocate

During your examination of the code, could you find what was expected ?

I assume you are using geolocation transformer with one of the drivers that support 
reporting geolocation arrays ? One possibility would be an inconsistency in the convention 
this driver (or the datasource itself) reports the lon,lat values with what the geolocation 
transformer expects.


 Does GDAL by default assume that the
> geolocation value corresponds to the top/left of the pixel? Could this
> confusion result in the observed systematic shift? 
> Alternately, could the input arrays be reoriented to WENS using VRTs instead
> of rewriting large raster files?

X_DATASET and Y_DATASET can point to any valid GDAL dataset, so a VRT should be possible 
(and you'll need a VRT to modify the values of X_DATASET and Y_DATASET ;-))

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170928/818ffc33/attachment.html>

From even.rouault at spatialys.com  Thu Sep 28 03:05:45 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 28 Sep 2017 12:05:45 +0200
Subject: [gdal-dev] /MD vs /MDd for DEBUG MSVC builds
In-Reply-To: <2765401.71tuoFKTAT@even-i700>
References: <5929234.EW3oT5kK1v@even-i700>
 <c090f7be-4069-bdbe-9920-beb5eaace6c9@gatewaygeomatics.com>
 <2765401.71tuoFKTAT@even-i700>
Message-ID: <3406832.iV3rIMGho3@even-i700>

Hi,

Given the feedback, I've just committed the below change (in trunk only)

Even

> 
> $ svn diff nmake.opt
> Index: nmake.opt
> ===================================================================
> --- nmake.opt	(revision 40206)
> +++ nmake.opt	(working copy)
> @@ -132,13 +132,13 @@
>  !IFNDEF DEBUG
>  OPTFLAGS= $(CXX_ANALYZE_FLAGS) $(CXX_PDB_FLAGS) /nologo /MP /MD /EHsc /Ox
> /FC /D_CRT_SECURE_NO_DEPRECATE /D_CRT_NONSTDC_NO_DEPRECATE /DNDEBUG !
ELSE
> -OPTFLAGS= $(CXX_ANALYZE_FLAGS) $(CXX_PDB_FLAGS) /nologo /MP /MD /EHsc /FC
> /D_CRT_SECURE_NO_DEPRECATE /D_CRT_NONSTDC_NO_DEPRECATE /DDEBUG 
+OPTFLAGS=
> $(CXX_ANALYZE_FLAGS) $(CXX_PDB_FLAGS) /nologo /MP /MDd /EHsc /FC
> /D_CRT_SECURE_NO_DEPRECATE /D_CRT_NONSTDC_NO_DEPRECATE /DDEBUG !ENDIF
>  !ELSE
>  !IFNDEF DEBUG
>  OPTFLAGS= $(CXX_PDB_FLAGS) /nologo /MD /EHsc /GR /Ox /FC /DNDEBUG
>  !ELSE
> -OPTFLAGS= $(CXX_PDB_FLAGS) /nologo /MD /EHsc /GR /FC /DDEBUG
> +OPTFLAGS= $(CXX_PDB_FLAGS) /nologo /MDd /EHsc /GR /FC /DDEBUG
>  !ENDIF
>  !ENDIF  #MSVC_VER
>  !ENDIF  # OPTFLAGS
> 

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170928/e91a6215/attachment-0001.html>

From mateusz at loskot.net  Thu Sep 28 03:21:59 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu, 28 Sep 2017 12:21:59 +0200
Subject: [gdal-dev] /MD vs /MDd for DEBUG MSVC builds
In-Reply-To: <3406832.iV3rIMGho3@even-i700>
References: <5929234.EW3oT5kK1v@even-i700>
 <c090f7be-4069-bdbe-9920-beb5eaace6c9@gatewaygeomatics.com>
 <2765401.71tuoFKTAT@even-i700> <3406832.iV3rIMGho3@even-i700>
Message-ID: <CABUeae_VATAhkO82iqHLkcfQLD7uvyaeNNbwvnorXWKF4NBkoQ@mail.gmail.com>

On 28 September 2017 at 12:05, Even Rouault <even.rouault at spatialys.com> wrote:
>
> Given the feedback, I've just committed the below change (in trunk only)
>
> -OPTFLAGS= $(CXX_PDB_FLAGS) /nologo /MD /EHsc /GR /FC /DDEBUG
> +OPTFLAGS= $(CXX_PDB_FLAGS) /nologo /MDd /EHsc /GR /FC /DDEBUG

It's worth to notice that switch to /MDd also automatically defines _DEBUG [1].


[1] https://docs.microsoft.com/en-us/cpp/c-runtime-library/debug
-- 
Mateusz Loskot, http://mateusz.loskot.net

From roarke.gaskill at weather.com  Thu Sep 28 07:08:00 2017
From: roarke.gaskill at weather.com (Roarke Gaskill)
Date: Thu, 28 Sep 2017 09:08:00 -0500
Subject: [gdal-dev] GPKG nodata isn't applied in all tiles
Message-ID: <CADyWFeVwtQFCy0aPFw0nxBjOFpmP+n05sDCaZVtRyVKG1D9VNQ@mail.gmail.com>

Hi,

It seems the nodata value is not being used as "fill" completely around
tiled images.

To reproduce:

http://download.osgeo.org/geotiff/samples/spot/chicago/SP27GTIF.TIF

gdal_translate  -ot Float32 -of GPKG -co
"TILING_SCHEME=GoogleMapsCompatible" SP27GTIF.TIF chi1.gpkg
gdal_translate -a_nodata "-nan" -ot Float32 -of GPKG -co
"TILING_SCHEME=GoogleMapsCompatible" SP27GTIF.TIF chi2.gpkg

gdal_translate -of GTIFF -oo "USE_TILE_EXTENT=YES" chi1.gpkg chi1.tif
gdal_translate -of GTIFF -oo "USE_TILE_EXTENT=YES" chi2.gpkg chi2.tif

Notice that chi1.tif has 0 values all the way around the image.  As I would
expect because a nodata value was not applied when creating the gpkg.
Howeverm in chi2.tif it appears the nodata value of nan was applied on the
left and top of the image but not on the right and bottom.  Though on the
right it does appear to have applied some nodata values but not completely
to the right edge of the image.


Thanks,
Roarke
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170928/06109a2d/attachment.html>

From Jacob.Adams at cachecounty.org  Thu Sep 28 10:15:57 2017
From: Jacob.Adams at cachecounty.org (Jacob Adams)
Date: Thu, 28 Sep 2017 11:15:57 -0600
Subject: [gdal-dev] Compression Artifacts After Merging Imagery
In-Reply-To: <3214146.MsjjPYqiPg@even-i700>
References: <59C92BDA020000AC0001654B@mail.cachecounty.org>
 <3214146.MsjjPYqiPg@even-i700>
Message-ID: <59CCD9ED020000AC000165C1@mail.cachecounty.org>

Evan,

Thanks for your help. Adjusting the nearblack parameters and using
-setalpha instead of -setmask got the mask working as expected. 

I'd normally agree with you on mid-process compression, and if I were
using the data for any kind of analysis I would do as little compression
as possible. However, with this project I'm pressed for space and I'm
only trying to create an aerial imagery basemap. I did a quick test
compressing a single tile 10 times with gdal_translate and the output
was adequate for my project. There was an identifiable softening to the
image at the pixel-level, but the imagery was gathered at 3" per pixel.


On a different topic altogether, how would I go about contributing to
the doxygen-created documentation? In playing around with gdal_rasterize
I discovered that it's not clear in the current docs what options
trigger creation of a new raster instead of overwriting an existing
raster. My C++ skills are very rusty, but if I'm reading the source code
properly, the options -of, -init, -a_nodata, -a_srs, -te, -a_ullr, -co,
-ot, -ts, -outsize, -tr, and -tap set the bCreateOutput flag True. I'd
like to add a note explaining this so that someone else doesn't make the
same beginner's mistake I did of trying to specify creation options on
an existing dataset ;) Is this something I open a ticket for, or is
there a more direct way?

Thanks,

Jacob Adams
GIS Specialist, Cache County
 


>>> Even Rouault <even.rouault at spatialys.com> 9/25/2017 5:01 PM >>>
On lundi 25 septembre 2017 16:16:26 CEST Jacob Adams wrote:
> Oh ye great minds of the GDAL world, I've run into a problem that
I've not
> been able to solve.
> 
> I have aerial imagery comprised of about 1500 jpegs that I am trying
to
> merge together into three large (~18gb) jpeg‑compressed geotiffs to
be
> served by Geoserver. The images are tiled such that they shift down
about
> 100 pixels (out of ~7000) every so often. With a pure gdal_merge or
> gdalwarp mosaic, this leaves compression artifacts in the nodata
spaces
> along the borders. The cause of these artifacts seems to be explained
in
> Evan's comments on this ticket:
https://trac.osgeo.org/gdal/ticket/5102).
> 
> I tried pre‑processing a handful of the tilesinto geotiffs with the
> following three commands based on a similar discussion in February
>
(http://lists.osgeo.org/pipermail/gdal‑dev/2017‑February/046027.html):


> nearblack ‑co TILED=YES ‑of Gtiff ‑nb 0 ‑near 0 ‑setmask ‑o temp1.tif
 Tile1.jpeg

I think one issue is in the above nearblack invocation. Did you check
temp1.tif is "clean" by 
displaying it ?
Basically by setting ‑near 0, you say that nearblack should expect a
very clean frontier 
between nodata areas and valid areas. Whereas JPEG decompression
artifacts in such a 
situation will result in intermediate values in a few pixels beyond the
border.
I'd suggest trying with the default of nearblack, ‑near 15 and ‑nb 2,
and tune them if needed.


>     gdal_translate ‑co TILED=YES ‑co COMPRESS=JPEG ‑co
PHOTOMETRIC=YCBCR ‑b 1 ‑b 2 ‑b 
3 ‑mask 4 ‑‑config GDAL_TIFF_INTERNAL_MASK YES temp2.tif Tile1_out.tif


You shouldn't JPEG compress intermediate products. This will decrease
image quality. Only 
apply it to the final stage of your workflow.


Even

‑‑ 
Spatialys ‑ Geospatial professional services
http://www.spatialys.com

From Piyush.Agram at jpl.nasa.gov  Thu Sep 28 10:26:52 2017
From: Piyush.Agram at jpl.nasa.gov (Agram, Piyush S (334D))
Date: Thu, 28 Sep 2017 17:26:52 +0000
Subject: [gdal-dev] Geolocation arrays - location interpretation
In-Reply-To: <1935578.XrQH1hHzKO@even-i700>
References: <7500F9FD-A333-429F-969B-F54D0C19D680@jpl.nasa.gov>
 <1935578.XrQH1hHzKO@even-i700>
Message-ID: <BCA0D2C2-50F3-4CDA-9089-47920AD6EBDE@jpl.nasa.gov>

Hi Even,
     I think I have figured out how the GeoLocTransformer works. Dumped out the backmap and might have some changes.


1)       Rounding up to the nearest integer is definitely the issue here.

2)       I’m going to try this first – maybe a weighted approach will be better. For now, if a pixel falls in the middle of square – I’m going to add it to all of the 4 vertices. Then average all the data that went into a pixel of the backmap.

3)       For the regular grid tests, if this shows improvement (hopefully) – I can share the implementation and we can possibly discuss about adding a weighting scheme. I don’t want to increase the runtime too much by adding complexity.

Piyush

From: Even Rouault <even.rouault at spatialys.com>
Date: Thursday, September 28, 2017 at 2:56 AM
To: "gdal-dev at lists.osgeo.org" <gdal-dev at lists.osgeo.org>
Cc: "Agram, Piyush S (334D)" <Piyush.Agram at jpl.nasa.gov>
Subject: Re: [gdal-dev] Geolocation arrays - location interpretation


On jeudi 28 septembre 2017 02:14:53 CEST Agram, Piyush S (334D) wrote:

> Hi,

> I’m trying to track down systematic pixel shift effects observed with

> warping data using geolocation arrays:

> https://trac.osgeo.org/gdal/ticket/6959

>

> Essentially, the same data (image and location) provided as geolocation

> arrays is warped to a different output depending on how the arrays are laid

> out – WESN, WENS, EWSN, EWNS.

Gdalwarp produces least shift in warped data

> when the input arrays themselves are oriented WENS.

> Is there a definitive definition for interpretation of lat,lon,value when

> geolocation arrays – i.e, are the lat/lon representative of pixel center

> (which I think should be the intent)?



That's a good question. I would assume that center of pixel would be what is expected in the gdalgeoloc code. I don't see anything explicitly said about that in

https://trac.osgeo.org/gdal/wiki/rfc4_geolocate



During your examination of the code, could you find what was expected ?



I assume you are using geolocation transformer with one of the drivers that support reporting geolocation arrays ? One possibility would be an inconsistency in the convention this driver (or the datasource itself) reports the lon,lat values with what the geolocation transformer expects.





Does GDAL by default assume that the

> geolocation value corresponds to the top/left of the pixel? Could this

> confusion result in the observed systematic shift?

> Alternately, could the input arrays be reoriented to WENS using VRTs instead

> of rewriting large raster files?



X_DATASET and Y_DATASET can point to any valid GDAL dataset, so a VRT should be possible (and you'll need a VRT to modify the values of X_DATASET and Y_DATASET ;-))



Even



--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170928/e569f5da/attachment-0001.html>

From even.rouault at spatialys.com  Thu Sep 28 10:52:14 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 28 Sep 2017 19:52:14 +0200
Subject: [gdal-dev] Compression Artifacts After Merging Imagery
In-Reply-To: <59CCD9ED020000AC000165C1@mail.cachecounty.org>
References: <59C92BDA020000AC0001654B@mail.cachecounty.org>
 <3214146.MsjjPYqiPg@even-i700>
 <59CCD9ED020000AC000165C1@mail.cachecounty.org>
Message-ID: <2435686.dp7PF9uFkN@even-i700>

> On a different topic altogether, how would I go about contributing to
> the doxygen-created documentation? In playing around with gdal_rasterize
> I discovered that it's not clear in the current docs what options
> trigger creation of a new raster instead of overwriting an existing
> raster. My C++ skills are very rusty, but if I'm reading the source code
> properly, the options -of, -init, -a_nodata, -a_srs, -te, -a_ullr, -co,
> -ot, -ts, -outsize, -tr, and -tap set the bCreateOutput flag True. I'd
> like to add a note explaining this so that someone else doesn't make the
> same beginner's mistake I did of trying to specify creation options on
> an existing dataset ;) Is this something I open a ticket for, or is
> there a more direct way?

A ticket is fine. The changes are to be done in apps/gdal_utilities.dox

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170928/ccd33881/attachment.html>

From even.rouault at spatialys.com  Thu Sep 28 12:17:59 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 28 Sep 2017 21:17:59 +0200
Subject: [gdal-dev] GPKG nodata isn't applied in all tiles
In-Reply-To: <CADyWFeVwtQFCy0aPFw0nxBjOFpmP+n05sDCaZVtRyVKG1D9VNQ@mail.gmail.com>
References: <CADyWFeVwtQFCy0aPFw0nxBjOFpmP+n05sDCaZVtRyVKG1D9VNQ@mail.gmail.com>
Message-ID: <3213234.8A8mYrzzE0@even-i700>

On jeudi 28 septembre 2017 09:08:00 CEST Roarke Gaskill wrote:
> Hi,
> 
> It seems the nodata value is not being used as "fill" completely around
> tiled images.
> 
> To reproduce:
> 
> http://download.osgeo.org/geotiff/samples/spot/chicago/SP27GTIF.TIF
> 
> gdal_translate  -ot Float32 -of GPKG -co
> "TILING_SCHEME=GoogleMapsCompatible" SP27GTIF.TIF chi1.gpkg
> gdal_translate -a_nodata "-nan" -ot Float32 -of GPKG -co
> "TILING_SCHEME=GoogleMapsCompatible" SP27GTIF.TIF chi2.gpkg
> 
> gdal_translate -of GTIFF -oo "USE_TILE_EXTENT=YES" chi1.gpkg chi1.tif
> gdal_translate -of GTIFF -oo "USE_TILE_EXTENT=YES" chi2.gpkg chi2.tif
> 
> Notice that chi1.tif has 0 values all the way around the image.  As I would
> expect because a nodata value was not applied when creating the gpkg.
> Howeverm in chi2.tif it appears the nodata value of nan was applied on the
> left and top of the image but not on the right and bottom.  Though on the
> right it does appear to have applied some nodata values but not completely
> to the right edge of the image.

Roark,

there are 2 issues:

* NaN isn't a supported value for GeoPackage (just added a warning in that case). This due to 
the value being stored in the Real data_null column of the 
gpkg_2d_gridded_coverage_ancillary SQLite3 table, but SQLite3 doesn't support NaN values. 
They are stored like a SQL NULL value, so on reading GDAL (or other software) will not able 
to realize that there was a nodata value stored. That said, that should affect only the read 
side

* there was indeed an implementation issue with non-zero nodata value on edge tiles when 
using a TILING_SCHEME, which I've fixed in trunk.

So on writing this will work properly now, but when reading it back, the right bottom most 
tile which isn't serialized, but intersects the window of interest, will be read back with the 
default value of 0 instead of the expected NaN.

So I'd recommend you use a different value than NaN (like -1e10)

Also note that Float32 uses the implementation of the GeoPackage elevation extension at 
the time GDAL 2.2 was released. And this extension has finally be reworked, so 
interoperability with other software and potential future GDAL versions that might 
implement the final version of the extension is not guaranteed.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170928/758ba1d3/attachment.html>

From even.rouault at spatialys.com  Thu Sep 28 12:25:48 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 28 Sep 2017 21:25:48 +0200
Subject: [gdal-dev] Geolocation arrays - location interpretation
In-Reply-To: <BCA0D2C2-50F3-4CDA-9089-47920AD6EBDE@jpl.nasa.gov>
References: <7500F9FD-A333-429F-969B-F54D0C19D680@jpl.nasa.gov>
 <1935578.XrQH1hHzKO@even-i700>
 <BCA0D2C2-50F3-4CDA-9089-47920AD6EBDE@jpl.nasa.gov>
Message-ID: <3318006.8obif0XDmG@even-i700>

On jeudi 28 septembre 2017 17:26:52 CEST Agram, Piyush S (334D) wrote:
> Hi Even,
>      I think I have figured out how the GeoLocTransformer works. Dumped out
> the backmap and might have some changes.
 
> 
> 1)       Rounding up to the nearest integer is definitely the issue here.
> 
> 2)       I’m going to try this first – maybe a weighted approach will be
> better. For now, if a pixel falls in the middle of square – I’m going to
> add it to all of the 4 vertices. Then average all the data that went into a
> pixel of the backmap.

Perhaps bilinear resampling so that the weights are proportionnal ?

 
> 3)       For the regular grid tests, if this shows improvement (hopefully) –
> I can share the implementation and we can possibly discuss about adding a
> weighting scheme. I don’t want to increase the runtime too much by adding
> complexity.

I think (sub-pixel) accuracy is more important than speed. Speed improvements can be 
investigated later if needed.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170928/84de0ed4/attachment.html>

From mateusz at loskot.net  Thu Sep 28 12:53:44 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu, 28 Sep 2017 21:53:44 +0200
Subject: [gdal-dev] Removal of dangling gdal.org/wince.html page
Message-ID: <CABUeae9iyCsURn+izxCraS7xtr-23XqLu5zW_F0C1O0VApmWxA@mail.gmail.com>

Hi,

Two years ago, we dropped the Windows CE maintenance [1]
but it looks that the website has not been cleaned up.

I don't see the wince.html page in the repository anywhere,
looks like just a dangling file on the server.

How to remove remove it?

[1] https://lists.osgeo.org/pipermail/gdal-dev/2015-October/042783.html

Best regards.
-- 
Mateusz Loskot, http://mateusz.loskot.net

From even.rouault at spatialys.com  Thu Sep 28 12:58:58 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 28 Sep 2017 21:58:58 +0200
Subject: [gdal-dev] Removal of dangling gdal.org/wince.html page
In-Reply-To: <CABUeae9iyCsURn+izxCraS7xtr-23XqLu5zW_F0C1O0VApmWxA@mail.gmail.com>
References: <CABUeae9iyCsURn+izxCraS7xtr-23XqLu5zW_F0C1O0VApmWxA@mail.gmail.com>
Message-ID: <7028805.jzU5xQWN1R@even-i700>

On jeudi 28 septembre 2017 21:53:44 CEST Mateusz Loskot wrote:
> Hi,
> 
> Two years ago, we dropped the Windows CE maintenance [1]
> but it looks that the website has not been cleaned up.
> 
> I don't see the wince.html page in the repository anywhere,
> looks like just a dangling file on the server.
> 
> How to remove remove it?
>

I've just deleted it from the server.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170928/f8ce0121/attachment-0001.html>

From mateusz at loskot.net  Thu Sep 28 13:18:40 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu, 28 Sep 2017 22:18:40 +0200
Subject: [gdal-dev] Removal of dangling gdal.org/wince.html page
In-Reply-To: <7028805.jzU5xQWN1R@even-i700>
References: <CABUeae9iyCsURn+izxCraS7xtr-23XqLu5zW_F0C1O0VApmWxA@mail.gmail.com>
 <7028805.jzU5xQWN1R@even-i700>
Message-ID: <CABUeae-VEJqEUoFqMArmpHnR7hrq7sy9ibhuy8AGmM9XmeB1jg@mail.gmail.com>

On 28 September 2017 at 21:58, Even Rouault <even.rouault at spatialys.com> wrote:
> On jeudi 28 septembre 2017 21:53:44 CEST Mateusz Loskot wrote:
>
>> Two years ago, we dropped the Windows CE maintenance [1]
>> but it looks that the website has not been cleaned up.
>>
>> I don't see the wince.html page in the repository anywhere,
>> looks like just a dangling file on the server.
>>
>> How to remove remove it?
>
>
> I've just deleted it from the server.


Even, thank you

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From roarke.gaskill at weather.com  Thu Sep 28 13:38:54 2017
From: roarke.gaskill at weather.com (Roarke Gaskill)
Date: Thu, 28 Sep 2017 15:38:54 -0500
Subject: [gdal-dev] GPKG nodata isn't applied in all tiles
In-Reply-To: <3213234.8A8mYrzzE0@even-i700>
References: <CADyWFeVwtQFCy0aPFw0nxBjOFpmP+n05sDCaZVtRyVKG1D9VNQ@mail.gmail.com>
 <3213234.8A8mYrzzE0@even-i700>
Message-ID: <CADyWFeXEBDHZZPOnVfUe+_oPJxFyV7j7kxLjrMjJGxBpLXHODg@mail.gmail.com>

Evan,

Thank you for the insight and fix.

Roarke

On Thu, Sep 28, 2017 at 2:17 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> On jeudi 28 septembre 2017 09:08:00 CEST Roarke Gaskill wrote:
>
> > Hi,
>
> >
>
> > It seems the nodata value is not being used as "fill" completely around
>
> > tiled images.
>
> >
>
> > To reproduce:
>
> >
>
> > http://download.osgeo.org/geotiff/samples/spot/chicago/SP27GTIF.TIF
>
> >
>
> > gdal_translate -ot Float32 -of GPKG -co
>
> > "TILING_SCHEME=GoogleMapsCompatible" SP27GTIF.TIF chi1.gpkg
>
> > gdal_translate -a_nodata "-nan" -ot Float32 -of GPKG -co
>
> > "TILING_SCHEME=GoogleMapsCompatible" SP27GTIF.TIF chi2.gpkg
>
> >
>
> > gdal_translate -of GTIFF -oo "USE_TILE_EXTENT=YES" chi1.gpkg chi1.tif
>
> > gdal_translate -of GTIFF -oo "USE_TILE_EXTENT=YES" chi2.gpkg chi2.tif
>
> >
>
> > Notice that chi1.tif has 0 values all the way around the image. As I
> would
>
> > expect because a nodata value was not applied when creating the gpkg.
>
> > Howeverm in chi2.tif it appears the nodata value of nan was applied on
> the
>
> > left and top of the image but not on the right and bottom. Though on the
>
> > right it does appear to have applied some nodata values but not
> completely
>
> > to the right edge of the image.
>
>
>
> Roark,
>
>
>
> there are 2 issues:
>
>
>
> * NaN isn't a supported value for GeoPackage (just added a warning in that
> case). This due to the value being stored in the Real data_null column of
> the gpkg_2d_gridded_coverage_ancillary SQLite3 table, but SQLite3 doesn't
> support NaN values. They are stored like a SQL NULL value, so on reading
> GDAL (or other software) will not able to realize that there was a nodata
> value stored. That said, that should affect only the read side
>
>
>
> * there was indeed an implementation issue with non-zero nodata value on
> edge tiles when using a TILING_SCHEME, which I've fixed in trunk.
>
>
>
> So on writing this will work properly now, but when reading it back, the
> right bottom most tile which isn't serialized, but intersects the window of
> interest, will be read back with the default value of 0 instead of the
> expected NaN.
>
>
>
> So I'd recommend you use a different value than NaN (like -1e10)
>
>
>
> Also note that Float32 uses the implementation of the GeoPackage elevation
> extension at the time GDAL 2.2 was released. And this extension has finally
> be reworked, so interoperability with other software and potential future
> GDAL versions that might implement the final version of the extension is
> not guaranteed.
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>



-- 
*Roarke **Gaskill  *|Senior Software Engineer
*e:* roarke.gaskill at weather.com
<http://weather.com/apps> <http://weather.com/apps>
<http://weather.com/apps> <http://weather.com/apps>
<http://weather.com/apps> <http://weather.com/apps>
<http://weather.com/apps> <http://weather.com/apps>
<http://weather.com/apps> <http://weather.com/apps>
<http://weather.com/apps> <http://weather.com/apps>
<http://weather.com/apps> <http://weather.com/apps>
<http://weather.com/apps> <http://weather.com/apps>
<http://weather.com/apps>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170928/b3e30161/attachment.html>

From Piyush.Agram at jpl.nasa.gov  Thu Sep 28 15:18:31 2017
From: Piyush.Agram at jpl.nasa.gov (Agram, Piyush S (334D))
Date: Thu, 28 Sep 2017 22:18:31 +0000
Subject: [gdal-dev] Geolocation arrays - location interpretation
In-Reply-To: <3318006.8obif0XDmG@even-i700>
References: <7500F9FD-A333-429F-969B-F54D0C19D680@jpl.nasa.gov>
 <1935578.XrQH1hHzKO@even-i700>
 <BCA0D2C2-50F3-4CDA-9089-47920AD6EBDE@jpl.nasa.gov>
 <3318006.8obif0XDmG@even-i700>
Message-ID: <1BBEFAA8-4F26-4F3F-985F-96200AF7E619@jpl.nasa.gov>

Hi Even,
    I implemented the bilinear weighting like we discussed and that took out the systematic pixel shift from 1 to 0.5 (sign depending on orientation).
You can see the changes here:
https://github.com/piyushrpt/gdal/commit/b199cbae9ea15e31c787c1480c342bb84debf774

I also tried playing with the upsampling factor (1.3 to 4.0) and the discrepancy numbers were consistent after 1.5. Probably, the minimum needs to be sqrt(2) for square pixels.
Using the weighting fixed the truncation / rounding error and the results seem consistent when I move the output extent around.

The systematic 0.5 pixel shift suggests that there is still an issue. Is my interpretation that the GeoLocTransformer is supposed to operate on pixel center coordinates correct?
i.e – if my geoloc arrays were regular grid and I feed in the coordinates to the transformer, they return pixel centers – 0.5,0.5 etc.
I’m going to try implementing some round trip checks to see if that shows something?

Piyush

From: Even Rouault <even.rouault at spatialys.com>
Date: Thursday, September 28, 2017 at 12:25 PM
To: "Agram, Piyush S (334D)" <Piyush.Agram at jpl.nasa.gov>
Cc: "gdal-dev at lists.osgeo.org" <gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] Geolocation arrays - location interpretation


On jeudi 28 septembre 2017 17:26:52 CEST Agram, Piyush S (334D) wrote:

> Hi Even,

> I think I have figured out how the GeoLocTransformer works. Dumped out

> the backmap and might have some changes.

>

> 1) Rounding up to the nearest integer is definitely the issue here.

>

> 2) I’m going to try this first – maybe a weighted approach will be

> better. For now, if a pixel falls in the middle of square – I’m going to

> add it to all of the 4 vertices. Then average all the data that went into a

> pixel of the backmap.



Perhaps bilinear resampling so that the weights are proportionnal ?



> 3) For the regular grid tests, if this shows improvement (hopefully) –

> I can share the implementation and we can possibly discuss about adding a

> weighting scheme. I don’t want to increase the runtime too much by adding

> complexity.



I think (sub-pixel) accuracy is more important than speed. Speed improvements can be investigated later if needed.



--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170928/f95f06e4/attachment-0001.html>

From even.rouault at spatialys.com  Thu Sep 28 15:36:43 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 29 Sep 2017 00:36:43 +0200
Subject: [gdal-dev] Geolocation arrays - location interpretation
In-Reply-To: <1BBEFAA8-4F26-4F3F-985F-96200AF7E619@jpl.nasa.gov>
References: <7500F9FD-A333-429F-969B-F54D0C19D680@jpl.nasa.gov>
 <3318006.8obif0XDmG@even-i700>
 <1BBEFAA8-4F26-4F3F-985F-96200AF7E619@jpl.nasa.gov>
Message-ID: <5838365.lRjaaDpsyx@even-i700>

On jeudi 28 septembre 2017 22:18:31 CEST Agram, Piyush S (334D) wrote:
> Hi Even,
>     I implemented the bilinear weighting like we discussed and that took out
> the systematic pixel shift from 1 to 0.5 (sign depending on orientation).
> You can see the changes here:
> https://github.com/piyushrpt/gdal/commit/b199cbae9ea15e31c787c1480c342bb84de
> bf774
 
> I also tried playing with the upsampling factor (1.3 to 4.0) and the
> discrepancy numbers were consistent after 1.5. Probably, the minimum needs
> to be sqrt(2) for square pixels.
 Using the weighting fixed the truncation
> / rounding error and the results seem consistent when I move the output
> extent around. 
> The systematic 0.5 pixel shift suggests that there is still an issue. Is my
> interpretation that the GeoLocTransformer is supposed to operate on pixel
> center coordinates correct?
 i.e – if my geoloc arrays were regular grid
> and I feed in the coordinates to the transformer, they return pixel centers
> – 0.5,0.5 etc. I’m going to try implementing some round trip checks to see
> if that shows something? 

Yes I agree there must be a 0.5 pixel shift issue when looking at the forward path in 
GDALGeoLocTransform(), ie the one taken by if( !bDstToSrc )

So we have currently

           const double dfGeoLocPixel =
                (padfX[i] - psTransform->dfPIXEL_OFFSET)
                / psTransform->dfPIXEL_STEP;
            const double dfGeoLocLine =
                (padfY[i] - psTransform->dfLINE_OFFSET)
                / psTransform->dfLINE_STEP;


For example take the case of offset = 0 and step = 1 to simplify

Imagine than padfX[0] = 0.5 and padfY[0] = 0.5 (so center of the top left pixel)

which will lead to iX = 0 and iY = 10

Now we are going to take a bilinear resampling at lines 788-800 (current trunk)

out_padfX[0] = 0.25 * (geoloc[0] + geoloc[1] + geoloc[width] + geoloc[width+1])

whereas it should be just out_padfX[0] = geoloc[0] . No resampling needed.

So perhaps something like the following ( substracting 0.5 ) would work ?

           const double dfGeoLocPixel =
                (padfX[i] - 0.5 - psTransform->dfPIXEL_OFFSET)
                / psTransform->dfPIXEL_STEP;
            const double dfGeoLocLine =
                (padfY[i] - 0.5 - psTransform->dfLINE_OFFSET)
                / psTransform->dfLINE_STEP;

and probably something equivalent in the other direction

Perhaps we should have some metadata item to indicate the convention and apply or not this 
0.5 shift
Like GEOLOC_COORD_CONVENTION=PIXEL_CENTER (default if not specified) or 
GEOLOC_COORD_CONVENTION=PIXEL_TOP_LEFT
But I'd expect most (all ?) datasources to use a pixel_center convention.

Which format/driver are you using ?

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170929/698b0f61/attachment.html>

From Piyush.Agram at jpl.nasa.gov  Thu Sep 28 20:35:55 2017
From: Piyush.Agram at jpl.nasa.gov (Agram, Piyush S (334D))
Date: Fri, 29 Sep 2017 03:35:55 +0000
Subject: [gdal-dev] Geolocation arrays - location interpretation
In-Reply-To: <5838365.lRjaaDpsyx@even-i700>
References: <7500F9FD-A333-429F-969B-F54D0C19D680@jpl.nasa.gov>
 <3318006.8obif0XDmG@even-i700>
 <1BBEFAA8-4F26-4F3F-985F-96200AF7E619@jpl.nasa.gov>
 <5838365.lRjaaDpsyx@even-i700>
Message-ID: <CAF94F9F-AA5F-4A8F-A0CF-C0A408D3A846@jpl.nasa.gov>

Hi Even,
     Here is my first cut at fixing the half pixel shifts:
https://github.com/piyushrpt/gdal/commit/ead79550e7120767187a0b9c836b5d861223d997

With these changes, the shifts are down to sub 0.2 pixels. Still not sure if I got the math right. Feel like the errors should be smaller for the ideal simulated datasets that I’m using.

Piyush

From: Even Rouault <even.rouault at spatialys.com>
Date: Thursday, September 28, 2017 at 3:36 PM
To: "Agram, Piyush S (334D)" <Piyush.Agram at jpl.nasa.gov>
Cc: "gdal-dev at lists.osgeo.org" <gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] Geolocation arrays - location interpretation


On jeudi 28 septembre 2017 22:18:31 CEST Agram, Piyush S (334D) wrote:

> Hi Even,

> I implemented the bilinear weighting like we discussed and that took out

> the systematic pixel shift from 1 to 0.5 (sign depending on orientation).

> You can see the changes here:

> https://github.com/piyushrpt/gdal/commit/b199cbae9ea15e31c787c1480c342bb84de

> bf774

> I also tried playing with the upsampling factor (1.3 to 4.0) and the

> discrepancy numbers were consistent after 1.5. Probably, the minimum needs

> to be sqrt(2) for square pixels.

Using the weighting fixed the truncation

> / rounding error and the results seem consistent when I move the output

> extent around.

> The systematic 0.5 pixel shift suggests that there is still an issue. Is my

> interpretation that the GeoLocTransformer is supposed to operate on pixel

> center coordinates correct?

i.e – if my geoloc arrays were regular grid

> and I feed in the coordinates to the transformer, they return pixel centers

> – 0.5,0.5 etc. I’m going to try implementing some round trip checks to see

> if that shows something?



Yes I agree there must be a 0.5 pixel shift issue when looking at the forward path in GDALGeoLocTransform(), ie the one taken by if( !bDstToSrc )



So we have currently



const double dfGeoLocPixel =

(padfX[i] - psTransform->dfPIXEL_OFFSET)

/ psTransform->dfPIXEL_STEP;

const double dfGeoLocLine =

(padfY[i] - psTransform->dfLINE_OFFSET)

/ psTransform->dfLINE_STEP;





For example take the case of offset = 0 and step = 1 to simplify



Imagine than padfX[0] = 0.5 and padfY[0] = 0.5 (so center of the top left pixel)



which will lead to iX = 0 and iY = 10



Now we are going to take a bilinear resampling at lines 788-800 (current trunk)



out_padfX[0] = 0.25 * (geoloc[0] + geoloc[1] + geoloc[width] + geoloc[width+1])



whereas it should be just out_padfX[0] = geoloc[0] . No resampling needed.



So perhaps something like the following ( substracting 0.5 ) would work ?



const double dfGeoLocPixel =

(padfX[i] - 0.5 - psTransform->dfPIXEL_OFFSET)

/ psTransform->dfPIXEL_STEP;

const double dfGeoLocLine =

(padfY[i] - 0.5 - psTransform->dfLINE_OFFSET)

/ psTransform->dfLINE_STEP;



and probably something equivalent in the other direction



Perhaps we should have some metadata item to indicate the convention and apply or not this 0.5 shift

Like GEOLOC_COORD_CONVENTION=PIXEL_CENTER (default if not specified) or GEOLOC_COORD_CONVENTION=PIXEL_TOP_LEFT

But I'd expect most (all ?) datasources to use a pixel_center convention.



Which format/driver are you using ?



--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170929/5b21caaf/attachment-0001.html>

From a.neumann at carto.net  Thu Sep 28 23:32:07 2017
From: a.neumann at carto.net (Andreas Neumann)
Date: Fri, 29 Sep 2017 08:32:07 +0200
Subject: [gdal-dev] ogr2ogr and nlt question
Message-ID: <922f235833c3dbfd87d4ea4974422d93@carto.net>

Hi, 

when using ogr2ogr I can fix the geometry type for cases where I use SQL
statements. 

Can I use nlt multiple times? In my case I would like to specify -nlt
CONVERT_TO_LINEAR to convert from CompounCurve to Polygon and then use
-nlt POLYGON to tell it you are really a POLYGON. Is this possible to
use the -nlt parameter twice? 

Thank you for your reply, 

Andreas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170929/8290fdd5/attachment.html>

From a.neumann at carto.net  Thu Sep 28 23:33:40 2017
From: a.neumann at carto.net (Andreas Neumann)
Date: Fri, 29 Sep 2017 08:33:40 +0200
Subject: [gdal-dev] ogr2ogr and nlt question
In-Reply-To: <922f235833c3dbfd87d4ea4974422d93@carto.net>
References: <922f235833c3dbfd87d4ea4974422d93@carto.net>
Message-ID: <e78167e13a9d25870f9d4f805a43127b@carto.net>

sorry - I meant to say that I convert CURVEPOLYGON to POLYGON, not
COMPOUNDCURVE TO POLYGON. 

Andreas 

On 2017-09-29 08:32, Andreas Neumann wrote:

> Hi, 
> 
> when using ogr2ogr I can fix the geometry type for cases where I use SQL statements. 
> 
> Can I use nlt multiple times? In my case I would like to specify -nlt CONVERT_TO_LINEAR to convert from CompounCurve to Polygon and then use -nlt POLYGON to tell it you are really a POLYGON. Is this possible to use the -nlt parameter twice? 
> 
> Thank you for your reply, 
> 
> Andreas 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170929/7514d6ff/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Fri Sep 29 00:34:27 2017
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Fri, 29 Sep 2017 07:34:27 +0000
Subject: [gdal-dev] KML recognized as GML by ogr2ogr
Message-ID: <1506670467594.48087@maanmittauslaitos.fi>

Hi,

See https://gis.stackexchange.com/questions/256861/kml-to-shapefile-problems-ogr2ogr

I have verified with todays GDAL 2.3.0dev  from gisinternals that ogrinfos open the KML file form that question with LIBKML driver while ogr2ogr opens it with GML driver and fails.

-Jukka Rahkonen-

From a.neumann at carto.net  Fri Sep 29 01:35:52 2017
From: a.neumann at carto.net (Andreas Neumann)
Date: Fri, 29 Sep 2017 10:35:52 +0200
Subject: [gdal-dev] ogr2ogr and nlt question
In-Reply-To: <922f235833c3dbfd87d4ea4974422d93@carto.net>
References: <922f235833c3dbfd87d4ea4974422d93@carto.net>
Message-ID: <c7440c753ff0f09801cd7b667a656782@carto.net>

answering myself: apparently ogr2ogr accepts two -nlt parameters and the
result looks ok (correct type and correctly segmentized from the
original CURVEPOLYGON). 

So all good in this respect. 

Andreas 

On 2017-09-29 08:32, Andreas Neumann wrote:

> Hi, 
> 
> when using ogr2ogr I can fix the geometry type for cases where I use SQL statements. 
> 
> Can I use nlt multiple times? In my case I would like to specify -nlt CONVERT_TO_LINEAR to convert from CompounCurve to Polygon and then use -nlt POLYGON to tell it you are really a POLYGON. Is this possible to use the -nlt parameter twice? 
> 
> Thank you for your reply, 
> 
> Andreas 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170929/2326ecbe/attachment.html>

From roel at huybrechts.re  Fri Sep 29 01:49:55 2017
From: roel at huybrechts.re (Roel Huybrechts)
Date: Fri, 29 Sep 2017 10:49:55 +0200
Subject: [gdal-dev] Compiling GDAL 2.2.2 with Informix (IDB) driver on
	Ubuntu 16.04
Message-ID: <1506674995.2285568.1122228192.091C518F@webmail.messagingengine.com>

Dear list,

We'd like to use GDAL in combination with the Informix (IDB) driver to
copy data from an Informix database.

After applying some changes regarding linking [1], we're able to compile
GDAL + IDB driver on Debian Stretch and Testing and on Ubuntu 14.04.
However, it doesn't work on Ubuntu 16.04, which happens to be what we're
using on our servers..

The error on Ubuntu 16.04 seems to be related to the IDB driver:
compiling GDAL without IDB works fine.

The message we're seeing is:
make[1]: Entering directory '/home/roel/software/gdal_compile/gdal/apps'
/bin/bash /home/roel/software/gdal_compile/gdal/libtool --mode=link    
g++ -std=gnu++11  -L/opt/informix/lib/ -L/opt/informix/lib/esql -lifsql
-lifasf -lifgen -lifos -lifgls -lifglx /opt/informix/lib/esql/checkapi.o
-L/opt/informix/lib/dmi -lifdmi -L/opt/informix/lib/c++ -lifc++ -lcrypt
gdalinfo_bin.lo  /home/roel/software/gdal_compile/gdal/libgdal.la  -o
gdalinfo
libtool: link: g++ -std=gnu++11 /opt/informix/lib/esql/checkapi.o
.libs/gdalinfo_bin.o -o .libs/gdalinfo  -L/opt/informix/lib/
-L/opt/informix/lib/esql -L/opt/informix/lib/dmi -L/opt/informix/lib/c++
-lcrypt /home/roel/software/gdal_compile/gdal/.libs/libgdal.so
-L/usr/lib -L/usr/lib/x86_64-linux-gnu/hdf5/serial -ljson-c -lfreexl
-lqhull -lgeos_c -lwebp /usr/lib/x86_64-linux-gnu/libsqlite3.so -lodbc
-lodbcinst -lkmlbase -lkmldom -lkmlengine -lkmlxsd -lkmlregionator
/usr/lib/x86_64-linux-gnu/libexpat.so -lxerces-c -lopenjp2 -lnetcdf
-lhdf5_hl -lsz -lhdf5 /usr/lib/libmfhdfalt.so /usr/lib/libdfalt.so
-logdi -lgif -ljpeg -lgeotiff -ltiff -lpng -lpq -lz -lpthread -lrt -ldl
-lpcre /usr/lib/x86_64-linux-gnu/libcurl-gnutls.so -lxml2 -lifsql
-lifasf -lifgen -lifos -lifgls -lifglx -lifdmi -lifc++ -pthread 
/opt/informix/lib/c++/libifc++.so: undefined reference to `mi_cleanup'
(et cetera, the list of undefined references to informix libs goes on)

Running ldd also reveals:
$ ldd .libs/libgdal*.so
(...)
libifc++.so => not found
(...)

If anyone can spot an error we've made, or has a hint on how to proceed
with debugging that would be great!

Thanks in advance!
Roel

[1]:
https://github.com/johanvdw/gdal/commit/92fce0db7c61d907699135ea27032be3b72645e6

From even.rouault at spatialys.com  Fri Sep 29 03:45:57 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 29 Sep 2017 12:45:57 +0200
Subject: [gdal-dev] Geolocation arrays - location interpretation
In-Reply-To: <CAF94F9F-AA5F-4A8F-A0CF-C0A408D3A846@jpl.nasa.gov>
References: <7500F9FD-A333-429F-969B-F54D0C19D680@jpl.nasa.gov>
 <5838365.lRjaaDpsyx@even-i700>
 <CAF94F9F-AA5F-4A8F-A0CF-C0A408D3A846@jpl.nasa.gov>
Message-ID: <2119672.a0IJSkvb9E@even-i700>

On vendredi 29 septembre 2017 03:35:55 CEST Agram, Piyush S (334D) wrote:
> Hi Even,
>      Here is my first cut at fixing the half pixel shifts:
> https://github.com/piyushrpt/gdal/commit/ead79550e7120767187a0b9c836b5d86122
> 3d997
 
> With these changes, the shifts are down to sub 0.2 pixels. Still not sure if
> I got the math right. Feel like the errors should be smaller for the ideal
> simulated datasets that I’m using.

Yes I think with a synthetic geolocation array that would encode the equivalent of a 
geotransform matrix (padfX[y][x] = X0 + x_res * x + 0.5 and padfY[y][x] = Y0 + y_res * y - 0.5), 
you should ideally get a ~0 pixel error.
One potential candidate for error would be the "loop over the backmap trying to fill in holes 
with nearby values." step. Given the backmap is created at a higher resolution than the 
source, the interpolation done in it can contribute errors.
On the above synthetic geolocation array, I would probably try with a backmap size equal to 
the geolocation dataset size (which should eliminate any hole filling step), and then tune 
things until I get a 0 error.
Perhaps the hole filling step would need a smarter/smoother interpolation logic

 
> Piyush
> 
> From: Even Rouault <even.rouault at spatialys.com>
> Date: Thursday, September 28, 2017 at 3:36 PM
> To: "Agram, Piyush S (334D)" <Piyush.Agram at jpl.nasa.gov>
> Cc: "gdal-dev at lists.osgeo.org" <gdal-dev at lists.osgeo.org>
> Subject: Re: [gdal-dev] Geolocation arrays - location interpretation
> 
> 
> On jeudi 28 septembre 2017 22:18:31 CEST Agram, Piyush S (334D) wrote:
> 
> 
> > Hi Even,
> 
> 
> 
> > I implemented the bilinear weighting like we discussed and that took out
> 
> 
> 
> > the systematic pixel shift from 1 to 0.5 (sign depending on orientation).
> 
> 
> 
> > You can see the changes here:
> 
> 
> 
> > https://github.com/piyushrpt/gdal/commit/b199cbae9ea15e31c787c1480c342bb84
> > de
> 
> 
> > bf774
> 
> 
> 
> > I also tried playing with the upsampling factor (1.3 to 4.0) and the
> 
> 
> 
> > discrepancy numbers were consistent after 1.5. Probably, the minimum
> > needs
> 
> 
> 
> > to be sqrt(2) for square pixels.
> 
> 
> Using the weighting fixed the truncation
> 
> 
> > / rounding error and the results seem consistent when I move the output
> 
> 
> 
> > extent around.
> 
> 
> 
> > The systematic 0.5 pixel shift suggests that there is still an issue. Is
> > my
> 
> 
> > interpretation that the GeoLocTransformer is supposed to operate on pixel
> 
> 
> 
> > center coordinates correct?
> 
> 
> i.e – if my geoloc arrays were regular grid
> 
> 
> > and I feed in the coordinates to the transformer, they return pixel
> > centers
> 
> 
> > – 0.5,0.5 etc. I’m going to try implementing some round trip checks to
> > see
> 
> 
> 
> > if that shows something?
> 
> 
> 
> 
> Yes I agree there must be a 0.5 pixel shift issue when looking at the
> forward path in GDALGeoLocTransform(), ie the one taken by if( !bDstToSrc
> )
 
> 
> 
> So we have currently
> 
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170929/36ad1acf/attachment-0001.html>

From even.rouault at spatialys.com  Fri Sep 29 03:59:04 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 29 Sep 2017 12:59:04 +0200
Subject: [gdal-dev] KML recognized as GML by ogr2ogr
In-Reply-To: <1506670467594.48087@maanmittauslaitos.fi>
References: <1506670467594.48087@maanmittauslaitos.fi>
Message-ID: <4545802.HdoLaoMNGh@even-i700>

On vendredi 29 septembre 2017 07:34:27 CEST Rahkonen Jukka (MML) wrote:
> Hi,
> 
> See
> https://gis.stackexchange.com/questions/256861/kml-to-shapefile-problems-og
> r2ogr
> 
> I have verified with todays GDAL 2.3.0dev  from gisinternals that ogrinfos
> open the KML file form that question with LIBKML driver while ogr2ogr opens
> it with GML driver and fails.

Fixed per https://trac.osgeo.org/gdal/ticket/7061

The reason of the difference of behaviour is that if you do "ogrinfo a.kml", ogrinfo tries to 
open in read-update mode, and only the LIBKML supports it, so the GML driver (which is 
registered, and thus tried, before the LIBML) will be skipped

When you do "ogr2ogr out in.kml", the input file is opened in read-only mode, so the GML 
driver tried to open it and seeing a
xmlns:gml="http://www.opengis.net/gml" (useless in that context) declaration thought that 
it should open it.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170929/a3bbef87/attachment.html>

From even.rouault at spatialys.com  Fri Sep 29 04:04:06 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 29 Sep 2017 13:04:06 +0200
Subject: [gdal-dev] Compiling GDAL 2.2.2 with Informix (IDB) driver on
	Ubuntu 16.04
In-Reply-To: <1506674995.2285568.1122228192.091C518F@webmail.messagingengine.com>
References: <1506674995.2285568.1122228192.091C518F@webmail.messagingengine.com>
Message-ID: <2060043.XJInH6tJIv@even-i700>

Roel,

> /opt/informix/lib/c++/libifc++.so: undefined reference to `mi_cleanup'
> (et cetera, the list of undefined references to informix libs goes on)
> 
> Running ldd also reveals:
> $ ldd .libs/libgdal*.so
> (...)
> libifc++.so => not found
> (...)

(blind guessing)

Is /opt/informix/lib/c++ in the search path for shared librariies ? That is: did you define 
LD_LIBRARY_PATH to point to it ? Or put it in /etc/ld.so.conf and ran ldconfig afterwards ?

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170929/9f6979f8/attachment.html>

From even.rouault at spatialys.com  Fri Sep 29 04:07:14 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 29 Sep 2017 13:07:14 +0200
Subject: [gdal-dev] ogr2ogr and nlt question
In-Reply-To: <922f235833c3dbfd87d4ea4974422d93@carto.net>
References: <922f235833c3dbfd87d4ea4974422d93@carto.net>
Message-ID: <7827878.z7u1mk4Zsq@even-i700>

Hi Andreas,
 
> when using ogr2ogr I can fix the geometry type for cases where I use SQL
> statements.
> 
> Can I use nlt multiple times?

No, only one will be taken into account (likely the last one, but I'd say this is unspecified 
behaviour)

> In my case I would like to specify -nlt
> CONVERT_TO_LINEAR to convert from CompounCurve to Polygon and then use
> -nlt POLYGON to tell it you are really a POLYGON. Is this possible to
> use the -nlt parameter twice?

You just need to use -nlt POLYGON. This will both force each feature geometry to Polygon 
(doing linear approximation if needed) and declare the layer type as Polygon

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170929/60e1c1c1/attachment.html>

From even.rouault at spatialys.com  Fri Sep 29 04:44:24 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 29 Sep 2017 13:44:24 +0200
Subject: [gdal-dev] KML recognized as GML by ogr2ogr
In-Reply-To: <4545802.HdoLaoMNGh@even-i700>
References: <1506670467594.48087@maanmittauslaitos.fi>
 <4545802.HdoLaoMNGh@even-i700>
Message-ID: <2283520.7TORJxRYFU@even-i700>

On vendredi 29 septembre 2017 12:59:04 CEST Even Rouault wrote:
> On vendredi 29 septembre 2017 07:34:27 CEST Rahkonen Jukka (MML) wrote:
> > Hi,
> > 
> > See
> > https://gis.stackexchange.com/questions/256861/kml-to-shapefile-problems-o
> > g
> > r2ogr
> > 
> > I have verified with todays GDAL 2.3.0dev  from gisinternals that ogrinfos
> > open the KML file form that question with LIBKML driver while ogr2ogr
> > opens
> > it with GML driver and fails.
> 
> Fixed per https://trac.osgeo.org/gdal/ticket/7061
> 
> The reason of the difference of behaviour is that if you do "ogrinfo a.kml",
> ogrinfo tries to open in read-update mode, and only the LIBKML supports it,
> so the GML driver (which is registered, and thus tried, before the LIBML)
> will be skipped
> 
> When you do "ogr2ogr out in.kml", the input file is opened in read-only
> mode, so the GML driver tried to open it and seeing a
> xmlns:gml="http://www.opengis.net/gml" (useless in that context) declaration
> thought that it should open it.

By the way, I've just changed this odd behaviour of ogrinfo in trunk. It really does not make 
sense to try opening in update mode in most cases, unless -sql is used. So by default, now, 
unless -sql without -ro is used, ogrinfo will open in read-only mode.


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170929/2d7a9195/attachment.html>

From gregory.bataille at gmail.com  Fri Sep 29 08:50:11 2017
From: gregory.bataille at gmail.com (=?UTF-8?Q?Gr=C3=A9gory_Bataille?=)
Date: Fri, 29 Sep 2017 17:50:11 +0200
Subject: [gdal-dev] Gdal2tiles gains parallel processing features
Message-ID: <CACVcCzr=x6OqyTU8aLgXowUS-JrN9yoryNR_F0X5wxcw8SzsQQ@mail.gmail.com>

Hi all,

I just wanted to announce that after a few months of work (took long, I got
lazy), *gdal2tiles has gained parallel computing abilities*

It is now *on trunk*.

*A few things to know:*
- I took upon me to rewrite the script almost entirely to make it more
modular, testable, ...
- Because the rewrite + the pararellization are a big and risky work (since
there were no tests really), there is a new gdal2tiles_old.py script on
trunk to provide an easy "back-out" for people who would get into trouble
in their production
- The script continues to work in a single thread/process mode by default
- Actually, if you chose the default (or explicitely ask for 1 single
process), the script will not use any python multiprocessing library (which
have been known to be flaky). That should ensure that default behavior is
not disturbed.
- To activate parallel processing, you need to pass a new flag
*--processes=n*

*Risks:*
- It is a major rewrite but algorithms have been barely touched, only the
code organization/modularity.
- The new version is running on my company's production. It's mostly one
use case but we are tiling ~1000 geotiff (in any SRS), in RGB or grayscale,
to a mercator output. It uses python 2.7 (this is actually a mistake and
should move to python 3.5 next week). That use case at least works well.


I'm open to remarks if you have any.

Cheers

---
Gregory Bataille
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170929/930e64b6/attachment-0001.html>

From even.rouault at spatialys.com  Fri Sep 29 08:59:10 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 29 Sep 2017 17:59:10 +0200
Subject: [gdal-dev] Gdal2tiles gains parallel processing features
In-Reply-To: <CACVcCzr=x6OqyTU8aLgXowUS-JrN9yoryNR_F0X5wxcw8SzsQQ@mail.gmail.com>
References: <CACVcCzr=x6OqyTU8aLgXowUS-JrN9yoryNR_F0X5wxcw8SzsQQ@mail.gmail.com>
Message-ID: <2186029.DN7eiUIfWE@even-i700>

On vendredi 29 septembre 2017 17:50:11 CEST Grégory Bataille wrote:
> Hi all,
> 
> I just wanted to announce that after a few months of work (took long, I got
> lazy), *gdal2tiles has gained parallel computing abilities*
> 
> It is now *on trunk*.

Thanks for your great work on this

> - Because the rewrite + the pararellization are a big and risky work (since
> there were no tests really), there is a new gdal2tiles_old.py script on
> trunk to provide an easy "back-out" for people who would get into trouble
> in their production

Note: I actually removed gdal2tiles_old.py when merging your work back into SVN (should 
have told you before). It was the same as the version you can find in the 2.2 branch, so one 
could still grab it from there if really needed.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170929/4b170ed5/attachment.html>

From gregory.bataille at gmail.com  Fri Sep 29 09:05:26 2017
From: gregory.bataille at gmail.com (=?UTF-8?Q?Gr=C3=A9gory_Bataille?=)
Date: Fri, 29 Sep 2017 18:05:26 +0200
Subject: [gdal-dev] Gdal2tiles gains parallel processing features
In-Reply-To: <2186029.DN7eiUIfWE@even-i700>
References: <CACVcCzr=x6OqyTU8aLgXowUS-JrN9yoryNR_F0X5wxcw8SzsQQ@mail.gmail.com>
 <2186029.DN7eiUIfWE@even-i700>
Message-ID: <CACVcCzrVEj_bh10QyuXayFnab+iH73rfpoEc582RtA=N+7g2Ow@mail.gmail.com>

oh... ok for gdal2tiles_old.py.
I just wished to make a potential rollback "easy"

Anyway, that's good enough for me :)

Thanks


---
Gregory Bataille

On Fri, Sep 29, 2017 at 5:59 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> On vendredi 29 septembre 2017 17:50:11 CEST Grégory Bataille wrote:
>
> > Hi all,
>
> >
>
> > I just wanted to announce that after a few months of work (took long, I
> got
>
> > lazy), *gdal2tiles has gained parallel computing abilities*
>
> >
>
> > It is now *on trunk*.
>
>
>
> Thanks for your great work on this
>
>
>
> > - Because the rewrite + the pararellization are a big and risky work
> (since
>
> > there were no tests really), there is a new gdal2tiles_old.py script on
>
> > trunk to provide an easy "back-out" for people who would get into trouble
>
> > in their production
>
>
>
> Note: I actually removed gdal2tiles_old.py when merging your work back
> into SVN (should have told you before). It was the same as the version you
> can find in the 2.2 branch, so one could still grab it from there if really
> needed.
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170929/bbfa9218/attachment.html>

From gcpp.kalxas at gmail.com  Fri Sep 29 09:12:13 2017
From: gcpp.kalxas at gmail.com (Angelos Tzotsos)
Date: Fri, 29 Sep 2017 19:12:13 +0300
Subject: [gdal-dev] Gdal2tiles gains parallel processing features
In-Reply-To: <2186029.DN7eiUIfWE@even-i700>
References: <CACVcCzr=x6OqyTU8aLgXowUS-JrN9yoryNR_F0X5wxcw8SzsQQ@mail.gmail.com>
 <2186029.DN7eiUIfWE@even-i700>
Message-ID: <ee4f41c1-473a-8879-8d55-0a2be7e1a7ee@gmail.com>

Thank you for this feature!

Best,
Angelos

On 09/29/2017 06:59 PM, Even Rouault wrote:
> On vendredi 29 septembre 2017 17:50:11 CEST Grégory Bataille wrote:
>> Hi all,
>>
>> I just wanted to announce that after a few months of work (took long, I got
>> lazy), *gdal2tiles has gained parallel computing abilities*
>>
>> It is now *on trunk*.
> Thanks for your great work on this
>
>> - Because the rewrite + the pararellization are a big and risky work (since
>> there were no tests really), there is a new gdal2tiles_old.py script on
>> trunk to provide an easy "back-out" for people who would get into trouble
>> in their production
> Note: I actually removed gdal2tiles_old.py when merging your work back into SVN (should
> have told you before). It was the same as the version you can find in the 2.2 branch, so one
> could still grab it from there if really needed.
>
> Even
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Angelos Tzotsos, PhD
Charter Member
Open Source Geospatial Foundation
http://users.ntua.gr/tzotsos

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170929/439dbba3/attachment.html>

From sean at mapbox.com  Fri Sep 29 11:03:10 2017
From: sean at mapbox.com (Sean Gillies)
Date: Fri, 29 Sep 2017 12:03:10 -0600
Subject: [gdal-dev] Warped VRT and overviews
Message-ID: <CADPhZXxFYtYhQnWqPHxuNP7aGQ-0LhwD==oKQUCwSQ4grCAgZQ@mail.gmail.com>

Hi all,

It's been my understanding that GDAL's RasterIO (most current version) uses
overviews when available, implicitly. Is this also true for VRTs and warped
VRTs or is not true?

I ask because 1) in reading from a warped VRT (using vsicurl) I'm not
seeing use of the overviews in the GeoTIFF source that surface in the VRT,
and 2) in reading the source of gdalwarp_lib.cpp I see that it has its own
code for navigating overview levels and does not rely on any implicit
overviews.

Thanks in advance,

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170929/a7a51ef2/attachment.html>

From palmerjnz at gmail.com  Fri Sep 29 12:24:55 2017
From: palmerjnz at gmail.com (Jeremy Palmer)
Date: Sat, 30 Sep 2017 08:24:55 +1300
Subject: [gdal-dev] Gdal2tiles gains parallel processing features
In-Reply-To: <CACVcCzr=x6OqyTU8aLgXowUS-JrN9yoryNR_F0X5wxcw8SzsQQ@mail.gmail.com>
References: <CACVcCzr=x6OqyTU8aLgXowUS-JrN9yoryNR_F0X5wxcw8SzsQQ@mail.gmail.com>
Message-ID: <CAA5WJYk53OU+BvfRLb_b5yEAKqkqr9-pG82-ZevoPc9wbbCvVw@mail.gmail.com>

Thank you for these great improvements Grégory.

I'm wondering does gdal2tiles now support output to GeoPackage to save
storage of tiles on disk? Also how hard would it be to support tile grids
profiles with custom origins and resolutions in the new architecture?

Cheers
Jeremy

On Sat, Sep 30, 2017 at 4:50 AM, Grégory Bataille <
gregory.bataille at gmail.com> wrote:

> Hi all,
>
> I just wanted to announce that after a few months of work (took long, I
> got lazy), *gdal2tiles has gained parallel computing abilities*
>
> It is now *on trunk*.
>
> *A few things to know:*
> - I took upon me to rewrite the script almost entirely to make it more
> modular, testable, ...
> - Because the rewrite + the pararellization are a big and risky work
> (since there were no tests really), there is a new gdal2tiles_old.py script
> on trunk to provide an easy "back-out" for people who would get into
> trouble in their production
> - The script continues to work in a single thread/process mode by default
> - Actually, if you chose the default (or explicitely ask for 1 single
> process), the script will not use any python multiprocessing library (which
> have been known to be flaky). That should ensure that default behavior is
> not disturbed.
> - To activate parallel processing, you need to pass a new flag
> *--processes=n*
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170930/72cdfef7/attachment.html>

From even.rouault at spatialys.com  Fri Sep 29 13:38:59 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 29 Sep 2017 22:38:59 +0200
Subject: [gdal-dev] Warped VRT and overviews
In-Reply-To: <CADPhZXxFYtYhQnWqPHxuNP7aGQ-0LhwD==oKQUCwSQ4grCAgZQ@mail.gmail.com>
References: <CADPhZXxFYtYhQnWqPHxuNP7aGQ-0LhwD==oKQUCwSQ4grCAgZQ@mail.gmail.com>
Message-ID: <3407112.6iAQ5aS4Od@even-i700>

Hi Sean,

> 
> It's been my understanding that GDAL's RasterIO (most current version) uses
> overviews when available, implicitly. Is this also true for VRTs and warped
> VRTs or is not true?

Yes, it is supposed to, and below demonstrates a working case of that capability:

(byte.tif is
https://github.com/OSGeo/gdal/blob/trunk/autotest/gcore/data/byte.tif)

gdal_translate byte.tif test.tif -outsize 2048 2048

Create uniformly grey overview:
gdal_translate test.tif test.tif.ovr -outsize 256 256 -scale 0 255 127 127

gdalwarp test.tif test_warped.vrt -of VRT -t_srs EPSG:3857 -overwrite

gdal_translate test_warped.vrt small.tif -outsize 256 256 --debug on

small.tif is grey as expected

> 
> I ask because 1) in reading from a warped VRT (using vsicurl) I'm not
> seeing use of the overviews in the GeoTIFF source that surface in the VRT,
> and 

Perhaps you're doing something different from the above ?


> 2) in reading the source of gdalwarp_lib.cpp I see that it has its own
> code for navigating overview levels and does not rely on any implicit
> overviews.

Yes gdalwarp itself can be told which overview level to use from the source raster, but the 
VRT warped code also has logic to use overviews of the source raster :

https://github.com/OSGeo/gdal/blob/trunk/gdal/frmts/vrt/vrtwarped.cpp#L550

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170929/3fe5f3a3/attachment.html>

From ap.joseph at live.com  Fri Sep 29 14:16:14 2017
From: ap.joseph at live.com (Andrew Joseph)
Date: Fri, 29 Sep 2017 14:16:14 -0700 (MST)
Subject: [gdal-dev] Access raw data stored in a /vsimem file
Message-ID: <1506719774087-0.post@n6.nabble.com>

I'm looking to access the raw data written to VSI mem using the java
bindings. 

There is a function: gdal.FileFromMemBuffer(String fileName,byte[]
byteArray) which writes data TO /vsimem, but I'm not seeing an obvious way
to get the byte[] from a given /vsimem file. I can't simply use
gdal.OpenEx() as I'm trying to retrieve the SQL written in PGDUMP format,
which is not accessible from the Dataset object for obvious reasons. I could
always just write to disk, but seeing as the data will only be a few
thousand lines in the most extreme of circumstances, I figure its more
efficient and less error prone to use /vsimem where possible.



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From asmitawankhede at gmail.com  Fri Sep 29 20:13:02 2017
From: asmitawankhede at gmail.com (Asmita Amol Wankhede)
Date: Fri, 29 Sep 2017 20:13:02 -0700
Subject: [gdal-dev] OpenEx not found - gdal_edit.py
In-Reply-To: <CAJYydMVXY5qxs3Ai-afCb0rpMBoBpaN6vwcgKOR_is0y5ZbfsA@mail.gmail.com>
References: <CAJYydMVXY5qxs3Ai-afCb0rpMBoBpaN6vwcgKOR_is0y5ZbfsA@mail.gmail.com>
Message-ID: <CAJYydMUk8DpuhkSu+Eu=xE5DAWymT0p5S=H_Zm0Ljx_UiPNUVw@mail.gmail.com>

Thanks. that worked.

On Sep 8, 2017 2:13 AM, "Asmita Amol Wankhede" <asmitawankhede at gmail.com>
wrote:

> Enviroment /OS -
>
> Ubuntu 16.04  - gdal 2.1.2 already installed with Python2.7 used to build
> GDAL.
>
> VERSIONS -
>
> gdal 2.1.2 when installed bundled with the code :
> '--with-python=%s '
> where s% is gdal_env['python_bin'],
>
> ISSUE-
> Trying to execute gdal_edit.py (or gdal2tiles.py, gdal_retile.py etc.) ,
> fails to find osgeo module. ImportError: No module named osgeo
>
> Fix1:  sudo apt-get install python-gdal
> This fixed the issue of osgeo, but specifically, when I am trying to run
> gdal_edit.py ,it does not find some of the methods from 2.1.2
>
> RUN gdal_edit.py
>
> /opt/google/bin/gdal_edit.py -a_srs EPSG:3857 RGB-corrected.tif
> Traceback (most recent call last):
>   File "/opt/google/bin/gdal_edit.py", line 274, in <module>
>     sys.exit(gdal_edit(sys.argv))
>   File "/opt/google/bin/gdal_edit.py", line 191, in gdal_edit
>     ds = gdal.OpenEx(datasetname, gdal.OF_RASTER | gdal.OF_UPDATE,
> open_options = open_options)
> AttributeError: 'module' object has no attribute 'OpenEx'
>
> OpenEx is part of 2.1.2 as I remember , please confirm how to check if I
> installed correct version of python-gdal
>
> --
> Thanks,
> Asmita
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170929/be6a831f/attachment.html>

From gregory.bataille at gmail.com  Sat Sep 30 01:48:48 2017
From: gregory.bataille at gmail.com (=?UTF-8?Q?Gr=C3=A9gory_Bataille?=)
Date: Sat, 30 Sep 2017 10:48:48 +0200
Subject: [gdal-dev] Gdal2tiles gains parallel processing features
In-Reply-To: <CAA5WJYk53OU+BvfRLb_b5yEAKqkqr9-pG82-ZevoPc9wbbCvVw@mail.gmail.com>
References: <CACVcCzr=x6OqyTU8aLgXowUS-JrN9yoryNR_F0X5wxcw8SzsQQ@mail.gmail.com>
 <CAA5WJYk53OU+BvfRLb_b5yEAKqkqr9-pG82-ZevoPc9wbbCvVw@mail.gmail.com>
Message-ID: <CACVcCzrqmUVEeCWyjZ4u5W+tXkYcv1pW7mGT49PBV=ft4AWeig@mail.gmail.com>

Hey Jeremy,

I would say I don't know anything about GeoPackage or tile grids profile.
What I can say:
- the new version only brings parallelism to the script
- because of the rewrite, I would hope anything to be slightly easier.

Cheers


---
Gregory Bataille

On Fri, Sep 29, 2017 at 9:24 PM, Jeremy Palmer <palmerjnz at gmail.com> wrote:

> Thank you for these great improvements Grégory.
>
> I'm wondering does gdal2tiles now support output to GeoPackage to save
> storage of tiles on disk? Also how hard would it be to support tile grids
> profiles with custom origins and resolutions in the new architecture?
>
> Cheers
> Jeremy
>
> On Sat, Sep 30, 2017 at 4:50 AM, Grégory Bataille <
> gregory.bataille at gmail.com> wrote:
>
>> Hi all,
>>
>> I just wanted to announce that after a few months of work (took long, I
>> got lazy), *gdal2tiles has gained parallel computing abilities*
>>
>> It is now *on trunk*.
>>
>> *A few things to know:*
>> - I took upon me to rewrite the script almost entirely to make it more
>> modular, testable, ...
>> - Because the rewrite + the pararellization are a big and risky work
>> (since there were no tests really), there is a new gdal2tiles_old.py script
>> on trunk to provide an easy "back-out" for people who would get into
>> trouble in their production
>> - The script continues to work in a single thread/process mode by default
>> - Actually, if you chose the default (or explicitely ask for 1 single
>> process), the script will not use any python multiprocessing library (which
>> have been known to be flaky). That should ensure that default behavior is
>> not disturbed.
>> - To activate parallel processing, you need to pass a new flag
>> *--processes=n*
>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170930/f65889b0/attachment-0001.html>

From even.rouault at spatialys.com  Sat Sep 30 03:36:50 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 30 Sep 2017 12:36:50 +0200
Subject: [gdal-dev] Gdal2tiles gains parallel processing features
In-Reply-To: <CACVcCzrqmUVEeCWyjZ4u5W+tXkYcv1pW7mGT49PBV=ft4AWeig@mail.gmail.com>
References: <CACVcCzr=x6OqyTU8aLgXowUS-JrN9yoryNR_F0X5wxcw8SzsQQ@mail.gmail.com>
 <CAA5WJYk53OU+BvfRLb_b5yEAKqkqr9-pG82-ZevoPc9wbbCvVw@mail.gmail.com>
 <CACVcCzrqmUVEeCWyjZ4u5W+tXkYcv1pW7mGT49PBV=ft4AWeig@mail.gmail.com>
Message-ID: <2557876.fZq9Y473JV@even-i700>

Jeremy,

From a quick look, both should be achievable:

- GeoPackage output: I guess you ask because of multiprocessing ? Otherwise a plain 
gdal_translate will do ;-) Multiprocessing brings the interesting question of write 
concurrency with sqlite3. So I think "manual" writing with sqlite3 low level API would be 
needed to add tiles (the GPKG driver could be used to create the structure of the DB). Much 
likely the resampling/reprojection/creation of PNG/JPEG blob overhead is much larger than 
writing to the DB, so locking shouldn't hopefully be too much of a bottleneck

- custom tiling schemes. should be doable too. If you need a tiling scheme with a 
discontinuity at the antimeridian ;-), that'd probably a bit more difficult (but that's an issue 
that must already exists with the existing GlobalMercator or GlobalGeodetic profiles)


Grégory,

GeoPackage is a SQLite3 based container for vector and raster layers. For rasters, it is tiles 
organized in a pyramid structure, with tiles in PNG or JPEG. So basically it is ""just"" a matter 
of writing gdal2tiles output files as records in a database.
See http://www.geopackage.org/spec/ and
http://gdal.org/drv_geopackage_raster.html


Even

> Hey Jeremy,
> 
> I would say I don't know anything about GeoPackage or tile grids profile.
> What I can say:
> - the new version only brings parallelism to the script
> - because of the rewrite, I would hope anything to be slightly easier.
> 
> Cheers
> 
> 
> ---
> Gregory Bataille
> 
> On Fri, Sep 29, 2017 at 9:24 PM, Jeremy Palmer <palmerjnz at gmail.com> wrote:
> > Thank you for these great improvements Grégory.
> > 
> > I'm wondering does gdal2tiles now support output to GeoPackage to save
> > storage of tiles on disk? Also how hard would it be to support tile grids
> > profiles with custom origins and resolutions in the new architecture?
> > 
> > Cheers
> > Jeremy
> > 
> > On Sat, Sep 30, 2017 at 4:50 AM, Grégory Bataille <
> > 
> > gregory.bataille at gmail.com> wrote:
> >> Hi all,
> >> 
> >> I just wanted to announce that after a few months of work (took long, I
> >> got lazy), *gdal2tiles has gained parallel computing abilities*
> >> 
> >> It is now *on trunk*.
> >> 
> >> *A few things to know:*
> >> - I took upon me to rewrite the script almost entirely to make it more
> >> modular, testable, ...
> >> - Because the rewrite + the pararellization are a big and risky work
> >> (since there were no tests really), there is a new gdal2tiles_old.py
> >> script
> >> on trunk to provide an easy "back-out" for people who would get into
> >> trouble in their production
> >> - The script continues to work in a single thread/process mode by default
> >> - Actually, if you chose the default (or explicitely ask for 1 single
> >> process), the script will not use any python multiprocessing library
> >> (which
> >> have been known to be flaky). That should ensure that default behavior is
> >> not disturbed.
> >> - To activate parallel processing, you need to pass a new flag
> >> *--processes=n*


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170930/5d2628d1/attachment.html>

From sean at mapbox.com  Sat Sep 30 10:21:12 2017
From: sean at mapbox.com (Sean Gillies)
Date: Sat, 30 Sep 2017 11:21:12 -0600
Subject: [gdal-dev] Warped VRT and overviews
In-Reply-To: <3407112.6iAQ5aS4Od@even-i700>
References: <CADPhZXxFYtYhQnWqPHxuNP7aGQ-0LhwD==oKQUCwSQ4grCAgZQ@mail.gmail.com>
 <3407112.6iAQ5aS4Od@even-i700>
Message-ID: <CADPhZXwCkpoLycyedxAo_PvGVK__-XkLGQE2ix4q55FPQCMTog@mail.gmail.com>

Hi Even,

On Fri, Sep 29, 2017 at 2:38 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi Sean,
>
>
>
> >
>
> > It's been my understanding that GDAL's RasterIO (most current version)
> uses
>
> > overviews when available, implicitly. Is this also true for VRTs and
> warped
>
> > VRTs or is not true?
>
>
>
> Yes, it is supposed to, and below demonstrates a working case of that
> capability:
>
>
>
> (byte.tif is
>
> https://github.com/OSGeo/gdal/blob/trunk/autotest/gcore/data/byte.tif)
>
>
>
> gdal_translate byte.tif test.tif -outsize 2048 2048
>
>
>
> Create uniformly grey overview:
>
> gdal_translate test.tif test.tif.ovr -outsize 256 256 -scale 0 255 127 127
>
>
>
> gdalwarp test.tif test_warped.vrt -of VRT -t_srs EPSG:3857 -overwrite
>
>
>
> gdal_translate test_warped.vrt small.tif -outsize 256 256 --debug on
>
>
>
> small.tif is grey as expected
>
>
>
> >
>
> > I ask because 1) in reading from a warped VRT (using vsicurl) I'm not
>
> > seeing use of the overviews in the GeoTIFF source that surface in the
> VRT,
>
> > and
>
>
>
> Perhaps you're doing something different from the above ?
>
>
>
>
>
> > 2) in reading the source of gdalwarp_lib.cpp I see that it has its own
>
> > code for navigating overview levels and does not rely on any implicit
>
> > overviews.
>
>
>
> Yes gdalwarp itself can be told which overview level to use from the
> source raster, but the VRT warped code also has logic to use overviews of
> the source raster :
>
>
>
> https://github.com/OSGeo/gdal/blob/trunk/gdal/frmts/vrt/vrtwarped.cpp#L550
>
>
>
> Even
>

Indeed, I had gotten myself into a situation where the test at

https://github.com/OSGeo/gdal/blob/7f622319fee6ff75e6ddab1b622568
4264f34d85/gdal/frmts/vrt/vrtsourcedrasterband.cpp#L169

failed and the overviews were skipped. Thanks for getting me back on the
right track. The VRTWarpedDataset class is very handy. I'm looking forward
to being able to use VSICurlClearCache in production, it'll be handy for
testing my warped VRT code.

Thanks and bon weekend,

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170930/8b36b032/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Sat Sep 30 14:01:57 2017
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Sat, 30 Sep 2017 21:01:57 +0000
Subject: [gdal-dev] Gdal_edit and TIFFTAG_EXTRASAMPLES
Message-ID: <1506805321867.21991@maanmittauslaitos.fi>

Hi,

I have been searching an easy way to change the interpretion of 4-channel images between RGBA and RGB+undefined. Wouldn't if be useful to make gdal_edit to support also changing the TIFFTAG_EXTRASAMPLES metadata? Or do we have some other easy way for performing that task?

-Jukka Rahkonen-

From even.rouault at spatialys.com  Sat Sep 30 14:45:16 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 30 Sep 2017 23:45:16 +0200
Subject: [gdal-dev] Gdal_edit and TIFFTAG_EXTRASAMPLES
In-Reply-To: <1506805321867.21991@maanmittauslaitos.fi>
References: <1506805321867.21991@maanmittauslaitos.fi>
Message-ID: <6625043.vIzl4GcmEa@even-i700>

On samedi 30 septembre 2017 21:01:57 CEST Rahkonen Jukka (MML) wrote:
> Hi,
> 
> I have been searching an easy way to change the interpretion of 4-channel
> images between RGBA and RGB+undefined. Wouldn't if be useful to make
> gdal_edit to support also changing the TIFFTAG_EXTRASAMPLES metadata? Or do
> we have some other easy way for performing that task?

Jukka,

I couldn't find a clean working way.

I had though that calling ds.GetRasterBand(4).SetColorInterpretation(gdal.GCI_AlphaBand or 
gdal.GCI_Undefined) would work (which could have been done by a new option of gdal_edit 
to modify the color interpretation). But for some (not clear, and likely unneeded) reason, this 
is restricted on a fresh new file, not yet "crystalized" (if you do it on an existing file, the 
change will only go to the .aux.xml file). I don't see a strong reason for this restriction, so it 
could probably be removed.


I've also tried the tiffset utility, but for some reason it absolutely wants to set at least 2 
values in the ExtraSamples tag. Sounds like a bug of tiffset/libtiff

So to set alpha:

tiffset -s 338 2 2 0 test.tif

338 = code for ExtraSamples
2 = 2 values
2 = alpha unassociated
0 = undefined (ignored, and somehow invalid since that sample doesn't exist)

(should normally be tiffset -s 338 1 2 test.tif if that worked properly)

or to set undefined

tiffset -s 338 2 0 0 test.tif
(should normally be tiffset -s 338 1 0 test.tif if that worked properly)

GDAL will be happy, but technically the TIFF is not so correct with that 2nd extra sample, 
since for a Photometric=RGB with 4 samples, you should just have 1 extra sample.


I would also have suggested to just take your favorite hexadecimal editor, and just alter the 
proper byte, but I don't feel this will be a popular option ;-)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170930/1228340c/attachment.html>

