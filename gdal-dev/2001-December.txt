From andreane.meunier at p...  Sat Dec  1 17:23:43 2001
From: andreane.meunier at p... (Andreane Meunier)
Date: Wed Nov 21 11:49:15 2007
Subject: AIGrid Format
Message-ID: <1007245423.3c09586f1e37f@w...>

Hi!

I'm trying to read Arc/Info Binary Grid data, but can't understand how to read
the whole data. I used AIGOpen to get the following info:

nBlocks = 738
panBlockOffset = 0x8066b08
panBlockSize = 0x8067698
fpGrid
= 0x8065110
bHasWarned
= 0
pszCoverName
= 0x8064380 "adf"
nCellType
= 1
nBlockXSize
= 256
nBlockYSize
= 4
nBlocksPerRow
= 8
nBlocksPerColumn= 512
dfLLX
= 201899.59490330055
dfLLY
= 5188705.5791464783
dfURX
= 502771.95119151962
dfURY
= 5538777.1886642175
dfCellSizeX
= 946.13948518307882
dfCellSizeY
= 946.13948518307882
nPixels
= 318
nLines
= 369
dfMin
= 1
dfMax
= 1122
dfMean
= 380.25690602518836
dfStdDev
= 190.55087204145454

Since the file is 318X369 pixels and blocks are 256X4 pixels, I presume that
blocks overlap each other to obtain 8 blocks per row and 512 per column, right?
My question is: Is there an other way to read the data than using AIGReadTile?
I want to read the whole 318X369 picture in juste one pass! (I also read that
the data read with fpGrid is not always sorted and that you absolutely have to
use the w00101x.adf file to read the data...)

Thanks!


From s.perkins at l...  Mon Dec 10 18:19:23 2001
From: s.perkins at l... (Simon Perkins)
Date: Wed Nov 21 11:49:15 2007
Subject: Global --use-internal option for configure?
References: <3B325460.419CDB71@p...>
Message-ID: <3C1542FB.CC6ACC4B@l...>


Hi,

We want to distribute a pre-compiled version of the GDAL library along with our
software, since our customers often don't have up to date facilities to compile
code on their Solaris machines. It would be nice to have an option to make GDAL
as self contained as possible, i.e. by using the internal version of libraries
such as libgif, libpng, etc, and disabling calls to weird libraries that they
might not have. It is possible to achieve this effect with a string of flags to
configure, but I wondered whether it would be nice to have a single flag that
produced a reasonably self-contained libgdal, e.g. configure --use-all-internal,
or something? This would also mean that when new formats are added to GDAL you
don't have to adjust the string of flags you pass to configure. Let me know if
you have any objections, comments and if there's no problems I'll go add it in. 

Cheers,

Sy


From warmerdam at p...  Tue Dec 11 09:51:18 2001
From: warmerdam at p... (Frank Warmerdam)
Date: Wed Nov 21 11:49:15 2007
Subject: [gdal-dev] Global --use-internal option for configure?
References: <3B325460.419CDB71@p...> <3C1542FB.CC6ACC4B@l...>
Message-ID: <3C161D66.60708@p...>

Simon Perkins wrote:

> 
> Hi,
> 
> We want to distribute a pre-compiled version of the GDAL library along 
> with our
> software, since our customers often don't have up to date facilities to 
> compile
> code on their Solaris machines. It would be nice to have an option to 
> make GDAL
> as self contained as possible, i.e. by using the internal version of 
> libraries
> such as libgif, libpng, etc, and disabling calls to weird libraries that 
> they
> might not have. It is possible to achieve this effect with a string of 
> flags to
> configure, but I wondered whether it would be nice to have a single flag 
> that
> produced a reasonably self-contained libgdal, e.g. configure 
> --use-all-internal,
> or something? This would also mean that when new formats are added to 
> GDAL you
> don't have to adjust the string of flags you pass to configure. Let me 
> know if
> you have any objections, comments and if there's no problems I'll go add 
> it in.


Sy,

That sounds fine to me. Once you have done it let me know how it works so
I can be sure to maintain it properly in the future.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up | Frank Warmerdam, warmerdam@p...
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush | Geospatial Programmer for Rent




From ldjohn at u...  Wed Dec 12 10:31:44 2001
From: ldjohn at u... (ldjohn@u...)
Date: Wed Nov 21 11:49:15 2007
Subject: Large image support
Message-ID: <Pine.LNX.4.21.0112111238060.9400-100000@l...>

Hello Frank,

Looking through the GDAL mailing list archive, I noticed that on January
3, 2001 you sent a message saying that you have added support for large
images (> 2GB), but that the changes haven't (at that time anyway) been
made to the raw image format. I haven't seen any follow-ups on this
message, and from the testing I've done, it appears that the RawDataset
class doesn't yet support such large images.

The LAS package (which my group supports) is being used more and more to
process large area mosaics and Landsat 7 scenes, so one of our
requirements is the support of large (> 2GB per band, multiple bands per
image) images. As we prepare to switch our image I/O layer to GDAL, I
need to ensure that such large images can be handled.

The LDFDataset (LAS Data Format) class is being built upon the RawDataset
class. Does the RawDataset class remain to be changed to handle large
images? Let me know if I can help with the process.

Thanks.


Lowell
-- 
--------------------------------------------------
Lowell D. Johnson
Software Engineering
Raytheon Systems
EROS Data Center
47914 252nd Street, Mundt Federal Bldg
Sioux Falls, SD 57198
--------------------------------------------------




From warmerdam at p...  Wed Dec 12 10:36:54 2001
From: warmerdam at p... (Frank Warmerdam)
Date: Wed Nov 21 11:49:15 2007
Subject: [gdal-dev] Large image support
References: <Pine.LNX.4.21.0112111238060.9400-100000@l...>
Message-ID: <3C177996.6030206@p...>

ldjohn@u... wrote:

> Hello Frank,
> 
> Looking through the GDAL mailing list archive, I noticed that on January
> 3, 2001 you sent a message saying that you have added support for large
> images (> 2GB), but that the changes haven't (at that time anyway) been
> made to the raw image format. I haven't seen any follow-ups on this
> message, and from the testing I've done, it appears that the RawDataset
> class doesn't yet support such large images.
> 
> The LAS package (which my group supports) is being used more and more to
> process large area mosaics and Landsat 7 scenes, so one of our
> requirements is the support of large (> 2GB per band, multiple bands per
> image) images. As we prepare to switch our image I/O layer to GDAL, I
> need to ensure that such large images can be handled.
> 
> The LDFDataset (LAS Data Format) class is being built upon the RawDataset
> class. Does the RawDataset class remain to be changed to handle large
> images? Let me know if I can help with the process.


Lowell,

The large file IO api is available in GDAL, but an alternate set of
functions is called, and the file handles are not necessary interchangeable
(not on NT for instance).

Because a variety of things build on the RawDataset (or more specifically
the RawRasterBand), and that some of them have their own code to access the
file through the file handle, I think it would be best for me to add an
alternate LargeRawRasterBand which operates on large file style file handles.

I will implement this and incorporate it's use into the default raw file
handler. Then you should be able to just change LDFRasterBand to
derive from LargeRawRasterBand instead of RawRasterBand.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up | Frank Warmerdam, warmerdam@p...
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush | Geospatial Programmer for Rent




From warmerdam at p...  Wed Dec 12 13:50:05 2001
From: warmerdam at p... (Frank Warmerdam)
Date: Wed Nov 21 11:49:15 2007
Subject: Large Raw Files
Message-ID: <3C17A6DD.7060905@p...>

Lowell and Others,

I have altered the RawRasterBand class so it includes an optional
extra bIsVSIL parameter. If FALSE (the default), then the normal
VSI API will be used for file IO, and files may only be up to 2GB. If
TRUE then the large file API (ie. VSIFSeekL(), VSIFReadL() and VSIFWriteL())
will be used instead of the regular one.

I have altered the PAux, and HKV (aka MFF2) formats to utilize this.

To utilize this for LDF please ensure that you use the large file API
to open and access your file, and pass bIsVSIL=TRUE when in the constructor
call to RawRasterDataset. Let me know if you have questions about how to
use the large file API.

I don't have any convenient way to test this, so if you could do some testing
with 5GB LDF and PAux files I would appreciate it.

The large file API changes can be extented to other formats like ESRI labelled
BIL, Envisat, and SAR_CEOS if needed. Anyone who wants this, and is willing
to test it let me know and I will make the changes.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up | Frank Warmerdam, warmerdam@p...
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush | Geospatial Programmer for Rent




From ldjohn at u...  Wed Dec 12 14:18:51 2001
From: ldjohn at u... (ldjohn@u...)
Date: Wed Nov 21 11:49:15 2007
Subject: [gdal-dev] Large Raw Files
In-Reply-To: <3C17A6DD.7060905@p...>
Message-ID: <Pine.LNX.4.21.0112121302210.11263-100000@l...>

On Wed, 12 Dec 2001, Frank Warmerdam wrote:

> Lowell and Others,
> 
> I have altered the RawRasterBand class so it includes an optional
> extra bIsVSIL parameter. If FALSE (the default), then the normal
> VSI API will be used for file IO, and files may only be up to 2GB. If
> TRUE then the large file API (ie. VSIFSeekL(), VSIFReadL() and VSIFWriteL())
> will be used instead of the regular one.
> 
> I have altered the PAux, and HKV (aka MFF2) formats to utilize this.
> 
> To utilize this for LDF please ensure that you use the large file API
> to open and access your file, and pass bIsVSIL=TRUE when in the constructor
> call to RawRasterDataset. Let me know if you have questions about how to
> use the large file API.
> 
> I don't have any convenient way to test this, so if you could do some testing
> with 5GB LDF and PAux files I would appreciate it.
> 
> The large file API changes can be extented to other formats like ESRI labelled
> BIL, Envisat, and SAR_CEOS if needed. Anyone who wants this, and is willing
> to test it let me know and I will make the changes.

Thanks! I'll try to get the LDF drivers modified and tested
shortly. Then I'll get back to you with the results.


Lowell
-- 
--------------------------------------------------
Lowell D. Johnson
Software Engineering
Raytheon Systems
EROS Data Center
47914 252nd Street, Mundt Federal Bldg
Sioux Falls, SD 57198
--------------------------------------------------



From ldjohn at u...  Wed Dec 12 15:29:38 2001
From: ldjohn at u... (ldjohn@u...)
Date: Wed Nov 21 11:49:15 2007
Subject: [gdal-dev] Large Raw Files
In-Reply-To: <3C17A6DD.7060905@p...>
Message-ID: <Pine.LNX.4.21.0112121355250.11288-100000@l...>

On Wed, 12 Dec 2001, Frank Warmerdam wrote:

> Lowell and Others,
> 
> I have altered the RawRasterBand class so it includes an optional
> extra bIsVSIL parameter. If FALSE (the default), then the normal
> VSI API will be used for file IO, and files may only be up to 2GB. If
> TRUE then the large file API (ie. VSIFSeekL(), VSIFReadL() and VSIFWriteL())
> will be used instead of the regular one.
> 
> I have altered the PAux, and HKV (aka MFF2) formats to utilize this.
> 
> To utilize this for LDF please ensure that you use the large file API
> to open and access your file, and pass bIsVSIL=TRUE when in the constructor
> call to RawRasterDataset. Let me know if you have questions about how to
> use the large file API.
> 
> I don't have any convenient way to test this, so if you could do some testing
> with 5GB LDF and PAux files I would appreciate it.
> 
> The large file API changes can be extented to other formats like ESRI labelled
> BIL, Envisat, and SAR_CEOS if needed. Anyone who wants this, and is willing
> to test it let me know and I will make the changes.

I just tested with LDF format and it seems to work fine. Created a
3-band image with:

band 1: 40,000 lines x 60,000 samples, GDT_Byte
band 2: 250 x 250 , GDT_Int16
band 3: 500 x 500 , GDT_Int32

Image file (.img) size: 2,401,125,000

Metadata file (.ldf):

VERSION = 2.0
BANDS = 3
OBJECT = BAND1
DATA_LOCATION = 0
LINES = 40000
SAMPLES_PER_LINE = 60000
DATA_TYPE = UNSIGNED_INTEGER_8
PIXEL_SIZE = (1.000000, 1.000000)
END_OBJECT = BAND1
OBJECT = BAND2
DATA_LOCATION = -1894967296
LINES = 250
SAMPLES_PER_LINE = 250
DATA_TYPE = INTEGER_16
PIXEL_SIZE = (1.000000, 1.000000)
END_OBJECT = BAND2
OBJECT = BAND3
DATA_LOCATION = -1894842296
LINES = 500
SAMPLES_PER_LINE = 500
DATA_TYPE = INTEGER_32
PIXEL_SIZE = (1.000000, 1.000000)
END_OBJECT = BAND3
END

I see that I need to correct the type for the data location counter, but
everything else looks good. (This is a prototype, so the pixel size,
which should be scaled by the resolution difference, is known to be
wrong.)

One thing I've noticed is that the RawRasterBand->nImgOffset member is of
type unsigned int. That will take us up to 4GB, but what after
that? Should this be a long long?

-- 
--------------------------------------------------
Lowell D. Johnson
Software Engineering
Raytheon Systems
EROS Data Center
47914 252nd Street, Mundt Federal Bldg
Sioux Falls, SD 57198
--------------------------------------------------



From warmerdam at p...  Wed Dec 12 17:46:19 2001
From: warmerdam at p... (Frank Warmerdam)
Date: Wed Nov 21 11:49:15 2007
Subject: [gdal-dev] Large Raw Files
References: <Pine.LNX.4.21.0112121355250.11288-100000@l...>
Message-ID: <3C17DE3B.2080204@p...>



ldjohn@u... wrote:

> I just tested with LDF format and it seems to work fine. Created a
> 3-band image with:
> 
> band 1: 40,000 lines x 60,000 samples, GDT_Byte
> band 2: 250 x 250 , GDT_Int16
> band 3: 500 x 500 , GDT_Int32
> 
> Image file (.img) size: 2,401,125,000


Lowell,

Excellent! It would be good to test over 4GB too. What platform was
this testing on?


> One thing I've noticed is that the RawRasterBand->nImgOffset member is of
> type unsigned int. That will take us up to 4GB, but what after
> that? Should this be a long long?


The type of nImgOffset in the constructor calls, and within the class for
RawRasterBand (as found in rawdataset.h:1.7) is vsi_l_offset which should
be a 64bit type on platforms where a 64bit type is available. Note that
the default configuration on Linux does not (as far as I know) support large
file IO. It has been successfully tested on Solaris, NT and IRIX. Some
linux versions can also support large file IO, but I doubt the configure
logic finds it.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up | Frank Warmerdam, warmerdam@p...
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush | Geospatial Programmer for Rent



From ian at g...  Thu Dec 13 11:41:27 2001
From: ian at g... (Ian Turton)
Date: Wed Nov 21 11:49:15 2007
Subject: arc/info binary grids / mapserver
Message-ID: <20011213164127.A28705@g...>

I'm trying to display the globe 30' dem data on a mapserver. I've converted
the bil files to arcinfo binary coverages hopeing that this would be
quicker. However while the bil files display nicely the coverages appear to
be badly broken. I've attached two pngs of the output for people to look
at. Alternatively have a look at the server output directly at

http://www.ccg.leeds.ac.uk/cgi-bin/mapserv?map=/data/feathers_2/mapserver/wms.map&VERSION=1.1.0&request=getmap&style=&SRS=EPSG:4269&format=png&exeptions=inimage&height=300&width=600&bbox=-10,50,5,60&layers=globebin,boundary

and 

http://www.ccg.leeds.ac.uk/cgi-bin/mapserv?map=/data/feathers_2/mapserver/wms.map&VERSION=1.1.0&request=getmap&style=&SRS=EPSG:4269&format=png&exeptions=inimage&height=300&width=600&bbox=-10,50,5,60&layers=globebil,boundary

Does any one else have the same problem or know what I'm doing wrong?

Ian
-- 
Ian Turton, Centre for Computational Geography, School of Geography,
University of Leeds, Leeds, LS2 9JT. 0113 2333392
URL: http://www.geog.leeds.ac.uk/staff/i.turton/


From ian at g...  Thu Dec 13 11:46:24 2001
From: ian at g... (Ian Turton)
Date: Wed Nov 21 11:49:15 2007
Subject: [gdal-dev] arc/info binary grids / mapserver
In-Reply-To: <20011213164127.A28705@g...>; from Ian Turton on Thu, Dec 13, 2001 at 04:41:27PM +0000
References: <20011213164127.A28705@g...>
Message-ID: <20011213164623.A28744@g...>

On Thu, Dec 13, 2001 at 04:41:27PM +0000, Ian Turton wrote:
> I'm trying to display the globe 30' dem data on a mapserver. I've converted
> the bil files to arcinfo binary coverages hopeing that this would be
> quicker. However while the bil files display nicely the coverages appear to
> be badly broken. I've attached two pngs of the output for people to look
> at. Alternatively have a look at the server output directly at

Opps - forgot the includes

-- 
Ian Turton, Centre for Computational Geography, School of Geography,
University of Leeds, Leeds, LS2 9JT. 0113 2333392
URL: http://www.geog.leeds.ac.uk/staff/i.turton/
-------------- next part --------------
A non-text attachment was scrubbed...
Name: bil.png
Type: image/png
Size: 35 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20011213/db32f1b5/bil.png
-------------- next part --------------
A non-text attachment was scrubbed...
Name: cov.png
Type: image/png
Size: 35 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20011213/db32f1b5/cov.png
From warmerdam at p...  Thu Dec 13 11:49:28 2001
From: warmerdam at p... (Frank Warmerdam)
Date: Wed Nov 21 11:49:15 2007
Subject: [gdal-dev] arc/info binary grids / mapserver
References: <20011213164127.A28705@g...>
Message-ID: <3C18DC18.1050808@p...>

Ian Turton wrote:

> I'm trying to display the globe 30' dem data on a mapserver. I've converted
> the bil files to arcinfo binary coverages hopeing that this would be
> quicker. However while the bil files display nicely the coverages appear to
> be badly broken. I've attached two pngs of the output for people to look
> at. Alternatively have a look at the server output directly at
> 
> http://www.ccg.leeds.ac.uk/cgi-bin/mapserv?map=/data/feathers_2/mapserver/wms.map&VERSION=1.1.0&request=getmap&style=&SRS=EPSG:4269&format=png&exeptions=inimage&height=300&width=600&bbox=-10,50,5,60&layers=globebin,boundary 
> <http://www.ccg.leeds.ac.uk/cgi-bin/mapserv?map=/data/feathers_2/mapserver/wms.map&VERSION=1.1.0&request=getmap&style=&SRS=EPSG:4269&format=png&exeptions=inimage&height=300&width=600&bbox=-10,50,5,60&layers=globebin,boundary>
> 
> and
> 
> http://www.ccg.leeds.ac.uk/cgi-bin/mapserv?map=/data/feathers_2/mapserver/wms.map&VERSION=1.1.0&request=getmap&style=&SRS=EPSG:4269&format=png&exeptions=inimage&height=300&width=600&bbox=-10,50,5,60&layers=globebil,boundary 
> <http://www.ccg.leeds.ac.uk/cgi-bin/mapserv?map=/data/feathers_2/mapserver/wms.map&VERSION=1.1.0&request=getmap&style=&SRS=EPSG:4269&format=png&exeptions=inimage&height=300&width=600&bbox=-10,50,5,60&layers=globebil,boundary>
> 
> Does any one else have the same problem or know what I'm doing wrong?


Ian,

What did you use to convert to binary grids? I gather the result is one
big grid? Would it be possible to provide me with a smallish sample
grid that has this problem?

Second, if you want fast access you might want to try converting the BIL
files to tiled tiff, and build overviews. You can build overviews for
BIL to, but it can't be directly tiled.

eg.

gdal_translate source_bil global30.tif -co "TILED=YES"
gdaladdo global30.tif 2 4 8 16 32 64

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up | Frank Warmerdam, warmerdam@p...
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush | Geospatial Programmer for Rent




From ian at g...  Thu Dec 13 12:06:56 2001
From: ian at g... (Ian Turton)
Date: Wed Nov 21 11:49:15 2007
Subject: [gdal-dev] arc/info binary grids / mapserver
In-Reply-To: <3C18DC18.1050808@p...>; from Frank Warmerdam on Thu, Dec 13, 2001 at 11:49:28AM -0500
References: <20011213164127.A28705@g...> <3C18DC18.1050808@p...>
Message-ID: <20011213170655.A28779@g...>

On Thu, Dec 13, 2001 at 11:49:28AM -0500, Frank Warmerdam wrote:
> What did you use to convert to binary grids? I gather the result is one
> big grid? Would it be possible to provide me with a smallish sample
> grid that has this problem?

I used arc/info to do the conversion as described at
http://www.ngdc.noaa.gov/seg/topo/globeget.shtml. There are 16 tiled grids.

> 
> Second, if you want fast access you might want to try converting the BIL
> files to tiled tiff, and build overviews. You can build overviews for
> BIL to, but it can't be directly tiled.

I'll have an experiment with this and let you know.
-- 
Ian Turton, Centre for Computational Geography, School of Geography,
University of Leeds, Leeds, LS2 9JT. 0113 2333392
URL: http://www.geog.leeds.ac.uk/staff/i.turton/


From ldjohn at u...  Fri Dec 14 12:18:11 2001
From: ldjohn at u... (ldjohn@u...)
Date: Wed Nov 21 11:49:15 2007
Subject: [gdal-dev] Large Raw Files
In-Reply-To: <3C17DE3B.2080204@p...>
Message-ID: <Pine.LNX.4.21.0112141050470.16036-100000@l...>

On Wed, 12 Dec 2001, Frank Warmerdam wrote:

> ldjohn@u... wrote:
> 
> > I just tested with LDF format and it seems to work fine. Created a
> > 3-band image with:
> > 
> > band 1: 40,000 lines x 60,000 samples, GDT_Byte
> > band 2: 250 x 250 , GDT_Int16
> > band 3: 500 x 500 , GDT_Int32
> > 
> > Image file (.img) size: 2,401,125,000
> 
> 
> Lowell,
> 
> Excellent! It would be good to test over 4GB too. What platform was
> this testing on?

This testing was on IRIX.

I just finished running a test case similar to the above, except band 1 is
50,000 lines x 100,000 samples (~5GB). I ran this test on Solaris, using
the GCC compiler. I did have to make the following modifications to get
this to work:

o frmts/raw/rawdataset.cpp
184c184
< if( Seek( nImgOffset + iLine * nLineOffset, SEEK_SET ) == -1
---
> if( Seek( nImgOffset + (vsi_l_offset) iLine * nLineOffset,
SEEK_SET ) == -1 
292c292,293
< if( Seek( nImgOffset + nBlockYOff * nLineOffset, SEEK_SET ) == -1 )
---
> if( Seek( nImgOffset + (vsi_l_offset) nBlockYOff * nLineOffset,
> SEEK_SET ) == -1 )

It seems that the IRIX MIPSPro compiler used in the first test on IRIX
may handle the automatic datatype conversion differently than GCC. The
nBlockYOff * nLineOffset result overflowed without the typecast.

o port/cpl_vsil_unix_stdio_64.cpp
76c76
< return( fseek64( fp, nOffset, nWhence ) );
---
> return( fseeko64( fp, nOffset, nWhence ) );
86c86
< return( ftell64( fp ) );
---
> return( ftello64( fp ) );

The long file position offset functions fseek64 and ftell64 do not
exist on our Solaris 2.7 system. That may well be due to outdated
include files. That system is not a primary development system, but
acts as our Sun test platform. The "o" versions of the calls are what
we use in LAS for large file support.

I also had to override the configure test for large file support using
"--with-unix-stdio-64" since the test looks for fseek64 in stdio.h.

So I'm not sure whether this impacts other users or if it something
that we need to deal with locally.

> > One thing I've noticed is that the RawRasterBand->nImgOffset member is of
> > type unsigned int. That will take us up to 4GB, but what after
> > that? Should this be a long long?
> 
> 
> The type of nImgOffset in the constructor calls, and within the class for
> RawRasterBand (as found in rawdataset.h:1.7) is vsi_l_offset which should
> be a 64bit type on platforms where a 64bit type is available. Note that
> the default configuration on Linux does not (as far as I know) support large
> file IO. It has been successfully tested on Solaris, NT and IRIX. Some
> linux versions can also support large file IO, but I doubt the configure
> logic finds it.

Ah, yes. My primary development is being conducted on a Linux 2.2 box, so
it is being set to unsigned int.

Talk to you later.

-- 
--------------------------------------------------
Lowell D. Johnson
Software Engineering
Raytheon Systems
EROS Data Center
47914 252nd Street, Mundt Federal Bldg
Sioux Falls, SD 57198
--------------------------------------------------



From warmerdam at p...  Fri Dec 14 12:31:14 2001
From: warmerdam at p... (Frank Warmerdam)
Date: Wed Nov 21 11:49:15 2007
Subject: [gdal-dev] Large Raw Files
References: <Pine.LNX.4.21.0112141050470.16036-100000@l...>
Message-ID: <3C1A3762.2060701@p...>



ldjohn@u... wrote:

> o frmts/raw/rawdataset.cpp
> 184c184
> < if( Seek( nImgOffset + iLine * nLineOffset, SEEK_SET ) == -1
> ---
> > if( Seek( nImgOffset + (vsi_l_offset) iLine * nLineOffset,
> SEEK_SET ) == -1
> 292c292,293
> < if( Seek( nImgOffset + nBlockYOff * nLineOffset, SEEK_SET ) == -1 )
> ---
> > if( Seek( nImgOffset + (vsi_l_offset) nBlockYOff * nLineOffset,
> > SEEK_SET ) == -1 )
> 
> It seems that the IRIX MIPSPro compiler used in the first test on IRIX
> may handle the automatic datatype conversion differently than GCC. The
> nBlockYOff * nLineOffset result overflowed without the typecast.


Lowell,

Please apply the above change in CVS.


> o port/cpl_vsil_unix_stdio_64.cpp
> 76c76
> < return( fseek64( fp, nOffset, nWhence ) );
> ---
> > return( fseeko64( fp, nOffset, nWhence ) );
> 86c86
> < return( ftell64( fp ) );
> ---
> > return( ftello64( fp ) );
> 
> The long file position offset functions fseek64 and ftell64 do not
> exist on our Solaris 2.7 system. That may well be due to outdated
> include files. That system is not a primary development system, but
> acts as our Sun test platform. The "o" versions of the calls are what
> we use in LAS for large file support.
> 
> I also had to override the configure test for large file support using
> "--with-unix-stdio-64" since the test looks for fseek64 in stdio.h.
> 
> So I'm not sure whether this impacts other users or if it something
> that we need to deal with locally.


I will try to make a few changes in the configure test and in
cpl_vsil_unix_stdio_64.cpp to handle this case. I will let you know when
it is available so you can retest it.

I believe solaris 2.8 has the newer definitions.


Best regards,

---------------------------------------+--------------------------------------
I set the clouds in motion - turn up | Frank Warmerdam, warmerdam@p...
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush | Geospatial Programmer for Rent



From naumov at a...  Fri Dec 14 12:44:39 2001
From: naumov at a... (Aleksey)
Date: Wed Nov 21 11:49:15 2007
Subject: Use of 'errno' in example
Message-ID: <01KBUXD803W0000CGX@B...>

Frank,

I have a small question on the use of 'errno' variable in the documentation 
for the CPLSetErrorHandler() -- it isn't the 'errno' defined in errno.h, is 
it? 
If it isn't, maybe change the name in documentation? It's a small 
inconsistency but would prevent a compiler error as a result of copy & paste 
from there (that's what I did for my error handling function)? Maybe change 
to 'err_no' as in CPLError in cpl_error.h?

Thanks,

Aleksey

>From cpl_error.cpp:

/**********************************************************************
* CPLSetErrorHandler()
**********************************************************************/

/**
* Install custom error handler.
*
* Allow the library's user to specify his own error handler function.
* A valid error handler is a C function with the following prototype:
*
* <pre>
* void MyErrorHandler(CPLErr eErrClass, int errno, const char *msg)
* </pre>


From ldjohn at u...  Fri Dec 14 14:24:17 2001
From: ldjohn at u... (ldjohn@u...)
Date: Wed Nov 21 11:49:15 2007
Subject: [gdal-dev] Large Raw Files
In-Reply-To: <3C1A3762.2060701@p...>
Message-ID: <Pine.LNX.4.21.0112141321220.16180-100000@l...>

On Fri, 14 Dec 2001, Frank Warmerdam wrote:

> ldjohn@u... wrote:
> 
> > o frmts/raw/rawdataset.cpp
> > 184c184
> > < if( Seek( nImgOffset + iLine * nLineOffset, SEEK_SET ) == -1
> > ---
> > > if( Seek( nImgOffset + (vsi_l_offset) iLine * nLineOffset,
> > SEEK_SET ) == -1
> > 292c292,293
> > < if( Seek( nImgOffset + nBlockYOff * nLineOffset, SEEK_SET ) == -1 )
> > ---
> > > if( Seek( nImgOffset + (vsi_l_offset) nBlockYOff * nLineOffset,
> > > SEEK_SET ) == -1 )
> > 
[snip]
> 
> Lowell,
> 
> Please apply the above change in CVS.

Done.

-- 
--------------------------------------------------
Lowell D. Johnson
Software Engineering
Raytheon Systems
EROS Data Center
47914 252nd Street, Mundt Federal Bldg
Sioux Falls, SD 57198
--------------------------------------------------



From warmerdam at p...  Fri Dec 14 14:44:08 2001
From: warmerdam at p... (Frank Warmerdam)
Date: Wed Nov 21 11:49:15 2007
Subject: [gdal-dev] Use of 'errno' in example
References: <01KBUXD803W0000CGX@B...>
Message-ID: <3C1A5688.7040009@p...>

Aleksey wrote:

> Frank,
> 
> I have a small question on the use of 'errno' variable in the documentation
> for the CPLSetErrorHandler() -- it isn't the 'errno' defined in errno.h, is
> it?
> If it isn't, maybe change the name in documentation? It's a small
> inconsistency but would prevent a compiler error as a result of copy & 
> paste
> from there (that's what I did for my error handling function)? Maybe change
> to 'err_no' as in CPLError in cpl_error.h?


Aleksey,

I agree, and have updated the documentation accordingly.

Best regards,

---------------------------------------+--------------------------------------
I set the clouds in motion - turn up | Frank Warmerdam, warmerdam@p...
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush | Geospatial Programmer for Rent




From warmerdam at p...  Fri Dec 14 15:33:34 2001
From: warmerdam at p... (Frank Warmerdam)
Date: Wed Nov 21 11:49:15 2007
Subject: [gdal-dev] arc/info binary grids / mapserver
References: <20011213164127.A28705@g...> <3C18DC18.1050808@p...> <20011213170655.A28779@g...>
Message-ID: <3C1A621E.3020200@p...>


Ian,

I have discovered a problem in the way I was handling the sign of "RMin"
values that were less than 4 bytes long. With this corrected in the code
things work fine. Did you get a pre-built GDAL or build it yourself? If
you built it from cvs just do an update to get the new
gdal/frmts/aigrid/gridlib.c and things should work fine.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up | Frank Warmerdam, warmerdam@p...
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush | Geospatial Programmer for Rent




From s.perkins at l...  Fri Dec 14 20:47:20 2001
From: s.perkins at l... (Simon Perkins)
Date: Wed Nov 21 11:49:15 2007
Subject: Bug in GDALDriver? Not setting poDriver in GDALDataset
References: <3B325460.419CDB71@p...> <3C1542FB.CC6ACC4B@l...>
Message-ID: <3C1AABA8.5DEA6D05@l...>


Just done a CVS checkout and getting this error during make:



make[1]: Entering directory `/nh/toaster/u/simes/src/gdal/apps'
rm -f gdal-config-inst
echo '#!/bin/sh' > gdal-config-inst
echo 'CONFIG_LIBS="-L/usr/local/lib -lgdal.1.1"' >> gdal-config-inst
echo 'CONFIG_PREFIX="/usr/local"' >> gdal-config-inst
echo 'CONFIG_CFLAGS="-I/usr/local/include"' >> gdal-config-inst
echo 'CONFIG_VERSION="'`cat ../VERSION`'"' >> gdal-config-inst
echo 'CONFIG_OGR_ENABLED=yes' >> gdal-config-inst
echo 'CONFIG_FORMATS="gxf gtiff hfa aigrid aaigrid ceos ceos2 iso8211 bsb sdts
raw dted mem jdem envisat elas fit vrt usgsdem gif jpeg png fits "' >>
gdal-config-inst
cat gdal-config.in >> gdal-config-inst
chmod a+x gdal-config-inst
rm -f gdal-config
echo '#!/bin/sh' > gdal-config
echo 'CONFIG_LIBS="-L/n/toaster/u/simes/src/gdal -lgdal.1.1"' >> gdal-config
echo 'CONFIG_PREFIX="/n/toaster/u/simes/src/gdal"' >> gdal-config
echo 'CONFIG_CFLAGS="-I/n/toaster/u/simes/src/gdal/port
-I/n/toaster/u/simes/src/gdal/core -I/n/toaster/u/simes/src/gdal/ogr
-I/n/toaster/u/simes/src/gdal/ogr/ogrsf_frmts"' >> gdal-config
echo 'CONFIG_VERSION="'`cat ../VERSION`'"' >> gdal-config
echo 'CONFIG_OGR_ENABLED=yes' >> gdal-config
echo 'CONFIG_FORMATS="gxf gtiff hfa aigrid aaigrid ceos ceos2 iso8211 bsb sdts
raw dted mem jdem envisat elas fit vrt usgsdem gif jpeg png fits "' >>
gdal-config
cat gdal-config.in >> gdal-config
chmod a+x gdal-config
c++ gdalinfo.o /n/toaster/u/simes/src/gdal/ogr/ogrsf_frmts/ogrsf_frmts.a 
/n/toaster/u/simes/src/gdal/gdal.a /n/toaster/u/simes/src/gdal/ogr/ogr.a
/n/toaster/u/simes/src/gdal/gdal.a /n/toaster/u/simes/src/gdal/port/cpl.a -lgif
-lpng -lcfitsio -lz -lm -ldl -L/usr/local/lib -lm \
-o gdalinfo
/n/toaster/u/simes/src/gdal/gdal.a(mffdataset.o): In function
`MFFDataset::Open(GDALOpenInfo *)':
mffdataset.o(.text+0x1026): undefined reference to
`RawRasterBand::RawRasterBand(GDALDataset *, int, _IO_FILE *, unsigned int, int,
int, GDALDataType, int)'
/n/toaster/u/simes/src/gdal/gdal.a(pnmdataset.o): In function
`PNMDataset::Open(GDALOpenInfo *)':
pnmdataset.o(.text+0x3b2): undefined reference to
`RawRasterBand::RawRasterBand(GDALDataset *, int, _IO_FILE *, unsigned int, int,
int, GDALDataType, int)'
pnmdataset.o(.text+0x40c): undefined reference to
`RawRasterBand::RawRasterBand(GDALDataset *, int, _IO_FILE *, unsigned int, int,
int, GDALDataType, int)'
pnmdataset.o(.text+0x459): undefined reference to
`RawRasterBand::RawRasterBand(GDALDataset *, int, _IO_FILE *, unsigned int, int,
int, GDALDataType, int)'
pnmdataset.o(.text+0x4a8): undefined reference to
`RawRasterBand::RawRasterBand(GDALDataset *, int, _IO_FILE *, unsigned int, int,
int, GDALDataType, int)'
/n/toaster/u/simes/src/gdal/gdal.a(sar_ceosdataset.o)(.text+0x1b58): more
undefined references to `RawRasterBand::RawRasterBand(GDALDataset *, int,
_IO_FILE *, unsigned int, int, int, GDALDataType, int)' follow
collect2: ld returned 1 exit status
make[1]: *** [gdalinfo] Error 1
make[1]: Leaving directory `/nh/toaster/u/simes/src/gdal/apps'
make: *** [apps-target] Error 2


Looks like MFFDataset needs to be updated for the new constructors in
RawRasterBand?

Sy


From s.perkins at l...  Fri Dec 14 21:04:30 2001
From: s.perkins at l... (Simon Perkins)
Date: Wed Nov 21 11:49:15 2007
Subject: [gdal-dev] Bug in GDALDriver? Not setting poDriver in GDALDataset
References: <3B325460.419CDB71@p...> <3C1542FB.CC6ACC4B@l...> <3C1AABA8.5DEA6D05@l...>
Message-ID: <3C1AAFAE.D1A107DF@l...>

Simon Perkins wrote:
> int, GDALDataType, int)'
> pnmdataset.o(.text+0x4a8): undefined reference to
> `RawRasterBand::RawRasterBand(GDALDataset *, int, _IO_FILE *, unsigned int, int,
> int, GDALDataType, int)'
> /n/toaster/u/simes/src/gdal/gdal.a(sar_ceosdataset.o)(.text+0x1b58): more
> undefined references to `RawRasterBand::RawRasterBand(GDALDataset *, int,
> _IO_FILE *, unsigned int, int, int, GDALDataType, int)' follow
> collect2: ld returned 1 exit status
> make[1]: *** [gdalinfo] Error 1
> make[1]: Leaving directory `/nh/toaster/u/simes/src/gdal/apps'
> make: *** [apps-target] Error 2
> 
> Looks like MFFDataset needs to be updated for the new constructors in
> RawRasterBand?
> 
> Sy

Oops - please ignore the header here - I was halfway through composing another
mail complaining that GDALDriver::Create() doesn't set poDriver in the
GDALDataset it creates... But this bug seemed more important!

Sy


From warmerdam at p...  Sat Dec 15 10:41:43 2001
From: warmerdam at p... (Frank Warmerdam)
Date: Wed Nov 21 11:49:15 2007
Subject: [gdal-dev] Bug in GDALDriver? Not setting poDriver in GDALDataset
References: <3B325460.419CDB71@p...> <3C1542FB.CC6ACC4B@l...> <3C1AABA8.5DEA6D05@l...> <3C1AAFAE.D1A107DF@l...>
Message-ID: <3C1B6F37.5020303@p...>

Simon Perkins wrote:

> Simon Perkins wrote:
> > int, GDALDataType, int)'
> > pnmdataset.o(.text+0x4a8): undefined reference to
> > `RawRasterBand::RawRasterBand(GDALDataset *, int, _IO_FILE *, 
> unsigned int, int,
> > int, GDALDataType, int)'
> > /n/toaster/u/simes/src/gdal/gdal.a(sar_ceosdataset.o)(.text+0x1b58): more
> > undefined references to `RawRasterBand::RawRasterBand(GDALDataset *, int,
> > _IO_FILE *, unsigned int, int, int, GDALDataType, int)' follow
> > collect2: ld returned 1 exit status
> > make[1]: *** [gdalinfo] Error 1
> > make[1]: Leaving directory `/nh/toaster/u/simes/src/gdal/apps'
> > make: *** [apps-target] Error 2
> >
> > Looks like MFFDataset needs to be updated for the new constructors in
> > RawRasterBand?
> >
> > Sy
> 
> Oops - please ignore the header here - I was halfway through composing 
> another
> mail complaining that GDALDriver::Create() doesn't set poDriver in the
> GDALDataset it creates... But this bug seemed more important!
> 


Sy,

I have corrected gdaldriver.cpp to set the poDriver on datasets if it wasn't
set previously.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up | Frank Warmerdam, warmerdam@p...
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush | Geospatial Programmer for Rent




From warmerdam at p...  Sat Dec 15 12:13:41 2001
From: warmerdam at p... (Frank Warmerdam)
Date: Wed Nov 21 11:49:15 2007
Subject: [gdal-dev] Large Raw Files
References: <Pine.LNX.4.21.0112141050470.16036-100000@l...> <3C1A3762.2060701@p...>
Message-ID: <3C1B84C5.9080009@p...>


Lowell,

I have added a check for ftello64/fseeko64 in GDAL's configure. Could
you do a "make clean; cvs update -d; ./configure; make" on your Solaris 2.7
system and see if it picks them up properly automatically?

Note, it seems that ftello64 and fseeko64 exist on Linux (at least mine)
in the glibc, but they aren't normally defined in stdio.h (though they
are there protected by a bunch of macros). I would be interested in
knowning what we need to do to get 64 bit file io support on linux. What
kernel, file system, api calls, etc.


Thanks,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up | Frank Warmerdam, warmerdam@p...
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush | Geospatial Programmer for Rent




From ldjohn at u...  Mon Dec 17 11:18:05 2001
From: ldjohn at u... (ldjohn@u...)
Date: Wed Nov 21 11:49:15 2007
Subject: [gdal-dev] Large Raw Files
In-Reply-To: <3C1B84C5.9080009@p...>
Message-ID: <Pine.LNX.4.21.0112170907470.20138-100000@l...>

On Sat, 15 Dec 2001, Frank Warmerdam wrote:

> I have added a check for ftello64/fseeko64 in GDAL's configure. Could
> you do a "make clean; cvs update -d; ./configure; make" on your Solaris 2.7
> system and see if it picks them up properly automatically?

Tested and passed. Thanks.

Upon further inspection, I've noted that Solaris (and Linux) also have
ftello/fseeko calls which are #defined to ftello64/fseeko64 calls
under certain macro definitions. I'm not sure which call format is
preferable. On our Solaris 2.7 machine, the man pages are only given for
the fseeko/ftello pair, not fseeko64/ftello64.

The existing LAS image I/O uses the fseeko/ftello pair combined with a
-D_FILE_OFFSET_BITS=64 GCC compiler flag to handle large files on Solaris.

I've retested by replacing fseeko64/ftello64 with fseeko/ftello in the
configure script, and it works fine as long as I have the
-D_FILE_OFFSET_BITS=64 compiler flag included. Without this flag, it
fails at 2GB.

I don't feel knowledgeable enough about the situation to say which
function pair should be used. Unless you or others have more information,
I'd say we just stick with the "64"s that you have implemented.

> Note, it seems that ftello64 and fseeko64 exist on Linux (at least mine)
> in the glibc, but they aren't normally defined in stdio.h (though they
> are there protected by a bunch of macros). I would be interested in
> knowning what we need to do to get 64 bit file io support on linux. What
> kernel, file system, api calls, etc.

I think that the 64 bit stuff can be used on 2.4+ kernels. Our existing
LAS image I/O layer has been built and tested for large files on the Linux
2.4 kernel, but our work boxes are still running 2.2 (Redhat 7.0), so it's
difficult for me to test at the moment. I do see, as you mention, that
the installed stdio.h includes references to the
fseeko(64)/ftello(64) pairs, wrapped in "#ifdef __USE_LARGEFILE"
preprocessor conditionals and others.


Lowell
-- 
--------------------------------------------------
Lowell D. Johnson
Software Engineering
Raytheon Systems
EROS Data Center
47914 252nd Street, Mundt Federal Bldg
Sioux Falls, SD 57198
--------------------------------------------------



From ben at v...  Wed Dec 26 23:37:27 2001
From: ben at v... (Ben Discoe)
Date: Wed Nov 21 11:49:15 2007
Subject: libproj.so on Linux?
In-Reply-To: <MGEOKJAEOFKANAFBLFGGGEFACNAA.ben@v...>
Message-ID: <MGEOKJAEOFKANAFBLFGGAELODBAA.ben@v...>


This is really a PROJ.4 question, but i figure that the GDAL list is
probably an OK place, since it's an underpinning..

I'm trying to run the VTP software (with it's GDAL/OGR/PROJ.4 dependencies)
on Linux (Redhat 7.2). At runtime, it says "ERROR 6: Unable to load PROJ.4
library (libproj.so)"

I thought i installed PROJ.4 with the command:

rpm -i PROJ.4-4.4.1-1.i586.rpm

which worked, and the "proj" command is installed and does work. Is there
some extra step necessary to make the shared library accessible? I didn't
see anything about it on the PROJ.4 webpage or manpage.

Thanks,
Ben



From warmerdam at p...  Thu Dec 27 02:24:06 2001
From: warmerdam at p... (Frank Warmerdam)
Date: Wed Nov 21 11:49:15 2007
Subject: [gdal-dev] libproj.so on Linux?
References: <MGEOKJAEOFKANAFBLFGGAELODBAA.ben@v...>
Message-ID: <3C2ACC96.3020901@p...>

Ben Discoe wrote:

> 
> This is really a PROJ.4 question, but i figure that the GDAL list is
> probably an OK place, since it's an underpinning..
> 
> I'm trying to run the VTP software (with it's GDAL/OGR/PROJ.4 dependencies)
> on Linux (Redhat 7.2). At runtime, it says "ERROR 6: Unable to load PROJ.4
> library (libproj.so)"
> 
> I thought i installed PROJ.4 with the command:
> 
> rpm -i PROJ.4-4.4.1-1.i586.rpm
> 
> which worked, and the "proj" command is installed and does work. Is there
> some extra step necessary to make the shared library accessible? I didn't
> see anything about it on the PROJ.4 webpage or manpage.


Ben,

I think the problem is that the dynamic libproj.so loading in GDAL looks
for some entry points only found in more recent PROJ.4 releases. I would
suggest installing PROJ.4 version 4.4.4 from source (I don't link up to
date rpms are available).

Best regards,


-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up | Frank Warmerdam, warmerdam@p...
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush | Geospatial Programmer for Rent




From nhv at y...  Thu Dec 27 09:09:14 2001
From: nhv at y... (Norman Vine)
Date: Wed Nov 21 11:49:15 2007
Subject: [gdal-dev] libproj.so on Linux?
In-Reply-To: <MGEOKJAEOFKANAFBLFGGAEMBDBAA.ben@v...>
Message-ID: <002e01c18ee0$1125e840$a300a8c0@nhv>

Ben Discoe writes:
>
>OK, i tried building the latest proj (proj-4.4.4.tar.gz) and 
>doing 'make
>install'. For good measure, i also rebuild/installed GDAL
>(gdal-1.1.5.tar.gz).
>
>I still get the following message when i try to run my program:
>
>"ERROR 6: Unable to load PROJ.4 library (libproj.so), creation of
>OGRCoordinateTransformation failed.
>Segmentation fault"

< Disclaimer I have never booted Linux >

% man ldconfig

Cheers

Norman


From nhv at y...  Thu Dec 27 09:09:14 2001
From: nhv at y... (Norman Vine)
Date: Wed Nov 21 11:49:15 2007
Subject: [gdal-dev] libproj.so on Linux?
In-Reply-To: <MGEOKJAEOFKANAFBLFGGAEMBDBAA.ben@v...>
Message-ID: <002e01c18ee0$1125e840$a300a8c0@nhv>

Ben Discoe writes:
>
>OK, i tried building the latest proj (proj-4.4.4.tar.gz) and 
>doing 'make
>install'. For good measure, i also rebuild/installed GDAL
>(gdal-1.1.5.tar.gz).
>
>I still get the following message when i try to run my program:
>
>"ERROR 6: Unable to load PROJ.4 library (libproj.so), creation of
>OGRCoordinateTransformation failed.
>Segmentation fault"

< Disclaimer I have never booted Linux >

% man ldconfig

Cheers

Norman


From danmo at v...  Thu Dec 27 10:51:41 2001
From: danmo at v... (Daniel Morissette)
Date: Wed Nov 21 11:49:15 2007
Subject: [gdal-dev] libproj.so on Linux?
References: <MGEOKJAEOFKANAFBLFGGAEMBDBAA.ben@v...>
Message-ID: <3C2B438D.F6D51BD1@d...>

Ben Discoe wrote:
> 
> OK, i tried building the latest proj (proj-4.4.4.tar.gz) and doing 'make
> install'. For good measure, i also rebuild/installed GDAL
> (gdal-1.1.5.tar.gz).
> 
> I still get the following message when i try to run my program:
> 
> "ERROR 6: Unable to load PROJ.4 library (libproj.so), creation of
> OGRCoordinateTransformation failed.
> Segmentation fault"
> 

Make sure /usr/local/lib is in your runtime libpath: edit
/etc/ld.so.conf to add /usr/local/lib, and then run "/sbin/ldconfig". 
This will permanently add /usr/local/lib to your system's runtime lib
path. 

-- 
------------------------------------------------------------
Daniel Morissette morissette@d...
DM Solutions Group http://www.dmsolutions.ca/
------------------------------------------------------------
Don't put for tomorrow what you can do today, because if 
you enjoy it today you can do it again tomorrow.


From ben at v...  Thu Dec 27 15:10:04 2001
From: ben at v... (Ben Discoe)
Date: Wed Nov 21 11:49:15 2007
Subject: [gdal-dev] libproj.so on Linux?
In-Reply-To: <3C2B438D.F6D51BD1@d...>
Message-ID: <MGEOKJAEOFKANAFBLFGGKEMEDBAA.ben@v...>


> -----Original Message-----
> From: Daniel Morissette [mailto:danmo@v...]
>
> Make sure /usr/local/lib is in your runtime libpath: edit
> /etc/ld.so.conf to add /usr/local/lib, and then run "/sbin/ldconfig".
> This will permanently add /usr/local/lib to your system's runtime lib
> path.

Sure enough, i ran "/sbin/ldconfig" again as root, and it seems to have
fixed the problem! <scratches head> It's puzzling, since i had already
added /usr/local/lib long ago, and other libraries in that folder were
already working and being found... i guess "ldconfig" does more than just
check the paths in ld.so.conf.

Anyhow, it's very exciting, my apps are running on Linux! Now there's just
a matter of fixing all the bugs that are only happening on Linux..

Thanks,
Ben



From danmo at v...  Thu Dec 27 22:16:43 2001
From: danmo at v... (Daniel Morissette)
Date: Wed Nov 21 11:49:15 2007
Subject: [gdal-dev] libproj.so on Linux?
References: <MGEOKJAEOFKANAFBLFGGKEMEDBAA.ben@v...>
Message-ID: <3C2BE41B.5CEF9340@d...>

Ben Discoe wrote:
> 
> Sure enough, i ran "/sbin/ldconfig" again as root, and it seems to have
> fixed the problem! <scratches head> It's puzzling, since i had already
> added /usr/local/lib long ago, and other libraries in that folder were
> already working and being found... i guess "ldconfig" does more than just
> check the paths in ld.so.conf.
> 

Running ldconfig refreshes the libpath cache... it needs to be run after
new libs are installed and before they can be used.

-- 
------------------------------------------------------------
Daniel Morissette morissette@d...
DM Solutions Group http://www.dmsolutions.ca/
------------------------------------------------------------
Don't put for tomorrow what you can do today, because if 
you enjoy it today you can do it again tomorrow.


