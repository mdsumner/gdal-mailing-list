From Pierre.Lacroix at unige.ch  Mon Jul  1 00:54:52 2013
From: Pierre.Lacroix at unige.ch (Pierre Marcel Anselme Lacroix)
Date: Mon, 1 Jul 2013 07:54:52 +0000
Subject: [gdal-dev] ArcGIS "Update" and "Eliminate" equivalent
Message-ID: <F4B06E5703E26C49901126EF0FA7505AC3CAFB@foxtrot.isis.unige.ch>

Hi,

I would like to know whether GDAL has the equivalents of the ArcGIS "Update" and "Eliminate" tools.

http://resources.arcgis.com/en/help/main/10.1/index.html#//00170000005p000000
http://resources.arcgis.com/en/help/main/10.1/index.html#/Update/00080000000t000000/

I did not find any equivalents. Did I miss something?

Thanks for your reply.

Pietro
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130701/f3a4b788/attachment.html>

From even.rouault at mines-paris.org  Mon Jul  1 04:01:14 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 01 Jul 2013 13:01:14 +0200
Subject: [gdal-dev] ArcGIS "Update" and "Eliminate" equivalent
In-Reply-To: <F4B06E5703E26C49901126EF0FA7505AC3CAFB@foxtrot.isis.unige.ch>
References: <F4B06E5703E26C49901126EF0FA7505AC3CAFB@foxtrot.isis.unige.ch>
Message-ID: <1372676474.51d1617a7732c@imp.free.fr>

Selon Pierre Marcel Anselme Lacroix <Pierre.Lacroix at unige.ch>:

> Hi,
>
> I would like to know whether GDAL has the equivalents of the ArcGIS "Update"
> and "Eliminate" tools.
>
> http://resources.arcgis.com/en/help/main/10.1/index.html#//00170000005p000000
>
http://resources.arcgis.com/en/help/main/10.1/index.html#/Update/00080000000t000000/
>
> I did not find any equivalents. Did I miss something?

Pietro,

In GDAL 1.10, Update is available as OGR_L_Update (
http://www.gdal.org/ogr/ogr__api_8h.html#a87b478c971619145dee7d8d8deeac702 ) .
This can be for example used from the Python script at
http://svn.osgeo.org/gdal/trunk/gdal/swig/python/samples/ogr_layer_algebra.py

Eliminate has no direct equivalent in GDAL, AFAIK. At first sight, the algorithm
could likely be coded with the operations on geometry already available in the
OGRGeometry class (Intersection, Length, Area).

Best regards,

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html




From drmamidi at rothwellgroup.com  Mon Jul  1 12:13:12 2013
From: drmamidi at rothwellgroup.com (Dheeraj Reddy Mamidi)
Date: Mon, 1 Jul 2013 13:13:12 -0600
Subject: [gdal-dev] OGRLayer.Intersection() Question
Message-ID: <CAAU4rM8qr9CG6qN09Oi46=OBK7CvV74xSoBq+xuf4ExAAA6pfg@mail.gmail.com>

Hi All,

I was trying to perform intersection on two feature classes (shape file
format) using OGRLayer.Intersection(),  but have problems making it work
with C# bindings. I am not able to figure out on how to pass the
arguments SWIGTYPE_p_GDALProgressFunc callback
and OSGeo.OGR.SWIGTYPE_p_void callback_data. Can someone please help me
figure out on how to handle these. I keep getting the error "Attempt to
dereference null GDALProgressFunc". I am not sure what that means.

Please share an example on how to call Intersection routine or some other
routine which takes above mentioned argument types.

Thank you,
Dheeraj Reddy Mamidi
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130701/7a70a1d0/attachment.html>

From CABO at NIRAS.DK  Tue Jul  2 02:59:32 2013
From: CABO at NIRAS.DK (=?utf-8?B?Q2FzcGVyIELDuHJnZXNlbiAoQ0FCTyk=?=)
Date: Tue, 2 Jul 2013 09:59:32 +0000
Subject: [gdal-dev] GDAL v.1.10 and Python 3.3.2 - incompatible?
Message-ID: <BCF6B63AE0B25941A7F56567B58A2805351C5DD6@allkexa1.NIRAS.INT>

Hi everyone.

I?m trying to setup GDAL 1.10 and python 3.3.2 using the following binaries:

GDAL: http://www.gisinternals.com/sdk/Download.aspx?file=release-1600-x64-gdal-mapserver\gdal-110-1600-x64-core.msi
Python: http://www.python.org/ftp/python/3.3.2/python-3.3.2.amd64.msi
GDAL for python: GDAL-1.10.0.win-amd64-py3.3.?exe<javascript:;> from http://www.lfd.uci.edu/~gohlke/pythonlibs/

My PATH contains a reference to both the GDAL folder and the Python folder.

When entering python and entering:

>>>from osgeo import gdal

I get the following kinds of information:

The procedure entry point ?GetDefaultRAT at GDALRasterBand@@UEAAPEAVGDALRasterAttributeTable@@XZ could not be located in the dynamic link library gdal110.dll. (This is presented in a Windows pop up).

ERROR 1: Can?t load requested DLL: ??\GDAL\gdalplugins\gdal_BAG.dll. 127: The specified procedure could not be found. (This is presented at the command line).
ERROR 1: Can?t load requested DLL: ??\GDAL\gdalplugins\...
?
ERROR 1: Can?t load requested DLL: ??\GDAL\gdalplugins\gdal_netCDF.dll. 127: The specified procedure could not be found.

The above path points (correctly) to my GDAL installation. I have no other GDAL left overs in my PATH.

I have previously done this for GDAL 1.9.2 and python 3.3.0 and they worked fine together ? was I just too lucky then? Is there something I can do differently to solve my GDAL incompatibilities? I would prefer not to compile my self.

Regards

Casper



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130702/fd6af548/attachment.html>

From Dominik.Schneider at Colorado.EDU  Tue Jul  2 09:52:50 2013
From: Dominik.Schneider at Colorado.EDU (Dominik Schneider)
Date: Tue, 2 Jul 2013 10:52:50 -0600
Subject: [gdal-dev] gdal_merge.py won't load libpng
Message-ID: <CAHYDKLbxQgF3bxMDffK4SJ9kRdx1Wi9mk3FKtvunEKwki5xRDA@mail.gmail.com>

Hi,
I am trying to run:
gdal_merge.py -init -9999 -n 2001 -o
MOD09GA.A2012001.h08v05.005.NRTsnow_fraction.tif.1
MOD09GA.A2012001.h08v05.005.NRTsnow_fraction.tif

The Error:
Traceback (most recent call last):
  File "/Library/Frameworks/GDAL.framework/Programs/gdal_merge.py", line
36, in <module>
    import gdal
  File "/usr/local/lib/python2.7/site-packages/gdal.py", line 2, in <module>
    from osgeo.gdal import deprecation_warn
  File "/usr/local/lib/python2.7/site-packages/osgeo/__init__.py", line 21,
in <module>
    _gdal = swig_import_helper()
  File "/usr/local/lib/python2.7/site-packages/osgeo/__init__.py", line 17,
in swig_import_helper
    _mod = imp.load_module('_gdal', fp, pathname, description)
ImportError: dlopen(/usr/local/lib/python2.7/site-packages/osgeo/_gdal.so,
2): Library not loaded: libpng15.15.dylib
  Referenced from: /usr/local/Cellar/gdal/1.10.0/lib/libgdal.1.dylib
  Reason: image not found

Gdal is here:
> which gdal_merge.py
/Library/Frameworks/GDAL.framework/Programs/gdal_merge.py

I'm completely new gdal but am guessing i've got some confusion between
different versions of gdal and python.  I have rgdal installed so at some
point in the past I probably installed gdal too? Today I installed gdal
with homebrew and also tried the binary from
http://www.kyngchaos.com/software:frameworks
For python I have the system default (2.7) on osx.7.5 and the anaconda
installation.

I should also say, if I load python I am unable to import gdal:
> python
Python 2.7.4 |Anaconda 1.5.1 (x86_64)| (default, May  9 2013, 12:12:00)
[GCC 4.0.1 (Apple Inc. build 5493)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> from osgeo import gdal
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/local/lib/python2.7/site-packages/osgeo/__init__.py", line 21,
in <module>
    _gdal = swig_import_helper()
  File "/usr/local/lib/python2.7/site-packages/osgeo/__init__.py", line 17,
in swig_import_helper
    _mod = imp.load_module('_gdal', fp, pathname, description)
ImportError: dlopen(/usr/local/lib/python2.7/site-packages/osgeo/_gdal.so,
2): Library not loaded: libpng15.15.dylib
  Referenced from: /usr/local/Cellar/gdal/1.10.0/lib/libgdal.1.dylib
  Reason: image not found


any help would be appreciated.
Thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130702/2e6d32c0/attachment.html>

From cgohlke at uci.edu  Tue Jul  2 10:23:59 2013
From: cgohlke at uci.edu (Christoph Gohlke)
Date: Tue, 02 Jul 2013 10:23:59 -0700
Subject: [gdal-dev] GDAL v.1.10 and Python 3.3.2 - incompatible?
In-Reply-To: <BCF6B63AE0B25941A7F56567B58A2805351C5DD6@allkexa1.NIRAS.INT>
References: <BCF6B63AE0B25941A7F56567B58A2805351C5DD6@allkexa1.NIRAS.INT>
Message-ID: <51D30CAF.7030501@uci.edu>

As mentioned on the webpage, the GDAL-1.10.0.win-amd64-py3.3.?exe 
installer includes all required files (Python package, DLLs, tools, and 
data) and should not be used together with OSGeo4W or gdalwin32 (which 
implies also other GDAL builds). Mixing DLLs from different builds in 
PATH can not be expected to work. Does `from osgeo import gdal` work if 
after removing the GDAL folder from PATH?

Christoph


On 7/2/2013 2:59 AM, Casper B?rgesen (CABO) wrote:
> Hi everyone.
>
> I?m trying to setup GDAL 1.10 and python 3.3.2 using the following binaries:
>
> GDAL:
> http://www.gisinternals.com/sdk/Download.aspx?file=release-1600-x64-gdal-mapserver\gdal-110-1600-x64-core.msi
> <http://www.gisinternals.com/sdk/Download.aspx?file=release-1600-x64-gdal-mapserver%5Cgdal-110-1600-x64-core.msi>
>
> Python: http://www.python.org/ftp/python/3.3.2/python-3.3.2.amd64.msi
>
> GDAL for python: GDAL-1.10.0.win-amd64-py3.3.?exefrom
> http://www.lfd.uci.edu/~gohlke/pythonlibs/
> <http://www.lfd.uci.edu/%7Egohlke/pythonlibs/>
>
> My PATH contains a reference to both the GDAL folder and the Python folder.
>
> When entering python and entering:
>
>>>>from osgeo import gdal
>
> I get the following kinds of information:
>
> The procedure entry point
> ?GetDefaultRAT at GDALRasterBand@@UEAAPEAVGDALRasterAttributeTable@@XZ
> could not be located in the dynamic link library gdal110.dll. (This is
> presented in a Windows pop up).
>
> ERROR 1: Can?t load requested DLL: ??\GDAL\gdalplugins\gdal_BAG.dll.
> 127: The specified procedure could not be found. (This is presented at
> the command line).
>
> ERROR 1: Can?t load requested DLL: ??\GDAL\gdalplugins\...
>
> ?
>
> ERROR 1: Can?t load requested DLL: ??\GDAL\gdalplugins\gdal_netCDF.dll.
> 127: The specified procedure could not be found.
>
> The above path points (correctly) to my GDAL installation. I have no
> other GDAL left overs in my PATH.
>
> I have previously done this for GDAL 1.9.2 and python 3.3.0 and they
> worked fine together ? was I just too lucky then? Is there something I
> can do differently to solve my GDAL incompatibilities? I would prefer
> not to compile my self.
>
> Regards
>
> Casper
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>

From CABO at NIRAS.DK  Wed Jul  3 00:35:44 2013
From: CABO at NIRAS.DK (=?utf-8?B?Q2FzcGVyIELDuHJnZXNlbiAoQ0FCTyk=?=)
Date: Wed, 3 Jul 2013 07:35:44 +0000
Subject: [gdal-dev] GDAL v.1.10 and Python 3.3.2 - incompatible?
In-Reply-To: <51D30CAF.7030501@uci.edu>
References: <BCF6B63AE0B25941A7F56567B58A2805351C5DD6@allkexa1.NIRAS.INT>
	<51D30CAF.7030501@uci.edu>
Message-ID: <BCF6B63AE0B25941A7F56567B58A2805351C5F2B@allkexa1.NIRAS.INT>

Hi Christoph

Thank you for your answer. It works fine if I remove the other GDAL from the path, but it makes it very difficult to use Python with GDAL and the GDAL utilities in the same workflow.

Thanks for the clarification about "other GDAL builds".

I guess I was lucky the last time when I combined the two :)


Regards, Casper

-----Original Message-----
From: gdal-dev-bounces at lists.osgeo.org [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Christoph Gohlke
Sent: 2. juli 2013 19:24
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] GDAL v.1.10 and Python 3.3.2 - incompatible?

As mentioned on the webpage, the GDAL-1.10.0.win-amd64-py3.3.?exe installer includes all required files (Python package, DLLs, tools, and
data) and should not be used together with OSGeo4W or gdalwin32 (which implies also other GDAL builds). Mixing DLLs from different builds in PATH can not be expected to work. Does `from osgeo import gdal` work if after removing the GDAL folder from PATH?

Christoph


On 7/2/2013 2:59 AM, Casper B?rgesen (CABO) wrote:
> Hi everyone.
>
> I?m trying to setup GDAL 1.10 and python 3.3.2 using the following binaries:
>
> GDAL:
> http://www.gisinternals.com/sdk/Download.aspx?file=release-1600-x64-gd
> al-mapserver\gdal-110-1600-x64-core.msi
> <http://www.gisinternals.com/sdk/Download.aspx?file=release-1600-x64-g
> dal-mapserver%5Cgdal-110-1600-x64-core.msi>
>
> Python: http://www.python.org/ftp/python/3.3.2/python-3.3.2.amd64.msi
>
> GDAL for python: GDAL-1.10.0.win-amd64-py3.3.?exefrom
> http://www.lfd.uci.edu/~gohlke/pythonlibs/
> <http://www.lfd.uci.edu/%7Egohlke/pythonlibs/>
>
> My PATH contains a reference to both the GDAL folder and the Python folder.
>
> When entering python and entering:
>
>>>>from osgeo import gdal
>
> I get the following kinds of information:
>
> The procedure entry point
> ?GetDefaultRAT at GDALRasterBand@@UEAAPEAVGDALRasterAttributeTable@@XZ
> could not be located in the dynamic link library gdal110.dll. (This is 
> presented in a Windows pop up).
>
> ERROR 1: Can?t load requested DLL: ??\GDAL\gdalplugins\gdal_BAG.dll.
> 127: The specified procedure could not be found. (This is presented at 
> the command line).
>
> ERROR 1: Can?t load requested DLL: ??\GDAL\gdalplugins\...
>
> ?
>
> ERROR 1: Can?t load requested DLL: ??\GDAL\gdalplugins\gdal_netCDF.dll.
> 127: The specified procedure could not be found.
>
> The above path points (correctly) to my GDAL installation. I have no 
> other GDAL left overs in my PATH.
>
> I have previously done this for GDAL 1.9.2 and python 3.3.0 and they 
> worked fine together ? was I just too lucky then? Is there something I 
> can do differently to solve my GDAL incompatibilities? I would prefer 
> not to compile my self.
>
> Regards
>
> Casper
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

From josh-talk at hotmail.com  Wed Jul  3 04:20:10 2013
From: josh-talk at hotmail.com (Josua S)
Date: Wed, 3 Jul 2013 13:20:10 +0200
Subject: [gdal-dev] OSM to KML Error
Message-ID: <DUB122-W3D4527B0BF47A94960FFBEE730@phx.gbl>

Hello

I exported an OSM file from openstreetmap.org and tried to convert it to KML with GDAL/OGR 1.10.0. However the conversion does not succeed and I get a lot of these errors: "ERROR 6: Interleaved feature adding to different layers is not supported". Is this a known problem and is there a solution to prevent this error? Thank you very much.

Josua 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130703/33b2c75e/attachment.html>

From even.rouault at mines-paris.org  Wed Jul  3 04:38:41 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 3 Jul 2013 13:38:41 +0200
Subject: [gdal-dev] OSM to KML Error
In-Reply-To: <DUB122-W3D4527B0BF47A94960FFBEE730@phx.gbl>
References: <DUB122-W3D4527B0BF47A94960FFBEE730@phx.gbl>
Message-ID: <201307031338.41343.even.rouault@mines-paris.org>

Le mercredi 03 juillet 2013 13:20:10, Josua S a ?crit :
> Hello
> 
> I exported an OSM file from openstreetmap.org and tried to convert it to
> KML with GDAL/OGR 1.10.0. However the conversion does not succeed and I
> get a lot of these errors: "ERROR 6: Interleaved feature adding to
> different layers is not supported". Is this a known problem and is there a
> solution to prevent this error? Thank you very much.

Josua,

When converting OSM files with ogr2ogr, the features are read in an interleaved 
way. For example, you can get X features from layer lines, then Y features 
from layer multipolygons, then Z features from layer lines again, etc...

The writing part of the KML driver doesn't support that back-and-forth between 
layers, hence this error.

A workaround is to convert to an intermediary format such as shapefile, 
PostGIS, sqlite/spatialite, gml, etc... that support writing features in 
layers in an interleaved way. Then you can convert to KML.

Best regards,

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From josh-talk at hotmail.com  Wed Jul  3 04:51:20 2013
From: josh-talk at hotmail.com (Josua S)
Date: Wed, 3 Jul 2013 13:51:20 +0200
Subject: [gdal-dev] OSM to KML Error
In-Reply-To: <201307031338.41343.even.rouault@mines-paris.org>
References: <DUB122-W3D4527B0BF47A94960FFBEE730@phx.gbl>,
	<201307031338.41343.even.rouault@mines-paris.org>
Message-ID: <DUB122-W408620B93E402FC6F57560EE730@phx.gbl>

> From: even.rouault at mines-paris.org
> To: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] OSM to KML Error
> Date: Wed, 3 Jul 2013 13:38:41 +0200
> CC: josh-talk at hotmail.com
> 
> Le mercredi 03 juillet 2013 13:20:10, Josua S a ?crit :
> > Hello
> > 
> > I exported an OSM file from openstreetmap.org and tried to convert it to
> > KML with GDAL/OGR 1.10.0. However the conversion does not succeed and I
> > get a lot of these errors: "ERROR 6: Interleaved feature adding to
> > different layers is not supported". Is this a known problem and is there a
> > solution to prevent this error? Thank you very much.
> 
> Josua,
> 
> When converting OSM files with ogr2ogr, the features are read in an interleaved 
> way. For example, you can get X features from layer lines, then Y features 
> from layer multipolygons, then Z features from layer lines again, etc...
> 
> The writing part of the KML driver doesn't support that back-and-forth between 
> layers, hence this error.
> 
> A workaround is to convert to an intermediary format such as shapefile, 
> PostGIS, sqlite/spatialite, gml, etc... that support writing features in 
> layers in an interleaved way. Then you can convert to KML.
> 
> Best regards,
> 
> Even
> 
> -- 
> Geospatial professional services
> http://even.rouault.free.fr/services.html


Hello Even
Thank you very much for your help, now it works! Probably I have not fully understood the problem, but is it something that can and will be fixed in a future version?
Josua 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130703/0f8b25b8/attachment.html>

From even.rouault at mines-paris.org  Wed Jul  3 05:12:58 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 3 Jul 2013 14:12:58 +0200
Subject: [gdal-dev] OSM to KML Error
In-Reply-To: <DUB122-W408620B93E402FC6F57560EE730@phx.gbl>
References: <DUB122-W3D4527B0BF47A94960FFBEE730@phx.gbl>
	<201307031338.41343.even.rouault@mines-paris.org>
	<DUB122-W408620B93E402FC6F57560EE730@phx.gbl>
Message-ID: <201307031412.58768.even.rouault@mines-paris.org>

> 
> Hello Even
> Thank you very much for your help, now it works! Probably I have not fully
> understood the problem, but is it something that can and will be fixed in
> a future version? Josua

Probably not. This is not really a bug, but a consequence of how the KML 
writer works. It writes features in the files as soon as they arrive. To handle 
layer interleaved writing, it should keep them all in memory before flushing 
them to disk, which might cause memory issues when writing huge KML files.

Note that if you have a build of GDAL/OGR with the LIBKML driver, you could 
use it directly (ogr2ogr -f LIBKML), as it indeed stores all features into 
memory. If you work with really big OSM files whose content cannot fit entirely 
in memory, this will not work.

Otherwise, if your OSM file is small enough so that no OSM layer has more than 
100 000 features, you can try adding "--config OGR_INTERLEAVED_READING NO" to 
your ogr2ogr command line. This will instruct ogr2ogr and the OSM driver not 
to go to interleaved reading mode, but as soon as a layer will have more than 
100 000 features, the reading will stop.

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From josh-talk at hotmail.com  Wed Jul  3 05:18:53 2013
From: josh-talk at hotmail.com (Josua S)
Date: Wed, 3 Jul 2013 14:18:53 +0200
Subject: [gdal-dev] OSM to KML Error
In-Reply-To: <201307031412.58768.even.rouault@mines-paris.org>
References: <DUB122-W3D4527B0BF47A94960FFBEE730@phx.gbl>
	<201307031338.41343.even.rouault@mines-paris.org>
	<DUB122-W408620B93E402FC6F57560EE730@phx.gbl>,
	<201307031412.58768.even.rouault@mines-paris.org>
Message-ID: <DUB122-W40023CEE4C5F8ADA2CE18EEE730@phx.gbl>

> > Hello Even
> > Thank you very much for your help, now it works! Probably I have not fully
> > understood the problem, but is it something that can and will be fixed in
> > a future version? Josua
> 
> Probably not. This is not really a bug, but a consequence of how the KML 
> writer works. It writes features in the files as soon as they arrive. To handle 
> layer interleaved writing, it should keep them all in memory before flushing 
> them to disk, which might cause memory issues when writing huge KML files.
> 
> Note that if you have a build of GDAL/OGR with the LIBKML driver, you could 
> use it directly (ogr2ogr -f LIBKML), as it indeed stores all features into 
> memory. If you work with really big OSM files whose content cannot fit entirely 
> in memory, this will not work.
> 
> Otherwise, if your OSM file is small enough so that no OSM layer has more than 
> 100 000 features, you can try adding "--config OGR_INTERLEAVED_READING NO" to 
> your ogr2ogr command line. This will instruct ogr2ogr and the OSM driver not 
> to go to interleaved reading mode, but as soon as a layer will have more than 
> 100 000 features, the reading will stop.
> 
> -- 
> Geospatial professional services
> http://even.rouault.free.fr/services.html


Ok, thanks again for your help and your detailed description!
Josua 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130703/1563c4cc/attachment.html>

From bertelli at charta.acme.com  Wed Jul  3 07:44:45 2013
From: bertelli at charta.acme.com (Carlo A. Bertelli (Charta s.r.l.))
Date: Wed, 3 Jul 2013 16:44:45 +0200
Subject: [gdal-dev] hillshading to vector
Message-ID: <CALc8-VKX_ePfG_UJt+Ax5Y-BpRy9YWDM2zfCegHonnAFu1AozQ@mail.gmail.com>

Hello,
gdaldem makes a very good work and gdal_polygonize.py too, but the
combination is not so effective. Is there a way to obtain smooth polygons
representing shaded areas as it's possible with Arc? When using a dem, you
get polygons for pixels. Yes you can dissolve them, but you still have
jagged boundaries. I even tried to get contours from hillshading, but
obviously I get only polylines sometimes not useful to be transformed into
polygons.
Is there a way to get smooth polygons from gdal_polygonize or polygons from
gdal_contour?

-- 
--------------------------------------------------------------------------
Carlo A. Bertelli
   Charta servizi e sistemi per il territorio e la storia ambientale srl
          Dipendenze del palazzo Doria,
          vc. alla Chiesa della Maddalena 9/2 16124      Genova (Italy)
          tel. +39(0)10 2475439  fax +39(0)10 2475439  gsm:+39 393 1590711
   e-mail: bertelli at charta.acme.com      http://www.charta.acme.com
--------------------------------------------------------------------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130703/f573444c/attachment-0001.html>

From brfr at metrico.lu  Wed Jul  3 07:17:14 2013
From: brfr at metrico.lu (Frank Broniewski)
Date: Wed, 03 Jul 2013 16:17:14 +0200
Subject: [gdal-dev] gdalwarp to XYZ grid
Message-ID: <51D4326A.6080409@metrico.lu>

Hi all,

I'm trying to warp a XYZ Grid to another CRS. My GDAL complains while 
running:
gdalwarp -t_srs EPSG:3035 -of XYZ /tmp/tmpU7lQR2/in.xyz 
/tmp/tmpU7lQR2/out.xyz
> Output driver `XYZ' not recognised or does not support
> direct output file creation.

and now I'm out of ideas and that's why:

I'm fiddling with SRTM scenes in order to create (automatically) nice 
looking hillshades. One step in the process is to use mdenoise [1] for 
smoothing the scene. mdenoise eats two file formats, ESRI ASCII Grid and 
XYZ Grid. And they need to be in a projected CRS with meters as unit, 
not in the default WGS84 SRTM "projection". Projecting raster data 
(including the ASCII grid) back and forth into other CRS yield mixed 
results in terms of quality since there are always distortions and anti 
aliasing issues.

So I want to stick to the GRASS people's approach with r.denoise [2]. 
They make a XYZ grid, project that to a projected CRS, denoise and 
reproject to the original CRS. And that's were I am stuck ... since I 
don't want to use GRASS for that work.

Any ideas on how to project a XYZ grid to another CRS?

Frank


[1] http://personalpages.manchester.ac.uk/staff/neil.mitchell/mdenoise/
[2] 
http://trac.osgeo.org/grass/browser/grass-addons/grass6/raster/r.denoise/r.denoise

-- 
Frank BRONIEWSKI

METRICO s.? r.l.
g?om?tres
technologies d'information g?ographique
rue des Romains 36
L-5433 NIEDERDONVEN

t?l.: +352 26 74 94 - 28
fax.: +352 26 74 94 99
http://www.metrico.lu

From even.rouault at mines-paris.org  Wed Jul  3 07:53:37 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 3 Jul 2013 16:53:37 +0200
Subject: [gdal-dev] gdalwarp to XYZ grid
In-Reply-To: <51D4326A.6080409@metrico.lu>
References: <51D4326A.6080409@metrico.lu>
Message-ID: <201307031653.38108.even.rouault@mines-paris.org>

Le mercredi 03 juillet 2013 16:17:14, Frank Broniewski a ?crit :
> Hi all,
> 
> I'm trying to warp a XYZ Grid to another CRS. My GDAL complains while
> running:
> gdalwarp -t_srs EPSG:3035 -of XYZ /tmp/tmpU7lQR2/in.xyz
> /tmp/tmpU7lQR2/out.xyz
> 
> > Output driver `XYZ' not recognised or does not support
> > direct output file creation.

Yes, XYZ format doesn't support random write access. You need to use an 
intermediary format such as GTiff or HFA for example

gdalwarp -t_srs EPSG:3035  /tmp/tmpU7lQR2/in.xyz temp.tif
gdal_translate  -of XYZ temp.tif /tmp/tmpU7lQR2/out.xyz


-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From brfr at metrico.lu  Wed Jul  3 08:01:53 2013
From: brfr at metrico.lu (Frank Broniewski)
Date: Wed, 03 Jul 2013 17:01:53 +0200
Subject: [gdal-dev] gdalwarp to XYZ grid
In-Reply-To: <201307031653.38108.even.rouault@mines-paris.org>
References: <51D4326A.6080409@metrico.lu>
	<201307031653.38108.even.rouault@mines-paris.org>
Message-ID: <51D43CE1.8070908@metrico.lu>

Am 2013-07-03 16:53, schrieb Even Rouault:
> Le mercredi 03 juillet 2013 16:17:14, Frank Broniewski a ?crit :
>> Hi all,
>>
>> I'm trying to warp a XYZ Grid to another CRS. My GDAL complains while
>> running:
>> gdalwarp -t_srs EPSG:3035 -of XYZ /tmp/tmpU7lQR2/in.xyz
>> /tmp/tmpU7lQR2/out.xyz
>>
>>> Output driver `XYZ' not recognised or does not support
>>> direct output file creation.
>
> Yes, XYZ format doesn't support random write access. You need to use an
> intermediary format such as GTiff or HFA for example
>
> gdalwarp -t_srs EPSG:3035  /tmp/tmpU7lQR2/in.xyz temp.tif
> gdal_translate  -of XYZ temp.tif /tmp/tmpU7lQR2/out.xyz
>
>

GTiff doesn't work well, because there are always distortions at the end 
of the process from the reprojection back and forth process

Meanwhile, and I could hammer myself for that, I found the hint at the 
mdenoise site stating that cs2cs could be used to reproject XYZ files:

cs2cs +init=epsg:4326 +to +init=epsg:3035 03_N49E006_dn_trl_xyz.xyz > 
epsg3035.xyz

does the trick ...

Frank

-- 
Frank BRONIEWSKI

METRICO s.? r.l.
g?om?tres
technologies d'information g?ographique
rue des Romains 36
L-5433 NIEDERDONVEN

t?l.: +352 26 74 94 - 28
fax.: +352 26 74 94 99
http://www.metrico.lu

From Daniel at nusalaska.com  Wed Jul  3 09:54:23 2013
From: Daniel at nusalaska.com (Daniel Kranich)
Date: Wed, 03 Jul 2013 08:54:23 -0800
Subject: [gdal-dev] g++ compilation errors when trying to compile GDAL on
	Fedora 17 64bit
Message-ID: <51D4573F.9080800@nusalaska.com>

Hello,

I have been trying to compile GDAL on my system as I would like to 
enable BigTIFF support.

I got through the ./compile just fine, however the make is giving me 
issues right off the start.

Here is what my make command does:

     [root at daniel-fedora gdal-1.10.0]# make
     (cd port; make)
     make[1]: Entering directory `/home/Daniel/Downloads/gdal-1.10.0/port'
     /bin/sh /home/Daniel/Downloads/gdal-1.10.0/libtool --mode=compile 
--tag=CXX g++  -DOGR_ENABLED -I/home/Daniel/Downloads/gdal-1.10.0/port 
      -I../frmts/zlib -DHAVE_LIBZ -c -o cpl_conv.lo
     cpl_conv.cpp
     libtool: compile:  g++ -DOGR_ENABLED 
-I/home/Daniel/Downloads/gdal-1.10.0/port -I../frmts/zlib
     -DHAVE_LIBZ -c cpl_conv.cpp  -o .libs/cpl_conv.o
     /home/Daniel/Downloads/gdal-1.10.0/libtool: line 1133: g++: command 
not found
     make[1]: *** [cpl_conv.lo] Error 1
     make[1]: Leaving directory `/home/Daniel/Downloads/gdal-1.10.0/port'
     make: *** [port-target] Error 2

Im not even sure where to start looking.

Thanks

-Daniel




From etourigny.dev at gmail.com  Wed Jul  3 10:08:15 2013
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Wed, 3 Jul 2013 14:08:15 -0300
Subject: [gdal-dev] g++ compilation errors when trying to compile GDAL
 on Fedora 17 64bit
In-Reply-To: <51D4573F.9080800@nusalaska.com>
References: <51D4573F.9080800@nusalaska.com>
Message-ID: <CA+TxYvMbmnJqJz1kH-LRiz52y9UHr7eyvhMpK60bHVmU04+ssA@mail.gmail.com>

It seems you don't have c++ installed...
you can *probably* install it like this

yum install gcc-c++

On Wed, Jul 3, 2013 at 1:54 PM, Daniel Kranich <Daniel at nusalaska.com> wrote:

> Hello,
>
> I have been trying to compile GDAL on my system as I would like to enable
> BigTIFF support.
>
> I got through the ./compile just fine, however the make is giving me
> issues right off the start.
>
> Here is what my make command does:
>
>     [root at daniel-fedora gdal-1.10.0]# make
>     (cd port; make)
>     make[1]: Entering directory `/home/Daniel/Downloads/gdal-**
> 1.10.0/port'
>     /bin/sh /home/Daniel/Downloads/gdal-1.**10.0/libtool --mode=compile
> --tag=CXX g++  -DOGR_ENABLED -I/home/Daniel/Downloads/gdal-**1.10.0/port
>      -I../frmts/zlib -DHAVE_LIBZ -c -o cpl_conv.lo
>     cpl_conv.cpp
>     libtool: compile:  g++ -DOGR_ENABLED -I/home/Daniel/Downloads/gdal-**1.10.0/port
> -I../frmts/zlib
>     -DHAVE_LIBZ -c cpl_conv.cpp  -o .libs/cpl_conv.o
>     /home/Daniel/Downloads/gdal-1.**10.0/libtool: line 1133: g++: command
> not found
>     make[1]: *** [cpl_conv.lo] Error 1
>     make[1]: Leaving directory `/home/Daniel/Downloads/gdal-**1.10.0/port'
>     make: *** [port-target] Error 2
>
> Im not even sure where to start looking.
>
> Thanks
>
> -Daniel
>
>
>
> ______________________________**_________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/**mailman/listinfo/gdal-dev<http://lists.osgeo.org/mailman/listinfo/gdal-dev>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130703/216a74a0/attachment.html>

From rveciana at gmail.com  Wed Jul  3 11:36:30 2013
From: rveciana at gmail.com (Roger Veciana i Rovira)
Date: Wed, 3 Jul 2013 20:36:30 +0200
Subject: [gdal-dev] hillshading to vector
In-Reply-To: <CALc8-VKX_ePfG_UJt+Ax5Y-BpRy9YWDM2zfCegHonnAFu1AozQ@mail.gmail.com>
References: <CALc8-VKX_ePfG_UJt+Ax5Y-BpRy9YWDM2zfCegHonnAFu1AozQ@mail.gmail.com>
Message-ID: <CAJx2nokLrx64Fxnw5DAOZwmTN4=i6fv3vzwM8TyOYGw-nwjS4Q@mail.gmail.com>

Hi, I was just working on that.
I think that you need a script like gdal_contour, but creatig polygons
instead of lines. The algorithm used is Marching Squares.
You can see the code, without explanation, here:
https://github.com/rveciana/geoexamples/tree/master/python/raster_isobands
In some weeks I'll add some more info in a README file and transform the
file into a working script, not just a function. But you can use it just
changing the file name and the intervals.

Roger


2013/7/3 Carlo A. Bertelli (Charta s.r.l.) <bertelli at charta.acme.com>

> Hello,
> gdaldem makes a very good work and gdal_polygonize.py too, but the
> combination is not so effective. Is there a way to obtain smooth polygons
> representing shaded areas as it's possible with Arc? When using a dem, you
> get polygons for pixels. Yes you can dissolve them, but you still have
> jagged boundaries. I even tried to get contours from hillshading, but
> obviously I get only polylines sometimes not useful to be transformed into
> polygons.
> Is there a way to get smooth polygons from gdal_polygonize or polygons
> from gdal_contour?
>
> --
> --------------------------------------------------------------------------
> Carlo A. Bertelli
>    Charta servizi e sistemi per il territorio e la storia ambientale srl
>           Dipendenze del palazzo Doria,
>           vc. alla Chiesa della Maddalena 9/2 16124      Genova (Italy)
>           tel. +39(0)10 2475439  fax +39(0)10 2475439  gsm:+39 393 1590711
>    e-mail: bertelli at charta.acme.com      http://www.charta.acme.com
> --------------------------------------------------------------------------
>
>
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130703/d724b735/attachment.html>

From nikhil.parupalli at iictechnologies.com  Wed Jul  3 22:36:45 2013
From: nikhil.parupalli at iictechnologies.com (Nikhil Sai Parupalli)
Date: Thu, 4 Jul 2013 05:36:45 +0000
Subject: [gdal-dev] Gdal 32 bit libraries -reg
Message-ID: <139560E1825F4648BDA4F32853B530A7C8D93ECD@IICEXHCM.iictechnologies.local>

Hi ,

Please let me know where to download Gdal libraries of 32 bit 


Thanks
Nikhil Sai Parupalli

From szekerest at gmail.com  Wed Jul  3 23:29:30 2013
From: szekerest at gmail.com (Tamas Szekeres)
Date: Thu, 4 Jul 2013 08:29:30 +0200
Subject: [gdal-dev] Gdal 32 bit libraries -reg
In-Reply-To: <139560E1825F4648BDA4F32853B530A7C8D93ECD@IICEXHCM.iictechnologies.local>
References: <139560E1825F4648BDA4F32853B530A7C8D93ECD@IICEXHCM.iictechnologies.local>
Message-ID: <CACALY+TQFdrE7URU2x=f9+K70CYOs6DLKqbGaHuGb7AH5pS8VQ@mail.gmail.com>

Hi,

Please refer to: http://trac.osgeo.org/gdal/wiki/DownloadingGdalBinaries

Best regards,

Tamas




2013/7/4 Nikhil Sai Parupalli <nikhil.parupalli at iictechnologies.com>

> Hi ,
>
> Please let me know where to download Gdal libraries of 32 bit
>
>
> Thanks
> Nikhil Sai Parupalli
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130704/4610e266/attachment.html>

From bertelli at charta.acme.com  Wed Jul  3 23:58:41 2013
From: bertelli at charta.acme.com (Carlo A. Bertelli (Charta s.r.l.))
Date: Thu, 4 Jul 2013 08:58:41 +0200
Subject: [gdal-dev] hillshading to vector
In-Reply-To: <CALc8-VLbpbHitSLwLYMSpQC7pinMrANAPcPQ9nZgR7Oc=M2K+A@mail.gmail.com>
References: <CALc8-VKX_ePfG_UJt+Ax5Y-BpRy9YWDM2zfCegHonnAFu1AozQ@mail.gmail.com>
	<CAJx2no=H16gGwnmkPZ0nY-XWjxSgP4wPinAE3Ld3CXcuRezjEw@mail.gmail.com>
	<CALc8-VKJ_fyqQB4nfSMAUVy=Ryk_pea_A05dLj9mOf+CYtSUOA@mail.gmail.com>
	<CALc8-VLbpbHitSLwLYMSpQC7pinMrANAPcPQ9nZgR7Oc=M2K+A@mail.gmail.com>
Message-ID: <CALc8-VKGK=8hprzE3TwuAi3=HdQ8ehB+fn4dxvQXfXRe5mcA+g@mail.gmail.com>

Thanks a lot, Roger, it worked like a charm, just fiddling a little with
parameters and than run it in python.
It's really magic, I struggled with this question for two days before
writing to the list.
I think that instead of making another script you could add it as an option
to gdal_contour.py and use it alternatively with -l (default) or -p (output
to polygons).
By the way, another enhancement for gdal_contour could be adding an options
to cut the output with a line or polygon layer (say the shoreline or other
boundary).
c

c
>
> On Wed, Jul 3, 2013 at 8:04 PM, Roger Veciana i Rovira <rveciana at gmail.com
> > wrote:
>
>> Hi, I was just working on that.
>> I think that you need a script like gdal_contour, but creatig polygons
>> instead of lines. The algorithm used is Marching Squares.
>> You can see the code, without explanation, here:
>> https://github.com/rveciana/geoexamples/tree/master/python/raster_isobands
>> In some weeks I'll add some more info in a README file and transform the
>> file into a working script, not just a function. But you can use it just
>> changing the file name and the intervals.
>>
>> Roger
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130704/c1f1a15f/attachment.html>

From j.l.h.hartmann at uva.nl  Thu Jul  4 09:12:32 2013
From: j.l.h.hartmann at uva.nl (Jan Hartmann)
Date: Thu, 04 Jul 2013 18:12:32 +0200
Subject: [gdal-dev] GeomTransform in VRT-file
In-Reply-To: <CA+YzLBdgY42X-Vun77cJaMTfA0sqg0OM3AKvK6BR0axrxJQTmA@mail.gmail.com>
References: <51CE0B90.6070109@sri.com>	<CABUeae-u=P9JpwieXrDY1QA=_ss8crkMEtu+xXfbcPPVKUcvSw@mail.gmail.com>	<51CEEAEB.9080208@sri.com>
	<CA+YzLBdgY42X-Vun77cJaMTfA0sqg0OM3AKvK6BR0axrxJQTmA@mail.gmail.com>
Message-ID: <51D59EF0.5070105@uva.nl>

I'm struggling with the order of the Geotransform section in a vrt file. 
I would like to rotate an image, and computed the six parameters for the 
affine transformation. I can transform points exactly, using the 
following formula:

x2 = a.x1 + b.y1 + c
y2 = d.x1 + e.y1 + f

Can anyone tell me what the order is in the GeoTransform section of the 
VRT-file?

<GeoTransform> c a b f d e </GeoTransform>

results in an image somewhere in the neighbourhood, but mirrored and 
translated. What is the order of the parameters a-f?

Jan

From hilda.villegas at navico.com  Thu Jul  4 11:48:37 2013
From: hilda.villegas at navico.com (Hilda Villegas)
Date: Thu, 4 Jul 2013 18:48:37 +0000
Subject: [gdal-dev] ogr2ogr fail: crtExitProcess
Message-ID: <8B0C8942F7080F47B82245E36EAEFB8B3E84E0B6@EXCH01-OKLUS.MARINE.NET.INT>

Hello,

I'm using the ogr2ogr.exe to convert ENC files to shapefiles, the program extract the object from the ENC and creates the shapefile successfully, but it fails before finish.

These are the parameters:

ogr2ogr.exe -skipfailures C:\temp\ogr2ogr_test\Shapefiles\US5CA71M\aRESARE.shp -nlt polygon C:\temp\ogr2ogr_test\Enc\US5CA71M\US5CA71M.000 RESARE

The program stopped at the crt0dat.c in the following section when I run it in debug mode:
void __cdecl __crtExitProcess (
        int status
        )
{
        __crtCorExitProcess(status);

        /*
         * Either mscoree.dll isn't loaded,
         * or CorExitProcess isn't exported from mscoree.dll,
         * or CorExitProcess returned (should never happen).
         * Just call ExitProcess.
         */

        ExitProcess(status);  <-----------
}

This is the error message:
"First-chance exception at 0x7761f9d2 in ogr2ogr.exe: 0xC0000008: An invalid handle was specified"

Any thought about why this happened is appreciated.

Best regards,

Hilda Villegas



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130704/1e7796dd/attachment.html>

From etourigny.dev at gmail.com  Thu Jul  4 12:21:19 2013
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Thu, 4 Jul 2013 16:21:19 -0300
Subject: [gdal-dev] hillshading to vector
In-Reply-To: <CALc8-VKGK=8hprzE3TwuAi3=HdQ8ehB+fn4dxvQXfXRe5mcA+g@mail.gmail.com>
References: <CALc8-VKX_ePfG_UJt+Ax5Y-BpRy9YWDM2zfCegHonnAFu1AozQ@mail.gmail.com>
	<CAJx2no=H16gGwnmkPZ0nY-XWjxSgP4wPinAE3Ld3CXcuRezjEw@mail.gmail.com>
	<CALc8-VKJ_fyqQB4nfSMAUVy=Ryk_pea_A05dLj9mOf+CYtSUOA@mail.gmail.com>
	<CALc8-VLbpbHitSLwLYMSpQC7pinMrANAPcPQ9nZgR7Oc=M2K+A@mail.gmail.com>
	<CALc8-VKGK=8hprzE3TwuAi3=HdQ8ehB+fn4dxvQXfXRe5mcA+g@mail.gmail.com>
Message-ID: <CA+TxYvPaGfXhpRis-zGSozDG4wb4DThKK+GE4YGxuWycM=6TFA@mail.gmail.com>

On Thu, Jul 4, 2013 at 3:58 AM, Carlo A. Bertelli (Charta s.r.l.) <
bertelli at charta.acme.com> wrote:

> Thanks a lot, Roger, it worked like a charm, just fiddling a little with
> parameters and than run it in python.
> It's really magic, I struggled with this question for two days before
> writing to the list.
> I think that instead of making another script you could add it as an
> option to gdal_contour.py and use it alternatively with -l (default) or -p
> (output to polygons).
>

not so sure about that, because the script requires matplotlib (although
the option could be disabled if matplotlib cannot be imported).


> By the way, another enhancement for gdal_contour could be adding an
> options to cut the output with a line or polygon layer (say the shoreline
> or other boundary).
> c
>
> c
>>
>> On Wed, Jul 3, 2013 at 8:04 PM, Roger Veciana i Rovira <
>> rveciana at gmail.com> wrote:
>>
>>> Hi, I was just working on that.
>>> I think that you need a script like gdal_contour, but creatig polygons
>>> instead of lines. The algorithm used is Marching Squares.
>>> You can see the code, without explanation, here:
>>>
>>> https://github.com/rveciana/geoexamples/tree/master/python/raster_isobands
>>> In some weeks I'll add some more info in a README file and transform the
>>> file into a working script, not just a function. But you can use it just
>>> changing the file name and the intervals.
>>>
>>> Roger
>>>
>>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130704/0122ccd1/attachment.html>

From even.rouault at mines-paris.org  Thu Jul  4 12:51:45 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 4 Jul 2013 21:51:45 +0200
Subject: [gdal-dev] ogr2ogr fail: crtExitProcess
In-Reply-To: <8B0C8942F7080F47B82245E36EAEFB8B3E84E0B6@EXCH01-OKLUS.MARINE.NET.INT>
References: <8B0C8942F7080F47B82245E36EAEFB8B3E84E0B6@EXCH01-OKLUS.MARINE.NET.INT>
Message-ID: <201307042151.45048.even.rouault@mines-paris.org>

Le jeudi 04 juillet 2013 20:48:37, Hilda Villegas a ?crit :
> Hello,
> 
> I'm using the ogr2ogr.exe to convert ENC files to shapefiles, the program
> extract the object from the ENC and creates the shapefile successfully,
> but it fails before finish.
> 
> These are the parameters:
> 
> ogr2ogr.exe -skipfailures
> C:\temp\ogr2ogr_test\Shapefiles\US5CA71M\aRESARE.shp -nlt polygon
> C:\temp\ogr2ogr_test\Enc\US5CA71M\US5CA71M.000 RESARE
> 
> The program stopped at the crt0dat.c in the following section when I run it
> in debug mode: void __cdecl __crtExitProcess (
>         int status
>         )
> {
>         __crtCorExitProcess(status);
> 
>         /*
>          * Either mscoree.dll isn't loaded,
>          * or CorExitProcess isn't exported from mscoree.dll,
>          * or CorExitProcess returned (should never happen).
>          * Just call ExitProcess.
>          */
> 
>         ExitProcess(status);  <-----------
> }
> 
> This is the error message:
> "First-chance exception at 0x7761f9d2 in ogr2ogr.exe: 0xC0000008: An
> invalid handle was specified"
> 
> Any thought about why this happened is appreciated.

It might be a bug in the ENC driver. Did you try with GDAL 1.10 ? If not, I'd 
encourage you to do so. If it is GDAL 1.10, then could you provide your file so 
that it can be investigated ?

> 
> Best regards,
> 
> Hilda Villegas

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From bishop.dev at gmail.com  Thu Jul  4 12:58:19 2013
From: bishop.dev at gmail.com (Dmitriy Baryshnikov)
Date: Thu, 04 Jul 2013 23:58:19 +0400
Subject: [gdal-dev] GeomTransform in VRT-file
In-Reply-To: <51D59EF0.5070105@uva.nl>
References: <51CE0B90.6070109@sri.com>	<CABUeae-u=P9JpwieXrDY1QA=_ss8crkMEtu+xXfbcPPVKUcvSw@mail.gmail.com>	<51CEEAEB.9080208@sri.com>
	<CA+YzLBdgY42X-Vun77cJaMTfA0sqg0OM3AKvK6BR0axrxJQTmA@mail.gmail.com>
	<51D59EF0.5070105@uva.nl>
Message-ID: <51D5D3DB.1080406@gmail.com>

Hi Jan,

Do you mean this : http://www.gdal.org/gdal_datamodel.html (Affine 
GeoTransform srection) or this http://www.gdal.org/gdal_tutorial.html 
(Getting Dataset Information section)?
Also, see this: 
http://www.gdal.org/classVRTDataset.html#a1531325b71e290b90c8d9cc88bce6c2b

Best regards,
     Dmitriy

04.07.2013 20:12, Jan Hartmann ?????:
> I'm struggling with the order of the Geotransform section in a vrt 
> file. I would like to rotate an image, and computed the six parameters 
> for the affine transformation. I can transform points exactly, using 
> the following formula:
>
> x2 = a.x1 + b.y1 + c
> y2 = d.x1 + e.y1 + f
>
> Can anyone tell me what the order is in the GeoTransform section of 
> the VRT-file?
>
> <GeoTransform> c a b f d e </GeoTransform>
>
> results in an image somewhere in the neighbourhood, but mirrored and 
> translated. What is the order of the parameters a-f?
>
> Jan
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>


From rveciana at gmail.com  Thu Jul  4 13:55:33 2013
From: rveciana at gmail.com (Roger Veciana i Rovira)
Date: Thu, 4 Jul 2013 22:55:33 +0200
Subject: [gdal-dev] hillshading to vector
In-Reply-To: <CA+TxYvPaGfXhpRis-zGSozDG4wb4DThKK+GE4YGxuWycM=6TFA@mail.gmail.com>
References: <CALc8-VKX_ePfG_UJt+Ax5Y-BpRy9YWDM2zfCegHonnAFu1AozQ@mail.gmail.com>
	<CAJx2no=H16gGwnmkPZ0nY-XWjxSgP4wPinAE3Ld3CXcuRezjEw@mail.gmail.com>
	<CALc8-VKJ_fyqQB4nfSMAUVy=Ryk_pea_A05dLj9mOf+CYtSUOA@mail.gmail.com>
	<CALc8-VLbpbHitSLwLYMSpQC7pinMrANAPcPQ9nZgR7Oc=M2K+A@mail.gmail.com>
	<CALc8-VKGK=8hprzE3TwuAi3=HdQ8ehB+fn4dxvQXfXRe5mcA+g@mail.gmail.com>
	<CA+TxYvPaGfXhpRis-zGSozDG4wb4DThKK+GE4YGxuWycM=6TFA@mail.gmail.com>
Message-ID: <CAJx2nono8hHW7HWSve5DYky_djYwUEz_-CJRkQhR_Tu6=Vw_SQ@mail.gmail.com>

Hi Etienne,

I have uploaded an other version that works without matplotlib, although I
prefer the other, which is cleaner. But the new one is a better option if
using matplotlib is a problem.

Anyway, changing gdal_contour is much more work. Creating polygons instead
of lines using the correct way means re-writting all the code, and this
scripts are just to get the result.

Again, I have to finish them, I was just working on it.

Roger


2013/7/4 Etienne Tourigny <etourigny.dev at gmail.com>

>
>
> On Thu, Jul 4, 2013 at 3:58 AM, Carlo A. Bertelli (Charta s.r.l.) <
> bertelli at charta.acme.com> wrote:
>
>> Thanks a lot, Roger, it worked like a charm, just fiddling a little with
>> parameters and than run it in python.
>> It's really magic, I struggled with this question for two days before
>> writing to the list.
>> I think that instead of making another script you could add it as an
>> option to gdal_contour.py and use it alternatively with -l (default) or -p
>> (output to polygons).
>>
>
> not so sure about that, because the script requires matplotlib (although
> the option could be disabled if matplotlib cannot be imported).
>
>
>> By the way, another enhancement for gdal_contour could be adding an
>> options to cut the output with a line or polygon layer (say the shoreline
>> or other boundary).
>> c
>>
>> c
>>>
>>> On Wed, Jul 3, 2013 at 8:04 PM, Roger Veciana i Rovira <
>>> rveciana at gmail.com> wrote:
>>>
>>>> Hi, I was just working on that.
>>>> I think that you need a script like gdal_contour, but creatig polygons
>>>> instead of lines. The algorithm used is Marching Squares.
>>>> You can see the code, without explanation, here:
>>>>
>>>> https://github.com/rveciana/geoexamples/tree/master/python/raster_isobands
>>>> In some weeks I'll add some more info in a README file and transform
>>>> the file into a working script, not just a function. But you can use it
>>>> just changing the file name and the intervals.
>>>>
>>>> Roger
>>>>
>>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130704/487dc6b0/attachment.html>

From even.rouault at mines-paris.org  Thu Jul  4 14:40:32 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 4 Jul 2013 23:40:32 +0200
Subject: [gdal-dev] ogr2ogr fail: crtExitProcess
In-Reply-To: <8B0C8942F7080F47B82245E36EAEFB8B3E8508CB@EXCH01-OKLUS.MARINE.NET.INT>
References: <8B0C8942F7080F47B82245E36EAEFB8B3E84E0B6@EXCH01-OKLUS.MARINE.NET
	.INT> <201307042151.45048.even.rouault@mines-paris.org>
	<8B0C8942F7080F47B82245E36EAEFB8B3E8508CB@EXCH01-OKLUS.MARINE.NET.INT>
Message-ID: <201307042340.32751.even.rouault@mines-paris.org>

Le jeudi 04 juillet 2013 22:05:26, Hilda Villegas a ?crit :
> Thanks for your response. Yes, I'm using gdal 10.0
> 
> Attached is the ENC that I'm using.

Hum, your ogr2ogr command line works for me with different GDAL builds, 
including the one available at 
http://www.gisinternals.com/sdk/PackageList.aspx?file=release-1310-gdal-1-10-0-
mapserver-6-2-1.zip

If you've compiled GDAL yourself, then it looks like an issue with your build.

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Thu Jul  4 14:44:15 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 4 Jul 2013 23:44:15 +0200
Subject: [gdal-dev] GeomTransform in VRT-file
In-Reply-To: <51D59EF0.5070105@uva.nl>
References: <51CE0B90.6070109@sri.com>
	<CA+YzLBdgY42X-Vun77cJaMTfA0sqg0OM3AKvK6BR0axrxJQTmA@mail.gmail.com>
	<51D59EF0.5070105@uva.nl>
Message-ID: <201307042344.15720.even.rouault@mines-paris.org>

Le jeudi 04 juillet 2013 18:12:32, Jan Hartmann a ?crit :
> I'm struggling with the order of the Geotransform section in a vrt file.
> I would like to rotate an image, and computed the six parameters for the
> affine transformation. I can transform points exactly, using the
> following formula:
> 
> x2 = a.x1 + b.y1 + c
> y2 = d.x1 + e.y1 + f
> 
> Can anyone tell me what the order is in the GeoTransform section of the
> VRT-file?
> 
> <GeoTransform> c a b f d e </GeoTransform>
> 
> results in an image somewhere in the neighbourhood, but mirrored and
> translated. What is the order of the parameters a-f?

That looks correct, assuming that (x1, y1) is expressed as column, row in 
pixels of the image and (x2, y2) is expressed in the output coordinate system.

> 
> Jan
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From raigron at fly-n-sense.com  Fri Jul  5 01:59:47 2013
From: raigron at fly-n-sense.com (raigron at fly-n-sense.com)
Date: Fri, 05 Jul 2013 10:59:47 +0200
Subject: [gdal-dev] gdal/proj4 and gtk, SpatialReference.setFromUserInput bug
Message-ID: <f72a79029781c6265c78614d6afcfe40@fly-n-sense.com>

Hi,

i'm facing a strange bug in python:

from osgeo import osr
sp = osr.SpatialReference()
sp.SetFromUserInput("IGNF:LAMB2C")
print sp

returns:
PROJCS["unnamed",
     GEOGCS["unnamed ellipse",
         DATUM["unknown",
             SPHEROID["unnamed",6378249.2,293.466021],
             EXTENSION["PROJ4_GRIDS","ntf_r93.gsb,null"]],
         PRIMEM["unnamed",2.337229167],
         UNIT["degree",0.0174532925199433]],
     PROJECTION["Lambert_Conformal_Conic_1SP"],
     PARAMETER["latitude_of_origin",46.8],
     PARAMETER["central_meridian",0],
     PARAMETER["scale_factor",0.99987742],
     PARAMETER["false_easting",600000],
     PARAMETER["false_northing",2200000],
     UNIT["Meter",1]]

which is correct.
But when i import gtk :

from osgeo import osr
import gtk
sp = osr.SpatialReference()
sp.SetFromUserInput("IGNF:LAMB2C")
print sp

PROJCS["unnamed",
     GEOGCS["unnamed ellipse",
         DATUM["unknown",
             SPHEROID["unnamed",6378249,293],
             EXTENSION["PROJ4_GRIDS","ntf_r93.gsb,null"]],
         PRIMEM["unnamed",2],
         UNIT["degree",0.0174532925199433]],
     PROJECTION["Lambert_Conformal_Conic_1SP"],
     PARAMETER["latitude_of_origin",46],
     PARAMETER["central_meridian",0],
     PARAMETER["scale_factor",0],
     PARAMETER["false_easting",600000],
     PARAMETER["false_northing",2200000],
     UNIT["Meter",1]]

the float values seem to have been cast to integers.

I'm using
Gdal: 1.10.0
Proj: 4.8.0
Python: 2.7.5
Gtk: 2.28.6

Note that it works correctly with Proj4.7.0.

Does someone have a clue about what's happening ?
Thanks


From even.rouault at mines-paris.org  Fri Jul  5 12:24:38 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 5 Jul 2013 21:24:38 +0200
Subject: [gdal-dev] gdal/proj4 and gtk,
	SpatialReference.setFromUserInput bug
In-Reply-To: <f72a79029781c6265c78614d6afcfe40@fly-n-sense.com>
References: <f72a79029781c6265c78614d6afcfe40@fly-n-sense.com>
Message-ID: <201307052124.39104.even.rouault@mines-paris.org>

> Does someone have a clue about what's happening ?

Yes,

this is due to the "import gtk" setting the locale from the C locale to the 
locale of the language of your system, which has likely comma has the decimal 
separator. There are a few places in GDAL/OGR that are not ready (yet) for 
that.

You can workaround the issue with the following :

"""
from osgeo import osr
import gtk
sp = osr.SpatialReference()

# Save current locale and switch to C locale
import locale
old_locale = locale.setlocale(locale.LC_ALL, None)
locale.setlocale(locale.LC_ALL, 'C')

sp.SetFromUserInput("IGNF:LAMB2C")

# Restore old locale
locale.setlocale(locale.LC_ALL, old_locale)

print sp
"""

I'll look to do the same fix in GDAL itself.


> Thanks
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From Dominik.Schneider at Colorado.EDU  Fri Jul  5 12:39:51 2013
From: Dominik.Schneider at Colorado.EDU (Dominik Schneider)
Date: Fri, 5 Jul 2013 13:39:51 -0600
Subject: [gdal-dev] gdal_merge.py won't load libpng
In-Reply-To: <CAHYDKLbxQgF3bxMDffK4SJ9kRdx1Wi9mk3FKtvunEKwki5xRDA@mail.gmail.com>
References: <CAHYDKLbxQgF3bxMDffK4SJ9kRdx1Wi9mk3FKtvunEKwki5xRDA@mail.gmail.com>
Message-ID: <CAHYDKLamQKpS7gYz6FSB0YWyiY9O6f0xUQP=TCe9N4+Oam2Mfg@mail.gmail.com>

anyone have any suggestions?! I'm at a complete loss how to troubleshoot.


Dominik Schneider
o 303.735.6296 | c 518.956.3978



On Tue, Jul 2, 2013 at 10:52 AM, Dominik Schneider <
dominik.schneider at colorado.edu> wrote:

> Hi,
> I am trying to run:
> gdal_merge.py -init -9999 -n 2001 -o
> MOD09GA.A2012001.h08v05.005.NRTsnow_fraction.tif.1
> MOD09GA.A2012001.h08v05.005.NRTsnow_fraction.tif
>
> The Error:
> Traceback (most recent call last):
>   File "/Library/Frameworks/GDAL.framework/Programs/gdal_merge.py", line
> 36, in <module>
>     import gdal
>   File "/usr/local/lib/python2.7/site-packages/gdal.py", line 2, in
> <module>
>     from osgeo.gdal import deprecation_warn
>   File "/usr/local/lib/python2.7/site-packages/osgeo/__init__.py", line
> 21, in <module>
>     _gdal = swig_import_helper()
>   File "/usr/local/lib/python2.7/site-packages/osgeo/__init__.py", line
> 17, in swig_import_helper
>     _mod = imp.load_module('_gdal', fp, pathname, description)
> ImportError: dlopen(/usr/local/lib/python2.7/site-packages/osgeo/_gdal.so,
> 2): Library not loaded: libpng15.15.dylib
>   Referenced from: /usr/local/Cellar/gdal/1.10.0/lib/libgdal.1.dylib
>   Reason: image not found
>
> Gdal is here:
> > which gdal_merge.py
> /Library/Frameworks/GDAL.framework/Programs/gdal_merge.py
>
> I'm completely new gdal but am guessing i've got some confusion between
> different versions of gdal and python.  I have rgdal installed so at some
> point in the past I probably installed gdal too? Today I installed gdal
> with homebrew and also tried the binary from
> http://www.kyngchaos.com/software:frameworks
> For python I have the system default (2.7) on osx.7.5 and the anaconda
> installation.
>
> I should also say, if I load python I am unable to import gdal:
> > python
> Python 2.7.4 |Anaconda 1.5.1 (x86_64)| (default, May  9 2013, 12:12:00)
> [GCC 4.0.1 (Apple Inc. build 5493)] on darwin
> Type "help", "copyright", "credits" or "license" for more information.
> >>> from osgeo import gdal
> Traceback (most recent call last):
>   File "<stdin>", line 1, in <module>
>   File "/usr/local/lib/python2.7/site-packages/osgeo/__init__.py", line
> 21, in <module>
>     _gdal = swig_import_helper()
>   File "/usr/local/lib/python2.7/site-packages/osgeo/__init__.py", line
> 17, in swig_import_helper
>     _mod = imp.load_module('_gdal', fp, pathname, description)
> ImportError: dlopen(/usr/local/lib/python2.7/site-packages/osgeo/_gdal.so,
> 2): Library not loaded: libpng15.15.dylib
>   Referenced from: /usr/local/Cellar/gdal/1.10.0/lib/libgdal.1.dylib
>   Reason: image not found
>
>
> any help would be appreciated.
> Thanks
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130705/367d919e/attachment.html>

From woklist at kyngchaos.com  Fri Jul  5 15:13:05 2013
From: woklist at kyngchaos.com (William Kyngesburye)
Date: Fri, 5 Jul 2013 17:13:05 -0500
Subject: [gdal-dev] gdal_merge.py won't load libpng
In-Reply-To: <CAHYDKLamQKpS7gYz6FSB0YWyiY9O6f0xUQP=TCe9N4+Oam2Mfg@mail.gmail.com>
References: <CAHYDKLbxQgF3bxMDffK4SJ9kRdx1Wi9mk3FKtvunEKwki5xRDA@mail.gmail.com>
	<CAHYDKLamQKpS7gYz6FSB0YWyiY9O6f0xUQP=TCe9N4+Oam2Mfg@mail.gmail.com>
Message-ID: <CFFF1B68-1337-4304-B4CE-E1F81F6D9BD4@kyngchaos.com>

Looks like a confused gdal and python installation mess...

If you're using my GDAL framework, it uses my UnixImageIO framework for libpng.  And, the included gdal-python uses the system python.

But according to the error python is looking for python modules (thus gdal-python) in /usr/local.  This implies that the system python is NOT running, but a custom install (is that what anaconda is?), with it's own python module search path.  I'm guessing that the anaconda python (?) is in /usr/local/bin and thus be found before the system python.

PYTHONPATH might work to redirect your custom python to look for the correct gdal-python:

  export PYTHON_PATH=/Library/Frameworks/GDAL.framework/Versions/1.10/Python/2.7/site-packages

If not, you'll have to uninstall your custom python (anaconda? homebrew?) so it doesn't override the system python.

On Jul 5, 2013, at 2:39 PM, Dominik Schneider wrote:

> anyone have any suggestions?! I'm at a complete loss how to troubleshoot.
> 
> 
> Dominik Schneider
> o 303.735.6296 | c 518.956.3978 
> 
> 
> 
> On Tue, Jul 2, 2013 at 10:52 AM, Dominik Schneider <dominik.schneider at colorado.edu> wrote:
> Hi, 
> I am trying to run:
> gdal_merge.py -init -9999 -n 2001 -o MOD09GA.A2012001.h08v05.005.NRTsnow_fraction.tif.1 MOD09GA.A2012001.h08v05.005.NRTsnow_fraction.tif
> 
> The Error:
> Traceback (most recent call last):
>   File "/Library/Frameworks/GDAL.framework/Programs/gdal_merge.py", line 36, in <module>
>     import gdal
>   File "/usr/local/lib/python2.7/site-packages/gdal.py", line 2, in <module>
>     from osgeo.gdal import deprecation_warn
>   File "/usr/local/lib/python2.7/site-packages/osgeo/__init__.py", line 21, in <module>
>     _gdal = swig_import_helper()
>   File "/usr/local/lib/python2.7/site-packages/osgeo/__init__.py", line 17, in swig_import_helper
>     _mod = imp.load_module('_gdal', fp, pathname, description)
> ImportError: dlopen(/usr/local/lib/python2.7/site-packages/osgeo/_gdal.so, 2): Library not loaded: libpng15.15.dylib
>   Referenced from: /usr/local/Cellar/gdal/1.10.0/lib/libgdal.1.dylib
>   Reason: image not found
> 
> Gdal is here:
> > which gdal_merge.py
> /Library/Frameworks/GDAL.framework/Programs/gdal_merge.py
> 
> I'm completely new gdal but am guessing i've got some confusion between different versions of gdal and python.  I have rgdal installed so at some point in the past I probably installed gdal too? Today I installed gdal with homebrew and also tried the binary from http://www.kyngchaos.com/software:frameworks
> For python I have the system default (2.7) on osx.7.5 and the anaconda installation.
> 
> I should also say, if I load python I am unable to import gdal:
> > python
> Python 2.7.4 |Anaconda 1.5.1 (x86_64)| (default, May  9 2013, 12:12:00) 
> [GCC 4.0.1 (Apple Inc. build 5493)] on darwin
> Type "help", "copyright", "credits" or "license" for more information.
> >>> from osgeo import gdal
> Traceback (most recent call last):
>   File "<stdin>", line 1, in <module>
>   File "/usr/local/lib/python2.7/site-packages/osgeo/__init__.py", line 21, in <module>
>     _gdal = swig_import_helper()
>   File "/usr/local/lib/python2.7/site-packages/osgeo/__init__.py", line 17, in swig_import_helper
>     _mod = imp.load_module('_gdal', fp, pathname, description)
> ImportError: dlopen(/usr/local/lib/python2.7/site-packages/osgeo/_gdal.so, 2): Library not loaded: libpng15.15.dylib
>   Referenced from: /usr/local/Cellar/gdal/1.10.0/lib/libgdal.1.dylib
>   Reason: image not found
> 
> 
> any help would be appreciated.
> Thanks
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-----
William Kyngesburye <kyngchaos*at*kyngchaos*dot*com>
http://www.kyngchaos.com/

All generalizations are dangerous, even this one.



From even.rouault at mines-paris.org  Fri Jul  5 15:29:49 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 6 Jul 2013 00:29:49 +0200
Subject: [gdal-dev] Reading gml with schema
In-Reply-To: <003401ce5d1c$9904d020$cb0e7060$@gispo.fi>
References: <CAKWoFMJy5Rj_XMDfadUoAa2FOJ2Xkz325ZAu4PtGL9-DdOS1sA@mail.gmail.com>
	<201305291656.15062.even.rouault@mines-paris.org>
	<003401ce5d1c$9904d020$cb0e7060$@gispo.fi>
Message-ID: <201307060029.49879.even.rouault@mines-paris.org>

Le jeudi 30 mai 2013 12:01:04, Pekka Sarkola a ?crit :
> Hi Folks,
> 
> Ari: thanks to raise my head. I'm now member of (also) this mailing list.
> 
> Yes, it seems that NLSFI has very unique way to create those GML's. However
> I have understood that they like pretty much follow INSPIRE guidelines.
> So, this kind of GML's could be common in Europe, soon.
> 
> I think there will few possibilities:
> - Ask NLSFI to change their GML specs more like OGC GML simple features.
> - Create NLSFI specific drivers for GDAL
> - Develop GDAL's driver format to better support "non-simple-features"
> GML/XML. - Make best practices how to use XSLT to convert
> "non-simple-features" GML to "simple features" GML - something else...
> 

As a follow-up to this topic, I wanted to inform that I've just committed in 
GDAL trunk an update of the GML driver so that it can read natively NLS 
Topographic data in this MTK GML format.

e.g: ogrinfo ~/gdal/data/gml/finland_gml/Q3334R.xml -al

INFO: Open of `/home/even/gdal/data/gml/finland_gml/Q3334R.xml'
      using driver `GML' successful.

Layer name: Autoliikennealue
Geometry: 3D Polygon
Feature Count: 19
Extent: (296500.277000, 7062000.000000) - (307306.219000, 7073355.258000)
Layer SRS WKT:
PROJCS["ETRS89 / TM35FIN(E,N)",
    GEOGCS["ETRS89",
        DATUM["European_Terrestrial_Reference_System_1989",
            SPHEROID["GRS 1980",6378137,298.257222101,
                AUTHORITY["EPSG","7019"]],
            TOWGS84[0,0,0,0,0,0,0],
            AUTHORITY["EPSG","6258"]],
        PRIMEM["Greenwich",0,
            AUTHORITY["EPSG","8901"]],
        UNIT["degree",0.0174532925199433,
            AUTHORITY["EPSG","9122"]],
        AUTHORITY["EPSG","4258"]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",27],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AXIS["Easting",EAST],
    AXIS["Northing",NORTH],
    AUTHORITY["EPSG","3067"]]
gid: String (0.0)
sijaintitarkkuus: Integer (0.0)
aineistolahde: Integer (0.0)
alkupvm: String (0.0)
kohderyhma: Integer (0.0)
kohdeluokka: Integer (0.0)
OGRFeature(Autoliikennealue):0
  gid (String) = 260092169
  sijaintitarkkuus (Integer) = 20000
  aineistolahde (Integer) = 1
  alkupvm (String) = 2008-12-11
  kohderyhma (Integer) = 64
  kohdeluokka (Integer) = 32421
  POLYGON ((307305.971 7071615.08899999969 15.817,307306.219 7071577.023 
15.817,307293.141 7071576.687 15.49,307264.592 7071583.809 15.163,307271.123 
7071616.96899999958 15.49,307305.971 7071615.08899999969 15.817))

[...]

Best regards,

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From Dominik.Schneider at Colorado.EDU  Fri Jul  5 23:44:47 2013
From: Dominik.Schneider at Colorado.EDU (Dominik Schneider)
Date: Sat, 6 Jul 2013 00:44:47 -0600
Subject: [gdal-dev] gdal_merge.py won't load libpng
In-Reply-To: <CFFF1B68-1337-4304-B4CE-E1F81F6D9BD4@kyngchaos.com>
References: <CAHYDKLbxQgF3bxMDffK4SJ9kRdx1Wi9mk3FKtvunEKwki5xRDA@mail.gmail.com>
	<CAHYDKLamQKpS7gYz6FSB0YWyiY9O6f0xUQP=TCe9N4+Oam2Mfg@mail.gmail.com>
	<CFFF1B68-1337-4304-B4CE-E1F81F6D9BD4@kyngchaos.com>
Message-ID: <CAHYDKLZuU3-fQRfT7M4Bw6aDX5cbWNT9h5FDvHqmUTa6SSBDOg@mail.gmail.com>

Yes, anaconda is a python distribution. Unfortunate that those don't play
nice.
Confusion was indeed the problem. I deleted the /usr/local/lib/python2.7
folder and uninstalled the brew gdal. I reinstalled GDAL Complete 1.10
framework and was getting an import error:

iMac:~ $ gdal_merge.py
Traceback (most recent call last):
  File "/Library/Frameworks/GDAL.framework/Programs/gdal_merge.py", line
36, in <module>
    import gdal
ImportError: No module named gdal
iMac:~ $

I tried the export PYTHONPATH=... but it didn't help until I removed
anaconda from my path and now the function works. thanks a lot for your
help.

Dominik Schneider
o 303.735.6296 | c 518.956.3978



On Fri, Jul 5, 2013 at 4:13 PM, William Kyngesburye
<woklist at kyngchaos.com>wrote:

> Looks like a confused gdal and python installation mess...
>
> If you're using my GDAL framework, it uses my UnixImageIO framework for
> libpng.  And, the included gdal-python uses the system python.
>
> But according to the error python is looking for python modules (thus
> gdal-python) in /usr/local.  This implies that the system python is NOT
> running, but a custom install (is that what anaconda is?), with it's own
> python module search path.  I'm guessing that the anaconda python (?) is in
> /usr/local/bin and thus be found before the system python.
>
> PYTHONPATH might work to redirect your custom python to look for the
> correct gdal-python:
>
>   export
> PYTHON_PATH=/Library/Frameworks/GDAL.framework/Versions/1.10/Python/2.7/site-packages
>
> If not, you'll have to uninstall your custom python (anaconda? homebrew?)
> so it doesn't override the system python.
>
> On Jul 5, 2013, at 2:39 PM, Dominik Schneider wrote:
>
> > anyone have any suggestions?! I'm at a complete loss how to troubleshoot.
> >
> >
> > Dominik Schneider
> > o 303.735.6296 | c 518.956.3978
> >
> >
> >
> > On Tue, Jul 2, 2013 at 10:52 AM, Dominik Schneider <
> dominik.schneider at colorado.edu> wrote:
> > Hi,
> > I am trying to run:
> > gdal_merge.py -init -9999 -n 2001 -o
> MOD09GA.A2012001.h08v05.005.NRTsnow_fraction.tif.1
> MOD09GA.A2012001.h08v05.005.NRTsnow_fraction.tif
> >
> > The Error:
> > Traceback (most recent call last):
> >   File "/Library/Frameworks/GDAL.framework/Programs/gdal_merge.py", line
> 36, in <module>
> >     import gdal
> >   File "/usr/local/lib/python2.7/site-packages/gdal.py", line 2, in
> <module>
> >     from osgeo.gdal import deprecation_warn
> >   File "/usr/local/lib/python2.7/site-packages/osgeo/__init__.py", line
> 21, in <module>
> >     _gdal = swig_import_helper()
> >   File "/usr/local/lib/python2.7/site-packages/osgeo/__init__.py", line
> 17, in swig_import_helper
> >     _mod = imp.load_module('_gdal', fp, pathname, description)
> > ImportError:
> dlopen(/usr/local/lib/python2.7/site-packages/osgeo/_gdal.so, 2): Library
> not loaded: libpng15.15.dylib
> >   Referenced from: /usr/local/Cellar/gdal/1.10.0/lib/libgdal.1.dylib
> >   Reason: image not found
> >
> > Gdal is here:
> > > which gdal_merge.py
> > /Library/Frameworks/GDAL.framework/Programs/gdal_merge.py
> >
> > I'm completely new gdal but am guessing i've got some confusion between
> different versions of gdal and python.  I have rgdal installed so at some
> point in the past I probably installed gdal too? Today I installed gdal
> with homebrew and also tried the binary from
> http://www.kyngchaos.com/software:frameworks
> > For python I have the system default (2.7) on osx.7.5 and the anaconda
> installation.
> >
> > I should also say, if I load python I am unable to import gdal:
> > > python
> > Python 2.7.4 |Anaconda 1.5.1 (x86_64)| (default, May  9 2013, 12:12:00)
> > [GCC 4.0.1 (Apple Inc. build 5493)] on darwin
> > Type "help", "copyright", "credits" or "license" for more information.
> > >>> from osgeo import gdal
> > Traceback (most recent call last):
> >   File "<stdin>", line 1, in <module>
> >   File "/usr/local/lib/python2.7/site-packages/osgeo/__init__.py", line
> 21, in <module>
> >     _gdal = swig_import_helper()
> >   File "/usr/local/lib/python2.7/site-packages/osgeo/__init__.py", line
> 17, in swig_import_helper
> >     _mod = imp.load_module('_gdal', fp, pathname, description)
> > ImportError:
> dlopen(/usr/local/lib/python2.7/site-packages/osgeo/_gdal.so, 2): Library
> not loaded: libpng15.15.dylib
> >   Referenced from: /usr/local/Cellar/gdal/1.10.0/lib/libgdal.1.dylib
> >   Reason: image not found
> >
> >
> > any help would be appreciated.
> > Thanks
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -----
> William Kyngesburye <kyngchaos*at*kyngchaos*dot*com>
> http://www.kyngchaos.com/
>
> All generalizations are dangerous, even this one.
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130706/a89a0f01/attachment-0001.html>

From nik at nikosalexandris.net  Sun Jul  7 12:41:14 2013
From: nik at nikosalexandris.net (Nikos Alexandris)
Date: Sun, 07 Jul 2013 22:41:14 +0300
Subject: [gdal-dev] Can't read NITF image
Message-ID: <4551141.CTl26yuLIT@localhost>

Hi!

I am trying to access an  .ntf  image.

gdalinfo /Some_Path/03APR13WV010500013APR03073140-
P1BS-500060446050_03_P002.ntf -noct -nomd -nogcp -sd 1

ERROR 4: `/vsisubfile/3884_478612158,/Some_Path/03APR13WV010500013APR03073140-
P1BS-500060446050_03_P002.ntf' not recognised as a supported file format.

ERROR 1: Unable to open JPEG2000 image within NITF file.
No JPEG2000 capable driver (JP2KAK, JP2ECW, JP2MRSID, JP2OPENJPEG, etc...) is 
available.
You can define the NITF_OPEN_UNDERLYING_DS configuration option to NO, in order 
to just get the metadata.
gdalinfo failed - unable to open '/Some_Path/03APR13WV010500013APR03073140-
P1BS-500060446050_03_P002.ntf'.


Indeed,

gdalinfo --formats | grep JPEG
  JPEG (rwv): JPEG JFIF

there is no JPEG2000 support (working in Funtoo, gdal installed via portage, I 
think this: <http://gpo.zugaina.org/AJAX/Ebuild/2502482/View>)


Setting

export NITF_OPEN_UNDERLYING_DS=NO

let's me read the metadata.


Is this a *generic* problem or else, if I compile  --with-jasper  support will 
allow for reading this image?  And, subsequently, import via r.in.gdal in 
GRASS-GIS?

Thank you, Nikos

From even.rouault at mines-paris.org  Sun Jul  7 13:00:06 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sun, 7 Jul 2013 22:00:06 +0200
Subject: [gdal-dev] Can't read NITF image
In-Reply-To: <4551141.CTl26yuLIT@localhost>
References: <4551141.CTl26yuLIT@localhost>
Message-ID: <201307072200.06181.even.rouault@mines-paris.org>

Le dimanche 07 juillet 2013 21:41:14, Nikos Alexandris a ?crit :
> Hi!
> 
> I am trying to access an  .ntf  image.
> 
> gdalinfo /Some_Path/03APR13WV010500013APR03073140-
> P1BS-500060446050_03_P002.ntf -noct -nomd -nogcp -sd 1
> 
> ERROR 4:
> `/vsisubfile/3884_478612158,/Some_Path/03APR13WV010500013APR03073140-
> P1BS-500060446050_03_P002.ntf' not recognised as a supported file format.
> 
> ERROR 1: Unable to open JPEG2000 image within NITF file.
> No JPEG2000 capable driver (JP2KAK, JP2ECW, JP2MRSID, JP2OPENJPEG, etc...)
> is available.
> You can define the NITF_OPEN_UNDERLYING_DS configuration option to NO, in
> order to just get the metadata.
> gdalinfo failed - unable to open '/Some_Path/03APR13WV010500013APR03073140-
> P1BS-500060446050_03_P002.ntf'.
> 
[...]
> Is this a *generic* problem or else, if I compile  --with-jasper  support
> will allow for reading this image? 

This is a problem you'll run into each time you will open a NITF image whose 
imagery is compressed as a JPEG2000 codestream. Compiling --with-jasper might 
help, but if your image is big, it might not work since jasper reads the whole 
image into memory. If you run into this memory problem, you might use OpenJPEG 
2 instead (provided you use GDAL 1.10), or else one of the proprietary 
implementation.

> And, subsequently, import viar.in.gdal in GRASS-GIS?

If gdalinfo can open it, then it should work with r.in.gdal.

> 
> Thank you, Nikos
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From nik at nikosalexandris.net  Sun Jul  7 16:36:40 2013
From: nik at nikosalexandris.net (Nikos Alexandris)
Date: Mon, 08 Jul 2013 02:36:40 +0300
Subject: [gdal-dev] Can't read NITF image
In-Reply-To: <201307072200.06181.even.rouault@mines-paris.org>
References: <4551141.CTl26yuLIT@localhost>
	<201307072200.06181.even.rouault@mines-paris.org>
Message-ID: <2595477.BXpE9Y7zyA@localhost>

Nikos Alexandris a ?crit :

> > I am trying to access an  .ntf  image.

> > gdalinfo /Some_Path/03APR13WV010500013APR03073140-
> > P1BS-500060446050_03_P002.ntf -noct -nomd -nogcp -sd 1

> > ERROR 4:
> > `/vsisubfile/3884_478612158,/Some_Path/03APR13WV010500013APR03073140-
> > P1BS-500060446050_03_P002.ntf' not recognised as a supported file format.

[..]

> > Is this a *generic* problem or else, if I compile  --with-jasper  support
> > will allow for reading this image?


Even Rouault wrote:

> This is a problem you'll run into each time you will open a NITF image whose
> imagery is compressed as a JPEG2000 codestream. Compiling --with-jasper
> might help, but if your image is big, it might not work since jasper reads
> the whole image into memory. If you run into this memory problem, you might
> use OpenJPEG 2 instead (provided you use GDAL 1.10),

O-K, looks much better now:

gdalinfo --version && gdalinfo --formats | grep JP
                                     
GDAL 1.10.0, released 2013/04/24                                                                         
  JPEG (rwv): JPEG JFIF
  JP2OpenJPEG (rwv): JPEG-2000 driver based on OpenJPEG library
  JPEG2000 (rwv): JPEG-2000 part 1 (ISO/IEC 15444-1)


e.g.

gdalinfo -nogcp -nomd -noct 03APR13WV010500013APR03073140-
P1BS-500060446050_03_P002.ntf

Driver: NITF/National Imagery Transmission Format
Files: 03APR13WV010500013APR03073140-P1BS-500060446050_03_P002.ntf
Size is 35840, 27648
Coordinate System is `'
Subdatasets:
  SUBDATASET_1_NAME=NITF_IM:0:03APR13WV010500013APR03073140-
P1BS-500060446050_03_P002.ntf
  SUBDATASET_1_DESC=Image 1 of 03APR13WV010500013APR03073140-
P1BS-500060446050_03_P002.ntf

[..]

Corner Coordinates:

[..]

Band 1 Block=1024x1024 Type=UInt16, ColorInterp=Gray
  Overviews: 17920x13824, 8960x6912, 4480x3456, 2240x1728, 1120x864
  Overviews: arbitrary
Warning 1: Unable to save auxilary information in 
/vsisubfile/3884_478612158,03APR13WV010500013APR03073140-
P1BS-500060446050_03_P002.ntf.aux.xml.

[more Warnings]


Question:  how can I tell which driver is used?  Just empirically, e.g. Jasper 
precedes OpenJPEG2?  Oh well, I'll have to search in the manuals I guess...



> or else one of the proprietary implementation.

I've been through posts in the list and reading details in 

<http://trac.osgeo.org/gdal/wiki/ECW>, 
<http://trac.osgeo.org/gdal/wiki/JasPer>, 
<http://trac.osgeo.org/gdal/wiki/JP2KAK>, 
<http://trac.osgeo.org/gdal/wiki/MrSID>

So, what's the take-home message for an average QGIS user for example?  I am 
not critisising -- just being curious, honestly.


Milles Mercis Even,
Nikos

From nik at nikosalexandris.net  Sun Jul  7 16:53:29 2013
From: nik at nikosalexandris.net (Nikos Alexandris)
Date: Mon, 08 Jul 2013 02:53:29 +0300
Subject: [gdal-dev] Can't read NITF image
In-Reply-To: <2595477.BXpE9Y7zyA@localhost>
References: <4551141.CTl26yuLIT@localhost>
	<201307072200.06181.even.rouault@mines-paris.org>
	<2595477.BXpE9Y7zyA@localhost>
Message-ID: <6232803.mqyd8g3Tiq@localhost>

Nikos Alexandris wrote:

> Question:  how can I tell which driver is used?  Just empirically, e.g.
> Jasper precedes OpenJPEG2?  Oh well, I'll have to search in the manuals I
> guess...

gdalinfo --formats | grep JP

  JPEG (rwv): JPEG JFIF
  JP2OpenJPEG (rwv): JPEG-2000 driver based on OpenJPEG library
  JPEG2000 (rwv): JPEG-2000 part 1 (ISO/IEC 15444-1)


According to <http://trac.osgeo.org/gdal/wiki/ConfigOptions>, GDAL_SKIP:

export GDAL_SKIP="JPEG JPEG2000" && gdalinfo --formats | grep JP

JP2OpenJPEG (rwv): JPEG-2000 driver based on OpenJPEG library


Nice!  Thanks, Nikos

From nik at nikosalexandris.net  Sun Jul  7 18:35:50 2013
From: nik at nikosalexandris.net (Nikos Alexandris)
Date: Mon, 08 Jul 2013 04:35:50 +0300
Subject: [gdal-dev] Can't read NITF image
In-Reply-To: <6232803.mqyd8g3Tiq@localhost>
References: <4551141.CTl26yuLIT@localhost> <2595477.BXpE9Y7zyA@localhost>
	<6232803.mqyd8g3Tiq@localhost>
Message-ID: <4930893.bjhsVa7G7h@localhost>

All works fine.  A quick one-liner example to get the image(s):

for INPUT in `gdalinfo 03APR13WV010500013APR03073140-
P1BS-500060446050_03_P002.ntf | grep SUBDATASET_ | grep NAME | cut -d":" -f3`; 
do gdalwarp -s_srs 'epsg:4326' -t_srs 'epsg:4326' "${INPUT}" "${INPUT}.tif"; 
done

Are there smarter ways to do that?

Thanks, Nikos

From nik at nikosalexandris.net  Mon Jul  8 02:37:10 2013
From: nik at nikosalexandris.net (Nikos Alexandris)
Date: Mon, 08 Jul 2013 12:37:10 +0300
Subject: [gdal-dev] Option to supress gdalinfo's Warning messages
Message-ID: <1607451.Ri1ptfEpT0@localhost>

Dear GDAL-ers,

Is there a configuration option for GDAL to supress (gdalinfo) warnings like

"Warning 1: Unable to save auxilary information in 
/vsisubfile/3884_478612158,..."

?

I can't seem to find something in either 
<http://trac.osgeo.org/gdal/wiki/ConfigOptions> or 
<http://www.gdal.org/gdalinfo.html>.

Kind regards, Nikos

From swdmike at hotmail.com  Mon Jul  8 05:15:34 2013
From: swdmike at hotmail.com (swdmike)
Date: Mon, 8 Jul 2013 05:15:34 -0700 (PDT)
Subject: [gdal-dev] How to use JP2OpenJPEG with C#?
Message-ID: <1373285734766-5064685.post@n6.nabble.com>

According to "GDAL Raster Formats",GDAL supports JP2 with OpenJPEG library
(v2). So I download openjpeg-2.0.0-win32-x86.zip , but I do not know how to
use it. I copy all the dlls in the bin folder to my project's debug folder
and write "Driver drv = Gdal.GetDriverByName("JP2OpenJPEG");", but the
driver is null.

Anyone knows how to create a JP2 file?

Thanks.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-How-to-use-JP2OpenJPEG-with-C-tp5064685.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From szekerest at gmail.com  Mon Jul  8 05:32:26 2013
From: szekerest at gmail.com (Tamas Szekeres)
Date: Mon, 8 Jul 2013 14:32:26 +0200
Subject: [gdal-dev] How to use JP2OpenJPEG with C#?
In-Reply-To: <1373285734766-5064685.post@n6.nabble.com>
References: <1373285734766-5064685.post@n6.nabble.com>
Message-ID: <CACALY+Sa0XtxDkz6Z2KEhMDrQF=h6otZ6cG2S6PbK0Q8hB11QA@mail.gmail.com>

You might also use one of the precompiled binary packages from
http://www.gisinternals.com/sdk/

Best regards,

Tamas



2013/7/8 swdmike <swdmike at hotmail.com>

> According to "GDAL Raster Formats",GDAL supports JP2 with OpenJPEG library
> (v2). So I download openjpeg-2.0.0-win32-x86.zip , but I do not know how to
> use it. I copy all the dlls in the bin folder to my project's debug folder
> and write "Driver drv = Gdal.GetDriverByName("JP2OpenJPEG");", but the
> driver is null.
>
> Anyone knows how to create a JP2 file?
>
> Thanks.
>
>
>
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/gdal-dev-How-to-use-JP2OpenJPEG-with-C-tp5064685.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130708/2df2a75f/attachment.html>

From Anthony.W.Baker at boeing.com  Mon Jul  8 07:59:01 2013
From: Anthony.W.Baker at boeing.com (Baker, Anthony W)
Date: Mon, 8 Jul 2013 14:59:01 +0000
Subject: [gdal-dev] Feature (geometry and attributes) to GeoJSON
In-Reply-To: <CACALY+Sa0XtxDkz6Z2KEhMDrQF=h6otZ6cG2S6PbK0Q8hB11QA@mail.gmail.com>
References: <1373285734766-5064685.post@n6.nabble.com>
	<CACALY+Sa0XtxDkz6Z2KEhMDrQF=h6otZ6cG2S6PbK0Q8hB11QA@mail.gmail.com>
Message-ID: <1106E45778F04E4D94505A07DD749912033C24@XCH-PHX-403.sw.nos.boeing.com>

I would like to export a single feature to GeoJSON format and have successfully used OGR_G_ExportToJson to convert the geometry to a character string GeoJSON format.  Is there a similar function for converting a feature to a character string GeoJSON format (including geometry and attribute information)?

Thank you,

Anthony

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130708/753af6c7/attachment-0001.html>

From mateusz at loskot.net  Mon Jul  8 08:08:07 2013
From: mateusz at loskot.net (Mateusz Loskot)
Date: Mon, 8 Jul 2013 16:08:07 +0100
Subject: [gdal-dev] Feature (geometry and attributes) to GeoJSON
In-Reply-To: <1106E45778F04E4D94505A07DD749912033C24@XCH-PHX-403.sw.nos.boeing.com>
References: <1373285734766-5064685.post@n6.nabble.com>
	<CACALY+Sa0XtxDkz6Z2KEhMDrQF=h6otZ6cG2S6PbK0Q8hB11QA@mail.gmail.com>
	<1106E45778F04E4D94505A07DD749912033C24@XCH-PHX-403.sw.nos.boeing.com>
Message-ID: <CABUeae9s=HZir_zwqS9gWPguO31Vi73qEJ1A3yoBzhfM7r-jCQ@mail.gmail.com>

On 8 July 2013 15:59, Baker, Anthony W <Anthony.W.Baker at boeing.com> wrote:
> I would like to export a single feature to GeoJSON format and have
> successfully used OGR_G_ExportToJson to convert the geometry to a character
> string GeoJSON format.  Is there a similar function for converting a feature
> to a character string GeoJSON format (including geometry and attribute
> information)?

AFAIK, there is no such API and that's why Python bindings provide
custom method Feature.ExportToJson defined here:

http://svn.osgeo.org/gdal/trunk/gdal/swig/python/osgeo/ogr.py

Best regards,
-- 
Mateusz  Loskot, http://mateusz.loskot.net

From j.l.h.hartmann at uva.nl  Mon Jul  8 09:02:49 2013
From: j.l.h.hartmann at uva.nl (Jan Hartmann)
Date: Mon, 08 Jul 2013 18:02:49 +0200
Subject: [gdal-dev] GeomTransform in VRT-file
In-Reply-To: <51D5D3DB.1080406@gmail.com>
References: <51CE0B90.6070109@sri.com>	<CABUeae-u=P9JpwieXrDY1QA=_ss8crkMEtu+xXfbcPPVKUcvSw@mail.gmail.com>	<51CEEAEB.9080208@sri.com>
	<CA+YzLBdgY42X-Vun77cJaMTfA0sqg0OM3AKvK6BR0axrxJQTmA@mail.gmail.com>
	<51D59EF0.5070105@uva.nl> <51D5D3DB.1080406@gmail.com>
Message-ID: <51DAE2A9.1070003@uva.nl>

Reading the documentation always helps. The GeomTransform takes the 
upper left corner as the origin, not the lower left, as in my math 
handbook. And the order of the coefficients is  <c b a f e d> With some 
twiddling of angles and signs I now can compute the affine 
transformation of a scan based on two control points. That means that 
with the vrt-file and its geomtransform it is possible to georeference a 
scan in real time without warping, at least for a first order 
polynomial. Marvelous!

Thanks for your help.

Jan

On 07/04/2013 09:58 PM, Dmitriy Baryshnikov wrote:
> Hi Jan,
>
> Do you mean this : http://www.gdal.org/gdal_datamodel.html (Affine 
> GeoTransform srection) or this http://www.gdal.org/gdal_tutorial.html 
> (Getting Dataset Information section)?
> Also, see this: 
> http://www.gdal.org/classVRTDataset.html#a1531325b71e290b90c8d9cc88bce6c2b
>
> Best regards,
>     Dmitriy
>
> 04.07.2013 20:12, Jan Hartmann ?????:
>> I'm struggling with the order of the Geotransform section in a vrt 
>> file. I would like to rotate an image, and computed the six 
>> parameters for the affine transformation. I can transform points 
>> exactly, using the following formula:
>>
>> x2 = a.x1 + b.y1 + c
>> y2 = d.x1 + e.y1 + f
>>
>> Can anyone tell me what the order is in the GeoTransform section of 
>> the VRT-file?
>>
>> <GeoTransform> c a b f d e </GeoTransform>
>>
>> results in an image somewhere in the neighbourhood, but mirrored and 
>> translated. What is the order of the parameters a-f?
>>
>> Jan
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130708/d43bcc7a/attachment.html>

From hilda.villegas at navico.com  Mon Jul  8 09:58:04 2013
From: hilda.villegas at navico.com (Hilda Villegas)
Date: Mon, 8 Jul 2013 16:58:04 +0000
Subject: [gdal-dev] ogr2ogr: ENC to shapefile conversion
Message-ID: <8B0C8942F7080F47B82245E36EAEFB8B3E852843@EXCH01-OKLUS.MARINE.NET.INT>

Hi,

Does the ogr2ogr.exe support lexical level 2 (NATF) attributes when converting from S-57 to shapefile?

I noticed that S-57 Reader has that implementation, is there any special configuration in ogr2ogr to write this kind of characters?

Best regards,
Hilda Villegas



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130708/8c770890/attachment.html>

From even.rouault at mines-paris.org  Mon Jul  8 15:21:20 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 9 Jul 2013 00:21:20 +0200
Subject: [gdal-dev] ogr2ogr: ENC to shapefile conversion
In-Reply-To: <8B0C8942F7080F47B82245E36EAEFB8B3E852843@EXCH01-OKLUS.MARINE.NET.INT>
References: <8B0C8942F7080F47B82245E36EAEFB8B3E852843@EXCH01-OKLUS.MARINE.NET.INT>
Message-ID: <201307090021.20955.even.rouault@mines-paris.org>

Le lundi 08 juillet 2013 18:58:04, Hilda Villegas a ?crit :
> Hi,
> 
> Does the ogr2ogr.exe support lexical level 2 (NATF) attributes when
> converting from S-57 to shapefile?
> 
> I noticed that S-57 Reader has that implementation, is there any special
> configuration in ogr2ogr to write this kind of characters?

If you use GDAL 1.10, this must be covered by the fix done in 
http://trac.osgeo.org/gdal/ticket/5048 .

So try something like to generate a UTF-8 shapefile :

ogr2ogr out_shp in.000 --config OGR_S57_OPTIONS "RECODE_BY_DSSI=ON" \
-lco ENCODING=UTF-8

> 
> Best regards,
> Hilda Villegas

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From ahmettemiz88 at gmail.com  Mon Jul  8 23:44:10 2013
From: ahmettemiz88 at gmail.com (Ahmet Temiz)
Date: Tue, 9 Jul 2013 09:44:10 +0300
Subject: [gdal-dev] tiles with different size, and irregular blocking
Message-ID: <CAJKO1YtY25AWCaTqnjbtkVA=cr3N-uCCQB8+M4STWU_=n2pGPw@mail.gmail.com>

hello

Is there any way to fix this problem:

" tiles with different size, and irregular blocking"


regards
-- 
Ahmet Temiz
Jeoloji M?h.
Afet ve Acil Durum Y?netimi Ba?kanl???
Planlama ve Zarar Azaltma Dairesi Ba?kanl???


________________________

Ahmet Temiz
Geological Eng.
Information Systems - GIS Group
Disaster and Emergency Management
of Presidency
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130709/5d74bd69/attachment.html>

From jrepetto at free.fr  Tue Jul  9 00:42:26 2013
From: jrepetto at free.fr (Jean-Claude Repetto)
Date: Tue, 09 Jul 2013 09:42:26 +0200
Subject: [gdal-dev] tiles with different size, and irregular blocking
In-Reply-To: <CAJKO1YtY25AWCaTqnjbtkVA=cr3N-uCCQB8+M4STWU_=n2pGPw@mail.gmail.com>
References: <CAJKO1YtY25AWCaTqnjbtkVA=cr3N-uCCQB8+M4STWU_=n2pGPw@mail.gmail.com>
Message-ID: <51DBBEE2.9020304@free.fr>

Le 09/07/2013 08:44, Ahmet Temiz a ?crit :
> hello
>
> Is there any way to fix this problem:
>
> " tiles with different size, and irregular blocking"
>
>
> regards


Please read this page carefully :
http://www.chiark.greenend.org.uk/~sgtatham/bugs.html

Regards


From even.rouault at mines-paris.org  Tue Jul  9 01:23:16 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 09 Jul 2013 10:23:16 +0200
Subject: [gdal-dev] tiles with different size, and irregular blocking
In-Reply-To: <CAJKO1YtY25AWCaTqnjbtkVA=cr3N-uCCQB8+M4STWU_=n2pGPw@mail.gmail.com>
References: <CAJKO1YtY25AWCaTqnjbtkVA=cr3N-uCCQB8+M4STWU_=n2pGPw@mail.gmail.com>
Message-ID: <1373358196.51dbc874714da@imp.free.fr>

Selon Ahmet Temiz <ahmettemiz88 at gmail.com>:

> hello
>
> Is there any way to fix this problem:
>
> " tiles with different size, and irregular blocking"

Hi,

Please give more context when you ask a question : at least the GDAL version
used, and the action you did when you got this message...

I had a hard time to figure out where this message come from. It seems that you
are using the PostgisRaster driver in GDAL 1.9 (or perhaps older), and that your
PostgisRaster table has tiles with different size and irregular blocking (the
error message is quite clear on that ;-)). This limitation is removed in GDAL
1.10, so upgrade !

Regards,

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From Anthony.W.Baker at boeing.com  Tue Jul  9 10:58:00 2013
From: Anthony.W.Baker at boeing.com (Baker, Anthony W)
Date: Tue, 9 Jul 2013 17:58:00 +0000
Subject: [gdal-dev] Feature (geometry and attributes) to GeoJSON
In-Reply-To: <CABUeae9s=HZir_zwqS9gWPguO31Vi73qEJ1A3yoBzhfM7r-jCQ@mail.gmail.com>
References: <1373285734766-5064685.post@n6.nabble.com>
	<CACALY+Sa0XtxDkz6Z2KEhMDrQF=h6otZ6cG2S6PbK0Q8hB11QA@mail.gmail.com>
	<1106E45778F04E4D94505A07DD749912033C24@XCH-PHX-403.sw.nos.boeing.com>
	<CABUeae9s=HZir_zwqS9gWPguO31Vi73qEJ1A3yoBzhfM7r-jCQ@mail.gmail.com>
Message-ID: <1106E45778F04E4D94505A07DD74991203505A@XCH-PHX-403.sw.nos.boeing.com>

Thank you for your response!

Is it possible to use the json_object directly with something like 
       json_object *json = OGRGeoJSONWriteFeature(poFeature);
Then just convert that to string?

I seem to get an error in json_object.h when I try this method with "boolean redefinition".

Anthony 

From mateusz at loskot.net  Tue Jul  9 11:17:23 2013
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue, 9 Jul 2013 19:17:23 +0100
Subject: [gdal-dev] Feature (geometry and attributes) to GeoJSON
In-Reply-To: <1106E45778F04E4D94505A07DD74991203505A@XCH-PHX-403.sw.nos.boeing.com>
References: <1373285734766-5064685.post@n6.nabble.com>
	<CACALY+Sa0XtxDkz6Z2KEhMDrQF=h6otZ6cG2S6PbK0Q8hB11QA@mail.gmail.com>
	<1106E45778F04E4D94505A07DD749912033C24@XCH-PHX-403.sw.nos.boeing.com>
	<CABUeae9s=HZir_zwqS9gWPguO31Vi73qEJ1A3yoBzhfM7r-jCQ@mail.gmail.com>
	<1106E45778F04E4D94505A07DD74991203505A@XCH-PHX-403.sw.nos.boeing.com>
Message-ID: <CABUeae8F28pZJGSZohYnOGc=5givi9+Rr_oVhvJKQh-ujoQxtQ@mail.gmail.com>

On 9 July 2013 18:58, Baker, Anthony W <Anthony.W.Baker at boeing.com> wrote:
> Thank you for your response!
>
> Is it possible to use the json_object directly with something like
>        json_object *json = OGRGeoJSONWriteFeature(poFeature);
> Then just convert that to string?

I'm sure it is. You've got the source, you can include whatever
GDAL headers you like and use whatever is exposed from the binary.

> I seem to get an error in json_object.h when I try this method with "boolean redefinition".

You may need to apply some fixes for your compiler.

Best regards,
--
Mateusz  Loskot, http://mateusz.loskot.net

From Anthony.W.Baker at boeing.com  Tue Jul  9 12:07:45 2013
From: Anthony.W.Baker at boeing.com (Baker, Anthony W)
Date: Tue, 9 Jul 2013 19:07:45 +0000
Subject: [gdal-dev] Feature (geometry and attributes) to GeoJSON
In-Reply-To: <CABUeae8F28pZJGSZohYnOGc=5givi9+Rr_oVhvJKQh-ujoQxtQ@mail.gmail.com>
References: <1373285734766-5064685.post@n6.nabble.com>
	<CACALY+Sa0XtxDkz6Z2KEhMDrQF=h6otZ6cG2S6PbK0Q8hB11QA@mail.gmail.com>
	<1106E45778F04E4D94505A07DD749912033C24@XCH-PHX-403.sw.nos.boeing.com>
	<CABUeae9s=HZir_zwqS9gWPguO31Vi73qEJ1A3yoBzhfM7r-jCQ@mail.gmail.com>
	<1106E45778F04E4D94505A07DD74991203505A@XCH-PHX-403.sw.nos.boeing.com>
	<CABUeae8F28pZJGSZohYnOGc=5givi9+Rr_oVhvJKQh-ujoQxtQ@mail.gmail.com>
Message-ID: <1106E45778F04E4D94505A07DD74991203509F@XCH-PHX-403.sw.nos.boeing.com>

Seems that when I include the code from say OGR_G_ExportToJSon in my own code, I end up with lots of unresolved link errors.  I guess that the GDAL_i.lib does not expose the functions that I need to use OGRGeoJSONWriteFeature.  Maybe I am just missing something simple???

Anthony




-----Original Message-----
From: Mateusz Loskot [mailto:mateusz at loskot.net] 
Sent: Tuesday, July 09, 2013 2:17 PM
To: Baker, Anthony W
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Feature (geometry and attributes) to GeoJSON

On 9 July 2013 18:58, Baker, Anthony W <Anthony.W.Baker at boeing.com> wrote:
> Thank you for your response!
>
> Is it possible to use the json_object directly with something like
>        json_object *json = OGRGeoJSONWriteFeature(poFeature);
> Then just convert that to string?

I'm sure it is. You've got the source, you can include whatever GDAL headers you like and use whatever is exposed from the binary.

> I seem to get an error in json_object.h when I try this method with "boolean redefinition".

You may need to apply some fixes for your compiler.

Best regards,
--
Mateusz  Loskot, http://mateusz.loskot.net

From even.rouault at mines-paris.org  Tue Jul  9 12:16:57 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 9 Jul 2013 21:16:57 +0200
Subject: [gdal-dev] Feature (geometry and attributes) to GeoJSON
In-Reply-To: <1106E45778F04E4D94505A07DD74991203509F@XCH-PHX-403.sw.nos.boeing.com>
References: <1373285734766-5064685.post@n6.nabble.com>
	<CABUeae8F28pZJGSZohYnOGc=5givi9+Rr_oVhvJKQh-ujoQxtQ@mail.gmail.com>
	<1106E45778F04E4D94505A07DD74991203509F@XCH-PHX-403.sw.nos.boeing.com>
Message-ID: <201307092116.57997.even.rouault@mines-paris.org>

Le mardi 09 juillet 2013 21:07:45, Baker, Anthony W a ?crit :
> Seems that when I include the code from say OGR_G_ExportToJSon in my own
> code, I end up with lots of unresolved link errors.  I guess that the
> GDAL_i.lib does not expose the functions that I need to use
> OGRGeoJSONWriteFeature.  Maybe I am just missing something simple???

Yes this is an internal symbol of GDAL. If you really want it to be exported, 
you can add CPL_DLL in its prototype, but this is at your own risks (= the 
function might have disappeared or be renamed in any future version).

> 
> Anthony
> 
> 
> 
> 
> -----Original Message-----
> From: Mateusz Loskot [mailto:mateusz at loskot.net]
> Sent: Tuesday, July 09, 2013 2:17 PM
> To: Baker, Anthony W
> Cc: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] Feature (geometry and attributes) to GeoJSON
> 
> On 9 July 2013 18:58, Baker, Anthony W <Anthony.W.Baker at boeing.com> wrote:
> > Thank you for your response!
> > 
> > Is it possible to use the json_object directly with something like
> > 
> >        json_object *json = OGRGeoJSONWriteFeature(poFeature);
> > 
> > Then just convert that to string?
> 
> I'm sure it is. You've got the source, you can include whatever GDAL
> headers you like and use whatever is exposed from the binary.
> 
> > I seem to get an error in json_object.h when I try this method with
> > "boolean redefinition".
> 
> You may need to apply some fixes for your compiler.
> 
> Best regards,
> --
> Mateusz  Loskot, http://mateusz.loskot.net
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From bhudspeth at edac.unm.edu  Tue Jul  9 14:30:19 2013
From: bhudspeth at edac.unm.edu (William Hudspeth, Ph.D.)
Date: Tue, 09 Jul 2013 15:30:19 -0600
Subject: [gdal-dev] Unexpected results with GDALDEM
Message-ID: <51DC80EB.1080906@edac.unm.edu>

Hello all,

I am using gdaldem that came with the GDAL 1.7.3 version on Ubuntu 
12.04. I am trying to create slope maps with a command something like this:

gdaldem slope -s scale=111120 source_DEM.tif target_SLOPE.tif

the source DEM geotiff was created with gdalwarp, re-projecting a 
National Elevation Dataset 30 meter, ESRIHdr formatted grid from 
geographic-NAD83 to geographic-WGS84. Based on a thread I found on use 
of 'gdaldem slope' on the web, the re-projection was attempted with both 
a bilinear and cubic re-sampling method.

The target geotiff has values of only 90 and Null. I am getting no 
intermediate values (in degrees, the default).

Thanks for any help in advance,

Bill

From even.rouault at mines-paris.org  Tue Jul  9 14:37:54 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 9 Jul 2013 23:37:54 +0200
Subject: [gdal-dev] Unexpected results with GDALDEM
In-Reply-To: <51DC80EB.1080906@edac.unm.edu>
References: <51DC80EB.1080906@edac.unm.edu>
Message-ID: <201307092337.54305.even.rouault@mines-paris.org>

Le mardi 09 juillet 2013 23:30:19, William Hudspeth, Ph.D. a ?crit :
> Hello all,
> 
> I am using gdaldem that came with the GDAL 1.7.3 version on Ubuntu
> 12.04. I am trying to create slope maps with a command something like this:
> 
> gdaldem slope -s scale=111120 source_DEM.tif target_SLOPE.tif

An error is "-s scale=111120" (which is interpreted as "-s 0"). It must be 
just "-s 111120"

I've just added a validation check in the code so that it would now be 
reported as an error if you use the wrong syntax.

> 
> the source DEM geotiff was created with gdalwarp, re-projecting a
> National Elevation Dataset 30 meter, ESRIHdr formatted grid from
> geographic-NAD83 to geographic-WGS84. Based on a thread I found on use
> of 'gdaldem slope' on the web, the re-projection was attempted with both
> a bilinear and cubic re-sampling method.
> 
> The target geotiff has values of only 90 and Null. I am getting no
> intermediate values (in degrees, the default).
> 
> Thanks for any help in advance,
> 
> Bill
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From giuseppe.amatulli at gmail.com  Wed Jul 10 06:28:52 2013
From: giuseppe.amatulli at gmail.com (Giuseppe Amatulli)
Date: Wed, 10 Jul 2013 09:28:52 -0400
Subject: [gdal-dev] Option to supress gdalinfo's Warning messages
In-Reply-To: <1607451.Ri1ptfEpT0@localhost>
References: <1607451.Ri1ptfEpT0@localhost>
Message-ID: <CAKoiDHLDRC4gLTWSJ3oY9NVOqRZ+okek60JX+04inw29Mk8L5g@mail.gmail.com>

I Nikos
I would do it by redirect the standard error to /dev/null/

http://www.mathinfo.u-picardie.fr/asch/f/MeCS/courseware/users/help/general/unix/redirection.html

ciao



On 8 July 2013 05:37, Nikos Alexandris <nik at nikosalexandris.net> wrote:

> Dear GDAL-ers,
>
> Is there a configuration option for GDAL to supress (gdalinfo) warnings
> like
>
> "Warning 1: Unable to save auxilary information in
> /vsisubfile/3884_478612158,..."
>
> ?
>
> I can't seem to find something in either
> <http://trac.osgeo.org/gdal/wiki/ConfigOptions> or
> <http://www.gdal.org/gdalinfo.html>.
>
> Kind regards, Nikos
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
Giuseppe Amatulli
Web: www.spatial-ecology.net
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130710/0532e84f/attachment.html>

From bhudspeth at edac.unm.edu  Wed Jul 10 09:54:08 2013
From: bhudspeth at edac.unm.edu (William Hudspeth, Ph.D.)
Date: Wed, 10 Jul 2013 10:54:08 -0600
Subject: [gdal-dev] Unexpected results with GDALDEM
In-Reply-To: <201307092337.54305.even.rouault@mines-paris.org>
References: <201307092337.54305.even.rouault@mines-paris.org>
Message-ID: <51DD91B0.7000803@edac.unm.edu>

Je vous remercie....that seems to have worked....

From even.rouault at mines-paris.org  Wed Jul 10 10:13:10 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 10 Jul 2013 19:13:10 +0200
Subject: [gdal-dev] Automated publication of code coverage under GDAL
	autotest suite
Message-ID: <201307101913.10368.even.rouault@mines-paris.org>

Hi devs,

Similarly to what I've just done with MapServer, you can find at the following
URL the continuously updated result of the code coverage under GDAL autotest suite :

http://rawgithub.com/rouault/gdalautotest-coverage-results/master/coverage_html/index.html

This is done by a Travis-CI job that runs on the following modified GIT mirror
of the GDAL svn trunk :

https://github.com/rouault/gdal_coverage

If you are curious about the details, you can read the following messages related
to my similar work on MapServer :

http://lists.osgeo.org/pipermail/mapserver-dev/2013-July/013403.html
http://lists.osgeo.org/pipermail/mapserver-dev/2013-July/013418.html
http://lists.osgeo.org/pipermail/mapserver-dev/2013-July/013424.html

Best regards,

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From ahmettemiz88 at gmail.com  Wed Jul 10 12:20:26 2013
From: ahmettemiz88 at gmail.com (Ahmet Temiz)
Date: Wed, 10 Jul 2013 22:20:26 +0300
Subject: [gdal-dev] dem values bigger than 0
Message-ID: <CAJKO1Yt_BsW+T00GuuXq-adF3BY8vCEq77Z1YNwpLhssD2vLRg@mail.gmail.com>

hello

In a DEM file(tif) , how can I extract values bigger than 0 ?

regards
-- 
Ahmet Temiz
Jeoloji M?h.
Afet ve Acil Durum Y?netimi Ba?kanl???
Planlama ve Zarar Azaltma Dairesi Ba?kanl???


________________________

Ahmet Temiz
Geological Eng.
Information Systems - GIS Group
Disaster and Emergency Management
of Presidency
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130710/c7738c03/attachment.html>

From thare at usgs.gov  Wed Jul 10 16:08:32 2013
From: thare at usgs.gov (Hare, Trent)
Date: Wed, 10 Jul 2013 16:08:32 -0700
Subject: [gdal-dev] dem values bigger than 0
In-Reply-To: <CAJKO1Yt_BsW+T00GuuXq-adF3BY8vCEq77Z1YNwpLhssD2vLRg@mail.gmail.com>
References: <CAJKO1Yt_BsW+T00GuuXq-adF3BY8vCEq77Z1YNwpLhssD2vLRg@mail.gmail.com>
Message-ID: <CAB6t5t_RtNXnmOfOjPT7ZO2c6suZC_xYNge+o3Ls1PHrkR4sKg@mail.gmail.com>

Ahmet,
   Have you looked at gdal_calc.py?
http://svn.osgeo.org/gdal/trunk/gdal/swig/python/scripts/gdal_calc.py

Also in the python *samples *directory there is a val_repl.py (value
replace) script. By switching the line below you can make it greater
or less than a certain value.
original val_repl.py: http://svn.osgeo.org/gdal/trunk/gdal/swig/python/samples

"val_repl_greater.py" is simply the sample "val_repl.py" (from
link above) with one line changed


replace
      scanline =
numpy.choose(numpy.equal(scanline,inNoData),(scanline,outNoData))
with
      scanline =
numpy.choose(numpy.greater(scanline,inNoData),(scanline,outNoData))



good luck,
Trent




On Wed, Jul 10, 2013 at 12:20 PM, Ahmet Temiz <ahmettemiz88 at gmail.com>wrote:

>
> hello
>
> In a DEM file(tif) , how can I extract values bigger than 0 ?
>
> regards
> --
> Ahmet Temiz
> Jeoloji M?h.
> Afet ve Acil Durum Y?netimi Ba?kanl???
> Planlama ve Zarar Azaltma Dairesi Ba?kanl???
>
>
> ________________________
>
> Ahmet Temiz
> Geological Eng.
> Information Systems - GIS Group
> Disaster and Emergency Management
> of Presidency
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130710/73e25de3/attachment.html>

From chenxian at walkinfo.com.cn  Thu Jul 11 00:33:36 2013
From: chenxian at walkinfo.com.cn (Xian Chen)
Date: Thu, 11 Jul 2013 00:33:36 -0700 (PDT)
Subject: [gdal-dev] ogr2ogr bug with dwg file
Message-ID: <1373528016793-5065611.post@n6.nabble.com>

Hi all,

Finally I've got a chance to report something after one-month silence as a
newcomer in the community.
After running ogr2ogr (on Windows 7) to convert a dwg file into shape files,
I received an error message as follows:
/    Warning 6: Normalized/laundered field name: 'ExtendedEntity' to
'ExtendedEn'
    Warning 6: Normalized/laundered field name: 'EntityHandle' to
'EntityHand'
    ERROR 1: Attempt to write non-linestring (POINT) geometry to ARC type
shapefile.

    ERROR 1: Terminating translation prematurely after failed
    translation of layer entities (use -skipfailures to skip errors)/

And then the application exited abnormally.  I read the source code and
found that the last error message was produced by an error from
TranslateLayer(). The application terminated there without calling
OGRCleanupAll()

Therefore I tested reading dwg file on OGR. My conclusion is that
OGRCleanupAll() has to be called explicitly before termination of the whole
application, otherwise an abnormal termination (due to stack overflow??)
will occur.

Is there anyone else having the similar experience? I am thinking of adding
"OGRCleanupAll();" before "exit(1);" in the following ogr2ogr.cpp code:

/            if( !TranslateLayer( poDS, poPassedLayer, poODS, papszLCO, 
                                 pszNewLayerName, bTransform, poOutputSRS,
bNullifyOutputSRS,
                                 poSourceSRS, papszSelFields, bAppend,
eGType,
                                 bOverwrite, eGeomOp, dfGeomOpParam,
papszFieldTypesToString,
                                 nCountLayerFeatures, bWrapDateline,
poClipSrc, poClipDst,
                                 bExplodeCollections, pszZField, pszWHERE,
pfnProgress, pProgressArg))
            {
                CPLError( CE_Failure, CPLE_AppDefined, 
                          "Terminating translation prematurely after
failed\n"
                          "translation from sql statement." );

                exit( 1 );
            }/

Best regards,

Xian



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/ogr2ogr-bug-with-dwg-file-tp5065611.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From ricardo.garcia.silva at gmail.com  Thu Jul 11 04:33:55 2013
From: ricardo.garcia.silva at gmail.com (Ricardo Filipe Soares Garcia da)
Date: Thu, 11 Jul 2013 12:33:55 +0100
Subject: [gdal-dev] closing file descriptors when using python bindings and
	HDF5 datasets
Message-ID: <CAFcNcQbadariopnEysKiwazeA2xdwc5-n+83VmvCPzmj7pFyZA@mail.gmail.com>

Hi all

I am working with HDF5 files and the python bindings to GDAL. I can't seem
to get Python to close the file descriptor whenever I open an HDF5.

It seems to work fine when I use a geotiff, but not with HDF5.

I am using GDAL 1.9.2 on Ubuntu 13.04. I think this is a bug but I'd like
some confirmation, and guidance on how I can I work around this issue. I am
running a script that reaches a Too many open files' error because of this.

I am providing some sample files in [1]. The zip archive contains:
- an HDF5 file (sample1.h5)
- a geotiff file (sample2.tif)
- a python script that just opens and closes the files and outputs
information on open file descriptors (test_open_files.py)

Thanks

[1] - http://ubuntuone.com/6NyUkRjwB98j6HkZT90CZZ


-- 
___________________________ ___ __
Ricardo Garcia Silva
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130711/cca02a89/attachment.html>

From CABO at NIRAS.DK  Thu Jul 11 06:23:26 2013
From: CABO at NIRAS.DK (=?iso-8859-1?Q?Casper_B=F8rgesen_=28CABO=29?=)
Date: Thu, 11 Jul 2013 13:23:26 +0000
Subject: [gdal-dev] GeoTIFF and LZWDecode (LZWEncode?) errors
Message-ID: <BCF6B63AE0B25941A7F56567B58A2805351C6E65@allkexa1.NIRAS.INT>

Hi

When batch processing GeoTIFF files, I tend to get this problem a bit too often:

Warning 1: LZWDecode:LZWDecode: Strip 11 not terminated with EOI code
ERROR 1: LZWDecode:Not enough data at scanline 11 (short 30 bytes)
ERROR 1: TIFFReadEncodedStrip() failed.

band 1: IReadBlock failed at X offset 0, Y offset 11
ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 11

The strip, scanline and offsets vary. It normally happens when I process from clients (computers) with the files located on servers (on local network), and I can reprocess a file again without getting the error, or possible an error with a different strip, scanline or offset. This special case is caused by gdaldem.exe and the error is reported by gdal_translate.exe using GDAL 1.9, but I have experienced this error using GDAL 1.9.2 and I think I saw it using GDAL 1.10 also.

I have two issues here:

1.       Why the problem is happening to begin with?

2.       Why does the Warning and/or Error not trigger ERRORLEVEL 1?

The first bullet I think can be very difficult to debug, so I seek experiences here. The second bullet is really frustrating, because I have to look through all my clients looking for output similar to the message above - and then reprocess all crashed files again.

One solution I have seen somewhere is to not compressing the files, but this results in quite an increase in disk space usage - way too high for me.


Kind regards, Casper
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130711/50a7061c/attachment-0001.html>

From even.rouault at mines-paris.org  Thu Jul 11 06:39:52 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 11 Jul 2013 15:39:52 +0200
Subject: [gdal-dev] GeoTIFF and LZWDecode (LZWEncode?) errors
In-Reply-To: <BCF6B63AE0B25941A7F56567B58A2805351C6E65@allkexa1.NIRAS.INT>
References: <BCF6B63AE0B25941A7F56567B58A2805351C6E65@allkexa1.NIRAS.INT>
Message-ID: <1373549992.51deb5a850afe@imp.free.fr>

Casper,

I'm not sure to have understood if you have this problem while reading or
generating compressed files. Could you provide a way (that is to say provide
both the input data and the command line used) of reproducing this ?

Best regards,

Even


> Hi
>
> When batch processing GeoTIFF files, I tend to get this problem a bit too
> often:
>
> Warning 1: LZWDecode:LZWDecode: Strip 11 not terminated with EOI code
> ERROR 1: LZWDecode:Not enough data at scanline 11 (short 30 bytes)
> ERROR 1: TIFFReadEncodedStrip() failed.
>
> band 1: IReadBlock failed at X offset 0, Y offset 11
> ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 11
>
> The strip, scanline and offsets vary. It normally happens when I process from
> clients (computers) with the files located on servers (on local network), and
> I can reprocess a file again without getting the error, or possible an error
> with a different strip, scanline or offset. This special case is caused by
> gdaldem.exe and the error is reported by gdal_translate.exe using GDAL 1.9,
> but I have experienced this error using GDAL 1.9.2 and I think I saw it using
> GDAL 1.10 also.
>
> I have two issues here:
>
> 1.       Why the problem is happening to begin with?
>
> 2.       Why does the Warning and/or Error not trigger ERRORLEVEL 1?
>
> The first bullet I think can be very difficult to debug, so I seek
> experiences here. The second bullet is really frustrating, because I have to
> look through all my clients looking for output similar to the message above -
> and then reprocess all crashed files again.
>
> One solution I have seen somewhere is to not compressing the files, but this
> results in quite an increase in disk space usage - way too high for me.
>
>
> Kind regards, Casper
>



From CABO at NIRAS.DK  Thu Jul 11 06:56:56 2013
From: CABO at NIRAS.DK (=?iso-8859-1?Q?Casper_B=F8rgesen_=28CABO=29?=)
Date: Thu, 11 Jul 2013 13:56:56 +0000
Subject: [gdal-dev] GeoTIFF and LZWDecode (LZWEncode?) errors
In-Reply-To: <1373549992.51deb5a850afe@imp.free.fr>
References: <BCF6B63AE0B25941A7F56567B58A2805351C6E65@allkexa1.NIRAS.INT>
	<1373549992.51deb5a850afe@imp.free.fr>
Message-ID: <BCF6B63AE0B25941A7F56567B58A2805351C6EA8@allkexa1.NIRAS.INT>

Hi Even.

I cannot reproduce the error, it just occurs when I'm batch processing and not necessarily at the same place/file. That's why I asked for experience. 
However, when I get the error again, I can provide the corrupted file and then its possible to see that ex. Gdal_translate doesn't set ERRORLEVEL 1 or similar even though the process cannot continue.

Kind regards, Casper


-----Original Message-----
From: Even Rouault [mailto:even.rouault at mines-paris.org] 
Sent: 11. juli 2013 15:40
To: Casper B?rgesen (CABO)
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] GeoTIFF and LZWDecode (LZWEncode?) errors

Casper,

I'm not sure to have understood if you have this problem while reading or generating compressed files. Could you provide a way (that is to say provide both the input data and the command line used) of reproducing this ?

Best regards,

Even


> Hi
>
> When batch processing GeoTIFF files, I tend to get this problem a bit 
> too
> often:
>
> Warning 1: LZWDecode:LZWDecode: Strip 11 not terminated with EOI code 
> ERROR 1: LZWDecode:Not enough data at scanline 11 (short 30 bytes) 
> ERROR 1: TIFFReadEncodedStrip() failed.
>
> band 1: IReadBlock failed at X offset 0, Y offset 11 ERROR 1: 
> GetBlockRef failed at X block offset 0, Y block offset 11
>
> The strip, scanline and offsets vary. It normally happens when I 
> process from clients (computers) with the files located on servers (on 
> local network), and I can reprocess a file again without getting the 
> error, or possible an error with a different strip, scanline or 
> offset. This special case is caused by gdaldem.exe and the error is 
> reported by gdal_translate.exe using GDAL 1.9, but I have experienced 
> this error using GDAL 1.9.2 and I think I saw it using GDAL 1.10 also.
>
> I have two issues here:
>
> 1.       Why the problem is happening to begin with?
>
> 2.       Why does the Warning and/or Error not trigger ERRORLEVEL 1?
>
> The first bullet I think can be very difficult to debug, so I seek 
> experiences here. The second bullet is really frustrating, because I 
> have to look through all my clients looking for output similar to the 
> message above - and then reprocess all crashed files again.
>
> One solution I have seen somewhere is to not compressing the files, 
> but this results in quite an increase in disk space usage - way too high for me.
>
>
> Kind regards, Casper
>



From a09550 at gmail.com  Thu Jul 11 08:42:13 2013
From: a09550 at gmail.com (yuchan)
Date: Thu, 11 Jul 2013 08:42:13 -0700 (PDT)
Subject: [gdal-dev] How can I translate MODIS04_L2 AOT as ENVY Modis
 conversion toolkit?
Message-ID: <1373557333765-5065817.post@n6.nabble.com>

Hello every body.

I've a MODIS04 L2, and I want to extract band
8:Image_Optical_Depth_Land_And_Ocean. I use Quantum GIS to open this band,
because Quantum GIS see this is not coordinates so this allow me to select
projection as below: +proj=utm +zone=50 +ellps=WGS84 +datum=WGS84 +units=m
+no_defs +towgs84=0,0,0. 

All I know is that I want to translate to WGS84. This open this band seems
good but when I open this band with ENVI this is better (differents output
images). But I see the Modis Conversion Toolkit use same warp parameters as
Quantum Gis expect it has a parameters ("Numbers of Warp Points").

This is Envi Conversion Toolkit
<http://osgeo-org.1560.x6.nabble.com/file/n5065817/ENVI_MODIS.png> 

This is open file HDF with QuantumGis
<http://osgeo-org.1560.x6.nabble.com/file/n5065817/QuantumGIS1.png> 

This is open Envi output file with Quantum Gis
<http://osgeo-org.1560.x6.nabble.com/file/n5065817/QuantumGIS_Envi.png> 



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/How-can-I-translate-MODIS04-L2-AOT-as-ENVY-Modis-conversion-toolkit-tp5065817.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at mines-paris.org  Thu Jul 11 10:30:07 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 11 Jul 2013 19:30:07 +0200
Subject: [gdal-dev] closing file descriptors when using python bindings
	and HDF5 datasets
In-Reply-To: <CAFcNcQbadariopnEysKiwazeA2xdwc5-n+83VmvCPzmj7pFyZA@mail.gmail.com>
References: <CAFcNcQbadariopnEysKiwazeA2xdwc5-n+83VmvCPzmj7pFyZA@mail.gmail.com>
Message-ID: <201307111930.07347.even.rouault@mines-paris.org>

Le jeudi 11 juillet 2013 13:33:55, Ricardo Filipe Soares Garcia da a ?crit :
> Hi all
> 
> I am working with HDF5 files and the python bindings to GDAL. I can't seem
> to get Python to close the file descriptor whenever I open an HDF5.
> 
> It seems to work fine when I use a geotiff, but not with HDF5.
> 
> I am using GDAL 1.9.2 on Ubuntu 13.04. I think this is a bug but I'd like
> some confirmation, and guidance on how I can I work around this issue. I am
> running a script that reaches a Too many open files' error because of this.
> 
> I am providing some sample files in [1]. The zip archive contains:
> - an HDF5 file (sample1.h5)
> - a geotiff file (sample2.tif)
> - a python script that just opens and closes the files and outputs
> information on open file descriptors (test_open_files.py)

This has been fixed per ticket http://trac.osgeo.org/gdal/ticket/5103 just a 
few weeks ago.

> 
> Thanks
> 
> [1] - http://ubuntuone.com/6NyUkRjwB98j6HkZT90CZZ

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Thu Jul 11 10:43:43 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 11 Jul 2013 19:43:43 +0200
Subject: [gdal-dev] ogr2ogr bug with dwg file
In-Reply-To: <1373528016793-5065611.post@n6.nabble.com>
References: <1373528016793-5065611.post@n6.nabble.com>
Message-ID: <201307111943.43310.even.rouault@mines-paris.org>

Le jeudi 11 juillet 2013 09:33:36, Xian Chen a ?crit :
> Hi all,
> 
> Finally I've got a chance to report something after one-month silence as a
> newcomer in the community.
> After running ogr2ogr (on Windows 7) to convert a dwg file into shape
> files, I received an error message as follows:
> /    Warning 6: Normalized/laundered field name: 'ExtendedEntity' to
> 'ExtendedEn'
>     Warning 6: Normalized/laundered field name: 'EntityHandle' to
> 'EntityHand'
>     ERROR 1: Attempt to write non-linestring (POINT) geometry to ARC type
> shapefile.
> 
>     ERROR 1: Terminating translation prematurely after failed
>     translation of layer entities (use -skipfailures to skip errors)/
> 
> And then the application exited abnormally.  I read the source code and
> found that the last error message was produced by an error from
> TranslateLayer(). The application terminated there without calling
> OGRCleanupAll()
> 
> Therefore I tested reading dwg file on OGR. My conclusion is that
> OGRCleanupAll() has to be called explicitly before termination of the whole
> application, otherwise an abnormal termination (due to stack overflow??)
> will occur.

Hi Xian,

Interesting.

Yes calling OGRCleanupAll() is a best practice, and probably that even the 
error code paths in the utilities should call it, but it shouldn't be 
compulsory to call it.

Looking at the code of the DWG driver, I see that the driver has indeed code 
in its destructor to call the odUninitialize() function. When you call 
OGRCleanupAll() then this code is called. But GDAL has also a DLL clean-up 
code that will call OGRCleanupAll(). I suspect that in that case, some C++ 
automatic objects normally cleaned by odUninitialize() have already been 
destroyed, and at the time odUninitialize() is called, it will access them at 
the time where they are no longer available. Hence the crash.

Being not in position to test it myself, in order to confirm my above guess, 
could you revert your changes in ogr2ogr.cpp and test the attached patch 
(based on GDAL trunk) ?

Best regards,

Even

> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/ogr2ogr-bug-with-dwg-file-tp5065611.ht
> ml Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: disable_dwg_destructor.patch
Type: text/x-patch
Size: 1041 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130711/393e781d/attachment.bin>

From even.rouault at mines-paris.org  Thu Jul 11 10:46:51 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 11 Jul 2013 19:46:51 +0200
Subject: [gdal-dev] GeoTIFF and LZWDecode (LZWEncode?) errors
In-Reply-To: <BCF6B63AE0B25941A7F56567B58A2805351C6EA8@allkexa1.NIRAS.INT>
References: <BCF6B63AE0B25941A7F56567B58A2805351C6E65@allkexa1.NIRAS.INT>
	<1373549992.51deb5a850afe@imp.free.fr>
	<BCF6B63AE0B25941A7F56567B58A2805351C6EA8@allkexa1.NIRAS.INT>
Message-ID: <201307111946.51184.even.rouault@mines-paris.org>

Le jeudi 11 juillet 2013 15:56:56, Casper B?rgesen (CABO) a ?crit :
> Hi Even.
> 
> I cannot reproduce the error, it just occurs when I'm batch processing and
> not necessarily at the same place/file. That's why I asked for experience.
> However, when I get the error again, I can provide the corrupted file and
> then its possible to see that ex. Gdal_translate doesn't set ERRORLEVEL 1
> or similar even though the process cannot continue.

Normally it should return an error, but if the error happens during the 
closing of the dataset (writes might be deferred), then it would go unnoticed. 
That's potentially what happens in your case, but difficult to know without 
closer investigation.

> 
> Kind regards, Casper
> 
> 
> -----Original Message-----
> From: Even Rouault [mailto:even.rouault at mines-paris.org]
> Sent: 11. juli 2013 15:40
> To: Casper B?rgesen (CABO)
> Cc: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] GeoTIFF and LZWDecode (LZWEncode?) errors
> 
> Casper,
> 
> I'm not sure to have understood if you have this problem while reading or
> generating compressed files. Could you provide a way (that is to say
> provide both the input data and the command line used) of reproducing this
> ?
> 
> Best regards,
> 
> Even
> 
> > Hi
> > 
> > When batch processing GeoTIFF files, I tend to get this problem a bit
> > too
> > often:
> > 
> > Warning 1: LZWDecode:LZWDecode: Strip 11 not terminated with EOI code
> > ERROR 1: LZWDecode:Not enough data at scanline 11 (short 30 bytes)
> > ERROR 1: TIFFReadEncodedStrip() failed.
> > 
> > band 1: IReadBlock failed at X offset 0, Y offset 11 ERROR 1:
> > GetBlockRef failed at X block offset 0, Y block offset 11
> > 
> > The strip, scanline and offsets vary. It normally happens when I
> > process from clients (computers) with the files located on servers (on
> > local network), and I can reprocess a file again without getting the
> > error, or possible an error with a different strip, scanline or
> > offset. This special case is caused by gdaldem.exe and the error is
> > reported by gdal_translate.exe using GDAL 1.9, but I have experienced
> > this error using GDAL 1.9.2 and I think I saw it using GDAL 1.10 also.
> > 
> > I have two issues here:
> > 
> > 1.       Why the problem is happening to begin with?
> > 
> > 2.       Why does the Warning and/or Error not trigger ERRORLEVEL 1?
> > 
> > The first bullet I think can be very difficult to debug, so I seek
> > experiences here. The second bullet is really frustrating, because I
> > have to look through all my clients looking for output similar to the
> > message above - and then reprocess all crashed files again.
> > 
> > One solution I have seen somewhere is to not compressing the files,
> > but this results in quite an increase in disk space usage - way too high
> > for me.
> > 
> > 
> > Kind regards, Casper

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From ahmettemiz88 at gmail.com  Fri Jul 12 00:27:14 2013
From: ahmettemiz88 at gmail.com (Ahmet Temiz)
Date: Fri, 12 Jul 2013 10:27:14 +0300
Subject: [gdal-dev] to categorize(reclass) a raster map
Message-ID: <CAJKO1YsDf2Xh7oOczzhP6tehLz1U_WqtGdbvXJ4+u3jmG52Saw@mail.gmail.com>

hello

Is there any way to categorize(reclass)  a raster map ?

for example a slope map as: 0-5,5-10,10-20

regards

-- 
Ahmet Temiz
Jeoloji M?h.
Afet ve Acil Durum Y?netimi Ba?kanl???
Planlama ve Zarar Azaltma Dairesi Ba?kanl???


________________________

Ahmet Temiz
Geological Eng.
Information Systems - GIS Group
Disaster and Emergency Management
of Presidency
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130712/cded1f95/attachment.html>

From rveciana at gmail.com  Fri Jul 12 00:36:43 2013
From: rveciana at gmail.com (Roger Veciana i Rovira)
Date: Fri, 12 Jul 2013 09:36:43 +0200
Subject: [gdal-dev] to categorize(reclass) a raster map
In-Reply-To: <CAJKO1YsDf2Xh7oOczzhP6tehLz1U_WqtGdbvXJ4+u3jmG52Saw@mail.gmail.com>
References: <CAJKO1YsDf2Xh7oOczzhP6tehLz1U_WqtGdbvXJ4+u3jmG52Saw@mail.gmail.com>
Message-ID: <CAJx2no=CXotYYzagv=v2c+tcSTo+LjWtB+Ah3fJaG2uz34y8VQ@mail.gmail.com>

I wrote an entry to a blog explaining how do I do it:

http://geoexamples.blogspot.com/2013/06/gdal-performance-raster-classification.html

Roger


2013/7/12 Ahmet Temiz <ahmettemiz88 at gmail.com>

> hello
>
> Is there any way to categorize(reclass)  a raster map ?
>
> for example a slope map as: 0-5,5-10,10-20
>
> regards
>
> --
> Ahmet Temiz
> Jeoloji M?h.
> Afet ve Acil Durum Y?netimi Ba?kanl???
> Planlama ve Zarar Azaltma Dairesi Ba?kanl???
>
>
> ________________________
>
> Ahmet Temiz
> Geological Eng.
> Information Systems - GIS Group
> Disaster and Emergency Management
> of Presidency
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130712/102e82c4/attachment.html>

From aperi2007 at gmail.com  Fri Jul 12 23:46:10 2013
From: aperi2007 at gmail.com (Andrea Peri)
Date: Sat, 13 Jul 2013 08:46:10 +0200
Subject: [gdal-dev] Convert a csv text file in a dbf file
Message-ID: <CABqTJk8J-DRJg+egka98ygZnn1U9JL0aZbeTs3eGNJPB9OT-3w@mail.gmail.com>

Hi,

I have a csv text file without any geometric field.

I need to convert it in a simple dbf file.

Is this possible to do with ogr2ogr ?

Thx


-- 
-----------------
Andrea Peri
. . . . . . . . .
qwerty ?????
-----------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130713/858ce050/attachment.html>

From afalciano at yahoo.it  Sat Jul 13 01:10:02 2013
From: afalciano at yahoo.it (Antonio Falciano)
Date: Sat, 13 Jul 2013 10:10:02 +0200
Subject: [gdal-dev] Convert a csv text file in a dbf file
In-Reply-To: <CABqTJk8J-DRJg+egka98ygZnn1U9JL0aZbeTs3eGNJPB9OT-3w@mail.gmail.com>
References: <CABqTJk8J-DRJg+egka98ygZnn1U9JL0aZbeTs3eGNJPB9OT-3w@mail.gmail.com>
Message-ID: <51E10B5A.1080308@yahoo.it>

Il 13/07/2013 08:46, Andrea Peri ha scritto:
> Hi,
>
> I have a csv text file without any geometric field.
>
> I need to convert it in a simple dbf file.
>
> Is this possible to do with ogr2ogr ?

ogr2ogr employee.shp employee.csv

Cheers,
Antonio

-- 
Antonio Falciano
http://www.linkedin.com/in/antoniofalciano

From even.rouault at mines-paris.org  Sat Jul 13 01:19:35 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 13 Jul 2013 10:19:35 +0200
Subject: [gdal-dev] Convert a csv text file in a dbf file
In-Reply-To: <CABqTJk8J-DRJg+egka98ygZnn1U9JL0aZbeTs3eGNJPB9OT-3w@mail.gmail.com>
References: <CABqTJk8J-DRJg+egka98ygZnn1U9JL0aZbeTs3eGNJPB9OT-3w@mail.gmail.com>
Message-ID: <201307131019.35648.even.rouault@mines-paris.org>

Le samedi 13 juillet 2013 08:46:10, Andrea Peri a ?crit :
> Hi,
> 
> I have a csv text file without any geometric field.
> 
> I need to convert it in a simple dbf file.
> 
> Is this possible to do with ogr2ogr ?

Yes

$ cat nogeom.csv
id,foo
1,bar

$ ogr2ogr nogeom.dbf nogeom.csv

$ ogrinfo nogeom.dbf -al
INFO: Open of `nogeom.dbf'
      using driver `ESRI Shapefile' successful.

Layer name: nogeom
Geometry: None
Feature Count: 1
Layer SRS WKT:
(unknown)
id: String (80.0)
foo: String (80.0)
OGRFeature(nogeom):0
  id (String) = 1
  foo (String) = bar



> 
> Thx

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From nik at nikosalexandris.net  Sun Jul 14 14:53:18 2013
From: nik at nikosalexandris.net (Nikos Alexandris)
Date: Mon, 15 Jul 2013 00:53:18 +0300
Subject: [gdal-dev] Working with NTF files
Message-ID: <1694187.sUFg9XEByB@resilience>

Hi list & apologies for cross-posting.


In short,

I am trying to handle ntf files (NITF) as easy as possible -- working with 
some WorldView 01/02 and QuickBird imagery.

1) The question is:  how do you correctly import in GRASS-GIS QuickBird & 
WorldView imagery from N(I)TF containers?

2) A second, of less importance, question, is:  how important are the warnings 
like:  "Warning 1: Unable to save auxilary information in 
/vsisubfile/3884_471349721,10APR13WV020600013APR10075059-
P1BS-500060446050_05_P003.ntf.aux.xml." ?


My working solution (seems to be),

is to gdal-warp the SUBDATASET that contains the raster spectral bands _and_ 
by using the -rpc switch (mentioned in some past post in GDAL-dev's ML [19]).  
Otherwise, the resulting warped image is heavily skewed and not ready for 
analysis.  E.g.:

--%<---
gdalwarp -rpc NITF_IM:0:10APR13WV020600013APR10075059-
P1BS-500060446050_05_P003.ntf 10APR13WV020600013APR10075059-
P1BS-500060446050_05_P003_NorthUp.tif
--->%--


This post is, also, sort of a BUMP related to my previous latest message in 
the GDAL-dev-ML's thread entitled  "Can't read NITF images" :-!  I think that 
N(I)TF files, no matter whatsoever the status of the related drivers are, as 
well as the "feelings" towards favouring it or not, deserves some more 
examples, a page in GRASS-Wiki perhaps, etc.


Now, the long story is that,

I 've been through the list (grass-user, gdal-dev), manuals (grass importing 
related stuff & gdal's driver's documentation), well known and easy to find 
pages in GRASS-Wiki, GDAL tutorials, etc.  I haven't found any concrete 
examples on working with NITF images and GFOSS. [**See various links in the 
end]

I would appreciate any hints (while I am actively searching How To do this 
best) to save time in the quest to find an optimal solution which can be 
scripted to handle various images from the same source.  Unfortunately, there 
is no access in GeoTiffs (so far/yet)!

Set aside the internal compression "obstacle" (JPEG2000) which one can 
overcome using the OpenJPEG driver (or, necessarily some proprietary (?) bound 
solution [0, 1, 2, 3]), NITF files that contain multiple SUBDATASETS may look 
like:

# code ###################################################
gdalinfo -nomd -norat -noct -nofl 10APR13WV020600013APR10075059-
P1BS-500060446050_05_P003.ntf

Driver: NITF/National Imagery Transmission Format
Files: 10APR13WV020600013APR10075059-P1BS-500060446050_05_P003.ntf
Size is 35840, 27648
Coordinate System is `'
GCP Projection = 
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563,
            AUTHORITY["EPSG","7030"]],
        TOWGS84[0,0,0,0,0,0,0],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0,
        AUTHORITY["EPSG","8901"]],
    UNIT["degree",0.0174532925199433,
        AUTHORITY["EPSG","9108"]],
    AUTHORITY["EPSG","4326"]]
GCP[  0]: Id=UpperLeft, Info=
          (0.5,0.5) -> (43.8088888888889,-23.3544444444444,0)
GCP[  1]: Id=UpperRight, Info=
          (35839.5,0.5) -> (43.6219444444444,-23.3344444444444,0)
GCP[  2]: Id=LowerRight, Info=
          (35839.5,27647.5) -> (43.6225,-23.1958333333333,0)
GCP[  3]: Id=LowerLeft, Info=
          (0.5,27647.5) -> (43.8083333333333,-23.2152777777778,0)
Subdatasets:
  SUBDATASET_1_NAME=NITF_IM:0:10APR13WV020600013APR10075059-
P1BS-500060446050_05_P003.ntf
  SUBDATASET_1_DESC=Image 1 of 10APR13WV020600013APR10075059-
P1BS-500060446050_05_P003.ntf
  SUBDATASET_2_NAME=NITF_IM:1:10APR13WV020600013APR10075059-
P1BS-500060446050_05_P003.ntf
  SUBDATASET_2_DESC=Image 2 of 10APR13WV020600013APR10075059-
P1BS-500060446050_05_P003.ntf
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0,27648.0)
Upper Right (35840.0,    0.0)
Lower Right (35840.0,27648.0)
Center      (17920.0,13824.0)
Band 1 Block=1024x1024 Type=UInt16, ColorInterp=Gray
  Overviews: 17920x13824, 8960x6912, 4480x3456, 2240x1728, 1120x864
  Overviews: arbitrary
###################################################


The 1st SUBDATASET is reported as:

# code ###################################################
gdalinfo -sd 1 -nomd -norat -noct -nofl 10APR13WV020600013APR10075059-
P1BS-500060446050_05_P003.ntf

[ -- cut -- some Warnings -- ]

Driver: NITF/National Imagery Transmission Format
Files: 10APR13WV020600013APR10075059-P1BS-500060446050_05_P003.ntf
Size is 35840, 27648
Coordinate System is `'
GCP Projection = 
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563,
            AUTHORITY["EPSG","7030"]],
        TOWGS84[0,0,0,0,0,0,0],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0,
        AUTHORITY["EPSG","8901"]],
    UNIT["degree",0.0174532925199433,
        AUTHORITY["EPSG","9108"]],
    AUTHORITY["EPSG","4326"]]
GCP[  0]: Id=UpperLeft, Info=
          (0.5,0.5) -> (43.8088888888889,-23.3544444444444,0)
GCP[  1]: Id=UpperRight, Info=
          (35839.5,0.5) -> (43.6219444444444,-23.3344444444444,0)
GCP[  2]: Id=LowerRight, Info=
          (35839.5,27647.5) -> (43.6225,-23.1958333333333,0)
GCP[  3]: Id=LowerLeft, Info=
          (0.5,27647.5) -> (43.8083333333333,-23.2152777777778,0)
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0,27648.0)
Upper Right (35840.0,    0.0)
Lower Right (35840.0,27648.0)
Center      (17920.0,13824.0)
Band 1 Block=1024x1024 Type=UInt16, ColorInterp=Gray
  Overviews: 17920x13824, 8960x6912, 4480x3456, 2240x1728, 1120x864
  Overviews: arbitrary

[ -- cut -- some Warnings -- ]
###################################################



The 2nd SUBDATASET is reported as:

# code ###################################################
gdalinfo -sd 2 -nomd -norat -noct -nofl 10APR13WV020600013APR10075059-
P1BS-500060446050_05_P003.ntf

[ -- cut -- some Warnings -- ]

Driver: NITF/National Imagery Transmission Format
Files: 10APR13WV020600013APR10075059-P1BS-500060446050_05_P003.ntf
Size is 97, 78
Coordinate System is:
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563,
            AUTHORITY["EPSG","7030"]],
        TOWGS84[0,0,0,0,0,0,0],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0,
        AUTHORITY["EPSG","8901"]],
    UNIT["degree",0.0174532925199433,
        AUTHORITY["EPSG","9108"]],
    AUTHORITY["EPSG","4326"]]
GeoTransform =
  43.8096587433111, -0.001954571759259283, -1.803751803795437e-06
  -23.35525135093495, 0.0002068865740741814, 0.001823593073593144
Corner Coordinates:
Upper Left  (  43.8096587, -23.3552514) ( 43d48'34.77"E, 23d21'18.90"S)
Lower Left  (  43.8095181, -23.2130111) ( 43d48'34.26"E, 23d12'46.84"S)
Upper Right (  43.6200653, -23.3351834) ( 43d37'12.24"E, 23d20' 6.66"S)
Lower Right (  43.6199246, -23.1929431) ( 43d37'11.73"E, 23d11'34.60"S)
Center      (  43.7147917, -23.2740972) ( 43d42'53.25"E, 23d16'26.75"S)
Band 1 Block=97x1 Type=Byte, ColorInterp=Undefined
###################################################



Likewise, reporting on a Multi-Spectral NTF container, the 2nd SUBDATASET is 
the Spatial Reference System information.

Unfortunately, though expected, r.in.gdal complains about the missing 
projection info for the 1st SUBDATASET.

# code ###################################################
r.in.gdal in=NITF_IM:0:10APR13WV020600013APR10075059-
P1BS-500060446050_05_P003.ntf out=m_sd_1
ERROR: Projection of dataset does not appear to match current location.

       Location PROJ_INFO is:
       name: Lat/Lon
       proj: ll
       datum: wgs84
       ellps: wgs84
       no_defs: defined

       Import dataset PROJ_INFO is:
       cellhd.proj = 0 (unreferenced/unknown)

       You can use the -o flag to r.in.gdal to override this check and use
       the location definition for the dataset.
       Consider generating a new location from the input dataset using the
       'location' parameter.

[ -- cut -- some Warnings -- ]
###################################################



Adding the "-o" flag, gets to the next error:

# code ###################################################
r.in.gdal in=NITF_IM:0:10APR13WV020600013APR10075059-
P1BS-500060446050_05_P003.ntf out=m_sd_1 -o

WARNING: Over-riding projection check
ERROR: Illegal latitude for North

[ -- cut -- some Warnings -- ]
###################################################


Adding the "-l" switch, takes too much time "waiting" in 0% for the import 
process.  Now, the GCP's are given in the 2nd SUBDATASET(s).  Is there any way 
to avoid usnig "r.region" and make the long story short, just by using some 
gdal-* magic?



Using gdalwarp to go NorthUp:

#################################################### code #
gdalwarp -of NITF -co "ICORDS=G" NITF_IM:0:10APR13WV020600013APR10075059-
P1BS-500060446050_05_P003.ntf 10APR13WV020600013APR10075059-
P1BS-500060446050_05_P003_NorthUp.ntf
###################################################

allows for imoprting the image via r.in.gdal.   However, this image is 
obviously and heavily skewed/shifted.  Using r.region doesn't make any 
sense...

since the image boundaries coincide!

#################################################### code #
gdalinfo -nomd -noct -norat -nofl -nogcp 10APR13WV020600013APR10075059-
M1BS-500060446050_05_P003_NorthUp.tif

Corner Coordinates:
Upper Left  (  43.6218649, -23.1956837) ( 43d37'18.71"E, 23d11'44.46"S)
Lower Left  (  43.6218649, -23.3543246) ( 43d37'18.71"E, 23d21'15.57"S)
Upper Right (  43.8088360, -23.1956837) ( 43d48'31.81"E, 23d11'44.46"S)
Lower Right (  43.8088360, -23.3543246) ( 43d48'31.81"E, 23d21'15.57"S)
###################################################



and minor differences when gdal-warping in to a NITF file

#################################################### code #
Corner Coordinates:
Upper Left  (  43.6219339, -23.1955450) ( 43d37'18.96"E, 23d11'43.96"S)
Lower Left  (  43.6219339, -23.3544550) ( 43d37'18.96"E, 23d21'16.04"S)
Upper Right (  43.8088994, -23.1955450) ( 43d48'32.04"E, 23d11'43.96"S)
Lower Right (  43.8088994, -23.3544550) ( 43d48'32.04"E, 23d21'16.04"S)
###################################################



After importing, one band reports

#################################################### code #
r.info -g M1BS_from_TIF.1

north=-23.1956836847222
south=-23.3543246272222
east=43.8088360363889
west=43.6218648544444
###################################################



The corner coordinates are practically identical.  Hence, it doesn't look like 
boundary (re-)definition/correction is required for these rasters.

So, how do you go about your NITF images? 

The only "nice-working" attempt so far, is when I extacted a specific fragment 
out of the Multi-Spectral container, for example, using the "-te" switch while 
warping, i.e. (using values, of course, in place of West, South, North and 
East):

gdalwarp -s_srs 'epsg:4326' -te West South North East 
03APR13WV010500013APR03073141-P1BS-500060446050_03_P003.ntf test.tif


These small fragments coincide perfectly with some vectorised area of intere	
st.


And, finally, and fortunately, adding the "-rpc" magic, seems to do the trick.  
Importing an rpc-warped image in GRASS, looks, after some cross-checks, nice 
:-)

Any other solutions?

Thanks, Nikos

---
[0] 
<http://www.jpeg.org/faq.phtml?action=show_answer&question_id=q3f042a68b1081>
[1] <http://trac.osgeo.org/gdal/wiki/ECW>
[2] <http://trac.osgeo.org/gdal/wiki/JasPer>
[3] <http://trac.osgeo.org/gdal/wiki/JP2KAK>
[4] <http://trac.osgeo.org/gdal/wiki/MrSID>


NITF and GDAL

[5] <http://www.gdal.org/frmt_nitf.html>
[6] <http://www.gdal.org/frmt_nitf_advanced.html>


NITF Related posts (even a bit)

[7] <http://lists.maptools.org/pipermail/fwtools/2008-March/001193.html>, 
2008, refers also to license stuff.
[8] <http://osgeo-org.1560.x6.nabble.com/gdal-dev-Can-t-read-NITF-image-td5064590.html>
[9] <http://lists.osgeo.org/pipermail/gdal-dev/2012-April/032431.html>
[10] <http://web.archiveorange.com/archive/v/H2CPnHaFxXHV9S1zxqmE>
[11] <http://lists.osgeo.org/pipermail/grass-user/2000-May/003502.html>, very 
old!
[12] <http://lists.osgeo.org/pipermail/grass-user/2006-March/033353.html>, old
[13] <http://lists.osgeo.org/pipermail/grass-user/2006-March/033300.html>, old
[14] <http://osgeo-org.1560.x6.nabble.com/gdal-dev-NITF-with-MultiDataSet-td5050649.html>, "Try building a vrt with the NITF datasets."
[15] <http://www.mail-archive.com/gdal-dev at lists.osgeo.org/msg02376.html>, 
refers to "-co".
[16] <http://marc.info/?l=gdal-dev&m=121323053222339&w=2>
[17] <http://osdir.com/ml/gdal-development-gis-osgeo/2009-01/msg00044.html>, 
about compression/compressed output.


Advanced coding discussions

[18] <http://osgeo-org.1560.x6.nabble.com/NITF-image-metadata-domain-field-in-GDAL-SUBDATASETS-td3762940.html>
[19] <http://osgeo-org.1560.x6.nabble.com/gdal-dev-How-to-use-RPC-Metadata-from-NITF-Files-in-a-MapServer-TileIndex-td4981951.html>, "The images also 
have rpc metadata and using the -rpc option in gdalwarp reprojects them quite 
well."

From warmerdam at pobox.com  Sun Jul 14 16:11:14 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Sun, 14 Jul 2013 16:11:14 -0700
Subject: [gdal-dev] Working with NTF files
In-Reply-To: <1694187.sUFg9XEByB@resilience>
References: <1694187.sUFg9XEByB@resilience>
Message-ID: <CA+YzLBcC-GGmhJEfYCCKKZVZioFcjY01q9CDwLF1qw_3WskceQ@mail.gmail.com>

On Sun, Jul 14, 2013 at 2:53 PM, Nikos Alexandris
<nik at nikosalexandris.net>wrote:

> Hi list & apologies for cross-posting.
>
> In short,
>
> I am trying to handle ntf files (NITF) as easy as possible -- working with
> some WorldView 01/02 and QuickBird imagery.
>
> 1) The question is:  how do you correctly import in GRASS-GIS QuickBird &
> WorldView imagery from N(I)TF containers?
>

Nikos,

Your working solution with gdalwarp seems reasonable.  Is there a problem
with it?  Perhaps you were hoping to do the RPC based warp within GRASS?


>
> 2) A second, of less importance, question, is:  how important are the
> warnings
> like:  "Warning 1: Unable to save auxilary information in
> /vsisubfile/3884_471349721,10APR13WV020600013APR10075059-
> P1BS-500060446050_05_P003.ntf.aux.xml." ?
>

This is not important.  I presume you are getting this with JPEG2000
compressed
image streams in NITF?  If you file a bug I might be able to clear this up
but there
are layers of complexity that make it challening.


>
>
> My working solution (seems to be),
>
> is to gdal-warp the SUBDATASET that contains the raster spectral bands
> _and_
> by using the -rpc switch (mentioned in some past post in GDAL-dev's ML
> [19]).
> Otherwise, the resulting warped image is heavily skewed and not ready for
> analysis.  E.g.:
>
> --%<---
> gdalwarp -rpc NITF_IM:0:10APR13WV020600013APR10075059-
> P1BS-500060446050_05_P003.ntf 10APR13WV020600013APR10075059-
> P1BS-500060446050_05_P003_NorthUp.tif
> --->%--
>
>
> This post is, also, sort of a BUMP related to my previous latest message in
> the GDAL-dev-ML's thread entitled  "Can't read NITF images" :-!  I think
> that
> N(I)TF files, no matter whatsoever the status of the related drivers are,
> as
> well as the "feelings" towards favouring it or not, deserves some more
> examples, a page in GRASS-Wiki perhaps, etc.
>

I'm afraid I'm one of those who neglected that thread.  I thought I saw Even
answer is so I was happy to keep out of it.

I can't speak to how the files should be described in GRASS.  Generally
I'd hope that the value of using GDAL is that GRASS wouldn't need to
talk too much about specific formats.

On the GDAL side we often have special info in trac wiki pages under the
BuildHints page, but in this case the issues are more usage rather than
building so there is no obvious place for user contributions.  The format
pages for NITF do have quite a bit of info.  It is (I think) the only driver
with an "advanced" page.  However, there are many kinds of NITF
files and thus usage patterns that are an issue so it isn't clear how to
handle that in the user docs.

I've skimmed the rest of your post, but I don't have any particular
advice or anything to add.  I do think it is reasonable to correct
such images into a nicer form with gdalwarp before running r.in.gdal.

Best regards,
Frank


>
>
> Now, the long story is that,
>
> I 've been through the list (grass-user, gdal-dev), manuals (grass
> importing
> related stuff & gdal's driver's documentation), well known and easy to find
> pages in GRASS-Wiki, GDAL tutorials, etc.  I haven't found any concrete
> examples on working with NITF images and GFOSS. [**See various links in the
> end]
>
> I would appreciate any hints (while I am actively searching How To do this
> best) to save time in the quest to find an optimal solution which can be
> scripted to handle various images from the same source.  Unfortunately,
> there
> is no access in GeoTiffs (so far/yet)!
>
> Set aside the internal compression "obstacle" (JPEG2000) which one can
> overcome using the OpenJPEG driver (or, necessarily some proprietary (?)
> bound
> solution [0, 1, 2, 3]), NITF files that contain multiple SUBDATASETS may
> look
> like:
>
> # code ###################################################
> gdalinfo -nomd -norat -noct -nofl 10APR13WV020600013APR10075059-
> P1BS-500060446050_05_P003.ntf
>
> Driver: NITF/National Imagery Transmission Format
> Files: 10APR13WV020600013APR10075059-P1BS-500060446050_05_P003.ntf
> Size is 35840, 27648
> Coordinate System is `'
> GCP Projection =
> GEOGCS["WGS 84",
>     DATUM["WGS_1984",
>         SPHEROID["WGS 84",6378137,298.257223563,
>             AUTHORITY["EPSG","7030"]],
>         TOWGS84[0,0,0,0,0,0,0],
>         AUTHORITY["EPSG","6326"]],
>     PRIMEM["Greenwich",0,
>         AUTHORITY["EPSG","8901"]],
>     UNIT["degree",0.0174532925199433,
>         AUTHORITY["EPSG","9108"]],
>     AUTHORITY["EPSG","4326"]]
> GCP[  0]: Id=UpperLeft, Info=
>           (0.5,0.5) -> (43.8088888888889,-23.3544444444444,0)
> GCP[  1]: Id=UpperRight, Info=
>           (35839.5,0.5) -> (43.6219444444444,-23.3344444444444,0)
> GCP[  2]: Id=LowerRight, Info=
>           (35839.5,27647.5) -> (43.6225,-23.1958333333333,0)
> GCP[  3]: Id=LowerLeft, Info=
>           (0.5,27647.5) -> (43.8083333333333,-23.2152777777778,0)
> Subdatasets:
>   SUBDATASET_1_NAME=NITF_IM:0:10APR13WV020600013APR10075059-
> P1BS-500060446050_05_P003.ntf
>   SUBDATASET_1_DESC=Image 1 of 10APR13WV020600013APR10075059-
> P1BS-500060446050_05_P003.ntf
>   SUBDATASET_2_NAME=NITF_IM:1:10APR13WV020600013APR10075059-
> P1BS-500060446050_05_P003.ntf
>   SUBDATASET_2_DESC=Image 2 of 10APR13WV020600013APR10075059-
> P1BS-500060446050_05_P003.ntf
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0,27648.0)
> Upper Right (35840.0,    0.0)
> Lower Right (35840.0,27648.0)
> Center      (17920.0,13824.0)
> Band 1 Block=1024x1024 Type=UInt16, ColorInterp=Gray
>   Overviews: 17920x13824, 8960x6912, 4480x3456, 2240x1728, 1120x864
>   Overviews: arbitrary
> ###################################################
>
>
> The 1st SUBDATASET is reported as:
>
> # code ###################################################
> gdalinfo -sd 1 -nomd -norat -noct -nofl 10APR13WV020600013APR10075059-
> P1BS-500060446050_05_P003.ntf
>
> [ -- cut -- some Warnings -- ]
>
> Driver: NITF/National Imagery Transmission Format
> Files: 10APR13WV020600013APR10075059-P1BS-500060446050_05_P003.ntf
> Size is 35840, 27648
> Coordinate System is `'
> GCP Projection =
> GEOGCS["WGS 84",
>     DATUM["WGS_1984",
>         SPHEROID["WGS 84",6378137,298.257223563,
>             AUTHORITY["EPSG","7030"]],
>         TOWGS84[0,0,0,0,0,0,0],
>         AUTHORITY["EPSG","6326"]],
>     PRIMEM["Greenwich",0,
>         AUTHORITY["EPSG","8901"]],
>     UNIT["degree",0.0174532925199433,
>         AUTHORITY["EPSG","9108"]],
>     AUTHORITY["EPSG","4326"]]
> GCP[  0]: Id=UpperLeft, Info=
>           (0.5,0.5) -> (43.8088888888889,-23.3544444444444,0)
> GCP[  1]: Id=UpperRight, Info=
>           (35839.5,0.5) -> (43.6219444444444,-23.3344444444444,0)
> GCP[  2]: Id=LowerRight, Info=
>           (35839.5,27647.5) -> (43.6225,-23.1958333333333,0)
> GCP[  3]: Id=LowerLeft, Info=
>           (0.5,27647.5) -> (43.8083333333333,-23.2152777777778,0)
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0,27648.0)
> Upper Right (35840.0,    0.0)
> Lower Right (35840.0,27648.0)
> Center      (17920.0,13824.0)
> Band 1 Block=1024x1024 Type=UInt16, ColorInterp=Gray
>   Overviews: 17920x13824, 8960x6912, 4480x3456, 2240x1728, 1120x864
>   Overviews: arbitrary
>
> [ -- cut -- some Warnings -- ]
> ###################################################
>
>
>
> The 2nd SUBDATASET is reported as:
>
> # code ###################################################
> gdalinfo -sd 2 -nomd -norat -noct -nofl 10APR13WV020600013APR10075059-
> P1BS-500060446050_05_P003.ntf
>
> [ -- cut -- some Warnings -- ]
>
> Driver: NITF/National Imagery Transmission Format
> Files: 10APR13WV020600013APR10075059-P1BS-500060446050_05_P003.ntf
> Size is 97, 78
> Coordinate System is:
> GEOGCS["WGS 84",
>     DATUM["WGS_1984",
>         SPHEROID["WGS 84",6378137,298.257223563,
>             AUTHORITY["EPSG","7030"]],
>         TOWGS84[0,0,0,0,0,0,0],
>         AUTHORITY["EPSG","6326"]],
>     PRIMEM["Greenwich",0,
>         AUTHORITY["EPSG","8901"]],
>     UNIT["degree",0.0174532925199433,
>         AUTHORITY["EPSG","9108"]],
>     AUTHORITY["EPSG","4326"]]
> GeoTransform =
>   43.8096587433111, -0.001954571759259283, -1.803751803795437e-06
>   -23.35525135093495, 0.0002068865740741814, 0.001823593073593144
> Corner Coordinates:
> Upper Left  (  43.8096587, -23.3552514) ( 43d48'34.77"E, 23d21'18.90"S)
> Lower Left  (  43.8095181, -23.2130111) ( 43d48'34.26"E, 23d12'46.84"S)
> Upper Right (  43.6200653, -23.3351834) ( 43d37'12.24"E, 23d20' 6.66"S)
> Lower Right (  43.6199246, -23.1929431) ( 43d37'11.73"E, 23d11'34.60"S)
> Center      (  43.7147917, -23.2740972) ( 43d42'53.25"E, 23d16'26.75"S)
> Band 1 Block=97x1 Type=Byte, ColorInterp=Undefined
> ###################################################
>
>
>
> Likewise, reporting on a Multi-Spectral NTF container, the 2nd SUBDATASET
> is
> the Spatial Reference System information.
>
> Unfortunately, though expected, r.in.gdal complains about the missing
> projection info for the 1st SUBDATASET.
>
> # code ###################################################
> r.in.gdal in=NITF_IM:0:10APR13WV020600013APR10075059-
> P1BS-500060446050_05_P003.ntf out=m_sd_1
> ERROR: Projection of dataset does not appear to match current location.
>
>        Location PROJ_INFO is:
>        name: Lat/Lon
>        proj: ll
>        datum: wgs84
>        ellps: wgs84
>        no_defs: defined
>
>        Import dataset PROJ_INFO is:
>        cellhd.proj = 0 (unreferenced/unknown)
>
>        You can use the -o flag to r.in.gdal to override this check and use
>        the location definition for the dataset.
>        Consider generating a new location from the input dataset using the
>        'location' parameter.
>
> [ -- cut -- some Warnings -- ]
> ###################################################
>
>
>
> Adding the "-o" flag, gets to the next error:
>
> # code ###################################################
> r.in.gdal in=NITF_IM:0:10APR13WV020600013APR10075059-
> P1BS-500060446050_05_P003.ntf out=m_sd_1 -o
>
> WARNING: Over-riding projection check
> ERROR: Illegal latitude for North
>
> [ -- cut -- some Warnings -- ]
> ###################################################
>
>
> Adding the "-l" switch, takes too much time "waiting" in 0% for the import
> process.  Now, the GCP's are given in the 2nd SUBDATASET(s).  Is there any
> way
> to avoid usnig "r.region" and make the long story short, just by using some
> gdal-* magic?
>
>
>
> Using gdalwarp to go NorthUp:
>
> #################################################### code #
> gdalwarp -of NITF -co "ICORDS=G" NITF_IM:0:10APR13WV020600013APR10075059-
> P1BS-500060446050_05_P003.ntf 10APR13WV020600013APR10075059-
> P1BS-500060446050_05_P003_NorthUp.ntf
> ###################################################
>
> allows for imoprting the image via r.in.gdal.   However, this image is
> obviously and heavily skewed/shifted.  Using r.region doesn't make any
> sense...
>
> since the image boundaries coincide!
>
> #################################################### code #
> gdalinfo -nomd -noct -norat -nofl -nogcp 10APR13WV020600013APR10075059-
> M1BS-500060446050_05_P003_NorthUp.tif
>
> Corner Coordinates:
> Upper Left  (  43.6218649, -23.1956837) ( 43d37'18.71"E, 23d11'44.46"S)
> Lower Left  (  43.6218649, -23.3543246) ( 43d37'18.71"E, 23d21'15.57"S)
> Upper Right (  43.8088360, -23.1956837) ( 43d48'31.81"E, 23d11'44.46"S)
> Lower Right (  43.8088360, -23.3543246) ( 43d48'31.81"E, 23d21'15.57"S)
> ###################################################
>
>
>
> and minor differences when gdal-warping in to a NITF file
>
> #################################################### code #
> Corner Coordinates:
> Upper Left  (  43.6219339, -23.1955450) ( 43d37'18.96"E, 23d11'43.96"S)
> Lower Left  (  43.6219339, -23.3544550) ( 43d37'18.96"E, 23d21'16.04"S)
> Upper Right (  43.8088994, -23.1955450) ( 43d48'32.04"E, 23d11'43.96"S)
> Lower Right (  43.8088994, -23.3544550) ( 43d48'32.04"E, 23d21'16.04"S)
> ###################################################
>
>
>
> After importing, one band reports
>
> #################################################### code #
> r.info -g M1BS_from_TIF.1
>
> north=-23.1956836847222
> south=-23.3543246272222
> east=43.8088360363889
> west=43.6218648544444
> ###################################################
>
>
>
> The corner coordinates are practically identical.  Hence, it doesn't look
> like
> boundary (re-)definition/correction is required for these rasters.
>
> So, how do you go about your NITF images?
>
> The only "nice-working" attempt so far, is when I extacted a specific
> fragment
> out of the Multi-Spectral container, for example, using the "-te" switch
> while
> warping, i.e. (using values, of course, in place of West, South, North and
> East):
>
> gdalwarp -s_srs 'epsg:4326' -te West South North East
> 03APR13WV010500013APR03073141-P1BS-500060446050_03_P003.ntf test.tif
>
>
> These small fragments coincide perfectly with some vectorised area of
> intere
> st.
>
>
> And, finally, and fortunately, adding the "-rpc" magic, seems to do the
> trick.
> Importing an rpc-warped image in GRASS, looks, after some cross-checks,
> nice
> :-)
>
> Any other solutions?
>
> Thanks, Nikos
>
> ---
> [0]
> <
> http://www.jpeg.org/faq.phtml?action=show_answer&question_id=q3f042a68b1081
> >
> [1] <http://trac.osgeo.org/gdal/wiki/ECW>
> [2] <http://trac.osgeo.org/gdal/wiki/JasPer>
> [3] <http://trac.osgeo.org/gdal/wiki/JP2KAK>
> [4] <http://trac.osgeo.org/gdal/wiki/MrSID>
>
>
> NITF and GDAL
>
> [5] <http://www.gdal.org/frmt_nitf.html>
> [6] <http://www.gdal.org/frmt_nitf_advanced.html>
>
>
> NITF Related posts (even a bit)
>
> [7] <http://lists.maptools.org/pipermail/fwtools/2008-March/001193.html>,
> 2008, refers also to license stuff.
> [8] <
> http://osgeo-org.1560.x6.nabble.com/gdal-dev-Can-t-read-NITF-image-td5064590.html
> >
> [9] <http://lists.osgeo.org/pipermail/gdal-dev/2012-April/032431.html>
> [10] <http://web.archiveorange.com/archive/v/H2CPnHaFxXHV9S1zxqmE>
> [11] <http://lists.osgeo.org/pipermail/grass-user/2000-May/003502.html>,
> very
> old!
> [12] <http://lists.osgeo.org/pipermail/grass-user/2006-March/033353.html>,
> old
> [13] <http://lists.osgeo.org/pipermail/grass-user/2006-March/033300.html>,
> old
> [14] <
> http://osgeo-org.1560.x6.nabble.com/gdal-dev-NITF-with-MultiDataSet-td5050649.html>,
> "Try building a vrt with the NITF datasets."
> [15] <http://www.mail-archive.com/gdal-dev at lists.osgeo.org/msg02376.html>,
> refers to "-co".
> [16] <http://marc.info/?l=gdal-dev&m=121323053222339&w=2>
> [17] <http://osdir.com/ml/gdal-development-gis-osgeo/2009-01/msg00044.html
> >,
> about compression/compressed output.
>
>
> Advanced coding discussions
>
> [18] <
> http://osgeo-org.1560.x6.nabble.com/NITF-image-metadata-domain-field-in-GDAL-SUBDATASETS-td3762940.html
> >
> [19] <
> http://osgeo-org.1560.x6.nabble.com/gdal-dev-How-to-use-RPC-Metadata-from-NITF-Files-in-a-MapServer-TileIndex-td4981951.html>,
> "The images also
> have rpc metadata and using the -rpc option in gdalwarp reprojects them
> quite
> well."
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130714/0479aa41/attachment-0001.html>

From nik at nikosalexandris.net  Sun Jul 14 16:52:37 2013
From: nik at nikosalexandris.net (Nikos Alexandris)
Date: Mon, 15 Jul 2013 02:52:37 +0300
Subject: [gdal-dev] Working with NTF files
In-Reply-To: <CA+YzLBcC-GGmhJEfYCCKKZVZioFcjY01q9CDwLF1qw_3WskceQ@mail.gmail.com>
References: <1694187.sUFg9XEByB@resilience>
	<CA+YzLBcC-GGmhJEfYCCKKZVZioFcjY01q9CDwLF1qw_3WskceQ@mail.gmail.com>
Message-ID: <1395474.MY5m1vMGQt@vertikal>

Nikos Alexandris:

> > I am trying to handle ntf files (NITF) as easy as possible -- working with
> > some WorldView 01/02 and QuickBird imagery.

> > 1) The question is:  how do you correctly import in GRASS-GIS QuickBird &
> > WorldView imagery from N(I)TF containers?


Frank Warmerdam wrote:

> Your working solution with gdalwarp seems reasonable.  Is there a problem
> with it?

No (except that I left this option as the "final attempt" of many tests -- 
working with some >1GB images here, so it took me hours... :D).  Your 
confirmation, though, is highly useful!


> Perhaps you were hoping to do the RPC based warp within GRASS?

Yes, I was hopping to say something like:

--%<---
r.in.gdal in=NITF.ntf out=NITF sds=1 band=1,2,3,4 transform=rpc[,tps] 
[resampling=n,b,c,cs,l,a,m]
--->%--

:D -- I know, I am asking for too much.  I have read the following post
already: <http://fwarmerdam.blogspot.gr/2009/12/death-by-complexity.html>.

Also, there is already a (kind of related) grass-ticket:
<http://trac.osgeo.org/grass/ticket/798>.

 
> > 2) A second, of less importance, question, is:  how important are the
> > warnings like:  "Warning 1: Unable to save auxilary information in
> > /vsisubfile/3884_471349721,10APR13WV020600013APR10075059-
> > P1BS-500060446050_05_P003.ntf.aux.xml." ?

> This is not important.  I presume you are getting this with JPEG2000
> compressed image streams in NITF?

Correct


> If you file a bug I might be able to clear this up but there are layers of
> complexity that make it challening.

I will (take the time later to) file a ticket.  I was hopping, anyhow, in case 
such warnings are not a real big deal, to have a way to supress them.  That 
would ease off, me thinks at least, scripting.  Some option like the "-q" one 
-- though, in this case it doesn't silence these Warnings.


> > My working solution (seems to be), is to gdal-warp the SUBDATASET that
> > contains the raster spectral bands _and_ by using the -rpc switch
> > (mentioned in some past post in GDAL-dev's ML [19]).  Otherwise, the
> > resulting warped image is heavily skewed and not ready for analysis.
> > E.g.:
> > --%<---
> > gdalwarp -rpc NITF_IM:0:10APR13WV020600013APR10075059-
> > P1BS-500060446050_05_P003.ntf 10APR13WV020600013APR10075059-
> > P1BS-500060446050_05_P003_NorthUp.tif
> > --->%--

> > This post is, also, sort of a BUMP related to my previous latest message
> > in the GDAL-dev-ML's thread entitled  "Can't read NITF images" :-!  I
> > think that N(I)TF files, no matter whatsoever the status of the related
> > drivers are, as well as the "feelings" towards favouring it or not,
> > deserves some more examples, a page in GRASS-Wiki perhaps, etc.

> I'm afraid I'm one of those who neglected that thread.  I thought I saw Even
> answer is so I was happy to keep out of it.

> I can't speak to how the files should be described in GRASS.  Generally
> I'd hope that the value of using GDAL is that GRASS wouldn't need to
> talk too much about specific formats.

It certainly is so (in general).


> On the GDAL side we often have special info in trac wiki pages under the
> BuildHints page, but in this case the issues are more usage rather than
> building so there is no obvious place for user contributions.  The format
> pages for NITF do have quite a bit of info.  It is (I think) the only driver
> with an "advanced" page.  However, there are many kinds of NITF
> files and thus usage patterns that are an issue so it isn't clear how to
> handle that in the user docs.

I am (slowly) getting to see that there is a "bigger" picture.


> I've skimmed the rest of your post, but I don't have any particular
> advice or anything to add.  I do think it is reasonable to correct
> such images into a nicer form with gdalwarp before running r.in.gdal.

Your reply as a whole is very useful for me.

Thank you Frank, Nikos
--

[rest deleted]

From chenxian at walkinfo.com.cn  Sun Jul 14 19:23:30 2013
From: chenxian at walkinfo.com.cn (=?gb2312?B?WGlhbiBDaGVuL7PCz9s=?=)
Date: Mon, 15 Jul 2013 10:23:30 +0800
Subject: [gdal-dev] ogr2ogr bug with dwg file
In-Reply-To: <201307111943.43310.even.rouault@mines-paris.org>
References: <1373528016793-5065611.post@n6.nabble.com>,
	<201307111943.43310.even.rouault@mines-paris.org>
Message-ID: <596F84E4D8B06F45A0621DC4F4BFACD8348333900F@mail.walkinfo.local>

Hi Even,

Thanks for your quick response. I tested your patch on OGR2OGR. All right, the application does not crash now.
Does that mean with this patch we don't need to call OGRCleanupAll() mandatorily?

I am asking this question because we have our own Windows application developed based on GDAL/OGR. If we include OGR_DWG.dll the application will always crash when exiting (the application called OGRCleanupAll() explicitly).

Best Regards,
Xian

Le jeudi 11 juillet 2013 09:33:36, Xian Chen a ?crit :
> Hi all,
>
> Finally I've got a chance to report something after one-month silence as a
> newcomer in the community.
> After running ogr2ogr (on Windows 7) to convert a dwg file into shape
> files, I received an error message as follows:
> /    Warning 6: Normalized/laundered field name: 'ExtendedEntity' to
> 'ExtendedEn'
>     Warning 6: Normalized/laundered field name: 'EntityHandle' to
> 'EntityHand'
>     ERROR 1: Attempt to write non-linestring (POINT) geometry to ARC type
> shapefile.
>
>     ERROR 1: Terminating translation prematurely after failed
>     translation of layer entities (use -skipfailures to skip errors)/
>
> And then the application exited abnormally.  I read the source code and
> found that the last error message was produced by an error from
> TranslateLayer(). The application terminated there without calling
> OGRCleanupAll()
>
> Therefore I tested reading dwg file on OGR. My conclusion is that
> OGRCleanupAll() has to be called explicitly before termination of the whole
> application, otherwise an abnormal termination (due to stack overflow??)
> will occur.

Hi Xian,

Interesting.

Yes calling OGRCleanupAll() is a best practice, and probably that even the
error code paths in the utilities should call it, but it shouldn't be
compulsory to call it.

Looking at the code of the DWG driver, I see that the driver has indeed code
in its destructor to call the odUninitialize() function. When you call
OGRCleanupAll() then this code is called. But GDAL has also a DLL clean-up
code that will call OGRCleanupAll(). I suspect that in that case, some C++
automatic objects normally cleaned by odUninitialize() have already been
destroyed, and at the time odUninitialize() is called, it will access them at
the time where they are no longer available. Hence the crash.

Being not in position to test it myself, in order to confirm my above guess,
could you revert your changes in ogr2ogr.cpp and test the attached patch
(based on GDAL trunk) ?

Best regards,

Even

>
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/ogr2ogr-bug-with-dwg-file-tp5065611.ht
> ml Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

--
Geospatial professional services
http://even.rouault.free.fr/services.html

From Chris.Tweedie at intergraph.com  Sun Jul 14 20:35:57 2013
From: Chris.Tweedie at intergraph.com (Tweedie, Chris)
Date: Mon, 15 Jul 2013 03:35:57 +0000
Subject: [gdal-dev] ECW JPEG2000 SDK v5.0 now available
Message-ID: <E672FFB67936104F839A858ACB2EA9F4C0FF46@ap-mbx3.ingrnet.com>

Hi list,

Due to overwhelming interest from GDAL-ers I have cross posted the announcement here. For general SDK questions please post to http://geospatial.intergraph.com/Community/forums/27.aspx

SDK v5.0 is now available for?download @ http://geospatial.intergraph.com/products/other/ecw/ERDASECWJPEG2000SDK/Downloads.aspx

Highlights include,

. Linux platform support
. Visual Studio 2012 support (VC110)
. Removed TBB dependency
. Static and dynamic library support
. ECW v3 format
- uint16 support
- null blocks to optimally store and compress imagery with vast no-data or null areas
- improved metadata support, statistics, histogram, RPC native storage
. Improved image quality for ECW files (decoder only)
. Vast improvements to the JPEG2000 decoder in terms of performance and compatibility
. Significant encoding performance improvements
. Full unicode support
. Improved examples for encoding and decoding
. Now a single unified library, NCSEcw (.dll / .so)

We are sure it was worth the wait, but let me know if you disagree :-)

Chris


From woklist at kyngchaos.com  Mon Jul 15 06:26:39 2013
From: woklist at kyngchaos.com (William Kyngesburye)
Date: Mon, 15 Jul 2013 08:26:39 -0500
Subject: [gdal-dev] ECW JPEG2000 SDK v5.0 now available
In-Reply-To: <E672FFB67936104F839A858ACB2EA9F4C0FF46@ap-mbx3.ingrnet.com>
References: <E672FFB67936104F839A858ACB2EA9F4C0FF46@ap-mbx3.ingrnet.com>
Message-ID: <6C8C5615-99F6-496A-8262-F54C74A280CE@kyngchaos.com>

Bummer, still no OS X support.

On Jul 14, 2013, at 10:35 PM, Tweedie, Chris wrote:

> Hi list,
> 
> Due to overwhelming interest from GDAL-ers I have cross posted the announcement here. For general SDK questions please post to http://geospatial.intergraph.com/Community/forums/27.aspx
> 
> SDK v5.0 is now available for download @ http://geospatial.intergraph.com/products/other/ecw/ERDASECWJPEG2000SDK/Downloads.aspx
> 
> Highlights include,
> 
> . Linux platform support
> . Visual Studio 2012 support (VC110)
> . Removed TBB dependency
> . Static and dynamic library support
> . ECW v3 format
> - uint16 support
> - null blocks to optimally store and compress imagery with vast no-data or null areas
> - improved metadata support, statistics, histogram, RPC native storage
> . Improved image quality for ECW files (decoder only)
> . Vast improvements to the JPEG2000 decoder in terms of performance and compatibility
> . Significant encoding performance improvements
> . Full unicode support
> . Improved examples for encoding and decoding
> . Now a single unified library, NCSEcw (.dll / .so)
> 
> We are sure it was worth the wait, but let me know if you disagree :-)
> 
> Chris
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-----
William Kyngesburye <kyngchaos*at*kyngchaos*dot*com>
http://www.kyngchaos.com/

"The beast is actively interested only in now, and, as it is always now and always shall be, there is an eternity of time for the accomplishment of objects."

- the wisdom of Tarzan






From jrepetto at free.fr  Mon Jul 15 06:47:37 2013
From: jrepetto at free.fr (Jean-Claude Repetto)
Date: Mon, 15 Jul 2013 15:47:37 +0200
Subject: [gdal-dev] ECW JPEG2000 SDK v5.0 now available
In-Reply-To: <6C8C5615-99F6-496A-8262-F54C74A280CE@kyngchaos.com>
References: <E672FFB67936104F839A858ACB2EA9F4C0FF46@ap-mbx3.ingrnet.com>
	<6C8C5615-99F6-496A-8262-F54C74A280CE@kyngchaos.com>
Message-ID: <51E3FD79.1030808@free.fr>

Le 15/07/2013 15:26, William Kyngesburye a ?crit :
> Bummer, still no OS X support.

and no Linux support for ARM.

SDK 3.3 is still the best option.
Intergraph is killing the ECW format.

Jean-Claude



From eadam at co.lincoln.or.us  Mon Jul 15 09:55:43 2013
From: eadam at co.lincoln.or.us (Eli Adam)
Date: Mon, 15 Jul 2013 09:55:43 -0700
Subject: [gdal-dev] Working with NTF files
In-Reply-To: <1395474.MY5m1vMGQt@vertikal>
References: <1694187.sUFg9XEByB@resilience>
	<CA+YzLBcC-GGmhJEfYCCKKZVZioFcjY01q9CDwLF1qw_3WskceQ@mail.gmail.com>
	<1395474.MY5m1vMGQt@vertikal>
Message-ID: <CACqBkM_Cx4T+GuZJpqJ+tRA9vgcxgMANCTbLiK4aqdQPYepqtQ@mail.gmail.com>

> No (except that I left this option as the "final attempt" of many tests --
> working with some >1GB images here, so it took me hours... :D).  Your
> confirmation, though, is highly useful!
>

Sometimes to avoid materializing large intermediate datasets on disk, a VRT
can be used.  I'm not sure if this would be useful in your case.

> On the GDAL side we often have special info in trac wiki pages under the
> BuildHints page, but in this case the issues are more usage rather than
> building so there is no obvious place for user contributions.  The format
> pages for NITF do have quite a bit of info.  It is (I think) the only
driver
> with an "advanced" page.  However, there are many kinds of NITF
> files and thus usage patterns that are an issue so it isn't clear how to
> handle that in the user docs.

I and others have put GDAL usage notes here,
http://trac.osgeo.org/gdal/wiki/CodeSnippets

Best Regards, Eli
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130715/6d52ebe9/attachment.html>

From even.rouault at mines-paris.org  Mon Jul 15 11:36:31 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 15 Jul 2013 20:36:31 +0200
Subject: [gdal-dev] ogr2ogr bug with dwg file
In-Reply-To: <596F84E4D8B06F45A0621DC4F4BFACD8348333900F@mail.walkinfo.local>
References: <1373528016793-5065611.post@n6.nabble.com>
	<201307111943.43310.even.rouault@mines-paris.org>
	<596F84E4D8B06F45A0621DC4F4BFACD8348333900F@mail.walkinfo.local>
Message-ID: <201307152036.31749.even.rouault@mines-paris.org>

Le lundi 15 juillet 2013 04:23:30, Xian Chen/?? a ?crit :
> Hi Even,
> 
> Thanks for your quick response. I tested your patch on OGR2OGR. All right,
> the application does not crash now. Does that mean with this patch we
> don't need to call OGRCleanupAll() mandatorily?

Well, OGRCleanupAll() is advised to be called to clean up things properly 
(mainly if you use a memory debugger, to avoid GDAL memory to be reported as 
leaking). What is really compulsory is to destroy datasources so that they get 
properly closed.

> 
> I am asking this question because we have our own Windows application
> developed based on GDAL/OGR. If we include OGR_DWG.dll the application
> will always crash when exiting (the application called OGRCleanupAll()
> explicitly).

Hum, this is not supposed to happen. So my hypothesis was not completely right 
(neither wrong). It seems that it is the destructor of the DWG driver that 
causes problem, be it called explicitely or implicitely... I'm not in position 
to debug this, so it would be interesting to know if every user of the DWG 
driver encounters this, or if it might not come from the way how your GDAL 
binaries have been built.

> 
> Best Regards,
> Xian
> 
> Le jeudi 11 juillet 2013 09:33:36, Xian Chen a ?crit :
> > Hi all,
> > 
> > Finally I've got a chance to report something after one-month silence as
> > a newcomer in the community.
> > After running ogr2ogr (on Windows 7) to convert a dwg file into shape
> > files, I received an error message as follows:
> > /    Warning 6: Normalized/laundered field name: 'ExtendedEntity' to
> > 'ExtendedEn'
> > 
> >     Warning 6: Normalized/laundered field name: 'EntityHandle' to
> > 
> > 'EntityHand'
> > 
> >     ERROR 1: Attempt to write non-linestring (POINT) geometry to ARC type
> > 
> > shapefile.
> > 
> >     ERROR 1: Terminating translation prematurely after failed
> >     translation of layer entities (use -skipfailures to skip errors)/
> > 
> > And then the application exited abnormally.  I read the source code and
> > found that the last error message was produced by an error from
> > TranslateLayer(). The application terminated there without calling
> > OGRCleanupAll()
> > 
> > Therefore I tested reading dwg file on OGR. My conclusion is that
> > OGRCleanupAll() has to be called explicitly before termination of the
> > whole application, otherwise an abnormal termination (due to stack
> > overflow??) will occur.
> 
> Hi Xian,
> 
> Interesting.
> 
> Yes calling OGRCleanupAll() is a best practice, and probably that even the
> error code paths in the utilities should call it, but it shouldn't be
> compulsory to call it.
> 
> Looking at the code of the DWG driver, I see that the driver has indeed
> code in its destructor to call the odUninitialize() function. When you
> call OGRCleanupAll() then this code is called. But GDAL has also a DLL
> clean-up code that will call OGRCleanupAll(). I suspect that in that case,
> some C++ automatic objects normally cleaned by odUninitialize() have
> already been destroyed, and at the time odUninitialize() is called, it
> will access them at the time where they are no longer available. Hence the
> crash.
> 
> Being not in position to test it myself, in order to confirm my above
> guess, could you revert your changes in ogr2ogr.cpp and test the attached
> patch (based on GDAL trunk) ?
> 
> Best regards,
> 
> Even
> 
> > --
> > View this message in context:
> > http://osgeo-org.1560.x6.nabble.com/ogr2ogr-bug-with-dwg-file-tp5065611.h
> > t ml Sent from the GDAL - Dev mailing list archive at Nabble.com.
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From nixanz at nixanz.com  Mon Jul 15 16:07:00 2013
From: nixanz at nixanz.com (Nik Sands)
Date: Tue, 16 Jul 2013 09:07:00 +1000
Subject: [gdal-dev] Can't get colour table for GeoTIFF
Message-ID: <7C0BCF08-CD0A-430A-9A81-987A21486A6E@nixanz.com>

Hi!

I'm using the code below as part of a routine to warp images.  For most images it works fine.  However, for one of my users, their images are being converted from full colour to black and white which is not supposed to happen.  I've narrowed down the issue to the code below where 'hCT' remains NULL.  An example of one such source image can be downloaded at:

	https://dl.dropboxusercontent.com/u/12436846/jrc_21.tiff

I guess I must be doing something wrong in my code, but can't figure it out.  Could somebody please help me to understand how to do this correctly?

Ie, how to I get the colour table from the image linked to above, and set that colour table for my destination image?

Cheers,
Nik.



GDALColorTableH hCT = GDALGetRasterColorTable( GDALGetRasterBand(hSrcDS,1) );

if ( hCT == NULL )
	NSLog(@"Failed to get colour table.");
else
	GDALSetRasterColorTable( GDALGetRasterBand(hDstDS,1), hCT );


From warmerdam at pobox.com  Mon Jul 15 16:10:25 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon, 15 Jul 2013 16:10:25 -0700
Subject: [gdal-dev] Can't get colour table for GeoTIFF
In-Reply-To: <7C0BCF08-CD0A-430A-9A81-987A21486A6E@nixanz.com>
References: <7C0BCF08-CD0A-430A-9A81-987A21486A6E@nixanz.com>
Message-ID: <CA+YzLBfbLeh-HeGJ6pWMzhoUXzCXgTNv2NLC7zVWkDVfyFvo=g@mail.gmail.com>

Nike,

The gdalinfo report on the file is as follows.  It is an RGBA file - that
is it has four bands which are red, green, blue and alpha.  It appears you
are configured to only work with single band pseudo-colored images (images
with a palette).  I suppose you will need to generalize your code for this
case.

gdalinfo jrc_21.tiff
Driver: GTiff/GeoTIFF
Files: jrc_21.tiff
Size is 1009, 753
Coordinate System is:
PROJCS["WGS 84 / UTM zone 32N",
    GEOGCS["WGS 84",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.257223563,
                AUTHORITY["EPSG","7030"]],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4326"]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",9],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AUTHORITY["EPSG","32632"]]
Origin = (470363.734899999981280,5073657.708399999886751)
Pixel Size = (2.060455896927651,-2.061088977423639)
Metadata:
  AREA_OR_POINT=Area
  TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
  TIFFTAG_XRESOLUTION=96
  TIFFTAG_YRESOLUTION=96
Image Structure Metadata:
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (  470363.735, 5073657.708) (  8d37' 6.69"E, 45d48'57.04"N)
Lower Left  (  470363.735, 5072105.708) (  8d37' 7.04"E, 45d48' 6.76"N)
Upper Right (  472442.735, 5073657.708) (  8d38'43.03"E, 45d48'57.35"N)
Lower Right (  472442.735, 5072105.708) (  8d38'43.35"E, 45d48' 7.07"N)
Center      (  471403.235, 5072881.708) (  8d37'55.03"E, 45d48'32.06"N)
Band 1 Block=1009x2 Type=Byte, ColorInterp=Red
  NoData Value=0
Band 2 Block=1009x2 Type=Byte, ColorInterp=Green
  NoData Value=0
Band 3 Block=1009x2 Type=Byte, ColorInterp=Blue
  NoData Value=0
Band 4 Block=1009x2 Type=Byte, ColorInterp=Alpha
  NoData Value=0



On Mon, Jul 15, 2013 at 4:07 PM, Nik Sands <nixanz at nixanz.com> wrote:

> Hi!
>
> I'm using the code below as part of a routine to warp images.  For most
> images it works fine.  However, for one of my users, their images are being
> converted from full colour to black and white which is not supposed to
> happen.  I've narrowed down the issue to the code below where 'hCT' remains
> NULL.  An example of one such source image can be downloaded at:
>
>         https://dl.dropboxusercontent.com/u/12436846/jrc_21.tiff
>
> I guess I must be doing something wrong in my code, but can't figure it
> out.  Could somebody please help me to understand how to do this correctly?
>
> Ie, how to I get the colour table from the image linked to above, and set
> that colour table for my destination image?
>
> Cheers,
> Nik.
>
>
>
> GDALColorTableH hCT = GDALGetRasterColorTable( GDALGetRasterBand(hSrcDS,1)
> );
>
> if ( hCT == NULL )
>         NSLog(@"Failed to get colour table.");
> else
>         GDALSetRasterColorTable( GDALGetRasterBand(hDstDS,1), hCT );
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130715/c6128b83/attachment.html>

From warmerdam at pobox.com  Mon Jul 15 17:20:01 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon, 15 Jul 2013 17:20:01 -0700
Subject: [gdal-dev] ECW JPEG2000 SDK v5.0 now available
In-Reply-To: <E672FFB67936104F839A858ACB2EA9F4C0FF46@ap-mbx3.ingrnet.com>
References: <E672FFB67936104F839A858ACB2EA9F4C0FF46@ap-mbx3.ingrnet.com>
Message-ID: <CA+YzLBfVVjgy9zZf=uOXXrqY5QPy6TovX120yoc+dSyAWAErEQ@mail.gmail.com>

Chris,

I tried it out and it looks pretty good.  I appreciate that the various
compiler warnings I saw including the sdk include files in the beta are now
all fixed!

Even,

I see the ecw_29 test case your introduced in r26176 (for #4822) now fails.
 The current results seem to supersample in a different way that GDAL
normally would - an off by a half issue that think is a reasonable
interpretation of how to supersample.  Should the test be modified with a
different case for ECW 5?  Or perhaps the test is just too fragile to be
worthwhile?

Best regards,
Frank


On Sun, Jul 14, 2013 at 8:35 PM, Tweedie, Chris <
Chris.Tweedie at intergraph.com> wrote:

> Hi list,
>
> Due to overwhelming interest from GDAL-ers I have cross posted the
> announcement here. For general SDK questions please post to
> http://geospatial.intergraph.com/Community/forums/27.aspx
>
> SDK v5.0 is now available for download @
> http://geospatial.intergraph.com/products/other/ecw/ERDASECWJPEG2000SDK/Downloads.aspx
>
> Highlights include,
>
> . Linux platform support
> . Visual Studio 2012 support (VC110)
> . Removed TBB dependency
> . Static and dynamic library support
> . ECW v3 format
> - uint16 support
> - null blocks to optimally store and compress imagery with vast no-data or
> null areas
> - improved metadata support, statistics, histogram, RPC native storage
> . Improved image quality for ECW files (decoder only)
> . Vast improvements to the JPEG2000 decoder in terms of performance and
> compatibility
> . Significant encoding performance improvements
> . Full unicode support
> . Improved examples for encoding and decoding
> . Now a single unified library, NCSEcw (.dll / .so)
>
> We are sure it was worth the wait, but let me know if you disagree :-)
>
> Chris
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130715/0dd2c3bf/attachment.html>

From nik at nikosalexandris.net  Tue Jul 16 03:42:04 2013
From: nik at nikosalexandris.net (Nikos Alexandris)
Date: Tue, 16 Jul 2013 13:42:04 +0300
Subject: [gdal-dev] Working with NTF files
In-Reply-To: <CACqBkM_Cx4T+GuZJpqJ+tRA9vgcxgMANCTbLiK4aqdQPYepqtQ@mail.gmail.com>
References: <1694187.sUFg9XEByB@resilience> <1395474.MY5m1vMGQt@vertikal>
	<CACqBkM_Cx4T+GuZJpqJ+tRA9vgcxgMANCTbLiK4aqdQPYepqtQ@mail.gmail.com>
Message-ID: <2493277.K8VfcdhKju@vertikal>

Nikos A:

> > No (except that I left this option as the "final attempt" of many tests --
> > working with some >1GB images here, so it took me hours... :D).  Your
> > confirmation, though, is highly useful!

Eli Adam wrote:

> Sometimes to avoid materializing large intermediate datasets on disk, a VRT
> can be used.  I'm not sure if this would be useful in your case.

Right, in theory it is extremely useful. Dunno if it'll work. In my To Do 
list... :-)


Frank W:

> > On the GDAL side we often have special info in trac wiki pages under the
> > BuildHints page, but in this case the issues are more usage rather than
> > building so there is no obvious place for user contributions.  The format
> > pages for NITF do have quite a bit of info.  It is (I think) the only
> > driver with an "advanced" page.  However, there are many kinds of NITF
> > files and thus usage patterns that are an issue so it isn't clear how to
> > handle that in the user docs.

> I and others have put GDAL usage notes here,
> http://trac.osgeo.org/gdal/wiki/CodeSnippets

Thank you, Nikos

From DCarreira at edia.pt  Tue Jul 16 03:29:37 2013
From: DCarreira at edia.pt (Duarte Carreira)
Date: Tue, 16 Jul 2013 10:29:37 +0000
Subject: [gdal-dev] gtiff with internal mask
Message-ID: <A2C5C1FEBB05AA41A13D4F312D5F1A882DF3018C@AMSPRD0710MB365.eurprd07.prod.outlook.com>

I'm trying to create gtiffs with transparent areas where there are voids between my original images.

I have successfully done it by using an alpha band but this process created 3x larger images. I think partly because of an additional 4th band and partly because I cannot use ycbcr to compress with jpeg. So I thought of using internal masks expecting to get smaller images but cannot get it to work.

When converting from the rgba image using -mask 4 I cannot "see" the transparency and get black areas:

gdal_translate -b 1 -b 2 -b 3 -ma sk 4 --config GDAL_TIFF_INTERNAL_MASK YES test_alpha.tif test_internalmask.tif

I tried looking at the images using qgis and paint.net.

Any hints or help appreciated.

Thanks,
Duarte














Duarte Carreira
Diretor | Dep. Informa??o Geogr?fica e Cartografia

www.edia.pt<http://www.edia.pt>
www.alqueva.com.pt<http://www.alqueva.com.pt>
Tel. +351 284315100

[http://www.edia.pt/edia/images/edia_logo2.gif]<http://www.edia.pt>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130716/76f16048/attachment-0001.html>

From mapoubelle22 at gmail.com  Tue Jul 16 09:55:40 2013
From: mapoubelle22 at gmail.com (fred p)
Date: Tue, 16 Jul 2013 16:55:40 +0000
Subject: [gdal-dev] installing GDAL with a custom installation of zlib
Message-ID: <CADzX+2UviMcnH-V0=2_OpSZ=cyh3hOyC=UCHkbF9XqwP0ais9w@mail.gmail.com>

Hello,

On a Linux platform, I have two versions of zlib :
- the older version is installed with the system in /usr/lib64
- the newer version is installed in a non standard directory

I launch the configure tool with the appropriate --with-zlib=/path/to/the/
newer/version/of/zlib

When compiling, this directory is actually used. But when I execute the
'make install' command, the binary tools I get depend on the older zlib
instead of the newer.

Can someone provide me some help ? Do I miss something ?

Thanks in advance.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130716/0289cf8c/attachment.html>

From even.rouault at mines-paris.org  Tue Jul 16 10:57:44 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 16 Jul 2013 19:57:44 +0200
Subject: [gdal-dev] gtiff with internal mask
In-Reply-To: <A2C5C1FEBB05AA41A13D4F312D5F1A882DF3018C@AMSPRD0710MB365.eurprd07.prod.outlook.com>
References: <A2C5C1FEBB05AA41A13D4F312D5F1A882DF3018C@AMSPRD0710MB365.eurprd07.prod.outlook.com>
Message-ID: <201307161957.44428.even.rouault@mines-paris.org>

Le mardi 16 juillet 2013 12:29:37, Duarte Carreira a ?crit :
> I'm trying to create gtiffs with transparent areas where there are voids
> between my original images.
> 
> I have successfully done it by using an alpha band but this process created
> 3x larger images. I think partly because of an additional 4th band and
> partly because I cannot use ycbcr to compress with jpeg. So I thought of
> using internal masks expecting to get smaller images but cannot get it to
> work.
> 
> When converting from the rgba image using -mask 4 I cannot "see" the
> transparency and get black areas:
> 
> gdal_translate -b 1 -b 2 -b 3 -ma sk 4 --config GDAL_TIFF_INTERNAL_MASK YES
> test_alpha.tif test_internalmask.tif
> 
> I tried looking at the images using qgis and paint.net.

I know QGIS doesn't use the GDALGetMaskBand() API, so no real surprise (that 
would likely be a possible QGIS enhancement). And paint.net probably doesn't 
support this feature of the TIFF format either.

MapServer does support mask bands however.

For QGIS, you could workaround that however. Imagine that you have a YCbCr 
TIFF + internal mask in.tif.

You can do : "gdal_translate -of VRT -b 1 -b 2 -b 3 -b mask in.tif out.vrt"

And QGIS should handle out.vrt as a regular RGBA dataset.

> 
> Any hints or help appreciated.
> 
> Thanks,
> Duarte
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> Duarte Carreira
> Diretor | Dep. Informa??o Geogr?fica e Cartografia
> 
> www.edia.pt<http://www.edia.pt>
> www.alqueva.com.pt<http://www.alqueva.com.pt>
> Tel. +351 284315100
> 
> [http://www.edia.pt/edia/images/edia_logo2.gif]<http://www.edia.pt>

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Tue Jul 16 10:59:03 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 16 Jul 2013 19:59:03 +0200
Subject: [gdal-dev] installing GDAL with a custom installation of zlib
In-Reply-To: <CADzX+2UviMcnH-V0=2_OpSZ=cyh3hOyC=UCHkbF9XqwP0ais9w@mail.gmail.com>
References: <CADzX+2UviMcnH-V0=2_OpSZ=cyh3hOyC=UCHkbF9XqwP0ais9w@mail.gmail.com>
Message-ID: <201307161959.03171.even.rouault@mines-paris.org>

Le mardi 16 juillet 2013 18:55:40, fred p a ?crit :
> Hello,
> 
> On a Linux platform, I have two versions of zlib :
> - the older version is installed with the system in /usr/lib64
> - the newer version is installed in a non standard directory
> 
> I launch the configure tool with the appropriate --with-zlib=/path/to/the/
> newer/version/of/zlib
> 
> When compiling, this directory is actually used. But when I execute the
> 'make install' command, the binary tools I get depend on the older zlib
> instead of the newer.
> 
> Can someone provide me some help ? Do I miss something ?

It is possible that a -L/usr/lib64 is in the linking line in GDALmake.opt. 
Look at it and remove it if found. Another possibility is that your GDAL build 
links to another library that links itself with the system zlib

> 
> Thanks in advance.

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Tue Jul 16 11:52:50 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 16 Jul 2013 20:52:50 +0200
Subject: [gdal-dev] ECW JPEG2000 SDK v5.0 now available
In-Reply-To: <CA+YzLBfVVjgy9zZf=uOXXrqY5QPy6TovX120yoc+dSyAWAErEQ@mail.gmail.com>
References: <E672FFB67936104F839A858ACB2EA9F4C0FF46@ap-mbx3.ingrnet.com>
	<CA+YzLBfVVjgy9zZf=uOXXrqY5QPy6TovX120yoc+dSyAWAErEQ@mail.gmail.com>
Message-ID: <201307162052.50388.even.rouault@mines-paris.org>

> 
> Even,
> 
> I see the ecw_29 test case your introduced in r26176 (for #4822) now fails.
>  The current results seem to supersample in a different way that GDAL
> normally would - an off by a half issue that think is a reasonable
> interpretation of how to supersample.  Should the test be modified with a
> different case for ECW 5?  Or perhaps the test is just too fragile to be
> worthwhile?

I've fixed ecw_29 and ecw_41.

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From spethm at landcareresearch.co.nz  Tue Jul 16 18:48:19 2013
From: spethm at landcareresearch.co.nz (Michael Speth)
Date: Wed, 17 Jul 2013 13:48:19 +1200
Subject: [gdal-dev]  using gdalwarp with a new projection in proj.4
Message-ID: <CAC-DQbUG=PXFGuoP=ERMUG3LrY0wNaM3wJVyre3-RAwE8sP0JQ@mail.gmail.com>

Greetings,
  I am unable to use the HEALpix and rHEALPix projections which have been added about a year ago to proj.4 in gdalwarp.  Is there a configuration file for gdal that needs to be updated for this projection?

Here is the command in question that fails:

gdalwarp -s_srs EPSG:26711 -t_srs '+proj=rhealpix -f '%.2f' -I +lon_0=0 +a=1 +ellps=WGS84 +npole=0 +spole=0 -E'  ~/data/utm_orig.tif rhealpix.tif

The error message
?Translating source or target SRS failed:?

Thanks
--

Michael Speth
Research Systems Developer
Landcare Research

________________________________

Please consider the environment before printing this email
Warning: This electronic message together with any attachments is confidential. If you receive it in error: (i) you must not read, use, disclose, copy or retain it; (ii) please contact the sender immediately by reply email and then delete the emails.
The views expressed in this email may not be those of Landcare Research New Zealand Limited. http://www.landcareresearch.co.nz
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130717/9f4ceeaa/attachment.html>

From nixanz at nixanz.com  Tue Jul 16 22:14:10 2013
From: nixanz at nixanz.com (Nik Sands)
Date: Wed, 17 Jul 2013 15:14:10 +1000
Subject: [gdal-dev] Can GDALCreate be Used for PNG?
Message-ID: <5F09009C-A192-4E7B-BD3F-FBA7C9DB2546@nixanz.com>

Can I use GDALCreate to create (and later write to) PNG images?
If so, is "PNG" the correct string for GDALGetDriverByName?

Otherwise, can somebody please let me know why the code below returns NULL from GDALCreate (assigned to dstDS)?

Advice much appreciated, as always.

Thanks,
Nik.



	GDALDriverH hDriver = GDALGetDriverByName("PNG");
	char **papszOptions = NULL;
	
	papszOptions = CSLSetNameValue( papszOptions, "WORLDFILE", "NO" );
	papszOptions = CSLSetNameValue( papszOptions, "ZLEVEL", "9" );
	
	GDALDatasetH dstDS = GDALCreate( hDriver, "/var/tmp/image.png", 256, 256, 4, GDT_Float32, papszOptions );

From warmerdam at pobox.com  Tue Jul 16 23:50:49 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue, 16 Jul 2013 23:50:49 -0700
Subject: [gdal-dev] Can GDALCreate be Used for PNG?
In-Reply-To: <5F09009C-A192-4E7B-BD3F-FBA7C9DB2546@nixanz.com>
References: <5F09009C-A192-4E7B-BD3F-FBA7C9DB2546@nixanz.com>
Message-ID: <CA+YzLBexxhyp0yWNVrM_peoxeA0i9SvxOMPrh3KAgjp2Ofn5ng@mail.gmail.com>

Nik,

No, the PNG format does not support direct creation, only creation by
copying an existing dataset (GDALCreateCopy()).  You can interactively see
the capabilities of a driver like this:

gdalinfo --format png
Format Details:
  Short Name: PNG
  Long Name: Portable Network Graphics
  Extension: png
  Mime Type: image/png
  Help Topic: frmt_various.html#PNG
  Supports: CreateCopy() - Create dataset by copying another.
  Supports: Virtual IO - eg. /vsimem/
  Creation Datatypes: Byte UInt16

<CreationOptionList>
  <Option name="WORLDFILE" type="boolean" description="Create world file" />
  <Option name="ZLEVEL" type="int" description="DEFLATE compression level
1-9" default="6" />
</CreationOptionList>

The "Supports: CreateCopy()" means you can create the format, but only by
copying an existing dataset.  Formats supporting creation will have
"Supports: Create()".  You can get a broad listing of all formats like this:

gdalinfo --formats
....
  SDTS (rov): SDTS Raster
  DTED (rwv): DTED Elevation Raster
  PNG (rwv): Portable Network Graphics
  JPEG (rwv): JPEG JFIF
  MEM (rw+): In Memory Raster
...

The "w" means it supports at least CreateCopy(). The "+" means it supports
create+update.

Best regards,



On Tue, Jul 16, 2013 at 10:14 PM, Nik Sands <nixanz at nixanz.com> wrote:

> Can I use GDALCreate to create (and later write to) PNG images?
> If so, is "PNG" the correct string for GDALGetDriverByName?
>
> Otherwise, can somebody please let me know why the code below returns NULL
> from GDALCreate (assigned to dstDS)?
>
> Advice much appreciated, as always.
>
> Thanks,
> Nik.
>
>
>
>         GDALDriverH hDriver = GDALGetDriverByName("PNG");
>         char **papszOptions = NULL;
>
>         papszOptions = CSLSetNameValue( papszOptions, "WORLDFILE", "NO" );
>         papszOptions = CSLSetNameValue( papszOptions, "ZLEVEL", "9" );
>
>         GDALDatasetH dstDS = GDALCreate( hDriver, "/var/tmp/image.png",
> 256, 256, 4, GDT_Float32, papszOptions );
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130716/17f033a6/attachment.html>

From ahmettemiz88 at gmail.com  Tue Jul 16 23:52:12 2013
From: ahmettemiz88 at gmail.com (Ahmet Temiz)
Date: Wed, 17 Jul 2013 09:52:12 +0300
Subject: [gdal-dev] intersection map of two maps
Message-ID: <CAJKO1Ys2BA5O_NKGx88F95bM=zF=BXjV6qM-gVAA5iYbeF5qeA@mail.gmail.com>

hello

I have two raster map which have different extents.

I want to create intersection map of two maps.

what expression should I use ?

regards

-- 
Ahmet Temiz
Jeoloji M?h.
Afet ve Acil Durum Y?netimi Ba?kanl???
Planlama ve Zarar Azaltma Dairesi Ba?kanl???


________________________

Ahmet Temiz
Geological Eng.
Information Systems - GIS Group
Disaster and Emergency Management
of Presidency
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130717/aa093bde/attachment.html>

From warmerdam at pobox.com  Tue Jul 16 23:55:05 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue, 16 Jul 2013 23:55:05 -0700
Subject: [gdal-dev] using gdalwarp with a new projection in proj.4
In-Reply-To: <CAC-DQbUG=PXFGuoP=ERMUG3LrY0wNaM3wJVyre3-RAwE8sP0JQ@mail.gmail.com>
References: <CAC-DQbUG=PXFGuoP=ERMUG3LrY0wNaM3wJVyre3-RAwE8sP0JQ@mail.gmail.com>
Message-ID: <CA+YzLBfhTFcAr65H=ChA8N-ZLSMSQqJcxKX3CntnQSGjGukzQQ@mail.gmail.com>

Michael,

Healpix is not directly supported by OGRSpatialReference - the core of the
coordinate system machinery for GDAL/OGR.  However, you can request GDAL to
treat this as a PROJ.4 extension to WKT by adding the +wktext flag.  I
would add that the -E and -f flags are options to the cs2cs commandline
program, and not part of a PROJ.4 coordinate system and so should not be
included.  The result is something like this:

gdalsrsinfo '+proj=rhealpix -I +lon_0=0 +a=1 +ellps=WGS84 +npole=0 +spole=0
+wktext'

PROJ.4 : '+proj=rhealpix -I +lon_0=0 +a=1 +ellps=WGS84 +npole=0 +spole=0
+wktext'

OGC WKT :
PROJCS["unnamed",
    GEOGCS["WGS 84",
        DATUM["unknown",
            SPHEROID["WGS84",6378137,298.257223563]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["custom_proj4"],
    EXTENSION["PROJ4","+proj=rhealpix -I +lon_0=0 +a=1 +ellps=WGS84
+npole=0 +spole=0 +wktext"]]

Best regards,
Frank



On Tue, Jul 16, 2013 at 6:48 PM, Michael Speth <
spethm at landcareresearch.co.nz> wrote:

>  Greetings,
>   I am unable to use the HEALpix and rHEALPix projections which have been
> added about a year ago to proj.4 in gdalwarp.  Is there a configuration
> file for gdal that needs to be updated for this projection?
>
>  Here is the command in question that fails:
>
> gdalwarp -s_srs EPSG:26711 -t_srs '+proj=rhealpix -f '%.2f' -I +lon_0=0
> +a=1 +ellps=WGS84 +npole=0 +spole=0 -E'  ~/data/utm_orig.tif rhealpix.tif
> The error message
> ?Translating source or target SRS failed:?
>
>  Thanks
> --
>
> Michael Speth
> Research Systems Developer
> Landcare Research
>
>
> ------------------------------
>
> Please consider the environment before printing this email
> Warning: This electronic message together with any attachments is
> confidential. If you receive it in error: (i) you must not read, use,
> disclose, copy or retain it; (ii) please contact the sender immediately by
> reply email and then delete the emails.
> The views expressed in this email may not be those of Landcare Research
> New Zealand Limited. http://www.landcareresearch.co.nz
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130716/479ff61a/attachment.html>

From 2284168009 at qq.com  Wed Jul 17 01:25:06 2013
From: 2284168009 at qq.com (=?gb18030?B?wbrM7LO9?=)
Date: Wed, 17 Jul 2013 16:25:06 +0800
Subject: [gdal-dev] Convert x,y to pixel,line in an OGRLinearRing
Message-ID: <tencent_2B43BC7D237B2647418AE116@qq.com>

Hello:
I've got an OGRLinearRing(or OGRPolygon and its type is wkbpolygon)and  affine transformation coefficients(topx,topy,cellxsize,cellysize), now I need to get pixel/line (P,L) raster space value of all points in that   OGRLinearRing object.Can anyone help? Thanks.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130717/080635b4/attachment-0001.html>

From JPalmer at linz.govt.nz  Wed Jul 17 02:17:32 2013
From: JPalmer at linz.govt.nz (Jeremy Palmer)
Date: Wed, 17 Jul 2013 21:17:32 +1200
Subject: [gdal-dev] MSSQLSpatial support for non-spatial tables
Message-ID: <C6B695652D5E6B4597E90C5734C02426169A97FB10@prdlsmmsg01.ad.linz.govt.nz>

Hi gdal devs,

I've attached a patch to http://trac.osgeo.org/gdal/ticket/5155 to support listing, reading and writing of non-spatial tables within the MSSQLSpatial driver. The change also allows the user to set the MSSQLSPATIAL_LIST_ALL_TABLES=YES configuration option to be able to read and list non spatial tables.

Let me know if I need to do anything else to get the patch committed to trunk.

Cheers,
Jeremy

This message contains information, which is confidential and may be subject to legal privilege. If you are not the intended recipient, you must not peruse, use, disseminate, distribute or copy this message. If you have received this message in error, please notify us immediately (Phone 0800 665 463 or info at linz.govt.nz) and destroy the original message. LINZ accepts no responsibility for changes to this email, or for any attachments, after its transmission from LINZ. Thank You.

From szekerest at gmail.com  Wed Jul 17 05:06:13 2013
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed, 17 Jul 2013 14:06:13 +0200
Subject: [gdal-dev] MSSQLSpatial support for non-spatial tables
In-Reply-To: <C6B695652D5E6B4597E90C5734C02426169A97FB10@prdlsmmsg01.ad.linz.govt.nz>
References: <C6B695652D5E6B4597E90C5734C02426169A97FB10@prdlsmmsg01.ad.linz.govt.nz>
Message-ID: <CACALY+T2SfDWjHKJ-nDZHZHpmNQQZSqFLL2RxYUwH9-N0bwYOw@mail.gmail.com>

Jeremy,

Thanks for that, I'll review the patch shortly.

Best regards,

Tamas




2013/7/17 Jeremy Palmer <JPalmer at linz.govt.nz>

> Hi gdal devs,
>
> I've attached a patch to http://trac.osgeo.org/gdal/ticket/5155 to
> support listing, reading and writing of non-spatial tables within the
> MSSQLSpatial driver. The change also allows the user to set the
> MSSQLSPATIAL_LIST_ALL_TABLES=YES configuration option to be able to read
> and list non spatial tables.
>
> Let me know if I need to do anything else to get the patch committed to
> trunk.
>
> Cheers,
> Jeremy
>
> This message contains information, which is confidential and may be
> subject to legal privilege. If you are not the intended recipient, you must
> not peruse, use, disseminate, distribute or copy this message. If you have
> received this message in error, please notify us immediately (Phone 0800
> 665 463 or info at linz.govt.nz) and destroy the original message. LINZ
> accepts no responsibility for changes to this email, or for any
> attachments, after its transmission from LINZ. Thank You.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130717/359bd74f/attachment.html>

From DCarreira at edia.pt  Wed Jul 17 05:23:29 2013
From: DCarreira at edia.pt (Duarte Carreira)
Date: Wed, 17 Jul 2013 12:23:29 +0000
Subject: [gdal-dev] gtiff with internal mask
In-Reply-To: <201307161957.44428.even.rouault@mines-paris.org>
References: <A2C5C1FEBB05AA41A13D4F312D5F1A882DF3018C@AMSPRD0710MB365.eurprd07.prod.outlook.com>
	<201307161957.44428.even.rouault@mines-paris.org>
Message-ID: <A2C5C1FEBB05AA41A13D4F312D5F1A882DF30807@AMSPRD0710MB365.eurprd07.prod.outlook.com>

Hi Even.

Thanks so much for your tip! It works. I did have to specify I did not want an alpha band when cutting with the shapefile:

gdalwarp -multi -wm 480 --config GDAL_CACHEMAX 256 -co photometric=ycbcr -co compress=jpeg -co alpha=no --config GDAL_TIFF_INTERNAL_MASK YES -cutline shapes\index_diss.shp vrtini.vrt testmask.tif

Seems arcgis recognizes the masked tiff, but is much much slower displaying than using a "normal" alpha band.
QGIS does need the vrt trick but then is as fast as usual.

Also, the size is must smaller when using an internal mask: from a 219MB rgba,band interleaved,jpegd image to a 27MB ycbcr,pixel interleaved,jpegd masked tiff (8x smaller). Unless I missed something...

Thanks again!
Duarte

-----Mensagem original-----
De: Even Rouault [mailto:even.rouault at mines-paris.org] 
Enviada: ter?a-feira, 16 de Julho de 2013 18:58
Para: gdal-dev at lists.osgeo.org
Cc: Duarte Carreira
Assunto: Re: [gdal-dev] gtiff with internal mask

Le mardi 16 juillet 2013 12:29:37, Duarte Carreira a ?crit :
> I'm trying to create gtiffs with transparent areas where there are 
> voids between my original images.
> 
> I have successfully done it by using an alpha band but this process 
> created 3x larger images. I think partly because of an additional 4th 
> band and partly because I cannot use ycbcr to compress with jpeg. So I 
> thought of using internal masks expecting to get smaller images but 
> cannot get it to work.
> 
> When converting from the rgba image using -mask 4 I cannot "see" the 
> transparency and get black areas:
> 
> gdal_translate -b 1 -b 2 -b 3 -ma sk 4 --config 
> GDAL_TIFF_INTERNAL_MASK YES test_alpha.tif test_internalmask.tif
> 
> I tried looking at the images using qgis and paint.net.

I know QGIS doesn't use the GDALGetMaskBand() API, so no real surprise (that would likely be a possible QGIS enhancement). And paint.net probably doesn't support this feature of the TIFF format either.

MapServer does support mask bands however.

For QGIS, you could workaround that however. Imagine that you have a YCbCr TIFF + internal mask in.tif.

You can do : "gdal_translate -of VRT -b 1 -b 2 -b 3 -b mask in.tif out.vrt"

And QGIS should handle out.vrt as a regular RGBA dataset.

> 
> Any hints or help appreciated.
> 
> Thanks,
> Duarte
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> Duarte Carreira
> Diretor | Dep. Informa??o Geogr?fica e Cartografia
> 
> www.edia.pt<http://www.edia.pt>
> www.alqueva.com.pt<http://www.alqueva.com.pt>
> Tel. +351 284315100
> 
> [http://www.edia.pt/edia/images/edia_logo2.gif]<http://www.edia.pt>

--
Geospatial professional services
http://even.rouault.free.fr/services.html


From even.rouault at mines-paris.org  Wed Jul 17 05:45:06 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 17 Jul 2013 14:45:06 +0200
Subject: [gdal-dev] gtiff with internal mask
In-Reply-To: <A2C5C1FEBB05AA41A13D4F312D5F1A882DF30807@AMSPRD0710MB365.eurprd07.prod.outlook.com>
References: <A2C5C1FEBB05AA41A13D4F312D5F1A882DF3018C@AMSPRD0710MB365.eurprd07.prod.outlook.com>
	<201307161957.44428.even.rouault@mines-paris.org>
	<A2C5C1FEBB05AA41A13D4F312D5F1A882DF30807@AMSPRD0710MB365.eurprd07.prod.outlook.com>
Message-ID: <201307171445.06549.even.rouault@mines-paris.org>

Le mercredi 17 juillet 2013 14:23:29, Duarte Carreira a ?crit :
> Hi Even.
> 
> Thanks so much for your tip! It works. I did have to specify I did not want
> an alpha band when cutting with the shapefile:
> 
> gdalwarp -multi -wm 480 --config GDAL_CACHEMAX 256 -co photometric=ycbcr
> -co compress=jpeg -co alpha=no --config GDAL_TIFF_INTERNAL_MASK YES
> -cutline shapes\index_diss.shp vrtini.vrt testmask.tif

Hum, what I don't understand is how the above will produce a mask band in the 
output file...

Does gdalinfo on testmask.tif show something like :

Band 1 Block=.... Type=Byte, ColorInterp=Red
  Mask Flags: PER_DATASET 
Band 2 Block=.... Type=Byte, ColorInterp=Green
  Mask Flags: PER_DATASET 
Band 3 Block=... Type=Byte, ColorInterp=Blue
  Mask Flags: PER_DATASET 

I think you would need to do the above in 2 steps:
1) gdalwarp to an uncompressed RGBA TIFF
2) gdal_translate to turn the RGBA into a YCbCr JPEG-compressed GTiff + mask 
band

> 
> Seems arcgis recognizes the masked tiff, but is much much slower displaying
> than using a "normal" alpha band.

Perhaps adding -co TILED=YES will help ? (random guess)

> QGIS does need the vrt trick but then is
> as fast as usual.
> 
> Also, the size is must smaller when using an internal mask: from a 219MB
> rgba,band interleaved,jpegd image to a 27MB ycbcr,pixel interleaved,jpegd
> masked tiff (8x smaller). Unless I missed something...

Not completely surprising although more important than I would have expected. 
YCbCr compression usually gives a 2x to 3x compression bonus, and due to the 
usual nature of mask bands, the 1bit deflate compression of the mask band will 
give better results (both visually and in size) that the 8bit JPEG compression 
of the alpha band.

> 
> Thanks again!
> Duarte
> 
> -----Mensagem original-----
> De: Even Rouault [mailto:even.rouault at mines-paris.org]
> Enviada: ter?a-feira, 16 de Julho de 2013 18:58
> Para: gdal-dev at lists.osgeo.org
> Cc: Duarte Carreira
> Assunto: Re: [gdal-dev] gtiff with internal mask
> 
> Le mardi 16 juillet 2013 12:29:37, Duarte Carreira a ?crit :
> > I'm trying to create gtiffs with transparent areas where there are
> > voids between my original images.
> > 
> > I have successfully done it by using an alpha band but this process
> > created 3x larger images. I think partly because of an additional 4th
> > band and partly because I cannot use ycbcr to compress with jpeg. So I
> > thought of using internal masks expecting to get smaller images but
> > cannot get it to work.
> > 
> > When converting from the rgba image using -mask 4 I cannot "see" the
> > transparency and get black areas:
> > 
> > gdal_translate -b 1 -b 2 -b 3 -ma sk 4 --config
> > GDAL_TIFF_INTERNAL_MASK YES test_alpha.tif test_internalmask.tif
> > 
> > I tried looking at the images using qgis and paint.net.
> 
> I know QGIS doesn't use the GDALGetMaskBand() API, so no real surprise
> (that would likely be a possible QGIS enhancement). And paint.net probably
> doesn't support this feature of the TIFF format either.
> 
> MapServer does support mask bands however.
> 
> For QGIS, you could workaround that however. Imagine that you have a YCbCr
> TIFF + internal mask in.tif.
> 
> You can do : "gdal_translate -of VRT -b 1 -b 2 -b 3 -b mask in.tif out.vrt"
> 
> And QGIS should handle out.vrt as a regular RGBA dataset.
> 
> > Any hints or help appreciated.
> > 
> > Thanks,
> > Duarte
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > Duarte Carreira
> > Diretor | Dep. Informa??o Geogr?fica e Cartografia
> > 
> > www.edia.pt<http://www.edia.pt>
> > www.alqueva.com.pt<http://www.alqueva.com.pt>
> > Tel. +351 284315100
> > 
> > [http://www.edia.pt/edia/images/edia_logo2.gif]<http://www.edia.pt>
> 
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From DCarreira at edia.pt  Wed Jul 17 11:40:57 2013
From: DCarreira at edia.pt (Duarte Carreira)
Date: Wed, 17 Jul 2013 18:40:57 +0000
Subject: [gdal-dev] gtiff with internal mask
In-Reply-To: <201307171445.06549.even.rouault@mines-paris.org>
References: <A2C5C1FEBB05AA41A13D4F312D5F1A882DF3018C@AMSPRD0710MB365.eurprd07.prod.outlook.com>
	<201307161957.44428.even.rouault@mines-paris.org>
	<A2C5C1FEBB05AA41A13D4F312D5F1A882DF30807@AMSPRD0710MB365.eurprd07.prod.outlook.com>
	<201307171445.06549.even.rouault@mines-paris.org>
Message-ID: <A2C5C1FEBB05AA41A13D4F312D5F1A882DF3096F@AMSPRD0710MB365.eurprd07.prod.outlook.com>

Well, you're right... I messed up recreating the footsteps...

So, cleaning up:

1) create a rgba vrt using gdalwarp to cut the original mosaic with a shapefile
gdalwarp -multi -wm 480 --config GDAL_CACHEMAX 312 -co alpha=yes -dstalpha -cutline shapes\index_diss.shp -of vrt originalmosaic.vrt test_rgba_uncomp.vrt

2) create a masked uncompressed vrt using gdal_translate (because I couldn't compress right away, with errors of missing StripOffsets field)
gdal_translate -b 1 -b 2 -b 3 -mask 4 -co alpha=no -co photometric=rgb -co interleave=pixel -co tiled=yes --config GDAL_TIFF_INTERNAL_MASK YES -of vrt  test_rgba_uncomp.vrt testmask_uncomp.vrt

3) create final masked compressed tiff using gdal_translate
gdal_translate -co alpha=no -co photometric=ycbcr -co interleave=pixel -co tiled=yes -co compress=jpeg --config GDAL_TIFF_INTERNAL_MASK YES testmask_uncomp.vrt test_finalmask.tif

The power of VRT amazes me!

Also regarding sizes: I still got the same ratio of 8x smaller.

To use this in QGIS you still have to create a rgba vrt:
4) gdal_translate -of VRT -b 1 -b 2 -b 3 -b mask test_finalmask.tif test_finalmask_qgis.vrt
(couldn't get the 4? band to be recognized as an alpha band though)

So I think now it's correct... I am going to apply this to a real-case mosaic and report back...

Duarte

-----Mensagem original-----
De: Even Rouault [mailto:even.rouault at mines-paris.org] 
Enviada: quarta-feira, 17 de Julho de 2013 13:45
Para: Duarte Carreira
Cc: gdal-dev at lists.osgeo.org
Assunto: Re: [gdal-dev] gtiff with internal mask

Le mercredi 17 juillet 2013 14:23:29, Duarte Carreira a ?crit :
> Hi Even.
> 
> Thanks so much for your tip! It works. I did have to specify I did not 
> want an alpha band when cutting with the shapefile:
> 
> gdalwarp -multi -wm 480 --config GDAL_CACHEMAX 256 -co 
> photometric=ycbcr -co compress=jpeg -co alpha=no --config 
> GDAL_TIFF_INTERNAL_MASK YES -cutline shapes\index_diss.shp vrtini.vrt 
> testmask.tif

Hum, what I don't understand is how the above will produce a mask band in the output file...

Does gdalinfo on testmask.tif show something like :

Band 1 Block=.... Type=Byte, ColorInterp=Red
  Mask Flags: PER_DATASET
Band 2 Block=.... Type=Byte, ColorInterp=Green
  Mask Flags: PER_DATASET
Band 3 Block=... Type=Byte, ColorInterp=Blue
  Mask Flags: PER_DATASET 

I think you would need to do the above in 2 steps:
1) gdalwarp to an uncompressed RGBA TIFF
2) gdal_translate to turn the RGBA into a YCbCr JPEG-compressed GTiff + mask band

> 
> Seems arcgis recognizes the masked tiff, but is much much slower 
> displaying than using a "normal" alpha band.

Perhaps adding -co TILED=YES will help ? (random guess)

> QGIS does need the vrt trick but then is as fast as usual.
> 
> Also, the size is must smaller when using an internal mask: from a 
> 219MB rgba,band interleaved,jpegd image to a 27MB ycbcr,pixel 
> interleaved,jpegd masked tiff (8x smaller). Unless I missed something...

Not completely surprising although more important than I would have expected. 
YCbCr compression usually gives a 2x to 3x compression bonus, and due to the usual nature of mask bands, the 1bit deflate compression of the mask band will give better results (both visually and in size) that the 8bit JPEG compression of the alpha band.

> 
> Thanks again!
> Duarte
> 
> -----Mensagem original-----
> De: Even Rouault [mailto:even.rouault at mines-paris.org]
> Enviada: ter?a-feira, 16 de Julho de 2013 18:58
> Para: gdal-dev at lists.osgeo.org
> Cc: Duarte Carreira
> Assunto: Re: [gdal-dev] gtiff with internal mask
> 
> Le mardi 16 juillet 2013 12:29:37, Duarte Carreira a ?crit :
> > I'm trying to create gtiffs with transparent areas where there are
> > voids between my original images.
> > 
> > I have successfully done it by using an alpha band but this process
> > created 3x larger images. I think partly because of an additional 4th
> > band and partly because I cannot use ycbcr to compress with jpeg. So I
> > thought of using internal masks expecting to get smaller images but
> > cannot get it to work.
> > 
> > When converting from the rgba image using -mask 4 I cannot "see" the
> > transparency and get black areas:
> > 
> > gdal_translate -b 1 -b 2 -b 3 -ma sk 4 --config
> > GDAL_TIFF_INTERNAL_MASK YES test_alpha.tif test_internalmask.tif
> > 
> > I tried looking at the images using qgis and paint.net.
> 
> I know QGIS doesn't use the GDALGetMaskBand() API, so no real surprise
> (that would likely be a possible QGIS enhancement). And paint.net probably
> doesn't support this feature of the TIFF format either.
> 
> MapServer does support mask bands however.
> 
> For QGIS, you could workaround that however. Imagine that you have a YCbCr
> TIFF + internal mask in.tif.
> 
> You can do : "gdal_translate -of VRT -b 1 -b 2 -b 3 -b mask in.tif out.vrt"
> 
> And QGIS should handle out.vrt as a regular RGBA dataset.
> 
> > Any hints or help appreciated.
> > 
> > Thanks,
> > Duarte
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > Duarte Carreira
> > Diretor | Dep. Informa??o Geogr?fica e Cartografia
> > 
> > www.edia.pt<http://www.edia.pt>
> > www.alqueva.com.pt<http://www.alqueva.com.pt>
> > Tel. +351 284315100
> > 
> > [http://www.edia.pt/edia/images/edia_logo2.gif]<http://www.edia.pt>
> 
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html


From jason.greenlaw at noaa.gov  Wed Jul 17 13:31:51 2013
From: jason.greenlaw at noaa.gov (Jason Greenlaw - NOAA Affiliate)
Date: Wed, 17 Jul 2013 16:31:51 -0400
Subject: [gdal-dev] GRIB2 to NetCDF - Large areas of data missing
Message-ID: <CAAoP0Jxf-JWArmgFDrhfyXvtW3SoPfXFwiRCKC6ZH8ns-oqrrA@mail.gmail.com>

I am experiencing strange behavior when reprojecting/converting a GRIB2
file to NetCDF using gdalwarp, where the resulting NetCDF file is missing
lots of data (or possibly being set incorrectly to NoData) west of a
certain longitude.  However, if I instead reproject from GRIB2 to an
intermediate format (e.g. GeoTIFF), then convert to NetCDF using
gdal_translate, the result is correct.

The source projection is the weather service's custom lambert conformal,
and the destination is WGS84.  I'm using the following command:

    gdalwarp -wm 256 -of netcdf -srcnodata 9999.0 -dstnodata 9999.0 -t_srs
EPSG:4326 conus-wspd-01.bin conus-wspd-01.nc

GDAL versions tested were 1.9.2 and 1.10.

Screenshot of original GRIB2 file (first GRIB message) as displayed in
ArcMap: http://jetstreak.unh.edu/gdal/full.png
Screenshot of resulting NetCDF file (variable Band1) as displayed in
ncBrowse: http://jetstreak.unh.edu/gdal/cropped.png

Original GRIB2 file (6.3mb): http://jetstreak.unh.edu/gdal/conus-wspd-01.bin
Resulting NetCDF file (171mb):
http://jetstreak.unh.edu/gdal/conus-wspd-01.nc

Anyone run into a similar problem or have any ideas for how to resolve this?

Thanks,
Jason
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130717/e9e37685/attachment.html>

From etourigny.dev at gmail.com  Wed Jul 17 15:49:35 2013
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Wed, 17 Jul 2013 19:49:35 -0300
Subject: [gdal-dev] GRIB2 to NetCDF - Large areas of data missing
In-Reply-To: <CAAoP0Jxf-JWArmgFDrhfyXvtW3SoPfXFwiRCKC6ZH8ns-oqrrA@mail.gmail.com>
References: <CAAoP0Jxf-JWArmgFDrhfyXvtW3SoPfXFwiRCKC6ZH8ns-oqrrA@mail.gmail.com>
Message-ID: <CA+TxYvMgj9sz83cOhEKGfbBLxKqDQ_b+wpdHYxgjJC-_QJ_3JA@mail.gmail.com>

You probably are experiencing a known bug, when the warping operation needs
more memory than the warp cache.

Try setting adding the following to the gdalwarp command (if it doesn't
work try a larger value).

--config GDAL_CACHEMAX 1000 -wm 1000

Also please update the ticket with any new information

http://trac.osgeo.org/gdal/ticket/4484

cheers
Etienne

On Wed, Jul 17, 2013 at 5:31 PM, Jason Greenlaw - NOAA Affiliate <
jason.greenlaw at noaa.gov> wrote:

> I am experiencing strange behavior when reprojecting/converting a GRIB2
> file to NetCDF using gdalwarp, where the resulting NetCDF file is missing
> lots of data (or possibly being set incorrectly to NoData) west of a
> certain longitude.  However, if I instead reproject from GRIB2 to an
> intermediate format (e.g. GeoTIFF), then convert to NetCDF using
> gdal_translate, the result is correct.
>
> The source projection is the weather service's custom lambert conformal,
> and the destination is WGS84.  I'm using the following command:
>
>     gdalwarp -wm 256 -of netcdf -srcnodata 9999.0 -dstnodata 9999.0 -t_srs
> EPSG:4326 conus-wspd-01.bin conus-wspd-01.nc
>
> GDAL versions tested were 1.9.2 and 1.10.
>
> Screenshot of original GRIB2 file (first GRIB message) as displayed in
> ArcMap: http://jetstreak.unh.edu/gdal/full.png
> Screenshot of resulting NetCDF file (variable Band1) as displayed in
> ncBrowse: http://jetstreak.unh.edu/gdal/cropped.png
>
> Original GRIB2 file (6.3mb):
> http://jetstreak.unh.edu/gdal/conus-wspd-01.bin
> Resulting NetCDF file (171mb):
> http://jetstreak.unh.edu/gdal/conus-wspd-01.nc
>
> Anyone run into a similar problem or have any ideas for how to resolve
> this?
>
> Thanks,
> Jason
>
>
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130717/4bc9a028/attachment.html>

From nixanz at nixanz.com  Wed Jul 17 16:06:40 2013
From: nixanz at nixanz.com (Nik Sands)
Date: Thu, 18 Jul 2013 09:06:40 +1000
Subject: [gdal-dev] Can GDALCreate be Used for PNG?
In-Reply-To: <CA+YzLBexxhyp0yWNVrM_peoxeA0i9SvxOMPrh3KAgjp2Ofn5ng@mail.gmail.com>
References: <5F09009C-A192-4E7B-BD3F-FBA7C9DB2546@nixanz.com>
	<CA+YzLBexxhyp0yWNVrM_peoxeA0i9SvxOMPrh3KAgjp2Ofn5ng@mail.gmail.com>
Message-ID: <BDAD1D27-38EF-40FD-BDC6-702061A8B341@nixanz.com>

Thanks Frank.

So I think I need to do something like the code below instead, ie, create a "MEM" dataset and later create-copy to a "PNG" dataset.  This seems to be working (although the content of the image is all wrong - but that's another issue for me to try to figure out).

Thanks again,
Nik.


GDALDatasetH memDS = GDALCreate( GDALGetDriverByName("MEM"), "tmp", 256, 256, 4, GDT_Float32, NULL );

?
?
?

char **options = NULL;

options = CSLSetNameValue( papszOptions, "WORLDFILE", "NO" );
options = CSLSetNameValue( papszOptions, "ZLEVEL", "9" );

GDALDatasetH dstDS = GDALCreate( hDriver, "/var/tmp/image.png", 256, 256, 4, GDT_Float32, options );
	GDALDatasetH dstDS = GDALCreateCopy( GDALGetDriverByName("PNG"), "/var/tmp/image.png", memDS, FALSE, options, NULL, NULL );


On 17/07/2013, at 4:50 PM, Frank Warmerdam <warmerdam at pobox.com> wrote:

> Nik,
> 
> No, the PNG format does not support direct creation, only creation by copying an existing dataset (GDALCreateCopy()).  You can interactively see the capabilities of a driver like this:
> 
> gdalinfo --format png
> Format Details:
>   Short Name: PNG
>   Long Name: Portable Network Graphics
>   Extension: png
>   Mime Type: image/png
>   Help Topic: frmt_various.html#PNG
>   Supports: CreateCopy() - Create dataset by copying another.
>   Supports: Virtual IO - eg. /vsimem/
>   Creation Datatypes: Byte UInt16
> 
> <CreationOptionList>
>   <Option name="WORLDFILE" type="boolean" description="Create world file" />
>   <Option name="ZLEVEL" type="int" description="DEFLATE compression level 1-9" default="6" />
> </CreationOptionList>
> 
> The "Supports: CreateCopy()" means you can create the format, but only by copying an existing dataset.  Formats supporting creation will have "Supports: Create()".  You can get a broad listing of all formats like this:
> 
> gdalinfo --formats
> ....
>   SDTS (rov): SDTS Raster
>   DTED (rwv): DTED Elevation Raster
>   PNG (rwv): Portable Network Graphics
>   JPEG (rwv): JPEG JFIF
>   MEM (rw+): In Memory Raster
> ...
> 
> The "w" means it supports at least CreateCopy(). The "+" means it supports create+update.  
> 
> Best regards,
> 
> 
> 
> On Tue, Jul 16, 2013 at 10:14 PM, Nik Sands <nixanz at nixanz.com> wrote:
> Can I use GDALCreate to create (and later write to) PNG images?
> If so, is "PNG" the correct string for GDALGetDriverByName?
> 
> Otherwise, can somebody please let me know why the code below returns NULL from GDALCreate (assigned to dstDS)?
> 
> Advice much appreciated, as always.
> 
> Thanks,
> Nik.
> 
> 
> 
>         GDALDriverH hDriver = GDALGetDriverByName("PNG");
>         char **papszOptions = NULL;
> 
>         papszOptions = CSLSetNameValue( papszOptions, "WORLDFILE", "NO" );
>         papszOptions = CSLSetNameValue( papszOptions, "ZLEVEL", "9" );
> 
>         GDALDatasetH dstDS = GDALCreate( hDriver, "/var/tmp/image.png", 256, 256, 4, GDT_Float32, papszOptions );
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 
> 
> -- 
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Software Developer

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130718/778be6b7/attachment.html>

From DCarreira at edia.pt  Thu Jul 18 05:01:21 2013
From: DCarreira at edia.pt (Duarte Carreira)
Date: Thu, 18 Jul 2013 12:01:21 +0000
Subject: [gdal-dev] gtiff with internal mask
References: <A2C5C1FEBB05AA41A13D4F312D5F1A882DF3018C@AMSPRD0710MB365.eurprd07.prod.outlook.com>
	<201307161957.44428.even.rouault@mines-paris.org>
	<A2C5C1FEBB05AA41A13D4F312D5F1A882DF30807@AMSPRD0710MB365.eurprd07.prod.outlook.com>
	<201307171445.06549.even.rouault@mines-paris.org> 
Message-ID: <A2C5C1FEBB05AA41A13D4F312D5F1A882DF30B9F@AMSPRD0710MB365.eurprd07.prod.outlook.com>

So... now I 've got issues building the overviews. Gdaladdo loses the transparency so I get to see black areas where I was supposed to see nothing. When I zoom in black disappears.

Any known way to overcome this?

Thanks,
Duarte



-----Mensagem original-----
De: Duarte Carreira 
Enviada: quarta-feira, 17 de Julho de 2013 19:41
Para: 'Even Rouault'
Cc: gdal-dev at lists.osgeo.org
Assunto: RE: [gdal-dev] gtiff with internal mask

Well, you're right... I messed up recreating the footsteps...

So, cleaning up:

1) create a rgba vrt using gdalwarp to cut the original mosaic with a shapefile gdalwarp -multi -wm 480 --config GDAL_CACHEMAX 312 -co alpha=yes -dstalpha -cutline shapes\index_diss.shp -of vrt originalmosaic.vrt test_rgba_uncomp.vrt

2) create a masked uncompressed vrt using gdal_translate (because I couldn't compress right away, with errors of missing StripOffsets field) gdal_translate -b 1 -b 2 -b 3 -mask 4 -co alpha=no -co photometric=rgb -co interleave=pixel -co tiled=yes --config GDAL_TIFF_INTERNAL_MASK YES -of vrt  test_rgba_uncomp.vrt testmask_uncomp.vrt

3) create final masked compressed tiff using gdal_translate gdal_translate -co alpha=no -co photometric=ycbcr -co interleave=pixel -co tiled=yes -co compress=jpeg --config GDAL_TIFF_INTERNAL_MASK YES testmask_uncomp.vrt test_finalmask.tif

The power of VRT amazes me!

Also regarding sizes: I still got the same ratio of 8x smaller.

To use this in QGIS you still have to create a rgba vrt:
4) gdal_translate -of VRT -b 1 -b 2 -b 3 -b mask test_finalmask.tif test_finalmask_qgis.vrt (couldn't get the 4? band to be recognized as an alpha band though)

So I think now it's correct... I am going to apply this to a real-case mosaic and report back...

Duarte

-----Mensagem original-----
De: Even Rouault [mailto:even.rouault at mines-paris.org]
Enviada: quarta-feira, 17 de Julho de 2013 13:45
Para: Duarte Carreira
Cc: gdal-dev at lists.osgeo.org
Assunto: Re: [gdal-dev] gtiff with internal mask

Le mercredi 17 juillet 2013 14:23:29, Duarte Carreira a ?crit :
> Hi Even.
> 
> Thanks so much for your tip! It works. I did have to specify I did not 
> want an alpha band when cutting with the shapefile:
> 
> gdalwarp -multi -wm 480 --config GDAL_CACHEMAX 256 -co 
> photometric=ycbcr -co compress=jpeg -co alpha=no --config 
> GDAL_TIFF_INTERNAL_MASK YES -cutline shapes\index_diss.shp vrtini.vrt 
> testmask.tif

Hum, what I don't understand is how the above will produce a mask band in the output file...

Does gdalinfo on testmask.tif show something like :

Band 1 Block=.... Type=Byte, ColorInterp=Red
  Mask Flags: PER_DATASET
Band 2 Block=.... Type=Byte, ColorInterp=Green
  Mask Flags: PER_DATASET
Band 3 Block=... Type=Byte, ColorInterp=Blue
  Mask Flags: PER_DATASET 

I think you would need to do the above in 2 steps:
1) gdalwarp to an uncompressed RGBA TIFF
2) gdal_translate to turn the RGBA into a YCbCr JPEG-compressed GTiff + mask band

> 
> Seems arcgis recognizes the masked tiff, but is much much slower 
> displaying than using a "normal" alpha band.

Perhaps adding -co TILED=YES will help ? (random guess)

> QGIS does need the vrt trick but then is as fast as usual.
> 
> Also, the size is must smaller when using an internal mask: from a 
> 219MB rgba,band interleaved,jpegd image to a 27MB ycbcr,pixel 
> interleaved,jpegd masked tiff (8x smaller). Unless I missed something...

Not completely surprising although more important than I would have expected. 
YCbCr compression usually gives a 2x to 3x compression bonus, and due to the usual nature of mask bands, the 1bit deflate compression of the mask band will give better results (both visually and in size) that the 8bit JPEG compression of the alpha band.

> 
> Thanks again!
> Duarte
> 
> -----Mensagem original-----
> De: Even Rouault [mailto:even.rouault at mines-paris.org]
> Enviada: ter?a-feira, 16 de Julho de 2013 18:58
> Para: gdal-dev at lists.osgeo.org
> Cc: Duarte Carreira
> Assunto: Re: [gdal-dev] gtiff with internal mask
> 
> Le mardi 16 juillet 2013 12:29:37, Duarte Carreira a ?crit :
> > I'm trying to create gtiffs with transparent areas where there are 
> > voids between my original images.
> > 
> > I have successfully done it by using an alpha band but this process 
> > created 3x larger images. I think partly because of an additional 
> > 4th band and partly because I cannot use ycbcr to compress with 
> > jpeg. So I thought of using internal masks expecting to get smaller 
> > images but cannot get it to work.
> > 
> > When converting from the rgba image using -mask 4 I cannot "see" the 
> > transparency and get black areas:
> > 
> > gdal_translate -b 1 -b 2 -b 3 -ma sk 4 --config 
> > GDAL_TIFF_INTERNAL_MASK YES test_alpha.tif test_internalmask.tif
> > 
> > I tried looking at the images using qgis and paint.net.
> 
> I know QGIS doesn't use the GDALGetMaskBand() API, so no real surprise 
> (that would likely be a possible QGIS enhancement). And paint.net 
> probably doesn't support this feature of the TIFF format either.
> 
> MapServer does support mask bands however.
> 
> For QGIS, you could workaround that however. Imagine that you have a 
> YCbCr TIFF + internal mask in.tif.
> 
> You can do : "gdal_translate -of VRT -b 1 -b 2 -b 3 -b mask in.tif out.vrt"
> 
> And QGIS should handle out.vrt as a regular RGBA dataset.
> 
> > Any hints or help appreciated.
> > 
> > Thanks,
> > Duarte
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > Duarte Carreira
> > Diretor | Dep. Informa??o Geogr?fica e Cartografia
> > 
> > www.edia.pt<http://www.edia.pt>
> > www.alqueva.com.pt<http://www.alqueva.com.pt>
> > Tel. +351 284315100
> > 
> > [http://www.edia.pt/edia/images/edia_logo2.gif]<http://www.edia.pt>
> 
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html

--
Geospatial professional services
http://even.rouault.free.fr/services.html


From jason.greenlaw at noaa.gov  Thu Jul 18 11:18:20 2013
From: jason.greenlaw at noaa.gov (Jason Greenlaw - NOAA Affiliate)
Date: Thu, 18 Jul 2013 14:18:20 -0400
Subject: [gdal-dev] GRIB2 to NetCDF - Large areas of data missing
In-Reply-To: <CA+TxYvMgj9sz83cOhEKGfbBLxKqDQ_b+wpdHYxgjJC-_QJ_3JA@mail.gmail.com>
References: <CAAoP0Jxf-JWArmgFDrhfyXvtW3SoPfXFwiRCKC6ZH8ns-oqrrA@mail.gmail.com>
	<CA+TxYvMgj9sz83cOhEKGfbBLxKqDQ_b+wpdHYxgjJC-_QJ_3JA@mail.gmail.com>
Message-ID: <CAAoP0Jx46FW8O__HLJn9vyHkvyms20xJVC-Mr-U6d6fVjCPstA@mail.gmail.com>

Etienne,

This workaround seems to have solved my problem, although I needed to
increase the value from 1000 to 2000 in some instances (some of the GRIB2
messages worked with 1000, others didn't).

So I am now using:

    gdalwarp -wm 2000 --config GDAL_CACHEMAX 2000 -of netcdf -srcnodata
9999.0 -dstnodata 9999.0 -t_srs EPSG:4326 conus-wspd-01.bin conus-wspd-01.nc

Thanks very much - I will update the trac ticket.

Jason

<Jason.Greenlaw at noaa.gov>



On Wed, Jul 17, 2013 at 6:49 PM, Etienne Tourigny
<etourigny.dev at gmail.com>wrote:

> You probably are experiencing a known bug, when the warping operation
> needs more memory than the warp cache.
>
> Try setting adding the following to the gdalwarp command (if it doesn't
> work try a larger value).
>
> --config GDAL_CACHEMAX 1000 -wm 1000
>
> Also please update the ticket with any new information
>
> http://trac.osgeo.org/gdal/ticket/4484
>
> cheers
> Etienne
>
> On Wed, Jul 17, 2013 at 5:31 PM, Jason Greenlaw - NOAA Affiliate <
> jason.greenlaw at noaa.gov> wrote:
>
>> I am experiencing strange behavior when reprojecting/converting a GRIB2
>> file to NetCDF using gdalwarp, where the resulting NetCDF file is missing
>> lots of data (or possibly being set incorrectly to NoData) west of a
>> certain longitude.  However, if I instead reproject from GRIB2 to an
>> intermediate format (e.g. GeoTIFF), then convert to NetCDF using
>> gdal_translate, the result is correct.
>>
>> The source projection is the weather service's custom lambert conformal,
>> and the destination is WGS84.  I'm using the following command:
>>
>>     gdalwarp -wm 256 -of netcdf -srcnodata 9999.0 -dstnodata 9999.0
>> -t_srs EPSG:4326 conus-wspd-01.bin conus-wspd-01.nc
>>
>> GDAL versions tested were 1.9.2 and 1.10.
>>
>> Screenshot of original GRIB2 file (first GRIB message) as displayed in
>> ArcMap: http://jetstreak.unh.edu/gdal/full.png
>> Screenshot of resulting NetCDF file (variable Band1) as displayed in
>> ncBrowse: http://jetstreak.unh.edu/gdal/cropped.png
>>
>> Original GRIB2 file (6.3mb):
>> http://jetstreak.unh.edu/gdal/conus-wspd-01.bin
>> Resulting NetCDF file (171mb):
>> http://jetstreak.unh.edu/gdal/conus-wspd-01.nc
>>
>> Anyone run into a similar problem or have any ideas for how to resolve
>> this?
>>
>> Thanks,
>> Jason
>>
>>
>>
>>
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130718/ca0328a3/attachment.html>

From markus.u.mueller at zoho.com  Thu Jul 18 14:05:45 2013
From: markus.u.mueller at zoho.com (=?UTF-8?Q?Markus_M=C3=BCller?=)
Date: Thu, 18 Jul 2013 14:05:45 -0700
Subject: [gdal-dev] using gdalwarp with a new projection in proj.4
In-Reply-To: <CA+YzLBfhTFcAr65H=ChA8N-ZLSMSQqJcxKX3CntnQSGjGukzQQ@mail.gmail.com>
References: <CAC-DQbUG=PXFGuoP=ERMUG3LrY0wNaM3wJVyre3-RAwE8sP0JQ@mail.gmail.com>
	<CA+YzLBfhTFcAr65H=ChA8N-ZLSMSQqJcxKX3CntnQSGjGukzQQ@mail.gmail.com>
Message-ID: <13ff39a5759.-602700004926114767.-7767514066866695555@zoho.com>

Hi Frank,

thanks for the reply. I did as you suggested and gdalsrsinfo acts accordingly.


&gt;&gt;&gt;
gdalsrsinfo '+proj=rhealpix -I +lon_0=0 +a=1 +ellps=WGS84 +npole=0 +spole=0 +wktext'


PROJ.4 : '+proj=rhealpix -I +lon_0=0 +a=1 +ellps=WGS84 +npole=0 +spole=0 +wktext'


OGC WKT :
PROJCS["unnamed",
    GEOGCS["WGS 84",
        DATUM["unknown",
            SPHEROID["WGS84",6378137,298.257223563]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["custom_proj4"],
    EXTENSION["PROJ4","+proj=rhealpix -I +lon_0=0 +a=1 +ellps=WGS84 +npole=0 +spole=0 +wktext"]]

&gt;&gt;&gt;


I then tried the same with gdalwarp (on one of the examples file that comes with GDAL)


&gt;&gt;&gt;
 gdalwarp -s_srs EPSG:26711 -t_srs '+proj=rhealpix -I +lon_0=0 +a=1 +ellps=WGS84 +npole=0 +spole=0 +wktext' ~/data/utm_orig.tif rhealpix.tif
Processing input file /home/markus.mueller/data/utm_orig.tif.
ERROR 6: Failed to initialize PROJ.4 with `+proj=rhealpix -I +lon_0=0 +a=1 +ellps=WGS84 +npole=0 +spole=0 +wktext'.
0...10...20...30...40...50...60...70...80...90...100 - done.

&gt;&gt;&gt;


It produces an output file though. Should I be concerned about the created error or can I ignore it?




Many thanks,


Markus

---- On Tue, 16 Jul 2013 23:55:05 -0700 Frank Warmerdam &lt;warmerdam at pobox.com&gt; wrote ---- 


Michael,


Healpix is not directly supported by OGRSpatialReference - the core of the coordinate system machinery for GDAL/OGR.  However, you can request GDAL to treat this as a PROJ.4 extension to WKT by adding the +wktext flag.  I would add that the -E and -f flags are options to the cs2cs commandline program, and not part of a PROJ.4 coordinate system and so should not be included.  The result is something like this:
 
gdalsrsinfo '+proj=rhealpix -I +lon_0=0 +a=1 +ellps=WGS84 +npole=0 +spole=0 +wktext'

PROJ.4 : '+proj=rhealpix -I +lon_0=0 +a=1 +ellps=WGS84 +npole=0 +spole=0 +wktext'

OGC WKT :
PROJCS["unnamed",
     GEOGCS["WGS 84",
        DATUM["unknown",
            SPHEROID["WGS84",6378137,298.257223563]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
     PROJECTION["custom_proj4"],
    EXTENSION["PROJ4","+proj=rhealpix -I +lon_0=0 +a=1 +ellps=WGS84 +npole=0 +spole=0 +wktext"]]


Best regards,
Frank


 

On Tue, Jul 16, 2013 at 6:48 PM, Michael Speth &lt;spethm at landcareresearch.co.nz&gt; wrote:
  Greetings,   I am unable to use the HEALpix and rHEALPix projections which have been added about a year ago to proj.4 in gdalwarp.  Is there a configuration file for gdal that needs to be updated for this projection?
 
 
 Here is the command in question that fails:
  gdalwarp -s_srs EPSG:26711 -t_srs '+proj=rhealpix -f '%.2f' -I +lon_0=0 +a=1 +ellps=WGS84 +npole=0 +spole=0 -E'  ~/data/utm_orig.tif rhealpix.tif
 The error message
 ?Translating source or target SRS failed:?
 
 
 
 Thanks
 -- 
 Michael Speth Research Systems Developer Landcare Research 
 
 
  
 Please consider the environment before printing this email
 Warning: This electronic message together with any attachments is confidential. If you receive it in error: (i) you must not read, use, disclose, copy or retain it; (ii) please contact the sender immediately by reply email and then delete the emails.
 The views expressed in this email may not be those of Landcare Research New Zealand Limited. http://www.landcareresearch.co.nz
  
 
_______________________________________________
 gdal-dev mailing list
 gdal-dev at lists.osgeo.org
 http://lists.osgeo.org/mailman/listinfo/gdal-dev




-- 
---------------------------------------+--------------------------------------
 I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
 and watch the world go round - Rush    | Geospatial Software Developer
 
 _______________________________________________ 
gdal-dev mailing list 
gdal-dev at lists.osgeo.org 
http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130718/c5aac9af/attachment.html>

From even.rouault at mines-paris.org  Thu Jul 18 14:44:28 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 18 Jul 2013 23:44:28 +0200
Subject: [gdal-dev] using gdalwarp with a new projection in proj.4
In-Reply-To: <13ff39a5759.-602700004926114767.-7767514066866695555@zoho.com>
References: <CAC-DQbUG=PXFGuoP=ERMUG3LrY0wNaM3wJVyre3-RAwE8sP0JQ@mail.gmail.com>
	<CA+YzLBfhTFcAr65H=ChA8N-ZLSMSQqJcxKX3CntnQSGjGukzQQ@mail.gmail.com>
	<13ff39a5759.-602700004926114767.-7767514066866695555@zoho.com>
Message-ID: <201307182344.28626.even.rouault@mines-paris.org>

Le jeudi 18 juillet 2013 23:05:45, Markus M?ller a ?crit :
> Hi Frank,
> 
> thanks for the reply. I did as you suggested and gdalsrsinfo acts
> accordingly.
> 
> 
> &gt;&gt;&gt;
> gdalsrsinfo '+proj=rhealpix -I +lon_0=0 +a=1 +ellps=WGS84 +npole=0 +spole=0
> +wktext'
> 
> 
> PROJ.4 : '+proj=rhealpix -I +lon_0=0 +a=1 +ellps=WGS84 +npole=0 +spole=0
> +wktext'
> 
> 
> OGC WKT :
> PROJCS["unnamed",
>     GEOGCS["WGS 84",
>         DATUM["unknown",
>             SPHEROID["WGS84",6378137,298.257223563]],
>         PRIMEM["Greenwich",0],
>         UNIT["degree",0.0174532925199433]],
>     PROJECTION["custom_proj4"],
>     EXTENSION["PROJ4","+proj=rhealpix -I +lon_0=0 +a=1 +ellps=WGS84
> +npole=0 +spole=0 +wktext"]]
> 
> &gt;&gt;&gt;
> 
> 
> I then tried the same with gdalwarp (on one of the examples file that comes
> with GDAL)
> 
> 
> &gt;&gt;&gt;
>  gdalwarp -s_srs EPSG:26711 -t_srs '+proj=rhealpix -I +lon_0=0 +a=1
> +ellps=WGS84 +npole=0 +spole=0 +wktext' ~/data/utm_orig.tif rhealpix.tif
> Processing input file /home/markus.mueller/data/utm_orig.tif.
> ERROR 6: Failed to initialize PROJ.4 with `+proj=rhealpix -I +lon_0=0 +a=1
> +ellps=WGS84 +npole=0 +spole=0 +wktext'.
> 0...10...20...30...40...50...60...70...80...90...100 - done.
> 
> &gt;&gt;&gt;
> 
> 
> It produces an output file though. Should I be concerned about the created
> error or can I ignore it?

Markus,

Yes, you shouldn't ignore this error. Ideally gdalwarp shouldn't complete when 
such an error occurs. I'll look at that.

First, you should also remove the '-I' parameter. It is a argument of the proj 
command line utility, not a parameter of a PROJ.4 projection string.

Secondly, looking at PROJ history ( 
http://trac.osgeo.org/proj/log/trunk/proj/src/PJ_healpix.c and 
http://trac.osgeo.org/proj/log/tags/4.8.0?rev=2377 ), I see that this 
projection was only introduced in PROJ 4.8.0, so check your PROJ.4 version. I 
also see that a few fixes have been pushed after the 4.8.0 release, so if you 
run into bugs, you might need to compile the trunk version of the svn 
repository.

Best regards,

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From markus.u.mueller at zoho.com  Thu Jul 18 15:48:05 2013
From: markus.u.mueller at zoho.com (=?UTF-8?Q?Markus_M=C3=BCller?=)
Date: Thu, 18 Jul 2013 15:48:05 -0700
Subject: [gdal-dev] using gdalwarp with a new projection in proj.4
In-Reply-To: <201307182344.28626.even.rouault@mines-paris.org>
References: <CAC-DQbUG=PXFGuoP=ERMUG3LrY0wNaM3wJVyre3-RAwE8sP0JQ@mail.gmail.com>
	<CA+YzLBfhTFcAr65H=ChA8N-ZLSMSQqJcxKX3CntnQSGjGukzQQ@mail.gmail.com>
	<13ff39a5759.-602700004926114767.-7767514066866695555@zoho.com>
	<201307182344.28626.even.rouault@mines-paris.org>
Message-ID: <13ff3f80585.-6183802155115762412.-8500109620455587654@zoho.com>

Hi Evan,

removing the '-I' parameter did the trick.


For completeness sake, here the gdalwarp call that worked for me:


gdalwarp -s_srs EPSG:26711 -t_srs '+proj=rhealpix +lon_0=0 +a=1 +ellps=WGS84 +npole=0 +spole=0 +wktext' ~/data/utm_orig.tif rhealpix.tif






Thanks a lot for the help.


Markus

---- On Thu, 18 Jul 2013 14:44:28 -0700 Even Rouault&lt;even.rouault at mines-paris.org&gt; wrote ---- 


Le jeudi 18 juillet 2013 23:05:45, Markus M?ller a ?crit : 
&gt; Hi Frank, 
&gt; 
&gt; thanks for the reply. I did as you suggested and gdalsrsinfo acts 
&gt; accordingly. 
&gt; 
&gt; 
&gt; &amp;gt;&amp;gt;&amp;gt; 
&gt; gdalsrsinfo '+proj=rhealpix -I +lon_0=0 +a=1 +ellps=WGS84 +npole=0 +spole=0 
&gt; +wktext' 
&gt; 
&gt; 
&gt; PROJ.4 : '+proj=rhealpix -I +lon_0=0 +a=1 +ellps=WGS84 +npole=0 +spole=0 
&gt; +wktext' 
&gt; 
&gt; 
&gt; OGC WKT : 
&gt; PROJCS["unnamed", 
&gt; GEOGCS["WGS 84", 
&gt; DATUM["unknown", 
&gt; SPHEROID["WGS84",6378137,298.257223563]], 
&gt; PRIMEM["Greenwich",0], 
&gt; UNIT["degree",0.0174532925199433]], 
&gt; PROJECTION["custom_proj4"], 
&gt; EXTENSION["PROJ4","+proj=rhealpix -I +lon_0=0 +a=1 +ellps=WGS84 
&gt; +npole=0 +spole=0 +wktext"]] 
&gt; 
&gt; &amp;gt;&amp;gt;&amp;gt; 
&gt; 
&gt; 
&gt; I then tried the same with gdalwarp (on one of the examples file that comes 
&gt; with GDAL) 
&gt; 
&gt; 
&gt; &amp;gt;&amp;gt;&amp;gt; 
&gt; gdalwarp -s_srs EPSG:26711 -t_srs '+proj=rhealpix -I +lon_0=0 +a=1 
&gt; +ellps=WGS84 +npole=0 +spole=0 +wktext' ~/data/utm_orig.tif rhealpix.tif 
&gt; Processing input file /home/markus.mueller/data/utm_orig.tif. 
&gt; ERROR 6: Failed to initialize PROJ.4 with `+proj=rhealpix -I +lon_0=0 +a=1 
&gt; +ellps=WGS84 +npole=0 +spole=0 +wktext'. 
&gt; 0...10...20...30...40...50...60...70...80...90...100 - done. 
&gt; 
&gt; &amp;gt;&amp;gt;&amp;gt; 
&gt; 
&gt; 
&gt; It produces an output file though. Should I be concerned about the created 
&gt; error or can I ignore it? 
 
Markus, 
 
Yes, you shouldn't ignore this error. Ideally gdalwarp shouldn't complete when 
such an error occurs. I'll look at that. 
 
First, you should also remove the '-I' parameter. It is a argument of the proj 
command line utility, not a parameter of a PROJ.4 projection string. 
 
Secondly, looking at PROJ history ( 
http://trac.osgeo.org/proj/log/trunk/proj/src/PJ_healpix.c and 
http://trac.osgeo.org/proj/log/tags/4.8.0?rev=2377 ), I see that this 
projection was only introduced in PROJ 4.8.0, so check your PROJ.4 version. I 
also see that a few fixes have been pushed after the 4.8.0 release, so if you 
run into bugs, you might need to compile the trunk version of the svn 
repository. 
 
Best regards, 
 
Even 
 
-- 
Geospatial professional services 
http://even.rouault.free.fr/services.html 



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130718/ae714717/attachment.html>

From chenxian at walkinfo.com.cn  Thu Jul 18 18:31:12 2013
From: chenxian at walkinfo.com.cn (Xian Chen)
Date: Thu, 18 Jul 2013 18:31:12 -0700 (PDT)
Subject: [gdal-dev]  A new ogr driver
Message-ID: <1374197472790-5067479.post@n6.nabble.com>

Hi all,

I'm planning to submit a new driver for accessing Walk files, a geospatial
data format developed  by Walkinfo Tech. mainly for land surveying,
evaluation, planning, checking and data analysis in China.

Walkinfo Tech. is a China-based company founded since 1999, origignally
focused on land surveying software research and development. Currently we
have our own geographic information platform WalkGIS, as well as scores of
GIS desktop, mobile products based on it, including WalkISurvey,
WalkISurface, WalkCheck, WalkFu and so on. The company is also the largest
strategic partner with Esri ArcGIS in China.

The WalkGIS applications use GDAL/OGR as part of its base libaries. The
purpose of developing the Walk driver on GDAL/OGR is to allow other GIS
products such as ArcGIS to access our data more easily and conveniently.

The driver I am working on is already able to get the information such as
layers, features, geometries, and spatial references from Walk files. Can I
get the permission to submit it to GDAL project and share it with other GDAL
developers?


Best Regards,
Xian



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-A-new-ogr-driver-tp5067479.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From spethm at landcareresearch.co.nz  Thu Jul 18 23:17:40 2013
From: spethm at landcareresearch.co.nz (Michael Speth)
Date: Fri, 19 Jul 2013 18:17:40 +1200
Subject: [gdal-dev] using gdalwarp with a new projection in proj.4
In-Reply-To: <201307182344.28626.even.rouault@mines-paris.org>
References: <CAC-DQbUG=PXFGuoP=ERMUG3LrY0wNaM3wJVyre3-RAwE8sP0JQ@mail.gmail.com>
	<CA+YzLBfhTFcAr65H=ChA8N-ZLSMSQqJcxKX3CntnQSGjGukzQQ@mail.gmail.com>
	<13ff39a5759.-602700004926114767.-7767514066866695555@zoho.com>
	<201307182344.28626.even.rouault@mines-paris.org>
Message-ID: <CAC-DQbUxb1h-f57k5=mr+hivZ5SJeBwS7j+DsFwHPqBrE3XPWg@mail.gmail.com>

Even wrote:
 I see that this projection was only introduced in PROJ 4.8.0, so check your PROJ.4 version.

Markus is using Rev 2375 of the proj.4 upstream SVN with the scaling patch for HEALPix/rHEALPix applied from this<http://trac.osgeo.org/proj/ticket/219> patch.

Thank you for your help!
--

Michael Speth
Research Systems Developer
Landcare Research

________________________________

Please consider the environment before printing this email
Warning: This electronic message together with any attachments is confidential. If you receive it in error: (i) you must not read, use, disclose, copy or retain it; (ii) please contact the sender immediately by reply email and then delete the emails.
The views expressed in this email may not be those of Landcare Research New Zealand Limited. http://www.landcareresearch.co.nz
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130719/fc47d809/attachment-0001.html>

From DCarreira at edia.pt  Fri Jul 19 04:27:26 2013
From: DCarreira at edia.pt (Duarte Carreira)
Date: Fri, 19 Jul 2013 11:27:26 +0000
Subject: [gdal-dev] gtiff with internal mask
References: <A2C5C1FEBB05AA41A13D4F312D5F1A882DF3018C@AMSPRD0710MB365.eurprd07.prod.outlook.com>
	<201307161957.44428.even.rouault@mines-paris.org>
	<A2C5C1FEBB05AA41A13D4F312D5F1A882DF30807@AMSPRD0710MB365.eurprd07.prod.outlook.com>
	<201307171445.06549.even.rouault@mines-paris.org>   
Message-ID: <A2C5C1FEBB05AA41A13D4F312D5F1A882DF32046@AMSPRD0710MB365.eurprd07.prod.outlook.com>

Please ignore previous email... should be a note to self...

-----Mensagem original-----
De: Duarte Carreira 
Enviada: sexta-feira, 19 de Julho de 2013 12:27
Para: 'Even Rouault'
Cc: 'gdal-dev at lists.osgeo.org'
Assunto: RE: [gdal-dev] gtiff with internal mask

Ok, para conseguir construir as pir?mides temos de ter a m?scara separada e n?o inclu?da no pr?prio tiff.

Para isso basta alterar o 3? passo que cria efectivamente o tiff a partir do vrt, removendo a op??o de criar a m?scara interna, ficando assim:
gdal_translate -co alpha=no -co photometric=ycbcr -co interleave=pixel -co tiled=yes -co compress=jpeg testmask_uncomp.vrt test_finalmask.tif

Isto basta para que seja criado um tif rgb e um ficheiro .msk separados.

*** Para criar um rgb+iv num s? tiff, com m?scara! ***

Alterar o mosaico vrt criado no 2? passo, que j? inclui a m?scara, e criar uma banda Gray com origem no mosaico vrt dos infravermelhos.
Depois ? s? converter mas usando as op??es: -co alpha=no -co photometric=rgb e talvez -co interleave=band (para n?o dar erro). N?o podemos usar ycbcr porque s? d? para 3 bandas e n?s temos 4.

DC



-----Mensagem original-----
De: Duarte Carreira
Enviada: quinta-feira, 18 de Julho de 2013 13:01
Para: 'Even Rouault'
Cc: 'gdal-dev at lists.osgeo.org'
Assunto: RE: [gdal-dev] gtiff with internal mask

So... now I 've got issues building the overviews. Gdaladdo loses the transparency so I get to see black areas where I was supposed to see nothing. When I zoom in black disappears.

Any known way to overcome this?

Thanks,
Duarte



-----Mensagem original-----
De: Duarte Carreira
Enviada: quarta-feira, 17 de Julho de 2013 19:41
Para: 'Even Rouault'
Cc: gdal-dev at lists.osgeo.org
Assunto: RE: [gdal-dev] gtiff with internal mask

Well, you're right... I messed up recreating the footsteps...

So, cleaning up:

1) create a rgba vrt using gdalwarp to cut the original mosaic with a shapefile gdalwarp -multi -wm 480 --config GDAL_CACHEMAX 312 -co alpha=yes -dstalpha -cutline shapes\index_diss.shp -of vrt originalmosaic.vrt test_rgba_uncomp.vrt

2) create a masked uncompressed vrt using gdal_translate (because I couldn't compress right away, with errors of missing StripOffsets field) gdal_translate -b 1 -b 2 -b 3 -mask 4 -co alpha=no -co photometric=rgb -co interleave=pixel -co tiled=yes --config GDAL_TIFF_INTERNAL_MASK YES -of vrt  test_rgba_uncomp.vrt testmask_uncomp.vrt

3) create final masked compressed tiff using gdal_translate gdal_translate -co alpha=no -co photometric=ycbcr -co interleave=pixel -co tiled=yes -co compress=jpeg --config GDAL_TIFF_INTERNAL_MASK YES testmask_uncomp.vrt test_finalmask.tif

The power of VRT amazes me!

Also regarding sizes: I still got the same ratio of 8x smaller.

To use this in QGIS you still have to create a rgba vrt:
4) gdal_translate -of VRT -b 1 -b 2 -b 3 -b mask test_finalmask.tif test_finalmask_qgis.vrt (couldn't get the 4? band to be recognized as an alpha band though)

So I think now it's correct... I am going to apply this to a real-case mosaic and report back...

Duarte

-----Mensagem original-----
De: Even Rouault [mailto:even.rouault at mines-paris.org]
Enviada: quarta-feira, 17 de Julho de 2013 13:45
Para: Duarte Carreira
Cc: gdal-dev at lists.osgeo.org
Assunto: Re: [gdal-dev] gtiff with internal mask

Le mercredi 17 juillet 2013 14:23:29, Duarte Carreira a ?crit :
> Hi Even.
> 
> Thanks so much for your tip! It works. I did have to specify I did not 
> want an alpha band when cutting with the shapefile:
> 
> gdalwarp -multi -wm 480 --config GDAL_CACHEMAX 256 -co 
> photometric=ycbcr -co compress=jpeg -co alpha=no --config 
> GDAL_TIFF_INTERNAL_MASK YES -cutline shapes\index_diss.shp vrtini.vrt 
> testmask.tif

Hum, what I don't understand is how the above will produce a mask band in the output file...

Does gdalinfo on testmask.tif show something like :

Band 1 Block=.... Type=Byte, ColorInterp=Red
  Mask Flags: PER_DATASET
Band 2 Block=.... Type=Byte, ColorInterp=Green
  Mask Flags: PER_DATASET
Band 3 Block=... Type=Byte, ColorInterp=Blue
  Mask Flags: PER_DATASET 

I think you would need to do the above in 2 steps:
1) gdalwarp to an uncompressed RGBA TIFF
2) gdal_translate to turn the RGBA into a YCbCr JPEG-compressed GTiff + mask band

> 
> Seems arcgis recognizes the masked tiff, but is much much slower 
> displaying than using a "normal" alpha band.

Perhaps adding -co TILED=YES will help ? (random guess)

> QGIS does need the vrt trick but then is as fast as usual.
> 
> Also, the size is must smaller when using an internal mask: from a 
> 219MB rgba,band interleaved,jpegd image to a 27MB ycbcr,pixel 
> interleaved,jpegd masked tiff (8x smaller). Unless I missed something...

Not completely surprising although more important than I would have expected. 
YCbCr compression usually gives a 2x to 3x compression bonus, and due to the usual nature of mask bands, the 1bit deflate compression of the mask band will give better results (both visually and in size) that the 8bit JPEG compression of the alpha band.

> 
> Thanks again!
> Duarte
> 
> -----Mensagem original-----
> De: Even Rouault [mailto:even.rouault at mines-paris.org]
> Enviada: ter?a-feira, 16 de Julho de 2013 18:58
> Para: gdal-dev at lists.osgeo.org
> Cc: Duarte Carreira
> Assunto: Re: [gdal-dev] gtiff with internal mask
> 
> Le mardi 16 juillet 2013 12:29:37, Duarte Carreira a ?crit :
> > I'm trying to create gtiffs with transparent areas where there are 
> > voids between my original images.
> > 
> > I have successfully done it by using an alpha band but this process 
> > created 3x larger images. I think partly because of an additional 
> > 4th band and partly because I cannot use ycbcr to compress with 
> > jpeg. So I thought of using internal masks expecting to get smaller 
> > images but cannot get it to work.
> > 
> > When converting from the rgba image using -mask 4 I cannot "see" the 
> > transparency and get black areas:
> > 
> > gdal_translate -b 1 -b 2 -b 3 -ma sk 4 --config 
> > GDAL_TIFF_INTERNAL_MASK YES test_alpha.tif test_internalmask.tif
> > 
> > I tried looking at the images using qgis and paint.net.
> 
> I know QGIS doesn't use the GDALGetMaskBand() API, so no real surprise 
> (that would likely be a possible QGIS enhancement). And paint.net 
> probably doesn't support this feature of the TIFF format either.
> 
> MapServer does support mask bands however.
> 
> For QGIS, you could workaround that however. Imagine that you have a 
> YCbCr TIFF + internal mask in.tif.
> 
> You can do : "gdal_translate -of VRT -b 1 -b 2 -b 3 -b mask in.tif out.vrt"
> 
> And QGIS should handle out.vrt as a regular RGBA dataset.
> 
> > Any hints or help appreciated.
> > 
> > Thanks,
> > Duarte
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > Duarte Carreira
> > Diretor | Dep. Informa??o Geogr?fica e Cartografia
> > 
> > www.edia.pt<http://www.edia.pt>
> > www.alqueva.com.pt<http://www.alqueva.com.pt>
> > Tel. +351 284315100
> > 
> > [http://www.edia.pt/edia/images/edia_logo2.gif]<http://www.edia.pt>
> 
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html

--
Geospatial professional services
http://even.rouault.free.fr/services.html


From DCarreira at edia.pt  Fri Jul 19 04:26:38 2013
From: DCarreira at edia.pt (Duarte Carreira)
Date: Fri, 19 Jul 2013 11:26:38 +0000
Subject: [gdal-dev] gtiff with internal mask
References: <A2C5C1FEBB05AA41A13D4F312D5F1A882DF3018C@AMSPRD0710MB365.eurprd07.prod.outlook.com>
	<201307161957.44428.even.rouault@mines-paris.org>
	<A2C5C1FEBB05AA41A13D4F312D5F1A882DF30807@AMSPRD0710MB365.eurprd07.prod.outlook.com>
	<201307171445.06549.even.rouault@mines-paris.org>  
Message-ID: <A2C5C1FEBB05AA41A13D4F312D5F1A882DF32038@AMSPRD0710MB365.eurprd07.prod.outlook.com>

Ok, para conseguir construir as pir?mides temos de ter a m?scara separada e n?o inclu?da no pr?prio tiff.

Para isso basta alterar o 3? passo que cria efectivamente o tiff a partir do vrt, removendo a op??o de criar a m?scara interna, ficando assim:
gdal_translate -co alpha=no -co photometric=ycbcr -co interleave=pixel -co tiled=yes -co compress=jpeg testmask_uncomp.vrt test_finalmask.tif

Isto basta para que seja criado um tif rgb e um ficheiro .msk separados.

*** Para criar um rgb+iv num s? tiff, com m?scara! ***

Alterar o mosaico vrt criado no 2? passo, que j? inclui a m?scara, e criar uma banda Gray com origem no mosaico vrt dos infravermelhos.
Depois ? s? converter mas usando as op??es: -co alpha=no -co photometric=rgb e talvez -co interleave=band (para n?o dar erro). N?o podemos usar ycbcr porque s? d? para 3 bandas e n?s temos 4.

DC



-----Mensagem original-----
De: Duarte Carreira 
Enviada: quinta-feira, 18 de Julho de 2013 13:01
Para: 'Even Rouault'
Cc: 'gdal-dev at lists.osgeo.org'
Assunto: RE: [gdal-dev] gtiff with internal mask

So... now I 've got issues building the overviews. Gdaladdo loses the transparency so I get to see black areas where I was supposed to see nothing. When I zoom in black disappears.

Any known way to overcome this?

Thanks,
Duarte



-----Mensagem original-----
De: Duarte Carreira
Enviada: quarta-feira, 17 de Julho de 2013 19:41
Para: 'Even Rouault'
Cc: gdal-dev at lists.osgeo.org
Assunto: RE: [gdal-dev] gtiff with internal mask

Well, you're right... I messed up recreating the footsteps...

So, cleaning up:

1) create a rgba vrt using gdalwarp to cut the original mosaic with a shapefile gdalwarp -multi -wm 480 --config GDAL_CACHEMAX 312 -co alpha=yes -dstalpha -cutline shapes\index_diss.shp -of vrt originalmosaic.vrt test_rgba_uncomp.vrt

2) create a masked uncompressed vrt using gdal_translate (because I couldn't compress right away, with errors of missing StripOffsets field) gdal_translate -b 1 -b 2 -b 3 -mask 4 -co alpha=no -co photometric=rgb -co interleave=pixel -co tiled=yes --config GDAL_TIFF_INTERNAL_MASK YES -of vrt  test_rgba_uncomp.vrt testmask_uncomp.vrt

3) create final masked compressed tiff using gdal_translate gdal_translate -co alpha=no -co photometric=ycbcr -co interleave=pixel -co tiled=yes -co compress=jpeg --config GDAL_TIFF_INTERNAL_MASK YES testmask_uncomp.vrt test_finalmask.tif

The power of VRT amazes me!

Also regarding sizes: I still got the same ratio of 8x smaller.

To use this in QGIS you still have to create a rgba vrt:
4) gdal_translate -of VRT -b 1 -b 2 -b 3 -b mask test_finalmask.tif test_finalmask_qgis.vrt (couldn't get the 4? band to be recognized as an alpha band though)

So I think now it's correct... I am going to apply this to a real-case mosaic and report back...

Duarte

-----Mensagem original-----
De: Even Rouault [mailto:even.rouault at mines-paris.org]
Enviada: quarta-feira, 17 de Julho de 2013 13:45
Para: Duarte Carreira
Cc: gdal-dev at lists.osgeo.org
Assunto: Re: [gdal-dev] gtiff with internal mask

Le mercredi 17 juillet 2013 14:23:29, Duarte Carreira a ?crit :
> Hi Even.
> 
> Thanks so much for your tip! It works. I did have to specify I did not 
> want an alpha band when cutting with the shapefile:
> 
> gdalwarp -multi -wm 480 --config GDAL_CACHEMAX 256 -co 
> photometric=ycbcr -co compress=jpeg -co alpha=no --config 
> GDAL_TIFF_INTERNAL_MASK YES -cutline shapes\index_diss.shp vrtini.vrt 
> testmask.tif

Hum, what I don't understand is how the above will produce a mask band in the output file...

Does gdalinfo on testmask.tif show something like :

Band 1 Block=.... Type=Byte, ColorInterp=Red
  Mask Flags: PER_DATASET
Band 2 Block=.... Type=Byte, ColorInterp=Green
  Mask Flags: PER_DATASET
Band 3 Block=... Type=Byte, ColorInterp=Blue
  Mask Flags: PER_DATASET 

I think you would need to do the above in 2 steps:
1) gdalwarp to an uncompressed RGBA TIFF
2) gdal_translate to turn the RGBA into a YCbCr JPEG-compressed GTiff + mask band

> 
> Seems arcgis recognizes the masked tiff, but is much much slower 
> displaying than using a "normal" alpha band.

Perhaps adding -co TILED=YES will help ? (random guess)

> QGIS does need the vrt trick but then is as fast as usual.
> 
> Also, the size is must smaller when using an internal mask: from a 
> 219MB rgba,band interleaved,jpegd image to a 27MB ycbcr,pixel 
> interleaved,jpegd masked tiff (8x smaller). Unless I missed something...

Not completely surprising although more important than I would have expected. 
YCbCr compression usually gives a 2x to 3x compression bonus, and due to the usual nature of mask bands, the 1bit deflate compression of the mask band will give better results (both visually and in size) that the 8bit JPEG compression of the alpha band.

> 
> Thanks again!
> Duarte
> 
> -----Mensagem original-----
> De: Even Rouault [mailto:even.rouault at mines-paris.org]
> Enviada: ter?a-feira, 16 de Julho de 2013 18:58
> Para: gdal-dev at lists.osgeo.org
> Cc: Duarte Carreira
> Assunto: Re: [gdal-dev] gtiff with internal mask
> 
> Le mardi 16 juillet 2013 12:29:37, Duarte Carreira a ?crit :
> > I'm trying to create gtiffs with transparent areas where there are 
> > voids between my original images.
> > 
> > I have successfully done it by using an alpha band but this process 
> > created 3x larger images. I think partly because of an additional 
> > 4th band and partly because I cannot use ycbcr to compress with 
> > jpeg. So I thought of using internal masks expecting to get smaller 
> > images but cannot get it to work.
> > 
> > When converting from the rgba image using -mask 4 I cannot "see" the 
> > transparency and get black areas:
> > 
> > gdal_translate -b 1 -b 2 -b 3 -ma sk 4 --config 
> > GDAL_TIFF_INTERNAL_MASK YES test_alpha.tif test_internalmask.tif
> > 
> > I tried looking at the images using qgis and paint.net.
> 
> I know QGIS doesn't use the GDALGetMaskBand() API, so no real surprise 
> (that would likely be a possible QGIS enhancement). And paint.net 
> probably doesn't support this feature of the TIFF format either.
> 
> MapServer does support mask bands however.
> 
> For QGIS, you could workaround that however. Imagine that you have a 
> YCbCr TIFF + internal mask in.tif.
> 
> You can do : "gdal_translate -of VRT -b 1 -b 2 -b 3 -b mask in.tif out.vrt"
> 
> And QGIS should handle out.vrt as a regular RGBA dataset.
> 
> > Any hints or help appreciated.
> > 
> > Thanks,
> > Duarte
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > Duarte Carreira
> > Diretor | Dep. Informa??o Geogr?fica e Cartografia
> > 
> > www.edia.pt<http://www.edia.pt>
> > www.alqueva.com.pt<http://www.alqueva.com.pt>
> > Tel. +351 284315100
> > 
> > [http://www.edia.pt/edia/images/edia_logo2.gif]<http://www.edia.pt>
> 
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html

--
Geospatial professional services
http://even.rouault.free.fr/services.html


From dan.strobridge at westonsolutions.com  Fri Jul 19 08:23:24 2013
From: dan.strobridge at westonsolutions.com (Dan Strobridge)
Date: Fri, 19 Jul 2013 08:23:24 -0700 (PDT)
Subject: [gdal-dev] Dissolve shapefile using GDAL/OGR
In-Reply-To: <CAKGFd-ya0QuY0jJ+7FberUWOE0dckXNjmxXWBwCN0gHNy82RYA@mail.gmail.com>
References: <CAKGFd-zX5HftF611LHoWhzv6kVXMcXMAB5PJsxKMJC_D_pXEiA@mail.gmail.com>
	<loom.20130226T150433-186@post.gmane.org>
	<CAKGFd-ya0QuY0jJ+7FberUWOE0dckXNjmxXWBwCN0gHNy82RYA@mail.gmail.com>
Message-ID: <1374247404172-5067633.post@n6.nabble.com>

I'm getting the same ST_Union error as Benicio but I know I have Spatialite
(v.3.0.1-2), SQLite (3.7.10-2), and Geos (3.3.8-1) from my OSGeo4W install
on Win7.  I also tried using the GUnion function, which appears to have been
replaced by ST_Union at 3.0.0.  In fact, none of the  spatial operator
functions
<http://www.gaia-gis.it/spatialite-3.0.0-BETA/spatialite-sql-3.0.0.html#p14> 
) appear to work.

This is the first time I've tried implementing anything other than a format
conversion or a simple select query using ogr.  Could anyone suggest an
ogr2ogr command to me that would test whether it's a Spatialite/Geos
installation problem or simply a bug?

Thanks,
Dan Strobridge


+ ogr2ogr -append test6.shp poly.gmt --debug on -dialect sqlite -sql select
ST_Union(Geometry),zone from poly GROUP BY zone
OGR: OGROpen(poly.gmt/035FC9C0) succeeded as GMT.
Shape: DBF Codepage = LDID/87 for test6.shp
Shape: Treating as encoding 'ISO-8859-1'.
OGR: OGROpen(test6.shp/03615808) succeeded as ESRI Shapefile.
ERROR 1: Undefined function 'ST_Union' used.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Dissolve-shapefile-using-GDAL-OGR-tp5036930p5067633.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at mines-paris.org  Fri Jul 19 10:59:36 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 19 Jul 2013 19:59:36 +0200
Subject: [gdal-dev] Dissolve shapefile using GDAL/OGR
In-Reply-To: <1374247404172-5067633.post@n6.nabble.com>
References: <CAKGFd-zX5HftF611LHoWhzv6kVXMcXMAB5PJsxKMJC_D_pXEiA@mail.gmail.com>
	<CAKGFd-ya0QuY0jJ+7FberUWOE0dckXNjmxXWBwCN0gHNy82RYA@mail.gmail.com>
	<1374247404172-5067633.post@n6.nabble.com>
Message-ID: <201307191959.36508.even.rouault@mines-paris.org>

Le vendredi 19 juillet 2013 17:23:24, Dan Strobridge a ?crit :
> I'm getting the same ST_Union error as Benicio but I know I have Spatialite
> (v.3.0.1-2), SQLite (3.7.10-2), and Geos (3.3.8-1) from my OSGeo4W install
> on Win7.  I also tried using the GUnion function, which appears to have
> been replaced by ST_Union at 3.0.0.  In fact, none of the  spatial
> operator functions
> <http://www.gaia-gis.it/spatialite-3.0.0-BETA/spatialite-sql-3.0.0.html#p14
> > ) appear to work.
> 
> This is the first time I've tried implementing anything other than a format
> conversion or a simple select query using ogr.  Could anyone suggest an
> ogr2ogr command to me that would test whether it's a Spatialite/Geos
> installation problem or simply a bug?

Dan,

If http://trac.osgeo.org/osgeo4w/wiki/pkg-gdal is up-to-date, the current 
version of GDAL in OSGeo4W would be GDAL 1.9.X. The SQLite dialect is a new 
function of GDAL 1.10 ...

A workaround is to translate your shapefile into a temporary spatialite DB, and 
then do the conversion to GMT with the SQL query.

Best regards,

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From dan.strobridge at westonsolutions.com  Fri Jul 19 11:14:05 2013
From: dan.strobridge at westonsolutions.com (Dan Strobridge)
Date: Fri, 19 Jul 2013 11:14:05 -0700 (PDT)
Subject: [gdal-dev] [BULK]  Re: Dissolve shapefile using GDAL/OGR
In-Reply-To: <201307191959.36508.even.rouault@mines-paris.org>
References: <CAKGFd-zX5HftF611LHoWhzv6kVXMcXMAB5PJsxKMJC_D_pXEiA@mail.gmail.com>
	<loom.20130226T150433-186@post.gmane.org>
	<CAKGFd-ya0QuY0jJ+7FberUWOE0dckXNjmxXWBwCN0gHNy82RYA@mail.gmail.com>
	<1374247404172-5067633.post@n6.nabble.com>
	<201307191959.36508.even.rouault@mines-paris.org>
Message-ID: <AA4FE6F1C40C7F42843DFCC503EE2DA11695A311CE@EXCHANGE.corp.rfweston.com>

Thanks Evan.  I will try the workaround and use it until GDAL 1.10 has been incorporated into OSGeo4W.

Since you?ve brought up the OSGeo4W installer? mine says my gdal library is current (1.9.2-2) bu when I launch the shell I see the following, which suggests an older version is actually getting loaded.  You don?t happen to know how to resolve this, do you?

OSGEO4W home is C:\OSGeo4W\

                   -={ OSGeo4W Shell Commands }=-
find: unable to access ".exe": The system cannot find the file specified.
find: unable to access ".bat": The system cannot find the file specified.

GDAL 1.7.3, released 2010/11/10


Thanks so much,
Dan



From: Even Rouault [via OSGeo.org] [mailto:ml-node+s1560n5067676h80 at n6.nabble.com]
Sent: Friday, July 19, 2013 2:01 PM
To: Strobridge, Daniel M.
Subject: [BULK] Re: Dissolve shapefile using GDAL/OGR

Le vendredi 19 juillet 2013 17:23:24, Dan Strobridge a ?crit :

> I'm getting the same ST_Union error as Benicio but I know I have Spatialite
> (v.3.0.1-2), SQLite (3.7.10-2), and Geos (3.3.8-1) from my OSGeo4W install
> on Win7.  I also tried using the GUnion function, which appears to have
> been replaced by ST_Union at 3.0.0.  In fact, none of the  spatial
> operator functions
> <http://www.gaia-gis.it/spatialite-3.0.0-BETA/spatialite-sql-3.0.0.html#p14
> > ) appear to work.
>
> This is the first time I've tried implementing anything other than a format
> conversion or a simple select query using ogr.  Could anyone suggest an
> ogr2ogr command to me that would test whether it's a Spatialite/Geos
> installation problem or simply a bug?

Dan,

If http://trac.osgeo.org/osgeo4w/wiki/pkg-gdal is up-to-date, the current
version of GDAL in OSGeo4W would be GDAL 1.9.X. The SQLite dialect is a new
function of GDAL 1.10 ...

A workaround is to translate your shapefile into a temporary spatialite DB, and
then do the conversion to GMT with the SQL query.

Best regards,

Even

--
Geospatial professional services
http://even.rouault.free.fr/services.html
_______________________________________________
gdal-dev mailing list
[hidden email]</user/SendEmail.jtp?type=node&node=5067676&i=0>
http://lists.osgeo.org/mailman/listinfo/gdal-dev

________________________________
If you reply to this email, your message will be added to the discussion below:
http://osgeo-org.1560.x6.nabble.com/gdal-dev-Dissolve-shapefile-using-GDAL-OGR-tp5036930p5067676.html
To unsubscribe from [gdal-dev] Dissolve shapefile using GDAL/OGR, click here<http://osgeo-org.1560.x6.nabble.com/template/NamlServlet.jtp?macro=unsubscribe_by_code&node=5036930&code=ZGFuLnN0cm9icmlkZ2VAd2VzdG9uc29sdXRpb25zLmNvbXw1MDM2OTMwfDIwMDMxMDQ3Mjk=>.
NAML<http://osgeo-org.1560.x6.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&id=instant_html%21nabble%3Aemail.naml&base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.NodeNamespace&breadcrumbs=notify_subscribers%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml>

CONFIDENTIALITY:  This email and attachments may contain information which is confidential and proprietary.  Disclosure or use of any such confidential or proprietary information without the written permission of Weston Solutions, Inc. is strictly prohibited.  If you received this email in error, please notify the sender by return e-mail and delete this email from your system.  Thank you.




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Dissolve-shapefile-using-GDAL-OGR-tp5036930p5067681.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130719/76834a7a/attachment.html>

From even.rouault at mines-paris.org  Fri Jul 19 13:18:25 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 19 Jul 2013 22:18:25 +0200
Subject: [gdal-dev] A new ogr driver
In-Reply-To: <1374197472790-5067479.post@n6.nabble.com>
References: <1374197472790-5067479.post@n6.nabble.com>
Message-ID: <201307192218.25472.even.rouault@mines-paris.org>

Le vendredi 19 juillet 2013 03:31:12, Xian Chen a ?crit :
> Hi all,
> 
> I'm planning to submit a new driver for accessing Walk files, a geospatial
> data format developed  by Walkinfo Tech. mainly for land surveying,
> evaluation, planning, checking and data analysis in China.
> 
> Walkinfo Tech. is a China-based company founded since 1999, origignally
> focused on land surveying software research and development. Currently we
> have our own geographic information platform WalkGIS, as well as scores of
> GIS desktop, mobile products based on it, including WalkISurvey,
> WalkISurface, WalkCheck, WalkFu and so on. The company is also the largest
> strategic partner with Esri ArcGIS in China.
> 
> The WalkGIS applications use GDAL/OGR as part of its base libaries. The
> purpose of developing the Walk driver on GDAL/OGR is to allow other GIS
> products such as ArcGIS to access our data more easily and conveniently.
> 
> The driver I am working on is already able to get the information such as
> layers, features, geometries, and spatial references from Walk files. Can I
> get the permission to submit it to GDAL project and share it with other
> GDAL developers?

Hi Xian,

First, you should check with your employer that you can legally contribute 
code to the GDAL/OGR project and submit it under the GDAL MIT/X licence. Check 
the "Legal" section of http://trac.osgeo.org/gdal/wiki/rfc3_commiters  . If 
this is the case, send an email to this mailing list where you will confirm it.

I also suggest that you read the developer guidelines at 
http://trac.osgeo.org/gdal/wiki/rfc8_devguide and check that your code 
conforms to (most of) them.

For OGR driver, I would also recommend that you test the driver with the 
"test_ogrsf" utility (not compiled by default, but in a custom build, you can 
"cd apps", and then "make test_ogrsf" / "nmake /f makefile.vc test_ogrsf.exe") 
on sample files in your data format. This will run a few consistency test to 
check assumptions that an OGR driver should met.

Then, you can attach an archive with the code to a Trac ticket ( 
http://trac.osgeo.org/gdal/newticket ), so that it can be reviewed.

Best regards,

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From aperi2007 at gmail.com  Sat Jul 20 17:08:58 2013
From: aperi2007 at gmail.com (aperi2007)
Date: Sun, 21 Jul 2013 02:08:58 +0200
Subject: [gdal-dev] Convert a csv text file in a dbf file
In-Reply-To: <201307131019.35648.even.rouault@mines-paris.org>
References: <CABqTJk8J-DRJg+egka98ygZnn1U9JL0aZbeTs3eGNJPB9OT-3w@mail.gmail.com>
	<201307131019.35648.even.rouault@mines-paris.org>
Message-ID: <51EB269A.7020109@gmail.com>

Hi, Rouault

it work well.

I see it want necessary the first line with titles.
To avoid it the docs say to use an integer field.
This is not my situation.
I have a file with all text fileds but without a title in the first line.

There is a parameter to avoid the first line of fileds-name ?

Thx,

Andrea.

On 13/07/2013 10:19, Even Rouault wrote:
> Le samedi 13 juillet 2013 08:46:10, Andrea Peri a ?crit :
>> Hi,
>>
>> I have a csv text file without any geometric field.
>>
>> I need to convert it in a simple dbf file.
>>
>> Is this possible to do with ogr2ogr ?
> Yes
>
> $ cat nogeom.csv
> id,foo
> 1,bar
>
> $ ogr2ogr nogeom.dbf nogeom.csv
>
> $ ogrinfo nogeom.dbf -al
> INFO: Open of `nogeom.dbf'
>        using driver `ESRI Shapefile' successful.
>
> Layer name: nogeom
> Geometry: None
> Feature Count: 1
> Layer SRS WKT:
> (unknown)
> id: String (80.0)
> foo: String (80.0)
> OGRFeature(nogeom):0
>    id (String) = 1
>    foo (String) = bar
>
>
>
>> Thx


From even.rouault at mines-paris.org  Sun Jul 21 01:56:45 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sun, 21 Jul 2013 10:56:45 +0200
Subject: [gdal-dev] Convert a csv text file in a dbf file
In-Reply-To: <51EB269A.7020109@gmail.com>
References: <CABqTJk8J-DRJg+egka98ygZnn1U9JL0aZbeTs3eGNJPB9OT-3w@mail.gmail.com>
	<201307131019.35648.even.rouault@mines-paris.org>
	<51EB269A.7020109@gmail.com>
Message-ID: <201307211056.45211.even.rouault@mines-paris.org>

Le dimanche 21 juillet 2013 02:08:58, aperi2007 a ?crit :
> Hi, Rouault
> 
> it work well.
> 
> I see it want necessary the first line with titles.
> To avoid it the docs say to use an integer field.
> This is not my situation.
> I have a file with all text fileds but without a title in the first line.
> 
> There is a parameter to avoid the first line of fileds-name ?

Andrea,

No, there isn't such a parameter in the CSV driver. If you just have one file 
to convert, the easiest solution is to take your favorite text editor and add 
a first line that will server as the header line :
column1,column2,...

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From DCarreira at edia.pt  Mon Jul 22 07:58:44 2013
From: DCarreira at edia.pt (Duarte Carreira)
Date: Mon, 22 Jul 2013 14:58:44 +0000
Subject: [gdal-dev] gtiff with internal mask
References: <A2C5C1FEBB05AA41A13D4F312D5F1A882DF3018C@AMSPRD0710MB365.eurprd07.prod.outlook.com>
	<201307161957.44428.even.rouault@mines-paris.org>
	<A2C5C1FEBB05AA41A13D4F312D5F1A882DF30807@AMSPRD0710MB365.eurprd07.prod.outlook.com>
	<201307171445.06549.even.rouault@mines-paris.org>  
Message-ID: <A2C5C1FEBB05AA41A13D4F312D5F1A882DF32783@AMSPRD0710MB365.eurprd07.prod.outlook.com>

To solve the overviews I created an external mask file instead, in step 3, by removing the option "--config GDAL_TIFF_INTERNAL_MASK YES " from the command.

As I am using GDAL 1.9.2 I don't know if this issue is caused by the solved issue in 1.10 (https://trac.osgeo.org/gdal/wiki/Release/1.10.0-News):
"When building overviews, if the image has already an internal mask, then build internal overviews for the mask implicitely "

I ended up with this set of files:

Mosaic.tif
Mosaic.tif.msk
Mosaic.tif.msk.ovr
Mosaic.tif.ovr

And to use in qgis, corresponding to step 4:
Mosaic_rgba_qgis.vrt

Duarte

-----Mensagem original-----
De: Duarte Carreira 
Enviada: quinta-feira, 18 de Julho de 2013 13:01
Para: 'Even Rouault'
Cc: 'gdal-dev at lists.osgeo.org'
Assunto: RE: [gdal-dev] gtiff with internal mask

So... now I 've got issues building the overviews. Gdaladdo loses the transparency so I get to see black areas where I was supposed to see nothing. When I zoom in black disappears.

Any known way to overcome this?

Thanks,
Duarte



-----Mensagem original-----
De: Duarte Carreira
Enviada: quarta-feira, 17 de Julho de 2013 19:41
Para: 'Even Rouault'
Cc: gdal-dev at lists.osgeo.org
Assunto: RE: [gdal-dev] gtiff with internal mask

Well, you're right... I messed up recreating the footsteps...

So, cleaning up:

1) create a rgba vrt using gdalwarp to cut the original mosaic with a shapefile gdalwarp -multi -wm 480 --config GDAL_CACHEMAX 312 -co alpha=yes -dstalpha -cutline shapes\index_diss.shp -of vrt originalmosaic.vrt test_rgba_uncomp.vrt

2) create a masked uncompressed vrt using gdal_translate (because I couldn't compress right away, with errors of missing StripOffsets field) gdal_translate -b 1 -b 2 -b 3 -mask 4 -co alpha=no -co photometric=rgb -co interleave=pixel -co tiled=yes --config GDAL_TIFF_INTERNAL_MASK YES -of vrt  test_rgba_uncomp.vrt testmask_uncomp.vrt

3) create final masked compressed tiff using gdal_translate gdal_translate -co alpha=no -co photometric=ycbcr -co interleave=pixel -co tiled=yes -co compress=jpeg --config GDAL_TIFF_INTERNAL_MASK YES testmask_uncomp.vrt test_finalmask.tif

The power of VRT amazes me!

Also regarding sizes: I still got the same ratio of 8x smaller.

To use this in QGIS you still have to create a rgba vrt:
4) gdal_translate -of VRT -b 1 -b 2 -b 3 -b mask test_finalmask.tif test_finalmask_qgis.vrt (couldn't get the 4? band to be recognized as an alpha band though)

So I think now it's correct... I am going to apply this to a real-case mosaic and report back...

Duarte

-----Mensagem original-----
De: Even Rouault [mailto:even.rouault at mines-paris.org]
Enviada: quarta-feira, 17 de Julho de 2013 13:45
Para: Duarte Carreira
Cc: gdal-dev at lists.osgeo.org
Assunto: Re: [gdal-dev] gtiff with internal mask

Le mercredi 17 juillet 2013 14:23:29, Duarte Carreira a ?crit :
> Hi Even.
> 
> Thanks so much for your tip! It works. I did have to specify I did not 
> want an alpha band when cutting with the shapefile:
> 
> gdalwarp -multi -wm 480 --config GDAL_CACHEMAX 256 -co 
> photometric=ycbcr -co compress=jpeg -co alpha=no --config 
> GDAL_TIFF_INTERNAL_MASK YES -cutline shapes\index_diss.shp vrtini.vrt 
> testmask.tif

Hum, what I don't understand is how the above will produce a mask band in the output file...

Does gdalinfo on testmask.tif show something like :

Band 1 Block=.... Type=Byte, ColorInterp=Red
  Mask Flags: PER_DATASET
Band 2 Block=.... Type=Byte, ColorInterp=Green
  Mask Flags: PER_DATASET
Band 3 Block=... Type=Byte, ColorInterp=Blue
  Mask Flags: PER_DATASET 

I think you would need to do the above in 2 steps:
1) gdalwarp to an uncompressed RGBA TIFF
2) gdal_translate to turn the RGBA into a YCbCr JPEG-compressed GTiff + mask band

> 
> Seems arcgis recognizes the masked tiff, but is much much slower 
> displaying than using a "normal" alpha band.

Perhaps adding -co TILED=YES will help ? (random guess)

> QGIS does need the vrt trick but then is as fast as usual.
> 
> Also, the size is must smaller when using an internal mask: from a 
> 219MB rgba,band interleaved,jpegd image to a 27MB ycbcr,pixel 
> interleaved,jpegd masked tiff (8x smaller). Unless I missed something...

Not completely surprising although more important than I would have expected. 
YCbCr compression usually gives a 2x to 3x compression bonus, and due to the usual nature of mask bands, the 1bit deflate compression of the mask band will give better results (both visually and in size) that the 8bit JPEG compression of the alpha band.

> 
> Thanks again!
> Duarte
> 
> -----Mensagem original-----
> De: Even Rouault [mailto:even.rouault at mines-paris.org]
> Enviada: ter?a-feira, 16 de Julho de 2013 18:58
> Para: gdal-dev at lists.osgeo.org
> Cc: Duarte Carreira
> Assunto: Re: [gdal-dev] gtiff with internal mask
> 
> Le mardi 16 juillet 2013 12:29:37, Duarte Carreira a ?crit :
> > I'm trying to create gtiffs with transparent areas where there are 
> > voids between my original images.
> > 
> > I have successfully done it by using an alpha band but this process 
> > created 3x larger images. I think partly because of an additional 
> > 4th band and partly because I cannot use ycbcr to compress with 
> > jpeg. So I thought of using internal masks expecting to get smaller 
> > images but cannot get it to work.
> > 
> > When converting from the rgba image using -mask 4 I cannot "see" the 
> > transparency and get black areas:
> > 
> > gdal_translate -b 1 -b 2 -b 3 -ma sk 4 --config 
> > GDAL_TIFF_INTERNAL_MASK YES test_alpha.tif test_internalmask.tif
> > 
> > I tried looking at the images using qgis and paint.net.
> 
> I know QGIS doesn't use the GDALGetMaskBand() API, so no real surprise 
> (that would likely be a possible QGIS enhancement). And paint.net 
> probably doesn't support this feature of the TIFF format either.
> 
> MapServer does support mask bands however.
> 
> For QGIS, you could workaround that however. Imagine that you have a 
> YCbCr TIFF + internal mask in.tif.
> 
> You can do : "gdal_translate -of VRT -b 1 -b 2 -b 3 -b mask in.tif out.vrt"
> 
> And QGIS should handle out.vrt as a regular RGBA dataset.
> 
> > Any hints or help appreciated.
> > 
> > Thanks,
> > Duarte
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > Duarte Carreira
> > Diretor | Dep. Informa??o Geogr?fica e Cartografia
> > 
> > www.edia.pt<http://www.edia.pt>
> > www.alqueva.com.pt<http://www.alqueva.com.pt>
> > Tel. +351 284315100
> > 
> > [http://www.edia.pt/edia/images/edia_logo2.gif]<http://www.edia.pt>
> 
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html

--
Geospatial professional services
http://even.rouault.free.fr/services.html


From mauropisano at suremptec.com.ar  Mon Jul 22 13:58:39 2013
From: mauropisano at suremptec.com.ar (Mauro Pisano)
Date: Mon, 22 Jul 2013 17:58:39 -0300
Subject: [gdal-dev] OGRErr OGRLayer::CreateField // cant create fields
Message-ID: <CAJ0G4t06KP3_u7k6Ea2sYPWW3krbj7HX5n0Bw6Z_W30PE8UOOw@mail.gmail.com>

Hi guys!

Im having a problem by using the OGRLayter::CreateField method, it isnt
creating the field as the description saids :).

Maybe you can see the error or have an idea to go out of this hole.

Here are the lines of code:

*...*
*...*
*   OGRLayer* player = pvector->GetLayer(0);*

*   if (player->GetLayerDefn()->GetFieldIndex(SUR_HOTLINK_FIELD) < 0) {*
      // If the field doesnt exist, I create it.
*      OGRFieldDefn field(SUR_HOTLINK_FIELD, OFTString);*
      // Try to insert it to the table.
*      if ( player->CreateField(&field, TRUE) == OGRERR_NONE )*
*         SHOW_ERROR("D:Error trying to create field);*
*   }*
*...*
*...*

*NOTES:*
the first line returns me without problems the Working Layer ( I just
 using just 1 layer to avoid confusions )
the first IF returns that there arent any SUR_HOTLINK_FIELD in the table (
that its OK! )

and de last IF returns that the CreateField gives distinct as OGRERR_NONE.


Thanks in advance!

Mauro Pisano
SUR Emprendimientos Tecnol?gicos

Per? 345  Piso 5to Oficina "B" (C1067AAG)
Ciudad de Buenos Aires, Argentina
Tel. +54 (11) 4342-2976/84
mauropisano at suremptec.com.ar
www.suremptec.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130722/e51e4014/attachment.html>

From even.rouault at mines-paris.org  Mon Jul 22 14:09:38 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 22 Jul 2013 23:09:38 +0200
Subject: [gdal-dev] OGRErr OGRLayer::CreateField // cant create fields
In-Reply-To: <CAJ0G4t06KP3_u7k6Ea2sYPWW3krbj7HX5n0Bw6Z_W30PE8UOOw@mail.gmail.com>
References: <CAJ0G4t06KP3_u7k6Ea2sYPWW3krbj7HX5n0Bw6Z_W30PE8UOOw@mail.gmail.com>
Message-ID: <201307222309.39078.even.rouault@mines-paris.org>

Le lundi 22 juillet 2013 22:58:39, Mauro Pisano a ?crit :
> Hi guys!
> 
> Im having a problem by using the OGRLayter::CreateField method, it isnt
> creating the field as the description saids :).
> 
> Maybe you can see the error or have an idea to go out of this hole.
> 
> Here are the lines of code:
> 
> *...*
> *...*
> *   OGRLayer* player = pvector->GetLayer(0);*
> 
> *   if (player->GetLayerDefn()->GetFieldIndex(SUR_HOTLINK_FIELD) < 0) {*
>       // If the field doesnt exist, I create it.
> *      OGRFieldDefn field(SUR_HOTLINK_FIELD, OFTString);*
>       // Try to insert it to the table.
> *      if ( player->CreateField(&field, TRUE) == OGRERR_NONE )*
> *         SHOW_ERROR("D:Error trying to create field);*
> *   }*
> *...*
> *...*
> 
> *NOTES:*
> the first line returns me without problems the Working Layer ( I just
>  using just 1 layer to avoid confusions )
> the first IF returns that there arent any SUR_HOTLINK_FIELD in the table (
> that its OK! )
> 
> and de last IF returns that the CreateField gives distinct as OGRERR_NONE.

Mauro,

You didn't really give a lot of context. But several possible causes :
- the datasource is not opened in update mode
- the driver does not support field creation at all

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From gdal at stripfamily.net  Mon Jul 22 16:44:20 2013
From: gdal at stripfamily.net (David Strip)
Date: Mon, 22 Jul 2013 17:44:20 -0600
Subject: [gdal-dev] How do I tell if an OGRSpatialReference has been
	initialized?
Message-ID: <51EDC3D4.7060702@stripfamily.net>

Given an OGRSpatialReference class object, how do I tell if it's been 
initialized to anything? (ie,clear() was called or else was constructed 
with a null string an no further action was taken to set the SRS?)
I've looked over the interface and can't spot anything that tells me 
it's in a clear state, but of course I might have missed it.

Thanks
David



From chenxian at walkinfo.com.cn  Mon Jul 22 17:44:38 2013
From: chenxian at walkinfo.com.cn (Xian Chen)
Date: Mon, 22 Jul 2013 17:44:38 -0700 (PDT)
Subject: [gdal-dev] A new ogr driver
In-Reply-To: <201307192218.25472.even.rouault@mines-paris.org>
References: <1374197472790-5067479.post@n6.nabble.com>
	<201307192218.25472.even.rouault@mines-paris.org>
Message-ID: <1374540278632-5068082.post@n6.nabble.com>

Well, here is my confirmation:

As an authorized representative of Walkinfo Technology Co., Ltd., I
understand that the submitted code  to the GDAL project will be contributed
under the MIT/X license.

Thanks,
Xian


Even Rouault wrote
> Le vendredi 19 juillet 2013 03:31:12, Xian Chen a ?crit :
>> Hi all,
>> 
>> I'm planning to submit a new driver for accessing Walk files, a
>> geospatial
>> data format developed  by Walkinfo Tech. mainly for land surveying,
>> evaluation, planning, checking and data analysis in China.
>> 
>> Walkinfo Tech. is a China-based company founded since 1999, origignally
>> focused on land surveying software research and development. Currently we
>> have our own geographic information platform WalkGIS, as well as scores
>> of
>> GIS desktop, mobile products based on it, including WalkISurvey,
>> WalkISurface, WalkCheck, WalkFu and so on. The company is also the
>> largest
>> strategic partner with Esri ArcGIS in China.
>> 
>> The WalkGIS applications use GDAL/OGR as part of its base libaries. The
>> purpose of developing the Walk driver on GDAL/OGR is to allow other GIS
>> products such as ArcGIS to access our data more easily and conveniently.
>> 
>> The driver I am working on is already able to get the information such as
>> layers, features, geometries, and spatial references from Walk files. Can
>> I
>> get the permission to submit it to GDAL project and share it with other
>> GDAL developers?
> 
> Hi Xian,
> 
> First, you should check with your employer that you can legally contribute 
> code to the GDAL/OGR project and submit it under the GDAL MIT/X licence.
> Check 
> the "Legal" section of http://trac.osgeo.org/gdal/wiki/rfc3_commiters  .
> If 
> this is the case, send an email to this mailing list where you will
> confirm it.
> 
> I also suggest that you read the developer guidelines at 
> http://trac.osgeo.org/gdal/wiki/rfc8_devguide and check that your code 
> conforms to (most of) them.
> 
> For OGR driver, I would also recommend that you test the driver with the 
> "test_ogrsf" utility (not compiled by default, but in a custom build, you
> can 
> "cd apps", and then "make test_ogrsf" / "nmake /f makefile.vc
> test_ogrsf.exe") 
> on sample files in your data format. This will run a few consistency test
> to 
> check assumptions that an OGR driver should met.
> 
> Then, you can attach an archive with the code to a Trac ticket ( 
> http://trac.osgeo.org/gdal/newticket ), so that it can be reviewed.
> 
> Best regards,
> 
> Even
> 
> -- 
> Geospatial professional services
> http://even.rouault.free.fr/services.html
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> http://lists.osgeo.org/mailman/listinfo/gdal-dev





--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-A-new-ogr-driver-tp5067479p5068082.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From etourigny.dev at gmail.com  Tue Jul 23 08:59:47 2013
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Tue, 23 Jul 2013 12:59:47 -0300
Subject: [gdal-dev] How do I tell if an OGRSpatialReference has been
	initialized?
In-Reply-To: <51EDC3D4.7060702@stripfamily.net>
References: <51EDC3D4.7060702@stripfamily.net>
Message-ID: <CA+TxYvPUFUM7++7cq06qHh7Mo-6GNtv_eRCSurKs5eL678MV-w@mail.gmail.com>

You could try calling exportToWkt() and test if the string is null or empty
(although I haven't tested that) - make sure to free the string afterwards.

Etienne

On Mon, Jul 22, 2013 at 8:44 PM, David Strip <gdal at stripfamily.net> wrote:

> Given an OGRSpatialReference class object, how do I tell if it's been
> initialized to anything? (ie,clear() was called or else was constructed
> with a null string an no further action was taken to set the SRS?)
> I've looked over the interface and can't spot anything that tells me it's
> in a clear state, but of course I might have missed it.
>
> Thanks
> David
>
>
> ______________________________**_________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/**mailman/listinfo/gdal-dev<http://lists.osgeo.org/mailman/listinfo/gdal-dev>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130723/4debd611/attachment.html>

From ryan.clark at azgs.az.gov  Tue Jul 23 09:31:08 2013
From: ryan.clark at azgs.az.gov (Ryan Clark)
Date: Tue, 23 Jul 2013 16:31:08 +0000
Subject: [gdal-dev] ogr2ogr VSI support for JSON input?
Message-ID: <183BB272-0C73-4E35-966D-6DAAF952DE1B@azgs.az.gov>

I'm curious if the GeoJSON driver does not support the VSI API completely?

This works (stream WFS > GeoJSON):

    curl "http://server.com/wfs?request=GetFeature..." | ogr2ogr -f "GeoJSON" /vsistdout/ /vsistdin/

but this doesn't (stream GeoJSON > KML):

    cat ~/my-geojson.json | ogr2ogr -f "KML" /vsistdout/ /vsistdin/

... that is, I can't seem to stream GeoJSON as an input to ogr2ogr. Is that a known issue or am I doing something wrong? The documentation<http://www.gdal.org/ogr/drv_geojson.html> states that I should be able to do this, but I'm receiving an error:

$ cat my-geojson.json | ogr2ogr -f "KML" /vsistdout/ /vsistdin/
ERROR 1: GeoJSON parsing error: unexpected end of data (at offset 6000)
ERROR 4: Failed to read GeoJSON data
FAILURE:
Unable to open datasource `/vsistdin/' with the following drivers.
...


I'm working with GDAL 1.10.0.

Thank you!
Ryan



____________________

Ryan Clark
Arizona Geological Survey
ryan.clark at azgs.az.gov<mailto:ryan.clark at azgs.az.gov>
(520) 302-4871
facebook.com/ModernGeologist<https://www.facebook.com/ModernGeologist>
@worbly<https://twitter.com/worbly>









-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130723/ffa0cfb8/attachment.html>

From warmerdam at pobox.com  Tue Jul 23 10:49:50 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue, 23 Jul 2013 10:49:50 -0700
Subject: [gdal-dev] How do I tell if an OGRSpatialReference has been
	initialized?
In-Reply-To: <CA+TxYvPUFUM7++7cq06qHh7Mo-6GNtv_eRCSurKs5eL678MV-w@mail.gmail.com>
References: <51EDC3D4.7060702@stripfamily.net>
	<CA+TxYvPUFUM7++7cq06qHh7Mo-6GNtv_eRCSurKs5eL678MV-w@mail.gmail.com>
Message-ID: <CA+YzLBeekAoSAGWFxtMv_1NiETYRFzjpFBx_ALBLnLZnq5b1qA@mail.gmail.com>

David,

In addition to Etienne's suggestion of exportToWkt() and check for
emptiness, you might also consider calling Validate() which will return
FALSE if it believes the coordinate system is invalid, which would include
empty coordinate systems.  The main downside to this is that some useful
coordinate systems may be identified as invalid because they don't fit a
standard pattern.

Best regards,
Frank


On Tue, Jul 23, 2013 at 8:59 AM, Etienne Tourigny
<etourigny.dev at gmail.com>wrote:

> You could try calling exportToWkt() and test if the string is null or
> empty (although I haven't tested that) - make sure to free the string
> afterwards.
>
> Etienne
>
>
> On Mon, Jul 22, 2013 at 8:44 PM, David Strip <gdal at stripfamily.net> wrote:
>
>> Given an OGRSpatialReference class object, how do I tell if it's been
>> initialized to anything? (ie,clear() was called or else was constructed
>> with a null string an no further action was taken to set the SRS?)
>> I've looked over the interface and can't spot anything that tells me it's
>> in a clear state, but of course I might have missed it.
>>
>> Thanks
>> David
>>
>>
>> ______________________________**_________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/**mailman/listinfo/gdal-dev<http://lists.osgeo.org/mailman/listinfo/gdal-dev>
>>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130723/54b32643/attachment-0001.html>

From even.rouault at mines-paris.org  Tue Jul 23 12:56:50 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 23 Jul 2013 21:56:50 +0200
Subject: [gdal-dev] ogr2ogr VSI support for JSON input?
In-Reply-To: <183BB272-0C73-4E35-966D-6DAAF952DE1B@azgs.az.gov>
References: <183BB272-0C73-4E35-966D-6DAAF952DE1B@azgs.az.gov>
Message-ID: <201307232156.50441.even.rouault@mines-paris.org>

Le mardi 23 juillet 2013 18:31:08, Ryan Clark a ?crit :
> I'm curious if the GeoJSON driver does not support the VSI API completely?
> 
> ... that is, I can't seem to stream GeoJSON as an input to ogr2ogr. Is that
> a known issue or am I doing something wrong? The
> documentation<http://www.gdal.org/ogr/drv_geojson.html> states that I
> should be able to do this, but I'm receiving an error:

Ryan,

Actually, no, it doesn't mention /vsistdin/ and this wasn't supported due to 
the way the file was handled. I've just made changes in the SVN trunk so that 
it is also supported for GeoJSON.

Best regards,

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Wed Jul 24 05:49:37 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 24 Jul 2013 14:49:37 +0200
Subject: [gdal-dev] Call for discussion for "RFC 41 : Support for multiple
	geometry fields in OGR"
Message-ID: <201307241449.37980.even.rouault@mines-paris.org>

Hi,

This is a call for discussion for "RFC 41 : Support for multiple geometry 
fields in OGR" :

http://trac.osgeo.org/gdal/wiki/rfc41_multiple_geometry_fields

As an introduction, you'll find below the first paragraphs of the RFC. Much more 
to read at the above link !

== Summary ==

Add read/write support in the OGR data model for features with multiple 
geometry fields.

== Motivation ==

The OGR data model is currently tied to a single geometry field per feature,
feature definition and layer. But a number of data formats support multiple
geometry fields. The OGC Simple Feature Specifications also do not limit to
one geometry field per layer (e.g. ?7.1.4 of 
[http://portal.opengeospatial.org/files/?artifact_id=25354 OGC 06-104r4 
"OpenGIS? Implementation Standard for Geographic information - Simple feature 
access -Part 2: SQL option]).

There are workarounds : using geometries of type GEOMETRYCOLLECTION, or
advertizing as many layers as there are geometry columns in the layer (like
currently done in the PostGIS or SQLite drivers). All those approach are at 
best workarounds that suffer from limitations :
  * GEOMETRYCOLLECTION approach : no way to know the name/semantics of each
    sub-geometry. All sub-geometries must be expressed in the same SRS. No way
    of guaranteeing that the GEOMETRYCOLLECTION has always the same number of
    sub-geometries or that there are of a consistent geometry type.
  * one layer per geometry column approach : only appropriate for read-only
    scenarios. Cannot work in write scenarios.

The purpose of this RFC is to make support for multiple geometry fields per
feature to be properly taken into account in the OGR data model.

[...]

Best regards,

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From hobu.inc at gmail.com  Wed Jul 24 06:41:08 2013
From: hobu.inc at gmail.com (Howard Butler)
Date: Wed, 24 Jul 2013 08:41:08 -0500
Subject: [gdal-dev] Call for discussion for "RFC 41 : Support for
	multiple geometry fields in OGR"
In-Reply-To: <201307241449.37980.even.rouault@mines-paris.org>
References: <201307241449.37980.even.rouault@mines-paris.org>
Message-ID: <D63D4A52-9E4F-4E7A-8749-09E7D37B5B0C@gmail.com>


On Jul 24, 2013, at 7:49 AM, Even Rouault <even.rouault at mines-paris.org> wrote:

> Hi,
> 
> This is a call for discussion for "RFC 41 : Support for multiple geometry 
> fields in OGR" :
> 
> http://trac.osgeo.org/gdal/wiki/rfc41_multiple_geometry_fields
> 
> As an introduction, you'll find below the first paragraphs of the RFC. Much more 
> to read at the above link !
> 
> == Summary ==
> 
> Add read/write support in the OGR data model for features with multiple 
> geometry fields.

Impressive, logical, complete, and verbose.

The only small addition I might suggest is a driver capabilities flag to announce whether or not it has multiple geometry field support. It could simply be the driver that has not been updated to support multiple geometry fields or the fact that the driver's model itself doesn't fit the idea of multiple geometry fields. In either case, it would be good to be able to ask.

Howard

From gdal at stripfamily.net  Wed Jul 24 06:43:11 2013
From: gdal at stripfamily.net (David Strip)
Date: Wed, 24 Jul 2013 07:43:11 -0600
Subject: [gdal-dev] How do I tell if an OGRSpatialReference has been
	initialized?
In-Reply-To: <CA+YzLBeekAoSAGWFxtMv_1NiETYRFzjpFBx_ALBLnLZnq5b1qA@mail.gmail.com>
References: <51EDC3D4.7060702@stripfamily.net>
	<CA+TxYvPUFUM7++7cq06qHh7Mo-6GNtv_eRCSurKs5eL678MV-w@mail.gmail.com>
	<CA+YzLBeekAoSAGWFxtMv_1NiETYRFzjpFBx_ALBLnLZnq5b1qA@mail.gmail.com>
Message-ID: <51EFD9EF.4010000@stripfamily.net>

I had considered validate(), but decided against it for the reason you 
suggest - an initialized SRS might be in some weird format that fails 
validation. I've been using exportToWkt(), but was/am concerned that it 
might be possible to fail to export in odd-ball situations. Hence, my 
question about a direct check. Sounds like exportToWkt() is my best bet.

Thanks to Frank and Etienne for the clarification.

David



From even.rouault at mines-paris.org  Wed Jul 24 06:47:51 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 24 Jul 2013 15:47:51 +0200
Subject: [gdal-dev] Call for discussion for "RFC 41 : Support for
	multiple geometry fields in OGR"
In-Reply-To: <D63D4A52-9E4F-4E7A-8749-09E7D37B5B0C@gmail.com>
References: <201307241449.37980.even.rouault@mines-paris.org>
	<D63D4A52-9E4F-4E7A-8749-09E7D37B5B0C@gmail.com>
Message-ID: <201307241547.51614.even.rouault@mines-paris.org>

> Impressive, logical, complete, and verbose.
> 
> The only small addition I might suggest is a driver capabilities flag to
> announce whether or not it has multiple geometry field support. It could
> simply be the driver that has not been updated to support multiple
> geometry fields or the fact that the driver's model itself doesn't fit the
> idea of multiple geometry fields. In either case, it would be good to be
> able to ask.

Hi Howard,

Too verbose maybe ;-) , since you probably missed the (discrete) mention to 
the OLCCreateGeomField capability (at layer level since CreateGeomField() is a 
OGRLayer method)

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Wed Jul 24 06:51:12 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 24 Jul 2013 15:51:12 +0200
Subject: [gdal-dev] How do I tell if an OGRSpatialReference has been
	initialized?
In-Reply-To: <51EFD9EF.4010000@stripfamily.net>
References: <51EDC3D4.7060702@stripfamily.net>
	<CA+YzLBeekAoSAGWFxtMv_1NiETYRFzjpFBx_ALBLnLZnq5b1qA@mail.gmail.com>
	<51EFD9EF.4010000@stripfamily.net>
Message-ID: <201307241551.12130.even.rouault@mines-paris.org>

Le mercredi 24 juillet 2013 15:43:11, David Strip a ?crit :
> I had considered validate(), but decided against it for the reason you
> suggest - an initialized SRS might be in some weird format that fails
> validation. I've been using exportToWkt(), but was/am concerned that it
> might be possible to fail to export in odd-ball situations. Hence, my
> question about a direct check. Sounds like exportToWkt() is my best bet.

exportToWkt() cannot fail (except out-of-memory problem). (Valid) WKT 
representation and OSR model are completely bijective.

Another way of testing is OGRSpatialReference has been initialized is to test 
if poSRS->GetRoot() != NULL. (only available in the C++ API)

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From hobu.inc at gmail.com  Wed Jul 24 06:52:33 2013
From: hobu.inc at gmail.com (Howard Butler)
Date: Wed, 24 Jul 2013 08:52:33 -0500
Subject: [gdal-dev] Call for discussion for "RFC 41 : Support for
	multiple geometry fields in OGR"
In-Reply-To: <201307241547.51614.even.rouault@mines-paris.org>
References: <201307241449.37980.even.rouault@mines-paris.org>
	<D63D4A52-9E4F-4E7A-8749-09E7D37B5B0C@gmail.com>
	<201307241547.51614.even.rouault@mines-paris.org>
Message-ID: <768E6C6F-C407-4745-9E9B-96A0DEA2AE67@gmail.com>


On Jul 24, 2013, at 8:47 AM, Even Rouault <even.rouault at mines-paris.org> wrote:
> Too verbose maybe ;-) , since you probably missed the (discrete) mention to 
> the OLCCreateGeomField capability (at layer level since CreateGeomField() is a 
> OGRLayer method)

Indeed. Thanks for a thorough RFC. Now people can move on to arguing whether or not multiple geometry fields in a data source is a good idea :)

Howard

From a.neumann at carto.net  Wed Jul 24 07:07:49 2013
From: a.neumann at carto.net (Andreas Neumann)
Date: Wed, 24 Jul 2013 16:07:49 +0200
Subject: [gdal-dev] Call for discussion for "RFC 41 : Support for
 multiple geometry fields in OGR"
In-Reply-To: <768E6C6F-C407-4745-9E9B-96A0DEA2AE67@gmail.com>
References: <201307241449.37980.even.rouault@mines-paris.org>
	<D63D4A52-9E4F-4E7A-8749-09E7D37B5B0C@gmail.com>
	<201307241547.51614.even.rouault@mines-paris.org>
	<768E6C6F-C407-4745-9E9B-96A0DEA2AE67@gmail.com>
Message-ID: <51EFDFB5.3060706@carto.net>

Hi,

I can't comment about the technical issues. But from a user point of
view there is a need to have more than one geometry representation per
feature. There could be several generalizations attached to a feature,
or different states.

I would welcome such a feature in OGR.

I guess Swisstopo also has a specific use case in mind since they
sponsor the work. Do you know which?

Andreas

Am 24.07.2013 15:52, schrieb Howard Butler:
> 
> On Jul 24, 2013, at 8:47 AM, Even Rouault <even.rouault at mines-paris.org> wrote:
>> Too verbose maybe ;-) , since you probably missed the (discrete) mention to 
>> the OLCCreateGeomField capability (at layer level since CreateGeomField() is a 
>> OGRLayer method)
> 
> Indeed. Thanks for a thorough RFC. Now people can move on to arguing whether or not multiple geometry fields in a data source is a good idea :)
> 
> Howard
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 


From even.rouault at mines-paris.org  Wed Jul 24 07:46:37 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 24 Jul 2013 16:46:37 +0200
Subject: [gdal-dev] Call for discussion for "RFC 41 : Support for
	multiple geometry fields in OGR"
In-Reply-To: <51EFDFB5.3060706@carto.net>
References: <201307241449.37980.even.rouault@mines-paris.org>
	<768E6C6F-C407-4745-9E9B-96A0DEA2AE67@gmail.com>
	<51EFDFB5.3060706@carto.net>
Message-ID: <201307241646.37663.even.rouault@mines-paris.org>

Le mercredi 24 juillet 2013 16:07:49, Andreas Neumann a ?crit :
> Hi,
> 
> I can't comment about the technical issues. But from a user point of
> view there is a need to have more than one geometry representation per
> feature. There could be several generalizations attached to a feature,
> or different states.
> 
> I would welcome such a feature in OGR.
> 
> I guess Swisstopo also has a specific use case in mind since they
> sponsor the work. Do you know which?

Andreas,

I believe there are in particular interested in being able to make use of the 
multiple geometry support available in the Interlis format ( the Interlis spec 
itself is a bit complicated to follow. The most obvious evidence I found about 
multiple geometry in Interlis is 
http://www.eisenhutinformatik.ch/interlis/ili2fme/interlis2-20120202.pdf 
paragraph 12.2 )

Funnily enough, this topic was raised in this old thread :
http://lists.osgeo.org/pipermail/gdal-dev/2008-January/thread.html#15880

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From warmerdam at pobox.com  Wed Jul 24 09:42:59 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed, 24 Jul 2013 09:42:59 -0700
Subject: [gdal-dev] Call for discussion for "RFC 41 : Support for
 multiple geometry fields in OGR"
In-Reply-To: <201307241449.37980.even.rouault@mines-paris.org>
References: <201307241449.37980.even.rouault@mines-paris.org>
Message-ID: <CA+YzLBdeGbPyP-UCyH9vDfW3xeJo62Jz8DfDFqhDdoWmoRS=dg@mail.gmail.com>

Even,

An excellent proposal!

I'm a bit sad about GetSpatialRef() on the first geometry field not
necessarily returning the right value for old drivers.  I'd suggest we make
a quick pass through the checked in drivers once your core work is done to
update them.

I'd be interested in implementing multiple geometry column for the fusion
tables driver to get my feet wet with this new capability once the core
work is done.

I'd also love to see it added for GML but that could be an involved
process, so I'm not going to commit to taking it on.

It is also timely in that the question of multi-geometry support came up
recently in reference to Google Maps Engine.

Best regards,
Frank



On Wed, Jul 24, 2013 at 5:49 AM, Even Rouault
<even.rouault at mines-paris.org>wrote:

> Hi,
>
> This is a call for discussion for "RFC 41 : Support for multiple geometry
> fields in OGR" :
>
> http://trac.osgeo.org/gdal/wiki/rfc41_multiple_geometry_fields
>
> As an introduction, you'll find below the first paragraphs of the RFC.
> Much more
> to read at the above link !
>
> == Summary ==
>
> Add read/write support in the OGR data model for features with multiple
> geometry fields.
>
> == Motivation ==
>
> The OGR data model is currently tied to a single geometry field per
> feature,
> feature definition and layer. But a number of data formats support multiple
> geometry fields. The OGC Simple Feature Specifications also do not limit to
> one geometry field per layer (e.g. ?7.1.4 of
> [http://portal.opengeospatial.org/files/?artifact_id=25354 OGC 06-104r4
> "OpenGIS? Implementation Standard for Geographic information - Simple
> feature
> access -Part 2: SQL option]).
>
> There are workarounds : using geometries of type GEOMETRYCOLLECTION, or
> advertizing as many layers as there are geometry columns in the layer (like
> currently done in the PostGIS or SQLite drivers). All those approach are at
> best workarounds that suffer from limitations :
>   * GEOMETRYCOLLECTION approach : no way to know the name/semantics of each
>     sub-geometry. All sub-geometries must be expressed in the same SRS. No
> way
>     of guaranteeing that the GEOMETRYCOLLECTION has always the same number
> of
>     sub-geometries or that there are of a consistent geometry type.
>   * one layer per geometry column approach : only appropriate for read-only
>     scenarios. Cannot work in write scenarios.
>
> The purpose of this RFC is to make support for multiple geometry fields per
> feature to be properly taken into account in the OGR data model.
>
> [...]
>
> Best regards,
>
> Even
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130724/df9afc44/attachment-0001.html>

From even.rouault at mines-paris.org  Wed Jul 24 10:29:58 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 24 Jul 2013 19:29:58 +0200
Subject: [gdal-dev] Call for discussion for "RFC 41 : Support for
	multiple geometry fields in OGR"
In-Reply-To: <CA+YzLBdeGbPyP-UCyH9vDfW3xeJo62Jz8DfDFqhDdoWmoRS=dg@mail.gmail.com>
References: <201307241449.37980.even.rouault@mines-paris.org>
	<CA+YzLBdeGbPyP-UCyH9vDfW3xeJo62Jz8DfDFqhDdoWmoRS=dg@mail.gmail.com>
Message-ID: <201307241929.58506.even.rouault@mines-paris.org>

Le mercredi 24 juillet 2013 18:42:59, Frank Warmerdam a ?crit :
> Even,
> 
> An excellent proposal!
> 
> I'm a bit sad about GetSpatialRef() on the first geometry field not
> necessarily returning the right value for old drivers.  I'd suggest we make
> a quick pass through the checked in drivers once your core work is done to
> update them.

This would require inspecting all driver code and make sure that at each place 
where they affect their poSRS member variable, they also call GetLayerDefn()-
>GetGeometryFieldDefn(0)->SetSpatialRef(poSRS) (caution: we must check that 
GetGeometryFieldCount() != 0 ! it can be 0 if SetGeomType(wkbNone) is called 
). A more reliable way of catching all the affected places reliably would be to 
remove the poSRS member from the drivers' layer classes and call 
SetSpatialRef() at geometry field defn.

I was also thinking to another way of doing that. It would have consisted in 
blindly replacing all occurences of new OGRFeatureDefn(name) in OGR drivers by 
new OGRClassFeatureDefn(this, name) (or a better name for this class !).

And have :

class OGRClassFeatureDefn : public OGRFeatureDefn
{
    private:
        bool bHackDone;
        OGRLayer* poLayer;

    public:
        OGRClassFeatureDefn(OGRLayer* poLayer, const char* pszName) :
            OGRFeatureDefn(pszName), bHackDone(false), poLayer(poLayer)
        {
        }

        virtual OGRGeomFieldDefn *GetGeomFieldDefn( int i )
        {
            OGRGeomFielDefn* poGeomFieldDefn =
                  OGRFeatureDefn::GetGeomFieldDefn(i);
            if( !bHackDone && i == 0 && poGeomFieldDefn != NULL &&
                poGeomFieldDefn->GetSpatialRef() == NULL )
            {
                bHackDone = true; /* prevent recursion if GetSpatialRef() 
calls GetGeomFieldDefn() */
                OGRSpatialRef* poSRS = poLayer->GetSpatialRef();
                if( poSRS != NULL )
                    poGeomFieldDefn->SetSpatialRef(poSRS);
            }
            return poGeomFieldDefn;
        }
};

... but there's a small problem. It is currently valid to access to the 
feature definition (and thus to a field definition) after the OGRLayer has been 
destroyed since feature/feature definitions are not strongly tied to their 
layer container.

OGRFeature* poFeat = poLayer->GetNextFeature();
delete poDS;
poFeat->GetGeomFieldDefnRef(0)->GetSpatialRef() --> bang !
delete poFeat;


> 
> I'd be interested in implementing multiple geometry column for the fusion
> tables driver to get my feet wet with this new capability once the core
> work is done.
> 
> I'd also love to see it added for GML but that could be an involved
> process, so I'm not going to commit to taking it on.

Yes, there are changes at .gfs level that should be done, and the GML code 
itself is now "a bit" cluttered (my fault...) with various hacks related to 
SRS handling, mainly to deal with specific GML profiles (WFS, etc...)

> 
> It is also timely in that the question of multi-geometry support came up
> recently in reference to Google Maps Engine.
> 
> Best regards,
> Frank
> 
> 
> 
> On Wed, Jul 24, 2013 at 5:49 AM, Even Rouault
> 
> <even.rouault at mines-paris.org>wrote:
> > Hi,
> > 
> > This is a call for discussion for "RFC 41 : Support for multiple geometry
> > fields in OGR" :
> > 
> > http://trac.osgeo.org/gdal/wiki/rfc41_multiple_geometry_fields
> > 
> > As an introduction, you'll find below the first paragraphs of the RFC.
> > Much more
> > to read at the above link !
> > 
> > == Summary ==
> > 
> > Add read/write support in the OGR data model for features with multiple
> > geometry fields.
> > 
> > == Motivation ==
> > 
> > The OGR data model is currently tied to a single geometry field per
> > feature,
> > feature definition and layer. But a number of data formats support
> > multiple geometry fields. The OGC Simple Feature Specifications also do
> > not limit to one geometry field per layer (e.g. ?7.1.4 of
> > [http://portal.opengeospatial.org/files/?artifact_id=25354 OGC 06-104r4
> > "OpenGIS? Implementation Standard for Geographic information - Simple
> > feature
> > access -Part 2: SQL option]).
> > 
> > There are workarounds : using geometries of type GEOMETRYCOLLECTION, or
> > advertizing as many layers as there are geometry columns in the layer
> > (like currently done in the PostGIS or SQLite drivers). All those
> > approach are at
> > 
> > best workarounds that suffer from limitations :
> >   * GEOMETRYCOLLECTION approach : no way to know the name/semantics of
> >   each
> >   
> >     sub-geometry. All sub-geometries must be expressed in the same SRS.
> >     No
> > 
> > way
> > 
> >     of guaranteeing that the GEOMETRYCOLLECTION has always the same
> >     number
> > 
> > of
> > 
> >     sub-geometries or that there are of a consistent geometry type.
> >   
> >   * one layer per geometry column approach : only appropriate for
> >   read-only
> >   
> >     scenarios. Cannot work in write scenarios.
> > 
> > The purpose of this RFC is to make support for multiple geometry fields
> > per feature to be properly taken into account in the OGR data model.
> > 
> > [...]
> > 
> > Best regards,
> > 
> > Even
> > 
> > --
> > Geospatial professional services
> > http://even.rouault.free.fr/services.html
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From Anthony.W.Baker at boeing.com  Wed Jul 24 13:06:01 2013
From: Anthony.W.Baker at boeing.com (Baker, Anthony W)
Date: Wed, 24 Jul 2013 20:06:01 +0000
Subject: [gdal-dev] GDAL WMS Reader projection info blank
References: <201307241449.37980.even.rouault@mines-paris.org>
	<CA+YzLBdeGbPyP-UCyH9vDfW3xeJo62Jz8DfDFqhDdoWmoRS=dg@mail.gmail.com>
	<201307241929.58506.even.rouault@mines-paris.org> 
Message-ID: <1106E45778F04E4D94505A07DD74991203F7E0@XCH-PHX-403.sw.nos.boeing.com>

I am reading through a WMS for raster data using GDALOpen with a GDALWMS xml file.  The first pass of reading the file it picks up the projection information without an issue.  On a later pass of doing a GDALOpen during the same process the projection information is blank.  I think it may be some of the resource clean up that I am doing, although nothing similar happens for standalone raster files. 

I am not sure why this happens.  Can someone shed some light on this for me?

Thank you,

Anthony

Projection info from the first pass:
PROJCS["NAD83 / UTM zone 12N",GEOGCS["NAD83",DATUM["North_American_Datum_1983",SPHEROID["GRS 1980",6378137,298.257222101,AUTHORITY["EPSG","7019"]],TOWGS84[0,0,0,0,0,0,0],AUTHORITY["EPSG","6269"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4269"]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",-111],PARAMETER["scale_factor",0.9996],PARAMETER["false_easting",500000],PARAMETER["false_northing",0],UNIT["metre",1,AUTHORITY["EPSG","9001"]],AXIS["Easting",EAST],AXIS["Northing",NORTH],AUTHORITY["EPSG","26912"]]

From pi_ml at sourcepole.com  Wed Jul 24 13:23:14 2013
From: pi_ml at sourcepole.com (Pirmin Kalberer)
Date: Wed, 24 Jul 2013 22:23:14 +0200
Subject: [gdal-dev] Call for discussion for "RFC 41 : Support for
	multiple geometry fields in OGR"
In-Reply-To: <51EFDFB5.3060706@carto.net>
References: <201307241449.37980.even.rouault@mines-paris.org>
	<768E6C6F-C407-4745-9E9B-96A0DEA2AE67@gmail.com>
	<51EFDFB5.3060706@carto.net>
Message-ID: <3356090.zLhYVnkGn9@polarwind2>

Am Mittwoch, 24. Juli 2013, 16.07:49 schrieb Andreas Neumann:
> I can't comment about the technical issues. But from a user point of
> view there is a need to have more than one geometry representation per
> feature. There could be several generalizations attached to a feature,
> or different states.
> 
> I would welcome such a feature in OGR.
> 
> I guess Swisstopo also has a specific use case in mind since they
> sponsor the work. Do you know which?

This RFC is part of a contract with Swisstopo to support multiple geometries 
in Interlis. We considered a workaround like the one implemented for PostGIS, 
but came to the conclusion, that only extending OGR core will allow a good 
solution.
The use case is importing Interlis into PostGIS, but also writing Interlis 
with multiple geometries in one layer.

Pirmin

-- 
Pirmin Kalberer
Sourcepole  -  Linux & Open Source Solutions
http://www.sourcepole.com


From dan.strobridge at westonsolutions.com  Thu Jul 25 12:47:07 2013
From: dan.strobridge at westonsolutions.com (Dan Strobridge)
Date: Thu, 25 Jul 2013 12:47:07 -0700 (PDT)
Subject: [gdal-dev] [BULK]  Re: Dissolve shapefile using GDAL/OGR
In-Reply-To: <AA4FE6F1C40C7F42843DFCC503EE2DA11695A311CE@EXCHANGE.corp.rfweston.com>
References: <CAKGFd-zX5HftF611LHoWhzv6kVXMcXMAB5PJsxKMJC_D_pXEiA@mail.gmail.com>
	<loom.20130226T150433-186@post.gmane.org>
	<CAKGFd-ya0QuY0jJ+7FberUWOE0dckXNjmxXWBwCN0gHNy82RYA@mail.gmail.com>
	<1374247404172-5067633.post@n6.nabble.com>
	<201307191959.36508.even.rouault@mines-paris.org>
	<AA4FE6F1C40C7F42843DFCC503EE2DA11695A311CE@EXCHANGE.corp.rfweston.com>
Message-ID: <1374781627369-5068800.post@n6.nabble.com>

Sorry, I meant Even (not Evan).  Another workaround I found is the dissolve
polygons tool in SAGA (instaled from OSGeo4W).  I found this tool very handy
since SAGA has a command line option and this specific tool allows up to
three dissolve fields to be specified.  My syntax was:

saga_cmd shapes_polygons "Polygon Dissolve" -POLYGONS=infile.shp
-DISSOLVED=outfile.shp -FIELD_1=combo -FIELD_2=zone -FIELD_3=val -DISSOLVE=0

Dan



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Dissolve-shapefile-using-GDAL-OGR-tp5036930p5068800.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at mines-paris.org  Thu Jul 25 15:00:12 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 26 Jul 2013 00:00:12 +0200
Subject: [gdal-dev] Call for discussion for "RFC 41 : Support for
	multiple geometry fields in OGR"
In-Reply-To: <201307241449.37980.even.rouault@mines-paris.org>
References: <201307241449.37980.even.rouault@mines-paris.org>
Message-ID: <201307260000.13308.even.rouault@mines-paris.org>

Hi,

I've added the following note in the RFC :

"""
Note: before RFC41, SetGeometry() or SetGeometryDirectly() could work on a
feature whose feature definition had a GetGeomType() == wkbNone (which was
inconsistant). This will be no longer the case since the size of the
papoGeometries array is now based on GetGeomFieldCount(), and when
GetGeomType() == wkbNone, the geometry field count is 0. The VRT and CSV 
drivers
will be fixed to declare their geometry type consistently.
"""

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From szekerest at gmail.com  Thu Jul 25 23:17:31 2013
From: szekerest at gmail.com (Tamas Szekeres)
Date: Fri, 26 Jul 2013 08:17:31 +0200
Subject: [gdal-dev] C# version of ogr2ogr function
In-Reply-To: <OF025156FE.58C0915B-ON88257BB3.00717188-88257BB3.0071DA74@camsys.com>
References: <OF4A02C11C.BA52A963-ON88257B96.00720DE1-88257B96.007268C0@camsys.com>
	<CACALY+Q6wYz7i-qrp25191Josv0u_qbCx+hifRq5M-574-miZw@mail.gmail.com>
	<OFC70230A1.E54DD599-ON88257B98.00002D8F-88257B98.0003AC75@camsys.com>
	<CACALY+QjSWqZnEX0fMdMvRNVXsOrjZhV8VC_ifQ10Y9krtj0Tg@mail.gmail.com>
	<OFA8A24649.11F49C03-ON88257B98.0079E79D-88257B98.007A4199@camsys.com>
	<OF025156FE.58C0915B-ON88257BB3.00717188-88257BB3.0071DA74@camsys.com>
Message-ID: <CACALY+Tu47=QCraHHVm0bWA9BhKqtZDQKFKxPhCPzyxkaZp-+A@mail.gmail.com>

You may require further dll-s to be copied if you install further drivers
compiled as plugins.

Best regards,

Tamas


2013/7/25 Genhan Chen <GChen at camsys.com>

> In order to make OGR function working, the following 18 files should be
> included.:
>
> ogr_csharp.dll
> ogr_wrap.dll
> gdal110.dll
> geos_c.dll
> iconv.dll
> libcurl.dll
> libeay32.dll
> libexpat.dll
> libmysql.dll
> libpq.dll
> msvcp100.dll
> msvcr100.dll
> oppenjp2.dll
> proj.dll
> sptialite.dll
> ssleay32.dll
> xerces-c_2_8.dll
> zlib1.dll
>
> Genhan Chen
> Cambridge Systematics, Inc.
> 555 12th Street, Suite 1600
> Oakland CA 94607
> tel  510 873 8700
> fax  510 873 8701
> e-mail gchen at camsys.com
> www.camsys.com
>
>
>
> From:        Genhan Chen <GChen at camsys.com>
> To:        Tamas Szekeres <szekerest at gmail.com>,
> Cc:        gdal-dev at lists.osgeo.org
> Date:        06/28/2013 03:15 PM
> Subject:        Re: [gdal-dev] C# version of ogr2ogr function
> Sent by:        gdal-dev-bounces at lists.osgeo.org
> ------------------------------
>
>
>
> Thank you very much, Tamas!
>
> Do you know which dll files are the dependencies of *ogr_csharp.dl*l. It
> will be nice if I do not have to put all dll files into my project.
>
> Best,
>
> Genhan Chen
> Cambridge Systematics, Inc.
> 555 12th Street, Suite 1600
> Oakland CA 94607
> tel  510 873 8700
> fax  510 873 8701
> e-mail gchen at camsys.com*
> **www.camsys.com* <http://www.camsys.com>
>
>
>
> From:        Tamas Szekeres <szekerest at gmail.com>
> To:        Genhan Chen <GChen at camsys.com>,
> Cc:        gdal-dev at lists.osgeo.org
> Date:        06/27/2013 11:17 PM
> Subject:        Re: [gdal-dev] C# version of ogr2ogr function
>  ------------------------------
>
>
>
> Make sure to copy all the dll-s from the /bin and /bin/gdal/csharp
> directories into you application directory, or make the location of this
> files available in the PATH environment variable.
>
> Best regards,
>
> Tamas
>
>
>
>
> 2013/6/28 Genhan Chen <*GChen at camsys.com* <GChen at camsys.com>>
> Hi Tamas,
>
> I am using pre-compiled *ogr_csharp.dl*l, downloaded from *
> http://vbkto.dyndns.org/sdk/* <http://vbkto.dyndns.org/sdk/> . I added "*using
> OSGeo.OGR*" in front of the class. and did not see any error during build
> process.
>
> However, I got the following error message if any Ogr method (e.g. "*
> Ogr.RegisterAll()*;") was added in the program.: *
>
> {"The type initializer for 'OSGeo.OGR.OgrPINVOKE' threw an exception."}
>      * *
> System.Exception {System.TypeInitializationException}*
>
> Do you know what caused this error?
>
> Thanks a lot,
>
> Genhan Chen
> Cambridge Systematics, Inc.
> 555 12th Street, Suite 1600
> Oakland CA 94607
> tel  *510 873 8700* <510%20873%208700>
> fax  *510 873 8701* <510%20873%208701>
> e-mail *gchen at camsys.com* <gchen at camsys.com>*
> **www.camsys.com* <http://www.camsys.com/>
>
>
>
> From:        Tamas Szekeres <*szekerest at gmail.com* <szekerest at gmail.com>>
> To:        Genhan Chen <*GChen at camsys.com* <GChen at camsys.com>>,
> Cc:        *gdal-dev at lists.osgeo.org* <gdal-dev at lists.osgeo.org>
> Date:        06/26/2013 11:28 PM
> Subject:        Re: [gdal-dev] C# version of ogr2ogr function
>  ------------------------------
>
>
>
>
> Please refer to this thread for further information: *
> http://lists.osgeo.org/pipermail/gdal-dev/2009-March/020130.html*<http://lists.osgeo.org/pipermail/gdal-dev/2009-March/020130.html>
>
> Best regards,
>
> Tamas
>
>
>
> 2013/6/26 Genhan Chen <*GChen at camsys.com* <GChen at camsys.com>>
> Hello,
>
> I need a function (similar to ogr2ogr) to convert Shapefile into GeoJson
> format.
>
> How can I implement this function using C#, in .NET framework?
>
> Any help is really appreciated!
>
> Genhan Chen
> Cambridge Systematics, Inc.
> 555 12th Street, Suite 1600
> Oakland CA 94607
> tel  *510 873 8700* <510%20873%208700>
> fax  *510 873 8701* <510%20873%208701>
> e-mail *gchen at camsys.com* <gchen at camsys.com>*
> **www.camsys.com* <http://www.camsys.com/>
> _______________________________________________
> gdal-dev mailing list*
> **gdal-dev at lists.osgeo.org* <gdal-dev at lists.osgeo.org>*
> **http://lists.osgeo.org/mailman/listinfo/gdal-dev*<http://lists.osgeo.org/mailman/listinfo/gdal-dev>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130726/ab502462/attachment.html>

From ari.jolma at gmail.com  Fri Jul 26 00:09:42 2013
From: ari.jolma at gmail.com (Ari Jolma)
Date: Fri, 26 Jul 2013 10:09:42 +0300
Subject: [gdal-dev] OGRLayer.Intersection() Question
In-Reply-To: <CAAU4rM8qr9CG6qN09Oi46=OBK7CvV74xSoBq+xuf4ExAAA6pfg@mail.gmail.com>
References: <CAAU4rM8qr9CG6qN09Oi46=OBK7CvV74xSoBq+xuf4ExAAA6pfg@mail.gmail.com>
Message-ID: <51F220B6.3030706@gmail.com>

On 07/01/2013 10:13 PM, Dheeraj Reddy Mamidi wrote:
> Hi All,
>
> I was trying to perform intersection on two feature classes (shape 
> file format) using OGRLayer.Intersection(),  but have problems making 
> it work with C# bindings. I am not able to figure out on how to pass 
> the arguments SWIGTYPE_p_GDALProgressFunc callback 
> and OSGeo.OGR.SWIGTYPE_p_void callback_data. Can someone please help 
> me figure out on how to handle these. I keep getting the error 
> "Attempt to dereference null GDALProgressFunc". I am not sure what 
> that means.

I don't know the details of C# bindings but the callback function and 
the callback data are by default NULL and you should be able to just 
ignore them, i.e., not supply any arguments.

Ari

>
> Please share an example on how to call Intersection routine or some 
> other routine which takes above mentioned argument types.
>
> Thank you,
> Dheeraj Reddy Mamidi
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130726/50641c05/attachment-0001.html>

From radim.blazek at gmail.com  Fri Jul 26 04:19:31 2013
From: radim.blazek at gmail.com (Radim Blazek)
Date: Fri, 26 Jul 2013 13:19:31 +0200
Subject: [gdal-dev] Cannot read overviews if VSI cache is on
Message-ID: <CAEMrtYr_FkQ3GArPr8SJo4oimTsaSg12Ctwqo-_sgcW-ZdWdcQ@mail.gmail.com>

GDAL 1.9.2 fails to read (large?) overview files if
    VSI_CACHE=TRUE
    VSI_CACHE_SIZE=1000000
The problem is described here: http://hub.qgis.org/issues/8356.
I just guess, that overview file keeps overview headers scattered over
the file and VSI fails to set offset, 17891712530 in this case, over
some limit.

Could it be some hardcoded limit in VSI subsystem? Or just int used
for offset instead of long? Is it easy to fix? Should I create a new
ticket?

Until it gets fixed in GDAL, how can we easily enable the VSI cache
for OGR and disable it for GDAL?

Radim

From jwesroberts at gmail.com  Fri Jul 26 04:30:52 2013
From: jwesroberts at gmail.com (Wesley Roberts)
Date: Fri, 26 Jul 2013 13:30:52 +0200
Subject: [gdal-dev] Modis MCD45 GeoTiff subsetting offset
Message-ID: <CAFik=Fd4j56_TVu8YZSk6mSD6us85ZKsqLxXb8DmQY5aY+LxTA@mail.gmail.com>

Dear gdal-dev

I am currently working with some burnt area (GeoTIFF) data from the
University of Maryland (http://modis-fire.umd.edu/Burned_Area_Products.html).
I have been attempting to subset this data to my study area. Unfortunately
when I subset the GeoTIFF the output is offset in a south easterly
direction by approximately 200m. Below is my command.

gdalwarp -s_srs EPSG:54001 -t_srs EPSG:4326
MCD45monthly.A2009244.Win13.051.ba_qa.tif test.tif

The data are in Plate-Caree projection (lat / lon not meters) and I have
been struggling to figure out how to change this as I believe that this is
the source of my problems. I have tried various approaches using both
EPSG:32662 and EPSG:54001. As well as some suggested on the mailing list.

http://osgeo-org.1560.x6.nabble.com/Does-GDAL-handle-rotated-spheres-td3763008.html

Unfortunately I am unable to solve the offset problem. I am using the
following version of gdal on an Ubuntu 12.04

GDAL 1.9.1, released 2012/05

Any help or advice would be much appreciated.
Regards,
Wesley

-- 
Dr Wesley Roberts
jwesroberts at gmail.com
Cell: +27(0)83 5355 646
skype: roberts-w
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130726/7ddc0a25/attachment.html>

From even.rouault at mines-paris.org  Fri Jul 26 05:37:21 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 26 Jul 2013 14:37:21 +0200
Subject: [gdal-dev] Cannot read overviews if VSI cache is on
In-Reply-To: <CAEMrtYr_FkQ3GArPr8SJo4oimTsaSg12Ctwqo-_sgcW-ZdWdcQ@mail.gmail.com>
References: <CAEMrtYr_FkQ3GArPr8SJo4oimTsaSg12Ctwqo-_sgcW-ZdWdcQ@mail.gmail.com>
Message-ID: <1374842241.51f26d8169f16@imp.free.fr>

Selon Radim Blazek <radim.blazek at gmail.com>:

> GDAL 1.9.2 fails to read (large?) overview files if
>     VSI_CACHE=TRUE
>     VSI_CACHE_SIZE=1000000
> The problem is described here: http://hub.qgis.org/issues/8356.
> I just guess, that overview file keeps overview headers scattered over
> the file and VSI fails to set offset, 17891712530 in this case, over
> some limit.
>
> Could it be some hardcoded limit in VSI subsystem? Or just int used
> for offset instead of long? Is it easy to fix? Should I create a new
> ticket?

Hi Radim,

yes, you likely spotted a bug in the VSI Cache mechanism. Please file a GDAL
ticket.

I've just done some quick code inspection in port/cpl_vsil_cache.cpp and I
suspect that the error comes from the signature of

int VSICachedFile::LoadBlocks( size_t nStartBlock, size_t nBlockCount,
                               void *pBuffer, size_t nBufferSize );

and a few other uses of size_t in VSICachedFile::Read().

The size_t nStartBlock should likely be a vsi_l_offset. I guess the issue is met
on a 32bit GDAL build ? On 64 bit, the error must not be hit as size_t will be
64 bit.


>
> Until it gets fixed in GDAL, how can we easily enable the VSI cache
> for OGR and disable it for GDAL?

Well, you could try that at each place where you GDALOpen():

/* yes strdup it since SetThreadLocalConfigOption() might invalidate the value
returned by CPLGetConfigOption() */
char* pszOldVal = CPLStrdup(CPLGetConfigOption("VSI_CACHE", "FALSE"));
CPLSetThreadLocalConfigOption("VSI_CACHE", "FALSE");
GDALDataset hDS = GDALOpen(xxxx);
CPLSetThreadLocalConfigOption("VSI_CACHE", pszOldVal);
CPLFree(pszOldVal);

I'd suggest doing a wrapper function for the above, in case GDALOpen() is used
several times in QGIS code base...

However.... in some cases, the opening of GDAL datasets is differed. This is the
case for a VRT. If you open a VRT, GDAL opens the .vrt file, but doesn't open
immediately the tiles that compose it. So the above might not work reliably. Or
you might need to wrap GDALRasterIO() similarly, and potentially other GDAL API
that can indirectly lead to a GDALOpen() (statistics, histograms, ...)

Best regards,

Even



From drmamidi at rothwellgroup.com  Fri Jul 26 07:59:11 2013
From: drmamidi at rothwellgroup.com (Dheeraj Reddy Mamidi)
Date: Fri, 26 Jul 2013 08:59:11 -0600
Subject: [gdal-dev] OGRLayer.Intersection() Question
In-Reply-To: <51F220B6.3030706@gmail.com>
References: <CAAU4rM8qr9CG6qN09Oi46=OBK7CvV74xSoBq+xuf4ExAAA6pfg@mail.gmail.com>
	<51F220B6.3030706@gmail.com>
Message-ID: <CAAU4rM-UFQCpGDw9X8VTypVJtHmV=F_WyoZFoJEcCreiXe_CUA@mail.gmail.com>

Hi Ari,

I did try passing the two callback arguments as null (trying to ignore). It
doesn't seem to work by doing that.

Thanks,
Dheeraj


On Fri, Jul 26, 2013 at 1:09 AM, Ari Jolma <ari.jolma at gmail.com> wrote:

>  On 07/01/2013 10:13 PM, Dheeraj Reddy Mamidi wrote:
>
> Hi All,
>
>  I was trying to perform intersection on two feature classes (shape file
> format) using OGRLayer.Intersection(),  but have problems making it work
> with C# bindings. I am not able to figure out on how to pass the
> arguments SWIGTYPE_p_GDALProgressFunc callback
> and OSGeo.OGR.SWIGTYPE_p_void callback_data. Can someone please help me
> figure out on how to handle these. I keep getting the error "Attempt to
> dereference null GDALProgressFunc". I am not sure what that means.
>
>
> I don't know the details of C# bindings but the callback function and the
> callback data are by default NULL and you should be able to just ignore
> them, i.e., not supply any arguments.
>
> Ari
>
>
>  Please share an example on how to call Intersection routine or some
> other routine which takes above mentioned argument types.
>
>  Thank you,
>  Dheeraj Reddy Mamidi
>
>
>
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttp://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
Dheeraj Reddy Mamidi

Software Developer
The Rothwell Group, L.P.
Email: drmamidi at rothwellgroup.com <atvaughan at rothwellgroup.com>
Phone: 713-952-5355 ext.30
Web: www.rothwellgroup.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130726/85dca5dd/attachment.html>

From even.rouault at mines-paris.org  Fri Jul 26 12:26:10 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 26 Jul 2013 21:26:10 +0200
Subject: [gdal-dev] Cannot read overviews if VSI cache is on
In-Reply-To: <1374842241.51f26d8169f16@imp.free.fr>
References: <CAEMrtYr_FkQ3GArPr8SJo4oimTsaSg12Ctwqo-_sgcW-ZdWdcQ@mail.gmail.com>
	<1374842241.51f26d8169f16@imp.free.fr>
Message-ID: <201307262126.10448.even.rouault@mines-paris.org>

Le vendredi 26 juillet 2013 14:37:21, Even Rouault a ?crit :
> Selon Radim Blazek <radim.blazek at gmail.com>:
> > GDAL 1.9.2 fails to read (large?) overview files if
> > 
> >     VSI_CACHE=TRUE
> >     VSI_CACHE_SIZE=1000000
> > 
> > The problem is described here: http://hub.qgis.org/issues/8356.
> > I just guess, that overview file keeps overview headers scattered over
> > the file and VSI fails to set offset, 17891712530 in this case, over
> > some limit.
> > 
> > Could it be some hardcoded limit in VSI subsystem? Or just int used
> > for offset instead of long? Is it easy to fix? Should I create a new
> > ticket?
> 
> Hi Radim,
> 
> yes, you likely spotted a bug in the VSI Cache mechanism. Please file a
> GDAL ticket.

I could indeed reproduce on a unit test on Linux 32 bit. I've created 
http://trac.osgeo.org/gdal/ticket/5170 and pushed the fix

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From radim.blazek at gmail.com  Fri Jul 26 23:36:20 2013
From: radim.blazek at gmail.com (Radim Blazek)
Date: Sat, 27 Jul 2013 08:36:20 +0200
Subject: [gdal-dev] Cannot read overviews if VSI cache is on
In-Reply-To: <201307262126.10448.even.rouault@mines-paris.org>
References: <CAEMrtYr_FkQ3GArPr8SJo4oimTsaSg12Ctwqo-_sgcW-ZdWdcQ@mail.gmail.com>
	<1374842241.51f26d8169f16@imp.free.fr>
	<201307262126.10448.even.rouault@mines-paris.org>
Message-ID: <CAEMrtYrdvAjAH_wxND_pzANWNQa8efdBuKrBeakHqT_nTFgr1g@mail.gmail.com>

Hi Even,
thanks for really fast resolution!

Radim

On Fri, Jul 26, 2013 at 9:26 PM, Even Rouault
<even.rouault at mines-paris.org> wrote:
> Le vendredi 26 juillet 2013 14:37:21, Even Rouault a ?crit :
>> Selon Radim Blazek <radim.blazek at gmail.com>:
>> > GDAL 1.9.2 fails to read (large?) overview files if
>> >
>> >     VSI_CACHE=TRUE
>> >     VSI_CACHE_SIZE=1000000
>> >
>> > The problem is described here: http://hub.qgis.org/issues/8356.
>> > I just guess, that overview file keeps overview headers scattered over
>> > the file and VSI fails to set offset, 17891712530 in this case, over
>> > some limit.
>> >
>> > Could it be some hardcoded limit in VSI subsystem? Or just int used
>> > for offset instead of long? Is it easy to fix? Should I create a new
>> > ticket?
>>
>> Hi Radim,
>>
>> yes, you likely spotted a bug in the VSI Cache mechanism. Please file a
>> GDAL ticket.
>
> I could indeed reproduce on a unit test on Linux 32 bit. I've created
> http://trac.osgeo.org/gdal/ticket/5170 and pushed the fix
>
> Even
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html

From radim.blazek at gmail.com  Fri Jul 26 23:42:42 2013
From: radim.blazek at gmail.com (Radim Blazek)
Date: Sat, 27 Jul 2013 08:42:42 +0200
Subject: [gdal-dev] Cannot read overviews if VSI cache is on
In-Reply-To: <1374842241.51f26d8169f16@imp.free.fr>
References: <CAEMrtYr_FkQ3GArPr8SJo4oimTsaSg12Ctwqo-_sgcW-ZdWdcQ@mail.gmail.com>
	<1374842241.51f26d8169f16@imp.free.fr>
Message-ID: <CAEMrtYoM_W4U86BYeM-frHTXVUPwMVdNdW-bMkj0DMuXZfkb4w@mail.gmail.com>

Hi Even,

thanks for quick response and exhaustive information.

On Fri, Jul 26, 2013 at 2:37 PM, Even Rouault
<even.rouault at mines-paris.org> wrote:
> Selon Radim Blazek <radim.blazek at gmail.com>:
>
>> GDAL 1.9.2 fails to read (large?) overview files if
>>     VSI_CACHE=TRUE
>>     VSI_CACHE_SIZE=1000000
>> The problem is described here: http://hub.qgis.org/issues/8356.
>> I just guess, that overview file keeps overview headers scattered over
>> the file and VSI fails to set offset, 17891712530 in this case, over
>> some limit.
>>
>> Could it be some hardcoded limit in VSI subsystem? Or just int used
>> for offset instead of long? Is it easy to fix? Should I create a new
>> ticket?
>
> Hi Radim,
>
> yes, you likely spotted a bug in the VSI Cache mechanism. Please file a GDAL
> ticket.
>
> I've just done some quick code inspection in port/cpl_vsil_cache.cpp and I
> suspect that the error comes from the signature of
>
> int VSICachedFile::LoadBlocks( size_t nStartBlock, size_t nBlockCount,
>                                void *pBuffer, size_t nBufferSize );
>
> and a few other uses of size_t in VSICachedFile::Read().
>
> The size_t nStartBlock should likely be a vsi_l_offset. I guess the issue is met
> on a 32bit GDAL build ? On 64 bit, the error must not be hit as size_t will be
> 64 bit.
>
>
>>
>> Until it gets fixed in GDAL, how can we easily enable the VSI cache
>> for OGR and disable it for GDAL?
>
> Well, you could try that at each place where you GDALOpen():
>
> /* yes strdup it since SetThreadLocalConfigOption() might invalidate the value
> returned by CPLGetConfigOption() */
> char* pszOldVal = CPLStrdup(CPLGetConfigOption("VSI_CACHE", "FALSE"));
> CPLSetThreadLocalConfigOption("VSI_CACHE", "FALSE");
> GDALDataset hDS = GDALOpen(xxxx);
> CPLSetThreadLocalConfigOption("VSI_CACHE", pszOldVal);
> CPLFree(pszOldVal);
>
> I'd suggest doing a wrapper function for the above, in case GDALOpen() is used
> several times in QGIS code base...
>
> However.... in some cases, the opening of GDAL datasets is differed. This is the
> case for a VRT. If you open a VRT, GDAL opens the .vrt file, but doesn't open
> immediately the tiles that compose it. So the above might not work reliably. Or
> you might need to wrap GDALRasterIO() similarly, and potentially other GDAL API
> that can indirectly lead to a GDALOpen() (statistics, histograms, ...)

But the problem only happens with OVR file which is too big, the tiles
are OK. I believe that OVR is opened together with VRT, (GDALOpen() is
called form GDALOpen()?) so it should work just with GDALOpen()
wrapper?

Radim

> Best regards,
>
> Even
>
>

From even.rouault at mines-paris.org  Mon Jul 29 04:15:01 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 29 Jul 2013 13:15:01 +0200
Subject: [gdal-dev] Motion: Adopt RFC 41 : Support for multiple geometry
	fields in OGR
Message-ID: <201307291315.01179.even.rouault@mines-paris.org>

Hi,

Motion: I move to adopt RFC 41 : Support for multiple geometry fields in OGR

    http://trac.osgeo.org/gdal/wiki/rfc41_multiple_geometry_fields

I've made a few changes in the last few days. See the history :
http://trac.osgeo.org/gdal/wiki/rfc41_multiple_geometry_fields?action=history

Starting with my +1

Best regards,

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From warmerdam at pobox.com  Mon Jul 29 08:49:15 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon, 29 Jul 2013 08:49:15 -0700
Subject: [gdal-dev] Motion: Adopt RFC 41 : Support for multiple geometry
 fields in OGR
In-Reply-To: <201307291315.01179.even.rouault@mines-paris.org>
References: <201307291315.01179.even.rouault@mines-paris.org>
Message-ID: <CA+YzLBdD5SKS1USX4qjPkHLUEJv1FxpaxoF3J1Au7wDibEc85w@mail.gmail.com>

+1 Frank
 On Jul 29, 2013 4:14 AM, "Even Rouault" <even.rouault at mines-paris.org>
wrote:

> Hi,
>
> Motion: I move to adopt RFC 41 : Support for multiple geometry fields in
> OGR
>
>     http://trac.osgeo.org/gdal/wiki/rfc41_multiple_geometry_fields
>
> I've made a few changes in the last few days. See the history :
>
> http://trac.osgeo.org/gdal/wiki/rfc41_multiple_geometry_fields?action=history
>
> Starting with my +1
>
> Best regards,
>
> Even
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130729/35650cc3/attachment.html>

From nik at nikosalexandris.net  Mon Jul 29 15:00:40 2013
From: nik at nikosalexandris.net (Nikos Alexandris)
Date: Tue, 30 Jul 2013 01:00:40 +0300
Subject: [gdal-dev] Working with NTF files
In-Reply-To: <1395474.MY5m1vMGQt@vertikal>
References: <1694187.sUFg9XEByB@resilience>
	<CA+YzLBcC-GGmhJEfYCCKKZVZioFcjY01q9CDwLF1qw_3WskceQ@mail.gmail.com>
	<1395474.MY5m1vMGQt@vertikal>
Message-ID: <2636862.Qq23yPggT1@vertikal>

Nikos Alexandris:

> > > I am trying to handle ntf files (NITF) as easy as possible -- working
> > > with some WorldView 01/02 and QuickBird imagery.

[..]

> > > 2) A second, of less importance, question, is:  how important are the
> > > warnings like:  "Warning 1: Unable to save auxilary information in
> > > /vsisubfile/3884_471349721,10APR13WV020600013APR10075059-
> > > P1BS-500060446050_05_P003.ntf.aux.xml." ?


Frank W:

> > This is not important.  I presume you are getting this with JPEG2000
> > compressed image streams in NITF?


Nikos A:
 
> Correct

 
> > If you file a bug I might be able to clear this up but there are layers of
> > complexity that make it challening.

 
> I will (take the time later to) file a ticket.


Done as http://trac.osgeo.org/gdal/ticket/5173

Nikos

From nik at nikosalexandris.net  Mon Jul 29 15:21:15 2013
From: nik at nikosalexandris.net (Nikos Alexandris)
Date: Tue, 30 Jul 2013 01:21:15 +0300
Subject: [gdal-dev] [GRASS-user]  Working with NTF files
In-Reply-To: <CAG+h=FFR4wNQPbN-Zk6AcRQKyD+c9PUTTW4L7FeLzJk+AgqQ-w@mail.gmail.com>
References: <1694187.sUFg9XEByB@resilience> <1679940.j2xjZrXbe6@resilience>
	<CAG+h=FFR4wNQPbN-Zk6AcRQKyD+c9PUTTW4L7FeLzJk+AgqQ-w@mail.gmail.com>
Message-ID: <3419790.oTMNCk1v19@vertikal>

Should I file for this a ticket in GRASS' trac first?

Nikos

--%<---

1)

Markus Metz wrote:
> >> What says g.proj georef=your_geofile -p?

Nikos Alexandris:
> > g.proj -p georef=15JUN11IK0101000po_697515_pan_0000000.ntf

> > Trying to open with OGR...
> > ...succeeded.
> > WARNING: Read of file 15JUN11IK0101000po_697515_pan_0000000.ntf was
> > successful, but it did not contain projection information. 'XY
> > (unprojected)' will be used XY location (unprojected)

> > This is however 1) strange -- it misses a message like "Trying to open
> > with GDAL..." and 2) (successively) not true because gdalinfo reports:

Markus M:
> g.proj first tries to open the geofile with OGR, if that fails, it
> tries to open it with GDAL. Apparently OGR found a driver with which
> it could successfully open the geofile. This might be a bug in OGR
> (Frank?).

Nikos A: 
> > Using this file in
> > "grass7 -c 15JUN11IK0101000po_697515_pan_0000000.tif
> > /grassdb/test_Location"

> > creates the following Location:
> > g.proj -p
> > -PROJ_INFO-------------------------------------------------
> > name : Lat/Lon
> > proj : ll
> > datum : wgs84
> > ellps : wgs84
> > no_defs : defined
> > -PROJ_UNITS------------------------------------------------
> > unit : degree
> > units : degrees
> > meters : 1.0

Markus M:
> grass7 -c uses g.proj to create a location, thus the resulting
> projection info of grass7 -c and g.proj georef= should be identical.



2)

Markus M:
> >> What reports r.in.gdal when trying to import in a location that
> >> definitively does not match the SRS?

Nikos A:
> > Now, r.in.gdal seems to correctly recognise the SRS!

Markus M: 
> Good. So it is either a bug in g.proj (even though the call to OGROpen()
> succeeds) or in OGR.

From Luke.Pinner at environment.gov.au  Mon Jul 29 20:12:29 2013
From: Luke.Pinner at environment.gov.au (lpinner)
Date: Mon, 29 Jul 2013 20:12:29 -0700 (PDT)
Subject: [gdal-dev] Working with NTF files
In-Reply-To: <1694187.sUFg9XEByB@resilience>
References: <1694187.sUFg9XEByB@resilience>
Message-ID: <1375153949188-5069520.post@n6.nabble.com>

A workaround to your 2nd question is to set the GDAL_PAM_PROXY_DIR
environment variable, either permanently or on the commandline before you
call gdalinfo.

set GDAL_PAM_PROXY_DIR=%TEMP%
gdalinfo -stats some.ntf



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Working-with-NTF-files-tp5066312p5069520.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at mines-paris.org  Tue Jul 30 08:22:30 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 30 Jul 2013 17:22:30 +0200
Subject: [gdal-dev] Automated publication of code coverage under GDAL
	autotest suite
In-Reply-To: <201307101913.10368.even.rouault@mines-paris.org>
References: <201307101913.10368.even.rouault@mines-paris.org>
Message-ID: <201307301722.30470.even.rouault@mines-paris.org>

Hi,

some update :

I've set-up 2 new branches in the https://github.com/rouault/gdal_coverage 
repository to also build & run the autotests with :

- Mac OS X : the trick is to indicate "language: objective-c" in the 
.travis.yml file of the branch so that a Mac OSX 10.8 VM is used. Even if your 
project is not objective-c.

- Windows with mingw/wine : a standard Travis-CI Ubuntu VM. GDAL is cross-
compiled with i586-mingw32msvc-gcc and the autotest suite is run with Win32 
Python2.7 under wine ...

The summary of the branches can be seen here :

https://travis-ci.org/rouault/gdal_coverage/branches

Even

Le mercredi 10 juillet 2013 19:13:10, Even Rouault a ?crit :
> Hi devs,
> 
> Similarly to what I've just done with MapServer, you can find at the
> following URL the continuously updated result of the code coverage under
> GDAL autotest suite :
> 
> http://rawgithub.com/rouault/gdalautotest-coverage-results/master/coverage_
> html/index.html
> 
> This is done by a Travis-CI job that runs on the following modified GIT
> mirror of the GDAL svn trunk :
> 
> https://github.com/rouault/gdal_coverage
> 
> If you are curious about the details, you can read the following messages
> related to my similar work on MapServer :
> 
> http://lists.osgeo.org/pipermail/mapserver-dev/2013-July/013403.html
> http://lists.osgeo.org/pipermail/mapserver-dev/2013-July/013418.html
> http://lists.osgeo.org/pipermail/mapserver-dev/2013-July/013424.html
> 
> Best regards,
> 
> Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From cgodkin at gmail.com  Tue Jul 30 15:07:08 2013
From: cgodkin at gmail.com (Carl Godkin)
Date: Tue, 30 Jul 2013 15:07:08 -0700
Subject: [gdal-dev] Using the OGR library with FileGDB driver
Message-ID: <CAE=8kmkG2mparihuMW1UREqYrtx+ZH2cyeZM7SHGLFY5ipUv6g@mail.gmail.com>

Hi,

I'm trying for the first time to use the OGR library to read ESRI FileGDB
(".gdb") databases and I think I must be doing something wrong.

I built GDAL 1.10.0 with VS2010 and (among other additions) the FileGDB_API
1.3 for VS2010 all on Win64.  Everything built cleanly but the OGR library
seems to be unable find layers in some .gdb data sets.

To take my own code out of the equation, I tried to list the layers in
various .gdb files from around the web using the version of "ogrinfo" built
along with the library.

All of example .gdb projects from the samples/data directory in the ESRI
FileGDB_API distribution work just fine as does some data from other
sources.

However, I find that a lot of .gdb data sets that I find on the web act as
if they have no layers.  (These are apparently up to date sites too, not
very old sites.)
In lots of cases, ogrinfo says just this:

>ogrinfo -al WA_wetlands.gdb
INFO: Open of `WA_wetlands.gdb'
      using driver `FileGDB' successful.

However, I know there are layers in the these files because ArcGIS Explorer
Desktop shows them just fine, but calls them "datasets."  The datasets,
however, are not quite the same as the layers listed by "ogrinfo" (in the
cases where ogrinfo shows something useful) so I'm wondering if I am
confused about the nomenclature or something.

Does anyone have any suggestions?  I feel like I must be missing something
obvious. Thanks very much for any ideas,

carl
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130730/cb71a6e9/attachment.html>

From even.rouault at mines-paris.org  Tue Jul 30 15:26:58 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 31 Jul 2013 00:26:58 +0200
Subject: [gdal-dev] Using the OGR library with FileGDB driver
In-Reply-To: <CAE=8kmkG2mparihuMW1UREqYrtx+ZH2cyeZM7SHGLFY5ipUv6g@mail.gmail.com>
References: <CAE=8kmkG2mparihuMW1UREqYrtx+ZH2cyeZM7SHGLFY5ipUv6g@mail.gmail.com>
Message-ID: <201307310026.59206.even.rouault@mines-paris.org>

Le mercredi 31 juillet 2013 00:07:08, Carl Godkin a ?crit :
> Hi,
> 
> I'm trying for the first time to use the OGR library to read ESRI FileGDB
> (".gdb") databases and I think I must be doing something wrong.
> 
> I built GDAL 1.10.0 with VS2010 and (among other additions) the FileGDB_API
> 1.3 for VS2010 all on Win64.  Everything built cleanly but the OGR library
> seems to be unable find layers in some .gdb data sets.
> 
> To take my own code out of the equation, I tried to list the layers in
> various .gdb files from around the web using the version of "ogrinfo" built
> along with the library.
> 
> All of example .gdb projects from the samples/data directory in the ESRI
> FileGDB_API distribution work just fine as does some data from other
> sources.
> 
> However, I find that a lot of .gdb data sets that I find on the web act as
> if they have no layers.  (These are apparently up to date sites too, not
> very old sites.)
> 
> In lots of cases, ogrinfo says just this:
> >ogrinfo -al WA_wetlands.gdb
> 
> INFO: Open of `WA_wetlands.gdb'
>       using driver `FileGDB' successful.
> 
> However, I know there are layers in the these files because ArcGIS Explorer
> Desktop shows them just fine, but calls them "datasets."  The datasets,
> however, are not quite the same as the layers listed by "ogrinfo" (in the
> cases where ogrinfo shows something useful) so I'm wondering if I am
> confused about the nomenclature or something.
> 
> Does anyone have any suggestions?  I feel like I must be missing something
> obvious. Thanks very much for any ideas,

Carl,

The driver is supposed to have some support for reading layers in "datasets", 
but you are perhaps running into a bug, or a limitation of the FileGDB SDK 
itself. Perhaps you could create a GDAL Trac ticket and attach one of those 
.gdb for investigation.

Best regards,

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From cgodkin at gmail.com  Tue Jul 30 18:50:56 2013
From: cgodkin at gmail.com (Carl Godkin)
Date: Tue, 30 Jul 2013 18:50:56 -0700
Subject: [gdal-dev] Using the OGR library with FileGDB driver
In-Reply-To: <201307310026.59206.even.rouault@mines-paris.org>
References: <CAE=8kmkG2mparihuMW1UREqYrtx+ZH2cyeZM7SHGLFY5ipUv6g@mail.gmail.com>
	<201307310026.59206.even.rouault@mines-paris.org>
Message-ID: <CAE=8km=BaXHET4LTrZvPJEaFZ03y2zj6WKb-ZMqvHxFCJZxvwA@mail.gmail.com>

Thanks, Even.  You give me hope that I wasn't barking up the completely
wrong tree.  I will attempt to debug a little on my own and post what I
find (if anything).

And I can certainly open a Trac ticket if I find something I think is
working incorrectly.  Thanks!

carl



On Tue, Jul 30, 2013 at 3:26 PM, Even Rouault
<even.rouault at mines-paris.org>wrote:

> Le mercredi 31 juillet 2013 00:07:08, Carl Godkin a ?crit :
> > Hi,
> >
> > I'm trying for the first time to use the OGR library to read ESRI FileGDB
> > (".gdb") databases and I think I must be doing something wrong.
> >
> > I built GDAL 1.10.0 with VS2010 and (among other additions) the
> FileGDB_API
> > 1.3 for VS2010 all on Win64.  Everything built cleanly but the OGR
> library
> > seems to be unable find layers in some .gdb data sets.
> >
> > To take my own code out of the equation, I tried to list the layers in
> > various .gdb files from around the web using the version of "ogrinfo"
> built
> > along with the library.
> >
> > All of example .gdb projects from the samples/data directory in the ESRI
> > FileGDB_API distribution work just fine as does some data from other
> > sources.
> >
> > However, I find that a lot of .gdb data sets that I find on the web act
> as
> > if they have no layers.  (These are apparently up to date sites too, not
> > very old sites.)
> >
> > In lots of cases, ogrinfo says just this:
> > >ogrinfo -al WA_wetlands.gdb
> >
> > INFO: Open of `WA_wetlands.gdb'
> >       using driver `FileGDB' successful.
> >
> > However, I know there are layers in the these files because ArcGIS
> Explorer
> > Desktop shows them just fine, but calls them "datasets."  The datasets,
> > however, are not quite the same as the layers listed by "ogrinfo" (in the
> > cases where ogrinfo shows something useful) so I'm wondering if I am
> > confused about the nomenclature or something.
> >
> > Does anyone have any suggestions?  I feel like I must be missing
> something
> > obvious. Thanks very much for any ideas,
>
> Carl,
>
> The driver is supposed to have some support for reading layers in
> "datasets",
> but you are perhaps running into a bug, or a limitation of the FileGDB SDK
> itself. Perhaps you could create a GDAL Trac ticket and attach one of those
> .gdb for investigation.
>
> Best regards,
>
> Even
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130730/2387bfc1/attachment.html>

From chenxian at walkinfo.com.cn  Wed Jul 31 01:42:28 2013
From: chenxian at walkinfo.com.cn (Xian Chen)
Date: Wed, 31 Jul 2013 01:42:28 -0700 (PDT)
Subject: [gdal-dev]  Reading error with dwg and dxf files
Message-ID: <1375260148835-5069826.post@n6.nabble.com>

Hi all,

I encountered an error when reading the attached dwg file using OGR. The
last part is supposed to be a clockwise big circle arc, but is translated
into a counterclockwise circle arc.

I then converted the file into dxf and still have the error. Can anyone
please help me out?


Best regards,
Xian
Curvelines.dwg
<http://osgeo-org.1560.x6.nabble.com/file/n5069826/Curvelines.dwg>  



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Reading-error-with-dwg-and-dxf-files-tp5069826.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From nik at nikosalexandris.net  Wed Jul 31 01:55:27 2013
From: nik at nikosalexandris.net (Nikos Alexandris)
Date: Wed, 31 Jul 2013 11:55:27 +0300
Subject: [gdal-dev] Working with NTF files (2)
In-Reply-To: <1694187.sUFg9XEByB@resilience>
References: <1694187.sUFg9XEByB@resilience>
Message-ID: <2702311.4cP5RWeSIR@vertikal>

Yet another NITF related "problem". An ntf file contains (no SUBDATASETS)

gdalinfo -nogcp -nomd -mm M1BS.ntf

,--%<---
Band 1 Block=1024x1024 Type=UInt16, ColorInterp=Blue
    Computed Min/Max=183.000,2047.000
  Overviews: 3438x3448, 1719x1724, 859x862, 429x431, 214x215
  Overviews: arbitrary
Band 2 Block=1024x1024 Type=UInt16, ColorInterp=Green
    Computed Min/Max=252.000,2047.000
  Overviews: 3438x3448, 1719x1724, 859x862, 429x431, 214x215
  Overviews: arbitrary
Band 3 Block=1024x1024 Type=UInt16, ColorInterp=Red
    Computed Min/Max=86.000,2047.000
  Overviews: 3438x3448, 1719x1724, 859x862, 429x431, 214x215
  Overviews: arbitrary
Band 4 Block=1024x1024 Type=UInt16, ColorInterp=Alpha
    Computed Min/Max=50.000,2047.000
  Overviews: 3438x3448, 1719x1724, 859x862, 429x431, 214x215
  Overviews: arbitrary
`--->%--


Attempting to warp the data with the -rpc switch and convert to GeoTIFF, 
begins with

"Using band 4 of source image as alpha."


This results in an "empty" NIR band  in the GeoTIFF file.

,--%<---
Band 1 Block=6728x1 Type=UInt16, ColorInterp=Gray
    Computed Min/Max=0.000,2047.000
Band 2 Block=6728x1 Type=UInt16, ColorInterp=Undefined
    Computed Min/Max=0.000,2047.000
Band 3 Block=6728x1 Type=UInt16, ColorInterp=Undefined
    Computed Min/Max=0.000,2047.000
Band 4 Block=6728x1 Type=UInt16, ColorInterp=Undefined
    Computed Min/Max=0.000,0.000
`--->%--


No success using '-co "ALPHA=NO"'.  Same "problem" when using gdal_translate 
on the whole ntf file. However, instructing 

gdal_translate -b 4 M1BS.ntf b4.tif


gives

gdalinfo -nogcp -nomd -mm b4.tif

,--%<---
Band 1 Block=6876x1 Type=UInt16, ColorInterp=Gray
    Computed Min/Max=50.000,2047.000
`--->%--


But, this is not "fine". How is this to be done correctly, RPC-based warping 
and conversion in one go?

Thanks, Nikos

From nik at nikosalexandris.net  Wed Jul 31 05:08:52 2013
From: nik at nikosalexandris.net (Nikos Alexandris)
Date: Wed, 31 Jul 2013 15:08:52 +0300
Subject: [gdal-dev] Working with NTF files (2)
In-Reply-To: <2702311.4cP5RWeSIR@vertikal>
References: <1694187.sUFg9XEByB@resilience> <2702311.4cP5RWeSIR@vertikal>
Message-ID: <1709900.CVaYo96VTq@vertikal>

On Wednesday 31 of July 2013 11:55:27 Nikos Alexandris wrote:
> Yet another NITF related "problem". An ntf file contains (no SUBDATASETS)
> 
> gdalinfo -nogcp -nomd -mm M1BS.ntf
> 
> ,--%<---
> Band 1 Block=1024x1024 Type=UInt16, ColorInterp=Blue
>     Computed Min/Max=183.000,2047.000
>   Overviews: 3438x3448, 1719x1724, 859x862, 429x431, 214x215
>   Overviews: arbitrary
> Band 2 Block=1024x1024 Type=UInt16, ColorInterp=Green
>     Computed Min/Max=252.000,2047.000
>   Overviews: 3438x3448, 1719x1724, 859x862, 429x431, 214x215
>   Overviews: arbitrary
> Band 3 Block=1024x1024 Type=UInt16, ColorInterp=Red
>     Computed Min/Max=86.000,2047.000
>   Overviews: 3438x3448, 1719x1724, 859x862, 429x431, 214x215
>   Overviews: arbitrary
> Band 4 Block=1024x1024 Type=UInt16, ColorInterp=Alpha
>     Computed Min/Max=50.000,2047.000
>   Overviews: 3438x3448, 1719x1724, 859x862, 429x431, 214x215
>   Overviews: arbitrary
> `--->%--
> 
> 
> Attempting to warp the data with the -rpc switch and convert to GeoTIFF,
> begins with
> 
> "Using band 4 of source image as alpha."
> 
> 
> This results in an "empty" NIR band  in the GeoTIFF file.
> 
> ,--%<---
> Band 1 Block=6728x1 Type=UInt16, ColorInterp=Gray
>     Computed Min/Max=0.000,2047.000
> Band 2 Block=6728x1 Type=UInt16, ColorInterp=Undefined
>     Computed Min/Max=0.000,2047.000
> Band 3 Block=6728x1 Type=UInt16, ColorInterp=Undefined
>     Computed Min/Max=0.000,2047.000
> Band 4 Block=6728x1 Type=UInt16, ColorInterp=Undefined
>     Computed Min/Max=0.000,0.000
> `--->%--
> 
> 
> No success using '-co "ALPHA=NO"'.  Same "problem" when using gdal_translate
> on the whole ntf file. However, instructing
> 
> gdal_translate -b 4 M1BS.ntf b4.tif
> 
> 
> gives
> 
> gdalinfo -nogcp -nomd -mm b4.tif
> 
> ,--%<---
> Band 1 Block=6876x1 Type=UInt16, ColorInterp=Gray
>     Computed Min/Max=50.000,2047.000
> `--->%--
> 
> 
> But, this is not "fine". How is this to be done correctly, RPC-based warping
> and conversion in one go?

Related thread/solution:

http://lists.osgeo.org/pipermail/gdal-dev/2012-December/034984.html

Translating to a VRT, band by band -- is it the only solution?

Nikos

From nik at nikosalexandris.net  Wed Jul 31 05:24:51 2013
From: nik at nikosalexandris.net (Nikos Alexandris)
Date: Wed, 31 Jul 2013 15:24:51 +0300
Subject: [gdal-dev] Working with NTF files
In-Reply-To: <1375153949188-5069520.post@n6.nabble.com>
References: <1694187.sUFg9XEByB@resilience>
	<1375153949188-5069520.post@n6.nabble.com>
Message-ID: <4208351.NlbNZ94LOh@resilience>

lpinner wrote:
> A workaround to your 2nd question is to set the GDAL_PAM_PROXY_DIR
> environment variable, either permanently or on the commandline before you
> call gdalinfo.
> 
> set GDAL_PAM_PROXY_DIR=%TEMP%
> gdalinfo -stats some.ntf

Thank you Luke.


1st, that would be

,--%<---
# set variable
export GDAL_PAM_PROXY_DIR=%TEMP%

# confirm
echo $GDAL_PAM_PROXY_DIR

%TEMP%
`--->%--

in the bash-ystems I've used (now working in Funtoo).


2nd, it does not work as expected, see:

,--%<---
gdalinfo -nogcp -nomd M1BS.ntf

Driver: NITF/National Imagery Transmission Format
Files: M1BS.ntf
Size is 6876, 6897
Coordinate System is `'
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0, 6897.0)
Upper Right ( 6876.0,    0.0)
Lower Right ( 6876.0, 6897.0)
Center      ( 3438.0, 3448.5)
Band 1 Block=1024x1024 Type=UInt16, ColorInterp=Blue
  Overviews: 3438x3448, 1719x1724, 859x862, 429x431, 214x215
  Overviews: arbitrary
Band 2 Block=1024x1024 Type=UInt16, ColorInterp=Green
  Overviews: 3438x3448, 1719x1724, 859x862, 429x431, 214x215
  Overviews: arbitrary
Band 3 Block=1024x1024 Type=UInt16, ColorInterp=Red
  Overviews: 3438x3448, 1719x1724, 859x862, 429x431, 214x215
  Overviews: arbitrary
Band 4 Block=1024x1024 Type=UInt16, ColorInterp=Alpha
  Overviews: 3438x3448, 1719x1724, 859x862, 429x431, 214x215
  Overviews: arbitrary
Warning 1: GDALPamProxyDB::SaveDB() - Failed to lock %TEMP%/gdal_pam_proxy.dat 
file, proceeding anyways.
ERROR 1: Failed to save %TEMP%/gdal_pam_proxy.dat Pam Proxy DB.
No such file or directory
Warning 1: Unable to save auxilary information in 
%TEMP%/000000__vsisubfile_3469_M1BS.ntf.aux.xml.
Warning 1: Unable to save auxilary information in 
%TEMP%/000000__vsisubfile_3469_M1BS.ntf.aux.xml.
Warning 1: Unable to save auxilary information in 
%TEMP%/000000__vsisubfile_3469_M1BS.ntf.aux.xml.
Warning 1: Unable to save auxilary information in 
%TEMP%/000000__vsisubfile_3469_M1BS.ntf.aux.xml.
Warning 1: Unable to save auxilary information in 
%TEMP%/000000__vsisubfile_3469_M1BS.ntf.aux.xml.
`--->%--

Best, Nikos
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130731/00f669dd/attachment-0001.html>

From howard at hobu.co  Wed Jul 31 09:18:16 2013
From: howard at hobu.co (Howard Butler)
Date: Wed, 31 Jul 2013 11:18:16 -0500
Subject: [gdal-dev] Motion: Adopt RFC 41 : Support for multiple geometry
 fields in OGR
In-Reply-To: <CA+YzLBdD5SKS1USX4qjPkHLUEJv1FxpaxoF3J1Au7wDibEc85w@mail.gmail.com>
References: <201307291315.01179.even.rouault@mines-paris.org>
	<CA+YzLBdD5SKS1USX4qjPkHLUEJv1FxpaxoF3J1Au7wDibEc85w@mail.gmail.com>
Message-ID: <CAKyBbG51dc_5qtsf5WyLKCuN+r=R1-n3NRdXK9b+O=Wv+7RD1g@mail.gmail.com>

+1 Howard


On Mon, Jul 29, 2013 at 10:49 AM, Frank Warmerdam <warmerdam at pobox.com>wrote:

> +1 Frank
>  On Jul 29, 2013 4:14 AM, "Even Rouault" <even.rouault at mines-paris.org>
> wrote:
>
>> Hi,
>>
>> Motion: I move to adopt RFC 41 : Support for multiple geometry fields in
>> OGR
>>
>>     http://trac.osgeo.org/gdal/wiki/rfc41_multiple_geometry_fields
>>
>> I've made a few changes in the last few days. See the history :
>>
>> http://trac.osgeo.org/gdal/wiki/rfc41_multiple_geometry_fields?action=history
>>
>> Starting with my +1
>>
>> Best regards,
>>
>> Even
>>
>> --
>> Geospatial professional services
>> http://even.rouault.free.fr/services.html
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130731/c56c4835/attachment.html>

From lhomme.xavier at gmail.com  Wed Jul 31 09:24:50 2013
From: lhomme.xavier at gmail.com (xavier lhomme)
Date: Wed, 31 Jul 2013 18:24:50 +0200
Subject: [gdal-dev] Using the OGR library with FileGDB driver
In-Reply-To: <CAE=8km=BaXHET4LTrZvPJEaFZ03y2zj6WKb-ZMqvHxFCJZxvwA@mail.gmail.com>
References: <CAE=8kmkG2mparihuMW1UREqYrtx+ZH2cyeZM7SHGLFY5ipUv6g@mail.gmail.com>
	<201307310026.59206.even.rouault@mines-paris.org>
	<CAE=8km=BaXHET4LTrZvPJEaFZ03y2zj6WKb-ZMqvHxFCJZxvwA@mail.gmail.com>
Message-ID: <CACqzBMyRHY67azY56fD5VbB2h+jxg9jpOAC6VMe2JmeJkNkcqA@mail.gmail.com>

Raster Dataset and Mosaic Dataset are not supported  :
 See :
http://proceedings.esri.com/library/userconf/devsummit13/papers/devsummit-170.pdf

Best Regards



2013/7/31 Carl Godkin <cgodkin at gmail.com>

>
> Thanks, Even.  You give me hope that I wasn't barking up the completely
> wrong tree.  I will attempt to debug a little on my own and post what I
> find (if anything).
>
> And I can certainly open a Trac ticket if I find something I think is
> working incorrectly.  Thanks!
>
> carl
>
>
>
> On Tue, Jul 30, 2013 at 3:26 PM, Even Rouault <
> even.rouault at mines-paris.org> wrote:
>
>> Le mercredi 31 juillet 2013 00:07:08, Carl Godkin a ?crit :
>> > Hi,
>> >
>> > I'm trying for the first time to use the OGR library to read ESRI
>> FileGDB
>> > (".gdb") databases and I think I must be doing something wrong.
>> >
>> > I built GDAL 1.10.0 with VS2010 and (among other additions) the
>> FileGDB_API
>> > 1.3 for VS2010 all on Win64.  Everything built cleanly but the OGR
>> library
>> > seems to be unable find layers in some .gdb data sets.
>> >
>> > To take my own code out of the equation, I tried to list the layers in
>> > various .gdb files from around the web using the version of "ogrinfo"
>> built
>> > along with the library.
>> >
>> > All of example .gdb projects from the samples/data directory in the ESRI
>> > FileGDB_API distribution work just fine as does some data from other
>> > sources.
>> >
>> > However, I find that a lot of .gdb data sets that I find on the web act
>> as
>> > if they have no layers.  (These are apparently up to date sites too, not
>> > very old sites.)
>> >
>> > In lots of cases, ogrinfo says just this:
>> > >ogrinfo -al WA_wetlands.gdb
>> >
>> > INFO: Open of `WA_wetlands.gdb'
>> >       using driver `FileGDB' successful.
>> >
>> > However, I know there are layers in the these files because ArcGIS
>> Explorer
>> > Desktop shows them just fine, but calls them "datasets."  The datasets,
>> > however, are not quite the same as the layers listed by "ogrinfo" (in
>> the
>> > cases where ogrinfo shows something useful) so I'm wondering if I am
>> > confused about the nomenclature or something.
>> >
>> > Does anyone have any suggestions?  I feel like I must be missing
>> something
>> > obvious. Thanks very much for any ideas,
>>
>> Carl,
>>
>> The driver is supposed to have some support for reading layers in
>> "datasets",
>> but you are perhaps running into a bug, or a limitation of the FileGDB SDK
>> itself. Perhaps you could create a GDAL Trac ticket and attach one of
>> those
>> .gdb for investigation.
>>
>> Best regards,
>>
>> Even
>>
>> --
>> Geospatial professional services
>> http://even.rouault.free.fr/services.html
>>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130731/da29df54/attachment.html>

From even.rouault at mines-paris.org  Wed Jul 31 12:31:04 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 31 Jul 2013 21:31:04 +0200
Subject: [gdal-dev] Reading error with dwg and dxf files
In-Reply-To: <1375260148835-5069826.post@n6.nabble.com>
References: <1375260148835-5069826.post@n6.nabble.com>
Message-ID: <1375299064.51f965f8df177@imp.free.fr>

Selon Xian Chen <chenxian at walkinfo.com.cn>:

Hi Xian,

If you want to debug that, you can have a look at the revelant code in
ogr/ogrsf_frmts/dxf/ogrdxf_hatch.cpp around line 250 and below, and in
ogr/ogrsf_frmts/dwg/ogrdwg_hatch.cpp around line 190 and below.

Best regards,

Even

> Hi all,
>
> I encountered an error when reading the attached dwg file using OGR. The
> last part is supposed to be a clockwise big circle arc, but is translated
> into a counterclockwise circle arc.
>
> I then converted the file into dxf and still have the error. Can anyone
> please help me out?
>
>
> Best regards,
> Xian
> Curvelines.dwg
> <http://osgeo-org.1560.x6.nabble.com/file/n5069826/Curvelines.dwg>
>
>
>
> --
> View this message in context:
>
http://osgeo-org.1560.x6.nabble.com/gdal-dev-Reading-error-with-dwg-and-dxf-files-tp5069826.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



From cgodkin at gmail.com  Wed Jul 31 14:27:02 2013
From: cgodkin at gmail.com (Carl Godkin)
Date: Wed, 31 Jul 2013 14:27:02 -0700
Subject: [gdal-dev] Using the OGR library with FileGDB driver
In-Reply-To: <CACqzBMyRHY67azY56fD5VbB2h+jxg9jpOAC6VMe2JmeJkNkcqA@mail.gmail.com>
References: <CAE=8kmkG2mparihuMW1UREqYrtx+ZH2cyeZM7SHGLFY5ipUv6g@mail.gmail.com>
	<201307310026.59206.even.rouault@mines-paris.org>
	<CAE=8km=BaXHET4LTrZvPJEaFZ03y2zj6WKb-ZMqvHxFCJZxvwA@mail.gmail.com>
	<CACqzBMyRHY67azY56fD5VbB2h+jxg9jpOAC6VMe2JmeJkNkcqA@mail.gmail.com>
Message-ID: <CAE=8km=P2LVMDMVQEkqkMKTr7rGBWyNDk6K+MoGXdnvc1gLAWA@mail.gmail.com>

On Wed, Jul 31, 2013 at 9:24 AM, xavier lhomme <lhomme.xavier at gmail.com>
 wrote:

> Raster Dataset and Mosaic Dataset are not supported  :
>  See :
> http://proceedings.esri.com/library/userconf/devsummit13/papers/devsummit-170.pdf
>
>

Thanks for the tip, Xavier.  The .gdb files I've got have more than just
rasters and mosaics, and the presence of these types doesn't prevent the
FileGDB driver from working on the rest of the database (fortunately).
 Also, I have some others that don't have rasters or mosaics and still
don't load in.  However, at least part of the problem is due to unsupported
features like you suggest.

In trying to debug this, I remembered to set CPL_DEBUG=ON to watch the
messages out of ogrinfo and I'm seeing that my various datasets downloaded
from the web.

I'm seeing two kinds:

1. "Invalid function arguments"
FGDB: Error opening \CONUS_public_datasets\CONUS_Public_Metadata. Skipping
it (Invalid function arguments.)
FGDB: Error opening \CONUS_public_datasets\CONUS_Public_Historic_Map_Info.
Skipping it (Invalid function arguments.)
FGDB: Error opening \CONUS_wetlands\CONUS_wet_poly. Skipping it (Invalid
function arguments.)

2. "FileGDB compression is not installed"
FGDB: Error opening \King_SF1_00006mod. Skipping it (FileGDB compression is
notinstalled.)
FGDB: Error opening \King_SF1_00005. Skipping it (FileGDB compression is
not installed.)
FGDB: Error opening \King_SF1_00002. Skipping it (FileGDB compression is
not installed.)


I have read somewhere online that compression is not supported by the
FileGDB_API toolkit so there's apparently nothing more I can do about that.

The other is more puzzling and I have actually just duplicated it problem
by editing one of the sample programs distributed with the FileGDB_API
called Querying.  When a .gdb contains "Feature Datasets" containing
"Feature Classes," they sometimes fail to open with this "Invalid function
arguments" error, the meaning of which I don't understand.

On the other hand, I have another .gdb with this same layout that works
fine.  I will post one of the non-working examples as Even suggested.

Again, if anyone has any bright ideas, I'd be very grateful.  Thanks,

carl
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130731/ec05fcda/attachment.html>

From even.rouault at mines-paris.org  Wed Jul 31 14:35:21 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 31 Jul 2013 23:35:21 +0200
Subject: [gdal-dev] Using the OGR library with FileGDB driver
In-Reply-To: <CAE=8km=P2LVMDMVQEkqkMKTr7rGBWyNDk6K+MoGXdnvc1gLAWA@mail.gmail.com>
References: <CAE=8kmkG2mparihuMW1UREqYrtx+ZH2cyeZM7SHGLFY5ipUv6g@mail.gmail.com>
	<201307310026.59206.even.rouault@mines-paris.org>
	<CAE=8km=BaXHET4LTrZvPJEaFZ03y2zj6WKb-ZMqvHxFCJZxvwA@mail.gmail.com>
	<CACqzBMyRHY67azY56fD5VbB2h+jxg9jpOAC6VMe2JmeJkNkcqA@mail.gmail.com>
	<CAE=8km=P2LVMDMVQEkqkMKTr7rGBWyNDk6K+MoGXdnvc1gLAWA@mail.gmail.com>
Message-ID: <1375306521.51f9831986599@imp.free.fr>

Selon Carl Godkin <cgodkin at gmail.com>:

> On Wed, Jul 31, 2013 at 9:24 AM, xavier lhomme <lhomme.xavier at gmail.com>
>  wrote:
>
> > Raster Dataset and Mosaic Dataset are not supported  :
> >  See :
> >
>
http://proceedings.esri.com/library/userconf/devsummit13/papers/devsummit-170.pdf
> >
> >
>
> Thanks for the tip, Xavier.  The .gdb files I've got have more than just
> rasters and mosaics, and the presence of these types doesn't prevent the
> FileGDB driver from working on the rest of the database (fortunately).
>  Also, I have some others that don't have rasters or mosaics and still
> don't load in.  However, at least part of the problem is due to unsupported
> features like you suggest.
>
> In trying to debug this, I remembered to set CPL_DEBUG=ON to watch the
> messages out of ogrinfo and I'm seeing that my various datasets downloaded
> from the web.
>
> I'm seeing two kinds:
>
> 1. "Invalid function arguments"
> FGDB: Error opening \CONUS_public_datasets\CONUS_Public_Metadata. Skipping
> it (Invalid function arguments.)
> FGDB: Error opening \CONUS_public_datasets\CONUS_Public_Historic_Map_Info.
> Skipping it (Invalid function arguments.)
> FGDB: Error opening \CONUS_wetlands\CONUS_wet_poly. Skipping it (Invalid
> function arguments.)

ok, that one is actually known. It is also a defect of the FileGDB SDK. See
http://trac.osgeo.org/gdal/ticket/4578 and
http://trac.osgeo.org/gdal/ticket/4224


>
> 2. "FileGDB compression is not installed"
> FGDB: Error opening \King_SF1_00006mod. Skipping it (FileGDB compression is
> notinstalled.)
> FGDB: Error opening \King_SF1_00005. Skipping it (FileGDB compression is
> not installed.)
> FGDB: Error opening \King_SF1_00002. Skipping it (FileGDB compression is
> not installed.)
>
>
> I have read somewhere online that compression is not supported by the
> FileGDB_API toolkit so there's apparently nothing more I can do about that.
>
> The other is more puzzling and I have actually just duplicated it problem
> by editing one of the sample programs distributed with the FileGDB_API
> called Querying.  When a .gdb contains "Feature Datasets" containing
> "Feature Classes," they sometimes fail to open with this "Invalid function
> arguments" error, the meaning of which I don't understand.
>
> On the other hand, I have another .gdb with this same layout that works
> fine.  I will post one of the non-working examples as Even suggested.
>
> Again, if anyone has any bright ideas, I'd be very grateful.  Thanks,
>
> carl
>



From cgodkin at gmail.com  Wed Jul 31 15:23:31 2013
From: cgodkin at gmail.com (Carl Godkin)
Date: Wed, 31 Jul 2013 15:23:31 -0700
Subject: [gdal-dev] Using the OGR library with FileGDB driver
In-Reply-To: <1375306521.51f9831986599@imp.free.fr>
References: <CAE=8kmkG2mparihuMW1UREqYrtx+ZH2cyeZM7SHGLFY5ipUv6g@mail.gmail.com>
	<201307310026.59206.even.rouault@mines-paris.org>
	<CAE=8km=BaXHET4LTrZvPJEaFZ03y2zj6WKb-ZMqvHxFCJZxvwA@mail.gmail.com>
	<CACqzBMyRHY67azY56fD5VbB2h+jxg9jpOAC6VMe2JmeJkNkcqA@mail.gmail.com>
	<CAE=8km=P2LVMDMVQEkqkMKTr7rGBWyNDk6K+MoGXdnvc1gLAWA@mail.gmail.com>
	<1375306521.51f9831986599@imp.free.fr>
Message-ID: <CAE=8kmnQYnGi0d76k9Lm9ogOs8Cxf3qjENGLQ_z7=0mAP3w1uQ@mail.gmail.com>

On Wed, Jul 31, 2013 at 2:35 PM, Even Rouault <even.rouault at mines-paris.org>
 wrote:

>
>
> ok, that one is actually known. It is also a defect of the FileGDB SDK. See
> http://trac.osgeo.org/gdal/ticket/4578 and
> http://trac.osgeo.org/gdal/ticket/4224
>
>
Thanks, Even.  I should have looked through the Trac tickets myself before
asking.

I guess that the SDK's limitations are just going to make .gdb files hard
to use if there is compression or a custom coordinate system.

Too bad that the SDK's error message does not mention the custom SRS
limitation although I found it mentioned in the PPT that Xavier pointed me
at earlier (
http://proceedings.esri.com/library/userconf/devsummit13/papers/devsummit-170.pdf
 ).

I wonder if there is a way to determine if a .gdb is using a custom
coordinate system so we can make a sensible error message.

I find that in ArcGIS Explorer, selecting the "Source Data" on the
"Properties" dialog lists the Coordinate System by name followed by a
number in parentheses.  From the datasets I've tried, if the number in
parentheses is zero, then it's apparently custom.  Otherwise it the ESRI
coordinate system number.  I don't suppose anyone knows of a way to get at
this information from the FileGDB API, do they?  I will investigate further
if no one replies.

Thanks for the help,

carl
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130731/00575bb8/attachment.html>

From nik at nikosalexandris.net  Wed Jul 31 16:46:32 2013
From: nik at nikosalexandris.net (Nikos Alexandris)
Date: Thu, 01 Aug 2013 02:46:32 +0300
Subject: [gdal-dev] Working with NTF files [SEC=UNCLASSIFIED]
In-Reply-To: <08A7084C05C8C94A9EA11656A36D3EE188BD3A53@XVAC01EXMX01.internal.govt>
References: <1694187.sUFg9XEByB@resilience> <4208351.NlbNZ94LOh@resilience>
	<08A7084C05C8C94A9EA11656A36D3EE188BD3A53@XVAC01EXMX01.internal.govt>
Message-ID: <1732037.vAuSxhLhfM@resilience>

Luke:

%TEMP% is the Windows environment variable pointing to the temp directory.  
For Unix/linux:
 
,--%<---
# set variable
export GDAL_PAM_PROXY_DIR=/tmp

# confirm
echo $GDAL_PAM_PROXY_DIR

/tmp
`--->%--
 


So much to my bash knowledge... :D

It works fine, thank you very much!

Nikos

[rest deleted]

From Luke.Pinner at environment.gov.au  Wed Jul 31 16:29:26 2013
From: Luke.Pinner at environment.gov.au (Pinner, Luke)
Date: Wed, 31 Jul 2013 23:29:26 +0000
Subject: [gdal-dev] Working with NTF files [SEC=UNCLASSIFIED]
In-Reply-To: <4208351.NlbNZ94LOh@resilience>
References: <1694187.sUFg9XEByB@resilience>
	<1375153949188-5069520.post@n6.nabble.com>
	<4208351.NlbNZ94LOh@resilience>
Message-ID: <08A7084C05C8C94A9EA11656A36D3EE188BD3A53@XVAC01EXMX01.internal.govt>

%TEMP% is the Windows environment variable pointing to the temp directory.  For Unix/linux:


,--%<---

# set variable

export GDAL_PAM_PROXY_DIR=/tmp



# confirm

echo $GDAL_PAM_PROXY_DIR



/tmp

`--->%--

Luke

From: Nikos Alexandris [mailto:nik at nikosalexandris.net]
Sent: Wednesday, 31 July 2013 10:25 PM
To: gdal-dev at lists.osgeo.org
Cc: Pinner, Luke
Subject: Re: [gdal-dev] Working with NTF files


lpinner wrote:

> A workaround to your 2nd question is to set the GDAL_PAM_PROXY_DIR

> environment variable, either permanently or on the commandline before you

> call gdalinfo.

>

> set GDAL_PAM_PROXY_DIR=%TEMP%

> gdalinfo -stats some.ntf



Thank you Luke.





1st, that would be



,--%<---

# set variable

export GDAL_PAM_PROXY_DIR=%TEMP%



# confirm

echo $GDAL_PAM_PROXY_DIR



%TEMP%

`--->%--



in the bash-ystems I've used (now working in Funtoo).





2nd, it does not work as expected, see:



,--%<---

gdalinfo -nogcp -nomd M1BS.ntf



Driver: NITF/National Imagery Transmission Format

Files: M1BS.ntf

Size is 6876, 6897

Coordinate System is `'

Corner Coordinates:

Upper Left ( 0.0, 0.0)

Lower Left ( 0.0, 6897.0)

Upper Right ( 6876.0, 0.0)

Lower Right ( 6876.0, 6897.0)

Center ( 3438.0, 3448.5)

Band 1 Block=1024x1024 Type=UInt16, ColorInterp=Blue

Overviews: 3438x3448, 1719x1724, 859x862, 429x431, 214x215

Overviews: arbitrary

Band 2 Block=1024x1024 Type=UInt16, ColorInterp=Green

Overviews: 3438x3448, 1719x1724, 859x862, 429x431, 214x215

Overviews: arbitrary

Band 3 Block=1024x1024 Type=UInt16, ColorInterp=Red

Overviews: 3438x3448, 1719x1724, 859x862, 429x431, 214x215

Overviews: arbitrary

Band 4 Block=1024x1024 Type=UInt16, ColorInterp=Alpha

Overviews: 3438x3448, 1719x1724, 859x862, 429x431, 214x215

Overviews: arbitrary

Warning 1: GDALPamProxyDB::SaveDB() - Failed to lock %TEMP%/gdal_pam_proxy.dat file, proceeding anyways.

ERROR 1: Failed to save %TEMP%/gdal_pam_proxy.dat Pam Proxy DB.

No such file or directory

Warning 1: Unable to save auxilary information in %TEMP%/000000__vsisubfile_3469_M1BS.ntf.aux.xml.

Warning 1: Unable to save auxilary information in %TEMP%/000000__vsisubfile_3469_M1BS.ntf.aux.xml.

Warning 1: Unable to save auxilary information in %TEMP%/000000__vsisubfile_3469_M1BS.ntf.aux.xml.

Warning 1: Unable to save auxilary information in %TEMP%/000000__vsisubfile_3469_M1BS.ntf.aux.xml.

Warning 1: Unable to save auxilary information in %TEMP%/000000__vsisubfile_3469_M1BS.ntf.aux.xml.

`--->%--



Best, Nikos

If you have received this transmission in error please notify us immediately by return e-mail and delete all copies. If this e-mail or any attachments have been sent to you in error, that error does not constitute waiver of any confidentiality, privilege or copyright in respect of information in the e-mail or attachments.

Please consider the environment before printing this email.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130731/bc0f4f70/attachment-0001.html>

