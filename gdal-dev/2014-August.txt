From landa.martin at gmail.com  Fri Aug  1 04:31:56 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Fri, 1 Aug 2014 13:31:56 +0200
Subject: [gdal-dev] python scripts - create layer problem
In-Reply-To: <1405071194.53bfaf5a4c695@imp.free.fr>
References: <1404984774.53be5dc685512@imp.free.fr>
	<CA+Ei1OczcStLV22YSFop6Et=VR5N0FzqJoTzVE9Gh4CV_zXRNw@mail.gmail.com>
	<CA+Ei1OfEW8CowvDKXWL50u7LLYunrU0Y9B1=7_WMbrsj_-CfNQ@mail.gmail.com>
	<1405071194.53bfaf5a4c695@imp.free.fr>
Message-ID: <CA+Ei1Ocs58wrbpjNBiYDjCF7R0EgSv5RO8JA67gjihg_CXHfAg@mail.gmail.com>

Hi Even,

2014-07-11 11:33 GMT+02:00 Even Rouault <even.rouault at mines-paris.org>:

> If you see the CREATE TABLE in the debug log, and it is not created, then it is
> really weird. Perhaps check the potential surrounding BEGIN/COMMIT/ROLLBACK just
> in case. Might it not be an issue with your PostgreSQL instance ?

I tried your suggestions and then I checked again my scripts. The
problem was not in GDAL, but in my scripts. Sorry for the noise and
thanks for your help!

Martin

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From nicolas.simon at spw.wallonie.be  Fri Aug  1 07:53:55 2014
From: nicolas.simon at spw.wallonie.be (SIMON Nicolas)
Date: Fri, 1 Aug 2014 14:53:55 +0000
Subject: [gdal-dev] OCI driver: Date field creation improvement
Message-ID: <F02D54DF5576D84C86C23A39A792DC7E31656AA8@se0002v.wallonie.intra>

Hi list,
                Can someone could review and commit my patch ?
http://trac.osgeo.org/gdal/ticket/5600

Thanks

Nicolas

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140801/1ad2692a/attachment.html>

From nicolas.simon at spw.wallonie.be  Fri Aug  1 07:49:35 2014
From: nicolas.simon at spw.wallonie.be (SIMON Nicolas)
Date: Fri, 1 Aug 2014 14:49:35 +0000
Subject: [gdal-dev] OGR: memory leak in OCI driver
In-Reply-To: <BLU173-W30D9B916CB0161C18790C7904F0@phx.gbl>
References: <F02D54DF5576D84C86C23A39A792DC7E3164E534@se0002v.wallonie.intra>
	<BLU173-W30D9B916CB0161C18790C7904F0@phx.gbl>
Message-ID: <F02D54DF5576D84C86C23A39A792DC7E31656A8C@se0002v.wallonie.intra>

Hi list,

                We tested the suggestion of Ivan and it's better.
                Fortunately, my problem to create ticket was solved
The ticket is  http://trac.osgeo.org/gdal/ticket/5599 with a patch file.

Best regards

Nicolas

De : Ivan Lucena [mailto:lucena_ivan at hotmail.com]
Envoy? : mardi 6 mai 2014 17:48
? : SIMON Nicolas; gdal-dev at lists.osgeo.org
Cc : SANDRI Christophe; NGUYEN Thi Xuan Truc
Objet : RE: [gdal-dev] OGR: memory leak in OCI driver

Hi Nicolas,

I received that report a month ago:

"we have found the OGROCISession is never released, causing a large memory leak whenever a connection is closed.
As workaround, we added in OGROCISession::~OGROCISession()

    if( hEnv )
           OCIHandleFree((dvoid *) hEnv, (ub4) OCI_HTYPE_ENV);"

But they also mention some other memory leaks without an specific location on the code.

Can you try to see if that fix the problem?

Thanks,

Ivan

________________________________
From: nicolas.simon at spw.wallonie.be<mailto:nicolas.simon at spw.wallonie.be>
To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Date: Tue, 6 May 2014 15:32:09 +0000
CC: christophe.sandri at spw.wallonie.be<mailto:christophe.sandri at spw.wallonie.be>; xuan.nguyen at spw.wallonie.be<mailto:xuan.nguyen at spw.wallonie.be>
Subject: [gdal-dev] OGR: memory leak in OCI driver
Dear developers,

                I suspect that there is a memory leak in OCI driver for OGR

                My simplified test case is :

...
// point A
OGRRegisterAll();

// point B
pDS = OGRSFDriverRegistrar::Open("OCI:USER/PWD at INSTANCE:TABLE", true);
if(pDS)
     {
          OGRDataSource::DestroyDataSource(pDS);
          pDS = NULL;
     }
     else
     {
          fprintf(fOut,"Erreur Open\n");
     }
     // point C

OGRCleanupAll();
// point D

It appears that I lose memory between points B and C, and between point A and D

                B = A + 4 MB
                C = A + 20 MB ( 16 MB lost)
               D = A +19 MB ( 3 more MB lost)

Test was done with GDAL 1.9 under windows (with Oracle 11g)

Can some one have an idea to find and fix this ?

Thank you

By the way,  I received ? TICKET_CREATE privileges are required to perform this operation ? when I tried to make a ticket (UID nicsim)

Nicolas



_______________________________________________ gdal-dev mailing list gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org> http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140801/64b51a99/attachment-0001.html>

From chaitanya.ch at gmail.com  Fri Aug  1 08:54:25 2014
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Fri, 1 Aug 2014 21:24:25 +0530
Subject: [gdal-dev] styles .ofs and OGR_STBL_GetNextStyle()
In-Reply-To: <0A76B996-4E6F-40F7-82C7-F9DAD911E128@nixanz.com>
References: <0A76B996-4E6F-40F7-82C7-F9DAD911E128@nixanz.com>
Message-ID: <CAMKgpObQhYJ2DVDqcWuh==SUJrVJszE8Asay0Ryjf0j3cs8Czg@mail.gmail.com>

Nik,

This is a good idea. The doc you specified needs a correction. The
version string and style field lines are supposed to be commented out
with a #.

The OGRStyleTable class has methods to save and load style tables.
They assume neither empty lines nor comments.
There is one method to Print that saves the styletable into a file in
the .ofs format. We can implement a method that loads a styletable
from such file. Do you have any other suggestions?

I suggest you create a ticket on this at http://trac.osgeo.org/gdal/#BugTracking


On Wed, Jul 30, 2014 at 10:17 AM, Nik Sands <nixanz at nixanz.com> wrote:
> Hi Devs,
>
> I'm just planning to convert my own 'in-house' drawing styles management to using the styles management built into OGR.  The documentation at http://www.gdal.org/ogr_feature_style.html suggests that styles can be in a '.ofs' file to be automatically associated with a data source of the same name as the .ofs file.
>
> But how about if the .ofs file is a stand-alone file passed directly to OGR_STBL_LoadStyleTable()?  Eg, OGR_STBL_LoadStyleTable(table, "/path/to/styles.ofs")
>
> In this case the first two calls to 'OGR_STBL_GetNextStyle(table)' will return the 'styles':
>
> OFS-Version :  1.0
> 2014-07-30 14:38:36.392 Maps n Trax[47458:60b] StyleField :  "style"
>
> Which are of course not styles at all, but part of the .ofs specification.
>
> From this, I assume that files passed into OGR_STBL_LoadStyleTable() should in fact NOT be .ofs files, but merely plain text files with raw style strings only (and no .ofs specifications).
>
> Is this correct?
>
> Would there be any advantage on getting OGR_STBL_LoadStyleTable() to ignore the first line or two if it is an .ofs file and those two lines match the spec?
>
> Cheers,
> Nik.
>
>
> OFS-Version: 1.0
> StyleField: "style"
>
> DefaultStyle: SYMBOL(c:#000000,id:"ogr-sym-3",s:5pt); PEN(c:#000000,w:2pt); BRUSH(fc:#80808080); LABEL(c:#000000,s:14pt,t:{title})
>
> locality: LABEL(c:#000000,s:24pt,t:{title})
> town: SYMBOL(c:#800000,id:"ogr-sym-3",s:10pt); LABEL(c:#800000,s:24pt,t:{title})
> city: SYMBOL(c:#800000,id:"ogr-sym-3",s:15pt); LABEL(c:#800000,s:24pt,t:{title})
> region: PEN(c:#000000,w:2pt); BRUSH(fc:#80808080); LABEL(c:#000000,s:28pt,t:{title})
> country: PEN(c:#000000,w:2pt); BRUSH(fc:#80808080); LABEL(c:#000000,s:32pt,t:{title})
>
> vegetation_low: BRUSH(fc:#A0F0A0); LABEL(c:#004000,s:18pt,t:{title})
> vegetation_medium: BRUSH(fc:#80C080); LABEL(c:#004000,s:18pt,t:{title})
> vegetation_high: BRUSH(fc:#008000); LABEL(c:#004000,s:18pt,t:{title})
> water: SYMBOL(c:#000080,id:"ogr-sym-3",s:2pt); PEN(c:#000080,w:2pt,p:"18pt 8pt"); BRUSH(fc:#8080C0); LABEL(c:#000080,s:18pt,t:{title})
> contour: PEN(c:#808080,w:1pt); LABEL(c:#808080,s:12pt,t:{elevation})
>
> road_unsealed: PEN(c:#A08080,w:2pt,p:"10pt 6pt"); LABEL(c:#000000,s:18pt,t:{title})
> road_minor: PEN(c:#A08080,w:2pt); LABEL(c:#000000,s:18pt,t:{title})
> road_medium: PEN(c:#A00000,w:4pt); LABEL(c:#000000,s:18pt,t:{title})
> road_major: PEN(c:#A00000,w:6pt); LABEL(c:#000000,s:18pt,t:{title})
>
> route: PEN(c:#000000,w:2pt,p:"2pt 4pt"); LABEL(c:#000000,s:18pt,t:{title})
> track: PEN(c:#000000,w:2pt,p:"10pt 6pt"); LABEL(c:#000000,s:18pt,t:{title})
> rail: PEN(c:#000000,w:4pt,p:"2pt 5pt"); LABEL(c:#000000,s:18pt,t:{title})
> cable: PEN(c:#000000,w:2pt,p:"1pt 6pt"); LABEL(c:#000000,s:18pt,t:{title})
> ferry: PEN(c:#000080,w:2pt,p:"18pt 8pt"); LABEL(c:#000080,s:18pt,t:{title})
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Best regards,
Chaitanya kumar CH.

+91-9494447584
17.2416N 80.1426E

From atuncatunc at gmail.com  Fri Aug  1 09:36:28 2014
From: atuncatunc at gmail.com (tunca tunc)
Date: Fri, 1 Aug 2014 19:36:28 +0300
Subject: [gdal-dev] SetSpatialFilter
Message-ID: <CAFjrKg5oVbbxR1VoEGct86Wu0z=sMMqn5rTatoSZgRfMjuxAHw@mail.gmail.com>

Hi,

I"m totally new to GDAL, sorry if this is a obvious thing for you.

Trying to filter features in the area with following code snippet.
However
poLayer->GetNextFeature()
always returns null on my windows 8.


   OGRPolygon* polygon = new OGRPolygon();
>    OGRLinearRing* ring = new OGRLinearRing();
>    ring->addPoint(51.089028, 13.617821);
>    ring->addPoint(51.089675, 13.807336);
>    ring->addPoint(51.025585, 13.807679);
>    ring->addPoint(51.024937, 13.616105);
>    polygon->addRing(ring);
>    poLayer->SetSpatialFilter(polygon);


The full code is
http://pastebin.com/eWUeVsTG

I suspected geos dll is not loaded, but it's loaded according to following
output.
http://pastebin.com/7r1gUdQq

Best Regards

Tunca Tunc
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140801/401b755a/attachment.html>

From gusevmihs at gmail.com  Fri Aug  1 13:48:49 2014
From: gusevmihs at gmail.com (Mikhail Gusev)
Date: Sat, 2 Aug 2014 00:48:49 +0400
Subject: [gdal-dev] GSoC weekly report 11. GDAL Networking
Message-ID: <CAJB43VpSygM=88E42tO07qNu5AzHLQzEburxrrsmL2jNhzerXw@mail.gmail.com>

Hello everyone.
As at this week I've implemented a support of network's business logic (my
blog post:
http://gsoc2014gnm.blogspot.ru/2014/08/week-11-networks-business-logic.html)
I'm very close to finish implementing GNM according to my plan. All that I
need to complete in order to finish my project: 1) Several: methods of
functionality, small 'todo-s' and application commands; 2) Python tests
which I unfortunately always had no time to complete; 3) Documentation,
which I've started to write - I've already written some pages of tutorial
and architecture description.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140802/b2ba9536/attachment.html>

From smor.prg at gmail.com  Sat Aug  2 04:07:13 2014
From: smor.prg at gmail.com (Morteza Ghavami)
Date: Sat, 2 Aug 2014 15:37:13 +0430
Subject: [gdal-dev] Error in SetGeoTransform
Message-ID: <CAO1oGMW0Yg2eTR5cAWgAHqD1wJs-z_7DJenO_eV==i2dgtaqqg@mail.gmail.com>

Hello

I trying to make geotiff from float array . when I try to set geotransform
information I get this error :
"Dataset does not support the AddBand() method."

The part of my code that i used to make geotiff listed below (the part of
code that error occurred ):


poDriver=GetGDALDriverManager()->GetDriverByName(pszFormat);
poDstDS = poDriver->Create( outStr.c_str(), outWidth, outHeight,
1,GDT_Float32,papszOptions );
double adfGeoTransform[6] = { static_cast<double>(west),
static_cast<double>(OUTPUT_PIXEL_METER), 0.0, static_cast<double>(north),
0.0, static_cast<double>(-OUTPUT_PIXEL_METER) };
OGRSpatialReference oSRS;
char *pszSRS_WKT = NULL;
GDALRasterBand *poBand;
rasterData=new float[outWidth*outHeight];
OGRErr err=poDstDS->SetGeoTransform(adfGeoTransform);
oSRS.importFromProj4("+proj=merc +ellps=WGS84 +datum=WGS84 +lon_0=0.0
+a=6378137.0 +b=6356752.314 +units=m");

Note : The err value is 3 .
What is wrong with this code ?
thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140802/4cdab67c/attachment.html>

From landa.martin at gmail.com  Sat Aug  2 07:15:31 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Sat, 2 Aug 2014 16:15:31 +0200
Subject: [gdal-dev] feature.clone() -> same featuredefn
Message-ID: <CA+Ei1Odc0VtXz-hj=zEd+KNoa+O9C=qKCLdwZTJud89xA1kTpQ@mail.gmail.com>

Hi,

OGRFeature::Clone() duplicates feature. I found in API manual this
sentence: the newly created feature is owned by the caller, and will
have it's own reference to the OGRFeatureDefn.

When I try in Python:

ofeature = feature.Clone()
print feature.GetDefnRef()
print ofeature.GetDefnRef()

I am getting same reference to OGRFeatureDefn.

<osgeo.ogr.FeatureDefn; proxy of <Swig Object of type
'OGRFeatureDefnShadow *' at 0x7f86b7b84a20> >
<osgeo.ogr.FeatureDefn; proxy of <Swig Object of type
'OGRFeatureDefnShadow *' at 0x7f86b7b84a20> >

?

Thanks for clarification in advance, Martin

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From even.rouault at mines-paris.org  Sat Aug  2 10:51:36 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 2 Aug 2014 19:51:36 +0200
Subject: [gdal-dev] GDAL_DEFAULT_WMS_CACHE_PATH ignored in GDAL 1.11
In-Reply-To: <3ED562F633B1AE46BF141E903F9813074F2C9689@ap-mbx3.ingrnet.com>
References: <3ED562F633B1AE46BF141E903F9813074F2C9649@ap-mbx3.ingrnet.com>
	<3ED562F633B1AE46BF141E903F9813074F2C9689@ap-mbx3.ingrnet.com>
Message-ID: <201408021951.36314.even.rouault@mines-paris.org>

Le mardi 29 juillet 2014 04:52:52, Tomaka, Jacek a ?crit :
> Also it does not look like WMS driver cleans the temp directory when it is
> done. Is it expected? Regards.

Yes, I guess this is expected that it is persistant from one session to 
another one.

> Jacek Tomaka
> 
> From: gdal-dev-bounces at lists.osgeo.org
> [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Tomaka, Jacek Sent:
> Tuesday, 29 July 2014 10:28 AM
> To: gdal-dev at lists.osgeo.org
> Subject: [gdal-dev] GDAL_DEFAULT_WMS_CACHE_PATH ignored in GDAL 1.11
> 
> Hi,
> Looks like the patch mentioned here https://trac.osgeo.org/gdal/ticket/4540
> did not make fully make it to the repository. Lines 61-62 of
> frmts\wms\gdalwmscache.cpp should have been removed. Regards.

Good catch. I guess the patch didn't apply cleanly so I applied it manually 
and got it wrong. And as no enhancement to the autotest suite was provided 
along with the patch, this went unnoticed. Repaired, and tested, now...

Best regards,

Even

> 
> Jacek Tomaka
> Software Engineer
> T: +618 9217 3427
> E:
> jacek.tomaka at hexagongeospatial.com<mailto:jacek.tomaka at hexagongeospatial.c
> om>
> 
> Hexagon Geospatial
> c/o Intergraph Corporation Pty Ltd
> 2 Abbotsford Street, West Leederville
> Perth, WA Australia 6007
> hexagongeospatial.com

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Sat Aug  2 10:57:13 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 2 Aug 2014 19:57:13 +0200
Subject: [gdal-dev] The documentation should be corrected, I think.
In-Reply-To: <CAMorJ8EQfseEvbh1njyzyGUOyRFgJQGu=KucBxEEDKVYsjZZJg@mail.gmail.com>
References: <CAMorJ8EQfseEvbh1njyzyGUOyRFgJQGu=KucBxEEDKVYsjZZJg@mail.gmail.com>
Message-ID: <201408021957.13583.even.rouault@mines-paris.org>

Le mercredi 30 juillet 2014 05:54:48, Cleo Drakos a ?crit :
> Dear all:
> 
> The problem I was facing has been solved. I detected that the problem was
> with the band number '0'. Solution is: the band number starts from '1'.
> 
> But, the gdal documentation says that the default band number is '0'.
> http://www.gdal.org/gdal_calc.html
> 
> The documentation should be corrected, I think.

Fixed. Thanks

> 
> The default band number is '1'.
> 
> Thanks.
> 
> cleo
> 
> 
> On Wed, Jul 30, 2014 at 11:15 AM, Jeremy Palmer <JPalmer at linz.govt.nz>
> 
> wrote:
> >  Hi Cleo,
> > 
> > Just been dealing with this type of issue.
> > 
> > 
> > 
> > It?s likely that the byte datatype is overflowing.
> > 
> > 
> > 
> > Try something like:
> > 
> > 
> > 
> > --calc "(A.astype(int)-B.astype(int))/(A.astype(int)+B.astype(int))"
> > 
> > 
> > 
> > Actually you might only need to cast one of the bands from byte to int,
> > so the syntax could be:
> > 
> > 
> > 
> > --calc "(A.astype(int)-B A.astype(int)+B)"
> > 
> > 
> > 
> > Cheers
> > Jeremy
> > 
> > 
> > 
> > *From:* gdal-dev-bounces at lists.osgeo.org [mailto:
> > gdal-dev-bounces at lists.osgeo.org] *On Behalf Of *Cleo Drakos
> > *Sent:* Wednesday, 30 July 2014 2:06 p.m.
> > *To:* Vincent Schut
> > *Cc:* gdal-dev
> > *Subject:* Re: [gdal-dev] Does gdal_calc.py not calculate arithmetic with
> > in the same file?
> > 
> > 
> > 
> > Even if I converted the input file into Float 32 at first, the resulted
> > image is still totally black.
> > 
> >   cleo
> > 
> > On Tue, Jul 29, 2014 at 11:20 PM, Vincent Schut <schut at sarvision.nl>
> > wrote:
> > 
> > On 07/29/2014 04:04 PM, Cleo Drakos wrote:
> >  Thanks for your response.
> > 
> > I tried the followings:
> > 
> > 
> > 
> > gcalc = 'C:\\Users\\cleo\\Documents\\gdalpys\\gdal_calc.py'
> > 
> > ##I produced second file (b)as the copy of first(a)
> > 
> > a = 'D:\\a.tif'
> > 
> > b = 'D:\\b.tif'
> > 
> > outfile = 'D:\\result.tif'
> > 
> > expr = '(A-B)/(A+B)'
> > 
> > 
> > subprocess.call([sys.executable,gcalc,'-A',a,'--A_band','1','-B',b,'--B_b
> > and','0','--outfile',outfile,\
> > 
> >     '--calc',expr,'--type','Float32','--format','ENVI'],shell=True)
> > 
> > a,b,outfile = None, None,None
> > 
> > 
> > 
> > Unfortunately, resulted file is completely black.
> > 
> > 
> > 
> > I hope someone can help me.
> > 
> > 
> > 
> > I don't use gdal_calc myself, but I suppose the problem is the byte
> > datatype. I would try to convert the input data to float32 first (use
> > gdal_translate -ot Float32) and try again.
> > 
> > Best,
> > Vincent.
> > 
> > 
> > 
> > 
> > 
> > 
> > On Tue, Jul 29, 2014 at 10:37 PM, Etienne Tourigny <
> > etourigny.dev at gmail.com> wrote:
> > 
> > I am not sure, but you can do the following to make sure:
> > 
> > 
> > 
> > cp infile infile2
> > 
> > gdal_calc.py -A infile --A_band 1 -B infile2 --B_band 0 --outfile outfile
> > --calc "(A-B)/(A+B)"
> > 
> > 
> > 
> > Also, perhaps the extra comma in your command might be to blame "-B
> > infile,"
> > 
> > 
> > 
> > Etienne
> > 
> > 
> > 
> > On Tue, Jul 29, 2014 at 3:46 AM, Cleo Drakos <cleo21drakos at gmail.com>
> > 
> > wrote:
> >   Hi GDAL Developers,
> > 
> > I have one GeoTIFF file with 2 bands. The data type is Byte. I want to
> > calculate (Band2-Band1)/(Band2+Band1).
> > 
> > But the following command provided a dark image:
> > 
> > gdal_calc.py -A infile --A_band 1 -B infile, --B_band 0 --outfile outfile
> > --calc "(A-B)/(A+B)"
> > 
> > Does gdal_calc.py not calculate arithmetic with in the same file?
> > 
> > Thanks for your time.
> > 
> > cleo
> > 
> > 
> > 
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > 
> > 
> > 
> > _______________________________________________
> > 
> > gdal-dev mailing list
> > 
> > gdal-dev at lists.osgeo.org
> > 
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > 
> > 
> > 
> > 
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > 
> > 
> > 
> > ------------------------------
> > This message contains information, which may be in confidence and may be
> > subject to legal privilege. If you are not the intended recipient, you
> > must not peruse, use, disseminate, distribute or copy this message. If
> > you have received this message in error, please notify us immediately
> > (Phone 0800 665 463 or info at linz.govt.nz) and destroy the original
> > message. LINZ accepts no responsibility for changes to this email, or
> > for any
> > attachments, after its transmission from LINZ. Thank You.

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Sat Aug  2 11:21:47 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 2 Aug 2014 20:21:47 +0200
Subject: [gdal-dev] Problem with .asc files
In-Reply-To: <1406723035046-5154189.post@n6.nabble.com>
References: <1406723035046-5154189.post@n6.nabble.com>
Message-ID: <201408022021.47737.even.rouault@mines-paris.org>

Hi,

Where does this file come from ? Do you have a link to such a file ?
Its header doesn't follow the accepted format by the GDAL driver for a 
Arc/Info ASCII Grid file.

Even

> Hi everyone !
> I've a problem with gdal, it doesn't recognise my files with .asc
> extensions.
> 
> *>gdalinfo N42W00.asc
> ERROR 4: 'N42W00.asc' not recognised as a supported file format.
> 
> gdalinfo failed - unable to open 'N42W00.asc'.*
> 
> However, the gdal driver is presnt :
> 
> *>gdalinfo --formats | find "ASC"
>   AAIGrid (rwv): Arc/Info ASCII Grid
>   GRASSASCIIGrid (rov): GRASS ASCII Grid
>   GSAG (rwv): Golden Software ASCII Grid (.grd)
>   USGSDEM (rwv): USGS Optional ASCII DEM (and CDED)
>   XYZ (rwv): ASCII Gridded XYZ*
> 
> And this files are well formated :
> 
> *W:12.000000 E:13.000000 S:38.000000 N:39.000000 grid:1.000000
> cols:61 rows:61 endian:10203 min:-10.000000 max:3211.000244
> 
>  2381.00 2391.00 2416.00 2450.00 2498.00 2537.00 2560.00 2579.00 2557.00
> 2404.00
>  2273.00 2208.00 2164.00 2214.00 2210.00 2242.00 2292.00 2329.00 2362.00
> 2378.00
> ...............*
> 
> Thank you for any help ;)
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/Problem-with-asc-files-tp5154189.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Sat Aug  2 11:29:46 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 2 Aug 2014 20:29:46 +0200
Subject: [gdal-dev] GDAL High dynamic range images
In-Reply-To: <CANNqv9eKcc=9vOhNS_u2Dg9rnVw8z5VP8EF4i=QtKx29j_OACg@mail.gmail.com>
References: <CANNqv9eKcc=9vOhNS_u2Dg9rnVw8z5VP8EF4i=QtKx29j_OACg@mail.gmail.com>
Message-ID: <201408022029.46198.even.rouault@mines-paris.org>

Le mercredi 30 juillet 2014 15:04:42, Rashad M a ?crit :
> Hello all,
> 
> 
> Is it possible to read high dynamic range files using GDAL?

Not currently. And HDR seems to refer more to a general technique than a well 
established format. So getting support for your file might depend on the 
specific format of the camera maker.

Even

> 
> $ gdalinfo ./memorial.hdr
> ERROR 4: `./memorial.hdr' not recognised as a supported file format.
> 
> gdalinfo failed - unable to open './memorial.hdr'
> 
> 
> gdal installed from standard Fedora 20 x86_64 repository
> 
> gdal-config --version
> 1.10.1
> 
>  gdal-config --formats
> gxf gtiff hfa aigrid aaigrid ceos ceos2 iso8211 xpm sdts raw dted mem jdem
> envisat elas fit vrt usgsdem l1b nitf bmp pcidsk airsar rs2 ilwis rmf
> leveller sgi srtmhgt idrisi gsg ingr ers jaxapalsar dimap gff cosar pds
> adrg coasp tsx terragen blx msgn til r northwood saga xyz hf2
> kmlsuperoverlay ctg e00grid zmap ngsgeoid iris map webp wcs wms dods grib
> jpeg2000 netcdf hdf5 hdf4 gif jpeg gta png pcraster fits rik ozi pdf
> rasterlite mbtiles postgisraster jpegls arg

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From landa.martin at gmail.com  Sat Aug  2 11:32:20 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Sat, 2 Aug 2014 20:32:20 +0200
Subject: [gdal-dev] oci driver rfc 41 (funding)
Message-ID: <CA+Ei1OejrS7eBbr0KmRos=wRcscvWms+ESxvxLjMBJXmDUjETA@mail.gmail.com>

Hi all,

I am not sure if this is a right place for such mail. Anyway please
feel free to redirect me to the better place and sorry for the noise
which is not really related to the development issues.

Within one project I started implementing RFC 41 [1] (Support for
multiple geometry fields in OGR) for OCI driver. Unfortunately the
development have not been funded at the end. So I have a patch which
cover about 50% of functionality (writing, not reading). It needs some
extra work to finish it, unfortunately I am unable to do it in my free
time. I wanted to ask here if there is anyone who would be able to
fund completation of RFC41 for OCI driver and give me a possibility to
finish this project.

Thanks for any tips in advance, Martin

[1] http://trac.osgeo.org/gdal/wiki/rfc41_multiple_geometry_fields

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From even.rouault at mines-paris.org  Sat Aug  2 12:52:56 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 2 Aug 2014 21:52:56 +0200
Subject: [gdal-dev] convert USGS Topo GeoPDF to GeoTiff, file size
In-Reply-To: <6EA4EFC234788744A8304EE0D4B8AF986B5B6B58CB@bigtorex01>
References: <6EA4EFC234788744A8304EE0D4B8AF986B5B6B58CB@bigtorex01>
Message-ID: <201408022152.56160.even.rouault@mines-paris.org>

Le jeudi 31 juillet 2014 16:46:36, Liu, Jian a ?crit :
> Hello,
> 
> I try to use GDAL to convert USGS Topo geopdfs to Geotiff format. I have
> the following command:
> 
> gdalwarp geo.pdf geo.tif -crop_to_cutline -cutline
> C:\JIANTestFolder\cutline.csv -overwrite --config GDAL_CACHEMAX 500 -wm
> 500 --config GDAL_PDF_LAYERS_OFF Projection_and_Grids --config
> GDAL_PDF_DPI 508 -co "TILED=YES" -co "TFW=YES" -co "COMPRESS=JPEG" -co
> "PHOTOMETRIC=YCBCR"
> 
> I want to maintain the image quality while keeping the file to a minimal
> size. But my output .tif is about twice as big as the input pdf (19.5M vs.
> 11.9M)  -- the output dpi (GDAL_PDF_DPI=508) is set based on the metadata
> information in the geopdf. I read somewhere that pdf just stores image "as
> it is", and I am wondering how come my geotiff is twice as big, even with
> the jpeg compression with the YCBCR option? Is it still possible to reduce
> its size?
> 
> Here is the geopdf I use:   
> http://ims.er.usgs.gov/gda_services/download?item_id=5998960
> 
> I've searched the mail archive and couldn't find anything relevant. I
> appreciate any answers or suggestions about converting geopdf to geotiffs.
> Thank you!

Jian,

when using gdalwarp, you go through several abstraction layers that "loose" 
the original compressed format.

With additionnal developments, it might be possible to have a script/program 
that would :
1) extract the JPEG files from the PDF, identically to how they are stored in 
the PDF
2) do the cropping by preserving the tiles completely within the cutline, and 
cropping the ones intersecting it
3) reassembling the whole as a TIFF with JPEG compression, provided they all 
use the same JPEG quantization tables

This would be a non-trivial development effort.

You can refer to one of my somehow related blog post : 
http://erouault.blogspot.fr/2014/04/advanced-jpeg-in-tiff-uses-in-gdal.html ( 
the end particularly)

Best regards,

Even

> 
> Best regards,
> Jian

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Sat Aug  2 12:57:38 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 2 Aug 2014 21:57:38 +0200
Subject: [gdal-dev] SetSpatialFilter
In-Reply-To: <CAFjrKg5oVbbxR1VoEGct86Wu0z=sMMqn5rTatoSZgRfMjuxAHw@mail.gmail.com>
References: <CAFjrKg5oVbbxR1VoEGct86Wu0z=sMMqn5rTatoSZgRfMjuxAHw@mail.gmail.com>
Message-ID: <201408022157.38411.even.rouault@mines-paris.org>

Le vendredi 01 ao?t 2014 18:36:28, tunca tunc a ?crit :
> Hi,
> 
> I"m totally new to GDAL, sorry if this is a obvious thing for you.
> 
> Trying to filter features in the area with following code snippet.
> However
> poLayer->GetNextFeature()
> always returns null on my windows 8.
> 
> 
>    OGRPolygon* polygon = new OGRPolygon();
> 
> >    OGRLinearRing* ring = new OGRLinearRing();
> >    ring->addPoint(51.089028, 13.617821);
> >    ring->addPoint(51.089675, 13.807336);
> >    ring->addPoint(51.025585, 13.807679);
> >    ring->addPoint(51.024937, 13.616105);
> >    polygon->addRing(ring);
> >    poLayer->SetSpatialFilter(polygon);
> 
> The full code is
> http://pastebin.com/eWUeVsTG
> 
> I suspected geos dll is not loaded, but it's loaded according to following
> output.
> http://pastebin.com/7r1gUdQq

Tunca,

If you are interested in the Dresden area, I suspect you have inverted 
latitude and longitude values.

Best regards,

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Sat Aug  2 13:00:26 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 2 Aug 2014 22:00:26 +0200
Subject: [gdal-dev] Error in SetGeoTransform
In-Reply-To: <CAO1oGMW0Yg2eTR5cAWgAHqD1wJs-z_7DJenO_eV==i2dgtaqqg@mail.gmail.com>
References: <CAO1oGMW0Yg2eTR5cAWgAHqD1wJs-z_7DJenO_eV==i2dgtaqqg@mail.gmail.com>
Message-ID: <201408022200.26934.even.rouault@mines-paris.org>

Le samedi 02 ao?t 2014 13:07:13, Morteza Ghavami a ?crit :
> Hello
> 
> I trying to make geotiff from float array . when I try to set geotransform
> information I get this error :
> "Dataset does not support the AddBand() method."
> 
> The part of my code that i used to make geotiff listed below (the part of
> code that error occurred ):
> 
> 
> poDriver=GetGDALDriverManager()->GetDriverByName(pszFormat);
> poDstDS = poDriver->Create( outStr.c_str(), outWidth, outHeight,
> 1,GDT_Float32,papszOptions );
> double adfGeoTransform[6] = { static_cast<double>(west),
> static_cast<double>(OUTPUT_PIXEL_METER), 0.0, static_cast<double>(north),
> 0.0, static_cast<double>(-OUTPUT_PIXEL_METER) };
> OGRSpatialReference oSRS;
> char *pszSRS_WKT = NULL;
> GDALRasterBand *poBand;
> rasterData=new float[outWidth*outHeight];
> OGRErr err=poDstDS->SetGeoTransform(adfGeoTransform);
> oSRS.importFromProj4("+proj=merc +ellps=WGS84 +datum=WGS84 +lon_0=0.0
> +a=6378137.0 +b=6356752.314 +units=m");
> 
> Note : The err value is 3 .
> What is wrong with this code ?

It looks like an ABI mismatch situation. The SetGeoTransform() would be 
dispatched at runtime on the AddBand() method. This is very likely as both 
methods are following each others in the virtual table. Are you sure you are 
compiling against the GDAL headers of the version you are linking to ?


> thanks

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html



From even.rouault at mines-paris.org  Sat Aug  2 13:03:14 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 2 Aug 2014 22:03:14 +0200
Subject: [gdal-dev] feature.clone() -> same featuredefn
In-Reply-To: <CA+Ei1Odc0VtXz-hj=zEd+KNoa+O9C=qKCLdwZTJud89xA1kTpQ@mail.gmail.com>
References: <CA+Ei1Odc0VtXz-hj=zEd+KNoa+O9C=qKCLdwZTJud89xA1kTpQ@mail.gmail.com>
Message-ID: <201408022203.14325.even.rouault@mines-paris.org>

Le samedi 02 ao?t 2014 16:15:31, Martin Landa a ?crit :
> Hi,
> 
> OGRFeature::Clone() duplicates feature. I found in API manual this
> sentence: the newly created feature is owned by the caller, and will
> have it's own reference to the OGRFeatureDefn.
> 
> When I try in Python:
> 
> ofeature = feature.Clone()
> print feature.GetDefnRef()
> print ofeature.GetDefnRef()
> 
> I am getting same reference to OGRFeatureDefn.
> 
> <osgeo.ogr.FeatureDefn; proxy of <Swig Object of type
> 'OGRFeatureDefnShadow *' at 0x7f86b7b84a20> >
> <osgeo.ogr.FeatureDefn; proxy of <Swig Object of type
> 'OGRFeatureDefnShadow *' at 0x7f86b7b84a20> >
> 
> ?

The documentation meant that Clone() will return a new standalone feature, but 
that will also increment the reference counter of the related OGRFeatureDefn 
(as new OGRFeature(poFeatureDefn) would do).

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From landa.martin at gmail.com  Sat Aug  2 13:12:35 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Sat, 2 Aug 2014 22:12:35 +0200
Subject: [gdal-dev] feature.clone() -> same featuredefn
In-Reply-To: <201408022203.14325.even.rouault@mines-paris.org>
References: <CA+Ei1Odc0VtXz-hj=zEd+KNoa+O9C=qKCLdwZTJud89xA1kTpQ@mail.gmail.com>
	<201408022203.14325.even.rouault@mines-paris.org>
Message-ID: <CA+Ei1OeWBuA8Ovn-jwWuwDnwtSLUKd6tUR=dBbtgxeR4bvaZfg@mail.gmail.com>

Hi,

2014-08-02 22:03 GMT+02:00 Even Rouault <even.rouault at mines-paris.org>:

> The documentation meant that Clone() will return a new standalone feature, but
> that will also increment the reference counter of the related OGRFeatureDefn
> (as new OGRFeature(poFeatureDefn) would do).

truly to say, it doesn't explain me why the both features points to
the same OGRFeatureDefn. Anyway, I need to solve problem explained
bellow:

1) copy features from input layer to output layer
2) modify features in output layer (remove some geometry columns)

How correctly I should do it? Thanks in advance, Martin

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From even.rouault at mines-paris.org  Sat Aug  2 13:18:05 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 2 Aug 2014 22:18:05 +0200
Subject: [gdal-dev] feature.clone() -> same featuredefn
In-Reply-To: <CA+Ei1OeWBuA8Ovn-jwWuwDnwtSLUKd6tUR=dBbtgxeR4bvaZfg@mail.gmail.com>
References: <CA+Ei1Odc0VtXz-hj=zEd+KNoa+O9C=qKCLdwZTJud89xA1kTpQ@mail.gmail.com>
	<201408022203.14325.even.rouault@mines-paris.org>
	<CA+Ei1OeWBuA8Ovn-jwWuwDnwtSLUKd6tUR=dBbtgxeR4bvaZfg@mail.gmail.com>
Message-ID: <201408022218.05496.even.rouault@mines-paris.org>

Le samedi 02 ao?t 2014 22:12:35, Martin Landa a ?crit :
> Hi,
> 
> 2014-08-02 22:03 GMT+02:00 Even Rouault <even.rouault at mines-paris.org>:
> > The documentation meant that Clone() will return a new standalone
> > feature, but that will also increment the reference counter of the
> > related OGRFeatureDefn (as new OGRFeature(poFeatureDefn) would do).
> 
> truly to say, it doesn't explain me why the both features points to
> the same OGRFeatureDefn. 

Well, that's by design...


> Anyway, I need to solve problem explained
> bellow:
> 
> 1) copy features from input layer to output layer
> 2) modify features in output layer (remove some geometry columns)

You can use the SetFrom() method.

> 
> How correctly I should do it? Thanks in advance, Martin

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From aperi2007 at gmail.com  Sat Aug  2 14:48:54 2014
From: aperi2007 at gmail.com (Andrea Peri)
Date: Sat, 2 Aug 2014 23:48:54 +0200
Subject: [gdal-dev] Need some info on geotiff tags missing
Message-ID: <CABqTJk_0=3ROBpthXxn5GTsonKp1g0MOCxRDBUythU+hjw6uuw@mail.gmail.com>

Hi,

I have transform many old tiff+tfw rasters using this gdal transformation:

gdal_translate -ot Byte -of GTiff -b 1 -a_nodata none -stats -co
COMPRESS=NONE -co INTERLEAVE=PIXEL -co PROFILE=GDALGeoTIFF -co
TILED=YES -co BLOCKXSIZE=256 -co BLOCKYSIZE=256 -co SPARSE_OK=TRUE -co
TFW=NO filein.tif fileout.tif

They are wrking correctly with qgis and with mapserver for several months.

Now I need to use this geotiffs with another program.
But this program say that these images are not realy GeoTiffs.

I test them using listgeos and have this result:

TIFFReadDirectory: Warning, Unknown field with tag 42112 (0xa480) encountered.
Geotiff_Information:
   Version: 1
   Key_Revision: 1.0
   Tagged_Information:
      ModelTiepointTag (2,3):
         0                0                0
         559417.445637    4927786.430528   0
      ModelPixelScaleTag (1,3):
         0.5              0.5              0
      End_Of_Tags.
   Keyed_Information:
      End_Of_Keys.
   End_Of_Geotiff.

Some people say me that this is not a true geotiff because are missing
several tags.
I reported a supposed response from a real geotiff:

Geotiff_Information:
    Version: 1
    Key_Revision: 1.0
    Tagged_Information:
       ModelTiepointTag (2,3):
          0                 0                 0
          673347            4298291           0
       ModelPixelScaleTag (1,3):
          1                 1                 1
       End_Of_Tags.
    Keyed_Information:
       GTModelTypeGeoKey (Short,1): ModelTypeProjected
       GTRasterTypeGeoKey (Short,1): RasterPixelIsArea
       GTCitationGeoKey (Ascii,37): "NAIP 2012
m_3808409_sw_16_1_20120607"
       ProjectedCSTypeGeoKey (Short,1): PCS_NAD83_UTM_zone_16N
       PCSCitationGeoKey (Ascii,21): "NAD83 / UTM zone 16N"
       ProjLinearUnitsGeoKey (Short,1): Linear_Meter
       End_Of_Keys.
    End_Of_Geotiff.

PCS = 26916 (NAD83 / UTM zone 16N)
Projection = 16016 (UTM zone 16N)
Projection Method: CT_TransverseMercator
    ProjNatOriginLatGeoKey: 0.000000 (  0d 0' 0.00"N)
    ProjNatOriginLongGeoKey: -87.000000 ( 87d 0' 0.00"W)
    ProjScaleAtNatOriginGeoKey: 0.999600
    ProjFalseEastingGeoKey: 500000.000000 m
    ProjFalseNorthingGeoKey: 0.000000 m
GCS: 4269/NAD83
Datum: 6269/North American Datum 1983
Ellipsoid: 7019/GRS 1980 (6378137.00,6356752.31)
Prime Meridian: 8901/Greenwich (0.000000/  0d 0' 0.00"E)
Projection Linear Units: 9001/metre (1.000000m)

Corner Coordinates:
Upper Left    (  673347.000, 4298291.000)  ( 85d 0'12.06"W,
38d48'58.87"N)
Lower Left    (  673347.000, 4290632.000)  ( 85d 0'18.99"W,
38d44'50.54"N)
Upper Right   (  679532.000, 4298291.000)  ( 84d55'55.75"W,
38d48'54.41"N)
Lower Right   (  679532.000, 4290632.000)  ( 84d56' 2.92"W,
38d44'46.10"N)
Center        (  676439.500, 4294461.500)  ( 84d58' 7.43"W,
38d46'52.50"N)

-----

I'm a bit confused.
Because I have produced my GeoTiffs using gdal. And if it fail to
produce a real geotiff I have a trouble.

So the main question is a geotiff ith only the tags reported a real geotiff ?

Thx,

-- 
-----------------
Andrea Peri
. . . . . . . . .
qwerty ?????
-----------------

From landa.martin at gmail.com  Sat Aug  2 15:14:30 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Sun, 3 Aug 2014 00:14:30 +0200
Subject: [gdal-dev] export to postgis, ogc_fid_seq
Message-ID: <CA+Ei1Ofm-R5S7FyPgTqyeXv6SvaxLUnJTaEf6vABRJ75Hyct3w@mail.gmail.com>

Hi,

when exporting features to PostGIS layer (python script) I discovered
that ogc_fid_seq is not updated.

Eg.


select last_value from stavebniobjekty_ogc_fid_seq;
 last_value
------------
          1
select max(ogc_fid) from stavebniobjekty;
 max
------
 2572

Any idea what is missing in my script? Thanks, Martin

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From mohammedrashadkm at gmail.com  Sat Aug  2 16:05:45 2014
From: mohammedrashadkm at gmail.com (Rashad M)
Date: Sun, 3 Aug 2014 01:05:45 +0200
Subject: [gdal-dev] GDAL High dynamic range images
In-Reply-To: <201408022029.46198.even.rouault@mines-paris.org>
References: <CANNqv9eKcc=9vOhNS_u2Dg9rnVw8z5VP8EF4i=QtKx29j_OACg@mail.gmail.com>
	<201408022029.46198.even.rouault@mines-paris.org>
Message-ID: <CANNqv9c8-OBcCJANXfYvmAJFV824wdsHUue0YpUP9grMwku+NA@mail.gmail.com>

On Sat, Aug 2, 2014 at 8:29 PM, Even Rouault <even.rouault at mines-paris.org>
wrote:

> Le mercredi 30 juillet 2014 15:04:42, Rashad M a ?crit :
> > Hello all,
> >
> >
> > Is it possible to read high dynamic range files using GDAL?
>
> Not currently. And HDR seems to refer more to a general technique than a
> well
> established format. So getting support for your file might depend on the
> specific format of the camera maker.
>

Ok. But cant it be handled by a new gdal driver?

>
> Even
>
> >
> > $ gdalinfo ./memorial.hdr
> > ERROR 4: `./memorial.hdr' not recognised as a supported file format.
> >
> > gdalinfo failed - unable to open './memorial.hdr'
> >
> >
> > gdal installed from standard Fedora 20 x86_64 repository
> >
> > gdal-config --version
> > 1.10.1
> >
> >  gdal-config --formats
> > gxf gtiff hfa aigrid aaigrid ceos ceos2 iso8211 xpm sdts raw dted mem
> jdem
> > envisat elas fit vrt usgsdem l1b nitf bmp pcidsk airsar rs2 ilwis rmf
> > leveller sgi srtmhgt idrisi gsg ingr ers jaxapalsar dimap gff cosar pds
> > adrg coasp tsx terragen blx msgn til r northwood saga xyz hf2
> > kmlsuperoverlay ctg e00grid zmap ngsgeoid iris map webp wcs wms dods grib
> > jpeg2000 netcdf hdf5 hdf4 gif jpeg gta png pcraster fits rik ozi pdf
> > rasterlite mbtiles postgisraster jpegls arg
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>



-- 
Regards,
   Rashad
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140803/df2dfc55/attachment-0001.html>

From atuncatunc at gmail.com  Sun Aug  3 00:03:57 2014
From: atuncatunc at gmail.com (tunca tunc)
Date: Sun, 3 Aug 2014 10:03:57 +0300
Subject: [gdal-dev] SetSpatialFilter
In-Reply-To: <201408022157.38411.even.rouault@mines-paris.org>
References: <CAFjrKg5oVbbxR1VoEGct86Wu0z=sMMqn5rTatoSZgRfMjuxAHw@mail.gmail.com>
	<201408022157.38411.even.rouault@mines-paris.org>
Message-ID: <CAFjrKg7dOSafnVDgsUrVD8M6tfnZtOVkB7GDBz0+RipNSRMM-g@mail.gmail.com>

Thanks Even,
It works now.
Are Latitude and Longitude values are inverted in gdal.

Best Regards
Tunca
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140803/a7d640a9/attachment.html>

From even.rouault at mines-paris.org  Sun Aug  3 01:17:01 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sun, 3 Aug 2014 10:17:01 +0200
Subject: [gdal-dev] SetSpatialFilter
In-Reply-To: <CAFjrKg7dOSafnVDgsUrVD8M6tfnZtOVkB7GDBz0+RipNSRMM-g@mail.gmail.com>
References: <CAFjrKg5oVbbxR1VoEGct86Wu0z=sMMqn5rTatoSZgRfMjuxAHw@mail.gmail.com>
	<201408022157.38411.even.rouault@mines-paris.org>
	<CAFjrKg7dOSafnVDgsUrVD8M6tfnZtOVkB7GDBz0+RipNSRMM-g@mail.gmail.com>
Message-ID: <201408031017.01287.even.rouault@mines-paris.org>

Le dimanche 03 ao?t 2014 09:03:57, tunca tunc a ?crit :
> Thanks Even,
> It works now.
> Are Latitude and Longitude values are inverted in gdal.

Most GIS and GIS formats work with longitude, latitude coordinate order since 
it allows to draw a map that makes sense when using longitude as the 
horizontal axis and the latitude as the vertical axis of a euclidian plan.

> 
> Best Regards
> Tunca

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Sun Aug  3 01:17:41 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sun, 3 Aug 2014 10:17:41 +0200
Subject: [gdal-dev] GDAL High dynamic range images
In-Reply-To: <CANNqv9c8-OBcCJANXfYvmAJFV824wdsHUue0YpUP9grMwku+NA@mail.gmail.com>
References: <CANNqv9eKcc=9vOhNS_u2Dg9rnVw8z5VP8EF4i=QtKx29j_OACg@mail.gmail.com>
	<201408022029.46198.even.rouault@mines-paris.org>
	<CANNqv9c8-OBcCJANXfYvmAJFV824wdsHUue0YpUP9grMwku+NA@mail.gmail.com>
Message-ID: <201408031017.41395.even.rouault@mines-paris.org>

Le dimanche 03 ao?t 2014 01:05:45, Rashad M a ?crit :
> On Sat, Aug 2, 2014 at 8:29 PM, Even Rouault <even.rouault at mines-paris.org>
> 
> wrote:
> > Le mercredi 30 juillet 2014 15:04:42, Rashad M a ?crit :
> > > Hello all,
> > > 
> > > 
> > > Is it possible to read high dynamic range files using GDAL?
> > 
> > Not currently. And HDR seems to refer more to a general technique than a
> > well
> > established format. So getting support for your file might depend on the
> > specific format of the camera maker.
> 
> Ok. But cant it be handled by a new gdal driver?
> 

Yes, I guess it could.

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From aperi2007 at gmail.com  Sun Aug  3 01:28:46 2014
From: aperi2007 at gmail.com (Andrea Peri)
Date: Sun, 3 Aug 2014 10:28:46 +0200
Subject: [gdal-dev] Need some info on geotiff tags missing
In-Reply-To: <CABqTJk_0=3ROBpthXxn5GTsonKp1g0MOCxRDBUythU+hjw6uuw@mail.gmail.com>
References: <CABqTJk_0=3ROBpthXxn5GTsonKp1g0MOCxRDBUythU+hjw6uuw@mail.gmail.com>
Message-ID: <CABqTJk-RW4PnNj1SiL6-_CiOOZ=zoJrcQ-YFNVW2oemRg6DF8Q@mail.gmail.com>

Hi,

I resolve my troubles.

The geotiff as generate from gdal seem to be the minimal necessary
tags for a geotiff.
I tested the production using geotifcp tool and compare the with that
produced using gdal. They are the same.
So I guess the gdal tags are the minimal necessary to have a good geotiff.
And the geotiff is correct.

Sorry for noise,

Andrea.


2014-08-02 23:48 GMT+02:00 Andrea Peri <aperi2007 at gmail.com>:
> Hi,
>
> I have transform many old tiff+tfw rasters using this gdal transformation:
>
> gdal_translate -ot Byte -of GTiff -b 1 -a_nodata none -stats -co
> COMPRESS=NONE -co INTERLEAVE=PIXEL -co PROFILE=GDALGeoTIFF -co
> TILED=YES -co BLOCKXSIZE=256 -co BLOCKYSIZE=256 -co SPARSE_OK=TRUE -co
> TFW=NO filein.tif fileout.tif
>
> They are wrking correctly with qgis and with mapserver for several months.
>
> Now I need to use this geotiffs with another program.
> But this program say that these images are not realy GeoTiffs.
>
> I test them using listgeos and have this result:
>
> TIFFReadDirectory: Warning, Unknown field with tag 42112 (0xa480) encountered.
> Geotiff_Information:
>    Version: 1
>    Key_Revision: 1.0
>    Tagged_Information:
>       ModelTiepointTag (2,3):
>          0                0                0
>          559417.445637    4927786.430528   0
>       ModelPixelScaleTag (1,3):
>          0.5              0.5              0
>       End_Of_Tags.
>    Keyed_Information:
>       End_Of_Keys.
>    End_Of_Geotiff.
>
> Some people say me that this is not a true geotiff because are missing
> several tags.
> I reported a supposed response from a real geotiff:
>
> Geotiff_Information:
>     Version: 1
>     Key_Revision: 1.0
>     Tagged_Information:
>        ModelTiepointTag (2,3):
>           0                 0                 0
>           673347            4298291           0
>        ModelPixelScaleTag (1,3):
>           1                 1                 1
>        End_Of_Tags.
>     Keyed_Information:
>        GTModelTypeGeoKey (Short,1): ModelTypeProjected
>        GTRasterTypeGeoKey (Short,1): RasterPixelIsArea
>        GTCitationGeoKey (Ascii,37): "NAIP 2012
> m_3808409_sw_16_1_20120607"
>        ProjectedCSTypeGeoKey (Short,1): PCS_NAD83_UTM_zone_16N
>        PCSCitationGeoKey (Ascii,21): "NAD83 / UTM zone 16N"
>        ProjLinearUnitsGeoKey (Short,1): Linear_Meter
>        End_Of_Keys.
>     End_Of_Geotiff.
>
> PCS = 26916 (NAD83 / UTM zone 16N)
> Projection = 16016 (UTM zone 16N)
> Projection Method: CT_TransverseMercator
>     ProjNatOriginLatGeoKey: 0.000000 (  0d 0' 0.00"N)
>     ProjNatOriginLongGeoKey: -87.000000 ( 87d 0' 0.00"W)
>     ProjScaleAtNatOriginGeoKey: 0.999600
>     ProjFalseEastingGeoKey: 500000.000000 m
>     ProjFalseNorthingGeoKey: 0.000000 m
> GCS: 4269/NAD83
> Datum: 6269/North American Datum 1983
> Ellipsoid: 7019/GRS 1980 (6378137.00,6356752.31)
> Prime Meridian: 8901/Greenwich (0.000000/  0d 0' 0.00"E)
> Projection Linear Units: 9001/metre (1.000000m)
>
> Corner Coordinates:
> Upper Left    (  673347.000, 4298291.000)  ( 85d 0'12.06"W,
> 38d48'58.87"N)
> Lower Left    (  673347.000, 4290632.000)  ( 85d 0'18.99"W,
> 38d44'50.54"N)
> Upper Right   (  679532.000, 4298291.000)  ( 84d55'55.75"W,
> 38d48'54.41"N)
> Lower Right   (  679532.000, 4290632.000)  ( 84d56' 2.92"W,
> 38d44'46.10"N)
> Center        (  676439.500, 4294461.500)  ( 84d58' 7.43"W,
> 38d46'52.50"N)
>
> -----
>
> I'm a bit confused.
> Because I have produced my GeoTiffs using gdal. And if it fail to
> produce a real geotiff I have a trouble.
>
> So the main question is a geotiff ith only the tags reported a real geotiff ?
>
> Thx,
>
> --
> -----------------
> Andrea Peri
> . . . . . . . . .
> qwerty ?????
> -----------------



-- 
-----------------
Andrea Peri
. . . . . . . . .
qwerty ?????
-----------------

From even.rouault at mines-paris.org  Sun Aug  3 01:30:14 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sun, 3 Aug 2014 10:30:14 +0200
Subject: [gdal-dev] export to postgis, ogc_fid_seq
In-Reply-To: <CA+Ei1Ofm-R5S7FyPgTqyeXv6SvaxLUnJTaEf6vABRJ75Hyct3w@mail.gmail.com>
References: <CA+Ei1Ofm-R5S7FyPgTqyeXv6SvaxLUnJTaEf6vABRJ75Hyct3w@mail.gmail.com>
Message-ID: <201408031030.14733.even.rouault@mines-paris.org>

Le dimanche 03 ao?t 2014 00:14:30, Martin Landa a ?crit :
> Hi,
> 
> when exporting features to PostGIS layer (python script) I discovered
> that ogc_fid_seq is not updated.
> 
> Eg.
> 
> 
> select last_value from stavebniobjekty_ogc_fid_seq;
>  last_value
> ------------
>           1
> select max(ogc_fid) from stavebniobjekty;
>  max
> ------
>  2572
> 
> Any idea what is missing in my script? Thanks, Martin

Does your script explicitely set the FID before calling CreateFeature() ? If 
so, then the COPY (or INSERT if you use PG_USE_COPY = NO, but both have the 
same effect) will explicitely affect the ogc_fid column of the features, which 
has the effect of not incrementing the sequence.
You likely need to explicitely call setval()


-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Sun Aug  3 01:49:00 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sun, 3 Aug 2014 10:49:00 +0200
Subject: [gdal-dev] Need some info on geotiff tags missing
In-Reply-To: <CABqTJk_0=3ROBpthXxn5GTsonKp1g0MOCxRDBUythU+hjw6uuw@mail.gmail.com>
References: <CABqTJk_0=3ROBpthXxn5GTsonKp1g0MOCxRDBUythU+hjw6uuw@mail.gmail.com>
Message-ID: <201408031049.00792.even.rouault@mines-paris.org>

Le samedi 02 ao?t 2014 23:48:54, Andrea Peri a ?crit :
> Hi,
> 
> I have transform many old tiff+tfw rasters using this gdal transformation:
> 
> gdal_translate -ot Byte -of GTiff -b 1 -a_nodata none -stats -co
> COMPRESS=NONE -co INTERLEAVE=PIXEL -co PROFILE=GDALGeoTIFF -co
> TILED=YES -co BLOCKXSIZE=256 -co BLOCKYSIZE=256 -co SPARSE_OK=TRUE -co
> TFW=NO filein.tif fileout.tif
> 
> They are wrking correctly with qgis and with mapserver for several months.
> 
> Now I need to use this geotiffs with another program.
> But this program say that these images are not realy GeoTiffs.
> 
> I test them using listgeos and have this result:
> 
> TIFFReadDirectory: Warning, Unknown field with tag 42112 (0xa480)
> encountered. Geotiff_Information:
>    Version: 1
>    Key_Revision: 1.0
>    Tagged_Information:
>       ModelTiepointTag (2,3):
>          0                0                0
>          559417.445637    4927786.430528   0
>       ModelPixelScaleTag (1,3):
>          0.5              0.5              0
>       End_Of_Tags.
>    Keyed_Information:
>       End_Of_Keys.
>    End_Of_Geotiff.
> 
> Some people say me that this is not a true geotiff because are missing
> several tags.
> I reported a supposed response from a real geotiff:
> 
> Geotiff_Information:
>     Version: 1
>     Key_Revision: 1.0
>     Tagged_Information:
>        ModelTiepointTag (2,3):
>           0                 0                 0
>           673347            4298291           0
>        ModelPixelScaleTag (1,3):
>           1                 1                 1
>        End_Of_Tags.
>     Keyed_Information:
>        GTModelTypeGeoKey (Short,1): ModelTypeProjected
>        GTRasterTypeGeoKey (Short,1): RasterPixelIsArea
>        GTCitationGeoKey (Ascii,37): "NAIP 2012
> m_3808409_sw_16_1_20120607"
>        ProjectedCSTypeGeoKey (Short,1): PCS_NAD83_UTM_zone_16N
>        PCSCitationGeoKey (Ascii,21): "NAD83 / UTM zone 16N"
>        ProjLinearUnitsGeoKey (Short,1): Linear_Meter
>        End_Of_Keys.
>     End_Of_Geotiff.
> 
> PCS = 26916 (NAD83 / UTM zone 16N)
> Projection = 16016 (UTM zone 16N)
> Projection Method: CT_TransverseMercator
>     ProjNatOriginLatGeoKey: 0.000000 (  0d 0' 0.00"N)
>     ProjNatOriginLongGeoKey: -87.000000 ( 87d 0' 0.00"W)
>     ProjScaleAtNatOriginGeoKey: 0.999600
>     ProjFalseEastingGeoKey: 500000.000000 m
>     ProjFalseNorthingGeoKey: 0.000000 m
> GCS: 4269/NAD83
> Datum: 6269/North American Datum 1983
> Ellipsoid: 7019/GRS 1980 (6378137.00,6356752.31)
> Prime Meridian: 8901/Greenwich (0.000000/  0d 0' 0.00"E)
> Projection Linear Units: 9001/metre (1.000000m)
> 
> Corner Coordinates:
> Upper Left    (  673347.000, 4298291.000)  ( 85d 0'12.06"W,
> 38d48'58.87"N)
> Lower Left    (  673347.000, 4290632.000)  ( 85d 0'18.99"W,
> 38d44'50.54"N)
> Upper Right   (  679532.000, 4298291.000)  ( 84d55'55.75"W,
> 38d48'54.41"N)
> Lower Right   (  679532.000, 4290632.000)  ( 84d56' 2.92"W,
> 38d44'46.10"N)
> Center        (  676439.500, 4294461.500)  ( 84d58' 7.43"W,
> 38d46'52.50"N)
> 
> -----
> 
> I'm a bit confused.
> Because I have produced my GeoTiffs using gdal. And if it fail to
> produce a real geotiff I have a trouble.
> 
> So the main question is a geotiff ith only the tags reported a real geotiff
> ?

Andrea,

The difference between the 2 geotiff is that the first one does not have 
information on the spatial reference system, but only the geotransform that 
comes from the .tfw file.
Skimming quickly through the GeoTIFF specification ( 
http://www.remotesensing.org/geotiff/spec/contents.html ) doesn't immediately 
show if it is valid or not, although it would be best if readers are robust to 
missing information.
If you know the SRS of the maps, you can try adding -a_srs EPSG:XXXX or -a_srs 
wkt_string.
You could also try -a_srs "LOCAL_CS[\"Unknown\"]" if you don't know the SRS at 
all. This will write a few geotiff keys to define a unknown CRS, but it is not 
obvious that your reader will like it.

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From landa.martin at gmail.com  Sun Aug  3 01:52:00 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Sun, 3 Aug 2014 10:52:00 +0200
Subject: [gdal-dev] Feature style page
Message-ID: <CA+Ei1Ofhj3RfOwXaRhjRNTo3cqpQUEmsUVs7p8FGpBZhzp5hHA@mail.gmail.com>

Hi,

small note, the page about feature styles [1] lacks images.

Martin

[1] http://www.gdal.org/ogr_feature_style.html

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From even.rouault at mines-paris.org  Sun Aug  3 02:19:01 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sun, 3 Aug 2014 11:19:01 +0200
Subject: [gdal-dev] Feature style page
In-Reply-To: <CA+Ei1Ofhj3RfOwXaRhjRNTo3cqpQUEmsUVs7p8FGpBZhzp5hHA@mail.gmail.com>
References: <CA+Ei1Ofhj3RfOwXaRhjRNTo3cqpQUEmsUVs7p8FGpBZhzp5hHA@mail.gmail.com>
Message-ID: <201408031119.01547.even.rouault@mines-paris.org>

Le dimanche 03 ao?t 2014 10:52:00, Martin Landa a ?crit :
> Hi,
> 
> small note, the page about feature styles [1] lacks images.

Good catch. Actually the images were only on the www.gdal.org site and not in 
SVN ! Luckily I had made a backup of the old doc before RFC 46 in 
http://www.gdal.org/1.11, so I could fetch them back from there. During the 
next refresh from SVN they should be reinstalled. In the meantime you can see 
them from http://www.gdal.org/1.11/ogr/ogr_feature_style.html

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From landa.martin at gmail.com  Sun Aug  3 02:22:16 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Sun, 3 Aug 2014 11:22:16 +0200
Subject: [gdal-dev] Feature style page
In-Reply-To: <201408031119.01547.even.rouault@mines-paris.org>
References: <CA+Ei1Ofhj3RfOwXaRhjRNTo3cqpQUEmsUVs7p8FGpBZhzp5hHA@mail.gmail.com>
	<201408031119.01547.even.rouault@mines-paris.org>
Message-ID: <CA+Ei1OdZR9ALM-Q7UF3i=Zn8nmBgtG0=yRYGy3hpG8cyZzSmuw@mail.gmail.com>

Hi,

2014-08-03 11:19 GMT+02:00 Even Rouault <even.rouault at mines-paris.org>:

> Good catch. Actually the images were only on the www.gdal.org site and not in
> SVN ! Luckily I had made a backup of the old doc before RFC 46 in
> http://www.gdal.org/1.11, so I could fetch them back from there. During the
> next refresh from SVN they should be reinstalled. In the meantime you can see
> them from http://www.gdal.org/1.11/ogr/ogr_feature_style.html

cool, thanks a lot for super-quick fix! Martin

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From nixanz at nixanz.com  Sun Aug  3 02:51:28 2014
From: nixanz at nixanz.com (Nik Sands)
Date: Sun, 3 Aug 2014 19:51:28 +1000
Subject: [gdal-dev] Feature style page
In-Reply-To: <CA+Ei1OdZR9ALM-Q7UF3i=Zn8nmBgtG0=yRYGy3hpG8cyZzSmuw@mail.gmail.com>
References: <CA+Ei1Ofhj3RfOwXaRhjRNTo3cqpQUEmsUVs7p8FGpBZhzp5hHA@mail.gmail.com>
	<201408031119.01547.even.rouault@mines-paris.org>
	<CA+Ei1OdZR9ALM-Q7UF3i=Zn8nmBgtG0=yRYGy3hpG8cyZzSmuw@mail.gmail.com>
Message-ID: <277A444B-E205-42F6-B1C7-C5D0A9F12845@nixanz.com>

There might also be some issues in the sample code, including lines such as:

	for (i=0;iGetPartCount();i++)

and:

	poStyleTool = GetPart(i);

(or otherwise it's possible I'm completely misunderstanding some of the code)


On 3 Aug 2014, at 7:22 pm, Martin Landa <landa.martin at gmail.com> wrote:

> Hi,
> 
> 2014-08-03 11:19 GMT+02:00 Even Rouault <even.rouault at mines-paris.org>:
> 
>> Good catch. Actually the images were only on the www.gdal.org site and not in
>> SVN ! Luckily I had made a backup of the old doc before RFC 46 in
>> http://www.gdal.org/1.11, so I could fetch them back from there. During the
>> next refresh from SVN they should be reinstalled. In the meantime you can see
>> them from http://www.gdal.org/1.11/ogr/ogr_feature_style.html
> 
> cool, thanks a lot for super-quick fix! Martin
> 
> -- 
> Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From nixanz at nixanz.com  Sun Aug  3 03:11:42 2014
From: nixanz at nixanz.com (Nik Sands)
Date: Sun, 3 Aug 2014 20:11:42 +1000
Subject: [gdal-dev] Usage of styles in C API
Message-ID: <33534DE7-4774-43B7-BB19-C026601AE2F1@nixanz.com>

I'm just starting out using the styles features of OGR (using the C API) but at struggling with a few elements of it.

My code (copied below) fails to get any OGRStyleToolH.  Ie, the "if ( tool )" block never gets run, because 'tool' is always NULL at the point indicated by the comment.  But the execution does reach that point in the code which indicates that the OGRStyleMrgH does in fact include at least one part (tool).

I'd be grateful if somebody could point out what I'm doing wrong.

Thanks,
Nik.


-------------------------------------------
	const char *styleChars = OGR_STBL_GetNextStyle(table) ) )
	NSString *styleName = [NSString stringWithUTF8String:OGR_STBL_GetLastStyleName(table)];
	OGRStyleMgrH styleMgr = OGR_SM_Create(NULL);
	OGR_SM_InitStyleString(styleMgr, styleChars);


	for ( int i = 0; i < OGR_SM_GetPartCount(styleMgr, NULL); i++ )
	{
		OGRStyleToolH tool = OGR_SM_GetPart(styleMgr, i, NULL);
		
		if ( tool )  //  'tool' always NULL here
		{
			switch ( OGR_ST_GetType(tool) )
			{
				case OGRSTCPen:
					self.pen = tool;
					break;
					
				case OGRSTCBrush:
					self.brush = tool;
					break;
					
				case OGRSTCSymbol:
					self.symbol = tool;
					break;
					
				case OGRSTCLabel:
					self.label = tool;
					break;
					
				default:
					NSLog(@"Unknown style tool type!");
					break;
			}
		}
	}
-------------------------------------------



From even.rouault at mines-paris.org  Sun Aug  3 03:20:13 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sun, 3 Aug 2014 12:20:13 +0200
Subject: [gdal-dev] Feature style page
In-Reply-To: <277A444B-E205-42F6-B1C7-C5D0A9F12845@nixanz.com>
References: <CA+Ei1Ofhj3RfOwXaRhjRNTo3cqpQUEmsUVs7p8FGpBZhzp5hHA@mail.gmail.com>
	<CA+Ei1OdZR9ALM-Q7UF3i=Zn8nmBgtG0=yRYGy3hpG8cyZzSmuw@mail.gmail.com>
	<277A444B-E205-42F6-B1C7-C5D0A9F12845@nixanz.com>
Message-ID: <201408031220.13777.even.rouault@mines-paris.org>

Le dimanche 03 ao?t 2014 11:51:28, Nik Sands a ?crit :
> There might also be some issues in the sample code, including lines such
> as:
> 
> 	for (i=0;iGetPartCount();i++)
> 
> and:
> 
> 	poStyleTool = GetPart(i);
> 
> (or otherwise it's possible I'm completely misunderstanding some of the
> code)

Feel free to submit a patch fixing those issues.

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From aperi2007 at gmail.com  Sun Aug  3 03:24:29 2014
From: aperi2007 at gmail.com (Andrea Peri)
Date: Sun, 3 Aug 2014 12:24:29 +0200
Subject: [gdal-dev] Need some info on geotiff tags missing
In-Reply-To: <201408031049.00792.even.rouault@mines-paris.org>
References: <CABqTJk_0=3ROBpthXxn5GTsonKp1g0MOCxRDBUythU+hjw6uuw@mail.gmail.com>
	<201408031049.00792.even.rouault@mines-paris.org>
Message-ID: <CABqTJk_3UQVPASsc7ZMi3pKZgJ=z_mLsHjSnFxkuFimgRYRHoQ@mail.gmail.com>

thx Even for explanation.

Also I see the real important for some software is the presence of this section:

    Keyed_Information:
       GTRasterTypeGeoKey (Short,1): RasterPixelIsPoint
       End_Of_Keys.

It can have two possibl values:
RasterPixelIsPoint or RasterPixelIsArea

Seem that without a value for GTRasterTypeGeoKey some software don't work.

Is possible configure gdal to add this values when converting a
tif+tfw to a geotiff

?

Andrea.


2014-08-03 10:49 GMT+02:00 Even Rouault <even.rouault at mines-paris.org>:
> Le samedi 02 ao?t 2014 23:48:54, Andrea Peri a ?crit :
>> Hi,
>>
>> I have transform many old tiff+tfw rasters using this gdal transformation:
>>
>> gdal_translate -ot Byte -of GTiff -b 1 -a_nodata none -stats -co
>> COMPRESS=NONE -co INTERLEAVE=PIXEL -co PROFILE=GDALGeoTIFF -co
>> TILED=YES -co BLOCKXSIZE=256 -co BLOCKYSIZE=256 -co SPARSE_OK=TRUE -co
>> TFW=NO filein.tif fileout.tif
>>
>> They are wrking correctly with qgis and with mapserver for several months.
>>
>> Now I need to use this geotiffs with another program.
>> But this program say that these images are not realy GeoTiffs.
>>
>> I test them using listgeos and have this result:
>>
>> TIFFReadDirectory: Warning, Unknown field with tag 42112 (0xa480)
>> encountered. Geotiff_Information:
>>    Version: 1
>>    Key_Revision: 1.0
>>    Tagged_Information:
>>       ModelTiepointTag (2,3):
>>          0                0                0
>>          559417.445637    4927786.430528   0
>>       ModelPixelScaleTag (1,3):
>>          0.5              0.5              0
>>       End_Of_Tags.
>>    Keyed_Information:
>>       End_Of_Keys.
>>    End_Of_Geotiff.
>>
>> Some people say me that this is not a true geotiff because are missing
>> several tags.
>> I reported a supposed response from a real geotiff:
>>
>> Geotiff_Information:
>>     Version: 1
>>     Key_Revision: 1.0
>>     Tagged_Information:
>>        ModelTiepointTag (2,3):
>>           0                 0                 0
>>           673347            4298291           0
>>        ModelPixelScaleTag (1,3):
>>           1                 1                 1
>>        End_Of_Tags.
>>     Keyed_Information:
>>        GTModelTypeGeoKey (Short,1): ModelTypeProjected
>>        GTRasterTypeGeoKey (Short,1): RasterPixelIsArea
>>        GTCitationGeoKey (Ascii,37): "NAIP 2012
>> m_3808409_sw_16_1_20120607"
>>        ProjectedCSTypeGeoKey (Short,1): PCS_NAD83_UTM_zone_16N
>>        PCSCitationGeoKey (Ascii,21): "NAD83 / UTM zone 16N"
>>        ProjLinearUnitsGeoKey (Short,1): Linear_Meter
>>        End_Of_Keys.
>>     End_Of_Geotiff.
>>
>> PCS = 26916 (NAD83 / UTM zone 16N)
>> Projection = 16016 (UTM zone 16N)
>> Projection Method: CT_TransverseMercator
>>     ProjNatOriginLatGeoKey: 0.000000 (  0d 0' 0.00"N)
>>     ProjNatOriginLongGeoKey: -87.000000 ( 87d 0' 0.00"W)
>>     ProjScaleAtNatOriginGeoKey: 0.999600
>>     ProjFalseEastingGeoKey: 500000.000000 m
>>     ProjFalseNorthingGeoKey: 0.000000 m
>> GCS: 4269/NAD83
>> Datum: 6269/North American Datum 1983
>> Ellipsoid: 7019/GRS 1980 (6378137.00,6356752.31)
>> Prime Meridian: 8901/Greenwich (0.000000/  0d 0' 0.00"E)
>> Projection Linear Units: 9001/metre (1.000000m)
>>
>> Corner Coordinates:
>> Upper Left    (  673347.000, 4298291.000)  ( 85d 0'12.06"W,
>> 38d48'58.87"N)
>> Lower Left    (  673347.000, 4290632.000)  ( 85d 0'18.99"W,
>> 38d44'50.54"N)
>> Upper Right   (  679532.000, 4298291.000)  ( 84d55'55.75"W,
>> 38d48'54.41"N)
>> Lower Right   (  679532.000, 4290632.000)  ( 84d56' 2.92"W,
>> 38d44'46.10"N)
>> Center        (  676439.500, 4294461.500)  ( 84d58' 7.43"W,
>> 38d46'52.50"N)
>>
>> -----
>>
>> I'm a bit confused.
>> Because I have produced my GeoTiffs using gdal. And if it fail to
>> produce a real geotiff I have a trouble.
>>
>> So the main question is a geotiff ith only the tags reported a real geotiff
>> ?
>
> Andrea,
>
> The difference between the 2 geotiff is that the first one does not have
> information on the spatial reference system, but only the geotransform that
> comes from the .tfw file.
> Skimming quickly through the GeoTIFF specification (
> http://www.remotesensing.org/geotiff/spec/contents.html ) doesn't immediately
> show if it is valid or not, although it would be best if readers are robust to
> missing information.
> If you know the SRS of the maps, you can try adding -a_srs EPSG:XXXX or -a_srs
> wkt_string.
> You could also try -a_srs "LOCAL_CS[\"Unknown\"]" if you don't know the SRS at
> all. This will write a few geotiff keys to define a unknown CRS, but it is not
> obvious that your reader will like it.
>
> Even
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html



-- 
-----------------
Andrea Peri
. . . . . . . . .
qwerty ?????
-----------------

From even.rouault at mines-paris.org  Sun Aug  3 03:26:03 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sun, 3 Aug 2014 12:26:03 +0200
Subject: [gdal-dev] Usage of styles in C API
In-Reply-To: <33534DE7-4774-43B7-BB19-C026601AE2F1@nixanz.com>
References: <33534DE7-4774-43B7-BB19-C026601AE2F1@nixanz.com>
Message-ID: <201408031226.03489.even.rouault@mines-paris.org>

Le dimanche 03 ao?t 2014 12:11:42, Nik Sands a ?crit :
> I'm just starting out using the styles features of OGR (using the C API)
> but at struggling with a few elements of it.
> 
> My code (copied below) fails to get any OGRStyleToolH.  Ie, the "if ( tool
> )" block never gets run, because 'tool' is always NULL at the point
> indicated by the comment.  But the execution does reach that point in the
> code which indicates that the OGRStyleMrgH does in fact include at least
> one part (tool).
> 
> I'd be grateful if somebody could point out what I'm doing wrong.

Nothing strikes me as wrong. A potential explanation is that styleChars 
doesn't contain a valid OGR Feature Style string.
GetPartCount() counts the number of ";" separating style parts, but it doens't 
check that each style part actually begins by a recognized tool name (PEN, 
BRUSH, SYMBOL, LABEL). OGR_SM_GetPart() does this check however and if it 
cannot recognize it it returns a NULL tool.

> 
> Thanks,
> Nik.
> 
> 
> -------------------------------------------
> 	const char *styleChars = OGR_STBL_GetNextStyle(table) ) )
> 	NSString *styleName = [NSString
> stringWithUTF8String:OGR_STBL_GetLastStyleName(table)]; OGRStyleMgrH
> styleMgr = OGR_SM_Create(NULL);
> 	OGR_SM_InitStyleString(styleMgr, styleChars);
> 
> 
> 	for ( int i = 0; i < OGR_SM_GetPartCount(styleMgr, NULL); i++ )
> 	{
> 		OGRStyleToolH tool = OGR_SM_GetPart(styleMgr, i, NULL);
> 
> 		if ( tool )  //  'tool' always NULL here
> 		{
> 			switch ( OGR_ST_GetType(tool) )
> 			{
> 				case OGRSTCPen:
> 					self.pen = tool;
> 					break;
> 
> 				case OGRSTCBrush:
> 					self.brush = tool;
> 					break;
> 
> 				case OGRSTCSymbol:
> 					self.symbol = tool;
> 					break;
> 
> 				case OGRSTCLabel:
> 					self.label = tool;
> 					break;
> 
> 				default:
> 					NSLog(@"Unknown style tool type!");
> 					break;
> 			}
> 		}
> 	}
> -------------------------------------------
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Sun Aug  3 03:30:58 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sun, 3 Aug 2014 12:30:58 +0200
Subject: [gdal-dev] Need some info on geotiff tags missing
In-Reply-To: <CABqTJk_3UQVPASsc7ZMi3pKZgJ=z_mLsHjSnFxkuFimgRYRHoQ@mail.gmail.com>
References: <CABqTJk_0=3ROBpthXxn5GTsonKp1g0MOCxRDBUythU+hjw6uuw@mail.gmail.com>
	<201408031049.00792.even.rouault@mines-paris.org>
	<CABqTJk_3UQVPASsc7ZMi3pKZgJ=z_mLsHjSnFxkuFimgRYRHoQ@mail.gmail.com>
Message-ID: <201408031230.58398.even.rouault@mines-paris.org>

Le dimanche 03 ao?t 2014 12:24:29, Andrea Peri a ?crit :
> thx Even for explanation.
> 
> Also I see the real important for some software is the presence of this
> section:
> 
>     Keyed_Information:
>        GTRasterTypeGeoKey (Short,1): RasterPixelIsPoint
>        End_Of_Keys.
> 
> It can have two possibl values:
> RasterPixelIsPoint or RasterPixelIsArea
> 
> Seem that without a value for GTRasterTypeGeoKey some software don't work.
> 
> Is possible configure gdal to add this values when converting a
> tif+tfw to a geotiff

Andrea,

If you try what I suggested ( adding -a_srs "LOCAL_CS[\"Unknown\"]" to 
gdal_translate command line), you will get :

$ listgeo out.tif
Geotiff_Information:
   Version: 1
   Key_Revision: 1.0
   Tagged_Information:
      ModelTiepointTag (2,3):
		[ something ]
      ModelPixelScaleTag (1,3):
		[ something ]
      End_Of_Tags.
   Keyed_Information:
      GTRasterTypeGeoKey (Short,1): RasterPixelIsArea
      GTCitationGeoKey (Ascii,8): "Unknown"
      GeogAngularUnitsGeoKey (Short,1): Angular_Degree
      ProjLinearUnitsGeoKey (Short,1): Linear_Meter
      End_Of_Keys.
   End_Of_Geotiff.

Projection Linear Units: 9001/metre (1.000000m)

Corner Coordinates:
		[ something ]

You can control RasterPixelIsPoint or RasterPixelIsArea by adding  "-mo 
AREA_OR_POINT=Area" or  "-mo AREA_OR_POINT=Point" to the gdal_translate 
command line. The default is Area.

Even

> 
> ?
> 
> Andrea.
> 
> 2014-08-03 10:49 GMT+02:00 Even Rouault <even.rouault at mines-paris.org>:
> > Le samedi 02 ao?t 2014 23:48:54, Andrea Peri a ?crit :
> >> Hi,
> >> 
> >> I have transform many old tiff+tfw rasters using this gdal
> >> transformation:
> >> 
> >> gdal_translate -ot Byte -of GTiff -b 1 -a_nodata none -stats -co
> >> COMPRESS=NONE -co INTERLEAVE=PIXEL -co PROFILE=GDALGeoTIFF -co
> >> TILED=YES -co BLOCKXSIZE=256 -co BLOCKYSIZE=256 -co SPARSE_OK=TRUE -co
> >> TFW=NO filein.tif fileout.tif
> >> 
> >> They are wrking correctly with qgis and with mapserver for several
> >> months.
> >> 
> >> Now I need to use this geotiffs with another program.
> >> But this program say that these images are not realy GeoTiffs.
> >> 
> >> I test them using listgeos and have this result:
> >> 
> >> TIFFReadDirectory: Warning, Unknown field with tag 42112 (0xa480)
> >> 
> >> encountered. Geotiff_Information:
> >>    Version: 1
> >>    Key_Revision: 1.0
> >>    
> >>    Tagged_Information:
> >>       ModelTiepointTag (2,3):
> >>          0                0                0
> >>          559417.445637    4927786.430528   0
> >>       
> >>       ModelPixelScaleTag (1,3):
> >>          0.5              0.5              0
> >>       
> >>       End_Of_Tags.
> >>    
> >>    Keyed_Information:
> >>       End_Of_Keys.
> >>    
> >>    End_Of_Geotiff.
> >> 
> >> Some people say me that this is not a true geotiff because are missing
> >> several tags.
> >> I reported a supposed response from a real geotiff:
> >> 
> >> Geotiff_Information:
> >>     Version: 1
> >>     Key_Revision: 1.0
> >>     
> >>     Tagged_Information:
> >>        ModelTiepointTag (2,3):
> >>           0                 0                 0
> >>           673347            4298291           0
> >>        
> >>        ModelPixelScaleTag (1,3):
> >>           1                 1                 1
> >>        
> >>        End_Of_Tags.
> >>     
> >>     Keyed_Information:
> >>        GTModelTypeGeoKey (Short,1): ModelTypeProjected
> >>        GTRasterTypeGeoKey (Short,1): RasterPixelIsArea
> >>        GTCitationGeoKey (Ascii,37): "NAIP 2012
> >> 
> >> m_3808409_sw_16_1_20120607"
> >> 
> >>        ProjectedCSTypeGeoKey (Short,1): PCS_NAD83_UTM_zone_16N
> >>        PCSCitationGeoKey (Ascii,21): "NAD83 / UTM zone 16N"
> >>        ProjLinearUnitsGeoKey (Short,1): Linear_Meter
> >>        End_Of_Keys.
> >>     
> >>     End_Of_Geotiff.
> >> 
> >> PCS = 26916 (NAD83 / UTM zone 16N)
> >> Projection = 16016 (UTM zone 16N)
> >> Projection Method: CT_TransverseMercator
> >> 
> >>     ProjNatOriginLatGeoKey: 0.000000 (  0d 0' 0.00"N)
> >>     ProjNatOriginLongGeoKey: -87.000000 ( 87d 0' 0.00"W)
> >>     ProjScaleAtNatOriginGeoKey: 0.999600
> >>     ProjFalseEastingGeoKey: 500000.000000 m
> >>     ProjFalseNorthingGeoKey: 0.000000 m
> >> 
> >> GCS: 4269/NAD83
> >> Datum: 6269/North American Datum 1983
> >> Ellipsoid: 7019/GRS 1980 (6378137.00,6356752.31)
> >> Prime Meridian: 8901/Greenwich (0.000000/  0d 0' 0.00"E)
> >> Projection Linear Units: 9001/metre (1.000000m)
> >> 
> >> Corner Coordinates:
> >> Upper Left    (  673347.000, 4298291.000)  ( 85d 0'12.06"W,
> >> 38d48'58.87"N)
> >> Lower Left    (  673347.000, 4290632.000)  ( 85d 0'18.99"W,
> >> 38d44'50.54"N)
> >> Upper Right   (  679532.000, 4298291.000)  ( 84d55'55.75"W,
> >> 38d48'54.41"N)
> >> Lower Right   (  679532.000, 4290632.000)  ( 84d56' 2.92"W,
> >> 38d44'46.10"N)
> >> Center        (  676439.500, 4294461.500)  ( 84d58' 7.43"W,
> >> 38d46'52.50"N)
> >> 
> >> -----
> >> 
> >> I'm a bit confused.
> >> Because I have produced my GeoTiffs using gdal. And if it fail to
> >> produce a real geotiff I have a trouble.
> >> 
> >> So the main question is a geotiff ith only the tags reported a real
> >> geotiff ?
> > 
> > Andrea,
> > 
> > The difference between the 2 geotiff is that the first one does not have
> > information on the spatial reference system, but only the geotransform
> > that comes from the .tfw file.
> > Skimming quickly through the GeoTIFF specification (
> > http://www.remotesensing.org/geotiff/spec/contents.html ) doesn't
> > immediately show if it is valid or not, although it would be best if
> > readers are robust to missing information.
> > If you know the SRS of the maps, you can try adding -a_srs EPSG:XXXX or
> > -a_srs wkt_string.
> > You could also try -a_srs "LOCAL_CS[\"Unknown\"]" if you don't know the
> > SRS at all. This will write a few geotiff keys to define a unknown CRS,
> > but it is not obvious that your reader will like it.
> > 
> > Even
> > 
> > --
> > Geospatial professional services
> > http://even.rouault.free.fr/services.html

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From nixanz at nixanz.com  Sun Aug  3 03:35:08 2014
From: nixanz at nixanz.com (Nik Sands)
Date: Sun, 3 Aug 2014 20:35:08 +1000
Subject: [gdal-dev] Usage of styles in C API
In-Reply-To: <201408031226.03489.even.rouault@mines-paris.org>
References: <33534DE7-4774-43B7-BB19-C026601AE2F1@nixanz.com>
	<201408031226.03489.even.rouault@mines-paris.org>
Message-ID: <4855D0A0-0AFD-477F-8761-78B6F89C796D@nixanz.com>

On one of the iterations through this code, styleChars is:

	'vegetation_low: BRUSH(fc:#A0F0A0); LABEL(c:#004000,s:18pt,t:{title})'

So perhaps the inclusion of the style name is the problem?

This was read into a style table from a text file using 'OGR_STBL_LoadStyleTable()'.  I had assumed that a similar format to .ofs was suitable.  If this is not the case, how should I read a style table from a text file in such a way that I can distinguish the various styles by name?

In guess my more general question is:  What is the correct way to read styles from an arbitrary text file into a style table, and then use a style manager to get the various parts/tools?



On 3 Aug 2014, at 8:26 pm, Even Rouault <even.rouault at mines-paris.org> wrote:

> Le dimanche 03 ao?t 2014 12:11:42, Nik Sands a ?crit :
>> I'm just starting out using the styles features of OGR (using the C API)
>> but at struggling with a few elements of it.
>> 
>> My code (copied below) fails to get any OGRStyleToolH.  Ie, the "if ( tool
>> )" block never gets run, because 'tool' is always NULL at the point
>> indicated by the comment.  But the execution does reach that point in the
>> code which indicates that the OGRStyleMrgH does in fact include at least
>> one part (tool).
>> 
>> I'd be grateful if somebody could point out what I'm doing wrong.
> 
> Nothing strikes me as wrong. A potential explanation is that styleChars 
> doesn't contain a valid OGR Feature Style string.
> GetPartCount() counts the number of ";" separating style parts, but it doens't 
> check that each style part actually begins by a recognized tool name (PEN, 
> BRUSH, SYMBOL, LABEL). OGR_SM_GetPart() does this check however and if it 
> cannot recognize it it returns a NULL tool.
> 
>> 
>> Thanks,
>> Nik.
>> 
>> 
>> -------------------------------------------
>> 	const char *styleChars = OGR_STBL_GetNextStyle(table) ) )
>> 	NSString *styleName = [NSString
>> stringWithUTF8String:OGR_STBL_GetLastStyleName(table)]; OGRStyleMgrH
>> styleMgr = OGR_SM_Create(NULL);
>> 	OGR_SM_InitStyleString(styleMgr, styleChars);
>> 
>> 
>> 	for ( int i = 0; i < OGR_SM_GetPartCount(styleMgr, NULL); i++ )
>> 	{
>> 		OGRStyleToolH tool = OGR_SM_GetPart(styleMgr, i, NULL);
>> 
>> 		if ( tool )  //  'tool' always NULL here
>> 		{
>> 			switch ( OGR_ST_GetType(tool) )
>> 			{
>> 				case OGRSTCPen:
>> 					self.pen = tool;
>> 					break;
>> 
>> 				case OGRSTCBrush:
>> 					self.brush = tool;
>> 					break;
>> 
>> 				case OGRSTCSymbol:
>> 					self.symbol = tool;
>> 					break;
>> 
>> 				case OGRSTCLabel:
>> 					self.label = tool;
>> 					break;
>> 
>> 				default:
>> 					NSLog(@"Unknown style tool type!");
>> 					break;
>> 			}
>> 		}
>> 	}
>> -------------------------------------------
>> 
>> 
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> -- 
> Geospatial professional services
> http://even.rouault.free.fr/services.html


From nixanz at nixanz.com  Sun Aug  3 03:41:56 2014
From: nixanz at nixanz.com (Nik Sands)
Date: Sun, 3 Aug 2014 20:41:56 +1000
Subject: [gdal-dev] Usage of styles in C API
In-Reply-To: <4855D0A0-0AFD-477F-8761-78B6F89C796D@nixanz.com>
References: <33534DE7-4774-43B7-BB19-C026601AE2F1@nixanz.com>
	<201408031226.03489.even.rouault@mines-paris.org>
	<4855D0A0-0AFD-477F-8761-78B6F89C796D@nixanz.com>
Message-ID: <B273F00E-0120-4E9E-86BF-E71FAA5BB0C1@nixanz.com>

Sorry, my mistake... I had my logging in the wrong place.  styleChars is actually of the form (including the leading space):

	' PEN(c:#A08080,w:2pt); LABEL(c:#000000,s:18pt,t:{title})'


On 3 Aug 2014, at 8:35 pm, Nik Sands <nixanz at nixanz.com> wrote:

> On one of the iterations through this code, styleChars is:
> 
> 	'vegetation_low: BRUSH(fc:#A0F0A0); LABEL(c:#004000,s:18pt,t:{title})'
> 
> So perhaps the inclusion of the style name is the problem?
> 
> This was read into a style table from a text file using 'OGR_STBL_LoadStyleTable()'.  I had assumed that a similar format to .ofs was suitable.  If this is not the case, how should I read a style table from a text file in such a way that I can distinguish the various styles by name?
> 
> In guess my more general question is:  What is the correct way to read styles from an arbitrary text file into a style table, and then use a style manager to get the various parts/tools?
> 
> 
> 
> On 3 Aug 2014, at 8:26 pm, Even Rouault <even.rouault at mines-paris.org> wrote:
> 
>> Le dimanche 03 ao?t 2014 12:11:42, Nik Sands a ?crit :
>>> I'm just starting out using the styles features of OGR (using the C API)
>>> but at struggling with a few elements of it.
>>> 
>>> My code (copied below) fails to get any OGRStyleToolH.  Ie, the "if ( tool
>>> )" block never gets run, because 'tool' is always NULL at the point
>>> indicated by the comment.  But the execution does reach that point in the
>>> code which indicates that the OGRStyleMrgH does in fact include at least
>>> one part (tool).
>>> 
>>> I'd be grateful if somebody could point out what I'm doing wrong.
>> 
>> Nothing strikes me as wrong. A potential explanation is that styleChars 
>> doesn't contain a valid OGR Feature Style string.
>> GetPartCount() counts the number of ";" separating style parts, but it doens't 
>> check that each style part actually begins by a recognized tool name (PEN, 
>> BRUSH, SYMBOL, LABEL). OGR_SM_GetPart() does this check however and if it 
>> cannot recognize it it returns a NULL tool.
>> 
>>> 
>>> Thanks,
>>> Nik.
>>> 
>>> 
>>> -------------------------------------------
>>> 	const char *styleChars = OGR_STBL_GetNextStyle(table) ) )
>>> 	NSString *styleName = [NSString
>>> stringWithUTF8String:OGR_STBL_GetLastStyleName(table)]; OGRStyleMgrH
>>> styleMgr = OGR_SM_Create(NULL);
>>> 	OGR_SM_InitStyleString(styleMgr, styleChars);
>>> 
>>> 
>>> 	for ( int i = 0; i < OGR_SM_GetPartCount(styleMgr, NULL); i++ )
>>> 	{
>>> 		OGRStyleToolH tool = OGR_SM_GetPart(styleMgr, i, NULL);
>>> 
>>> 		if ( tool )  //  'tool' always NULL here
>>> 		{
>>> 			switch ( OGR_ST_GetType(tool) )
>>> 			{
>>> 				case OGRSTCPen:
>>> 					self.pen = tool;
>>> 					break;
>>> 
>>> 				case OGRSTCBrush:
>>> 					self.brush = tool;
>>> 					break;
>>> 
>>> 				case OGRSTCSymbol:
>>> 					self.symbol = tool;
>>> 					break;
>>> 
>>> 				case OGRSTCLabel:
>>> 					self.label = tool;
>>> 					break;
>>> 
>>> 				default:
>>> 					NSLog(@"Unknown style tool type!");
>>> 					break;
>>> 			}
>>> 		}
>>> 	}
>>> -------------------------------------------
>>> 
>>> 
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>> 
>> -- 
>> Geospatial professional services
>> http://even.rouault.free.fr/services.html
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From even.rouault at mines-paris.org  Sun Aug  3 03:45:28 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sun, 3 Aug 2014 12:45:28 +0200
Subject: [gdal-dev] Usage of styles in C API
In-Reply-To: <B273F00E-0120-4E9E-86BF-E71FAA5BB0C1@nixanz.com>
References: <33534DE7-4774-43B7-BB19-C026601AE2F1@nixanz.com>
	<4855D0A0-0AFD-477F-8761-78B6F89C796D@nixanz.com>
	<B273F00E-0120-4E9E-86BF-E71FAA5BB0C1@nixanz.com>
Message-ID: <201408031245.28152.even.rouault@mines-paris.org>

Le dimanche 03 ao?t 2014 12:41:56, Nik Sands a ?crit :
> Sorry, my mistake... I had my logging in the wrong place.  styleChars is
> actually of the form (including the leading space):
> 
> 	' PEN(c:#A08080,w:2pt); LABEL(c:#000000,s:18pt,t:{title})'

The issue must be the leading space before PEN, and potentially LABEL too.

> 
> On 3 Aug 2014, at 8:35 pm, Nik Sands <nixanz at nixanz.com> wrote:
> > On one of the iterations through this code, styleChars is:
> > 	'vegetation_low: BRUSH(fc:#A0F0A0); LABEL(c:#004000,s:18pt,t:{title})'
> > 
> > So perhaps the inclusion of the style name is the problem?
> > 
> > This was read into a style table from a text file using
> > 'OGR_STBL_LoadStyleTable()'.  I had assumed that a similar format to
> > .ofs was suitable.  If this is not the case, how should I read a style
> > table from a text file in such a way that I can distinguish the various
> > styles by name?
> > 
> > In guess my more general question is:  What is the correct way to read
> > styles from an arbitrary text file into a style table, and then use a
> > style manager to get the various parts/tools?
> > 
> > On 3 Aug 2014, at 8:26 pm, Even Rouault <even.rouault at mines-paris.org> 
wrote:
> >> Le dimanche 03 ao?t 2014 12:11:42, Nik Sands a ?crit :
> >>> I'm just starting out using the styles features of OGR (using the C
> >>> API) but at struggling with a few elements of it.
> >>> 
> >>> My code (copied below) fails to get any OGRStyleToolH.  Ie, the "if (
> >>> tool )" block never gets run, because 'tool' is always NULL at the
> >>> point indicated by the comment.  But the execution does reach that
> >>> point in the code which indicates that the OGRStyleMrgH does in fact
> >>> include at least one part (tool).
> >>> 
> >>> I'd be grateful if somebody could point out what I'm doing wrong.
> >> 
> >> Nothing strikes me as wrong. A potential explanation is that styleChars
> >> doesn't contain a valid OGR Feature Style string.
> >> GetPartCount() counts the number of ";" separating style parts, but it
> >> doens't check that each style part actually begins by a recognized tool
> >> name (PEN, BRUSH, SYMBOL, LABEL). OGR_SM_GetPart() does this check
> >> however and if it cannot recognize it it returns a NULL tool.
> >> 
> >>> Thanks,
> >>> Nik.
> >>> 
> >>> 
> >>> -------------------------------------------
> >>> 
> >>> 	const char *styleChars = OGR_STBL_GetNextStyle(table) ) )
> >>> 	NSString *styleName = [NSString
> >>> 
> >>> stringWithUTF8String:OGR_STBL_GetLastStyleName(table)]; OGRStyleMgrH
> >>> styleMgr = OGR_SM_Create(NULL);
> >>> 
> >>> 	OGR_SM_InitStyleString(styleMgr, styleChars);
> >>> 	
> >>> 	
> >>> 	for ( int i = 0; i < OGR_SM_GetPartCount(styleMgr, NULL); i++ )
> >>> 	{
> >>> 	
> >>> 		OGRStyleToolH tool = OGR_SM_GetPart(styleMgr, i, NULL);
> >>> 		
> >>> 		if ( tool )  //  'tool' always NULL here
> >>> 		{
> >>> 		
> >>> 			switch ( OGR_ST_GetType(tool) )
> >>> 			{
> >>> 			
> >>> 				case OGRSTCPen:
> >>> 					self.pen = tool;
> >>> 					break;
> >>> 				
> >>> 				case OGRSTCBrush:
> >>> 					self.brush = tool;
> >>> 					break;
> >>> 				
> >>> 				case OGRSTCSymbol:
> >>> 					self.symbol = tool;
> >>> 					break;
> >>> 				
> >>> 				case OGRSTCLabel:
> >>> 					self.label = tool;
> >>> 					break;
> >>> 				
> >>> 				default:
> >>> 					NSLog(@"Unknown style tool type!");
> >>> 					break;
> >>> 			
> >>> 			}
> >>> 		
> >>> 		}
> >>> 	
> >>> 	}
> >>> 
> >>> -------------------------------------------
> >>> 
> >>> 
> >>> _______________________________________________
> >>> gdal-dev mailing list
> >>> gdal-dev at lists.osgeo.org
> >>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > 
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From nixanz at nixanz.com  Sun Aug  3 03:55:44 2014
From: nixanz at nixanz.com (Nik Sands)
Date: Sun, 3 Aug 2014 20:55:44 +1000
Subject: [gdal-dev] Usage of styles in C API
In-Reply-To: <201408031245.28152.even.rouault@mines-paris.org>
References: <33534DE7-4774-43B7-BB19-C026601AE2F1@nixanz.com>
	<4855D0A0-0AFD-477F-8761-78B6F89C796D@nixanz.com>
	<B273F00E-0120-4E9E-86BF-E71FAA5BB0C1@nixanz.com>
	<201408031245.28152.even.rouault@mines-paris.org>
Message-ID: <58C90D24-060F-4FBE-9193-C8A21011158F@nixanz.com>

Thanks Even,

Yes, deleting the spaces seems to get it working correctly.  Is this expected?  Are spaces an illegal part of a style string?

The documentation includes spaces in the example .ofs file there, so I had copied that format when creating my text file.

Cheers,
Nik.


On 3 Aug 2014, at 8:45 pm, Even Rouault <even.rouault at mines-paris.org> wrote:

> Le dimanche 03 ao?t 2014 12:41:56, Nik Sands a ?crit :
>> Sorry, my mistake... I had my logging in the wrong place.  styleChars is
>> actually of the form (including the leading space):
>> 
>> 	' PEN(c:#A08080,w:2pt); LABEL(c:#000000,s:18pt,t:{title})'
> 
> The issue must be the leading space before PEN, and potentially LABEL too.
> 
>> 
>> On 3 Aug 2014, at 8:35 pm, Nik Sands <nixanz at nixanz.com> wrote:
>>> On one of the iterations through this code, styleChars is:
>>> 	'vegetation_low: BRUSH(fc:#A0F0A0); LABEL(c:#004000,s:18pt,t:{title})'
>>> 
>>> So perhaps the inclusion of the style name is the problem?
>>> 
>>> This was read into a style table from a text file using
>>> 'OGR_STBL_LoadStyleTable()'.  I had assumed that a similar format to
>>> .ofs was suitable.  If this is not the case, how should I read a style
>>> table from a text file in such a way that I can distinguish the various
>>> styles by name?
>>> 
>>> In guess my more general question is:  What is the correct way to read
>>> styles from an arbitrary text file into a style table, and then use a
>>> style manager to get the various parts/tools?
>>> 
>>> On 3 Aug 2014, at 8:26 pm, Even Rouault <even.rouault at mines-paris.org> 
> wrote:
>>>> Le dimanche 03 ao?t 2014 12:11:42, Nik Sands a ?crit :
>>>>> I'm just starting out using the styles features of OGR (using the C
>>>>> API) but at struggling with a few elements of it.
>>>>> 
>>>>> My code (copied below) fails to get any OGRStyleToolH.  Ie, the "if (
>>>>> tool )" block never gets run, because 'tool' is always NULL at the
>>>>> point indicated by the comment.  But the execution does reach that
>>>>> point in the code which indicates that the OGRStyleMrgH does in fact
>>>>> include at least one part (tool).
>>>>> 
>>>>> I'd be grateful if somebody could point out what I'm doing wrong.
>>>> 
>>>> Nothing strikes me as wrong. A potential explanation is that styleChars
>>>> doesn't contain a valid OGR Feature Style string.
>>>> GetPartCount() counts the number of ";" separating style parts, but it
>>>> doens't check that each style part actually begins by a recognized tool
>>>> name (PEN, BRUSH, SYMBOL, LABEL). OGR_SM_GetPart() does this check
>>>> however and if it cannot recognize it it returns a NULL tool.
>>>> 
>>>>> Thanks,
>>>>> Nik.
>>>>> 
>>>>> 
>>>>> -------------------------------------------
>>>>> 
>>>>> 	const char *styleChars = OGR_STBL_GetNextStyle(table) ) )
>>>>> 	NSString *styleName = [NSString
>>>>> 
>>>>> stringWithUTF8String:OGR_STBL_GetLastStyleName(table)]; OGRStyleMgrH
>>>>> styleMgr = OGR_SM_Create(NULL);
>>>>> 
>>>>> 	OGR_SM_InitStyleString(styleMgr, styleChars);
>>>>> 	
>>>>> 	
>>>>> 	for ( int i = 0; i < OGR_SM_GetPartCount(styleMgr, NULL); i++ )
>>>>> 	{
>>>>> 	
>>>>> 		OGRStyleToolH tool = OGR_SM_GetPart(styleMgr, i, NULL);
>>>>> 		
>>>>> 		if ( tool )  //  'tool' always NULL here
>>>>> 		{
>>>>> 		
>>>>> 			switch ( OGR_ST_GetType(tool) )
>>>>> 			{
>>>>> 			
>>>>> 				case OGRSTCPen:
>>>>> 					self.pen = tool;
>>>>> 					break;
>>>>> 				
>>>>> 				case OGRSTCBrush:
>>>>> 					self.brush = tool;
>>>>> 					break;
>>>>> 				
>>>>> 				case OGRSTCSymbol:
>>>>> 					self.symbol = tool;
>>>>> 					break;
>>>>> 				
>>>>> 				case OGRSTCLabel:
>>>>> 					self.label = tool;
>>>>> 					break;
>>>>> 				
>>>>> 				default:
>>>>> 					NSLog(@"Unknown style tool type!");
>>>>> 					break;
>>>>> 			
>>>>> 			}
>>>>> 		
>>>>> 		}
>>>>> 	
>>>>> 	}
>>>>> 
>>>>> -------------------------------------------
>>>>> 
>>>>> 
>>>>> _______________________________________________
>>>>> gdal-dev mailing list
>>>>> gdal-dev at lists.osgeo.org
>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>> 
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> -- 
> Geospatial professional services
> http://even.rouault.free.fr/services.html


From even.rouault at mines-paris.org  Sun Aug  3 04:07:01 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sun, 3 Aug 2014 13:07:01 +0200
Subject: [gdal-dev] Usage of styles in C API
In-Reply-To: <CAMKgpOYEbLZKOBtXp62BGFV_zKxWO8mVAw36nL1Kp6XNTrUX9g@mail.gmail.com>
References: <33534DE7-4774-43B7-BB19-C026601AE2F1@nixanz.com>
	<201408031245.28152.even.rouault@mines-paris.org>
	<CAMKgpOYEbLZKOBtXp62BGFV_zKxWO8mVAw36nL1Kp6XNTrUX9g@mail.gmail.com>
Message-ID: <201408031307.01436.even.rouault@mines-paris.org>

Le dimanche 03 ao?t 2014 12:53:00, Chaitanya kumar CH a ?crit :
> I'll add these checks to the method that reads the ofs file. Ticket #5602

You mean a check to reject those lines or to accept them and ignore the 
leading spaces ?

Make sure to extend autotest/ogr/ogr_style.py that I had initiated when 
mapping the OGR_STBL_ methods to SWIG.

> 
> On 3 Aug 2014 16:15, "Even Rouault" <even.rouault at mines-paris.org> wrote:
> > Le dimanche 03 ao?t 2014 12:41:56, Nik Sands a ?crit :
> > > Sorry, my mistake... I had my logging in the wrong place.  styleChars
> > > is
> > > 
> > > actually of the form (including the leading space):
> > >       ' PEN(c:#A08080,w:2pt); LABEL(c:#000000,s:18pt,t:{title})'
> > 
> > The issue must be the leading space before PEN, and potentially LABEL
> > too.
> > 
> > > On 3 Aug 2014, at 8:35 pm, Nik Sands <nixanz at nixanz.com> wrote:
> > > > On one of the iterations through this code, styleChars is:
> > > >     'vegetation_low: BRUSH(fc:#A0F0A0);
> > 
> > LABEL(c:#004000,s:18pt,t:{title})'
> > 
> > > > So perhaps the inclusion of the style name is the problem?
> > > > 
> > > > This was read into a style table from a text file using
> > > > 'OGR_STBL_LoadStyleTable()'.  I had assumed that a similar format to
> > > > .ofs was suitable.  If this is not the case, how should I read a
> > > > style table from a text file in such a way that I can distinguish
> > > > the various styles by name?
> > > > 
> > > > In guess my more general question is:  What is the correct way to
> > > > read styles from an arbitrary text file into a style table, and then
> > > > use a style manager to get the various parts/tools?
> > > > 
> > > > On 3 Aug 2014, at 8:26 pm, Even Rouault
> > > > <even.rouault at mines-paris.org>
> > 
> > wrote:
> > > >> Le dimanche 03 ao?t 2014 12:11:42, Nik Sands a ?crit :
> > > >>> I'm just starting out using the styles features of OGR (using the C
> > > >>> API) but at struggling with a few elements of it.
> > > >>> 
> > > >>> My code (copied below) fails to get any OGRStyleToolH.  Ie, the "if
> > > >>> ( tool )" block never gets run, because 'tool' is always NULL at
> > > >>> the point indicated by the comment.  But the execution does reach
> > > >>> that point in the code which indicates that the OGRStyleMrgH does
> > > >>> in fact include at least one part (tool).
> > > >>> 
> > > >>> I'd be grateful if somebody could point out what I'm doing wrong.
> > > >> 
> > > >> Nothing strikes me as wrong. A potential explanation is that
> > 
> > styleChars
> > 
> > > >> doesn't contain a valid OGR Feature Style string.
> > > >> GetPartCount() counts the number of ";" separating style parts, but
> > > >> it doens't check that each style part actually begins by a
> > > >> recognized
> > 
> > tool
> > 
> > > >> name (PEN, BRUSH, SYMBOL, LABEL). OGR_SM_GetPart() does this check
> > > >> however and if it cannot recognize it it returns a NULL tool.
> > > >> 
> > > >>> Thanks,
> > > >>> Nik.
> > > >>> 
> > > >>> 
> > > >>> -------------------------------------------
> > > >>> 
> > > >>>   const char *styleChars = OGR_STBL_GetNextStyle(table) ) )
> > > >>>   NSString *styleName = [NSString
> > > >>> 
> > > >>> stringWithUTF8String:OGR_STBL_GetLastStyleName(table)];
> > > >>> OGRStyleMgrH styleMgr = OGR_SM_Create(NULL);
> > > >>> 
> > > >>>   OGR_SM_InitStyleString(styleMgr, styleChars);
> > > >>>   
> > > >>>   
> > > >>>   for ( int i = 0; i < OGR_SM_GetPartCount(styleMgr, NULL); i++ )
> > > >>>   {
> > > >>>   
> > > >>>           OGRStyleToolH tool = OGR_SM_GetPart(styleMgr, i, NULL);
> > > >>>           
> > > >>>           if ( tool )  //  'tool' always NULL here
> > > >>>           {
> > > >>>           
> > > >>>                   switch ( OGR_ST_GetType(tool) )
> > > >>>                   {
> > > >>>                   
> > > >>>                           case OGRSTCPen:
> > > >>>                                   self.pen = tool;
> > > >>>                                   break;
> > > >>>                           
> > > >>>                           case OGRSTCBrush:
> > > >>>                                   self.brush = tool;
> > > >>>                                   break;
> > > >>>                           
> > > >>>                           case OGRSTCSymbol:
> > > >>>                                   self.symbol = tool;
> > > >>>                                   break;
> > > >>>                           
> > > >>>                           case OGRSTCLabel:
> > > >>>                                   self.label = tool;
> > > >>>                                   break;
> > > >>>                           
> > > >>>                           default:
> > > >>>                                   NSLog(@"Unknown style tool
> > > >>>                                   type!"); break;
> > > >>>                   
> > > >>>                   }
> > > >>>           
> > > >>>           }
> > > >>>   
> > > >>>   }
> > > >>> 
> > > >>> -------------------------------------------
> > > >>> 
> > > >>> 
> > > >>> _______________________________________________
> > > >>> gdal-dev mailing list
> > > >>> gdal-dev at lists.osgeo.org
> > > >>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > > > 
> > > > _______________________________________________
> > > > gdal-dev mailing list
> > > > gdal-dev at lists.osgeo.org
> > > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > 
> > --
> > Geospatial professional services
> > http://even.rouault.free.fr/services.html
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Sun Aug  3 04:09:40 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sun, 3 Aug 2014 13:09:40 +0200
Subject: [gdal-dev] Usage of styles in C API
In-Reply-To: <58C90D24-060F-4FBE-9193-C8A21011158F@nixanz.com>
References: <33534DE7-4774-43B7-BB19-C026601AE2F1@nixanz.com>
	<201408031245.28152.even.rouault@mines-paris.org>
	<58C90D24-060F-4FBE-9193-C8A21011158F@nixanz.com>
Message-ID: <201408031309.40352.even.rouault@mines-paris.org>

Le dimanche 03 ao?t 2014 12:55:44, Nik Sands a ?crit :
> Thanks Even,
> 
> Yes, deleting the spaces seems to get it working correctly.  Is this
> expected?  Are spaces an illegal part of a style string?
> 
> The documentation includes spaces in the example .ofs file there, so I had
> copied that format when creating my text file.

I guess we should be tolerant with spaces. The grammar of the style string 
itself seems to indicate that no spaces are expected in the style_def itself. 
But the format of the .ofs file is not really well defined.

Perhaps Chaitanya will take care of that. See previous email.

> 
> Cheers,
> Nik.
> 
> On 3 Aug 2014, at 8:45 pm, Even Rouault <even.rouault at mines-paris.org> 
wrote:
> > Le dimanche 03 ao?t 2014 12:41:56, Nik Sands a ?crit :
> >> Sorry, my mistake... I had my logging in the wrong place.  styleChars is
> >> 
> >> actually of the form (including the leading space):
> >> 	' PEN(c:#A08080,w:2pt); LABEL(c:#000000,s:18pt,t:{title})'
> > 
> > The issue must be the leading space before PEN, and potentially LABEL
> > too.
> > 
> >> On 3 Aug 2014, at 8:35 pm, Nik Sands <nixanz at nixanz.com> wrote:
> >>> On one of the iterations through this code, styleChars is:
> >>> 	'vegetation_low: BRUSH(fc:#A0F0A0); LABEL(c:#004000,s:18pt,t:
{title})'
> >>> 
> >>> So perhaps the inclusion of the style name is the problem?
> >>> 
> >>> This was read into a style table from a text file using
> >>> 'OGR_STBL_LoadStyleTable()'.  I had assumed that a similar format to
> >>> .ofs was suitable.  If this is not the case, how should I read a style
> >>> table from a text file in such a way that I can distinguish the various
> >>> styles by name?
> >>> 
> >>> In guess my more general question is:  What is the correct way to read
> >>> styles from an arbitrary text file into a style table, and then use a
> >>> style manager to get the various parts/tools?
> >>> 
> >>> On 3 Aug 2014, at 8:26 pm, Even Rouault <even.rouault at mines-paris.org>
> > 
> > wrote:
> >>>> Le dimanche 03 ao?t 2014 12:11:42, Nik Sands a ?crit :
> >>>>> I'm just starting out using the styles features of OGR (using the C
> >>>>> API) but at struggling with a few elements of it.
> >>>>> 
> >>>>> My code (copied below) fails to get any OGRStyleToolH.  Ie, the "if (
> >>>>> tool )" block never gets run, because 'tool' is always NULL at the
> >>>>> point indicated by the comment.  But the execution does reach that
> >>>>> point in the code which indicates that the OGRStyleMrgH does in fact
> >>>>> include at least one part (tool).
> >>>>> 
> >>>>> I'd be grateful if somebody could point out what I'm doing wrong.
> >>>> 
> >>>> Nothing strikes me as wrong. A potential explanation is that
> >>>> styleChars doesn't contain a valid OGR Feature Style string.
> >>>> GetPartCount() counts the number of ";" separating style parts, but it
> >>>> doens't check that each style part actually begins by a recognized
> >>>> tool name (PEN, BRUSH, SYMBOL, LABEL). OGR_SM_GetPart() does this
> >>>> check however and if it cannot recognize it it returns a NULL tool.
> >>>> 
> >>>>> Thanks,
> >>>>> Nik.
> >>>>> 
> >>>>> 
> >>>>> -------------------------------------------
> >>>>> 
> >>>>> 	const char *styleChars = OGR_STBL_GetNextStyle(table) ) )
> >>>>> 	NSString *styleName = [NSString
> >>>>> 
> >>>>> stringWithUTF8String:OGR_STBL_GetLastStyleName(table)]; OGRStyleMgrH
> >>>>> styleMgr = OGR_SM_Create(NULL);
> >>>>> 
> >>>>> 	OGR_SM_InitStyleString(styleMgr, styleChars);
> >>>>> 	
> >>>>> 	
> >>>>> 	for ( int i = 0; i < OGR_SM_GetPartCount(styleMgr, NULL); i++ )
> >>>>> 	{
> >>>>> 	
> >>>>> 		OGRStyleToolH tool = OGR_SM_GetPart(styleMgr, i, NULL);
> >>>>> 		
> >>>>> 		if ( tool )  //  'tool' always NULL here
> >>>>> 		{
> >>>>> 		
> >>>>> 			switch ( OGR_ST_GetType(tool) )
> >>>>> 			{
> >>>>> 			
> >>>>> 				case OGRSTCPen:
> >>>>> 					self.pen = tool;
> >>>>> 					break;
> >>>>> 				
> >>>>> 				case OGRSTCBrush:
> >>>>> 					self.brush = tool;
> >>>>> 					break;
> >>>>> 				
> >>>>> 				case OGRSTCSymbol:
> >>>>> 					self.symbol = tool;
> >>>>> 					break;
> >>>>> 				
> >>>>> 				case OGRSTCLabel:
> >>>>> 					self.label = tool;
> >>>>> 					break;
> >>>>> 				
> >>>>> 				default:
> >>>>> 					NSLog(@"Unknown style tool type!");
> >>>>> 					break;
> >>>>> 			
> >>>>> 			}
> >>>>> 		
> >>>>> 		}
> >>>>> 	
> >>>>> 	}
> >>>>> 
> >>>>> -------------------------------------------
> >>>>> 
> >>>>> 
> >>>>> _______________________________________________
> >>>>> gdal-dev mailing list
> >>>>> gdal-dev at lists.osgeo.org
> >>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >>> 
> >>> _______________________________________________
> >>> gdal-dev mailing list
> >>> gdal-dev at lists.osgeo.org
> >>> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From chaitanya.ch at gmail.com  Sun Aug  3 04:52:27 2014
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Sun, 3 Aug 2014 17:22:27 +0530
Subject: [gdal-dev] Usage of styles in C API
In-Reply-To: <201408031309.40352.even.rouault@mines-paris.org>
References: <33534DE7-4774-43B7-BB19-C026601AE2F1@nixanz.com>
	<201408031245.28152.even.rouault@mines-paris.org>
	<58C90D24-060F-4FBE-9193-C8A21011158F@nixanz.com>
	<201408031309.40352.even.rouault@mines-paris.org>
Message-ID: <CAMKgpObpC+b=sTwiU_gRRQc6AqCzpazm_AA8xLULZ0bxaMkCOQ@mail.gmail.com>

With Nik available for testing, I can update the style table definition.
On 3 Aug 2014 16:39, "Even Rouault" <even.rouault at mines-paris.org> wrote:

> Le dimanche 03 ao?t 2014 12:55:44, Nik Sands a ?crit :
> > Thanks Even,
> >
> > Yes, deleting the spaces seems to get it working correctly.  Is this
> > expected?  Are spaces an illegal part of a style string?
> >
> > The documentation includes spaces in the example .ofs file there, so I
> had
> > copied that format when creating my text file.
>
> I guess we should be tolerant with spaces. The grammar of the style string
> itself seems to indicate that no spaces are expected in the style_def
> itself.
> But the format of the .ofs file is not really well defined.
>
> Perhaps Chaitanya will take care of that. See previous email.
>
> >
> > Cheers,
> > Nik.
> >
> > On 3 Aug 2014, at 8:45 pm, Even Rouault <even.rouault at mines-paris.org>
> wrote:
> > > Le dimanche 03 ao?t 2014 12:41:56, Nik Sands a ?crit :
> > >> Sorry, my mistake... I had my logging in the wrong place.  styleChars
> is
> > >>
> > >> actually of the form (including the leading space):
> > >>    ' PEN(c:#A08080,w:2pt); LABEL(c:#000000,s:18pt,t:{title})'
> > >
> > > The issue must be the leading space before PEN, and potentially LABEL
> > > too.
> > >
> > >> On 3 Aug 2014, at 8:35 pm, Nik Sands <nixanz at nixanz.com> wrote:
> > >>> On one of the iterations through this code, styleChars is:
> > >>>   'vegetation_low: BRUSH(fc:#A0F0A0); LABEL(c:#004000,s:18pt,t:
> {title})'
> > >>>
> > >>> So perhaps the inclusion of the style name is the problem?
> > >>>
> > >>> This was read into a style table from a text file using
> > >>> 'OGR_STBL_LoadStyleTable()'.  I had assumed that a similar format to
> > >>> .ofs was suitable.  If this is not the case, how should I read a
> style
> > >>> table from a text file in such a way that I can distinguish the
> various
> > >>> styles by name?
> > >>>
> > >>> In guess my more general question is:  What is the correct way to
> read
> > >>> styles from an arbitrary text file into a style table, and then use a
> > >>> style manager to get the various parts/tools?
> > >>>
> > >>> On 3 Aug 2014, at 8:26 pm, Even Rouault <
> even.rouault at mines-paris.org>
> > >
> > > wrote:
> > >>>> Le dimanche 03 ao?t 2014 12:11:42, Nik Sands a ?crit :
> > >>>>> I'm just starting out using the styles features of OGR (using the C
> > >>>>> API) but at struggling with a few elements of it.
> > >>>>>
> > >>>>> My code (copied below) fails to get any OGRStyleToolH.  Ie, the
> "if (
> > >>>>> tool )" block never gets run, because 'tool' is always NULL at the
> > >>>>> point indicated by the comment.  But the execution does reach that
> > >>>>> point in the code which indicates that the OGRStyleMrgH does in
> fact
> > >>>>> include at least one part (tool).
> > >>>>>
> > >>>>> I'd be grateful if somebody could point out what I'm doing wrong.
> > >>>>
> > >>>> Nothing strikes me as wrong. A potential explanation is that
> > >>>> styleChars doesn't contain a valid OGR Feature Style string.
> > >>>> GetPartCount() counts the number of ";" separating style parts, but
> it
> > >>>> doens't check that each style part actually begins by a recognized
> > >>>> tool name (PEN, BRUSH, SYMBOL, LABEL). OGR_SM_GetPart() does this
> > >>>> check however and if it cannot recognize it it returns a NULL tool.
> > >>>>
> > >>>>> Thanks,
> > >>>>> Nik.
> > >>>>>
> > >>>>>
> > >>>>> -------------------------------------------
> > >>>>>
> > >>>>>         const char *styleChars = OGR_STBL_GetNextStyle(table) ) )
> > >>>>>         NSString *styleName = [NSString
> > >>>>>
> > >>>>> stringWithUTF8String:OGR_STBL_GetLastStyleName(table)];
> OGRStyleMgrH
> > >>>>> styleMgr = OGR_SM_Create(NULL);
> > >>>>>
> > >>>>>         OGR_SM_InitStyleString(styleMgr, styleChars);
> > >>>>>
> > >>>>>
> > >>>>>         for ( int i = 0; i < OGR_SM_GetPartCount(styleMgr, NULL);
> i++ )
> > >>>>>         {
> > >>>>>
> > >>>>>                 OGRStyleToolH tool = OGR_SM_GetPart(styleMgr, i,
> NULL);
> > >>>>>
> > >>>>>                 if ( tool )  //  'tool' always NULL here
> > >>>>>                 {
> > >>>>>
> > >>>>>                         switch ( OGR_ST_GetType(tool) )
> > >>>>>                         {
> > >>>>>
> > >>>>>                                 case OGRSTCPen:
> > >>>>>                                         self.pen = tool;
> > >>>>>                                         break;
> > >>>>>
> > >>>>>                                 case OGRSTCBrush:
> > >>>>>                                         self.brush = tool;
> > >>>>>                                         break;
> > >>>>>
> > >>>>>                                 case OGRSTCSymbol:
> > >>>>>                                         self.symbol = tool;
> > >>>>>                                         break;
> > >>>>>
> > >>>>>                                 case OGRSTCLabel:
> > >>>>>                                         self.label = tool;
> > >>>>>                                         break;
> > >>>>>
> > >>>>>                                 default:
> > >>>>>                                         NSLog(@"Unknown style tool
> type!");
> > >>>>>                                         break;
> > >>>>>
> > >>>>>                         }
> > >>>>>
> > >>>>>                 }
> > >>>>>
> > >>>>>         }
> > >>>>>
> > >>>>> -------------------------------------------
> > >>>>>
> > >>>>>
> > >>>>> _______________________________________________
> > >>>>> gdal-dev mailing list
> > >>>>> gdal-dev at lists.osgeo.org
> > >>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > >>>
> > >>> _______________________________________________
> > >>> gdal-dev mailing list
> > >>> gdal-dev at lists.osgeo.org
> > >>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140803/6d202204/attachment-0001.html>

From landa.martin at gmail.com  Mon Aug  4 00:06:22 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Mon, 4 Aug 2014 09:06:22 +0200
Subject: [gdal-dev] export to postgis, ogc_fid_seq
In-Reply-To: <201408031030.14733.even.rouault@mines-paris.org>
References: <CA+Ei1Ofm-R5S7FyPgTqyeXv6SvaxLUnJTaEf6vABRJ75Hyct3w@mail.gmail.com>
	<201408031030.14733.even.rouault@mines-paris.org>
Message-ID: <CA+Ei1OdZWqhXBZDeuZuwZU5DLN2sJZy4nDdJVQWYKZdCPG4uWw@mail.gmail.com>

Hi,

2014-08-03 10:30 GMT+02:00 Even Rouault <even.rouault at mines-paris.org>:

> Does your script explicitely set the FID before calling CreateFeature() ? If

[...]

right,

> You likely need to explicitely call setval()

I will update my script accordingly. Thanks, Martin

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From landa.martin at gmail.com  Mon Aug  4 02:02:41 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Mon, 4 Aug 2014 11:02:41 +0200
Subject: [gdal-dev] feature.clone() -> same featuredefn
In-Reply-To: <201408022218.05496.even.rouault@mines-paris.org>
References: <CA+Ei1Odc0VtXz-hj=zEd+KNoa+O9C=qKCLdwZTJud89xA1kTpQ@mail.gmail.com>
	<201408022203.14325.even.rouault@mines-paris.org>
	<CA+Ei1OeWBuA8Ovn-jwWuwDnwtSLUKd6tUR=dBbtgxeR4bvaZfg@mail.gmail.com>
	<201408022218.05496.even.rouault@mines-paris.org>
Message-ID: <CA+Ei1OfzYneH26aZb2znQExVpEpPU0NXZ2CRTaWyRatBA=pnaA@mail.gmail.com>

Hi Even,

2014-08-02 22:18 GMT+02:00 Even Rouault <even.rouault at mines-paris.org>:

[...]

>> 1) copy features from input layer to output layer
>> 2) modify features in output layer (remove some geometry columns)
>
> You can use the SetFrom() method.

thanks for hint, I found out that input and output layer somehow share
FeatureDefn. Here is sample code:

"""
    # create new layer
    olayer = ods.CreateLayer(layerName, ilayer.GetSpatialRef(),
                             geom_type, options)

    if not olayer:
        fatal("Unable to create layer '%'" % layerName)

    # create attributes
    feat_defn = ilayer.GetLayerDefn()
    for i in range(feat_defn.GetFieldCount()):
        olayer.CreateField(feat_defn.GetFieldDefn(i))

    # create also geometry attributes
    if not geom_name and \
            olayer.TestCapability(ogr.OLCCreateGeomField):
        for i in range(feat_defn.GetGeomFieldCount()):
            geom_defn = feat_defn.GetGeomFieldDefn(i)
            if geom_name and geom_defn.GetName() != geom_name:
                continue
            olayer.CreateGeomField(feat_defn.GetGeomFieldDefn(i))

    print
    print ilayer, ilayer.GetLayerDefn()
    print olayer, olayer.GetLayerDefn()
"""

prints

<osgeo.ogr.Layer; proxy of <Swig Object of type 'OGRLayerShadow *' at
0x7fbf0d95f930> > <osgeo.ogr.FeatureDefn; proxy of <Swig Object of
type 'OGRFeatureDefnShadow *' at 0x7fbf0d95fae0> >
<osgeo.ogr.Layer; proxy of <Swig Object of type 'OGRLayerShadow *' at
0x7fbf0d95fba0> > <osgeo.ogr.FeatureDefn; proxy of <Swig Object of
type 'OGRFeatureDefnShadow *' at 0x7fbf0d95fae0> >

I am not sure why... Thanks for clarification in advance, Martin

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From even.rouault at mines-paris.org  Mon Aug  4 02:24:01 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 4 Aug 2014 11:24:01 +0200
Subject: [gdal-dev] feature.clone() -> same featuredefn
In-Reply-To: <CA+Ei1OfzYneH26aZb2znQExVpEpPU0NXZ2CRTaWyRatBA=pnaA@mail.gmail.com>
References: <CA+Ei1Odc0VtXz-hj=zEd+KNoa+O9C=qKCLdwZTJud89xA1kTpQ@mail.gmail.com>
	<201408022218.05496.even.rouault@mines-paris.org>
	<CA+Ei1OfzYneH26aZb2znQExVpEpPU0NXZ2CRTaWyRatBA=pnaA@mail.gmail.com>
Message-ID: <201408041124.02079.even.rouault@mines-paris.org>

Le lundi 04 ao?t 2014 11:02:41, Martin Landa a ?crit :
> Hi Even,
> 
> 2014-08-02 22:18 GMT+02:00 Even Rouault <even.rouault at mines-paris.org>:
> 
> [...]
> 
> >> 1) copy features from input layer to output layer
> >> 2) modify features in output layer (remove some geometry columns)
> > 
> > You can use the SetFrom() method.
> 
> thanks for hint, I found out that input and output layer somehow share
> FeatureDefn. Here is sample code:
> 
> """
>     # create new layer
>     olayer = ods.CreateLayer(layerName, ilayer.GetSpatialRef(),
>                              geom_type, options)
> 
>     if not olayer:
>         fatal("Unable to create layer '%'" % layerName)
> 
>     # create attributes
>     feat_defn = ilayer.GetLayerDefn()
>     for i in range(feat_defn.GetFieldCount()):
>         olayer.CreateField(feat_defn.GetFieldDefn(i))
> 
>     # create also geometry attributes
>     if not geom_name and \
>             olayer.TestCapability(ogr.OLCCreateGeomField):
>         for i in range(feat_defn.GetGeomFieldCount()):
>             geom_defn = feat_defn.GetGeomFieldDefn(i)
>             if geom_name and geom_defn.GetName() != geom_name:
>                 continue
>             olayer.CreateGeomField(feat_defn.GetGeomFieldDefn(i))
> 
>     print
>     print ilayer, ilayer.GetLayerDefn()
>     print olayer, olayer.GetLayerDefn()
> """
> 
> prints
> 
> <osgeo.ogr.Layer; proxy of <Swig Object of type 'OGRLayerShadow *' at
> 0x7fbf0d95f930> > <osgeo.ogr.FeatureDefn; proxy of <Swig Object of
> type 'OGRFeatureDefnShadow *' at 0x7fbf0d95fae0> >
> <osgeo.ogr.Layer; proxy of <Swig Object of type 'OGRLayerShadow *' at
> 0x7fbf0d95fba0> > <osgeo.ogr.FeatureDefn; proxy of <Swig Object of
> type 'OGRFeatureDefnShadow *' at 0x7fbf0d95fae0> >
> 
> I am not sure why... Thanks for clarification in advance, Martin

Martin,

You cannot deduce if the underlying C++ objects are identical from that. In 
fact what you are seeing is the address of a SWIG "shadow" object, that is 
something whose lifetime is related to the lifetime of the Python objects.

See the below example :

$ python
Python 2.6.6 (r266:84292, Oct 29 2012, 23:09:05) 
[GCC 4.4.3] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> from osgeo import ogr
>>> ds = ogr.GetDriverByName('memory').CreateDataSource('')
>>> lyr1 = ds.CreateLayer('foo')
>>> lyr1.GetLayerDefn()
<osgeo.ogr.FeatureDefn; proxy of <Swig Object of type 'OGRFeatureDefnShadow *' 
at 0x7fd85c0574e0> >
>>> lyr1.GetLayerDefn()
<osgeo.ogr.FeatureDefn; proxy of <Swig Object of type 'OGRFeatureDefnShadow *' 
at 0x7fd847c493f0> >
>>> lyr1.GetLayerDefn()
<osgeo.ogr.FeatureDefn; proxy of <Swig Object of type 'OGRFeatureDefnShadow *' 
at 0x7fd85c0574e0> >
>>> lyr1.GetLayerDefn()
<osgeo.ogr.FeatureDefn; proxy of <Swig Object of type 'OGRFeatureDefnShadow *' 
at 0x7fd847c49450> >
>>> 

The shadow object changes at every execution. In your case, the old address 
for ilayer.GetLayerDefn() was likely "recycled" for olayer.GetLayerDefn()

You can try ilayer.GetLayerDefn().IsSame(olayer.GetLayerDefn()) and it should 
return 0 if their content is different (note that it compares the "content" of 
the layer and field definition, not the equality of pointers)

Best regards,

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From landa.martin at gmail.com  Mon Aug  4 03:46:22 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Mon, 4 Aug 2014 12:46:22 +0200
Subject: [gdal-dev] feature.clone() -> same featuredefn
In-Reply-To: <201408022218.05496.even.rouault@mines-paris.org>
References: <CA+Ei1Odc0VtXz-hj=zEd+KNoa+O9C=qKCLdwZTJud89xA1kTpQ@mail.gmail.com>
	<201408022203.14325.even.rouault@mines-paris.org>
	<CA+Ei1OeWBuA8Ovn-jwWuwDnwtSLUKd6tUR=dBbtgxeR4bvaZfg@mail.gmail.com>
	<201408022218.05496.even.rouault@mines-paris.org>
Message-ID: <CA+Ei1OfsoGgsLa=jivUEAW+iNbOVLLDE1zE_6rz6UJnhUxk-Fg@mail.gmail.com>

Hi Even,

2014-08-02 22:18 GMT+02:00 Even Rouault <even.rouault at mines-paris.org>:

[...]

> You can use the SetFrom() method.

it solved my problem, but it doesn't seems to copy geometry columns...

"""
            ofeature = ogr.Feature(olayer.GetLayerDefn())
            ofeature.SetFrom(feature)
            print feature.GetDefnRef().GetGeomFieldCount(),
feature.GetDefnRef().GetFieldCount()
            print ofeature.GetDefnRef().GetGeomFieldCount(),
ofeature.GetDefnRef().GetFieldCount()
"""

2 31
0 31          <-- 0!!!

Martin

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From even.rouault at mines-paris.org  Mon Aug  4 04:56:55 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 4 Aug 2014 13:56:55 +0200
Subject: [gdal-dev] feature.clone() -> same featuredefn
In-Reply-To: <CA+Ei1OfsoGgsLa=jivUEAW+iNbOVLLDE1zE_6rz6UJnhUxk-Fg@mail.gmail.com>
References: <CA+Ei1Odc0VtXz-hj=zEd+KNoa+O9C=qKCLdwZTJud89xA1kTpQ@mail.gmail.com>
	<201408022218.05496.even.rouault@mines-paris.org>
	<CA+Ei1OfsoGgsLa=jivUEAW+iNbOVLLDE1zE_6rz6UJnhUxk-Fg@mail.gmail.com>
Message-ID: <201408041356.55779.even.rouault@mines-paris.org>

Le lundi 04 ao?t 2014 12:46:22, Martin Landa a ?crit :
> Hi Even,
> 
> 2014-08-02 22:18 GMT+02:00 Even Rouault <even.rouault at mines-paris.org>:
> 
> [...]
> 
> > You can use the SetFrom() method.
> 
> it solved my problem, but it doesn't seems to copy geometry columns...
> 
> """
>             ofeature = ogr.Feature(olayer.GetLayerDefn())
>             ofeature.SetFrom(feature)
>             print feature.GetDefnRef().GetGeomFieldCount(),
> feature.GetDefnRef().GetFieldCount()
>             print ofeature.GetDefnRef().GetGeomFieldCount(),
> ofeature.GetDefnRef().GetFieldCount()
> """
> 
> 2 31
> 0 31          <-- 0!!!

Perhaps check that the line 
olayer.CreateGeomField(feat_defn.GetGeomFieldDefn(i)) is executed and its 
return code is 0.

Also, when running CreateLayer() with geom_type != wkbNone, this will create a 
default geometry field, which might get recreated again in your geometry field 
creation loop. But it does not look like like it is the case in your 
situation.

> 
> Martin

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From varunsaraf14 at gmail.com  Mon Aug  4 05:39:52 2014
From: varunsaraf14 at gmail.com (Varun Saraf)
Date: Mon, 4 Aug 2014 18:09:52 +0530
Subject: [gdal-dev] GSoC 2014 Weekly Report 11 : GDAL PostGIS Raster driver
Message-ID: <CAPfr+rsQfdOrwKSCU0hdJOJw6LJTDa6=6oi9PRaVeF3yg4ej-g@mail.gmail.com>

 Hi,

Below is my eleventh weekly report.

*What did I do this week?*

   - There are some issues with the calling of different methods. My method
   PostGISRasterDataset::Create() is not being called. Tried to resolve that.
   - Fixed some small bugs and removed unnecessary variables that were
   being used.

*What do I plan on doing next week?*

   - Continue with testing and bug fixing.

*Am I blocked on anything?*

   - No.

Link to weekly report :
https://github.com/varunsaraf/postgis_raster/wiki/Report-11
Link to code repository : https://github.com/varunsaraf/postgis_raster
More details at : http://trac.osgeo.org/gdal/wiki/PostGIS_raster_driver

Regards,
Varun Saraf
Lab for Spatial Informatics
IIIT Hyderabad, India
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140804/b9f5fd58/attachment.html>

From lucena_ivan at hotmail.com  Mon Aug  4 05:40:28 2014
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Mon, 4 Aug 2014 08:40:28 -0400
Subject: [gdal-dev] OGR: memory leak in OCI driver
In-Reply-To: <F02D54DF5576D84C86C23A39A792DC7E31656A8C@se0002v.wallonie.intra>
References: <F02D54DF5576D84C86C23A39A792DC7E3164E534@se0002v.wallonie.intra>,
	<BLU173-W30D9B916CB0161C18790C7904F0@phx.gbl>,
	<F02D54DF5576D84C86C23A39A792DC7E31656A8C@se0002v.wallonie.intra>
Message-ID: <BLU173-W513A70CD8AF4345ABE394590E20@phx.gbl>

Hi Nicolas,

I will take care of that.

Thanks,

Ivan

From: nicolas.simon at spw.wallonie.be
To: gdal-dev at lists.osgeo.org
Date: Fri, 1 Aug 2014 14:49:35 +0000
Subject: Re: [gdal-dev] OGR: memory leak in OCI driver









Hi list,
 
                We tested the suggestion of Ivan and it?s better.
                Fortunately, my problem to create ticket was solved

The ticket is  http://trac.osgeo.org/gdal/ticket/5599 with a patch file.
 
Best regards
 
Nicolas
 


De : Ivan Lucena [mailto:lucena_ivan at hotmail.com]


Envoy? : mardi 6 mai 2014 17:48

? : SIMON Nicolas; gdal-dev at lists.osgeo.org

Cc : SANDRI Christophe; NGUYEN Thi Xuan Truc

Objet : RE: [gdal-dev] OGR: memory leak in OCI driver


 

Hi Nicolas,



I received that report a month ago:



"we have found the OGROCISession is never released, causing a large memory leak whenever a connection is closed.


As workaround, we added in OGROCISession::~OGROCISession()



    if( hEnv )

           OCIHandleFree((dvoid *) hEnv, (ub4) OCI_HTYPE_ENV);"



But they also mention some other memory leaks without an specific location on the code.



Can you try to see if that fix the problem?



Thanks,



Ivan








From:
nicolas.simon at spw.wallonie.be

To: gdal-dev at lists.osgeo.org

Date: Tue, 6 May 2014 15:32:09 +0000

CC: christophe.sandri at spw.wallonie.be;
xuan.nguyen at spw.wallonie.be

Subject: [gdal-dev] OGR: memory leak in OCI driver

Dear developers,
 
                I suspect that there is a memory leak in OCI driver for OGR
               

                My simplified test case is :
 
?          

// point A
OGRRegisterAll();
 
// point B
pDS = OGRSFDriverRegistrar::Open("OCI:USER/PWD at INSTANCE:TABLE", true);
if(pDS)
     {
          OGRDataSource::DestroyDataSource(pDS);
          pDS = NULL;
     }
     else
     {
          fprintf(fOut,"Erreur Open\n");
     }
     // point C
     
OGRCleanupAll();
// point D
 
It appears that I lose memory between points B and C, and between point A and D  

 
                B = A + 4 MB
                C = A + 20 MB ( 16 MB lost)
               D = A +19 MB ( 3 more MB lost)

 
Test was done with GDAL 1.9 under windows (with Oracle 11g)
 
Can some one have an idea to find and fix this ?
 
Thank you
 
By the way,  I received ? TICKET_CREATE privileges are required to perform this operation ? when I tried to make a ticket (UID nicsim)
 
Nicolas
 
 



_______________________________________________ gdal-dev mailing list 
gdal-dev at lists.osgeo.org 
http://lists.osgeo.org/mailman/listinfo/gdal-dev






_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140804/c3ffe660/attachment-0001.html>

From landa.martin at gmail.com  Mon Aug  4 11:01:28 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Mon, 4 Aug 2014 20:01:28 +0200
Subject: [gdal-dev] feature styles: svg symbol
Message-ID: <CA+Ei1OeMxZGsTKqtVUfcgDLSa-0ADYCemMh6foY6=s0ZHJJ90Q@mail.gmail.com>

Hi all,

it's not clear to me how works system-specific symbols names [1].
Let's say that I would like to use svg symbols stored on local disc a
define them as symbols within OGR Feature Style engine. Is it
possible?

Thanks in advance, Martin

[1] http://www.gdal.org/1.11/ogr/ogr_feature_style.html

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From even.rouault at mines-paris.org  Mon Aug  4 11:03:05 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 4 Aug 2014 20:03:05 +0200
Subject: [gdal-dev] GSoC 2014 Weekly Report 11 : GDAL PostGIS Raster
	driver
In-Reply-To: <CAPfr+rsQfdOrwKSCU0hdJOJw6LJTDa6=6oi9PRaVeF3yg4ej-g@mail.gmail.com>
References: <CAPfr+rsQfdOrwKSCU0hdJOJw6LJTDa6=6oi9PRaVeF3yg4ej-g@mail.gmail.com>
Message-ID: <201408042003.05106.even.rouault@mines-paris.org>

Le lundi 04 ao?t 2014 14:39:52, Varun Saraf a ?crit :
>  Hi,
> 
> Below is my eleventh weekly report.
> 
> *What did I do this week?*
> 
>    - There are some issues with the calling of different methods. My method
>    PostGISRasterDataset::Create() is not being called. Tried to resolve
> that.

Varun,

If the code at 
https://github.com/varunsaraf/postgis_raster/blob/master/postgisrasterdataset.cpp 
is the latest state, I don't see any reason why your Create() method wouldn't 
be called. Do you try to trigger it directly by calling Create() explicetely 
or through other more high level operations ?

Even


> - Fixed some small bugs and removed unnecessary variables that were
> being used.
> 
> *What do I plan on doing next week?*
> 
>    - Continue with testing and bug fixing.
> 
> *Am I blocked on anything?*
> 
>    - No.
> 
> Link to weekly report :
> https://github.com/varunsaraf/postgis_raster/wiki/Report-11
> Link to code repository : https://github.com/varunsaraf/postgis_raster
> More details at : http://trac.osgeo.org/gdal/wiki/PostGIS_raster_driver
> 
> Regards,
> Varun Saraf
> Lab for Spatial Informatics
> IIIT Hyderabad, India

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Mon Aug  4 11:06:14 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 4 Aug 2014 20:06:14 +0200
Subject: [gdal-dev] feature styles: svg symbol
In-Reply-To: <CA+Ei1OeMxZGsTKqtVUfcgDLSa-0ADYCemMh6foY6=s0ZHJJ90Q@mail.gmail.com>
References: <CA+Ei1OeMxZGsTKqtVUfcgDLSa-0ADYCemMh6foY6=s0ZHJJ90Q@mail.gmail.com>
Message-ID: <201408042006.14635.even.rouault@mines-paris.org>

Le lundi 04 ao?t 2014 20:01:28, Martin Landa a ?crit :
> Hi all,
> 
> it's not clear to me how works system-specific symbols names [1].
> Let's say that I would like to use svg symbols stored on local disc a
> define them as symbols within OGR Feature Style engine. Is it
> possible?

Exactly same question asked a few days ago : 
http://lists.osgeo.org/pipermail/gdal-dev/2014-July/thread.html#39568

> 
> Thanks in advance, Martin
> 
> [1] http://www.gdal.org/1.11/ogr/ogr_feature_style.html

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From landa.martin at gmail.com  Mon Aug  4 11:16:03 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Mon, 4 Aug 2014 20:16:03 +0200
Subject: [gdal-dev] feature styles: svg symbol
In-Reply-To: <201408042006.14635.even.rouault@mines-paris.org>
References: <CA+Ei1OeMxZGsTKqtVUfcgDLSa-0ADYCemMh6foY6=s0ZHJJ90Q@mail.gmail.com>
	<201408042006.14635.even.rouault@mines-paris.org>
Message-ID: <CA+Ei1Od0LoYJP7QOBTRx1aNhJjSxO1cyY8vgJhpBo3WtCY-eAw@mail.gmail.com>

Hi,

2014-08-04 20:06 GMT+02:00 Even Rouault <even.rouault at mines-paris.org>:

>> it's not clear to me how works system-specific symbols names [1].
>> Let's say that I would like to use svg symbols stored on local disc a
>> define them as symbols within OGR Feature Style engine. Is it
>> possible?
>
> Exactly same question asked a few days ago :
> http://lists.osgeo.org/pipermail/gdal-dev/2014-July/thread.html#39568

ah, sorry, I overlooked that. I can understand example for MapServer,
but eg. when extending KML driver for supporting SVG symbols for
points, the symbol id would be uri of SVG file, right?

Martin

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From even.rouault at mines-paris.org  Mon Aug  4 11:21:43 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 4 Aug 2014 20:21:43 +0200
Subject: [gdal-dev] feature styles: svg symbol
In-Reply-To: <CA+Ei1Od0LoYJP7QOBTRx1aNhJjSxO1cyY8vgJhpBo3WtCY-eAw@mail.gmail.com>
References: <CA+Ei1OeMxZGsTKqtVUfcgDLSa-0ADYCemMh6foY6=s0ZHJJ90Q@mail.gmail.com>
	<201408042006.14635.even.rouault@mines-paris.org>
	<CA+Ei1Od0LoYJP7QOBTRx1aNhJjSxO1cyY8vgJhpBo3WtCY-eAw@mail.gmail.com>
Message-ID: <201408042021.43149.even.rouault@mines-paris.org>

Le lundi 04 ao?t 2014 20:16:03, Martin Landa a ?crit :
> Hi,
> 
> 2014-08-04 20:06 GMT+02:00 Even Rouault <even.rouault at mines-paris.org>:
> >> it's not clear to me how works system-specific symbols names [1].
> >> Let's say that I would like to use svg symbols stored on local disc a
> >> define them as symbols within OGR Feature Style engine. Is it
> >> possible?
> > 
> > Exactly same question asked a few days ago :
> > http://lists.osgeo.org/pipermail/gdal-dev/2014-July/thread.html#39568
> 
> ah, sorry, I overlooked that. I can understand example for MapServer,
> but eg. when extending KML driver for supporting SVG symbols for
> points, the symbol id would be uri of SVG file, right?

yes that's reasonable, but the LIBKML driver should already do that :


OGRStyleSymbol *kml2symbol (
    IconStylePtr poKmlIconStyle,
    OGRStyleSymbol *poOgrStyleSymbol)
{

    if (!poOgrStyleSymbol)
        poOgrStyleSymbol = new OGRStyleSymbol (  );

    /***** id (kml icon) *****/

    if ( poKmlIconStyle->has_icon (  ) ) {
        IconStyleIconPtr poKmlIcon = poKmlIconStyle->get_icon (  );

        if ( poKmlIcon->has_href (  ) ) {
            std::string oIcon = "\"";
            oIcon.append ( poKmlIcon->get_href (  ).c_str (  ) );
            oIcon.append ( "\"" );
            poOgrStyleSymbol->SetId ( oIcon.c_str (  ) );

        }
    }

And the reverse code also exists.

> 
> Martin

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From landa.martin at gmail.com  Mon Aug  4 11:32:46 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Mon, 4 Aug 2014 20:32:46 +0200
Subject: [gdal-dev] feature styles: svg symbol
In-Reply-To: <201408042021.43149.even.rouault@mines-paris.org>
References: <CA+Ei1OeMxZGsTKqtVUfcgDLSa-0ADYCemMh6foY6=s0ZHJJ90Q@mail.gmail.com>
	<201408042006.14635.even.rouault@mines-paris.org>
	<CA+Ei1Od0LoYJP7QOBTRx1aNhJjSxO1cyY8vgJhpBo3WtCY-eAw@mail.gmail.com>
	<201408042021.43149.even.rouault@mines-paris.org>
Message-ID: <CA+Ei1OfT3u9r4_QRjQf=XZpNP6k7Wz6imFEA=OwHqjNiDunzew@mail.gmail.com>

Hi,

2014-08-04 20:21 GMT+02:00 Even Rouault <even.rouault at mines-paris.org>:

[...]

> And the reverse code also exists.

what do you mean by that? Thanks for clarification in advance, Martin

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From even.rouault at mines-paris.org  Mon Aug  4 11:44:24 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 4 Aug 2014 20:44:24 +0200
Subject: [gdal-dev] feature styles: svg symbol
In-Reply-To: <CA+Ei1OfT3u9r4_QRjQf=XZpNP6k7Wz6imFEA=OwHqjNiDunzew@mail.gmail.com>
References: <CA+Ei1OeMxZGsTKqtVUfcgDLSa-0ADYCemMh6foY6=s0ZHJJ90Q@mail.gmail.com>
	<201408042021.43149.even.rouault@mines-paris.org>
	<CA+Ei1OfT3u9r4_QRjQf=XZpNP6k7Wz6imFEA=OwHqjNiDunzew@mail.gmail.com>
Message-ID: <201408042044.25009.even.rouault@mines-paris.org>

Le lundi 04 ao?t 2014 20:32:46, Martin Landa a ?crit :
> Hi,
> 
> 2014-08-04 20:21 GMT+02:00 Even Rouault <even.rouault at mines-paris.org>:
> 
> [...]
> 
> > And the reverse code also exists.
> 
> what do you mean by that? Thanks for clarification in advance, Martin

The one that takes a SYMBOL from a OGR Feature Style definition and write a KML 
Icon

ogr/ogrsf_frmts/libkml/ogrlibkmlstyle.cpp, line 170 and following.


-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From landa.martin at gmail.com  Mon Aug  4 11:51:29 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Mon, 4 Aug 2014 20:51:29 +0200
Subject: [gdal-dev] feature styles: svg symbol
In-Reply-To: <201408042044.25009.even.rouault@mines-paris.org>
References: <CA+Ei1OeMxZGsTKqtVUfcgDLSa-0ADYCemMh6foY6=s0ZHJJ90Q@mail.gmail.com>
	<201408042021.43149.even.rouault@mines-paris.org>
	<CA+Ei1OfT3u9r4_QRjQf=XZpNP6k7Wz6imFEA=OwHqjNiDunzew@mail.gmail.com>
	<201408042044.25009.even.rouault@mines-paris.org>
Message-ID: <CA+Ei1Oe8asCpccL2Ym+FNzWYBQD1P_BAU_DWsEbN4UOU=7z-uw@mail.gmail.com>

2014-08-04 20:44 GMT+02:00 Even Rouault <even.rouault at mines-paris.org>:

>> > And the reverse code also exists.
>>
>> what do you mean by that? Thanks for clarification in advance, Martin
>
> The one that takes a SYMBOL from a OGR Feature Style definition and write a KML
> Icon
>
> ogr/ogrsf_frmts/libkml/ogrlibkmlstyle.cpp, line 170 and following.

ah, thanks. Martin

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From varunsaraf14 at gmail.com  Mon Aug  4 12:38:36 2014
From: varunsaraf14 at gmail.com (Varun Saraf)
Date: Tue, 5 Aug 2014 01:08:36 +0530
Subject: [gdal-dev] GSoC 2014 Weekly Report 11 : GDAL PostGIS Raster
	driver
In-Reply-To: <201408042003.05106.even.rouault@mines-paris.org>
References: <CAPfr+rsQfdOrwKSCU0hdJOJw6LJTDa6=6oi9PRaVeF3yg4ej-g@mail.gmail.com>
	<201408042003.05106.even.rouault@mines-paris.org>
Message-ID: <CAPfr+ruxeyRzL72FfGQ7GsU7GMGzAY74fvUzC8-wbOP_UU+kWA@mail.gmail.com>

Hello,

Yes, the code on the github repository is the latest state. I was trying
the following input queries :

(1) Assuming that my Create() will be called.
gdal_translate --debug ON -of PostGISRaster ~/GSoC/ap_clip5x5.tif
 PG:"host=localhost port=5432 user=postgres password=postgres
dbname=test123 table=newtable"

(2) When that did not work, I tried the following (suggested by my mentor,
Jorge Arevalo) which didn't work either.
gdal_translate --debug ON -of PostGISRaster -outsize 50% 50%
~/GSoC/ap_clip5x5.tif  PG:"host=localhost port=5432 user=postgres
password=postgres dbname=test123 table=newtable"

QuiteDelete() method is called in both cases and the following error
messages are shown
ERROR 1: Couldn't drop the table public.newtable: ERROR:  table "newtable"
does not exist
ERROR 6: PostGISRasterDataset::CreateCopy() only works on source datasets
that are PostGISRaster

I even tried calling the Create() method directly from CreateCopy(), since
that is being called, but again the same error message is being printed.

Regards,
Varun Saraf

On Mon, Aug 4, 2014 at 11:33 PM, Even Rouault <even.rouault at mines-paris.org>
wrote:

> Le lundi 04 ao?t 2014 14:39:52, Varun Saraf a ?crit :
> >  Hi,
> >
> > Below is my eleventh weekly report.
> >
> > *What did I do this week?*
> >
> >    - There are some issues with the calling of different methods. My
> method
> >    PostGISRasterDataset::Create() is not being called. Tried to resolve
> > that.
>
> Varun,
>
> If the code at
>
> https://github.com/varunsaraf/postgis_raster/blob/master/postgisrasterdataset.cpp
> is the latest state, I don't see any reason why your Create() method
> wouldn't
> be called. Do you try to trigger it directly by calling Create()
> explicetely
> or through other more high level operations ?
>
> Even
>
>
> > - Fixed some small bugs and removed unnecessary variables that were
> > being used.
> >
> > *What do I plan on doing next week?*
> >
> >    - Continue with testing and bug fixing.
> >
> > *Am I blocked on anything?*
> >
> >    - No.
> >
> > Link to weekly report :
> > https://github.com/varunsaraf/postgis_raster/wiki/Report-11
> > Link to code repository : https://github.com/varunsaraf/postgis_raster
> > More details at : http://trac.osgeo.org/gdal/wiki/PostGIS_raster_driver
> >
> > Regards,
> > Varun Saraf
> > Lab for Spatial Informatics
> > IIIT Hyderabad, India
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140805/c709dc0a/attachment.html>

From even.rouault at mines-paris.org  Mon Aug  4 13:14:45 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 4 Aug 2014 22:14:45 +0200
Subject: [gdal-dev] GSoC 2014 Weekly Report 11 : GDAL PostGIS Raster
	driver
In-Reply-To: <CAPfr+ruxeyRzL72FfGQ7GsU7GMGzAY74fvUzC8-wbOP_UU+kWA@mail.gmail.com>
References: <CAPfr+rsQfdOrwKSCU0hdJOJw6LJTDa6=6oi9PRaVeF3yg4ej-g@mail.gmail.com>
	<201408042003.05106.even.rouault@mines-paris.org>
	<CAPfr+ruxeyRzL72FfGQ7GsU7GMGzAY74fvUzC8-wbOP_UU+kWA@mail.gmail.com>
Message-ID: <201408042214.45576.even.rouault@mines-paris.org>

Le lundi 04 ao?t 2014 21:38:36, Varun Saraf a ?crit :
> Hello,
> 
> Yes, the code on the github repository is the latest state. I was trying
> the following input queries :
> 
> (1) Assuming that my Create() will be called.
> gdal_translate --debug ON -of PostGISRaster ~/GSoC/ap_clip5x5.tif
>  PG:"host=localhost port=5432 user=postgres password=postgres
> dbname=test123 table=newtable"
> 
> (2) When that did not work, I tried the following (suggested by my mentor,
> Jorge Arevalo) which didn't work either.
> gdal_translate --debug ON -of PostGISRaster -outsize 50% 50%
> ~/GSoC/ap_clip5x5.tif  PG:"host=localhost port=5432 user=postgres
> password=postgres dbname=test123 table=newtable"

gdal_translate will never call Create(), but only CreateCopy().

You might want to call Create() directly with a Python script for example, or 
a sample C/C++ code. gdalwarp will call Create() too, but gdalwarp can 
potentially rewrite existing tiles, which can complicate your initial coding.

> 
> QuiteDelete() method is called in both cases and the following error
> messages are shown
> ERROR 1: Couldn't drop the table public.newtable: ERROR:  table "newtable"
> does not exist
> ERROR 6: PostGISRasterDataset::CreateCopy() only works on source datasets
> that are PostGISRaster

Yes, as the message implies, the current CreateCopy() implementation only 
works when the source dataset is a postgisraster dataset itself.
As far as the error message "Couldn't drop ...",  
PostGISRasterDataset::Delete() should probably be more silent in case the 
dataset doesn't exist.

Note that once you have a full feature Create() implementation (with working 
IWriteBlock() of course), CreateCopy() is no longer strictly needed, since 
there is generic implementation in GDAL core that will emulate CreateCopy() 
with Create() + IWriteBlock()

> 
> I even tried calling the Create() method directly from CreateCopy(), since
> that is being called, but again the same error message is being printed.
> 
> Regards,
> Varun Saraf
> 
> On Mon, Aug 4, 2014 at 11:33 PM, Even Rouault
> <even.rouault at mines-paris.org>
> 
> wrote:
> > Le lundi 04 ao?t 2014 14:39:52, Varun Saraf a ?crit :
> > >  Hi,
> > > 
> > > Below is my eleventh weekly report.
> > > 
> > > *What did I do this week?*
> > > 
> > >    - There are some issues with the calling of different methods. My
> > 
> > method
> > 
> > >    PostGISRasterDataset::Create() is not being called. Tried to resolve
> > > 
> > > that.
> > 
> > Varun,
> > 
> > If the code at
> > 
> > https://github.com/varunsaraf/postgis_raster/blob/master/postgisrasterdat
> > aset.cpp is the latest state, I don't see any reason why your Create()
> > method wouldn't
> > be called. Do you try to trigger it directly by calling Create()
> > explicetely
> > or through other more high level operations ?
> > 
> > Even
> > 
> > > - Fixed some small bugs and removed unnecessary variables that were
> > > being used.
> > > 
> > > *What do I plan on doing next week?*
> > > 
> > >    - Continue with testing and bug fixing.
> > > 
> > > *Am I blocked on anything?*
> > > 
> > >    - No.
> > > 
> > > Link to weekly report :
> > > https://github.com/varunsaraf/postgis_raster/wiki/Report-11
> > > Link to code repository : https://github.com/varunsaraf/postgis_raster
> > > More details at : http://trac.osgeo.org/gdal/wiki/PostGIS_raster_driver
> > > 
> > > Regards,
> > > Varun Saraf
> > > Lab for Spatial Informatics
> > > IIIT Hyderabad, India
> > 
> > --
> > Geospatial professional services
> > http://even.rouault.free.fr/services.html

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From varunsaraf14 at gmail.com  Mon Aug  4 13:38:20 2014
From: varunsaraf14 at gmail.com (Varun Saraf)
Date: Tue, 5 Aug 2014 02:08:20 +0530
Subject: [gdal-dev] GSoC 2014 Weekly Report 11 : GDAL PostGIS Raster
	driver
In-Reply-To: <201408042214.45576.even.rouault@mines-paris.org>
References: <CAPfr+rsQfdOrwKSCU0hdJOJw6LJTDa6=6oi9PRaVeF3yg4ej-g@mail.gmail.com>
	<201408042003.05106.even.rouault@mines-paris.org>
	<CAPfr+ruxeyRzL72FfGQ7GsU7GMGzAY74fvUzC8-wbOP_UU+kWA@mail.gmail.com>
	<201408042214.45576.even.rouault@mines-paris.org>
Message-ID: <CAPfr+ru8pMFJKza8hpKGe1ehj+WTzzZ=3zz9k7UEXtC=j1xoSw@mail.gmail.com>

Hello,

Thank you for this information. I will explicitly call Create() using a
script. Is the IWriteBlock method to be tested in a similar manner? Note
that pData buffer is passed to this method as an argument, which I will
have to generate and pass to it. Any suggestions how I should generate this
pData buffer?

Regards,
Varun Saraf


On Tue, Aug 5, 2014 at 1:44 AM, Even Rouault <even.rouault at mines-paris.org>
wrote:

> Le lundi 04 ao?t 2014 21:38:36, Varun Saraf a ?crit :
> > Hello,
> >
> > Yes, the code on the github repository is the latest state. I was trying
> > the following input queries :
> >
> > (1) Assuming that my Create() will be called.
> > gdal_translate --debug ON -of PostGISRaster ~/GSoC/ap_clip5x5.tif
> >  PG:"host=localhost port=5432 user=postgres password=postgres
> > dbname=test123 table=newtable"
> >
> > (2) When that did not work, I tried the following (suggested by my
> mentor,
> > Jorge Arevalo) which didn't work either.
> > gdal_translate --debug ON -of PostGISRaster -outsize 50% 50%
> > ~/GSoC/ap_clip5x5.tif  PG:"host=localhost port=5432 user=postgres
> > password=postgres dbname=test123 table=newtable"
>
> gdal_translate will never call Create(), but only CreateCopy().
>
> You might want to call Create() directly with a Python script for example,
> or
> a sample C/C++ code. gdalwarp will call Create() too, but gdalwarp can
> potentially rewrite existing tiles, which can complicate your initial
> coding.
>
> >
> > QuiteDelete() method is called in both cases and the following error
> > messages are shown
> > ERROR 1: Couldn't drop the table public.newtable: ERROR:  table
> "newtable"
> > does not exist
> > ERROR 6: PostGISRasterDataset::CreateCopy() only works on source datasets
> > that are PostGISRaster
>
> Yes, as the message implies, the current CreateCopy() implementation only
> works when the source dataset is a postgisraster dataset itself.
> As far as the error message "Couldn't drop ...",
> PostGISRasterDataset::Delete() should probably be more silent in case the
> dataset doesn't exist.
>
> Note that once you have a full feature Create() implementation (with
> working
> IWriteBlock() of course), CreateCopy() is no longer strictly needed, since
> there is generic implementation in GDAL core that will emulate CreateCopy()
> with Create() + IWriteBlock()
>
> >
> > I even tried calling the Create() method directly from CreateCopy(),
> since
> > that is being called, but again the same error message is being printed.
> >
> > Regards,
> > Varun Saraf
> >
> > On Mon, Aug 4, 2014 at 11:33 PM, Even Rouault
> > <even.rouault at mines-paris.org>
> >
> > wrote:
> > > Le lundi 04 ao?t 2014 14:39:52, Varun Saraf a ?crit :
> > > >  Hi,
> > > >
> > > > Below is my eleventh weekly report.
> > > >
> > > > *What did I do this week?*
> > > >
> > > >    - There are some issues with the calling of different methods. My
> > >
> > > method
> > >
> > > >    PostGISRasterDataset::Create() is not being called. Tried to
> resolve
> > > >
> > > > that.
> > >
> > > Varun,
> > >
> > > If the code at
> > >
> > >
> https://github.com/varunsaraf/postgis_raster/blob/master/postgisrasterdat
> > > aset.cpp is the latest state, I don't see any reason why your Create()
> > > method wouldn't
> > > be called. Do you try to trigger it directly by calling Create()
> > > explicetely
> > > or through other more high level operations ?
> > >
> > > Even
> > >
> > > > - Fixed some small bugs and removed unnecessary variables that were
> > > > being used.
> > > >
> > > > *What do I plan on doing next week?*
> > > >
> > > >    - Continue with testing and bug fixing.
> > > >
> > > > *Am I blocked on anything?*
> > > >
> > > >    - No.
> > > >
> > > > Link to weekly report :
> > > > https://github.com/varunsaraf/postgis_raster/wiki/Report-11
> > > > Link to code repository :
> https://github.com/varunsaraf/postgis_raster
> > > > More details at :
> http://trac.osgeo.org/gdal/wiki/PostGIS_raster_driver
> > > >
> > > > Regards,
> > > > Varun Saraf
> > > > Lab for Spatial Informatics
> > > > IIIT Hyderabad, India
> > >
> > > --
> > > Geospatial professional services
> > > http://even.rouault.free.fr/services.html
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140805/4534b86d/attachment.html>

From even.rouault at mines-paris.org  Mon Aug  4 13:42:39 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 4 Aug 2014 22:42:39 +0200
Subject: [gdal-dev] GSoC 2014 Weekly Report 11 : GDAL PostGIS Raster
	driver
In-Reply-To: <CAPfr+ru8pMFJKza8hpKGe1ehj+WTzzZ=3zz9k7UEXtC=j1xoSw@mail.gmail.com>
References: <CAPfr+rsQfdOrwKSCU0hdJOJw6LJTDa6=6oi9PRaVeF3yg4ej-g@mail.gmail.com>
	<201408042214.45576.even.rouault@mines-paris.org>
	<CAPfr+ru8pMFJKza8hpKGe1ehj+WTzzZ=3zz9k7UEXtC=j1xoSw@mail.gmail.com>
Message-ID: <201408042242.39778.even.rouault@mines-paris.org>

Le lundi 04 ao?t 2014 22:38:20, Varun Saraf a ?crit :
> Hello,
> 
> Thank you for this information. I will explicitly call Create() using a
> script. Is the IWriteBlock method to be tested in a similar manner? Note
> that pData buffer is passed to this method as an argument, which I will
> have to generate and pass to it. Any suggestions how I should generate this
> pData buffer?

Well, any data might do.
But based on my previous note regarding the generic GDAL core CreateCopy() 
implementation, another possibility for your testing is to temporarily comment 
poDriver->pfnCreateCopy = .... and use gdal_translate.

> 
> Regards,
> Varun Saraf
> 
> 
> On Tue, Aug 5, 2014 at 1:44 AM, Even Rouault <even.rouault at mines-paris.org>
> 
> wrote:
> > Le lundi 04 ao?t 2014 21:38:36, Varun Saraf a ?crit :
> > > Hello,
> > > 
> > > Yes, the code on the github repository is the latest state. I was
> > > trying the following input queries :
> > > 
> > > (1) Assuming that my Create() will be called.
> > > gdal_translate --debug ON -of PostGISRaster ~/GSoC/ap_clip5x5.tif
> > > 
> > >  PG:"host=localhost port=5432 user=postgres password=postgres
> > > 
> > > dbname=test123 table=newtable"
> > > 
> > > (2) When that did not work, I tried the following (suggested by my
> > 
> > mentor,
> > 
> > > Jorge Arevalo) which didn't work either.
> > > gdal_translate --debug ON -of PostGISRaster -outsize 50% 50%
> > > ~/GSoC/ap_clip5x5.tif  PG:"host=localhost port=5432 user=postgres
> > > password=postgres dbname=test123 table=newtable"
> > 
> > gdal_translate will never call Create(), but only CreateCopy().
> > 
> > You might want to call Create() directly with a Python script for
> > example, or
> > a sample C/C++ code. gdalwarp will call Create() too, but gdalwarp can
> > potentially rewrite existing tiles, which can complicate your initial
> > coding.
> > 
> > > QuiteDelete() method is called in both cases and the following error
> > > messages are shown
> > > ERROR 1: Couldn't drop the table public.newtable: ERROR:  table
> > 
> > "newtable"
> > 
> > > does not exist
> > > ERROR 6: PostGISRasterDataset::CreateCopy() only works on source
> > > datasets that are PostGISRaster
> > 
> > Yes, as the message implies, the current CreateCopy() implementation only
> > works when the source dataset is a postgisraster dataset itself.
> > As far as the error message "Couldn't drop ...",
> > PostGISRasterDataset::Delete() should probably be more silent in case the
> > dataset doesn't exist.
> > 
> > Note that once you have a full feature Create() implementation (with
> > working
> > IWriteBlock() of course), CreateCopy() is no longer strictly needed,
> > since there is generic implementation in GDAL core that will emulate
> > CreateCopy() with Create() + IWriteBlock()
> > 
> > > I even tried calling the Create() method directly from CreateCopy(),
> > 
> > since
> > 
> > > that is being called, but again the same error message is being
> > > printed.
> > > 
> > > Regards,
> > > Varun Saraf
> > > 
> > > On Mon, Aug 4, 2014 at 11:33 PM, Even Rouault
> > > <even.rouault at mines-paris.org>
> > > 
> > > wrote:
> > > > Le lundi 04 ao?t 2014 14:39:52, Varun Saraf a ?crit :
> > > > >  Hi,
> > > > > 
> > > > > Below is my eleventh weekly report.
> > > > > 
> > > > > *What did I do this week?*
> > > > > 
> > > > >    - There are some issues with the calling of different methods.
> > > > >    My
> > > > 
> > > > method
> > > > 
> > > > >    PostGISRasterDataset::Create() is not being called. Tried to
> > 
> > resolve
> > 
> > > > > that.
> > > > 
> > > > Varun,
> > > > 
> > > > If the code at
> > 
> > https://github.com/varunsaraf/postgis_raster/blob/master/postgisrasterdat
> > 
> > > > aset.cpp is the latest state, I don't see any reason why your
> > > > Create() method wouldn't
> > > > be called. Do you try to trigger it directly by calling Create()
> > > > explicetely
> > > > or through other more high level operations ?
> > > > 
> > > > Even
> > > > 
> > > > > - Fixed some small bugs and removed unnecessary variables that were
> > > > > being used.
> > > > > 
> > > > > *What do I plan on doing next week?*
> > > > > 
> > > > >    - Continue with testing and bug fixing.
> > > > > 
> > > > > *Am I blocked on anything?*
> > > > > 
> > > > >    - No.
> > > > > 
> > > > > Link to weekly report :
> > > > > https://github.com/varunsaraf/postgis_raster/wiki/Report-11
> > 
> > > > > Link to code repository :
> > https://github.com/varunsaraf/postgis_raster
> > 
> > > > > More details at :
> > http://trac.osgeo.org/gdal/wiki/PostGIS_raster_driver
> > 
> > > > > Regards,
> > > > > Varun Saraf
> > > > > Lab for Spatial Informatics
> > > > > IIIT Hyderabad, India
> > > > 
> > > > --
> > > > Geospatial professional services
> > > > http://even.rouault.free.fr/services.html
> > 
> > --
> > Geospatial professional services
> > http://even.rouault.free.fr/services.html

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From varunsaraf14 at gmail.com  Mon Aug  4 13:53:03 2014
From: varunsaraf14 at gmail.com (Varun Saraf)
Date: Tue, 5 Aug 2014 02:23:03 +0530
Subject: [gdal-dev] GSoC 2014 Weekly Report 11 : GDAL PostGIS Raster
	driver
In-Reply-To: <201408042242.39778.even.rouault@mines-paris.org>
References: <CAPfr+rsQfdOrwKSCU0hdJOJw6LJTDa6=6oi9PRaVeF3yg4ej-g@mail.gmail.com>
	<201408042214.45576.even.rouault@mines-paris.org>
	<CAPfr+ru8pMFJKza8hpKGe1ehj+WTzzZ=3zz9k7UEXtC=j1xoSw@mail.gmail.com>
	<201408042242.39778.even.rouault@mines-paris.org>
Message-ID: <CAPfr+rt3JmU9h+m79wEcMQH=oukc_WH2YvrsWn6Du-D7vgSSag@mail.gmail.com>

Hello,

Commenting poDriver->pfnCreateCopy doesn't seem to work. It is still
calling the CreateCopy() method. I will try doing the testing with a script
and get back to you.

Regards,
Varun Saraf


On Tue, Aug 5, 2014 at 2:12 AM, Even Rouault <even.rouault at mines-paris.org>
wrote:

> Le lundi 04 ao?t 2014 22:38:20, Varun Saraf a ?crit :
> > Hello,
> >
> > Thank you for this information. I will explicitly call Create() using a
> > script. Is the IWriteBlock method to be tested in a similar manner? Note
> > that pData buffer is passed to this method as an argument, which I will
> > have to generate and pass to it. Any suggestions how I should generate
> this
> > pData buffer?
>
> Well, any data might do.
> But based on my previous note regarding the generic GDAL core CreateCopy()
> implementation, another possibility for your testing is to temporarily
> comment
> poDriver->pfnCreateCopy = .... and use gdal_translate.
>
> >
> > Regards,
> > Varun Saraf
> >
> >
> > On Tue, Aug 5, 2014 at 1:44 AM, Even Rouault <
> even.rouault at mines-paris.org>
> >
> > wrote:
> > > Le lundi 04 ao?t 2014 21:38:36, Varun Saraf a ?crit :
> > > > Hello,
> > > >
> > > > Yes, the code on the github repository is the latest state. I was
> > > > trying the following input queries :
> > > >
> > > > (1) Assuming that my Create() will be called.
> > > > gdal_translate --debug ON -of PostGISRaster ~/GSoC/ap_clip5x5.tif
> > > >
> > > >  PG:"host=localhost port=5432 user=postgres password=postgres
> > > >
> > > > dbname=test123 table=newtable"
> > > >
> > > > (2) When that did not work, I tried the following (suggested by my
> > >
> > > mentor,
> > >
> > > > Jorge Arevalo) which didn't work either.
> > > > gdal_translate --debug ON -of PostGISRaster -outsize 50% 50%
> > > > ~/GSoC/ap_clip5x5.tif  PG:"host=localhost port=5432 user=postgres
> > > > password=postgres dbname=test123 table=newtable"
> > >
> > > gdal_translate will never call Create(), but only CreateCopy().
> > >
> > > You might want to call Create() directly with a Python script for
> > > example, or
> > > a sample C/C++ code. gdalwarp will call Create() too, but gdalwarp can
> > > potentially rewrite existing tiles, which can complicate your initial
> > > coding.
> > >
> > > > QuiteDelete() method is called in both cases and the following error
> > > > messages are shown
> > > > ERROR 1: Couldn't drop the table public.newtable: ERROR:  table
> > >
> > > "newtable"
> > >
> > > > does not exist
> > > > ERROR 6: PostGISRasterDataset::CreateCopy() only works on source
> > > > datasets that are PostGISRaster
> > >
> > > Yes, as the message implies, the current CreateCopy() implementation
> only
> > > works when the source dataset is a postgisraster dataset itself.
> > > As far as the error message "Couldn't drop ...",
> > > PostGISRasterDataset::Delete() should probably be more silent in case
> the
> > > dataset doesn't exist.
> > >
> > > Note that once you have a full feature Create() implementation (with
> > > working
> > > IWriteBlock() of course), CreateCopy() is no longer strictly needed,
> > > since there is generic implementation in GDAL core that will emulate
> > > CreateCopy() with Create() + IWriteBlock()
> > >
> > > > I even tried calling the Create() method directly from CreateCopy(),
> > >
> > > since
> > >
> > > > that is being called, but again the same error message is being
> > > > printed.
> > > >
> > > > Regards,
> > > > Varun Saraf
> > > >
> > > > On Mon, Aug 4, 2014 at 11:33 PM, Even Rouault
> > > > <even.rouault at mines-paris.org>
> > > >
> > > > wrote:
> > > > > Le lundi 04 ao?t 2014 14:39:52, Varun Saraf a ?crit :
> > > > > >  Hi,
> > > > > >
> > > > > > Below is my eleventh weekly report.
> > > > > >
> > > > > > *What did I do this week?*
> > > > > >
> > > > > >    - There are some issues with the calling of different methods.
> > > > > >    My
> > > > >
> > > > > method
> > > > >
> > > > > >    PostGISRasterDataset::Create() is not being called. Tried to
> > >
> > > resolve
> > >
> > > > > > that.
> > > > >
> > > > > Varun,
> > > > >
> > > > > If the code at
> > >
> > >
> https://github.com/varunsaraf/postgis_raster/blob/master/postgisrasterdat
> > >
> > > > > aset.cpp is the latest state, I don't see any reason why your
> > > > > Create() method wouldn't
> > > > > be called. Do you try to trigger it directly by calling Create()
> > > > > explicetely
> > > > > or through other more high level operations ?
> > > > >
> > > > > Even
> > > > >
> > > > > > - Fixed some small bugs and removed unnecessary variables that
> were
> > > > > > being used.
> > > > > >
> > > > > > *What do I plan on doing next week?*
> > > > > >
> > > > > >    - Continue with testing and bug fixing.
> > > > > >
> > > > > > *Am I blocked on anything?*
> > > > > >
> > > > > >    - No.
> > > > > >
> > > > > > Link to weekly report :
> > > > > > https://github.com/varunsaraf/postgis_raster/wiki/Report-11
> > >
> > > > > > Link to code repository :
> > > https://github.com/varunsaraf/postgis_raster
> > >
> > > > > > More details at :
> > > http://trac.osgeo.org/gdal/wiki/PostGIS_raster_driver
> > >
> > > > > > Regards,
> > > > > > Varun Saraf
> > > > > > Lab for Spatial Informatics
> > > > > > IIIT Hyderabad, India
> > > > >
> > > > > --
> > > > > Geospatial professional services
> > > > > http://even.rouault.free.fr/services.html
> > >
> > > --
> > > Geospatial professional services
> > > http://even.rouault.free.fr/services.html
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140805/0179ca2d/attachment.html>

From even.rouault at mines-paris.org  Mon Aug  4 14:02:37 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 4 Aug 2014 23:02:37 +0200
Subject: [gdal-dev] GSoC 2014 Weekly Report 11 : GDAL PostGIS Raster
	driver
In-Reply-To: <CAPfr+rt3JmU9h+m79wEcMQH=oukc_WH2YvrsWn6Du-D7vgSSag@mail.gmail.com>
References: <CAPfr+rsQfdOrwKSCU0hdJOJw6LJTDa6=6oi9PRaVeF3yg4ej-g@mail.gmail.com>
	<201408042242.39778.even.rouault@mines-paris.org>
	<CAPfr+rt3JmU9h+m79wEcMQH=oukc_WH2YvrsWn6Du-D7vgSSag@mail.gmail.com>
Message-ID: <201408042302.37488.even.rouault@mines-paris.org>

Le lundi 04 ao?t 2014 22:53:03, Varun Saraf a ?crit :
> Hello,
> 
> Commenting poDriver->pfnCreateCopy doesn't seem to work. It is still
> calling the CreateCopy() method.

Check twice... How could GDAL call PostgisRasterDataset::CreateCopy() is 
nothing points to it ?

> I will try doing the testing with a script
> and get back to you.
> 
> Regards,
> Varun Saraf
> 
> 
> On Tue, Aug 5, 2014 at 2:12 AM, Even Rouault <even.rouault at mines-paris.org>
> 
> wrote:
> > Le lundi 04 ao?t 2014 22:38:20, Varun Saraf a ?crit :
> > > Hello,
> > > 
> > > Thank you for this information. I will explicitly call Create() using a
> > > script. Is the IWriteBlock method to be tested in a similar manner?
> > > Note that pData buffer is passed to this method as an argument, which
> > > I will have to generate and pass to it. Any suggestions how I should
> > > generate
> > 
> > this
> > 
> > > pData buffer?
> > 
> > Well, any data might do.
> > But based on my previous note regarding the generic GDAL core
> > CreateCopy() implementation, another possibility for your testing is to
> > temporarily comment
> > poDriver->pfnCreateCopy = .... and use gdal_translate.
> > 
> > > Regards,
> > > Varun Saraf
> > > 
> > > 
> > > On Tue, Aug 5, 2014 at 1:44 AM, Even Rouault <
> > 
> > even.rouault at mines-paris.org>
> > 
> > > wrote:
> > > > Le lundi 04 ao?t 2014 21:38:36, Varun Saraf a ?crit :
> > > > > Hello,
> > > > > 
> > > > > Yes, the code on the github repository is the latest state. I was
> > > > > trying the following input queries :
> > > > > 
> > > > > (1) Assuming that my Create() will be called.
> > > > > gdal_translate --debug ON -of PostGISRaster ~/GSoC/ap_clip5x5.tif
> > > > > 
> > > > >  PG:"host=localhost port=5432 user=postgres password=postgres
> > > > > 
> > > > > dbname=test123 table=newtable"
> > > > > 
> > > > > (2) When that did not work, I tried the following (suggested by my
> > > > 
> > > > mentor,
> > > > 
> > > > > Jorge Arevalo) which didn't work either.
> > > > > gdal_translate --debug ON -of PostGISRaster -outsize 50% 50%
> > > > > ~/GSoC/ap_clip5x5.tif  PG:"host=localhost port=5432 user=postgres
> > > > > password=postgres dbname=test123 table=newtable"
> > > > 
> > > > gdal_translate will never call Create(), but only CreateCopy().
> > > > 
> > > > You might want to call Create() directly with a Python script for
> > > > example, or
> > > > a sample C/C++ code. gdalwarp will call Create() too, but gdalwarp
> > > > can potentially rewrite existing tiles, which can complicate your
> > > > initial coding.
> > > > 
> > > > > QuiteDelete() method is called in both cases and the following
> > > > > error messages are shown
> > > > > ERROR 1: Couldn't drop the table public.newtable: ERROR:  table
> > > > 
> > > > "newtable"
> > > > 
> > > > > does not exist
> > > > > ERROR 6: PostGISRasterDataset::CreateCopy() only works on source
> > > > > datasets that are PostGISRaster
> > > > 
> > > > Yes, as the message implies, the current CreateCopy() implementation
> > 
> > only
> > 
> > > > works when the source dataset is a postgisraster dataset itself.
> > > > As far as the error message "Couldn't drop ...",
> > > > PostGISRasterDataset::Delete() should probably be more silent in case
> > 
> > the
> > 
> > > > dataset doesn't exist.
> > > > 
> > > > Note that once you have a full feature Create() implementation (with
> > > > working
> > > > IWriteBlock() of course), CreateCopy() is no longer strictly needed,
> > > > since there is generic implementation in GDAL core that will emulate
> > > > CreateCopy() with Create() + IWriteBlock()
> > > > 
> > > > > I even tried calling the Create() method directly from
> > > > > CreateCopy(),
> > > > 
> > > > since
> > > > 
> > > > > that is being called, but again the same error message is being
> > > > > printed.
> > > > > 
> > > > > Regards,
> > > > > Varun Saraf
> > > > > 
> > > > > On Mon, Aug 4, 2014 at 11:33 PM, Even Rouault
> > > > > <even.rouault at mines-paris.org>
> > > > > 
> > > > > wrote:
> > > > > > Le lundi 04 ao?t 2014 14:39:52, Varun Saraf a ?crit :
> > > > > > >  Hi,
> > > > > > > 
> > > > > > > Below is my eleventh weekly report.
> > > > > > > 
> > > > > > > *What did I do this week?*
> > > > > > > 
> > > > > > >    - There are some issues with the calling of different
> > > > > > >    methods. My
> > > > > > 
> > > > > > method
> > > > > > 
> > > > > > >    PostGISRasterDataset::Create() is not being called. Tried to
> > > > 
> > > > resolve
> > > > 
> > > > > > > that.
> > > > > > 
> > > > > > Varun,
> > > > > > 
> > > > > > If the code at
> > 
> > https://github.com/varunsaraf/postgis_raster/blob/master/postgisrasterdat
> > 
> > > > > > aset.cpp is the latest state, I don't see any reason why your
> > > > > > Create() method wouldn't
> > > > > > be called. Do you try to trigger it directly by calling Create()
> > > > > > explicetely
> > > > > > or through other more high level operations ?
> > > > > > 
> > > > > > Even
> > > > > > 
> > > > > > > - Fixed some small bugs and removed unnecessary variables that
> > 
> > were
> > 
> > > > > > > being used.
> > > > > > > 
> > > > > > > *What do I plan on doing next week?*
> > > > > > > 
> > > > > > >    - Continue with testing and bug fixing.
> > > > > > > 
> > > > > > > *Am I blocked on anything?*
> > > > > > > 
> > > > > > >    - No.
> > > > > > > 
> > > > > > > Link to weekly report :
> > > > > > > https://github.com/varunsaraf/postgis_raster/wiki/Report-11
> > > > 
> > > > > > > Link to code repository :
> > > > https://github.com/varunsaraf/postgis_raster
> > > > 
> > > > > > > More details at :
> > > > http://trac.osgeo.org/gdal/wiki/PostGIS_raster_driver
> > > > 
> > > > > > > Regards,
> > > > > > > Varun Saraf
> > > > > > > Lab for Spatial Informatics
> > > > > > > IIIT Hyderabad, India
> > > > > > 
> > > > > > --
> > > > > > Geospatial professional services
> > > > > > http://even.rouault.free.fr/services.html
> > > > 
> > > > --
> > > > Geospatial professional services
> > > > http://even.rouault.free.fr/services.html
> > 
> > --
> > Geospatial professional services
> > http://even.rouault.free.fr/services.html

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From antti.castren at iki.fi  Wed Aug  6 05:52:32 2014
From: antti.castren at iki.fi (=?UTF-8?Q?Antti_Castr=C3=A9n?=)
Date: Wed, 6 Aug 2014 15:52:32 +0300
Subject: [gdal-dev] [PATCH v2] Support Mercator_2SP in GeoTIFF
In-Reply-To: <CAPcvoOJBbV4Mk=PEALu8kLgYz=fTwTg-r3Rv0xONfGX6jzevOQ@mail.gmail.com>
References: <CAPcvoOJctLnpVBa=X9V0HHELv1vvRjbGzhuHNc0zsNptUkNrfw@mail.gmail.com>
	<CA+7tXiga3wM_eQnb4vg=aPEpJnDNa3b+HRyhEwDkDighMFfe=g@mail.gmail.com>
	<CAPcvoOLeCJVm_=VqAKhN5owdRwQ_sNNSX7LHfV1fuJTOdjsVLA@mail.gmail.com>
	<CA+7tXihgJrv7qCVPPh+Q8J7P-jjSYH8wTWZETbCk0WSnOe7EDA@mail.gmail.com>
	<CAPcvoOJBbV4Mk=PEALu8kLgYz=fTwTg-r3Rv0xONfGX6jzevOQ@mail.gmail.com>
Message-ID: <CAPcvoOKziQSR9HtTB216gO8QomOLGF3qXRBFo9bBB6=qey4TfQ@mail.gmail.com>

Hello again,

Because of few customer cases I had to look this GeoTIFF/CT_Mercator
issue once again, this time in depth.

I studied how three software packages write GeoTIFFs as well as how
they read different combination of keys. These software are

GeoMedia Professional 06.01.11.13
ArcGIS Desktop 10 SP4
FME Desktop 2013 SP1

Test case is a Finnish navigational chart, projected mercator with
standard parallel (ie. latitude of true scale) 60d20m on GRS80
ellipsoid.

Geomedia writes following projection related keys:
ProjNatOriginLongGeoKey = 0
ProjNatOriginLatGeoKey = 0
ProjFalseEastingGeoKey = 0
ProjFalseNorthingGeoKey = 0
ProjCenterLatGeoKey = 60.3333333
ProjScaleAtNatOriginGeoKey = 0.496208843

Geomedia clearly writes
http://www.remotesensing.org/geotiff/proj_list/mercator_1sp.html type
of keys with an odd addition of ProjCenterLatGeoKey having the value
of standard parallel.


ArcGIS writes following projection related keys:
ProjNatOriginLongGeoKey = 0
ProjNatOriginLatGeoKey = 60.3333333
ProjFalseEastingGeoKey = 0
ProjFalseNorthingGeoKey = 0
ProjScaleAtNatOriginGeoKey = 1

ArcGIS writes something more like
http://www.remotesensing.org/geotiff/proj_list/mercator_2sp.html type
of information, but in wrong keys. Standard parallel should be written
in ProjStdParallel1GeoKey and ProjNatOriginLatGeoKey should equal 0.
Also the scale factor is unnecessary and actually it is harmful since
it gives wrong scale value for correct origin latitude.

FME writes the same way as ArcGIS.


After trying some 20 different GeoKey combinations using geotifcp I
was able to find following behaviour in reading the projection
information:
1. ProjStdParallel1GeoKey is read by ArcGIS only, and it is primary
source of scaling information for ArcGIS.
2. If ProjStdParallel1GeoKey is not populated then ArcGIS tries to
find latitude of true scale in ProjNatOriginLatGeoKey
3. If neither one of previous keys are not populated then ArcGIS tries
to find latitude of true scale in ProjCenterLatGeoKey.
4. ArcGIS does not read ProjScaleAtNatOriginGeoKey at all.

5. Geomedia needs ProjScaleAtNatOriginGeoKey and either
ProjNatOriginLatGeoKey or ProjCenterLatGeoKey to open the file in the
first place.
6. Geomedia reads ProjNatOriginLatGeoKey and ProjCenterLatGeoKey as
origin information (which is the correct way IMHO)

7. FME reads otherwise as ArcGIS, but it does not read ProjStdParallel1GeoKey

Since I did not study ALL the possible combinations of relevant
GeoKeys there could be some errors, but I doubt it.

So my conclusion is that it is possible to write GeoTIFF in a way that
both Geomedia and ArcGIS read it the correct way. It is achieved by
populating following keys:
ProjStdParallel1GeoKey = 60.3333333 (this makes ArcGIS happy)
ProjNatOriginLongGeoKey = 0 (Geomedia needs this)
ProjNatOriginLatGeoKey = 0
ProjFalseEastingGeoKey = 0
ProjFalseNorthingGeoKey = 0
ProjScaleAtNatOriginGeoKey = 0.496208843 (Geomedia needs this)

This is also correct combination of mercator1sp and mercator2sp

Unfortunately FME does not fit in since it reads
ProjNatOriginLatGeoKey value as latitude of true scale the same time
as Geomedia treats it as latitude of origin. Therefore FME shows the
chart to be in Tunisia instead of Gulf of Finland.

Other bad combinations are the ones where ProjNatOriginLatGeoKey has
the value of latitude of true scale and the Geomedia uses that value
as latitude of origin and either scale factor 1 or 0.496208843.
Therefore Geomedia shows the chart to be in vicinity of Spitsbergen
either South or North of the islands respectively.


I don't know if these findings have any impact on development of gdal,
but at least they give some insight to the issue. Hopefully we see
some development on the above mentioned GIS software also.

Cheers,

  Antti

2013-11-23 0:18 GMT+02:00 Antti Castr?n <antti.castren at iki.fi>:
> Hi Trent et al.
>
> Thanks for your work on the issue.
>
> I tested the files, and results were not satisfactory. But at least we
> got more information on the issue.
>
> FME opened both files.
>
> The georeferencing of 18440_lowres_nol.tif was recognized by FME as:
> DESC_NM: Global Mercator
> DT_NAME: NAD83
> PARM2: 47.667
> PROJ: MRCAT
> UNIT: METER
>
> This should place the file at correct location.
>
> The georeferencing of 18440_lowres_sp1.tif was recognized by FME as:
> DESC_NM: Global Mercator
> DT_NAME: NAD83
> PROJ: MRCAT
> UNIT: METER
>
> To compare to the first file which you provided last week, its FME
> parameters were:
> DESC_NM: Global Mercator
> DT_NAME: NAD83
> PROJ: MRCAT
> UNIT: METER
>
> It seems FME doesn't read StdParallel1 or at least it doesn't use it.
>
> Geomedia did NOT recognize either of the files as valid GeoTIFF.
>
> To get projection (and of course location) right GeoMedia reads following keys:
>       ProjCoordTransGeoKey (Short,1): CT_Mercator
>       ProjLinearUnitsGeoKey (Short,1): Linear_Meter
>       ProjNatOriginLongGeoKey (Double,1): 0
>       ProjNatOriginLatGeoKey (Double,1): 0
>       ProjFalseEastingGeoKey (Double,1): 0
>       ProjFalseNorthingGeoKey (Double,1): 0
>       ProjCenterLatGeoKey (Double,1): 60.7666667
>       ProjScaleAtNatOriginGeoKey (Double,1): 0.48961699
>
> These keys are (in my humble opinion) logical and the most correct
> ones. Of course there is some redundancy. Unfortunately FME and ArcGIS
> don't read last two at all, and therefore they place the file as if it
> was projected from the Equator with scale 0.
>
> ArcGIS opened all your three files at correct location.
>
> By the way, I have seen that many sofware which are able to
> interchange latitude of true scale and scalefactor at the Equator fail
> to do the calculation with enough decimal places. My experience is
> that you need at least 8 decimal places in scale factor to align your
> raster data correctly. (As seen in the GeoMedia example above)
>
> Br,
>
>   Antti
>
> 2013/11/20 Trent Piepho <tpiepho at gmail.com>:
>> Antii,
>>
>> Thank you for the testing.  It looks like Arc/GIS works while FME and
>> Intergraph don't.
>>
>> That file had both StdParallel1 and ScaleAtNatOrigin defined.
>>
>> I've uploaded two new files.  This one has only StdParallel1 defined with no
>> ScaleAtNatOrigin.
>> https://drive.google.com/file/d/0BybuTedE9CLxRnNlNUl2Zm5JRzg/edit?usp=sharing
>>
>> This file has the lat_ts stored in NatOriginLat and no ScaleAtNatOrigin
>> defined.
>> https://drive.google.com/file/d/0BybuTedE9CLxMzltYlBFWU51RzA/edit?usp=sharing
>>
>> I think the latter might have better compatibility.  Yet it seems to clearly
>> be the incorrect way to do it.
>>
>>
>> On Mon, Nov 18, 2013 at 4:54 AM, Antti Castr?n <antti.castren at iki.fi> wrote:
>>>
>>> Hi Trent,
>>>
>>> The chart  opens in ArcMap (ArcGIS 10.0) well, and it is in right
>>> location (Seattle).
>>>
>>> Relevant properties of the file as seen by ArcGIS:
>>> Cell Size: 240.003787, 240.003787
>>> Extent
>>> Top:4143530.20898
>>> Left: -9278434.53415
>>> Right:  -9165872.75807
>>> Bottom:  3984167.69444
>>> Spatial Reference: Global Mercator
>>> Linear Unit: Meter
>>> false_easting: 0
>>> false_northing: 0
>>> central_meridian: 0
>>> standard_parallel_1:  47.667
>>> Datum: D_North_American_1983
>>>
>>>
>>> I opened the file in FME Data Inspector (FME Desktop 2013 SP1) also.
>>> It did not read the latitude of true scale from the
>>> ProjStdParallel1GeoKey as you can see from the following parameters.
>>> Therefore it places the chart to NE Georgia/NW South Carolina as if
>>> the latitude of true scale was the Equator.
>>>
>>> <FME Parameters>
>>> Coordinate System Parameters
>>> CS_NAME: _FME_0
>>> DESC_NM: Global Mercator
>>> DT_NAME: NAD83
>>> PROJ: MRCAT
>>> UNIT: METER
>>>
>>> Datum Parameters
>>> DESC_NM: NAD 1983, Alaska, Canada,Continental US,Mexico,Central America
>>> ELLIPSOID: GRS1980
>>> SOURCE: US Defense Mapping Agency, TR-8350.2-B, August 1993
>>> USE: NAD83
>>>
>>> Ellipsoid Parameters
>>> DESC_NM: Geodetic Reference System of 1980
>>> E_RAD: 6378137
>>> P_RAD: 6356752.3141403478
>>> SOURCE: Stem, L.E., Jan 1989, State Plane Coordinate System of 1983
>>>
>>> OGC WKT Description
>>> PROJCS["Global Mercator",
>>>     GEOGCS["NAD83",
>>>         DATUM["North_American_Datum_1983",
>>>             SPHEROID["Geodetic Reference System of
>>> 1980",6378137,298.2572221008916,
>>>                 AUTHORITY["EPSG","7019"]],
>>>             AUTHORITY["EPSG","6269"]],
>>>         PRIMEM["Greenwich",0],
>>>         UNIT["degree",0.0174532925199433],
>>>         AUTHORITY["EPSG","4269"]],
>>>     PROJECTION["Mercator_1SP"],
>>>     PARAMETER["central_meridian",0],
>>>     PARAMETER["scale_factor",1],
>>>     PARAMETER["false_easting",0],
>>>     PARAMETER["false_northing",0],
>>>     UNIT["METER",1]]
>>>
>>> Esri WKT Description
>>>
>>> PROJCS["Global_Mercator",GEOGCS["GCS_North_American_1983",DATUM["D_North_American_1983",SPHEROID["Geodetic_Reference_System_of_1980",6378137,298.2572221008916]],PRIMEM["Greenwich",0],UNIT["Degree",0.017453292519943295]],PROJECTION["Mercator"],PARAMETER["central_meridian",0],PARAMETER["false_easting",0],PARAMETER["false_northing",0],UNIT["Meter",1],PARAMETER["standard_parallel_1",0.0]]
>>> </FME Parameters>
>>>
>>> Intergraph's Geomedia Professional recognises the file as GeoTIFF, but
>>> the chart appears to be in the same false place as with FME.
>>>
>>> If you want, I could update the file's georeferencing by FME and
>>> Geomedia so that location is correct. Then I could send listgeo
>>> information or even put the actual files available if desired.
>>>
>>> The goal is, of course, to get various software vendors to use the
>>> GeoTIFF-information the same way. Hopefully the common way would also
>>> be logically correct, but I guess that's too much to ask.
>>>
>>> Best regards,
>>>
>>>   Antti
>>>
>>>
>>> Here is the listgeo info from the original file for those who are
>>> interested:
>>>
>>> Geotiff_Information:
>>>    Version: 1
>>>    Key_Revision: 1.0
>>>    Tagged_Information:
>>>       ModelTiepointTag (2,3):
>>>          0                0                0
>>>          -9278434.53      4143530.21       0
>>>       ModelPixelScaleTag (1,3):
>>>          240.003787       240.003787       0
>>>       End_Of_Tags.
>>>    Keyed_Information:
>>>       GTModelTypeGeoKey (Short,1): ModelTypeProjected
>>>       GTRasterTypeGeoKey (Short,1): RasterPixelIsArea
>>>       GTCitationGeoKey (Ascii,16): "Global Mercator"
>>>       GeographicTypeGeoKey (Short,1): GCS_NAD83
>>>       GeogCitationGeoKey (Ascii,6): "NAD83"
>>>       GeogAngularUnitsGeoKey (Short,1): Angular_Degree
>>>       GeogSemiMajorAxisGeoKey (Double,1): 6378137
>>>       GeogInvFlatteningGeoKey (Double,1): 298.257222
>>>       Unknown-2062 (Double,3): 0                0                0
>>>       ProjectedCSTypeGeoKey (Short,1): User-Defined
>>>       ProjectionGeoKey (Short,1): User-Defined
>>>       ProjCoordTransGeoKey (Short,1): CT_Mercator
>>>       ProjLinearUnitsGeoKey (Short,1): Linear_Meter
>>>       ProjStdParallel1GeoKey (Double,1): 47.667
>>>       ProjNatOriginLongGeoKey (Double,1): 0
>>>       ProjNatOriginLatGeoKey (Double,1): 0
>>>       ProjFalseEastingGeoKey (Double,1): 0
>>>       ProjFalseNorthingGeoKey (Double,1): 0
>>>       ProjScaleAtNatOriginGeoKey (Double,1): 1
>>>       End_Of_Keys.
>>>    End_Of_Geotiff.
>>> Projection Method: CT_Mercator
>>>    ProjNatOriginLatGeoKey: 0.000000 (  0d 0' 0.00"N)
>>>    ProjNatOriginLongGeoKey: 0.000000 (  0d 0' 0.00"E)
>>>    ProjScaleAtNatOriginGeoKey: 1.000000
>>>    ProjFalseEastingGeoKey: 0.000000 m
>>>    ProjFalseNorthingGeoKey: 0.000000 m
>>> GCS: 4269/NAD83
>>> Datum: 6269/North American Datum 1983
>>> Ellipsoid: 7019/GRS 1980 (6378137.00,6356752.31)
>>> Prime Meridian: 8901/Greenwich (0.000000/  0d 0' 0.00"E)
>>> Projection Linear Units: 9001/metre (1.000000m)
>>> Corner Coordinates:
>>> Upper Left    (-9278434.534, 4143530.209)
>>> Lower Left    (-9278434.534, 3984167.694)
>>> Upper Right   (-9165872.758, 4143530.209)
>>> Lower Right   (-9165872.758, 3984167.694)
>>> Center        (-9222153.646, 4063848.952)
>>>
>>>
>>> 2013/11/14 Trent Piepho <tpiepho at gmail.com>:
>>> > It looks like arcgis does not support Mercator_1SP in geotiff files.
>>> > It just ignores the scale factor and uses 1.0.  Which means in GDAL
>>> > and libgeotiff as they are now, there is no way to export Mercator
>>> > projections that don't have a scale of 1.0 to arcgis.
>>> >
>>> > ArcGIS does support Mercator_2SP, but instead of placing the latitude
>>> > of true scale in ProjStdParallel1GeoKey, it uses
>>> > ProjNatOriginLatGeoKey.  Which seems to be plainly wrong, yet that's
>>> > what it does.
>>> >
>>> > I wonder if ESRI used libgeotiff?  With unpatched libgeotiff, the only
>>> > way to get a latitude from a Mercator geotiff it to use one of the
>>> > origin latitude GeoKeys.  It's not correct, but it does allow one to
>>> > stick the number in the file and get it back out without having to
>>> > modify or understand any libgeotiff code.
>>> >
>>> > It's possible that ArcGIS supports getting the latitude of true scale
>>> > from ProjStdParallel1GeoKey, even it it doesn't store it there.
>>> > Antii, could you test this file with ArcGIS?
>>> >
>>> >
>>> > https://drive.google.com/file/d/0BybuTedE9CLxak9iakZRTC00cHM/edit?usp=sharing
>>> >
>>> > Pick file->download to get the geotiff file.
>>> >
>>> > It should have projection information like this:
>>> >     PROJECTION["Mercator_2SP"],
>>> >     PARAMETER["standard_parallel_1",47.667],
>>> >     PARAMETER["central_meridian",0],
>>> >     PARAMETER["false_easting",0],
>>> >     PARAMETER["false_northing",0],
>>> >     UNIT["metre",1,
>>> >         AUTHORITY["EPSG","9001"]]]
>>> > Origin = (-9278434.534151820465922,4143530.208984711207449)
>>> > Pixel Size = (240.003786961970206,-240.003786961970206)
>>> > Corner Coordinates:
>>> > Upper Left  (-9278434.534, 4143530.209) (123d32'26.22"W, 48d23'56.59"N)
>>> > Lower Left  (-9278434.534, 3984167.694) (123d32'26.22"W, 46d57'58.64"N)
>>> > Upper Right (-9165872.758, 4143530.209) (122d 2'30.76"W, 48d23'56.59"N)
>>> > Lower Right (-9165872.758, 3984167.694) (122d 2'30.76"W, 46d57'58.64"N)
>>> > Center      (-9222153.646, 4063848.952) (122d47'28.49"W, 47d41'15.43"N)

From lunzer at gmail.com  Wed Aug  6 10:36:44 2014
From: lunzer at gmail.com (John_Lunzer)
Date: Wed, 6 Aug 2014 10:36:44 -0700 (PDT)
Subject: [gdal-dev] NITF read slow in python
Message-ID: <1407346604745-5155297.post@n6.nabble.com>

I have some not so big NITF files (10000x7000 16bit) that I am reading using
Python. Using the ReadAsArray() method of the data opened via gdal.Open() it
takes about 50 seconds to load a single band. Reading this same file in
GeoTIFF format takes about 2.7 seconds by comparison. 

Does anyone have a clue why the NITF files are taking so much time to read
to Numpy arrays?



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/NITF-read-slow-in-python-tp5155297.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Wed Aug  6 10:54:06 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 6 Aug 2014 19:54:06 +0200
Subject: [gdal-dev] NITF read slow in python
In-Reply-To: <1407346604745-5155297.post@n6.nabble.com>
References: <1407346604745-5155297.post@n6.nabble.com>
Message-ID: <201408061954.06696.even.rouault@spatialys.com>

Le mercredi 06 ao?t 2014 19:36:44, John_Lunzer a ?crit :
> I have some not so big NITF files (10000x7000 16bit) that I am reading
> using Python. Using the ReadAsArray() method of the data opened via
> gdal.Open() it takes about 50 seconds to load a single band. Reading this
> same file in GeoTIFF format takes about 2.7 seconds by comparison.
> 
> Does anyone have a clue why the NITF files are taking so much time to read
> to Numpy arrays?
> 

Is the NITF file JPEG or JPEG-2000 compressed ?

> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/NITF-read-slow-in-python-tp5155297.htm
> l Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From lunzer at gmail.com  Wed Aug  6 11:16:57 2014
From: lunzer at gmail.com (John_Lunzer)
Date: Wed, 6 Aug 2014 11:16:57 -0700 (PDT)
Subject: [gdal-dev] NITF read slow in python
In-Reply-To: <201408061954.06696.even.rouault@spatialys.com>
References: <1407346604745-5155297.post@n6.nabble.com>
	<201408061954.06696.even.rouault@spatialys.com>
Message-ID: <1407349017371-5155304.post@n6.nabble.com>

They are listed as C8, which means JPEG2000 compression.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/NITF-read-slow-in-python-tp5155297p5155304.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Wed Aug  6 11:24:43 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 6 Aug 2014 20:24:43 +0200
Subject: [gdal-dev] NITF read slow in python
In-Reply-To: <1407349017371-5155304.post@n6.nabble.com>
References: <1407346604745-5155297.post@n6.nabble.com>
	<201408061954.06696.even.rouault@spatialys.com>
	<1407349017371-5155304.post@n6.nabble.com>
Message-ID: <201408062024.43394.even.rouault@spatialys.com>

Le mercredi 06 ao?t 2014 20:16:57, John_Lunzer a ?crit :
> They are listed as C8, which means JPEG2000 compression.

That must be it. JPEG2000 decompression takes some time, and that can be more 
or less slow depending on the underlying driver used. Do you have JP2KAK, 
JP2ECW, JP2OPENJPEG, JP2MrSID or JPEG2000 drivers enabled ? (if you have 
several, they are used in the mentionned order)

> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/NITF-read-slow-in-python-tp5155297p515
> 5304.html Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From lunzer at gmail.com  Wed Aug  6 11:38:55 2014
From: lunzer at gmail.com (John_Lunzer)
Date: Wed, 6 Aug 2014 11:38:55 -0700 (PDT)
Subject: [gdal-dev] NITF read slow in python
In-Reply-To: <201408062024.43394.even.rouault@spatialys.com>
References: <1407346604745-5155297.post@n6.nabble.com>
	<201408061954.06696.even.rouault@spatialys.com>
	<1407349017371-5155304.post@n6.nabble.com>
	<201408062024.43394.even.rouault@spatialys.com>
Message-ID: <1407350335154-5155309.post@n6.nabble.com>

The documentation states that Python automatically calls GDALAllRegister()
when the GDAL module is imported. Is there any way to disable this or to
tell GDAL to use a specific driver when loading JPEG2000 compressed images?


Even Rouault-2 wrote
> Le mercredi 06 ao?t 2014 20:16:57, John_Lunzer a ?crit :
>> They are listed as C8, which means JPEG2000 compression.
> 
> That must be it. JPEG2000 decompression takes some time, and that can be
> more 
> or less slow depending on the underlying driver used. Do you have JP2KAK, 
> JP2ECW, JP2OPENJPEG, JP2MrSID or JPEG2000 drivers enabled ? (if you have 
> several, they are used in the mentionned order)
> 
>> 
>> 
>> 
>> --
>> View this message in context:
>> http://osgeo-org.1560.x6.nabble.com/NITF-read-slow-in-python-tp5155297p515
>> 5304.html Sent from the GDAL - Dev mailing list archive at Nabble.com.
>> _______________________________________________
>> gdal-dev mailing list
>> 

> gdal-dev at .osgeo

>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> http://lists.osgeo.org/mailman/listinfo/gdal-dev





--
View this message in context: http://osgeo-org.1560.x6.nabble.com/NITF-read-slow-in-python-tp5155297p5155309.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Wed Aug  6 11:46:05 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 6 Aug 2014 20:46:05 +0200
Subject: [gdal-dev] NITF read slow in python
In-Reply-To: <1407350335154-5155309.post@n6.nabble.com>
References: <1407346604745-5155297.post@n6.nabble.com>
	<201408062024.43394.even.rouault@spatialys.com>
	<1407350335154-5155309.post@n6.nabble.com>
Message-ID: <201408062046.05456.even.rouault@spatialys.com>

Le mercredi 06 ao?t 2014 20:38:55, John_Lunzer a ?crit :
> The documentation states that Python automatically calls GDALAllRegister()
> when the GDAL module is imported. Is there any way to disable this or to
> tell GDAL to use a specific driver when loading JPEG2000 compressed images?

You can do gdal.GetDriverByName(driver_short_name).Deregister() to unregister 
a driver.

> 
> 
> Even Rouault-2 wrote
> 
> > Le mercredi 06 ao?t 2014 20:16:57, John_Lunzer a ?crit :
> >> They are listed as C8, which means JPEG2000 compression.
> > 
> > That must be it. JPEG2000 decompression takes some time, and that can be
> > more
> > or less slow depending on the underlying driver used. Do you have JP2KAK,
> > JP2ECW, JP2OPENJPEG, JP2MrSID or JPEG2000 drivers enabled ? (if you have
> > several, they are used in the mentionned order)
> > 
> >> --
> >> View this message in context:
> >> http://osgeo-org.1560.x6.nabble.com/NITF-read-slow-in-python-tp5155297p5
> >> 15 5304.html Sent from the GDAL - Dev mailing list archive at
> >> Nabble.com. _______________________________________________
> >> gdal-dev mailing list
> > 
> > gdal-dev at .osgeo
> > 
> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > 
> > gdal-dev at .osgeo
> > 
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/NITF-read-slow-in-python-tp5155297p515
> 5309.html Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From david.robison at openroadsconsulting.com  Thu Aug  7 10:05:13 2014
From: david.robison at openroadsconsulting.com (David R. Robison)
Date: Thu, 07 Aug 2014 13:05:13 -0400
Subject: [gdal-dev] Problems using the OCI plugin with ogr2ogr
Message-ID: <53E3B1C9.6020103@openroadsconsulting.com>

I am trying to use ogr2ogr to copy data from Oracle spatial to 
PostgreSQL. My command line is:

OGR2OGR -overwrite -f "PostgreSQL" -s_srs 141122 -t_srs 4326 
PG:"host=localhost user=Postgres password=xxxxxx dbname=penngis" 
OCI:"GEOADMIN/geoadmin@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.117.244)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=penngis))):GEOADMIN.RMSSEG" 
-nln orci_rmsseg

In the log I see:

OGR: Auto register C:\Program Files\GDAL\gdalplugins\ogr_OCI.dll using 
RegisterOGROCI.
OCI: Userid=GEOADMIN, Password=geoadmin, 
Database=(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.117.244)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=penngis)))
ERROR 1:  in <unnamed>
FAILURE:
Unable to open datasource 
`OCI:GEOADMIN/geoadmin@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.117.244)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=penngis))):GEOADMIN.RMSSEG' 
with the following drivers.
   -> OCI
   -> ESRI Shapefile
   ...

It seems it registers the OCI plugin but does not seem to attempt a 
database connection. Any ideas what I may be doing wrong?
David

-- 

David R Robison
Open Roads Consulting, Inc.
103 Watson Road, Chesapeake, VA 23320
phone: (757) 546-3401
e-mail: david.robison at openroadsconsulting.com
web: http://openroadsconsulting.com
blog: http://therobe.blogspot.com
book: http://www.xulonpress.com/bookstore/bookdetail.php?PB_ISBN=9781597816526



This email communication (including any attachments) may contain confidential and/or privileged material intended solely for the individual or entity to which it is addressed.
If you are not the intended recipient, please delete this email immediately.


From david.robison at openroadsconsulting.com  Thu Aug  7 11:18:24 2014
From: david.robison at openroadsconsulting.com (David R. Robison)
Date: Thu, 07 Aug 2014 14:18:24 -0400
Subject: [gdal-dev] Problems using the OCI plugin with ogr2ogr
In-Reply-To: <53E3B1C9.6020103@openroadsconsulting.com>
References: <53E3B1C9.6020103@openroadsconsulting.com>
Message-ID: <53E3C2F0.2090400@openroadsconsulting.com>

Looking at wireshark it appears that it never attempts a TCP connection 
to the database. David

David R Robison
Open Roads Consulting, Inc.
103 Watson Road, Chesapeake, VA 23320
phone: (757) 546-3401
e-mail: david.robison at openroadsconsulting.com
web: http://openroadsconsulting.com
blog: http://therobe.blogspot.com
book: http://www.xulonpress.com/bookstore/bookdetail.php?PB_ISBN=9781597816526

On 8/7/2014 1:05 PM, David R. Robison wrote:
> I am trying to use ogr2ogr to copy data from Oracle spatial to
> PostgreSQL. My command line is:
>
> OGR2OGR -overwrite -f "PostgreSQL" -s_srs 141122 -t_srs 4326
> PG:"host=localhost user=Postgres password=xxxxxx dbname=penngis"
> OCI:"GEOADMIN/geoadmin@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.117.244)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=penngis))):GEOADMIN.RMSSEG"
> -nln orci_rmsseg
>
> In the log I see:
>
> OGR: Auto register C:\Program Files\GDAL\gdalplugins\ogr_OCI.dll using
> RegisterOGROCI.
> OCI: Userid=GEOADMIN, Password=geoadmin,
> Database=(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.117.244)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=penngis)))
> ERROR 1:  in <unnamed>
> FAILURE:
> Unable to open datasource
> `OCI:GEOADMIN/geoadmin@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.117.244)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=penngis))):GEOADMIN.RMSSEG'
> with the following drivers.
>     -> OCI
>     -> ESRI Shapefile
>     ...
>
> It seems it registers the OCI plugin but does not seem to attempt a
> database connection. Any ideas what I may be doing wrong?
> David
>



This email communication (including any attachments) may contain confidential and/or privileged material intended solely for the individual or entity to which it is addressed.
If you are not the intended recipient, please delete this email immediately.


From pramsey at cleverelephant.ca  Thu Aug  7 11:30:25 2014
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Thu, 7 Aug 2014 11:30:25 -0700
Subject: [gdal-dev] GPKG application_id
Message-ID: <etPan.53e3c5c2.431bd7b7.e15a@Butterfly.local>

As we found when developing gpkg, setting the PRAGMA application_id can be tricky given the general state of installed sqlite libraries on a randomly chosen system: generally, the libraries are old enough to not support that pragma!

We ended up hacking around it by directly editing the bytes in the file header.

Others are less likely. I?ve learned that GeoServer is emitted GPKG files without the application_id set.

Right now, OGR GPKG driver is strict: fail on wrong application_id. I?d like to make it more lenient: warn on wrong application_id. We can always fail later if required tables are missing, etc.

Is it OK to make this change in trunk? In 1.12 or 1.11 branch?

P.

--?
Paul Ramsey
http://cleverelephant.ca
http://postgis.net
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140807/b817e7fc/attachment.html>

From even.rouault at spatialys.com  Thu Aug  7 11:37:40 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 7 Aug 2014 20:37:40 +0200
Subject: [gdal-dev] GPKG application_id
In-Reply-To: <etPan.53e3c5c2.431bd7b7.e15a@Butterfly.local>
References: <etPan.53e3c5c2.431bd7b7.e15a@Butterfly.local>
Message-ID: <201408072037.40950.even.rouault@spatialys.com>

Hi Paul,

> As we found when developing gpkg, setting the PRAGMA application_id can be
> tricky given the general state of installed sqlite libraries on a randomly
> chosen system: generally, the libraries are old enough to not support that
> pragma!

For reference: old sqlite lib can be a problem for another reason. When 
implementing spatial index, I discovered that my antique sqlite 3.6.22-1 
(ubuntu 10.04) has issues with some of the required triggers, in some 
conditions (update situations with null geometries)

> 
> We ended up hacking around it by directly editing the bytes in the file
> header.
> 
> Others are less likely. I?ve learned that GeoServer is emitted GPKG files
> without the application_id set.

Hum, do they plan fixing that at some point ? Couldn't they do the same trick 
we do (direct editing) ?

> 
> Right now, OGR GPKG driver is strict: fail on wrong application_id. I?d
> like to make it more lenient: warn on wrong application_id. We can always
> fail later if required tables are missing, etc.
> 
> Is it OK to make this change in trunk? In 1.12 or 1.11 branch?

trunk (2.0dev) and 1.11 branch are fine (there's no 1.12)

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From varunsaraf14 at gmail.com  Thu Aug  7 12:11:13 2014
From: varunsaraf14 at gmail.com (Varun Saraf)
Date: Fri, 8 Aug 2014 00:41:13 +0530
Subject: [gdal-dev] GSoC 2014 Weekly Report 11 : GDAL PostGIS Raster
	driver
In-Reply-To: <201408042302.37488.even.rouault@mines-paris.org>
References: <CAPfr+rsQfdOrwKSCU0hdJOJw6LJTDa6=6oi9PRaVeF3yg4ej-g@mail.gmail.com>
	<201408042242.39778.even.rouault@mines-paris.org>
	<CAPfr+rt3JmU9h+m79wEcMQH=oukc_WH2YvrsWn6Du-D7vgSSag@mail.gmail.com>
	<201408042302.37488.even.rouault@mines-paris.org>
Message-ID: <CAPfr+rtk6eVPQza7EA_9kOwj3vYJSt3Q3C+EB_+CUCsAB3LGQQ@mail.gmail.com>

Hello,

After Create() exists, SetProjection is called. For my given input, the
variable pszProjectionRef has a value :
PROJCS["WGS 84 / UTM zone 44N",GEOGCS["WGS
84",DATUM["WGS_1984",SPHEROID["WGS
84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433],AUTHORITY["EPSG","4326"]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",81],PARAMETER["scale_factor",0.9996],PARAMETER["false_easting",500000],PARAMETER["false_northing",0],UNIT["metre",1,AUTHORITY["EPSG","9001"]],AUTHORITY["EPSG","32644"]]

This value is different from the value present in the
PostGIS spatial_ref_sys table which is:
PROJCS["WGS 84 / UTM zone 44N",GEOGCS["WGS
84",DATUM["WGS_1984",SPHEROID["WGS
84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4326"]],UNIT["metre",1,AUTHORITY["EPSG","9001"]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",81],PARAMETER["scale_factor",0.9996],PARAMETER["false_easting",500000],PARAMETER["false_northing",0],AUTHORITY["EPSG","32644"],AXIS["Easting",EAST],AXIS["Northing",NORTH]]

I found the below solution [1] to get proj4text from srtext which can be
converted to srid. Any alternate suggestions?

[1]
http://gis.stackexchange.com/questions/95831/how-can-i-get-proj4text-from-srtext

Regards,
Varun Saraf


On Tue, Aug 5, 2014 at 2:32 AM, Even Rouault <even.rouault at mines-paris.org>
wrote:

> Le lundi 04 ao?t 2014 22:53:03, Varun Saraf a ?crit :
> > Hello,
> >
> > Commenting poDriver->pfnCreateCopy doesn't seem to work. It is still
> > calling the CreateCopy() method.
>
> Check twice... How could GDAL call PostgisRasterDataset::CreateCopy() is
> nothing points to it ?
>
> > I will try doing the testing with a script
> > and get back to you.
> >
> > Regards,
> > Varun Saraf
> >
> >
> > On Tue, Aug 5, 2014 at 2:12 AM, Even Rouault <
> even.rouault at mines-paris.org>
> >
> > wrote:
> > > Le lundi 04 ao?t 2014 22:38:20, Varun Saraf a ?crit :
> > > > Hello,
> > > >
> > > > Thank you for this information. I will explicitly call Create()
> using a
> > > > script. Is the IWriteBlock method to be tested in a similar manner?
> > > > Note that pData buffer is passed to this method as an argument, which
> > > > I will have to generate and pass to it. Any suggestions how I should
> > > > generate
> > >
> > > this
> > >
> > > > pData buffer?
> > >
> > > Well, any data might do.
> > > But based on my previous note regarding the generic GDAL core
> > > CreateCopy() implementation, another possibility for your testing is to
> > > temporarily comment
> > > poDriver->pfnCreateCopy = .... and use gdal_translate.
> > >
> > > > Regards,
> > > > Varun Saraf
> > > >
> > > >
> > > > On Tue, Aug 5, 2014 at 1:44 AM, Even Rouault <
> > >
> > > even.rouault at mines-paris.org>
> > >
> > > > wrote:
> > > > > Le lundi 04 ao?t 2014 21:38:36, Varun Saraf a ?crit :
> > > > > > Hello,
> > > > > >
> > > > > > Yes, the code on the github repository is the latest state. I was
> > > > > > trying the following input queries :
> > > > > >
> > > > > > (1) Assuming that my Create() will be called.
> > > > > > gdal_translate --debug ON -of PostGISRaster ~/GSoC/ap_clip5x5.tif
> > > > > >
> > > > > >  PG:"host=localhost port=5432 user=postgres password=postgres
> > > > > >
> > > > > > dbname=test123 table=newtable"
> > > > > >
> > > > > > (2) When that did not work, I tried the following (suggested by
> my
> > > > >
> > > > > mentor,
> > > > >
> > > > > > Jorge Arevalo) which didn't work either.
> > > > > > gdal_translate --debug ON -of PostGISRaster -outsize 50% 50%
> > > > > > ~/GSoC/ap_clip5x5.tif  PG:"host=localhost port=5432 user=postgres
> > > > > > password=postgres dbname=test123 table=newtable"
> > > > >
> > > > > gdal_translate will never call Create(), but only CreateCopy().
> > > > >
> > > > > You might want to call Create() directly with a Python script for
> > > > > example, or
> > > > > a sample C/C++ code. gdalwarp will call Create() too, but gdalwarp
> > > > > can potentially rewrite existing tiles, which can complicate your
> > > > > initial coding.
> > > > >
> > > > > > QuiteDelete() method is called in both cases and the following
> > > > > > error messages are shown
> > > > > > ERROR 1: Couldn't drop the table public.newtable: ERROR:  table
> > > > >
> > > > > "newtable"
> > > > >
> > > > > > does not exist
> > > > > > ERROR 6: PostGISRasterDataset::CreateCopy() only works on source
> > > > > > datasets that are PostGISRaster
> > > > >
> > > > > Yes, as the message implies, the current CreateCopy()
> implementation
> > >
> > > only
> > >
> > > > > works when the source dataset is a postgisraster dataset itself.
> > > > > As far as the error message "Couldn't drop ...",
> > > > > PostGISRasterDataset::Delete() should probably be more silent in
> case
> > >
> > > the
> > >
> > > > > dataset doesn't exist.
> > > > >
> > > > > Note that once you have a full feature Create() implementation
> (with
> > > > > working
> > > > > IWriteBlock() of course), CreateCopy() is no longer strictly
> needed,
> > > > > since there is generic implementation in GDAL core that will
> emulate
> > > > > CreateCopy() with Create() + IWriteBlock()
> > > > >
> > > > > > I even tried calling the Create() method directly from
> > > > > > CreateCopy(),
> > > > >
> > > > > since
> > > > >
> > > > > > that is being called, but again the same error message is being
> > > > > > printed.
> > > > > >
> > > > > > Regards,
> > > > > > Varun Saraf
> > > > > >
> > > > > > On Mon, Aug 4, 2014 at 11:33 PM, Even Rouault
> > > > > > <even.rouault at mines-paris.org>
> > > > > >
> > > > > > wrote:
> > > > > > > Le lundi 04 ao?t 2014 14:39:52, Varun Saraf a ?crit :
> > > > > > > >  Hi,
> > > > > > > >
> > > > > > > > Below is my eleventh weekly report.
> > > > > > > >
> > > > > > > > *What did I do this week?*
> > > > > > > >
> > > > > > > >    - There are some issues with the calling of different
> > > > > > > >    methods. My
> > > > > > >
> > > > > > > method
> > > > > > >
> > > > > > > >    PostGISRasterDataset::Create() is not being called. Tried
> to
> > > > >
> > > > > resolve
> > > > >
> > > > > > > > that.
> > > > > > >
> > > > > > > Varun,
> > > > > > >
> > > > > > > If the code at
> > >
> > >
> https://github.com/varunsaraf/postgis_raster/blob/master/postgisrasterdat
> > >
> > > > > > > aset.cpp is the latest state, I don't see any reason why your
> > > > > > > Create() method wouldn't
> > > > > > > be called. Do you try to trigger it directly by calling
> Create()
> > > > > > > explicetely
> > > > > > > or through other more high level operations ?
> > > > > > >
> > > > > > > Even
> > > > > > >
> > > > > > > > - Fixed some small bugs and removed unnecessary variables
> that
> > >
> > > were
> > >
> > > > > > > > being used.
> > > > > > > >
> > > > > > > > *What do I plan on doing next week?*
> > > > > > > >
> > > > > > > >    - Continue with testing and bug fixing.
> > > > > > > >
> > > > > > > > *Am I blocked on anything?*
> > > > > > > >
> > > > > > > >    - No.
> > > > > > > >
> > > > > > > > Link to weekly report :
> > > > > > > > https://github.com/varunsaraf/postgis_raster/wiki/Report-11
> > > > >
> > > > > > > > Link to code repository :
> > > > > https://github.com/varunsaraf/postgis_raster
> > > > >
> > > > > > > > More details at :
> > > > > http://trac.osgeo.org/gdal/wiki/PostGIS_raster_driver
> > > > >
> > > > > > > > Regards,
> > > > > > > > Varun Saraf
> > > > > > > > Lab for Spatial Informatics
> > > > > > > > IIIT Hyderabad, India
> > > > > > >
> > > > > > > --
> > > > > > > Geospatial professional services
> > > > > > > http://even.rouault.free.fr/services.html
> > > > >
> > > > > --
> > > > > Geospatial professional services
> > > > > http://even.rouault.free.fr/services.html
> > >
> > > --
> > > Geospatial professional services
> > > http://even.rouault.free.fr/services.html
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140808/3ff3faee/attachment.html>

From even.rouault at spatialys.com  Thu Aug  7 12:20:41 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 7 Aug 2014 21:20:41 +0200
Subject: [gdal-dev] GSoC 2014 Weekly Report 11 : GDAL PostGIS Raster
	driver
In-Reply-To: <CAPfr+rtk6eVPQza7EA_9kOwj3vYJSt3Q3C+EB_+CUCsAB3LGQQ@mail.gmail.com>
References: <CAPfr+rsQfdOrwKSCU0hdJOJw6LJTDa6=6oi9PRaVeF3yg4ej-g@mail.gmail.com>
	<201408042302.37488.even.rouault@mines-paris.org>
	<CAPfr+rtk6eVPQza7EA_9kOwj3vYJSt3Q3C+EB_+CUCsAB3LGQQ@mail.gmail.com>
Message-ID: <201408072120.41554.even.rouault@spatialys.com>

Le jeudi 07 ao?t 2014 21:11:13, Varun Saraf a ?crit :
> Hello,
> 
> After Create() exists, SetProjection is called. For my given input, the
> variable pszProjectionRef has a value :
> PROJCS["WGS 84 / UTM zone 44N",GEOGCS["WGS
> 84",DATUM["WGS_1984",SPHEROID["WGS
> 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"
> ]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433],AUTHORITY["EPSG"
> ,"4326"]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",
> 0],PARAMETER["central_meridian",81],PARAMETER["scale_factor",0.9996],PARAME
> TER["false_easting",500000],PARAMETER["false_northing",0],UNIT["metre",1,AU
> THORITY["EPSG","9001"]],AUTHORITY["EPSG","32644"]]
> 
> This value is different from the value present in the
> PostGIS spatial_ref_sys table which is:
> PROJCS["WGS 84 / UTM zone 44N",GEOGCS["WGS
> 84",DATUM["WGS_1984",SPHEROID["WGS
> 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"
> ]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.017453292
> 5199433,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4326"]],UNIT["metre",1,
> AUTHORITY["EPSG","9001"]],PROJECTION["Transverse_Mercator"],PARAMETER["lati
> tude_of_origin",0],PARAMETER["central_meridian",81],PARAMETER["scale_factor
> ",0.9996],PARAMETER["false_easting",500000],PARAMETER["false_northing",0],A
> UTHORITY["EPSG","32644"],AXIS["Easting",EAST],AXIS["Northing",NORTH]]
> 
> I found the below solution [1] to get proj4text from srtext which can be
> converted to srid. Any alternate suggestions?

Even if the WKT are a bit different, what is the problem exactly ? You've been 
provided a SRS whose autority code is 32644, and that exists in 
spatial_ref_sys, so nothing to do. Just reuse the SRID matching the entry 
(which should be 32644 as well).
If you are interested in a logic to determine the SRID of a given SRS, and 
potentially add a new entry it in spatial_ref_sys, then 
OGRPGDataSource::FetchSRSId() is exactly what you want.

> 
> [1]
> http://gis.stackexchange.com/questions/95831/how-can-i-get-proj4text-from-s
> rtext
> 
> Regards,
> Varun Saraf
> 
> 
> On Tue, Aug 5, 2014 at 2:32 AM, Even Rouault <even.rouault at mines-paris.org>
> 
> wrote:
> > Le lundi 04 ao?t 2014 22:53:03, Varun Saraf a ?crit :
> > > Hello,
> > > 
> > > Commenting poDriver->pfnCreateCopy doesn't seem to work. It is still
> > > calling the CreateCopy() method.
> > 
> > Check twice... How could GDAL call PostgisRasterDataset::CreateCopy() is
> > nothing points to it ?
> > 
> > > I will try doing the testing with a script
> > > and get back to you.
> > > 
> > > Regards,
> > > Varun Saraf
> > > 
> > > 
> > > On Tue, Aug 5, 2014 at 2:12 AM, Even Rouault <
> > 
> > even.rouault at mines-paris.org>
> > 
> > > wrote:
> > > > Le lundi 04 ao?t 2014 22:38:20, Varun Saraf a ?crit :
> > > > > Hello,
> > > > > 
> > > > > Thank you for this information. I will explicitly call Create()
> > 
> > using a
> > 
> > > > > script. Is the IWriteBlock method to be tested in a similar manner?
> > > > > Note that pData buffer is passed to this method as an argument,
> > > > > which I will have to generate and pass to it. Any suggestions how
> > > > > I should generate
> > > > 
> > > > this
> > > > 
> > > > > pData buffer?
> > > > 
> > > > Well, any data might do.
> > > > But based on my previous note regarding the generic GDAL core
> > > > CreateCopy() implementation, another possibility for your testing is
> > > > to temporarily comment
> > > > poDriver->pfnCreateCopy = .... and use gdal_translate.
> > > > 
> > > > > Regards,
> > > > > Varun Saraf
> > > > > 
> > > > > 
> > > > > On Tue, Aug 5, 2014 at 1:44 AM, Even Rouault <
> > > > 
> > > > even.rouault at mines-paris.org>
> > > > 
> > > > > wrote:
> > > > > > Le lundi 04 ao?t 2014 21:38:36, Varun Saraf a ?crit :
> > > > > > > Hello,
> > > > > > > 
> > > > > > > Yes, the code on the github repository is the latest state. I
> > > > > > > was trying the following input queries :
> > > > > > > 
> > > > > > > (1) Assuming that my Create() will be called.
> > > > > > > gdal_translate --debug ON -of PostGISRaster
> > > > > > > ~/GSoC/ap_clip5x5.tif
> > > > > > > 
> > > > > > >  PG:"host=localhost port=5432 user=postgres password=postgres
> > > > > > > 
> > > > > > > dbname=test123 table=newtable"
> > > > > > > 
> > > > > > > (2) When that did not work, I tried the following (suggested by
> > 
> > my
> > 
> > > > > > mentor,
> > > > > > 
> > > > > > > Jorge Arevalo) which didn't work either.
> > > > > > > gdal_translate --debug ON -of PostGISRaster -outsize 50% 50%
> > > > > > > ~/GSoC/ap_clip5x5.tif  PG:"host=localhost port=5432
> > > > > > > user=postgres password=postgres dbname=test123 table=newtable"
> > > > > > 
> > > > > > gdal_translate will never call Create(), but only CreateCopy().
> > > > > > 
> > > > > > You might want to call Create() directly with a Python script for
> > > > > > example, or
> > > > > > a sample C/C++ code. gdalwarp will call Create() too, but
> > > > > > gdalwarp can potentially rewrite existing tiles, which can
> > > > > > complicate your initial coding.
> > > > > > 
> > > > > > > QuiteDelete() method is called in both cases and the following
> > > > > > > error messages are shown
> > > > > > > ERROR 1: Couldn't drop the table public.newtable: ERROR:  table
> > > > > > 
> > > > > > "newtable"
> > > > > > 
> > > > > > > does not exist
> > > > > > > ERROR 6: PostGISRasterDataset::CreateCopy() only works on
> > > > > > > source datasets that are PostGISRaster
> > > > > > 
> > > > > > Yes, as the message implies, the current CreateCopy()
> > 
> > implementation
> > 
> > > > only
> > > > 
> > > > > > works when the source dataset is a postgisraster dataset itself.
> > > > > > As far as the error message "Couldn't drop ...",
> > > > > > PostGISRasterDataset::Delete() should probably be more silent in
> > 
> > case
> > 
> > > > the
> > > > 
> > > > > > dataset doesn't exist.
> > > > > > 
> > > > > > Note that once you have a full feature Create() implementation
> > 
> > (with
> > 
> > > > > > working
> > > > > > IWriteBlock() of course), CreateCopy() is no longer strictly
> > 
> > needed,
> > 
> > > > > > since there is generic implementation in GDAL core that will
> > 
> > emulate
> > 
> > > > > > CreateCopy() with Create() + IWriteBlock()
> > > > > > 
> > > > > > > I even tried calling the Create() method directly from
> > > > > > > CreateCopy(),
> > > > > > 
> > > > > > since
> > > > > > 
> > > > > > > that is being called, but again the same error message is being
> > > > > > > printed.
> > > > > > > 
> > > > > > > Regards,
> > > > > > > Varun Saraf
> > > > > > > 
> > > > > > > On Mon, Aug 4, 2014 at 11:33 PM, Even Rouault
> > > > > > > <even.rouault at mines-paris.org>
> > > > > > > 
> > > > > > > wrote:
> > > > > > > > Le lundi 04 ao?t 2014 14:39:52, Varun Saraf a ?crit :
> > > > > > > > >  Hi,
> > > > > > > > > 
> > > > > > > > > Below is my eleventh weekly report.
> > > > > > > > > 
> > > > > > > > > *What did I do this week?*
> > > > > > > > > 
> > > > > > > > >    - There are some issues with the calling of different
> > > > > > > > >    methods. My
> > > > > > > > 
> > > > > > > > method
> > > > > > > > 
> > > > > > > > >    PostGISRasterDataset::Create() is not being called.
> > > > > > > > >    Tried
> > 
> > to
> > 
> > > > > > resolve
> > > > > > 
> > > > > > > > > that.
> > > > > > > > 
> > > > > > > > Varun,
> > > > > > > > 
> > > > > > > > If the code at
> > 
> > https://github.com/varunsaraf/postgis_raster/blob/master/postgisrasterdat
> > 
> > > > > > > > aset.cpp is the latest state, I don't see any reason why your
> > > > > > > > Create() method wouldn't
> > > > > > > > be called. Do you try to trigger it directly by calling
> > 
> > Create()
> > 
> > > > > > > > explicetely
> > > > > > > > or through other more high level operations ?
> > > > > > > > 
> > > > > > > > Even
> > > > > > > > 
> > > > > > > > > - Fixed some small bugs and removed unnecessary variables
> > 
> > that
> > 
> > > > were
> > > > 
> > > > > > > > > being used.
> > > > > > > > > 
> > > > > > > > > *What do I plan on doing next week?*
> > > > > > > > > 
> > > > > > > > >    - Continue with testing and bug fixing.
> > > > > > > > > 
> > > > > > > > > *Am I blocked on anything?*
> > > > > > > > > 
> > > > > > > > >    - No.
> > > > > > > > > 
> > > > > > > > > Link to weekly report :
> > > > > > > > > https://github.com/varunsaraf/postgis_raster/wiki/Report-11
> > > > > > 
> > > > > > > > > Link to code repository :
> > > > > > https://github.com/varunsaraf/postgis_raster
> > > > > > 
> > > > > > > > > More details at :
> > > > > > http://trac.osgeo.org/gdal/wiki/PostGIS_raster_driver
> > > > > > 
> > > > > > > > > Regards,
> > > > > > > > > Varun Saraf
> > > > > > > > > Lab for Spatial Informatics
> > > > > > > > > IIIT Hyderabad, India
> > > > > > > > 
> > > > > > > > --
> > > > > > > > Geospatial professional services
> > > > > > > > http://even.rouault.free.fr/services.html
> > > > > > 
> > > > > > --
> > > > > > Geospatial professional services
> > > > > > http://even.rouault.free.fr/services.html
> > > > 
> > > > --
> > > > Geospatial professional services
> > > > http://even.rouault.free.fr/services.html
> > 
> > --
> > Geospatial professional services
> > http://even.rouault.free.fr/services.html

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From varunsaraf14 at gmail.com  Thu Aug  7 12:26:31 2014
From: varunsaraf14 at gmail.com (Varun Saraf)
Date: Fri, 8 Aug 2014 00:56:31 +0530
Subject: [gdal-dev] GSoC 2014 Weekly Report 11 : GDAL PostGIS Raster
	driver
In-Reply-To: <201408072120.41554.even.rouault@spatialys.com>
References: <CAPfr+rsQfdOrwKSCU0hdJOJw6LJTDa6=6oi9PRaVeF3yg4ej-g@mail.gmail.com>
	<201408042302.37488.even.rouault@mines-paris.org>
	<CAPfr+rtk6eVPQza7EA_9kOwj3vYJSt3Q3C+EB_+CUCsAB3LGQQ@mail.gmail.com>
	<201408072120.41554.even.rouault@spatialys.com>
Message-ID: <CAPfr+rtR3EV9cmdJxMbF3L+u0z=+emkHNcPQZM9VLk=xhhoNRw@mail.gmail.com>

Hello,

When I execute the following query [1], the return value is NULL as there
is no exact match. What query should I use, instead of this one.
[1]
http://trac.osgeo.org/gdal/browser/trunk/gdal/frmts/postgisraster/postgisrasterdataset.cpp#L3024

Regards,
Varun Saraf


On Fri, Aug 8, 2014 at 12:50 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le jeudi 07 ao?t 2014 21:11:13, Varun Saraf a ?crit :
> > Hello,
> >
> > After Create() exists, SetProjection is called. For my given input, the
> > variable pszProjectionRef has a value :
> > PROJCS["WGS 84 / UTM zone 44N",GEOGCS["WGS
> > 84",DATUM["WGS_1984",SPHEROID["WGS
> >
> 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"
> >
> ]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433],AUTHORITY["EPSG"
> >
> ,"4326"]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",
> >
> 0],PARAMETER["central_meridian",81],PARAMETER["scale_factor",0.9996],PARAME
> >
> TER["false_easting",500000],PARAMETER["false_northing",0],UNIT["metre",1,AU
> > THORITY["EPSG","9001"]],AUTHORITY["EPSG","32644"]]
> >
> > This value is different from the value present in the
> > PostGIS spatial_ref_sys table which is:
> > PROJCS["WGS 84 / UTM zone 44N",GEOGCS["WGS
> > 84",DATUM["WGS_1984",SPHEROID["WGS
> >
> 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"
> >
> ]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.017453292
> >
> 5199433,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4326"]],UNIT["metre",1,
> >
> AUTHORITY["EPSG","9001"]],PROJECTION["Transverse_Mercator"],PARAMETER["lati
> >
> tude_of_origin",0],PARAMETER["central_meridian",81],PARAMETER["scale_factor
> >
> ",0.9996],PARAMETER["false_easting",500000],PARAMETER["false_northing",0],A
> > UTHORITY["EPSG","32644"],AXIS["Easting",EAST],AXIS["Northing",NORTH]]
> >
> > I found the below solution [1] to get proj4text from srtext which can be
> > converted to srid. Any alternate suggestions?
>
> Even if the WKT are a bit different, what is the problem exactly ? You've
> been
> provided a SRS whose autority code is 32644, and that exists in
> spatial_ref_sys, so nothing to do. Just reuse the SRID matching the entry
> (which should be 32644 as well).
> If you are interested in a logic to determine the SRID of a given SRS, and
> potentially add a new entry it in spatial_ref_sys, then
> OGRPGDataSource::FetchSRSId() is exactly what you want.
>
> >
> > [1]
> >
> http://gis.stackexchange.com/questions/95831/how-can-i-get-proj4text-from-s
> > rtext
> >
> > Regards,
> > Varun Saraf
> >
> >
> > On Tue, Aug 5, 2014 at 2:32 AM, Even Rouault <
> even.rouault at mines-paris.org>
> >
> > wrote:
> > > Le lundi 04 ao?t 2014 22:53:03, Varun Saraf a ?crit :
> > > > Hello,
> > > >
> > > > Commenting poDriver->pfnCreateCopy doesn't seem to work. It is still
> > > > calling the CreateCopy() method.
> > >
> > > Check twice... How could GDAL call PostgisRasterDataset::CreateCopy()
> is
> > > nothing points to it ?
> > >
> > > > I will try doing the testing with a script
> > > > and get back to you.
> > > >
> > > > Regards,
> > > > Varun Saraf
> > > >
> > > >
> > > > On Tue, Aug 5, 2014 at 2:12 AM, Even Rouault <
> > >
> > > even.rouault at mines-paris.org>
> > >
> > > > wrote:
> > > > > Le lundi 04 ao?t 2014 22:38:20, Varun Saraf a ?crit :
> > > > > > Hello,
> > > > > >
> > > > > > Thank you for this information. I will explicitly call Create()
> > >
> > > using a
> > >
> > > > > > script. Is the IWriteBlock method to be tested in a similar
> manner?
> > > > > > Note that pData buffer is passed to this method as an argument,
> > > > > > which I will have to generate and pass to it. Any suggestions how
> > > > > > I should generate
> > > > >
> > > > > this
> > > > >
> > > > > > pData buffer?
> > > > >
> > > > > Well, any data might do.
> > > > > But based on my previous note regarding the generic GDAL core
> > > > > CreateCopy() implementation, another possibility for your testing
> is
> > > > > to temporarily comment
> > > > > poDriver->pfnCreateCopy = .... and use gdal_translate.
> > > > >
> > > > > > Regards,
> > > > > > Varun Saraf
> > > > > >
> > > > > >
> > > > > > On Tue, Aug 5, 2014 at 1:44 AM, Even Rouault <
> > > > >
> > > > > even.rouault at mines-paris.org>
> > > > >
> > > > > > wrote:
> > > > > > > Le lundi 04 ao?t 2014 21:38:36, Varun Saraf a ?crit :
> > > > > > > > Hello,
> > > > > > > >
> > > > > > > > Yes, the code on the github repository is the latest state. I
> > > > > > > > was trying the following input queries :
> > > > > > > >
> > > > > > > > (1) Assuming that my Create() will be called.
> > > > > > > > gdal_translate --debug ON -of PostGISRaster
> > > > > > > > ~/GSoC/ap_clip5x5.tif
> > > > > > > >
> > > > > > > >  PG:"host=localhost port=5432 user=postgres password=postgres
> > > > > > > >
> > > > > > > > dbname=test123 table=newtable"
> > > > > > > >
> > > > > > > > (2) When that did not work, I tried the following (suggested
> by
> > >
> > > my
> > >
> > > > > > > mentor,
> > > > > > >
> > > > > > > > Jorge Arevalo) which didn't work either.
> > > > > > > > gdal_translate --debug ON -of PostGISRaster -outsize 50% 50%
> > > > > > > > ~/GSoC/ap_clip5x5.tif  PG:"host=localhost port=5432
> > > > > > > > user=postgres password=postgres dbname=test123
> table=newtable"
> > > > > > >
> > > > > > > gdal_translate will never call Create(), but only CreateCopy().
> > > > > > >
> > > > > > > You might want to call Create() directly with a Python script
> for
> > > > > > > example, or
> > > > > > > a sample C/C++ code. gdalwarp will call Create() too, but
> > > > > > > gdalwarp can potentially rewrite existing tiles, which can
> > > > > > > complicate your initial coding.
> > > > > > >
> > > > > > > > QuiteDelete() method is called in both cases and the
> following
> > > > > > > > error messages are shown
> > > > > > > > ERROR 1: Couldn't drop the table public.newtable: ERROR:
>  table
> > > > > > >
> > > > > > > "newtable"
> > > > > > >
> > > > > > > > does not exist
> > > > > > > > ERROR 6: PostGISRasterDataset::CreateCopy() only works on
> > > > > > > > source datasets that are PostGISRaster
> > > > > > >
> > > > > > > Yes, as the message implies, the current CreateCopy()
> > >
> > > implementation
> > >
> > > > > only
> > > > >
> > > > > > > works when the source dataset is a postgisraster dataset
> itself.
> > > > > > > As far as the error message "Couldn't drop ...",
> > > > > > > PostGISRasterDataset::Delete() should probably be more silent
> in
> > >
> > > case
> > >
> > > > > the
> > > > >
> > > > > > > dataset doesn't exist.
> > > > > > >
> > > > > > > Note that once you have a full feature Create() implementation
> > >
> > > (with
> > >
> > > > > > > working
> > > > > > > IWriteBlock() of course), CreateCopy() is no longer strictly
> > >
> > > needed,
> > >
> > > > > > > since there is generic implementation in GDAL core that will
> > >
> > > emulate
> > >
> > > > > > > CreateCopy() with Create() + IWriteBlock()
> > > > > > >
> > > > > > > > I even tried calling the Create() method directly from
> > > > > > > > CreateCopy(),
> > > > > > >
> > > > > > > since
> > > > > > >
> > > > > > > > that is being called, but again the same error message is
> being
> > > > > > > > printed.
> > > > > > > >
> > > > > > > > Regards,
> > > > > > > > Varun Saraf
> > > > > > > >
> > > > > > > > On Mon, Aug 4, 2014 at 11:33 PM, Even Rouault
> > > > > > > > <even.rouault at mines-paris.org>
> > > > > > > >
> > > > > > > > wrote:
> > > > > > > > > Le lundi 04 ao?t 2014 14:39:52, Varun Saraf a ?crit :
> > > > > > > > > >  Hi,
> > > > > > > > > >
> > > > > > > > > > Below is my eleventh weekly report.
> > > > > > > > > >
> > > > > > > > > > *What did I do this week?*
> > > > > > > > > >
> > > > > > > > > >    - There are some issues with the calling of different
> > > > > > > > > >    methods. My
> > > > > > > > >
> > > > > > > > > method
> > > > > > > > >
> > > > > > > > > >    PostGISRasterDataset::Create() is not being called.
> > > > > > > > > >    Tried
> > >
> > > to
> > >
> > > > > > > resolve
> > > > > > >
> > > > > > > > > > that.
> > > > > > > > >
> > > > > > > > > Varun,
> > > > > > > > >
> > > > > > > > > If the code at
> > >
> > >
> https://github.com/varunsaraf/postgis_raster/blob/master/postgisrasterdat
> > >
> > > > > > > > > aset.cpp is the latest state, I don't see any reason why
> your
> > > > > > > > > Create() method wouldn't
> > > > > > > > > be called. Do you try to trigger it directly by calling
> > >
> > > Create()
> > >
> > > > > > > > > explicetely
> > > > > > > > > or through other more high level operations ?
> > > > > > > > >
> > > > > > > > > Even
> > > > > > > > >
> > > > > > > > > > - Fixed some small bugs and removed unnecessary variables
> > >
> > > that
> > >
> > > > > were
> > > > >
> > > > > > > > > > being used.
> > > > > > > > > >
> > > > > > > > > > *What do I plan on doing next week?*
> > > > > > > > > >
> > > > > > > > > >    - Continue with testing and bug fixing.
> > > > > > > > > >
> > > > > > > > > > *Am I blocked on anything?*
> > > > > > > > > >
> > > > > > > > > >    - No.
> > > > > > > > > >
> > > > > > > > > > Link to weekly report :
> > > > > > > > > >
> https://github.com/varunsaraf/postgis_raster/wiki/Report-11
> > > > > > >
> > > > > > > > > > Link to code repository :
> > > > > > > https://github.com/varunsaraf/postgis_raster
> > > > > > >
> > > > > > > > > > More details at :
> > > > > > > http://trac.osgeo.org/gdal/wiki/PostGIS_raster_driver
> > > > > > >
> > > > > > > > > > Regards,
> > > > > > > > > > Varun Saraf
> > > > > > > > > > Lab for Spatial Informatics
> > > > > > > > > > IIIT Hyderabad, India
> > > > > > > > >
> > > > > > > > > --
> > > > > > > > > Geospatial professional services
> > > > > > > > > http://even.rouault.free.fr/services.html
> > > > > > >
> > > > > > > --
> > > > > > > Geospatial professional services
> > > > > > > http://even.rouault.free.fr/services.html
> > > > >
> > > > > --
> > > > > Geospatial professional services
> > > > > http://even.rouault.free.fr/services.html
> > >
> > > --
> > > Geospatial professional services
> > > http://even.rouault.free.fr/services.html
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140808/27142470/attachment.html>

From even.rouault at spatialys.com  Thu Aug  7 12:52:31 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 7 Aug 2014 21:52:31 +0200
Subject: [gdal-dev] GSoC 2014 Weekly Report 11 : GDAL PostGIS Raster
	driver
In-Reply-To: <CAPfr+rtR3EV9cmdJxMbF3L+u0z=+emkHNcPQZM9VLk=xhhoNRw@mail.gmail.com>
References: <CAPfr+rsQfdOrwKSCU0hdJOJw6LJTDa6=6oi9PRaVeF3yg4ej-g@mail.gmail.com>
	<201408072120.41554.even.rouault@spatialys.com>
	<CAPfr+rtR3EV9cmdJxMbF3L+u0z=+emkHNcPQZM9VLk=xhhoNRw@mail.gmail.com>
Message-ID: <201408072152.31716.even.rouault@spatialys.com>

Le jeudi 07 ao?t 2014 21:26:31, Varun Saraf a ?crit :
> http://trac.osgeo.org/gdal/browser/trunk/gdal/frmts/postgisraster/postgisra
> sterdataset.cpp#L3024

I suggested you to look at OGRPGDataSource::FetchSRSId() (  
http://trac.osgeo.org/gdal/browser/trunk/gdal/ogr/ogrsf_frmts/pg/ogrpgdatasource.cpp) 
. It contains everything you need. You could/should actually reuse it directly 
in PostgisRaster.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From graeme.wilkie at btinternet.com  Thu Aug  7 13:20:34 2014
From: graeme.wilkie at btinternet.com (Graeme Wilkie)
Date: Thu, 7 Aug 2014 21:20:34 +0100
Subject: [gdal-dev] GDAL, ESRI Shapefiles and nested polygons
Message-ID: <009a01cfb27d$0c477720$24d66560$@btinternet.com>

Hi,

I'm trying to use GDAL to read ESRI shapefiles. I've got it working for
points, lines, polygons, polylines and multipoint but I'm having problems
with polygons that contain polygons in the same feature.

 

The following is a cut down code sample of the code I'm using. The problem I
have is that I can read the number of polygons in the feature (i.e. 3
polygons, nested) using OGR_G_GetGemoetryCount. When I use
OGR_R_GetGeometryRef to get the handle/pointer for each of the polygons in
turn I get what appears to be a valid handle but when I use it to get the
number of points/vertices in the polygon it always returns 0.

 

If I use the lower level routines SHPOpen, SHPReadObject, SHPClose I can get
access to the data (after a fashion) but the requirement is to use the
higher level API.

 

I'm using GDAL-1.6.2 (yes I know I should be using a much more up-to-date
version but the project will not sanction it). I'm developing on a Linux
(Redhat 5.9) system in GCC.

 

I'd appreciate it if you could point out what I'm doing wrong (I suspect it
is my error).

 

 

OGRDataSourceH hDS;

OGRFeatureH hFeature;

OGRLayerH;

 

OGRRegisterAll();

hDS = OGROpen(filename, FALSE, NULL);

 

hLayer = OGR_DS_GetLayer(hDS, 0); // only interested in layer 0

 

while ((hFeature = OGR_L_GetNextFeature(hLayer)) != NULL)

(

Int index = 0;

OGRGeometryH hGeometry = OGR_F_GetGeometryRef(hFeature);

int shape_type = wkbFlatten(ORG_G_GetGeometry(hGeometry);

int num_geom = OGR_G_GetGeometryCount(hGeometry) - 1; // Returns a valid
result

 

do

{

                OGRGeometryH hRing = OGR_G_GetGeometryRef(hGeometry, index);

                Int num_vertices = OGR_G_GetPointCount(hRing); // returns 0 

                //.

//. Do something with the data

//.

Index++;

}

// Destroy the hfeature here

)

 

 

 

 

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140807/65e56749/attachment.html>

From varunsaraf14 at gmail.com  Thu Aug  7 13:26:07 2014
From: varunsaraf14 at gmail.com (Varun Saraf)
Date: Fri, 8 Aug 2014 01:56:07 +0530
Subject: [gdal-dev] GSoC 2014 Weekly Report 11 : GDAL PostGIS Raster
	driver
In-Reply-To: <201408072152.31716.even.rouault@spatialys.com>
References: <CAPfr+rsQfdOrwKSCU0hdJOJw6LJTDa6=6oi9PRaVeF3yg4ej-g@mail.gmail.com>
	<201408072120.41554.even.rouault@spatialys.com>
	<CAPfr+rtR3EV9cmdJxMbF3L+u0z=+emkHNcPQZM9VLk=xhhoNRw@mail.gmail.com>
	<201408072152.31716.even.rouault@spatialys.com>
Message-ID: <CAPfr+rt8y0g3zjFAQeiDjN7icAdWy=NxS3n+K1e+9ChHLwDbNA@mail.gmail.com>

Hello,

Thanks. I will use that.

When the PostGISRasterDataset::SetProjection method returns, a segmentation
fault is being shown. The methods I have made changes to IWriteBlock,
IRasterIO are not being called. What is the following flow of methods that
are called? What could be the issue?

Regards,
Varun Saraf


On Fri, Aug 8, 2014 at 1:22 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le jeudi 07 ao?t 2014 21:26:31, Varun Saraf a ?crit :
> >
> http://trac.osgeo.org/gdal/browser/trunk/gdal/frmts/postgisraster/postgisra
> > sterdataset.cpp#L3024
>
> I suggested you to look at OGRPGDataSource::FetchSRSId() (
>
> http://trac.osgeo.org/gdal/browser/trunk/gdal/ogr/ogrsf_frmts/pg/ogrpgdatasource.cpp
> )
> . It contains everything you need. You could/should actually reuse it
> directly
> in PostgisRaster.
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140808/6d59cb96/attachment.html>

From even.rouault at spatialys.com  Thu Aug  7 13:26:51 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 7 Aug 2014 22:26:51 +0200
Subject: [gdal-dev] GDAL, ESRI Shapefiles and nested polygons
In-Reply-To: <009a01cfb27d$0c477720$24d66560$@btinternet.com>
References: <009a01cfb27d$0c477720$24d66560$@btinternet.com>
Message-ID: <201408072226.51329.even.rouault@spatialys.com>

Le jeudi 07 ao?t 2014 22:20:34, Graeme Wilkie a ?crit :
> Hi,
> 
> I'm trying to use GDAL to read ESRI shapefiles. I've got it working for
> points, lines, polygons, polylines and multipoint but I'm having problems
> with polygons that contain polygons in the same feature.
> 
> 
> 
> The following is a cut down code sample of the code I'm using. The problem
> I have is that I can read the number of polygons in the feature (i.e. 3
> polygons, nested) using OGR_G_GetGemoetryCount. When I use
> OGR_R_GetGeometryRef to get the handle/pointer for each of the polygons in
> turn I get what appears to be a valid handle but when I use it to get the
> number of points/vertices in the polygon it always returns 0.

Graeme,

You didn't display the WKT that corresponds to the geometry, so I will just 
make the guess that the geometries returned is a multipolygon and not a 
polygon.

So you might need one more level of OGR_G_GetGeometryCount and 
OGR_G_GetGeometryRef to go to the ring level.

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Aug  7 13:28:22 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 7 Aug 2014 22:28:22 +0200
Subject: [gdal-dev] GSoC 2014 Weekly Report 11 : GDAL PostGIS Raster
	driver
In-Reply-To: <CAPfr+rt8y0g3zjFAQeiDjN7icAdWy=NxS3n+K1e+9ChHLwDbNA@mail.gmail.com>
References: <CAPfr+rsQfdOrwKSCU0hdJOJw6LJTDa6=6oi9PRaVeF3yg4ej-g@mail.gmail.com>
	<201408072152.31716.even.rouault@spatialys.com>
	<CAPfr+rt8y0g3zjFAQeiDjN7icAdWy=NxS3n+K1e+9ChHLwDbNA@mail.gmail.com>
Message-ID: <201408072228.22975.even.rouault@spatialys.com>

Le jeudi 07 ao?t 2014 22:26:07, Varun Saraf a ?crit :
> Hello,
> 
> Thanks. I will use that.
> 
> When the PostGISRasterDataset::SetProjection method returns, a segmentation
> fault is being shown. The methods I have made changes to IWriteBlock,
> IRasterIO are not being called. What is the following flow of methods that
> are called? What could be the issue?

You're in the best position to know ;-) More seriously without looking at the 
code, I can only suggest you attaching a debugger or running Valgrind to 
identify the flaw. (assuming you are developing on Linux)

> 
> Regards,
> Varun Saraf
> 
> 
> On Fri, Aug 8, 2014 at 1:22 AM, Even Rouault <even.rouault at spatialys.com>
> 
> wrote:
> > Le jeudi 07 ao?t 2014 21:26:31, Varun Saraf a ?crit :
> > 
> > http://trac.osgeo.org/gdal/browser/trunk/gdal/frmts/postgisraster/postgis
> > ra
> > 
> > > sterdataset.cpp#L3024
> > 
> > I suggested you to look at OGRPGDataSource::FetchSRSId() (
> > 
> > http://trac.osgeo.org/gdal/browser/trunk/gdal/ogr/ogrsf_frmts/pg/ogrpgdat
> > asource.cpp )
> > . It contains everything you need. You could/should actually reuse it
> > directly
> > in PostgisRaster.
> > 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jorgearevalo at libregis.org  Fri Aug  8 01:26:27 2014
From: jorgearevalo at libregis.org (Jorge Arevalo)
Date: Fri, 8 Aug 2014 10:26:27 +0200
Subject: [gdal-dev] GSoC 2014 Weekly Report 11 : GDAL PostGIS Raster
	driver
In-Reply-To: <201408072228.22975.even.rouault@spatialys.com>
References: <CAPfr+rsQfdOrwKSCU0hdJOJw6LJTDa6=6oi9PRaVeF3yg4ej-g@mail.gmail.com>
	<201408072152.31716.even.rouault@spatialys.com>
	<CAPfr+rt8y0g3zjFAQeiDjN7icAdWy=NxS3n+K1e+9ChHLwDbNA@mail.gmail.com>
	<201408072228.22975.even.rouault@spatialys.com>
Message-ID: <CAMhtMNPxSt4SSudC_NmxzG=75NqeVuE+stcAJOUoRXB6OOCTtw@mail.gmail.com>

On Thu, Aug 7, 2014 at 10:28 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le jeudi 07 ao?t 2014 22:26:07, Varun Saraf a ?crit :
> > Hello,
> >
> > Thanks. I will use that.
> >
> > When the PostGISRasterDataset::SetProjection method returns, a
> segmentation
> > fault is being shown. The methods I have made changes to IWriteBlock,
> > IRasterIO are not being called. What is the following flow of methods
> that
> > are called? What could be the issue?
>
> You're in the best position to know ;-) More seriously without looking at
> the
> code, I can only suggest you attaching a debugger or running Valgrind to
> identify the flaw. (assuming you are developing on Linux)
>

Hello,

First of all, I will take guilt for my mistake: as Even said,
gdal_translate will always call CreateCopy, as stated at
http://www.gdal.org/classGDALDriver.html#a2c897da2a6e25169cccc49ef48797ce1.
My (wrong) assumption was that if you force a modification with regard to
the source raster (like providing a different outsize), gdal_translate will
avoid CreateCopy. My fault.

Default implementation of CreateCopy will call Create at the end, but as
PostGIS Raster driver provides its own implementation of CreateCopy, this
doesn't happen. Quick fix, as also Even suggested, avoid the PostGIS Raster
implementation of CreateCopy.

Varun, about the use of FetchSRSId, I think is a good idea too. The problem
is your WKT representation of the SRS is a bit different from the
representation stored in PostGIS (btw, where does your WKT representation
come from?). Well, both of them have the authority code 32644. You just
need a method to get this SRID from the WKT.

One way to do it was the query in PostGIS Raster implementation of
SetProjection (
http://trac.osgeo.org/gdal/browser/trunk/gdal/frmts/postgisraster/postgisrasterdataset.cpp#L3024),
but it doesn't work for you (again, the PostGIS WKT representation is a bit
different, so, the query doesn't return a value).

Another way is, like Even suggested, to reuse OGRPGDataSource::FetchSRSId
(Even, correct me if this isn't what you meant). You just need to build an
instance of OGRSpatialReference from your WKT string (
http://www.gdal.org/classOGRSpatialReference.html#a10e93344649a380d75b9925ad53d86ac),
and then call FetchSRSId using a pointer to that instance as argument
(check the method:
http://trac.osgeo.org/gdal/browser/trunk/gdal/ogr/ogrsf_frmts/pg/ogrpgdatasource.cpp#L1931
).

Don't hesitate to reuse this method and change
PostGISRasterDataset::SetProjection if needed.

Oh, and +1 to use a debugger (I suggest ddd) and valgrind to check memory
problems.

Best regards (and thanks, Even)

Jorge



>
> >
> > Regards,
> > Varun Saraf
> >
> >
> > On Fri, Aug 8, 2014 at 1:22 AM, Even Rouault <even.rouault at spatialys.com
> >
> >
> > wrote:
> > > Le jeudi 07 ao?t 2014 21:26:31, Varun Saraf a ?crit :
> > >
> > >
> http://trac.osgeo.org/gdal/browser/trunk/gdal/frmts/postgisraster/postgis
> > > ra
> > >
> > > > sterdataset.cpp#L3024
> > >
> > > I suggested you to look at OGRPGDataSource::FetchSRSId() (
> > >
> > >
> http://trac.osgeo.org/gdal/browser/trunk/gdal/ogr/ogrsf_frmts/pg/ogrpgdat
> > > asource.cpp )
> > > . It contains everything you need. You could/should actually reuse it
> > > directly
> > > in PostgisRaster.
> > >
> > > --
> > > Spatialys - Geospatial professional services
> > > http://www.spatialys.com
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
Jorge Arevalo
Freelance developer

http://about.me/jorgeas80
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140808/a37b071a/attachment-0001.html>

From even.rouault at spatialys.com  Fri Aug  8 01:40:28 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 8 Aug 2014 10:40:28 +0200
Subject: [gdal-dev] GSoC 2014 Weekly Report 11 : GDAL PostGIS Raster
	driver
In-Reply-To: <CAMhtMNPxSt4SSudC_NmxzG=75NqeVuE+stcAJOUoRXB6OOCTtw@mail.gmail.com>
References: <CAPfr+rsQfdOrwKSCU0hdJOJw6LJTDa6=6oi9PRaVeF3yg4ej-g@mail.gmail.com>
	<201408072228.22975.even.rouault@spatialys.com>
	<CAMhtMNPxSt4SSudC_NmxzG=75NqeVuE+stcAJOUoRXB6OOCTtw@mail.gmail.com>
Message-ID: <201408081040.28612.even.rouault@spatialys.com>

Le vendredi 08 ao?t 2014 10:26:27, Jorge Arevalo a ?crit :
> On Thu, Aug 7, 2014 at 10:28 PM, Even Rouault <even.rouault at spatialys.com>
> 
> wrote:
> > Le jeudi 07 ao?t 2014 22:26:07, Varun Saraf a ?crit :
> > > Hello,
> > > 
> > > Thanks. I will use that.
> > > 
> > > When the PostGISRasterDataset::SetProjection method returns, a
> > 
> > segmentation
> > 
> > > fault is being shown. The methods I have made changes to IWriteBlock,
> > > IRasterIO are not being called. What is the following flow of methods
> > 
> > that
> > 
> > > are called? What could be the issue?
> > 
> > You're in the best position to know ;-) More seriously without looking at
> > the
> > code, I can only suggest you attaching a debugger or running Valgrind to
> > identify the flaw. (assuming you are developing on Linux)
> 
> Hello,
> 
> First of all, I will take guilt for my mistake: as Even said,
> gdal_translate will always call CreateCopy, as stated at
> http://www.gdal.org/classGDALDriver.html#a2c897da2a6e25169cccc49ef48797ce1.
> My (wrong) assumption was that if you force a modification with regard to
> the source raster (like providing a different outsize), gdal_translate will
> avoid CreateCopy. My fault.
> 
> Default implementation of CreateCopy will call Create at the end, but as
> PostGIS Raster driver provides its own implementation of CreateCopy, this
> doesn't happen. Quick fix, as also Even suggested, avoid the PostGIS Raster
> implementation of CreateCopy.
> 
> Varun, about the use of FetchSRSId, I think is a good idea too. The problem
> is your WKT representation of the SRS is a bit different from the
> representation stored in PostGIS (btw, where does your WKT representation
> come from?). Well, both of them have the authority code 32644. You just
> need a method to get this SRID from the WKT.

There are many possible correct variants of WKT for the same EPSG code. 
Depends on if you include all authority nodes, or other optional information. 
Like if you strip AXIS order information or not. GDAL has add itself 
variations on the way it export EPSG database as WKT. 
The one if spatial_ref_sys mentionned by Varun must likely comes from a GDAL 
<= 1.6 where we, wrongly (according to the BNF of WKT), put the AXIS nodes 
after the AUTHORITY code. This has been fixed in later GDAL versions, but the 
PostGIS spatial_ref_sys had not been regenerated since (something I've done in 
the recent weeks and that should hopefully go with PostGIS 2.2 : 
http://trac.osgeo.org/postgis/ticket/2737). So all in all relying on WKT 
strict matching isn't reliable.

> 
> One way to do it was the query in PostGIS Raster implementation of
> SetProjection (
> http://trac.osgeo.org/gdal/browser/trunk/gdal/frmts/postgisraster/postgisra
> sterdataset.cpp#L3024), but it doesn't work for you (again, the PostGIS WKT
> representation is a bit different, so, the query doesn't return a value).
> 
> Another way is, like Even suggested, to reuse OGRPGDataSource::FetchSRSId
> (Even, correct me if this isn't what you meant). You just need to build an
> instance of OGRSpatialReference from your WKT string (
> http://www.gdal.org/classOGRSpatialReference.html#a10e93344649a380d75b9925a
> d53d86ac), and then call FetchSRSId using a pointer to that instance as
> argument (check the method:
> http://trac.osgeo.org/gdal/browser/trunk/gdal/ogr/ogrsf_frmts/pg/ogrpgdatas
> ource.cpp#L1931 ).

Calling directling OGRPGDataSource::FetchSRSId from PostGISRaster isn't 
directly doable since it is a member function of OGRPGDataSource. From my 
quick look, it only requires the hPGConn member. For Varun's need, 
copying&pasting the method and doing the small needed adjustment might be the 
quick way for now. In an ideal world, we could think of unifying the 2 drivers 
but that's another business !

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From smor.prg at gmail.com  Fri Aug  8 02:06:49 2014
From: smor.prg at gmail.com (Morteza Ghavami)
Date: Fri, 8 Aug 2014 13:36:49 +0430
Subject: [gdal-dev] AVHRR level 1b earth location data interpolation
Message-ID: <CAO1oGMVb8Be+67XsK__UrTRbrnZpS1KNOU-7XGpQVCCbJF5a8A@mail.gmail.com>

Hi ,

GDAL level1b dataset reader interpolate earth location data by lagrange
interpolation but it is not accurate .

mpop (http://www.github.com/mraspaud/mpop) interpolation method accuracy is
better than GDAL interpolation method but it uses all data records location
data . Charles Wivell suggest to use satellite/sensor/earth model . I can't
found good resources that describe this model .

Note : I found a satellite/sensor/earth model interpolation that
implemented in AAPP package but it's accuracy is similar to lagrange
method's accuracy .

Is there any interpolation method that works on only one data record and
produce accurate results ?

Thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140808/b7869766/attachment.html>

From smor.prg at gmail.com  Fri Aug  8 02:10:29 2014
From: smor.prg at gmail.com (Morteza Ghavami)
Date: Fri, 8 Aug 2014 13:40:29 +0430
Subject: [gdal-dev] AVHRR level 1b Earth Location data Interpolation
Message-ID: <CAO1oGMV9=w6HCcGubWL=dU_pQWyv-fRCqxBBLtwAoPDYFPCu=Q@mail.gmail.com>

Hi ,

GDAL level1b dataset reader interpolate earth location data by lagrange
interpolation but it is not accurate .

mpop (http://www.github.com/mraspaud/mpop) interpolation method accuracy is
better than GDAL interpolation method but it uses all data records location
data . Charles Wivell suggest to use satellite/sensor/earth model . I can't
found good resources that describe this model .

Note : I found a satellite/sensor/earth model interpolation that
implemented in AAPP package but it's accuracy is similar to lagrange
method's accuracy .

Is there any interpolation method that works on only one data record and
produce accurate results ?

Thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140808/0102aca7/attachment.html>

From graeme.wilkie at btinternet.com  Fri Aug  8 06:19:38 2014
From: graeme.wilkie at btinternet.com (Graeme Wilkie)
Date: Fri, 8 Aug 2014 14:19:38 +0100
Subject: [gdal-dev] GDAL, ESRI Shapefiles and nested polygons
In-Reply-To: <201408072226.51329.even.rouault@spatialys.com>
References: <009a01cfb27d$0c477720$24d66560$@btinternet.com>
	<201408072226.51329.even.rouault@spatialys.com>
Message-ID: <1407503978.92983.YahooMailNeo@web87402.mail.ir2.yahoo.com>

Hi,
?
You were correct, it is returning multipolygon (9sorry, I should have included that information).
?
I've made the change you suggested so the code looks like
?Int index = 0;
OGRGeometryH hGeometry = OGR_F_GetGeometryRef(hFeature);
int shape_type = wkbFlatten(ORG_G_GetGeometry(hGeometry);
int num_geom = OGR_G_GetGeometryCount(hGeometry) - 1; // Returns a valid result
int innerIndex = 0;
?
do
{
??????????????? OGRGeometryH hRing = OGR_G_GetGeometryRef(hGeometry, index);
??????????????? OGRGeometryH tmpGeo = OGR_G_GetGeometryRef(hRing, innerIndex);
??????????????? Int num_vertices = OGR_G_GetPointCount(tmpGeo); 
??????????????? //.
//. Do something with the data
//.
Index++;
}
// Destroy the hfeature here
)
?
If innerIndex is 0 then I can read the data for that polygon. If innerIndex in 1 then tmpGeo is NULL even though there are 2 inner polygons in the test data.
?
Have I do something stupid ?
?
The test data is a simple square with 2 squares inside it created using shapefile.py
?
If anybody has a small piece of example could it would be a great help.
?
Regards
?
Graeme 

________________________________
 From: Even Rouault <even.rouault at spatialys.com>
To: gdal-dev at lists.osgeo.org 
Cc: Graeme Wilkie <graeme.wilkie at btinternet.com> 
Sent: Thursday, August 7, 2014 9:26 PM
Subject: Re: [gdal-dev] GDAL, ESRI Shapefiles and nested polygons
  

Le jeudi 07 ao?t 2014 22:20:34, Graeme Wilkie a ?crit :
> Hi,
> 
> I'm trying to use GDAL to read ESRI shapefiles. I've got it working for
> points, lines, polygons, polylines and multipoint but I'm having problems
> with polygons that contain polygons in the same feature.
> 
> 
> 
> The following is a cut down code sample of the code I'm using. The problem
> I have is that I can read the number of polygons in the feature (i.e. 3
> polygons, nested) using OGR_G_GetGemoetryCount. When I use
> OGR_R_GetGeometryRef to get the handle/pointer for each of the polygons in
> turn I get what appears to be a valid handle but when I use it to get the
> number of points/vertices in the polygon it always returns 0.

Graeme,

You didn't display the WKT that corresponds to the geometry, so I will just 
make the guess that the geometries returned is a multipolygon and not a 
polygon.

So you might need one more level of OGR_G_GetGeometryCount and 
OGR_G_GetGeometryRef to go to the ring level.

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140808/f71344eb/attachment.html>

From even.rouault at spatialys.com  Fri Aug  8 06:27:48 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 8 Aug 2014 15:27:48 +0200
Subject: [gdal-dev] GDAL, ESRI Shapefiles and nested polygons
In-Reply-To: <1407503978.92983.YahooMailNeo@web87402.mail.ir2.yahoo.com>
References: <009a01cfb27d$0c477720$24d66560$@btinternet.com>
	<201408072226.51329.even.rouault@spatialys.com>
	<1407503978.92983.YahooMailNeo@web87402.mail.ir2.yahoo.com>
Message-ID: <201408081527.48244.even.rouault@spatialys.com>

Le vendredi 08 ao?t 2014 15:19:38, Graeme Wilkie a ?crit :
> Hi,
>  
> You were correct, it is returning multipolygon (9sorry, I should have
> included that information). 
> I've made the change you suggested so the code looks like
>  Int index = 0;
> OGRGeometryH hGeometry = OGR_F_GetGeometryRef(hFeature);
> int shape_type = wkbFlatten(ORG_G_GetGeometry(hGeometry);
> int num_geom = OGR_G_GetGeometryCount(hGeometry) - 1; // Returns a valid
> result int innerIndex = 0;
>  
> do
> {
>                 OGRGeometryH hRing = OGR_G_GetGeometryRef(hGeometry,
> index); OGRGeometryH tmpGeo = OGR_G_GetGeometryRef(hRing, innerIndex); Int
> num_vertices = OGR_G_GetPointCount(tmpGeo);
>                 //.
> //. Do something with the data
> //.
> Index++;
> }
> // Destroy the hfeature here
> )
>  
> If innerIndex is 0 then I can read the data for that polygon. If innerIndex
> in 1 then tmpGeo is NULL even though there are 2 inner polygons in the
> test data. 
> Have I do something stupid ?
>  
> The test data is a simple square with 2 squares inside it created using
> shapefile.py 

You still didn't include the WKT... Well I will assume that you have square T3 
included inside square T2 included inside square T1.

In that case the structure of the WKT should be ((T1,T2),T3)
i.e. a multipolygon with 2 polygons : (T1,T2) and T3
T1 is an outer ring
T2 an inner ring of T1
T3 an outer ring
That's the way polygons are modelised in SFS specification.

> If anybody has a small piece of example could it would be a great help.
>  
> Regards
>  
> Graeme
> 
> ________________________________
>  From: Even Rouault <even.rouault at spatialys.com>
> To: gdal-dev at lists.osgeo.org
> Cc: Graeme Wilkie <graeme.wilkie at btinternet.com>
> Sent: Thursday, August 7, 2014 9:26 PM
> Subject: Re: [gdal-dev] GDAL, ESRI Shapefiles and nested polygons
> 
> Le jeudi 07 ao?t 2014 22:20:34, Graeme Wilkie a ?crit :
> > Hi,
> > 
> > I'm trying to use GDAL to read ESRI shapefiles. I've got it working for
> > points, lines, polygons, polylines and multipoint but I'm having problems
> > with polygons that contain polygons in the same feature.
> > 
> > 
> > 
> > The following is a cut down code sample of the code I'm using. The
> > problem I have is that I can read the number of polygons in the feature
> > (i.e. 3 polygons, nested) using OGR_G_GetGemoetryCount. When I use
> > OGR_R_GetGeometryRef to get the handle/pointer for each of the polygons
> > in turn I get what appears to be a valid handle but when I use it to get
> > the number of points/vertices in the polygon it always returns 0.
> 
> Graeme,
> 
> You didn't display the WKT that corresponds to the geometry, so I will just
> make the guess that the geometries returned is a multipolygon and not a
> polygon.
> 
> So you might need one more level of OGR_G_GetGeometryCount and
> OGR_G_GetGeometryRef to go to the ring level.
> 
> Best regards,
> 
> Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From graeme.wilkie at btinternet.com  Fri Aug  8 07:54:04 2014
From: graeme.wilkie at btinternet.com (Graeme Wilkie)
Date: Fri, 8 Aug 2014 15:54:04 +0100
Subject: [gdal-dev] GDAL, ESRI Shapefiles and nested polygons
In-Reply-To: <201408081527.48244.even.rouault@spatialys.com>
References: <009a01cfb27d$0c477720$24d66560$@btinternet.com>
	<201408072226.51329.even.rouault@spatialys.com>
	<1407503978.92983.YahooMailNeo@web87402.mail.ir2.yahoo.com>
	<201408081527.48244.even.rouault@spatialys.com>
Message-ID: <1407509644.69220.YahooMailNeo@web87401.mail.ir2.yahoo.com>

Hi,
?
I don't have a WKT format as such (sorry but I'm learning about all this as I go), all I do have is a simple Python script that creates the shapefiles. The idea of having T3 inside T2 with both inside /t1 is correct in this case but not necessarily always the case. T2 & T3 could both be inside T1 side by side.
?
The content of the python script?file is as follows (the polygons are T1, T2, T3 in order):
?
import shapefile
outfile = shapefile.Writer(shapefile.POLYGON)
outfile.poly(parts=[\
[[easting,northing],[easting,northing],[easting,northing],[easting,northing],\
[easting,northing],[easting,northing],[easting,northing],[easting,northing]],\
[[easting,northing],[easting,northing],[easting,northing],[easting,northing]]\
])
outfile('Location','C','20')
outfile.record('One')
outfile.save('nestedpolygon')
?
I've replaced to values with northing and easting to save having to enter the figures (I can't include the file).
?
I'm sure my mistake is obvious but as I'm still pretty much a beginner I can't see it :(
?
All suggestions are welcome. 

________________________________
 From: Even Rouault <even.rouault at spatialys.com>
To: Graeme Wilkie <graeme.wilkie at btinternet.com> 
Cc: "gdal-dev at lists.osgeo.org" <gdal-dev at lists.osgeo.org> 
Sent: Friday, August 8, 2014 2:27 PM
Subject: Re: [gdal-dev] GDAL, ESRI Shapefiles and nested polygons
  

Le vendredi 08 ao?t 2014 15:19:38, Graeme Wilkie a ?crit :
> Hi,
>? 
> You were correct, it is returning multipolygon (9sorry, I should have
> included that information). 
> I've made the change you suggested so the code looks like
>? Int index = 0;
> OGRGeometryH hGeometry = OGR_F_GetGeometryRef(hFeature);
> int shape_type = wkbFlatten(ORG_G_GetGeometry(hGeometry);
> int num_geom = OGR_G_GetGeometryCount(hGeometry) - 1; // Returns a valid
> result int innerIndex = 0;
>? 
> do
> {
>? ? ? ? ? ? ? ?  OGRGeometryH hRing = OGR_G_GetGeometryRef(hGeometry,
> index); OGRGeometryH tmpGeo = OGR_G_GetGeometryRef(hRing, innerIndex); Int
> num_vertices = OGR_G_GetPointCount(tmpGeo);
>? ? ? ? ? ? ? ?  //.
> //. Do something with the data
> //.
> Index++;
> }
> // Destroy the hfeature here
> )
>? 
> If innerIndex is 0 then I can read the data for that polygon. If innerIndex
> in 1 then tmpGeo is NULL even though there are 2 inner polygons in the
> test data. 
> Have I do something stupid ?
>? 
> The test data is a simple square with 2 squares inside it created using
> shapefile.py 

You still didn't include the WKT... Well I will assume that you have square T3 
included inside square T2 included inside square T1.

In that case the structure of the WKT should be ((T1,T2),T3)
i.e. a multipolygon with 2 polygons : (T1,T2) and T3
T1 is an outer ring
T2 an inner ring of T1
T3 an outer ring
That's the way polygons are modelised in SFS specification.

> If anybody has a small piece of example could it would be a great help.
>? 
> Regards
>? 
> Graeme
> 
> ________________________________
>? From: Even Rouault <even.rouault at spatialys.com>
> To: gdal-dev at lists.osgeo.org
> Cc: Graeme Wilkie <graeme.wilkie at btinternet.com>
> Sent: Thursday, August 7, 2014 9:26 PM
> Subject: Re: [gdal-dev] GDAL, ESRI Shapefiles and nested polygons
> 
> Le jeudi 07 ao?t 2014 22:20:34, Graeme Wilkie a ?crit :
> > Hi,
> > 
> > I'm trying to use GDAL to read ESRI shapefiles. I've got it working for
> > points, lines, polygons, polylines and multipoint but I'm having problems
> > with polygons that contain polygons in the same feature.
> > 
> > 
> > 
> > The following is a cut down code sample of the code I'm using. The
> > problem I have is that I can read the number of polygons in the feature
> > (i.e. 3 polygons, nested) using OGR_G_GetGemoetryCount. When I use
> > OGR_R_GetGeometryRef to get the handle/pointer for each of the polygons
> > in turn I get what appears to be a valid handle but when I use it to get
> > the number of points/vertices in the polygon it always returns 0.
> 
> Graeme,
> 
> You didn't display the WKT that corresponds to the geometry, so I will just
> make the guess that the geometries returned is a multipolygon and not a
> polygon.
> 
> So you might need one more level of OGR_G_GetGeometryCount and
> OGR_G_GetGeometryRef to go to the ring level.
> 
> Best regards,
> 
> Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140808/151559ee/attachment.html>

From lucena_ivan at hotmail.com  Fri Aug  8 08:08:06 2014
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Fri, 8 Aug 2014 11:08:06 -0400
Subject: [gdal-dev] OGR: memory leak in OCI driver
In-Reply-To: <F02D54DF5576D84C86C23A39A792DC7E31656A8C@se0002v.wallonie.intra>
References: <F02D54DF5576D84C86C23A39A792DC7E3164E534@se0002v.wallonie.intra>,
	<BLU173-W30D9B916CB0161C18790C7904F0@phx.gbl>,
	<F02D54DF5576D84C86C23A39A792DC7E31656A8C@se0002v.wallonie.intra>
Message-ID: <BLU173-W2751A7B12F4F3D37862F4790EE0@phx.gbl>

Your patch was committed to trunk, backported to 1.11 and 1.10. Ticked #5590 close.

Please verify.

Regards,

Ivan

From: nicolas.simon at spw.wallonie.be
To: gdal-dev at lists.osgeo.org
Date: Fri, 1 Aug 2014 14:49:35 +0000
Subject: Re: [gdal-dev] OGR: memory leak in OCI driver









Hi list,
 
                We tested the suggestion of Ivan and it?s better.
                Fortunately, my problem to create ticket was solved

The ticket is  http://trac.osgeo.org/gdal/ticket/5599 with a patch file.
 
Best regards
 
Nicolas
 


De : Ivan Lucena [mailto:lucena_ivan at hotmail.com]


Envoy? : mardi 6 mai 2014 17:48

? : SIMON Nicolas; gdal-dev at lists.osgeo.org

Cc : SANDRI Christophe; NGUYEN Thi Xuan Truc

Objet : RE: [gdal-dev] OGR: memory leak in OCI driver


 

Hi Nicolas,



I received that report a month ago:



"we have found the OGROCISession is never released, causing a large memory leak whenever a connection is closed.


As workaround, we added in OGROCISession::~OGROCISession()



    if( hEnv )

           OCIHandleFree((dvoid *) hEnv, (ub4) OCI_HTYPE_ENV);"



But they also mention some other memory leaks without an specific location on the code.



Can you try to see if that fix the problem?



Thanks,



Ivan








From:
nicolas.simon at spw.wallonie.be

To: gdal-dev at lists.osgeo.org

Date: Tue, 6 May 2014 15:32:09 +0000

CC: christophe.sandri at spw.wallonie.be;
xuan.nguyen at spw.wallonie.be

Subject: [gdal-dev] OGR: memory leak in OCI driver

Dear developers,
 
                I suspect that there is a memory leak in OCI driver for OGR
               

                My simplified test case is :
 
?          

// point A
OGRRegisterAll();
 
// point B
pDS = OGRSFDriverRegistrar::Open("OCI:USER/PWD at INSTANCE:TABLE", true);
if(pDS)
     {
          OGRDataSource::DestroyDataSource(pDS);
          pDS = NULL;
     }
     else
     {
          fprintf(fOut,"Erreur Open\n");
     }
     // point C
     
OGRCleanupAll();
// point D
 
It appears that I lose memory between points B and C, and between point A and D  

 
                B = A + 4 MB
                C = A + 20 MB ( 16 MB lost)
               D = A +19 MB ( 3 more MB lost)

 
Test was done with GDAL 1.9 under windows (with Oracle 11g)
 
Can some one have an idea to find and fix this ?
 
Thank you
 
By the way,  I received ? TICKET_CREATE privileges are required to perform this operation ? when I tried to make a ticket (UID nicsim)
 
Nicolas
 
 



_______________________________________________ gdal-dev mailing list 
gdal-dev at lists.osgeo.org 
http://lists.osgeo.org/mailman/listinfo/gdal-dev






_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140808/72b4d51a/attachment-0001.html>

From lucena_ivan at hotmail.com  Fri Aug  8 08:08:46 2014
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Fri, 8 Aug 2014 11:08:46 -0400
Subject: [gdal-dev] OCI driver: Date field creation improvement
In-Reply-To: <F02D54DF5576D84C86C23A39A792DC7E31656AA8@se0002v.wallonie.intra>
References: <F02D54DF5576D84C86C23A39A792DC7E31656AA8@se0002v.wallonie.intra>
Message-ID: <BLU173-W2782BDDB430FA3E02D278090EE0@phx.gbl>

Your patch was committed to trunk, backported to 1.11 and 1.10. Ticked #5600 close.

Please verify.

Regards,

Ivan

From: nicolas.simon at spw.wallonie.be
To: gdal-dev at lists.osgeo.org
Date: Fri, 1 Aug 2014 14:53:55 +0000
Subject: [gdal-dev] OCI driver: Date field creation improvement









Hi list,
                Can someone could review and commit my patch ?
http://trac.osgeo.org/gdal/ticket/5600
 
Thanks
 
Nicolas
                




_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140808/44c8ae5f/attachment.html>

From even.rouault at spatialys.com  Fri Aug  8 08:34:38 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 8 Aug 2014 17:34:38 +0200
Subject: [gdal-dev] GDAL, ESRI Shapefiles and nested polygons
In-Reply-To: <1407509644.69220.YahooMailNeo@web87401.mail.ir2.yahoo.com>
References: <009a01cfb27d$0c477720$24d66560$@btinternet.com>
	<201408081527.48244.even.rouault@spatialys.com>
	<1407509644.69220.YahooMailNeo@web87401.mail.ir2.yahoo.com>
Message-ID: <201408081734.38751.even.rouault@spatialys.com>

Le vendredi 08 ao?t 2014 16:54:04, Graeme Wilkie a ?crit :
> Hi,
>  
> I don't have a WKT format as such (sorry but I'm learning about all this as
> I go), all I do have is a simple Python script that creates the
> shapefiles. The idea of having T3 inside T2 with both inside /t1 is
> correct in this case but not necessarily always the case. T2 & T3 could
> both be inside T1 side by side. 
> The content of the python script file is as follows (the polygons are T1,
> T2, T3 in order): 
> import shapefile
> outfile = shapefile.Writer(shapefile.POLYGON)
> outfile.poly(parts=[\
> [[easting,northing],[easting,northing],[easting,northing],[easting,northing
> ],\
> [easting,northing],[easting,northing],[easting,northing],[easting,northing
> ]],\
> [[easting,northing],[easting,northing],[easting,northing],[easting,northin
> g]]\ ])
> outfile('Location','C','20')
> outfile.record('One')
> outfile.save('nestedpolygon')
>  
> I've replaced to values with northing and easting to save having to enter
> the figures (I can't include the file). 
> I'm sure my mistake is obvious but as I'm still pretty much a beginner I
> can't see it :( 

What you must realize is that the models of shapefiles and OGR geometry (the 
latter following simple feature specifications) are different. shapefiles have a 
"polygon" type that might be in OGR term either a polygon or a multipolygon. 
So you should be able to handle both cases.
A OGR polygon is a collection of rings, the first one being the outer ring and 
the following ones the inner rings
A OGR multipolygon is a collection of polygon.
When reading a shapefile, OGR does some topological analysis to figure out the 
spatial relationship between rings and determine if they must be outer or 
inner rings.

> All suggestions are welcome.
> 
> ________________________________
>  From: Even Rouault <even.rouault at spatialys.com>
> To: Graeme Wilkie <graeme.wilkie at btinternet.com>
> Cc: "gdal-dev at lists.osgeo.org" <gdal-dev at lists.osgeo.org>
> Sent: Friday, August 8, 2014 2:27 PM
> Subject: Re: [gdal-dev] GDAL, ESRI Shapefiles and nested polygons
> 
> Le vendredi 08 ao?t 2014 15:19:38, Graeme Wilkie a ?crit :
> > Hi,
> >
> > 
> >
> > You were correct, it is returning multipolygon (9sorry, I should have
> > included that information).
> > I've made the change you suggested so the code looks like
> >
> >  Int index = 0;
> >
> > OGRGeometryH hGeometry = OGR_F_GetGeometryRef(hFeature);
> > int shape_type = wkbFlatten(ORG_G_GetGeometry(hGeometry);
> > int num_geom = OGR_G_GetGeometryCount(hGeometry) - 1; // Returns a valid
> > result int innerIndex = 0;
> >
> > 
> >
> > do
> > {
> >
> >                 OGRGeometryH hRing = OGR_G_GetGeometryRef(hGeometry,
> >
> > index); OGRGeometryH tmpGeo = OGR_G_GetGeometryRef(hRing, innerIndex);
> > Int num_vertices = OGR_G_GetPointCount(tmpGeo);
> >
> >                 //.
> >
> > //. Do something with the data
> > //.
> > Index++;
> > }
> > // Destroy the hfeature here
> > )
> >
> > 
> >
> > If innerIndex is 0 then I can read the data for that polygon. If
> > innerIndex in 1 then tmpGeo is NULL even though there are 2 inner
> > polygons in the test data.
> > Have I do something stupid ?
> >
> > 
> >
> > The test data is a simple square with 2 squares inside it created using
> > shapefile.py
> 
> You still didn't include the WKT... Well I will assume that you have square
> T3 included inside square T2 included inside square T1.
> 
> In that case the structure of the WKT should be ((T1,T2),T3)
> i.e. a multipolygon with 2 polygons : (T1,T2) and T3
> T1 is an outer ring
> T2 an inner ring of T1
> T3 an outer ring
> That's the way polygons are modelised in SFS specification.
> 
> > If anybody has a small piece of example could it would be a great help.
> >
> > 
> >
> > Regards
> >
> > 
> >
> > Graeme
> > 
> > ________________________________
> >
> >  From: Even Rouault <even.rouault at spatialys.com>
> >
> > To: gdal-dev at lists.osgeo.org
> > Cc: Graeme Wilkie <graeme.wilkie at btinternet.com>
> > Sent: Thursday, August 7, 2014 9:26 PM
> > Subject: Re: [gdal-dev] GDAL, ESRI Shapefiles and nested polygons
> > 
> > Le jeudi 07 ao?t 2014 22:20:34, Graeme Wilkie a ?crit :
> > > Hi,
> > > 
> > > I'm trying to use GDAL to read ESRI shapefiles. I've got it working for
> > > points, lines, polygons, polylines and multipoint but I'm having
> > > problems with polygons that contain polygons in the same feature.
> > > 
> > > 
> > > 
> > > The following is a cut down code sample of the code I'm using. The
> > > problem I have is that I can read the number of polygons in the feature
> > > (i.e. 3 polygons, nested) using OGR_G_GetGemoetryCount. When I use
> > > OGR_R_GetGeometryRef to get the handle/pointer for each of the polygons
> > > in turn I get what appears to be a valid handle but when I use it to
> > > get the number of points/vertices in the polygon it always returns 0.
> > 
> > Graeme,
> > 
> > You didn't display the WKT that corresponds to the geometry, so I will
> > just make the guess that the geometries returned is a multipolygon and
> > not a polygon.
> > 
> > So you might need one more level of OGR_G_GetGeometryCount and
> > OGR_G_GetGeometryRef to go to the ring level.
> > 
> > Best regards,
> > 
> > Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From flippmoke at gmail.com  Fri Aug  8 09:00:50 2014
From: flippmoke at gmail.com (Blake Thompson)
Date: Fri, 8 Aug 2014 11:00:50 -0500
Subject: [gdal-dev] RFC 47 and Threading
Message-ID: <CAPxHBh9szm_RmMhNMgTTQFTjc_x=dAndVFPvFXzK+F6nn0nXfg@mail.gmail.com>

I wanted to call to everyone's attention the work I have been doing in an
attempt to make it possible for more portions of GDAL to be thread safe and
improve speed in multi-threaded environments. I have put a RFC up here:

http://trac.osgeo.org/gdal/wiki/rfc47_dataset_caching

Originally my work focused on simply changing the way the LRU cache
operated, but I ended up doing more in an attempt to make it much more
efficient while still being thread safe.

Being that this is a core part of GDAL, I wanted to get everyone's
thoughts/questions/concerns on the different ways I have gone about
attempting to solve this problem.

Thanks,

Blake
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140808/8d02dbea/attachment.html>

From jorgearevalo at libregis.org  Fri Aug  8 10:12:06 2014
From: jorgearevalo at libregis.org (Jorge Arevalo)
Date: Fri, 8 Aug 2014 19:12:06 +0200
Subject: [gdal-dev] GSoC 2014 Weekly Report 11 : GDAL PostGIS Raster
	driver
In-Reply-To: <201408081040.28612.even.rouault@spatialys.com>
References: <CAPfr+rsQfdOrwKSCU0hdJOJw6LJTDa6=6oi9PRaVeF3yg4ej-g@mail.gmail.com>
	<201408072228.22975.even.rouault@spatialys.com>
	<CAMhtMNPxSt4SSudC_NmxzG=75NqeVuE+stcAJOUoRXB6OOCTtw@mail.gmail.com>
	<201408081040.28612.even.rouault@spatialys.com>
Message-ID: <CAMhtMNNDePZYPxkipQgAYU=a3q47XSJG=m4URks3QKVOyxRUUg@mail.gmail.com>

Hello,


On Fri, Aug 8, 2014 at 10:40 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le vendredi 08 ao?t 2014 10:26:27, Jorge Arevalo a ?crit :
> > On Thu, Aug 7, 2014 at 10:28 PM, Even Rouault <
> even.rouault at spatialys.com>
> >
> > wrote:
> > > Le jeudi 07 ao?t 2014 22:26:07, Varun Saraf a ?crit :
> > > > Hello,
> > > >
> > > > Thanks. I will use that.
> > > >
> > > > When the PostGISRasterDataset::SetProjection method returns, a
> > >
> > > segmentation
> > >
> > > > fault is being shown. The methods I have made changes to IWriteBlock,
> > > > IRasterIO are not being called. What is the following flow of methods
> > >
> > > that
> > >
> > > > are called? What could be the issue?
> > >
> > > You're in the best position to know ;-) More seriously without looking
> at
> > > the
> > > code, I can only suggest you attaching a debugger or running Valgrind
> to
> > > identify the flaw. (assuming you are developing on Linux)
> >
> > Hello,
> >
> > First of all, I will take guilt for my mistake: as Even said,
> > gdal_translate will always call CreateCopy, as stated at
> >
> http://www.gdal.org/classGDALDriver.html#a2c897da2a6e25169cccc49ef48797ce1
> .
> > My (wrong) assumption was that if you force a modification with regard to
> > the source raster (like providing a different outsize), gdal_translate
> will
> > avoid CreateCopy. My fault.
> >
> > Default implementation of CreateCopy will call Create at the end, but as
> > PostGIS Raster driver provides its own implementation of CreateCopy, this
> > doesn't happen. Quick fix, as also Even suggested, avoid the PostGIS
> Raster
> > implementation of CreateCopy.
> >
> > Varun, about the use of FetchSRSId, I think is a good idea too. The
> problem
> > is your WKT representation of the SRS is a bit different from the
> > representation stored in PostGIS (btw, where does your WKT representation
> > come from?). Well, both of them have the authority code 32644. You just
> > need a method to get this SRID from the WKT.
>
> There are many possible correct variants of WKT for the same EPSG code.
> Depends on if you include all authority nodes, or other optional
> information.
> Like if you strip AXIS order information or not. GDAL has add itself
> variations on the way it export EPSG database as WKT.
> The one if spatial_ref_sys mentionned by Varun must likely comes from a
> GDAL
> <= 1.6 where we, wrongly (according to the BNF of WKT), put the AXIS nodes
> after the AUTHORITY code. This has been fixed in later GDAL versions, but
> the
> PostGIS spatial_ref_sys had not been regenerated since (something I've
> done in
> the recent weeks and that should hopefully go with PostGIS 2.2 :
> http://trac.osgeo.org/postgis/ticket/2737). So all in all relying on WKT
> strict matching isn't reliable.
>

Thanks for the confirmation.


>
> >
> > One way to do it was the query in PostGIS Raster implementation of
> > SetProjection (
> >
> http://trac.osgeo.org/gdal/browser/trunk/gdal/frmts/postgisraster/postgisra
> > sterdataset.cpp#L3024), but it doesn't work for you (again, the PostGIS
> WKT
> > representation is a bit different, so, the query doesn't return a value).
> >
> > Another way is, like Even suggested, to reuse OGRPGDataSource::FetchSRSId
> > (Even, correct me if this isn't what you meant). You just need to build
> an
> > instance of OGRSpatialReference from your WKT string (
> >
> http://www.gdal.org/classOGRSpatialReference.html#a10e93344649a380d75b9925a
> > d53d86ac), and then call FetchSRSId using a pointer to that instance as
> > argument (check the method:
> >
> http://trac.osgeo.org/gdal/browser/trunk/gdal/ogr/ogrsf_frmts/pg/ogrpgdatas
> > ource.cpp#L1931 )
>
Calling directling OGRPGDataSource::FetchSRSId from PostGISRaster isn't
> directly doable since it is a member function of OGRPGDataSource. From my
> quick look, it only requires the hPGConn member. For Varun's need,
> copying&pasting the method and doing the small needed adjustment might be
> the
> quick way for now. In an ideal world, we could think of unifying the 2
> drivers
> but that's another business !
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>

Yes, that was what I meant. For that reason I said 'reuse', not just
'call'. Sorry if I wasn't clear. A C&P should be enough, for the time being
(unifying the drivers sounds right. I'm having the same idea with the QGIS
loader for PostGIS, but I think it requires a lot of work).

Thanks again, Even

Best regards,

Jorge

-- 
Jorge Arevalo

http://about.me/jorgeas80
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140808/8d6f3f3e/attachment-0001.html>

From gusevmihs at gmail.com  Fri Aug  8 14:01:37 2014
From: gusevmihs at gmail.com (Mikhail Gusev)
Date: Sat, 9 Aug 2014 01:01:37 +0400
Subject: [gdal-dev] GSoC weekly report 12. GDAL Networking
Message-ID: <CAJB43VrNPxLpXR=YGSXoHQNHtZUiP=ZhZeu5POQnBSs7SMPLcw@mail.gmail.com>

Hello everyone.
This week I've almost completed my work. See my blog post about what I've
actually complete in GNM:
http://gsoc2014gnm.blogspot.ru/2014/08/week-12-gnm-is-almost-finished.html.
I've also tried to generate the documentation with Doxygen and it was
successful, but before publish the final look of docs I want to make more
comments and to finish two main pages: architecture & tutorial. So as soon
as possible (these weekends or a day-two after) I will complete this and my
work on GNM will be finished. Up to the end of the next week I will also
check everything again with my mentor, so to be sure that all ok and than
after all I'll make an RFC about GNM integration in GDAL.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140809/f05657cb/attachment.html>

From nixanz at nixanz.com  Sat Aug  9 23:05:48 2014
From: nixanz at nixanz.com (Nik Sands)
Date: Sun, 10 Aug 2014 16:05:48 +1000
Subject: [gdal-dev] How to get string representation from OGRStyleMgrH
Message-ID: <E01ACEBB-132D-4AD3-9731-0BF777BFB29E@nixanz.com>

Hi devs,

I've been working with styles using 'OGRStyleMgrH'.  However, I cannot figure out how to get a string directly from an OGRStyleMgrH.  I'd like to be able to get the string representation of the style in the same format as can be used to initialise the OGRStyleMgrH in OGR_SM_InitStyleString().

How can I do this?

Cheers,
Nik.


From even.rouault at spatialys.com  Sun Aug 10 02:30:05 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 10 Aug 2014 11:30:05 +0200
Subject: [gdal-dev] How to get string representation from OGRStyleMgrH
In-Reply-To: <E01ACEBB-132D-4AD3-9731-0BF777BFB29E@nixanz.com>
References: <E01ACEBB-132D-4AD3-9731-0BF777BFB29E@nixanz.com>
Message-ID: <201408101130.05356.even.rouault@spatialys.com>

Le dimanche 10 ao?t 2014 08:05:48, Nik Sands a ?crit :
> Hi devs,
> 
> I've been working with styles using 'OGRStyleMgrH'.  However, I cannot
> figure out how to get a string directly from an OGRStyleMgrH.  I'd like to
> be able to get the string representation of the style in the same format
> as can be used to initialise the OGRStyleMgrH in OGR_SM_InitStyleString().

Nik,

OGRStyleMgr::GetStyleString(NULL) should do :

/**
 * \brief Get the style string from the style manager.
 *
 * @param poFeature feature object from which to read the style or NULL to
 *                  get the style string stored in the manager.
 *
 * @return the style string stored in the feature or the style string stored
 *          in the style manager if poFeature is NULL
 *
 * NOTE: this method will call OGRStyleMgr::InitFromFeature() if poFeature is
 *       not NULL and replace the style string stored in the style manager
 */

Even
> 
> How can I do this?
> 
> Cheers,
> Nik.
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From nixanz at nixanz.com  Sun Aug 10 03:36:02 2014
From: nixanz at nixanz.com (Nik Sands)
Date: Sun, 10 Aug 2014 20:36:02 +1000
Subject: [gdal-dev] How to get string representation from OGRStyleMgrH
In-Reply-To: <201408101130.05356.even.rouault@spatialys.com>
References: <E01ACEBB-132D-4AD3-9731-0BF777BFB29E@nixanz.com>
	<201408101130.05356.even.rouault@spatialys.com>
Message-ID: <289FE748-D613-406A-91E1-A0158E2CD17F@nixanz.com>

Is there a C API equivalent?  Or some other way of doing this without C++?

I'm using C rather than C++.


On 10 Aug 2014, at 7:30 pm, Even Rouault <even.rouault at spatialys.com> wrote:

> Le dimanche 10 ao?t 2014 08:05:48, Nik Sands a ?crit :
>> Hi devs,
>> 
>> I've been working with styles using 'OGRStyleMgrH'.  However, I cannot
>> figure out how to get a string directly from an OGRStyleMgrH.  I'd like to
>> be able to get the string representation of the style in the same format
>> as can be used to initialise the OGRStyleMgrH in OGR_SM_InitStyleString().
> 
> Nik,
> 
> OGRStyleMgr::GetStyleString(NULL) should do :
> 
> /**
> * \brief Get the style string from the style manager.
> *
> * @param poFeature feature object from which to read the style or NULL to
> *                  get the style string stored in the manager.
> *
> * @return the style string stored in the feature or the style string stored
> *          in the style manager if poFeature is NULL
> *
> * NOTE: this method will call OGRStyleMgr::InitFromFeature() if poFeature is
> *       not NULL and replace the style string stored in the style manager
> */
> 
> Even
>> 
>> How can I do this?
>> 
>> Cheers,
>> Nik.
>> 
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com


From even.rouault at spatialys.com  Sun Aug 10 03:57:19 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 10 Aug 2014 12:57:19 +0200
Subject: [gdal-dev] How to get string representation from OGRStyleMgrH
In-Reply-To: <289FE748-D613-406A-91E1-A0158E2CD17F@nixanz.com>
References: <E01ACEBB-132D-4AD3-9731-0BF777BFB29E@nixanz.com>
	<201408101130.05356.even.rouault@spatialys.com>
	<289FE748-D613-406A-91E1-A0158E2CD17F@nixanz.com>
Message-ID: <201408101257.19965.even.rouault@spatialys.com>

Le dimanche 10 ao?t 2014 12:36:02, Nik Sands a ?crit :
> Is there a C API equivalent?  

No, from what I can see

> Or some other way of doing this without C++?

Actually I'm not sure OGRStyleMgr::GetStyleString(NULL) is what you want, at 
least not directly. It just returns the m_pszStyleString member of OGRStyleMgr

You didn't explain your use case, but if it is :
1) initialize a style manager with a style string
2) browse through the tools with GetPart()
3) modify some tools with the tool API
4) get the modified style string

then I believe you have to do something cumbersome :
4b) create a new style manager with an empty style string
5) use AddPart(OGRStyleTool *) on the new style manager to add the unmodified 
and modified tools (you need to keep the pointers obtained from 2), not re-call 
GetPart() on the first style manager)
6) call GetStyleString() on the second style manager

When you modify the tools with the tool API it edits the string of the tool, 
but there's no link with the style manager it comes from, so it won't see the 
change.

The working of the style manager is a bit weird...

> 
> I'm using C rather than C++.
> 
> On 10 Aug 2014, at 7:30 pm, Even Rouault <even.rouault at spatialys.com> wrote:
> > Le dimanche 10 ao?t 2014 08:05:48, Nik Sands a ?crit :
> >> Hi devs,
> >> 
> >> I've been working with styles using 'OGRStyleMgrH'.  However, I cannot
> >> figure out how to get a string directly from an OGRStyleMgrH.  I'd like
> >> to be able to get the string representation of the style in the same
> >> format as can be used to initialise the OGRStyleMgrH in
> >> OGR_SM_InitStyleString().
> > 
> > Nik,
> > 
> > OGRStyleMgr::GetStyleString(NULL) should do :
> > 
> > /**
> > * \brief Get the style string from the style manager.
> > *
> > * @param poFeature feature object from which to read the style or NULL to
> > *                  get the style string stored in the manager.
> > *
> > * @return the style string stored in the feature or the style string
> > stored *          in the style manager if poFeature is NULL
> > *
> > * NOTE: this method will call OGRStyleMgr::InitFromFeature() if poFeature
> > is *       not NULL and replace the style string stored in the style
> > manager */
> > 
> > Even
> > 
> >> How can I do this?
> >> 
> >> Cheers,
> >> Nik.
> >> 
> >> _______________________________________________
> >> gdal-dev mailing list
> >> gdal-dev at lists.osgeo.org
> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From nixanz at nixanz.com  Sun Aug 10 04:31:25 2014
From: nixanz at nixanz.com (Nik Sands)
Date: Sun, 10 Aug 2014 21:31:25 +1000
Subject: [gdal-dev] How to get string representation from OGRStyleMgrH
In-Reply-To: <201408101257.19965.even.rouault@spatialys.com>
References: <E01ACEBB-132D-4AD3-9731-0BF777BFB29E@nixanz.com>
	<201408101130.05356.even.rouault@spatialys.com>
	<289FE748-D613-406A-91E1-A0158E2CD17F@nixanz.com>
	<201408101257.19965.even.rouault@spatialys.com>
Message-ID: <F68FEC19-0CB3-443C-AC3A-646DB00573C2@nixanz.com>

Thanks Even,

Sounds like I'd have to assemble the new style string manually by joining up to four tool style strings using 'OGR_ST_GetStyleString()' (one for each tool that is present) with a ";" in between each.

That should be OK.

Cheers,
Nik.


On 10 Aug 2014, at 8:57 pm, Even Rouault <even.rouault at spatialys.com> wrote:

> Le dimanche 10 ao?t 2014 12:36:02, Nik Sands a ?crit :
>> Is there a C API equivalent?  
> 
> No, from what I can see
> 
>> Or some other way of doing this without C++?
> 
> Actually I'm not sure OGRStyleMgr::GetStyleString(NULL) is what you want, at 
> least not directly. It just returns the m_pszStyleString member of OGRStyleMgr
> 
> You didn't explain your use case, but if it is :
> 1) initialize a style manager with a style string
> 2) browse through the tools with GetPart()
> 3) modify some tools with the tool API
> 4) get the modified style string
> 
> then I believe you have to do something cumbersome :
> 4b) create a new style manager with an empty style string
> 5) use AddPart(OGRStyleTool *) on the new style manager to add the unmodified 
> and modified tools (you need to keep the pointers obtained from 2), not re-call 
> GetPart() on the first style manager)
> 6) call GetStyleString() on the second style manager
> 
> When you modify the tools with the tool API it edits the string of the tool, 
> but there's no link with the style manager it comes from, so it won't see the 
> change.
> 
> The working of the style manager is a bit weird...
> 
>> 
>> I'm using C rather than C++.
>> 
>> On 10 Aug 2014, at 7:30 pm, Even Rouault <even.rouault at spatialys.com> wrote:
>>> Le dimanche 10 ao?t 2014 08:05:48, Nik Sands a ?crit :
>>>> Hi devs,
>>>> 
>>>> I've been working with styles using 'OGRStyleMgrH'.  However, I cannot
>>>> figure out how to get a string directly from an OGRStyleMgrH.  I'd like
>>>> to be able to get the string representation of the style in the same
>>>> format as can be used to initialise the OGRStyleMgrH in
>>>> OGR_SM_InitStyleString().
>>> 
>>> Nik,
>>> 
>>> OGRStyleMgr::GetStyleString(NULL) should do :
>>> 
>>> /**
>>> * \brief Get the style string from the style manager.
>>> *
>>> * @param poFeature feature object from which to read the style or NULL to
>>> *                  get the style string stored in the manager.
>>> *
>>> * @return the style string stored in the feature or the style string
>>> stored *          in the style manager if poFeature is NULL
>>> *
>>> * NOTE: this method will call OGRStyleMgr::InitFromFeature() if poFeature
>>> is *       not NULL and replace the style string stored in the style
>>> manager */
>>> 
>>> Even
>>> 
>>>> How can I do this?
>>>> 
>>>> Cheers,
>>>> Nik.
>>>> 
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev at lists.osgeo.org
>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com


From jorgearevalo at libregis.org  Mon Aug 11 15:35:24 2014
From: jorgearevalo at libregis.org (Jorge Arevalo)
Date: Tue, 12 Aug 2014 00:35:24 +0200
Subject: [gdal-dev] Losing access to dataset variables. Am I doing something
	really dumb?
Message-ID: <CAMhtMNNNdmqzbzz9XdMgSTJEEtN9Ep+cmsB6G1uT7fgj+x_AOw@mail.gmail.com>

Hello,

I have a stupid mistake in my code. This is the problem (very simplified):

postgisrasterdataset.cpp

PostGISRasterDataset::IRasterIO(....)
{
    // Two attributes of my class, that inherits from GDALDataset
    pszAttribute = CPLStrdup("foo");
    pszAttribute2 = CPLStrdup("bar");

    // Just delegates in default implementation
    return GDALDataset::IRasterIO(...);
}


postgisrasterrasterband.cpp

PostGISRasterRasterBand::IRasterIO(....)
{
    // Get pointer to dataset this rasterband belongs to
    PostGISRasterDataset * poRDS = (PostGISRasterDataset *)poDS;

    // Do some stuff with poRDS->pszAttribute and poRDS->pszAttribute2
    // They're private vars, but PostGISRasterRasterBand and
    // PostGISRasterDataset are friends. No problem here.

    // Delegates in default implementation. So, this will result, at the
end, in calls
    // to my implementation of IReadBlock / IWriteBlock
    return GDALRasterBand::IRasterIO(...);
}


PostGISRasterRasterBand::IWriteBlock(...)
{
    // Get pointer to dataset this rasterband belongs to
    PostGISRasterDataset * poRDS = (PostGISRasterDataset *)poDS;

    // Try to work with poRDS->pszAttribute and poRDS->pszAttribute2, but
    // fails because they are NULL. Why??
}

Weirdest thing is the rest of cuestom attributes of my PostGISRasterDataset
class are accessible. And, of course, the poRDS pointer is always the same
(same mem address). Only problem is with those char * attributes. Looks
like they're freed at some point  (or I'm doing something really wrong from
the point of view of C++, and I deserve a severe punishment for that).

Any clues?

Best regards,

-- 
Jorge Arevalo

http://about.me/jorgeas80
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140812/f3941f01/attachment.html>

From varunsaraf14 at gmail.com  Mon Aug 11 22:18:29 2014
From: varunsaraf14 at gmail.com (Varun Saraf)
Date: Tue, 12 Aug 2014 10:48:29 +0530
Subject: [gdal-dev] GSoC 2014 Weekly Report 12 : GDAL PostGIS Raster driver
Message-ID: <CAPfr+rvi9Fjt3Q0Yznx5heXqq4JPFvVrChs2VsCky0f+RkqHgw@mail.gmail.com>

 Hi,

Below is my twelfth weekly report.

*What did I do this week?*

   - The basic version (only inserts, no update) of the driver with write
   capabilities is almost good to go.
   - There is a minor issue with some variables which are getting
   overwritten somewhere between method calls. Need to fix that.

*What do I plan on doing next week?*

   - Continue with testing and bug fixing.
   - Draft final report and documentation.

*Am I blocked on anything?*

   - No.

Link to weekly report :
https://github.com/varunsaraf/postgis_raster/wiki/Report-12
Link to old code repository (some methods from this are to be used in more
advanced version of the driver) :
https://github.com/varunsaraf/postgis_raster
 Link to updated repository : https://github.com/jorgeas80/postgis_raster
More details at : http://trac.osgeo.org/gdal/wiki/PostGIS_raster_driver

Regards,
Varun Saraf
Lab for Spatial Informatics
IIIT Hyderabad, India
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140812/9fb951cf/attachment.html>

From even.rouault at spatialys.com  Tue Aug 12 01:02:57 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 12 Aug 2014 10:02:57 +0200
Subject: [gdal-dev] Losing access to dataset variables. Am I doing
	something really dumb?
In-Reply-To: <CAMhtMNNNdmqzbzz9XdMgSTJEEtN9Ep+cmsB6G1uT7fgj+x_AOw@mail.gmail.com>
References: <CAMhtMNNNdmqzbzz9XdMgSTJEEtN9Ep+cmsB6G1uT7fgj+x_AOw@mail.gmail.com>
Message-ID: <1407830577.53e9ca3172d4c@imp.free.fr>

Hi Jorge,

I don't see anything obviously wrong. Looking at the places where the variables
might be nullified and running Valgrind would be my best advice.
Just wanted to mention that in the likely simplified below snippet, you would
leak memory.

Even

> Hello,
>
> I have a stupid mistake in my code. This is the problem (very simplified):
>
> postgisrasterdataset.cpp
>
> PostGISRasterDataset::IRasterIO(....)
> {
>     // Two attributes of my class, that inherits from GDALDataset
>     pszAttribute = CPLStrdup("foo");
>     pszAttribute2 = CPLStrdup("bar");
>
>     // Just delegates in default implementation
>     return GDALDataset::IRasterIO(...);
> }
>
>
> postgisrasterrasterband.cpp
>
> PostGISRasterRasterBand::IRasterIO(....)
> {
>     // Get pointer to dataset this rasterband belongs to
>     PostGISRasterDataset * poRDS = (PostGISRasterDataset *)poDS;
>
>     // Do some stuff with poRDS->pszAttribute and poRDS->pszAttribute2
>     // They're private vars, but PostGISRasterRasterBand and
>     // PostGISRasterDataset are friends. No problem here.
>
>     // Delegates in default implementation. So, this will result, at the
> end, in calls
>     // to my implementation of IReadBlock / IWriteBlock
>     return GDALRasterBand::IRasterIO(...);
> }
>
>
> PostGISRasterRasterBand::IWriteBlock(...)
> {
>     // Get pointer to dataset this rasterband belongs to
>     PostGISRasterDataset * poRDS = (PostGISRasterDataset *)poDS;
>
>     // Try to work with poRDS->pszAttribute and poRDS->pszAttribute2, but
>     // fails because they are NULL. Why??
> }
>
> Weirdest thing is the rest of cuestom attributes of my PostGISRasterDataset
> class are accessible. And, of course, the poRDS pointer is always the same
> (same mem address). Only problem is with those char * attributes. Looks
> like they're freed at some point  (or I'm doing something really wrong from
> the point of view of C++, and I deserve a severe punishment for that).
>
> Any clues?
>
> Best regards,
>
> --
> Jorge Arevalo
>
> http://about.me/jorgeas80
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jorgearevalo at libregis.org  Tue Aug 12 01:03:38 2014
From: jorgearevalo at libregis.org (Jorge Arevalo)
Date: Tue, 12 Aug 2014 10:03:38 +0200
Subject: [gdal-dev] Losing access to dataset variables. Am I doing
 something really dumb?
In-Reply-To: <1407829707.53e9c6cb9b6ee@imp.free.fr>
References: <CAMhtMNNNdmqzbzz9XdMgSTJEEtN9Ep+cmsB6G1uT7fgj+x_AOw@mail.gmail.com>
	<1407829707.53e9c6cb9b6ee@imp.free.fr>
Message-ID: <CAMhtMNPDMtXu2hLrDKeyBE7ZUx2nUk9srog3fuW=wx+8wv4Jbw@mail.gmail.com>

Hi Even,

Thanks for your hints. About the memory leaking, apart from the obvious
fact that CPLStrdup vars need to be freed, are you seeing something more?


On Tue, Aug 12, 2014 at 9:48 AM, Even Rouault <even.rouault at mines-paris.org>
wrote:

> Hi Jorge,
>
> I don't see anything obviously wrong. Looking at the places where the
> variables
> might be nullified and running Valgrind would be my best advice.
> Just wanted to mention that in the likely simplified below snippet, you
> would
> leak memory.
>
> Even
>
> > Hello,
> >
> > I have a stupid mistake in my code. This is the problem (very
> simplified):
> >
> > postgisrasterdataset.cpp
> >
> > PostGISRasterDataset::IRasterIO(....)
> > {
> >     // Two attributes of my class, that inherits from GDALDataset
> >     pszAttribute = CPLStrdup("foo");
> >     pszAttribute2 = CPLStrdup("bar");
> >
> >     // Just delegates in default implementation
> >     return GDALDataset::IRasterIO(...);
> > }
> >
> >
> > postgisrasterrasterband.cpp
> >
> > PostGISRasterRasterBand::IRasterIO(....)
> > {
> >     // Get pointer to dataset this rasterband belongs to
> >     PostGISRasterDataset * poRDS = (PostGISRasterDataset *)poDS;
> >
> >     // Do some stuff with poRDS->pszAttribute and poRDS->pszAttribute2
> >     // They're private vars, but PostGISRasterRasterBand and
> >     // PostGISRasterDataset are friends. No problem here.
> >
> >     // Delegates in default implementation. So, this will result, at the
> > end, in calls
> >     // to my implementation of IReadBlock / IWriteBlock
> >     return GDALRasterBand::IRasterIO(...);
> > }
> >
> >
> > PostGISRasterRasterBand::IWriteBlock(...)
> > {
> >     // Get pointer to dataset this rasterband belongs to
> >     PostGISRasterDataset * poRDS = (PostGISRasterDataset *)poDS;
> >
> >     // Try to work with poRDS->pszAttribute and poRDS->pszAttribute2, but
> >     // fails because they are NULL. Why??
> > }
> >
> > Weirdest thing is the rest of cuestom attributes of my
> PostGISRasterDataset
> > class are accessible. And, of course, the poRDS pointer is always the
> same
> > (same mem address). Only problem is with those char * attributes. Looks
> > like they're freed at some point  (or I'm doing something really wrong
> from
> > the point of view of C++, and I deserve a severe punishment for that).
> >
> > Any clues?
> >
> > Best regards,
> >
> > --
> > Jorge Arevalo
> >
> > http://about.me/jorgeas80
> >
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140812/d8830119/attachment.html>

From even.rouault at spatialys.com  Tue Aug 12 01:29:27 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 12 Aug 2014 10:29:27 +0200
Subject: [gdal-dev] Losing access to dataset variables. Am I doing
	something really dumb?
In-Reply-To: <CAMhtMNPDMtXu2hLrDKeyBE7ZUx2nUk9srog3fuW=wx+8wv4Jbw@mail.gmail.com>
References: <CAMhtMNNNdmqzbzz9XdMgSTJEEtN9Ep+cmsB6G1uT7fgj+x_AOw@mail.gmail.com>
	<1407829707.53e9c6cb9b6ee@imp.free.fr>
	<CAMhtMNPDMtXu2hLrDKeyBE7ZUx2nUk9srog3fuW=wx+8wv4Jbw@mail.gmail.com>
Message-ID: <1407832167.53e9d0672fe83@imp.free.fr>

Selon Jorge Arevalo <jorgearevalo at libregis.org>:

> Hi Even,
>
> Thanks for your hints. About the memory leaking, apart from the obvious
> fact that CPLStrdup vars need to be freed, are you seeing something more?

No, that was indeed what I meant. Not much more that could leak in the snippet
;-)

>
>
> On Tue, Aug 12, 2014 at 9:48 AM, Even Rouault <even.rouault at mines-paris.org>
> wrote:
>
> > Hi Jorge,
> >
> > I don't see anything obviously wrong. Looking at the places where the
> > variables
> > might be nullified and running Valgrind would be my best advice.
> > Just wanted to mention that in the likely simplified below snippet, you
> > would
> > leak memory.
> >
> > Even
> >
> > > Hello,
> > >
> > > I have a stupid mistake in my code. This is the problem (very
> > simplified):
> > >
> > > postgisrasterdataset.cpp
> > >
> > > PostGISRasterDataset::IRasterIO(....)
> > > {
> > >     // Two attributes of my class, that inherits from GDALDataset
> > >     pszAttribute = CPLStrdup("foo");
> > >     pszAttribute2 = CPLStrdup("bar");
> > >
> > >     // Just delegates in default implementation
> > >     return GDALDataset::IRasterIO(...);
> > > }
> > >
> > >
> > > postgisrasterrasterband.cpp
> > >
> > > PostGISRasterRasterBand::IRasterIO(....)
> > > {
> > >     // Get pointer to dataset this rasterband belongs to
> > >     PostGISRasterDataset * poRDS = (PostGISRasterDataset *)poDS;
> > >
> > >     // Do some stuff with poRDS->pszAttribute and poRDS->pszAttribute2
> > >     // They're private vars, but PostGISRasterRasterBand and
> > >     // PostGISRasterDataset are friends. No problem here.
> > >
> > >     // Delegates in default implementation. So, this will result, at the
> > > end, in calls
> > >     // to my implementation of IReadBlock / IWriteBlock
> > >     return GDALRasterBand::IRasterIO(...);
> > > }
> > >
> > >
> > > PostGISRasterRasterBand::IWriteBlock(...)
> > > {
> > >     // Get pointer to dataset this rasterband belongs to
> > >     PostGISRasterDataset * poRDS = (PostGISRasterDataset *)poDS;
> > >
> > >     // Try to work with poRDS->pszAttribute and poRDS->pszAttribute2, but
> > >     // fails because they are NULL. Why??
> > > }
> > >
> > > Weirdest thing is the rest of cuestom attributes of my
> > PostGISRasterDataset
> > > class are accessible. And, of course, the poRDS pointer is always the
> > same
> > > (same mem address). Only problem is with those char * attributes. Looks
> > > like they're freed at some point  (or I'm doing something really wrong
> > from
> > > the point of view of C++, and I deserve a severe punishment for that).
> > >
> > > Any clues?
> > >
> > > Best regards,
> > >
> > > --
> > > Jorge Arevalo
> > >
> > > http://about.me/jorgeas80
> > >
> >
> >
> >
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at mmmtike.fi  Tue Aug 12 07:01:38 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Tue, 12 Aug 2014 14:01:38 +0000 (UTC)
Subject: [gdal-dev] =?utf-8?q?GPKG_application=5Fid?=
References: <etPan.53e3c5c2.431bd7b7.e15a@Butterfly.local>
	<201408072037.40950.even.rouault@spatialys.com>
Message-ID: <loom.20140812T155820-392@post.gmane.org>

Even Rouault <even.rouault <at> spatialys.com> writes:

> 
> Hi Paul,
...

> > Others are less likely. I?ve learned that GeoServer is emitted GPKG files
> > without the application_id set.
> 
> Hum, do they plan fixing that at some point ? Couldn't they do the same trick 
> we do (direct editing) ?

According to Geotools jira http://jira.codehaus.org/browse/GEOT-4816 this
issue is fixed two days ago.

-Jukka Rahkonen-




From gottfried.mandlburger at geo.tuwien.ac.at  Tue Aug 12 08:54:21 2014
From: gottfried.mandlburger at geo.tuwien.ac.at (Gottfried Mandlburger)
Date: Tue, 12 Aug 2014 16:54:21 +0100
Subject: [gdal-dev] OGR support for POINT ZM
Message-ID: <53EA38AD.2000505@geo.tuwien.ac.at>

Dear GDAL/OGR team,

I just realized that there is no support for the OGC "POINT ZM" geometry 
in GDAL/OGR. It is well possible to read in a 3D point with an 
additional attribute from the following OGC compliant WKT string...

POINT ZM(1. 2. 3. 4.)

... but the attribute value (i.e. 4.) is silently ignored and not 
reflected in the OGRPoint data structure. Especially exporting the above 
contents back to WKT, results in...

POINT(1. 2. 3.)

Any plans to add POINT ZM support in GDAL in the near future?

Kind regards,
Gottfried


-- 
Dr. Gottfried Mandlburger

Tel.: +43 1 58801 12235
Fax.: +43 1 58801 12299
http://www.ipf.tuwien.ac.at
     _____ _____ _____
    /____// ___//    /  Vienna University of Technology
   // __ / /__ / // /  Department of Geodesy and Geoinformation
  //__/// /__ / // /  Research Groups Photogrammetry and Remote Sensing
/____//____//____/  Gusshausstrasse 27-29, A-1040 Vienna

From mateusz at loskot.net  Tue Aug 12 08:57:22 2014
From: mateusz at loskot.net (=?UTF-8?Q?Mateusz_=C5=81oskot?=)
Date: Tue, 12 Aug 2014 17:57:22 +0200
Subject: [gdal-dev] OGR support for POINT ZM
In-Reply-To: <53EA38AD.2000505@geo.tuwien.ac.at>
References: <53EA38AD.2000505@geo.tuwien.ac.at>
Message-ID: <CABUeae9vd3Yf05FoY_ijUBsLBneYN=05nhb4Srw7rhG3uVPiJQ@mail.gmail.com>

On 12 August 2014 17:54, Gottfried Mandlburger
<gottfried.mandlburger at geo.tuwien.ac.at> wrote:
>
> Any plans to add POINT ZM support in GDAL in the near future?

It was proposed to Google Summer of Code [1] this year, but not selected.
I'm not sure if there is any ongoing initiative.

[1] http://trac.osgeo.org/gdal/wiki/SummerOfCode

Best regards,
-- 
Mateusz  ?oskot, http://mateusz.loskot.net

From even.rouault at spatialys.com  Tue Aug 12 09:02:06 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 12 Aug 2014 18:02:06 +0200
Subject: [gdal-dev] OGR support for POINT ZM
In-Reply-To: <53EA38AD.2000505@geo.tuwien.ac.at>
References: <53EA38AD.2000505@geo.tuwien.ac.at>
Message-ID: <1407859326.53ea3a7e0675a@imp.free.fr>

Selon Gottfried Mandlburger <gottfried.mandlburger at geo.tuwien.ac.at>:

> Dear GDAL/OGR team,
>
> I just realized that there is no support for the OGC "POINT ZM" geometry
> in GDAL/OGR. It is well possible to read in a 3D point with an
> additional attribute from the following OGC compliant WKT string...
>
> POINT ZM(1. 2. 3. 4.)
>
> ... but the attribute value (i.e. 4.) is silently ignored and not
> reflected in the OGRPoint data structure. Especially exporting the above
> contents back to WKT, results in...
>
> POINT(1. 2. 3.)
>
> Any plans to add POINT ZM support in GDAL in the near future?

Gottfried,

indeed a long standing wish that is listed in the nice-to-have features for GDAL
2.0 : http://trac.osgeo.org/gdal/wiki/GDAL20Changes. Something looking for
contributors or funding.

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From kursatk at gmail.com  Wed Aug 13 00:55:36 2014
From: kursatk at gmail.com (kursatk)
Date: Wed, 13 Aug 2014 00:55:36 -0700 (PDT)
Subject: [gdal-dev] Register a driver programatically with java
Message-ID: <1407916536657-5156082.post@n6.nabble.com>

Hi;

I'm new to this world. Maybe, it's a easy question but i am trying to solve
this for hours. I have installed all gdal core distribution in C://Program
Files//GDAL. From this directory, i have copied all dll files and put them
in system32. Then i have tried to register gdal plugin netCDF in C://Program
Files//GDAL//gdalplugins//. Here is my code:

gdal.setConfigOption("GDAL_DRIVER_PATH", "C://Program
Files//GDAL//gdalplugins//");
gdal.AllRegister();

Here is the result:
"ERROR 1: Can't load requested DLL: C:/Program
Files/GDAL/gdalplugins/gdal_netCDF.dll" 
126: Specified module can not be found.

What's wrong? Thanks in advance.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Register-a-driver-programatically-with-java-tp5156082.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From kursatk at gmail.com  Wed Aug 13 04:17:08 2014
From: kursatk at gmail.com (kursatk)
Date: Wed, 13 Aug 2014 04:17:08 -0700 (PDT)
Subject: [gdal-dev] Register a driver programatically with java
In-Reply-To: <1407916536657-5156082.post@n6.nabble.com>
References: <1407916536657-5156082.post@n6.nabble.com>
Message-ID: <1407928628804-5156128.post@n6.nabble.com>

I did it. I did everything again from the beginning and it works now. I
think, i have missed any library during copying to system32 folder.

Thanks...



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Register-a-driver-programatically-with-java-tp5156082p5156128.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From lukepinnerau at gmail.com  Wed Aug 13 17:56:11 2014
From: lukepinnerau at gmail.com (Luke Pinner)
Date: Thu, 14 Aug 2014 10:56:11 +1000
Subject: [gdal-dev] Issues building ECW/JP2ECW driver as a plugin on Ubuntu
Message-ID: <CAE8LFTzNCp_Tk8DijL9z=_vGeZ=hDL0S_-=vXrby6x26mB7prw@mail.gmail.com>

I can build the ECW/JP2ECW driver as a plugin (using 5.0 or 5.1 SDK) on
Ubuntu 12.04 (GDAL 1.10) using the gdal-ecw-build script from from the
ubuntugis-unstable libgdal-ecw package (
https://launchpad.net/~ubuntugis/+archive/ubuntugis-unstable).

I have also built the ECW/JP2ECW driver as a plugin (using 5.1 SDK) on
Ubuntu 14.04 by copying the makefile/configure scripts from the 12.04
ubuntugis-unstable libgdal-ecw package to a vanilla GDAL 1.11 source tree
(frmts/ecw), compiling and installing to /usr/lib/gdalplugins/1.11.

On Ubuntu 14.04 the install looks ok when running gdal utilities:
$ gdalinfo --version
GDAL 1.11.0, released 2014/04/16
$ gdalinfo --formats|grep -i ecw
  ECW (rw+): ERDAS Compressed Wavelets (SDK 5.1)
  JP2ECW (rw+v): ERDAS JPEG2000 (SDK 5.1)

However, the ECW and JP2ECW drivers do not work in python:
$ python -c "from osgeo import gdal; print
repr((gdal.GetDriverByName('ECW'),gdal.GetDriverByName('JP2ECW')))"
ERROR 1: /usr/lib/gdalplugins/1.11/gdal_ECW_JP2ECW.so: undefined symbol:
GDALRegisterMe
ERROR 1: /usr/lib/gdalplugins/1.11/gdal_ECW_JP2ECW.so: undefined symbol:
_ZTI22GDALJP2AbstractDataset
(None, None)

On Ubuntu 12.04 (with the plugin built using the gdal-ecw-build script and
provided source package), different undefined symbol errors are reported
when importing gdal in python.

$ python -c "from osgeo import gdal; print
repr((gdal.GetDriverByName('ECW'),gdal.GetDriverByName('JP2ECW')))"
ERROR 1: /usr/lib/gdalplugins/1.10/gdal_ECW_JP2ECW.so: undefined symbol:
_ZTI14GDALPamDataset
ERROR 1: /usr/lib/gdalplugins/1.10/gdal_ECW_JP2ECW.so: undefined symbol:
_ZTI14GDALPamDataset
(None, None)

I reported the issue with 12.04 to UbuntuGIS (
http://trac.osgeo.org/ubuntugis/ticket/34) last year, but there has been no
resolution.

I can always build gdal itself from source with python and ECW support, but
I'd like to easily build ECW support as a plugin so I can just rely on my
package manager to keep everything else up to date.

Can anybody provide some guidance on how to compile the ECW/JP2ECW drivers
as a plugin on Linux?


Regards
Luke
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140814/3779f3ec/attachment.html>

From andre+joost at nurfuerspam.de  Wed Aug 13 21:01:46 2014
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Thu, 14 Aug 2014 06:01:46 +0200
Subject: [gdal-dev] Issues building ECW/JP2ECW driver as a plugin on
	Ubuntu
In-Reply-To: <CAE8LFTzNCp_Tk8DijL9z=_vGeZ=hDL0S_-=vXrby6x26mB7prw@mail.gmail.com>
References: <CAE8LFTzNCp_Tk8DijL9z=_vGeZ=hDL0S_-=vXrby6x26mB7prw@mail.gmail.com>
Message-ID: <lshcf0$m1b$1@ger.gmane.org>

Am 14.08.2014 02:56, schrieb Luke Pinner:

>
> Can anybody provide some guidance on how to compile the ECW/JP2ECW drivers
> as a plugin on Linux?
>
>

I have written down my workflow here:

http://gis.stackexchange.com/questions/94870/unable-to-install-ecw-support-on-lubuntu-14-04

The plugin works in QGIS, but I have not tested it with python.

Maybe you should adress the matter to the ubuntugis mailinglist too.

Greetings,
Andr? Joost


From lukepinnerau at gmail.com  Wed Aug 13 21:18:20 2014
From: lukepinnerau at gmail.com (Luke)
Date: Wed, 13 Aug 2014 21:18:20 -0700 (PDT)
Subject: [gdal-dev] Issues building ECW/JP2ECW driver as a plugin on
	Ubuntu
In-Reply-To: <lshcf0$m1b$1@ger.gmane.org>
References: <CAE8LFTzNCp_Tk8DijL9z=_vGeZ=hDL0S_-=vXrby6x26mB7prw@mail.gmail.com>
	<lshcf0$m1b$1@ger.gmane.org>
Message-ID: <1407989900315-5156335.post@n6.nabble.com>

Andre Joost wrote
> I have written down my workflow here:
> 
> http://gis.stackexchange.com/questions/94870/unable-to-install-ecw-support-on-lubuntu-14-04

Andre, doing this, you are building the plugin for gdal 1.11 with old gdal
1.10 code, which is not optimal as there were quite a few changes to the
ECW/JP2ECW drivers between 1.10 and 1.11.   And it still does not solve the
problem of not being able to use the drivers in python (in fact python
segfaults immediately for me when trying to import gdal). 

What I do is very similar, but use the makefile from libgdal-ecw and
manually build (using the same commands as per `gdal-ecw-build`) against the
gdal 1.11 tree.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Issues-building-ECW-JP2ECW-driver-as-a-plugin-on-Ubuntu-tp5156322p5156335.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From lukepinnerau at gmail.com  Wed Aug 13 21:20:35 2014
From: lukepinnerau at gmail.com (Luke)
Date: Wed, 13 Aug 2014 21:20:35 -0700 (PDT)
Subject: [gdal-dev] Issues building ECW/JP2ECW driver as a plugin on
	Ubuntu
In-Reply-To: <1407989900315-5156335.post@n6.nabble.com>
References: <CAE8LFTzNCp_Tk8DijL9z=_vGeZ=hDL0S_-=vXrby6x26mB7prw@mail.gmail.com>
	<lshcf0$m1b$1@ger.gmane.org>
	<1407989900315-5156335.post@n6.nabble.com>
Message-ID: <1407990035204-5156336.post@n6.nabble.com>

Luke wrote
> ...(in fact python segfaults immediately for me when trying to import
> gdal)...

When using the plugin built as per Andre's workflow.




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Issues-building-ECW-JP2ECW-driver-as-a-plugin-on-Ubuntu-tp5156322p5156336.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From Armin.R.Schmidt at Gmail.com  Thu Aug 14 05:44:58 2014
From: Armin.R.Schmidt at Gmail.com (Armin Schmidt)
Date: Thu, 14 Aug 2014 14:44:58 +0200
Subject: [gdal-dev] Problems packaging with py2exe
Message-ID: <53ECAF4A.6@Gmail.com>

I am trying to package my GDAL/OGR Python project with py2exe so that
the users don't need to do a separate GDAL installation, but I can't get 
it to work.

As an example, this simple two-line program results in the error message 
below when the final .exe file is called.

import osgeo.gdal as gdal
print __name__

Traceback (most recent call last):
   File "temp.py", line 1, in <module>
   File "osgeo\__init__.pyc", line 21, in <module>
   File "osgeo\__init__.pyc", line 13, in swig_import_helper
   File "osgeo\_gdal.pyc", line 12, in <module>
   File "osgeo\_gdal.pyc", line 10, in __load
ImportError: DLL load failed: The specified module could not be found.

I have found several references to the same problem but no definitive
solution. Most comments refer to the correct installation of GDAL - but
the whole point is to distribute everything that is needed from GDAL in
the packaged installation file.

I have used dependency walker to check what _gdal.pyd (or
osgeo._gdal.pyd, which is produced by py2exe) require and have put
missing dll's into the system32 folder, but that didn't help either. I
just can't figure out what
  File "osgeo\_gdal.pyc", line 10, in __load
tries to load.

Armin

-- 
__________________________________________________________________
Dr. Armin Schmidt
Director, GeodataWIZ Ltd:  Geo Data + Visualisation
  www.GeodataWIZ.com
  www.GeodataWIZ.com/armin-schmidt
Chairman, Internat. Society for Archaeological Prospection
  www.archprospection.org
Postdoctoral Researcher, University of Groningen
  Groningen Institute of Archaeology
Honorary Visiting Research Fellow, University of Bradford
  Department of Archaeological Sciences
Honorary Fellow, Durham University, Department of Archaeology
http://orcid.org/0000-0002-4241-5381

Email: Armin.R.Schmidt at Gmail.com

Now available:
Earth Resistance for Archaeologists (2013). Lanham: AltaMira Press
Geophysical Data in Archaeology (2013). Oxford: Oxbow Books.
http://www.amazon.co.uk/-/e/B0034QC4OW
__________________________________________________________________

From s.r.kriishna at gmail.com  Thu Aug 14 07:47:38 2014
From: s.r.kriishna at gmail.com (SIVA RAMA KRISHNA)
Date: Thu, 14 Aug 2014 20:17:38 +0530
Subject: [gdal-dev] querry in updating attribute values using ogrdatasource
Message-ID: <CAP-zkzeTz7idyrfbyULfBdSrXFzt4z-pBEwJfvfU381EzZCyiw@mail.gmail.com>

Hello,

I am trying to update shape file with attribute values .I am performing
following

functionality.

QFileInfo table1(_mActiveLayer); //_mActive Layer is name of file opened
QString tablename1;
tablename1=table1.baseName();
reader = OGRSFDriverRegistrar::Open(_mActiveLayer.toLatin1().data(), TRUE );
    if(reader==NULL)
    {
        exit(0);
    }


poLayer = reader->GetLayer(0);
querrysatatement="UPDATE " +tablename1+" set  SAL= 500 where EMPCODE = 1"
;//table Name is name of the table releated to _mActiveLayer
QByteArray bnewconn = querrysatatement.toLatin1();
conninfonew = new char[bnewconn.length()+1];
strcpy(conninfonew,querrysatatement.toLatin1().data());
poLayer=reader->ExecuteSQL (conninfonew,NULL,dialect.toLatin1().data());

OutPut
syntax error in sql statement

Environment:

Unbuntu 12.04

Gdal version -- 1.9.2
geos version --  3.3.3

Thanks in advance to all
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140814/812be765/attachment.html>

From chaitanya.ch at gmail.com  Thu Aug 14 09:06:57 2014
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Thu, 14 Aug 2014 21:36:57 +0530
Subject: [gdal-dev] querry in updating attribute values using
	ogrdatasource
In-Reply-To: <CAP-zkzeTz7idyrfbyULfBdSrXFzt4z-pBEwJfvfU381EzZCyiw@mail.gmail.com>
References: <CAP-zkzeTz7idyrfbyULfBdSrXFzt4z-pBEwJfvfU381EzZCyiw@mail.gmail.com>
Message-ID: <CAMKgpOYwZ0bTAwMW00jyLVh9K5F+VBsd8s2b-_LEVHmMv8cBtw@mail.gmail.com>

Siva,

OGR SQL dialect doesn't support updates. Use sqlite dialect. You also need
to update GDAL to version 1.10.

http://www.gdal.org/ogr_sql_sqlite.html
 On 14 Aug 2014 20:17, "SIVA RAMA KRISHNA" <s.r.kriishna at gmail.com> wrote:

> Hello,
>
> I am trying to update shape file with attribute values .I am performing
> following
>
> functionality.
>
> QFileInfo table1(_mActiveLayer); //_mActive Layer is name of file opened
> QString tablename1;
> tablename1=table1.baseName();
> reader = OGRSFDriverRegistrar::Open(_mActiveLayer.toLatin1().data(), TRUE
> );
>     if(reader==NULL)
>     {
>         exit(0);
>     }
>
>
> poLayer = reader->GetLayer(0);
> querrysatatement="UPDATE " +tablename1+" set  SAL= 500 where EMPCODE = 1"
> ;//table Name is name of the table releated to _mActiveLayer
> QByteArray bnewconn = querrysatatement.toLatin1();
> conninfonew = new char[bnewconn.length()+1];
> strcpy(conninfonew,querrysatatement.toLatin1().data());
> poLayer=reader->ExecuteSQL (conninfonew,NULL,dialect.toLatin1().data());
>
> OutPut
> syntax error in sql statement
>
> Environment:
>
> Unbuntu 12.04
>
> Gdal version -- 1.9.2
> geos version --  3.3.3
>
> Thanks in advance to all
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140814/b60d5811/attachment.html>

From scott_rowles at hotmail.com  Thu Aug 14 10:20:33 2014
From: scott_rowles at hotmail.com (Scott Rowles)
Date: Thu, 14 Aug 2014 13:20:33 -0400
Subject: [gdal-dev] GDAL - GDB issue
Message-ID: <BLU176-W276AC801E834E850626A6CFFE80@phx.gbl>

Hi,
I have an implementation with C# using GDAL 1.11 binaries.  According to the documentation it should process GDB files either as a .zip file, as a .gdb folder or as a .gdbtalbe individually.
I have tried all 3 of them and each one gives me an ogc.Open, cannot open this file type error.
Is there a switch I need to set or anything I need to do in the GDAL configuration to enable GDB conversion?
scott 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140814/01cb6c3a/attachment-0001.html>

From even.rouault at spatialys.com  Thu Aug 14 10:25:40 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 14 Aug 2014 19:25:40 +0200
Subject: [gdal-dev] GDAL - GDB issue
In-Reply-To: <BLU176-W276AC801E834E850626A6CFFE80@phx.gbl>
References: <BLU176-W276AC801E834E850626A6CFFE80@phx.gbl>
Message-ID: <1408037140.53ecf114e1db0@imp.free.fr>

Selon Scott Rowles <scott_rowles at hotmail.com>:

> Hi,
> I have an implementation with C# using GDAL 1.11 binaries.  According to the
> documentation it should process GDB files either as a .zip file, as a .gdb
> folder or as a .gdbtalbe individually.
> I have tried all 3 of them and each one gives me an ogc.Open, cannot open
> this file type error.
> Is there a switch I need to set or anything I need to do in the GDAL
> configuration to enable GDB conversion?

Well, it should work. Did you try with the ogrinfo utility to see if the dataset
is recognized ?

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Aug 14 10:45:09 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 14 Aug 2014 19:45:09 +0200
Subject: [gdal-dev] GDAL - GDB issue
In-Reply-To: <BLU176-W235095F03B9651A2269A1FFE80@phx.gbl>
References: <BLU176-W276AC801E834E850626A6CFFE80@phx.gbl>,
	<1408037140.53ecf114e1db0@imp.free.fr>
	<BLU176-W235095F03B9651A2269A1FFE80@phx.gbl>
Message-ID: <1408038309.53ecf5a54d933@imp.free.fr>

Selon Scott Rowles <scott_rowles at hotmail.com>:

> Even,
> No.  Where do I find/download the ogrInfo utility.  I will try that!

It should be included in every binary distribution of gdal (e.g.
http://gisinternals.com/sdk/). Or if you compile it from source. It is one of
the many utilities coming with the GDAL library.

> scott
>
> > Date: Thu, 14 Aug 2014 19:25:40 +0200
> > From: even.rouault at spatialys.com
> > To: scott_rowles at hotmail.com
> > CC: gdal-dev at lists.osgeo.org
> > Subject: Re: [gdal-dev] GDAL - GDB issue
> >
> > Selon Scott Rowles <scott_rowles at hotmail.com>:
> >
> > > Hi,
> > > I have an implementation with C# using GDAL 1.11 binaries.  According to
> the
> > > documentation it should process GDB files either as a .zip file, as a
> .gdb
> > > folder or as a .gdbtalbe individually.
> > > I have tried all 3 of them and each one gives me an ogc.Open, cannot open
> > > this file type error.
> > > Is there a switch I need to set or anything I need to do in the GDAL
> > > configuration to enable GDB conversion?
> >
> > Well, it should work. Did you try with the ogrinfo utility to see if the
> dataset
> > is recognized ?
> >
> > Even
> >
> >
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From scott_rowles at hotmail.com  Thu Aug 14 10:41:48 2014
From: scott_rowles at hotmail.com (Scott Rowles)
Date: Thu, 14 Aug 2014 13:41:48 -0400
Subject: [gdal-dev] GDAL - GDB issue
In-Reply-To: <1408037140.53ecf114e1db0@imp.free.fr>
References: <BLU176-W276AC801E834E850626A6CFFE80@phx.gbl>,
	<1408037140.53ecf114e1db0@imp.free.fr>
Message-ID: <BLU176-W235095F03B9651A2269A1FFE80@phx.gbl>

Even,
No.  Where do I find/download the ogrInfo utility.  I will try that!
scott

> Date: Thu, 14 Aug 2014 19:25:40 +0200
> From: even.rouault at spatialys.com
> To: scott_rowles at hotmail.com
> CC: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] GDAL - GDB issue
> 
> Selon Scott Rowles <scott_rowles at hotmail.com>:
> 
> > Hi,
> > I have an implementation with C# using GDAL 1.11 binaries.  According to the
> > documentation it should process GDB files either as a .zip file, as a .gdb
> > folder or as a .gdbtalbe individually.
> > I have tried all 3 of them and each one gives me an ogc.Open, cannot open
> > this file type error.
> > Is there a switch I need to set or anything I need to do in the GDAL
> > configuration to enable GDB conversion?
> 
> Well, it should work. Did you try with the ogrinfo utility to see if the dataset
> is recognized ?
> 
> Even
> 
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com
 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140814/0c7b0699/attachment.html>

From lucena_ivan at hotmail.com  Thu Aug 14 16:56:36 2014
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Thu, 14 Aug 2014 19:56:36 -0400
Subject: [gdal-dev] Problems packaging with py2exe
In-Reply-To: <53ECAF4A.6@Gmail.com>
References: <53ECAF4A.6@Gmail.com>
Message-ID: <BLU173-W22FA3B9CFD6DA0794DAB5490E80@phx.gbl>

Dr. Armi,


> Date: Thu, 14 Aug 2014 14:44:58 +0200
> From: Armin.R.Schmidt at Gmail.com
> To: gdal-dev at lists.osgeo.org
> Subject: [gdal-dev] Problems packaging with py2exe
> 
> I am trying to package my GDAL/OGR Python project with py2exe so that
> the users don't need to do a separate GDAL installation, but I can't get 
> it to work.
> 
> As an example, this simple two-line program results in the error message 
> below when the final .exe file is called.
> 
> import osgeo.gdal as gdal
> print __name__
> 
> Traceback (most recent call last):
>    File "temp.py", line 1, in <module>
>    File "osgeo\__init__.pyc", line 21, in <module>
>    File "osgeo\__init__.pyc", line 13, in swig_import_helper
>    File "osgeo\_gdal.pyc", line 12, in <module>
>    File "osgeo\_gdal.pyc", line 10, in __load
> ImportError: DLL load failed: The specified module could not be found.
> 
> I have found several references to the same problem but no definitive
> solution. Most comments refer to the correct installation of GDAL - but
> the whole point is to distribute everything that is needed from GDAL in
> the packaged installation file.

As far as I know when you run the GDAL Python Extension that does not copy the gdalNN.dll into your Python installation and py2exe can only package what is in there.

> 
> I have used dependency walker to check what _gdal.pyd (or
> osgeo._gdal.pyd, which is produced by py2exe) require and have put
> missing dll's into the system32 folder, but that didn't help either. I
> just can't figure out what
>   File "osgeo\_gdal.pyc", line 10, in __load
> tries to load.

6 years ago I did something like you are trying to do. But I don't works 
with that same environment anymore so I can't reproduce that process. 

But I 
think you should cover the basic first. Like, for example, before running py2exe, 
can your scripts run in both machines, your and the target machine?

If that is true, it is because the folder where gdalNN.dll is installed is
 on your PATH environment variable. If not you might need to fix that. I would prefer changing the PATH instead of copying stuff to the system32 folder. But that is just me.

Would be possible to copy gdalNN.dll to some folder inside the Python installation, so that py2exe can put that into your deployment? I don't know but that could be worth trying.

Good luck.

> 
> Armin
> 
> -- 
> __________________________________________________________________
> Dr. Armin Schmidt
> Director, GeodataWIZ Ltd:  Geo Data + Visualisation
>   www.GeodataWIZ.com
>   www.GeodataWIZ.com/armin-schmidt
> Chairman, Internat. Society for Archaeological Prospection
>   www.archprospection.org
> Postdoctoral Researcher, University of Groningen
>   Groningen Institute of Archaeology
> Honorary Visiting Research Fellow, University of Bradford
>   Department of Archaeological Sciences
> Honorary Fellow, Durham University, Department of Archaeology
> http://orcid.org/0000-0002-4241-5381
> 
> Email: Armin.R.Schmidt at Gmail.com
> 
> Now available:
> Earth Resistance for Archaeologists (2013). Lanham: AltaMira Press
> Geophysical Data in Archaeology (2013). Oxford: Oxbow Books.
> http://www.amazon.co.uk/-/e/B0034QC4OW
> __________________________________________________________________
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140814/0d34901e/attachment.html>

From lukepinnerau at gmail.com  Thu Aug 14 17:55:58 2014
From: lukepinnerau at gmail.com (Luke)
Date: Thu, 14 Aug 2014 17:55:58 -0700 (PDT)
Subject: [gdal-dev] Problems packaging with py2exe
In-Reply-To: <53ECAF4A.6@Gmail.com>
References: <53ECAF4A.6@Gmail.com>
Message-ID: <1408064158301-5156494.post@n6.nabble.com>

Can you post your setup.py? Hard to tell what's going on without it.

Also, I have had good results with pyinstaller, it picks up gdal
dependencies automatically and is as simple as running python pyinstaller.py
somescript.py (or python pyinstaller.py --onefile somescript.py if you want
a single output file instead of a folder).

https://github.com/pyinstaller/pyinstaller
https://pypi.python.org/pypi/PyInstaller/2.1

Luke



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Problems-packaging-with-py2exe-tp5156399p5156494.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From jakebrinkmann at gmail.com  Fri Aug 15 12:40:05 2014
From: jakebrinkmann at gmail.com (Jake Brinkmann)
Date: Fri, 15 Aug 2014 15:40:05 -0400
Subject: [gdal-dev] Build GDAL from scratch on CentOS 6.5
Message-ID: <CAL6CoCjj9JdYqxgUUmxot4NPDxJ82PStvmQuCa5SV-bqFsOLpg@mail.gmail.com>

Hello all geospatial-web-wizards,

I am struggling pretty hard building the GDAL libraries and all the
countless dependencies from source in CentOS6.5. I do not have root access
on my machine, but I need the GDAL (as well as HDF, GeoTiff, GEOS, etc.)
libraries for performing image processing using the Terra/Aqua MODIS
satellite remote sensing data.
Does anyone out there have experience building GDAL along with HDF and
Python bindings, but without, and I emphasize here: *without* root access?
Alternatively, if possible, I would be willing to install a binary, but
remember: I do not have root access (so I'm not sure this would work...)
and lack experience with *.rpm files

Let me know, please, if anyone has any ideas at all.
I am really wishing the Anaconda Python distribution would come with GDAL
supporting HDF4, but it currently does not...

Thanks for reading, and any help you can provide,

Jake Brinkmann
jakebrinkmann at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140815/420fd840/attachment.html>

From mdsumner at gmail.com  Fri Aug 15 13:40:32 2014
From: mdsumner at gmail.com (Michael Sumner)
Date: Sat, 16 Aug 2014 06:40:32 +1000
Subject: [gdal-dev] Build GDAL from scratch on CentOS 6.5
In-Reply-To: <CAL6CoCjj9JdYqxgUUmxot4NPDxJ82PStvmQuCa5SV-bqFsOLpg@mail.gmail.com>
References: <CAL6CoCjj9JdYqxgUUmxot4NPDxJ82PStvmQuCa5SV-bqFsOLpg@mail.gmail.com>
Message-ID: <CAAcGz98tdPgN4jn05u14gq8j+CMV8b5GQQjHsVx2u++ntQPRzQ@mail.gmail.com>

This was helpful for me:

http://scigeo.org/articles/howto-install-latest-geospatial-software-on-linux.html

Cheets, Mike
On 16 Aug 2014 05:40, "Jake Brinkmann" <jakebrinkmann at gmail.com> wrote:

> Hello all geospatial-web-wizards,
>
> I am struggling pretty hard building the GDAL libraries and all the
> countless dependencies from source in CentOS6.5. I do not have root access
> on my machine, but I need the GDAL (as well as HDF, GeoTiff, GEOS, etc.)
> libraries for performing image processing using the Terra/Aqua MODIS
> satellite remote sensing data.
> Does anyone out there have experience building GDAL along with HDF and
> Python bindings, but without, and I emphasize here: *without* root access?
> Alternatively, if possible, I would be willing to install a binary, but
> remember: I do not have root access (so I'm not sure this would work...)
> and lack experience with *.rpm files
>
> Let me know, please, if anyone has any ideas at all.
> I am really wishing the Anaconda Python distribution would come with GDAL
> supporting HDF4, but it currently does not...
>
> Thanks for reading, and any help you can provide,
>
> Jake Brinkmann
> jakebrinkmann at gmail.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140816/7adb55ea/attachment.html>

From even.rouault at spatialys.com  Fri Aug 15 13:45:33 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 15 Aug 2014 22:45:33 +0200
Subject: [gdal-dev] Build GDAL from scratch on CentOS 6.5
In-Reply-To: <CAL6CoCjj9JdYqxgUUmxot4NPDxJ82PStvmQuCa5SV-bqFsOLpg@mail.gmail.com>
References: <CAL6CoCjj9JdYqxgUUmxot4NPDxJ82PStvmQuCa5SV-bqFsOLpg@mail.gmail.com>
Message-ID: <1408135533.53ee716d97f11@imp.free.fr>

Selon Jake Brinkmann <jakebrinkmann at gmail.com>:

> Hello all geospatial-web-wizards,
>
> I am struggling pretty hard building the GDAL libraries and all the
> countless dependencies from source in CentOS6.5. I do not have root access
> on my machine, but I need the GDAL (as well as HDF, GeoTiff, GEOS, etc.)
> libraries for performing image processing using the Terra/Aqua MODIS
> satellite remote sensing data.
> Does anyone out there have experience building GDAL along with HDF and
> Python bindings, but without, and I emphasize here: *without* root access?
> Alternatively, if possible, I would be willing to install a binary, but
> remember: I do not have root access (so I'm not sure this would work...)
> and lack experience with *.rpm files
>
> Let me know, please, if anyone has any ideas at all.
> I am really wishing the Anaconda Python distribution would come with GDAL
> supporting HDF4, but it currently does not...
>
> Thanks for reading, and any help you can provide,

Jake,

It is always possible to build without root access.
The scheme is :
1) Download HDF4 sources, untar, cd to the source directory
2) ./configure --prefix=/somewhere/where/you/have/write/access
3) make install
4) Download GDAL sources, untar, cd to the source directory
5) ./configure --prefix=/somewhere/where/you/have/write/access
--with-hdf4=/somewhere/where/you/have/write/access
6) make install
7) cd swig/python
8) python setup.py build
9) export PYTHONPATH=$PWD/build/lib.linuxXXXXXXXX (to be adapted depending on
your architecture and Python version)
10) export PATH=/somewhere/where/you/have/write/access/bin:$PATH
11) export LD_LIBRARY_PATH=/somewhere/where/you/have/write/access/lib

You should be done.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gusevmihs at gmail.com  Fri Aug 15 13:46:32 2014
From: gusevmihs at gmail.com (Mikhail Gusev)
Date: Sat, 16 Aug 2014 00:46:32 +0400
Subject: [gdal-dev] GSoC weekly report 13. GDAL Networking
Message-ID: <CAJB43VoPBmJuE=0HUg78ET=LT8CcgeSuu8GNaiTKE3MmeHp93w@mail.gmail.com>

Hello everyone.
This week I've finished what I've planed to do: fully complete docs and
tests. See also my blog post
<http://gsoc2014gnm.blogspot.ru/2014/08/week-13-gnm-finished.html> and latest
commits <https://github.com/MikhanGusev/gdal/commits/trunk> at github.
Maybe I need some more small improvements and fixes, so I don't stop and
work at these weekends and Monday up to the final pencils down time. After
that I'll write an RFC about the inclusion of GNM into GDAL.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140816/d9a7e252/attachment.html>

From even.rouault at spatialys.com  Fri Aug 15 13:52:32 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 15 Aug 2014 22:52:32 +0200
Subject: [gdal-dev] GDAL - GDB issue
In-Reply-To: <BLU176-W31F0DCFB421E2288172437FFE90@phx.gbl>
References: <BLU176-W276AC801E834E850626A6CFFE80@phx.gbl>,
	<1408037140.53ecf114e1db0@imp.free.fr>
	<BLU176-W235095F03B9651A2269A1FFE80@phx.gbl>,
	<1408038309.53ecf5a54d933@imp.free.fr>
	<BLU176-W31F0DCFB421E2288172437FFE90@phx.gbl>
Message-ID: <1408135952.53ee73101b534@imp.free.fr>

Selon Scott Rowles <scott_rowles at hotmail.com>:

> OK.  It threw some errors about a missing .csv file which I didn't have
> installed in the solution.  Working on adding that now.  Why doesn't ogr.Open
> return a more clear error?

Please keep the list CC'ed. And when you mention errors that are thrown, you
should copy them verbatim to avoid crystal glass guessing ;-)
Well, I suppose it must have been about the gcs.csv/pcs.csv files that contain
the EPSG projection database. Try to locate where they are installed in your
distribution and define the GDAL_DATA environment variable to point to the
directory where they are located.

>
> > Date: Thu, 14 Aug 2014 19:45:09 +0200
> > From: even.rouault at spatialys.com
> > To: scott_rowles at hotmail.com
> > CC: even.rouault at spatialys.com; gdal-dev at lists.osgeo.org
> > Subject: RE: [gdal-dev] GDAL - GDB issue
> >
> > Selon Scott Rowles <scott_rowles at hotmail.com>:
> >
> > > Even,
> > > No.  Where do I find/download the ogrInfo utility.  I will try that!
> >
> > It should be included in every binary distribution of gdal (e.g.
> > http://gisinternals.com/sdk/). Or if you compile it from source. It is one
> of
> > the many utilities coming with the GDAL library.
> >
> > > scott
> > >
> > > > Date: Thu, 14 Aug 2014 19:25:40 +0200
> > > > From: even.rouault at spatialys.com
> > > > To: scott_rowles at hotmail.com
> > > > CC: gdal-dev at lists.osgeo.org
> > > > Subject: Re: [gdal-dev] GDAL - GDB issue
> > > >
> > > > Selon Scott Rowles <scott_rowles at hotmail.com>:
> > > >
> > > > > Hi,
> > > > > I have an implementation with C# using GDAL 1.11 binaries.  According
> to
> > > the
> > > > > documentation it should process GDB files either as a .zip file, as a
> > > .gdb
> > > > > folder or as a .gdbtalbe individually.
> > > > > I have tried all 3 of them and each one gives me an ogc.Open, cannot
> open
> > > > > this file type error.
> > > > > Is there a switch I need to set or anything I need to do in the GDAL
> > > > > configuration to enable GDB conversion?
> > > >
> > > > Well, it should work. Did you try with the ogrinfo utility to see if
> the
> > > dataset
> > > > is recognized ?
> > > >
> > > > Even
> > > >
> > > >
> > > > --
> > > > Spatialys - Geospatial professional services
> > > > http://www.spatialys.com
> > >
> >
> >
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Aug 15 14:16:58 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 15 Aug 2014 23:16:58 +0200
Subject: [gdal-dev] Build GDAL from scratch on CentOS 6.5
In-Reply-To: <CAL6CoChivhR8=yDAEtReU1Agrb+baOy5Td2t_uOW0O7FY0VzJA@mail.gmail.com>
References: <CAL6CoCjj9JdYqxgUUmxot4NPDxJ82PStvmQuCa5SV-bqFsOLpg@mail.gmail.com>
	<1408135533.53ee716d97f11@imp.free.fr>
	<CAL6CoChivhR8=yDAEtReU1Agrb+baOy5Td2t_uOW0O7FY0VzJA@mail.gmail.com>
Message-ID: <1408137418.53ee78ca2ac3a@imp.free.fr>

Jake,

well if you don't have the basic build dependencies, this might get
complicated... Nothing impossible, but might take time indeed.
Well one possibility is to access a CentOS where you have a root access (e.g. a
VM that you install), build on it, and then copy the resulting binaries.

Even

> Hey Even,
>
> Thank you for outlining this. The trouble I have is that, without root
> access, `make install` is a never-ending list of missing libraries, or
> compilation errors...
> Do you know of a way to resolve the missing libraries without root access
> (and without wasting the next 48hours untaring, compiling, and installing)?
>
> Just as an example, I cant even compile the HDF4 source with `./configure
> --prefix=/have/write/access` because of something with Fortran and g77... I
> disable fortran as `./configure --prefix=/have/write/access
> --enable-fortran=NO` but then it fails due to missing yacc utility.... This
> continues until I get so lost as to what library I'm installing for what
> package, that it just seems there must be an easier way...
>
> If you have any thoughts, please, let me know.
>
> Thank you for reaching out.
> Jake
>
>
> On Fri, Aug 15, 2014 at 4:45 PM, Even Rouault <even.rouault at spatialys.com>
> wrote:
>
> > Selon Jake Brinkmann <jakebrinkmann at gmail.com>:
> >
> > > Hello all geospatial-web-wizards,
> > >
> > > I am struggling pretty hard building the GDAL libraries and all the
> > > countless dependencies from source in CentOS6.5. I do not have root
> > access
> > > on my machine, but I need the GDAL (as well as HDF, GeoTiff, GEOS, etc.)
> > > libraries for performing image processing using the Terra/Aqua MODIS
> > > satellite remote sensing data.
> > > Does anyone out there have experience building GDAL along with HDF and
> > > Python bindings, but without, and I emphasize here: *without* root
> > access?
> > > Alternatively, if possible, I would be willing to install a binary, but
> > > remember: I do not have root access (so I'm not sure this would work...)
> > > and lack experience with *.rpm files
> > >
> > > Let me know, please, if anyone has any ideas at all.
> > > I am really wishing the Anaconda Python distribution would come with GDAL
> > > supporting HDF4, but it currently does not...
> > >
> > > Thanks for reading, and any help you can provide,
> >
> > Jake,
> >
> > It is always possible to build without root access.
> > The scheme is :
> > 1) Download HDF4 sources, untar, cd to the source directory
> > 2) ./configure --prefix=/somewhere/where/you/have/write/access
> > 3) make install
> > 4) Download GDAL sources, untar, cd to the source directory
> > 5) ./configure --prefix=/somewhere/where/you/have/write/access
> > --with-hdf4=/somewhere/where/you/have/write/access
> > 6) make install
> > 7) cd swig/python
> > 8) python setup.py build
> > 9) export PYTHONPATH=$PWD/build/lib.linuxXXXXXXXX (to be adapted depending
> > on
> > your architecture and Python version)
> > 10) export PATH=/somewhere/where/you/have/write/access/bin:$PATH
> > 11) export LD_LIBRARY_PATH=/somewhere/where/you/have/write/access/lib
> >
> > You should be done.
> >
> > Even
> >
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com
> >
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From scott_rowles at hotmail.com  Fri Aug 15 15:11:53 2014
From: scott_rowles at hotmail.com (Scott Rowles)
Date: Fri, 15 Aug 2014 18:11:53 -0400
Subject: [gdal-dev] GDAL - GDB issue
In-Reply-To: <1408135952.53ee73101b534@imp.free.fr>
References: <BLU176-W276AC801E834E850626A6CFFE80@phx.gbl>,
	<1408037140.53ecf114e1db0@imp.free.fr>
	<BLU176-W235095F03B9651A2269A1FFE80@phx.gbl>,
	<1408038309.53ecf5a54d933@imp.free.fr>
	<BLU176-W31F0DCFB421E2288172437FFE90@phx.gbl>,
	<1408135952.53ee73101b534@imp.free.fr>
Message-ID: <BLU176-W28CC907FA25F4C18D5A837FFE90@phx.gbl>

Even,
Yes.  It was 1.  Missing gcs.csv file from the implementation and also setting of paths and 2.  Bad date time formats in the .gdb files.
scott

> Date: Fri, 15 Aug 2014 22:52:32 +0200
> From: even.rouault at spatialys.com
> To: scott_rowles at hotmail.com
> CC: even.rouault at spatialys.com; gdal-dev at lists.osgeo.org
> Subject: RE: [gdal-dev] GDAL - GDB issue
> 
> Selon Scott Rowles <scott_rowles at hotmail.com>:
> 
> > OK.  It threw some errors about a missing .csv file which I didn't have
> > installed in the solution.  Working on adding that now.  Why doesn't ogr.Open
> > return a more clear error?
> 
> Please keep the list CC'ed. And when you mention errors that are thrown, you
> should copy them verbatim to avoid crystal glass guessing ;-)
> Well, I suppose it must have been about the gcs.csv/pcs.csv files that contain
> the EPSG projection database. Try to locate where they are installed in your
> distribution and define the GDAL_DATA environment variable to point to the
> directory where they are located.
> 
> >
> > > Date: Thu, 14 Aug 2014 19:45:09 +0200
> > > From: even.rouault at spatialys.com
> > > To: scott_rowles at hotmail.com
> > > CC: even.rouault at spatialys.com; gdal-dev at lists.osgeo.org
> > > Subject: RE: [gdal-dev] GDAL - GDB issue
> > >
> > > Selon Scott Rowles <scott_rowles at hotmail.com>:
> > >
> > > > Even,
> > > > No.  Where do I find/download the ogrInfo utility.  I will try that!
> > >
> > > It should be included in every binary distribution of gdal (e.g.
> > > http://gisinternals.com/sdk/). Or if you compile it from source. It is one
> > of
> > > the many utilities coming with the GDAL library.
> > >
> > > > scott
> > > >
> > > > > Date: Thu, 14 Aug 2014 19:25:40 +0200
> > > > > From: even.rouault at spatialys.com
> > > > > To: scott_rowles at hotmail.com
> > > > > CC: gdal-dev at lists.osgeo.org
> > > > > Subject: Re: [gdal-dev] GDAL - GDB issue
> > > > >
> > > > > Selon Scott Rowles <scott_rowles at hotmail.com>:
> > > > >
> > > > > > Hi,
> > > > > > I have an implementation with C# using GDAL 1.11 binaries.  According
> > to
> > > > the
> > > > > > documentation it should process GDB files either as a .zip file, as a
> > > > .gdb
> > > > > > folder or as a .gdbtalbe individually.
> > > > > > I have tried all 3 of them and each one gives me an ogc.Open, cannot
> > open
> > > > > > this file type error.
> > > > > > Is there a switch I need to set or anything I need to do in the GDAL
> > > > > > configuration to enable GDB conversion?
> > > > >
> > > > > Well, it should work. Did you try with the ogrinfo utility to see if
> > the
> > > > dataset
> > > > > is recognized ?
> > > > >
> > > > > Even
> > > > >
> > > > >
> > > > > --
> > > > > Spatialys - Geospatial professional services
> > > > > http://www.spatialys.com
> > > >
> > >
> > >
> > > --
> > > Spatialys - Geospatial professional services
> > > http://www.spatialys.com
> >
> 
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com
 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140815/abf99be4/attachment-0001.html>

From scott_rowles at hotmail.com  Fri Aug 15 18:53:09 2014
From: scott_rowles at hotmail.com (Scott Rowles)
Date: Fri, 15 Aug 2014 21:53:09 -0400
Subject: [gdal-dev] GDAL - GDB issue
In-Reply-To: <1408135952.53ee73101b534@imp.free.fr>
References: <BLU176-W276AC801E834E850626A6CFFE80@phx.gbl>,
	<1408037140.53ecf114e1db0@imp.free.fr>
	<BLU176-W235095F03B9651A2269A1FFE80@phx.gbl>,
	<1408038309.53ecf5a54d933@imp.free.fr>
	<BLU176-W31F0DCFB421E2288172437FFE90@phx.gbl>,
	<1408135952.53ee73101b534@imp.free.fr>
Message-ID: <BLU176-W243544EAA603B01F27424FFFD60@phx.gbl>

Even,
I found a new error when parsing a very large file.  Seems to be something in one of the source files:  line 1064
Can you give me an idea what this might be?

scott


> Date: Fri, 15 Aug 2014 22:52:32 +0200
> From: even.rouault at spatialys.com
> To: scott_rowles at hotmail.com
> CC: even.rouault at spatialys.com; gdal-dev at lists.osgeo.org
> Subject: RE: [gdal-dev] GDAL - GDB issue
> 
> Selon Scott Rowles <scott_rowles at hotmail.com>:
> 
> > OK.  It threw some errors about a missing .csv file which I didn't have
> > installed in the solution.  Working on adding that now.  Why doesn't ogr.Open
> > return a more clear error?
> 
> Please keep the list CC'ed. And when you mention errors that are thrown, you
> should copy them verbatim to avoid crystal glass guessing ;-)
> Well, I suppose it must have been about the gcs.csv/pcs.csv files that contain
> the EPSG projection database. Try to locate where they are installed in your
> distribution and define the GDAL_DATA environment variable to point to the
> directory where they are located.
> 
> >
> > > Date: Thu, 14 Aug 2014 19:45:09 +0200
> > > From: even.rouault at spatialys.com
> > > To: scott_rowles at hotmail.com
> > > CC: even.rouault at spatialys.com; gdal-dev at lists.osgeo.org
> > > Subject: RE: [gdal-dev] GDAL - GDB issue
> > >
> > > Selon Scott Rowles <scott_rowles at hotmail.com>:
> > >
> > > > Even,
> > > > No.  Where do I find/download the ogrInfo utility.  I will try that!
> > >
> > > It should be included in every binary distribution of gdal (e.g.
> > > http://gisinternals.com/sdk/). Or if you compile it from source. It is one
> > of
> > > the many utilities coming with the GDAL library.
> > >
> > > > scott
> > > >
> > > > > Date: Thu, 14 Aug 2014 19:25:40 +0200
> > > > > From: even.rouault at spatialys.com
> > > > > To: scott_rowles at hotmail.com
> > > > > CC: gdal-dev at lists.osgeo.org
> > > > > Subject: Re: [gdal-dev] GDAL - GDB issue
> > > > >
> > > > > Selon Scott Rowles <scott_rowles at hotmail.com>:
> > > > >
> > > > > > Hi,
> > > > > > I have an implementation with C# using GDAL 1.11 binaries.  According
> > to
> > > > the
> > > > > > documentation it should process GDB files either as a .zip file, as a
> > > > .gdb
> > > > > > folder or as a .gdbtalbe individually.
> > > > > > I have tried all 3 of them and each one gives me an ogc.Open, cannot
> > open
> > > > > > this file type error.
> > > > > > Is there a switch I need to set or anything I need to do in the GDAL
> > > > > > configuration to enable GDB conversion?
> > > > >
> > > > > Well, it should work. Did you try with the ogrinfo utility to see if
> > the
> > > > dataset
> > > > > is recognized ?
> > > > >
> > > > > Even
> > > > >
> > > > >
> > > > > --
> > > > > Spatialys - Geospatial professional services
> > > > > http://www.spatialys.com
> > > >
> > >
> > >
> > > --
> > > Spatialys - Geospatial professional services
> > > http://www.spatialys.com
> >
> 
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com
 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140815/4fbc9a61/attachment.html>

From even.rouault at spatialys.com  Sat Aug 16 00:59:06 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 16 Aug 2014 09:59:06 +0200
Subject: [gdal-dev] GDAL - GDB issue
In-Reply-To: <BLU176-W243544EAA603B01F27424FFFD60@phx.gbl>
References: <BLU176-W276AC801E834E850626A6CFFE80@phx.gbl>,
	<1408037140.53ecf114e1db0@imp.free.fr>
	<BLU176-W235095F03B9651A2269A1FFE80@phx.gbl>,
	<1408038309.53ecf5a54d933@imp.free.fr>
	<BLU176-W31F0DCFB421E2288172437FFE90@phx.gbl>,
	<1408135952.53ee73101b534@imp.free.fr>
	<BLU176-W243544EAA603B01F27424FFFD60@phx.gbl>
Message-ID: <1408175946.53ef0f4ac081f@imp.free.fr>

Selon Scott Rowles <scott_rowles at hotmail.com>:

> Even,
> I found a new error when parsing a very large file.  Seems to be something in
> one of the source files:  line 1064
> Can you give me an idea what this might be?

Scott,

This is perhaps a defect in the OpenFileGDB driver. I would need access to the
data to examine what is going on. Could you create a ticket in Trac (see the top
of http://trac.osgeo.org/gdal/ on how to do that) and provide in it a link to
the data or attach the data itself as a zip if it is small ? And specify which
filename you provided to Open().

Even

>
> scott
>
>
> > Date: Fri, 15 Aug 2014 22:52:32 +0200
> > From: even.rouault at spatialys.com
> > To: scott_rowles at hotmail.com
> > CC: even.rouault at spatialys.com; gdal-dev at lists.osgeo.org
> > Subject: RE: [gdal-dev] GDAL - GDB issue
> >
> > Selon Scott Rowles <scott_rowles at hotmail.com>:
> >
> > > OK.  It threw some errors about a missing .csv file which I didn't have
> > > installed in the solution.  Working on adding that now.  Why doesn't
> ogr.Open
> > > return a more clear error?
> >
> > Please keep the list CC'ed. And when you mention errors that are thrown,
> you
> > should copy them verbatim to avoid crystal glass guessing ;-)
> > Well, I suppose it must have been about the gcs.csv/pcs.csv files that
> contain
> > the EPSG projection database. Try to locate where they are installed in
> your
> > distribution and define the GDAL_DATA environment variable to point to the
> > directory where they are located.
> >
> > >
> > > > Date: Thu, 14 Aug 2014 19:45:09 +0200
> > > > From: even.rouault at spatialys.com
> > > > To: scott_rowles at hotmail.com
> > > > CC: even.rouault at spatialys.com; gdal-dev at lists.osgeo.org
> > > > Subject: RE: [gdal-dev] GDAL - GDB issue
> > > >
> > > > Selon Scott Rowles <scott_rowles at hotmail.com>:
> > > >
> > > > > Even,
> > > > > No.  Where do I find/download the ogrInfo utility.  I will try that!
> > > >
> > > > It should be included in every binary distribution of gdal (e.g.
> > > > http://gisinternals.com/sdk/). Or if you compile it from source. It is
> one
> > > of
> > > > the many utilities coming with the GDAL library.
> > > >
> > > > > scott
> > > > >
> > > > > > Date: Thu, 14 Aug 2014 19:25:40 +0200
> > > > > > From: even.rouault at spatialys.com
> > > > > > To: scott_rowles at hotmail.com
> > > > > > CC: gdal-dev at lists.osgeo.org
> > > > > > Subject: Re: [gdal-dev] GDAL - GDB issue
> > > > > >
> > > > > > Selon Scott Rowles <scott_rowles at hotmail.com>:
> > > > > >
> > > > > > > Hi,
> > > > > > > I have an implementation with C# using GDAL 1.11 binaries.
> According
> > > to
> > > > > the
> > > > > > > documentation it should process GDB files either as a .zip file,
> as a
> > > > > .gdb
> > > > > > > folder or as a .gdbtalbe individually.
> > > > > > > I have tried all 3 of them and each one gives me an ogc.Open,
> cannot
> > > open
> > > > > > > this file type error.
> > > > > > > Is there a switch I need to set or anything I need to do in the
> GDAL
> > > > > > > configuration to enable GDB conversion?
> > > > > >
> > > > > > Well, it should work. Did you try with the ogrinfo utility to see
> if
> > > the
> > > > > dataset
> > > > > > is recognized ?
> > > > > >
> > > > > > Even
> > > > > >
> > > > > >
> > > > > > --
> > > > > > Spatialys - Geospatial professional services
> > > > > > http://www.spatialys.com
> > > > >
> > > >
> > > >
> > > > --
> > > > Spatialys - Geospatial professional services
> > > > http://www.spatialys.com
> > >
> >
> >
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From daniel.clewley at gmail.com  Sat Aug 16 01:34:24 2014
From: daniel.clewley at gmail.com (Daniel Clewley)
Date: Sat, 16 Aug 2014 09:34:24 +0100
Subject: [gdal-dev] Build GDAL from scratch on CentOS 6.5 (Jake
	Brinkmann)
In-Reply-To: <mailman.23763.1408140715.1977.gdal-dev@lists.osgeo.org>
References: <mailman.23763.1408140715.1977.gdal-dev@lists.osgeo.org>
Message-ID: <09EF3288-A897-4986-B544-24BEE6B19D40@gmail.com>

Hi Jake,

As you mentioned Anaconda Python, one options is to install a different GDAL build from binstar someone has built with HDF4 support or build yourself using the conda build system on a virtual machine you have root access to and then install these binaries through conda.

A quick search of binstar.org showed the following user with GDAL built against HDF4:

https://binstar.org/jevans

You should be able to install this version of GDAL through conda using:

conda install -c https://conda.binstar.org/jevans gdal

Note: I haven't tested this.

Building your own packages is a bit more involved - basically you create a recipe and then build it using:

conda build recipe-folder

There is a github repository with lots of examples here:

https://github.com/conda/conda-recipes/

We've built GDAL and other software through conda for Linux and OS X under virtual machines and installed on different machines (without root access) and it's worked pretty well.

Hope this helps and the discussion of conda isn't too off topic.

Thanks,

Dan

On 15 Aug 2014 23:11, Even Rouault <even.rouault at spatialys.com> wrote:
> 
> Jake,
> 
> well if you don't have the basic build dependencies, this might get
> complicated... Nothing impossible, but might take time indeed.
> Well one possibility is to access a CentOS where you have a root access (e.g. a
> VM that you install), build on it, and then copy the resulting binaries.
> 
> Even
> 
>> Hey Even,
>> 
>> Thank you for outlining this. The trouble I have is that, without root
>> access, `make install` is a never-ending list of missing libraries, or
>> compilation errors...
>> Do you know of a way to resolve the missing libraries without root access
>> (and without wasting the next 48hours untaring, compiling, and installing)?
>> 
>> Just as an example, I cant even compile the HDF4 source with `./configure
>> --prefix=/have/write/access` because of something with Fortran and g77... I
>> disable fortran as `./configure --prefix=/have/write/access
>> --enable-fortran=NO` but then it fails due to missing yacc utility.... This
>> continues until I get so lost as to what library I'm installing for what
>> package, that it just seems there must be an easier way...
>> 
>> If you have any thoughts, please, let me know.
>> 
>> Thank you for reaching out.
>> Jake
>> 
>> 
>> On Fri, Aug 15, 2014 at 4:45 PM, Even Rouault <even.rouault at spatialys.com>
>> wrote:
>> 
>>> Selon Jake Brinkmann <jakebrinkmann at gmail.com>:
>>> 
>>>> Hello all geospatial-web-wizards,
>>>> 
>>>> I am struggling pretty hard building the GDAL libraries and all the
>>>> countless dependencies from source in CentOS6.5. I do not have root
>>> access
>>>> on my machine, but I need the GDAL (as well as HDF, GeoTiff, GEOS, etc.)
>>>> libraries for performing image processing using the Terra/Aqua MODIS
>>>> satellite remote sensing data.
>>>> Does anyone out there have experience building GDAL along with HDF and
>>>> Python bindings, but without, and I emphasize here: *without* root
>>> access?
>>>> Alternatively, if possible, I would be willing to install a binary, but
>>>> remember: I do not have root access (so I'm not sure this would work...)
>>>> and lack experience with *.rpm files
>>>> 
>>>> Let me know, please, if anyone has any ideas at all.
>>>> I am really wishing the Anaconda Python distribution would come with GDAL
>>>> supporting HDF4, but it currently does not...
>>>> 
>>>> Thanks for reading, and any help you can provide,
>>> 
>>> Jake,
>>> 
>>> It is always possible to build without root access.
>>> The scheme is :
>>> 1) Download HDF4 sources, untar, cd to the source directory
>>> 2) ./configure --prefix=/somewhere/where/you/have/write/access
>>> 3) make install
>>> 4) Download GDAL sources, untar, cd to the source directory
>>> 5) ./configure --prefix=/somewhere/where/you/have/write/access
>>> --with-hdf4=/somewhere/where/you/have/write/access
>>> 6) make install
>>> 7) cd swig/python
>>> 8) python setup.py build
>>> 9) export PYTHONPATH=$PWD/build/lib.linuxXXXXXXXX (to be adapted depending
>>> on
>>> your architecture and Python version)
>>> 10) export PATH=/somewhere/where/you/have/write/access/bin:$PATH
>>> 11) export LD_LIBRARY_PATH=/somewhere/where/you/have/write/access/lib
>>> 
>>> You should be done.
>>> 
>>> Even
>>> 
>>> --
>>> Spatialys - Geospatial professional services
>>> http://www.spatialys.com


From Armin.R.Schmidt at Gmail.com  Sun Aug 17 04:04:35 2014
From: Armin.R.Schmidt at Gmail.com (Armin Schmidt)
Date: Sun, 17 Aug 2014 13:04:35 +0200
Subject: [gdal-dev] Problems packaging with py2exe
In-Reply-To: <1408064158301-5156494.post@n6.nabble.com>
References: <53ECAF4A.6@Gmail.com> <1408064158301-5156494.post@n6.nabble.com>
Message-ID: <53F08C43.6050005@Gmail.com>

Thank Luke and Ivan,

Yes, pyinstaller is a good alternative but it didn't work for me either, 
resulting in a near-identical dll-load error to the one from py2exe. And 
it wasn't the gdal???.dll that was the problem; that one was properly 
included both by py2exe and pyinstaller.

The solution was instead to manually include the msvcp100.dll and 
msvcr100.dll that are part of the gdal-111-1600-core.msi and package 
them into the folder in which the compiled exe file is installed. Now it 
works!

Strangely I had tried before to put two dlls with this name into a 
folder that is already in the PATH, and I know that this didn't resolve 
the issue then. I wonder now whether the two files that are part of the 
gdal core installation are slightly different from other files with that 
same name that I found on my machine.

Anyway, it works now. Many thanks again for your comments.

Armin

On 15/08/2014 02:55, Luke wrote:
> Can you post your setup.py? Hard to tell what's going on without it.
>
> Also, I have had good results with pyinstaller, it picks up gdal
> dependencies automatically and is as simple as running python pyinstaller.py
> somescript.py (or python pyinstaller.py --onefile somescript.py if you want
> a single output file instead of a folder).
>
> https://github.com/pyinstaller/pyinstaller
> https://pypi.python.org/pypi/PyInstaller/2.1
>
> Luke
>
>
>
> --
> View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Problems-packaging-with-py2exe-tp5156399p5156494.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>

-- 
__________________________________________________________________
Dr. Armin Schmidt
Director, GeodataWIZ Ltd:  Geo Data + Visualisation
  www.GeodataWIZ.com
  www.GeodataWIZ.com/armin-schmidt
Chairman, Internat. Society for Archaeological Prospection
  www.archprospection.org
Postdoctoral Researcher, University of Groningen
  Groningen Institute of Archaeology
Honorary Visiting Research Fellow, University of Bradford
  Department of Archaeological Sciences
Honorary Fellow, Durham University, Department of Archaeology
http://orcid.org/0000-0002-4241-5381

Email: Armin.R.Schmidt at Gmail.com

Now available:
Earth Resistance for Archaeologists (2013). Lanham: AltaMira Press
Geophysical Data in Archaeology (2013). Oxford: Oxbow Books.
http://www.amazon.co.uk/-/e/B0034QC4OW
__________________________________________________________________

From refriguy68 at yahoo.com  Sun Aug 17 17:46:10 2014
From: refriguy68 at yahoo.com (Robert Zermeno)
Date: Sun, 17 Aug 2014 17:46:10 -0700
Subject: [gdal-dev] libkml support issues
Message-ID: <1408322770.70567.YahooMailNeo@web140306.mail.bf1.yahoo.com>

GDAL folks,

I am trying to support kml support via libkml library in MSVC2008 environment (Windows 32-bit environment on Windows 7).? I have downloaded the repository version as stated in the gdal webpage, built a static library of each required libkml component, and updated nmake.opt to build the libkml support.

Everything worked fine and in my shell program I have a simple API call to verify GDAL can read kml products:

'GDALOpenEx(kmlFile.c_str(), GDAL_OF_VECTOR, NULL, NULL, NULL);'

Now, I keep getting a Access violation reading error in "xmlchar_to_utf8()" in expat_handler.h file in kmlbase.

Has anyone experienced this issue lately?? Which version of expat should I link against??
In the nmake.opt do I uncomment the component to link Expat for libkml support or is that only used for internal KML driver?

I am trying to figure out if I have a libkml issue?? I downloaded the repository at "http://libkml.googlecode.com/svn/trunk/"

Is that the right location to get version 1.3?

Thanks in advance,

Robert
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140817/72862586/attachment.html>

From jukka.rahkonen at mmmtike.fi  Mon Aug 18 03:20:11 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Mon, 18 Aug 2014 10:20:11 +0000 (UTC)
Subject: [gdal-dev] Reveal the meaning of (rw+vs) in driver capabilities
Message-ID: <loom.20140818T114917-390@post.gmane.org>

Hi,

Gdalinfo --formats prints a list of formats and capabilities of each driver
with abbreviations like 

BAG -raster- (ro)
ECW -raster- (rov)
JP2ECW -raster- (rov)
FITS -raster- (rw+)
GMT -raster- (rw)

I believe that I know the meaning of abbreviations myself but I tried to
help someone else and I could not find any good document. How about adding a
little more to gdalinfo manual page http://www.gdal.org/gdalinfo.html?

gdalinfo --formats
Prints a compact list of all supported formats and basic capabilities of
each driver. Driver capabilities are expressed as
r: read
ro: read only
w: write "Create dataset by copying another"
w+: write with support to update "create writable dataset"
s: supports subdatasets
v: supports virtual IO - eg. /vsimem/

gdalinfo --format [format name] e.g. gdalinfo --format GTiff 
Prints a comprehensive report of the capabilities of the specified driver.

-Jukka Rahkonen-


From jukka.rahkonen at mmmtike.fi  Mon Aug 18 03:44:38 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Mon, 18 Aug 2014 10:44:38 +0000 (UTC)
Subject: [gdal-dev] GSoC weekly report 13. GDAL Networking
References: <CAJB43VoPBmJuE=0HUg78ET=LT8CcgeSuu8GNaiTKE3MmeHp93w@mail.gmail.com>
Message-ID: <loom.20140818T123453-294@post.gmane.org>

Mikhail Gusev <gusevmihs <at> gmail.com> writes:

> 
> 
> Hello everyone.
> This week I've finished what I've planed to do: fully complete docs and
tests. See also my blog post and latest commits at github.
> Maybe I need some more small improvements and fixes, so I don't stop and
work at these weekends and Monday up to the final pencils down time. After
that I'll write an RFC about the inclusion of GNM into GDAL.

I need to thank you for the great job. You have completed your task, kept
the timetable and wrote the documents. Too often I have met contracted
professionals who can't do the same. There are for sure many excellent GSoC
projects but would like to mention two other ones which I think are also
amazing: The OSSIM work by Martina Rita
http://trac.osgeo.org/ossim/wiki/GsocDSMGenerationToolForOSSIM and the
PostGIS raster driver by Varun Saraf
https://github.com/varunsaraf/postgis_raster/wiki/GSoC-2014

-Jukka Rahkonen-


From jmckenna at gatewaygeomatics.com  Mon Aug 18 03:53:23 2014
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Mon, 18 Aug 2014 07:53:23 -0300
Subject: [gdal-dev] libkml support issues
In-Reply-To: <1408322770.70567.YahooMailNeo@web140306.mail.bf1.yahoo.com>
References: <1408322770.70567.YahooMailNeo@web140306.mail.bf1.yahoo.com>
Message-ID: <53F1DB23.9060402@gatewaygeomatics.com>

For MS4W builds I follow the wiki page for LibKML at: 
https://trac.osgeo.org/gdal/wiki/LibKML

As it states there, you should get the source through github at: 
https://github.com/google/libkml

In my builds, I use expat-2.1.0, and (following that wiki page) I change 
the 'third_party' path to my own expat lib file.

PS. please don't be afraid to update that wiki page with any helpful 
notes, as you travel down this path.

-jeff



-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/

On 2014-08-17 9:46 PM, Robert Zermeno wrote:
> GDAL folks,
>
> I am trying to support kml support via libkml library in MSVC2008
> environment (Windows 32-bit environment on Windows 7).  I have
> downloaded the repository version as stated in the gdal webpage, built a
> static library of each required libkml component, and updated nmake.opt
> to build the libkml support.
>
> Everything worked fine and in my shell program I have a simple API call
> to verify GDAL can read kml products:
>
> 'GDALOpenEx(kmlFile.c_str(), GDAL_OF_VECTOR, NULL, NULL, NULL);'
>
> Now, I keep getting a Access violation reading error in
> "xmlchar_to_utf8()" in expat_handler.h file in kmlbase.
>
> Has anyone experienced this issue lately?  Which version of expat should
> I link against?
> In the nmake.opt do I uncomment the component to link Expat for libkml
> support or is that only used for internal KML driver?
>
> I am trying to figure out if I have a libkml issue?  I downloaded the
> repository at "http://libkml.googlecode.com/svn/trunk/"
>
> Is that the right location to get version 1.3?
>
> Thanks in advance,
>
> Robert
>



From fniles at mitre.org  Mon Aug 18 05:54:01 2014
From: fniles at mitre.org (Niles, Rick)
Date: Mon, 18 Aug 2014 12:54:01 +0000
Subject: [gdal-dev] Password reminder for mailing list doesn't seem to work
Message-ID: <9DEF5A95E3862946856FC3FC1516D5D82EBC550A@IMCMBX02.MITRE.ORG>

Im very sorry to spam the whole list but I've been trying to unsubscribe from this list for over a year.  I've tried the password reset at least ten times.  It never sends me anything.  I've tried writing to "admin" multiple times with no response.  

Again I'm sorry to send a list wide message but please understand I've exhausted all other options I can think of...

Rick Niles. 

From jakebrinkmann at gmail.com  Mon Aug 18 06:54:50 2014
From: jakebrinkmann at gmail.com (Jake Brinkmann)
Date: Mon, 18 Aug 2014 09:54:50 -0400
Subject: [gdal-dev] Build GDAL from scratch on CentOS 6.5 (Jake
	Brinkmann)
In-Reply-To: <09EF3288-A897-4986-B544-24BEE6B19D40@gmail.com>
References: <mailman.23763.1408140715.1977.gdal-dev@lists.osgeo.org>
	<09EF3288-A897-4986-B544-24BEE6B19D40@gmail.com>
Message-ID: <CAL6CoCgCKYYAFC0zOO72Fyc7hO0AEq2MDhDsSD14eNxDCvpq7w@mail.gmail.com>

Hey Daniel,

Much appreciated! I think building my own on a VM might be the next thing I
try.
I attempted to use jevans version, with a fresh install of Anaconda, but to
no avail.
The code here: https://gist.github.com/jake-brinkmann/fb4bd3f4625b209978d0
still didn't work.

I'll look through the examples to attempt again after building my own
package.

Thank you!
Jake


On Sat, Aug 16, 2014 at 4:34 AM, Daniel Clewley <daniel.clewley at gmail.com>
wrote:

> Hi Jake,
>
> As you mentioned Anaconda Python, one options is to install a different
> GDAL build from binstar someone has built with HDF4 support or build
> yourself using the conda build system on a virtual machine you have root
> access to and then install these binaries through conda.
>
> A quick search of binstar.org showed the following user with GDAL built
> against HDF4:
>
> https://binstar.org/jevans
>
> You should be able to install this version of GDAL through conda using:
>
> conda install -c https://conda.binstar.org/jevans gdal
>
> Note: I haven't tested this.
>
> Building your own packages is a bit more involved - basically you create a
> recipe and then build it using:
>
> conda build recipe-folder
>
> There is a github repository with lots of examples here:
>
> https://github.com/conda/conda-recipes/
>
> We've built GDAL and other software through conda for Linux and OS X under
> virtual machines and installed on different machines (without root access)
> and it's worked pretty well.
>
> Hope this helps and the discussion of conda isn't too off topic.
>
> Thanks,
>
> Dan
>
> On 15 Aug 2014 23:11, Even Rouault <even.rouault at spatialys.com> wrote:
> >
> > Jake,
> >
> > well if you don't have the basic build dependencies, this might get
> > complicated... Nothing impossible, but might take time indeed.
> > Well one possibility is to access a CentOS where you have a root access
> (e.g. a
> > VM that you install), build on it, and then copy the resulting binaries.
> >
> > Even
> >
> >> Hey Even,
> >>
> >> Thank you for outlining this. The trouble I have is that, without root
> >> access, `make install` is a never-ending list of missing libraries, or
> >> compilation errors...
> >> Do you know of a way to resolve the missing libraries without root
> access
> >> (and without wasting the next 48hours untaring, compiling, and
> installing)?
> >>
> >> Just as an example, I cant even compile the HDF4 source with
> `./configure
> >> --prefix=/have/write/access` because of something with Fortran and
> g77... I
> >> disable fortran as `./configure --prefix=/have/write/access
> >> --enable-fortran=NO` but then it fails due to missing yacc utility....
> This
> >> continues until I get so lost as to what library I'm installing for what
> >> package, that it just seems there must be an easier way...
> >>
> >> If you have any thoughts, please, let me know.
> >>
> >> Thank you for reaching out.
> >> Jake
> >>
> >>
> >> On Fri, Aug 15, 2014 at 4:45 PM, Even Rouault <
> even.rouault at spatialys.com>
> >> wrote:
> >>
> >>> Selon Jake Brinkmann <jakebrinkmann at gmail.com>:
> >>>
> >>>> Hello all geospatial-web-wizards,
> >>>>
> >>>> I am struggling pretty hard building the GDAL libraries and all the
> >>>> countless dependencies from source in CentOS6.5. I do not have root
> >>> access
> >>>> on my machine, but I need the GDAL (as well as HDF, GeoTiff, GEOS,
> etc.)
> >>>> libraries for performing image processing using the Terra/Aqua MODIS
> >>>> satellite remote sensing data.
> >>>> Does anyone out there have experience building GDAL along with HDF and
> >>>> Python bindings, but without, and I emphasize here: *without* root
> >>> access?
> >>>> Alternatively, if possible, I would be willing to install a binary,
> but
> >>>> remember: I do not have root access (so I'm not sure this would
> work...)
> >>>> and lack experience with *.rpm files
> >>>>
> >>>> Let me know, please, if anyone has any ideas at all.
> >>>> I am really wishing the Anaconda Python distribution would come with
> GDAL
> >>>> supporting HDF4, but it currently does not...
> >>>>
> >>>> Thanks for reading, and any help you can provide,
> >>>
> >>> Jake,
> >>>
> >>> It is always possible to build without root access.
> >>> The scheme is :
> >>> 1) Download HDF4 sources, untar, cd to the source directory
> >>> 2) ./configure --prefix=/somewhere/where/you/have/write/access
> >>> 3) make install
> >>> 4) Download GDAL sources, untar, cd to the source directory
> >>> 5) ./configure --prefix=/somewhere/where/you/have/write/access
> >>> --with-hdf4=/somewhere/where/you/have/write/access
> >>> 6) make install
> >>> 7) cd swig/python
> >>> 8) python setup.py build
> >>> 9) export PYTHONPATH=$PWD/build/lib.linuxXXXXXXXX (to be adapted
> depending
> >>> on
> >>> your architecture and Python version)
> >>> 10) export PATH=/somewhere/where/you/have/write/access/bin:$PATH
> >>> 11) export LD_LIBRARY_PATH=/somewhere/where/you/have/write/access/lib
> >>>
> >>> You should be done.
> >>>
> >>> Even
> >>>
> >>> --
> >>> Spatialys - Geospatial professional services
> >>> http://www.spatialys.com
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140818/9608fc5b/attachment-0001.html>

From andre+joost at nurfuerspam.de  Mon Aug 18 08:10:07 2014
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Mon, 18 Aug 2014 17:10:07 +0200
Subject: [gdal-dev] Reveal the meaning of (rw+vs) in driver capabilities
In-Reply-To: <loom.20140818T114917-390@post.gmane.org>
References: <loom.20140818T114917-390@post.gmane.org>
Message-ID: <lst53q$ngo$1@ger.gmane.org>

Am 18.08.2014 12:20, schrieb Jukka Rahkonen:
> Hi,
>
> Gdalinfo --formats prints a list of formats and capabilities of each driver
> with abbreviations like
>
> BAG -raster- (ro)
> ECW -raster- (rov)
> JP2ECW -raster- (rov)
> FITS -raster- (rw+)
> GMT -raster- (rw)
>

>
> gdalinfo --format [format name] e.g. gdalinfo --format GTiff
> Prints a comprehensive report of the capabilities of the specified driver.

True, for the virtual IO, but it does not report the limited read 
capabilities of the PDF driver in the QGIS OSGEO4W shell.

Greetings,
Andr? Joost



From jgomezdans at gmail.com  Mon Aug 18 09:59:50 2014
From: jgomezdans at gmail.com (Jose Gomez-Dans)
Date: Mon, 18 Aug 2014 17:59:50 +0100
Subject: [gdal-dev] Build GDAL from scratch on CentOS 6.5 (Jake
	Brinkmann)
In-Reply-To: <CAL6CoCgCKYYAFC0zOO72Fyc7hO0AEq2MDhDsSD14eNxDCvpq7w@mail.gmail.com>
References: <mailman.23763.1408140715.1977.gdal-dev@lists.osgeo.org>
	<09EF3288-A897-4986-B544-24BEE6B19D40@gmail.com>
	<CAL6CoCgCKYYAFC0zOO72Fyc7hO0AEq2MDhDsSD14eNxDCvpq7w@mail.gmail.com>
Message-ID: <CAMWde5oQDQee4ob=_A7iS9HbJFZb89F3-gY2s5q1O_S-eq-mnA@mail.gmail.com>

Hello,

I have produced a GDAL (1.11.0) binary for Anaconda with HDF4, HDF5 and
NetCDF for X86_64. It should just work by installing standard anaconda and
issuing the following command:

conda install -c https://conda.binstar.org/jgomezdans gdal=1.11.0

The list of supported raster formats is available here:
https://gist.github.com/jgomezdans/11c1bb9ce266495e6544, but in reality, I
need it for working with MODIS data, so only tested MODIS, HDF5 and netcdf.

Hope it's of use to other people!
Jose


On 18 August 2014 14:54, Jake Brinkmann <jakebrinkmann at gmail.com> wrote:

> Hey Daniel,
>
> Much appreciated! I think building my own on a VM might be the next thing
> I try.
> I attempted to use jevans version, with a fresh install of Anaconda, but
> to no avail.
> The code here: https://gist.github.com/jake-brinkmann/fb4bd3f4625b209978d0
> still didn't work.
>
> I'll look through the examples to attempt again after building my own
> package.
>
> Thank you!
> Jake
>
>
> On Sat, Aug 16, 2014 at 4:34 AM, Daniel Clewley <daniel.clewley at gmail.com>
> wrote:
>
>> Hi Jake,
>>
>> As you mentioned Anaconda Python, one options is to install a different
>> GDAL build from binstar someone has built with HDF4 support or build
>> yourself using the conda build system on a virtual machine you have root
>> access to and then install these binaries through conda.
>>
>> A quick search of binstar.org showed the following user with GDAL built
>> against HDF4:
>>
>> https://binstar.org/jevans
>>
>> You should be able to install this version of GDAL through conda using:
>>
>> conda install -c https://conda.binstar.org/jevans gdal
>>
>> Note: I haven't tested this.
>>
>> Building your own packages is a bit more involved - basically you create
>> a recipe and then build it using:
>>
>> conda build recipe-folder
>>
>> There is a github repository with lots of examples here:
>>
>> https://github.com/conda/conda-recipes/
>>
>> We've built GDAL and other software through conda for Linux and OS X
>> under virtual machines and installed on different machines (without root
>> access) and it's worked pretty well.
>>
>> Hope this helps and the discussion of conda isn't too off topic.
>>
>> Thanks,
>>
>> Dan
>>
>> On 15 Aug 2014 23:11, Even Rouault <even.rouault at spatialys.com> wrote:
>> >
>> > Jake,
>> >
>> > well if you don't have the basic build dependencies, this might get
>> > complicated... Nothing impossible, but might take time indeed.
>> > Well one possibility is to access a CentOS where you have a root access
>> (e.g. a
>> > VM that you install), build on it, and then copy the resulting binaries.
>> >
>> > Even
>> >
>> >> Hey Even,
>> >>
>> >> Thank you for outlining this. The trouble I have is that, without root
>> >> access, `make install` is a never-ending list of missing libraries, or
>> >> compilation errors...
>> >> Do you know of a way to resolve the missing libraries without root
>> access
>> >> (and without wasting the next 48hours untaring, compiling, and
>> installing)?
>> >>
>> >> Just as an example, I cant even compile the HDF4 source with
>> `./configure
>> >> --prefix=/have/write/access` because of something with Fortran and
>> g77... I
>> >> disable fortran as `./configure --prefix=/have/write/access
>> >> --enable-fortran=NO` but then it fails due to missing yacc utility....
>> This
>> >> continues until I get so lost as to what library I'm installing for
>> what
>> >> package, that it just seems there must be an easier way...
>> >>
>> >> If you have any thoughts, please, let me know.
>> >>
>> >> Thank you for reaching out.
>> >> Jake
>> >>
>> >>
>> >> On Fri, Aug 15, 2014 at 4:45 PM, Even Rouault <
>> even.rouault at spatialys.com>
>> >> wrote:
>> >>
>> >>> Selon Jake Brinkmann <jakebrinkmann at gmail.com>:
>> >>>
>> >>>> Hello all geospatial-web-wizards,
>> >>>>
>> >>>> I am struggling pretty hard building the GDAL libraries and all the
>> >>>> countless dependencies from source in CentOS6.5. I do not have root
>> >>> access
>> >>>> on my machine, but I need the GDAL (as well as HDF, GeoTiff, GEOS,
>> etc.)
>> >>>> libraries for performing image processing using the Terra/Aqua MODIS
>> >>>> satellite remote sensing data.
>> >>>> Does anyone out there have experience building GDAL along with HDF
>> and
>> >>>> Python bindings, but without, and I emphasize here: *without* root
>> >>> access?
>> >>>> Alternatively, if possible, I would be willing to install a binary,
>> but
>> >>>> remember: I do not have root access (so I'm not sure this would
>> work...)
>> >>>> and lack experience with *.rpm files
>> >>>>
>> >>>> Let me know, please, if anyone has any ideas at all.
>> >>>> I am really wishing the Anaconda Python distribution would come with
>> GDAL
>> >>>> supporting HDF4, but it currently does not...
>> >>>>
>> >>>> Thanks for reading, and any help you can provide,
>> >>>
>> >>> Jake,
>> >>>
>> >>> It is always possible to build without root access.
>> >>> The scheme is :
>> >>> 1) Download HDF4 sources, untar, cd to the source directory
>> >>> 2) ./configure --prefix=/somewhere/where/you/have/write/access
>> >>> 3) make install
>> >>> 4) Download GDAL sources, untar, cd to the source directory
>> >>> 5) ./configure --prefix=/somewhere/where/you/have/write/access
>> >>> --with-hdf4=/somewhere/where/you/have/write/access
>> >>> 6) make install
>> >>> 7) cd swig/python
>> >>> 8) python setup.py build
>> >>> 9) export PYTHONPATH=$PWD/build/lib.linuxXXXXXXXX (to be adapted
>> depending
>> >>> on
>> >>> your architecture and Python version)
>> >>> 10) export PATH=/somewhere/where/you/have/write/access/bin:$PATH
>> >>> 11) export LD_LIBRARY_PATH=/somewhere/where/you/have/write/access/lib
>> >>>
>> >>> You should be done.
>> >>>
>> >>> Even
>> >>>
>> >>> --
>> >>> Spatialys - Geospatial professional services
>> >>> http://www.spatialys.com
>>
>>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140818/2a81c6e1/attachment.html>

From jakebrinkmann at gmail.com  Mon Aug 18 10:54:44 2014
From: jakebrinkmann at gmail.com (Jake Brinkmann)
Date: Mon, 18 Aug 2014 13:54:44 -0400
Subject: [gdal-dev] Build GDAL from scratch on CentOS 6.5 (Jake
	Brinkmann)
In-Reply-To: <CAMWde5oQDQee4ob=_A7iS9HbJFZb89F3-gY2s5q1O_S-eq-mnA@mail.gmail.com>
References: <mailman.23763.1408140715.1977.gdal-dev@lists.osgeo.org>
	<09EF3288-A897-4986-B544-24BEE6B19D40@gmail.com>
	<CAL6CoCgCKYYAFC0zOO72Fyc7hO0AEq2MDhDsSD14eNxDCvpq7w@mail.gmail.com>
	<CAMWde5oQDQee4ob=_A7iS9HbJFZb89F3-gY2s5q1O_S-eq-mnA@mail.gmail.com>
Message-ID: <CAL6CoCjC+wB91DE-2UrZrWha7P8KJT3zvzWRNfd_dLrCLTKNgg@mail.gmail.com>

Hey Jose!

That looks like is is exactly what I need! I really appreciate you doing
this.
I installed it on a fresh version of Anaconda, but could not import gdal:

jbrinkmann> python -c "from osgeo import gdal"
> Traceback (most recent call last):
>   File "<string>", line 1, in <module>
>   File
> "/workspace/jbrinkmann/.gdalpy/lib/python2.7/site-packages/osgeo/__init__.py",
> line 21, in <module>
>     _gdal = swig_import_helper()
>   File
> "/workspace/jbrinkmann/.gdalpy/lib/python2.7/site-packages/osgeo/__init__.py",
> line 17, in swig_import_helper
>     _mod = imp.load_module('_gdal', fp, pathname, description)
> ImportError:
> /workspace/jbrinkmann/.gdalpy/lib/python2.7/site-packages/osgeo/_gdal.so:
> undefined symbol: GDALRasterBandGetVirtualMem
>

Do you know what the issue could be?

Thanks again!


On Mon, Aug 18, 2014 at 12:59 PM, Jose Gomez-Dans <jgomezdans at gmail.com>
wrote:

> Hello,
>
> I have produced a GDAL (1.11.0) binary for Anaconda with HDF4, HDF5 and
> NetCDF for X86_64. It should just work by installing standard anaconda and
> issuing the following command:
>
> conda install -c https://conda.binstar.org/jgomezdans gdal=1.11.0
>
> The list of supported raster formats is available here:
> https://gist.github.com/jgomezdans/11c1bb9ce266495e6544, but in reality,
> I need it for working with MODIS data, so only tested MODIS, HDF5 and
> netcdf.
>
> Hope it's of use to other people!
> Jose
>
>
> On 18 August 2014 14:54, Jake Brinkmann <jakebrinkmann at gmail.com> wrote:
>
>> Hey Daniel,
>>
>> Much appreciated! I think building my own on a VM might be the next thing
>> I try.
>> I attempted to use jevans version, with a fresh install of Anaconda, but
>> to no avail.
>> The code here:
>> https://gist.github.com/jake-brinkmann/fb4bd3f4625b209978d0 still didn't
>> work.
>>
>> I'll look through the examples to attempt again after building my own
>> package.
>>
>> Thank you!
>> Jake
>>
>>
>> On Sat, Aug 16, 2014 at 4:34 AM, Daniel Clewley <daniel.clewley at gmail.com
>> > wrote:
>>
>>> Hi Jake,
>>>
>>> As you mentioned Anaconda Python, one options is to install a different
>>> GDAL build from binstar someone has built with HDF4 support or build
>>> yourself using the conda build system on a virtual machine you have root
>>> access to and then install these binaries through conda.
>>>
>>> A quick search of binstar.org showed the following user with GDAL built
>>> against HDF4:
>>>
>>> https://binstar.org/jevans
>>>
>>> You should be able to install this version of GDAL through conda using:
>>>
>>> conda install -c https://conda.binstar.org/jevans gdal
>>>
>>> Note: I haven't tested this.
>>>
>>> Building your own packages is a bit more involved - basically you create
>>> a recipe and then build it using:
>>>
>>> conda build recipe-folder
>>>
>>> There is a github repository with lots of examples here:
>>>
>>> https://github.com/conda/conda-recipes/
>>>
>>> We've built GDAL and other software through conda for Linux and OS X
>>> under virtual machines and installed on different machines (without root
>>> access) and it's worked pretty well.
>>>
>>> Hope this helps and the discussion of conda isn't too off topic.
>>>
>>> Thanks,
>>>
>>> Dan
>>>
>>> On 15 Aug 2014 23:11, Even Rouault <even.rouault at spatialys.com> wrote:
>>> >
>>> > Jake,
>>> >
>>> > well if you don't have the basic build dependencies, this might get
>>> > complicated... Nothing impossible, but might take time indeed.
>>> > Well one possibility is to access a CentOS where you have a root
>>> access (e.g. a
>>> > VM that you install), build on it, and then copy the resulting
>>> binaries.
>>> >
>>> > Even
>>> >
>>> >> Hey Even,
>>> >>
>>> >> Thank you for outlining this. The trouble I have is that, without root
>>> >> access, `make install` is a never-ending list of missing libraries, or
>>> >> compilation errors...
>>> >> Do you know of a way to resolve the missing libraries without root
>>> access
>>> >> (and without wasting the next 48hours untaring, compiling, and
>>> installing)?
>>> >>
>>> >> Just as an example, I cant even compile the HDF4 source with
>>> `./configure
>>> >> --prefix=/have/write/access` because of something with Fortran and
>>> g77... I
>>> >> disable fortran as `./configure --prefix=/have/write/access
>>> >> --enable-fortran=NO` but then it fails due to missing yacc
>>> utility.... This
>>> >> continues until I get so lost as to what library I'm installing for
>>> what
>>> >> package, that it just seems there must be an easier way...
>>> >>
>>> >> If you have any thoughts, please, let me know.
>>> >>
>>> >> Thank you for reaching out.
>>> >> Jake
>>> >>
>>> >>
>>> >> On Fri, Aug 15, 2014 at 4:45 PM, Even Rouault <
>>> even.rouault at spatialys.com>
>>> >> wrote:
>>> >>
>>> >>> Selon Jake Brinkmann <jakebrinkmann at gmail.com>:
>>> >>>
>>> >>>> Hello all geospatial-web-wizards,
>>> >>>>
>>> >>>> I am struggling pretty hard building the GDAL libraries and all the
>>> >>>> countless dependencies from source in CentOS6.5. I do not have root
>>> >>> access
>>> >>>> on my machine, but I need the GDAL (as well as HDF, GeoTiff, GEOS,
>>> etc.)
>>> >>>> libraries for performing image processing using the Terra/Aqua MODIS
>>> >>>> satellite remote sensing data.
>>> >>>> Does anyone out there have experience building GDAL along with HDF
>>> and
>>> >>>> Python bindings, but without, and I emphasize here: *without* root
>>> >>> access?
>>> >>>> Alternatively, if possible, I would be willing to install a binary,
>>> but
>>> >>>> remember: I do not have root access (so I'm not sure this would
>>> work...)
>>> >>>> and lack experience with *.rpm files
>>> >>>>
>>> >>>> Let me know, please, if anyone has any ideas at all.
>>> >>>> I am really wishing the Anaconda Python distribution would come
>>> with GDAL
>>> >>>> supporting HDF4, but it currently does not...
>>> >>>>
>>> >>>> Thanks for reading, and any help you can provide,
>>> >>>
>>> >>> Jake,
>>> >>>
>>> >>> It is always possible to build without root access.
>>> >>> The scheme is :
>>> >>> 1) Download HDF4 sources, untar, cd to the source directory
>>> >>> 2) ./configure --prefix=/somewhere/where/you/have/write/access
>>> >>> 3) make install
>>> >>> 4) Download GDAL sources, untar, cd to the source directory
>>> >>> 5) ./configure --prefix=/somewhere/where/you/have/write/access
>>> >>> --with-hdf4=/somewhere/where/you/have/write/access
>>> >>> 6) make install
>>> >>> 7) cd swig/python
>>> >>> 8) python setup.py build
>>> >>> 9) export PYTHONPATH=$PWD/build/lib.linuxXXXXXXXX (to be adapted
>>> depending
>>> >>> on
>>> >>> your architecture and Python version)
>>> >>> 10) export PATH=/somewhere/where/you/have/write/access/bin:$PATH
>>> >>> 11) export LD_LIBRARY_PATH=/somewhere/where/you/have/write/access/lib
>>> >>>
>>> >>> You should be done.
>>> >>>
>>> >>> Even
>>> >>>
>>> >>> --
>>> >>> Spatialys - Geospatial professional services
>>> >>> http://www.spatialys.com
>>>
>>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140818/e213b111/attachment-0001.html>

From ari.jolma at gmail.com  Mon Aug 18 12:33:35 2014
From: ari.jolma at gmail.com (Ari Jolma)
Date: Mon, 18 Aug 2014 22:33:35 +0300
Subject: [gdal-dev] Password reminder for mailing list doesn't seem to
 work
In-Reply-To: <9DEF5A95E3862946856FC3FC1516D5D82EBC550A@IMCMBX02.MITRE.ORG>
References: <9DEF5A95E3862946856FC3FC1516D5D82EBC550A@IMCMBX02.MITRE.ORG>
Message-ID: <53F2550F.7080202@gmail.com>

On 08/18/2014 03:54 PM, Niles, Rick wrote:
> Im very sorry to spam the whole list but I've been trying to unsubscribe from this list for over a year.  I've tried the password reset at least ten times.  It never sends me anything.

Nick,

It sends to me the password reminder.

Anyway, I think Frank or whoever is the list manager can unsubscribe 
you. Hm, I see I can manage the list too. I'll unsubscribe you after 
this mail.

Cheers,

Ari

>    I've tried writing to "admin" multiple times with no response.
>
> Again I'm sorry to send a list wide message but please understand I've exhausted all other options I can think of...
>
> Rick Niles.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From varunsaraf14 at gmail.com  Mon Aug 18 13:53:08 2014
From: varunsaraf14 at gmail.com (Varun Saraf)
Date: Tue, 19 Aug 2014 02:23:08 +0530
Subject: [gdal-dev] GSoC 2014 Weekly Report 13 : GDAL PostGIS Raster driver
Message-ID: <CAPfr+rsuwoTZQykgzL-4UdvRFUiqqYh_qsH0=wW6PUy9g0v=Rw@mail.gmail.com>

 Hi,

Below is my thirteenth weekly report.

*What did I do this week?*

   - There was a issue with some variables which were getting overwritten
   somewhere between method calls. The destructor for the PostGISDataset class
   was being called before PostGISRasterRasterBand::IWriteBlock(). We made a
   copy of those variables in the PostGISRasterRasterBand class to resolve the
   issue.
   - Fixed minor bugs.
   - The driver can be used to load rasters which are divided into equally
   sized tiles. We need to use the GDAL_SWATH_SIZE config option to insert
   bigger tiles (>10 mb) for now.

Link to weekly report :
https://github.com/varunsaraf/postgis_raster/wiki/Report-13
Link to old code repository (some methods from this are to be used in more
advanced version of the driver) :
https://github.com/varunsaraf/postgis_raster
 Link to updated repository : https://github.com/jorgeas80/postgis_raster
More details at : http://trac.osgeo.org/gdal/wiki/PostGIS_raster_driver

Regards,
Varun Saraf
Lab for Spatial Informatics
IIIT Hyderabad, India
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140819/f4113fe5/attachment.html>

From tomerlieber at gmail.com  Tue Aug 19 04:26:34 2014
From: tomerlieber at gmail.com (Tomer)
Date: Tue, 19 Aug 2014 04:26:34 -0700 (PDT)
Subject: [gdal-dev] Converting MDB File With Unicode Characters
Message-ID: <1408447594701-5157110.post@n6.nabble.com>

Hey, 

I'm using a C# wrapper of GDAL and I'm having a problem converting MDB file
that contains unicode characters. 

Lets take for example conversion to KML file, non-English characters are
replaced by '?' 

How do I solve it?



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Converting-MDB-File-With-Unicode-Characters-tp5157110.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Tue Aug 19 06:53:39 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 19 Aug 2014 15:53:39 +0200
Subject: [gdal-dev] Planning for 1.11.1 release ?
Message-ID: <1408456419.53f356e34023f@imp.free.fr>

Hi,

The 1.11 branch has accumulated 57 fixes [1] since the 1.11.0 release (perhaps a
bit more if some of them went to the 1.10 branch as well), so it might be good
to think producing a maintenance release with them.

What do you think of end of September to produce an RC (let's say September
24th) ?

If there are outstanding regressions that should be fixed for 1.11.1, raise
tickets and cook up your patches !
There are 7 tickets currently opened against 1.11.1 milestone ([2]). GDAL
committers, please have a look at them and update milestone if needed.

Anyone volunteering to do the release process ? If nobody else wants, I will.

Best regards,

Even

[1]
http://trac.osgeo.org/gdal/query?status=closed&group=resolution&order=priority&milestone=1.11.1&resolution=fixed
[2]
http://trac.osgeo.org/gdal/query?status=assigned&status=new&status=reopened&group=resolution&order=priority&col=id&col=summary&col=owner&col=type&col=priority&col=component&col=version&milestone=1.11.1

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From flippmoke at gmail.com  Tue Aug 19 07:07:36 2014
From: flippmoke at gmail.com (Flippmoke)
Date: Tue, 19 Aug 2014 09:07:36 -0500
Subject: [gdal-dev] Planning for 1.11.1 release ?
In-Reply-To: <1408456419.53f356e34023f@imp.free.fr>
References: <1408456419.53f356e34023f@imp.free.fr>
Message-ID: <E5E8CEC5-9599-44BA-8EE4-408B28F5C56F@gmail.com>

I wouldn't mind learning some of it, but would rather not being in charge of it.

Thanks,

Blake Thompson

> On Aug 19, 2014, at 8:53 AM, Even Rouault <even.rouault at spatialys.com> wrote:
> 
> Hi,
> 
> The 1.11 branch has accumulated 57 fixes [1] since the 1.11.0 release (perhaps a
> bit more if some of them went to the 1.10 branch as well), so it might be good
> to think producing a maintenance release with them.
> 
> What do you think of end of September to produce an RC (let's say September
> 24th) ?
> 
> If there are outstanding regressions that should be fixed for 1.11.1, raise
> tickets and cook up your patches !
> There are 7 tickets currently opened against 1.11.1 milestone ([2]). GDAL
> committers, please have a look at them and update milestone if needed.
> 
> Anyone volunteering to do the release process ? If nobody else wants, I will.
> 
> Best regards,
> 
> Even
> 
> [1]
> http://trac.osgeo.org/gdal/query?status=closed&group=resolution&order=priority&milestone=1.11.1&resolution=fixed
> [2]
> http://trac.osgeo.org/gdal/query?status=assigned&status=new&status=reopened&group=resolution&order=priority&col=id&col=summary&col=owner&col=type&col=priority&col=component&col=version&milestone=1.11.1
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at spatialys.com  Tue Aug 19 10:20:44 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 19 Aug 2014 19:20:44 +0200
Subject: [gdal-dev] Planning for 1.11.1 release ?
In-Reply-To: <E5E8CEC5-9599-44BA-8EE4-408B28F5C56F@gmail.com>
References: <1408456419.53f356e34023f@imp.free.fr>
	<E5E8CEC5-9599-44BA-8EE4-408B28F5C56F@gmail.com>
Message-ID: <1408468844.53f3876c37431@imp.free.fr>

Selon Flippmoke <flippmoke at gmail.com>:

> I wouldn't mind learning some of it, but would rather not being in charge of
> it.

Hi Blake,

The process is documented at http://svn.osgeo.org/gdal/trunk/gdal/HOWTO-RELEASE
To issue the release itself, most steps that require commit rights and access to
the OSGeo server. But there are other opportunities of helping, such as triaging
tickets, proposing patches or testing release candidate.

Even

>
> Thanks,
>
> Blake Thompson
>
> > On Aug 19, 2014, at 8:53 AM, Even Rouault <even.rouault at spatialys.com>
> wrote:
> >
> > Hi,
> >
> > The 1.11 branch has accumulated 57 fixes [1] since the 1.11.0 release
> (perhaps a
> > bit more if some of them went to the 1.10 branch as well), so it might be
> good
> > to think producing a maintenance release with them.
> >
> > What do you think of end of September to produce an RC (let's say September
> > 24th) ?
> >
> > If there are outstanding regressions that should be fixed for 1.11.1, raise
> > tickets and cook up your patches !
> > There are 7 tickets currently opened against 1.11.1 milestone ([2]). GDAL
> > committers, please have a look at them and update milestone if needed.
> >
> > Anyone volunteering to do the release process ? If nobody else wants, I
> will.
> >
> > Best regards,
> >
> > Even
> >
> > [1]
> >
>
http://trac.osgeo.org/gdal/query?status=closed&group=resolution&order=priority&milestone=1.11.1&resolution=fixed
> > [2]
> >
>
http://trac.osgeo.org/gdal/query?status=assigned&status=new&status=reopened&group=resolution&order=priority&col=id&col=summary&col=owner&col=type&col=priority&col=component&col=version&milestone=1.11.1
> >
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From awood at agi.com  Tue Aug 19 13:19:42 2014
From: awood at agi.com (Wood, Alexander)
Date: Tue, 19 Aug 2014 20:19:42 +0000
Subject: [gdal-dev] Projection issues with PAMAP LiDAR
Message-ID: <79ded25bf6e34567906146671877c2e4@BY2PR07MB842.namprd07.prod.outlook.com>

I recently ran into a projection problem with the PA LiDAR dataset and saw that Ticket #4954 documents the issue.  Even had mentioned (in the forum thread linked in that Trac ticket) that he has a patch for this issue.  I was just wondering if there were plans to include this in the 1.11.1 release.  It is currently targeted to 1.11.0.

Thanks,
Alex
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140819/6244882b/attachment.html>

From even.rouault at spatialys.com  Tue Aug 19 13:59:27 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 19 Aug 2014 22:59:27 +0200
Subject: [gdal-dev] Projection issues with PAMAP LiDAR
In-Reply-To: <79ded25bf6e34567906146671877c2e4@BY2PR07MB842.namprd07.prod.outlook.com>
References: <79ded25bf6e34567906146671877c2e4@BY2PR07MB842.namprd07.prod.outlook.com>
Message-ID: <1408481967.53f3baafca585@imp.free.fr>

Selon "Wood, Alexander" <awood at agi.com>:

> I recently ran into a projection problem with the PA LiDAR dataset and saw
> that Ticket #4954 documents the issue.  Even had mentioned (in the forum
> thread linked in that Trac ticket) that he has a patch for this issue.

Did I ? I can remember this issue is regularly raised but AFAIK nobody has
produced a patch yet.

> I was
> just wondering if there were plans to include this in the 1.11.1 release.  It
> is currently targeted to 1.11.0.
>
> Thanks,
> Alex
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From mathuin at gmail.com  Tue Aug 19 18:42:13 2014
From: mathuin at gmail.com (John Twilley)
Date: Tue, 19 Aug 2014 18:42:13 -0700
Subject: [gdal-dev] Questions about polygonization
Message-ID: <CAEUMa-f2z4NqFwi+RdsaaT0p2ds5t3VW7ubviLncQH3ms1A_Rw@mail.gmail.com>

I am trying to use GDAL's polygonize algorithms to help me identify
regions in landcover data.  I made a trivial example, but I am having
trouble understanding the results that I get, nor can I determine how
to get the results I want.

Given the following raster:

11 11 11 11 11
11 11 11 11 11
11 11 12 11 11
11 11 11 11 11
11 11 11 11 11
11 11 11 11 11

If I were to polygonize this raster, I would expect two polygons:  one
which contains the single point 12, and another with an outer ring was
the perimeter of the raster and an inner ring circling the single
point 12.  I would also expect that the first polygon would contain
the single point 12 and that the second polygon would contain all the
points 11.

Instead, what I got was a polygon starting from the single point 12
and extending down and to the right one pixel, and another polygon
with an outer ring that went off the down and right edges and an inner
ring equal to the first polygon's outer ring.  The first polygon
doesn't actually contain any points and the second one doesn't contain
any points on either ring but does contain all the other points.

What do I need to do to get the results I am expecting?

Jack.
--
mathuin at gmail dot com

From mwtoews at gmail.com  Tue Aug 19 19:15:12 2014
From: mwtoews at gmail.com (Mike Toews)
Date: Wed, 20 Aug 2014 14:15:12 +1200
Subject: [gdal-dev] Questions about polygonization
In-Reply-To: <CAEUMa-f2z4NqFwi+RdsaaT0p2ds5t3VW7ubviLncQH3ms1A_Rw@mail.gmail.com>
References: <CAEUMa-f2z4NqFwi+RdsaaT0p2ds5t3VW7ubviLncQH3ms1A_Rw@mail.gmail.com>
Message-ID: <CAM2FmMrDpSoBx3U9V18KaLGu_r7FRDD3EJ9co9Q_mtOwqZfOLA@mail.gmail.com>

Hi Jack,

I'm not sure if I understand the description of the shapes you see.
Can you provide the WKT for them? I seem to get two polygons that look
like they should:

import numpy as np
import rasterio.features
from shapely.geometry import shape
ar = np.ones((6, 5), 'B') * 11
ar[2, 2] = 12
gt = [0, 1, 0, 6, 0, -1]
for (sh, v) in rasterio.features.shapes(ar, transform=gt):
    print('%s: %s' % (v, shape(sh)))

11: POLYGON ((0 6, 0 0, 5 0, 5 6, 0 6), (2 4, 3 4, 3 3, 2 3, 2 4))
12: POLYGON ((2 4, 2 3, 3 3, 3 4, 2 4))

-Mike

From chaitanya.ch at gmail.com  Tue Aug 19 19:17:10 2014
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Wed, 20 Aug 2014 07:47:10 +0530
Subject: [gdal-dev] Questions about polygonization
In-Reply-To: <CAEUMa-f2z4NqFwi+RdsaaT0p2ds5t3VW7ubviLncQH3ms1A_Rw@mail.gmail.com>
References: <CAEUMa-f2z4NqFwi+RdsaaT0p2ds5t3VW7ubviLncQH3ms1A_Rw@mail.gmail.com>
Message-ID: <CAMKgpObkEmsmX9YY2itkX6uNs941j08-gBT=iS0Pyt8W0vDvyg@mail.gmail.com>

Jack,
The GDALPolygonize algorithm draws the polygon edges along the pixel edges.
It assumes the pixels to be rectangular areas instead of points.
In the example you described, the first polygon should contain four
vertices with the pixel in the centre.
Make sure that the program you are using to display them is not shifting
the pixels.
 On 20 Aug 2014 07:12, "John Twilley" <mathuin at gmail.com> wrote:

> I am trying to use GDAL's polygonize algorithms to help me identify
> regions in landcover data.  I made a trivial example, but I am having
> trouble understanding the results that I get, nor can I determine how
> to get the results I want.
>
> Given the following raster:
>
> 11 11 11 11 11
> 11 11 11 11 11
> 11 11 12 11 11
> 11 11 11 11 11
> 11 11 11 11 11
> 11 11 11 11 11
>
> If I were to polygonize this raster, I would expect two polygons:  one
> which contains the single point 12, and another with an outer ring was
> the perimeter of the raster and an inner ring circling the single
> point 12.  I would also expect that the first polygon would contain
> the single point 12 and that the second polygon would contain all the
> points 11.
>
> Instead, what I got was a polygon starting from the single point 12
> and extending down and to the right one pixel, and another polygon
> with an outer ring that went off the down and right edges and an inner
> ring equal to the first polygon's outer ring.  The first polygon
> doesn't actually contain any points and the second one doesn't contain
> any points on either ring but does contain all the other points.
>
> What do I need to do to get the results I am expecting?
>
> Jack.
> --
> mathuin at gmail dot com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140820/1f2e7b2b/attachment.html>

From mathuin at gmail.com  Tue Aug 19 19:19:08 2014
From: mathuin at gmail.com (John Twilley)
Date: Tue, 19 Aug 2014 19:19:08 -0700
Subject: [gdal-dev] Questions about polygonization
In-Reply-To: <CAM2FmMrDpSoBx3U9V18KaLGu_r7FRDD3EJ9co9Q_mtOwqZfOLA@mail.gmail.com>
References: <CAEUMa-f2z4NqFwi+RdsaaT0p2ds5t3VW7ubviLncQH3ms1A_Rw@mail.gmail.com>
	<CAM2FmMrDpSoBx3U9V18KaLGu_r7FRDD3EJ9co9Q_mtOwqZfOLA@mail.gmail.com>
Message-ID: <CAEUMa-exFFf8rNFJBTKqS4C2oJMNyTx4F2xynNnhFrVf4AiUTg@mail.gmail.com>

Hi Mike!

I get the same polygons you get -- what I don't understand is why I'm
getting those polygons instead of the ones that I expected.  Can you
explain why those polygons look like they should?

Jack.
--
mathuin at gmail dot com


On Tue, Aug 19, 2014 at 7:15 PM, Mike Toews <mwtoews at gmail.com> wrote:
> Hi Jack,
>
> I'm not sure if I understand the description of the shapes you see.
> Can you provide the WKT for them? I seem to get two polygons that look
> like they should:
>
> import numpy as np
> import rasterio.features
> from shapely.geometry import shape
> ar = np.ones((6, 5), 'B') * 11
> ar[2, 2] = 12
> gt = [0, 1, 0, 6, 0, -1]
> for (sh, v) in rasterio.features.shapes(ar, transform=gt):
>     print('%s: %s' % (v, shape(sh)))
>
> 11: POLYGON ((0 6, 0 0, 5 0, 5 6, 0 6), (2 4, 3 4, 3 3, 2 3, 2 4))
> 12: POLYGON ((2 4, 2 3, 3 3, 3 4, 2 4))
>
> -Mike

From mathuin at gmail.com  Tue Aug 19 19:26:44 2014
From: mathuin at gmail.com (John Twilley)
Date: Tue, 19 Aug 2014 19:26:44 -0700
Subject: [gdal-dev] Questions about polygonization
In-Reply-To: <CAMKgpObkEmsmX9YY2itkX6uNs941j08-gBT=iS0Pyt8W0vDvyg@mail.gmail.com>
References: <CAEUMa-f2z4NqFwi+RdsaaT0p2ds5t3VW7ubviLncQH3ms1A_Rw@mail.gmail.com>
	<CAMKgpObkEmsmX9YY2itkX6uNs941j08-gBT=iS0Pyt8W0vDvyg@mail.gmail.com>
Message-ID: <CAEUMa-em-0YBzA=qNDQVqi_bDmWTUQA5N3sB8JkJcqtpDzS-rw@mail.gmail.com>

The program is not shifting the pixels, but the program does assume
the pixels to be points and not rectangular areas so maybe I will have
to shift the pixels.  Do you know what transformation I would need to
use?

Jack.
--
mathuin at gmail dot com


On Tue, Aug 19, 2014 at 7:17 PM, Chaitanya kumar CH
<chaitanya.ch at gmail.com> wrote:
> Jack,
> The GDALPolygonize algorithm draws the polygon edges along the pixel edges.
> It assumes the pixels to be rectangular areas instead of points.
> In the example you described, the first polygon should contain four vertices
> with the pixel in the centre.
> Make sure that the program you are using to display them is not shifting the
> pixels.
>
> On 20 Aug 2014 07:12, "John Twilley" <mathuin at gmail.com> wrote:
>>
>> I am trying to use GDAL's polygonize algorithms to help me identify
>> regions in landcover data.  I made a trivial example, but I am having
>> trouble understanding the results that I get, nor can I determine how
>> to get the results I want.
>>
>> Given the following raster:
>>
>> 11 11 11 11 11
>> 11 11 11 11 11
>> 11 11 12 11 11
>> 11 11 11 11 11
>> 11 11 11 11 11
>> 11 11 11 11 11
>>
>> If I were to polygonize this raster, I would expect two polygons:  one
>> which contains the single point 12, and another with an outer ring was
>> the perimeter of the raster and an inner ring circling the single
>> point 12.  I would also expect that the first polygon would contain
>> the single point 12 and that the second polygon would contain all the
>> points 11.
>>
>> Instead, what I got was a polygon starting from the single point 12
>> and extending down and to the right one pixel, and another polygon
>> with an outer ring that went off the down and right edges and an inner
>> ring equal to the first polygon's outer ring.  The first polygon
>> doesn't actually contain any points and the second one doesn't contain
>> any points on either ring but does contain all the other points.
>>
>> What do I need to do to get the results I am expecting?
>>
>> Jack.
>> --
>> mathuin at gmail dot com
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From chaitanya.ch at gmail.com  Tue Aug 19 19:32:56 2014
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Wed, 20 Aug 2014 08:02:56 +0530
Subject: [gdal-dev] Questions about polygonization
In-Reply-To: <CAEUMa-em-0YBzA=qNDQVqi_bDmWTUQA5N3sB8JkJcqtpDzS-rw@mail.gmail.com>
References: <CAEUMa-f2z4NqFwi+RdsaaT0p2ds5t3VW7ubviLncQH3ms1A_Rw@mail.gmail.com>
	<CAMKgpObkEmsmX9YY2itkX6uNs941j08-gBT=iS0Pyt8W0vDvyg@mail.gmail.com>
	<CAEUMa-em-0YBzA=qNDQVqi_bDmWTUQA5N3sB8JkJcqtpDzS-rw@mail.gmail.com>
Message-ID: <CAMKgpObsv=ODpORbXnaOmKw48mTbkCXVRT98HazNOGhtZ7HJhQ@mail.gmail.com>

Try qgis to display the raster and the vector output. It shows the raster
pixels as rectangular areas. To confirm that there is no shift, compare
their extents using gdalinfo and ogrinfo.
 On 20 Aug 2014 07:56, "John Twilley" <mathuin at gmail.com> wrote:

> The program is not shifting the pixels, but the program does assume
> the pixels to be points and not rectangular areas so maybe I will have
> to shift the pixels.  Do you know what transformation I would need to
> use?
>
> Jack.
> --
> mathuin at gmail dot com
>
>
> On Tue, Aug 19, 2014 at 7:17 PM, Chaitanya kumar CH
> <chaitanya.ch at gmail.com> wrote:
> > Jack,
> > The GDALPolygonize algorithm draws the polygon edges along the pixel
> edges.
> > It assumes the pixels to be rectangular areas instead of points.
> > In the example you described, the first polygon should contain four
> vertices
> > with the pixel in the centre.
> > Make sure that the program you are using to display them is not shifting
> the
> > pixels.
> >
> > On 20 Aug 2014 07:12, "John Twilley" <mathuin at gmail.com> wrote:
> >>
> >> I am trying to use GDAL's polygonize algorithms to help me identify
> >> regions in landcover data.  I made a trivial example, but I am having
> >> trouble understanding the results that I get, nor can I determine how
> >> to get the results I want.
> >>
> >> Given the following raster:
> >>
> >> 11 11 11 11 11
> >> 11 11 11 11 11
> >> 11 11 12 11 11
> >> 11 11 11 11 11
> >> 11 11 11 11 11
> >> 11 11 11 11 11
> >>
> >> If I were to polygonize this raster, I would expect two polygons:  one
> >> which contains the single point 12, and another with an outer ring was
> >> the perimeter of the raster and an inner ring circling the single
> >> point 12.  I would also expect that the first polygon would contain
> >> the single point 12 and that the second polygon would contain all the
> >> points 11.
> >>
> >> Instead, what I got was a polygon starting from the single point 12
> >> and extending down and to the right one pixel, and another polygon
> >> with an outer ring that went off the down and right edges and an inner
> >> ring equal to the first polygon's outer ring.  The first polygon
> >> doesn't actually contain any points and the second one doesn't contain
> >> any points on either ring but does contain all the other points.
> >>
> >> What do I need to do to get the results I am expecting?
> >>
> >> Jack.
> >> --
> >> mathuin at gmail dot com
> >> _______________________________________________
> >> gdal-dev mailing list
> >> gdal-dev at lists.osgeo.org
> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140820/f97d29fe/attachment-0001.html>

From lucena_ivan at hotmail.com  Tue Aug 19 22:00:40 2014
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Wed, 20 Aug 2014 01:00:40 -0400
Subject: [gdal-dev] RFC 15: Band Masks vs #5621
Message-ID: <BLU173-W1847EB55D6060A0FE47B8790D20@phx.gbl>

That question is probably for Even, Frank or some the developer of drivers that support mask band.

I am working on ticket #5621 and trying to adapt it to the RFC 15 but I am not quite sure that I am getting it right.

In GeoRaster, I can have a bitmap mask band that can be applied to all bands, similar to the concept of GMF_PER_DATASET, I guess. I can also have one bitmap mask band per raster band, but that does not correspond to the others mask flags (GMF_ALL_VALID, GMF_ALHA, GMF_NO_DATA). The data type of my bitmap mask is 1 bit, and there is no implicit connection with Alpha Channel or No Data in a binary bitmap mask, of course.

So if I have a dataset with just one bitmap mask shared between all the bands, I think I can return the flag GMF_PER_DATASET and promote the values to GDT_BYTE. But if I have bitmap masks for each raster bands, then I don't know what flag to return. I might just lie and say "GMF_PER_DATASET" and when the mask is requested I will take care of returning the correct one.

Would that works for others drivers participating on gdal_translate/CreateCopy()?

Of course, if the output driver support just one mask per dataset, there is nothing much we can do.

By the way, are there any driver that support overviews of mask band?

Regards,

Ivan
 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140820/45d4bb81/attachment.html>

From Martin.Lewis at euro.ngc.com  Tue Aug 19 23:56:42 2014
From: Martin.Lewis at euro.ngc.com (Lewis, Martin (ISE))
Date: Wed, 20 Aug 2014 07:56:42 +0100
Subject: [gdal-dev] Warping Issues
Message-ID: <E9A25199A28D5A4CACEF052BBBC2DE7E0CF3AB00A5@SHIUK-XMB03>

I seem to be having a few warping problems using OGRCoordinateTransformation as the warped images do not appear to have the correct co-ordinates.
To establish what was going on I have come across a curious issue that may indicate the problems that I am having.

On a separate machine I have QGIS 2.4.0 installed as I use this for verification as it also uses GDAL.

I took a MrSID file (NAD83) and warped it in QGIS to a GeoTiff (WGS84).

This worked successfully and produces a proper square tile with the correct co-ordinates.
I then copied the command line that QGIS gives you shown below:

gdalwarp -overwrite -t_srs EPSG:4326 -of GTiff E:/Stuff/Maps/georgiaville_se.sid E:/Stuff/Maps/testGDAL.tif

and ran this on the development machine (where I have noticed the gdal issues) in a command prompt  using 'pure' gdal.
This did not give any errors and a tif file was generated.

However when this tif  from  the 'pure gdal'  was viewed, it was skewed with black borders and about 3 degrees in the longitude out and smaller error in the latitude. (These are the exact same errors that OGRCoordinateTransform gives)

I then did a gdalinfo on both the generated tiff files and noticed these differences:

>From the QGIS generated file:

Files: C:\Stuff\MrSID\Georgiaville_SE\testQGIS2.tif
Size is 6133, 6131
Origin = (-71.562566138751492,41.937520670986764)
Pixel Size = (0.000010201993468,-0.000010201993468)

>From the gdal generated file:

Files: C:\Stuff\MrSID\Georgiaville_SE\testGDAL.tif
Size is 6331, 6217
Origin = (-74.311201444644681,41.904608529793123)
Pixel Size = (0.000010289425691,-0.000010289425691)
(There were other differences in the Upper Left etc but these are the key diffs. The Coordinate System is exactly the same)

What is going on? Why the differences between the two? What am I doing wrong?
I have recently upgraded to gdal 1.11.0 and proj4 4.8.0. All the env variables etc are setup e.g. GDAL_DATA, PROJ_LIB and point to the correct directories so I must have missed something else?

Hope somebody can help.

Thanks



________________________________
*****CONFIDENTIALITY NOTICE*****

This electronic message transmission contains information which may be confidential. If you are not the intended recipient, be aware that any disclosure, copying, distribution or other use of the content of this information is prohibited. If you have received this communication in error, please notify the sender immediately by email and delete the original message.

Northrop Grumman UK Limited is company registered in England with No. 05989428, Registered Office: 2nd Floor, Clareville House, 26-27 Oxendon Street, London SW1Y 4EL.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140820/1af2a1a3/attachment.html>

From even.rouault at spatialys.com  Wed Aug 20 01:28:14 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 20 Aug 2014 10:28:14 +0200
Subject: [gdal-dev] RFC 15: Band Masks vs #5621
In-Reply-To: <BLU173-W1847EB55D6060A0FE47B8790D20@phx.gbl>
References: <BLU173-W1847EB55D6060A0FE47B8790D20@phx.gbl>
Message-ID: <1408523294.53f45c1e5ce99@imp.free.fr>

Ivan,

You can declare a mask flag to 0 to indicate that this is a per-band mask band.
This is perfectly legal.
You might decide either to set NBITS=1 as metadata to that mask band, or promote
it to full 8 bit (0->0, 1->255).
As far as which format natively supports that, I can't think to any. However the
generic handling in an external .msk file should be able to deal with that, so
hopefully CreateCopy() will generate a .msk file. FYI, as far as internal mask
is concerned, the TIFF specification only allows per-dataset masks (we support
in reading an extension to per-band masks, but we don't generate that)
The generic overview computation code should also be able to generate overviews
of mask band.
You can also play with VRT that should support per-dataset or per-band mask
band.
And you can have a look at autotest/gcore/mask.py to have a sense of what is
supported.

Even

> That question is probably for Even, Frank or some the developer of drivers
> that support mask band.
>
> I am working on ticket #5621 and trying to adapt it to the RFC 15 but I am
> not quite sure that I am getting it right.
>
> In GeoRaster, I can have a bitmap mask band that can be applied to all bands,
> similar to the concept of GMF_PER_DATASET, I guess. I can also have one
> bitmap mask band per raster band, but that does not correspond to the others
> mask flags (GMF_ALL_VALID, GMF_ALHA, GMF_NO_DATA). The data type of my bitmap
> mask is 1 bit, and there is no implicit connection with Alpha Channel or No
> Data in a binary bitmap mask, of course.
>
> So if I have a dataset with just one bitmap mask shared between all the
> bands, I think I can return the flag GMF_PER_DATASET and promote the values
> to GDT_BYTE. But if I have bitmap masks for each raster bands, then I don't
> know what flag to return. I might just lie and say "GMF_PER_DATASET" and when
> the mask is requested I will take care of returning the correct one.
>
> Would that works for others drivers participating on
> gdal_translate/CreateCopy()?
>
> Of course, if the output driver support just one mask per dataset, there is
> nothing much we can do.
>
> By the way, are there any driver that support overviews of mask band?
>
> Regards,
>
> Ivan
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Aug 20 01:31:17 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 20 Aug 2014 10:31:17 +0200
Subject: [gdal-dev] Warping Issues
In-Reply-To: <E9A25199A28D5A4CACEF052BBBC2DE7E0CF3AB00A5@SHIUK-XMB03>
References: <E9A25199A28D5A4CACEF052BBBC2DE7E0CF3AB00A5@SHIUK-XMB03>
Message-ID: <1408523477.53f45cd5160a4@imp.free.fr>

Martin,

Could you paste the output of gdalinfo on the .sid file on both environments,
and each time indicate what 'gdalinfo --version' reports ? It might be possible
that the issue is at the source rather than at the warping.

Even

> I seem to be having a few warping problems using OGRCoordinateTransformation
> as the warped images do not appear to have the correct co-ordinates.
> To establish what was going on I have come across a curious issue that may
> indicate the problems that I am having.
>
> On a separate machine I have QGIS 2.4.0 installed as I use this for
> verification as it also uses GDAL.
>
> I took a MrSID file (NAD83) and warped it in QGIS to a GeoTiff (WGS84).
>
> This worked successfully and produces a proper square tile with the correct
> co-ordinates.
> I then copied the command line that QGIS gives you shown below:
>
> gdalwarp -overwrite -t_srs EPSG:4326 -of GTiff
> E:/Stuff/Maps/georgiaville_se.sid E:/Stuff/Maps/testGDAL.tif
>
> and ran this on the development machine (where I have noticed the gdal
> issues) in a command prompt  using 'pure' gdal.
> This did not give any errors and a tif file was generated.
>
> However when this tif  from  the 'pure gdal'  was viewed, it was skewed with
> black borders and about 3 degrees in the longitude out and smaller error in
> the latitude. (These are the exact same errors that OGRCoordinateTransform
> gives)
>
> I then did a gdalinfo on both the generated tiff files and noticed these
> differences:
>
> From the QGIS generated file:
>
> Files: C:\Stuff\MrSID\Georgiaville_SE\testQGIS2.tif
> Size is 6133, 6131
> Origin = (-71.562566138751492,41.937520670986764)
> Pixel Size = (0.000010201993468,-0.000010201993468)
>
> From the gdal generated file:
>
> Files: C:\Stuff\MrSID\Georgiaville_SE\testGDAL.tif
> Size is 6331, 6217
> Origin = (-74.311201444644681,41.904608529793123)
> Pixel Size = (0.000010289425691,-0.000010289425691)
> (There were other differences in the Upper Left etc but these are the key
> diffs. The Coordinate System is exactly the same)
>
> What is going on? Why the differences between the two? What am I doing wrong?
> I have recently upgraded to gdal 1.11.0 and proj4 4.8.0. All the env
> variables etc are setup e.g. GDAL_DATA, PROJ_LIB and point to the correct
> directories so I must have missed something else?
>
> Hope somebody can help.
>
> Thanks
>
>
>
> ________________________________
> *****CONFIDENTIALITY NOTICE*****
>
> This electronic message transmission contains information which may be
> confidential. If you are not the intended recipient, be aware that any
> disclosure, copying, distribution or other use of the content of this
> information is prohibited. If you have received this communication in error,
> please notify the sender immediately by email and delete the original
> message.
>
> Northrop Grumman UK Limited is company registered in England with No.
> 05989428, Registered Office: 2nd Floor, Clareville House, 26-27 Oxendon
> Street, London SW1Y 4EL.
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From Martin.Lewis at euro.ngc.com  Wed Aug 20 03:05:24 2014
From: Martin.Lewis at euro.ngc.com (M Lewis)
Date: Wed, 20 Aug 2014 03:05:24 -0700 (PDT)
Subject: [gdal-dev] Warping Issues
In-Reply-To: <1408523477.53f45cd5160a4@imp.free.fr>
References: <E9A25199A28D5A4CACEF052BBBC2DE7E0CF3AB00A5@SHIUK-XMB03>
	<1408523477.53f45cd5160a4@imp.free.fr>
Message-ID: <1408529124681-5157277.post@n6.nabble.com>

Thanks for the quick reply Evan.

I have done what you asked and it gets a bit strange.
I ran gdalinfo from the QGIS bin directory and then on the alternate machine
ran gdalinfo from the 'pure gdal' bin directory on the same sid file.
There are some differences in the output particularly around the definition
if the PROJCS and in particular the definition of the 'false_easting'. 
The decoded Corner Coordinates are also different probably due to this
'false_easting' discrepency.
Still at a loss to understand the difference between the QGIS GDAL version
and the built gdal on the other machine. 
Is it a bad build?
Wrong Proj4 datasets?
Or just an issue with GDAL/MrSID integration that QGIS seems to have
overcome? (If they have overcome it then it would be nice to have an
indication of how)

Output from QGIS gdal info
-----------------------------------------------------------------------
Driver: MrSID/Multi-resolution Seamless Image Database (MrSID)
Files: E:\Stuff\Maps\georgiaville_se.sid
Size is 5189, 6945
Coordinate System is:
*PROJCS["NAD83 / Rhode Island",*
    GEOGCS["NAD83",
        DATUM["North_American_Datum_1983",
            SPHEROID["GRS 1980",6378137,298.2572221010002,
                AUTHORITY["EPSG","7019"]],
            AUTHORITY["EPSG","6269"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4269"]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",41.08333333333334],
    PARAMETER["central_meridian",-71.5],
    PARAMETER["scale_factor",0.99999375],
*    PARAMETER["false_easting",328083.3333333333],*
    PARAMETER["false_northing",0],
*    UNIT["US survey foot",0.3048006096012192,
        AUTHORITY["EPSG","9003"]]]*
Origin = (311060.109583333310000,311248.359216666660000)
Pixel Size = (3.280833333333334,-3.280833333333334)
Metadata:
  GEOTIFF_CHAR__GTModelTypeGeoKey=ModelTypeProjected
  GEOTIFF_CHAR__GTRasterTypeGeoKey=RasterPixelIsArea
  GEOTIFF_CHAR__ProjectedCSTypeGeoKey=PCS_NAD83_Rhode_Island
  GEOTIFF_CHAR__ProjLinearUnitsGeoKey=Linear_Foot_US_Survey
  GEOTIFF_NUM__1024__GTModelTypeGeoKey=1
  GEOTIFF_NUM__1025__GTRasterTypeGeoKey=1
  GEOTIFF_NUM__1026__GTCitationGeoKey=IMAGINE GeoTIFF Support
Copyright 1991 - 2001 by ERDAS, Inc. All Rights Reserved
@(#)$RCSfile: egtf.c $ $Revision: 1.10.1.6 $ $Date: 2003/10/17 16:36:51EDT $
Projection Name = State Plane
Units = feet
GeoTIFF Units = feet
  GEOTIFF_NUM__3072__ProjectedCSTypeGeoKey=32130
  GEOTIFF_NUM__3073__PCSCitationGeoKey=IMAGINE GeoTIFF Support
Copyright 1991 - 2001 by ERDAS, Inc. All Rights Reserved
@(#)$RCSfile: egtf.c $ $Revision: 1.10.1.6 $ $Date: 2003/10/17 16:36:51EDT $
State Plane Zone -3800
NAD = 83
  GEOTIFF_NUM__3076__ProjLinearUnitsGeoKey=9003
  IMAGE__COMPRESSION_BLOCK_SIZE=512
  IMAGE__COMPRESSION_GAMMA=2.000000
  IMAGE__COMPRESSION_NLEV=7
  IMAGE__COMPRESSION_VERSION=2,0,0
  IMAGE__COMPRESSION_WEIGHT=2.000000
  IMAGE__CREATION_DATE=Mon Feb 07 13:53:36 2005

  IMAGE__INPUT_FILE_SIZE=108169367.000000
  IMAGE__INPUT_FORMAT=GeoTIFF
  IMAGE__INPUT_NAME=E:\Aerials\USDA\TIFS\4107104_se.tif
  IMAGE__TARGET_COMPRESSION_RATIO=25.000000
  VERSION=MG2
Image Structure Metadata:
  INTERLEAVE=PIXEL
Corner Coordinates:
*Upper Left  (  311060.110,  311248.359) ( 71d33'45.24"W, 41d56'15.01"N)
Lower Left  (  311060.110,  288462.972) ( 71d33'45.02"W, 41d52'29.91"N)
Upper Right (  328084.354,  311248.359) ( 71d29'59.99"W, 41d56'15.07"N)
Lower Right (  328084.354,  288462.972) ( 71d29'59.99"W, 41d52'29.97"N)
Center      (  319572.232,  299855.665) ( 71d31'52.56"W, 41d54'22.51"N)*
Band 1 Block=1024x128 Type=Byte, ColorInterp=Red
  Minimum=23.000, Maximum=253.000, Mean=76.340, StdDev=27.247
  Overviews: 2595x3473, 1298x1737, 649x869, 325x435, 163x218, 82x109, 41x55
Band 2 Block=1024x128 Type=Byte, ColorInterp=Green
  Minimum=36.000, Maximum=254.000, Mean=92.388, StdDev=23.622
  Overviews: 2595x3473, 1298x1737, 649x869, 325x435, 163x218, 82x109, 41x55
Band 3 Block=1024x128 Type=Byte, ColorInterp=Blue
  Minimum=46.000, Maximum=254.000, Mean=82.477, StdDev=21.573
  Overviews: 2595x3473, 1298x1737, 649x869, 325x435, 163x218, 82x109, 41x55




Output from 'pure gdal' gdalinfo
------------------------------------------------------------------------
Driver: MrSID/Multi-resolution Seamless Image Database (MrSID)
Files: C:\Stuff\MrSid\Georgiaville_SE\georgiaville_se.sid
Size is 5189, 6945
Coordinate System is:
*PROJCS["State Plane",*
    GEOGCS["NAD83",
        DATUM["North_American_Datum_1983",
            SPHEROID["GRS 1980",6378137,298.2572221010002,
                AUTHORITY["EPSG","7019"]],
            AUTHORITY["EPSG","6269"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4269"]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",41.08333333333334],
    PARAMETER["central_meridian",-71.5],
    PARAMETER["scale_factor",0.99999375],
*    PARAMETER["false_easting",1076386.736111111],*
    PARAMETER["false_northing",0],
*    UNIT["feet",0.3048006096012192]]*
Origin = (311060.109583333310000,311248.359216666660000)
Pixel Size = (3.280833333333334,-3.280833333333334)
Metadata:
  GEOTIFF_CHAR__GTModelTypeGeoKey=ModelTypeProjected
  GEOTIFF_CHAR__GTRasterTypeGeoKey=RasterPixelIsArea
  GEOTIFF_CHAR__ProjectedCSTypeGeoKey=PCS_NAD83_Rhode_Island
  GEOTIFF_CHAR__ProjLinearUnitsGeoKey=Linear_Foot_US_Survey
  GEOTIFF_NUM__1024__GTModelTypeGeoKey=1
  GEOTIFF_NUM__1025__GTRasterTypeGeoKey=1
  GEOTIFF_NUM__1026__GTCitationGeoKey=IMAGINE GeoTIFF Support
Copyright 1991 - 2001 by ERDAS, Inc. All Rights Reserved
@(#)$RCSfile: egtf.c $ $Revision: 1.10.1.6 $ $Date: 2003/10/17 16:36:51EDT $
Projection Name = State Plane
Units = feet
GeoTIFF Units = feet
  GEOTIFF_NUM__3072__ProjectedCSTypeGeoKey=32130
  GEOTIFF_NUM__3073__PCSCitationGeoKey=IMAGINE GeoTIFF Support
Copyright 1991 - 2001 by ERDAS, Inc. All Rights Reserved
@(#)$RCSfile: egtf.c $ $Revision: 1.10.1.6 $ $Date: 2003/10/17 16:36:51EDT $
State Plane Zone -3800
NAD = 83
  GEOTIFF_NUM__3076__ProjLinearUnitsGeoKey=9003
  IMAGE__COMPRESSION_BLOCK_SIZE=512
  IMAGE__COMPRESSION_GAMMA=2.000000
  IMAGE__COMPRESSION_NLEV=7
  IMAGE__COMPRESSION_VERSION=2,0,0
  IMAGE__COMPRESSION_WEIGHT=2.000000
  IMAGE__CREATION_DATE=Mon Feb 07 13:53:36 2005

  IMAGE__INPUT_FILE_SIZE=108169367.000000
  IMAGE__INPUT_FORMAT=GeoTIFF
  IMAGE__INPUT_NAME=E:\Aerials\USDA\TIFS\4107104_se.tif
  IMAGE__TARGET_COMPRESSION_RATIO=25.000000
  VERSION=MG2
Image Structure Metadata:
  INTERLEAVE=PIXEL
Corner Coordinates:
*Upper Left  (  311060.110,  311248.359) ( 74d18'40.33"W, 41d54'11.14"N)
Lower Left  (  311060.110,  288462.972) ( 74d18'30.47"W, 41d50'26.31"N)
Upper Right (  328084.354,  311248.359) ( 74d14'55.46"W, 41d54'16.59"N)
Lower Right (  328084.354,  288462.972) ( 74d14'45.82"W, 41d50'31.75"N)
Center      (  319572.232,  299855.665) ( 74d16'43.02"W, 41d52'21.46"N)*
Band 1 Block=1024x128 Type=Byte, ColorInterp=Red
  Minimum=23.000, Maximum=253.000, Mean=76.340, StdDev=27.247
  Overviews: 2595x3473, 1298x1737, 649x869, 325x435, 163x218, 82x109, 41x55
Band 2 Block=1024x128 Type=Byte, ColorInterp=Green
  Minimum=36.000, Maximum=254.000, Mean=92.388, StdDev=23.622
  Overviews: 2595x3473, 1298x1737, 649x869, 325x435, 163x218, 82x109, 41x55
Band 3 Block=1024x128 Type=Byte, ColorInterp=Blue
  Minimum=46.000, Maximum=254.000, Mean=82.477, StdDev=21.573
  Overviews: 2595x3473, 1298x1737, 649x869, 325x435, 163x218, 82x109, 41x55




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Re-Warping-Issues-tp5157231p5157277.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From Martin.Lewis at euro.ngc.com  Wed Aug 20 03:08:16 2014
From: Martin.Lewis at euro.ngc.com (M Lewis)
Date: Wed, 20 Aug 2014 03:08:16 -0700 (PDT)
Subject: [gdal-dev] Warping Issues
In-Reply-To: <1408529124681-5157277.post@n6.nabble.com>
References: <E9A25199A28D5A4CACEF052BBBC2DE7E0CF3AB00A5@SHIUK-XMB03>
	<1408523477.53f45cd5160a4@imp.free.fr>
	<1408529124681-5157277.post@n6.nabble.com>
Message-ID: <1408529296114-5157278.post@n6.nabble.com>

Sorry Evan

Forgot the version dump

QGIS
-------
GDAL 1.11.0, released 2014/04/16


Built GDAL
-----------
GDAL 1.11.0, released 2014/04/16

Seems to be the same?



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Re-Warping-Issues-tp5157231p5157278.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Wed Aug 20 03:43:21 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 20 Aug 2014 12:43:21 +0200
Subject: [gdal-dev] Warping Issues
In-Reply-To: <1408529124681-5157277.post@n6.nabble.com>
References: <E9A25199A28D5A4CACEF052BBBC2DE7E0CF3AB00A5@SHIUK-XMB03>
	<1408523477.53f45cd5160a4@imp.free.fr>
	<1408529124681-5157277.post@n6.nabble.com>
Message-ID: <1408531401.53f47bc945b6d@imp.free.fr>

Martin,

The difference is likely due to a different version of the MrSID SDK used to
compile the GDAL MrSID plugin/driver. According to the version of the SDK, a
different method is used to decode the projection information. I guess that the
one that leads to buggy result is the one that borrows code from the GeoTIFF
driver, that is also known to have an issue with non-meter linear units (as
discussed just yesterday in
http://lists.osgeo.org/pipermail/gdal-dev/2014-August/039827.html).

Even

> Thanks for the quick reply Evan.
>
> I have done what you asked and it gets a bit strange.
> I ran gdalinfo from the QGIS bin directory and then on the alternate machine
> ran gdalinfo from the 'pure gdal' bin directory on the same sid file.
> There are some differences in the output particularly around the definition
> if the PROJCS and in particular the definition of the 'false_easting'.
> The decoded Corner Coordinates are also different probably due to this
> 'false_easting' discrepency.
> Still at a loss to understand the difference between the QGIS GDAL version
> and the built gdal on the other machine.
> Is it a bad build?
> Wrong Proj4 datasets?
> Or just an issue with GDAL/MrSID integration that QGIS seems to have
> overcome? (If they have overcome it then it would be nice to have an
> indication of how)
>
> Output from QGIS gdal info
> -----------------------------------------------------------------------
> Driver: MrSID/Multi-resolution Seamless Image Database (MrSID)
> Files: E:\Stuff\Maps\georgiaville_se.sid
> Size is 5189, 6945
> Coordinate System is:
> *PROJCS["NAD83 / Rhode Island",*
>     GEOGCS["NAD83",
>         DATUM["North_American_Datum_1983",
>             SPHEROID["GRS 1980",6378137,298.2572221010002,
>                 AUTHORITY["EPSG","7019"]],
>             AUTHORITY["EPSG","6269"]],
>         PRIMEM["Greenwich",0],
>         UNIT["degree",0.0174532925199433],
>         AUTHORITY["EPSG","4269"]],
>     PROJECTION["Transverse_Mercator"],
>     PARAMETER["latitude_of_origin",41.08333333333334],
>     PARAMETER["central_meridian",-71.5],
>     PARAMETER["scale_factor",0.99999375],
> *    PARAMETER["false_easting",328083.3333333333],*
>     PARAMETER["false_northing",0],
> *    UNIT["US survey foot",0.3048006096012192,
>         AUTHORITY["EPSG","9003"]]]*
> Origin = (311060.109583333310000,311248.359216666660000)
> Pixel Size = (3.280833333333334,-3.280833333333334)
> Metadata:
>   GEOTIFF_CHAR__GTModelTypeGeoKey=ModelTypeProjected
>   GEOTIFF_CHAR__GTRasterTypeGeoKey=RasterPixelIsArea
>   GEOTIFF_CHAR__ProjectedCSTypeGeoKey=PCS_NAD83_Rhode_Island
>   GEOTIFF_CHAR__ProjLinearUnitsGeoKey=Linear_Foot_US_Survey
>   GEOTIFF_NUM__1024__GTModelTypeGeoKey=1
>   GEOTIFF_NUM__1025__GTRasterTypeGeoKey=1
>   GEOTIFF_NUM__1026__GTCitationGeoKey=IMAGINE GeoTIFF Support
> Copyright 1991 - 2001 by ERDAS, Inc. All Rights Reserved
> @(#)$RCSfile: egtf.c $ $Revision: 1.10.1.6 $ $Date: 2003/10/17 16:36:51EDT $
> Projection Name = State Plane
> Units = feet
> GeoTIFF Units = feet
>   GEOTIFF_NUM__3072__ProjectedCSTypeGeoKey=32130
>   GEOTIFF_NUM__3073__PCSCitationGeoKey=IMAGINE GeoTIFF Support
> Copyright 1991 - 2001 by ERDAS, Inc. All Rights Reserved
> @(#)$RCSfile: egtf.c $ $Revision: 1.10.1.6 $ $Date: 2003/10/17 16:36:51EDT $
> State Plane Zone -3800
> NAD = 83
>   GEOTIFF_NUM__3076__ProjLinearUnitsGeoKey=9003
>   IMAGE__COMPRESSION_BLOCK_SIZE=512
>   IMAGE__COMPRESSION_GAMMA=2.000000
>   IMAGE__COMPRESSION_NLEV=7
>   IMAGE__COMPRESSION_VERSION=2,0,0
>   IMAGE__COMPRESSION_WEIGHT=2.000000
>   IMAGE__CREATION_DATE=Mon Feb 07 13:53:36 2005
>
>   IMAGE__INPUT_FILE_SIZE=108169367.000000
>   IMAGE__INPUT_FORMAT=GeoTIFF
>   IMAGE__INPUT_NAME=E:\Aerials\USDA\TIFS\4107104_se.tif
>   IMAGE__TARGET_COMPRESSION_RATIO=25.000000
>   VERSION=MG2
> Image Structure Metadata:
>   INTERLEAVE=PIXEL
> Corner Coordinates:
> *Upper Left  (  311060.110,  311248.359) ( 71d33'45.24"W, 41d56'15.01"N)
> Lower Left  (  311060.110,  288462.972) ( 71d33'45.02"W, 41d52'29.91"N)
> Upper Right (  328084.354,  311248.359) ( 71d29'59.99"W, 41d56'15.07"N)
> Lower Right (  328084.354,  288462.972) ( 71d29'59.99"W, 41d52'29.97"N)
> Center      (  319572.232,  299855.665) ( 71d31'52.56"W, 41d54'22.51"N)*
> Band 1 Block=1024x128 Type=Byte, ColorInterp=Red
>   Minimum=23.000, Maximum=253.000, Mean=76.340, StdDev=27.247
>   Overviews: 2595x3473, 1298x1737, 649x869, 325x435, 163x218, 82x109, 41x55
> Band 2 Block=1024x128 Type=Byte, ColorInterp=Green
>   Minimum=36.000, Maximum=254.000, Mean=92.388, StdDev=23.622
>   Overviews: 2595x3473, 1298x1737, 649x869, 325x435, 163x218, 82x109, 41x55
> Band 3 Block=1024x128 Type=Byte, ColorInterp=Blue
>   Minimum=46.000, Maximum=254.000, Mean=82.477, StdDev=21.573
>   Overviews: 2595x3473, 1298x1737, 649x869, 325x435, 163x218, 82x109, 41x55
>
>
>
>
> Output from 'pure gdal' gdalinfo
> ------------------------------------------------------------------------
> Driver: MrSID/Multi-resolution Seamless Image Database (MrSID)
> Files: C:\Stuff\MrSid\Georgiaville_SE\georgiaville_se.sid
> Size is 5189, 6945
> Coordinate System is:
> *PROJCS["State Plane",*
>     GEOGCS["NAD83",
>         DATUM["North_American_Datum_1983",
>             SPHEROID["GRS 1980",6378137,298.2572221010002,
>                 AUTHORITY["EPSG","7019"]],
>             AUTHORITY["EPSG","6269"]],
>         PRIMEM["Greenwich",0],
>         UNIT["degree",0.0174532925199433],
>         AUTHORITY["EPSG","4269"]],
>     PROJECTION["Transverse_Mercator"],
>     PARAMETER["latitude_of_origin",41.08333333333334],
>     PARAMETER["central_meridian",-71.5],
>     PARAMETER["scale_factor",0.99999375],
> *    PARAMETER["false_easting",1076386.736111111],*
>     PARAMETER["false_northing",0],
> *    UNIT["feet",0.3048006096012192]]*
> Origin = (311060.109583333310000,311248.359216666660000)
> Pixel Size = (3.280833333333334,-3.280833333333334)
> Metadata:
>   GEOTIFF_CHAR__GTModelTypeGeoKey=ModelTypeProjected
>   GEOTIFF_CHAR__GTRasterTypeGeoKey=RasterPixelIsArea
>   GEOTIFF_CHAR__ProjectedCSTypeGeoKey=PCS_NAD83_Rhode_Island
>   GEOTIFF_CHAR__ProjLinearUnitsGeoKey=Linear_Foot_US_Survey
>   GEOTIFF_NUM__1024__GTModelTypeGeoKey=1
>   GEOTIFF_NUM__1025__GTRasterTypeGeoKey=1
>   GEOTIFF_NUM__1026__GTCitationGeoKey=IMAGINE GeoTIFF Support
> Copyright 1991 - 2001 by ERDAS, Inc. All Rights Reserved
> @(#)$RCSfile: egtf.c $ $Revision: 1.10.1.6 $ $Date: 2003/10/17 16:36:51EDT $
> Projection Name = State Plane
> Units = feet
> GeoTIFF Units = feet
>   GEOTIFF_NUM__3072__ProjectedCSTypeGeoKey=32130
>   GEOTIFF_NUM__3073__PCSCitationGeoKey=IMAGINE GeoTIFF Support
> Copyright 1991 - 2001 by ERDAS, Inc. All Rights Reserved
> @(#)$RCSfile: egtf.c $ $Revision: 1.10.1.6 $ $Date: 2003/10/17 16:36:51EDT $
> State Plane Zone -3800
> NAD = 83
>   GEOTIFF_NUM__3076__ProjLinearUnitsGeoKey=9003
>   IMAGE__COMPRESSION_BLOCK_SIZE=512
>   IMAGE__COMPRESSION_GAMMA=2.000000
>   IMAGE__COMPRESSION_NLEV=7
>   IMAGE__COMPRESSION_VERSION=2,0,0
>   IMAGE__COMPRESSION_WEIGHT=2.000000
>   IMAGE__CREATION_DATE=Mon Feb 07 13:53:36 2005
>
>   IMAGE__INPUT_FILE_SIZE=108169367.000000
>   IMAGE__INPUT_FORMAT=GeoTIFF
>   IMAGE__INPUT_NAME=E:\Aerials\USDA\TIFS\4107104_se.tif
>   IMAGE__TARGET_COMPRESSION_RATIO=25.000000
>   VERSION=MG2
> Image Structure Metadata:
>   INTERLEAVE=PIXEL
> Corner Coordinates:
> *Upper Left  (  311060.110,  311248.359) ( 74d18'40.33"W, 41d54'11.14"N)
> Lower Left  (  311060.110,  288462.972) ( 74d18'30.47"W, 41d50'26.31"N)
> Upper Right (  328084.354,  311248.359) ( 74d14'55.46"W, 41d54'16.59"N)
> Lower Right (  328084.354,  288462.972) ( 74d14'45.82"W, 41d50'31.75"N)
> Center      (  319572.232,  299855.665) ( 74d16'43.02"W, 41d52'21.46"N)*
> Band 1 Block=1024x128 Type=Byte, ColorInterp=Red
>   Minimum=23.000, Maximum=253.000, Mean=76.340, StdDev=27.247
>   Overviews: 2595x3473, 1298x1737, 649x869, 325x435, 163x218, 82x109, 41x55
> Band 2 Block=1024x128 Type=Byte, ColorInterp=Green
>   Minimum=36.000, Maximum=254.000, Mean=92.388, StdDev=23.622
>   Overviews: 2595x3473, 1298x1737, 649x869, 325x435, 163x218, 82x109, 41x55
> Band 3 Block=1024x128 Type=Byte, ColorInterp=Blue
>   Minimum=46.000, Maximum=254.000, Mean=82.477, StdDev=21.573
>   Overviews: 2595x3473, 1298x1737, 649x869, 325x435, 163x218, 82x109, 41x55
>
>
>
>
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/Re-Warping-Issues-tp5157231p5157277.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From Martin.Lewis at euro.ngc.com  Wed Aug 20 05:06:54 2014
From: Martin.Lewis at euro.ngc.com (M Lewis)
Date: Wed, 20 Aug 2014 05:06:54 -0700 (PDT)
Subject: [gdal-dev] Warping Issues
In-Reply-To: <1408531401.53f47bc945b6d@imp.free.fr>
References: <E9A25199A28D5A4CACEF052BBBC2DE7E0CF3AB00A5@SHIUK-XMB03>
	<1408523477.53f45cd5160a4@imp.free.fr>
	<1408529124681-5157277.post@n6.nabble.com>
	<1408531401.53f47bc945b6d@imp.free.fr>
Message-ID: <1408536414797-5157317.post@n6.nabble.com>

Thanks Evan but I am not quite sure I understand.

Are you saying that QGIS uses gdal built with a different MrSID SDK?

I have built GDAL using this version, MrSID_DSDK-9.0.0.3864-win32-vc11 from
LizardTech, which I think is the latest.
If it is then I am sure that QGIS will be using the same, in which case I
still can't see why they are producing different results?


Thanks

Martin




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Re-Warping-Issues-tp5157231p5157317.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From mathuin at gmail.com  Wed Aug 20 09:05:20 2014
From: mathuin at gmail.com (John Twilley)
Date: Wed, 20 Aug 2014 09:05:20 -0700
Subject: [gdal-dev] Questions about polygonization
In-Reply-To: <CAMKgpObsv=ODpORbXnaOmKw48mTbkCXVRT98HazNOGhtZ7HJhQ@mail.gmail.com>
References: <CAEUMa-f2z4NqFwi+RdsaaT0p2ds5t3VW7ubviLncQH3ms1A_Rw@mail.gmail.com>
	<CAMKgpObkEmsmX9YY2itkX6uNs941j08-gBT=iS0Pyt8W0vDvyg@mail.gmail.com>
	<CAEUMa-em-0YBzA=qNDQVqi_bDmWTUQA5N3sB8JkJcqtpDzS-rw@mail.gmail.com>
	<CAMKgpObsv=ODpORbXnaOmKw48mTbkCXVRT98HazNOGhtZ7HJhQ@mail.gmail.com>
Message-ID: <CAEUMa-d6L6998z+OZarYxm8KpV4MYccp6PDMjQiTUT+YR3i7Vg@mail.gmail.com>

Using qgis helped me see what you are saying.  The raster pixels are
being treated as rectangular areas but the actual coordinates are the
*corners* of those areas.  Modifying my code to offset the coordinates
by 0.5 causes the Contains test (and others) to produce results that
meet my expectations.

The really frustrating thing is that I think I had to learn this
already at least once over the past decade or so I've been tinkering
with GDAL.  I can't find a particularly embarrassing post in the
archives, but I'm confident it's there. :-)

Thank you for your patience.
--
mathuin at gmail dot com


On Tue, Aug 19, 2014 at 7:32 PM, Chaitanya kumar CH
<chaitanya.ch at gmail.com> wrote:
> Try qgis to display the raster and the vector output. It shows the raster
> pixels as rectangular areas. To confirm that there is no shift, compare
> their extents using gdalinfo and ogrinfo.
>
> On 20 Aug 2014 07:56, "John Twilley" <mathuin at gmail.com> wrote:
>>
>> The program is not shifting the pixels, but the program does assume
>> the pixels to be points and not rectangular areas so maybe I will have
>> to shift the pixels.  Do you know what transformation I would need to
>> use?
>>
>> Jack.
>> --
>> mathuin at gmail dot com
>>
>>
>> On Tue, Aug 19, 2014 at 7:17 PM, Chaitanya kumar CH
>> <chaitanya.ch at gmail.com> wrote:
>> > Jack,
>> > The GDALPolygonize algorithm draws the polygon edges along the pixel
>> > edges.
>> > It assumes the pixels to be rectangular areas instead of points.
>> > In the example you described, the first polygon should contain four
>> > vertices
>> > with the pixel in the centre.
>> > Make sure that the program you are using to display them is not shifting
>> > the
>> > pixels.
>> >
>> > On 20 Aug 2014 07:12, "John Twilley" <mathuin at gmail.com> wrote:
>> >>
>> >> I am trying to use GDAL's polygonize algorithms to help me identify
>> >> regions in landcover data.  I made a trivial example, but I am having
>> >> trouble understanding the results that I get, nor can I determine how
>> >> to get the results I want.
>> >>
>> >> Given the following raster:
>> >>
>> >> 11 11 11 11 11
>> >> 11 11 11 11 11
>> >> 11 11 12 11 11
>> >> 11 11 11 11 11
>> >> 11 11 11 11 11
>> >> 11 11 11 11 11
>> >>
>> >> If I were to polygonize this raster, I would expect two polygons:  one
>> >> which contains the single point 12, and another with an outer ring was
>> >> the perimeter of the raster and an inner ring circling the single
>> >> point 12.  I would also expect that the first polygon would contain
>> >> the single point 12 and that the second polygon would contain all the
>> >> points 11.
>> >>
>> >> Instead, what I got was a polygon starting from the single point 12
>> >> and extending down and to the right one pixel, and another polygon
>> >> with an outer ring that went off the down and right edges and an inner
>> >> ring equal to the first polygon's outer ring.  The first polygon
>> >> doesn't actually contain any points and the second one doesn't contain
>> >> any points on either ring but does contain all the other points.
>> >>
>> >> What do I need to do to get the results I am expecting?
>> >>
>> >> Jack.
>> >> --
>> >> mathuin at gmail dot com
>> >> _______________________________________________
>> >> gdal-dev mailing list
>> >> gdal-dev at lists.osgeo.org
>> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From lucena_ivan at hotmail.com  Wed Aug 20 10:45:27 2014
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Wed, 20 Aug 2014 13:45:27 -0400
Subject: [gdal-dev] RFC 15: Band Masks vs #5621
In-Reply-To: <1408523294.53f45c1e5ce99@imp.free.fr>
References: <BLU173-W1847EB55D6060A0FE47B8790D20@phx.gbl>,
	<1408523294.53f45c1e5ce99@imp.free.fr>
Message-ID: <BLU173-W13C3BB4B4F50F31C93FAFF90D20@phx.gbl>

Even,
> Date: Wed, 20 Aug 2014 10:28:14 +0200
> From: even.rouault at spatialys.com
> To: lucena_ivan at hotmail.com
> CC: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] RFC 15: Band Masks vs #5621
> 
> Ivan,
> 
> You can declare a mask flag to 0 to indicate that this is a per-band mask band.
> This is perfectly legal.

OK. That should works.

Back in 1.6 when I developed that code I think the idea was a little bit different. We tried to support just what GeoTiff would support. I will try that approach. 

> You might decide either to set NBITS=1 as metadata to that mask band, or promote
> it to full 8 bit (0->0, 1->255).
> As far as which format natively supports that, I can't think to any. However the
> generic handling in an external .msk file should be able to deal with that, so
> hopefully CreateCopy() will generate a .msk file. FYI, as far as internal mask
> is concerned, the TIFF specification only allows per-dataset masks (we support
> in reading an extension to per-band masks, but we don't generate that)
> The generic overview computation code should also be able to generate overviews
> of mask band.
> You can also play with VRT that should support per-dataset or per-band mask
> band.

I am trying to help a developer how wants to use VRTs as an intermediary between a GeoRaster and a PNG, in order to produce thumbnails. In that case, does the VRT needs to describe the mask band so that the PNG's driver will received the filtered image, with the zeroes regions masked out?

Well, I guess that is something to be tested.

Thanks,

Ivan

> And you can have a look at autotest/gcore/mask.py to have a sense of what is
> supported.

I will check that.

> 
> Even
> 
> > That question is probably for Even, Frank or some the developer of drivers
> > that support mask band.
> >
> > I am working on ticket #5621 and trying to adapt it to the RFC 15 but I am
> > not quite sure that I am getting it right.
> >
> > In GeoRaster, I can have a bitmap mask band that can be applied to all bands,
> > similar to the concept of GMF_PER_DATASET, I guess. I can also have one
> > bitmap mask band per raster band, but that does not correspond to the others
> > mask flags (GMF_ALL_VALID, GMF_ALHA, GMF_NO_DATA). The data type of my bitmap
> > mask is 1 bit, and there is no implicit connection with Alpha Channel or No
> > Data in a binary bitmap mask, of course.
> >
> > So if I have a dataset with just one bitmap mask shared between all the
> > bands, I think I can return the flag GMF_PER_DATASET and promote the values
> > to GDT_BYTE. But if I have bitmap masks for each raster bands, then I don't
> > know what flag to return. I might just lie and say "GMF_PER_DATASET" and when
> > the mask is requested I will take care of returning the correct one.
> >
> > Would that works for others drivers participating on
> > gdal_translate/CreateCopy()?
> >
> > Of course, if the output driver support just one mask per dataset, there is
> > nothing much we can do.
> >
> > By the way, are there any driver that support overviews of mask band?
> >
> > Regards,
> >
> > Ivan
> >
> 
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com
 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140820/aaa5bc25/attachment.html>

From even.rouault at spatialys.com  Wed Aug 20 11:39:29 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 20 Aug 2014 20:39:29 +0200
Subject: [gdal-dev] RFC 15: Band Masks vs #5621
In-Reply-To: <BLU173-W13C3BB4B4F50F31C93FAFF90D20@phx.gbl>
References: <BLU173-W1847EB55D6060A0FE47B8790D20@phx.gbl>
	<1408523294.53f45c1e5ce99@imp.free.fr>
	<BLU173-W13C3BB4B4F50F31C93FAFF90D20@phx.gbl>
Message-ID: <201408202039.29163.even.rouault@spatialys.com>

> 
> I am trying to help a developer how wants to use VRTs as an intermediary
> between a GeoRaster and a PNG, in order to produce thumbnails. In that
> case, does the VRT needs to describe the mask band so that the PNG's
> driver will received the filtered image, with the zeroes regions masked
> out?

You need to explicitely declare mask bands in the VRT. See the VRT 
documentation for that. But that will just declare the existence of the mask 
band, and will not do any processing such as zeroing masked regions.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Aug 20 13:02:35 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 20 Aug 2014 22:02:35 +0200
Subject: [gdal-dev] Adding a "Commercial support" section on gdal.org ?
Message-ID: <201408202202.36022.even.rouault@spatialys.com>

Hi,

I'm wondering if there would be a concensus and interest to add a "Commercial 
support" section on gdal.org. A number of OSGeo projects have such page (see 
[1]), so that wouldn't be completely awkward to have one for GDAL as well.

The OSGeo Service provider database reference 137 companies/individuals that 
have registered themselves as providing GDAL support ([2]) ! Pretty cool, but 
I'm wondering how a user not familiar with the project could effectively use 
that list to identify core contributors from casual advanced users.

If we agree for adding a "Commercial support" section, the question is : on 
which criteria do we accept an organization/individual to be listed in the 
section ? We would want them to be as most objective and non debatable as 
possible.
A simple criterion could be anyone who has commit rights (in trunk, not just 
in a sandbox or customer branch). There are currently 56 SVN committers. That 
could be strengthened with a minimum number of commits/lines changed during a 
period, but we perhaps don't need that level of complexity. 
We could possibly also extend that to entities that provide public support to 
users through gdal-dev or other public forums (gis.stackexchange, others?).
Other suggestions ?

Should we distinguish several categories of actors ?
- QGIS makes a division between "Core contributors" vs "Contributors". 
GeoServer has "Core contributors", "Experienced providers" and "Additional 
services" (the last one is populated on service provider request).
- On the other side, deegree, Geomoose or Geotools simply list them in a 
single section.
The answer likely depends on the number of organizations that would be listed 
(I guess below 10 we don't need much structure). The difficulty here would be to 
establish the categories and criteria.

So, could entities interested in being listed reply to this email so we can 
have a better idea of how many would be listed, and if we need more stricter 
criteria or several categories ?
As far as I'm concerned, Spatialys would be interested.

Best regards,

Even

[1] Non exhaustive list of OSGeo projects with a commercial support section :
http://geoserver.org/support/
http://www.geomoose.org/info/commercial_support.html
http://docs.geotools.org/latest/userguide/welcome/support.html
http://wiki.deegree.org/deegreeWiki/GettingSupport
http://qgis.org/en/site/forusers/commercial_support.html

[2] OSGeo Service Provider catalog with entities declaring GDAL expertise :
http://www.osgeo.org/search_profile?SET=1&MUL_TECH[]=00013

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Aug 20 13:26:35 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 20 Aug 2014 22:26:35 +0200
Subject: [gdal-dev] RFC 47 and Threading
In-Reply-To: <CAPxHBh9szm_RmMhNMgTTQFTjc_x=dAndVFPvFXzK+F6nn0nXfg@mail.gmail.com>
References: <CAPxHBh9szm_RmMhNMgTTQFTjc_x=dAndVFPvFXzK+F6nn0nXfg@mail.gmail.com>
Message-ID: <201408202226.36037.even.rouault@spatialys.com>

Hi,

I guess the silence in thread is due to people being impressed by the 
austerity of the topic...

For what is worth, I've had a few opportunities to discuss directly with Blake 
about his work. I'm very impressed with his energy and enthousiasm to hack in 
that difficult core area of GDAL, and his understanding of the current code base 
! But I must confess I'm concerned by the amount of changes and the difficulty 
to ensure their correctness. Especially with three different mutexes...

I'm not sure the ratio gain/effort to make dataset methods "a bit more" thread 
safe is high enough. Very few drivers can be made fully thread-safe, and fully 
parallelized (i.e. without a big mutex). Basically all file-based drivers or 
database-based drivers cannot. The former ones because the file handle cannot 
be used simultaneously by different threads. The latter ones for the same 
reason with the database connection handles. So basically that would just 
address the case of the MEM driver (which is an important use case for Blake). 
And in that instance, it would already be possible to use several MEM dataset 
handles that would point to the same memory buffer (and with a tiny per-dataset 
cache size since it is not really needed for a fast datasource such as MEM)

On the other side, I would be very pleased with having "just" the preliminary 
step of Blake's work, i.e. the possibility to choose a per-band block cache 
strategy instead of the global block cache. That should already address most 
scaling issues.

Even


> I wanted to call to everyone's attention the work I have been doing in an
> attempt to make it possible for more portions of GDAL to be thread safe and
> improve speed in multi-threaded environments. I have put a RFC up here:
> 
> http://trac.osgeo.org/gdal/wiki/rfc47_dataset_caching
> 
> Originally my work focused on simply changing the way the LRU cache
> operated, but I ended up doing more in an attempt to make it much more
> efficient while still being thread safe.
> 
> Being that this is a core part of GDAL, I wanted to get everyone's
> thoughts/questions/concerns on the different ways I have gone about
> attempting to solve this problem.
> 
> Thanks,
> 
> Blake

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From szekerest at gmail.com  Wed Aug 20 13:51:55 2014
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed, 20 Aug 2014 22:51:55 +0200
Subject: [gdal-dev] Adding a "Commercial support" section on gdal.org ?
In-Reply-To: <201408202202.36022.even.rouault@spatialys.com>
References: <201408202202.36022.even.rouault@spatialys.com>
Message-ID: <CACALY+TDeW6VvXX-m+a8BM76BfYEKdyCHttOKVng2gMWc=xjAQ@mail.gmail.com>

Even,

I suspect most companies providing commercial support for GDAL are related
to one or more committers, so it might be reasonable to let the committers
to propose a company to be listed (by describing the support they can
provide) and probably call for a vote on it. (just my 2 cents)

Best regards,

Tamas



2014-08-20 22:02 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:

> Hi,
>
> I'm wondering if there would be a concensus and interest to add a
> "Commercial
> support" section on gdal.org. A number of OSGeo projects have such page
> (see
> [1]), so that wouldn't be completely awkward to have one for GDAL as well.
>
> The OSGeo Service provider database reference 137 companies/individuals
> that
> have registered themselves as providing GDAL support ([2]) ! Pretty cool,
> but
> I'm wondering how a user not familiar with the project could effectively
> use
> that list to identify core contributors from casual advanced users.
>
> If we agree for adding a "Commercial support" section, the question is : on
> which criteria do we accept an organization/individual to be listed in the
> section ? We would want them to be as most objective and non debatable as
> possible.
> A simple criterion could be anyone who has commit rights (in trunk, not
> just
> in a sandbox or customer branch). There are currently 56 SVN committers.
> That
> could be strengthened with a minimum number of commits/lines changed
> during a
> period, but we perhaps don't need that level of complexity.
> We could possibly also extend that to entities that provide public support
> to
> users through gdal-dev or other public forums (gis.stackexchange, others?).
> Other suggestions ?
>
> Should we distinguish several categories of actors ?
> - QGIS makes a division between "Core contributors" vs "Contributors".
> GeoServer has "Core contributors", "Experienced providers" and "Additional
> services" (the last one is populated on service provider request).
> - On the other side, deegree, Geomoose or Geotools simply list them in a
> single section.
> The answer likely depends on the number of organizations that would be
> listed
> (I guess below 10 we don't need much structure). The difficulty here would
> be to
> establish the categories and criteria.
>
> So, could entities interested in being listed reply to this email so we can
> have a better idea of how many would be listed, and if we need more
> stricter
> criteria or several categories ?
> As far as I'm concerned, Spatialys would be interested.
>
> Best regards,
>
> Even
>
> [1] Non exhaustive list of OSGeo projects with a commercial support
> section :
> http://geoserver.org/support/
> http://www.geomoose.org/info/commercial_support.html
> http://docs.geotools.org/latest/userguide/welcome/support.html
> http://wiki.deegree.org/deegreeWiki/GettingSupport
> http://qgis.org/en/site/forusers/commercial_support.html
>
> [2] OSGeo Service Provider catalog with entities declaring GDAL expertise :
> http://www.osgeo.org/search_profile?SET=1&MUL_TECH[]=00013
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140820/d6cdbe8f/attachment.html>

From flippmoke at gmail.com  Wed Aug 20 14:59:44 2014
From: flippmoke at gmail.com (Blake Thompson)
Date: Wed, 20 Aug 2014 16:59:44 -0500
Subject: [gdal-dev] RFC 47 and Threading
In-Reply-To: <201408202226.36037.even.rouault@spatialys.com>
References: <CAPxHBh9szm_RmMhNMgTTQFTjc_x=dAndVFPvFXzK+F6nn0nXfg@mail.gmail.com>
	<201408202226.36037.even.rouault@spatialys.com>
Message-ID: <CAPxHBh9181d_bakm2AksQ7j5C44QzVAuRK+p5QjCJh-s=6Xy3w@mail.gmail.com>

Even,

Thank you very much for response to this, your helping me understand all of
this stuff has been very valuable.

I'm not sure the ratio gain/effort to make dataset methods "a bit more"
> thread
> safe is high enough. Very few drivers can be made fully thread-safe, and
> fully
> parallelized (i.e. without a big mutex). Basically all file-based drivers
> or
> database-based drivers cannot. The former ones because the file handle
> cannot
> be used simultaneously by different threads. The latter ones for the same
> reason with the database connection handles. So basically that would just
> address the case of the MEM driver (which is an important use case for
> Blake).
> And in that instance, it would already be possible to use several MEM
> dataset
> handles that would point to the same memory buffer (and with a tiny
> per-dataset
> cache size since it is not really needed for a fast datasource such as MEM)
>

I sadly agree with that still most of the drivers will not be thread-safe
however, I don't see any way of getting away from this problem with out
some big changes to the way the core library utilizes data provided by the
driver (particularly the cache). This is partially why the changes are so
vast. However, I want to state that once a dataset is loaded into the cache
via the driver it can be effectively and quickly used in a multi-threaded
way. This would be ideal for many situations where the cache is large
enough, especially with the changes for a "per dataset block cache". Take
for example where you are attempting to cut many small datasets from a
single large shared dataset. If the block cache was not thrashing, the
single large shared dataset could easily be utilized in multiple threads
with great performance increases once all data in it was loaded into the
cache. Perhaps I would be better off stating that this change does it best
to make the cache very quick and safe in threading.


> On the other side, I would be very pleased with having "just" the
> preliminary
> step of Blake's work, i.e. the possibility to choose a per-band block cache
> strategy instead of the global block cache. That should already address
> most
> scaling issues.
>

First off wanted to state that it attempts to be a per dataset block cache,
not a per band block cache, and only after setting a global configuration
value. Its not a huge difference, but is something worth noting.

I know that you are concerned about there being three different mutexes,
however, during testing of some different datasets, I was trying to put
some value on the potential speed increases provided by multi-threading.
Simply put larger scope mutexes provide much more locking and don't provide
much improvements in performacne. The three mutexes were specifically
placed to protect different sets of data and for the locking to take place
only when these areas were at risk of corruption.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140820/0fd4db2b/attachment.html>

From flippmoke at gmail.com  Wed Aug 20 15:04:14 2014
From: flippmoke at gmail.com (Blake Thompson)
Date: Wed, 20 Aug 2014 17:04:14 -0500
Subject: [gdal-dev] Adding a "Commercial support" section on gdal.org ?
In-Reply-To: <CACALY+TDeW6VvXX-m+a8BM76BfYEKdyCHttOKVng2gMWc=xjAQ@mail.gmail.com>
References: <201408202202.36022.even.rouault@spatialys.com>
	<CACALY+TDeW6VvXX-m+a8BM76BfYEKdyCHttOKVng2gMWc=xjAQ@mail.gmail.com>
Message-ID: <CAPxHBh9w_T1O60kmS6mSFDCyUXB84EjQ8172av4W6rN=yX-CdQ@mail.gmail.com>

Even,

I am not yet a commiter on SVN, but I agree with Tamas that allowing any
commiters would be a great. I personally think listing supporting companies
with an opensource project is a great way to build more support and trust
in the project.

Thanks,

Blake


On Wed, Aug 20, 2014 at 3:51 PM, Tamas Szekeres <szekerest at gmail.com> wrote:

> Even,
>
> I suspect most companies providing commercial support for GDAL are related
> to one or more committers, so it might be reasonable to let the committers
> to propose a company to be listed (by describing the support they can
> provide) and probably call for a vote on it. (just my 2 cents)
>
> Best regards,
>
> Tamas
>
>
>
> 2014-08-20 22:02 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
>
> Hi,
>>
>> I'm wondering if there would be a concensus and interest to add a
>> "Commercial
>> support" section on gdal.org. A number of OSGeo projects have such page
>> (see
>> [1]), so that wouldn't be completely awkward to have one for GDAL as well.
>>
>> The OSGeo Service provider database reference 137 companies/individuals
>> that
>> have registered themselves as providing GDAL support ([2]) ! Pretty cool,
>> but
>> I'm wondering how a user not familiar with the project could effectively
>> use
>> that list to identify core contributors from casual advanced users.
>>
>> If we agree for adding a "Commercial support" section, the question is :
>> on
>> which criteria do we accept an organization/individual to be listed in the
>> section ? We would want them to be as most objective and non debatable as
>> possible.
>> A simple criterion could be anyone who has commit rights (in trunk, not
>> just
>> in a sandbox or customer branch). There are currently 56 SVN committers.
>> That
>> could be strengthened with a minimum number of commits/lines changed
>> during a
>> period, but we perhaps don't need that level of complexity.
>> We could possibly also extend that to entities that provide public
>> support to
>> users through gdal-dev or other public forums (gis.stackexchange,
>> others?).
>> Other suggestions ?
>>
>> Should we distinguish several categories of actors ?
>> - QGIS makes a division between "Core contributors" vs "Contributors".
>> GeoServer has "Core contributors", "Experienced providers" and "Additional
>> services" (the last one is populated on service provider request).
>> - On the other side, deegree, Geomoose or Geotools simply list them in a
>> single section.
>> The answer likely depends on the number of organizations that would be
>> listed
>> (I guess below 10 we don't need much structure). The difficulty here
>> would be to
>> establish the categories and criteria.
>>
>> So, could entities interested in being listed reply to this email so we
>> can
>> have a better idea of how many would be listed, and if we need more
>> stricter
>> criteria or several categories ?
>> As far as I'm concerned, Spatialys would be interested.
>>
>> Best regards,
>>
>> Even
>>
>> [1] Non exhaustive list of OSGeo projects with a commercial support
>> section :
>> http://geoserver.org/support/
>> http://www.geomoose.org/info/commercial_support.html
>> http://docs.geotools.org/latest/userguide/welcome/support.html
>> http://wiki.deegree.org/deegreeWiki/GettingSupport
>> http://qgis.org/en/site/forusers/commercial_support.html
>>
>> [2] OSGeo Service Provider catalog with entities declaring GDAL expertise
>> :
>> http://www.osgeo.org/search_profile?SET=1&MUL_TECH[]=00013
>>
>> --
>> Spatialys - Geospatial professional services
>> http://www.spatialys.com
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140820/e58efec5/attachment-0001.html>

From nicu.tofan at gmail.com  Wed Aug 20 17:26:19 2014
From: nicu.tofan at gmail.com (Nicu Tofan)
Date: Thu, 21 Aug 2014 03:26:19 +0300
Subject: [gdal-dev] Warping and creating tiles using C++
Message-ID: <CAGFYcD8w_iF2sFCWtfHHmYFfMdyj4Tnv8dd6-10SJAoQLt4Qpw@mail.gmail.com>

Hello,

I'm working on an application with requirements described below. Please
have a look at what I came up with so far and tell me if I'm on an awfully
wrong path.

Requirements
============

Application takes as input a number of image files +/- geo-referenced
Input may have different resolutions, SRS, bands
The user can alter projection and geo-reference parameters
Output consists of tiles resulting from all those images;
The arrangement of the tiles can be customized (the way tiles are arranged
and named)

gdalbuildvrt, gdalwarp and gdal2tiles.py indicate that these requirements
can be satisfied by gdal.


Implementation
==============

   - for each input dataset create a virtual dataset using
   GDALAutoCreateWarpedVRT(); this takes into consideration the changes
   made by the user and target SRS
   - follow the steps in gdalbuildvrt (CreateVRTNonSeparate) to generate a
   single virtual file; this involves GDALProxyPoolDatasetCreate,
   VRTAddSimpleSource (is there a simpler way?)
   - create base layer tiles from virtual dataset; use
   GDALDataset::RasterIO()
   - create tiles higher in the pyramid (gdal2tiles.py) from existing ones

Any advice / idea / pointers to higher level functions that do some of the
work is highly appreciated.


Thanks,

Nick
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140821/f01c5471/attachment.html>

From lukepinnerau at gmail.com  Wed Aug 20 22:55:23 2014
From: lukepinnerau at gmail.com (Luke)
Date: Wed, 20 Aug 2014 22:55:23 -0700 (PDT)
Subject: [gdal-dev] Issues building ECW/JP2ECW driver as a plugin on
 Ubuntu
In-Reply-To: <CAE8LFTzNCp_Tk8DijL9z=_vGeZ=hDL0S_-=vXrby6x26mB7prw@mail.gmail.com>
References: <CAE8LFTzNCp_Tk8DijL9z=_vGeZ=hDL0S_-=vXrby6x26mB7prw@mail.gmail.com>
Message-ID: <1408600523172-5157505.post@n6.nabble.com>

I cross-posted to the UbuntuGIS mailing list
(http://article.gmane.org/gmane.comp.gis.osgeo.ubuntu/941), but have had no
response.

Are there any other drivers in the GDAL tree that support being built as
plugins in a linux environment that I could have a look at and try and base
a patch on?


Regards
Luke



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Issues-building-ECW-JP2ECW-driver-as-a-plugin-on-Ubuntu-tp5156322p5157505.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From hanlie.pretorius at gmail.com  Wed Aug 20 23:57:32 2014
From: hanlie.pretorius at gmail.com (Hanlie Pretorius)
Date: Thu, 21 Aug 2014 08:57:32 +0200
Subject: [gdal-dev] GDAL translate 16 bit to 8 bit
Message-ID: <CAFpCUPp+G+5NGF0rC1z2bOwcNEYDb4OY=C7jaA-Lxw5QP2jSXA@mail.gmail.com>

Hi,

I'm working with a 16 bit SPOT 6 image that I want to convert from 16
bit pixel depth to 8 bit pixel depth. I say 16 bit, but if I load the
file into Envi, it reports that uses only 12 bits. However gdalinfo
reports 16 bit (see below).

I've manage to do so on the multispectral image, but the result is
poor colour wise.

So I split the image into its four bands that is, I now have one image per band.

When I now try to convert to 8 bit, I get a message that says:
"Warning 742327101_R1C1_band1_8bit.TIF not created".

The command I'm using is:
gdal_translate -ot Byte -of GTiff "D:/SPOT
6/EightBit/IMG_SPOT6_MS_201304290812030_ORT_742327101_R1C1_band1.TIF"
742327101_R1C1_band1_8bit.TIF

gdalinfo for the original MS image gives the following result:
Driver: GTiff/GeoTIFF
Files: D:/SPOT 6/SANSA_SouthAfr_246_SO13012989_43_DS_SPOT6_201304290812030_FR1_FR1_SE1_SE1_E021S32_03414/PROD_SPOT6_001/VOL_SPOT6_001_A/IMG_SPOT6_MS_001_A/IMG_SPOT6_MS_201304290812030_ORT_742327101_R1C1.TIF
       D:/SPOT 6/SANSA_SouthAfr_246_SO13012989_43_DS_SPOT6_201304290812030_FR1_FR1_SE1_SE1_E021S32_03414/PROD_SPOT6_001/VOL_SPOT6_001_A/IMG_SPOT6_MS_001_A/IMG_SPOT6_MS_201304290812030_ORT_742327101_R1C1.tif.ovr
       D:/SPOT 6/SANSA_SouthAfr_246_SO13012989_43_DS_SPOT6_201304290812030_FR1_FR1_SE1_SE1_E021S32_03414/PROD_SPOT6_001/VOL_SPOT6_001_A/IMG_SPOT6_MS_001_A/IMG_SPOT6_MS_201304290812030_ORT_742327101_R1C1.TFW
       D:/SPOT 6/SANSA_SouthAfr_246_SO13012989_43_DS_SPOT6_201304290812030_FR1_FR1_SE1_SE1_E021S32_03414/PROD_SPOT6_001/VOL_SPOT6_001_A/IMG_SPOT6_MS_001_A/IMG_SPOT6_MS_201304290812030_ORT_742327101_R1C1.TIF.aux.xml
Size is 7680, 7680
Coordinate System is:
PROJCS["WGS 84 / UTM zone 34S",
    GEOGCS["WGS 84",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.257223563,
                AUTHORITY["EPSG","7030"]],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4326"]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",21],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",10000000],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AUTHORITY["EPSG","32734"]]
Origin = (426894.000000000000000,6421830.000000000000000)
Pixel Size = (6.000000000000000,-6.000000000000000)
Metadata:
  AREA_OR_POINT=Area
  TIFFTAG_DATETIME=2013:12:05 14:23:06
  TIFFTAG_IMAGEDESCRIPTION=B2, B1, B0, B3
  TIFFTAG_XRESOLUTION=6
  TIFFTAG_YRESOLUTION=6
Image Structure Metadata:
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (  426894.000, 6421830.000) ( 20d13'23.42"E, 32d20'16.91"S)
Lower Left  (  426894.000, 6375750.000) ( 20d13'10.50"E, 32d45'13.25"S)
Upper Right (  472974.000, 6421830.000) ( 20d42'46.12"E, 32d20'24.35"S)
Lower Right (  472974.000, 6375750.000) ( 20d42'41.34"E, 32d45'20.81"S)
Center      (  449934.000, 6398790.000) ( 20d28' 0.35"E, 32d32'49.70"S)
Band 1 Block=7680x128 Type=UInt16, ColorInterp=Red
  Min=0.000 Max=2768.000
  Minimum=0.000, Maximum=2768.000, Mean=254.357, StdDev=82.827
  Overviews: 3840x3840, 1920x1920, 960x960, 480x480, 240x240
  Metadata:
    STATISTICS_COVARIANCES=6860.33555334015,5408.39177012214,3932.59000707709,8359.55872888383
    STATISTICS_MAXIMUM=2768
    STATISTICS_MEAN=254.35743888007
    STATISTICS_MINIMUM=0
    STATISTICS_SKIPFACTORX=1
    STATISTICS_SKIPFACTORY=1
    STATISTICS_STDDEV=82.827142612432
Band 2 Block=7680x128 Type=UInt16, ColorInterp=Green
  Min=0.000 Max=1928.000
  Minimum=0.000, Maximum=1928.000, Mean=272.449, StdDev=67.362
  Overviews: 3840x3840, 1920x1920, 960x960, 480x480, 240x240
  Metadata:
    STATISTICS_COVARIANCES=5408.39177012214,4537.57701249689,3512.4873688442,6910.89114933438
    STATISTICS_MAXIMUM=1928
    STATISTICS_MEAN=272.44932240804
    STATISTICS_MINIMUM=0
    STATISTICS_SKIPFACTORX=1
    STATISTICS_SKIPFACTORY=1
    STATISTICS_STDDEV=67.361539564479
Band 3 Block=7680x128 Type=UInt16, ColorInterp=Blue
  Min=0.000 Max=2264.000
  Minimum=0.000, Maximum=2264.000, Mean=291.925, StdDev=54.875
  Overviews: 3840x3840, 1920x1920, 960x960, 480x480, 240x240
  Metadata:
    STATISTICS_COVARIANCES=3932.59000707709,3512.4873688442,3011.23474438976,5111.02811591707
    STATISTICS_MAXIMUM=2264
    STATISTICS_MEAN=291.92457129584
    STATISTICS_MINIMUM=0
    STATISTICS_SKIPFACTORX=1
    STATISTICS_SKIPFACTORY=1
    STATISTICS_STDDEV=54.874718626976
Band 4 Block=7680x128 Type=UInt16, ColorInterp=Undefined
  Min=0.000 Max=2699.000
  Minimum=0.000, Maximum=2699.000, Mean=374.146, StdDev=115.219
  Overviews: 3840x3840, 1920x1920, 960x960, 480x480, 240x240
  Metadata:
    STATISTICS_COVARIANCES=8359.55872888383,6910.89114933438,5111.02811591707,13275.4755734648
    STATISTICS_MAXIMUM=2699
    STATISTICS_MEAN=374.14637317234
    STATISTICS_MINIMUM=0
    STATISTICS_SKIPFACTORX=1
    STATISTICS_SKIPFACTORY=1
    STATISTICS_STDDEV=115.21925001259

gdalinfo for band 1 of the image that I'm trying to use for the
conversion, gives the following results:
Driver: GTiff/GeoTIFF
Files: D:/SPOT 6/SANSA_SouthAfr_246_SO13012989_43_DS_SPOT6_201304290812030_FR1_FR1_SE1_SE1_E021S32_03414/PROD_SPOT6_001/VOL_SPOT6_001_A/IMG_SPOT6_MS_001_A/IMG_SPOT6_MS_201304290812030_ORT_742327101_R1C1.TIF
       D:/SPOT 6/SANSA_SouthAfr_246_SO13012989_43_DS_SPOT6_201304290812030_FR1_FR1_SE1_SE1_E021S32_03414/PROD_SPOT6_001/VOL_SPOT6_001_A/IMG_SPOT6_MS_001_A/IMG_SPOT6_MS_201304290812030_ORT_742327101_R1C1.tif.ovr
       D:/SPOT 6/SANSA_SouthAfr_246_SO13012989_43_DS_SPOT6_201304290812030_FR1_FR1_SE1_SE1_E021S32_03414/PROD_SPOT6_001/VOL_SPOT6_001_A/IMG_SPOT6_MS_001_A/IMG_SPOT6_MS_201304290812030_ORT_742327101_R1C1.TFW
       D:/SPOT 6/SANSA_SouthAfr_246_SO13012989_43_DS_SPOT6_201304290812030_FR1_FR1_SE1_SE1_E021S32_03414/PROD_SPOT6_001/VOL_SPOT6_001_A/IMG_SPOT6_MS_001_A/IMG_SPOT6_MS_201304290812030_ORT_742327101_R1C1.TIF.aux.xml
Size is 7680, 7680
Coordinate System is:
PROJCS["WGS 84 / UTM zone 34S",
    GEOGCS["WGS 84",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.257223563,
                AUTHORITY["EPSG","7030"]],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4326"]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",21],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",10000000],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AUTHORITY["EPSG","32734"]]
Origin = (426894.000000000000000,6421830.000000000000000)
Pixel Size = (6.000000000000000,-6.000000000000000)
Metadata:
  AREA_OR_POINT=Area
  TIFFTAG_DATETIME=2013:12:05 14:23:06
  TIFFTAG_IMAGEDESCRIPTION=B2, B1, B0, B3
  TIFFTAG_XRESOLUTION=6
  TIFFTAG_YRESOLUTION=6
Image Structure Metadata:
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (  426894.000, 6421830.000) ( 20d13'23.42"E, 32d20'16.91"S)
Lower Left  (  426894.000, 6375750.000) ( 20d13'10.50"E, 32d45'13.25"S)
Upper Right (  472974.000, 6421830.000) ( 20d42'46.12"E, 32d20'24.35"S)
Lower Right (  472974.000, 6375750.000) ( 20d42'41.34"E, 32d45'20.81"S)
Center      (  449934.000, 6398790.000) ( 20d28' 0.35"E, 32d32'49.70"S)
Band 1 Block=7680x128 Type=UInt16, ColorInterp=Red
  Min=0.000 Max=2768.000
  Minimum=0.000, Maximum=2768.000, Mean=254.357, StdDev=82.827
  Overviews: 3840x3840, 1920x1920, 960x960, 480x480, 240x240
  Metadata:
    STATISTICS_COVARIANCES=6860.33555334015,5408.39177012214,3932.59000707709,8359.55872888383
    STATISTICS_MAXIMUM=2768
    STATISTICS_MEAN=254.35743888007
    STATISTICS_MINIMUM=0
    STATISTICS_SKIPFACTORX=1
    STATISTICS_SKIPFACTORY=1
    STATISTICS_STDDEV=82.827142612432
Band 2 Block=7680x128 Type=UInt16, ColorInterp=Green
  Min=0.000 Max=1928.000
  Minimum=0.000, Maximum=1928.000, Mean=272.449, StdDev=67.362
  Overviews: 3840x3840, 1920x1920, 960x960, 480x480, 240x240
  Metadata:
    STATISTICS_COVARIANCES=5408.39177012214,4537.57701249689,3512.4873688442,6910.89114933438
    STATISTICS_MAXIMUM=1928
    STATISTICS_MEAN=272.44932240804
    STATISTICS_MINIMUM=0
    STATISTICS_SKIPFACTORX=1
    STATISTICS_SKIPFACTORY=1
    STATISTICS_STDDEV=67.361539564479
Band 3 Block=7680x128 Type=UInt16, ColorInterp=Blue
  Min=0.000 Max=2264.000
  Minimum=0.000, Maximum=2264.000, Mean=291.925, StdDev=54.875
  Overviews: 3840x3840, 1920x1920, 960x960, 480x480, 240x240
  Metadata:
    STATISTICS_COVARIANCES=3932.59000707709,3512.4873688442,3011.23474438976,5111.02811591707
    STATISTICS_MAXIMUM=2264
    STATISTICS_MEAN=291.92457129584
    STATISTICS_MINIMUM=0
    STATISTICS_SKIPFACTORX=1
    STATISTICS_SKIPFACTORY=1
    STATISTICS_STDDEV=54.874718626976
Band 4 Block=7680x128 Type=UInt16, ColorInterp=Undefined
  Min=0.000 Max=2699.000
  Minimum=0.000, Maximum=2699.000, Mean=374.146, StdDev=115.219
  Overviews: 3840x3840, 1920x1920, 960x960, 480x480, 240x240
  Metadata:
    STATISTICS_COVARIANCES=8359.55872888383,6910.89114933438,5111.02811591707,13275.4755734648
    STATISTICS_MAXIMUM=2699
    STATISTICS_MEAN=374.14637317234
    STATISTICS_MINIMUM=0
    STATISTICS_SKIPFACTORX=1
    STATISTICS_SKIPFACTORY=1
    STATISTICS_STDDEV=115.21925001259


I'm using QGIS 2.2.0 on Windows 8 as a front end to GDAL.

Can anyone perhaps see why the error is occurring or suggest an
alternative workflow?

Thanks
Hanlie

From lucena_ivan at hotmail.com  Thu Aug 21 05:09:17 2014
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Thu, 21 Aug 2014 08:09:17 -0400
Subject: [gdal-dev] RFC 15: Band Masks vs #5621
In-Reply-To: <201408202039.29163.even.rouault@spatialys.com>
References: <BLU173-W1847EB55D6060A0FE47B8790D20@phx.gbl>
	<1408523294.53f45c1e5ce99@imp.free.fr>
	<BLU173-W13C3BB4B4F50F31C93FAFF90D20@phx.gbl>,
	<201408202039.29163.even.rouault@spatialys.com>
Message-ID: <BLU173-W31A61B4372BD437D59604390D30@phx.gbl>

Hi Even,

> From: even.rouault at spatialys.com
> To: lucena_ivan at hotmail.com
> Subject: Re: [gdal-dev] RFC 15: Band Masks vs #5621
> Date: Wed, 20 Aug 2014 20:39:29 +0200
> CC: gdal-dev at lists.osgeo.org
> 
> > 
> > I am trying to help a developer how wants to use VRTs as an intermediary
> > between a GeoRaster and a PNG, in order to produce thumbnails. In that
> > case, does the VRT needs to describe the mask band so that the PNG's
> > driver will received the filtered image, with the zeroes regions masked
> > out?
> 
> You need to explicitely declare mask bands in the VRT. See the VRT 
> documentation for that. But that will just declare the existence of the mask 
> band, and will not do any processing such as zeroing masked regions.

You are right. GDAL can copy the mask from one dataset to another, depending on the driver. 

But there is no way to indicate that you want the result of the masking, not in the API, not on command line tools.

Maybe we should add that to the wish list.

Regards,

Ivan
 

 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140821/58f098d1/attachment.html>

From even.rouault at spatialys.com  Thu Aug 21 05:23:24 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 21 Aug 2014 14:23:24 +0200
Subject: [gdal-dev] RFC 15: Band Masks vs #5621
In-Reply-To: <BLU173-W31A61B4372BD437D59604390D30@phx.gbl>
References: <BLU173-W1847EB55D6060A0FE47B8790D20@phx.gbl>
	<1408523294.53f45c1e5ce99@imp.free.fr>
	<BLU173-W13C3BB4B4F50F31C93FAFF90D20@phx.gbl>,
	<201408202039.29163.even.rouault@spatialys.com>
	<BLU173-W31A61B4372BD437D59604390D30@phx.gbl>
Message-ID: <1408623804.53f5e4bc90101@imp.free.fr>

Selon Ivan Lucena <lucena_ivan at hotmail.com>:

> Hi Even,
>
> > From: even.rouault at spatialys.com
> > To: lucena_ivan at hotmail.com
> > Subject: Re: [gdal-dev] RFC 15: Band Masks vs #5621
> > Date: Wed, 20 Aug 2014 20:39:29 +0200
> > CC: gdal-dev at lists.osgeo.org
> >
> > >
> > > I am trying to help a developer how wants to use VRTs as an intermediary
> > > between a GeoRaster and a PNG, in order to produce thumbnails. In that
> > > case, does the VRT needs to describe the mask band so that the PNG's
> > > driver will received the filtered image, with the zeroes regions masked
> > > out?
> >
> > You need to explicitely declare mask bands in the VRT. See the VRT
> > documentation for that. But that will just declare the existence of the
> mask
> > band, and will not do any processing such as zeroing masked regions.
>
> You are right. GDAL can copy the mask from one dataset to another, depending
> on the driver.
>
> But there is no way to indicate that you want the result of the masking, not
> in the API, not on command line tools.
>
> Maybe we should add that to the wish list.

Eh eh seems there is no limit to the wish list ;-)
More seriously, I can imagine this could be done through a new VRT mechanism,
that could be triggered by a new option of gdal_translate

That would be mostly needed for per-band mask, since for per-dataset mask, you
can already trick the mask to be considered as an alpha band (e.g.
gdal_translate -b 1 -b 2 -b 3 -b mask in.tif out.tif will transform a RGB+mask
into a RGBA dataset).
For per-band mask, the value of the pixels that are masked should also be
specified in the VRT syntax.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From bertelli at charta.acme.com  Thu Aug 21 05:46:35 2014
From: bertelli at charta.acme.com (bertelli at charta.acme.com)
Date: Thu, 21 Aug 2014 14:46:35 +0200
Subject: [gdal-dev] Adding a "Commercial support" section on gdal.org?
Message-ID: <20140821144635.oum3mxjt0g0ocs88@webmail.charta.acme.com>

Charta is interested to be listed as experienced provider if gdal.org  
will ever add info about commercial support.

Nevertheless, I think this item has to receive more attention,  
considering at least:
* the license of GDAL. Using MIT license means being expecially open  
to commercial usage. I don't know if this is really consequential with  
selecting a group of commercial providers instead of being agnostic  
about usage of the code and technology created (I don't agree with  
this, but...);
* usually support means choice between several tools and technologies,  
being a core contributor could mean some bias about recurring to a  
specific tool. Being listed as such could become a double-edged sword;
* any evaluation aobut support should be based on the help provided to  
the user and not about the contribution to the project. The client  
shoud be able to choose if he needs "broad" or "focused" support, if  
he needs new developments or better integration and so on. Listing  
experiences or specialisation (geodatabases, remote sensing and so on)  
could be more useful.

Even's case is noteworthy, because he is more than a "Core  
contributor", but a project leader for GDAL. When his affiliation to  
?cole des Mines changed to his own company, Spatialys, I thought this  
was a very good move because he could more easily provide consulting  
services to commercial entities. Maybe his visibility as a prominent  
person in this community is already warranted, I understand that his  
proposal is addressed to others, but I think gdal-dev is about  
developing, although the list provides a lot of help to users, is this  
the right place?
c

On Thu, Aug 20, 2014 at 10:02:35 PM, Even Rouault wrote:

     Date: Wed, 20 Aug 2014 22:02:35 +0200
     From: Even Rouault <even.rouault at spatialys.com>
     To: "gdal-dev at lists.osgeo.org" <gdal-dev at lists.osgeo.org>
     Subject: [gdal-dev] Adding a "Commercial support" section on gdal.org
             ?
     Message-ID: <201408202202.36022.even.rouault at spatialys.com>
     Content-Type: Text/Plain;  charset="us-ascii"

     Hi,

     I'm wondering if there would be a concensus and interest to add a  
"Commercial
     support" section on gdal.org. A number of OSGeo projects have  
such page (see
     [1]), so that wouldn't be completely awkward to have one for GDAL as well.

     The OSGeo Service provider database reference 137  
companies/individuals that
     have registered themselves as providing GDAL support ([2]) !  
Pretty cool, but
     I'm wondering how a user not familiar with the project could  
effectively use
     that list to identify core contributors from casual advanced users.

     If we agree for adding a "Commercial support" section, the  
question is : on
     which criteria do we accept an organization/individual to be listed in the
     section ? We would want them to be as most objective and non debatable as
     possible.
     A simple criterion could be anyone who has commit rights (in  
trunk, not just
     in a sandbox or customer branch). There are currently 56 SVN  
committers. That
     could be strengthened with a minimum number of commits/lines  
changed during a
     period, but we perhaps don't need that level of complexity.
     We could possibly also extend that to entities that provide  
public support to
     users through gdal-dev or other public forums (gis.stackexchange,  
others?).
     Other suggestions ?

     Should we distinguish several categories of actors ?
     - QGIS makes a division between "Core contributors" vs "Contributors".
     GeoServer has "Core contributors", "Experienced providers" and "Additional
     services" (the last one is populated on service provider request).
     - On the other side, deegree, Geomoose or Geotools simply list them in a
     single section.
     The answer likely depends on the number of organizations that  
would be listed
     (I guess below 10 we don't need much structure). The difficulty  
here would be to
     establish the categories and criteria.

     So, could entities interested in being listed reply to this email  
so we can
     have a better idea of how many would be listed, and if we need  
more stricter
     criteria or several categories ?
     As far as I'm concerned, Spatialys would be interested.

     Best regards,

     Even

     [1] Non exhaustive list of OSGeo projects with a commercial  
support section :
     http://geoserver.org/support/
     http://www.geomoose.org/info/commercial_support.html
     http://docs.geotools.org/latest/userguide/welcome/support.html
     http://wiki.deegree.org/deegreeWiki/GettingSupport
     http://qgis.org/en/site/forusers/commercial_support.html

     [2] OSGeo Service Provider catalog with entities declaring GDAL  
expertise :
     http://www.osgeo.org/search_profile?SET=1&MUL_TECH[]=00013


     --
     Spatialys - Geospatial professional services
     http://www.spatialys.com


-- 
--------------------------------------------------------------------------
Carlo A. Bertelli
    Charta servizi e sistemi per il territorio e la storia ambientale srl
           Dipendenze del palazzo Doria,
           vc. alla Chiesa della Maddalena 9/2 16124      Genova (Italy)
           tel. +39(0)10 2475439  fax +39(0)10 2475439  gsm:+39 393 1590711
--------------------------------------------------------------------------


From andre+joost at nurfuerspam.de  Thu Aug 21 07:23:48 2014
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Thu, 21 Aug 2014 16:23:48 +0200
Subject: [gdal-dev] Issues building ECW/JP2ECW driver as a plugin on
	Ubuntu
In-Reply-To: <1408600523172-5157505.post@n6.nabble.com>
References: <CAE8LFTzNCp_Tk8DijL9z=_vGeZ=hDL0S_-=vXrby6x26mB7prw@mail.gmail.com>
	<1408600523172-5157505.post@n6.nabble.com>
Message-ID: <lt501i$634$1@ger.gmane.org>

Am 21.08.2014 07:55, schrieb Luke:
> I cross-posted to the UbuntuGIS mailing list
> (http://article.gmane.org/gmane.comp.gis.osgeo.ubuntu/941), but have had no
> response.
>

Unfortunately, yes. There seems to be little activity on the list recently.

> Are there any other drivers in the GDAL tree that support being built as
> plugins in a linux environment that I could have a look at and try and base
> a patch on?
>
>

The bin\gdalplugins folder contains GEOR, MG4Lidar, MrSID, FILEGDB, OCI 
and SOSI. I guess your driver should work in a similar way.

I don't have any skills in C coding and compiling, so I can't help you 
on that.

Greetings,
Andr? Joost


From eadam at co.lincoln.or.us  Thu Aug 21 08:37:57 2014
From: eadam at co.lincoln.or.us (Eli Adam)
Date: Thu, 21 Aug 2014 08:37:57 -0700
Subject: [gdal-dev] Adding a "Commercial support" section on gdal.org?
In-Reply-To: <20140821144635.oum3mxjt0g0ocs88@webmail.charta.acme.com>
References: <20140821144635.oum3mxjt0g0ocs88@webmail.charta.acme.com>
Message-ID: <CACqBkM9HMpqwEVidz2rFqWOu1m-8tXGeiu3fwpLygM28U9Jo5w@mail.gmail.com>

Adding a support section like some other OSGeo projects is a good idea (in
my opinion).  This is a way for people to use the project webpage to find
those who are most substantially contributing to the project and know the
most about GDAL/OGR.


On Thu, Aug 21, 2014 at 5:46 AM, <bertelli at charta.acme.com> wrote:

> Charta is interested to be listed as experienced provider if gdal.org
> will ever add info about commercial support.
>
> Nevertheless, I think this item has to receive more attention, considering
> at least:
> * the license of GDAL. Using MIT license means being expecially open to
> commercial usage. I don't know if this is really consequential with
> selecting a group of commercial providers instead of being agnostic about
> usage of the code and technology created (I don't agree with this, but...);
> * usually support means choice between several tools and technologies,
> being a core contributor could mean some bias about recurring to a specific
> tool. Being listed as such could become a double-edged sword;
>

If you are looking for GDAL/OGR support (on the gdal.org web page) you have
already made your technology choice.  If you are looking for support in
selecting a technology you should not be looking on gdal.org but rather
collecting references or otherwise doing research on appropriate support in
whatever domain you're in.  gdal.org is not the the proper place to look
for support on javascript libraries or other non-GDAL/OGR topics.  Someone
may be better off with advice to use something other than GDAL/OGR but
gdal.org is not the place to get that advice (the people and companies
listed there may give that advice if approached but they would best know
what is out of the GDAL/OGR scope).


> * any evaluation aobut support should be based on the help provided to the
> user and not about the contribution to the project. The client shoud be
> able to choose if he needs "broad" or "focused" support, if he needs new
> developments or better integration and so on. Listing experiences or
> specialisation (geodatabases, remote sensing and so on) could be more
> useful.
>

A prudent customer might evaluate support by referrals and reviews based on
help provided to the user but gdal.org is in no place to evaluate that.
gdal.org is certainly in a place to evaluate and recommend those who have a
history of competently contributing to the project (tickets, patches,
commits, emails correctly answered, relevant presentations at FOSS4G, etc).

The OSGeo Service providers directory,
http://www.osgeo.org/search_profile?SET=1&MUL_TECH[0]=00013 already
provides a mechanism for self listing anything the person listing wants.
This remains a valuable resource for researching support options but gives
no indication of who is competently contributing to the project.

The PostGIS support page lists focus area of support,
http://postgis.net/support

Best regards, Eli


>
> Even's case is noteworthy, because he is more than a "Core contributor",
> but a project leader for GDAL. When his affiliation to ?cole des Mines
> changed to his own company, Spatialys, I thought this was a very good move
> because he could more easily provide consulting services to commercial
> entities. Maybe his visibility as a prominent person in this community is
> already warranted, I understand that his proposal is addressed to others,
> but I think gdal-dev is about developing, although the list provides a lot
> of help to users, is this the right place?
>
c
>
> On Thu, Aug 20, 2014 at 10:02:35 PM, Even Rouault wrote:
>
>     Date: Wed, 20 Aug 2014 22:02:35 +0200
>     From: Even Rouault <even.rouault at spatialys.com>
>     To: "gdal-dev at lists.osgeo.org" <gdal-dev at lists.osgeo.org>
>     Subject: [gdal-dev] Adding a "Commercial support" section on gdal.org
>             ?
>     Message-ID: <201408202202.36022.even.rouault at spatialys.com>
>     Content-Type: Text/Plain;  charset="us-ascii"
>
>
>     Hi,
>
>     I'm wondering if there would be a concensus and interest to add a
> "Commercial
>     support" section on gdal.org. A number of OSGeo projects have such
> page (see
>     [1]), so that wouldn't be completely awkward to have one for GDAL as
> well.
>
>     The OSGeo Service provider database reference 137
> companies/individuals that
>     have registered themselves as providing GDAL support ([2]) ! Pretty
> cool, but
>     I'm wondering how a user not familiar with the project could
> effectively use
>     that list to identify core contributors from casual advanced users.
>
>     If we agree for adding a "Commercial support" section, the question is
> : on
>     which criteria do we accept an organization/individual to be listed in
> the
>     section ? We would want them to be as most objective and non debatable
> as
>     possible.
>     A simple criterion could be anyone who has commit rights (in trunk,
> not just
>     in a sandbox or customer branch). There are currently 56 SVN
> committers. That
>     could be strengthened with a minimum number of commits/lines changed
> during a
>     period, but we perhaps don't need that level of complexity.
>     We could possibly also extend that to entities that provide public
> support to
>     users through gdal-dev or other public forums (gis.stackexchange,
> others?).
>     Other suggestions ?
>
>     Should we distinguish several categories of actors ?
>     - QGIS makes a division between "Core contributors" vs "Contributors".
>     GeoServer has "Core contributors", "Experienced providers" and
> "Additional
>     services" (the last one is populated on service provider request).
>     - On the other side, deegree, Geomoose or Geotools simply list them in
> a
>     single section.
>     The answer likely depends on the number of organizations that would be
> listed
>     (I guess below 10 we don't need much structure). The difficulty here
> would be to
>     establish the categories and criteria.
>
>     So, could entities interested in being listed reply to this email so
> we can
>     have a better idea of how many would be listed, and if we need more
> stricter
>     criteria or several categories ?
>     As far as I'm concerned, Spatialys would be interested.
>
>     Best regards,
>
>     Even
>
>     [1] Non exhaustive list of OSGeo projects with a commercial support
> section :
>     http://geoserver.org/support/
>     http://www.geomoose.org/info/commercial_support.html
>     http://docs.geotools.org/latest/userguide/welcome/support.html
>     http://wiki.deegree.org/deegreeWiki/GettingSupport
>     http://qgis.org/en/site/forusers/commercial_support.html
>
>     [2] OSGeo Service Provider catalog with entities declaring GDAL
> expertise :
>     http://www.osgeo.org/search_profile?SET=1&MUL_TECH[]=00013
>
>
>     --
>     Spatialys - Geospatial professional services
>     http://www.spatialys.com
>
>
> --
> --------------------------------------------------------------------------
> Carlo A. Bertelli
>    Charta servizi e sistemi per il territorio e la storia ambientale srl
>           Dipendenze del palazzo Doria,
>           vc. alla Chiesa della Maddalena 9/2 16124      Genova (Italy)
>           tel. +39(0)10 2475439  fax +39(0)10 2475439  gsm:+39 393 1590711
> --------------------------------------------------------------------------
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140821/0877bc09/attachment.html>

From warmerdam at pobox.com  Thu Aug 21 10:02:05 2014
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu, 21 Aug 2014 10:02:05 -0700
Subject: [gdal-dev] Adding a "Commercial support" section on gdal.org?
In-Reply-To: <CACqBkM9HMpqwEVidz2rFqWOu1m-8tXGeiu3fwpLygM28U9Jo5w@mail.gmail.com>
References: <20140821144635.oum3mxjt0g0ocs88@webmail.charta.acme.com>
	<CACqBkM9HMpqwEVidz2rFqWOu1m-8tXGeiu3fwpLygM28U9Jo5w@mail.gmail.com>
Message-ID: <CA+YzLBfnJgP2QGKLRMuuNbAX_9kZrtwVhWvCTzqWn+0XgNDPfw@mail.gmail.com>

Folks,

This is a somewhat sticky area, which is why I started just with just the
self-registration mechanism on the OSGeo site in the past.

A scenario that I could support would be a section somewhat like the
postgis.net support list where being added to it needs to be voted on by
the PSC.  My criteria as a PSC member would be:

 - The organization has made significant contributions to the project (in
code, docs, etc)
 - The organization has staff that I personally know to be competent
GDAL/OGR developers.

It is a slippery sort of thing of course.  Subjective, and I would hate to
be in the situation where I'm having to vote against an addition.

If we were to pursue this I actually think an RFC with an initial list of
entries, and some general principles would be appropriate (though additions
wouldn't need an RFC - just a up/down vote).

My perspective when consulting was that being active on the mailing list,
and noting in my email signature that I was available for consulting was
enough to give me some profile with those looking for someone.

PS. as happy customer of Even's (at Planet Labs) I can strongly endorse him
as a consultant!

Best regards,
Frank



On Thu, Aug 21, 2014 at 8:37 AM, Eli Adam <eadam at co.lincoln.or.us> wrote:

> Adding a support section like some other OSGeo projects is a good idea (in
> my opinion).  This is a way for people to use the project webpage to find
> those who are most substantially contributing to the project and know the
> most about GDAL/OGR.
>
>
> On Thu, Aug 21, 2014 at 5:46 AM, <bertelli at charta.acme.com> wrote:
>
>> Charta is interested to be listed as experienced provider if gdal.org
>> will ever add info about commercial support.
>>
>> Nevertheless, I think this item has to receive more attention,
>> considering at least:
>> * the license of GDAL. Using MIT license means being expecially open to
>> commercial usage. I don't know if this is really consequential with
>> selecting a group of commercial providers instead of being agnostic about
>> usage of the code and technology created (I don't agree with this, but...);
>> * usually support means choice between several tools and technologies,
>> being a core contributor could mean some bias about recurring to a specific
>> tool. Being listed as such could become a double-edged sword;
>>
>
> If you are looking for GDAL/OGR support (on the gdal.org web page) you
> have already made your technology choice.  If you are looking for support
> in selecting a technology you should not be looking on gdal.org but
> rather collecting references or otherwise doing research on appropriate
> support in whatever domain you're in.  gdal.org is not the the proper
> place to look for support on javascript libraries or other non-GDAL/OGR
> topics.  Someone may be better off with advice to use something other than
> GDAL/OGR but gdal.org is not the place to get that advice (the people and
> companies listed there may give that advice if approached but they would
> best know what is out of the GDAL/OGR scope).
>
>
>> * any evaluation aobut support should be based on the help provided to
>> the user and not about the contribution to the project. The client shoud be
>> able to choose if he needs "broad" or "focused" support, if he needs new
>> developments or better integration and so on. Listing experiences or
>> specialisation (geodatabases, remote sensing and so on) could be more
>> useful.
>>
>
> A prudent customer might evaluate support by referrals and reviews based
> on help provided to the user but gdal.org is in no place to evaluate
> that.  gdal.org is certainly in a place to evaluate and recommend those
> who have a history of competently contributing to the project (tickets,
> patches, commits, emails correctly answered, relevant presentations at
> FOSS4G, etc).
>
> The OSGeo Service providers directory,
> http://www.osgeo.org/search_profile?SET=1&MUL_TECH[0]=00013 already
> provides a mechanism for self listing anything the person listing wants.
> This remains a valuable resource for researching support options but gives
> no indication of who is competently contributing to the project.
>
> The PostGIS support page lists focus area of support,
> http://postgis.net/support
>
> Best regards, Eli
>
>
>>
>> Even's case is noteworthy, because he is more than a "Core contributor",
>> but a project leader for GDAL. When his affiliation to ?cole des Mines
>> changed to his own company, Spatialys, I thought this was a very good move
>> because he could more easily provide consulting services to commercial
>> entities. Maybe his visibility as a prominent person in this community is
>> already warranted, I understand that his proposal is addressed to others,
>> but I think gdal-dev is about developing, although the list provides a lot
>> of help to users, is this the right place?
>>
> c
>>
>> On Thu, Aug 20, 2014 at 10:02:35 PM, Even Rouault wrote:
>>
>>     Date: Wed, 20 Aug 2014 22:02:35 +0200
>>     From: Even Rouault <even.rouault at spatialys.com>
>>     To: "gdal-dev at lists.osgeo.org" <gdal-dev at lists.osgeo.org>
>>     Subject: [gdal-dev] Adding a "Commercial support" section on gdal.org
>>             ?
>>     Message-ID: <201408202202.36022.even.rouault at spatialys.com>
>>     Content-Type: Text/Plain;  charset="us-ascii"
>>
>>
>>     Hi,
>>
>>     I'm wondering if there would be a concensus and interest to add a
>> "Commercial
>>     support" section on gdal.org. A number of OSGeo projects have such
>> page (see
>>     [1]), so that wouldn't be completely awkward to have one for GDAL as
>> well.
>>
>>     The OSGeo Service provider database reference 137
>> companies/individuals that
>>     have registered themselves as providing GDAL support ([2]) ! Pretty
>> cool, but
>>     I'm wondering how a user not familiar with the project could
>> effectively use
>>     that list to identify core contributors from casual advanced users.
>>
>>     If we agree for adding a "Commercial support" section, the question
>> is : on
>>     which criteria do we accept an organization/individual to be listed
>> in the
>>     section ? We would want them to be as most objective and non
>> debatable as
>>     possible.
>>     A simple criterion could be anyone who has commit rights (in trunk,
>> not just
>>     in a sandbox or customer branch). There are currently 56 SVN
>> committers. That
>>     could be strengthened with a minimum number of commits/lines changed
>> during a
>>     period, but we perhaps don't need that level of complexity.
>>     We could possibly also extend that to entities that provide public
>> support to
>>     users through gdal-dev or other public forums (gis.stackexchange,
>> others?).
>>     Other suggestions ?
>>
>>     Should we distinguish several categories of actors ?
>>     - QGIS makes a division between "Core contributors" vs "Contributors".
>>     GeoServer has "Core contributors", "Experienced providers" and
>> "Additional
>>     services" (the last one is populated on service provider request).
>>     - On the other side, deegree, Geomoose or Geotools simply list them
>> in a
>>     single section.
>>     The answer likely depends on the number of organizations that would
>> be listed
>>     (I guess below 10 we don't need much structure). The difficulty here
>> would be to
>>     establish the categories and criteria.
>>
>>     So, could entities interested in being listed reply to this email so
>> we can
>>     have a better idea of how many would be listed, and if we need more
>> stricter
>>     criteria or several categories ?
>>     As far as I'm concerned, Spatialys would be interested.
>>
>>     Best regards,
>>
>>     Even
>>
>>     [1] Non exhaustive list of OSGeo projects with a commercial support
>> section :
>>     http://geoserver.org/support/
>>     http://www.geomoose.org/info/commercial_support.html
>>     http://docs.geotools.org/latest/userguide/welcome/support.html
>>     http://wiki.deegree.org/deegreeWiki/GettingSupport
>>     http://qgis.org/en/site/forusers/commercial_support.html
>>
>>     [2] OSGeo Service Provider catalog with entities declaring GDAL
>> expertise :
>>     http://www.osgeo.org/search_profile?SET=1&MUL_TECH[]=00013
>>
>>
>>     --
>>     Spatialys - Geospatial professional services
>>     http://www.spatialys.com
>>
>>
>> --
>> ------------------------------------------------------------
>> --------------
>> Carlo A. Bertelli
>>    Charta servizi e sistemi per il territorio e la storia ambientale srl
>>           Dipendenze del palazzo Doria,
>>           vc. alla Chiesa della Maddalena 9/2 16124      Genova (Italy)
>>           tel. +39(0)10 2475439  fax +39(0)10 2475439  gsm:+39 393 1590711
>> ------------------------------------------------------------
>> --------------
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140821/e93a8096/attachment-0001.html>

From nicu.tofan at gmail.com  Thu Aug 21 10:32:34 2014
From: nicu.tofan at gmail.com (Nicu Tofan)
Date: Thu, 21 Aug 2014 20:32:34 +0300
Subject: [gdal-dev] Notes on gdalbuildvrt.cpp
Message-ID: <CAGFYcD8_wmRUOupS-3YKRLaGTRKofQoWowgDQugDjnwXzVpfsg@mail.gmail.com>

Assuming that VRTBuilder class inside gdalbuildvrt.cpp has been created to
be reusable, I have some comments/questions that, depending on your input,
may end up in pull requests.

   - *VRTBuilder::VRTBuilder, line 300*

Instead of assigning the pointer create a copy to be consistent with the
rest of the code. The memory is released twice, once at 1558 with

CPLFree( panBandList );

and once at 347 with

delete[] panBandList;

   - *VRTBuilder::pasDatasetProperties line 237*

At line 1092 AnalyseRaster is called with a pointer inside
pasDatasetProperties

if (AnalyseRaster( hDS, dsFileName, &pasDatasetProperties[i] ))

However the array may be re-allocated at line 416; if the reallocation is
not in place the psDatasetProperties pointer will be invalid.

Maybe passing an index instead of a pointer can solve the problem.

   - *line 513-520*

What would it take to support rotated, positive NS resolutions?

   - *line 543*

Assumes that there is at least one band; The code below does not make that
assumption and checks for that condition; GDALGetBlockSize() does not
handle a NULL pointer.

   -
*line 825, 920 *

Why the GDALProxyPoolDatasetH? Why not opening it like a regular data set?
When creating VRT files in C++ code this is the path to be taken?


Regards,

Nicu
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140821/d11337de/attachment.html>

From shuai at illinois.edu  Thu Aug 21 11:00:11 2014
From: shuai at illinois.edu (Zhang, Shuai)
Date: Thu, 21 Aug 2014 18:00:11 +0000
Subject: [gdal-dev] GDAL Driver for MongoDB
Message-ID: <2DAEBB32799F494EBE504E1247CC5E8220ED7BCC@CITESMBX6.ad.uillinois.edu>

Hi there,

I wrote a GDAL driver for mongodb, and uploaded it in the github<https://github.com/mongogis/mongodb-gdal-driver>. Feel free to grab and use the driver.

Just let me know if you have any questions or suggestions.
Thanks,
shuai
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140821/1cdeca0a/attachment.html>

From even.rouault at spatialys.com  Thu Aug 21 11:23:25 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 21 Aug 2014 20:23:25 +0200
Subject: [gdal-dev] Notes on gdalbuildvrt.cpp
In-Reply-To: <CAGFYcD8_wmRUOupS-3YKRLaGTRKofQoWowgDQugDjnwXzVpfsg@mail.gmail.com>
References: <CAGFYcD8_wmRUOupS-3YKRLaGTRKofQoWowgDQugDjnwXzVpfsg@mail.gmail.com>
Message-ID: <201408212023.26121.even.rouault@spatialys.com>

Le jeudi 21 ao?t 2014 19:32:34, Nicu Tofan a ?crit :
> Assuming that VRTBuilder class inside gdalbuildvrt.cpp has been created to
> be reusable, 

Not particularly, but your remarks are interesting and beneficial to 
gdalbuildvrt itself.

> I have some comments/questions that, depending on your input,
> may end up in pull requests.
> 
>    - *VRTBuilder::VRTBuilder, line 300*
> 
> Instead of assigning the pointer create a copy to be consistent with the
> rest of the code. The memory is released twice, once at 1558 with
> 
> CPLFree( panBandList );
> 
> and once at 347 with
> 
> delete[] panBandList;

True, I could actually reproduce the issue with valgrind and passing the -b 
option of gdalbuildvrt.
But there are code paths in VRTBuilder::AnalyseRaster() that allocate 
panBandList in some circumstances. So the right fix would be in the VRTBuilder 
constructor to do a copy of the passed panBandList if not NULL

> 
>    - *VRTBuilder::pasDatasetProperties line 237*
> 
> At line 1092 AnalyseRaster is called with a pointer inside
> pasDatasetProperties
> 
> if (AnalyseRaster( hDS, dsFileName, &pasDatasetProperties[i] ))
> 
> However the array may be re-allocated at line 416; if the reallocation is
> not in place the psDatasetProperties pointer will be invalid.
> 
> Maybe passing an index instead of a pointer can solve the problem.

I'm not sure there is an issue there. AnalyseRaster() will possibly relocate 
pasDatasetProperties, but as this is a member variable of the class, the next 
call of line 1092 will have the new address. Do you have a practical case 
where there would be an issue ?

> 
>    - *line 513-520*
> 
> What would it take to support rotated, positive NS resolutions?

Generally this is a sign of non georeferenced images. Perhaps some adaptations 
should be made if there are assumptions in the rest of the code about the sign 
of the y resolution

> 
>    - *line 543*
> 
> Assumes that there is at least one band; The code below does not make that
> assumption and checks for that condition; GDALGetBlockSize() does not
> handle a NULL pointer.

True. Should be moved after line 576 likely.

> 
>    -
> *line 825, 920 *
> 
> Why the GDALProxyPoolDatasetH? Why not opening it like a regular data set?
> When creating VRT files in C++ code this is the path to be taken?

If you are creating a VRT with more than 1024 sources, you would run out of 
file descriptors on Linux. GDALProxyPoolDatasetH is a trick to avoid having too 
many "real" datasets opened at the same time. If you don't have that 
constraint, you could use the real datasets, but this is needed in the general 
case of gdalbuildvrt.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Aug 21 11:33:14 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 21 Aug 2014 20:33:14 +0200
Subject: [gdal-dev] GDAL translate 16 bit to 8 bit
In-Reply-To: <CAFpCUPp+G+5NGF0rC1z2bOwcNEYDb4OY=C7jaA-Lxw5QP2jSXA@mail.gmail.com>
References: <CAFpCUPp+G+5NGF0rC1z2bOwcNEYDb4OY=C7jaA-Lxw5QP2jSXA@mail.gmail.com>
Message-ID: <201408212033.14741.even.rouault@spatialys.com>

Le jeudi 21 ao?t 2014 08:57:32, Hanlie Pretorius a ?crit :
> Hi,
> 
> I'm working with a 16 bit SPOT 6 image that I want to convert from 16
> bit pixel depth to 8 bit pixel depth. I say 16 bit, but if I load the
> file into Envi, it reports that uses only 12 bits. However gdalinfo
> reports 16 bit (see below).
> 
> I've manage to do so on the multispectral image, but the result is
> poor colour wise.
> 
> So I split the image into its four bands that is, I now have one image per
> band.
> 
> When I now try to convert to 8 bit, I get a message that says:
> "Warning 742327101_R1C1_band1_8bit.TIF not created".

Are you quoting the exact message ? I can't find any trace of it in the 
relevant parts of the source code. Did you check that you have write 
permissions in the directory where you launch the command ?

Anyway for what you want to do you likely need to explore the -scale option of 
gdal_translate. But that's unrelated to the error

> 
> The command I'm using is:
> gdal_translate -ot Byte -of GTiff "D:/SPOT
> 6/EightBit/IMG_SPOT6_MS_201304290812030_ORT_742327101_R1C1_band1.TIF"
> 742327101_R1C1_band1_8bit.TIF
> 
> gdalinfo for the original MS image gives the following result:
> Driver: GTiff/GeoTIFF
> Files: D:/SPOT
> 6/SANSA_SouthAfr_246_SO13012989_43_DS_SPOT6_201304290812030_FR1_FR1_SE1_SE
> 1_E021S32_03414/PROD_SPOT6_001/VOL_SPOT6_001_A/IMG_SPOT6_MS_001_A/IMG_SPOT6
> _MS_201304290812030_ORT_742327101_R1C1.TIF D:/SPOT
> 6/SANSA_SouthAfr_246_SO13012989_43_DS_SPOT6_201304290812030_FR1_FR1_SE1_SE
> 1_E021S32_03414/PROD_SPOT6_001/VOL_SPOT6_001_A/IMG_SPOT6_MS_001_A/IMG_SPOT6
> _MS_201304290812030_ORT_742327101_R1C1.tif.ovr D:/SPOT
> 6/SANSA_SouthAfr_246_SO13012989_43_DS_SPOT6_201304290812030_FR1_FR1_SE1_SE
> 1_E021S32_03414/PROD_SPOT6_001/VOL_SPOT6_001_A/IMG_SPOT6_MS_001_A/IMG_SPOT6
> _MS_201304290812030_ORT_742327101_R1C1.TFW D:/SPOT
> 6/SANSA_SouthAfr_246_SO13012989_43_DS_SPOT6_201304290812030_FR1_FR1_SE1_SE
> 1_E021S32_03414/PROD_SPOT6_001/VOL_SPOT6_001_A/IMG_SPOT6_MS_001_A/IMG_SPOT6
> _MS_201304290812030_ORT_742327101_R1C1.TIF.aux.xml Size is 7680, 7680
> Coordinate System is:
> PROJCS["WGS 84 / UTM zone 34S",
>     GEOGCS["WGS 84",
>         DATUM["WGS_1984",
>             SPHEROID["WGS 84",6378137,298.257223563,
>                 AUTHORITY["EPSG","7030"]],
>             AUTHORITY["EPSG","6326"]],
>         PRIMEM["Greenwich",0],
>         UNIT["degree",0.0174532925199433],
>         AUTHORITY["EPSG","4326"]],
>     PROJECTION["Transverse_Mercator"],
>     PARAMETER["latitude_of_origin",0],
>     PARAMETER["central_meridian",21],
>     PARAMETER["scale_factor",0.9996],
>     PARAMETER["false_easting",500000],
>     PARAMETER["false_northing",10000000],
>     UNIT["metre",1,
>         AUTHORITY["EPSG","9001"]],
>     AUTHORITY["EPSG","32734"]]
> Origin = (426894.000000000000000,6421830.000000000000000)
> Pixel Size = (6.000000000000000,-6.000000000000000)
> Metadata:
>   AREA_OR_POINT=Area
>   TIFFTAG_DATETIME=2013:12:05 14:23:06
>   TIFFTAG_IMAGEDESCRIPTION=B2, B1, B0, B3
>   TIFFTAG_XRESOLUTION=6
>   TIFFTAG_YRESOLUTION=6
> Image Structure Metadata:
>   INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  (  426894.000, 6421830.000) ( 20d13'23.42"E, 32d20'16.91"S)
> Lower Left  (  426894.000, 6375750.000) ( 20d13'10.50"E, 32d45'13.25"S)
> Upper Right (  472974.000, 6421830.000) ( 20d42'46.12"E, 32d20'24.35"S)
> Lower Right (  472974.000, 6375750.000) ( 20d42'41.34"E, 32d45'20.81"S)
> Center      (  449934.000, 6398790.000) ( 20d28' 0.35"E, 32d32'49.70"S)
> Band 1 Block=7680x128 Type=UInt16, ColorInterp=Red
>   Min=0.000 Max=2768.000
>   Minimum=0.000, Maximum=2768.000, Mean=254.357, StdDev=82.827
>   Overviews: 3840x3840, 1920x1920, 960x960, 480x480, 240x240
>   Metadata:
>    
> STATISTICS_COVARIANCES=6860.33555334015,5408.39177012214,3932.59000707709,
> 8359.55872888383 STATISTICS_MAXIMUM=2768
>     STATISTICS_MEAN=254.35743888007
>     STATISTICS_MINIMUM=0
>     STATISTICS_SKIPFACTORX=1
>     STATISTICS_SKIPFACTORY=1
>     STATISTICS_STDDEV=82.827142612432
> Band 2 Block=7680x128 Type=UInt16, ColorInterp=Green
>   Min=0.000 Max=1928.000
>   Minimum=0.000, Maximum=1928.000, Mean=272.449, StdDev=67.362
>   Overviews: 3840x3840, 1920x1920, 960x960, 480x480, 240x240
>   Metadata:
>    
> STATISTICS_COVARIANCES=5408.39177012214,4537.57701249689,3512.4873688442,6
> 910.89114933438 STATISTICS_MAXIMUM=1928
>     STATISTICS_MEAN=272.44932240804
>     STATISTICS_MINIMUM=0
>     STATISTICS_SKIPFACTORX=1
>     STATISTICS_SKIPFACTORY=1
>     STATISTICS_STDDEV=67.361539564479
> Band 3 Block=7680x128 Type=UInt16, ColorInterp=Blue
>   Min=0.000 Max=2264.000
>   Minimum=0.000, Maximum=2264.000, Mean=291.925, StdDev=54.875
>   Overviews: 3840x3840, 1920x1920, 960x960, 480x480, 240x240
>   Metadata:
>    
> STATISTICS_COVARIANCES=3932.59000707709,3512.4873688442,3011.23474438976,5
> 111.02811591707 STATISTICS_MAXIMUM=2264
>     STATISTICS_MEAN=291.92457129584
>     STATISTICS_MINIMUM=0
>     STATISTICS_SKIPFACTORX=1
>     STATISTICS_SKIPFACTORY=1
>     STATISTICS_STDDEV=54.874718626976
> Band 4 Block=7680x128 Type=UInt16, ColorInterp=Undefined
>   Min=0.000 Max=2699.000
>   Minimum=0.000, Maximum=2699.000, Mean=374.146, StdDev=115.219
>   Overviews: 3840x3840, 1920x1920, 960x960, 480x480, 240x240
>   Metadata:
>    
> STATISTICS_COVARIANCES=8359.55872888383,6910.89114933438,5111.02811591707,
> 13275.4755734648 STATISTICS_MAXIMUM=2699
>     STATISTICS_MEAN=374.14637317234
>     STATISTICS_MINIMUM=0
>     STATISTICS_SKIPFACTORX=1
>     STATISTICS_SKIPFACTORY=1
>     STATISTICS_STDDEV=115.21925001259
> 
> gdalinfo for band 1 of the image that I'm trying to use for the
> conversion, gives the following results:
> Driver: GTiff/GeoTIFF
> Files: D:/SPOT
> 6/SANSA_SouthAfr_246_SO13012989_43_DS_SPOT6_201304290812030_FR1_FR1_SE1_SE
> 1_E021S32_03414/PROD_SPOT6_001/VOL_SPOT6_001_A/IMG_SPOT6_MS_001_A/IMG_SPOT6
> _MS_201304290812030_ORT_742327101_R1C1.TIF D:/SPOT
> 6/SANSA_SouthAfr_246_SO13012989_43_DS_SPOT6_201304290812030_FR1_FR1_SE1_SE
> 1_E021S32_03414/PROD_SPOT6_001/VOL_SPOT6_001_A/IMG_SPOT6_MS_001_A/IMG_SPOT6
> _MS_201304290812030_ORT_742327101_R1C1.tif.ovr D:/SPOT
> 6/SANSA_SouthAfr_246_SO13012989_43_DS_SPOT6_201304290812030_FR1_FR1_SE1_SE
> 1_E021S32_03414/PROD_SPOT6_001/VOL_SPOT6_001_A/IMG_SPOT6_MS_001_A/IMG_SPOT6
> _MS_201304290812030_ORT_742327101_R1C1.TFW D:/SPOT
> 6/SANSA_SouthAfr_246_SO13012989_43_DS_SPOT6_201304290812030_FR1_FR1_SE1_SE
> 1_E021S32_03414/PROD_SPOT6_001/VOL_SPOT6_001_A/IMG_SPOT6_MS_001_A/IMG_SPOT6
> _MS_201304290812030_ORT_742327101_R1C1.TIF.aux.xml Size is 7680, 7680
> Coordinate System is:
> PROJCS["WGS 84 / UTM zone 34S",
>     GEOGCS["WGS 84",
>         DATUM["WGS_1984",
>             SPHEROID["WGS 84",6378137,298.257223563,
>                 AUTHORITY["EPSG","7030"]],
>             AUTHORITY["EPSG","6326"]],
>         PRIMEM["Greenwich",0],
>         UNIT["degree",0.0174532925199433],
>         AUTHORITY["EPSG","4326"]],
>     PROJECTION["Transverse_Mercator"],
>     PARAMETER["latitude_of_origin",0],
>     PARAMETER["central_meridian",21],
>     PARAMETER["scale_factor",0.9996],
>     PARAMETER["false_easting",500000],
>     PARAMETER["false_northing",10000000],
>     UNIT["metre",1,
>         AUTHORITY["EPSG","9001"]],
>     AUTHORITY["EPSG","32734"]]
> Origin = (426894.000000000000000,6421830.000000000000000)
> Pixel Size = (6.000000000000000,-6.000000000000000)
> Metadata:
>   AREA_OR_POINT=Area
>   TIFFTAG_DATETIME=2013:12:05 14:23:06
>   TIFFTAG_IMAGEDESCRIPTION=B2, B1, B0, B3
>   TIFFTAG_XRESOLUTION=6
>   TIFFTAG_YRESOLUTION=6
> Image Structure Metadata:
>   INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  (  426894.000, 6421830.000) ( 20d13'23.42"E, 32d20'16.91"S)
> Lower Left  (  426894.000, 6375750.000) ( 20d13'10.50"E, 32d45'13.25"S)
> Upper Right (  472974.000, 6421830.000) ( 20d42'46.12"E, 32d20'24.35"S)
> Lower Right (  472974.000, 6375750.000) ( 20d42'41.34"E, 32d45'20.81"S)
> Center      (  449934.000, 6398790.000) ( 20d28' 0.35"E, 32d32'49.70"S)
> Band 1 Block=7680x128 Type=UInt16, ColorInterp=Red
>   Min=0.000 Max=2768.000
>   Minimum=0.000, Maximum=2768.000, Mean=254.357, StdDev=82.827
>   Overviews: 3840x3840, 1920x1920, 960x960, 480x480, 240x240
>   Metadata:
>    
> STATISTICS_COVARIANCES=6860.33555334015,5408.39177012214,3932.59000707709,
> 8359.55872888383 STATISTICS_MAXIMUM=2768
>     STATISTICS_MEAN=254.35743888007
>     STATISTICS_MINIMUM=0
>     STATISTICS_SKIPFACTORX=1
>     STATISTICS_SKIPFACTORY=1
>     STATISTICS_STDDEV=82.827142612432
> Band 2 Block=7680x128 Type=UInt16, ColorInterp=Green
>   Min=0.000 Max=1928.000
>   Minimum=0.000, Maximum=1928.000, Mean=272.449, StdDev=67.362
>   Overviews: 3840x3840, 1920x1920, 960x960, 480x480, 240x240
>   Metadata:
>    
> STATISTICS_COVARIANCES=5408.39177012214,4537.57701249689,3512.4873688442,6
> 910.89114933438 STATISTICS_MAXIMUM=1928
>     STATISTICS_MEAN=272.44932240804
>     STATISTICS_MINIMUM=0
>     STATISTICS_SKIPFACTORX=1
>     STATISTICS_SKIPFACTORY=1
>     STATISTICS_STDDEV=67.361539564479
> Band 3 Block=7680x128 Type=UInt16, ColorInterp=Blue
>   Min=0.000 Max=2264.000
>   Minimum=0.000, Maximum=2264.000, Mean=291.925, StdDev=54.875
>   Overviews: 3840x3840, 1920x1920, 960x960, 480x480, 240x240
>   Metadata:
>    
> STATISTICS_COVARIANCES=3932.59000707709,3512.4873688442,3011.23474438976,5
> 111.02811591707 STATISTICS_MAXIMUM=2264
>     STATISTICS_MEAN=291.92457129584
>     STATISTICS_MINIMUM=0
>     STATISTICS_SKIPFACTORX=1
>     STATISTICS_SKIPFACTORY=1
>     STATISTICS_STDDEV=54.874718626976
> Band 4 Block=7680x128 Type=UInt16, ColorInterp=Undefined
>   Min=0.000 Max=2699.000
>   Minimum=0.000, Maximum=2699.000, Mean=374.146, StdDev=115.219
>   Overviews: 3840x3840, 1920x1920, 960x960, 480x480, 240x240
>   Metadata:
>    
> STATISTICS_COVARIANCES=8359.55872888383,6910.89114933438,5111.02811591707,
> 13275.4755734648 STATISTICS_MAXIMUM=2699
>     STATISTICS_MEAN=374.14637317234
>     STATISTICS_MINIMUM=0
>     STATISTICS_SKIPFACTORX=1
>     STATISTICS_SKIPFACTORY=1
>     STATISTICS_STDDEV=115.21925001259
> 
> 
> I'm using QGIS 2.2.0 on Windows 8 as a front end to GDAL.
> 
> Can anyone perhaps see why the error is occurring or suggest an
> alternative workflow?
> 
> Thanks
> Hanlie
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From nicu.tofan at gmail.com  Thu Aug 21 12:13:15 2014
From: nicu.tofan at gmail.com (Nicu Tofan)
Date: Thu, 21 Aug 2014 22:13:15 +0300
Subject: [gdal-dev] Notes on gdalbuildvrt.cpp
In-Reply-To: <CAGFYcD-Jis27CdfVWAtfutDj5QbWK8TmXsoZaVgF-c5igVvMWg@mail.gmail.com>
References: <CAGFYcD8_wmRUOupS-3YKRLaGTRKofQoWowgDQugDjnwXzVpfsg@mail.gmail.com>
	<201408212023.26121.even.rouault@spatialys.com>
	<CAGFYcD-Jis27CdfVWAtfutDj5QbWK8TmXsoZaVgF-c5igVvMWg@mail.gmail.com>
Message-ID: <CAGFYcD8OOUq6TG5d4PLSbb9gH8tiYfp36xSCwUmgkvnSY6E=wg@mail.gmail.com>

Hello Even,


   - VRTBuilder::pasDatasetProperties line 237

DatasetProperty* psDatasetProperties

This is a variable allocated on the stack; on function entry it contains a
pointer somewhere inside pasDatasetProperties; Say pasDatasetProperties is
0x7500000 and psDatasetProperties is
0x7500100. Now on line pasDatasetProperties the buffer at 0x7500000gets
reallocated, possibly moving to, say, 0x90000000; psDatasetPropertiesshould
now be 0x90000100 but it is still 0x7500100 because it is stored in a
variable on the stack - namelly the argument psDatasetPropertie.

On line 457 psDatasetPropertie is used and is going to contain 0x750010. It
may not trigger an access violation because the address will probably be
inside the heap but it may generate some hard to find bugs that we all love
and cherish.

As a reflection of mine, this may be the result of the naming convention,
as psDataset and pasDataset look the same to our animal brains.



   - Generally this is a sign of non georeferenced images...

The bounding box becomes a bit more complicated in rotated images, too. I'm
gonna look into it.



   - GDALProxyPoolDatasetH

Got it, thanks!

Regards,
Nick

PS Forgot to reply to the list, sorry.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140821/009d1299/attachment.html>

From even.rouault at spatialys.com  Thu Aug 21 12:21:30 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 21 Aug 2014 21:21:30 +0200
Subject: [gdal-dev] Notes on gdalbuildvrt.cpp
In-Reply-To: <CAGFYcD8OOUq6TG5d4PLSbb9gH8tiYfp36xSCwUmgkvnSY6E=wg@mail.gmail.com>
References: <CAGFYcD8_wmRUOupS-3YKRLaGTRKofQoWowgDQugDjnwXzVpfsg@mail.gmail.com>
	<CAGFYcD-Jis27CdfVWAtfutDj5QbWK8TmXsoZaVgF-c5igVvMWg@mail.gmail.com>
	<CAGFYcD8OOUq6TG5d4PLSbb9gH8tiYfp36xSCwUmgkvnSY6E=wg@mail.gmail.com>
Message-ID: <201408212121.30121.even.rouault@spatialys.com>

Le jeudi 21 ao?t 2014 21:13:15, Nicu Tofan a ?crit :
> Hello Even,
> 
> 
>    - VRTBuilder::pasDatasetProperties line 237
> 
> DatasetProperty* psDatasetProperties
> 
> This is a variable allocated on the stack; on function entry it contains a
> pointer somewhere inside pasDatasetProperties; Say pasDatasetProperties is
> 0x7500000 and psDatasetProperties is
> 0x7500100. Now on line pasDatasetProperties the buffer at 0x7500000gets
> reallocated, possibly moving to, say, 0x90000000; psDatasetPropertiesshould
> now be 0x90000100 but it is still 0x7500100 because it is stored in a
> variable on the stack - namelly the argument psDatasetPropertie.
> 
> On line 457 psDatasetPropertie is used and is going to contain 0x750010. It
> may not trigger an access violation because the address will probably be
> inside the heap but it may generate some hard to find bugs that we all love
> and cherish.

That shouldn't happen because of the return at line 453. But for clarity we 
might have a dedicated function for the processing done between line 412 and 
454 since it doesn't need psDatasetProperties at all.

> 
> As a reflection of mine, this may be the result of the naming convention,
> as psDataset and pasDataset look the same to our animal brains.

Hungarian-style convention.

psXXXX is a Pointer to a single Structure
pasXXXXX is a Pointer to an Array of Structure

> 
> 
> 
>    - Generally this is a sign of non georeferenced images...
> 
> The bounding box becomes a bit more complicated in rotated images, too. I'm
> gonna look into it.

Dealing with non-zero values in gt[2] and gt[4] is clearly out of scope of 
what a regular VRT can do (you need a warped VRT for that).
Well you could still produce a regular VRT (with a rotated geotransform) if 
all the sources have the same rotation in their geotransform, but that's an 
unlikely situation.

> 
> 
> 
>    - GDALProxyPoolDatasetH
> 
> Got it, thanks!
> 
> Regards,
> Nick
> 
> PS Forgot to reply to the list, sorry.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From nicu.tofan at gmail.com  Thu Aug 21 12:29:28 2014
From: nicu.tofan at gmail.com (Nicu Tofan)
Date: Thu, 21 Aug 2014 22:29:28 +0300
Subject: [gdal-dev] Notes on gdalbuildvrt.cpp
In-Reply-To: <201408212121.30121.even.rouault@spatialys.com>
References: <CAGFYcD8_wmRUOupS-3YKRLaGTRKofQoWowgDQugDjnwXzVpfsg@mail.gmail.com>
	<CAGFYcD-Jis27CdfVWAtfutDj5QbWK8TmXsoZaVgF-c5igVvMWg@mail.gmail.com>
	<CAGFYcD8OOUq6TG5d4PLSbb9gH8tiYfp36xSCwUmgkvnSY6E=wg@mail.gmail.com>
	<201408212121.30121.even.rouault@spatialys.com>
Message-ID: <CAGFYcD-XjXMOufF=m6nXANvRS9idyFKPRkC18qG+xb6R+8uisw@mail.gmail.com>

> That shouldn't happen because of the return at line 453....
Damn, I missed that. :)

> Hungarian-style convention....
Yes, I've read RFC8 <https://trac.osgeo.org/gdal/wiki/rfc8_devguide>; just
thinking out loud.




2014-08-21 22:21 GMT+03:00 Even Rouault <even.rouault at spatialys.com>:

> Le jeudi 21 ao?t 2014 21:13:15, Nicu Tofan a ?crit :
> > Hello Even,
> >
> >
> >    - VRTBuilder::pasDatasetProperties line 237
> >
> > DatasetProperty* psDatasetProperties
> >
> > This is a variable allocated on the stack; on function entry it contains
> a
> > pointer somewhere inside pasDatasetProperties; Say pasDatasetProperties
> is
> > 0x7500000 and psDatasetProperties is
> > 0x7500100. Now on line pasDatasetProperties the buffer at 0x7500000gets
> > reallocated, possibly moving to, say, 0x90000000;
> psDatasetPropertiesshould
> > now be 0x90000100 but it is still 0x7500100 because it is stored in a
> > variable on the stack - namelly the argument psDatasetPropertie.
> >
> > On line 457 psDatasetPropertie is used and is going to contain 0x750010.
> It
> > may not trigger an access violation because the address will probably be
> > inside the heap but it may generate some hard to find bugs that we all
> love
> > and cherish.
>
> That shouldn't happen because of the return at line 453. But for clarity we
> might have a dedicated function for the processing done between line 412
> and
> 454 since it doesn't need psDatasetProperties at all.
>
> >
> > As a reflection of mine, this may be the result of the naming convention,
> > as psDataset and pasDataset look the same to our animal brains.
>
> Hungarian-style convention.
>
> psXXXX is a Pointer to a single Structure
> pasXXXXX is a Pointer to an Array of Structure
>
> >
> >
> >
> >    - Generally this is a sign of non georeferenced images...
> >
> > The bounding box becomes a bit more complicated in rotated images, too.
> I'm
> > gonna look into it.
>
> Dealing with non-zero values in gt[2] and gt[4] is clearly out of scope of
> what a regular VRT can do (you need a warped VRT for that).
> Well you could still produce a regular VRT (with a rotated geotransform) if
> all the sources have the same rotation in their geotransform, but that's an
> unlikely situation.
>
> >
> >
> >
> >    - GDALProxyPoolDatasetH
> >
> > Got it, thanks!
> >
> > Regards,
> > Nick
> >
> > PS Forgot to reply to the list, sorry.
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140821/af11e945/attachment.html>

From gdal at stripfamily.net  Thu Aug 21 12:48:18 2014
From: gdal at stripfamily.net (David Strip)
Date: Thu, 21 Aug 2014 13:48:18 -0600
Subject: [gdal-dev] Adding a "Commercial support" section on gdal.org?
In-Reply-To: <CA+YzLBfnJgP2QGKLRMuuNbAX_9kZrtwVhWvCTzqWn+0XgNDPfw@mail.gmail.com>
References: <20140821144635.oum3mxjt0g0ocs88@webmail.charta.acme.com>	<CACqBkM9HMpqwEVidz2rFqWOu1m-8tXGeiu3fwpLygM28U9Jo5w@mail.gmail.com>
	<CA+YzLBfnJgP2QGKLRMuuNbAX_9kZrtwVhWvCTzqWn+0XgNDPfw@mail.gmail.com>
Message-ID: <53F64D02.9080401@stripfamily.net>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140821/ea238084/attachment.html>

From flippmoke at gmail.com  Thu Aug 21 12:59:22 2014
From: flippmoke at gmail.com (Blake Thompson)
Date: Thu, 21 Aug 2014 14:59:22 -0500
Subject: [gdal-dev] RFC 47 and Threading
In-Reply-To: <CAFOE_BeOCCcXqqYr5k0gB_mV1QqDrkKPjYPakwiNQXsUC==b_g@mail.gmail.com>
References: <CAPxHBh9szm_RmMhNMgTTQFTjc_x=dAndVFPvFXzK+F6nn0nXfg@mail.gmail.com>
	<201408202226.36037.even.rouault@spatialys.com>
	<CAPxHBh9181d_bakm2AksQ7j5C44QzVAuRK+p5QjCJh-s=6Xy3w@mail.gmail.com>
	<CAFOE_BeOCCcXqqYr5k0gB_mV1QqDrkKPjYPakwiNQXsUC==b_g@mail.gmail.com>
Message-ID: <CAPxHBh8c6vqoKfKyZbHLtOih24j4ZW-VZXZp8qhP84cqOh6aQw@mail.gmail.com>

On Thu, Aug 21, 2014 at 11:36 AM, Jeff Lacoste <jefflacostegdal at gmail.com>
wrote:

> Hi,
>
> Improving the thread safety of GDAL is a big improvement. I know this
> proposal is not claiming to 'fix' gdal thread safety but adress at least
> the cache safety. This is said, may be to help
> clarify more the proposal, we can state what the change would address and
> (may be more important) not address. Just to make it more specific about
> gain of caching per dataset instead of global one.
>

 Updated the RFC to hopefully reflect this better reflect some of this,
please send more questions as you have them.



>  Would this mean for ex. that batch translating datasets would gain from
> this and be done in a parallel way ? Since we can avoid avoid trashing a
> global trash.
> So instead of translation x datasets in a sequential manner now (with the
> proposed changes) this can be done in parallel ?
>

Currently it is possible to do batch translating of datasets, but it is not
efficient. The reason for this is that there is a point where each thread
is attempting to add or remove gdalrasterblocks from the global cache. Once
the global cache size is reached all the threads are often blocked for
extended periods as each one attempts to clear the cache. The worst part is
that this also prevents simple reading from the cache during this period,
because other blocks can not efficiently use
GDALRasterBand::TryGetLockedBlockRef, to pull existing blocks from the
cache.

The simple and first fix I made while doing this was simply to make it
possible to operate with a per dataset cache (this was not selected as per
band due to possible deadlock issues). Doing this allows for each dataset
to have its own lock for its cache and the performance increases
dramatically for operating on different datasets in parallel.


>
> If yes, what would the cache flushing strategy once the cach max is
> reached  ? For ex. 5 running threads converting 5 datasets. We reach the
> max cache while the 5 threads are executing, this mean that threads will be
> blocked from executing as no cache is available until it has been released
> by other threads ?
>


> Jeff Lacoste
>

In the case I described above each dataset has its own max cache.
Therefore, reaching the maximum cache can only occur in a single dataset.
Therefore if the maximum cache was reached on that cache, it would flush
and not prevent other datasets and threads from operating on their own
caches. However, this means that the person writing the code MUST be aware
of the total cache sizes of all their datasets (I know this isn't ideal for
many people).

So I decided to take it a step farther and wanted to make it possible for a
dataset using a driver such as memory to be able to do something such as: 5
running threads translating 1 dataset, 5 times. Also I wanted to be able to
use one global cache and make it so that, the 5 threads translating 5
datasets would not lock as often with a global cache. To achieve this a
separation of concerns had to occur, and this lead to the development of
multiple mutexes.

Three different data structure are at risk during threading within the
cache:

#1 - The Linked List of the cache and size of this linked list (this allows
the cache to flush the least recently used GDALRasterBlock)
#2 - The cache block array of a GDALRasterBand (this allows the
GDALRasterBand to find its GDALRasterBlocks)
#3 - The data stored within the GDALRasterBlock (this is the actual data
stored in the block)

If you are limiting the scope of our support of threading to only allow 1
thread to access any 1 dataset at a time #3 requires no protection.
However, in any cache that is shared by more then 1 dataset (global cache),
not only must the linked list be protected by the list global cache, but
you must protect the cache block array in the raster bands. Since currently
when items are removed from the cache, it simply removes blocks until it is
below the cache limit, all raster bands can not read from their cache block
arrays until all flushing has completed.

Therefore, during my design I decided that each portion should be protected
by its own mutex. In order to not require the linked list (LRU) mutex from
being locked for extended periods, I mark blocks for deletion when it is to
removed from the cache and it will be removed at the earliest safe period,
which unless another the block is about to be used by another thread, will
be right away. Otherwise it will occur once the other thread is done using
that block.

Therefore, this also means the mutex protecting the global cache in my code
is also locked less. Therefore, even with out using a per dataset cache,
the example of using 5 threads to translate 5 datasets should still be
faster then the current configuration.

TLDR; There are benefits in my design outside of just a non global cache
for datasets.

Blake Thompson
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140821/ab10e671/attachment-0001.html>

From robert.coup at koordinates.com  Thu Aug 21 13:57:32 2014
From: robert.coup at koordinates.com (Robert Coup)
Date: Fri, 22 Aug 2014 08:57:32 +1200
Subject: [gdal-dev] RFC 47 and Threading
In-Reply-To: <201408202226.36037.even.rouault@spatialys.com>
References: <CAPxHBh9szm_RmMhNMgTTQFTjc_x=dAndVFPvFXzK+F6nn0nXfg@mail.gmail.com>
	<201408202226.36037.even.rouault@spatialys.com>
Message-ID: <CAFLLRpKtRNLs-c_o6H-YU04i0PZEWEetfFzAWjxN_32cnD5aGg@mail.gmail.com>

On Thu, Aug 21, 2014 at 8:26 AM, Even Rouault <even.rouault at spatialys.com>
 wrote:

>
> I guess the silence in thread is due to people being impressed by the
> austerity of the topic...
>

Something like that :)


>
> On the other side, I would be very pleased with having "just" the
> preliminary
> step of Blake's work, i.e. the possibility to choose a per-band block cache
> strategy instead of the global block cache. That should already address
> most
> scaling issues.
>

I agree - from reading it seems like the major improvement is shifting away
from a global, locking cache to a per-dataset cache. (ah. has been edited
since you read it?)

Which personally I think is worthwhile for any code/application which reads
a variety of gdal datasources.

Quick question - presumably for VRT datasets any source images currently
share the global cache and are treated from this proposals' POV as their
own "datasets"? As well as the VRT being a separate dataset? If so, seems
like this could be quite a major win for users with VRTs for tiled images?

While it's a lot of code change, it's mostly simple/repeated changes.

> Solution 2 (RW Mutex in GDALRasterBlock)
> Cons:
> It means that writing a driver is not as trivial as before and care must
be taken in how locking is done within the driver in order to prevent
deadlocks and maintain thread safety.

I'm wary about making drivers more complex, there's a lot of them. And many
are unlikely to be tested in multi-threaded anger during initial
development (and MT issues can be hard to unit test). Can you explain a bit
further what would be the impact for typical driver styles? Can we make the
typical case (no/locked multithreaded access) really easy? What sort of
driver code would be needed for drivers that can do MT reads? MT reads and
writes?

Rob :)

OT: can we change gdal-dev to be reply-all by default? :)
-- 

*Koordinates*PO Box 1604, Shortland St, Auckland 1140, New Zealand
Phone +64-9-966 0433 koordinates.com <https://koordinates.com/about>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140822/9e4892f3/attachment.html>

From cleo21drakos at gmail.com  Fri Aug 22 02:37:55 2014
From: cleo21drakos at gmail.com (Cleo Drakos)
Date: Fri, 22 Aug 2014 18:37:55 +0900
Subject: [gdal-dev] gdaldem color-relief does not produce any result
Message-ID: <CAMorJ8Gw9BKeZ+DZ+XV_+vGCk0A8-W8+h1hJmNUHtLZLCUaVNg@mail.gmail.com>

I have a single band geotiff file with discrete data in bytes.
The unique data values are 0, 1,  2, 3, and 4.
I want to intrepret each unique value as rgb color.

So, I created the text file (color_relief.txt) which contans the following:

0 55 78 94
1 98 23 64
2 112 35 99
3 34 67 72
4 78 250 60

Then I run the following code using python:

import subprocess
in_file =  'single_band.tif'
text_file = 'color_relief.txt'
gdaldem = 'C:\\Python27\\Lib\\site-packages\\osgeo\\gdaldem.exe'
out_file =  'result.tif'
subprocess.call([gdaldem
,'color-relif',in_file,text_file,out_file,'-exact_color_entry','-b','1'],shell=True)
in_file, out_file = None, None

Unfortunately, no result file is obtained.
What is wrong with my code?

cleo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140822/9ea349b0/attachment.html>

From hanlie.pretorius at gmail.com  Fri Aug 22 03:02:25 2014
From: hanlie.pretorius at gmail.com (Hanlie Pretorius)
Date: Fri, 22 Aug 2014 12:02:25 +0200
Subject: [gdal-dev] GDAL translate 16 bit to 8 bit
In-Reply-To: <201408212033.14741.even.rouault@spatialys.com>
References: <CAFpCUPp+G+5NGF0rC1z2bOwcNEYDb4OY=C7jaA-Lxw5QP2jSXA@mail.gmail.com>
	<201408212033.14741.even.rouault@spatialys.com>
Message-ID: <CAFpCUPqNGNOznZbWcCK1JdqrhUUBaJsdF1geO6AqZwyEaOMD=g@mail.gmail.com>

Hi Even,

Yes, I quoted the exact message, but it displays in the QGIS interface.

I tried gdal_translate with the -ot and -scale parameters on the
multispectral image and that worked much better, thanks.

Regards
Hanlie

2014-08-21 20:33 MGT+02:00, Even Rouault <even.rouault at spatialys.com>:
> Le jeudi 21 ao?t 2014 08:57:32, Hanlie Pretorius a ?crit :
>> Hi,
>>
>> I'm working with a 16 bit SPOT 6 image that I want to convert from 16
>> bit pixel depth to 8 bit pixel depth. I say 16 bit, but if I load the
>> file into Envi, it reports that uses only 12 bits. However gdalinfo
>> reports 16 bit (see below).
>>
>> I've manage to do so on the multispectral image, but the result is
>> poor colour wise.
>>
>> So I split the image into its four bands that is, I now have one image
>> per
>> band.
>>
>> When I now try to convert to 8 bit, I get a message that says:
>> "Warning 742327101_R1C1_band1_8bit.TIF not created".
>
> Are you quoting the exact message ? I can't find any trace of it in the
> relevant parts of the source code. Did you check that you have write
> permissions in the directory where you launch the command ?
>
> Anyway for what you want to do you likely need to explore the -scale option
> of
> gdal_translate. But that's unrelated to the error
>
>>

From cleo21drakos at gmail.com  Fri Aug 22 04:56:51 2014
From: cleo21drakos at gmail.com (Cleo Drakos)
Date: Fri, 22 Aug 2014 20:56:51 +0900
Subject: [gdal-dev] GDAL translate 16 bit to 8 bit
In-Reply-To: <CAFpCUPqNGNOznZbWcCK1JdqrhUUBaJsdF1geO6AqZwyEaOMD=g@mail.gmail.com>
References: <CAFpCUPp+G+5NGF0rC1z2bOwcNEYDb4OY=C7jaA-Lxw5QP2jSXA@mail.gmail.com>
	<201408212033.14741.even.rouault@spatialys.com>
	<CAFpCUPqNGNOznZbWcCK1JdqrhUUBaJsdF1geO6AqZwyEaOMD=g@mail.gmail.com>
Message-ID: <CAMorJ8GHeEQBNx2D74XRWFJ0bwvZhLuFCLiv_pPARKtRhEXXVw@mail.gmail.com>

hi Hanlie,
can you tell me what value you put for -scale to convert into 8 bit?

cleo


On Fri, Aug 22, 2014 at 7:02 PM, Hanlie Pretorius <
hanlie.pretorius at gmail.com> wrote:

> Hi Even,
>
> Yes, I quoted the exact message, but it displays in the QGIS interface.
>
> I tried gdal_translate with the -ot and -scale parameters on the
> multispectral image and that worked much better, thanks.
>
> Regards
> Hanlie
>
> 2014-08-21 20:33 MGT+02:00, Even Rouault <even.rouault at spatialys.com>:
> > Le jeudi 21 ao?t 2014 08:57:32, Hanlie Pretorius a ?crit :
> >> Hi,
> >>
> >> I'm working with a 16 bit SPOT 6 image that I want to convert from 16
> >> bit pixel depth to 8 bit pixel depth. I say 16 bit, but if I load the
> >> file into Envi, it reports that uses only 12 bits. However gdalinfo
> >> reports 16 bit (see below).
> >>
> >> I've manage to do so on the multispectral image, but the result is
> >> poor colour wise.
> >>
> >> So I split the image into its four bands that is, I now have one image
> >> per
> >> band.
> >>
> >> When I now try to convert to 8 bit, I get a message that says:
> >> "Warning 742327101_R1C1_band1_8bit.TIF not created".
> >
> > Are you quoting the exact message ? I can't find any trace of it in the
> > relevant parts of the source code. Did you check that you have write
> > permissions in the directory where you launch the command ?
> >
> > Anyway for what you want to do you likely need to explore the -scale
> option
> > of
> > gdal_translate. But that's unrelated to the error
> >
> >>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140822/ff3114d7/attachment.html>

From hanlie.pretorius at gmail.com  Fri Aug 22 05:01:21 2014
From: hanlie.pretorius at gmail.com (Hanlie Pretorius)
Date: Fri, 22 Aug 2014 14:01:21 +0200
Subject: [gdal-dev] GDAL translate 16 bit to 8 bit
In-Reply-To: <CAMorJ8GHeEQBNx2D74XRWFJ0bwvZhLuFCLiv_pPARKtRhEXXVw@mail.gmail.com>
References: <CAFpCUPp+G+5NGF0rC1z2bOwcNEYDb4OY=C7jaA-Lxw5QP2jSXA@mail.gmail.com>
	<201408212033.14741.even.rouault@spatialys.com>
	<CAFpCUPqNGNOznZbWcCK1JdqrhUUBaJsdF1geO6AqZwyEaOMD=g@mail.gmail.com>
	<CAMorJ8GHeEQBNx2D74XRWFJ0bwvZhLuFCLiv_pPARKtRhEXXVw@mail.gmail.com>
Message-ID: <CAFpCUPoZ0zwG1BEmQYyD5jv0hc5C7ZyL-EmWpe472e7+XnwV3g@mail.gmail.com>

Hi Cleo,

I used

-scale 0 4095 0 255

The reason for the 4095 is that the images actually use only the first
12 bits of the 16 bits (according to the documentation) and 2^12 =
4096.

If it was a true 16 bit image I would use 65535 for the 'max from' value.

Regards
Hanlie



2014-08-22 13:56 MGT+02:00, Cleo Drakos <cleo21drakos at gmail.com>:
> hi Hanlie,
> can you tell me what value you put for -scale to convert into 8 bit?
>
> cleo
>
>
> On Fri, Aug 22, 2014 at 7:02 PM, Hanlie Pretorius <
> hanlie.pretorius at gmail.com> wrote:
>
>> Hi Even,
>>
>> Yes, I quoted the exact message, but it displays in the QGIS interface.
>>
>> I tried gdal_translate with the -ot and -scale parameters on the
>> multispectral image and that worked much better, thanks.
>>
>> Regards
>> Hanlie
>>
>> 2014-08-21 20:33 MGT+02:00, Even Rouault <even.rouault at spatialys.com>:
>> > Le jeudi 21 ao?t 2014 08:57:32, Hanlie Pretorius a ?crit :
>> >> Hi,
>> >>
>> >> I'm working with a 16 bit SPOT 6 image that I want to convert from 16
>> >> bit pixel depth to 8 bit pixel depth. I say 16 bit, but if I load the
>> >> file into Envi, it reports that uses only 12 bits. However gdalinfo
>> >> reports 16 bit (see below).
>> >>
>> >> I've manage to do so on the multispectral image, but the result is
>> >> poor colour wise.
>> >>
>> >> So I split the image into its four bands that is, I now have one image
>> >> per
>> >> band.
>> >>
>> >> When I now try to convert to 8 bit, I get a message that says:
>> >> "Warning 742327101_R1C1_band1_8bit.TIF not created".
>> >
>> > Are you quoting the exact message ? I can't find any trace of it in the
>> > relevant parts of the source code. Did you check that you have write
>> > permissions in the directory where you launch the command ?
>> >
>> > Anyway for what you want to do you likely need to explore the -scale
>> option
>> > of
>> > gdal_translate. But that's unrelated to the error
>> >
>> >>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>

From cleo21drakos at gmail.com  Fri Aug 22 05:06:25 2014
From: cleo21drakos at gmail.com (Cleo Drakos)
Date: Fri, 22 Aug 2014 21:06:25 +0900
Subject: [gdal-dev] GDAL translate 16 bit to 8 bit
In-Reply-To: <CAFpCUPoZ0zwG1BEmQYyD5jv0hc5C7ZyL-EmWpe472e7+XnwV3g@mail.gmail.com>
References: <CAFpCUPp+G+5NGF0rC1z2bOwcNEYDb4OY=C7jaA-Lxw5QP2jSXA@mail.gmail.com>
	<201408212033.14741.even.rouault@spatialys.com>
	<CAFpCUPqNGNOznZbWcCK1JdqrhUUBaJsdF1geO6AqZwyEaOMD=g@mail.gmail.com>
	<CAMorJ8GHeEQBNx2D74XRWFJ0bwvZhLuFCLiv_pPARKtRhEXXVw@mail.gmail.com>
	<CAFpCUPoZ0zwG1BEmQYyD5jv0hc5C7ZyL-EmWpe472e7+XnwV3g@mail.gmail.com>
Message-ID: <CAMorJ8Exe22c_Tn8fQT5v0Q2XtHW8jbOj4ebxrp-Wr=iqaUqpw@mail.gmail.com>

thanks Hanlie.

cleo


On Fri, Aug 22, 2014 at 9:01 PM, Hanlie Pretorius <
hanlie.pretorius at gmail.com> wrote:

> Hi Cleo,
>
> I used
>
> -scale 0 4095 0 255
>
> The reason for the 4095 is that the images actually use only the first
> 12 bits of the 16 bits (according to the documentation) and 2^12 =
> 4096.
>
> If it was a true 16 bit image I would use 65535 for the 'max from' value.
>
> Regards
> Hanlie
>
>
>
> 2014-08-22 13:56 MGT+02:00, Cleo Drakos <cleo21drakos at gmail.com>:
> > hi Hanlie,
> > can you tell me what value you put for -scale to convert into 8 bit?
> >
> > cleo
> >
> >
> > On Fri, Aug 22, 2014 at 7:02 PM, Hanlie Pretorius <
> > hanlie.pretorius at gmail.com> wrote:
> >
> >> Hi Even,
> >>
> >> Yes, I quoted the exact message, but it displays in the QGIS interface.
> >>
> >> I tried gdal_translate with the -ot and -scale parameters on the
> >> multispectral image and that worked much better, thanks.
> >>
> >> Regards
> >> Hanlie
> >>
> >> 2014-08-21 20:33 MGT+02:00, Even Rouault <even.rouault at spatialys.com>:
> >> > Le jeudi 21 ao?t 2014 08:57:32, Hanlie Pretorius a ?crit :
> >> >> Hi,
> >> >>
> >> >> I'm working with a 16 bit SPOT 6 image that I want to convert from 16
> >> >> bit pixel depth to 8 bit pixel depth. I say 16 bit, but if I load the
> >> >> file into Envi, it reports that uses only 12 bits. However gdalinfo
> >> >> reports 16 bit (see below).
> >> >>
> >> >> I've manage to do so on the multispectral image, but the result is
> >> >> poor colour wise.
> >> >>
> >> >> So I split the image into its four bands that is, I now have one
> image
> >> >> per
> >> >> band.
> >> >>
> >> >> When I now try to convert to 8 bit, I get a message that says:
> >> >> "Warning 742327101_R1C1_band1_8bit.TIF not created".
> >> >
> >> > Are you quoting the exact message ? I can't find any trace of it in
> the
> >> > relevant parts of the source code. Did you check that you have write
> >> > permissions in the directory where you launch the command ?
> >> >
> >> > Anyway for what you want to do you likely need to explore the -scale
> >> option
> >> > of
> >> > gdal_translate. But that's unrelated to the error
> >> >
> >> >>
> >> _______________________________________________
> >> gdal-dev mailing list
> >> gdal-dev at lists.osgeo.org
> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >>
> >
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140822/3df32bc9/attachment-0001.html>

From jefflacostegdal at gmail.com  Fri Aug 22 06:11:38 2014
From: jefflacostegdal at gmail.com (Jeff Lacoste)
Date: Fri, 22 Aug 2014 09:11:38 -0400
Subject: [gdal-dev] RFC 47 and Threading
In-Reply-To: <CAPxHBh8c6vqoKfKyZbHLtOih24j4ZW-VZXZp8qhP84cqOh6aQw@mail.gmail.com>
References: <CAPxHBh9szm_RmMhNMgTTQFTjc_x=dAndVFPvFXzK+F6nn0nXfg@mail.gmail.com>
	<201408202226.36037.even.rouault@spatialys.com>
	<CAPxHBh9181d_bakm2AksQ7j5C44QzVAuRK+p5QjCJh-s=6Xy3w@mail.gmail.com>
	<CAFOE_BeOCCcXqqYr5k0gB_mV1QqDrkKPjYPakwiNQXsUC==b_g@mail.gmail.com>
	<CAPxHBh8c6vqoKfKyZbHLtOih24j4ZW-VZXZp8qhP84cqOh6aQw@mail.gmail.com>
Message-ID: <CAFOE_BdahzK4esUa6UTJ=S4pEOFVVqOuGigLc+56YYf=FYsQKQ@mail.gmail.com>

Thanks Blake for the detailed response. I did not realize that I did not do
a reply all in my previous email I sent.


On Thu, Aug 21, 2014 at 3:59 PM, Blake Thompson <flippmoke at gmail.com> wrote:

>
>
>
> On Thu, Aug 21, 2014 at 11:36 AM, Jeff Lacoste <jefflacostegdal at gmail.com>
> wrote:
>
>> Hi,
>>
>> Improving the thread safety of GDAL is a big improvement. I know this
>> proposal is not claiming to 'fix' gdal thread safety but adress at least
>> the cache safety. This is said, may be to help
>> clarify more the proposal, we can state what the change would address and
>> (may be more important) not address. Just to make it more specific about
>> gain of caching per dataset instead of global one.
>>
>
>  Updated the RFC to hopefully reflect this better reflect some of this,
> please send more questions as you have them.
>
>
>
>>  Would this mean for ex. that batch translating datasets would gain from
>> this and be done in a parallel way ? Since we can avoid avoid trashing a
>> global trash.
>> So instead of translation x datasets in a sequential manner now (with the
>> proposed changes) this can be done in parallel ?
>>
>
> Currently it is possible to do batch translating of datasets, but it is
> not efficient. The reason for this is that there is a point where each
> thread is attempting to add or remove gdalrasterblocks from the global
> cache. Once the global cache size is reached all the threads are often
> blocked for extended periods as each one attempts to clear the cache. The
> worst part is that this also prevents simple reading from the cache during
> this period, because other blocks can not efficiently use
> GDALRasterBand::TryGetLockedBlockRef, to pull existing blocks from the
> cache.
>

--> I thought that this was not possible using current trunk GDAL because
of the global cache. At least the writing side using multiple threads can
cause issues.
See this response on a older topic I found in GDAL dev list:
http://lists.osgeo.org/pipermail/gdal-dev/2013-January/035215.html
The response there was for a similar question as the one i posted about
supporting of batch translating of dataset with this RFC .

>
> The simple and first fix I made while doing this was simply to make it
> possible to operate with a per dataset cache (this was not selected as per
> band due to possible deadlock issues). Doing this allows for each dataset
> to have its own lock for its cache and the performance increases
> dramatically for operating on different dataset in parallel.
>
>
>>
>> If yes, what would the cache flushing strategy once the cach max is
>> reached  ? For ex. 5 running threads converting 5 dataset. We reach the max
>> cache while the 5 threads are executing, this mean that threads will be
>> blocked from executing as no cache is available until it has been released
>> by other threads ?
>>
>
>
>> Jeff Lacoste
>>
>
> In the case I described above each dataset has its own max cache.
> Therefore, reaching the maximum cache can only occur in a single dataset.
> Therefore if the maximum cache was reached on that cache, it would flush
> and not prevent other dataset and threads from operating on their own
> caches. However, this means that the person writing the code MUST be aware
> of the total cache sizes of all their dataset (I know this isn't ideal for
> many people).
>

--> Ok, I was under the wrong impression that in addition of  a cache per
dataset there is still a cap of global cache that oversee the total cache
used by GDAL.

>
> So I decided to take it a step farther and wanted to make it possible for
> a dataset using a driver such as memory to be able to do something such as:
> 5 running threads translating 1 dataset, 5 times. Also I wanted to be able
> to use one global cache and make it so that, the 5 threads translating 5
> datasets would not lock as often with a global cache. To achieve this a
> separation of concerns had to occur, and this lead to the development of
> multiple mutexes.
>
> Three different data structure are at risk during threading within the
> cache:
>
> #1 - The Linked List of the cache and size of this linked list (this
> allows the cache to flush the least recently used GDALRasterBlock)
> #2 - The cache block array of a GDALRasterBand (this allows the
> GDALRasterBand to find its GDALRasterBlocks)
> #3 - The data stored within the GDALRasterBlock (this is the actual data
> stored in the block)
>
> If you are limiting the scope of our support of threading to only allow 1
> thread to access any 1 dataset at a time #3 requires no protection.
> However, in any cache that is shared by more then 1 dataset (global cache),
> not only must the linked list be protected by the list global cache, but
> you must protect the cache block array in the raster bands. Since currently
> when items are removed from the cache, it simply removes blocks until it is
> below the cache limit, all raster bands can not read from their cache block
> arrays until all flushing has completed.
>
> Therefore, during my design I decided that each portion should be
> protected by its own mutex. In order to not require the linked list (LRU)
> mutex from being locked for extended periods, I mark blocks for deletion
> when it is to removed from the cache and it will be removed at the earliest
> safe period, which unless another the block is about to be used by another
> thread, will be right away. Otherwise it will occur once the other thread
> is done using that block.
>
> Therefore, this also means the mutex protecting the global cache in my
> code is also locked less. Therefore, even with out using a per dataset
> cache, the example of using 5 threads to translate 5 datasets should still
> be faster then the current configuration.
>

--> Is this mean that in addition of the per dataset cache once can still
use the global cache (only not per dataset one) and have the scenario of
translating multiple datasets in a parallel way
works ok (without threading issues due to current implementation global
cache).

So we are dealing here with two possible solutions (per dataset cache and
improved global cache) ? or they are complimentary ?
or the global cache improvement is done to only support the use case of 'x
running thread translating a dataset x times' ? Any other use cases this
solve ?

>
> TLDR; There are benefits in my design outside of just a non global cache
> for datasets.
>
> Blake Thompson
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140822/d06a2da5/attachment.html>

From schwehr at gmail.com  Fri Aug 22 07:07:35 2014
From: schwehr at gmail.com (Kurt Schwehr)
Date: Fri, 22 Aug 2014 07:07:35 -0700
Subject: [gdal-dev] RFC 47 and Threading
In-Reply-To: <CAFOE_BdahzK4esUa6UTJ=S4pEOFVVqOuGigLc+56YYf=FYsQKQ@mail.gmail.com>
References: <CAPxHBh9szm_RmMhNMgTTQFTjc_x=dAndVFPvFXzK+F6nn0nXfg@mail.gmail.com>
	<201408202226.36037.even.rouault@spatialys.com>
	<CAPxHBh9181d_bakm2AksQ7j5C44QzVAuRK+p5QjCJh-s=6Xy3w@mail.gmail.com>
	<CAFOE_BeOCCcXqqYr5k0gB_mV1QqDrkKPjYPakwiNQXsUC==b_g@mail.gmail.com>
	<CAPxHBh8c6vqoKfKyZbHLtOih24j4ZW-VZXZp8qhP84cqOh6aQw@mail.gmail.com>
	<CAFOE_BdahzK4esUa6UTJ=S4pEOFVVqOuGigLc+56YYf=FYsQKQ@mail.gmail.com>
Message-ID: <CACmBxytiCHjbTpmXmjy8YekB0Sxnzz98bkkoecLVNCM8DxJMrw@mail.gmail.com>

I've got threading issues on my list of things to investigate with GDAL.
 I've been running MSAN on GDAL lately and want to get TSAN going too.  I'm
out on leave this month, but hope to get more into this stuff (testing,
threading, caching, etc) come October.


On Fri, Aug 22, 2014 at 6:11 AM, Jeff Lacoste <jefflacostegdal at gmail.com>
wrote:

> Thanks Blake for the detailed response. I did not realize that I did not
> do a reply all in my previous email I sent.
>
>
> On Thu, Aug 21, 2014 at 3:59 PM, Blake Thompson <flippmoke at gmail.com>
> wrote:
>
>>
>>
>>
>> On Thu, Aug 21, 2014 at 11:36 AM, Jeff Lacoste <jefflacostegdal at gmail.com
>> > wrote:
>>
>>> Hi,
>>>
>>> Improving the thread safety of GDAL is a big improvement. I know this
>>> proposal is not claiming to 'fix' gdal thread safety but adress at least
>>> the cache safety. This is said, may be to help
>>> clarify more the proposal, we can state what the change would address
>>> and (may be more important) not address. Just to make it more specific
>>> about gain of caching per dataset instead of global one.
>>>
>>
>>  Updated the RFC to hopefully reflect this better reflect some of this,
>> please send more questions as you have them.
>>
>>
>>
>>>  Would this mean for ex. that batch translating datasets would gain
>>> from this and be done in a parallel way ? Since we can avoid avoid trashing
>>> a global trash.
>>> So instead of translation x datasets in a sequential manner now (with
>>> the proposed changes) this can be done in parallel ?
>>>
>>
>> Currently it is possible to do batch translating of datasets, but it is
>> not efficient. The reason for this is that there is a point where each
>> thread is attempting to add or remove gdalrasterblocks from the global
>> cache. Once the global cache size is reached all the threads are often
>> blocked for extended periods as each one attempts to clear the cache. The
>> worst part is that this also prevents simple reading from the cache during
>> this period, because other blocks can not efficiently use
>> GDALRasterBand::TryGetLockedBlockRef, to pull existing blocks from the
>> cache.
>>
>
> --> I thought that this was not possible using current trunk GDAL because
> of the global cache. At least the writing side using multiple threads can
> cause issues.
> See this response on a older topic I found in GDAL dev list:
> http://lists.osgeo.org/pipermail/gdal-dev/2013-January/035215.html
> The response there was for a similar question as the one i posted about
> supporting of batch translating of dataset with this RFC .
>
>>
>> The simple and first fix I made while doing this was simply to make it
>> possible to operate with a per dataset cache (this was not selected as per
>> band due to possible deadlock issues). Doing this allows for each dataset
>> to have its own lock for its cache and the performance increases
>> dramatically for operating on different dataset in parallel.
>>
>>
>>>
>>> If yes, what would the cache flushing strategy once the cach max is
>>> reached  ? For ex. 5 running threads converting 5 dataset. We reach the max
>>> cache while the 5 threads are executing, this mean that threads will be
>>> blocked from executing as no cache is available until it has been released
>>> by other threads ?
>>>
>>
>>
>>> Jeff Lacoste
>>>
>>
>> In the case I described above each dataset has its own max cache.
>> Therefore, reaching the maximum cache can only occur in a single dataset.
>> Therefore if the maximum cache was reached on that cache, it would flush
>> and not prevent other dataset and threads from operating on their own
>> caches. However, this means that the person writing the code MUST be aware
>> of the total cache sizes of all their dataset (I know this isn't ideal for
>> many people).
>>
>
> --> Ok, I was under the wrong impression that in addition of  a cache per
> dataset there is still a cap of global cache that oversee the total cache
> used by GDAL.
>
>>
>> So I decided to take it a step farther and wanted to make it possible for
>> a dataset using a driver such as memory to be able to do something such as:
>> 5 running threads translating 1 dataset, 5 times. Also I wanted to be able
>> to use one global cache and make it so that, the 5 threads translating 5
>> datasets would not lock as often with a global cache. To achieve this a
>> separation of concerns had to occur, and this lead to the development of
>> multiple mutexes.
>>
>> Three different data structure are at risk during threading within the
>> cache:
>>
>> #1 - The Linked List of the cache and size of this linked list (this
>> allows the cache to flush the least recently used GDALRasterBlock)
>> #2 - The cache block array of a GDALRasterBand (this allows the
>> GDALRasterBand to find its GDALRasterBlocks)
>> #3 - The data stored within the GDALRasterBlock (this is the actual data
>> stored in the block)
>>
>> If you are limiting the scope of our support of threading to only allow 1
>> thread to access any 1 dataset at a time #3 requires no protection.
>> However, in any cache that is shared by more then 1 dataset (global cache),
>> not only must the linked list be protected by the list global cache, but
>> you must protect the cache block array in the raster bands. Since currently
>> when items are removed from the cache, it simply removes blocks until it is
>> below the cache limit, all raster bands can not read from their cache block
>> arrays until all flushing has completed.
>>
>> Therefore, during my design I decided that each portion should be
>> protected by its own mutex. In order to not require the linked list (LRU)
>> mutex from being locked for extended periods, I mark blocks for deletion
>> when it is to removed from the cache and it will be removed at the earliest
>> safe period, which unless another the block is about to be used by another
>> thread, will be right away. Otherwise it will occur once the other thread
>> is done using that block.
>>
>> Therefore, this also means the mutex protecting the global cache in my
>> code is also locked less. Therefore, even with out using a per dataset
>> cache, the example of using 5 threads to translate 5 datasets should still
>> be faster then the current configuration.
>>
>
> --> Is this mean that in addition of the per dataset cache once can still
> use the global cache (only not per dataset one) and have the scenario of
> translating multiple datasets in a parallel way
> works ok (without threading issues due to current implementation global
> cache).
>
> So we are dealing here with two possible solutions (per dataset cache and
> improved global cache) ? or they are complimentary ?
> or the global cache improvement is done to only support the use case of 'x
> running thread translating a dataset x times' ? Any other use cases this
> solve ?
>
>>
>> TLDR; There are benefits in my design outside of just a non global cache
>> for datasets.
>>
>> Blake Thompson
>>
>>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140822/66229950/attachment-0001.html>

From flippmoke at gmail.com  Fri Aug 22 07:33:50 2014
From: flippmoke at gmail.com (Blake Thompson)
Date: Fri, 22 Aug 2014 09:33:50 -0500
Subject: [gdal-dev] RFC 47 and Threading
In-Reply-To: <CAFLLRpKtRNLs-c_o6H-YU04i0PZEWEetfFzAWjxN_32cnD5aGg@mail.gmail.com>
References: <CAPxHBh9szm_RmMhNMgTTQFTjc_x=dAndVFPvFXzK+F6nn0nXfg@mail.gmail.com>
	<201408202226.36037.even.rouault@spatialys.com>
	<CAFLLRpKtRNLs-c_o6H-YU04i0PZEWEetfFzAWjxN_32cnD5aGg@mail.gmail.com>
Message-ID: <CAPxHBh_8xHUCSZuT3agiAaWTPku05CpEhDEwt98r0B9c=_V+bQ@mail.gmail.com>

Robert,


> I agree - from reading it seems like the major improvement is shifting
> away from a global, locking cache to a per-dataset cache. (ah. has been
> edited since you read it?)
>

Yes, I updated the RFC some yesterday after the email from Jeff Lacoste. He
forgot to hit reply all so it ended up in a different email thread, but if
you haven't read it I would encourage you to read that as well. I probably
should pull some of the information from that email into the RFC.


>
> Which personally I think is worthwhile for any code/application which
> reads a variety of gdal datasources.
>
> Quick question - presumably for VRT datasets any source images currently
> share the global cache and are treated from this proposals' POV as their
> own "datasets"? As well as the VRT being a separate dataset? If so, seems
> like this could be quite a major win for users with VRTs for tiled images?
>
>
The GDALRasterBlockManger if done per dataset is a member of the base
GDALDataset Object, so all inherited classes will have it as well. So yes,
I believe that should be the case that each seperate dataset in the VRT
would have its own cache. All of this is assuming you set the global config
option to use a per dataset cache.



> While it's a lot of code change, it's mostly simple/repeated changes.
>
> > Solution 2 (RW Mutex in GDALRasterBlock)
> > Cons:
> > It means that writing a driver is not as trivial as before and care must
> be taken in how locking is done within the driver in order to prevent
> deadlocks and maintain thread safety.
>
> I'm wary about making drivers more complex, there's a lot of them. And
> many are unlikely to be tested in multi-threaded anger during initial
> development (and MT issues can be hard to unit test). Can you explain a bit
> further what would be the impact for typical driver styles? Can we make the
> typical case (no/locked multithreaded access) really easy? What sort of
> driver code would be needed for drivers that can do MT reads? MT reads and
> writes?
>

I completely understand the being wary about making drivers more complex,
there are a ton of them and I had to edit every single one for my
implementation of Solution 2. However, I am starting to like this solution
more and more. The reason that this solution must be this way, is because
many drivers will call the same block from different bands. This can cause
deadlocks if not careful because two threads on the same dataset could be
in the same processes at different times. To fix this I am passing a mutex
through the IReadBlock, IWriteBlock, and IRasterIO functions. This allows
for a much more fine level of control over the process. It allows the mutex
used to protect the Block Data pointer (that is passed through the
IReadBlock, etc) to be protected only at the times required. For many
drivers its simply blocking the entire time the reading/writing process is
occuring.

Multi-threading reads should be possible in many cases as long as the
driver code itself is safe for such an implementation. If a locking is used
to protect the file pointer and only allow a single thread to be reading
the file from disk at a time in most drivers they should become thread safe
(also the protection of any global statics in the drivers). This means
increased complexity in most drivers to make them thread safe, but I think
it would be possible.

Multi-threading writes is a little more complex, and is not well covered in
these changes. Issues can come up with reading and writing at the same
time. Here is an example of a complex situation.

Thread 1: Writes to Block A located at (0,0), this block is then marked for
deletion from the cache and is intended to be flushed.

Thread 1: Removes Block A from the Band's block array

Thread 2: Attempts to Read Block at (0,0). Not finding any blocks it
creates Block B and inserts it to Band Block Array

Thread 2: Reads from the driver and loads data into Block B.

Thread 1: Writes data from Block A which is being flushed to the driver.

Thread 2: Edits Block B, but incorrectly because the changes from Block A
are not included.

I think that this can be corrected in the code by always requiring that all
flushing through the driver occurs prior to removing the block from the
block array. Just checked my code and this is possible right now in
Solution #2, so it might need to be something that I should fix.

In a more generally large issue, there are issues with even more simple
things with writing. Imagine someone warping into a band at the same time a
fill operation on a band is being executed, if there is no protection it
would end up with a weird set of values. Personally I think this, is
something we shouldn't attempt to fix currently as this should just be
accepted as a bad way to write a multi-threaded application. If you can
think of any other situations where writing might have issues I really
would like to know.

Thanks,

Blake
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140822/e2c460e1/attachment.html>

From cleo21drakos at gmail.com  Fri Aug 22 07:48:29 2014
From: cleo21drakos at gmail.com (Cleo Drakos)
Date: Fri, 22 Aug 2014 23:48:29 +0900
Subject: [gdal-dev] gdaldem color-relief does not produce any result
In-Reply-To: <CAMorJ8Gw9BKeZ+DZ+XV_+vGCk0A8-W8+h1hJmNUHtLZLCUaVNg@mail.gmail.com>
References: <CAMorJ8Gw9BKeZ+DZ+XV_+vGCk0A8-W8+h1hJmNUHtLZLCUaVNg@mail.gmail.com>
Message-ID: <CAMorJ8Eii8MsdquB_CnwWLXsDPKvNzLUexemH+9gODY-WuBZ_Q@mail.gmail.com>

I have a geotiff file with class values (0, 1,  2, 3, and 4).
I want to show each class as different rgb color.

So, I created the text file (color_relief.txt) which contans the following:

0 55 78 94
1 98 23 64
2 112 35 99
3 34 67 72
4 78 250 60

Then I run the following code using python:

import subprocess
in_file =  'single_band.tif'
text_file = 'color_relief.txt'
gdaldem = 'C:\\Python27\\Lib\\site-packages\\osgeo\\gdaldem.exe'
out_file =  'result.tif'
subprocess.call([gdaldem
,'color-relif',in_file,text_file,out_file,'-exact_color_entry','-b','1'],shell=True)
in_file, out_file = None, None

Unfortunately, no result file is obtained.
What is wrong with my code?

cleo


On Fri, Aug 22, 2014 at 6:37 PM, Cleo Drakos <cleo21drakos at gmail.com> wrote:

> I have a single band geotiff file with discrete data in bytes.
> The unique data values are 0, 1,  2, 3, and 4.
> I want to intrepret each unique value as rgb color.
>
>  So, I created the text file (color_relief.txt) which contans the
> following:
>
> 0 55 78 94
> 1 98 23 64
> 2 112 35 99
> 3 34 67 72
> 4 78 250 60
>
> Then I run the following code using python:
>
> import subprocess
> in_file =  'single_band.tif'
> text_file = 'color_relief.txt'
> gdaldem = 'C:\\Python27\\Lib\\site-packages\\osgeo\\gdaldem.exe'
> out_file =  'result.tif'
> subprocess.call([gdaldem
> ,'color-relif',in_file,text_file,out_file,'-exact_color_entry','-b','1'],shell=True)
> in_file, out_file = None, None
>
> Unfortunately, no result file is obtained.
> What is wrong with my code?
>
> cleo
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140822/5d217c8b/attachment.html>

From russo at bogodyn.org  Fri Aug 22 07:49:51 2014
From: russo at bogodyn.org (Tom Russo)
Date: Fri, 22 Aug 2014 08:49:51 -0600
Subject: [gdal-dev] GRASS gdal and ogr plugins
Message-ID: <20140822144951.GA29194@bogodyn.org>

I've just svn updated gdal to r27596 and rebuilt it, grass, and the grass 
plugin and installed them.  I had not previously updated gdal since about 
May 14.  

Now gdalinfo and ogrinfo  are reporting:

> gdalinfo --formats 
ERROR 1: A non OGR driver is registered with the same name: GRASS
Supported Formats:
  GRASS -raster- (ro): GRASS Database Rasters (5.7+)
...

and 

> ogrinfo --formats 
ERROR 1: A non OGR driver is registered with the same name: GRASS
Supported Formats:
  PCIDSK -raster,vector- (rw+v): PCIDSK Database File
...

GRASS does not appear here, so clearly the registration of the OGR grass 
plugin is not happening.  The code does not exit abnormally, just prints the 
error message and clearly doesn't have the OGR grass plugin loaded.

The same happens from applications that are built against the gdal library.  
Normal operation, just no access to GRASS data through OGR.

Looking at ogr/ogrsf_frmts/generic/ogrsfdriverregistrar.cpp, I'm wondering
if that's because both the gdal grass driver and ogr driver are returning
"GRASS" as their name, and the "GRASS" provided by gdal is confusing the 
registrar?  Should the OGR driver maybe have a different name?  Or am I 
completely off the mark?

I do note that the change in ogrsfdriverregistrar.cpp that introduced the
error message was dated 24 May 2014, just 10 days after I had last built gdal
on this machine.  The previous build would report "GRASS" as an available 
format from OGR.

I'm using grass off of the "develbranch_6" branch, updated right before I built
the gdal plugin.

I build the gdal plugin so:
  build and install gdal without GRASS support
  build GRASS and install it
  build the plugin: 
  cd /.../gdal/frmts/grass/pkg
  ln -s ../grass57dataset.cpp .
  ln -s ../../../ogr/ogrsf_frmts/grass/ogrgrassdriver.cpp .
  ln -s ../../../ogr/ogrsf_frmts/grass/ogrgrassdatasource.cpp .
  ln -s ../../../ogr/ogrsf_frmts/grass/ogrgrasslayer.cpp .
  ln -s ../../../ogr/ogrsf_frmts/grass/ogrgrass.h .
  ./configure --with-gdal=/usr/local/bin/gdal-config --with-grass=/usr/local/grass-6.5.svn --with-autoload=/usr/local/lib/gdalplugins
  gmake
  sudo gmake install

The result is gdal_GRASS.so and ogr_GRASS.so in /usr/local/lib/gdalplugins.

Am I simply building the plugin wrong, or is this a bug?
 
-- 
Tom Russo    KM5VY   SAR502   DM64ux          http://www.swcp.com/~russo/
Tijeras, NM  QRPL#1592 K2#398  SOC#236        http://kevan.org/brain.cgi?DDTNM
 echo "prpv_a'rfg_cnf_har_cvcr" | sed -e 's/_/ /g' | tr [a-m][n-z] [n-z][a-m]

From atuncatunc at gmail.com  Fri Aug 22 08:42:57 2014
From: atuncatunc at gmail.com (tuncatunc)
Date: Fri, 22 Aug 2014 08:42:57 -0700 (PDT)
Subject: [gdal-dev] Creating Wire Connection Data
Message-ID: <1408722177052-5157856.post@n6.nabble.com>

Downloaded obstacle data from FAA and imported into QGIS.
I need to create a from-to list by automatically connecting points which are
no more separete than 1 mile.
Sample Point data 
https://drive.google.com/file/d/0B8Gy4YUXifTINE1xVXVyclJjdkU/edit?usp=sharing
Convert 
*Source Table
------------
POINT_ID LAT   LON*
P1
P2
P3
...
PN

*Expected Output
---------------
*Wire 1 -> P1 P3 P5 P7
Wire 2 -> Pn Pk Ps
...

Do you have any pointers
Regards
Tunca




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Creating-Wire-Connection-Data-tp5157856.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From flippmoke at gmail.com  Fri Aug 22 08:53:50 2014
From: flippmoke at gmail.com (Blake Thompson)
Date: Fri, 22 Aug 2014 10:53:50 -0500
Subject: [gdal-dev] RFC 47 and Threading
Message-ID: <CAPxHBh8QSsqN2K5tTctMG+mzv_Eo0BrcY-WQ23H-FF305ew8pA@mail.gmail.com>

Jeff,

Thanks Blake for the detailed response. I did not realize that I did not do
> a reply all in my previous email I sent.
>

Not an issue, glad you guys are interested in my changes.

>
> --> I thought that this was not possible using current trunk GDAL because
> of the global cache. At least the writing side using multiple threads can
> cause issues.
> See this response on a older topic I found in GDAL dev list:
> http://lists.osgeo.org/pipermail/gdal-dev/2013-January/035215.html
> The response there was for a similar question as the one i posted about
> supporting of batch translating of dataset with this RFC .
>

I do believe it is possible in the current trunk of GDAL (and I have
written some code to do it with out seeing any issues). There is a "lock"
on raster blocks currently that prevents them from being removed from the
cache if they are currently be utilized.


>
> --> Ok, I was under the wrong impression that in addition of  a cache per
> dataset there is still a cap of global cache that oversee the total cache
> used by GDAL.
>

This really isn't possible, because if something needs to be removed from
the cache and there is nothing to remove from the current dataset, it would
have to go to another dataset to lower the cache size. At this point the
per dataset cache really has limited meaning, because a lot of the same
issues will occur.

--> Is this mean that in addition of the per dataset cache once can still
> use the global cache (only not per dataset one) and have the scenario of
> translating multiple datasets in a parallel way
> works ok (without threading issues due to current implementation global
> cache).
>

Yes, it will work to translate multiple datasets in a parallel way with a
global cache.

Thanks,

Blake
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140822/6cf48da5/attachment-0001.html>

From flippmoke at gmail.com  Fri Aug 22 09:00:54 2014
From: flippmoke at gmail.com (Blake Thompson)
Date: Fri, 22 Aug 2014 11:00:54 -0500
Subject: [gdal-dev] RFC 47 and Threading
In-Reply-To: <CACmBxytiCHjbTpmXmjy8YekB0Sxnzz98bkkoecLVNCM8DxJMrw@mail.gmail.com>
References: <CAPxHBh9szm_RmMhNMgTTQFTjc_x=dAndVFPvFXzK+F6nn0nXfg@mail.gmail.com>
	<201408202226.36037.even.rouault@spatialys.com>
	<CAPxHBh9181d_bakm2AksQ7j5C44QzVAuRK+p5QjCJh-s=6Xy3w@mail.gmail.com>
	<CAFOE_BeOCCcXqqYr5k0gB_mV1QqDrkKPjYPakwiNQXsUC==b_g@mail.gmail.com>
	<CAPxHBh8c6vqoKfKyZbHLtOih24j4ZW-VZXZp8qhP84cqOh6aQw@mail.gmail.com>
	<CAFOE_BdahzK4esUa6UTJ=S4pEOFVVqOuGigLc+56YYf=FYsQKQ@mail.gmail.com>
	<CACmBxytiCHjbTpmXmjy8YekB0Sxnzz98bkkoecLVNCM8DxJMrw@mail.gmail.com>
Message-ID: <CAPxHBh84F8pkV=LwSszg57F2T-ZX1e1LO+UmS9_nYoj5tbT9eA@mail.gmail.com>

Kurt,

On Fri, Aug 22, 2014 at 9:07 AM, Kurt Schwehr <schwehr at gmail.com> wrote:

> I've got threading issues on my list of things to investigate with GDAL.
>  I've been running MSAN on GDAL lately and want to get TSAN going too.  I'm
> out on leave this month, but hope to get more into this stuff (testing,
> threading, caching, etc) come October.
>

Just a note, wanted to make sure you were aware of the other email thread
since this diverged from it on accident, also not quite what you mean by
MSAN and TSAN?

If you are interested in helping, I could really use some help on creating
a robust set of test cases for my code.

Thanks,

Blake
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140822/6bae1f6f/attachment.html>

From schwehr at gmail.com  Fri Aug 22 09:27:41 2014
From: schwehr at gmail.com (Kurt Schwehr)
Date: Fri, 22 Aug 2014 09:27:41 -0700
Subject: [gdal-dev] RFC 47 and Threading
In-Reply-To: <CAPxHBh84F8pkV=LwSszg57F2T-ZX1e1LO+UmS9_nYoj5tbT9eA@mail.gmail.com>
References: <CAPxHBh9szm_RmMhNMgTTQFTjc_x=dAndVFPvFXzK+F6nn0nXfg@mail.gmail.com>
	<201408202226.36037.even.rouault@spatialys.com>
	<CAPxHBh9181d_bakm2AksQ7j5C44QzVAuRK+p5QjCJh-s=6Xy3w@mail.gmail.com>
	<CAFOE_BeOCCcXqqYr5k0gB_mV1QqDrkKPjYPakwiNQXsUC==b_g@mail.gmail.com>
	<CAPxHBh8c6vqoKfKyZbHLtOih24j4ZW-VZXZp8qhP84cqOh6aQw@mail.gmail.com>
	<CAFOE_BdahzK4esUa6UTJ=S4pEOFVVqOuGigLc+56YYf=FYsQKQ@mail.gmail.com>
	<CACmBxytiCHjbTpmXmjy8YekB0Sxnzz98bkkoecLVNCM8DxJMrw@mail.gmail.com>
	<CAPxHBh84F8pkV=LwSszg57F2T-ZX1e1LO+UmS9_nYoj5tbT9eA@mail.gmail.com>
Message-ID: <CACmBxytB4v_2ujjdWGL-1gTfX9AkpxfrwtOrteJSY2Z_DDg1ww@mail.gmail.com>

Blake,

With a 2 week old baby, my brain has been soggy.

I do see the 3 threads here:
http://lists.osgeo.org/pipermail/gdal-dev/2014-August/thread.html

The asan/msan/tsan tools are

asan - address sanitizer - https://code.google.com/p/address-sanitizer/
msan - memory sanitizer - https://code.google.com/p/memory-sanitizer/
tsan - thread sanitizer - https://code.google.com/p/thread-sanitizer/

http://llvm.org/devmtg/2012-11/Serebryany-ASAN-TSAN-Poster.pdf
http://llvm.org/devmtg/2012-11/Serebryany_TSan-MSan.pdf
http://llvm.org/devmtg/2013-11/slides/Serebryany-ASAN.pdf

I've been writing C++ tests for gdal/ports for the last year that use
Google's gunit test framework and running the sanitizers on it.  I've got
it high on my todo list to get the tests that I've written pushed to github
in Sept.  It's taken me a lot longer to get done than I expected because of
some internal changes to the CSV file handling (that I've never really
figured out) between 1.10.0 and 1.11.0.  I was hoping to have the tests
working with 1.11.0 before I push them out to the world.  And I need to
create an RFC to get discussion on if / how to put the new test setup into
gdal or refactor the whole deal to be a useful addition to gdal.

I haven't gotten the testing up to a level that would likely be useful to
you, but I can try in a couple weeks when I'm back to normal work.

-kurt



On Fri, Aug 22, 2014 at 9:00 AM, Blake Thompson <flippmoke at gmail.com> wrote:

> Kurt,
>
> On Fri, Aug 22, 2014 at 9:07 AM, Kurt Schwehr <schwehr at gmail.com> wrote:
>
>> I've got threading issues on my list of things to investigate with GDAL.
>>  I've been running MSAN on GDAL lately and want to get TSAN going too.  I'm
>> out on leave this month, but hope to get more into this stuff (testing,
>> threading, caching, etc) come October.
>>
>
> Just a note, wanted to make sure you were aware of the other email thread
> since this diverged from it on accident, also not quite what you mean by
> MSAN and TSAN?
>
> If you are interested in helping, I could really use some help on creating
> a robust set of test cases for my code.
>
> Thanks,
>
> Blake
>
>


-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140822/76198d1b/attachment.html>

From flippmoke at gmail.com  Fri Aug 22 10:06:50 2014
From: flippmoke at gmail.com (Blake Thompson)
Date: Fri, 22 Aug 2014 12:06:50 -0500
Subject: [gdal-dev] RFC 47 and Threading
In-Reply-To: <CACmBxytB4v_2ujjdWGL-1gTfX9AkpxfrwtOrteJSY2Z_DDg1ww@mail.gmail.com>
References: <CAPxHBh9szm_RmMhNMgTTQFTjc_x=dAndVFPvFXzK+F6nn0nXfg@mail.gmail.com>
	<201408202226.36037.even.rouault@spatialys.com>
	<CAPxHBh9181d_bakm2AksQ7j5C44QzVAuRK+p5QjCJh-s=6Xy3w@mail.gmail.com>
	<CAFOE_BeOCCcXqqYr5k0gB_mV1QqDrkKPjYPakwiNQXsUC==b_g@mail.gmail.com>
	<CAPxHBh8c6vqoKfKyZbHLtOih24j4ZW-VZXZp8qhP84cqOh6aQw@mail.gmail.com>
	<CAFOE_BdahzK4esUa6UTJ=S4pEOFVVqOuGigLc+56YYf=FYsQKQ@mail.gmail.com>
	<CACmBxytiCHjbTpmXmjy8YekB0Sxnzz98bkkoecLVNCM8DxJMrw@mail.gmail.com>
	<CAPxHBh84F8pkV=LwSszg57F2T-ZX1e1LO+UmS9_nYoj5tbT9eA@mail.gmail.com>
	<CACmBxytB4v_2ujjdWGL-1gTfX9AkpxfrwtOrteJSY2Z_DDg1ww@mail.gmail.com>
Message-ID: <CAPxHBh-BZRiq2Rw6HwY0Bq5g0v1y2mocrhUrR0eXWRco3MAkwQ@mail.gmail.com>

Kurt,

>
> With a 2 week old baby, my brain has been soggy.
>

Congrats!


>
> I do see the 3 threads here:
> http://lists.osgeo.org/pipermail/gdal-dev/2014-August/thread.html
>
> The asan/msan/tsan tools are
>
> asan - address sanitizer - https://code.google.com/p/address-sanitizer/
> msan - memory sanitizer - https://code.google.com/p/memory-sanitizer/
> tsan - thread sanitizer - https://code.google.com/p/thread-sanitizer/
>
> http://llvm.org/devmtg/2012-11/Serebryany-ASAN-TSAN-Poster.pdf
> http://llvm.org/devmtg/2012-11/Serebryany_TSan-MSan.pdf
> http://llvm.org/devmtg/2013-11/slides/Serebryany-ASAN.pdf
>
> I've been writing C++ tests for gdal/ports for the last year that use
> Google's gunit test framework and running the sanitizers on it.  I've got
> it high on my todo list to get the tests that I've written pushed to github
> in Sept.  It's taken me a lot longer to get done than I expected because of
> some internal changes to the CSV file handling (that I've never really
> figured out) between 1.10.0 and 1.11.0.  I was hoping to have the tests
> working with 1.11.0 before I push them out to the world.  And I need to
> create an RFC to get discussion on if / how to put the new test setup into
> gdal or refactor the whole deal to be a useful addition to gdal.
>
> I haven't gotten the testing up to a level that would likely be useful to
> you, but I can try in a couple weeks when I'm back to normal work.
>
> -kurt
>
>
Using some of these tools/tests would definitely make it easier to perhaps
find issues with multi-threading with all the drivers.

Thanks,

Blake
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140822/566b6637/attachment.html>

From even.rouault at spatialys.com  Fri Aug 22 10:17:15 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 22 Aug 2014 19:17:15 +0200
Subject: [gdal-dev] GRASS gdal and ogr plugins
In-Reply-To: <20140822144951.GA29194@bogodyn.org>
References: <20140822144951.GA29194@bogodyn.org>
Message-ID: <201408221917.15563.even.rouault@spatialys.com>

Tom,

Should be fixed by r27597. This was a side effect of the work done for 
http://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification

Even

> I've just svn updated gdal to r27596 and rebuilt it, grass, and the grass
> plugin and installed them.  I had not previously updated gdal since about
> May 14.
> 
> Now gdalinfo and ogrinfo  are reporting:
> > gdalinfo --formats
> 
> ERROR 1: A non OGR driver is registered with the same name: GRASS
> Supported Formats:
>   GRASS -raster- (ro): GRASS Database Rasters (5.7+)
> ...
> 
> and
> 
> > ogrinfo --formats
> 
> ERROR 1: A non OGR driver is registered with the same name: GRASS
> Supported Formats:
>   PCIDSK -raster,vector- (rw+v): PCIDSK Database File
> ...
> 
> GRASS does not appear here, so clearly the registration of the OGR grass
> plugin is not happening.  The code does not exit abnormally, just prints
> the error message and clearly doesn't have the OGR grass plugin loaded.
> 
> The same happens from applications that are built against the gdal library.
> Normal operation, just no access to GRASS data through OGR.
> 
> Looking at ogr/ogrsf_frmts/generic/ogrsfdriverregistrar.cpp, I'm wondering
> if that's because both the gdal grass driver and ogr driver are returning
> "GRASS" as their name, and the "GRASS" provided by gdal is confusing the
> registrar?  Should the OGR driver maybe have a different name?  Or am I
> completely off the mark?
> 
> I do note that the change in ogrsfdriverregistrar.cpp that introduced the
> error message was dated 24 May 2014, just 10 days after I had last built
> gdal on this machine.  The previous build would report "GRASS" as an
> available format from OGR.
> 
> I'm using grass off of the "develbranch_6" branch, updated right before I
> built the gdal plugin.
> 
> I build the gdal plugin so:
>   build and install gdal without GRASS support
>   build GRASS and install it
>   build the plugin:
>   cd /.../gdal/frmts/grass/pkg
>   ln -s ../grass57dataset.cpp .
>   ln -s ../../../ogr/ogrsf_frmts/grass/ogrgrassdriver.cpp .
>   ln -s ../../../ogr/ogrsf_frmts/grass/ogrgrassdatasource.cpp .
>   ln -s ../../../ogr/ogrsf_frmts/grass/ogrgrasslayer.cpp .
>   ln -s ../../../ogr/ogrsf_frmts/grass/ogrgrass.h .
>   ./configure --with-gdal=/usr/local/bin/gdal-config
> --with-grass=/usr/local/grass-6.5.svn
> --with-autoload=/usr/local/lib/gdalplugins gmake
>   sudo gmake install
> 
> The result is gdal_GRASS.so and ogr_GRASS.so in /usr/local/lib/gdalplugins.
> 
> Am I simply building the plugin wrong, or is this a bug?

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From russo at bogodyn.org  Fri Aug 22 10:20:36 2014
From: russo at bogodyn.org (Tom Russo)
Date: Fri, 22 Aug 2014 11:20:36 -0600
Subject: [gdal-dev] GRASS gdal and ogr plugins
In-Reply-To: <201408221917.15563.even.rouault@spatialys.com>
References: <20140822144951.GA29194@bogodyn.org>
	<201408221917.15563.even.rouault@spatialys.com>
Message-ID: <20140822172036.GA37310@bogodyn.org>

On Fri, Aug 22, 2014 at 07:17:15PM +0200, we recorded a bogon-computron collision of the <even.rouault at spatialys.com> flavor, containing:
> Tom,
> 
> Should be fixed by r27597. This was a side effect of the work done for 
> http://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification

Indeed, it is fixed by r27597.  So it *was* just a matter of changing the name. 
Thank you.

> > I've just svn updated gdal to r27596 and rebuilt it, grass, and the grass
> > plugin and installed them.  I had not previously updated gdal since about
> > May 14.
> > 
> > Now gdalinfo and ogrinfo  are reporting:
> > > gdalinfo --formats
> > 
> > ERROR 1: A non OGR driver is registered with the same name: GRASS
> > Supported Formats:
> >   GRASS -raster- (ro): GRASS Database Rasters (5.7+)
> > ...
> > 
> > and
> > 
> > > ogrinfo --formats
> > 
> > ERROR 1: A non OGR driver is registered with the same name: GRASS
> > Supported Formats:
> >   PCIDSK -raster,vector- (rw+v): PCIDSK Database File
> > ...
> > 
> > GRASS does not appear here, so clearly the registration of the OGR grass
> > plugin is not happening.  The code does not exit abnormally, just prints
> > the error message and clearly doesn't have the OGR grass plugin loaded.
> > 
> > The same happens from applications that are built against the gdal library.
> > Normal operation, just no access to GRASS data through OGR.
> > 
> > Looking at ogr/ogrsf_frmts/generic/ogrsfdriverregistrar.cpp, I'm wondering
> > if that's because both the gdal grass driver and ogr driver are returning
> > "GRASS" as their name, and the "GRASS" provided by gdal is confusing the
> > registrar?  Should the OGR driver maybe have a different name?  Or am I
> > completely off the mark?
> > 
> > I do note that the change in ogrsfdriverregistrar.cpp that introduced the
> > error message was dated 24 May 2014, just 10 days after I had last built
> > gdal on this machine.  The previous build would report "GRASS" as an
> > available format from OGR.
> > 
> > I'm using grass off of the "develbranch_6" branch, updated right before I
> > built the gdal plugin.
> > 
> > I build the gdal plugin so:
> >   build and install gdal without GRASS support
> >   build GRASS and install it
> >   build the plugin:
> >   cd /.../gdal/frmts/grass/pkg
> >   ln -s ../grass57dataset.cpp .
> >   ln -s ../../../ogr/ogrsf_frmts/grass/ogrgrassdriver.cpp .
> >   ln -s ../../../ogr/ogrsf_frmts/grass/ogrgrassdatasource.cpp .
> >   ln -s ../../../ogr/ogrsf_frmts/grass/ogrgrasslayer.cpp .
> >   ln -s ../../../ogr/ogrsf_frmts/grass/ogrgrass.h .
> >   ./configure --with-gdal=/usr/local/bin/gdal-config
> > --with-grass=/usr/local/grass-6.5.svn
> > --with-autoload=/usr/local/lib/gdalplugins gmake
> >   sudo gmake install
> > 
> > The result is gdal_GRASS.so and ogr_GRASS.so in /usr/local/lib/gdalplugins.
> > 
> > Am I simply building the plugin wrong, or is this a bug?
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com

-- 
Tom Russo    KM5VY   SAR502   DM64ux          http://www.swcp.com/~russo/
Tijeras, NM  QRPL#1592 K2#398  SOC#236        http://kevan.org/brain.cgi?DDTNM
 echo "prpv_a'rfg_cnf_har_cvcr" | sed -e 's/_/ /g' | tr [a-m][n-z] [n-z][a-m]

 



From even.rouault at spatialys.com  Fri Aug 22 11:10:21 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 22 Aug 2014 20:10:21 +0200
Subject: [gdal-dev] RFC 47 and Threading
In-Reply-To: <CAPxHBh_8xHUCSZuT3agiAaWTPku05CpEhDEwt98r0B9c=_V+bQ@mail.gmail.com>
References: <CAPxHBh9szm_RmMhNMgTTQFTjc_x=dAndVFPvFXzK+F6nn0nXfg@mail.gmail.com>
	<CAFLLRpKtRNLs-c_o6H-YU04i0PZEWEetfFzAWjxN_32cnD5aGg@mail.gmail.com>
	<CAPxHBh_8xHUCSZuT3agiAaWTPku05CpEhDEwt98r0B9c=_V+bQ@mail.gmail.com>
Message-ID: <201408222010.21230.even.rouault@spatialys.com>

> > 
> > Quick question - presumably for VRT datasets any source images currently
> > share the global cache and are treated from this proposals' POV as their
> > own "datasets"? As well as the VRT being a separate dataset? If so, seems
> > like this could be quite a major win for users with VRTs for tiled
> > images?
> 
> The GDALRasterBlockManger if done per dataset is a member of the base
> GDALDataset Object, so all inherited classes will have it as well. So yes,
> I believe that should be the case that each seperate dataset in the VRT
> would have its own cache. All of this is assuming you set the global config
> option to use a per dataset cache.

This might be a problem in practice since the amount of cache might grow 
quickly. By default a VRT will open simultaneously up to 
GDAL_MAX_DATASET_POOL_SIZE (whose default is 100, but can be changed at 
runtime with the config option) source datasets.
If you do a gdal_translate of the VRT (and that it has more than 100 sources) 
then you will need 100 * GDAL_CACHEMAX bytes for the cache.
Of course once you are aware of that you can play with both configuration 
options to find the best settings.

> 
> > While it's a lot of code change, it's mostly simple/repeated changes.
> > 
> > > Solution 2 (RW Mutex in GDALRasterBlock)
> > > Cons:
> > > It means that writing a driver is not as trivial as before and care
> > > must
> > 
> > be taken in how locking is done within the driver in order to prevent
> > deadlocks and maintain thread safety.
> > 
> > I'm wary about making drivers more complex, there's a lot of them. And
> > many are unlikely to be tested in multi-threaded anger during initial
> > development (and MT issues can be hard to unit test). Can you explain a
> > bit further what would be the impact for typical driver styles? Can we
> > make the typical case (no/locked multithreaded access) really easy? What
> > sort of driver code would be needed for drivers that can do MT reads? MT
> > reads and writes?
> 
> I completely understand the being wary about making drivers more complex,
> there are a ton of them and I had to edit every single one for my
> implementation of Solution 2. However, I am starting to like this solution
> more and more. The reason that this solution must be this way, is because
> many drivers will call the same block from different bands. This can cause
> deadlocks if not careful because two threads on the same dataset could be
> in the same processes at different times. To fix this I am passing a mutex
> through the IReadBlock, IWriteBlock, and IRasterIO functions. This allows
> for a much more fine level of control over the process. It allows the mutex
> used to protect the Block Data pointer (that is passed through the
> IReadBlock, etc) to be protected only at the times required. For many
> drivers its simply blocking the entire time the reading/writing process is
> occuring.
> 
> Multi-threading reads should be possible in many cases as long as the
> driver code itself is safe for such an implementation. If a locking is used
> to protect the file pointer and only allow a single thread to be reading
> the file from disk at a time in most drivers they should become thread safe
> (also the protection of any global statics in the drivers). This means
> increased complexity in most drivers to make them thread safe, but I think
> it would be possible.

The question is : how many drivers do not require a global lock in their 
IReadBlock() implementation ?

Just throwing an idea : how about a IReadBlock_thread_safe and IReadBlock 
virtual methods ? The first one would have a default implementation in 
GDALRasterBand that would basically call the second one with a global mutex. 
That way drivers that wan't a more fine grained locking could implement their 
own IReadBlock_thread_safe, whereas the ones that don't care would just 
implement IReadBlock. The few current call sites of IReadBlock would just need 
to be updated to call IReadBlock_thread_safe instead.

> 
> Multi-threading writes is a little more complex, and is not well covered in
> these changes. Issues can come up with reading and writing at the same
> time. Here is an example of a complex situation.
> 
> Thread 1: Writes to Block A located at (0,0), this block is then marked for
> deletion from the cache and is intended to be flushed.
> 
> Thread 1: Removes Block A from the Band's block array
> 
> Thread 2: Attempts to Read Block at (0,0). Not finding any blocks it
> creates Block B and inserts it to Band Block Array
> 
> Thread 2: Reads from the driver and loads data into Block B.
> 
> Thread 1: Writes data from Block A which is being flushed to the driver.
> 
> Thread 2: Edits Block B, but incorrectly because the changes from Block A
> are not included.
> 
> I think that this can be corrected in the code by always requiring that all
> flushing through the driver occurs prior to removing the block from the
> block array. Just checked my code and this is possible right now in
> Solution #2, so it might need to be something that I should fix.
> 
> In a more generally large issue, there are issues with even more simple
> things with writing. Imagine someone warping into a band at the same time a
> fill operation on a band is being executed, if there is no protection it
> would end up with a weird set of values. Personally I think this, is
> something we shouldn't attempt to fix currently as this should just be
> accepted as a bad way to write a multi-threaded application.

Agreed.

> If you can
> think of any other situations where writing might have issues I really
> would like to know.
> 
> Thanks,
> 
> Blake

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Aug 22 11:33:16 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 22 Aug 2014 20:33:16 +0200
Subject: [gdal-dev] RFC 47 and Threading
In-Reply-To: <CAPxHBh8QSsqN2K5tTctMG+mzv_Eo0BrcY-WQ23H-FF305ew8pA@mail.gmail.com>
References: <CAPxHBh8QSsqN2K5tTctMG+mzv_Eo0BrcY-WQ23H-FF305ew8pA@mail.gmail.com>
Message-ID: <201408222033.16308.even.rouault@spatialys.com>

Le vendredi 22 ao?t 2014 17:53:50, Blake Thompson a ?crit :
> Jeff,
> 
> Thanks Blake for the detailed response. I did not realize that I did not do
> 
> > a reply all in my previous email I sent.
> 
> Not an issue, glad you guys are interested in my changes.
> 
> > --> I thought that this was not possible using current trunk GDAL because
> > of the global cache. At least the writing side using multiple threads can
> > cause issues.
> > See this response on a older topic I found in GDAL dev list:
> > http://lists.osgeo.org/pipermail/gdal-dev/2013-January/035215.html
> > The response there was for a similar question as the one i posted about
> > supporting of batch translating of dataset with this RFC .
> 
> I do believe it is possible in the current trunk of GDAL (and I have
> written some code to do it with out seeing any issues). There is a "lock"
> on raster blocks currently that prevents them from being removed from the
> cache if they are currently be utilized.
> 
> > --> Ok, I was under the wrong impression that in addition of  a cache per
> > dataset there is still a cap of global cache that oversee the total cache
> > used by GDAL.
> 
> This really isn't possible, because if something needs to be removed from
> the cache and there is nothing to remove from the current dataset, it would
> have to go to another dataset to lower the cache size. At this point the
> per dataset cache really has limited meaning, because a lot of the same
> issues will occur.
> 
> --> Is this mean that in addition of the per dataset cache once can still
> 
> > use the global cache (only not per dataset one) and have the scenario of
> > translating multiple datasets in a parallel way
> > works ok (without threading issues due to current implementation global
> > cache).
> 
> Yes, it will work to translate multiple datasets in a parallel way with a
> global cache.

Note: after re-reading, I realize that I misread your above sentence as "it 
will work to translate multiple datasets in a parallel way with a *per-
dataset* cache").

So, even if you didn't write it, I'm afraid that people will assume that 
calling CreateCopy() on the same source dataset handle would be thread-safe 
(imagine that one thread translates to format F1, while the other one to 
format F2), whereas in the current state of the RFC it is not. Because 
CreateCopy() will call GetGeoTransform(), GetProjectionRef() etc which are 
generally thread unsafe. For example GTiff has a lazy loading approach for 
those 2 methods, and it is not the only one.

If we claim thread-safety, we should likely offer full thread-safety (at least 
in reading scenarios), not partial one. Otherwise I'm afraid no one but the 
few people that have taken part to that discussion or read the RFC will know 
the limits.
I'm wondering if it wouldn't be worth having GDALDatasetThreadSafe and 
GDALRasterBandThreadSafe classes (or whatever name is appropriate), that would 
follow the decorator pattern, i.e. they will own a thread unsafe "real" 
dataset/band and override the methods to lock them. Similarly to what I have 
done in OGR with ogr/ogrsf_frmts/generic/ogrmutexeddatasource.cpp and 
ogrmutexedlayer.cpp, needed for the FGDB driver (the one that depends on the 
ESRI SDK).

My idea would be to have an open flag GDAL_OF_THREADSAFE for GDALOpenEx().
When set, GDALOpen() would do the usual job and get a (in most cases) unsafe 
dataset object. Then it would query a virtual method of the dataset to return 
a thread-safe version of it (GetThreadSafe()).
- If not defined by the driver, the base implementation of GetThreadSafe() 
would return the dataset wrapped in GDALDatasetThreadSafe
- If the implementation of the dataset is already thread-safe, it's 
GetThreadSafe() would return just self
- For the in-between situations, it could for example override 
GDALDatasetThreadSafe/GDALRasterBandThreadSafe base implementation to 
specialize the methods that don't need locking.

This idea might not work (and I've not though how it would combine with my 
previous IReadBlock_thread_safe/IReadBlock approach). I have just written it 
as it came to my mind. The main motivation is to make it easy to have thread-
safe versions by default, without the driver having to care about that, while 
being flexible to make drivers that need finer control to do it.

If, through benchmark, we determine that the cost of the thread safe version 
is neglectable, then GDAL_OF_THREADSAFE might be useless, and GDALOpen() would 
always return the thread-safe version.


> 
> Thanks,
> 
> Blake

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From flippmoke at gmail.com  Fri Aug 22 12:34:49 2014
From: flippmoke at gmail.com (Blake Thompson)
Date: Fri, 22 Aug 2014 14:34:49 -0500
Subject: [gdal-dev] RFC 47 and Threading
In-Reply-To: <201408222010.21230.even.rouault@spatialys.com>
References: <CAPxHBh9szm_RmMhNMgTTQFTjc_x=dAndVFPvFXzK+F6nn0nXfg@mail.gmail.com>
	<CAFLLRpKtRNLs-c_o6H-YU04i0PZEWEetfFzAWjxN_32cnD5aGg@mail.gmail.com>
	<CAPxHBh_8xHUCSZuT3agiAaWTPku05CpEhDEwt98r0B9c=_V+bQ@mail.gmail.com>
	<201408222010.21230.even.rouault@spatialys.com>
Message-ID: <CAPxHBh-G5KGHXz9B6W+Rf5k_P_7ToSC+GsPyyZgLvhesYgrswA@mail.gmail.com>

Even,


> This might be a problem in practice since the amount of cache might grow
> quickly. By default a VRT will open simultaneously up to
> GDAL_MAX_DATASET_POOL_SIZE (whose default is 100, but can be changed at
> runtime with the config option) source datasets.
> If you do a gdal_translate of the VRT (and that it has more than 100
> sources)
> then you will need 100 * GDAL_CACHEMAX bytes for the cache.
> Of course once you are aware of that you can play with both configuration
> options to find the best settings.
>

This is one of the reasons I would perfer to use my solution #1 or #2
rather then just adding the per dataset cache as we originally spoke about
during the original development. I think we should try to preserve the
global cache in some situations but still have good performance.


> Just throwing an idea : how about a IReadBlock_thread_safe and IReadBlock
> virtual methods ? The first one would have a default implementation in
> GDALRasterBand that would basically call the second one with a global
> mutex.
> That way drivers that wan't a more fine grained locking could implement
> their
> own IReadBlock_thread_safe, whereas the ones that don't care would just
> implement IReadBlock. The few current call sites of IReadBlock would just
> need
> to be updated to call IReadBlock_thread_safe instead.


I originally thought about such a solution, but I decided instead on the
using of the default IReadBlock paramter  'void ** phMutex = NULL'. If the
pointer pointer of the mutex is NULL, then no mutex is created and locking
does not occur. Honestly as well when I was originally doing this, I was
not sure which drivers would have even needed such a IReadBlock_thread_safe
implementation. Therefore, I decide the best way in Solution #2 was to
simply just walk through each of the implementations of and find where
exactly I need to protect the data pointer.

I have a mixed feelings on both methods. I feel like the
IReadBlock_thread_safe implementation might make people writing new drivers
feel like they do not have to work about thread safety when they are
comparing the code to other drivers? I somewhat like that idea that drivers
should consider their thread safety. Lots of drivers seem to call RasterIO
as well, which would that need a RasterIO_thread_safe method? That might
make that code more complex? Not quite sure, will have to think it all out.

Thanks,

Blake
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140822/a9d93b24/attachment.html>

From flippmoke at gmail.com  Fri Aug 22 12:50:56 2014
From: flippmoke at gmail.com (Blake Thompson)
Date: Fri, 22 Aug 2014 14:50:56 -0500
Subject: [gdal-dev] RFC 47 and Threading
In-Reply-To: <201408222033.16308.even.rouault@spatialys.com>
References: <CAPxHBh8QSsqN2K5tTctMG+mzv_Eo0BrcY-WQ23H-FF305ew8pA@mail.gmail.com>
	<201408222033.16308.even.rouault@spatialys.com>
Message-ID: <CAPxHBh_W49VAfP5pdFgEWZFy3KrRH1LBSLCv5Mgy+OPyQYcvZw@mail.gmail.com>

Even,

On Fri, Aug 22, 2014 at 1:33 PM, Even Rouault <even.rouault at spatialys.com>
wrote:
>
>
> Note: after re-reading, I realize that I misread your above sentence as "it
> will work to translate multiple datasets in a parallel way with a *per-
> dataset* cache").
>
> So, even if you didn't write it, I'm afraid that people will assume that
> calling CreateCopy() on the same source dataset handle would be thread-safe
> (imagine that one thread translates to format F1, while the other one to
> format F2), whereas in the current state of the RFC it is not. Because
> CreateCopy() will call GetGeoTransform(), GetProjectionRef() etc which are
> generally thread unsafe. For example GTiff has a lazy loading approach for
> those 2 methods, and it is not the only one.



If we claim thread-safety, we should likely offer full thread-safety (at
> least
> in reading scenarios), not partial one. Otherwise I'm afraid no one but the
> few people that have taken part to that discussion or read the RFC will
> know
> the limits.
>

Perhaps the goal of the RFC should be to allow CreateCopy to be threadsafe?
I have no tried yet to venture into other parts of thread safety on the
dataset (already bit off a very large chunk).


> I'm wondering if it wouldn't be worth having GDALDatasetThreadSafe and
> GDALRasterBandThreadSafe classes (or whatever name is appropriate), that
> would
> follow the decorator pattern, i.e. they will own a thread unsafe "real"
> dataset/band and override the methods to lock them. Similarly to what I
> have
> done in OGR with ogr/ogrsf_frmts/generic/ogrmutexeddatasource.cpp and
> ogrmutexedlayer.cpp, needed for the FGDB driver (the one that depends on
> the
> ESRI SDK).
>
> My idea would be to have an open flag GDAL_OF_THREADSAFE for GDALOpenEx().
> When set, GDALOpen() would do the usual job and get a (in most cases)
> unsafe
> dataset object. Then it would query a virtual method of the dataset to
> return
> a thread-safe version of it (GetThreadSafe()).
> - If not defined by the driver, the base implementation of GetThreadSafe()
> would return the dataset wrapped in GDALDatasetThreadSafe
> - If the implementation of the dataset is already thread-safe, it's
> GetThreadSafe() would return just self
> - For the in-between situations, it could for example override
> GDALDatasetThreadSafe/GDALRasterBandThreadSafe base implementation to
> specialize the methods that don't need locking.
>
> This idea might not work (and I've not though how it would combine with my
> previous IReadBlock_thread_safe/IReadBlock approach). I have just written
> it
> as it came to my mind. The main motivation is to make it easy to have
> thread-
> safe versions by default, without the driver having to care about that,
> while
> being flexible to make drivers that need finer control to do it.
>

This approach worries me, there is already a lot of inheritance of the
GDALDataset, its really hard to learn already. Adding another layer would
make it even harder to maintain in my opinion. It also provides one more
config option in an already overwhelming number of config options. I think
we might be better off if we made a long term plan on how we wanted to make
GDAL thread safe. Perhaps make a list of parts needing thread safety and
progress towards it over a period of time. As part of it maintain a webpage
that describes what is thread safe currently, so people are not confused on
what is and is not thread safe.


> If, through benchmark, we determine that the cost of the thread safe
> version
> is neglectable, then GDAL_OF_THREADSAFE might be useless, and GDALOpen()
> would
> always return the thread-safe version.


I wish there were lots of benchmarks in the test suite (if there are, I
don't know where they are), so that we can even roughly measure changes to
the internals of the library. (I realize this is something that could be
difficult to do well).

Thanks,

Blake
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140822/54c73331/attachment.html>

From even.rouault at spatialys.com  Fri Aug 22 12:55:34 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 22 Aug 2014 21:55:34 +0200
Subject: [gdal-dev] RFC 47 and Threading
In-Reply-To: <CAPxHBh-G5KGHXz9B6W+Rf5k_P_7ToSC+GsPyyZgLvhesYgrswA@mail.gmail.com>
References: <CAPxHBh9szm_RmMhNMgTTQFTjc_x=dAndVFPvFXzK+F6nn0nXfg@mail.gmail.com>
	<201408222010.21230.even.rouault@spatialys.com>
	<CAPxHBh-G5KGHXz9B6W+Rf5k_P_7ToSC+GsPyyZgLvhesYgrswA@mail.gmail.com>
Message-ID: <201408222155.34437.even.rouault@spatialys.com>

Le vendredi 22 ao?t 2014 21:34:49, Blake Thompson a ?crit :
> Even,
> 
> > This might be a problem in practice since the amount of cache might grow
> > quickly. By default a VRT will open simultaneously up to
> > GDAL_MAX_DATASET_POOL_SIZE (whose default is 100, but can be changed at
> > runtime with the config option) source datasets.
> > If you do a gdal_translate of the VRT (and that it has more than 100
> > sources)
> > then you will need 100 * GDAL_CACHEMAX bytes for the cache.
> > Of course once you are aware of that you can play with both configuration
> > options to find the best settings.
> 
> This is one of the reasons I would perfer to use my solution #1 or #2
> rather then just adding the per dataset cache as we originally spoke about
> during the original development. 

Ok.

> I think we should try to preserve the
> global cache in some situations but still have good performance.
> 
> > Just throwing an idea : how about a IReadBlock_thread_safe and IReadBlock
> > virtual methods ? The first one would have a default implementation in
> > GDALRasterBand that would basically call the second one with a global
> > mutex.
> > That way drivers that wan't a more fine grained locking could implement
> > their
> > own IReadBlock_thread_safe, whereas the ones that don't care would just
> > implement IReadBlock. The few current call sites of IReadBlock would just
> > need
> > to be updated to call IReadBlock_thread_safe instead.
> 
> I originally thought about such a solution, but I decided instead on the
> using of the default IReadBlock paramter  'void ** phMutex = NULL'. If the
> pointer pointer of the mutex is NULL, then no mutex is created and locking
> does not occur. Honestly as well when I was originally doing this, I was
> not sure which drivers would have even needed such a IReadBlock_thread_safe
> implementation. Therefore, I decide the best way in Solution #2 was to
> simply just walk through each of the implementations of and find where
> exactly I need to protect the data pointer.
> 
> I have a mixed feelings on both methods. I feel like the
> IReadBlock_thread_safe implementation might make people writing new drivers
> feel like they do not have to work about thread safety when they are
> comparing the code to other drivers?

The naming is perhaps not well choosen, but the documentation of the contract 
of this API should make it clear on what an implementation should do and what 
it should not do.

You didn't answer my question on how many drivers can have a non-blocking 
IReadBlock() implementation in practice. My intutition (reinforced by skimming 
through https://github.com/OSGeo/gdal/pull/39/files) is just/mostly MEMDataset. 
So people looking at drivers would just see the classical IReadBlock() 
implementation and wouldn't have to think a lot about thread safety (that 
would be brought by the generic GDALRasterBand::IReadBlock_thread_safe()).

> I somewhat like that idea that drivers
> should consider their thread safety.

I somewhat like the idea they shouldn't have to bother about that ;-) 
especially if we can have improvements in core only that improve thread-safe 
usage and performance. The people wanting to gain one more extra % of 
performance might take the risk of doing a custom thread-safe implementation 
in the driver.

> Lots of drivers seem to call RasterIO
> as well, which would that need a RasterIO_thread_safe method?

Yes, likely.

> That might
> make that code more complex? Not quite sure, will have to think it all out.

Well, you would implement either the classical or _thread_safe version, not 
both. But there are perhaps practical reasons for which this suggestion 
wouldn't work.

> 
> Thanks,
> 
> Blake

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at mmmtike.fi  Fri Aug 22 13:08:09 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Fri, 22 Aug 2014 20:08:09 +0000 (UTC)
Subject: [gdal-dev] Something odd with Natural Earth projection
Message-ID: <loom.20140822T215915-760@post.gmane.org>

Hi,

There is a funny, reproducible case with good screen captures in
Stackexchange. The World, when reprojected from EPSG:4326 into Natural Earth
projection with GDAL is almost perfect. However, it looks like sharks have
been biting four bits from the corners.

http://gis.stackexchange.com/questions/111320/reprojecting-natural-earth-raster-into-natearth-projection-with-gdalwarp-causing/111437#111437

-Jukka Rahkonen-


From even.rouault at spatialys.com  Fri Aug 22 13:12:57 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 22 Aug 2014 22:12:57 +0200
Subject: [gdal-dev] RFC 47 and Threading
In-Reply-To: <CAPxHBh_W49VAfP5pdFgEWZFy3KrRH1LBSLCv5Mgy+OPyQYcvZw@mail.gmail.com>
References: <CAPxHBh8QSsqN2K5tTctMG+mzv_Eo0BrcY-WQ23H-FF305ew8pA@mail.gmail.com>
	<201408222033.16308.even.rouault@spatialys.com>
	<CAPxHBh_W49VAfP5pdFgEWZFy3KrRH1LBSLCv5Mgy+OPyQYcvZw@mail.gmail.com>
Message-ID: <201408222212.57922.even.rouault@spatialys.com>

Le vendredi 22 ao?t 2014 21:50:56, Blake Thompson a ?crit :
> Even,
> 
> On Fri, Aug 22, 2014 at 1:33 PM, Even Rouault <even.rouault at spatialys.com>
> 
> wrote:
> > Note: after re-reading, I realize that I misread your above sentence as
> > "it will work to translate multiple datasets in a parallel way with a
> > *per- dataset* cache").
> > 
> > So, even if you didn't write it, I'm afraid that people will assume that
> > calling CreateCopy() on the same source dataset handle would be
> > thread-safe (imagine that one thread translates to format F1, while the
> > other one to format F2), whereas in the current state of the RFC it is
> > not. Because CreateCopy() will call GetGeoTransform(),
> > GetProjectionRef() etc which are generally thread unsafe. For example
> > GTiff has a lazy loading approach for those 2 methods, and it is not the
> > only one.
> 
> If we claim thread-safety, we should likely offer full thread-safety (at
> 
> > least
> > in reading scenarios), not partial one. Otherwise I'm afraid no one but
> > the few people that have taken part to that discussion or read the RFC
> > will know
> > the limits.
> 
> Perhaps the goal of the RFC should be to allow CreateCopy to be threadsafe?
> I have no tried yet to venture into other parts of thread safety on the
> dataset (already bit off a very large chunk).
> 
> > I'm wondering if it wouldn't be worth having GDALDatasetThreadSafe and
> > GDALRasterBandThreadSafe classes (or whatever name is appropriate), that
> > would
> > follow the decorator pattern, i.e. they will own a thread unsafe "real"
> > dataset/band and override the methods to lock them. Similarly to what I
> > have
> > done in OGR with ogr/ogrsf_frmts/generic/ogrmutexeddatasource.cpp and
> > ogrmutexedlayer.cpp, needed for the FGDB driver (the one that depends on
> > the
> > ESRI SDK).
> > 
> > My idea would be to have an open flag GDAL_OF_THREADSAFE for
> > GDALOpenEx(). When set, GDALOpen() would do the usual job and get a (in
> > most cases) unsafe
> > dataset object. Then it would query a virtual method of the dataset to
> > return
> > a thread-safe version of it (GetThreadSafe()).
> > - If not defined by the driver, the base implementation of
> > GetThreadSafe() would return the dataset wrapped in
> > GDALDatasetThreadSafe
> > - If the implementation of the dataset is already thread-safe, it's
> > GetThreadSafe() would return just self
> > - For the in-between situations, it could for example override
> > GDALDatasetThreadSafe/GDALRasterBandThreadSafe base implementation to
> > specialize the methods that don't need locking.
> > 
> > This idea might not work (and I've not though how it would combine with
> > my previous IReadBlock_thread_safe/IReadBlock approach). I have just
> > written it
> > as it came to my mind. The main motivation is to make it easy to have
> > thread-
> > safe versions by default, without the driver having to care about that,
> > while
> > being flexible to make drivers that need finer control to do it.
> 
> This approach worries me, there is already a lot of inheritance of the
> GDALDataset, its really hard to learn already.

Well, the learning phase would be only be people who want to tweak thread 
safety of their drivers, i.e. not a lot of people I bet. The user wouldn't 
have to pay a lot (just specifying GDAL_OF_THREADSAFE, or nothing at all if 
the price of thread safety is not too big)

> Adding another layer would
> make it even harder to maintain in my opinion. It also provides one more
> config option in an already overwhelming number of config options. I think
> we might be better off if we made a long term plan on how we wanted to make
> GDAL thread safe. Perhaps make a list of parts needing thread safety and
> progress towards it over a period of time. As part of it maintain a webpage
> that describes what is thread safe currently, so people are not confused on
> what is and is not thread safe.

People are already confused... and have a hard-time really understanding the 
implication of the few lines at 
http://trac.osgeo.org/gdal/wiki/FAQMiscellaneous#IstheGDALlibrarythread-safe

I'm afraid more documentation of a more complex situation will not make it 
better. It is not reasonable to have to document that "GetProjectionRef() is 
thread-safe in drivers X and Y, whereas GetGeoTransform() is in Y and Z". 
Because that's the situation we will have for sure if we don't adopt a global 
default mechanism (unless someone spends weeks in adding locks in every 
virtual method of every driver).

The external locking I suggested is not completely a new approach. I could 
mention  Collections.synchronizedList() used in Java to make their List 
implementations thread safe... Sorry for mentionning Java ;-)

The ideal would be to have a solution were by default we have a guarantee 
thread-safety and people (GDAL driver developers) who want to tune it can do 
it if they are brave enough.

> 
> > If, through benchmark, we determine that the cost of the thread safe
> > version
> > is neglectable, then GDAL_OF_THREADSAFE might be useless, and GDALOpen()
> > would
> > always return the thread-safe version.
> 
> I wish there were lots of benchmarks in the test suite (if there are, I
> don't know where they are), 

They don't yet exist. Most code is functionnal code in Python, so not 
appropriate for performance testing, especially regarding threading.
The autotest/cpp should likely be enhanced to have such tests (the only 
performance benchmark I can think of is testperfcopywords that was created to 
justify the templated approach of GDALCopyWords)

To be mentionned, there's also apps/multireadtest.cpp (not compiled by 
default). It just ensures that opening the same file in N dataset objects and 
reading them in N threads works.

> so that we can even roughly measure changes to
> the internals of the library. (I realize this is something that could be
> difficult to do well).
> 
> Thanks,
> 
> Blake

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From flippmoke at gmail.com  Fri Aug 22 13:17:37 2014
From: flippmoke at gmail.com (Blake Thompson)
Date: Fri, 22 Aug 2014 15:17:37 -0500
Subject: [gdal-dev] RFC 47 and Threading
In-Reply-To: <201408222155.34437.even.rouault@spatialys.com>
References: <CAPxHBh9szm_RmMhNMgTTQFTjc_x=dAndVFPvFXzK+F6nn0nXfg@mail.gmail.com>
	<201408222010.21230.even.rouault@spatialys.com>
	<CAPxHBh-G5KGHXz9B6W+Rf5k_P_7ToSC+GsPyyZgLvhesYgrswA@mail.gmail.com>
	<201408222155.34437.even.rouault@spatialys.com>
Message-ID: <CAPxHBh-FEjRwtGE9FXZmBmDBGdRcS6LfUtvbPRfRL_pgZhg6SQ@mail.gmail.com>

Even,

The naming is perhaps not well choosen, but the documentation of the
> contract
> of this API should make it clear on what an implementation should do and
> what
> it should not do.
>

Perhaps it should be reversed? IReadBlock and IReadBlock_not_thread_safe?
(would obviously require lots of changes that way).


>
> You didn't answer my question on how many drivers can have a non-blocking
> IReadBlock() implementation in practice. My intutition (reinforced by
> skimming
> through https://github.com/OSGeo/gdal/pull/39/files) is just/mostly
> MEMDataset.
> So people looking at drivers would just see the classical IReadBlock()
> implementation and wouldn't have to think a lot about thread safety (that
> would be brought by the generic GDALRasterBand::IReadBlock_thread_safe()).
>
>
I honestly have no idea how many drivers can have a non-blocking IReadBlock
with this setup. I really do not understand all the drivers well enough to
give an estimate (so I would assume yours is probably most correct). I have
been mostly concerned with first just making the cache threadsafe, then was
thinking we could start targeting drivers individually.


> > I somewhat like that idea that drivers
> > should consider their thread safety.
>
> I somewhat like the idea they shouldn't have to bother about that ;-)
> especially if we can have improvements in core only that improve
> thread-safe
> usage and performance. The people wanting to gain one more extra % of
> performance might take the risk of doing a custom thread-safe
> implementation
> in the driver.
>

My thought here was more along the lines of "the driver is going to write
to the block cache so it should have the responsibility to lock when it
needs to be locked". To me this was better in some manners then "in most
case implement this method, which if I use improperly might cause deadlocks
or corruptions, otherwise implement this method".

Thanks,

Blake
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140822/cc7732aa/attachment.html>

From even.rouault at spatialys.com  Fri Aug 22 13:46:45 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 22 Aug 2014 22:46:45 +0200
Subject: [gdal-dev] RFC 47 and Threading
In-Reply-To: <CAPxHBh-FEjRwtGE9FXZmBmDBGdRcS6LfUtvbPRfRL_pgZhg6SQ@mail.gmail.com>
References: <CAPxHBh9szm_RmMhNMgTTQFTjc_x=dAndVFPvFXzK+F6nn0nXfg@mail.gmail.com>
	<201408222155.34437.even.rouault@spatialys.com>
	<CAPxHBh-FEjRwtGE9FXZmBmDBGdRcS6LfUtvbPRfRL_pgZhg6SQ@mail.gmail.com>
Message-ID: <201408222246.45872.even.rouault@spatialys.com>

Le vendredi 22 ao?t 2014 22:17:37, Blake Thompson a ?crit :
> Even,
> 
> The naming is perhaps not well choosen, but the documentation of the
> 
> > contract
> > of this API should make it clear on what an implementation should do and
> > what
> > it should not do.
> 
> Perhaps it should be reversed? IReadBlock and IReadBlock_not_thread_safe?
> (would obviously require lots of changes that way).

Yeah, that why was I suggested the reverse ;-) But an automatic renaming 
should be doable.
Another danger of keeping IReadBlock and making it now responsible of ensuring 
its thread safety is for out-of-tree drivers that wouldn't realize they need 
to change something as code would still compile (but it is their business to 
follow GDAL RFCs isn't it ?...)
If we were nice, we would have a dummy IReadBlock() in the interface with a 
change of signature to trigger compilation errors of non-upgraded drivers, and 
IReadBlock_thread_safe, IReadBlock_not_thread_safe.

> 
> > You didn't answer my question on how many drivers can have a non-blocking
> > IReadBlock() implementation in practice. My intutition (reinforced by
> > skimming
> > through https://github.com/OSGeo/gdal/pull/39/files) is just/mostly
> > MEMDataset.
> > So people looking at drivers would just see the classical IReadBlock()
> > implementation and wouldn't have to think a lot about thread safety (that
> > would be brought by the generic
> > GDALRasterBand::IReadBlock_thread_safe()).
> 
> I honestly have no idea how many drivers can have a non-blocking IReadBlock
> with this setup. I really do not understand all the drivers well enough to
> give an estimate (so I would assume yours is probably most correct). 

See one of my previous answers about the fundamental reason why most 
IReadBlock() implementations need a lock around their slowest part : being it 
file access or database access. Honestly, it is not worth just locking the part 
that takes most of the time instead of locking the whole method. It could be 
worth when decompression is involved for example, but in all cases I can think 
of (jpeg2000, jpeg, png, libtiff, ecw, sid, etc...) the I/O part and 
decompression part are done in a single call from GDAL point of view.

> I have
> been mostly concerned with first just making the cache threadsafe, then was
> thinking we could start targeting drivers individually.

The truth is that the majority of drivers are esoteric, whereas perhaps just 
10 are used 90% of the time. So it would be a waste of energy to have to spend 
too much time on the former ones.

> 
> > > I somewhat like that idea that drivers
> > > should consider their thread safety.
> > 
> > I somewhat like the idea they shouldn't have to bother about that ;-)
> > especially if we can have improvements in core only that improve
> > thread-safe
> > usage and performance. The people wanting to gain one more extra % of
> > performance might take the risk of doing a custom thread-safe
> > implementation
> > in the driver.
> 
> My thought here was more along the lines of "the driver is going to write
> to the block cache so it should have the responsibility to lock when it
> needs to be locked". To me this was better in some manners then "in most
> case implement this method, which if I use improperly might cause deadlocks
> or corruptions, otherwise implement this method".

To be pedant, IReadBlock() can be called with any user buffer, not only the one 
of a GDALRasterBlock. Driver writers can currently write a driver without 
knowing much about the block cache mechanism. They just need to know "there's 
something in core that will magically ensure that any RasterIO() is 
transformed in the right sequence of call to my simple IReadBlock()"

Not that I worry much about driver writers, but it seems more elegant to me if 
complexity is in the core rather than popping up in each and every driver.

> 
> Thanks,
> 
> Blake

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From dmorissette at mapgears.com  Fri Aug 22 14:45:07 2014
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Fri, 22 Aug 2014 17:45:07 -0400
Subject: [gdal-dev] Adding a "Commercial support" section on gdal.org?
In-Reply-To: <53F64D02.9080401@stripfamily.net>
References: <20140821144635.oum3mxjt0g0ocs88@webmail.charta.acme.com>	<CACqBkM9HMpqwEVidz2rFqWOu1m-8tXGeiu3fwpLygM28U9Jo5w@mail.gmail.com>	<CA+YzLBfnJgP2QGKLRMuuNbAX_9kZrtwVhWvCTzqWn+0XgNDPfw@mail.gmail.com>
	<53F64D02.9080401@stripfamily.net>
Message-ID: <53F7B9E3.10902@mapgears.com>

I think a commercial support section would be a great idea, but as 
others have said, managing it can be tricky. Not all users know how to 
analyze the list archives to find the best person to help them with a 
specific problem, so this support page would help both the users and the 
service providers to find each other.

I think David's suggestion of self-registration with a flag for 
committers and some objective measures of contributions/participation 
readily available may be the best way to go.

Daniel

On 14-08-21 3:48 PM, David Strip wrote:
> As Frank  wrote, this is a slippery issue. Personally I could be
> comfortable with anything from self-registration to the highly selective
> approach described by Frank. To me, the important issue is making clear
> to a reader of the list what exactly the list means and how to use that
> to interpret the skills of those on the list.
>
> One way to use this list is as a reward to significant contributors to
> project. This would tend to point to those most familiar with the
> internals of the project, as well as having a broad commitment to the
> project and the notion of an open source community.  Of course this
> requires a voting process, presumably by the PSC, which can be
> burdensome and stressful, as Frank notes. While I have found this
> project community to be generally welcoming, open source projects
> somewhat deservedly have a reputation for being insular and hard to
> crack. (For a great read, check out this article.
> <http://www.infoworld.com/t/open-source-software/how-crack-open-source-community-248352?source=IFWNLE_nlt_stradev_2014-08-19>
> Worth reading just for a remarkably intolerant response from Linus
> Torvalds on the merits of C++). A vetted list of names carries an
> implied endorsement, which is valuable to the reader, but carries a risk
> for the committee that chooses the list. (I'm not talking risk in the
> legal sense, though that could occur, I suppose. More the reflection on
> how the community chooses who to include or exclude.)
>
> As the other extreme, we allow anyone to register and hopefully provide
> some guidance in how to choose amongst them. For example, suggest that
> people search the archives of this mailing list to see how often the
> consultant participates. Put a star next to names who have commit
> privileges, perhaps the date the achieved this status, so you can tell
> how long they've been active. There are many ways to objectively
> identify the stronger contributors while remaining open. I am tempted to
> suggest even allowing endorsements, but policing that against spam,
> abuse, fraud is probably more work than it's worth.
>
> My choice leans to an open list of self-registrants with some
> /objective/ measures of their participation, but I'll probably be
> content with whatever the community decides.
>
>
>
> On 8/21/2014 11:02 AM, Frank Warmerdam wrote:
>> Folks,
>>
>> This is a somewhat sticky area, which is why I started just with just
>> the self-registration mechanism on the OSGeo site in the past.
>>
>> A scenario that I could support would be a section somewhat like the
>> postgis.net <http://postgis.net> support list where being added to it
>> needs to be voted on by the PSC.  My criteria as a PSC member would be:
>>
>>  - The organization has made significant contributions to the project
>> (in code, docs, etc)
>>  - The organization has staff that I personally know to be competent
>> GDAL/OGR developers.
>>
>> It is a slippery sort of thing of course.  Subjective, and I would
>> hate to be in the situation where I'm having to vote against an addition.
>>
>> If we were to pursue this I actually think an RFC with an initial list
>> of entries, and some general principles would be appropriate (though
>> additions wouldn't need an RFC - just a up/down vote).
>>
>> My perspective when consulting was that being active on the mailing
>> list, and noting in my email signature that I was available for
>> consulting was enough to give me some profile with those looking for
>> someone.
>>
>> PS. as happy customer of Even's (at Planet Labs) I can strongly
>> endorse him as a consultant!
>>
>> Best regards,
>> Frank
>>
>>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
Daniel Morissette
T: +1 418-696-5056 #201
http://www.mapgears.com/
Provider of Professional MapServer Support since 2000

From JDzialo at edrnet.com  Fri Aug 22 15:13:21 2014
From: JDzialo at edrnet.com (JDzialo John)
Date: Fri, 22 Aug 2014 22:13:21 +0000
Subject: [gdal-dev] GDAL vsicurl with query string
Message-ID: <8a94c9fdaa074f21b8f0dcabbe489f1e@CO1PR07MB281.namprd07.prod.outlook.com>

Hi All,

This is my first post so forgive my noobiness...

We are running a cropping tool that used to access data from a local hard drive and crop images.

Now we want to use s3 as our storage in aws and want to access files through http requests.  Great!  Enter vsicurl.

So when we open our s3 bucket to the world we can easily access our tif images from s3 with a straight url.  For example...

https://test-bucket.s3.amazonaws.com/test/key/value/string/object.tif

This works well using the gdalinfo vsicurl cmd...

gdalinfo /vsicurl/https://test-bucket.s3.amazonaws.com/test/key/value/string/object.tif

However in s3 it is not secure to allow access to everyone on the internet and would rather use a presigned URL that uses a query string to authenticate access to the object.

When sending a request with a query string vsicurl and gdal appear to breakdown and I'm not sure why.

gdalinfo /vsicurl/https://test-bucket.s3.amazonaws.com/test/key/value/string/object.tif?Signature=sdlfkj88345r9&Expires=12300000&AWSAccessKeyID=AKIALKSDJFOILIKJFVOSIDF

Fails saying it's unable to open the file.

Is there a specific way to pass the query string to the VSIL API like when using curl with the -d switch?  Any way to run vsicurl with a query string or something I'm missing?

Thanks for any advice you can throw my way!



John Dzialo | Linux System Administrator
Direct 203.783.8163 | Main 800.352.0050

Environmental Data Resources, Inc.
440 Wheelers Farms Road, Milford, CT 06461
www.edrnet.com<http://www.edrnet.com/> | commonground.edrnet.com<http://commonground.edrnet.com/>

[Description: Description: Description: Description: Description: EDR_logo4color_EDR_only_80px2]

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140822/a0cba72e/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 3837 bytes
Desc: image001.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140822/a0cba72e/attachment-0001.png>

From even.rouault at spatialys.com  Fri Aug 22 15:38:55 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 23 Aug 2014 00:38:55 +0200
Subject: [gdal-dev] GDAL vsicurl with query string
In-Reply-To: <8a94c9fdaa074f21b8f0dcabbe489f1e@CO1PR07MB281.namprd07.prod.outlook.com>
References: <8a94c9fdaa074f21b8f0dcabbe489f1e@CO1PR07MB281.namprd07.prod.outlook.com>
Message-ID: <201408230038.56459.even.rouault@spatialys.com>

Le samedi 23 ao?t 2014 00:13:21, JDzialo John a ?crit :
> Hi All,
> 
> This is my first post so forgive my noobiness...
> 
> We are running a cropping tool that used to access data from a local hard
> drive and crop images.
> 
> Now we want to use s3 as our storage in aws and want to access files
> through http requests.  Great!  Enter vsicurl.
> 
> So when we open our s3 bucket to the world we can easily access our tif
> images from s3 with a straight url.  For example...
> 
> https://test-bucket.s3.amazonaws.com/test/key/value/string/object.tif
> 
> This works well using the gdalinfo vsicurl cmd...
> 
> gdalinfo
> /vsicurl/https://test-bucket.s3.amazonaws.com/test/key/value/string/object
> .tif
> 
> However in s3 it is not secure to allow access to everyone on the internet
> and would rather use a presigned URL that uses a query string to
> authenticate access to the object.
> 
> When sending a request with a query string vsicurl and gdal appear to
> breakdown and I'm not sure why.
> 
> gdalinfo
> /vsicurl/https://test-bucket.s3.amazonaws.com/test/key/value/string/object
> .tif?Signature=sdlfkj88345r9&Expires=12300000&AWSAccessKeyID=AKIALKSDJFOILI
> KJFVOSIDF

I tried the URL in a browser and got a AccessDenied. Was it supposed to work 
or something faked to just give a sense of the kind of URL ? A working example 
would be helpful.

> 
> Fails saying it's unable to open the file.
> 
> Is there a specific way to pass the query string to the VSIL API like when
> using curl with the -d switch?  Any way to run vsicurl with a query string
> or something I'm missing?
> 
> Thanks for any advice you can throw my way!
> 
> 
> 
> John Dzialo | Linux System Administrator
> Direct 203.783.8163 | Main 800.352.0050
> 
> Environmental Data Resources, Inc.
> 440 Wheelers Farms Road, Milford, CT 06461
> www.edrnet.com<http://www.edrnet.com/> |
> commonground.edrnet.com<http://commonground.edrnet.com/>
> 
> [Description: Description: Description: Description: Description:
> EDR_logo4color_EDR_only_80px2]

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Aug 22 16:44:47 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 23 Aug 2014 01:44:47 +0200
Subject: [gdal-dev] Something odd with Natural Earth projection
In-Reply-To: <loom.20140822T215915-760@post.gmane.org>
References: <loom.20140822T215915-760@post.gmane.org>
Message-ID: <201408230144.48044.even.rouault@spatialys.com>

Le vendredi 22 ao?t 2014 22:08:09, Jukka Rahkonen a ?crit :
> Hi,
> 
> There is a funny, reproducible case with good screen captures in
> Stackexchange. The World, when reprojected from EPSG:4326 into Natural
> Earth projection with GDAL is almost perfect. However, it looks like
> sharks have been biting four bits from the corners.
> 
> http://gis.stackexchange.com/questions/111320/reprojecting-natural-earth-ra
> ster-into-natearth-projection-with-gdalwarp-causing/111437#111437

Adding -wo SAMPLE_STEPS=1000 fixes it (1000 is experimentally found. 100 was 
almost perfect, and then I just tried 1000). The default is 21.

The issue here is that the warper process by rectangular regions of the target 
dataset and then tries to find the rectangular region of the source dataset 
that matches. In the corners, which are full of target pixels without any 
valid source pixels, the default sampling logic doesn't manage to identify 
properly the source pixel region due to a too low sampling step.

The higher SAMPLE_STEPS, the slower the warping is (in theory, practical speed 
might depend on situations)

Playing with -wm has possibly an influence on the result too, but that might be 
even more magic to play with that.

> 
> -Jukka Rahkonen-
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From cleo21drakos at gmail.com  Fri Aug 22 20:53:16 2014
From: cleo21drakos at gmail.com (Cleo Drakos)
Date: Sat, 23 Aug 2014 12:53:16 +0900
Subject: [gdal-dev] why gdaldem is not working?
Message-ID: <CAMorJ8F3ArgxH5o8EpqqgnGxLbZWon98_S9ac2nzRv3JS4q-3g@mail.gmail.com>

I have a geotiff file with class values (0, 1,  2, 3, and 4).
I want to show each class as different rgb color.

So, I created the text file (color_relief.txt) which contans the following:

0 55 78 94
1 98 23 64
2 112 35 99
3 34 67 72
4 78 250 60

Then I run the following code using python:

import subprocess
in_file =  'single_band.tif'
text_file = 'color_relief.txt'
gdaldem = 'C:\\Python27\\Lib\\site-packages\\osgeo\\gdaldem.exe'
out_file =  'result.tif'
subprocess.call([gdaldem
,'color-relif',in_file,text_file,out_file,'-exact_color_entry','-b','1'],shell=True)
in_file, out_file = None, None

Unfortunately, no result file is obtained.
What is wrong with my code?

cleo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140823/629be00d/attachment.html>

From lukepinnerau at gmail.com  Sat Aug 23 04:10:53 2014
From: lukepinnerau at gmail.com (Luke)
Date: Sat, 23 Aug 2014 04:10:53 -0700 (PDT)
Subject: [gdal-dev] why gdaldem is not working?
In-Reply-To: <CAMorJ8F3ArgxH5o8EpqqgnGxLbZWon98_S9ac2nzRv3JS4q-3g@mail.gmail.com>
References: <CAMorJ8F3ArgxH5o8EpqqgnGxLbZWon98_S9ac2nzRv3JS4q-3g@mail.gmail.com>
Message-ID: <1408792253412-5157984.post@n6.nabble.com>

You have a typo in your command - the 1st argument should be "color-relief"
not "color-relif".



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-why-gdaldem-is-not-working-tp5157949p5157984.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From cleo21drakos at gmail.com  Sat Aug 23 04:19:01 2014
From: cleo21drakos at gmail.com (Cleo Drakos)
Date: Sat, 23 Aug 2014 20:19:01 +0900
Subject: [gdal-dev] why gdaldem is not working?
In-Reply-To: <1408792253412-5157984.post@n6.nabble.com>
References: <CAMorJ8F3ArgxH5o8EpqqgnGxLbZWon98_S9ac2nzRv3JS4q-3g@mail.gmail.com>
	<1408792253412-5157984.post@n6.nabble.com>
Message-ID: <CAMorJ8G86Z_0ZP5bxqEcS_x+3ur5AXfm-TakGwDFatKvtgMNgA@mail.gmail.com>

Luke,

Thanks indeed.

cleo


On Sat, Aug 23, 2014 at 8:10 PM, Luke <lukepinnerau at gmail.com> wrote:

> You have a typo in your command - the 1st argument should be "color-relief"
> not "color-relif".
>
>
>
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/gdal-dev-why-gdaldem-is-not-working-tp5157949p5157984.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140823/489652b8/attachment.html>

From mccorb at cox.net  Sun Aug 24 06:24:55 2014
From: mccorb at cox.net (mccorb)
Date: Sun, 24 Aug 2014 06:24:55 -0700 (PDT)
Subject: [gdal-dev] getting the Layer id or index from a Feature object
Message-ID: <1408886695473-5158041.post@n6.nabble.com>

Is there anything in the Feature object which contains the layer id/index
which it is in? 

I was thinking I could carry around the Feature and then when I wanted to
update any of the geometry or FielfDefn items I could just call
setField/unsetField but it appears I need to also call Layer.setFeature(...)
to actually save it back to the file after I modify the feature. 

Anyway, I just need to know if I need to carry the layer id along everywhere
or I can get it from the Feature instance. I am using Java API if that makes
any difference.

Thanks.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/getting-the-Layer-id-or-index-from-a-Feature-object-tp5158041.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Sun Aug 24 08:46:45 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 24 Aug 2014 17:46:45 +0200
Subject: [gdal-dev] getting the Layer id or index from a Feature object
In-Reply-To: <1408886695473-5158041.post@n6.nabble.com>
References: <1408886695473-5158041.post@n6.nabble.com>
Message-ID: <201408241746.45427.even.rouault@spatialys.com>

Le dimanche 24 ao?t 2014 15:24:55, mccorb a ?crit :
> Is there anything in the Feature object which contains the layer id/index
> which it is in?
> 
> I was thinking I could carry around the Feature and then when I wanted to
> update any of the geometry or FielfDefn items I could just call
> setField/unsetField but it appears I need to also call
> Layer.setFeature(...) to actually save it back to the file after I modify
> the feature.
> 
> Anyway, I just need to know if I need to carry the layer id along
> everywhere or I can get it from the Feature instance. I am using Java API
> if that makes any difference.

There's no direct way of retrieving the Layer. But you can iterate over layers 
and test feature.GetDefnRef().equals(layer.GetLayerDefn())

> 
> Thanks.
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/getting-the-Layer-id-or-index-from-a-F
> eature-object-tp5158041.html Sent from the GDAL - Dev mailing list archive
> at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From robert.coup at koordinates.com  Sun Aug 24 20:45:52 2014
From: robert.coup at koordinates.com (Robert Coup)
Date: Mon, 25 Aug 2014 15:45:52 +1200
Subject: [gdal-dev] JPEG in GeoTIFF + Masks
Message-ID: <CAFLLRpLm5Fifbu4gp_fT1qdTWc+N_Z+kMF3bRj+4k4qqrzvtUw@mail.gmail.com>

Hi folks,

After a bit of advice...

JPEG compression is fast and pretty space-efficient for raster imagery. But
it's RGB-only.
JPEG2000 supports RGBA, has built-in overviews, but it can be slow &
CPU-hungry.
TIFF with deflate/lzw supports RGBA but is big for imagery.

For simple RGB originals where imagery is later reprojected, all the alpha
band in the reprojected version ends up being is a boolean mask with a 0
(nodata) or 255 (data) value.

Ideally I want something that is JPEG compressed images, has an alpha band
mask, and where I can create overviews.

http://www.gdal.org/frmt_gtiff.html talks about internal nodata masks,
which sounds relevant, but doesn't really explain how to create them or how
they work? I'm guessing here, but there's a normal tiled JPEG image in the
TIFF file, and a tiled mask band with 1bpp, which could presumably be
compressed further with deflate/etc too. And at read-time they could come
out as RGBA?

For mosaicing ... are they supported by overviews and VRTs in a sensible
way? For VRTs - the internal nodata value (no data in this pixel) would
need to match the VRT nodata (no tile in this area). Last time I tried
creating overviews for JPEG-in-TIFF alpha/nodata was handled bizarrely, but
that could be all fixed by now.

Is there a way to convert a masked TIFF to a vanilla RGBA TIFF image for
previewing in eg. image editing software?

Talking more about JPEG-in-TIFF, the docs say:

> When translating a RGB image to JPEG-In-TIFF, using PHOTOMETRIC=YCBCR can
make the size of the image typically 2 to 3 times smaller than the default
photometric value (RGB). When using PHOTOMETRIC=YCBCR, the INTERLEAVE
option must be kept to its default value (PIXEL), otherwise libtiff will
fail to compress the data.

Does interleave=pixel affect read performance cf =band for a RGB JPEG? It's
within a tiled tiff and JPEG compression is both 3-band & tiled, so I'm not
really sure where the interleaving fits in?

Thanks,

Rob :)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140825/4258184c/attachment.html>

From tomerlieber at gmail.com  Sun Aug 24 23:55:13 2014
From: tomerlieber at gmail.com (Tomer)
Date: Sun, 24 Aug 2014 23:55:13 -0700 (PDT)
Subject: [gdal-dev] Converting MDB File With Unicode Characters
Message-ID: <1408949713323-5158087.post@n6.nabble.com>

Hey, 

I'm using C# wrapper of GDAL and I'm having a problem converting MDB file
that contains unicode characters. 

Lets take for example conversion to KML file, non-English characters are
replaced by '?' 

How do I solve it?



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Converting-MDB-File-With-Unicode-Characters-tp5158087.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Mon Aug 25 02:22:30 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 25 Aug 2014 11:22:30 +0200
Subject: [gdal-dev] JPEG in GeoTIFF + Masks
In-Reply-To: <CAFLLRpLm5Fifbu4gp_fT1qdTWc+N_Z+kMF3bRj+4k4qqrzvtUw@mail.gmail.com>
References: <CAFLLRpLm5Fifbu4gp_fT1qdTWc+N_Z+kMF3bRj+4k4qqrzvtUw@mail.gmail.com>
Message-ID: <1408958550.53fb005693a55@imp.free.fr>

Hi Robert,

> Hi folks,
>
> After a bit of advice...
>
> JPEG compression is fast and pretty space-efficient for raster imagery. But
> it's RGB-only.

You could do 'gdal_translate rgba.tif rgba_jpeg.tif -co COMPRESS=JPEG' but
that's not what you want, since the alpha band would be JPEG compressed too,
leading to undesired artifacts when reading it.

> JPEG2000 supports RGBA, has built-in overviews, but it can be slow &
> CPU-hungry.
> TIFF with deflate/lzw supports RGBA but is big for imagery.
>
> For simple RGB originals where imagery is later reprojected, all the alpha
> band in the reprojected version ends up being is a boolean mask with a 0
> (nodata) or 255 (data) value.
>
> Ideally I want something that is JPEG compressed images, has an alpha band
> mask, and where I can create overviews.
>
> http://www.gdal.org/frmt_gtiff.html talks about internal nodata masks,
> which sounds relevant, but doesn't really explain how to create them or how
> they work? I'm guessing here, but there's a normal tiled JPEG image in the
> TIFF file, and a tiled mask band with 1bpp, which could presumably be
> compressed further with deflate/etc too.

Exactly that. In TIFF, internal mask bands are secondary 'directories' that are
tiled, 1bpp and deflate compressed.
See references to 'Transparency mask' in
http://partners.adobe.com/public/developer/en/tiff/TIFF6.pdf

To transform a RGBA into a RGB JPEG-in-TIFF+internal_mask_band

gdal_translate rgba.tif rgbmask.tif -b 1 -b 2 -b 3 -mask 4 -co TILED=YES -co
COMPRESSS=JPEG --config GDAL_TIFF_INTERNAL_MASK YES [-co PHOTOMETRIC=YCBCR]

If you don't specify  --config GDAL_TIFF_INTERNAL_MASK YES, a .msk file
according to http://trac.osgeo.org/gdal/wiki/rfc15_nodatabitmask will be
produced

> And at read-time they could come
> out as RGBA?

Hum, no. They will be seen as a per-dataset mask band, but not as a standalone
alpha band.

Actually the good habit would be to use GetMaskBand() systematically on a
dataset, since it can deal with
'real' alpha bands, dedicated mask bands, implicit mask bands when a NoData is
set, etc... (see
'Default GetMaskBand() / GetMaskFlags() Implementation' of above mentionned
RFC15)

>
> For mosaicing ... are they supported by overviews and VRTs in a sensible
> way? For VRTs - the internal nodata value (no data in this pixel) would
> need to match the VRT nodata (no tile in this area). Last time I tried
> creating overviews for JPEG-in-TIFF alpha/nodata was handled bizarrely, but
> that could be all fixed by now.

VRT currently takes the last source to impose its values over the sources that
it may overlap and that are mentionned before in the VRT description. Including
alpha or mask band. This is admitedly quite a surprising behaviour, that would
probably worth an enhancement.

But you can use gdalwarp to do mosaic with sources with mask band. It should
handle them similarly to source alpha bands.
Regarding output, gdalwarp currently only knows how to generate alpha band, not
per-dataset mask bands. But with above gdal_translate, you can do that as a
post-processing.

gdaladdo should also do a sensible use of source mask bands (since it actually
use GetMaskBand()), and generate overviews of mask bands (you probably need to
set again --config GDAL_TIFF_INTERNAL_MASK YES if your source has internal mask
band, not sure if it still needed)

>
> Is there a way to convert a masked TIFF to a vanilla RGBA TIFF image for
> previewing in eg. image editing software?

Sure ! gdal_translate rgbmask.tif rgba.tif -b 1 -b 2 -b 3 -b mask

>
> Talking more about JPEG-in-TIFF, the docs say:
>
> > When translating a RGB image to JPEG-In-TIFF, using PHOTOMETRIC=YCBCR can
> make the size of the image typically 2 to 3 times smaller than the default
> photometric value (RGB). When using PHOTOMETRIC=YCBCR, the INTERLEAVE
> option must be kept to its default value (PIXEL), otherwise libtiff will
> fail to compress the data.
>
> Does interleave=pixel affect read performance cf =band for a RGB JPEG? It's
> within a tiled tiff and JPEG compression is both 3-band & tiled, so I'm not
> really sure where the interleaving fits in?

INTERLEAVE=PIXEL means that structure "R1G1B1,R2G2B2,etc..." (packed as strips
or tiles depending on layout selected with TILED)
INTERLEAVE=BAND means that structure "R1,R2,R3.....", later in the file
"G1,G2,G3,....", later in the file "B1,B2,B3......"

With JPEG compression, that's similar. The result is of course not the RGB
values, but their equivalent after DCT transform, quantization and Huffman
compression. But the layout is similar.

For YCbCr, as there is a subsampling of Cb and Cr components, you cannot
(reasonably) have INTERLEAVE=BAND. The components must be passed together to
libjpeg.

INTERLEAVE=PIXEL is actually the default used by GDAL when creating GTiff. It is
a reasonable one since when you have RGB imagery, you generally need to access
the 3 components of a pixel.

INTERLEAVE=BAND is more suite for scientific data, with many bands, where
accessing only once makes sense depending on the analysis you want to do.

Regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Mon Aug 25 02:26:07 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 25 Aug 2014 11:26:07 +0200
Subject: [gdal-dev] Converting MDB File With Unicode Characters
In-Reply-To: <1408949713323-5158087.post@n6.nabble.com>
References: <1408949713323-5158087.post@n6.nabble.com>
Message-ID: <1408958767.53fb012f117b4@imp.free.fr>

Selon Tomer <tomerlieber at gmail.com>:

> Hey,
>
> I'm using C# wrapper of GDAL and I'm having a problem converting MDB file
> that contains unicode characters.
>
> Lets take for example conversion to KML file, non-English characters are
> replaced by '?'

Did you try with ogr2ogr first ? To check if the issue is in the ODBC driver (is
that the one that is used actually, since both the ODBC or Java-based MDB driver
could be used), or with the C# bindings, or with your code

>
> How do I solve it?
>
>
>
> --
> View this message in context:
>
http://osgeo-org.1560.x6.nabble.com/Converting-MDB-File-With-Unicode-Characters-tp5158087.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From andre.vautour at caris.com  Mon Aug 25 05:14:21 2014
From: andre.vautour at caris.com (Andre Vautour)
Date: Mon, 25 Aug 2014 09:14:21 -0300
Subject: [gdal-dev] RFC 47 and Threading
In-Reply-To: <201408222212.57922.even.rouault@spatialys.com>
References: <CAPxHBh8QSsqN2K5tTctMG+mzv_Eo0BrcY-WQ23H-FF305ew8pA@mail.gmail.com>
	<201408222033.16308.even.rouault@spatialys.com>
	<CAPxHBh_W49VAfP5pdFgEWZFy3KrRH1LBSLCv5Mgy+OPyQYcvZw@mail.gmail.com>
	<201408222212.57922.even.rouault@spatialys.com>
Message-ID: <53FB289D.7080201@caris.com>

I want to start off by saying a big thanks to Blake for taking his time 
to tackle what can only be a very difficult problem.

 From what I can observe, the current discussion seems to be around the 
boundary of who should be responsible for ensuring thread safety around 
the block cache. The core of GDAL versus the individual drivers. While I 
see why such a conversation is important, as far as I am concerned, the 
most important part should be how it affects users of GDAL at the 
interface level. That is, if an application that is threaded is trying 
to use GDAL, how does it ensure thread-safety? What you have to keep in 
mind is that having some parts of the library not thread-safe basically 
just pushes the mutexing/locking to the calling applications.

Also, while it is important to document thread-safety limitations, might 
I suggest adding thread-safe related capabilities (TestCapability), 
especially if all drivers do not end-up having the same thread-safety 
constraints.

I personally do not see a GDALDatasetThreadSafe wrapper as adding much 
complexity. For instance, if you were to add a capability that indicates 
if a driver is inherently thread-safe, you could add a new open method 
to open a dataset in a thread-safe way with something like the following 
pseudocode:

DataSet OpenThreadSafe(GDALOpenInfo openInfo)
{
     DataSet dataSet = Open(openInfo);

     if (!dataSet.TestCapability(THREAD_SAFE))
     {
          dataSet = wrapWithThreadSafeWrapper(dataSet);
     }

     return dataSet;
}

Kind Regards,
Andr?

On 2014-08-22 17:12, Even Rouault wrote:
> Le vendredi 22 ao?t 2014 21:50:56, Blake Thompson a ?crit :
>> Even,
>>
>> On Fri, Aug 22, 2014 at 1:33 PM, Even Rouault <even.rouault at spatialys.com>
>>
>> wrote:
>>> Note: after re-reading, I realize that I misread your above sentence as
>>> "it will work to translate multiple datasets in a parallel way with a
>>> *per- dataset* cache").
>>>
>>> So, even if you didn't write it, I'm afraid that people will assume that
>>> calling CreateCopy() on the same source dataset handle would be
>>> thread-safe (imagine that one thread translates to format F1, while the
>>> other one to format F2), whereas in the current state of the RFC it is
>>> not. Because CreateCopy() will call GetGeoTransform(),
>>> GetProjectionRef() etc which are generally thread unsafe. For example
>>> GTiff has a lazy loading approach for those 2 methods, and it is not the
>>> only one.
>> If we claim thread-safety, we should likely offer full thread-safety (at
>>
>>> least
>>> in reading scenarios), not partial one. Otherwise I'm afraid no one but
>>> the few people that have taken part to that discussion or read the RFC
>>> will know
>>> the limits.
>> Perhaps the goal of the RFC should be to allow CreateCopy to be threadsafe?
>> I have no tried yet to venture into other parts of thread safety on the
>> dataset (already bit off a very large chunk).
>>
>>> I'm wondering if it wouldn't be worth having GDALDatasetThreadSafe and
>>> GDALRasterBandThreadSafe classes (or whatever name is appropriate), that
>>> would
>>> follow the decorator pattern, i.e. they will own a thread unsafe "real"
>>> dataset/band and override the methods to lock them. Similarly to what I
>>> have
>>> done in OGR with ogr/ogrsf_frmts/generic/ogrmutexeddatasource.cpp and
>>> ogrmutexedlayer.cpp, needed for the FGDB driver (the one that depends on
>>> the
>>> ESRI SDK).
>>>
>>> My idea would be to have an open flag GDAL_OF_THREADSAFE for
>>> GDALOpenEx(). When set, GDALOpen() would do the usual job and get a (in
>>> most cases) unsafe
>>> dataset object. Then it would query a virtual method of the dataset to
>>> return
>>> a thread-safe version of it (GetThreadSafe()).
>>> - If not defined by the driver, the base implementation of
>>> GetThreadSafe() would return the dataset wrapped in
>>> GDALDatasetThreadSafe
>>> - If the implementation of the dataset is already thread-safe, it's
>>> GetThreadSafe() would return just self
>>> - For the in-between situations, it could for example override
>>> GDALDatasetThreadSafe/GDALRasterBandThreadSafe base implementation to
>>> specialize the methods that don't need locking.
>>>
>>> This idea might not work (and I've not though how it would combine with
>>> my previous IReadBlock_thread_safe/IReadBlock approach). I have just
>>> written it
>>> as it came to my mind. The main motivation is to make it easy to have
>>> thread-
>>> safe versions by default, without the driver having to care about that,
>>> while
>>> being flexible to make drivers that need finer control to do it.
>> This approach worries me, there is already a lot of inheritance of the
>> GDALDataset, its really hard to learn already.
> Well, the learning phase would be only be people who want to tweak thread
> safety of their drivers, i.e. not a lot of people I bet. The user wouldn't
> have to pay a lot (just specifying GDAL_OF_THREADSAFE, or nothing at all if
> the price of thread safety is not too big)
>
>> Adding another layer would
>> make it even harder to maintain in my opinion. It also provides one more
>> config option in an already overwhelming number of config options. I think
>> we might be better off if we made a long term plan on how we wanted to make
>> GDAL thread safe. Perhaps make a list of parts needing thread safety and
>> progress towards it over a period of time. As part of it maintain a webpage
>> that describes what is thread safe currently, so people are not confused on
>> what is and is not thread safe.
> People are already confused... and have a hard-time really understanding the
> implication of the few lines at
> http://trac.osgeo.org/gdal/wiki/FAQMiscellaneous#IstheGDALlibrarythread-safe
>
> I'm afraid more documentation of a more complex situation will not make it
> better. It is not reasonable to have to document that "GetProjectionRef() is
> thread-safe in drivers X and Y, whereas GetGeoTransform() is in Y and Z".
> Because that's the situation we will have for sure if we don't adopt a global
> default mechanism (unless someone spends weeks in adding locks in every
> virtual method of every driver).
>
> The external locking I suggested is not completely a new approach. I could
> mention  Collections.synchronizedList() used in Java to make their List
> implementations thread safe... Sorry for mentionning Java ;-)
>
> The ideal would be to have a solution were by default we have a guarantee
> thread-safety and people (GDAL driver developers) who want to tune it can do
> it if they are brave enough.
>
>>> If, through benchmark, we determine that the cost of the thread safe
>>> version
>>> is neglectable, then GDAL_OF_THREADSAFE might be useless, and GDALOpen()
>>> would
>>> always return the thread-safe version.
>> I wish there were lots of benchmarks in the test suite (if there are, I
>> don't know where they are),
> They don't yet exist. Most code is functionnal code in Python, so not
> appropriate for performance testing, especially regarding threading.
> The autotest/cpp should likely be enhanced to have such tests (the only
> performance benchmark I can think of is testperfcopywords that was created to
> justify the templated approach of GDALCopyWords)
>
> To be mentionned, there's also apps/multireadtest.cpp (not compiled by
> default). It just ensures that opening the same file in N dataset objects and
> reading them in N threads works.
>
>> so that we can even roughly measure changes to
>> the internals of the library. (I realize this is something that could be
>> difficult to do well).
>>
>> Thanks,
>>
>> Blake

-- 
*Andr? Vautour*, B.Sc.
Application Developer
CARIS <http://www.caris.com>
115 Waggoners Lane
Fredericton, New Brunswick
Canada    E3B 2L4
Tel: +1.506.458.8533     Fax: +1.506.459.3849
www.caris.com <http://www.caris.com>

*Connect with CARIS*
Twitter <http://www.twitter.com/CARIS_GIS> LinkedIn 
<http://www.linkedin.com/groups?mostPopular=&gid=3217878> FaceBook 
<http://www.facebook.com/pages/CARIS-The-Marine-GIS-Experts/123907500987669?v=app_4949752878> 
YouTube <http://www.youtube.com/user/CARISGIS>

Download your free copy of CARIS Easy View today!
www.caris.com/easyview <http://www.caris.com/easyview>

_________________________________________________________________________
This email and any files transmitted with it are confidential and 
intended only for the addressee(s). If you are not the intended 
recipient(s) please notify us by email reply. You should not use, 
disclose, distribute or copy this communication if received in error.

Any views or opinions expressed in this email are solely those of the 
author and do not necessarily represent those of the company. No binding 
contract will result from this email until such time as a written 
document is signed on behalf of the company.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140825/d058810c/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: caris.png
Type: image/png
Size: 3859 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140825/d058810c/attachment-0005.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: twitter.png
Type: image/png
Size: 1208 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140825/d058810c/attachment-0006.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: linkedin.png
Type: image/png
Size: 1262 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140825/d058810c/attachment-0007.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: facebook.png
Type: image/png
Size: 811 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140825/d058810c/attachment-0008.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: youtube.png
Type: image/png
Size: 1299 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140825/d058810c/attachment-0009.png>

From tomerlieber at gmail.com  Mon Aug 25 05:45:47 2014
From: tomerlieber at gmail.com (Tomer)
Date: Mon, 25 Aug 2014 05:45:47 -0700 (PDT)
Subject: [gdal-dev] Converting MDB File With Unicode Characters
In-Reply-To: <1408958767.53fb012f117b4@imp.free.fr>
References: <1408949713323-5158087.post@n6.nabble.com>
	<1408958767.53fb012f117b4@imp.free.fr>
Message-ID: <1408970747276-5158156.post@n6.nabble.com>

i tried the vector utility program "ogr2ogr" to convert mdb to kml and still
non-English characters are replaced by '?'



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Converting-MDB-File-With-Unicode-Characters-tp5158087p5158156.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Mon Aug 25 06:04:22 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 25 Aug 2014 15:04:22 +0200
Subject: [gdal-dev] RFC 47 and Threading
In-Reply-To: <53FB289D.7080201@caris.com>
References: <CAPxHBh8QSsqN2K5tTctMG+mzv_Eo0BrcY-WQ23H-FF305ew8pA@mail.gmail.com>
	<201408222033.16308.even.rouault@spatialys.com>
	<CAPxHBh_W49VAfP5pdFgEWZFy3KrRH1LBSLCv5Mgy+OPyQYcvZw@mail.gmail.com>
	<201408222212.57922.even.rouault@spatialys.com>
	<53FB289D.7080201@caris.com>
Message-ID: <1408971862.53fb3456af8f7@imp.free.fr>

Selon Andre Vautour <andre.vautour at caris.com>:

> I want to start off by saying a big thanks to Blake for taking his time
> to tackle what can only be a very difficult problem.
>  From what I can observe, the current discussion seems to be around the
> boundary of who should be responsible for ensuring thread safety around
> the block cache. The core of GDAL versus the individual drivers.

The core will necessarily have to know about thread-safety because the block
cache is there. The discussion is more whether the drivers must also necessary
be thread aware, or if core mechanisms are sufficient to hide this detail to the
drivers. And potentially offering to drivers a mechanism to deal themselves with
thread-safety if they can have a more optimized implementation than the default
one.

> While I
> see why such a conversation is important, as far as I am concerned, the
> most important part should be how it affects users of GDAL at the
> interface level.

Agreed.

> That is, if an application that is threaded is trying
> to use GDAL, how does it ensure thread-safety? What you have to keep in
> mind is that having some parts of the library not thread-safe basically
> just pushes the mutexing/locking to the calling applications.

Not necessarily. That's what I suggested in my previous email : if the costs of
the mutex are not too expensive for non-threaded usage, then the API could
systematically return thread-safe versions, that are potentially wrapped by
GDALDatasetThreadSafe

>
> Also, while it is important to document thread-safety limitations, might
> I suggest adding thread-safe related capabilities (TestCapability),
> especially if all drivers do not end-up having the same thread-safety
> constraints.

That might be a solution, although not ideal from a usability point of view (if
we come with something more complex that non-thread-safe vs thread-safe, that
might be difficult to understand by users of GDAL API), and from a
GDAL-developer point of view as well (need to assess thread-safety for each
driver).
There can have subtelties : imagine that the VRT driver is made to be thread
safe, but uses sources of drivers that might be not thread safe...

>
> I personally do not see a GDALDatasetThreadSafe wrapper as adding much
> complexity. For instance, if you were to add a capability that indicates
> if a driver is inherently thread-safe, you could add a new open method
> to open a dataset in a thread-safe way with something like the following
> pseudocode:
>
> DataSet OpenThreadSafe(GDALOpenInfo openInfo)
> {
>      DataSet dataSet = Open(openInfo);
>
>      if (!dataSet.TestCapability(THREAD_SAFE))
>      {
>           dataSet = wrapWithThreadSafeWrapper(dataSet);
>      }
>
>      return dataSet;
> }

Yes, that's similar to what I imagined with my idea of GDAL_OF_THREADSAFE open
flag.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Mon Aug 25 06:05:44 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 25 Aug 2014 15:05:44 +0200
Subject: [gdal-dev] Converting MDB File With Unicode Characters
In-Reply-To: <1408970747276-5158156.post@n6.nabble.com>
References: <1408949713323-5158087.post@n6.nabble.com>
	<1408958767.53fb012f117b4@imp.free.fr>
	<1408970747276-5158156.post@n6.nabble.com>
Message-ID: <1408971944.53fb34a8e9707@imp.free.fr>

Selon Tomer <tomerlieber at gmail.com>:

> i tried the vector utility program "ogr2ogr" to convert mdb to kml and still
> non-English characters are replaced by '?'

So the problem is likely in the ODBC driver that doesn't return UTF-8 encoding.

>
>
>
> --
> View this message in context:
>
http://osgeo-org.1560.x6.nabble.com/Converting-MDB-File-With-Unicode-Characters-tp5158087p5158156.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From fabian.schindler at eox.at  Mon Aug 25 06:05:55 2014
From: fabian.schindler at eox.at (Fabian Schindler)
Date: Mon, 25 Aug 2014 15:05:55 +0200
Subject: [gdal-dev] Rasdaman VRT generation script
Message-ID: <53FB34B3.3090205@eox.at>

Hi folks,

I created a small script that generates VRT files that act as wrappers
to add georeferencing to rasdaman arrays (which do not have this feature).

I thought I could add this somewhere under "/swig/python/samples/", or
is this too specific for a certain driver?

Regards,
Fabian

From even.rouault at spatialys.com  Mon Aug 25 07:06:28 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 25 Aug 2014 16:06:28 +0200
Subject: [gdal-dev] Rasdaman VRT generation script
In-Reply-To: <53FB34B3.3090205@eox.at>
References: <53FB34B3.3090205@eox.at>
Message-ID: <1408975588.53fb42e41d17a@imp.free.fr>

Selon Fabian Schindler <fabian.schindler at eox.at>:

> Hi folks,
>
> I created a small script that generates VRT files that act as wrappers
> to add georeferencing to rasdaman arrays (which do not have this feature).
>
> I thought I could add this somewhere under "/swig/python/samples/", or
> is this too specific for a certain driver?

Looks reasonable. There are fairly specific samples in there already.

For the sake of my curiosity, how is it different than using gdal_translate -of
VRT -a_srs -a_ullr ? Is there anything specifically Rasdaman-ish in the script ?

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From tomerlieber at gmail.com  Mon Aug 25 07:45:00 2014
From: tomerlieber at gmail.com (Tomer)
Date: Mon, 25 Aug 2014 07:45:00 -0700 (PDT)
Subject: [gdal-dev] Converting MDB File With Unicode Characters
In-Reply-To: <1408971944.53fb34a8e9707@imp.free.fr>
References: <1408949713323-5158087.post@n6.nabble.com>
	<1408958767.53fb012f117b4@imp.free.fr>
	<1408970747276-5158156.post@n6.nabble.com>
	<1408971944.53fb34a8e9707@imp.free.fr>
Message-ID: <1408977900272-5158179.post@n6.nabble.com>

Do you have any idea for a possible solution?



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Converting-MDB-File-With-Unicode-Characters-tp5158087p5158179.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From JDzialo at edrnet.com  Mon Aug 25 09:26:47 2014
From: JDzialo at edrnet.com (JDzialo John)
Date: Mon, 25 Aug 2014 16:26:47 +0000
Subject: [gdal-dev] GDAL vsicurl with query string
In-Reply-To: <201408230038.56459.even.rouault@spatialys.com>
References: <8a94c9fdaa074f21b8f0dcabbe489f1e@CO1PR07MB281.namprd07.prod.outlook.com>
	<201408230038.56459.even.rouault@spatialys.com>
Message-ID: <a07c398a817043e88a649c8c329d02a0@CO1PR07MB281.namprd07.prod.outlook.com>

Hi Even

Yeah it was just a faked URL that was meant to show the URL format I was trying to use to vsicurl a tif file from AWS S3.

OK so these URLs are time restricted and will terminate after an hour, the maximum I ca set it at.

This is just our test bucket and test user.

If you can try this link...

https://parcel-test.s3.amazonaws.com/test/key/value/string/object.jpg?Signature=zyN053V02Y41VSKA6Yc1%2Bx0fz%2BU%3D&Expires=1408987568&AWSAccessKeyId=AKIAJF3TTVKIEFQXGZ3Q

It will terminate around 1:30pm.



-----Original Message-----
From: Even Rouault [mailto:even.rouault at spatialys.com] 
Sent: Friday, August 22, 2014 6:39 PM
To: gdal-dev at lists.osgeo.org
Cc: JDzialo John
Subject: Re: [gdal-dev] GDAL vsicurl with query string

Le samedi 23 ao?t 2014 00:13:21, JDzialo John a ?crit :
> Hi All,
> 
> This is my first post so forgive my noobiness...
> 
> We are running a cropping tool that used to access data from a local 
> hard drive and crop images.
> 
> Now we want to use s3 as our storage in aws and want to access files 
> through http requests.  Great!  Enter vsicurl.
> 
> So when we open our s3 bucket to the world we can easily access our 
> tif images from s3 with a straight url.  For example...
> 
> https://test-bucket.s3.amazonaws.com/test/key/value/string/object.tif
> 
> This works well using the gdalinfo vsicurl cmd...
> 
> gdalinfo
> /vsicurl/https://test-bucket.s3.amazonaws.com/test/key/value/string/ob
> ject
> .tif
> 
> However in s3 it is not secure to allow access to everyone on the 
> internet and would rather use a presigned URL that uses a query string 
> to authenticate access to the object.
> 
> When sending a request with a query string vsicurl and gdal appear to 
> breakdown and I'm not sure why.
> 
> gdalinfo
> /vsicurl/https://test-bucket.s3.amazonaws.com/test/key/value/string/ob
> ject 
> .tif?Signature=sdlfkj88345r9&Expires=12300000&AWSAccessKeyID=AKIALKSDJ
> FOILI
> KJFVOSIDF

I tried the URL in a browser and got a AccessDenied. Was it supposed to work or something faked to just give a sense of the kind of URL ? A working example would be helpful.

> 
> Fails saying it's unable to open the file.
> 
> Is there a specific way to pass the query string to the VSIL API like 
> when using curl with the -d switch?  Any way to run vsicurl with a 
> query string or something I'm missing?
> 
> Thanks for any advice you can throw my way!
> 
> 
> 
> John Dzialo | Linux System Administrator Direct 203.783.8163 | Main 
> 800.352.0050
> 
> Environmental Data Resources, Inc.
> 440 Wheelers Farms Road, Milford, CT 06461 
> www.edrnet.com<http://www.edrnet.com/> | 
> commonground.edrnet.com<http://commonground.edrnet.com/>
> 
> [Description: Description: Description: Description: Description:
> EDR_logo4color_EDR_only_80px2]

--
Spatialys - Geospatial professional services http://www.spatialys.com

From even.rouault at spatialys.com  Mon Aug 25 11:05:33 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 25 Aug 2014 20:05:33 +0200
Subject: [gdal-dev] Converting MDB File With Unicode Characters
In-Reply-To: <1408977900272-5158179.post@n6.nabble.com>
References: <1408949713323-5158087.post@n6.nabble.com>
	<1408971944.53fb34a8e9707@imp.free.fr>
	<1408977900272-5158179.post@n6.nabble.com>
Message-ID: <201408252005.33626.even.rouault@spatialys.com>

Le lundi 25 ao?t 2014 16:45:00, Tomer a ?crit :
> Do you have any idea for a possible solution?

What is the output of ogrinfo on the MDB ? In which encoding does it return 
its results ?

> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/Converting-MDB-File-With-Unicode-Chara
> cters-tp5158087p5158179.html Sent from the GDAL - Dev mailing list archive
> at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Mon Aug 25 11:12:50 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 25 Aug 2014 20:12:50 +0200
Subject: [gdal-dev] GDAL vsicurl with query string
In-Reply-To: <a07c398a817043e88a649c8c329d02a0@CO1PR07MB281.namprd07.prod.outlook.com>
References: <8a94c9fdaa074f21b8f0dcabbe489f1e@CO1PR07MB281.namprd07.prod.outlook.com>
	<201408230038.56459.even.rouault@spatialys.com>
	<a07c398a817043e88a649c8c329d02a0@CO1PR07MB281.namprd07.prod.outlook.com>
Message-ID: <201408252012.50349.even.rouault@spatialys.com>

Le lundi 25 ao?t 2014 18:26:47, JDzialo John a ?crit :
> Hi Even
> 
> Yeah it was just a faked URL that was meant to show the URL format I was
> trying to use to vsicurl a tif file from AWS S3.
> 
> OK so these URLs are time restricted and will terminate after an hour, the
> maximum I ca set it at.
> 
> This is just our test bucket and test user.
> 
> If you can try this link...
> 
> https://parcel-test.s3.amazonaws.com/test/key/value/string/object.jpg?Signa
> ture=zyN053V02Y41VSKA6Yc1%2Bx0fz%2BU%3D&Expires=1408987568&AWSAccessKeyId=A
> KIAJF3TTVKIEFQXGZ3Q
> 
> It will terminate around 1:30pm.

Just saw your message now after timeout experitation... If you could try 
setting up something with a longer timeout... Or you'll have to coordinate 
closely with someone.

Well, for some offline debugging, what is the output of :
gdalinfo --debug on --config CPL_CURL_VERBOSE YES /vsicurl/https://..... 

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From JDzialo at edrnet.com  Mon Aug 25 11:23:14 2014
From: JDzialo at edrnet.com (JDzialo John)
Date: Mon, 25 Aug 2014 18:23:14 +0000
Subject: [gdal-dev] GDAL vsicurl with query string
In-Reply-To: <201408252012.50349.even.rouault@spatialys.com>
References: <8a94c9fdaa074f21b8f0dcabbe489f1e@CO1PR07MB281.namprd07.prod.outlook.com>
	<201408230038.56459.even.rouault@spatialys.com>
	<a07c398a817043e88a649c8c329d02a0@CO1PR07MB281.namprd07.prod.outlook.com>
	<201408252012.50349.even.rouault@spatialys.com>
Message-ID: <0b7a3cbb44144328943195c6470289c9@CO1PR07MB281.namprd07.prod.outlook.com>

Thanks.

I think an hour may be the limit but I set it for 10 hours so if it's allowed this link should be good until midnight tonight...

https://parcel-test.s3.amazonaws.com/test/key/value/string/object.jpg?Signature=7SPVoYI84N2YF5O0vhjvDv%2FU%2FOs%3D&Expires=1409026574&AWSAccessKeyId=AKIAJF3TTVKIEFQXGZ3Q

Thanks for the debug command I appreciate your help.  I tried the command and received the following error...

PS C:\Users\jdzialoex> gdalinfo --debug on --config CPL_CURL_VERBOSE YES "/vsicurl/https://parcel-test.s3.amazonaws.com/
test/key/value/string/object.jpg?Signature=7SPVoYI84N2YF5O0vhjvDv%2FU%2FOs%3D&Expires=1409026574&AWSAccessKeyId=AKIAJF3T
TVKIEFQXGZ3Q"
VSICURL: GetFileList(/vsicurl/https://parcel-test.s3.amazonaws.com/test/key/value/string)
* timeout on name lookup is not supported
* About to connect() to parcel-test.s3.amazonaws.com port 443 (#0)
*   Trying 54.231.2.217... * connected
* Connected to parcel-test.s3.amazonaws.com (54.231.2.217) port 443 (#0)
* libcurl is now using a weak random seed!
* SSL certificate problem, verify that the CA cert is OK. Details:
error:14090086:SSL routines:SSL3_GET_SERVER_CERTIFICATE:certificate verify failed
* Closing connection #0
* timeout on name lookup is not supported
* About to connect() to parcel-test.s3.amazonaws.com port 443 (#0)
*   Trying 54.231.2.217... * connected
* Connected to parcel-test.s3.amazonaws.com (54.231.2.217) port 443 (#0)
* SSL certificate problem, verify that the CA cert is OK. Details:
error:14090086:SSL routines:SSL3_GET_SERVER_CERTIFICATE:certificate verify failed
* Closing connection #0
VSICURL: GetFileSize(https://parcel-test.s3.amazonaws.com/test/key/value/string/object.jpg?Signature=7SPVoYI84N2YF5O0vhj
vDv%2FU%2FOs%3D&Expires=1409026574&AWSAccessKeyId=AKIAJF3TTVKIEFQXGZ3Q)=0  response_code=0
ERROR 4: `/vsicurl/https://parcel-test.s3.amazonaws.com/test/key/value/string/object.jpg?Signature=7SPVoYI84N2YF5O0vhjvD
v%2FU%2FOs%3D&Expires=1409026574&AWSAccessKeyId=AKIAJF3TTVKIEFQXGZ3Q' does not exist in the file system,
and is not recognised as a supported dataset name.

gdalinfo failed - unable to open '/vsicurl/https://parcel-test.s3.amazonaws.com/test/key/value/string/object.jpg?Signatu
re=7SPVoYI84N2YF5O0vhjvDv%2FU%2FOs%3D&Expires=1409026574&AWSAccessKeyId=AKIAJF3TTVKIEFQXGZ3Q'.




-----Original Message-----
From: Even Rouault [mailto:even.rouault at spatialys.com] 
Sent: Monday, August 25, 2014 2:13 PM
To: JDzialo John
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] GDAL vsicurl with query string

Le lundi 25 ao?t 2014 18:26:47, JDzialo John a ?crit :
> Hi Even
> 
> Yeah it was just a faked URL that was meant to show the URL format I 
> was trying to use to vsicurl a tif file from AWS S3.
> 
> OK so these URLs are time restricted and will terminate after an hour, 
> the maximum I ca set it at.
> 
> This is just our test bucket and test user.
> 
> If you can try this link...
> 
> https://parcel-test.s3.amazonaws.com/test/key/value/string/object.jpg?
> Signa 
> ture=zyN053V02Y41VSKA6Yc1%2Bx0fz%2BU%3D&Expires=1408987568&AWSAccessKe
> yId=A
> KIAJF3TTVKIEFQXGZ3Q
> 
> It will terminate around 1:30pm.

Just saw your message now after timeout experitation... If you could try setting up something with a longer timeout... Or you'll have to coordinate closely with someone.

Well, for some offline debugging, what is the output of :
gdalinfo --debug on --config CPL_CURL_VERBOSE YES /vsicurl/https://..... 

Even

--
Spatialys - Geospatial professional services http://www.spatialys.com

From mccorb at cox.net  Mon Aug 25 11:35:34 2014
From: mccorb at cox.net (mccorb)
Date: Mon, 25 Aug 2014 11:35:34 -0700 (PDT)
Subject: [gdal-dev] Writing linestring and getting back linestring25
Message-ID: <1408991734902-5158219.post@n6.nabble.com>

I am creating a new sqlite file and writing a new layer and feature. When i
write a linestring to the file everything works fine. I look at it in an
SQLite browser app and the geometry_type is 2. However when I reopen it I
get a linestring25d geometry type.

>From what I can tell I can use this exactly the same way as a linestring
feature and just ignore the Z coordinate. Is this correct? 

I am confused why the file I created shows the geometry_type in the file as
linestring (via the sqlite file browser I am using to inspect the tables
directly) but I get back a linestring25d. I then I open up another file
someone gave me and it also shows the type as a linestring and it returns a
linestring and not linestring25d which makes me suspect it is something I am
doing when I write the data as opposed to reading it. 

I would like to better understand this and, if possible, have a little
better control over it than what I know how to do right now. Perhaps some
option on the file open or layer create that can coerce a linestring to stay
a linestring. 

I haven't tested but I would be pretty sure that I would end up with the
same results for points and polygons also. I just happened to test the
liniestring first. 

thanks



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Writing-linestring-and-getting-back-linestring25-tp5158219.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Mon Aug 25 11:40:25 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 25 Aug 2014 20:40:25 +0200
Subject: [gdal-dev] GDAL vsicurl with query string
In-Reply-To: <0b7a3cbb44144328943195c6470289c9@CO1PR07MB281.namprd07.prod.outlook.com>
References: <8a94c9fdaa074f21b8f0dcabbe489f1e@CO1PR07MB281.namprd07.prod.outlook.com>
	<201408252012.50349.even.rouault@spatialys.com>
	<0b7a3cbb44144328943195c6470289c9@CO1PR07MB281.namprd07.prod.outlook.com>
Message-ID: <201408252040.25958.even.rouault@spatialys.com>

Le lundi 25 ao?t 2014 20:23:14, JDzialo John a ?crit :
> Thanks.
> 
> I think an hour may be the limit but I set it for 10 hours so if it's
> allowed this link should be good until midnight tonight...
> 
> https://parcel-test.s3.amazonaws.com/test/key/value/string/object.jpg?Signa
> ture=7SPVoYI84N2YF5O0vhjvDv%2FU%2FOs%3D&Expires=1409026574&AWSAccessKeyId=A
> KIAJF3TTVKIEFQXGZ3Q
> 
> Thanks for the debug command I appreciate your help.  I tried the command
> and received the following error...
> 
> PS C:\Users\jdzialoex> gdalinfo --debug on --config CPL_CURL_VERBOSE YES
> "/vsicurl/https://parcel-test.s3.amazonaws.com/
> test/key/value/string/object.jpg?Signature=7SPVoYI84N2YF5O0vhjvDv%2FU%2FOs
> %3D&Expires=1409026574&AWSAccessKeyId=AKIAJF3T TVKIEFQXGZ3Q"
> VSICURL:
> GetFileList(/vsicurl/https://parcel-test.s3.amazonaws.com/test/key/value/s
> tring) * timeout on name lookup is not supported
> * About to connect() to parcel-test.s3.amazonaws.com port 443 (#0)
> *   Trying 54.231.2.217... * connected
> * Connected to parcel-test.s3.amazonaws.com (54.231.2.217) port 443 (#0)
> * libcurl is now using a weak random seed!
> * SSL certificate problem, verify that the CA cert is OK. Details:
> error:14090086:SSL routines:SSL3_GET_SERVER_CERTIFICATE:certificate verify
> failed * Closing connection #0
> * timeout on name lookup is not supported
> * About to connect() to parcel-test.s3.amazonaws.com port 443 (#0)
> *   Trying 54.231.2.217... * connected
> * Connected to parcel-test.s3.amazonaws.com (54.231.2.217) port 443 (#0)
> * SSL certificate problem, verify that the CA cert is OK. Details:
> error:14090086:SSL routines:SSL3_GET_SERVER_CERTIFICATE:certificate verify
> failed * Closing connection #0
> VSICURL:
> GetFileSize(https://parcel-test.s3.amazonaws.com/test/key/value/string/obj
> ect.jpg?Signature=7SPVoYI84N2YF5O0vhj
> vDv%2FU%2FOs%3D&Expires=1409026574&AWSAccessKeyId=AKIAJF3TTVKIEFQXGZ3Q)=0 
> response_code=0 ERROR 4:
> `/vsicurl/https://parcel-test.s3.amazonaws.com/test/key/value/string/objec
> t.jpg?Signature=7SPVoYI84N2YF5O0vhjvD
> v%2FU%2FOs%3D&Expires=1409026574&AWSAccessKeyId=AKIAJF3TTVKIEFQXGZ3Q' does
> not exist in the file system, and is not recognised as a supported dataset
> name.
> 
> gdalinfo failed - unable to open
> '/vsicurl/https://parcel-test.s3.amazonaws.com/test/key/value/string/objec
> t.jpg?Signatu
> re=7SPVoYI84N2YF5O0vhjvDv%2FU%2FOs%3D&Expires=1409026574&AWSAccessKeyId=AK
> IAJF3TTVKIEFQXGZ3Q'.
> 

Interesting. I don't have that error (but others ;-)). There might be a 
problem with the certificate, and curl being not able to check it.

I believe that "--config GDAL_HTTP_UNSAFESSL YES" should bypass certificate 
checks.

Assuming this solves this issue, and you'll get the same errors as on my 
machine, you'll see that the server doesn't apparently accept HEAD requests 
(this seems to be a constant issue with S3 storage)

> HEAD 
/test/key/value/string/object.jpg?Signature=7SPVoYI84N2YF5O0vhjvDv%2FU%2FOs%3D&Expires=1409026574&AWSAccessKeyId=AKIAJF3TTVKIEFQXGZ3Q 
HTTP/1.1
Host: parcel-test.s3.amazonaws.com
Accept: */*

< HTTP/1.1 403 Forbidden

You can solve this by adding --config CPL_VSIL_CURL_USE_HEAD NO

And, optionnaly, to make it faster, add --config GDAL_DISABLE_READDIR_ON_OPEN 
EMPTY_DIR

With the last 2 applied :

$ gdalinfo  "/vsicurl/https://parcel-
test.s3.amazonaws.com/test/key/value/string/object.jpg?Signature=7SPVoYI84N2YF5O0vhjvDv%2FU%2FOs%3D&Expires=1409026574&AWSAccessKeyId=AKIAJF3TTVKIEFQXGZ3Q" 
--config GDAL_DISABLE_READDIR_ON_OPEN EMPTY_DIR --config CPL_VSIL_CURL_USE_HEAD 
NO
Driver: JPEG/JPEG JFIF
Files: /vsicurl/https://parcel-
test.s3.amazonaws.com/test/key/value/string/object.jpg?Signature=7SPVoYI84N2YF5O0vhjvDv%2FU%2FOs%3D&Expires=1409026574&AWSAccessKeyId=AKIAJF3TTVKIEFQXGZ3Q
Size is 974, 647
Coordinate System is `'
Metadata:
  EXIF_ExifVersion=0220
  EXIF_PixelXDimension=974
  EXIF_PixelYDimension=647
  EXIF_Software=Google
Image Structure Metadata:
  COMPRESSION=JPEG
  INTERLEAVE=PIXEL
  SOURCE_COLOR_SPACE=YCbCr
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0,  647.0)
Upper Right (  974.0,    0.0)
Lower Right (  974.0,  647.0)
Center      (  487.0,  323.5)
Band 1 Block=974x1 Type=Byte, ColorInterp=Red
  Overviews: 487x324, 244x162
  Image Structure Metadata:
    COMPRESSION=JPEG
Band 2 Block=974x1 Type=Byte, ColorInterp=Green
  Overviews: 487x324, 244x162
  Image Structure Metadata:
    COMPRESSION=JPEG
Band 3 Block=974x1 Type=Byte, ColorInterp=Blue
  Overviews: 487x324, 244x162
  Image Structure Metadata:
    COMPRESSION=JPEG

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Mon Aug 25 11:46:11 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 25 Aug 2014 20:46:11 +0200
Subject: [gdal-dev] Writing linestring and getting back linestring25
In-Reply-To: <1408991734902-5158219.post@n6.nabble.com>
References: <1408991734902-5158219.post@n6.nabble.com>
Message-ID: <201408252046.11664.even.rouault@spatialys.com>

Le lundi 25 ao?t 2014 20:35:34, mccorb a ?crit :
> I am creating a new sqlite file and writing a new layer and feature. When i
> write a linestring to the file everything works fine. I look at it in an
> SQLite browser app and the geometry_type is 2. However when I reopen it I
> get a linestring25d geometry type.

Without reproducable code snippet, it is hard to tell...

My best guesses :

With regular SQLite databases (i.e. not spatialite), there's no consistency 
check done between the layer geometry type and each feature geometry type, so 
you could actually write every geometry you want in the layer.

By chance, do you use the AddPoint(double x, double y) Java API ? If so, then 
it might be surprising, but it is an alias of AddPoint(x,y,0)... 
Use instead AddPoint_2D()


> 
> From what I can tell I can use this exactly the same way as a linestring
> feature and just ignore the Z coordinate. Is this correct?
> 
> I am confused why the file I created shows the geometry_type in the file as
> linestring (via the sqlite file browser I am using to inspect the tables
> directly) but I get back a linestring25d. I then I open up another file
> someone gave me and it also shows the type as a linestring and it returns a
> linestring and not linestring25d which makes me suspect it is something I
> am doing when I write the data as opposed to reading it.
> 
> I would like to better understand this and, if possible, have a little
> better control over it than what I know how to do right now. Perhaps some
> option on the file open or layer create that can coerce a linestring to
> stay a linestring.
> 
> I haven't tested but I would be pretty sure that I would end up with the
> same results for points and polygons also. I just happened to test the
> liniestring first.
> 
> thanks
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/Writing-linestring-and-getting-back-li
> nestring25-tp5158219.html Sent from the GDAL - Dev mailing list archive at
> Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From JDzialo at edrnet.com  Mon Aug 25 12:40:51 2014
From: JDzialo at edrnet.com (JDzialo John)
Date: Mon, 25 Aug 2014 19:40:51 +0000
Subject: [gdal-dev] GDAL vsicurl with query string
In-Reply-To: <201408252040.25958.even.rouault@spatialys.com>
References: <8a94c9fdaa074f21b8f0dcabbe489f1e@CO1PR07MB281.namprd07.prod.outlook.com>
	<201408252012.50349.even.rouault@spatialys.com>
	<0b7a3cbb44144328943195c6470289c9@CO1PR07MB281.namprd07.prod.outlook.com>
	<201408252040.25958.even.rouault@spatialys.com>
Message-ID: <a1cbb744c92d4e58be618c508281b8ac@CO1PR07MB281.namprd07.prod.outlook.com>

Weird...

I'm still having an issue with the certificate using GDAL_HTTP_UNSAFESSL YES.  It seems to try to verify the cert with this set or not.

I wonder why you are not seeing that error at all?  

Is there any other why of setting up gdalinfo to not verify the cert?  Is there a list of GDAL config options somewhere I could go through?



-----Original Message-----
From: Even Rouault [mailto:even.rouault at spatialys.com] 
Sent: Monday, August 25, 2014 2:40 PM
To: JDzialo John
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] GDAL vsicurl with query string

Le lundi 25 ao?t 2014 20:23:14, JDzialo John a ?crit :
> Thanks.
> 
> I think an hour may be the limit but I set it for 10 hours so if it's 
> allowed this link should be good until midnight tonight...
> 
> https://parcel-test.s3.amazonaws.com/test/key/value/string/object.jpg?
> Signa 
> ture=7SPVoYI84N2YF5O0vhjvDv%2FU%2FOs%3D&Expires=1409026574&AWSAccessKe
> yId=A
> KIAJF3TTVKIEFQXGZ3Q
> 
> Thanks for the debug command I appreciate your help.  I tried the 
> command and received the following error...
> 
> PS C:\Users\jdzialoex> gdalinfo --debug on --config CPL_CURL_VERBOSE 
> YES "/vsicurl/https://parcel-test.s3.amazonaws.com/
> test/key/value/string/object.jpg?Signature=7SPVoYI84N2YF5O0vhjvDv%2FU%
> 2FOs %3D&Expires=1409026574&AWSAccessKeyId=AKIAJF3T TVKIEFQXGZ3Q"
> VSICURL:
> GetFileList(/vsicurl/https://parcel-test.s3.amazonaws.com/test/key/val
> ue/s
> tring) * timeout on name lookup is not supported
> * About to connect() to parcel-test.s3.amazonaws.com port 443 (#0)
> *   Trying 54.231.2.217... * connected
> * Connected to parcel-test.s3.amazonaws.com (54.231.2.217) port 443 
> (#0)
> * libcurl is now using a weak random seed!
> * SSL certificate problem, verify that the CA cert is OK. Details:
> error:14090086:SSL routines:SSL3_GET_SERVER_CERTIFICATE:certificate 
> verify failed * Closing connection #0
> * timeout on name lookup is not supported
> * About to connect() to parcel-test.s3.amazonaws.com port 443 (#0)
> *   Trying 54.231.2.217... * connected
> * Connected to parcel-test.s3.amazonaws.com (54.231.2.217) port 443 
> (#0)
> * SSL certificate problem, verify that the CA cert is OK. Details:
> error:14090086:SSL routines:SSL3_GET_SERVER_CERTIFICATE:certificate 
> verify failed * Closing connection #0
> VSICURL:
> GetFileSize(https://parcel-test.s3.amazonaws.com/test/key/value/string
> /obj
> ect.jpg?Signature=7SPVoYI84N2YF5O0vhj
> vDv%2FU%2FOs%3D&Expires=1409026574&AWSAccessKeyId=AKIAJF3TTVKIEFQXGZ3Q
> )=0
> response_code=0 ERROR 4:
> `/vsicurl/https://parcel-test.s3.amazonaws.com/test/key/value/string/o
> bjec
> t.jpg?Signature=7SPVoYI84N2YF5O0vhjvD
> v%2FU%2FOs%3D&Expires=1409026574&AWSAccessKeyId=AKIAJF3TTVKIEFQXGZ3Q' 
> does not exist in the file system, and is not recognised as a 
> supported dataset name.
> 
> gdalinfo failed - unable to open
> '/vsicurl/https://parcel-test.s3.amazonaws.com/test/key/value/string/o
> bjec
> t.jpg?Signatu
> re=7SPVoYI84N2YF5O0vhjvDv%2FU%2FOs%3D&Expires=1409026574&AWSAccessKeyI
> d=AK
> IAJF3TTVKIEFQXGZ3Q'.
> 

Interesting. I don't have that error (but others ;-)). There might be a problem with the certificate, and curl being not able to check it.

I believe that "--config GDAL_HTTP_UNSAFESSL YES" should bypass certificate checks.

Assuming this solves this issue, and you'll get the same errors as on my machine, you'll see that the server doesn't apparently accept HEAD requests (this seems to be a constant issue with S3 storage)

> HEAD
/test/key/value/string/object.jpg?Signature=7SPVoYI84N2YF5O0vhjvDv%2FU%2FOs%3D&Expires=1409026574&AWSAccessKeyId=AKIAJF3TTVKIEFQXGZ3Q
HTTP/1.1
Host: parcel-test.s3.amazonaws.com
Accept: */*

< HTTP/1.1 403 Forbidden

You can solve this by adding --config CPL_VSIL_CURL_USE_HEAD NO

And, optionnaly, to make it faster, add --config GDAL_DISABLE_READDIR_ON_OPEN EMPTY_DIR

With the last 2 applied :

$ gdalinfo  "/vsicurl/https://parcel-
test.s3.amazonaws.com/test/key/value/string/object.jpg?Signature=7SPVoYI84N2YF5O0vhjvDv%2FU%2FOs%3D&Expires=1409026574&AWSAccessKeyId=AKIAJF3TTVKIEFQXGZ3Q" 
--config GDAL_DISABLE_READDIR_ON_OPEN EMPTY_DIR --config CPL_VSIL_CURL_USE_HEAD NO
Driver: JPEG/JPEG JFIF
Files: /vsicurl/https://parcel-
test.s3.amazonaws.com/test/key/value/string/object.jpg?Signature=7SPVoYI84N2YF5O0vhjvDv%2FU%2FOs%3D&Expires=1409026574&AWSAccessKeyId=AKIAJF3TTVKIEFQXGZ3Q
Size is 974, 647
Coordinate System is `'
Metadata:
  EXIF_ExifVersion=0220
  EXIF_PixelXDimension=974
  EXIF_PixelYDimension=647
  EXIF_Software=Google
Image Structure Metadata:
  COMPRESSION=JPEG
  INTERLEAVE=PIXEL
  SOURCE_COLOR_SPACE=YCbCr
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0,  647.0)
Upper Right (  974.0,    0.0)
Lower Right (  974.0,  647.0)
Center      (  487.0,  323.5)
Band 1 Block=974x1 Type=Byte, ColorInterp=Red
  Overviews: 487x324, 244x162
  Image Structure Metadata:
    COMPRESSION=JPEG
Band 2 Block=974x1 Type=Byte, ColorInterp=Green
  Overviews: 487x324, 244x162
  Image Structure Metadata:
    COMPRESSION=JPEG
Band 3 Block=974x1 Type=Byte, ColorInterp=Blue
  Overviews: 487x324, 244x162
  Image Structure Metadata:
    COMPRESSION=JPEG

Even

--
Spatialys - Geospatial professional services http://www.spatialys.com

From even.rouault at spatialys.com  Mon Aug 25 12:48:18 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 25 Aug 2014 21:48:18 +0200
Subject: [gdal-dev] GDAL vsicurl with query string
In-Reply-To: <a1cbb744c92d4e58be618c508281b8ac@CO1PR07MB281.namprd07.prod.outlook.com>
References: <8a94c9fdaa074f21b8f0dcabbe489f1e@CO1PR07MB281.namprd07.prod.outlook.com>
	<201408252040.25958.even.rouault@spatialys.com>
	<a1cbb744c92d4e58be618c508281b8ac@CO1PR07MB281.namprd07.prod.outlook.com>
Message-ID: <201408252148.18253.even.rouault@spatialys.com>

Le lundi 25 ao?t 2014 21:40:51, JDzialo John a ?crit :
> Weird...
> 
> I'm still having an issue with the certificate using GDAL_HTTP_UNSAFESSL
> YES.  It seems to try to verify the cert with this set or not.
> 
> I wonder why you are not seeing that error at all?

Not same curl version likely, or not compiled with same options. Mine is curl 
7.19.7-1ubuntu1.7

> 
> Is there any other why of setting up gdalinfo to not verify the cert?  

I don't think so right now. Does that work with the curl binary on the command 
line ? If so, well, no further idea. If it does not work, then you likely have 
to find the additional curl option needed.

Searching for "error:14090086:SSL 
routines:SSL3_GET_SERVER_CERTIFICATE:certificate verify failed"  in your 
favorite search engine might bring results perhaps.

> Is
> there a list of GDAL config options somewhere I could go through?

Most are documented in 
http://www.gdal.org/cpl__http_8h.html#aee8368b7821300f4b81ef4da8a9c6a29 but I 
see that UNSAFESSL was not.

> 
> 
> 
> -----Original Message-----
> From: Even Rouault [mailto:even.rouault at spatialys.com]
> Sent: Monday, August 25, 2014 2:40 PM
> To: JDzialo John
> Cc: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] GDAL vsicurl with query string
> 
> Le lundi 25 ao?t 2014 20:23:14, JDzialo John a ?crit :
> > Thanks.
> > 
> > I think an hour may be the limit but I set it for 10 hours so if it's
> > allowed this link should be good until midnight tonight...
> > 
> > https://parcel-test.s3.amazonaws.com/test/key/value/string/object.jpg?
> > Signa
> > ture=7SPVoYI84N2YF5O0vhjvDv%2FU%2FOs%3D&Expires=1409026574&AWSAccessKe
> > yId=A
> > KIAJF3TTVKIEFQXGZ3Q
> > 
> > Thanks for the debug command I appreciate your help.  I tried the
> > command and received the following error...
> > 
> > PS C:\Users\jdzialoex> gdalinfo --debug on --config CPL_CURL_VERBOSE
> > YES "/vsicurl/https://parcel-test.s3.amazonaws.com/
> > test/key/value/string/object.jpg?Signature=7SPVoYI84N2YF5O0vhjvDv%2FU%
> > 2FOs %3D&Expires=1409026574&AWSAccessKeyId=AKIAJF3T TVKIEFQXGZ3Q"
> > VSICURL:
> > GetFileList(/vsicurl/https://parcel-test.s3.amazonaws.com/test/key/val
> > ue/s
> > tring) * timeout on name lookup is not supported
> > * About to connect() to parcel-test.s3.amazonaws.com port 443 (#0)
> > *   Trying 54.231.2.217... * connected
> > * Connected to parcel-test.s3.amazonaws.com (54.231.2.217) port 443
> > (#0)
> > * libcurl is now using a weak random seed!
> > * SSL certificate problem, verify that the CA cert is OK. Details:
> > error:14090086:SSL routines:SSL3_GET_SERVER_CERTIFICATE:certificate
> > verify failed * Closing connection #0
> > * timeout on name lookup is not supported
> > * About to connect() to parcel-test.s3.amazonaws.com port 443 (#0)
> > *   Trying 54.231.2.217... * connected
> > * Connected to parcel-test.s3.amazonaws.com (54.231.2.217) port 443
> > (#0)
> > * SSL certificate problem, verify that the CA cert is OK. Details:
> > error:14090086:SSL routines:SSL3_GET_SERVER_CERTIFICATE:certificate
> > verify failed * Closing connection #0
> > VSICURL:
> > GetFileSize(https://parcel-test.s3.amazonaws.com/test/key/value/string
> > /obj
> > ect.jpg?Signature=7SPVoYI84N2YF5O0vhj
> > vDv%2FU%2FOs%3D&Expires=1409026574&AWSAccessKeyId=AKIAJF3TTVKIEFQXGZ3Q
> > )=0
> > response_code=0 ERROR 4:
> > `/vsicurl/https://parcel-test.s3.amazonaws.com/test/key/value/string/o
> > bjec
> > t.jpg?Signature=7SPVoYI84N2YF5O0vhjvD
> > v%2FU%2FOs%3D&Expires=1409026574&AWSAccessKeyId=AKIAJF3TTVKIEFQXGZ3Q'
> > does not exist in the file system, and is not recognised as a
> > supported dataset name.
> > 
> > gdalinfo failed - unable to open
> > '/vsicurl/https://parcel-test.s3.amazonaws.com/test/key/value/string/o
> > bjec
> > t.jpg?Signatu
> > re=7SPVoYI84N2YF5O0vhjvDv%2FU%2FOs%3D&Expires=1409026574&AWSAccessKeyI
> > d=AK
> > IAJF3TTVKIEFQXGZ3Q'.
> 
> Interesting. I don't have that error (but others ;-)). There might be a
> problem with the certificate, and curl being not able to check it.
> 
> I believe that "--config GDAL_HTTP_UNSAFESSL YES" should bypass certificate
> checks.
> 
> Assuming this solves this issue, and you'll get the same errors as on my
> machine, you'll see that the server doesn't apparently accept HEAD
> requests (this seems to be a constant issue with S3 storage)
> 
> > HEAD
> 
> /test/key/value/string/object.jpg?Signature=7SPVoYI84N2YF5O0vhjvDv%2FU%2FOs
> %3D&Expires=1409026574&AWSAccessKeyId=AKIAJF3TTVKIEFQXGZ3Q HTTP/1.1
> Host: parcel-test.s3.amazonaws.com
> Accept: */*
> 
> < HTTP/1.1 403 Forbidden
> 
> You can solve this by adding --config CPL_VSIL_CURL_USE_HEAD NO
> 
> And, optionnaly, to make it faster, add --config
> GDAL_DISABLE_READDIR_ON_OPEN EMPTY_DIR
> 
> With the last 2 applied :
> 
> $ gdalinfo  "/vsicurl/https://parcel-
> test.s3.amazonaws.com/test/key/value/string/object.jpg?Signature=7SPVoYI84N
> 2YF5O0vhjvDv%2FU%2FOs%3D&Expires=1409026574&AWSAccessKeyId=AKIAJF3TTVKIEFQX
> GZ3Q" --config GDAL_DISABLE_READDIR_ON_OPEN EMPTY_DIR --config
> CPL_VSIL_CURL_USE_HEAD NO Driver: JPEG/JPEG JFIF
> Files: /vsicurl/https://parcel-
> test.s3.amazonaws.com/test/key/value/string/object.jpg?Signature=7SPVoYI84N
> 2YF5O0vhjvDv%2FU%2FOs%3D&Expires=1409026574&AWSAccessKeyId=AKIAJF3TTVKIEFQX
> GZ3Q Size is 974, 647
> Coordinate System is `'
> Metadata:
>   EXIF_ExifVersion=0220
>   EXIF_PixelXDimension=974
>   EXIF_PixelYDimension=647
>   EXIF_Software=Google
> Image Structure Metadata:
>   COMPRESSION=JPEG
>   INTERLEAVE=PIXEL
>   SOURCE_COLOR_SPACE=YCbCr
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0,  647.0)
> Upper Right (  974.0,    0.0)
> Lower Right (  974.0,  647.0)
> Center      (  487.0,  323.5)
> Band 1 Block=974x1 Type=Byte, ColorInterp=Red
>   Overviews: 487x324, 244x162
>   Image Structure Metadata:
>     COMPRESSION=JPEG
> Band 2 Block=974x1 Type=Byte, ColorInterp=Green
>   Overviews: 487x324, 244x162
>   Image Structure Metadata:
>     COMPRESSION=JPEG
> Band 3 Block=974x1 Type=Byte, ColorInterp=Blue
>   Overviews: 487x324, 244x162
>   Image Structure Metadata:
>     COMPRESSION=JPEG
> 
> Even
> 
> --
> Spatialys - Geospatial professional services http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From JDzialo at edrnet.com  Mon Aug 25 13:58:35 2014
From: JDzialo at edrnet.com (JDzialo John)
Date: Mon, 25 Aug 2014 20:58:35 +0000
Subject: [gdal-dev] GDAL vsicurl with query string
In-Reply-To: <201408252148.18253.even.rouault@spatialys.com>
References: <8a94c9fdaa074f21b8f0dcabbe489f1e@CO1PR07MB281.namprd07.prod.outlook.com>
	<201408252040.25958.even.rouault@spatialys.com>
	<a1cbb744c92d4e58be618c508281b8ac@CO1PR07MB281.namprd07.prod.outlook.com>
	<201408252148.18253.even.rouault@spatialys.com>
Message-ID: <bad306a35b7643c2b459eeb2cf645527@CO1PR07MB281.namprd07.prod.outlook.com>

Thanks so much for your help.

Curl works fine it's only the gdalinfo \vsicurl\ that is throwing the error using 7.21.2 of curl and libcurl on a Windows Server 2008 server.

I'm looking through to see what I can find online.

-----Original Message-----
From: Even Rouault [mailto:even.rouault at spatialys.com] 
Sent: Monday, August 25, 2014 3:48 PM
To: JDzialo John
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] GDAL vsicurl with query string

Le lundi 25 ao?t 2014 21:40:51, JDzialo John a ?crit :
> Weird...
> 
> I'm still having an issue with the certificate using 
> GDAL_HTTP_UNSAFESSL YES.  It seems to try to verify the cert with this set or not.
> 
> I wonder why you are not seeing that error at all?

Not same curl version likely, or not compiled with same options. Mine is curl
7.19.7-1ubuntu1.7

> 
> Is there any other why of setting up gdalinfo to not verify the cert?  

I don't think so right now. Does that work with the curl binary on the command line ? If so, well, no further idea. If it does not work, then you likely have to find the additional curl option needed.

Searching for "error:14090086:SSL
routines:SSL3_GET_SERVER_CERTIFICATE:certificate verify failed"  in your favorite search engine might bring results perhaps.

> Is
> there a list of GDAL config options somewhere I could go through?

Most are documented in
http://www.gdal.org/cpl__http_8h.html#aee8368b7821300f4b81ef4da8a9c6a29 but I see that UNSAFESSL was not.

> 
> 
> 
> -----Original Message-----
> From: Even Rouault [mailto:even.rouault at spatialys.com]
> Sent: Monday, August 25, 2014 2:40 PM
> To: JDzialo John
> Cc: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] GDAL vsicurl with query string
> 
> Le lundi 25 ao?t 2014 20:23:14, JDzialo John a ?crit :
> > Thanks.
> > 
> > I think an hour may be the limit but I set it for 10 hours so if 
> > it's allowed this link should be good until midnight tonight...
> > 
> > https://parcel-test.s3.amazonaws.com/test/key/value/string/object.jpg?
> > Signa
> > ture=7SPVoYI84N2YF5O0vhjvDv%2FU%2FOs%3D&Expires=1409026574&AWSAccess
> > Ke
> > yId=A
> > KIAJF3TTVKIEFQXGZ3Q
> > 
> > Thanks for the debug command I appreciate your help.  I tried the 
> > command and received the following error...
> > 
> > PS C:\Users\jdzialoex> gdalinfo --debug on --config CPL_CURL_VERBOSE 
> > YES "/vsicurl/https://parcel-test.s3.amazonaws.com/
> > test/key/value/string/object.jpg?Signature=7SPVoYI84N2YF5O0vhjvDv%2F
> > U% 2FOs %3D&Expires=1409026574&AWSAccessKeyId=AKIAJF3T TVKIEFQXGZ3Q"
> > VSICURL:
> > GetFileList(/vsicurl/https://parcel-test.s3.amazonaws.com/test/key/v
> > al
> > ue/s
> > tring) * timeout on name lookup is not supported
> > * About to connect() to parcel-test.s3.amazonaws.com port 443 (#0)
> > *   Trying 54.231.2.217... * connected
> > * Connected to parcel-test.s3.amazonaws.com (54.231.2.217) port 443
> > (#0)
> > * libcurl is now using a weak random seed!
> > * SSL certificate problem, verify that the CA cert is OK. Details:
> > error:14090086:SSL routines:SSL3_GET_SERVER_CERTIFICATE:certificate
> > verify failed * Closing connection #0
> > * timeout on name lookup is not supported
> > * About to connect() to parcel-test.s3.amazonaws.com port 443 (#0)
> > *   Trying 54.231.2.217... * connected
> > * Connected to parcel-test.s3.amazonaws.com (54.231.2.217) port 443
> > (#0)
> > * SSL certificate problem, verify that the CA cert is OK. Details:
> > error:14090086:SSL routines:SSL3_GET_SERVER_CERTIFICATE:certificate
> > verify failed * Closing connection #0
> > VSICURL:
> > GetFileSize(https://parcel-test.s3.amazonaws.com/test/key/value/stri
> > ng
> > /obj
> > ect.jpg?Signature=7SPVoYI84N2YF5O0vhj
> > vDv%2FU%2FOs%3D&Expires=1409026574&AWSAccessKeyId=AKIAJF3TTVKIEFQXGZ
> > 3Q
> > )=0
> > response_code=0 ERROR 4:
> > `/vsicurl/https://parcel-test.s3.amazonaws.com/test/key/value/string
> > /o
> > bjec
> > t.jpg?Signature=7SPVoYI84N2YF5O0vhjvD
> > v%2FU%2FOs%3D&Expires=1409026574&AWSAccessKeyId=AKIAJF3TTVKIEFQXGZ3Q'
> > does not exist in the file system, and is not recognised as a 
> > supported dataset name.
> > 
> > gdalinfo failed - unable to open
> > '/vsicurl/https://parcel-test.s3.amazonaws.com/test/key/value/string
> > /o
> > bjec
> > t.jpg?Signatu
> > re=7SPVoYI84N2YF5O0vhjvDv%2FU%2FOs%3D&Expires=1409026574&AWSAccessKe
> > yI
> > d=AK
> > IAJF3TTVKIEFQXGZ3Q'.
> 
> Interesting. I don't have that error (but others ;-)). There might be 
> a problem with the certificate, and curl being not able to check it.
> 
> I believe that "--config GDAL_HTTP_UNSAFESSL YES" should bypass 
> certificate checks.
> 
> Assuming this solves this issue, and you'll get the same errors as on 
> my machine, you'll see that the server doesn't apparently accept HEAD 
> requests (this seems to be a constant issue with S3 storage)
> 
> > HEAD
> 
> /test/key/value/string/object.jpg?Signature=7SPVoYI84N2YF5O0vhjvDv%2FU
> %2FOs %3D&Expires=1409026574&AWSAccessKeyId=AKIAJF3TTVKIEFQXGZ3Q 
> HTTP/1.1
> Host: parcel-test.s3.amazonaws.com
> Accept: */*
> 
> < HTTP/1.1 403 Forbidden
> 
> You can solve this by adding --config CPL_VSIL_CURL_USE_HEAD NO
> 
> And, optionnaly, to make it faster, add --config 
> GDAL_DISABLE_READDIR_ON_OPEN EMPTY_DIR
> 
> With the last 2 applied :
> 
> $ gdalinfo  "/vsicurl/https://parcel-
> test.s3.amazonaws.com/test/key/value/string/object.jpg?Signature=7SPVo
> YI84N 
> 2YF5O0vhjvDv%2FU%2FOs%3D&Expires=1409026574&AWSAccessKeyId=AKIAJF3TTVK
> IEFQX GZ3Q" --config GDAL_DISABLE_READDIR_ON_OPEN EMPTY_DIR --config 
> CPL_VSIL_CURL_USE_HEAD NO Driver: JPEG/JPEG JFIF
> Files: /vsicurl/https://parcel-
> test.s3.amazonaws.com/test/key/value/string/object.jpg?Signature=7SPVo
> YI84N 
> 2YF5O0vhjvDv%2FU%2FOs%3D&Expires=1409026574&AWSAccessKeyId=AKIAJF3TTVK
> IEFQX
> GZ3Q Size is 974, 647
> Coordinate System is `'
> Metadata:
>   EXIF_ExifVersion=0220
>   EXIF_PixelXDimension=974
>   EXIF_PixelYDimension=647
>   EXIF_Software=Google
> Image Structure Metadata:
>   COMPRESSION=JPEG
>   INTERLEAVE=PIXEL
>   SOURCE_COLOR_SPACE=YCbCr
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0,  647.0)
> Upper Right (  974.0,    0.0)
> Lower Right (  974.0,  647.0)
> Center      (  487.0,  323.5)
> Band 1 Block=974x1 Type=Byte, ColorInterp=Red
>   Overviews: 487x324, 244x162
>   Image Structure Metadata:
>     COMPRESSION=JPEG
> Band 2 Block=974x1 Type=Byte, ColorInterp=Green
>   Overviews: 487x324, 244x162
>   Image Structure Metadata:
>     COMPRESSION=JPEG
> Band 3 Block=974x1 Type=Byte, ColorInterp=Blue
>   Overviews: 487x324, 244x162
>   Image Structure Metadata:
>     COMPRESSION=JPEG
> 
> Even
> 
> --
> Spatialys - Geospatial professional services http://www.spatialys.com

--
Spatialys - Geospatial professional services http://www.spatialys.com

From normvcr at telus.net  Mon Aug 25 23:12:18 2014
From: normvcr at telus.net (Norman Goldstein)
Date: Mon, 25 Aug 2014 23:12:18 -0700
Subject: [gdal-dev] Get hold of TIFF structure
Message-ID: <53FC2542.2070902@telus.net>

Let's say I've opened a dataset (from a tiff file on disk).  How do I  
get hold of the TIFF structure that is used by the libtiff library?
Thanks.

From fabian.schindler at eox.at  Tue Aug 26 00:20:51 2014
From: fabian.schindler at eox.at (Fabian Schindler)
Date: Tue, 26 Aug 2014 09:20:51 +0200
Subject: [gdal-dev] Rasdaman VRT generation script
In-Reply-To: <1408975588.53fb42e41d17a@imp.free.fr>
References: <53FB34B3.3090205@eox.at> <1408975588.53fb42e41d17a@imp.free.fr>
Message-ID: <53FC3553.3050703@eox.at>

Even,

I was not aware that creating a VRT was that easy... shame on me. My
script would have handled connection parameters and created a query
string, but I guess there is not enough added value.

Thanks for the info
Fabian

On 2014-08-25 16:06, Even Rouault wrote:
> Selon Fabian Schindler <fabian.schindler at eox.at>:
> 
>> Hi folks,
>> 
>> I created a small script that generates VRT files that act as
>> wrappers to add georeferencing to rasdaman arrays (which do not
>> have this feature).
>> 
>> I thought I could add this somewhere under
>> "/swig/python/samples/", or is this too specific for a certain
>> driver?
> 
> Looks reasonable. There are fairly specific samples in there
> already.
> 
> For the sake of my curiosity, how is it different than using
> gdal_translate -of VRT -a_srs -a_ullr ? Is there anything
> specifically Rasdaman-ish in the script ?
> 
> Even
> 


From tomerlieber at gmail.com  Tue Aug 26 00:32:09 2014
From: tomerlieber at gmail.com (Tomer)
Date: Tue, 26 Aug 2014 00:32:09 -0700 (PDT)
Subject: [gdal-dev] Converting MDB File With Unicode Characters
In-Reply-To: <201408252005.33626.even.rouault@spatialys.com>
References: <1408949713323-5158087.post@n6.nabble.com>
	<1408958767.53fb012f117b4@imp.free.fr>
	<1408970747276-5158156.post@n6.nabble.com>
	<1408971944.53fb34a8e9707@imp.free.fr>
	<1408977900272-5158179.post@n6.nabble.com>
	<201408252005.33626.even.rouault@spatialys.com>
Message-ID: <1409038329453-5158293.post@n6.nabble.com>

The ogrinfo display non-English characters as '?'. I'm not sure in which
encoding it return its results. (Is there any way to check the encoding?)

Example for ogrinfo output:
                  .
OGRFeature<poly_mdb_23>:4
OBJECTID <Integer> = 3
                   .
                   .
????_?? <String> = -?????
                   .



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Converting-MDB-File-With-Unicode-Characters-tp5158087p5158293.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Tue Aug 26 00:45:36 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 26 Aug 2014 09:45:36 +0200
Subject: [gdal-dev] Converting MDB File With Unicode Characters
In-Reply-To: <1409038329453-5158293.post@n6.nabble.com>
References: <1408949713323-5158087.post@n6.nabble.com>
	<1408958767.53fb012f117b4@imp.free.fr>
	<1408970747276-5158156.post@n6.nabble.com>
	<1408971944.53fb34a8e9707@imp.free.fr>
	<1408977900272-5158179.post@n6.nabble.com>
	<201408252005.33626.even.rouault@spatialys.com>
	<1409038329453-5158293.post@n6.nabble.com>
Message-ID: <1409039136.53fc3b20d92a8@imp.free.fr>

Selon Tomer <tomerlieber at gmail.com>:

> The ogrinfo display non-English characters as '?'. I'm not sure in which
> encoding it return its results. (Is there any way to check the encoding?)

For example, if you do "ogrinfo the_arguments > somefile.txt" and open it with
Notepad++, you can try different options in the Encoding menu to find which one
displays the file correctly.

>
> Example for ogrinfo output:
>                   .
> OGRFeature<poly_mdb_23>:4
> OBJECTID <Integer> = 3
>                    .
>                    .
> ????_?? <String> = -?????
>                    .
>
>
>
> --
> View this message in context:
>
http://osgeo-org.1560.x6.nabble.com/Converting-MDB-File-With-Unicode-Characters-tp5158087p5158293.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Tue Aug 26 00:49:26 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 26 Aug 2014 09:49:26 +0200
Subject: [gdal-dev] Get hold of TIFF structure
In-Reply-To: <53FC2542.2070902@telus.net>
References: <53FC2542.2070902@telus.net>
Message-ID: <1409039366.53fc3c0685f58@imp.free.fr>

Selon Norman Goldstein <normvcr at telus.net>:

> Let's say I've opened a dataset (from a tiff file on disk).  How do I
> get hold of the TIFF structure that is used by the libtiff library?

GDALDataset::GetInternalHandle() on a GTiff dataset will return a TIFF* handle.
But be careful. If you use GDAL compiled with internal libtiff (libtiff 4.X),
you must also link your application against libtiff 4.X, or export the libtiff
symbols of the internal version of GDAL, otherwise chaos will happen.

http://www.gdal.org/classGDALDataset.html#a39396324384dc195866a374775fa74ef

Why do you want to access the TIFF handle ? Is there information you cannot
access through GDAL API ?

> Thanks.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From sovofmad at yandex.ru  Tue Aug 26 01:04:33 2014
From: sovofmad at yandex.ru (Storkur)
Date: Tue, 26 Aug 2014 01:04:33 -0700 (PDT)
Subject: [gdal-dev] Convert S57 to image with S52 rendering
In-Reply-To: <4FFE8D3C.5030706@t-kartor.se>
References: <4FFE8D3C.5030706@t-kartor.se>
Message-ID: <1409040273309-5158302.post@n6.nabble.com>

We are also interested in such combination of libs.

Best regards



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Convert-S57-to-image-with-S52-rendering-tp4987897p5158302.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From tomerlieber at gmail.com  Tue Aug 26 03:33:49 2014
From: tomerlieber at gmail.com (Tomer)
Date: Tue, 26 Aug 2014 03:33:49 -0700 (PDT)
Subject: [gdal-dev] Converting MDB File With Unicode Characters
In-Reply-To: <1409039136.53fc3b20d92a8@imp.free.fr>
References: <1408949713323-5158087.post@n6.nabble.com>
	<1408958767.53fb012f117b4@imp.free.fr>
	<1408970747276-5158156.post@n6.nabble.com>
	<1408971944.53fb34a8e9707@imp.free.fr>
	<1408977900272-5158179.post@n6.nabble.com>
	<201408252005.33626.even.rouault@spatialys.com>
	<1409038329453-5158293.post@n6.nabble.com>
	<1409039136.53fc3b20d92a8@imp.free.fr>
Message-ID: <1409049229669-5158338.post@n6.nabble.com>

i tried different options in the Encoding menu but none displayed the file
correctly. I think the problem is caused by incorrect reading of the mdb
file made ??by the driver.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Converting-MDB-File-With-Unicode-Characters-tp5158087p5158338.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From hanlie.pretorius at gmail.com  Tue Aug 26 06:54:23 2014
From: hanlie.pretorius at gmail.com (Hanlie Pretorius)
Date: Tue, 26 Aug 2014 15:54:23 +0200
Subject: [gdal-dev] Error when trying to compress a TIFF file
Message-ID: <CAFpCUPqV2PK3OpCOxzEtxR8L1CR66w_Hb_rzmqu_k2Wb8KMWeQ@mail.gmail.com>

Hi,

I'm trying to convert a 16 bit image to 8 bits and at the same time
add JPEG compression, but gdal reports errors during the process.

gdal_info for the input file is:

Driver: GTiff/GeoTIFF

Files: D:/SPOT 6/PS_Envi/Test_8bit.TIF

Size is 30717, 28629

Coordinate System is:

PROJCS["WGS 84 / UTM zone 34S",

GEOGCS["WGS 84",

DATUM["WGS_1984",

SPHEROID["WGS 84",6378137,298.257223563,

AUTHORITY["EPSG","7030"]],

AUTHORITY["EPSG","6326"]],

PRIMEM["Greenwich",0],

UNIT["degree",0.0174532925199433],

AUTHORITY["EPSG","4326"]],

PROJECTION["Transverse_Mercator"],

PARAMETER["latitude_of_origin",0],

PARAMETER["central_meridian",21],

PARAMETER["scale_factor",0.9996],

PARAMETER["false_easting",500000],

PARAMETER["false_northing",10000000],

UNIT["metre",1,

AUTHORITY["EPSG","9001"]],

AUTHORITY["EPSG","32734"]]

Origin = (537234.000000000000000,6296730.000000000000000)

Pixel Size = (1.500000000000000,-1.500000000000000)

Metadata:

AREA_OR_POINT=Area

Band_1=CN Sharp R (Band 3:IMG_SPOT6_MS_201304220815274_ORT_742338101_R1C1.TIF)

Band_2=CN Sharp G (Band 2:IMG_SPOT6_MS_201304220815274_ORT_742338101_R1C1.TIF)

Band_3=CN Sharp B (Band 1:IMG_SPOT6_MS_201304220815274_ORT_742338101_R1C1.TIF)

Image Structure Metadata:

INTERLEAVE=PIXEL

Corner Coordinates:

Upper Left ( 537234.000, 6296730.000) ( 21d24' 2.56"E, 33d28' 5.67"S)

Lower Left ( 537234.000, 6253786.500) ( 21d24' 9.04"E, 33d51'20.01"S)

Upper Right ( 583309.500, 6296730.000) ( 21d53'47.54"E, 33d27'56.33"S)

Lower Right ( 583309.500, 6253786.500) ( 21d54' 2.03"E, 33d51'10.53"S)

Center ( 560271.750, 6275258.250) ( 21d39' 0.30"E, 33d39'39.04"S)

Band 1 Block=30717x1 Type=Byte, ColorInterp=Red

Description = CN Sharp R (Band
3:IMG_SPOT6_MS_201304220815274_ORT_742338101_R1C1.TIF)

Band 2 Block=30717x1 Type=Byte, ColorInterp=Green

Description = CN Sharp G (Band
2:IMG_SPOT6_MS_201304220815274_ORT_742338101_R1C1.TIF)

Band 3 Block=30717x1 Type=Byte, ColorInterp=Blue

Description = CN Sharp B (Band
1:IMG_SPOT6_MS_201304220815274_ORT_742338101_R1C1.TIF)

The command I'm using is:
gdal_translate -ot Byte -of GTiff -scale 0 4905 0 255 -stats -co
COMPRESS=JPEG "D:/SPOT 6/PS_Envi/Test.TIF" "D:/SPOT
6/PS_Envi/Test_8bit_JPEG_Compr.TIF"

The last part of the error message is:
ERROR 1: IReadBlock failed at X offset 18, Y offset 2
ERROR 1: VRTSourceRasterBand::iRatserIO() called recursively on the
same band. It looks like the VRT is referencing itself.
ERROR 1: IReadBlock failed at X offset 19, Y offset 2
ERROR 1: VRTSourceRasterBand::iRatserIO() called recursively on the
same band. It looks like the VRT is referencing itself.
More than 1000 errors or warnings have been reported. No more will be
reported from now.
0...10...20...30...40...50...60...70...80...90...100 - done.

gdal_translate does complete the process and I get an output file that
looks usable, but I think something is wrong with the file because
working with it in QGIS takes longer than the original image, which is
two orders of magnitude bigger in file size.

gdal_info for the output file is:
Driver: GTiff/GeoTIFF

Files: D:/SPOT 6/PS_Envi/Test_8bit_JPEG_Compr.TIF

D:/SPOT 6/PS_Envi/Test_8bit_JPEG_Compr.TIF.aux.xml

Size is 30717, 28629

Coordinate System is:

PROJCS["WGS 84 / UTM zone 34S",

GEOGCS["WGS 84",

DATUM["WGS_1984",

SPHEROID["WGS 84",6378137,298.257223563,

AUTHORITY["EPSG","7030"]],

AUTHORITY["EPSG","6326"]],

PRIMEM["Greenwich",0],

UNIT["degree",0.0174532925199433],

AUTHORITY["EPSG","4326"]],

PROJECTION["Transverse_Mercator"],

PARAMETER["latitude_of_origin",0],

PARAMETER["central_meridian",21],

PARAMETER["scale_factor",0.9996],

PARAMETER["false_easting",500000],

PARAMETER["false_northing",10000000],

UNIT["metre",1,

AUTHORITY["EPSG","9001"]],

AUTHORITY["EPSG","32734"]]

Origin = (537234.000000000000000,6296730.000000000000000)

Pixel Size = (1.500000000000000,-1.500000000000000)

Metadata:

AREA_OR_POINT=Area

Band_1=CN Sharp R (Band 3:IMG_SPOT6_MS_201304220815274_ORT_742338101_R1C1.TIF)

Band_2=CN Sharp G (Band 2:IMG_SPOT6_MS_201304220815274_ORT_742338101_R1C1.TIF)

Band_3=CN Sharp B (Band 1:IMG_SPOT6_MS_201304220815274_ORT_742338101_R1C1.TIF)

Image Structure Metadata:

COMPRESSION=JPEG

INTERLEAVE=PIXEL

Corner Coordinates:

Upper Left ( 537234.000, 6296730.000) ( 21d24' 2.56"E, 33d28' 5.67"S)

Lower Left ( 537234.000, 6253786.500) ( 21d24' 9.04"E, 33d51'20.01"S)

Upper Right ( 583309.500, 6296730.000) ( 21d53'47.54"E, 33d27'56.33"S)

Lower Right ( 583309.500, 6253786.500) ( 21d54' 2.03"E, 33d51'10.53"S)

Center ( 560271.750, 6275258.250) ( 21d39' 0.30"E, 33d39'39.04"S)

Band 1 Block=30717x16 Type=Byte, ColorInterp=Red

Description = CN Sharp R (Band
3:IMG_SPOT6_MS_201304220815274_ORT_742338101_R1C1.TIF)

Band 2 Block=30717x16 Type=Byte, ColorInterp=Green

Description = CN Sharp G (Band
2:IMG_SPOT6_MS_201304220815274_ORT_742338101_R1C1.TIF)

Band 3 Block=30717x16 Type=Byte, ColorInterp=Blue

Description = CN Sharp B (Band
1:IMG_SPOT6_MS_201304220815274_ORT_742338101_R1C1.TIF)

Does anybody perhaps know what is going wrong or can suggest another
method to accomplishing what I wish to?

I have successfully created an 8 bit image without using compression,
so I'm pretty sure the error stems from the compression operation.

Regards
Hanlie

From even.rouault at spatialys.com  Tue Aug 26 07:25:24 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 26 Aug 2014 16:25:24 +0200
Subject: [gdal-dev] Error when trying to compress a TIFF file
In-Reply-To: <CAFpCUPqV2PK3OpCOxzEtxR8L1CR66w_Hb_rzmqu_k2Wb8KMWeQ@mail.gmail.com>
References: <CAFpCUPqV2PK3OpCOxzEtxR8L1CR66w_Hb_rzmqu_k2Wb8KMWeQ@mail.gmail.com>
Message-ID: <1409063124.53fc98d48c3c1@imp.free.fr>

Hanlie,

The warning "VRTSourceRasterBand::iRatserIO() called recursively on the same
band" is bug http://trac.osgeo.org/gdal/ticket/5468
It is due to the statistics computation on the intermediate VRT file
(implementation detail), but shouldn't influence on the image itself
You can run afterward "gdalinfo -stats Test_8bit_JPEG_Compr.TIF" to compute
statistics on the result TIF.

The slowness in QGIS is not surprising since JPEG takes time to decompressing,
especially for big images, that are not tiled and have no overviews. What could
help is to add -co TILED=YES on the gdal_translate command line.
And then run "gdaladdo --config COMPRESS_OVERVIEW JPEG Test_8bit_JPEG_Compr.TIF
2 4 8 16" on the result to create overviews.

Even

> Hi,
>
> I'm trying to convert a 16 bit image to 8 bits and at the same time
> add JPEG compression, but gdal reports errors during the process.
>
> gdal_info for the input file is:
>
> Driver: GTiff/GeoTIFF
>
> Files: D:/SPOT 6/PS_Envi/Test_8bit.TIF
>
> Size is 30717, 28629
>
> Coordinate System is:
>
> PROJCS["WGS 84 / UTM zone 34S",
>
> GEOGCS["WGS 84",
>
> DATUM["WGS_1984",
>
> SPHEROID["WGS 84",6378137,298.257223563,
>
> AUTHORITY["EPSG","7030"]],
>
> AUTHORITY["EPSG","6326"]],
>
> PRIMEM["Greenwich",0],
>
> UNIT["degree",0.0174532925199433],
>
> AUTHORITY["EPSG","4326"]],
>
> PROJECTION["Transverse_Mercator"],
>
> PARAMETER["latitude_of_origin",0],
>
> PARAMETER["central_meridian",21],
>
> PARAMETER["scale_factor",0.9996],
>
> PARAMETER["false_easting",500000],
>
> PARAMETER["false_northing",10000000],
>
> UNIT["metre",1,
>
> AUTHORITY["EPSG","9001"]],
>
> AUTHORITY["EPSG","32734"]]
>
> Origin = (537234.000000000000000,6296730.000000000000000)
>
> Pixel Size = (1.500000000000000,-1.500000000000000)
>
> Metadata:
>
> AREA_OR_POINT=Area
>
> Band_1=CN Sharp R (Band
> 3:IMG_SPOT6_MS_201304220815274_ORT_742338101_R1C1.TIF)
>
> Band_2=CN Sharp G (Band
> 2:IMG_SPOT6_MS_201304220815274_ORT_742338101_R1C1.TIF)
>
> Band_3=CN Sharp B (Band
> 1:IMG_SPOT6_MS_201304220815274_ORT_742338101_R1C1.TIF)
>
> Image Structure Metadata:
>
> INTERLEAVE=PIXEL
>
> Corner Coordinates:
>
> Upper Left ( 537234.000, 6296730.000) ( 21d24' 2.56"E, 33d28' 5.67"S)
>
> Lower Left ( 537234.000, 6253786.500) ( 21d24' 9.04"E, 33d51'20.01"S)
>
> Upper Right ( 583309.500, 6296730.000) ( 21d53'47.54"E, 33d27'56.33"S)
>
> Lower Right ( 583309.500, 6253786.500) ( 21d54' 2.03"E, 33d51'10.53"S)
>
> Center ( 560271.750, 6275258.250) ( 21d39' 0.30"E, 33d39'39.04"S)
>
> Band 1 Block=30717x1 Type=Byte, ColorInterp=Red
>
> Description = CN Sharp R (Band
> 3:IMG_SPOT6_MS_201304220815274_ORT_742338101_R1C1.TIF)
>
> Band 2 Block=30717x1 Type=Byte, ColorInterp=Green
>
> Description = CN Sharp G (Band
> 2:IMG_SPOT6_MS_201304220815274_ORT_742338101_R1C1.TIF)
>
> Band 3 Block=30717x1 Type=Byte, ColorInterp=Blue
>
> Description = CN Sharp B (Band
> 1:IMG_SPOT6_MS_201304220815274_ORT_742338101_R1C1.TIF)
>
> The command I'm using is:
> gdal_translate -ot Byte -of GTiff -scale 0 4905 0 255 -stats -co
> COMPRESS=JPEG "D:/SPOT 6/PS_Envi/Test.TIF" "D:/SPOT
> 6/PS_Envi/Test_8bit_JPEG_Compr.TIF"
>
> The last part of the error message is:
> ERROR 1: IReadBlock failed at X offset 18, Y offset 2
> ERROR 1: VRTSourceRasterBand::iRatserIO() called recursively on the
> same band. It looks like the VRT is referencing itself.
> ERROR 1: IReadBlock failed at X offset 19, Y offset 2
> ERROR 1: VRTSourceRasterBand::iRatserIO() called recursively on the
> same band. It looks like the VRT is referencing itself.
> More than 1000 errors or warnings have been reported. No more will be
> reported from now.
> 0...10...20...30...40...50...60...70...80...90...100 - done.
>
> gdal_translate does complete the process and I get an output file that
> looks usable, but I think something is wrong with the file because
> working with it in QGIS takes longer than the original image, which is
> two orders of magnitude bigger in file size.
>
> gdal_info for the output file is:
> Driver: GTiff/GeoTIFF
>
> Files: D:/SPOT 6/PS_Envi/Test_8bit_JPEG_Compr.TIF
>
> D:/SPOT 6/PS_Envi/Test_8bit_JPEG_Compr.TIF.aux.xml
>
> Size is 30717, 28629
>
> Coordinate System is:
>
> PROJCS["WGS 84 / UTM zone 34S",
>
> GEOGCS["WGS 84",
>
> DATUM["WGS_1984",
>
> SPHEROID["WGS 84",6378137,298.257223563,
>
> AUTHORITY["EPSG","7030"]],
>
> AUTHORITY["EPSG","6326"]],
>
> PRIMEM["Greenwich",0],
>
> UNIT["degree",0.0174532925199433],
>
> AUTHORITY["EPSG","4326"]],
>
> PROJECTION["Transverse_Mercator"],
>
> PARAMETER["latitude_of_origin",0],
>
> PARAMETER["central_meridian",21],
>
> PARAMETER["scale_factor",0.9996],
>
> PARAMETER["false_easting",500000],
>
> PARAMETER["false_northing",10000000],
>
> UNIT["metre",1,
>
> AUTHORITY["EPSG","9001"]],
>
> AUTHORITY["EPSG","32734"]]
>
> Origin = (537234.000000000000000,6296730.000000000000000)
>
> Pixel Size = (1.500000000000000,-1.500000000000000)
>
> Metadata:
>
> AREA_OR_POINT=Area
>
> Band_1=CN Sharp R (Band
> 3:IMG_SPOT6_MS_201304220815274_ORT_742338101_R1C1.TIF)
>
> Band_2=CN Sharp G (Band
> 2:IMG_SPOT6_MS_201304220815274_ORT_742338101_R1C1.TIF)
>
> Band_3=CN Sharp B (Band
> 1:IMG_SPOT6_MS_201304220815274_ORT_742338101_R1C1.TIF)
>
> Image Structure Metadata:
>
> COMPRESSION=JPEG
>
> INTERLEAVE=PIXEL
>
> Corner Coordinates:
>
> Upper Left ( 537234.000, 6296730.000) ( 21d24' 2.56"E, 33d28' 5.67"S)
>
> Lower Left ( 537234.000, 6253786.500) ( 21d24' 9.04"E, 33d51'20.01"S)
>
> Upper Right ( 583309.500, 6296730.000) ( 21d53'47.54"E, 33d27'56.33"S)
>
> Lower Right ( 583309.500, 6253786.500) ( 21d54' 2.03"E, 33d51'10.53"S)
>
> Center ( 560271.750, 6275258.250) ( 21d39' 0.30"E, 33d39'39.04"S)
>
> Band 1 Block=30717x16 Type=Byte, ColorInterp=Red
>
> Description = CN Sharp R (Band
> 3:IMG_SPOT6_MS_201304220815274_ORT_742338101_R1C1.TIF)
>
> Band 2 Block=30717x16 Type=Byte, ColorInterp=Green
>
> Description = CN Sharp G (Band
> 2:IMG_SPOT6_MS_201304220815274_ORT_742338101_R1C1.TIF)
>
> Band 3 Block=30717x16 Type=Byte, ColorInterp=Blue
>
> Description = CN Sharp B (Band
> 1:IMG_SPOT6_MS_201304220815274_ORT_742338101_R1C1.TIF)
>
> Does anybody perhaps know what is going wrong or can suggest another
> method to accomplishing what I wish to?
>
> I have successfully created an 8 bit image without using compression,
> so I'm pretty sure the error stems from the compression operation.
>
> Regards
> Hanlie
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From hanlie.pretorius at gmail.com  Tue Aug 26 08:27:02 2014
From: hanlie.pretorius at gmail.com (Hanlie Pretorius)
Date: Tue, 26 Aug 2014 17:27:02 +0200
Subject: [gdal-dev] Error when trying to compress a TIFF file
In-Reply-To: <1409063124.53fc98d48c3c1@imp.free.fr>
References: <CAFpCUPqV2PK3OpCOxzEtxR8L1CR66w_Hb_rzmqu_k2Wb8KMWeQ@mail.gmail.com>
	<1409063124.53fc98d48c3c1@imp.free.fr>
Message-ID: <CAFpCUPrchtHbMvNrn_sH18JRvTopaeJFWaViCOqV+_TPw6ngaA@mail.gmail.com>

Hi Even,

Thanks, the gdaldo command made a huge difference to the speed with
which QGIS works with the raster.

The image looks a bit shoddy, though, even when zoomed out. It
improved when I set the quality to 100 and the file is still a tenth
of the original size.

Would it help to create more levels in the overview and, if so, at
which end should I add the levels?

Hanlie

2014-08-26 16:25 MGT+02:00, Even Rouault <even.rouault at spatialys.com>:
> Hanlie,
>
> The warning "VRTSourceRasterBand::iRatserIO() called recursively on the
> same
> band" is bug http://trac.osgeo.org/gdal/ticket/5468
> It is due to the statistics computation on the intermediate VRT file
> (implementation detail), but shouldn't influence on the image itself
> You can run afterward "gdalinfo -stats Test_8bit_JPEG_Compr.TIF" to compute
> statistics on the result TIF.
>
> The slowness in QGIS is not surprising since JPEG takes time to
> decompressing,
> especially for big images, that are not tiled and have no overviews. What
> could
> help is to add -co TILED=YES on the gdal_translate command line.
> And then run "gdaladdo --config COMPRESS_OVERVIEW JPEG
> Test_8bit_JPEG_Compr.TIF
> 2 4 8 16" on the result to create overviews.
>
> Even
>

From even.rouault at spatialys.com  Tue Aug 26 08:34:23 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 26 Aug 2014 17:34:23 +0200
Subject: [gdal-dev] Error when trying to compress a TIFF file
In-Reply-To: <CAFpCUPrchtHbMvNrn_sH18JRvTopaeJFWaViCOqV+_TPw6ngaA@mail.gmail.com>
References: <CAFpCUPqV2PK3OpCOxzEtxR8L1CR66w_Hb_rzmqu_k2Wb8KMWeQ@mail.gmail.com>
	<1409063124.53fc98d48c3c1@imp.free.fr>
	<CAFpCUPrchtHbMvNrn_sH18JRvTopaeJFWaViCOqV+_TPw6ngaA@mail.gmail.com>
Message-ID: <1409067263.53fca8ff2a913@imp.free.fr>

Selon Hanlie Pretorius <hanlie.pretorius at gmail.com>:

> Hi Even,
>
> Thanks, the gdaldo command made a huge difference to the speed with
> which QGIS works with the raster.
>
> The image looks a bit shoddy, though, even when zoomed out. It
> improved when I set the quality to 100 and the file is still a tenth
> of the original size.

You can try adding -r average or -r cubic when computing overviews with gdaladdo
to improve a bit their quality.

>
> Would it help to create more levels in the overview and, if so, at
> which end should I add the levels?

Your full-res image is around 30000 x 30000.
With a max overview of factor 16 as in the below command, you have an image of
approximate size 1800x1800, which is still a bit big
Targetting 256x256 for the smallest overview would bring you instantaneous
opening in QGIS. So 30000 / 256 = 117.XXXX, round that to 128. So use "2 4 8 16
32 64 128".

>
> Hanlie
>
> 2014-08-26 16:25 MGT+02:00, Even Rouault <even.rouault at spatialys.com>:
> > Hanlie,
> >
> > The warning "VRTSourceRasterBand::iRatserIO() called recursively on the
> > same
> > band" is bug http://trac.osgeo.org/gdal/ticket/5468
> > It is due to the statistics computation on the intermediate VRT file
> > (implementation detail), but shouldn't influence on the image itself
> > You can run afterward "gdalinfo -stats Test_8bit_JPEG_Compr.TIF" to compute
> > statistics on the result TIF.
> >
> > The slowness in QGIS is not surprising since JPEG takes time to
> > decompressing,
> > especially for big images, that are not tiled and have no overviews. What
> > could
> > help is to add -co TILED=YES on the gdal_translate command line.
> > And then run "gdaladdo --config COMPRESS_OVERVIEW JPEG
> > Test_8bit_JPEG_Compr.TIF
> > 2 4 8 16" on the result to create overviews.
> >
> > Even
> >
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From hanlie.pretorius at gmail.com  Tue Aug 26 09:11:43 2014
From: hanlie.pretorius at gmail.com (Hanlie Pretorius)
Date: Tue, 26 Aug 2014 18:11:43 +0200
Subject: [gdal-dev] Error when trying to compress a TIFF file
In-Reply-To: <1409067263.53fca8ff2a913@imp.free.fr>
References: <CAFpCUPqV2PK3OpCOxzEtxR8L1CR66w_Hb_rzmqu_k2Wb8KMWeQ@mail.gmail.com>
	<1409063124.53fc98d48c3c1@imp.free.fr>
	<CAFpCUPrchtHbMvNrn_sH18JRvTopaeJFWaViCOqV+_TPw6ngaA@mail.gmail.com>
	<1409067263.53fca8ff2a913@imp.free.fr>
Message-ID: <CAFpCUPoEB9yLOjONm2OHHzGfGjLK847BsWoT2AEE8eHQQv8Wug@mail.gmail.com>

Thanks, the r- average option improved the quality quite a bit.

2014-08-26 17:34 MGT+02:00, Even Rouault <even.rouault at spatialys.com>:
> Selon Hanlie Pretorius <hanlie.pretorius at gmail.com>:
>
>> Hi Even,
>>
>> Thanks, the gdaldo command made a huge difference to the speed with
>> which QGIS works with the raster.
>>
>> The image looks a bit shoddy, though, even when zoomed out. It
>> improved when I set the quality to 100 and the file is still a tenth
>> of the original size.
>
> You can try adding -r average or -r cubic when computing overviews with
> gdaladdo
> to improve a bit their quality.
>
>>
>> Would it help to create more levels in the overview and, if so, at
>> which end should I add the levels?
>
> Your full-res image is around 30000 x 30000.
> With a max overview of factor 16 as in the below command, you have an image
> of
> approximate size 1800x1800, which is still a bit big
> Targetting 256x256 for the smallest overview would bring you instantaneous
> opening in QGIS. So 30000 / 256 = 117.XXXX, round that to 128. So use "2 4 8
> 16
> 32 64 128".
>
>>

From even.rouault at spatialys.com  Wed Aug 27 00:46:34 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 27 Aug 2014 09:46:34 +0200
Subject: [gdal-dev] Converting MDB File With Unicode Characters
In-Reply-To: <1409049229669-5158338.post@n6.nabble.com>
References: <1408949713323-5158087.post@n6.nabble.com>
	<1409039136.53fc3b20d92a8@imp.free.fr>
	<1409049229669-5158338.post@n6.nabble.com>
Message-ID: <201408270946.34388.even.rouault@spatialys.com>

Le mardi 26 ao?t 2014 12:33:49, Tomer a ?crit :
> i tried different options in the Encoding menu but none displayed the file
> correctly. I think the problem is caused by incorrect reading of the mdb
> file made ??by the driver.

You could open a ticket in Trac (see "Submit a new bug report" on 
http://trac.osgeo.org/gdal/wiki) with a sample mdb attached (attachment size 
is limited, so potentially just an extract of it that demonstrate the issue)

> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/Converting-MDB-File-With-Unicode-Chara
> cters-tp5158087p5158338.html Sent from the GDAL - Dev mailing list archive
> at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at mmmtike.fi  Wed Aug 27 03:03:07 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Wed, 27 Aug 2014 10:03:07 +0000 (UTC)
Subject: [gdal-dev] Wrong statistics from gdalinfo
Message-ID: <loom.20140827T115255-775@post.gmane.org>

Hi,

My colleague found that gdalinfo -stats is giving wrong statistics for this
7.8 GB sized GeoTIFF file http://latuviitta.kapsi.fi/data/dem10m/dem_10m.tif

Gdalinfo -stats is listing

...
  Min=-999.999 Max=893.885
  Minimum=-999.999, Maximum=893.885, Mean=41.967, StdDev=174.896
  Metadata:
    STATISTICS_MAXIMUM=893.88500976563
    STATISTICS_MEAN=41.9674566748
    STATISTICS_MINIMUM=-999.9990234375
    STATISTICS_STDDEV=174.89632155312

However, there are higher values in this DEM and gdallocationinfo proves it:

C:\>gdallocationinfo -geoloc /vsicurl/
http://latuviitta.kapsi.fi/data/dem10m/dem_10m.tif 278281 7689681
Report:
  Location: (22228P,9232L)
  Band 1:
    Value: 1005.67901611328

-Jukka Rahkonen-


From even.rouault at spatialys.com  Wed Aug 27 06:06:51 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 27 Aug 2014 15:06:51 +0200
Subject: [gdal-dev] Wrong statistics from gdalinfo
In-Reply-To: <loom.20140827T115255-775@post.gmane.org>
References: <loom.20140827T115255-775@post.gmane.org>
Message-ID: <201408271506.51996.even.rouault@spatialys.com>

Jukka,

I suspect the file has been updated after first statistics have been computed, 
or perhaps they have been computed in -approx_stats mode.

gdalinfo -stats doesn't recompute statistics if they are already stored in the 
file.

I've done a "gdal_translate dem_10m.tif out.tif -co tiled=yes -co 
compress=deflate -stats" to force statistics recomputation

The updated stats are :
    STATISTICS_MAXIMUM=2002.291015625
    STATISTICS_MEAN=49.848418026241
    STATISTICS_MINIMUM=-1059.7540283203
    STATISTICS_STDDEV=163.15374152281

I've just added a -unsetstats flag to gdal_edit.py to clear statistics.

Even

Le mercredi 27 ao?t 2014 12:03:07, Jukka Rahkonen a ?crit :
> Hi,
> 
> My colleague found that gdalinfo -stats is giving wrong statistics for this
> 7.8 GB sized GeoTIFF file
> http://latuviitta.kapsi.fi/data/dem10m/dem_10m.tif
> 
> Gdalinfo -stats is listing
> 
> ...
>   Min=-999.999 Max=893.885
>   Minimum=-999.999, Maximum=893.885, Mean=41.967, StdDev=174.896
>   Metadata:
>     STATISTICS_MAXIMUM=893.88500976563
>     STATISTICS_MEAN=41.9674566748
>     STATISTICS_MINIMUM=-999.9990234375
>     STATISTICS_STDDEV=174.89632155312
> 
> However, there are higher values in this DEM and gdallocationinfo proves
> it:
> 
> C:\>gdallocationinfo -geoloc /vsicurl/
> http://latuviitta.kapsi.fi/data/dem10m/dem_10m.tif 278281 7689681
> Report:
>   Location: (22228P,9232L)
>   Band 1:
>     Value: 1005.67901611328
> 
> -Jukka Rahkonen-
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at mmmtike.fi  Wed Aug 27 06:17:58 2014
From: jukka.rahkonen at mmmtike.fi (Rahkonen Jukka  (Tike))
Date: Wed, 27 Aug 2014 13:17:58 +0000
Subject: [gdal-dev] Wrong statistics from gdalinfo
Message-ID: <EFE5D7EE2EC8D3438FE02E356F81E35A11B06019@FIHGA-EXMBX03.msvyvi.vaha.local>

> Jukka,
> 
> I suspect the file has been updated after first statistics have been computed, or
> perhaps they have been computed in -approx_stats mode.
> 
> gdalinfo -stats doesn't recompute statistics if they are already stored in the file.

All right, the statistics are how they are because the big GeoTIFF is created from this VRT file
http://latuviitta.kapsi.fi/data/dem10m/dem_10m.vrt

The wrong statistics seem to be stored into VRT. I do not know where the statistics came into VRT. The VRT has been created with gdalbuildvrt. 

-Jukka-

From sylvain_duclos at yahoo.com  Wed Aug 27 07:22:19 2014
From: sylvain_duclos at yahoo.com (s duclos)
Date: Wed, 27 Aug 2014 07:22:19 -0700
Subject: [gdal-dev] Convert S57 to image with S52 rendering
In-Reply-To: <1409040273309-5158302.post@n6.nabble.com>
Message-ID: <1409149339.76440.YahooMailBasic@web160504.mail.bf1.yahoo.com>

Storkur,

I just found your mail in the spam box.

The code is now at : https://github.com/sduclos/S52

It is base on very old S52 Specs https://github.com/sduclos/S52/blob/master/doc/pslb03_2.pdf

Newer specs are not free.

I don't know about tiling but I think MapServer can do that.


Rgds,

Sylvain Duclos.


--------------------------------------------
On Tue, 8/26/14, Storkur <sovofmad at yandex.ru> wrote:

 Subject: Re: [gdal-dev] Convert S57 to image with S52 rendering
 To: gdal-dev at lists.osgeo.org
 Received: Tuesday, August 26, 2014, 4:04 AM
 
 We are also interested in such
 combination of libs.
 
 Best regards
 
 
 
 --
 View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Convert-S57-to-image-with-S52-rendering-tp4987897p5158302.html
 Sent from the GDAL - Dev mailing list archive at
 Nabble.com.
 _______________________________________________
 gdal-dev mailing list
 gdal-dev at lists.osgeo.org
 http://lists.osgeo.org/mailman/listinfo/gdal-dev
 

From flippmoke at gmail.com  Thu Aug 28 10:10:25 2014
From: flippmoke at gmail.com (Blake Thompson)
Date: Thu, 28 Aug 2014 12:10:25 -0500
Subject: [gdal-dev] RFC 47 and Threading
In-Reply-To: <201408222246.45872.even.rouault@spatialys.com>
References: <CAPxHBh9szm_RmMhNMgTTQFTjc_x=dAndVFPvFXzK+F6nn0nXfg@mail.gmail.com>
	<201408222155.34437.even.rouault@spatialys.com>
	<CAPxHBh-FEjRwtGE9FXZmBmDBGdRcS6LfUtvbPRfRL_pgZhg6SQ@mail.gmail.com>
	<201408222246.45872.even.rouault@spatialys.com>
Message-ID: <CAPxHBh_-239t2mwDaZCyxs2jQbPNLY-P+p-paxH5M-QuvxjcnA@mail.gmail.com>

Even,

> Yeah, that why was I suggested the reverse ;-) But an automatic renaming
> should be doable.
> Another danger of keeping IReadBlock and making it now responsible of
> ensuring
> its thread safety is for out-of-tree drivers that wouldn't realize they
> need
> to change something as code would still compile (but it is their business
> to
> follow GDAL RFCs isn't it ?...)
> If we were nice, we would have a dummy IReadBlock() in the interface with a
> change of signature to trigger compilation errors of non-upgraded drivers,
> and
> IReadBlock_thread_safe, IReadBlock_not_thread_safe.
>
> I have spent quite a bit of time thinking about how I would like to
implement it all to be very clear to the driver developers what is going on
here. I really do not like the term "thread safe" in many ways to describe
the IReadBlock, because what it really is in this instance is "thread safe
for the cache". Many people will think it is about making it "thread safe
for the driver" which it is not dealing with. I spent a lot of effort to
try to make every driver thread safe for the cache in solution #2, and in
some ways adding the "not_thread_safe" option seems like undoing a lot of
the work I put forth. (In hindsight I should have done that it would have
been much easier). I do think there should be compile warnings if someone
has not updated their IReadBlock to include the phMutex parameter.



> >
> > > You didn't answer my question on how many drivers can have a
> non-blocking
> > > IReadBlock() implementation in practice. My intutition (reinforced by
> > > skimming
> > > through https://github.com/OSGeo/gdal/pull/39/files) is just/mostly
> > > MEMDataset.
> > > So people looking at drivers would just see the classical IReadBlock()
> > > implementation and wouldn't have to think a lot about thread safety
> (that
> > > would be brought by the generic
> > > GDALRasterBand::IReadBlock_thread_safe()).
> >
> > I honestly have no idea how many drivers can have a non-blocking
> IReadBlock
> > with this setup. I really do not understand all the drivers well enough
> to
> > give an estimate (so I would assume yours is probably most correct).
>
> See one of my previous answers about the fundamental reason why most
> IReadBlock() implementations need a lock around their slowest part : being
> it
> file access or database access. Honestly, it is not worth just locking the
> part
> that takes most of the time instead of locking the whole method. It could
> be
> worth when decompression is involved for example, but in all cases I can
> think
> of (jpeg2000, jpeg, png, libtiff, ecw, sid, etc...) the I/O part and
> decompression part are done in a single call from GDAL point of view.
>

Re-reading a lot of our discussions, I feel like that making a
"non-blocking IReadBlock" that works for the driver should really be more
handled by the other discussion we were having about a having a read-only
safe dataset (other then Mem). In which case I am really starting to like
the idea of a default thread-safe wrapper, and then driver specific safe
implementations.


>
> > I have
> > been mostly concerned with first just making the cache threadsafe, then
> was
> > thinking we could start targeting drivers individually.
>
> The truth is that the majority of drivers are esoteric, whereas perhaps
> just
> 10 are used 90% of the time. So it would be a waste of energy to have to
> spend
> too much time on the former ones.
>
> >
> > > > I somewhat like that idea that drivers
> > > > should consider their thread safety.
> > >
> > > I somewhat like the idea they shouldn't have to bother about that ;-)
> > > especially if we can have improvements in core only that improve
> > > thread-safe
> > > usage and performance. The people wanting to gain one more extra % of
> > > performance might take the risk of doing a custom thread-safe
> > > implementation
> > > in the driver.
> >
> > My thought here was more along the lines of "the driver is going to write
> > to the block cache so it should have the responsibility to lock when it
> > needs to be locked". To me this was better in some manners then "in most
> > case implement this method, which if I use improperly might cause
> deadlocks
> > or corruptions, otherwise implement this method".
>
> To be pedant, IReadBlock() can be called with any user buffer, not only
> the one
> of a GDALRasterBlock. Driver writers can currently write a driver without
> knowing much about the block cache mechanism. They just need to know
> "there's
> something in core that will magically ensure that any RasterIO() is
> transformed in the right sequence of call to my simple IReadBlock()"
>
> Not that I worry much about driver writers, but it seems more elegant to
> me if
> complexity is in the core rather than popping up in each and every driver.


I agree that it would be more elegant if it wasn't as big of a problem. It
seems that lots of drivers have pixel interleaving and or call IRasterIO or
other edge cases so they need to implement the special method anyhow to
protect the cache. It might be more elegant, but are we making it more
elegant for just the other drivers that aren't in the 90%? How many of the
90% of the time used drivers use pixel intervealed methods?

As well I can certainly go back through and change many of the drivers to
use a common way of just locking to protect the data passed in IReadBlock
etc, but I would still have to rename their current IReadBlock methods to
IReadBlockNotCacheThreadSafe or something. This still makes the amount of
changes I introduce with this just as large. I am willing to do this, but
not convinced still that it really helps a lot

Thanks,

Blake
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140828/dce5014a/attachment.html>

From even.rouault at spatialys.com  Thu Aug 28 10:46:23 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 28 Aug 2014 19:46:23 +0200
Subject: [gdal-dev] Fwd: Re:  RFC 47 and Threading
Message-ID: <201408281946.24065.even.rouault@spatialys.com>

Was likely intended to be "Reply all"

----------  Message transmis  ----------

Sujet : Re: [gdal-dev] RFC 47 and Threading
Date : jeudi 28 ao?t 2014, 19:20:01
De : Blake Thompson <flippmoke at gmail.com>
? : Even Rouault <even.rouault at spatialys.com>

Even and Andre,

> I want to start off by saying a big thanks to Blake for taking his time
> > to tackle what can only be a very difficult problem.
> >  From what I can observe, the current discussion seems to be around the
> > boundary of who should be responsible for ensuring thread safety around
> > the block cache. The core of GDAL versus the individual drivers.
>
> The core will necessarily have to know about thread-safety because the
> block
> cache is there. The discussion is more whether the drivers must also
> necessary
> be thread aware, or if core mechanisms are sufficient to hide this detail
> to the
> drivers. And potentially offering to drivers a mechanism to deal
> themselves with
> thread-safety if they can have a more optimized implementation than the
> default
> one.


Agreed, most specifically how to hide the detail of the protection of the
pointer to the block cache's data that is passed through IReadBlock,
IWriteBlock, and IRasterIO.


> > While I
> > see why such a conversation is important, as far as I am concerned, the
> > most important part should be how it affects users of GDAL at the
> > interface level.
>
> Agreed.
>
> > That is, if an application that is threaded is trying
> > to use GDAL, how does it ensure thread-safety? What you have to keep in
> > mind is that having some parts of the library not thread-safe basically
> > just pushes the mutexing/locking to the calling applications.
>
> Not necessarily. That's what I suggested in my previous email : if the
> costs of
> the mutex are not too expensive for non-threaded usage, then the API could
> systematically return thread-safe versions, that are potentially wrapped by
> GDALDatasetThreadSafe
>

So in the scope of my RFC, I am not certain how we could have a thread safe
cache and a non-threadsafe cache in any simple manner. I know that you are
specifically talking about the possiblity of thread safe datasets, which I
feel is necessarily part of this discussion but wanted to separate the two.
If the thread-safe cache is too expensive I feel like that is a major issue
however, and I am doing my best to avoid any performance hits for this
change.


>
> >
> > Also, while it is important to document thread-safety limitations, might
> > I suggest adding thread-safe related capabilities (TestCapability),
> > especially if all drivers do not end-up having the same thread-safety
> > constraints.
>
> That might be a solution, although not ideal from a usability point of
> view (if
> we come with something more complex that non-thread-safe vs thread-safe,
> that
> might be difficult to understand by users of GDAL API), and from a
> GDAL-developer point of view as well (need to assess thread-safety for each
> driver).
> There can have subtelties : imagine that the VRT driver is made to be
> thread
> safe, but uses sources of drivers that might be not thread safe...
>
> >
> > I personally do not see a GDALDatasetThreadSafe wrapper as adding much
> > complexity. For instance, if you were to add a capability that indicates
> > if a driver is inherently thread-safe, you could add a new open method
> > to open a dataset in a thread-safe way with something like the following
> > pseudocode:
> >
> > DataSet OpenThreadSafe(GDALOpenInfo openInfo)
> > {
> >      DataSet dataSet = Open(openInfo);
> >
> >      if (!dataSet.TestCapability(THREAD_SAFE))
> >      {
> >           dataSet = wrapWithThreadSafeWrapper(dataSet);
> >      }
> >
> >      return dataSet;
> > }
>
> Yes, that's similar to what I imagined with my idea of GDAL_OF_THREADSAFE
> open
> flag.


On the topic of the thread safe wrapper, I have spent more time thinking
about it and I think this is probably the best solution to the problem of
making all Datasets read safe, and I am willing to champion another RFC to
implement this. However, the scope of this is even larger because it should
be required to work with the OGR datasets as well.

Thanks,

Blake

-------------------------------------------------------
-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From flippmoke at gmail.com  Thu Aug 28 11:35:26 2014
From: flippmoke at gmail.com (Blake Thompson)
Date: Thu, 28 Aug 2014 13:35:26 -0500
Subject: [gdal-dev] RFC 47 and Threading
In-Reply-To: <CAPxHBh_-239t2mwDaZCyxs2jQbPNLY-P+p-paxH5M-QuvxjcnA@mail.gmail.com>
References: <CAPxHBh9szm_RmMhNMgTTQFTjc_x=dAndVFPvFXzK+F6nn0nXfg@mail.gmail.com>
	<201408222155.34437.even.rouault@spatialys.com>
	<CAPxHBh-FEjRwtGE9FXZmBmDBGdRcS6LfUtvbPRfRL_pgZhg6SQ@mail.gmail.com>
	<201408222246.45872.even.rouault@spatialys.com>
	<CAPxHBh_-239t2mwDaZCyxs2jQbPNLY-P+p-paxH5M-QuvxjcnA@mail.gmail.com>
Message-ID: <CAPxHBh8y6NyeYVUGHNudkpYnQf8=XgpwRy-YiTgcL0Et8x-wkQ@mail.gmail.com>

Even and Andre,

> I want to start off by saying a big thanks to Blake for taking his time
> > to tackle what can only be a very difficult problem.
> >  From what I can observe, the current discussion seems to be around the
> > boundary of who should be responsible for ensuring thread safety around
> > the block cache. The core of GDAL versus the individual drivers.
>
> The core will necessarily have to know about thread-safety because the
> block
> cache is there. The discussion is more whether the drivers must also
> necessary
> be thread aware, or if core mechanisms are sufficient to hide this detail
> to the
> drivers. And potentially offering to drivers a mechanism to deal
> themselves with
> thread-safety if they can have a more optimized implementation than the
> default
> one.


Agreed, most specifically how to hide the detail of the protection of the
pointer to the block cache's data that is passed through IReadBlock,
IWriteBlock, and IRasterIO.


> > While I
> > see why such a conversation is important, as far as I am concerned, the
> > most important part should be how it affects users of GDAL at the
> > interface level.
>
> Agreed.
>
> > That is, if an application that is threaded is trying
> > to use GDAL, how does it ensure thread-safety? What you have to keep in
> > mind is that having some parts of the library not thread-safe basically
> > just pushes the mutexing/locking to the calling applications.
>
> Not necessarily. That's what I suggested in my previous email : if the
> costs of
> the mutex are not too expensive for non-threaded usage, then the API could
> systematically return thread-safe versions, that are potentially wrapped by
> GDALDatasetThreadSafe
>

So in the scope of my RFC, I am not certain how we could have a thread safe
cache and a non-threadsafe cache in any simple manner. I know that you are
specifically talking about the possiblity of thread safe datasets, which I
feel is necessarily part of this discussion but wanted to separate the two.
If the thread-safe cache is too expensive I feel like that is a major issue
however, and I am doing my best to avoid any performance hits for this
change.


>
> >
> > Also, while it is important to document thread-safety limitations, might
> > I suggest adding thread-safe related capabilities (TestCapability),
> > especially if all drivers do not end-up having the same thread-safety
> > constraints.
>
> That might be a solution, although not ideal from a usability point of
> view (if
> we come with something more complex that non-thread-safe vs thread-safe,
> that
> might be difficult to understand by users of GDAL API), and from a
> GDAL-developer point of view as well (need to assess thread-safety for each
> driver).
> There can have subtelties : imagine that the VRT driver is made to be
> thread
> safe, but uses sources of drivers that might be not thread safe...
>
> >
> > I personally do not see a GDALDatasetThreadSafe wrapper as adding much
> > complexity. For instance, if you were to add a capability that indicates
> > if a driver is inherently thread-safe, you could add a new open method
> > to open a dataset in a thread-safe way with something like the following
> > pseudocode:
> >
> > DataSet OpenThreadSafe(GDALOpenInfo openInfo)
> > {
> >      DataSet dataSet = Open(openInfo);
> >
> >      if (!dataSet.TestCapability(THREAD_SAFE))
> >      {
> >           dataSet = wrapWithThreadSafeWrapper(dataSet);
> >      }
> >
> >      return dataSet;
> > }
>
> Yes, that's similar to what I imagined with my idea of GDAL_OF_THREADSAFE
> open
> flag.


On the topic of the thread safe wrapper, I have spent more time thinking
about it and I think this is probably the best solution to the problem of
making all Datasets read safe, and I am willing to champion another RFC to
implement this. However, the scope of this is even larger because it should
be required to work with the OGR datasets as well.

Thanks,

Blake
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140828/8571e6e7/attachment-0001.html>

From richsharp at stanford.edu  Thu Aug 28 14:32:38 2014
From: richsharp at stanford.edu (Richard Sharp)
Date: Thu, 28 Aug 2014 14:32:38 -0700
Subject: [gdal-dev] why do I get a floating point nodata value from a byte
	raster?
Message-ID: <CAGuVLy07f+mRtGXe2fXd7n-1boY7PuqEYe3=3vcUPmN6u3CE0Q@mail.gmail.com>

I have a byte GTiff dataset that has a nodata value of 0 according to QGIS.
 However, when I load it using the gdal python API, I get this:

>>> ds= gdal.Open('cdl10lu83.tif')
>>> band=ds.GetRasterBand(1)
>>> band.GetNoDataValue()
-3.4028230607370965e+38

Also when I run `gdalinfo` I see the same nodata value:

Band 1 Block=128x128 Type=Byte, ColorInterp=Gray
  Min=0.000 Max=26.000
  Minimum=0.000, Maximum=26.000, Mean=10.115, StdDev=5.072
  NoData Value=-3.4028230607370965e+038

I'm running GDAL 1.11.0, although I've also experienced the same behavior
on gdalinfo with 1.9.0. I'm using QGIS 2.4 which is built against GDAL 1.9.

Any ideas what's going on and how to handle it?

--
Richard P. Sharp Jr.
Lead Software Architect
Natural Capital Project
Stanford University, U Minnesota, TNC, WWF
371 Serra Mall
Stanford, CA 94305
http://www.stanford.edu/~rpsharp/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140828/a8ecf86d/attachment.html>

From ljvillarin30 at gmail.com  Thu Aug 28 19:09:02 2014
From: ljvillarin30 at gmail.com (precy)
Date: Thu, 28 Aug 2014 19:09:02 -0700 (PDT)
Subject: [gdal-dev] Problem encountered in stitching/merging the raster files
Message-ID: <1409278142515-5158957.post@n6.nabble.com>

I have 4(sometimes 5) raster images and projected these using gdalwarp. I've
tried stitching these images using these commands gdal_merge.py -n 0
-a_nodata 0 -of GTiff -0 output.tif a.tif b.tif c.tif d.tif e.tif. The first
3 images was stitched and the last 2 images was also stitched, but they were
stitched separately but saved in one image.How will I solve this? 

I want the 5 raster to be stitch(mosaic) properly without spaces in between.
I have attached here the output image(as what you will observe there was a
space/cut in between the stitched images). Thanks!

<http://osgeo-org.1560.x6.nabble.com/file/n5158957/output.gif> 

Note: The original image was a tif file, I just converted it in gif because
it returned error due to the limit of the message size.







--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Problem-encountered-in-stitching-merging-the-raster-files-tp5158957.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From nixanz at nixanz.com  Thu Aug 28 19:42:35 2014
From: nixanz at nixanz.com (Nik Sands)
Date: Fri, 29 Aug 2014 12:42:35 +1000
Subject: [gdal-dev] How get EPSG code from an OGRSpatialReferenceH?
Message-ID: <94EB2E71-FC4F-40DF-A25E-BFD9BA0B65F8@nixanz.com>

Hi devs,

What is the correct way to extract the EPSG code from an OGRSpatialReferenceH ?

Currently I'm finding that the following works only for SRS of some images and not others:

	const char *charAuthType = OSRGetAttrValue(gdal.srcSRS, "AUTHORITY", 0);
	const char *charSrsCode = OSRGetAttrValue(gdal.srcSRS, "AUTHORITY", 1);

However, there is no "AUTHORITY" node in some SRSs so it doesn't work for those images.  To cater for this, I'm trying to explicitly set the authority node using:

	OSRAutoIdentifyEPSG(gdal.srcSRS);

But this fails with OGRERR_UNSUPPORTED_SRS (even when it is an SRS that GDAL recognises and uses well).

So I'm stumped... how do I reliably determine the EPSG for an OGRSpatialReferenceH?

Cheers,
Nik.


From gdal at stripfamily.net  Thu Aug 28 20:20:16 2014
From: gdal at stripfamily.net (David Strip)
Date: Thu, 28 Aug 2014 21:20:16 -0600
Subject: [gdal-dev] How get EPSG code from an OGRSpatialReferenceH?
In-Reply-To: <94EB2E71-FC4F-40DF-A25E-BFD9BA0B65F8@nixanz.com>
References: <94EB2E71-FC4F-40DF-A25E-BFD9BA0B65F8@nixanz.com>
Message-ID: <53FFF170.8060402@stripfamily.net>

It's my recollection from a question I posted here  a little over a year
ago that except for a few special cases, autoIdentifyEPSG only works if
there is an authority node providing the EPSG. Hopefully someone will
give you an authoritative answer. I believe GeoTools has the capability
to find the EPSG from the WKT, but I have no idea how to interface to that

On 8/28/2014 8:42 PM, Nik Sands wrote:
> Hi devs,
>
> What is the correct way to extract the EPSG code from an OGRSpatialReferenceH ?
>
> Currently I'm finding that the following works only for SRS of some images and not others:
>
> 	const char *charAuthType = OSRGetAttrValue(gdal.srcSRS, "AUTHORITY", 0);
> 	const char *charSrsCode = OSRGetAttrValue(gdal.srcSRS, "AUTHORITY", 1);
>
> However, there is no "AUTHORITY" node in some SRSs so it doesn't work for those images.  To cater for this, I'm trying to explicitly set the authority node using:
>
> 	OSRAutoIdentifyEPSG(gdal.srcSRS);
>
> But this fails with OGRERR_UNSUPPORTED_SRS (even when it is an SRS that GDAL recognises and uses well).
>
> So I'm stumped... how do I reliably determine the EPSG for an OGRSpatialReferenceH?
>
> Cheers,
> Nik.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


From sovofmad at yandex.ru  Thu Aug 28 23:10:59 2014
From: sovofmad at yandex.ru (Storkur)
Date: Thu, 28 Aug 2014 23:10:59 -0700 (PDT)
Subject: [gdal-dev] Convert S57 to image with S52 rendering
In-Reply-To: <1409149339.76440.YahooMailBasic@web160504.mail.bf1.yahoo.com>
References: <4FFE8D3C.5030706@t-kartor.se>
	<1409040273309-5158302.post@n6.nabble.com>
	<1409149339.76440.YahooMailBasic@web160504.mail.bf1.yahoo.com>
Message-ID: <1409292659969-5158977.post@n6.nabble.com>

Sylvain Duclos,
Thanks.

And is there is simple way to automaticaly convert s-57 maps to tiled raster
images with specified scale? May be not following s-52 specs.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Convert-S57-to-image-with-S52-rendering-tp4987897p5158977.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From jrepetto at free.fr  Thu Aug 28 23:27:33 2014
From: jrepetto at free.fr (Jean-Claude Repetto)
Date: Fri, 29 Aug 2014 08:27:33 +0200
Subject: [gdal-dev] Problem encountered in stitching/merging the raster
 files
In-Reply-To: <1409278142515-5158957.post@n6.nabble.com>
References: <1409278142515-5158957.post@n6.nabble.com>
Message-ID: <54001D55.70806@free.fr>

On 29/08/2014 04:09, precy wrote:
> I have 4(sometimes 5) raster images and projected these using gdalwarp. I've
> tried stitching these images using these commands gdal_merge.py -n 0
> -a_nodata 0 -of GTiff -0 output.tif a.tif b.tif c.tif d.tif e.tif. The first
> 3 images was stitched and the last 2 images was also stitched, but they were
> stitched separately but saved in one image.How will I solve this?
>
> I want the 5 raster to be stitch(mosaic) properly without spaces in between.
> I have attached here the output image(as what you will observe there was a
> space/cut in between the stitched images). Thanks!
>
> <http://osgeo-org.1560.x6.nabble.com/file/n5158957/output.gif>
>
> Note: The original image was a tif file, I just converted it in gif because
> it returned error due to the limit of the message size.


You can use gdalwarp to reproject and merge several maps at the same time :
gdalwarp -t_srs srs_def a.tif b.tif c.tif d.tif e.tif output.tif


From ljvillarin30 at gmail.com  Fri Aug 29 00:04:36 2014
From: ljvillarin30 at gmail.com (user_name)
Date: Fri, 29 Aug 2014 00:04:36 -0700 (PDT)
Subject: [gdal-dev] Problem encountered in stitching/merging the raster
	files
In-Reply-To: <54001D55.70806@free.fr>
References: <1409278142515-5158957.post@n6.nabble.com> <54001D55.70806@free.fr>
Message-ID: <1409295876911-5158992.post@n6.nabble.com>

I've tried your suggestion but then the result was this:
Note: I used OpenEV to open the file.


<http://osgeo-org.1560.x6.nabble.com/file/n5158992/openev.gif> 



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Problem-encountered-in-stitching-merging-the-raster-files-tp5158957p5158992.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From joao.f.r.gaspar at gmail.com  Fri Aug 29 03:45:08 2014
From: joao.f.r.gaspar at gmail.com (=?ISO-8859-1?Q?Jo=E3o_Gaspar?=)
Date: Fri, 29 Aug 2014 11:45:08 +0100
Subject: [gdal-dev] Try to create a .bat for ogr2ogr
Message-ID: <CAM+zXj1WhJ_aHEsfb=rbpQo5KYZVSgjiGLy__HHxLfnpKUt66w@mail.gmail.com>

Hi guys,

i'm giving the first steps in this kind of programming.

So the scenario is:

I have a lot of users that dump work shapfiles into a folder, then i need
to upload this files to a database into a single table (at this time i'm
testing the PostGIS).

So I read some snippets code and some tutorials and i try to do the .bat
but at this time i have some errors.

Note: I put the name of user and password with dummy value :)

The error that give me for the 2 test shapefiles that i try to import is:

ERROR 1: Unable to write feature 0 from layer Polygon1.

ERROR 1: Terminating translation prematurely after failed
translation of layer Polygon1 (use -skipfailures to skip errors)

ERROR 1: Unable to write feature 0 from layer Polygon2.

ERROR 1: Terminating translation prematurely after failed
translation of layer Polygon2 (use -skipfailures to skip errors)

My actual code of the .bat is:


@echo off
for %%I in (inputs_pggis\*.shp) do (
echo Import shapefile %%~nxI to schema temp.upload
  Tabela PostGIS ...
ogr2ogr -append -update -f PostgreSQL PG:"dbname='temp_gis'
user='test_user' password='test_pss'" inputs_pggis/%%~nxI -nln temp.upload
)


Best Regards,
Jo?o
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140829/ede336c5/attachment.html>

From sylvain_duclos at yahoo.com  Fri Aug 29 07:11:45 2014
From: sylvain_duclos at yahoo.com (s duclos)
Date: Fri, 29 Aug 2014 07:11:45 -0700
Subject: [gdal-dev] Convert S57 to image with S52 rendering
In-Reply-To: <1409292659969-5158977.post@n6.nabble.com>
Message-ID: <1409321505.38788.YahooMailBasic@web160504.mail.bf1.yahoo.com>

Storkur,

Yes, use the call :

S52_dumpS57IDPixels(const char *toFilename, unsigned int S57ID, unsigned int width, unsigned int height);

Check https://github.com/sduclos/S52/blob/master/S52.h for details


rgds,

Sylvain.

--------------------------------------------
On Fri, 8/29/14, Storkur <sovofmad at yandex.ru> wrote:

 Subject: Re: [gdal-dev] Convert S57 to image with S52 rendering
 To: gdal-dev at lists.osgeo.org
 Received: Friday, August 29, 2014, 2:10 AM
 
 Sylvain Duclos,
 Thanks.
 
 And is
 there is simple way to automaticaly convert s-57 maps to
 tiled raster
 images with specified scale?
 May be not following s-52 specs.
 
 
 
 --
 View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Convert-S57-to-image-with-S52-rendering-tp4987897p5158977.html
 Sent
 from the GDAL - Dev mailing list archive at Nabble.com.
 _______________________________________________
 gdal-dev mailing list
 gdal-dev at lists.osgeo.org
 http://lists.osgeo.org/mailman/listinfo/gdal-dev
 

From andre+joost at nurfuerspam.de  Fri Aug 29 07:27:29 2014
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Fri, 29 Aug 2014 16:27:29 +0200
Subject: [gdal-dev] Problem encountered in stitching/merging the raster
	files
In-Reply-To: <1409295876911-5158992.post@n6.nabble.com>
References: <1409278142515-5158957.post@n6.nabble.com> <54001D55.70806@free.fr>
	<1409295876911-5158992.post@n6.nabble.com>
Message-ID: <ltq2v8$hs4$1@ger.gmane.org>

Am 29.08.2014 09:04, schrieb user_name:
> I've tried your suggestion but then the result was this:
> Note: I used OpenEV to open the file.
>
>

Perhaps you should switch to QGIS. OpenEV is quite old, and may not work 
with all output of GDAL. The grey parts between the images should have NODATA value.

HTH,
Andr? Joost


From scott_rowles at hotmail.com  Fri Aug 29 08:25:10 2014
From: scott_rowles at hotmail.com (Scott Rowles)
Date: Fri, 29 Aug 2014 11:25:10 -0400
Subject: [gdal-dev] SVG support
Message-ID: <BLU176-W28312C9C756741F361D721FFDB0@phx.gbl>

Hi,
I am using the 1.11 precompiled binaries with with libexpat included in the GDAL_DATA path.  I am trying to read an SVG file, which according to the vector format support table should work.  But it is failing and saying that it cannot open the file.
Any thoughts on how to troubleshoot/resolve this?
scott 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140829/8f8fd308/attachment.html>

From kyle at pobox.com  Fri Aug 29 08:40:31 2014
From: kyle at pobox.com (Kyle Shannon)
Date: Fri, 29 Aug 2014 09:40:31 -0600
Subject: [gdal-dev] SVG support
In-Reply-To: <BLU176-W28312C9C756741F361D721FFDB0@phx.gbl>
References: <BLU176-W28312C9C756741F361D721FFDB0@phx.gbl>
Message-ID: <CAJ0mEz2muhYaw4fZWTj6-B-ibEZZ48SmhEYEin8bTho1LKMK-A@mail.gmail.com>

Scott,

On Fri, Aug 29, 2014 at 9:25 AM, Scott Rowles <scott_rowles at hotmail.com> wrote:
> Hi,
>
> I am using the 1.11 precompiled binaries with with libexpat included in the
> GDAL_DATA path.  I am trying to read an SVG file, which according to the
> vector format support table should work.  But it is failing and saying that
> it cannot open the file.

The svg driver appears to be very limited:

http://gdal.org/drv_svg.html

"""
Currently, it will only read SVG files that are the output from
Cloudmade Vector Stream Server
"""

>
> Any thoughts on how to troubleshoot/resolve this?
>
> scott
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Kyle

From gdal at stripfamily.net  Fri Aug 29 08:44:43 2014
From: gdal at stripfamily.net (David Strip)
Date: Fri, 29 Aug 2014 09:44:43 -0600
Subject: [gdal-dev] SVG support
In-Reply-To: <BLU176-W28312C9C756741F361D721FFDB0@phx.gbl>
References: <BLU176-W28312C9C756741F361D721FFDB0@phx.gbl>
Message-ID: <54009FEB.5020100@stripfamily.net>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140829/f7c70c06/attachment.html>

From scott_rowles at hotmail.com  Fri Aug 29 08:45:50 2014
From: scott_rowles at hotmail.com (Scott Rowles)
Date: Fri, 29 Aug 2014 11:45:50 -0400
Subject: [gdal-dev] SVG support
In-Reply-To: <54009FEB.5020100@stripfamily.net>
References: <BLU176-W28312C9C756741F361D721FFDB0@phx.gbl>,
	<54009FEB.5020100@stripfamily.net>
Message-ID: <BLU176-W19475EE54935CE2B01C729FFDB0@phx.gbl>

Yep.  I don't know the origin of the SVG file.  I am going to try an SVG file from the Cloudmade site and verify that it works!

Date: Fri, 29 Aug 2014 09:44:43 -0600
From: gdal at stripfamily.net
To: scott_rowles at hotmail.com; gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] SVG support


  
    
  
  
    What is the source of your SVG file?

    According to the SVG
      driver page, only files produced with the Cloudmade Vector
    Stream Server will work.

    

    On 8/29/2014 9:25 AM, Scott Rowles wrote:
    
      
      Hi,
        

        
        I am using the 1.11 precompiled binaries with with libexpat
          included in the GDAL_DATA path.  I am trying to read an SVG
          file, which according to the vector format support table
          should work.  But it is failing and saying that it cannot open
          the file.
        

        
        Any thoughts on how to troubleshoot/resolve this?
        

        
        scott

        
      
    
    
 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140829/a07a16e0/attachment.html>

From scott_rowles at hotmail.com  Fri Aug 29 08:58:52 2014
From: scott_rowles at hotmail.com (Scott Rowles)
Date: Fri, 29 Aug 2014 11:58:52 -0400
Subject: [gdal-dev] SVG support
In-Reply-To: <BLU176-W19475EE54935CE2B01C729FFDB0@phx.gbl>
References: <BLU176-W28312C9C756741F361D721FFDB0@phx.gbl>, ,
	<54009FEB.5020100@stripfamily.net>,
	<BLU176-W19475EE54935CE2B01C729FFDB0@phx.gbl>
Message-ID: <BLU176-W357820EEAD7CCAA6D4FD28FFDB0@phx.gbl>

Does cloudmade have any import and export tools that I could load in a CSV or shapefile and get a valid SVG returned?

From: scott_rowles at hotmail.com
To: gdal at stripfamily.net; gdal-dev at lists.osgeo.org
Date: Fri, 29 Aug 2014 11:45:50 -0400
Subject: Re: [gdal-dev] SVG support




Yep.  I don't know the origin of the SVG file.  I am going to try an SVG file from the Cloudmade site and verify that it works!

Date: Fri, 29 Aug 2014 09:44:43 -0600
From: gdal at stripfamily.net
To: scott_rowles at hotmail.com; gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] SVG support


  
    
  
  
    What is the source of your SVG file?

    According to the SVG
      driver page, only files produced with the Cloudmade Vector
    Stream Server will work.

    

    On 8/29/2014 9:25 AM, Scott Rowles wrote:
    
      
      Hi,
        

        
        I am using the 1.11 precompiled binaries with with libexpat
          included in the GDAL_DATA path.  I am trying to read an SVG
          file, which according to the vector format support table
          should work.  But it is failing and saying that it cannot open
          the file.
        

        
        Any thoughts on how to troubleshoot/resolve this?
        

        
        scott

        
      
    
    
 		 	   		  

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140829/9e461aec/attachment.html>

From jukka.rahkonen at mmmtike.fi  Fri Aug 29 09:36:17 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Fri, 29 Aug 2014 16:36:17 +0000 (UTC)
Subject: [gdal-dev]
	=?utf-8?q?Problem_encountered_in_stitching/merging_the?=
	=?utf-8?q?_raster=09files?=
References: <1409278142515-5158957.post@n6.nabble.com> <54001D55.70806@free.fr>
	<1409295876911-5158992.post@n6.nabble.com>
Message-ID: <loom.20140829T183249-72@post.gmane.org>

user_name <ljvillarin30 <at> gmail.com> writes:

> 
> I've tried your suggestion but then the result was this:
> Note: I used OpenEV to open the file.
> 
> <http://osgeo-org.1560.x6.nabble.com/file/n5158992/openev.gif> 

Hi,

Result looks like it is because the black slivers which are created by
warping are not made transparent. Have a try by adding -dstnodata 0 0 0 to
the gdalwarp command.

-Jukka Rahkonen-


From even.rouault at spatialys.com  Fri Aug 29 10:34:31 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 29 Aug 2014 19:34:31 +0200
Subject: [gdal-dev] why do I get a floating point nodata value from a
	byte raster?
In-Reply-To: <CAGuVLy07f+mRtGXe2fXd7n-1boY7PuqEYe3=3vcUPmN6u3CE0Q@mail.gmail.com>
References: <CAGuVLy07f+mRtGXe2fXd7n-1boY7PuqEYe3=3vcUPmN6u3CE0Q@mail.gmail.com>
Message-ID: <201408291934.44369.even.rouault@spatialys.com>

Le jeudi 28 ao?t 2014 23:32:38, Richard Sharp a ?crit :
> I have a byte GTiff dataset that has a nodata value of 0 according to QGIS.

Well, I've just created such a file, and with QGIS 1.8, the GUI display well 
the -3.4028230607370965e+38 value, but with 2.4, it displays 0. So seems to be 
on QGIS side.
That said,  -3.4028230607370965e+38 doesn't make sense as a nodata value for 
Byte, which can only range from 0 to 255.
After some testing, it seems that QGIS displays 0 when the nodata value is out 
of the range of the data type.

> 
>  However, when I load it using the gdal python API, I get this:
> >>> ds= gdal.Open('cdl10lu83.tif')
> >>> band=ds.GetRasterBand(1)
> >>> band.GetNoDataValue()
> 
> -3.4028230607370965e+38
> 
> Also when I run `gdalinfo` I see the same nodata value:
> 
> Band 1 Block=128x128 Type=Byte, ColorInterp=Gray
>   Min=0.000 Max=26.000
>   Minimum=0.000, Maximum=26.000, Mean=10.115, StdDev=5.072
>   NoData Value=-3.4028230607370965e+038
> 
> I'm running GDAL 1.11.0, although I've also experienced the same behavior
> on gdalinfo with 1.9.0. I'm using QGIS 2.4 which is built against GDAL 1.9.
> 
> Any ideas what's going on and how to handle it?
> 
> --
> Richard P. Sharp Jr.
> Lead Software Architect
> Natural Capital Project
> Stanford University, U Minnesota, TNC, WWF
> 371 Serra Mall
> Stanford, CA 94305
> http://www.stanford.edu/~rpsharp/

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Aug 29 10:45:22 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 29 Aug 2014 19:45:22 +0200
Subject: [gdal-dev] How get EPSG code from an OGRSpatialReferenceH?
In-Reply-To: <53FFF170.8060402@stripfamily.net>
References: <94EB2E71-FC4F-40DF-A25E-BFD9BA0B65F8@nixanz.com>
	<53FFF170.8060402@stripfamily.net>
Message-ID: <201408291945.22326.even.rouault@spatialys.com>

Le vendredi 29 ao?t 2014 05:20:16, David Strip a ?crit :
> It's my recollection from a question I posted here  a little over a year
> ago that except for a few special cases, autoIdentifyEPSG only works if
> there is an authority node providing the EPSG.

Hu, no. That would make it really useless. AutoIdentifyEPSG() tries to add 
EPSG authority and code on a very restricted set of common SRS that don't have 
it

> Hopefully someone will
> give you an authoritative answer. I believe GeoTools has the capability
> to find the EPSG from the WKT, but I have no idea how to interface to that
> 
> On 8/28/2014 8:42 PM, Nik Sands wrote:
> > Hi devs,
> > 
> > What is the correct way to extract the EPSG code from an
> > OGRSpatialReferenceH ?
> > 
> > Currently I'm finding that the following works only for SRS of some images 
and not others:
> > 	const char *charAuthType = OSRGetAttrValue(gdal.srcSRS, "AUTHORITY", 0);
> > 	const char *charSrsCode = OSRGetAttrValue(gdal.srcSRS, "AUTHORITY", 1);
> > 
> > However, there is no "AUTHORITY" node in some SRSs so it doesn't work for 
those images.  To cater for this, I'm trying to explicitly set the authority 
node using:
> > 	OSRAutoIdentifyEPSG(gdal.srcSRS);
> > 
> > But this fails with OGRERR_UNSUPPORTED_SRS (even when it is an SRS that
> > GDAL recognises and uses well).

Yes, this is expected. There are just a few SRS definitions that are encoded in 
it.

> > 
> > So I'm stumped... how do I reliably determine the EPSG for an
> > OGRSpatialReferenceH?

There's no real reliable way of doing that. There are approximative methods to 
get a best match. For example you could iterate on EPSG codes with 
importFromEPSG() and exportToProj4(), and compare with exportToProj4() on your 
WKT, but you can easily find situations where several EPSG SRS resolve to the 
same proj4 string.
Anyway, there's currently no such ready-made heuristics method in GDAL, 
although it might be useful to have one ultimately.

> > 
> > Cheers,
> > Nik.
> > 
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gdal at stripfamily.net  Fri Aug 29 10:52:57 2014
From: gdal at stripfamily.net (David Strip)
Date: Fri, 29 Aug 2014 11:52:57 -0600
Subject: [gdal-dev] How get EPSG code from an OGRSpatialReferenceH?
In-Reply-To: <201408291945.22326.even.rouault@spatialys.com>
References: <94EB2E71-FC4F-40DF-A25E-BFD9BA0B65F8@nixanz.com>
	<53FFF170.8060402@stripfamily.net>
	<201408291945.22326.even.rouault@spatialys.com>
Message-ID: <5400BDF9.3080006@stripfamily.net>

On 8/29/2014 11:45 AM, Even Rouault wrote:
> Le vendredi 29 ao?t 2014 05:20:16, David Strip a ?crit :
>> > It's my recollection from a question I posted here  a little over a year
>> > ago that except for a few special cases, autoIdentifyEPSG only works if
>> > there is an authority node providing the EPSG.
> Hu, no. That would make it really useless. AutoIdentifyEPSG() tries to add 
> EPSG authority and code on a very restricted set of common SRS that don't have 
> it
>
Isn't that what I wrote?
"few special cases" = "very restricted set" ?

From even.rouault at spatialys.com  Fri Aug 29 10:59:42 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 29 Aug 2014 19:59:42 +0200
Subject: [gdal-dev] How get EPSG code from an OGRSpatialReferenceH?
In-Reply-To: <5400BDF9.3080006@stripfamily.net>
References: <94EB2E71-FC4F-40DF-A25E-BFD9BA0B65F8@nixanz.com>
	<201408291945.22326.even.rouault@spatialys.com>
	<5400BDF9.3080006@stripfamily.net>
Message-ID: <201408291959.42697.even.rouault@spatialys.com>

Le vendredi 29 ao?t 2014 19:52:57, David Strip a ?crit :
> On 8/29/2014 11:45 AM, Even Rouault wrote:
> > Le vendredi 29 ao?t 2014 05:20:16, David Strip a ?crit :
> >> > It's my recollection from a question I posted here  a little over a
> >> > year ago that except for a few special cases, autoIdentifyEPSG only
> >> > works if there is an authority node providing the EPSG.
> > 
> > Hu, no. That would make it really useless. AutoIdentifyEPSG() tries to
> > add EPSG authority and code on a very restricted set of common SRS that
> > don't have it
> 
> Isn't that what I wrote?
> "few special cases" = "very restricted set" ?

Sorry. Appears I read your sentence to fast and missed that "except for a few 
specifal cases".


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From nixanz at nixanz.com  Fri Aug 29 15:14:29 2014
From: nixanz at nixanz.com (Nik Sands)
Date: Sat, 30 Aug 2014 08:14:29 +1000
Subject: [gdal-dev] How get EPSG code from an OGRSpatialReferenceH?
In-Reply-To: <201408291945.22326.even.rouault@spatialys.com>
References: <94EB2E71-FC4F-40DF-A25E-BFD9BA0B65F8@nixanz.com>
	<53FFF170.8060402@stripfamily.net>
	<201408291945.22326.even.rouault@spatialys.com>
Message-ID: <297C4FDA-A569-477C-A1EE-7EC410450962@nixanz.com>

Thanks for the answer.  Not what I wanted to hear but such is life. (And I think it makes sense now that you explain it - ie, it's not a neatly reversible translation). 

It will complicate my user interface somewhat, but I think I've got an idea of how to work around it. 

Thanks,
Nik. 

On 30 Aug 2014, at 3:45 am, Even Rouault <even.rouault at spatialys.com> wrote:

>>> On 8/28/2014 8:42 PM, Nik Sands wrote:
>>> Hi devs,
>>> 
>>> What is the correct way to extract the EPSG code from an
>>> OGRSpatialReferenceH ?
>>> 
>>> Currently I'm finding that the following works only for SRS of some images
> and not others:
>>>    const char *charAuthType = OSRGetAttrValue(gdal.srcSRS, "AUTHORITY", 0);
>>>    const char *charSrsCode = OSRGetAttrValue(gdal.srcSRS, "AUTHORITY", 1);
>>> 
>>> However, there is no "AUTHORITY" node in some SRSs so it doesn't work for
> those images.  To cater for this, I'm trying to explicitly set the authority 
> node using:
>>>    OSRAutoIdentifyEPSG(gdal.srcSRS);
>>> 
>>> But this fails with OGRERR_UNSUPPORTED_SRS (even when it is an SRS that
>>> GDAL recognises and uses well).
> 
> Yes, this is expected. There are just a few SRS definitions that are encoded in 
> it.
> 
>>> 
>>> So I'm stumped... how do I reliably determine the EPSG for an
>>> OGRSpatialReferenceH?
> 
> There's no real reliable way of doing that. There are approximative methods to 
> get a best match. For example you could iterate on EPSG codes with 
> importFromEPSG() and exportToProj4(), and compare with exportToProj4() on your 
> WKT, but you can easily find situations where several EPSG SRS resolve to the 
> same proj4 string.
> Anyway, there's currently no such ready-made heuristics method in GDAL, 
> although it might be useful to have one ultimately.
> 
>>> 
>>> Cheers,
>>> Nik.
>>> 
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>> 
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com

From bo.victor.thomsen at gmail.com  Fri Aug 29 23:55:50 2014
From: bo.victor.thomsen at gmail.com (Bo Victor Thomsen)
Date: Sat, 30 Aug 2014 08:55:50 +0200
Subject: [gdal-dev] Try to create a .bat for ogr2ogr
In-Reply-To: <CAM+zXj1WhJ_aHEsfb=rbpQo5KYZVSgjiGLy__HHxLfnpKUt66w@mail.gmail.com>
References: <CAM+zXj1WhJ_aHEsfb=rbpQo5KYZVSgjiGLy__HHxLfnpKUt66w@mail.gmail.com>
Message-ID: <54017576.3060306@gmail.com>

Jo?o -

Try to get to ogr2ogr command to work (or not work) from GDAL 
command-line environment (SDKShell.bat) with one shape file.

And  don't depend on defaults in the database connection string, ie. 
PG:"*host=localhost port=5432 *dbname='temp_gis' user='test_user' 
password='test_pss'"

You might try to simply create a new table in stead of appending to an 
existing table.

At a glance I suspect you have some kind of permission problem in the 
database

Checkpoint 101:

 1. Have you a Postgres/Postgis databaser server installed at localhost
    and listening on port 5432 ?
 2. Is your database user and password set correctly ?
 3. Has you a database 'temp_gis' with PostGIS enabled running on the
    local database server ?
 4. Has you a schema 'temp' in the database and a table 'upload' in schema ?
 5. Has the table the right structure and a geometry column ?
 6. Does the database user has permission to write data to the table ?

I suspect that no. 5 or 6 is the culprit.

Regards
Bo Victor Thomsen
Aestas-GIS
Denmark

Den 29-08-2014 12:45, Jo?o Gaspar skrev:
> Hi guys,
>
> i'm giving the first steps in this kind of programming.
>
> So the scenario is:
>
> I have a lot of users that dump work shapfiles into a folder, then i 
> need to upload this files to a database into a single table (at this 
> time i'm testing the PostGIS).
>
> So I read some snippets code and some tutorials and i try to do the 
> .bat but at this time i have some errors.
>
> Note: I put the name of user and password with dummy value :)
>
> The error that give me for the 2 test shapefiles that i try to import is:
>
> ERROR 1: Unable to write feature 0 from layer Polygon1.
>
> ERROR 1: Terminating translation prematurely after failed
> translation of layer Polygon1 (use -skipfailures to skip errors)
>
> ERROR 1: Unable to write feature 0 from layer Polygon2.
>
> ERROR 1: Terminating translation prematurely after failed
> translation of layer Polygon2 (use -skipfailures to skip errors)
>
> My actual code of the .bat is:
>
>
> @echo off
> for %%I in (inputs_pggis\*.shp) do (
> echo Import shapefile %%~nxI to schema temp.upload
>   Tabela PostGIS ...
> ogr2ogr -append -update -f PostgreSQL PG:"dbname='temp_gis' 
> user='test_user' password='test_pss'" inputs_pggis/%%~nxI -nln temp.upload
> )
>
>
> Best Regards,
> Jo?o
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140830/03345408/attachment.html>

From aperi2007 at gmail.com  Sat Aug 30 05:41:44 2014
From: aperi2007 at gmail.com (Andrea Peri)
Date: Sat, 30 Aug 2014 14:41:44 +0200
Subject: [gdal-dev] Correct sintax for multicommand in FeatureStyle
	specification
Message-ID: <CABqTJk87OG7_8F5yHNWEXC5cmy=5jOwvkyHHcUeekZJSt7+woQ@mail.gmail.com>

Hi,
I'm try to undestand the FeatureStyle specification.

To do this I'm using the mapserver that seem to work with it.


Actually I have a dubt about the usage of more than one command.

Infact a single command could be as example:

'LABEL(f:"Arial",t:"Blah Blah Blah",s:3g,c:#0000FF)'

That command mean "print a label with text "Blah Blah Blah" . Color
Blu font Arial and size 3 ground-unit.

Infact using it with mapserver work and effectively the map has that result.

Also if I try this other command:

'BRUSH(fc:#FF0000)'

this mean : fill the polygon with a full red.

Also this work with mapserver.

Now I need to understand if and how is possible to have more than one command.

Reading the specs ,
I guess the right sintax should be this:

'BRUSH(fc:#FF0000);LABEL(f:"Arial",t:"Blah Blah Blah",s:3g,c:#0000FF)'

Where the two command are separate by a ; char.

Unfortunately this string dont seem work with mapserver.

I try also the opposite string:

"LABEL(f:"Arial",t:"Blah Blah Blah",s:3g,c:#0000FF);BRUSH(fc:#FF0000)"

BUt still not seem work.
Always is showed only the first command only.

This could effectively tobe an issue of mapserver.
But I'm not really sure that this is the correct string for multi
command using the featurestyle spec.

So I like to have any hint on this.

If the sintax I'm using is correct and if there is some software or
authoring that support it.

Thx,

-- 
-----------------
Andrea Peri
. . . . . . . . .
qwerty ?????
-----------------

From even.rouault at spatialys.com  Sat Aug 30 06:39:38 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 30 Aug 2014 15:39:38 +0200
Subject: [gdal-dev] Correct sintax for multicommand in FeatureStyle
	specification
In-Reply-To: <CABqTJk87OG7_8F5yHNWEXC5cmy=5jOwvkyHHcUeekZJSt7+woQ@mail.gmail.com>
References: <CABqTJk87OG7_8F5yHNWEXC5cmy=5jOwvkyHHcUeekZJSt7+woQ@mail.gmail.com>
Message-ID: <201408301539.38614.even.rouault@spatialys.com>

Andrea,

Both work for me.

Tested with :

* foo.csv :

id,WKT,OGR_STYLE
1,"POLYGON((1 1,1 9,4 9,4 1,1 1))","LABEL(f:""Arial"",t:""Blah Blah Blah"",s:3g,c:#0000FF);BRUSH(fc:#FF0000)"
2,"POLYGON((5 1,5 9,9 9,9 1,5 1))","BRUSH(fc:#FF0000);LABEL(f:""Arial"",t:""Blah Blah Blah"",s:3g,c:#0000FF)"

(the repeated "" is due to CSV escaping of double quotes)

* foo.map :

MAP
    NAME test
    EXTENT 0 0 10 10
    SIZE    200 200

    PROJECTION
        "init=epsg:4326"
    END

    WEB
        METADATA
            OWS_ONLINERESOURCE "http://127.0.0.0.1"
            OWS_SRS "EPSG:4326"
            OWS_ENABLE_REQUEST "*"
        END
    END

    LAYER
        NAME foo
        TYPE POLYGON
        STATUS ON
        CONNECTIONTYPE OGR
        CONNECTION "foo.csv"

        STYLEITEM "AUTO"
        CLASS
        END
    END
END

* test command :

shp2img -m foo.map -o foo.png

Attached the resulting foo.png

Best egards,

Evn


> Hi,
> I'm try to undestand the FeatureStyle specification.
> 
> To do this I'm using the mapserver that seem to work with it.
> 
> 
> Actually I have a dubt about the usage of more than one command.
> 
> Infact a single command could be as example:
> 
> 'LABEL(f:"Arial",t:"Blah Blah Blah",s:3g,c:#0000FF)'
> 
> That command mean "print a label with text "Blah Blah Blah" . Color
> Blu font Arial and size 3 ground-unit.
> 
> Infact using it with mapserver work and effectively the map has that
> result.
> 
> Also if I try this other command:
> 
> 'BRUSH(fc:#FF0000)'
> 
> this mean : fill the polygon with a full red.
> 
> Also this work with mapserver.
> 
> Now I need to understand if and how is possible to have more than one
> command.
> 
> Reading the specs ,
> I guess the right sintax should be this:
> 
> 'BRUSH(fc:#FF0000);LABEL(f:"Arial",t:"Blah Blah Blah",s:3g,c:#0000FF)'
> 
> Where the two command are separate by a ; char.
> 
> Unfortunately this string dont seem work with mapserver.
> 
> I try also the opposite string:
> 
> "LABEL(f:"Arial",t:"Blah Blah Blah",s:3g,c:#0000FF);BRUSH(fc:#FF0000)"
> 
> BUt still not seem work.
> Always is showed only the first command only.
> 
> This could effectively tobe an issue of mapserver.
> But I'm not really sure that this is the correct string for multi
> command using the featurestyle spec.
> 
> So I like to have any hint on this.
> 
> If the sintax I'm using is correct and if there is some software or
> authoring that support it.
> 
> Thx,

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
A non-text attachment was scrubbed...
Name: foo.png
Type: image/png
Size: 2662 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140830/0c32e814/attachment.png>

From aperi2007 at gmail.com  Sat Aug 30 08:10:38 2014
From: aperi2007 at gmail.com (Andrea Peri)
Date: Sat, 30 Aug 2014 17:10:38 +0200
Subject: [gdal-dev] Correct sintax for multicommand in FeatureStyle
	specification
In-Reply-To: <201408301539.38614.even.rouault@spatialys.com>
References: <CABqTJk87OG7_8F5yHNWEXC5cmy=5jOwvkyHHcUeekZJSt7+woQ@mail.gmail.com>
	<201408301539.38614.even.rouault@spatialys.com>
Message-ID: <CABqTJk8VHbKQ4o=wA914Rsq8xk4CLDtes4_2WxpbXrxE7E31eg@mail.gmail.com>

Tx very much Even.

I found my stupid error.

I was using the FEATURE / END to test it and it use the ; to separe
all the items.
The same of the featurestyle specs.

A.


2014-08-30 15:39 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
> Andrea,
>
> Both work for me.
>
> Tested with :
>
> * foo.csv :
>
> id,WKT,OGR_STYLE
> 1,"POLYGON((1 1,1 9,4 9,4 1,1 1))","LABEL(f:""Arial"",t:""Blah Blah Blah"",s:3g,c:#0000FF);BRUSH(fc:#FF0000)"
> 2,"POLYGON((5 1,5 9,9 9,9 1,5 1))","BRUSH(fc:#FF0000);LABEL(f:""Arial"",t:""Blah Blah Blah"",s:3g,c:#0000FF)"
>
> (the repeated "" is due to CSV escaping of double quotes)
>
> * foo.map :
>
> MAP
>     NAME test
>     EXTENT 0 0 10 10
>     SIZE    200 200
>
>     PROJECTION
>         "init=epsg:4326"
>     END
>
>     WEB
>         METADATA
>             OWS_ONLINERESOURCE "http://127.0.0.0.1"
>             OWS_SRS "EPSG:4326"
>             OWS_ENABLE_REQUEST "*"
>         END
>     END
>
>     LAYER
>         NAME foo
>         TYPE POLYGON
>         STATUS ON
>         CONNECTIONTYPE OGR
>         CONNECTION "foo.csv"
>
>         STYLEITEM "AUTO"
>         CLASS
>         END
>     END
> END
>
> * test command :
>
> shp2img -m foo.map -o foo.png
>
> Attached the resulting foo.png
>
> Best egards,
>
> Evn
>
>
>> Hi,
>> I'm try to undestand the FeatureStyle specification.
>>
>> To do this I'm using the mapserver that seem to work with it.
>>
>>
>> Actually I have a dubt about the usage of more than one command.
>>
>> Infact a single command could be as example:
>>
>> 'LABEL(f:"Arial",t:"Blah Blah Blah",s:3g,c:#0000FF)'
>>
>> That command mean "print a label with text "Blah Blah Blah" . Color
>> Blu font Arial and size 3 ground-unit.
>>
>> Infact using it with mapserver work and effectively the map has that
>> result.
>>
>> Also if I try this other command:
>>
>> 'BRUSH(fc:#FF0000)'
>>
>> this mean : fill the polygon with a full red.
>>
>> Also this work with mapserver.
>>
>> Now I need to understand if and how is possible to have more than one
>> command.
>>
>> Reading the specs ,
>> I guess the right sintax should be this:
>>
>> 'BRUSH(fc:#FF0000);LABEL(f:"Arial",t:"Blah Blah Blah",s:3g,c:#0000FF)'
>>
>> Where the two command are separate by a ; char.
>>
>> Unfortunately this string dont seem work with mapserver.
>>
>> I try also the opposite string:
>>
>> "LABEL(f:"Arial",t:"Blah Blah Blah",s:3g,c:#0000FF);BRUSH(fc:#FF0000)"
>>
>> BUt still not seem work.
>> Always is showed only the first command only.
>>
>> This could effectively tobe an issue of mapserver.
>> But I'm not really sure that this is the correct string for multi
>> command using the featurestyle spec.
>>
>> So I like to have any hint on this.
>>
>> If the sintax I'm using is correct and if there is some software or
>> authoring that support it.
>>
>> Thx,
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com



-- 
-----------------
Andrea Peri
. . . . . . . . .
qwerty ?????
-----------------

From even.rouault at spatialys.com  Sun Aug 31 04:34:15 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 31 Aug 2014 13:34:15 +0200
Subject: [gdal-dev] OGR C API Spy
Message-ID: <201408311334.15206.even.rouault@spatialys.com>

Hi,

This will not be of interest for the crowds, but mainly for OGR driver 
developers (and potentially also to get precise bug reports from users). I'm 
currently adding update capabilities to the MITAB driver, and while playing 
with QGIS, there are sometimes sequences of OGR calls that trigger bugs, but 
that I had issues to replicate afterwards. This spy mechanism enables to have 
recording of all relevant calls to be able to replicate them exactly 
afterwards.

Doc to use it : http://www.gdal.org/ograpispy_8h.html

Related autotest script : 
http://svn.osgeo.org/gdal/trunk/autotest/ogr/ograpispy.py

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From robert.coup at koordinates.com  Sun Aug 31 11:50:41 2014
From: robert.coup at koordinates.com (Robert Coup)
Date: Mon, 1 Sep 2014 06:50:41 +1200
Subject: [gdal-dev] OGR C API Spy
In-Reply-To: <201408311334.15206.even.rouault@spatialys.com>
References: <201408311334.15206.even.rouault@spatialys.com>
Message-ID: <CAFLLRpLoxDfoiUPDOmXZUzPpFS27Et=6uxZDs4ioYwimXmmRsA@mail.gmail.com>

That's cool :) Is there any particular performance penalty to compiling
*with* OGRAPISPY_ENABLED and then running *without*
OGR_API_SPY_FILE/OGR_API_SPY_SNAPSHOT_PATH
set?

Rob :)


On Sun, Aug 31, 2014 at 11:34 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
> This will not be of interest for the crowds, but mainly for OGR driver
> developers (and potentially also to get precise bug reports from users).
> I'm
> currently adding update capabilities to the MITAB driver, and while playing
> with QGIS, there are sometimes sequences of OGR calls that trigger bugs,
> but
> that I had issues to replicate afterwards. This spy mechanism enables to
> have
> recording of all relevant calls to be able to replicate them exactly
> afterwards.
>
> Doc to use it : http://www.gdal.org/ograpispy_8h.html
>
> Related autotest script :
> http://svn.osgeo.org/gdal/trunk/autotest/ogr/ograpispy.py
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 

*Koordinates*PO Box 1604, Shortland St, Auckland 1140, New Zealand
Phone +64-9-966 0433 koordinates.com <https://koordinates.com/about>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140901/e28634f3/attachment.html>

From even.rouault at spatialys.com  Sun Aug 31 12:14:15 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 31 Aug 2014 21:14:15 +0200
Subject: [gdal-dev] OGR C API Spy
In-Reply-To: <CAFLLRpLoxDfoiUPDOmXZUzPpFS27Et=6uxZDs4ioYwimXmmRsA@mail.gmail.com>
References: <201408311334.15206.even.rouault@spatialys.com>
	<CAFLLRpLoxDfoiUPDOmXZUzPpFS27Et=6uxZDs4ioYwimXmmRsA@mail.gmail.com>
Message-ID: <201408312114.15354.even.rouault@spatialys.com>

Le dimanche 31 ao?t 2014 20:50:41, Robert Coup a ?crit :
> That's cool :) Is there any particular performance penalty to compiling
> *with* OGRAPISPY_ENABLED and then running *without*
> OGR_API_SPY_FILE/OGR_API_SPY_SNAPSHOT_PATH
> set?

Hi Robert,

Hopefully no, see for example :

OGRFeatureH OGR_L_GetNextFeature( OGRLayerH hLayer )

{
    VALIDATE_POINTER1( hLayer, "OGR_L_GetNextFeature", NULL );

#ifdef OGRAPISPY_ENABLED
    if( bOGRAPISpyEnabled )
        OGRAPISpy_L_GetNextFeature(hLayer);
#endif

    return (OGRFeatureH) ((OGRLayer *)hLayer)->GetNextFeature();
}

I cannot imagine something with less overhead. (if you exclude dynamic binary 
patching techniques ;-) )

OGROpen() and OGR_Dr_CreateDataSource() call a tracing function that tests if 
the env. variable is set, and if so set the boolean bOGRAPISpyEnabled.

Even

> 
> Rob :)
> 
> 
> On Sun, Aug 31, 2014 at 11:34 PM, Even Rouault <even.rouault at spatialys.com>
> 
> wrote:
> > Hi,
> > 
> > This will not be of interest for the crowds, but mainly for OGR driver
> > developers (and potentially also to get precise bug reports from users).
> > I'm
> > currently adding update capabilities to the MITAB driver, and while
> > playing with QGIS, there are sometimes sequences of OGR calls that
> > trigger bugs, but
> > that I had issues to replicate afterwards. This spy mechanism enables to
> > have
> > recording of all relevant calls to be able to replicate them exactly
> > afterwards.
> > 
> > Doc to use it : http://www.gdal.org/ograpispy_8h.html
> > 
> > Related autotest script :
> > http://svn.osgeo.org/gdal/trunk/autotest/ogr/ograpispy.py
> > 
> > Even
> > 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Sun Aug 31 12:38:10 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 31 Aug 2014 21:38:10 +0200
Subject: [gdal-dev] Appveyor Windows Continuous Integration
Message-ID: <201408312138.10607.even.rouault@spatialys.com>

Hi,

I've just experimented with Appveyor, a hosted continuous integration solution 
for Windows to do Windows GDAL builds. This is not completely convincing, 
since a optimized build of GDAL, without any optional dependency, takes more 
than 30 minutes, and then gets killed since this is the limit for the free (as 
in free beer) profile... I've managed to make it work with debug builds that 
run in 25 minutes. So no time to run tests. Results can be seen at
https://ci.appveyor.com/project/rouault/gdal-coverage .
This is still interesting since it uses Visual Studio 2013 (a.k.a VC12 / MSVC 
1800), which Tamas doesn't yet use on http://www.gisinternals.com/sdk/
Contrary to Travis-CI, there's no IRC notification yet in Appveyor 
unfortunately, so you have to watch the previous mentionned URL. I could 
perhaps enable email notices to gdal-commits at lists.osgeo.org, but did not do 
it for know.
A new build will be launched everytime my cron job runs (i.e. every 15 
minutes) *and* something has been committed in SVN.

I've also updated http://trac.osgeo.org/gdal/wiki/Buildbot (which is badly 
named now...) with all the various C.I. setups that currently exist.

Note: some time ago I also experimented with Visual Studio Express 2005 and 
2008 under Wine. https://travis-ci.org/rouault/vcexpress2005 and 
https://travis-ci.org/rouault/vcexpress2008. I didn't enable them on each 
commit, since I'm not sure downloading the compiler and sdk from MS each time 
is a good idea... The builds were faster than with Appveyor (quite ironical 
!). And for some reason I couldn't manage to install Python under Wine once VS 
is installed. So no autotest too.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From robert.coup at koordinates.com  Sun Aug 31 13:44:00 2014
From: robert.coup at koordinates.com (Robert Coup)
Date: Mon, 1 Sep 2014 08:44:00 +1200
Subject: [gdal-dev] OGR C API Spy
In-Reply-To: <201408312114.15354.even.rouault@spatialys.com>
References: <201408311334.15206.even.rouault@spatialys.com>
	<CAFLLRpLoxDfoiUPDOmXZUzPpFS27Et=6uxZDs4ioYwimXmmRsA@mail.gmail.com>
	<201408312114.15354.even.rouault@spatialys.com>
Message-ID: <CAFLLRpLW5ngjroRUGGwz+Kf5K0eUYtdoACrypB8xMJ5vSF1vkA@mail.gmail.com>

Excellent :)

There's obviously no nice run-time solution using the C++ API, though I
guess callgrind/linux-perf can do it - do you have any experience worth
sharing there?

Rob.


On Mon, Sep 1, 2014 at 7:14 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le dimanche 31 ao?t 2014 20:50:41, Robert Coup a ?crit :
> > That's cool :) Is there any particular performance penalty to compiling
> > *with* OGRAPISPY_ENABLED and then running *without*
> > OGR_API_SPY_FILE/OGR_API_SPY_SNAPSHOT_PATH
> > set?
>
> Hi Robert,
>
> Hopefully no, see for example :
>
> OGRFeatureH OGR_L_GetNextFeature( OGRLayerH hLayer )
>
> {
>     VALIDATE_POINTER1( hLayer, "OGR_L_GetNextFeature", NULL );
>
> #ifdef OGRAPISPY_ENABLED
>     if( bOGRAPISpyEnabled )
>         OGRAPISpy_L_GetNextFeature(hLayer);
> #endif
>
>     return (OGRFeatureH) ((OGRLayer *)hLayer)->GetNextFeature();
> }
>
> I cannot imagine something with less overhead. (if you exclude dynamic
> binary
> patching techniques ;-) )
>
> OGROpen() and OGR_Dr_CreateDataSource() call a tracing function that tests
> if
> the env. variable is set, and if so set the boolean bOGRAPISpyEnabled.
>
> Even
>
> >
> > Rob :)
> >
> >
> > On Sun, Aug 31, 2014 at 11:34 PM, Even Rouault <
> even.rouault at spatialys.com>
> >
> > wrote:
> > > Hi,
> > >
> > > This will not be of interest for the crowds, but mainly for OGR driver
> > > developers (and potentially also to get precise bug reports from
> users).
> > > I'm
> > > currently adding update capabilities to the MITAB driver, and while
> > > playing with QGIS, there are sometimes sequences of OGR calls that
> > > trigger bugs, but
> > > that I had issues to replicate afterwards. This spy mechanism enables
> to
> > > have
> > > recording of all relevant calls to be able to replicate them exactly
> > > afterwards.
> > >
> > > Doc to use it : http://www.gdal.org/ograpispy_8h.html
> > >
> > > Related autotest script :
> > > http://svn.osgeo.org/gdal/trunk/autotest/ogr/ograpispy.py
> > >
> > > Even
> > >
> > > --
> > > Spatialys - Geospatial professional services
> > > http://www.spatialys.com
> > > _______________________________________________
> > > gdal-dev mailing list
> > > gdal-dev at lists.osgeo.org
> > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>



-- 

*Koordinates*PO Box 1604, Shortland St, Auckland 1140, New Zealand
Phone +64-9-966 0433 koordinates.com <https://koordinates.com/about>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140901/e7014a88/attachment.html>

From even.rouault at spatialys.com  Sun Aug 31 13:52:50 2014
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 31 Aug 2014 22:52:50 +0200
Subject: [gdal-dev] OGR C API Spy
In-Reply-To: <CAFLLRpLW5ngjroRUGGwz+Kf5K0eUYtdoACrypB8xMJ5vSF1vkA@mail.gmail.com>
References: <201408311334.15206.even.rouault@spatialys.com>
	<201408312114.15354.even.rouault@spatialys.com>
	<CAFLLRpLW5ngjroRUGGwz+Kf5K0eUYtdoACrypB8xMJ5vSF1vkA@mail.gmail.com>
Message-ID: <201408312252.50664.even.rouault@spatialys.com>

Le dimanche 31 ao?t 2014 22:44:00, Robert Coup a ?crit :
> Excellent :)
> 
> There's obviously no nice run-time solution using the C++ API,

Yes, that could be possible if the C++ public API had redirection to driver  
implementation methods. In GDAL, we have that with some methods like 
RasterIO() vs IRasterIO(). In OGR, that only exists now with CreateLayer() / 
ICreateLayer() (change done during RFC46)

> though I
> guess callgrind/linux-perf can do it - do you have any experience worth
> sharing there?

Hum, my OGR API Spy hasn't been design to do performance profiling. That would 
require a pre- and post- calls.
Long time ago, I had use callgrind, but not with GDAL. Works, slowly, and 
AFAIR can only measure CPU time, whereas GDAL does typically lots of I/O, so 
CPU time isn't always very significant. A more lightweight and faster solution 
that I've sometimes used is sysprof (not sure this is really maintained). Only 
sees CPU activity too.

> 
> Rob.
> 
> 
> On Mon, Sep 1, 2014 at 7:14 AM, Even Rouault <even.rouault at spatialys.com>
> 
> wrote:
> > Le dimanche 31 ao?t 2014 20:50:41, Robert Coup a ?crit :
> > > That's cool :) Is there any particular performance penalty to compiling
> > > *with* OGRAPISPY_ENABLED and then running *without*
> > > OGR_API_SPY_FILE/OGR_API_SPY_SNAPSHOT_PATH
> > > set?
> > 
> > Hi Robert,
> > 
> > Hopefully no, see for example :
> > 
> > OGRFeatureH OGR_L_GetNextFeature( OGRLayerH hLayer )
> > 
> > {
> > 
> >     VALIDATE_POINTER1( hLayer, "OGR_L_GetNextFeature", NULL );
> > 
> > #ifdef OGRAPISPY_ENABLED
> > 
> >     if( bOGRAPISpyEnabled )
> >     
> >         OGRAPISpy_L_GetNextFeature(hLayer);
> > 
> > #endif
> > 
> >     return (OGRFeatureH) ((OGRLayer *)hLayer)->GetNextFeature();
> > 
> > }
> > 
> > I cannot imagine something with less overhead. (if you exclude dynamic
> > binary
> > patching techniques ;-) )
> > 
> > OGROpen() and OGR_Dr_CreateDataSource() call a tracing function that
> > tests if
> > the env. variable is set, and if so set the boolean bOGRAPISpyEnabled.
> > 
> > Even
> > 
> > > Rob :)
> > > 
> > > 
> > > On Sun, Aug 31, 2014 at 11:34 PM, Even Rouault <
> > 
> > even.rouault at spatialys.com>
> > 
> > > wrote:
> > > > Hi,
> > > > 
> > > > This will not be of interest for the crowds, but mainly for OGR
> > > > driver developers (and potentially also to get precise bug reports
> > > > from
> > 
> > users).
> > 
> > > > I'm
> > > > currently adding update capabilities to the MITAB driver, and while
> > > > playing with QGIS, there are sometimes sequences of OGR calls that
> > > > trigger bugs, but
> > > > that I had issues to replicate afterwards. This spy mechanism enables
> > 
> > to
> > 
> > > > have
> > > > recording of all relevant calls to be able to replicate them exactly
> > > > afterwards.
> > > > 
> > > > Doc to use it : http://www.gdal.org/ograpispy_8h.html
> > > > 
> > > > Related autotest script :
> > > > http://svn.osgeo.org/gdal/trunk/autotest/ogr/ograpispy.py
> > > > 
> > > > Even
> > > > 
> > > > --
> > > > Spatialys - Geospatial professional services
> > > > http://www.spatialys.com
> > > > _______________________________________________
> > > > gdal-dev mailing list
> > > > gdal-dev at lists.osgeo.org
> > > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ljvillarin30 at gmail.com  Sun Aug 31 21:03:50 2014
From: ljvillarin30 at gmail.com (user_name)
Date: Sun, 31 Aug 2014 21:03:50 -0700 (PDT)
Subject: [gdal-dev] Problem encountered in stitching/merging the raster
	files
Message-ID: <CAMZEyL5sv5FnVrPbK8MLU6Tp4XvMND-5ndRbwZ7J0Qe9S7iaVA@mail.gmail.com>

I tried adding -dstnodata 0 to gdalwarp(I just add one 0 because it has
only 1 band.Am I doing the right thing?) I have attached here the output.
It really didn't stitch/mosaic well. The output is still the same. I'm
really confused?




On Sat, Aug 30, 2014 at 12:31 AM, Rahkonen Jukka (Tike) [via OSGeo.org] <
ml-node+s1560n5159142h49 at n6.nabble.com> wrote:

> user_name <ljvillarin30 <at> gmail.com> writes:
>
> >
> > I've tried your suggestion but then the result was this:
> > Note: I used OpenEV to open the file.
> >
> > <http://osgeo-org.1560.x6.nabble.com/file/n5158992/openev.gif>
>
> Hi,
>
> Result looks like it is because the black slivers which are created by
> warping are not made transparent. Have a try by adding -dstnodata 0 0 0 to
> the gdalwarp command.
>
> -Jukka Rahkonen-
>
> _______________________________________________
> gdal-dev mailing list
> [hidden email] <http://user/SendEmail.jtp?type=node&node=5159142&i=0>
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
> ------------------------------
>  If you reply to this email, your message will be added to the discussion
> below:
>
> http://osgeo-org.1560.x6.nabble.com/Problem-encountered-in-stitching-merging-the-raster-files-tp5158957p5159142.html
>  To unsubscribe from Problem encountered in stitching/merging the raster
> files, click here
> <http://osgeo-org.1560.x6.nabble.com/template/NamlServlet.jtp?macro=unsubscribe_by_code&node=5158957&code=bGp2aWxsYXJpbjMwQGdtYWlsLmNvbXw1MTU4OTU3fC03MDA3NDA3OTM=>
> .
> NAML
> <http://osgeo-org.1560.x6.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&id=instant_html%21nabble%3Aemail.naml&base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.NodeNamespace&breadcrumbs=notify_subscribers%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml>
>


transparent.tif (77K) <http://osgeo-org.1560.x6.nabble.com/attachment/5159338/0/transparent.tif>




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Re-Problem-encountered-in-stitching-merging-the-raster-files-tp5159338.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140831/701cb8f4/attachment.html>

From jukka.rahkonen at mmmtike.fi  Sun Aug 31 22:39:51 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Mon, 1 Sep 2014 05:39:51 +0000 (UTC)
Subject: [gdal-dev]
	=?utf-8?q?Problem_encountered_in_stitching/merging_the?=
	=?utf-8?q?_raster=09files?=
References: <CAMZEyL5sv5FnVrPbK8MLU6Tp4XvMND-5ndRbwZ7J0Qe9S7iaVA@mail.gmail.com>
Message-ID: <loom.20140901T063843-87@post.gmane.org>

user_name <ljvillarin30 <at> gmail.com> writes:

> 
> 
> 
> I tried adding -dstnodata 0 to gdalwarp(I just add one 0 because it has
only 1 band.Am I doing the right thing?) I have attached here the output. It
really didn't stitch/mosaic well. The output is still the same. I'm really
confused?
> 
> 

Hi,

I am confused too. You get two blocks, western one combined from two images
and eastern one combined from three images. For me it looks that the blocks
do not meet simply because your original satellite images do not cover that
internal area and the image which you attached to your firs mail shows all
the image data that you have. For total coverage you should acquire more
images into your mosaic. Correct me if you are sure that your originals
cover also the middle area.

-Jukka Rahkonen-


