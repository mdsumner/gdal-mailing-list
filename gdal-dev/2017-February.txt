From mkarabacak at meteksan.com  Wed Feb  1 01:02:50 2017
From: mkarabacak at meteksan.com (Mahir Karabacak)
Date: Wed, 1 Feb 2017 11:02:50 +0200 (EET)
Subject: [gdal-dev] GDAL - JAVA getting Elevation Data
Message-ID: <1315531982.698526.1485939770059.JavaMail.zimbra@meteksan.com>

Hi All,

I hava Java code below which gets elevation data according to coordinate. My question; what if I have multiple GeoTiff files, how can I read all into one dataset or merge all data into one dataset?

Thanks in Advance,
Mahir KARABACAK


private static Dataset elevationDataSet;
private static double[] geoTransformsInDoubles;
private static Band rasterBand;
private static double[] invGeoTransformsInDoubles;


elevationDataSet = gdal.Open("M:/maps/20170130011154_1642612357.tif", gdalconst.GA_ReadOnly);
geoTransformsInDoubles = elevationDataSet.GetGeoTransform();
rasterBand = elevationDataSet.GetRasterBand(1);
invGeoTransformsInDoubles = gdal.InvGeoTransform(geoTransformsInDoubles);

double[] pdfGeoX = new double [1];
double[] pdfGeoY = new double [1];
                                
gdal.ApplyGeoTransform(invGeoTransformsInDoubles, lon, lat, pdfGeoX, pdfGeoY);
double [] flt = new double[2];

int readResult = rasterBand.ReadRaster((int)pdfGeoX[0], (int)pdfGeoY[0], 1,1, gdalconst.GDT_CFloat64,flt);

if (readResult == 0)
{
                return flt[0];
}

From michael.smith.erdc at gmail.com  Wed Feb  1 02:10:20 2017
From: michael.smith.erdc at gmail.com (Michael Smith)
Date: Wed, 1 Feb 2017 05:10:20 -0500
Subject: [gdal-dev] GDAL - JAVA getting Elevation Data
In-Reply-To: <1315531982.698526.1485939770059.JavaMail.zimbra@meteksan.com>
References: <1315531982.698526.1485939770059.JavaMail.zimbra@meteksan.com>
Message-ID: <5C57C550-17AF-4A10-B5D9-B47A5E7062D7@gmail.com>

Use gdalbuildvrt to merge all your rasters to a single virtual file and the open that vrt. 

Michael Smith
Remote Sensing/GIS Center
US Army Corps of Engineers

> On Feb 1, 2017, at 4:02 AM, Mahir Karabacak <mkarabacak at meteksan.com> wrote:
> 
> Hi All,
> 
> I hava Java code below which gets elevation data according to coordinate. My question; what if I have multiple GeoTiff files, how can I read all into one dataset or merge all data into one dataset?
> 
> Thanks in Advance,
> Mahir KARABACAK
> 
> 
> private static Dataset elevationDataSet;
> private static double[] geoTransformsInDoubles;
> private static Band rasterBand;
> private static double[] invGeoTransformsInDoubles;
> 
> 
> elevationDataSet = gdal.Open("M:/maps/20170130011154_1642612357.tif", gdalconst.GA_ReadOnly);
> geoTransformsInDoubles = elevationDataSet.GetGeoTransform();
> rasterBand = elevationDataSet.GetRasterBand(1);
> invGeoTransformsInDoubles = gdal.InvGeoTransform(geoTransformsInDoubles);
> 
> double[] pdfGeoX = new double [1];
> double[] pdfGeoY = new double [1];
>                                 
> gdal.ApplyGeoTransform(invGeoTransformsInDoubles, lon, lat, pdfGeoX, pdfGeoY);
> double [] flt = new double[2];
> 
> int readResult = rasterBand.ReadRaster((int)pdfGeoX[0], (int)pdfGeoY[0], 1,1, gdalconst.GDT_CFloat64,flt);
> 
> if (readResult == 0)
> {
>                 return flt[0];
> }
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From daniele.romagnoli at geo-solutions.it  Wed Feb  1 04:04:03 2017
From: daniele.romagnoli at geo-solutions.it (Daniele Romagnoli)
Date: Wed, 1 Feb 2017 13:04:03 +0100
Subject: [gdal-dev] Question on 0th IFD offset when producing a
 JPEG-Compressed GeoTIFF (GDAL 1.11 vs 2.x)
In-Reply-To: <1630066.YYN0yo8X9a@even-i700>
References: <CAJaHrDwPP5_1_+oTAi2u=reSYRbjWhb2cKyREXFe0sLfB3XUVQ@mail.gmail.com>
 <CAJaHrDx0K6zgyktOV9-KDMNhxGEHrpGDLj7mSzDCJCn489TNLQ@mail.gmail.com>
 <CAJaHrDwc76v8DRCCQW9OKyH_sB2KiVe3kP7oEB6kmgceAqAfGg@mail.gmail.com>
 <1630066.YYN0yo8X9a@even-i700>
Message-ID: <CAJaHrDzQR_zg+dguOuFad1qW4FK+tcf2oXADmEK7aLFAM+cwKg@mail.gmail.com>

Hi Even, another question.

What about the internal libtiff implementation?
There will be any difference in building against a system (released)
libtiff version with respect to the internal version?

Cheers,
Daniele


On Tue, Jan 31, 2017 at 6:34 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> On mardi 31 janvier 2017 18:29:48 CET Daniele Romagnoli wrote:
>
> > Hi Even,
>
> > I'm back to this topic and I have a couple of questions.
>
> > - Is it there any libtiff specific version involvement on that?
>
> > - Are all these improvements self contained in GDAL code itself or do
> them
>
> > require some specific libtiff version?
>
>
>
> Should probably work with any libtiff 4.0.X version
>
>
>
> >
>
> > Cheers,
>
> > Daniele
>
> >
>
> > On Fri, Dec 16, 2016 at 2:56 PM, Daniele Romagnoli <
>
> >
>
> > daniele.romagnoli at geo-solutions.it> wrote:
>
> > > On Fri, Dec 16, 2016 at 2:48 PM, Even Rouault <
> even.rouault at spatialys.com>
>
> > >
>
> > > wrote:
>
> > >> > Right,
>
> > >> >
>
> > >> > Indeed, before sending my previous email I have also tried with:
>
> > >> >
>
> > >> > *gdaladdo -r average --config COMPRESS_OVERVIEW DEFLATE --config
>
> > >> >
>
> > >> > PHOTOMETRIC_OVERVIEW RGB*
>
> > >> >
>
> > >> > to understand if it was related to JPEG only but, even with these
>
> > >>
>
> > >> options,
>
> > >>
>
> > >> > the output overviews were jpeg compressed (I assume there is some
> kind
>
> > >>
>
> > >> of
>
> > >>
>
> > >> > coherency check in gdaladdo).
>
> > >>
>
> > >> With internal overviews, the _OVERVIEW configuration options are
> ignored.
>
> > >> Their value is deduced from the settings of the main IFD.
>
> > >
>
> > > It makes sense, indeed.
>
> > >
>
> > >> I don't think there's a strong technical reason for that. Mostly a
> side
>
> > >> effect of the fact that there are slightly different code paths to
> handle
>
> > >> creation of internal and external overviews, and the reading of
> _OVERVIEW
>
> > >> config options is done only in the external overview code path.
>
> > >>
>
> > >> > > I do reproduce something similar to your findings in 2.1 indeed.
> This
>
> > >>
>
> > >> no
>
> > >>
>
> > >> > > longer happens in trunk due to related improvements (
>
> > >> > >
>
> > >> > > https://trac.osgeo.org/gdal/wiki/CloudOptimizedGeoTIFF), I made
> in
>
> > >>
>
> > >> the
>
> > >>
>
> > >> > > last couple of weeks (using the same trick of creating a in-memory
>
> > >>
>
> > >> TIFF
>
> > >>
>
> > >> > > file to get the JPEG tables and set them direcly on the overview
> IFD
>
> > >>
>
> > >> at
>
> > >>
>
> > >> > > creation time).
>
> > >> >
>
> > >> > Do you think this will be available in other series or does it
>
> > >> > introduce
>
> > >> >
>
> > >> > new API/major changes which makes it available on 2.2.x only?
>
> > >>
>
> > >> No API change, but this is in the improvement category rather than
>
> > >> bugfixing, and my first changeset resulted in some corrupted images in
>
> > >> some
>
> > >> situations, which was unnoticed for a few weeks, so that's a sign
> that it
>
> > >> is a somewhat risky change (the GeoTIFF driver is a complex beast),
> not
>
> > >> worth the trouble of breaking stable branches.
>
> > >
>
> > > Understood. thanks for the feedback.
>
> > > Cheers,
>
> > > Daniele
>
> > >
>
> > >> Even
>
> > >>
>
> > >>
>
> > >>
>
> > >> --
>
> > >>
>
> > >> Spatialys - Geospatial professional services
>
> > >>
>
> > >> http://www.spatialys.com
>
> > >
>
> > > --
>
> > > ==
>
> > > GeoServer Professional Services from the experts! Visit
>
> > > http://goo.gl/it488V for more information.
>
> > > ==
>
> > >
>
> > > Ing. Daniele Romagnoli
>
> > > Senior Software Engineer
>
> > >
>
> > > GeoSolutions S.A.S.
>
> > > Via di Montramito 3/A
>
> > > 55054 Massarosa (LU)
>
> > > Italy
>
> > > phone: +39 0584 962313 <+39%200584%20962313> <+39%200584%20962313>
>
> > > fax: +39 0584 1660272 <+39%200584%20166%200272>
> <+39%200584%20166%200272>
>
> > >
>
> > > http://www.geo-solutions.it
>
> > > http://twitter.com/geosolutions_it
>
> > >
>
> > > -------------------------------------------------------
>
> > >
>
> > > *AVVERTENZE AI SENSI DEL D.Lgs. 196/2003*
>
> > >
>
> > > Le informazioni contenute in questo messaggio di posta elettronica e/o
>
> > > nel/i file/s allegato/i sono da considerarsi strettamente riservate. Il
>
> > > loro utilizzo è consentito esclusivamente al destinatario del
> messaggio,
>
> > > per le finalità indicate nel messaggio stesso. Qualora riceviate questo
>
> > > messaggio senza esserne il destinatario, Vi preghiamo cortesemente di
>
> > > darcene notizia via e-mail e di procedere alla distruzione del
> messaggio
>
> > > stesso, cancellandolo dal Vostro sistema. Conservare il messaggio
> stesso,
>
> > > divulgarlo anche in parte, distribuirlo ad altri soggetti, copiarlo, od
>
> > > utilizzarlo per finalità diverse, costituisce comportamento contrario
> ai
>
> > > principi dettati dal D.Lgs. 196/2003.
>
> > >
>
> > >
>
> > >
>
> > > The information in this message and/or attachments, is intended solely
> for
>
> > > the attention and use of the named addressee(s) and may be
> confidential or
>
> > > proprietary in nature or covered by the provisions of privacy act
>
> > > (Legislative Decree June, 30 2003, no.196 - Italy's New Data Protection
>
> > > Code).Any use not in accord with its purpose, any disclosure,
>
> > > reproduction,
>
> > > copying, distribution, or either dissemination, either whole or
> partial,
>
> > > is
>
> > > strictly forbidden except previous formal approval of the named
>
> > > addressee(s). If you are not the intended recipient, please contact
>
> > > immediately the sender by telephone, fax or e-mail and delete the
>
> > > information in this message that has been received in error. The sender
>
> > > does not give any warranty or accept liability as the content,
> accuracy or
>
> > > completeness of sent messages and accepts no responsibility for changes
>
> > > made after they were sent or for other risks which arise as a result of
>
> > > e-mail transmission, viruses, etc.
>
>
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>



-- 
==
GeoServer Professional Services from the experts! Visit
http://goo.gl/it488V for more information.
==

Ing. Daniele Romagnoli
Senior Software Engineer

GeoSolutions S.A.S.
Via di Montramito 3/A
55054  Massarosa (LU)
Italy
phone: +39 0584 962313
fax:      +39 0584 1660272

http://www.geo-solutions.it
http://twitter.com/geosolutions_it

-------------------------------------------------------

*AVVERTENZE AI SENSI DEL D.Lgs. 196/2003*

Le informazioni contenute in questo messaggio di posta elettronica e/o
nel/i file/s allegato/i sono da considerarsi strettamente riservate. Il
loro utilizzo è consentito esclusivamente al destinatario del messaggio,
per le finalità indicate nel messaggio stesso. Qualora riceviate questo
messaggio senza esserne il destinatario, Vi preghiamo cortesemente di
darcene notizia via e-mail e di procedere alla distruzione del messaggio
stesso, cancellandolo dal Vostro sistema. Conservare il messaggio stesso,
divulgarlo anche in parte, distribuirlo ad altri soggetti, copiarlo, od
utilizzarlo per finalità diverse, costituisce comportamento contrario ai
principi dettati dal D.Lgs. 196/2003.



The information in this message and/or attachments, is intended solely for
the attention and use of the named addressee(s) and may be confidential or
proprietary in nature or covered by the provisions of privacy act
(Legislative Decree June, 30 2003, no.196 - Italy's New Data Protection
Code).Any use not in accord with its purpose, any disclosure, reproduction,
copying, distribution, or either dissemination, either whole or partial, is
strictly forbidden except previous formal approval of the named
addressee(s). If you are not the intended recipient, please contact
immediately the sender by telephone, fax or e-mail and delete the
information in this message that has been received in error. The sender
does not give any warranty or accept liability as the content, accuracy or
completeness of sent messages and accepts no responsibility  for changes
made after they were sent or for other risks which arise as a result of
e-mail transmission, viruses, etc.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170201/c466afff/attachment-0001.html>

From andre+joost at nurfuerspam.de  Wed Feb  1 07:28:32 2017
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Wed, 01 Feb 2017 16:28:32 +0100
Subject: [gdal-dev] Question in orthographic projection usage with PROJ4
In-Reply-To: <OFABCBD819.AA2457EC-ONC12580B9.00539026-C12580B9.005C203D@rohde-schwarz.com>
References: <OFABCBD819.AA2457EC-ONC12580B9.00539026-C12580B9.005C203D@rohde-schwarz.com>
Message-ID: <o6surg$mvq$1@blaine.gmane.org>

Am 31.01.2017 um 17:46 schrieb 
Niels.vonFestenberg-Packisch.ext at rohde-schwarz.com:
> Hi all,
> I would like to transform local cartesian coordinates into longitude and
> latitude. According to all the documentation I could find, I tried doing
> this (in C++, specifying a center for the orthographic projection at 56 N
> 15 E):
>
> projPJ cSourceProjection = pj_init_plus("+proj=ortho +ellps=WGS84
> +datum=WGS84 +lat_0=56 +lon_0=15 +no_defs");
> projPJ cTargetProjection = pj_init_plus("+proj=longlat +ellps=WGS84
> +datum=WGS84 +no_defs");


>
> Could you maybe give me a hint what is going wrong here?
>

You have not told GDAL that your projected data is in meters, so add 
+units=m to your "from" proj.4 string.

HTH,
André Joost



From even.rouault at spatialys.com  Wed Feb  1 07:37:41 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 01 Feb 2017 16:37:41 +0100
Subject: [gdal-dev] Fwd: Google Summer of Code ideas page: action required
	latest by February 5th!
Message-ID: <3157503.X6fs8M7YJC@even-i700>

The deadline is in 4 days. Our usual placeholder page is at
https://trac.osgeo.org/gdal/wiki/SummerOfCode

Even

----------  Forwarded Message  ----------

Subject: [gdal-dev] Google Summer of Code ideas page: action required latest by 
February 5th!
Date: dimanche 22 janvier 2017, 03:19:01 CET
From: Helmut Kudrnovsky <hellik at web.de>
To: gdal-dev at lists.osgeo.org

Dear All,

It’s that time of the year again! 

Applications for Google Summer of Code 2017 are now open for would-be mentor
organizations, and we are in the process of applying on behalf of OSGeo. At
this stage, it is extremely important that we put up a nice and informative
ideas page, that Google will look at in order to evaluate OSGeo’s
application. 

*We need your help!* 

As previous years, we will create an OSGeo Ideas page, that links to
software communities ideas pages. If you wish to participate, please, start
listing the ideas and the corresponding mentors of your software community
and send us the link to your wiki page latest by February 5th. 

And spread the word as much as you can!!

*Please note that from this year we have set up a group email for admin
purpose where you can reach all of us OSGeo GSoC admins at once: 
gsoc-admin at osgeo.org.*

For further GSoC-related discussions e.g. inter/cross-project
ideas/proposals, ideas discussions, etc please use the long established
OSGeo’s SoC -- Google Summer of Code Coordination mailing list
(https://lists.osgeo.org/mailman/listinfo/soc).

Thank you 
the OSGeo GSoC Admins Team 2017



-----
best regards
Helmut
--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Google-Summer-of-Code-ideas-page-action-required-latest-by-February-5th-tp5304324.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev

-----------------------------------------
-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170201/36b29c0c/attachment.html>

From asmitawankhede at gmail.com  Wed Feb  1 10:55:41 2017
From: asmitawankhede at gmail.com (asmita)
Date: Wed, 1 Feb 2017 11:55:41 -0700 (MST)
Subject: [gdal-dev] Change of behavior ?? GDALRasterBand:IReadBlock vs
	RasterIO ?
In-Reply-To: <13269087.dSrpvMvnSZ@even-i700>
References: <1485815608022-5305401.post@n6.nabble.com>
 <13269087.dSrpvMvnSZ@even-i700>
Message-ID: <1485975341246-5305837.post@n6.nabble.com>

I implemented the IReadBlock, still same issue with the WarpOperation  ( that
is the code path I am hitting essentially). The issue I see now is the warp
does miss some band info or something happens that the entire mosaic is
black instead of the imagery. Note that these are non pallette imageries :

implementation:

CPLErr XYZRasterBand::IReadBlock(int nBlockXOff, int nBlockYOff, void
*pImage) {


    int nXOff = nBlockXOff * nBlockXSize,
        nYOff = nBlockYOff * nBlockYSize,
        nXSize = nBlockXSize,
        nYSize = nBlockYSize;

    if( nXOff + nXSize > nRasterXSize )
        nXSize = nRasterXSize - nXOff;
    if( nYOff + nYSize > nRasterYSize )
        nYSize = nRasterYSize - nYOff;

    int nPixelSpace = GDALGetDataTypeSize(eDataType) / 8;
    int nLineSpace = nPixelSpace * nBlockXSize;

    GDALRasterIOExtraArg sExtraArg;
    INIT_RASTERIO_EXTRA_ARG(sExtraArg);
   
    return IRasterIO(GF_Read,
                    nXOff, nYOff, nXSize, nYSize,
                    pImage, nXSize, nYSize,
                    eDataType, nPixelSpace, nLineSpace, &sExtraArg);
    
}

WarpOperation : region to buffer call:

void
xyzGDALWarpingReader::FetchPixels(const xyzExtents<uint32> &srcExtents)
{
  warpOperation.WarpRegionToBuffer(srcExtents.beginX(),
                                       srcExtents.beginY(),
                                       srcExtents.width(),
                                       srcExtents.height(),
                                       &rawReadBuf[0],
                                       gdalDatatype
                               );
  }
}

srcExtents acts as a destination buffer for whatever reason in the codebase,
and it used to work for GDAL 1.1



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Change-of-behavior-GDALRasterBand-IReadBlock-vs-RasterIO-tp5305401p5305837.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Thu Feb  2 07:35:32 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 02 Feb 2017 16:35:32 +0100
Subject: [gdal-dev] Call for discussion on RFC 67 : Null values in OGR
In-Reply-To: <5072295.SuT4PmY2Is@even-i700>
References: <5072295.SuT4PmY2Is@even-i700>
Message-ID: <8744061.j3LJ0n6uOS@even-i700>

On mercredi 25 janvier 2017 19:54:16 CET Even Rouault wrote:
> Hi,
> 
> I've prepared a new RFC regarding the handling of null values in OGR.
> 
> https://trac.osgeo.org/gdal/wiki/rfc67_nullfieldvalues
> 
> No implementation proposed yet at this stage. I want to check if the
> proposed design choices make sense.

I've updated the RFC with the remarks in this thread and adjustments done during the 
implementation, and linked to the proposed implementation.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170202/29e99248/attachment.html>

From arno at agerrius.nl  Thu Feb  2 11:32:47 2017
From: arno at agerrius.nl (agerrius)
Date: Thu, 2 Feb 2017 12:32:47 -0700 (MST)
Subject: [gdal-dev] Replace holes by multiple polygons
Message-ID: <1486063967801-5306055.post@n6.nabble.com>

Hi,

I'm trying to use polygons with holes in another application that does not
support the concept of holes. So my idea is to split the polygons with holes
into a number of polygons, so that the same shape can be represented without
using holes.

Does GDAL have any functionality for this kind of processing?

Thanks,

Arno



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Replace-holes-by-multiple-polygons-tp5306055.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From Ahmed.Tolba at schiebel.net  Fri Feb  3 00:32:41 2017
From: Ahmed.Tolba at schiebel.net (Ahmed Tolba)
Date: Fri, 3 Feb 2017 08:32:41 +0000
Subject: [gdal-dev] WFS-T using OGR
In-Reply-To: <6433577.9LDBNAqD9F@even-i700>
References: <c75f5580b60247f6b204c44b650b9dbc@SRV046.seg.local>
 <5346348.SzerkG8gYQ@even-i700>
 <3e7b6b87f0c9411e8e6a98e809b318d6@SRV046.seg.local>
 <6433577.9LDBNAqD9F@even-i700>
Message-ID: <6e81fe27fabf46b7a8b6e9d3c6b466a6@SRV046.seg.local>

Hi Even,

Here is the config.xml file for tinyows. I still can't parse the schema .xsd. For more information, please let me know if you need it.

Ahmed

From: Even Rouault [mailto:even.rouault at spatialys.com]
Sent: Friday, January 27, 2017 12:22 PM
To: Ahmed Tolba
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] WFS-T using OGR


On vendredi 27 janvier 2017 10:59:21 CET Ahmed Tolba wrote:

> Hi

> Thanks for your answer.

>

> I tried to do what you suggested, but I get " Can not insert the feature,

> because we didn't manage to parse the .XSD schema "



As the message suggests, the OGR WFS client didn't manage to get or correctly parse the schema for the layer. This is a bit surprising as TinyOWS should generate simple enough schemas for OGR to understand them. Difficult to know what happens without being able to reproduce on my side.



Even





--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170203/cd8077d1/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: config.xml
Type: application/xml
Size: 1224 bytes
Desc: config.xml
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170203/cd8077d1/attachment.xml>

From even.rouault at spatialys.com  Fri Feb  3 01:28:15 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 03 Feb 2017 10:28:15 +0100
Subject: [gdal-dev] Question on 0th IFD offset when producing a
	JPEG-Compressed GeoTIFF (GDAL 1.11 vs 2.x)
In-Reply-To: <CAJaHrDzQR_zg+dguOuFad1qW4FK+tcf2oXADmEK7aLFAM+cwKg@mail.gmail.com>
References: <CAJaHrDwPP5_1_+oTAi2u=reSYRbjWhb2cKyREXFe0sLfB3XUVQ@mail.gmail.com>
 <1630066.YYN0yo8X9a@even-i700>
 <CAJaHrDzQR_zg+dguOuFad1qW4FK+tcf2oXADmEK7aLFAM+cwKg@mail.gmail.com>
Message-ID: <1782369.cmG1nRO2g4@even-i700>

On mercredi 1 février 2017 13:04:03 CET Daniele Romagnoli wrote:
> Hi Even, another question.
> 
> What about the internal libtiff implementation?
> There will be any difference in building against a system (released)
> libtiff version with respect to the internal version?

The internal libtiff implementation is just libtiff CVS HEAD, so currently 4.0.8dev
So it has generally a few more fixes than the last released version, but for the 
subject discussed here, using it or an external libtiff will not make a difference.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170203/02e6a493/attachment.html>

From daniele.romagnoli at geo-solutions.it  Fri Feb  3 01:39:51 2017
From: daniele.romagnoli at geo-solutions.it (Daniele Romagnoli)
Date: Fri, 3 Feb 2017 10:39:51 +0100
Subject: [gdal-dev] Question on 0th IFD offset when producing a
 JPEG-Compressed GeoTIFF (GDAL 1.11 vs 2.x)
In-Reply-To: <1782369.cmG1nRO2g4@even-i700>
References: <CAJaHrDwPP5_1_+oTAi2u=reSYRbjWhb2cKyREXFe0sLfB3XUVQ@mail.gmail.com>
 <1630066.YYN0yo8X9a@even-i700>
 <CAJaHrDzQR_zg+dguOuFad1qW4FK+tcf2oXADmEK7aLFAM+cwKg@mail.gmail.com>
 <1782369.cmG1nRO2g4@even-i700>
Message-ID: <CAJaHrDyF6OSZRMR954EHCfcTNDKY2jrSoDjKD2zLB9fAp-yZnQ@mail.gmail.com>

Hi Even,
Thanks for your feedback, as usual.

Cheers,
Daniele

On Fri, Feb 3, 2017 at 10:28 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> On mercredi 1 février 2017 13:04:03 CET Daniele Romagnoli wrote:
>
> > Hi Even, another question.
>
> >
>
> > What about the internal libtiff implementation?
>
> > There will be any difference in building against a system (released)
>
> > libtiff version with respect to the internal version?
>
>
>
> The internal libtiff implementation is just libtiff CVS HEAD, so currently
> 4.0.8dev
>
> So it has generally a few more fixes than the last released version, but
> for the subject discussed here, using it or an external libtiff will not
> make a difference.
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
==
GeoServer Professional Services from the experts! Visit
http://goo.gl/it488V for more information.
==

Ing. Daniele Romagnoli
Senior Software Engineer

GeoSolutions S.A.S.
Via di Montramito 3/A
55054  Massarosa (LU)
Italy
phone: +39 0584 962313
fax:      +39 0584 1660272

http://www.geo-solutions.it
http://twitter.com/geosolutions_it

-------------------------------------------------------

*AVVERTENZE AI SENSI DEL D.Lgs. 196/2003*

Le informazioni contenute in questo messaggio di posta elettronica e/o
nel/i file/s allegato/i sono da considerarsi strettamente riservate. Il
loro utilizzo è consentito esclusivamente al destinatario del messaggio,
per le finalità indicate nel messaggio stesso. Qualora riceviate questo
messaggio senza esserne il destinatario, Vi preghiamo cortesemente di
darcene notizia via e-mail e di procedere alla distruzione del messaggio
stesso, cancellandolo dal Vostro sistema. Conservare il messaggio stesso,
divulgarlo anche in parte, distribuirlo ad altri soggetti, copiarlo, od
utilizzarlo per finalità diverse, costituisce comportamento contrario ai
principi dettati dal D.Lgs. 196/2003.



The information in this message and/or attachments, is intended solely for
the attention and use of the named addressee(s) and may be confidential or
proprietary in nature or covered by the provisions of privacy act
(Legislative Decree June, 30 2003, no.196 - Italy's New Data Protection
Code).Any use not in accord with its purpose, any disclosure, reproduction,
copying, distribution, or either dissemination, either whole or partial, is
strictly forbidden except previous formal approval of the named
addressee(s). If you are not the intended recipient, please contact
immediately the sender by telephone, fax or e-mail and delete the
information in this message that has been received in error. The sender
does not give any warranty or accept liability as the content, accuracy or
completeness of sent messages and accepts no responsibility  for changes
made after they were sent or for other risks which arise as a result of
e-mail transmission, viruses, etc.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170203/fc12d7ed/attachment-0001.html>

From johan.vandewauw at gmail.com  Fri Feb  3 01:45:37 2017
From: johan.vandewauw at gmail.com (Johan Van de Wauw)
Date: Fri, 3 Feb 2017 10:45:37 +0100
Subject: [gdal-dev] clipping a vector to extent with gdal.VectorTranslate
Message-ID: <CAJOp35ksy5jCFpkL7hd9fmPEXcxvFq1KZP0zk_AxPomXWuvvjg@mail.gmail.com>

Hi all,

We are using the new python function gdal.VectorTranslate which should
work similar to ogr2ogr.

We were able to use spatFilter to select only elements that intersect
(like the [-spat xmin ymin xmax ymax] operator.

But we failed to clip to the extent, similar to the
[-clipsrc [xmin ymin xmax ymax] option in ogr2ogr. Is this possible
with this function?

Kind Regards,
Johan

From even.rouault at spatialys.com  Fri Feb  3 01:53:52 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 03 Feb 2017 10:53:52 +0100
Subject: [gdal-dev] clipping a vector to extent with gdal.VectorTranslate
In-Reply-To: <CAJOp35ksy5jCFpkL7hd9fmPEXcxvFq1KZP0zk_AxPomXWuvvjg@mail.gmail.com>
References: <CAJOp35ksy5jCFpkL7hd9fmPEXcxvFq1KZP0zk_AxPomXWuvvjg@mail.gmail.com>
Message-ID: <3903157.lg0VuJpNQG@even-i700>

On vendredi 3 février 2017 10:45:37 CET Johan Van de Wauw wrote:
> Hi all,
> 
> We are using the new python function gdal.VectorTranslate which should
> work similar to ogr2ogr.
> 
> We were able to use spatFilter to select only elements that intersect
> (like the [-spat xmin ymin xmax ymax] operator.
> 
> But we failed to clip to the extent, similar to the
> [-clipsrc [xmin ymin xmax ymax] option in ogr2ogr. Is this possible
> with this function?
> 

Johann,

it indeed doesn't look like this was mapped to a friendly Python argument. But you can 
always use the generic options keyword to specify the command line parameters like you do 
with ogr2ogr (note that if you use options, all other dedicated parameters will be ignored).

Contributions to add a dedicated argument for clipSrc are welcome. Hint: edit
the VectorTranslateOptions() method in swig/include/python/gdal_python.i

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170203/fa423503/attachment.html>

From sean at mapbox.com  Fri Feb  3 11:10:14 2017
From: sean at mapbox.com (Sean Gillies)
Date: Fri, 3 Feb 2017 20:10:14 +0100
Subject: [gdal-dev] Zip files and VISFileFromMemBuffer()
In-Reply-To: <CACmBxytb+2dawSBm91ZA1urAu=xNQUTW9u433+5z-74a6ky6Dg@mail.gmail.com>
References: <CADPhZXwQ_ZOPwxRsr=ArHCVWxL0zwFuxM=3P45TDO9m9ONWGQw@mail.gmail.com>
 <7906214.4ItMEDhMbS@even-i700>
 <CADPhZXzVsOKsviicXXR9ptoybLrQvv22EBa0j9h6V2Cd3B=89A@mail.gmail.com>
 <CACmBxytb+2dawSBm91ZA1urAu=xNQUTW9u433+5z-74a6ky6Dg@mail.gmail.com>
Message-ID: <CADPhZXxbr81tvLp+QZkOLz5VX=f6mX5SaebL61BPuJiJ7-_erA@mail.gmail.com>

Yes (as I said off-list), that works too. I've written a post about
Rasterio's MemoryFile and ZipMemoryFile here:
https://github.com/mapbox/rasterio/issues/977. I like GDAL's virtual files
a lot and I think that these classes could make them very accessible to
Python programmers.

On Wed, Feb 1, 2017 at 12:56 AM, Kurt Schwehr <schwehr at gmail.com> wrote:

> Sean,
>
> Very cool.  One follow up question, do you really need the "with" for
> open?  Does this not work (and MemoryFile can drop the file descriptor as
> soon as it wants to)?
>
> with MemoryFile(open(path_zip_file, 'rb')) as memfile:
>         with memfile.open('white-gemini-iv.vrt') as dataset:
>             assert dataset.count == 3
>
> On Tue, Jan 31, 2017 at 3:35 PM, Sean Gillies <sean at mapbox.com> wrote:
>
>> Thanks for confirming that I was on the right trail, Even! I got it
>> figured out: I was naively trying to open the /vsizip/vsimem/ file in
>> update mode.
>>
>> In case you're interested, my new Python usage is like this:
>>
>> with open(path_zip_file, 'rb') as f:
>>     with MemoryFile(f) as memfile:
>>         with memfile.open('white-gemini-iv.vrt') as dataset:
>>             assert dataset.count == 3
>>
>> https://github.com/mapbox/rasterio/pull/972/files#diff-d3388
>> b510bd97235e4741b8417cc41e9R148
>>
>>
>> On Tue, Jan 31, 2017 at 5:42 PM, Even Rouault <even.rouault at spatialys.com
>> > wrote:
>>
>>> On mardi 31 janvier 2017 17:33:23 CET Sean Gillies wrote:
>>>
>>> > Hey all,
>>>
>>> >
>>>
>>> > The tests in
>>>
>>> > https://svn.osgeo.org/gdal/branches/1.9/autotest/gcore/vsizip.py show
>>> how
>>>
>>> > to create a zip archive in memory and create directories and files
>>> within
>>>
>>> > it. I'm looking for a shortcut.
>>>
>>> >
>>>
>>> > Given a sequence of bytes representing an existing zip file that
>>> contains a
>>>
>>> > TIFF and a VRT (referencing the TIFF), is it possible to make a VSI
>>> file
>>>
>>> > from this buffer (using VISFileFromMemBuffer()) and then access the VRT
>>>
>>> > using a path like /vsizip/vsimem/archive.zip/example.vrt protocol?
>>>
>>>
>>>
>>> Hi Sean,
>>>
>>>
>>>
>>> That sounds like you tested it and something went wrong ? Perhaps check
>>> the path to the source in the VRT and the value of the relativeToVRT
>>> attribute.
>>>
>>>
>>>
>>> Your above strategy does work for me:
>>>
>>>
>>>
>>> $ gdal_translate byte.tif byte.vrt -of VRT
>>>
>>> Input file size is 20, 20
>>>
>>>
>>>
>>> $ zip byte.tif.zip byte.tif byte.vrt
>>>
>>> adding: byte.tif (deflated 96%)
>>>
>>> adding: byte.vrt (deflated 53%)
>>>
>>>
>>>
>>> $ python
>>>
>>> >>> from osgeo import gdal
>>>
>>> >>> data = open('byte.tif.zip', 'rb').read()
>>>
>>> >>> gdal.FileFromMemBuffer('/vsimem/archive.zip', data)
>>>
>>> >>> ds = gdal.Open('/vsizip/vsimem/archive.zip/byte.vrt')
>>>
>>> >>> ds.GetRasterBand(1).Checksum()
>>>
>>> 4672
>>>
>>>
>>>
>>>
>>>
>>> Even
>>>
>>>
>>>
>>>
>>>
>>> --
>>>
>>> Spatialys - Geospatial professional services
>>>
>>> http://www.spatialys.com
>>>
>>
>>
>>
>> --
>> Sean Gillies
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>
> --
> --
> http://schwehr.org
>



-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170203/8718dc2d/attachment.html>

From jgreenberg at unr.edu  Mon Feb  6 14:33:19 2017
From: jgreenberg at unr.edu (Jonathan Greenberg)
Date: Mon, 06 Feb 2017 22:33:19 +0000
Subject: [gdal-dev] Mosaic question...
Message-ID: <CABG0rfuFzvYeHNfxd5iLx877mSbeSP6zCrV_kh=bROA+YP37Mg@mail.gmail.com>

GDALers:

I love the gdalbuildvrt -> gdal_translate trick for large mosaicks, but I
have a somewhat more complicated problem I was hoping I could get some help
on.  Given a large set of overlapping images, I want to mosaic using the
following "rules": 1) all overlapping pixels should be averaged together,
and 2) any "nodata" pixels in a given input image should be ignored in that
calculation.

Is this doable in GDAL?  Or am I stuck with just the "top" image in the vrt
being the value the output mosaic uses?

--j
-- 
-- 
Jonathan A. Greenberg, PhD
Randall Endowed Professor and Associate Professor of Remote Sensing
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Natural Resources & Environmental Science
University of Nevada, Reno
1664 N Virginia St MS/0186
Reno, NV 89557
Phone: 415-763-5476
http://www.unr.edu/nres
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170206/0ad1a10d/attachment.html>

From Ahmed.Tolba at schiebel.net  Tue Feb  7 04:17:12 2017
From: Ahmed.Tolba at schiebel.net (Ahmed Tolba)
Date: Tue, 7 Feb 2017 12:17:12 +0000
Subject: [gdal-dev] Setting a point into postgresql using GDAL
Message-ID: <ca16dc4803754fc2bef0322d97819935@SRV046.seg.local>

Hi All,
I’m trying to set a point xyz, which represents longitude altitude latitude, but when I create the feature, I get Error 1 Can’t find transcation response.

The Geometry field is set by this in the database:

ALTER TABLE poiserver ALTER COLUMN geom TYPE GEOMETRY(POINTZ,4326) USING ST_Force3D(geom);

Thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170207/567aa02c/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Tue Feb  7 04:56:50 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Tue, 7 Feb 2017 05:56:50 -0700 (MST)
Subject: [gdal-dev] Setting a point into postgresql using GDAL
In-Reply-To: <ca16dc4803754fc2bef0322d97819935@SRV046.seg.local>
References: <ca16dc4803754fc2bef0322d97819935@SRV046.seg.local>
Message-ID: <1486472210061-5306724.post@n6.nabble.com>

andreahmed wrote
> Hi All,
> I’m trying to set a point xyz, which represents longitude altitude
> latitude, but when I create the feature, I get Error 1 Can’t find
> transcation response.
> 
> The Geometry field is set by this in the database:
> 
> ALTER TABLE poiserver ALTER COLUMN geom TYPE GEOMETRY(POINTZ,4326) USING
> ST_Force3D(geom);
> 
> Thanks

Hi "andreahmed"

I need to say that your question as you put it makes no sense for the
readers of this mailing list. I believe that you continue your struggle with
trying to do transactions with TinyOWS and GDAL. There is another thread
about this in Mapserver-users list
http://osgeo-org.1560.x6.nabble.com/getting-layers-from-tinyows-tc5306192.html.
You also started a new cross-post thread
http://osgeo-org.1560.x6.nabble.com/Setting-a-point-into-postgresql-tc5306718.html.

Instead of starting new threads I would consider improving your initial
question. The "MCVE" advice at http://stackoverflow.com/help/mcve is a good
starting point. It can still happen that nobody can help you because there
may be rather few who have experience on TinyOWS WFS + XYX point geometries
+ GDAL as WFS client, but you will have better possibilities. It also
happens quite often for me that the problem gets solved while I gather and
test the Minimal, Complete, and Verifiable example.

Best regards,

-Jukka Rahkonen-







--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Setting-a-point-into-postgresql-using-GDAL-tp5306720p5306724.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Tue Feb  7 08:49:07 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 07 Feb 2017 17:49:07 +0100
Subject: [gdal-dev] Motion: Adopt RFC 67 Null values in OGR
Message-ID: <39122042.eZVWPG0DuS@even-i700>

Hi,

I move to adopt RFC 67: Null values in OGR

    https://trac.osgeo.org/gdal/wiki/rfc67_nullfieldvalues

Starting with my +1,

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170207/9dddd180/attachment.html>

From even.rouault at spatialys.com  Tue Feb  7 09:40:47 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 07 Feb 2017 18:40:47 +0100
Subject: [gdal-dev] Mosaic question...
In-Reply-To: <CABG0rfuFzvYeHNfxd5iLx877mSbeSP6zCrV_kh=bROA+YP37Mg@mail.gmail.com>
References: <CABG0rfuFzvYeHNfxd5iLx877mSbeSP6zCrV_kh=bROA+YP37Mg@mail.gmail.com>
Message-ID: <1825663.rNxP8EdXW0@even-i700>

On lundi 6 février 2017 22:33:19 CET Jonathan Greenberg wrote:
> GDALers:
> 
> I love the gdalbuildvrt -> gdal_translate trick for large mosaicks, but I
> have a somewhat more complicated problem I was hoping I could get some help
> on.  Given a large set of overlapping images, I want to mosaic using the
> following "rules": 1) all overlapping pixels should be averaged together,
> and

This is not doable with VRT with the current state of the code. I was thinking this 
could perhaps be done with gdalwarp by playing with alpha channels, but I'm not 
completely sure.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170207/331482de/attachment.html>

From mateusz at loskot.net  Tue Feb  7 09:53:38 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue, 7 Feb 2017 18:53:38 +0100
Subject: [gdal-dev] FWD: Visual C++ build bug
Message-ID: <CABUeae_m9z8B6DYWDw___2ZCxUfBWc7uh7cg4aTfnUJagmG2Sw@mail.gmail.com>

On 7 February 2017 at 18:01, MS <maximster at gmail.com> wrote:
> Hi Mateusz,
>
> I made some progress in getting the VS2015 compile correctly under win64. It
> looks like the VS project that is being setup needs to have a lot of fixes.
> While it can build a dll, it was not able to build a debug dll,

Maxim,

First, the generated project is NOT a typical Visual C++ project.
It does not provide any build configuration itself.
It just calls NMAKE and builds whatever is specified in the Makefiles of GDAL.

So, if you do not edit your nmake.opt/nmake.opt.local, then you will
get default Release build.

> and the clean run is also messed up. It catches everything, debug or release.

Yes, because as I explained above, the project does NOT build separately
in Release and Debug subfolders.

Basically, when you hit Build in VS IDE is like you execute
nmake /f makefile.vc command in command line.

Both are equivalent, NO difference.

> I made some changes to kind of let the VS project have both, a debug and
> release dlls, but I can see that there are still some configuration
> problems.

If you expect fully features .vcxproj, you really need to create it
yourself, manually.

> Debug dlls need to have a /MDd instead of /MD command in the OPTFLAGS, but
> for some reason when I put that in, the project fails.

That is default GDAL nmake.opt setting.
You can learn about rationale here
https://trac.osgeo.org/gdal/ticket/540
https://trac.osgeo.org/gdal/ticket/3346
https://trac.osgeo.org/gdal/ticket/4291


> In any case, if you want to see what fixes I put in, take a look here:
> https://bitbucket.org/MaximSter/theconstruct/wiki/ExtDependencies
>
> It is under Windows, #13. Hopefully that will help you figuring out what
> needs to be addressed.

OK, but I'd prefer if you posted it to gdal-dev.
Let's continue further discussion there ('ve CC'ed to gdal-dev).


Best regards,
Mateusz Loskot

From dshean at gmail.com  Tue Feb  7 11:16:05 2017
From: dshean at gmail.com (David Shean)
Date: Tue, 7 Feb 2017 11:16:05 -0800
Subject: [gdal-dev] Mosaic question...
In-Reply-To: <CABG0rfuFzvYeHNfxd5iLx877mSbeSP6zCrV_kh=bROA+YP37Mg@mail.gmail.com>
References: <CABG0rfuFzvYeHNfxd5iLx877mSbeSP6zCrV_kh=bROA+YP37Mg@mail.gmail.com>
Message-ID: <49F44817-F397-4DF1-8BE5-2195B3FEE3AE@gmail.com>

Jonathan,
The dem_mosaic utility in the NASA Ames Stereo Pipeline suite of tools does exactly what you want.  It was developed to efficiently generate large seamless mosaics from 1000s of raster inputs.  The user can select from several options for output mosaic values (weighted average, median, first, last, stddev, count, etc.).  I recommend that you start with the default weighted average option.  Documentation, binaries (Linux and OSX), and source code are available here: https://ti.arc.nasa.gov/tech/asr/intelligent-robotics/ngt/stereo/.  
-David




---
David Shean
Polar Science Center, Applied Physics Lab
Dept. of Earth and Space Sciences
University of Washington
Box 355640
1013 NE 40th St
Seattle, WA 98105
PSC website <http://psc.apl.uw.edu/people/post-docs/david-shean/>

Office: (206) 221-8727
Cell: (301) 801-4558
Fax: (206) 543-6785

> On Feb 6, 2017, at 2:33 PM, Jonathan Greenberg <jgreenberg at unr.edu> wrote:
> 
> GDALers:
> 
> I love the gdalbuildvrt -> gdal_translate trick for large mosaicks, but I have a somewhat more complicated problem I was hoping I could get some help on.  Given a large set of overlapping images, I want to mosaic using the following "rules": 1) all overlapping pixels should be averaged together, and 2) any "nodata" pixels in a given input image should be ignored in that calculation.
> 
> Is this doable in GDAL?  Or am I stuck with just the "top" image in the vrt being the value the output mosaic uses?
> 
> --j
> -- 
> -- 
> Jonathan A. Greenberg, PhD
> Randall Endowed Professor and Associate Professor of Remote Sensing
> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
> Natural Resources & Environmental Science
> University of Nevada, Reno
> 1664 N Virginia St MS/0186
> Reno, NV 89557
> Phone: 415-763-5476
> http://www.unr.edu/nres <http://www.unr.edu/nres>
> AIM: jgrn307, MSN: jgrn307 at hotmail.com <mailto:jgrn307 at hotmail.com>, Gchat: jgrn307, Skype: jgrn3007
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170207/c873d7cd/attachment.html>

From lhomme.xavier at gmail.com  Tue Feb  7 11:31:23 2017
From: lhomme.xavier at gmail.com (xavier lhomme)
Date: Tue, 7 Feb 2017 20:31:23 +0100
Subject: [gdal-dev] Convert multipolygons from OSM
Message-ID: <CACqzBMws_u3kDuwfX5kweSP5KsXAM+7ktE0Yi3++3JnDOOg-tA@mail.gmail.com>

Hi
 I'm trying to extract multipologons from a PBF file  and convert them to a
Fgdb or ashapefile  :

More pricesely , I'm trying to extract waterway on Paris, And I don't
succeed to retreive the Seine river. But only some part.

Here is my cmdline  :

Ogr2ogr -f "FileGDB"   c:\Users\xle\Documents\ArcGIS\idf.gdb -nln waterway
-config OSM_CONFIG_FILE myosmconf.ini -skipfailures -overwrite -gt 65536
-dialect SQLITE  -sql "SELECT GEOMETRY, osm_id, waterway as fclass, name
from multipolygons where waterway is not null " ile-de-france-latest.osm.pbf



waterway has been added to the myosmconf.ini

[multipolygons]

# common attributes

# note: for multipolygons, osm_id=yes instantiates a osm_id field for the
id of relations

# and a osm_way_id field for the id of closed ways. Both fields are
exclusively set.

osm_id=yes

osm_version=no

osm_timestamp=no

osm_uid=no

osm_user=no

osm_changeset=no


# keys to report as OGR fields

attributes=name,type,aeroway,amenity,admin_level,barrier,
boundary,building,craft,geological,historic,land_area,
landuse,leisure,man_made,military,natural,office,place,shop,sport,tourism,
waterway

# keys that should NOT be reported in the "other_tags" field

ignore=area,created_by,converted_by,source,time,ele,
note,openGeoDB:,fixme,FIXME

# uncomment to avoid creation of "other_tags" field

#other_tags=no

# uncomment to create "all_tags" field. "all_tags" and "other_tags" are
exclusive

#all_tags=yes


Is there some other parameter thaht I should take into account ?

Or should I try with OSMOSIS to convert first to a OSM file then with
Ogr2Ogr as I saw on some blogs ?



best regards

xle
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170207/5a3f972a/attachment.html>

From renato.s.sanabria at gmail.com  Tue Feb  7 11:42:30 2017
From: renato.s.sanabria at gmail.com (Renato Souza Sanabria)
Date: Tue, 7 Feb 2017 17:42:30 -0200
Subject: [gdal-dev] Problem when using gdal_translate to create mbtiles
Message-ID: <CAOngjYDLDqLiBtZvNfmKGwsdB=KsyhDDx9Z8a3DXH=5S2VUR1w@mail.gmail.com>

Hi,

I have two similar (but with different resolutions) .tif's that I'm trying
to convert to .mbtiles with gdal_translate. They both have 4 bands (RGBA),
but only one of them is converted correctly (all four bands). In the case
of the other one, the Alpha band is not converted and is removed in the
final file.

Does anybody have any idea of what might be happening? I've tried many
variations of the gdal_translate command and also other tiling scripts like
gdal2tiles.py, gdal2tilesp.py and gdal2tiles_parallel.py , but they don't
meet my needs. I'm using gdal 2.1.0

The metadata of the 2 .tifs, with the metadata of the converted mbtiles is
shown below.

*CORRECTLY CONVERTED*

*Driver: GTiff/GeoTIFF*
Files: 20160103_133809_2430410_RapidEye-1_visual.tif
Size is 5000, 5000
Coordinate System is:
PROJCS["WGS 84 / UTM zone 24S",
    GEOGCS["WGS 84",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.257223563,
                AUTHORITY["EPSG","7030"]],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0,
            AUTHORITY["EPSG","8901"]],
        UNIT["degree",0.0174532925199433,
            AUTHORITY["EPSG","9122"]],
        AUTHORITY["EPSG","4326"]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",-39],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",10000000],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AXIS["Easting",EAST],
    AXIS["Northing",NORTH],
    AUTHORITY["EPSG","32724"]]
Origin = (379500.000000000000000,7936500.000000000000000)
Pixel Size = (5.000000000000000,-5.000000000000000)
Metadata:
  AREA_OR_POINT=Area
  TIFFTAG_DATETIME=2016:01:03 13:38:03
Image Structure Metadata:
  COMPRESSION=LZW
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (  379500.000, 7936500.000) ( 40d 8'33.10"W, 18d39'33.00"S)
Lower Left  (  379500.000, 7911500.000) ( 40d 8'38.58"W, 18d53' 6.25"S)
Upper Right (  404500.000, 7936500.000) ( 39d54'19.85"W, 18d39'37.65"S)
Lower Right (  404500.000, 7911500.000) ( 39d54'24.19"W, 18d53'10.96"S)
Center      (  392000.000, 7924000.000) ( 40d 1'28.93"W, 18d46'22.10"S)
Band 1 Block=512x512 Type=Byte, ColorInterp=Red
  Overviews: 1667x1667, 556x556
  Mask Flags: PER_DATASET ALPHA
  Overviews of mask band: 1667x1667, 556x556
Band 2 Block=512x512 Type=Byte, ColorInterp=Green
  Overviews: 1667x1667, 556x556
  Mask Flags: PER_DATASET ALPHA
  Overviews of mask band: 1667x1667, 556x556
Band 3 Block=512x512 Type=Byte, ColorInterp=Blue
  Overviews: 1667x1667, 556x556
  Mask Flags: PER_DATASET ALPHA
  Overviews of mask band: 1667x1667, 556x556
Band 4 Block=512x512 Type=Byte, ColorInterp=Alpha
  Overviews: 1667x1667, 556x556


---------------------------------------------------------------------------------------------------------

*Driver: MBTiles/MBTiles*
Files: converted.mbtiles
Size is 5558, 5592
Coordinate System is:
PROJCS["WGS 84 / Pseudo-Mercator",
    GEOGCS["WGS 84",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.257223563,
                AUTHORITY["EPSG","7030"]],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0,
            AUTHORITY["EPSG","8901"]],
        UNIT["degree",0.0174532925199433,
            AUTHORITY["EPSG","9122"]],
        AUTHORITY["EPSG","4326"]],
    PROJECTION["Mercator_1SP"],
    PARAMETER["central_meridian",0],
    PARAMETER["scale_factor",1],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AXIS["X",EAST],
    AXIS["Y",NORTH],
    EXTENSION["PROJ4","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0
+lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext
 +no_defs"],
    AUTHORITY["EPSG","3857"]]
Origin = (-4468815.267360419966280,-2114849.003552540671080)
Pixel Size = (4.777314267823516,-4.777314267823516)
Metadata:
  ZOOM_LEVEL=15
  name=converted
  type=overlay
  description=converted
  version=1.1
  format=png

bounds=-40.14405056576531,-18.88638159422762,-39.90552708248893,-18.65916569743923
  minzoom=15
  maxzoom=15
Image Structure Metadata:
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (-4468815.267,-2114849.004) ( 40d 8'38.58"W, 18d39'33.00"S)
Lower Left  (-4468815.267,-2141563.745) ( 40d 8'38.58"W, 18d53'10.97"S)
Upper Right (-4442262.955,-2114849.004) ( 39d54'19.90"W, 18d39'33.00"S)
Lower Right (-4442262.955,-2141563.745) ( 39d54'19.90"W, 18d53'10.97"S)
Center      (-4455539.111,-2128206.374) ( 40d 1'29.24"W, 18d46'22.12"S)
Band 1 Block=256x256 Type=Byte, ColorInterp=Red
  Mask Flags: PER_DATASET ALPHA
Band 2 Block=256x256 Type=Byte, ColorInterp=Green
  Mask Flags: PER_DATASET ALPHA
Band 3 Block=256x256 Type=Byte, ColorInterp=Blue
  Mask Flags: PER_DATASET ALPHA
Band 4 Block=256x256 Type=Byte, ColorInterp=Alpha

=========================================================================

*INCORRECTLY CONVERTED*

*Driver: GTiff/GeoTIFF*
Files: 20170123_094107_0c59_visual.tif
Size is 6629, 5546
Coordinate System is:
PROJCS["WGS 84 / UTM zone 24S",
    GEOGCS["WGS 84",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.257223563,
                AUTHORITY["EPSG","7030"]],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0,
            AUTHORITY["EPSG","8901"]],
        UNIT["degree",0.0174532925199433,
            AUTHORITY["EPSG","9122"]],
        AUTHORITY["EPSG","4326"]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",-39],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",10000000],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AXIS["Easting",EAST],
    AXIS["Northing",NORTH],
    AUTHORITY["EPSG","32724"]]
Origin = (392598.000000000000000,7929114.000000000000000)
Pixel Size = (3.000000000000000,-3.000000000000000)
Metadata:
  AREA_OR_POINT=Area
  TIFFTAG_DATETIME=2017:01:23 09:41:07
Image Structure Metadata:
  COMPRESSION=LZW
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (  392598.000, 7929114.000) ( 40d 1' 7.51"W, 18d43'35.85"S)
Lower Left  (  392598.000, 7912476.000) ( 40d 1'10.77"W, 18d52'37.10"S)
Upper Right (  412485.000, 7929114.000) ( 39d49'48.48"W, 18d43'39.20"S)
Lower Right (  412485.000, 7912476.000) ( 39d49'51.13"W, 18d52'40.48"S)
Center      (  402541.500, 7920795.000) ( 39d55'29.47"W, 18d48' 8.24"S)
Band 1 Block=256x256 Type=Byte, ColorInterp=Red
  Overviews: 2210x1849, 737x617, 246x206
  Mask Flags: PER_DATASET ALPHA
  Overviews of mask band: 2210x1849, 737x617, 246x206
Band 2 Block=256x256 Type=Byte, ColorInterp=Green
  Overviews: 2210x1849, 737x617, 246x206
  Mask Flags: PER_DATASET ALPHA
  Overviews of mask band: 2210x1849, 737x617, 246x206
Band 3 Block=256x256 Type=Byte, ColorInterp=Blue
  Overviews: 2210x1849, 737x617, 246x206
  Mask Flags: PER_DATASET ALPHA
  Overviews of mask band: 2210x1849, 737x617, 246x206
Band 4 Block=256x256 Type=Byte, ColorInterp=Alpha
  Overviews: 2210x1849, 737x617, 246x206

--------------------------------------------------------------------------------------------------------------------
*Driver: MBTiles/MBTiles*
Files: converted.mbtiles
Size is 8832, 7448
Coordinate System is:
PROJCS["WGS 84 / Pseudo-Mercator",
    GEOGCS["WGS 84",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.257223563,
                AUTHORITY["EPSG","7030"]],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0,
            AUTHORITY["EPSG","8901"]],
        UNIT["degree",0.0174532925199433,
            AUTHORITY["EPSG","9122"]],
        AUTHORITY["EPSG","4326"]],
    PROJECTION["Mercator_1SP"],
    PARAMETER["central_meridian",0],
    PARAMETER["scale_factor",1],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AXIS["X",EAST],
    AXIS["Y",NORTH],
    EXTENSION["PROJ4","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0
+lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext
 +no_defs"],
    AUTHORITY["EPSG","3857"]]
Origin = (-4454967.915897197090089,-2122776.586719702463597)
Pixel Size = (2.388657133911758,-2.388657133911758)
Metadata:
  ZOOM_LEVEL=16
  name=converted
  type=overlay
  description=converted
  version=1.1
  format=png

bounds=-40.01965769112543,-18.87791211862349,-39.83014353096918,-18.72662381105138
  minzoom=16
  maxzoom=16
Image Structure Metadata:
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (-4454967.916,-2122776.587) ( 40d 1'10.77"W, 18d43'35.85"S)
Lower Left  (-4454967.916,-2140567.305) ( 40d 1'10.77"W, 18d52'40.48"S)
Upper Right (-4433871.296,-2122776.587) ( 39d49'48.52"W, 18d43'35.85"S)
Lower Right (-4433871.296,-2140567.305) ( 39d49'48.52"W, 18d52'40.48"S)
Center      (-4444419.606,-2131671.946) ( 39d55'29.64"W, 18d48' 8.23"S)
Band 1 Block=256x256 Type=Byte, ColorInterp=Red
Band 2 Block=256x256 Type=Byte, ColorInterp=Green
Band 3 Block=256x256 Type=Byte, ColorInterp=Blue

-- 
Renato Sanabria
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170207/6365ce98/attachment-0001.html>

From jukka.rahkonen at maanmittauslaitos.fi  Tue Feb  7 12:05:07 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Tue, 7 Feb 2017 13:05:07 -0700 (MST)
Subject: [gdal-dev] Convert multipolygons from OSM
In-Reply-To: <CACqzBMws_u3kDuwfX5kweSP5KsXAM+7ktE0Yi3++3JnDOOg-tA@mail.gmail.com>
References: <CACqzBMws_u3kDuwfX5kweSP5KsXAM+7ktE0Yi3++3JnDOOg-tA@mail.gmail.com>
Message-ID: <1486497907759-5306811.post@n6.nabble.com>

lhomme.xavier wrote
> Hi
>  I'm trying to extract multipologons from a PBF file  and convert them to
> a
> Fgdb or ashapefile  :
> 
> More pricesely , I'm trying to extract waterway on Paris, And I don't
> succeed to retreive the Seine river. But only some part.
> 
> Here is my cmdline  :
> 
> Ogr2ogr -f "FileGDB"   c:\Users\xle\Documents\ArcGIS\idf.gdb -nln waterway
> -config OSM_CONFIG_FILE myosmconf.ini -skipfailures -overwrite -gt 65536
> -dialect SQLITE  -sql "SELECT GEOMETRY, osm_id, waterway as fclass, name
> from multipolygons where waterway is not null "
> ile-de-france-latest.osm.pbf

Hi,

Seine in OSM is quite a complicated thing
http://www.openstreetmap.org/relation/962076#map=7/48.515/2.473. For
converting all of it into GIS format you must study how it is constructed
and think how you can collect all the pieces.

-Jukka Rahkonen-




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Convert-multipolygons-from-OSM-tp5306803p5306811.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From lhomme.xavier at gmail.com  Tue Feb  7 13:30:23 2017
From: lhomme.xavier at gmail.com (xavier lhomme)
Date: Tue, 7 Feb 2017 22:30:23 +0100
Subject: [gdal-dev] Convert multipolygons from OSM
In-Reply-To: <1486497907759-5306811.post@n6.nabble.com>
References: <CACqzBMws_u3kDuwfX5kweSP5KsXAM+7ktE0Yi3++3JnDOOg-tA@mail.gmail.com>
 <1486497907759-5306811.post@n6.nabble.com>
Message-ID: <CACqzBMz5EMd5R6vgOu6UYX_dQhe8zOF1sRAQ=WG9-RDSQCEhoA@mail.gmail.com>

Hi
 Thanks.
I just found that I need to add waterway in the closed_ways_are_polygons
option in the osmconf.ini

Le 7 févr. 2017 9:05 PM, "jratike80" <jukka.rahkonen at maanmittauslaitos.fi>
a écrit :

> lhomme.xavier wrote
> > Hi
> >  I'm trying to extract multipologons from a PBF file  and convert them to
> > a
> > Fgdb or ashapefile  :
> >
> > More pricesely , I'm trying to extract waterway on Paris, And I don't
> > succeed to retreive the Seine river. But only some part.
> >
> > Here is my cmdline  :
> >
> > Ogr2ogr -f "FileGDB"   c:\Users\xle\Documents\ArcGIS\idf.gdb -nln
> waterway
> > -config OSM_CONFIG_FILE myosmconf.ini -skipfailures -overwrite -gt 65536
> > -dialect SQLITE  -sql "SELECT GEOMETRY, osm_id, waterway as fclass, name
> > from multipolygons where waterway is not null "
> > ile-de-france-latest.osm.pbf
>
> Hi,
>
> Seine in OSM is quite a complicated thing
> http://www.openstreetmap.org/relation/962076#map=7/48.515/2.473. For
> converting all of it into GIS format you must study how it is constructed
> and think how you can collect all the pieces.
>
> -Jukka Rahkonen-
>
>
>
>
> --
> View this message in context: http://osgeo-org.1560.x6.
> nabble.com/gdal-dev-Convert-multipolygons-from-OSM-tp5306803p5306811.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170207/1fa6174b/attachment.html>

From ari.jolma at gmail.com  Wed Feb  8 00:40:00 2017
From: ari.jolma at gmail.com (Ari Jolma)
Date: Wed, 8 Feb 2017 10:40:00 +0200
Subject: [gdal-dev] Utilities based on GDAL
Message-ID: <d0993197-87b6-54ef-e715-fe50436b445d@gmail.com>

Folks,

For what it's worth I've started a collection of utility programs based 
on GDAL, its Perl bindings and other, mainly Perl tools at

https://github.com/ajolma/GDALToolsWithPerl

The two initial utilities are for computing histograms and the distance 
to a closest destination cell in a given space. The first one uses PDL 
and its histogram function for each block in the input raster and the 
second one uses Dijkstra's algorithm (my written) with the help of Perl 
implementation of priority queue.

Best regards,

Ari

ps: The collection is still missing tests and other essentials but those 
will get there eventually.



From even.rouault at spatialys.com  Wed Feb  8 02:41:15 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 08 Feb 2017 11:41:15 +0100
Subject: [gdal-dev] Problem when using gdal_translate to create mbtiles
In-Reply-To: <CAOngjYDLDqLiBtZvNfmKGwsdB=KsyhDDx9Z8a3DXH=5S2VUR1w@mail.gmail.com>
References: <CAOngjYDLDqLiBtZvNfmKGwsdB=KsyhDDx9Z8a3DXH=5S2VUR1w@mail.gmail.com>
Message-ID: <2045950.389VECP9kM@even-i700>

On mardi 7 février 2017 17:42:30 CET Renato Souza Sanabria wrote:
> Hi,
> 
> I have two similar (but with different resolutions) .tif's that I'm trying
> to convert to .mbtiles with gdal_translate. They both have 4 bands (RGBA),
> but only one of them is converted correctly (all four bands). In the case
> of the other one, the Alpha band is not converted and is removed in the
> final file.

Guessing the number of bands in a MBTiles file is a guess, so sometimes it doesn't work out 
of the box. Or it might be possible that the alpha channel of your dataset is always at 255.

You can try the BAND_COUNT open option:

http://gdal.org/frmt_mbtiles.html

*BAND_COUNT*=AUTO/1/2/3/4: Number of bands of the dataset exposed after opening. 
Some conversions will be done when possible and implemented, but this might fail in some 
cases, depending on the BAND_COUNT value and the number of bands of the tile. Defaults 
to AUTO.


gdalinfo -oo BAND_COUNT=4 foo.mbtiles

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170208/ce95ddc2/attachment.html>

From Ahmed.Tolba at schiebel.net  Wed Feb  8 03:04:39 2017
From: Ahmed.Tolba at schiebel.net (Ahmed Tolba)
Date: Wed, 8 Feb 2017 11:04:39 +0000
Subject: [gdal-dev] Setting Geometry using WFS-T/OGR/GDAL
Message-ID: <b82f36254c5242c885c4e366827cde1d@SRV046.seg.local>

Hi All,

I'm trying to set a Geometry which is a polygon using the following code:

OGRLayer *poLayer;
      poLayer = m_wfs_t->GetLayerByName("tows:poiserver");

      OGRFeature *poFeature;

      poFeature = OGRFeature::CreateFeature( poLayer->GetLayerDefn() );
      poFeature->SetField( "name", "ahmed" );


      OGRLinearRing ring1;
      OGRPolygon poly;

      ring1.addPoint(1116651.439379124, 637392.6969887456);
      ring1.addPoint(1188804.0108498496, 652655.7409537067);
      ring1.addPoint(1226730.3625203592, 634155.0816022386);
      ring1.addPoint(1281307.30760719, 636467.6640211721);
      ring1.closeRings();
      poly.addRing(&ring1);
      poFeature->SetGeometry(&poly);

      if( poLayer->CreateFeature( poFeature ) != OGRERR_NONE ) //  ERROR HERE
      {
            std::cout <<"error creating a feature"<<endl;

      }


But I get Error : Transaction Response. I don't know whether the problem is in my server or a problem in OGR itself.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170208/c89fa0f3/attachment-0001.html>

From vinothrajendranbk at gmail.com  Wed Feb  8 03:09:19 2017
From: vinothrajendranbk at gmail.com (vinothrajendran4)
Date: Wed, 8 Feb 2017 04:09:19 -0700 (MST)
Subject: [gdal-dev] ERROR 6: No translation for Mercator_Auxiliary_Sphere to
 PROJ.4 format is known
Message-ID: <1486552159242-5306930.post@n6.nabble.com>

Hi community,
           I have downloaded shapefile(buildings) from QGIS. I am using
virtual planet builder tool to integrate this shapefile  to my terrain
database. The following error occurs,
  *ERROR 6: No translation for Mercator_Auxiliary_Sphere to PROJ.4 format is
known*

I would like to know if there is any method to convert my shapefile
projection to any known supported PROJ.4 format..

Any help is appreciated...

Regards,
Vinoth R 



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/ERROR-6-No-translation-for-Mercator-Auxiliary-Sphere-to-PROJ-4-format-is-known-tp5306930.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Wed Feb  8 03:21:43 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 08 Feb 2017 12:21:43 +0100
Subject: [gdal-dev] ERROR 6: No translation for
	Mercator_Auxiliary_Sphere to PROJ.4 format is known
In-Reply-To: <1486552159242-5306930.post@n6.nabble.com>
References: <1486552159242-5306930.post@n6.nabble.com>
Message-ID: <12709566.PA2fyJeFpF@even-i700>

On mercredi 8 février 2017 04:09:19 CET vinothrajendran4 wrote:
> Hi community,
>            I have downloaded shapefile(buildings) from QGIS. I am using
> virtual planet builder tool to integrate this shapefile  to my terrain
> database. The following error occurs,
>   *ERROR 6: No translation for Mercator_Auxiliary_Sphere to PROJ.4 format is
> known*
> 
> I would like to know if there is any method to convert my shapefile
> projection to any known supported PROJ.4 format..
> 

Recent GDAL versions (2.1 or later) should be able to dea with Mercator_Auxiliary_Sphere.
So virtual planet builder is likely using an older version.

You could try to do "ogr2ogr -a_srs EPSG:3857 out.shp in.shp" with a GDAL version < 2.1, but 
I'm not completely sure it would be correctly detected as Web Mercator.

Or if virtual planet builder doesn't require EPSG:3857, you could also project to EPSG:4326 
for example : "ogr2ogr -s_srs EPSG:3857 -t_srs EPSG:4326 out.shhp in.shp"

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170208/e2dbf1e6/attachment.html>

From Ahmed.Tolba at schiebel.net  Wed Feb  8 03:41:47 2017
From: Ahmed.Tolba at schiebel.net (Ahmed Tolba)
Date: Wed, 8 Feb 2017 11:41:47 +0000
Subject: [gdal-dev] Setting Geometry using WFS-T/OGR/GDAL
Message-ID: <fbcde44f568a42b4a9cd809f5456e23a@SRV046.seg.local>

I enabled the debugging feature in GDAL.   I get Invalid Geometry in the debug output. In the database I specified the geom field to be a Geometry field.  What else I'm missing.
Please I need help :)

Thanks so much,
Ahmed

From: Ahmed Tolba
Sent: Wednesday, February 08, 2017 12:05 PM
To: gdal-dev at lists.osgeo.org
Subject: Setting Geometry using WFS-T/OGR/GDAL

Hi All,

I'm trying to set a Geometry which is a polygon using the following code:

OGRLayer *poLayer;
      poLayer = m_wfs_t->GetLayerByName("tows:poiserver");

      OGRFeature *poFeature;


      poFeature = OGRFeature::CreateFeature( poLayer->GetLayerDefn() );
      poFeature->SetField( "name", "ahmed" );


      OGRLinearRing ring1;
      OGRPolygon poly;

      ring1.addPoint(1116651.439379124, 637392.6969887456);
      ring1.addPoint(1188804.0108498496, 652655.7409537067);
      ring1.addPoint(1226730.3625203592, 634155.0816022386);
      ring1.addPoint(1281307.30760719, 636467.6640211721);
      ring1.closeRings();
      poly.addRing(&ring1);
      poFeature->SetGeometry(&poly);

      if( poLayer->CreateFeature( poFeature ) != OGRERR_NONE ) //  ERROR HERE
      {
            std::cout <<"error creating a feature"<<endl;

      }


But I get Error : Transaction Response. I don't know whether the problem is in my server or a problem in OGR itself.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170208/385033dc/attachment.html>

From hemantbist at gmail.com  Wed Feb  8 16:01:37 2017
From: hemantbist at gmail.com (Hemant Bist)
Date: Wed, 8 Feb 2017 16:01:37 -0800
Subject: [gdal-dev] Using the tables connection parameter correctly in
 ogr2ogr command for db with large number of tables with geometry columns.
Message-ID: <CAHgSXQm-kPGw6P=22xLEjM-NkMXLuw-X247fSW=sDAy3wJ+ghA@mail.gmail.com>

Hi,
Is it correct to pass dummy tables that don't exist in database to ogr2ogr
 command. It seems to work, but I am not sure it will work going forward(I
am currently using 1.9 most
of the work and 2.0 for some of the new code).
eg. I passed tables=tablename_that_does_not_exis   (a dummy table name that
does not exist) to following command. Note that I did not pass my_osm_data
at all to tables parameter. Is that correct?

ogr2ogr -s_srs EPSG:4326 -t_srs EPSG:4326 -f "ESRI Shapefile" '/tmp/ab.shp'
PG:"dbname=mydbname tables=tablename_that_does_not_exist" -sql " select *
from my_osm_data limit 1"


The reason I need to pass tables parameter is that without this the ogr2ogr
is very slow. The db has large number of tables with geomtery columns and
it seems to effectively query all geometry columns during startup. (And
passing the actual set of  tables used would require me to understand all
the sqls).

Thanks,
Hemant.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170208/55405739/attachment.html>

From michael.smith.erdc at gmail.com  Wed Feb  8 16:36:48 2017
From: michael.smith.erdc at gmail.com (Michael Smith)
Date: Wed, 8 Feb 2017 19:36:48 -0500
Subject: [gdal-dev] Using the tables connection parameter correctly in
	ogr2ogr command for db with large number of tables with
	geometry columns.
In-Reply-To: <CAHgSXQm-kPGw6P=22xLEjM-NkMXLuw-X247fSW=sDAy3wJ+ghA@mail.gmail.com>
References: <CAHgSXQm-kPGw6P=22xLEjM-NkMXLuw-X247fSW=sDAy3wJ+ghA@mail.gmail.com>
Message-ID: <9061D06E-6E12-4E05-B1E6-76F4F2F85BB2@gmail.com>

That's what always use with oracle driver. 

Sent from my iPhone

> On Feb 8, 2017, at 7:01 PM, Hemant Bist <hemantbist at gmail.com> wrote:
> 
> Hi,
> Is it correct to pass dummy tables that don't exist in database to ogr2ogr  command. It seems to work, but I am not sure it will work going forward(I am currently using 1.9 most
> of the work and 2.0 for some of the new code).
> eg. I passed tables=tablename_that_does_not_exis   (a dummy table name that does not exist) to following command. Note that I did not pass my_osm_data at all to tables parameter. Is that correct?
> 
> ogr2ogr -s_srs EPSG:4326 -t_srs EPSG:4326 -f "ESRI Shapefile" '/tmp/ab.shp' PG:"dbname=mydbname tables=tablename_that_does_not_exist" -sql " select * from my_osm_data limit 1"
> 
> 
> The reason I need to pass tables parameter is that without this the ogr2ogr is very slow. The db has large number of tables with geomtery columns and it seems to effectively query all geometry columns during startup. (And passing the actual set of  tables used would require me to understand all the sqls).
> 
> Thanks,
> Hemant.
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From ari.jolma at gmail.com  Thu Feb  9 00:27:44 2017
From: ari.jolma at gmail.com (Ari Jolma)
Date: Thu, 9 Feb 2017 10:27:44 +0200
Subject: [gdal-dev] [Qgis-developer] Processing algs & plugins... should
 we actively pull into master?
In-Reply-To: <ad75ad64-91cf-2116-87a1-a95587cdb6f9@wildintellect.com>
References: <CAB28Asj5L-kyoV-1KGzH0xbgdFw6fojHn0LbSrVbp8NWOXa_yA@mail.gmail.com>
 <dfa887b1-f4d4-ae53-a176-33c56cf521a5@faunalia.it>
 <CAJsc-7zp83TRg_LmV6QKM2d2T7hg9ybePPv3DjvN3DHQp5ffTg@mail.gmail.com>
 <f46c388f-af97-c369-7726-5d0331102ecb@faunalia.it>
 <ad75ad64-91cf-2116-87a1-a95587cdb6f9@wildintellect.com>
Message-ID: <bfdf33f5-7421-3609-0548-b910f37c0587@gmail.com>

Interesting. Let me bring my relative outsider's and newcomer's view 
into this. Although a long time QGIS user, I've never really dug into 
the Processing tools.

I'm working on a project, where one part is a plugin - mostly a 
relatively simple set of dialogs that integrate with other parts of the 
QGIS GUI. In another part of the project I develop datasets - and I've 
written some processing tools for that based on GDAL. I just yesterday 
cleaned two of them up a bit and put them into github and mentioned that 
on gdal-dev (I cc this email to gdal-dev). They're Perl programs that 
use also other Perl modules.

My intent is to release the plugin to my end users through a website - 
the QGIS plugin system allows one to add new library URLs, so I just 
need to write an XML file and put the plugin into a zip and upload that 
to our server to release a new version. I can make that into "make dist" 
or something. I'd like to keep this separate from the official plugin 
repository for separate identity and maybe because the plugin is really 
for this specific purpose without wider interest at least for now.

I just studied the Processing tools because it seems that maybe I could 
also make my processing tools available for my end users (or at least as 
a formal deliverable of our project) that way. There seems to be two 
possible approaches: 1) get the tools into QGIS-Processing or 2) make a 
distribution and ask the end users to install them and use the "Add 
script from file" tool in Processing tools (won't work out of box 
because python extension is hard coded there). The tools I've made are 
pretty generic but I wrote them as pure CLI tools and the other one I 
use for huge rasters so it takes a lot of time why I put them running 
into some cloud computers. Anyway I definitely see a benefit in running 
them from within QGIS and distributing them to end users - and with an 
additional code layer the input and output could be tied to layers in 
QGIS and dialog boxes. The same way as GDAL utilities are now usable 
from QGIS.

The QGIS Processing tools is already now a huge collection of tools. 
Some tools are there and directly usable (GDAL for example since I have 
GDAL in my computer), some tools can be downloaded for use, and some 
tools require that I install more software into my computer (TauDEM for 
example).

I see dangers in that one can easily download code from the web into 
his/her computer and execute it easily. This will be an issue at least 
with IT support of my end users.

I see the benefit of peer control/help/review over add-ons I develop and 
make usable by others in QGIS.

Right now I'm a bit confused and also perhaps awed by the potential of 
the QGIS Processing tools.

Cheers,

Ari


08.02.2017, 18:49, Alex M kirjoitti:
> On 02/06/2017 01:24 AM, Paolo Cavallini wrote:
>> Il 06/02/2017 10:21, Victor Olaya ha scritto:
>>
>>> Just let make sure that we have some clear acceptance criteria (algs
>>> with tests, trying to follow some "best practices" and using
>>> Processing methods when possible, etc).
>> right, what could be the procedure then? whan I see a submitted pluygin
>> that qualifies for this should I warn you (and Nyall) for analysis
>> before suggesting it to the dev?
>> All the best.
>>
> I thought that https://github.com/qgis/QGIS-Processing was intended for
> these kinds of algorithms. It's centralized, but not core, intended for
> pure methods instead of plugins.
>
> Perhaps the confusion is that the Plugins and the Processing add-ons
> have 2 different installers, and it's not obvious that both exist?
>
> This seems like the start down the path, where after addition of tests
> and code review it might then go to core.
>
> Thanks,
> Alex
> _______________________________________________
> Qgis-developer mailing list
> Qgis-developer at lists.osgeo.org
> List info: https://lists.osgeo.org/mailman/listinfo/qgis-developer
> Unsubscribe: https://lists.osgeo.org/mailman/listinfo/qgis-developer


From Ahmed.Tolba at schiebel.net  Thu Feb  9 01:17:15 2017
From: Ahmed.Tolba at schiebel.net (Ahmed Tolba)
Date: Thu, 9 Feb 2017 09:17:15 +0000
Subject: [gdal-dev] Refreshing WFS server using GDAL
Message-ID: <9cf102e70ff648a182fef001edf5b7bc@SRV046.seg.local>

Is there a way to refresh  the data contents from a WFS server using GDAL ?  Or should I do that on my own using a thread for example.  Is it safe to call
      m_wfs_t = OGRSFDriverRegistrar::Open("WFS:http://192.168.139.129/cgi-bin/tinyows.exe",true);  periodcally ? or it should be called once ?

Ahmed

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170209/c0b66a83/attachment.html>

From ivantch at mail.bg  Thu Feb  9 09:37:25 2017
From: ivantch at mail.bg (=?UTF-8?B?0JjQstCw0L0g0KfRg9C60LDQvdGB0LrQuA==?=)
Date: Thu, 9 Feb 2017 19:37:25 +0200
Subject: [gdal-dev] GDAL/OGR .NET - FileGDB driver
Message-ID: <0446DD969FBC4DD3883E4DBC3D1E0025@ETmobile>

Hi All,

Is there a way to get the settings for XYTOLERANCE and  XYSCALE for existing feature in a File GDB using either the FileGDB or the OpenFileGDB driver?

Regards
Ivan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170209/034374ce/attachment.html>

From aron.olsen at sweco.dk  Thu Feb  9 10:07:32 2017
From: aron.olsen at sweco.dk (Olsen Aron)
Date: Thu, 9 Feb 2017 18:07:32 +0000
Subject: [gdal-dev] Page-size of GeoPDF.
Message-ID: <AM3PR07MB05514B857F24A6F6C7FFC719F1450@AM3PR07MB0551.eurprd07.prod.outlook.com>

Hi,

I am sorry, if you experiencing this message again. I am re-sending this message again (bothering many of you with the same problem), but unfortunately I have encountered some registration problems with gdal-dev, and thus, I am not sure, whether my first post got "through",
When looking back on my initial problem/question, is is all about producing a scale-true print of a PDF: In a 1:5000 print, one unit on the paper is to correspond with 5000 units in reality. This is the heart of my problem.
I beg your pardon.
/Aron


Hi there,

I have a problem creating a GeoPDF with a proper page-size, and I want to know how to solve it.


I am producing a GeoPDF from some pre-rendered raster, for which I specify a proper projection window and SRS.



I need to have an A-format sized PDF-created (say A4 portrait: 210 x 297 millimeters).

I want a print-quality of say 200 DPI. Thus, I create the pre-rendered raster as:



Width: 210 / 25.4 * 200  ~ 1653 pixels

Height: 297 / 25.4 * 200  ~ 2339 pixels



When using gdal-translate I specify DPI=200 and a proper projwin and Srs.



When opening the produced PDF with Adobe Acrobat Reader, the PDF is perfectly geocoded, but AAR is not reporting the size of the PDF as one would expect. The actual size reported by AAR is:



22.97 x 32.49 in



but one would expect it to be:



Width: 210 / 25.4 = 8,267.. in

Height: 297 / 25.4 = 11,692.. in



Furthermore, when the PDF is opened with AAR, the zoom-factor of AAR is 59.3%, but I would very much like it to be 100%.

Can I somehow accomplish this using the new WRITE_USERUNITS option, or what?

Thank you!



Regards,

Aron Olsen



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170209/3f749a3c/attachment-0001.html>

From sablok at amazon.com  Thu Feb  9 14:55:45 2017
From: sablok at amazon.com (sablok)
Date: Thu, 9 Feb 2017 15:55:45 -0700 (MST)
Subject: [gdal-dev] How to remedy GDAL_DATA not found?
Message-ID: <1486680945782-5307297.post@n6.nabble.com>

So, here is what I am experiencing as of now :

postgresql# create extension postgis;
postgresql# select postgis_full_version();

the output returned by this command is :
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
POSTGIS="2.3.1 r15264" GEOS="3.5.0-CAPI-1.9.0 r4084" PROJ="Rel. 4.9.2, 08
September 2015" GDAL="GDAL 2.1.2, released 2016/10/24 *GDAL_DATA not found*"
LIBXML="2.9.3" LIBJSON="0.12.1" TOPOLOGY RASTER

where we see that postgis is not able to find the gdal directory which has
all the csv files it needs. So as a workaround I modified the gdal-config
binary which has CONFIG_DATA variable to point to the directory where gdal
is stored and restarted my postgres server after dropping the postgis
extension completely. But I still get the same result.

I don't want to add an environment variable per se, and looking for a way in
which it can be done by just modifying any file that postgis is referring to
while accessing gdal?



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/How-to-remedy-GDAL-DATA-not-found-tp5307297.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From jukka.rahkonen at maanmittauslaitos.fi  Fri Feb 10 00:55:32 2017
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Fri, 10 Feb 2017 08:55:32 +0000
Subject: [gdal-dev] Precision of classification in gdal_sieve.py
Message-ID: <3ee71b72a2c748afbcadda8308a24f39@C119S212VM022.msvyvi.vaha.local>

Hi,

See this gis.stackexchange question about gdal_sieve http://gis.stackexchange.com/questions/227709/why-is-all-0-after-using-gdal-sieve-on-a-raster-layer.
By the documentation http://www.gdal.org/gdal_sieve.html it is not clear with which precision the pixels are classified to have the same value. Is it by integers or does sieve handle also floating point numbers?

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170210/de0f2b86/attachment.html>

From even.rouault at spatialys.com  Fri Feb 10 02:55:34 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 10 Feb 2017 11:55:34 +0100
Subject: [gdal-dev] Motion: Adopt RFC 67 Null values in OGR
In-Reply-To: <39122042.eZVWPG0DuS@even-i700>
References: <39122042.eZVWPG0DuS@even-i700>
Message-ID: <1693445.2SGVQ8f7dm@even-i700>

Hi,

Friendly remainder that this motion is under vote.

Even

> Hi,
> 
> I move to adopt RFC 67: Null values in OGR
> 
>     https://trac.osgeo.org/gdal/wiki/rfc67_nullfieldvalues
> 
> Starting with my +1,
> 
> Best regards,
> 
> Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170210/8363a647/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Fri Feb 10 03:36:34 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Fri, 10 Feb 2017 04:36:34 -0700 (MST)
Subject: [gdal-dev] Motion: Adopt RFC 67 Null values in OGR
In-Reply-To: <39122042.eZVWPG0DuS@even-i700>
References: <39122042.eZVWPG0DuS@even-i700>
Message-ID: <1486726594512-5307396.post@n6.nabble.com>

Even Rouault-2 wrote
> Hi,
> 
> I move to adopt RFC 67: Null values in OGR
> 
>     https://trac.osgeo.org/gdal/wiki/rfc67_nullfieldvalues
> 
> Starting with my +1,
> 
> Best regards,
> 
> Even

+1

-Jukka Rahkonen-



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Motion-Adopt-RFC-67-Null-values-in-OGR-tp5306764p5307396.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From vinothrajendranbk at gmail.com  Fri Feb 10 05:46:53 2017
From: vinothrajendranbk at gmail.com (vinothrajendran4)
Date: Fri, 10 Feb 2017 06:46:53 -0700 (MST)
Subject: [gdal-dev] Can i modify existing coordinates data in GeoTiff using
	GDAL
Message-ID: <1486734413454-5307425.post@n6.nabble.com>

Hi community,

            I have a geotiff data for a region. I would like to change the
corner coordinates manually... Is it posssible using GDAL , if so,  which
API is to be used......

      Is there any other method to accomplish it ???

Any help is appreciated...


Regards,
Vinoth R



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Can-i-modify-existing-coordinates-data-in-GeoTiff-using-GDAL-tp5307425.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From jukka.rahkonen at maanmittauslaitos.fi  Fri Feb 10 05:52:43 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Fri, 10 Feb 2017 06:52:43 -0700 (MST)
Subject: [gdal-dev] Can i modify existing coordinates data in GeoTiff
	using GDAL
In-Reply-To: <1486734413454-5307425.post@n6.nabble.com>
References: <1486734413454-5307425.post@n6.nabble.com>
Message-ID: <1486734763956-5307428.post@n6.nabble.com>

Hi,

Use this tool http://www.gdal.org/gdal_edit.html.

-Jukka Rahkonen-



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Can-i-modify-existing-coordinates-data-in-GeoTiff-using-GDAL-tp5307425p5307428.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From vladimir.sandoval at yandex.com  Fri Feb 10 06:32:34 2017
From: vladimir.sandoval at yandex.com (Vlad)
Date: Fri, 10 Feb 2017 07:32:34 -0700 (MST)
Subject: [gdal-dev] Gdal Java - GetDefaultHistogram causing core dump
Message-ID: <1486737154877-5307438.post@n6.nabble.com>

Trying to get the histogram from a sample NITF.  Running from the command
line, gdalinfo -hist, I get this...

Band 1 Block=512x512 Type=Byte, ColorInterp=Undefined
0ERROR 1: COMRAT=4.50 ARIDPCM is not supported.
Currently only 0.75 is supported.
ERROR 1: U_0001A.NTF, band 1: IReadBlock failed at X offset 0, Y offset 0

In Java code (Gdal 2.1 from Maven against a Windows Gdal installation), this
line...

 int status = band.GetDefaultHistogram(dfMin, dfMax, panHistogram, true);

causes a dump...

#
# A fatal error has been detected by the Java Runtime Environment:
#
#  EXCEPTION_ACCESS_VIOLATION (0xc0000005) at pc=0x0000000078f7c1b0,
pid=2240, tid=3296
#
# JRE version: Java(TM) SE Runtime Environment (8.0_71-b15) (build
1.8.0_71-b15)
# Java VM: Java HotSpot(TM) 64-Bit Server VM (25.71-b15 mixed mode
windows-amd64 compressed oops)
# Problematic frame:
# C  [msvcr100.dll+0x3c1b0]ERROR 1: COMRAT=4.50 ARIDPCM is not supported.
Currently only 0.75 is supported.
ERROR 1: B:\data\raster\NITF\U_0001A.NTF, band 1: IReadBlock failed at X
offset 0, Y offset 0

#
# Failed to write core dump. Minidumps are not enabled by default on client
versions of Windows

With exceptions enabled, I get the same thing without the ERROR string and
no exception is caught.

Culprit file is http://download.osgeo.org/gdal/data/nitf/nitf1.1/U_0001a.ntf 

So, I can't check the status return from GetDefaultHistogram, I can't catch
an exception, and I think ARIDPCM is valid for NITF prior to 2.1, so I can't
really exclude ARIDPCM compression.

Workarounds or bug?




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Gdal-Java-GetDefaultHistogram-causing-core-dump-tp5307438.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From j.leonancarvalho at gmail.com  Fri Feb 10 09:51:59 2017
From: j.leonancarvalho at gmail.com (Leonan Carvalho)
Date: Fri, 10 Feb 2017 15:51:59 -0200
Subject: [gdal-dev] How to install GDAL 2.x on CentOS 7 without being by
	building from source?
Message-ID: <CAEkoqGnBQ_MxZAP+7tpvm_H6OW1+1dqAMjp5sSKLN0psV+mOmQ@mail.gmail.com>

Hi community,

I just posted a question on Geographic Information Systems Stack Exchange
(link bellow)  and got 2 up votes in less than 5 minutes.

I'm using CentOS and it all working fine because a easy installation with
"yum install gdal gdal-python" but this packages are outdated, the provided
version is 1.11 which isn't quite the latest from 1.x major version.
All repositories (that I know) area out-dated. There is no problem to
install from source, even that you need to make it on several servers.

Geographic Information Systems Stack Exchange Question :
http://gis.stackexchange.com/q/227929/63611?sem=2

Do you have any feedback or comment on this?

Please, let me know.
Best Regards.

* José Leonan S. Carvalho*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170210/8712bf36/attachment.html>

From sebastic at xs4all.nl  Fri Feb 10 10:06:37 2017
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Fri, 10 Feb 2017 19:06:37 +0100
Subject: [gdal-dev] How to install GDAL 2.x on CentOS 7 without being by
 building from source?
In-Reply-To: <CAEkoqGnBQ_MxZAP+7tpvm_H6OW1+1dqAMjp5sSKLN0psV+mOmQ@mail.gmail.com>
References: <CAEkoqGnBQ_MxZAP+7tpvm_H6OW1+1dqAMjp5sSKLN0psV+mOmQ@mail.gmail.com>
Message-ID: <73539893-e852-19af-b5e8-0b2cb7e5c916@xs4all.nl>

On 02/10/2017 06:51 PM, Leonan Carvalho wrote:
> I'm using CentOS and it all working fine because a easy installation with
> "yum install gdal gdal-python" but this packages are outdated, the provided
> version is 1.11 which isn't quite the latest from 1.x major version.
> All repositories (that I know) area out-dated. There is no problem to
> install from source, even that you need to make it on several servers.
> 
> Geographic Information Systems Stack Exchange Question :
> http://gis.stackexchange.com/q/227929/63611?sem=2
> 
> Do you have any feedback or comment on this?

The packaging maintained by Fedora was recently updated to 2.1.3, you
can rebuild this (and all reverse dependencies) for CentOS:

 http://pkgs.fedoraproject.org/cgit/rpms/gdal.git

EPEL has GDAL 1.11.4 for CentOS 7 which is only one release behind the
latest 1.11.x.

KInd Regards,

Bas

-- 
 GPG Key ID: 4096R/6750F10AE88D4AF1
Fingerprint: 8182 DE41 7056 408D 6146  50D1 6750 F10A E88D 4AF1

From j.leonancarvalho at gmail.com  Fri Feb 10 10:35:52 2017
From: j.leonancarvalho at gmail.com (Leonan Carvalho)
Date: Fri, 10 Feb 2017 16:35:52 -0200
Subject: [gdal-dev] How to install GDAL 2.x on CentOS 7 without being by
 building from source?
In-Reply-To: <73539893-e852-19af-b5e8-0b2cb7e5c916@xs4all.nl>
References: <CAEkoqGnBQ_MxZAP+7tpvm_H6OW1+1dqAMjp5sSKLN0psV+mOmQ@mail.gmail.com>
 <73539893-e852-19af-b5e8-0b2cb7e5c916@xs4all.nl>
Message-ID: <CAEkoqGkfYx4LEmB282dWeg7+8GkCkn4YPVRarM9a3d0v5Zzzgw@mail.gmail.com>

I would love to contribute to update EPEL version.
The last version was updated 1 year ago
http://pkgs.fedoraproject.org/cgit/rpms/gdal.git/commit/?h=epel7

But I have no idea how to do it.



2017-02-10 16:06 GMT-02:00 Sebastiaan Couwenberg <sebastic at xs4all.nl>:

> On 02/10/2017 06:51 PM, Leonan Carvalho wrote:
> > I'm using CentOS and it all working fine because a easy installation with
> > "yum install gdal gdal-python" but this packages are outdated, the
> provided
> > version is 1.11 which isn't quite the latest from 1.x major version.
> > All repositories (that I know) area out-dated. There is no problem to
> > install from source, even that you need to make it on several servers.
> >
> > Geographic Information Systems Stack Exchange Question :
> > http://gis.stackexchange.com/q/227929/63611?sem=2
> >
> > Do you have any feedback or comment on this?
>
> The packaging maintained by Fedora was recently updated to 2.1.3, you
> can rebuild this (and all reverse dependencies) for CentOS:
>
>  http://pkgs.fedoraproject.org/cgit/rpms/gdal.git
>
> EPEL has GDAL 1.11.4 for CentOS 7 which is only one release behind the
> latest 1.11.x.
>
> KInd Regards,
>
> Bas
>
> --
>  GPG Key ID: 4096R/6750F10AE88D4AF1
> Fingerprint: 8182 DE41 7056 408D 6146  50D1 6750 F10A E88D 4AF1
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170210/6eacb184/attachment.html>

From sebastic at xs4all.nl  Fri Feb 10 10:47:45 2017
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Fri, 10 Feb 2017 19:47:45 +0100
Subject: [gdal-dev] How to install GDAL 2.x on CentOS 7 without being by
 building from source?
In-Reply-To: <CAEkoqGkfYx4LEmB282dWeg7+8GkCkn4YPVRarM9a3d0v5Zzzgw@mail.gmail.com>
References: <CAEkoqGnBQ_MxZAP+7tpvm_H6OW1+1dqAMjp5sSKLN0psV+mOmQ@mail.gmail.com>
 <73539893-e852-19af-b5e8-0b2cb7e5c916@xs4all.nl>
 <CAEkoqGkfYx4LEmB282dWeg7+8GkCkn4YPVRarM9a3d0v5Zzzgw@mail.gmail.com>
Message-ID: <096b0829-3660-f786-1112-24510ee5d9f7@xs4all.nl>

On 02/10/2017 07:35 PM, Leonan Carvalho wrote:
> I would love to contribute to update EPEL version.
> The last version was updated 1 year ago
> http://pkgs.fedoraproject.org/cgit/rpms/gdal.git/commit/?h=epel7
> 
> But I have no idea how to do it.

Follow the instructions linked from:

 https://fedoraproject.org/wiki/EPEL#How_can_I_contribute.3F

Kind Regards,

Bas

-- 
 GPG Key ID: 4096R/6750F10AE88D4AF1
Fingerprint: 8182 DE41 7056 408D 6146  50D1 6750 F10A E88D 4AF1

From howard at hobu.co  Sat Feb 11 08:44:16 2017
From: howard at hobu.co (Howard Butler)
Date: Sat, 11 Feb 2017 10:44:16 -0600
Subject: [gdal-dev] Motion: Adopt RFC 67 Null values in OGR
In-Reply-To: <1486726594512-5307396.post@n6.nabble.com>
References: <39122042.eZVWPG0DuS@even-i700>
 <1486726594512-5307396.post@n6.nabble.com>
Message-ID: <F2743593-AA52-4822-A55B-993AF217846B@hobu.co>


> On Feb 10, 2017, at 5:36 AM, jratike80 <jukka.rahkonen at maanmittauslaitos.fi> wrote:
> 
> Even Rouault-2 wrote
>> Hi,
>> 
>> I move to adopt RFC 67: Null values in OGR
>> 
>>    https://trac.osgeo.org/gdal/wiki/rfc67_nullfieldvalues
>> 
>> Starting with my +1,
>> 
>> Best regards,
>> 
>> Even
> 
> +1
> 
> -Jukka Rahkonen-

+1

Howard

From woodbri at swoodbridge.com  Sat Feb 11 15:18:35 2017
From: woodbri at swoodbridge.com (Stephen Woodbridge)
Date: Sat, 11 Feb 2017 18:18:35 -0500
Subject: [gdal-dev] Problem with black edges to DOQQs using JPEG in Tiff
	compression
Message-ID: <303a5eef-f56d-2c32-cd20-2f33d17614e2@swoodbridge.com>

Hi All,

I need your wisdom. I'm downloading NAIP DOQQs in GTiff format and I 
have a processing chain something like the following:

gdalwarp -t_srs EPSG:4326 -dstalpha -r "bilinear -multi -co TILED=YES 
-dstnodata '0 0 0' srctiff tmpfile

nearblack -nb 15 -q tmpfile

gdal_translate -co TILED=YES -co JPEG_QUALITY=90 -co COMPRESS=JPEG -co 
PHOTOMETRIC=YCBCR -b 1 -b 2 -b 3 -mask auto --config 
GDAL_TIFF_INTERNAL_MASK YES  tmpfile, target

nearblack -nb 5 -q target

gdaladdo -clean -r bilinear  target 2 4 8 16 32 64 128 512

And create a tileindex for mapserver of all the tiffs

If I skip the gdal_translate (ie: JPEG compression) and the 2nd 
nearblack, the doqq tiles are perfect with no nearblack edges between 
the doqq tiles. But when a JPEG compress them, I get edges between the 
doqqs like this:

http://imaptools.com:8080/dl/doqq-issue.jpg

I've never used the JPEG in tiff compression and I'm very impressed by 
the amount of size reduction there and how good the image remains, but I 
have not been able to figure out the magic trick to clearing the edge 
artifacts.

Any help would be appreciated.

Thanks,
   -Steve

---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus


From dmorissette at mapgears.com  Sun Feb 12 05:11:55 2017
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Sun, 12 Feb 2017 08:11:55 -0500
Subject: [gdal-dev] Motion: Adopt RFC 67 Null values in OGR
In-Reply-To: <39122042.eZVWPG0DuS@even-i700>
References: <39122042.eZVWPG0DuS@even-i700>
Message-ID: <98c91a79-17fa-a712-7da1-8a139b46ce3c@mapgears.com>

+1

Daniel

On 2017-02-07 11:49 AM, Even Rouault wrote:
> Hi,
>
>
>
> I move to adopt RFC 67: Null values in OGR
>
>
>
> https://trac.osgeo.org/gdal/wiki/rfc67_nullfieldvalues
>
>
>
> Starting with my +1,
>
>
>
> Best regards,
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
Daniel Morissette
http://www.mapgears.com/
T: +1 418-696-5056 #201

http://evouala.com/ - Location Intelligence Made Easy

From even.rouault at spatialys.com  Sun Feb 12 06:54:29 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 12 Feb 2017 15:54:29 +0100
Subject: [gdal-dev] Problem with black edges to DOQQs using JPEG in Tiff
	compression
In-Reply-To: <303a5eef-f56d-2c32-cd20-2f33d17614e2@swoodbridge.com>
References: <303a5eef-f56d-2c32-cd20-2f33d17614e2@swoodbridge.com>
Message-ID: <19066950.aZ7aa9lkM1@even-i700>

On samedi 11 février 2017 18:18:35 CET Stephen Woodbridge wrote:
> Hi All,
> 
> I need your wisdom. I'm downloading NAIP DOQQs in GTiff format and I
> have a processing chain something like the following:
> 
> gdalwarp -t_srs EPSG:4326 -dstalpha -r "bilinear -multi -co TILED=YES
> -dstnodata '0 0 0' srctiff tmpfile
> 
> nearblack -nb 15 -q tmpfile
> 
> gdal_translate -co TILED=YES -co JPEG_QUALITY=90 -co COMPRESS=JPEG -co
> PHOTOMETRIC=YCBCR -b 1 -b 2 -b 3 -mask auto --config
> GDAL_TIFF_INTERNAL_MASK YES  tmpfile, target
> 
> nearblack -nb 5 -q target
> 
> gdaladdo -clean -r bilinear  target 2 4 8 16 32 64 128 512
> 
> And create a tileindex for mapserver of all the tiffs
> 
> If I skip the gdal_translate (ie: JPEG compression) and the 2nd
> nearblack, the doqq tiles are perfect with no nearblack edges between
> the doqq tiles. But when a JPEG compress them, I get edges between the
> doqqs like this:
> 
> http://imaptools.com:8080/dl/doqq-issue.jpg
> 
> I've never used the JPEG in tiff compression and I'm very impressed by
> the amount of size reduction there and how good the image remains, but I
> have not been able to figure out the magic trick to clearing the edge
> artifacts.

Steve,

I managed to replicate something similar to the above with an image I've at hand.
The cause of the issue is the nearblack invokation after the gdal_translate. The effect of this 
nearblack is to "eat" some pixels at the border of the validity / invalidity transition, but that 
doesn't update the existing mask.
If you add -setmask to this nearblack, that should fix it.
Even better, I think you can just remove this second nearblack.

And you probably must add -setalpha for the first nearblack invokation as well.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170212/0376d06c/attachment.html>

From woodbri at swoodbridge.com  Sun Feb 12 10:46:00 2017
From: woodbri at swoodbridge.com (Stephen Woodbridge)
Date: Sun, 12 Feb 2017 13:46:00 -0500
Subject: [gdal-dev] Problem with black edges to DOQQs using JPEG in Tiff
 compression
In-Reply-To: <19066950.aZ7aa9lkM1@even-i700>
References: <303a5eef-f56d-2c32-cd20-2f33d17614e2@swoodbridge.com>
 <19066950.aZ7aa9lkM1@even-i700>
Message-ID: <8d539c19-2057-4649-f4b6-2444a85f82c4@swoodbridge.com>

On 2/12/2017 9:54 AM, Even Rouault wrote:
> On samedi 11 février 2017 18:18:35 CET Stephen Woodbridge wrote:
>
>> Hi All,
>
>>
>
>> I need your wisdom. I'm downloading NAIP DOQQs in GTiff format and I
>
>> have a processing chain something like the following:
>
>>
>
>> gdalwarp -t_srs EPSG:4326 -dstalpha -r "bilinear -multi -co TILED=YES
>
>> -dstnodata '0 0 0' srctiff tmpfile
>
>>
>
>> nearblack -nb 15 -q tmpfile
>
>>
>
>> gdal_translate -co TILED=YES -co JPEG_QUALITY=90 -co COMPRESS=JPEG -co
>
>> PHOTOMETRIC=YCBCR -b 1 -b 2 -b 3 -mask auto --config
>
>> GDAL_TIFF_INTERNAL_MASK YES tmpfile, target
>
>>
>
>> nearblack -nb 5 -q target
>
>>
>
>> gdaladdo -clean -r bilinear target 2 4 8 16 32 64 128 512
>
>>
>
>> And create a tileindex for mapserver of all the tiffs
>
>>
>
>> If I skip the gdal_translate (ie: JPEG compression) and the 2nd
>
>> nearblack, the doqq tiles are perfect with no nearblack edges between
>
>> the doqq tiles. But when a JPEG compress them, I get edges between the
>
>> doqqs like this:
>
>>
>
>> http://imaptools.com:8080/dl/doqq-issue.jpg
>
>>
>
>> I've never used the JPEG in tiff compression and I'm very impressed by
>
>> the amount of size reduction there and how good the image remains, but I
>
>> have not been able to figure out the magic trick to clearing the edge
>
>> artifacts.
>
>
>
> Steve,
>
>
>
> I managed to replicate something similar to the above with an image I've
> at hand.
>
> The cause of the issue is the nearblack invokation after the
> gdal_translate. The effect of this nearblack is to "eat" some pixels at
> the border of the validity / invalidity transition, but that doesn't
> update the existing mask.
>
> If you add -setmask to this nearblack, that should fix it.
>
> Even better, I think you can just remove this second nearblack.
>
>
>
> And you probably must add -setalpha for the first nearblack invokation
> as well.

Even,

Thanks for the quick feedback. I'll will give these suggestions and try 
today and let you know how it goes.

Thanks,
   -Steve


---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus


From mike at stamen.com  Sun Feb 12 10:52:59 2017
From: mike at stamen.com (Michal Migurski)
Date: Sun, 12 Feb 2017 10:52:59 -0800
Subject: [gdal-dev] "symbol(s) not found for architecture x86_64" when
 compiling GDAL 2.1.0 on Mac OS X
Message-ID: <26A857E5-2E0E-4D11-9DBF-88E12CB62D0B@stamen.com>

Hi,

I’ve recently switched to a new laptop, and I’m attempting to compile GDAL. I have libpng and jpeg in /urs/local via a fresh installation of Homebrew, and I am attempting to follow instructions for minimal drivers. This has worked without incident for me in the past, but I’m running into a problem I’ve not seen before.


What I’m doing:

env CPLUS_INCLUDE_PATH=/usr/local/include LIBRARY_PATH=/usr/local/lib ./configure --prefix=/Users/migurski/Sites/OpenAddresses-Machine/venv3-machine --with-threads --with-ogr --with-geos --without-libtool --with-libz=internal --with-libtiff=internal --with-geotiff=internal --without-gif --without-pg --without-grass --without-libgrass --without-cfitsio --without-pcraster --without-netcdf --without-png --without-jpeg --without-gif --without-ogdi --without-fme --without-hdf4 --without-hdf5 --without-jasper --without-ecw --without-kakadu --without-mrsid --without-jp2mrsid --without-bsb --without-grib --without-mysql --without-ingres --without-xerces --without-expat --without-odbc --without-curl --without-sqlite3 --without-dwgdirect --without-panorama --without-idb --without-sde --without-perl --without-php --without-ruby --without-python --without-ogpython --with-hide-internal-symbols

env CPLUS_INCLUDE_PATH=/usr/local/include LIBRARY_PATH=/usr/local/lib make


What I’m seeing:

ld: symbol(s) not found for architecture x86_64
clang: error: linker command failed with exit code 1 (use -v to see invocation)
make[1]: *** [/Users/migurski/Sites/OpenAddresses-Machine/src/gdal-2.1.0/libgdal.dylib] Error 1
make: *** [check-lib] Error 2

Here’s a complete error output: http://dpaste.com/2RA08CZ


My environment:

Darwin Thinkfluence.local 16.3.0 Darwin Kernel Version 16.3.0: Thu Nov 17 20:23:58 PST 2016; root:xnu-3789.31.2~1/RELEASE_X86_64 x86_64

Configured with: --prefix=/Applications/Xcode.app/Contents/Developer/usr --with-gxx-include-dir=/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.12.sdk/usr/include/c++/4.2.1
Apple LLVM version 8.0.0 (clang-800.0.42.1)
Target: x86_64-apple-darwin16.3.0
Thread model: posix
InstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin


I tried all of this without the *_PATH variables in the environment, but found that the Homebrew libraries in /usr/local were not being found. Now they seem to be wrong, for some reason.

Thanks in advance for any helpful pointers!

-mike.

----------------------------------------------------------------
michal migurski- contact info and pgp key:
sf/ca            http://mike.teczno.com/contact.html





From even.rouault at spatialys.com  Sun Feb 12 11:37:49 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 12 Feb 2017 20:37:49 +0100
Subject: [gdal-dev] "symbol(s) not found for architecture x86_64" when
	compiling GDAL 2.1.0 on Mac OS X
In-Reply-To: <26A857E5-2E0E-4D11-9DBF-88E12CB62D0B@stamen.com>
References: <26A857E5-2E0E-4D11-9DBF-88E12CB62D0B@stamen.com>
Message-ID: <3666370.7XmH4rq6Pv@even-i700>

On dimanche 12 février 2017 10:52:59 CET Michal Migurski wrote:
> Hi,
> 
> I’ve recently switched to a new laptop, and I’m attempting to compile GDAL.
> I have libpng and jpeg in /urs/local via a fresh installation of Homebrew,
> and I am attempting to follow instructions for minimal drivers. This has
> worked without incident for me in the past, but I’m running into a problem
> I’ve not seen before.

Michal,
You need to disable the MRF driver as well since it needs libpng and libjpeg. Unfortunetely I 
just discovered that the intended --without-mrf option didn't work because of a typo. I fixed 
this by a simple patch in https://trac.osgeo.org/gdal/ticket/6811 that you can apply.

Lucian,
wouldn't it make sense to either be able to build MRF without PNG and/or JPEG support, or if 
that doesn't make sense automatically disable MRF when they are not available ?

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170212/235b1f62/attachment-0001.html>

From sebastic at xs4all.nl  Sun Feb 12 11:38:43 2017
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Sun, 12 Feb 2017 20:38:43 +0100
Subject: [gdal-dev] "symbol(s) not found for architecture x86_64" when
 compiling GDAL 2.1.0 on Mac OS X
In-Reply-To: <26A857E5-2E0E-4D11-9DBF-88E12CB62D0B@stamen.com>
References: <26A857E5-2E0E-4D11-9DBF-88E12CB62D0B@stamen.com>
Message-ID: <ceb7c4d6-b51e-5045-2926-7d8b96ce775b@xs4all.nl>

On 02/12/2017 07:52 PM, Michal Migurski wrote:
> --without-png --without-jpeg

Because of that the PNG & JPEG symbols are not found, but they're
required for the MRF driver. Add --without-mrf to disable that too.

Kind Regards,

Bas

-- 
 GPG Key ID: 4096R/6750F10AE88D4AF1
Fingerprint: 8182 DE41 7056 408D 6146  50D1 6750 F10A E88D 4AF1

From even.rouault at spatialys.com  Sun Feb 12 11:45:24 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 12 Feb 2017 20:45:24 +0100
Subject: [gdal-dev] Gdal Java - GetDefaultHistogram causing core dump
In-Reply-To: <1486737154877-5307438.post@n6.nabble.com>
References: <1486737154877-5307438.post@n6.nabble.com>
Message-ID: <1942615.IGVVnDjXBM@even-i700>

On vendredi 10 février 2017 07:32:34 CET Vlad wrote:
> Trying to get the histogram from a sample NITF.  Running from the command
> line, gdalinfo -hist, I get this...
> 
> Band 1 Block=512x512 Type=Byte, ColorInterp=Undefined
> 0ERROR 1: COMRAT=4.50 ARIDPCM is not supported.
> Currently only 0.75 is supported.
> ERROR 1: U_0001A.NTF, band 1: IReadBlock failed at X offset 0, Y offset 0
> 
> In Java code (Gdal 2.1 from Maven against a Windows Gdal installation), this
> line...
> 
>  int status = band.GetDefaultHistogram(dfMin, dfMax, panHistogram, true);
> 
> causes a dump...

Fixed per https://trac.osgeo.org/gdal/ticket/6811

You could workaround the issue by issuing first GetStatistics() and if an error is returned then 
don't call GetDefaultHistogram().

Regarding the 'COMRAT=4.50 ARIDPCM is not supported.' error, this is an implementation 
limitation. I'm curious to know if you need this for real datasets, or if you just tried on the 
NITF test files ?

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170212/917b24c2/attachment.html>

From mike at stamen.com  Sun Feb 12 11:46:39 2017
From: mike at stamen.com (Michal Migurski)
Date: Sun, 12 Feb 2017 11:46:39 -0800
Subject: [gdal-dev] "symbol(s) not found for architecture x86_64" when
 compiling GDAL 2.1.0 on Mac OS X
In-Reply-To: <3666370.7XmH4rq6Pv@even-i700>
References: <26A857E5-2E0E-4D11-9DBF-88E12CB62D0B@stamen.com>
 <3666370.7XmH4rq6Pv@even-i700>
Message-ID: <8A53467F-D73C-458C-92DC-4900BCAE0E74@stamen.com>

Thank you, Even!

This should work for me currently, since I am using this installation of GDAL exclusively for vector work.

If I wanted to compile a version that worked with JPEG and PNG support, am I currently out of luck? I do have the drivers via Homebrew and they have worked for me in the past.

-mike.

> On Feb 12, 2017, at 11:37 AM, Even Rouault <even.rouault at spatialys.com> wrote:
> 
> On dimanche 12 février 2017 10:52:59 CET Michal Migurski wrote:
> > Hi,
> >
> > I’ve recently switched to a new laptop, and I’m attempting to compile GDAL.
> > I have libpng and jpeg in /urs/local via a fresh installation of Homebrew,
> > and I am attempting to follow instructions for minimal drivers. This has
> > worked without incident for me in the past, but I’m running into a problem
> > I’ve not seen before.
>  
> Michal,
> You need to disable the MRF driver as well since it needs libpng and libjpeg. Unfortunetely I just discovered that the intended --without-mrf option didn't work because of a typo. I fixed this by a simple patch in https://trac.osgeo.org/gdal/ticket/6811 that you can apply.
>  
> Lucian,
> wouldn't it make sense to either be able to build MRF without PNG and/or JPEG support, or if that doesn't make sense automatically disable MRF when they are not available ?
>  
> Even
>  
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com

----------------------------------------------------------------
michal migurski- contact info and pgp key:
sf/ca            http://mike.teczno.com/contact.html





From even.rouault at spatialys.com  Sun Feb 12 11:48:02 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 12 Feb 2017 20:48:02 +0100
Subject: [gdal-dev] Precision of classification in gdal_sieve.py
In-Reply-To: <3ee71b72a2c748afbcadda8308a24f39@C119S212VM022.msvyvi.vaha.local>
References: <3ee71b72a2c748afbcadda8308a24f39@C119S212VM022.msvyvi.vaha.local>
Message-ID: <4976992.TmECUVi2hq@even-i700>

On vendredi 10 février 2017 08:55:32 CET Rahkonen Jukka (MML) wrote:
> Hi,
> 
> See this gis.stackexchange question about gdal_sieve
> http://gis.stackexchange.com/questions/227709/why-is-all-0-after-using-gdal
> -sieve-on-a-raster-layer. By the documentation
> http://www.gdal.org/gdal_sieve.html it is not clear with which precision
> the pixels are classified to have the same value. Is it by integers or does
> sieve handle also floating point numbers?

The current implementation reads the dataset as integer data. So floating point values 
are rounded to integers.

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170212/a2ac7992/attachment.html>

From even.rouault at spatialys.com  Sun Feb 12 11:48:58 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 12 Feb 2017 20:48:58 +0100
Subject: [gdal-dev] How to remedy GDAL_DATA not found?
In-Reply-To: <1486680945782-5307297.post@n6.nabble.com>
References: <1486680945782-5307297.post@n6.nabble.com>
Message-ID: <1502906.vmmdDJ60Yz@even-i700>

On jeudi 9 février 2017 15:55:45 CET sablok wrote:
> where we see that postgis is not able to find the gdal directory which has
> all the csv files it needs. So as a workaround I modified the gdal-config
> binary which has CONFIG_DATA variable to point to the directory where gdal
> is stored and restarted my postgres server after dropping the postgis
> extension completely. But I still get the same result.
> 
> I don't want to add an environment variable per se, and looking for a way in
> which it can be done by just modifying any file that postgis is referring
> to while accessing gdal?

--> http://postgis.net/docs/postgis_gdal_datapath.html


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170212/7bc39606/attachment.html>

From even.rouault at spatialys.com  Sun Feb 12 11:53:11 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 12 Feb 2017 20:53:11 +0100
Subject: [gdal-dev] GDAL/OGR .NET - FileGDB driver
In-Reply-To: <0446DD969FBC4DD3883E4DBC3D1E0025@ETmobile>
References: <0446DD969FBC4DD3883E4DBC3D1E0025@ETmobile>
Message-ID: <13521524.cJbxZQYJ4Z@even-i700>

On jeudi 9 février 2017 19:37:25 CET Иван Чукански wrote:
> Hi All,
> 
> Is there a way to get the settings for XYTOLERANCE and  XYSCALE for existing
> feature in a File GDB using either the FileGDB or the OpenFileGDB driver?

Ivan,

For example with

$ ogrinfo -ro ../autotest/ogr/data/curves.gdb -sql "GetLayerDefinition polygon"
INFO: Open of `../autotest/ogr/data/curves.gdb'
      using driver `OpenFileGDB' successful.

Layer name: LayerDefinition
Geometry: Unknown (any)
Feature Count: 1
Layer SRS WKT:
(unknown)
FIELD_1: String (0.0)
OGRFeature(LayerDefinition):0
  FIELD_1 (String) = <DEFeatureClassInfo xsi:type='typens:DEFeatureClassInfo' 
xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xs='http://www.w3.org/
2001/XMLSchema' xmlns:typens='http://www.esri.com/schemas/ArcGIS/
10.1'><CatalogPath>\polygon</CatalogPath><Name>polygon</
Name><ChildrenExpanded>false</ChildrenExpanded><DatasetType>esriDTFeatureClass</
DatasetType><DSID>3</DSID><Versioned>false</Versioned><CanVersion>false</
CanVersion><ConfigurationKeyword></
ConfigurationKeyword><RequiredGeodatabaseClientVersion>10.0</
RequiredGeodatabaseClientVersion><HasOID>true</HasOID><OIDFieldName>OBJECTID</
OIDFieldName><GPFieldInfoExs xsi:type='typens:ArrayOfGPFieldInfoEx'><GPFieldInfoEx 
xsi:type='typens:GPFieldInfoEx'><Name>OBJECTID</Name><AliasName>OBJECTID</
AliasName><FieldType>esriFieldTypeOID</FieldType><IsNullable>false</
IsNullable><DomainFixed>true</DomainFixed><Required>true</
Required><Editable>false</Editable></GPFieldInfoEx><GPFieldInfoEx 
xsi:type='typens:GPFieldInfoEx'><Name>SHAPE</
Name><FieldType>esriFieldTypeGeometry</FieldType><IsNullable>true</
IsNullable><DomainFixed>true</DomainFixed><Required>true</Required></
GPFieldInfoEx><GPFieldInfoEx xsi:type='typens:GPFieldInfoEx'><Name>SHAPE_Length</
Name><FieldType>esriFieldTypeDouble</FieldType><IsNullable>true</
IsNullable><Required>true</Required><Editable>false</Editable></
GPFieldInfoEx><GPFieldInfoEx xsi:type='typens:GPFieldInfoEx'><Name>SHAPE_Area</
Name><FieldType>esriFieldTypeDouble</FieldType><IsNullable>true</
IsNullable><Required>true</Required><Editable>false</Editable></GPFieldInfoEx></
GPFieldInfoExs><CLSID>{52353152-891A-11D0-BEC6-00805F7C4268}</
CLSID><EXTCLSID></EXTCLSID><RelationshipClassNames xsi:type='typens:Names'></
RelationshipClassNames><AliasName></AliasName><ModelName></
ModelName><HasGlobalID>false</HasGlobalID><GlobalIDFieldName></
GlobalIDFieldName><RasterFieldName></RasterFieldName><ExtensionProperties 
xsi:type='typens:PropertySet'><PropertyArray 
xsi:type='typens:ArrayOfPropertySetProperty'></PropertyArray></
ExtensionProperties><ControllerMemberships 
xsi:type='typens:ArrayOfControllerMembership'></
ControllerMemberships><EditorTrackingEnabled>false</
EditorTrackingEnabled><CreatorFieldName></CreatorFieldName><CreatedAtFieldName></
CreatedAtFieldName><EditorFieldName></EditorFieldName><EditedAtFieldName></
EditedAtFieldName><IsTimeInUTC>true</IsTimeInUTC><FeatureType>esriFTSimple</
FeatureType><ShapeType>esriGeometryPolygon</ShapeType><ShapeFieldName>SHAPE</
ShapeFieldName><HasM>false</HasM><HasZ>false</HasZ><HasSpatialIndex>true</
HasSpatialIndex><AreaFieldName>SHAPE_Area</
AreaFieldName><LengthFieldName>SHAPE_Length</LengthFieldName><Extent 
xsi:nil='true'/><SpatialReference 
xsi:type='typens:GeographicCoordinateSystem'><WKT>GEOGCS[&quot;GCS_WGS_1984&quo
t;,DATUM[&quot;D_WGS_1984&quot;,SPHEROID[&quot;WGS_1984&quot;,
6378137.0,298.257223563]],PRIMEM[&quot;Greenwich&quot;,
0.0],UNIT[&quot;Degree&quot;,0.0174532925199433],AUTHORITY[&quot;EPSG&quot;,
4326]]</WKT><XOrigin>-400</XOrigin><YOrigin>-400</
YOrigin><XYScale>999999999.99999988</XYScale><ZOrigin>-100000</
ZOrigin><ZScale>10000</ZScale><MOrigin>-100000</MOrigin><MScale>10000</
MScale><XYTolerance>8.983152841195215e-009</XYTolerance><ZTolerance>0.001</
ZTolerance><MTolerance>0.001</MTolerance><HighPrecision>true</
HighPrecision><LeftLongitude>-180</LeftLongitude><WKID>4326</
WKID><LatestWKID>4326</LatestWKID></SpatialReference><ChangeTracked>false</
ChangeTracked><FieldFilteringEnabled>false</FieldFilteringEnabled><FilteredFieldNames 
xsi:type='typens:Names'></FilteredFieldNames></DEFeatureClassInfo>

This is the "Special SQL requests" documented in 
http://gdal.org/drv_filegdb.html and
http://gdal.org/drv_openfilegdb.html

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170212/a26fcc7b/attachment-0001.html>

From even.rouault at spatialys.com  Sun Feb 12 11:55:52 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 12 Feb 2017 20:55:52 +0100
Subject: [gdal-dev] Page-size of GeoPDF.
In-Reply-To: <AM3PR07MB05514B857F24A6F6C7FFC719F1450@AM3PR07MB0551.eurprd07.prod.outlook.com>
References: <AM3PR07MB05514B857F24A6F6C7FFC719F1450@AM3PR07MB0551.eurprd07.prod.outlook.com>
Message-ID: <2767795.He1lJvmL83@even-i700>

Aron,

> Can I somehow accomplish this using the new WRITE_USERUNITS 
option, or what?

Hopefully yes. As soon as you specify DPI with GDAL trunk, it implies 
WRITE_USERUNITS=NO.

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170212/84330227/attachment.html>

From even.rouault at spatialys.com  Sun Feb 12 11:57:53 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 12 Feb 2017 20:57:53 +0100
Subject: [gdal-dev] "symbol(s) not found for architecture x86_64" when
	compiling GDAL 2.1.0 on Mac OS X
In-Reply-To: <8A53467F-D73C-458C-92DC-4900BCAE0E74@stamen.com>
References: <26A857E5-2E0E-4D11-9DBF-88E12CB62D0B@stamen.com>
 <3666370.7XmH4rq6Pv@even-i700>
 <8A53467F-D73C-458C-92DC-4900BCAE0E74@stamen.com>
Message-ID: <3375708.jpUnJJiEQQ@even-i700>

On dimanche 12 février 2017 11:46:39 CET Michal Migurski wrote:
> Thank you, Even!
> 
> This should work for me currently, since I am using this installation of
> GDAL exclusively for vector work.
> 
> If I wanted to compile a version that worked with JPEG and PNG support, am I
> currently out of luck?

No, this is the nominal setup. That should work. Only explicit --without-jpeg / --without-png is 
rarely tested

> I do have the drivers via Homebrew and they have
> worked for me in the past.

If the external libraries are not found, the internal libraries are used (unless you explicity 
disable them with --without-XXX)

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170212/2799ebc5/attachment.html>

From LPlesea at esri.com  Sun Feb 12 13:06:49 2017
From: LPlesea at esri.com (Lucian Plesea)
Date: Sun, 12 Feb 2017 21:06:49 +0000
Subject: [gdal-dev] "symbol(s) not found for architecture x86_64" when
 compiling GDAL 2.1.0 on Mac OS X
In-Reply-To: <3666370.7XmH4rq6Pv@even-i700>
References: <26A857E5-2E0E-4D11-9DBF-88E12CB62D0B@stamen.com>
 <3666370.7XmH4rq6Pv@even-i700>
Message-ID: <3294deaef8a44fe982f2752106dcf535@RED-INF-MXMB-P4.esri.com>

MRF depends on JPEG, PNG, zlib and TIFF.  Since those are always available as GDAL internal, it doesn’t makes sense to change the code to make it work without some of them.  It would only create seldom used configurations that would have to be tested and maintained.
Turning MRF off if any of the dependencies are missing would be safer and simpler.

Lucian

From: Even Rouault [mailto:even.rouault at spatialys.com]
Sent: Sunday, February 12, 2017 11:38 AM
To: gdal-dev at lists.osgeo.org
Cc: Michal Migurski; Lucian Plesea
Subject: Re: [gdal-dev] "symbol(s) not found for architecture x86_64" when compiling GDAL 2.1.0 on Mac OS X


On dimanche 12 février 2017 10:52:59 CET Michal Migurski wrote:

> Hi,

>

> I’ve recently switched to a new laptop, and I’m attempting to compile GDAL.

> I have libpng and jpeg in /urs/local via a fresh installation of Homebrew,

> and I am attempting to follow instructions for minimal drivers. This has

> worked without incident for me in the past, but I’m running into a problem

> I’ve not seen before.



Michal,

You need to disable the MRF driver as well since it needs libpng and libjpeg. Unfortunetely I just discovered that the intended --without-mrf option didn't work because of a typo. I fixed this by a simple patch in https://urldefense.proofpoint.com/v2/url?u=https-3A__trac.osgeo.org_gdal_ticket_6811&d=DwIGaQ&c=n6-cguzQvX_tUIrZOS_4Og&r=0orhATy81rhG89NwPqBqSPUWjOvyYU8QxFh5_mt-XF8&m=zspmUIO7S_ZVn-9UgO9SW5klMbpNfrJggIKRaHNbkZQ&s=CkAIea7yNc6i_N2r7C8oLBtDRo9vSrZf5jRj712nkwE&e=  that you can apply.



Lucian,

wouldn't it make sense to either be able to build MRF without PNG and/or JPEG support, or if that doesn't make sense automatically disable MRF when they are not available ?



Even



--

Spatialys - Geospatial professional services

https://urldefense.proofpoint.com/v2/url?u=http-3A__www.spatialys.com&d=DwIGaQ&c=n6-cguzQvX_tUIrZOS_4Og&r=0orhATy81rhG89NwPqBqSPUWjOvyYU8QxFh5_mt-XF8&m=zspmUIO7S_ZVn-9UgO9SW5klMbpNfrJggIKRaHNbkZQ&s=UUPmP31kggWeYPfNQQ0G9UNxwlsuht1WvCM7qm6z8Ds&e= 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170212/9624c506/attachment.html>

From rush at winkey.org  Sun Feb 12 13:16:29 2017
From: rush at winkey.org (Brian Case)
Date: Sun, 12 Feb 2017 13:16:29 -0800
Subject: [gdal-dev] Problem with black edges to DOQQs using JPEG in Tiff
 compression
In-Reply-To: <303a5eef-f56d-2c32-cd20-2f33d17614e2@swoodbridge.com>
References: <303a5eef-f56d-2c32-cd20-2f33d17614e2@swoodbridge.com>
Message-ID: <1486934189.13041.6.camel@winkey.org>

Steve,

first, if your data is non lossy you need to nearblack -nb 0 -near 15

however your DOQQ's dont have a collar so there is no reason to
nearblack

gdalwarp -dstalpha will crate an alpha band to mask out the collar after
gdalwarp rotates the image. no nead to nearblack the output of gdal
warp.

when using gdal_translate to create a tiff with a mask band, and you
warped file has a alpha band, gdal_translate -b 1 -b 2 -b 3 -mask 4
this will crate a mask band from the alpha band

brian

On Sat, 2017-02-11 at 18:18 -0500, Stephen Woodbridge wrote:
> Hi All,
> 
> I need your wisdom. I'm downloading NAIP DOQQs in GTiff format and I 
> have a processing chain something like the following:
> 
> gdalwarp -t_srs EPSG:4326 -dstalpha -r "bilinear -multi -co TILED=YES 
> -dstnodata '0 0 0' srctiff tmpfile
> 
> nearblack -nb 15 -q tmpfile
> 
> gdal_translate -co TILED=YES -co JPEG_QUALITY=90 -co COMPRESS=JPEG -co 
> PHOTOMETRIC=YCBCR -b 1 -b 2 -b 3 -mask auto --config 
> GDAL_TIFF_INTERNAL_MASK YES  tmpfile, target
> 
> nearblack -nb 5 -q target
> 
> gdaladdo -clean -r bilinear  target 2 4 8 16 32 64 128 512
> 
> And create a tileindex for mapserver of all the tiffs
> 
> If I skip the gdal_translate (ie: JPEG compression) and the 2nd 
> nearblack, the doqq tiles are perfect with no nearblack edges between 
> the doqq tiles. But when a JPEG compress them, I get edges between the 
> doqqs like this:
> 
> http://imaptools.com:8080/dl/doqq-issue.jpg
> 
> I've never used the JPEG in tiff compression and I'm very impressed by 
> the amount of size reduction there and how good the image remains, but I 
> have not been able to figure out the magic trick to clearing the edge 
> artifacts.
> 
> Any help would be appreciated.
> 
> Thanks,
>    -Steve
> 
> ---
> This email has been checked for viruses by Avast antivirus software.
> https://www.avast.com/antivirus
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev



From rush at winkey.org  Sun Feb 12 14:58:09 2017
From: rush at winkey.org (Brian Case)
Date: Sun, 12 Feb 2017 14:58:09 -0800
Subject: [gdal-dev] Problem with black edges to DOQQs using JPEG in Tiff
 compression
In-Reply-To: <1486934189.13041.6.camel@winkey.org>
References: <303a5eef-f56d-2c32-cd20-2f33d17614e2@swoodbridge.com>
 <1486934189.13041.6.camel@winkey.org>
Message-ID: <1486940289.13041.8.camel@winkey.org>

steve and all

after reading my reply  I noticed a major error

"first, if your data is non lossy you need to nearblack -nb 0 -near 15"



this should read "nearblack -nb 0 -near 0"


Brian



On Sun, 2017-02-12 at 13:16 -0800, Brian Case wrote:
> Steve,
> 
> first, if your data is non lossy you need to nearblack -nb 0 -near 15
> 
> however your DOQQ's dont have a collar so there is no reason to
> nearblack
> 
> gdalwarp -dstalpha will crate an alpha band to mask out the collar after
> gdalwarp rotates the image. no nead to nearblack the output of gdal
> warp.
> 
> when using gdal_translate to create a tiff with a mask band, and you
> warped file has a alpha band, gdal_translate -b 1 -b 2 -b 3 -mask 4
> this will crate a mask band from the alpha band
> 
> brian
> 
> On Sat, 2017-02-11 at 18:18 -0500, Stephen Woodbridge wrote:
> > Hi All,
> > 
> > I need your wisdom. I'm downloading NAIP DOQQs in GTiff format and I 
> > have a processing chain something like the following:
> > 
> > gdalwarp -t_srs EPSG:4326 -dstalpha -r "bilinear -multi -co TILED=YES 
> > -dstnodata '0 0 0' srctiff tmpfile
> > 
> > nearblack -nb 15 -q tmpfile
> > 
> > gdal_translate -co TILED=YES -co JPEG_QUALITY=90 -co COMPRESS=JPEG -co 
> > PHOTOMETRIC=YCBCR -b 1 -b 2 -b 3 -mask auto --config 
> > GDAL_TIFF_INTERNAL_MASK YES  tmpfile, target
> > 
> > nearblack -nb 5 -q target
> > 
> > gdaladdo -clean -r bilinear  target 2 4 8 16 32 64 128 512
> > 
> > And create a tileindex for mapserver of all the tiffs
> > 
> > If I skip the gdal_translate (ie: JPEG compression) and the 2nd 
> > nearblack, the doqq tiles are perfect with no nearblack edges between 
> > the doqq tiles. But when a JPEG compress them, I get edges between the 
> > doqqs like this:
> > 
> > http://imaptools.com:8080/dl/doqq-issue.jpg
> > 
> > I've never used the JPEG in tiff compression and I'm very impressed by 
> > the amount of size reduction there and how good the image remains, but I 
> > have not been able to figure out the magic trick to clearing the edge 
> > artifacts.
> > 
> > Any help would be appreciated.
> > 
> > Thanks,
> >    -Steve
> > 
> > ---
> > This email has been checked for viruses by Avast antivirus software.
> > https://www.avast.com/antivirus
> > 
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev



From jukka.rahkonen at maanmittauslaitos.fi  Mon Feb 13 02:02:36 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Mon, 13 Feb 2017 03:02:36 -0700 (MST)
Subject: [gdal-dev] Problem with black edges to DOQQs using JPEG in Tiff
 compression
In-Reply-To: <8d539c19-2057-4649-f4b6-2444a85f82c4@swoodbridge.com>
References: <303a5eef-f56d-2c32-cd20-2f33d17614e2@swoodbridge.com>
 <19066950.aZ7aa9lkM1@even-i700>
 <8d539c19-2057-4649-f4b6-2444a85f82c4@swoodbridge.com>
Message-ID: <1486980156473-5307662.post@n6.nabble.com>

Stephen Woodbridge wrote
> Even,
> Thanks for the quick feedback. I'll will give these suggestions and try 
> today and let you know how it goes.
> 
> Thanks,
>    -Steve

Hi Steve,

They are probably good suggestions but folks did not bother to think what is
your ultimate target. It is not to improve you commands and hide the black
pixels but simply to make a jpeg-in-tiff compressed mosaic without seams for
Mapserver, perhaps following some other route if it is easier.

So, my suggestion is:

1) Skip gdalwarp
2) Compress your images in native projection 

3) Create jpeg compressed overviews 

4) Create tileindex and utilize the super powerful "Tileindexes with tiles
in different projections" feature
http://www.mapserver.org/optimization/tileindex.html

You did not mention if your DOQQs come in several different projections but
I suppose that they do. Otherwise there is even less point to use gdalwarp,
Mapserver is so fast with on-the-fly re-projecting.

-Jukka Rahkonen-





--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Problem-with-black-edges-to-DOQQs-using-JPEG-in-Tiff-compression-tp5307551p5307662.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Mon Feb 13 02:51:37 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 13 Feb 2017 11:51:37 +0100
Subject: [gdal-dev] Motion: Adopt RFC 67 Null values in OGR
In-Reply-To: <39122042.eZVWPG0DuS@even-i700>
References: <39122042.eZVWPG0DuS@even-i700>
Message-ID: <9597425.vDxStKl49F@even-i700>

Hi,

> 
> I move to adopt RFC 67: Null values in OGR
> 
>     https://trac.osgeo.org/gdal/wiki/rfc67_nullfieldvalues
> 
> Starting with my +1,
> 

I declare this motion passed with +1 from JukkaR, HowardB, DanielM and myself.
I'm going to merge the implementation into trunk.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170213/8cc0a568/attachment-0001.html>

From bontepaarden at gmail.com  Mon Feb 13 04:49:31 2017
From: bontepaarden at gmail.com (Paul Meems)
Date: Mon, 13 Feb 2017 13:49:31 +0100
Subject: [gdal-dev] How to use wrapper_GDALWarpDestName in C#
Message-ID: <CAHNf2YQaFbCymB7EFXB15Q2hGbfvUrif+Pdwsks1NOjM06-geg@mail.gmail.com>

Hi List,

I'm now trying to use GDALWarp with the C# bindings.
I'm using GDAL v2.

Together with a colleague we came up with this snippet:
using (var ds = Gdal.Open(input, Access.GA_ReadOnly))
{
    if (ds == null)
    {
        throw new Exception("Can't open GDAL dataset: " + input);
    }

    var gdalOptions = new GDALWarpAppOptions(options);
    var ptr = new[] { Dataset.getCPtr(ds).Handle };
    var gcHandle = GCHandle.Alloc(ptr, GCHandleType.Pinned);
    try
    {
        var dss = new
SWIGTYPE_p_p_GDALDatasetShadow(gcHandle.AddrOfPinnedObject(), false, null);
        var newDs = Gdal.wrapper_GDALWarpDestName(output, 1, dss,
gdalOptions, null, null);
        if (newDs == null)
        {
            throw new Exception("GdalWarp failed: " +
Gdal.GetLastErrorMsg());
        }
    }
    finally
    {
        if (gcHandle.IsAllocated)
            gcHandle.Free();
    }

    return true;
}

It seems to work, but the SWIGTYPE_p_p_GDALDatasetShadow and gcHandle feel
a bit hacky.
Is this the recommended flow?
And the second parameter is object_list_count. We now put in 1, but what
should this be?

Thanks,

Paul

*Paul Meems *
Release manager, configuration manager
and forum moderator of MapWindow GIS.
www.mapwindow.org

Owner of MapWindow.nl - Support for
Dutch speaking users.
www.mapwindow.nl


*The MapWindow GIS project has moved to GitHub
<https://github.com/MapWindow>!*


Download the latest MapWinGIS mapping engine.
<https://github.com/MapWindow/MapWinGIS/releases>

Download the latest MapWindow 5 open source desktop application.
<https://github.com/MapWindow/MapWindow5/releases>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170213/559bc041/attachment.html>

From even.rouault at spatialys.com  Mon Feb 13 05:05:52 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 13 Feb 2017 14:05:52 +0100
Subject: [gdal-dev] How to use wrapper_GDALWarpDestName in C#
In-Reply-To: <CAHNf2YQaFbCymB7EFXB15Q2hGbfvUrif+Pdwsks1NOjM06-geg@mail.gmail.com>
References: <CAHNf2YQaFbCymB7EFXB15Q2hGbfvUrif+Pdwsks1NOjM06-geg@mail.gmail.com>
Message-ID: <1932638.Chsz1zJGrR@even-i700>

Paul,

This is an issue known as
https://trac.osgeo.org/gdal/ticket/6437

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170213/b0506d9d/attachment.html>

From bontepaarden at gmail.com  Mon Feb 13 05:16:01 2017
From: bontepaarden at gmail.com (Paul Meems)
Date: Mon, 13 Feb 2017 14:16:01 +0100
Subject: [gdal-dev] How to use wrapper_GDALWarpDestName in C#
In-Reply-To: <1932638.Chsz1zJGrR@even-i700>
References: <CAHNf2YQaFbCymB7EFXB15Q2hGbfvUrif+Pdwsks1NOjM06-geg@mail.gmail.com>
 <1932638.Chsz1zJGrR@even-i700>
Message-ID: <CAHNf2YQYG5z9iudLWzPWiYCwA55iZX+ysayFrYRDG7U-0rFCcw@mail.gmail.com>

Thanks Even,

I saw that issue when searching for samples.
I don't understand the status of this issue. I'm a right *just* a typemap
is needed?
Is somebody working on this? Can I help, if so how?

Regards,

Paul

*Paul Meems *
Release manager, configuration manager
and forum moderator of MapWindow GIS.
www.mapwindow.org

Owner of MapWindow.nl - Support for
Dutch speaking users.
www.mapwindow.nl


*The MapWindow GIS project has moved to GitHub
<https://github.com/MapWindow>!*


Download the latest MapWinGIS mapping engine.
<https://github.com/MapWindow/MapWinGIS/releases>

Download the latest MapWindow 5 open source desktop application.
<https://github.com/MapWindow/MapWindow5/releases>

2017-02-13 14:05 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:

> Paul,
>
>
>
> This is an issue known as
>
> https://trac.osgeo.org/gdal/ticket/6437
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170213/777fdfd1/attachment.html>

From even.rouault at spatialys.com  Mon Feb 13 05:23:39 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 13 Feb 2017 14:23:39 +0100
Subject: [gdal-dev] How to use wrapper_GDALWarpDestName in C#
In-Reply-To: <CAHNf2YQYG5z9iudLWzPWiYCwA55iZX+ysayFrYRDG7U-0rFCcw@mail.gmail.com>
References: <CAHNf2YQaFbCymB7EFXB15Q2hGbfvUrif+Pdwsks1NOjM06-geg@mail.gmail.com>
 <1932638.Chsz1zJGrR@even-i700>
 <CAHNf2YQYG5z9iudLWzPWiYCwA55iZX+ysayFrYRDG7U-0rFCcw@mail.gmail.com>
Message-ID: <2847183.ylXU2fg96s@even-i700>

On lundi 13 février 2017 14:16:01 CET Paul Meems wrote:
> Thanks Even,
> 
> I saw that issue when searching for samples.
> I don't understand the status of this issue. I'm a right *just* a typemap
> is needed?

Most likely

> Is somebody working on this?

Apparently not

> Can I help, if so how?

We mostly need a working patch (that doesn't break Python, Java or Perl bindings)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170213/a764788b/attachment.html>

From vladimir.sandoval at yandex.com  Mon Feb 13 05:44:30 2017
From: vladimir.sandoval at yandex.com (Vlad)
Date: Mon, 13 Feb 2017 06:44:30 -0700 (MST)
Subject: [gdal-dev] Gdal Java - GetDefaultHistogram causing core dump
In-Reply-To: <1942615.IGVVnDjXBM@even-i700>
References: <1486737154877-5307438.post@n6.nabble.com>
 <1942615.IGVVnDjXBM@even-i700>
Message-ID: <1486993470074-5307724.post@n6.nabble.com>

Hi Even:
As always thanks for your prompt reply.

I don't "think" we'll ever encounter one of these in our production
datasets, this one was in my test suite, that is how I ran into it.  

Though unlikely on the production system, I can't afford a core dump, so
I'll put in the statistics test in the meantime.

Thanks again.




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Gdal-Java-GetDefaultHistogram-causing-core-dump-tp5307438p5307724.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From augustusfrancis at gmail.com  Mon Feb 13 05:48:23 2017
From: augustusfrancis at gmail.com (Augustus)
Date: Mon, 13 Feb 2017 06:48:23 -0700 (MST)
Subject: [gdal-dev] Calibration updates for Sentinel 1 Driver for GDAL
Message-ID: <1486993703491-5307729.post@n6.nabble.com>

Hi, 

This query is based on extending the feature support mentioned in this
thread https://lists.osgeo.org/pipermail/gdal-dev/2016-May/044419.html

GDAL Sentinel driver doesn’t support calibration as of now. Right now we
have an implementation for sigma calibration with GRD datasets. 
We are using this reference:
https://sentinel.esa.int/documents/247904/685163/S1-Radiometric-Calibration-V1.0.pdf  

We would like to support full calibration capability and here are our idea
on how the architecture would be. Please forward your suggestions on the
same. 
Option 1: 
 Subdataset: Subswath along with polarization and Calibration combinations. 
 Single Band 
 Pros: Flexibility for user to select any combination 
 Cons: Too many subdatasets 

Option 2: (Preferred) 
 Subdataset: Combination of swath and polarisation 
 Bands: Sigma, Beta, Gamma & Uncalibrated Bands 
 Pros: Lesser Subdatasets. Fixed Band Combinations 

Option 3: 
 Subdataset: Each swath 
 Bands: Combination of Calibration and Polarization. 
 Cons: Too many subdatasets, lesser flexibility     

-Augustus 



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Calibration-updates-for-Sentinel-1-Driver-for-GDAL-tp5307729.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From woodbri at swoodbridge.com  Mon Feb 13 07:14:44 2017
From: woodbri at swoodbridge.com (Stephen Woodbridge)
Date: Mon, 13 Feb 2017 10:14:44 -0500
Subject: [gdal-dev] Problem with black edges to DOQQs using JPEG in Tiff
 compression
In-Reply-To: <1486980156473-5307662.post@n6.nabble.com>
References: <303a5eef-f56d-2c32-cd20-2f33d17614e2@swoodbridge.com>
 <19066950.aZ7aa9lkM1@even-i700>
 <8d539c19-2057-4649-f4b6-2444a85f82c4@swoodbridge.com>
 <1486980156473-5307662.post@n6.nabble.com>
Message-ID: <eaf0aac3-9e08-6bee-0218-5dfca2665a0b@swoodbridge.com>

Jukka, Thanks for your suggestion. We have a couple of requirements 
mapserver is only one, the other is some additional processing, but I 
like the simplicity of your suggestion.

Brian C. spend a lot of time on irc with me and I think we finally got 
the processing chain straightened out and it looks like:

# first preclip any collar (probably not needed)
nearblack -co TILED=YES -of GTiff -nb 0 -near 0 -setmask -q -o tmpfile1 
filepath

gdalwarp -t_srs EPSG:4326 -dstalpha -co TILED=YES tmpfile1 tmpfile2

gdal_translate -co TILED=YES -co JPEG_QUALITY=90 -co COMPRESS=JPEG -co 
PHOTOMETRIC=YCBCR -b 1 -b 2 -b 3 -mask 4 --config 
GDAL_TIFF_INTERNAL_MASK YES tmpfile2 target

gdaladdo -clean -r bilinear target 2 4 8 16 32 64 128

This is pretty fast taking about 9-10 sec per doqq to process.

Thank you for all the suggestions and help.

-Steve

On 2/13/2017 5:02 AM, jratike80 wrote:
> Stephen Woodbridge wrote
>> Even,
>> Thanks for the quick feedback. I'll will give these suggestions and try
>> today and let you know how it goes.
>>
>> Thanks,
>>    -Steve
>
> Hi Steve,
>
> They are probably good suggestions but folks did not bother to think what is
> your ultimate target. It is not to improve you commands and hide the black
> pixels but simply to make a jpeg-in-tiff compressed mosaic without seams for
> Mapserver, perhaps following some other route if it is easier.
>
> So, my suggestion is:
>
> 1) Skip gdalwarp
> 2) Compress your images in native projection
>
> 3) Create jpeg compressed overviews
>
> 4) Create tileindex and utilize the super powerful "Tileindexes with tiles
> in different projections" feature
> http://www.mapserver.org/optimization/tileindex.html
>
> You did not mention if your DOQQs come in several different projections but
> I suppose that they do. Otherwise there is even less point to use gdalwarp,
> Mapserver is so fast with on-the-fly re-projecting.
>
> -Jukka Rahkonen-
>
>
>
>
>
> --
> View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Problem-with-black-edges-to-DOQQs-using-JPEG-in-Tiff-compression-tp5307551p5307662.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>


---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus


From adershowitz at exponent.com  Mon Feb 13 13:32:02 2017
From: adershowitz at exponent.com (Adam Dershowitz)
Date: Mon, 13 Feb 2017 21:32:02 +0000
Subject: [gdal-dev] gdalwarp has blank metadata
Message-ID: <430A81EB-E36F-4BC7-8204-E74F8634D924@exponent.com>

I have been using gdalwarp to convert a geotiff to NetCDF format.  The odd thing is that if the result is in feet, I get blank units in my output metadata units.  While if I go to meters, I get the correct units.

So for example this works correctly:


gdalwarp  -t_srs EPSG:3651 -of netCDF cea.tif cea_m.nc

and gdalinof shows data like this:
  x#standard_name=projection_x_coordinate
  x#units=m
  y#long_name=y coordinate of projection
  y#standard_name=projection_y_coordinate
  y#units=m


While this:
gdalwarp  -t_srs EPSG:3652 -of netCDF cea.tif cea_ft.nc

Has this metadata:
  x#standard_name=projection_x_coordinate
  x#units=
  y#long_name=y coordinate of projection
  y#standard_name=projection_y_coordinate
  y#units=

The reason that this is an issue is that I’m trying to view this data with a reader that is crashing due to the empty strings.  I have reported a bug there, and it is being addressed.
But, it does seem like there is also an issue with gdalwarp generating these empty strings for netCDF files.  Shouldn’t these strings contain “feet”?
I did try to use gdal_edit to try to change that, but didn’t have any luck for the netCDF file.

Any suggestions for how to fix these files?  And, how to work around this problem?

Thanks,

-- Adam

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170213/15cb5315/attachment.html>

From mike at stamen.com  Mon Feb 13 14:49:32 2017
From: mike at stamen.com (Michal Migurski)
Date: Mon, 13 Feb 2017 14:49:32 -0800
Subject: [gdal-dev] "symbol(s) not found for architecture x86_64" when
 compiling GDAL 2.1.0 on Mac OS X
In-Reply-To: <3375708.jpUnJJiEQQ@even-i700>
References: <26A857E5-2E0E-4D11-9DBF-88E12CB62D0B@stamen.com>
 <3666370.7XmH4rq6Pv@even-i700>
 <8A53467F-D73C-458C-92DC-4900BCAE0E74@stamen.com>
 <3375708.jpUnJJiEQQ@even-i700>
Message-ID: <9796435A-C719-4810-934E-3DF713AC5EEF@stamen.com>

> On Feb 12, 2017, at 11:57 AM, Even Rouault <even.rouault at spatialys.com> wrote:
> 
> On dimanche 12 février 2017 11:46:39 CET Michal Migurski wrote:
> > Thank you, Even!
> > 
> > This should work for me currently, since I am using this installation of
> > GDAL exclusively for vector work.

I can confirm that this patch did work for me, with the use of Homebrew-provided PNG and JPEG libraries. I also had to provide Xerces-c to get GML working, and used the same *_PATH env vars.


> > If I wanted to compile a version that worked with JPEG and PNG support, am I
> > currently out of luck?
>  
> No, this is the nominal setup. That should work. Only explicit --without-jpeg / --without-png is rarely tested
>  
> > I do have the drivers via Homebrew and they have
> > worked for me in the past.
>  
> If the external libraries are not found, the internal libraries are used (unless you explicity disable them with --without-XXX)

Hm — this hasn’t exactly been my experience. I have found that without external libraries installed and without CPLUS_INCLUDE_PATH and LIBRARY_PATH defined, the compile process complains about missing *.h header files for JPEG and PNG. I have also tried a bare ./configure without any special env vars, and it halts here:

	checking for json_object_set_serializer in -ljson-c... yes
	using pre-installed libjson-c
	configure: error: could not find json-c/json.h


-mike.

----------------------------------------------------------------
michal migurski- contact info and pgp key:
sf/ca            http://mike.teczno.com/contact.html





From even.rouault at spatialys.com  Mon Feb 13 15:04:41 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 14 Feb 2017 00:04:41 +0100
Subject: [gdal-dev] gdalwarp has blank metadata
In-Reply-To: <430A81EB-E36F-4BC7-8204-E74F8634D924@exponent.com>
References: <430A81EB-E36F-4BC7-8204-E74F8634D924@exponent.com>
Message-ID: <3536116.t3ESXaaY0L@even-i700>

On lundi 13 février 2017 21:32:02 CET Adam Dershowitz wrote:
> I have been using gdalwarp to convert a geotiff to NetCDF format.  The odd
> thing is that if the result is in feet, I get blank units in my output
> metadata units.  While if I go to meters, I get the correct units.
 
> So for example this works correctly:
> 
> 
> gdalwarp  -t_srs EPSG:3651 -of netCDF cea.tif cea_m.nc
> 
> and gdalinof shows data like this:
>   x#standard_name=projection_x_coordinate
>   x#units=m
>   y#long_name=y coordinate of projection
>   y#standard_name=projection_y_coordinate
>   y#units=m
> 
> 
> While this:
> gdalwarp  -t_srs EPSG:3652 -of netCDF cea.tif cea_ft.nc
> 
> Has this metadata:
>   x#standard_name=projection_x_coordinate
>   x#units=
>   y#long_name=y coordinate of projection
>   y#standard_name=projection_y_coordinate
>   y#units=
> 
> The reason that this is an issue is that I’m trying to view this data with a
> reader that is crashing due to the empty strings.  I have reported a bug
> there, and it is being addressed.
 But, it does seem like there is also an
> issue with gdalwarp generating these empty strings for netCDF files. 
> Shouldn’t these strings contain “feet”? I did try to use gdal_edit to try
> to change that, but didn’t have any luck for the netCDF file. 
> Any suggestions for how to fix these files?  And, how to work around this
> problem?

Adam, 

The netCDF driver didn't have support for US survey foot unit. I've added it per https://
trac.osgeo.org/gdal/changeset/37378

I used the "US_survey_foot" string accordingly with
http://mooring.ucsd.edu/software/matlab/mfiles/netcdf/udunits.dat , but I'd appreciate 
confirmation from netCDF experts lurking around.

As a workaround you could use ncdump / ncgen to edit the existing file.

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170214/fb8c3e44/attachment.html>

From asmitawankhede at gmail.com  Mon Feb 13 16:08:12 2017
From: asmitawankhede at gmail.com (asmita)
Date: Mon, 13 Feb 2017 17:08:12 -0700 (MST)
Subject: [gdal-dev] GDAL : Access window out of range in RasterIO and blank
 buffer in warp for same block extents
Message-ID: <1487030892573-5307794.post@n6.nabble.com>

I was using the WarpingReader but since it somehow broke the warp part in the
upgrade from GDAL 1.1 to  2.1.2 , I tried to investigate the read with
simple read, however I got this error :
Access window out of range in RasterIO().  Requested
(0,24104) of size 430x450 on raster of 11783x14544.

However the Original problem is the warp operation itself is not outputting
any data in the buffer                                        &rawReadBuf[0]
( so I tried the SimpleWarpReader, but that is not how it suppose to be).

When I call the Warpregiontobuffer , I see the same values, but it does not
error out however it does not even populated the output buffer:
  *** srcExtents.width 430 
  *** srcExtents.height  450 
  *** srcextents.beginX()  0 
  *** srcextents.beginY()  24104

In warpOperation::WarpRegionToBuffer however, I dont see that error ( mainly
I believe because its defaulting to ReadBlock ?)  Anyways, the point is that
how should I proceed with to get successful read of the intermediate file
created from two or more tiffs to create a mosaic?

What Warp to use is the decision made in ImageReader: 

class ImageReader
{
  const ImageInfo &imageInfo;

  xyzDeleteGuard<xyzGDALReader>  reader;
 public:
  explicit ImageReader(const ImageInfo &imageInfo_) : imageInfo(imageInfo_)
  {
    // Refer GDALCreateApproxTransformer documentation in gdal_warp.c
    // The maximum cartesian error in the "output" space that is to be
accepted
    // in the linear approximation.
    // The value 0.125 is as default in xyzGDALWarpingReader.
    const double max_error = 0.125;

    if (imageInfo.srcDS.needReproject()) {
      notify(NFY_NOTICE, "Reprojecting source using %s",
             GDALResampleAlgorithmName(imageInfo.resampleAlg));
      const double* noData = NULL;
      if (imageInfo.rasterType == xyzRasterProduct::Heightmap)
        noData = &imageInfo.noDataValue;
      reader = TransferOwnership(
          new xyzGDALWarpingReader(
              imageInfo.srcDS, imageInfo.resampleAlg,
              imageInfo.numbands, max_error,
              imageInfo.projectionType, noData));
    } else if (imageInfo.srcDS.needSnapUp()) {
      // we snap with the warper, it knows to simplify the
      // reproject logic when it only needs a snapup
      notify(NFY_NOTICE, "Snapping source using %s",
             GDALResampleAlgorithmName(imageInfo.resampleAlg));
      reader = TransferOwnership(
          new xyzGDALWarpingReader(imageInfo.srcDS,
                                  imageInfo.resampleAlg,
                                  imageInfo.numbands,
                                  max_error,
                                  imageInfo.projectionType,
      imageInfo.rasterType == xyzRasterProduct::Heightmap ?
&imageInfo.noDataValue
                                                         : NULL));
    } else {
      // image that exactly matches our projection and pixel size
      // requirements
       reader = TransferOwnership(
          new xyzGDALSimpleReader(imageInfo.srcDS, imageInfo.numbands));
    }
  }

  // Read tile from source.
  // Do all coordinate calculations, filling, warping, palette lookup,
  // datatype conversion, band replication, etc.
  // Will throw exception if unable to complete read
  template <class TileType>
  void ReadTile(uint32 row, uint32 col, TileType &tile);
};


WarpingReader and SimpleReader Implementation:

#include "xyzGDALReader.h"
#include <xyzException.h>


//
****************************************************************************
// ***  xyzGDALReader
//
****************************************************************************
xyzGDALReader::xyzGDALReader(const xyzGDALDataset &srcDS_, uint numbands)
  : srcDS(srcDS_),
    numBands(numbands),
    gdalDatatype(srcDS->GetRasterBand(1)->GetRasterDataType()),
    topToBottom(srcDS.normalizedGeoExtents().topToBottom()),
    paletteSize(0),
    palette(0)
{
  uint gdalRasterCount = srcDS->GetRasterCount();
  if (numBands == 0) {
    throw xyzException
      (xyz::tr("Internal Error: xyzGDALReader has no bands"));
  }
  if (numBands > gdalRasterCount) {
    throw xyzException
      (xyz::tr("Internal Error: xyzGDALReader w/ too many bands"));
  }

  if (!StorageEnumFromGDT(gdalDatatype, storage)) {
    throw xyzException(xyz::tr("Unsupported GDAL datatype '%1'")
                      .arg(GDALGetDataTypeName(gdalDatatype)));
  }
  if (!srcDS.geoExtents().leftToRight()) {
    throw xyzException(xyz::tr("Right to left images not supported"));
  }

  // populate list of gdal bands
  gdalBandIndexes.resize(numBands);
  const uint num_orig_bands = srcDS->GetRasterCount();
  if (numBands == 1 || numBands == num_orig_bands) {
    // In both these cases none of the bands need to be dropped.
    for (uint i = 0; i < numBands; ++i) {
      gdalBandIndexes[i] = i+1;
    }
  } else if (num_orig_bands == 4 && numBands == 3) {  // 4 band images
    // Ignore if only one alpha band or 4th band if none is alpha band
    for (uint i = 0, j = 0, num_alpha = 0; i < num_orig_bands;) {
      ++i;
      if (srcDS->GetRasterBand(i)->GetColorInterpretation() ==
GCI_AlphaBand) {
        if (++num_alpha > 1) {
          throw xyzException(xyz::tr("The image has more than one alpha
band."));
        }
      } else if (j < numBands) {
        gdalBandIndexes[j] = i;
        ++j;
      }
    }
  } else {
    throw xyzException(xyz::tr("Band list has wrong number of bands"));
  }


  // get palette information
  GDALRasterBand *band = srcDS->GetRasterBand(1);
  if (band->GetColorInterpretation() == GCI_PaletteIndex) {
    if (numBands > 1) {
      throw xyzException
        (xyz::tr("Unsupported: palette image with multiple bands"));
    }
    GDALColorTable *ctbl = band->GetColorTable();
    if (!ctbl) {
      throw xyzException(xyz::tr("Unable to get color table"));
    }
    paletteSize = (uint)ctbl->GetColorEntryCount();
    palette = ctbl->GetColorEntry(0);
    if (!paletteSize || !palette) {
      throw xyzException(xyz::tr("Unable to get color table"));
    }
  }
}


//
****************************************************************************
// ***  xyzGDALSimpleReader
//
****************************************************************************
void
xyzGDALSimpleReader::FetchPixels(const xyzExtents<uint32> &srcExtents)
{
  if (srcDS->RasterIO(GF_Read,
                      srcExtents.beginX(), srcExtents.beginY(),
                      srcExtents.width(),  srcExtents.height(),
                      &rawReadBuf[0],
                      srcExtents.width(), srcExtents.height(),
                      gdalDatatype,
                      numBands, &gdalBandIndexes[0],
                      0, 0, 0) != CE_None) {
    throw xyzException(xyz::tr("Failed to read source data"));
  }
}


//
****************************************************************************
// ***  xyzGDALWarpingReader
//
****************************************************************************
TransformArgGuard&
TransformArgGuard::operator=(void *a)
{
  if (arg && (arg != a)) {
    destroyFunc(arg);
  }
  arg = a;
  return *this;
}
TransformArgGuard::~TransformArgGuard(void)
{
  if (arg) {
    destroyFunc(arg);
  }
}


int
SnapTransformFunc( void *pTransformArg, int bDstToSrc, 
                   int nPointCount, 
                   double *padfX, double *padfY, double *padfZ,
                   int *panSuccess )
{
  if (!bDstToSrc) {
    notify(NFY_FATAL, "Internal error: Wrong Snap direction");
  }

  SnapArg *snapArg = (SnapArg*)pTransformArg;
  for (int i = 0; i < nPointCount; ++i) {
    padfX[i] *= snapArg->xScale;
    padfY[i] *= snapArg->yScale;
    panSuccess[i] = 1;
  }
        
  return TRUE;
}

xyzGDALWarpingReader::xyzGDALWarpingReader(const xyzGDALDataset &srcDS,
                                         GDALResampleAlg resampleAlg,
                                         uint numbands,
                                         double transformErrorThreshold,
                                         xyzTilespace::ProjectionType
projType,
                                         const double* noData)
    : xyzGDALReader(srcDS, numbands),
      snapArg(srcDS.geoExtents().geoTransform(),
              srcDS.alignedGeoExtents().geoTransform()),
      genImgProjArg(GDALDestroyGenImgProjTransformer),
      approxArg(GDALDestroyApproxTransformer)
{
  std::string srcSRS(srcDS->GetProjectionRef());
  std::string dstSRS;
  if (projType == xyzTilespace::FLAT_PROJECTION) {
    dstSRS = GetWGS84ProjString();
  } else if (projType == xyzTilespace::MERCATOR_PROJECTION) {
    dstSRS = GetMercatorProjString();
  } else {
    throw xyzException(xyz::tr("Unknown projection type"));
  }

  // ***** Make a dummy output dataset *****
  // We need a dataset in order to get the transformer. The
  // transformer will only use the geoTransform out of the dataset,
  // but you can't pass the geoTransform directly.

  GDALDriverH memDriver = GDALGetDriverByName("MEM");
  if (!memDriver) {
    throw xyzException(xyz::tr("Unable to get GDAL MEM driver"));
  }
  xyzDeleteGuard<GDALDataset>
    dstDS(TransferOwnership(
              (GDALDataset*)
              GDALCreate(memDriver, "unused filename",
                         1 /* numCols */,
                         1 /* numRows */,
                         numBands,
                         gdalDatatype,
                         0 /* unused create options */)));
  if (!dstDS) {
    throw xyzException(xyz::tr("Unable to create MEM dataset"));
  }
  assert(CE_None == dstDS->SetProjection(dstSRS.c_str()));
  dstDS->SetGeoTransform(const_cast<double*>
                         (srcDS.alignedGeoExtents().geoTransform()));
  GDALTransformerFunc transformFunc = 0;
  void* transformArg = 0;
  if (srcDS.needSnapUp()) {
    notify(NFY_NOTICE, "Using snap transform ...");
    transformArg = &snapArg;
    transformFunc = SnapTransformFunc;
  } else if (srcDS.needReproject()) {
    // ***** make a transform w/ the dummy dstDS *****
    genImgProjArg = GDALCreateGenImgProjTransformer
                    (srcDS,                srcSRS.c_str(),
                     (GDALDataset*)dstDS,  dstSRS.c_str(),
                     FALSE,  /* use src GCP if necessary */
                     0.0,    /* GCP error threshold */
                     0       /* maximum order for GCP polynomials */);
    if (!genImgProjArg) {
      throw xyzException(xyz::tr
                        ("Unable to determine reproject transform"));
    }
    transformFunc = GDALGenImgProjTransform;
    transformArg = genImgProjArg;


    // ***** see if an approximate transformation is good enough *****
    if (transformErrorThreshold != 0.0) {
      notify(NFY_NOTICE, "Approximating transform ...");
      approxArg = GDALCreateApproxTransformer(GDALGenImgProjTransform, 
                                              genImgProjArg,
                                              transformErrorThreshold);
      transformFunc = GDALApproxTransform;
      transformArg = approxArg;
    } else {
      notify(NFY_NOTICE, "Using exact transform ...");
    }
  } else {
    throw xyzException
      (xyz::tr
       ("Internal Error: xyzGDALWarpingReader used when not needed"));
  }


  // ***** initialize GDALWarpOptions *****
  // see gdalwarper.h for explaination of options
  GDALWarpOptions *options = GDALCreateWarpOptions();
  xyzCallGuard<GDALWarpOptions*> optionGuard(GDALDestroyWarpOptions,
                                            options);
  options->eResampleAlg = resampleAlg;
  options->eWorkingDataType = gdalDatatype;
  options->hSrcDS = srcDS;
  // pass our dummy, GDALWarpOperation validates that it exists, even
though,
  // we'll never use it by calling, WarpRegionToBuffer */
  options->hDstDS = (GDALDataset*)dstDS;
  options->nBandCount = numBands;
  options->panSrcBands = (int *)CPLMalloc(sizeof(int) * numBands);
  options->panDstBands = (int *)CPLMalloc(sizeof(int) * numBands);
  for (uint i = 0; i < numBands; ++i) {
    options->panSrcBands[i] = gdalBandIndexes[i];
    options->panDstBands[i] = gdalBandIndexes[i];
  }
  options->pfnTransformer = transformFunc;
  options->pTransformerArg = transformArg;

  if (noData != NULL) {
    if (options->padfSrcNoDataReal == NULL) {
      options->padfSrcNoDataReal = (double *)
                    CPLMalloc(sizeof(double) * options->nBandCount);
      options->padfSrcNoDataImag = (double *)
                    CPLMalloc(sizeof(double) * options->nBandCount);
    }
    if (options->padfDstNoDataReal == NULL) {
      options->padfDstNoDataReal = (double *)
                    CPLMalloc(sizeof(double) * options->nBandCount);
      options->padfDstNoDataImag = (double *)
                    CPLMalloc(sizeof(double) * options->nBandCount);
    }
    for (uint i = 0; i < numBands; ++i) {
      options->padfSrcNoDataImag[i] = 0.0;
      options->padfDstNoDataImag[i] = 0.0;
      options->padfSrcNoDataReal[i] = *noData;
      options->padfDstNoDataReal[i] = *noData;
    }
  }

  // ***** finally initialize the GDALWarpOperation object *****
  if (warpOperation.Initialize(options) != CE_None) {
    throw xyzException(xyz::tr("Unable to initialize GDAL warper"));
  }
}


void
xyzGDALWarpingReader::FetchPixels(const xyzExtents<uint32> &srcExtents)
{
 /***  I TRIED CHUNK AS WELL ****/

  if ( warpOperation.ChunkAndWarpImage( srcExtents.beginX(),
                                        srcExtents.beginY(),
                                        GDALGetRasterXSize(dstDS),
                                        GDALGetRasterYSize(dstDS)) !=
CE_None ) {

         throw khException(kh::tr("Failed chunk and warp image"));
   }

  if (warpOperation.WarpRegionToBuffer(srcExtents.beginX(),
                                       srcExtents.beginY(),
                                       srcExtents.width(),
                                       srcExtents.height(),
                                       &rawReadBuf[0],   /*****THIS ONE IS
EMPTY*****/
                                       gdalDatatype) != CE_None) {
    throw xyzException(xyz::tr("Failed to read source data"));
  }
}


RasterBand ReadIO and ReadBlock :

//
****************************************************************************
// ***  xyzVRRasterBand
//
****************************************************************************
xyzVRRasterBand::xyzVRRasterBand(GDALDataset          *dataset,
                               int                   gdalBandNum,
                               const xyzSize<uint32> &rastersize,
                               const xyzSize<uint32> &blocksize,
                               GDALDataType          gdalDatatype,
                               GDALColorInterp       colorInterp_,
                               const xyzTransferGuard<GDALColorTable>
&ctbl_,
                               bool                  haveNoData_,
                               double                noDataValue_) :
    colorInterp(colorInterp_),
    ctbl(ctbl_),
    haveNoData(haveNoData_),
    noDataValue(noDataValue_)
{
  // initialize parts of my base class
  // these really should be args to the base class constructor
  poDS         = dataset;
  nBand        = gdalBandNum;
  nRasterXSize = rastersize.width;
  nRasterYSize = rastersize.height;
  eDataType    = gdalDatatype;
  eAccess      = GA_ReadOnly;
  nBlockXSize  = blocksize.width;
  nBlockYSize  = blocksize.height;
}

CPLErr
xyzVRRasterBand::IRasterIO( GDALRWFlag eRWFlag,
                           int nXOff, int nYOff, int nXSize, int nYSize,
                           void *pData, int nBufXSize, int nBufYSize,
                           GDALDataType eBufType,
                           int nPixelSpace, int nLineSpace
                           //                     GDALRasterIOExtraArg*
psExtraArg
                           ) {
  if( poDS->RasterIO(eRWFlag,
                        nXOff, nYOff, nXSize, nYSize,
                        pData, nBufXSize, nBufYSize,
                        eBufType,
                        1, &nBand,
                        nPixelSpace, nLineSpace,
                        nLineSpace * nBufYSize) != CE_None)  {
   CPLError(CE_Failure, CPLE_AppDefined,
             "Internal Error: RasterIO failed.");
   return CE_Failure;
  }
  return CE_None;
}

CPLErr xyzVRRasterBand::IReadBlock(int nBlockXOff, int nBlockYOff, void
*pImage) {

  int nXOff = nBlockXOff * nBlockXSize,
        nYOff = nBlockYOff * nBlockYSize,
        nXSize = nBlockXSize,
        nYSize = nBlockYSize;

    if( nXOff + nXSize > nRasterXSize )
        nXSize = nRasterXSize - nXOff;
    if( nYOff + nYSize > nRasterYSize )
        nYSize = nRasterYSize - nYOff;

    int nPixelSpace = GDALGetDataTypeSize(eDataType) / 8;
    int nLineSpace = nPixelSpace * nBlockXSize;

    if (IRasterIO(GF_Read,
                   nXOff, nYOff, nXSize, nYSize,
                   pImage, nXSize, nYSize,
                   eDataType,
                   nPixelSpace, nLineSpace) == CE_None){
      notify(NFY_NOTICE,  "Raster IO successful");
      return CE_None;
    }

     CPLError(CE_Failure, CPLE_AppDefined,
             "Internal Error: RasterIO failed in block reading");
     return CE_Failure;

}








--
View this message in context: http://osgeo-org.1560.x6.nabble.com/GDAL-Access-window-out-of-range-in-RasterIO-and-blank-buffer-in-warp-for-same-block-extents-tp5307794.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From adershowitz at exponent.com  Mon Feb 13 17:58:16 2017
From: adershowitz at exponent.com (Adam Dershowitz)
Date: Tue, 14 Feb 2017 01:58:16 +0000
Subject: [gdal-dev] gdalwarp has blank metadata
Message-ID: <011BB2FD7D33AB49936FD297F594AEB8015322222D@SFMB02.exponent.com>

Thanks much for both the fix and the work around. I'll look into ncdump.



--Adam


-----Original Message-----
From: Even Rouault [even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>]
Sent: Monday, February 13, 2017 03:04 PM Pacific Standard Time
To: gdal-dev at lists.osgeo.org
Cc: Adam Dershowitz
Subject: Re: [gdal-dev] gdalwarp has blank metadata


On lundi 13 février 2017 21:32:02 CET Adam Dershowitz wrote:

> I have been using gdalwarp to convert a geotiff to NetCDF format. The odd

> thing is that if the result is in feet, I get blank units in my output

> metadata units. While if I go to meters, I get the correct units.

> So for example this works correctly:

>

>

> gdalwarp -t_srs EPSG:3651 -of netCDF cea.tif cea_m.nc

>

> and gdalinof shows data like this:

> x#standard_name=projection_x_coordinate

> x#units=m

> y#long_name=y coordinate of projection

> y#standard_name=projection_y_coordinate

> y#units=m

>

>

> While this:

> gdalwarp -t_srs EPSG:3652 -of netCDF cea.tif cea_ft.nc

>

> Has this metadata:

> x#standard_name=projection_x_coordinate

> x#units=

> y#long_name=y coordinate of projection

> y#standard_name=projection_y_coordinate

> y#units=

>

> The reason that this is an issue is that I’m trying to view this data with a

> reader that is crashing due to the empty strings. I have reported a bug

> there, and it is being addressed.

But, it does seem like there is also an

> issue with gdalwarp generating these empty strings for netCDF files.

> Shouldn’t these strings contain “feet”? I did try to use gdal_edit to try

> to change that, but didn’t have any luck for the netCDF file.

> Any suggestions for how to fix these files? And, how to work around this

> problem?



Adam,



The netCDF driver didn't have support for US survey foot unit. I've added it per https://trac.osgeo.org/gdal/changeset/37378



I used the "US_survey_foot" string accordingly with

http://mooring.ucsd.edu/software/matlab/mfiles/netcdf/udunits.dat , but I'd appreciate confirmation from netCDF experts lurking around.



As a workaround you could use ncdump / ncgen to edit the existing file.



Even





--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170214/153a130d/attachment.html>

From jason.liu at spookfish.com  Mon Feb 13 20:14:04 2017
From: jason.liu at spookfish.com (jason.liu)
Date: Mon, 13 Feb 2017 21:14:04 -0700 (MST)
Subject: [gdal-dev] GDAL unable to write 4-band RGBA jp2 file with Kakadu 7.8
Message-ID: <1487045644428-5307801.post@n6.nabble.com>

Hi gdal-dev,

I am having trouble using GDAL to write 4-band RGBA jp2 file with Kakadu
7.8. The following minimal code


    GDALAllRegister();

    GDALDataset* srcDataset =
(GDALDataset*)GDALOpen("/home/jason.liu/00000783.tif", GA_ReadOnly);
    char **papszOptions = NULL;
    papszOptions = CSLSetNameValue( papszOptions, "QUALITY", "20" );

    GDALDriver *driver = GetGDALDriverManager()->GetDriverByName("JP2KAK");
    GDALDataset* destDataset =
driver->CreateCopy("/home/jason.liu/00000783.jp2",
                                                  srcDataset,
                                                  FALSE,
                                                  papszOptions,
                                                  NULL,
                                                  NULL);

    if( destDataset != NULL ) {
        GDALClose( (GDALDatasetH) destDataset );
    }
    GDALClose( (GDALDatasetH) srcDataset );
    CSLDestroy(papszOptions);


crashes Kakadu 7.8 with the following message in stderr:

ERROR 1: Error in Kakadu File Format Support:
Attempting to create a Component Mapping (cmap) box, one of whose channels
refers to a non-existent image component or palette lookup table.
terminate called after throwing an instance of
'kdu_cpl_error_message::JP2KAKException'


where /home/jason.liu/00000783.tif is a 4-band 16-bit RGBA tif.


I have also done the following tests and noted the results:

3-band 8-bit RGB tif            OK
3-band 16-bit RGB tif          OK
4-band 8-bit RGBA tif          error as above
4-band 16-bit RGBA tif        error as above


Am I doing anything wrong here? 

By the way, I am quite certain Kakadu 7.8 supports 4-band RGBA as I can use
their example kdu_compress to produce 4-band RGBA jp2 images. So this looks
to be a problem with GDAL, or the way I am invoking it.


Any insights will be greatly appreciated.

Kind Regards
Jason




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/GDAL-unable-to-write-4-band-RGBA-jp2-file-with-Kakadu-7-8-tp5307801.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From schwehr at gmail.com  Mon Feb 13 21:28:54 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Mon, 13 Feb 2017 21:28:54 -0800
Subject: [gdal-dev] GDAL unable to write 4-band RGBA jp2 file with
	Kakadu 7.8
In-Reply-To: <1487045644428-5307801.post@n6.nabble.com>
References: <1487045644428-5307801.post@n6.nabble.com>
Message-ID: <CACmBxyvJQtJNuJxXAo+KoGp4BTpC8aJ+Sjny+86BMtyn+hT9jQ@mail.gmail.com>

Hi Jason,

I've seen the same thing with an alpha channel.  I'm not sure what's up.
Using just RGB was successful.

On 7.3, I'm also seeing problems when using more than the main thread on
linux.

With 7.3, I just noticed today that kdu_get_num_processors() only returns 0
on linux as kdu_arch.cpp is missing #include <unistd.h> so
_SC_NPROCESSORS_ONLN and _SC_NPROCESSORS_CONF are undefined.  When I
enabled _SC_NPROCESSORS_ONLN, I got kdu_get_num_processors() returning 74
on what I thought was a 6 core (aka 12 hyperthread) box.   If I change the
fall through from 0 to 2, I get all sorts of trouble from internal kakadu
assertions and TSAN failures.

So I clearly have more investigating to do.

I've yet to pass along any of what I've found to Taubman and I haven't yet
pushed any of my new tests to github, but I hope to do both soon.

And I've yet to see what, if any, discussion is happening in the yahoo
group.

-kurt

On Mon, Feb 13, 2017 at 8:14 PM, jason.liu <jason.liu at spookfish.com> wrote:

> Hi gdal-dev,
>
> I am having trouble using GDAL to write 4-band RGBA jp2 file with Kakadu
> 7.8. The following minimal code
>
>
>     GDALAllRegister();
>
>     GDALDataset* srcDataset =
> (GDALDataset*)GDALOpen("/home/jason.liu/00000783.tif", GA_ReadOnly);
>     char **papszOptions = NULL;
>     papszOptions = CSLSetNameValue( papszOptions, "QUALITY", "20" );
>
>     GDALDriver *driver = GetGDALDriverManager()->
> GetDriverByName("JP2KAK");
>     GDALDataset* destDataset =
> driver->CreateCopy("/home/jason.liu/00000783.jp2",
>                                                   srcDataset,
>                                                   FALSE,
>                                                   papszOptions,
>                                                   NULL,
>                                                   NULL);
>
>     if( destDataset != NULL ) {
>         GDALClose( (GDALDatasetH) destDataset );
>     }
>     GDALClose( (GDALDatasetH) srcDataset );
>     CSLDestroy(papszOptions);
>
>
> crashes Kakadu 7.8 with the following message in stderr:
>
> ERROR 1: Error in Kakadu File Format Support:
> Attempting to create a Component Mapping (cmap) box, one of whose channels
> refers to a non-existent image component or palette lookup table.
> terminate called after throwing an instance of
> 'kdu_cpl_error_message::JP2KAKException'
>
>
> where /home/jason.liu/00000783.tif is a 4-band 16-bit RGBA tif.
>
>
> I have also done the following tests and noted the results:
>
> 3-band 8-bit RGB tif            OK
> 3-band 16-bit RGB tif          OK
> 4-band 8-bit RGBA tif          error as above
> 4-band 16-bit RGBA tif        error as above
>
>
> Am I doing anything wrong here?
>
> By the way, I am quite certain Kakadu 7.8 supports 4-band RGBA as I can use
> their example kdu_compress to produce 4-band RGBA jp2 images. So this looks
> to be a problem with GDAL, or the way I am invoking it.
>
>
> Any insights will be greatly appreciated.
>
> Kind Regards
> Jason
>
>
>
>
> --
> View this message in context: http://osgeo-org.1560.x6.
> nabble.com/GDAL-unable-to-write-4-band-RGBA-jp2-file-
> with-Kakadu-7-8-tp5307801.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev




-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170213/52d70f45/attachment-0001.html>

From emmanuel.dangelo at pix4d.com  Tue Feb 14 06:48:57 2017
From: emmanuel.dangelo at pix4d.com (Emmanuel d'Angelo)
Date: Tue, 14 Feb 2017 15:48:57 +0100
Subject: [gdal-dev] Best way to package and distribute GDAL data files
Message-ID: <CAADUMQoQ2uO2OKLaE818RPVBZH+2wg-6Pxp3iL30OKMvhLcBpg@mail.gmail.com>

Dear list,

I'm trying to package and distribute an application that relies internally
on GDAL for some raster / vector manipulation.

It may happen in some cases that a user of the application wants to take
her outputs to a different coordinate system (typically from some national
system to WGS84). As far as I can see, some of these transformations rely
on the content of GDAL data files (such as pcs.csv or datum.csv).

I can install these files locally and use the GDAL_DATA environment
variable to find them from my application. However, on the user side,
what's the recommended practice?
Do I need to ensure that my users have a GDAL_DATA variable set too with
the correct data files? I've looked at the build system files, but I
couldn't find a way to set this path relative to my application (which
would let me install these files inside the app package and distribute them
with the application).

Any hint to put me on the right track would be greatly appreciated.

Best regards,

Emmanuel
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170214/2a275ec1/attachment.html>

From ari.jolma at gmail.com  Tue Feb 14 06:52:10 2017
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 14 Feb 2017 16:52:10 +0200
Subject: [gdal-dev] Best way to package and distribute GDAL data files
In-Reply-To: <CAADUMQoQ2uO2OKLaE818RPVBZH+2wg-6Pxp3iL30OKMvhLcBpg@mail.gmail.com>
References: <CAADUMQoQ2uO2OKLaE818RPVBZH+2wg-6Pxp3iL30OKMvhLcBpg@mail.gmail.com>
Message-ID: <b1a5ed16-a450-d915-ef33-f0077dba7a00@gmail.com>

Emmanuel,

I think we need to know the OS you're using.

Ari


14.02.2017, 16:48, Emmanuel d'Angelo kirjoitti:
> Dear list,
>
> I'm trying to package and distribute an application that relies 
> internally on GDAL for some raster / vector manipulation.
>
> It may happen in some cases that a user of the application wants to 
> take her outputs to a different coordinate system (typically from some 
> national system to WGS84). As far as I can see, some of these 
> transformations rely on the content of GDAL data files (such as 
> pcs.csv or datum.csv).
>
> I can install these files locally and use the GDAL_DATA environment 
> variable to find them from my application. However, on the user side, 
> what's the recommended practice?
> Do I need to ensure that my users have a GDAL_DATA variable set too 
> with the correct data files? I've looked at the build system files, 
> but I couldn't find a way to set this path relative to my application 
> (which would let me install these files inside the app package and 
> distribute them with the application).
>
> Any hint to put me on the right track would be greatly appreciated.
>
> Best regards,
>
> Emmanuel
>
>
>
>
> 	
> 	
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170214/8d8ea76e/attachment.html>

From emmanuel.dangelo at pix4d.com  Tue Feb 14 07:12:55 2017
From: emmanuel.dangelo at pix4d.com (Emmanuel d'Angelo)
Date: Tue, 14 Feb 2017 16:12:55 +0100
Subject: [gdal-dev] Best way to package and distribute GDAL data files
In-Reply-To: <b1a5ed16-a450-d915-ef33-f0077dba7a00@gmail.com>
References: <CAADUMQoQ2uO2OKLaE818RPVBZH+2wg-6Pxp3iL30OKMvhLcBpg@mail.gmail.com>
 <b1a5ed16-a450-d915-ef33-f0077dba7a00@gmail.com>
Message-ID: <49EAE458-4826-46F7-AF05-8E2A6CB8D263@pix4d.com>

Thanks Ari for the interest!

Unfortunately, my target is to ship for all 3 major OSes (linux, windows, macOS).
Regarding my build system, everything is glued by cmake. Not sure if it's related, but I build (for now) GDAL as a dynamic lib and PROJ4 as a static one. Any change here is possible if it helps with the issue. 

Emmanuel 

> Le 14 févr. 2017 à 15:52, Ari Jolma <ari.jolma at gmail.com> a écrit :
> 
> Emmanuel,
> 
> I think we need to know the OS you're using.
> 
> Ari
> 
> 14.02.2017, 16:48, Emmanuel d'Angelo kirjoitti:
>> Dear list,
>> 
>> I'm trying to package and distribute an application that relies internally on GDAL for some raster / vector manipulation. 
>> 
>> It may happen in some cases that a user of the application wants to take her outputs to a different coordinate system (typically from some national system to WGS84). As far as I can see, some of these transformations rely on the content of GDAL data files (such as pcs.csv or datum.csv).
>> 
>> I can install these files locally and use the GDAL_DATA environment variable to find them from my application. However, on the user side, what's the recommended practice? 
>> Do I need to ensure that my users have a GDAL_DATA variable set too with the correct data files? I've looked at the build system files, but I couldn't find a way to set this path relative to my application (which would let me install these files inside the app package and distribute them with the application).
>> 
>> Any hint to put me on the right track would be greatly appreciated.
>> 
>> Best regards,
>> 
>> Emmanuel
>> 
>> 
>> 
>> 
>> 
>> 
>> 
>> 
>> 
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170214/25762657/attachment.html>

From ari.jolma at gmail.com  Tue Feb 14 08:22:03 2017
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 14 Feb 2017 18:22:03 +0200
Subject: [gdal-dev] Best way to package and distribute GDAL data files
In-Reply-To: <49EAE458-4826-46F7-AF05-8E2A6CB8D263@pix4d.com>
References: <CAADUMQoQ2uO2OKLaE818RPVBZH+2wg-6Pxp3iL30OKMvhLcBpg@mail.gmail.com>
 <b1a5ed16-a450-d915-ef33-f0077dba7a00@gmail.com>
 <49EAE458-4826-46F7-AF05-8E2A6CB8D263@pix4d.com>
Message-ID: <9e0082d5-69fe-811b-5aca-cef65b07abc9@gmail.com>

Well,

In your code you can manage the location where GDAL looks for the files 
with CPLPushFinderLocation.

In my case I have Perl modules, which depend on the GDAL Perl module. In 
a test scenario for the first module it needs to ask installation of the 
GDAL Perl module, which needs to ask for GDAL itself to be installed. 
Then GDAL is really private to the GDAL Perl module and the GDAL files 
are not easy to find by downstream modules. I manage it so that the GDAL 
Perl module installs the GDAL data files in a shared directory, whose 
name downstream modules can find out by a known method (Perl module 
called File::ShareDir). The module then pushes this to the GDAL finder, 
and so GDAL can find its data files.

This is perhaps one code layer more than in your application but anyway 
you need to arrange it so that the your installer stores the name of the 
GDAL data directory somewhere it can find it in runtime.

Hope this helps,

Ari


14.02.2017, 17:12, Emmanuel d'Angelo kirjoitti:
> Thanks Ari for the interest!
>
> Unfortunately, my target is to ship for all 3 major OSes (linux, 
> windows, macOS).
> Regarding my build system, everything is glued by cmake. Not sure if 
> it's related, but I build (for now) GDAL as a dynamic lib and PROJ4 as 
> a static one. Any change here is possible if it helps with the issue.
>
> Emmanuel
>
> Le 14 févr. 2017 à 15:52, Ari Jolma <ari.jolma at gmail.com 
> <mailto:ari.jolma at gmail.com>> a écrit :
>
>> Emmanuel,
>>
>> I think we need to know the OS you're using.
>>
>> Ari
>>
>>
>> 14.02.2017, 16:48, Emmanuel d'Angelo kirjoitti:
>>> Dear list,
>>>
>>> I'm trying to package and distribute an application that relies 
>>> internally on GDAL for some raster / vector manipulation.
>>>
>>> It may happen in some cases that a user of the application wants to 
>>> take her outputs to a different coordinate system (typically from 
>>> some national system to WGS84). As far as I can see, some of these 
>>> transformations rely on the content of GDAL data files (such as 
>>> pcs.csv or datum.csv).
>>>
>>> I can install these files locally and use the GDAL_DATA environment 
>>> variable to find them from my application. However, on the user 
>>> side, what's the recommended practice?
>>> Do I need to ensure that my users have a GDAL_DATA variable set too 
>>> with the correct data files? I've looked at the build system files, 
>>> but I couldn't find a way to set this path relative to my 
>>> application (which would let me install these files inside the app 
>>> package and distribute them with the application).
>>>
>>> Any hint to put me on the right track would be greatly appreciated.
>>>
>>> Best regards,
>>>
>>> Emmanuel
>>>
>>>
>>>
>>>
>>> 	
>>> 	
>>>
>>>
>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170214/3bedf897/attachment-0001.html>

From emmanuel.dangelo at pix4d.com  Tue Feb 14 12:29:08 2017
From: emmanuel.dangelo at pix4d.com (Emmanuel d'Angelo)
Date: Tue, 14 Feb 2017 21:29:08 +0100
Subject: [gdal-dev] Best way to package and distribute GDAL data files
In-Reply-To: <9e0082d5-69fe-811b-5aca-cef65b07abc9@gmail.com>
References: <CAADUMQoQ2uO2OKLaE818RPVBZH+2wg-6Pxp3iL30OKMvhLcBpg@mail.gmail.com>
 <b1a5ed16-a450-d915-ef33-f0077dba7a00@gmail.com>
 <49EAE458-4826-46F7-AF05-8E2A6CB8D263@pix4d.com>
 <9e0082d5-69fe-811b-5aca-cef65b07abc9@gmail.com>
Message-ID: <26FE663C-ACBA-4715-AAF5-D59EB03179AE@pix4d.com>

Ah, thanks a lot! 

I hadn't found this CPLPushFinderLocation function. I could then install the required files in an app-dependant location (so that I don't interfere with user's files if already installed) and set the path during the app initialization. 

I will give it a try and let you know the outcome. 

Thank you!

Emmanuel 
> Le 14 févr. 2017 à 17:22, Ari Jolma <ari.jolma at gmail.com> a écrit :
> 
> Well,
> 
> In your code you can manage the location where GDAL looks for the files with CPLPushFinderLocation.
> 
> In my case I have Perl modules, which depend on the GDAL Perl module. In a test scenario for the first module it needs to ask installation of the GDAL Perl module, which needs to ask for GDAL itself to be installed. Then GDAL is really private to the GDAL Perl module and the GDAL files are not easy to find by downstream modules. I manage it so that the GDAL Perl module installs the GDAL data files in a shared directory, whose name downstream modules can find out by a known method (Perl module called File::ShareDir). The module then pushes this to the GDAL finder, and so GDAL can find its data files.
> 
> This is perhaps one code layer more than in your application but anyway you need to arrange it so that the your installer stores the name of the GDAL data directory somewhere it can find it in runtime.
> 
> Hope this helps,
> Ari
> 
> 14.02.2017, 17:12, Emmanuel d'Angelo kirjoitti:
>> Thanks Ari for the interest!
>> 
>> Unfortunately, my target is to ship for all 3 major OSes (linux, windows, macOS).
>> Regarding my build system, everything is glued by cmake. Not sure if it's related, but I build (for now) GDAL as a dynamic lib and PROJ4 as a static one. Any change here is possible if it helps with the issue. 
>> 
>> Emmanuel 
>> 
>> Le 14 févr. 2017 à 15:52, Ari Jolma <ari.jolma at gmail.com> a écrit :
>> 
>>> Emmanuel,
>>> 
>>> I think we need to know the OS you're using.
>>> 
>>> Ari
>>> 
>>> 14.02.2017, 16:48, Emmanuel d'Angelo kirjoitti:
>>>> Dear list,
>>>> 
>>>> I'm trying to package and distribute an application that relies internally on GDAL for some raster / vector manipulation. 
>>>> 
>>>> It may happen in some cases that a user of the application wants to take her outputs to a different coordinate system (typically from some national system to WGS84). As far as I can see, some of these transformations rely on the content of GDAL data files (such as pcs.csv or datum.csv).
>>>> 
>>>> I can install these files locally and use the GDAL_DATA environment variable to find them from my application. However, on the user side, what's the recommended practice? 
>>>> Do I need to ensure that my users have a GDAL_DATA variable set too with the correct data files? I've looked at the build system files, but I couldn't find a way to set this path relative to my application (which would let me install these files inside the app package and distribute them with the application).
>>>> 
>>>> Any hint to put me on the right track would be greatly appreciated.
>>>> 
>>>> Best regards,
>>>> 
>>>> Emmanuel
>>>> 
>>>> 
>>>> 
>>>> 
>>>> 
>>>> 
>>>> 
>>>> 
>>>> 
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev at lists.osgeo.org
>>>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>> 
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170214/1a5b7dff/attachment.html>

From even.rouault at spatialys.com  Tue Feb 14 13:12:07 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 14 Feb 2017 22:12:07 +0100
Subject: [gdal-dev] Page-size of GeoPDF.
In-Reply-To: <AM3PR07MB0551C2D33EB5A6ED536E7E29F1580@AM3PR07MB0551.eurprd07.prod.outlook.com>
References: <AM3PR07MB05514B857F24A6F6C7FFC719F1450@AM3PR07MB0551.eurprd07.prod.outlook.com>
 <2767795.He1lJvmL83@even-i700>
 <AM3PR07MB0551C2D33EB5A6ED536E7E29F1580@AM3PR07MB0551.eurprd07.prod.outlook.com>
Message-ID: <1497065.2ae0WFiGs2@even-i700>

On mardi 14 février 2017 19:43:35 CET Olsen Aron wrote:
> Thanks Even!
> 
> I have tried downloading various versions of GDAL (stable and dev).
> In the documentation, the WRITE_USERUNIT option is said to be supported from
> GDAL version 2.2. As such, I am not sure what download to use, as the
> latest is of 2.1.+ only.

The dev version is 2.2dev, so any thing that mentions 2.2 in the doc requires it.

> 
> Well, having used the RUPS app of IText 5.1 I believe I can conclude, that
> the latest 2.1+ do implement support for WRITE_USERUNIT as I see it updated
> to 2.77777... corresponding to 200 / 72. Nevertheless, setting DPI=200,
> WRITE_USERUNIT=YES and having the sample raster embedded, I don't yield an
> A4 page-size in AAR. It's the same size as without WRITE_USERUNIT=YES. I do
> notice though, that the size of the MediaBox in PDF changes downwards
> accordingly.

You should try with WRITE_USERUNITS=NO or not specifying it at all.

> 
> As said, I have no a priori knowledge of PDF, but for now, I am looking more
> harder.
> 
> I will get back when I have performed a more thourough investigation of what
> is and what is not. Regards,
> Aron
> 
> From: Even Rouault [mailto:even.rouault at spatialys.com]
> Sent: 12. februar 2017 20:56
> To: gdal-dev at lists.osgeo.org
> Cc: Olsen Aron <aron.olsen at sweco.dk>
> Subject: Re: [gdal-dev] Page-size of GeoPDF.
> 
> 
> Aron,
> 
> > Can I somehow accomplish this using the new WRITE_USERUNITS option, or
> > what?
> Hopefully yes. As soon as you specify DPI with GDAL trunk, it implies
> WRITE_USERUNITS=NO.
> 
> 
> 
> Even
> 
> 
> 
> 
> 
> --
> 
> Spatialys - Geospatial professional services
> 
> http://www.spatialys.com


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170214/406eb48f/attachment-0001.html>

From jason.liu at spookfish.com  Tue Feb 14 19:17:57 2017
From: jason.liu at spookfish.com (jason.liu)
Date: Tue, 14 Feb 2017 20:17:57 -0700 (MST)
Subject: [gdal-dev] GDAL-Kakadu 7.8 Performance Problems
Message-ID: <1487128677407-5307960.post@n6.nabble.com>

Hi gdal-dev,

Does anybody else experience performance problems with GDAL-Kakadu 7.8?

In my test on a quad-core Linux box, the following code, which takes a
8100x4300 3-band RGB 200MB uncompressed tif and compress it using JP2KAK,
took 19 seconds to execute on average:


    GDALAllRegister(); 

    GDALDataset* srcDataset =
(GDALDataset*)GDALOpen("/home/jason.liu/00000783.tif", GA_ReadOnly); 
    char **papszOptions = NULL; 
    papszOptions = CSLSetNameValue( papszOptions, "QUALITY", "20" ); 

    GDALDriver *driver = GetGDALDriverManager()->GetDriverByName("JP2KAK"); 
    GDALDataset* destDataset =
driver->CreateCopy("/home/jason.liu/00000783.jp2", 
                                                  srcDataset, 
                                                  FALSE, 
                                                  papszOptions, 
                                                  NULL, 
                                                  NULL); 

    if( destDataset != NULL ) { 
        GDALClose( (GDALDatasetH) destDataset ); 
    } 
    GDALClose( (GDALDatasetH) srcDataset ); 
    CSLDestroy(papszOptions); 


Using the kdu_compress app which ships with Kakadu-7.8, the following
command line took 1.3 seconds to execute on average:

    ./kdu_compress -i /home/jason.liu/00000783.tif -o
/home/jason.liu/00000783.jp2

The output jp2 sizes are similar (GDAL-Kakadu compresses down to 40MB, while
kdu_compress compresses down to 30MB). The number of jp2 tiles in both cases
are the same (one).

Changing GDAL settings such as JP2KAK_THREADS and GDAL_FORCE_CACHING seems
to make no significant difference to performance.

Any insights will be greatly appreciated.

Kind Regards
Jason




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/GDAL-Kakadu-7-8-Performance-Problems-tp5307960.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From tomislav.obad at gmail.com  Wed Feb 15 00:23:47 2017
From: tomislav.obad at gmail.com (Tomislav Obad)
Date: Wed, 15 Feb 2017 09:23:47 +0100
Subject: [gdal-dev] Converting indexed transparent PNG to transparent GeoTIFF
Message-ID: <CADKKQuvcwHyaizN82=mENMDb5=GMPg_Axg_JKhtBPtqQHCXXBA@mail.gmail.com>

Hi all,

I'm not sure I'm writing to a right address, but I have a rather simple
problem, at least a first glance.
I'm trying to convert an indexed transparent PNG to transparent GeoTIFF

I've tried many different things (using gdal_translate):
- convert indexed PNG to rgba PNG with external tool (Gimp) and then to
Geotiff with -expand rgba, -co ALPHA=YES and number of combinations I've
found on the internet
- convert directly this png to GeoTiff
- convert to rgba with pct2rgb.py -rgba image.png image_rgba.tif
- convert png to .vrt, edited a color map and no data entry, a tried to
convert vrt to rgb
- and some other stuff like external apps, imagick, gimp, PS, etc.

I cannot get an image with transparent part as in original PNG.

I've read that you can use MEM format and convert it in python (
https://lists.osgeo.org/pipermail/gdal-dev/2007-May/013197.html) but didn't
try in till now. I was hoping I can do it with GDAL commands.

What are my options?
Here is my test file:
http://s000.tinyupload.com/index.php?file_id=50896113004130896594

Please help :)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170215/fa39ba5c/attachment.html>

From lucadeluge at gmail.com  Wed Feb 15 02:29:51 2017
From: lucadeluge at gmail.com (Luca Delucchi)
Date: Wed, 15 Feb 2017 11:29:51 +0100
Subject: [gdal-dev] problem with HDF format
Message-ID: <CAK4m-3w0CW6-1NkjfeXh7NdLgGh+-izNa+7y3atzRtp723KySQ@mail.gmail.com>

Hi devs,

probably we found a problem with GDAL and HDF format, we are trying to
merge several MODIS tiles but we got a wrong "Corner Coordinates"

These are our input files

gdalinfo MOD11A1.A2012340.h29v05.005.2012342062359.hdf
 GRINGPOINTLATITUDE.1=39.9958333333333, 39.9958333333333,
30.0041666666667, 30.0041666666667
 GRINGPOINTLONGITUDE.1=143.594796204465, 156.637998651088,
138.5660967488, 127.027721580114

gdalinfo MOD11A1.A2012340.h28v05.005.2012342062414.hdf
  GRINGPOINTLATITUDE.1=39.9958333333333, 39.9958333333333,
30.0041666666667, 30.0041666666667
  GRINGPOINTLONGITUDE.1=130.54074741744, 143.583922543306,
127.018104673762, 115.479756825833

gdalinfo MOD11A1.A2012340.h28v04.005.2012342062356.hdf
  GRINGPOINTLATITUDE.1=49.9958333333333, 49.9958333333333,
40.0041666666667, 40.0041666666667
  GRINGPOINTLONGITUDE.1=155.572379857539, 171.116660974438,
143.601448808716, 130.556661758206

but using gdalbuildvrt, gdal_merge and gdalwarp we got a bigger upper
right value (173.313142 instead 171.116660974438), you can see our
tests here [0]

do you have any idea? is it a bug or feature?

[0] http://pastebin.com/KGYvFtfn

-- 
ciao
Luca

www.lucadelu.org

From cgallay.artal at gmail.com  Wed Feb 15 06:04:06 2017
From: cgallay.artal at gmail.com (CGA)
Date: Wed, 15 Feb 2017 07:04:06 -0700 (MST)
Subject: [gdal-dev] Gdal + Kakadu + Python : unable to write JPEG2000
	correctly
Message-ID: <1487167446969-5308040.post@n6.nabble.com>

Dear all,

I'm struggling with the Python bindings of GDAL + Kakadu. I'm trying to clip
a small part of an input image in .jp2 and write it inside another .jp2
file.

I read that the JP2KAK images can only be created using the CreateCopy()
method. Here is my workflow :
  - Open input dataset
  - Clip image using ReadAsArray (load into a numpy array)
  - Create a new dataset (using MEM or GTiff driver)
  - Write clipped array in new dataset
  - Convert created dataset to JP2 using JP2KAK driver CreateCopy() method

As a result, I get a JP2 image that contains only one value : 32768 ....
When using the intermediate GTiff driver, I confirmed that the intermediate
dataset is valid.

Here is the code used :


I also tried the following simple script that seems to be working fine (the
script only CreateCopy of an existing JP2 dataset) :


Is there anything wrong in the way I'm creating the JP2 clipped dataset in
the first script ?

Thanks,
Cyril



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Gdal-Kakadu-Python-unable-to-write-JPEG2000-correctly-tp5308040.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Wed Feb 15 07:09:55 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 15 Feb 2017 16:09:55 +0100
Subject: [gdal-dev] Gdal + Kakadu + Python : unable to write JPEG2000
	correctly
In-Reply-To: <1487167446969-5308040.post@n6.nabble.com>
References: <1487167446969-5308040.post@n6.nabble.com>
Message-ID: <3640101.fWOFGaRHjx@even-i700>

On mercredi 15 février 2017 07:04:06 CET CGA wrote:
> Dear all,
> 
> I'm struggling with the Python bindings of GDAL + Kakadu. I'm trying to clip
> a small part of an input image in .jp2 and write it inside another .jp2
> file.
> 
> I read that the JP2KAK images can only be created using the CreateCopy()
> method. Here is my workflow :
>   - Open input dataset
>   - Clip image using ReadAsArray (load into a numpy array)
>   - Create a new dataset (using MEM or GTiff driver)
>   - Write clipped array in new dataset
>   - Convert created dataset to JP2 using JP2KAK driver CreateCopy() method
> 
> As a result, I get a JP2 image that contains only one value : 32768 ....
> When using the intermediate GTiff driver, I confirmed that the intermediate
> dataset is valid.
> 
> Here is the code used :
> 
> 
> I also tried the following simple script that seems to be working fine (the
> script only CreateCopy of an existing JP2 dataset) :
> 
> 
> Is there anything wrong in the way I'm creating the JP2 clipped dataset in
> the first script ?

Does a simple gdal_translate in.jp2 out.jp2 -of JP2KAK work ? I believe there is (or was) 
signedness issues with 16 bit integers.


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170215/58318616/attachment.html>

From schwehr at gmail.com  Wed Feb 15 07:19:43 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Wed, 15 Feb 2017 07:19:43 -0800
Subject: [gdal-dev] Best vector driver?
Message-ID: <CACmBxyvWgui41j13x+vuvsvoXijvbENYtkMf6dhJjXZkL4tBCQ@mail.gmail.com>

Hey all,

What are the top couple vector drivers in terms of being up-to-date w.r.t.
API changes?  I'm finally trying to start into adding code and I've got a
couple vector drivers I'd like to write.  I've started reading RFC 46
(GDAL/OGR unification), but I'm trying to figure out the cleanest setup of
the driver, data source and layers classes.  I've spent tons of time with
line by line issues, but that gives me very little sense of where we want
GDAL vector drivers to converge to.

Thoughts on what are the best couple drivers to pattern after?

-kurt

Drivers on my wish list to work on: IMMA/ICOADS/VOS marine weather, libais,
and gpsd
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170215/1b8916f2/attachment.html>

From even.rouault at spatialys.com  Wed Feb 15 07:37:52 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 15 Feb 2017 16:37:52 +0100
Subject: [gdal-dev] Best vector driver?
In-Reply-To: <CACmBxyvWgui41j13x+vuvsvoXijvbENYtkMf6dhJjXZkL4tBCQ@mail.gmail.com>
References: <CACmBxyvWgui41j13x+vuvsvoXijvbENYtkMf6dhJjXZkL4tBCQ@mail.gmail.com>
Message-ID: <3876832.14HkhT6Dpv@even-i700>

On mercredi 15 février 2017 07:19:43 CET Kurt Schwehr wrote:
> Hey all,
> 
> What are the top couple vector drivers in terms of being up-to-date w.r.t.
> API changes?  I'm finally trying to start into adding code and I've got a
> couple vector drivers I'd like to write.  I've started reading RFC 46
> (GDAL/OGR unification), but I'm trying to figure out the cleanest setup of
> the driver, data source and layers classes.  I've spent tons of time with
> line by line issues, but that gives me very little sense of where we want
> GDAL vector drivers to converge to.
> 
> Thoughts on what are the best couple drivers to pattern after?

Kurt,

There's no such thing as the best driver. It depends pretty much on the capabilities of the 
format you want to write a driver for. The most feature full drivers (SQLite, GeoPackage, 
PostGIS, ...) tend to be the ones the most difficult to understand. And for other drivers, you 
will get lost in the code that deals with the format itself rather than the driver structure.

Basically start writing GetNextFeature() and implement other methods if they make sense 
for the format. Skimming quickly through http://gdal.org/ogr_drivertut.html, it seems to be a 
good starting point (as you make progress in your journey, updating it might be a good idea)
For real world examples, I think the SUA or BNA drivers must be among the most simple 
ones.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170215/9c5f37c3/attachment-0001.html>

From PHILIP.D.KAHLY at leidos.com  Wed Feb 15 08:21:09 2017
From: PHILIP.D.KAHLY at leidos.com (Kahly, Philip D.)
Date: Wed, 15 Feb 2017 16:21:09 +0000
Subject: [gdal-dev] Placemark With Two Geometries Is Not Processed
Message-ID: <D4C9EA23.3D2E%philip.d.kahly@leidos.com>

Hey all,

I'm attempting to process some KML files from an outside source and
sometimes a <Placemark> will contain two <MultiGeometry> blocks.

GDAL will not process these placemarks: layer.GetNextFeature() will return
null, and GetLastErrorMsg() returns an empty string.

I've attached a sample file "broken.kml", along with two copies in which
one of the geometry blocks was deleted. GDAL processes these "part*.kml"
files correctly.


Google Earth uses the last geometry and ignores the others. Are there any
settings I could use to get GDAL to exhibit the same behavior?

Philip Kahly
Software Engineer
Philip.D.Kahly at Leidos.com



-------------- next part --------------
A non-text attachment was scrubbed...
Name: broken.kml
Type: application/vnd.google-earth.kml+xml
Size: 15023 bytes
Desc: broken.kml
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170215/d6e4f3c0/attachment-0003.kml>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: part1.kml
Type: application/vnd.google-earth.kml+xml
Size: 8044 bytes
Desc: part1.kml
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170215/d6e4f3c0/attachment-0004.kml>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: part2.kml
Type: application/vnd.google-earth.kml+xml
Size: 7636 bytes
Desc: part2.kml
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170215/d6e4f3c0/attachment-0005.kml>

From schwehr at gmail.com  Wed Feb 15 08:27:06 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Wed, 15 Feb 2017 08:27:06 -0800
Subject: [gdal-dev] Best vector driver?
In-Reply-To: <3876832.14HkhT6Dpv@even-i700>
References: <CACmBxyvWgui41j13x+vuvsvoXijvbENYtkMf6dhJjXZkL4tBCQ@mail.gmail.com>
 <3876832.14HkhT6Dpv@even-i700>
Message-ID: <CACmBxyuOZF_tZaMCMkQUKkzoK3QOqjME4=7dgWi+4CjQURBHmQ@mail.gmail.com>

Even,

Thanks for the pointers.  I will do touchups on the driver tutorial as I go.

Maybe more specifically, with the initial setup of the driver and the
datasource:

I only see two drivers that use GDALDriver.

grep class */*.{cpp,h} | grep GDALDriver
db2/ogr_db2.h:class OGRDB2Driver : public GDALDriver
s57/ogr_s57.h:class OGRS57Driver : public GDALDriver

Most OGR drivers do:

GDALDriver *poDriver = new GDALDriver();

But others do:

gmt/ogrgmtdriver.cpp:    OGRSFDriver* poDriver = new OGRGmtDriver;
idb/ogridbdriver.cpp:
 OGRSFDriverRegistrar::GetRegistrar()->RegisterDriver(new OGRIDBDriver);

What's the cleanest way to setup the driver registration?

Should I be deriving from GDALDataset?

And a few do:

egrep class */*.{cpp,h} | grep public | egrep -i GDALDataset | head -7
geojson/ogrgeojsondriver.cpp:class OGRESRIFeatureServiceDataset: public
GDALDataset
gmlas/ogrgmlaswriter.cpp:class GMLASFakeDataset : public GDALDataset
mongodb/ogrmongodbdriver.cpp:class OGRMongoDBDataSource: public GDALDataset
cad/ogr_cad.h:class GDALCADDataset : public GDALDataset
elastic/ogr_elastic.h:class OGRElasticDataSource : public GDALDataset
gmlas/ogr_gmlas.h:class OGRGMLASDataSource: public GDALDataset
jml/ogr_jml.h:class OGRJMLDataset : public GDALDataset

But most do:

egrep class */*.{cpp,h} | grep public | egrep -i OGRDataSource | head -5
csw/ogrcswdataset.cpp:class OGRCSWDataSource : public OGRDataSource
generic/ogremulatedtransaction.cpp:class OGRDataSourceWithTransaction :
public OGRDataSource
null/ogrnulldriver.cpp:class OGRNULLDataSource : public OGRDataSource
aeronavfaa/ogr_aeronavfaa.h:class OGRAeronavFAADataSource : public
OGRDataSource
amigocloud/ogr_amigocloud.h:class OGRAmigoCloudDataSource : public
OGRDataSource

egrep class */*.{cpp,h} | grep public | egrep -i OGRDataSource | wc -l
     80

OGRDataSource is deprecated and new drivers should derive from GDALDataset,
yes?

On Wed, Feb 15, 2017 at 7:37 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> On mercredi 15 février 2017 07:19:43 CET Kurt Schwehr wrote:
>
> > Hey all,
>
> >
>
> > What are the top couple vector drivers in terms of being up-to-date
> w.r.t.
>
> > API changes? I'm finally trying to start into adding code and I've got a
>
> > couple vector drivers I'd like to write. I've started reading RFC 46
>
> > (GDAL/OGR unification), but I'm trying to figure out the cleanest setup
> of
>
> > the driver, data source and layers classes. I've spent tons of time with
>
> > line by line issues, but that gives me very little sense of where we want
>
> > GDAL vector drivers to converge to.
>
> >
>
> > Thoughts on what are the best couple drivers to pattern after?
>
>
>
> Kurt,
>
>
>
> There's no such thing as the best driver. It depends pretty much on the
> capabilities of the format you want to write a driver for. The most feature
> full drivers (SQLite, GeoPackage, PostGIS, ...) tend to be the ones the
> most difficult to understand. And for other drivers, you will get lost in
> the code that deals with the format itself rather than the driver structure.
>
>
>
> Basically start writing GetNextFeature() and implement other methods if
> they make sense for the format. Skimming quickly through
> http://gdal.org/ogr_drivertut.html, it seems to be a good starting point
> (as you make progress in your journey, updating it might be a good idea)
>
> For real world examples, I think the SUA or BNA drivers must be among the
> most simple ones.
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170215/db9ad0eb/attachment.html>

From even.rouault at spatialys.com  Wed Feb 15 08:33:41 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 15 Feb 2017 17:33:41 +0100
Subject: [gdal-dev] Best vector driver?
In-Reply-To: <CACmBxyuOZF_tZaMCMkQUKkzoK3QOqjME4=7dgWi+4CjQURBHmQ@mail.gmail.com>
References: <CACmBxyvWgui41j13x+vuvsvoXijvbENYtkMf6dhJjXZkL4tBCQ@mail.gmail.com>
 <3876832.14HkhT6Dpv@even-i700>
 <CACmBxyuOZF_tZaMCMkQUKkzoK3QOqjME4=7dgWi+4CjQURBHmQ@mail.gmail.com>
Message-ID: <13049393.VQlbfF7d5a@even-i700>

On mercredi 15 février 2017 08:27:06 CET Kurt Schwehr wrote:
> Even,
> 
> Thanks for the pointers.  I will do touchups on the driver tutorial as I go.
> 
> Maybe more specifically, with the initial setup of the driver and the
> datasource:
> 
> I only see two drivers that use GDALDriver.
> 
> grep class */*.{cpp,h} | grep GDALDriver
> db2/ogr_db2.h:class OGRDB2Driver : public GDALDriver
> s57/ogr_s57.h:class OGRS57Driver : public GDALDriver
> 
> Most OGR drivers do:
> 
> GDALDriver *poDriver = new GDALDriver();
> 
> But others do:
> 
> gmt/ogrgmtdriver.cpp:    OGRSFDriver* poDriver = new OGRGmtDriver;
> idb/ogridbdriver.cpp:
>  OGRSFDriverRegistrar::GetRegistrar()->RegisterDriver(new OGRIDBDriver);
> 
> What's the cleanest way to setup the driver registration?

The OGRSFDriver way is clearly deprecated. For the others, this is a matter of taste.

> 
> Should I be deriving from GDALDataset?

Yes

> 
> And a few do:
> 
> egrep class */*.{cpp,h} | grep public | egrep -i GDALDataset | head -7
> geojson/ogrgeojsondriver.cpp:class OGRESRIFeatureServiceDataset: public
> GDALDataset
> gmlas/ogrgmlaswriter.cpp:class GMLASFakeDataset : public GDALDataset
> mongodb/ogrmongodbdriver.cpp:class OGRMongoDBDataSource: public GDALDataset
> cad/ogr_cad.h:class GDALCADDataset : public GDALDataset
> elastic/ogr_elastic.h:class OGRElasticDataSource : public GDALDataset
> gmlas/ogr_gmlas.h:class OGRGMLASDataSource: public GDALDataset
> jml/ogr_jml.h:class OGRJMLDataset : public GDALDataset
> 
> But most do:
> 
> egrep class */*.{cpp,h} | grep public | egrep -i OGRDataSource | head -5
> csw/ogrcswdataset.cpp:class OGRCSWDataSource : public OGRDataSource
> generic/ogremulatedtransaction.cpp:class OGRDataSourceWithTransaction :
> public OGRDataSource
> null/ogrnulldriver.cpp:class OGRNULLDataSource : public OGRDataSource
> aeronavfaa/ogr_aeronavfaa.h:class OGRAeronavFAADataSource : public
> OGRDataSource
> amigocloud/ogr_amigocloud.h:class OGRAmigoCloudDataSource : public
> OGRDataSource
> 
> egrep class */*.{cpp,h} | grep public | egrep -i OGRDataSource | wc -l
>      80
> 
> OGRDataSource is deprecated and new drivers should derive from GDALDataset,
> yes?

Yes, not everything has been converted from OGRDataSource to GDALDataset given that we 
have a compatibility layer.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170215/0ec965ef/attachment-0001.html>

From even.rouault at spatialys.com  Wed Feb 15 08:36:17 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 15 Feb 2017 17:36:17 +0100
Subject: [gdal-dev] Placemark With Two Geometries Is Not Processed
In-Reply-To: <D4C9EA23.3D2E%philip.d.kahly@leidos.com>
References: <D4C9EA23.3D2E%philip.d.kahly@leidos.com>
Message-ID: <2712868.Zo8UCskPSA@even-i700>

On mercredi 15 février 2017 16:21:09 CET Kahly, Philip D. wrote:
> Hey all,
> 
> I'm attempting to process some KML files from an outside source and
> sometimes a <Placemark> will contain two <MultiGeometry> blocks.
> 
> GDAL will not process these placemarks: layer.GetNextFeature() will return
> null, and GetLastErrorMsg() returns an empty string.
> 
> I've attached a sample file "broken.kml", along with two copies in which
> one of the geometry blocks was deleted. GDAL processes these "part*.kml"
> files correctly.
> 
> 
> Google Earth uses the last geometry and ignores the others. Are there any
> settings I could use to get GDAL to exhibit the same behavior?

Philip,

From a quick try, I'd say that you must use the "old" KML driver. With the LIBKML driver, the 
reported geometry is the last one.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170215/9284b93c/attachment.html>

From even.rouault at spatialys.com  Wed Feb 15 08:54:48 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 15 Feb 2017 17:54:48 +0100
Subject: [gdal-dev] problem with HDF format
In-Reply-To: <CAK4m-3w0CW6-1NkjfeXh7NdLgGh+-izNa+7y3atzRtp723KySQ@mail.gmail.com>
References: <CAK4m-3w0CW6-1NkjfeXh7NdLgGh+-izNa+7y3atzRtp723KySQ@mail.gmail.com>
Message-ID: <8266084.raJsRhQyQl@even-i700>

Luca,

from a quick skim in the code, the GRINGPOINTLATITUDE / GRINGPOINTLONGITUDE 
metadata are not used by the HDF4 driver to derive the georeferencing it uses, so it is not 
unexpected that what gdalinfo reports on the MODIS dataset isn't directly correlated with 
those. There are several code paths depending on the actual formulation of HDF4 to derive 
the GDAL georeferencing info from the dataset.

Even

> 
> probably we found a problem with GDAL and HDF format, we are trying to
> merge several MODIS tiles but we got a wrong "Corner Coordinates"
> 
> These are our input files
> 
> gdalinfo MOD11A1.A2012340.h29v05.005.2012342062359.hdf
>  GRINGPOINTLATITUDE.1=39.9958333333333, 39.9958333333333,
> 30.0041666666667, 30.0041666666667
>  GRINGPOINTLONGITUDE.1=143.594796204465, 156.637998651088,
> 138.5660967488, 127.027721580114
> 
> gdalinfo MOD11A1.A2012340.h28v05.005.2012342062414.hdf
>   GRINGPOINTLATITUDE.1=39.9958333333333, 39.9958333333333,
> 30.0041666666667, 30.0041666666667
>   GRINGPOINTLONGITUDE.1=130.54074741744, 143.583922543306,
> 127.018104673762, 115.479756825833
> 
> gdalinfo MOD11A1.A2012340.h28v04.005.2012342062356.hdf
>   GRINGPOINTLATITUDE.1=49.9958333333333, 49.9958333333333,
> 40.0041666666667, 40.0041666666667
>   GRINGPOINTLONGITUDE.1=155.572379857539, 171.116660974438,
> 143.601448808716, 130.556661758206
> 
> but using gdalbuildvrt, gdal_merge and gdalwarp we got a bigger upper
> right value (173.313142 instead 171.116660974438), you can see our
> tests here [0]
> 
> do you have any idea? is it a bug or feature?
> 
> [0] http://pastebin.com/KGYvFtfn


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170215/91669847/attachment.html>

From philip.d.kahly at leidos.com  Wed Feb 15 09:08:01 2017
From: philip.d.kahly at leidos.com (archgnulinux)
Date: Wed, 15 Feb 2017 10:08:01 -0700 (MST)
Subject: [gdal-dev] Placemark With Two Geometries Is Not Processed
In-Reply-To: <2712868.Zo8UCskPSA@even-i700>
References: <D4C9EA23.3D2E%philip.d.kahly@leidos.com>
 <2712868.Zo8UCskPSA@even-i700>
Message-ID: <1487178481478-5308076.post@n6.nabble.com>

Even Rouault-2 wrote
> From a quick try, I'd say that you must use the "old" KML driver. With the
> LIBKML driver, the 
> reported geometry is the last one.

Thanks, I am using the "old" KML driver.

I tried to compile LIBKML for Windows awhile back but had quite a bit of
trouble. 
I'll give it another try...

Do you know of any distributions of GDAL with LIBKML?

Philip




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Placemark-With-Two-Geometries-Is-Not-Processed-tp5308067p5308076.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From cgallay.artal at gmail.com  Wed Feb 15 09:18:34 2017
From: cgallay.artal at gmail.com (CGA)
Date: Wed, 15 Feb 2017 10:18:34 -0700 (MST)
Subject: [gdal-dev] Gdal + Kakadu + Python : unable to write JPEG2000
	correctly
In-Reply-To: <3640101.fWOFGaRHjx@even-i700>
References: <1487167446969-5308040.post@n6.nabble.com>
 <3640101.fWOFGaRHjx@even-i700>
Message-ID: <1487179114205-5308078.post@n6.nabble.com>

I just confirmed that gdal_translate works fine :


The result image is in effectively in JP2KAK format and readable in QGIS.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Gdal-Kakadu-Python-unable-to-write-JPEG2000-correctly-tp5308040p5308078.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Wed Feb 15 09:22:24 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 15 Feb 2017 18:22:24 +0100
Subject: [gdal-dev] Placemark With Two Geometries Is Not Processed
In-Reply-To: <1487178481478-5308076.post@n6.nabble.com>
References: <D4C9EA23.3D2E%philip.d.kahly@leidos.com>
 <2712868.Zo8UCskPSA@even-i700> <1487178481478-5308076.post@n6.nabble.com>
Message-ID: <4045234.qx9bDWcc1m@even-i700>

On mercredi 15 février 2017 10:08:01 CET archgnulinux wrote:
> Even Rouault-2 wrote
> 
> > From a quick try, I'd say that you must use the "old" KML driver. With the
> > LIBKML driver, the
> > reported geometry is the last one.
> 
> Thanks, I am using the "old" KML driver.
> 
> I tried to compile LIBKML for Windows awhile back but had quite a bit of
> trouble.
> I'll give it another try...
> 
> Do you know of any distributions of GDAL with LIBKML?

You mention Windows, but your nickname is archgnulinux... So assuming the later, the GDAL 
2.1.2 package in UbuntuGIS unstable for Xenial is built against libkml.
And I also see that the GDAL package in OSGEO4W has the libkml dependency.

> 
> Philip
> 
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/gdal-dev-Placemark-With-Two-Geometries-> Is-Not-Processed-tp5308067p5308076.html Sent from the GDAL - Dev mailing
> list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170215/3523876e/attachment-0001.html>

From philip.d.kahly at leidos.com  Wed Feb 15 10:27:54 2017
From: philip.d.kahly at leidos.com (archgnulinux)
Date: Wed, 15 Feb 2017 11:27:54 -0700 (MST)
Subject: [gdal-dev] Placemark With Two Geometries Is Not Processed
In-Reply-To: <4045234.qx9bDWcc1m@even-i700>
References: <D4C9EA23.3D2E%philip.d.kahly@leidos.com>
 <2712868.Zo8UCskPSA@even-i700> <1487178481478-5308076.post@n6.nabble.com>
 <4045234.qx9bDWcc1m@even-i700>
Message-ID: <1487183274679-5308098.post@n6.nabble.com>

Even Rouault-2 wrote
> You mention Windows, but your nickname is archgnulinux... So assuming the
> later, the GDAL 2.1.2 package in UbuntuGIS unstable for Xenial is built
> against libkml.
> And I also see that the GDAL package in OSGEO4W has the libkml dependency.

Unfortunately, I have to use Windows for this...

OSGEO4W didn't have the 2.1 version, but I found a package on GISInternals
and it works.

Thanks for you help.

Philip



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Placemark-With-Two-Geometries-Is-Not-Processed-tp5308067p5308098.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Wed Feb 15 10:34:15 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 15 Feb 2017 19:34:15 +0100
Subject: [gdal-dev] Placemark With Two Geometries Is Not Processed
In-Reply-To: <1487183274679-5308098.post@n6.nabble.com>
References: <D4C9EA23.3D2E%philip.d.kahly@leidos.com>
 <4045234.qx9bDWcc1m@even-i700> <1487183274679-5308098.post@n6.nabble.com>
Message-ID: <6024972.7hvG6KbK98@even-i700>

On mercredi 15 février 2017 11:27:54 CET archgnulinux wrote:
> Even Rouault-2 wrote
> 
> > You mention Windows, but your nickname is archgnulinux... So assuming the
> > later, the GDAL 2.1.2 package in UbuntuGIS unstable for Xenial is built
> > against libkml.
> > And I also see that the GDAL package in OSGEO4W has the libkml dependency.
> 
> Unfortunately, I have to use Windows for this...
> 
> OSGEO4W didn't have the 2.1 version

It does. It has 2.1.3


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170215/82dce672/attachment.html>

From mateusz at loskot.net  Thu Feb 16 01:16:11 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu, 16 Feb 2017 10:16:11 +0100
Subject: [gdal-dev] Best vector driver?
In-Reply-To: <CACmBxyuOZF_tZaMCMkQUKkzoK3QOqjME4=7dgWi+4CjQURBHmQ@mail.gmail.com>
References: <CACmBxyvWgui41j13x+vuvsvoXijvbENYtkMf6dhJjXZkL4tBCQ@mail.gmail.com>
 <3876832.14HkhT6Dpv@even-i700>
 <CACmBxyuOZF_tZaMCMkQUKkzoK3QOqjME4=7dgWi+4CjQURBHmQ@mail.gmail.com>
Message-ID: <CABUeae97yYECgOkzFimPHRbPrW8O=5WPrrH6u1XoG=C_NawOSw@mail.gmail.com>

On 15 February 2017 at 17:27, Kurt Schwehr <schwehr at gmail.com> wrote:
>
> Thanks for the pointers.  I will do touchups on the driver tutorial as I go.
> [...]
> What's the cleanest way to setup the driver registration?
>
> Should I be deriving from GDALDataset?

Kurt,

BTW, I'd have similar or related question.

Which driver or part of the code is the latest/greatest in
terms of the new C++ programming guidelines to look up to
while writing new code for GDAL?

Has there been any agreement on the overall C++ coding guidelines?
Better, do we need the RFC8 [1] update?

[1] https://trac.osgeo.org/gdal/wiki/rfc8_devguide

Best regards
-- 
Mateusz Loskot, http://mateusz.loskot.net

From schwehr at gmail.com  Thu Feb 16 07:10:14 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Thu, 16 Feb 2017 07:10:14 -0800
Subject: [gdal-dev] Best vector driver?
In-Reply-To: <CABUeae97yYECgOkzFimPHRbPrW8O=5WPrrH6u1XoG=C_NawOSw@mail.gmail.com>
References: <CACmBxyvWgui41j13x+vuvsvoXijvbENYtkMf6dhJjXZkL4tBCQ@mail.gmail.com>
 <3876832.14HkhT6Dpv@even-i700>
 <CACmBxyuOZF_tZaMCMkQUKkzoK3QOqjME4=7dgWi+4CjQURBHmQ@mail.gmail.com>
 <CABUeae97yYECgOkzFimPHRbPrW8O=5WPrrH6u1XoG=C_NawOSw@mail.gmail.com>
Message-ID: <CACmBxyurMiH8ML1qKYF-E8NLLKfukaHcAKLtC4K3mUPKeuSjcQ@mail.gmail.com>

Mateusz,

I have been meaning to write up a new RFC for the switch to C++11 as a
minimum in January and then the flu caught up with me.  I will try to do
that in the next week or two.   And I really appreciate all folks who
commented on that thread.

In my opinion, RFC 8 could use a lot of things and I only got through 2
documents that could feed into it last year (if I remember correctly).  One
of which was about getting large buffers off of the stack (
http://goo.gl/vuA3D6).  The other was a start on int bFoo -> bool bFoo (
https://goo.gl/hdzhXD

Things that I think should be discussed/added off the top of my head in no
particular order and only things before C++11.  And I just overwhelmed
myself.

- When to use bool/true/false versus int/TRUE/FALSE/-1(MAYBE/UNKNOWN?).
Expand on https://goo.gl/hdzhXD
- namespaces
- IWYU
- Initializing vars and data members.  ctor initializer lists
- Don't use goto
- Templates and inlining
- Defining one member per line
- clang-format
- C++ casting
- CPLString versus std::string
- Preferring const var to #define
- Making vars const when possible
- override, explicit, CPL_DISALLOW_COPY_ASSIGN
- Design for testability and what tests to have.  e.g. I am working on an
in depth test of jp2kakdataset.cpp.
- static and dynamic analysis.  cppcheck, clang static analyzier, compiler
warnings.  How and when to tell the tools that they are being dumb
- Examples of good/helpful comments
- What to do about svn keywords and file permissions (e.g. python tests and
shellscripts being executable)
- When to use parens
- Prefer !.empty() and .empty().  When to use CPL_ARRAYSIZE
- Don't convert back to C strings for operations that are available in a
C++ string you already have
- ABS/MIN/MAX -> std::abs/std::min/std::max etc.
- When to use {} in if else (at least be consistent within a block)
- When to use a scope
- char *foo v. char foo[]
- When is it okay to have newlines in CPLDebug and CPLError
- When to use #if DEBUG_VERBOSE.  Is it okay to check in commented out code?

After C++11:

- Avoid bare .*alloc/new and *free/delete
- NULL -> nullptr
- constexpr / static_assert
- std::initializer_list


On Thu, Feb 16, 2017 at 1:16 AM, Mateusz Loskot <mateusz at loskot.net> wrote:

> On 15 February 2017 at 17:27, Kurt Schwehr <schwehr at gmail.com> wrote:
> >
> > Thanks for the pointers.  I will do touchups on the driver tutorial as I
> go.
> > [...]
> > What's the cleanest way to setup the driver registration?
> >
> > Should I be deriving from GDALDataset?
>
> Kurt,
>
> BTW, I'd have similar or related question.
>
> Which driver or part of the code is the latest/greatest in
> terms of the new C++ programming guidelines to look up to
> while writing new code for GDAL?
>
> Has there been any agreement on the overall C++ coding guidelines?
> Better, do we need the RFC8 [1] update?
>
> [1] https://trac.osgeo.org/gdal/wiki/rfc8_devguide
>
> Best regards
> --
> Mateusz Loskot, http://mateusz.loskot.net
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170216/86a87575/attachment.html>

From boxerab at gmail.com  Thu Feb 16 07:28:23 2017
From: boxerab at gmail.com (Aaron Boxer)
Date: Thu, 16 Feb 2017 10:28:23 -0500
Subject: [gdal-dev] Seeking large lossless-encoded J2K images
Message-ID: <CAK8GPyDaizMC+xcb5+uKLPQRj6gr5QdBZ6SjUtBAzFt9zw6z3Q@mail.gmail.com>

Hello,

I'm interested in testing decode of large lossless-encoded J2K images.
I have checked out Sentinel-2 and Pleides, are there other good sources
for this ?

Thanks so much,
Aaron
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170216/082f7682/attachment.html>

From emmanuel.dangelo at pix4d.com  Thu Feb 16 07:48:57 2017
From: emmanuel.dangelo at pix4d.com (Emmanuel d'Angelo)
Date: Thu, 16 Feb 2017 16:48:57 +0100
Subject: [gdal-dev] Building GDAL with PROJ4 in a non-standard location?
Message-ID: <CAADUMQrVM0a02HX5Psfi3Aji_snNatd7GTAw5WcRy-ArQiTYxQ@mail.gmail.com>

Hi everyone,

I'm experimenting with a C++ package manager (conan.io for interested
folks) to correctly setup my project and its dependencies.

In this experiment, I'm trying to wrap GDAL and build GDAL 2.1.1 using a
PROJ4 library that was put in a non-standard location by the package
manager. When I had a look at the configure.in file, I could find an option
to specify the path to PROJ4 install directory, but that is only set when
using the option --with-static-proj4.

Is there a way to pass the path to a dynamic library of PROJ4 when building
GDAL?

Thanks a lot,

Emmanuel
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170216/b7896a67/attachment.html>

From even.rouault at spatialys.com  Thu Feb 16 07:51:55 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 16 Feb 2017 16:51:55 +0100
Subject: [gdal-dev] Building GDAL with PROJ4 in a non-standard location?
In-Reply-To: <CAADUMQrVM0a02HX5Psfi3Aji_snNatd7GTAw5WcRy-ArQiTYxQ@mail.gmail.com>
References: <CAADUMQrVM0a02HX5Psfi3Aji_snNatd7GTAw5WcRy-ArQiTYxQ@mail.gmail.com>
Message-ID: <4112439.4JoH9HvCQx@even-i700>

On jeudi 16 février 2017 16:48:57 CET Emmanuel d'Angelo wrote:
> Hi everyone,
> 
> I'm experimenting with a C++ package manager (conan.io for interested
> folks) to correctly setup my project and its dependencies.
> 
> In this experiment, I'm trying to wrap GDAL and build GDAL 2.1.1 using a
> PROJ4 library that was put in a non-standard location by the package
> manager. When I had a look at the configure.in file, I could find an option
> to specify the path to PROJ4 install directory, but that is only set when
> using the option --with-static-proj4.
> 
> Is there a way to pass the path to a dynamic library of PROJ4 when building
> GDAL?

Emmanuel,

Yes, with that very same option. The "static" in --with-static-proj4 refers to a a static/dynamic 
linking done at build time rather than the default behaviour which is to use dlopen() / 
LoadLibrary() metchanisms at runtime.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170216/155012a7/attachment-0001.html>

From emmanuel.dangelo at pix4d.com  Thu Feb 16 07:55:42 2017
From: emmanuel.dangelo at pix4d.com (Emmanuel d'Angelo)
Date: Thu, 16 Feb 2017 16:55:42 +0100
Subject: [gdal-dev] Building GDAL with PROJ4 in a non-standard location?
In-Reply-To: <4112439.4JoH9HvCQx@even-i700>
References: <CAADUMQrVM0a02HX5Psfi3Aji_snNatd7GTAw5WcRy-ArQiTYxQ@mail.gmail.com>
 <4112439.4JoH9HvCQx@even-i700>
Message-ID: <CAADUMQr+fdqWJJ+O0--5--2SDmcWBnZLeE9m1q=cww=8o3u2_A@mail.gmail.com>

Oops, I hadn't inferred that.

Thanks Even!

Emmanuel


[image: Pix4D] <http://pix4d.com/>    Emmanuel d'Angelo | Model Team
Technical Lead
EPFL Innovation Park *| Building F | *1015 Lausanne, Switzerland
t. +41 21 552 05 96

 *https://pix4d.com <https://pix4d.com/> | * *emmanuel.dangelo at pix4d.com
<emmanuel.dangelo at pix4d.com>*


*[image: Twitter] <https://twitter.com/pix4d>[image: Facebook]
<https://www.facebook.com/Pix4D/>[image: LinkedIn]
<https://www.linkedin.com/company/pix4d>[image: YouTube]
<https://www.youtube.com/channel/UCXHBqjCbv1wj_-itfvpVNIA?sub_confirmation=1>*

2017-02-16 16:51 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:

> On jeudi 16 février 2017 16:48:57 CET Emmanuel d'Angelo wrote:
>
> > Hi everyone,
>
> >
>
> > I'm experimenting with a C++ package manager (conan.io for interested
>
> > folks) to correctly setup my project and its dependencies.
>
> >
>
> > In this experiment, I'm trying to wrap GDAL and build GDAL 2.1.1 using a
>
> > PROJ4 library that was put in a non-standard location by the package
>
> > manager. When I had a look at the configure.in file, I could find an
> option
>
> > to specify the path to PROJ4 install directory, but that is only set when
>
> > using the option --with-static-proj4.
>
> >
>
> > Is there a way to pass the path to a dynamic library of PROJ4 when
> building
>
> > GDAL?
>
>
>
> Emmanuel,
>
>
>
> Yes, with that very same option. The "static" in --with-static-proj4
> refers to a a static/dynamic linking done at build time rather than the
> default behaviour which is to use dlopen() / LoadLibrary() metchanisms at
> runtime.
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170216/0b9a0060/attachment.html>

From ari.jolma at gmail.com  Thu Feb 16 08:07:03 2017
From: ari.jolma at gmail.com (Ari Jolma)
Date: Thu, 16 Feb 2017 18:07:03 +0200
Subject: [gdal-dev] GDAL Python and QGIS 2.99?
Message-ID: <8e00dcfb-279e-e19d-6eac-fc9c0c4d727a@gmail.com>

I have QGIS 2.18.3 working on my computer and now I want to work a bit 
on QGIS 2.99 (the trunk).

I've got to the point where everything else seems to be working fine 
except that the processing plugin does not work (and I want to play with 
that plugin exactly) and it gives the error

ImportError: ...usr/lib/python2.7/site-packages/osgeo/_gdal.so: 
undefined symbol: PyInstance_Type

It seems to me that the reason is a conflict between Python 2 and 3. 
QGIS 2.99 seems to mostly use Python 3 (2.18.3 is using 2?) and GDAL 
Python uses 2.

How should I proceed? Any ideas?

Best regards,

Ari



From even.rouault at spatialys.com  Thu Feb 16 08:18:45 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 16 Feb 2017 17:18:45 +0100
Subject: [gdal-dev] GDAL Python and QGIS 2.99?
In-Reply-To: <8e00dcfb-279e-e19d-6eac-fc9c0c4d727a@gmail.com>
References: <8e00dcfb-279e-e19d-6eac-fc9c0c4d727a@gmail.com>
Message-ID: <1524703.H5gqV6DkrH@even-i700>

On jeudi 16 février 2017 18:07:03 CET Ari Jolma wrote:
> I have QGIS 2.18.3 working on my computer and now I want to work a bit
> on QGIS 2.99 (the trunk).
> 
> I've got to the point where everything else seems to be working fine
> except that the processing plugin does not work (and I want to play with
> that plugin exactly) and it gives the error
> 
> ImportError: ...usr/lib/python2.7/site-packages/osgeo/_gdal.so:
> undefined symbol: PyInstance_Type
> 
> It seems to me that the reason is a conflict between Python 2 and 3.
> QGIS 2.99 seems to mostly use Python 3 (2.18.3 is using 2?) and GDAL
> Python uses 2.
> 
> How should I proceed? Any ideas?

Ari,

Make sure to configure GDAL --with-python=python3
And configure QGIS master with python3 (but I guess that's checked by cmake).

QGIS 3 is Python3 only.
QGIS 2.18 is nominally Python2 and experimentally Python3 .

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170216/092118e9/attachment.html>

From schwehr at gmail.com  Thu Feb 16 08:44:22 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Thu, 16 Feb 2017 08:44:22 -0800
Subject: [gdal-dev] Best vector driver?
In-Reply-To: <CACmBxyurMiH8ML1qKYF-E8NLLKfukaHcAKLtC4K3mUPKeuSjcQ@mail.gmail.com>
References: <CACmBxyvWgui41j13x+vuvsvoXijvbENYtkMf6dhJjXZkL4tBCQ@mail.gmail.com>
 <3876832.14HkhT6Dpv@even-i700>
 <CACmBxyuOZF_tZaMCMkQUKkzoK3QOqjME4=7dgWi+4CjQURBHmQ@mail.gmail.com>
 <CABUeae97yYECgOkzFimPHRbPrW8O=5WPrrH6u1XoG=C_NawOSw@mail.gmail.com>
 <CACmBxyurMiH8ML1qKYF-E8NLLKfukaHcAKLtC4K3mUPKeuSjcQ@mail.gmail.com>
Message-ID: <CACmBxytD3UdS+JPxEZ-Qw6smnhJPH1w4QKAXXns5BbPtNt17Uw@mail.gmail.com>

Even,

If a format can have a combination of point, lines, and polygons in a
layer, should the layer class set wkbGeometryCollection?  And if so, does
that imply Z is okay or not okay?  I see there is
also wkbGeometryCollectionM and wkbGeometryCollectionZM, but
no wkbGeometryCollectionZ.  And I see wkbGeometryCollection25D is old and
shouldn't be used, yes?

poFeatureDefn->SetGeomType(wkbGeometryCollection);

Thanks!
-kurt

On Thu, Feb 16, 2017 at 7:10 AM, Kurt Schwehr <schwehr at gmail.com> wrote:

> Mateusz,
>
> I have been meaning to write up a new RFC for the switch to C++11 as a
> minimum in January and then the flu caught up with me.  I will try to do
> that in the next week or two.   And I really appreciate all folks who
> commented on that thread.
>
> In my opinion, RFC 8 could use a lot of things and I only got through 2
> documents that could feed into it last year (if I remember correctly).  One
> of which was about getting large buffers off of the stack (
> http://goo.gl/vuA3D6).  The other was a start on int bFoo -> bool bFoo (
> https://goo.gl/hdzhXD
>
> Things that I think should be discussed/added off the top of my head in no
> particular order and only things before C++11.  And I just overwhelmed
> myself.
>
> - When to use bool/true/false versus int/TRUE/FALSE/-1(MAYBE/UNKNOWN?).
> Expand on https://goo.gl/hdzhXD
> - namespaces
> - IWYU
> - Initializing vars and data members.  ctor initializer lists
> - Don't use goto
> - Templates and inlining
> - Defining one member per line
> - clang-format
> - C++ casting
> - CPLString versus std::string
> - Preferring const var to #define
> - Making vars const when possible
> - override, explicit, CPL_DISALLOW_COPY_ASSIGN
> - Design for testability and what tests to have.  e.g. I am working on an
> in depth test of jp2kakdataset.cpp.
> - static and dynamic analysis.  cppcheck, clang static analyzier, compiler
> warnings.  How and when to tell the tools that they are being dumb
> - Examples of good/helpful comments
> - What to do about svn keywords and file permissions (e.g. python tests
> and shellscripts being executable)
> - When to use parens
> - Prefer !.empty() and .empty().  When to use CPL_ARRAYSIZE
> - Don't convert back to C strings for operations that are available in a
> C++ string you already have
> - ABS/MIN/MAX -> std::abs/std::min/std::max etc.
> - When to use {} in if else (at least be consistent within a block)
> - When to use a scope
> - char *foo v. char foo[]
> - When is it okay to have newlines in CPLDebug and CPLError
> - When to use #if DEBUG_VERBOSE.  Is it okay to check in commented out
> code?
>
> After C++11:
>
> - Avoid bare .*alloc/new and *free/delete
> - NULL -> nullptr
> - constexpr / static_assert
> - std::initializer_list
>
>
> On Thu, Feb 16, 2017 at 1:16 AM, Mateusz Loskot <mateusz at loskot.net>
> wrote:
>
>> On 15 February 2017 at 17:27, Kurt Schwehr <schwehr at gmail.com> wrote:
>> >
>> > Thanks for the pointers.  I will do touchups on the driver tutorial as
>> I go.
>> > [...]
>> > What's the cleanest way to setup the driver registration?
>> >
>> > Should I be deriving from GDALDataset?
>>
>> Kurt,
>>
>> BTW, I'd have similar or related question.
>>
>> Which driver or part of the code is the latest/greatest in
>> terms of the new C++ programming guidelines to look up to
>> while writing new code for GDAL?
>>
>> Has there been any agreement on the overall C++ coding guidelines?
>> Better, do we need the RFC8 [1] update?
>>
>> [1] https://trac.osgeo.org/gdal/wiki/rfc8_devguide
>>
>> Best regards
>> --
>> Mateusz Loskot, http://mateusz.loskot.net
>>
>
>
>
> --
> --
> http://schwehr.org
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170216/d6f611dd/attachment-0001.html>

From ari.jolma at gmail.com  Thu Feb 16 09:04:11 2017
From: ari.jolma at gmail.com (Ari Jolma)
Date: Thu, 16 Feb 2017 19:04:11 +0200
Subject: [gdal-dev] GDAL Python and QGIS 2.99?
In-Reply-To: <1524703.H5gqV6DkrH@even-i700>
References: <8e00dcfb-279e-e19d-6eac-fc9c0c4d727a@gmail.com>
 <1524703.H5gqV6DkrH@even-i700>
Message-ID: <c537f9cc-2c47-99c6-0856-51f0c53ad4aa@gmail.com>

16.02.2017, 18:18, Even Rouault kirjoitti:
>
> On jeudi 16 février 2017 18:07:03 CET Ari Jolma wrote:
>
> > I have QGIS 2.18.3 working on my computer and now I want to work a bit
>
> > on QGIS 2.99 (the trunk).
>
> >
>
> > I've got to the point where everything else seems to be working fine
>
> > except that the processing plugin does not work (and I want to play with
>
> > that plugin exactly) and it gives the error
>
> >
>
> > ImportError: ...usr/lib/python2.7/site-packages/osgeo/_gdal.so:
>
> > undefined symbol: PyInstance_Type
>
> >
>
> > It seems to me that the reason is a conflict between Python 2 and 3.
>
> > QGIS 2.99 seems to mostly use Python 3 (2.18.3 is using 2?) and GDAL
>
> > Python uses 2.
>
> >
>
> > How should I proceed? Any ideas?
>
> Ari,
>
> Make sure to configure GDAL --with-python=python3
>
> And configure QGIS master with python3 (but I guess that's checked by 
> cmake).
>

ok, thanks. That did it.

I'm trying to add a new processing provider for Perl scripts to the 
processing plugin of QGIS.

Ari

> QGIS 3 is Python3 only.
>
> QGIS 2.18 is nominally Python2 and experimentally Python3 .
>
> Even
>
> -- 
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170216/f40cd023/attachment.html>

From even.rouault at spatialys.com  Thu Feb 16 09:13:34 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 16 Feb 2017 18:13:34 +0100
Subject: [gdal-dev] Best vector driver?
In-Reply-To: <CACmBxytD3UdS+JPxEZ-Qw6smnhJPH1w4QKAXXns5BbPtNt17Uw@mail.gmail.com>
References: <CACmBxyvWgui41j13x+vuvsvoXijvbENYtkMf6dhJjXZkL4tBCQ@mail.gmail.com>
 <CACmBxyurMiH8ML1qKYF-E8NLLKfukaHcAKLtC4K3mUPKeuSjcQ@mail.gmail.com>
 <CACmBxytD3UdS+JPxEZ-Qw6smnhJPH1w4QKAXXns5BbPtNt17Uw@mail.gmail.com>
Message-ID: <3658200.QQDOBAsQXT@even-i700>

On jeudi 16 février 2017 08:44:22 CET Kurt Schwehr wrote:
> Even,
> 
> If a format can have a combination of point, lines, and polygons in a
> layer, should the layer class set wkbGeometryCollection? 

No it shoud return wkbUnknown.

wkbGeometryCollection is for geometries whose WKT is like
GEOMETRYCOLLECTION( POINT(0 1), LINESTRING(2 3,4 5))

> And if so, does
> that imply Z is okay or not okay?

There's some ambiguity around this. It might be prudent to declare
wkbUnknown | wkb25DBit if 3D geometries might be returned.

> I see there is
> also wkbGeometryCollectionM and wkbGeometryCollectionZM, but
> no wkbGeometryCollectionZ.  And I see wkbGeometryCollection25D is old and
> shouldn't be used, yes?

wkbGeometryCollection25D can be used as wkbGeometryCollectionZ (when that makes 
sense). It is just that for compatibility reasons we have not renamed the constant and 
changed its value to be conformant to the ISO values.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170216/48264548/attachment.html>

From woodbri at swoodbridge.com  Thu Feb 16 11:46:20 2017
From: woodbri at swoodbridge.com (Stephen Woodbridge)
Date: Thu, 16 Feb 2017 14:46:20 -0500
Subject: [gdal-dev] Ubuntu GDAL 1.10.1 support for ECW formats
Message-ID: <c6d078cc-0902-77af-3adc-4adb65a8b4cc@swoodbridge.com>

Hi all,

On my system: Ubuntu 14.04.5 LTS

I have installed:
gdal-bin:amd64/trusty 1.10.1+dfsg-5ubuntu1 upgradeable to 
2.1.0+dfsg-1~trusty2
libgdal-dev:amd64/trusty 1.10.1+dfsg-5ubuntu1 upgradeable to 
2.1.0+dfsg-1~trusty2
libgdal1h:amd64/trusty 1.10.1+dfsg-5ubuntu1 uptodate

$ gdalinfo --formats|grep ECW
   ECW (rw): ERDAS Compressed Wavelets (SDK 3.x)
   JP2ECW (rw+v): ERDAS JPEG2000 (SDK 3.x)


On a clients system also Ubuntu 14.04.5 LTS, they have the same packages 
installed.

The problem is my system has ECW support, but the client system does not!

gdalinfo file_wgs84.ecw
ERROR 4: `file_wgs84.ecw' not recognised as a supported file format.

I can not figure out why this is the case, or if there is some other 
package then needs to be installed or what the issue. And the gdalinfo 
--formats|grep ECW comand fails to return anything.

Any ideas on this?

-Steve

---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus


From sebastic at xs4all.nl  Thu Feb 16 12:04:24 2017
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Thu, 16 Feb 2017 21:04:24 +0100
Subject: [gdal-dev] Ubuntu GDAL 1.10.1 support for ECW formats
In-Reply-To: <c6d078cc-0902-77af-3adc-4adb65a8b4cc@swoodbridge.com>
References: <c6d078cc-0902-77af-3adc-4adb65a8b4cc@swoodbridge.com>
Message-ID: <8dbcd092-4a5c-42fb-db19-27d62cbf73c4@xs4all.nl>

On 02/16/2017 08:46 PM, Stephen Woodbridge wrote:
> Any ideas on this?

ECW support is not enabled in the Debian package, that's why your client
doesn't have it.

You probably have a custom build installed in /usr/local or elsewhere.

Kind Regards,

Bas

-- 
 GPG Key ID: 4096R/6750F10AE88D4AF1
Fingerprint: 8182 DE41 7056 408D 6146  50D1 6750 F10A E88D 4AF1

From woodbri at swoodbridge.com  Thu Feb 16 13:27:42 2017
From: woodbri at swoodbridge.com (Stephen Woodbridge)
Date: Thu, 16 Feb 2017 16:27:42 -0500
Subject: [gdal-dev] Ubuntu GDAL 1.10.1 support for ECW formats
In-Reply-To: <8dbcd092-4a5c-42fb-db19-27d62cbf73c4@xs4all.nl>
References: <c6d078cc-0902-77af-3adc-4adb65a8b4cc@swoodbridge.com>
 <8dbcd092-4a5c-42fb-db19-27d62cbf73c4@xs4all.nl>
Message-ID: <560dc100-7cc1-11ad-1104-9705b759aadd@swoodbridge.com>

On 2/16/2017 3:04 PM, Sebastiaan Couwenberg wrote:
> On 02/16/2017 08:46 PM, Stephen Woodbridge wrote:
>> Any ideas on this?
>
> ECW support is not enabled in the Debian package, that's why your client
> doesn't have it.
>
> You probably have a custom build installed in /usr/local or elsewhere.

Yes, I found that eventually. I finally decided to convert the ecw to 
jpeg compress tiff files since it was a reasonable small collection of 
files and that is working very nicely.

Thank you for your reply,
   -Steve


---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus


From boxerab at gmail.com  Thu Feb 16 16:28:06 2017
From: boxerab at gmail.com (Aaron Boxer)
Date: Thu, 16 Feb 2017 19:28:06 -0500
Subject: [gdal-dev] Seeking large lossless-encoded J2K images
In-Reply-To: <CAFLLRpK6i-oK_yTW00d7ihgEqLKbsQKxWyeQSLasvethsHbn5g@mail.gmail.com>
References: <CAK8GPyDaizMC+xcb5+uKLPQRj6gr5QdBZ6SjUtBAzFt9zw6z3Q@mail.gmail.com>
 <CAFLLRpK6i-oK_yTW00d7ihgEqLKbsQKxWyeQSLasvethsHbn5g@mail.gmail.com>
Message-ID: <CAK8GPyBkV7gfzWmPRJV=R6+P+BTHvgAnv1QuMSZ3DR9esZ9fQA@mail.gmail.com>

Cool, thanks, Rob! This is just what I was looking for.

Cheers,
Aaron

On Thu, Feb 16, 2017 at 5:55 PM, Robert Coup <robert.coup at koordinates.com>
wrote:

> Hi Aaron,
>
> LINZ has RGB aerial imagery available at http://data.linz.govt.nz/set/2
> which you can get as Lossless JP2. Maximum exported tile size is around
> 7200x10800 px though, which might not be "large" for you?
>
> Cheers,
>
> Rob :)
>
> On 16 February 2017 at 15:28, Aaron Boxer <boxerab at gmail.com> wrote:
>
>> Hello,
>>
>> I'm interested in testing decode of large lossless-encoded J2K images.
>> I have checked out Sentinel-2 and Pleides, are there other good sources
>> for this ?
>>
>> Thanks so much,
>> Aaron
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>
> --
>
> Chief Technology Officer Koordinates
>
> +44 759 987 3480 <+44%20759%209873480> / koordinates.com / @koordinates
> <https://twitter.com/koordinates>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170216/8e1bb5b1/attachment.html>

From mateusz at loskot.net  Fri Feb 17 00:40:58 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Fri, 17 Feb 2017 09:40:58 +0100
Subject: [gdal-dev] RFC 8 DevGuide Update (was: Best vector driver?)
Message-ID: <CABUeae9rCEbug8xUhMSTTdc5-gVpi8QqtCQhC3Ujhu0X-Zv1Cw@mail.gmail.com>

On 16 February 2017 at 16:10, Kurt Schwehr <schwehr at gmail.com> wrote:
> Mateusz,
>
> I have been meaning to write up a new RFC for the switch to C++11 as a
> minimum in January and then the flu caught up with me.

Kurt,

I hope you're feeling better now.

> I will try to do that in the next week or two.

No rush. I just write some new GDAL code and I'd like to write
it the 'new way' and avoid the necessary refactoring.

> In my opinion, RFC 8 could use a lot of things and I only got through 2
> documents that could feed into it last year (if I remember correctly).  One
> of which was about getting large buffers off of the stack
> (http://goo.gl/vuA3D6).  The other was a start on int bFoo -> bool bFoo
> (https://goo.gl/hdzhXD

Yes, RFC 8 needs an update, otherwise your overhaul will be going infinitely :-)

> Things that I think should be discussed/added off the top of my head in no
> particular order and only things before C++11.
>
> - When to use bool/true/false versus int/TRUE/FALSE/-1(MAYBE/UNKNOWN?).
> Expand on https://goo.gl/hdzhXD
> - namespaces
> - IWYU
> ...
> - When to use #if DEBUG_VERBOSE.  Is it okay to check in commented out code?
>
> After C++11:
>
> - Avoid bare .*alloc/new and *free/delete
> - NULL -> nullptr
> - constexpr / static_assert
> - std::initializer_list

The list is big and if we really want to document each item above
and what we discussed previously, I think we would be better off
forking https://github.com/google/styleguide and
updating the C++ Style Guidelines for GDAL.

That way, we don't reinvent the wheel in terms of "How",
we go systematic, we rely on a document structure,
which most C++ programmers are familiar with.

Despite I wouldn't mind adopting Google's document,
I, however, think we should consider a compact version of it,
not necessarily resolving all details,
not necessarily giving lots of comparative examples of bad and good code
but document that allows quick start into writing GDAL code.

Curiously, guidelines for XXI C++ programmer don't have to be ;-)
https://twitter.com/mloskot/status/310046164672196608

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From even.rouault at spatialys.com  Fri Feb 17 06:28:24 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 17 Feb 2017 15:28:24 +0100
Subject: [gdal-dev] GDAL GeoPackage Tiled Gridded Elevation test datasets
Message-ID: <5746618.44DNVOZNDm@even-i700>

Hi,

I've just committed into GDAL trunk read/write support for the GeoPackage tiled grided
elevation data extension.

I've generated a few sample datasets from SRTMHGT datasets.
They are available (under the terms of the source datasets
https://mapzen.com/documentation/terrain-tiles/attribution/ ) at :

http://even.rouault.free.fr/geopackage/N49E002_int16.gpkg
http://even.rouault.free.fr/geopackage/N45E006_uint16.gpkg
http://even.rouault.free.fr/geopackage/N49E002_float32_tiff.gpkg
http://even.rouault.free.fr/geopackage/N49E002_float32_png.gpkg

They have been generated with the following procedure:

wget https://s3.amazonaws.com/elevation-tiles-prod/skadi/N49/N49E002.hgt.gz
gunzip N49E002.hgt.gz
wget https://s3.amazonaws.com/elevation-tiles-prod/skadi/N45/N45E006.hgt.gz
gunzip N45E006.hgt.gz
gdal_translate N49E002.hgt N49E002_int16.gpkg -of GPKG --config CREATE_METADATA_TABLES NO
gdaladdo -r average N49E002_int16.gpkg 2 4 8 16
gdal_translate N49E002.hgt N49E002_float32_tiff.gpkg -of GPKG -ot Float32 -co TILE_FORMAT=TIFF  --config CREATE_METADATA_TABLES NO
gdal_translate N49E002.hgt N49E002_float32_png.gpkg -of GPKG -ot Float32 -co TILE_FORMAT=PNG --config CREATE_METADATA_TABLES NO
gdal_translate N45E006.hgt N45E006_uint16.gpkg -of GPKG -ot UInt16 -a_nodata none --config CREATE_METADATA_TABLES NO

I'd appreciate feedback from other implementation on those datasets.
And I'm still interested in, easily accessible, test datasets from other implementations.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170217/47c20d86/attachment.html>

From boxerab at gmail.com  Fri Feb 17 11:02:37 2017
From: boxerab at gmail.com (Aaron Boxer)
Date: Fri, 17 Feb 2017 14:02:37 -0500
Subject: [gdal-dev] OpenJPEG lossless encode broken
Message-ID: <CAK8GPyDkvm+RTD4r170w_EFos07oQV0OYTu+t_-t0mmbGmrfdQ@mail.gmail.com>

See https://github.com/uclouvain/openjpeg/issues/892 for further details.

Since problems occur unpredictably for various image dimensions and number
of encoder decompositions, safest approach is to avoid using the codec for
lossless until this issue is resolved.

Cheers,
Aaron
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170217/c79266c4/attachment-0001.html>

From even.rouault at spatialys.com  Fri Feb 17 11:44:17 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 17 Feb 2017 20:44:17 +0100
Subject: [gdal-dev] OpenJPEG lossless encode broken
In-Reply-To: <CAK8GPyDkvm+RTD4r170w_EFos07oQV0OYTu+t_-t0mmbGmrfdQ@mail.gmail.com>
References: <CAK8GPyDkvm+RTD4r170w_EFos07oQV0OYTu+t_-t0mmbGmrfdQ@mail.gmail.com>
Message-ID: <1491346.1JZUHGsthM@even-i700>

On vendredi 17 février 2017 14:02:37 CET Aaron Boxer wrote:
> See https://github.com/uclouvain/openjpeg/issues/892 for further details.
> 
> Since problems occur unpredictably for various image dimensions and 
number
> of encoder decompositions, safest approach is to avoid using the codec for
> lossless until this issue is resolved.
> 

Rather than completely dropping the use of lossless, people who need it and 
require true lossless can post check the result to see if it is really lossless, 
e.g. with gdalcompare.py

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170217/5ffbd401/attachment.html>

From even.rouault at spatialys.com  Fri Feb 17 12:44:43 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 17 Feb 2017 21:44:43 +0100
Subject: [gdal-dev] GDAL GeoPackage Tiled Gridded Elevation test datasets
In-Reply-To: <1487362156197.7584@caci.com>
References: <5746618.44DNVOZNDm@even-i700> <1487362156197.7584@caci.com>
Message-ID: <7053105.yaciXJBieT@even-i700>

Brian,

Thanks for your feedback.

> N45E006_uint16.gpkg?
> 
>   *   ?Missing column_name of "tile_data" in gpkg_extensions for the user
> data table entry

Fixed. Sample files regenerated with that ix and uploaded

> *   tile matrix specifies zoom levels 0 - 4, but
> elevations only exist for zoom 4 

Yes, by default gdal_translate populates the higher zoom level. Lower zoom levels may be 
optionnaly filled with gdaladdo. But I think you need to have the placeholder for the 
intermediate resolutions to satisfy the power-of-two factors (I'm not completely sure about 
that)

> *   images in tile row 14 and tile column
> 14 do not seem to contain elevations, file sizes are smaller as well (not
> sure if intentional)

Those tiles are partial due to 3601 = 14 * 256 + 17, but they are not empty:

even at even-i700:~/gdal/trunk/gdal$ gdallocationinfo N45E006_uint16.gpkg 3600 0
Report:
  Location: (3600P,0L)
  Band 1:
    Value: 3145

even at even-i700:~/gdal/trunk/gdal$ gdallocationinfo N45E006_uint16.gpkg 0 3600
Report:
  Location: (0P,3600L)
  Band 1:
    Value: 2391

> 
> Latitude: 45.0
> Longitude: 6.5
> NEAREST_NEIGHBOR: 2480.0
> BILINEAR: 2480.96875
> BICUBIC: 2480.7311287925113?

Hum, I get quite significant values:

$ gdallocationinfo N45E006_uint16.gpkg -wgs84 6.5 45
Report:
  Location: (1800P,3600L)
  Band 1:
    Value: 2296

which matches the original file:

$ gdallocationinfo N45E006.hgt -wgs84 6.5 45
Report:
  Location: (1800P,3600L)
  Band 1:
    Value: 2296

> 
> N49E002_int16.gpkg?
> 

> Latitude: 49.5
> Longitude: 2.5
> NEAREST_NEIGHBOR: 120.0
> BILINEAR: 120.46875
> BICUBIC: 120.59874286525883?

I get something closer:

$ gdallocationinfo N49E002_int16.gpkg -wgs84 2.5 49.5
Report:
  Location: (1800P,1800L)
  Band 1:
    Value: 119

> 
> 
> 
> N49E002_float32_png.gpkg

> *   gridded tiles for tile row 14 and tile column 14 have
> offsets of -32768 which is what is specified as the data_null value in the
> gridded coverage. This creates elevations of -32768.0.  Instead the data in
> the tiles should probably be -32768 if it is null.
Not completely sure to follow you on those last 2 sentences.

Those elevations at -32768 are indeed missing data due to the initial raster dimensions not 
being a multiple of the tile dimension.


> 
> N49E002_float32_tiff.gpkg
> 
>   LZW decompression is working but warning that the
> end of data was reached without an end of input code (257).  Not sure if
> this is an issue or not.

Hum, this is interesting. This is libtiff which is used to encode those tiles. Wondering if this is 
not this bug that may be hit:
http://bugzilla.maptools.org/show_bug.cgi?id=1982


Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170217/c3ec09c3/attachment.html>

From schwehr at gmail.com  Sat Feb 18 04:25:54 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Sat, 18 Feb 2017 04:25:54 -0800
Subject: [gdal-dev] GDAL unable to write 4-band RGBA jp2 file with
	Kakadu 7.8
In-Reply-To: <CACmBxyvJQtJNuJxXAo+KoGp4BTpC8aJ+Sjny+86BMtyn+hT9jQ@mail.gmail.com>
References: <1487045644428-5307801.post@n6.nabble.com>
 <CACmBxyvJQtJNuJxXAo+KoGp4BTpC8aJ+Sjny+86BMtyn+hT9jQ@mail.gmail.com>
Message-ID: <CACmBxytzKK=cNY_tLKFbdpz2YgHaP1-M+ZQm=o7zvifh2LWx_A@mail.gmail.com>

Jason,

Turns out you are hitting a known bug in v7.8 that is fixed in v7.9.  From
the kakadu v7.9 docs:

h. Corrected a tiny, yet very significant bug introduced into the
   handling of opacity channel descriptions in version 7.8.  The
   correction is in function `jp2_channels::set_opacity_mapping', where
   the opacity channel's component index accidentally overwrote the
   colour channel's component index.

It's pretty easy to backport the fix if you are currently stuck at 7.8.
It's just a change of a 0 to a 1.

--- kakadu/v7_8/apps/jp2/jp2.cpp
+++ kakadu/v7_9/apps/jp2/jp2.cpp
@@ -5976,7 +5976,7 @@
   if (lut_idx < 0)
     lut_idx = -1; // For consistency in comparisons later on.
   j2_channels::j2_channel *cp = state->channels+colour_idx;
-  cp->component_idx[0] = codestream_component;
+  cp->component_idx[1] = codestream_component; /* Was a bug in version 7.8
*/
   cp->lut_idx[1] = lut_idx;
   cp->codestream_idx[1] = codestream_idx;
   cp->data_format[1] = data_format;

The 0 can trigger an error that looks just like you are seeing:

Error: GdalIO: Error in Kakadu File Format Support: Attempting to create a
Component Mapping (cmap) box, one of whose channels refers to a
non-existent image component or palette lookup table. (code = 1)



On Mon, Feb 13, 2017 at 9:28 PM, Kurt Schwehr <schwehr at gmail.com> wrote:

> Hi Jason,
>
> I've seen the same thing with an alpha channel.  I'm not sure what's up.
> Using just RGB was successful.
>
> On 7.3, I'm also seeing problems when using more than the main thread on
> linux.
>
> With 7.3, I just noticed today that kdu_get_num_processors() only returns
> 0 on linux as kdu_arch.cpp is missing #include <unistd.h> so
> _SC_NPROCESSORS_ONLN and _SC_NPROCESSORS_CONF are undefined.  When I
> enabled _SC_NPROCESSORS_ONLN, I got kdu_get_num_processors() returning 74
> on what I thought was a 6 core (aka 12 hyperthread) box.   If I change the
> fall through from 0 to 2, I get all sorts of trouble from internal kakadu
> assertions and TSAN failures.
>
> So I clearly have more investigating to do.
>
> I've yet to pass along any of what I've found to Taubman and I haven't yet
> pushed any of my new tests to github, but I hope to do both soon.
>
> And I've yet to see what, if any, discussion is happening in the yahoo
> group.
>
> -kurt
>
> On Mon, Feb 13, 2017 at 8:14 PM, jason.liu <jason.liu at spookfish.com>
> wrote:
>
>> Hi gdal-dev,
>>
>> I am having trouble using GDAL to write 4-band RGBA jp2 file with Kakadu
>> 7.8. The following minimal code
>>
>>
>>     GDALAllRegister();
>>
>>     GDALDataset* srcDataset =
>> (GDALDataset*)GDALOpen("/home/jason.liu/00000783.tif", GA_ReadOnly);
>>     char **papszOptions = NULL;
>>     papszOptions = CSLSetNameValue( papszOptions, "QUALITY", "20" );
>>
>>     GDALDriver *driver = GetGDALDriverManager()->GetDri
>> verByName("JP2KAK");
>>     GDALDataset* destDataset =
>> driver->CreateCopy("/home/jason.liu/00000783.jp2",
>>                                                   srcDataset,
>>                                                   FALSE,
>>                                                   papszOptions,
>>                                                   NULL,
>>                                                   NULL);
>>
>>     if( destDataset != NULL ) {
>>         GDALClose( (GDALDatasetH) destDataset );
>>     }
>>     GDALClose( (GDALDatasetH) srcDataset );
>>     CSLDestroy(papszOptions);
>>
>>
>> crashes Kakadu 7.8 with the following message in stderr:
>>
>> ERROR 1: Error in Kakadu File Format Support:
>> Attempting to create a Component Mapping (cmap) box, one of whose channels
>> refers to a non-existent image component or palette lookup table.
>> terminate called after throwing an instance of
>> 'kdu_cpl_error_message::JP2KAKException'
>>
>>
>> where /home/jason.liu/00000783.tif is a 4-band 16-bit RGBA tif.
>>
>>
>> I have also done the following tests and noted the results:
>>
>> 3-band 8-bit RGB tif            OK
>> 3-band 16-bit RGB tif          OK
>> 4-band 8-bit RGBA tif          error as above
>> 4-band 16-bit RGBA tif        error as above
>>
>>
>> Am I doing anything wrong here?
>>
>> By the way, I am quite certain Kakadu 7.8 supports 4-band RGBA as I can
>> use
>> their example kdu_compress to produce 4-band RGBA jp2 images. So this
>> looks
>> to be a problem with GDAL, or the way I am invoking it.
>>
>>
>> Any insights will be greatly appreciated.
>>
>> Kind Regards
>> Jason
>>
>>
>>
>>
>> --
>> View this message in context: http://osgeo-org.1560.x6.nabbl
>> e.com/GDAL-unable-to-write-4-band-RGBA-jp2-file-with-
>> Kakadu-7-8-tp5307801.html
>> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
> --
> --
> http://schwehr.org
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170218/17fdca31/attachment-0001.html>

From boxerab at gmail.com  Sat Feb 18 05:03:34 2017
From: boxerab at gmail.com (Aaron Boxer)
Date: Sat, 18 Feb 2017 08:03:34 -0500
Subject: [gdal-dev] Fwd: Re: GDAL unable to write 4-band RGBA jp2 file with
 Kakadu 7.8
In-Reply-To: <CAK8GPyDp7kwEs1bAYnw5m5M2HJGRbbVv_yQ5UGw10JDaHbs=0A@mail.gmail.com>
References: <1487045644428-5307801.post@n6.nabble.com>
 <CACmBxyvJQtJNuJxXAo+KoGp4BTpC8aJ+Sjny+86BMtyn+hT9jQ@mail.gmail.com>
 <CACmBxytzKK=cNY_tLKFbdpz2YgHaP1-M+ZQm=o7zvifh2LWx_A@mail.gmail.com>
 <CAK8GPyDp7kwEs1bAYnw5m5M2HJGRbbVv_yQ5UGw10JDaHbs=0A@mail.gmail.com>
Message-ID: <CAK8GPyDkRsLPdX=mFVkZmMz_PBGTnBzee5rpRUK0so=NXPOHzQ@mail.gmail.com>

---------- Forwarded message ----------
From: "Aaron Boxer" <boxerab at gmail.com>
Date: Feb 18, 2017 8:03 AM
Subject: Re: [gdal-dev] GDAL unable to write 4-band RGBA jp2 file with
Kakadu 7.8
To: "Kurt Schwehr" <schwehr at gmail.com>
Cc:



On Feb 18, 2017 7:26 AM, "Kurt Schwehr" <schwehr at gmail.com> wrote:

Jason,

Turns out you are hitting a known bug in v7.8 that is fixed in v7.9.  From
the kakadu v7.9 docs:

h. Corrected a tiny, yet very significant bug introduced into the
   handling of opacity channel descriptions in version 7.8.  The
   correction is in function `jp2_channels::set_opacity_mapping', where
   the opacity channel's component index accidentally overwrote the
   colour channel's component index.


Apparently Kakadu does no regression testing before a release 😁



It's pretty easy to backport the fix if you are currently stuck at 7.8.
It's just a change of a 0 to a 1.

--- kakadu/v7_8/apps/jp2/jp2.cpp
+++ kakadu/v7_9/apps/jp2/jp2.cpp
@@ -5976,7 +5976,7 @@
   if (lut_idx < 0)
     lut_idx = -1; // For consistency in comparisons later on.
   j2_channels::j2_channel *cp = state->channels+colour_idx;
-  cp->component_idx[0] = codestream_component;
+  cp->component_idx[1] = codestream_component; /* Was a bug in version 7.8
*/
   cp->lut_idx[1] = lut_idx;
   cp->codestream_idx[1] = codestream_idx;
   cp->data_format[1] = data_format;

The 0 can trigger an error that looks just like you are seeing:

Error: GdalIO: Error in Kakadu File Format Support: Attempting to create a
Component Mapping (cmap) box, one of whose channels refers to a
non-existent image component or palette lookup table. (code = 1)



On Mon, Feb 13, 2017 at 9:28 PM, Kurt Schwehr <schwehr at gmail.com> wrote:

> Hi Jason,
>
> I've seen the same thing with an alpha channel.  I'm not sure what's up.
> Using just RGB was successful.
>
> On 7.3, I'm also seeing problems when using more than the main thread on
> linux.
>
> With 7.3, I just noticed today that kdu_get_num_processors() only returns
> 0 on linux as kdu_arch.cpp is missing #include <unistd.h> so
> _SC_NPROCESSORS_ONLN and _SC_NPROCESSORS_CONF are undefined.  When I
> enabled _SC_NPROCESSORS_ONLN, I got kdu_get_num_processors() returning 74
> on what I thought was a 6 core (aka 12 hyperthread) box.   If I change the
> fall through from 0 to 2, I get all sorts of trouble from internal kakadu
> assertions and TSAN failures.
>
> So I clearly have more investigating to do.
>
> I've yet to pass along any of what I've found to Taubman and I haven't yet
> pushed any of my new tests to github, but I hope to do both soon.
>
> And I've yet to see what, if any, discussion is happening in the yahoo
> group.
>
> -kurt
>
> On Mon, Feb 13, 2017 at 8:14 PM, jason.liu <jason.liu at spookfish.com>
> wrote:
>
>> Hi gdal-dev,
>>
>> I am having trouble using GDAL to write 4-band RGBA jp2 file with Kakadu
>> 7.8. The following minimal code
>>
>>
>>     GDALAllRegister();
>>
>>     GDALDataset* srcDataset =
>> (GDALDataset*)GDALOpen("/home/jason.liu/00000783.tif", GA_ReadOnly);
>>     char **papszOptions = NULL;
>>     papszOptions = CSLSetNameValue( papszOptions, "QUALITY", "20" );
>>
>>     GDALDriver *driver = GetGDALDriverManager()->GetDri
>> verByName("JP2KAK");
>>     GDALDataset* destDataset =
>> driver->CreateCopy("/home/jason.liu/00000783.jp2",
>>                                                   srcDataset,
>>                                                   FALSE,
>>                                                   papszOptions,
>>                                                   NULL,
>>                                                   NULL);
>>
>>     if( destDataset != NULL ) {
>>         GDALClose( (GDALDatasetH) destDataset );
>>     }
>>     GDALClose( (GDALDatasetH) srcDataset );
>>     CSLDestroy(papszOptions);
>>
>>
>> crashes Kakadu 7.8 with the following message in stderr:
>>
>> ERROR 1: Error in Kakadu File Format Support:
>> Attempting to create a Component Mapping (cmap) box, one of whose channels
>> refers to a non-existent image component or palette lookup table.
>> terminate called after throwing an instance of
>> 'kdu_cpl_error_message::JP2KAKException'
>>
>>
>> where /home/jason.liu/00000783.tif is a 4-band 16-bit RGBA tif.
>>
>>
>> I have also done the following tests and noted the results:
>>
>> 3-band 8-bit RGB tif            OK
>> 3-band 16-bit RGB tif          OK
>> 4-band 8-bit RGBA tif          error as above
>> 4-band 16-bit RGBA tif        error as above
>>
>>
>> Am I doing anything wrong here?
>>
>> By the way, I am quite certain Kakadu 7.8 supports 4-band RGBA as I can
>> use
>> their example kdu_compress to produce 4-band RGBA jp2 images. So this
>> looks
>> to be a problem with GDAL, or the way I am invoking it.
>>
>>
>> Any insights will be greatly appreciated.
>>
>> Kind Regards
>> Jason
>>
>>
>>
>>
>> --
>> View this message in context: http://osgeo-org.1560.x6.nabbl
>> e.com/GDAL-unable-to-write-4-band-RGBA-jp2-file-with-Kakadu-
>> 7-8-tp5307801.html
>> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
> --
> --
> http://schwehr.org
>



-- 
--
http://schwehr.org

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170218/b5aa55d8/attachment.html>

From schwehr at gmail.com  Sat Feb 18 05:14:17 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Sat, 18 Feb 2017 05:14:17 -0800
Subject: [gdal-dev] Fwd: Re: GDAL unable to write 4-band RGBA jp2 file
 with Kakadu 7.8
In-Reply-To: <CAK8GPyDkRsLPdX=mFVkZmMz_PBGTnBzee5rpRUK0so=NXPOHzQ@mail.gmail.com>
References: <1487045644428-5307801.post@n6.nabble.com>
 <CACmBxyvJQtJNuJxXAo+KoGp4BTpC8aJ+Sjny+86BMtyn+hT9jQ@mail.gmail.com>
 <CACmBxytzKK=cNY_tLKFbdpz2YgHaP1-M+ZQm=o7zvifh2LWx_A@mail.gmail.com>
 <CAK8GPyDp7kwEs1bAYnw5m5M2HJGRbbVv_yQ5UGw10JDaHbs=0A@mail.gmail.com>
 <CAK8GPyDkRsLPdX=mFVkZmMz_PBGTnBzee5rpRUK0so=NXPOHzQ@mail.gmail.com>
Message-ID: <CACmBxyvrXyaO8pLOGxuYa8oJRB5+CHqfZLkDsGGwAgD6Obw7tQ@mail.gmail.com>

Well,  I made a start as a part of gdal-autotest2...

https://github.com/schwehr/gdal-autotest2/blob/master/cpp/third_party/kakadu/coresys/common/kdu_arch_test.cc

On Sat, Feb 18, 2017 at 5:03 AM, Aaron Boxer <boxerab at gmail.com> wrote:

> ---------- Forwarded message ----------
> From: "Aaron Boxer" <boxerab at gmail.com>
> Date: Feb 18, 2017 8:03 AM
> Subject: Re: [gdal-dev] GDAL unable to write 4-band RGBA jp2 file with
> Kakadu 7.8
> To: "Kurt Schwehr" <schwehr at gmail.com>
> Cc:
>
>
>
> On Feb 18, 2017 7:26 AM, "Kurt Schwehr" <schwehr at gmail.com> wrote:
>
> Jason,
>
> Turns out you are hitting a known bug in v7.8 that is fixed in v7.9.  From
> the kakadu v7.9 docs:
>
> h. Corrected a tiny, yet very significant bug introduced into the
>    handling of opacity channel descriptions in version 7.8.  The
>    correction is in function `jp2_channels::set_opacity_mapping', where
>    the opacity channel's component index accidentally overwrote the
>    colour channel's component index.
>
>
> Apparently Kakadu does no regression testing before a release 😁
>
>
>
> It's pretty easy to backport the fix if you are currently stuck at 7.8.
> It's just a change of a 0 to a 1.
>
> --- kakadu/v7_8/apps/jp2/jp2.cpp
> +++ kakadu/v7_9/apps/jp2/jp2.cpp
> @@ -5976,7 +5976,7 @@
>    if (lut_idx < 0)
>      lut_idx = -1; // For consistency in comparisons later on.
>    j2_channels::j2_channel *cp = state->channels+colour_idx;
> -  cp->component_idx[0] = codestream_component;
> +  cp->component_idx[1] = codestream_component; /* Was a bug in version
> 7.8 */
>    cp->lut_idx[1] = lut_idx;
>    cp->codestream_idx[1] = codestream_idx;
>    cp->data_format[1] = data_format;
>
> The 0 can trigger an error that looks just like you are seeing:
>
> Error: GdalIO: Error in Kakadu File Format Support: Attempting to create a
> Component Mapping (cmap) box, one of whose channels refers to a
> non-existent image component or palette lookup table. (code = 1)
>
>
>
> On Mon, Feb 13, 2017 at 9:28 PM, Kurt Schwehr <schwehr at gmail.com> wrote:
>
>> Hi Jason,
>>
>> I've seen the same thing with an alpha channel.  I'm not sure what's up.
>> Using just RGB was successful.
>>
>> On 7.3, I'm also seeing problems when using more than the main thread on
>> linux.
>>
>> With 7.3, I just noticed today that kdu_get_num_processors() only returns
>> 0 on linux as kdu_arch.cpp is missing #include <unistd.h> so
>> _SC_NPROCESSORS_ONLN and _SC_NPROCESSORS_CONF are undefined.  When I
>> enabled _SC_NPROCESSORS_ONLN, I got kdu_get_num_processors() returning 74
>> on what I thought was a 6 core (aka 12 hyperthread) box.   If I change the
>> fall through from 0 to 2, I get all sorts of trouble from internal kakadu
>> assertions and TSAN failures.
>>
>> So I clearly have more investigating to do.
>>
>> I've yet to pass along any of what I've found to Taubman and I haven't
>> yet pushed any of my new tests to github, but I hope to do both soon.
>>
>> And I've yet to see what, if any, discussion is happening in the yahoo
>> group.
>>
>> -kurt
>>
>> On Mon, Feb 13, 2017 at 8:14 PM, jason.liu <jason.liu at spookfish.com>
>> wrote:
>>
>>> Hi gdal-dev,
>>>
>>> I am having trouble using GDAL to write 4-band RGBA jp2 file with Kakadu
>>> 7.8. The following minimal code
>>>
>>>
>>>     GDALAllRegister();
>>>
>>>     GDALDataset* srcDataset =
>>> (GDALDataset*)GDALOpen("/home/jason.liu/00000783.tif", GA_ReadOnly);
>>>     char **papszOptions = NULL;
>>>     papszOptions = CSLSetNameValue( papszOptions, "QUALITY", "20" );
>>>
>>>     GDALDriver *driver = GetGDALDriverManager()->GetDri
>>> verByName("JP2KAK");
>>>     GDALDataset* destDataset =
>>> driver->CreateCopy("/home/jason.liu/00000783.jp2",
>>>                                                   srcDataset,
>>>                                                   FALSE,
>>>                                                   papszOptions,
>>>                                                   NULL,
>>>                                                   NULL);
>>>
>>>     if( destDataset != NULL ) {
>>>         GDALClose( (GDALDatasetH) destDataset );
>>>     }
>>>     GDALClose( (GDALDatasetH) srcDataset );
>>>     CSLDestroy(papszOptions);
>>>
>>>
>>> crashes Kakadu 7.8 with the following message in stderr:
>>>
>>> ERROR 1: Error in Kakadu File Format Support:
>>> Attempting to create a Component Mapping (cmap) box, one of whose
>>> channels
>>> refers to a non-existent image component or palette lookup table.
>>> terminate called after throwing an instance of
>>> 'kdu_cpl_error_message::JP2KAKException'
>>>
>>>
>>> where /home/jason.liu/00000783.tif is a 4-band 16-bit RGBA tif.
>>>
>>>
>>> I have also done the following tests and noted the results:
>>>
>>> 3-band 8-bit RGB tif            OK
>>> 3-band 16-bit RGB tif          OK
>>> 4-band 8-bit RGBA tif          error as above
>>> 4-band 16-bit RGBA tif        error as above
>>>
>>>
>>> Am I doing anything wrong here?
>>>
>>> By the way, I am quite certain Kakadu 7.8 supports 4-band RGBA as I can
>>> use
>>> their example kdu_compress to produce 4-band RGBA jp2 images. So this
>>> looks
>>> to be a problem with GDAL, or the way I am invoking it.
>>>
>>>
>>> Any insights will be greatly appreciated.
>>>
>>> Kind Regards
>>> Jason
>>>
>>>
>>>
>>>
>>> --
>>> View this message in context: http://osgeo-org.1560.x6.nabbl
>>> e.com/GDAL-unable-to-write-4-band-RGBA-jp2-file-with-Kakadu-
>>> 7-8-tp5307801.html
>>> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>
>>
>>
>> --
>> --
>> http://schwehr.org
>>
>
>
>
> --
> --
> http://schwehr.org
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170218/45d851d6/attachment-0001.html>

From woodbri at swoodbridge.com  Sun Feb 19 07:15:20 2017
From: woodbri at swoodbridge.com (Stephen Woodbridge)
Date: Sun, 19 Feb 2017 10:15:20 -0500
Subject: [gdal-dev] Help working with hdf5 images
Message-ID: <9e302509-b1e8-840b-b183-a8ed8243fee6@swoodbridge.com>

Hi all,

I'm trying to create GTiff files from IMARS Modis hdf5 images. I did 
something like this about 3-4 years ago when they were using hdf4 
datasets but things have changed since then. So I have two questions:

1. How do I extract the sst data (subdataset 3) into a GTiff and create 
a mask band from the sst_count (subdataset 4) which has value 0 or 1, 
where 1 is valid sst data?

2. The data is in Equidistant_Cylindrical / World Geodetic System 1984 
which does not seem to be represent able as a proj4 format and I need to 
reproject into EPSG:4326

In the past I used the both the gcoos and seacoos images for a given 
time slot like:

gdal_translate -of GTiff -ot Int16 -a_srs EPSG:4326  -a_ullr $ullr 
-scale 0 50 0 10000 $filename $tmpfile

where $ullr is correct for the image and then used gdal_merge to combine 
the two images using:

gdal_merge -of GTiff -co TILED=YES -ot Int16 -o $target <list of input 
files>

But this does not work because when I merge the images they are offset 
and I need to apply the mask so the images are transparent where there 
is no data.

I guess this is my week to ask lots of gdal related question.

Thanks,
   -Steve

ftp://imars.marine.usf.edu/modis/imars/final/pass/1km/sst/gcoos/2017.02/aqua.20170217.0645.gcoos.sst.h5

----------------------------------------------- hdf5 file --------------
$ gdalinfo aqua.20170217.0645.gcoos.sst.h5
Driver: HDF5/Hierarchical Data Format Release 5
Files: aqua.20170217.0645.gcoos.sst.h5
Size is 512, 512
Coordinate System is `'
Metadata:
   bands_l2_flags_CLASS=IMAGE
   bands_l2_flags_count_CLASS=IMAGE
   bands_l2_flags_count_description=Count of l2_flags
   bands_l2_flags_count_IMAGE_VERSION=1.2
   bands_l2_flags_count_log10_scaled=false
   bands_l2_flags_count_raster_height=1447
   bands_l2_flags_count_raster_width=2115
   bands_l2_flags_count_scaling_factor=1
   bands_l2_flags_count_scaling_offset=0
   bands_l2_flags_description=l2_flags
   bands_l2_flags_IMAGE_VERSION=1.2
   bands_l2_flags_log10_scaled=false
   bands_l2_flags_raster_height=1447
   bands_l2_flags_raster_width=2115
   bands_l2_flags_scaling_factor=1
   bands_l2_flags_scaling_offset=0
   bands_sst_CLASS=IMAGE
   bands_sst_count_CLASS=IMAGE
   bands_sst_count_description=Count of sst
   bands_sst_count_IMAGE_VERSION=1.2
   bands_sst_count_log10_scaled=false
   bands_sst_count_raster_height=1447
   bands_sst_count_raster_width=2115
   bands_sst_count_scaling_factor=1
   bands_sst_count_scaling_offset=0
   bands_sst_description=sst
   bands_sst_IMAGE_VERSION=1.2
   bands_sst_log10_scaled=false
   bands_sst_raster_height=1447
   bands_sst_raster_width=2115
   bands_sst_scaling_factor=1
   bands_sst_scaling_offset=0
   metadata_Processing_Graph_node.0_authors=Marco Peters, Ralf Quast, 
Marco Zühlk
   metadata_Processing_Graph_node.0_copyright=(c) 2009 by Brockmann Consult
   metadata_Processing_Graph_node.0_id=Mosaic$15A4BDE1324
   metadata_Processing_Graph_node.0_moduleName=beam-gpf
   metadata_Processing_Graph_node.0_moduleVersion=5.0.5
   metadata_Processing_Graph_node.0_operator=Mosaic
   metadata_Processing_Graph_node.0_parameters_combine=OR
 
metadata_Processing_Graph_node.0_parameters_crs=PROJCS["Equidistant_Cylindrical 
/ World Geodetic System 1984",
       GEOGCS["World Geodetic System 1984",
         DATUM["World Geodetic System 1984",
           SPHEROID["WGS 84", 6378137.0, 298.257223563, 
AUTHORITY["EPSG","7030"]],
           AUTHORITY["EPSG","6326"]],
         PRIMEM["Greenwich", 0.0, AUTHORITY["EPSG","8901"]],
         UNIT["degree", 0.017453292519943295],
         AXIS["Geodetic longitude", EAST],
         AXIS["Geodetic latitude", NORTH]],
       PROJECTION["Equidistant_Cylindrical"],
       PARAMETER["central_meridian", 0.0],
       PARAMETER["latitude_of_origin", 0.0],
       PARAMETER["standard_parallel_1", 0.0],
       PARAMETER["false_easting", 0.0],
       PARAMETER["false_northing", 0.0],
       UNIT["m", 1.0],
       AXIS["Easting", EAST],
       AXIS["Northing", NORTH]]
   metadata_Processing_Graph_node.0_parameters_eastBound=-79.0
   metadata_Processing_Graph_node.0_parameters_northBound=31.0
   metadata_Processing_Graph_node.0_parameters_orthorectify=false
   metadata_Processing_Graph_node.0_parameters_pixelSizeX=1000.0
   metadata_Processing_Graph_node.0_parameters_pixelSizeY=1000.0
   metadata_Processing_Graph_node.0_parameters_resampling=Nearest
   metadata_Processing_Graph_node.0_parameters_southBound=18.0
 
metadata_Processing_Graph_node.0_parameters_variables_variable.0_expression=sst
   metadata_Processing_Graph_node.0_parameters_variables_variable.0_name=sst
 
metadata_Processing_Graph_node.0_parameters_variables_variable.1_expression=l2_flags
 
metadata_Processing_Graph_node.0_parameters_variables_variable.1_name=l2_flags
   metadata_Processing_Graph_node.0_parameters_westBound=-98.0
   metadata_Processing_Graph_node.0_processingTime=2017-02-17T11:38:49.524Z
   metadata_Processing_Graph_node.0_purpose=Creates a mosaic out of a 
set of source products.
 
metadata_Processing_Graph_node.0_sources_sourceProduct.1=file:/home/ipopp/temp/aqua.SST.FILTERED.17048065000_mapped.dim
 
metadata_Processing_Graph_node.0_sources_sourceProduct.2=file:/home/ipopp/temp/aqua.SST.FILTERED.17048065500_mapped.dim
   metadata_Processing_Graph_node.0_version=1.0
Subdatasets:
   SUBDATASET_1_NAME=HDF5:"aqua.20170217.0645.gcoos.sst.h5"://bands/l2_flags
   SUBDATASET_1_DESC=[1447x2115] //bands/l2_flags (32-bit floating-point)
 
SUBDATASET_2_NAME=HDF5:"aqua.20170217.0645.gcoos.sst.h5"://bands/l2_flags_count
   SUBDATASET_2_DESC=[1447x2115] //bands/l2_flags_count (32-bit integer)
   SUBDATASET_3_NAME=HDF5:"aqua.20170217.0645.gcoos.sst.h5"://bands/sst
   SUBDATASET_3_DESC=[1447x2115] //bands/sst (32-bit floating-point)
 
SUBDATASET_4_NAME=HDF5:"aqua.20170217.0645.gcoos.sst.h5"://bands/sst_count
   SUBDATASET_4_DESC=[1447x2115] //bands/sst_count (32-bit integer)
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0,  512.0)
Upper Right (  512.0,    0.0)
Lower Right (  512.0,  512.0)
Center      (  256.0,  256.0)

-------------- HDF5:"aqua.20170217.0645.gcoos.sst.h5"://bands/sst -----
$ gdalinfo HDF5:"aqua.20170217.0645.gcoos.sst.h5"://bands/sst
Driver: HDF5Image/HDF5 Dataset
Files: aqua.20170217.0645.gcoos.sst.h5
        aqua.20170217.0645.gcoos.sst.h5.aux.xml
Size is 2115, 1447
Coordinate System is `'
Metadata:
   metadata_Processing_Graph_node.0_authors=Marco Peters, Ralf Quast, 
Marco Zühlk
   metadata_Processing_Graph_node.0_copyright=(c) 2009 by Brockmann Consult
   metadata_Processing_Graph_node.0_id=Mosaic$15A4BDE1324
   metadata_Processing_Graph_node.0_moduleName=beam-gpf
   metadata_Processing_Graph_node.0_moduleVersion=5.0.5
   metadata_Processing_Graph_node.0_operator=Mosaic
   metadata_Processing_Graph_node.0_parameters_combine=OR
 
metadata_Processing_Graph_node.0_parameters_crs=PROJCS["Equidistant_Cylindrical 
/ World Geodetic System 1984",
       GEOGCS["World Geodetic System 1984",
         DATUM["World Geodetic System 1984",
           SPHEROID["WGS 84", 6378137.0, 298.257223563, 
AUTHORITY["EPSG","7030"]],
           AUTHORITY["EPSG","6326"]],
         PRIMEM["Greenwich", 0.0, AUTHORITY["EPSG","8901"]],
         UNIT["degree", 0.017453292519943295],
         AXIS["Geodetic longitude", EAST],
         AXIS["Geodetic latitude", NORTH]],
       PROJECTION["Equidistant_Cylindrical"],
       PARAMETER["central_meridian", 0.0],
       PARAMETER["latitude_of_origin", 0.0],
       PARAMETER["standard_parallel_1", 0.0],
       PARAMETER["false_easting", 0.0],
       PARAMETER["false_northing", 0.0],
       UNIT["m", 1.0],
       AXIS["Easting", EAST],
       AXIS["Northing", NORTH]]
   metadata_Processing_Graph_node.0_parameters_eastBound=-79.0
   metadata_Processing_Graph_node.0_parameters_northBound=31.0
   metadata_Processing_Graph_node.0_parameters_orthorectify=false
   metadata_Processing_Graph_node.0_parameters_pixelSizeX=1000.0
   metadata_Processing_Graph_node.0_parameters_pixelSizeY=1000.0
   metadata_Processing_Graph_node.0_parameters_resampling=Nearest
   metadata_Processing_Graph_node.0_parameters_southBound=18.0
 
metadata_Processing_Graph_node.0_parameters_variables_variable.0_expression=sst
   metadata_Processing_Graph_node.0_parameters_variables_variable.0_name=sst
 
metadata_Processing_Graph_node.0_parameters_variables_variable.1_expression=l2_flags
 
metadata_Processing_Graph_node.0_parameters_variables_variable.1_name=l2_flags
   metadata_Processing_Graph_node.0_parameters_westBound=-98.0
   metadata_Processing_Graph_node.0_processingTime=2017-02-17T11:38:49.524Z
   metadata_Processing_Graph_node.0_purpose=Creates a mosaic out of a 
set of source products.
 
metadata_Processing_Graph_node.0_sources_sourceProduct.1=file:/home/ipopp/temp/aqua.SST.FILTERED.17048065000_mapped.dim
 
metadata_Processing_Graph_node.0_sources_sourceProduct.2=file:/home/ipopp/temp/aqua.SST.FILTERED.17048065500_mapped.dim
   metadata_Processing_Graph_node.0_version=1.0
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0, 1447.0)
Upper Right ( 2115.0,    0.0)
Lower Right ( 2115.0, 1447.0)
Center      ( 1057.5,  723.5)
Band 1 Block=2115x1 Type=Float32, ColorInterp=Undefined
   Min=0.000 Max=27.285
   Minimum=0.000, Maximum=27.285, Mean=1.329, StdDev=5.395
   Metadata:
     bands_sst_CLASS=IMAGE
     bands_sst_description=sst
     bands_sst_IMAGE_VERSION=1.2
     bands_sst_log10_scaled=false
     bands_sst_raster_height=1447
     bands_sst_raster_width=2115
     bands_sst_scaling_factor=1
     bands_sst_scaling_offset=0
     STATISTICS_MAXIMUM=27.284999847412
     STATISTICS_MEAN=1.3292428022154
     STATISTICS_MINIMUM=0
     STATISTICS_STDDEV=5.3949041458808

---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus


From woodbri at swoodbridge.com  Sun Feb 19 20:32:56 2017
From: woodbri at swoodbridge.com (Stephen Woodbridge)
Date: Sun, 19 Feb 2017 23:32:56 -0500
Subject: [gdal-dev] Help working with hdf5 images
In-Reply-To: <9e302509-b1e8-840b-b183-a8ed8243fee6@swoodbridge.com>
References: <9e302509-b1e8-840b-b183-a8ed8243fee6@swoodbridge.com>
Message-ID: <6af231c4-7d30-1e7c-b328-1a1ff8fea566@swoodbridge.com>

On 2/19/2017 10:15 AM, Stephen Woodbridge wrote:
> Hi all,
>
> I'm trying to create GTiff files from IMARS Modis hdf5 images. I did
> something like this about 3-4 years ago when they were using hdf4
> datasets but things have changed since then. So I have two questions:
>
> 1. How do I extract the sst data (subdataset 3) into a GTiff and create
> a mask band from the sst_count (subdataset 4) which has value 0 or 1,
> where 1 is valid sst data?

OK, I think I have figured out part of this:

gdal_translate -of GTiff -a_srs EPSG:4326 -a_ullr $ullr -sds infile.h5 
tempfile

echo tempfile3 > temp.in  # add sds 3 the sst data
echo tempfile4 >> temp.in # add sds 4 the stt_count data

# stack the bands
gdalbuildvrt -separate -input_file_list temp.in tempfile.vrt

create a tif with mask from the stacked bands
gdal_translate -b 1 -mask 2 -co TILED=YES -ot Int16 -scale 0 50 0 10000 
tempfile.vrt tempfile.tif

# tile areas for a given time slot
gdal_merge -of GTiff -co TILED=YES -ot Int16 -o target.tif <list of files>

# manually create a vrt file with color table for target.tif (target.vrt)

# and for debug visualization
gdal_translate -of PNG -scale 0 10000 target.vrt target.png

This still has problems with the adjacent overlapping areas not being 
georeferenced correctly and the mask is not getting applied during the 
merge as can be seen here:

http://imaptools.com:8080/dl/IMARS_SST-201702190815.png

You can see that the lower left image has another layered on top of it 
shifted north and east and then image has a square corner of black 
blotting out part of the lower left image. The IMARS data has gcoos and 
seacoos areas that overlap but for the same time slot the images should 
be able to be merged.

-Steve

> 2. The data is in Equidistant_Cylindrical / World Geodetic System 1984
> which does not seem to be represent able as a proj4 format and I need to
> reproject into EPSG:4326
>
> In the past I used the both the gcoos and seacoos images for a given
> time slot like:
>
> gdal_translate -of GTiff -ot Int16 -a_srs EPSG:4326  -a_ullr $ullr
> -scale 0 50 0 10000 $filename $tmpfile
>
> where $ullr is correct for the image and then used gdal_merge to combine
> the two images using:
>
> gdal_merge -of GTiff -co TILED=YES -ot Int16 -o $target <list of input
> files>
>
> But this does not work because when I merge the images they are offset
> and I need to apply the mask so the images are transparent where there
> is no data.
>
> I guess this is my week to ask lots of gdal related question.
>
> Thanks,
>   -Steve
>
> ftp://imars.marine.usf.edu/modis/imars/final/pass/1km/sst/gcoos/2017.02/aqua.20170217.0645.gcoos.sst.h5
>
>
> ----------------------------------------------- hdf5 file --------------
> $ gdalinfo aqua.20170217.0645.gcoos.sst.h5
> Driver: HDF5/Hierarchical Data Format Release 5
> Files: aqua.20170217.0645.gcoos.sst.h5
> Size is 512, 512
> Coordinate System is `'
> Metadata:
>   bands_l2_flags_CLASS=IMAGE
>   bands_l2_flags_count_CLASS=IMAGE
>   bands_l2_flags_count_description=Count of l2_flags
>   bands_l2_flags_count_IMAGE_VERSION=1.2
>   bands_l2_flags_count_log10_scaled=false
>   bands_l2_flags_count_raster_height=1447
>   bands_l2_flags_count_raster_width=2115
>   bands_l2_flags_count_scaling_factor=1
>   bands_l2_flags_count_scaling_offset=0
>   bands_l2_flags_description=l2_flags
>   bands_l2_flags_IMAGE_VERSION=1.2
>   bands_l2_flags_log10_scaled=false
>   bands_l2_flags_raster_height=1447
>   bands_l2_flags_raster_width=2115
>   bands_l2_flags_scaling_factor=1
>   bands_l2_flags_scaling_offset=0
>   bands_sst_CLASS=IMAGE
>   bands_sst_count_CLASS=IMAGE
>   bands_sst_count_description=Count of sst
>   bands_sst_count_IMAGE_VERSION=1.2
>   bands_sst_count_log10_scaled=false
>   bands_sst_count_raster_height=1447
>   bands_sst_count_raster_width=2115
>   bands_sst_count_scaling_factor=1
>   bands_sst_count_scaling_offset=0
>   bands_sst_description=sst
>   bands_sst_IMAGE_VERSION=1.2
>   bands_sst_log10_scaled=false
>   bands_sst_raster_height=1447
>   bands_sst_raster_width=2115
>   bands_sst_scaling_factor=1
>   bands_sst_scaling_offset=0
>   metadata_Processing_Graph_node.0_authors=Marco Peters, Ralf Quast,
> Marco Zühlk
>   metadata_Processing_Graph_node.0_copyright=(c) 2009 by Brockmann Consult
>   metadata_Processing_Graph_node.0_id=Mosaic$15A4BDE1324
>   metadata_Processing_Graph_node.0_moduleName=beam-gpf
>   metadata_Processing_Graph_node.0_moduleVersion=5.0.5
>   metadata_Processing_Graph_node.0_operator=Mosaic
>   metadata_Processing_Graph_node.0_parameters_combine=OR
>
> metadata_Processing_Graph_node.0_parameters_crs=PROJCS["Equidistant_Cylindrical
> / World Geodetic System 1984",
>       GEOGCS["World Geodetic System 1984",
>         DATUM["World Geodetic System 1984",
>           SPHEROID["WGS 84", 6378137.0, 298.257223563,
> AUTHORITY["EPSG","7030"]],
>           AUTHORITY["EPSG","6326"]],
>         PRIMEM["Greenwich", 0.0, AUTHORITY["EPSG","8901"]],
>         UNIT["degree", 0.017453292519943295],
>         AXIS["Geodetic longitude", EAST],
>         AXIS["Geodetic latitude", NORTH]],
>       PROJECTION["Equidistant_Cylindrical"],
>       PARAMETER["central_meridian", 0.0],
>       PARAMETER["latitude_of_origin", 0.0],
>       PARAMETER["standard_parallel_1", 0.0],
>       PARAMETER["false_easting", 0.0],
>       PARAMETER["false_northing", 0.0],
>       UNIT["m", 1.0],
>       AXIS["Easting", EAST],
>       AXIS["Northing", NORTH]]
>   metadata_Processing_Graph_node.0_parameters_eastBound=-79.0
>   metadata_Processing_Graph_node.0_parameters_northBound=31.0
>   metadata_Processing_Graph_node.0_parameters_orthorectify=false
>   metadata_Processing_Graph_node.0_parameters_pixelSizeX=1000.0
>   metadata_Processing_Graph_node.0_parameters_pixelSizeY=1000.0
>   metadata_Processing_Graph_node.0_parameters_resampling=Nearest
>   metadata_Processing_Graph_node.0_parameters_southBound=18.0
>
> metadata_Processing_Graph_node.0_parameters_variables_variable.0_expression=sst
>
>   metadata_Processing_Graph_node.0_parameters_variables_variable.0_name=sst
>
> metadata_Processing_Graph_node.0_parameters_variables_variable.1_expression=l2_flags
>
>
> metadata_Processing_Graph_node.0_parameters_variables_variable.1_name=l2_flags
>
>   metadata_Processing_Graph_node.0_parameters_westBound=-98.0
>   metadata_Processing_Graph_node.0_processingTime=2017-02-17T11:38:49.524Z
>   metadata_Processing_Graph_node.0_purpose=Creates a mosaic out of a set
> of source products.
>
> metadata_Processing_Graph_node.0_sources_sourceProduct.1=file:/home/ipopp/temp/aqua.SST.FILTERED.17048065000_mapped.dim
>
>
> metadata_Processing_Graph_node.0_sources_sourceProduct.2=file:/home/ipopp/temp/aqua.SST.FILTERED.17048065500_mapped.dim
>
>   metadata_Processing_Graph_node.0_version=1.0
> Subdatasets:
>   SUBDATASET_1_NAME=HDF5:"aqua.20170217.0645.gcoos.sst.h5"://bands/l2_flags
>   SUBDATASET_1_DESC=[1447x2115] //bands/l2_flags (32-bit floating-point)
>
> SUBDATASET_2_NAME=HDF5:"aqua.20170217.0645.gcoos.sst.h5"://bands/l2_flags_count
>
>   SUBDATASET_2_DESC=[1447x2115] //bands/l2_flags_count (32-bit integer)
>   SUBDATASET_3_NAME=HDF5:"aqua.20170217.0645.gcoos.sst.h5"://bands/sst
>   SUBDATASET_3_DESC=[1447x2115] //bands/sst (32-bit floating-point)
>
> SUBDATASET_4_NAME=HDF5:"aqua.20170217.0645.gcoos.sst.h5"://bands/sst_count
>   SUBDATASET_4_DESC=[1447x2115] //bands/sst_count (32-bit integer)
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0,  512.0)
> Upper Right (  512.0,    0.0)
> Lower Right (  512.0,  512.0)
> Center      (  256.0,  256.0)
>
> -------------- HDF5:"aqua.20170217.0645.gcoos.sst.h5"://bands/sst -----
> $ gdalinfo HDF5:"aqua.20170217.0645.gcoos.sst.h5"://bands/sst
> Driver: HDF5Image/HDF5 Dataset
> Files: aqua.20170217.0645.gcoos.sst.h5
>        aqua.20170217.0645.gcoos.sst.h5.aux.xml
> Size is 2115, 1447
> Coordinate System is `'
> Metadata:
>   metadata_Processing_Graph_node.0_authors=Marco Peters, Ralf Quast,
> Marco Zühlk
>   metadata_Processing_Graph_node.0_copyright=(c) 2009 by Brockmann Consult
>   metadata_Processing_Graph_node.0_id=Mosaic$15A4BDE1324
>   metadata_Processing_Graph_node.0_moduleName=beam-gpf
>   metadata_Processing_Graph_node.0_moduleVersion=5.0.5
>   metadata_Processing_Graph_node.0_operator=Mosaic
>   metadata_Processing_Graph_node.0_parameters_combine=OR
>
> metadata_Processing_Graph_node.0_parameters_crs=PROJCS["Equidistant_Cylindrical
> / World Geodetic System 1984",
>       GEOGCS["World Geodetic System 1984",
>         DATUM["World Geodetic System 1984",
>           SPHEROID["WGS 84", 6378137.0, 298.257223563,
> AUTHORITY["EPSG","7030"]],
>           AUTHORITY["EPSG","6326"]],
>         PRIMEM["Greenwich", 0.0, AUTHORITY["EPSG","8901"]],
>         UNIT["degree", 0.017453292519943295],
>         AXIS["Geodetic longitude", EAST],
>         AXIS["Geodetic latitude", NORTH]],
>       PROJECTION["Equidistant_Cylindrical"],
>       PARAMETER["central_meridian", 0.0],
>       PARAMETER["latitude_of_origin", 0.0],
>       PARAMETER["standard_parallel_1", 0.0],
>       PARAMETER["false_easting", 0.0],
>       PARAMETER["false_northing", 0.0],
>       UNIT["m", 1.0],
>       AXIS["Easting", EAST],
>       AXIS["Northing", NORTH]]
>   metadata_Processing_Graph_node.0_parameters_eastBound=-79.0
>   metadata_Processing_Graph_node.0_parameters_northBound=31.0
>   metadata_Processing_Graph_node.0_parameters_orthorectify=false
>   metadata_Processing_Graph_node.0_parameters_pixelSizeX=1000.0
>   metadata_Processing_Graph_node.0_parameters_pixelSizeY=1000.0
>   metadata_Processing_Graph_node.0_parameters_resampling=Nearest
>   metadata_Processing_Graph_node.0_parameters_southBound=18.0
>
> metadata_Processing_Graph_node.0_parameters_variables_variable.0_expression=sst
>
>   metadata_Processing_Graph_node.0_parameters_variables_variable.0_name=sst
>
> metadata_Processing_Graph_node.0_parameters_variables_variable.1_expression=l2_flags
>
>
> metadata_Processing_Graph_node.0_parameters_variables_variable.1_name=l2_flags
>
>   metadata_Processing_Graph_node.0_parameters_westBound=-98.0
>   metadata_Processing_Graph_node.0_processingTime=2017-02-17T11:38:49.524Z
>   metadata_Processing_Graph_node.0_purpose=Creates a mosaic out of a set
> of source products.
>
> metadata_Processing_Graph_node.0_sources_sourceProduct.1=file:/home/ipopp/temp/aqua.SST.FILTERED.17048065000_mapped.dim
>
>
> metadata_Processing_Graph_node.0_sources_sourceProduct.2=file:/home/ipopp/temp/aqua.SST.FILTERED.17048065500_mapped.dim
>
>   metadata_Processing_Graph_node.0_version=1.0
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0, 1447.0)
> Upper Right ( 2115.0,    0.0)
> Lower Right ( 2115.0, 1447.0)
> Center      ( 1057.5,  723.5)
> Band 1 Block=2115x1 Type=Float32, ColorInterp=Undefined
>   Min=0.000 Max=27.285
>   Minimum=0.000, Maximum=27.285, Mean=1.329, StdDev=5.395
>   Metadata:
>     bands_sst_CLASS=IMAGE
>     bands_sst_description=sst
>     bands_sst_IMAGE_VERSION=1.2
>     bands_sst_log10_scaled=false
>     bands_sst_raster_height=1447
>     bands_sst_raster_width=2115
>     bands_sst_scaling_factor=1
>     bands_sst_scaling_offset=0
>     STATISTICS_MAXIMUM=27.284999847412
>     STATISTICS_MEAN=1.3292428022154
>     STATISTICS_MINIMUM=0
>     STATISTICS_STDDEV=5.3949041458808
>
> ---
> This email has been checked for viruses by Avast antivirus software.
> https://www.avast.com/antivirus
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus


From boxerab at gmail.com  Mon Feb 20 10:01:56 2017
From: boxerab at gmail.com (Aaron Boxer)
Date: Mon, 20 Feb 2017 13:01:56 -0500
Subject: [gdal-dev] Fwd: Re: GDAL unable to write 4-band RGBA jp2 file
 with Kakadu 7.8
In-Reply-To: <CACmBxyvrXyaO8pLOGxuYa8oJRB5+CHqfZLkDsGGwAgD6Obw7tQ@mail.gmail.com>
References: <1487045644428-5307801.post@n6.nabble.com>
 <CACmBxyvJQtJNuJxXAo+KoGp4BTpC8aJ+Sjny+86BMtyn+hT9jQ@mail.gmail.com>
 <CACmBxytzKK=cNY_tLKFbdpz2YgHaP1-M+ZQm=o7zvifh2LWx_A@mail.gmail.com>
 <CAK8GPyDp7kwEs1bAYnw5m5M2HJGRbbVv_yQ5UGw10JDaHbs=0A@mail.gmail.com>
 <CAK8GPyDkRsLPdX=mFVkZmMz_PBGTnBzee5rpRUK0so=NXPOHzQ@mail.gmail.com>
 <CACmBxyvrXyaO8pLOGxuYa8oJRB5+CHqfZLkDsGGwAgD6Obw7tQ@mail.gmail.com>
Message-ID: <CAK8GPyBKWBe_UF7Kuns_YtuAyqsyW-k4nO+TVjWOZz4e2apdww@mail.gmail.com>

On Sat, Feb 18, 2017 at 8:14 AM, Kurt Schwehr <schwehr at gmail.com> wrote:

> Well,  I made a start as a part of gdal-autotest2...
>

> https://github.com/schwehr/gdal-autotest2/blob/master/
> cpp/third_party/kakadu/coresys/common/kdu_arch_test.cc
>


That is a good start.


>
>
> On Sat, Feb 18, 2017 at 5:03 AM, Aaron Boxer <boxerab at gmail.com> wrote:
>
>> ---------- Forwarded message ----------
>> From: "Aaron Boxer" <boxerab at gmail.com>
>> Date: Feb 18, 2017 8:03 AM
>> Subject: Re: [gdal-dev] GDAL unable to write 4-band RGBA jp2 file with
>> Kakadu 7.8
>> To: "Kurt Schwehr" <schwehr at gmail.com>
>> Cc:
>>
>>
>>
>> On Feb 18, 2017 7:26 AM, "Kurt Schwehr" <schwehr at gmail.com> wrote:
>>
>> Jason,
>>
>> Turns out you are hitting a known bug in v7.8 that is fixed in v7.9.
>> From the kakadu v7.9 docs:
>>
>> h. Corrected a tiny, yet very significant bug introduced into the
>>    handling of opacity channel descriptions in version 7.8.  The
>>    correction is in function `jp2_channels::set_opacity_mapping', where
>>    the opacity channel's component index accidentally overwrote the
>>    colour channel's component index.
>>
>>
>> Apparently Kakadu does no regression testing before a release 😁
>>
>>
>>
>> It's pretty easy to backport the fix if you are currently stuck at 7.8.
>> It's just a change of a 0 to a 1.
>>
>> --- kakadu/v7_8/apps/jp2/jp2.cpp
>> +++ kakadu/v7_9/apps/jp2/jp2.cpp
>> @@ -5976,7 +5976,7 @@
>>    if (lut_idx < 0)
>>      lut_idx = -1; // For consistency in comparisons later on.
>>    j2_channels::j2_channel *cp = state->channels+colour_idx;
>> -  cp->component_idx[0] = codestream_component;
>> +  cp->component_idx[1] = codestream_component; /* Was a bug in version
>> 7.8 */
>>    cp->lut_idx[1] = lut_idx;
>>    cp->codestream_idx[1] = codestream_idx;
>>    cp->data_format[1] = data_format;
>>
>> The 0 can trigger an error that looks just like you are seeing:
>>
>> Error: GdalIO: Error in Kakadu File Format Support: Attempting to create
>> a Component Mapping (cmap) box, one of whose channels refers to a
>> non-existent image component or palette lookup table. (code = 1)
>>
>>
>>
>> On Mon, Feb 13, 2017 at 9:28 PM, Kurt Schwehr <schwehr at gmail.com> wrote:
>>
>>> Hi Jason,
>>>
>>> I've seen the same thing with an alpha channel.  I'm not sure what's
>>> up.  Using just RGB was successful.
>>>
>>> On 7.3, I'm also seeing problems when using more than the main thread on
>>> linux.
>>>
>>> With 7.3, I just noticed today that kdu_get_num_processors() only
>>> returns 0 on linux as kdu_arch.cpp is missing #include <unistd.h> so
>>> _SC_NPROCESSORS_ONLN and _SC_NPROCESSORS_CONF are undefined.  When I
>>> enabled _SC_NPROCESSORS_ONLN, I got kdu_get_num_processors() returning 74
>>> on what I thought was a 6 core (aka 12 hyperthread) box.   If I change the
>>> fall through from 0 to 2, I get all sorts of trouble from internal kakadu
>>> assertions and TSAN failures.
>>>
>>> So I clearly have more investigating to do.
>>>
>>> I've yet to pass along any of what I've found to Taubman and I haven't
>>> yet pushed any of my new tests to github, but I hope to do both soon.
>>>
>>> And I've yet to see what, if any, discussion is happening in the yahoo
>>> group.
>>>
>>> -kurt
>>>
>>> On Mon, Feb 13, 2017 at 8:14 PM, jason.liu <jason.liu at spookfish.com>
>>> wrote:
>>>
>>>> Hi gdal-dev,
>>>>
>>>> I am having trouble using GDAL to write 4-band RGBA jp2 file with Kakadu
>>>> 7.8. The following minimal code
>>>>
>>>>
>>>>     GDALAllRegister();
>>>>
>>>>     GDALDataset* srcDataset =
>>>> (GDALDataset*)GDALOpen("/home/jason.liu/00000783.tif", GA_ReadOnly);
>>>>     char **papszOptions = NULL;
>>>>     papszOptions = CSLSetNameValue( papszOptions, "QUALITY", "20" );
>>>>
>>>>     GDALDriver *driver = GetGDALDriverManager()->GetDri
>>>> verByName("JP2KAK");
>>>>     GDALDataset* destDataset =
>>>> driver->CreateCopy("/home/jason.liu/00000783.jp2",
>>>>                                                   srcDataset,
>>>>                                                   FALSE,
>>>>                                                   papszOptions,
>>>>                                                   NULL,
>>>>                                                   NULL);
>>>>
>>>>     if( destDataset != NULL ) {
>>>>         GDALClose( (GDALDatasetH) destDataset );
>>>>     }
>>>>     GDALClose( (GDALDatasetH) srcDataset );
>>>>     CSLDestroy(papszOptions);
>>>>
>>>>
>>>> crashes Kakadu 7.8 with the following message in stderr:
>>>>
>>>> ERROR 1: Error in Kakadu File Format Support:
>>>> Attempting to create a Component Mapping (cmap) box, one of whose
>>>> channels
>>>> refers to a non-existent image component or palette lookup table.
>>>> terminate called after throwing an instance of
>>>> 'kdu_cpl_error_message::JP2KAKException'
>>>>
>>>>
>>>> where /home/jason.liu/00000783.tif is a 4-band 16-bit RGBA tif.
>>>>
>>>>
>>>> I have also done the following tests and noted the results:
>>>>
>>>> 3-band 8-bit RGB tif            OK
>>>> 3-band 16-bit RGB tif          OK
>>>> 4-band 8-bit RGBA tif          error as above
>>>> 4-band 16-bit RGBA tif        error as above
>>>>
>>>>
>>>> Am I doing anything wrong here?
>>>>
>>>> By the way, I am quite certain Kakadu 7.8 supports 4-band RGBA as I can
>>>> use
>>>> their example kdu_compress to produce 4-band RGBA jp2 images. So this
>>>> looks
>>>> to be a problem with GDAL, or the way I am invoking it.
>>>>
>>>>
>>>> Any insights will be greatly appreciated.
>>>>
>>>> Kind Regards
>>>> Jason
>>>>
>>>>
>>>>
>>>>
>>>> --
>>>> View this message in context: http://osgeo-org.1560.x6.nabbl
>>>> e.com/GDAL-unable-to-write-4-band-RGBA-jp2-file-with-Kakadu-
>>>> 7-8-tp5307801.html
>>>> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev at lists.osgeo.org
>>>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>>
>>>
>>>
>>> --
>>> --
>>> http://schwehr.org
>>>
>>
>>
>>
>> --
>> --
>> http://schwehr.org
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>
> --
> --
> http://schwehr.org
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170220/70a8152c/attachment-0001.html>

From schwehr at gmail.com  Mon Feb 20 10:56:16 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Mon, 20 Feb 2017 10:56:16 -0800
Subject: [gdal-dev] Fwd: Re: GDAL unable to write 4-band RGBA jp2 file
 with Kakadu 7.8
In-Reply-To: <CAK8GPyBKWBe_UF7Kuns_YtuAyqsyW-k4nO+TVjWOZz4e2apdww@mail.gmail.com>
References: <1487045644428-5307801.post@n6.nabble.com>
 <CACmBxyvJQtJNuJxXAo+KoGp4BTpC8aJ+Sjny+86BMtyn+hT9jQ@mail.gmail.com>
 <CACmBxytzKK=cNY_tLKFbdpz2YgHaP1-M+ZQm=o7zvifh2LWx_A@mail.gmail.com>
 <CAK8GPyDp7kwEs1bAYnw5m5M2HJGRbbVv_yQ5UGw10JDaHbs=0A@mail.gmail.com>
 <CAK8GPyDkRsLPdX=mFVkZmMz_PBGTnBzee5rpRUK0so=NXPOHzQ@mail.gmail.com>
 <CACmBxyvrXyaO8pLOGxuYa8oJRB5+CHqfZLkDsGGwAgD6Obw7tQ@mail.gmail.com>
 <CAK8GPyBKWBe_UF7Kuns_YtuAyqsyW-k4nO+TVjWOZz4e2apdww@mail.gmail.com>
Message-ID: <CACmBxytowhfomqkY0BykAd6BFOMCOubyNtX77OfMRnf3-cfxtQ@mail.gmail.com>

Only 370K more LOC left to cover with proper library level unittests.

On Mon, Feb 20, 2017 at 10:01 AM, Aaron Boxer <boxerab at gmail.com> wrote:

>
>
> On Sat, Feb 18, 2017 at 8:14 AM, Kurt Schwehr <schwehr at gmail.com> wrote:
>
>> Well,  I made a start as a part of gdal-autotest2...
>>
>
>> https://github.com/schwehr/gdal-autotest2/blob/master/cpp/
>> third_party/kakadu/coresys/common/kdu_arch_test.cc
>>
>
>
> That is a good start.
>
>
>>
>>
>> On Sat, Feb 18, 2017 at 5:03 AM, Aaron Boxer <boxerab at gmail.com> wrote:
>>
>>> ---------- Forwarded message ----------
>>> From: "Aaron Boxer" <boxerab at gmail.com>
>>> Date: Feb 18, 2017 8:03 AM
>>> Subject: Re: [gdal-dev] GDAL unable to write 4-band RGBA jp2 file with
>>> Kakadu 7.8
>>> To: "Kurt Schwehr" <schwehr at gmail.com>
>>> Cc:
>>>
>>>
>>>
>>> On Feb 18, 2017 7:26 AM, "Kurt Schwehr" <schwehr at gmail.com> wrote:
>>>
>>> Jason,
>>>
>>> Turns out you are hitting a known bug in v7.8 that is fixed in v7.9.
>>> From the kakadu v7.9 docs:
>>>
>>> h. Corrected a tiny, yet very significant bug introduced into the
>>>    handling of opacity channel descriptions in version 7.8.  The
>>>    correction is in function `jp2_channels::set_opacity_mapping', where
>>>    the opacity channel's component index accidentally overwrote the
>>>    colour channel's component index.
>>>
>>>
>>> Apparently Kakadu does no regression testing before a release 😁
>>>
>>>
>>>
>>> It's pretty easy to backport the fix if you are currently stuck at 7.8.
>>> It's just a change of a 0 to a 1.
>>>
>>> --- kakadu/v7_8/apps/jp2/jp2.cpp
>>> +++ kakadu/v7_9/apps/jp2/jp2.cpp
>>> @@ -5976,7 +5976,7 @@
>>>    if (lut_idx < 0)
>>>      lut_idx = -1; // For consistency in comparisons later on.
>>>    j2_channels::j2_channel *cp = state->channels+colour_idx;
>>> -  cp->component_idx[0] = codestream_component;
>>> +  cp->component_idx[1] = codestream_component; /* Was a bug in version
>>> 7.8 */
>>>    cp->lut_idx[1] = lut_idx;
>>>    cp->codestream_idx[1] = codestream_idx;
>>>    cp->data_format[1] = data_format;
>>>
>>> The 0 can trigger an error that looks just like you are seeing:
>>>
>>> Error: GdalIO: Error in Kakadu File Format Support: Attempting to create
>>> a Component Mapping (cmap) box, one of whose channels refers to a
>>> non-existent image component or palette lookup table. (code = 1)
>>>
>>>
>>>
>>> On Mon, Feb 13, 2017 at 9:28 PM, Kurt Schwehr <schwehr at gmail.com> wrote:
>>>
>>>> Hi Jason,
>>>>
>>>> I've seen the same thing with an alpha channel.  I'm not sure what's
>>>> up.  Using just RGB was successful.
>>>>
>>>> On 7.3, I'm also seeing problems when using more than the main thread
>>>> on linux.
>>>>
>>>> With 7.3, I just noticed today that kdu_get_num_processors() only
>>>> returns 0 on linux as kdu_arch.cpp is missing #include <unistd.h> so
>>>> _SC_NPROCESSORS_ONLN and _SC_NPROCESSORS_CONF are undefined.  When I
>>>> enabled _SC_NPROCESSORS_ONLN, I got kdu_get_num_processors() returning 74
>>>> on what I thought was a 6 core (aka 12 hyperthread) box.   If I change the
>>>> fall through from 0 to 2, I get all sorts of trouble from internal kakadu
>>>> assertions and TSAN failures.
>>>>
>>>> So I clearly have more investigating to do.
>>>>
>>>> I've yet to pass along any of what I've found to Taubman and I haven't
>>>> yet pushed any of my new tests to github, but I hope to do both soon.
>>>>
>>>> And I've yet to see what, if any, discussion is happening in the yahoo
>>>> group.
>>>>
>>>> -kurt
>>>>
>>>> On Mon, Feb 13, 2017 at 8:14 PM, jason.liu <jason.liu at spookfish.com>
>>>> wrote:
>>>>
>>>>> Hi gdal-dev,
>>>>>
>>>>> I am having trouble using GDAL to write 4-band RGBA jp2 file with
>>>>> Kakadu
>>>>> 7.8. The following minimal code
>>>>>
>>>>>
>>>>>     GDALAllRegister();
>>>>>
>>>>>     GDALDataset* srcDataset =
>>>>> (GDALDataset*)GDALOpen("/home/jason.liu/00000783.tif", GA_ReadOnly);
>>>>>     char **papszOptions = NULL;
>>>>>     papszOptions = CSLSetNameValue( papszOptions, "QUALITY", "20" );
>>>>>
>>>>>     GDALDriver *driver = GetGDALDriverManager()->GetDri
>>>>> verByName("JP2KAK");
>>>>>     GDALDataset* destDataset =
>>>>> driver->CreateCopy("/home/jason.liu/00000783.jp2",
>>>>>                                                   srcDataset,
>>>>>                                                   FALSE,
>>>>>                                                   papszOptions,
>>>>>                                                   NULL,
>>>>>                                                   NULL);
>>>>>
>>>>>     if( destDataset != NULL ) {
>>>>>         GDALClose( (GDALDatasetH) destDataset );
>>>>>     }
>>>>>     GDALClose( (GDALDatasetH) srcDataset );
>>>>>     CSLDestroy(papszOptions);
>>>>>
>>>>>
>>>>> crashes Kakadu 7.8 with the following message in stderr:
>>>>>
>>>>> ERROR 1: Error in Kakadu File Format Support:
>>>>> Attempting to create a Component Mapping (cmap) box, one of whose
>>>>> channels
>>>>> refers to a non-existent image component or palette lookup table.
>>>>> terminate called after throwing an instance of
>>>>> 'kdu_cpl_error_message::JP2KAKException'
>>>>>
>>>>>
>>>>> where /home/jason.liu/00000783.tif is a 4-band 16-bit RGBA tif.
>>>>>
>>>>>
>>>>> I have also done the following tests and noted the results:
>>>>>
>>>>> 3-band 8-bit RGB tif            OK
>>>>> 3-band 16-bit RGB tif          OK
>>>>> 4-band 8-bit RGBA tif          error as above
>>>>> 4-band 16-bit RGBA tif        error as above
>>>>>
>>>>>
>>>>> Am I doing anything wrong here?
>>>>>
>>>>> By the way, I am quite certain Kakadu 7.8 supports 4-band RGBA as I
>>>>> can use
>>>>> their example kdu_compress to produce 4-band RGBA jp2 images. So this
>>>>> looks
>>>>> to be a problem with GDAL, or the way I am invoking it.
>>>>>
>>>>>
>>>>> Any insights will be greatly appreciated.
>>>>>
>>>>> Kind Regards
>>>>> Jason
>>>>>
>>>>>
>>>>>
>>>>>
>>>>> --
>>>>> View this message in context: http://osgeo-org.1560.x6.nabbl
>>>>> e.com/GDAL-unable-to-write-4-band-RGBA-jp2-file-with-Kakadu-
>>>>> 7-8-tp5307801.html
>>>>> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>>>>> _______________________________________________
>>>>> gdal-dev mailing list
>>>>> gdal-dev at lists.osgeo.org
>>>>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>
>>>>
>>>>
>>>>
>>>> --
>>>> --
>>>> http://schwehr.org
>>>>
>>>
>>>
>>>
>>> --
>>> --
>>> http://schwehr.org
>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>>
>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>
>>
>>
>> --
>> --
>> http://schwehr.org
>>
>
>


-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170220/5d489dca/attachment.html>

From boxerab at gmail.com  Mon Feb 20 11:20:57 2017
From: boxerab at gmail.com (Aaron Boxer)
Date: Mon, 20 Feb 2017 14:20:57 -0500
Subject: [gdal-dev] Fwd: Re: GDAL unable to write 4-band RGBA jp2 file
 with Kakadu 7.8
In-Reply-To: <CACmBxytowhfomqkY0BykAd6BFOMCOubyNtX77OfMRnf3-cfxtQ@mail.gmail.com>
References: <1487045644428-5307801.post@n6.nabble.com>
 <CACmBxyvJQtJNuJxXAo+KoGp4BTpC8aJ+Sjny+86BMtyn+hT9jQ@mail.gmail.com>
 <CACmBxytzKK=cNY_tLKFbdpz2YgHaP1-M+ZQm=o7zvifh2LWx_A@mail.gmail.com>
 <CAK8GPyDp7kwEs1bAYnw5m5M2HJGRbbVv_yQ5UGw10JDaHbs=0A@mail.gmail.com>
 <CAK8GPyDkRsLPdX=mFVkZmMz_PBGTnBzee5rpRUK0so=NXPOHzQ@mail.gmail.com>
 <CACmBxyvrXyaO8pLOGxuYa8oJRB5+CHqfZLkDsGGwAgD6Obw7tQ@mail.gmail.com>
 <CAK8GPyBKWBe_UF7Kuns_YtuAyqsyW-k4nO+TVjWOZz4e2apdww@mail.gmail.com>
 <CACmBxytowhfomqkY0BykAd6BFOMCOubyNtX77OfMRnf3-cfxtQ@mail.gmail.com>
Message-ID: <CAK8GPyChWw3w998wy_83ym1VLJnTLcfVTEvEsayNnSNeVfSNrw@mail.gmail.com>

:):)

On Mon, Feb 20, 2017 at 1:56 PM, Kurt Schwehr <schwehr at gmail.com> wrote:

> Only 370K more LOC left to cover with proper library level unittests.
>
> On Mon, Feb 20, 2017 at 10:01 AM, Aaron Boxer <boxerab at gmail.com> wrote:
>
>>
>>
>> On Sat, Feb 18, 2017 at 8:14 AM, Kurt Schwehr <schwehr at gmail.com> wrote:
>>
>>> Well,  I made a start as a part of gdal-autotest2...
>>>
>>
>>> https://github.com/schwehr/gdal-autotest2/blob/master/cpp/th
>>> ird_party/kakadu/coresys/common/kdu_arch_test.cc
>>>
>>
>>
>> That is a good start.
>>
>>
>>>
>>>
>>> On Sat, Feb 18, 2017 at 5:03 AM, Aaron Boxer <boxerab at gmail.com> wrote:
>>>
>>>> ---------- Forwarded message ----------
>>>> From: "Aaron Boxer" <boxerab at gmail.com>
>>>> Date: Feb 18, 2017 8:03 AM
>>>> Subject: Re: [gdal-dev] GDAL unable to write 4-band RGBA jp2 file with
>>>> Kakadu 7.8
>>>> To: "Kurt Schwehr" <schwehr at gmail.com>
>>>> Cc:
>>>>
>>>>
>>>>
>>>> On Feb 18, 2017 7:26 AM, "Kurt Schwehr" <schwehr at gmail.com> wrote:
>>>>
>>>> Jason,
>>>>
>>>> Turns out you are hitting a known bug in v7.8 that is fixed in v7.9.
>>>> From the kakadu v7.9 docs:
>>>>
>>>> h. Corrected a tiny, yet very significant bug introduced into the
>>>>    handling of opacity channel descriptions in version 7.8.  The
>>>>    correction is in function `jp2_channels::set_opacity_mapping', where
>>>>    the opacity channel's component index accidentally overwrote the
>>>>    colour channel's component index.
>>>>
>>>>
>>>> Apparently Kakadu does no regression testing before a release 😁
>>>>
>>>>
>>>>
>>>> It's pretty easy to backport the fix if you are currently stuck at
>>>> 7.8.  It's just a change of a 0 to a 1.
>>>>
>>>> --- kakadu/v7_8/apps/jp2/jp2.cpp
>>>> +++ kakadu/v7_9/apps/jp2/jp2.cpp
>>>> @@ -5976,7 +5976,7 @@
>>>>    if (lut_idx < 0)
>>>>      lut_idx = -1; // For consistency in comparisons later on.
>>>>    j2_channels::j2_channel *cp = state->channels+colour_idx;
>>>> -  cp->component_idx[0] = codestream_component;
>>>> +  cp->component_idx[1] = codestream_component; /* Was a bug in version
>>>> 7.8 */
>>>>    cp->lut_idx[1] = lut_idx;
>>>>    cp->codestream_idx[1] = codestream_idx;
>>>>    cp->data_format[1] = data_format;
>>>>
>>>> The 0 can trigger an error that looks just like you are seeing:
>>>>
>>>> Error: GdalIO: Error in Kakadu File Format Support: Attempting to
>>>> create a Component Mapping (cmap) box, one of whose channels refers to a
>>>> non-existent image component or palette lookup table. (code = 1)
>>>>
>>>>
>>>>
>>>> On Mon, Feb 13, 2017 at 9:28 PM, Kurt Schwehr <schwehr at gmail.com>
>>>> wrote:
>>>>
>>>>> Hi Jason,
>>>>>
>>>>> I've seen the same thing with an alpha channel.  I'm not sure what's
>>>>> up.  Using just RGB was successful.
>>>>>
>>>>> On 7.3, I'm also seeing problems when using more than the main thread
>>>>> on linux.
>>>>>
>>>>> With 7.3, I just noticed today that kdu_get_num_processors() only
>>>>> returns 0 on linux as kdu_arch.cpp is missing #include <unistd.h> so
>>>>> _SC_NPROCESSORS_ONLN and _SC_NPROCESSORS_CONF are undefined.  When I
>>>>> enabled _SC_NPROCESSORS_ONLN, I got kdu_get_num_processors() returning 74
>>>>> on what I thought was a 6 core (aka 12 hyperthread) box.   If I change the
>>>>> fall through from 0 to 2, I get all sorts of trouble from internal kakadu
>>>>> assertions and TSAN failures.
>>>>>
>>>>> So I clearly have more investigating to do.
>>>>>
>>>>> I've yet to pass along any of what I've found to Taubman and I haven't
>>>>> yet pushed any of my new tests to github, but I hope to do both soon.
>>>>>
>>>>> And I've yet to see what, if any, discussion is happening in the yahoo
>>>>> group.
>>>>>
>>>>> -kurt
>>>>>
>>>>> On Mon, Feb 13, 2017 at 8:14 PM, jason.liu <jason.liu at spookfish.com>
>>>>> wrote:
>>>>>
>>>>>> Hi gdal-dev,
>>>>>>
>>>>>> I am having trouble using GDAL to write 4-band RGBA jp2 file with
>>>>>> Kakadu
>>>>>> 7.8. The following minimal code
>>>>>>
>>>>>>
>>>>>>     GDALAllRegister();
>>>>>>
>>>>>>     GDALDataset* srcDataset =
>>>>>> (GDALDataset*)GDALOpen("/home/jason.liu/00000783.tif", GA_ReadOnly);
>>>>>>     char **papszOptions = NULL;
>>>>>>     papszOptions = CSLSetNameValue( papszOptions, "QUALITY", "20" );
>>>>>>
>>>>>>     GDALDriver *driver = GetGDALDriverManager()->GetDri
>>>>>> verByName("JP2KAK");
>>>>>>     GDALDataset* destDataset =
>>>>>> driver->CreateCopy("/home/jason.liu/00000783.jp2",
>>>>>>                                                   srcDataset,
>>>>>>                                                   FALSE,
>>>>>>                                                   papszOptions,
>>>>>>                                                   NULL,
>>>>>>                                                   NULL);
>>>>>>
>>>>>>     if( destDataset != NULL ) {
>>>>>>         GDALClose( (GDALDatasetH) destDataset );
>>>>>>     }
>>>>>>     GDALClose( (GDALDatasetH) srcDataset );
>>>>>>     CSLDestroy(papszOptions);
>>>>>>
>>>>>>
>>>>>> crashes Kakadu 7.8 with the following message in stderr:
>>>>>>
>>>>>> ERROR 1: Error in Kakadu File Format Support:
>>>>>> Attempting to create a Component Mapping (cmap) box, one of whose
>>>>>> channels
>>>>>> refers to a non-existent image component or palette lookup table.
>>>>>> terminate called after throwing an instance of
>>>>>> 'kdu_cpl_error_message::JP2KAKException'
>>>>>>
>>>>>>
>>>>>> where /home/jason.liu/00000783.tif is a 4-band 16-bit RGBA tif.
>>>>>>
>>>>>>
>>>>>> I have also done the following tests and noted the results:
>>>>>>
>>>>>> 3-band 8-bit RGB tif            OK
>>>>>> 3-band 16-bit RGB tif          OK
>>>>>> 4-band 8-bit RGBA tif          error as above
>>>>>> 4-band 16-bit RGBA tif        error as above
>>>>>>
>>>>>>
>>>>>> Am I doing anything wrong here?
>>>>>>
>>>>>> By the way, I am quite certain Kakadu 7.8 supports 4-band RGBA as I
>>>>>> can use
>>>>>> their example kdu_compress to produce 4-band RGBA jp2 images. So this
>>>>>> looks
>>>>>> to be a problem with GDAL, or the way I am invoking it.
>>>>>>
>>>>>>
>>>>>> Any insights will be greatly appreciated.
>>>>>>
>>>>>> Kind Regards
>>>>>> Jason
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>> --
>>>>>> View this message in context: http://osgeo-org.1560.x6.nabbl
>>>>>> e.com/GDAL-unable-to-write-4-band-RGBA-jp2-file-with-Kakadu-
>>>>>> 7-8-tp5307801.html
>>>>>> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>>>>>> _______________________________________________
>>>>>> gdal-dev mailing list
>>>>>> gdal-dev at lists.osgeo.org
>>>>>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>>
>>>>>
>>>>>
>>>>>
>>>>> --
>>>>> --
>>>>> http://schwehr.org
>>>>>
>>>>
>>>>
>>>>
>>>> --
>>>> --
>>>> http://schwehr.org
>>>>
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev at lists.osgeo.org
>>>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>
>>>>
>>>>
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev at lists.osgeo.org
>>>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>
>>>
>>>
>>>
>>> --
>>> --
>>> http://schwehr.org
>>>
>>
>>
>
>
> --
> --
> http://schwehr.org
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170220/8aff0351/attachment-0001.html>

From even.rouault at spatialys.com  Mon Feb 20 11:26:58 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 20 Feb 2017 20:26:58 +0100
Subject: [gdal-dev] gdal-autotest2
In-Reply-To: <CACmBxytowhfomqkY0BykAd6BFOMCOubyNtX77OfMRnf3-cfxtQ@mail.gmail.com>
References: <1487045644428-5307801.post@n6.nabble.com>
 <CAK8GPyBKWBe_UF7Kuns_YtuAyqsyW-k4nO+TVjWOZz4e2apdww@mail.gmail.com>
 <CACmBxytowhfomqkY0BykAd6BFOMCOubyNtX77OfMRnf3-cfxtQ@mail.gmail.com>
Message-ID: <5335953.rxPsUz55Rq@even-i700>

On lundi 20 février 2017 10:56:16 CET Kurt Schwehr wrote:
> Only 370K more LOC left to cover with proper library level unittests.

Changing the topic line.

Kurt

IHMO if your aim is to have gdal-autotest2 being merged some day, the forked approach is 
going to be a nightmare for you to manage, unless you have a huge workforce to put behind. 
I'd rather attempt at having the current autotest suite running as a hack into the cleaner 
approach, so it can be merged into trunk and once done, migrate things progressively.

Even

> 
> On Mon, Feb 20, 2017 at 10:01 AM, Aaron Boxer <boxerab at gmail.com> wrote:
> > On Sat, Feb 18, 2017 at 8:14 AM, Kurt Schwehr <schwehr at gmail.com> wrote:
> >> Well,  I made a start as a part of gdal-autotest2...
> >> 
> >> 
> >> https://github.com/schwehr/gdal-autotest2/blob/master/cpp/
> >> third_party/kakadu/coresys/common/kdu_arch_test.cc
> > 
> > That is a good start.
> > 
> >> On Sat, Feb 18, 2017 at 5:03 AM, Aaron Boxer <boxerab at gmail.com> wrote:
> >>> ---------- Forwarded message ----------
> >>> From: "Aaron Boxer" <boxerab at gmail.com>
> >>> Date: Feb 18, 2017 8:03 AM
> >>> Subject: Re: [gdal-dev] GDAL unable to write 4-band RGBA jp2 file with
> >>> Kakadu 7.8
> >>> To: "Kurt Schwehr" <schwehr at gmail.com>
> >>> Cc:
> >>> 
> >>> 
> >>> 
> >>> On Feb 18, 2017 7:26 AM, "Kurt Schwehr" <schwehr at gmail.com> wrote:
> >>> 
> >>> Jason,
> >>> 
> >>> Turns out you are hitting a known bug in v7.8 that is fixed in v7.9.
> >>> From the kakadu v7.9 docs:
> >>> 
> >>> h. Corrected a tiny, yet very significant bug introduced into the
> >>> 
> >>>    handling of opacity channel descriptions in version 7.8.  The
> >>>    correction is in function `jp2_channels::set_opacity_mapping', where
> >>>    the opacity channel's component index accidentally overwrote the
> >>>    colour channel's component index.
> >>> 
> >>> Apparently Kakadu does no regression testing before a release 😁
> >>> 
> >>> 
> >>> 
> >>> It's pretty easy to backport the fix if you are currently stuck at 7.8.
> >>> It's just a change of a 0 to a 1.
> >>> 
> >>> --- kakadu/v7_8/apps/jp2/jp2.cpp
> >>> +++ kakadu/v7_9/apps/jp2/jp2.cpp
> >>> @@ -5976,7 +5976,7 @@
> >>> 
> >>>    if (lut_idx < 0)
> >>>    
> >>>      lut_idx = -1; // For consistency in comparisons later on.
> >>>    
> >>>    j2_channels::j2_channel *cp = state->channels+colour_idx;
> >>> 
> >>> -  cp->component_idx[0] = codestream_component;
> >>> +  cp->component_idx[1] = codestream_component; /* Was a bug in version
> >>> 7.8 */
> >>> 
> >>>    cp->lut_idx[1] = lut_idx;
> >>>    cp->codestream_idx[1] = codestream_idx;
> >>>    cp->data_format[1] = data_format;
> >>> 
> >>> The 0 can trigger an error that looks just like you are seeing:
> >>> 
> >>> Error: GdalIO: Error in Kakadu File Format Support: Attempting to create
> >>> a Component Mapping (cmap) box, one of whose channels refers to a
> >>> non-existent image component or palette lookup table. (code = 1)
> >>> 
> >>> On Mon, Feb 13, 2017 at 9:28 PM, Kurt Schwehr <schwehr at gmail.com> wrote:
> >>>> Hi Jason,
> >>>> 
> >>>> I've seen the same thing with an alpha channel.  I'm not sure what's
> >>>> up.  Using just RGB was successful.
> >>>> 
> >>>> On 7.3, I'm also seeing problems when using more than the main thread
> >>>> on linux.
> >>>> 
> >>>> With 7.3, I just noticed today that kdu_get_num_processors() only
> >>>> returns 0 on linux as kdu_arch.cpp is missing #include <unistd.h> so
> >>>> _SC_NPROCESSORS_ONLN and _SC_NPROCESSORS_CONF are undefined.  When I
> >>>> enabled _SC_NPROCESSORS_ONLN, I got kdu_get_num_processors() returning
> >>>> 74
> >>>> on what I thought was a 6 core (aka 12 hyperthread) box.   If I change
> >>>> the
> >>>> fall through from 0 to 2, I get all sorts of trouble from internal
> >>>> kakadu
> >>>> assertions and TSAN failures.
> >>>> 
> >>>> So I clearly have more investigating to do.
> >>>> 
> >>>> I've yet to pass along any of what I've found to Taubman and I haven't
> >>>> yet pushed any of my new tests to github, but I hope to do both soon.
> >>>> 
> >>>> And I've yet to see what, if any, discussion is happening in the yahoo
> >>>> group.
> >>>> 
> >>>> -kurt
> >>>> 
> >>>> On Mon, Feb 13, 2017 at 8:14 PM, jason.liu <jason.liu at spookfish.com>
> >>>> 
> >>>> wrote:
> >>>>> Hi gdal-dev,
> >>>>> 
> >>>>> I am having trouble using GDAL to write 4-band RGBA jp2 file with
> >>>>> Kakadu
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170220/fb3e5548/attachment-0001.html>

From schwehr at gmail.com  Mon Feb 20 11:57:53 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Mon, 20 Feb 2017 11:57:53 -0800
Subject: [gdal-dev] gdal-autotest2
In-Reply-To: <5335953.rxPsUz55Rq@even-i700>
References: <1487045644428-5307801.post@n6.nabble.com>
 <CAK8GPyBKWBe_UF7Kuns_YtuAyqsyW-k4nO+TVjWOZz4e2apdww@mail.gmail.com>
 <CACmBxytowhfomqkY0BykAd6BFOMCOubyNtX77OfMRnf3-cfxtQ@mail.gmail.com>
 <5335953.rxPsUz55Rq@even-i700>
Message-ID: <CACmBxyurenHTuQ7B0gR6Wn7jgBsWhRsW+v1mbVvp6374iztihg@mail.gmail.com>

Well, it would be great if the GDAL community wants to merge that code.  I
wanted to get a big enough body of code that people could get a sense of it
before suggesting any kind of merge.

But anyway it goes, it's a win for me. It's what I run my continuous
integration against in the custom environment I'm responsible for.  And
it's the code that makes merging from svn manageable.  It's running for all
dependent lib and tool chain changes many times an hour and also runs as
hardened, asan, msan, and tsan.

On Mon, Feb 20, 2017 at 11:26 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> On lundi 20 février 2017 10:56:16 CET Kurt Schwehr wrote:
>
> > Only 370K more LOC left to cover with proper library level unittests.
>
>
>
> Changing the topic line.
>
>
>
> Kurt
>
>
>
> IHMO if your aim is to have gdal-autotest2 being merged some day, the
> forked approach is going to be a nightmare for you to manage, unless you
> have a huge workforce to put behind. I'd rather attempt at having the
> current autotest suite running as a hack into the cleaner approach, so it
> can be merged into trunk and once done, migrate things progressively.
>
>
>
> Even
>
>
>
> >
>
> > On Mon, Feb 20, 2017 at 10:01 AM, Aaron Boxer <boxerab at gmail.com> wrote:
>
> > > On Sat, Feb 18, 2017 at 8:14 AM, Kurt Schwehr <schwehr at gmail.com>
> wrote:
>
> > >> Well, I made a start as a part of gdal-autotest2...
>
> > >>
>
> > >>
>
> > >> https://github.com/schwehr/gdal-autotest2/blob/master/cpp/
>
> > >> third_party/kakadu/coresys/common/kdu_arch_test.cc
>
> > >
>
> > > That is a good start.
>
> > >
>
> > >> On Sat, Feb 18, 2017 at 5:03 AM, Aaron Boxer <boxerab at gmail.com>
> wrote:
>
> > >>> ---------- Forwarded message ----------
>
> > >>> From: "Aaron Boxer" <boxerab at gmail.com>
>
> > >>> Date: Feb 18, 2017 8:03 AM
>
> > >>> Subject: Re: [gdal-dev] GDAL unable to write 4-band RGBA jp2 file
> with
>
> > >>> Kakadu 7.8
>
> > >>> To: "Kurt Schwehr" <schwehr at gmail.com>
>
> > >>> Cc:
>
> > >>>
>
> > >>>
>
> > >>>
>
> > >>> On Feb 18, 2017 7:26 AM, "Kurt Schwehr" <schwehr at gmail.com> wrote:
>
> > >>>
>
> > >>> Jason,
>
> > >>>
>
> > >>> Turns out you are hitting a known bug in v7.8 that is fixed in v7.9.
>
> > >>> From the kakadu v7.9 docs:
>
> > >>>
>
> > >>> h. Corrected a tiny, yet very significant bug introduced into the
>
> > >>>
>
> > >>> handling of opacity channel descriptions in version 7.8. The
>
> > >>> correction is in function `jp2_channels::set_opacity_mapping', where
>
> > >>> the opacity channel's component index accidentally overwrote the
>
> > >>> colour channel's component index.
>
> > >>>
>
> > >>> Apparently Kakadu does no regression testing before a release 😁
>
> > >>>
>
> > >>>
>
> > >>>
>
> > >>> It's pretty easy to backport the fix if you are currently stuck at
> 7.8.
>
> > >>> It's just a change of a 0 to a 1.
>
> > >>>
>
> > >>> --- kakadu/v7_8/apps/jp2/jp2.cpp
>
> > >>> +++ kakadu/v7_9/apps/jp2/jp2.cpp
>
> > >>> @@ -5976,7 +5976,7 @@
>
> > >>>
>
> > >>> if (lut_idx < 0)
>
> > >>>
>
> > >>> lut_idx = -1; // For consistency in comparisons later on.
>
> > >>>
>
> > >>> j2_channels::j2_channel *cp = state->channels+colour_idx;
>
> > >>>
>
> > >>> - cp->component_idx[0] = codestream_component;
>
> > >>> + cp->component_idx[1] = codestream_component; /* Was a bug in
> version
>
> > >>> 7.8 */
>
> > >>>
>
> > >>> cp->lut_idx[1] = lut_idx;
>
> > >>> cp->codestream_idx[1] = codestream_idx;
>
> > >>> cp->data_format[1] = data_format;
>
> > >>>
>
> > >>> The 0 can trigger an error that looks just like you are seeing:
>
> > >>>
>
> > >>> Error: GdalIO: Error in Kakadu File Format Support: Attempting to
> create
>
> > >>> a Component Mapping (cmap) box, one of whose channels refers to a
>
> > >>> non-existent image component or palette lookup table. (code = 1)
>
> > >>>
>
> > >>> On Mon, Feb 13, 2017 at 9:28 PM, Kurt Schwehr <schwehr at gmail.com>
> wrote:
>
> > >>>> Hi Jason,
>
> > >>>>
>
> > >>>> I've seen the same thing with an alpha channel. I'm not sure what's
>
> > >>>> up. Using just RGB was successful.
>
> > >>>>
>
> > >>>> On 7.3, I'm also seeing problems when using more than the main
> thread
>
> > >>>> on linux.
>
> > >>>>
>
> > >>>> With 7.3, I just noticed today that kdu_get_num_processors() only
>
> > >>>> returns 0 on linux as kdu_arch.cpp is missing #include <unistd.h> so
>
> > >>>> _SC_NPROCESSORS_ONLN and _SC_NPROCESSORS_CONF are undefined. When I
>
> > >>>> enabled _SC_NPROCESSORS_ONLN, I got kdu_get_num_processors()
> returning
>
> > >>>> 74
>
> > >>>> on what I thought was a 6 core (aka 12 hyperthread) box. If I change
>
> > >>>> the
>
> > >>>> fall through from 0 to 2, I get all sorts of trouble from internal
>
> > >>>> kakadu
>
> > >>>> assertions and TSAN failures.
>
> > >>>>
>
> > >>>> So I clearly have more investigating to do.
>
> > >>>>
>
> > >>>> I've yet to pass along any of what I've found to Taubman and I
> haven't
>
> > >>>> yet pushed any of my new tests to github, but I hope to do both
> soon.
>
> > >>>>
>
> > >>>> And I've yet to see what, if any, discussion is happening in the
> yahoo
>
> > >>>> group.
>
> > >>>>
>
> > >>>> -kurt
>
> > >>>>
>
> > >>>> On Mon, Feb 13, 2017 at 8:14 PM, jason.liu <jason.liu at spookfish.com
> >
>
> > >>>>
>
> > >>>> wrote:
>
> > >>>>> Hi gdal-dev,
>
> > >>>>>
>
> > >>>>> I am having trouble using GDAL to write 4-band RGBA jp2 file with
>
> > >>>>> Kakadu
>
> > >>>>> 7.8. The following minimal code
>
> > >>>>>
>
> > >>>>> GDALAllRegister();
>
> > >>>>>
>
> > >>>>> GDALDataset* srcDataset =
>
> > >>>>>
>
> > >>>>> (GDALDataset*)GDALOpen("/home/jason.liu/00000783.tif",
> GA_ReadOnly);
>
> > >>>>>
>
> > >>>>> char **papszOptions = NULL;
>
> > >>>>> papszOptions = CSLSetNameValue( papszOptions, "QUALITY", "20" );
>
> > >>>>>
>
> > >>>>> GDALDriver *driver = GetGDALDriverManager()->GetDri
>
> > >>>>>
>
> > >>>>> verByName("JP2KAK");
>
> > >>>>>
>
> > >>>>> GDALDataset* destDataset =
>
> > >>>>>
>
> > >>>>> driver->CreateCopy("/home/jason.liu/00000783.jp2",
>
> > >>>>>
>
> > >>>>> srcDataset,
>
> > >>>>> FALSE,
>
> > >>>>> papszOptions,
>
> > >>>>> NULL,
>
> > >>>>> NULL);
>
> > >>>>>
>
> > >>>>> if( destDataset != NULL ) {
>
> > >>>>>
>
> > >>>>> GDALClose( (GDALDatasetH) destDataset );
>
> > >>>>>
>
> > >>>>> }
>
> > >>>>> GDALClose( (GDALDatasetH) srcDataset );
>
> > >>>>> CSLDestroy(papszOptions);
>
> > >>>>>
>
> > >>>>> crashes Kakadu 7.8 with the following message in stderr:
>
> > >>>>>
>
> > >>>>> ERROR 1: Error in Kakadu File Format Support:
>
> > >>>>> Attempting to create a Component Mapping (cmap) box, one of whose
>
> > >>>>> channels
>
> > >>>>> refers to a non-existent image component or palette lookup table.
>
> > >>>>> terminate called after throwing an instance of
>
> > >>>>> 'kdu_cpl_error_message::JP2KAKException'
>
> > >>>>>
>
> > >>>>>
>
> > >>>>> where /home/jason.liu/00000783.tif is a 4-band 16-bit RGBA tif.
>
> > >>>>>
>
> > >>>>>
>
> > >>>>> I have also done the following tests and noted the results:
>
> > >>>>>
>
> > >>>>> 3-band 8-bit RGB tif OK
>
> > >>>>> 3-band 16-bit RGB tif OK
>
> > >>>>> 4-band 8-bit RGBA tif error as above
>
> > >>>>> 4-band 16-bit RGBA tif error as above
>
> > >>>>>
>
> > >>>>>
>
> > >>>>> Am I doing anything wrong here?
>
> > >>>>>
>
> > >>>>> By the way, I am quite certain Kakadu 7.8 supports 4-band RGBA as I
>
> > >>>>> can use
>
> > >>>>> their example kdu_compress to produce 4-band RGBA jp2 images. So
> this
>
> > >>>>> looks
>
> > >>>>> to be a problem with GDAL, or the way I am invoking it.
>
> > >>>>>
>
> > >>>>>
>
> > >>>>> Any insights will be greatly appreciated.
>
> > >>>>>
>
> > >>>>> Kind Regards
>
> > >>>>> Jason
>
> > >>>>>
>
> > >>>>>
>
> > >>>>>
>
> > >>>>>
>
> > >>>>> --
>
> > >>>>> View this message in context: http://osgeo-org.1560.x6.nabbl
>
> > >>>>> e.com/GDAL-unable-to-write-4-band-RGBA-jp2-file-with-Kakadu-
>
> > >>>>> 7-8-tp5307801.html
>
> > >>>>> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>
> > >>>>> _______________________________________________
>
> > >>>>> gdal-dev mailing list
>
> > >>>>> gdal-dev at lists.osgeo.org
>
> > >>>>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> > >>>>
>
> > >>>> --
>
> > >>>> --
>
> > >>>> http://schwehr.org
>
> > >>>
>
> > >>> --
>
> > >>> --
>
> > >>> http://schwehr.org
>
> > >>>
>
> > >>> _______________________________________________
>
> > >>> gdal-dev mailing list
>
> > >>> gdal-dev at lists.osgeo.org
>
> > >>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> > >>>
>
> > >>>
>
> > >>>
>
> > >>> _______________________________________________
>
> > >>> gdal-dev mailing list
>
> > >>> gdal-dev at lists.osgeo.org
>
> > >>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> > >>
>
> > >> --
>
> > >> --
>
> > >> http://schwehr.org
>
>
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170220/284fe454/attachment-0001.html>

From mofoyoda at gmail.com  Mon Feb 20 12:37:21 2017
From: mofoyoda at gmail.com (Nikolai Bezdna)
Date: Mon, 20 Feb 2017 23:37:21 +0300
Subject: [gdal-dev] DXF driver MTEXT objects properties.
Message-ID: <F821FEDC-3683-428D-890F-C32182319191@gmail.com>

Hello,

I’d like to know if it’s possible to retrieve some properties for MTEXT objects from DXF driver:
Are "Text alignment X", "Text alignment Y", "Text alignment Z" params being read? 
I guess they should go to the “dx" and “dy" properties of OGR_STYLE.
When Justify MTEXT param goes to the “p” style property, it really indicates alignment relative to the anchor point, not the insertion point of the text. So it really makes sense when dx and dy are fetched from DXF.
Also Style MTEXT param should go to the “f” style property (or any other:)…right now I can’t get an exact font used for a label in DXF. “f” style param defaults to Arial, but ignores the values in DXF.

Cheers,
Nick

From mateusz at loskot.net  Tue Feb 21 05:01:56 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue, 21 Feb 2017 06:01:56 -0700 (MST)
Subject: [gdal-dev] gdal-autotest2
In-Reply-To: <CACmBxyurenHTuQ7B0gR6Wn7jgBsWhRsW+v1mbVvp6374iztihg@mail.gmail.com>
References: <1487045644428-5307801.post@n6.nabble.com>
 <CACmBxyvJQtJNuJxXAo+KoGp4BTpC8aJ+Sjny+86BMtyn+hT9jQ@mail.gmail.com>
 <CACmBxytzKK=cNY_tLKFbdpz2YgHaP1-M+ZQm=o7zvifh2LWx_A@mail.gmail.com>
 <CAK8GPyDkRsLPdX=mFVkZmMz_PBGTnBzee5rpRUK0so=NXPOHzQ@mail.gmail.com>
 <CACmBxyvrXyaO8pLOGxuYa8oJRB5+CHqfZLkDsGGwAgD6Obw7tQ@mail.gmail.com>
 <CAK8GPyBKWBe_UF7Kuns_YtuAyqsyW-k4nO+TVjWOZz4e2apdww@mail.gmail.com>
 <CACmBxytowhfomqkY0BykAd6BFOMCOubyNtX77OfMRnf3-cfxtQ@mail.gmail.com>
 <5335953.rxPsUz55Rq@even-i700>
 <CACmBxyurenHTuQ7B0gR6Wn7jgBsWhRsW+v1mbVvp6374iztihg@mail.gmail.com>
Message-ID: <1487682116770-5308840.post@n6.nabble.com>

Kurt Schwehr-2 wrote
> Well, it would be great if the GDAL community wants to merge that code. 

+1 - I'd welcome it

Perhaps it would make sense to name autotest2 simply as tests
and place it inside gdal folder.

Mateusz



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/GDAL-unable-to-write-4-band-RGBA-jp2-file-with-Kakadu-7-8-tp5307801p5308840.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Tue Feb 21 06:57:46 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 21 Feb 2017 15:57:46 +0100
Subject: [gdal-dev] DXF driver MTEXT objects properties.
In-Reply-To: <F821FEDC-3683-428D-890F-C32182319191@gmail.com>
References: <F821FEDC-3683-428D-890F-C32182319191@gmail.com>
Message-ID: <10630336.P972lfu0Ql@even-i700>

On lundi 20 février 2017 23:37:21 CET Nikolai Bezdna wrote:
> Hello,
> 
> I’d like to know if it’s possible to retrieve some properties for MTEXT
> objects from DXF driver: Are "Text alignment X", "Text alignment Y", "Text
> alignment Z" params being read? I guess they should go to the “dx" and “dy"
> properties of OGR_STYLE. When Justify MTEXT param goes to the “p” style
> property, it really indicates alignment relative to the anchor point, not
> the insertion point of the text. So it really makes sense when dx and dy
> are fetched from DXF. Also Style MTEXT param should go to the “f” style
> property (or any other:)…right now I can’t get an exact font used for a
> label in DXF. “f” style param defaults to Arial, but ignores the values in
> DXF.

Nikolai,

If you want to improve the retrieval of style information, the function to edit is 
OGRDXFLayer::TranslateMTEXT() in ogr/ogrsf_frmts/dxf/ogrdxflayer.cpp
To correlate with
http://www.autodesk.com/techpubs/autocad/acad2000/dxf/mtext_dxf_06.htm

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170221/68e29676/attachment.html>

From mateusz at loskot.net  Tue Feb 21 10:34:35 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue, 21 Feb 2017 19:34:35 +0100
Subject: [gdal-dev] gdal-autotest2
In-Reply-To: <1487682116770-5308840.post@n6.nabble.com>
References: <1487045644428-5307801.post@n6.nabble.com>
 <CACmBxyvJQtJNuJxXAo+KoGp4BTpC8aJ+Sjny+86BMtyn+hT9jQ@mail.gmail.com>
 <CACmBxytzKK=cNY_tLKFbdpz2YgHaP1-M+ZQm=o7zvifh2LWx_A@mail.gmail.com>
 <CAK8GPyDkRsLPdX=mFVkZmMz_PBGTnBzee5rpRUK0so=NXPOHzQ@mail.gmail.com>
 <CACmBxyvrXyaO8pLOGxuYa8oJRB5+CHqfZLkDsGGwAgD6Obw7tQ@mail.gmail.com>
 <CAK8GPyBKWBe_UF7Kuns_YtuAyqsyW-k4nO+TVjWOZz4e2apdww@mail.gmail.com>
 <CACmBxytowhfomqkY0BykAd6BFOMCOubyNtX77OfMRnf3-cfxtQ@mail.gmail.com>
 <5335953.rxPsUz55Rq@even-i700>
 <CACmBxyurenHTuQ7B0gR6Wn7jgBsWhRsW+v1mbVvp6374iztihg@mail.gmail.com>
 <1487682116770-5308840.post@n6.nabble.com>
Message-ID: <CABUeae9U42AgkWhP2b4F2phgtw=cN_XSHhaiZtSSaqJHO4yGYA@mail.gmail.com>

On 21 February 2017 at 14:01, Mateusz Loskot <mateusz at loskot.net> wrote:
> Kurt Schwehr-2 wrote
>> Well, it would be great if the GDAL community wants to merge that code.
>
> +1 - I'd welcome it

Is re-writing tests of GDAL dependencies part of the big plan?
https://github.com/schwehr/gdal-autotest2/commit/e65e6d5aa03753c4b9a67e2cec6a8bdbe0997a80)

AFAIK, GEOS is covered with tests pretty well.

Best regards.
-- 
Mateusz Loskot, http://mateusz.loskot.net

From schwehr at gmail.com  Tue Feb 21 11:10:13 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Tue, 21 Feb 2017 11:10:13 -0800
Subject: [gdal-dev] gdal-autotest2
In-Reply-To: <CABUeae9U42AgkWhP2b4F2phgtw=cN_XSHhaiZtSSaqJHO4yGYA@mail.gmail.com>
References: <1487045644428-5307801.post@n6.nabble.com>
 <CACmBxyvJQtJNuJxXAo+KoGp4BTpC8aJ+Sjny+86BMtyn+hT9jQ@mail.gmail.com>
 <CACmBxytzKK=cNY_tLKFbdpz2YgHaP1-M+ZQm=o7zvifh2LWx_A@mail.gmail.com>
 <CAK8GPyDkRsLPdX=mFVkZmMz_PBGTnBzee5rpRUK0so=NXPOHzQ@mail.gmail.com>
 <CACmBxyvrXyaO8pLOGxuYa8oJRB5+CHqfZLkDsGGwAgD6Obw7tQ@mail.gmail.com>
 <CAK8GPyBKWBe_UF7Kuns_YtuAyqsyW-k4nO+TVjWOZz4e2apdww@mail.gmail.com>
 <CACmBxytowhfomqkY0BykAd6BFOMCOubyNtX77OfMRnf3-cfxtQ@mail.gmail.com>
 <5335953.rxPsUz55Rq@even-i700>
 <CACmBxyurenHTuQ7B0gR6Wn7jgBsWhRsW+v1mbVvp6374iztihg@mail.gmail.com>
 <1487682116770-5308840.post@n6.nabble.com>
 <CABUeae9U42AgkWhP2b4F2phgtw=cN_XSHhaiZtSSaqJHO4yGYA@mail.gmail.com>
Message-ID: <CACmBxyvzhb0p84o5Oig=L31XS0CKn2ZdPOLwZvHoEcbPsNYWYw@mail.gmail.com>

The geos coverage is okay, but I have a hard time working with it.  I've
mostly been putting tests for libs that GDAL can be dependent on for lack
of another place to put them as I can push the code.

On Tue, Feb 21, 2017 at 10:34 AM, Mateusz Loskot <mateusz at loskot.net> wrote:

> On 21 February 2017 at 14:01, Mateusz Loskot <mateusz at loskot.net> wrote:
> > Kurt Schwehr-2 wrote
> >> Well, it would be great if the GDAL community wants to merge that code.
> >
> > +1 - I'd welcome it
>
> Is re-writing tests of GDAL dependencies part of the big plan?
> https://github.com/schwehr/gdal-autotest2/commit/
> e65e6d5aa03753c4b9a67e2cec6a8bdbe0997a80)
>
> AFAIK, GEOS is covered with tests pretty well.
>
> Best regards.
> --
> Mateusz Loskot, http://mateusz.loskot.net
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170221/0a67ed19/attachment.html>

From mateusz at loskot.net  Tue Feb 21 11:21:09 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue, 21 Feb 2017 20:21:09 +0100
Subject: [gdal-dev] gdal-autotest2
In-Reply-To: <CACmBxyvzhb0p84o5Oig=L31XS0CKn2ZdPOLwZvHoEcbPsNYWYw@mail.gmail.com>
References: <1487045644428-5307801.post@n6.nabble.com>
 <CACmBxyvJQtJNuJxXAo+KoGp4BTpC8aJ+Sjny+86BMtyn+hT9jQ@mail.gmail.com>
 <CACmBxytzKK=cNY_tLKFbdpz2YgHaP1-M+ZQm=o7zvifh2LWx_A@mail.gmail.com>
 <CAK8GPyDkRsLPdX=mFVkZmMz_PBGTnBzee5rpRUK0so=NXPOHzQ@mail.gmail.com>
 <CACmBxyvrXyaO8pLOGxuYa8oJRB5+CHqfZLkDsGGwAgD6Obw7tQ@mail.gmail.com>
 <CAK8GPyBKWBe_UF7Kuns_YtuAyqsyW-k4nO+TVjWOZz4e2apdww@mail.gmail.com>
 <CACmBxytowhfomqkY0BykAd6BFOMCOubyNtX77OfMRnf3-cfxtQ@mail.gmail.com>
 <5335953.rxPsUz55Rq@even-i700>
 <CACmBxyurenHTuQ7B0gR6Wn7jgBsWhRsW+v1mbVvp6374iztihg@mail.gmail.com>
 <1487682116770-5308840.post@n6.nabble.com>
 <CABUeae9U42AgkWhP2b4F2phgtw=cN_XSHhaiZtSSaqJHO4yGYA@mail.gmail.com>
 <CACmBxyvzhb0p84o5Oig=L31XS0CKn2ZdPOLwZvHoEcbPsNYWYw@mail.gmail.com>
Message-ID: <CABUeae9Ce7+gy-jNorkSN89eTYsxobJ219btqne+c6iTu5y+9Q@mail.gmail.com>

I always thought GEOS tests are dead simple based on lightweight runner.

If something is missing, just add it and submit to GEOS.

Rewriting tests just for the sake of making them based on GTest.
Well...

Mateusz

On 21 Feb 2017 8:10 p.m., "Kurt Schwehr" <schwehr at gmail.com> wrote:

> The geos coverage is okay, but I have a hard time working with it.  I've
> mostly been putting tests for libs that GDAL can be dependent on for lack
> of another place to put them as I can push the code.
>
> On Tue, Feb 21, 2017 at 10:34 AM, Mateusz Loskot <mateusz at loskot.net>
> wrote:
>
>> On 21 February 2017 at 14:01, Mateusz Loskot <mateusz at loskot.net> wrote:
>> > Kurt Schwehr-2 wrote
>> >> Well, it would be great if the GDAL community wants to merge that code.
>> >
>> > +1 - I'd welcome it
>>
>> Is re-writing tests of GDAL dependencies part of the big plan?
>> https://github.com/schwehr/gdal-autotest2/commit/e65e6d5aa03
>> 753c4b9a67e2cec6a8bdbe0997a80)
>>
>> AFAIK, GEOS is covered with tests pretty well.
>>
>> Best regards.
>> --
>> Mateusz Loskot, http://mateusz.loskot.net
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>
> --
> --
> http://schwehr.org
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170221/fbe362f1/attachment-0001.html>

From schwehr at gmail.com  Tue Feb 21 11:46:43 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Tue, 21 Feb 2017 11:46:43 -0800
Subject: [gdal-dev] gdal-autotest2
In-Reply-To: <CABUeae9Ce7+gy-jNorkSN89eTYsxobJ219btqne+c6iTu5y+9Q@mail.gmail.com>
References: <1487045644428-5307801.post@n6.nabble.com>
 <CACmBxyvJQtJNuJxXAo+KoGp4BTpC8aJ+Sjny+86BMtyn+hT9jQ@mail.gmail.com>
 <CACmBxytzKK=cNY_tLKFbdpz2YgHaP1-M+ZQm=o7zvifh2LWx_A@mail.gmail.com>
 <CAK8GPyDkRsLPdX=mFVkZmMz_PBGTnBzee5rpRUK0so=NXPOHzQ@mail.gmail.com>
 <CACmBxyvrXyaO8pLOGxuYa8oJRB5+CHqfZLkDsGGwAgD6Obw7tQ@mail.gmail.com>
 <CAK8GPyBKWBe_UF7Kuns_YtuAyqsyW-k4nO+TVjWOZz4e2apdww@mail.gmail.com>
 <CACmBxytowhfomqkY0BykAd6BFOMCOubyNtX77OfMRnf3-cfxtQ@mail.gmail.com>
 <5335953.rxPsUz55Rq@even-i700>
 <CACmBxyurenHTuQ7B0gR6Wn7jgBsWhRsW+v1mbVvp6374iztihg@mail.gmail.com>
 <1487682116770-5308840.post@n6.nabble.com>
 <CABUeae9U42AgkWhP2b4F2phgtw=cN_XSHhaiZtSSaqJHO4yGYA@mail.gmail.com>
 <CACmBxyvzhb0p84o5Oig=L31XS0CKn2ZdPOLwZvHoEcbPsNYWYw@mail.gmail.com>
 <CABUeae9Ce7+gy-jNorkSN89eTYsxobJ219btqne+c6iTu5y+9Q@mail.gmail.com>
Message-ID: <CACmBxyt0bij+eiVOrbobxUGDKGYxu9bHzV6PAFNv5qD5nqfpMw@mail.gmail.com>

It's often easier to port tests to get the breakout I need that is hard to
do by chaining test runners.  Plus I need to get in there and setup some
fuzzers, which is very not like tut.

On Tue, Feb 21, 2017 at 11:21 AM, Mateusz Loskot <mateusz at loskot.net> wrote:

> I always thought GEOS tests are dead simple based on lightweight runner.
>
> If something is missing, just add it and submit to GEOS.
>
> Rewriting tests just for the sake of making them based on GTest.
> Well...
>
> Mateusz
>
> On 21 Feb 2017 8:10 p.m., "Kurt Schwehr" <schwehr at gmail.com> wrote:
>
>> The geos coverage is okay, but I have a hard time working with it.  I've
>> mostly been putting tests for libs that GDAL can be dependent on for lack
>> of another place to put them as I can push the code.
>>
>> On Tue, Feb 21, 2017 at 10:34 AM, Mateusz Loskot <mateusz at loskot.net>
>> wrote:
>>
>>> On 21 February 2017 at 14:01, Mateusz Loskot <mateusz at loskot.net> wrote:
>>> > Kurt Schwehr-2 wrote
>>> >> Well, it would be great if the GDAL community wants to merge that
>>> code.
>>> >
>>> > +1 - I'd welcome it
>>>
>>> Is re-writing tests of GDAL dependencies part of the big plan?
>>> https://github.com/schwehr/gdal-autotest2/commit/e65e6d5aa03
>>> 753c4b9a67e2cec6a8bdbe0997a80)
>>>
>>> AFAIK, GEOS is covered with tests pretty well.
>>>
>>> Best regards.
>>> --
>>> Mateusz Loskot, http://mateusz.loskot.net
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>
>>
>>
>> --
>> --
>> http://schwehr.org
>>
>


-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170221/d41a28c1/attachment.html>

From stell4sia at gmail.com  Wed Feb 22 01:18:23 2017
From: stell4sia at gmail.com (stellasia)
Date: Wed, 22 Feb 2017 10:18:23 +0100
Subject: [gdal-dev] [feature request] add smoothing parameter to gdal_grid
	invdistnn algorithm?
Message-ID: <CAK5rj+idtO-u-AnLChbvaMu2nDkkNiuEVDHTJrczgm6OPErpKQ@mail.gmail.com>

Hello,

I am a new gdal user (less than one month), trying to generate a raster
with gdal_grid utility.

I was wondering why there isn't a smoothing parameter with the invdistnn
algorithm in gdal_grid?

I am facing a problem where I would like to have both the nearest
neighbours (to limit radius of influence) and the smoothing in the average
computation, but maybe I misunderstood the purpose.

If you think that adding a smoothing in this case is relevant, I can submit
a PR with a patch suggestion.

Best,
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170222/c995e6f7/attachment.html>

From bontepaarden at gmail.com  Wed Feb 22 02:43:41 2017
From: bontepaarden at gmail.com (Paul Meems)
Date: Wed, 22 Feb 2017 11:43:41 +0100
Subject: [gdal-dev] C# version of gdallocationinfo
Message-ID: <CAHNf2YRbewDvkk0XayMp=C2ZUcr2oCw7ymvtuBeWgggujczwrA@mail.gmail.com>

Hi list,

I need to get the pixel value of my tiff-file.
Using gdallocationinfo.exe I can get the correct value:
gdallocationinfo -wgs84 -valonly 201612021600.tif 5.22543631866552
51.2581472440154

Now I need to do this in my C# code. Using examples I found with Google I
came up with this piece of code, I also looked at the C++ code of
gdallocationinfo

public string GdalLocate(string input, double x, double y, bool inWgs84 =
true)
{
    using (var ds = Gdal.Open(input, Access.GA_ReadOnly))
    {
        if (ds == null) throw new Exception("Can't open GDAL dataset: " +
input);

        int col;
        int row;
        if (inWgs84)
        {
            var pGT = new double[6];
            ds.GetGeoTransform(pGT);
            col = (int) Math.Floor((x - pGT[0]) / pGT[1]);
            row = (int) Math.Floor((pGT[3] - y) / -pGT[5]);
        }
        else
        {
            col = (int)Math.Floor(x);
            row = (int)Math.Floor(y);
        }

        // Check input:
        var rows = ds.RasterYSize;
        var cols = ds.RasterXSize;
        if (col < 0 || row < 0 || col > cols || row > rows)
        {
            // Location is off this file! No further details to report.
            return string.Empty;
        }

        // Get the first band:
        using (var band = ds.GetRasterBand(1))
        {
            // Creating a C# array to hold the image data
            var byteBuffer = new byte[cols * rows];
            // Read the raster
            var IsThereAnError = band.ReadRaster(row, col, 1, 1,
byteBuffer, 1, 1, 0, 0);
            if (IsThereAnError == CPLErr.CE_None) return
byteBuffer[0].ToString();

            throw new Exception("Error in reading raster using
GdalLocate.");
        }
    }
}

The command line call returns 29.
My method using the same input file and coordinates returns 1.

So I must be missing something!

Thanks in advanced for any help you can provide.

Paul
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170222/0da77f86/attachment.html>

From giuseppe.amatulli at gmail.com  Mon Feb 20 17:25:00 2017
From: giuseppe.amatulli at gmail.com (Giuseppe Amatulli)
Date: Mon, 20 Feb 2017 20:25:00 -0500
Subject: [gdal-dev] Summer School in Geocomputation - Italy - June 2017
Message-ID: <CAKoiDH+w2CZxa1q+Y8Xnmco6NygZPxziHdx7FwsF1vmcNvgjDw@mail.gmail.com>

Dear colleagues,

registration open now for our* International Summer School* organized by
Spatial Ecology (www.spatial-ecology.net)
<http://www.spatial-ecology.net/> held
at the Univ. of Basilicata, in the magnificent town Matera, Italy.

*Geocomputation using free and Open Source Software** (19th-23th June 2017)*

A 5 days intense experience opening new horizons on the use of the vast
potentials of Linux environment and the command line approach for data
processing using Bash, AWK, Python, GRASS, QGIS, GDAL/OGR, R, PKtools,
OpenForis. We will guide newbies and experienced GIS users who have never
used a command line terminal to a stage which will allow them to understand
and apply very advanced open source data processing routines. Our focus is
to enhance a self-learning approach. This allows participants to keep on
progressing and improving their skills in a continuously evolving
technological environment.

More information and registration:

www.spatial-ecology.net <https://www.spatial-ecology.net/upcoming-events>
www.spatial-ecology.net/upcoming-events
www.facebook.com/spatialecology > see events
twitter: @BigDataEcology

Best regards
Spatial Ecology – Team

-- 
Giuseppe Amatulli, Ph.D.

Research scientist at
Yale School of Forestry & Environmental Studies
Yale Center for Research Computing
Center for Science and Social Science Information
New Haven, 06511
Teaching: http://spatial-ecology.org
Work:  https://environment.yale.edu/profile/giuseppe-amatulli/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170220/3899bc82/attachment.html>

From even.rouault at spatialys.com  Thu Feb 23 02:49:25 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 23 Feb 2017 11:49:25 +0100
Subject: [gdal-dev] Conformity of GeoPackage rasters generated by GDAL
Message-ID: <1674824.InJIktMr5z@even-i700>

Hi,

Thanks to interoperability tests led by Brian Osborn from the sample GeoPackage with 
elevation data I generated, he spotted a more general issue with the registration of raster 
tiles that can cause spatial registration to be wrong when GDAL generated raster .gpkg are 
read by other implementations (to give full credit i think Brad Hards noticed this earlier)

I've fixed the issue in trunk and 2.1 branch per
https://trac.osgeo.org/gdal/ticket/6826

So if you need to ensure interoperability with other implementations, you'd better fetch the 
fix and regenerate your productions.

Note: You don't necessarilty need to regenerate the whole .gpkg, but you need to correct the 
content of gpkg_tile_matrix, so that for zoom_level = Z > 0 :
matrix_width(Z) = 2^Z * matrix_width(zoom_level=0)
matrix_height(Z) = 2^Z * matrix_height(zoom_level=0)

This is only when using no overview or power-of-two overviews. For non power-of-two 
overviews (which is an extension), I think there might be still issues.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170223/0a434e69/attachment.html>

From boehm at geoinformationsdienst.de  Fri Feb 24 04:31:23 2017
From: boehm at geoinformationsdienst.de (=?UTF-8?Q?Markus_B=c3=b6hm?=)
Date: Fri, 24 Feb 2017 13:31:23 +0100
Subject: [gdal-dev] scidb (array db): Perhaps backend for WMS, WCS,
 WPS with gdal and mapserver
Message-ID: <43af816c-0da3-efaf-bf5d-7c8863101a66@geoinformationsdienst.de>

Dear list,

I hope this question is in the right place here. If not -- sorry.

We do some experiments with the community edition of scidb 
(http://www.paradigm4.com/), an array database founded by Michael 
Stonebraker. Scidb is often used with R und python. There are allready 
gdal drivers (https://github.com/appelmar/scidb4gdal) to load data into 
scidb.

I think those drivers are mainly for import and export of data in/from 
scidb. I tried to use that gdal driver in mapserver to visualize an 
gdal-uploaded array. It works already but seems to be  slow. Maybe I am 
using it wrong but I suppose that this driver is not intended to perform 
well for example in mapserver.

Perhaps an enhanced scidb driver would be an interesting objective for 
gdal. Scidb seems to be great with arrays and mulitple dimensions can be 
worked with. In my opinion it would be quite interesting to have scidb 
as backend for WMS, WCS and WPS services that could be set up with 
mapserver and gdal. I think gdal would be the right tool to implement a 
driver.

Perhaps someone already thought about a combination of scidb, gdal and 
mapserver?

Cheers,

Markus




From p.baumann at jacobs-university.de  Sat Feb 25 04:37:57 2017
From: p.baumann at jacobs-university.de (Peter Baumann)
Date: Sat, 25 Feb 2017 13:37:57 +0100
Subject: [gdal-dev] scidb (array db): Perhaps backend for WMS, WCS,
 WPS with gdal and mapserver
In-Reply-To: <43af816c-0da3-efaf-bf5d-7c8863101a66@geoinformationsdienst.de>
References: <43af816c-0da3-efaf-bf5d-7c8863101a66@geoinformationsdienst.de>
Message-ID: <d9f979b3-61d0-987a-1d09-d4c84b2331e3@jacobs-university.de>

Hi Markus & listers,

just to avoid someone doing duplicate work: the rasdaman array database
(www.rasdaman.org) is supporting these standards already, being official OGC and
INSPIRE reference implementation. In doing so rasdaman utilizes GDAL for both
import and export, so there is a fruitful collaboration between both open-source
projects already.

For those who do not know rasdaman:

- it supports WMS, WCS, WCPS, and WPS as geo interfaces, and our users are
regularly combining rasdaman with MapServer, OpenLayers, Leaflet, QGIS, NASA
WorldWind, python, and many more.

- it allows federated queries, caching, distributed array joins and several more
goodies that make it stand out.

- Public installations exceed 250 TB. In the US, rasdaman has been tagged a top
Big Data solution (the only Array DB that has received this recognition) [3].
Benchmarks show superior performance, see [1] and evaluations published at AGU
2015 by U Wisconsin/Madison and GMU. G. Landgraf, senior manager at the European
Space Agency, this January stated that "The RASDAMAN product is currently the
world leading environment in this domain and the standard working horse for OGC
standardisation on these innovative data access interfaces."

- rasdaman has pioneered the field of array databases [0]; SciDB and several
others (SciQL, Teradata, Ophidia, Google Earth Engine, ...you name it) are
taking up the rasdaman idea of a query language with a dedicated server
architecture (ours being based on "tile streaming").

- The rasdaman array query language is blueprint for the several "Big Data"
standards, including:

    * ISO SQL MDA (Multi-DImensional Arrays); after thorough investigation of
all options (including SciDB an PostGIS Raster) the rasdaman query language has
been selected by the ISO SQL group as the only viable alternative. [1]

    * OGC Web Coverage Processing Service (WCPS), an array language with geo
semantics. [2]

- it is part of OSGeo Live DVD since a couple of years.

We very much encourage interested developers to team up for joint GDAL/rasdaman
work (futher projects welcome, of course)! And scientific publications, of course.

cheers,

Peter

[0] Peter Baumann: /On the Management of Multidimensional Discrete Data./ VLDB
Journal 4(3)1994, Special Issue on Spatial Database Systems, pp. 401 - 444

[1] D. Misev, P. Baumann: /Enhancing Science Support in SQL/. Proc. Workshop
Data and Computational Science Technologies for Earth Science Research
(co-located with IEEE Big Data), Santa Clara, US, October 29, 2015[2] P.
Baumann: /The OGC Web Coverage Processing Service (WCPS) Standard
<http://www.springerlink.com/openurl.asp?genre=article&id=doi:10.1007/s10707-009-0087-2>/.
Geoinformatica <http://www.springerlink.com/content/100268/>, 14(4)2010, pp 447-479
[2] G. Merticariu, D. Misev, P. Baumann: /Measuring Storage Access Performance
in Array Databases/. Proc. 7th Workshop on Big Data Benchmarking (WBDB),
December 14-15, 2015, New Delhi, India
[3] http://bigdata.cioreview.com/vendor/2016/rasdaman

On 02/24/2017 01:31 PM, Markus Böhm wrote:
> Dear list,
>
> I hope this question is in the right place here. If not -- sorry.
>
> We do some experiments with the community edition of scidb
> (http://www.paradigm4.com/), an array database founded by Michael Stonebraker.
> Scidb is often used with R und python. There are allready gdal drivers
> (https://github.com/appelmar/scidb4gdal) to load data into scidb.
>
> I think those drivers are mainly for import and export of data in/from scidb.
> I tried to use that gdal driver in mapserver to visualize an gdal-uploaded
> array. It works already but seems to be  slow. Maybe I am using it wrong but I
> suppose that this driver is not intended to perform well for example in
> mapserver.
>
> Perhaps an enhanced scidb driver would be an interesting objective for gdal.
> Scidb seems to be great with arrays and mulitple dimensions can be worked
> with. In my opinion it would be quite interesting to have scidb as backend for
> WMS, WCS and WPS services that could be set up with mapserver and gdal. I
> think gdal would be the right tool to implement a driver.
>
> Perhaps someone already thought about a combination of scidb, gdal and mapserver?
>
> Cheers,
>
> Markus
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Dr. Peter Baumann
 - Professor of Computer Science, Jacobs University Bremen
   www.faculty.jacobs-university.de/pbaumann
   mail: p.baumann at jacobs-university.de
   tel: +49-421-200-3178, fax: +49-421-200-493178
 - Executive Director, rasdaman GmbH Bremen (HRB 26793)
   www.rasdaman.com, mail: baumann at rasdaman.com
   tel: 0800-rasdaman, fax: 0800-rasdafax, mobile: +49-173-5837882
"Si forte in alienas manus oberraverit hec peregrina epistola incertis ventis dimissa, sed Deo commendata, precamur ut ei reddatur cui soli destinata, nec preripiat quisquam non sibi parata." (mail disclaimer, AD 1083)


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170225/8ce1689b/attachment.html>

From johan.de.braak at eleaf.com  Mon Feb 27 00:20:46 2017
From: johan.de.braak at eleaf.com (Johan de Braak)
Date: Mon, 27 Feb 2017 01:20:46 -0700 (MST)
Subject: [gdal-dev] GDAL : Access window out of range in RasterIO and
 blank buffer in warp for same block extents
In-Reply-To: <1487030892573-5307794.post@n6.nabble.com>
References: <1487030892573-5307794.post@n6.nabble.com>
Message-ID: <1488183646197-5309599.post@n6.nabble.com>

asmita wrote
> I tried to investigate the read with simple read, however I got this error
> :
> Access window out of range in RasterIO().  Requested
> (0,24104) of size 430x450 on raster of 11783x14544.
> (...)
> Anyways, the point is that how should I proceed with to get successful
> read of the intermediate file created from two or more tiffs to create a
> mosaic?

The point of the error message is that you are trying to access more pixels
than are available in your raster. What helps, in general, is to think of
what the extent of the project you are working on is, and tell gdal (using
-te or -projwin) what extent that is. If your input rasters have different
extents / projections, use gdalwarp to fix this, before continuing with
mosaic creation.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/GDAL-Access-window-out-of-range-in-RasterIO-and-blank-buffer-in-warp-for-same-block-extents-tp5307794p5309599.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From browtayl at oregonstate.edu  Mon Feb 27 03:55:54 2017
From: browtayl at oregonstate.edu (Taylor Alexander Brown)
Date: Mon, 27 Feb 2017 03:55:54 -0800
Subject: [gdal-dev] ENVI Rotation Bug Fix
Message-ID: <a618291a-3dfc-d22f-2348-10d098058cfd@oregonstate.edu>

Greetings GDAL Community,

I am developing an application [0] to process georeferenced raster
hyperspectral imagery in ENVI format from NASA's Airborne
Visual/Infrared Imaging Spectrometer (AVIRIS) [1].

The `map info` section of the header files contain an undocumented [2]
rotation field which is currently ignored by GDAL. As a result, the
image is rotated incorrectly when I process it with `gdalwarp` or the
GDAL Python API. Furthermore, the image is scaled incorrectly when I try
to override the geotransform.

I documented my experiences on the GIS Stack Exchange [3]. It has
previously been described on the GDAL mailing list [4] and bug tracker
[5]. I believe this issue also affects ASTER imagery [6][7].

I have implemented a fix based off of branch `tags/2.1.3` and shared my
code on GitHub [8]. It reads the `units` and `rotation` parameter from
the `map info` section and uses these to calculate the geotransform. The
scaling was off because the code expected the `units` parameter to be
the last element in the list, when in my case it was the second to last.
You can verify this behavior with the single-band image I have been
using for testing [9].

You are welcome to evaluate my code and contribute it back to the
library. I am a novice at both GDAL and GIS, so there may well be
problems. I would be willing to submit a pull request against your
GitHub mirror if desired.


Peace,

Taylor Alexander Brown


[0] https://github.com/capstone-coal/pycoal
[1] https://aviris.jpl.nasa.gov/
[2] http://www.harrisgeospatial.com/docs/enviheaderfiles.html
[3]
http://gis.stackexchange.com/questions/229952/rotate-envi-hyperspectral-imagery-with-gdal
[4] https://lists.osgeo.org/pipermail/gdal-dev/2013-January/035146.html
[5] https://trac.osgeo.org/gdal/ticket/1778
[6] http://yceo.yale.edu/opening-aster-files-envi
[7] http://yceo.yale.edu/faq-page#t2n504
[8]
https://github.com/OSGeo/gdal/compare/tags/2.1.3...browtayl:fix-envi-rotation?expand=1
[9] https://drive.google.com/open?id=0BxysdOuBmaIGalY5dVhCa1Y5M0k

From even.rouault at spatialys.com  Mon Feb 27 04:33:46 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 27 Feb 2017 13:33:46 +0100
Subject: [gdal-dev] ENVI Rotation Bug Fix
In-Reply-To: <a618291a-3dfc-d22f-2348-10d098058cfd@oregonstate.edu>
References: <a618291a-3dfc-d22f-2348-10d098058cfd@oregonstate.edu>
Message-ID: <4526577.4JDPO7xart@even-i700>

On lundi 27 février 2017 03:55:54 CET Taylor Alexander Brown wrote:
> Greetings GDAL Community,
> 
> I am developing an application [0] to process georeferenced raster
> hyperspectral imagery in ENVI format from NASA's Airborne
> Visual/Infrared Imaging Spectrometer (AVIRIS) [1].
> 
> The `map info` section of the header files contain an undocumented [2]
> rotation field which is currently ignored by GDAL. As a result, the
> image is rotated incorrectly when I process it with `gdalwarp` or the
> GDAL Python API. Furthermore, the image is scaled incorrectly when I try
> to override the geotransform.
> 
> I documented my experiences on the GIS Stack Exchange [3]. It has
> previously been described on the GDAL mailing list [4] and bug tracker
> [5]. I believe this issue also affects ASTER imagery [6][7].
> 
> I have implemented a fix based off of branch `tags/2.1.3` and shared my
> code on GitHub [8]. It reads the `units` and `rotation` parameter from
> the `map info` section and uses these to calculate the geotransform. The
> scaling was off because the code expected the `units` parameter to be
> the last element in the list, when in my case it was the second to last.
> You can verify this behavior with the single-band image I have been
> using for testing [9].
> 
> You are welcome to evaluate my code and contribute it back to the
> library. I am a novice at both GDAL and GIS, so there may well be
> problems. I would be willing to submit a pull request against your
> GitHub mirror if desired.

Yes, please issue a P.R. against the github mirror. Preferably against trunk which has more 
complete regression testing.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170227/86b3ff3b/attachment.html>

From damian.dixon at gmail.com  Mon Feb 27 05:01:52 2017
From: damian.dixon at gmail.com (Damian Dixon)
Date: Mon, 27 Feb 2017 13:01:52 +0000
Subject: [gdal-dev] ENVI Rotation Bug Fix
In-Reply-To: <a618291a-3dfc-d22f-2348-10d098058cfd@oregonstate.edu>
References: <a618291a-3dfc-d22f-2348-10d098058cfd@oregonstate.edu>
Message-ID: <CAJjdW1wnNOUxS1EWwEQFDDTESjOe9d_rVs=-Fw_GfRuuWeGBRw@mail.gmail.com>

Hi Taylor,

I'm just lurking on the mailing list myself.

I had a look at the code changes, as this is one of the formats I'm
interested in, and one point springs out at me:

const double PI = atan(1.0) * 4;

I find this line potentially a confusing way to define PI, particularly
when you combine it with (PI/180) later.

Personally I would use M_PI.

Regards
Damian



On 27 February 2017 at 11:55, Taylor Alexander Brown <
browtayl at oregonstate.edu> wrote:

> Greetings GDAL Community,
>
> I am developing an application [0] to process georeferenced raster
> hyperspectral imagery in ENVI format from NASA's Airborne
> Visual/Infrared Imaging Spectrometer (AVIRIS) [1].
>
> The `map info` section of the header files contain an undocumented [2]
> rotation field which is currently ignored by GDAL. As a result, the
> image is rotated incorrectly when I process it with `gdalwarp` or the
> GDAL Python API. Furthermore, the image is scaled incorrectly when I try
> to override the geotransform.
>
> I documented my experiences on the GIS Stack Exchange [3]. It has
> previously been described on the GDAL mailing list [4] and bug tracker
> [5]. I believe this issue also affects ASTER imagery [6][7].
>
> I have implemented a fix based off of branch `tags/2.1.3` and shared my
> code on GitHub [8]. It reads the `units` and `rotation` parameter from
> the `map info` section and uses these to calculate the geotransform. The
> scaling was off because the code expected the `units` parameter to be
> the last element in the list, when in my case it was the second to last.
> You can verify this behavior with the single-band image I have been
> using for testing [9].
>
> You are welcome to evaluate my code and contribute it back to the
> library. I am a novice at both GDAL and GIS, so there may well be
> problems. I would be willing to submit a pull request against your
> GitHub mirror if desired.
>
>
> Peace,
>
> Taylor Alexander Brown
>
>
> [0] https://github.com/capstone-coal/pycoal
> [1] https://aviris.jpl.nasa.gov/
> [2] http://www.harrisgeospatial.com/docs/enviheaderfiles.html
> [3]
> http://gis.stackexchange.com/questions/229952/rotate-envi-
> hyperspectral-imagery-with-gdal
> [4] https://lists.osgeo.org/pipermail/gdal-dev/2013-January/035146.html
> [5] https://trac.osgeo.org/gdal/ticket/1778
> [6] http://yceo.yale.edu/opening-aster-files-envi
> [7] http://yceo.yale.edu/faq-page#t2n504
> [8]
> https://github.com/OSGeo/gdal/compare/tags/2.1.3...browtayl:
> fix-envi-rotation?expand=1
> [9] https://drive.google.com/open?id=0BxysdOuBmaIGalY5dVhCa1Y5M0k
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170227/0ee2563f/attachment-0001.html>

From browtayl at oregonstate.edu  Mon Feb 27 14:12:46 2017
From: browtayl at oregonstate.edu (Brown, Taylor Alexander)
Date: Mon, 27 Feb 2017 14:12:46 -0800
Subject: [gdal-dev] ENVI Rotation Bug Fix
In-Reply-To: <CAJjdW1wnNOUxS1EWwEQFDDTESjOe9d_rVs=-Fw_GfRuuWeGBRw@mail.gmail.com>
References: <a618291a-3dfc-d22f-2348-10d098058cfd@oregonstate.edu>
 <CAJjdW1wnNOUxS1EWwEQFDDTESjOe9d_rVs=-Fw_GfRuuWeGBRw@mail.gmail.com>
Message-ID: <CALBeTKL-_i177ni87837pVhxM0QAGwJnmBb_hQO-A-j2yzWViw@mail.gmail.com>

Damian,

I agree that it would be preferable to use a predefined constant. However,
I was under the impression that M_PI is a compiler extension and not part
of standard C++, so I wanted to make sure it was compatible. If using M_PI
is acceptable, I would be happy to change it. I will be submitting my pull
request shortly.


Taylor

On Mon, Feb 27, 2017 at 5:01 AM, Damian Dixon <damian.dixon at gmail.com>
wrote:

> Hi Taylor,
>
> I'm just lurking on the mailing list myself.
>
> I had a look at the code changes, as this is one of the formats I'm
> interested in, and one point springs out at me:
>
> const double PI = atan(1.0) * 4;
>
> I find this line potentially a confusing way to define PI, particularly
> when you combine it with (PI/180) later.
>
> Personally I would use M_PI.
>
> Regards
> Damian
>
>
>
> On 27 February 2017 at 11:55, Taylor Alexander Brown <
> browtayl at oregonstate.edu> wrote:
>
>> Greetings GDAL Community,
>>
>> I am developing an application [0] to process georeferenced raster
>> hyperspectral imagery in ENVI format from NASA's Airborne
>> Visual/Infrared Imaging Spectrometer (AVIRIS) [1].
>>
>> The `map info` section of the header files contain an undocumented [2]
>> rotation field which is currently ignored by GDAL. As a result, the
>> image is rotated incorrectly when I process it with `gdalwarp` or the
>> GDAL Python API. Furthermore, the image is scaled incorrectly when I try
>> to override the geotransform.
>>
>> I documented my experiences on the GIS Stack Exchange [3]. It has
>> previously been described on the GDAL mailing list [4] and bug tracker
>> [5]. I believe this issue also affects ASTER imagery [6][7].
>>
>> I have implemented a fix based off of branch `tags/2.1.3` and shared my
>> code on GitHub [8]. It reads the `units` and `rotation` parameter from
>> the `map info` section and uses these to calculate the geotransform. The
>> scaling was off because the code expected the `units` parameter to be
>> the last element in the list, when in my case it was the second to last.
>> You can verify this behavior with the single-band image I have been
>> using for testing [9].
>>
>> You are welcome to evaluate my code and contribute it back to the
>> library. I am a novice at both GDAL and GIS, so there may well be
>> problems. I would be willing to submit a pull request against your
>> GitHub mirror if desired.
>>
>>
>> Peace,
>>
>> Taylor Alexander Brown
>>
>>
>> [0] https://github.com/capstone-coal/pycoal
>> [1] https://aviris.jpl.nasa.gov/
>> [2] http://www.harrisgeospatial.com/docs/enviheaderfiles.html
>> [3]
>> http://gis.stackexchange.com/questions/229952/rotate-envi-hy
>> perspectral-imagery-with-gdal
>> [4] https://lists.osgeo.org/pipermail/gdal-dev/2013-January/035146.html
>> [5] https://trac.osgeo.org/gdal/ticket/1778
>> [6] http://yceo.yale.edu/opening-aster-files-envi
>> [7] http://yceo.yale.edu/faq-page#t2n504
>> [8]
>> https://github.com/OSGeo/gdal/compare/tags/2.1.3...browtayl:
>> fix-envi-rotation?expand=1
>> [9] https://drive.google.com/open?id=0BxysdOuBmaIGalY5dVhCa1Y5M0k
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170227/b788e0e6/attachment.html>

From even.rouault at spatialys.com  Mon Feb 27 14:20:20 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 27 Feb 2017 23:20:20 +0100
Subject: [gdal-dev] ENVI Rotation Bug Fix
In-Reply-To: <CALBeTKL-_i177ni87837pVhxM0QAGwJnmBb_hQO-A-j2yzWViw@mail.gmail.com>
References: <a618291a-3dfc-d22f-2348-10d098058cfd@oregonstate.edu>
 <CAJjdW1wnNOUxS1EWwEQFDDTESjOe9d_rVs=-Fw_GfRuuWeGBRw@mail.gmail.com>
 <CALBeTKL-_i177ni87837pVhxM0QAGwJnmBb_hQO-A-j2yzWViw@mail.gmail.com>
Message-ID: <1976112.BiJYVKQ7Vr@even-i700>

On lundi 27 février 2017 14:12:46 CET Brown, Taylor Alexander wrote:
> Damian,
> 
> I agree that it would be preferable to use a predefined constant. However,
> I was under the impression that M_PI is a compiler extension and not part
> of standard C++, so I wanted to make sure it was compatible. If using M_PI
> is acceptable, I would be happy to change it. I will be submitting my pull
> request shortly.

M_PI is #define'd in port/cpl_port.h if not already defined.

> 
> 
> Taylor
> 
> On Mon, Feb 27, 2017 at 5:01 AM, Damian Dixon <damian.dixon at gmail.com>
> 
> wrote:
> > Hi Taylor,
> > 
> > I'm just lurking on the mailing list myself.
> > 
> > I had a look at the code changes, as this is one of the formats I'm
> > interested in, and one point springs out at me:
> > 
> > const double PI = atan(1.0) * 4;
> > 
> > I find this line potentially a confusing way to define PI, particularly
> > when you combine it with (PI/180) later.
> > 
> > Personally I would use M_PI.
> > 
> > Regards
> > Damian
> > 
> > 
> > 
> > On 27 February 2017 at 11:55, Taylor Alexander Brown <
> > 
> > browtayl at oregonstate.edu> wrote:
> >> Greetings GDAL Community,
> >> 
> >> I am developing an application [0] to process georeferenced raster
> >> hyperspectral imagery in ENVI format from NASA's Airborne
> >> Visual/Infrared Imaging Spectrometer (AVIRIS) [1].
> >> 
> >> The `map info` section of the header files contain an undocumented [2]
> >> rotation field which is currently ignored by GDAL. As a result, the
> >> image is rotated incorrectly when I process it with `gdalwarp` or the
> >> GDAL Python API. Furthermore, the image is scaled incorrectly when I try
> >> to override the geotransform.
> >> 
> >> I documented my experiences on the GIS Stack Exchange [3]. It has
> >> previously been described on the GDAL mailing list [4] and bug tracker
> >> [5]. I believe this issue also affects ASTER imagery [6][7].
> >> 
> >> I have implemented a fix based off of branch `tags/2.1.3` and shared my
> >> code on GitHub [8]. It reads the `units` and `rotation` parameter from
> >> the `map info` section and uses these to calculate the geotransform. The
> >> scaling was off because the code expected the `units` parameter to be
> >> the last element in the list, when in my case it was the second to last.
> >> You can verify this behavior with the single-band image I have been
> >> using for testing [9].
> >> 
> >> You are welcome to evaluate my code and contribute it back to the
> >> library. I am a novice at both GDAL and GIS, so there may well be
> >> problems. I would be willing to submit a pull request against your
> >> GitHub mirror if desired.
> >> 
> >> 
> >> Peace,
> >> 
> >> Taylor Alexander Brown
> >> 
> >> 
> >> [0] https://github.com/capstone-coal/pycoal
> >> [1] https://aviris.jpl.nasa.gov/
> >> [2] http://www.harrisgeospatial.com/docs/enviheaderfiles.html
> >> [3]
> >> http://gis.stackexchange.com/questions/229952/rotate-envi-hy
> >> perspectral-imagery-with-gdal
> >> [4] https://lists.osgeo.org/pipermail/gdal-dev/2013-January/035146.html
> >> [5] https://trac.osgeo.org/gdal/ticket/1778
> >> [6] http://yceo.yale.edu/opening-aster-files-envi
> >> [7] http://yceo.yale.edu/faq-page#t2n504
> >> [8]
> >> https://github.com/OSGeo/gdal/compare/tags/2.1.3...browtayl:
> >> fix-envi-rotation?expand=1
> >> [9] https://drive.google.com/open?id=0BxysdOuBmaIGalY5dVhCa1Y5M0k
> >> _______________________________________________
> >> gdal-dev mailing list
> >> gdal-dev at lists.osgeo.org
> >> https://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170227/dc6a938a/attachment-0001.html>

From Tim.Harris at digitalglobe.com  Mon Feb 27 14:57:08 2017
From: Tim.Harris at digitalglobe.com (Tim Harris)
Date: Mon, 27 Feb 2017 22:57:08 +0000
Subject: [gdal-dev] Python gdal.FileFromMemBuffer problem
Message-ID: <15976c3ce23d4ee9bbeccbea500d6619@PW00INFMAI022.ent.ad.dg.local>

I'm trying to use gdal.FileFromMemBuffer to do some in-memory processing, but I ran into what seems to be a 2 GB limit.

If I create a TIF on disk that is just below 2 GB, things work fine:
import gdal
drv = gdal.GetDriverByName("GTiff")
ds = drv.Create("45000.tif", 45000, 45000, 1, gdal.GDT_Byte)
ds = None
with open("45000.tif", "r") as f:
    membuf = f.read()
gdal.FileFromMemBuffer("/vsimem/45000.tif", membuf)
ds = gdal.Open("/vsimem/45000.tif")
print(ds.RasterXSize) -> Prints "45000"

If I repeat this process with a file that is just over 2 GB:
import gdal
drv = gdal.GetDriverByName("GTiff")
ds = drv.Create("48000.tif", 48000, 48000, 1, gdal.GDT_Byte)
ds = None
with open("48000.tif", "r") as f:
    membuf = f.read()
gdal.FileFromMemBuffer("/vsimem/48000.tif", membuf)

On OSX, I get this error:
python2.7(30843,0x7fffa80063c0) malloc: *** mach_vm_map(size=18446744071718969344) failed (error code=3)
*** error: can't allocate region
*** set a breakpoint in malloc_error_break to debug

On Linux, I get no error but if I try to ds = gdal.Open("/vsimem/48000.tif") I get a "no such file or directory" error.

I found this SWIG wrapper function in swig/include/cpl.i:
void wrapper_VSIFileFromMemBuffer( const char* utf8_path, int nBytes, const GByte *pabyData)
{
    GByte* pabyDataDup = (GByte*)VSIMalloc(nBytes);
    if (pabyDataDup == NULL)
            return;
    memcpy(pabyDataDup, pabyData, nBytes);
    VSIFCloseL(VSIFileFromMemBuffer(utf8_path, (GByte*) pabyDataDup, nBytes, TRUE));
}

It seems like the input "int nBytes" is the problem, as it is passed to VSIMalloc whicih takes a size_t type. The int type is signed and 32-bit so it can't handle over 2 * 2^30 (2 GB). It's probably rolling over, then when cast to size_t it is interpreted as that huge size in the OSX error message.

Also, is there any plan to expose the boolean that controls whether it takes ownership of the passed in buffer? As it is now, calling this function requires 2x the memory because of the malloc and memcpy. Maybe the ownership of the buffer is too tricky when dealing with multiple languages and reference counting...

This electronic communication and any attachments may contain confidential and proprietary information of DigitalGlobe, Inc. If you are not the intended recipient, or an agent or employee responsible for delivering this communication to the intended recipient, or if you have received this communication in error, please do not print, copy, retransmit, disseminate or otherwise use the information. Please indicate to the sender that you have received this communication in error, and delete the copy you received.

DigitalGlobe reserves the right to monitor any electronic communication sent or received by its employees, agents or representatives.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170227/4f2d63dd/attachment.html>

From even.rouault at spatialys.com  Mon Feb 27 17:07:17 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 28 Feb 2017 02:07:17 +0100
Subject: [gdal-dev] Python gdal.FileFromMemBuffer problem
In-Reply-To: <15976c3ce23d4ee9bbeccbea500d6619@PW00INFMAI022.ent.ad.dg.local>
References: <15976c3ce23d4ee9bbeccbea500d6619@PW00INFMAI022.ent.ad.dg.local>
Message-ID: <14335647.iOYg0P74n2@even-i700>

Tim,

> It seems like the input "int nBytes" is the problem, as it is passed to
> VSIMalloc whicih takes a size_t type. The int type is signed and 32-bit so
> it can't handle over 2 * 2^30 (2 GB). It's probably rolling over, then when
> cast to size_t it is interpreted as that huge size in the OSX error
> message.

I've fixed the issue per https://trac.osgeo.org/gdal/ticket/6828

> 
> Also, is there any plan to expose the boolean that controls whether it takes
> ownership of the passed in buffer? As it is now, calling this function
> requires 2x the memory because of the malloc and memcpy. Maybe the
> ownership of the buffer is too tricky when dealing with multiple languages
> and reference counting...

Yes ownership might be complicated.

In your above example, you could simplify it a lot by doing :

drv = gdal.GetDriverByName("GTiff")
ds = drv.Create("/vsimem/48000.tif", 48000, 48000, 1, gdal.GDT_Byte)
ds = None

Or if you need to create a "real" file and ingest it into memory, you can do:

drv = gdal.GetDriverByName("GTiff")
ds = drv.Create("48000.tif", 48000, 48000, 1, gdal.GDT_Byte)
ds = None

mem_f = gdal.VSIFOpenL("/vsimem/48000.tif", "wb")
with open("48000.tif", "rb") as f:
    while True:
        membuf = f.read(4096)
        gdal.VSIFWriteL(membuf, 1, len(membuf), mem_f)
        if len(membuf) < 4096:
            break
gdal.VSIFCloseL(mem_f)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170228/196ac105/attachment-0001.html>

From browtayl at oregonstate.edu  Mon Feb 27 19:28:41 2017
From: browtayl at oregonstate.edu (Taylor Alexander Brown)
Date: Mon, 27 Feb 2017 19:28:41 -0800
Subject: [gdal-dev] ENVI Rotation Bug Fix
In-Reply-To: <1976112.BiJYVKQ7Vr@even-i700>
References: <a618291a-3dfc-d22f-2348-10d098058cfd@oregonstate.edu>
 <CAJjdW1wnNOUxS1EWwEQFDDTESjOe9d_rVs=-Fw_GfRuuWeGBRw@mail.gmail.com>
 <CALBeTKL-_i177ni87837pVhxM0QAGwJnmBb_hQO-A-j2yzWViw@mail.gmail.com>
 <1976112.BiJYVKQ7Vr@even-i700>
Message-ID: <0b415b13-c391-e697-ead2-35136399cfda@oregonstate.edu>

I have pushed the requested changes to a pull request:
https://github.com/OSGeo/gdal/pull/197


Taylor

On 02/27/2017 02:20 PM, Even Rouault wrote:
> On lundi 27 février 2017 14:12:46 CET Brown, Taylor Alexander wrote:
> 
>> Damian,
> 
>>
> 
>> I agree that it would be preferable to use a predefined constant. However,
> 
>> I was under the impression that M_PI is a compiler extension and not part
> 
>> of standard C++, so I wanted to make sure it was compatible. If using M_PI
> 
>> is acceptable, I would be happy to change it. I will be submitting my pull
> 
>> request shortly.
> 
>  
> 
> M_PI is #define'd in port/cpl_port.h if not already defined.
> 
>  
> 
>>
> 
>>
> 
>> Taylor
> 
>>
> 
>> On Mon, Feb 27, 2017 at 5:01 AM, Damian Dixon <damian.dixon at gmail.com>
> 
>>
> 
>> wrote:
> 
>> > Hi Taylor,
> 
>> >
> 
>> > I'm just lurking on the mailing list myself.
> 
>> >
> 
>> > I had a look at the code changes, as this is one of the formats I'm
> 
>> > interested in, and one point springs out at me:
> 
>> >
> 
>> > const double PI = atan(1.0) * 4;
> 
>> >
> 
>> > I find this line potentially a confusing way to define PI, particularly
> 
>> > when you combine it with (PI/180) later.
> 
>> >
> 
>> > Personally I would use M_PI.
> 
>> >
> 
>> > Regards
> 
>> > Damian
> 
>> >
> 
>> >
> 
>> >
> 
>> > On 27 February 2017 at 11:55, Taylor Alexander Brown <
> 
>> >
> 
>> > browtayl at oregonstate.edu> wrote:
> 
>> >> Greetings GDAL Community,
> 
>> >>
> 
>> >> I am developing an application [0] to process georeferenced raster
> 
>> >> hyperspectral imagery in ENVI format from NASA's Airborne
> 
>> >> Visual/Infrared Imaging Spectrometer (AVIRIS) [1].
> 
>> >>
> 
>> >> The `map info` section of the header files contain an undocumented [2]
> 
>> >> rotation field which is currently ignored by GDAL. As a result, the
> 
>> >> image is rotated incorrectly when I process it with `gdalwarp` or the
> 
>> >> GDAL Python API. Furthermore, the image is scaled incorrectly when
> I try
> 
>> >> to override the geotransform.
> 
>> >>
> 
>> >> I documented my experiences on the GIS Stack Exchange [3]. It has
> 
>> >> previously been described on the GDAL mailing list [4] and bug tracker
> 
>> >> [5]. I believe this issue also affects ASTER imagery [6][7].
> 
>> >>
> 
>> >> I have implemented a fix based off of branch `tags/2.1.3` and shared my
> 
>> >> code on GitHub [8]. It reads the `units` and `rotation` parameter from
> 
>> >> the `map info` section and uses these to calculate the
> geotransform. The
> 
>> >> scaling was off because the code expected the `units` parameter to be
> 
>> >> the last element in the list, when in my case it was the second to
> last.
> 
>> >> You can verify this behavior with the single-band image I have been
> 
>> >> using for testing [9].
> 
>> >>
> 
>> >> You are welcome to evaluate my code and contribute it back to the
> 
>> >> library. I am a novice at both GDAL and GIS, so there may well be
> 
>> >> problems. I would be willing to submit a pull request against your
> 
>> >> GitHub mirror if desired.
> 
>> >>
> 
>> >>
> 
>> >> Peace,
> 
>> >>
> 
>> >> Taylor Alexander Brown
> 
>> >>
> 
>> >>
> 
>> >> [0] https://github.com/capstone-coal/pycoal
> 
>> >> [1] https://aviris.jpl.nasa.gov/
> 
>> >> [2] http://www.harrisgeospatial.com/docs/enviheaderfiles.html
> 
>> >> [3]
> 
>> >> http://gis.stackexchange.com/questions/229952/rotate-envi-hy
> 
>> >> perspectral-imagery-with-gdal
> 
>> >> [4] https://lists.osgeo.org/pipermail/gdal-dev/2013-January/035146.html
> 
>> >> [5] https://trac.osgeo.org/gdal/ticket/1778
> 
>> >> [6] http://yceo.yale.edu/opening-aster-files-envi
> 
>> >> [7] http://yceo.yale.edu/faq-page#t2n504
> 
>> >> [8]
> 
>> >> https://github.com/OSGeo/gdal/compare/tags/2.1.3...browtayl:
> 
>> >> fix-envi-rotation?expand=1
> 
>> >> [9] https://drive.google.com/open?id=0BxysdOuBmaIGalY5dVhCa1Y5M0k
> 
>> >> _______________________________________________
> 
>> >> gdal-dev mailing list
> 
>> >> gdal-dev at lists.osgeo.org
> 
>> >> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
>  
> 
>  
> 
> -- 
> 
> Spatialys - Geospatial professional services
> 
> http://www.spatialys.com
> 

From jukka.rahkonen at maanmittauslaitos.fi  Tue Feb 28 00:06:55 2017
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Tue, 28 Feb 2017 08:06:55 +0000
Subject: [gdal-dev] Don't we have any ideas for GSoC 2017?
Message-ID: <1488269244609.94447@maanmittauslaitos.fi>

Hi,

OSGeo is accepted as an organization for the Google Summer of Code 2017 but there are no GDAL related ideas on https://wiki.osgeo.org/wiki/Google_Summer_of_Code_2017_Ideas. Could we raise some of the old ideas or discover some brand new ones?

-Jukka Rahkonen-

From CABO at NIRAS.DK  Tue Feb 28 02:16:19 2017
From: CABO at NIRAS.DK (=?utf-8?B?Q2FzcGVyIELDuHJnZXNlbiAoQ0FCTyk=?=)
Date: Tue, 28 Feb 2017 10:16:19 +0000
Subject: [gdal-dev] Don't we have any ideas for GSoC 2017?
In-Reply-To: <1488269244609.94447@maanmittauslaitos.fi>
References: <1488269244609.94447@maanmittauslaitos.fi>
Message-ID: <BCF6B63AE0B25941A7F56567B58A2805C5829101@allkexa1.NIRAS.INT>

Hi,

I don't know if the idea is too simple, but implementing indexing on VRT files would be great to have. I thinks it's currently a feature request.


Regards, Casper


-----Original Message-----
From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Rahkonen Jukka (MML)
Sent: 28. februar 2017 09:07
To: 'gdal-dev at lists.osgeo.org' (gdal-dev at lists.osgeo.org)
Subject: [gdal-dev] Don't we have any ideas for GSoC 2017?

Hi,

OSGeo is accepted as an organization for the Google Summer of Code 2017 but there are no GDAL related ideas on https://wiki.osgeo.org/wiki/Google_Summer_of_Code_2017_Ideas. Could we raise some of the old ideas or discover some brand new ones?

-Jukka Rahkonen-
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev

From mateusz at loskot.net  Tue Feb 28 02:26:50 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue, 28 Feb 2017 11:26:50 +0100
Subject: [gdal-dev] Don't we have any ideas for GSoC 2017?
In-Reply-To: <BCF6B63AE0B25941A7F56567B58A2805C5829101@allkexa1.NIRAS.INT>
References: <1488269244609.94447@maanmittauslaitos.fi>
 <BCF6B63AE0B25941A7F56567B58A2805C5829101@allkexa1.NIRAS.INT>
Message-ID: <CABUeae_nYHY9KBsV6J9N89CtUD07Ki_YTgLFz9ko2YpZ4xOWRQ@mail.gmail.com>

On 28 February 2017 at 11:16, Casper Børgesen (CABO) <CABO at niras.dk> wrote:
> Hi,
>
> I don't know if the idea is too simple, but implementing indexing on VRT files would be great to have. I thinks it's currently a feature request.

Experiences show, that it's better to choose a simple idea feasible
for a student to complete,
than choose a fancy challenge that doesn't move even half way through.

The indexing sounds like a good idea.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From eloi at openmailbox.org  Tue Feb 28 03:26:54 2017
From: eloi at openmailbox.org (Eloi)
Date: Tue, 28 Feb 2017 12:26:54 +0100
Subject: [gdal-dev] Web Services and Geo-computation expert (Wageningen UR)
Message-ID: <2911c52c5d18047c413cfd7e6787c644@openmailbox.org>

Web Services and Geo-computation expert

Published on: January 20, 2017
Location: Wageningen
Scientific field: Natural Sciences
Application deadline: 10 March 2017.

ISRIC --- World Soil Information is looking for a computer scientist / 
software developer specialized in Web Services and Geo-computation with 
affinity for soil information and soil data management. Major duties 
will be to:

- develop web-based services for ISRIC data products, such as WoSIS, 
SoilGrids and future products. This includes the building of user 
interfaces for data export and data import using Web3.0 technologies,
Web Mapping Services, Web Feature Services and Web Processing Services;
- assist in optimising geo-computation processes (big raster and vector 
data operations) used to develop ISRIC’s global spatial data products;
- assist in installing and optimizing infrastructures for Big Earth Data 
Analytics (Hadoop, SciDB, etc.) develop distributed systems (e.g. 
parallel programming, cloud computation);
- maintain and develop a UML schema for XML data exchange in the soil 
domain;

The position will be a full time position on a temporary basis for a 
period of 1.5 years, with a prospect of extension after successful 
evaluation. A part-time assignment of a minimum of 4 days per week is 
negotiable. Salary depends on knowledge and experience with a minimum of 
€ 3427.= and a maximum of €5330,- gross per month (Dutch university pay 
scale 11/12), based on full-time (38 hours) employment

For more info see:
https://www.academictransfer.com/employer/WUR/vacancy/38823/lang/en/

From jukka.rahkonen at maanmittauslaitos.fi  Tue Feb 28 03:37:59 2017
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Tue, 28 Feb 2017 11:37:59 +0000
Subject: [gdal-dev] Vintage issue #1778 FIXED!
Message-ID: <9283b81afc1a4a49bf1eda9935967390@C119S212VM022.msvyvi.vaha.local>

Hi,

I love these cases, a ten year old issue which got really fixed, not just closed as too old or something https://trac.osgeo.org/gdal/ticket/1778
Hooray Taylor Alexander Brown and Even!

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170228/ab40ab3a/attachment.html>

From TazMainiac at gmail.com  Tue Feb 28 15:25:51 2017
From: TazMainiac at gmail.com (TazMainiac)
Date: Tue, 28 Feb 2017 17:25:51 -0600
Subject: [gdal-dev] ogr2ogr polygon cleanup algorithm?
Message-ID: <CA+DQs57ox6D_NZ2+WtLumyc26qi4RgFzM93Q4Y4=+HfFNpFyhg@mail.gmail.com>

Hi All,

When I use ogr2ogr to process a shape file (into KML for examle) that has
"invalid" polygons (self-intersections or other problems) in it, it "cleans
them up", such that they are valid.  Is there a description anywhere of
what algorithm it's using to do this cleanup?  I tried to take a look at
the code, but it's not obvious where/how that's happening (I'm not terribly
familiar with the GDAL code).

What I'm trying to do myself is load the shape file polygons into
GEOS(Django), and I'm having trouble with these invalid polygons.

Thanks,
Taz
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170228/1b1fb92e/attachment.html>

From victor at amigocloud.com  Tue Feb 28 15:32:29 2017
From: victor at amigocloud.com (Victor Chernetsky)
Date: Tue, 28 Feb 2017 15:32:29 -0800
Subject: [gdal-dev] =?utf-8?q?=28no_subject=29?=
Message-ID: <CAGhxFKVE1eb9CEEjGdxTByxYwfh6hnYkGFr09gRVMhZMxT7wrw@mail.gmail.com>

Hello,

Is there future GDAL release schedule available anywhere? I am actually
wondering about when is GDAL 2.2 is planned to be released? And are there
any more of 2.1.x releases ahead?

Thank you,
*Victor Chernetsky*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170228/c635fc1a/attachment.html>

From even.rouault at spatialys.com  Tue Feb 28 15:36:07 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 01 Mar 2017 00:36:07 +0100
Subject: [gdal-dev] ogr2ogr polygon cleanup algorithm?
In-Reply-To: <CA+DQs57ox6D_NZ2+WtLumyc26qi4RgFzM93Q4Y4=+HfFNpFyhg@mail.gmail.com>
References: <CA+DQs57ox6D_NZ2+WtLumyc26qi4RgFzM93Q4Y4=+HfFNpFyhg@mail.gmail.com>
Message-ID: <3727909.QXWZjcUTmy@even-i700>

On mardi 28 février 2017 17:25:51 CET TazMainiac wrote:
> Hi All,
> 
> When I use ogr2ogr to process a shape file (into KML for examle) that has
> "invalid" polygons (self-intersections or other problems) in it, it "cleans
> them up", such that they are valid.  Is there a description anywhere of
> what algorithm it's using to do this cleanup?  

Hum, there's not really such a cleanup algorithm. When writing a shapefile, there's some 
"topological analysis" to figure out which rings of a (multi)polygon are inside others, so as to 
respect the shapefile specification, but that's all. I'd be surprised that self-intersections of a 
ring are corrected for example.

if you want to explicitly remove invalid geometries, you can do something like:

ogr2ogr out.shp in.kml \
  -sql "SELECT * FROM input_layer WHERE ST_IsValid(geometry)" -dialect SQLite

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170301/be9140c8/attachment.html>

From even.rouault at spatialys.com  Tue Feb 28 15:42:02 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 01 Mar 2017 00:42:02 +0100
Subject: [gdal-dev] Release schedule
In-Reply-To: <CAGhxFKVE1eb9CEEjGdxTByxYwfh6hnYkGFr09gRVMhZMxT7wrw@mail.gmail.com>
References: <CAGhxFKVE1eb9CEEjGdxTByxYwfh6hnYkGFr09gRVMhZMxT7wrw@mail.gmail.com>
Message-ID: <2270443.BXCFQexgxu@even-i700>

Hi,

> Is there future GDAL release schedule available anywhere? I am actually
> wondering about when is GDAL 2.2 is planned to be released?

We should probably try to cut a beta beginning of April (I could do it on the 10th for 
example) to match our habit of yearly release cycle of major versions.

> And are there
> any more of 2.1.x releases ahead?

Probably. Likely after 2.2.0 is out.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170301/83748248/attachment.html>

From thare at usgs.gov  Tue Feb 28 15:58:20 2017
From: thare at usgs.gov (Hare, Trent)
Date: Tue, 28 Feb 2017 16:58:20 -0700
Subject: [gdal-dev] Don't we have any ideas for GSoC 2017?
In-Reply-To: <CABUeae_nYHY9KBsV6J9N89CtUD07Ki_YTgLFz9ko2YpZ4xOWRQ@mail.gmail.com>
References: <1488269244609.94447@maanmittauslaitos.fi>
 <BCF6B63AE0B25941A7F56567B58A2805C5829101@allkexa1.NIRAS.INT>
 <CABUeae_nYHY9KBsV6J9N89CtUD07Ki_YTgLFz9ko2YpZ4xOWRQ@mail.gmail.com>
Message-ID: <CAB6t5t-XKitFXb1CqoeLF5J+Eun88+kF1Y20nf1Oj=VphVJyRw@mail.gmail.com>

I would be a fan of indexing a VRT also.

There have been some good apps written in AMES Stereo Pipeline which could
be "ported" to GDAL trunk. They work within their application so perhaps
they are not needed within GDAL...?

1.) dem_merge (which works for images too). It has a very nice exponential
blend edge option and works for non-square edges. This is a large program
though.
2.) the also have a C++ version of Frank's hsv_merge.py which is much
faster. This is much simpler.
https://github.com/NeoGeographyToolkit/StereoPipeline/tree/master/src/asp/Tools
manual: http://byss.ndc.nasa.gov/stereopipeline/binaries/asp_book-2.5.3.pdf

I would love to see any methods for tonal matching across images. Simple
matching histograms and then running a script through a gdal_translate with
a defined "stretch"..? Or here is a cool method to tonal match using
another layer as the driver. There might not be code is not available (but
it might be explained enough?). Also the author could be contacted.
http://www.sciencedirect.com/science/article/pii/S0032063315300477

just a couple more ideas,
Trent




On Tue, Feb 28, 2017 at 3:26 AM, Mateusz Loskot <mateusz at loskot.net> wrote:

> On 28 February 2017 at 11:16, Casper Børgesen (CABO) <CABO at niras.dk>
> wrote:
> > Hi,
> >
> > I don't know if the idea is too simple, but implementing indexing on VRT
> files would be great to have. I thinks it's currently a feature request.
>
> Experiences show, that it's better to choose a simple idea feasible
> for a student to complete,
> than choose a fancy challenge that doesn't move even half way through.
>
> The indexing sounds like a good idea.
>
> Best regards,
> --
> Mateusz Loskot, http://mateusz.loskot.net
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170228/72297899/attachment-0001.html>

