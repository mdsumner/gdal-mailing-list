From tsvibar at gmail.com  Tue Aug  1 07:05:20 2017
From: tsvibar at gmail.com (Micha Silver)
Date: Tue, 1 Aug 2017 17:05:20 +0300
Subject: [gdal-dev] Revisiting ecw
Message-ID: <CAObswFCntfnQJOZxpHAoAQ5H1wEJe66oL6EWpT2tnpCSHp+raw@mail.gmail.com>

I'm following the thread:
http://osgeo-org.1560.x6.nabble.com/gdal-dev-gdal-2-1-ecw-5-2-1-td5299048.html
trying to compile gdal with ECW support. I have tried this configure:

CXXFLAGS="-D_GLIBCXX_USE_CXX11_ABI=0" ./configure
--prefix=/usr/local/gdal --with-libkml=no
--with-ecw=/home/micha/Downloads/ERDAS-ECW_JPEG_2000_SDK-5.3.0/Desktop_Read-Only/
--with-xml2=no --with-expat=no

to disable KML, xml etc. But I'm still getting compile errors that begin with:
undefined reference to
`kmlengine::Clone(boost::intrusive_ptr<kmldom::Element> const&)'
 and many more after that.
Any suggestions?

Thanks
Micha Silver

tel:  +972 (77) 6449059  cell: +972 (52) 3665918

From even.rouault at spatialys.com  Tue Aug  1 07:09:17 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 01 Aug 2017 16:09:17 +0200
Subject: [gdal-dev] Revisiting ecw
In-Reply-To: <CAObswFCntfnQJOZxpHAoAQ5H1wEJe66oL6EWpT2tnpCSHp+raw@mail.gmail.com>
References: <CAObswFCntfnQJOZxpHAoAQ5H1wEJe66oL6EWpT2tnpCSHp+raw@mail.gmail.com>
Message-ID: <3373338.2hG5xdVrhQ@even-i700>

On mardi 1 août 2017 17:05:20 CEST Micha Silver wrote:
> I'm following the thread:
> http://osgeo-org.1560.x6.nabble.com/gdal-dev-gdal-2-1-ecw-5-2-1-td5299048.ht
> ml trying to compile gdal with ECW support. I have tried this configure:
> 
> CXXFLAGS="-D_GLIBCXX_USE_CXX11_ABI=0" ./configure
> --prefix=/usr/local/gdal --with-libkml=no
> --with-ecw=/home/micha/Downloads/ERDAS-ECW_JPEG_2000_SDK-5.3.0/Desktop_Read-
> Only/ --with-xml2=no --with-expat=no
> 
> to disable KML, xml etc. But I'm still getting compile errors that begin
> with: undefined reference to
> `kmlengine::Clone(boost::intrusive_ptr<kmldom::Element> const&)'
>  and many more after that.
> Any suggestions?

"make clean" if you didn't do it already. It is likely remaining objects that link to libkml from a 
previous ./configure && make

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170801/bc6ebcd3/attachment.html>

From chqzeng at gmail.com  Tue Aug  1 08:08:07 2017
From: chqzeng at gmail.com (C. Zeng)
Date: Tue, 1 Aug 2017 11:08:07 -0400
Subject: [gdal-dev] Need solution for C# setup,
	with error at OSGeo.OGR registration
Message-ID: <CABNxGA0MH1y9PmEkGmaytScJQ0Lckakm_8dJWNgC2FyKsKPQyQ@mail.gmail.com>

​Hello all,

I am trying to setup the GDAL in C#.NET 2015, with an error at the
registration of the Ogr. A previous post
<http://osgeo-org.1560.x6.nabble.com/gdal-dev-Need-solution-for-C-exception-OSGeo-OGR-OgrPINVOKE-td5062693.html#a5329043>
stated the exact same problem but without a solution, I tried to reply in
that post but failed,thus send this email instead.

That previous post described my problem very well:

> "I am using *ogr_csharp.dl*l in my c# program. See the following code
> snippet:
> using OSGeo.OGR;
> namespace Test
> {
>     public class Test
>     {
>         public Test()
>         {
>                 ...
>                   Ogr.RegisterAll();
>         }
>     }
> }
> Then the following exception message was thrown out when the program is
> executed:
> *{"The type initializer for 'OSGeo.OGR.OgrPINVOKE' threw an exception."}
>      *
> *System.Exception {System.TypeInitializationException}*
> Does anyone know how to resolve this issue? "


Some more details for my case. My steps are:
- downloaded the stable or daily stable release (same error later) from here
<http://www.gisinternals.com/query.html?content=filelist&file=release-1800-x64-gdal-2-1-mapserver-7-0.zip>
.
- added the "...\bin" and "...\bin\gdal\csharp" to Environment Variable,
setup a sample project,
- add the 4 "###sharp.dll" from csharp folder to project reference.
- import namespace:  using OSGeo.OGR; using OSGeo.OSR;  and add a simple
line "Ogr.RegisterAll(); "

Then I can successfully build the project, but with the following error
msg. I tried all possible solutions by Google plus this forum such as this
<http://osgeo-org.1560.x6.nabble.com/gdal-dev-GDAL-OGR-64bit-PINVOKE-Exception-td3745305.html>
 and this
<http://osgeo-org.1560.x6.nabble.com/c-Bindings-in-Mono-Linux-td3758565.html#a3758569>
.
test all the x64/x86 , debug/release, switches, no luck.

Any comment is appreciated, thank you!

Chui



--------------------------error message --------------------------




















*Unhandled Exception: System.TypeInitializationException: The type
initializer fo r 'OSGeo.OGR.OgrPINVOKE' threw an exception. --->
System.TypeInitializationExcep tion: The type initializer for
'SWIGExceptionHelper' threw an exception. --->
Sy stem.BadImageFormatException: An attempt was made to load a program with
an inco rrect format. (Exception from HRESULT: 0x8007000B)    at
OSGeo.OGR.OgrPINVOKE.SWIGExceptionHelper.SWIGRegisterExceptionCallbacks_Og
r(ExceptionDelegate
applicationDelegate, ExceptionDelegate arithmeticDelegate,
E xceptionDelegate divideByZeroDelegate, ExceptionDelegate
indexOutOfRangeDelegate , ExceptionDelegate invalidCastDelegate,
ExceptionDelegate invalidOperationDeleg ate, ExceptionDelegate ioDelegate,
ExceptionDelegate nullReferenceDelegate, Exce ptionDelegate
outOfMemoryDelegate, ExceptionDelegate overflowDelegate, Exception Delegate
systemExceptionDelegate)    at
OSGeo.OGR.OgrPINVOKE.SWIGExceptionHelper..cctor()    --- End of inner
exception stack trace ---    at
OSGeo.OGR.OgrPINVOKE.SWIGExceptionHelper..ctor()    at
OSGeo.OGR.OgrPINVOKE..cctor()    --- End of inner exception stack trace
---    at OSGeo.OGR.OgrPINVOKE.RegisterAll()    at
OSGeo.OGR.Ogr.RegisterAll()    at TestProj.Main(String[] args) in
\user\Downloads\Workspace\TestProj\project.cs:line 47*

and also the following log info:



























*'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded
'C:\WINDOWS\Microsoft.Net\assembly\GAC_64\mscorlib\v4.0_4.0.0.0__b77a5c561934e089\mscorlib.dll'.
Cannot find or open the PDB file. 'TestProj.vshost.exe' (CLR v4.0.30319:
TestProj.vshost.exe): Loaded
'C:\WINDOWS\assembly\GAC_MSIL\Microsoft.VisualStudio.HostingProcess.Utilities\14.0.0.0__b03f5f7f11d50a3a\Microsoft.VisualStudio.HostingProcess.Utilities.dll'.
Cannot find or open the PDB file. 'TestProj.vshost.exe' (CLR v4.0.30319:
TestProj.vshost.exe): Loaded
'C:\WINDOWS\Microsoft.Net\assembly\GAC_MSIL\System.Windows.Forms\v4.0_4.0.0.0__b77a5c561934e089\System.Windows.Forms.dll'.
Cannot find or open the PDB file. 'TestProj.vshost.exe' (CLR v4.0.30319:
TestProj.vshost.exe): Loaded
'C:\WINDOWS\Microsoft.Net\assembly\GAC_MSIL\System\v4.0_4.0.0.0__b77a5c561934e089\System.dll'.
Cannot find or open the PDB file. 'TestProj.vshost.exe' (CLR v4.0.30319:
TestProj.vshost.exe): Loaded
'C:\WINDOWS\Microsoft.Net\assembly\GAC_MSIL\System.Drawing\v4.0_4.0.0.0__b03f5f7f11d50a3a\System.Drawing.dll'.
Cannot find or open the PDB file. 'TestProj.vshost.exe' (CLR v4.0.30319:
TestProj.vshost.exe): Loaded
'C:\WINDOWS\assembly\GAC_MSIL\Microsoft.VisualStudio.HostingProcess.Utilities.Sync\14.0.0.0__b03f5f7f11d50a3a\Microsoft.VisualStudio.HostingProcess.Utilities.Sync.dll'.
Cannot find or open the PDB file. 'TestProj.vshost.exe' (CLR v4.0.30319:
TestProj.vshost.exe): Loaded
'C:\WINDOWS\assembly\GAC_MSIL\Microsoft.VisualStudio.Debugger.Runtime\14.0.0.0__b03f5f7f11d50a3a\Microsoft.VisualStudio.Debugger.Runtime.dll'.'TestProj.vshost.exe'
(CLR v4.0.30319: TestProj.vshost.exe): Loaded
'\user\Downloads\Gdal_folder\TestProj\bin\Debug\TestProj.vshost.exe'.
Cannot find or open the PDB file. 'TestProj.vshost.exe' (CLR v4.0.30319:
TestProj.vshost.exe): Loaded
'C:\WINDOWS\Microsoft.Net\assembly\GAC_MSIL\System.Core\v4.0_4.0.0.0__b77a5c561934e089\System.Core.dll'.
Cannot find or open the PDB file. 'TestProj.vshost.exe' (CLR v4.0.30319:
TestProj.vshost.exe): Loaded
'C:\WINDOWS\Microsoft.Net\assembly\GAC_MSIL\System.Xml.Linq\v4.0_4.0.0.0__b77a5c561934e089\System.Xml.Linq.dll'.
Cannot find or open the PDB file. 'TestProj.vshost.exe' (CLR v4.0.30319:
TestProj.vshost.exe): Loaded
'C:\WINDOWS\Microsoft.Net\assembly\GAC_MSIL\System.Data.DataSetExtensions\v4.0_4.0.0.0__b77a5c561934e089\System.Data.DataSetExtensions.dll'.
Cannot find or open the PDB file. 'TestProj.vshost.exe' (CLR v4.0.30319:
TestProj.vshost.exe): Loaded
'C:\WINDOWS\Microsoft.Net\assembly\GAC_MSIL\Microsoft.CSharp\v4.0_4.0.0.0__b03f5f7f11d50a3a\Microsoft.CSharp.dll'.
Cannot find or open the PDB file. 'TestProj.vshost.exe' (CLR v4.0.30319:
TestProj.vshost.exe): Loaded
'C:\WINDOWS\Microsoft.Net\assembly\GAC_64\System.Data\v4.0_4.0.0.0__b77a5c561934e089\System.Data.dll'.
Cannot find or open the PDB file. 'TestProj.vshost.exe' (CLR v4.0.30319:
TestProj.vshost.exe): Loaded
'C:\WINDOWS\Microsoft.Net\assembly\GAC_MSIL\System.Net.Http\v4.0_4.0.0.0__b03f5f7f11d50a3a\System.Net.Http.dll'.
Cannot find or open the PDB file. 'TestProj.vshost.exe' (CLR v4.0.30319:
TestProj.vshost.exe): Loaded
'C:\WINDOWS\Microsoft.Net\assembly\GAC_MSIL\System.Xml\v4.0_4.0.0.0__b77a5c561934e089\System.Xml.dll'.
Cannot find or open the PDB file. The thread 0x2228 has exited with code 0
(0x0). The thread 0x1b30 has exited with code 0 (0x0). The thread 0x2a64
has exited with code 0 (0x0). 'TestProj.vshost.exe' (CLR v4.0.30319:
TestProj.vshost.exe): Loaded
'\user\Downloads\Gdal_folder\TestProj\bin\Debug\TestProj.exe'. Symbols
loaded. The thread 0x2c20 has exited with code 0
(0x0). 'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded
'\user\Downloads\Gdal_folder\TestProj\bin\Debug\ogr_csharp.dll'. Module was
built without symbols. Exception thrown: 'System.DllNotFoundException' in
ogr_csharp.dll Exception thrown: 'System.TypeInitializationException' in
ogr_csharp.dll Exception thrown: 'System.TypeInitializationException' in
ogr_csharp.dll An unhandled exception of type
'System.TypeInitializationException' occurred in ogr_csharp.dll Additional
information: The type initializer for 'OSGeo.OGR.OgrPINVOKE' threw an
exception. The program '[2244] TestProj.vshost.exe' has exited with code 0
(0x0)*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170801/ec0cf526/attachment-0001.html>

From dave at micuisine.com  Tue Aug  1 08:31:22 2017
From: dave at micuisine.com (Dave Liske)
Date: Tue, 1 Aug 2017 11:31:22 -0400 (EDT)
Subject: [gdal-dev] A modified version of your get_soundg.py
In-Reply-To: <CA+YzLBcQ9tzqRt39nPC60R__9vwfqpDYb_DAGye3sVor2SGsdA@mail.gmail.com>
References: <1494005865.375402.1501339591596@email.1and1.com>
 <CA+YzLBcQ9tzqRt39nPC60R__9vwfqpDYb_DAGye3sVor2SGsdA@mail.gmail.com>
Message-ID: <2013301354.583754.1501601482700@email.1and1.com>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170801/c8393cc3/attachment.html>

From szekerest at gmail.com  Tue Aug  1 09:15:18 2017
From: szekerest at gmail.com (Tamas Szekeres)
Date: Tue, 1 Aug 2017 18:15:18 +0200
Subject: [gdal-dev] Need solution for C# setup,
	with error at OSGeo.OGR registration
In-Reply-To: <CABNxGA0MH1y9PmEkGmaytScJQ0Lckakm_8dJWNgC2FyKsKPQyQ@mail.gmail.com>
References: <CABNxGA0MH1y9PmEkGmaytScJQ0Lckakm_8dJWNgC2FyKsKPQyQ@mail.gmail.com>
Message-ID: <640616DC-1680-4FD6-BA46-DC7B2B8CAD3B@gmail.com>

Hi,

You probably have multiple dll dependencies availabe in the path. Try copying all the dependencies from the same package to the location where your excutable is running.

Best regards,

Tamas

Az iPhone-omról küldve

2017. aug. 1. dátummal, 17:08 időpontban C. Zeng <chqzeng at gmail.com> írta:

> ​Hello all,
> 
> I am trying to setup the GDAL in C#.NET 2015, with an error at the registration of the Ogr. A previous post stated the exact same problem but without a solution, I tried to reply in that post but failed,thus send this email instead. 
> 
> That previous post described my problem very well:  
>> "I am using ogr_csharp.dll in my c# program. See the following code snippet: 
>> using OSGeo.OGR; 
>> namespace Test 
>> { 
>>     public class Test 
>>     { 
>>         public Test() 
>>         { 
>>                 ... 
>>                   Ogr.RegisterAll(); 
>>         }       
>>     } 
>> } 
>> Then the following exception message was thrown out when the program is executed: 
>> {"The type initializer for 'OSGeo.OGR.OgrPINVOKE' threw an exception."}         
>> System.Exception {System.TypeInitializationException} 
>> Does anyone know how to resolve this issue? "
> 
> Some more details for my case. My steps are: 
> - downloaded the stable or daily stable release (same error later) from here. 
> - added the "...\bin" and "...\bin\gdal\csharp" to Environment Variable, setup a sample project, 
> - add the 4 "###sharp.dll" from csharp folder to project reference. 
> - import namespace:  using OSGeo.OGR; using OSGeo.OSR;  and add a simple line "Ogr.RegisterAll(); " 
> 
> Then I can successfully build the project, but with the following error msg. I tried all possible solutions by Google plus this forum such as this and this. 
> test all the x64/x86 , debug/release, switches, no luck. 
> 
> Any comment is appreciated, thank you! 
> 
> Chui 
> 
> 
> 
> --------------------------error message -------------------------- 
> 
> Unhandled Exception: System.TypeInitializationException: The type initializer fo 
> r 'OSGeo.OGR.OgrPINVOKE' threw an exception. ---> System.TypeInitializationExcep 
> tion: The type initializer for 'SWIGExceptionHelper' threw an exception. ---> Sy 
> stem.BadImageFormatException: An attempt was made to load a program with an inco 
> rrect format. (Exception from HRESULT: 0x8007000B) 
>    at OSGeo.OGR.OgrPINVOKE.SWIGExceptionHelper.SWIGRegisterExceptionCallbacks_Og 
> r(ExceptionDelegate applicationDelegate, ExceptionDelegate arithmeticDelegate, E 
> xceptionDelegate divideByZeroDelegate, ExceptionDelegate indexOutOfRangeDelegate 
> , ExceptionDelegate invalidCastDelegate, ExceptionDelegate invalidOperationDeleg 
> ate, ExceptionDelegate ioDelegate, ExceptionDelegate nullReferenceDelegate, Exce 
> ptionDelegate outOfMemoryDelegate, ExceptionDelegate overflowDelegate, Exception 
> Delegate systemExceptionDelegate) 
>    at OSGeo.OGR.OgrPINVOKE.SWIGExceptionHelper..cctor() 
>    --- End of inner exception stack trace --- 
>    at OSGeo.OGR.OgrPINVOKE.SWIGExceptionHelper..ctor() 
>    at OSGeo.OGR.OgrPINVOKE..cctor() 
>    --- End of inner exception stack trace --- 
>    at OSGeo.OGR.OgrPINVOKE.RegisterAll() 
>    at OSGeo.OGR.Ogr.RegisterAll() 
>    at TestProj.Main(String[] args) in \user\Downloads\Workspace\TestProj\project.cs:line 47
> 
> and also the following log info: 
> 'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded 'C:\WINDOWS\Microsoft.Net\assembly\GAC_64\mscorlib\v4.0_4.0.0.0__b77a5c561934e089\mscorlib.dll'. Cannot find or open the PDB file. 
> 'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded 'C:\WINDOWS\assembly\GAC_MSIL\Microsoft.VisualStudio.HostingProcess.Utilities\14.0.0.0__b03f5f7f11d50a3a\Microsoft.VisualStudio.HostingProcess.Utilities.dll'. Cannot find or open the PDB file. 
> 'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded 'C:\WINDOWS\Microsoft.Net\assembly\GAC_MSIL\System.Windows.Forms\v4.0_4.0.0.0__b77a5c561934e089\System.Windows.Forms.dll'. Cannot find or open the PDB file. 
> 'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded 'C:\WINDOWS\Microsoft.Net\assembly\GAC_MSIL\System\v4.0_4.0.0.0__b77a5c561934e089\System.dll'. Cannot find or open the PDB file. 
> 'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded 'C:\WINDOWS\Microsoft.Net\assembly\GAC_MSIL\System.Drawing\v4.0_4.0.0.0__b03f5f7f11d50a3a\System.Drawing.dll'. Cannot find or open the PDB file. 
> 'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded 'C:\WINDOWS\assembly\GAC_MSIL\Microsoft.VisualStudio.HostingProcess.Utilities.Sync\14.0.0.0__b03f5f7f11d50a3a\Microsoft.VisualStudio.HostingProcess.Utilities.Sync.dll'. Cannot find or open the PDB file. 
> 'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded 'C:\WINDOWS\assembly\GAC_MSIL\Microsoft.VisualStudio.Debugger.Runtime\14.0.0.0__b03f5f7f11d50a3a\Microsoft.VisualStudio.Debugger.Runtime.dll'.
> 'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded '\user\Downloads\Gdal_folder\TestProj\bin\Debug\TestProj.vshost.exe'. Cannot find or open the PDB file. 
> 'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded 'C:\WINDOWS\Microsoft.Net\assembly\GAC_MSIL\System.Core\v4.0_4.0.0.0__b77a5c561934e089\System.Core.dll'. Cannot find or open the PDB file. 
> 'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded 'C:\WINDOWS\Microsoft.Net\assembly\GAC_MSIL\System.Xml.Linq\v4.0_4.0.0.0__b77a5c561934e089\System.Xml.Linq.dll'. Cannot find or open the PDB file. 
> 'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded 'C:\WINDOWS\Microsoft.Net\assembly\GAC_MSIL\System.Data.DataSetExtensions\v4.0_4.0.0.0__b77a5c561934e089\System.Data.DataSetExtensions.dll'. Cannot find or open the PDB file. 
> 'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded 'C:\WINDOWS\Microsoft.Net\assembly\GAC_MSIL\Microsoft.CSharp\v4.0_4.0.0.0__b03f5f7f11d50a3a\Microsoft.CSharp.dll'. Cannot find or open the PDB file. 
> 'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded 'C:\WINDOWS\Microsoft.Net\assembly\GAC_64\System.Data\v4.0_4.0.0.0__b77a5c561934e089\System.Data.dll'. Cannot find or open the PDB file. 
> 'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded 'C:\WINDOWS\Microsoft.Net\assembly\GAC_MSIL\System.Net.Http\v4.0_4.0.0.0__b03f5f7f11d50a3a\System.Net.Http.dll'. Cannot find or open the PDB file. 
> 'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded 'C:\WINDOWS\Microsoft.Net\assembly\GAC_MSIL\System.Xml\v4.0_4.0.0.0__b77a5c561934e089\System.Xml.dll'. Cannot find or open the PDB file. 
> The thread 0x2228 has exited with code 0 (0x0). 
> The thread 0x1b30 has exited with code 0 (0x0). 
> The thread 0x2a64 has exited with code 0 (0x0). 
> 'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded '\user\Downloads\Gdal_folder\TestProj\bin\Debug\TestProj.exe'. Symbols loaded. 
> The thread 0x2c20 has exited with code 0 (0x0). 
> 'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded '\user\Downloads\Gdal_folder\TestProj\bin\Debug\ogr_csharp.dll'. Module was built without symbols. 
> Exception thrown: 'System.DllNotFoundException' in ogr_csharp.dll 
> Exception thrown: 'System.TypeInitializationException' in ogr_csharp.dll 
> Exception thrown: 'System.TypeInitializationException' in ogr_csharp.dll 
> An unhandled exception of type 'System.TypeInitializationException' occurred in ogr_csharp.dll 
> Additional information: The type initializer for 'OSGeo.OGR.OgrPINVOKE' threw an exception. 
> 
> The program '[2244] TestProj.vshost.exe' has exited with code 0 (0x0)
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170801/b1c4f129/attachment-0001.html>

From lucadeluge at gmail.com  Wed Aug  2 11:19:58 2017
From: lucadeluge at gmail.com (Luca Delucchi)
Date: Wed, 2 Aug 2017 20:19:58 +0200
Subject: [gdal-dev] Fwd: [Projects] please create a new project flyer
 for your project with the new branding till FOSS4G Boston
In-Reply-To: <4153646.znehyYAMKA@even-i700>
References: <4153646.znehyYAMKA@even-i700>
Message-ID: <CAK4m-3z4mqdiwhHBazN37XQDFf0k2zv8vVd4D+saa4u1Q+1+wQ@mail.gmail.com>

On 28 July 2017 at 17:38, Even Rouault <even.rouault at spatialys.com> wrote:
> Hi,
>

Hi,

>
> Is someone interested in creating a flyer for GDAL ? See below
>

I'm going to work on it this evening/tomorrow morning...

>
> Even
>

-- 
ciao
Luca

www.lucadelu.org

From bontepaarden at gmail.com  Thu Aug  3 06:43:12 2017
From: bontepaarden at gmail.com (Paul Meems)
Date: Thu, 3 Aug 2017 15:43:12 +0200
Subject: [gdal-dev] Raster statistics
Message-ID: <CAHNf2YSL+THbAUcAL2J5770sJi6DnsX8LhPNN8ZUDaL73LHPiw@mail.gmail.com>

I have a drone raster file which I want to use for some calculation.
Before the calculation, I need to loose some extreme values.
I want to do something like a percentile calculation where you get all
values, order them and loose the top 10%.
For this, I need to get all values first which can be slow when using a
large file.

I looked at the statistics (band.GetStatistics) but that doesn't work well.
I thought I could use 2 times the standard deviation added to the mean to
get roughly 97%.
But with these statistics:
    STATISTICS_MAXIMUM=33.186080932617
    STATISTICS_MEAN=24.840205979603
    STATISTICS_MINIMUM=1.5951598882675
    STATISTICS_STDDEV=4.7285348016053
Mean + 2*std is larger than the max.

So I moved to the histogram. It is also very fast, but I'm not sure how to
use it.
I have this:
  256 buckets from 1.53322 to 33.248:
  410 77 66 66 65 58 56 45 42 87 57 72 61 65 68 70 73 82 93 ...
Does this mean, bucket 1 = 410 that I have 410 pixels of value 1.53322 and
the second bucket means I have 77 pixels between 1.53322 and 1.657? 1.657 =
1.53322 + ((33.248 - 1.53322)/256)

Is this a good approach? Or can/should I use a different one.

Thanks,

Paul
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170803/72934b8a/attachment.html>

From cwaigl at alaska.edu  Thu Aug  3 11:05:32 2017
From: cwaigl at alaska.edu (Chris Waigl)
Date: Thu, 3 Aug 2017 10:05:32 -0800
Subject: [gdal-dev] Raster statistics
In-Reply-To: <CAHNf2YSL+THbAUcAL2J5770sJi6DnsX8LhPNN8ZUDaL73LHPiw@mail.gmail.com>
References: <CAHNf2YSL+THbAUcAL2J5770sJi6DnsX8LhPNN8ZUDaL73LHPiw@mail.gmail.com>
Message-ID: <D6E64FEE-1A59-4361-96FA-9B57C41136D5@alaska.edu>

I would not use gdal for this particular task. I presume you have the band data in a 2D numpy array. Then I’d get the 80th percentile for example with np.percentile() and use a boolean expression to generate a mask for the array (droneraster > perc80value ).

Chris

-- 
Christine (Chris) Waigl - cwaigl at alaska.edu -  +1-907-474-5483 - Skype: cwaigl_work
Geophysical Institute, UAF, 903 Koyukuk Drive, Fairbanks, AK 99775-7320, USA







> On Aug 3, 2017, at 5:43 AM, Paul Meems <bontepaarden at gmail.com> wrote:
> 
> I have a drone raster file which I want to use for some calculation.
> Before the calculation, I need to loose some extreme values.
> I want to do something like a percentile calculation where you get all values, order them and loose the top 10%.
> For this, I need to get all values first which can be slow when using a large file.
> 
> I looked at the statistics (band.GetStatistics) but that doesn't work well.
> I thought I could use 2 times the standard deviation added to the mean to get roughly 97%.
> But with these statistics:
>     STATISTICS_MAXIMUM=33.186080932617
>     STATISTICS_MEAN=24.840205979603
>     STATISTICS_MINIMUM=1.5951598882675
>     STATISTICS_STDDEV=4.7285348016053
> Mean + 2*std is larger than the max.
> 
> So I moved to the histogram. It is also very fast, but I'm not sure how to use it.
> I have this:
>   256 buckets from 1.53322 to 33.248:
>   410 77 66 66 65 58 56 45 42 87 57 72 61 65 68 70 73 82 93 ...
> Does this mean, bucket 1 = 410 that I have 410 pixels of value 1.53322 and the second bucket means I have 77 pixels between 1.53322 and 1.657? 1.657 = 1.53322 + ((33.248 - 1.53322)/256)
> 
> Is this a good approach? Or can/should I use a different one.
> 
> Thanks,
> 
> Paul
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170803/0f91c3c9/attachment.html>

From bontepaarden at gmail.com  Thu Aug  3 11:51:22 2017
From: bontepaarden at gmail.com (Paul Meems)
Date: Thu, 3 Aug 2017 20:51:22 +0200
Subject: [gdal-dev] Raster statistics
In-Reply-To: <D6E64FEE-1A59-4361-96FA-9B57C41136D5@alaska.edu>
References: <CAHNf2YSL+THbAUcAL2J5770sJi6DnsX8LhPNN8ZUDaL73LHPiw@mail.gmail.com>
 <D6E64FEE-1A59-4361-96FA-9B57C41136D5@alaska.edu>
Message-ID: <CAHNf2YSMrsKX0cG3hDLyn8+1RO1UxUtzok91Q9a_ukM3isKpAA@mail.gmail.com>

Thanks Chris for your reply.

I forgot to mention I'm not using GDAL with Python.
I use it with C++ and/or C#.




Paul

*Paul Meems *
Release manager, configuration manager
and forum moderator of MapWindow GIS.
www.mapwindow.org

Owner of MapWindow.nl - Support for
Dutch speaking users.
www.mapwindow.nl


*The MapWindow GIS project has moved to GitHub
<https://github.com/MapWindow>!*


Download the latest MapWinGIS mapping engine.
<https://github.com/MapWindow/MapWinGIS/releases>

Download the latest MapWindow 5 open source desktop application.
<https://github.com/MapWindow/MapWindow5/releases>

2017-08-03 20:05 GMT+02:00 Chris Waigl <cwaigl at alaska.edu>:

> I would not use gdal for this particular task. I presume you have the band
> data in a 2D numpy array. Then I’d get the 80th percentile for example with
> np.percentile() and use a boolean expression to generate a mask for the
> array (droneraster > perc80value ).
>
> Chris
>
> --
> Christine (Chris) Waigl - cwaigl at alaska.edu -  +1-907-474-5483
> <(907)%20474-5483> - Skype: cwaigl_work
> Geophysical Institute, UAF, 903 Koyukuk Drive, Fairbanks, AK 99775-7320,
> USA
>
>
>
>
>
>
>
> On Aug 3, 2017, at 5:43 AM, Paul Meems <bontepaarden at gmail.com> wrote:
>
> I have a drone raster file which I want to use for some calculation.
> Before the calculation, I need to loose some extreme values.
> I want to do something like a percentile calculation where you get all
> values, order them and loose the top 10%.
> For this, I need to get all values first which can be slow when using a
> large file.
>
> I looked at the statistics (band.GetStatistics) but that doesn't work well.
> I thought I could use 2 times the standard deviation added to the mean to
> get roughly 97%.
> But with these statistics:
>     STATISTICS_MAXIMUM=33.186080932617
>     STATISTICS_MEAN=24.840205979603
>     STATISTICS_MINIMUM=1.5951598882675
>     STATISTICS_STDDEV=4.7285348016053
> Mean + 2*std is larger than the max.
>
> So I moved to the histogram. It is also very fast, but I'm not sure how to
> use it.
> I have this:
>   256 buckets from 1.53322 to 33.248:
>   410 77 66 66 65 58 56 45 42 87 57 72 61 65 68 70 73 82 93 ...
> Does this mean, bucket 1 = 410 that I have 410 pixels of value 1.53322 and
> the second bucket means I have 77 pixels between 1.53322 and 1.657? 1.657 =
> 1.53322 + ((33.248 - 1.53322)/256)
>
> Is this a good approach? Or can/should I use a different one.
>
> Thanks,
>
> Paul
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170803/95569345/attachment-0001.html>

From jwalseth at tableau.com  Thu Aug  3 14:16:30 2017
From: jwalseth at tableau.com (Jim Walseth)
Date: Thu, 3 Aug 2017 21:16:30 +0000
Subject: [gdal-dev] Vector only GDAL build?
Message-ID: <DM5PR03MB31152B3EB33DA191690E91ADC5B10@DM5PR03MB3115.namprd03.prod.outlook.com>

Does anyone have experience or information about building GDAL without LibTIFF?

We are using GDAL only for vector data conversions, yet are faced with updating GDAL a second time due to reported security vulnerabilities in libTIFF.



Thanks.



-Jim

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170803/9429dee2/attachment.html>

From even.rouault at spatialys.com  Thu Aug  3 14:25:03 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 03 Aug 2017 23:25:03 +0200
Subject: [gdal-dev] Vector only GDAL build?
In-Reply-To: <DM5PR03MB31152B3EB33DA191690E91ADC5B10@DM5PR03MB3115.namprd03.prod.outlook.com>
References: <DM5PR03MB31152B3EB33DA191690E91ADC5B10@DM5PR03MB3115.namprd03.prod.outlook.com>
Message-ID: <3411961.2b6k8cWAdJ@even-i700>

On jeudi 3 août 2017 21:16:30 CEST Jim Walseth wrote:
> Does anyone have experience or information about building GDAL without
> LibTIFF?
> 
> We are using GDAL only for vector data conversions, yet are faced with
> updating GDAL a second time due to reported security vulnerabilities in
> libTIFF.

You could more simply exclude the GTiff driver at runtime by definining the environment 
variable / configuration option GDAL_SKIP to GTIFF

Or just remove / comment the GDALRegister_GTiff() line in frmts/gdalallregister.cpp 
when rebuilding GDAL

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170803/8cd819f5/attachment.html>

From schwehr at gmail.com  Thu Aug  3 14:31:12 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Thu, 3 Aug 2017 14:31:12 -0700
Subject: [gdal-dev] Vector only GDAL build?
In-Reply-To: <3411961.2b6k8cWAdJ@even-i700>
References: <DM5PR03MB31152B3EB33DA191690E91ADC5B10@DM5PR03MB3115.namprd03.prod.outlook.com>
 <3411961.2b6k8cWAdJ@even-i700>
Message-ID: <CACmBxytLJZ=gU8+PJQ2ODiBgYSVWK+JNi5Gd8H=3VFS2Cw_eJg@mail.gmail.com>

What Even said or alternatives:

#if 1
int ThingIDoNotWant() { return 0; }
#else
int ThingIDoNotWant() {
 normal body
}
#endif

Or place an abort(); call in any place where you absolutely don't want to
go but can't easily get rid of.  Better to have a program go down than to
run something you don't want.  Works well if there is someplace bad buried
inside complicated logic.

On Thu, Aug 3, 2017 at 2:25 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> On jeudi 3 août 2017 21:16:30 CEST Jim Walseth wrote:
>
> > Does anyone have experience or information about building GDAL without
>
> > LibTIFF?
>
> >
>
> > We are using GDAL only for vector data conversions, yet are faced with
>
> > updating GDAL a second time due to reported security vulnerabilities in
>
> > libTIFF.
>
>
>
> You could more simply exclude the GTiff driver at runtime by definining
> the environment variable / configuration option GDAL_SKIP to GTIFF
>
>
>
> Or just remove / comment the GDALRegister_GTiff() line in
> frmts/gdalallregister.cpp when rebuilding GDAL
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170803/d72f0ba1/attachment.html>

From mdsumner at gmail.com  Thu Aug  3 18:50:41 2017
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 04 Aug 2017 01:50:41 +0000
Subject: [gdal-dev] GEOGRID projection question
Message-ID: <CAAcGz98OPXSxi1JQ576vnAVej6_mt6wPTvXVTz+4PmqqmTpAfw@mail.gmail.com>

Hello, I have this output in the global attributes of a NetCDF, seemingly
originating with USGS and a program called "GEOGRID" -  see print below.
Does anyone happen to know what MAP_PROJ = 6 and GRIDTYPE = "C" stands for?

The CEN_LAT/CEN_LON are sensible but TRUELAT1/TRUELAT2 look like filler,
but maybe they are recorded badly asit looks like an LCC form to me.

Appreciate any pointers.

Thanks!

Cheers, Mike.


// global attributes:
:TITLE = "OUTPUT FROM GEOGRID V3.2.1" ;
:SIMULATION_START_DATE = "0000-00-00_00:00:00" ;
:WEST-EAST_GRID_DIMENSION = 216 ;
:SOUTH-NORTH_GRID_DIMENSION = 145 ;
:BOTTOM-TOP_GRID_DIMENSION = 0 ;
:WEST-EAST_PATCH_START_UNSTAG = 1 ;
:WEST-EAST_PATCH_END_UNSTAG = 215 ;
:WEST-EAST_PATCH_START_STAG = 1 ;
:WEST-EAST_PATCH_END_STAG = 216 ;
:SOUTH-NORTH_PATCH_START_UNSTAG = 1 ;
:SOUTH-NORTH_PATCH_END_UNSTAG = 144 ;
:SOUTH-NORTH_PATCH_START_STAG = 1 ;
:SOUTH-NORTH_PATCH_END_STAG = 145 ;
:GRIDTYPE = "C" ;
:DX = 48918.09f ;
:DY = 48918.09f ;
:DYN_OPT = 2 ;
:CEN_LAT = -24.26f ;
:CEN_LON = 147.63f ;
:TRUELAT1 = 1.e+20f ;
:TRUELAT2 = 1.e+20f ;
:MOAD_CEN_LAT = -24.26f ;
:STAND_LON = 32.37f ;
:POLE_LAT = 60.31f ;
:POLE_LON = 321.38f ;
:corner_lats = -43.18129f, 14.5788f, 14.57882f, -43.18126f, -43.08284f,
14.64489f, 14.64489f, -43.08282f, -43.37204f, 14.78275f, 14.78277f,
-43.37201f, -43.27347f, 14.84871f, 14.84871f, -43.27346f ;
:corner_lons = 83.15466f, 110.3886f, -175.1285f, -147.8946f, 82.91971f,
110.22f, -174.96f, -147.6597f, 83.00413f, 110.4739f, -175.2138f,
-147.7441f, 82.76912f, 110.3056f, -175.0456f, -147.5091f ;
:MAP_PROJ = 6 ;
:MMINLU = "USGS" ;
:NUM_LAND_CAT = 24 ;
:ISWATER = 16 ;
:ISLAKE = -1 ;
:ISICE = 24 ;
:ISURBAN = 1 ;
:ISOILWATER = 14 ;
:grid_id = 1 ;
:parent_id = 1 ;
:i_parent_start = 1 ;
:j_parent_start = 1 ;
:i_parent_end = 216 ;
:j_parent_end = 145 ;
:parent_grid_ratio = 1 ;
:sr_x = 1 ;
:sr_y = 1 ;
:FLAG_MF_XY = 1 ;
}
-- 
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170804/4c242a71/attachment-0001.html>

From mdsumner at gmail.com  Thu Aug  3 19:36:26 2017
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 04 Aug 2017 02:36:26 +0000
Subject: [gdal-dev] GEOGRID projection question
In-Reply-To: <003a01d30cc7$dcddb960$96992c20$@frogmouth.net>
References: <CAAcGz98OPXSxi1JQ576vnAVej6_mt6wPTvXVTz+4PmqqmTpAfw@mail.gmail.com>
 <003a01d30cc7$dcddb960$96992c20$@frogmouth.net>
Message-ID: <CAAcGz9-Pu=k4fhhPi5L3Smhe=githE=tnbmLPhEcBeA1iYdT2A@mail.gmail.com>

Thanks!  That looks right to me, I'm exploring here and it also seems to be
an ob_tran rotation, knowing that is probably enough for me to be able to
fix.

http://www2.mmm.ucar.edu/wrf/users/docs/user_guide_V3/users_guide_chap3.htm#_Description_of_GEOGRID.TBL

If anyone has direct experience with this kind of output and PROJ.4 I'd
appreciate any pointers.

Cheers, Mike.


On Fri, 4 Aug 2017 at 12:17 Brad Hards <bradh at frogmouth.net> wrote:

> Looks somewhat like it came from WRF/ARW forecast software.
>
> Brad
>
>
> --
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170804/0d4b903a/attachment.html>

From bradh at frogmouth.net  Thu Aug  3 19:17:45 2017
From: bradh at frogmouth.net (Brad Hards)
Date: Fri, 4 Aug 2017 12:17:45 +1000
Subject: [gdal-dev] GEOGRID projection question
In-Reply-To: <CAAcGz98OPXSxi1JQ576vnAVej6_mt6wPTvXVTz+4PmqqmTpAfw@mail.gmail.com>
References: <CAAcGz98OPXSxi1JQ576vnAVej6_mt6wPTvXVTz+4PmqqmTpAfw@mail.gmail.com>
Message-ID: <003a01d30cc7$dcddb960$96992c20$@frogmouth.net>

Looks somewhat like it came from WRF/ARW forecast software.

Brad



From lucadeluge at gmail.com  Fri Aug  4 05:31:24 2017
From: lucadeluge at gmail.com (Luca Delucchi)
Date: Fri, 4 Aug 2017 14:31:24 +0200
Subject: [gdal-dev] Fwd: [Projects] please create a new project flyer
 for your project with the new branding till FOSS4G Boston
In-Reply-To: <4153646.znehyYAMKA@even-i700>
References: <4153646.znehyYAMKA@even-i700>
Message-ID: <CAK4m-3zeo=qVgtGDpG-8RN5NKZ50CcMqFvdZYzJh6VEPSyiiLA@mail.gmail.com>

On 28 July 2017 at 17:38, Even Rouault <even.rouault at spatialys.com> wrote:
> Hi,
>

Hi,

>
> Is someone interested in creating a flyer for GDAL ? See below
>

I worked on the flyer, but I need some more text and/or an image...

You can see the draft here

https://github.com/lucadelu/osgeo/blob/gdal/marketing/print/gdal_a4.svg

>
> Even
>

-- 
ciao
Luca

www.lucadelu.org

From even.rouault at spatialys.com  Fri Aug  4 07:22:04 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 04 Aug 2017 16:22:04 +0200
Subject: [gdal-dev] Fwd: [Projects] please create a new project flyer
	for your project with the new branding till FOSS4G Boston
In-Reply-To: <CAK4m-3zeo=qVgtGDpG-8RN5NKZ50CcMqFvdZYzJh6VEPSyiiLA@mail.gmail.com>
References: <4153646.znehyYAMKA@even-i700>
 <CAK4m-3zeo=qVgtGDpG-8RN5NKZ50CcMqFvdZYzJh6VEPSyiiLA@mail.gmail.com>
Message-ID: <2505459.lcIapPjFog@even-i700>

On vendredi 4 août 2017 14:31:24 CEST Luca Delucchi wrote:
> On 28 July 2017 at 17:38, Even Rouault <even.rouault at spatialys.com> wrote:
> > Hi,
> 
> Hi,
> 
> > Is someone interested in creating a flyer for GDAL ? See below
> 
> I worked on the flyer, but I need some more text and/or an image...
> 
> You can see the draft here
> 
> https://github.com/lucadelu/osgeo/blob/gdal/marketing/print/gdal_a4.svg

Thanks a lot Luca for tackling this !

A few observations/proposals:
- wondering if the subtiltle "The Geospatial Data Translation Tools" shouldn't be replaced 
by the "The Geospatial Data Abstraction Library and translation tools" to get both the 
menaing of the acronym and the practical uses
- perhaps replace "Welcome" by "Introduction" ?
- in this paragraph, I would remove bold characters starting with "As a library"
- I would replace "As a library, it is" by "It is writen in C++ and"
- In the raster format list, I would add OGC WCS/WMS/WMTS.. And int the vector format list 
OGC WFS
- I would replace in the vector formats "ESRI Personal Geodatabase" by "ESRI 
FileGeodatabase" since the latter is probably now more common than the former.
- in the language list, Ruby and VB6 should be removed (no longer supported)
- in "features", in the first bullet, I'd :
  * add after "image warping": "reprojection"
  * add after "merging": "tiling, DEM-related utilities (hillshading, slope, hypsometric 
rendernig)"
- in the "Support for large files" bullet, I'd append "- with modest memory requirements"
- in "where it is used", I'd removed OpenEV since the project is kind of dead now. In the "also 
utilized by" list, perhaps add gvSIG (to have at least one non C++ application)
- I don't know if the white backgound of the GDAL logo is intentional. If not, you could start 
from the original SVG drawing that has not this background :
https://svn.osgeo.org/gdal/trunk/gdal/data/GDALLogoColor.svg


Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170804/5dfc3302/attachment.html>

From sacha.black at gmail.com  Fri Aug  4 18:20:50 2017
From: sacha.black at gmail.com (Sacha Black)
Date: Fri, 4 Aug 2017 18:20:50 -0700
Subject: [gdal-dev] Using ogr2ogr to import from FileGDB to MSSQL
Message-ID: <CAE7Dd_rVixYWjZkyw7U8ENN84V0BMOnuKT_AKv7Rv4S4Rao-SA@mail.gmail.com>

Hello,

I have a problem using ogr2ogr (OSGeo4w w gdal 2.2.1-1) to import from
FileGDB (10.5) to MSSQL (2016).

My process:

I used SQL Server Mgmt Studio to create a blank table "new_layer_name", an
add a single geometry column named "ogr_geometry". I am the owner of this
table.

My ogr2ogr connection to MSSQL is a success, and after running my table is
populated with correct fields and attributes.

My problem:

In the end, my geometry column is containing only NULL values.

More details:

The ogr2ogr command I am using is:

ogr2ogr -overwrite -f MSSQLSpatial "MSSQL:server=xxx\xxx;driver
=SQL
Server;database=xxx;trusted_connection=yes;UID=xxx;PWD=xxxx;GEOM_TYPE=geometry;GEOMETRY_NAME=ogr_geometry;OVERWRITE=YES"
"xxx.gdb" -geomfield ogr_geometry -preserve_fid -nln new_layer_name -nlt
MULTIPOLYGON  -lco "G
EOM_TYPE=geometry" -lco "GEOM_NAME=ogr_geometry" -a_srs EPSG:4326
-skipfailures -progress

Any ideas for my mistake?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170804/21f6ad5c/attachment.html>

From jmckenna at gatewaygeomatics.com  Sat Aug  5 14:13:26 2017
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Sat, 5 Aug 2017 18:13:26 -0300
Subject: [gdal-dev] Fwd: [Projects] please create a new project flyer
 for your project with the new branding till FOSS4G Boston
In-Reply-To: <2505459.lcIapPjFog@even-i700>
References: <4153646.znehyYAMKA@even-i700>
 <CAK4m-3zeo=qVgtGDpG-8RN5NKZ50CcMqFvdZYzJh6VEPSyiiLA@mail.gmail.com>
 <2505459.lcIapPjFog@even-i700>
Message-ID: <04fddcd1-d61f-6c2a-0d04-e4eac5078e3c@gatewaygeomatics.com>

Luca: I have taken Even's feedback and made some more text changes, and 
also added a hillshade DEM (of Frank's home area in Canada) created 
through GDAL 2.2.1 on my machine.  It creates a big SVG now, but 
you/designer can decide to keep that image or not. 
http://www.gatewaygeomatics.com/dl/gdal_a4.svg

PS. I created it using LibreOffice!

-jeff



On 2017-08-04 11:22 AM, Even Rouault wrote:
> On vendredi 4 août 2017 14:31:24 CEST Luca Delucchi wrote:
> 
>  > On 28 July 2017 at 17:38, Even Rouault <even.rouault at spatialys.com> 
> wrote:
> 
>  > > Hi,
> 
>  >
> 
>  > Hi,
> 
>  >
> 
>  > > Is someone interested in creating a flyer for GDAL ? See below
> 
>  >
> 
>  > I worked on the flyer, but I need some more text and/or an image...
> 
>  >
> 
>  > You can see the draft here
> 
>  >
> 
>  > https://github.com/lucadelu/osgeo/blob/gdal/marketing/print/gdal_a4.svg
> 
> Thanks a lot Luca for tackling this !
> 
> A few observations/proposals:
> 
> - wondering if the subtiltle "The Geospatial Data Translation Tools" 
> shouldn't be replaced by the "The Geospatial Data Abstraction Library 
> and translation tools" to get both the menaing of the acronym and the 
> practical uses
> 
> - perhaps replace "Welcome" by "Introduction" ?
> 
> - in this paragraph, I would remove bold characters starting with "As a 
> library"
> 
> - I would replace "As a library, it is" by "It is writen in C++ and"
> 
> - In the raster format list, I would add OGC WCS/WMS/WMTS.. And int the 
> vector format list OGC WFS
> 
> - I would replace in the vector formats "ESRI Personal Geodatabase" by 
> "ESRI FileGeodatabase" since the latter is probably now more common than 
> the former.
> 
> - in the language list, Ruby and VB6 should be removed (no longer supported)
> 
> - in "features", in the first bullet, I'd :
> 
> * add after "image warping": "reprojection"
> 
> * add after "merging": "tiling, DEM-related utilities (hillshading, 
> slope, hypsometric rendernig)"
> 
> - in the "Support for large files" bullet, I'd append "- with modest 
> memory requirements"
> 
> - in "where it is used", I'd removed OpenEV since the project is kind of 
> dead now. In the "also utilized by" list, perhaps add gvSIG (to have at 
> least one non C++ application)
> 
> - I don't know if the white backgound of the GDAL logo is intentional. 
> If not, you could start from the original SVG drawing that has not this 
> background :
> 
> https://svn.osgeo.org/gdal/trunk/gdal/data/GDALLogoColor.svg
> 
> Even
> 
> -- 
> 
> Spatialys - Geospatial professional services
> 
> http://www.spatialys.com
> 
> 
> 

From aborruso at gmail.com  Sun Aug  6 01:22:26 2017
From: aborruso at gmail.com (aborruso)
Date: Sun, 6 Aug 2017 01:22:26 -0700 (MST)
Subject: [gdal-dev] CSV to GeoRSS: problem with pubDate field
In-Reply-To: <1501522661460-5329925.post@n6.nabble.com>
References: <1501522661460-5329925.post@n6.nabble.com>
Message-ID: <1502007746268-5330604.post@n6.nabble.com>

Hi,
does someone of you have an hello world example that works to transform with
GDAL a CSV to GeoRSS?

I'm writing here, because I do not find any tips everywhere.

Thank you again



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/CSV-to-GeoRSS-problem-with-pubDate-field-tp5329925p5330604.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Sun Aug  6 01:41:10 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 06 Aug 2017 10:41:10 +0200
Subject: [gdal-dev] CSV to GeoRSS: problem with pubDate field
In-Reply-To: <1501522661460-5329925.post@n6.nabble.com>
References: <1501522661460-5329925.post@n6.nabble.com>
Message-ID: <1665332.nE6XaCK01p@even-i700>

On lundi 31 juillet 2017 10:37:41 CEST aborruso wrote:
> Hi,
> I'm using GDAL 2.3.0dev to convert a CSV to GeoRSS, but I'm not able to set
> properly pubDate field.
> 
> My test input CSV is (tab separated):
> 
> title	description	guid	link	pubDate
> titolo	des	http://www.tin.it/1	http://www.tin.it/1	Wed, 11 Jul 2007 
15:39:21
> GMT
> 
> I run:
> 
> ogr2ogr  -f GeoRSS  georss.xml source.csv source
> 
> And I have "ERROR 1: Wrong field type for pubDate" error and this XML
> output:
> 
> <?xml version="1.0"?>
> <rss version="2.0" xmlns:georss="http://www.georss.org/georss">
>   <channel>
>     <title>title</title>
>     <description>channel_description</description>
>     <link>channel_link</link>
>     <item>
>       <title>titolo</title>
>       <description>des</description>
>       <guid>http://www.tin.it/1</guid>
>       <link>http://www.tin.it/1</link>
>     </item>
>   </channel>
> </rss>
> 
> It's almost perfect, but without pubDate. How to set it in my source CSV?

The issue is that the GeoRSS driver expects the pubDate field to be of OGR type DateTime 
but the formatting "Wed, 11 Jul 2007 15:39:21 GMT" is not recognized by OGR. So if instead 
you put "2007/07/11 15:39:21" as the pubDate value in your CSV and add " -oo 
AUTODETECT_TYPE=YES" this will work. The GeoRSS writer will format the date as "Wed, 11 
Jul 2007 15:39:21 GMT" in the output file.

ogr2ogr  -f GeoRSS  georss.xml source.csv -oo AUTODETECT_TYPE=YES

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170806/8e97756c/attachment.html>

From aborruso at gmail.com  Sun Aug  6 01:43:00 2017
From: aborruso at gmail.com (aborruso)
Date: Sun, 6 Aug 2017 01:43:00 -0700 (MST)
Subject: [gdal-dev] CSV to GeoRSS: problem with pubDate field
In-Reply-To: <1502007746268-5330604.post@n6.nabble.com>
References: <1501522661460-5329925.post@n6.nabble.com>
 <1502007746268-5330604.post@n6.nabble.com>
Message-ID: <1502008980608-5330608.post@n6.nabble.com>

Solved, it was a stupid question: I must use a csvt and set the input pubDate
CSV field as `DateTime`.

Thank you



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/CSV-to-GeoRSS-problem-with-pubDate-field-tp5329925p5330608.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From aborruso at gmail.com  Sun Aug  6 07:39:35 2017
From: aborruso at gmail.com (aborruso)
Date: Sun, 6 Aug 2017 07:39:35 -0700 (MST)
Subject: [gdal-dev] CSV to GeoRSS: problem with pubDate field
In-Reply-To: <1665332.nE6XaCK01p@even-i700>
References: <1501522661460-5329925.post@n6.nabble.com>
 <1665332.nE6XaCK01p@even-i700>
Message-ID: <1502030375346-5330632.post@n6.nabble.com>

Hi Even,


Even Rouault-2 wrote
> ogr2ogr  -f GeoRSS  georss.xml source.csv -oo AUTODETECT_TYPE=YES

so simple, so powerful.

Thank you very much




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/CSV-to-GeoRSS-problem-with-pubDate-field-tp5329925p5330632.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From aborruso at gmail.com  Sun Aug  6 23:31:04 2017
From: aborruso at gmail.com (aborruso)
Date: Sun, 6 Aug 2017 23:31:04 -0700 (MST)
Subject: [gdal-dev] CSV to GeoRSS: problem with pubDate field
In-Reply-To: <1501522661460-5329925.post@n6.nabble.com>
References: <1501522661460-5329925.post@n6.nabble.com>
Message-ID: <1502087464515-5330670.post@n6.nabble.com>

Hi all,
I have written a small tutorial related (in italian):
https://medium.com/tantotanto/trasformare-un-csv-in-un-feed-rss-7a6bd7b8c2f

Thank you gdal/ogr developers



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/CSV-to-GeoRSS-problem-with-pubDate-field-tp5329925p5330670.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From jwalseth at tableau.com  Mon Aug  7 13:18:40 2017
From: jwalseth at tableau.com (Jim Walseth)
Date: Mon, 7 Aug 2017 20:18:40 +0000
Subject: [gdal-dev] tibtiff in GDAL 2.2.1 is hybrid 4.0.7 + patches?
Message-ID: <DM5PR03MB31156A4744B68B2B2979EED3C5B50@DM5PR03MB3115.namprd03.prod.outlook.com>

Greetings,

I am in the process of upgrading our GDAL lib to 2.2.1. The primary motive is to update the internal libtiff to 4.0.8, because of security fixes there. [ref. http://www.simplesystems.org/libtiff/v4.0.8.html]

I find that gdal-2.2.1\frmts\gtiff\libtiff\tiffvers.h is still at 4.0.7, and there are patches applied for a subset of the issues fixed in libtiff 4.0.8.

Question: Have I interpreted the situation correctly?

We actually don't use gtiff/libtiff for anything. To satisfy our security people, I am considering overwriting the libtiff source code with everything from 4.0.8.

Jim Walseth
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170807/6feccc6c/attachment.html>

From even.rouault at spatialys.com  Mon Aug  7 13:47:40 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 07 Aug 2017 22:47:40 +0200
Subject: [gdal-dev] tibtiff in GDAL 2.2.1 is hybrid 4.0.7 + patches?
In-Reply-To: <DM5PR03MB31156A4744B68B2B2979EED3C5B50@DM5PR03MB3115.namprd03.prod.outlook.com>
References: <DM5PR03MB31156A4744B68B2B2979EED3C5B50@DM5PR03MB3115.namprd03.prod.outlook.com>
Message-ID: <3090251.gevAoTXYkd@even-i700>

On lundi 7 août 2017 20:18:40 CEST Jim Walseth wrote:
> Greetings,
> 
> I am in the process of upgrading our GDAL lib to 2.2.1. The primary motive
> is to update the internal libtiff to 4.0.8, because of security fixes
> there. [ref. http://www.simplesystems.org/libtiff/v4.0.8.html]
> 
> I find that gdal-2.2.1\frmts\gtiff\libtiff\tiffvers.h is still at 4.0.7, and
> there are patches applied for a subset of the issues fixed in libtiff
> 4.0.8.
> 
> Question: Have I interpreted the situation correctly?

The internal version of libtiff in GDAL 2.2 is the HEAD version of the libtiff CVS repository at 
the time GDAL was released, so at an intermediate point between 4.0.7 and 4.0.8.

> 
> We actually don't use gtiff/libtiff for anything. To satisfy our security
> people, I am considering overwriting the libtiff source code with
> everything from 4.0.8.

That should work as far as I can remember.

Note: you could also build GDAL against external libtiff, and build libtiff separately if you 
don't want rebuild GDAL everytime you rebuild libtiff


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170807/c5c30c09/attachment.html>

From lucadeluge at gmail.com  Tue Aug  8 01:09:38 2017
From: lucadeluge at gmail.com (Luca Delucchi)
Date: Tue, 8 Aug 2017 10:09:38 +0200
Subject: [gdal-dev] Fwd: [Projects] please create a new project flyer
 for your project with the new branding till FOSS4G Boston
In-Reply-To: <04fddcd1-d61f-6c2a-0d04-e4eac5078e3c@gatewaygeomatics.com>
References: <4153646.znehyYAMKA@even-i700>
 <CAK4m-3zeo=qVgtGDpG-8RN5NKZ50CcMqFvdZYzJh6VEPSyiiLA@mail.gmail.com>
 <2505459.lcIapPjFog@even-i700>
 <04fddcd1-d61f-6c2a-0d04-e4eac5078e3c@gatewaygeomatics.com>
Message-ID: <CAK4m-3wUtOoO_q9GqF8cYGhcxzu3yZc4OU-8fDVnr3HYoYV+TA@mail.gmail.com>

On 5 August 2017 at 23:13, Jeff McKenna <jmckenna at gatewaygeomatics.com> wrote:
> Luca: I have taken Even's feedback and made some more text changes, and also
> added a hillshade DEM (of Frank's home area in Canada) created through GDAL
> 2.2.1 on my machine.  It creates a big SVG now, but you/designer can decide
> to keep that image or not. http://www.gatewaygeomatics.com/dl/gdal_a4.svg
>

Thanks Jeff, good job.

> PS. I created it using LibreOffice!
>

It create strange SVG file completely different from Inkscape, I'm
going to replace text in the old SVG, so it should be simpler to
modify...

> -jeff
>

-- 
ciao
Luca

www.lucadelu.org

From ewenger at ara.com  Tue Aug  8 13:16:55 2017
From: ewenger at ara.com (Eric Wenger ARA/SED)
Date: Tue, 8 Aug 2017 20:16:55 +0000
Subject: [gdal-dev] csharp/gdal/fwtools. Problem with migrating from
 window to ubuntu/mono
In-Reply-To: <1497604579985-5324458.post@n6.nabble.com>
References: <1497604579985-5324458.post@n6.nabble.com>
Message-ID: <F6EA2AD6F3BB79479520160AE9A1BFC4019D84BDE6@colo-mail-1.exchange2.ara.wan>

AndrewB,

Are you still working on this?   I just ported an app from Windows to C# using .net core 2.0 preview 2 and GDAL is working well in that environment.  

--Eric

-----Original Message-----
From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of AndrewB
Sent: Friday, June 16, 2017 5:16 AM
To: gdal-dev at lists.osgeo.org
Subject: [gdal-dev] csharp/gdal/fwtools. Problem with migrating from window to ubuntu/mono

I'm novice in csharp but i need to migrate csharp project from windows to linux(ubuntu)/mono and have problem with this.
I'm using FWTools in C# project under Windows(code below):
including in project 2 dlls and FWTools/Bin in $PATH:
ogr_csharp.dll
osr_csharp.dll

CODE:
using OSGeo.OGR;
using OSGeo.OSR;

private void GenerateMif( ...params... ) {
     Ogr.RegisterAll();
     using (var driver = Ogr.GetDriverByName("MapInfo File") )
            using (var dataSource = driver.CreateDataSource(mifOutputPath,
null) )
            {		
                SpatialReference spatial = GetSpatialByProjection(projection);
                var layer = dataSource.CreateLayer("layer1", spatial, wkbGeometryType.wkbUnknown, null);
                CreateLayerFields(result, layer, fieldDefinitionParameters);


and its works.
 

Now i want migrate this functionality to mono/Ubuntu.  
I'm building project in Xamarin Studio from Windows under Mono/.NET platform 

Ogr.RegisterAll();  handles exception in Ubuntu:

The type initializer for 'OSGeo.OGR.Ogr' threw an exception.
The type initializer for 'OSGeo.OGR.OgrPINVOKE' threw an exception.
  at OSGeo.OGR.Ogr..cctor () [0x0000a] in
<beb44ad5c34649f88fca9cbfa4f938ac>:0
  at ExportPerformer.GenerateMif (
Adding FWTools/Bin into PATH didnt help.

Then
I've downloaded and compiled the source for gdal in GNU/Linux. 
I've compiled the swig/csharp bindings. 

Include compiled
gdal_csharp.dll,gdalconst_csharp.dll,ogr_csharp.dll,osr_csharp.dll to Xamarin Studio in Windows, build project under Mono/.NET platform, run "mono project.exe" from ubuntu and Ogr.RegisterAll(); same DllNotFoundException error:
System.TypeInitializationException: The type initializer for 'OSGeo.OGR.Ogr'
threw an exception. 
---> System.TypeInitializationException: The type initializer for
'OSGeo.OGR.OgrPINVOKE' threw an exception. 
---> System.TypeInitializationException: The type initializer for
'SWIGExceptionHelper' threw an exception. 
---> System.DllNotFoundException: ogrcsharp
  at (wrapper managed-to-native)
OSGeo.OGR.OgrPINVOKE+SWIGExceptionHelper:SWIGRegisterExceptionCallbacks_Ogr
(OSGeo.OGR.OgrPINVOKE/SWIGExceptionHelper/ExceptionDelegate,
OSGeo.OGR.OgrPINVOKE/SWIGExceptionHelper/ExceptionDelegate,
OSGeo.OGR.OgrPINVOKE/SWIGExceptionHelper/ExceptionDelegate,
OSGeo.OGR.OgrPINVOKE/SWIGExceptionHelper/ExceptionDelegate,
OSGeo.OGR.OgrPINVOKE/SWIGExceptionHelper/ExceptionDelegate,
OSGeo.OGR.OgrPINVOKE/SWIGExceptionHelper/ExceptionDelegate,
OSGeo.OGR.OgrPINVOKE/SWIGExceptionHelper/ExceptionDelegate,
OSGeo.OGR.OgrPINVOKE/SWIGExceptionHelper/ExceptionDelegate,
OSGeo.OGR.OgrPINVOKE/SWIGExceptionHelper/ExceptionDelegate,
OSGeo.OGR.OgrPINVOKE/SWIGExceptionHelper/ExceptionDelegate,
OSGeo.OGR.OgrPINVOKE/SWIGExceptionHelper/ExceptionDelegate)
  at OSGeo.OGR.OgrPINVOKE+SWIGExceptionHelper..cctor () [0x000ef] in
<f65c599d29ac40c4b98fd48137f45269>:0    
--- End of inner exception stack trace ---
  at (wrapper managed-to-native)
System.Object:__icall_wrapper_mono_generic_class_init (intptr)
  at OSGeo.OGR.OgrPINVOKE..cctor () [0x00000] in
<f65c599d29ac40c4b98fd48137f45269>:0    
--- End of inner exception stack trace ---
  at OSGeo.OGR.Ogr..cctor () [0x0000a] in
<f65c599d29ac40c4b98fd48137f45269>:0    
--- End of inner exception stack trace ---

What's wrong with that build?


Does that way to migrating from Windows to Linux will works? 
What way(csharp) to migrate this case will be correct?

Thanks.

List of files after compiling swig/csharp under linux <http://osgeo-org.1560.x6.nabble.com/file/n5324458/gdalbuild.png> 



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/csharp-gdal-fwtools-Problem-with-migrating-from-window-to-ubuntu-mono-tp5324458.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev

From ewenger at ara.com  Tue Aug  8 13:18:24 2017
From: ewenger at ara.com (Eric Wenger ARA/SED)
Date: Tue, 8 Aug 2017 20:18:24 +0000
Subject: [gdal-dev] Need solution for C# setup,
 with error at OSGeo.OGR registration
In-Reply-To: <640616DC-1680-4FD6-BA46-DC7B2B8CAD3B@gmail.com>
References: <CABNxGA0MH1y9PmEkGmaytScJQ0Lckakm_8dJWNgC2FyKsKPQyQ@mail.gmail.com>
 <640616DC-1680-4FD6-BA46-DC7B2B8CAD3B@gmail.com>
Message-ID: <F6EA2AD6F3BB79479520160AE9A1BFC4019D84BE0C@colo-mail-1.exchange2.ara.wan>

Chui,

An example here is that you need to have proj.dll in the path so that gdal.dll will load from the PInvoke.  You can use dependency walker to find other dependencies.

From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Tamas Szekeres
Sent: Tuesday, August 01, 2017 12:15 PM
To: C. Zeng
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Need solution for C# setup, with error at OSGeo.OGR registration

Hi,

You probably have multiple dll dependencies availabe in the path. Try copying all the dependencies from the same package to the location where your excutable is running.

Best regards,

Tamas

Az iPhone-omról küldve

2017. aug. 1. dátummal, 17:08 időpontban C. Zeng <chqzeng at gmail.com<mailto:chqzeng at gmail.com>> írta:
​Hello all,

I am trying to setup the GDAL in C#.NET 2015, with an error at the registration of the Ogr. A previous post<http://osgeo-org.1560.x6.nabble.com/gdal-dev-Need-solution-for-C-exception-OSGeo-OGR-OgrPINVOKE-td5062693.html#a5329043> stated the exact same problem but without a solution, I tried to reply in that post but failed,thus send this email instead.

That previous post described my problem very well:
"I am using ogr_csharp.dll in my c# program. See the following code snippet:
using OSGeo.OGR;
namespace Test
{
    public class Test
    {
        public Test()
        {
                ...
                  Ogr.RegisterAll();
        }
    }
}
Then the following exception message was thrown out when the program is executed:
{"The type initializer for 'OSGeo.OGR.OgrPINVOKE' threw an exception."}
System.Exception {System.TypeInitializationException}
Does anyone know how to resolve this issue? "

Some more details for my case. My steps are:
- downloaded the stable or daily stable release (same error later) from here<http://www.gisinternals.com/query.html?content=filelist&file=release-1800-x64-gdal-2-1-mapserver-7-0.zip>.
- added the "...\bin" and "...\bin\gdal\csharp" to Environment Variable, setup a sample project,
- add the 4 "###sharp.dll" from csharp folder to project reference.
- import namespace:  using OSGeo.OGR; using OSGeo.OSR;  and add a simple line "Ogr.RegisterAll(); "

Then I can successfully build the project, but with the following error msg. I tried all possible solutions by Google plus this forum such as this<http://osgeo-org.1560.x6.nabble.com/gdal-dev-GDAL-OGR-64bit-PINVOKE-Exception-td3745305.html> and this<http://osgeo-org.1560.x6.nabble.com/c-Bindings-in-Mono-Linux-td3758565.html#a3758569>.
test all the x64/x86 , debug/release, switches, no luck.

Any comment is appreciated, thank you!

Chui



--------------------------error message --------------------------

Unhandled Exception: System.TypeInitializationException: The type initializer fo
r 'OSGeo.OGR.OgrPINVOKE' threw an exception. ---> System.TypeInitializationExcep
tion: The type initializer for 'SWIGExceptionHelper' threw an exception. ---> Sy
stem.BadImageFormatException: An attempt was made to load a program with an inco
rrect format. (Exception from HRESULT: 0x8007000B)
   at OSGeo.OGR.OgrPINVOKE.SWIGExceptionHelper.SWIGRegisterExceptionCallbacks_Og
r(ExceptionDelegate applicationDelegate, ExceptionDelegate arithmeticDelegate, E
xceptionDelegate divideByZeroDelegate, ExceptionDelegate indexOutOfRangeDelegate
, ExceptionDelegate invalidCastDelegate, ExceptionDelegate invalidOperationDeleg
ate, ExceptionDelegate ioDelegate, ExceptionDelegate nullReferenceDelegate, Exce
ptionDelegate outOfMemoryDelegate, ExceptionDelegate overflowDelegate, Exception
Delegate systemExceptionDelegate)
   at OSGeo.OGR.OgrPINVOKE.SWIGExceptionHelper..cctor()
   --- End of inner exception stack trace ---
   at OSGeo.OGR.OgrPINVOKE.SWIGExceptionHelper..ctor()
   at OSGeo.OGR.OgrPINVOKE..cctor()
   --- End of inner exception stack trace ---
   at OSGeo.OGR.OgrPINVOKE.RegisterAll()
   at OSGeo.OGR.Ogr.RegisterAll()
   at TestProj.Main(String[] args) in \user\Downloads\Workspace\TestProj\project.cs:line 47

and also the following log info:
'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded 'C:\WINDOWS\Microsoft.Net<http://Microsoft.Net>\assembly\GAC_64\mscorlib\v4.0_4.0.0.0__b77a5c561934e089\mscorlib.dll'. Cannot find or open the PDB file.
'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded 'C:\WINDOWS\assembly\GAC_MSIL\Microsoft.VisualStudio.HostingProcess.Utilities\14.0.0.0__b03f5f7f11d50a3a\Microsoft.VisualStudio.HostingProcess.Utilities.dll'. Cannot find or open the PDB file.
'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded 'C:\WINDOWS\Microsoft.Net<http://Microsoft.Net>\assembly\GAC_MSIL\System.Windows.Forms\v4.0_4.0.0.0__b77a5c561934e089\System.Windows.Forms.dll'. Cannot find or open the PDB file.
'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded 'C:\WINDOWS\Microsoft.Net<http://Microsoft.Net>\assembly\GAC_MSIL\System\v4.0_4.0.0.0__b77a5c561934e089\System.dll'. Cannot find or open the PDB file.
'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded 'C:\WINDOWS\Microsoft.Net<http://Microsoft.Net>\assembly\GAC_MSIL\System.Drawing\v4.0_4.0.0.0__b03f5f7f11d50a3a\System.Drawing.dll'. Cannot find or open the PDB file.
'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded 'C:\WINDOWS\assembly\GAC_MSIL\Microsoft.VisualStudio.HostingProcess.Utilities.Sync\14.0.0.0__b03f5f7f11d50a3a\Microsoft.VisualStudio.HostingProcess.Utilities.Sync.dll'. Cannot find or open the PDB file.
'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded 'C:\WINDOWS\assembly\GAC_MSIL\Microsoft.VisualStudio.Debugger.Runtime\14.0.0.0__b03f5f7f11d50a3a\Microsoft.VisualStudio.Debugger.Runtime.dll'.
'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded '\user\Downloads\Gdal_folder\TestProj\bin\Debug\TestProj.vshost.exe'. Cannot find or open the PDB file.
'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded 'C:\WINDOWS\Microsoft.Net<http://Microsoft.Net>\assembly\GAC_MSIL\System.Core\v4.0_4.0.0.0__b77a5c561934e089\System.Core.dll'. Cannot find or open the PDB file.
'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded 'C:\WINDOWS\Microsoft.Net<http://Microsoft.Net>\assembly\GAC_MSIL\System.Xml.Linq\v4.0_4.0.0.0__b77a5c561934e089\System.Xml.Linq.dll'. Cannot find or open the PDB file.
'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded 'C:\WINDOWS\Microsoft.Net<http://Microsoft.Net>\assembly\GAC_MSIL\System.Data.DataSetExtensions\v4.0_4.0.0.0__b77a5c561934e089\System.Data.DataSetExtensions.dll'. Cannot find or open the PDB file.
'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded 'C:\WINDOWS\Microsoft.Net<http://Microsoft.Net>\assembly\GAC_MSIL\Microsoft.CSharp\v4.0_4.0.0.0__b03f5f7f11d50a3a\Microsoft.CSharp.dll'. Cannot find or open the PDB file.
'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded 'C:\WINDOWS\Microsoft.Net<http://Microsoft.Net>\assembly\GAC_64\System.Data\v4.0_4.0.0.0__b77a5c561934e089\System.Data.dll'. Cannot find or open the PDB file.
'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded 'C:\WINDOWS\Microsoft.Net<http://Microsoft.Net>\assembly\GAC_MSIL\System.Net.Http\v4.0_4.0.0.0__b03f5f7f11d50a3a\System.Net.Http.dll'. Cannot find or open the PDB file.
'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded 'C:\WINDOWS\Microsoft.Net<http://Microsoft.Net>\assembly\GAC_MSIL\System.Xml\v4.0_4.0.0.0__b77a5c561934e089\System.Xml.dll'. Cannot find or open the PDB file.
The thread 0x2228 has exited with code 0 (0x0).
The thread 0x1b30 has exited with code 0 (0x0).
The thread 0x2a64 has exited with code 0 (0x0).
'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded '\user\Downloads\Gdal_folder\TestProj\bin\Debug\TestProj.exe'. Symbols loaded.
The thread 0x2c20 has exited with code 0 (0x0).
'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded '\user\Downloads\Gdal_folder\TestProj\bin\Debug\ogr_csharp.dll'. Module was built without symbols.
Exception thrown: 'System.DllNotFoundException' in ogr_csharp.dll
Exception thrown: 'System.TypeInitializationException' in ogr_csharp.dll
Exception thrown: 'System.TypeInitializationException' in ogr_csharp.dll
An unhandled exception of type 'System.TypeInitializationException' occurred in ogr_csharp.dll
Additional information: The type initializer for 'OSGeo.OGR.OgrPINVOKE' threw an exception.

The program '[2244] TestProj.vshost.exe' has exited with code 0 (0x0)
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170808/63a60f4e/attachment-0001.html>

From tbma-1 at yandex.ru  Wed Aug  9 02:00:26 2017
From: tbma-1 at yandex.ru (AndrewB)
Date: Wed, 9 Aug 2017 02:00:26 -0700 (MST)
Subject: [gdal-dev] csharp/gdal/fwtools. Problem with migrating from
 window to ubuntu/mono
In-Reply-To: <F6EA2AD6F3BB79479520160AE9A1BFC4019D84BDE6@colo-mail-1.exchange2.ara.wan>
References: <1497604579985-5324458.post@n6.nabble.com>
 <F6EA2AD6F3BB79479520160AE9A1BFC4019D84BDE6@colo-mail-1.exchange2.ara.wan>
Message-ID: <1502269226926-5330931.post@n6.nabble.com>

ewenger, 

Yes, i'm still working on this but now try to use MITAB project from
http://mitab.maptools.org/. Its works but few function are missing what i
need.

Can u send me example of your project or write what steps are u doing? Its
very helps me.

Thanks!



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/csharp-gdal-fwtools-Problem-with-migrating-from-window-to-ubuntu-mono-tp5324458p5330931.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From ewenger at ara.com  Tue Aug  8 13:22:01 2017
From: ewenger at ara.com (Eric Wenger ARA/SED)
Date: Tue, 8 Aug 2017 20:22:01 +0000
Subject: [gdal-dev] Raster statistics
In-Reply-To: <CAHNf2YSMrsKX0cG3hDLyn8+1RO1UxUtzok91Q9a_ukM3isKpAA@mail.gmail.com>
References: <CAHNf2YSL+THbAUcAL2J5770sJi6DnsX8LhPNN8ZUDaL73LHPiw@mail.gmail.com>
 <D6E64FEE-1A59-4361-96FA-9B57C41136D5@alaska.edu>
 <CAHNf2YSMrsKX0cG3hDLyn8+1RO1UxUtzok91Q9a_ukM3isKpAA@mail.gmail.com>
Message-ID: <F6EA2AD6F3BB79479520160AE9A1BFC4019D84BE34@colo-mail-1.exchange2.ara.wan>

Paul,

You could call gdal_calc.py and pass it the numpy formulas on the command line…Otherwise it might be best to bring the raster in to OpenCV.

--Eric

From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Paul Meems
Sent: Thursday, August 03, 2017 2:51 PM
To: Chris Waigl
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Raster statistics

Thanks Chris for your reply.

I forgot to mention I'm not using GDAL with Python.
I use it with C++ and/or C#.




Paul

[http://www.bontepaarden.nl/bontepaarden/images/newButton.png]Paul Meems
Release manager, configuration manager
and forum moderator of MapWindow GIS.
www.mapwindow.org<http://www.mapwindow.org/>

Owner of MapWindow.nl - Support for
Dutch speaking users.
www.mapwindow.nl<http://www.mapwindow.nl/>



The MapWindow GIS project has moved to GitHub<https://github.com/MapWindow>!

Download the latest MapWinGIS mapping engine.<https://github.com/MapWindow/MapWinGIS/releases>

Download the latest MapWindow 5 open source desktop application.<https://github.com/MapWindow/MapWindow5/releases>


2017-08-03 20:05 GMT+02:00 Chris Waigl <cwaigl at alaska.edu<mailto:cwaigl at alaska.edu>>:
I would not use gdal for this particular task. I presume you have the band data in a 2D numpy array. Then I’d get the 80th percentile for example with np.percentile() and use a boolean expression to generate a mask for the array (droneraster > perc80value ).

Chris

--
Christine (Chris) Waigl - cwaigl at alaska.edu<mailto:cwaigl at alaska.edu> -  +1-907-474-5483<tel:(907)%20474-5483> - Skype: cwaigl_work
Geophysical Institute, UAF, 903 Koyukuk Drive, Fairbanks, AK 99775-7320, USA






On Aug 3, 2017, at 5:43 AM, Paul Meems <bontepaarden at gmail.com<mailto:bontepaarden at gmail.com>> wrote:

I have a drone raster file which I want to use for some calculation.
Before the calculation, I need to loose some extreme values.
I want to do something like a percentile calculation where you get all values, order them and loose the top 10%.
For this, I need to get all values first which can be slow when using a large file.

I looked at the statistics (band.GetStatistics) but that doesn't work well.
I thought I could use 2 times the standard deviation added to the mean to get roughly 97%.
But with these statistics:
    STATISTICS_MAXIMUM=33.186080932617
    STATISTICS_MEAN=24.840205979603
    STATISTICS_MINIMUM=1.5951598882675
    STATISTICS_STDDEV=4.7285348016053
Mean + 2*std is larger than the max.

So I moved to the histogram. It is also very fast, but I'm not sure how to use it.
I have this:
  256 buckets from 1.53322 to 33.248:
  410 77 66 66 65 58 56 45 42 87 57 72 61 65 68 70 73 82 93 ...
Does this mean, bucket 1 = 410 that I have 410 pixels of value 1.53322 and the second bucket means I have 77 pixels between 1.53322 and 1.657? 1.657 = 1.53322 + ((33.248 - 1.53322)/256)

Is this a good approach? Or can/should I use a different one.

Thanks,

Paul
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170808/0f1e943a/attachment.html>

From chqzeng at gmail.com  Wed Aug  9 18:04:36 2017
From: chqzeng at gmail.com (C. Zeng)
Date: Wed, 9 Aug 2017 21:04:36 -0400
Subject: [gdal-dev] Need solution for C# setup,
	with error at OSGeo.OGR registration
In-Reply-To: <F6EA2AD6F3BB79479520160AE9A1BFC4019D84BE0C@colo-mail-1.exchange2.ara.wan>
References: <CABNxGA0MH1y9PmEkGmaytScJQ0Lckakm_8dJWNgC2FyKsKPQyQ@mail.gmail.com>
 <640616DC-1680-4FD6-BA46-DC7B2B8CAD3B@gmail.com>
 <F6EA2AD6F3BB79479520160AE9A1BFC4019D84BE0C@colo-mail-1.exchange2.ara.wan>
Message-ID: <CABNxGA1u5B1xaB_iGnodt4JyBGCwM-crz7-pCqaLL7G8PH1Nmg@mail.gmail.com>

Thank you Eric and Tamas,

I have switched to python with Gdal, due to this setup issue with C# and
other platform consideration. Thank you two for the help!.

Best,

Chui,

On Tue, Aug 8, 2017 at 4:18 PM, Eric Wenger ARA/SED <ewenger at ara.com> wrote:

> *Chui,*
>
>
>
> *An example here is that you need to have proj.dll in the path so that
> gdal.dll will load from the PInvoke.  You can use dependency walker to find
> other dependencies.*
>
>
>
> *From:* gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] *On Behalf Of *Tamas
> Szekeres
> *Sent:* Tuesday, August 01, 2017 12:15 PM
> *To:* C. Zeng
> *Cc:* gdal-dev at lists.osgeo.org
> *Subject:* Re: [gdal-dev] Need solution for C# setup, with error at
> OSGeo.OGR registration
>
>
>
> Hi,
>
>
>
> You probably have multiple dll dependencies availabe in the path. Try
> copying all the dependencies from the same package to the location where
> your excutable is running.
>
>
>
> Best regards,
>
>
>
> Tamas
>
> Az iPhone-omról küldve
>
>
> 2017. aug. 1. dátummal, 17:08 időpontban C. Zeng <chqzeng at gmail.com> írta:
>
> ​Hello all,
>
>
>
> I am trying to setup the GDAL in C#.NET 2015, with an error at the
> registration of the Ogr. A previous post
> <http://osgeo-org.1560.x6.nabble.com/gdal-dev-Need-solution-for-C-exception-OSGeo-OGR-OgrPINVOKE-td5062693.html#a5329043>
> stated the exact same problem but without a solution, I tried to reply in
> that post but failed,thus send this email instead.
>
>
>
> That previous post described my problem very well:
>
> "I am using *ogr_csharp.dl*l in my c# program. See the following code
> snippet:
> using OSGeo.OGR;
> namespace Test
> {
>     public class Test
>     {
>         public Test()
>         {
>                 ...
>                   Ogr.RegisterAll();
>         }
>     }
> }
> Then the following exception message was thrown out when the program is
> executed:
> *{"The type initializer for 'OSGeo.OGR.OgrPINVOKE' threw an exception."}
>      *
> *System.Exception {System.TypeInitializationException}*
> Does anyone know how to resolve this issue? "
>
>
>
> Some more details for my case. My steps are:
>
> - downloaded the stable or daily stable release (same error later) from
> here
> <http://www.gisinternals.com/query.html?content=filelist&file=release-1800-x64-gdal-2-1-mapserver-7-0.zip>
> .
> - added the "...\bin" and "...\bin\gdal\csharp" to Environment Variable,
> setup a sample project,
> - add the 4 "###sharp.dll" from csharp folder to project reference.
> - import namespace:  using OSGeo.OGR; using OSGeo.OSR;  and add a simple
> line "Ogr.RegisterAll(); "
>
> Then I can successfully build the project, but with the following error
> msg. I tried all possible solutions by Google plus this forum such as this
> <http://osgeo-org.1560.x6.nabble.com/gdal-dev-GDAL-OGR-64bit-PINVOKE-Exception-td3745305.html>
>  and this
> <http://osgeo-org.1560.x6.nabble.com/c-Bindings-in-Mono-Linux-td3758565.html#a3758569>
> .
> test all the x64/x86 , debug/release, switches, no luck.
>
> Any comment is appreciated, thank you!
>
> Chui
>
>
>
> --------------------------error message --------------------------
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
> *Unhandled Exception: System.TypeInitializationException: The type
> initializer fo  r 'OSGeo.OGR.OgrPINVOKE' threw an exception. --->
> System.TypeInitializationExcep  tion: The type initializer for
> 'SWIGExceptionHelper' threw an exception. ---> Sy
> stem.BadImageFormatException: An attempt was made to load a program with an
> inco  rrect format. (Exception from HRESULT: 0x8007000B)     at
> OSGeo.OGR.OgrPINVOKE.SWIGExceptionHelper.SWIGRegisterExceptionCallbacks_Og
> r(ExceptionDelegate applicationDelegate, ExceptionDelegate
> arithmeticDelegate, E  xceptionDelegate divideByZeroDelegate,
> ExceptionDelegate indexOutOfRangeDelegate  , ExceptionDelegate
> invalidCastDelegate, ExceptionDelegate invalidOperationDeleg  ate,
> ExceptionDelegate ioDelegate, ExceptionDelegate nullReferenceDelegate,
> Exce  ptionDelegate outOfMemoryDelegate, ExceptionDelegate
> overflowDelegate, Exception  Delegate systemExceptionDelegate)     at
> OSGeo.OGR.OgrPINVOKE.SWIGExceptionHelper..cctor()     --- End of inner
> exception stack trace ---     at
> OSGeo.OGR.OgrPINVOKE.SWIGExceptionHelper..ctor()     at
> OSGeo.OGR.OgrPINVOKE..cctor()     --- End of inner exception stack trace
> ---     at OSGeo.OGR.OgrPINVOKE.RegisterAll()     at
> OSGeo.OGR.Ogr.RegisterAll()     at TestProj.Main(String[] args) in
> \user\Downloads\Workspace\TestProj\project.cs:line 47*
>
> and also the following log info:
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
> *'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded
> 'C:\WINDOWS\Microsoft.Net
> <http://Microsoft.Net>\assembly\GAC_64\mscorlib\v4.0_4.0.0.0__b77a5c561934e089\mscorlib.dll'.
> Cannot find or open the PDB file.  'TestProj.vshost.exe' (CLR v4.0.30319:
> TestProj.vshost.exe): Loaded
> 'C:\WINDOWS\assembly\GAC_MSIL\Microsoft.VisualStudio.HostingProcess.Utilities\14.0.0.0__b03f5f7f11d50a3a\Microsoft.VisualStudio.HostingProcess.Utilities.dll'.
> Cannot find or open the PDB file.  'TestProj.vshost.exe' (CLR v4.0.30319:
> TestProj.vshost.exe): Loaded 'C:\WINDOWS\Microsoft.Net
> <http://Microsoft.Net>\assembly\GAC_MSIL\System.Windows.Forms\v4.0_4.0.0.0__b77a5c561934e089\System.Windows.Forms.dll'.
> Cannot find or open the PDB file.  'TestProj.vshost.exe' (CLR v4.0.30319:
> TestProj.vshost.exe): Loaded 'C:\WINDOWS\Microsoft.Net
> <http://Microsoft.Net>\assembly\GAC_MSIL\System\v4.0_4.0.0.0__b77a5c561934e089\System.dll'.
> Cannot find or open the PDB file.  'TestProj.vshost.exe' (CLR v4.0.30319:
> TestProj.vshost.exe): Loaded 'C:\WINDOWS\Microsoft.Net
> <http://Microsoft.Net>\assembly\GAC_MSIL\System.Drawing\v4.0_4.0.0.0__b03f5f7f11d50a3a\System.Drawing.dll'.
> Cannot find or open the PDB file.  'TestProj.vshost.exe' (CLR v4.0.30319:
> TestProj.vshost.exe): Loaded
> 'C:\WINDOWS\assembly\GAC_MSIL\Microsoft.VisualStudio.HostingProcess.Utilities.Sync\14.0.0.0__b03f5f7f11d50a3a\Microsoft.VisualStudio.HostingProcess.Utilities.Sync.dll'.
> Cannot find or open the PDB file.  'TestProj.vshost.exe' (CLR v4.0.30319:
> TestProj.vshost.exe): Loaded
> 'C:\WINDOWS\assembly\GAC_MSIL\Microsoft.VisualStudio.Debugger.Runtime\14.0.0.0__b03f5f7f11d50a3a\Microsoft.VisualStudio.Debugger.Runtime.dll'.
> 'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded
> '\user\Downloads\Gdal_folder\TestProj\bin\Debug\TestProj.vshost.exe'.
> Cannot find or open the PDB file.  'TestProj.vshost.exe' (CLR v4.0.30319:
> TestProj.vshost.exe): Loaded 'C:\WINDOWS\Microsoft.Net
> <http://Microsoft.Net>\assembly\GAC_MSIL\System.Core\v4.0_4.0.0.0__b77a5c561934e089\System.Core.dll'.
> Cannot find or open the PDB file.  'TestProj.vshost.exe' (CLR v4.0.30319:
> TestProj.vshost.exe): Loaded 'C:\WINDOWS\Microsoft.Net
> <http://Microsoft.Net>\assembly\GAC_MSIL\System.Xml.Linq\v4.0_4.0.0.0__b77a5c561934e089\System.Xml.Linq.dll'.
> Cannot find or open the PDB file.  'TestProj.vshost.exe' (CLR v4.0.30319:
> TestProj.vshost.exe): Loaded 'C:\WINDOWS\Microsoft.Net
> <http://Microsoft.Net>\assembly\GAC_MSIL\System.Data.DataSetExtensions\v4.0_4.0.0.0__b77a5c561934e089\System.Data.DataSetExtensions.dll'.
> Cannot find or open the PDB file.  'TestProj.vshost.exe' (CLR v4.0.30319:
> TestProj.vshost.exe): Loaded 'C:\WINDOWS\Microsoft.Net
> <http://Microsoft.Net>\assembly\GAC_MSIL\Microsoft.CSharp\v4.0_4.0.0.0__b03f5f7f11d50a3a\Microsoft.CSharp.dll'.
> Cannot find or open the PDB file.  'TestProj.vshost.exe' (CLR v4.0.30319:
> TestProj.vshost.exe): Loaded 'C:\WINDOWS\Microsoft.Net
> <http://Microsoft.Net>\assembly\GAC_64\System.Data\v4.0_4.0.0.0__b77a5c561934e089\System.Data.dll'.
> Cannot find or open the PDB file.  'TestProj.vshost.exe' (CLR v4.0.30319:
> TestProj.vshost.exe): Loaded 'C:\WINDOWS\Microsoft.Net
> <http://Microsoft.Net>\assembly\GAC_MSIL\System.Net.Http\v4.0_4.0.0.0__b03f5f7f11d50a3a\System.Net.Http.dll'.
> Cannot find or open the PDB file.  'TestProj.vshost.exe' (CLR v4.0.30319:
> TestProj.vshost.exe): Loaded 'C:\WINDOWS\Microsoft.Net
> <http://Microsoft.Net>\assembly\GAC_MSIL\System.Xml\v4.0_4.0.0.0__b77a5c561934e089\System.Xml.dll'.
> Cannot find or open the PDB file.  The thread 0x2228 has exited with code 0
> (0x0).  The thread 0x1b30 has exited with code 0 (0x0).  The thread 0x2a64
> has exited with code 0 (0x0).  'TestProj.vshost.exe' (CLR v4.0.30319:
> TestProj.vshost.exe): Loaded
> '\user\Downloads\Gdal_folder\TestProj\bin\Debug\TestProj.exe'. Symbols
> loaded.  The thread 0x2c20 has exited with code 0 (0x0).
> 'TestProj.vshost.exe' (CLR v4.0.30319: TestProj.vshost.exe): Loaded
> '\user\Downloads\Gdal_folder\TestProj\bin\Debug\ogr_csharp.dll'. Module was
> built without symbols.  Exception thrown: 'System.DllNotFoundException' in
> ogr_csharp.dll  Exception thrown: 'System.TypeInitializationException' in
> ogr_csharp.dll  Exception thrown: 'System.TypeInitializationException' in
> ogr_csharp.dll  An unhandled exception of type
> 'System.TypeInitializationException' occurred in ogr_csharp.dll  Additional
> information: The type initializer for 'OSGeo.OGR.OgrPINVOKE' threw an
> exception.  The program '[2244] TestProj.vshost.exe' has exited with code 0
> (0x0)*
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170809/b5243b2a/attachment-0001.html>

From even.rouault at spatialys.com  Thu Aug 10 00:17:58 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 10 Aug 2017 09:17:58 +0200
Subject: [gdal-dev] Fwd: [OpenJPEG] OpenJPEG 2.2.0 is out ! Faster and safer.
Message-ID: <2005627.kjaARoHoed@even-i700>

Hi,

For those working with JPEG2000, see below

Even

----------  Forwarded Message  ----------

Subject: [OpenJPEG] OpenJPEG 2.2.0 is out ! Faster and safer.
Date: jeudi 10 août 2017, 04:58:13 CEST
From: Antonin - OpenJPEG <info at openjpeg.org>
To: openjpeg at googlegroups.com <openjpeg at googlegroups.com>

Hi folks,

OpenJPEG 2.2.0 is released today:
https://github.com/uclouvain/openjpeg/releases/tag/v2.2.0

This new release includes a significant number of improvements and bug fixes. In particular:
- Multi-threading support at decoding side
- Several speed optimisations both at encoder and decoder, and both on Wavelet Transform 
and Entropy Coding parts. On our test set, a single-threaded execution is now around 20% 
faster (encoding or decoding).
- Huge memory consumption reduction at decoding side (~60% reduction on large images)
- Several important bug fixes, in particular the one that was preventing OpenJPEG to encode 
lossless in some specific situations, as well as those related to mode switches (BYPASS/LAZY, 
RESTART/TERMALL, etc).
- Several security fixes thanks to the inclusion of OpenJPEG in the Google OSS Fuzz project.

Beside that, several improvements have been brought to the project maintenance, like 
inclusion of benchmarking scripts to compare speed with latest available kakadu binaries.

And, last but not least, API and ABI are 100% compatible with previous version.

More info:
News: https://github.com/uclouvain/openjpeg/blob/v2.2.0/NEWS.md
Changelog: https://github.com/uclouvain/openjpeg/blob/v2.2.0/CHANGELOG.md
Full Changelog: https://github.com/uclouvain/openjpeg/compare/v2.1.2...v2.2.0

As described in a previous post (https://groups.google.com/d/msg/openjpeg/CltNQpbbwm4/
jajpDKq0AAAJ), all this has been made possible thanks to a funding from academic 
institutions and archival organizations, namely:
- Wellcome Library
- Stanford University
- Nationale Bibliotheek van Nederland (KBNL)
- University of Michigan
- University of California, Los Angeles (UCLA)
And logistic support from the International Image Interoperability Framework (IIIF), the 
Council on Library and Information Resources (CLIR), intoPIX, and of course the Image and 
Signal Processing Group (ISPGroup) from University of Louvain (UCL, Belgium) hosting the 
OpenJPEG project. Thanks to all of them !

Many thanks also to Even Rouault, the developper who actually implemented these 
improvements, and of course to all contributors having suggested fixes or enhancements.

I hope you will find this new version useful, don’t hesitate to provide feedback to improve it 
even further. By the way, more improvements are yet to come in the coming months. 

Enjoy,

Antonin

-- 
You are subscribed to the mailing-list of the OpenJPEG project (www.openjpeg.org)
To post: email to openjpeg at googlegroups.com
To unsubscribe: email to openjpeg+unsubscribe at googlegroups.com
For more options: visit http://groups.google.com/group/openjpeg
OpenJPEG is mainly supported by : 
* UCL Image and Signal Processing Group (http://sites.uclouvain.be/ispgroup) 
* IntoPIX (www.intopix.com)

-----------------------------------------
-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170810/2877b6f3/attachment.html>

From mateusz at loskot.net  Thu Aug 10 00:25:06 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu, 10 Aug 2017 09:25:06 +0200
Subject: [gdal-dev] Fwd: [OpenJPEG] OpenJPEG 2.2.0 is out ! Faster and
	safer.
In-Reply-To: <2005627.kjaARoHoed@even-i700>
References: <2005627.kjaARoHoed@even-i700>
Message-ID: <CABUeae_6+rOdaFhyx7g5Pdc=qK99QHeV+fkkihK=APYtO0xEWQ@mail.gmail.com>

Great efforts Even!

On 10 August 2017 at 09:17, Even Rouault <even.rouault at spatialys.com> wrote:
> Hi,
>
>
>
> For those working with JPEG2000, see below
>
>
>
> Even
>
>
>
> ---------- Forwarded Message ----------
>
>
>
> Subject: [OpenJPEG] OpenJPEG 2.2.0 is out ! Faster and safer.
>
> Date: jeudi 10 août 2017, 04:58:13 CEST
>
> From: Antonin - OpenJPEG <info at openjpeg.org>
>
> To: openjpeg at googlegroups.com <openjpeg at googlegroups.com>
>
>
>
> Hi folks,
>
>
>
> OpenJPEG 2.2.0 is released today:
>
> https://github.com/uclouvain/openjpeg/releases/tag/v2.2.0
>
>
>
> This new release includes a significant number of improvements and bug
> fixes. In particular:
>
> - Multi-threading support at decoding side
>
> - Several speed optimisations both at encoder and decoder, and both on
> Wavelet Transform and Entropy Coding parts. On our test set, a
> single-threaded execution is now around 20% faster (encoding or decoding).
>
> - Huge memory consumption reduction at decoding side (~60% reduction on
> large images)
>
> - Several important bug fixes, in particular the one that was preventing
> OpenJPEG to encode lossless in some specific situations, as well as those
> related to mode switches (BYPASS/LAZY, RESTART/TERMALL, etc).
>
> - Several security fixes thanks to the inclusion of OpenJPEG in the Google
> OSS Fuzz project.
>
>
>
> Beside that, several improvements have been brought to the project
> maintenance, like inclusion of benchmarking scripts to compare speed with
> latest available kakadu binaries.
>
>
>
> And, last but not least, API and ABI are 100% compatible with previous
> version.
>
>
>
> More info:
>
> News: https://github.com/uclouvain/openjpeg/blob/v2.2.0/NEWS.md
>
> Changelog: https://github.com/uclouvain/openjpeg/blob/v2.2.0/CHANGELOG.md
>
> Full Changelog:
> https://github.com/uclouvain/openjpeg/compare/v2.1.2...v2.2.0
>
>
>
> As described in a previous post
> (https://groups.google.com/d/msg/openjpeg/CltNQpbbwm4/jajpDKq0AAAJ), all
> this has been made possible thanks to a funding from academic institutions
> and archival organizations, namely:
>
> - Wellcome Library
>
> - Stanford University
>
> - Nationale Bibliotheek van Nederland (KBNL)
>
> - University of Michigan
>
> - University of California, Los Angeles (UCLA)
>
> And logistic support from the International Image Interoperability Framework
> (IIIF), the Council on Library and Information Resources (CLIR), intoPIX,
> and of course the Image and Signal Processing Group (ISPGroup) from
> University of Louvain (UCL, Belgium) hosting the OpenJPEG project. Thanks to
> all of them !
>
>
>
> Many thanks also to Even Rouault, the developper who actually implemented
> these improvements, and of course to all contributors having suggested fixes
> or enhancements.
>
>
>
> I hope you will find this new version useful, don’t hesitate to provide
> feedback to improve it even further. By the way, more improvements are yet
> to come in the coming months.
>
>
>
> Enjoy,
>
>
>
> Antonin
>
>
>
> --
>
> You are subscribed to the mailing-list of the OpenJPEG project
> (www.openjpeg.org)
>
> To post: email to openjpeg at googlegroups.com
>
> To unsubscribe: email to openjpeg+unsubscribe at googlegroups.com
>
> For more options: visit http://groups.google.com/group/openjpeg
>
> OpenJPEG is mainly supported by :
>
> * UCL Image and Signal Processing Group (http://sites.uclouvain.be/ispgroup)
>
> * IntoPIX (www.intopix.com)
>
>
>
> -----------------------------------------
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Mateusz Loskot, http://mateusz.loskot.net

From manisandro at gmail.com  Thu Aug 10 11:04:09 2017
From: manisandro at gmail.com (Sandro Mani)
Date: Thu, 10 Aug 2017 20:04:09 +0200
Subject: [gdal-dev] Fwd: [OpenJPEG] OpenJPEG 2.2.0 is out ! Faster and
 safer.
In-Reply-To: <2005627.kjaARoHoed@even-i700>
References: <2005627.kjaARoHoed@even-i700>
Message-ID: <6704a02a-b9cc-07a6-2a48-76ba3a763c03@gmail.com>

Hi Even

abidiff tells me:


* Incompatible ABI changes between openjpeg2-2.1.2-4.fc26.x86_64.rpm and openjpeg2-2.2.0-1.fc26.x86_64.rpm. ABI comparison took 0.45 second(s). Please review them.

================ changes of 'libopenjp2.so.2.1.2'===============
   Functions changes summary: 9 Removed, 5 Changed, 31 Added functions
   Variables changes summary: 0 Removed, 0 Changed, 0 Added variable

   9 Removed functions:

     'function void opj_mqc_create()'    {opj_mqc_create}
     'function OPJ_INT32 opj_mqc_decode()'    {opj_mqc_decode}
     'function void opj_mqc_destroy()'    {opj_mqc_destroy}
     'function OPJ_UINT32 opj_mqc_restart_enc()'    {opj_mqc_restart_enc}
     'function void opj_raw_create()'    {opj_raw_create}
     'function OPJ_UINT32 opj_raw_decode()'    {opj_raw_decode}
     'function void opj_raw_destroy()'    {opj_raw_destroy}
     'function void opj_raw_init_dec(OPJ_BYTE*, OPJ_UINT32)'    {opj_raw_init_dec}
     'function OPJ_UINT32 opj_raw_numbytes()'    {opj_raw_numbytes}

Is the ABI really 100% compatible?

Thanks
Sandro


On 10.08.2017 09:17, Even Rouault wrote:
>
> Hi,
>
> For those working with JPEG2000, see below
>
> Even
>
> ---------- Forwarded Message ----------
>
> Subject: [OpenJPEG] OpenJPEG 2.2.0 is out ! Faster and safer.
>
> Date: jeudi 10 août 2017, 04:58:13 CEST
>
> From: Antonin - OpenJPEG <info at openjpeg.org>
>
> To: openjpeg at googlegroups.com <openjpeg at googlegroups.com>
>
> Hi folks,
>
> OpenJPEG 2.2.0 is released today:
>
> https://github.com/uclouvain/openjpeg/releases/tag/v2.2.0
>
> This new release includes a significant number of improvements and bug 
> fixes. In particular:
>
> - Multi-threading support at decoding side
>
> - Several speed optimisations both at encoder and decoder, and both on 
> Wavelet Transform and Entropy Coding parts. On our test set, a 
> single-threaded execution is now around 20% faster (encoding or decoding).
>
> - Huge memory consumption reduction at decoding side (~60% reduction 
> on large images)
>
> - Several important bug fixes, in particular the one that was 
> preventing OpenJPEG to encode lossless in some specific situations, as 
> well as those related to mode switches (BYPASS/LAZY, RESTART/TERMALL, 
> etc).
>
> - Several security fixes thanks to the inclusion of OpenJPEG in the 
> Google OSS Fuzz project.
>
> Beside that, several improvements have been brought to the project 
> maintenance, like inclusion of benchmarking scripts to compare speed 
> with latest available kakadu binaries.
>
> And, last but not least, API and ABI are 100% compatible with previous 
> version.
>
> More info:
>
> News: https://github.com/uclouvain/openjpeg/blob/v2.2.0/NEWS.md
>
> Changelog: https://github.com/uclouvain/openjpeg/blob/v2.2.0/CHANGELOG.md
>
> Full Changelog: 
> https://github.com/uclouvain/openjpeg/compare/v2.1.2...v2.2.0
>
> As described in a previous post 
> (https://groups.google.com/d/msg/openjpeg/CltNQpbbwm4/jajpDKq0AAAJ), 
> all this has been made possible thanks to a funding from academic 
> institutions and archival organizations, namely:
>
> - Wellcome Library
>
> - Stanford University
>
> - Nationale Bibliotheek van Nederland (KBNL)
>
> - University of Michigan
>
> - University of California, Los Angeles (UCLA)
>
> And logistic support from the International Image Interoperability 
> Framework (IIIF), the Council on Library and Information Resources 
> (CLIR), intoPIX, and of course the Image and Signal Processing Group 
> (ISPGroup) from University of Louvain (UCL, Belgium) hosting the 
> OpenJPEG project. Thanks to all of them !
>
> Many thanks also to Even Rouault, the developper who actually 
> implemented these improvements, and of course to all contributors 
> having suggested fixes or enhancements.
>
> I hope you will find this new version useful, don’t hesitate to 
> provide feedback to improve it even further. By the way, more 
> improvements are yet to come in the coming months.
>
> Enjoy,
>
> Antonin
>
> -- 
>
> You are subscribed to the mailing-list of the OpenJPEG project 
> (www.openjpeg.org)
>
> To post: email to openjpeg at googlegroups.com
>
> To unsubscribe: email to openjpeg+unsubscribe at googlegroups.com
>
> For more options: visit http://groups.google.com/group/openjpeg
>
> OpenJPEG is mainly supported by :
>
> * UCL Image and Signal Processing Group 
> (http://sites.uclouvain.be/ispgroup)
>
> * IntoPIX (www.intopix.com)
>
> -----------------------------------------
>
> -- 
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170810/f0cdaaa6/attachment-0001.html>

From even.rouault at spatialys.com  Thu Aug 10 11:10:34 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 10 Aug 2017 20:10:34 +0200
Subject: [gdal-dev] Fwd: [OpenJPEG] OpenJPEG 2.2.0 is out ! Faster and
	safer.
In-Reply-To: <6704a02a-b9cc-07a6-2a48-76ba3a763c03@gmail.com>
References: <2005627.kjaARoHoed@even-i700>
 <6704a02a-b9cc-07a6-2a48-76ba3a763c03@gmail.com>
Message-ID: <8318882.RK0UVTVKhY@even-i700>

On jeudi 10 août 2017 20:04:09 CEST Sandro Mani wrote:
> Hi Even
> 
> abidiff tells me:
> 
> 
> * Incompatible ABI changes between openjpeg2-2.1.2-4.fc26.x86_64.rpm and
> openjpeg2-2.2.0-1.fc26.x86_64.rpm. ABI comparison took 0.45 second(s).
> Please review them.
> 
> ================ changes of 'libopenjp2.so.2.1.2'===============
>    Functions changes summary: 9 Removed, 5 Changed, 31 Added functions
>    Variables changes summary: 0 Removed, 0 Changed, 0 Added variable
> 
>    9 Removed functions:
> 
>      'function void opj_mqc_create()'    {opj_mqc_create}
>      'function OPJ_INT32 opj_mqc_decode()'    {opj_mqc_decode}
>      'function void opj_mqc_destroy()'    {opj_mqc_destroy}
>      'function OPJ_UINT32 opj_mqc_restart_enc()'    {opj_mqc_restart_enc}
>      'function void opj_raw_create()'    {opj_raw_create}
>      'function OPJ_UINT32 opj_raw_decode()'    {opj_raw_decode}
>      'function void opj_raw_destroy()'    {opj_raw_destroy}
>      'function void opj_raw_init_dec(OPJ_BYTE*, OPJ_UINT32)'   
> {opj_raw_init_dec} 'function OPJ_UINT32 opj_raw_numbytes()'   
> {opj_raw_numbytes}
> 
> Is the ABI really 100% compatible?

(Should be rather for the openjpeg mailing list)

The functions you mention are internal functions not exposed in the API of openjpeg.h and 
that should normally not be exported

http://www.openjpeg.org/abi-check/timeline/openjpeg/ finds 100% compatibility

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170810/de810c5f/attachment.html>

From manisandro at gmail.com  Thu Aug 10 12:14:41 2017
From: manisandro at gmail.com (Sandro Mani)
Date: Thu, 10 Aug 2017 21:14:41 +0200
Subject: [gdal-dev] Fwd: [OpenJPEG] OpenJPEG 2.2.0 is out ! Faster and
 safer.
In-Reply-To: <8318882.RK0UVTVKhY@even-i700>
References: <2005627.kjaARoHoed@even-i700>
 <6704a02a-b9cc-07a6-2a48-76ba3a763c03@gmail.com>
 <8318882.RK0UVTVKhY@even-i700>
Message-ID: <2cbb80ca-28fe-546f-89d0-227a8c786b5d@gmail.com>


On 10.08.2017 20:10, Even Rouault wrote:
>
> On jeudi 10 août 2017 20:04:09 CEST Sandro Mani wrote:
>
> > Hi Even
>
> >
>
> > abidiff tells me:
>
> >
>
> >
>
> > * Incompatible ABI changes between openjpeg2-2.1.2-4.fc26.x86_64.rpm and
>
> > openjpeg2-2.2.0-1.fc26.x86_64.rpm. ABI comparison took 0.45 second(s).
>
> > Please review them.
>
> >
>
> > ================ changes of 'libopenjp2.so.2.1.2'===============
>
> > Functions changes summary: 9 Removed, 5 Changed, 31 Added functions
>
> > Variables changes summary: 0 Removed, 0 Changed, 0 Added variable
>
> >
>
> > 9 Removed functions:
>
> >
>
> > 'function void opj_mqc_create()' {opj_mqc_create}
>
> > 'function OPJ_INT32 opj_mqc_decode()' {opj_mqc_decode}
>
> > 'function void opj_mqc_destroy()' {opj_mqc_destroy}
>
> > 'function OPJ_UINT32 opj_mqc_restart_enc()' {opj_mqc_restart_enc}
>
> > 'function void opj_raw_create()' {opj_raw_create}
>
> > 'function OPJ_UINT32 opj_raw_decode()' {opj_raw_decode}
>
> > 'function void opj_raw_destroy()' {opj_raw_destroy}
>
> > 'function void opj_raw_init_dec(OPJ_BYTE*, OPJ_UINT32)'
>
> > {opj_raw_init_dec} 'function OPJ_UINT32 opj_raw_numbytes()'
>
> > {opj_raw_numbytes}
>
> >
>
> > Is the ABI really 100% compatible?
>
> (Should be rather for the openjpeg mailing list)
>
Yeah sorry was too lazy to subscribe.
>
> The functions you mention are internal functions not exposed in the 
> API of openjpeg.h and that should normally not be exported
>
> http://www.openjpeg.org/abi-check/timeline/openjpeg/ finds 100% 
> compatibility
>
Okay thanks

Sandro
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170810/6ca2e377/attachment.html>

From nfarah at hotmail.com  Sun Aug 13 08:57:54 2017
From: nfarah at hotmail.com (N. Farah)
Date: Sun, 13 Aug 2017 15:57:54 +0000
Subject: [gdal-dev] Fwd: [OpenJPEG] OpenJPEG 2.2.0 is out ! Faster and safer.
Message-ID: <BN6PR11MB1873652B8BA21286FA3CC4DBDD8F0@BN6PR11MB1873.namprd11.prod.outlook.com>

Great news. Thanks for the work.


Any plans to integrate this new version in GDAL ?


Thanks

Noureddine Farah
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170813/af5fcbac/attachment.html>

From even.rouault at spatialys.com  Mon Aug 14 01:49:09 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 14 Aug 2017 10:49:09 +0200
Subject: [gdal-dev] Fwd: [OpenJPEG] OpenJPEG 2.2.0 is out ! Faster and
	safer.
In-Reply-To: <BN6PR11MB1873652B8BA21286FA3CC4DBDD8F0@BN6PR11MB1873.namprd11.prod.outlook.com>
References: <BN6PR11MB1873652B8BA21286FA3CC4DBDD8F0@BN6PR11MB1873.namprd11.prod.outlook.com>
Message-ID: <2036961.vp26HKGrJL@even-i700>

On dimanche 13 août 2017 15:57:54 CEST N. Farah wrote:
> Great news. Thanks for the work.
> 
> 
> Any plans to integrate this new version in GDAL ?

Well, there's nothing to change in the GDAL source code. The existing 
JP2OpenJPEG driver will work with OpenJPEG 2.2. It is just a matter of 
recompiling libopenjp2.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170814/0dd8a8d2/attachment.html>

From gane.prog at gmail.com  Mon Aug 14 03:06:16 2017
From: gane.prog at gmail.com (Gane R)
Date: Mon, 14 Aug 2017 15:36:16 +0530
Subject: [gdal-dev] PDF not oriented as expected
Message-ID: <CALMrLdCn-cx_+Jomeh20CPipcUC=A=UGJvLX0aWcA8C6+tooVA@mail.gmail.com>

I had a chance to work with prebuild gdal-2-1-3 bin, I tried to convert a
PDF to TIFF, with attached PDF, the PDF is not oriented to the north
rotation as expected on the TIFF.

I tried to work with source and found the angle dfRotation is reported as
zero. The resultant GeoTIFF output is not north oriented. Here is a link to
PDF

https://drive.google.com/file/d/0B4shTM1bPS5TX1F2Wk8wTWk5MnM/view?usp=sharing

Gane
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170814/b3ee1d6f/attachment.html>

From gane.prog at gmail.com  Mon Aug 14 02:47:08 2017
From: gane.prog at gmail.com (Gane R)
Date: Mon, 14 Aug 2017 15:17:08 +0530
Subject: [gdal-dev] GDAL Filegeodb using ESRI File Geodb
Message-ID: <CALMrLdDhAXDoobu6RYm+mcMFmpFOBkOKM0xmL8tdGfd+ffNG_Q@mail.gmail.com>

I came across this link
https://pro.arcgis.com/en/pro-app/help/data/geodatabases/overview/create-datasets-in-a-geodatabase.htm

in GDAL Filegeodb using ESRI File Geodb what dataset we support apart from
Feature Datasets, like tables, Mosiac, Rasters ?

Gane
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170814/64727aea/attachment.html>

From even.rouault at spatialys.com  Mon Aug 14 04:03:53 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 14 Aug 2017 13:03:53 +0200
Subject: [gdal-dev] GDAL Filegeodb using ESRI File Geodb
In-Reply-To: <CALMrLdDhAXDoobu6RYm+mcMFmpFOBkOKM0xmL8tdGfd+ffNG_Q@mail.gmail.com>
References: <CALMrLdDhAXDoobu6RYm+mcMFmpFOBkOKM0xmL8tdGfd+ffNG_Q@mail.gmail.com>
Message-ID: <2696476.Y4LyFy2cuV@even-i700>

On lundi 14 août 2017 15:17:08 CEST Gane R wrote:
> I came across this link
> https://pro.arcgis.com/en/pro-app/help/data/geodatabases/overview/create-dat
> asets-in-a-geodatabase.htm
> 
> in GDAL Filegeodb using ESRI File Geodb what dataset we support apart from
> Feature Datasets, like tables, Mosiac, Rasters ?

Feature Datasets and tables, yes. 
Mosaics and rasters, not at this point.

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170814/797dd117/attachment.html>

From schwehr at gmail.com  Mon Aug 14 09:44:36 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Mon, 14 Aug 2017 09:44:36 -0700
Subject: [gdal-dev] Call for discussion on RFC68: C++11 compilation mode
Message-ID: <CACmBxysbymV6N6p4updUoW3bmLaM80gqGY0AFj5-HRZbnoEHdw@mail.gmail.com>

Hi all,

This is a call for discussion on RFC68 to set C++11 to be the minimum C++
language version for GDAL trunk.  I've drafted the RFC based on work by
Mateusz.

  https://trac.osgeo.org/gdal/wiki/rfc68_cplusplus11

There was initial discussions back in January of this year:

  https://lists.osgeo.org/pipermail/gdal-dev/2017-January/thread.html#45786

Cheers,
-kurt
Engineer at Google
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170814/cf5888c3/attachment.html>

From even.rouault at spatialys.com  Mon Aug 14 10:02:15 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 14 Aug 2017 19:02:15 +0200
Subject: [gdal-dev] Call for discussion on RFC68: C++11 compilation mode
In-Reply-To: <CACmBxysbymV6N6p4updUoW3bmLaM80gqGY0AFj5-HRZbnoEHdw@mail.gmail.com>
References: <CACmBxysbymV6N6p4updUoW3bmLaM80gqGY0AFj5-HRZbnoEHdw@mail.gmail.com>
Message-ID: <22451425.pbmFVvQ3Z5@even-i700>

Hi Tamas,

Unless I'm mistaken your gisinternals.com builds don't include MSVC 2015 currently. Right ? 
Do you have any plans to do so ? Currently the GDAL AppVeyor target uses SDKSs from 
gisinternals to do builds with a number of third-party libraries.

Even

> 
> This is a call for discussion on RFC68 to set C++11 to be the minimum C++
> language version for GDAL trunk.  I've drafted the RFC based on work by
> Mateusz.
> 
>   https://trac.osgeo.org/gdal/wiki/rfc68_cplusplus11
> 
> There was initial discussions back in January of this year:
> 
>   https://lists.osgeo.org/pipermail/gdal-dev/2017-January/thread.html#45786
> 
> Cheers,
> -kurt
> Engineer at Google


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170814/5e22acf0/attachment-0001.html>

From nfarah at hotmail.com  Mon Aug 14 08:42:31 2017
From: nfarah at hotmail.com (N. Farah)
Date: Mon, 14 Aug 2017 15:42:31 +0000
Subject: [gdal-dev] Fwd: [OpenJPEG] OpenJPEG 2.2.0 is out ! Faster and
 safer.
In-Reply-To: <2036961.vp26HKGrJL@even-i700>
References: <BN6PR11MB1873652B8BA21286FA3CC4DBDD8F0@BN6PR11MB1873.namprd11.prod.outlook.com>,
 <2036961.vp26HKGrJL@even-i700>
Message-ID: <BN6PR11MB1873C1368E7ECEE41334B462DD8C0@BN6PR11MB1873.namprd11.prod.outlook.com>

Right...since GDAL does not ship the 3rd party lib(s).


Thanks again


________________________________
From: Even Rouault <even.rouault at spatialys.com>
Sent: Monday, August 14, 2017 4:49:09 AM
To: gdal-dev at lists.osgeo.org
Cc: N. Farah
Subject: Re: [gdal-dev] Fwd: [OpenJPEG] OpenJPEG 2.2.0 is out ! Faster and safer.


On dimanche 13 août 2017 15:57:54 CEST N. Farah wrote:

> Great news. Thanks for the work.

>

>

> Any plans to integrate this new version in GDAL ?



Well, there's nothing to change in the GDAL source code. The existing JP2OpenJPEG driver will work with OpenJPEG 2.2. It is just a matter of recompiling libopenjp2.



Even



--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170814/7e45db86/attachment.html>

From Manuel.Grizonnet at cnes.fr  Mon Aug 14 18:44:02 2017
From: Manuel.Grizonnet at cnes.fr (Grizonnet Manuel)
Date: Tue, 15 Aug 2017 01:44:02 +0000
Subject: [gdal-dev] Call for discussion on RFC68: C++11 compilation mode
In-Reply-To: <22451425.pbmFVvQ3Z5@even-i700>
References: <CACmBxysbymV6N6p4updUoW3bmLaM80gqGY0AFj5-HRZbnoEHdw@mail.gmail.com>,
 <22451425.pbmFVvQ3Z5@even-i700>
Message-ID: <2B6FEF867B8D2A4EADEE71405BC4B39A92187B59@TW-MBX-P03.cnesnet.ad.cnes.fr>

Hi all,

just want to share with you that we've got the same discussion recently in the orfeo toolbox project and we finally decide to move directly to c++14 in the next release (6.2). It is a more recent standard with for sure less new features than in c++11 but yet useful. Moreover it does not change a lot the minimum compiler version (gcc min version is 4.9 I think for c++14).

Will be glad to exchange also with you on strategies, pro/cons to then modernize the code.

You can find more information about the discussion about c++11 vs c++14 and few experiments which have been made with clang-tidy for OTB in the following RFComments and RFChanges:

https://wiki.orfeo-toolbox.org/index.php/Request_for_Comments-36:_Move_OTB_to_C%2B%2B14

https://wiki.orfeo-toolbox.org/index.php/Request_for_Changes-95:_Compile_OTB_with_C%2B%2B14_by_default

my 2 cents.

Regards,

--

Manuel GRIZONNET
CNES - DCT/SI/AP - BPI 1219
18, avenue Edouard Belin
31401 Toulouse Cedex 09 - France
Tel: +33 561 282 630 - Fax: +33 561 283 109
________________________________
De : gdal-dev [gdal-dev-bounces at lists.osgeo.org] de la part de Even Rouault [even.rouault at spatialys.com]
Envoyé : lundi 14 août 2017 19:02
À : Tamas Szekeres
Cc : gdal-dev at lists.osgeo.org
Objet : Re: [gdal-dev] Call for discussion on RFC68: C++11 compilation mode


Hi Tamas,



Unless I'm mistaken your gisinternals.com builds don't include MSVC 2015 currently. Right ? Do you have any plans to do so ? Currently the GDAL AppVeyor target uses SDKSs from gisinternals to do builds with a number of third-party libraries.



Even



>

> This is a call for discussion on RFC68 to set C++11 to be the minimum C++

> language version for GDAL trunk. I've drafted the RFC based on work by

> Mateusz.

>

> https://trac.osgeo.org/gdal/wiki/rfc68_cplusplus11

>

> There was initial discussions back in January of this year:

>

> https://lists.osgeo.org/pipermail/gdal-dev/2017-January/thread.html#45786

>

> Cheers,

> -kurt

> Engineer at Google





--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170815/43252f95/attachment.html>

From schut at satelligence.com  Tue Aug 15 01:37:53 2017
From: schut at satelligence.com (Vincent Schut)
Date: Tue, 15 Aug 2017 10:37:53 +0200
Subject: [gdal-dev] Fwd: [OpenJPEG] OpenJPEG 2.2.0 is out ! Faster and
 safer.
In-Reply-To: <2036961.vp26HKGrJL@even-i700>
References: <BN6PR11MB1873652B8BA21286FA3CC4DBDD8F0@BN6PR11MB1873.namprd11.prod.outlook.com>
 <2036961.vp26HKGrJL@even-i700>
Message-ID: <5d0b247c-09f9-bcc1-7521-bf7d45b57dd0@satelligence.com>


On 08/14/2017 10:49 AM, Even Rouault wrote:
>
> On dimanche 13 août 2017 15:57:54 CEST N. Farah wrote:
>
> > Great news. Thanks for the work.
>
> >
>
> >
>
> > Any plans to integrate this new version in GDAL ?
>
> Well, there's nothing to change in the GDAL source code. The existing 
> JP2OpenJPEG driver will work with OpenJPEG 2.2. It is just a matter of 
> recompiling libopenjp2.
>
> Even
>

Well, there might be some small change necessary. Apparently the 
configure script only checks path/include/openjpeg-2.0 and 
path/include/openjpeg-2.1 subdirectories for openjpeg.h, while my 
openjpeg is now in path/include/openjpeg-2.2 :

configure: error: openjpeg.h not found in /usr/include/openjpeg-2.0 or 
/usr/include/openjpeg-2.1

Vincent.

> -- 
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170815/eac0b714/attachment-0001.html>

From schwehr at gmail.com  Tue Aug 15 09:59:05 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Tue, 15 Aug 2017 09:59:05 -0700
Subject: [gdal-dev] Call for discussion on RFC68: C++11 compilation mode
In-Reply-To: <2B6FEF867B8D2A4EADEE71405BC4B39A92187B59@TW-MBX-P03.cnesnet.ad.cnes.fr>
References: <CACmBxysbymV6N6p4updUoW3bmLaM80gqGY0AFj5-HRZbnoEHdw@mail.gmail.com>
 <22451425.pbmFVvQ3Z5@even-i700>
 <2B6FEF867B8D2A4EADEE71405BC4B39A92187B59@TW-MBX-P03.cnesnet.ad.cnes.fr>
Message-ID: <CACmBxyvPV53Up8MUbGeM2Yu-dqJojv4nwOTN8RWpxNuEaf=o-g@mail.gmail.com>

Hi Manuel,

Thanks for your thoughts!  I added a link to the OTB RFC.

https://trac.osgeo.org/gdal/wiki/rfc68_cplusplus11?action=diff&version=10&old_version=9

-kurt

On Mon, Aug 14, 2017 at 6:44 PM, Grizonnet Manuel <Manuel.Grizonnet at cnes.fr>
wrote:

> Hi all,
>
> just want to share with you that we've got the same discussion recently in
> the orfeo toolbox project and we finally decide to move directly to c++14
> in the next release (6.2). It is a more recent standard with for sure less
> new features than in c++11 but yet useful. Moreover it does not change a
> lot the minimum compiler version (gcc min version is 4.9 I think for c++14).
>
> Will be glad to exchange also with you on strategies, pro/cons to then
> modernize the code.
>
> You can find more information about the discussion about c++11 vs c++14
> and few experiments which have been made with clang-tidy for OTB in the
> following RFComments and RFChanges:
>
> https://wiki.orfeo-toolbox.org/index.php/Request_for_
> Comments-36:_Move_OTB_to_C%2B%2B14
>
> https://wiki.orfeo-toolbox.org/index.php/Request_for_
> Changes-95:_Compile_OTB_with_C%2B%2B14_by_default
>
> my 2 cents.
>
> Regards,
>
> --
>
> Manuel GRIZONNET
> CNES - DCT/SI/AP - BPI 1219
> 18, avenue Edouard Belin
> 31401 Toulouse Cedex 09 - France
> Tel: +33 561 282 630 - Fax: +33 561 283 109
> ------------------------------
> *De :* gdal-dev [gdal-dev-bounces at lists.osgeo.org] de la part de Even
> Rouault [even.rouault at spatialys.com]
> *Envoyé :* lundi 14 août 2017 19:02
> *À :* Tamas Szekeres
> *Cc :* gdal-dev at lists.osgeo.org
> *Objet :* Re: [gdal-dev] Call for discussion on RFC68: C++11 compilation
> mode
>
> Hi Tamas,
>
>
>
> Unless I'm mistaken your gisinternals.com builds don't include MSVC 2015
> currently. Right ? Do you have any plans to do so ? Currently the GDAL
> AppVeyor target uses SDKSs from gisinternals to do builds with a number of
> third-party libraries.
>
>
>
> Even
>
>
>
> >
>
> > This is a call for discussion on RFC68 to set C++11 to be the minimum C++
>
> > language version for GDAL trunk. I've drafted the RFC based on work by
>
> > Mateusz.
>
> >
>
> > https://trac.osgeo.org/gdal/wiki/rfc68_cplusplus11
>
> >
>
> > There was initial discussions back in January of this year:
>
> >
>
> > https://lists.osgeo.org/pipermail/gdal-dev/2017-
> January/thread.html#45786
>
> >
>
> > Cheers,
>
> > -kurt
>
> > Engineer at Google
>
>
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170815/067d0cfb/attachment.html>

From even.rouault at spatialys.com  Tue Aug 15 11:55:50 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 15 Aug 2017 20:55:50 +0200
Subject: [gdal-dev] Fwd: [OpenJPEG] OpenJPEG 2.2.0 is out ! Faster and
	safer.
In-Reply-To: <5d0b247c-09f9-bcc1-7521-bf7d45b57dd0@satelligence.com>
References: <BN6PR11MB1873652B8BA21286FA3CC4DBDD8F0@BN6PR11MB1873.namprd11.prod.outlook.com>
 <2036961.vp26HKGrJL@even-i700>
 <5d0b247c-09f9-bcc1-7521-bf7d45b57dd0@satelligence.com>
Message-ID: <3946438.ofcb0byxVt@even-i700>

Vincent,

> Well, there might be some small change necessary. Apparently the
> configure script only checks path/include/openjpeg-2.0 and
> path/include/openjpeg-2.1 subdirectories for openjpeg.h, while my
> openjpeg is now in path/include/openjpeg-2.2 :
> 
> configure: error: openjpeg.h not found in /usr/include/openjpeg-2.0 or
> /usr/include/openjpeg-2.1

Indeed. I actually only tested without rebuilding GDAL and just linking to the new lib... 
I just added support for it in GDAL trunk and branches/2.2 branch per
https://trac.osgeo.org/gdal/ticket/7002

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170815/6ea412c5/attachment.html>

From even.rouault at spatialys.com  Wed Aug 16 05:36:24 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 16 Aug 2017 14:36:24 +0200
Subject: [gdal-dev] Call for discussion on RFC68: C++11 compilation mode
In-Reply-To: <CACmBxysbymV6N6p4updUoW3bmLaM80gqGY0AFj5-HRZbnoEHdw@mail.gmail.com>
References: <CACmBxysbymV6N6p4updUoW3bmLaM80gqGY0AFj5-HRZbnoEHdw@mail.gmail.com>
Message-ID: <2087023.EQbI0zqB1u@even-i700>

On lundi 14 août 2017 09:44:36 CEST Kurt Schwehr wrote:
> Hi all,
> 
> This is a call for discussion on RFC68 to set C++11 to be the minimum C++
> language version for GDAL trunk.  I've drafted the RFC based on work by
> Mateusz.
> 
>   https://trac.osgeo.org/gdal/wiki/rfc68_cplusplus11
> 
> There was initial discussions back in January of this year:
> 
>   https://lists.osgeo.org/pipermail/gdal-dev/2017-January/thread.html#45786
> 

Kurt,

There's one aspect that doesn't appear clearly to me in the RFC text, which is requirements 
for user C++ code using the GDAL C++ API. I presume that external code will also have to be 
compiled in C++11 mode too (because of nullptr or override keywords appearing in headers 
like gcore/gdal_priv.h for example). Would probably be worth making that explicit (perhaps 
in "Backward compatibility" paragraph)

Editorial remarks:
* the reference to "Move OTB to C++14" is after "There are a few related past RFCs that have 
never been adopted but strongly relate to RFC 68", but OTB C++14 has been adopted as far 
as I can see
* the reference to CMake in "If accepted, currently available build configurations (Autotools, 
CMake, NMake)" doesn't apply for GDAL. Regarding nmake impacts, there won't be much, 
apart perhaps removing references to MSVC versions older than the new minimum one that 
will be supported.

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170816/9414195a/attachment.html>

From schwehr at gmail.com  Wed Aug 16 07:37:44 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Wed, 16 Aug 2017 07:37:44 -0700
Subject: [gdal-dev] Call for discussion on RFC68: C++11 compilation mode
In-Reply-To: <2087023.EQbI0zqB1u@even-i700>
References: <CACmBxysbymV6N6p4updUoW3bmLaM80gqGY0AFj5-HRZbnoEHdw@mail.gmail.com>
 <2087023.EQbI0zqB1u@even-i700>
Message-ID: <CACmBxyuXuKUozrNf50vDJUXS4DZ5DCsxHpgL50tJOWiVHOLtFA@mail.gmail.com>

Thanks for the feedback!   I will fix those things today

On Aug 16, 2017 5:36 AM, "Even Rouault" <even.rouault at spatialys.com> wrote:

> On lundi 14 août 2017 09:44:36 CEST Kurt Schwehr wrote:
>
> > Hi all,
>
> >
>
> > This is a call for discussion on RFC68 to set C++11 to be the minimum C++
>
> > language version for GDAL trunk. I've drafted the RFC based on work by
>
> > Mateusz.
>
> >
>
> > https://trac.osgeo.org/gdal/wiki/rfc68_cplusplus11
>
> >
>
> > There was initial discussions back in January of this year:
>
> >
>
> > https://lists.osgeo.org/pipermail/gdal-dev/2017-
> January/thread.html#45786
>
> >
>
>
>
> Kurt,
>
>
>
> There's one aspect that doesn't appear clearly to me in the RFC text,
> which is requirements for user C++ code using the GDAL C++ API. I presume
> that external code will also have to be compiled in C++11 mode too (because
> of nullptr or override keywords appearing in headers like gcore/gdal_priv.h
> for example). Would probably be worth making that explicit (perhaps in
> "Backward compatibility" paragraph)
>
>
>
> Editorial remarks:
>
> * the reference to "Move OTB to C++14" is after "There are a few related
> past RFCs that have never been adopted but strongly relate to RFC 68", but
> OTB C++14 has been adopted as far as I can see
>
> * the reference to CMake in "If accepted, currently available build
> configurations (Autotools, CMake, NMake)" doesn't apply for GDAL. Regarding
> nmake impacts, there won't be much, apart perhaps removing references to
> MSVC versions older than the new minimum one that will be supported.
>
>
>
> Even
>
>
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170816/9c75e72d/attachment-0001.html>

From schwehr at gmail.com  Wed Aug 16 07:41:43 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Wed, 16 Aug 2017 07:41:43 -0700
Subject: [gdal-dev] Kakadu 7.10 (7_A)
In-Reply-To: <CACmBxytaPDbHgJ7_uiyTQjkLhrAjhCOodBu-gnQQ3_sRt7=nVA@mail.gmail.com>
References: <CACmBxysqiefhE_yxqOsv7489FYfXQ_9mB6y-YQ_AG2jiNh2QKg@mail.gmail.com>
 <CACmBxyuTyvFM21N5BzS99ASnN=N5G90W5-YqmpfXRXcL3hnjNg@mail.gmail.com>
 <CACmBxyuRC0NXTccLrns3XYqVG4YodtbD8xztCiVyBEhnVBmqyQ@mail.gmail.com>
 <CACmBxytaPDbHgJ7_uiyTQjkLhrAjhCOodBu-gnQQ3_sRt7=nVA@mail.gmail.com>
Message-ID: <CACmBxytWB_L1YGjqgfnBb+jhayWq4CTMe=HZEQr-2KFVuW41wA@mail.gmail.com>

Hi all,

Kakadu 7.10 just came out. It's a major rework of memory management to
allow callers to constrain how much memory is used. My initial testing
gives me a couple crashes.  I was able to trigger a few of the asserts
pretty quickly.  I will be investigating over the next week or two and will
share what I can.

-kurt
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170816/8ad42784/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Fri Aug 18 03:59:47 2017
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Fri, 18 Aug 2017 10:59:47 +0000
Subject: [gdal-dev] Autodetect "0012" as string in CSV
Message-ID: <1503053978189.95632@maanmittauslaitos.fi>

Hi,

The schema of a CSV file like this
"00012",012345,1234,234.65,"text"
is autodetected this way:

ogrinfo csvtext.csv -oo autodetect_type=yes -al
INFO: Open of `csvtext.csv'
      using driver `CSV' successful.

Layer name: csvtext
Geometry: None
Feature Count: 1
Layer SRS WKT:
(unknown)
field_1: Integer (0.0)
field_2: Integer (0.0)
field_3: Integer (0.0)
field_4: Real (0.0)
field_5: String (0.0)
OGRFeature(csvtext):1
  field_1 (Integer) = 12
  field_2 (Integer) = 12345
  field_3 (Integer) = 1234
  field_4 (Real) = 234.65
  field_5 (String) = text

It would be good to autodetect also "00012" as a string. Double quotes are correctly stripped of from "text" so I suppose that GDAL already knows that they are used for enclosing strings.

See https://gis.stackexchange.com/questions/252482/keeping-leading-zeroes-in-qgis-in-big-files

-Jukka Rahkonen-

From even.rouault at spatialys.com  Fri Aug 18 04:30:11 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 18 Aug 2017 13:30:11 +0200
Subject: [gdal-dev] Autodetect "0012" as string in CSV
In-Reply-To: <1503053978189.95632@maanmittauslaitos.fi>
References: <1503053978189.95632@maanmittauslaitos.fi>
Message-ID: <1728672.o3cCdeOVvA@even-i700>

On vendredi 18 août 2017 10:59:47 CEST Rahkonen Jukka (MML) wrote:
> Hi,
> 
> The schema of a CSV file like this
> "00012",012345,1234,234.65,"text"
> is autodetected this way:
> 
> ogrinfo csvtext.csv -oo autodetect_type=yes -al
> INFO: Open of `csvtext.csv'
>       using driver `CSV' successful.
> 
> Layer name: csvtext
> Geometry: None
> Feature Count: 1
> Layer SRS WKT:
> (unknown)
> field_1: Integer (0.0)
> field_2: Integer (0.0)
> field_3: Integer (0.0)
> field_4: Real (0.0)
> field_5: String (0.0)
> OGRFeature(csvtext):1
>   field_1 (Integer) = 12
>   field_2 (Integer) = 12345
>   field_3 (Integer) = 1234
>   field_4 (Real) = 234.65
>   field_5 (String) = text
> 
> It would be good to autodetect also "00012" as a string. Double quotes are
> correctly stripped of from "text" so I suppose that GDAL already knows that
> they are used for enclosing strings.

Jukka,

Add -oo QUOTED_FIELDS_AS_STRING=YES

I don't remember the rationale for the default of this option to be NO. Presumably the use 
case while developping that was with a file generated by a CSV exporter always surrounding 
field content by double quotes.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170818/057cde52/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Fri Aug 18 04:53:17 2017
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Fri, 18 Aug 2017 11:53:17 +0000
Subject: [gdal-dev] Autodetect "0012" as string in CSV
In-Reply-To: <1728672.o3cCdeOVvA@even-i700>
References: <1503053978189.95632@maanmittauslaitos.fi>,
 <1728672.o3cCdeOVvA@even-i700>
Message-ID: <1503057197701.6236@maanmittauslaitos.fi>

Hi Even,


Yeah, should have been reading the documents more closely. This keeps the leading zeroes.


ogrinfo csvtext.csv -oo autodetect_type=yes -oo quoted_fields_as_string=yes -al
INFO: Open of `csvtext.csv'
      using driver `CSV' successful.

Layer name: csvtext
Geometry: None
Feature Count: 1
Layer SRS WKT:
(unknown)
field_1: String (0.0)
field_2: Integer (0.0)
field_3: Integer (0.0)
field_4: Real (0.0)
field_5: String (0.0)
OGRFeature(csvtext):1
  field_1 (String) = 00012
  field_2 (Integer) = 12345
  field_3 (Integer) = 1234
  field_4 (Real) = 234.65
  field_5 (String) = text


-Jukka-


________________________________
Lähettäjä: Even Rouault <even.rouault at spatialys.com>
Lähetetty: 18. elokuuta 2017 14:30
Vastaanottaja: gdal-dev at lists.osgeo.org
Kopio: Rahkonen Jukka (MML)
Aihe: Re: [gdal-dev] Autodetect "0012" as string in CSV


On vendredi 18 août 2017 10:59:47 CEST Rahkonen Jukka (MML) wrote:

> Hi,

>

> The schema of a CSV file like this

> "00012",012345,1234,234.65,"text"

> is autodetected this way:

>

> ogrinfo csvtext.csv -oo autodetect_type=yes -al

> INFO: Open of `csvtext.csv'

> using driver `CSV' successful.

>

> Layer name: csvtext

> Geometry: None

> Feature Count: 1

> Layer SRS WKT:

> (unknown)

> field_1: Integer (0.0)

> field_2: Integer (0.0)

> field_3: Integer (0.0)

> field_4: Real (0.0)

> field_5: String (0.0)

> OGRFeature(csvtext):1

> field_1 (Integer) = 12

> field_2 (Integer) = 12345

> field_3 (Integer) = 1234

> field_4 (Real) = 234.65

> field_5 (String) = text

>

> It would be good to autodetect also "00012" as a string. Double quotes are

> correctly stripped of from "text" so I suppose that GDAL already knows that

> they are used for enclosing strings.



Jukka,



Add -oo QUOTED_FIELDS_AS_STRING=YES



I don't remember the rationale for the default of this option to be NO. Presumably the use case while developping that was with a file generated by a CSV exporter always surrounding field content by double quotes.



Even



--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170818/5a929afd/attachment.html>

From rbarnes at umn.edu  Sat Aug 19 06:39:57 2017
From: rbarnes at umn.edu (Richard Barnes)
Date: Sat, 19 Aug 2017 09:39:57 -0400
Subject: [gdal-dev] ArcGIS Raster Geodatabase
Message-ID: <a8c22a6e-88cc-7111-4bab-61585ebaee0d@umn.edu>

I'd like to be able to read ArcGIS Raster Geodatabases from within GDAL.

Based on some previous work by Even Roualt and James Ramm, I have a
working program to extract data and projections into GeoTIFFs available
here <https://github.com/r-barnes/ArcRasterRescue>.

There are still a few things to figure out, but this is functional
enough that it may be useful to people and, since I don't have access to
a large set of geodatabases, it's difficult to for me to get ahold of
the exotic examples which would help flesh it out. There are also some
things we may never know about the format because they are not used in
the wild, so perhaps everything is already working! For this reason, I
think it would be useful to build this into GDAL, and I'm willing to
give it a shot.

However, I'm not entirely sure how to proceed.

Since there are commonalities with the OGR OpenFileGDB plug-in, I could
copy that code wholesale and make the necessary modifications, though
this seems wasteful.

I could also modify the existing code, but then the plugin would be for
both GDAL and OGR, which seems to break the separation between the two
that I see in the source.

If you have thoughts about what is best, drop me a line off-channel and
we'll see if we can figure something out.

Best regards,
Richard
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170819/8e023661/attachment.html>

From even.rouault at spatialys.com  Sat Aug 19 07:09:18 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 19 Aug 2017 16:09:18 +0200
Subject: [gdal-dev] ArcGIS Raster Geodatabase
In-Reply-To: <a8c22a6e-88cc-7111-4bab-61585ebaee0d@umn.edu>
References: <a8c22a6e-88cc-7111-4bab-61585ebaee0d@umn.edu>
Message-ID: <17687144.ckMAxzB1VR@even-i700>

Hi Richard,

> I'd like to be able to read ArcGIS Raster Geodatabases from within GDAL.
> 
> Based on some previous work by Even Roualt and James Ramm, I have a
> working program to extract data and projections into GeoTIFFs available
> here <https://github.com/r-barnes/ArcRasterRescue>.

That's great !

> 
> There are still a few things to figure out, but this is functional
> enough that it may be useful to people and, since I don't have access to
> a large set of geodatabases, it's difficult to for me to get ahold of
> the exotic examples which would help flesh it out. There are also some
> things we may never know about the format because they are not used in
> the wild, so perhaps everything is already working! For this reason, I
> think it would be useful to build this into GDAL, and I'm willing to
> give it a shot.

Even if it doesn't cover all cases, we can start with what you've already figured out and add/
fix things later.

> 
> However, I'm not entirely sure how to proceed.
> 
> Since there are commonalities with the OGR OpenFileGDB plug-in, I could
> copy that code wholesale and make the necessary modifications, though
> this seems wasteful.
> 
> I could also modify the existing code, but then the plugin would be for
> both GDAL and OGR, which seems to break the separation between the two
> that I see in the source.

This separation is historic, and we now have drivers that have both raster and vector 
capabilities, e.g. the GeoPackage one

So I think the raster side of the driver could/should be added within the existing driver. You 
would benefit from the low-level lib implemented in filegdbtable.cpp (would probably need 
some tweaking to deal with the raster tables), instead of redevelopping it as you seemed to 
have done in your prototype. I can imagine raster tables would be exposed as GDAL 
subdatasets and you would open them with "OPENFILEGDB:my.gdb:rastername"

> 
> If you have thoughts about what is best, drop me a line off-channel and
> we'll see if we can figure something out.

We can also perhaps create a dedicated Trac ticket for further discussions on this so 
interested parties can follow.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170819/8844c23b/attachment.html>

From rbarnes at umn.edu  Sat Aug 19 07:24:54 2017
From: rbarnes at umn.edu (Richard Barnes)
Date: Sat, 19 Aug 2017 10:24:54 -0400
Subject: [gdal-dev] ArcGIS Raster Geodatabase
In-Reply-To: <17687144.ckMAxzB1VR@even-i700>
References: <a8c22a6e-88cc-7111-4bab-61585ebaee0d@umn.edu>
 <17687144.ckMAxzB1VR@even-i700>
Message-ID: <d164a8c2-6e3c-3d3f-506e-52c5f5fa34be@umn.edu>

Thanks, Even,
I've opened a Trac ticket here which contains the conversation so far:
https://trac.osgeo.org/gdal/ticket/7008

-R

From even.rouault at spatialys.com  Sat Aug 19 13:49:19 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 19 Aug 2017 22:49:19 +0200
Subject: [gdal-dev] Call for discussion on RFC 70: Guessing output format
	from output file name extension
Message-ID: <1682531.OuxYCctptX@even-i700>

Hi,

This is a call for discussion on:
https://trac.osgeo.org/gdal/wiki/rfc70_output_format_guess

Summary:
This proposal is to add syntaxic sugar to make GDAL and OGR command line 
utilities, so they take into account the extension of the output filename to 
guess which output driver to use, when it is not explicitly specified. 

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170819/bb0ce388/attachment.html>

From philippe.ghesquiere at airbus.com  Mon Aug 21 03:33:45 2017
From: philippe.ghesquiere at airbus.com (Bugbuster)
Date: Mon, 21 Aug 2017 03:33:45 -0700 (MST)
Subject: [gdal-dev] Kakadu 7.10 (7_A)
In-Reply-To: <CACmBxytWB_L1YGjqgfnBb+jhayWq4CTMe=HZEQr-2KFVuW41wA@mail.gmail.com>
References: <CACmBxytWB_L1YGjqgfnBb+jhayWq4CTMe=HZEQr-2KFVuW41wA@mail.gmail.com>
Message-ID: <1503311625408-5331980.post@n6.nabble.com>

Hi Kurt,

We have been using Kakadu thanks to GDAL plugin for quite a while. A few
weeks ago, I tried to upgrade to Kakadu V7.9.1 (from V7.7.7).
Our development environment is :
* Windows 8 64 bits,
* Visual Studio 2015
* GDAL V2.2.1

I bumped into a segmentation fault when converting a TIFF image to JP2K
(gdal_translate). This error happens in JP2KAKDataset::~JP2KAKDataset(), on
line :
delete poInput. It does not occur with Kakadu V7.7.7.

I opened a discussion with Kakadu support
(https://groups.yahoo.com/neo/groups/kakadu_jpeg2000/conversations/topics/7369).
I tried the different hints David Taubman gave me, without success.

Did you get the same error while testing V7.10 version ?

Philippe



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Kakadu-7-10-7-A-tp5331632p5331980.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Mon Aug 21 04:01:01 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 21 Aug 2017 13:01:01 +0200
Subject: [gdal-dev] Kakadu 7.10 (7_A)
In-Reply-To: <1503311625408-5331980.post@n6.nabble.com>
References: <CACmBxytWB_L1YGjqgfnBb+jhayWq4CTMe=HZEQr-2KFVuW41wA@mail.gmail.com>
 <1503311625408-5331980.post@n6.nabble.com>
Message-ID: <14457941.xNCPagMSXV@even-i700>

Philippe,

> 
> We have been using Kakadu thanks to GDAL plugin for quite a while. A few
> weeks ago, I tried to upgrade to Kakadu V7.9.1 (from V7.7.7).
> Our development environment is :
> * Windows 8 64 bits,
> * Visual Studio 2015
> * GDAL V2.2.1
> 
> I bumped into a segmentation fault when converting a TIFF image to JP2K
> (gdal_translate). This error happens in JP2KAKDataset::~JP2KAKDataset(), on
> line :
> delete poInput. It does not occur with Kakadu V7.7.7.

Looking quickly to your message and the code, poInput is assigned from jp2_src = new 
jp2_source; and the deletion is delete poInput, so the GDAL heap is used for both 
construction and destruction, which is a good thing. So potential cross-heap issues are not 
linked to that object. But if you really use the same compiler and compiler settings to build 
GDAL and Kakadu, you shouldn't run into cross-heap issues.

> 
> I opened a discussion with Kakadu support
> (https://groups.yahoo.com/neo/groups/kakadu_jpeg2000/conversations/topics/73
> 69). I tried the different hints David Taubman gave me, without success.

You mentionned you tried with a debug build of GDAL. Are you aware that DEBUG=1 passed 
to nmake.opt still uses the /MD flag instead of /MDd which is probably more expected ? (this 
is a known issue / debate. See
https://trac.osgeo.org/gdal/ticket/6384). So in case Kakadu uses /MDd for debug builds, you 
definitely have an issue here and should modify nmake.opt line 135 to use /MDd.

Are you aware of http://www.drmemory.org/ ? It is a kind of Valgrind for Windows and can 
perhaps help narrowing the issue. I think it used to work only for 32 bit processes, but 
according to http://drmemory.org/docs/page_prep.html , it should work with 64bit processes 
with the following limitation
"Currently, Dr. Memory does not yet support uninitialized read detection for 64-bit 
applications, so we recommend compiling your target application as 32-bit."


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170821/004978f6/attachment.html>

From philippe.ghesquiere at airbus.com  Mon Aug 21 04:50:29 2017
From: philippe.ghesquiere at airbus.com (Bugbuster)
Date: Mon, 21 Aug 2017 04:50:29 -0700 (MST)
Subject: [gdal-dev] Kakadu 7.10 (7_A)
In-Reply-To: <14457941.xNCPagMSXV@even-i700>
References: <CACmBxytWB_L1YGjqgfnBb+jhayWq4CTMe=HZEQr-2KFVuW41wA@mail.gmail.com>
 <1503311625408-5331980.post@n6.nabble.com> <14457941.xNCPagMSXV@even-i700>
Message-ID: <1503316229413-5331989.post@n6.nabble.com>

Dear Even,

thanks for your valuable hints.
I do agree that the creation/deletion errors of the poInput object should
not be part of GDAL source code. This is the reason why I did not open a
GDAL ticket, but asked David Taubman for help.

I may try to rebuild the whole application in debug mode with /MDd flag to
make sure everything is consistent for the compiler.

And again thanks for the link to "Dr. Memory" : I will ask for consultations
:-)

Sincerly
Philippe



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Kakadu-7-10-7-A-tp5331632p5331989.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From schwehr at gmail.com  Mon Aug 21 08:40:34 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Mon, 21 Aug 2017 08:40:34 -0700
Subject: [gdal-dev] Kakadu 7.10 (7_A)
In-Reply-To: <CACmBxytWB_L1YGjqgfnBb+jhayWq4CTMe=HZEQr-2KFVuW41wA@mail.gmail.com>
References: <CACmBxysqiefhE_yxqOsv7489FYfXQ_9mB6y-YQ_AG2jiNh2QKg@mail.gmail.com>
 <CACmBxyuTyvFM21N5BzS99ASnN=N5G90W5-YqmpfXRXcL3hnjNg@mail.gmail.com>
 <CACmBxyuRC0NXTccLrns3XYqVG4YodtbD8xztCiVyBEhnVBmqyQ@mail.gmail.com>
 <CACmBxytaPDbHgJ7_uiyTQjkLhrAjhCOodBu-gnQQ3_sRt7=nVA@mail.gmail.com>
 <CACmBxytWB_L1YGjqgfnBb+jhayWq4CTMe=HZEQr-2KFVuW41wA@mail.gmail.com>
Message-ID: <CACmBxyuWrvYHtmL8yOjc_BVTEGRxsWFWeAD2Gh9i0AdBUwiWOQ@mail.gmail.com>

And (as of yesterday) there is new a 7.10.1 (v7_A_1) that has integer math
overflow detection.

On Wed, Aug 16, 2017 at 7:41 AM, Kurt Schwehr <schwehr at gmail.com> wrote:

> Hi all,
>
> Kakadu 7.10 just came out. It's a major rework of memory management to
> allow callers to constrain how much memory is used. My initial testing
> gives me a couple crashes.  I was able to trigger a few of the asserts
> pretty quickly.  I will be investigating over the next week or two and will
> share what I can.
>
> -kurt
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170821/15041172/attachment.html>

From sean at mapbox.com  Mon Aug 21 13:30:15 2017
From: sean at mapbox.com (Sean Gillies)
Date: Mon, 21 Aug 2017 14:30:15 -0600
Subject: [gdal-dev] Call for discussion on RFC 70: Guessing output
 format from output file name extension
In-Reply-To: <1682531.OuxYCctptX@even-i700>
References: <1682531.OuxYCctptX@even-i700>
Message-ID: <CADPhZXxrub+DY362jWsUg=8DQPnG_pRBbWcJjzt9U-fTc5AE7g@mail.gmail.com>

Hi Even,

This seems reasonable to me.

What will be done about the GeoJSON driver case, where we have one driver
covering both GeoJSON and EsriJSON (and other JSONs)? If a user specifies
foo.json which of the GeoJSON driver modes do they activate?


On Sat, Aug 19, 2017 at 2:49 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
>
>
> This is a call for discussion on:
>
> https://trac.osgeo.org/gdal/wiki/rfc70_output_format_guess
>
>
>
> Summary:
>
> This proposal is to add syntaxic sugar to make GDAL and OGR command line
> utilities, so they take into account the extension of the output filename
> to guess which output driver to use, when it is not explicitly specified.
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170821/376c9201/attachment.html>

From even.rouault at spatialys.com  Mon Aug 21 13:36:02 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 21 Aug 2017 22:36:02 +0200
Subject: [gdal-dev] Call for discussion on RFC 70: Guessing output
	format from output file name extension
In-Reply-To: <CADPhZXxrub+DY362jWsUg=8DQPnG_pRBbWcJjzt9U-fTc5AE7g@mail.gmail.com>
References: <1682531.OuxYCctptX@even-i700>
 <CADPhZXxrub+DY362jWsUg=8DQPnG_pRBbWcJjzt9U-fTc5AE7g@mail.gmail.com>
Message-ID: <1544901.v0EZsLcyvI@even-i700>

On lundi 21 août 2017 14:30:15 CEST Sean Gillies wrote:
> Hi Even,
> 
> This seems reasonable to me.
> 
> What will be done about the GeoJSON driver case, where we have one driver
> covering both GeoJSON and EsriJSON (and other JSONs)? If a user specifies
> foo.json which of the GeoJSON driver modes do they activate?

Hi Sean,

Exactly like when you specify -f GeoJSON, ie "true" GeoJSON (there's only write support for 
GeoJSON in the driver. EsriJSON and TopJSON are read-only currently). If you need explicit 
RFC7946 compliance, you'll still need to add -lco RFC7946=YES

Even

> 
> 
> On Sat, Aug 19, 2017 at 2:49 PM, Even Rouault <even.rouault at spatialys.com>
> 
> wrote:
> > Hi,
> > 
> > 
> > 
> > This is a call for discussion on:
> > 
> > https://trac.osgeo.org/gdal/wiki/rfc70_output_format_guess
> > 
> > 
> > 
> > Summary:
> > 
> > This proposal is to add syntaxic sugar to make GDAL and OGR command line
> > utilities, so they take into account the extension of the output filename
> > to guess which output driver to use, when it is not explicitly specified.
> > 
> > 
> > 
> > Even
> > 
> > 
> > 
> > --
> > 
> > Spatialys - Geospatial professional services
> > 
> > http://www.spatialys.com
> > 
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > https://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170821/9ba1b198/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Tue Aug 22 02:42:40 2017
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Tue, 22 Aug 2017 09:42:40 +0000
Subject: [gdal-dev] How to drop a raster layer from GeoPackage?
Message-ID: <90430cea7f7f4d028f631c34a7e3d783@C119S212VM042.msvyvi.vaha.local>

Hi,

There is an interesting question in gis.stackexchange about how to remove a raster layer from GeoPackage https://gis.stackexchange.com/questions/252782/remove-a-raster-from-geopackage.

I had a try and gdalmanage did not have any effect on the GeoPackage database but the workflow with ogrinfo works for me. Are there any other alternatives?

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170822/a5831c40/attachment.html>

From even.rouault at spatialys.com  Tue Aug 22 02:49:43 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 22 Aug 2017 11:49:43 +0200
Subject: [gdal-dev] How to drop a raster layer from GeoPackage?
In-Reply-To: <90430cea7f7f4d028f631c34a7e3d783@C119S212VM042.msvyvi.vaha.local>
References: <90430cea7f7f4d028f631c34a7e3d783@C119S212VM042.msvyvi.vaha.local>
Message-ID: <2538242.bZx7V7ZPmO@even-i700>

On mardi 22 août 2017 09:42:40 CEST Rahkonen Jukka (MML) wrote:
> Hi,
> 
> There is an interesting question in gis.stackexchange about how to remove a
> raster layer from GeoPackage
> https://gis.stackexchange.com/questions/252782/remove-a-raster-from-geopack
> age.
> 
> I had a try and gdalmanage did not have any effect on the GeoPackage
> database but the workflow with ogrinfo works for me. Are there any other
> alternatives?

The manual ogrinfo way is the only one using GDAL utilities.

We should probably extend the -sql "DELLAYER:xxxx" syntax to work with raster tables as 
well. Actually I see we currently also catch "DROP TABLE xxxx" to drop the table and remove 
links in other tables in the vector case (so with th same effect as DELLAYER:xxxxx). Would 
you mind creating an enhancement ticket about that ?

There's ongoing work on the QGIS side (dev version only I guess) to offer in the DBManager a 
way to delete raster layers (issuing the SQL requests under the hood)

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170822/27ade5ff/attachment-0001.html>

From bishop.dev at gmail.com  Tue Aug 22 03:03:44 2017
From: bishop.dev at gmail.com (Dmitry Baryshnikov)
Date: Tue, 22 Aug 2017 13:03:44 +0300
Subject: [gdal-dev] How to drop a raster layer from GeoPackage?
In-Reply-To: <2538242.bZx7V7ZPmO@even-i700>
References: <90430cea7f7f4d028f631c34a7e3d783@C119S212VM042.msvyvi.vaha.local>
 <2538242.bZx7V7ZPmO@even-i700>
Message-ID: <a40189a9-8373-f3e5-637a-9b87bb72ba87@gmail.com>

Is it the bug of gdalmanage that this utility cannot delete raster layer 
from geopackage?

Best regards,
     Dmitry

22.08.17 12:49, Even Rouault пишет:
>
> On mardi 22 août 2017 09:42:40 CEST Rahkonen Jukka (MML) wrote:
>
> > Hi,
>
> >
>
> > There is an interesting question in gis.stackexchange about how to 
> remove a
>
> > raster layer from GeoPackage
>
> > 
> https://gis.stackexchange.com/questions/252782/remove-a-raster-from-geopack
>
> > age.
>
> >
>
> > I had a try and gdalmanage did not have any effect on the GeoPackage
>
> > database but the workflow with ogrinfo works for me. Are there any other
>
> > alternatives?
>
> The manual ogrinfo way is the only one using GDAL utilities.
>
> We should probably extend the -sql "DELLAYER:xxxx" syntax to work with 
> raster tables as well. Actually I see we currently also catch "DROP 
> TABLE xxxx" to drop the table and remove links in other tables in the 
> vector case (so with th same effect as DELLAYER:xxxxx). Would you mind 
> creating an enhancement ticket about that ?
>
> There's ongoing work on the QGIS side (dev version only I guess) to 
> offer in the DBManager a way to delete raster layers (issuing the SQL 
> requests under the hood)
>
> Even
>
> -- 
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170822/beb5407a/attachment.html>

From even.rouault at spatialys.com  Tue Aug 22 03:14:49 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 22 Aug 2017 12:14:49 +0200
Subject: [gdal-dev] How to drop a raster layer from GeoPackage?
In-Reply-To: <a40189a9-8373-f3e5-637a-9b87bb72ba87@gmail.com>
References: <90430cea7f7f4d028f631c34a7e3d783@C119S212VM042.msvyvi.vaha.local>
 <2538242.bZx7V7ZPmO@even-i700>
 <a40189a9-8373-f3e5-637a-9b87bb72ba87@gmail.com>
Message-ID: <1638911.sa7B18AMlU@even-i700>

On mardi 22 août 2017 13:03:44 CEST Dmitry Baryshnikov wrote:
> Is it the bug of gdalmanage that this utility cannot delete raster layer
> from geopackage?

gdalmanage delete is to delete a dataset, not a raster layer. The concept of raster layer 
doesn't really exist in the GDAL abstraction. The closest we have is subdatasets.

Actually perhaps the GPKG driver could be improved so it implements the Delete() method of 
GDALDriver and recognizes subdataset names, to implement deletion of only the raster layer 
pointed by the subddataset name

So gdalmanage delete GPKG:my.gpkg:raster_layer would work then

> 
> Best regards,
>      Dmitry
> 
> 22.08.17 12:49, Even Rouault пишет:
> > On mardi 22 août 2017 09:42:40 CEST Rahkonen Jukka (MML) wrote:
> > > Hi,
> > > 
> > > 
> > > 
> > > There is an interesting question in gis.stackexchange about how to
> > 
> > remove a
> > 
> > > raster layer from GeoPackage
> > 
> > https://gis.stackexchange.com/questions/252782/remove-a-raster-from-geopac
> > k
> > 
> > > age.
> > > 
> > > 
> > > 
> > > I had a try and gdalmanage did not have any effect on the GeoPackage
> > > 
> > > database but the workflow with ogrinfo works for me. Are there any other
> > > 
> > > alternatives?
> > 
> > The manual ogrinfo way is the only one using GDAL utilities.
> > 
> > We should probably extend the -sql "DELLAYER:xxxx" syntax to work with
> > raster tables as well. Actually I see we currently also catch "DROP
> > TABLE xxxx" to drop the table and remove links in other tables in the
> > vector case (so with th same effect as DELLAYER:xxxxx). Would you mind
> > creating an enhancement ticket about that ?
> > 
> > There's ongoing work on the QGIS side (dev version only I guess) to
> > offer in the DBManager a way to delete raster layers (issuing the SQL
> > requests under the hood)
> > 
> > Even
> > 
> > 
> > Spatialys - Geospatial professional services
> > 
> > http://www.spatialys.com
> > 
> > 
> > 
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > https://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170822/db3beffb/attachment.html>

From pierre-jean.assemat at airbus.com  Wed Aug 23 03:32:41 2017
From: pierre-jean.assemat at airbus.com (Assemat Pierre-Jean)
Date: Wed, 23 Aug 2017 03:32:41 -0700 (MST)
Subject: [gdal-dev] Impossible to open an ASRP dataset in java when
 gdalinfo/translate commands works
Message-ID: <1503484361109-5332236.post@n6.nabble.com>

Dear all,

I work with GDAL 2.2.1 on Windows 7.

When I try to open an ASRP dataset in java with the following code :
    Dataset resu = org.gdal.gdal.gdal.Open(filenameOrURL,
.gdal.gdalconst.gdalconst.GA_ReadOnly) ;

   I have the following message :
      ERROR 1: ISO8211 record leader appears to be corrupt.

    and a null dataset is returned.

When I try to read this dataset in C++ whith gdalinfo or gdal_translate I do
have the same message but both commands ignore it and display full info or
perform translation...

Question :
What parameter/function should I call to have the same behavior in java ???

Thank you by advance for your help

Best regards
Pierre-Jean Assemat








--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Impossible-to-open-an-ASRP-dataset-in-java-when-gdalinfo-translate-commands-works-tp5332236.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Wed Aug 23 03:44:09 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 23 Aug 2017 12:44:09 +0200
Subject: [gdal-dev] Impossible to open an ASRP dataset in java when
	gdalinfo/translate commands works
In-Reply-To: <1503484361109-5332236.post@n6.nabble.com>
References: <1503484361109-5332236.post@n6.nabble.com>
Message-ID: <1551394.nmdaXD5doa@even-i700>

On mercredi 23 août 2017 03:32:41 CEST Assemat Pierre-Jean wrote:
> Dear all,
> 
> I work with GDAL 2.2.1 on Windows 7.
> 
> When I try to open an ASRP dataset in java with the following code :
>     Dataset resu = org.gdal.gdal.gdal.Open(filenameOrURL,
> .gdal.gdalconst.gdalconst.GA_ReadOnly) ;
> 
>    I have the following message :
>       ERROR 1: ISO8211 record leader appears to be corrupt.
> 
>     and a null dataset is returned.
> 
> When I try to read this dataset in C++ whith gdalinfo or gdal_translate I do
> have the same message but both commands ignore it and display full info or
> perform translation...
> 
> Question :
> What parameter/function should I call to have the same behavior in java ???

Pierre-Jean,

You can't without modifying the code. For historical reasons, the Java & Python bindings are 
stricter than the C++ API, and will reject a non null dataset if an error has been emitted and 
not cleared by the driver before it returns its dataset object.

A workaround is to add a CPLErrorReset() call before the "return poDS;" calls (there are 
several ones) of SRPDataset::Open() in frmts/adrg/srpdataset.cpp

Another one is to alter in swig/include/gdal.i

#ifdef SWIGJAVA
%newobject Open;
%inline %{
static
GDALDatasetShadow* Open( char const* utf8_path, GDALAccess eAccess) {
  CPLErrorReset();
  GDALDatasetShadow *ds = GDALOpen( utf8_path, eAccess );
  if( ds != NULL && CPLGetLastErrorType() == CE_Failure )
  {
      if ( GDALDereferenceDataset( ds ) <= 0 )
          GDALClose(ds);
      ds = NULL;
  }
  return (GDALDatasetShadow*) ds;
}
%}

to

#ifdef SWIGJAVA
%newobject Open;
%inline %{
static
GDALDatasetShadow* Open( char const* utf8_path, GDALAccess eAccess) {
  CPLErrorReset();
  GDALDatasetShadow *ds = GDALOpen( utf8_path, eAccess );
  return (GDALDatasetShadow*) ds;
}
%}

and regenerate the Java bindings.

A better solution would be to examine if the error is indeed legitimate, and possibly be more 
tolerant to just issue a warning instead of an error.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170823/63ae75be/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Wed Aug 23 06:33:07 2017
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Wed, 23 Aug 2017 13:33:07 +0000
Subject: [gdal-dev] Schema of gpkg_metadata in Geopackage
Message-ID: <47d6032d3cbe4d8cbc54557dd5d42784@C119S212VM042.msvyvi.vaha.local>

Hi,

GDAL 2.3-dev creates gpkg_metadata table as

CREATE TABLE gpkg_metadata (id INTEGER CONSTRAINT m_pk PRIMARY KEY ASC NOT NULL UNIQUE,md_scope TEXT NOT NULL DEFAULT 'dataset',md_standard_uri TEXT NOT NULL,mime_type TEXT NOT NULL DEFAULT 'text/xml',metadata TEXT NOT NULL DEFAULT '');

In GPKG standard v. 1.0.1 and 1.2 the SQL is


CREATE TABLE gpkg_metadata (

id INTEGER CONSTRAINT m_pk PRIMARY KEY ASC NOT NULL,

md_scope TEXT NOT NULL DEFAULT 'dataset',

md_standard_uri TEXT NOT NULL,

mime_type TEXT NOT NULL DEFAULT 'text/xml',

metadata TEXT NOT NULL
)

It seems that UNIQUE was removed in 1.0.1 corrigendum. I am not sure about what to think about having "metadata TEXT NOT NULL DEFAULT ''". In table 14 in standard version 1.0.1 and also in table 32 in standard v. 1.2 there is an empty string as a default value but it does not reflect to the CREATE TABLE example.

-Jukka Rahkonen-


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170823/80946755/attachment.html>

From even.rouault at spatialys.com  Wed Aug 23 06:55:48 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 23 Aug 2017 15:55:48 +0200
Subject: [gdal-dev] Schema of gpkg_metadata in Geopackage
In-Reply-To: <47d6032d3cbe4d8cbc54557dd5d42784@C119S212VM042.msvyvi.vaha.local>
References: <47d6032d3cbe4d8cbc54557dd5d42784@C119S212VM042.msvyvi.vaha.local>
Message-ID: <6899779.DSEogGFkl5@even-i700>

On mercredi 23 août 2017 13:33:07 CEST Rahkonen Jukka (MML) wrote:
> Hi,
> 
> GDAL 2.3-dev creates gpkg_metadata table as
> 
> CREATE TABLE gpkg_metadata (id INTEGER CONSTRAINT m_pk PRIMARY KEY ASC NOT
> NULL UNIQUE,md_scope TEXT NOT NULL DEFAULT 'dataset',md_standard_uri TEXT
> NOT NULL,mime_type TEXT NOT NULL DEFAULT 'text/xml',metadata TEXT NOT NULL
> DEFAULT '');
> 
> In GPKG standard v. 1.0.1 and 1.2 the SQL is
> 
> 
> CREATE TABLE gpkg_metadata (
> 
> id INTEGER CONSTRAINT m_pk PRIMARY KEY ASC NOT NULL,
> 
> md_scope TEXT NOT NULL DEFAULT 'dataset',
> 
> md_standard_uri TEXT NOT NULL,
> 
> mime_type TEXT NOT NULL DEFAULT 'text/xml',
> 
> metadata TEXT NOT NULL
> )
> 
> It seems that UNIQUE was removed in 1.0.1 corrigendum.

You've good eyes ;-) I've just removed UNIQUE in trunk to align with latest specs, but I guess 
that doesn't make a difference in practice (and validation checks are fine with or without 
UNIQUE). A primary key is necessarily unique.

> I am not sure about
> what to think about having "metadata TEXT NOT NULL DEFAULT ''". In table 14
> in standard version 1.0.1 and also in table 32 in standard v. 1.2 there is
> an empty string as a default value but it does not reflect to the CREATE
> TABLE example.

In the live spec at http://www.geopackage.org/spec/#gpkg_metadata_sql , the example is 
metadata TEXT NOT NULL DEFAULT '' . Spec was fixed per
https://github.com/opengeospatial/geopackage/issues/243


But I see the http://www.geopackage.org/spec/#metadata_example_appendix is wrong...
Filed as https://github.com/opengeospatial/geopackage/issues/382


Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170823/7d89eeb8/attachment-0001.html>

From schut at satelligence.com  Wed Aug 23 07:01:05 2017
From: schut at satelligence.com (Vincent Schut)
Date: Wed, 23 Aug 2017 16:01:05 +0200
Subject: [gdal-dev] vsigzip woes with hgt.gz files
Message-ID: <de803af5-d188-0256-389c-0e60911781bf@satelligence.com>

Hi all,

I'm trying to get the /vsigzip/ driver working on srtm .hgt.gz files, 
but I don't succeed:

gdalinfo /vsigzip/N37W105.hgt.gz
ERROR 4: `/vsigzip/N37W105.hgt.gz' not recognized as a supported file 
format.
gdalinfo failed - unable to open '/vsigzip/N37W105.hgt.gz'.

This is with a .hgt.gz from here: 
https://s3.amazonaws.com/elevation-tiles-prod/skadi/N37/N37W105.hgt.gz

gunzipping the file works OK.

Any hints?

(in the end, I'd like it to work remotely with a /vsizip/vsicurl/ combo).

Thanks!
Vincent.


From even.rouault at spatialys.com  Wed Aug 23 07:20:27 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 23 Aug 2017 16:20:27 +0200
Subject: [gdal-dev] vsigzip woes with hgt.gz files
In-Reply-To: <de803af5-d188-0256-389c-0e60911781bf@satelligence.com>
References: <de803af5-d188-0256-389c-0e60911781bf@satelligence.com>
Message-ID: <2479938.9GZAedRgLE@even-i700>

On mercredi 23 août 2017 16:01:05 CEST Vincent Schut wrote:
> Hi all,
> 
> I'm trying to get the /vsigzip/ driver working on srtm .hgt.gz files,
> but I don't succeed:
> 
> gdalinfo /vsigzip/N37W105.hgt.gz
> ERROR 4: `/vsigzip/N37W105.hgt.gz' not recognized as a supported file
> format.
> gdalinfo failed - unable to open '/vsigzip/N37W105.hgt.gz'.
> 
> This is with a .hgt.gz from here:
> https://s3.amazonaws.com/elevation-tiles-prod/skadi/N37/N37W105.hgt.gz
> 
> gunzipping the file works OK.
> 
> Any hints?

Fixed per https://trac.osgeo.org/gdal/ticket/7016

However opening time is really slow (which might be a problem or not depending on what 
you're doing) as the whole file needs to be downloaded and decompressed. The reason is 
that .hgt files are pure raw data files without any header, so the only way to know the 
dimensions is to check the file size against 3601*3601*2 bytes (SRTM 3 at low latitudes), 
3601*1801*2 (SRTM 3 at high latitudes) or 1801*1801*2 (SRTM 1). But for a .gz file, the 
only way to get the uncompressed file size is to uncompress it...

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170823/8cecd1f9/attachment.html>

From schut at satelligence.com  Wed Aug 23 07:38:55 2017
From: schut at satelligence.com (Vincent Schut)
Date: Wed, 23 Aug 2017 16:38:55 +0200
Subject: [gdal-dev] vsigzip woes with hgt.gz files
In-Reply-To: <2479938.9GZAedRgLE@even-i700>
References: <de803af5-d188-0256-389c-0e60911781bf@satelligence.com>
 <2479938.9GZAedRgLE@even-i700>
Message-ID: <62f8ecf3-17e2-ee06-8ec6-936a8abadd14@satelligence.com>

On 08/23/2017 04:20 PM, Even Rouault wrote:
>
> On mercredi 23 août 2017 16:01:05 CEST Vincent Schut wrote:
>
> > Hi all,
>
> >
>
> > I'm trying to get the /vsigzip/ driver working on srtm .hgt.gz files,
>
> > but I don't succeed:
>
> >
>
> > gdalinfo /vsigzip/N37W105.hgt.gz
>
> > ERROR 4: `/vsigzip/N37W105.hgt.gz' not recognized as a supported file
>
> > format.
>
> > gdalinfo failed - unable to open '/vsigzip/N37W105.hgt.gz'.
>
> >
>
> > This is with a .hgt.gz from here:
>
> > https://s3.amazonaws.com/elevation-tiles-prod/skadi/N37/N37W105.hgt.gz
>
> >
>
> > gunzipping the file works OK.
>
> >
>
> > Any hints?
>
> Fixed per https://trac.osgeo.org/gdal/ticket/7016
>

Thanks Even!

> However opening time is really slow (which might be a problem or not 
> depending on what you're doing) as the whole file needs to be 
> downloaded and decompressed. The reason is that .hgt files are pure 
> raw data files without any header, so the only way to know the 
> dimensions is to check the file size against 3601*3601*2 bytes (SRTM 3 
> at low latitudes), 3601*1801*2 (SRTM 3 at high latitudes) or 
> 1801*1801*2 (SRTM 1). But for a .gz file, the only way to get the 
> uncompressed file size is to uncompress it...
>
> Even
>
> -- 
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170823/1144b117/attachment.html>

From rykovd at gmail.com  Wed Aug 23 09:24:34 2017
From: rykovd at gmail.com (Denis Rykov)
Date: Wed, 23 Aug 2017 23:24:34 +0700
Subject: [gdal-dev] How to set layer name in SQL query?
Message-ID: <CAJbvKNoKqZkcjvkzKY5mWvMYZiK8Cvj9Eo9ASQ64KO_jvDmpaQ@mail.gmail.com>

When I perform the following command:

$ ogrinfo -dialect SQLITE -sql "SELECT COUNT(*) summary FROM
Export_Output_4" Export_Output_4.shp

I get result:

INFO: Open of `Export_Output_4.shp'
      using driver `ESRI Shapefile' successful.

Layer name: SELECT
Geometry: None
Feature Count: 1
Layer SRS WKT:
(unknown)
summary: Integer (0.0)
OGRFeature(SELECT):0
  summary (Integer) = 703

Is it possible to change layer name in output ("SELECT" now).
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170823/feec8a52/attachment.html>

From ozdogan at wisc.edu  Wed Aug 23 13:03:36 2017
From: ozdogan at wisc.edu (MUTLU OZDOGAN)
Date: Wed, 23 Aug 2017 20:03:36 +0000
Subject: [gdal-dev] gdal2tiles error
Message-ID: <BE3F5AC5-27E0-4E17-87D0-F446958E7B12@wisc.edu>

Dear developers,

I have an 8-bit geotiff image that contains land cover classification results.  The dimensions of the image is 1000 x 1000 pixels.  I am trying to generate tiles with 21 zoom levels using the gdal2tiles.py script so that we can display the results on a website.  In the first step, I converted the single band paletted image into color composite with the correct class colors using this command:

gdal_translate -of vrt -expand rgba results.tif temp.vrt

and in the second step I used the gdal2tiles.py script in the following way but I am getting errors:

gdal2tiles.py -p raster -z 0-20 -a 3 -v temp.vrt sample

the error is below.

Any help in explaining and solving this issue would be much appreciated.

Thank you

Mutlu..


('Input file:', '( 1000P x 1000L - 4 bands)')
NODATA: [3.0, 3.0, 3.0, 3.0]
('Preprocessed file:', '( 1000P x 1000L - 4 bands)')
KML autotest OK!
('Bounds (output srs):', -96.08910285, 42.692523704760006, -95.81960826476, 42.96201829)
('Native zoom of the raster:', 2)
Generating Base Tiles:

Tiles generated from the max zoom level:
----------------------------------------

('dataBandsCount: ', 3)
('tilebands: ', 4)
(1, '/', 1048576000000, 'sample/20/0/1023999.png')
('\tReadRaster Extent: ', (0, -1023000, 1, 1), (0, 0, 256, 256))
ERROR 5: temp.vrt: Access window out of range in RasterIO().  Requested
(0,-1023000) of size 1x1 on raster of 1000x1000.
ERROR 5: temp.vrt, band 4: Access window out of range in RasterIO().  Requested
(0,-1023000) of size 1x1 on raster of 1000x1000.
Traceback (most recent call last):
  File "/Library/Frameworks/GDAL.framework/Versions/Current/Programs/gdal2tiles.py", line 2278, in <module>
    gdal2tiles.process()
  File "/Library/Frameworks/GDAL.framework/Versions/Current/Programs/gdal2tiles.py", line 488, in process
    self.generate_base_tiles()
  File "/Library/Frameworks/GDAL.framework/Versions/Current/Programs/gdal2tiles.py", line 1276, in generate_base_tiles
    dstile.WriteRaster(wx, wy, wxsize, wysize, data, band_list=list(range(1,self.dataBandsCount+1)))
  File "/Library/Frameworks/GDAL.framework/Versions/1.11/Python/2.7/site-packages/osgeo/gdal.py", line 846, in WriteRaster
    buf_pixel_space, buf_line_space, buf_band_space )
TypeError: not a string




--

Mutlu Ozdogan, Ph.D.
Associate Professor
Department of Forest and Wildlife Ecology &
Nelson Institute for Environmental Studies
t: (608) 262-0873
e: ozdogan at wisc.edu<mailto:ozdogan at wisc.edu>




-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170823/38c75970/attachment.html>

From gregory.bataille at gmail.com  Wed Aug 23 21:04:40 2017
From: gregory.bataille at gmail.com (=?UTF-8?Q?Gr=C3=A9gory_Bataille?=)
Date: Thu, 24 Aug 2017 04:04:40 +0000
Subject: [gdal-dev] gdal2tiles error
In-Reply-To: <BE3F5AC5-27E0-4E17-87D0-F446958E7B12@wisc.edu>
References: <BE3F5AC5-27E0-4E17-87D0-F446958E7B12@wisc.edu>
Message-ID: <CACVcCzrkwjZNv8qFEhua_M_CfGMO+f1SxoKYfaZfnVdPqCpPmQ@mail.gmail.com>

Hello,

In your stack trace I gather you are using GDAL 1?
If that's the case, you should use the latest gdal 2.2). I'm quite sure the
issue is fixed there

On a mac, look for the osgeo4mac brew tap and install the gdal2 package. I
think it's up-to-date. Otherwise you should retrieve gdal2tiles.py from our
github mirror.

On Wed, 23 Aug 2017 at 23:04, MUTLU OZDOGAN <ozdogan at wisc.edu> wrote:

> Dear developers,
>
> I have an 8-bit geotiff image that contains land cover classification
> results.  The dimensions of the image is 1000 x 1000 pixels.  I am trying
> to generate tiles with 21 zoom levels using the gdal2tiles.py script so
> that we can display the results on a website.  In the first step, I
> converted the single band paletted image into color composite with the
> correct class colors using this command:
>
> gdal_translate -of vrt -expand rgba results.tif temp.vrt
>
> and in the second step I used the gdal2tiles.py script in the following
> way but I am getting errors:
>
> gdal2tiles.py -p raster -z 0-20 -a 3 -v temp.vrt sample
>
> the error is below.
>
> Any help in explaining and solving this issue would be much appreciated.
>
> Thank you
>
> Mutlu..
>
>
> ('Input file:', '( 1000P x 1000L - 4 bands)')
> NODATA: [3.0, 3.0, 3.0, 3.0]
> ('Preprocessed file:', '( 1000P x 1000L - 4 bands)')
> KML autotest OK!
> ('Bounds (output srs):', -96.08910285, 42.692523704760006,
> -95.81960826476, 42.96201829)
> ('Native zoom of the raster:', 2)
> Generating Base Tiles:
>
> Tiles generated from the max zoom level:
> ----------------------------------------
>
> ('dataBandsCount: ', 3)
> ('tilebands: ', 4)
> (1, '/', 1048576000000, 'sample/20/0/1023999.png')
> ('\tReadRaster Extent: ', (0, -1023000, 1, 1), (0, 0, 256, 256))
> ERROR 5: temp.vrt: Access window out of range in RasterIO().  Requested
> (0,-1023000) of size 1x1 on raster of 1000x1000.
> ERROR 5: temp.vrt, band 4: Access window out of range in RasterIO().
> Requested
> (0,-1023000) of size 1x1 on raster of 1000x1000.
> Traceback (most recent call last):
>   File
> "/Library/Frameworks/GDAL.framework/Versions/Current/Programs/gdal2tiles.py",
> line 2278, in <module>
>     gdal2tiles.process()
>   File
> "/Library/Frameworks/GDAL.framework/Versions/Current/Programs/gdal2tiles.py",
> line 488, in process
>     self.generate_base_tiles()
>   File
> "/Library/Frameworks/GDAL.framework/Versions/Current/Programs/gdal2tiles.py",
> line 1276, in generate_base_tiles
>     dstile.WriteRaster(wx, wy, wxsize, wysize, data,
> band_list=list(range(1,self.dataBandsCount+1)))
>   File
> "/Library/Frameworks/GDAL.framework/Versions/1.11/Python/2.7/site-packages/osgeo/gdal.py",
> line 846, in WriteRaster
>     buf_pixel_space, buf_line_space, buf_band_space )
> TypeError: not a string
>
>
>
>
> --
>
> Mutlu Ozdogan, Ph.D.
> Associate Professor
> Department of Forest and Wildlife Ecology &
> Nelson Institute for Environmental Studies
> t: (608) 262-0873
> e: ozdogan at wisc.edu
>
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Greg
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170824/c5b732fa/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Wed Aug 23 23:19:19 2017
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Thu, 24 Aug 2017 06:19:19 +0000
Subject: [gdal-dev] Schema of gpkg_metadata in Geopackage
In-Reply-To: <6899779.DSEogGFkl5@even-i700>
References: <47d6032d3cbe4d8cbc54557dd5d42784@C119S212VM042.msvyvi.vaha.local>,
 <6899779.DSEogGFkl5@even-i700>
Message-ID: <1503555565195.62884@maanmittauslaitos.fi>

Hi,


Our document

http://www.gdal.org/drv_geopackage.html says that gpkg driver targets standard version 1.0/1.0.1. For me it seems that starting from GDAL 2.2 the target is version 1.2, it that right?


-Jukka Rahkonen-

________________________________
Lähettäjä: Even Rouault <even.rouault at spatialys.com>
Lähetetty: 23. elokuuta 2017 16:55
Vastaanottaja: gdal-dev at lists.osgeo.org
Kopio: Rahkonen Jukka (MML)
Aihe: Re: [gdal-dev] Schema of gpkg_metadata in Geopackage


On mercredi 23 août 2017 13:33:07 CEST Rahkonen Jukka (MML) wrote:

> Hi,

>

> GDAL 2.3-dev creates gpkg_metadata table as

>

> CREATE TABLE gpkg_metadata (id INTEGER CONSTRAINT m_pk PRIMARY KEY ASC NOT

> NULL UNIQUE,md_scope TEXT NOT NULL DEFAULT 'dataset',md_standard_uri TEXT

> NOT NULL,mime_type TEXT NOT NULL DEFAULT 'text/xml',metadata TEXT NOT NULL

> DEFAULT '');

>

> In GPKG standard v. 1.0.1 and 1.2 the SQL is

>

>

> CREATE TABLE gpkg_metadata (

>

> id INTEGER CONSTRAINT m_pk PRIMARY KEY ASC NOT NULL,

>

> md_scope TEXT NOT NULL DEFAULT 'dataset',

>

> md_standard_uri TEXT NOT NULL,

>

> mime_type TEXT NOT NULL DEFAULT 'text/xml',

>

> metadata TEXT NOT NULL

> )

>

> It seems that UNIQUE was removed in 1.0.1 corrigendum.



You've good eyes ;-) I've just removed UNIQUE in trunk to align with latest specs, but I guess that doesn't make a difference in practice (and validation checks are fine with or without UNIQUE). A primary key is necessarily unique.



> I am not sure about

> what to think about having "metadata TEXT NOT NULL DEFAULT ''". In table 14

> in standard version 1.0.1 and also in table 32 in standard v. 1.2 there is

> an empty string as a default value but it does not reflect to the CREATE

> TABLE example.



In the live spec at http://www.geopackage.org/spec/#gpkg_metadata_sql , the example is metadata TEXT NOT NULL DEFAULT '' . Spec was fixed per

https://github.com/opengeospatial/geopackage/issues/243





But I see the http://www.geopackage.org/spec/#metadata_example_appendix is wrong...

Filed as https://github.com/opengeospatial/geopackage/issues/382





Even



--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170824/a8186cb6/attachment-0001.html>

From even.rouault at spatialys.com  Thu Aug 24 02:13:11 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 24 Aug 2017 11:13:11 +0200
Subject: [gdal-dev] Schema of gpkg_metadata in Geopackage
In-Reply-To: <1503555565195.62884@maanmittauslaitos.fi>
References: <47d6032d3cbe4d8cbc54557dd5d42784@C119S212VM042.msvyvi.vaha.local>
 <6899779.DSEogGFkl5@even-i700> <1503555565195.62884@maanmittauslaitos.fi>
Message-ID: <2051461.7nEzDIt2nZ@even-i700>

On jeudi 24 août 2017 06:19:19 CEST Rahkonen Jukka (MML) wrote:
> Hi,
> 
> 
> Our document
> 
> http://www.gdal.org/drv_geopackage.html says that gpkg driver targets
> standard version 1.0/1.0.1. For me it seems that starting from GDAL 2.2 the
> target is version 1.2, it that right?

Not completely. Good point. I've adjusted the doc per:
https://trac.osgeo.org/gdal/changeset/39928

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170824/9d21e56f/attachment.html>

From jluis at ualg.pt  Thu Aug 24 13:12:55 2017
From: jluis at ualg.pt (Joaquim Luis)
Date: Thu, 24 Aug 2017 21:12:55 +0100
Subject: [gdal-dev] Which Proj.4 transforms are available in GDAL?
Message-ID: <op.y5hrr20edbaoe8@macmarilu>

Hi Even,

I'm implementing Proj.4 in GMT via GDAL and now, in the the testing stage,  
I'm using data from

https://github.com/Beman/boost-trunk-git-svn/blob/master/libs/geometry/test_extensions/gis/projections/projections.cpp#L121

but to my surprise lots of projections are not implemented in GDAL. For  
example

gdaltransform -s_srs EPSG:4326 -t_srs +proj=airy +ellps=WGS84 +units=m
ERROR 1: Translating source or target SRS failed:
+proj=airy

Or

gdaltransform -s_srs EPSG:4326 -t_srs +proj=bonne
ERROR 6: Failed to initialize PROJ.4 with `+proj=bonne +lon_0=0 +lat_1=0  
+x_0=0 +y_0=0 +ellps=WGS84 +units=m +no_defs'.


Is there a place where I can find the list of available proj.4 transforms?



And also found some that do no agree between GDAL and proj. For example

echo 4.897 52.371 | proj +proj=vandg +ellps=WGS84 +units=m
489005.93       6431581.02

gdaltransform -s_srs EPSG:4326 -t_srs "+proj=vandg +ellps=WGS84 +units=m"
4.897 52.371
488459.293282675 6424391.46347316 0

Cheers

Joaquim

From list-fhi at web.de  Fri Aug 25 02:25:55 2017
From: list-fhi at web.de (list-fhi at web.de)
Date: Fri, 25 Aug 2017 11:25:55 +0200
Subject: [gdal-dev] =?utf-8?q?How_to_escape_special_characters_in_an_?=
 =?utf-8?q?=E2=80=9C-sql=E2=80=9D_option_within_an_ogr2ogr_command_line=3F?=
Message-ID: <trinity-bdf94ebc-33cb-4ca5-9b06-021e85326c43-1503653155219@3c-app-webde-bap23>

Hello,
I am using Windows 7 x64, GDAL v2.3.0dev r39906 from http://www.gisinternals.com/development.php.
Input:    https://ufile.io/i5oj3
Output:   https://uploadfiles.io/
Command line:
ogr2ogr.exe -f "GPKG" "C:\Temp\output.gpkg" "C:\Temp\input.sqlite" -overwrite -lco "SPATIAL_INDEX=NO" -lco "GEOMETRY_NAME=the_geom" -nlt "MULTIPOLYGON" -lco "GEOMETRY_NULLABLE=yes" -nln "import" -t_srs "EPSG:4326" -sql "SELECT \"OBJECTID\", \"NAME\", \"STATE_NAME\", \"STATE_FIPS\", \"CNTY_FIPS\", \"FIPS\", \"AREA\", \"POP1990\", \"POP2000\", \"POP90_SQMI\", \"!#()*+,-:;=@^_ ^|~äöüß\", \"the_geom\" FROM \"import3\";"
 
In my case I have a test Spatialite layer with an attribute named: “!#()*+,-:;=@^_ |~äöüß” (without the double quotes).
When I tried to copy the layer to a new GeoPackage layer, it failed with an.
After I escaped the “|” character with “^|” the command line worked without error.
However, the name of the attribute name in the new GeoPackage layer is empty.
 
I reckon the error involves special characters who need escaping. As everything works as expected if I don't export the "!#()*+,-:;=@^_ |~äöüß" attribute. I tried several methods of escaping some of the characters but it never worked right. Could anybody help in escaping the characters, so that the attribute name is correct in the newly created GeoPackage?

From even.rouault at spatialys.com  Fri Aug 25 04:52:14 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 25 Aug 2017 13:52:14 +0200
Subject: [gdal-dev] Which Proj.4 transforms are available in GDAL?
In-Reply-To: <op.y5hrr20edbaoe8@macmarilu>
References: <op.y5hrr20edbaoe8@macmarilu>
Message-ID: <9459999.8dFvGKNm6J@even-i700>

Joaquim,

> 
> I'm implementing Proj.4 in GMT via GDAL and now, in the the testing stage,
> I'm using data from
> 
> https://github.com/Beman/boost-trunk-git-svn/blob/master/libs/geometry/test_
> extensions/gis/projections/projections.cpp#L121
> 
> but to my surprise lots of projections are not implemented in GDAL. For
> example

GDAL SRS model is based on WKT, so only projections that have a mapping to WKT 1 (and for which a developer cared enough to write the needed code !) are nominally supported

> 
> gdaltransform -s_srs EPSG:4326 -t_srs +proj=airy +ellps=WGS84 +units=m

For unsupported projections, add +wktext. A dummy WKT representation is then built that captures the full proj.4 string in a EXTENSION node. Can also serve for supported projections if you want to overrite the WKT -> proj.4 string conversion done by GDAL

$ gdalsrsinfo "+proj=airy +ellps=WGS84 +units=m +wktext"

PROJ.4 : +proj=airy +ellps=WGS84 +units=m +wktext

OGC WKT :
PROJCS["unnamed",
    GEOGCS["WGS 84",
        DATUM["unknown",
            SPHEROID["WGS84",6378137,298.257223563]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["custom_proj4"],
    UNIT["Meter",1],
    EXTENSION["PROJ4","+proj=airy +ellps=WGS84 +units=m +wktext"]]


$ gdaltransform -s_srs EPSG:4326 -t_srs "+proj=airy +ellps=WGS84 +units=m +wktext"

> ERROR 1: Translating source or target SRS failed:
> +proj=airy
> 
> Or
> 
> gdaltransform -s_srs EPSG:4326 -t_srs +proj=bonne
> ERROR 6: Failed to initialize PROJ.4 with `+proj=bonne +lon_0=0 +lat_1=0
> +x_0=0 +y_0=0 +ellps=WGS84 +units=m +no_defs'.
> 

I thing the issue is that lat_1=0 is invalid for bonne. Any non zero value is OK

> 
> Is there a place where I can find the list of available proj.4 transforms?
> 
> 

You mean projections supported by GDAL (as far as I know, most if not all projections supported by GDAL translate then to proj.4) ?

Look at the various OSRSetXXXXX() methods in
http://gdal.org/ogr__srs__api_8h.html

Or starting there
https://github.com/OSGeo/gdal/blob/trunk/gdal/ogr/ogr_srs_proj4.cpp#L616


> 
> And also found some that do no agree between GDAL and proj. For example
> 
> echo 4.897 52.371 | proj +proj=vandg +ellps=WGS84 +units=m
> 489005.93       6431581.02
> 
> gdaltransform -s_srs EPSG:4326 -t_srs "+proj=vandg +ellps=WGS84 +units=m"
> 4.897 52.371
> 488459.293282675 6424391.46347316 0

If you add --debug on, you'll see that GDAL adds a +R_A parameter. I haven't dug up into history to know the reason for that.
If you add +wktext, the original string will be passed unmodified to proj.4

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170825/6fe3c339/attachment.html>

From andre+joost at nurfuerspam.de  Fri Aug 25 07:57:05 2017
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Fri, 25 Aug 2017 16:57:05 +0200
Subject: [gdal-dev] Which Proj.4 transforms are available in GDAL?
In-Reply-To: <9459999.8dFvGKNm6J@even-i700>
References: <op.y5hrr20edbaoe8@macmarilu> <9459999.8dFvGKNm6J@even-i700>
Message-ID: <onpdtj$60p$1@blaine.gmane.org>

Am 25.08.2017 um 13:52 schrieb Even Rouault:

>> And also found some that do no agree between GDAL and proj. For
>> example
>>
>> echo 4.897 52.371 | proj +proj=vandg +ellps=WGS84 +units=m
>> 489005.93       6431581.02
>>
>> gdaltransform -s_srs EPSG:4326 -t_srs "+proj=vandg +ellps=WGS84
>> +units=m" 4.897 52.371 488459.293282675 6424391.46347316 0
>
> If you add --debug on, you'll see that GDAL adds a +R_A parameter. I
> haven't dug up into history to know the reason for that. If you add
> +wktext, the original string will be passed unmodified to proj.4
>

https://github.com/OSGeo/proj.4/blob/master/src/PJ_vandg.c only has 
formulas for the spheroid. So it would be better to specify a radius 
directly, instead of an ellipsoid:

echo 4.897 52.371 | proj +proj=vandg +R=6371000
488458.74       6424384.22

gdaltransform -s_srs EPSG:4326 -t_srs "+proj=vandg +R=6371000
4.897 52.371
488458.742715653 6424384.22221862 0

HTH,
André Joost


From jluis at ualg.pt  Fri Aug 25 10:25:36 2017
From: jluis at ualg.pt (Joaquim Luis)
Date: Fri, 25 Aug 2017 18:25:36 +0100
Subject: [gdal-dev] Which Proj.4 transforms are available in GDAL?
In-Reply-To: <9459999.8dFvGKNm6J@even-i700>
References: <op.y5hrr20edbaoe8@macmarilu> <9459999.8dFvGKNm6J@even-i700>
Message-ID: <op.y5jeoywtdbaoe8@macmarilu>

OK, understood thanks. But got confused too. Why would a GDAL port of a  
proj.4 string do a different thing than the coded in the proj.4 string?

Found these two that not even with the +wktext agree


gdaltransform -s_srs EPSG:4326 -t_srs "+proj=aeqd +ellps=WGS84 +units=m  
+wktext"
4.897 52.371
384537.462362467 5809944.80754693 0

echo 4.897 52.371 | proj +proj=aeqd +ellps=WGS84 +units=m
384923.72       5809986.5



gdaltransform -s_srs EPSG:4326 -t_srs "+proj=robin +ellps=WGS84 +units=m  
+wktext"
4.897 52.371
394576.527707384 5570940.8420985 0

echo 4.897 52.371 | proj +proj=robin +ellps=WGS84 +units=m
394576.51       5571243.64




>
>
> Joaquim,
>
>
>
>
>
>
>>
>
>
>
>> I'm implementing Proj.4 in GMT via GDAL and now, in the the testing  
>> stage,
>
>
>
>> I'm using data from
>
>
>
>>
>
>
>
>> https://github.com/Beman/boost-trunk-git-svn/blob/master/libs/geometry/test_
>
>
>
>> extensions/gis/projections/projections.cpp#L121
>
>
>
>>
>
>
>
>> but to my surprise lots of projections are not implemented in GDAL. For
>
>
>
>> example
>
>
>
>
>
>
> GDAL SRS model is based on WKT, so only projections that have a mapping  
> to WKT 1 (and for which a >developer cared enough to write the needed  
> code !) are nominally supported
>
>
>
>
>
>
>>
>
>
>
>> gdaltransform -s_srs EPSG:4326 -t_srs +proj=airy +ellps=WGS84 +units=m
>
>
>
>
>
>
> For unsupported projections, add +wktext. A dummy WKT representation is  
> then built that captures >the full proj.4 string in a EXTENSION node.  
> Can also serve for supported projections if you want to >overrite the  
> WKT -> proj.4 string conversion done by GDAL
>
>
>
>
>
>
> $ gdalsrsinfo "+proj=airy +ellps=WGS84 +units=m +wktext"
>
>
>
>
>
>
> PROJ.4 : +proj=airy +ellps=WGS84 +units=m +wktext
>
>
>
>
>
>
> OGC WKT :
>
>
>
> PROJCS["unnamed",
>
>
>
>    GEOGCS["WGS 84",
>
>
>
>        DATUM["unknown",
>
>
>
>            SPHEROID["WGS84",6378137,298.257223563]],
>
>
>
>        PRIMEM["Greenwich",0],
>
>
>
>        UNIT["degree",0.0174532925199433]],
>
>
>
>    PROJECTION["custom_proj4"],
>
>
>
>    UNIT["Meter",1],
>
>
>
>    EXTENSION["PROJ4","+proj=airy +ellps=WGS84 +units=m +wktext"]]
>
>
>
>
>
>
>
>
>
> $ gdaltransform -s_srs EPSG:4326 -t_srs "+proj=airy +ellps=WGS84  
> +units=m +wktext"
>
>
>
>
>
>
>> ERROR 1: Translating source or target SRS failed:
>
>
>
>> +proj=airy
>
>
>
>>
>
>
>
>> Or
>
>
>
>>
>
>
>
>> gdaltransform -s_srs EPSG:4326 -t_srs +proj=bonne
>
>
>
>> ERROR 6: Failed to initialize PROJ.4 with `+proj=bonne +lon_0=0 +lat_1=0
>
>
>
>> +x_0=0 +y_0=0 +ellps=WGS84 +units=m +no_defs'.
>
>
>
>>
>
>
>
>
>
>
> I thing the issue is that lat_1=0 is invalid for bonne. Any non zero  
> value is OK
>
>
>
>
>
>
>>
>
>
>
>> Is there a place where I can find the list of available proj.4  
>> transforms?
>
>
>
>>
>
>
>
>>
>
>
>
>
>
>
> You mean projections supported by GDAL (as far as I know, most if not  
> all projections supported by >GDAL translate then to proj.4) ?
>
>
>
>
>
>
> Look at the various OSRSetXXXXX() methods in
>
>
>
> http://gdal.org/ogr__srs__api_8h.html
>
>
>
>
>
>
> Or starting there
>
>
>
> https://github.com/OSGeo/gdal/blob/trunk/gdal/ogr/ogr_srs_proj4.cpp#L616
>
>
>
>
>
>
>
>
>
>>
>
>
>
>> And also found some that do no agree between GDAL and proj. For example
>
>
>
>>
>
>
>
>> echo 4.897 52.371 | proj +proj=vandg +ellps=WGS84 +units=m
>
>
>
>> 489005.93       6431581.02
>
>
>
>>
>
>
>
>> gdaltransform -s_srs EPSG:4326 -t_srs "+proj=vandg +ellps=WGS84  
>> +units=m"
>
>
>
>> 4.897 52.371
>
>
>
>> 488459.293282675 6424391.46347316 0
>
>
>
>
>
>
> If you add --debug on, you'll see that GDAL adds a +R_A parameter. I  
> haven't dug up into history to >know the reason for that.
>
>
>
> If you add +wktext, the original string will be passed unmodified to  
> proj.4
>
>
>
>
>
>
> Even
>
>
>
>
>
>
> --
>
>
> Spatialys - Geospatial professional services
>
>
>
> http://www.spatialys.com

From even.rouault at spatialys.com  Fri Aug 25 12:06:29 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 25 Aug 2017 21:06:29 +0200
Subject: [gdal-dev] Which Proj.4 transforms are available in GDAL?
In-Reply-To: <op.y5jeoywtdbaoe8@macmarilu>
References: <op.y5hrr20edbaoe8@macmarilu> <9459999.8dFvGKNm6J@even-i700>
 <op.y5jeoywtdbaoe8@macmarilu>
Message-ID: <1628614.ym5L707Ncj@even-i700>

On vendredi 25 août 2017 18:25:36 CEST Joaquim Luis wrote:
> OK, understood thanks. But got confused too. Why would a GDAL port of a
> proj.4 string do a different thing than the coded in the proj.4 string?
> 

Yes that's not obvious but internally SRS in GDAL are not modelled as a proj.4 string, but as 
WKT. So there's a importFromProj4() and exportFromProj4(), and possible loss can happen 
when some concepts cannot be matched exactly.

> Found these two that not even with the +wktext agree

Perhaps you don't use the same proj.4 version ?

> 
> 
> gdaltransform -s_srs EPSG:4326 -t_srs "+proj=aeqd +ellps=WGS84 +units=m
> +wktext"
> 4.897 52.371
> 384537.462362467 5809944.80754693 0
> 
> echo 4.897 52.371 | proj +proj=aeqd +ellps=WGS84 +units=m
> 384923.72       5809986.5

I get the same result as GDAL (with proj 4.9.2)

$ echo 4.897 52.371 | proj +proj=aeqd +ellps=WGS84 +units=m
384537.46	5809944.81

> 
> 
> 
> gdaltransform -s_srs EPSG:4326 -t_srs "+proj=robin +ellps=WGS84 +units=m
> +wktext"
> 4.897 52.371
> 394576.527707384 5570940.8420985 0
> 
> echo 4.897 52.371 | proj +proj=robin +ellps=WGS84 +units=m
> 394576.51       5571243.64

$ echo 4.897 52.371 | proj +proj=robin +ellps=WGS84 +units=m
394576.53	5570940.84


> 
> > Joaquim,
> > 
> >> I'm implementing Proj.4 in GMT via GDAL and now, in the the testing
> >> stage,
> >> 
> >> 
> >> 
> >> I'm using data from
> >> 
> >> 
> >> 
> >> 
> >> 
> >> 
> >> 
> >> https://github.com/Beman/boost-trunk-git-svn/blob/master/libs/geometry/te
> >> st_
> >> 
> >> 
> >> 
> >> extensions/gis/projections/projections.cpp#L121
> >> 
> >> 
> >> 
> >> 
> >> 
> >> 
> >> 
> >> but to my surprise lots of projections are not implemented in GDAL. For
> >> 
> >> 
> >> 
> >> example
> > 
> > GDAL SRS model is based on WKT, so only projections that have a mapping
> > to WKT 1 (and for which a >developer cared enough to write the needed
> > code !) are nominally supported
> > 
> >> gdaltransform -s_srs EPSG:4326 -t_srs +proj=airy +ellps=WGS84 +units=m
> > 
> > For unsupported projections, add +wktext. A dummy WKT representation is
> > then built that captures >the full proj.4 string in a EXTENSION node.
> > Can also serve for supported projections if you want to >overrite the
> > WKT -> proj.4 string conversion done by GDAL
> > 
> > 
> > 
> > 
> > 
> > 
> > $ gdalsrsinfo "+proj=airy +ellps=WGS84 +units=m +wktext"
> > 
> > 
> > 
> > 
> > 
> > 
> > PROJ.4 : +proj=airy +ellps=WGS84 +units=m +wktext
> > 
> > 
> > 
> > 
> > 
> > 
> > OGC WKT :
> > 
> > 
> > 
> > PROJCS["unnamed",
> > 
> >    GEOGCS["WGS 84",
> >    
> >        DATUM["unknown",
> >        
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170825/c1bf665c/attachment-0001.html>

From jluis at ualg.pt  Fri Aug 25 16:46:42 2017
From: jluis at ualg.pt (Joaquim Luis)
Date: Sat, 26 Aug 2017 00:46:42 +0100
Subject: [gdal-dev] Which Proj.4 transforms are available in GDAL?
In-Reply-To: <1628614.ym5L707Ncj@even-i700>
References: <op.y5hrr20edbaoe8@macmarilu> <9459999.8dFvGKNm6J@even-i700>
 <op.y5jeoywtdbaoe8@macmarilu> <1628614.ym5L707Ncj@even-i700>
Message-ID: <op.y5jwb4ybdbaoe8@macmarilu>



>
> Yes that's not obvious but internally SRS in GDAL are not modelled as a  
> proj.4 string, but as WKT. So there's a importFromProj4() and  
> exportFromProj4(), and >possible loss can happen when some concepts  
> cannot be matched exactly.
>
>
>> Found these two that not even with the +wktext agree
>
>
> Perhaps you don't use the same proj.4 version ?

Yep, I was using a 4.8 version from  OSGeo4W. With 4.9.3 I get the same as  
with GDAL



>
>
>>
>
>>
>
>> gdaltransform -s_srs EPSG:4326 -t_srs "+proj=aeqd +ellps=WGS84 +units=m
>
>> +wktext"
>
>> 4.897 52.371
>
>> 384537.462362467 5809944.80754693 0
>
>>
>
>> echo 4.897 52.371 | proj +proj=aeqd +ellps=WGS84 +units=m
>
>> 384923.72       5809986.5
>
>
> I get the same result as GDAL (with proj 4.9.2)
>
>
> $ echo 4.897 52.371 | proj +proj=aeqd +ellps=WGS84 +units=m
>
> 384537.46	5809944.81
>
>
>>
>
>>
>
>>
>
>> gdaltransform -s_srs EPSG:4326 -t_srs "+proj=robin +ellps=WGS84 +units=m
>
>> +wktext"
>
>> 4.897 52.371
>
>> 394576.527707384 5570940.8420985 0
>
>>
>
>> echo 4.897 52.371 | proj +proj=robin +ellps=WGS84 +units=m
>
>> 394576.51       5571243.64
>
>
> $ echo 4.897 52.371 | proj +proj=robin +ellps=WGS84 +units=m
>
> 394576.53	5570940.84
>
>
>
>>
>
>> > Joaquim,
>
>> >
>
>> >> I'm implementing Proj.4 in GMT via GDAL and now, in the the testing
>
>> >> stage,
>
>> >>
>
>> >>
>
>> >>
>
>> >> I'm using data from
>
>> >>
>
>> >>
>
>> >>
>
>> >>
>
>> >>
>
>> >>
>
>> >>
>
>> >>  
>> https://github.com/Beman/boost-trunk-git-svn/blob/master/libs/geometry/te
>
>> >> st_
>
>> >>
>
>> >>
>
>> >>
>
>> >> extensions/gis/projections/projections.cpp#L121
>
>> >>
>
>> >>
>
>> >>
>
>> >>
>
>> >>
>
>> >>
>
>> >>
>
>> >> but to my surprise lots of projections are not implemented in GDAL.  
>> For
>
>> >>
>
>> >>
>
>> >>
>
>> >> example
>
>> >
>
>> > GDAL SRS model is based on WKT, so only projections that have a  
>> mapping
>
>> > to WKT 1 (and for which a >developer cared enough to write the needed
>
>> > code !) are nominally supported
>
>> >
>
>> >> gdaltransform -s_srs EPSG:4326 -t_srs +proj=airy +ellps=WGS84  
>> +units=m
>
>> >
>
>> > For unsupported projections, add +wktext. A dummy WKT representation  
>> is
>
>> > then built that captures >the full proj.4 string in a EXTENSION node.
>
>> > Can also serve for supported projections if you want to >overrite the
>
>> > WKT -> proj.4 string conversion done by GDAL
>
>> >
>
>> >
>
>> >
>
>> >
>
>> >
>
>> >
>
>> > $ gdalsrsinfo "+proj=airy +ellps=WGS84 +units=m +wktext"
>
>> >
>
>> >
>
>> >
>
>> >
>
>> >
>
>> >
>
>> > PROJ.4 : +proj=airy +ellps=WGS84 +units=m +wktext
>
>> >
>
>> >
>
>> >
>
>> >
>
>> >
>
>> >
>
>> > OGC WKT :
>
>> >
>
>> >
>
>> >
>
>> > PROJCS["unnamed",
>
>> >
>
>> >    GEOGCS["WGS 84",
>
>> >
>
>> >        DATUM["unknown",
>
>> >
>
>> >            SPHEROID["WGS84",6378137,298.257223563]],
>
>> >
>
>> >        PRIMEM["Greenwich",0],
>
>> >
>
>> >
>
>> >
>
>> >        UNIT["degree",0.0174532925199433]],
>
>> >
>
>> >    PROJECTION["custom_proj4"],
>
>> >
>
>> >
>
>> >
>
>> >    UNIT["Meter",1],
>
>> >
>
>> >
>
>> >
>
>> >    EXTENSION["PROJ4","+proj=airy +ellps=WGS84 +units=m +wktext"]]
>
>> >
>
>> > $ gdaltransform -s_srs EPSG:4326 -t_srs "+proj=airy +ellps=WGS84
>
>> > +units=m +wktext"
>
>> >
>
>> >> ERROR 1: Translating source or target SRS failed:
>
>> >>
>
>> >>
>
>> >>
>
>> >> +proj=airy
>
>> >>
>
>> >>
>
>> >>
>
>> >>
>
>> >>
>
>> >>
>
>> >>
>
>> >> Or
>
>> >>
>
>> >>
>
>> >>
>
>> >>
>
>> >>
>
>> >>
>
>> >>
>
>> >> gdaltransform -s_srs EPSG:4326 -t_srs +proj=bonne
>
>> >>
>
>> >>
>
>> >>
>
>> >> ERROR 6: Failed to initialize PROJ.4 with `+proj=bonne +lon_0=0  
>> +lat_1=0
>
>> >>
>
>> >>
>
>> >>
>
>> >> +x_0=0 +y_0=0 +ellps=WGS84 +units=m +no_defs'.
>
>> >
>
>> > I thing the issue is that lat_1=0 is invalid for bonne. Any non zero
>
>> > value is OK
>
>> >
>
>> >> Is there a place where I can find the list of available proj.4
>
>> >> transforms?
>
>> >
>
>> > You mean projections supported by GDAL (as far as I know, most if not
>
>> > all projections supported by >GDAL translate then to proj.4) ?
>
>> >
>
>> >
>
>> >
>
>> >
>
>> >
>
>> >
>
>> > Look at the various OSRSetXXXXX() methods in
>
>> >
>
>> >
>
>> >
>
>> > http://gdal.org/ogr__srs__api_8h.html
>
>> >
>
>> >
>
>> >
>
>> >
>
>> >
>
>> >
>
>> > Or starting there
>
>> >
>
>> >
>
>> >
>
>> >  
>> https://github.com/OSGeo/gdal/blob/trunk/gdal/ogr/ogr_srs_proj4.cpp#L616
>
>> >
>
>> >> And also found some that do no agree between GDAL and proj. For  
>> example
>
>> >>
>
>> >>
>
>> >>
>
>> >>
>
>> >>
>
>> >>
>
>> >>
>
>> >> echo 4.897 52.371 | proj +proj=vandg +ellps=WGS84 +units=m
>
>> >>
>
>> >>
>
>> >>
>
>> >> 489005.93       6431581.02
>
>> >>
>
>> >>
>
>> >>
>
>> >>
>
>> >>
>
>> >>
>
>> >>
>
>> >> gdaltransform -s_srs EPSG:4326 -t_srs "+proj=vandg +ellps=WGS84
>
>> >> +units=m"
>
>> >>
>
>> >>
>
>> >>
>
>> >> 4.897 52.371
>
>> >>
>
>> >>
>
>> >>
>
>> >> 488459.293282675 6424391.46347316 0
>
>> >
>
>> > If you add --debug on, you'll see that GDAL adds a +R_A parameter. I
>
>> > haven't dug up into history to >know the reason for that.
>
>> >
>
>> >
>
>> >
>
>> > If you add +wktext, the original string will be passed unmodified to
>
>> > proj.4
>
>> >
>
>> >
>
>> >
>
>> >
>
>> >
>
>> >
>
>> > Even
>
>> >
>
>> >
>
>> >
>
>> >
>
>> >
>
>> >
>
>> > --
>
>> >
>
>> >
>
>> > Spatialys - Geospatial professional services
>
>> >
>
>> >
>
>> >
>
>> > http://www.spatialys.com
>
>
>
> --
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170826/f2ce6f45/attachment-0001.html>

From jluis at ualg.pt  Sat Aug 26 16:02:35 2017
From: jluis at ualg.pt (Joaquim Luis)
Date: Sun, 27 Aug 2017 00:02:35 +0100
Subject: [gdal-dev] Which Proj.4 transforms are available in GDAL?
In-Reply-To: <9459999.8dFvGKNm6J@even-i700>
References: <op.y5hrr20edbaoe8@macmarilu> <9459999.8dFvGKNm6J@even-i700>
Message-ID: <op.y5loylebdbaoe8@macmarilu>


>
>
>> gdaltransform -s_srs EPSG:4326 -t_srs +proj=bonne
>
>
>
>> ERROR 6: Failed to initialize PROJ.4 with `+proj=bonne +lon_0=0 +lat_1=0
>
>
>
>> +x_0=0 +y_0=0 +ellps=WGS84 +units=m +no_defs'.
>
>
>
>>
>
>
>
>
>
>
> I thing the issue is that lat_1=0 is invalid for bonne. Any non zero  
> value is OK
>

Sorry Even, but it still fails

gdaltransform -s_srs EPSG:4326 -t_srs "+proj=bonne +lat_0=1 +wktext"
ERROR 6: Failed to initialize PROJ.4 with `+proj=bonne +lat_0=1 +wktext'.

And I'm facing some other issues with the +wktext.

This GMT using proj.4 via GDAL, and it works.

grdproject lixo.grd -J+proj=sinu -Glixo2.grd

but adding +wktext makes it fail in GDAL

grdproject lixo.grd -J"+proj=sinu +wktext" -Glixo2.grd
ERROR 6: Failed to initialize PROJ.4 with `+proj=sinu +wktext'

From even.rouault at spatialys.com  Sun Aug 27 01:39:07 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 27 Aug 2017 10:39:07 +0200
Subject: [gdal-dev] Which Proj.4 transforms are available in GDAL?
In-Reply-To: <op.y5loylebdbaoe8@macmarilu>
References: <op.y5hrr20edbaoe8@macmarilu> <9459999.8dFvGKNm6J@even-i700>
 <op.y5loylebdbaoe8@macmarilu>
Message-ID: <2323720.X9BydIyz9E@even-i700>

On dimanche 27 août 2017 00:02:35 CEST Joaquim Luis wrote:
> >> gdaltransform -s_srs EPSG:4326 -t_srs +proj=bonne
> >> 
> >> 
> >> 
> >> ERROR 6: Failed to initialize PROJ.4 with `+proj=bonne +lon_0=0 +lat_1=0
> >> 
> >> 
> >> 
> >> +x_0=0 +y_0=0 +ellps=WGS84 +units=m +no_defs'.
> > 
> > I thing the issue is that lat_1=0 is invalid for bonne. Any non zero
> > value is OK
> 
> Sorry Even, but it still fails
> 
> gdaltransform -s_srs EPSG:4326 -t_srs "+proj=bonne +lat_0=1 +wktext"
> ERROR 6: Failed to initialize PROJ.4 with `+proj=bonne +lat_0=1 +wktext'.

It is lat_1 which must be non zero.

> 
> And I'm facing some other issues with the +wktext.
> 
> This GMT using proj.4 via GDAL, and it works.
> 
> grdproject lixo.grd -J+proj=sinu -Glixo2.grd
> 
> but adding +wktext makes it fail in GDAL
> 
> grdproject lixo.grd -J"+proj=sinu +wktext" -Glixo2.grd
> ERROR 6: Failed to initialize PROJ.4 with `+proj=sinu +wktext'

Perhaps due to the lack of datum/ellipsoid, if you don't have a proj_def.dat file that will 
contain the implicit one

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170827/5ad6259d/attachment.html>

From andrea.aime at geo-solutions.it  Sun Aug 27 03:06:39 2017
From: andrea.aime at geo-solutions.it (Andrea Aime)
Date: Sun, 27 Aug 2017 12:06:39 +0200
Subject: [gdal-dev] Geopackage raster and empty tile matrix
Message-ID: <CA+nxMTsYYK1=f=sYaCmfB5KQm8fJg=aauXrLPtKANudTcm_UHw@mail.gmail.com>

Hi,
I've exported a TIFF to geopackage raster, and noticed that while the
exported data only cover
zoom level 7, the tile matrix definition ranges from 0 to 7.

>From the reader point of view, it seems that in order to get the
effectively populated tile
matrix levels one would have to run a select distinct on the zoom level in
the tile table,
which seems rather inefficient.

I checked the spec and while it demands a tile matrix spec for populated
levels, it does not
seem to require omitting it for non populated levels. Can you confirm?

I think I'm seeing in the code a check verifying that indeed at least one
tile is present before
listing a particular zoom level:

// In read-only mode, only lists non empty zoom levels
    else if( !bUpdate )
    {
        osSQL += CPLSPrintf(" AND EXISTS(SELECT 1 FROM %s WHERE zoom_level
= tm.zoom_level LIMIT 1)",
                            osQuotedTableName.c_str());
    }

Cheers
Andrea

==
GeoServer Professional Services from the experts! Visit http://goo.gl/it488V
for more information.
==

Ing. Andrea Aime
@geowolf
Technical Lead

GeoSolutions S.A.S.
Via di Montramito 3/A
55054  Massarosa (LU)
phone: +39 0584 962313
fax: +39 0584 1660272
mob: +39  339 8844549

http://www.geo-solutions.it
http://twitter.com/geosolutions_it

AVVERTENZE AI SENSI DEL D.Lgs. 196/2003

Le informazioni contenute in questo messaggio di posta elettronica e/o
nel/i file/s allegato/i sono da considerarsi strettamente riservate. Il
loro utilizzo è consentito esclusivamente al destinatario del messaggio,
per le finalità indicate nel messaggio stesso. Qualora riceviate questo
messaggio senza esserne il destinatario, Vi preghiamo cortesemente di
darcene notizia via e-mail e di procedere alla distruzione del messaggio
stesso, cancellandolo dal Vostro sistema. Conservare il messaggio stesso,
divulgarlo anche in parte, distribuirlo ad altri soggetti, copiarlo, od
utilizzarlo per finalità diverse, costituisce comportamento contrario ai
principi dettati dal D.Lgs. 196/2003.

The information in this message and/or attachments, is intended solely for
the attention and use of the named addressee(s) and may be confidential or
proprietary in nature or covered by the provisions of privacy act
(Legislative Decree June, 30 2003, no.196 - Italy's New Data Protection
Code).Any use not in accord with its purpose, any disclosure, reproduction,
copying, distribution, or either dissemination, either whole or partial, is
strictly forbidden except previous formal approval of the named
addressee(s). If you are not the intended recipient, please contact
immediately the sender by telephone, fax or e-mail and delete the
information in this message that has been received in error. The sender
does not give any warranty or accept liability as the content, accuracy or
completeness of sent messages and accepts no responsibility  for changes
made after they were sent or for other risks which arise as a result of
e-mail transmission, viruses, etc.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170827/335d4e12/attachment.html>

From even.rouault at spatialys.com  Sun Aug 27 03:47:57 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 27 Aug 2017 12:47:57 +0200
Subject: [gdal-dev] Geopackage raster and empty tile matrix
In-Reply-To: <CA+nxMTsYYK1=f=sYaCmfB5KQm8fJg=aauXrLPtKANudTcm_UHw@mail.gmail.com>
References: <CA+nxMTsYYK1=f=sYaCmfB5KQm8fJg=aauXrLPtKANudTcm_UHw@mail.gmail.com>
Message-ID: <75194549.T4GZ2JIPrd@even-i700>

Hi Andrea,

> Hi,
> I've exported a TIFF to geopackage raster, and noticed that while the
> exported data only cover
> zoom level 7, the tile matrix definition ranges from 0 to 7.
> 
> From the reader point of view, it seems that in order to get the
> effectively populated tile
> matrix levels one would have to run a select distinct on the zoom level in
> the tile table,
> which seems rather inefficient.
> 
> I checked the spec and while it demands a tile matrix spec for populated
> levels, it does not
> seem to require omitting it for non populated levels. Can you confirm?

Yes that's my understanding too that gpkg_tile_matrix can be instanciated at zoom levels for 
which there is actually no tile in the pyramid table. I guess I did this choice betcause I wasn't 
sure how to interpret the requirement for consecutive zoom levels differing by a factor of 2, 
and thus chose to pre-create all zoom levels from level 0 to level N. This is also slightly more 
convenient in update mode if you want to add tiles at low zoom levels: you just have to insert 
them into the pyramid table.

> 
> I think I'm seeing in the code a check verifying that indeed at least one
> tile is present before
> listing a particular zoom level:
> 
> // In read-only mode, only lists non empty zoom levels
>     else if( !bUpdate )
>     {
>         osSQL += CPLSPrintf(" AND EXISTS(SELECT 1 FROM %s WHERE zoom_level
> = tm.zoom_level LIMIT 1)",
>                             osQuotedTableName.c_str());
>     }
> 

Yes that's the request to find which zoom levels are actually populated so as to find the 
highest zoom level (the base level used to compute the raster dimensions) and the populated 
overviews. I would expect this request to be not that inefficient since the pyramid table has 
an index on (zoom_level, tile_column, tile_row), thus finding if at least one tile exists at a 
zoom level should only involve looking at the index.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170827/3c2de48c/attachment-0001.html>

From schut at satelligence.com  Mon Aug 28 03:20:12 2017
From: schut at satelligence.com (Vincent Schut)
Date: Mon, 28 Aug 2017 12:20:12 +0200
Subject: [gdal-dev] vrt: prevent opening all source files on open?
Message-ID: <af99197b-60a9-f14e-e85c-6396c97e64fb@satelligence.com>

Hi,

Is there a way (or: what are the prerequisites) to avoid gdal opening 
all source files from a vrt on opening the vrt?

Context: I have created a large vrt, referencing many tif files. Both 
the vrt and tifs are remote (using /vsigs/). It works, but opening (e.g. 
running gdalinfo) is very slow.

I have a comparable vrt where the main difference is that it references 
.hgt files instead of tifs. Running gdalinfo on this vrt is almost 
instantaneous.

As there are no other significant differences otherwise, I wonder if 
this is because if the vrt machinery encounters a tif, it starts to 
check if there are any accompanying overviews (or other important 
metadata), while it does not do that for a .hgt file? Or is there a 
different reason? And how can I prevent this (without, preferably, 
changing to a different source file format)?

Thanks,
Vincent.


From even.rouault at spatialys.com  Mon Aug 28 03:30:51 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 28 Aug 2017 12:30:51 +0200
Subject: [gdal-dev] vrt: prevent opening all source files on open?
In-Reply-To: <af99197b-60a9-f14e-e85c-6396c97e64fb@satelligence.com>
References: <af99197b-60a9-f14e-e85c-6396c97e64fb@satelligence.com>
Message-ID: <4762234.0vLgkjDnqZ@even-i700>

Vincent,

http://gdal.org/gdal_vrttut.html should help:

"""Some characteristics of the source band can be specified in the optional SourceProperties 
tag to enable the VRT driver to differ the opening of the source dataset until it really needs 
to read data from it. This is particularly useful when building VRTs with a big number of 
source datasets. The needed parameters are the raster dimensions, the size of the blocks and 
the data type. If the SourceProperties tag is not present, the source dataset will be opened 
at the same time as the VRT itself.

[...]

<SimpleSource>
<SourceFilename relativeToVRT="1">utm.tif</SourceFilename>
<SourceBand>1</SourceBand>
<SourceProperties RasterXSize="512" RasterYSize="512" DataType="Byte" BlockXSize="128" 
BlockYSize="128"/>
<SrcRect xOff="0" yOff="0" xSize="512" ySize="512"/>
<DstRect xOff="0" yOff="0" xSize="512" ySize="512"/>
</SimpleSource>
"""

Note: in theory, the VRT driver could be improved to implement this lazy opening behaviour 
without requiring SourceProperties, but until/if this is implemented some day, you have to 
use SourceProperties.

Even



> Hi,
> 
> Is there a way (or: what are the prerequisites) to avoid gdal opening
> all source files from a vrt on opening the vrt?
> 
> Context: I have created a large vrt, referencing many tif files. Both
> the vrt and tifs are remote (using /vsigs/). It works, but opening (e.g.
> running gdalinfo) is very slow.
> 
> I have a comparable vrt where the main difference is that it references
> .hgt files instead of tifs. Running gdalinfo on this vrt is almost
> instantaneous.
> 
> As there are no other significant differences otherwise, I wonder if
> this is because if the vrt machinery encounters a tif, it starts to
> check if there are any accompanying overviews (or other important
> metadata), while it does not do that for a .hgt file? Or is there a
> different reason? And how can I prevent this (without, preferably,
> changing to a different source file format)?
> 
> Thanks,
> Vincent.
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170828/55a96058/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Mon Aug 28 04:30:00 2017
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Mon, 28 Aug 2017 11:30:00 +0000
Subject: [gdal-dev] Geopackage raster and COPY_SRC_OVERVIEWS
Message-ID: <5897711b48e64d86990871293887b9be@C119S212VM042.msvyvi.vaha.local>

Hi,


I wonder if it could be feasible to support similar COPY_SRC_OVERVIEWS option than GeoTIFF driver does for existing overview levels which match with the power of two series. Some people have constructed GeoTIFFs or virtual VRT rasters which have overviews from different raster sources (raster maps with different rendering according to the scale) and gdaladdo can't generate such overviews from the best resolution level.



-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170828/157b5e34/attachment.html>

From schut at satelligence.com  Mon Aug 28 04:36:36 2017
From: schut at satelligence.com (Vincent Schut)
Date: Mon, 28 Aug 2017 13:36:36 +0200
Subject: [gdal-dev] vrt: prevent opening all source files on open?
In-Reply-To: <4762234.0vLgkjDnqZ@even-i700>
References: <af99197b-60a9-f14e-e85c-6396c97e64fb@satelligence.com>
 <4762234.0vLgkjDnqZ@even-i700>
Message-ID: <48514e2d-3edd-1f65-0838-1ddc226226bd@satelligence.com>

On 08/28/2017 12:30 PM, Even Rouault wrote:
>
> Vincent,
>
> http://gdal.org/gdal_vrttut.html should help:
>
> """Some characteristics of the source band can be specified in the 
> optional SourceProperties tag to enable the VRT driver to differ the 
> opening of the source dataset until it really needs to read data from 
> it. This is particularly useful when building VRTs with a big number 
> of source datasets. The needed parameters are the raster dimensions, 
> the size of the blocks and the data type. If the SourceProperties tag 
> is not present, the source dataset will be opened at the same time as 
> the VRT itself.
>
> [...]
>
> <SimpleSource>
>
> <SourceFilename relativeToVRT="1">utm.tif</SourceFilename>
>
> <SourceBand>1</SourceBand>
>
> <SourceProperties RasterXSize="512" RasterYSize="512" DataType="Byte" 
> BlockXSize="128" BlockYSize="128"/>
>
> <SrcRect xOff="0" yOff="0" xSize="512" ySize="512"/>
>
> <DstRect xOff="0" yOff="0" xSize="512" ySize="512"/>
>
> </SimpleSource>
>
> """
>
> Note: in theory, the VRT driver could be improved to implement this 
> lazy opening behaviour without requiring SourceProperties, but 
> until/if this is implemented some day, you have to use SourceProperties.
>
> Even
>
Unfortunately, it's more complex. Both vrt's have SourceProperties tags 
for each source.
I did another experiment to test if it is .hgt versus .tif, and it 
appears to be something else: I removed all but one of the ComplexSource 
items from each. Now both of them appear to try to open the source raster.

The vrt which apparently does not open it's sources is this one: 
https://cloud.sdsc.edu/v1/AUTH_opentopography/Raster/SRTM_GL1/SRTM_GL1_srtm.vrt
Even opening that with /vsicurl/ is fast.
Copying this vrt locally (and thus invalidating the source paths) works 
and does not result in a read error. Remove all but one of the 
ComplexSource elements, and I get an error on running gdalinfo on it 
(because it cannot find the source raster). I'm stumped...

sorry, have to go to a meeting now. More later.

thanks!
Vincent.

> > Hi,
>
> >
>
> > Is there a way (or: what are the prerequisites) to avoid gdal opening
>
> > all source files from a vrt on opening the vrt?
>
> >
>
> > Context: I have created a large vrt, referencing many tif files. Both
>
> > the vrt and tifs are remote (using /vsigs/). It works, but opening (e.g.
>
> > running gdalinfo) is very slow.
>
> >
>
> > I have a comparable vrt where the main difference is that it references
>
> > .hgt files instead of tifs. Running gdalinfo on this vrt is almost
>
> > instantaneous.
>
> >
>
> > As there are no other significant differences otherwise, I wonder if
>
> > this is because if the vrt machinery encounters a tif, it starts to
>
> > check if there are any accompanying overviews (or other important
>
> > metadata), while it does not do that for a .hgt file? Or is there a
>
> > different reason? And how can I prevent this (without, preferably,
>
> > changing to a different source file format)?
>
> >
>
> > Thanks,
>
> > Vincent.
>
> >
>
> > _______________________________________________
>
> > gdal-dev mailing list
>
> > gdal-dev at lists.osgeo.org
>
> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- 
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170828/45aff6bb/attachment-0001.html>

From even.rouault at spatialys.com  Mon Aug 28 04:51:39 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 28 Aug 2017 13:51:39 +0200
Subject: [gdal-dev] vrt: prevent opening all source files on open?
In-Reply-To: <48514e2d-3edd-1f65-0838-1ddc226226bd@satelligence.com>
References: <af99197b-60a9-f14e-e85c-6396c97e64fb@satelligence.com>
 <4762234.0vLgkjDnqZ@even-i700>
 <48514e2d-3edd-1f65-0838-1ddc226226bd@satelligence.com>
Message-ID: <1791259.BXm8dDWcUm@even-i700>

On lundi 28 août 2017 13:36:36 CEST Vincent Schut wrote:
> On 08/28/2017 12:30 PM, Even Rouault wrote:
> > Vincent,
> > 
> > http://gdal.org/gdal_vrttut.html should help:
> > 
> > """Some characteristics of the source band can be specified in the
> > optional SourceProperties tag to enable the VRT driver to differ the
> > opening of the source dataset until it really needs to read data from
> > it. This is particularly useful when building VRTs with a big number
> > of source datasets. The needed parameters are the raster dimensions,
> > the size of the blocks and the data type. If the SourceProperties tag
> > is not present, the source dataset will be opened at the same time as
> > the VRT itself.
> > 
> > [...]
> > 
> > <SimpleSource>
> > 
> > <SourceFilename relativeToVRT="1">utm.tif</SourceFilename>
> > 
> > <SourceBand>1</SourceBand>
> > 
> > <SourceProperties RasterXSize="512" RasterYSize="512" DataType="Byte"
> > BlockXSize="128" BlockYSize="128"/>
> > 
> > <SrcRect xOff="0" yOff="0" xSize="512" ySize="512"/>
> > 
> > <DstRect xOff="0" yOff="0" xSize="512" ySize="512"/>
> > 
> > </SimpleSource>
> > 
> > """
> > 
> > Note: in theory, the VRT driver could be improved to implement this
> > lazy opening behaviour without requiring SourceProperties, but
> > until/if this is implemented some day, you have to use SourceProperties.
> > 
> > Even
> 
> Unfortunately, it's more complex. Both vrt's have SourceProperties tags
> for each source.
> I did another experiment to test if it is .hgt versus .tif, and it
> appears to be something else: I removed all but one of the ComplexSource
> items from each. Now both of them appear to try to open the source raster.
> 
> The vrt which apparently does not open it's sources is this one:
> https://cloud.sdsc.edu/v1/AUTH_opentopography/Raster/SRTM_GL1/SRTM_GL1_srtm.
> vrt Even opening that with /vsicurl/ is fast.
> Copying this vrt locally (and thus invalidating the source paths) works
> and does not result in a read error. Remove all but one of the
> ComplexSource elements, and I get an error on running gdalinfo on it
> (because it cannot find the source raster). I'm stumped...
> 
> sorry, have to go to a meeting now. More later.

Oh I see. There are particular code paths in the case where we have a VRT made of a single 
source for optimization. For example for doing multi-band at once RasterIO operations. Or 
GetOverviewCount() will call the source GetOverviewCount() to expose them at the VRT 
level. Normally only GDALOpen() on such VRT shouldn't cause the source to be opened. So I'd 
suspect you've a call to GetOverviewCount()

A way of workarounding this is to add a fake source such as

    <ComplexSource>
        <SourceFilename>/dev/null</SourceFilename>
        <SourceBand>1</SourceBand>
        <SourceProperties RasterXSize="1" RasterYSize="1" DataType="Byte" BlockXSize="1" 
BlockYSize="1" />
        <SrcRect xOff="0" yOff="0" xSize="0" ySize="0" />
        <DstRect xOff="0" yOff="0" xSize="0" ySize="0" />
    </ComplexSource>


> 
> thanks!
> Vincent.
> 
> > > Hi,
> > > 
> > > 
> > > 
> > > Is there a way (or: what are the prerequisites) to avoid gdal opening
> > > 
> > > all source files from a vrt on opening the vrt?
> > > 
> > > 
> > > 
> > > Context: I have created a large vrt, referencing many tif files. Both
> > > 
> > > the vrt and tifs are remote (using /vsigs/). It works, but opening (e.g.
> > > 
> > > running gdalinfo) is very slow.
> > > 
> > > 
> > > 
> > > I have a comparable vrt where the main difference is that it references
> > > 
> > > .hgt files instead of tifs. Running gdalinfo on this vrt is almost
> > > 
> > > instantaneous.
> > > 
> > > 
> > > 
> > > As there are no other significant differences otherwise, I wonder if
> > > 
> > > this is because if the vrt machinery encounters a tif, it starts to
> > > 
> > > check if there are any accompanying overviews (or other important
> > > 
> > > metadata), while it does not do that for a .hgt file? Or is there a
> > > 
> > > different reason? And how can I prevent this (without, preferably,
> > > 
> > > changing to a different source file format)?
> > > 
> > > 
> > > 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170828/b7628f5b/attachment-0001.html>

From even.rouault at spatialys.com  Mon Aug 28 05:02:34 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 28 Aug 2017 14:02:34 +0200
Subject: [gdal-dev] Geopackage raster and COPY_SRC_OVERVIEWS
In-Reply-To: <5897711b48e64d86990871293887b9be@C119S212VM042.msvyvi.vaha.local>
References: <5897711b48e64d86990871293887b9be@C119S212VM042.msvyvi.vaha.local>
Message-ID: <9173260.TJRuA24nU6@even-i700>

On lundi 28 août 2017 11:30:00 CEST Rahkonen Jukka (MML) wrote:
> Hi,
> 
> 
> I wonder if it could be feasible to support similar COPY_SRC_OVERVIEWS
> option than GeoTIFF driver does for existing overview levels which match
> with the power of two series. Some people have constructed GeoTIFFs or
> virtual VRT rasters which have overviews from different raster sources
> (raster maps with different rendering according to the scale) and gdaladdo
> can't generate such overviews from the best resolution level.

That's certainly doable (pending someone actually implementing it) and probably something 
that could be generalized at the gdal_translate level

In the meantime, you can achieve a similar result with for example gdalwarp (in update 
mode) and using the GPKG ZOOM_LEVEL open option.

Example:

- gdal_translate small_world.tif small_world.gpkg -of gpkg
(the full resolution data is at zoom level 1)

- gdal_translate small_world.tif ovr.tif -outsize 50% 50% -scale 0 255 127 255
(create a brighter overview)

- gdalwarp ovr.tif small_world.gpkg -doo ZOOM_LEVEL=0
(populate zoom_level=0, ie first overview level, with the content of this file)

The above can be generalized too as many overviews as needed. You may need to use the -
ovr switch of gdalwarp to select the appropriate source overview.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170828/6984bed3/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Mon Aug 28 05:24:10 2017
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Mon, 28 Aug 2017 12:24:10 +0000
Subject: [gdal-dev] Geopackage raster and COPY_SRC_OVERVIEWS
Message-ID: <95a0847709d34e9c83f74368ae9c672e@C119S212VM042.msvyvi.vaha.local>

Hi Even,

Thank you for the advice. I thought a bit further and mixed-source overviews are also common in tile cache storages (MapCache, MapProxy) or when GeoPackage is used as an outputformat for WMS (GeoServer). There seems to be some need for having an easy general method for copying overviews. Let's see if someone appears with funding or just implements it.

-Jukka-

Lähettäjä: Even Rouault [mailto:even.rouault at spatialys.com]
Lähetetty: 28. elokuuta 2017 15:03
Vastaanottaja: gdal-dev at lists.osgeo.org
Kopio: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Aihe: Re: [gdal-dev] Geopackage raster and COPY_SRC_OVERVIEWS


On lundi 28 août 2017 11:30:00 CEST Rahkonen Jukka (MML) wrote:

> Hi,

>

>

> I wonder if it could be feasible to support similar COPY_SRC_OVERVIEWS

> option than GeoTIFF driver does for existing overview levels which match

> with the power of two series. Some people have constructed GeoTIFFs or

> virtual VRT rasters which have overviews from different raster sources

> (raster maps with different rendering according to the scale) and gdaladdo

> can't generate such overviews from the best resolution level.



That's certainly doable (pending someone actually implementing it) and probably something that could be generalized at the gdal_translate level



In the meantime, you can achieve a similar result with for example gdalwarp (in update mode) and using the GPKG ZOOM_LEVEL open option.



Example:



- gdal_translate small_world.tif small_world.gpkg -of gpkg

(the full resolution data is at zoom level 1)



- gdal_translate small_world.tif ovr.tif -outsize 50% 50% -scale 0 255 127 255

(create a brighter overview)



- gdalwarp ovr.tif small_world.gpkg -doo ZOOM_LEVEL=0

(populate zoom_level=0, ie first overview level, with the content of this file)



The above can be generalized too as many overviews as needed. You may need to use the -ovr switch of gdalwarp to select the appropriate source overview.



Even



--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170828/66b07ca6/attachment.html>

From schut at satelligence.com  Mon Aug 28 05:48:39 2017
From: schut at satelligence.com (Vincent Schut)
Date: Mon, 28 Aug 2017 14:48:39 +0200
Subject: [gdal-dev] vrt: prevent opening all source files on open?
In-Reply-To: <1791259.BXm8dDWcUm@even-i700>
References: <af99197b-60a9-f14e-e85c-6396c97e64fb@satelligence.com>
 <4762234.0vLgkjDnqZ@even-i700>
 <48514e2d-3edd-1f65-0838-1ddc226226bd@satelligence.com>
 <1791259.BXm8dDWcUm@even-i700>
Message-ID: <fb56618f-99fc-7ed8-76ec-901922d65cd7@satelligence.com>

On 08/28/2017 01:51 PM, Even Rouault wrote:
>
> On lundi 28 août 2017 13:36:36 CEST Vincent Schut wrote:
>
> > On 08/28/2017 12:30 PM, Even Rouault wrote:
>
> > > Vincent,
>
> > >
>
> > > http://gdal.org/gdal_vrttut.html should help:
>
> > >
>
> > > """Some characteristics of the source band can be specified in the
>
> > > optional SourceProperties tag to enable the VRT driver to differ the
>
> > > opening of the source dataset until it really needs to read data from
>
> > > it. This is particularly useful when building VRTs with a big number
>
> > > of source datasets. The needed parameters are the raster dimensions,
>
> > > the size of the blocks and the data type. If the SourceProperties tag
>
> > > is not present, the source dataset will be opened at the same time as
>
> > > the VRT itself.
>
> > >
>
> > > [...]
>
> > >
>
> > > <SimpleSource>
>
> > >
>
> > > <SourceFilename relativeToVRT="1">utm.tif</SourceFilename>
>
> > >
>
> > > <SourceBand>1</SourceBand>
>
> > >
>
> > > <SourceProperties RasterXSize="512" RasterYSize="512" DataType="Byte"
>
> > > BlockXSize="128" BlockYSize="128"/>
>
> > >
>
> > > <SrcRect xOff="0" yOff="0" xSize="512" ySize="512"/>
>
> > >
>
> > > <DstRect xOff="0" yOff="0" xSize="512" ySize="512"/>
>
> > >
>
> > > </SimpleSource>
>
> > >
>
> > > """
>
> > >
>
> > > Note: in theory, the VRT driver could be improved to implement this
>
> > > lazy opening behaviour without requiring SourceProperties, but
>
> > > until/if this is implemented some day, you have to use 
> SourceProperties.
>
> > >
>
> > > Even
>
> >
>
> > Unfortunately, it's more complex. Both vrt's have SourceProperties tags
>
> > for each source.
>
> > I did another experiment to test if it is .hgt versus .tif, and it
>
> > appears to be something else: I removed all but one of the ComplexSource
>
> > items from each. Now both of them appear to try to open the source 
> raster.
>
> >
>
> > The vrt which apparently does not open it's sources is this one:
>
> > 
> https://cloud.sdsc.edu/v1/AUTH_opentopography/Raster/SRTM_GL1/SRTM_GL1_srtm.
>
> > vrt Even opening that with /vsicurl/ is fast.
>
> > Copying this vrt locally (and thus invalidating the source paths) works
>
> > and does not result in a read error. Remove all but one of the
>
> > ComplexSource elements, and I get an error on running gdalinfo on it
>
> > (because it cannot find the source raster). I'm stumped...
>
> >
>
> > sorry, have to go to a meeting now. More later.
>
> Oh I see. There are particular code paths in the case where we have a 
> VRT made of a single source for optimization. For example for doing 
> multi-band at once RasterIO operations. Or GetOverviewCount() will 
> call the source GetOverviewCount() to expose them at the VRT level. 
> Normally only GDALOpen() on such VRT shouldn't cause the source to be 
> opened. So I'd suspect you've a call to GetOverviewCount()
>
> A way of workarounding this is to add a fake source such as
>
> <ComplexSource>
>
> <SourceFilename>/dev/null</SourceFilename>
>
> <SourceBand>1</SourceBand>
>
> <SourceProperties RasterXSize="1" RasterYSize="1" DataType="Byte" 
> BlockXSize="1" BlockYSize="1" />
>
> <SrcRect xOff="0" yOff="0" xSize="0" ySize="0" />
>
> <DstRect xOff="0" yOff="0" xSize="0" ySize="0" />
>
> </ComplexSource>
>
Ah, thanks Even, that works!

> >
>
> > thanks!
>
> > Vincent.
>
> >
>
> > > > Hi,
>
> > > >
>
> > > >
>
> > > >
>
> > > > Is there a way (or: what are the prerequisites) to avoid gdal 
> opening
>
> > > >
>
> > > > all source files from a vrt on opening the vrt?
>
> > > >
>
> > > >
>
> > > >
>
> > > > Context: I have created a large vrt, referencing many tif files. 
> Both
>
> > > >
>
> > > > the vrt and tifs are remote (using /vsigs/). It works, but 
> opening (e.g.
>
> > > >
>
> > > > running gdalinfo) is very slow.
>
> > > >
>
> > > >
>
> > > >
>
> > > > I have a comparable vrt where the main difference is that it 
> references
>
> > > >
>
> > > > .hgt files instead of tifs. Running gdalinfo on this vrt is almost
>
> > > >
>
> > > > instantaneous.
>
> > > >
>
> > > >
>
> > > >
>
> > > > As there are no other significant differences otherwise, I wonder if
>
> > > >
>
> > > > this is because if the vrt machinery encounters a tif, it starts to
>
> > > >
>
> > > > check if there are any accompanying overviews (or other important
>
> > > >
>
> > > > metadata), while it does not do that for a .hgt file? Or is there a
>
> > > >
>
> > > > different reason? And how can I prevent this (without, preferably,
>
> > > >
>
> > > > changing to a different source file format)?
>
> > > >
>
> > > >
>
> > > >
>
> > > > Thanks,
>
> > > >
>
> > > > Vincent.
>
> > > >
>
> > > >
>
> > > >
>
> > > > _______________________________________________
>
> > > >
>
> > > > gdal-dev mailing list
>
> > > >
>
> > > > gdal-dev at lists.osgeo.org
>
> > > >
>
> > > > https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> > >
>
> > > Spatialys - Geospatial professional services
>
> > >
>
> > > http://www.spatialys.com
>
> -- 
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170828/51d2c620/attachment-0001.html>

From FeldM at imsweb.com  Mon Aug 28 09:08:27 2017
From: FeldM at imsweb.com (Feld, Michael (IMS))
Date: Mon, 28 Aug 2017 16:08:27 +0000
Subject: [gdal-dev] gdal-2.2.1 build failure
Message-ID: <3c717f8a77e744d295d9770a2907ec80@THALASSA.omni.imsweb.com>

Hi, I am trying to build gdal-2.2.1 on CentOS 6.9 and I am getting the below build failure message. I did not experience this with gdal-2.2.0 in the past. I have jasper-devel-1.900.1-21.el6_9.x86_64 installed. Does anyone have any tips or suggestions? Thanks

/usr/include/jasper/jas_math.h: In function 'bool jas_safe_size_mul(size_t, size_t, size_t*)':
/usr/include/jasper/jas_math.h:143:15: error: 'SIZE_MAX' was not declared in this scope
/usr/include/jasper/jas_math.h: In function 'bool jas_safe_size_add(size_t, size_t, size_t*)':
/usr/include/jasper/jas_math.h:170:10: error: 'SIZE_MAX' was not declared in this scope
make[2]: *** [../o/jpeg2000dataset.lo] Error 1
make[2]: Leaving directory `/usr/local/src/gdal-2.2.1/frmts/jpeg2000'
make[1]: *** [jpeg2000-install-obj] Error 2
make[1]: Leaving directory `/usr/local/src/gdal-2.2.1/frmts'
make: *** [frmts-target] Error 2



________________________________

Information in this e-mail may be confidential. It is intended only for the addressee(s) identified above. If you are not the addressee(s), or an employee or agent of the addressee(s), please note that any dissemination, distribution, or copying of this communication is strictly prohibited. If you have received this e-mail in error, please notify the sender of the error.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170828/8dc9195b/attachment.html>

From even.rouault at spatialys.com  Mon Aug 28 09:19:45 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 28 Aug 2017 18:19:45 +0200
Subject: [gdal-dev] gdal-2.2.1 build failure
In-Reply-To: <3c717f8a77e744d295d9770a2907ec80@THALASSA.omni.imsweb.com>
References: <3c717f8a77e744d295d9770a2907ec80@THALASSA.omni.imsweb.com>
Message-ID: <9582223.rdbvKq1IKd@even-i700>

On lundi 28 août 2017 16:08:27 CEST Feld, Michael (IMS) wrote:
> Hi, I am trying to build gdal-2.2.1 on CentOS 6.9 and I am getting the below
> build failure message. I did not experience this with gdal-2.2.0 in the
> past. I have jasper-devel-1.900.1-21.el6_9.x86_64 installed. Does anyone
> have any tips or suggestions? Thanks
> 
> /usr/include/jasper/jas_math.h: In function 'bool jas_safe_size_mul(size_t,
> size_t, size_t*)': /usr/include/jasper/jas_math.h:143:15: error: 'SIZE_MAX'
> was not declared in this scope /usr/include/jasper/jas_math.h: In function
> 'bool jas_safe_size_add(size_t, size_t, size_t*)':
> /usr/include/jasper/jas_math.h:170:10: error: 'SIZE_MAX' was not declared
> in this scope make[2]: *** [../o/jpeg2000dataset.lo] Error 1
> make[2]: Leaving directory `/usr/local/src/gdal-2.2.1/frmts/jpeg2000'
> make[1]: *** [jpeg2000-install-obj] Error 2
> make[1]: Leaving directory `/usr/local/src/gdal-2.2.1/frmts'
> make: *** [frmts-target] Error 2

Michael,

this has been fixed in the 2.2 branch (post 2.2.1) per
https://trac.osgeo.org/gdal/ticket/6951

(I believe the issue would also be reproduced with GDAL 2.2.0, if you compiled it against the 
newer jasper-devel package)

Even

> 
> 
> 
> ________________________________
> 
> Information in this e-mail may be confidential. It is intended only for the
> addressee(s) identified above. If you are not the addressee(s), or an
> employee or agent of the addressee(s), please note that any dissemination,
> distribution, or copying of this communication is strictly prohibited. If
> you have received this e-mail in error, please notify the sender of the
> error.


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170828/cbace6cd/attachment.html>

From jluis at ualg.pt  Mon Aug 28 09:25:55 2017
From: jluis at ualg.pt (Joaquim Luis)
Date: Mon, 28 Aug 2017 17:25:55 +0100
Subject: [gdal-dev] Which Proj.4 transforms are available in GDAL?
In-Reply-To: <2323720.X9BydIyz9E@even-i700>
References: <op.y5hrr20edbaoe8@macmarilu> <9459999.8dFvGKNm6J@even-i700>
 <op.y5loylebdbaoe8@macmarilu> <2323720.X9BydIyz9E@even-i700>
Message-ID: <op.y5ovxhmldbaoe8@macmarilu>



>>> gdaltransform -s_srs EPSG:4326 -t_srs "+proj=bonne +lat_0=1 +wktext"
>
>> ERROR 6: Failed to initialize PROJ.4 with `+proj=bonne +lat_0=1  
>> +wktext'.
>
>
> It is lat_1 which must be non zero.
>
>
>> grdproject lixo.grd -J"+proj=sinu +wktext" -Glixo2.grd
>
>> ERROR 6: Failed to initialize PROJ.4 with `+proj=sinu +wktext'
>
>
> Perhaps due to the lack of datum/ellipsoid, if you don't have a  
> proj_def.dat file that will contain the implicit one

Thanks. That was the case(s)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170828/a4310b2c/attachment.html>

From even.rouault at spatialys.com  Mon Aug 28 10:40:31 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 28 Aug 2017 19:40:31 +0200
Subject: [gdal-dev] Fwd: [OpenJPEG] OpenJPEG 2.2.0 is out ! Faster and
	safer.
In-Reply-To: <BN6PR11MB1873EEEC2E8A977A19E9282DDD9E0@BN6PR11MB1873.namprd11.prod.outlook.com>
References: <BN6PR11MB1873652B8BA21286FA3CC4DBDD8F0@BN6PR11MB1873.namprd11.prod.outlook.com>
 <BN6PR11MB1873C1368E7ECEE41334B462DD8C0@BN6PR11MB1873.namprd11.prod.outlook.com>
 <BN6PR11MB1873EEEC2E8A977A19E9282DDD9E0@BN6PR11MB1873.namprd11.prod.outlook.com>
Message-ID: <1572882.tlT0Nb93G5@even-i700>

Hi,

> 
> 
> I rebuilt GDAL (older version: 2.1.2) using this new open jpeg 2.2.0
> (https://github.com/uclouvain/openjpeg/releases/download/v2.2.0/openjpeg-v2
> .2.0-linux-x86_64.tar.gz)
> 
> and tried to convert two jp2 dataset to tiff (gdal_translate):
> 
> - bluemarble_4km.jp2: (10800 x 5400 pixels). 37.3 mb file size.
> 
> - usgsLanSat.jp2: (8627 x 7745 pixels). 48 mb file size.

Do you know if they use JPEG2000 tiling ?

> 
> 
> Tests were run on virtual machine with ‘Ubuntu 16.04’ operation system, 18
> gb RAM and 2 CPU processors.
> 

> 
> These results were not expected since the new openJpeg should be faster than
> the previous one. Could this be cause by 'gdal_translate' not using threads
> that the new openjpeg uses for performance boost ?

By default, GDAL will now enable openjpeg thread support. So you need to set the 
OPJ_NUM_THREADS environment variable. That said, you should already get significant 
performance improvements even without enabling multi-threading. I'm not sure why you 
don't get them.

I'd be interested if you could share those images.

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170828/5c4fe764/attachment-0001.html>

From even.rouault at spatialys.com  Mon Aug 28 11:55:59 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 28 Aug 2017 20:55:59 +0200
Subject: [gdal-dev] Fwd: [OpenJPEG] OpenJPEG 2.2.0 is out ! Faster and
	safer.
In-Reply-To: <BN6PR11MB187314CC025C0F391BEC06ECDD9E0@BN6PR11MB1873.namprd11.prod.outlook.com>
References: <BN6PR11MB1873652B8BA21286FA3CC4DBDD8F0@BN6PR11MB1873.namprd11.prod.outlook.com>
 <1572882.tlT0Nb93G5@even-i700>
 <BN6PR11MB187314CC025C0F391BEC06ECDD9E0@BN6PR11MB1873.namprd11.prod.outlook.com>
Message-ID: <2074557.G53rZ0Dsuq@even-i700>

On lundi 28 août 2017 18:00:03 CEST N. Farah wrote:
> Thanks Even for the quick response. I'll give it a try with setting
> OPJ_NUM_THREADS env variable to 8. Does it need to be used with
> GDAL_NUM_THREADS ? Any url to read about those two env variables ?
> 
> 

I've added some documentation per
https://trac.osgeo.org/gdal/changeset/39954


> The two dataset i used:
> 
> <http://data.opengee.org/FusionTutorial-Full.tar.gz>
> 
> https://1drv.ms/u/s!AkFDoDHsFe7_hkBS6GbG4xMqnk6t<http://data.opengee.org/Fus
> ionTutorial-Full.tar.gz>
> https://1drv.ms/u/s!AkFDoDHsFe7_hkG1-XDo7UztsPoC<http://data.opengee.org/Fu
> sionTutorial-Full.tar.gz>

Those images are single-tiled, so the GDAL_NUM_THREADS optimization will not help for 
them, and current openjpeg versions are super inefficient on those use cases, as GDAL 
expose a pseudo tiling to avoid a super big tile size, which cause the whole image to be 
decoded multiple times. I'm currently working on improving subtile decoding, that will 
substantially improve performance for such images (first steps are already in openjpeg 
master, next to follow)

I didn't have the patience to convert the whole image, so just took 3 GDAL blocks of 
1024x1024
Without threading support, on hot runs:

gdal_translate bluemarble_4km.jp2 out.tif -srcwin 0 0 3072 1024

35.1 s  GDAL 2.2 / openjpeg 2.1.2
26.2 s  GDAL 2.2 / openjpeg 2.2.0

So I do see an improvement. Not sure why you don't.

Hardware: Intel(R) Core(TM) i7-6700HQ CPU @ 2.60GHz
OS: Ubuntu 16.04, 64bit build


and as a teaser:
3.1 s   GDAL 2.2 / openjpeg master
1.5 s   GDAL 2.2 / openjpeg (my work-in-progress branch)

With 8 threads:
9.9 s  GDAL 2.2 / openjpeg 2.2.0
2.3 s  GDAL 2.2 / openjpeg master
0.9 s  GDAL 2.2 / openjpeg (my work-in-progress branch)



With usgsLanSat.jp2

gdal_translate usgsLanSat.jp2 out.tif -srcwin 0 0 3072 1024

40.2 s  GDAL 2.2 / openjpeg 2.1.2
32.3 s  GDAL 2.2 / openjpeg 2.2.0

> 
> p.s: i'm using GDAL 2.1.2

GDAL 2.1 or 2.2 should have comparable performances on this, I think

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170828/ebf0df0e/attachment.html>

From even.rouault at spatialys.com  Mon Aug 28 12:47:34 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 28 Aug 2017 21:47:34 +0200
Subject: [gdal-dev] Fwd: [OpenJPEG] OpenJPEG 2.2.0 is out ! Faster and
	safer.
In-Reply-To: <BN6PR11MB1873AB725AA8BAD67478C9F0DD9E0@BN6PR11MB1873.namprd11.prod.outlook.com>
References: <BN6PR11MB1873652B8BA21286FA3CC4DBDD8F0@BN6PR11MB1873.namprd11.prod.outlook.com>
 <2074557.G53rZ0Dsuq@even-i700>
 <BN6PR11MB1873AB725AA8BAD67478C9F0DD9E0@BN6PR11MB1873.namprd11.prod.outlook.com>
Message-ID: <1609789.Zmy37CO916@even-i700>

On lundi 28 août 2017 19:36:16 CEST N. Farah wrote:
> Thanks Even for updating the doc and also running some perf testing using
> those datasets.
> 
> 
> The results you get when enabling multi-threading are very interesting: 26.s
> to 9.9 s. Then using the work in progress you end up with 1s. Basically a
> 26 times speed improvement.
> 
> 
> Is there a timeline for releasing next version of openJpeg (either master or
> work in progress).

Probably in a few weeks

> 
> 
> Are there shared jp2 dataset you're using for performance benchmark ?
> 

There's a basic benchmarking suite here
https://github.com/uclouvain/openjpeg/tree/master/tests/performance
referencing datasets in
https://github.com/uclouvain/openjpeg-data
but it is not necessarily complete.

> 
> Noureddine
> 
> 
> ________________________________
> From: Even Rouault <even.rouault at spatialys.com>
> Sent: Monday, August 28, 2017 2:55 PM
> To: N. Farah
> Cc: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] Fwd: [OpenJPEG] OpenJPEG 2.2.0 is out ! Faster and
> safer.
> On lundi 28 août 2017 18:00:03 CEST N. Farah wrote:
> > Thanks Even for the quick response. I'll give it a try with setting
> > 
> > OPJ_NUM_THREADS env variable to 8. Does it need to be used with
> > 
> > GDAL_NUM_THREADS ? Any url to read about those two env variables ?
> 
> I've added some documentation per
> 
> https://trac.osgeo.org/gdal/changeset/39954
> 
> > The two dataset i used:
> > 
> > 
> > 
> > <http://data.opengee.org/FusionTutorial-Full.tar.gz>
> > 
> > 
> > 
> > https://1drv.ms/u/s!AkFDoDHsFe7_hkBS6GbG4xMqnk6t<http://data.opengee.org/F
> > us
> > 
> > ionTutorial-Full.tar.gz>
> > 
> > https://1drv.ms/u/s!AkFDoDHsFe7_hkG1-XDo7UztsPoC<http://data.opengee.org/F
> > u
> > 
> > sionTutorial-Full.tar.gz>
> 
> Those images are single-tiled, so the GDAL_NUM_THREADS optimization will not
> help for them, and current openjpeg versions are super inefficient on those
> use cases, as GDAL expose a pseudo tiling to avoid a super big tile size,
> which cause the whole image to be decoded multiple times. I'm currently
> working on improving subtile decoding, that will substantially improve
> performance for such images (first steps are already in openjpeg master,
> next to follow)
> 
> 
> 
> I didn't have the patience to convert the whole image, so just took 3 GDAL
> blocks of 1024x1024
> 
> Without threading support, on hot runs:
> 
> 
> 
> gdal_translate bluemarble_4km.jp2 out.tif -srcwin 0 0 3072 1024
> 
> 
> 
> 35.1 s GDAL 2.2 / openjpeg 2.1.2
> 
> 26.2 s GDAL 2.2 / openjpeg 2.2.0
> 
> 
> 
> So I do see an improvement. Not sure why you don't.
> 
> 
> 
> Hardware: Intel(R) Core(TM) i7-6700HQ CPU @ 2.60GHz
> 
> OS: Ubuntu 16.04, 64bit build
> 
> 
> 
> 
> 
> and as a teaser:
> 
> 3.1 s GDAL 2.2 / openjpeg master
> 
> 1.5 s GDAL 2.2 / openjpeg (my work-in-progress branch)
> 
> 
> 
> With 8 threads:
> 
> 9.9 s GDAL 2.2 / openjpeg 2.2.0
> 
> 2.3 s GDAL 2.2 / openjpeg master
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170828/73df5ec1/attachment-0001.html>

From nfarah at hotmail.com  Mon Aug 28 10:21:10 2017
From: nfarah at hotmail.com (N. Farah)
Date: Mon, 28 Aug 2017 17:21:10 +0000
Subject: [gdal-dev] Fwd: [OpenJPEG] OpenJPEG 2.2.0 is out ! Faster and
 safer.
In-Reply-To: <BN6PR11MB1873C1368E7ECEE41334B462DD8C0@BN6PR11MB1873.namprd11.prod.outlook.com>
References: <BN6PR11MB1873652B8BA21286FA3CC4DBDD8F0@BN6PR11MB1873.namprd11.prod.outlook.com>,
 <2036961.vp26HKGrJL@even-i700>,
 <BN6PR11MB1873C1368E7ECEE41334B462DD8C0@BN6PR11MB1873.namprd11.prod.outlook.com>
Message-ID: <BN6PR11MB1873EEEC2E8A977A19E9282DDD9E0@BN6PR11MB1873.namprd11.prod.outlook.com>

Hi,


I rebuilt GDAL (older version: 2.1.2) using this new open jpeg 2.2.0 (https://github.com/uclouvain/openjpeg/releases/download/v2.2.0/openjpeg-v2.2.0-linux-x86_64.tar.gz)

and tried to convert two jp2 dataset to tiff (gdal_translate):

- bluemarble_4km.jp2: (10800 x 5400 pixels). 37.3 mb file size.

- usgsLanSat.jp2: (8627 x 7745 pixels). 48 mb file size.


Tests were run on virtual machine with ‘Ubuntu 16.04’ operation system, 18 gb RAM and 2 CPU processors.


gdal_translate ‘bluemarble_4km.jp2’ to tiff:

- OpenJpeg 2.1.2:

13m34s: first run

13m35s: second run


- OpenJpeg 2.2.0:

13m45: first run

14m20s: second run


gdal_translate ‘usgsLanSat.jp2’ to tiff:

- OpenJpeg 2.1.2:

16m52s: first run

17m04s: second run


- OpenJpeg 2.2.0:

18m13s: first run

17m54s: second run


These results were not expected since the new openJpeg should be faster than the previous one. Could this be cause by 'gdal_translate' not using threads that the new openjpeg uses for performance boost ?


Or could it one of GDAL configuration or the built version of OpenJpeg need to be rebuilt using different config ?


Thanks

Noureddine Farah



________________________________
From: N. Farah <nfarah at hotmail.com>
Sent: Monday, August 14, 2017 11:42:31 AM
To: Even Rouault; gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Fwd: [OpenJPEG] OpenJPEG 2.2.0 is out ! Faster and safer.


Right...since GDAL does not ship the 3rd party lib(s).


Thanks again


________________________________
From: Even Rouault <even.rouault at spatialys.com>
Sent: Monday, August 14, 2017 4:49:09 AM
To: gdal-dev at lists.osgeo.org
Cc: N. Farah
Subject: Re: [gdal-dev] Fwd: [OpenJPEG] OpenJPEG 2.2.0 is out ! Faster and safer.


On dimanche 13 août 2017 15:57:54 CEST N. Farah wrote:

> Great news. Thanks for the work.

>

>

> Any plans to integrate this new version in GDAL ?



Well, there's nothing to change in the GDAL source code. The existing JP2OpenJPEG driver will work with OpenJPEG 2.2. It is just a matter of recompiling libopenjp2.



Even



--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170828/1cf25515/attachment.html>

From nfarah at hotmail.com  Mon Aug 28 11:00:03 2017
From: nfarah at hotmail.com (N. Farah)
Date: Mon, 28 Aug 2017 18:00:03 +0000
Subject: [gdal-dev] Fwd: [OpenJPEG] OpenJPEG 2.2.0 is out ! Faster and
 safer.
In-Reply-To: <1572882.tlT0Nb93G5@even-i700>
References: <BN6PR11MB1873652B8BA21286FA3CC4DBDD8F0@BN6PR11MB1873.namprd11.prod.outlook.com>
 <BN6PR11MB1873C1368E7ECEE41334B462DD8C0@BN6PR11MB1873.namprd11.prod.outlook.com>
 <BN6PR11MB1873EEEC2E8A977A19E9282DDD9E0@BN6PR11MB1873.namprd11.prod.outlook.com>,
 <1572882.tlT0Nb93G5@even-i700>
Message-ID: <BN6PR11MB187314CC025C0F391BEC06ECDD9E0@BN6PR11MB1873.namprd11.prod.outlook.com>

Thanks Even for the quick response. I'll give it a try with setting OPJ_NUM_THREADS env variable to 8. Does it need to be used with GDAL_NUM_THREADS ? Any url to read about those two env variables ?


The two dataset i used:

<http://data.opengee.org/FusionTutorial-Full.tar.gz>

https://1drv.ms/u/s!AkFDoDHsFe7_hkBS6GbG4xMqnk6t<http://data.opengee.org/FusionTutorial-Full.tar.gz>
https://1drv.ms/u/s!AkFDoDHsFe7_hkG1-XDo7UztsPoC<http://data.opengee.org/FusionTutorial-Full.tar.gz>

p.s: i'm using GDAL 2.1.2


Noureddine

________________________________
From: Even Rouault <even.rouault at spatialys.com>
Sent: Monday, August 28, 2017 1:40:31 PM
To: N. Farah
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Fwd: [OpenJPEG] OpenJPEG 2.2.0 is out ! Faster and safer.


Hi,



>

>

> I rebuilt GDAL (older version: 2.1.2) using this new open jpeg 2.2.0

> (https://github.com/uclouvain/openjpeg/releases/download/v2.2.0/openjpeg-v2

> .2.0-linux-x86_64.tar.gz)

>

> and tried to convert two jp2 dataset to tiff (gdal_translate):

>

> - bluemarble_4km.jp2: (10800 x 5400 pixels). 37.3 mb file size.

>

> - usgsLanSat.jp2: (8627 x 7745 pixels). 48 mb file size.



Do you know if they use JPEG2000 tiling ?



>

>

> Tests were run on virtual machine with ‘Ubuntu 16.04’ operation system, 18

> gb RAM and 2 CPU processors.

>



>

> These results were not expected since the new openJpeg should be faster than

> the previous one. Could this be cause by 'gdal_translate' not using threads

> that the new openjpeg uses for performance boost ?



By default, GDAL will now enable openjpeg thread support. So you need to set the OPJ_NUM_THREADS environment variable. That said, you should already get significant performance improvements even without enabling multi-threading. I'm not sure why you don't get them.



I'd be interested if you could share those images.



Even





--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170828/3be1560c/attachment-0001.html>

From nfarah at hotmail.com  Mon Aug 28 12:36:16 2017
From: nfarah at hotmail.com (N. Farah)
Date: Mon, 28 Aug 2017 19:36:16 +0000
Subject: [gdal-dev] Fwd: [OpenJPEG] OpenJPEG 2.2.0 is out ! Faster and
 safer.
In-Reply-To: <2074557.G53rZ0Dsuq@even-i700>
References: <BN6PR11MB1873652B8BA21286FA3CC4DBDD8F0@BN6PR11MB1873.namprd11.prod.outlook.com>
 <1572882.tlT0Nb93G5@even-i700>
 <BN6PR11MB187314CC025C0F391BEC06ECDD9E0@BN6PR11MB1873.namprd11.prod.outlook.com>,
 <2074557.G53rZ0Dsuq@even-i700>
Message-ID: <BN6PR11MB1873AB725AA8BAD67478C9F0DD9E0@BN6PR11MB1873.namprd11.prod.outlook.com>

Thanks Even for updating the doc and also running some perf testing using those datasets.


The results you get when enabling multi-threading are very interesting: 26.s to 9.9 s. Then using the work in progress you end up with 1s. Basically a 26 times speed improvement.


Is there a timeline for releasing next version of openJpeg (either master or work in progress).


I'm very interested in the performance improvement since they looks promising and may get closer or beat to Kakadu performance.


Are there shared jp2 dataset you're using for performance benchmark ?


Noureddine


________________________________
From: Even Rouault <even.rouault at spatialys.com>
Sent: Monday, August 28, 2017 2:55 PM
To: N. Farah
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Fwd: [OpenJPEG] OpenJPEG 2.2.0 is out ! Faster and safer.


On lundi 28 août 2017 18:00:03 CEST N. Farah wrote:

> Thanks Even for the quick response. I'll give it a try with setting

> OPJ_NUM_THREADS env variable to 8. Does it need to be used with

> GDAL_NUM_THREADS ? Any url to read about those two env variables ?

>

>



I've added some documentation per

https://trac.osgeo.org/gdal/changeset/39954





> The two dataset i used:

>

> <http://data.opengee.org/FusionTutorial-Full.tar.gz>

>

> https://1drv.ms/u/s!AkFDoDHsFe7_hkBS6GbG4xMqnk6t<http://data.opengee.org/Fus

> ionTutorial-Full.tar.gz>

> https://1drv.ms/u/s!AkFDoDHsFe7_hkG1-XDo7UztsPoC<http://data.opengee.org/Fu

> sionTutorial-Full.tar.gz>



Those images are single-tiled, so the GDAL_NUM_THREADS optimization will not help for them, and current openjpeg versions are super inefficient on those use cases, as GDAL expose a pseudo tiling to avoid a super big tile size, which cause the whole image to be decoded multiple times. I'm currently working on improving subtile decoding, that will substantially improve performance for such images (first steps are already in openjpeg master, next to follow)



I didn't have the patience to convert the whole image, so just took 3 GDAL blocks of 1024x1024

Without threading support, on hot runs:



gdal_translate bluemarble_4km.jp2 out.tif -srcwin 0 0 3072 1024



35.1 s GDAL 2.2 / openjpeg 2.1.2

26.2 s GDAL 2.2 / openjpeg 2.2.0



So I do see an improvement. Not sure why you don't.



Hardware: Intel(R) Core(TM) i7-6700HQ CPU @ 2.60GHz

OS: Ubuntu 16.04, 64bit build





and as a teaser:

3.1 s GDAL 2.2 / openjpeg master

1.5 s GDAL 2.2 / openjpeg (my work-in-progress branch)



With 8 threads:

9.9 s GDAL 2.2 / openjpeg 2.2.0

2.3 s GDAL 2.2 / openjpeg master

0.9 s GDAL 2.2 / openjpeg (my work-in-progress branch)







With usgsLanSat.jp2



gdal_translate usgsLanSat.jp2 out.tif -srcwin 0 0 3072 1024



40.2 s GDAL 2.2 / openjpeg 2.1.2

32.3 s GDAL 2.2 / openjpeg 2.2.0



>

> p.s: i'm using GDAL 2.1.2



GDAL 2.1 or 2.2 should have comparable performances on this, I think



--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170828/733d4071/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Tue Aug 29 01:42:21 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Tue, 29 Aug 2017 01:42:21 -0700 (MST)
Subject: [gdal-dev] Fwd: [OpenJPEG] OpenJPEG 2.2.0 is out ! Faster and
	safer.
In-Reply-To: <BN6PR11MB1873AB725AA8BAD67478C9F0DD9E0@BN6PR11MB1873.namprd11.prod.outlook.com>
References: <BN6PR11MB1873652B8BA21286FA3CC4DBDD8F0@BN6PR11MB1873.namprd11.prod.outlook.com>
 <2036961.vp26HKGrJL@even-i700>
 <BN6PR11MB1873C1368E7ECEE41334B462DD8C0@BN6PR11MB1873.namprd11.prod.outlook.com>
 <BN6PR11MB1873EEEC2E8A977A19E9282DDD9E0@BN6PR11MB1873.namprd11.prod.outlook.com>
 <1572882.tlT0Nb93G5@even-i700>
 <BN6PR11MB187314CC025C0F391BEC06ECDD9E0@BN6PR11MB1873.namprd11.prod.outlook.com>
 <2074557.G53rZ0Dsuq@even-i700>
 <BN6PR11MB1873AB725AA8BAD67478C9F0DD9E0@BN6PR11MB1873.namprd11.prod.outlook.com>
Message-ID: <1503996141282-5332873.post@n6.nabble.com>

N. Farah wrote
> The results you get when enabling multi-threading are very interesting:
> 26.s to 9.9 s. Then using the work in progress you end up with 1s.
> Basically a 26 times speed improvement.

Hi,

As always when you read benchmarks, you must keep the results and the
context together so it is clear what was tested. In this case the important
part is that the test applies to single tiled images. They are what Kakadu
prefers (also in the usage examples) and it handles them splendidly by
utilizing the precincts. OpenJPEG has not been able to use precincts
(despite in a fork
https://lists.osgeo.org/pipermail/gdal-dev/2016-February/043650.html) and
therefore it has slow with single tiled images and actually useless if the
tile size is something like 20000 by 20000 pixels.

Even can say how much faster the new branch is with JPEG2000 images which
use 1024x1024 tiles but I suppose that the speed-up factor is much less than
26.

-Jukka Rahkonen-



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Fwd-OpenJPEG-OpenJPEG-2-2-0-is-out-Faster-and-safer-tp5331422p5332873.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Tue Aug 29 02:37:08 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 29 Aug 2017 11:37:08 +0200
Subject: [gdal-dev] Fwd: [OpenJPEG] OpenJPEG 2.2.0 is out ! Faster and
	safer.
In-Reply-To: <1503996141282-5332873.post@n6.nabble.com>
References: <BN6PR11MB1873652B8BA21286FA3CC4DBDD8F0@BN6PR11MB1873.namprd11.prod.outlook.com>
 <BN6PR11MB1873AB725AA8BAD67478C9F0DD9E0@BN6PR11MB1873.namprd11.prod.outlook.com>
 <1503996141282-5332873.post@n6.nabble.com>
Message-ID: <12248796.oofL25NZvR@even-i700>

On mardi 29 août 2017 01:42:21 CEST jratike80 wrote:
> N. Farah wrote
> 
> > The results you get when enabling multi-threading are very interesting:
> > 26.s to 9.9 s. Then using the work in progress you end up with 1s.
> > Basically a 26 times speed improvement.
> 
> Hi,
> 
> As always when you read benchmarks, you must keep the results and the
> context together so it is clear what was tested. In this case the important
> part is that the test applies to single tiled images. They are what Kakadu
> prefers (also in the usage examples) and it handles them splendidly by
> utilizing the precincts. OpenJPEG has not been able to use precincts
> (despite in a fork
> https://lists.osgeo.org/pipermail/gdal-dev/2016-February/043650.html) and
> therefore it has slow with single tiled images and actually useless if the
> tile size is something like 20000 by 20000 pixels.
> 
> Even can say how much faster the new branch is with JPEG2000 images which
> use 1024x1024 tiles but I suppose that the speed-up factor is much less than
> 26.

For tiled images, the GDAL OpenJPEG driver currently still read whole tiles (perhaps this 
should be re-considered at some point), so sub-tile decoding improvements will not help 
here, and you won't get more than the improvements done during 2.2.0, so something like 
20% for openjpeg single-threaded (your mileage may vary), or more if you enable 
OPJ_NUM_THREADS. 

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170829/df19e251/attachment-0001.html>

From mateusz at loskot.net  Tue Aug 29 05:27:48 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue, 29 Aug 2017 14:27:48 +0200
Subject: [gdal-dev] Call for discussion on RFC68: C++11 compilation mode
In-Reply-To: <CACmBxysbymV6N6p4updUoW3bmLaM80gqGY0AFj5-HRZbnoEHdw@mail.gmail.com>
References: <CACmBxysbymV6N6p4updUoW3bmLaM80gqGY0AFj5-HRZbnoEHdw@mail.gmail.com>
Message-ID: <CABUeae8wn2MeBy6RAr-OqD4BKfeN+TXCsO3fTPU+z0TiWZWd=g@mail.gmail.com>

On 14 August 2017 at 18:44, Kurt Schwehr <schwehr at gmail.com> wrote:
> Hi all,
>
> This is a call for discussion on RFC68 to set C++11 to be the minimum C++
> language version for GDAL trunk.  I've drafted the RFC based on work by
> Mateusz.
>
>   https://trac.osgeo.org/gdal/wiki/rfc68_cplusplus11

Kurt,

In the GEOS RFC 5 I was not entirely correct regarding C++14 status in
compilers:

* GCC supports C++14 in GCC 5, and made C++14 the default C++ standard in GCC 6
* MSVC supports C++14 in Visual Studio 2017, not 2015.

Although I don't think GDAL codebase would benefit from C++14 features,
so there seem to be no practical benefit from jumping directly to
C++14 (as OTB did),
it indeed is important to ensure that GDAL compiles C++14 mode fine.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From szekerest at gmail.com  Tue Aug 29 06:18:42 2017
From: szekerest at gmail.com (Tamas Szekeres)
Date: Tue, 29 Aug 2017 15:18:42 +0200
Subject: [gdal-dev] Call for discussion on RFC68: C++11 compilation mode
In-Reply-To: <22451425.pbmFVvQ3Z5@even-i700>
References: <CACmBxysbymV6N6p4updUoW3bmLaM80gqGY0AFj5-HRZbnoEHdw@mail.gmail.com>
 <22451425.pbmFVvQ3Z5@even-i700>
Message-ID: <82F0A4A3-A633-4CAA-BC86-56670D0A8289@gmail.com>

Hi Even,

Yes, I'm planning to include msvc2015/2017 versions shortly.

Best regards,
Tamas

Sent from my iPhone

2017. aug. 14. dátummal, 19:02 időpontban Even Rouault <even.rouault at spatialys.com> írta:

> Hi Tamas,
>  
> Unless I'm mistaken your gisinternals.com builds don't include MSVC 2015 currently. Right ? Do you have any plans to do so ? Currently the GDAL AppVeyor target uses SDKSs from gisinternals to do builds with a number of third-party libraries.
>  
> Even
>  
> >
> > This is a call for discussion on RFC68 to set C++11 to be the minimum C++
> > language version for GDAL trunk. I've drafted the RFC based on work by
> > Mateusz.
> >
> > https://trac.osgeo.org/gdal/wiki/rfc68_cplusplus11
> >
> > There was initial discussions back in January of this year:
> >
> > https://lists.osgeo.org/pipermail/gdal-dev/2017-January/thread.html#45786
> >
> > Cheers,
> > -kurt
> > Engineer at Google
>  
>  
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com

From gr.pomadchin at gmail.com  Tue Aug 29 09:27:33 2017
From: gr.pomadchin at gmail.com (daunnc)
Date: Tue, 29 Aug 2017 09:27:33 -0700 (MST)
Subject: [gdal-dev] Generating Cloud Optimized GeoTIFFs
Message-ID: <1504024053839-5332934.post@n6.nabble.com>

Hi everybody! We're implementing COGs support in GeoTrellis, and there is
appeared a question related to cloud optimized geotiff definition. 

Following  this <https://trac.osgeo.org/gdal/wiki/CloudOptimizedGeoTIFF>  
page: 

// in.tif is some random tiff.

1. gdaladdo in.tif 2 4 8 16 32
2. gdal_translate in.tif out.tif -co TILED=YES -co COPY_SRC_OVERVIEWS=YES
-co COMPRESS=DEFLATE

After that using  this
<https://trac.osgeo.org/gdal/wiki/CloudOptimizedGeoTIFF#HowtocheckifaGeoTIFFhasacloudoptimizationinternalorganization>  
python script decided to validate the result and was confused by missing
IFD_OFFSET tag.

So the questions are: Should it be present? Is it possible point me to the
GDAL code base, to the place where it can or should be set? Should it be
defined manually? Can BigTiffs be cloud optimized and can / should BigTiff
have an offset == 8 as well (16 is a usual offset for them)? I discovered 
this
<https://github.com/OSGeo/gdal/blob/77544764f51420e42468641fc3d5a087f8ea6d8f/gdal/frmts/gtiff/libtiff/tiff.h#L142>  
link, but still confused about IFD_OFFSET tag necessity / requirement.

GDAL version: GDAL 2.2.1, released 2017/06/23, mac os sierra.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Generating-Cloud-Optimized-GeoTIFFs-tp5332934.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Tue Aug 29 09:45:21 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 29 Aug 2017 18:45:21 +0200
Subject: [gdal-dev] Generating Cloud Optimized GeoTIFFs
In-Reply-To: <1504024053839-5332934.post@n6.nabble.com>
References: <1504024053839-5332934.post@n6.nabble.com>
Message-ID: <3439397.ETkA7qf42L@even-i700>

On mardi 29 août 2017 09:27:33 CEST daunnc wrote:
> Hi everybody! We're implementing COGs support in GeoTrellis, and there is
> appeared a question related to cloud optimized geotiff definition.
> 
> Following  this <https://trac.osgeo.org/gdal/wiki/CloudOptimizedGeoTIFF>
> page:
> 
> // in.tif is some random tiff.
> 
> 1. gdaladdo in.tif 2 4 8 16 32
> 2. gdal_translate in.tif out.tif -co TILED=YES -co COPY_SRC_OVERVIEWS=YES
> -co COMPRESS=DEFLATE
> 
> After that using  this
> <https://trac.osgeo.org/gdal/wiki/CloudOptimizedGeoTIFF#HowtocheckifaGeoTIFF
> hasacloudoptimizationinternalorganization> python script decided to validate
> the result and was confused by missing IFD_OFFSET tag.

confused ? Can you report the exact error ?

IFD_OFFSET should always be reported for any (valid) TIFF, be it COG or not. This is the offset 
in the file of the image directory, and we must check that it is right at the beginning of the 
file for efficient reading.

I suspect some issue with your setup, although I'm not clear which one. I'd have said perhaps 
you'd run the script against an older GDAL version, but the script does version checking..
To debug this you could try setting a breakpoint in GTiffRasterBand::GetMetadataItem and 
check what happens.

> Can BigTiffs be cloud optimized and can / should BigTiff
> have an offset == 8 as well (16 is a usual offset for them)? 

You're absolutely right. I've just fixed the script to accept those.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170829/95cc32f6/attachment.html>

From gr.pomadchin at gmail.com  Tue Aug 29 09:57:21 2017
From: gr.pomadchin at gmail.com (daunnc)
Date: Tue, 29 Aug 2017 09:57:21 -0700 (MST)
Subject: [gdal-dev] Generating Cloud Optimized GeoTIFFs
In-Reply-To: <3439397.ETkA7qf42L@even-i700>
References: <1504024053839-5332934.post@n6.nabble.com>
 <3439397.ETkA7qf42L@even-i700>
Message-ID: <1504025841892-5332938.post@n6.nabble.com>

Cool, thanks! Can you write here when it'll be updated? 

The error is missing IFD_OFFSET tag. Should it be specified manually or it
is fine to have it missing? Is it a COG requirement?



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Generating-Cloud-Optimized-GeoTIFFs-tp5332934p5332938.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Tue Aug 29 10:02:32 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 29 Aug 2017 19:02:32 +0200
Subject: [gdal-dev] Generating Cloud Optimized GeoTIFFs
In-Reply-To: <1504025841892-5332938.post@n6.nabble.com>
References: <1504024053839-5332934.post@n6.nabble.com>
 <3439397.ETkA7qf42L@even-i700> <1504025841892-5332938.post@n6.nabble.com>
Message-ID: <3486657.X4Y93JrrgX@even-i700>

On mardi 29 août 2017 09:57:21 CEST daunnc wrote:
> Cool, thanks! Can you write here when it'll be updated?

It was already committed in GDAL trunk when I sent the previous email.

> 
> The error is missing IFD_OFFSET tag. Should it be specified manually or it
> is fine to have it missing? Is it a COG requirement?

I'm not sure how to rephrase better what I wrote in my previous email. IFD_OFFSET is not a 
tag, this is a structural element of any TIFF file. There is compulsory an IFD for any TIFF file. 
The fact that you don't get this metadata item is a software issue, and should be solved (if 
you comment out that check, I'm pretty sure you'll have other issues then, so you need to 
find what's wrong in your setup). Your file has necessarily an IFD and thus an IFD offset.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170829/b87403e1/attachment.html>

From gr.pomadchin at gmail.com  Tue Aug 29 10:03:34 2017
From: gr.pomadchin at gmail.com (daunnc)
Date: Tue, 29 Aug 2017 10:03:34 -0700 (MST)
Subject: [gdal-dev] Generating Cloud Optimized GeoTIFFs
In-Reply-To: <1504025841892-5332938.post@n6.nabble.com>
References: <1504024053839-5332934.post@n6.nabble.com>
 <3439397.ETkA7qf42L@even-i700> <1504025841892-5332938.post@n6.nabble.com>
Message-ID: <1504026214793-5332940.post@n6.nabble.com>

Ah sorry reread your message. Yes, my tiff has no IFD_OFFSET /tag/ (line
int(main_band.GetMetadataItem('IFD_OFFSET', 'TIFF')) fails), but gdalinfo
reads tiff info well and moreover reading tiff manually by bytes I can see
that /offset field/ has a correct value. 



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Generating-Cloud-Optimized-GeoTIFFs-tp5332934p5332940.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From gr.pomadchin at gmail.com  Tue Aug 29 10:09:34 2017
From: gr.pomadchin at gmail.com (daunnc)
Date: Tue, 29 Aug 2017 10:09:34 -0700 (MST)
Subject: [gdal-dev] Generating Cloud Optimized GeoTIFFs
In-Reply-To: <1504026214793-5332940.post@n6.nabble.com>
References: <1504024053839-5332934.post@n6.nabble.com>
 <3439397.ETkA7qf42L@even-i700> <1504025841892-5332938.post@n6.nabble.com>
 <1504026214793-5332940.post@n6.nabble.com>
Message-ID: <1504026574089-5332943.post@n6.nabble.com>

Well I'll post the exact message here, as probably I could use not really
correct terms in my messages: 

python validate_cloud_optimized_geotiff.py in.tiff
Traceback (most recent call last):
  File "validate_cloud_optimized_geotiff.py", line 218, in <module>
    sys.exit(main())
  File "validate_cloud_optimized_geotiff.py", line 196, in main
    errors, _ = validate(filename)
  File "validate_cloud_optimized_geotiff.py", line 88, in validate
    ifd_offset = int(main_band.GetMetadataItem('IFD_OFFSET', 'TIFF'))

But however I got it, thanks a lot!



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Generating-Cloud-Optimized-GeoTIFFs-tp5332934p5332943.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From gr.pomadchin at gmail.com  Tue Aug 29 10:26:23 2017
From: gr.pomadchin at gmail.com (daunnc)
Date: Tue, 29 Aug 2017 10:26:23 -0700 (MST)
Subject: [gdal-dev] Generating Cloud Optimized GeoTIFFs
In-Reply-To: <3439397.ETkA7qf42L@even-i700>
References: <1504024053839-5332934.post@n6.nabble.com>
 <3439397.ETkA7qf42L@even-i700>
Message-ID: <1504027583091-5332947.post@n6.nabble.com>

> I suspect some issue with your setup

Thanks a lot, I agree that probably it's a software issue (breakpoint
helped), and my GDAL version is 2010100 (I commented out this version check
before as thought that it's not that important). Thanks again, and thanks
for your reply, I'll upgrade GDAL and hope problems would go, as commenting
this line out solves the problem and allows to validate tiff. Was really
confused by an API and happy that it was just my fault.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Generating-Cloud-Optimized-GeoTIFFs-tp5332934p5332947.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From nicholas.g.lawrence at tmr.qld.gov.au  Tue Aug 29 17:25:46 2017
From: nicholas.g.lawrence at tmr.qld.gov.au (Nicholas G Lawrence)
Date: Wed, 30 Aug 2017 00:25:46 +0000
Subject: [gdal-dev] Fwd: [OpenJPEG] OpenJPEG 2.2.0 is out ! Faster
	and	safer.
In-Reply-To: <12248796.oofL25NZvR@even-i700>
References: <BN6PR11MB1873652B8BA21286FA3CC4DBDD8F0@BN6PR11MB1873.namprd11.prod.outlook.com>
 <BN6PR11MB1873AB725AA8BAD67478C9F0DD9E0@BN6PR11MB1873.namprd11.prod.outlook.com>
 <1503996141282-5332873.post@n6.nabble.com> <12248796.oofL25NZvR@even-i700>
Message-ID: <972360c03a9247e38c1ad4b6df6baf50@CIDCEX104.corp.tmr.qld.gov.au>

I'm curious, why is OpenJpeg not compiled into GDAL by default? Is this a policy?

Thanks,
Nick

From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Even Rouault
Sent: Tuesday, 29 August 2017 7:37 PM
To: gdal-dev at lists.osgeo.org
Cc: jratike80 <jukka.rahkonen at maanmittauslaitos.fi>
Subject: Re: [gdal-dev] Fwd: [OpenJPEG] OpenJPEG 2.2.0 is out ! Faster and safer.


On mardi 29 août 2017 01:42:21 CEST jratike80 wrote:

> N. Farah wrote

>

> > The results you get when enabling multi-threading are very interesting:

> > 26.s to 9.9 s. Then using the work in progress you end up with 1s.

> > Basically a 26 times speed improvement.

>

> Hi,

>

> As always when you read benchmarks, you must keep the results and the

> context together so it is clear what was tested. In this case the important

> part is that the test applies to single tiled images. They are what Kakadu

> prefers (also in the usage examples) and it handles them splendidly by

> utilizing the precincts. OpenJPEG has not been able to use precincts

> (despite in a fork

> https://lists.osgeo.org/pipermail/gdal-dev/2016-February/043650.html) and

> therefore it has slow with single tiled images and actually useless if the

> tile size is something like 20000 by 20000 pixels.

>

> Even can say how much faster the new branch is with JPEG2000 images which

> use 1024x1024 tiles but I suppose that the speed-up factor is much less than

> 26.



For tiled images, the GDAL OpenJPEG driver currently still read whole tiles (perhaps this should be re-considered at some point), so sub-tile decoding improvements will not help here, and you won't get more than the improvements done during 2.2.0, so something like 20% for openjpeg single-threaded (your mileage may vary), or more if you enable OPJ_NUM_THREADS.



Even



--

Spatialys - Geospatial professional services

http://www.spatialys.com


***********************************************************************
WARNING: This email (including any attachments) may contain legally
privileged, confidential or private information and may be protected by
copyright. You may only use it if you are the person(s) it was
intended to be sent to and if you use it in an authorised way. No one
is allowed to use, review, alter, transmit, disclose, distribute, print
or copy this email without appropriate authority.

If this email was not intended for you and was sent to you by mistake,
please telephone or email me immediately, destroy any hardcopies of
this email and delete it and any copies of it from your computer
system. Any right which the sender may have under copyright law, and 
any legal privilege and confidentiality attached to this email is not
waived or destroyed by that mistake.

It is your responsibility to ensure that this email does not contain 
and is not affected by computer viruses, defects or interference by 
third parties or replication problems (including incompatibility with
your computer system).

Opinions contained in this email do not necessarily reflect the
opinions of the Department of Transport and Main Roads,
or endorsed organisations utilising the same infrastructure.
***********************************************************************

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170830/42681eef/attachment.html>

From even.rouault at spatialys.com  Wed Aug 30 00:38:12 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 30 Aug 2017 09:38:12 +0200
Subject: [gdal-dev] Fwd: [OpenJPEG] OpenJPEG 2.2.0 is out ! Faster
	and	safer.
In-Reply-To: <972360c03a9247e38c1ad4b6df6baf50@CIDCEX104.corp.tmr.qld.gov.au>
References: <BN6PR11MB1873652B8BA21286FA3CC4DBDD8F0@BN6PR11MB1873.namprd11.prod.outlook.com>
 <12248796.oofL25NZvR@even-i700>
 <972360c03a9247e38c1ad4b6df6baf50@CIDCEX104.corp.tmr.qld.gov.au>
Message-ID: <5612529.kbN31gfQr6@even-i700>

On mercredi 30 août 2017 00:25:46 CEST Nicholas G Lawrence wrote:
> I'm curious, why is OpenJpeg not compiled into GDAL by default? Is this a
> policy?
> 

This is mostly a technical constraint. The GDAL OpenJPEG driver requires linking against 
libopenjp2, which is the result of the compilation of the OpenJPEG source code, which is in 
its own source code repository. So this is mostly an issue of packaging choice: which optional 
dependencies you install before building GDAL. Like all other GDAL drivers that depend on 
third party libraries. Most popular binary distributions of GDAL have the openjpeg driver built 
(OSGeo4W, gisinternals, UbuntuGIS) (not necessarily against the latest libopenjp2 version)

The GDAL source code repository has historically a few copies of common dependencies (libz, 
libtiff, etc...) for conveniency on platforms where installing packaged dependencies isn't easy 
(Windows typically), but we cannot extend this practice to all dependencies, because of the 
increased maintainance cost.

Even


> Thanks,
> Nick
> 
> From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Even
> Rouault Sent: Tuesday, 29 August 2017 7:37 PM
> To: gdal-dev at lists.osgeo.org
> Cc: jratike80 <jukka.rahkonen at maanmittauslaitos.fi>
> Subject: Re: [gdal-dev] Fwd: [OpenJPEG] OpenJPEG 2.2.0 is out ! Faster and
> safer.
> On mardi 29 août 2017 01:42:21 CEST jratike80 wrote:
> > N. Farah wrote
> > 
> > > The results you get when enabling multi-threading are very interesting:
> > > 
> > > 26.s to 9.9 s. Then using the work in progress you end up with 1s.
> > > 
> > > Basically a 26 times speed improvement.
> > 
> > Hi,
> > 
> > 
> > 
> > As always when you read benchmarks, you must keep the results and the
> > 
> > context together so it is clear what was tested. In this case the
> > important
> > 
> > part is that the test applies to single tiled images. They are what Kakadu
> > 
> > prefers (also in the usage examples) and it handles them splendidly by
> > 
> > utilizing the precincts. OpenJPEG has not been able to use precincts
> > 
> > (despite in a fork
> > 
> > https://lists.osgeo.org/pipermail/gdal-dev/2016-February/043650.html) and
> > 
> > therefore it has slow with single tiled images and actually useless if the
> > 
> > tile size is something like 20000 by 20000 pixels.
> > 
> > 
> > 
> > Even can say how much faster the new branch is with JPEG2000 images which
> > 
> > use 1024x1024 tiles but I suppose that the speed-up factor is much less
> > than
> > 
> > 26.
> 
> For tiled images, the GDAL OpenJPEG driver currently still read whole tiles
> (perhaps this should be re-considered at some point), so sub-tile decoding
> improvements will not help here, and you won't get more than the
> improvements done during 2.2.0, so something like 20% for openjpeg
> single-threaded (your mileage may vary), or more if you enable
> OPJ_NUM_THREADS.
> 
> 
> 
> Even
> 
> 
> 
> --
> 
> Spatialys - Geospatial professional services
> 
> http://www.spatialys.com
> 
> 
> ***********************************************************************
> WARNING: This email (including any attachments) may contain legally
> privileged, confidential or private information and may be protected by
> copyright. You may only use it if you are the person(s) it was
> intended to be sent to and if you use it in an authorised way. No one
> is allowed to use, review, alter, transmit, disclose, distribute, print
> or copy this email without appropriate authority.
> 
> If this email was not intended for you and was sent to you by mistake,
> please telephone or email me immediately, destroy any hardcopies of
> this email and delete it and any copies of it from your computer
> system. Any right which the sender may have under copyright law, and 
> any legal privilege and confidentiality attached to this email is not
> waived or destroyed by that mistake.
> 
> It is your responsibility to ensure that this email does not contain 
> and is not affected by computer viruses, defects or interference by 
> third parties or replication problems (including incompatibility with
> your computer system).
> 
> Opinions contained in this email do not necessarily reflect the
> opinions of the Department of Transport and Main Roads,
> or endorsed organisations utilising the same infrastructure.
> ***********************************************************************


-- 
Spatialys - Geospatial professional services
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170830/3a9e8f16/attachment-0001.html>

From ewenger at ara.com  Thu Aug 31 07:42:57 2017
From: ewenger at ara.com (Eric Wenger ARA/SED)
Date: Thu, 31 Aug 2017 14:42:57 +0000
Subject: [gdal-dev] C# updates for GDAL (swig 3.0.8 & dotnet core 2.0)
Message-ID: <F6EA2AD6F3BB79479520160AE9A1BFC4019D881E3D@colo-mail-1.exchange2.ara.wan>

All,

I have the [unfortunate] responsibility of delivering a piece of research code written in C# on Windows to a customer to be dockerized and run on CentOS 7.   As a result, I have made a couple of commits to my gdal repo on Github that I would eventually like to incorporate into the mainline.  I'm happy to contribute these at some point, but I'd like to provide them to the community in the meantime in case anyone else can take a look or use them in their current work.

--Eric

1. Fix C# build issues with SWIG 3.0.8 (ewenger/gdal, branch csharp-swig3x, commit d7e3963).  This commit fixes a number of issues that have caused users to have difficulty building code generated with later versions of SWIG.   With this change, all build issues with SWIG 3.0.8 and Mono/VS .NET 4.x are resolved.

https://github.com/ewenger/gdal/commit/d7e3963f27a2b0a54078763e3cad61aab0f47885

2. Support building gdal using the .NET Core 2.0 framework/SDK.  (ewenger/gdal, branch dotnet-core-2.0, commit cfd8ce2).  This commit adds solution and project files that support building the csharp binding dlls using the .NET Core 2.0 SDK.  I could use some advice here, since the new .NET Core 2.0 SDK is, as usual, unfriendly to external build tools.  From what I have learned so far, there is no way to call the new C# compiler directly and integrate the build into GDAL's makefile structure.  I'd like to find a way around committing solutions and projects, so please let me know if you have ideas.

https://github.com/ewenger/gdal/commit/cfd8ce2824c259c7c663f17ab8fdfd7365d4a408


------------------------------------------------------
Eric J Wenger, Senior Scientist
Southeast Division | Remote Sensing and Decision Analytics
Applied Research Associates, Inc.
8537 Six Forks Rd. Ste. 600 - Raleigh, NC 27615
T: 919-582-3449 F: 919-582-3301 M: 919-816-2864
www.ara.com<http://www.ara.com>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170831/6dd06bc7/attachment.html>

From etj at geo-solutions.it  Thu Aug 31 09:55:54 2017
From: etj at geo-solutions.it (Emanuele Tajariol)
Date: Thu, 31 Aug 2017 18:55:54 +0200
Subject: [gdal-dev] gdal_translate: extracting mask band and its overviews
Message-ID: <201708311855.54264.etj@geo-solutions.it>

Hi,

I'm trying and extract the single mask band out of a geotiff file using 
gdal_translate.
The tiff file also contains overviews of mask band, and I'd like to extract them 
as well (In the end of the mail there's a fragment of the input file's 
gdalinfo.)

The command I'm using is:

gdal_translate -b mask \
   --config GDAL_TIFF_INTERNAL_MASK YES \
   -co COPY_SRC_OVERVIEWS=yes \
   -co TILED=yes  \
   -co COMPRESS=DEFLATE   \
   intput_file.tif output_mask.tif

Anyway the output file does not contain any overview at all.

I get the very same result also removing the GDAL_TIFF_INTERNAL_MASK config 
(which should not be needed anyway since the mask band is exported as a data 
band).

Am I missing any command line option or is it possibile at all?


   Thanks,
   Emanuele


====
Input file gdalinfo fragment:

[...]
Size is 19584, 19584
[...crs, origin, pixel size...]
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  COMPRESSION=YCbCr JPEG
  INTERLEAVE=PIXEL
  SOURCE_COLOR_SPACE=YCbCr
[...Corner coords...]
Band 1 Block=256x256 Type=Byte, ColorInterp=Red
  Overviews: 9792x9792, 4896x4896, 2448x2448, 1224x1224, 612x612, 306x306
  Mask Flags: PER_DATASET 
  Overviews of mask band: 9792x9792, 4896x4896, 2448x2448, 1224x1224, 612x612, 
306x306
  Metadata:
    COLORINTERP=Red
Band 2 Block=256x256 Type=Byte, ColorInterp=Green
  Overviews: 9792x9792, 4896x4896, 2448x2448, 1224x1224, 612x612, 306x306
  Mask Flags: PER_DATASET 
  Overviews of mask band: 9792x9792, 4896x4896, 2448x2448, 1224x1224, 612x612, 
306x306
  Metadata:
    COLORINTERP=Green
Band 3 Block=256x256 Type=Byte, ColorInterp=Blue
  Overviews: 9792x9792, 4896x4896, 2448x2448, 1224x1224, 612x612, 306x306
  Mask Flags: PER_DATASET 
  Overviews of mask band: 9792x9792, 4896x4896, 2448x2448, 1224x1224, 612x612, 
306x306
  Metadata:
    COLORINTERP=Blue
[end]

====
Output file gdalinfo fragment:

[...]
Size is 19584, 19584
[...crs, origin, pixel size...]
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  COMPRESSION=DEFLATE
  INTERLEAVE=BAND
[...Corner coords...]
Band 1 Block=256x256 Type=Byte, ColorInterp=Gray
[end]

-- 

Regards,
Emanuele Tajariol
==
GeoServer Professional Services from the experts! Visit http://goo.gl/it488V 
for more information.
==

Ing. Emanuele Tajariol
Technical Lead

GeoSolutions S.A.S.
Via di Montramito 3/A
55054  Massarosa (LU)
Italy
phone: +39 0584 962313
fax:      +39 0584 1660272

http://www.geo-solutions.it
http://twitter.com/geosolutions_it

-------------------------------------------------------
AVVERTENZE AI SENSI DEL D.Lgs. 196/2003
Le informazioni contenute in questo messaggio di posta elettronica e/o nel/i 
file/s allegato/i sono da considerarsi strettamente riservate. Il loro utilizzo 
è consentito esclusivamente al destinatario del messaggio, per le finalità 
indicate nel messaggio stesso. Qualora riceviate questo messaggio senza 
esserne il destinatario, Vi preghiamo cortesemente di darcene notizia via e-
mail e di procedere alla distruzione del messaggio stesso, cancellandolo dal 
Vostro sistema. Conservare il messaggio stesso, divulgarlo anche in parte, 
distribuirlo ad altri soggetti, copiarlo, od utilizzarlo per finalità diverse, 
costituisce comportamento contrario ai principi dettati dal D.Lgs. 196/2003.
 
The information in this message and/or attachments, is intended solely for the 
attention and use of the named addressee(s) and may be confidential or 
proprietary in nature or covered by the provisions of privacy act (Legislative 
Decree June, 30 2003, no.196 - Italy's New Data Protection Code).Any use not 
in accord with its purpose, any disclosure, reproduction, copying, 
distribution, or either dissemination, either whole or partial, is strictly 
forbidden except previous formal approval of the named addressee(s). If you 
are not the intended recipient, please contact immediately the sender by 
telephone, fax or e-mail and delete the information in this message that has 
been received in error. The sender does not give any warranty or accept 
liability as the content, accuracy or completeness of sent messages and 
accepts no responsibility  for changes made after they were sent or for other 
risks which arise as a result of e-mail transmission, viruses, etc.

From even.rouault at spatialys.com  Thu Aug 31 10:17:51 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 31 Aug 2017 19:17:51 +0200
Subject: [gdal-dev] gdal_translate: extracting mask band and its
	overviews
In-Reply-To: <201708311855.54264.etj@geo-solutions.it>
References: <201708311855.54264.etj@geo-solutions.it>
Message-ID: <2233217.AvxZ4sxHsF@even-i700>

On jeudi 31 août 2017 18:55:54 CEST Emanuele Tajariol wrote:
> Hi,
> 
> I'm trying and extract the single mask band out of a geotiff file using
> gdal_translate.
> The tiff file also contains overviews of mask band, and I'd like to extract
> them as well (In the end of the mail there's a fragment of the input file's
> gdalinfo.)
> 
> The command I'm using is:
> 
> gdal_translate -b mask \
>    --config GDAL_TIFF_INTERNAL_MASK YES \
>    -co COPY_SRC_OVERVIEWS=yes \
>    -co TILED=yes  \
>    -co COMPRESS=DEFLATE   \
>    intput_file.tif output_mask.tif
> 
> Anyway the output file does not contain any overview at all.

Emanuele,

COPY_SRC_OVERVIEWS=YES will only work if you do a "bare" gdal_translate, ie if you use 
only source, target, output format and potentially creation options. Here the -b mask causes 
an intermediate VRT to be created, which no longer exposes the source overviews to the 
output GTiff driver (although this VRT dataset can still use the overviews of the source when 
doing downsampling operations. See below)

However, assuming overview dimensions following a power of 2 suite, you could do:

gdal_translate in.tif temp.tif -b mask
gdal_translate in.tif temp.tif.ovr -b mask -outsize 50% 50% (should extract the overview of 
the mask without actually resampling from full resolution)
gdal_translate in.tif temp.tif.ovr.ovr -b mask -outsize 25% 25%
gdal_translate temp.tif out.tif -co COPY_SRC_OVERVIEWS=yes

or even:

gdal_translate in.tif temp.vrt -b mask -of VRT
gdal_translate in.tif temp.vrt.ovr -b mask -outsize 50% 50% -of VRT
gdal_translate in.tif temp.vrt.ovr.ovr -b mask -outsize 25% 25% -of VRT
gdal_translate temp.vrt out.tif -co COPY_SRC_OVERVIEWS=yes


If you build GDAL from source, there's also the "dumpoverviews" utility that is built and that 
dumps overviews, mask bands and mask band overviews in separate TIFF file.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170831/9d3e47a3/attachment-0001.html>

