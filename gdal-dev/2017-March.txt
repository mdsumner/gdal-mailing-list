From damian.dixon at gmail.com  Wed Mar  1 02:56:53 2017
From: damian.dixon at gmail.com (Damian Dixon)
Date: Wed, 1 Mar 2017 10:56:53 +0000
Subject: [gdal-dev] ENVI Rotation Bug Fix
In-Reply-To: <CALBeTKL-_i177ni87837pVhxM0QAGwJnmBb_hQO-A-j2yzWViw@mail.gmail.com>
References: <a618291a-3dfc-d22f-2348-10d098058cfd@oregonstate.edu>
 <CAJjdW1wnNOUxS1EWwEQFDDTESjOe9d_rVs=-Fw_GfRuuWeGBRw@mail.gmail.com>
 <CALBeTKL-_i177ni87837pVhxM0QAGwJnmBb_hQO-A-j2yzWViw@mail.gmail.com>
Message-ID: <CAJjdW1yksCJoCKT3JZZYTL2U8-scP8ZtQsFAmRcwjqRAPsWSyA@mail.gmail.com>

Hi Taylor,

M_PI is defined pretty much everywhere. The only compiler that you have to
jump through hoops to get it is Visual Studio where you have to define '#define
_USE_MATH_DEFINES'.

As Even has mentioned it's also defined in the GDAL portability header.

The main reason the use of atan jumped out is that I've run into problems
with atan on Intel CPUs and GPUs in the past. Also the use of trig' of any
sort is expensive so I tend to take a look to see if it can be removed or
moved.

I spotted that this is a very old bug so I'm pleased that you've taken the
time to fix it.

Regards
Damian



On 27 February 2017 at 22:12, Brown, Taylor Alexander <
browtayl at oregonstate.edu> wrote:

> Damian,
>
> I agree that it would be preferable to use a predefined constant. However,
> I was under the impression that M_PI is a compiler extension and not part
> of standard C++, so I wanted to make sure it was compatible. If using M_PI
> is acceptable, I would be happy to change it. I will be submitting my pull
> request shortly.
>
>
> Taylor
>
> On Mon, Feb 27, 2017 at 5:01 AM, Damian Dixon <damian.dixon at gmail.com>
> wrote:
>
>> Hi Taylor,
>>
>> I'm just lurking on the mailing list myself.
>>
>> I had a look at the code changes, as this is one of the formats I'm
>> interested in, and one point springs out at me:
>>
>> const double PI = atan(1.0) * 4;
>>
>> I find this line potentially a confusing way to define PI, particularly
>> when you combine it with (PI/180) later.
>>
>> Personally I would use M_PI.
>>
>> Regards
>> Damian
>>
>>
>>
>> On 27 February 2017 at 11:55, Taylor Alexander Brown <
>> browtayl at oregonstate.edu> wrote:
>>
>>> Greetings GDAL Community,
>>>
>>> I am developing an application [0] to process georeferenced raster
>>> hyperspectral imagery in ENVI format from NASA's Airborne
>>> Visual/Infrared Imaging Spectrometer (AVIRIS) [1].
>>>
>>> The `map info` section of the header files contain an undocumented [2]
>>> rotation field which is currently ignored by GDAL. As a result, the
>>> image is rotated incorrectly when I process it with `gdalwarp` or the
>>> GDAL Python API. Furthermore, the image is scaled incorrectly when I try
>>> to override the geotransform.
>>>
>>> I documented my experiences on the GIS Stack Exchange [3]. It has
>>> previously been described on the GDAL mailing list [4] and bug tracker
>>> [5]. I believe this issue also affects ASTER imagery [6][7].
>>>
>>> I have implemented a fix based off of branch `tags/2.1.3` and shared my
>>> code on GitHub [8]. It reads the `units` and `rotation` parameter from
>>> the `map info` section and uses these to calculate the geotransform. The
>>> scaling was off because the code expected the `units` parameter to be
>>> the last element in the list, when in my case it was the second to last.
>>> You can verify this behavior with the single-band image I have been
>>> using for testing [9].
>>>
>>> You are welcome to evaluate my code and contribute it back to the
>>> library. I am a novice at both GDAL and GIS, so there may well be
>>> problems. I would be willing to submit a pull request against your
>>> GitHub mirror if desired.
>>>
>>>
>>> Peace,
>>>
>>> Taylor Alexander Brown
>>>
>>>
>>> [0] https://github.com/capstone-coal/pycoal
>>> [1] https://aviris.jpl.nasa.gov/
>>> [2] http://www.harrisgeospatial.com/docs/enviheaderfiles.html
>>> [3]
>>> http://gis.stackexchange.com/questions/229952/rotate-envi-hy
>>> perspectral-imagery-with-gdal
>>> [4] https://lists.osgeo.org/pipermail/gdal-dev/2013-January/035146.html
>>> [5] https://trac.osgeo.org/gdal/ticket/1778
>>> [6] http://yceo.yale.edu/opening-aster-files-envi
>>> [7] http://yceo.yale.edu/faq-page#t2n504
>>> [8]
>>> https://github.com/OSGeo/gdal/compare/tags/2.1.3...browtayl:
>>> fix-envi-rotation?expand=1
>>> [9] https://drive.google.com/open?id=0BxysdOuBmaIGalY5dVhCa1Y5M0k
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170301/3f4c61b3/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Wed Mar  1 03:43:12 2017
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Wed, 1 Mar 2017 11:43:12 +0000
Subject: [gdal-dev] FW:  Don't we have any ideas for GSoC 2017?
Message-ID: <19bfbde4d32b49ae91cd91abe51eeea6@C119S212VM022.msvyvi.vaha.local>

Forwarding to the list because Jordan's trial  was not successful.
Jordan Bess wrote:
Re: [gdal-dev] Don't we have any ideas for GSoC 2017?


Vector tiles! Mbtiles or folder of pbf

It would be great if OGR supported creation of vector tiles in protocol buff format

Get Outlook for Android<https://aka.ms/ghei36>

________________________________
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org<mailto:gdal-dev-bounces at lists.osgeo.org>> on behalf of Casper Børgesen (CABO) <CABO at NIRAS.DK<mailto:CABO at NIRAS.DK>>
Sent: Tuesday, February 28, 2017 5:16:19 AM
To: Rahkonen Jukka (MML); 'gdal-dev at lists.osgeo.org' (gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>)
Subject: Re: [gdal-dev] Don't we have any ideas for GSoC 2017?

Hi,

I don't know if the idea is too simple, but implementing indexing on VRT files would be great to have. I thinks it's currently a feature request.


Regards, Casper


-----Original Message-----
From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Rahkonen Jukka (MML)
Sent: 28. februar 2017 09:07
To: 'gdal-dev at lists.osgeo.org' (gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>)
Subject: [gdal-dev] Don't we have any ideas for GSoC 2017?

Hi,

OSGeo is accepted as an organization for the Google Summer of Code 2017 but there are no GDAL related ideas on https://wiki.osgeo.org/wiki/Google_Summer_of_Code_2017_Ideas. Could we raise some of the old ideas or discover some brand new ones?

-Jukka Rahkonen-
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170301/307fbc8c/attachment-0001.html>

From j.l.h.hartmann at uva.nl  Wed Mar  1 03:57:35 2017
From: j.l.h.hartmann at uva.nl (Jan Hartmann)
Date: Wed, 1 Mar 2017 12:57:35 +0100
Subject: [gdal-dev] FW: Don't we have any ideas for GSoC 2017?
In-Reply-To: <19bfbde4d32b49ae91cd91abe51eeea6@C119S212VM022.msvyvi.vaha.local>
References: <19bfbde4d32b49ae91cd91abe51eeea6@C119S212VM022.msvyvi.vaha.local>
Message-ID: <98c06c99-127c-b387-f870-05375dc4a7d9@uva.nl>

Hi all,

What would you devs think of a project to add to the interpolation 
algorithms in gdal_grid, e.g. TPS. It's something I do now with R, but 
it would nice to have this native in Gdal. If you think this is a good 
idea, I could try to set up something from the University of Amsterdam 
,together with Edzer Pebesma, of the University of Muenster, the leading 
specialist of spatial programming in R.

Regards,

Jan Hartmann

http://www.uni-muenster.de/Geoinformatics/en/institute/staff/index.php/119/Edzer_Pebesma
http://www.uva.nl/over-de-uva/organisatie/medewerkers/content/h/a/j.l.h.hartmann/j.l.h.hartmann.html



On 3/1/2017 12:43 PM, Rahkonen Jukka (MML) wrote:
>
> Forwarding to the list because Jordan’s trial  was not successful.
>
> Jordan Bess wrote:
>
> Re: [gdal-dev] Don't we have any ideas for GSoC 2017?
>
> Vector tiles! Mbtiles or folder of pbf
>
> It would be great if OGR supported creation of vector tiles in 
> protocol buff format
>
> Get Outlook for Android <https://aka.ms/ghei36>
>
> ------------------------------------------------------------------------
>
> *From:*gdal-dev <gdal-dev-bounces at lists.osgeo.org 
> <mailto:gdal-dev-bounces at lists.osgeo.org>> on behalf of Casper 
> Børgesen (CABO) <CABO at NIRAS.DK <mailto:CABO at NIRAS.DK>>
> *Sent:* Tuesday, February 28, 2017 5:16:19 AM
> *To:* Rahkonen Jukka (MML); 'gdal-dev at lists.osgeo.org' 
> (gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>)
> *Subject:* Re: [gdal-dev] Don't we have any ideas for GSoC 2017?
>
> Hi,
>
> I don't know if the idea is too simple, but implementing indexing on 
> VRT files would be great to have. I thinks it's currently a feature 
> request.
>
>
> Regards, Casper
>
>
> -----Original Message-----
> From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of 
> Rahkonen Jukka (MML)
> Sent: 28. februar 2017 09:07
> To: 'gdal-dev at lists.osgeo.org' (gdal-dev at lists.osgeo.org 
> <mailto:gdal-dev at lists.osgeo.org>)
> Subject: [gdal-dev] Don't we have any ideas for GSoC 2017?
>
> Hi,
>
> OSGeo is accepted as an organization for the Google Summer of Code 
> 2017 but there are no GDAL related ideas on 
> https://wiki.osgeo.org/wiki/Google_Summer_of_Code_2017_Ideas. Could we 
> raise some of the old ideas or discover some brand new ones?
>
> -Jukka Rahkonen-
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170301/6fca568c/attachment.html>

From even.rouault at spatialys.com  Wed Mar  1 04:24:52 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 01 Mar 2017 13:24:52 +0100
Subject: [gdal-dev] FW:  Don't we have any ideas for GSoC 2017?
In-Reply-To: <19bfbde4d32b49ae91cd91abe51eeea6@C119S212VM022.msvyvi.vaha.local>
References: <19bfbde4d32b49ae91cd91abe51eeea6@C119S212VM022.msvyvi.vaha.local>
Message-ID: <1577612.2CTimI2HbM@even-i700>

On mercredi 1 mars 2017 11:43:12 CET Rahkonen Jukka (MML) wrote:
> Forwarding to the list because Jordan's trial  was not successful.

Sounds a good idea. I think potential students should be more pro-active in proposing and 
developing their own ideas.

Regarding "indexing on VRT files", I guess this is about spatial indexing of sources in a VRT 
file. My bet would be that the size of VRT files that would need such indexing would be so 
large than their parsing would be the most limiting factor. But I can be wrong.
Some people who want to make a mosaic from a huge number of tiles do that by making 
VRTs of VRTs of VRTs with a pyramid structure to avoid parsing a lot of XML and still having 
good performance.
Another option that has been mentionned in the past would be to have a variation of the 
VRT syntax that would reference a tile index (shapefile or any OGR datasource) and would 
thus benefit from its spatial indexing & filtering capabilities

Something like:

<VRTDataset rasterXSize="20000" rasterYSize="20000">
  <SRS>EPSG:26711</SRS>
  <GeoTransform>  4.4072000000000000e+05,  6.0000000000000000e+01,  
0.0000000000000000e+00,  3.7513200000000000e+06,  0.0000000000000000e+00, 
-6.0000000000000000e+01</GeoTransform>
   <TileIndex>
	<Filename relativeToVRT="1">index.shp</Filename>
	<!-- <Layername>index</Layername> -->
  </Tileindex> 
  <Overview rasterXSize="10000" rasterYSize="10000">
      <TileIndex>
	   <Filename relativeToVRT="1">index_ovr_2.shp</Filename>
     </Tileindex> 
  </Overview>
  <Overview rasterXSize="5000" rasterYSize="5000">
      <TileIndex>
	   <Filename relativeToVRT="1">index_ovr_4.shp</Filename>
     </Tileindex> 
  </Overview>
  <VRTRasterBand dataType="Byte" band="1">
    <ColorInterp>Red</ColorInterp>
  </VRTRasterBand>
  <VRTRasterBand dataType="Byte" band="2">
    <ColorInterp>Green</ColorInterp>
  </VRTRasterBand>
  <VRTRasterBand dataType="Byte" band="3">
    <ColorInterp>Blue</ColorInterp>
  </VRTRasterBand>
</VRTDataset>

Even

> Jordan Bess wrote:
> Re: [gdal-dev] Don't we have any ideas for GSoC 2017?
> 
> 
> Vector tiles! Mbtiles or folder of pbf
> 
> It would be great if OGR supported creation of vector tiles in protocol buff
> format
> 
> Get Outlook for Android<https://aka.ms/ghei36>
> 
> ________________________________
> From: gdal-dev
> <gdal-dev-bounces at lists.osgeo.org<mailto:gdal-dev-bounces at lists.osgeo.org>>
> on behalf of Casper Børgesen (CABO) <CABO at NIRAS.DK<mailto:CABO at NIRAS.DK>>
> Sent: Tuesday, February 28, 2017 5:16:19 AM
> To: Rahkonen Jukka (MML); 'gdal-dev at lists.osgeo.org'
> (gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>) Subject: Re:
> [gdal-dev] Don't we have any ideas for GSoC 2017?
> 
> Hi,
> 
> I don't know if the idea is too simple, but implementing indexing on VRT
> files would be great to have. I thinks it's currently a feature request.
> 
> 
> Regards, Casper
> 
> 
> -----Original Message-----
> From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of
> Rahkonen Jukka (MML) Sent: 28. februar 2017 09:07
> To: 'gdal-dev at lists.osgeo.org'
> (gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>) Subject:
> [gdal-dev] Don't we have any ideas for GSoC 2017?
> 
> Hi,
> 
> OSGeo is accepted as an organization for the Google Summer of Code 2017 but
> there are no GDAL related ideas on
> https://wiki.osgeo.org/wiki/Google_Summer_of_Code_2017_Ideas. Could we
> raise some of the old ideas or discover some brand new ones?
> 
> -Jukka Rahkonen-
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170301/e74c6783/attachment-0001.html>

From CABO at NIRAS.DK  Wed Mar  1 04:44:29 2017
From: CABO at NIRAS.DK (=?iso-8859-1?Q?Casper_B=F8rgesen_=28CABO=29?=)
Date: Wed, 1 Mar 2017 12:44:29 +0000
Subject: [gdal-dev] FW:  Don't we have any ideas for GSoC 2017?
In-Reply-To: <1577612.2CTimI2HbM@even-i700>
References: <19bfbde4d32b49ae91cd91abe51eeea6@C119S212VM022.msvyvi.vaha.local>
 <1577612.2CTimI2HbM@even-i700>
Message-ID: <BCF6B63AE0B25941A7F56567B58A2805C5829532@allkexa1.NIRAS.INT>

Yes this is about spatial indexing :)

Without looking at the actual VRT code I would guess that parsing the VRT file is one thing, but having a VRT file with +100,000 tiles would require GDAL to look through each tile every time a pixel is requested?
Even, if your idea below could be implemented into the VRT driver to be able to build the index file and gdaladdo to build the overview index files, it would be a huge step forward.

Is it possible to build the index on the fly into memory when opening the VRT file? Is it too memory or time consuming?

/Casper

From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Even Rouault
Sent: 1. marts 2017 13:25
To: gdal-dev at lists.osgeo.org
Cc: Rahkonen Jukka (MML)
Subject: Re: [gdal-dev] FW: Don't we have any ideas for GSoC 2017?


On mercredi 1 mars 2017 11:43:12 CET Rahkonen Jukka (MML) wrote:

> Forwarding to the list because Jordan's trial was not successful.



Sounds a good idea. I think potential students should be more pro-active in proposing and developing their own ideas.



Regarding "indexing on VRT files", I guess this is about spatial indexing of sources in a VRT file. My bet would be that the size of VRT files that would need such indexing would be so large than their parsing would be the most limiting factor. But I can be wrong.

Some people who want to make a mosaic from a huge number of tiles do that by making VRTs of VRTs of VRTs with a pyramid structure to avoid parsing a lot of XML and still having good performance.

Another option that has been mentionned in the past would be to have a variation of the VRT syntax that would reference a tile index (shapefile or any OGR datasource) and would thus benefit from its spatial indexing & filtering capabilities



Something like:



<VRTDataset rasterXSize="20000" rasterYSize="20000">

<SRS>EPSG:26711</SRS>

<GeoTransform> 4.4072000000000000e+05, 6.0000000000000000e+01, 0.0000000000000000e+00, 3.7513200000000000e+06, 0.0000000000000000e+00, -6.0000000000000000e+01</GeoTransform>

<TileIndex>

<Filename relativeToVRT="1">index.shp</Filename>

<!-- <Layername>index</Layername> -->

</Tileindex>

<Overview rasterXSize="10000" rasterYSize="10000">

<TileIndex>

<Filename relativeToVRT="1">index_ovr_2.shp</Filename>

</Tileindex>

</Overview>

<Overview rasterXSize="5000" rasterYSize="5000">

<TileIndex>

<Filename relativeToVRT="1">index_ovr_4.shp</Filename>

</Tileindex>

</Overview>

<VRTRasterBand dataType="Byte" band="1">

<ColorInterp>Red</ColorInterp>

</VRTRasterBand>

<VRTRasterBand dataType="Byte" band="2">

<ColorInterp>Green</ColorInterp>

</VRTRasterBand>

<VRTRasterBand dataType="Byte" band="3">

<ColorInterp>Blue</ColorInterp>

</VRTRasterBand>

</VRTDataset>



Even
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170301/a48dd0b0/attachment.html>

From even.rouault at spatialys.com  Wed Mar  1 04:59:14 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 01 Mar 2017 13:59:14 +0100
Subject: [gdal-dev] FW:  Don't we have any ideas for GSoC 2017?
In-Reply-To: <BCF6B63AE0B25941A7F56567B58A2805C5829532@allkexa1.NIRAS.INT>
References: <19bfbde4d32b49ae91cd91abe51eeea6@C119S212VM022.msvyvi.vaha.local>
 <1577612.2CTimI2HbM@even-i700>
 <BCF6B63AE0B25941A7F56567B58A2805C5829532@allkexa1.NIRAS.INT>
Message-ID: <2376909.DervlFI7QX@even-i700>

On mercredi 1 mars 2017 12:44:29 CET Casper Børgesen (CABO) wrote:
> Yes this is about spatial indexing :)
> 
> Without looking at the actual VRT code I would guess that parsing the VRT
> file is one thing, but having a VRT file with +100,000 tiles 

Let's say at least 100 bytes for each source declaration, 100 000 tiles would be at least 10 MB 
for the VRT. Big, but perhaps not that much, if it is left open in a quite long section

> would require
> GDAL to look through each tile every time a pixel is requested?

Yes, if you do single pixel queries, that might have bad performance. If you do more 
significant extractions, the cost might decrease.

> Even, if
> your idea below could be implemented into the VRT driver to be able to
> build the index file and gdaladdo to build the overview index files, it
> would be a huge step forward.

Building the index file is the job of gdaltindex. Regarding the overviews, you could have 
several variants: either you have a set of overview tiles, or you can also build the overview 
from the full resolution .vrt

> 
> Is it possible to build the index on the fly into memory when opening the
> VRT file? Is it too memory or time consuming?

If one keeps the current syntax with many XML sources, yes on-the-fly indexing would be the 
only reasonable solution. I don't anticipate it would be particularly memory or time 
consuming for a "reasonable" number of tiles (let's say less than 10 millions). There's already 
infrastructure for that in GDAL, port/cpl_quad_tree.h. Used by the OpenFileGDB driver for 
example since it cannot currently use the native spatia index.

> 
> /Casper
> 
> From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Even
> Rouault Sent: 1. marts 2017 13:25
> To: gdal-dev at lists.osgeo.org
> Cc: Rahkonen Jukka (MML)
> Subject: Re: [gdal-dev] FW: Don't we have any ideas for GSoC 2017?
> 
> On mercredi 1 mars 2017 11:43:12 CET Rahkonen Jukka (MML) wrote:
> > Forwarding to the list because Jordan's trial was not successful.
> 
> Sounds a good idea. I think potential students should be more pro-active in
> proposing and developing their own ideas.
> 
> 
> 
> Regarding "indexing on VRT files", I guess this is about spatial indexing of
> sources in a VRT file. My bet would be that the size of VRT files that
> would need such indexing would be so large than their parsing would be the
> most limiting factor. But I can be wrong.
> 
> Some people who want to make a mosaic from a huge number of tiles do that by
> making VRTs of VRTs of VRTs with a pyramid structure to avoid parsing a lot
> of XML and still having good performance.
> 
> Another option that has been mentionned in the past would be to have a
> variation of the VRT syntax that would reference a tile index (shapefile or
> any OGR datasource) and would thus benefit from its spatial indexing &
> filtering capabilities
> 
> 
> 
> Something like:
> 
> 
> 
> <VRTDataset rasterXSize="20000" rasterYSize="20000">
> 
> <SRS>EPSG:26711</SRS>
> 
> <GeoTransform> 4.4072000000000000e+05, 6.0000000000000000e+01,
> 0.0000000000000000e+00, 3.7513200000000000e+06, 0.0000000000000000e+00,
> -6.0000000000000000e+01</GeoTransform>
> 
> <TileIndex>
> 
> <Filename relativeToVRT="1">index.shp</Filename>
> 
> <!-- <Layername>index</Layername> -->
> 
> </Tileindex>
> 
> <Overview rasterXSize="10000" rasterYSize="10000">
> 
> <TileIndex>
> 
> <Filename relativeToVRT="1">index_ovr_2.shp</Filename>
> 
> </Tileindex>
> 
> </Overview>
> 
> <Overview rasterXSize="5000" rasterYSize="5000">
> 
> <TileIndex>
> 
> <Filename relativeToVRT="1">index_ovr_4.shp</Filename>
> 
> </Tileindex>
> 
> </Overview>
> 
> <VRTRasterBand dataType="Byte" band="1">
> 
> <ColorInterp>Red</ColorInterp>
> 
> </VRTRasterBand>
> 
> <VRTRasterBand dataType="Byte" band="2">
> 
> <ColorInterp>Green</ColorInterp>
> 
> </VRTRasterBand>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170301/e4e5106b/attachment-0001.html>

From schwehr at gmail.com  Wed Mar  1 05:59:36 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Wed, 1 Mar 2017 05:59:36 -0800
Subject: [gdal-dev] ENVI Rotation Bug Fix
In-Reply-To: <CAJjdW1yksCJoCKT3JZZYTL2U8-scP8ZtQsFAmRcwjqRAPsWSyA@mail.gmail.com>
References: <a618291a-3dfc-d22f-2348-10d098058cfd@oregonstate.edu>
 <CAJjdW1wnNOUxS1EWwEQFDDTESjOe9d_rVs=-Fw_GfRuuWeGBRw@mail.gmail.com>
 <CALBeTKL-_i177ni87837pVhxM0QAGwJnmBb_hQO-A-j2yzWViw@mail.gmail.com>
 <CAJjdW1yksCJoCKT3JZZYTL2U8-scP8ZtQsFAmRcwjqRAPsWSyA@mail.gmail.com>
Message-ID: <CACmBxyuHm1AmAO5E9E4iVgYbP-cRfBJvxXf6aSjGKwYhkgr8cw@mail.gmail.com>

Warning... I did a cleanup pass and split out the class definitions into a
header to allow direct C++ testing.

https://trac.osgeo.org/gdal/changeset/37530
https://trac.osgeo.org/gdal/changeset/37514
https://trac.osgeo.org/gdal/changeset/37510

I haven't written that testing yet, but it will be similar to this:

https://github.com/schwehr/gdal-autotest2/blob/master/cpp/frmts/jp2kak/jp2kakdataset_test.cc

-kurt

On Wed, Mar 1, 2017 at 2:56 AM, Damian Dixon <damian.dixon at gmail.com> wrote:

> Hi Taylor,
>
> M_PI is defined pretty much everywhere. The only compiler that you have to
> jump through hoops to get it is Visual Studio where you have to define '#define
> _USE_MATH_DEFINES'.
>
> As Even has mentioned it's also defined in the GDAL portability header.
>
> The main reason the use of atan jumped out is that I've run into problems
> with atan on Intel CPUs and GPUs in the past. Also the use of trig' of any
> sort is expensive so I tend to take a look to see if it can be removed or
> moved.
>
> I spotted that this is a very old bug so I'm pleased that you've taken the
> time to fix it.
>
> Regards
> Damian
>
>
>
> On 27 February 2017 at 22:12, Brown, Taylor Alexander <
> browtayl at oregonstate.edu> wrote:
>
>> Damian,
>>
>> I agree that it would be preferable to use a predefined constant.
>> However, I was under the impression that M_PI is a compiler extension and
>> not part of standard C++, so I wanted to make sure it was compatible. If
>> using M_PI is acceptable, I would be happy to change it. I will be
>> submitting my pull request shortly.
>>
>>
>> Taylor
>>
>> On Mon, Feb 27, 2017 at 5:01 AM, Damian Dixon <damian.dixon at gmail.com>
>> wrote:
>>
>>> Hi Taylor,
>>>
>>> I'm just lurking on the mailing list myself.
>>>
>>> I had a look at the code changes, as this is one of the formats I'm
>>> interested in, and one point springs out at me:
>>>
>>> const double PI = atan(1.0) * 4;
>>>
>>> I find this line potentially a confusing way to define PI, particularly
>>> when you combine it with (PI/180) later.
>>>
>>> Personally I would use M_PI.
>>>
>>> Regards
>>> Damian
>>>
>>>
>>>
>>> On 27 February 2017 at 11:55, Taylor Alexander Brown <
>>> browtayl at oregonstate.edu> wrote:
>>>
>>>> Greetings GDAL Community,
>>>>
>>>> I am developing an application [0] to process georeferenced raster
>>>> hyperspectral imagery in ENVI format from NASA's Airborne
>>>> Visual/Infrared Imaging Spectrometer (AVIRIS) [1].
>>>>
>>>> The `map info` section of the header files contain an undocumented [2]
>>>> rotation field which is currently ignored by GDAL. As a result, the
>>>> image is rotated incorrectly when I process it with `gdalwarp` or the
>>>> GDAL Python API. Furthermore, the image is scaled incorrectly when I try
>>>> to override the geotransform.
>>>>
>>>> I documented my experiences on the GIS Stack Exchange [3]. It has
>>>> previously been described on the GDAL mailing list [4] and bug tracker
>>>> [5]. I believe this issue also affects ASTER imagery [6][7].
>>>>
>>>> I have implemented a fix based off of branch `tags/2.1.3` and shared my
>>>> code on GitHub [8]. It reads the `units` and `rotation` parameter from
>>>> the `map info` section and uses these to calculate the geotransform. The
>>>> scaling was off because the code expected the `units` parameter to be
>>>> the last element in the list, when in my case it was the second to last.
>>>> You can verify this behavior with the single-band image I have been
>>>> using for testing [9].
>>>>
>>>> You are welcome to evaluate my code and contribute it back to the
>>>> library. I am a novice at both GDAL and GIS, so there may well be
>>>> problems. I would be willing to submit a pull request against your
>>>> GitHub mirror if desired.
>>>>
>>>>
>>>> Peace,
>>>>
>>>> Taylor Alexander Brown
>>>>
>>>>
>>>> [0] https://github.com/capstone-coal/pycoal
>>>> [1] https://aviris.jpl.nasa.gov/
>>>> [2] http://www.harrisgeospatial.com/docs/enviheaderfiles.html
>>>> [3]
>>>> http://gis.stackexchange.com/questions/229952/rotate-envi-hy
>>>> perspectral-imagery-with-gdal
>>>> [4] https://lists.osgeo.org/pipermail/gdal-dev/2013-January/035146.html
>>>> [5] https://trac.osgeo.org/gdal/ticket/1778
>>>> [6] http://yceo.yale.edu/opening-aster-files-envi
>>>> [7] http://yceo.yale.edu/faq-page#t2n504
>>>> [8]
>>>> https://github.com/OSGeo/gdal/compare/tags/2.1.3...browtayl:
>>>> fix-envi-rotation?expand=1
>>>> [9] https://drive.google.com/open?id=0BxysdOuBmaIGalY5dVhCa1Y5M0k
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev at lists.osgeo.org
>>>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>>
>>>
>>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170301/dae3958a/attachment.html>

From even.rouault at spatialys.com  Wed Mar  1 06:15:56 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 01 Mar 2017 15:15:56 +0100
Subject: [gdal-dev] ENVI Rotation Bug Fix
In-Reply-To: <CACmBxyuHm1AmAO5E9E4iVgYbP-cRfBJvxXf6aSjGKwYhkgr8cw@mail.gmail.com>
References: <a618291a-3dfc-d22f-2348-10d098058cfd@oregonstate.edu>
 <CAJjdW1yksCJoCKT3JZZYTL2U8-scP8ZtQsFAmRcwjqRAPsWSyA@mail.gmail.com>
 <CACmBxyuHm1AmAO5E9E4iVgYbP-cRfBJvxXf6aSjGKwYhkgr8cw@mail.gmail.com>
Message-ID: <2124872.PYPb0Hzceu@even-i700>

Kurt,

I don't think the ENVIDataset class is exported (and that's a good thing), so direct testing of 
the class might only be possible if you build without --with-hide-internal-symbols.

Why can't you test through the public GDAL API instead of directly depnding on 
implementation details ? Actually looking at the class definitions of the ENVI driver, the 
only public methods are virtual methods from the public API, so there's no advantage on 
directly depending on it.

Even

> Warning... I did a cleanup pass and split out the class definitions into a
> header to allow direct C++ testing.
> 
> https://trac.osgeo.org/gdal/changeset/37530
> https://trac.osgeo.org/gdal/changeset/37514
> https://trac.osgeo.org/gdal/changeset/37510
> 
> I haven't written that testing yet, but it will be similar to this:
> 
> https://github.com/schwehr/gdal-autotest2/blob/master/cpp/frmts/jp2kak/jp2ka
> kdataset_test.cc
> 
> -kurt
> 
> On Wed, Mar 1, 2017 at 2:56 AM, Damian Dixon <damian.dixon at gmail.com> wrote:
> > Hi Taylor,
> > 
> > M_PI is defined pretty much everywhere. The only compiler that you have to
> > jump through hoops to get it is Visual Studio where you have to define
> > '#define _USE_MATH_DEFINES'.
> > 
> > As Even has mentioned it's also defined in the GDAL portability header.
> > 
> > The main reason the use of atan jumped out is that I've run into problems
> > with atan on Intel CPUs and GPUs in the past. Also the use of trig' of any
> > sort is expensive so I tend to take a look to see if it can be removed or
> > moved.
> > 
> > I spotted that this is a very old bug so I'm pleased that you've taken the
> > time to fix it.
> > 
> > Regards
> > Damian
> > 
> > 
> > 
> > On 27 February 2017 at 22:12, Brown, Taylor Alexander <
> > 
> > browtayl at oregonstate.edu> wrote:
> >> Damian,
> >> 
> >> I agree that it would be preferable to use a predefined constant.
> >> However, I was under the impression that M_PI is a compiler extension and
> >> not part of standard C++, so I wanted to make sure it was compatible. If
> >> using M_PI is acceptable, I would be happy to change it. I will be
> >> submitting my pull request shortly.
> >> 
> >> 
> >> Taylor
> >> 
> >> On Mon, Feb 27, 2017 at 5:01 AM, Damian Dixon <damian.dixon at gmail.com>
> >> 
> >> wrote:
> >>> Hi Taylor,
> >>> 
> >>> I'm just lurking on the mailing list myself.
> >>> 
> >>> I had a look at the code changes, as this is one of the formats I'm
> >>> interested in, and one point springs out at me:
> >>> 
> >>> const double PI = atan(1.0) * 4;
> >>> 
> >>> I find this line potentially a confusing way to define PI, particularly
> >>> when you combine it with (PI/180) later.
> >>> 
> >>> Personally I would use M_PI.
> >>> 
> >>> Regards
> >>> Damian
> >>> 
> >>> 
> >>> 
> >>> On 27 February 2017 at 11:55, Taylor Alexander Brown <
> >>> 
> >>> browtayl at oregonstate.edu> wrote:
> >>>> Greetings GDAL Community,
> >>>> 
> >>>> I am developing an application [0] to process georeferenced raster
> >>>> hyperspectral imagery in ENVI format from NASA's Airborne
> >>>> Visual/Infrared Imaging Spectrometer (AVIRIS) [1].
> >>>> 
> >>>> The `map info` section of the header files contain an undocumented [2]
> >>>> rotation field which is currently ignored by GDAL. As a result, the
> >>>> image is rotated incorrectly when I process it with `gdalwarp` or the
> >>>> GDAL Python API. Furthermore, the image is scaled incorrectly when I
> >>>> try
> >>>> to override the geotransform.
> >>>> 
> >>>> I documented my experiences on the GIS Stack Exchange [3]. It has
> >>>> previously been described on the GDAL mailing list [4] and bug tracker
> >>>> [5]. I believe this issue also affects ASTER imagery [6][7].
> >>>> 
> >>>> I have implemented a fix based off of branch `tags/2.1.3` and shared my
> >>>> code on GitHub [8]. It reads the `units` and `rotation` parameter from
> >>>> the `map info` section and uses these to calculate the geotransform.
> >>>> The
> >>>> scaling was off because the code expected the `units` parameter to be
> >>>> the last element in the list, when in my case it was the second to
> >>>> last.
> >>>> You can verify this behavior with the single-band image I have been
> >>>> using for testing [9].
> >>>> 
> >>>> You are welcome to evaluate my code and contribute it back to the
> >>>> library. I am a novice at both GDAL and GIS, so there may well be
> >>>> problems. I would be willing to submit a pull request against your
> >>>> GitHub mirror if desired.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170301/e44c2b29/attachment-0001.html>

From schwehr at gmail.com  Wed Mar  1 07:03:04 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Wed, 1 Mar 2017 07:03:04 -0800
Subject: [gdal-dev] ENVI Rotation Bug Fix
In-Reply-To: <2124872.PYPb0Hzceu@even-i700>
References: <a618291a-3dfc-d22f-2348-10d098058cfd@oregonstate.edu>
 <CAJjdW1yksCJoCKT3JZZYTL2U8-scP8ZtQsFAmRcwjqRAPsWSyA@mail.gmail.com>
 <CACmBxyuHm1AmAO5E9E4iVgYbP-cRfBJvxXf6aSjGKwYhkgr8cw@mail.gmail.com>
 <2124872.PYPb0Hzceu@even-i700>
Message-ID: <CACmBxyvPHvjVRtC7S4-_dKQYDW9gAeg5z8i6OGirTYXevqkE8w@mail.gmail.com>

Even,

I already do direct tests with jp2kakdataset_test.cc with bazel and it
works great.  I can directly probe the methods without worrying about any
other mechanism getting between the test and the class.  e.g. I can
directly mess with Identify, Open and any helpers.  I can also do things
like disable identify so that fuzzing can more quickly get into the guts
and find trouble:

https://trac.osgeo.org/gdal/browser/trunk/gdal/frmts/jp2kak/jp2kakdataset.cpp#L812

GDALDataset *JP2KAKDataset::Open( GDALOpenInfo * poOpenInfo ) {
#ifndef FUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION
    // During fuzzing, do not use Identify to reject crazy content.
    if( !Identify(poOpenInfo) )
        return NULL;
#endif

We are putting resources behind this... we are running fuzzing on jp2kak
and related.  e.g. with >600K core hours of fuzzing this month (> 14e12
iterations).

If I don't break things apart, fuzzing a component goes much slower and is
far less likely to identify issues in the lower level components and libs.


On Wed, Mar 1, 2017 at 6:15 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Kurt,
>
>
>
> I don't think the ENVIDataset class is exported (and that's a good thing),
> so direct testing of the class might only be possible if you build without
> --with-hide-internal-symbols.
>
>
>
> Why can't you test through the public GDAL API instead of directly
> depnding on implementation details ? Actually looking at the class
> definitions of the ENVI driver, the only public methods are virtual methods
> from the public API, so there's no advantage on directly depending on it.
>
>
>
> Even
>
>
>
> > Warning... I did a cleanup pass and split out the class definitions into
> a
>
> > header to allow direct C++ testing.
>
> >
>
> > https://trac.osgeo.org/gdal/changeset/37530
>
> > https://trac.osgeo.org/gdal/changeset/37514
>
> > https://trac.osgeo.org/gdal/changeset/37510
>
> >
>
> > I haven't written that testing yet, but it will be similar to this:
>
> >
>
> > https://github.com/schwehr/gdal-autotest2/blob/master/
> cpp/frmts/jp2kak/jp2ka
>
> > kdataset_test.cc
>
> >
>
> > -kurt
>
> >
>
> > On Wed, Mar 1, 2017 at 2:56 AM, Damian Dixon <damian.dixon at gmail.com>
> wrote:
>
> > > Hi Taylor,
>
> > >
>
> > > M_PI is defined pretty much everywhere. The only compiler that you
> have to
>
> > > jump through hoops to get it is Visual Studio where you have to define
>
> > > '#define _USE_MATH_DEFINES'.
>
> > >
>
> > > As Even has mentioned it's also defined in the GDAL portability header.
>
> > >
>
> > > The main reason the use of atan jumped out is that I've run into
> problems
>
> > > with atan on Intel CPUs and GPUs in the past. Also the use of trig' of
> any
>
> > > sort is expensive so I tend to take a look to see if it can be removed
> or
>
> > > moved.
>
> > >
>
> > > I spotted that this is a very old bug so I'm pleased that you've taken
> the
>
> > > time to fix it.
>
> > >
>
> > > Regards
>
> > > Damian
>
> > >
>
> > >
>
> > >
>
> > > On 27 February 2017 at 22:12, Brown, Taylor Alexander <
>
> > >
>
> > > browtayl at oregonstate.edu> wrote:
>
> > >> Damian,
>
> > >>
>
> > >> I agree that it would be preferable to use a predefined constant.
>
> > >> However, I was under the impression that M_PI is a compiler extension
> and
>
> > >> not part of standard C++, so I wanted to make sure it was compatible.
> If
>
> > >> using M_PI is acceptable, I would be happy to change it. I will be
>
> > >> submitting my pull request shortly.
>
> > >>
>
> > >>
>
> > >> Taylor
>
> > >>
>
> > >> On Mon, Feb 27, 2017 at 5:01 AM, Damian Dixon <damian.dixon at gmail.com
> >
>
> > >>
>
> > >> wrote:
>
> > >>> Hi Taylor,
>
> > >>>
>
> > >>> I'm just lurking on the mailing list myself.
>
> > >>>
>
> > >>> I had a look at the code changes, as this is one of the formats I'm
>
> > >>> interested in, and one point springs out at me:
>
> > >>>
>
> > >>> const double PI = atan(1.0) * 4;
>
> > >>>
>
> > >>> I find this line potentially a confusing way to define PI,
> particularly
>
> > >>> when you combine it with (PI/180) later.
>
> > >>>
>
> > >>> Personally I would use M_PI.
>
> > >>>
>
> > >>> Regards
>
> > >>> Damian
>
> > >>>
>
> > >>>
>
> > >>>
>
> > >>> On 27 February 2017 at 11:55, Taylor Alexander Brown <
>
> > >>>
>
> > >>> browtayl at oregonstate.edu> wrote:
>
> > >>>> Greetings GDAL Community,
>
> > >>>>
>
> > >>>> I am developing an application [0] to process georeferenced raster
>
> > >>>> hyperspectral imagery in ENVI format from NASA's Airborne
>
> > >>>> Visual/Infrared Imaging Spectrometer (AVIRIS) [1].
>
> > >>>>
>
> > >>>> The `map info` section of the header files contain an undocumented
> [2]
>
> > >>>> rotation field which is currently ignored by GDAL. As a result, the
>
> > >>>> image is rotated incorrectly when I process it with `gdalwarp` or
> the
>
> > >>>> GDAL Python API. Furthermore, the image is scaled incorrectly when I
>
> > >>>> try
>
> > >>>> to override the geotransform.
>
> > >>>>
>
> > >>>> I documented my experiences on the GIS Stack Exchange [3]. It has
>
> > >>>> previously been described on the GDAL mailing list [4] and bug
> tracker
>
> > >>>> [5]. I believe this issue also affects ASTER imagery [6][7].
>
> > >>>>
>
> > >>>> I have implemented a fix based off of branch `tags/2.1.3` and
> shared my
>
> > >>>> code on GitHub [8]. It reads the `units` and `rotation` parameter
> from
>
> > >>>> the `map info` section and uses these to calculate the geotransform.
>
> > >>>> The
>
> > >>>> scaling was off because the code expected the `units` parameter to
> be
>
> > >>>> the last element in the list, when in my case it was the second to
>
> > >>>> last.
>
> > >>>> You can verify this behavior with the single-band image I have been
>
> > >>>> using for testing [9].
>
> > >>>>
>
> > >>>> You are welcome to evaluate my code and contribute it back to the
>
> > >>>> library. I am a novice at both GDAL and GIS, so there may well be
>
> > >>>> problems. I would be willing to submit a pull request against your
>
> > >>>> GitHub mirror if desired.
>
> > >>>>
>
> > >>>>
>
> > >>>> Peace,
>
> > >>>>
>
> > >>>> Taylor Alexander Brown
>
> > >>>>
>
> > >>>>
>
> > >>>> [0] https://github.com/capstone-coal/pycoal
>
> > >>>> [1] https://aviris.jpl.nasa.gov/
>
> > >>>> [2] http://www.harrisgeospatial.com/docs/enviheaderfiles.html
>
> > >>>> [3]
>
> > >>>> http://gis.stackexchange.com/questions/229952/rotate-envi-hy
>
> > >>>> perspectral-imagery-with-gdal
>
> > >>>> [4] https://lists.osgeo.org/pipermail/gdal-dev/2013-
> January/035146.html
>
> > >>>> [5] https://trac.osgeo.org/gdal/ticket/1778
>
> > >>>> [6] http://yceo.yale.edu/opening-aster-files-envi
>
> > >>>> [7] http://yceo.yale.edu/faq-page#t2n504
>
> > >>>> [8]
>
> > >>>> https://github.com/OSGeo/gdal/compare/tags/2.1.3...browtayl:
>
> > >>>> fix-envi-rotation?expand=1
>
> > >>>> [9] https://drive.google.com/open?id=0BxysdOuBmaIGalY5dVhCa1Y5M0k
>
> > >>>> _______________________________________________
>
> > >>>> gdal-dev mailing list
>
> > >>>> gdal-dev at lists.osgeo.org
>
> > >>>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> > >
>
> > > _______________________________________________
>
> > > gdal-dev mailing list
>
> > > gdal-dev at lists.osgeo.org
>
> > > https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170301/22e37532/attachment-0001.html>

From Ahmed.Tolba at schiebel.net  Wed Mar  1 08:26:27 2017
From: Ahmed.Tolba at schiebel.net (Ahmed Tolba)
Date: Wed, 1 Mar 2017 16:26:27 +0000
Subject: [gdal-dev] Getting the points from multipoints datatype
Message-ID: <4474f74de82e42f2886c8019b5a5c12f@SRV046.seg.local>

Hi All,
I'm trying to get the multi points out of a geometry, how would I retrieve the points ?

// Variable initialised to contain Geometry point data for the field at the current index of i
                        OGRGeometry *Geometry = Feature->GetGeometryRef();
                        if(Geometry != NULL && wkbFlatten(Geometry->getGeometryType()) == wkbMultiPoint)
                        {
                              OGRMultiPoint *poMultipoint = ( OGRMultiPoint * )Geometry;
                              int NumberOfGeometries = poMultipoint->getNumGeometries();

                             // get points
                         }

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170301/0b40ea8a/attachment.html>

From alexander.bruy at gmail.com  Wed Mar  1 09:56:30 2017
From: alexander.bruy at gmail.com (Alexander Bruy)
Date: Wed, 1 Mar 2017 19:56:30 +0200
Subject: [gdal-dev] Adding more stuff to Python bindings
Message-ID: <CALuHMPCpHjHf6t_Nns1TeBcMAMNEUHNbyDViH02+2BhXMn9D5Q@mail.gmail.com>

Hi devs,

I want to add to Python bindings some functions which currently are
available only
in C API. Are there any instructions about how to proceed? As I
understand, I need to add function declaration to the
swing/include/Operations.i and also add missed
type definitions somewhere. Is this correct approach?

Thanks
-- 
Alexander Bruy

From even.rouault at spatialys.com  Wed Mar  1 10:06:42 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 01 Mar 2017 19:06:42 +0100
Subject: [gdal-dev] Adding more stuff to Python bindings
In-Reply-To: <CALuHMPCpHjHf6t_Nns1TeBcMAMNEUHNbyDViH02+2BhXMn9D5Q@mail.gmail.com>
References: <CALuHMPCpHjHf6t_Nns1TeBcMAMNEUHNbyDViH02+2BhXMn9D5Q@mail.gmail.com>
Message-ID: <33100977.ks6S1lyfVc@even-i700>

On mercredi 1 mars 2017 19:56:30 CET Alexander Bruy wrote:
> nly
> in C API. Are there any instructions about how to proceed? As I
> understand, I need to add function declaration to the
> swing/include/Operations.i 

Yes, in Operations.i, for things that are typically in gdal_alg.h . For other stuff, other .i might 
be more appropriate

> and also add missed
> type definitions somewhere. 

Yes, in swig/include/python/typemaps.i

If your method requires new typemaps, and they are not available in other languages and 
that you don't know how to add for those languages, you can protect your addition in the .i 
with a #ifdef SWIGPYTHON #endif

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170301/0b4dda92/attachment.html>

From mateusz at loskot.net  Wed Mar  1 12:22:08 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed, 1 Mar 2017 21:22:08 +0100
Subject: [gdal-dev] Getting the points from multipoints datatype
In-Reply-To: <4474f74de82e42f2886c8019b5a5c12f@SRV046.seg.local>
References: <4474f74de82e42f2886c8019b5a5c12f@SRV046.seg.local>
Message-ID: <CABUeae9WwLR4uhOAFi=omcr5rFaTXMy0hL93wYMt+uUZKHOxwQ@mail.gmail.com>

On 1 March 2017 at 17:26, Ahmed Tolba <Ahmed.Tolba at schiebel.net> wrote:
> Hi All,
>
> I’m trying to get the multi points out of a geometry, how would I retrieve
> the points ?
>
> // Variable initialised to contain Geometry point data for the field at the
> current index of i
>
>                         OGRGeometry *Geometry = Feature->GetGeometryRef();
>                         if(Geometry != NULL && wkbFlatten(Geometry->getGeometryType()) == wkbMultiPoint)
>                         {
>                               OGRMultiPoint *poMultipoint = ( OGRMultiPoint * )Geometry;
>                               int NumberOfGeometries = poMultipoint->getNumGeometries();
>
>                              // get points
>                          }


"Look at the code, Luke!"

Namely, check implementation of the OGRMultiPoint::exportToWkt() method in
http://svn.osgeo.org/gdal/trunk/gdal/ogr/ogrmultipoint.cpp

There, you will find this loop:

 for( int i = 0; i < getNumGeometries(); i++ )
{
        OGRPoint *poPoint = (OGRPoint *) getGeometryRef( i );
        ....
}


Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From idan at miara.com  Thu Mar  2 01:32:11 2017
From: idan at miara.com (Idan Miara)
Date: Thu, 2 Mar 2017 11:32:11 +0200
Subject: [gdal-dev] Linking against gdal201.dll with different MSVC versions
Message-ID: <CAEDrt38jkkn5oFBj8LcUsXRnUUyZhodReHftBUnDM-W66euxHw@mail.gmail.com>

Hi,

I'm developing a c++ MSVC (2013 or 2015) program that depends on GDAL.
Currently I'm using the C API, and I might use the C++ API in the future.

I've run dependency walker on the recent version of gdal201.dll that is
distributed in osgeo4w, it depends on msvcr100.dll, thus I assume it was
compiled with MSVC2010.

I was wondering if I could encounter problems with my program for linking
against osgeo4w MSVC2010 gdal201 binaries while my program is compiled with
MSVC 2013 or 2015.
For that matter, does it make a difference if I use GDAL C API or the C++
API?

I see that GDAL can be compiled with MSVC2013 (gisinternals.com), and that
QGIS master is built with MSVC2015.
Is there a good reason for osgeo4w for keep choosing MSVC2010 for GDAL?

Kind Regards,
Idan.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170302/9dda6b76/attachment.html>

From even.rouault at spatialys.com  Thu Mar  2 01:43:16 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 02 Mar 2017 10:43:16 +0100
Subject: [gdal-dev] Linking against gdal201.dll with different MSVC
	versions
In-Reply-To: <CAEDrt38jkkn5oFBj8LcUsXRnUUyZhodReHftBUnDM-W66euxHw@mail.gmail.com>
References: <CAEDrt38jkkn5oFBj8LcUsXRnUUyZhodReHftBUnDM-W66euxHw@mail.gmail.com>
Message-ID: <23282605.xCQC4jrqUS@even-i700>

On jeudi 2 mars 2017 11:32:11 CET Idan Miara wrote:
> Hi,
> 
> I'm developing a c++ MSVC (2013 or 2015) program that depends on GDAL.
> Currently I'm using the C API, and I might use the C++ API in the future.
> 
> I've run dependency walker on the recent version of gdal201.dll that is
> distributed in osgeo4w, it depends on msvcr100.dll, thus I assume it was
> compiled with MSVC2010.
> 
> I was wondering if I could encounter problems with my program for linking
> against osgeo4w MSVC2010 gdal201 binaries while my program is compiled with
> MSVC 2013 or 2015.
> For that matter, does it make a difference if I use GDAL C API or the C++
> API?

Yes. You're probably safe if using different MSVC versions for your code and the GDAL build, 
if you use the C API (that's what QGIS does for example). If you use the C++ API, you'll need 
to use the same compiler and compiler settings.

> 
> I see that GDAL can be compiled with MSVC2013 (gisinternals.com), and that
> QGIS master is built with MSVC2015.
> Is there a good reason for osgeo4w for keep choosing MSVC2010 for GDAL?

Probably because the last GDAL built in OSGeo4W was done with MSVC2010, before the 
recent upgrade to MSVC2015 for QGIS master. I guess the next GDAL builds will be done with 
MSVC2015 too.

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170302/bed1ad10/attachment.html>

From mateusz at loskot.net  Thu Mar  2 01:43:44 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu, 2 Mar 2017 10:43:44 +0100
Subject: [gdal-dev] Linking against gdal201.dll with different MSVC
	versions
In-Reply-To: <CAEDrt38jkkn5oFBj8LcUsXRnUUyZhodReHftBUnDM-W66euxHw@mail.gmail.com>
References: <CAEDrt38jkkn5oFBj8LcUsXRnUUyZhodReHftBUnDM-W66euxHw@mail.gmail.com>
Message-ID: <CABUeae9BXLeGZkdkxr7qJk7SUcZr+BerSHY6n5XveM6dnbWVfQ@mail.gmail.com>

On 2 March 2017 at 10:32, Idan Miara <idan at miara.com> wrote:
> Hi,
>
> I'm developing a c++ MSVC (2013 or 2015) program that depends on GDAL.
> Currently I'm using the C API, and I might use the C++ API in the future.
>
> I've run dependency walker on the recent version of gdal201.dll that is
> distributed in osgeo4w, it depends on msvcr100.dll, thus I assume it was
> compiled with MSVC2010.
>
> I was wondering if I could encounter problems with my program for linking
> against osgeo4w MSVC2010 gdal201 binaries while my program is compiled with
> MSVC 2013 or 2015.
> For that matter, does it make a difference if I use GDAL C API or the C++
> API?

If you stick to GDAL C API and if you know what you are doing
and if you are careful, you should be fine.
GDAL DLL is fairly well isolated, especially in terms of allocations
and deallocations
which all happen inside GDAL DLL and do not cross the DLL/DLL or
DLL/EXE boundaries.
Read about "How should I deallocate resources acquainted from GDAL on
Windows?" here
https://trac.osgeo.org/gdal/wiki/FAQMiscellaneous

> Is there a good reason for osgeo4w for keep choosing MSVC2010 for GDAL?

Possibly, it's due to maintenance vs man power resources.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From idan at miara.com  Thu Mar  2 01:49:00 2017
From: idan at miara.com (Idan Miara)
Date: Thu, 2 Mar 2017 11:49:00 +0200
Subject: [gdal-dev] Linking against gdal201.dll with different MSVC
	versions
In-Reply-To: <CABUeae9BXLeGZkdkxr7qJk7SUcZr+BerSHY6n5XveM6dnbWVfQ@mail.gmail.com>
References: <CAEDrt38jkkn5oFBj8LcUsXRnUUyZhodReHftBUnDM-W66euxHw@mail.gmail.com>
 <CABUeae9BXLeGZkdkxr7qJk7SUcZr+BerSHY6n5XveM6dnbWVfQ@mail.gmail.com>
Message-ID: <CAEDrt398O_D1284OcfX3CH0Ks6wEbcQHw3irBuzzS7Kb3Sv4Pw@mail.gmail.com>

Two great answers in 10 minutes! thanks guys!

On 2 March 2017 at 11:43, Mateusz Loskot <mateusz at loskot.net> wrote:

> On 2 March 2017 at 10:32, Idan Miara <idan at miara.com> wrote:
> > Hi,
> >
> > I'm developing a c++ MSVC (2013 or 2015) program that depends on GDAL.
> > Currently I'm using the C API, and I might use the C++ API in the future.
> >
> > I've run dependency walker on the recent version of gdal201.dll that is
> > distributed in osgeo4w, it depends on msvcr100.dll, thus I assume it was
> > compiled with MSVC2010.
> >
> > I was wondering if I could encounter problems with my program for linking
> > against osgeo4w MSVC2010 gdal201 binaries while my program is compiled
> with
> > MSVC 2013 or 2015.
> > For that matter, does it make a difference if I use GDAL C API or the C++
> > API?
>
> If you stick to GDAL C API and if you know what you are doing
> and if you are careful, you should be fine.
> GDAL DLL is fairly well isolated, especially in terms of allocations
> and deallocations
> which all happen inside GDAL DLL and do not cross the DLL/DLL or
> DLL/EXE boundaries.
> Read about "How should I deallocate resources acquainted from GDAL on
> Windows?" here
> https://trac.osgeo.org/gdal/wiki/FAQMiscellaneous
>
> > Is there a good reason for osgeo4w for keep choosing MSVC2010 for GDAL?
>
> Possibly, it's due to maintenance vs man power resources.
>
> Best regards,
> --
> Mateusz Loskot, http://mateusz.loskot.net
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170302/c96f2fd0/attachment.html>

From jef at norbit.de  Thu Mar  2 02:14:07 2017
From: jef at norbit.de (=?iso-8859-1?B?SvxyZ2VuIEUu?= Fischer)
Date: Thu, 2 Mar 2017 11:14:07 +0100
Subject: [gdal-dev] Linking against gdal201.dll with different MSVC
 versions
In-Reply-To: <23282605.xCQC4jrqUS@even-i700>
References: <CAEDrt38jkkn5oFBj8LcUsXRnUUyZhodReHftBUnDM-W66euxHw@mail.gmail.com>
 <23282605.xCQC4jrqUS@even-i700>
Message-ID: <20170302101407.GA4324@norbit.de>

Hi Even,

On Thu, 02. Mar 2017 at 10:43:16 +0100, Even Rouault wrote:
> Probably because the last GDAL built in OSGeo4W was done with MSVC2010,
> before the recent upgrade to MSVC2015 for QGIS master. I guess the next GDAL
> builds will be done with MSVC2015 too.

Well, if the third party dependencies (like filegdb - which I happend to start
and stop checking) were available that would already be in place.

Maybe I should just drop it in favor of openfilegdb - that's going to happen if
it's still not available when gdal switches to C++11.


Jürgen

-- 
Jürgen E. Fischer         norBIT GmbH               Tel. +49-4931-918175-31
Dipl.-Inf. (FH)           Rheinstraße 13            Fax. +49-4931-918175-50
Software Engineer         D-26506 Norden               http://www.norbit.de
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 827 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170302/f2c421f7/attachment-0001.sig>

From even.rouault at spatialys.com  Thu Mar  2 02:30:23 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 02 Mar 2017 11:30:23 +0100
Subject: [gdal-dev] Linking against gdal201.dll with different MSVC
	versions
In-Reply-To: <20170302101407.GA4324@norbit.de>
References: <CAEDrt38jkkn5oFBj8LcUsXRnUUyZhodReHftBUnDM-W66euxHw@mail.gmail.com>
 <23282605.xCQC4jrqUS@even-i700> <20170302101407.GA4324@norbit.de>
Message-ID: <3793838.bWjmHLScSK@even-i700>

On jeudi 2 mars 2017 11:14:07 CET Jürgen E. Fischer wrote:
> Hi Even,
> 
> On Thu, 02. Mar 2017 at 10:43:16 +0100, Even Rouault wrote:
> > Probably because the last GDAL built in OSGeo4W was done with MSVC2010,
> > before the recent upgrade to MSVC2015 for QGIS master. I guess the next
> > GDAL builds will be done with MSVC2015 too.
> 
> Well, if the third party dependencies (like filegdb - which I happend to
> start and stop checking) were available that would already be in place.
> 
> Maybe I should just drop it in favor of openfilegdb - that's going to happen
> if it's still not available when gdal switches to C++11.

Ah those proprietary SDKs...  I see FileGDB SDK 1.4 is available for VS2013. So perhaps an 
intermediate solution would be to build GDAL with VS2013 when we require C++11
I hope we'll stick with not so advanced C++11 features that will be OK with VS2013:
https://msdn.microsoft.com/en-us/library/hh567368.aspx

> 
> 
> Jürgen


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170302/5cb6d10a/attachment.html>

From even.rouault at spatialys.com  Thu Mar  2 05:04:39 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 02 Mar 2017 14:04:39 +0100
Subject: [gdal-dev] Testing of OGR generated GeoPackage datasets with other
	implementations
Message-ID: <2731899.NL5jieREhm@even-i700>

Hi,

I've committed recently a small improvement regarding vector and attribute tables in the 
GeoPackage driver, so as to get the number of features quickly. This can be interesting when 
dealing with huge tables. Without that, getting the number of features require a full table 
scan. So I've added a "ogr_feature_count" column to the gpkg_contents table, and triggers to 
update it.
To my understanding, such an extension is allowed by the specification.
While running through the OGR GPKG driver those triggers are temporarily disabled during 
feature insertion and deletion so as to make them faster, and restored back at dataset 
closing.
The driver of course behaves well if the column is missing or if its content is NULL (will revert 
to full table scan to get feature count)
Earlier versions of the OGR GPKG driver are also happy with the new layout of the DB.
As a provision, I've added a ADD_OGR_FEATURE_COUNT_COLUMN=NO dataset creation 
option to disable this, but it is my hope this will be not needed.

So I'd be interested if people could test 
http://even.rouault.free.fr/geopackage/ne_10m_admin_0_countries_france.gpkg
(or any other gpkg you may generate with today's ogr2ogr) with other software package that 
don't use OGR underneath (ArcGIS for example).

Suggested tests:
- check that the DB opens well and the layer is listed
- check that the layer opens well (you should see France and its overseas territories)
- check that you can add or delete features to the layer. Check afterwards that the 
ogr_feature_count is well updated (it should, thanks to the triggers):
ogrinfo ne_10m_admin_0_countries_france.gpkg \
   -sql "select * from gpkg_contents"

- check that you can add a new layer to the DB (ie insertion of new content in gpkg_contents 
works well, despite the new column added). The value of the ogr_feature_count column 
should be NULL.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170302/9c279c48/attachment.html>

From jmckenna at gatewaygeomatics.com  Thu Mar  2 05:12:14 2017
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Thu, 2 Mar 2017 09:12:14 -0400
Subject: [gdal-dev] Linking against gdal201.dll with different MSVC
 versions
In-Reply-To: <20170302101407.GA4324@norbit.de>
References: <CAEDrt38jkkn5oFBj8LcUsXRnUUyZhodReHftBUnDM-W66euxHw@mail.gmail.com>
 <23282605.xCQC4jrqUS@even-i700> <20170302101407.GA4324@norbit.de>
Message-ID: <497604a6-9e4c-817b-2d6f-036c6334a96e@gatewaygeomatics.com>

On 2017-03-02 6:14 AM, Jürgen E. Fischer wrote:
>
> Well, if the third party dependencies (like filegdb - which I happend to start
> and stop checking) were available that would already be in place.
>
> Maybe I should just drop it in favor of openfilegdb - that's going to happen if
> it's still not available when gdal switches to C++11.
>
Hi Jürgen,

In fact we recently decided to remove the FileGDB driver and go with the 
OpenFileGDB driver, for the MS4W community, for this exact reason.

-jeff




From jukka.rahkonen at maanmittauslaitos.fi  Thu Mar  2 05:36:06 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Thu, 2 Mar 2017 06:36:06 -0700 (MST)
Subject: [gdal-dev] Testing of OGR generated GeoPackage datasets with
 other implementations
In-Reply-To: <2731899.NL5jieREhm@even-i700>
References: <2731899.NL5jieREhm@even-i700>
Message-ID: <1488461766837-5310339.post@n6.nabble.com>

Even Rouault-2 wrote
> So I'd be interested if people could test 
> http://even.rouault.free.fr/geopackage/ne_10m_admin_0_countries_france.gpkg
> (or any other gpkg you may generate with today's ogr2ogr) with other
> software package that 
> don't use OGR underneath (ArcGIS for example).

Hi,

MapInfo Pro 15.2 does not open your geopackage. It does open the geopackage
which I cleaned with a bit older GDAL build as

ogr2ogr -f gpkg clean.gpkg ne_10m_admin_0_countries_france.gpkg

MapInfo did not give any error message, it just does not find any layers and
quits. I could not find anything like error log from MapInfo directory. I
will send a message to MapInfo support as well with a link to your
geopackage.

-Jukka Rahkonen-





--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Testing-of-OGR-generated-GeoPackage-datasets-with-other-implementations-tp5310330p5310339.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Thu Mar  2 05:49:02 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 02 Mar 2017 14:49:02 +0100
Subject: [gdal-dev] Testing of OGR generated GeoPackage datasets with
	other implementations
In-Reply-To: <1488461766837-5310339.post@n6.nabble.com>
References: <2731899.NL5jieREhm@even-i700>
 <1488461766837-5310339.post@n6.nabble.com>
Message-ID: <1999697.xgDzSZATZ4@even-i700>

On jeudi 2 mars 2017 06:36:06 CET jratike80 wrote:
> Even Rouault-2 wrote
> 
> > So I'd be interested if people could test
> > http://even.rouault.free.fr/geopackage/ne_10m_admin_0_countries_france.gpk
> > g
> > (or any other gpkg you may generate with today's ogr2ogr) with other
> > software package that
> > don't use OGR underneath (ArcGIS for example).
> 
> Hi,
> 
> MapInfo Pro 15.2 does not open your geopackage. It does open the geopackage
> which I cleaned with a bit older GDAL build as
> 
> ogr2ogr -f gpkg clean.gpkg ne_10m_admin_0_countries_france.gpkg
> 
> MapInfo did not give any error message, it just does not find any layers and
> quits. I could not find anything like error log from MapInfo directory. I
> will send a message to MapInfo support as well with a link to your
> geopackage.

Thanks for your feedback

Interesting, would you mind testing 
http://even.rouault.free.fr/geopackage/ne_10m_admin_0_countries_france_no_ogr_feature_count.gpkg

which is the same with today's trunk but with -dsco  ADD_OGR_FEATURE_COUNT_COLUMN=NO

If that works (and it should probably given your above testing), that means I should revise my design as
we want to be compatible with existing implementations.

I've though of an alternative that would use an auxiliary table instead of extending gpkg_contents, like a
gpkg_ogr_contents table. I've simulated it manually in
http://even.rouault.free.fr/geopackage/ne_10m_admin_0_countries_france_alternative.gpkg

Generated with :
cp ne_10m_admin_0_countries_france_no_ogr_feature_count.gpkg ne_10m_admin_0_countries_france_alternative.gpkg
ogrinfo ne_10m_admin_0_countries_france_alternative.gpkg -sql "CREATE TABLE gpkg_ogr_contents (table_name TEXT NOT NULL, feature_count INTEGER DEFAULT NULL)"
ogrinfo ne_10m_admin_0_countries_france_alternative.gpkg -sql "INSERT INTO gpkg_ogr_contents VALUES ('ne_10m_admin_0_countries', 1)"


Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170302/1cd77c4e/attachment-0001.html>

From jukka.rahkonen at maanmittauslaitos.fi  Thu Mar  2 05:55:19 2017
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Thu, 2 Mar 2017 13:55:19 +0000
Subject: [gdal-dev] Testing of OGR generated GeoPackage datasets with
 other implementations
Message-ID: <55223d5f9c5349fca41bdaf779f2640e@C119S212VM022.msvyvi.vaha.local>

Hi

Right, ne_10m_admin_0_countries_france_no_ogr_feature_count.gpkg opens with MapInfo 15.2.

-Jukka-

Lähettäjä: Even Rouault [mailto:even.rouault at spatialys.com]
Lähetetty: 2. maaliskuuta 2017 15:49
Vastaanottaja: gdal-dev at lists.osgeo.org
Kopio: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Aihe: Re: [gdal-dev] Testing of OGR generated GeoPackage datasets with other implementations


On jeudi 2 mars 2017 06:36:06 CET jratike80 wrote:

> Even Rouault-2 wrote

>

> > So I'd be interested if people could test

> > http://even.rouault.free.fr/geopackage/ne_10m_admin_0_countries_france.gpk

> > g

> > (or any other gpkg you may generate with today's ogr2ogr) with other

> > software package that

> > don't use OGR underneath (ArcGIS for example).

>

> Hi,

>

> MapInfo Pro 15.2 does not open your geopackage. It does open the geopackage

> which I cleaned with a bit older GDAL build as

>

> ogr2ogr -f gpkg clean.gpkg ne_10m_admin_0_countries_france.gpkg

>

> MapInfo did not give any error message, it just does not find any layers and

> quits. I could not find anything like error log from MapInfo directory. I

> will send a message to MapInfo support as well with a link to your

> geopackage.



Thanks for your feedback



Interesting, would you mind testing

http://even.rouault.free.fr/geopackage/ne_10m_admin_0_countries_france_no_ogr_feature_count.gpkg



which is the same with today's trunk but with -dsco ADD_OGR_FEATURE_COUNT_COLUMN=NO



If that works (and it should probably given your above testing), that means I should revise my design as

we want to be compatible with existing implementations.



I've though of an alternative that would use an auxiliary table instead of extending gpkg_contents, like a

gpkg_ogr_contents table. I've simulated it manually in

http://even.rouault.free.fr/geopackage/ne_10m_admin_0_countries_france_alternative.gpkg



Generated with :

cp ne_10m_admin_0_countries_france_no_ogr_feature_count.gpkg ne_10m_admin_0_countries_france_alternative.gpkg

ogrinfo ne_10m_admin_0_countries_france_alternative.gpkg -sql "CREATE TABLE gpkg_ogr_contents (table_name TEXT NOT NULL, feature_count INTEGER DEFAULT NULL)"

ogrinfo ne_10m_admin_0_countries_france_alternative.gpkg -sql "INSERT INTO gpkg_ogr_contents VALUES ('ne_10m_admin_0_countries', 1)"





Even



--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170302/70d3c23f/attachment.html>

From even.rouault at spatialys.com  Thu Mar  2 06:04:49 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 02 Mar 2017 15:04:49 +0100
Subject: [gdal-dev] Testing of OGR generated GeoPackage datasets with
	other implementations
In-Reply-To: <55223d5f9c5349fca41bdaf779f2640e@C119S212VM022.msvyvi.vaha.local>
References: <55223d5f9c5349fca41bdaf779f2640e@C119S212VM022.msvyvi.vaha.local>
Message-ID: <4377841.SBfzqN4Lyg@even-i700>

On jeudi 2 mars 2017 13:55:19 CET Rahkonen Jukka (MML) wrote:
> http://even.rouault.free.fr/geopackage/ne_10m_admin_0_countries_france_alter
> native.gpkg

And what about
http://even.rouault.free.fr/geopackage/ne_10m_admin_0_countries_france_alternative.gpkg
if you don't mind ?

Note: I've just refreshed it to add triggers since my inital upload.

ogrinfo ne_10m_admin_0_countries_france_alternative.gpkg -sql "CREATE TRIGGER trigger_insert_ogr_feature_count_ne_10m_admin_0_countries AFTER INSERT ON ne_10m_admin_0_countries BEGIN UPDATE gpkg_ogr_contents SET feature_count = feature_count + 1 WHERE table_name = 'ne_10m_admin_0_countries'; END"
ogrinfo ne_10m_admin_0_countries_france_alternative.gpkg -sql "CREATE TRIGGER trigger_delete_ogr_feature_count_ne_10m_admin_0_countries AFTER DELETE ON ne_10m_admin_0_countries BEGIN UPDATE gpkg_ogr_contents SET feature_count = feature_count - 1 WHERE table_name = 'ne_10m_admin_0_countries'; END"


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170302/1d186a62/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Thu Mar  2 06:25:10 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Thu, 2 Mar 2017 07:25:10 -0700 (MST)
Subject: [gdal-dev] Testing of OGR generated GeoPackage datasets with
 other implementations
In-Reply-To: <4377841.SBfzqN4Lyg@even-i700>
References: <2731899.NL5jieREhm@even-i700>
 <1488461766837-5310339.post@n6.nabble.com>
 <55223d5f9c5349fca41bdaf779f2640e@C119S212VM022.msvyvi.vaha.local>
 <4377841.SBfzqN4Lyg@even-i700>
Message-ID: <1488464710854-5310363.post@n6.nabble.com>

Even Rouault-2 wrote
> And what about
> http://even.rouault.free.fr/geopackage/ne_10m_admin_0_countries_france_alternative.gpkg
> if you don't mind ?

It opens as well.

BTW. the layer is described as POLYGON in gpkg_geometry_columns but the one
feature in the main table is MULTIPOLYGON.

-Jukka-



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Testing-of-OGR-generated-GeoPackage-datasets-with-other-implementations-tp5310330p5310363.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Thu Mar  2 07:05:12 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 02 Mar 2017 16:05:12 +0100
Subject: [gdal-dev] Testing of OGR generated GeoPackage datasets with
	other implementations
In-Reply-To: <1488464710854-5310363.post@n6.nabble.com>
References: <2731899.NL5jieREhm@even-i700> <4377841.SBfzqN4Lyg@even-i700>
 <1488464710854-5310363.post@n6.nabble.com>
Message-ID: <5105701.oWAIo9AVLj@even-i700>

On jeudi 2 mars 2017 07:25:10 CET jratike80 wrote:
> Even Rouault-2 wrote
> 
> > And what about
> > http://even.rouault.free.fr/geopackage/ne_10m_admin_0_countries_france_alt
> > ernative.gpkg if you don't mind ?
> 
> It opens as well.

OK. I've changed the implementation to reflect the above prototyping and regenerated from it
http://even.rouault.free.fr/geopackage/ne_10m_admin_0_countries_france_alternative2.gpkg

> 
> BTW. the layer is described as POLYGON in gpkg_geometry_columns but the one
> feature in the main table is MULTIPOLYGON.

Yes, that's because I converted from a shapefile which has the loose polygon/multipolygon typing.
The above dataset has been regenerated with -nlt MULTIPOLYGON

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170302/3f25a730/attachment-0001.html>

From jukka.rahkonen at maanmittauslaitos.fi  Thu Mar  2 07:18:26 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Thu, 2 Mar 2017 08:18:26 -0700 (MST)
Subject: [gdal-dev] Testing of OGR generated GeoPackage datasets with
 other implementations
In-Reply-To: <5105701.oWAIo9AVLj@even-i700>
References: <2731899.NL5jieREhm@even-i700>
 <1488461766837-5310339.post@n6.nabble.com>
 <55223d5f9c5349fca41bdaf779f2640e@C119S212VM022.msvyvi.vaha.local>
 <4377841.SBfzqN4Lyg@even-i700> <1488464710854-5310363.post@n6.nabble.com>
 <5105701.oWAIo9AVLj@even-i700>
Message-ID: <1488467906580-5310374.post@n6.nabble.com>

Even Rouault-2 wrote
> OK. I've changed the implementation to reflect the above prototyping and
> regenerated from it
> http://even.rouault.free.fr/geopackage/ne_10m_admin_0_countries_france_alternative2.gpkg

MapInfo is fine with that one, too.

-Jukka-



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Testing-of-OGR-generated-GeoPackage-datasets-with-other-implementations-tp5310330p5310374.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From a.neumann at carto.net  Fri Mar  3 06:16:46 2017
From: a.neumann at carto.net (Neumann, Andreas)
Date: Fri, 03 Mar 2017 15:16:46 +0100
Subject: [gdal-dev] Geopackage ogr2ogr append question
Message-ID: <db33e2e629077523562a6fe6e2510e0d@carto.net>

Hi, 

I am, for the first time trying to append additional tables with ogr2ogr
to an existing Geopackage file and have questions: 

ogr2ogr -progress -lco SPATIAL_INDEX=YES -f GPKG av_1700_lv03.gpkg
PG:'dbname=publikation host=localhost schemas=av_1700' -sql "SELECT
t_id, t_ili_tid, geom_03, bfs_nr, gemeinde, bodenbedeckungsart,
bodenbedeckungs_flaeche, gebaeudenummer, gwr_egid, objekt_name FROM
av_1700.bb_bodenbedeckung" 

ogr2ogr -progress -append -f GPKG av_1700_lv03.gpkg
PG:'dbname=publikation host=localhost schemas=av_1700' -sql "SELECT
t_id, t_ili_tid, geom_03, bfs_nr, gemeinde, linienart, bobeart_links,
bobeart_rechts FROM av_1700.bb_bodenbedeckung_kanten" 

----------------- 

First question: 

is the -append option enough or do I also need the -update option? 

----------------- 

Second question: 

I get warnings: 

Warning 1: Layer sql_statement relies on the 'gpkg_geom_COMPOUNDCURVE'
(GeoPackage 1.0 Specification Annex J) extension that should be
implemented for safe write-support, but is not currently. Update of that
layer are strongly discouraged to avoid corruption.
Warning 1: Layer sql_statement relies on the 'gpkg_geom_CURVEPOLYGON'
(GeoPackage 1.0 Specification Annex J) extension that should be
implemented for safe write-support, but is not currently. Update of that
layer are strongly discouraged to avoid corruption. 

Can I safely ignore these messages? Or is there a creation option for
the first table that enables this extension? 

Thanks a lot for your help! 

Andreas

  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170303/42622cd6/attachment.html>

From even.rouault at spatialys.com  Fri Mar  3 06:53:15 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 03 Mar 2017 15:53:15 +0100
Subject: [gdal-dev] Geopackage ogr2ogr append question
In-Reply-To: <db33e2e629077523562a6fe6e2510e0d@carto.net>
References: <db33e2e629077523562a6fe6e2510e0d@carto.net>
Message-ID: <14202302.bnEMjc1SUT@even-i700>

Hi Andreas,

> 
> I am, for the first time trying to append additional tables with ogr2ogr
> to an existing Geopackage file and have questions:
> 
> ogr2ogr -progress -lco SPATIAL_INDEX=YES -f GPKG av_1700_lv03.gpkg
> PG:'dbname=publikation host=localhost schemas=av_1700' -sql "SELECT
> t_id, t_ili_tid, geom_03, bfs_nr, gemeinde, bodenbedeckungsart,
> bodenbedeckungs_flaeche, gebaeudenummer, gwr_egid, objekt_name FROM
> av_1700.bb_bodenbedeckung"
> 
> ogr2ogr -progress -append -f GPKG av_1700_lv03.gpkg
> PG:'dbname=publikation host=localhost schemas=av_1700' -sql "SELECT
> t_id, t_ili_tid, geom_03, bfs_nr, gemeinde, linienart, bobeart_links,
> bobeart_rechts FROM av_1700.bb_bodenbedeckung_kanten"
> 
> -----------------
> 
> First question:
> 
> is the -append option enough or do I also need the -update option?

Yes -append is enough. It implies -update.

But -append is for appending features to an existing table. If you need to create a new table, 
you just need -update.

In your above case, you must be careful. The name of a SQL result layer depends on the 
driver. I nthe GPKG driver, it is always "sql_statement". You might want to rename it to 
something more useful with -nln new_layer_name,

> 
> -----------------
> 
> Second question:
> 
> I get warnings:
> 
> Warning 1: Layer sql_statement relies on the 'gpkg_geom_COMPOUNDCURVE'
> (GeoPackage 1.0 Specification Annex J) extension that should be
> implemented for safe write-support, but is not currently. Update of that
> layer are strongly discouraged to avoid corruption.
> Warning 1: Layer sql_statement relies on the 'gpkg_geom_CURVEPOLYGON'
> (GeoPackage 1.0 Specification Annex J) extension that should be
> implemented for safe write-support, but is not currently. Update of that
> layer are strongly discouraged to avoid corruption.
> 
> Can I safely ignore these messages? Or is there a creation option for
> the first table that enables this extension?

Which GDAL version is this ? It looks like the issue of 
https://trac.osgeo.org/gdal/ticket/6402

So this should be fixed in GDAL 2.0.3 or GDAL >= 2.1.0

(the warning can be ignored, but you should upgrade to a more recent version so that the 
extension is properly registered as read-write)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170303/dd7782dc/attachment.html>

From a.neumann at carto.net  Fri Mar  3 07:14:54 2017
From: a.neumann at carto.net (Neumann, Andreas)
Date: Fri, 03 Mar 2017 16:14:54 +0100
Subject: [gdal-dev] Geopackage ogr2ogr append question
In-Reply-To: <14202302.bnEMjc1SUT@even-i700>
References: <db33e2e629077523562a6fe6e2510e0d@carto.net>
 <14202302.bnEMjc1SUT@even-i700>
Message-ID: <0b95e8858a3c6d12a0b247874b12d0f0@carto.net>

Hi Even, 

Thanks for your reply. 

My gdal version is 2.0.2 - I can update to a newer version and see if
this warning disappears. 

I meanwhile also figured out that I need to use -nln for proper table
names. 

Thanks also for the information about append vs. update. I'll switch to
update then. 

Andreas 

On 2017-03-03 15:53, Even Rouault wrote:

> Hi Andreas, 
> 
>> 
> 
>> I am, for the first time trying to append additional tables with ogr2ogr 
> 
>> to an existing Geopackage file and have questions: 
> 
>> 
> 
>> ogr2ogr -progress -lco SPATIAL_INDEX=YES -f GPKG av_1700_lv03.gpkg 
> 
>> PG:'dbname=publikation host=localhost schemas=av_1700' -sql "SELECT 
> 
>> t_id, t_ili_tid, geom_03, bfs_nr, gemeinde, bodenbedeckungsart, 
> 
>> bodenbedeckungs_flaeche, gebaeudenummer, gwr_egid, objekt_name FROM 
> 
>> av_1700.bb_bodenbedeckung" 
> 
>> 
> 
>> ogr2ogr -progress -append -f GPKG av_1700_lv03.gpkg 
> 
>> PG:'dbname=publikation host=localhost schemas=av_1700' -sql "SELECT 
> 
>> t_id, t_ili_tid, geom_03, bfs_nr, gemeinde, linienart, bobeart_links, 
> 
>> bobeart_rechts FROM av_1700.bb_bodenbedeckung_kanten" 
> 
>> 
> 
>> ----------------- 
> 
>> 
> 
>> First question: 
> 
>> 
> 
>> is the -append option enough or do I also need the -update option? 
> 
> Yes -append is enough. It implies -update. 
> 
> But -append is for appending features to an existing table. If you need to create a new table, you just need -update. 
> 
> In your above case, you must be careful. The name of a SQL result layer depends on the driver. I nthe GPKG driver, it is always "sql_statement". You might want to rename it to something more useful with -nln new_layer_name, 
> 
>> 
> 
>> ----------------- 
> 
>> 
> 
>> Second question: 
> 
>> 
> 
>> I get warnings: 
> 
>> 
> 
>> Warning 1: Layer sql_statement relies on the 'gpkg_geom_COMPOUNDCURVE' 
> 
>> (GeoPackage 1.0 Specification Annex J) extension that should be 
> 
>> implemented for safe write-support, but is not currently. Update of that 
> 
>> layer are strongly discouraged to avoid corruption. 
> 
>> Warning 1: Layer sql_statement relies on the 'gpkg_geom_CURVEPOLYGON' 
> 
>> (GeoPackage 1.0 Specification Annex J) extension that should be 
> 
>> implemented for safe write-support, but is not currently. Update of that 
> 
>> layer are strongly discouraged to avoid corruption. 
> 
>> 
> 
>> Can I safely ignore these messages? Or is there a creation option for 
> 
>> the first table that enables this extension? 
> 
> Which GDAL version is this ? It looks like the issue of 
> 
> https://trac.osgeo.org/gdal/ticket/6402 
> 
> So this should be fixed in GDAL 2.0.3 or GDAL >= 2.1.0 
> 
> (the warning can be ignored, but you should upgrade to a more recent version so that the extension is properly registered as read-write) 
> 
> Even 
> 
> -- 
> 
> Spatialys - Geospatial professional services 
> 
> http://www.spatialys.com

  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170303/795d54b6/attachment-0001.html>

From even.rouault at spatialys.com  Fri Mar  3 14:23:11 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 03 Mar 2017 23:23:11 +0100
Subject: [gdal-dev] Proposed ogrmerge.py utility script
Message-ID: <1709522.QpxKACu8Wg@even-i700>

Hi,

I've worked on a script to merge several OGR datasources into a single one.
Nothing that can't be done with ogr2ogr with some loops around, but I think this can be convenient.

There are basically 2 modes :
- Default one: each layer of each source datasource is written as a separate 
layer in the target datasource.
- 'Single' mode: all layers from all source datasources are written into a single
layer in the target datasource. This assumes that the schemas of those source
layers are more or less compatible.

I've not yet committed the script. You can grab it from
https://gist.github.com/rouault/3b49bffd67fb18e23cd4c5bcc10d3103

Short usage:

ogrmerge.py -o out_dsname src_dsname [src_dsname]*
            [-f format] [-single] [-nln layer_name_template]
            [-update | -overwrite_ds] [-append | -overwrite_lyr]
            [-src_geom_type geom_type_name[,geom_type_name]*]
            [-dsco NAME=VALUE]* [-lco NAME=VALUE]*
            [-s_srs srs_def] [-t_srs srs_def | -a_srs srs_def]
            [-progress] [-skip] [--help-general]

Options specific to -single:
            [-field_strategy FirstLayer|Union|Intersection]
            [-src_layer_field_name name]
            [-src_layer_field_content layer_name_template]

* layer_name_template can contain the following substituable variables:
     {AUTO_NAME}  : {DS_BASENAME}_{LAYER_NAME} if they are different
                    or {LAYER_NAME} if they are identical
     {DS_NAME}    : name of the source dataset
     {DS_BASENAME}: base name of the source dataset
     {DS_INDEX}   : index of the source dataset
     {LAYER_NAME} : name of the source layer
     {LAYER_IDX}  : index of the source layer


Examples:

* ogrmerge.py -f VRT -o merged.vrt  *.shp

     Creates a VRT with a layer for each input shapefiles

* ogrmerge.py -f GPKG -o merged.gpkg *.shp

     Same, but creates a GeoPackage file

* ogrmerge.py -single -o merged.shp france.shp germany.shp -src_layer_field_name country

	Concatenate the content of france.shp and germany.shp in merged.shp, and adds a 'country'
      field to each feature whose value is 'france' or 'germany' depending where it comes from


Internally this generates a VRT file, and if the output format is not VRT,
final translation is done with ogr2ogr / gdal.VectorTranslate. So for advanced uses, output
to VRT, potential manual editing of it and ogr2ogr can be done.

Opinions on script naming (I also tought to ogrcat.py to reflect the similarity with the Unix cat
utility used to concatenate files), option naming, etc.. are welcome

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170303/afa159a4/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Sat Mar  4 03:42:54 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Sat, 4 Mar 2017 04:42:54 -0700 (MST)
Subject: [gdal-dev] Proposed ogrmerge.py utility script
In-Reply-To: <1709522.QpxKACu8Wg@even-i700>
References: <1709522.QpxKACu8Wg@even-i700>
Message-ID: <1488627774911-5310651.post@n6.nabble.com>

Even Rouault-2 wrote
> Opinions on script naming (I also tought to ogrcat.py to reflect the
> similarity with the Unix cat
> utility used to concatenate files), option naming, etc.. are welcome

Hi,

ogrmerge.py is good name for the script.
I would rename  -overwrite_lyr into -overwrite_layer. It pays only two
letters, "layer" is already used in other parameters, and users would
understand with less thinking what it means.

-Jukka Rahkonen-



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Proposed-ogrmerge-py-utility-script-tp5310608p5310651.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From david.ferdoille at gmail.com  Sat Mar  4 07:12:03 2017
From: david.ferdoille at gmail.com (David FERDOILLE)
Date: Sat, 4 Mar 2017 16:12:03 +0100
Subject: [gdal-dev] OGR - S57 - geometry extraction issue
In-Reply-To: <CAKTSvBixE6VF3ix5gNzXvL3AiZtork2KGLJNByRQxnnTe9b4Qw@mail.gmail.com>
References: <CAJ=7T6XOgm+EsZ0zBhF4qPYemYEyHBTAEpnuHevEBFaR4MqMmg@mail.gmail.com>
 <331331746.11256708.1469784666364.JavaMail.yahoo@mail.yahoo.com>
 <CAJ=7T6XV0rH_CKVPsoNiAYPru_H-s3NMphBsfpbsbzKtZoXreQ@mail.gmail.com>
 <CAKTSvBixE6VF3ix5gNzXvL3AiZtork2KGLJNByRQxnnTe9b4Qw@mail.gmail.com>
Message-ID: <52fe9762-acfe-6298-f471-39954fb682b7@gmail.com>

Hi,

I'm sorry, I didn't have any time to work on integrating s57 data to 
geoserver through ogr during several months but I got time to work on it 
last month.

The main issue : objects may be composed of multiple primitives 
(isolated node or edge) with geometric attributes like posacc or quapos 
but ogr makes a aggregation of geometries and ignore those geometric 
attributes.

We succeed to manage this issue by this process :
1) extract all classes to shapefile with all relations between objects 
and primitives

ogr2ogr
-oo "RETURN_PRIMITIVES=ON"
-oo "RETURN_LINKAGES=ON"
-oo "LNAM_REFS=ON"
-nlt "MULTILINESTRING"
-where "OGR_GEOMETRY='LINESTRING' or  OGR_GEOMETRY='MULTILINESTRING'"
-fieldTypeToString IntegerList
cell-class-line.shp
cell.000
class


2) extract all primitives to shapefile with a s57-reader modification 
which return posacc and quapos values

ogr2ogr
-oo "RETURN_PRIMITIVES=ON"
-oo "RETURN_LINKAGES=ON"
-oo "LNAM_REFS=ON"
-nlt "MULTIPOINT"
-skipfailures
cell-isolatednode-point.shp
cell.000
IsolatedNode

To get posacc and quapos attributes, the S57Reader::ReadVector function 
was modified, can I propose the modification to the community on github ?


3) integrate all shapefiles in a PostgreSQL/PostGIS database and work on 
it to construct all objects-subgeometries with 'name_rcnm' and 
'name_rcid' to obtain a database compatible with geoserver.


During my tests, I found some differences between s57attributes.csv, 
s57objectclasses.csv and the s57 reference (on www.s-57.com 
<http://www.s-57.com> for example), I will propose the update on github.


Moreover, I was confronted with the TEMP_BUFFER_SIZE of ogrfeature when 
converting IntegerList to String because some objects have many 
subgeometries and the result is truncated (finishing by '...)') and not 
exploitable. The limit is 80 characters, I tried to increase to 254 (max 
string length in shp) but it's not enough in some cases : for now, I 
just log the complete Integerlist in stderr and I handle all errors... I 
tried the splitlistfield option but it's not very easy to exploit...


Regards


David

Le 07/12/2016 à 22:00, Mike a écrit :
> David, did you ever figure this one out? I've run into the same 
> situation, where I need the spatial attributes.
>
> -Mike
>
> On Aug 12, 2016 1:32 AM, "David Ferdoille" <david.ferdoille at gmail.com 
> <mailto:david.ferdoille at gmail.com>> wrote:
>
>     Hello,
>
>
>     Thanks for the responses,
>
>     After a long afternoon of tests :
>
>     I try to access a WRECKS object, compose by an only point, with a
>     QUAPOS specific value of 5, and an POSACC of 500.0 (find it using
>     CARIS Easy View)
>
>     1-
>
>     In ogrinfo -oo "RETURN_PRIMITIVES=ON" -oo "RETURN_LINKAGES=ON" -oo
>     "LNAM_REFS=ON" file.000 WRECKS, I found the object, but no QUAPOS
>     or POSACC (logical because the 2 attributes are not directly
>     linked to the object, but to the geometry).
>
>     2-
>
>     In ogrinfo -oo "RETURN_PRIMITIVES=ON" -oo "RETURN_LINKAGES=ON" -oo
>     "LNAM_REFS=ON" file.000 IsolatedNode, I found the node
>     representing the object but also no QUAPOS or POSACC.
>
>     3-
>
>     In ogrinfo -oo "RETURN_PRIMITIVES=ON" -oo "RETURN_LINKAGES=ON" -oo
>     "LNAM_REFS=ON" file.000 M_QUAL, I found an only object, spatially
>     containing my wreck object, but POSACC is null.
>
>     4-
>
>     In ogrinfo -oo "RETURN_PRIMITIVES=ON" -oo "RETURN_LINKAGES=ON" -oo
>     "LNAM_REFS=ON" file.000 M_QUAL, I found 20 objects, but QUAPOS is
>     null for all of them.
>
>     5-
>
>     No M_ACCY table is present in my dataset.
>
>     According to me, the good way to get these attributes, is the
>     second one (2-), but even if I try a lot of things, I didn’t
>     manage to :
>
>     -Trying all the S57 option with –oo
>
>     -Trying to change the CSV types and attributes catalog used by GDAL
>
>     -Etc…
>
>     Does someone know if it is possible to get these attribute through
>     GDAL/OGR ?
>
>     If not, is there another way to get this attributes (python GDAL
>     scripts ? another command line software ?)
>
>     Thanks again for your help !
>
>
>     Regards
>
>
>     David
>
>
>     2016-07-29 11:31 GMT+02:00 teddy guerin <teddyguerin at yahoo.fr
>     <mailto:teddyguerin at yahoo.fr>>:
>
>         Hi,
>         Up for my previous answer.
>         I was wrong for lines and area values POSACC, QUAPOS are on
>         edges and not on "real object".
>
>         Regards
>         Ted
>
>
>         ------------------------------------------------------------------------
>         *De :* David Ferdoille <david.ferdoille at gmail.com
>         <mailto:david.ferdoille at gmail.com>>
>         *À :* gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>         *Envoyé le :* Mercredi 27 juillet 2016 15h12
>         *Objet :* [gdal-dev] OGR - S57 - geometry extraction issue
>
>         Hello all,
>
>         We are trying to render S57 files as ENC through Geoserver.
>
>         We convert S57 to shapefiles thanks to ogr2ogr : 1 shapefile
>         for 1 class (ex : COALNE) and 1 geometry type (LINE) :
>         ogrinfo -oo "RETURN_PRIMITIVES=ON" -oo "RETURN_LINKAGES=ON"
>         -oo "LNAM_REFS=ON" CELLLL.000 COALNE
>         ogr2ogr -skipfailures  -where "OGR_GEOMETRY='POINT' or
>         OGR_GEOMETRY='MULTIPOINT'" SOUNDG_points.shp CELLLL.000 SOUNDG
>
>         We use gdal-2.1.0 with the S57_CSV environnement variable
>         (S57_CSV=/usr/local/share/gdal/ with s57*.csv files).
>
>
>         We noticed that objects (of COALNE class for example) have
>         multiple geometries and each sub-geometry have attributes like
>         POSACC and QUAPOS which are important for S52 representation.
>         We've succeeded to extract primitives (Edge, isolated points,
>         connected points, ...), but it looks very complex to operate.
>
>
>         We have some problems to extract geometries from s57 objects :
>         - we noticed that, for an object, all sub-geometries are
>         aggregated to one geometry
>         - we didn't succeed to extract geometry attributes like POSACC
>         and QUAPOS
>
>
>         1) Is there a way to not aggregate sub-geometries of an object
>         and get this list of sub-geometries ?
>         2) Is there a way to extract geometry attributes like POSACC
>         and QUAPOS ?
>         3) If not, are these features planned ?
>
>
>         Thanks for your help !
>
>
>         David
>
>         _______________________________________________
>         gdal-dev mailing list
>         gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>         http://lists.osgeo.org/mailman/listinfo/gdal-dev
>         <http://lists.osgeo.org/mailman/listinfo/gdal-dev>
>
>
>
>
>     _______________________________________________
>     gdal-dev mailing list
>     gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>     http://lists.osgeo.org/mailman/listinfo/gdal-dev
>     <http://lists.osgeo.org/mailman/listinfo/gdal-dev>
>



---
L'absence de virus dans ce courrier électronique a été vérifiée par le logiciel antivirus Avast.
https://www.avast.com/antivirus
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170304/e394f687/attachment-0001.html>

From even.rouault at spatialys.com  Sat Mar  4 07:58:14 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 04 Mar 2017 16:58:14 +0100
Subject: [gdal-dev] OGR - S57 - geometry extraction issue
In-Reply-To: <52fe9762-acfe-6298-f471-39954fb682b7@gmail.com>
References: <CAJ=7T6XOgm+EsZ0zBhF4qPYemYEyHBTAEpnuHevEBFaR4MqMmg@mail.gmail.com>
 <CAKTSvBixE6VF3ix5gNzXvL3AiZtork2KGLJNByRQxnnTe9b4Qw@mail.gmail.com>
 <52fe9762-acfe-6298-f471-39954fb682b7@gmail.com>
Message-ID: <3701270.uibgGPppWg@even-i700>

On samedi 4 mars 2017 16:12:03 CET David FERDOILLE wrote:
> Hi,
> 
> I'm sorry, I didn't have any time to work on integrating s57 data to
> geoserver through ogr during several months but I got time to work on it
> last month.
> 
> The main issue : objects may be composed of multiple primitives
> (isolated node or edge) with geometric attributes like posacc or quapos
> but ogr makes a aggregation of geometries and ignore those geometric
> attributes.
> 
> We succeed to manage this issue by this process :
> 1) extract all classes to shapefile with all relations between objects
> and primitives
> 
> ogr2ogr
> -oo "RETURN_PRIMITIVES=ON"
> -oo "RETURN_LINKAGES=ON"
> -oo "LNAM_REFS=ON"
> -nlt "MULTILINESTRING"
> -where "OGR_GEOMETRY='LINESTRING' or  OGR_GEOMETRY='MULTILINESTRING'"
> -fieldTypeToString IntegerList
> cell-class-line.shp
> cell.000
> class
> 
> 
> 2) extract all primitives to shapefile with a s57-reader modification
> which return posacc and quapos values
> 
> ogr2ogr
> -oo "RETURN_PRIMITIVES=ON"
> -oo "RETURN_LINKAGES=ON"
> -oo "LNAM_REFS=ON"
> -nlt "MULTIPOINT"
> -skipfailures
> cell-isolatednode-point.shp
> cell.000
> IsolatedNode
> 
> To get posacc and quapos attributes, the S57Reader::ReadVector function
> was modified, can I propose the modification to the community on github ?

Yes, please do so.

> 
> 
> 3) integrate all shapefiles in a PostgreSQL/PostGIS database and work on
> it to construct all objects-subgeometries with 'name_rcnm' and
> 'name_rcid' to obtain a database compatible with geoserver.
> 
> 
> During my tests, I found some differences between s57attributes.csv,
> s57objectclasses.csv and the s57 reference (on www.s-57.com
> <http://www.s-57.com> for example), I will propose the update on github.

Thanks. Note that in trunk I've a few weeks ago merged the _aml and _iw files into the main 
one.

> 
> 
> Moreover, I was confronted with the TEMP_BUFFER_SIZE of ogrfeature when
> converting IntegerList to String because some objects have many
> subgeometries and the result is truncated (finishing by '...)') and not
> exploitable. The limit is 80 characters, I tried to increase to 254 (max
> string length in shp) but it's not enough in some cases : for now, I
> just log the complete Integerlist in stderr and I handle all errors... I
> tried the splitlistfield option but it's not very easy to exploit...

There will be no perfect solution if you output to shapefiles. Did you try to SQLite or 
Spatialite ? IntegerList are properly supported there.

> 
> 
> Regards
> 
> 
> David
> 
> Le 07/12/2016 à 22:00, Mike a écrit :
> > David, did you ever figure this one out? I've run into the same
> > situation, where I need the spatial attributes.
> > 
> > -Mike
> > 
> > On Aug 12, 2016 1:32 AM, "David Ferdoille" <david.ferdoille at gmail.com
> > 
> > <mailto:david.ferdoille at gmail.com>> wrote:
> >     Hello,
> >     
> >     
> >     Thanks for the responses,
> >     
> >     After a long afternoon of tests :
> >     
> >     I try to access a WRECKS object, compose by an only point, with a
> >     QUAPOS specific value of 5, and an POSACC of 500.0 (find it using
> >     CARIS Easy View)
> >     
> >     1-
> >     
> >     In ogrinfo -oo "RETURN_PRIMITIVES=ON" -oo "RETURN_LINKAGES=ON" -oo
> >     "LNAM_REFS=ON" file.000 WRECKS, I found the object, but no QUAPOS
> >     or POSACC (logical because the 2 attributes are not directly
> >     linked to the object, but to the geometry).
> >     
> >     2-
> >     
> >     In ogrinfo -oo "RETURN_PRIMITIVES=ON" -oo "RETURN_LINKAGES=ON" -oo
> >     "LNAM_REFS=ON" file.000 IsolatedNode, I found the node
> >     representing the object but also no QUAPOS or POSACC.
> >     
> >     3-
> >     
> >     In ogrinfo -oo "RETURN_PRIMITIVES=ON" -oo "RETURN_LINKAGES=ON" -oo
> >     "LNAM_REFS=ON" file.000 M_QUAL, I found an only object, spatially
> >     containing my wreck object, but POSACC is null.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170304/06d8bf58/attachment-0001.html>

From sylvain_duclos at yahoo.com  Sat Mar  4 08:00:49 2017
From: sylvain_duclos at yahoo.com (s duclos)
Date: Sat, 4 Mar 2017 16:00:49 +0000 (UTC)
Subject: [gdal-dev] OGR - S57 - geometry extraction issue
In-Reply-To: <52fe9762-acfe-6298-f471-39954fb682b7@gmail.com>
References: <CAJ=7T6XOgm+EsZ0zBhF4qPYemYEyHBTAEpnuHevEBFaR4MqMmg@mail.gmail.com>
 <331331746.11256708.1469784666364.JavaMail.yahoo@mail.yahoo.com>
 <CAJ=7T6XV0rH_CKVPsoNiAYPru_H-s3NMphBsfpbsbzKtZoXreQ@mail.gmail.com>
 <CAKTSvBixE6VF3ix5gNzXvL3AiZtork2KGLJNByRQxnnTe9b4Qw@mail.gmail.com>
 <52fe9762-acfe-6298-f471-39954fb682b7@gmail.com>
Message-ID: <1145152345.979708.1488643249455@mail.yahoo.com>

David,
>Moreover, I was confronted with the TEMP_BUFFER_SIZE of ogrfeature when converting IntegerList to String because some >objects have many subgeometries and the result is truncated (finishing by '...)') and not exploitable. The limit is 80 >characters, I tried to increase to 254 (max string length in shp) but it's not enough in some cases : for now, I just log >the complete Integerlist in stderr and I handle all errors... I tried the splitlistfield option but it's not very easy to >exploit...


Conserning TEMP_BUFFER_SIZE my hack is to realloc() when more room is needed.
But OGR is about WKT/WKB. Here we are talking internal representation. So when I
need this info I just patch OGR. 


Attached is my patch (ogrfeature.cpp.diff) to give you an idea.


rgds,

Sylvain.


On Saturday, March 4, 2017 10:12 AM, David FERDOILLE <david.ferdoille at gmail.com> wrote:



Hi,

I'm sorry, I didn't have any time to work on integrating s57 data to geoserver through ogr during several months but I got time to work on it last month.

The main issue : objects may be composed of multiple primitives (isolated node or edge) with geometric attributes like posacc or quapos but ogr makes a aggregation of geometries and ignore those geometric attributes.

We succeed to manage this issue by this process :
1) extract all classes to shapefile with all relations between objects and primitives

ogr2ogr 
-oo "RETURN_PRIMITIVES=ON" 
-oo "RETURN_LINKAGES=ON"
-oo "LNAM_REFS=ON" 
-nlt "MULTILINESTRING"
-where "OGR_GEOMETRY='LINESTRING' or  OGR_GEOMETRY='MULTILINESTRING'" 
-fieldTypeToString IntegerList 
cell-class-line.shp 
cell.000 
class


2) extract all primitives to shapefile with a s57-reader modification which return posacc and quapos values

ogr2ogr 
-oo "RETURN_PRIMITIVES=ON" 
-oo "RETURN_LINKAGES=ON" 
-oo "LNAM_REFS=ON" 
-nlt "MULTIPOINT" 
-skipfailures  
cell-isolatednode-point.shp 
cell.000 
IsolatedNode

To get posacc and quapos attributes, the S57Reader::ReadVector function was modified, can I propose the modification to the community on github ?


3) integrate all shapefiles in a PostgreSQL/PostGIS database and work on it to construct all objects-subgeometries with 'name_rcnm' and 'name_rcid' to obtain a database compatible with geoserver.


During my tests, I found some differences between s57attributes.csv, s57objectclasses.csv and the s57 reference (on www.s-57.com for example), I will propose the update on github. 



Moreover, I was confronted with the TEMP_BUFFER_SIZE of ogrfeature when converting IntegerList to String because some objects have many subgeometries and the result is truncated (finishing by '...)') and not exploitable. The limit is 80 characters, I tried to increase to 254 (max string length in shp) but it's not enough in some cases : for now, I just log the complete Integerlist in stderr and I handle all errors... I tried the splitlistfield option but it's not very easy to exploit...


Regards 


David


Le 07/12/2016 à 22:00, Mike a écrit :

David, did you ever figure this one out? I've run into the same situation, where I need the spatial attributes. 
>
>
>-Mike
>
>
>On Aug 12, 2016 1:32 AM, "David Ferdoille" <david.ferdoille at gmail.com> wrote:
>
>Hello,
>>
>>
>>Thanks for the responses,
>> 
>>After a long afternoon of tests :
>>I try to access a WRECKS object, compose by an only point, with a QUAPOS specific value of 5, and an POSACC of 500.0 (find it using CARIS Easy View)
>> 
>>1-
>>In ogrinfo -oo "RETURN_PRIMITIVES=ON" -oo "RETURN_LINKAGES=ON" -oo "LNAM_REFS=ON" file.000 WRECKS, I found the object, but no QUAPOS or POSACC (logical because the 2 attributes are not directly linked to the object, but to the geometry).
>> 
>>2-
>>In ogrinfo -oo "RETURN_PRIMITIVES=ON" -oo "RETURN_LINKAGES=ON" -oo "LNAM_REFS=ON" file.000 IsolatedNode, I found the node representing the object but also no QUAPOS or POSACC.
>> 
>>3-
>>In ogrinfo -oo "RETURN_PRIMITIVES=ON" -oo "RETURN_LINKAGES=ON" -oo "LNAM_REFS=ON" file.000 M_QUAL, I found an only object, spatially containing my wreck object, but POSACC is null.
>> 
>>4- 
>>In ogrinfo -oo "RETURN_PRIMITIVES=ON" -oo "RETURN_LINKAGES=ON" -oo "LNAM_REFS=ON" file.000 M_QUAL, I found 20 objects, but QUAPOS is null for all of them.
>> 
>>5-
>>No M_ACCY table is present in my dataset.
>> 
>> 
>>According to me, the good way to get these attributes, is the second one (2-), but even if I try a lot of things, I didn’t manage to :
>>-          Trying all the S57 option with –oo
>>-          Trying to change the CSV types and attributes catalog used by GDAL
>>-          Etc…
>> 
>> 
>>Does someone know if it is possible to get these attribute through GDAL/OGR ?
>>If not, is there another way to get this attributes (python GDAL scripts ? another command line software ?)
>> 
>>Thanks again for your help !
>>
>>
>>Regards
>>
>>
>>David
>>
>>
>>2016-07-29 11:31 GMT+02:00 teddy guerin <teddyguerin at yahoo.fr>:
>>
>>Hi,
>>>Up for my previous answer.
>>>
>>>I was wrong for lines and area values POSACC, QUAPOS are on edges and not on "real object".
>>>
>>>
>>>Regards
>>>Ted
>>>
>>>
>>>
>>>
>>>
>>>________________________________
>>> De : David Ferdoille <david.ferdoille at gmail.com>
>>>À : gdal-dev at lists.osgeo.org 
>>>Envoyé le : Mercredi 27 juillet 2016 15h12
>>>Objet : [gdal-dev] OGR - S57 - geometry extraction issue
>>> 
>>>
>>>
>>>Hello all,
>>>
>>>
>>>We are trying to render S57 files as ENC through Geoserver.
>>>
>>>
>>>We convert S57 to shapefiles thanks to ogr2ogr : 1 shapefile for 1 class (ex : COALNE) and 1 geometry type (LINE) :  
>>>ogrinfo -oo "RETURN_PRIMITIVES=ON" -oo "RETURN_LINKAGES=ON" -oo "LNAM_REFS=ON" CELLLL.000 COALNE 
>>>ogr2ogr -skipfailures  -where "OGR_GEOMETRY='POINT' or OGR_GEOMETRY='MULTIPOINT'" SOUNDG_points.shp CELLLL.000 SOUNDG 
>>>
>>>
>>>We use gdal-2.1.0 with the S57_CSV environnement variable (S57_CSV=/usr/local/share/gdal / with s57*.csv files).
>>>
>>>
>>>
>>>
>>>We noticed that objects (of COALNE class for example) have multiple geometries and each sub-geometry have attributes like POSACC and QUAPOS which are important for S52 representation. 
>>>We've succeeded to extract primitives (Edge, isolated points, connected points, ...), but it looks very complex to operate.
>>>
>>>
>>>
>>>
>>>We have some problems to extract geometries from s57 objects :
>>>- we noticed that, for an object, all sub-geometries are aggregated to one geometry
>>>- we didn't succeed to extract geometry attributes like POSACC and QUAPOS
>>>
>>>
>>>
>>>
>>>1) Is there a way to not aggregate sub-geometries of an object and get this list of sub-geometries ?
>>>2) Is there a way to extract geometry attributes like POSACC and QUAPOS ?
>>>3) If not, are these features planned ?
>>>
>>>
>>>
>>>
>>>Thanks for your help !
>>>
>>>
>>>
>>>
>>>David
>>>______________________________ _________________
>>>gdal-dev mailing list
>>>gdal-dev at lists.osgeo.org
>>>http://lists.osgeo.org/mailman /listinfo/gdal-dev
>>>
>>>
>>
>>
>>______________________________ _________________
>>gdal-dev mailing list
>>gdal-dev at lists.osgeo.org
>>http://lists.osgeo.org/ mailman/listinfo/gdal-dev
>>


Garanti sans virus. www.avast.com 
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
A non-text attachment was scrubbed...
Name: ogrfeature.cpp.diff
Type: text/x-patch
Size: 2906 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170304/11ad7986/attachment.bin>

From jukka.rahkonen at maanmittauslaitos.fi  Sat Mar  4 08:26:35 2017
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Sat, 4 Mar 2017 16:26:35 +0000
Subject: [gdal-dev] Reading SQLite in WAL mode as read-only
Message-ID: <1488644796565.89473@maanmittauslaitos.fi>

Hi,

I saw this changeset https://trac.osgeo.org/gdal/changeset/37594 and started to think that how  GDAL is reading SQLite db that is in WAL journal mode from zip, tar, vsicurl or from non-writeble directory if it is documented to be generally not possible http://www.sqlite.org/draft/wal.html?

-Jukka Rahkonen-

From even.rouault at spatialys.com  Sat Mar  4 08:34:31 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 04 Mar 2017 17:34:31 +0100
Subject: [gdal-dev] Reading SQLite in WAL mode as read-only
In-Reply-To: <1488644796565.89473@maanmittauslaitos.fi>
References: <1488644796565.89473@maanmittauslaitos.fi>
Message-ID: <1535391.hJb9Mkbg6I@even-i700>

On samedi 4 mars 2017 16:26:35 CET Rahkonen Jukka (MML) wrote:
> Hi,
> 
> I saw this changeset https://trac.osgeo.org/gdal/changeset/37594 and started
> to think that how  GDAL is reading SQLite db that is in WAL journal mode
> from zip, tar, vsicurl or from non-writeble directory if it is documented
> to be generally not possible http://www.sqlite.org/draft/wal.html?

The official page is at
https://www.sqlite.org/wal.html

"5. It is not possible to open read-only WAL databases. The opening process must have write 
privileges for "-shm" wal-index shared memory file associated with the database, if that file 
exists, or else write access on the directory containing the database file if the "-shm" file 
does not exist. "

I'm trying to optimize the speed of 
ogrinfo -ro /vsitar/my.tar.gz/my.gpkg
on very large files
(but it turns out to be much more involved, since it requires system records to be contained 
at the beginning of the file)

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170304/9b8e8353/attachment.html>

From tsvibar at gmail.com  Sat Mar  4 08:55:03 2017
From: tsvibar at gmail.com (Micha Silver)
Date: Sat, 4 Mar 2017 18:55:03 +0200
Subject: [gdal-dev] converting ECW to GTiff for Linux
Message-ID: <fa6ca264-fb74-5d81-afc8-ad7253f1579d@gmail.com>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170304/5f4215f5/attachment.html>

From even.rouault at spatialys.com  Sat Mar  4 11:42:34 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 04 Mar 2017 20:42:34 +0100
Subject: [gdal-dev] converting ECW to GTiff for Linux
In-Reply-To: <fa6ca264-fb74-5d81-afc8-ad7253f1579d@gmail.com>
References: <fa6ca264-fb74-5d81-afc8-ad7253f1579d@gmail.com>
Message-ID: <7287348.emT3dMNd9x@even-i700>

On samedi 4 mars 2017 18:55:03 CET Micha Silver wrote:
> Hello:
> (I'm double posting as this problem is somewhere between GDAL and QGIS.)
> 
> I have converted an ECW compressed aerial photo to geotiff with JPEG
> compression on a Windows computer with gdal_translate. The resulting tif
> image displays fine with QGIS on the Windows machine.  GDAL version 2.1.3
> on the Windows computer, and QGIS 2.18.4 My command was similar to:
> gdal_translate -of GTiff -projwin ..... -co TILED=YES -co TFW=YES -co
> COMPRESS=JPEG -co PHOTOMETRIC=YCBCR in.ecw out.tif
> 
> I then copy the tif (and tfw) to my Linux machine, and try to open with
> QGIS, but QGIS crashes immediately. I should note that gdalinfo shows full
> information on both the Windows and Linux systems. On the Linux computer
> GDAL is 2.1.2 and QGIS is 2.18.4 .

On the Linux system where this crashes with QGIS, could you do :

gdalinfo -checksum -stats the.tif

If this crashes, the issue is clearly in GDAL. Otherwise it is likely in QGIS.

> 
> Any ideas what could be the cause of QGIS crashing with the gdal_translate
> converted tif image? Is there something that needs to be done on windows to
> create a Linux usable geotiff??
> 
> Thanks


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170304/53a87dad/attachment-0001.html>

From tsvibar at gmail.com  Sat Mar  4 13:27:51 2017
From: tsvibar at gmail.com (Micha Silver)
Date: Sat, 4 Mar 2017 23:27:51 +0200
Subject: [gdal-dev] converting ECW to GTiff for Linux
In-Reply-To: <7287348.emT3dMNd9x@even-i700>
References: <fa6ca264-fb74-5d81-afc8-ad7253f1579d@gmail.com>
 <7287348.emT3dMNd9x@even-i700>
Message-ID: <6b7ccee5-5cbe-b511-c2de-577a34566134@gmail.com>



On 03/04/2017 09:42 PM, Even Rouault wrote:
>
> On samedi 4 mars 2017 18:55:03 CET Micha Silver wrote:
>
> > Hello:
>
> > (I'm double posting as this problem is somewhere between GDAL and QGIS.)
>
> >
>
> > I have converted an ECW compressed aerial photo to geotiff with JPEG
>
> > compression on a Windows computer with gdal_translate. The resulting tif
>
> > image displays fine with QGIS on the Windows machine.  GDAL version 
> 2.1.3
>
> > on the Windows computer, and QGIS 2.18.4 My command was similar to:
>
> > gdal_translate -of GTiff -projwin ..... -co TILED=YES -co TFW=YES -co
>
> > COMPRESS=JPEG -co PHOTOMETRIC=YCBCR in.ecw out.tif
>
> >
>
> > I then copy the tif (and tfw) to my Linux machine, and try to open with
>
> > QGIS, but QGIS crashes immediately. I should note that gdalinfo 
> shows full
>
> > information on both the Windows and Linux systems. On the Linux computer
>
> > GDAL is 2.1.2 and QGIS is 2.18.4 .
>
> On the Linux system where this crashes with QGIS, could you do :
>
> gdalinfo -checksum -stats the.tif
>
> If this crashes, the issue is clearly in GDAL. Otherwise it is likely 
> in QGIS.
>
No crash, but I do see a Warning:

gdalinfo -checksum -stats kidron_e2.tif Driver: GTiff/GeoTIFF Files: 
kidron_e2.tif Size is 45200, 36000 ....

Warning 1: JPEGLib:Premature end of JPEG file Minimum=0.000, 
Maximum=255.000, Mean=163.947, StdDev=38.307 Checksum=49932 Metadata: 
STATISTICS_MAXIMUM=255 STATISTICS_MEAN=163.94735676131 
STATISTICS_MINIMUM=0 STATISTICS_STDDEV=38.30668730016 Band 2 
Block=256x256 Type=Byte, ColorInterp=Green Description = Green 
Minimum=0.000, Maximum=255.000, Mean=167.305, StdDev=32.125 Checksum=52 
Metadata: STATISTICS_MAXIMUM=255 STATISTICS_MEAN=167.3047566274 
STATISTICS_MINIMUM=0 STATISTICS_STDDEV=32.124800654502 Band 3 
Block=256x256 Type=Byte, ColorInterp=Blue Description = Blue 
Minimum=0.000, Maximum=255.000, Mean=146.241, StdDev=31.604 
Checksum=11457 Metadata: STATISTICS_MAXIMUM=255 
STATISTICS_MEAN=146.24062233882 STATISTICS_MINIMUM=0 
STATISTICS_STDDEV=31.603809219917

Also I have found that creating overlays seems to solve the problem 
(?!). After running:

gdaladdo --config COMPRESS_OVERVIEW JPEG --config PHOTOMETRIC_OVERVIEW 
YCBCR --config INTERLEAVE_OVERVIEW PIXEL -r average kidron_e2.tif 2 4 8 16

the tiff opens fine in QGIS.

Regards,

Micha

> >
>
> > Any ideas what could be the cause of QGIS crashing with the 
> gdal_translate
>
> > converted tif image? Is there something that needs to be done on 
> windows to
>
> > create a Linux usable geotiff??
>
> >
>
> > Thanks
>
> -- 
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>

-- 
Micha Silver
cell: +972-523-665918


From mateusz at loskot.net  Sun Mar  5 13:47:54 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sun, 5 Mar 2017 22:47:54 +0100
Subject: [gdal-dev] Implementing driver to support-of output format
Message-ID: <CABUeae88Es1Rb8Y_pXr6bmCp3644V3J+Ma9EdM=pfzQCYpsPbg@mail.gmail.com>

Hi,

I have a question about "-of output format" handling in a raster
driver implementation:

1. src_byte.tif is single band of Byte data type.

2. gdal_translate -of GTiff -ot UInt16 src_byte.tif dst_uint16.tif

3. In an implementation of `CreateCopy`

CreateCopy(char const* pszFilename, GDALDataset* poSrcDS, int bStrict, ...)
{
    ...
    eDT = poSrcDS->GetRasterBand(1)->GetRasterDataType();
    ...
    poSrcDS->RasterIO(GF_Read, ..., eDT, ...);
    ...
}

a) The source dataset band type is UInt16, while band in the source
src_byte.tif file is Byte.
b) RasterIO requests Uint16 from the src_byte.tif with Byte band.

Which, if any, part is responsible for the magic that changes the
pixel data form Byte to Uint16 during the RasterIO?

The driver tutorial
http://gdal.org/gdal_drivertut.html#gdal_drivertut_creation only seems
to explain what happens
after RasterIO, that is the "transforming data types on the fly"
before writing the data it into destination dataset.

>From a driver's implementor point, I found that use case a bit puzzling.
I have not implemented raster driver yet and I'm lacking of knowledge
of handling advanced data transformations.

I always thought that reading from `poSrcDS` is always based on the
original data type, ie. Byte in my example.
Then, the destination dataset driver takes the byte stream and, if
capable, transforms the data type according to the requested output
data type (option -ot).

Could anyone enlighten me about how a destination driver XXX is
supposed to handle use cases like: gdal_translate -of XXX -ot UInt16
src_byte.tif dst_uint16.XXX?

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From even.rouault at spatialys.com  Sun Mar  5 13:54:10 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 05 Mar 2017 22:54:10 +0100
Subject: [gdal-dev] Implementing driver to support-of output format
In-Reply-To: <CABUeae88Es1Rb8Y_pXr6bmCp3644V3J+Ma9EdM=pfzQCYpsPbg@mail.gmail.com>
References: <CABUeae88Es1Rb8Y_pXr6bmCp3644V3J+Ma9EdM=pfzQCYpsPbg@mail.gmail.com>
Message-ID: <3304795.1q8f0dJvIp@even-i700>

On dimanche 5 mars 2017 22:47:54 CET Mateusz Loskot wrote:
> Hi,
> 
> I have a question about "-of output format" handling in a raster
> driver implementation:
> 
> 1. src_byte.tif is single band of Byte data type.
> 
> 2. gdal_translate -of GTiff -ot UInt16 src_byte.tif dst_uint16.tif
> 
> 3. In an implementation of `CreateCopy`
> 
> CreateCopy(char const* pszFilename, GDALDataset* poSrcDS, int bStrict, ...)
> {
>     ...
>     eDT = poSrcDS->GetRasterBand(1)->GetRasterDataType();
>     ...
>     poSrcDS->RasterIO(GF_Read, ..., eDT, ...);
>     ...
> }
> 
> a) The source dataset band type is UInt16, while band in the source
> src_byte.tif file is Byte.
> b) RasterIO requests Uint16 from the src_byte.tif with Byte band.
> 
> Which, if any, part is responsible for the magic that changes the
> pixel data form Byte to Uint16 during the RasterIO?

Hi Mateusz,

if you look at apps/gdal_translate_lib.cpp, you'll see that, except cases without any 
arguments like gdal_translate in out -of output_format where the 'in' dataset is passed as the 
source dataset of CretaeCopy(), as soon as you add some transformation like changing data 
type, subsetting, etc, a in-memory VRT will be created to do that transformation. And it is 
that in-memory VRT that is passed as the source dataset to the CreateCopy() implementation 
of the output driver. That should answer all your following questions.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170305/2c9d7162/attachment.html>

From mateusz at loskot.net  Sun Mar  5 14:55:10 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sun, 5 Mar 2017 23:55:10 +0100
Subject: [gdal-dev] Implementing driver to support-of output format
In-Reply-To: <3304795.1q8f0dJvIp@even-i700>
References: <CABUeae88Es1Rb8Y_pXr6bmCp3644V3J+Ma9EdM=pfzQCYpsPbg@mail.gmail.com>
 <3304795.1q8f0dJvIp@even-i700>
Message-ID: <CABUeae-kZP5dgAUP=nnNff9TDfkoAg5KpQumz0f+BHjrcb4ekA@mail.gmail.com>

On 5 March 2017 at 22:54, Even Rouault <even.rouault at spatialys.com> wrote:
> On dimanche 5 mars 2017 22:47:54 CET Mateusz Loskot wrote:
>>
>> Which, if any, part is responsible for the magic that changes the
>> pixel data form Byte to Uint16 during the RasterIO?
>
> Hi Mateusz,
>
> if you look at apps/gdal_translate_lib.cpp, you'll see that, except cases
> without any arguments like gdal_translate in out -of output_format where the
> 'in' dataset is passed as the source dataset of CretaeCopy(), as soon as you
> add some transformation like changing data type, subsetting, etc, a
> in-memory VRT will be created to do that transformation. And it is that
> in-memory VRT that is passed as the source dataset to the CreateCopy()
> implementation of the output driver. That should answer all your following
> questions.

Hi Even,

Right, I looked there and noticed the use of VRT, but its purpose wasn't clear
(or I didn't look deep enough).
Yes, that answers my question, thank you.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From even.rouault at spatialys.com  Mon Mar  6 01:21:32 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 06 Mar 2017 10:21:32 +0100
Subject: [gdal-dev] Proposed ogrmerge.py utility script
In-Reply-To: <1488627774911-5310651.post@n6.nabble.com>
References: <1709522.QpxKACu8Wg@even-i700>
 <1488627774911-5310651.post@n6.nabble.com>
Message-ID: <1617900.mhUjQ6tmNo@even-i700>

On samedi 4 mars 2017 04:42:54 CET jratike80 wrote:
> Even Rouault-2 wrote
> 
> > Opinions on script naming (I also tought to ogrcat.py to reflect the
> > similarity with the Unix cat
> > utility used to concatenate files), option naming, etc.. are welcome
> 
> Hi,
> 
> ogrmerge.py is good name for the script.
> I would rename  -overwrite_lyr into -overwrite_layer. It pays only two
> letters, "layer" is already used in other parameters, and users would
> understand with less thinking what it means.


Committed into trunk with your remark taken into account.
https://svn.osgeo.org/gdal/trunk/gdal/swig/python/scripts/ogrmerge.py

Note: it can be used with GDAL 2.1 as well.

Online help page at :
http://gdal.org/ogrmerge.html

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170306/bad291bf/attachment.html>

From a.neumann at carto.net  Mon Mar  6 01:27:21 2017
From: a.neumann at carto.net (Neumann, Andreas)
Date: Mon, 06 Mar 2017 10:27:21 +0100
Subject: [gdal-dev] Geopackage ogr2ogr append question
In-Reply-To: <14202302.bnEMjc1SUT@even-i700>
References: <db33e2e629077523562a6fe6e2510e0d@carto.net>
 <14202302.bnEMjc1SUT@even-i700>
Message-ID: <1b19567e2cfd8d4f9f4a1f483a7f7078@carto.net>

Hi Even, 

I upgraded to gdal 2.1.3 and everything works fine regarding the
upgrades of the geopackage. 

I also switched to "-update" as you suggested, as -append is not
necessary, since I am creating new tables within an existing gepackage
and don't append to existing tables. 

Thanks a lot, 

Andreas 

On 2017-03-03 15:53, Even Rouault wrote:

> Hi Andreas, 
> 
>> 
> 
>> I am, for the first time trying to append additional tables with ogr2ogr 
> 
>> to an existing Geopackage file and have questions: 
> 
>> 
> 
>> ogr2ogr -progress -lco SPATIAL_INDEX=YES -f GPKG av_1700_lv03.gpkg 
> 
>> PG:'dbname=publikation host=localhost schemas=av_1700' -sql "SELECT 
> 
>> t_id, t_ili_tid, geom_03, bfs_nr, gemeinde, bodenbedeckungsart, 
> 
>> bodenbedeckungs_flaeche, gebaeudenummer, gwr_egid, objekt_name FROM 
> 
>> av_1700.bb_bodenbedeckung" 
> 
>> 
> 
>> ogr2ogr -progress -append -f GPKG av_1700_lv03.gpkg 
> 
>> PG:'dbname=publikation host=localhost schemas=av_1700' -sql "SELECT 
> 
>> t_id, t_ili_tid, geom_03, bfs_nr, gemeinde, linienart, bobeart_links, 
> 
>> bobeart_rechts FROM av_1700.bb_bodenbedeckung_kanten" 
> 
>> 
> 
>> ----------------- 
> 
>> 
> 
>> First question: 
> 
>> 
> 
>> is the -append option enough or do I also need the -update option? 
> 
> Yes -append is enough. It implies -update. 
> 
> But -append is for appending features to an existing table. If you need to create a new table, you just need -update. 
> 
> In your above case, you must be careful. The name of a SQL result layer depends on the driver. I nthe GPKG driver, it is always "sql_statement". You might want to rename it to something more useful with -nln new_layer_name, 
> 
>> 
> 
>> ----------------- 
> 
>> 
> 
>> Second question: 
> 
>> 
> 
>> I get warnings: 
> 
>> 
> 
>> Warning 1: Layer sql_statement relies on the 'gpkg_geom_COMPOUNDCURVE' 
> 
>> (GeoPackage 1.0 Specification Annex J) extension that should be 
> 
>> implemented for safe write-support, but is not currently. Update of that 
> 
>> layer are strongly discouraged to avoid corruption. 
> 
>> Warning 1: Layer sql_statement relies on the 'gpkg_geom_CURVEPOLYGON' 
> 
>> (GeoPackage 1.0 Specification Annex J) extension that should be 
> 
>> implemented for safe write-support, but is not currently. Update of that 
> 
>> layer are strongly discouraged to avoid corruption. 
> 
>> 
> 
>> Can I safely ignore these messages? Or is there a creation option for 
> 
>> the first table that enables this extension? 
> 
> Which GDAL version is this ? It looks like the issue of 
> 
> https://trac.osgeo.org/gdal/ticket/6402 
> 
> So this should be fixed in GDAL 2.0.3 or GDAL >= 2.1.0 
> 
> (the warning can be ignored, but you should upgrade to a more recent version so that the extension is properly registered as read-write) 
> 
> Even 
> 
> -- 
> 
> Spatialys - Geospatial professional services 
> 
> http://www.spatialys.com

  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170306/e4acbee1/attachment-0001.html>

From obe at IVV-AACHEN.DE  Mon Mar  6 05:26:52 2017
From: obe at IVV-AACHEN.DE (Felix Obermaier)
Date: Mon, 6 Mar 2017 13:26:52 +0000
Subject: [gdal-dev] Overcome attribute name limitation in shapefiles
Message-ID: <a9dd515226614c86ab34d84148be6829@IVV-EX.ivv-aachen.de>

Hello,

is it somehow possible to overcome the attribute name length limitiation of DBase files using GDAL? If so, how?

If not, why not add (another) file the shapefile dataset of shapes (shp, shx), projection (prj), data (dbf) and encoding(cpg), one that is (re-) defining the column names, allowing for

  *   mixed casing,
  *   non-ASCII characters,
  *   more than 10/11 characters

I'm aware of a software product that does it this way. The file that renames the columns is set up like a CSV file defining two columns, "Name" and "Alias". "Name" is the actual name of the column, "Alias" the name in the dbase file header.

Felix Obermaier

-----------------------------------------------
Ingenieurgruppe IVV GmbH & Co. KG
Dipl.-Ing. Felix Obermaier
Oppenhoffallee 171
52066 Aachen

Telefon: +49 (241) 94691-39
Telefax: +49 (241) 531622
eMail: obe at ivv-aachen.de
Internet: http://www.ivv-aachen.de

Sitz der Gesellschaft: Aachen
Amtsgericht Aachen HRA 6212
Geschäftsführer:
Dipl.-Ing. Wolfgang Hölsken
Dr.-Ing. Stephan Krug
Dr.-Ing. Dirk Serwill
IVV-Management GmbH
Amtsgericht Aachen HRB 12453

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170306/0cceb674/attachment.html>

From p.halls at york.ac.uk  Mon Mar  6 05:56:10 2017
From: p.halls at york.ac.uk (Peter Halls)
Date: Mon, 6 Mar 2017 13:56:10 +0000
Subject: [gdal-dev] Overcome attribute name limitation in shapefiles
In-Reply-To: <a9dd515226614c86ab34d84148be6829@IVV-EX.ivv-aachen.de>
References: <a9dd515226614c86ab34d84148be6829@IVV-EX.ivv-aachen.de>
Message-ID: <CADEnnOOisuv1SRiQJV3ggHHtRM=vqBZRbPe6r+hrVQNrz5DwRA@mail.gmail.com>

Felix,

      following your proposal would make Shapefiles cease to respect the
dBaseIV Standard and potentially seriously affect their interchangability.
There are a range of alternative formats supported by GDAL that achieve
your goal: for example, I use SQL as my base format and only convert when
necessary.  SQL is generally accepted by other packages and is far more
flexible than dBaseIV.

Best wishes,

Peter

On 6 March 2017 at 13:26, Felix Obermaier <obe at ivv-aachen.de> wrote:

> Hello,
>
>
>
> is it somehow possible to overcome the attribute name length limitiation
> of DBase files using GDAL? If so, how?
>
>
>
> If not, why not add (another) file the shapefile dataset of shapes (shp,
> shx), projection (prj), data (dbf) and encoding(cpg), one that is (re-)
> defining the column names, allowing for
>
>    - mixed casing,
>    - non-ASCII characters,
>    - more than 10/11 characters
>
>
>
> I’m aware of a software product that does it this way. The file that
> renames the columns is set up like a CSV file defining two columns, „Name“
> and „Alias“. „Name“ is the actual name of the column, „Alias“ the name in
> the dbase file header.
>
>
>
> Felix Obermaier
>
>
>
> -----------------------------------------------
>
> Ingenieurgruppe IVV GmbH & Co. KG
>
> Dipl.-Ing. Felix Obermaier
>
> Oppenhoffallee 171
>
> 52066 Aachen
>
>
>
> Telefon: +49 (241) 94691-39 <+49%20241%209469139>
>
> Telefax: +49 (241) 531622 <+49%20241%20531622>
>
> eMail: obe at ivv-aachen.de
>
> Internet: http://www.ivv-aachen.de
>
>
>
> Sitz der Gesellschaft: Aachen
>
> Amtsgericht Aachen HRA 6212
>
> Geschäftsführer:
>
> Dipl.-Ing. Wolfgang Hölsken
>
> Dr.-Ing. Stephan Krug
>
> Dr.-Ing. Dirk Serwill
>
> IVV-Management GmbH
>
> Amtsgericht Aachen HRB 12453
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
----------------------------------------------------------------------------------------------------------------
Peter J Halls, Post-war Reconstruction and Development Unit (PRDU),
                      University of York

Snail mail: c/o Research Centre for the Social Sciences (RCSS),
        University of York,
        Heslington, York YO10 5DD

This message has the status of a private and personal communication
----------------------------------------------------------------------------------------------------------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170306/1a881ea9/attachment.html>

From rainer.woitok at gmail.com  Mon Mar  6 06:14:59 2017
From: rainer.woitok at gmail.com (Dr Rainer Woitok)
Date: Mon, 6 Mar 2017 15:14:59 +0100
Subject: [gdal-dev] Makefile problem in GDAL?
Message-ID: <22717.28387.701000.418389@woitok.gmail.com>

Greetings,

having checked out the bookmark "remote/tags/2.1.3" (2017-01-20 08:19:14
+0000 even.rouault at mines-paris.org), I configured GDAL and the ran "make
install" just to produce the following error:

   libtool: compile:  g++ -I/home/Rainer/repo/gdal/gdal/port -I/home/Rainer/repo/gdal/gdal/gcore -I/home/Rainer/repo/gdal/gdal/alg -I/home/Rainer/repo/gdal/gdal/ogr -I/home/Rainer/repo/gdal/gdal/ogr/ogrsf_frmts -I/home/Rainer/repo/gdal/gdal/gnm -I/home/Rainer/repo/gdal/gdal/apps -g -O2 -Wall -Wextra -Winit-self -Wunused-parameter -Wformat -Werror=format-security -Wno-format-nonliteral -Wlogical-op -Wshadow -Werror=vla -Wmissing-declarations -Wnon-virtual-dtor -Woverloaded-virtual -fno-operator-names -DJPEG_DUAL_MODE_8_12 -Ilibjpeg -DDEFAULT_MAX_MEM=500000000L -DGNM_ENABLED -DOGR_ENABLED -I/home/Rainer/repo/gdal/gdal/port -I/home/Rainer/include -DGDAL_COMPILATION -I../mem -DENABLE_LIBJPEG_NO_RETURN -c jpgdataset.cpp  -DDLL_EXPORT -DPIC -o ../o/.libs/jpgdataset.o
   In file included from jpgdataset.cpp:40:0:
   /home/Rainer/include/memdataset.h:78:42: error: expected ';' at end of member declaration
        virtual const char *GetProjectionRef() CPL_OVERRIDE;
                                             ^

The already existing  header file "/home/Rainer/include/memdataset.h" is
a relict from former GDAL compilations  with other versions  checked out
and obviously didn't fit GDAL version 2.1.3.  But the real problem seems
to be that this file was  read at all.   The correct  header file was in
directory "../mem/",  but directive "-I../mem" was overridden by preced-
ing directive "-I/home/Rainer/include"  (derived from configuration opt-
ion "--includedir=...").   Shouldn't therefore this option together with
the directory derived from option "--oldincludedir=..."  be always spec-
ified as the very last "-I" options?

To work around the problem  I simply removed  any GDAL header files from
directory "/home/Rainer/include/" and successfully compiled GDAL.

Sincerely,
  Rainer

From even.rouault at spatialys.com  Mon Mar  6 07:16:04 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 06 Mar 2017 16:16:04 +0100
Subject: [gdal-dev] Makefile problem in GDAL?
In-Reply-To: <22717.28387.701000.418389@woitok.gmail.com>
References: <22717.28387.701000.418389@woitok.gmail.com>
Message-ID: <2267797.sWJSOxusdp@even-i700>

On lundi 6 mars 2017 15:14:59 CET Dr Rainer Woitok wrote:
> Greetings,
> 
> having checked out the bookmark "remote/tags/2.1.3" (2017-01-20 08:19:14
> +0000 even.rouault at mines-paris.org), I configured GDAL and the ran "make
> install" just to produce the following error:
> 
>    libtool: compile:  g++ -I/home/Rainer/repo/gdal/gdal/port
> -I/home/Rainer/repo/gdal/gdal/gcore -I/home/Rainer/repo/gdal/gdal/alg
> -I/home/Rainer/repo/gdal/gdal/ogr
> -I/home/Rainer/repo/gdal/gdal/ogr/ogrsf_frmts
> -I/home/Rainer/repo/gdal/gdal/gnm -I/home/Rainer/repo/gdal/gdal/apps -g -O2
> -Wall -Wextra -Winit-self -Wunused-parameter -Wformat
> -Werror=format-security -Wno-format-nonliteral -Wlogical-op -Wshadow
> -Werror=vla -Wmissing-declarations -Wnon-virtual-dtor -Woverloaded-virtual
> -fno-operator-names -DJPEG_DUAL_MODE_8_12 -Ilibjpeg
> -DDEFAULT_MAX_MEM=500000000L -DGNM_ENABLED -DOGR_ENABLED
> -I/home/Rainer/repo/gdal/gdal/port -I/home/Rainer/include
> -DGDAL_COMPILATION -I../mem -DENABLE_LIBJPEG_NO_RETURN -c jpgdataset.cpp 
> -DDLL_EXPORT -DPIC -o ../o/.libs/jpgdataset.o In file included from
> jpgdataset.cpp:40:0:
>    /home/Rainer/include/memdataset.h:78:42: error: expected ';' at end of
> member declaration virtual const char *GetProjectionRef() CPL_OVERRIDE;
>                                              ^
> 
> The already existing  header file "/home/Rainer/include/memdataset.h" is
> a relict from former GDAL compilations  with other versions  checked out
> and obviously didn't fit GDAL version 2.1.3.  But the real problem seems
> to be that this file was  read at all.   The correct  header file was in
> directory "../mem/",  but directive "-I../mem" was overridden by preced-
> ing directive "-I/home/Rainer/include"  (derived from configuration opt-
> ion "--includedir=...").   Shouldn't therefore this option together with
> the directory derived from option "--oldincludedir=..."  be always spec-
> ified as the very last "-I" options?

Indeed. I've fixed that in that Makefile in trunk. But it'slike there must be other driver 
makefiles where this should be fixed. If someone wants to do a review and propose patches...



-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170306/a19d1e36/attachment-0001.html>

From woodbri at swoodbridge.com  Mon Mar  6 10:20:50 2017
From: woodbri at swoodbridge.com (Stephen Woodbridge)
Date: Mon, 6 Mar 2017 13:20:50 -0500
Subject: [gdal-dev] Getting black lines between doqqs
Message-ID: <67f1f090-a9a1-1b8b-7c6e-8ca5972dd9f2@swoodbridge.com>

Hi,

I have a collection of doqqs that look like the two below. I trying to 
extract a small image the crosses between the two doqqs, but I'm getting 
a black line between them. When I serve them via mapserver, I'm not 
getting this.

gdalbuildvrt -addalpha tmp-tc-13110.vrt m_4012408_sw_10_h_20160528.tif 
m_4012416_nw_10_h_20160528.tif

gdal_translate -of GTiff -outsize 1360 1360 -projwin -124.083968798 
40.8779687978 -124.076031202 40.8700312022 -co TILED=YES -co 
COMPRESS=JPEG -co JPEG_QUALITY=90 --config GDAL_TIFF_INTERNAL_MASK YES 
tmp-tc-13110.vrt oaf2-tc.tif

I get the same result regardless of the -addalpha in the gdalbuildvrt 
command.

What am I missing?

-Steve

$ gdalinfo m_4012408_sw_10_h_20160528.tif
Driver: GTiff/GeoTIFF
Files: m_4012408_sw_10_h_20160528.tif
Size is 11140, 10847
Coordinate System is:
GEOGCS["WGS 84",
     DATUM["WGS_1984",
         SPHEROID["WGS 84",6378137,298.257223563,
             AUTHORITY["EPSG","7030"]],
         AUTHORITY["EPSG","6326"]],
     PRIMEM["Greenwich",0],
     UNIT["degree",0.0174532925199433],
     AUTHORITY["EPSG","4326"]]
Origin = (-124.127892543854088,40.939476459321497)
Pixel Size = (0.000006127013352,-0.000006127013352)
Metadata:
   AREA_OR_POINT=Area
Image Structure Metadata:
   COMPRESSION=YCbCr JPEG
   INTERLEAVE=PIXEL
   SOURCE_COLOR_SPACE=YCbCr
Corner Coordinates:
Upper Left  (-124.1278925,  40.9394765) (124d 7'40.41"W, 40d56'22.12"N)
Lower Left  (-124.1278925,  40.8730167) (124d 7'40.41"W, 40d52'22.86"N)
Upper Right (-124.0596376,  40.9394765) (124d 3'34.70"W, 40d56'22.12"N)
Lower Right (-124.0596376,  40.8730167) (124d 3'34.70"W, 40d52'22.86"N)
Center      (-124.0937651,  40.9062466) (124d 5'37.55"W, 40d54'22.49"N)
Band 1 Block=256x256 Type=Byte, ColorInterp=Red
   Overviews: 5570x5424, 2785x2712, 1393x1356, 697x678, 349x339, 
175x170, 88x85
   Mask Flags: PER_DATASET
   Overviews of mask band: 5570x5424, 2785x2712, 1393x1356, 697x678, 
349x339, 175x170, 88x85
Band 2 Block=256x256 Type=Byte, ColorInterp=Green
   Overviews: 5570x5424, 2785x2712, 1393x1356, 697x678, 349x339, 
175x170, 88x85
   Mask Flags: PER_DATASET
   Overviews of mask band: 5570x5424, 2785x2712, 1393x1356, 697x678, 
349x339, 175x170, 88x85
Band 3 Block=256x256 Type=Byte, ColorInterp=Blue
   Overviews: 5570x5424, 2785x2712, 1393x1356, 697x678, 349x339, 
175x170, 88x85
   Mask Flags: PER_DATASET
   Overviews of mask band: 5570x5424, 2785x2712, 1393x1356, 697x678, 
349x339, 175x170, 88x85


$ gdalinfo m_4012416_nw_10_h_20160528.tif
Driver: GTiff/GeoTIFF
Files: m_4012416_nw_10_h_20160528.tif
Size is 11145, 10851
Coordinate System is:
GEOGCS["WGS 84",
     DATUM["WGS_1984",
         SPHEROID["WGS 84",6378137,298.257223563,
             AUTHORITY["EPSG","7030"]],
         AUTHORITY["EPSG","6326"]],
     PRIMEM["Greenwich",0],
     UNIT["degree",0.0174532925199433],
     AUTHORITY["EPSG","4326"]]
Origin = (-124.127899397118711,40.876995871942221)
Pixel Size = (0.000006124881549,-0.000006124881549)
Metadata:
   AREA_OR_POINT=Area
Image Structure Metadata:
   COMPRESSION=YCbCr JPEG
   INTERLEAVE=PIXEL
   SOURCE_COLOR_SPACE=YCbCr
Corner Coordinates:
Upper Left  (-124.1278994,  40.8769959) (124d 7'40.44"W, 40d52'37.19"N)
Lower Left  (-124.1278994,  40.8105348) (124d 7'40.44"W, 40d48'37.93"N)
Upper Right (-124.0596376,  40.8769959) (124d 3'34.70"W, 40d52'37.19"N)
Lower Right (-124.0596376,  40.8105348) (124d 3'34.70"W, 40d48'37.93"N)
Center      (-124.0937685,  40.8437653) (124d 5'37.57"W, 40d50'37.56"N)
Band 1 Block=256x256 Type=Byte, ColorInterp=Red
   Overviews: 5573x5426, 2787x2713, 1394x1357, 697x679, 349x340, 
175x170, 88x85
   Mask Flags: PER_DATASET
   Overviews of mask band: 5573x5426, 2787x2713, 1394x1357, 697x679, 
349x340, 175x170, 88x85
Band 2 Block=256x256 Type=Byte, ColorInterp=Green
   Overviews: 5573x5426, 2787x2713, 1394x1357, 697x679, 349x340, 
175x170, 88x85
   Mask Flags: PER_DATASET
   Overviews of mask band: 5573x5426, 2787x2713, 1394x1357, 697x679, 
349x340, 175x170, 88x85
Band 3 Block=256x256 Type=Byte, ColorInterp=Blue
   Overviews: 5573x5426, 2787x2713, 1394x1357, 697x679, 349x340, 
175x170, 88x85
   Mask Flags: PER_DATASET
   Overviews of mask band: 5573x5426, 2787x2713, 1394x1357, 697x679, 
349x340, 175x170, 88x85

---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus


From even.rouault at spatialys.com  Mon Mar  6 10:35:15 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 06 Mar 2017 19:35:15 +0100
Subject: [gdal-dev] Getting black lines between doqqs
In-Reply-To: <67f1f090-a9a1-1b8b-7c6e-8ca5972dd9f2@swoodbridge.com>
References: <67f1f090-a9a1-1b8b-7c6e-8ca5972dd9f2@swoodbridge.com>
Message-ID: <70922052.6OTRWnRUsV@even-i700>

On lundi 6 mars 2017 13:20:50 CET Stephen Woodbridge wrote:
> Hi,
> 
> I have a collection of doqqs that look like the two below. I trying to
> extract a small image the crosses between the two doqqs, but I'm getting
> a black line between them. When I serve them via mapserver, I'm not
> getting this.
> 
> gdalbuildvrt -addalpha tmp-tc-13110.vrt m_4012408_sw_10_h_20160528.tif
> m_4012416_nw_10_h_20160528.tif
> 
> gdal_translate -of GTiff -outsize 1360 1360 -projwin -124.083968798
> 40.8779687978 -124.076031202 40.8700312022 -co TILED=YES -co
> COMPRESS=JPEG -co JPEG_QUALITY=90 --config GDAL_TIFF_INTERNAL_MASK YES
> tmp-tc-13110.vrt oaf2-tc.tif
> 
> I get the same result regardless of the -addalpha in the gdalbuildvrt
> command.
> 
> What am I missing?

If your tiles have colar (which I supposed since they have a mask), gdalbuildvrt  (actually the 
VRT driver) doesn't take it into account as you might expect. It doesn't blend alpha/mask, but 
takes the alpha/mask value of the last source in the VRT that intersects the window of 
interest. You might have more success with

gdalwarp in1.tif in2.tif out.tif -dstalpha -te xmin ymin xmax ymax



> 
> -Steve
> 
> $ gdalinfo m_4012408_sw_10_h_20160528.tif
> Driver: GTiff/GeoTIFF
> Files: m_4012408_sw_10_h_20160528.tif
> Size is 11140, 10847
> Coordinate System is:
> GEOGCS["WGS 84",
>      DATUM["WGS_1984",
>          SPHEROID["WGS 84",6378137,298.257223563,
>              AUTHORITY["EPSG","7030"]],
>          AUTHORITY["EPSG","6326"]],
>      PRIMEM["Greenwich",0],
>      UNIT["degree",0.0174532925199433],
>      AUTHORITY["EPSG","4326"]]
> Origin = (-124.127892543854088,40.939476459321497)
> Pixel Size = (0.000006127013352,-0.000006127013352)
> Metadata:
>    AREA_OR_POINT=Area
> Image Structure Metadata:
>    COMPRESSION=YCbCr JPEG
>    INTERLEAVE=PIXEL
>    SOURCE_COLOR_SPACE=YCbCr
> Corner Coordinates:
> Upper Left  (-124.1278925,  40.9394765) (124d 7'40.41"W, 40d56'22.12"N)
> Lower Left  (-124.1278925,  40.8730167) (124d 7'40.41"W, 40d52'22.86"N)
> Upper Right (-124.0596376,  40.9394765) (124d 3'34.70"W, 40d56'22.12"N)
> Lower Right (-124.0596376,  40.8730167) (124d 3'34.70"W, 40d52'22.86"N)
> Center      (-124.0937651,  40.9062466) (124d 5'37.55"W, 40d54'22.49"N)
> Band 1 Block=256x256 Type=Byte, ColorInterp=Red
>    Overviews: 5570x5424, 2785x2712, 1393x1356, 697x678, 349x339,
> 175x170, 88x85
>    Mask Flags: PER_DATASET
>    Overviews of mask band: 5570x5424, 2785x2712, 1393x1356, 697x678,
> 349x339, 175x170, 88x85
> Band 2 Block=256x256 Type=Byte, ColorInterp=Green
>    Overviews: 5570x5424, 2785x2712, 1393x1356, 697x678, 349x339,
> 175x170, 88x85
>    Mask Flags: PER_DATASET
>    Overviews of mask band: 5570x5424, 2785x2712, 1393x1356, 697x678,
> 349x339, 175x170, 88x85
> Band 3 Block=256x256 Type=Byte, ColorInterp=Blue
>    Overviews: 5570x5424, 2785x2712, 1393x1356, 697x678, 349x339,
> 175x170, 88x85
>    Mask Flags: PER_DATASET
>    Overviews of mask band: 5570x5424, 2785x2712, 1393x1356, 697x678,
> 349x339, 175x170, 88x85
> 
> 
> $ gdalinfo m_4012416_nw_10_h_20160528.tif
> Driver: GTiff/GeoTIFF
> Files: m_4012416_nw_10_h_20160528.tif
> Size is 11145, 10851
> Coordinate System is:
> GEOGCS["WGS 84",
>      DATUM["WGS_1984",
>          SPHEROID["WGS 84",6378137,298.257223563,
>              AUTHORITY["EPSG","7030"]],
>          AUTHORITY["EPSG","6326"]],
>      PRIMEM["Greenwich",0],
>      UNIT["degree",0.0174532925199433],
>      AUTHORITY["EPSG","4326"]]
> Origin = (-124.127899397118711,40.876995871942221)
> Pixel Size = (0.000006124881549,-0.000006124881549)
> Metadata:
>    AREA_OR_POINT=Area
> Image Structure Metadata:
>    COMPRESSION=YCbCr JPEG
>    INTERLEAVE=PIXEL
>    SOURCE_COLOR_SPACE=YCbCr
> Corner Coordinates:
> Upper Left  (-124.1278994,  40.8769959) (124d 7'40.44"W, 40d52'37.19"N)
> Lower Left  (-124.1278994,  40.8105348) (124d 7'40.44"W, 40d48'37.93"N)
> Upper Right (-124.0596376,  40.8769959) (124d 3'34.70"W, 40d52'37.19"N)
> Lower Right (-124.0596376,  40.8105348) (124d 3'34.70"W, 40d48'37.93"N)
> Center      (-124.0937685,  40.8437653) (124d 5'37.57"W, 40d50'37.56"N)
> Band 1 Block=256x256 Type=Byte, ColorInterp=Red
>    Overviews: 5573x5426, 2787x2713, 1394x1357, 697x679, 349x340,
> 175x170, 88x85
>    Mask Flags: PER_DATASET
>    Overviews of mask band: 5573x5426, 2787x2713, 1394x1357, 697x679,
> 349x340, 175x170, 88x85
> Band 2 Block=256x256 Type=Byte, ColorInterp=Green
>    Overviews: 5573x5426, 2787x2713, 1394x1357, 697x679, 349x340,
> 175x170, 88x85
>    Mask Flags: PER_DATASET
>    Overviews of mask band: 5573x5426, 2787x2713, 1394x1357, 697x679,
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170306/6b4dce3e/attachment-0001.html>

From woodbri at swoodbridge.com  Mon Mar  6 12:52:03 2017
From: woodbri at swoodbridge.com (Stephen Woodbridge)
Date: Mon, 6 Mar 2017 15:52:03 -0500
Subject: [gdal-dev] Getting black lines between doqqs
In-Reply-To: <70922052.6OTRWnRUsV@even-i700>
References: <67f1f090-a9a1-1b8b-7c6e-8ca5972dd9f2@swoodbridge.com>
 <70922052.6OTRWnRUsV@even-i700>
Message-ID: <fcce514f-4caf-e27c-0b29-5046ca3d3a5a@swoodbridge.com>

Thank you Even! that was the trick and it works great now.

On 3/6/2017 1:35 PM, Even Rouault wrote:
> On lundi 6 mars 2017 13:20:50 CET Stephen Woodbridge wrote:
>
>> Hi,
>
>>
>
>> I have a collection of doqqs that look like the two below. I trying to
>
>> extract a small image the crosses between the two doqqs, but I'm getting
>
>> a black line between them. When I serve them via mapserver, I'm not
>
>> getting this.
>
>>
>
>> gdalbuildvrt -addalpha tmp-tc-13110.vrt m_4012408_sw_10_h_20160528.tif
>
>> m_4012416_nw_10_h_20160528.tif
>
>>
>
>> gdal_translate -of GTiff -outsize 1360 1360 -projwin -124.083968798
>
>> 40.8779687978 -124.076031202 40.8700312022 -co TILED=YES -co
>
>> COMPRESS=JPEG -co JPEG_QUALITY=90 --config GDAL_TIFF_INTERNAL_MASK YES
>
>> tmp-tc-13110.vrt oaf2-tc.tif
>
>>
>
>> I get the same result regardless of the -addalpha in the gdalbuildvrt
>
>> command.
>
>>
>
>> What am I missing?
>
>
>
> If your tiles have colar (which I supposed since they have a mask),
> gdalbuildvrt (actually the VRT driver) doesn't take it into account as
> you might expect. It doesn't blend alpha/mask, but takes the alpha/mask
> value of the last source in the VRT that intersects the window of
> interest. You might have more success with
>
>
>
> gdalwarp in1.tif in2.tif out.tif -dstalpha -te xmin ymin xmax ymax
>
>
>
>
>
>
>
>>
>
>> -Steve
>
>>
>
>> $ gdalinfo m_4012408_sw_10_h_20160528.tif
>
>> Driver: GTiff/GeoTIFF
>
>> Files: m_4012408_sw_10_h_20160528.tif
>
>> Size is 11140, 10847
>
>> Coordinate System is:
>
>> GEOGCS["WGS 84",
>
>> DATUM["WGS_1984",
>
>> SPHEROID["WGS 84",6378137,298.257223563,
>
>> AUTHORITY["EPSG","7030"]],
>
>> AUTHORITY["EPSG","6326"]],
>
>> PRIMEM["Greenwich",0],
>
>> UNIT["degree",0.0174532925199433],
>
>> AUTHORITY["EPSG","4326"]]
>
>> Origin = (-124.127892543854088,40.939476459321497)
>
>> Pixel Size = (0.000006127013352,-0.000006127013352)
>
>> Metadata:
>
>> AREA_OR_POINT=Area
>
>> Image Structure Metadata:
>
>> COMPRESSION=YCbCr JPEG
>
>> INTERLEAVE=PIXEL
>
>> SOURCE_COLOR_SPACE=YCbCr
>
>> Corner Coordinates:
>
>> Upper Left (-124.1278925, 40.9394765) (124d 7'40.41"W, 40d56'22.12"N)
>
>> Lower Left (-124.1278925, 40.8730167) (124d 7'40.41"W, 40d52'22.86"N)
>
>> Upper Right (-124.0596376, 40.9394765) (124d 3'34.70"W, 40d56'22.12"N)
>
>> Lower Right (-124.0596376, 40.8730167) (124d 3'34.70"W, 40d52'22.86"N)
>
>> Center (-124.0937651, 40.9062466) (124d 5'37.55"W, 40d54'22.49"N)
>
>> Band 1 Block=256x256 Type=Byte, ColorInterp=Red
>
>> Overviews: 5570x5424, 2785x2712, 1393x1356, 697x678, 349x339,
>
>> 175x170, 88x85
>
>> Mask Flags: PER_DATASET
>
>> Overviews of mask band: 5570x5424, 2785x2712, 1393x1356, 697x678,
>
>> 349x339, 175x170, 88x85
>
>> Band 2 Block=256x256 Type=Byte, ColorInterp=Green
>
>> Overviews: 5570x5424, 2785x2712, 1393x1356, 697x678, 349x339,
>
>> 175x170, 88x85
>
>> Mask Flags: PER_DATASET
>
>> Overviews of mask band: 5570x5424, 2785x2712, 1393x1356, 697x678,
>
>> 349x339, 175x170, 88x85
>
>> Band 3 Block=256x256 Type=Byte, ColorInterp=Blue
>
>> Overviews: 5570x5424, 2785x2712, 1393x1356, 697x678, 349x339,
>
>> 175x170, 88x85
>
>> Mask Flags: PER_DATASET
>
>> Overviews of mask band: 5570x5424, 2785x2712, 1393x1356, 697x678,
>
>> 349x339, 175x170, 88x85
>
>>
>
>>
>
>> $ gdalinfo m_4012416_nw_10_h_20160528.tif
>
>> Driver: GTiff/GeoTIFF
>
>> Files: m_4012416_nw_10_h_20160528.tif
>
>> Size is 11145, 10851
>
>> Coordinate System is:
>
>> GEOGCS["WGS 84",
>
>> DATUM["WGS_1984",
>
>> SPHEROID["WGS 84",6378137,298.257223563,
>
>> AUTHORITY["EPSG","7030"]],
>
>> AUTHORITY["EPSG","6326"]],
>
>> PRIMEM["Greenwich",0],
>
>> UNIT["degree",0.0174532925199433],
>
>> AUTHORITY["EPSG","4326"]]
>
>> Origin = (-124.127899397118711,40.876995871942221)
>
>> Pixel Size = (0.000006124881549,-0.000006124881549)
>
>> Metadata:
>
>> AREA_OR_POINT=Area
>
>> Image Structure Metadata:
>
>> COMPRESSION=YCbCr JPEG
>
>> INTERLEAVE=PIXEL
>
>> SOURCE_COLOR_SPACE=YCbCr
>
>> Corner Coordinates:
>
>> Upper Left (-124.1278994, 40.8769959) (124d 7'40.44"W, 40d52'37.19"N)
>
>> Lower Left (-124.1278994, 40.8105348) (124d 7'40.44"W, 40d48'37.93"N)
>
>> Upper Right (-124.0596376, 40.8769959) (124d 3'34.70"W, 40d52'37.19"N)
>
>> Lower Right (-124.0596376, 40.8105348) (124d 3'34.70"W, 40d48'37.93"N)
>
>> Center (-124.0937685, 40.8437653) (124d 5'37.57"W, 40d50'37.56"N)
>
>> Band 1 Block=256x256 Type=Byte, ColorInterp=Red
>
>> Overviews: 5573x5426, 2787x2713, 1394x1357, 697x679, 349x340,
>
>> 175x170, 88x85
>
>> Mask Flags: PER_DATASET
>
>> Overviews of mask band: 5573x5426, 2787x2713, 1394x1357, 697x679,
>
>> 349x340, 175x170, 88x85
>
>> Band 2 Block=256x256 Type=Byte, ColorInterp=Green
>
>> Overviews: 5573x5426, 2787x2713, 1394x1357, 697x679, 349x340,
>
>> 175x170, 88x85
>
>> Mask Flags: PER_DATASET
>
>> Overviews of mask band: 5573x5426, 2787x2713, 1394x1357, 697x679,
>
>> 349x340, 175x170, 88x85
>
>> Band 3 Block=256x256 Type=Byte, ColorInterp=Blue
>
>> Overviews: 5573x5426, 2787x2713, 1394x1357, 697x679, 349x340,
>
>> 175x170, 88x85
>
>> Mask Flags: PER_DATASET
>
>> Overviews of mask band: 5573x5426, 2787x2713, 1394x1357, 697x679,
>
>> 349x340, 175x170, 88x85
>
>>
>
>> ---
>
>> This email has been checked for viruses by Avast antivirus software.
>
>> https://www.avast.com/antivirus
>
>>
>
>> _______________________________________________
>
>> gdal-dev mailing list
>
>> gdal-dev at lists.osgeo.org
>
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>


---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus


From obe at IVV-AACHEN.DE  Tue Mar  7 01:17:50 2017
From: obe at IVV-AACHEN.DE (Felix Obermaier)
Date: Tue, 7 Mar 2017 09:17:50 +0000
Subject: [gdal-dev] Overcome attribute name limitation in shapefiles
In-Reply-To: <CADEnnOOisuv1SRiQJV3ggHHtRM=vqBZRbPe6r+hrVQNrz5DwRA@mail.gmail.com>
References: <a9dd515226614c86ab34d84148be6829@IVV-EX.ivv-aachen.de>
 <CADEnnOOisuv1SRiQJV3ggHHtRM=vqBZRbPe6r+hrVQNrz5DwRA@mail.gmail.com>
Message-ID: <8b0520b6a2f7483088f74664227f97c0@IVV-EX.ivv-aachen.de>

Peter,

why would it cease to respect the dBaseIV Standard? I’m not proposing a change regarding the dBase format but an additional file that gives additional information the data in the attribute column. If you don’t supply that file you don’t have the additinal information, but you still can access the data and have to figure out by yourself what it is.

I know that there are other data sources that are not limited in the size for column names that I can use. But often I’m asked „Can you provide me a Shapefile“ and then I’m sometimes stuck with column names that are abbreviated to undistinctness.
Or I get a shapefile of that kind, which does not make it any better.

Felix

Von: Peter Halls [mailto:p.halls at york.ac.uk]
Gesendet: Montag, 6. März 2017 14:56
An: Felix Obermaier <obe at IVV-AACHEN.DE>; gdal dev <gdal-dev at lists.osgeo.org>
Betreff: Re: [gdal-dev] Overcome attribute name limitation in shapefiles

Felix,
      following your proposal would make Shapefiles cease to respect the dBaseIV Standard and potentially seriously affect their interchangability.  There are a range of alternative formats supported by GDAL that achieve your goal: for example, I use SQL as my base format and only convert when necessary.  SQL is generally accepted by other packages and is far more flexible than dBaseIV.
Best wishes,
Peter

On 6 March 2017 at 13:26, Felix Obermaier <obe at ivv-aachen.de<mailto:obe at ivv-aachen.de>> wrote:
Hello,

is it somehow possible to overcome the attribute name length limitiation of DBase files using GDAL? If so, how?

If not, why not add (another) file the shapefile dataset of shapes (shp, shx), projection (prj), data (dbf) and encoding(cpg), one that is (re-) defining the column names, allowing for

  *   mixed casing,
  *   non-ASCII characters,
  *   more than 10/11 characters

I’m aware of a software product that does it this way. The file that renames the columns is set up like a CSV file defining two columns, „Name“ and „Alias“. „Name“ is the actual name of the column, „Alias“ the name in the dbase file header.

Felix Obermaier

-----------------------------------------------
Ingenieurgruppe IVV GmbH & Co. KG
Dipl.-Ing. Felix Obermaier
Oppenhoffallee 171
52066 Aachen

Telefon: +49 (241) 94691-39<tel:+49%20241%209469139>
Telefax: +49 (241) 531622<tel:+49%20241%20531622>
eMail: obe at ivv-aachen.de<mailto:obe at ivv-aachen.de>
Internet: http://www.ivv-aachen.de

Sitz der Gesellschaft: Aachen
Amtsgericht Aachen HRA 6212
Geschäftsführer:
Dipl.-Ing. Wolfgang Hölsken
Dr.-Ing. Stephan Krug
Dr.-Ing. Dirk Serwill
IVV-Management GmbH
Amtsgericht Aachen HRB 12453


_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev



--
----------------------------------------------------------------------------------------------------------------
Peter J Halls, Post-war Reconstruction and Development Unit (PRDU),
                      University of York

Snail mail: c/o Research Centre for the Social Sciences (RCSS),
        University of York,
        Heslington, York YO10 5DD

This message has the status of a private and personal communication
----------------------------------------------------------------------------------------------------------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170307/9a8ca317/attachment-0001.html>

From even.rouault at spatialys.com  Tue Mar  7 01:35:29 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 07 Mar 2017 10:35:29 +0100
Subject: [gdal-dev] Overcome attribute name limitation in shapefiles
In-Reply-To: <8b0520b6a2f7483088f74664227f97c0@IVV-EX.ivv-aachen.de>
References: <a9dd515226614c86ab34d84148be6829@IVV-EX.ivv-aachen.de>
 <CADEnnOOisuv1SRiQJV3ggHHtRM=vqBZRbPe6r+hrVQNrz5DwRA@mail.gmail.com>
 <8b0520b6a2f7483088f74664227f97c0@IVV-EX.ivv-aachen.de>
Message-ID: <1552664.W7KxsO0u2h@even-i700>

On mardi 7 mars 2017 09:17:50 CET Felix Obermaier wrote:
> Peter,
> 
> why would it cease to respect the dBaseIV Standard? I’m not proposing a
> change regarding the dBase format but an additional file that gives
> additional information the data in the attribute column. If you don’t
> supply that file you don’t have the additinal information, but you still
> can access the data and have to figure out by yourself what it is.
 
> I know that there are other data sources that are not limited in the size
> for column names that I can use. But often I’m asked „Can you provide me a
> Shapefile“ and then I’m sometimes stuck with column names that are
> abbreviated to undistinctness.
 Or I get a shapefile of that kind, which
> does not make it any better. 
> Felix
> 
> Von: Peter Halls [mailto:p.halls at york.ac.uk]
> Gesendet: Montag, 6. März 2017 14:56
> An: Felix Obermaier <obe at IVV-AACHEN.DE>; gdal dev
> <gdal-dev at lists.osgeo.org>
 Betreff: Re: [gdal-dev] Overcome attribute name
> limitation in shapefiles 
> Felix,
>       following your proposal would make Shapefiles cease to respect the
> dBaseIV Standard and potentially seriously affect their interchangability. 
> There are a range of alternative formats supported by GDAL that achieve
> your goal: for example, I use SQL as my base format and only convert when
> necessary.  SQL is generally accepted by other packages and is far more
> flexible than dBaseIV.
 Best wishes,
> Peter
> 
> On 6 March 2017 at 13:26, Felix Obermaier
> <obe at ivv-aachen.de<mailto:obe at ivv-aachen.de>> wrote:
 Hello,
> 
> is it somehow possible to overcome the attribute name length limitiation of
> DBase files using GDAL? If so, how?
 
> If not, why not add (another) file the shapefile dataset of shapes (shp,
> shx), projection (prj), data (dbf) and encoding(cpg), one that is (re-)
> defining the column names, allowing for
 
>   *   mixed casing,
>   *   non-ASCII characters,
>   *   more than 10/11 characters
> 
> I’m aware of a software product that does it this way. The file that renames
> the columns is set up like a CSV file defining two columns, „Name“ and
> „Alias“. „Name“ is the actual name of the column, „Alias“ the name in the
> dbase file header.

What is this software that produces this sidecar CSV-like format ? Could you show examples 
of such datasets ?

 
> Felix Obermaier
> 
> -----------------------------------------------
> Ingenieurgruppe IVV GmbH & Co. KG
> Dipl.-Ing. Felix Obermaier
> Oppenhoffallee 171
> 52066 Aachen
> 
> Telefon: +49 (241) 94691-39<tel:+49%20241%209469139>
> Telefax: +49 (241) 531622<tel:+49%20241%20531622>
> eMail: obe at ivv-aachen.de<mailto:obe at ivv-aachen.de>
> Internet: http://www.ivv-aachen.de
> 
> Sitz der Gesellschaft: Aachen
> Amtsgericht Aachen HRA 6212
> Geschäftsführer:
> Dipl.-Ing. Wolfgang Hölsken
> Dr.-Ing. Stephan Krug
> Dr.-Ing. Dirk Serwill
> IVV-Management GmbH
> Amtsgericht Aachen HRB 12453
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 
> 
> --
> ----------------------------------------------------------------------------
> ------------------------------------
 Peter J Halls, Post-war Reconstruction
> and Development Unit (PRDU), University of York
> 
> Snail mail: c/o Research Centre for the Social Sciences (RCSS),
>         University of York,
>         Heslington, York YO10 5DD
> 
> This message has the status of a private and personal communication
> ----------------------------------------------------------------------------
> ------------------------------------


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170307/73122c1c/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Tue Mar  7 01:57:26 2017
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Tue, 7 Mar 2017 09:57:26 +0000
Subject: [gdal-dev] WFS driver and GML application schema
Message-ID: <e6502b209b754ea2b1a57aee8dffc67f@C119S212VM022.msvyvi.vaha.local>

Hi,

What if a WFS server is returning GML that has complex schema, does GDAL know to open the response as GML application schema data automatically or with some open option?  I  ask because I can see "succeeds as GML" in the debug log:

HTTP: Fetch(https://opaskartta.turku.fi/TeklaOGCWeb/WFS.ashx?SERVICE=WFS&VERSION=1.0.0&REQUEST=DescribeFeatureType&typeName=akaava:Kaavayksikko)
GML: Generating /vsimem/tempwfs_00000000034A8DC0/file.gfs file, ignoring /vsimem/tmp_gml_xsd_0000000003B73E80.xsd
GDAL: GDALOpen(/vsimem/tempwfs_00000000034A8DC0/file.gml, this=0000000003B73E80) succeeds as GML.


-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170307/e33cbfb4/attachment-0001.html>

From obe at IVV-AACHEN.DE  Tue Mar  7 02:09:27 2017
From: obe at IVV-AACHEN.DE (Felix Obermaier)
Date: Tue, 7 Mar 2017 10:09:27 +0000
Subject: [gdal-dev] Overcome attribute name limitation in shapefiles
In-Reply-To: <1552664.W7KxsO0u2h@even-i700>
References: <a9dd515226614c86ab34d84148be6829@IVV-EX.ivv-aachen.de>
 <CADEnnOOisuv1SRiQJV3ggHHtRM=vqBZRbPe6r+hrVQNrz5DwRA@mail.gmail.com>
 <8b0520b6a2f7483088f74664227f97c0@IVV-EX.ivv-aachen.de>
 <1552664.W7KxsO0u2h@even-i700>
Message-ID: <3df829d7a1bc4922bce84c1b6005ca47@IVV-EX.ivv-aachen.de>

Even,


> What is this software that produces this sidecar CSV-like format ?

It is a traffic demand and simulation software called PTV-VISUM

(http://vision-traffic.ptvgroup.com/en-uk/products/ptv-visum/)



> Could you show examples of such datasets ?
http://download.ivv-aachen.de/webdaten/ptv-visum-shape.zip
The supplementary file is „ptv-visum-shape.CTF“.

Felix


Von: Even Rouault [mailto:even.rouault at spatialys.com]
Gesendet: Dienstag, 7. März 2017 10:35
An:
Cc: Felix Obermaier <obe at IVV-AACHEN.DE>; Peter Halls <p.halls at york.ac.uk>
Betreff: Re: [gdal-dev] Overcome attribute name limitation in shapefiles


On mardi 7 mars 2017 09:17:50 CET Felix Obermaier wrote:

> Peter,

>

> why would it cease to respect the dBaseIV Standard? I’m not proposing a

> change regarding the dBase format but an additional file that gives

> additional information the data in the attribute column. If you don’t

> supply that file you don’t have the additinal information, but you still

> can access the data and have to figure out by yourself what it is.

> I know that there are other data sources that are not limited in the size

> for column names that I can use. But often I’m asked „Can you provide me a

> Shapefile“ and then I’m sometimes stuck with column names that are

> abbreviated to undistinctness.

Or I get a shapefile of that kind, which

> does not make it any better.

> Felix

>

> Von: Peter Halls [mailto:p.halls at york.ac.uk]

> Gesendet: Montag, 6. März 2017 14:56

> An: Felix Obermaier <obe at IVV-AACHEN.DE<mailto:obe at IVV-AACHEN.DE>>; gdal dev

> <gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>>

Betreff: Re: [gdal-dev] Overcome attribute name

> limitation in shapefiles

> Felix,

> following your proposal would make Shapefiles cease to respect the

> dBaseIV Standard and potentially seriously affect their interchangability.

> There are a range of alternative formats supported by GDAL that achieve

> your goal: for example, I use SQL as my base format and only convert when

> necessary. SQL is generally accepted by other packages and is far more

> flexible than dBaseIV.

Best wishes,

> Peter

>

> On 6 March 2017 at 13:26, Felix Obermaier

> <obe at ivv-aachen.de<mailto:obe at ivv-aachen.de<mailto:obe at ivv-aachen.de%3cmailto:obe at ivv-aachen.de>>> wrote:

Hello,

>

> is it somehow possible to overcome the attribute name length limitiation of

> DBase files using GDAL? If so, how?

> If not, why not add (another) file the shapefile dataset of shapes (shp,

> shx), projection (prj), data (dbf) and encoding(cpg), one that is (re-)

> defining the column names, allowing for

> * mixed casing,

> * non-ASCII characters,

> * more than 10/11 characters

>

> I’m aware of a software product that does it this way. The file that renames

> the columns is set up like a CSV file defining two columns, „Name“ and

> „Alias“. „Name“ is the actual name of the column, „Alias“ the name in the

> dbase file header.



What is this software that produces this sidecar CSV-like format ? Could you show examples of such datasets ?



> Felix Obermaier

>

> -----------------------------------------------

> Ingenieurgruppe IVV GmbH & Co. KG

> Dipl.-Ing. Felix Obermaier

> Oppenhoffallee 171

> 52066 Aachen

>

> Telefon: +49 (241) 94691-39<tel:+49%20241%209469139>

> Telefax: +49 (241) 531622<tel:+49%20241%20531622>

> eMail: obe at ivv-aachen.de<mailto:obe at ivv-aachen.de<mailto:obe at ivv-aachen.de%3cmailto:obe at ivv-aachen.de>>

> Internet: http://www.ivv-aachen.de

>

> Sitz der Gesellschaft: Aachen

> Amtsgericht Aachen HRA 6212

> Geschäftsführer:

> Dipl.-Ing. Wolfgang Hölsken

> Dr.-Ing. Stephan Krug

> Dr.-Ing. Dirk Serwill

> IVV-Management GmbH

> Amtsgericht Aachen HRB 12453

>

>

> _______________________________________________

> gdal-dev mailing list

> gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org%3cmailto:gdal-dev at lists.osgeo.org>>

> https://lists.osgeo.org/mailman/listinfo/gdal-dev

>

>

>

> --

> ----------------------------------------------------------------------------

> ------------------------------------

Peter J Halls, Post-war Reconstruction

> and Development Unit (PRDU), University of York

>

> Snail mail: c/o Research Centre for the Social Sciences (RCSS),

> University of York,

> Heslington, York YO10 5DD

>

> This message has the status of a private and personal communication

> ----------------------------------------------------------------------------

> ------------------------------------





--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170307/d9e73321/attachment-0001.html>

From even.rouault at spatialys.com  Tue Mar  7 02:26:55 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 07 Mar 2017 11:26:55 +0100
Subject: [gdal-dev] WFS driver and GML application schema
In-Reply-To: <e6502b209b754ea2b1a57aee8dffc67f@C119S212VM022.msvyvi.vaha.local>
References: <e6502b209b754ea2b1a57aee8dffc67f@C119S212VM022.msvyvi.vaha.local>
Message-ID: <2588229.vMGEzzfThH@even-i700>

On mardi 7 mars 2017 09:57:26 CET Rahkonen Jukka (MML) wrote:
> Hi,
> 
> What if a WFS server is returning GML that has complex schema, does GDAL
> know to open the response as GML application schema data automatically or
> with some open option?  I  ask because I can see "succeeds as GML" in the
> debug log:

The WFS driver only uses internally the classic GML driver that supports (mostly) simple 
schemas. When parsing a GetFeature response the GML driver analyzes the schemaLocation 
attribute of the top element and tries to download the schema pointed by it and analyze it 
(actually when it is triggered by the WFS driver which has already downloaded the schema, 
the WFS driver already creates the .xsd in-memory file, so the GML driver doesn't need to 
download it. Implementation detail...) But this analysis only succeeds if the schema is simple, 
so hee it fails hence the generating .gfs file message.

I've no thought deeply how the WFS driver could use the GMLAS driver, but that would be a 
fair amount of work. So currently your best option when the WFS server is serving complex 
features is to download the GetFeature response and use it explicitely with the GMLAS 
driver.

Even

> 
> HTTP:
> Fetch(https://opaskartta.turku.fi/TeklaOGCWeb/WFS.ashx?SERVICE=WFS&VERSION=
> 1.0.0&REQUEST=DescribeFeatureType&typeName=akaava:Kaavayksikko) GML:
> Generating /vsimem/tempwfs_00000000034A8DC0/file.gfs file, ignoring
> /vsimem/tmp_gml_xsd_0000000003B73E80.xsd GDAL:
> GDALOpen(/vsimem/tempwfs_00000000034A8DC0/file.gml, this=0000000003B73E80)
> succeeds as GML.
> 
> 
> -Jukka Rahkonen-


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170307/17e099a4/attachment.html>

From landa.martin at gmail.com  Tue Mar  7 04:10:32 2017
From: landa.martin at gmail.com (Martin Landa)
Date: Tue, 7 Mar 2017 13:10:32 +0100
Subject: [gdal-dev] sqlite -> spatialite (rowid)
Message-ID: <CA+Ei1Oe5exMz8R+DnyxfdSo8=AHij9PsWygrcv2w_8mTt+VZ-g@mail.gmail.com>

Hi,

recently I discovered strange behaviour when converting SQLite
database to Spatialite:

ogr2ogr -f SQLite -dsco SPATIALITE=YES Export_vse.sdb Export_vse.db
...
CreateSpatialIndex() error: a physical column named ROWID shadows the real ROWID

The output table contains rowid column even input table doesn't not
contain such column. It seems that this column is created by GDAL when
converting data into Spatialite DB, is it possible?

Thanks, Martin

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.cz/mentors/landa

From even.rouault at spatialys.com  Tue Mar  7 04:41:48 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 07 Mar 2017 13:41:48 +0100
Subject: [gdal-dev] sqlite -> spatialite (rowid)
In-Reply-To: <CA+Ei1Oe5exMz8R+DnyxfdSo8=AHij9PsWygrcv2w_8mTt+VZ-g@mail.gmail.com>
References: <CA+Ei1Oe5exMz8R+DnyxfdSo8=AHij9PsWygrcv2w_8mTt+VZ-g@mail.gmail.com>
Message-ID: <5038708.gQm3suP4e3@even-i700>

Martin,

This error is emitted by spatialite.

See
https://www.gaia-gis.it/fossil/libspatialite/wiki?name=Shadowed+ROWID+issues

Did you check that the FID column name of your input table wasn't rowid ?

I could reproduce by forging first such a DB

$ ogrinfo test.db -al -so
INFO: Open of `test.db'
      using driver `SQLite' successful.

Layer name: test
Geometry: Unknown (any)
Feature Count: 1
Layer SRS WKT:
(unknown)
FID Column = rowid  <-- see
Geometry Column = GEOMETRY

Then:

$ ogr2ogr test2.db test.db -dsco spatialite=yes -f sqlite
CreateSpatialIndex() error: a physical column named ROWID shadows the real ROWID

Workaround :

$ ogr2ogr test2.db test.db -dsco spatialite=yes -f sqlite -lco fid=my_rowid

I think that Spatialite's validateRowid() fuction should be patched to check if the rowid 
column is not of type INTEGER PRIMARY KEY, if so that's acceptable, instead of just checking 
for rowid. CC'ing Sandro.

Even


On mardi 7 mars 2017 13:10:32 CET Martin Landa wrote:
> Hi,
> 
> recently I discovered strange behaviour when converting SQLite
> database to Spatialite:
> 
> ogr2ogr -f SQLite -dsco SPATIALITE=YES Export_vse.sdb Export_vse.db
> ...
> CreateSpatialIndex() error: a physical column named ROWID shadows the real
> ROWID
> 
> The output table contains rowid column even input table doesn't not
> contain such column. It seems that this column is created by GDAL when
> converting data into Spatialite DB, is it possible?
> 
> Thanks, Martin


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170307/37d17521/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Tue Mar  7 06:21:55 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Tue, 7 Mar 2017 07:21:55 -0700 (MST)
Subject: [gdal-dev] sqlite -> spatialite (rowid)
In-Reply-To: <5038708.gQm3suP4e3@even-i700>
References: <CA+Ei1Oe5exMz8R+DnyxfdSo8=AHij9PsWygrcv2w_8mTt+VZ-g@mail.gmail.com>
 <5038708.gQm3suP4e3@even-i700>
Message-ID: <1488896515563-5311212.post@n6.nabble.com>

Even Rouault-2 wrote
> I think that Spatialite's validateRowid() fuction should be patched to
> check if the rowid 
> column is not of type INTEGER PRIMARY KEY, if so that's acceptable,
> instead of just checking 
> for rowid. CC'ing Sandro.

Let's see what Sandro says but I do not believe it is acceptable. The r-tree
spatial index is returning rowids to be used as keys to real data and if the
main table has an ordinary attribute named as ROWID you can guess what will
happen. System works fine if you do not utilize spatial index. If you use it
you use you will get crazy results. I remember I had quite a headache
because of that some years ago
https://groups.google.com/forum/#!searchin/spatialite-users/rowid%7Csort:relevance/spatialite-users/QwRdCiWoVKw/sXqCNZ5wn34J.

-Jukka Rahkonen-



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-sqlite-spatialite-rowid-tp5311181p5311212.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Tue Mar  7 06:45:21 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 07 Mar 2017 15:45:21 +0100
Subject: [gdal-dev] sqlite -> spatialite (rowid)
In-Reply-To: <1488896515563-5311212.post@n6.nabble.com>
References: <CA+Ei1Oe5exMz8R+DnyxfdSo8=AHij9PsWygrcv2w_8mTt+VZ-g@mail.gmail.com>
 <5038708.gQm3suP4e3@even-i700> <1488896515563-5311212.post@n6.nabble.com>
Message-ID: <1836920.AQ3BaHrfzs@even-i700>

On mardi 7 mars 2017 07:21:55 CET jratike80 wrote:
> Even Rouault-2 wrote
> 
> > I think that Spatialite's validateRowid() fuction should be patched to
> > check if the rowid
> > column is not of type INTEGER PRIMARY KEY, if so that's acceptable,
> > instead of just checking
> > for rowid. CC'ing Sandro.
> 
> Let's see what Sandro says but I do not believe it is acceptable. The r-tree
> spatial index is returning rowids to be used as keys to real data and if
> the main table has an ordinary attribute named as ROWID

I agree. But my point is about an explicit column called ROWID and of type INTEGER 
PRIMARY KEY. In the case, I think it's OK since both the implicit rowid and explicit rowid 
columns happen to match.

I've led a small experiment by patching spatialite to accept creating a spatiali index even if a 
table has a rowid column.

Initial state:

$ ogrinfo test.db -sql "select * from sqlite_master where name = 'test'"
INFO: Open of `test.db'
      using driver `SQLite' successful.

Layer name: SELECT
Geometry: None
Feature Count: 1
Layer SRS WKT:
(unknown)
type: String (0.0)
name: String (0.0)
tbl_name: String (0.0)
rootpage: Integer (0.0)
sql: String (0.0)
OGRFeature(SELECT):0
  type (String) = table
  name (String) = test
  tbl_name (String) = test
  rootpage (Integer) = 5673
  sql (String) = CREATE TABLE 'test' ( rowid INTEGER PRIMARY KEY, "GEOMETRY" GEOMETRY)


$ ogrinfo test.db -al
INFO: Open of `test.db'
      using driver `SQLite' successful.

Layer name: test
Geometry: Unknown (any)
Feature Count: 3
Extent: (1.000000, 2.000000) - (5.000000, 6.000000)
Layer SRS WKT:
(unknown)
FID Column = rowid
Geometry Column = GEOMETRY
OGRFeature(test):1
  POINT (1 2)

OGRFeature(test):3
  POINT (3 4)

OGRFeature(test):5
  POINT (5 6)

==> 3 records of feature id / row id 1, 3 and 5

$ ogrinfo test.db -sql "select * from idx_test_GEOMETRY"
INFO: Open of `test.db'
      using driver `SQLite' successful.

Layer name: SELECT
Geometry: None
Feature Count: 3
Layer SRS WKT:
(unknown)
pkid: Integer (0.0)
xmin: Real (0.0)
xmax: Real (0.0)
ymin: Real (0.0)
ymax: Real (0.0)
OGRFeature(SELECT):0
  pkid (Integer) = 1
  xmin (Real) = 1
  xmax (Real) = 1
  ymin (Real) = 2
  ymax (Real) = 2

OGRFeature(SELECT):1
  pkid (Integer) = 3
  xmin (Real) = 3
  xmax (Real) = 3
  ymin (Real) = 4
  ymax (Real) = 4

OGRFeature(SELECT):2
  pkid (Integer) = 5
  xmin (Real) = 5
  xmax (Real) = 5
  ymin (Real) = 6
  ymax (Real) = 6

Now I delete feature with rowid=3:

$ ogrinfo test.db -sql "delete from test where rowid = 3"
INFO: Open of `test.db'
      using driver `SQLite' successful.


Let's the state:

$ ogrinfo test.db -al
INFO: Open of `test.db'
      using driver `SQLite' successful.

Layer name: test
Geometry: Unknown (any)
Feature Count: 2
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170307/54106c64/attachment-0001.html>

From even.rouault at spatialys.com  Tue Mar  7 06:50:47 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 07 Mar 2017 15:50:47 +0100
Subject: [gdal-dev] sqlite -> spatialite (rowid)
In-Reply-To: <1836920.AQ3BaHrfzs@even-i700>
References: <CA+Ei1Oe5exMz8R+DnyxfdSo8=AHij9PsWygrcv2w_8mTt+VZ-g@mail.gmail.com>
 <1488896515563-5311212.post@n6.nabble.com> <1836920.AQ3BaHrfzs@even-i700>
Message-ID: <1756886.0irTWNGVME@even-i700>

Arg, it seems my email has been truncated in text version. Retrying...

> Now I delete feature with rowid=3:
>

Let's see the state:

$ ogrinfo test.db -al
INFO: Open of `test.db'
      using driver `SQLite' successful.

Layer name: test
Geometry: Unknown (any)
Feature Count: 2
Extent: (1.000000, 2.000000) - (5.000000, 6.000000)
Layer SRS WKT:
(unknown)
FID Column = rowid
Geometry Column = GEOMETRY
OGRFeature(test):1
  POINT (1 2)

OGRFeature(test):5
  POINT (5 6)

 $ ogrinfo test.db -sql "select * from idx_test_GEOMETRY"
INFO: Open of `test.db'
      using driver `SQLite' successful.

Layer name: SELECT
Geometry: None
Feature Count: 2
Layer SRS WKT:
(unknown)
pkid: Integer (0.0)
xmin: Real (0.0)
xmax: Real (0.0)
ymin: Real (0.0)
ymax: Real (0.0)
OGRFeature(SELECT):0
  pkid (Integer) = 1
  xmin (Real) = 1
  xmax (Real) = 1
  ymin (Real) = 2
  ymax (Real) = 2

OGRFeature(SELECT):1
  pkid (Integer) = 5
  xmin (Real) = 5
  xmax (Real) = 5
  ymin (Real) = 6
  ymax (Real) = 6


-> The spatial index has been properly maintained: the entry corresponding to the deleted 
feature has been deleted as well.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170307/aa1db6a3/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Tue Mar  7 07:07:04 2017
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Tue, 7 Mar 2017 15:07:04 +0000
Subject: [gdal-dev] sqlite -> spatialite (rowid)
Message-ID: <350eb568a9e74ba5a5307ee968498acf@C119S212VM022.msvyvi.vaha.local>

Hi,

I have a slight feeling that there may be some trouble if attribute "ROWID" is INTEGER PRIMARY KEY but it does not AUTOINCREMENT and users do lot of deletes and inserts. Maybe not if the triggers in r-tree tables are clever enough. Just a slight feeling but perhaps you should test also cases where ROWID differs from OID and _ROWID_?

-Jukka-

Lähettäjä: Even Rouault [mailto:even.rouault at spatialys.com]
Lähetetty: 7. maaliskuuta 2017 16:51
Vastaanottaja: gdal-dev at lists.osgeo.org
Kopio: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>; a.furieri at lqt.it
Aihe: Re: [gdal-dev] sqlite -> spatialite (rowid)


Arg, it seems my email has been truncated in text version. Retrying...



> Now I delete feature with rowid=3:

>



Let's see the state:



$ ogrinfo test.db -al

INFO: Open of `test.db'

using driver `SQLite' successful.



Layer name: test

Geometry: Unknown (any)

Feature Count: 2

Extent: (1.000000, 2.000000) - (5.000000, 6.000000)

Layer SRS WKT:

(unknown)

FID Column = rowid

Geometry Column = GEOMETRY

OGRFeature(test):1

POINT (1 2)



OGRFeature(test):5

POINT (5 6)



$ ogrinfo test.db -sql "select * from idx_test_GEOMETRY"

INFO: Open of `test.db'

using driver `SQLite' successful.



Layer name: SELECT

Geometry: None

Feature Count: 2

Layer SRS WKT:

(unknown)

pkid: Integer (0.0)

xmin: Real (0.0)

xmax: Real (0.0)

ymin: Real (0.0)

ymax: Real (0.0)

OGRFeature(SELECT):0

pkid (Integer) = 1

xmin (Real) = 1

xmax (Real) = 1

ymin (Real) = 2

ymax (Real) = 2



OGRFeature(SELECT):1

pkid (Integer) = 5

xmin (Real) = 5

xmax (Real) = 5

ymin (Real) = 6

ymax (Real) = 6





-> The spatial index has been properly maintained: the entry corresponding to the deleted feature has been deleted as well.



Even



--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170307/dc47dd78/attachment-0001.html>

From landa.martin at gmail.com  Tue Mar  7 07:10:58 2017
From: landa.martin at gmail.com (Martin Landa)
Date: Tue, 7 Mar 2017 16:10:58 +0100
Subject: [gdal-dev] sqlite -> spatialite (rowid)
In-Reply-To: <5038708.gQm3suP4e3@even-i700>
References: <CA+Ei1Oe5exMz8R+DnyxfdSo8=AHij9PsWygrcv2w_8mTt+VZ-g@mail.gmail.com>
 <5038708.gQm3suP4e3@even-i700>
Message-ID: <CA+Ei1OcW9fJpouYA_ojruuBASBC9=wJd9Sp4Q=RWChvx7CzRYw@mail.gmail.com>

Hi Even,

2017-03-07 13:41 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:

[...]

> FID Column = rowid <-- see

right, this exactly my case.

> Workaround :
> $ ogr2ogr test2.db test.db -dsco spatialite=yes -f sqlite -lco fid=my_rowid

Thanks, it works. Ma

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.cz/mentors/landa

From a.furieri at lqt.it  Tue Mar  7 07:32:48 2017
From: a.furieri at lqt.it (a.furieri at lqt.it)
Date: Tue, 07 Mar 2017 16:32:48 +0100
Subject: [gdal-dev] sqlite -> spatialite (rowid)
In-Reply-To: <1488896515563-5311212.post@n6.nabble.com>
References: <CA+Ei1Oe5exMz8R+DnyxfdSo8=AHij9PsWygrcv2w_8mTt+VZ-g@mail.gmail.com>
 <5038708.gQm3suP4e3@even-i700> <1488896515563-5311212.post@n6.nabble.com>
Message-ID: <dec72e92ffcfc89888a2513c5b17ca14@lqt.it>

On Tue, 7 Mar 2017 07:21:55 -0700 (MST), jratike80 wrote:
> Let's see what Sandro says but I do not believe it is acceptable. The 
> r-tree
> spatial index is returning rowids to be used as keys to real data and 
> if the
> main table has an ordinary attribute named as ROWID you can guess 
> what will
> happen. System works fine if you do not utilize spatial index. If you 
> use it
> you use you will get crazy results. I remember I had quite a headache
> because of that some years ago
> 
> https://groups.google.com/forum/#!searchin/spatialite-users/rowid%7Csort:relevance/spatialite-users/QwRdCiWoVKw/sXqCNZ5wn34J.
>

Hi Jukka,

the SpatiaLite's spatial index is fully based on SQLite's
R*Tree; and an R*Tree isn't at all "an index", it simply
is a distinct VirtualTable.
SQLite's itself has absolutely no idea about the strict
relationship joining the Spatial Index and the indexed
table; and symmetrically SpatiaLite itself is completely
unaware of the actions performed by SQLite.

so we must walk on a very narrow and slippery path in
order to keep properly aligned both the SpatialIndex
and the indexed table:

1. all INSERT, UPDATE and DELETE operations on behalf
    of the indexed table _MUST_ be intercepted by
    appropriate Triggers so to properly synchronize
    the companion R*Tree table.

2. corresponding rows on both tables _MUST_
    declare a common key value allowing to perform
    relational JOINs in the safest way.

the R*Tree exclusively supports an INTEGER (64 bit)
key value uniquely identifying each row.

this fits very well with indexed tables explicitly
declaring a Primary Key of the INTEGER data-type,
but we must carefully consider that several different
alternatives could legitimately exist:

a. the indexed table could completely lack any PK
b. it could eventually declare a PK based on
    a single column of some data-type different from
    INTEGER (e.g. TEXT).
c. and finally it could possibly declare a
    multi-column PK.

none of the above three cases can ever match the
INTEGER value declared by the R*Tree row.
happily enough, SQLite supports a special INTEGER
key  uniquely identifying each single row: ROWID
- as the most general rule, any row has its
   own ROWID corresponding to the positional
   index of that row within its table.
- an exception exists: if the table declares s
   single-column PK and the column is declared
   to be of the INTEGER data-type then the ROWID
   simply is an alias name containing exactly
   the same value stored into the PK column.

short conclusion: using ROWIDs as the common
relational key joining both the R*Tree and
the indexed table is the unique solution
applicable to any table independently by
the exact nature of its Primary Key; and
it works well even in the absence of any PK.

this design choice poses a very strict constraint:
no ordinary column named ROWID should be present
into the indexed table, otherwise a big chaotic
mess will devastate the Spatial Index.
it could be sometimes an unpleasant restriction,
but it is usually well acceptable in the vast
majority of cases.

bye Sandro

From a.furieri at lqt.it  Tue Mar  7 07:42:29 2017
From: a.furieri at lqt.it (a.furieri at lqt.it)
Date: Tue, 07 Mar 2017 16:42:29 +0100
Subject: [gdal-dev] sqlite -> spatialite (rowid)
In-Reply-To: <5038708.gQm3suP4e3@even-i700>
References: <CA+Ei1Oe5exMz8R+DnyxfdSo8=AHij9PsWygrcv2w_8mTt+VZ-g@mail.gmail.com>
 <5038708.gQm3suP4e3@even-i700>
Message-ID: <94325457f1db246ec4aac1d30147a5fa@lqt.it>

On Tue, 07 Mar 2017 13:41:48 +0100, Even Rouault wrote:
> I think that Spatialite's validateRowid() fuction should be patched 
> to check if
> the rowid column is not of type INTEGER PRIMARY KEY, if so that's 
> acceptable,
> instead of just checking for rowid.
>

Hi Even,

very good point.

SQLite already considers ROWID as an alias name for the
Primary Key column, if the PK is based on a single
column of the INTEGER data-type.

so "ROWID INTEGER PRIMARY KEY" is a perfectly acceptable
condition, and don't poses any risk to the Spatial Index.

thanks for your useful hint; I'll patch ASAP the code
so to distinguish this peculiar case.

bye Sandro


From a.furieri at lqt.it  Tue Mar  7 08:01:42 2017
From: a.furieri at lqt.it (a.furieri at lqt.it)
Date: Tue, 07 Mar 2017 17:01:42 +0100
Subject: [gdal-dev] sqlite -> spatialite (rowid)
In-Reply-To: <350eb568a9e74ba5a5307ee968498acf@C119S212VM022.msvyvi.vaha.local>
References: <350eb568a9e74ba5a5307ee968498acf@C119S212VM022.msvyvi.vaha.local>
Message-ID: <a42f5d7296924cdd7fd4cdd8475dcb9a@lqt.it>

On Tue, 7 Mar 2017 15:07:04 +0000, Rahkonen Jukka (MML) wrote:
> Hi,
>
> I have a slight feeling that there may be some trouble if attribute
> "ROWID" is INTEGER PRIMARY KEY but it does not AUTOINCREMENT and 
> users
> do lot of deletes and inserts. Maybe not if the triggers in r-tree
> tables are clever enough. Just a slight feeling but perhaps you 
> should
> test also cases where ROWID differs from OID and __ROWID__?
>

Hi Jukka,

we can safely exclude any possible dangerous side-effect.

in SQLite any INTEGER PRIMARY KEY definition will always
ensure that an appropriate value will be automatically
set if not explicitly provided.

what exactly does the AUTOINCREMENT keyword is just
slightly changing the mechanism adopted to automatically
assign PK values.

1. not declaring AUTOINCREMENT
    SQLite will search for the biggest PK value, and
    will adopt this value increased by 1 as the new
    PK value.
    if the max possible value for an INTEGER 64bit
    has already been used (an highly unrealistic
    condition) then SQLite will search if there
    is some free "hole" in the PK sequence, and
    will reuse the first unused value it can find
    note: in this exceptional case it's not
    exactly true that ROWIDs will be generated
    in a regularly ascending order; sometimes
    lower values could be possibly returned.

2. declaring AUTOINCREMENT
    in this case the automatically generated PK
    values can never return back; they can simply
    growth until the maximum value supported
    by an INTEGER 64bit is reached.
    and at this point the auto-sequence will
    definitely stop working.

bye Sandro



From Ahmed.Tolba at schiebel.net  Tue Mar  7 08:11:30 2017
From: Ahmed.Tolba at schiebel.net (Ahmed Tolba)
Date: Tue, 7 Mar 2017 16:11:30 +0000
Subject: [gdal-dev] Threading and Queue
Message-ID: <5155f44c5d8c4ef59458a8402efa8c7b@SRV046.seg.local>

Dear Users,

Is the OGRCreateFeature, threaded ?   Does it uses internal Queues ?  Does OGR use threading and internal queues in General ?

Sincerely,
Ahmed

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170307/a026a26a/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Tue Mar  7 10:52:03 2017
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Tue, 7 Mar 2017 18:52:03 +0000
Subject: [gdal-dev] sqlite -> spatialite (rowid)
In-Reply-To: <a42f5d7296924cdd7fd4cdd8475dcb9a@lqt.it>
References: <350eb568a9e74ba5a5307ee968498acf@C119S212VM022.msvyvi.vaha.local>,
 <a42f5d7296924cdd7fd4cdd8475dcb9a@lqt.it>
Message-ID: <1488912719076.711@maanmittauslaitos.fi>

Hi Sandro,

I have only one detail to add: the MAX+1 policy that is used when AUTOINCREMENT is not declared can lead to re-use of previously used ROWIDs long before reaching the max possible value for an INTEGER 64bit. User just needs to delete the record with the highest ROWID. I trust that triggers in SpatiaLite behave right but I just want to emphasize for other readers that re-using ROWIDs is not really "an highly unrealistic condition" and it must be considered if ROWID is used as a foreign key.  Re-use happens always and inevidently for example if table is truncated. Test with this SQL and table foo2 will have ROWID=1 (calculated as 0+1=1) while table foo3 has  ROWID=2 because that value is taken from a sequence by autoincrement.

create table foo2 (id INTEGER PRIMARY KEY,bar INTEGER);
create table foo3 (id INTEGER PRIMARY KEY AUTOINCREMENT,bar INTEGER);
insert into foo2 (bar) values (1);
insert into foo3 (bar) values (1);
delete from foo2;
delete from foo3;
insert into foo2 (bar) values (2);
insert into foo3 (bar) values (2);



-Jukka-


________________________________________
Lähettäjä: a.furieri at lqt.it <a.furieri at lqt.it>
Lähetetty: 7. maaliskuuta 2017 18:01
Vastaanottaja: Rahkonen Jukka (MML)
Kopio: Even Rouault; gdal-dev at lists.osgeo.org
Aihe: Re: [gdal-dev] sqlite -> spatialite (rowid)

On Tue, 7 Mar 2017 15:07:04 +0000, Rahkonen Jukka (MML) wrote:
> Hi,
>
> I have a slight feeling that there may be some trouble if attribute
> "ROWID" is INTEGER PRIMARY KEY but it does not AUTOINCREMENT and
> users
> do lot of deletes and inserts. Maybe not if the triggers in r-tree
> tables are clever enough. Just a slight feeling but perhaps you
> should
> test also cases where ROWID differs from OID and __ROWID__?
>

Hi Jukka,

we can safely exclude any possible dangerous side-effect.

in SQLite any INTEGER PRIMARY KEY definition will always
ensure that an appropriate value will be automatically
set if not explicitly provided.

what exactly does the AUTOINCREMENT keyword is just
slightly changing the mechanism adopted to automatically
assign PK values.

1. not declaring AUTOINCREMENT
    SQLite will search for the biggest PK value, and
    will adopt this value increased by 1 as the new
    PK value.
    if the max possible value for an INTEGER 64bit
    has already been used (an highly unrealistic
    condition) then SQLite will search if there
    is some free "hole" in the PK sequence, and
    will reuse the first unused value it can find
    note: in this exceptional case it's not
    exactly true that ROWIDs will be generated
    in a regularly ascending order; sometimes
    lower values could be possibly returned.

2. declaring AUTOINCREMENT
    in this case the automatically generated PK
    values can never return back; they can simply
    growth until the maximum value supported
    by an INTEGER 64bit is reached.
    and at this point the auto-sequence will
    definitely stop working.

bye Sandro



From even.rouault at spatialys.com  Tue Mar  7 11:41:26 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 07 Mar 2017 20:41:26 +0100
Subject: [gdal-dev] sqlite -> spatialite (rowid)
In-Reply-To: <1488912719076.711@maanmittauslaitos.fi>
References: <350eb568a9e74ba5a5307ee968498acf@C119S212VM022.msvyvi.vaha.local>
 <a42f5d7296924cdd7fd4cdd8475dcb9a@lqt.it>
 <1488912719076.711@maanmittauslaitos.fi>
Message-ID: <2829593.x3ky6Lb5jD@even-i700>

I see that in the SQLite/Spatialite driver the primary key column is created just as INTEGER 
PRIMARY KEY, whereas in GeoPackage the standard requires that is INTEGER PRIMARY KEY 
AUTOINCREMENT.

The SQLite doc mentions that AUTOINCREMENT is "a little slower" due to maintaining the 
sequence, but not sure if that's dramatic.

https://www.sqlite.org/autoinc.html

So wondering if that makes sense in the SQLite driver to switch to AUTOINCREMENT and/or 
make that an option.

> 
> I have only one detail to add: the MAX+1 policy that is used when
> AUTOINCREMENT is not declared can lead to re-use of previously used ROWIDs
> long before reaching the max possible value for an INTEGER 64bit. User just
> needs to delete the record with the highest ROWID. I trust that triggers in
> SpatiaLite behave right but I just want to emphasize for other readers that
> re-using ROWIDs is not really "an highly unrealistic condition" and it must
> be considered if ROWID is used as a foreign key.  Re-use happens always and
> inevidently for example if table is truncated. Test with this SQL and table
> foo2 will have ROWID=1 (calculated as 0+1=1) while table foo3 has  ROWID=2
> because that value is taken from a sequence by autoincrement.
> 
> create table foo2 (id INTEGER PRIMARY KEY,bar INTEGER);
> create table foo3 (id INTEGER PRIMARY KEY AUTOINCREMENT,bar INTEGER);
> insert into foo2 (bar) values (1);
> insert into foo3 (bar) values (1);
> delete from foo2;
> delete from foo3;
> insert into foo2 (bar) values (2);
> insert into foo3 (bar) values (2);
> 
> 
> 
> -Jukka-
> 
> 
> ________________________________________
> Lähettäjä: a.furieri at lqt.it <a.furieri at lqt.it>
> Lähetetty: 7. maaliskuuta 2017 18:01
> Vastaanottaja: Rahkonen Jukka (MML)
> Kopio: Even Rouault; gdal-dev at lists.osgeo.org
> Aihe: Re: [gdal-dev] sqlite -> spatialite (rowid)
> 
> On Tue, 7 Mar 2017 15:07:04 +0000, Rahkonen Jukka (MML) wrote:
> > Hi,
> > 
> > I have a slight feeling that there may be some trouble if attribute
> > "ROWID" is INTEGER PRIMARY KEY but it does not AUTOINCREMENT and
> > users
> > do lot of deletes and inserts. Maybe not if the triggers in r-tree
> > tables are clever enough. Just a slight feeling but perhaps you
> > should
> > test also cases where ROWID differs from OID and __ROWID__?
> 
> Hi Jukka,
> 
> we can safely exclude any possible dangerous side-effect.
> 
> in SQLite any INTEGER PRIMARY KEY definition will always
> ensure that an appropriate value will be automatically
> set if not explicitly provided.
> 
> what exactly does the AUTOINCREMENT keyword is just
> slightly changing the mechanism adopted to automatically
> assign PK values.
> 
> 1. not declaring AUTOINCREMENT
>     SQLite will search for the biggest PK value, and
>     will adopt this value increased by 1 as the new
>     PK value.
>     if the max possible value for an INTEGER 64bit
>     has already been used (an highly unrealistic
>     condition) then SQLite will search if there
>     is some free "hole" in the PK sequence, and
>     will reuse the first unused value it can find
>     note: in this exceptional case it's not
>     exactly true that ROWIDs will be generated
>     in a regularly ascending order; sometimes
>     lower values could be possibly returned.
> 
> 2. declaring AUTOINCREMENT
>     in this case the automatically generated PK
>     values can never return back; they can simply
>     growth until the maximum value supported
>     by an INTEGER 64bit is reached.
>     and at this point the auto-sequence will
>     definitely stop working.
> 
> bye Sandro


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170307/7e8372ea/attachment-0001.html>

From matt.gregory at oregonstate.edu  Tue Mar  7 12:18:31 2017
From: matt.gregory at oregonstate.edu (Gregory, Matthew)
Date: Tue, 7 Mar 2017 20:18:31 +0000
Subject: [gdal-dev] OGRGeometry::IsEmpty missing from trunk build
Message-ID: <7C48E40C135D314BA03D6471A6E38978F217416D@EX1.oregonstate.edu>

Hi all,

I was updating to the latest (python) Fiona version (1.7.4) and building GDAL trunk to supply as the gdal201.dll it requires.  I'm on Windows 7 64-bit, compiling GDAL with VC9 as 32-bit DLL.  

When I build a recent commit of GDAL (Github 04105a9), I don't get a symbol for  'int OGRGeometry::IsEmpty(void)'.  If I instead use the 2.1 branch head (Github 4902d8c), that symbol is present and Fiona works correctly.   

I see some references in comments to changes in OGRGeometry at 2.1, but am not knowledgeable enough to know if it's expected that OGRGeometry::IsEmpty should be missing.

Sorry for what's probably a naïve question.

thanks, matt

From even.rouault at spatialys.com  Tue Mar  7 12:31:00 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 07 Mar 2017 21:31:00 +0100
Subject: [gdal-dev] OGRGeometry::IsEmpty missing from trunk build
In-Reply-To: <7C48E40C135D314BA03D6471A6E38978F217416D@EX1.oregonstate.edu>
References: <7C48E40C135D314BA03D6471A6E38978F217416D@EX1.oregonstate.edu>
Message-ID: <3241416.L3tl6BCoyJ@even-i700>

On mardi 7 mars 2017 20:18:31 CET Gregory, Matthew wrote:
> Hi all,
> 
> I was updating to the latest (python) Fiona version (1.7.4) and building
> GDAL trunk to supply as the gdal201.dll it requires.  I'm on Windows 7
> 64-bit, compiling GDAL with VC9 as 32-bit DLL.
> 
> When I build a recent commit of GDAL (Github 04105a9), I don't get a symbol
> for  'int OGRGeometry::IsEmpty(void)'.  If I instead use the 2.1 branch
> head (Github 4902d8c), that symbol is present and Fiona works correctly.
> 
> I see some references in comments to changes in OGRGeometry at 2.1, but am
> not knowledgeable enough to know if it's expected that OGRGeometry::IsEmpty
> should be missing.

OGRGeometry::IsEmpty() is now a pure virtual method in trunk, but that shouldn't be a 
problem. GDAL trunk builds fine on Windows with VC9 for me and on AppVeyor.

Are you sure you build Fiona against the GDAL trunk header and lib ?

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170307/8f70140f/attachment.html>

From a.furieri at lqt.it  Tue Mar  7 13:18:33 2017
From: a.furieri at lqt.it (a.furieri at lqt.it)
Date: Tue, 07 Mar 2017 22:18:33 +0100
Subject: [gdal-dev] sqlite -> spatialite (rowid)
In-Reply-To: <2829593.x3ky6Lb5jD@even-i700>
References: <350eb568a9e74ba5a5307ee968498acf@C119S212VM022.msvyvi.vaha.local>
 <a42f5d7296924cdd7fd4cdd8475dcb9a@lqt.it>
 <1488912719076.711@maanmittauslaitos.fi> <2829593.x3ky6Lb5jD@even-i700>
Message-ID: <ee51e60b3dff2ae1ab3452d0fd4bfb3f@lqt.it>

On Tue, 07 Mar 2017 20:41:26 +0100, Even Rouault wrote:
> I see that in the SQLite/Spatialite driver the primary key column is
> created just as INTEGER PRIMARY KEY, whereas in GeoPackage the
> standard requires that is INTEGER PRIMARY KEY AUTOINCREMENT.
>


Hi Even,

spatialite_gui and spatialite-tools as well usually declare
INTEGER PRIMARY KEY AUTOINCREMENT (e.g. when importing some
external Shapefile).


> The SQLite doc mentions that AUTOINCREMENT is "a little slower" due 
> to
> maintaining the sequence, but not sure if that's dramatic.
>

from my direct experience on the field: no, isn't dramatic at all.
(at least: under the most usual conditions).


> So wondering if that makes sense in the SQLite driver to switch to
> AUTOINCREMENT and/or make that an option.
>

+1

such a choice will surely contribute to a better and smoother
integration between "vanilla" spatialite and GDAL/OGR, possibly
avoiding to create slight misalignments eventually leading to
puzzling issues very hard to be correctly understood by average
users (that are not usually expected to be high rank pundits
possessing a complete mastership of sqlite).

bye Sandro

From matt.gregory at oregonstate.edu  Tue Mar  7 13:47:51 2017
From: matt.gregory at oregonstate.edu (Gregory, Matthew)
Date: Tue, 7 Mar 2017 21:47:51 +0000
Subject: [gdal-dev] OGRGeometry::IsEmpty missing from trunk build
In-Reply-To: <3241416.L3tl6BCoyJ@even-i700>
References: <7C48E40C135D314BA03D6471A6E38978F217416D@EX1.oregonstate.edu>
 <3241416.L3tl6BCoyJ@even-i700>
Message-ID: <7C48E40C135D314BA03D6471A6E38978F21742BE@EX1.oregonstate.edu>

Even Rouault wrote:
> On mardi 7 mars 2017 20:18:31 CET Gregory, Matthew wrote:
> > Hi all,
> > 
> > I was updating to the latest (python) Fiona version (1.7.4) and building
> > GDAL trunk to supply as the gdal201.dll it requires. I'm on Windows 7
> > 64-bit, compiling GDAL with VC9 as 32-bit DLL.
> > 
> > When I build a recent commit of GDAL (Github 04105a9), I don't get a symbol
> > for 'int OGRGeometry::IsEmpty(void)'. If I instead use the 2.1 branch
> > head (Github 4902d8c), that symbol is present and Fiona works correctly.
> > 
> > I see some references in comments to changes in OGRGeometry at 2.1, but am
> > not knowledgeable enough to know if it's expected that OGRGeometry::IsEmpty
> > should be missing.
> 
> OGRGeometry::IsEmpty() is now a pure virtual method in trunk, but
> that shouldn't be a problem. GDAL trunk builds fine on Windows
> with VC9 for me and on AppVeyor.
>  
> Are you sure you build Fiona against the GDAL trunk header and lib ?

Sorry for the noise ... I hadn't actually built Fiona - just had grabbed it from Christoph Gohlke's wheels and tried to use it alongside the trunk DLL.  I just built Fiona from source and built it against GDAL trunk header/lib and, you're right, everything works out fine.

What I didn't understand (and what I failed to mention in my first message) is that I ran 'dumpbin /exports' on the trunk DLL and the OGRGeometry::IsEmpty() symbol wasn't showing up there, which made me think it was missing. But it sounds like pure virtual methods don't generate any code, so no symbol gets generated.  

Again, sorry for the misunderstanding and I appreciate your help,
matt

From even.rouault at spatialys.com  Tue Mar  7 14:48:13 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 07 Mar 2017 23:48:13 +0100
Subject: [gdal-dev] sqlite -> spatialite (rowid)
In-Reply-To: <ee51e60b3dff2ae1ab3452d0fd4bfb3f@lqt.it>
References: <350eb568a9e74ba5a5307ee968498acf@C119S212VM022.msvyvi.vaha.local>
 <2829593.x3ky6Lb5jD@even-i700> <ee51e60b3dff2ae1ab3452d0fd4bfb3f@lqt.it>
Message-ID: <1866062.yt9Ril9A03@even-i700>

> > So wondering if that makes sense in the SQLite driver to 
switch to
> > AUTOINCREMENT

FYI, I've just switched to declaring as AUTOINCREMENT (no 
option)


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170307/e7fd1063/attachment.html>

From mswope at gmail.com  Wed Mar  8 05:09:44 2017
From: mswope at gmail.com (Mike)
Date: Wed, 8 Mar 2017 06:09:44 -0700
Subject: [gdal-dev] ogr2ogr -sql and -nln
Message-ID: <CAKTSvBgF+WRxP81h3fPeKHnnML1fV5sShJqtPOr5zcN8L+V3rA@mail.gmail.com>

I'm getting this
Warning 1: layer names ignored in combination with -sql.

However, I need to use the -sql query as I'm adding fields and populating
them as I go.

The source dataset cannot be edited.

I'm trying to combine several datasets into various tables in PostGIS,
where there's a name difference between the source layer and the PostGIS
table name.

my command is in this format.
ogr2ogr -f PostgreSQL -a_srs "EPSG:4326"  PG:dbname=SomeDB <insert some
options> Sourcedata -nlt POLYGON -skipfailures -explodecollections -sql
"SELECT *,'VALUE1' AS valuefield, 1 as anotherfield FROM <layer> WHERE
OGR_GEOMETRY='POLYGON' OR OGR_GEOMETRY='MULTIPOLYGON'" <layer>

I wish to not put it in a table named <layer> in my PostGIS/SomeDB, but
rather <layer>+somesuffix

This is easy with -nln, but when I added the -sql, I get the warning above,
and it seems to drop it in just <layer> and not <layer>+somesuffix.

How can I accomplish what I want?
This is ultimately run on many datasets, so it will be appending to
existing tables (or create them if they didnt exist yet).

-Mike
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170308/0d3e6631/attachment.html>

From even.rouault at spatialys.com  Wed Mar  8 05:27:00 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 08 Mar 2017 14:27:00 +0100
Subject: [gdal-dev] ogr2ogr -sql and -nln
In-Reply-To: <CAKTSvBgF+WRxP81h3fPeKHnnML1fV5sShJqtPOr5zcN8L+V3rA@mail.gmail.com>
References: <CAKTSvBgF+WRxP81h3fPeKHnnML1fV5sShJqtPOr5zcN8L+V3rA@mail.gmail.com>
Message-ID: <4752528.TCzo2t6vsF@even-i700>

On mercredi 8 mars 2017 06:09:44 CET Mike wrote:
> I'm getting this
> Warning 1: layer names ignored in combination with -sql.
> 
> However, I need to use the -sql query as I'm adding fields and populating
> them as I go.
> 
> The source dataset cannot be edited.
> 
> I'm trying to combine several datasets into various tables in PostGIS,
> where there's a name difference between the source layer and the PostGIS
> table name.
> 
> my command is in this format.
> ogr2ogr -f PostgreSQL -a_srs "EPSG:4326"  PG:dbname=SomeDB <insert some
> options> Sourcedata -nlt POLYGON -skipfailures -explodecollections -sql
> "SELECT *,'VALUE1' AS valuefield, 1 as anotherfield FROM <layer> WHERE
> OGR_GEOMETRY='POLYGON' OR OGR_GEOMETRY='MULTIPOLYGON'" <layer>
> 

The issue is that you are using both -sql " " and layer_name, which are indeed exclusive. Either 
you import from a SQL statement or you import from a source layer_name. If you specify -sql 
"SELECT ... FROM layer_name", you don't need to specify it as a source layer_name.

To do what you want, use -sql "SELECT ... from <layer>" -nln <layer>_suffix
(note the -nln switch)


> I wish to not put it in a table named <layer> in my PostGIS/SomeDB, but
> rather <layer>+somesuffix
> 
> This is easy with -nln, but when I added the -sql, I get the warning above,
> and it seems to drop it in just <layer> and not <layer>+somesuffix.
> 
> How can I accomplish what I want?
> This is ultimately run on many datasets, so it will be appending to
> existing tables (or create them if they didnt exist yet).
> 
> -Mike


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170308/1155ce64/attachment-0001.html>

From ari.jolma at gmail.com  Wed Mar  8 05:37:57 2017
From: ari.jolma at gmail.com (Ari Jolma)
Date: Wed, 8 Mar 2017 15:37:57 +0200
Subject: [gdal-dev] Experiments with multiprocessing
Message-ID: <3fbb7c1b-128c-9d15-cac7-970878f72ebd@gmail.com>

I've tried multiprocessing a bit, here's my log on that.

My test case was computing the min and max of a 35989 x 61978 integer 
raster (Finland in 20 m x 20 m cells). The data is a LZW compressed 
GTiff with 128 x 128 blocks. The file size is ~200 MB.

I used block based access, Perl and PDL (Perl Data Language). Each block 
is read into a PDL object and the min and max of the block is then 
computed by PDL.

I used MCE first. MCE is "Multi-core engine for Perl" (a module 
available at CPAN). It can use threads but since my Perl is not compiled 
to use them (the usual case) it spawns child processes as workers.

The first experiment went fine, the computing time went from 214 secs 
with one worker to 125 secs with 5 workers (I have 4 CPUs). However, 
each worker processed one block at a time (opening the file each time 
anew), which I thought was not optimal because of overhead of spawning 
and opening. Then I changed the setup so that I arranged blocks into as 
many batches that I had workers, so each worker would work only once. I 
could not get that setup to work - I got low level errors from PDL.

The second experiment was to take the second setup from the first 
experiment (each worker works only once with a batch of blocks assigned 
to it) and use vanilla fork() from Perl core. Input to the spawned 
children is easy but for output I used files. This time there were no 
errors from PDL or elsewhere and everything worked fine. The computing 
time went from 62 secs with one worker to 36 secs with 4 workers.

It seems that using plain fork is quite easy and useful. I'd expect that 
similar results can be obtained with Python and its equivalent to fork() 
in Perl. I'm using Linux. Windows is bit different story since at least 
for Perl the fork() in Windows is somehow emulated version of the unix 
fork and that may cause issues.

The MCE module seems to be highly praised but it did not work for me well.

Ari



From aranea at aixah.de  Wed Mar  8 10:38:24 2017
From: aranea at aixah.de (Luis Ressel)
Date: Wed, 8 Mar 2017 19:38:24 +0100
Subject: [gdal-dev] Symlinks to VRTs
Message-ID: <20170308193824.2b21b3b4@gentp.lnet>

Hello,

VRTs can reference other files by relative paths. Upon reading such a
VRT, GDAL will evaluate the relative path based on the directory where
the VRT resides. Now, imagine the following situation:

* There's a directory a/ containing several raster files and a VRT
  referencing them.

* There's a second directory b/ containing a symlink to the VRT in a/ .

When I point GDAL at b/symlink.vrt, it will dereference the symlink
before evaluating the relative paths inside the VRT (and thus search
for the rasters in a/), whereas I would've expected GDAL to handle
the symlink transparently and search for the rasters in b/ .

Is this the intended behaviour? Unfortunately, I can't make much
sense of the relevant code in gdal/frmts/vrt/vrtsources.cpp.

Regards,
Luis Ressel
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 833 bytes
Desc: OpenPGP digital signature
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170308/cc685c90/attachment.sig>

From even.rouault at spatialys.com  Wed Mar  8 12:28:34 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 08 Mar 2017 21:28:34 +0100
Subject: [gdal-dev] Symlinks to VRTs
In-Reply-To: <20170308193824.2b21b3b4@gentp.lnet>
References: <20170308193824.2b21b3b4@gentp.lnet>
Message-ID: <1879911.mRjSHVTDHg@even-i700>

On mercredi 8 mars 2017 19:38:24 CET Luis Ressel wrote:
> Hello,
> 
> VRTs can reference other files by relative paths. Upon reading such a
> VRT, GDAL will evaluate the relative path based on the directory where
> the VRT resides. Now, imagine the following situation:
> 
> * There's a directory a/ containing several raster files and a VRT
>   referencing them.
> 
> * There's a second directory b/ containing a symlink to the VRT in a/ .
> 
> When I point GDAL at b/symlink.vrt, it will dereference the symlink
> before evaluating the relative paths inside the VRT (and thus search
> for the rasters in a/), whereas I would've expected GDAL to handle
> the symlink transparently and search for the rasters in b/ .
> 
> Is this the intended behaviour?

Given that the existing behaviour is a reasonable one, I'd say yes. That's said your use can can 
probably also makes sense.


> Unfortunately, I can't make much
> sense of the relevant code in gdal/frmts/vrt/vrtsources.cpp.

The relevant piece of code is in
https://github.com/OSGeo/gdal/blob/trunk/gdal/frmts/vrt/vrtdataset.cpp#L739

If you look a bit below in
https://github.com/OSGeo/gdal/blob/trunk/gdal/frmts/vrt/vrtdataset.cpp#L814
there's an open option ROOT_PATH that could be set to b/ to get the behaviour you wish.

Or you could add an open option, RESOLVE_SYMLINK=NO, to disable the stuff at
https://github.com/OSGeo/gdal/blob/trunk/gdal/frmts/vrt/vrtdataset.cpp#L745

Evn

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170308/1f391496/attachment.html>

From richard.greenwood at gmail.com  Wed Mar  8 12:31:01 2017
From: richard.greenwood at gmail.com (Richard Greenwood)
Date: Wed, 8 Mar 2017 13:31:01 -0700
Subject: [gdal-dev] compiling gdal with esri file gdb
Message-ID: <CAHBySPac9AefGk373ZyKvqzPe0kK3OtUDz57i3eb0GDjaowtjA@mail.gmail.com>

I have an ESRI file gdb with curves that I need to import so I'm trying to
build gdal 2.2 with filegdb. I'm on Ubuntu 16.04 with gcc 5.4. I checked
out the the svn gdal and built it with any problems.

Next I got the ESRI FileGDB_API_1_5_64 and copied the contents of the lib
and include directories from the FileGDB_API/  into /usr/local/lib/ and
/usr/local/include/ and did a ldconfig.
 Then:
   ./configure --with-fgdb=/usr/local/ --prefix=/opt/gdal-dev
   make
and I get numerous like:
   undefined reference to FileGDBAPI::Row
   undefined reference to FileGDBAPI::Guid
   etc.

I had also tried --with-fgdb=/path/to/FileGDB_API but got the same errors
as when the lib and include files were copied to /usr/local/

Obviously I don't know what I'm doing. If anyone could give me any
suggestions I would appreciate it.

Thanks,
Rich

-- 
Richard W. Greenwood, PLS
www.greenwoodmap.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170308/0013bf3c/attachment.html>

From even.rouault at spatialys.com  Wed Mar  8 12:49:03 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 08 Mar 2017 21:49:03 +0100
Subject: [gdal-dev] compiling gdal with esri file gdb
In-Reply-To: <CAHBySPac9AefGk373ZyKvqzPe0kK3OtUDz57i3eb0GDjaowtjA@mail.gmail.com>
References: <CAHBySPac9AefGk373ZyKvqzPe0kK3OtUDz57i3eb0GDjaowtjA@mail.gmail.com>
Message-ID: <1745015.tU1JPdkWe3@even-i700>

On mercredi 8 mars 2017 13:31:01 CET Richard Greenwood wrote:
> I have an ESRI file gdb with curves that I need to import so I'm trying to
> build gdal 2.2 with filegdb. I'm on Ubuntu 16.04 with gcc 5.4. I checked
> out the the svn gdal and built it with any problems.
> 
> Next I got the ESRI FileGDB_API_1_5_64 and copied the contents of the lib
> and include directories from the FileGDB_API/  into /usr/local/lib/ and
> /usr/local/include/ and did a ldconfig.

I would have answered : see

https://trac.osgeo.org/gdal/wiki/FileGDB#HowtodealwithGCC5.1C11ABIonLinux

but I see you mention v1.5, which seems to be new.

I found
https://github.com/Esri/file-geodatabase-api/tree/master/FileGDB_API_1.5

Did you grab the FileGDB_API_1_5_64gcc51.tar.gz  archive which must have been compiled 
with the C++11 ABI, and thus be compatible with GCC 5.4 ?

They mention in their README
"    If you are using gcc 5.x and above you will need to use the FileGDB API version for GCC5 "

OK, I've just tried it myself on my Ubuntu 16.04 and it works. The test suite passes fine.


@Jürgen I see they now have a build for VS2015:
https://github.com/Esri/file-geodatabase-api/blob/master/FileGDB_API_1.5/
FileGDB_API_1_5_VS2015.zip

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170308/108b7653/attachment.html>

From zac at weatherwary.com  Wed Mar  8 12:55:36 2017
From: zac at weatherwary.com (Zachary Flamig)
Date: Wed, 8 Mar 2017 14:55:36 -0600
Subject: [gdal-dev] Geostationary Projection with microradians
Message-ID: <391344F2-C5FA-4DB3-A9C2-3076EB7F2E40@weatherwary.com>

Hi all,

The GOES-16 satellite has started delivering full disk netcdf files that conform to a new portion of the CF standard: https://cf-trac.llnl.gov/trac/ticket/72 <https://cf-trac.llnl.gov/trac/ticket/72>
Unfortunately, they choose to use units of micro-radians instead of meters so it doesn’t appear the files are immediately compatible with GDAL.

It is rather straight forward to convert from the radians to meters given the height of the satellite (which is included in the projection information). Would this be something appropriate for GDAL to convert or is it more of a PROJ4 problem?

I’ve uploaded some example netcdfs here: https://www.dropbox.com/s/ell4iy0hiwzquqy/fulldisk_wv.zip?dl=0 <https://www.dropbox.com/s/ell4iy0hiwzquqy/fulldisk_wv.zip?dl=0>
The data is tiled into 4 separate netcdfs that can be combine for the full disk image.

Cheers,
Zac
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170308/72a52a49/attachment-0001.html>

From even.rouault at spatialys.com  Wed Mar  8 13:05:37 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 08 Mar 2017 22:05:37 +0100
Subject: [gdal-dev] Geostationary Projection with microradians
In-Reply-To: <391344F2-C5FA-4DB3-A9C2-3076EB7F2E40@weatherwary.com>
References: <391344F2-C5FA-4DB3-A9C2-3076EB7F2E40@weatherwary.com>
Message-ID: <17543340.TnpQRNgtFB@even-i700>

On mercredi 8 mars 2017 14:55:36 CET Zachary Flamig wrote:
> Hi all,
> 
> The GOES-16 satellite has started delivering full disk netcdf files that
> conform to a new portion of the CF standard:
> https://cf-trac.llnl.gov/trac/ticket/72
> <https://cf-trac.llnl.gov/trac/ticket/72> Unfortunately, they choose to use
> units of micro-radians instead of meters so it doesn’t appear the files are
> immediately compatible with GDAL.
> 
> It is rather straight forward to convert from the radians to meters given
> the height of the satellite (which is included in the projection
> information). Would this be something appropriate for GDAL to convert or is
> it more of a PROJ4 problem?

I don't pretend to have a very well informed opinion on the GEOS projection, but if you can 
fix that in GDAL and do the conversion from microradians to meters it seems reasonable. 
Projection support in WKT and proj.4 assumes that the units of x, y values are linear (meter, 
feet, etc...), so dealing with angular units would probably be complicated at that level. 
Especially since the conversion from microradians to meters depend on another parameter 
(height of the satellite). So a fix in the netCDF driver would seem OK to me. 

> 
> I’ve uploaded some example netcdfs here:
> https://www.dropbox.com/s/ell4iy0hiwzquqy/fulldisk_wv.zip?dl=0
> <https://www.dropbox.com/s/ell4iy0hiwzquqy/fulldisk_wv.zip?dl=0> The data
> is tiled into 4 separate netcdfs that can be combine for the full disk
> image.
> 
> Cheers,
> Zac


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170308/de82ed68/attachment.html>

From aranea at aixah.de  Wed Mar  8 13:37:42 2017
From: aranea at aixah.de (Luis Ressel)
Date: Wed, 8 Mar 2017 22:37:42 +0100
Subject: [gdal-dev] Symlinks to VRTs
In-Reply-To: <1879911.mRjSHVTDHg@even-i700>
References: <20170308193824.2b21b3b4@gentp.lnet> <1879911.mRjSHVTDHg@even-i700>
Message-ID: <20170308223742.3177852f@gentp.lnet>

On Wed, 08 Mar 2017 21:28:34 +0100
Even Rouault <even.rouault at spatialys.com> wrote:

> The relevant piece of code is in
> https://github.com/OSGeo/gdal/blob/trunk/gdal/frmts/vrt/vrtdataset.cpp#L739
> 
> If you look a bit below in
> https://github.com/OSGeo/gdal/blob/trunk/gdal/frmts/vrt/vrtdataset.cpp#L814
> there's an open option ROOT_PATH that could be set to b/ to get the
> behaviour you wish.

Thanks for the hint! Adjusting the ROOT_PATH is an acceptable solution
in my use case.

Interestingly, GDAL used to handle symlinks to VRTs in the way I'd
expected, but this was changed back in 2013 (commit 66b3918df in the
git repository, committed by you).

Regards,
Luis Ressel
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 833 bytes
Desc: OpenPGP digital signature
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170308/9e02fa34/attachment.sig>

From even.rouault at spatialys.com  Wed Mar  8 13:46:15 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 08 Mar 2017 22:46:15 +0100
Subject: [gdal-dev] Symlinks to VRTs
In-Reply-To: <20170308223742.3177852f@gentp.lnet>
References: <20170308193824.2b21b3b4@gentp.lnet>
 <1879911.mRjSHVTDHg@even-i700> <20170308223742.3177852f@gentp.lnet>
Message-ID: <3488421.AN0CBMalvu@even-i700>

On mercredi 8 mars 2017 22:37:42 CET Luis Ressel wrote:
> On Wed, 08 Mar 2017 21:28:34 +0100
> 
> Even Rouault <even.rouault at spatialys.com> wrote:
> > The relevant piece of code is in
> > https://github.com/OSGeo/gdal/blob/trunk/gdal/frmts/vrt/vrtdataset.cpp#L73
> > 9
> > 
> > If you look a bit below in
> > https://github.com/OSGeo/gdal/blob/trunk/gdal/frmts/vrt/vrtdataset.cpp#L81
> > 4
> > there's an open option ROOT_PATH that could be set to b/ to get the
> > behaviour you wish.
> 
> Thanks for the hint! Adjusting the ROOT_PATH is an acceptable solution
> in my use case.
> 
> Interestingly, GDAL used to handle symlinks to VRTs in the way I'd
> expected, but this was changed back in 2013 (commit 66b3918df in the
> git repository, committed by you).

Looking at the commit message, it appears that this change was contributed by someone 
else from https://trac.osgeo.org/gdal/ticket/4999
But my intuition is that the current behaviour is more natural than the previous one (ie the 
one you'd expect). But obviously different people have different use cases.

> 
> Regards,
> Luis Ressel


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170308/9339c64d/attachment.html>

From lotfi.raca at gmail.com  Wed Mar  8 16:51:33 2017
From: lotfi.raca at gmail.com (lotfi Raghib)
Date: Thu, 9 Mar 2017 00:51:33 +0000
Subject: [gdal-dev] GDAL Bandes To RGB
Message-ID: <CAMKroqy4zvK1-0LTySLwpC=FLrVdsSOMgrvZ1dGr7V0dGFaHEA@mail.gmail.com>

Hello GDAL developpers,
l have a question how can i create a RGB image based on 3 bands GDALDataset,
thanks ALL.

-- 
RAGHIB Lotfi
Etudiant en master Systèmes intelligents et réseaux, Faculté des Sciences
et Techniques Fès
Mail: lotfi.raca at gmail.com
Tel : +212 6 29 80 84 93
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170309/a86b32ff/attachment.html>

From jmckenna at gatewaygeomatics.com  Thu Mar  9 05:23:01 2017
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Thu, 9 Mar 2017 09:23:01 -0400
Subject: [gdal-dev] compiling gdal with esri file gdb
In-Reply-To: <1745015.tU1JPdkWe3@even-i700>
References: <CAHBySPac9AefGk373ZyKvqzPe0kK3OtUDz57i3eb0GDjaowtjA@mail.gmail.com>
 <1745015.tU1JPdkWe3@even-i700>
Message-ID: <a17ce89f-33d0-1938-34a4-0b2357235d5b@gatewaygeomatics.com>

On 2017-03-08 4:49 PM, Even Rouault wrote:

>
>
>
> @Jürgen I see they now have a build for VS2015:
>
> https://github.com/Esri/file-geodatabase-api/blob/master/FileGDB_API_1.5/FileGDB_API_1_5_VS2015.zip
>
>


Wow very new indeed!  I've updated the download links on the wiki 
(https://trac.osgeo.org/gdal/wiki/FileGDB) and I'll make this available 
for the MS4W community.  Good find!

-jeff



-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/







From even.rouault at spatialys.com  Thu Mar  9 15:03:47 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 10 Mar 2017 00:03:47 +0100
Subject: [gdal-dev] compiling gdal with esri file gdb
In-Reply-To: <a17ce89f-33d0-1938-34a4-0b2357235d5b@gatewaygeomatics.com>
References: <CAHBySPac9AefGk373ZyKvqzPe0kK3OtUDz57i3eb0GDjaowtjA@mail.gmail.com>
 <1745015.tU1JPdkWe3@even-i700>
 <a17ce89f-33d0-1938-34a4-0b2357235d5b@gatewaygeomatics.com>
Message-ID: <10885343.Y1xjAuH3TW@even-i700>

On jeudi 9 mars 2017 09:23:01 CET Jeff McKenna wrote:
> On 2017-03-08 4:49 PM, Even Rouault wrote:
> > @Jürgen I see they now have a build for VS2015:
> > 
> > https://github.com/Esri/file-geodatabase-api/blob/master/FileGDB_API_1.5/F
> > ileGDB_API_1_5_VS2015.zip
> Wow very new indeed!  I've updated the download links on the wiki
> (https://trac.osgeo.org/gdal/wiki/FileGDB) and I'll make this available
> for the MS4W community.  Good find!

For those, at least on Linux, and which use GDAL compiled *without* --with-static-proj, you 
may get strange projection related failures at runtime. This is due to libFileGDBAPI.so 
embedding a copy of proj.4 (without symbol hidding or renaming !!!), which conflicts with 
the proj.4 that GDAL will load dlopen(). Typical error emitted is about "unknown ellipsoid".

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170310/c29f4de6/attachment.html>

From hschiebold at codematix.de  Fri Mar 10 04:35:18 2017
From: hschiebold at codematix.de (Holger Schiebold)
Date: Fri, 10 Mar 2017 13:35:18 +0100
Subject: [gdal-dev] OpenFileGDB driver conflicts with GPX and KML driver
Message-ID: <14517d37-5d83-528c-2aff-56977e364c83@codematix.de>

Hi all,

at gdal 1.11.5 i have to disable via OGR_SKIP the GPX and KML driver to 
get FileGDB driver working with my ESRI filegeodatabases. Otherwise i 
get an segfault caused by the GPX or KML driver.  On former 1.9 version 
of gdal this not happens. Is it a bug or special circumstances in my 
environment? Can anybody confirm that behaviour in his environment?


thanks in advance

Holger


mit freundlichen Grüßen

-- 
Holger Schiebold


____________________
codematix GmbH
Felsbachstrasse 5/7
D-07745 Jena
Tel. +49 (3641) 3038-34
www.codematix.de


From robert.coup at koordinates.com  Fri Mar 10 04:57:05 2017
From: robert.coup at koordinates.com (Robert Coup)
Date: Fri, 10 Mar 2017 12:57:05 +0000
Subject: [gdal-dev] compiling gdal with esri file gdb
In-Reply-To: <10885343.Y1xjAuH3TW@even-i700>
References: <CAHBySPac9AefGk373ZyKvqzPe0kK3OtUDz57i3eb0GDjaowtjA@mail.gmail.com>
 <1745015.tU1JPdkWe3@even-i700>
 <a17ce89f-33d0-1938-34a4-0b2357235d5b@gatewaygeomatics.com>
 <10885343.Y1xjAuH3TW@even-i700>
Message-ID: <CAFLLRp+EW78CUmaVWfL7fPS4sUG2Dmb6z=iGuxtwgWQ3rmB6_Q@mail.gmail.com>

Hi Even,


On 9 March 2017 at 23:03, Even Rouault <even.rouault at spatialys.com> wrote:

>
>
> For those, at least on Linux, and which use GDAL compiled *without*
> --with-static-proj, you may get strange projection related failures at
> runtime. This is due to libFileGDBAPI.so embedding a copy of proj.4
> (without symbol hidding or renaming !!!), which conflicts with the proj.4
> that GDAL will load dlopen(). Typical error emitted is about "unknown
> ellipsoid".
>

I presume there's no workaround apart from --with-static-proj that doesn't
require ESRI to change their build process?

Cheers,

Rob :)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170310/fa69805e/attachment.html>

From even.rouault at spatialys.com  Fri Mar 10 09:03:22 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 10 Mar 2017 18:03:22 +0100
Subject: [gdal-dev] OpenFileGDB driver conflicts with GPX and KML driver
In-Reply-To: <14517d37-5d83-528c-2aff-56977e364c83@codematix.de>
References: <14517d37-5d83-528c-2aff-56977e364c83@codematix.de>
Message-ID: <4019128.Hstlj8x1Ay@even-i700>

On vendredi 10 mars 2017 13:35:18 CET Holger Schiebold wrote:
> Hi all,
> 
> at gdal 1.11.5 i have to disable via OGR_SKIP the GPX and KML driver to
> get FileGDB driver working with my ESRI filegeodatabases. Otherwise i
> get an segfault caused by the GPX or KML driver.  On former 1.9 version
> of gdal this not happens. 

The OpenFileGDB driver didn't exist at that time ;-)

> Is it a bug or special circumstances in my
> environment? Can anybody confirm that behaviour in his environment?

I'm not aware of issues like the one you report. Does that happen with all .gdb or a particular 
one ? It would be interesting to know if it still happens for you in recent releases since 1.11 is 
aging now.

Even

> 
> 
> thanks in advance
> 
> Holger
> 
> 
> mit freundlichen Grüßen


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170310/2a8bcd52/attachment.html>

From even.rouault at spatialys.com  Fri Mar 10 09:16:23 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 10 Mar 2017 18:16:23 +0100
Subject: [gdal-dev] compiling gdal with esri file gdb
In-Reply-To: <CAFLLRp+EW78CUmaVWfL7fPS4sUG2Dmb6z=iGuxtwgWQ3rmB6_Q@mail.gmail.com>
References: <CAHBySPac9AefGk373ZyKvqzPe0kK3OtUDz57i3eb0GDjaowtjA@mail.gmail.com>
 <10885343.Y1xjAuH3TW@even-i700>
 <CAFLLRp+EW78CUmaVWfL7fPS4sUG2Dmb6z=iGuxtwgWQ3rmB6_Q@mail.gmail.com>
Message-ID: <2743406.09TFVRbBDC@even-i700>

On vendredi 10 mars 2017 12:57:05 CET Robert Coup wrote:
> Hi Even,
> 
> On 9 March 2017 at 23:03, Even Rouault <even.rouault at spatialys.com> wrote:
> > For those, at least on Linux, and which use GDAL compiled *without*
> > --with-static-proj, you may get strange projection related failures at
> > runtime. This is due to libFileGDBAPI.so embedding a copy of proj.4
> > (without symbol hidding or renaming !!!), which conflicts with the proj.4
> > that GDAL will load dlopen(). Typical error emitted is about "unknown
> > ellipsoid".
> 
> I presume there's no workaround apart from --with-static-proj that doesn't
> require ESRI to change their build process?

Hi Rob,

Yeah, I'm not even sure if --with-static-proj (which contrary to what its name my suggst will 
link against libproj.so if found) is completely safe, but it did work for me.

Strangely, even without --with-static-proj, it worked for me at first, but then failed when I 
probably reordered paths in my LD_LIBRARY_PATH. But I'm not so surprised: clashing 
symbols issues tend to be not predictable.

In fact,  libFileGDBAPI.so doesn't seem to embed all public proj.4 symbols. The functions are 
missing. But 5 or 6 global array structures, like the list of datums (pj_datums) are exposed in 
the data read-only section. The issue is that pj_datums doesn't seem to have the same 
structure: 2 columns per record in the ESRI version whereas official proj.4 expects 4 columns

$ objdump -T /home/even/FileGDB_API-64gcc51/lib/libFileGDBAPI.so | grep pj_
00000000010dc880 g    DO .data.rel.ro	00000000000000b0  Base        pj_datums
0000000001294080 g    DO .data.rel.ro	0000000000000570  Base        pj_projections
00000000010dbd20 g    DO .data.rel.ro	0000000000000500  Base        pj_pids
00000000010dc7a0 g    DO .data.rel.ro	00000000000000e0  Base        pj_primems
00000000010dc380 g    DO .data.rel.ro	0000000000000420  Base        pj_ellipses
00000000010dc220 g    DO .data.rel.ro	0000000000000160  Base        pj_linunits

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170310/95e08cb4/attachment-0001.html>

From schwehr at gmail.com  Fri Mar 10 10:05:13 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Fri, 10 Mar 2017 10:05:13 -0800
Subject: [gdal-dev] Symlinks to VRTs
In-Reply-To: <3488421.AN0CBMalvu@even-i700>
References: <20170308193824.2b21b3b4@gentp.lnet> <1879911.mRjSHVTDHg@even-i700>
 <20170308223742.3177852f@gentp.lnet> <3488421.AN0CBMalvu@even-i700>
Message-ID: <CACmBxysRN9R6boPQrHT4AKmpuspMW2XT18z7B6=iDAq_eRk5=Q@mail.gmail.com>

You can also disable readlink to fix some issues.  e.g. in a content
addressable storage (CAS) filesystem, every file is typically in a separate
directory, so you don't want links dereferenced.

https://github.com/OSGeo/gdal/blob/trunk/gdal/port/cpl_config.h.in#L151

On Wed, Mar 8, 2017 at 1:46 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> On mercredi 8 mars 2017 22:37:42 CET Luis Ressel wrote:
>
> > On Wed, 08 Mar 2017 21:28:34 +0100
>
> >
>
> > Even Rouault <even.rouault at spatialys.com> wrote:
>
> > > The relevant piece of code is in
>
> > > https://github.com/OSGeo/gdal/blob/trunk/gdal/frmts/vrt/
> vrtdataset.cpp#L73
>
> > > 9
>
> > >
>
> > > If you look a bit below in
>
> > > https://github.com/OSGeo/gdal/blob/trunk/gdal/frmts/vrt/
> vrtdataset.cpp#L81
>
> > > 4
>
> > > there's an open option ROOT_PATH that could be set to b/ to get the
>
> > > behaviour you wish.
>
> >
>
> > Thanks for the hint! Adjusting the ROOT_PATH is an acceptable solution
>
> > in my use case.
>
> >
>
> > Interestingly, GDAL used to handle symlinks to VRTs in the way I'd
>
> > expected, but this was changed back in 2013 (commit 66b3918df in the
>
> > git repository, committed by you).
>
>
>
> Looking at the commit message, it appears that this change was contributed
> by someone else from https://trac.osgeo.org/gdal/ticket/4999
>
> But my intuition is that the current behaviour is more natural than the
> previous one (ie the one you'd expect). But obviously different people have
> different use cases.
>
>
>
> >
>
> > Regards,
>
> > Luis Ressel
>
>
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170310/e456b781/attachment.html>

From aranea at aixah.de  Fri Mar 10 10:38:02 2017
From: aranea at aixah.de (Luis Ressel)
Date: Fri, 10 Mar 2017 19:38:02 +0100
Subject: [gdal-dev] Symlinks to VRTs
In-Reply-To: <CACmBxysRN9R6boPQrHT4AKmpuspMW2XT18z7B6=iDAq_eRk5=Q@mail.gmail.com>
References: <20170308193824.2b21b3b4@gentp.lnet> <1879911.mRjSHVTDHg@even-i700>
 <20170308223742.3177852f@gentp.lnet> <3488421.AN0CBMalvu@even-i700>
 <CACmBxysRN9R6boPQrHT4AKmpuspMW2XT18z7B6=iDAq_eRk5=Q@mail.gmail.com>
Message-ID: <20170310193802.1df10aff@gentp.lnet>

On Fri, 10 Mar 2017 10:05:13 -0800
Kurt Schwehr <schwehr at gmail.com> wrote:

> You can also disable readlink to fix some issues.  e.g. in a content
> addressable storage (CAS) filesystem, every file is typically in a
> separate directory, so you don't want links dereferenced.

Yes, that's exactly my setup (I'm using git-annex for file
archival and synchronization).

> https://github.com/OSGeo/gdal/blob/trunk/gdal/port/cpl_config.h.in#L151

Thanks, that's a neat idea! Disabling HAVE_READLINK will break some
functionality in gcore/gdalopeninfo.cpp, but none that I care about.

Regards,
Luis Ressel
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 833 bytes
Desc: OpenPGP digital signature
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170310/ab868391/attachment.sig>

From stephane.poirier at oifii.org  Fri Mar 10 12:04:04 2017
From: stephane.poirier at oifii.org (Stephane Poirier)
Date: Fri, 10 Mar 2017 15:04:04 -0500
Subject: [gdal-dev] need gdal202.dll and gdal18.dll
Message-ID: <45c46284-783e-982e-424b-37adc437ee9e@oifii.org>

Hi All,

Could someone tell me where I can find older versions of gdalXXX.dll ?

Steph


From jmckenna at gatewaygeomatics.com  Fri Mar 10 13:29:01 2017
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Fri, 10 Mar 2017 17:29:01 -0400
Subject: [gdal-dev] need gdal202.dll and gdal18.dll
In-Reply-To: <45c46284-783e-982e-424b-37adc437ee9e@oifii.org>
References: <45c46284-783e-982e-424b-37adc437ee9e@oifii.org>
Message-ID: <6d76ef66-ebe3-8f26-7818-e98bf014e201@gatewaygeomatics.com>

On 2017-03-10 4:04 PM, Stephane Poirier wrote:
> Hi All,
>
> Could someone tell me where I can find older versions of gdalXXX.dll ?
>
> Steph
>

MS4W archives are available all the way back to year 2003, containing 
GDAL dlls.  See "archives" at http://ms4w.com/

-jeff



-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/






From richard.greenwood at gmail.com  Fri Mar 10 16:05:19 2017
From: richard.greenwood at gmail.com (Richard Greenwood)
Date: Fri, 10 Mar 2017 17:05:19 -0700
Subject: [gdal-dev] compiling gdal with esri file gdb
In-Reply-To: <2743406.09TFVRbBDC@even-i700>
References: <CAHBySPac9AefGk373ZyKvqzPe0kK3OtUDz57i3eb0GDjaowtjA@mail.gmail.com>
 <10885343.Y1xjAuH3TW@even-i700>
 <CAFLLRp+EW78CUmaVWfL7fPS4sUG2Dmb6z=iGuxtwgWQ3rmB6_Q@mail.gmail.com>
 <2743406.09TFVRbBDC@even-i700>
Message-ID: <CAHBySPZOoMNOnRcUNmc1noA9KPynvVsojGvKPRBYm=QTmnx-MA@mail.gmail.com>

If any of you can share any pointers on how to even get it to compile I'd
appreciate it. I just need to access a esri file geodatabase that has
curves and see if I can get them into postgis. If I have to have a separate
build of gdal just for that I don't care. But I'm not too good with
compiling gdal with 3rd party libraries.

Thanks,
Rich


On Fri, Mar 10, 2017 at 10:16 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> On vendredi 10 mars 2017 12:57:05 CET Robert Coup wrote:
>
> > Hi Even,
>
> >
>
> > On 9 March 2017 at 23:03, Even Rouault <even.rouault at spatialys.com>
> wrote:
>
> > > For those, at least on Linux, and which use GDAL compiled *without*
>
> > > --with-static-proj, you may get strange projection related failures at
>
> > > runtime. This is due to libFileGDBAPI.so embedding a copy of proj.4
>
> > > (without symbol hidding or renaming !!!), which conflicts with the
> proj.4
>
> > > that GDAL will load dlopen(). Typical error emitted is about "unknown
>
> > > ellipsoid".
>
> >
>
> > I presume there's no workaround apart from --with-static-proj that
> doesn't
>
> > require ESRI to change their build process?
>
>
>
> Hi Rob,
>
>
>
> Yeah, I'm not even sure if --with-static-proj (which contrary to what its
> name my suggst will link against libproj.so if found) is completely safe,
> but it did work for me.
>
>
>
> Strangely, even without --with-static-proj, it worked for me at first, but
> then failed when I probably reordered paths in my LD_LIBRARY_PATH. But I'm
> not so surprised: clashing symbols issues tend to be not predictable.
>
>
>
> In fact, libFileGDBAPI.so doesn't seem to embed all public proj.4 symbols.
> The functions are missing. But 5 or 6 global array structures, like the
> list of datums (pj_datums) are exposed in the data read-only section. The
> issue is that pj_datums doesn't seem to have the same structure: 2 columns
> per record in the ESRI version whereas official proj.4 expects 4 columns
>
>
>
> $ objdump -T /home/even/FileGDB_API-64gcc51/lib/libFileGDBAPI.so | grep
> pj_
>
> 00000000010dc880 g DO .data.rel.ro 00000000000000b0 Base pj_datums
>
> 0000000001294080 g DO .data.rel.ro 0000000000000570 Base pj_projections
>
> 00000000010dbd20 g DO .data.rel.ro 0000000000000500 Base pj_pids
>
> 00000000010dc7a0 g DO .data.rel.ro 00000000000000e0 Base pj_primems
>
> 00000000010dc380 g DO .data.rel.ro 0000000000000420 Base pj_ellipses
>
> 00000000010dc220 g DO .data.rel.ro 0000000000000160 Base pj_linunits
>
>
>
> Even
>
>
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
Richard W. Greenwood, PLS
www.greenwoodmap.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170310/41460ad0/attachment.html>

From nik at nikosalexandris.net  Fri Mar 10 23:53:00 2017
From: nik at nikosalexandris.net (Nikos Alexandris)
Date: Sat, 11 Mar 2017 08:53:00 +0100
Subject: [gdal-dev] [GRASS-user] Slow import of GHSL
In-Reply-To: <CALFmHhtmDr=JAPy26qZNT3Gu=0-y7oYFZNWaa6oAsftWX5VayQ@mail.gmail.com>
References: <20170310164700.GC1715@mail.nikosalexandris.net>
 <CALFmHhtmDr=JAPy26qZNT3Gu=0-y7oYFZNWaa6oAsftWX5VayQ@mail.gmail.com>
Message-ID: <20170311075300.GA4021@mail.nikosalexandris.net>

Nikos Alexandris

>> Why does (attempting to) import a 38m pixel resolution GHSL [0] GeoTIFF
>> layer, ie GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38_v1_0_p1.tif, in GRASS'
>> db progress slow?

(Apologies for cross-posting to gdal-dev)

Markus Neteler:

>Can you elaborate a bit more? I have downloaded and checked:
>
>That is 9835059101  bytes in 19885 files or I downloaded the wrong one
>(please post an URL).

I suggested them, already, to have single "pool" directory just with the
data, zipped and the license in it, for each data set.

For example <http://ghsl.jrc.ec.europa.eu/ghs_bu.php>,

>> Similar GHSL data sets vary between 300 ~ 500 MB in size.

see

GHS_BUILT_LDS1975_GLOBE_R2016A_3857_38 (768MB) 
GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38 (854MB) 
GHS_BUILT_LDS2000_GLOBE_R2016A_3857_38 (892MB) 
GHS_BUILT_LDS2014_GLOBE_R2016A_3857_38 (900MB)

"3857" is the EPSG code.  They are split in two GeoTIFFs (p1, p2) and
there is a VRT along with overviews for it.  No overviews for the TIFFs.

For example:

GHSL_data_access_v1.3.pdf
GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38_v1_0.clr
GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38_v1_0.vrt
GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38_v1_0.vrt.ovr
GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38_v1_0_p1.tif
GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38_v1_0_p2.tif


Even trying to clip, with gdal_translate, might create file(s) of
hundreds of GBs. This might be due to missing compression. Even then,
the derived files, which are a subset in terms of extent, are enormous
compared to their source, say p1 or p2.

Creating a new VRT, works of course instantaneously. For example:

```
# some custom Europe's extent
ogrinfo -al europe_extent_epsg_3857/corine_2000.shp |grep Ext

Extent: (-6290123.623699, 2788074.747995) - (8115874.019718, 8170181.584331)

# extract the above subset in a new VRT
gdal_translate -projwin -6290123.623699 8170181.584331 8115874.019718 2788074.747995 GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38_v1_0.vrt test.vrt -of VRT

# build some overview for it (or for the p1 or p2 GeoTIFFs) -- slow for all options
gdaladdo -ro --config COMPRESS_OVERVIEW LZW test.vrt 2 4 8 16
```

If it's not for a VRT file, the subset extraction is very slow.
The files appear to be practically hard to process, one needs to wait
several hours for a clip.

The import of p1 or p2 or of the VRT file in GRASS' data base, via
r.in.gdal/r.import, does not progress at all.

>Yes - do you have a SSD disk? This quite helps along with a
>sufficiently large GDAL cache ("memory" parameter of r.in.gdal).

Among tests, I had set that to 2047. No obvious improvement.

>> As well, trying to clip the GeoTIFFs (not the VRT files) with gdal
>> tools to a custom extent (say Europe), appears to be a heavy process.

>With GDAL, be sure to have set something like
>export GDAL_CACHEMAX=2000

(
Side question: why is max 2047?  What if there is a lot more of RAM?
)

>HTH,
>Markus

Thank you Markus. I think there is more into it than the cache.

Nikos

>> [0] http://ghsl.jrc.ec.europa.eu/

From damian.dixon at gmail.com  Sat Mar 11 00:34:53 2017
From: damian.dixon at gmail.com (Damian Dixon)
Date: Sat, 11 Mar 2017 08:34:53 +0000
Subject: [gdal-dev] compiling gdal with esri file gdb
In-Reply-To: <CAHBySPZOoMNOnRcUNmc1noA9KPynvVsojGvKPRBYm=QTmnx-MA@mail.gmail.com>
References: <CAHBySPac9AefGk373ZyKvqzPe0kK3OtUDz57i3eb0GDjaowtjA@mail.gmail.com>
 <10885343.Y1xjAuH3TW@even-i700>
 <CAFLLRp+EW78CUmaVWfL7fPS4sUG2Dmb6z=iGuxtwgWQ3rmB6_Q@mail.gmail.com>
 <2743406.09TFVRbBDC@even-i700>
 <CAHBySPZOoMNOnRcUNmc1noA9KPynvVsojGvKPRBYm=QTmnx-MA@mail.gmail.com>
Message-ID: <CAJjdW1zq+Q-bEfQKggx9_848tEmcUAMOFsOV-psO9ZfiT9+0GQ@mail.gmail.com>

Have you tried OpenFileGDB? (you will need GDAL 2.2 or newer for curve
geometries).

See: http://www.gdal.org/drv_openfilegdb.html

We have switched to OpenFileGDB because ESRI don't have their library
available on Windows built against VS2015. Which also means we did not
bother with the ESRI libraries on Linux either.

The other option is to use GDAL on Windows to convert the file. The way
shared libraries work on Windows means that the proj4 issue you are seeing
on Linux should not occur.

I don't know where you would get a Windows build of GDAL with FileGDB
enabled. Someone on the list probably does.



On 11 March 2017 at 00:05, Richard Greenwood <richard.greenwood at gmail.com>
wrote:

> If any of you can share any pointers on how to even get it to compile I'd
> appreciate it. I just need to access a esri file geodatabase that has
> curves and see if I can get them into postgis. If I have to have a separate
> build of gdal just for that I don't care. But I'm not too good with
> compiling gdal with 3rd party libraries.
>
> Thanks,
> Rich
>
>
> On Fri, Mar 10, 2017 at 10:16 AM, Even Rouault <even.rouault at spatialys.com
> > wrote:
>
>> On vendredi 10 mars 2017 12:57:05 CET Robert Coup wrote:
>>
>> > Hi Even,
>>
>> >
>>
>> > On 9 March 2017 at 23:03, Even Rouault <even.rouault at spatialys.com>
>> wrote:
>>
>> > > For those, at least on Linux, and which use GDAL compiled *without*
>>
>> > > --with-static-proj, you may get strange projection related failures at
>>
>> > > runtime. This is due to libFileGDBAPI.so embedding a copy of proj.4
>>
>> > > (without symbol hidding or renaming !!!), which conflicts with the
>> proj.4
>>
>> > > that GDAL will load dlopen(). Typical error emitted is about "unknown
>>
>> > > ellipsoid".
>>
>> >
>>
>> > I presume there's no workaround apart from --with-static-proj that
>> doesn't
>>
>> > require ESRI to change their build process?
>>
>>
>>
>> Hi Rob,
>>
>>
>>
>> Yeah, I'm not even sure if --with-static-proj (which contrary to what its
>> name my suggst will link against libproj.so if found) is completely safe,
>> but it did work for me.
>>
>>
>>
>> Strangely, even without --with-static-proj, it worked for me at first,
>> but then failed when I probably reordered paths in my LD_LIBRARY_PATH. But
>> I'm not so surprised: clashing symbols issues tend to be not predictable.
>>
>>
>>
>> In fact, libFileGDBAPI.so doesn't seem to embed all public proj.4
>> symbols. The functions are missing. But 5 or 6 global array structures,
>> like the list of datums (pj_datums) are exposed in the data read-only
>> section. The issue is that pj_datums doesn't seem to have the same
>> structure: 2 columns per record in the ESRI version whereas official proj.4
>> expects 4 columns
>>
>>
>>
>> $ objdump -T /home/even/FileGDB_API-64gcc51/lib/libFileGDBAPI.so | grep
>> pj_
>>
>> 00000000010dc880 g DO .data.rel.ro 00000000000000b0 Base pj_datums
>>
>> 0000000001294080 g DO .data.rel.ro 0000000000000570 Base pj_projections
>>
>> 00000000010dbd20 g DO .data.rel.ro 0000000000000500 Base pj_pids
>>
>> 00000000010dc7a0 g DO .data.rel.ro 00000000000000e0 Base pj_primems
>>
>> 00000000010dc380 g DO .data.rel.ro 0000000000000420 Base pj_ellipses
>>
>> 00000000010dc220 g DO .data.rel.ro 0000000000000160 Base pj_linunits
>>
>>
>>
>> Even
>>
>>
>>
>>
>>
>> --
>>
>> Spatialys - Geospatial professional services
>>
>> http://www.spatialys.com
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>
> --
> Richard W. Greenwood, PLS
> www.greenwoodmap.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170311/aea81eae/attachment-0001.html>

From fuadjsh at gmail.com  Sat Mar 11 02:49:16 2017
From: fuadjsh at gmail.com (fuadjsh at gmail.com)
Date: Sat, 11 Mar 2017 12:49:16 +0200
Subject: [gdal-dev] compiling gdal with esri file gdb
References: <CAHBySPac9AefGk373ZyKvqzPe0kK3OtUDz57i3eb0GDjaowtjA@mail.gmail.com>
 <10885343.Y1xjAuH3TW@even-i700>
 <CAFLLRp+EW78CUmaVWfL7fPS4sUG2Dmb6z=iGuxtwgWQ3rmB6_Q@mail.gmail.com>
 <2743406.09TFVRbBDC@even-i700>
 <CAHBySPZOoMNOnRcUNmc1noA9KPynvVsojGvKPRBYm=QTmnx-MA@mail.gmail.com>
 <CAJjdW1zq+Q-bEfQKggx9_848tEmcUAMOFsOV-psO9ZfiT9+0GQ@mail.gmail.com>
Message-ID: <58c3d586.a2acdf0a.de7d5.7a3a@mx.google.com>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170311/07f8c822/attachment.html>

From richard.greenwood at gmail.com  Sat Mar 11 06:15:27 2017
From: richard.greenwood at gmail.com (Richard Greenwood)
Date: Sat, 11 Mar 2017 07:15:27 -0700
Subject: [gdal-dev] compiling gdal with esri file gdb
In-Reply-To: <CAJjdW1zq+Q-bEfQKggx9_848tEmcUAMOFsOV-psO9ZfiT9+0GQ@mail.gmail.com>
References: <CAHBySPac9AefGk373ZyKvqzPe0kK3OtUDz57i3eb0GDjaowtjA@mail.gmail.com>
 <10885343.Y1xjAuH3TW@even-i700>
 <CAFLLRp+EW78CUmaVWfL7fPS4sUG2Dmb6z=iGuxtwgWQ3rmB6_Q@mail.gmail.com>
 <2743406.09TFVRbBDC@even-i700>
 <CAHBySPZOoMNOnRcUNmc1noA9KPynvVsojGvKPRBYm=QTmnx-MA@mail.gmail.com>
 <CAJjdW1zq+Q-bEfQKggx9_848tEmcUAMOFsOV-psO9ZfiT9+0GQ@mail.gmail.com>
Message-ID: <CAHBySPZikjCuJ59OrNvKqTkFS16hpTAFXUw7utcUAgSyhKCvUg@mail.gmail.com>

On Sat, Mar 11, 2017 at 1:34 AM, Damian Dixon <damian.dixon at gmail.com>
wrote:

> Have you tried OpenFileGDB? (you will need GDAL 2.2 or newer for curve
> geometries).
>

I would prefer OpenFileGDB but how do I enable it? configure --help says:
   --with-fgdb=ARG  Include ESRI File Geodatabase support (ARG=FGDP API
Path, yes or no)
so i tried
  --with-fgdb=yes
and got error:
  configure: error: FileGDBAPI not found
so I got the ESRI SDK and configured with
  --with-fgdb=/mnt/e/src/FileGDB_API-64/
but when I make I get many "undefined reference to FileGDBAPI..." errors.

Thanks,
Rich


>
> See: http://www.gdal.org/drv_openfilegdb.html
>
> We have switched to OpenFileGDB because ESRI don't have their library
> available on Windows built against VS2015. Which also means we did not
> bother with the ESRI libraries on Linux either.
>
> The other option is to use GDAL on Windows to convert the file. The way
> shared libraries work on Windows means that the proj4 issue you are seeing
> on Linux should not occur.
>
> I don't know where you would get a Windows build of GDAL with FileGDB
> enabled. Someone on the list probably does.
>
>
>
> On 11 March 2017 at 00:05, Richard Greenwood <richard.greenwood at gmail.com>
> wrote:
>
>> If any of you can share any pointers on how to even get it to compile I'd
>> appreciate it. I just need to access a esri file geodatabase that has
>> curves and see if I can get them into postgis. If I have to have a separate
>> build of gdal just for that I don't care. But I'm not too good with
>> compiling gdal with 3rd party libraries.
>>
>> Thanks,
>> Rich
>>
>>
>> On Fri, Mar 10, 2017 at 10:16 AM, Even Rouault <
>> even.rouault at spatialys.com> wrote:
>>
>>> On vendredi 10 mars 2017 12:57:05 CET Robert Coup wrote:
>>>
>>> > Hi Even,
>>>
>>> >
>>>
>>> > On 9 March 2017 at 23:03, Even Rouault <even.rouault at spatialys.com>
>>> wrote:
>>>
>>> > > For those, at least on Linux, and which use GDAL compiled *without*
>>>
>>> > > --with-static-proj, you may get strange projection related failures
>>> at
>>>
>>> > > runtime. This is due to libFileGDBAPI.so embedding a copy of proj.4
>>>
>>> > > (without symbol hidding or renaming !!!), which conflicts with the
>>> proj.4
>>>
>>> > > that GDAL will load dlopen(). Typical error emitted is about "unknown
>>>
>>> > > ellipsoid".
>>>
>>> >
>>>
>>> > I presume there's no workaround apart from --with-static-proj that
>>> doesn't
>>>
>>> > require ESRI to change their build process?
>>>
>>>
>>>
>>> Hi Rob,
>>>
>>>
>>>
>>> Yeah, I'm not even sure if --with-static-proj (which contrary to what
>>> its name my suggst will link against libproj.so if found) is completely
>>> safe, but it did work for me.
>>>
>>>
>>>
>>> Strangely, even without --with-static-proj, it worked for me at first,
>>> but then failed when I probably reordered paths in my LD_LIBRARY_PATH. But
>>> I'm not so surprised: clashing symbols issues tend to be not predictable.
>>>
>>>
>>>
>>> In fact, libFileGDBAPI.so doesn't seem to embed all public proj.4
>>> symbols. The functions are missing. But 5 or 6 global array structures,
>>> like the list of datums (pj_datums) are exposed in the data read-only
>>> section. The issue is that pj_datums doesn't seem to have the same
>>> structure: 2 columns per record in the ESRI version whereas official proj.4
>>> expects 4 columns
>>>
>>>
>>>
>>> $ objdump -T /home/even/FileGDB_API-64gcc51/lib/libFileGDBAPI.so | grep
>>> pj_
>>>
>>> 00000000010dc880 g DO .data.rel.ro 00000000000000b0 Base pj_datums
>>>
>>> 0000000001294080 g DO .data.rel.ro 0000000000000570 Base pj_projections
>>>
>>> 00000000010dbd20 g DO .data.rel.ro 0000000000000500 Base pj_pids
>>>
>>> 00000000010dc7a0 g DO .data.rel.ro 00000000000000e0 Base pj_primems
>>>
>>> 00000000010dc380 g DO .data.rel.ro 0000000000000420 Base pj_ellipses
>>>
>>> 00000000010dc220 g DO .data.rel.ro 0000000000000160 Base pj_linunits
>>>
>>>
>>>
>>> Even
>>>
>>>
>>>
>>>
>>>
>>> --
>>>
>>> Spatialys - Geospatial professional services
>>>
>>> http://www.spatialys.com
>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>
>>
>>
>> --
>> Richard W. Greenwood, PLS
>> www.greenwoodmap.com
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>


-- 
Richard W. Greenwood, PLS
www.greenwoodmap.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170311/7c74f8ff/attachment-0001.html>

From richard.greenwood at gmail.com  Sat Mar 11 06:18:47 2017
From: richard.greenwood at gmail.com (Richard Greenwood)
Date: Sat, 11 Mar 2017 07:18:47 -0700
Subject: [gdal-dev] compiling gdal with esri file gdb
In-Reply-To: <58c3d586.a2acdf0a.de7d5.7a3a@mx.google.com>
References: <CAHBySPac9AefGk373ZyKvqzPe0kK3OtUDz57i3eb0GDjaowtjA@mail.gmail.com>
 <10885343.Y1xjAuH3TW@even-i700>
 <CAFLLRp+EW78CUmaVWfL7fPS4sUG2Dmb6z=iGuxtwgWQ3rmB6_Q@mail.gmail.com>
 <2743406.09TFVRbBDC@even-i700>
 <CAHBySPZOoMNOnRcUNmc1noA9KPynvVsojGvKPRBYm=QTmnx-MA@mail.gmail.com>
 <CAJjdW1zq+Q-bEfQKggx9_848tEmcUAMOFsOV-psO9ZfiT9+0GQ@mail.gmail.com>
 <58c3d586.a2acdf0a.de7d5.7a3a@mx.google.com>
Message-ID: <CAHBySPaaTPGu5k06Z=h1W86CJdxz=BDc7cJmz1DMRLWF2_QYYQ@mail.gmail.com>

On Sat, Mar 11, 2017 at 3:49 AM, fuadjsh at gmail.com <fuadjsh at gmail.com>
wrote:

> gisinternals.org has Gdal for Windows with file geodatabase support
>

I don't see gdal 2.2 on gisinternals and I believe I need 2.2+ for curves
in ESRI file geodatabases. Are you able to extract curves?

Thanks,
Rich




> It works fine
> Fuad
>
>
> -------- Original Message --------
> Subject: Re: [gdal-dev] compiling gdal with esri file gdb
> From: Damian Dixon
> To: Richard Greenwood
> CC: GDAL List
>
>
> Have you tried OpenFileGDB? (you will need GDAL 2.2 or newer for curve
> geometries).
>
> See: http://www.gdal.org/drv_openfilegdb.html
>
> We have switched to OpenFileGDB because ESRI don't have their library
> available on Windows built against VS2015. Which also means we did not
> bother with the ESRI libraries on Linux either.
>
> The other option is to use GDAL on Windows to convert the file. The way
> shared libraries work on Windows means that the proj4 issue you are seeing
> on Linux should not occur.
>
> I don't know where you would get a Windows build of GDAL with FileGDB
> enabled. Someone on the list probably does.
>
>
>
> On 11 March 2017 at 00:05, Richard Greenwood <richard.greenwood at gmail.com>
> wrote:
>
>> If any of you can share any pointers on how to even get it to compile I'd
>> appreciate it. I just need to access a esri file geodatabase that has
>> curves and see if I can get them into postgis. If I have to have a separate
>> build of gdal just for that I don't care. But I'm not too good with
>> compiling gdal with 3rd party libraries.
>>
>> Thanks,
>> Rich
>>
>>
>> On Fri, Mar 10, 2017 at 10:16 AM, Even Rouault <
>> even.rouault at spatialys.com> wrote:
>>
>>> On vendredi 10 mars 2017 12:57:05 CET Robert Coup wrote:
>>>
>>> > Hi Even,
>>>
>>> >
>>>
>>> > On 9 March 2017 at 23:03, Even Rouault <even.rouault at spatialys.com>
>>> wrote:
>>>
>>> > > For those, at least on Linux, and which use GDAL compiled *without*
>>>
>>> > > --with-static-proj, you may get strange projection related failures
>>> at
>>>
>>> > > runtime. This is due to libFileGDBAPI.so embedding a copy of proj.4
>>>
>>> > > (without symbol hidding or renaming !!!), which conflicts with the
>>> proj.4
>>>
>>> > > that GDAL will load dlopen(). Typical error emitted is about "unknown
>>>
>>> > > ellipsoid".
>>>
>>> >
>>>
>>> > I presume there's no workaround apart from --with-static-proj that
>>> doesn't
>>>
>>> > require ESRI to change their build process?
>>>
>>>
>>>
>>> Hi Rob,
>>>
>>>
>>>
>>> Yeah, I'm not even sure if --with-static-proj (which contrary to what
>>> its name my suggst will link against libproj.so if found) is completely
>>> safe, but it did work for me.
>>>
>>>
>>>
>>> Strangely, even without --with-static-proj, it worked for me at first,
>>> but then failed when I probably reordered paths in my LD_LIBRARY_PATH. But
>>> I'm not so surprised: clashing symbols issues tend to be not predictable.
>>>
>>>
>>>
>>> In fact, libFileGDBAPI.so doesn't seem to embed all public proj.4
>>> symbols. The functions are missing. But 5 or 6 global array structures,
>>> like the list of datums (pj_datums) are exposed in the data read-only
>>> section. The issue is that pj_datums doesn't seem to have the same
>>> structure: 2 columns per record in the ESRI version whereas official proj.4
>>> expects 4 columns
>>>
>>>
>>>
>>> $ objdump -T /home/even/FileGDB_API-64gcc51/lib/libFileGDBAPI.so | grep
>>> pj_
>>>
>>> 00000000010dc880 g DO .data.rel.ro 00000000000000b0 Base pj_datums
>>>
>>> 0000000001294080 g DO .data.rel.ro 0000000000000570 Base pj_projections
>>>
>>> 00000000010dbd20 g DO .data.rel.ro 0000000000000500 Base pj_pids
>>>
>>> 00000000010dc7a0 g DO .data.rel.ro 00000000000000e0 Base pj_primems
>>>
>>> 00000000010dc380 g DO .data.rel.ro 0000000000000420 Base pj_ellipses
>>>
>>> 00000000010dc220 g DO .data.rel.ro 0000000000000160 Base pj_linunits
>>>
>>>
>>>
>>> Even
>>>
>>>
>>>
>>>
>>>
>>> --
>>>
>>> Spatialys - Geospatial professional services
>>>
>>> http://www.spatialys.com
>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>
>>
>>
>> --
>> Richard W. Greenwood, PLS
>> www.greenwoodmap.com
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>


-- 
Richard W. Greenwood, PLS
www.greenwoodmap.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170311/05a1b950/attachment.html>

From even.rouault at spatialys.com  Sat Mar 11 06:20:32 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 11 Mar 2017 15:20:32 +0100
Subject: [gdal-dev] compiling gdal with esri file gdb
In-Reply-To: <CAHBySPZikjCuJ59OrNvKqTkFS16hpTAFXUw7utcUAgSyhKCvUg@mail.gmail.com>
References: <CAHBySPac9AefGk373ZyKvqzPe0kK3OtUDz57i3eb0GDjaowtjA@mail.gmail.com>
 <CAJjdW1zq+Q-bEfQKggx9_848tEmcUAMOFsOV-psO9ZfiT9+0GQ@mail.gmail.com>
 <CAHBySPZikjCuJ59OrNvKqTkFS16hpTAFXUw7utcUAgSyhKCvUg@mail.gmail.com>
Message-ID: <9152450.hFaLkRAHtg@even-i700>

On samedi 11 mars 2017 07:15:27 CET Richard Greenwood wrote:
> On Sat, Mar 11, 2017 at 1:34 AM, Damian Dixon <damian.dixon at gmail.com>
> 
> wrote:
> > Have you tried OpenFileGDB? (you will need GDAL 2.2 or newer for curve
> > geometries).
> 
> I would prefer OpenFileGDB but how do I enable it? 

It is a built-in driver. No option.

--with-fgdb is when you want to enable the FileGDB driver that relies on the ESRI 
SDK

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170311/4655d82c/attachment.html>

From even.rouault at spatialys.com  Sat Mar 11 06:30:07 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 11 Mar 2017 15:30:07 +0100
Subject: [gdal-dev] compiling gdal with esri file gdb
In-Reply-To: <CAHBySPaaTPGu5k06Z=h1W86CJdxz=BDc7cJmz1DMRLWF2_QYYQ@mail.gmail.com>
References: <CAHBySPac9AefGk373ZyKvqzPe0kK3OtUDz57i3eb0GDjaowtjA@mail.gmail.com>
 <58c3d586.a2acdf0a.de7d5.7a3a@mx.google.com>
 <CAHBySPaaTPGu5k06Z=h1W86CJdxz=BDc7cJmz1DMRLWF2_QYYQ@mail.gmail.com>
Message-ID: <3729817.MPinXfF0Ja@even-i700>

On samedi 11 mars 2017 07:18:47 CET Richard Greenwood wrote:
> On Sat, Mar 11, 2017 at 3:49 AM, fuadjsh at gmail.com <fuadjsh at gmail.com>
> 
> wrote:
> > gisinternals.org has Gdal for Windows with file geodatabase support
> 
> I don't see gdal 2.2 on gisinternals and I believe I need 2.2+ for curves
> in ESRI file geodatabases. Are you able to extract curves?

Here : http://gisinternals.com/development.php

2.2 is not yet released, so you need to fetch the development version (2.2.0dev)

> 
> Thanks,
> Rich
> 
> > It works fine
> > Fuad
> > 
> > 
> > -------- Original Message --------
> > Subject: Re: [gdal-dev] compiling gdal with esri file gdb
> > From: Damian Dixon
> > To: Richard Greenwood
> > CC: GDAL List
> > 
> > 
> > Have you tried OpenFileGDB? (you will need GDAL 2.2 or newer for curve
> > geometries).
> > 
> > See: http://www.gdal.org/drv_openfilegdb.html
> > 
> > We have switched to OpenFileGDB because ESRI don't have their library
> > available on Windows built against VS2015. Which also means we did not
> > bother with the ESRI libraries on Linux either.
> > 
> > The other option is to use GDAL on Windows to convert the file. The way
> > shared libraries work on Windows means that the proj4 issue you are seeing
> > on Linux should not occur.
> > 
> > I don't know where you would get a Windows build of GDAL with FileGDB
> > enabled. Someone on the list probably does.
> > 
> > 
> > 
> > On 11 March 2017 at 00:05, Richard Greenwood <richard.greenwood at gmail.com>
> > 
> > wrote:
> >> If any of you can share any pointers on how to even get it to compile I'd
> >> appreciate it. I just need to access a esri file geodatabase that has
> >> curves and see if I can get them into postgis. If I have to have a
> >> separate
> >> build of gdal just for that I don't care. But I'm not too good with
> >> compiling gdal with 3rd party libraries.
> >> 
> >> Thanks,
> >> Rich
> >> 
> >> 
> >> On Fri, Mar 10, 2017 at 10:16 AM, Even Rouault <
> >> 
> >> even.rouault at spatialys.com> wrote:
> >>> On vendredi 10 mars 2017 12:57:05 CET Robert Coup wrote:
> >>> > Hi Even,
> >>> > 
> >>> > 
> >>> > 
> >>> > On 9 March 2017 at 23:03, Even Rouault <even.rouault at spatialys.com>
> >>> 
> >>> wrote:
> >>> > > For those, at least on Linux, and which use GDAL compiled *without*
> >>> > > 
> >>> > > --with-static-proj, you may get strange projection related failures
> >>> 
> >>> at
> >>> 
> >>> > > runtime. This is due to libFileGDBAPI.so embedding a copy of proj.4
> >>> > > 
> >>> > > (without symbol hidding or renaming !!!), which conflicts with the
> >>> 
> >>> proj.4
> >>> 
> >>> > > that GDAL will load dlopen(). Typical error emitted is about
> >>> > > "unknown
> >>> > > 
> >>> > > ellipsoid".
> >>> > 
> >>> > I presume there's no workaround apart from --with-static-proj that
> >>> 
> >>> doesn't
> >>> 
> >>> > require ESRI to change their build process?
> >>> 
> >>> Hi Rob,
> >>> 
> >>> 
> >>> 
> >>> Yeah, I'm not even sure if --with-static-proj (which contrary to what
> >>> its name my suggst will link against libproj.so if found) is completely
> >>> safe, but it did work for me.
> >>> 
> >>> 
> >>> 
> >>> Strangely, even without --with-static-proj, it worked for me at first,
> >>> but then failed when I probably reordered paths in my LD_LIBRARY_PATH.
> >>> But
> >>> I'm not so surprised: clashing symbols issues tend to be not
> >>> predictable.
> >>> 
> >>> 
> >>> 
> >>> In fact, libFileGDBAPI.so doesn't seem to embed all public proj.4
> >>> symbols. The functions are missing. But 5 or 6 global array structures,
> >>> like the list of datums (pj_datums) are exposed in the data read-only
> >>> section. The issue is that pj_datums doesn't seem to have the same
> >>> structure: 2 columns per record in the ESRI version whereas official
> >>> proj.4
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170311/59b7fdd2/attachment-0001.html>

From richard.greenwood at gmail.com  Sat Mar 11 07:21:45 2017
From: richard.greenwood at gmail.com (Richard Greenwood)
Date: Sat, 11 Mar 2017 08:21:45 -0700
Subject: [gdal-dev] compiling gdal with esri file gdb
In-Reply-To: <9152450.hFaLkRAHtg@even-i700>
References: <CAHBySPac9AefGk373ZyKvqzPe0kK3OtUDz57i3eb0GDjaowtjA@mail.gmail.com>
 <CAJjdW1zq+Q-bEfQKggx9_848tEmcUAMOFsOV-psO9ZfiT9+0GQ@mail.gmail.com>
 <CAHBySPZikjCuJ59OrNvKqTkFS16hpTAFXUw7utcUAgSyhKCvUg@mail.gmail.com>
 <9152450.hFaLkRAHtg@even-i700>
Message-ID: <CAHBySPYz-UUX4v5DFpW67=c5RnCJNU9BRQWQL9kf9=Rg2xnz1w@mail.gmail.com>

On Sat, Mar 11, 2017 at 7:20 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> On samedi 11 mars 2017 07:15:27 CET Richard Greenwood wrote:
>
> > On Sat, Mar 11, 2017 at 1:34 AM, Damian Dixon <damian.dixon at gmail.com>
>
> >
>
> > wrote:
>
> > > Have you tried OpenFileGDB? (you will need GDAL 2.2 or newer for curve
>
> > > geometries).
>
> >
>
> > I would prefer OpenFileGDB but how do I enable it?
>
>
>
> It is a built-in driver. No option.
>
>
>
> --with-fgdb is when you want to enable the FileGDB driver that relies on
> the ESRI SDK
>

Thanks! When I did ./configure and saw "FGDB support: no"  I thought that I
had to set --with-fgdb.


-- 
Richard W. Greenwood, PLS
www.greenwoodmap.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170311/177fa1e0/attachment.html>

From richard.greenwood at gmail.com  Sat Mar 11 08:28:40 2017
From: richard.greenwood at gmail.com (Richard Greenwood)
Date: Sat, 11 Mar 2017 09:28:40 -0700
Subject: [gdal-dev] compiling gdal with esri file gdb
In-Reply-To: <CAHBySPYz-UUX4v5DFpW67=c5RnCJNU9BRQWQL9kf9=Rg2xnz1w@mail.gmail.com>
References: <CAHBySPac9AefGk373ZyKvqzPe0kK3OtUDz57i3eb0GDjaowtjA@mail.gmail.com>
 <CAJjdW1zq+Q-bEfQKggx9_848tEmcUAMOFsOV-psO9ZfiT9+0GQ@mail.gmail.com>
 <CAHBySPZikjCuJ59OrNvKqTkFS16hpTAFXUw7utcUAgSyhKCvUg@mail.gmail.com>
 <9152450.hFaLkRAHtg@even-i700>
 <CAHBySPYz-UUX4v5DFpW67=c5RnCJNU9BRQWQL9kf9=Rg2xnz1w@mail.gmail.com>
Message-ID: <CAHBySPYE6hGQJZn0W0LWt6LPj+wKiRn+DJcFHrTeFnXmYpAmPg@mail.gmail.com>

Many thanks for your help and patience. Using ogr2ogr 2.2 with the
OpenFileGDB driver reads ESRI file GDBs that contain curves. When
converting to a shapefile curves are converted to a series of short
tangents. When converting to postgis the curves appear to be preserved as
curves. Very nice!

Rich


On Sat, Mar 11, 2017 at 8:21 AM, Richard Greenwood <
richard.greenwood at gmail.com> wrote:

>
>
> On Sat, Mar 11, 2017 at 7:20 AM, Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> On samedi 11 mars 2017 07:15:27 CET Richard Greenwood wrote:
>>
>> > On Sat, Mar 11, 2017 at 1:34 AM, Damian Dixon <damian.dixon at gmail.com>
>>
>> >
>>
>> > wrote:
>>
>> > > Have you tried OpenFileGDB? (you will need GDAL 2.2 or newer for curve
>>
>> > > geometries).
>>
>> >
>>
>> > I would prefer OpenFileGDB but how do I enable it?
>>
>>
>>
>> It is a built-in driver. No option.
>>
>>
>>
>> --with-fgdb is when you want to enable the FileGDB driver that relies on
>> the ESRI SDK
>>
>
> Thanks! When I did ./configure and saw "FGDB support: no"  I thought that
> I had to set --with-fgdb.
>
>
> --
> Richard W. Greenwood, PLS
> www.greenwoodmap.com
>



-- 
Richard W. Greenwood, PLS
www.greenwoodmap.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170311/fd401f78/attachment.html>

From stephane.poirier at oifii.org  Sat Mar 11 13:01:29 2017
From: stephane.poirier at oifii.org (Stephane Poirier)
Date: Sat, 11 Mar 2017 16:01:29 -0500
Subject: [gdal-dev] compiling libLAS which has a GDAL dependency
Message-ID: <9e4d2dc0-ff43-4bce-e035-8ebb70b5dffe@oifii.org>

Hi All,

I successfully compiled a 32 bit build of libLAS under Windows 7 - 32 
bit using Visual Studio 2013.

Now, I am trying to compile a 64 bit build of libLAS under Windows 7 - 
64bit using Visual Studio 2013,

every project compile fine except liblas project which gives me an 
unresolved external, here's the error I get:

gt_wkt_srs.obj : error LNK2019: unresolved external symbol "public: 
__cdecl CPLMutexHolder::CPLMutexHolder(void * *,double,char const 
*,int,int)" (??0CPLMutexHolder@@QEAA at PEAPEAXNPEBDHH@Z) referenced in 
function GTIFGetOGISDefn
C:\oifii-org\httpdocs\ns-org\nsd\bs\libLAS-1-8-1_vs2013-x64(spi)\libLAS-1.8.1\bin\Release\liblas.dll 
: fatal error LNK1120: 1 unresolved externals

I suspect this is related with the gdal_i.lib

Do you have any clue as to which extra .lib I should include or which 
gdal_i.lib I should switch to?

Steph


From even.rouault at spatialys.com  Sat Mar 11 13:15:50 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 11 Mar 2017 22:15:50 +0100
Subject: [gdal-dev] compiling libLAS which has a GDAL dependency
In-Reply-To: <9e4d2dc0-ff43-4bce-e035-8ebb70b5dffe@oifii.org>
References: <9e4d2dc0-ff43-4bce-e035-8ebb70b5dffe@oifii.org>
Message-ID: <1581996.7mf5eKccc9@even-i700>

On samedi 11 mars 2017 16:01:29 CET Stephane Poirier wrote:
> Hi All,
> 
> I successfully compiled a 32 bit build of libLAS under Windows 7 - 32
> bit using Visual Studio 2013.
> 
> Now, I am trying to compile a 64 bit build of libLAS under Windows 7 -
> 64bit using Visual Studio 2013,
> 
> every project compile fine except liblas project which gives me an
> unresolved external, here's the error I get:
> 
> gt_wkt_srs.obj : error LNK2019: unresolved external symbol "public:
> __cdecl CPLMutexHolder::CPLMutexHolder(void * *,double,char const
> *,int,int)" (??0CPLMutexHolder@@QEAA at PEAPEAXNPEBDHH@Z) referenced in
> function GTIFGetOGISDefn
> C:\oifii-org\httpdocs\ns-org\nsd\bs\libLAS-1-8-1_vs2013-x64(spi)\libLAS-1.8.
> 1\bin\Release\liblas.dll
> : fatal error LNK1120: 1 unresolved externals
> 
> I suspect this is related with the gdal_i.lib
> 
> Do you have any clue as to which extra .lib I should include or which
> gdal_i.lib I should switch to?

That rings a bell to me. I'm wondering if it might not be an issue of having a non-DEBUG build 
of GDAL, but including it in libLAS with DEBUG defined. The signature of l 
CPLMutexHolder::CPLMutexHolder() depends on whether DEBUG is defined or not.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170311/7b39c025/attachment.html>

From hschiebold at codematix.de  Mon Mar 13 06:39:27 2017
From: hschiebold at codematix.de (Holger Schiebold)
Date: Mon, 13 Mar 2017 14:39:27 +0100
Subject: [gdal-dev] OpenFileGDB driver conflicts with GPX and KML driver
In-Reply-To: <4019128.Hstlj8x1Ay@even-i700>
References: <14517d37-5d83-528c-2aff-56977e364c83@codematix.de>
 <4019128.Hstlj8x1Ay@even-i700>
Message-ID: <1a00cb1d-a9ef-c114-eb39-19d9ec3983dd@codematix.de>

Hmm,

it does not happen with 1.11.3 and 2.1.2 on an other machine with linux 
mint on it. It does not happen with the latest 2.1.3 on our rhel6 system 
where the problem occurs with 1.11.5. So i think special circumstances 
with 1.11.5 on our rhel6 machines. So forget my question - i will update 
gdal in our mapserver environment.

thanks Holger

Am 10.03.2017 um 18:03 schrieb Even Rouault:
>
> On vendredi 10 mars 2017 13:35:18 CET Holger Schiebold wrote:
>
> > Hi all,
>
> >
>
> > at gdal 1.11.5 i have to disable via OGR_SKIP the GPX and KML driver to
>
> > get FileGDB driver working with my ESRI filegeodatabases. Otherwise i
>
> > get an segfault caused by the GPX or KML driver. On former 1.9 version
>
> > of gdal this not happens.
>
> The OpenFileGDB driver didn't exist at that time ;-)
>
> > Is it a bug or special circumstances in my
>
> > environment? Can anybody confirm that behaviour in his environment?
>
> I'm not aware of issues like the one you report. Does that happen with 
> all .gdb or a particular one ? It would be interesting to know if it 
> still happens for you in recent releases since 1.11 is aging now.
>
> Even
>
> >
>
> >
>
> > thanks in advance
>
> >
>
> > Holger
>
> >
>
> >
>
> > mit freundlichen Grüßen
>
> -- 
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>

mit freundlichen Grüßen

-- 
Holger Schiebold


____________________
codematix GmbH
Felsbachstrasse 5/7
D-07745 Jena
Tel. +49 (3641) 3038-34
www.codematix.de

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170313/9e7eebb9/attachment.html>

From nik at nikosalexandris.net  Tue Mar 14 02:01:17 2017
From: nik at nikosalexandris.net (Nikos Alexandris)
Date: Tue, 14 Mar 2017 10:01:17 +0100
Subject: [gdal-dev] [GRASS-user] Slow import of GHSL
In-Reply-To: <CAG+h=FFC5tR2uL6djz=A0_yBOZ=qBy4w-L2MN0iCEwrZ5FMaNg@mail.gmail.com>
References: <20170310164700.GC1715@mail.nikosalexandris.net>
 <CALFmHhtmDr=JAPy26qZNT3Gu=0-y7oYFZNWaa6oAsftWX5VayQ@mail.gmail.com>
 <20170311075300.GA4021@mail.nikosalexandris.net>
 <CAG+h=FFC5tR2uL6djz=A0_yBOZ=qBy4w-L2MN0iCEwrZ5FMaNg@mail.gmail.com>
Message-ID: <20170314090117.GC31180@mail.nikosalexandris.net>

Nikos Alexandris

>>>> Why does (attempting to) import a 38m pixel resolution GHSL [0] GeoTIFF
>>>> layer, ie GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38_v1_0_p1.tif, in GRASS'
>>>> db progress slow?

Markus M

>because it is a very large raster map: Size is 507904, 647168

>> (Apologies for cross-posting to gdal-dev)

Markus Neteler:

>>> Can you elaborate a bit more? I have downloaded and checked:
>>>
>>> That is 9835059101  bytes in 19885 files or I downloaded the wrong one
>>> (please post an URL).
>>
>> For example <http://ghsl.jrc.ec.europa.eu/ghs_bu.php>,
>>
>> see
>>
>> GHS_BUILT_LDS1975_GLOBE_R2016A_3857_38 (768MB)
>GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38 (854MB)
>GHS_BUILT_LDS2000_GLOBE_R2016A_3857_38 (892MB)
>GHS_BUILT_LDS2014_GLOBE_R2016A_3857_38 (900MB)
>>
>> "3857" is the EPSG code.  They are split in two GeoTIFFs (p1, p2) and
>> there is a VRT along with overviews for it.  No overviews for the TIFFs.
>>
>> For example:
>>
>> GHSL_data_access_v1.3.pdf
>> GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38_v1_0.clr
>> GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38_v1_0.vrt
>> GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38_v1_0.vrt.ovr
>> GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38_v1_0_p1.tif
>> GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38_v1_0_p2.tif
>>
>>
>> Even trying to clip, with gdal_translate, might create file(s) of
>> hundreds of GBs. This might be due to missing compression.

>then use compression. The source tiffs use LZW with blocks of 4096x4096
>cells.


>> The import of p1 or p2 or of the VRT file in GRASS' data base, via
>> r.in.gdal/r.import, does not progress at all.

>Importing GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38_v1_0_p1.tif with r.in.gdal
>took 1:31 hours on a laptop with SSD. The resultant cell file was 1.5 GB.
>
>Recompressing with BZIP2 took 2:20 hours and the size of the cell file was
>reduced to a mere 143 MB.

Some messy rough timings:

1) i7, 8 cores, 32GB RAM, Base OS: CentOS -> Three r.in.gdal processes
for "p2.tif", each stuck at 3% for almost 14h

2) Xeon, 24 Cores, 32GB RAM, Base OS: Windows -> Three gdal_translate
processes with -projwin, the VRT file as an input and GeoTIFF as output,
at 40% since yesterday afternoon

3) Xeon, 12 Cores, ? RAM, Base OS: CentOS.jpg -> Same processes as in
1), stuck at 0% of progress for more than 16h.

SSD can be seen as a "necessity".

Nikos

[rest deleted]

From bontepaarden at gmail.com  Tue Mar 14 07:12:20 2017
From: bontepaarden at gmail.com (Paul Meems)
Date: Tue, 14 Mar 2017 15:12:20 +0100
Subject: [gdal-dev] How to use wrapper_GDALRasterizeDestName with C# bindings
Message-ID: <CAHNf2YRpPvHznvXTN3nh8Tydjs0YBLqJHNX7+jLpYfOQOQN_uw@mail.gmail.com>

I'm trying to use this gdal_rasterize command in my C# application:
gdal_rasterize -a DN -a_srs "EPSG:28992" -tr 5 5 -a_nodata 0 -l test
test.shp test.shp

My goal is to convert a shapefile to a tiff-file. The above command does
what I want.
I need to call it from within my C# application.
I'm already successfully using wrapper_GDALTranslate
and wrapper_GDALWarpDestName but I'm struggling
with wrapper_GDALRasterizeDestName.

I have this code:
            using (var ds = Ogr.Open(shapefile, 0)) // 0 means read-only. 1
means writeable.
            {
                if (ds == null)
                {
                    throw new Exception("Can't open OGR dataset: " +
shapefile);
                }
                var gdalOptions = new GDALRasterizeOptions(options);
                using (var newDs =
Gdal.wrapper_GDALRasterizeDestName(output, ds, gdalOptions, null, null))
                {
                    if (newDs == null)
                    {
                        throw new Exception("GdalRasterize failed: " +
Gdal.GetLastErrorMsg());
                    }
                }
                return true;
            }

The problem is with ds, the second parameter of
wrapper_GDALRasterizeDestName. Because it is a shapefile I open it with
Ogr, but a Gdal dataset is expected.
When I open my shapefile with Gdal.Open() I get an error saying my
shapefile is not recognized as a supported file format.

What do I need to do to get this working in my C# application?

Thanks,

Paul
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170314/cbd6ecbf/attachment.html>

From even.rouault at spatialys.com  Tue Mar 14 07:23:40 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 14 Mar 2017 15:23:40 +0100
Subject: [gdal-dev] How to use wrapper_GDALRasterizeDestName with C#
	bindings
In-Reply-To: <CAHNf2YRpPvHznvXTN3nh8Tydjs0YBLqJHNX7+jLpYfOQOQN_uw@mail.gmail.com>
References: <CAHNf2YRpPvHznvXTN3nh8Tydjs0YBLqJHNX7+jLpYfOQOQN_uw@mail.gmail.com>
Message-ID: <1911035.YvPLzUYYWW@even-i700>

On mardi 14 mars 2017 15:12:20 CET Paul Meems wrote:
> I'm trying to use this gdal_rasterize command in my C# application:
> gdal_rasterize -a DN -a_srs "EPSG:28992" -tr 5 5 -a_nodata 0 -l test
> test.shp test.shp
> 
> My goal is to convert a shapefile to a tiff-file. The above command does
> what I want.
> I need to call it from within my C# application.
> I'm already successfully using wrapper_GDALTranslate
> and wrapper_GDALWarpDestName but I'm struggling
> with wrapper_GDALRasterizeDestName.
> 
> I have this code:
>             using (var ds = Ogr.Open(shapefile, 0)) // 0 means read-only. 1
> means writeable.
>             {
>                 if (ds == null)
>                 {
>                     throw new Exception("Can't open OGR dataset: " +
> shapefile);
>                 }
>                 var gdalOptions = new GDALRasterizeOptions(options);
>                 using (var newDs =
> Gdal.wrapper_GDALRasterizeDestName(output, ds, gdalOptions, null, null))
>                 {
>                     if (newDs == null)
>                     {
>                         throw new Exception("GdalRasterize failed: " +
> Gdal.GetLastErrorMsg());
>                     }
>                 }
>                 return true;
>             }
> 
> The problem is with ds, the second parameter of
> wrapper_GDALRasterizeDestName. Because it is a shapefile I open it with
> Ogr, but a Gdal dataset is expected.
> When I open my shapefile with Gdal.Open() I get an error saying my
> shapefile is not recognized as a supported file format.

Use Gdal.OpenEx(). This will allow vector drivers to be used and return a GDAL dataset.

> 
> What do I need to do to get this working in my C# application?
> 
> Thanks,
> 
> Paul


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170314/8bc63b74/attachment.html>

From bontepaarden at gmail.com  Tue Mar 14 07:57:31 2017
From: bontepaarden at gmail.com (Paul Meems)
Date: Tue, 14 Mar 2017 15:57:31 +0100
Subject: [gdal-dev] How to use wrapper_GDALRasterizeDestName with C#
	bindings
In-Reply-To: <1911035.YvPLzUYYWW@even-i700>
References: <CAHNf2YRpPvHznvXTN3nh8Tydjs0YBLqJHNX7+jLpYfOQOQN_uw@mail.gmail.com>
 <1911035.YvPLzUYYWW@even-i700>
Message-ID: <CAHNf2YQRLqGm+xooD7uOOeoPMer1rrE8AGTDdJPBiWRcNUvhgg@mail.gmail.com>

Thanks Even,

I now have
using (var ds = Gdal.OpenEx(input, 1, null, null, null))
I couldn't find GDAL_OF_VECTOR in the C# bindings. I'm assuming it must be
1 since GDAL_OF_RASTER is 0.

It is now working.




Paul

*Paul Meems *
Release manager, configuration manager
and forum moderator of MapWindow GIS.
www.mapwindow.org

Owner of MapWindow.nl - Support for
Dutch speaking users.
www.mapwindow.nl


*The MapWindow GIS project has moved to GitHub
<https://github.com/MapWindow>!*


Download the latest MapWinGIS mapping engine.
<https://github.com/MapWindow/MapWinGIS/releases>

Download the latest MapWindow 5 open source desktop application.
<https://github.com/MapWindow/MapWindow5/releases>

2017-03-14 15:23 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:

> On mardi 14 mars 2017 15:12:20 CET Paul Meems wrote:
>
> > I'm trying to use this gdal_rasterize command in my C# application:
>
> > gdal_rasterize -a DN -a_srs "EPSG:28992" -tr 5 5 -a_nodata 0 -l test
>
> > test.shp test.shp
>
> >
>
> > My goal is to convert a shapefile to a tiff-file. The above command does
>
> > what I want.
>
> > I need to call it from within my C# application.
>
> > I'm already successfully using wrapper_GDALTranslate
>
> > and wrapper_GDALWarpDestName but I'm struggling
>
> > with wrapper_GDALRasterizeDestName.
>
> >
>
> > I have this code:
>
> > using (var ds = Ogr.Open(shapefile, 0)) // 0 means read-only. 1
>
> > means writeable.
>
> > {
>
> > if (ds == null)
>
> > {
>
> > throw new Exception("Can't open OGR dataset: " +
>
> > shapefile);
>
> > }
>
> > var gdalOptions = new GDALRasterizeOptions(options);
>
> > using (var newDs =
>
> > Gdal.wrapper_GDALRasterizeDestName(output, ds, gdalOptions, null, null))
>
> > {
>
> > if (newDs == null)
>
> > {
>
> > throw new Exception("GdalRasterize failed: " +
>
> > Gdal.GetLastErrorMsg());
>
> > }
>
> > }
>
> > return true;
>
> > }
>
> >
>
> > The problem is with ds, the second parameter of
>
> > wrapper_GDALRasterizeDestName. Because it is a shapefile I open it with
>
> > Ogr, but a Gdal dataset is expected.
>
> > When I open my shapefile with Gdal.Open() I get an error saying my
>
> > shapefile is not recognized as a supported file format.
>
>
>
> Use Gdal.OpenEx(). This will allow vector drivers to be used and return a
> GDAL dataset.
>
>
>
> >
>
> > What do I need to do to get this working in my C# application?
>
> >
>
> > Thanks,
>
> >
>
> > Paul
>
>
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170314/4b3b9bb2/attachment-0001.html>

From even.rouault at spatialys.com  Tue Mar 14 08:03:42 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 14 Mar 2017 16:03:42 +0100
Subject: [gdal-dev] How to use wrapper_GDALRasterizeDestName with C#
	bindings
In-Reply-To: <CAHNf2YQRLqGm+xooD7uOOeoPMer1rrE8AGTDdJPBiWRcNUvhgg@mail.gmail.com>
References: <CAHNf2YRpPvHznvXTN3nh8Tydjs0YBLqJHNX7+jLpYfOQOQN_uw@mail.gmail.com>
 <1911035.YvPLzUYYWW@even-i700>
 <CAHNf2YQRLqGm+xooD7uOOeoPMer1rrE8AGTDdJPBiWRcNUvhgg@mail.gmail.com>
Message-ID: <1592190.3DSRELNiWG@even-i700>

On mardi 14 mars 2017 15:57:31 CET Paul Meems wrote:
> Thanks Even,
> 
> I now have
> using (var ds = Gdal.OpenEx(input, 1, null, null, null))
> I couldn't find GDAL_OF_VECTOR in the C# bindings. 

Constants are defined in swig/include/gdalconst.i as:

// Open flags
%constant OF_ALL     = GDAL_OF_ALL;
%constant OF_RASTER = GDAL_OF_RASTER;
%constant OF_VECTOR = GDAL_OF_VECTOR;
%constant OF_GNM = GDAL_OF_GNM;
%constant OF_READONLY = GDAL_OF_READONLY;
%constant OF_UPDATE = GDAL_OF_UPDATE;
%constant OF_SHARED = GDAL_OF_SHARED;
%constant OF_VERBOSE_ERROR = GDAL_OF_VERBOSE_ERROR;


> I'm assuming it must be
> 1 since GDAL_OF_RASTER is 0.


/** Allow raster and vector drivers to be used.
 * Used by GDALOpenEx().
 * @since GDAL 2.0
 */
#define     GDAL_OF_ALL             0x00

/** Allow raster drivers to be used.
 * Used by GDALOpenEx().
 * @since GDAL 2.0
 */
#define     GDAL_OF_RASTER          0x02

/** Allow vector drivers to be used.
 * Used by GDALOpenEx().
 * @since GDAL 2.0
 */
#define     GDAL_OF_VECTOR          0x04


1 is working since :


/** Open in update mode.
 * Used by GDALOpenEx().
 * @since GDAL 2.0
 */
#define     GDAL_OF_UPDATE          0x01


And as no explicit GDAL_OF_RASTER or GDAL_OF_VECTOR  is specified, GDAL_OF_ALL is 
assumed. But you probably don't need/want to open in update mode.

> 
> It is now working.
> 
> 
> 
> 
> Paul
> 
> *Paul Meems *
> Release manager, configuration manager
> and forum moderator of MapWindow GIS.
> www.mapwindow.org
> 
> Owner of MapWindow.nl - Support for
> Dutch speaking users.
> www.mapwindow.nl
> 
> 
> *The MapWindow GIS project has moved to GitHub
> <https://github.com/MapWindow>!*
> 
> 
> Download the latest MapWinGIS mapping engine.
> <https://github.com/MapWindow/MapWinGIS/releases>
> 
> Download the latest MapWindow 5 open source desktop application.
> <https://github.com/MapWindow/MapWindow5/releases>
> 
> 2017-03-14 15:23 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:
> > On mardi 14 mars 2017 15:12:20 CET Paul Meems wrote:
> > > I'm trying to use this gdal_rasterize command in my C# application:
> > > 
> > > gdal_rasterize -a DN -a_srs "EPSG:28992" -tr 5 5 -a_nodata 0 -l test
> > > 
> > > test.shp test.shp
> > > 
> > > 
> > > 
> > > My goal is to convert a shapefile to a tiff-file. The above command does
> > > 
> > > what I want.
> > > 
> > > I need to call it from within my C# application.
> > > 
> > > I'm already successfully using wrapper_GDALTranslate
> > > 
> > > and wrapper_GDALWarpDestName but I'm struggling
> > > 
> > > with wrapper_GDALRasterizeDestName.
> > > 
> > > 
> > > 
> > > I have this code:
> > > 
> > > using (var ds = Ogr.Open(shapefile, 0)) // 0 means read-only. 1
> > > 
> > > means writeable.
> > > 
> > > {
> > > 
> > > if (ds == null)
> > > 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170314/81c3c745/attachment-0001.html>

From nik at nikosalexandris.net  Tue Mar 14 08:17:03 2017
From: nik at nikosalexandris.net (Nikos Alexandris)
Date: Tue, 14 Mar 2017 16:17:03 +0100
Subject: [gdal-dev] [GRASS-user] Slow import of GHSL
In-Reply-To: <CAG+h=FFv7f-z1EM3A3y2qGTW-7=a8-tGzRWG27qFgnZJaQcJMQ@mail.gmail.com>
References: <20170310164700.GC1715@mail.nikosalexandris.net>
 <CALFmHhtmDr=JAPy26qZNT3Gu=0-y7oYFZNWaa6oAsftWX5VayQ@mail.gmail.com>
 <20170311075300.GA4021@mail.nikosalexandris.net>
 <CAG+h=FFC5tR2uL6djz=A0_yBOZ=qBy4w-L2MN0iCEwrZ5FMaNg@mail.gmail.com>
 <20170314090117.GC31180@mail.nikosalexandris.net>
 <CAG+h=FFv7f-z1EM3A3y2qGTW-7=a8-tGzRWG27qFgnZJaQcJMQ@mail.gmail.com>
Message-ID: <20170314151703.GC3770@mail.nikosalexandris.net>

* Markus Metz <markus.metz.giswork at gmail.com> [2017-03-14 15:02:30 +0100]:

>On Tue, Mar 14, 2017 at 10:01 AM, Nikos Alexandris <nik at nikosalexandris.net>
>wrote:
>>
>> Nikos Alexandris
>>
>>>>>> Why does (attempting to) import a 38m pixel resolution GHSL [0]
>GeoTIFF
>>>>>> layer, ie GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38_v1_0_p1.tif, in
>GRASS'
>>>>>> db progress slow?
>>
>>
>> Markus M
>>
>>
>>> because it is a very large raster map: Size is 507904, 647168
>>
>>
>>>> (Apologies for cross-posting to gdal-dev)
>>
>>
>> Markus Neteler:
>>
>>>>> Can you elaborate a bit more? I have downloaded and checked:
>>>>>
>>>>> That is 9835059101  bytes in 19885 files or I downloaded the wrong one
>>>>> (please post an URL).
>>>>
>>>>
>>>> For example <http://ghsl.jrc.ec.europa.eu/ghs_bu.php>,
>>>>
>>>> see
>>>>
>>>> GHS_BUILT_LDS1975_GLOBE_R2016A_3857_38 (768MB)
>>>
>>> GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38 (854MB)
>>> GHS_BUILT_LDS2000_GLOBE_R2016A_3857_38 (892MB)
>>> GHS_BUILT_LDS2014_GLOBE_R2016A_3857_38 (900MB)
>>>>
>>>>
>>>> "3857" is the EPSG code.  They are split in two GeoTIFFs (p1, p2) and
>>>> there is a VRT along with overviews for it.  No overviews for the TIFFs.
>>>>
>>>> For example:
>>>>
>>>> GHSL_data_access_v1.3.pdf
>>>> GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38_v1_0.clr
>>>> GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38_v1_0.vrt
>>>> GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38_v1_0.vrt.ovr
>>>> GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38_v1_0_p1.tif
>>>> GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38_v1_0_p2.tif
>>>>
>>>>
>>>> Even trying to clip, with gdal_translate, might create file(s) of
>>>> hundreds of GBs. This might be due to missing compression.
>>
>>
>>> then use compression. The source tiffs use LZW with blocks of 4096x4096
>>> cells.
>>
>>
>>
>>>> The import of p1 or p2 or of the VRT file in GRASS' data base, via
>>>> r.in.gdal/r.import, does not progress at all.
>>
>>
>>> Importing GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38_v1_0_p1.tif with
>r.in.gdal
>>> took 1:31 hours on a laptop with SSD. The resultant cell file was 1.5 GB.
>>>
>>> Recompressing with BZIP2 took 2:20 hours and the size of the cell file
>was
>>> reduced to a mere 143 MB.
>>
>>
>> Some messy rough timings:
>>
>> 1) i7, 8 cores, 32GB RAM, Base OS: CentOS -> Three r.in.gdal processes
>> for "p2.tif", each stuck at 3% for almost 14h
>>
>> 2) Xeon, 24 Cores, 32GB RAM, Base OS: Windows -> Three gdal_translate
>> processes with -projwin, the VRT file as an input and GeoTIFF as output,
>> at 40% since yesterday afternoon
>>
>> 3) Xeon, 12 Cores, ? RAM, Base OS: CentOS.jpg -> Same processes as in
>> 1), stuck at 0% of progress for more than 16h.
>>
>> SSD can be seen as a "necessity".
>
>Hmm, not really. With the p1 tif and GRASS db on the same spinning HDD, and
>6 other heavy processes constantly reading from and writing to that same
>HDD, r.in.gdal took 2h 13min to import the p1 tif. 360 MB as input and 1.5
>GB as output is not that heavy on disk IO. Most of the time is spent
>decompressing input and compressing output.
>
>Are your r.in.gdal and gdal_translate processes running at nearly 100% CPU?
>Anything slowing down the HDD(s)?
>
>Markus M

Ehm, maybe GDAL version 1.11.4? Just realised!
Working in restricted environment, time spent to configure things.
Will update...

Nikos

From nik at nikosalexandris.net  Tue Mar 14 15:31:34 2017
From: nik at nikosalexandris.net (Nikos Alexandris)
Date: Tue, 14 Mar 2017 23:31:34 +0100
Subject: [gdal-dev] Up-to-date ebuilds for Gentoo/Funtoo-Linux
Message-ID: <20170314223134.GA24081@mail.nikosalexandris.net>

Dear Gentoo/Funtoo users,

I am trying to update/produce OSGeo related ebuilds for Gentoo/Funtoo-Linux.

First attempt at https://github.com/NikosAlexandris/osgeo-overlay/blob/master/sci-libs/gdal/gdal-2.1.3.ebuild.
The ebuild fails to compile if "java mdb" support is requested.

Would someone possibly have a look at
https://github.com/NikosAlexandris/osgeo-overlay/issues/2 and eventually
help out?

Thank you, Nikos

From mateusz at loskot.net  Tue Mar 14 16:37:12 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed, 15 Mar 2017 00:37:12 +0100
Subject: [gdal-dev] [PR] New driver for reading/writing of JPEG XR format
Message-ID: <CABUeae9aPXSzu4sJe8TROMwtEVxA3cD2UmUzR6NiDd0qmysucw@mail.gmail.com>

Hi,

I have just submitted GitHub pull request with new raster driver: JPEGXR
for reading/writing JPEG XR format by Microsoft.
Although the project started as an experiment, the driver is fairly usable.

https://github.com/OSGeo/gdal/pull/203

For more details, please refer to the PR linked above.

I'd highly appreciate reviews, corrections, testing results
as well as improvements to this driver.

Credits go to Frank Warmerdam who pointed me at the JPEG XR
format long time ago.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From schwehr at gmail.com  Tue Mar 14 22:00:16 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Tue, 14 Mar 2017 22:00:16 -0700
Subject: [gdal-dev] [PR] New driver for reading/writing of JPEG XR format
In-Reply-To: <CABUeae9aPXSzu4sJe8TROMwtEVxA3cD2UmUzR6NiDd0qmysucw@mail.gmail.com>
References: <CABUeae9aPXSzu4sJe8TROMwtEVxA3cD2UmUzR6NiDd0qmysucw@mail.gmail.com>
Message-ID: <CACmBxysQdPPsOVVsQS+o29od7adohp9UvTSE-t0uSMbPoyMRzQ@mail.gmail.com>

Mateusz,

I tried to take a quick stab at some initial review comments.  It got
confusing with too many comments in a small section of code.  Sorry.  I'm
not used to reviewing in github.  Hopefully you can follow what I'm getting
at with the comments.

-kurt

On Tue, Mar 14, 2017 at 4:37 PM, Mateusz Loskot <mateusz at loskot.net> wrote:

> Hi,
>
> I have just submitted GitHub pull request with new raster driver: JPEGXR
> for reading/writing JPEG XR format by Microsoft.
> Although the project started as an experiment, the driver is fairly usable.
>
> https://github.com/OSGeo/gdal/pull/203
>
> For more details, please refer to the PR linked above.
>
> I'd highly appreciate reviews, corrections, testing results
> as well as improvements to this driver.
>
> Credits go to Frank Warmerdam who pointed me at the JPEG XR
> format long time ago.
>
> Best regards,
> --
> Mateusz Loskot, http://mateusz.loskot.net
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev




-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170314/3fd17fce/attachment.html>

From nik at nikosalexandris.net  Wed Mar 15 10:03:03 2017
From: nik at nikosalexandris.net (Nikos Alexandris)
Date: Wed, 15 Mar 2017 18:03:03 +0100
Subject: [gdal-dev] [GRASS-user] Slow import of GHSL
In-Reply-To: <CAG+h=FFv7f-z1EM3A3y2qGTW-7=a8-tGzRWG27qFgnZJaQcJMQ@mail.gmail.com>
References: <20170310164700.GC1715@mail.nikosalexandris.net>
 <CALFmHhtmDr=JAPy26qZNT3Gu=0-y7oYFZNWaa6oAsftWX5VayQ@mail.gmail.com>
 <20170311075300.GA4021@mail.nikosalexandris.net>
 <CAG+h=FFC5tR2uL6djz=A0_yBOZ=qBy4w-L2MN0iCEwrZ5FMaNg@mail.gmail.com>
 <20170314090117.GC31180@mail.nikosalexandris.net>
 <CAG+h=FFv7f-z1EM3A3y2qGTW-7=a8-tGzRWG27qFgnZJaQcJMQ@mail.gmail.com>
Message-ID: <20170315170303.GB8004@mail.nikosalexandris.net>


Nikos Alexandris

>>>>>> Why does (attempting to) import a 38m pixel resolution GHSL [0] GeoTIFF
>>>>>> layer, ie GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38_v1_0_p1.tif, in GRASS'
>>>>>> db progress slow?

Markus M:

>>> because it is a very large raster map: Size is 507904, 647168

Markus Neteler:

>>>>> Can you elaborate a bit more? I have downloaded and checked:
>>>>> That is 9835059101  bytes in 19885 files or I downloaded the wrong one
>>>>> (please post an URL).

>>>> For example <http://ghsl.jrc.ec.europa.eu/ghs_bu.php>,
>>>> see
>>>> GHS_BUILT_LDS1975_GLOBE_R2016A_3857_38 (768MB)
>>>> GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38 (854MB)
>>>> GHS_BUILT_LDS2000_GLOBE_R2016A_3857_38 (892MB)
>>>> GHS_BUILT_LDS2014_GLOBE_R2016A_3857_38 (900MB)

>>>> "3857" is the EPSG code.  They are split in two GeoTIFFs (p1, p2) and
>>>> there is a VRT along with overviews for it.  No overviews for the TIFFs.

>>>> For example:
>>>> GHSL_data_access_v1.3.pdf
>>>> GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38_v1_0.clr
>>>> GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38_v1_0.vrt
>>>> GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38_v1_0.vrt.ovr
>>>> GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38_v1_0_p1.tif
>>>> GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38_v1_0_p2.tif
>>>>
>>>> Even trying to clip, with gdal_translate, might create file(s) of
>>>> hundreds of GBs. This might be due to missing compression.

>>> then use compression. The source tiffs use LZW with blocks of 4096x4096
>>> cells.

>>>> The import of p1 or p2 or of the VRT file in GRASS' data base, via
>>>> r.in.gdal/r.import, does not progress at all.

>>> Importing GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38_v1_0_p1.tif with r.in.gdal
>>> took 1:31 hours on a laptop with SSD. The resultant cell file was 1.5 GB.
>>>
>>> Recompressing with BZIP2 took 2:20 hours and the size of the cell file was
>>> reduced to a mere 143 MB.

Nikos:

>> Some messy rough timings:
>>
>> 1) i7, 8 cores, 32GB RAM, Base OS: CentOS -> Three r.in.gdal processes
>> for "p2.tif", each stuck at 3% for almost 14h
>>
>> 2) Xeon, 24 Cores, 32GB RAM, Base OS: Windows -> Three gdal_translate
>> processes with -projwin, the VRT file as an input and GeoTIFF as output,
>> at 40% since yesterday afternoon
>>
>> 3) Xeon, 12 Cores, ? RAM, Base OS: CentOS.jpg -> Same processes as in
>> 1), stuck at 0% of progress for more than 16h.
>>
>> SSD can be seen as a "necessity".
>
Markus Metz:

>Hmm, not really.

In a laptop (i7-4600U CPU @ 2.10GHz with 8GB of RAM with SSD) it was
progressing, in a quite acceptable manner.  I had to break the process,
unfortunately, because I don't have a lot of free space :-/

>With the p1 tif and GRASS db on the same spinning HDD, and
>6 other heavy processes constantly reading from and writing to that same
>HDD, r.in.gdal took 2h 13min to import the p1 tif. 360 MB as input and 1.5
>GB as output is not that heavy on disk IO. Most of the time is spent
>decompressing input and compressing output.

p2 is a harder one!

>Are your r.in.gdal and gdal_translate processes running at nearly 100% CPU?
>Anything slowing down the HDD(s)?

Yes, all processes, in my attempts 2 or 3 in parallel, where constantly
at 100%. RAM was not an issue.

No other heavy process in parallel.  If it matters, working on i3wm and
firefox to browse (webmail, wikis, etc).

Nikos

From mateusz at loskot.net  Wed Mar 15 13:21:24 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed, 15 Mar 2017 21:21:24 +0100
Subject: [gdal-dev] [PR] New driver for reading/writing of JPEG XR format
In-Reply-To: <CACmBxysQdPPsOVVsQS+o29od7adohp9UvTSE-t0uSMbPoyMRzQ@mail.gmail.com>
References: <CABUeae9aPXSzu4sJe8TROMwtEVxA3cD2UmUzR6NiDd0qmysucw@mail.gmail.com>
 <CACmBxysQdPPsOVVsQS+o29od7adohp9UvTSE-t0uSMbPoyMRzQ@mail.gmail.com>
Message-ID: <CABUeae8Ssa-+H8cOUoEs8i=BDJd92rLThveDL=-efU1of0XAZQ@mail.gmail.com>

On 15 March 2017 at 06:00, Kurt Schwehr <schwehr at gmail.com> wrote:
> Mateusz,
>
> I tried to take a quick stab at some initial review comments.  It got
> confusing with too many comments in a small section of code.  Sorry.  I'm
> not used to reviewing in github.  Hopefully you can follow what I'm getting
> at with the comments.

Kurt,

Although I'm familiar with GitHub PRs, comments and line comments [1],
I'm fairly new to the new (sort of) GitHub Reviews [1].
I think I will manage though.

I appreciate your detailed comments.


[1] https://help.github.com/articles/commenting-on-a-pull-request/
[2] https://github.com/blog/2256-a-whole-new-github-universe-announcing-new-tools-forums-and-features


Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From mateusz at loskot.net  Wed Mar 15 13:33:28 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed, 15 Mar 2017 21:33:28 +0100
Subject: [gdal-dev] [PR] New driver for reading/writing of JPEG XR format
In-Reply-To: <CABUeae8Ssa-+H8cOUoEs8i=BDJd92rLThveDL=-efU1of0XAZQ@mail.gmail.com>
References: <CABUeae9aPXSzu4sJe8TROMwtEVxA3cD2UmUzR6NiDd0qmysucw@mail.gmail.com>
 <CACmBxysQdPPsOVVsQS+o29od7adohp9UvTSE-t0uSMbPoyMRzQ@mail.gmail.com>
 <CABUeae8Ssa-+H8cOUoEs8i=BDJd92rLThveDL=-efU1of0XAZQ@mail.gmail.com>
Message-ID: <CABUeae-mJ9ZNo0RFsAisjCK4mYZ=Lz2rujQzKfWs2hYGkZwV3w@mail.gmail.com>

On 15 March 2017 at 21:21, Mateusz Loskot <mateusz at loskot.net> wrote:
> On 15 March 2017 at 06:00, Kurt Schwehr <schwehr at gmail.com> wrote:
>> Mateusz,
>>
>> I tried to take a quick stab at some initial review comments.  It got
>> confusing with too many comments in a small section of code.  Sorry.  I'm
>> not used to reviewing in github.  Hopefully you can follow what I'm getting
>> at with the comments.
>
> Kurt,
>
> Although I'm familiar with GitHub PRs, comments and line comments [1],
> I'm fairly new to the new (sort of) GitHub Reviews [1].
> I think I will manage though.
>
> I appreciate your detailed comments.
>
>
> [1] https://help.github.com/articles/commenting-on-a-pull-request/
> [2] https://github.com/blog/2256-a-whole-new-github-universe-announcing-new-tools-forums-and-features

One more thing I forgot to mention:

I usually tend to submit single-commit pull requests.
If I need to update one, I do `git push -f ...`.
That works well for small/moderate size of PRs.

In this case, I will follow GitHub recommendation [1] to update a PR
with separate/new commits, but not push-forcing.
For example, I'm about to update .travis.yml with libjxr-dev installation in
some of gdal/ci/travis/.../before_install.sh scripts, which I'm going to push
as a new commit.

Any objections to this approach?

[1] https://help.github.com/articles/about-pull-requests/

Best regardsm
-- 
Mateusz Loskot, http://mateusz.loskot.net

From even.rouault at spatialys.com  Wed Mar 15 13:46:15 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 15 Mar 2017 21:46:15 +0100
Subject: [gdal-dev] [PR] New driver for reading/writing of JPEG XR format
In-Reply-To: <CABUeae-mJ9ZNo0RFsAisjCK4mYZ=Lz2rujQzKfWs2hYGkZwV3w@mail.gmail.com>
References: <CABUeae9aPXSzu4sJe8TROMwtEVxA3cD2UmUzR6NiDd0qmysucw@mail.gmail.com>
 <CABUeae8Ssa-+H8cOUoEs8i=BDJd92rLThveDL=-efU1of0XAZQ@mail.gmail.com>
 <CABUeae-mJ9ZNo0RFsAisjCK4mYZ=Lz2rujQzKfWs2hYGkZwV3w@mail.gmail.com>
Message-ID: <8431876.AZMiH1rqTB@even-i700>

> In this case, I will follow GitHub recommendation [1] to update a PR
> with separate/new commits, but not push-forcing.
> For example, I'm about to update .travis.yml with libjxr-dev installation in
> some of gdal/ci/travis/.../before_install.sh scripts, which I'm going to
> push as a new commit.
> 
> Any objections to this approach?

That's fine. Anyway, at some point, when this will go back to SVN, git PR history will 
be lost

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170315/b8c6aba9/attachment.html>

From nik at nikosalexandris.net  Thu Mar 16 03:26:37 2017
From: nik at nikosalexandris.net (Nikos Alexandris)
Date: Thu, 16 Mar 2017 11:26:37 +0100
Subject: [gdal-dev] [GRASS-user] Slow import of GHSL
In-Reply-To: <CAG+h=FGVQq92T6aGXzrDKXt+7Suoh2FvVehKbb0CcAj0iU6eOQ@mail.gmail.com>
References: <20170310164700.GC1715@mail.nikosalexandris.net>
 <CALFmHhtmDr=JAPy26qZNT3Gu=0-y7oYFZNWaa6oAsftWX5VayQ@mail.gmail.com>
 <20170311075300.GA4021@mail.nikosalexandris.net>
 <CAG+h=FFC5tR2uL6djz=A0_yBOZ=qBy4w-L2MN0iCEwrZ5FMaNg@mail.gmail.com>
 <20170314090117.GC31180@mail.nikosalexandris.net>
 <CAG+h=FFv7f-z1EM3A3y2qGTW-7=a8-tGzRWG27qFgnZJaQcJMQ@mail.gmail.com>
 <20170315170303.GB8004@mail.nikosalexandris.net>
 <CAG+h=FGVQq92T6aGXzrDKXt+7Suoh2FvVehKbb0CcAj0iU6eOQ@mail.gmail.com>
Message-ID: <20170316102637.GA6273@mail.nikosalexandris.net>

[..]

Nikos:

>>>> Some messy rough timings:
>>>> 1) i7, 8 cores, 32GB RAM, Base OS: CentOS -> Three r.in.gdal processes
>>>> for "p2.tif", each stuck at 3% for almost 14h
>>>> 2) Xeon, 24 Cores, 32GB RAM, Base OS: Windows -> Three gdal_translate
>>>> processes with -projwin, the VRT file as an input and GeoTIFF as output,
>>>> at 40% since yesterday afternoon
>>>> 3) Xeon, 12 Cores, ? RAM, Base OS: CentOS.jpg -> Same processes as in
>>>> 1), stuck at 0% of progress for more than 16h.
>>>> SSD can be seen as a "necessity".

Markus M:

>>> Hmm, not really.

Nikos:

>> In a laptop (i7-4600U CPU @ 2.10GHz with 8GB of RAM with SSD) it was
>> progressing, in a quite acceptable manner.

Markus M:

> What is the gdal version you used? I use gdal 2.1.3.

Well, yes! 2.1.3 in the laptop, 1.11.4 for the rest.

>>  I had to break the process,
>> unfortunately, because I don't have a lot of free space :-/
>
>maybe because you forgot the enable compression ;-)

I should!

>>> With the p1 tif and GRASS db on the same spinning HDD, and
>>> 6 other heavy processes constantly reading from and writing to that same
>>> HDD, r.in.gdal took 2h 13min to import the p1 tif. 360 MB as input and 1.5
>>> GB as output is not that heavy on disk IO. Most of the time is spent
>>> decompressing input and compressing output.

Is it an 10000rpm disk?

>> p2 is a harder one!
>
>export GDAL_CACHEMAX=10000
>gdal_translate -co "COMPRESS=LZW"
>GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38_v1_0_p2.tif p2_test.tif


I did not emphasize it enough, but cache size was among my questions
initially.  I wrongly assumed that it can't be more than 2047 due to the
reference in <https://grass.osgeo.org/grass72/manuals/r.in.gdal.html>:

--%<---
memory=integer
  ..
  Options: 0-2047
  ..
--->%--

I admit I did not head over to
https://trac.osgeo.org/gdal/wiki/ConfigOptions from where it is implied
that it can be much higher than 2047MB.

Can't r.in.gdal deal with memory=4096 for example (will try)? If yes,
can we update the manual(s)?

Also related?  GTIFF_DIRECT_IO, GTIFF_VIRTUAL_MEM_IO


>finishes in 28 minutes.

Impressive!

>you could try gdal 2.1.3, maybe 2.1.3 has a more efficient cache regarding
>block-wise reading than gdal 1.11.4

Yes, I have to.

Kudos, Nikos

From contact at opendemdata.info  Thu Mar 16 08:57:11 2017
From: contact at opendemdata.info (OpenDEM)
Date: Thu, 16 Mar 2017 16:57:11 +0100
Subject: [gdal-dev]   Transformation of a vertical datum
Message-ID: <002401d29e6d$f91e92c0$eb5bb840$@opendemdata.info>

Hi,

 

I would like to transform the vertical datum EPSG:5730 to EPSG:5621

 

For more information about the European height reference systems have a look
at: http://www.crs-geo.eu/

 

I used gdaltransform, but the z value is not changing:

 

The CRS is identical EPSG:3035: ETRS89 European Lambert Azimuthal Equal
Area.

 

gdaltransform -s_srs EPSG:3035+5730 -t_srs EPSG:3035+5621 < xxx.xyz >
xxx3.xyz

 

xxx.xyz:

4650012.500 1649987.500 332.763

4650037.500 1649987.500 337.635

4650062.500 1649987.500 342.153

 

testepsg "EPSG:4326+5773" à success in both cases
 
 
Best,
 
Martin
 
 

 

 

 

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170316/b6dcd9e8/attachment.html>

From gregory.bataille at gmail.com  Thu Mar 16 09:16:20 2017
From: gregory.bataille at gmail.com (=?UTF-8?Q?Gr=C3=A9gory_Bataille?=)
Date: Thu, 16 Mar 2017 17:16:20 +0100
Subject: [gdal-dev] Help requested: Concurrent read of a GeoTiff
Message-ID: <CACVcCzoQ-oQ6_kBUzquOUEDQydZsLckE4QUZg801UkKE2Nc-ZQ@mail.gmail.com>

Hello all,

Reaching out to the community caused I have failed for the past few days.

*short version*, I'm trying to multithread the gdal2tiles utility, and I'm
getting this

Generating Base Tiles:
ERROR 1: LZWDecode:Wrong length of decoded string: data probably corrupted
at scanline 256
ERROR 1: TIFFReadEncodedTile() failed.
ERROR 1:
/Users/gbataille/Downloads/Project_58704_transparent_mosaic_group1.tif,
band 1: IReadBlock failed at X offset 1, Y offset 0
ERROR 1: GetBlockRef failed at X block offset 1, Y block offset 0
ERROR 1: gba.vrt, band 1: IReadBlock failed at X offset 0, Y offset 0

Any idea?

*Long version*
So I'm trying to add multithreading to gdal2tiles. I know it's possible,
others like
https://gitlab.com/GitLabRGI/geopackage-python/blob/master/Packaging/tiles2gpkg_parallel.py
have done it.
I wanted a slightly different approach where I compute all the tile
coordinates to generate, then I create the tiles one by one in multiple
processes

- I can't see anything that I'm doing very differently from the above
project
- I have confirmed that if I run my code with a pool of one process (still
a sub process, but a single one) then it works as expected
- It fails only when I use more than 1 sub-process, i.e. I guess it's some
concurrent file access that fails.

The trouble is that others have done it, so there is a way :)

Have you seen this error? Does it ring any bells that could point me in the
right direction?

Thanks

---
Gregory Bataille
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170316/c144f11e/attachment-0001.html>

From even.rouault at spatialys.com  Thu Mar 16 09:21:35 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 16 Mar 2017 17:21:35 +0100
Subject: [gdal-dev] Transformation of a vertical datum
In-Reply-To: <002401d29e6d$f91e92c0$eb5bb840$@opendemdata.info>
References: <002401d29e6d$f91e92c0$eb5bb840$@opendemdata.info>
Message-ID: <5789954.RBGOW237T5@even-i700>

On jeudi 16 mars 2017 16:57:11 CET OpenDEM wrote:
> Hi,
> 
> 
> 
> I would like to transform the vertical datum EPSG:5730 to EPSG:5621
> 
> 
> 
> For more information about the European height reference systems have a look
> at: http://www.crs-geo.eu/
> 
> 
> 
> I used gdaltransform, but the z value is not changing:

Yes, I you look at the output of gdalsrsinfo on both SRS, you'll see that there is no explicit 
vertical shift grid mentionned (+geoidgrids=something paramet in proj.4 string). Thus no 
vertical shift is done. So, you should look if there are vertical shift grids betwen EVRF2005 
&/ EVRF2000 and WGS84 ellipsoidal height, so that they can be used with proj.4

$ gdalsrsinfo EPSG:3035+5621

PROJ.4 : '+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 
+towgs84=0,0,0,0,0,0,0 +units=m +vunits=m +no_defs '

OGC WKT :
COMPD_CS["ETRS89 / LAEA Europe + EVRF2007 height",
    PROJCS["ETRS89 / LAEA Europe",
        GEOGCS["ETRS89",
            DATUM["European_Terrestrial_Reference_System_1989",
                SPHEROID["GRS 1980",6378137,298.257222101,
                    AUTHORITY["EPSG","7019"]],
                TOWGS84[0,0,0,0,0,0,0],
                AUTHORITY["EPSG","6258"]],
            PRIMEM["Greenwich",0,
                AUTHORITY["EPSG","8901"]],
            UNIT["degree",0.0174532925199433,
                AUTHORITY["EPSG","9122"]],
            AUTHORITY["EPSG","4258"]],
        PROJECTION["Lambert_Azimuthal_Equal_Area"],
        PARAMETER["latitude_of_center",52],
        PARAMETER["longitude_of_center",10],
        PARAMETER["false_easting",4321000],
        PARAMETER["false_northing",3210000],
        UNIT["metre",1,
            AUTHORITY["EPSG","9001"]],
        AUTHORITY["EPSG","3035"]],
    VERT_CS["EVRF2007 height",
        VERT_DATUM["European Vertical Reference Frame 2007",2005,
            AUTHORITY["EPSG","5215"]],
        UNIT["metre",1,
            AUTHORITY["EPSG","9001"]],
        AXIS["Up",UP],
        AUTHORITY["EPSG","5621"]]]

On the contrary :

$ gdalsrsinfo EPSG:3035+5773

PROJ.4 : '+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 
+towgs84=0,0,0,0,0,0,0 +units=m +geoidgrids=egm96_15.gtx +vunits=m +no_defs '

OGC WKT :
COMPD_CS["ETRS89 / LAEA Europe + EGM96 geoid height",
    PROJCS["ETRS89 / LAEA Europe",
        GEOGCS["ETRS89",
            DATUM["European_Terrestrial_Reference_System_1989",
                SPHEROID["GRS 1980",6378137,298.257222101,
                    AUTHORITY["EPSG","7019"]],
                TOWGS84[0,0,0,0,0,0,0],
                AUTHORITY["EPSG","6258"]],
            PRIMEM["Greenwich",0,
                AUTHORITY["EPSG","8901"]],
            UNIT["degree",0.0174532925199433,
                AUTHORITY["EPSG","9122"]],
            AUTHORITY["EPSG","4258"]],
        PROJECTION["Lambert_Azimuthal_Equal_Area"],
        PARAMETER["latitude_of_center",52],
        PARAMETER["longitude_of_center",10],
        PARAMETER["false_easting",4321000],
        PARAMETER["false_northing",3210000],
        UNIT["metre",1,
            AUTHORITY["EPSG","9001"]],
        AUTHORITY["EPSG","3035"]],
    VERT_CS["EGM96 geoid height",
        VERT_DATUM["EGM96 geoid",2005,
            EXTENSION["PROJ4_GRIDS","egm96_15.gtx"],
            AUTHORITY["EPSG","5171"]],
        UNIT["metre",1,
            AUTHORITY["EPSG","9001"]],
        AXIS["Up",UP],
        AUTHORITY["EPSG","5773"]]]

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170316/b05abe6a/attachment.html>

From even.rouault at spatialys.com  Thu Mar 16 09:23:29 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 16 Mar 2017 17:23:29 +0100
Subject: [gdal-dev] Help requested: Concurrent read of a GeoTiff
In-Reply-To: <CACVcCzoQ-oQ6_kBUzquOUEDQydZsLckE4QUZg801UkKE2Nc-ZQ@mail.gmail.com>
References: <CACVcCzoQ-oQ6_kBUzquOUEDQydZsLckE4QUZg801UkKE2Nc-ZQ@mail.gmail.com>
Message-ID: <10289660.qZLtJVveB6@even-i700>

On jeudi 16 mars 2017 17:16:20 CET Grégory Bataille wrote:
> Hello all,
> 
> Reaching out to the community caused I have failed for the past few days.
> 
> *short version*, I'm trying to multithread the gdal2tiles utility, and I'm
> getting this
> 
> Generating Base Tiles:
> ERROR 1: LZWDecode:Wrong length of decoded string: data probably corrupted
> at scanline 256
> ERROR 1: TIFFReadEncodedTile() failed.
> ERROR 1:
> /Users/gbataille/Downloads/Project_58704_transparent_mosaic_group1.tif,
> band 1: IReadBlock failed at X offset 1, Y offset 0
> ERROR 1: GetBlockRef failed at X block offset 1, Y block offset 0
> ERROR 1: gba.vrt, band 1: IReadBlock failed at X offset 0, Y offset 0
> 
> Any idea?

Yes, you need one dataset object per thread . Dataset objects cannot be used 
simultaneously from several threads.

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170316/31c9ca02/attachment-0001.html>

From vladimir.sandoval at yandex.com  Thu Mar 16 11:00:36 2017
From: vladimir.sandoval at yandex.com (Vlad)
Date: Thu, 16 Mar 2017 11:00:36 -0700 (MST)
Subject: [gdal-dev] Gdal Java - Translate creates indestructible file
Message-ID: <1489687236562-5312723.post@n6.nabble.com>

Almost indestructable.

Making a .png thumbnail...

public String produceThumbnail(Dataset ds, Path tempPath)
{
        Vector<String> optionsVector = new Vector<>();
        optionsVector.add("-of");
        optionsVector.add("PNG");
        optionsVector.add("-outsize");
        optionsVector.add("128");
        optionsVector.add("128");
        TranslateOptions options = new TranslateOptions(optionsVector);

        try
        {
            String name = tempPath + "/" + String.format("%s.%s",
RandomStringUtils.randomAlphanumeric(16), "png");
            org.gdal.gdal.gdal.Translate(name, ds, options);
            tmpFile = new File(name);
            if (tmpFile.exists())
            {
                //read in bytes to Base64 encoded String
                FileUtils.forceDelete(tempPath.toFile());
            }
        }
        catch(Exception ex)
        {
            ex.printStackTrace();
        }
        return theString;
}

It creates two files, a .png and a .png.aux.xml, and they are in the temp
directory passed in by tempPath.
NOTHING I try will delete the .png.  The FileUtils.forceDelete() does remove
the .png.aux.xml files, but not the .png, and hence, not the directory.  Any
deleteOnExit() does not remove anything.  I think I've tried every way there
is to delete a file in Java.

Is it possible the Translate() method is not closing a Stream somewhere?


V



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Gdal-Java-Translate-creates-indestructible-file-tp5312723.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Thu Mar 16 11:05:01 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 16 Mar 2017 19:05:01 +0100
Subject: [gdal-dev] Gdal Java - Translate creates indestructible file
In-Reply-To: <1489687236562-5312723.post@n6.nabble.com>
References: <1489687236562-5312723.post@n6.nabble.com>
Message-ID: <2931235.rDFxqTkkye@even-i700>

> Is it possible the Translate() method is not closing a Stream 
somewhere?

Absolutely, it returns a valid Dataset object, and thus (on 
Windows, you are on Windows I guess), you need to close it with 
.delete() explicitly to release the file handle it owns.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170316/a6df44a5/attachment.html>

From vladimir.sandoval at yandex.com  Thu Mar 16 11:09:03 2017
From: vladimir.sandoval at yandex.com (Vlad)
Date: Thu, 16 Mar 2017 11:09:03 -0700 (MST)
Subject: [gdal-dev] Gdal Java - Translate creates indestructible file
In-Reply-To: <2931235.rDFxqTkkye@even-i700>
References: <1489687236562-5312723.post@n6.nabble.com>
 <2931235.rDFxqTkkye@even-i700>
Message-ID: <1489687743391-5312726.post@n6.nabble.com>

My bad, was trying to save a variable declaration.

Thanks.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Gdal-Java-Translate-creates-indestructible-file-tp5312723p5312726.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From gregory.bataille at gmail.com  Thu Mar 16 11:45:03 2017
From: gregory.bataille at gmail.com (=?UTF-8?Q?Gr=C3=A9gory_Bataille?=)
Date: Thu, 16 Mar 2017 18:45:03 +0000
Subject: [gdal-dev] Help requested: Concurrent read of a GeoTiff
In-Reply-To: <10289660.qZLtJVveB6@even-i700>
References: <CACVcCzoQ-oQ6_kBUzquOUEDQydZsLckE4QUZg801UkKE2Nc-ZQ@mail.gmail.com>
 <10289660.qZLtJVveB6@even-i700>
Message-ID: <CACVcCzqFMZW6idGM6h03crkUiSeKAyfZcSLe6sdobtKPeCteQg@mail.gmail.com>

Does that mean a different vrt file or simply reopen the file to create a
gdal object in each process. Because I'm reopening the vrt file in each
thread


On Thu, 16 Mar 2017 at 17:23, Even Rouault <even.rouault at spatialys.com>
wrote:

> On jeudi 16 mars 2017 17:16:20 CET Grégory Bataille wrote:
>
> > Hello all,
>
> >
>
> > Reaching out to the community caused I have failed for the past few days.
>
> >
>
> > *short version*, I'm trying to multithread the gdal2tiles utility, and
> I'm
>
> > getting this
>
> >
>
> > Generating Base Tiles:
>
> > ERROR 1: LZWDecode:Wrong length of decoded string: data probably
> corrupted
>
> > at scanline 256
>
> > ERROR 1: TIFFReadEncodedTile() failed.
>
> > ERROR 1:
>
> > /Users/gbataille/Downloads/Project_58704_transparent_mosaic_group1.tif,
>
> > band 1: IReadBlock failed at X offset 1, Y offset 0
>
> > ERROR 1: GetBlockRef failed at X block offset 1, Y block offset 0
>
> > ERROR 1: gba.vrt, band 1: IReadBlock failed at X offset 0, Y offset 0
>
> >
>
> > Any idea?
>
>
>
> Yes, you need one dataset object per thread . Dataset objects cannot be
> used simultaneously from several threads.
>
>
>
> Even
>
>
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
-- 
Greg
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170316/19ce454a/attachment.html>

From even.rouault at spatialys.com  Thu Mar 16 11:58:45 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 16 Mar 2017 19:58:45 +0100
Subject: [gdal-dev] Help requested: Concurrent read of a GeoTiff
In-Reply-To: <CACVcCzqFMZW6idGM6h03crkUiSeKAyfZcSLe6sdobtKPeCteQg@mail.gmail.com>
References: <CACVcCzoQ-oQ6_kBUzquOUEDQydZsLckE4QUZg801UkKE2Nc-ZQ@mail.gmail.com>
 <10289660.qZLtJVveB6@even-i700>
 <CACVcCzqFMZW6idGM6h03crkUiSeKAyfZcSLe6sdobtKPeCteQg@mail.gmail.com>
Message-ID: <4333940.VGofk2aMDf@even-i700>

On jeudi 16 mars 2017 18:45:03 CET Grégory Bataille wrote:
> Does that mean a different vrt file or simply reopen the file to create a
> gdal object in each process. Because I'm reopening the vrt file in each
> thread

Ah, that must be issue of
http://gdal.org/gdal_vrttut.html#gdal_vrttut_mt

Try defining
gdal.SetConfigOption('VRT_SHARED_SOURCE', '0')
before opening the VRTs

> 
> 
> On Thu, 16 Mar 2017 at 17:23, Even Rouault <even.rouault at spatialys.com>
> 
> wrote:
> > On jeudi 16 mars 2017 17:16:20 CET Grégory Bataille wrote:
> > > Hello all,
> > > 
> > > 
> > > 
> > > Reaching out to the community caused I have failed for the past few
> > > days.
> > > 
> > > 
> > > 
> > > *short version*, I'm trying to multithread the gdal2tiles utility, and
> > 
> > I'm
> > 
> > > getting this
> > > 
> > > 
> > > 
> > > Generating Base Tiles:
> > > 
> > > ERROR 1: LZWDecode:Wrong length of decoded string: data probably
> > 
> > corrupted
> > 
> > > at scanline 256
> > > 
> > > ERROR 1: TIFFReadEncodedTile() failed.
> > > 
> > > ERROR 1:
> > > 
> > > /Users/gbataille/Downloads/Project_58704_transparent_mosaic_group1.tif,
> > > 
> > > band 1: IReadBlock failed at X offset 1, Y offset 0
> > > 
> > > ERROR 1: GetBlockRef failed at X block offset 1, Y block offset 0
> > > 
> > > ERROR 1: gba.vrt, band 1: IReadBlock failed at X offset 0, Y offset 0
> > > 
> > > 
> > > 
> > > Any idea?
> > 
> > Yes, you need one dataset object per thread . Dataset objects cannot be
> > used simultaneously from several threads.
> > 
> > 
> > 
> > Even
> > 
> > 
> > 
> > 
> > 
> > --
> > 
> > Spatialys - Geospatial professional services
> > 
> > http://www.spatialys.com


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170316/e10eec42/attachment-0001.html>

From jukka.rahkonen at maanmittauslaitos.fi  Thu Mar 16 14:45:09 2017
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Thu, 16 Mar 2017 21:45:09 +0000
Subject: [gdal-dev] GeoPackege, views and spatial index
Message-ID: <1489700711476.84723@maanmittauslaitos.fi>

Hi,

I can create a spatial view into GeoPackage database by following the document http://www.geopackage.org/modeling_guidelines.html and I can open such a view with QGIS. But have I understood right that there is no way in GeoPackage to link the R-Tree spatial index of the main table with the view? In Spatialite it is possible via the views_geometry_columns table but I can't find anything like that from the GeoPackage specification. I wonder if GDAL and QGIS could have support for same kind of linking metadata table than Spatialite.

-Jukka Rahkonen-

From even.rouault at spatialys.com  Thu Mar 16 16:38:01 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 17 Mar 2017 00:38:01 +0100
Subject: [gdal-dev] GeoPackege, views and spatial index
In-Reply-To: <1489700711476.84723@maanmittauslaitos.fi>
References: <1489700711476.84723@maanmittauslaitos.fi>
Message-ID: <1750230.bbiCaV8Zde@even-i700>

On jeudi 16 mars 2017 21:45:09 CET Rahkonen Jukka (MML) wrote:
> Hi,
> 
> I can create a spatial view into GeoPackage database by following the
> document http://www.geopackage.org/modeling_guidelines.html and I can open
> such a view with QGIS. But have I understood right that there is no way in
> GeoPackage to link the R-Tree spatial index of the main table with the
> view? In Spatialite it is possible via the views_geometry_columns table but
> I can't find anything like that from the GeoPackage specification. I wonder
> if GDAL and QGIS could have support for same kind of linking metadata table
> than Spatialite.

I've just committed code to automatically figures out if a view refers to the FID and geom 
column of a table that has a spatial index, and in that case to use it. This however requires 
SQLite to be compiled with  -DSQLITE_ENABLE_COLUMN_METADATA. On Linux, GDAL 
automatically detects if this is available. On Windows, 
SQLITE_HAS_COLUMN_METADATA=yes must be manually defined in nmake.opt.

I see Tamas' build don't have SQLITE_HAS_COLUMN_METADATA=yes enabled, althoug the 
sqlite3.dll has been compiled in that mode.
I've opened https://github.com/gisinternals/buildsystem/issues/106 on this.

@jef
Looking at OSGeo4W, the situation is a bit different since it seems that the sqlite3.dll is not 
built with -DSQLITE_ENABLE_COLUMN_METADATA 
I've created https://trac.osgeo.org/osgeo4w/ticket/524#ticket for that

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170317/898b613b/attachment.html>

From neteler at osgeo.org  Thu Mar 16 16:39:11 2017
From: neteler at osgeo.org (Markus Neteler)
Date: Fri, 17 Mar 2017 00:39:11 +0100
Subject: [gdal-dev] [GRASS-user] Slow import of GHSL
In-Reply-To: <20170316102637.GA6273@mail.nikosalexandris.net>
References: <20170310164700.GC1715@mail.nikosalexandris.net>
 <CALFmHhtmDr=JAPy26qZNT3Gu=0-y7oYFZNWaa6oAsftWX5VayQ@mail.gmail.com>
 <20170311075300.GA4021@mail.nikosalexandris.net>
 <CAG+h=FFC5tR2uL6djz=A0_yBOZ=qBy4w-L2MN0iCEwrZ5FMaNg@mail.gmail.com>
 <20170314090117.GC31180@mail.nikosalexandris.net>
 <CAG+h=FFv7f-z1EM3A3y2qGTW-7=a8-tGzRWG27qFgnZJaQcJMQ@mail.gmail.com>
 <20170315170303.GB8004@mail.nikosalexandris.net>
 <CAG+h=FGVQq92T6aGXzrDKXt+7Suoh2FvVehKbb0CcAj0iU6eOQ@mail.gmail.com>
 <20170316102637.GA6273@mail.nikosalexandris.net>
Message-ID: <CALFmHhtvxueNBeb5LWxFTYXgR2PoMDnpSXGrRjfsMSefTxPu8A@mail.gmail.com>

On Mar 16, 2017 11:26 AM, "Nikos Alexandris" <nik at nikosalexandris.net>
wrote:
...

>>> unfortunately, because I don't have a lot of free space :-/
>>
>>
>> maybe because you forgot the enable compression ;-)
>
>
> I should!

Remember that you have to explicitly switch on the NULL compression:

https://grass.osgeo.org/grass72/manuals/rasterintro.html#raster-compression

Best
markusN
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170317/81e1bf83/attachment.html>

From gregory.bataille at gmail.com  Thu Mar 16 22:15:43 2017
From: gregory.bataille at gmail.com (=?UTF-8?Q?Gr=C3=A9gory_Bataille?=)
Date: Fri, 17 Mar 2017 06:15:43 +0100
Subject: [gdal-dev] Help requested: Concurrent read of a GeoTiff
In-Reply-To: <4333940.VGofk2aMDf@even-i700>
References: <CACVcCzoQ-oQ6_kBUzquOUEDQydZsLckE4QUZg801UkKE2Nc-ZQ@mail.gmail.com>
 <10289660.qZLtJVveB6@even-i700>
 <CACVcCzqFMZW6idGM6h03crkUiSeKAyfZcSLe6sdobtKPeCteQg@mail.gmail.com>
 <4333940.VGofk2aMDf@even-i700>
Message-ID: <CACVcCzrHSqT08x6bUQRurRR=mx-9xsYbxCTd6LzyXSq1uqs=jw@mail.gmail.com>

no luck.
I tried this config.
I also tried (with this config) to do a copy of the vrt file (with shell
utility, not gdal) in each thread before opening it (still goes to the same
TIFF file though), but no luck.

But at least now that you confirm that it's related to concurrent reads, I
have something precise to search for. I'll try to investigate how the
gdal2tiles_parallel does it because it did not look different than what I
was doing, but likely I missed something.

Thanks


---
Gregory Bataille

On Thu, Mar 16, 2017 at 7:58 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> On jeudi 16 mars 2017 18:45:03 CET Grégory Bataille wrote:
>
> > Does that mean a different vrt file or simply reopen the file to create a
>
> > gdal object in each process. Because I'm reopening the vrt file in each
>
> > thread
>
>
>
> Ah, that must be issue of
>
> http://gdal.org/gdal_vrttut.html#gdal_vrttut_mt
>
>
>
> Try defining
>
> gdal.SetConfigOption('VRT_SHARED_SOURCE', '0')
>
> before opening the VRTs
>
>
>
> >
>
> >
>
> > On Thu, 16 Mar 2017 at 17:23, Even Rouault <even.rouault at spatialys.com>
>
> >
>
> > wrote:
>
> > > On jeudi 16 mars 2017 17:16:20 CET Grégory Bataille wrote:
>
> > > > Hello all,
>
> > > >
>
> > > >
>
> > > >
>
> > > > Reaching out to the community caused I have failed for the past few
>
> > > > days.
>
> > > >
>
> > > >
>
> > > >
>
> > > > *short version*, I'm trying to multithread the gdal2tiles utility,
> and
>
> > >
>
> > > I'm
>
> > >
>
> > > > getting this
>
> > > >
>
> > > >
>
> > > >
>
> > > > Generating Base Tiles:
>
> > > >
>
> > > > ERROR 1: LZWDecode:Wrong length of decoded string: data probably
>
> > >
>
> > > corrupted
>
> > >
>
> > > > at scanline 256
>
> > > >
>
> > > > ERROR 1: TIFFReadEncodedTile() failed.
>
> > > >
>
> > > > ERROR 1:
>
> > > >
>
> > > > /Users/gbataille/Downloads/Project_58704_transparent_
> mosaic_group1.tif,
>
> > > >
>
> > > > band 1: IReadBlock failed at X offset 1, Y offset 0
>
> > > >
>
> > > > ERROR 1: GetBlockRef failed at X block offset 1, Y block offset 0
>
> > > >
>
> > > > ERROR 1: gba.vrt, band 1: IReadBlock failed at X offset 0, Y offset 0
>
> > > >
>
> > > >
>
> > > >
>
> > > > Any idea?
>
> > >
>
> > > Yes, you need one dataset object per thread . Dataset objects cannot be
>
> > > used simultaneously from several threads.
>
> > >
>
> > >
>
> > >
>
> > > Even
>
> > >
>
> > >
>
> > >
>
> > >
>
> > >
>
> > > --
>
> > >
>
> > > Spatialys - Geospatial professional services
>
> > >
>
> > > http://www.spatialys.com
>
>
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170317/0f90ed2d/attachment-0001.html>

From nik at nikosalexandris.net  Fri Mar 17 03:11:40 2017
From: nik at nikosalexandris.net (Nikos Alexandris)
Date: Fri, 17 Mar 2017 11:11:40 +0100
Subject: [gdal-dev] [GRASS-user] Slow import of GHSL
In-Reply-To: <CAG+h=FEF=Z0-vOn8NXOgWdTpK0pBRDAD=Y8jOKGKrdy9p4GXWQ@mail.gmail.com>
References: <20170310164700.GC1715@mail.nikosalexandris.net>
 <CALFmHhtmDr=JAPy26qZNT3Gu=0-y7oYFZNWaa6oAsftWX5VayQ@mail.gmail.com>
 <20170311075300.GA4021@mail.nikosalexandris.net>
 <CAG+h=FFC5tR2uL6djz=A0_yBOZ=qBy4w-L2MN0iCEwrZ5FMaNg@mail.gmail.com>
 <20170314090117.GC31180@mail.nikosalexandris.net>
 <CAG+h=FFv7f-z1EM3A3y2qGTW-7=a8-tGzRWG27qFgnZJaQcJMQ@mail.gmail.com>
 <20170315170303.GB8004@mail.nikosalexandris.net>
 <CAG+h=FGVQq92T6aGXzrDKXt+7Suoh2FvVehKbb0CcAj0iU6eOQ@mail.gmail.com>
 <20170316102637.GA6273@mail.nikosalexandris.net>
 <CAG+h=FEF=Z0-vOn8NXOgWdTpK0pBRDAD=Y8jOKGKrdy9p4GXWQ@mail.gmail.com>
Message-ID: <20170317101140.GB12377@mail.nikosalexandris.net>

* Markus Metz <markus.metz.giswork at gmail.com> [2017-03-16 22:06:12 +0100]:

>On Thu, Mar 16, 2017 at 11:26 AM, Nikos Alexandris <nik at nikosalexandris.net>
>wrote:
>>
>[...]
>>
>>>>> With the p1 tif and GRASS db on the same spinning HDD, and
>>>>> 6 other heavy processes constantly reading from and writing to that
>same
>>>>> HDD, r.in.gdal took 2h 13min to import the p1 tif. 360 MB as input and
>1.5
>>>>> GB as output is not that heavy on disk IO. Most of the time is spent
>>>>> decompressing input and compressing output.
>>
>>
>> Is it an 10000rpm disk?
>
>I think you are on the wrong track, disk IO does not matter here. It was a
>7200rpm disk, and the output of r.in.gdal was about 1.5 GB. It takes only
>seconds, not hours to write 1.5 GB to a HDD.
>
>>
>>>> p2 is a harder one!
>>>
>>>
>>> export GDAL_CACHEMAX=10000
>>> gdal_translate -co "COMPRESS=LZW"
>>> GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38_v1_0_p2.tif p2_test.tif
>
>> Also related?  GTIFF_DIRECT_IO, GTIFF_VIRTUAL_MEM_IO
>
>Again, I think you are on the wrong track, disk IO does not matter here.
>And according to the GDAL documentation, GTIFF_DIRECT_IO,
>GTIFF_VIRTUAL_MEM_IO apply only to reading un-compressed TIFF files.
>
>>
>>> finishes in 28 minutes.
>>
>> Impressive!
>
>Hardware does not really matter here. To be precise, the difference between
>GDAL 1.11.4 and 2.1.3 is impressive, thanks to the efforts of the GDAL
>development team.
>
>Regarding GDAL 2.1.3, profiling might tell why gdal_translate is so much
>faster than GRASS r.in.gdal.

Thanks Markus.  Yes, on the wrong track.  Useful lessons learned.

Nikos

ps- Working in a restricted environment (as in: I cannot install
whatsoever I need) is not easy.- Sure, I can possibly use a VM or
similar...

From lukepinnerau at gmail.com  Fri Mar 17 04:25:44 2017
From: lukepinnerau at gmail.com (Luke)
Date: Fri, 17 Mar 2017 04:25:44 -0700 (MST)
Subject: [gdal-dev] VRT derived raster bands Error
In-Reply-To: <1489489670805-5312218.post@n6.nabble.com>
References: <1489489670805-5312218.post@n6.nabble.com>
Message-ID: <1489749944875-5312821.post@n6.nabble.com>

According to the  VRT Tutorial
<http://www.gdal.org/gdal_vrttut.html#gdal_vrttut_derived_python>  , this
functionality is available from GDAL 2.2 on. GDAL 2.2 has not been released
yet. 



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/VRT-derived-raster-bands-Error-tp5312218p5312821.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Fri Mar 17 04:38:02 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 17 Mar 2017 12:38:02 +0100
Subject: [gdal-dev] VRT derived raster bands Error
In-Reply-To: <1489749944875-5312821.post@n6.nabble.com>
References: <1489489670805-5312218.post@n6.nabble.com>
 <1489749944875-5312821.post@n6.nabble.com>
Message-ID: <1795865.ibRbaAGJKU@even-i700>

On vendredi 17 mars 2017 04:25:44 CET Luke wrote:
> According to the  VRT Tutorial
> <http://www.gdal.org/gdal_vrttut.html#gdal_vrttut_derived_python>  , this
> functionality is available from GDAL 2.2 on. GDAL 2.2 has not been released
> yet.

You don't need to wait for the release that should occur in May probably.
Just grab the sources of the trunk (2.2.0dev) and build it :
https://trac.osgeo.org/gdal/wiki/DownloadSource#Developmentversionandsourcecontrol

Or if you are on Windows :
http://gisinternals.com/development.php
or gdal-dev package on OSGeo4W.

> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/VRT-derived-raster-bands-Error-tp531221
> 8p5312821.html Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170317/0f5daf5f/attachment.html>

From contact at opendemdata.info  Mon Mar 20 13:03:55 2017
From: contact at opendemdata.info (OpenDEM)
Date: Mon, 20 Mar 2017 21:03:55 +0100
Subject: [gdal-dev] Transformation of a vertical datum
In-Reply-To: <5789954.RBGOW237T5@even-i700>
References: <002401d29e6d$f91e92c0$eb5bb840$@opendemdata.info>
 <5789954.RBGOW237T5@even-i700>
Message-ID: <000801d2a1b5$1a9b17d0$4fd14770$@opendemdata.info>

Hi Even,

 

Thanks for your reply.

 

Unfortunately there are no shift grids available yet, but I contacted
CRS-EU.

They want to discuss this topic at the next EUREF meeting.

 

Best,

 

Martin

 

From: Even Rouault [mailto:even.rouault at spatialys.com] 
Sent: Donnerstag, 16. März 2017 17:22
To: gdal-dev at lists.osgeo.org
Cc: OpenDEM
Subject: Re: [gdal-dev] Transformation of a vertical datum

 

On jeudi 16 mars 2017 16:57:11 CET OpenDEM wrote:

> Hi,

> 

> 

> 

> I would like to transform the vertical datum EPSG:5730 to EPSG:5621

> 

> 

> 

> For more information about the European height reference systems have a
look

> at:  <http://www.crs-geo.eu/> http://www.crs-geo.eu/

> 

> 

> 

> I used gdaltransform, but the z value is not changing:

 

Yes, I you look at the output of gdalsrsinfo on both SRS, you'll see that
there is no explicit vertical shift grid mentionned (+geoidgrids=something
paramet in proj.4 string). Thus no vertical shift is done. So, you should
look if there are vertical shift grids betwen EVRF2005 &/ EVRF2000 and WGS84
ellipsoidal height, so that they can be used with proj.4

 

$ gdalsrsinfo EPSG:3035+5621

 

PROJ.4 : '+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000
+ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +vunits=m +no_defs '

 

OGC WKT :

COMPD_CS["ETRS89 / LAEA Europe + EVRF2007 height",

PROJCS["ETRS89 / LAEA Europe",

GEOGCS["ETRS89",

DATUM["European_Terrestrial_Reference_System_1989",

SPHEROID["GRS 1980",6378137,298.257222101,

AUTHORITY["EPSG","7019"]],

TOWGS84[0,0,0,0,0,0,0],

AUTHORITY["EPSG","6258"]],

PRIMEM["Greenwich",0,

AUTHORITY["EPSG","8901"]],

UNIT["degree",0.0174532925199433,

AUTHORITY["EPSG","9122"]],

AUTHORITY["EPSG","4258"]],

PROJECTION["Lambert_Azimuthal_Equal_Area"],

PARAMETER["latitude_of_center",52],

PARAMETER["longitude_of_center",10],

PARAMETER["false_easting",4321000],

PARAMETER["false_northing",3210000],

UNIT["metre",1,

AUTHORITY["EPSG","9001"]],

AUTHORITY["EPSG","3035"]],

VERT_CS["EVRF2007 height",

VERT_DATUM["European Vertical Reference Frame 2007",2005,

AUTHORITY["EPSG","5215"]],

UNIT["metre",1,

AUTHORITY["EPSG","9001"]],

AXIS["Up",UP],

AUTHORITY["EPSG","5621"]]]

 

On the contrary :

 

$ gdalsrsinfo EPSG:3035+5773

 

PROJ.4 : '+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000
+ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +geoidgrids=egm96_15.gtx
+vunits=m +no_defs '

 

OGC WKT :

COMPD_CS["ETRS89 / LAEA Europe + EGM96 geoid height",

PROJCS["ETRS89 / LAEA Europe",

GEOGCS["ETRS89",

DATUM["European_Terrestrial_Reference_System_1989",

SPHEROID["GRS 1980",6378137,298.257222101,

AUTHORITY["EPSG","7019"]],

TOWGS84[0,0,0,0,0,0,0],

AUTHORITY["EPSG","6258"]],

PRIMEM["Greenwich",0,

AUTHORITY["EPSG","8901"]],

UNIT["degree",0.0174532925199433,

AUTHORITY["EPSG","9122"]],

AUTHORITY["EPSG","4258"]],

PROJECTION["Lambert_Azimuthal_Equal_Area"],

PARAMETER["latitude_of_center",52],

PARAMETER["longitude_of_center",10],

PARAMETER["false_easting",4321000],

PARAMETER["false_northing",3210000],

UNIT["metre",1,

AUTHORITY["EPSG","9001"]],

AUTHORITY["EPSG","3035"]],

VERT_CS["EGM96 geoid height",

VERT_DATUM["EGM96 geoid",2005,

EXTENSION["PROJ4_GRIDS","egm96_15.gtx"],

AUTHORITY["EPSG","5171"]],

UNIT["metre",1,

AUTHORITY["EPSG","9001"]],

AXIS["Up",UP],

AUTHORITY["EPSG","5773"]]]

 

Even

 

 

-- 

Spatialys - Geospatial professional services

http://www.spatialys.com

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170320/636cad96/attachment-0001.html>

From gregory.bataille at gmail.com  Mon Mar 20 21:51:18 2017
From: gregory.bataille at gmail.com (=?UTF-8?Q?Gr=C3=A9gory_Bataille?=)
Date: Tue, 21 Mar 2017 05:51:18 +0100
Subject: [gdal-dev] Help requested: Concurrent read of a GeoTiff
In-Reply-To: <CACVcCzrHSqT08x6bUQRurRR=mx-9xsYbxCTd6LzyXSq1uqs=jw@mail.gmail.com>
References: <CACVcCzoQ-oQ6_kBUzquOUEDQydZsLckE4QUZg801UkKE2Nc-ZQ@mail.gmail.com>
 <10289660.qZLtJVveB6@even-i700>
 <CACVcCzqFMZW6idGM6h03crkUiSeKAyfZcSLe6sdobtKPeCteQg@mail.gmail.com>
 <4333940.VGofk2aMDf@even-i700>
 <CACVcCzrHSqT08x6bUQRurRR=mx-9xsYbxCTd6LzyXSq1uqs=jw@mail.gmail.com>
Message-ID: <CACVcCzpRCtL6AL0pYj1Vzos4EXMQufV=EAVMYCnnp6abc=p5qA@mail.gmail.com>

Hey Even,

reaching out again, because I just don't know...

so here is gdal2tiles_parallel strategy (as far as I understand it)
- in each process, open the input file, compute the autowarped vrt (in the
case of the dataset I use at least) loop over tiles to generate and work
only depending on the process number (so that this work is made in
parallel). We therefore end up with, in each process
    - the input file opened as a dataset (but not touched after the
autowarped vrt is generated)
    - a different autowarped vrt in memory (for each process) but pointing
to the same source (as far as I can see)


My strategy:
- open the input file.
- generate the autowarped vrt and save it to disk
- compute all the tile details and store them in a data structure.
Then in each process:
- take one tile detail
- open the vrt (same file for each process, pointing to the same source
TIFF)
- read the vrt and write the tile
And that's the read that is failing as mentioned in my first email.

I can't see much difference. To try and be complete, I tried to (or think I
tried to):
- open the input file in each process
- generate a different vrt file for each thread

I even copy/pasted the code that gdal2tiles_parallel uses in their
processes, but with no success, always the same error. The
VRT_SHARED_SOURCE option
does not seem to change anything (but looking at the wiki, it's not clear
whether it applies to autowarped vrt too)

If you have any idea, I'll take it, I have been stuck for a long time
without making any progress :(

Cheers



---
Gregory Bataille

On Fri, Mar 17, 2017 at 6:15 AM, Grégory Bataille <
gregory.bataille at gmail.com> wrote:

> no luck.
> I tried this config.
> I also tried (with this config) to do a copy of the vrt file (with shell
> utility, not gdal) in each thread before opening it (still goes to the same
> TIFF file though), but no luck.
>
> But at least now that you confirm that it's related to concurrent reads, I
> have something precise to search for. I'll try to investigate how the
> gdal2tiles_parallel does it because it did not look different than what I
> was doing, but likely I missed something.
>
> Thanks
>
>
> ---
> Gregory Bataille
>
> On Thu, Mar 16, 2017 at 7:58 PM, Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> On jeudi 16 mars 2017 18:45:03 CET Grégory Bataille wrote:
>>
>> > Does that mean a different vrt file or simply reopen the file to create
>> a
>>
>> > gdal object in each process. Because I'm reopening the vrt file in each
>>
>> > thread
>>
>>
>>
>> Ah, that must be issue of
>>
>> http://gdal.org/gdal_vrttut.html#gdal_vrttut_mt
>>
>>
>>
>> Try defining
>>
>> gdal.SetConfigOption('VRT_SHARED_SOURCE', '0')
>>
>> before opening the VRTs
>>
>>
>>
>> >
>>
>> >
>>
>> > On Thu, 16 Mar 2017 at 17:23, Even Rouault <even.rouault at spatialys.com>
>>
>> >
>>
>> > wrote:
>>
>> > > On jeudi 16 mars 2017 17:16:20 CET Grégory Bataille wrote:
>>
>> > > > Hello all,
>>
>> > > >
>>
>> > > >
>>
>> > > >
>>
>> > > > Reaching out to the community caused I have failed for the past few
>>
>> > > > days.
>>
>> > > >
>>
>> > > >
>>
>> > > >
>>
>> > > > *short version*, I'm trying to multithread the gdal2tiles utility,
>> and
>>
>> > >
>>
>> > > I'm
>>
>> > >
>>
>> > > > getting this
>>
>> > > >
>>
>> > > >
>>
>> > > >
>>
>> > > > Generating Base Tiles:
>>
>> > > >
>>
>> > > > ERROR 1: LZWDecode:Wrong length of decoded string: data probably
>>
>> > >
>>
>> > > corrupted
>>
>> > >
>>
>> > > > at scanline 256
>>
>> > > >
>>
>> > > > ERROR 1: TIFFReadEncodedTile() failed.
>>
>> > > >
>>
>> > > > ERROR 1:
>>
>> > > >
>>
>> > > > /Users/gbataille/Downloads/Project_58704_transparent_mosaic_
>> group1.tif,
>>
>> > > >
>>
>> > > > band 1: IReadBlock failed at X offset 1, Y offset 0
>>
>> > > >
>>
>> > > > ERROR 1: GetBlockRef failed at X block offset 1, Y block offset 0
>>
>> > > >
>>
>> > > > ERROR 1: gba.vrt, band 1: IReadBlock failed at X offset 0, Y offset
>> 0
>>
>> > > >
>>
>> > > >
>>
>> > > >
>>
>> > > > Any idea?
>>
>> > >
>>
>> > > Yes, you need one dataset object per thread . Dataset objects cannot
>> be
>>
>> > > used simultaneously from several threads.
>>
>> > >
>>
>> > >
>>
>> > >
>>
>> > > Even
>>
>> > >
>>
>> > >
>>
>> > >
>>
>> > >
>>
>> > >
>>
>> > > --
>>
>> > >
>>
>> > > Spatialys - Geospatial professional services
>>
>> > >
>>
>> > > http://www.spatialys.com
>>
>>
>>
>>
>>
>> --
>>
>> Spatialys - Geospatial professional services
>>
>> http://www.spatialys.com
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170321/442a6abb/attachment.html>

From even.rouault at spatialys.com  Tue Mar 21 00:44:14 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 21 Mar 2017 08:44:14 +0100
Subject: [gdal-dev] Help requested: Concurrent read of a GeoTiff
In-Reply-To: <CACVcCzpRCtL6AL0pYj1Vzos4EXMQufV=EAVMYCnnp6abc=p5qA@mail.gmail.com>
References: <CACVcCzoQ-oQ6_kBUzquOUEDQydZsLckE4QUZg801UkKE2Nc-ZQ@mail.gmail.com>
 <CACVcCzrHSqT08x6bUQRurRR=mx-9xsYbxCTd6LzyXSq1uqs=jw@mail.gmail.com>
 <CACVcCzpRCtL6AL0pYj1Vzos4EXMQufV=EAVMYCnnp6abc=p5qA@mail.gmail.com>
Message-ID: <1564776.2bLv9j4bHn@even-i700>

On mardi 21 mars 2017 05:51:18 CET Grégory Bataille wrote:
> Hey Even,
> 
> reaching out again, because I just don't know...
> 
> so here is gdal2tiles_parallel strategy (as far as I understand it)
> - in each process, open the input file, compute the autowarped vrt (in the
> case of the dataset I use at least) loop over tiles to generate and work
> only depending on the process number (so that this work is made in
> parallel). We therefore end up with, in each process
>     - the input file opened as a dataset (but not touched after the
> autowarped vrt is generated)
>     - a different autowarped vrt in memory (for each process) but pointing
> to the same source (as far as I can see)
> 
> 
> My strategy:
> - open the input file.
> - generate the autowarped vrt and save it to disk
> - compute all the tile details and store them in a data structure.
> Then in each process:

I'm confused. You're talking about process, but is it a real operating system process or a 
thread ? I guess the later.

> - take one tile detail
> - open the vrt (same file for each process, pointing to the same source
> TIFF)
> - read the vrt and write the tile
> And that's the read that is failing as mentioned in my first email.
> 
> I can't see much difference. To try and be complete, I tried to (or think I
> tried to):
> - open the input file in each process
> - generate a different vrt file for each thread
> 
> I even copy/pasted the code that gdal2tiles_parallel uses in their
> processes, but with no success, always the same error. The
> VRT_SHARED_SOURCE option
> does not seem to change anything (but looking at the wiki, it's not clear
> whether it applies to autowarped vrt too)

VRT_SHARED_SOURCE indeed only works for "regular" mosaicing VRTs. So not to warped 
VRT.

Warped VRT opens the source dataset as a shared dataset in
https://github.com/OSGeo/gdal/blob/trunk/gdal/alg/gdalwarper.cpp#L1675
So you could have an issue if you open the VRT twice in the same thread, and then use each 
handle in a different thread, since both VRT handles would point to the same shared dataset. 
But it doesn't look that's what you are doing.

As a workaround to investigate, you could try to remove the GDAL_OF_SHARED |  flag in the 
line I mentionned and see if that makes a difference (but we could potentially - not sure - 
have issues at closing time since different call sites might make an assumption on the dataset 
being opened with shared semantics)

What you could do too is run the script through your prefered debugger and set a breakpoint 
in GDALOpenEx and look at the calling sites. If you are using 2 threads, then if we want things 
to work correctly, GDALOpenEx() should be called twice on the TIFF dataset and return a 
different handle.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170321/ecdde9d4/attachment-0001.html>

From luc.vanlinden at gmail.com  Tue Mar 21 01:28:28 2017
From: luc.vanlinden at gmail.com (lucvanlinden)
Date: Tue, 21 Mar 2017 01:28:28 -0700 (MST)
Subject: [gdal-dev] small typo - the page of the WMTS driver
Message-ID: <1490084908265-5313331.post@n6.nabble.com>

Hi

There is a small typo (closing tag of zoomlevel) on the page of the WMTS --
OGC Web Map Tile Service: 

http://www.gdal.org/frmt_wmts.html


 <ZoomLevel>int_value</TileMatrix>

should be

 <ZoomLevel>int_value</ZoomLevel>

Regards

Luc



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/small-typo-the-page-of-the-WMTS-driver-tp5313331.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Tue Mar 21 01:32:33 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 21 Mar 2017 09:32:33 +0100
Subject: [gdal-dev] small typo - the page of the WMTS driver
In-Reply-To: <1490084908265-5313331.post@n6.nabble.com>
References: <1490084908265-5313331.post@n6.nabble.com>
Message-ID: <4176752.sLM3p4RsZc@even-i700>

On mardi 21 mars 2017 01:28:28 CET lucvanlinden wrote:
> Hi
> 
> There is a small typo (closing tag of zoomlevel) on the page of the WMTS --
> OGC Web Map Tile Service:
> 
> http://www.gdal.org/frmt_wmts.html
> 
> 
>  <ZoomLevel>int_value</TileMatrix>
> 
> should be
> 
>  <ZoomLevel>int_value</ZoomLevel>
> 

Thanks Luc. Fixed (in svn, website will be refreshed later)

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170321/0349e3a0/attachment.html>

From gregory.bataille at gmail.com  Tue Mar 21 01:38:45 2017
From: gregory.bataille at gmail.com (=?UTF-8?Q?Gr=C3=A9gory_Bataille?=)
Date: Tue, 21 Mar 2017 09:38:45 +0100
Subject: [gdal-dev] Help requested: Concurrent read of a GeoTiff
In-Reply-To: <1564776.2bLv9j4bHn@even-i700>
References: <CACVcCzoQ-oQ6_kBUzquOUEDQydZsLckE4QUZg801UkKE2Nc-ZQ@mail.gmail.com>
 <CACVcCzrHSqT08x6bUQRurRR=mx-9xsYbxCTd6LzyXSq1uqs=jw@mail.gmail.com>
 <CACVcCzpRCtL6AL0pYj1Vzos4EXMQufV=EAVMYCnnp6abc=p5qA@mail.gmail.com>
 <1564776.2bLv9j4bHn@even-i700>
Message-ID: <CACVcCzrOpOmBQmq5foaZCT7Dmy4hxaT-tCCP=FG3Oc3q2PRmYQ@mail.gmail.com>

hum... debugging in the C layers, that'll be interesting...
Ok, I'll continue to dig in, thanks


---
Gregory Bataille

On Tue, Mar 21, 2017 at 8:44 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> On mardi 21 mars 2017 05:51:18 CET Grégory Bataille wrote:
>
> > Hey Even,
>
> >
>
> > reaching out again, because I just don't know...
>
> >
>
> > so here is gdal2tiles_parallel strategy (as far as I understand it)
>
> > - in each process, open the input file, compute the autowarped vrt (in
> the
>
> > case of the dataset I use at least) loop over tiles to generate and work
>
> > only depending on the process number (so that this work is made in
>
> > parallel). We therefore end up with, in each process
>
> > - the input file opened as a dataset (but not touched after the
>
> > autowarped vrt is generated)
>
> > - a different autowarped vrt in memory (for each process) but pointing
>
> > to the same source (as far as I can see)
>
> >
>
> >
>
> > My strategy:
>
> > - open the input file.
>
> > - generate the autowarped vrt and save it to disk
>
> > - compute all the tile details and store them in a data structure.
>
> > Then in each process:
>
>
>
> I'm confused. You're talking about process, but is it a real operating
> system process or a thread ? I guess the later.
>
>
>
> > - take one tile detail
>
> > - open the vrt (same file for each process, pointing to the same source
>
> > TIFF)
>
> > - read the vrt and write the tile
>
> > And that's the read that is failing as mentioned in my first email.
>
> >
>
> > I can't see much difference. To try and be complete, I tried to (or
> think I
>
> > tried to):
>
> > - open the input file in each process
>
> > - generate a different vrt file for each thread
>
> >
>
> > I even copy/pasted the code that gdal2tiles_parallel uses in their
>
> > processes, but with no success, always the same error. The
>
> > VRT_SHARED_SOURCE option
>
> > does not seem to change anything (but looking at the wiki, it's not clear
>
> > whether it applies to autowarped vrt too)
>
>
>
> VRT_SHARED_SOURCE indeed only works for "regular" mosaicing VRTs. So not
> to warped VRT.
>
>
>
> Warped VRT opens the source dataset as a shared dataset in
>
> https://github.com/OSGeo/gdal/blob/trunk/gdal/alg/gdalwarper.cpp#L1675
>
> So you could have an issue if you open the VRT twice in the same thread,
> and then use each handle in a different thread, since both VRT handles
> would point to the same shared dataset. But it doesn't look that's what you
> are doing.
>
>
>
> As a workaround to investigate, you could try to remove the GDAL_OF_SHARED
> | flag in the line I mentionned and see if that makes a difference (but we
> could potentially - not sure - have issues at closing time since different
> call sites might make an assumption on the dataset being opened with shared
> semantics)
>
>
>
> What you could do too is run the script through your prefered debugger and
> set a breakpoint in GDALOpenEx and look at the calling sites. If you are
> using 2 threads, then if we want things to work correctly, GDALOpenEx()
> should be called twice on the TIFF dataset and return a different handle.
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170321/442396b7/attachment.html>

From Andre.Vautour at Teledyne.com  Tue Mar 21 05:14:52 2017
From: Andre.Vautour at Teledyne.com (=?iso-8859-1?Q?Vautour=2C_Andr=E9_=28INT=29?=)
Date: Tue, 21 Mar 2017 12:14:52 +0000
Subject: [gdal-dev] Why does OGREnvelope default to valid values when
	uninitialized?
Message-ID: <8FD06BD4C598D8419F88B9DC4CD35FB2F70709@CA1-VPMSG-MBX02.TDY.Teledyne.com>

Hi all,

We've recently updated from GDAL 1.11.x to GDAL 2.1.x and ran into some failing unit tests.

I can simplify the failure to:

OGRPoint aPoint(0.0, 0.0);
OGRPoint anotherPoint(1.0, 1.0);
OGRMultiPoint multiPoint;
multiPoint.addGeometry(&aPoint);
multiPoint.addGeometry(&anotherPoint);

OGREnvelope envelope;
multiPoint.getEnvelope(&envelope);

The minx/miny are both 1.0, when I would have expected them to be 0.0.

Looks like OGRGeometryCollection::getEnvelope was updated to make use of OGREnvelope3D::Merge() during the curve geometry work. From what I can tell, the envelope of the 0.0, 0.0 point is seen as uninitialized since OGREnvelope::IsInit() returns false in that case.

Would it make sense to have the uninitialized envelope values be outside the range of typical coordinate reference systems to avoid such problems? Something like std::numeric_limits<double>::max().

Kind Regards,
André

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170321/6980fd30/attachment-0001.html>

From even.rouault at spatialys.com  Tue Mar 21 06:21:19 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 21 Mar 2017 14:21:19 +0100
Subject: [gdal-dev] Why does OGREnvelope default to valid values when
	uninitialized?
In-Reply-To: <8FD06BD4C598D8419F88B9DC4CD35FB2F70709@CA1-VPMSG-MBX02.TDY.Teledyne.com>
References: <8FD06BD4C598D8419F88B9DC4CD35FB2F70709@CA1-VPMSG-MBX02.TDY.Teledyne.com>
Message-ID: <1686576.DmhNn0j9VG@even-i700>

On mardi 21 mars 2017 12:14:52 CET Vautour, André (INT) wrote:
> Hi all,
> 
> We've recently updated from GDAL 1.11.x to GDAL 2.1.x and ran into some
> failing unit tests.
> 
> I can simplify the failure to:
> 
> OGRPoint aPoint(0.0, 0.0);
> OGRPoint anotherPoint(1.0, 1.0);
> OGRMultiPoint multiPoint;
> multiPoint.addGeometry(&aPoint);
> multiPoint.addGeometry(&anotherPoint);
> 
> OGREnvelope envelope;
> multiPoint.getEnvelope(&envelope);
> 
> The minx/miny are both 1.0, when I would have expected them to be 0.0.
> 
> Looks like OGRGeometryCollection::getEnvelope was updated to make use of
> OGREnvelope3D::Merge() during the curve geometry work. From what I can
> tell, the envelope of the 0.0, 0.0 point is seen as uninitialized since
> OGREnvelope::IsInit() returns false in that case.
> 
> Would it make sense to have the uninitialized envelope values be outside the
> range of typical coordinate reference systems to avoid such problems?
> Something like std::numeric_limits<double>::max().

Good catch. I've solved the issue in the way you suggest in trunk (initializing the max to -inf 
and min to inf, so that Merge() doesn't need to look if the envelope is initialized).
And for 2.1, I didn't want to change the OGREnvelope[3D] initialization values, so I've fixed it 
differently (actually using code similar to 1.11 that didn't use Merge() but did it manually).

Fixed per https://trac.osgeo.org/gdal/ticket/6841

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170321/5316aca6/attachment.html>

From Ahmed.Tolba at schiebel.net  Tue Mar 21 06:29:57 2017
From: Ahmed.Tolba at schiebel.net (Ahmed Tolba)
Date: Tue, 21 Mar 2017 13:29:57 +0000
Subject: [gdal-dev] Selecting from Geometry
Message-ID: <1616ac97e00c402294612dd6d80230b0@SRV046.seg.local>

Hi All,

Suppose I have a geom (geometry) that has multipoints, I would like to query for all the points that are within latitude longtitude altitude, is that possible ? what's the sql query for that ? I'm a beginner so excuse me.

SELECT * FROM nation WHERE OGR_GEOMETRY='MULTIPOINT' ???

2) My second question, to execute a query on the server, should I retrieve all ogr featuers first, then execute the query ? or I can do it without querying all the features ?


Ahmed Tolba
Programmierer Embedded Software

Email: ahmed.tolba at schiebel.net<mailto:ahmed.tolba at schiebel.net>

Schiebel Elektronische Geraete GmbH
Margaretenstrasse 112
1050 Vienna, Austria

Telephone: +43 (1) 546 26 0
Facsimile: +43 (1) 545 23 39

FN 79033a, Handelsgericht Wien (Vienna Commercial Court)

Visit us at http://www.schiebel.net

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170321/8c2693f9/attachment.html>

From schwehr at gmail.com  Tue Mar 21 07:50:34 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Tue, 21 Mar 2017 07:50:34 -0700
Subject: [gdal-dev] +/-infinity as an uninitialized marker
Message-ID: <CACmBxyud0d7ZLCaTDY27asmEkKKcJgUs6Y24Kznzr5u5E5z4Dg@mail.gmail.com>

Hey Even,

Probably not a big deal, but I'm curious why you didn't use !isinf(MinX) or
isfinite(MinX) for your recent OGREnvelope patch:

int  IsInit() const { return MinX !=
std::numeric_limits<double>::infinity(); }

My only thought is that if something goes totally messy and it uses !isinf
or isfinite, the code might retry initialization later when it's not going
to get any better (if MinX ends up -inf or one of the NaNs)?  I'm pretty
sure that infinity is always well behaved (unlike the crazy world of NaNs),
so I can't see a case where your code would go wrong.

As procrastination, I posted this overly wordy question on stack overflow
as I didn't find a good match with 10 seconds of searching...

http://stackoverflow.com/questions/42930445/val-stdnumeric-limitsdoubleinfinity-or-isinfval-or-isfiniteval

-kurt
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170321/2e7c85c5/attachment.html>

From even.rouault at spatialys.com  Tue Mar 21 08:09:58 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 21 Mar 2017 16:09:58 +0100
Subject: [gdal-dev] +/-infinity as an uninitialized marker
In-Reply-To: <CACmBxyud0d7ZLCaTDY27asmEkKKcJgUs6Y24Kznzr5u5E5z4Dg@mail.gmail.com>
References: <CACmBxyud0d7ZLCaTDY27asmEkKKcJgUs6Y24Kznzr5u5E5z4Dg@mail.gmail.com>
Message-ID: <2375630.7Ku3mOb1Xt@even-i700>

On mardi 21 mars 2017 07:50:34 CET Kurt Schwehr wrote:
> Hey Even,
> 
> Probably not a big deal, but I'm curious why you didn't use !isinf(MinX) or
> isfinite(MinX) for your recent OGREnvelope patch:
> 
> int  IsInit() const { return MinX !=
> std::numeric_limits<double>::infinity(); }
> 
> My only thought is that if something goes totally messy and it uses !isinf
> or isfinite, the code might retry initialization later when it's not going
> to get any better (if MinX ends up -inf or one of the NaNs)?  I'm pretty
> sure that infinity is always well behaved (unlike the crazy world of NaNs),
> so I can't see a case where your code would go wrong.

I've considered isinf() but I know we have had issues in some environments with isinf() being 
a macro, and thus std::isinf() ending up std::something_different
Actually, it seems std::isinf() is C++11 ?
http://en.cppreference.com/w/cpp/numeric/math/isinf

I could also have used CPLIsInf() instead.

But in both cases indeed if someone uses a legit envelope that would be minx=-inf,miny=-
inf,maxx=inf,maxy=inf, it would be considered as uninit.
I think equality comparison to std::numeric_limits<double>::infinity() should be fine, at least 
on IEEE754 compatible envs since there's a single binary representation for +inf.

If NaN values appear, then I think the whole class behaviour is pretty much undefined (as 
before my change)

> 
> As procrastination, I posted this overly wordy question on stack overflow
> as I didn't find a good match with 10 seconds of searching...
> 
> http://stackoverflow.com/questions/42930445/val-stdnumeric-limitsdoubleinfin
> ity-or-isinfval-or-isfiniteval
> 
> -kurt


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170321/8f4d2a35/attachment-0001.html>

From mateusz at loskot.net  Tue Mar 21 08:11:44 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue, 21 Mar 2017 16:11:44 +0100
Subject: [gdal-dev] +/-infinity as an uninitialized marker
In-Reply-To: <CACmBxyud0d7ZLCaTDY27asmEkKKcJgUs6Y24Kznzr5u5E5z4Dg@mail.gmail.com>
References: <CACmBxyud0d7ZLCaTDY27asmEkKKcJgUs6Y24Kznzr5u5E5z4Dg@mail.gmail.com>
Message-ID: <CABUeae-nKDOSwHhmjTG7zgWTYTC+=QJSH4jrGkENX+_WbDJEeQ@mail.gmail.com>

On 21 March 2017 at 15:50, Kurt Schwehr <schwehr at gmail.com> wrote:
> Hey Even,
>
> Probably not a big deal, but I'm curious why you didn't use !isinf(MinX) or
> isfinite(MinX) for your recent OGREnvelope patch:
>
> int  IsInit() const { return MinX !=
> std::numeric_limits<double>::infinity(); }

Portability wank: it's also good idea to check for
std::numeric_limits<number<T> >::has_infinity

eg. something like

std::numeric_limits<number<double>::has_infinity
? std::numeric_limits<number<double>::infinity()
: (std::numeric_limits<number<double>::max)()

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From mateusz at loskot.net  Tue Mar 21 08:19:17 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue, 21 Mar 2017 16:19:17 +0100
Subject: [gdal-dev] +/-infinity as an uninitialized marker
In-Reply-To: <2375630.7Ku3mOb1Xt@even-i700>
References: <CACmBxyud0d7ZLCaTDY27asmEkKKcJgUs6Y24Kznzr5u5E5z4Dg@mail.gmail.com>
 <2375630.7Ku3mOb1Xt@even-i700>
Message-ID: <CABUeae9N=aU3oDc=+B=5icnGLEPVtCVuBQ2zN4Fvw7Oteohy-A@mail.gmail.com>

On 21 March 2017 at 16:09, Even Rouault <even.rouault at spatialys.com> wrote:
> I've considered isinf() but I know we have had issues in some environments
> with isinf() being a macro, and thus std::isinf() ending up
> std::something_different

Yes, indeed. There's been lots of problems, in GEOS too.

BTW, one of anti-macro expand solutions with parentheses (prevents ADL too):
(std::isinf)()
(std::min)()
etc.

> Actually, it seems std::isinf() is C++11 ?

Yes it is.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From even.rouault at spatialys.com  Tue Mar 21 08:29:41 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 21 Mar 2017 16:29:41 +0100
Subject: [gdal-dev] +/-infinity as an uninitialized marker
In-Reply-To: <CABUeae-nKDOSwHhmjTG7zgWTYTC+=QJSH4jrGkENX+_WbDJEeQ@mail.gmail.com>
References: <CACmBxyud0d7ZLCaTDY27asmEkKKcJgUs6Y24Kznzr5u5E5z4Dg@mail.gmail.com>
 <CABUeae-nKDOSwHhmjTG7zgWTYTC+=QJSH4jrGkENX+_WbDJEeQ@mail.gmail.com>
Message-ID: <3637260.muyougSom9@even-i700>

On mardi 21 mars 2017 16:11:44 CET Mateusz Loskot wrote:
> On 21 March 2017 at 15:50, Kurt Schwehr <schwehr at gmail.com> wrote:
> > Hey Even,
> > 
> > Probably not a big deal, but I'm curious why you didn't use !isinf(MinX)
> > or
> > isfinite(MinX) for your recent OGREnvelope patch:
> > 
> > int  IsInit() const { return MinX !=
> > std::numeric_limits<double>::infinity(); }
> 
> Portability wank: it's also good idea to check for
> std::numeric_limits<number<T> >::has_infinity
> 
> eg. something like
> 
> std::numeric_limits<number<double>::has_infinity
> ? std::numeric_limits<number<double>::infinity()
> 
> : (std::numeric_limits<number<double>::max)()

Looking at http://en.cppreference.com/w/cpp/types/numeric_limits/infinity, it seems that 
std::numeric_limits<double>::infinity always resolve to some reasonable "big" value.

And looking at http://en.cppreference.com/w/cpp/types/numeric_limits/has_infinity and 
http://en.cppreference.com/w/cpp/types/numeric_limits/is_iec559, it might not be a specific 
value on some non-IEEE754 problems.

Anyway we already use  std::numeric_limits<double>::infinity() in a number of places. And 
more subtelty, we serialize/deserialize between 8 bytes stored in files and C/C++ double in a 
lot of places (an trust me, that's really a lot ! shapefile, WKB, geotiff, many drivers) assuming 
that the machine representation of double is IEEE754. So basically GDAL is only compatible 
of such machines. And apparently people using non-IEEE754 platforms are too shy to 
complain or provide compatibility patches :-)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170321/2f05c0ae/attachment.html>

From awilliams at rapidmap.com.au  Tue Mar 21 21:55:29 2017
From: awilliams at rapidmap.com.au (andye)
Date: Tue, 21 Mar 2017 21:55:29 -0700 (MST)
Subject: [gdal-dev] Can you update just update the ogr2ogr.exe compiled
 binary in an existing directory
Message-ID: <1490158529025-5313545.post@n6.nabble.com>

I'm using ogr2ogr from one of the "bin" directories of QGIS(Wien). It's
complaining about GML3_LONGSRS.

Can I get ogr2ogr.exe from GISInternals nightly build and just update the
exe?



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Can-you-update-just-update-the-ogr2ogr-exe-compiled-binary-in-an-existing-directory-tp5313545.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From awilliams at rapidmap.com.au  Tue Mar 21 23:41:12 2017
From: awilliams at rapidmap.com.au (andye)
Date: Tue, 21 Mar 2017 23:41:12 -0700 (MST)
Subject: [gdal-dev] ogr2ogr GML GML_INVERT_AXIS_ORDER_IF_LAT_LONG not working
Message-ID: <1490164872057-5313555.post@n6.nabble.com>

Folks related to a recent post about updating ogr2ogr. Seems there maybe
something else afoot.

I'm trying to export a GML3 file. I'm running into what appears to be a
known issue with LAT\LONG being swapped based on the projection.

The following creates a file which is formatted correctly except the desired
output is LAT LONG. I get LONG LAT.

Interestingly when I first tried this I have the -spat defined as LAT LONG
and got no data. Once I changed it to LONG LAT the data was fine.

I get identical result using QGIS to perform the same task with the same
defined parameters.

I also tried setting to NO to see if I was, in fact, swapping them but the
result is the same no matter what.

Taking the option out has no effect on the result.

Am I mis-applying the creation option? 

ogr2ogr -f GML -spat 151.3085 -24.002934 151.394736 -23.963423 -clipsrc
spat_extent -dsco FORMAT=GML3 -dsco GML3_LONGSRS=NO --config 
GML_INVERT_AXIS_ORDER_IF_LAT_LONG YES -dsco -dsco SPACE_INDENTATION=YES 
-dsco WRITE_FEATURE_BOUNDED_BY=NO -dsco XSISCHEMA=EXTERNAL -t_srs
http://spatialreference.org/ref/epsg/4283/ "C:\export.gml" "C:\Import.tab"



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/ogr2ogr-GML-GML-INVERT-AXIS-ORDER-IF-LAT-LONG-not-working-tp5313555.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From nhv at meganet.net  Wed Mar 22 01:02:41 2017
From: nhv at meganet.net (Norman Vine)
Date: Wed, 22 Mar 2017 04:02:41 -0400
Subject: [gdal-dev] ogr2ogr GML GML_INVERT_AXIS_ORDER_IF_LAT_LONG not
	working
In-Reply-To: <1490164872057-5313555.post@n6.nabble.com>
References: <1490164872057-5313555.post@n6.nabble.com>
Message-ID: <CDE66DE6-2AA9-4606-8049-7DE10B032542@meganet.net>

see 
https://trac.osgeo.org/gdal/wiki/FAQVector#HowdoIflipcoordinateswhentheyarenotintheexpectedorder

> On Mar 22, 2017, at 2:41 AM, andye <awilliams at rapidmap.com.au> wrote:
> 
> Folks related to a recent post about updating ogr2ogr. Seems there maybe
> something else afoot.
> 
> I'm trying to export a GML3 file. I'm running into what appears to be a
> known issue with LAT\LONG being swapped based on the projection.
> 
> The following creates a file which is formatted correctly except the desired
> output is LAT LONG. I get LONG LAT.
> 
> Interestingly when I first tried this I have the -spat defined as LAT LONG
> and got no data. Once I changed it to LONG LAT the data was fine.
> 
> I get identical result using QGIS to perform the same task with the same
> defined parameters.
> 
> I also tried setting to NO to see if I was, in fact, swapping them but the
> result is the same no matter what.
> 
> Taking the option out has no effect on the result.
> 
> Am I mis-applying the creation option? 
> 
> ogr2ogr -f GML -spat 151.3085 -24.002934 151.394736 -23.963423 -clipsrc
> spat_extent -dsco FORMAT=GML3 -dsco GML3_LONGSRS=NO --config 
> GML_INVERT_AXIS_ORDER_IF_LAT_LONG YES -dsco -dsco SPACE_INDENTATION=YES 
> -dsco WRITE_FEATURE_BOUNDED_BY=NO -dsco XSISCHEMA=EXTERNAL -t_srs
> http://spatialreference.org/ref/epsg/4283/ "C:\export.gml" "C:\Import.tab"
> 
> 
> 
> --
> View this message in context: http://osgeo-org.1560.x6.nabble.com/ogr2ogr-GML-GML-INVERT-AXIS-ORDER-IF-LAT-LONG-not-working-tp5313555.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


From Ahmed.Tolba at schiebel.net  Wed Mar 22 01:52:09 2017
From: Ahmed.Tolba at schiebel.net (Ahmed Tolba)
Date: Wed, 22 Mar 2017 08:52:09 +0000
Subject: [gdal-dev] Getting multipolygon that lies inside 4 points
Message-ID: <bc06f67b626c4e2bade64d2805d8884a@SRV046.seg.local>

Hi All,

I have 4 points that I always get, I would like to query if the polygon in the multipoint lies inside those 4 points. I'm using Postgis, postgres.

Sincerely,
Ahmed


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170322/faa3f019/attachment.html>

From Ahmed.Tolba at schiebel.net  Wed Mar 22 06:12:14 2017
From: Ahmed.Tolba at schiebel.net (Ahmed Tolba)
Date: Wed, 22 Mar 2017 13:12:14 +0000
Subject: [gdal-dev] Executing a query getting null layer
Message-ID: <ab0b92ba009b40a880cc73c0c4c4ea3d@SRV046.seg.local>

Hi All,
I'm trying to execute that query
string query = "SELECT *FROM areas WHERE st_contains(st_polygon(st_addpoint(st_linefrommultipoint(areas.geom),st_startpoint(st_linefrommultipoint(areas.geom)),-1),st_srid(areas.geom)),st_mpointfromtext('MULTIPOINT(16.17951 47.85549, 16.17951 47.85549, 16.17951 47.85549, 16.17951 47.85549)',4326));";

but I get a null layer,

here is how I'm executing the query:
OGRLayer * layer = m_wfs_t->ExecuteSQL(query.c_str(), NULL, "OGRSQL");


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170322/a715cc76/attachment.html>

From even.rouault at spatialys.com  Wed Mar 22 06:29:40 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 22 Mar 2017 14:29:40 +0100
Subject: [gdal-dev] Executing a query getting null layer
In-Reply-To: <ab0b92ba009b40a880cc73c0c4c4ea3d@SRV046.seg.local>
References: <ab0b92ba009b40a880cc73c0c4c4ea3d@SRV046.seg.local>
Message-ID: <1854011.qjlOGscuma@even-i700>

On mercredi 22 mars 2017 13:12:14 CET Ahmed Tolba wrote:
> Hi All,
> I'm trying to execute that query
> string query = "SELECT *FROM areas WHERE
> st_contains(st_polygon(st_addpoint(st_linefrommultipoint(areas.geom),st_sta
> rtpoint(st_linefrommultipoint(areas.geom)),-1),st_srid(areas.geom)),st_mpoin
> tfromtext('MULTIPOINT(16.17951 47.85549, 16.17951 47.85549, 16.17951
> 47.85549, 16.17951 47.85549)',4326));";
> 
> but I get a null layer,
> 
> here is how I'm executing the query:
> OGRLayer * layer = m_wfs_t->ExecuteSQL(query.c_str(), NULL, "OGRSQL");

You are using ST_ functions, which are only provided through Spatialite. So replace 
"OGRSQL" with "SQLite".


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170322/7afb81fb/attachment.html>

From Ahmed.Tolba at schiebel.net  Wed Mar 22 06:31:49 2017
From: Ahmed.Tolba at schiebel.net (Ahmed Tolba)
Date: Wed, 22 Mar 2017 13:31:49 +0000
Subject: [gdal-dev] Executing a query getting null layer
In-Reply-To: <1854011.qjlOGscuma@even-i700>
References: <ab0b92ba009b40a880cc73c0c4c4ea3d@SRV046.seg.local>
 <1854011.qjlOGscuma@even-i700>
Message-ID: <9cdec2e796b1465898f27ffe3afa1b91@SRV046.seg.local>

I replaced OGRSQL with SQLite, It says now

No such function: st_linefrommultipoint


From: Even Rouault [mailto:even.rouault at spatialys.com]
Sent: Wednesday, March 22, 2017 2:30 PM
To: gdal-dev at lists.osgeo.org
Cc: Ahmed Tolba
Subject: Re: [gdal-dev] Executing a query getting null layer


On mercredi 22 mars 2017 13:12:14 CET Ahmed Tolba wrote:

> Hi All,

> I'm trying to execute that query

> string query = "SELECT *FROM areas WHERE

> st_contains(st_polygon(st_addpoint(st_linefrommultipoint(areas.geom),st_sta

> rtpoint(st_linefrommultipoint(areas.geom)),-1),st_srid(areas.geom)),st_mpoin

> tfromtext('MULTIPOINT(16.17951 47.85549, 16.17951 47.85549, 16.17951

> 47.85549, 16.17951 47.85549)',4326));";

>

> but I get a null layer,

>

> here is how I'm executing the query:

> OGRLayer * layer = m_wfs_t->ExecuteSQL(query.c_str(), NULL, "OGRSQL");



You are using ST_ functions, which are only provided through Spatialite. So replace "OGRSQL" with "SQLite".





--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170322/eb1f9396/attachment-0001.html>

From jukka.rahkonen at maanmittauslaitos.fi  Wed Mar 22 06:39:41 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Wed, 22 Mar 2017 06:39:41 -0700 (MST)
Subject: [gdal-dev] Executing a query getting null layer
In-Reply-To: <9cdec2e796b1465898f27ffe3afa1b91@SRV046.seg.local>
References: <ab0b92ba009b40a880cc73c0c4c4ea3d@SRV046.seg.local>
 <1854011.qjlOGscuma@even-i700>
 <9cdec2e796b1465898f27ffe3afa1b91@SRV046.seg.local>
Message-ID: <1490189981719-5313646.post@n6.nabble.com>

andreahmed wrote
> I replaced OGRSQL with SQLite, It says now
> 
> No such function: st_linefrommultipoint

That's no wonder because SpatiaLite does not have such function
https://www.gaia-gis.it/gaia-sins/spatialite-sql-latest.html.

Where do you have your data? Are they in PostGIS which has a native support
for http://postgis.net/docs/ST_LineFromMultiPoint.html?

-Jukka Rahkonen.-



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Executing-a-query-getting-null-layer-tp5313639p5313646.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From Ahmed.Tolba at schiebel.net  Wed Mar 22 06:58:52 2017
From: Ahmed.Tolba at schiebel.net (Ahmed Tolba)
Date: Wed, 22 Mar 2017 13:58:52 +0000
Subject: [gdal-dev] Executing a query getting null layer
In-Reply-To: <1490189981719-5313646.post@n6.nabble.com>
References: <ab0b92ba009b40a880cc73c0c4c4ea3d@SRV046.seg.local>
 <1854011.qjlOGscuma@even-i700>
 <9cdec2e796b1465898f27ffe3afa1b91@SRV046.seg.local>
 <1490189981719-5313646.post@n6.nabble.com>
Message-ID: <438cd2d4cb4a4550bd85197f9cdfb791@SRV046.seg.local>

My data is in mapserver database which is PostGres PostGIS. What's the equivalent function for st_linefrommultipoint ?

-----Original Message-----
From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of jratike80
Sent: Wednesday, March 22, 2017 2:40 PM
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Executing a query getting null layer

andreahmed wrote
> I replaced OGRSQL with SQLite, It says now
> 
> No such function: st_linefrommultipoint

That's no wonder because SpatiaLite does not have such function https://www.gaia-gis.it/gaia-sins/spatialite-sql-latest.html.

Where do you have your data? Are they in PostGIS which has a native support for http://postgis.net/docs/ST_LineFromMultiPoint.html?

-Jukka Rahkonen.-



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Executing-a-query-getting-null-layer-tp5313639p5313646.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at spatialys.com  Wed Mar 22 07:04:54 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 22 Mar 2017 15:04:54 +0100
Subject: [gdal-dev] Executing a query getting null layer
In-Reply-To: <438cd2d4cb4a4550bd85197f9cdfb791@SRV046.seg.local>
References: <ab0b92ba009b40a880cc73c0c4c4ea3d@SRV046.seg.local>
 <1490189981719-5313646.post@n6.nabble.com>
 <438cd2d4cb4a4550bd85197f9cdfb791@SRV046.seg.local>
Message-ID: <21291294.hbaMkOLkaF@even-i700>

On mercredi 22 mars 2017 13:58:52 CET Ahmed Tolba wrote:
> My data is in mapserver database which is PostGres PostGIS. What's the
> equivalent function for st_linefrommultipoint ?

Ah ok just put NULL for the dialect argument in that case. This will evaluate the query on 
Postgres side.

 
> -----Original Message-----
> From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of
> jratike80
 Sent: Wednesday, March 22, 2017 2:40 PM
> To: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] Executing a query getting null layer
> 
> andreahmed wrote
> 
> > I replaced OGRSQL with SQLite, It says now
> > 
> > No such function: st_linefrommultipoint
> 
> 
> That's no wonder because SpatiaLite does not have such function
> https://www.gaia-gis.it/gaia-sins/spatialite-sql-latest.html.
 
> Where do you have your data? Are they in PostGIS which has a native support
> for http://postgis.net/docs/ST_LineFromMultiPoint.html?
 
> -Jukka Rahkonen.-
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/gdal-dev-Executing-a-query-getting-null
> -layer-tp5313639p5313646.html
 Sent from the GDAL - Dev mailing list archive
> at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170322/4ef1a457/attachment.html>

From Ahmed.Tolba at schiebel.net  Wed Mar 22 07:07:29 2017
From: Ahmed.Tolba at schiebel.net (Ahmed Tolba)
Date: Wed, 22 Mar 2017 14:07:29 +0000
Subject: [gdal-dev] Executing a query getting null layer
In-Reply-To: <21291294.hbaMkOLkaF@even-i700>
References: <ab0b92ba009b40a880cc73c0c4c4ea3d@SRV046.seg.local>
 <1490189981719-5313646.post@n6.nabble.com>
 <438cd2d4cb4a4550bd85197f9cdfb791@SRV046.seg.local>
 <21291294.hbaMkOLkaF@even-i700>
Message-ID: <6e67f40a4873464f8e6b3a41f063e1a2@SRV046.seg.local>

Now I get undefined function st_linefrommultipoint

Here is my query again

string query = "SELECT * FROM areas WHERE st_contains(st_polygon(st_addpoint(st_linefrommultipoint(areas.geom),st_startpoint(st_linefrommultipoint(areas.geom)),-1),st_srid(areas.geom)),st_mpointfromtext('MULTIPOINT(16.17951 47.85549, 16.17951 47.85549, 16.17951 47.85549, 16.17951 47.85549)',4326));";

I have put NULL for the dialect as suggested.

Many Thanks,
Ahmed


From: Even Rouault [mailto:even.rouault at spatialys.com]
Sent: Wednesday, March 22, 2017 3:05 PM
To: gdal-dev at lists.osgeo.org
Cc: Ahmed Tolba; jratike80
Subject: Re: [gdal-dev] Executing a query getting null layer


On mercredi 22 mars 2017 13:58:52 CET Ahmed Tolba wrote:

> My data is in mapserver database which is PostGres PostGIS. What's the

> equivalent function for st_linefrommultipoint ?



Ah ok just put NULL for the dialect argument in that case. This will evaluate the query on Postgres side.



> -----Original Message-----

> From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of

> jratike80

Sent: Wednesday, March 22, 2017 2:40 PM

> To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

> Subject: Re: [gdal-dev] Executing a query getting null layer

>

> andreahmed wrote

>

> > I replaced OGRSQL with SQLite, It says now

> >

> > No such function: st_linefrommultipoint

>

>

> That's no wonder because SpatiaLite does not have such function

> https://www.gaia-gis.it/gaia-sins/spatialite-sql-latest.html.

> Where do you have your data? Are they in PostGIS which has a native support

> for http://postgis.net/docs/ST_LineFromMultiPoint.html?

> -Jukka Rahkonen.-

>

>

>

> --

> View this message in context:

> http://osgeo-org.1560.x6.nabble.com/gdal-dev-Executing-a-query-getting-null

> -layer-tp5313639p5313646.html

Sent from the GDAL - Dev mailing list archive

> at Nabble.com.

> _______________________________________________

> gdal-dev mailing list

> gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

> https://lists.osgeo.org/mailman/listinfo/gdal-dev

> _______________________________________________

> gdal-dev mailing list

> gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170322/17306e00/attachment-0001.html>

From Ahmed.Tolba at schiebel.net  Wed Mar 22 07:39:02 2017
From: Ahmed.Tolba at schiebel.net (Ahmed Tolba)
Date: Wed, 22 Mar 2017 14:39:02 +0000
Subject: [gdal-dev] Executing a query getting null layer
References: <ab0b92ba009b40a880cc73c0c4c4ea3d@SRV046.seg.local>
 <1490189981719-5313646.post@n6.nabble.com>
 <438cd2d4cb4a4550bd85197f9cdfb791@SRV046.seg.local>
 <21291294.hbaMkOLkaF@even-i700> 
Message-ID: <af5dd34068c5435ca143721cfb60673a@SRV046.seg.local>

Is There a solution, I'm stopped :( ?
Is there any equivalent way to do what the SQL Query does, but that works with SQLite ?

Sincerely,
Ahmed

From: Ahmed Tolba
Sent: Wednesday, March 22, 2017 3:08 PM
To: 'Even Rouault'
Cc: gdal-dev at lists.osgeo.org
Subject: RE: [gdal-dev] Executing a query getting null layer

Now I get undefined function st_linefrommultipoint

Here is my query again

string query = "SELECT * FROM areas WHERE st_contains(st_polygon(st_addpoint(st_linefrommultipoint(areas.geom),st_startpoint(st_linefrommultipoint(areas.geom)),-1),st_srid(areas.geom)),st_mpointfromtext('MULTIPOINT(16.17951 47.85549, 16.17951 47.85549, 16.17951 47.85549, 16.17951 47.85549)',4326));";

I have put NULL for the dialect as suggested.

Many Thanks,
Ahmed


From: Even Rouault [mailto:even.rouault at spatialys.com]
Sent: Wednesday, March 22, 2017 3:05 PM
To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Cc: Ahmed Tolba; jratike80
Subject: Re: [gdal-dev] Executing a query getting null layer


On mercredi 22 mars 2017 13:58:52 CET Ahmed Tolba wrote:

> My data is in mapserver database which is PostGres PostGIS. What's the

> equivalent function for st_linefrommultipoint ?



Ah ok just put NULL for the dialect argument in that case. This will evaluate the query on Postgres side.



> -----Original Message-----

> From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of

> jratike80

Sent: Wednesday, March 22, 2017 2:40 PM

> To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

> Subject: Re: [gdal-dev] Executing a query getting null layer

>

> andreahmed wrote

>

> > I replaced OGRSQL with SQLite, It says now

> >

> > No such function: st_linefrommultipoint

>

>

> That's no wonder because SpatiaLite does not have such function

> https://www.gaia-gis.it/gaia-sins/spatialite-sql-latest.html.

> Where do you have your data? Are they in PostGIS which has a native support

> for http://postgis.net/docs/ST_LineFromMultiPoint.html?

> -Jukka Rahkonen.-

>

>

>

> --

> View this message in context:

> http://osgeo-org.1560.x6.nabble.com/gdal-dev-Executing-a-query-getting-null

> -layer-tp5313639p5313646.html

Sent from the GDAL - Dev mailing list archive

> at Nabble.com.

> _______________________________________________

> gdal-dev mailing list

> gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

> https://lists.osgeo.org/mailman/listinfo/gdal-dev

> _______________________________________________

> gdal-dev mailing list

> gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170322/92bffd03/attachment.html>

From Ahmed.Tolba at schiebel.net  Wed Mar 22 08:25:37 2017
From: Ahmed.Tolba at schiebel.net (Ahmed Tolba)
Date: Wed, 22 Mar 2017 15:25:37 +0000
Subject: [gdal-dev] Executing a query getting null layer
In-Reply-To: <21291294.hbaMkOLkaF@even-i700>
References: <ab0b92ba009b40a880cc73c0c4c4ea3d@SRV046.seg.local>
 <1490189981719-5313646.post@n6.nabble.com>
 <438cd2d4cb4a4550bd85197f9cdfb791@SRV046.seg.local>
 <21291294.hbaMkOLkaF@even-i700>
Message-ID: <94c48f63523d460d9b73a3876389a247@SRV046.seg.local>

Note that m_wfs_t  is of type OGRDataSource is that correct ?

Ahmed

From: Even Rouault [mailto:even.rouault at spatialys.com]
Sent: Wednesday, March 22, 2017 3:05 PM
To: gdal-dev at lists.osgeo.org
Cc: Ahmed Tolba; jratike80
Subject: Re: [gdal-dev] Executing a query getting null layer


On mercredi 22 mars 2017 13:58:52 CET Ahmed Tolba wrote:

> My data is in mapserver database which is PostGres PostGIS. What's the

> equivalent function for st_linefrommultipoint ?



Ah ok just put NULL for the dialect argument in that case. This will evaluate the query on Postgres side.



> -----Original Message-----

> From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of

> jratike80

Sent: Wednesday, March 22, 2017 2:40 PM

> To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

> Subject: Re: [gdal-dev] Executing a query getting null layer

>

> andreahmed wrote

>

> > I replaced OGRSQL with SQLite, It says now

> >

> > No such function: st_linefrommultipoint

>

>

> That's no wonder because SpatiaLite does not have such function

> https://www.gaia-gis.it/gaia-sins/spatialite-sql-latest.html.

> Where do you have your data? Are they in PostGIS which has a native support

> for http://postgis.net/docs/ST_LineFromMultiPoint.html?

> -Jukka Rahkonen.-

>

>

>

> --

> View this message in context:

> http://osgeo-org.1560.x6.nabble.com/gdal-dev-Executing-a-query-getting-null

> -layer-tp5313639p5313646.html

Sent from the GDAL - Dev mailing list archive

> at Nabble.com.

> _______________________________________________

> gdal-dev mailing list

> gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

> https://lists.osgeo.org/mailman/listinfo/gdal-dev

> _______________________________________________

> gdal-dev mailing list

> gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170322/574ce0b0/attachment-0001.html>

From jukka.rahkonen at maanmittauslaitos.fi  Wed Mar 22 09:58:13 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Wed, 22 Mar 2017 09:58:13 -0700 (MST)
Subject: [gdal-dev] Executing a query getting null layer
In-Reply-To: <6e67f40a4873464f8e6b3a41f063e1a2@SRV046.seg.local>
References: <ab0b92ba009b40a880cc73c0c4c4ea3d@SRV046.seg.local>
 <1854011.qjlOGscuma@even-i700>
 <9cdec2e796b1465898f27ffe3afa1b91@SRV046.seg.local>
 <1490189981719-5313646.post@n6.nabble.com>
 <438cd2d4cb4a4550bd85197f9cdfb791@SRV046.seg.local>
 <21291294.hbaMkOLkaF@even-i700>
 <6e67f40a4873464f8e6b3a41f063e1a2@SRV046.seg.local>
Message-ID: <1490201893390-5313687.post@n6.nabble.com>

andreahmed wrote
> Now I get undefined function st_linefrommultipoint
> 
> Here is my query again
> 
> string query = "SELECT * FROM areas WHERE
> st_contains(st_polygon(st_addpoint(st_linefrommultipoint(areas.geom),st_startpoint(st_linefrommultipoint(areas.geom)),-1),st_srid(areas.geom)),st_mpointfromtext('MULTIPOINT(16.17951
> 47.85549, 16.17951 47.85549, 16.17951 47.85549, 16.17951
> 47.85549)',4326));";

Does this query work when you run it directly in PostGIS? If yes, try next
to include it into ogrinfo query as -sql parameter.

I would say that asking same questions here and in gis.stackexchange usually
does not make people to serve you any faster.

-Jukka Rahkonen-



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Executing-a-query-getting-null-layer-tp5313639p5313687.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From ahmed.tolba at schiebel.net  Wed Mar 22 11:04:42 2017
From: ahmed.tolba at schiebel.net (andreahmed)
Date: Wed, 22 Mar 2017 11:04:42 -0700 (MST)
Subject: [gdal-dev] Executing a query getting null layer
In-Reply-To: <1490201893390-5313687.post@n6.nabble.com>
References: <ab0b92ba009b40a880cc73c0c4c4ea3d@SRV046.seg.local>
 <1854011.qjlOGscuma@even-i700>
 <9cdec2e796b1465898f27ffe3afa1b91@SRV046.seg.local>
 <1490189981719-5313646.post@n6.nabble.com>
 <438cd2d4cb4a4550bd85197f9cdfb791@SRV046.seg.local>
 <21291294.hbaMkOLkaF@even-i700>
 <6e67f40a4873464f8e6b3a41f063e1a2@SRV046.seg.local>
 <1490201893390-5313687.post@n6.nabble.com>
Message-ID: <1490205882596-5313704.post@n6.nabble.com>

I'm using WFS-T. Does ogrinfo support that ? Can you show me the full syntax
please. I'm beginner in that topic.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Executing-a-query-getting-null-layer-tp5313639p5313704.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From neteler at osgeo.org  Wed Mar 22 12:12:01 2017
From: neteler at osgeo.org (Markus Neteler)
Date: Wed, 22 Mar 2017 20:12:01 +0100
Subject: [gdal-dev] [GRASS-user] Slow import of GHSL
In-Reply-To: <CAG+h=FFC5tR2uL6djz=A0_yBOZ=qBy4w-L2MN0iCEwrZ5FMaNg@mail.gmail.com>
References: <20170310164700.GC1715@mail.nikosalexandris.net>
 <CALFmHhtmDr=JAPy26qZNT3Gu=0-y7oYFZNWaa6oAsftWX5VayQ@mail.gmail.com>
 <20170311075300.GA4021@mail.nikosalexandris.net>
 <CAG+h=FFC5tR2uL6djz=A0_yBOZ=qBy4w-L2MN0iCEwrZ5FMaNg@mail.gmail.com>
Message-ID: <CALFmHhuQ=gYvs1XuXm58t8cRdVXUz1i+LJxWVV7CMc2X+DW1cw@mail.gmail.com>

On Sat, Mar 11, 2017 at 7:01 PM, Markus Metz
<markus.metz.giswork at gmail.com> wrote:
> On Sat, Mar 11, 2017 at 8:53 AM, Nikos Alexandris <nik at nikosalexandris.net>
> wrote:
>>
>> Nikos Alexandris
>>
>>>> Why does (attempting to) import a 38m pixel resolution GHSL [0] GeoTIFF
>>>> layer, ie GHS_BUILT_LDS1990_GLOBE_R2016A_3857_38_v1_0_p1.tif, in GRASS'
>>>> db progress slow?
>
> because it is a very large raster map: Size is 507904, 647168

Nikos, for an even bigger map try

Global Surface Water (2000-2012, 30 m, Data coverage is from 80° north
to 60° south): http://landcover.usgs.gov/glc/WaterDescriptionAndDownloads.php
by USGS. 1.6GB in size.

Using gdalbuildvrt I created a VRT from the 504 GeoTIFF files.

After import into GRASS GIS, here the timings:

# final map size:
g.region -p
...
rows:       493200
cols:       1296001
cells:      639187693200

(handling only works in GRASS GIS 7.3.svn since Markus Metz's recent
improvements on global data import are needed).

Benchmarks:
- Import took 2h while reading the data from a CIFS mounted storage
box (slow) and writing on SSD.
- Displaying the entire map (639 giga-pixel) in GRASS GIS' display
(d.mon) took ~15 sec over a ssh tunnel from my laptop to the server,
since I am at a conference.

Fair deal I would say :-)

cheers,
Markus

-- 
https://www.mundialis.de/

From jukka.rahkonen at maanmittauslaitos.fi  Wed Mar 22 13:12:41 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Wed, 22 Mar 2017 13:12:41 -0700 (MST)
Subject: [gdal-dev] Executing a query getting null layer
In-Reply-To: <1490205882596-5313704.post@n6.nabble.com>
References: <ab0b92ba009b40a880cc73c0c4c4ea3d@SRV046.seg.local>
 <1854011.qjlOGscuma@even-i700>
 <9cdec2e796b1465898f27ffe3afa1b91@SRV046.seg.local>
 <1490189981719-5313646.post@n6.nabble.com>
 <438cd2d4cb4a4550bd85197f9cdfb791@SRV046.seg.local>
 <21291294.hbaMkOLkaF@even-i700>
 <6e67f40a4873464f8e6b3a41f063e1a2@SRV046.seg.local>
 <1490201893390-5313687.post@n6.nabble.com>
 <1490205882596-5313704.post@n6.nabble.com>
Message-ID: <1490213561883-5313720.post@n6.nabble.com>

andreahmed wrote
> I'm using WFS-T. Does ogrinfo support that ? Can you show me the full
> syntax please. I'm beginner in that topic.

Ok. A few mails ago you wrote "My data is in mapserver database which is
PostGres PostGIS. What's the equivalent function for st_linefrommultipoint?"
which made Even and I to provide you advice for PostGIS. So we must take a
few steps back because native PostGIS queries cannot be user for WFS
datasource.

Your initial problem was perhaps how to convert four corner points into a
polygon. There are probably many options but with SQLite dialect I would try
ST_ConvexHull

select ST_AsText(
ST_ConvexHull(ST_GeomFromText('MULTIPOINT(0 0, 0 1, 1 1, 1 0)')))

-Jukka Rahkonen-








--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Executing-a-query-getting-null-layer-tp5313639p5313720.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From neteler at osgeo.org  Wed Mar 22 13:52:00 2017
From: neteler at osgeo.org (Markus Neteler)
Date: Wed, 22 Mar 2017 21:52:00 +0100
Subject: [gdal-dev] [GRASS-user] Slow import of GHSL
In-Reply-To: <CAG+h=FEYH4ku0EbtzDWyHh+1G9bS6OCB+S7k9pkiG9vQ58DSPw@mail.gmail.com>
References: <20170310164700.GC1715@mail.nikosalexandris.net>
 <CALFmHhtmDr=JAPy26qZNT3Gu=0-y7oYFZNWaa6oAsftWX5VayQ@mail.gmail.com>
 <20170311075300.GA4021@mail.nikosalexandris.net>
 <CAG+h=FFC5tR2uL6djz=A0_yBOZ=qBy4w-L2MN0iCEwrZ5FMaNg@mail.gmail.com>
 <CALFmHhuQ=gYvs1XuXm58t8cRdVXUz1i+LJxWVV7CMc2X+DW1cw@mail.gmail.com>
 <CAG+h=FEYH4ku0EbtzDWyHh+1G9bS6OCB+S7k9pkiG9vQ58DSPw@mail.gmail.com>
Message-ID: <CALFmHhv-Y7-hV+GJ2ohO+gqgBveCnCqQ1OCT70eo_LpNAOAfHA@mail.gmail.com>

On Wed, Mar 22, 2017 at 9:28 PM, Markus Metz
<markus.metz.giswork at gmail.com> wrote:
> On Wed, Mar 22, 2017 at 8:12 PM, Markus Neteler <neteler at osgeo.org> wrote:
...
>> Nikos, for an even bigger map try
>>
>> Global Surface Water (2000-2012, 30 m, Data coverage is from 80° north
>> to 60° south):
>> http://landcover.usgs.gov/glc/WaterDescriptionAndDownloads.php
>> by USGS. 1.6GB in size.
>>
>> Using gdalbuildvrt I created a VRT from the 504 GeoTIFF files.
>>
>> After import into GRASS GIS, here the timings:
>>
>> # final map size:
>> g.region -p
>> ...
>> rows:       493200
>> cols:       1296001
>> cells:      639187693200
>>
>> (handling only works in GRASS GIS 7.3.svn since Markus Metz's recent
>> improvements on global data import are needed).
>
> (my changes were bug fixes, not improvements)
>
>>
>> Benchmarks:
>> - Import took 2h while reading the data from a CIFS mounted storage
>> box (slow) and writing on SSD.
>> - Displaying the entire map (639 giga-pixel) in GRASS GIS' display
>> (d.mon) took ~15 sec over a ssh tunnel from my laptop to the server,
>> since I am at a conference.
>>
>> Fair deal I would say :-)
>
> A bit more information would help to compare:
>  - what is your GDAL version?

GDAL 2.1.2

>  - are 504 GeoTIFF files compressed? If yes, which method?

Yes, COMPRESSION=LZW

>  - what are the block dimensions of the input GeoTIFFs?

Size is 36001, 36001  - Block=36001x1
Type=Byte

>  - what kind of GRASS compression did you use?

Default raster + NULL compression enabled. I.e.,

r.compress -p watermask2010
<watermask2010> is compressed (method 2: ZLIB). Data type: CELL
<watermask2010> has a compressed NULL file

Again, the fact that I had to read from an attached storage box likely
slowed down the import.
Just thought to post these numbers here.

markusN

From awilliams at rapidmap.com.au  Wed Mar 22 14:54:54 2017
From: awilliams at rapidmap.com.au (andye)
Date: Wed, 22 Mar 2017 14:54:54 -0700 (MST)
Subject: [gdal-dev] ogr2ogr GML GML_INVERT_AXIS_ORDER_IF_LAT_LONG not
	working
In-Reply-To: <CDE66DE6-2AA9-4606-8049-7DE10B032542@meganet.net>
References: <1490164872057-5313555.post@n6.nabble.com>
 <CDE66DE6-2AA9-4606-8049-7DE10B032542@meganet.net>
Message-ID: <1490219694926-5313743.post@n6.nabble.com>

Thank Norman.

This is the revised command line. Unfortunately it doesn't work either.

ogr2ogr -f GML -spat 151.3085 -24.002934 151.394736 -23.963423 -clipsrc
spat_extent -dsco FORMAT=GML3 -dsco GML3_LONGSRS=NO -dsco
SPACE_INDENTATION=YES -dsco WRITE_FEATURE_BOUNDED_BY=NO -dsco
XSISCHEMA=EXTERNAL -s_srs "+proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0
+axis=enu +wkttext" -t_srs "+proj=longlat +ellps=GRS80
+towgs84=0,0,0,0,0,0,0 +axis=neu +wkttext" "C:\export.gml" "C:\Import.tab"

FYI I have an example of a GML from the same source prepared by FME where
the result is LAT LONG. I'm just trying to replicate the format.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/ogr2ogr-GML-GML-INVERT-AXIS-ORDER-IF-LAT-LONG-not-working-tp5313555p5313743.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From jukka.rahkonen at maanmittauslaitos.fi  Wed Mar 22 15:27:10 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Wed, 22 Mar 2017 15:27:10 -0700 (MST)
Subject: [gdal-dev] ogr2ogr GML GML_INVERT_AXIS_ORDER_IF_LAT_LONG not
	working
In-Reply-To: <1490219694926-5313743.post@n6.nabble.com>
References: <1490164872057-5313555.post@n6.nabble.com>
 <CDE66DE6-2AA9-4606-8049-7DE10B032542@meganet.net>
 <1490219694926-5313743.post@n6.nabble.com>
Message-ID: <1490221630768-5313747.post@n6.nabble.com>

Put a small test 
andye wrote
> FYI I have an example of a GML from the same source prepared by FME where
> the result is LAT LONG. I'm just trying to replicate the format.

Put a small test dataset for "import.tab" so others can try to reproduce.

-Jukka Rahkonen-



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/ogr2ogr-GML-GML-INVERT-AXIS-ORDER-IF-LAT-LONG-not-working-tp5313555p5313747.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From jukka.rahkonen at maanmittauslaitos.fi  Wed Mar 22 15:29:18 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Wed, 22 Mar 2017 15:29:18 -0700 (MST)
Subject: [gdal-dev] ogr2ogr GML GML_INVERT_AXIS_ORDER_IF_LAT_LONG not
	working
In-Reply-To: <1490221630768-5313747.post@n6.nabble.com>
References: <1490164872057-5313555.post@n6.nabble.com>
 <CDE66DE6-2AA9-4606-8049-7DE10B032542@meganet.net>
 <1490219694926-5313743.post@n6.nabble.com>
 <1490221630768-5313747.post@n6.nabble.com>
Message-ID: <1490221758601-5313748.post@n6.nabble.com>

And did you already try simply with -t_srs epsg:4283?

-Jukka-



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/ogr2ogr-GML-GML-INVERT-AXIS-ORDER-IF-LAT-LONG-not-working-tp5313555p5313748.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From Ahmed.Tolba at schiebel.net  Thu Mar 23 01:33:51 2017
From: Ahmed.Tolba at schiebel.net (Ahmed Tolba)
Date: Thu, 23 Mar 2017 08:33:51 +0000
Subject: [gdal-dev] Executing a query getting null layer
In-Reply-To: <1490213561883-5313720.post@n6.nabble.com>
References: <ab0b92ba009b40a880cc73c0c4c4ea3d@SRV046.seg.local>
 <1854011.qjlOGscuma@even-i700>
 <9cdec2e796b1465898f27ffe3afa1b91@SRV046.seg.local>
 <1490189981719-5313646.post@n6.nabble.com>
 <438cd2d4cb4a4550bd85197f9cdfb791@SRV046.seg.local>
 <21291294.hbaMkOLkaF@even-i700>
 <6e67f40a4873464f8e6b3a41f063e1a2@SRV046.seg.local>
 <1490201893390-5313687.post@n6.nabble.com>
 <1490205882596-5313704.post@n6.nabble.com>
 <1490213561883-5313720.post@n6.nabble.com>
Message-ID: <d99d915683134ebdb7cf5285c6da4f84@SRV046.seg.local>

What I'm trying to achieve is to check if 4 points is contained inside the polygon, so I'm doing currently that query with SQLite dialect: 
I'm not sure if its correct or no, I have tried it, but it seems its working, I don't have enough data to test it out, so would you check the query please ?

string query = "SELECT * from areas WHERE st_contains(ST_BuildArea(areas.GEOMETRY),ST_ConvexHull(ST_GeomFromText('MULTIPOINT(16.17951 47.85549, 16.17951 47.85549, 16.17951 47.85549, 16.17951 47.85549)',4326)));";

Thanks 

Ahmed


-----Original Message-----
From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of jratike80
Sent: Wednesday, March 22, 2017 9:13 PM
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Executing a query getting null layer

andreahmed wrote
> I'm using WFS-T. Does ogrinfo support that ? Can you show me the full 
> syntax please. I'm beginner in that topic.

Ok. A few mails ago you wrote "My data is in mapserver database which is PostGres PostGIS. What's the equivalent function for st_linefrommultipoint?"
which made Even and I to provide you advice for PostGIS. So we must take a few steps back because native PostGIS queries cannot be user for WFS datasource.

Your initial problem was perhaps how to convert four corner points into a polygon. There are probably many options but with SQLite dialect I would try ST_ConvexHull

select ST_AsText(
ST_ConvexHull(ST_GeomFromText('MULTIPOINT(0 0, 0 1, 1 1, 1 0)')))

-Jukka Rahkonen-








--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Executing-a-query-getting-null-layer-tp5313639p5313720.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev

From jukka.rahkonen at maanmittauslaitos.fi  Thu Mar 23 02:18:39 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Thu, 23 Mar 2017 02:18:39 -0700 (MST)
Subject: [gdal-dev] Executing a query getting null layer
In-Reply-To: <d99d915683134ebdb7cf5285c6da4f84@SRV046.seg.local>
References: <1854011.qjlOGscuma@even-i700>
 <9cdec2e796b1465898f27ffe3afa1b91@SRV046.seg.local>
 <1490189981719-5313646.post@n6.nabble.com>
 <438cd2d4cb4a4550bd85197f9cdfb791@SRV046.seg.local>
 <21291294.hbaMkOLkaF@even-i700>
 <6e67f40a4873464f8e6b3a41f063e1a2@SRV046.seg.local>
 <1490201893390-5313687.post@n6.nabble.com>
 <1490205882596-5313704.post@n6.nabble.com>
 <1490213561883-5313720.post@n6.nabble.com>
 <d99d915683134ebdb7cf5285c6da4f84@SRV046.seg.local>
Message-ID: <1490260719477-5313820.post@n6.nabble.com>

andreahmed wrote
> What I'm trying to achieve is to check if 4 points is contained inside the
> polygon, so I'm doing currently that query with SQLite dialect: 
> I'm not sure if its correct or no, I have tried it, but it seems its
> working, I don't have enough data to test it out, so would you check the
> query please ?
> 
> string query = "SELECT * from areas WHERE
> st_contains(ST_BuildArea(areas.GEOMETRY),ST_ConvexHull(ST_GeomFromText('MULTIPOINT(16.17951
> 47.85549, 16.17951 47.85549, 16.17951 47.85549, 16.17951
> 47.85549)',4326)));";

Looks good but I do not have your data. You use ST_BuildArea, does it mean
that geometries in areas.GEOMETRY are not polygons? And why all the 4
members in MULTIPOINT and identical?

-Jukka Rahkonen-



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Executing-a-query-getting-null-layer-tp5313639p5313820.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From mcoletti at gmail.com  Thu Mar 23 08:25:04 2017
From: mcoletti at gmail.com (Mark Coletti)
Date: Thu, 23 Mar 2017 11:25:04 -0400
Subject: [gdal-dev] Missing GDALRasterBand::GetActualBlockSize
Message-ID: <CAHpqhBMHj=dxL-sbsH5cvjRU799x8L1fixD-X9gap0XLDqVPMA@mail.gmail.com>

I was following the documentation for GDALRasterBand::ReadBlock
<http://www.gdal.org/classGDALRasterBand.html#ad80cecc562fd48f5783677de625360ac>()
and noted that the example code invoked GetActualBlockSize(), which does
not appear to exist.  Has this function been deprecated?  Do I have a stale
version of GDAL?  I've grepped for that function in both the 1.11 and 2.1
"include" hierarchies and was not able to find it.


Cheers,

Mark
-- 
mcoletti at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170323/56c959ff/attachment-0001.html>

From even.rouault at spatialys.com  Thu Mar 23 12:08:03 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 23 Mar 2017 20:08:03 +0100
Subject: [gdal-dev] Missing GDALRasterBand::GetActualBlockSize
In-Reply-To: <CAHpqhBMHj=dxL-sbsH5cvjRU799x8L1fixD-X9gap0XLDqVPMA@mail.gmail.com>
References: <CAHpqhBMHj=dxL-sbsH5cvjRU799x8L1fixD-X9gap0XLDqVPMA@mail.gmail.com>
Message-ID: <6212479.DHbfUBCoZ6@even-i700>

On jeudi 23 mars 2017 11:25:04 CET Mark Coletti wrote:
> GetActualBlockSize

http://www.gdal.org/
classGDALRasterBand.html#a485fea52a1c2b7202ae5c806c9f9b65e

"""
Since
GDAL 2.2 
"""

;-)

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170323/3de8ab9d/attachment.html>

From nik at nikosalexandris.net  Fri Mar 24 02:25:52 2017
From: nik at nikosalexandris.net (Nikos Alexandris)
Date: Fri, 24 Mar 2017 10:25:52 +0100
Subject: [gdal-dev] [GRASS-user] Slow import of GHSL
In-Reply-To: <CAG+h=FEpWNR242WXzUKNc6btSVxd2B5vn-73kY1hxUnrS0Swyg@mail.gmail.com>
References: <20170310164700.GC1715@mail.nikosalexandris.net>
 <CALFmHhtmDr=JAPy26qZNT3Gu=0-y7oYFZNWaa6oAsftWX5VayQ@mail.gmail.com>
 <20170311075300.GA4021@mail.nikosalexandris.net>
 <CAG+h=FFC5tR2uL6djz=A0_yBOZ=qBy4w-L2MN0iCEwrZ5FMaNg@mail.gmail.com>
 <CALFmHhuQ=gYvs1XuXm58t8cRdVXUz1i+LJxWVV7CMc2X+DW1cw@mail.gmail.com>
 <CAG+h=FEYH4ku0EbtzDWyHh+1G9bS6OCB+S7k9pkiG9vQ58DSPw@mail.gmail.com>
 <CALFmHhv-Y7-hV+GJ2ohO+gqgBveCnCqQ1OCT70eo_LpNAOAfHA@mail.gmail.com>
 <CAG+h=FEpWNR242WXzUKNc6btSVxd2B5vn-73kY1hxUnrS0Swyg@mail.gmail.com>
Message-ID: <20170324092552.GA30271@mail.nikosalexandris.net>

(Sorry for silence, was without my personal computer for a week.)


* Markus Metz <markus.metz.giswork at gmail.com> [2017-03-22 22:11:01 +0100]:

>On Wed, Mar 22, 2017 at 9:52 PM, Markus Neteler <neteler at osgeo.org> wrote:
>>
>> On Wed, Mar 22, 2017 at 9:28 PM, Markus Metz
>> <markus.metz.giswork at gmail.com> wrote:
>> > On Wed, Mar 22, 2017 at 8:12 PM, Markus Neteler <neteler at osgeo.org>
>wrote:
>> ...
>> >> Nikos, for an even bigger map try
>> >>
>> >> Global Surface Water (2000-2012, 30 m, Data coverage is from 80° north
>> >> to 60° south):
>> >> http://landcover.usgs.gov/glc/WaterDescriptionAndDownloads.php
>> >> by USGS. 1.6GB in size.

Interesting this is. See also:
https://global-surface-water.appspot.com/, at 30m, Landsat-based as
well.


>> >> Using gdalbuildvrt I created a VRT from the 504 GeoTIFF files.
>> >>
>> >> After import into GRASS GIS, here the timings:
>> >>
>> >> # final map size:
>> >> g.region -p
>> >> ...
>> >> rows:       493200
>> >> cols:       1296001
>> >> cells:      639187693200
>> >>
>> >> (handling only works in GRASS GIS 7.3.svn since Markus Metz's recent
>> >> improvements on global data import are needed).
>> >
>> > (my changes were bug fixes, not improvements)
>> >
>> >>
>> >> Benchmarks:
>> >> - Import took 2h while reading the data from a CIFS mounted storage
>> >> box (slow) and writing on SSD.

Markus N, I am interested: did you use the "memory" option?

>> >> - Displaying the entire map (639 giga-pixel) in GRASS GIS' display
>> >> (d.mon) took ~15 sec over a ssh tunnel from my laptop to the server,
>> >> since I am at a conference.
>> >>
>> >> Fair deal I would say :-)
>> >
>> > A bit more information would help to compare:
>> >  - what is your GDAL version?
>>
>> GDAL 2.1.2
>>
>> >  - are 504 GeoTIFF files compressed? If yes, which method?
>>
>> Yes, COMPRESSION=LZW
>>
>> >  - what are the block dimensions of the input GeoTIFFs?
>>
>> Size is 36001, 36001  - Block=36001x1

Now that's important too.  What about GHSL's block size of 4K^2?
My understanding is that it would make a difference, for GRASS, if I
would redo the GHSL layers with a row-shaped "block".  Makes sense?

>This is row by row compression as in GRASS. That could help import with
>r.in.gdal which also reads and writes row by row.
>
>> Type=Byte
>>
>> >  - what kind of GRASS compression did you use?
>>
>> Default raster + NULL compression enabled. I.e.,
>>
>> r.compress -p watermask2010
>> <watermask2010> is compressed (method 2: ZLIB). Data type: CELL
>
>You might save disk space at the cost of longer reading times with BZIP2.
>
>> <watermask2010> has a compressed NULL file
>>
>> Again, the fact that I had to read from an attached storage box likely
>> slowed down the import.
>> Just thought to post these numbers here.
>
>Impressive that such a large raster can be imported at all, and relatively
>fasto!

Indeed, impressive.

Nikos

>Reading about 1.6 GB (also from an attached storage box) should not take 2
>hours, therefore I think the limit is software input decompression and
>output compression.
>
>Markus M

From nik at nixanz.com  Fri Mar 24 02:33:31 2017
From: nik at nixanz.com (Nik Sands)
Date: Fri, 24 Mar 2017 20:33:31 +1100
Subject: [gdal-dev] OGR_L_SetFeature() randomly crashes with EXC_BAD_ACCESS
	in sqlite3
Message-ID: <22380E3E-F12D-4522-A2BD-9BA80DFFE389@nixanz.com>

Hello dev list,

I’m using GDAL 2.1.2 in an iOS app (statically linked).  When executing OGR_L_SetFeature() it usually works fine, but randomly crashes with EXC_BAD_ACCESS.

The crash is in sqlite3 and appears to be due to dereferencing a NULL pointer, as far as I can tell from the back trace.

In my app, the crash occurs when I call, "OGR_L_SetFeature(layer, feature)”, at which point both “layer” and “feature” are non-NULL, and the layer is in a GeoPackage data source.

The top of the back trace is:

MyApp`sqlite3_clear_bindings(pStmt=0x0000000000000000) + 24 at sqlite3.c:75797, queue = 'com.apple.main-thread', stop reason = EXC_BAD_ACCESS (code=1, address=0x0)
    frame #0: 0x000000010012684c MyApp`sqlite3_clear_bindings(pStmt=0x0000000000000000) + 24 at sqlite3.c:75797 [opt]
    frame #1: 0x00000001005c0770 MyApp`OGRGeoPackageTableLayer::ISetFeature(this=0x000000010134af10, poFeature=0x0000000174097750) + 440 at ogrgeopackagetablelayer.cpp:1441 [opt]
  * frame #2: 0x00000001000b0074 MyApp`-[VectorFeature syncToDisk](self=0x000000017422cd00, _cmd="syncToDisk") + 92 at VectorFeature.m:56

I don’t know enough about the SQLite or GeoPackage code to make any sensible progress on this.  Can somebody please point me in the right direction to figure out what I’m doing wrong?

Cheers,
Nik.

From jukka.rahkonen at maanmittauslaitos.fi  Fri Mar 24 03:20:42 2017
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Fri, 24 Mar 2017 10:20:42 +0000
Subject: [gdal-dev] Ogrinfo does not open any more raster-only geopackage
Message-ID: <84496e408a1f46ba9cca4cdae8a5a855@C119S212VM022.msvyvi.vaha.local>

Hi,

Recent GDAL 2.2-dev versions can't open geopackage that contains only raster data.
ogrinfo -ro -sql "PRAGMA journal_mode" raster.gpkg

I found a 2.2-dev version from 2016-12-09 and that does run my PRAGMA query.  Could it be possible to get this possibility back?

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170324/654b80c4/attachment.html>

From neteler at osgeo.org  Fri Mar 24 06:09:00 2017
From: neteler at osgeo.org (Markus Neteler)
Date: Fri, 24 Mar 2017 14:09:00 +0100
Subject: [gdal-dev] [GRASS-user] Slow import of GHSL
In-Reply-To: <20170324092552.GA30271@mail.nikosalexandris.net>
References: <20170310164700.GC1715@mail.nikosalexandris.net>
 <CALFmHhtmDr=JAPy26qZNT3Gu=0-y7oYFZNWaa6oAsftWX5VayQ@mail.gmail.com>
 <20170311075300.GA4021@mail.nikosalexandris.net>
 <CAG+h=FFC5tR2uL6djz=A0_yBOZ=qBy4w-L2MN0iCEwrZ5FMaNg@mail.gmail.com>
 <CALFmHhuQ=gYvs1XuXm58t8cRdVXUz1i+LJxWVV7CMc2X+DW1cw@mail.gmail.com>
 <CAG+h=FEYH4ku0EbtzDWyHh+1G9bS6OCB+S7k9pkiG9vQ58DSPw@mail.gmail.com>
 <CALFmHhv-Y7-hV+GJ2ohO+gqgBveCnCqQ1OCT70eo_LpNAOAfHA@mail.gmail.com>
 <CAG+h=FEpWNR242WXzUKNc6btSVxd2B5vn-73kY1hxUnrS0Swyg@mail.gmail.com>
 <20170324092552.GA30271@mail.nikosalexandris.net>
Message-ID: <CALFmHhv4+hh1-HZ3ZXMQEqTtKY37_6gJBk6UGM0-p62+ions-A@mail.gmail.com>

On Fri, Mar 24, 2017 at 10:25 AM, Nikos Alexandris
<nik at nikosalexandris.net> wrote:
> * Markus Metz <markus.metz.giswork at gmail.com> [2017-03-22 22:11:01 +0100]:
>> On Wed, Mar 22, 2017 at 9:52 PM, Markus Neteler <neteler at osgeo.org> wrote:

...
> Markus N, I am interested: did you use the "memory" option?

I left r.in.gdal's default value.

...
> My understanding is that it would make a difference, for GRASS, if I
> would redo the GHSL layers with a row-shaped "block".  Makes sense?

Why spend time on redoing the GHSL layers? Do you have to import them
frequently?

markusN

From jukka.rahkonen at maanmittauslaitos.fi  Fri Mar 24 06:36:35 2017
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Fri, 24 Mar 2017 13:36:35 +0000
Subject: [gdal-dev] Can't edit alpha in palette through VRT
Message-ID: <26227b35952e430496d96f14105afa57@C119S212VM022.msvyvi.vaha.local>

Hi,

I am following the FAQ "How to create or modify an image color table?" from https://trac.osgeo.org/gdal/wiki/FAQRaster

I took out the palette from existing tiff file into VRT and I would like to change alpha value of the first input from 255 into 0.

I had originally this:

<VRTDataset rasterXSize="734" rasterYSize="565">
  <VRTRasterBand dataType="Byte" band="1">
    <ColorInterp>Palette</ColorInterp>
    <ColorTable>
      <Entry c1="255" c2="255" c3="255" c4="255" />
      <Entry c1="0" c2="0" c3="0" c4="255" />
  ...
Then I edited the VRT into

    <ColorTable>
      <Entry c1="60" c2="255" c3="255" c4="0" />
      <Entry c1="0" c2="0" c3="0" c4="255" />
...


Then I executed
gdal_translate fixed_palette.vrt fixed palette.tif

However, the result is not exactly what I hoped for:

Band 1 Block=734x11 Type=Byte, ColorInterp=Palette
  Color Table (RGB with 256 entries)
    0: 60,255,255,255
    1: 0,0,0,255

The value "60" for the red band is taken from my edited palette but my edited alpha value is  not honored. Am I doing something wrong?

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170324/38b8495d/attachment-0001.html>

From even.rouault at spatialys.com  Fri Mar 24 06:41:16 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 24 Mar 2017 14:41:16 +0100
Subject: [gdal-dev] Ogrinfo does not open any more raster-only geopackage
In-Reply-To: <84496e408a1f46ba9cca4cdae8a5a855@C119S212VM022.msvyvi.vaha.local>
References: <84496e408a1f46ba9cca4cdae8a5a855@C119S212VM022.msvyvi.vaha.local>
Message-ID: <6291362.B4vs9fZWmp@even-i700>

On vendredi 24 mars 2017 10:20:42 CET Rahkonen Jukka (MML) wrote:
> Hi,
> 
> Recent GDAL 2.2-dev versions can't open geopackage that contains only raster
> data. ogrinfo -ro -sql "PRAGMA journal_mode" raster.gpkg

Hi Jukka,

I could only reproduce with a .gpkg that didn't have a gpkg_geometry_columns table. Which 
is valid, but not what GDAL creates, so I guess this comes from another software ?

I've just pushed a commit with 3 changes :

- accept opening a .gpkg without vector content and without gpkg_geometry_columns table 
in vector mode if we also open in update mode.
==> So that means in your above case you must remove the -ro flag

- remove capability of opening a .gpkg without vector content but with 
gpkg_geometry_columns table in vector mode if we only open in read-only mode
==> this is for consistency with the above behaviour.
Summary is : if you open in vector mode something that has no vector, it doesn't make sense 
in read-only mode for most use cases (think to a vector-only capable software that would 
face a raster-only .gpkg). For advanced use cases, you need to specify the update mode (ie 
remove the -ro flag). Or if you exclude the GPKG driver completely with --config OGR_SKIP 
GPKG, the SQLite driver will be used as a fallback.

- fix creation of a vector layer in a database if it initially lacks a gpkg_geometry_columns table


The very small core of the geopackage specification makes it quite tricky to support all 
potential combinations of valid GeoPackage.


Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170324/2c2c72e3/attachment.html>

From even.rouault at spatialys.com  Fri Mar 24 06:50:14 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 24 Mar 2017 14:50:14 +0100
Subject: [gdal-dev] OGR_L_SetFeature() randomly crashes with
	EXC_BAD_ACCESS in sqlite3
In-Reply-To: <22380E3E-F12D-4522-A2BD-9BA80DFFE389@nixanz.com>
References: <22380E3E-F12D-4522-A2BD-9BA80DFFE389@nixanz.com>
Message-ID: <1958769.6drL3qQQQ4@even-i700>

On vendredi 24 mars 2017 20:33:31 CET Nik Sands wrote:
> Hello dev list,
> 
> I’m using GDAL 2.1.2 in an iOS app (statically linked).  When executing
> OGR_L_SetFeature() it usually works fine, but randomly crashes with
> EXC_BAD_ACCESS.
> 
> The crash is in sqlite3 and appears to be due to dereferencing a NULL
> pointer, as far as I can tell from the back trace.
> 
> In my app, the crash occurs when I call, "OGR_L_SetFeature(layer, feature)”,
> at which point both “layer” and “feature” are non-NULL, and the layer is in
> a GeoPackage data source.
> 
> The top of the back trace is:
> 
> MyApp`sqlite3_clear_bindings(pStmt=0x0000000000000000) + 24 at
> sqlite3.c:75797, queue = 'com.apple.main-thread', stop reason =
> EXC_BAD_ACCESS (code=1, address=0x0) frame #0: 0x000000010012684c
> MyApp`sqlite3_clear_bindings(pStmt=0x0000000000000000) + 24 at
> sqlite3.c:75797 [opt] frame #1: 0x00000001005c0770
> MyApp`OGRGeoPackageTableLayer::ISetFeature(this=0x000000010134af10,
> poFeature=0x0000000174097750) + 440 at ogrgeopackagetablelayer.cpp:1441
> [opt] * frame #2: 0x00000001000b0074 MyApp`-[VectorFeature
> syncToDisk](self=0x000000017422cd00, _cmd="syncToDisk") + 92 at
> VectorFeature.m:56
> 
> I don’t know enough about the SQLite or GeoPackage code to make any sensible
> progress on this.  Can somebody please point me in the right direction to
> figure out what I’m doing wrong?

I've reviewed the code inf the GPKG driver and can't find anything wrong in it just with that. 
Particularly I can't see how the pStmt can be NULL at  the point where sqlite3_clear_bindings 
is called.

Is your issue really random ? If so; that might be a memory corruption elsewhere. If so, I 
would run valgrind on your code (I know it is available on the Mac, but perhaps not on iOS) on 
a debug version.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170324/d791210a/attachment.html>

From even.rouault at spatialys.com  Fri Mar 24 06:51:56 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 24 Mar 2017 14:51:56 +0100
Subject: [gdal-dev] Can't edit alpha in palette through VRT
In-Reply-To: <26227b35952e430496d96f14105afa57@C119S212VM022.msvyvi.vaha.local>
References: <26227b35952e430496d96f14105afa57@C119S212VM022.msvyvi.vaha.local>
Message-ID: <2989612.zhquheoEIX@even-i700>

On vendredi 24 mars 2017 13:36:35 CET Rahkonen Jukka (MML) wrote:
> Hi,
> 
> I am following the FAQ "How to create or modify an image color table?" from
> https://trac.osgeo.org/gdal/wiki/FAQRaster
> 
> I took out the palette from existing tiff file into VRT and I would like to
> change alpha value of the first input from 255 into 0.
> 
> I had originally this:
> 
> <VRTDataset rasterXSize="734" rasterYSize="565">
>   <VRTRasterBand dataType="Byte" band="1">
>     <ColorInterp>Palette</ColorInterp>
>     <ColorTable>
>       <Entry c1="255" c2="255" c3="255" c4="255" />
>       <Entry c1="0" c2="0" c3="0" c4="255" />
>   ...
> Then I edited the VRT into
> 
>     <ColorTable>
>       <Entry c1="60" c2="255" c3="255" c4="0" />
>       <Entry c1="0" c2="0" c3="0" c4="255" />
> ...
> 
> 
> Then I executed
> gdal_translate fixed_palette.vrt fixed palette.tif
> 
> However, the result is not exactly what I hoped for:
> 
> Band 1 Block=734x11 Type=Byte, ColorInterp=Palette
>   Color Table (RGB with 256 entries)
>     0: 60,255,255,255
>     1: 0,0,0,255
> 
> The value "60" for the red band is taken from my edited palette but my
> edited alpha value is  not honored. Am I doing something wrong?

No, this is a TIFF limitation. The format doesn't support the alpha component in color tables.
You might workaround this by setting the NODATA value to 0 instead.

> 
> -Jukka Rahkonen-


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170324/34769b4d/attachment-0001.html>

From issam1975 at live.fr  Sat Mar 25 10:20:46 2017
From: issam1975 at live.fr (issam boughanmi)
Date: Sat, 25 Mar 2017 17:20:46 +0000
Subject: [gdal-dev] Exporting to raw file using
Message-ID: <AM5P194MB0097A71D66B18EB20E984A63B9310@AM5P194MB0097.EURP194.PROD.OUTLOOK.COM>

hi,

I have an SRTM TIFF file that I want to export to a raw file that Unreal Engine can handle.

Here is its window info inside MicroDEM

[cid:116abb30-4225-4b58-8ea3-abfc5be64f6f]

According to the UE4 documentation the raw file must be 16-bit, grayscale RAW file in little-endian byte order (not sure what this means).

Is there a way with the GDAL tool to export to that specified format ?


BTW : According to gdalinfo the data type for the same file are Int16 and not 4 byte real

[cid:f6a62e8c-1b38-4c7b-95fd-a53ee1faf411]

So I am a little confused ...


any help is welcome, thanks !

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170325/b71c8a39/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: md.jpg
Type: image/jpeg
Size: 14971 bytes
Desc: md.jpg
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170325/b71c8a39/attachment-0002.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: gdal.jpg
Type: image/jpeg
Size: 10932 bytes
Desc: gdal.jpg
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170325/b71c8a39/attachment-0003.jpg>

From jukka.rahkonen at maanmittauslaitos.fi  Sun Mar 26 06:30:31 2017
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Sun, 26 Mar 2017 13:30:31 +0000
Subject: [gdal-dev] Ogrinfo does not open any more raster-only geopackage
In-Reply-To: <6291362.B4vs9fZWmp@even-i700>
References: <84496e408a1f46ba9cca4cdae8a5a855@C119S212VM022.msvyvi.vaha.local>,
 <6291362.B4vs9fZWmp@even-i700>
Message-ID: <1490535033293.21005@maanmittauslaitos.fi>

Even Rouault wrote:
Re: [gdal-dev] Ogrinfo does not open any more raster-only geopackage


> Hi Jukka,

> I could only reproduce with a .gpkg that didn't have a gpkg_geometry_columns table. Which is valid, but not what GDAL creates, so I guess this comes from another software ?


That GeoPackage was generated by MapProxy https://mapproxy.org/docs/nightly/caches.html#geopackage

Should I encourage MapProxy developers to create also an empty gpkg_geometry_columns table in the future for enhanced interoperability?

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170326/793cf58b/attachment.html>

From even.rouault at spatialys.com  Sun Mar 26 06:41:51 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 26 Mar 2017 15:41:51 +0200
Subject: [gdal-dev] Ogrinfo does not open any more raster-only geopackage
In-Reply-To: <1490535033293.21005@maanmittauslaitos.fi>
References: <84496e408a1f46ba9cca4cdae8a5a855@C119S212VM022.msvyvi.vaha.local>
 <6291362.B4vs9fZWmp@even-i700> <1490535033293.21005@maanmittauslaitos.fi>
Message-ID: <1708330.JlZEf8Rz1f@even-i700>

On dimanche 26 mars 2017 13:30:31 CEST Rahkonen Jukka (MML) wrote:
> Even Rouault wrote:
> Re: [gdal-dev] Ogrinfo does not open any more raster-only geopackage
> 
> > Hi Jukka,
> > 
> > I could only reproduce with a .gpkg that didn't have a
> > gpkg_geometry_columns table. Which is valid, but not what GDAL creates,
> > so I guess this comes from another software ?
> That GeoPackage was generated by MapProxy
> https://mapproxy.org/docs/nightly/caches.html#geopackage
> 
> Should I encourage MapProxy developers to create also an empty
> gpkg_geometry_columns table in the future for enhanced interoperability?

It is their call. It is legal for raster GeoPackage not to have it (and I guess gdalinfo 
/ gdal_translate was happy on it ?). But it shouldn't hurt to have it either.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170326/eba4e62b/attachment.html>

From awilliams at rapidmap.com.au  Sun Mar 26 20:02:33 2017
From: awilliams at rapidmap.com.au (andye)
Date: Sun, 26 Mar 2017 20:02:33 -0700 (MST)
Subject: [gdal-dev] ogr2ogr GML GML_INVERT_AXIS_ORDER_IF_LAT_LONG not
	working
In-Reply-To: <1490221758601-5313748.post@n6.nabble.com>
References: <1490164872057-5313555.post@n6.nabble.com>
 <CDE66DE6-2AA9-4606-8049-7DE10B032542@meganet.net>
 <1490219694926-5313743.post@n6.nabble.com>
 <1490221630768-5313747.post@n6.nabble.com>
 <1490221758601-5313748.post@n6.nabble.com>
Message-ID: <1490583753610-5314350.post@n6.nabble.com>

Input.zip <http://osgeo-org.1560.x6.nabble.com/file/n5314350/Input.zip>  
OutputOGR2OGR.GML
<http://osgeo-org.1560.x6.nabble.com/file/n5314350/OutputOGR2OGR.GML>  
OutputQGIS.gml
<http://osgeo-org.1560.x6.nabble.com/file/n5314350/OutputQGIS.gml>  
OutputMI.gml
<http://osgeo-org.1560.x6.nabble.com/file/n5314350/OutputMI.gml>  

As suggested Jukka here is an example (in the zip file) of a Mapinfo TAB
file. the three GML files show an ogr2ogr conversion, QGIS conversion and
Mapinfo conversion to GML.

Here is the very simple command line I used to create the ogr2oge output.

ogr2ogr -f GML -t_srs "EPSG:4283" "C:\Output.GML" "C:\Input.TAB"

The issue as previously stated is the order of the latitude and longitude.
The Mapinfo(Universal translator built on FME) produces a LAT\LONG order by
default.

The ogr2 and QGIS both produce LONG\LAT. 

Given the description on http://www.gdal.org/drv_gml.html

I added GML_INVERT_AXIS_ORDER_IF_LAT_LONG NO

ogr2ogr -f GML --config GML_INVERT_AXIS_ORDER_IF_LAT_LONG NO -t_srs
"EPSG:4283" "C:\Output.GML" "C:\Input.TAB"

The result is unaltered.

I also tried adding GML_CONSIDER_EPSG_AS_URN YES

ogr2ogr -f GML --config GML_INVERT_AXIS_ORDER_IF_LAT_LONG NO --config
GML_CONSIDER_EPSG_AS_URN YES -t_srs "EPSG:4283" "C:\Output.GML"
"C:\Input.TAB"

No effect.

What am I missing?




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/ogr2ogr-GML-GML-INVERT-AXIS-ORDER-IF-LAT-LONG-not-working-tp5313555p5314350.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From jukka.rahkonen at maanmittauslaitos.fi  Sun Mar 26 23:17:53 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Sun, 26 Mar 2017 23:17:53 -0700 (MST)
Subject: [gdal-dev] ogr2ogr GML GML_INVERT_AXIS_ORDER_IF_LAT_LONG not
	working
In-Reply-To: <1490583753610-5314350.post@n6.nabble.com>
References: <1490164872057-5313555.post@n6.nabble.com>
 <CDE66DE6-2AA9-4606-8049-7DE10B032542@meganet.net>
 <1490219694926-5313743.post@n6.nabble.com>
 <1490221630768-5313747.post@n6.nabble.com>
 <1490221758601-5313748.post@n6.nabble.com>
 <1490583753610-5314350.post@n6.nabble.com>
Message-ID: <1490595473150-5314360.post@n6.nabble.com>

Hi,

I am not sure if the coordinate system dependent axis order was defined or
not in GML2. At least all the WFS v. 1.0.0 servers that I know and which
have GML2 as the default outputformat always produce longitude-latitude
coordinates. Therefore I would not even try to create GML2 as
latitude-longitude but I would use GML3.

With your data this command creates GML3 output with latitude-longitude axis
order. 

ogr2ogr -f gml -dsco format=gml3 -a_srs epsg:4283 test.gml input.tab 

Part of the output:
<gml:boundedBy><gml:Envelope
srsName="urn:ogc:def:crs:EPSG::4283"><gml:lowerCorner>-23.991034
151.319939</gml:lowerCorner

-Jukka Rahkonen-



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/ogr2ogr-GML-GML-INVERT-AXIS-ORDER-IF-LAT-LONG-not-working-tp5313555p5314360.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From ao at t-kartor.se  Sun Mar 26 23:50:05 2017
From: ao at t-kartor.se (Andreas Oxenstierna)
Date: Mon, 27 Mar 2017 08:50:05 +0200
Subject: [gdal-dev] gdaladdo pyramids with incorrect NULL values
Message-ID: <6150b0a5-f1de-eb8c-c3c4-5779af297fa2@t-kartor.se>

Hi list

We have an issue were the pyramids as created by gdaladdo is not 
correctly handling NULL values

Create a 3 band tiff with proper null values (0 is null) - see 
https://www.dropbox.com/s/99rq1zflnuwah20/correctnulls.png?dl=0
   gdalwarp -r cubic -s_srs epsg:32633 -srcnodata 0 -dstnodata 0 -t_srs 
epsg:3857 -multi -wm 1000 -overwrite -co TILED=YES -co COMPRESS=DEFLATE 
input.tif output.tif

Adding pyramids with either JPEG or Deflate compression results in non-0 
values - see 
https://www.dropbox.com/s/24jk0rsznme5s3h/pyramid_faultynulls.png?dl=0
gdaladdo -r cubic --config COMPRESS_OVERVIEW JPEG --config 
JPEG_QUALITY_OVERVIEW 75 --config INTERLEAVE_OVERVIEW PIXEL --config 
PHOTOMETRIC_OVERVIEW YCBCR  LFC_output.tif 2 5 6 12 25 62 125 250 500
or
gdaladdo -r cubic --config COMPRESS_OVERVIEW DEFLATE output.tif 2 5 6 12 
25 62 125 250 500

What are we missing?


-- 
Best regards

Andreas Oxenstierna
T-Kartor Geospatial AB
mobile: +46 733 206831
mailto: ao at t-kartor.se
http://www.t-kartor.com


From nickhatz at csu.fullerton.edu  Mon Mar 27 14:52:01 2017
From: nickhatz at csu.fullerton.edu (Nikolaos Hatzopoulos)
Date: Mon, 27 Mar 2017 14:52:01 -0700
Subject: [gdal-dev] GSOC
Message-ID: <CAHuBFwp3DWY6ySRJ0j9CiT+njNiwitNEONjJZwjxugfsurpSwg@mail.gmail.com>

Hello,

I am a student that I am trying to find a mentor related to gdal
programming and image enhancement.

Is there anyone who wants to mentor such a project?

Regards,

-- Nikos
Ms Student Software Engineering
Cal State Fullerton
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170327/26d364ba/attachment.html>

From diregola at gmail.com  Tue Mar 28 00:10:19 2017
From: diregola at gmail.com (Margherita Di Leo)
Date: Tue, 28 Mar 2017 09:10:19 +0200
Subject: [gdal-dev] GSOC
In-Reply-To: <CAHuBFwp3DWY6ySRJ0j9CiT+njNiwitNEONjJZwjxugfsurpSwg@mail.gmail.com>
References: <CAHuBFwp3DWY6ySRJ0j9CiT+njNiwitNEONjJZwjxugfsurpSwg@mail.gmail.com>
Message-ID: <CABa=8QposAoYTZGFm9azM15ghmpq-PuKcx+T=QWkCaWgGtmvvQ@mail.gmail.com>

Hi,

On Mon, Mar 27, 2017 at 11:52 PM, Nikolaos Hatzopoulos <
nickhatz at csu.fullerton.edu> wrote:

> Hello,
>
> I am a student that I am trying to find a mentor related to gdal
> programming and image enhancement.
>
> Is there anyone who wants to mentor such a project?
>
> Regards,
>
> -- Nikos
> Ms Student Software Engineering
> Cal State Fullerton
>

to the attention of possible mentors: We don't have yet registered mentors
for gdal. I would like to remind that it is still possible to register as a
mentor, appointing yourselves here
https://wiki.osgeo.org/wiki/Google_Summer_of_Code_2017_Administrative . An
invite to join the gsoc platform will follow.

Regards,

-- 
Margherita Di Leo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170328/1b779678/attachment.html>

From Benno.Wiss at softec.ch  Tue Mar 28 00:53:40 2017
From: Benno.Wiss at softec.ch (Wiss, Benno (Softec))
Date: Tue, 28 Mar 2017 09:53:40 +0200
Subject: [gdal-dev] Why are vertices slightly different when writing and
	rereading geomtries using OgrInfo and Esri.FileGDBAPI
Message-ID: <2c59c0af05524eecb36eed600465499e@softec.ch>

Hi,

Using the C# GDAL FileGDB API V 1.5 (https://trac.osgeo.org/gdal/wiki/FileGDB) I have written a simple test application which writes and rereads a polygon geometry. The  test FileGDB is using WKID 21781 (CH1903_LV03), XYScale of 20'000 and  XYTolerance of 0.0004. 
Using the test application I have written a polygon with the following coordinates 
    POLYGON((
    660440.402                232655.598, 
    660419.723456789  232646.789153456, 
    660398.588123         232712.410135, 
    660477.806                232751.485, ...))

Reading the polygon using OgrInfo gets following coordinates
    MULTIPOLYGON (((
    660440.402                232655.598, 
    660419.723450001  232646.78915,
    660398.588100001  232712.410149999, 
    660477.806                232751.485, ...)))"

Rereading the geometry using the C# Esri.FileGDBAPI gets following coordinates
    point[0]  660440.40199999884   232655.59800000116
    point[1]  660419.72345000133   232646.78914999962
    point[2]  660398.58810000122   232712.41014999896
    point[3]  660477.80600000173   232751.4849999994 
    ...

Regarding the XYScale of 20'000 it is correct that the position 660398.588123 is altered to 660398.58810.  But considering the value of 660398.588100001 the coordinates seems not to be stored as whole numbers. 
Using the Esri.FileGDBAPI the values differ even more. It seems to be a floating point accuracy problem but I don't really understand why. How are the coordinates stored in FileGDB and why does the read values differ between OgrInfo and Esri.FileGDBAPI? 

Thanks in anticipation
Benno Wiss

From even.rouault at spatialys.com  Tue Mar 28 04:38:28 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 28 Mar 2017 13:38:28 +0200
Subject: [gdal-dev] Why are vertices slightly different when writing and
	rereading geomtries using OgrInfo and Esri.FileGDBAPI
In-Reply-To: <2c59c0af05524eecb36eed600465499e@softec.ch>
References: <2c59c0af05524eecb36eed600465499e@softec.ch>
Message-ID: <2384223.0oISJp0hYt@even-i700>

On mardi 28 mars 2017 09:53:40 CEST Wiss, Benno (Softec) wrote:
> Hi,
> 
> Using the C# GDAL FileGDB API V 1.5
> (https://trac.osgeo.org/gdal/wiki/FileGDB) I have written a simple test
> application which writes and rereads a polygon geometry. The  test FileGDB
> is using WKID 21781 (CH1903_LV03), XYScale of 20'000 and  XYTolerance of
> 0.0004. Using the test application I have written a polygon with the
> following coordinates POLYGON((
>     660440.402                232655.598,
>     660419.723456789  232646.789153456,
>     660398.588123         232712.410135,
>     660477.806                232751.485, ...))
> 
> Reading the polygon using OgrInfo gets following coordinates
>     MULTIPOLYGON (((
>     660440.402                232655.598,
>     660419.723450001  232646.78915,
>     660398.588100001  232712.410149999,
>     660477.806                232751.485, ...)))"
> 
> Rereading the geometry using the C# Esri.FileGDBAPI gets following
> coordinates point[0]  660440.40199999884   232655.59800000116
>     point[1]  660419.72345000133   232646.78914999962
>     point[2]  660398.58810000122   232712.41014999896
>     point[3]  660477.80600000173   232751.4849999994
>     ...
> 
> Regarding the XYScale of 20'000 it is correct that the position
> 660398.588123 is altered to 660398.58810.  But considering the value of
> 660398.588100001 the coordinates seems not to be stored as whole numbers.

They are *stored* as whole numbers, but then they are scaled to real numbers who have no 
exact decimal representations. In OGR coordinates are stored as 64 bit IEEE754 floating 
point values. And then printed to decimal with an arbitrary number of decimal that doesn't 
take into account the FileGDB precision.

> Using the Esri.FileGDBAPI the values differ even more. It seems to be a
> floating point accuracy problem but I don't really understand why.

Probably just a difference in the formatting of the output

> How are
> the coordinates stored in FileGDB and why does the read values differ
> between OgrInfo and Esri.FileGDBAPI?
> 
> Thanks in anticipation
> Benno Wiss
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170328/b445e409/attachment.html>

From gregory.bataille at gmail.com  Tue Mar 28 04:51:50 2017
From: gregory.bataille at gmail.com (=?UTF-8?Q?Gr=C3=A9gory_Bataille?=)
Date: Tue, 28 Mar 2017 13:51:50 +0200
Subject: [gdal-dev] Help requested: Concurrent read of a GeoTiff
In-Reply-To: <CACVcCzrOpOmBQmq5foaZCT7Dmy4hxaT-tCCP=FG3Oc3q2PRmYQ@mail.gmail.com>
References: <CACVcCzoQ-oQ6_kBUzquOUEDQydZsLckE4QUZg801UkKE2Nc-ZQ@mail.gmail.com>
 <CACVcCzrHSqT08x6bUQRurRR=mx-9xsYbxCTd6LzyXSq1uqs=jw@mail.gmail.com>
 <CACVcCzpRCtL6AL0pYj1Vzos4EXMQufV=EAVMYCnnp6abc=p5qA@mail.gmail.com>
 <1564776.2bLv9j4bHn@even-i700>
 <CACVcCzrOpOmBQmq5foaZCT7Dmy4hxaT-tCCP=FG3Oc3q2PRmYQ@mail.gmail.com>
Message-ID: <CACVcCzp5Wc__SyNj5GzwGwJQj=wPje56dWJeB+bWr0HX91nOqA@mail.gmail.com>

Hey,

just to let you know, I found the issue.
So I think it has to do with the fact that I keep some handles opened on
the original TIFF In the parent thread. Even setting the variable to None
does not change anything, but I guess it's because the garbage collector is
asynchronous.
So if I do my initial code in a child process, return the data through a
pipe and then spawn a pool of child processes doing tiles one at a time, I
don't get this concurrency issue.

Now I "just" need to write it properly which is going to take a while :)

Cheers


---
Gregory Bataille

On Tue, Mar 21, 2017 at 9:38 AM, Grégory Bataille <
gregory.bataille at gmail.com> wrote:

> hum... debugging in the C layers, that'll be interesting...
> Ok, I'll continue to dig in, thanks
>
>
> ---
> Gregory Bataille
>
> On Tue, Mar 21, 2017 at 8:44 AM, Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> On mardi 21 mars 2017 05:51:18 CET Grégory Bataille wrote:
>>
>> > Hey Even,
>>
>> >
>>
>> > reaching out again, because I just don't know...
>>
>> >
>>
>> > so here is gdal2tiles_parallel strategy (as far as I understand it)
>>
>> > - in each process, open the input file, compute the autowarped vrt (in
>> the
>>
>> > case of the dataset I use at least) loop over tiles to generate and work
>>
>> > only depending on the process number (so that this work is made in
>>
>> > parallel). We therefore end up with, in each process
>>
>> > - the input file opened as a dataset (but not touched after the
>>
>> > autowarped vrt is generated)
>>
>> > - a different autowarped vrt in memory (for each process) but pointing
>>
>> > to the same source (as far as I can see)
>>
>> >
>>
>> >
>>
>> > My strategy:
>>
>> > - open the input file.
>>
>> > - generate the autowarped vrt and save it to disk
>>
>> > - compute all the tile details and store them in a data structure.
>>
>> > Then in each process:
>>
>>
>>
>> I'm confused. You're talking about process, but is it a real operating
>> system process or a thread ? I guess the later.
>>
>>
>>
>> > - take one tile detail
>>
>> > - open the vrt (same file for each process, pointing to the same source
>>
>> > TIFF)
>>
>> > - read the vrt and write the tile
>>
>> > And that's the read that is failing as mentioned in my first email.
>>
>> >
>>
>> > I can't see much difference. To try and be complete, I tried to (or
>> think I
>>
>> > tried to):
>>
>> > - open the input file in each process
>>
>> > - generate a different vrt file for each thread
>>
>> >
>>
>> > I even copy/pasted the code that gdal2tiles_parallel uses in their
>>
>> > processes, but with no success, always the same error. The
>>
>> > VRT_SHARED_SOURCE option
>>
>> > does not seem to change anything (but looking at the wiki, it's not
>> clear
>>
>> > whether it applies to autowarped vrt too)
>>
>>
>>
>> VRT_SHARED_SOURCE indeed only works for "regular" mosaicing VRTs. So not
>> to warped VRT.
>>
>>
>>
>> Warped VRT opens the source dataset as a shared dataset in
>>
>> https://github.com/OSGeo/gdal/blob/trunk/gdal/alg/gdalwarper.cpp#L1675
>>
>> So you could have an issue if you open the VRT twice in the same thread,
>> and then use each handle in a different thread, since both VRT handles
>> would point to the same shared dataset. But it doesn't look that's what you
>> are doing.
>>
>>
>>
>> As a workaround to investigate, you could try to remove the
>> GDAL_OF_SHARED | flag in the line I mentionned and see if that makes a
>> difference (but we could potentially - not sure - have issues at closing
>> time since different call sites might make an assumption on the dataset
>> being opened with shared semantics)
>>
>>
>>
>> What you could do too is run the script through your prefered debugger
>> and set a breakpoint in GDALOpenEx and look at the calling sites. If you
>> are using 2 threads, then if we want things to work correctly, GDALOpenEx()
>> should be called twice on the TIFF dataset and return a different handle.
>>
>>
>>
>> Even
>>
>>
>>
>> --
>>
>> Spatialys - Geospatial professional services
>>
>> http://www.spatialys.com
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170328/296953f5/attachment-0001.html>

From daniele.romagnoli at geo-solutions.it  Wed Mar 29 01:07:07 2017
From: daniele.romagnoli at geo-solutions.it (Daniele Romagnoli)
Date: Wed, 29 Mar 2017 10:07:07 +0200
Subject: [gdal-dev] Interpolation questions
Message-ID: <CAJaHrDxrrdTn457S9Y1xSkKDjKbq0ksD5Nm6WzJHDSTYpZSm1A@mail.gmail.com>

Hi,
While investigating on some rendering issues we have with java JAI based
operations involving interpolations, I have found the topic of bicubic
interpolation introducing values outside of the input dynamic, as well as
negative values and overshooting.

The problem we had was with a grayscale GeoTIFF with noData=0.
For some very dark area (pixel near to zero) the output of the
interpolation was a negative value being clamped to zero (which is noData).
So it was introducing noData in regions where all pixels were valid.

Therefore I did a test with gdal_translate -r cubic and I got same result:


​
on the left side: original image
on the right side: cubic interpolation
weird white shapes you see on the top right are zero/nodata pixels.

I got different result once using cubic spline instead.
What is the difference between the two algorithms?

Second question:
I did a gdal_translate -outsize 800% 800% from a small pixellated image.
is it expected to have output pixels exceeding the original shape of the
valid input pixels?
I was thinking the interpolated image pixels should stay within the
original pixel edges.

Let me provide an image to clarify:

​
​
Left image: original
Right image: cubic spline.
See how the 2 edges are different, having the cubic spline producing some
kind of buffering on the edge (note the white-missing pixels on the borders
are nodata).

Please, let me know.
Best Regards,
Daniele



-- 
==
GeoServer Professional Services from the experts! Visit
http://goo.gl/it488V for more information.
==

Ing. Daniele Romagnoli
Senior Software Engineer

GeoSolutions S.A.S.
Via di Montramito 3/A
55054  Massarosa (LU)
Italy
phone: +39 0584 962313
fax:      +39 0584 1660272

http://www.geo-solutions.it
http://twitter.com/geosolutions_it

-------------------------------------------------------

*AVVERTENZE AI SENSI DEL D.Lgs. 196/2003*

Le informazioni contenute in questo messaggio di posta elettronica e/o
nel/i file/s allegato/i sono da considerarsi strettamente riservate. Il
loro utilizzo è consentito esclusivamente al destinatario del messaggio,
per le finalità indicate nel messaggio stesso. Qualora riceviate questo
messaggio senza esserne il destinatario, Vi preghiamo cortesemente di
darcene notizia via e-mail e di procedere alla distruzione del messaggio
stesso, cancellandolo dal Vostro sistema. Conservare il messaggio stesso,
divulgarlo anche in parte, distribuirlo ad altri soggetti, copiarlo, od
utilizzarlo per finalità diverse, costituisce comportamento contrario ai
principi dettati dal D.Lgs. 196/2003.



The information in this message and/or attachments, is intended solely for
the attention and use of the named addressee(s) and may be confidential or
proprietary in nature or covered by the provisions of privacy act
(Legislative Decree June, 30 2003, no.196 - Italy's New Data Protection
Code).Any use not in accord with its purpose, any disclosure, reproduction,
copying, distribution, or either dissemination, either whole or partial, is
strictly forbidden except previous formal approval of the named
addressee(s). If you are not the intended recipient, please contact
immediately the sender by telephone, fax or e-mail and delete the
information in this message that has been received in error. The sender
does not give any warranty or accept liability as the content, accuracy or
completeness of sent messages and accepts no responsibility  for changes
made after they were sent or for other risks which arise as a result of
e-mail transmission, viruses, etc.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170329/ee912dde/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: layers.jpeg
Type: image/jpeg
Size: 11979 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170329/ee912dde/attachment-0001.jpeg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: interpolated.jpg
Type: image/jpeg
Size: 14400 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170329/ee912dde/attachment-0001.jpg>

From gane.prog at gmail.com  Wed Mar 29 02:17:17 2017
From: gane.prog at gmail.com (Gane R)
Date: Wed, 29 Mar 2017 14:47:17 +0530
Subject: [gdal-dev] Building GDAL on linux with minimal drivers
Message-ID: <CALMrLdB9F82YsffMrAKp0jUcUk+Nxc4bNeGA1LfK9AKNjqb=wg@mail.gmail.com>

Hi all,

I am looking for building gdal with minimal set of drivers like gdal with
geotiff, jpg, png and sqlite gpkg

so it should do basic warp geotiff and work with geopkg raster. I don't
need OGR part I need the core, alg and raster tif, gpkg, jpg and png alone
is enought.
the problem is I get a fat static lib. I want to reduce its size.

I tried to follow the post
https://trac.osgeo.org/gdal/wiki/BuildingOnUnixWithMinimizedDrivers It
seems it is old.

When I build i get error during building the apps like gdalinfo, gdalwarp
....

Any suggestions

my ogr/ogrsf_frmts/GNUmakefile  is
like

include ../../GDALmake.opt

SUBDIRS-yes    := \
    generic rec shape

SUBDIRS-$(HAVE_DODS)    += dods
SUBDIRS-$(HAVE_DWGDIRECT) += dxfdwg
SUBDIRS-$(HAVE_FME)    += fme
SUBDIRS-$(HAVE_GRASS)    += grass
SUBDIRS-$(HAVE_IDB)    += idb

I get the following error

/home/user/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference
to `TABINDFile::~TABINDFile()'
/home/user/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference
to `TABINDFile::FindNext(int, unsigned char*)'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
`gdal_json_object_object_add'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
`TABINDFile::Open(char const, char const, int)'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
`OGRMemLayer::CreateField(OGRFieldDefn*, int)'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
`gdal_json_object_to_file'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
`MITABSpatialRef2CoordSys(OGRSpatialReference*)'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
`gdal_json_tokener_free'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
`gdal_json_object_new_int64'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
`gdal_json_object_get_string'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
`OGRMemLayer::GetFeatureCount(int)'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
`TABINDFile::BuildKey(int, int)'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
`gdal_json_object_array_add'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
`gdal_json_object_new_object'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
`OGRXPlane_ExtendPosition(double, double, double, double, double*, double*)'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
`OGRMemLayer::SetNextByIndex(long long)'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
`OGRMemLayer::CreateGeomField(OGRGeomFieldDefn*, int)'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
`OGRMemLayer::ResetReading()'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
`OGRMemLayer::ICreateFeature(OGRFeature*)'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
`OGRXPlane_Distance(double, double, double, double)'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
`TABINDFile::AddEntry(int, unsigned char*, int)'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
`gdal_json_object_put'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
`json_object_new_double_with_precision'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
`OGRMemLayer::TestCapability(char const*)'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
`OGRMemLayer::DeleteFeature(long long)'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
`gdal_json_object_new_int'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
`TABINDFile::Close()'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
`gdal_json_object_get_type'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
`OGRMemLayer::GetNextFeature()'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
`OGRMemLayer::OGRMemLayer(char const, OGRSpatialReference,
OGRwkbGeometryType)'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
`TABINDFile::BuildKey(int, char const*)'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
`gdal_json_object_from_file'

Thanks
Gane
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170329/adc9662d/attachment.html>

From Ahmed.Tolba at schiebel.net  Wed Mar 29 04:51:16 2017
From: Ahmed.Tolba at schiebel.net (Ahmed Tolba)
Date: Wed, 29 Mar 2017 11:51:16 +0000
Subject: [gdal-dev] Select an area from a table OGR
Message-ID: <1abfc71ad4904f7db7dd1cb5db67327a@SRV046.seg.local>


Hi All,

I'm trying to select a specific field in the table area, and I want to retrieve that layer, which has the features, I got a correct layer, but the layer has no features to look for

Here is what I'm doing    OGRLayer * layer = m_wfs_t->ExecuteSQL("SELECT * from areas WHERE name= 'thömas' ", NULL, "sqlite");

... iterate over layer features.  There are no features.

Sincerely,
Ahmed
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170329/19a7adbd/attachment.html>

From nicolas.simon at spw.wallonie.be  Wed Mar 29 04:58:27 2017
From: nicolas.simon at spw.wallonie.be (SIMON Nicolas)
Date: Wed, 29 Mar 2017 11:58:27 +0000
Subject: [gdal-dev] Interpolation questions
In-Reply-To: <CAJaHrDxrrdTn457S9Y1xSkKDjKbq0ksD5Nm6WzJHDSTYpZSm1A@mail.gmail.com>
References: <CAJaHrDxrrdTn457S9Y1xSkKDjKbq0ksD5Nm6WzJHDSTYpZSm1A@mail.gmail.com>
Message-ID: <F02D54DF5576D84C86C23A39A792DC7E8D9AF37B@SE0005V.wallonie.intra>

Daniele,
   For your first question, you should operate with a no_data value outside the range of pixel generated by interpolation.
   So you should do a preprocessing to change no_data value outside of this range. Alternatively, if you want to keep 0 as no_data, you should clamp negative value to 1 (instead of 0).
  For your second question, it’s normal that interpolation does a kind of dissolution of your edge. If you want to keep original no_data, you should extract a band mask from your input, and integrate it on your result.

Nicolas
De : gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] De la part de Daniele Romagnoli
Envoyé : mercredi 29 mars 2017 10:07
À : gdal-dev at lists.osgeo.org
Objet : [gdal-dev] Interpolation questions

Hi,
While investigating on some rendering issues we have with java JAI based operations involving interpolations, I have found the topic of bicubic interpolation introducing values outside of the input dynamic, as well as negative values and overshooting.
The problem we had was with a grayscale GeoTIFF with noData=0.
For some very dark area (pixel near to zero) the output of the interpolation was a negative value being clamped to zero (which is noData).
So it was introducing noData in regions where all pixels were valid.
Therefore I did a test with gdal_translate -r cubic and I got same result:

[cid:image002.jpg at 01D2A894.35516A80]
​
on the left side: original image
on the right side: cubic interpolation
weird white shapes you see on the top right are zero/nodata pixels.

I got different result once using cubic spline instead.
What is the difference between the two algorithms?
Second question:
I did a gdal_translate -outsize 800% 800% from a small pixellated image.
is it expected to have output pixels exceeding the original shape of the valid input pixels?
I was thinking the interpolated image pixels should stay within the original pixel edges.

Let me provide an image to clarify:
[cid:image004.jpg at 01D2A894.35516A80]
​
​
Left image: original
Right image: cubic spline.
See how the 2 edges are different, having the cubic spline producing some kind of buffering on the edge (note the white-missing pixels on the borders are nodata).

Please, let me know.
Best Regards,
Daniele



--
==
GeoServer Professional Services from the experts! Visit
http://goo.gl/it488V for more information.
==

Ing. Daniele Romagnoli
Senior Software Engineer

GeoSolutions S.A.S.
Via di Montramito 3/A
55054  Massarosa (LU)
Italy
phone: +39 0584 962313
fax:      +39 0584 1660272

http://www.geo-solutions.it
http://twitter.com/geosolutions_it

-------------------------------------------------------

AVVERTENZE AI SENSI DEL D.Lgs. 196/2003

Le informazioni contenute in questo messaggio di posta elettronica e/o nel/i file/s allegato/i sono da considerarsi strettamente riservate. Il loro utilizzo è consentito esclusivamente al destinatario del messaggio, per le finalità indicate nel messaggio stesso. Qualora riceviate questo messaggio senza esserne il destinatario, Vi preghiamo cortesemente di darcene notizia via e-mail e di procedere alla distruzione del messaggio stesso, cancellandolo dal Vostro sistema. Conservare il messaggio stesso, divulgarlo anche in parte, distribuirlo ad altri soggetti, copiarlo, od utilizzarlo per finalità diverse, costituisce comportamento contrario ai principi dettati dal D.Lgs. 196/2003.



The information in this message and/or attachments, is intended solely for the attention and use of the named addressee(s) and may be confidential or proprietary in nature or covered by the provisions of privacy act (Legislative Decree June, 30 2003, no.196 - Italy's New Data Protection Code).Any use not in accord with its purpose, any disclosure, reproduction, copying, distribution, or either dissemination, either whole or partial, is strictly forbidden except previous formal approval of the named addressee(s). If you are not the intended recipient, please contact immediately the sender by telephone, fax or e-mail and delete the information in this message that has been received in error. The sender does not give any warranty or accept liability as the content, accuracy or completeness of sent messages and accepts no responsibility  for changes made after they were sent or for other risks which arise as a result of e-mail transmission, viruses, etc.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170329/a5bf2143/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image002.jpg
Type: image/jpeg
Size: 7672 bytes
Desc: image002.jpg
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170329/a5bf2143/attachment-0002.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image004.jpg
Type: image/jpeg
Size: 3700 bytes
Desc: image004.jpg
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170329/a5bf2143/attachment-0003.jpg>

From even.rouault at spatialys.com  Wed Mar 29 05:39:21 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 29 Mar 2017 14:39:21 +0200
Subject: [gdal-dev] Interpolation questions
In-Reply-To: <CAJaHrDxrrdTn457S9Y1xSkKDjKbq0ksD5Nm6WzJHDSTYpZSm1A@mail.gmail.com>
References: <CAJaHrDxrrdTn457S9Y1xSkKDjKbq0ksD5Nm6WzJHDSTYpZSm1A@mail.gmail.com>
Message-ID: <3353025.bfL3fFr4Cx@even-i700>

On mercredi 29 mars 2017 10:07:07 CEST Daniele Romagnoli wrote:
> Hi,
> While investigating on some rendering issues we have with java JAI based
> operations involving interpolations, I have found the topic of bicubic
> interpolation introducing values outside of the input dynamic, as well as
> negative values and overshooting.
> 
> The problem we had was with a grayscale GeoTIFF with noData=0.
> For some very dark area (pixel near to zero) the output of the
> interpolation was a negative value being clamped to zero (which is noData).
> So it was introducing noData in regions where all pixels were valid.
> 
> Therefore I did a test with gdal_translate -r cubic and I got same result:

Hum that the cubic implementation in gdal_translate/gdaladdo (this is the same) has indeed 
not the code that avoids using the noData value for interpolated values. gdalwarp 
implementation normally has code to avoid reusing the noData value, and in this case, it 
would use 1 instead of 0.

> 
> 
> ​
> on the left side: original image
> on the right side: cubic interpolation
> weird white shapes you see on the top right are zero/nodata pixels.
> 
> I got different result once using cubic spline instead.
> What is the difference between the two algorithms?

Different maths...
https://github.com/OSGeo/gdal/blob/trunk/gdal/alg/gdalwarpkernel.cpp#L3063
vs
https://github.com/OSGeo/gdal/blob/trunk/gdal/alg/gdalwarpkernel.cpp#L3126

> 
> Second question:
> I did a gdal_translate -outsize 800% 800% from a small pixellated image.
> is it expected to have output pixels exceeding the original shape of the
> valid input pixels?
> I was thinking the interpolated image pixels should stay within the
> original pixel edges.
> 
> Let me provide an image to clarify:
> 
> ​
> ​
> Left image: original
> Right image: cubic spline.
> See how the 2 edges are different, having the cubic spline producing some
> kind of buffering on the edge (note the white-missing pixels on the borders
> are nodata).
> 
> Please, let me know.
> Best Regards,
> Daniele


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170329/f3ef5e4c/attachment.html>

From Ahmed.Tolba at schiebel.net  Wed Mar 29 05:42:26 2017
From: Ahmed.Tolba at schiebel.net (Ahmed Tolba)
Date: Wed, 29 Mar 2017 12:42:26 +0000
Subject: [gdal-dev] Select an area from a table OGR
Message-ID: <f89a0ea4880b4f18b38bce58aec212ff@SRV046.seg.local>

I found the problem. The problem is the name = "thömas" is a widestring. It seems that gdal doesn't work with it ? is there a solution ?

From: Ahmed Tolba
Sent: Wednesday, March 29, 2017 1:51 PM
To: 'gdal-dev at lists.osgeo.org'
Subject: Select an area from a table OGR


Hi All,

I'm trying to select a specific field in the table area, and I want to retrieve that layer, which has the features, I got a correct layer, but the layer has no features to look for

Here is what I'm doing    OGRLayer * layer = m_wfs_t->ExecuteSQL("SELECT * from areas WHERE name= 'thömas' ", NULL, "sqlite");

... iterate over layer features.  There are no features.

Sincerely,
Ahmed
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170329/1f6efe20/attachment.html>

From johan.de.braak at eleaf.com  Wed Mar 29 06:51:11 2017
From: johan.de.braak at eleaf.com (Johan de Braak)
Date: Wed, 29 Mar 2017 06:51:11 -0700 (MST)
Subject: [gdal-dev] gdal Info Options Python
Message-ID: <1490795471037-5314816.post@n6.nabble.com>

Hi all,

Using gdal.Info in Python, I would like to have my result as a dictionary
instead of a string. I found that in gdal.InfoOptions I am able to specify
'format'. By default, this is set to 'text', however changing this to 'dict'
(or anything really) does still result in a string.

Is there a way to get the gdal.Info result as something else than a string?

Johan



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-Info-Options-Python-tp5314816.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From ari.jolma at gmail.com  Wed Mar 29 07:00:05 2017
From: ari.jolma at gmail.com (Ari Jolma)
Date: Wed, 29 Mar 2017 17:00:05 +0300
Subject: [gdal-dev] Building GDAL on linux with minimal drivers
In-Reply-To: <CALMrLdB9F82YsffMrAKp0jUcUk+Nxc4bNeGA1LfK9AKNjqb=wg@mail.gmail.com>
References: <CALMrLdB9F82YsffMrAKp0jUcUk+Nxc4bNeGA1LfK9AKNjqb=wg@mail.gmail.com>
Message-ID: <b9b846fd-c4a8-cbac-db25-aebe206e0e54@gmail.com>

Gane,

The reason for the errors below are because you left out MapInfo and 
JSON driver. Parts of them are used by other drivers. I tried some time 
ago to try to build a minimal GDAL but it seemed to be not so simple and 
I did not succeed.

If you succeed, please update the Wiki page.

Best regards,

Ari


29.03.2017, 12:17, Gane R kirjoitti:
> Hi all,
>
> I am looking for building gdal with minimal set of drivers like gdal 
> with geotiff, jpg, png and sqlite gpkg
>
> so it should do basic warp geotiff and work with geopkg raster. I 
> don't need OGR part I need the core, alg and raster tif, gpkg, jpg and 
> png alone is enought.
> the problem is I get a fat static lib. I want to reduce its size.
>
> I tried to follow the post 
> https://trac.osgeo.org/gdal/wiki/BuildingOnUnixWithMinimizedDrivers It 
> seems it is old.
>
> When I build i get error during building the apps like gdalinfo, 
> gdalwarp ....
>
> Any suggestions
>
> my ogr/ogrsf_frmts/GNUmakefile  is
> like
>
> include ../../GDALmake.opt
>
> SUBDIRS-yes    := \
>     generic rec shape
>
> SUBDIRS-$(HAVE_DODS)    += dods
> SUBDIRS-$(HAVE_DWGDIRECT) += dxfdwg
> SUBDIRS-$(HAVE_FME)    += fme
> SUBDIRS-$(HAVE_GRASS)    += grass
> SUBDIRS-$(HAVE_IDB)    += idb
>
> I get the following error
>
> /home/user/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined 
> reference to `TABINDFile::~TABINDFile()'
> /home/user/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined 
> reference to `TABINDFile::FindNext(int, unsigned char*)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `gdal_json_object_object_add'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `TABINDFile::Open(char const, char const, int)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `OGRMemLayer::CreateField(OGRFieldDefn*, int)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `gdal_json_object_to_file'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `MITABSpatialRef2CoordSys(OGRSpatialReference*)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `gdal_json_tokener_free'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `gdal_json_object_new_int64'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `gdal_json_object_get_string'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `OGRMemLayer::GetFeatureCount(int)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `TABINDFile::BuildKey(int, int)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `gdal_json_object_array_add'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `gdal_json_object_new_object'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `OGRXPlane_ExtendPosition(double, double, double, double, double*, 
> double*)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `OGRMemLayer::SetNextByIndex(long long)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `OGRMemLayer::CreateGeomField(OGRGeomFieldDefn*, int)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `OGRMemLayer::ResetReading()'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `OGRMemLayer::ICreateFeature(OGRFeature*)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `OGRXPlane_Distance(double, double, double, double)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `TABINDFile::AddEntry(int, unsigned char*, int)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `gdal_json_object_put'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `json_object_new_double_with_precision'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `OGRMemLayer::TestCapability(char const*)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `OGRMemLayer::DeleteFeature(long long)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `gdal_json_object_new_int'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `TABINDFile::Close()'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `gdal_json_object_get_type'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `OGRMemLayer::GetNextFeature()'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `OGRMemLayer::OGRMemLayer(char const, OGRSpatialReference, 
> OGRwkbGeometryType)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `TABINDFile::BuildKey(int, char const*)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `gdal_json_object_from_file'
>
> Thanks
> Gane
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170329/e1f4dcb8/attachment-0001.html>

From even.rouault at spatialys.com  Wed Mar 29 07:17:50 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 29 Mar 2017 16:17:50 +0200
Subject: [gdal-dev] gdal Info Options Python
In-Reply-To: <1490795471037-5314816.post@n6.nabble.com>
References: <1490795471037-5314816.post@n6.nabble.com>
Message-ID: <3758089.GR3LIhMKnc@even-i700>

On mercredi 29 mars 2017 06:51:11 CEST Johan de Braak wrote:
> Hi all,
> 
> Using gdal.Info in Python, I would like to have my result as a dictionary
> instead of a string. I found that in gdal.InfoOptions I am able to specify
> 'format'. By default, this is set to 'text', however changing this to 'dict'
> (or anything really) does still result in a string.
> 
> Is there a way to get the gdal.Info result as something else than a string?

Yes: format = 'json'

> 
> Johan
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/gdal-Info-Options-Python-tp5314816.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170329/21884026/attachment.html>

From lorenzo.bernardi at nais-solutions.it  Wed Mar 29 07:45:15 2017
From: lorenzo.bernardi at nais-solutions.it (lorenzoNais)
Date: Wed, 29 Mar 2017 07:45:15 -0700 (MST)
Subject: [gdal-dev] gdal Info Options Python
In-Reply-To: <3758089.GR3LIhMKnc@even-i700>
References: <1490795471037-5314816.post@n6.nabble.com>
 <3758089.GR3LIhMKnc@even-i700>
Message-ID: <CACbBDeQtY9d1xowT0q2oUFqLHhKzUDckrQkW=7fU2FXB7gL-qw@mail.gmail.com>

You can try subprocess.check_output with -json option.
It will save a structure with your desidered information.

https://docs.python.org/2/library/subprocess.html

2017-03-29 16:18 GMT+02:00 Even Rouault-2 [via OSGeo.org] <
ml-node+s1560n5314820h56 at n6.nabble.com>:

> On mercredi 29 mars 2017 06:51:11 CEST Johan de Braak wrote:
>
> > Hi all,
>
> >
>
> > Using gdal.Info in Python, I would like to have my result as a dictionary
>
> > instead of a string. I found that in gdal.InfoOptions I am able to
> specify
>
> > 'format'. By default, this is set to 'text', however changing this to
> 'dict'
>
> > (or anything really) does still result in a string.
>
> >
>
> > Is there a way to get the gdal.Info result as something else than a
> string?
>
>
>
> Yes: format = 'json'
>
>
>
> >
>
> > Johan
>
> >
>
> >
>
> >
>
> > --
>
> > View this message in context:
>
> > http://osgeo-org.1560.x6.nabble.com/gdal-Info-Options-
> Python-tp5314816.html
>
> > Sent from the GDAL - Dev mailing list archive at Nabble.com.
>
> > _______________________________________________
>
> > gdal-dev mailing list
>
> > [hidden email] <http:///user/SendEmail.jtp?type=node&node=5314820&i=0>
>
> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
> _______________________________________________
> gdal-dev mailing list
> [hidden email] <http:///user/SendEmail.jtp?type=node&node=5314820&i=1>
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> ------------------------------
> If you reply to this email, your message will be added to the discussion
> below:
> http://osgeo-org.1560.x6.nabble.com/gdal-Info-Options-
> Python-tp5314816p5314820.html
> To start a new topic under GDAL - Dev, email ml-node+s1560n3742093h19 at n6.
> nabble.com
> To unsubscribe from GDAL - Dev, click here
> <http://osgeo-org.1560.x6.nabble.com/template/NamlServlet.jtp?macro=unsubscribe_by_code&node=3742093&code=bG9yZW56by5iZXJuYXJkaUBuYWlzLXNvbHV0aW9ucy5pdHwzNzQyMDkzfDE4MzMwMjYwMDc=>
> .
> NAML
> <http://osgeo-org.1560.x6.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&id=instant_html%21nabble%3Aemail.naml&base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.NodeNamespace&breadcrumbs=notify_subscribers%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml>
>



-- 

Lorenzo Bernardi

NAIS Srl (www.nais-solutions.it)
Via Andrea Noale 345/A
00155 Rome – Italy




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-Info-Options-Python-tp5314816p5314824.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170329/42d7099d/attachment.html>

From Ahmed.Tolba at schiebel.net  Thu Mar 30 00:51:07 2017
From: Ahmed.Tolba at schiebel.net (Ahmed Tolba)
Date: Thu, 30 Mar 2017 07:51:07 +0000
Subject: [gdal-dev] Charachter encoding arabic
Message-ID: <3bb23803057a45c8b10c848bbd0a134e@SRV046.seg.local>

Dear All,

I'm using postgres database with OGR.
I have altered the database encoding to WIN1250 by using that statement ALTER DATABASE tinyows SET client_encoding=WIN1250;
OGR still can't read the fields, and I got an assertion that the characters don't lie in the range -1, 255
CPLValueType CPLGetValueType(const char* pszValue)
   for(; *pszValue != '\0'; pszValue++ )
    {
        if( isdigit( *pszValue))
        {
            bIsLastCharExponent = FALSE;
            /* do nothing */
        }

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170330/4ccf9a84/attachment.html>

From Niels.vonFestenberg-Packisch.ext at rohde-schwarz.com  Thu Mar 30 01:42:19 2017
From: Niels.vonFestenberg-Packisch.ext at rohde-schwarz.com (Niels.vonFestenberg-Packisch.ext at rohde-schwarz.com)
Date: Thu, 30 Mar 2017 10:42:19 +0200
Subject: [gdal-dev] Antwort: [Newsletter] Building GDAL on linux with
 minimal drivers
In-Reply-To: <CALMrLdB9F82YsffMrAKp0jUcUk+Nxc4bNeGA1LfK9AKNjqb=wg@mail.gmail.com>
References: <CALMrLdB9F82YsffMrAKp0jUcUk+Nxc4bNeGA1LfK9AKNjqb=wg@mail.gmail.com>
Message-ID: <OF25C45412.69445CA3-ONC12580F3.002F2FC4-C12580F3.002FD23A@rohde-schwarz.com>

Hi Gane, 
it might be slightly heretic, but I succeeded in a similar task by using 
GDAL version 1.11. In that version there seem to be much less 
interdependencies between the dlls under Windows, and I guess it will be 
the same under Unix. 
I found out by starting the projects without any GDAL-dlls and then adding 
them one by one until it worked (and I ended up with only two dlls). It's 
a hack, but it worked for me. 
Hope that helps.

Regards
Niels




Von:    Gane R <gane.prog at gmail.com>
An:     gdal-dev at lists.osgeo.org
Datum:  29.03.2017 11:17
Betreff:        [Newsletter] [gdal-dev] Building GDAL on linux with 
minimal drivers
Gesendet von:   "gdal-dev" <gdal-dev-bounces at lists.osgeo.org>



Hi all,

I am looking for building gdal with minimal set of drivers like gdal with 
geotiff, jpg, png and sqlite gpkg

so it should do basic warp geotiff and work with geopkg raster. I don't 
need OGR part I need the core, alg and raster tif, gpkg, jpg and png alone 
is enought.
the problem is I get a fat static lib. I want to reduce its size.

I tried to follow the post 
https://trac.osgeo.org/gdal/wiki/BuildingOnUnixWithMinimizedDrivers It 
seems it is old.

When I build i get error during building the apps like gdalinfo, gdalwarp 
....

Any suggestions 

my ogr/ogrsf_frmts/GNUmakefile  is 
like 

include ../../GDALmake.opt

SUBDIRS-yes    := \
    generic rec shape

SUBDIRS-$(HAVE_DODS)    += dods
SUBDIRS-$(HAVE_DWGDIRECT) += dxfdwg
SUBDIRS-$(HAVE_FME)    += fme
SUBDIRS-$(HAVE_GRASS)    += grass
SUBDIRS-$(HAVE_IDB)    += idb

I get the following error

/home/user/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference 
to `TABINDFile::~TABINDFile()'
/home/user/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference 
to `TABINDFile::FindNext(int, unsigned char*)'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
`gdal_json_object_object_add'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
`TABINDFile::Open(char const, char const, int)'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
`OGRMemLayer::CreateField(OGRFieldDefn*, int)'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
`gdal_json_object_to_file'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
`MITABSpatialRef2CoordSys(OGRSpatialReference*)'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
`gdal_json_tokener_free'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
`gdal_json_object_new_int64'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
`gdal_json_object_get_string'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
`OGRMemLayer::GetFeatureCount(int)'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
`TABINDFile::BuildKey(int, int)'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
`gdal_json_object_array_add'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
`gdal_json_object_new_object'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
`OGRXPlane_ExtendPosition(double, double, double, double, double*, 
double*)'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
`OGRMemLayer::SetNextByIndex(long long)'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
`OGRMemLayer::CreateGeomField(OGRGeomFieldDefn*, int)'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
`OGRMemLayer::ResetReading()'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
`OGRMemLayer::ICreateFeature(OGRFeature*)'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
`OGRXPlane_Distance(double, double, double, double)'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
`TABINDFile::AddEntry(int, unsigned char*, int)'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
`gdal_json_object_put'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
`json_object_new_double_with_precision'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
`OGRMemLayer::TestCapability(char const*)'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
`OGRMemLayer::DeleteFeature(long long)'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
`gdal_json_object_new_int'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
`TABINDFile::Close()'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
`gdal_json_object_get_type'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
`OGRMemLayer::GetNextFeature()'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
`OGRMemLayer::OGRMemLayer(char const, OGRSpatialReference, 
OGRwkbGeometryType)'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
`TABINDFile::BuildKey(int, char const*)'
/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
`gdal_json_object_from_file'

Thanks
Gane_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170330/97d20b9f/attachment.html>

From bishop.dev at gmail.com  Thu Mar 30 03:06:10 2017
From: bishop.dev at gmail.com (Dmitry Baryshnikov)
Date: Thu, 30 Mar 2017 13:06:10 +0300
Subject: [gdal-dev] Building GDAL on linux with minimal drivers
In-Reply-To: <CALMrLdB9F82YsffMrAKp0jUcUk+Nxc4bNeGA1LfK9AKNjqb=wg@mail.gmail.com>
References: <CALMrLdB9F82YsffMrAKp0jUcUk+Nxc4bNeGA1LfK9AKNjqb=wg@mail.gmail.com>
Message-ID: <bcf6baca-0f89-14a8-4fe5-6c0d508ded31@gmail.com>

Hi Gane,

You can try to use Cmake build of GDAL 
(https://github.com/nextgis-borsch/lib_gdal).

It can be configured via CMake-gui or command line.

This is an example of minimal static build of GDAL - 
https://github.com/nextgis/nextgis_datastore/blob/master/cmake/extlib.cmake#L94-L175

Best regards,
     Dmitry

29.03.17 12:17, Gane R пишет:
> Hi all,
>
> I am looking for building gdal with minimal set of drivers like gdal 
> with geotiff, jpg, png and sqlite gpkg
>
> so it should do basic warp geotiff and work with geopkg raster. I 
> don't need OGR part I need the core, alg and raster tif, gpkg, jpg and 
> png alone is enought.
> the problem is I get a fat static lib. I want to reduce its size.
>
> I tried to follow the post 
> https://trac.osgeo.org/gdal/wiki/BuildingOnUnixWithMinimizedDrivers It 
> seems it is old.
>
> When I build i get error during building the apps like gdalinfo, 
> gdalwarp ....
>
> Any suggestions
>
> my ogr/ogrsf_frmts/GNUmakefile  is
> like
>
> include ../../GDALmake.opt
>
> SUBDIRS-yes    := \
>     generic rec shape
>
> SUBDIRS-$(HAVE_DODS)    += dods
> SUBDIRS-$(HAVE_DWGDIRECT) += dxfdwg
> SUBDIRS-$(HAVE_FME)    += fme
> SUBDIRS-$(HAVE_GRASS)    += grass
> SUBDIRS-$(HAVE_IDB)    += idb
>
> I get the following error
>
> /home/user/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined 
> reference to `TABINDFile::~TABINDFile()'
> /home/user/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined 
> reference to `TABINDFile::FindNext(int, unsigned char*)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `gdal_json_object_object_add'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `TABINDFile::Open(char const, char const, int)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `OGRMemLayer::CreateField(OGRFieldDefn*, int)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `gdal_json_object_to_file'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `MITABSpatialRef2CoordSys(OGRSpatialReference*)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `gdal_json_tokener_free'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `gdal_json_object_new_int64'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `gdal_json_object_get_string'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `OGRMemLayer::GetFeatureCount(int)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `TABINDFile::BuildKey(int, int)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `gdal_json_object_array_add'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `gdal_json_object_new_object'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `OGRXPlane_ExtendPosition(double, double, double, double, double*, 
> double*)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `OGRMemLayer::SetNextByIndex(long long)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `OGRMemLayer::CreateGeomField(OGRGeomFieldDefn*, int)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `OGRMemLayer::ResetReading()'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `OGRMemLayer::ICreateFeature(OGRFeature*)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `OGRXPlane_Distance(double, double, double, double)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `TABINDFile::AddEntry(int, unsigned char*, int)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `gdal_json_object_put'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `json_object_new_double_with_precision'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `OGRMemLayer::TestCapability(char const*)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `OGRMemLayer::DeleteFeature(long long)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `gdal_json_object_new_int'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `TABINDFile::Close()'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `gdal_json_object_get_type'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `OGRMemLayer::GetNextFeature()'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `OGRMemLayer::OGRMemLayer(char const, OGRSpatialReference, 
> OGRwkbGeometryType)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `TABINDFile::BuildKey(int, char const*)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to 
> `gdal_json_object_from_file'
>
> Thanks
> Gane
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170330/9c9f5092/attachment-0001.html>

From Andre.Vautour at Teledyne.com  Thu Mar 30 05:59:09 2017
From: Andre.Vautour at Teledyne.com (=?iso-8859-1?Q?Vautour=2C_Andr=E9_=28INT=29?=)
Date: Thu, 30 Mar 2017 12:59:09 +0000
Subject: [gdal-dev] Delete implementation of OGRMemDriver
Message-ID: <8FD06BD4C598D8419F88B9DC4CD35FB2F8A73B@CA1-VPMSG-MBX02.TDY.Teledyne.com>

Hi all,

We recently updated from 1.11.x to 2.1.3.

Previously, GDAL had the ODrCDeleteDataSource capability, which the OGRMemDriver did not handle in its TestCapability implementation. So, in effect, the memory driver did not support deletion, which makes sense to me.

>From what I can tell, that capability was removed in favor of every driver supporting delete. My question is did, should calling Delete() on the OGRMemDriver with an existing file name delete the file on the file system? That seems to be what is happening, which is not what I would have expected. In our workflow, we were doing a CreateCopy to copy a source to the memory driver, but using the same name for the destination.

I can work around the problem by setting the QUIET_DELETE_ON_CREATE_COPY option, but I was wondering if delete being implemented on the memory driver makes sense.

Kind regards,
André
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170330/cecaa971/attachment.html>

From even.rouault at spatialys.com  Thu Mar 30 07:19:11 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 30 Mar 2017 16:19:11 +0200
Subject: [gdal-dev] Delete implementation of OGRMemDriver
In-Reply-To: <8FD06BD4C598D8419F88B9DC4CD35FB2F8A73B@CA1-VPMSG-MBX02.TDY.Teledyne.com>
References: <8FD06BD4C598D8419F88B9DC4CD35FB2F8A73B@CA1-VPMSG-MBX02.TDY.Teledyne.com>
Message-ID: <1854962.o0r2BLlgFd@even-i700>

On jeudi 30 mars 2017 12:59:09 CEST Vautour, André (INT) wrote:
> Hi all,
> 
> We recently updated from 1.11.x to 2.1.3.
> 
> Previously, GDAL had the ODrCDeleteDataSource capability, which the
> OGRMemDriver did not handle in its TestCapability implementation. So, in
> effect, the memory driver did not support deletion, which makes sense to
> me.
> 
> From what I can tell, that capability was removed in favor of every driver
> supporting delete. My question is did, should calling Delete() on the
> OGRMemDriver with an existing file name delete the file on the file system?
> That seems to be what is happening, which is not what I would have
> expected. In our workflow, we were doing a CreateCopy to copy a source to
> the memory driver, but using the same name for the destination.
> 
> I can work around the problem by setting the QUIET_DELETE_ON_CREATE_COPY
> option, but I was wondering if delete being implemented on the memory
> driver makes sense.

The mem driver is particular in the sense that there's no filename associated to it (that is you 
can pass an arbitrary string on creation time, but it is just known by the dataset object. You 
can set empty strings to several MEM datasets and they will be different). So as soon as you 
close the dataset handle returned by CreateDataSource(), the resources are effectively 
freed. I don't think there's much difference between 1.X and 2.X for that.

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170330/f469f3fb/attachment.html>

From schwehr at gmail.com  Thu Mar 30 07:34:35 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Thu, 30 Mar 2017 07:34:35 -0700
Subject: [gdal-dev] Building GDAL on linux with minimal drivers
In-Reply-To: <bcf6baca-0f89-14a8-4fe5-6c0d508ded31@gmail.com>
References: <CALMrLdB9F82YsffMrAKp0jUcUk+Nxc4bNeGA1LfK9AKNjqb=wg@mail.gmail.com>
 <bcf6baca-0f89-14a8-4fe5-6c0d508ded31@gmail.com>
Message-ID: <CACmBxyu08Xitvu7McRHV8RbtMOKE5OcApaK4Qwmj3zohnM8BYQ@mail.gmail.com>

Some possibly useful notes...

I use bazel for a restricted build.  Here are a few key files/directories
that I've found to be in surprising places that are hard or impossible to
go without:

frmts/gtiff/
frmts/hfa/hfa_overviews.cpp
frmts/iso8211/
frmts/mem/memdataset.cpp
frmts/pds/nasakeywordhandler.cpp
frmts/raw/rawdataset.cpp
frmts/vrt/
ogr/ogrsf_frmts/generic/
ogr/ogrsf_frmts/geojson/
ogr/ogrsf_frmts/gml/
ogr/ogrsf_frmts/mem/
ogr/ogrsf_frmts/mitab/ (except mitab_ogr*)
ogr/ogrsf_frmts/vrt/
ogr/ogrsf_frmts/xplane/ogr_xplane_geo_utils.cpp

The gtiff, mem (raster and vector), and vrt (raster and vector) directories
aren't really surprising after you see that it's hard to do a lot of things
without them as helpers.  If you look in the format registration code, you
will see there are a lot of drivers that depend on others.

I also add these cpp defines for my non-autoconf setup:

-DWITHOUT_CPLDEBUG
-DDISABLE_CVSID
-DGDAL_NO_AUTOLOAD

At one point, I had a autoconf configure setup that was pretty minimal.
While it built, it was not so much fun to work with.  Here are some
remnants of notes that might constitute the beginnings of a
sourceme-minimal.sh.  More will likely be needed depending on libs are
already installed on your machine.  And gdal without many of these libs
(e.g. proj4, geos, libz/zlib) is just frustrating.

Maybe we need a section to
https://trac.osgeo.org/gdal/wiki/BuildingOnUnixWithMinimizedDrivers that is
a stab at what the mimumum to build is without respect to if it's actually
useful for anything beyond testing purposes.  e.g. I have a build target
that is just a subset of port that I use with the autotest2 port tests.  It
makes linking and analysis go a lot faster when you don't have anything
beyond port in the build.

And it's been a long time since I've tried the optimize for size flag in
gcc or llvm (-g0 -Os)...

-kurt


#!/bin/bash

echo "Totally untested."
echo "See ./configure --help | egrep 'enable|disable|yes|no|with'  "

GDAL_OPTS=""

# Languages
GDAL_OPTS="$GDAL_OPTS --without-python"

# Compilation options
GDAL_OPTS="$GDAL_OPTS --without-avx"
GDAL_OPTS="$GDAL_OPTS --without-sse"

# --without-pam

# Library options
GDAL_OPTS="$GDAL_OPTS --with-cryptopp=no"
GDAL_OPTS="$GDAL_OPTS --without-curl"
GDAL_OPTS="$GDAL_OPTS --without-expat"
GDAL_OPTS="$GDAL_OPTS --without-geos"
GDAL_OPTS="$GDAL_OPTS --with-odbc=no"
GDAL_OPTS="$GDAL_OPTS --without-odbc"
GDAL_OPTS="$GDAL_OPTS --without-pcre"
GDAL_OPTS="$GDAL_OPTS --without-qhull"
GDAL_OPTS="$GDAL_OPTS --without-sqlite3"  # You're not going to want to do
this if you want gpkg!
GDAL_OPTS="$GDAL_OPTS --with-xerces=no"
GDAL_OPTS="$GDAL_OPTS --without-xml2"
GDAL_OPTS="$GDAL_OPTS --with-libz=no"
GDAL_OPTS="$GDAL_OPTS --with-liblzma=no"

# Driver options

# TODO: Put lots of driver withouts here.

# TODO: Disable debugging and define NDEBUG

# TODO: Disable alg and apps that you don't use

echo ./configure $GDAL_OPTS
./configure $GDAL_OPTS


On Thu, Mar 30, 2017 at 3:06 AM, Dmitry Baryshnikov <bishop.dev at gmail.com>
wrote:

> Hi Gane,
>
> You can try to use Cmake build of GDAL (https://github.com/nextgis-
> borsch/lib_gdal).
>
> It can be configured via CMake-gui or command line.
>
> This is an example of minimal static build of GDAL -
> https://github.com/nextgis/nextgis_datastore/blob/master/
> cmake/extlib.cmake#L94-L175
>
> Best regards,
>     Dmitry
>
> 29.03.17 12:17, Gane R пишет:
>
> Hi all,
>
> I am looking for building gdal with minimal set of drivers like gdal with
> geotiff, jpg, png and sqlite gpkg
>
> so it should do basic warp geotiff and work with geopkg raster. I don't
> need OGR part I need the core, alg and raster tif, gpkg, jpg and png alone
> is enought.
> the problem is I get a fat static lib. I want to reduce its size.
>
> I tried to follow the post https://trac.osgeo.org/gdal/wiki/
> BuildingOnUnixWithMinimizedDrivers It seems it is old.
>
> When I build i get error during building the apps like gdalinfo, gdalwarp
> ....
>
> Any suggestions
>
> my ogr/ogrsf_frmts/GNUmakefile  is
> like
>
> include ../../GDALmake.opt
>
> SUBDIRS-yes    := \
>     generic rec shape
>
> SUBDIRS-$(HAVE_DODS)    += dods
> SUBDIRS-$(HAVE_DWGDIRECT) += dxfdwg
> SUBDIRS-$(HAVE_FME)    += fme
> SUBDIRS-$(HAVE_GRASS)    += grass
> SUBDIRS-$(HAVE_IDB)    += idb
>
> I get the following error
>
> /home/user/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference
> to `TABINDFile::~TABINDFile()'
> /home/user/home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference
> to `TABINDFile::FindNext(int, unsigned char*)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
> `gdal_json_object_object_add'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
> `TABINDFile::Open(char const, char const, int)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
> `OGRMemLayer::CreateField(OGRFieldDefn*, int)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
> `gdal_json_object_to_file'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
> `MITABSpatialRef2CoordSys(OGRSpatialReference*)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
> `gdal_json_tokener_free'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
> `gdal_json_object_new_int64'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
> `gdal_json_object_get_string'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
> `OGRMemLayer::GetFeatureCount(int)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
> `TABINDFile::BuildKey(int, int)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
> `gdal_json_object_array_add'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
> `gdal_json_object_new_object'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
> `OGRXPlane_ExtendPosition(double, double, double, double, double*,
> double*)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
> `OGRMemLayer::SetNextByIndex(long long)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
> `OGRMemLayer::CreateGeomField(OGRGeomFieldDefn*, int)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
> `OGRMemLayer::ResetReading()'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
> `OGRMemLayer::ICreateFeature(OGRFeature*)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
> `OGRXPlane_Distance(double, double, double, double)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
> `TABINDFile::AddEntry(int, unsigned char*, int)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
> `gdal_json_object_put'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
> `json_object_new_double_with_precision'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
> `OGRMemLayer::TestCapability(char const*)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
> `OGRMemLayer::DeleteFeature(long long)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
> `gdal_json_object_new_int'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
> `TABINDFile::Close()'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
> `gdal_json_object_get_type'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
> `OGRMemLayer::GetNextFeature()'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
> `OGRMemLayer::OGRMemLayer(char const, OGRSpatialReference,
> OGRwkbGeometryType)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
> `TABINDFile::BuildKey(int, char const*)'
> /home/user/x64/gdal-2.1.0/.libs/libgdal.so: undefined reference to
> `gdal_json_object_from_file'
>
> Thanks
> Gane
>
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170330/68c0312c/attachment-0001.html>

From even.rouault at spatialys.com  Thu Mar 30 07:48:51 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 30 Mar 2017 16:48:51 +0200
Subject: [gdal-dev] Building GDAL on linux with minimal drivers
In-Reply-To: <CACmBxyu08Xitvu7McRHV8RbtMOKE5OcApaK4Qwmj3zohnM8BYQ@mail.gmail.com>
References: <CALMrLdB9F82YsffMrAKp0jUcUk+Nxc4bNeGA1LfK9AKNjqb=wg@mail.gmail.com>
 <bcf6baca-0f89-14a8-4fe5-6c0d508ded31@gmail.com>
 <CACmBxyu08Xitvu7McRHV8RbtMOKE5OcApaK4Qwmj3zohnM8BYQ@mail.gmail.com>
Message-ID: <3519171.V2xVJWdQM3@even-i700>

On jeudi 30 mars 2017 07:34:35 CEST Kurt Schwehr wrote:
> At one point, I had a autoconf configure setup that was pretty minimal.
> While it built, it was not so much fun to work with.  Here are some
> remnants of notes that might constitute the beginnings of a
> sourceme-minimal.sh.  More will likely be needed depending on libs are
> already installed on your machine.  And gdal without many of these libs
> (e.g. proj4, geos, libz/zlib) is just frustrating.

As it seems several people have needs for minimized builds, perhaps they should consider 
upstreaming their efforts with build options (like --minimal and then --with-XXXX to 
selectively enable drivers), and the potential code refactoring that might make it easy. I 
think a continuous integration target that would test that would be needed to ensure this 
doesn't get broken by later developments.
Of course one difficulty is to define what a minimal build is :-)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170330/8b628eba/attachment.html>

From mateusz at loskot.net  Thu Mar 30 07:51:49 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu, 30 Mar 2017 16:51:49 +0200
Subject: [gdal-dev] Building GDAL on linux with minimal drivers
In-Reply-To: <3519171.V2xVJWdQM3@even-i700>
References: <CALMrLdB9F82YsffMrAKp0jUcUk+Nxc4bNeGA1LfK9AKNjqb=wg@mail.gmail.com>
 <bcf6baca-0f89-14a8-4fe5-6c0d508ded31@gmail.com>
 <CACmBxyu08Xitvu7McRHV8RbtMOKE5OcApaK4Qwmj3zohnM8BYQ@mail.gmail.com>
 <3519171.V2xVJWdQM3@even-i700>
Message-ID: <CABUeae8pGPfwhe9moxT64o6FpM1MVqB_Vn7rViMpypHZdxcpwQ@mail.gmail.com>

On 30 March 2017 at 16:48, Even Rouault <even.rouault at spatialys.com> wrote:
> On jeudi 30 mars 2017 07:34:35 CEST Kurt Schwehr wrote:
>
>> At one point, I had a autoconf configure setup that was pretty minimal.
>
>> While it built, it was not so much fun to work with.  Here are some
>
>> remnants of notes that might constitute the beginnings of a
>
>> sourceme-minimal.sh.  More will likely be needed depending on libs are
>
>> already installed on your machine.  And gdal without many of these libs
>
>> (e.g. proj4, geos, libz/zlib) is just frustrating.
>
>
>
> As it seems several people have needs for minimized builds, perhaps they
> should consider upstreaming their efforts with build options (like --minimal
> and then --with-XXXX to selectively enable drivers), and the potential code
> refactoring that might make it easy. I think a continuous integration target
> that would test that would be needed to ensure this doesn't get broken by
> later developments.


BTW, I'm not sure what is wrong with the manual minimal build
https://trac.osgeo.org/gdal/wiki/BuildingOnUnixWithMinimizedDrivers
FYI, I used it two weeks ago, and update the wiki.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From even.rouault at spatialys.com  Thu Mar 30 09:08:23 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 30 Mar 2017 18:08:23 +0200
Subject: [gdal-dev] Building GDAL on linux with minimal drivers
In-Reply-To: <CABUeae8pGPfwhe9moxT64o6FpM1MVqB_Vn7rViMpypHZdxcpwQ@mail.gmail.com>
References: <CALMrLdB9F82YsffMrAKp0jUcUk+Nxc4bNeGA1LfK9AKNjqb=wg@mail.gmail.com>
 <3519171.V2xVJWdQM3@even-i700>
 <CABUeae8pGPfwhe9moxT64o6FpM1MVqB_Vn7rViMpypHZdxcpwQ@mail.gmail.com>
Message-ID: <2886666.le5l2E8QDc@even-i700>

On jeudi 30 mars 2017 16:51:49 CEST Mateusz Loskot wrote:
> On 30 March 2017 at 16:48, Even Rouault <even.rouault at spatialys.com> wrote:
> > On jeudi 30 mars 2017 07:34:35 CEST Kurt Schwehr wrote:
> >> At one point, I had a autoconf configure setup that was pretty minimal.
> >> 
> >> While it built, it was not so much fun to work with.  Here are some
> >> 
> >> remnants of notes that might constitute the beginnings of a
> >> 
> >> sourceme-minimal.sh.  More will likely be needed depending on libs are
> >> 
> >> already installed on your machine.  And gdal without many of these libs
> >> 
> >> (e.g. proj4, geos, libz/zlib) is just frustrating.
> > 
> > As it seems several people have needs for minimized builds, perhaps they
> > should consider upstreaming their efforts with build options (like
> > --minimal and then --with-XXXX to selectively enable drivers), and the
> > potential code refactoring that might make it easy. I think a continuous
> > integration target that would test that would be needed to ensure this
> > doesn't get broken by later developments.
> 
> BTW, I'm not sure what is wrong with the manual minimal build
> https://trac.osgeo.org/gdal/wiki/BuildingOnUnixWithMinimizedDrivers

Nothing. I also tested it successfully after you update

I think somepeople want even more minimized builds, presumably for embedded systems, 
without most drivers that don't depend on external libraries.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170330/113e1ef9/attachment.html>

From even.rouault at spatialys.com  Thu Mar 30 13:28:58 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 30 Mar 2017 22:28:58 +0200
Subject: [gdal-dev] GDAL 2.2 planning
Message-ID: <2961079.DVc9OeDfke@even-i700>

Hi,

To sum up a few scattered discussions from the beginning of the year, my 
intent is to tag a GDAL 2.2.0beta1 release on 14th April. The 2.2 branch 
will be created from that to stabilize it, and trunk will be then 2.3dev. A RC 
should likely be produced end of April if things go well.

Does that sound good ?

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170330/e5c1b5d3/attachment.html>

From vincent.bernat at magellium.fr  Fri Mar 31 07:04:29 2017
From: vincent.bernat at magellium.fr (Vincent BERNAT)
Date: Fri, 31 Mar 2017 14:04:29 +0000
Subject: [gdal-dev] GDAL /  GPKG in a C++ code
Message-ID: <1490969069585.39220@magellium.fr>

Hello all,


I would like to use GDAL in my C++ code to add geopackage output.

Is there a tutorial in order to use it in the best way?

Or, is there somebody who already did it?


Thanks.


Regards,

Vincent


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170331/d641c6cf/attachment.html>

From even.rouault at spatialys.com  Fri Mar 31 07:15:04 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 31 Mar 2017 16:15:04 +0200
Subject: [gdal-dev] GDAL /  GPKG in a C++ code
In-Reply-To: <1490969069585.39220@magellium.fr>
References: <1490969069585.39220@magellium.fr>
Message-ID: <11129572.euumbrrh5V@even-i700>

On vendredi 31 mars 2017 14:04:29 CEST Vincent BERNAT wrote:
> Hello all,
> 
> 
> I would like to use GDAL in my C++ code to add geopackage output.
> 
> Is there a tutorial in order to use it in the best way?
> 
> Or, is there somebody who already did it?

Vincent,

In case you didn't yet, have a look at the "Using Create()" and "Using CreateCopy()" 
paragraphs of
http://gdal.org/gdal_tutorial.html

They apply to all raster formats that have write capabilities, so GPKG.

Even
> 
> 
> Thanks.
> 
> 
> Regards,
> 
> Vincent


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170331/85c1b6df/attachment.html>

