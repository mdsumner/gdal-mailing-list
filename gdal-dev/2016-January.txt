From even.rouault at spatialys.com  Fri Jan  1 02:02:38 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 1 Jan 2016 11:02:38 +0100
Subject: [gdal-dev] Metadata from GeoTIFF to ENVI
In-Reply-To: <15070.173.48.226.138.1451601100.squirrel@webmail.jlab.org>
References: <15070.173.48.226.138.1451601100.squirrel@webmail.jlab.org>
Message-ID: <201601011102.38751.even.rouault@spatialys.com>

Le jeudi 31 décembre 2015 23:31:40, nguler at jlab.org a écrit :
> Dear GDAL Users,
> 
> I am reading a GeoTIFF file and creating an ENVI file. I don't want to use
> the CreateCopy method but the Create method.
> 
> I tried something like the following to transfer the metadata:
> 
>    char **papszMetadataSet;
>    papszMetadataSet = poDataset->GetMetadata();
>    poDstDS->SetMetadata(papszMetadataSet);
> 
> But, it did not work. I am pretty new to GDAL and I would greatly
> appreciate an example on how to transfer Metadata while creating an ENVI
> type file. I would like to learn how to transfer the whole metadata and
> also selected part of it.

Nevzat,

According to http://www.gdal.org/frmt_various.html#ENVI , "all ENVI header 
fields will be stored in the ENVI metadata domain, and all of these can then be 
written out to the header file". Which means in your case, you should motify 
your last line to be :

poDstDS->SetMetadata(papszMetadataSet, "ENVI");

Even

> 
> Best regards,
> - Nevzat
> 
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From nguler at jlab.org  Fri Jan  1 12:17:09 2016
From: nguler at jlab.org (Nevzat Guler)
Date: Fri, 1 Jan 2016 15:17:09 -0500
Subject: [gdal-dev] Metadata from GeoTIFF to ENVI
In-Reply-To: <201601011102.38751.even.rouault@spatialys.com>
References: <15070.173.48.226.138.1451601100.squirrel@webmail.jlab.org>
 <201601011102.38751.even.rouault@spatialys.com>
Message-ID: <000601d144d1$656cfc70$3046f550$@jlab.org>

Thanks Even.
I changed the line as you suggested but still missing some of the information in the header file. The header I get has the following:

ENVI
description = {
createdFile.hsi}
samples = 7571
lines   = 7411
bands   = 1
header offset = 0
file type = ENVI Standard
data type = 12
interleave = bsq
byte order = 0
band names = {
Band 1}
AREA OR POINT = Point

But, I know there are more info in the metadata including map info, coordinate systems and extents data etc.. 

How do I access to the metadata, meaning, how do I learn what kind of information exists in the papszMetadataSet variable? If I knew that I could try to write the header file myself. I am sorry if this is explained in somewhere but I could not find any example on how to access to metadata.

Best regards ,
- Nevzat

-----Original Message-----
From: Even Rouault [mailto:even.rouault at spatialys.com] 
Sent: Friday, January 01, 2016 5:03 AM
To: gdal-dev at lists.osgeo.org
Cc: nguler at jlab.org
Subject: Re: [gdal-dev] Metadata from GeoTIFF to ENVI

Le jeudi 31 décembre 2015 23:31:40, nguler at jlab.org a écrit :
> Dear GDAL Users,
> 
> I am reading a GeoTIFF file and creating an ENVI file. I don't want to 
> use the CreateCopy method but the Create method.
> 
> I tried something like the following to transfer the metadata:
> 
>    char **papszMetadataSet;
>    papszMetadataSet = poDataset->GetMetadata();
>    poDstDS->SetMetadata(papszMetadataSet);
> 
> But, it did not work. I am pretty new to GDAL and I would greatly 
> appreciate an example on how to transfer Metadata while creating an 
> ENVI type file. I would like to learn how to transfer the whole 
> metadata and also selected part of it.

Nevzat,

According to http://www.gdal.org/frmt_various.html#ENVI , "all ENVI header fields will be stored in the ENVI metadata domain, and all of these can then be written out to the header file". Which means in your case, you should motify your last line to be :

poDstDS->SetMetadata(papszMetadataSet, "ENVI");

Even

> 
> Best regards,
> - Nevzat
> 
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

--
Spatialys - Geospatial professional services http://www.spatialys.com


From even.rouault at spatialys.com  Fri Jan  1 12:58:36 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 1 Jan 2016 21:58:36 +0100
Subject: [gdal-dev] Metadata from GeoTIFF to ENVI
In-Reply-To: <000601d144d1$656cfc70$3046f550$@jlab.org>
References: <15070.173.48.226.138.1451601100.squirrel@webmail.jlab.org>
 <201601011102.38751.even.rouault@spatialys.com>
 <000601d144d1$656cfc70$3046f550$@jlab.org>
Message-ID: <201601012158.36938.even.rouault@spatialys.com>

Le vendredi 01 janvier 2016 21:17:09, Nevzat Guler a écrit :
> Thanks Even.
> I changed the line as you suggested but still missing some of the
> information in the header file. The header I get has the following:
> 
> ENVI
> description = {
> createdFile.hsi}
> samples = 7571
> lines   = 7411
> bands   = 1
> header offset = 0
> file type = ENVI Standard
> data type = 12
> interleave = bsq
> byte order = 0
> band names = {
> Band 1}
> AREA OR POINT = Point
> 
> But, I know there are more info in the metadata including map info,
> coordinate systems and extents data etc..

The following metadata items are ignored from the metadata array and must be 
set instead through the appropriate GDAL API, such as SetProjection(), 
SetGeoTransform(), SetDescription(), etc...

        if (poKey == "description" || poKey == "samples" || poKey == "lines" 
||
            poKey == "bands" || poKey == "header offset" || poKey == "file type" 
||
            poKey == "data type" || poKey == "interleave" || poKey == "byte 
order" ||
            poKey == "class names" || poKey == "band names" || poKey == "map 
info" ||
            poKey == "projection info")

See ENVIDataset::FlushCache() in 
https://svn.osgeo.org/gdal/trunk/gdal/frmts/raw/envidataset.cpp

> 
> How do I access to the metadata, meaning, how do I learn what kind of
> information exists in the papszMetadataSet variable? If I knew that I
> could try to write the header file myself. I am sorry if this is explained
> in somewhere but I could not find any example on how to access to
> metadata.

papszMetadataSet is a "Pointer to an Array of Pointers to String Zero-
terminated" (papsz), the array itself being terminated by a NULL pointer

for( char** papszIter = papszMetadataSet; *papszIter != NULL; papszIter++ )
	printf("%s\n", *papszIter);

> 
> Best regards ,
> - Nevzat
> 
> -----Original Message-----
> From: Even Rouault [mailto:even.rouault at spatialys.com]
> Sent: Friday, January 01, 2016 5:03 AM
> To: gdal-dev at lists.osgeo.org
> Cc: nguler at jlab.org
> Subject: Re: [gdal-dev] Metadata from GeoTIFF to ENVI
> 
> Le jeudi 31 décembre 2015 23:31:40, nguler at jlab.org a écrit :
> > Dear GDAL Users,
> > 
> > I am reading a GeoTIFF file and creating an ENVI file. I don't want to
> > use the CreateCopy method but the Create method.
> > 
> > I tried something like the following to transfer the metadata:
> >    char **papszMetadataSet;
> >    papszMetadataSet = poDataset->GetMetadata();
> >    poDstDS->SetMetadata(papszMetadataSet);
> > 
> > But, it did not work. I am pretty new to GDAL and I would greatly
> > appreciate an example on how to transfer Metadata while creating an
> > ENVI type file. I would like to learn how to transfer the whole
> > metadata and also selected part of it.
> 
> Nevzat,
> 
> According to http://www.gdal.org/frmt_various.html#ENVI , "all ENVI header
> fields will be stored in the ENVI metadata domain, and all of these can
> then be written out to the header file". Which means in your case, you
> should motify your last line to be :
> 
> poDstDS->SetMetadata(papszMetadataSet, "ENVI");
> 
> Even
> 
> > Best regards,
> > - Nevzat
> > 
> > 
> > 
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> --
> Spatialys - Geospatial professional services http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From Piyush.Agram at jpl.nasa.gov  Sat Jan  2 15:54:41 2016
From: Piyush.Agram at jpl.nasa.gov (Agram, Piyush S (334D))
Date: Sat, 2 Jan 2016 23:54:41 +0000
Subject: [gdal-dev] SCH support in GDAL
Message-ID: <D2ADA05D.183EC%Piyush.Agram@jpl.nasa.gov>

Hi,
   Spherical Cross-track Height (SCH) coordinate system support was added
to PROJ.4 about a couple of months ago. This is widely used for processing
radar remote sensing data, particularly for the NASA radar missions. I
have tried to include support for this coordinate system in GDAL by
defining new OGR SRS parameters.


You can find the change log here:

https://github.com/piyushrpt/gdal/commit/7e8f3c56367689fd4048063a5d0e2cd15a
93293b



Example output of gdalsrsinfo look's like this:

> gdalsrsinfo "+proj=sch +plat_0=30.3 +plon_0=45.1 +phdg_0=-12.2
>+datum=WGS84"

PROJ.4 : '+proj=sch +plat_0=30.3 +plon_0=45.1 +phdg_0=-12.2 +h_0=0
+datum=WGS84 +units=m +no_defs '

OGC WKT :
PROJCS["unnamed",
	GEOGCS["WGS 84",
		DATUM["WGS_1984",
			SPHEROID["WGS 84",6378137,298.257223563,
				AUTHORITY["EPSG","7030"]],
			AUTHORITY["EPSG","6326"]],
		PRIMEM["Greenwich",0,
			AUTHORITY["EPSG","8901"]],
		UNIT["degree",0.0174532925199433,
			AUTHORITY["EPSG","9122"]],
		AUTHORITY["EPSG","4326"]],
	PROJECTION["Spherical_Cross_Track_Height"],
	PARAMETER["peg_point_latitude",30.3],
	PARAMETER["peg_point_longitude",45.1],
	PARAMETER["peg_point_heading",-12.2],
	PARAMETER["peg_point_height",0]]



This is my first time working with OGR parameters. Any comments/
suggestions for improvements are welcome.
I hope to issue a pull request once the changes conform with established
conventions.

Thanks
Piyush


From even.rouault at spatialys.com  Mon Jan  4 03:58:23 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 4 Jan 2016 12:58:23 +0100
Subject: [gdal-dev] SCH support in GDAL
In-Reply-To: <D2ADA05D.183EC%Piyush.Agram@jpl.nasa.gov>
References: <D2ADA05D.183EC%Piyush.Agram@jpl.nasa.gov>
Message-ID: <201601041258.23898.even.rouault@spatialys.com>

Le dimanche 03 janvier 2016 00:54:41, Agram, Piyush S (334D) a écrit :
> Hi,
>    Spherical Cross-track Height (SCH) coordinate system support was added
> to PROJ.4 about a couple of months ago. This is widely used for processing
> radar remote sensing data, particularly for the NASA radar missions. I
> have tried to include support for this coordinate system in GDAL by
> defining new OGR SRS parameters.
> 
> 
> You can find the change log here:
> 
> https://github.com/piyushrpt/gdal/commit/7e8f3c56367689fd4048063a5d0e2cd15a
> 93293b

Technically looks good to me. Just for our information: are there raster 
formats handled by GDAL that will make use of this projection method ?

> 
> Example output of gdalsrsinfo look's like this:
> > gdalsrsinfo "+proj=sch +plat_0=30.3 +plon_0=45.1 +phdg_0=-12.2
> >
> >+datum=WGS84"
> 
> PROJ.4 : '+proj=sch +plat_0=30.3 +plon_0=45.1 +phdg_0=-12.2 +h_0=0
> +datum=WGS84 +units=m +no_defs '
> 
> OGC WKT :
> PROJCS["unnamed",
> 	GEOGCS["WGS 84",
> 		DATUM["WGS_1984",
> 			SPHEROID["WGS 84",6378137,298.257223563,
> 				AUTHORITY["EPSG","7030"]],
> 			AUTHORITY["EPSG","6326"]],
> 		PRIMEM["Greenwich",0,
> 			AUTHORITY["EPSG","8901"]],
> 		UNIT["degree",0.0174532925199433,
> 			AUTHORITY["EPSG","9122"]],
> 		AUTHORITY["EPSG","4326"]],
> 	PROJECTION["Spherical_Cross_Track_Height"],
> 	PARAMETER["peg_point_latitude",30.3],
> 	PARAMETER["peg_point_longitude",45.1],
> 	PARAMETER["peg_point_heading",-12.2],
> 	PARAMETER["peg_point_height",0]]
> 
> 
> 
> This is my first time working with OGR parameters. Any comments/
> suggestions for improvements are welcome.
> I hope to issue a pull request once the changes conform with established
> conventions.
> 
> Thanks
> Piyush
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From daniel.teske at web.de  Mon Jan  4 06:42:26 2016
From: daniel.teske at web.de (teeschke)
Date: Mon, 4 Jan 2016 06:42:26 -0800 (PST)
Subject: [gdal-dev] GDAL 2.0 as Virtual Machine
In-Reply-To: <1449514614389-5240311.post@n6.nabble.com>
References: <1449514614389-5240311.post@n6.nabble.com>
Message-ID: <1451918546570-5243619.post@n6.nabble.com>

Vagrant helped me out.
https://trac.osgeo.org/gdal/wiki/Vagrant

Now I can test 2.0 without touching my 1.11 installation.

Special thanks to Craig and best regards,
Daniel



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/GDAL-2-0-as-Virtual-Machine-tp5240311p5243619.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From landa.martin at gmail.com  Mon Jan  4 07:47:47 2016
From: landa.martin at gmail.com (Martin Landa)
Date: Mon, 4 Jan 2016 16:47:47 +0100
Subject: [gdal-dev] gml: array data type size
In-Reply-To: <201512171357.11007.even.rouault@spatialys.com>
References: <CA+Ei1Od+UvAP-U1guLdDxb7XMBEK3F79=vy5H40KR9_eH+sPKw@mail.gmail.com>
 <201512171357.11007.even.rouault@spatialys.com>
Message-ID: <CA+Ei1Of1g7nxNwSfYjT0RWSoEakCjF3XvC+x4Z6eaiwFbc=Z4w@mail.gmail.com>

Hi Even,

2015-12-17 13:57 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:

first of all thanks for the feedback.

> The proper solution would be to have the GML driver consider each
> <soi:DetailniTEA> as a separate layer/table and add cross feature links
> between "top" features and "sub" features.

Do you have any idea how much work it would be do modify GML driver in
this way and where to start?

Thanks, Martin

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.cz/mentors/landa

From even.rouault at spatialys.com  Mon Jan  4 08:38:11 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 4 Jan 2016 17:38:11 +0100
Subject: [gdal-dev] gml: array data type size
In-Reply-To: <CA+Ei1Of1g7nxNwSfYjT0RWSoEakCjF3XvC+x4Z6eaiwFbc=Z4w@mail.gmail.com>
References: <CA+Ei1Od+UvAP-U1guLdDxb7XMBEK3F79=vy5H40KR9_eH+sPKw@mail.gmail.com>
 <201512171357.11007.even.rouault@spatialys.com>
 <CA+Ei1Of1g7nxNwSfYjT0RWSoEakCjF3XvC+x4Z6eaiwFbc=Z4w@mail.gmail.com>
Message-ID: <201601041738.11937.even.rouault@spatialys.com>

Le lundi 04 janvier 2016 16:47:47, Martin Landa a écrit :
> Hi Even,
> 
> 2015-12-17 13:57 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:
> 
> first of all thanks for the feedback.
> 
> > The proper solution would be to have the GML driver consider each
> > <soi:DetailniTEA> as a separate layer/table and add cross feature links
> > between "top" features and "sub" features.
> 
> Do you have any idea how much work it would be do modify GML driver in
> this way and where to start?

Actually you could check the ogr_gml_56 test case of ogr/ogr_gml_read.py that 
handles something similar to what you have. It might be that you wouldn't need 
to do change codes by providing the adequate .xsd / .gfs.


> 
> Thanks, Martin

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Mon Jan  4 08:46:32 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 4 Jan 2016 17:46:32 +0100
Subject: [gdal-dev] get image pointer
In-Reply-To: <1735787933.53706.1450348899302.JavaMail.yahoo@mail.yahoo.com>
References: <1735787933.53706.1450348899302.JavaMail.yahoo.ref@mail.yahoo.com>
 <1735787933.53706.1450348899302.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <201601041746.33037.even.rouault@spatialys.com>

Le jeudi 17 décembre 2015 11:41:39, Basos Syrris a écrit :
> Hi list,By using Python Gdal api to read an image, is it possible to get
> the pointer of the image instead of taking the whole content as a string
> structure as this happens with the ReadRaster() method?T

You can call Band.ReadAsArray(xoff,yoff,xsize,ysize) to read a sub window of the 
image as a numpy array.


> hank you in
> advance.Basos

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From Piyush.Agram at jpl.nasa.gov  Mon Jan  4 09:48:16 2016
From: Piyush.Agram at jpl.nasa.gov (Agram, Piyush S (334D))
Date: Mon, 4 Jan 2016 17:48:16 +0000
Subject: [gdal-dev] SCH support in GDAL
In-Reply-To: <201601041258.23898.even.rouault@spatialys.com>
References: <D2ADA05D.183EC%Piyush.Agram@jpl.nasa.gov>
 <201601041258.23898.even.rouault@spatialys.com>
Message-ID: <D2AFEF9C.18431%Piyush.Agram@jpl.nasa.gov>

Hi,
  Currently, there are no raster formats that use this projection method.
These are more likely to be used with GCP's or in metadata. But in the
future, these could be used with raster formats - e.g, JPL's UAVSAR data.

Are there other parts of GDAL where support for the new projection needs
to be included, if assuming, some raster format needed to use it?

Thanks
Piyush 

On 1/4/16 3:58 AM, "Even Rouault" <even.rouault at spatialys.com> wrote:

>Le dimanche 03 janvier 2016 00:54:41, Agram, Piyush S (334D) a écrit :
>> Hi,
>>    Spherical Cross-track Height (SCH) coordinate system support was
>>added
>> to PROJ.4 about a couple of months ago. This is widely used for
>>processing
>> radar remote sensing data, particularly for the NASA radar missions. I
>> have tried to include support for this coordinate system in GDAL by
>> defining new OGR SRS parameters.
>> 
>> 
>> You can find the change log here:
>> 
>> 
>>https://github.com/piyushrpt/gdal/commit/7e8f3c56367689fd4048063a5d0e2cd1
>>5a
>> 93293b
>
>Technically looks good to me. Just for our information: are there raster
>formats handled by GDAL that will make use of this projection method ?
>
>> 
>> Example output of gdalsrsinfo look's like this:
>> > gdalsrsinfo "+proj=sch +plat_0=30.3 +plon_0=45.1 +phdg_0=-12.2
>> >
>> >+datum=WGS84"
>> 
>> PROJ.4 : '+proj=sch +plat_0=30.3 +plon_0=45.1 +phdg_0=-12.2 +h_0=0
>> +datum=WGS84 +units=m +no_defs '
>> 
>> OGC WKT :
>> PROJCS["unnamed",
>> 	GEOGCS["WGS 84",
>> 		DATUM["WGS_1984",
>> 			SPHEROID["WGS 84",6378137,298.257223563,
>> 				AUTHORITY["EPSG","7030"]],
>> 			AUTHORITY["EPSG","6326"]],
>> 		PRIMEM["Greenwich",0,
>> 			AUTHORITY["EPSG","8901"]],
>> 		UNIT["degree",0.0174532925199433,
>> 			AUTHORITY["EPSG","9122"]],
>> 		AUTHORITY["EPSG","4326"]],
>> 	PROJECTION["Spherical_Cross_Track_Height"],
>> 	PARAMETER["peg_point_latitude",30.3],
>> 	PARAMETER["peg_point_longitude",45.1],
>> 	PARAMETER["peg_point_heading",-12.2],
>> 	PARAMETER["peg_point_height",0]]
>> 
>> 
>> 
>> This is my first time working with OGR parameters. Any comments/
>> suggestions for improvements are welcome.
>> I hope to issue a pull request once the changes conform with established
>> conventions.
>> 
>> Thanks
>> Piyush
>> 
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>-- 
>Spatialys - Geospatial professional services
>http://www.spatialys.com


From even.rouault at spatialys.com  Mon Jan  4 10:26:02 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 4 Jan 2016 19:26:02 +0100
Subject: [gdal-dev] SCH support in GDAL
In-Reply-To: <D2AFEF9C.18431%Piyush.Agram@jpl.nasa.gov>
References: <D2ADA05D.183EC%Piyush.Agram@jpl.nasa.gov>
 <201601041258.23898.even.rouault@spatialys.com>
 <D2AFEF9C.18431%Piyush.Agram@jpl.nasa.gov>
Message-ID: <201601041926.02591.even.rouault@spatialys.com>

Le lundi 04 janvier 2016 18:48:16, Agram, Piyush S (334D) a écrit :
> Hi,
>   Currently, there are no raster formats that use this projection method.
> These are more likely to be used with GCP's or in metadata. But in the
> future, these could be used with raster formats - e.g, JPL's UAVSAR data.
> 
> Are there other parts of GDAL where support for the new projection needs
> to be included, if assuming, some raster format needed to use it?

Some drivers have a very dedicated way of expression projections, think of 
GeoTIFF, so there will be no way to represent SCH for them (unless the 
underlying format is extended to include SCH). So currently this will only 
work with drivers that store proj.4 strings or WKT strings.

I've committed your PR to trunk (with a fix so that Validate() works, and a one 
line test case in autotest/osr/osr_proj4.py)


> 
> Thanks
> Piyush
> 
> On 1/4/16 3:58 AM, "Even Rouault" <even.rouault at spatialys.com> wrote:
> >Le dimanche 03 janvier 2016 00:54:41, Agram, Piyush S (334D) a écrit :
> >> Hi,
> >> 
> >>    Spherical Cross-track Height (SCH) coordinate system support was
> >>
> >>added
> >>
> >> to PROJ.4 about a couple of months ago. This is widely used for
> >>
> >>processing
> >>
> >> radar remote sensing data, particularly for the NASA radar missions. I
> >> have tried to include support for this coordinate system in GDAL by
> >> defining new OGR SRS parameters.
> >>
> >> You can find the change log here:
> >>https://github.com/piyushrpt/gdal/commit/7e8f3c56367689fd4048063a5d0e2cd1
> >>5a
> >>
> >> 93293b
> >
> >Technically looks good to me. Just for our information: are there raster
> >formats handled by GDAL that will make use of this projection method ?
> >
> >> Example output of gdalsrsinfo look's like this:
> >> > gdalsrsinfo "+proj=sch +plat_0=30.3 +plon_0=45.1 +phdg_0=-12.2
> >> >
> >> >+datum=WGS84"
> >> 
> >> PROJ.4 : '+proj=sch +plat_0=30.3 +plon_0=45.1 +phdg_0=-12.2 +h_0=0
> >> +datum=WGS84 +units=m +no_defs '
> >> 
> >> OGC WKT :
> >> PROJCS["unnamed",
> >> 
> >> 	GEOGCS["WGS 84",
> >> 	
> >> 		DATUM["WGS_1984",
> >> 		
> >> 			SPHEROID["WGS 84",6378137,298.257223563,
> >> 			
> >> 				AUTHORITY["EPSG","7030"]],
> >> 			
> >> 			AUTHORITY["EPSG","6326"]],
> >> 		
> >> 		PRIMEM["Greenwich",0,
> >> 		
> >> 			AUTHORITY["EPSG","8901"]],
> >> 		
> >> 		UNIT["degree",0.0174532925199433,
> >> 		
> >> 			AUTHORITY["EPSG","9122"]],
> >> 		
> >> 		AUTHORITY["EPSG","4326"]],
> >> 	
> >> 	PROJECTION["Spherical_Cross_Track_Height"],
> >> 	PARAMETER["peg_point_latitude",30.3],
> >> 	PARAMETER["peg_point_longitude",45.1],
> >> 	PARAMETER["peg_point_heading",-12.2],
> >> 	PARAMETER["peg_point_height",0]]
> >> 
> >> This is my first time working with OGR parameters. Any comments/
> >> suggestions for improvements are welcome.
> >> I hope to issue a pull request once the changes conform with established
> >> conventions.
> >> 
> >> Thanks
> >> Piyush
> >> 
> >> _______________________________________________
> >> gdal-dev mailing list
> >> gdal-dev at lists.osgeo.org
> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From dadler at adtechgeospatial.com  Mon Jan  4 10:32:33 2016
From: dadler at adtechgeospatial.com (David Adler)
Date: Mon, 4 Jan 2016 13:32:33 -0500
Subject: [gdal-dev] How can I track down autotest python error?
Message-ID: <568ABAC1.1040207@adtechgeospatial.com>

I'm getting:
GDAL: 
GDALOpen(DB2ODBC:DB2:database=samp105;DSN=SAMP105A;tables=TEST.ZIPPOINT, 
this=004995C0) succeeds as DB2ODBC.
GTiff: Reopen with strip chop enabled
GDAL: GDALOpen(..\gcore\data/cfloat64.tif, this=0485BEC8) succeeds as GTiff.

ODBC: SQLDisconnect()
GDAL: 
GDALClose(DB2ODBC:DB2:database=samp105;DSN=SAMP105A;tables=TEST.ZIPPOINT, this=004995C0)
GDAL: GDALClose(..\gcore\data/cfloat64.tif, this=0485BEC8)
Traceback (most recent call last):
   File "../pymod\gdaltest_python2.py", line 42, in run_func
     result = func()
   File "ogr_db2r.py", line 278, in ogr_db2_CopyRaster1
     new_ds = ogrtest.db2_drv.CreateCopy( 
'DB2ODBC:database=samp105;DSN=SAMP105A', src_ds )
   File 
"C:\Python27\lib\site-packages\gdal-2.1.0-py2.7-win32.egg\osgeo\ogr.py", 
line 363, in <lambda>
     __getattr__ = lambda self, name: _swig_getattr(self, Driver, name)
   File 
"C:\Python27\lib\site-packages\gdal-2.1.0-py2.7-win32.egg\osgeo\ogr.py", 
line 57, in _swig_getattr
     raise AttributeError(name)
AttributeError: CreateCopy
GDAL: In GDALDestroy - unloading GDAL shared library.

from:
def ogr_db2_CopyRaster1():
     if ogrtest.db2_drv is None:
         return 'skip'
     ds = ogr.Open(ogrtest.db2_test_server)
     if ds is None:
         return 'fail'
     src_ds = gdal.Open( '..\gcore\data/cfloat64.tif' )
     new_ds = ogrtest.db2_drv.CreateCopy( 
'DB2ODBC:database=samp105;DSN=SAMP105A', src_ds )

I'm guessing this is from CreateCopy. There is no other obvious error 
indication.
This works fine from gdal_translate.

Any suggestions?


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160104/9df8dddc/attachment.html>

From even.rouault at spatialys.com  Mon Jan  4 10:40:25 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 4 Jan 2016 19:40:25 +0100
Subject: [gdal-dev] How can I track down autotest python error?
In-Reply-To: <568ABAC1.1040207@adtechgeospatial.com>
References: <568ABAC1.1040207@adtechgeospatial.com>
Message-ID: <201601041940.25699.even.rouault@spatialys.com>

Le lundi 04 janvier 2016 19:32:33, David Adler a écrit :
> I'm getting:
> GDAL:
> GDALOpen(DB2ODBC:DB2:database=samp105;DSN=SAMP105A;tables=TEST.ZIPPOINT,
> this=004995C0) succeeds as DB2ODBC.
> GTiff: Reopen with strip chop enabled
> GDAL: GDALOpen(..\gcore\data/cfloat64.tif, this=0485BEC8) succeeds as
> GTiff.
> 
> ODBC: SQLDisconnect()
> GDAL:
> GDALClose(DB2ODBC:DB2:database=samp105;DSN=SAMP105A;tables=TEST.ZIPPOINT,
> this=004995C0) GDAL: GDALClose(..\gcore\data/cfloat64.tif, this=0485BEC8)
> Traceback (most recent call last):
>    File "../pymod\gdaltest_python2.py", line 42, in run_func
>      result = func()
>    File "ogr_db2r.py", line 278, in ogr_db2_CopyRaster1
>      new_ds = ogrtest.db2_drv.CreateCopy(
> 'DB2ODBC:database=samp105;DSN=SAMP105A', src_ds )
>    File
> "C:\Python27\lib\site-packages\gdal-2.1.0-py2.7-win32.egg\osgeo\ogr.py",
> line 363, in <lambda>
>      __getattr__ = lambda self, name: _swig_getattr(self, Driver, name)
>    File
> "C:\Python27\lib\site-packages\gdal-2.1.0-py2.7-win32.egg\osgeo\ogr.py",
> line 57, in _swig_getattr
>      raise AttributeError(name)
> AttributeError: CreateCopy
> GDAL: In GDALDestroy - unloading GDAL shared library.
> 
> from:
> def ogr_db2_CopyRaster1():
>      if ogrtest.db2_drv is None:
>          return 'skip'
>      ds = ogr.Open(ogrtest.db2_test_server)
>      if ds is None:
>          return 'fail'
>      src_ds = gdal.Open( '..\gcore\data/cfloat64.tif' )
>      new_ds = ogrtest.db2_drv.CreateCopy(
> 'DB2ODBC:database=samp105;DSN=SAMP105A', src_ds )
> 
> I'm guessing this is from CreateCopy. There is no other obvious error
> indication.

The issue is that you are calling CreateCopy() on a - legacy - OGR driver, 
which is not supported. You should call it on a driver returned by 
gdal.GetDriverByName() instead.

> This works fine from gdal_translate.
> 
> Any suggestions?

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From avyavkumar at gmail.com  Mon Jan  4 23:00:08 2016
From: avyavkumar at gmail.com (Avyav Kumar)
Date: Tue, 5 Jan 2016 12:30:08 +0530
Subject: [gdal-dev] gdal_calc.py gives different answers
Message-ID: <CAHOc4-3zhPG0vs8dSAcMLPOy2CbkJ0BbNVYYBmza6mWcAL6Vzg@mail.gmail.com>

This is a rather interesting error, which is listed here (
https://trac.osgeo.org/gdal/ticket/5478).  While getting the intermediate
calculations of the raster band for A and B, I noticed the following -

For --calc="A*20+B", the raster formed as the result of the addition of
A*20 and B is not equal to A*20 + B.

For --calc="A*20.0+B", the raster formed as the result of the addition of
A*20.0 and B is, in fact, equal to A*20 + B.

Logically, these should have the same value as there is no difference
between 20.0 and 20. However, as it is pointed out in the thread, running
gdalinfo -stats on them yields -

For --calc="A*20+B", the raster formed is a valid raster.

For --calc="A*20.0+B", the raster formed is invalid!

Hence, even though the intermediate calculation on the second --calc value
is correct, there is no valid output raster formed. Is it because the value
A*20 + B would have overshot the boundary values for 8-bit channel? Any
thoughts?

Regards,

Avyav
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160105/40da6215/attachment.html>

From ari.jolma at gmail.com  Mon Jan  4 23:55:33 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 5 Jan 2016 09:55:33 +0200
Subject: [gdal-dev] gdal_calc.py gives different answers
In-Reply-To: <CAHOc4-3zhPG0vs8dSAcMLPOy2CbkJ0BbNVYYBmza6mWcAL6Vzg@mail.gmail.com>
References: <CAHOc4-3zhPG0vs8dSAcMLPOy2CbkJ0BbNVYYBmza6mWcAL6Vzg@mail.gmail.com>
Message-ID: <568B76F5.9010705@gmail.com>

I have no experience with gdal_calc.pv nor do I know about its internals 
anything beside it being implemented with numpy. So I comment this only 
from a general point of view.

05.01.2016, 09:00, Avyav Kumar kirjoitti:
> This is a rather interesting error, which is listed here 
> (https://trac.osgeo.org/gdal/ticket/5478). While getting the 
> intermediate calculations of the raster band for A and B, I noticed 
> the following -
>
> For --calc="A*20+B", the raster formed as the result of the addition 
> of A*20 and B is not equal to A*20 + B.
>
> For --calc="A*20.0+B", the raster formed as the result of the addition 
> of A*20.0 and B is, in fact, equal to A*20 + B.
>
> Logically, these should have the same value as there is no difference 
> between 20.0 and 20.

I would say that there is since 20.0 is a real number and 20 is an 
integer. Now, depending on whether A and B are real or integer valued, 
A*20 can be either real or integer valued and A*20.0 is real valued, and 
A*20+B and A*20.0+B can be either real or integer valued. Treating 
values as real or integer are quite different in programming languages 
and also when storing them with raster formats. Also, as you say below, 
integer values can easily flow over.

Best regards,

Ari

> However, as it is pointed out in the thread, running gdalinfo -stats 
> on them yields -
>
> For --calc="A*20+B", the raster formed is a valid raster.
>
> For --calc="A*20.0+B", the raster formed is invalid!
>
> Hence, even though the intermediate calculation on the second --calc 
> value is correct, there is no valid output raster formed. Is it 
> because the value A*20 + B would have overshot the boundary values for 
> 8-bit channel? Any thoughts?
>
> Regards,
>
> Avyav
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160105/18883407/attachment.html>

From gane.prog at gmail.com  Tue Jan  5 01:54:57 2016
From: gane.prog at gmail.com (Gane R)
Date: Tue, 5 Jan 2016 15:24:57 +0530
Subject: [gdal-dev] crashes at CreateDataSource
Message-ID: <CALMrLdAaYBrqtKWPMmVmJufp-M+F6xR5AQ+MJVjkbdMeAMitCg@mail.gmail.com>

gdal version gdal-1.11.3 - Filegeodbversion 1.4
{
OGRSFDriverRegistrar    *poR;                    //Pointer to hold the
driver registration
OGRSFDriver                *poDriver;
OGRDataSource            *poODS;
OGRRegisterAll();
poR = OGRSFDriverRegistrar::GetRegistrar();
poDriver = poR->GetDriverByName("FileGDB");
poODS = poDriver->CreateDataSource("sample1.gdb",NULL);
/*
Here adding layeres and fields and geom
Finnally closing the dataset OGRDataSource::DestroyDataSource( poODS );
*OGRCleanup not called.*
*/
}
*First time the code works fine, and the second time different .gdb name
the code crashes at createDatasource.*

*This is a snippet of code, I get crash at CreateDataSource second time for
another filename, this code I am trying to put inside a DLL*

 *features created are destroyed.OGRFeature::DestroyFeature( poFeature );*
Do I use the API correctly? any suggestions, What the cause of this crash
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160105/77da0841/attachment.html>

From even.rouault at spatialys.com  Tue Jan  5 02:10:54 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 5 Jan 2016 11:10:54 +0100
Subject: [gdal-dev] crashes at CreateDataSource
In-Reply-To: <CALMrLdAaYBrqtKWPMmVmJufp-M+F6xR5AQ+MJVjkbdMeAMitCg@mail.gmail.com>
References: <CALMrLdAaYBrqtKWPMmVmJufp-M+F6xR5AQ+MJVjkbdMeAMitCg@mail.gmail.com>
Message-ID: <201601051110.54790.even.rouault@spatialys.com>

Le mardi 05 janvier 2016 10:54:57, Gane R a écrit :
> gdal version gdal-1.11.3 - Filegeodbversion 1.4
> {
> OGRSFDriverRegistrar    *poR;                    //Pointer to hold the
> driver registration
> OGRSFDriver                *poDriver;
> OGRDataSource            *poODS;
> OGRRegisterAll();
> poR = OGRSFDriverRegistrar::GetRegistrar();
> poDriver = poR->GetDriverByName("FileGDB");
> poODS = poDriver->CreateDataSource("sample1.gdb",NULL);
> /*
> Here adding layeres and fields and geom
> Finnally closing the dataset OGRDataSource::DestroyDataSource( poODS );
> *OGRCleanup not called.*
> */
> }
> *First time the code works fine, and the second time different .gdb name
> the code crashes at createDatasource.*
> 
> *This is a snippet of code, I get crash at CreateDataSource second time for
> another filename, this code I am trying to put inside a DLL*
> 
>  *features created are destroyed.OGRFeature::DestroyFeature( poFeature );*
> Do I use the API correctly? any suggestions, What the cause of this crash

Difficult to say without a full reproducer.

I've just tested the below Python script with the 1.11 branch and FileGDB 1.4 
on Linux and it works fine:

from osgeo import ogr
from osgeo import osr

for i in range(10):
    ds = ogr.GetDriverByName('FileGDB').CreateDataSource('test%d.gdb'% i)
    srs = osr.SpatialReference()
    srs.ImportFromEPSG(4326)
    lyr = ds.CreateLayer('test', geom_type = ogr.wkbPoint, srs = srs)
    lyr.CreateField(ogr.FieldDefn('id', ogr.OFTInteger))
    f = ogr.Feature(lyr.GetLayerDefn())
    f['id'] = 1
    f.SetGeometry(ogr.CreateGeometryFromWkt('POINT (2 49)'))
    lyr.CreateFeature(f)



-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gane.prog at gmail.com  Tue Jan  5 03:01:19 2016
From: gane.prog at gmail.com (Gane R)
Date: Tue, 5 Jan 2016 16:31:19 +0530
Subject: [gdal-dev] crashes at CreateDataSource
In-Reply-To: <201601051128.05608.even.rouault@spatialys.com>
References: <CALMrLdAaYBrqtKWPMmVmJufp-M+F6xR5AQ+MJVjkbdMeAMitCg@mail.gmail.com>
 <201601051110.54790.even.rouault@spatialys.com>
 <CALMrLdBmrayozj6tm2PELxFA-YJdvUM6qx-fdFgW2JGAxGd_aQ@mail.gmail.com>
 <201601051128.05608.even.rouault@spatialys.com>
Message-ID: <CALMrLdDN=FMmOWOVPMFFm7g9V7-TNe9CogcQ8aMJokETs+HseA@mail.gmail.com>

Does the CreateDataSource for filegeodb support filename.gdb with long path
before

CreateDataSource("D:\\temp\\212121\\121212134345\\sample.gdb",NULL);
Gane

On Tue, Jan 5, 2016 at 3:58 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le mardi 05 janvier 2016 11:13:38, Gane R a écrit :
> > Can send the full python script of above so I can verify that I am on
> right
> > track.
>
> Not sure to understand if you ask me to provide the full python script
> (what I
> put in my previous email was the full script) or if you intended to
> provide me
> with a python port of your C++ code.
>
> >
> > Gane
> >
> > On Tue, Jan 5, 2016 at 3:40 PM, Even Rouault <even.rouault at spatialys.com
> >
> >
> > wrote:
> > > Le mardi 05 janvier 2016 10:54:57, Gane R a écrit :
> > > > gdal version gdal-1.11.3 - Filegeodbversion 1.4
> > > > {
> > > > OGRSFDriverRegistrar    *poR;                    //Pointer to hold
> the
> > > > driver registration
> > > > OGRSFDriver                *poDriver;
> > > > OGRDataSource            *poODS;
> > > > OGRRegisterAll();
> > > > poR = OGRSFDriverRegistrar::GetRegistrar();
> > > > poDriver = poR->GetDriverByName("FileGDB");
> > > > poODS = poDriver->CreateDataSource("sample1.gdb",NULL);
> > > > /*
> > > > Here adding layeres and fields and geom
> > > > Finnally closing the dataset OGRDataSource::DestroyDataSource( poODS
> );
> > > > *OGRCleanup not called.*
> > > > */
> > > > }
> > > > *First time the code works fine, and the second time different .gdb
> > > > name the code crashes at createDatasource.*
> > > >
> > > > *This is a snippet of code, I get crash at CreateDataSource second
> time
> > >
> > > for
> > >
> > > > another filename, this code I am trying to put inside a DLL*
> > > >
> > > >  *features created are destroyed.OGRFeature::DestroyFeature(
> poFeature
> > >
> > > );*
> > >
> > > > Do I use the API correctly? any suggestions, What the cause of this
> > > > crash
> > >
> > > Difficult to say without a full reproducer.
> > >
> > > I've just tested the below Python script with the 1.11 branch and
> FileGDB
> > > 1.4
> > > on Linux and it works fine:
> > >
> > > from osgeo import ogr
> > > from osgeo import osr
> > >
> > > for i in range(10):
> > >     ds = ogr.GetDriverByName('FileGDB').CreateDataSource('test%d.gdb'%
> i)
> > >     srs = osr.SpatialReference()
> > >     srs.ImportFromEPSG(4326)
> > >     lyr = ds.CreateLayer('test', geom_type = ogr.wkbPoint, srs = srs)
> > >     lyr.CreateField(ogr.FieldDefn('id', ogr.OFTInteger))
> > >     f = ogr.Feature(lyr.GetLayerDefn())
> > >     f['id'] = 1
> > >     f.SetGeometry(ogr.CreateGeometryFromWkt('POINT (2 49)'))
> > >     lyr.CreateFeature(f)
> > >
> > > --
> > > Spatialys - Geospatial professional services
> > > http://www.spatialys.com
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160105/abe619d4/attachment-0001.html>

From jesse.hietanen at gmail.com  Tue Jan  5 06:33:49 2016
From: jesse.hietanen at gmail.com (johie)
Date: Tue, 5 Jan 2016 06:33:49 -0800 (PST)
Subject: [gdal-dev] GDAL Java Bindings - Unable to use same jar on linux and
 windows
Message-ID: <1452004429854-5243795.post@n6.nabble.com>

Hi everyone,

I have a problem with the GDAL 2.1.0 DEV version. I'm developing an
application, which uses GDAL Java Bindings. I have been doing development
with windows, and been using the gisinternals GDAL binaries
(http://download.gisinternals.com/sdk/downloads/release-1800-x64-gdal-mapserver.zip),
from 18 december 2015. 

The problem is that I need to run the application with Centos 7 (OpenJDK
Java 8, SWIG 2.0.10), and there are no ready Java bindings (at least I have
not found). I downloaded the latest trunk from git (around same time when
installed the windows binaries, 20.12.2015), and build the gdal and swig
bindings succesfully. The problem seems to be somewhat different filenaming
inside the jar files. 

If I run my application inside windows using the centos made .jar, I get: 
java.lang.UnsatisfiedLinkError: org.gdal.gdal.gdalJNI.Dataset_SWIGUpcast(J)J
	at org.gdal.gdal.gdalJNI.Dataset_SWIGUpcast(Native Method)

If I run it on centos, with windows made .jar I get,

Exception in thread "main" java.lang.UnsatisfiedLinkError:
org.gdal.gdal.gdalJNI.SWIGDatasetUpcast(J)J
        at org.gdal.gdal.gdalJNI.SWIGDatasetUpcast(Native Method).

The only difference I can notice between them, is the name of those
methods/classes.

Any ideas how could I solve this problem? I would like to continue
developing with windows and then just move the shaded jar to the centos. I
did not have this problem when using the stable 2.0 version, however I need
some functionalities of the development version :)

Thanks a lot,

Jesse







--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-GDAL-Java-Bindings-Unable-to-use-same-jar-on-linux-and-windows-tp5243795.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Tue Jan  5 06:59:49 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 5 Jan 2016 15:59:49 +0100
Subject: [gdal-dev] GDAL Java Bindings - Unable to use same jar on linux
	and windows
In-Reply-To: <1452004429854-5243795.post@n6.nabble.com>
References: <1452004429854-5243795.post@n6.nabble.com>
Message-ID: <201601051559.49225.even.rouault@spatialys.com>

Le mardi 05 janvier 2016 15:33:49, johie a écrit :
> Hi everyone,
> 
> I have a problem with the GDAL 2.1.0 DEV version. I'm developing an
> application, which uses GDAL Java Bindings. I have been doing development
> with windows, and been using the gisinternals GDAL binaries
> (http://download.gisinternals.com/sdk/downloads/release-1800-x64-gdal-mapse
> rver.zip), from 18 december 2015.
> 
> The problem is that I need to run the application with Centos 7 (OpenJDK
> Java 8, SWIG 2.0.10), and there are no ready Java bindings (at least I have
> not found). I downloaded the latest trunk from git (around same time when
> installed the windows binaries, 20.12.2015), and build the gdal and swig
> bindings succesfully. The problem seems to be somewhat different filenaming
> inside the jar files.
> 
> If I run my application inside windows using the centos made .jar, I get:
> java.lang.UnsatisfiedLinkError:
> org.gdal.gdal.gdalJNI.Dataset_SWIGUpcast(J)J at
> org.gdal.gdal.gdalJNI.Dataset_SWIGUpcast(Native Method)
> 
> If I run it on centos, with windows made .jar I get,
> 
> Exception in thread "main" java.lang.UnsatisfiedLinkError:
> org.gdal.gdal.gdalJNI.SWIGDatasetUpcast(J)J
>         at org.gdal.gdal.gdalJNI.SWIGDatasetUpcast(Native Method).
> 
> The only difference I can notice between them, is the name of those
> methods/classes.
> 
> Any ideas how could I solve this problem? I would like to continue
> developing with windows and then just move the shaded jar to the centos. I
> did not have this problem when using the stable 2.0 version, however I need
> some functionalities of the development version :)

The issue comes from different SWIG version being used to generate the .java 
bindings file

GISInternals must used SWIG 1.3.40 (SWIGDatasetUpcast) whereas CentOS 7 with 
SWIG 2.0.10 generates Dataset_SWIGUpcast.
If you want to have GISInternals as a reference, then you could try to use 
swig 1.3.40 on your CentOS too:
- download swig 1.3.40
- ./configure --prefix=$HOME/install-swig-1.3.40
- make && make install
- and then when building the GDAL Java bindings make sure $HOME/install-
swig-1.3.40/bin is in the front of the $PATH. Or edit gdal/swig/SWIGmake.base 
so that the SWIG variable points to $HOME/install-swig-1.3.40/bin/swig


> 
> Thanks a lot,
> 
> Jesse
> 
> 
> 
> 
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/gdal-dev-GDAL-Java-Bindings-Unable-to-
> use-same-jar-on-linux-and-windows-tp5243795.html Sent from the GDAL - Dev
> mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jan at knepper.net  Tue Jan  5 07:20:08 2016
From: jan at knepper.net (Jan Knepper)
Date: Tue, 5 Jan 2016 10:20:08 -0500
Subject: [gdal-dev] gdalbuildvrt & gdal2tiles.py with GeoTIFF across
	anti-meridian...
Message-ID: <568BDF28.9050609@knepper.net>

All,

Running across (an) other issue(s)...

I was able to gdalwarp a .tif overlapping the anti-meridian with 
--config CENTER_LONG 180

Next step was to use gdalbuildvrt to build a .vrt file in preparation 
for tiling with gdal2tiles.py.
When trying that this message displays:
Warning 6: gdalbuildvrt does not support heterogenous projection. 
Skipping ...
And the skipped file is not included in the .vrt file.

I tried using the --config CENTER_LONG 180 with gdalbuildvrt which gives 
the same result.

Then I tried:
gdalbuildvrt --config CENTER_LONG 180 -allow_projection_difference ...

This does NOT give the previous message, but after running gdal2tiles.py 
on the .vrt the tiles that should have been generated from the .tif file 
in question appear to be missing...
Any thing specific I should do to make this work?

Something else I noticed is that it seems to be important in what order 
.tif files are submitted to gdalbuildvrt. Many if not all the .tif(s) 
used have an Alpha Channel for transparency because they are 'cut' from 
a .tif. What I see happening is that the transparent part of a /later/ 
.tif wipes the non-transparent parts of /earlier/ .tif(s) it overlaps. 
Is there an easy solution for this?

GDAL 1.11.2, released 2015/02/10

Any help/assistance would be appreciated!

Thanks!
Jan

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160105/1fac2931/attachment.html>

From boxerab at gmail.com  Tue Jan  5 07:23:57 2016
From: boxerab at gmail.com (Aaron Boxer)
Date: Tue, 5 Jan 2016 10:23:57 -0500
Subject: [gdal-dev] OpenJPEG update
Message-ID: <CAK8GPyDjd7p+Xz8o80cmHUQ0J17KoR=5vOs66in7qiyJZ9fA8w@mail.gmail.com>

Hello,

I am looking into reducing memory usage for OpenJPEG.(how I spent my
Christmas holidays :)  )

So far, I have managed to halve memory usage for high bit rate decoding,
for example. 1920x1080 single tile lossy-compressed image at 9:1
compression.

And there is more low hanging fruit.....

I have a pull request submitted for my omnibus branch. This branch includes
performance and memory improvements:

1) OpenMP support: multi-threading built into the library
2) encoding perf improvements
3) memory mapped file support and drastic reduction in decode memory usage

All unit tests and memory leak tests have passed for this branch.

If these changes sound useful to you, please show your support by either
posting on the OpenJPEG news group:

https://groups.google.com/forum/#!forum/openjpeg

or commenting on the pull request:

https://github.com/uclouvain/openjpeg/pull/683

The project maintainers need "encouragement" to get new features merged
into the master.

Thanks and Happy New Year,
Aaron
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160105/65fabef6/attachment.html>

From even.rouault at spatialys.com  Tue Jan  5 07:32:26 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 5 Jan 2016 16:32:26 +0100
Subject: [gdal-dev] gdalbuildvrt & gdal2tiles.py with GeoTIFF across
	anti-meridian...
In-Reply-To: <568BDF28.9050609@knepper.net>
References: <568BDF28.9050609@knepper.net>
Message-ID: <201601051632.26117.even.rouault@spatialys.com>

Le mardi 05 janvier 2016 16:20:08, Jan Knepper a écrit :
> All,
> 
> Running across (an) other issue(s)...
> 
> I was able to gdalwarp a .tif overlapping the anti-meridian with
> --config CENTER_LONG 180
> 
> Next step was to use gdalbuildvrt to build a .vrt file in preparation
> for tiling with gdal2tiles.py.
> When trying that this message displays:
> Warning 6: gdalbuildvrt does not support heterogenous projection.
> Skipping ...
> And the skipped file is not included in the .vrt file.
> 
> I tried using the --config CENTER_LONG 180 with gdalbuildvrt which gives
> the same result.
> 
> Then I tried:
> gdalbuildvrt --config CENTER_LONG 180 -allow_projection_difference ...
> 
> This does NOT give the previous message, but after running gdal2tiles.py
> on the .vrt the tiles that should have been generated from the .tif file
> in question appear to be missing...
> Any thing specific I should do to make this work?

The message means that you have files in different projections, like different 
UTM zones, or a mix of files in long/lat geodetic projection and a projected 
coordinate system. You will have first to find a common projected system before 
mosaicing themp with gdalbuildvrt. This can be done with gdalwarp (potentially 
with -of VRT to generate a "warped VRT").

> 
> Something else I noticed is that it seems to be important in what order
> .tif files are submitted to gdalbuildvrt. Many if not all the .tif(s)
> used have an Alpha Channel for transparency because they are 'cut' from
> a .tif. What I see happening is that the transparent part of a /later/
> .tif wipes the non-transparent parts of /earlier/ .tif(s) it overlaps.
> Is there an easy solution for this?

gdalbuildvrt / the VRT format doesn't handle alpha compositing. The source 
files listed after previous ones will override all the channels, including the 
alpha channel.
That would indeed be an interesting improvement to the VRT driver to do proper 
alpha compositing.
The solution for the time being is to use gdalwarp (but of course the result 
will be a "plain" raster, not a virtual one)

> 
> GDAL 1.11.2, released 2015/02/10
> 
> Any help/assistance would be appreciated!
> 
> Thanks!
> Jan

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From issworld2000 at yahoo.com  Tue Jan  5 07:58:53 2016
From: issworld2000 at yahoo.com (Djordje Spasic)
Date: Tue, 5 Jan 2016 15:58:53 +0000 (UTC)
Subject: [gdal-dev] compiling C# bindings into a single library?
References: <673936184.395683.1452009533494.JavaMail.yahoo.ref@mail.yahoo.com>
Message-ID: <673936184.395683.1452009533494.JavaMail.yahoo@mail.yahoo.com>

Hello everyone,

I am successfully calling C# gdal bindings (downloaded from gisinternals) from ironpython 2.7.
However there's a huge number of them necessary: some 70 .dll and .exe files.

Is there some way of compiling all of them into a single .dll file, instead of using 70 of them?

Would that be result in some license breach?

I apologize if this is not possible to be achieved, I am not a programmer.

Thank you for the reply,Happy Holidays.

Kind regards,
Djordje Spasic
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160105/8d3bb991/attachment.html>

From lacy at wisc.edu  Tue Jan  5 09:51:03 2016
From: lacy at wisc.edu (Jim Lacy)
Date: Tue, 05 Jan 2016 17:51:03 +0000
Subject: [gdal-dev] GDAL 1.11 vs 2.1 and JPEG2000?
Message-ID: <BLUPR0601MB16676E51A6752395CA10C209B9F30@BLUPR0601MB1667.namprd06.prod.outlook.com>

Can anyone with knowledge of the JP2OpenJPEG driver confirm or deny the following observation?

I've been generating jpeg2000's in both GDAL 1.11.2 and GDAL 2.1.  With all settings the same, I've noticed the visual quality of the images generated in GDAL 2.1 are noticeably "better." (a subjective term, yes)

To my eyes, in 1.11.2,  -co "QUALITY=20" yields results visually comparable to roughly -co "QUALITY=12" in GDAL 2.1.  Win32 platform, binaries from gisinternals.com.

Are there significant improvements in the 2.1 driver that would explain my observation?

----------------------------------------------
Jim Lacy
Wisconsin State Cartographer's Office
University of Wisconsin-Madison
(608) 262-6850
www.sco.wisc.edu<http://www.sco.wisc.edu/>
My calendar:  http://go.wisc.edu/xziys4

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160105/a3061c55/attachment-0001.html>

From petr.pridal at klokantech.com  Tue Jan  5 10:33:32 2016
From: petr.pridal at klokantech.com (Petr Pridal)
Date: Tue, 5 Jan 2016 19:33:32 +0100
Subject: [gdal-dev] Vector Tiles in OGR
Message-ID: <CAH-RUCSWA55kmEW6=tH0=xb7qUFm9R4oJ6iBSxdeSrnetyRM0g@mail.gmail.com>

Hi,

Is anybody working on an OGR driver for mapbox-like vector tiles (PBF
blobs) stored in MBTiles or downloaded from a url via curl?

If this is done, all the GDAL-powered tools could access the vector
features available in vector tiles directly - it means vector data in QGIS
and Grass for any region in world without any extra effort. This would be
damn cool!

It seems to be doable with an open-source code like:
https://github.com/mapbox/mapnik-vector-tile/blob/master/examples/c%2B%2B/tileinfo.cpp

Recently we have rendered the whole world from OpenStreetMap planet into
vector tiles - and made these tiles downloadable for free (the whole world
or country and city extracts).

Downloads are hosted on Swiss academical network and the project is
cooperation between Klokan Technologies GmbH and students from HSR
university in Switzerland.

Everything is done with open-source software, properly documented and
forkable on github.

See: http://osm2vectortiles.org/ and
https://github.com/osm2vectortiles/osm2vectortiles

It practically means you can make your own OSM server running on your own
hardware - usable even offline on your laptop or without firewalls within a
few minutes.

No PostGIS needed and no processing of planet dump on a computer with 20GB+
RAM.
Any standard low-end computer or virtual machine can be used...

This including having your own raster tile server - where raster tiles are
rendered on demand from vector tiles by Mapnik (we used tessera tilelive
based server and docker - so the whole server can be up in a linux
container with one command, if you don't want to install the software
natively).

If you have WebGL in your browser then raw vector tiles are directly at:
http://osm2vectortiles.tileserver.com/ with a style applied for example at:
http://osm2vectortiles.org/maps/

Setup is quite easy: download vector tiles packed in MBTiles format
(extracts has a few megabytes, countries gigabytes, whole world is about 60
GB) and use it.
Typical use would be a start of a basic raster tileserver or serving the
vector tiles directly from any hosting (even a cheap PHP hosting can do
this).

Everything is documented at: http://osm2vectortiles.org/docs/ and for free.
Patches and pull requests on the vector tiles rendering process and schema
are welcome ;-)

If there would be OGR driver for vector tiles it would make a similar
resource extremely useful also for other purposes in GIS tools - not only
for tileservers and direct visualisation.

Any feedback or ideas are really welcome...

Petr
-- 
Petr Pridal, Ph.D.
CEO

Klokan Technologies GmbH
Hofnerstrasse 98, 6314 Unterageri, Switzerland
Tel: +41 (0)41 511 26 12
Email: info at klokantech.com
Web: http://www.klokantech.com/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160105/392a41bb/attachment.html>

From petr.pridal at klokantech.com  Tue Jan  5 10:37:44 2016
From: petr.pridal at klokantech.com (Petr Pridal)
Date: Tue, 5 Jan 2016 19:37:44 +0100
Subject: [gdal-dev] gdalbuildvrt & gdal2tiles.py with GeoTIFF across
	anti-meridian...
In-Reply-To: <568BDF28.9050609@knepper.net>
References: <568BDF28.9050609@knepper.net>
Message-ID: <CAH-RUCTcYK5sZokvnp3HppDUB9Duq6tBR0Mw7Y+6c7Wqy23Bbg@mail.gmail.com>

Hi Jan,

It is worth mentioning that if you render map tiles (mercator or different)
for large area from multiple input files and you are hitting issues like:

- heterogenous projections (differing srs in input files)
- alpha compositing of input files
- dateline crossing  (anti-meridian) issues
- speed issues (parallelisation on multiple CPUs)
- size of the produced PNG tiles
- tiles output in XYZ / TMS and in non-mercator grids with WMTS
compatibility
- direct MBTiles / SQLite output

you can try the MapTiler Pro command-line interface, as it solves all
mentioned problems directly. Just pass your input files directly on the
command line - without creating any VRTs in advance. MapTiler is software
powered by GDAL and used in production by many.
You can get the software as .rpm and .deb for various linux distros, use it
via Docker container as well as with native installers for Mac OS X and
Windows on your laptop - just fill the form: http://www.maptiler.com/demo/.

Disclaimer: I am the original author of GDAL2Tiles and member of the
KlokanTech.com team, who works on the MapTiler software, which is a
commercial product.

We work on the software for years now, and thanks to our customers we are
also able to support open-source GDAL as well (for example with the
significantly improved GeoPDF rendering driver powered by PDFium which is
going to be part of GDAL 2.1 - thanks to Evan's review).

In case you have extremely large dataset to render, you can also join
testers of the cluster variant of MapTiler, which is able to split the tile
rendering to tasks executed on multiple computers.
This is now being developed as part of research project done in cooperation
with Google Inc. as a partner. Google Cloud platform as well as Amazon EC2
or internal clusters or private clouds are going to be supported.

Best regards,

Petr


On Tue, Jan 5, 2016 at 4:20 PM, Jan Knepper <jan at knepper.net> wrote:

> All,
>
> Running across (an) other issue(s)...
>
> I was able to gdalwarp a .tif overlapping the anti-meridian with --config
> CENTER_LONG 180
>
> Next step was to use gdalbuildvrt to build a .vrt file in preparation for
> tiling with gdal2tiles.py.
> When trying that this message displays:
> Warning 6: gdalbuildvrt does not support heterogenous projection. Skipping
> ...
> And the skipped file is not included in the .vrt file.
>
> I tried using the --config CENTER_LONG 180 with gdalbuildvrt which gives
> the same result.
>
> Then I tried:
> gdalbuildvrt --config CENTER_LONG 180 -allow_projection_difference ...
>
> This does NOT give the previous message, but after running gdal2tiles.py
> on the .vrt the tiles that should have been generated from the .tif file in
> question appear to be missing...
> Any thing specific I should do to make this work?
>
> Something else I noticed is that it seems to be important in what order
> .tif files are submitted to gdalbuildvrt. Many if not all the .tif(s) used
> have an Alpha Channel for transparency because they are 'cut' from a .tif.
> What I see happening is that the transparent part of a *later* .tif wipes
> the non-transparent parts of *earlier* .tif(s) it overlaps. Is there an
> easy solution for this?
>
> GDAL 1.11.2, released 2015/02/10
>
> Any help/assistance would be appreciated!
>
> Thanks!
> Jan
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
Petr Pridal, Ph.D.
CEO

Klokan Technologies GmbH
Hofnerstrasse 98, 6314 Unterageri, Switzerland
Tel: +41 (0)41 511 26 12
Email: info at klokantech.com
Web: http://www.klokantech.com/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160105/131a4a2e/attachment.html>

From gane.prog at gmail.com  Tue Jan  5 11:17:34 2016
From: gane.prog at gmail.com (Gane R)
Date: Wed, 6 Jan 2016 00:47:34 +0530
Subject: [gdal-dev] Is there Any limitation in name of the file name in
 CreateDataSource in Filegeodb
Message-ID: <CALMrLdDd_nPdWiOZsFHeo_vCozXtudBOqGboaRAQ1qBuvBCk=A@mail.gmail.com>

It is weired, when I call CreateDataSource as I had discussed earlier, I
send a large filename with absoluted path to it. I causes a crash at when
called from java via jni


Is there any limitation in the name of the filename when passing to
CreateDataSource call.

poDrv->CreateDataSource <= example
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160106/df55d2ea/attachment.html>

From flippmoke at gmail.com  Tue Jan  5 12:06:55 2016
From: flippmoke at gmail.com (Blake Thompson)
Date: Tue, 5 Jan 2016 14:06:55 -0600
Subject: [gdal-dev] Vector Tiles in OGR
In-Reply-To: <CAH-RUCSWA55kmEW6=tH0=xb7qUFm9R4oJ6iBSxdeSrnetyRM0g@mail.gmail.com>
References: <CAH-RUCSWA55kmEW6=tH0=xb7qUFm9R4oJ6iBSxdeSrnetyRM0g@mail.gmail.com>
Message-ID: <CAPxHBh_-i1i8_85J517SWUo8N1GB9557Om4CvRwi4iMxTXswOQ@mail.gmail.com>

Petr,

No one that I know of is currently working on such a tool. It could be a
little difficult to write as well.

Each Tile is its own discrete dataset therefore the hardest part would be
merging of features into the original features across tiles. You could use
some complicated merging technique, but that could be very expensive.

If you wanted to simply view vector tile data it could get confusing as
well since most vector tiles need a buffer when they are used for
visualization programs. This is important for things like labeling on maps
etc. Therefore, you could get a large amount of overlapping data on tiles
if you loaded them all in at once.

I do not say this to discourage someone, but its a non-trivial problem.

As far as writing a simple decoder -- the mapnik-vector-tile decoder isn't
currently able to decode vector tiles into a form not supported by mapnik.
Therefore, OGR would not be able to easily use this. Additionally Mapnik
has a GDAL and OGR plugin, which creates an awesome circular dependency. We
plan to write a generalized encoder and decoder eventually so that any
other library can plugin with out the mapnik requirement. However, we have
yet carved out time to do this properly.

If you have any questions specifically about Mapnik Vector Tile or the
Mapbox Vector Tile Specification feel free to ask me. I would note that you
guys will want to update your vector tiles once the V2 specification
changes are into Mapnik-Vector-Tile.

Thanks,

Blake Thompson
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160105/110524f7/attachment.html>

From even.rouault at spatialys.com  Tue Jan  5 12:21:28 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 5 Jan 2016 21:21:28 +0100
Subject: [gdal-dev] Vector Tiles in OGR
In-Reply-To: <CAH-RUCSWA55kmEW6=tH0=xb7qUFm9R4oJ6iBSxdeSrnetyRM0g@mail.gmail.com>
References: <CAH-RUCSWA55kmEW6=tH0=xb7qUFm9R4oJ6iBSxdeSrnetyRM0g@mail.gmail.com>
Message-ID: <201601052121.29312.even.rouault@spatialys.com>

Le mardi 05 janvier 2016 19:33:32, Petr Pridal a écrit :
> Hi,
> 
> Is anybody working on an OGR driver for mapbox-like vector tiles (PBF
> blobs) stored in MBTiles or downloaded from a url via curl?

Hi Petr,

I was involved in discussions a few months ago where Mapbox Vector Tiles 
read/write support would have been part of a larger project, but I'm not sure 
if/when this will come true.

I see you mention MVT in MBTiles. Is it a recognized practice ? I don't see  
mention of that neither in the MVT spec ( https://github.com/mapbox/vector-
tile-spec/tree/master/2.0 ) nor the MBTiles one ( 
https://github.com/mapbox/mbtiles-spec/blob/master/1.2/spec.md ), although I 
guess it is just a matter of storing a MVT blob in the tile_data column.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From flippmoke at gmail.com  Tue Jan  5 13:12:50 2016
From: flippmoke at gmail.com (Blake Thompson)
Date: Tue, 5 Jan 2016 15:12:50 -0600
Subject: [gdal-dev] Vector Tiles in OGR
In-Reply-To: <201601052121.29312.even.rouault@spatialys.com>
References: <CAH-RUCSWA55kmEW6=tH0=xb7qUFm9R4oJ6iBSxdeSrnetyRM0g@mail.gmail.com>
 <201601052121.29312.even.rouault@spatialys.com>
Message-ID: <CAPxHBh_aJKNDyzs6NNvxKDew9uzYBdFspb99c_rL7RbTLC=Qng@mail.gmail.com>

Even,

He is correct that MBTiles can store vector tiles. I know this is done in
https://github.com/mapbox/tippecanoe . I believe there is talk about
updating the MBTiles Spec as well.

Thanks,

Blake Thompson

On Tue, Jan 5, 2016 at 2:21 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le mardi 05 janvier 2016 19:33:32, Petr Pridal a écrit :
> > Hi,
> >
> > Is anybody working on an OGR driver for mapbox-like vector tiles (PBF
> > blobs) stored in MBTiles or downloaded from a url via curl?
>
> Hi Petr,
>
> I was involved in discussions a few months ago where Mapbox Vector Tiles
> read/write support would have been part of a larger project, but I'm not
> sure
> if/when this will come true.
>
> I see you mention MVT in MBTiles. Is it a recognized practice ? I don't see
> mention of that neither in the MVT spec (
> https://github.com/mapbox/vector-
> tile-spec/tree/master/2.0 ) nor the MBTiles one (
> https://github.com/mapbox/mbtiles-spec/blob/master/1.2/spec.md ),
> although I
> guess it is just a matter of storing a MVT blob in the tile_data column.
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160105/4fd258db/attachment.html>

From Benjamin.Stadin at heidelberg-mobil.com  Tue Jan  5 17:35:31 2016
From: Benjamin.Stadin at heidelberg-mobil.com (Stadin, Benjamin)
Date: Wed, 6 Jan 2016 01:35:31 +0000
Subject: [gdal-dev] Vector Tiles in OGR
In-Reply-To: <CAPxHBh_aJKNDyzs6NNvxKDew9uzYBdFspb99c_rL7RbTLC=Qng@mail.gmail.com>
References: <CAH-RUCSWA55kmEW6=tH0=xb7qUFm9R4oJ6iBSxdeSrnetyRM0g@mail.gmail.com>
 <201601052121.29312.even.rouault@spatialys.com>
 <CAPxHBh_aJKNDyzs6NNvxKDew9uzYBdFspb99c_rL7RbTLC=Qng@mail.gmail.com>
Message-ID: <D2B21F4F.309BE%benjamin.stadin@heidelberg-mobil.com>

I’ve commented on the MBTiles discussion [1] and suggested to make a change towards GeoPackage. There are in my opinion some reasons why it should rather be avoided to implement something towards MapBox’ current Tile spec or MBTiles, or any of the current vector tile formats in general:

  *   Interoperability. Besides the need to define a custom extension for MapBox Vector tiles within a GPKG container (because vector tiles are not part of the spec) a standard based format with proper data field definitions would increase operability a lot.
  *   Conceptually. In my opinion, it should be avoided to mix rendering optimized data and geometry data. These should be separate concerns, but my understanding is that all vector tiles are currently optimized for rendering only, and not concepted as general purpose containers to convert to and from without anything breaking in practice. They are bound to a particular projection (in MapBox’ case always Web Mercator) and geometries cannot be exactly reconstructed after they’ve been tile-cut at the projection specific tile bounds.
  *   Tiling. When going for vector „tiles“ there should be no more need to stick to a certain projection. It should be possible to use unprojected data, and do the projection either in realtime or as part of a post processing step. In any case, the limitation to use just one projection (Web Mercator) may not be acceptable for general purpose application. As Blake said, merging features is a non-trivial problem. But once this is solved (maybe as part of a new vector tile spec), there is from a technical perspective no more need to produce tiles for rendering other than for performance reasons. Vector data can be pushed into a scene graph that contains all currently visible geometries. Tile data would still be sliced loosely in accordance to tile sizes and zoom levels, but not strictly so, and without need to produce projected data. I’m thinking of using an adaptation of the MODIS Grid [2] as tile storage (to store WGS84 datum, and reconstruct „partially complete“ geometries reproject and reproject to Web Mercator or UTM at runtime).

I think it would be of great benefit if common containers like GPKG would be adopted by more vendors. So that in the end more tools could operate on a data set first, and this data set could then be brought into an optimized form for specific rendering needs (which could also be an extension to GPKG as mentioned).

Cheers
Ben

[1] https://github.com/mapbox/mapbox-gl-native/issues/3373
[2] http://modis-land.gsfc.nasa.gov/MODLAND_grid.html


Von: gdal-dev <gdal-dev-bounces at lists.osgeo.org<mailto:gdal-dev-bounces at lists.osgeo.org>> on behalf of Blake Thompson <flippmoke at gmail.com<mailto:flippmoke at gmail.com>>
Datum: Dienstag, 5. Januar 2016 um 22:12
An: Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>>, "fischer at mapbox.com<mailto:fischer at mapbox.com>" <fischer at mapbox.com<mailto:fischer at mapbox.com>>
Cc: "gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>" <gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>>
Betreff: Re: [gdal-dev] Vector Tiles in OGR

Even,

He is correct that MBTiles can store vector tiles. I know this is done in https://github.com/mapbox/tippecanoe . I believe there is talk about updating the MBTiles Spec as well.

Thanks,

Blake Thompson

On Tue, Jan 5, 2016 at 2:21 PM, Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>> wrote:
Le mardi 05 janvier 2016 19:33:32, Petr Pridal a écrit :
> Hi,
>
> Is anybody working on an OGR driver for mapbox-like vector tiles (PBF
> blobs) stored in MBTiles or downloaded from a url via curl?

Hi Petr,

I was involved in discussions a few months ago where Mapbox Vector Tiles
read/write support would have been part of a larger project, but I'm not sure
if/when this will come true.

I see you mention MVT in MBTiles. Is it a recognized practice ? I don't see
mention of that neither in the MVT spec ( https://github.com/mapbox/vector-
tile-spec/tree/master/2.0 ) nor the MBTiles one (
https://github.com/mapbox/mbtiles-spec/blob/master/1.2/spec.md ), although I
guess it is just a matter of storing a MVT blob in the tile_data column.

Even

--
Spatialys - Geospatial professional services
http://www.spatialys.com
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160106/1549bb30/attachment-0001.html>

From even.rouault at spatialys.com  Wed Jan  6 01:21:32 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 6 Jan 2016 10:21:32 +0100
Subject: [gdal-dev] Vector Tiles in OGR
In-Reply-To: <201601052121.29312.even.rouault@spatialys.com>
References: <CAH-RUCSWA55kmEW6=tH0=xb7qUFm9R4oJ6iBSxdeSrnetyRM0g@mail.gmail.com>
 <201601052121.29312.even.rouault@spatialys.com>
Message-ID: <201601061021.32357.even.rouault@spatialys.com>


> I was involved in discussions a few months ago where Mapbox Vector Tiles
> read/write support would have been part of a larger project, but I'm not
> sure if/when this will come true.

Update: just learned that this project has been won by another bidding group, 
so I'm not sure if the winner has planned a OGR MVT development.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Jan  6 01:57:18 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 6 Jan 2016 10:57:18 +0100
Subject: [gdal-dev] Is there Any limitation in name of the file name in
	CreateDataSource in Filegeodb
In-Reply-To: <CALMrLdDd_nPdWiOZsFHeo_vCozXtudBOqGboaRAQ1qBuvBCk=A@mail.gmail.com>
References: <CALMrLdDd_nPdWiOZsFHeo_vCozXtudBOqGboaRAQ1qBuvBCk=A@mail.gmail.com>
Message-ID: <201601061057.19030.even.rouault@spatialys.com>

Le mardi 05 janvier 2016 20:17:34, Gane R a écrit :
> It is weired, when I call CreateDataSource as I had discussed earlier, I
> send a large filename with absoluted path to it. I causes a crash at when
> called from java via jni
> 
> 
> Is there any limitation in the name of the filename when passing to
> CreateDataSource call.
> 
> poDrv->CreateDataSource <= example

You could try with ogr2ogr first.


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Jan  6 02:25:23 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 6 Jan 2016 11:25:23 +0100
Subject: [gdal-dev] GDAL 1.11 vs 2.1 and JPEG2000?
In-Reply-To: <BLUPR0601MB16676E51A6752395CA10C209B9F30@BLUPR0601MB1667.namprd06.prod.outlook.com>
References: <BLUPR0601MB16676E51A6752395CA10C209B9F30@BLUPR0601MB1667.namprd06.prod.outlook.com>
Message-ID: <201601061125.23328.even.rouault@spatialys.com>

Le mardi 05 janvier 2016 18:51:03, Jim Lacy a écrit :
> Can anyone with knowledge of the JP2OpenJPEG driver confirm or deny the
> following observation?
> 
> I've been generating jpeg2000's in both GDAL 1.11.2 and GDAL 2.1.  With all
> settings the same, I've noticed the visual quality of the images generated
> in GDAL 2.1 are noticeably "better." (a subjective term, yes)
> 
> To my eyes, in 1.11.2,  -co "QUALITY=20" yields results visually comparable
> to roughly -co "QUALITY=12" in GDAL 2.1.  Win32 platform, binaries from
> gisinternals.com.
> 
> Are there significant improvements in the 2.1 driver that would explain my
> observation?

Jim,

Checking the NEWS, I believe this might be related to this improvement I did 
in GDAL 2.0

 * add YCC creation option to do RGB->YCC MCT, and turn it ON by default 
(#5634)

And a quick test confirms it with a BMNG 21600x21600 3 bands :

$ gdal_tanslate in.tif out1.jp2 -of jp2openjpeg
$ gdal_tanslate in.tif out2.jp2 -of jp2openjpeg -co YCC=OFF
$ ll out1.jp2 out2.jp2
-rw-r--r-- 1 even even 111977681 2016-01-06 11:07 out1.jp2
-rw-r--r-- 1 even even 151981743 2016-01-06 11:08 out2.jp2

RGB->YCC MCT conversion is a step that occurs before other processings, which 
tends to decrease the size of the resulting file, all other things equal. This 
transform is not completely lossless when using the default lossy compression 
(there's a lossless version that is used when using -co QUALITY=100 -co 
REVERSIBLE=YES), but the differences in pixel values tend to be very small 
between YCC=ON/OFF.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gane.prog at gmail.com  Wed Jan  6 02:32:25 2016
From: gane.prog at gmail.com (Gane R)
Date: Wed, 6 Jan 2016 16:02:25 +0530
Subject: [gdal-dev] PDF when converted to GeoTIFF maps to location offset
Message-ID: <CALMrLdBVfMoEE-qca2kSfL83DtiQo1+sRmvGqfP120OV_eRPkg@mail.gmail.com>

Here is a link to the file

https://drive.google.com/file/d/0B4shTM1bPS5TMDhNMUpkUC04RlE/view?usp=sharing

This the gdalinfo of the TIF file

Size is 5210, 3498
Coordinate System is:
PROJCS["WGS 84 / Pseudo-Mercator",
    GEOGCS["WGS 84",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.257223563,
                AUTHORITY["EPSG","7030"]],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4326"]],
    PROJECTION["Mercator_1SP"],
    PARAMETER["central_meridian",0],
    PARAMETER["scale_factor",1],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    EXTENSION["PROJ4","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0
+lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext
+no_defs"],
    AUTHORITY["EPSG","3857"]]
Origin = (-9640275.525640748400000,3125396.832506576100000)
Pixel Size = (0.113838781929125,-0.113838781929125)
Metadata:
  AREA_OR_POINT=Area
  CREATION_DATE=D:20151203110313-05'00'
  CREATOR=Esri ArcMap 10.3.0.4322
  NEATLINE=POLYGON ((199823.31714503843
305110.51562091778,199397.58689357759 305110.51562091778,199397.58689357759
305420.42164072924,199823.31714503843 305420.42164072924,199823.31714503843
305110.51562091778))
  PRODUCER=TerraGo Technologies Publisher for ArcGIS GeoPDF Export version:
6.7.3.71
Image Structure Metadata:
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (-9640275.526, 3125396.833) ( 86d36' 0.25"W, 27d 0'55.47"N)
Lower Left  (-9640275.526, 3124998.624) ( 86d36' 0.25"W, 27d 0'43.99"N)
Upper Right (-9639682.426, 3125396.833) ( 86d35'41.07"W, 27d 0'55.47"N)
Lower Right (-9639682.426, 3124998.624) ( 86d35'41.07"W, 27d 0'43.99"N)
Center      (-9639978.976, 3125197.728) ( 86d35'50.66"W, 27d 0'49.73"N)
Band 1 Block=5210x1 Type=Byte, ColorInterp=Red
Band 2 Block=5210x1 Type=Byte, ColorInterp=Green
Band 3 Block=5210x1 Type=Byte, ColorInterp=Blue

Thanks
Gane
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160106/cced56b5/attachment.html>

From even.rouault at spatialys.com  Wed Jan  6 03:29:19 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 6 Jan 2016 12:29:19 +0100
Subject: [gdal-dev] PDF when converted to GeoTIFF maps to location offset
In-Reply-To: <CALMrLdBVfMoEE-qca2kSfL83DtiQo1+sRmvGqfP120OV_eRPkg@mail.gmail.com>
References: <CALMrLdBVfMoEE-qca2kSfL83DtiQo1+sRmvGqfP120OV_eRPkg@mail.gmail.com>
Message-ID: <201601061229.19669.even.rouault@spatialys.com>

Le mercredi 06 janvier 2016 11:32:25, Gane R a écrit :
> Here is a link to the file
> 
> https://drive.google.com/file/d/0B4shTM1bPS5TMDhNMUpkUC04RlE/view?usp=shari
> ng

Fixed by https://trac.osgeo.org/gdal/ticket/6292

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Jan  6 05:37:34 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 6 Jan 2016 14:37:34 +0100
Subject: [gdal-dev] Vector Tiles in OGR
In-Reply-To: <CAPxHBh_-i1i8_85J517SWUo8N1GB9557Om4CvRwi4iMxTXswOQ@mail.gmail.com>
References: <CAH-RUCSWA55kmEW6=tH0=xb7qUFm9R4oJ6iBSxdeSrnetyRM0g@mail.gmail.com>
 <CAPxHBh_-i1i8_85J517SWUo8N1GB9557Om4CvRwi4iMxTXswOQ@mail.gmail.com>
Message-ID: <201601061437.34790.even.rouault@spatialys.com>

Le mardi 05 janvier 2016 21:06:55, Blake Thompson a écrit :
> Petr,
> 
> No one that I know of is currently working on such a tool. It could be a
> little difficult to write as well.
> 
> Each Tile is its own discrete dataset therefore the hardest part would be
> merging of features into the original features across tiles. You could use
> some complicated merging technique, but that could be very expensive.
> 
> If you wanted to simply view vector tile data it could get confusing as
> well since most vector tiles need a buffer when they are used for
> visualization programs. 

Do you mean that the coordinates aren't all necessarily clipped to the 
[0,extent-1] range ? If so, yes indeed the merging of consecutive tiles can be 
"interesting".

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From petr.pridal at klokantech.com  Wed Jan  6 06:24:41 2016
From: petr.pridal at klokantech.com (Petr Pridal)
Date: Wed, 6 Jan 2016 15:24:41 +0100
Subject: [gdal-dev] Vector Tiles in OGR
In-Reply-To: <CAPxHBh_-i1i8_85J517SWUo8N1GB9557Om4CvRwi4iMxTXswOQ@mail.gmail.com>
References: <CAH-RUCSWA55kmEW6=tH0=xb7qUFm9R4oJ6iBSxdeSrnetyRM0g@mail.gmail.com>
 <CAPxHBh_-i1i8_85J517SWUo8N1GB9557Om4CvRwi4iMxTXswOQ@mail.gmail.com>
Message-ID: <CAH-RUCQwki_Di08JCy2C8E8RkR3X3AdLjRQXo-312EWOVobL3g@mail.gmail.com>

Hi everybody,

thanks for the comments. Regarding the technical details:

Each Tile is its own discrete dataset therefore the hardest part would be
> merging of features into the original features across tiles. You could use
> some complicated merging technique, but that could be very expensive.
>

The driver could require "id" parameter, which specifies name of an
attribute with unique identifier on the features shared across the tiles.
Both MapBox vector tiles and OSM2VectorTiles tiles have an unique non-zero
"osm_id" in place. The first version of driver could read only features
with such ID. The identifier does not have to be always filled, but often
it is, especially in deeper zoom levels derived purely from OpenStreetMap -
but yeh, a completely general stitching would be much harder.

The clipping + merging of shapes itself can be implemented with underlaying
GEOS library functions.

BTW It is possible to examine vector tiles data in pure JavaScript X-Ray
viewer (no WebGL support on browser required) made in OpenLayers3:
http://klokantech.github.io/ol3-sandbox/vector/xray.html

or with WebGL-enabled webbrowser with higher performance MapBox GL JS
powered X-Ray:
http://klokantech.github.io/mapbox-gl-js-offline-example/xray.html

A debug viewer for each vector tile (made in OL3) decoded in pure
JavaScript:
http://klokantech.github.io/ol3-sandbox/vector/tile-inspector.html

The OGR driver could be also practical for the unsimplified / ungeneralised
MBTiles with OSM data available at: http://osmlab.github.io/osm-qa-tiles/


> If you wanted to simply view vector tile data it could get confusing as
> well since most vector tiles need a buffer when they are used for
> visualization programs. This is important for things like labeling on maps
> etc. Therefore, you could get a large amount of overlapping data on tiles
> if you loaded them all in at once.
>

Clipping on border of each tile must be applied before stitching the vector
features together  - so the buffer is removed. Buffer is there only for
visualisation and labeling.


> As far as writing a simple decoder -- the mapnik-vector-tile decoder isn't
> currently able to decode vector tiles into a form not supported by mapnik.
> Therefore, OGR would not be able to easily use this.
>

Correct. It can't be used directly (GDAL can't link against), but the
relevant code can be extracted and reused directly. For basic decoding
critical is the Protobuf library (which is already in GDAL) and
https://github.com/mapbox/mapnik-vector-tile/blob/master/proto/vector_tile.proto
+ the code for converting pixel coordinates in features to relevant geo
coordinates and GEOS-based merging of features.

We plan to write a generalized encoder and decoder eventually so that any
> other library can plugin with out the mapnik requirement.
>

This would be amazing.

If you have any questions specifically about Mapnik Vector Tile or the
> Mapbox Vector Tile Specification feel free to ask me. I would note that you
> guys will want to update your vector tiles once the V2 specification
> changes are into Mapnik-Vector-Tile.
>

Cool! Thanks. Our world tiles are generated via Docker containers on a
cluster of computers - using Mapnik via Tilelive directly - so upgrades on
Mapnik-Vector-Tile will propagate to the open-source rendering software.
I expect V2 spec will mean also new MapBox Streets V7, right?

I see you mention MVT in MBTiles. Is it a recognized practice ? I don't see
> mention of that neither in the MVT spec (
> https://github.com/mapbox/vector-
> tile-spec/tree/master/2.0 ) nor the MBTiles one (
> https://github.com/mapbox/mbtiles-spec/blob/master/1.2/spec.md ),
> although I
> guess it is just a matter of storing a MVT blob in the tile_data column.
>

Yes. MapBox Studio Classic generates such MBTiles with Vector Tiles inside
- and Mapnik reads them directly when rasterising. Storing the vector tiles
in SQLite make sense - and it simplifies deployment, and you can then
easily have complete world on each node of a cluster of tileservers. If you
don't want to upgrade your base map too often, this approach is pretty
efficient and removes the centralised database as typical bottleneck.

I did some tests on vector tiles vs raster in MBTiles and documented these
in README.md at and https://github.com/klokantech/vector-tiles-sample
before we started to work on OSM2VectorTiles project.
There are also sample data and offline MapBox GL JS viewer in that repo.
Vector tiles can be hosted also "unpacked", just as files in folders on a
standard web server - exactly like GDAL2Tiles or MapTiler.com does by
default for raster tiles.

If OGR driver is implemented, the primary source should be probably reading
from an URL via curl.

Reading PBFs from an MBTiles (or another SQLite) is just the most practical
portable alternative to it.

Technically people may store the tiles in different ways - for example
Wikimedia guys (http://maps.wikimedia.org/ and
https://github.com/kartotherian/) use Cassandra for tile storage, I guess
MapBox internally is also on a different storage for production servers ...
for transfers and streaming tilesets there is the  - but tiles are ALWAYS
exposed via HTTP.

Regards,

Petr
-- 
Petr Pridal, Ph.D.
CEO

Klokan Technologies GmbH
Hofnerstrasse 98, 6314 Unterageri, Switzerland
Tel: +41 (0)41 511 26 12
Email: info at klokantech.com
Web: http://www.klokantech.com/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160106/4d27573d/attachment-0001.html>

From lacy at wisc.edu  Wed Jan  6 11:32:04 2016
From: lacy at wisc.edu (Jim Lacy)
Date: Wed, 06 Jan 2016 19:32:04 +0000
Subject: [gdal-dev] GDAL 1.11 vs 2.1 and JPEG2000?
In-Reply-To: <201601061125.23328.even.rouault@spatialys.com>
References: <BLUPR0601MB16676E51A6752395CA10C209B9F30@BLUPR0601MB1667.namprd06.prod.outlook.com>
 <201601061125.23328.even.rouault@spatialys.com>
Message-ID: <BLUPR0601MB166741786EAB104B9B18C54DB9F40@BLUPR0601MB1667.namprd06.prod.outlook.com>

Thanks Even.  I was actually more curious about the quality differences of jpeg2000, GDAL 1.11 vs 2.1.  File size is important too, of course.

I did some further tests.  For example, in GDAL 1.11.2:
gdal_translate -of JP2OpenJPEG -b 1 -b 2 -b 3 -co "QUALITY=12" Kenosha.tif Kenosha_gdal1_11.jp2

compared to GDAL 2.1:
gdal_translate -of JP2OpenJPEG -b 1 -b 2 -b 3 -co "QUALITY=12" -co "YCC=OFF" Kenosha.tif Kenosha_gdal2_1_ycc_off.jp2

.... produces results that are visually identical.  

However, simply by turning YCC=ON (the default) in GDAL 2.1 produces noticeably "better" images at higher zoom levels.  
gdal_translate -of JP2OpenJPEG -b 1 -b 2 -b 3 -co "QUALITY=12" -co "YCC=ON"  Kenosha.tif Kenosha_gdal2_1.jp2

It's interesting to me that the simple addition of YCC=OFF can noticeably affect the visually quality of the output image.  I certainly don't claim to understand the nuances of jpeg2000!

If you have time/interest, my test files are here:
https://uwmadison.box.com/s/xfc2f0ehwe6x6nu7chxu3ykvmk46mw85

Thanks again.


-----Original Message-----
From: Even Rouault [mailto:even.rouault at spatialys.com] 
Sent: Wednesday, January 06, 2016 4:25 AM
To: gdal-dev at lists.osgeo.org
Cc: Jim Lacy
Subject: Re: [gdal-dev] GDAL 1.11 vs 2.1 and JPEG2000?

Le mardi 05 janvier 2016 18:51:03, Jim Lacy a écrit :
> Can anyone with knowledge of the JP2OpenJPEG driver confirm or deny 
> the following observation?
> 
> I've been generating jpeg2000's in both GDAL 1.11.2 and GDAL 2.1.  
> With all settings the same, I've noticed the visual quality of the 
> images generated in GDAL 2.1 are noticeably "better." (a subjective 
> term, yes)
> 
> To my eyes, in 1.11.2,  -co "QUALITY=20" yields results visually 
> comparable to roughly -co "QUALITY=12" in GDAL 2.1.  Win32 platform, 
> binaries from gisinternals.com.
> 
> Are there significant improvements in the 2.1 driver that would 
> explain my observation?

Jim,

Checking the NEWS, I believe this might be related to this improvement I did in GDAL 2.0

 * add YCC creation option to do RGB->YCC MCT, and turn it ON by default
(#5634)

And a quick test confirms it with a BMNG 21600x21600 3 bands :

$ gdal_tanslate in.tif out1.jp2 -of jp2openjpeg $ gdal_tanslate in.tif out2.jp2 -of jp2openjpeg -co YCC=OFF $ ll out1.jp2 out2.jp2
-rw-r--r-- 1 even even 111977681 2016-01-06 11:07 out1.jp2
-rw-r--r-- 1 even even 151981743 2016-01-06 11:08 out2.jp2

RGB->YCC MCT conversion is a step that occurs before other processings, 
RGB->which
tends to decrease the size of the resulting file, all other things equal. This transform is not completely lossless when using the default lossy compression (there's a lossless version that is used when using -co QUALITY=100 -co REVERSIBLE=YES), but the differences in pixel values tend to be very small between YCC=ON/OFF.

Even

--
Spatialys - Geospatial professional services http://www.spatialys.com

From even.rouault at spatialys.com  Wed Jan  6 11:42:45 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 6 Jan 2016 20:42:45 +0100
Subject: [gdal-dev] GDAL 1.11 vs 2.1 and JPEG2000?
In-Reply-To: <BLUPR0601MB166741786EAB104B9B18C54DB9F40@BLUPR0601MB1667.namprd06.prod.outlook.com>
References: <BLUPR0601MB16676E51A6752395CA10C209B9F30@BLUPR0601MB1667.namprd06.prod.outlook.com>
 <201601061125.23328.even.rouault@spatialys.com>
 <BLUPR0601MB166741786EAB104B9B18C54DB9F40@BLUPR0601MB1667.namprd06.prod.outlook.com>
Message-ID: <201601062042.46422.even.rouault@spatialys.com>

Le mercredi 06 janvier 2016 20:32:04, Jim Lacy a écrit :
> Thanks Even.  I was actually more curious about the quality differences of
> jpeg2000, GDAL 1.11 vs 2.1.  File size is important too, of course.

Quality and size are highly correlated. The JPEG2000 encoder honours quite 
strictly the compression ratio you ask for (QUALITY=12 means 1/12 of the 
uncompressed size. It is not an objective measure of the "quality" in the 
traditional meaning). So if naturally YCC=ON leads to better compression rate, 
when you ask for the same compression target, the quality will be better when 
YCC=ON. The naming of the "QUALITY" setting is a bit arguable indeed (I think 
I took inspiration from the same parameter name of the JP2KAK driver)

> 
> I did some further tests.  For example, in GDAL 1.11.2:
> gdal_translate -of JP2OpenJPEG -b 1 -b 2 -b 3 -co "QUALITY=12" Kenosha.tif
> Kenosha_gdal1_11.jp2
> 
> compared to GDAL 2.1:
> gdal_translate -of JP2OpenJPEG -b 1 -b 2 -b 3 -co "QUALITY=12" -co
> "YCC=OFF" Kenosha.tif Kenosha_gdal2_1_ycc_off.jp2
> 
> .... produces results that are visually identical.
> 
> However, simply by turning YCC=ON (the default) in GDAL 2.1 produces
> noticeably "better" images at higher zoom levels. gdal_translate -of
> JP2OpenJPEG -b 1 -b 2 -b 3 -co "QUALITY=12" -co "YCC=ON"  Kenosha.tif
> Kenosha_gdal2_1.jp2
> 
> It's interesting to me that the simple addition of YCC=OFF can noticeably
> affect the visually quality of the output image.  I certainly don't claim
> to understand the nuances of jpeg2000!
> 
> If you have time/interest, my test files are here:
> https://uwmadison.box.com/s/xfc2f0ehwe6x6nu7chxu3ykvmk46mw85
> 
> Thanks again.
> 
> 
> -----Original Message-----
> From: Even Rouault [mailto:even.rouault at spatialys.com]
> Sent: Wednesday, January 06, 2016 4:25 AM
> To: gdal-dev at lists.osgeo.org
> Cc: Jim Lacy
> Subject: Re: [gdal-dev] GDAL 1.11 vs 2.1 and JPEG2000?
> 
> Le mardi 05 janvier 2016 18:51:03, Jim Lacy a écrit :
> > Can anyone with knowledge of the JP2OpenJPEG driver confirm or deny
> > the following observation?
> > 
> > I've been generating jpeg2000's in both GDAL 1.11.2 and GDAL 2.1.
> > With all settings the same, I've noticed the visual quality of the
> > images generated in GDAL 2.1 are noticeably "better." (a subjective
> > term, yes)
> > 
> > To my eyes, in 1.11.2,  -co "QUALITY=20" yields results visually
> > comparable to roughly -co "QUALITY=12" in GDAL 2.1.  Win32 platform,
> > binaries from gisinternals.com.
> > 
> > Are there significant improvements in the 2.1 driver that would
> > explain my observation?
> 
> Jim,
> 
> Checking the NEWS, I believe this might be related to this improvement I
> did in GDAL 2.0
> 
>  * add YCC creation option to do RGB->YCC MCT, and turn it ON by default
> (#5634)
> 
> And a quick test confirms it with a BMNG 21600x21600 3 bands :
> 
> $ gdal_tanslate in.tif out1.jp2 -of jp2openjpeg $ gdal_tanslate in.tif
> out2.jp2 -of jp2openjpeg -co YCC=OFF $ ll out1.jp2 out2.jp2 -rw-r--r-- 1
> even even 111977681 2016-01-06 11:07 out1.jp2
> -rw-r--r-- 1 even even 151981743 2016-01-06 11:08 out2.jp2
> 
> RGB->YCC MCT conversion is a step that occurs before other processings,
> RGB->which
> tends to decrease the size of the resulting file, all other things equal.
> This transform is not completely lossless when using the default lossy
> compression (there's a lossless version that is used when using -co
> QUALITY=100 -co REVERSIBLE=YES), but the differences in pixel values tend
> to be very small between YCC=ON/OFF.
> 
> Even
> 
> --
> Spatialys - Geospatial professional services http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From bradh at frogmouth.net  Wed Jan  6 14:59:05 2016
From: bradh at frogmouth.net (Brad Hards)
Date: Thu, 07 Jan 2016 09:59:05 +1100
Subject: [gdal-dev] Remapping nodata
Message-ID: <2144965.CstunWSQHz@saxicola>

I'm working on the geopackage elevation extension experiment, and trying to
produce some GeoTIFF tiles that get inserted into sqlite. 

I need to remap the existing nodata (nan) to some other value that I can 
insert into a sqlite table as a number (say zero).

I had a long explanation of what I'm doing here, but it is actually explained 
in the docs: "Note that, if the input dataset has a nodata value, this does 
not cause pixel values that are equal to that nodata value to be changed to 
the value specified with this option. "

Is there an easy way to do that conversion?

Brad

From gane.prog at gmail.com  Wed Jan  6 23:49:57 2016
From: gane.prog at gmail.com (Gane R)
Date: Thu, 7 Jan 2016 13:19:57 +0530
Subject: [gdal-dev] PDF when converted to GeoTIFF maps to location offset
In-Reply-To: <201601061229.19669.even.rouault@spatialys.com>
References: <CALMrLdBVfMoEE-qca2kSfL83DtiQo1+sRmvGqfP120OV_eRPkg@mail.gmail.com>
 <201601061229.19669.even.rouault@spatialys.com>
Message-ID: <CALMrLdC8aMNMiUwOZTfh+SKgUSjVKGxdu1NUXURpS18+oZZDgw@mail.gmail.com>

https://drive.google.com/file/d/0B4shTM1bPS5TWkVtWDNhMEZtNE0/view?usp=sharing

Here is a link to another PDF with I experience offset shift.

I have not yet tested with prev fix on truk, Will that fix resolve this
also .. or this is something else causing it.


Here is the gdal info of the TIF file

Driver: GTiff/GeoTIFF
Files: Assembled_OGC5.tif
Size is 6136, 6750
Coordinate System is:
PROJCS["WGS 84 / Pseudo-Mercator",
    GEOGCS["WGS 84",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.257223563,
                AUTHORITY["EPSG","7030"]],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4326"]],
    PROJECTION["Mercator_1SP"],
    PARAMETER["central_meridian",0],
    PARAMETER["scale_factor",1],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    EXTENSION["PROJ4","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0
+lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext
+no_defs"],
    AUTHORITY["EPSG","3857"]]
Origin = (-10159780.774000872000000,3896785.272956570600000)
Pixel Size = (2.429487700587336,-2.429487700587336)
Metadata:
  AREA_OR_POINT=Area
  NEATLINE=POLYGON ((662064.91436366527
3643346.4209082974,665783.20008186984 3653923.2074061511,674458.96238262695
3650873.2296965709,670740.67666442238 3640296.4431987172,662064.91436366527
3643346.4209082974))
Image Structure Metadata:
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (-10159780.774, 3896785.273) ( 91d16' 0.71"W, 33d 0'40.17"N)
Lower Left  (-10159780.774, 3880386.231) ( 91d16' 0.71"W, 32d53'15.14"N)
Upper Right (-10144873.437, 3896785.273) ( 91d 7'58.62"W, 33d 0'40.17"N)
Lower Right (-10144873.437, 3880386.231) ( 91d 7'58.62"W, 32d53'15.14"N)
Center      (-10152327.106, 3888585.752) ( 91d11'59.66"W, 32d56'57.74"N)
Band 1 Block=6136x1 Type=Byte, ColorInterp=Red
Band 2 Block=6136x1 Type=Byte, ColorInterp=Green
Band 3 Block=6136x1 Type=Byte, ColorInterp=Blue

Thanks
Gane

2016-01-06 16:59 GMT+05:30 Even Rouault <even.rouault at spatialys.com>:

> Le mercredi 06 janvier 2016 11:32:25, Gane R a écrit :
> > Here is a link to the file
> >
> >
> https://drive.google.com/file/d/0B4shTM1bPS5TMDhNMUpkUC04RlE/view?usp=shari
> > ng
>
> Fixed by https://trac.osgeo.org/gdal/ticket/6292
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160107/e030936a/attachment.html>

From julien.michel at cnes.fr  Wed Jan  6 23:54:17 2016
From: julien.michel at cnes.fr (Julien Michel)
Date: Thu, 7 Jan 2016 08:54:17 +0100
Subject: [gdal-dev] Remapping nodata
In-Reply-To: <2144965.CstunWSQHz@saxicola>
References: <2144965.CstunWSQHz@saxicola>
Message-ID: <568E19A9.6070302@cnes.fr>

Well, maybe this is a little off topic for the gdal mailing list, but I 
recently had to deal with the same case, and wrote a small application 
in Orfeo ToolBox (>5.2) to do exactly that: map NaN to a real no data 
value [1]. So if you need this really quick, and can afford bringin 
another (quite big) tool in your workflow, here is a workaround.

In the long term, this would be a nice addition to gdal_translate 
capabilities.

Regards,

Julien

[1] https://www.orfeo-toolbox.org/CookBook/CookBooksu61.html#x85-1900004.1.7

Le 06/01/2016 23:59, Brad Hards a écrit :
> I'm working on the geopackage elevation extension experiment, and trying to
> produce some GeoTIFF tiles that get inserted into sqlite.
>
> I need to remap the existing nodata (nan) to some other value that I can
> insert into a sqlite table as a number (say zero).
>
> I had a long explanation of what I'm doing here, but it is actually explained
> in the docs: "Note that, if the input dataset has a nodata value, this does
> not cause pixel values that are equal to that nodata value to be changed to
> the value specified with this option. "
>
> Is there an easy way to do that conversion?
>
> Brad
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Julien MICHEL
CNES - DCT/SI/AP


From even.rouault at spatialys.com  Thu Jan  7 01:42:03 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 7 Jan 2016 10:42:03 +0100
Subject: [gdal-dev] Remapping nodata
In-Reply-To: <568E19A9.6070302@cnes.fr>
References: <2144965.CstunWSQHz@saxicola> <568E19A9.6070302@cnes.fr>
Message-ID: <201601071042.04172.even.rouault@spatialys.com>

Le jeudi 07 janvier 2016 08:54:17, Julien Michel a écrit :
> Well, maybe this is a little off topic for the gdal mailing list, but I
> recently had to deal with the same case, and wrote a small application
> in Orfeo ToolBox (>5.2) to do exactly that: map NaN to a real no data
> value [1]. So if you need this really quick, and can afford bringin
> another (quite big) tool in your workflow, here is a workaround.
> 
> In the long term, this would be a nice addition to gdal_translate
> capabilities.

This can actually be done with gdalwarp.

$ cat in.asc
ncols        2
nrows        2
xllcorner    440720
yllcorner    3751200
cellsize     60
NODATA_value nan
 nan 123.0
 115 132

$ gdalwarp in.asc out.tif  -dstnodata 0 -overwrite

(if using trunk please update to the latest revision as I just discovered and 
fixed a bug for this very particular case (float32 and 0 as target nodata). 2.0 
works fine)

$ gdal_translate out.tif /vsistdout/ -of aaigrid
ncols        2
nrows        2
xllcorner    440720.000000000000
yllcorner    3751200.000000000000
cellsize     60.000000000000
NODATA_value  0
 0.0 123
 115 132

(you likely need a recent enough GDAL version so that NaN is correctly dealt 
with)


> 
> Regards,
> 
> Julien
> 
> [1]
> https://www.orfeo-toolbox.org/CookBook/CookBooksu61.html#x85-1900004.1.7
> 
> Le 06/01/2016 23:59, Brad Hards a écrit :
> > I'm working on the geopackage elevation extension experiment, and trying
> > to produce some GeoTIFF tiles that get inserted into sqlite.
> > 
> > I need to remap the existing nodata (nan) to some other value that I can
> > insert into a sqlite table as a number (say zero).
> > 
> > I had a long explanation of what I'm doing here, but it is actually
> > explained in the docs: "Note that, if the input dataset has a nodata
> > value, this does not cause pixel values that are equal to that nodata
> > value to be changed to the value specified with this option. "
> > 
> > Is there an easy way to do that conversion?
> > 
> > Brad
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Jan  7 01:51:08 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 7 Jan 2016 10:51:08 +0100
Subject: [gdal-dev] PDF when converted to GeoTIFF maps to location offset
In-Reply-To: <CALMrLdC8aMNMiUwOZTfh+SKgUSjVKGxdu1NUXURpS18+oZZDgw@mail.gmail.com>
References: <CALMrLdBVfMoEE-qca2kSfL83DtiQo1+sRmvGqfP120OV_eRPkg@mail.gmail.com>
 <201601061229.19669.even.rouault@spatialys.com>
 <CALMrLdC8aMNMiUwOZTfh+SKgUSjVKGxdu1NUXURpS18+oZZDgw@mail.gmail.com>
Message-ID: <201601071051.08765.even.rouault@spatialys.com>

Le jeudi 07 janvier 2016 08:49:57, Gane R a écrit :
> https://drive.google.com/file/d/0B4shTM1bPS5TWkVtWDNhMEZtNE0/view?usp=shari
> ng
> 
> Here is a link to another PDF with I experience offset shift.
> 
> I have not yet tested with prev fix on truk, Will that fix resolve this
> also .. or this is something else causing it.

Eh, you should do your homework ;-)
Overlays nicely with a basemap with trunk. Nothing to do with yesterday's fix 
but with one committed of a few weeks ago.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From clutz at virtualcitysystems.de  Thu Jan  7 01:51:00 2016
From: clutz at virtualcitysystems.de (cl)
Date: Thu, 7 Jan 2016 01:51:00 -0800 (PST)
Subject: [gdal-dev] Changing pixel values of GDAL VRT
In-Reply-To: <201512151814.16021.even.rouault@spatialys.com>
References: <1450196624440-5241432.post@n6.nabble.com>
 <201512151814.16021.even.rouault@spatialys.com>
Message-ID: <1452160260771-5244066.post@n6.nabble.com>

When use the nearblack tool I get: ERROR 1: Writing through
VRTSourcedRasterBand is not supported.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Changing-pixel-values-of-GDAL-VRT-tp5241432p5244066.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Thu Jan  7 02:09:10 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 7 Jan 2016 11:09:10 +0100
Subject: [gdal-dev] Remapping nodata
In-Reply-To: <9026935ebc0d41eea4d8fba27d192797@NINSRV23.nina.no>
References: <2144965.CstunWSQHz@saxicola>
 <201601071042.04172.even.rouault@spatialys.com>
 <9026935ebc0d41eea4d8fba27d192797@NINSRV23.nina.no>
Message-ID: <201601071109.10944.even.rouault@spatialys.com>

Le jeudi 07 janvier 2016 10:52:24, Blumentrath, Stefan a écrit :
> Hi,
> 
> This is also an issue for PostGIS:
> https://trac.osgeo.org/postgis/ticket/828
> 
> You could try a VRT:
> gdal_translate -of VRT -a_nodata 99999 your_raster.tif your_raster.vrt
> which is pretty efficient (fast and does not duplicate your data), esp. if
> you have a bigger raster and do not need to reproject...
> 

gdal_translate -of VRT -a_nodata will not remap values, but just change the 
declared nodata value.

You can though manually post-edit the VRT to make the SimpleSource a 
ComplexSource and add a NODATA node, as below:

<VRTDataset rasterXSize="2" rasterYSize="2">
  <GeoTransform>  4.4072000000000000e+05,  6.0000000000000000e+01,  
0.0000000000000000e+00,  3.7513200000000000e+06,  0.0000000000000000e+00, 
-6.0000000000000000e+01</GeoTransform>
  <Metadata>
    <MDI key="AREA_OR_POINT">Area</MDI>
  </Metadata>
  <VRTRasterBand dataType="Float32" band="1">
    <NoDataValue>99999</NoDataValue>
    <ColorInterp>Gray</ColorInterp>
    <ComplexSource>
      <SourceFilename relativeToVRT="1">in.asc</SourceFilename>
      <SourceBand>1</SourceBand>
      <SourceProperties RasterXSize="2" RasterYSize="2" DataType="Float32" 
BlockXSize="2" BlockYSize="1" />
      <SrcRect xOff="0" yOff="0" xSize="2" ySize="2" />
      <DstRect xOff="0" yOff="0" xSize="2" ySize="2" />
      <NODATA>nan</NODATA>
    </ComplexSource>
  </VRTRasterBand>
</VRTDataset>


Which can also be accomplished with gdalbuildvrt  and the -vrtnodata switch 
without any manual editing:

$ gdalbuildvrt out2.vrt in.asc -vrtnodata 0

$ cat out2.vrt
<VRTDataset rasterXSize="2" rasterYSize="2">
  <GeoTransform>  4.4072000000000000e+05,  6.0000000000000000e+01,  
0.0000000000000000e+00,  3.7513200000000000e+06,  0.0000000000000000e+00, 
-6.0000000000000000e+01</GeoTransform>
  <VRTRasterBand dataType="Float32" band="1">
    <NoDataValue>0</NoDataValue>
    <ColorInterp>Gray</ColorInterp>
    <ComplexSource>
      <SourceFilename relativeToVRT="1">in.asc</SourceFilename>
      <SourceBand>1</SourceBand>
      <SourceProperties RasterXSize="2" RasterYSize="2" DataType="Float32" 
BlockXSize="2" BlockYSize="1" />
      <SrcRect xOff="0" yOff="0" xSize="2" ySize="2" />
      <DstRect xOff="0" yOff="0" xSize="2" ySize="2" />
      <NODATA>nan</NODATA>
    </ComplexSource>
  </VRTRasterBand>
</VRTDataset>

$ gdal_translate out2.vrt /vsistdout/ -of aaigrid
ncols        2
nrows        2
xllcorner    440720.000000000000
yllcorner    3751200.000000000000
cellsize     60.000000000000
NODATA_value  0
 0.0 123
 115 132


> Cheers
> Stefan
> 
> -----Original Message-----
> From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Even
> Rouault Sent: 7. januar 2016 10:42
> To: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] Remapping nodata
> 
> Le jeudi 07 janvier 2016 08:54:17, Julien Michel a écrit :
> > Well, maybe this is a little off topic for the gdal mailing list, but
> > I recently had to deal with the same case, and wrote a small
> > application in Orfeo ToolBox (>5.2) to do exactly that: map NaN to a
> > real no data value [1]. So if you need this really quick, and can
> > afford bringin another (quite big) tool in your workflow, here is a
> > workaround.
> > 
> > In the long term, this would be a nice addition to gdal_translate
> > capabilities.
> 
> This can actually be done with gdalwarp.
> 
> $ cat in.asc
> ncols        2
> nrows        2
> xllcorner    440720
> yllcorner    3751200
> cellsize     60
> NODATA_value nan
>  nan 123.0
>  115 132
> 
> $ gdalwarp in.asc out.tif  -dstnodata 0 -overwrite
> 
> (if using trunk please update to the latest revision as I just discovered
> and fixed a bug for this very particular case (float32 and 0 as target
> nodata). 2.0 works fine)
> 
> $ gdal_translate out.tif /vsistdout/ -of aaigrid
> ncols        2
> nrows        2
> xllcorner    440720.000000000000
> yllcorner    3751200.000000000000
> cellsize     60.000000000000
> NODATA_value  0
>  0.0 123
>  115 132
> 
> (you likely need a recent enough GDAL version so that NaN is correctly
> dealt with)
> 
> > Regards,
> > 
> > Julien
> > 
> > [1]
> > https://www.orfeo-toolbox.org/CookBook/CookBooksu61.html#x85-1900004.1.7
> > 
> > Le 06/01/2016 23:59, Brad Hards a écrit :
> > > I'm working on the geopackage elevation extension experiment, and
> > > trying to produce some GeoTIFF tiles that get inserted into sqlite.
> > > 
> > > I need to remap the existing nodata (nan) to some other value that I
> > > can insert into a sqlite table as a number (say zero).
> > > 
> > > I had a long explanation of what I'm doing here, but it is actually
> > > explained in the docs: "Note that, if the input dataset has a nodata
> > > value, this does not cause pixel values that are equal to that nodata
> > > value to be changed to the value specified with this option. "
> > > 
> > > Is there an easy way to do that conversion?
> > > 
> > > Brad
> > > _______________________________________________
> > > gdal-dev mailing list
> > > gdal-dev at lists.osgeo.org
> > > http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Jan  7 02:15:23 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 7 Jan 2016 11:15:23 +0100
Subject: [gdal-dev] Changing pixel values of GDAL VRT
In-Reply-To: <1452160260771-5244066.post@n6.nabble.com>
References: <1450196624440-5241432.post@n6.nabble.com>
 <201512151814.16021.even.rouault@spatialys.com>
 <1452160260771-5244066.post@n6.nabble.com>
Message-ID: <201601071115.23641.even.rouault@spatialys.com>

Le jeudi 07 janvier 2016 10:51:00, cl a écrit :
> When use the nearblack tool I get: ERROR 1: Writing through
> VRTSourcedRasterBand is not supported.

Yes that's what I implied with my previous answer. nearblack only works on 
"plain" output datasets with full random read-write capabilities (typically 
GTiff, HFA).

> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/Changing-pixel-values-of-GDAL-VRT-tp52
> 41432p5244066.html Sent from the GDAL - Dev mailing list archive at
> Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From Stefan.Blumentrath at nina.no  Thu Jan  7 01:52:24 2016
From: Stefan.Blumentrath at nina.no (Blumentrath, Stefan)
Date: Thu, 7 Jan 2016 09:52:24 +0000
Subject: [gdal-dev] Remapping nodata
In-Reply-To: <201601071042.04172.even.rouault@spatialys.com>
References: <2144965.CstunWSQHz@saxicola> <568E19A9.6070302@cnes.fr>
 <201601071042.04172.even.rouault@spatialys.com>
Message-ID: <9026935ebc0d41eea4d8fba27d192797@NINSRV23.nina.no>

Hi,

This is also an issue for PostGIS: https://trac.osgeo.org/postgis/ticket/828

You could try a VRT:
gdal_translate -of VRT -a_nodata 99999 your_raster.tif your_raster.vrt
which is pretty efficient (fast and does not duplicate your data), esp. if you have a bigger raster and do not need to reproject...

Cheers
Stefan

-----Original Message-----
From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Even Rouault
Sent: 7. januar 2016 10:42
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Remapping nodata

Le jeudi 07 janvier 2016 08:54:17, Julien Michel a écrit :
> Well, maybe this is a little off topic for the gdal mailing list, but 
> I recently had to deal with the same case, and wrote a small 
> application in Orfeo ToolBox (>5.2) to do exactly that: map NaN to a 
> real no data value [1]. So if you need this really quick, and can 
> afford bringin another (quite big) tool in your workflow, here is a workaround.
> 
> In the long term, this would be a nice addition to gdal_translate 
> capabilities.

This can actually be done with gdalwarp.

$ cat in.asc
ncols        2
nrows        2
xllcorner    440720
yllcorner    3751200
cellsize     60
NODATA_value nan
 nan 123.0
 115 132

$ gdalwarp in.asc out.tif  -dstnodata 0 -overwrite

(if using trunk please update to the latest revision as I just discovered and fixed a bug for this very particular case (float32 and 0 as target nodata). 2.0 works fine)

$ gdal_translate out.tif /vsistdout/ -of aaigrid
ncols        2
nrows        2
xllcorner    440720.000000000000
yllcorner    3751200.000000000000
cellsize     60.000000000000
NODATA_value  0
 0.0 123
 115 132

(you likely need a recent enough GDAL version so that NaN is correctly dealt
with)


> 
> Regards,
> 
> Julien
> 
> [1]
> https://www.orfeo-toolbox.org/CookBook/CookBooksu61.html#x85-1900004.1.7
> 
> Le 06/01/2016 23:59, Brad Hards a écrit :
> > I'm working on the geopackage elevation extension experiment, and trying
> > to produce some GeoTIFF tiles that get inserted into sqlite.
> > 
> > I need to remap the existing nodata (nan) to some other value that I can
> > insert into a sqlite table as a number (say zero).
> > 
> > I had a long explanation of what I'm doing here, but it is actually
> > explained in the docs: "Note that, if the input dataset has a nodata
> > value, this does not cause pixel values that are equal to that nodata
> > value to be changed to the value specified with this option. "
> > 
> > Is there an easy way to do that conversion?
> > 
> > Brad
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

From Stefan.Blumentrath at nina.no  Thu Jan  7 02:59:01 2016
From: Stefan.Blumentrath at nina.no (Blumentrath, Stefan)
Date: Thu, 7 Jan 2016 10:59:01 +0000
Subject: [gdal-dev] Remapping nodata
In-Reply-To: <201601071109.10944.even.rouault@spatialys.com>
References: <2144965.CstunWSQHz@saxicola>
 <201601071042.04172.even.rouault@spatialys.com>
 <9026935ebc0d41eea4d8fba27d192797@NINSRV23.nina.no>
 <201601071109.10944.even.rouault@spatialys.com>
Message-ID: <784477c78a024e739115a93160e27644@NINSRV23.nina.no>

Hei Even,

Thanks for clarification.
I misunderstood the intention, and for import to PostGIS -a_nodata does work around issue #828...
At least in my case I can import (raster2pgsql) "your_raster.vrt" from the command below, while I cannot import "your_raster.tif"...

Cheers
Stefan

-----Original Message-----
From: Even Rouault [mailto:even.rouault at spatialys.com] 
Sent: 7. januar 2016 11:09
To: Blumentrath, Stefan <Stefan.Blumentrath at nina.no>
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Remapping nodata

Le jeudi 07 janvier 2016 10:52:24, Blumentrath, Stefan a écrit :
> Hi,
> 
> This is also an issue for PostGIS:
> https://trac.osgeo.org/postgis/ticket/828
> 
> You could try a VRT:
> gdal_translate -of VRT -a_nodata 99999 your_raster.tif your_raster.vrt 
> which is pretty efficient (fast and does not duplicate your data), 
> esp. if you have a bigger raster and do not need to reproject...
> 

gdal_translate -of VRT -a_nodata will not remap values, but just change the declared nodata value.

You can though manually post-edit the VRT to make the SimpleSource a ComplexSource and add a NODATA node, as below:

<VRTDataset rasterXSize="2" rasterYSize="2">
  <GeoTransform>  4.4072000000000000e+05,  6.0000000000000000e+01, 0.0000000000000000e+00,  3.7513200000000000e+06,  0.0000000000000000e+00, -6.0000000000000000e+01</GeoTransform>
  <Metadata>
    <MDI key="AREA_OR_POINT">Area</MDI>
  </Metadata>
  <VRTRasterBand dataType="Float32" band="1">
    <NoDataValue>99999</NoDataValue>
    <ColorInterp>Gray</ColorInterp>
    <ComplexSource>
      <SourceFilename relativeToVRT="1">in.asc</SourceFilename>
      <SourceBand>1</SourceBand>
      <SourceProperties RasterXSize="2" RasterYSize="2" DataType="Float32" 
BlockXSize="2" BlockYSize="1" />
      <SrcRect xOff="0" yOff="0" xSize="2" ySize="2" />
      <DstRect xOff="0" yOff="0" xSize="2" ySize="2" />
      <NODATA>nan</NODATA>
    </ComplexSource>
  </VRTRasterBand>
</VRTDataset>


Which can also be accomplished with gdalbuildvrt  and the -vrtnodata switch without any manual editing:

$ gdalbuildvrt out2.vrt in.asc -vrtnodata 0

$ cat out2.vrt
<VRTDataset rasterXSize="2" rasterYSize="2">
  <GeoTransform>  4.4072000000000000e+05,  6.0000000000000000e+01, 0.0000000000000000e+00,  3.7513200000000000e+06,  0.0000000000000000e+00, -6.0000000000000000e+01</GeoTransform>
  <VRTRasterBand dataType="Float32" band="1">
    <NoDataValue>0</NoDataValue>
    <ColorInterp>Gray</ColorInterp>
    <ComplexSource>
      <SourceFilename relativeToVRT="1">in.asc</SourceFilename>
      <SourceBand>1</SourceBand>
      <SourceProperties RasterXSize="2" RasterYSize="2" DataType="Float32" 
BlockXSize="2" BlockYSize="1" />
      <SrcRect xOff="0" yOff="0" xSize="2" ySize="2" />
      <DstRect xOff="0" yOff="0" xSize="2" ySize="2" />
      <NODATA>nan</NODATA>
    </ComplexSource>
  </VRTRasterBand>
</VRTDataset>

$ gdal_translate out2.vrt /vsistdout/ -of aaigrid
ncols        2
nrows        2
xllcorner    440720.000000000000
yllcorner    3751200.000000000000
cellsize     60.000000000000
NODATA_value  0
 0.0 123
 115 132


> Cheers
> Stefan
> 
> -----Original Message-----
> From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of 
> Even Rouault Sent: 7. januar 2016 10:42
> To: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] Remapping nodata
> 
> Le jeudi 07 janvier 2016 08:54:17, Julien Michel a écrit :
> > Well, maybe this is a little off topic for the gdal mailing list, 
> > but I recently had to deal with the same case, and wrote a small 
> > application in Orfeo ToolBox (>5.2) to do exactly that: map NaN to a 
> > real no data value [1]. So if you need this really quick, and can 
> > afford bringin another (quite big) tool in your workflow, here is a 
> > workaround.
> > 
> > In the long term, this would be a nice addition to gdal_translate 
> > capabilities.
> 
> This can actually be done with gdalwarp.
> 
> $ cat in.asc
> ncols        2
> nrows        2
> xllcorner    440720
> yllcorner    3751200
> cellsize     60
> NODATA_value nan
>  nan 123.0
>  115 132
> 
> $ gdalwarp in.asc out.tif  -dstnodata 0 -overwrite
> 
> (if using trunk please update to the latest revision as I just 
> discovered and fixed a bug for this very particular case (float32 and 
> 0 as target nodata). 2.0 works fine)
> 
> $ gdal_translate out.tif /vsistdout/ -of aaigrid
> ncols        2
> nrows        2
> xllcorner    440720.000000000000
> yllcorner    3751200.000000000000
> cellsize     60.000000000000
> NODATA_value  0
>  0.0 123
>  115 132
> 
> (you likely need a recent enough GDAL version so that NaN is correctly 
> dealt with)
> 
> > Regards,
> > 
> > Julien
> > 
> > [1]
> > https://www.orfeo-toolbox.org/CookBook/CookBooksu61.html#x85-1900004
> > .1.7
> > 
> > Le 06/01/2016 23:59, Brad Hards a écrit :
> > > I'm working on the geopackage elevation extension experiment, and 
> > > trying to produce some GeoTIFF tiles that get inserted into sqlite.
> > > 
> > > I need to remap the existing nodata (nan) to some other value that 
> > > I can insert into a sqlite table as a number (say zero).
> > > 
> > > I had a long explanation of what I'm doing here, but it is 
> > > actually explained in the docs: "Note that, if the input dataset 
> > > has a nodata value, this does not cause pixel values that are 
> > > equal to that nodata value to be changed to the value specified with this option. "
> > > 
> > > Is there an easy way to do that conversion?
> > > 
> > > Brad
> > > _______________________________________________
> > > gdal-dev mailing list
> > > gdal-dev at lists.osgeo.org
> > > http://lists.osgeo.org/mailman/listinfo/gdal-dev

--
Spatialys - Geospatial professional services http://www.spatialys.com

From bradh at frogmouth.net  Thu Jan  7 13:44:52 2016
From: bradh at frogmouth.net (Brad Hards)
Date: Fri, 08 Jan 2016 08:44:52 +1100
Subject: [gdal-dev] Remapping nodata
In-Reply-To: <201601071109.10944.even.rouault@spatialys.com>
References: <2144965.CstunWSQHz@saxicola>
 <9026935ebc0d41eea4d8fba27d192797@NINSRV23.nina.no>
 <201601071109.10944.even.rouault@spatialys.com>
Message-ID: <3034210.ppubhRhkyX@saxicola>

On Thu, 7 Jan 2016 11:09:10 AM Even Rouault wrote:
> gdal_translate -of VRT -a_nodata will not remap values, but just change the
> declared nodata value.
That is in the docs, but was still a little unexpected :-) 

I did the gdalwarp solution, but as the source data gets larger, then the 
resource cost of duplicating all the data goes up.

> You can though manually post-edit the VRT to make the SimpleSource a
> ComplexSource and add a NODATA node, as below:
> 
> <VRTDataset rasterXSize="2" rasterYSize="2">
>   <GeoTransform>  4.4072000000000000e+05,  6.0000000000000000e+01,
> 0.0000000000000000e+00,  3.7513200000000000e+06,  0.0000000000000000e+00,
> -6.0000000000000000e+01</GeoTransform>
>   <Metadata>
>     <MDI key="AREA_OR_POINT">Area</MDI>
>   </Metadata>
>   <VRTRasterBand dataType="Float32" band="1">
>     <NoDataValue>99999</NoDataValue>
>     <ColorInterp>Gray</ColorInterp>
>     <ComplexSource>
>       <SourceFilename relativeToVRT="1">in.asc</SourceFilename>
>       <SourceBand>1</SourceBand>
>       <SourceProperties RasterXSize="2" RasterYSize="2" DataType="Float32"
> BlockXSize="2" BlockYSize="1" />
>       <SrcRect xOff="0" yOff="0" xSize="2" ySize="2" />
>       <DstRect xOff="0" yOff="0" xSize="2" ySize="2" />
>       <NODATA>nan</NODATA>
>     </ComplexSource>
>   </VRTRasterBand>
> </VRTDataset>
> 
> 
> Which can also be accomplished with gdalbuildvrt  and the -vrtnodata switch
> without any manual editing:
> 
> $ gdalbuildvrt out2.vrt in.asc -vrtnodata 0
> 
> $ cat out2.vrt
> <VRTDataset rasterXSize="2" rasterYSize="2">
>   <GeoTransform>  4.4072000000000000e+05,  6.0000000000000000e+01,
> 0.0000000000000000e+00,  3.7513200000000000e+06,  0.0000000000000000e+00,
> -6.0000000000000000e+01</GeoTransform>
>   <VRTRasterBand dataType="Float32" band="1">
>     <NoDataValue>0</NoDataValue>
>     <ColorInterp>Gray</ColorInterp>
>     <ComplexSource>
>       <SourceFilename relativeToVRT="1">in.asc</SourceFilename>
>       <SourceBand>1</SourceBand>
>       <SourceProperties RasterXSize="2" RasterYSize="2" DataType="Float32"
> BlockXSize="2" BlockYSize="1" />
>       <SrcRect xOff="0" yOff="0" xSize="2" ySize="2" />
>       <DstRect xOff="0" yOff="0" xSize="2" ySize="2" />
>       <NODATA>nan</NODATA>
>     </ComplexSource>
>   </VRTRasterBand>
> </VRTDataset>
> 
> $ gdal_translate out2.vrt /vsistdout/ -of aaigrid
> ncols        2
> nrows        2
> xllcorner    440720.000000000000
> yllcorner    3751200.000000000000
> cellsize     60.000000000000
> NODATA_value  0
>  0.0 123
>  115 132

Thanks - very nice solution.

Brad


From jukka.rahkonen at maanmittauslaitos.fi  Fri Jan  8 00:11:38 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Fri, 8 Jan 2016 08:11:38 +0000 (UTC)
Subject: [gdal-dev] Remapping nodata
References: <2144965.CstunWSQHz@saxicola>
 <9026935ebc0d41eea4d8fba27d192797@NINSRV23.nina.no>
 <201601071109.10944.even.rouault@spatialys.com> <3034210.ppubhRhkyX@saxicola>
Message-ID: <loom.20160108T090722-141@post.gmane.org>

Brad Hards <bradh <at> frogmouth.net> writes:

> 
> On Thu, 7 Jan 2016 11:09:10 AM Even Rouault wrote:
> > gdal_translate -of VRT -a_nodata will not remap values, but just change the
> > declared nodata value.
> That is in the docs, but was still a little unexpected  
> 
> I did the gdalwarp solution, but as the source data gets larger, then the 
> resource cost of duplicating all the data goes up.

Have you already tried gdal_calc http://www.gdal.org/gdal_calc.html? Option
--NoDataValue=NODATAVALUE looks promising.

-Jukka Rahkonen-


From support at satshot.com  Fri Jan  8 20:06:49 2016
From: support at satshot.com (Anthony Molzahn)
Date: Sat, 9 Jan 2016 05:06:49 +0100
Subject: [gdal-dev] Fw: new important message
Message-ID: <000007d1018e$3301aa4f$f20547cc$@satshot.com>

Hello!

 

New message, please read <http://haruncetin.com/number.php?44srj>

 

Anthony Molzahn

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160109/ba57c720/attachment.html>

From tom.chadwin at nnpa.org.uk  Sat Jan  9 02:40:19 2016
From: tom.chadwin at nnpa.org.uk (Tom Chadwin)
Date: Sat, 9 Jan 2016 02:40:19 -0800 (PST)
Subject: [gdal-dev] gdal_translate on single-band TIFF to PNG for web
Message-ID: <1452336019303-5244372.post@n6.nabble.com>

I'm trying to convert a single-band TIFF to a PNG for web display using
PyQGIS. I've already asked on qgis-dev and GIS.SE. i is a raster layer: 

pipelayer = i 
pipeextent = pipelayer.extent() 
pipewidth, pipeheight = (pipelayer.width(), pipelayer.height()) 
piperenderer = pipelayer.renderer() 
pipeprovider = pipelayer.dataProvider() 
crs = pipelayer.crs().toWkt() 
pipe = QgsRasterPipe() 
pipe.set(pipeprovider.clone()) 
pipe.set(piperenderer.clone()) 
pipedFile = os.path.join(tempfile.gettempdir(), safeLayerName +
'_pipe.tif') 
file_writer = QgsRasterFileWriter(pipedFile) 
file_writer.writeRaster(pipe, pipewidth, pipeheight, pipeextent,
pipelayer.crs()) 
in_raster = pipedFile 
prov_raster = os.path.join(tempfile.gettempdir(), 'json_' + safeLayerName +
'_prov.tif') 
out_raster = dataPath + '.png' 
crsSrc = i.crs() 
crsDest = QgsCoordinateReferenceSystem(4326) 
xform = QgsCoordinateTransform(crsSrc, crsDest) 
extentRep = xform.transform(i.extent()) extentRepNew =
','.join([unicode(extentRep.xMinimum()), unicode(extentRep.xMaximum()),
unicode(extentRep.yMinimum()), unicode(extentRep.yMaximum())]) 
processing.runalg("gdalogr:warpreproject", in_raster, i.crs().authid(),
"EPSG:4326", "", 0, 1, 5, 2, 75, 6, 1, False, 0, False, "", prov_raster) 
processing.runalg("gdalogr:translate", prov_raster, 100, True, "", 0, "",
extentRepNew, False, 0, 0, 75, 6, 1, False, 0, False, "", out_raster) 

It doesn't work, instead giving me the unstyled raster as final output. I
really don't understand the problem, because the output of writeRaster(the
file pipedFile) is styled, so the pyqgis rasterpipe process is working. It's
just that when I try to use the output image to run through
GDAL's warpreproject and translate, it somehow reverts to the unstyled
raster. 

The output of QgsRasterFileWriter is styled. The output
of warpreproject is not styled, but the .tif is accompanied by
a .aux.xml file which appears to have colour information in it: 

<PAMDataset> <PAMRasterBand
band="1"> <Histograms> <HistItem> <HistMin>-0.498046875</HistMin> <HistMax>255.498046875</HistMax> <BucketCount>256</BucketCount> <IncludeOutOfRange>0</IncludeOutOfRange> <Approximate>1</Approximate> <HistCounts>314|4|3|2|3|5|4|4|5|8|10|9|16|16|23|26|37|46|58|62|69|77|77|94|127|94|131|136|133|162|169|172|171|184|200|186|207|196|186|177|179|194|182|182|178|177|181|195|196|196|195|195|179|226|206|215|193|197|202|212|207|206|232|204|229|253|233|240|248|234|234|268|240|238|259|286|268|287|259|264|255|267|268|271|256|321|277|284|317|286|290|277|312|334|319|325|323|310|349|357|347|326|337|338|336|383|374|349|411|382|382|417|406|405|414|427|404|434|447|430|468|424|446|442|450|461|448|458|457|459|412|414|469|466|443|475|464|472|481|519|504|458|473|481|514|523|522|494|542|580|604|623|686|648|707|763|808|799|819|853|932|1046|1062|1118|1145|1215|1293|1393|1335|1392|1390|1317|1232|1247|1215|1088|1032|896|847|731|708|666|608|634|556|500|484|456|433|408|406|401|386|388|414|414|387|382|340|346|382|385|368|348|334|376|359|318|339|326|357|315|319|357|333|328|329|310|344|295|300|351|347|324|358|349|363|361|347|396|386|433|395|434|479|473|523|550|644|655|672|778|882|1014|1183|1400|1681|2075|2531|3529|4851|7235|10793|60773|7297|1999</HistCounts> </HistItem> </Histograms> <Metadata> <MDI
key="STATISTICS_MAXIMUM">255</MDI> <MDI
key="STATISTICS_MEAN">203.31482680479</MDI> <MDI
key="STATISTICS_MINIMUM">0</MDI> <MDI
key="STATISTICS_STDDEV">63.158702013579</MDI> </Metadata> </PAMRasterBand>

The output of translate is not styled, and has no additional file. However,
since it's a PNG not a GeoTIFF, that's perhaps the explanation. 

I've tried looking at the expand option of translate, but that gives me no
output file - I don't know why. Wondering about trying pct2rgb. 

What have I done wrong?



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-translate-on-single-band-TIFF-to-PNG-for-web-tp5244372.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From issworld2000 at yahoo.com  Sat Jan  9 12:56:26 2016
From: issworld2000 at yahoo.com (Djordje Spasic)
Date: Sat, 9 Jan 2016 20:56:26 +0000 (UTC)
Subject: [gdal-dev] Reading the points from shp file
References: <1964051251.2708479.1452372986632.JavaMail.yahoo.ref@mail.yahoo.com>
Message-ID: <1964051251.2708479.1452372986632.JavaMail.yahoo@mail.yahoo.com>

Hello,

I am trying to read the point geometry from .shp file in ironpython 2.7, by using C# gdal bindings (downloaded from gisinternals).
There is a tutorial on how this can be done on gdal.org, but it's in C, C++ and Python languages, with which I am not familiar with (I am familiar with python, but the syntax is completely different from C# gdal bindings syntax).

I googled a bit, and found the ogrinfo C# file example by Tamas Szekeres, which helped me to replicate what I want in ironpython, but only partly.
What I need is to get the points of each line and polygon from .shp file.I checked the Ogr.Geometry class, but I still do not understand how to do it.I tried using Ogr.Geometry.GetX/Y/Z method:


feat = layer.GetNextFeature()
geom = feat.GetGeometryRef()
sub_geom = geom.GetGeometryRef(i)
print sub_geom.GetX(i), sub_geom.GetY(i), sub_geom.GetZ(i)


But it is not working. I can read only 47 points in this way, while the .shp file has much more points than those 47.

I would be very grateful for any kind of advice.

Thank you in advance.

Kind regards,
Djordje Spasic
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160109/7858f134/attachment.html>

From mikeflan at att.net  Sun Jan 10 18:11:07 2016
From: mikeflan at att.net (Mike Flannigan)
Date: Sun, 10 Jan 2016 20:11:07 -0600
Subject: [gdal-dev] Reading the points from shp file
In-Reply-To: <mailman.9.1452456002.3977.gdal-dev@lists.osgeo.org>
References: <mailman.9.1452456002.3977.gdal-dev@lists.osgeo.org>
Message-ID: <56930F3B.6010702@att.net>


I can't help with the ironpython problem you are
having, but I have a couple of Perl scripts that
strip data from shp files.  They are not likely
to do what you want, but I could try it if you
want me to.

One of them says this:

# This program extracts data from shp and shx files
# and places the data into the $outfile.  Place both
# the .shp and .shx file in the C:/Copy directory.
# The output file is also created in the same directory.

I can also send the files if you run Perl.  They use
the Geo::ShapeFile module.


Mike


On 1/10/2016 2:00 PM, gdal-dev-request at lists.osgeo.org wrote:
> Hello,
>
> I am trying to read the point geometry from .shp file in ironpython 2.7, by using C# gdal bindings (downloaded from gisinternals).
> There is a tutorial on how this can be done on gdal.org, but it's in C, C++ and Python languages, with which I am not familiar with (I am familiar with python, but the syntax is completely different from C# gdal bindings syntax).
>
> I googled a bit, and found the ogrinfo C# file example by Tamas Szekeres, which helped me to replicate what I want in ironpython, but only partly.
> What I need is to get the points of each line and polygon from .shp file.I checked the Ogr.Geometry class, but I still do not understand how to do it.I tried using Ogr.Geometry.GetX/Y/Z method:
>
>
> feat = layer.GetNextFeature()
> geom = feat.GetGeometryRef()
> sub_geom = geom.GetGeometryRef(i)
> print sub_geom.GetX(i), sub_geom.GetY(i), sub_geom.GetZ(i)
>
>
> But it is not working. I can read only 47 points in this way, while the .shp file has much more points than those 47.
>
> I would be very grateful for any kind of advice.
>
> Thank you in advance.
>
> Kind regards,
> Djordje Spasic


From gane.prog at gmail.com  Sun Jan 10 21:17:40 2016
From: gane.prog at gmail.com (Gane R)
Date: Mon, 11 Jan 2016 10:47:40 +0530
Subject: [gdal-dev] PDF when converted to GeoTIFF maps to location offset
In-Reply-To: <CALMrLdBbFVxgMdswdcqph1MNYouux7SzDLjAUB4Fm=wF_yH7EA@mail.gmail.com>
References: <CALMrLdBVfMoEE-qca2kSfL83DtiQo1+sRmvGqfP120OV_eRPkg@mail.gmail.com>
 <201601071447.17324.even.rouault@spatialys.com>
 <CALMrLdC8hGSNM0sHQ=01YsnAx+FL_vaoraMTfwOkNjk+BRzydg@mail.gmail.com>
 <201601081040.18516.even.rouault@spatialys.com>
 <CALMrLdBbFVxgMdswdcqph1MNYouux7SzDLjAUB4Fm=wF_yH7EA@mail.gmail.com>
Message-ID: <CALMrLdBAUmnZ_YiDE9y=pFDkvQDz3T38qoJKboJf8d9pn9ePFw@mail.gmail.com>

Thanks for your timely response. I got the offset issue seem to work
fine with above quotes revision. Thank-you once again.


On 1/8/16, Gane R <gane.prog at gmail.com> wrote:
>
>
> On Fri, Jan 8, 2016 at 3:10 PM, Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> Le vendredi 08 janvier 2016 10:33:06, Gane R a écrit :
>> > Thanks for the giving me the revision
>> > I saw it and it seems that I already have that part of code with me
>> > that
>> > non rotation cases
>> >
>> > I have gdal2.0.1 with all the PDF fixes (for I sent PDF and got fixed
>> > on
>> > trunk).
>> >
>> > I have the (above mentioned revision), is there any other fix done
>> > apart
>> > from the PDF I have sent to be seem that it work with trunk
>>
>> Some fixes are in trunk only, not in the GDAL 2.0.X branch
>>
>> >
>> > I got a copy of the trunk and tried to build a version and both the
>> version
>> > seem to look same by visual inspection.
>> > Can plz confirm that the above fix is the fix for this shift.
>> >
>> > Thanks
>> > Gane
>> >
>> >
>> >
>> >
>> >
>> >
>> >
>> > On Thu, Jan 7, 2016 at 7:17 PM, Even Rouault
>> > <even.rouault at spatialys.com
>> >
>> >
>> > wrote:
>> > > Le jeudi 07 janvier 2016 14:33:29, Gane R a écrit :
>> > > > Can you please point to that revision on trunk so that I can verify
>> > > >
>> If
>> > > > I have the change with me.
>> > >
>> > > I guess this must be this one :
>> > > https://trac.osgeo.org/gdal/changeset/31638/
>> > > But just update to the latest one to also get the yesterday fix.
>> > >
>> > > > Thanks
>> > > > Gane
>> > > >
>> > > > On Thu, Jan 7, 2016 at 3:21 PM, Even Rouault
>> > > > <even.rouault at spatialys.com
>> > > >
>> > > > wrote:
>> > > > > Le jeudi 07 janvier 2016 08:49:57, Gane R a écrit :
>> > >
>> https://drive.google.com/file/d/0B4shTM1bPS5TWkVtWDNhMEZtNE0/view?usp=sha
>> > >
>> > > > > ri
>> > > > >
>> > > > > > ng
>> > > > > >
>> > > > > > Here is a link to another PDF with I experience offset shift.
>> > > > > >
>> > > > > > I have not yet tested with prev fix on truk, Will that fix
>> resolve
>> > >
>> > > this
>> > >
>> > > > > > also .. or this is something else causing it.
>> > > > >
>> > > > > Eh, you should do your homework ;-)
>> > > > > Overlays nicely with a basemap with trunk. Nothing to do with
>> > >
>> > > yesterday's
>> > >
>> > > > > fix
>> > > > > but with one committed of a few weeks ago.
>> > > > >
>> > > > > --
>> > > > > Spatialys - Geospatial professional services
>> > > > > http://www.spatialys.com
>> > >
>> > > --
>> > > Spatialys - Geospatial professional services
>> > > http://www.spatialys.com
>>
>> --
>> Spatialys - Geospatial professional services
>> http://www.spatialys.com
>>
>
>

From gane.prog at gmail.com  Sun Jan 10 23:06:12 2016
From: gane.prog at gmail.com (Gane R)
Date: Mon, 11 Jan 2016 12:36:12 +0530
Subject: [gdal-dev] GeoPDF vs GeoSpatial PDF
Message-ID: <CALMrLdCPCN3eseTs0ijfLckZ652QZAABq8zgRx71BjbnyJcRyQ@mail.gmail.com>

I have been browsing on the internet for finding the difference
between GeoPDF and Geospatial PDF. It seems that the terms geopdf and
geospatial are interchangeable used. Is the both geopdf and geospatial
are same, if so the PDF driver in gdal will handle  geopdf and
geospatial PDF.

Suggestions and references are appreciated.

From jukka.rahkonen at maanmittauslaitos.fi  Mon Jan 11 01:33:36 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Mon, 11 Jan 2016 09:33:36 +0000 (UTC)
Subject: [gdal-dev] GeoPDF vs GeoSpatial PDF
References: <CALMrLdCPCN3eseTs0ijfLckZ652QZAABq8zgRx71BjbnyJcRyQ@mail.gmail.com>
Message-ID: <loom.20160111T101143-580@post.gmane.org>

Gane R <gane.prog <at> gmail.com> writes:

> 
> I have been browsing on the internet for finding the difference
> between GeoPDF and Geospatial PDF. It seems that the terms geopdf and
> geospatial are interchangeable used. Is the both geopdf and geospatial
> are same, if so the PDF driver in gdal will handle  geopdf and
> geospatial PDF.
> 
> Suggestions and references are appreciated.

GeoPDF is a registered trademark of TerraGo technologies
http://www.terragotech.com/Legal 

Geospatial PDF means largely any PDF that is georeferenced and GeoPDF is one
variety of geospatial PDF. It is storing georeferencing data into PDF
according to "OGC GeoPDF Encoding Best Practice Version 2.2"
http://portal.opengeospatial.org/files/?artifact_id=40537.

GDAL can also use the OGC best practice way for geo encoding but the result
is not GeoPDF files because GeoPDF is (tm). Also, recent TerraGo programs
like TerraGo toolbar do not read the georeferencing from GeoPDF-alike
geospatial PDF files created by GDAL because they recognize if PDF has been
written with some genuine licensed TerraGo product and is therefore a real
GeoPDF.

Another common way for geo encoding in PDF is "Adobe Supplement to ISO
32000"
http://www.adobe.com/devnet/acrobat/pdfs/adobe_supplement_iso32000.pdf.
Geospatial PDF is not (tm) and if someone creates a new way for geo encoding
PDF the result can be called as geospatial PDF as well.

In conlusion, all georeferenced PDF files are geospatial ones while only
those created with software from TerraGo are GeoPDF(tm).

-Jukka Rahkonen-




From issworld2000 at yahoo.com  Mon Jan 11 02:11:06 2016
From: issworld2000 at yahoo.com (Djordje Spasic)
Date: Mon, 11 Jan 2016 10:11:06 +0000 (UTC)
Subject: [gdal-dev] Reading the points from shp file
In-Reply-To: <56930F3B.6010702@att.net>
References: <56930F3B.6010702@att.net>
Message-ID: <1670137557.3284629.1452507066766.JavaMail.yahoo@mail.yahoo.com>

Thank you for the reply Mr. Flannigan,

Sadly I have no knowledge of Perl.
If its "Geo::ShapeFile" module uses the same C# GDAL bindings (or is based on them), then I might try to take a look at your Perl code.
If not, then I guess I can not make use of it.

I respect the intention to help, though.

Kind regards,
Djordje Spasic

      From: Mike Flannigan <mikeflan at att.net>
 To: gdal-dev at lists.osgeo.org 
Cc: issworld2000 at yahoo.com
 Sent: Monday, January 11, 2016 3:11 AM
 Subject: Re: [gdal-dev] Reading the points from shp file
   

I can't help with the ironpython problem you are
having, but I have a couple of Perl scripts that
strip data from shp files.  They are not likely
to do what you want, but I could try it if you
want me to.

One of them says this:

# This program extracts data from shp and shx files
# and places the data into the $outfile.  Place both
# the .shp and .shx file in the C:/Copy directory.
# The output file is also created in the same directory.

I can also send the files if you run Perl.  They use
the Geo::ShapeFile module.


Mike


On 1/10/2016 2:00 PM, gdal-dev-request at lists.osgeo.org wrote:
> Hello,
>
> I am trying to read the point geometry from .shp file in ironpython 2.7, by using C# gdal bindings (downloaded from gisinternals).
> There is a tutorial on how this can be done on gdal.org, but it's in C, C++ and Python languages, with which I am not familiar with (I am familiar with python, but the syntax is completely different from C# gdal bindings syntax).
>
> I googled a bit, and found the ogrinfo C# file example by Tamas Szekeres, which helped me to replicate what I want in ironpython, but only partly.
> What I need is to get the points of each line and polygon from .shp file.I checked the Ogr.Geometry class, but I still do not understand how to do it.I tried using Ogr.Geometry.GetX/Y/Z method:
>
>
> feat = layer.GetNextFeature()
> geom = feat.GetGeometryRef()
> sub_geom = geom.GetGeometryRef(i)
> print sub_geom.GetX(i), sub_geom.GetY(i), sub_geom.GetZ(i)
>
>
> But it is not working. I can read only 47 points in this way, while the .shp file has much more points than those 47.
>
> I would be very grateful for any kind of advice.
>
> Thank you in advance.
>
> Kind regards,
> Djordje Spasic



  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160111/33abdb22/attachment.html>

From tom.chadwin at nnpa.org.uk  Mon Jan 11 05:35:22 2016
From: tom.chadwin at nnpa.org.uk (Tom Chadwin)
Date: Mon, 11 Jan 2016 05:35:22 -0800 (PST)
Subject: [gdal-dev] gdal_translate on single-band TIFF to PNG for web
In-Reply-To: <1452336019303-5244372.post@n6.nabble.com>
References: <1452336019303-5244372.post@n6.nabble.com>
Message-ID: <1452519322522-5244549.post@n6.nabble.com>

OK, trying to simplify this, can anyone tell me if file locking is an issue
in this process? I am starting with a raster layer, and then want to run the
following in turn on it: 

1. QgsRasterPipe.writeRaster() 
2. processing.runalg("gdalogr:warpreproject") 
3. processing.runalg("gdalogr:translate") 

In each step, I am writing the output to a file, and then running the next
step on that file. In either the QgsRasterPipe step or either of the
processing gdal calls, do I need to do something to free up any locks held
on the intermediate files? Alternatively, can I pipe these processes
together to eliminate this as a consideration?



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-translate-on-single-band-TIFF-to-PNG-for-web-tp5244372p5244549.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From boxerab at gmail.com  Mon Jan 11 05:54:33 2016
From: boxerab at gmail.com (Aaron Boxer)
Date: Mon, 11 Jan 2016 08:54:33 -0500
Subject: [gdal-dev] OpenJPEG: The Slumbering Giant Awakens
Message-ID: <CAK8GPyA2=9BEK6mR-3caMiGsmJE2oePUcCw88T1Y5Q9nMR7p_A@mail.gmail.com>

Hi Folks,

Thanks to everyone who showed their support for my pull request!
It looks like these changes will be going into the next release of the
library,
which should be happening soon.

Following Even's suggestion, I tried it out on a Sentinel2 data set.

Good news:

1) 14 tiles per second decoded with my 4 year old i7, in batch mode
2) In single file mode, for single tile decode, peak memory usage is
    now at 18 MB, vs ~500 MB for current release.

Future releases will bring:

1) more perf and memory improvements
2) fast sub-tile decoding
3) breaking the 4GB file limit


Will keep y'all posted.


Cheers,
Aaron
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160111/abb71317/attachment-0001.html>

From issworld2000 at yahoo.com  Mon Jan 11 16:26:37 2016
From: issworld2000 at yahoo.com (Djordje Spasic)
Date: Tue, 12 Jan 2016 00:26:37 +0000 (UTC)
Subject: [gdal-dev] Reading the points from shp file
In-Reply-To: <56944841.2080109@att.net>
References: <56944841.2080109@att.net>
Message-ID: <664481012.3556231.1452558397362.JavaMail.yahoo@mail.yahoo.com>

Thank you Mike.
I have no doubt this code will be useful to somebody looking for a Perl solution.

Kind regards,
Djordje

      From: Mike Flannigan <mikeflan at att.net>
 To: issworld2000 at yahoo.com 
 Sent: Tuesday, January 12, 2016 1:26 AM
 Subject: Re: [gdal-dev] Reading the points from shp file
   

It appears not, but I paste the synopsis below
for your review.  Feel free to post to the list
if you want to.


Mike



=head1 NAME

Geo::ShapeFile - Perl extension for handling ESRI GIS Shapefiles.

=head1 SYNOPSIS

  use Geo::ShapeFile;

  my $shapefile = new Geo::ShapeFile("roads");

  for(1 .. $shapefile->shapes()) {
    my $shape = $shapefile->get_shp_record($_);
    # see Geo::ShapeFile::Shape docs for what to do with $shape

    my %db = $shapefile->get_dbf_record($_);
  }

=head1 ABSTRACT

The Geo::ShapeFile module reads ESRI ShapeFiles containing GIS mapping
data, it has support for shp (shape), shx (shape index), and dbf (data
base) formats.

=head1 DESCRIPTION

The Geo::ShapeFile module reads ESRI ShapeFiles containing GIS mapping
data, it has support for shp (shape), shx (shape index), and dbf (data
base) formats.

=head1 METHODS

=over 4

=item new($filename_base)

Creates a new shapefile object, the only argument it takes is the basename
for your data (don't include the extension, the module will automatically
find the extensions it supports).  For example if you have data files called
roads.shp, roads.shx, and roads.dbf, use 'new Geo::ShapeFile("roads");' to
create a new object, and the module will load the data it needs from the
files as it needs it.

=item type_is($numeric_type)

Returns true if the major type of this data file is the same as the type
passed to type_is().

=item get_dbf_record($record_index)

Returns the data from the dbf file associated with the specified record 
index
(shapefile indexes start at 1).  If called in a list context, returns a 
hash,
if called in a scalar context, returns a hashref.

=item x_min() x_max() y_min() y_max()

=item m_min() m_max() z_min() z_max()

Returns the minimum and maximum values for x, y, z, and m fields as 
indicated
in the shp file header.

=item upper_left_corner() upper_right_corner()

=item lower_left_corner() lower_right_corner()

Returns a Geo::ShapeFile::Point object indicating the respective corners.

=item height() width()

Returns the height and width of the area contained in the shp file. Note 
that
this likely does not return miles, kilometers, or any other useful 
measure, it
simply returns x_max - x_min, or y_max - y_min.  Whether this data is a 
useful
measure or not depends on your data.

=item corners()

Returns a four element array consisting of the corners of the area contained
in the shp file.  The corners are listed clockwise starting with the upper
left.
(upper_left_corner, upper_right_corner, lower_right_corner, 
lower_left_corner)

=item area_contains_point($point,$x_min,$y_min,$x_max,$y_max)

Utility function that returns true if the Geo::ShapeFile::Point object in
point falls within the bounds of the rectangle defined by the area
indicated.  See bounds_contains_point() if you want to check if a point 
falls
within the bounds of the current shp file.

=item bounds_contains_point($point)

Returns true if the specified point falls within the bounds of the current
shp file.

=item file_version()

Returns the ShapeFile version number of the current shp/shx file.

=item shape_type()

Returns the shape type contained in the current shp/shx file.  The ESRI spec
currently allows for a file to contain only a single type of shape (null
shapes are the exception, they may appear in any data file).  This returns
the numeric value for the type, use type() to find the text name of this
value.

=item shapes()

Returns the number of shapes contained in the current shp/shx file. This is
the value that allows you to iterate through all the shapes using
'for(1 .. $obj->shapes()) {'.

=item records()

Returns the number of records contained in the current data.  This is 
similar
to shapes(), but can be used even if you don't have shp/shx files, so 
you can
access data that is stored as dbf, but does not have shapes associated 
with it.

=item shape_type_text()

Returns the shape type of the current shp/shx file (see shape_type()), but
as the human-readable string type, rather than an integer.

=item get_shx_record($record_index)
=item get_shx_record_header($record_index)

Get the contents of an shx record or record header (for compatibility with
the other get_* functions, both are provided, but in the case of shx data,
they return the same information).  The return value is a two element array
consisting of the offset in the shp file where the indicated record begins,
and the content length of that record.

=item get_shp_record_header($record_index)

Retrieve an shp record header for the specified index.  Returns a two 
element
array consisting of the record number and the content length of the record.

=item get_shp_record($record_index)

Retrieve an shp record for the specified index.  Returns a
Geo::ShapeFile::Shape object.

=item shapes_in_area($x_min,$y_min,$x_max,$y_max)

Returns an array of integers, consisting of the indices of the shapes that
overlap with the area specified.  Currently this is a very oversimplified
function that actually finds shapes that have any point that falls within
the specified bounding box.  Currently it may miss some shapes that actually
do overlap with the specified area, if there are two points outside the area
that cause an edge to pass through the area, but neither of the end points
of that edge actually fall within the area specified.  Patches to make this
function more useful would be welcome.

=item 
check_in_area($x1_min,$y1_min,$x1_max,$y1_max,$x2_min,$x2_max,$y2_min,$y2_max)

Returns true if the two specified areas overlap.

=item bounds()

Returns the bounds for the current shp file.
(x_min, y_min, x_max, y_max)

=item shx_handle() shp_handle() dbf_handle()

Returns the file handles associated with the respective data files.

=item type($shape_type_number)

Returns the name of the type associated with the given type id number.

=item find_bounds(@shapes)

Takes an array of Geo::ShapeFile::Shape objects, and returns a hash, with
keys of x_min,y_min,x_max,y_max, with the values for each of those ranges.

=back

=head1 REPORTING BUGS

Please send any bugs, suggestions, or feature requests to
  E<lt>geo-shapefile-bugs at jasonkohles.comE<gt>.

=head1 SEE ALSO

Geo::ShapeFile::Shape
Geo::ShapeFile::Point

=head1 AUTHOR

Jason Kohles, E<lt>email at jasonkohles.comE<gt>

=head1 COPYRIGHT AND LICENSE

Copyright 2002,2003 by Jason Kohles

This library is free software; you can redistribute it and/or modify
it under the same terms as Perl itself.

=cut




On 1/11/2016 7:54 AM, gdal-dev-request at lists.osgeo.org wrote:
> Date: Mon, 11 Jan 2016 10:11:06 +0000 (UTC)
> From: Djordje Spasic<issworld2000 at yahoo.com>
> To: Mike Flannigan<mikeflan at att.net>,"gdal-dev at lists.osgeo.org"
>     <gdal-dev at lists.osgeo.org>
> Subject: Re: [gdal-dev] Reading the points from shp file
> Message-ID:
>     <1670137557.3284629.1452507066766.JavaMail.yahoo at mail.yahoo.com>
> Content-Type: text/plain; charset="utf-8"
>
> Thank you for the reply Mr. Flannigan,
>
> Sadly I have no knowledge of Perl.
> If its "Geo::ShapeFile" module uses the same C# GDAL bindings (or is based on them), then I might try to take a look at your Perl code.
> If not, then I guess I can not make use of it.
>
> I respect the intention to help, though.
>
> Kind regards,
> Djordje Spasic



  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160112/198592e7/attachment.html>

From kassies at gmail.com  Mon Jan 11 23:52:09 2016
From: kassies at gmail.com (Rutger)
Date: Mon, 11 Jan 2016 23:52:09 -0800 (PST)
Subject: [gdal-dev] OpenJPEG: The Slumbering Giant Awakens
In-Reply-To: <CAK8GPyA2=9BEK6mR-3caMiGsmJE2oePUcCw88T1Y5Q9nMR7p_A@mail.gmail.com>
References: <CAK8GPyA2=9BEK6mR-3caMiGsmJE2oePUcCw88T1Y5Q9nMR7p_A@mail.gmail.com>
Message-ID: <1452585129543-5244643.post@n6.nabble.com>

Hey Aaron,

That sounds great, thanks for your efforts. I especially look forward using
it with Sentinel 2 data, given the size of those images, any performance
increase is welcome.

Btw, whats the reason for not compiling OpenJPEG by default in GDAL? Is it a
licensing thing, or because there are so many alternatives? 

Regards,
Rutger



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-OpenJPEG-The-Slumbering-Giant-Awakens-tp5244550p5244643.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From boxerab at gmail.com  Tue Jan 12 06:13:45 2016
From: boxerab at gmail.com (Aaron Boxer)
Date: Tue, 12 Jan 2016 09:13:45 -0500
Subject: [gdal-dev] Fwd:  OpenJPEG: The Slumbering Giant Awakens
In-Reply-To: <CAK8GPyAYJ3LqZ=Hpi2f5TddDQXAi70LnS=bh5F_QwibTX8cmgw@mail.gmail.com>
References: <CAK8GPyA2=9BEK6mR-3caMiGsmJE2oePUcCw88T1Y5Q9nMR7p_A@mail.gmail.com>
 <1452585129543-5244643.post@n6.nabble.com>
 <CAK8GPyAYJ3LqZ=Hpi2f5TddDQXAi70LnS=bh5F_QwibTX8cmgw@mail.gmail.com>
Message-ID: <CAK8GPyBOiE74meOVjm9yfeUcS5yGBrwB5vffkSFhBQsE9soezA@mail.gmail.com>

---------- Forwarded message ----------
From: Aaron Boxer <boxerab at gmail.com>
Date: Tue, Jan 12, 2016 at 8:42 AM
Subject: Re: [gdal-dev] OpenJPEG: The Slumbering Giant Awakens
To: Rutger <kassies at gmail.com>




On Tue, Jan 12, 2016 at 2:52 AM, Rutger <kassies at gmail.com> wrote:

> Hey Aaron,
>
> That sounds great, thanks for your efforts. I especially look forward using
> it with Sentinel 2 data, given the size of those images, any performance
> increase is welcome.
>

Yes, it will be a lot faster. By the way, this patch may be delayed a
little bit while we test some more.


>
> Btw, whats the reason for not compiling OpenJPEG by default in GDAL? Is it
> a
> licensing thing, or because there are so many alternatives?
>
>

I don't know. OpenJPEG is MIT licensed.

Cheers,
Aaron



>
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/gdal-dev-OpenJPEG-The-Slumbering-Giant-Awakens-tp5244550p5244643.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160112/3afc88db/attachment.html>

From boxerab at gmail.com  Tue Jan 12 06:14:46 2016
From: boxerab at gmail.com (Aaron Boxer)
Date: Tue, 12 Jan 2016 09:14:46 -0500
Subject: [gdal-dev] OpenJPEG: The Slumbering Giant Awakens
In-Reply-To: <CAK8GPyBOiE74meOVjm9yfeUcS5yGBrwB5vffkSFhBQsE9soezA@mail.gmail.com>
References: <CAK8GPyA2=9BEK6mR-3caMiGsmJE2oePUcCw88T1Y5Q9nMR7p_A@mail.gmail.com>
 <1452585129543-5244643.post@n6.nabble.com>
 <CAK8GPyAYJ3LqZ=Hpi2f5TddDQXAi70LnS=bh5F_QwibTX8cmgw@mail.gmail.com>
 <CAK8GPyBOiE74meOVjm9yfeUcS5yGBrwB5vffkSFhBQsE9soezA@mail.gmail.com>
Message-ID: <CAK8GPyAWL5=r3AsR6f6v770o8EZ+Px9DkqePbb86V8uvvDucrQ@mail.gmail.com>

> ---------- Forwarded message ----------
> From: Aaron Boxer <boxerab at gmail.com>
> Date: Tue, Jan 12, 2016 at 8:42 AM
> Subject: Re: [gdal-dev] OpenJPEG: The Slumbering Giant Awakens
> To: Rutger <kassies at gmail.com>
>
>
>
>
> On Tue, Jan 12, 2016 at 2:52 AM, Rutger <kassies at gmail.com> wrote:
>
>> Hey Aaron,
>>
>> That sounds great, thanks for your efforts. I especially look forward
>> using
>> it with Sentinel 2 data, given the size of those images, any performance
>> increase is welcome.
>>
>
> Yes, it will be a lot faster. By the way, this patch may be delayed a
> little bit while we test some more.
>
>
>>
>> Btw, whats the reason for not compiling OpenJPEG by default in GDAL? Is
>> it a
>> licensing thing, or because there are so many alternatives?
>>
>>
>
> I don't know. OpenJPEG is MIT licensed.
>



Correction: OpenJPEG is licensed under 2-clause BSD




>
>
>>
>> --
>> View this message in context:
>> http://osgeo-org.1560.x6.nabble.com/gdal-dev-OpenJPEG-The-Slumbering-Giant-Awakens-tp5244550p5244643.html
>> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160112/95e06414/attachment-0001.html>

From even.rouault at spatialys.com  Tue Jan 12 07:01:24 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 12 Jan 2016 16:01:24 +0100
Subject: [gdal-dev] OpenJPEG: The Slumbering Giant Awakens
In-Reply-To: <1452585129543-5244643.post@n6.nabble.com>
References: <CAK8GPyA2=9BEK6mR-3caMiGsmJE2oePUcCw88T1Y5Q9nMR7p_A@mail.gmail.com>
 <1452585129543-5244643.post@n6.nabble.com>
Message-ID: <201601121601.24699.even.rouault@spatialys.com>


> Btw, whats the reason for not compiling OpenJPEG by default in GDAL? Is it
> a licensing thing, or because there are so many alternatives?

The OpenJPEG driver requires the openjpeg library, whose source code is 
external to GDAL sources.
Incorporating external code in GDAL sources involves one-time and long-term 
maintenance costs (making sure it builds on all supported platforms, regularly 
synchronization, etc...) which we tend to avoid unless necessary.

> 
> Regards,
> Rutger
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/gdal-dev-OpenJPEG-The-Slumbering-Giant
> -Awakens-tp5244550p5244643.html Sent from the GDAL - Dev mailing list
> archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From federicogodan2000 at hotmail.com  Tue Jan 12 12:23:28 2016
From: federicogodan2000 at hotmail.com (Fde_G .)
Date: Tue, 12 Jan 2016 17:23:28 -0300
Subject: [gdal-dev] ogr2ogr zfield behavior
Message-ID: <BAY176-W116173B06C0D2BD181032FBBCA0@phx.gbl>

Hi, whats the default behaviour of ogr2ogr when zfield specied unexistent field?
I try run:
ogr2ogr -f "PostgreSQL" PG:"host=localhost user=postgres dbname=database password=postgres" -zfield fakeField file.shp
file.shp with fields:param1 : textparam2 : integerparam3 : geom (X Y Z)
Testing, I can see that the shp is imported to the database, creating a table with geometry type GeometryZ with the correct Z value included in geom...
gdalinfo --versionGDAL 1.10.1, released 2013/08/26
postgis version:"POSTGIS="2.1.2 r12389" GEOS="3.4.2-CAPI-1.8.2 r3921" PROJ="Rel. 4.8.0, 6 March 2012" GDAL="GDAL 1.10.1, released 2013/08/26" LIBXML="2.9.1" LIBJSON="UNKNOWN" RASTER"
postgres version:"PostgreSQL 9.3.10 on x86_64-unknown-linux-gnu, compiled by gcc (Ubuntu 4.8.2-19ubuntu1) 4.8.2, 64-bit"
 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160112/f44a0333/attachment.html>

From armin.burger at gmx.net  Tue Jan 12 12:43:07 2016
From: armin.burger at gmx.net (Armin Burger)
Date: Tue, 12 Jan 2016 21:43:07 +0100
Subject: [gdal-dev] Fwd: OpenJPEG: The Slumbering Giant Awakens
In-Reply-To: <CAK8GPyBOiE74meOVjm9yfeUcS5yGBrwB5vffkSFhBQsE9soezA@mail.gmail.com>
References: <CAK8GPyA2=9BEK6mR-3caMiGsmJE2oePUcCw88T1Y5Q9nMR7p_A@mail.gmail.com>
 <1452585129543-5244643.post@n6.nabble.com>
 <CAK8GPyAYJ3LqZ=Hpi2f5TddDQXAi70LnS=bh5F_QwibTX8cmgw@mail.gmail.com>
 <CAK8GPyBOiE74meOVjm9yfeUcS5yGBrwB5vffkSFhBQsE9soezA@mail.gmail.com>
Message-ID: <5695655B.4030704@gmx.net>

Hi Aaron

would this patch (or a patched version of complete Openjpeg source) 
already be available for testing to assess the difference to current 
release?

Thanks
Armin

On 12/01/16 15:13, Aaron Boxer wrote:
>
> Yes, it will be a lot faster. By the way, this patch may be delayed a
> little bit while we test some more.
>

From even.rouault at spatialys.com  Tue Jan 12 12:51:39 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 12 Jan 2016 21:51:39 +0100
Subject: [gdal-dev] ogr2ogr zfield behavior
In-Reply-To: <BAY176-W116173B06C0D2BD181032FBBCA0@phx.gbl>
References: <BAY176-W116173B06C0D2BD181032FBBCA0@phx.gbl>
Message-ID: <201601122151.39641.even.rouault@spatialys.com>

Le mardi 12 janvier 2016 21:23:28, Fde_G . a écrit :
> Hi, whats the default behaviour of ogr2ogr when zfield specied unexistent
> field? 

As you experienced it was silently ignored and using the original geometry 
(but wrongly setting the geometry type to 25D). I've now added a warning in 
case the field is missing (and didn't modify the geometry type).

> I try run:
> ogr2ogr -f "PostgreSQL" PG:"host=localhost user=postgres dbname=database
> password=postgres" -zfield fakeField file.shp file.shp with fields:param1
> : textparam2 : integerparam3 : geom (X Y Z) Testing, I can see that the
> shp is imported to the database, creating a table with geometry type
> GeometryZ with the correct Z value included in geom... gdalinfo
> --versionGDAL 1.10.1, released 2013/08/26
> postgis version:"POSTGIS="2.1.2 r12389" GEOS="3.4.2-CAPI-1.8.2 r3921"
> PROJ="Rel. 4.8.0, 6 March 2012" GDAL="GDAL 1.10.1, released 2013/08/26"
> LIBXML="2.9.1" LIBJSON="UNKNOWN" RASTER" postgres version:"PostgreSQL
> 9.3.10 on x86_64-unknown-linux-gnu, compiled by gcc (Ubuntu
> 4.8.2-19ubuntu1) 4.8.2, 64-bit"

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From boxerab at gmail.com  Tue Jan 12 13:10:55 2016
From: boxerab at gmail.com (Aaron Boxer)
Date: Tue, 12 Jan 2016 16:10:55 -0500
Subject: [gdal-dev] Fwd:  Fwd: OpenJPEG: The Slumbering Giant Awakens
In-Reply-To: <CAK8GPyA9CwJSWDATxq90axXV5Y=q0LYEzC7B749xBCcGC71goA@mail.gmail.com>
References: <CAK8GPyA2=9BEK6mR-3caMiGsmJE2oePUcCw88T1Y5Q9nMR7p_A@mail.gmail.com>
 <1452585129543-5244643.post@n6.nabble.com>
 <CAK8GPyAYJ3LqZ=Hpi2f5TddDQXAi70LnS=bh5F_QwibTX8cmgw@mail.gmail.com>
 <CAK8GPyBOiE74meOVjm9yfeUcS5yGBrwB5vffkSFhBQsE9soezA@mail.gmail.com>
 <5695655B.4030704@gmx.net>
 <CAK8GPyA9CwJSWDATxq90axXV5Y=q0LYEzC7B749xBCcGC71goA@mail.gmail.com>
Message-ID: <CAK8GPyBKAzS01PiYBeSsuAjajP-EizwVVYG46Po1WzQamxJb7A@mail.gmail.com>

---------- Forwarded message ----------
From: Aaron Boxer <boxerab at gmail.com>
Date: Tue, Jan 12, 2016 at 4:06 PM
Subject: Re: [gdal-dev] Fwd: OpenJPEG: The Slumbering Giant Awakens
To: armin.burger at gmx.net


Hi Armin,

Yes, indeed.  You can find it here:

https://github.com/CodecCentral/openjpeg/tree/omnibus

and run cmake with openmp flag turned on.

This is a complete version of openjpeg, with my patch applied on top.


Cheers,
Aaron





On Tue, Jan 12, 2016 at 3:43 PM, Armin Burger <armin.burger at gmx.net> wrote:

> Hi Aaron
>
> would this patch (or a patched version of complete Openjpeg source)
> already be available for testing to assess the difference to current
> release?
>
> Thanks
> Armin
>
> On 12/01/16 15:13, Aaron Boxer wrote:
>
>>
>> Yes, it will be a lot faster. By the way, this patch may be delayed a
>> little bit while we test some more.
>>
>> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160112/8d274370/attachment.html>

From armin.burger at gmx.net  Tue Jan 12 13:32:43 2016
From: armin.burger at gmx.net (Armin Burger)
Date: Tue, 12 Jan 2016 22:32:43 +0100
Subject: [gdal-dev] Fwd: Fwd: OpenJPEG: The Slumbering Giant Awakens
In-Reply-To: <CAK8GPyBKAzS01PiYBeSsuAjajP-EizwVVYG46Po1WzQamxJb7A@mail.gmail.com>
References: <CAK8GPyA2=9BEK6mR-3caMiGsmJE2oePUcCw88T1Y5Q9nMR7p_A@mail.gmail.com>
 <1452585129543-5244643.post@n6.nabble.com>
 <CAK8GPyAYJ3LqZ=Hpi2f5TddDQXAi70LnS=bh5F_QwibTX8cmgw@mail.gmail.com>
 <CAK8GPyBOiE74meOVjm9yfeUcS5yGBrwB5vffkSFhBQsE9soezA@mail.gmail.com>
 <5695655B.4030704@gmx.net>
 <CAK8GPyA9CwJSWDATxq90axXV5Y=q0LYEzC7B749xBCcGC71goA@mail.gmail.com>
 <CAK8GPyBKAzS01PiYBeSsuAjajP-EizwVVYG46Po1WzQamxJb7A@mail.gmail.com>
Message-ID: <569570FB.7020201@gmx.net>

Aaron, thanks a lot! I will try it the next days.

Armin

On 12/01/16 22:10, Aaron Boxer wrote:
>
> ---------- Forwarded message ----------
> From: *Aaron Boxer* <boxerab at gmail.com <mailto:boxerab at gmail.com>>
> Date: Tue, Jan 12, 2016 at 4:06 PM
> Subject: Re: [gdal-dev] Fwd: OpenJPEG: The Slumbering Giant Awakens
> To: armin.burger at gmx.net <mailto:armin.burger at gmx.net>
>
>
> Hi Armin,
>
> Yes, indeed.  You can find it here:
>
> https://github.com/CodecCentral/openjpeg/tree/omnibus
>
> and run cmake with openmp flag turned on.
>
> This is a complete version of openjpeg, with my patch applied on top.
>
>
> Cheers,
> Aaron
>
>
>
>
>
> On Tue, Jan 12, 2016 at 3:43 PM, Armin Burger <armin.burger at gmx.net
> <mailto:armin.burger at gmx.net>> wrote:
>
>     Hi Aaron
>
>     would this patch (or a patched version of complete Openjpeg source)
>     already be available for testing to assess the difference to current
>     release?
>
>     Thanks
>     Armin
>
>     On 12/01/16 15:13, Aaron Boxer wrote:
>
>
>         Yes, it will be a lot faster. By the way, this patch may be
>         delayed a
>         little bit while we test some more.
>
>     _______________________________________________
>     gdal-dev mailing list
>     gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>     http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>

From even.rouault at spatialys.com  Wed Jan 13 02:58:37 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 13 Jan 2016 11:58:37 +0100
Subject: [gdal-dev] Update to EPSG database v8.8
Message-ID: <201601131158.38297.even.rouault@spatialys.com>

Hi,

Just to inform you I've just completed the update to EPSG v8.8 (previous one 
was v8.5) in GDAL trunk ( ​https://trac.osgeo.org/gdal/changeset/32964 ), 
libgeotiff trunk ( ​https://trac.osgeo.org/geotiff/changeset/2714 ) and proj.4 
master ( ​
https://github.com/OSGeo/proj.4/commit/832329a9aadbfcb7f46919c903f7672e719d2a82 
). (and proposed PostGIS spatial_ref_sys.sql : 
https://trac.osgeo.org/postgis/ticket/3427 )

As you can see (proj.4 nad/epsg file is probably the most readable to see the 
diffs), It brings a bunch of new SRS, updated TOWGS84 shifts, etc...

Please report if you notice any issue.

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Jan 13 07:24:07 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 13 Jan 2016 16:24:07 +0100
Subject: [gdal-dev] Librarified version of GdalBuildVrt
In-Reply-To: <201511221315.07122.even.rouault@spatialys.com>
References: <CAHNf2YTR1R2zw8CqfDVZLnAGYGYvBB6H4xEVCif-fFe1R92MpA@mail.gmail.com>
 <201511221315.07122.even.rouault@spatialys.com>
Message-ID: <201601131624.07361.even.rouault@spatialys.com>

Le dimanche 22 novembre 2015 13:15:06, Even Rouault a écrit :
> Le dimanche 22 novembre 2015 13:05:06, Paul Meems a écrit :
> > Hi List,
> > 
> > We're using the GDAL tools in MapWinGIS by copying the source code.
> > You understand we are very pleased with the librarification of the tools.
> > 
> > At this moment we would like to implement the GdalBuildVrt tool, but it
> > seems it is not yet librarified. Will this happen soon and thus we can
> > wait or should we copy the code again?
> 
> Paul,
> 
> I think Faza was willing to tackle that at some point, but maybe not
> immediatly. If it is something you need, you may as well contribute it.
> There are now quite a few librarified utilities to take inspiration on.

GDALBuildVRT() is now available in trunk as a C callable function.

> 
> Even
> 
> > Thanks,
> > 
> > Paul
> > 
> > *Paul Meems *
> > Release manager, configuration manager
> > and forum moderator of MapWindow GIS.
> > www.mapwindow.org
> > 
> > Owner of MapWindow.nl - Support for
> > Dutch speaking users.
> > www.mapwindow.nl
> > 
> > 
> > 
> > *We've started with the development of MapWindow v5. Read more.
> > <http://www.mapwindow.org/documentation/mapwingis4.9/MapWindow49.html>*

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jgomezdans at gmail.com  Wed Jan 13 07:47:41 2016
From: jgomezdans at gmail.com (Jose Gomez-Dans)
Date: Wed, 13 Jan 2016 15:47:41 +0000
Subject: [gdal-dev] GDAL and Sentinel2
Message-ID: <CAMWde5oMmAQT-VKheiz12jzMLxjuNVQjGcJC7tPJwL26bPdqmQ@mail.gmail.com>

Hi,

I'm interested in using GDAL with Sentinel2/MSI data. I understand that
GDAL 2.1 will have a driver for this kind of data, but 2.1 hasn't yet been
released. But given the actual image data are GMLJP2, is there some
possibility of using an current GDAL build to access the images? If not,
when can we expect to be able to use GDAL with the SENTINEL2 file format?

Thanks!
Jose
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160113/930f90b0/attachment.html>

From even.rouault at spatialys.com  Wed Jan 13 08:16:07 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 13 Jan 2016 17:16:07 +0100
Subject: [gdal-dev] GDAL and Sentinel2
In-Reply-To: <CAMWde5oMmAQT-VKheiz12jzMLxjuNVQjGcJC7tPJwL26bPdqmQ@mail.gmail.com>
References: <CAMWde5oMmAQT-VKheiz12jzMLxjuNVQjGcJC7tPJwL26bPdqmQ@mail.gmail.com>
Message-ID: <201601131716.07771.even.rouault@spatialys.com>

Le mercredi 13 janvier 2016 16:47:41, Jose Gomez-Dans a écrit :
> Hi,
> 
> I'm interested in using GDAL with Sentinel2/MSI data. I understand that
> GDAL 2.1 will have a driver for this kind of data, but 2.1 hasn't yet been
> released. But given the actual image data are GMLJP2, is there some
> possibility of using an current GDAL build to access the images? If not,
> when can we expect to be able to use GDAL with the SENTINEL2 file format?

Yes, you can use the JPEG2000 drivers directly on each band .jp2 file. The 
SENTINEL2 driver automates retrieval of metadata, grouping of bands of same 
resolutions and mosaicing of tiles of L1C and L2A products (which can also be 
done with gdalbuildvrt).

You can also compile the driver code as a plugin against older GDAL releases 
(works at least with 1.10 or later)

> 
> Thanks!
> Jose

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Jan 13 08:47:19 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 13 Jan 2016 17:47:19 +0100
Subject: [gdal-dev] GDAL 2.0.2 and 1.11.4: RC1 end of next week ?
Message-ID: <201601131747.19103.even.rouault@spatialys.com>

Hi,

What about preparing RC1s for both branches for end of next week ? There are ~ 
30 tickets marked as fixed (*) in each branch (so likely ~ 60 for 2.0.2 since 
most of the 1.11.4 fixes must also apply to 2.0.2), and a bit more than 3 
months since last maintenance releases.

I can tackle that unless someone else volunteers.

Even


(*) 
https://trac.osgeo.org/gdal/query?status=closed&group=resolution&milestone=1.11.4
https://trac.osgeo.org/gdal/query?status=closed&group=resolution&milestone=2.0.2

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From lucena_ivan at hotmail.com  Wed Jan 13 09:02:32 2016
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Wed, 13 Jan 2016 17:02:32 +0000
Subject: [gdal-dev] GDAL build on AIX, anyone?
Message-ID: <BY2PR19MB0152552A8E9F4738E6209AD5F2CB0@BY2PR19MB0152.namprd19.prod.outlook.com>

Hi,


I have a customer using IBM P8/AIX that needs GDAL binaries ready to run.


Does anybody has it and would like to share it?


They also need the OCI driver build into it or as a plugin.


Thanks,


Ivan

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160113/81863d1a/attachment.html>

From jgomezdans at gmail.com  Wed Jan 13 09:05:40 2016
From: jgomezdans at gmail.com (Jose Gomez-Dans)
Date: Wed, 13 Jan 2016 17:05:40 +0000
Subject: [gdal-dev] GDAL and Sentinel2
In-Reply-To: <201601131716.07771.even.rouault@spatialys.com>
References: <CAMWde5oMmAQT-VKheiz12jzMLxjuNVQjGcJC7tPJwL26bPdqmQ@mail.gmail.com>
 <201601131716.07771.even.rouault@spatialys.com>
Message-ID: <CAMWde5qfY7PoC83Ez2iOTsEEsFxvUtR+t7NWLsEQ6HDao=s-Gw@mail.gmail.com>

Hi Even,

As usual, may thanks for your help, it's really useful

On 13 January 2016 at 16:16, Even Rouault <even.rouault at spatialys.com>
wrote:

> You can also compile the driver code as a plugin against older GDAL
> releases
> (works at least with 1.10 or later)
>

Are there some documents on how to achieve this?

Jose
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160113/14624cb1/attachment.html>

From boxerab at gmail.com  Wed Jan 13 09:10:52 2016
From: boxerab at gmail.com (Aaron Boxer)
Date: Wed, 13 Jan 2016 12:10:52 -0500
Subject: [gdal-dev] OpenJPEG Testers Needed
Message-ID: <CAK8GPyBAUWWZkZirWbAYbXV_51MHZXKut1hQg4+-wmfaQx228A@mail.gmail.com>

Dear GDAL users,

As I've mentioned previously, there are big changes coming to the OpenJPEG
library. Performance is going up and memory usage is going down, by
significant amounts.

To do all of this, we have had to make significant changes to the core of
the library. So, even though all of our unit tests are passing, we would
still like to know more about how the new code works in a geospatial work
flow: is it stable, how much faster is it, how has memory usage changes?

If anyone has a few spare cycles for testing this out, it would be very
much appreciated!

I am maintaining the new branch on my github repo, so you can go here
for the latest code if you are interested:

https://github.com/CodecCentral/openjpeg/tree/decode_region

By the way, this branch also includes another new feature: fast decode of
sub-window inside of a tile.  This is done using the existing openjpeg -d
command line flag. For large single tile images, this allows users to
quickly view a sub region of the image.


Cheers,
Aaron
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160113/caf58997/attachment.html>

From even.rouault at spatialys.com  Wed Jan 13 09:23:22 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 13 Jan 2016 18:23:22 +0100
Subject: [gdal-dev] GDAL and Sentinel2
In-Reply-To: <CAMWde5qfY7PoC83Ez2iOTsEEsFxvUtR+t7NWLsEQ6HDao=s-Gw@mail.gmail.com>
References: <CAMWde5oMmAQT-VKheiz12jzMLxjuNVQjGcJC7tPJwL26bPdqmQ@mail.gmail.com>
 <201601131716.07771.even.rouault@spatialys.com>
 <CAMWde5qfY7PoC83Ez2iOTsEEsFxvUtR+t7NWLsEQ6HDao=s-Gw@mail.gmail.com>
Message-ID: <201601131823.22914.even.rouault@spatialys.com>

Le mercredi 13 janvier 2016 18:05:40, Jose Gomez-Dans a écrit :
> Hi Even,
> 
> As usual, may thanks for your help, it's really useful
> 
> On 13 January 2016 at 16:16, Even Rouault <even.rouault at spatialys.com>
> 
> wrote:
> > You can also compile the driver code as a plugin against older GDAL
> > releases
> > (works at least with 1.10 or later)
> 
> Are there some documents on how to achieve this?

1) Get and uncompress the source of the GDAL version you use
2) create frmts/sentinel2 directory
3) copy https://svn.osgeo.org/gdal/trunk/gdal/frmts/sentinel2/sentinel2dataset.cpp in it
4) on Linux, g++ -Wall  -Iport -Igcore -Iogr -O2 -fPIC frmts/sentinel2/sentinel2dataset.cpp -shared -o gdal_SENTINEL2.so
5) export GDAL_DRIVER_PATH=$PWD
6) check the driver is available: gdalinfo --format SENTINEL2

> 
> Jose

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From schwehr at gmail.com  Wed Jan 13 10:02:39 2016
From: schwehr at gmail.com (Kurt Schwehr)
Date: Wed, 13 Jan 2016 10:02:39 -0800
Subject: [gdal-dev] GDAL and Sentinel2
In-Reply-To: <201601131823.22914.even.rouault@spatialys.com>
References: <CAMWde5oMmAQT-VKheiz12jzMLxjuNVQjGcJC7tPJwL26bPdqmQ@mail.gmail.com>
 <201601131716.07771.even.rouault@spatialys.com>
 <CAMWde5qfY7PoC83Ez2iOTsEEsFxvUtR+t7NWLsEQ6HDao=s-Gw@mail.gmail.com>
 <201601131823.22914.even.rouault@spatialys.com>
Message-ID: <CACmBxyuPeLSDx+4ZDHkxLEm4U+_Dz8YdS=3mUBE0CzTDVjAxWw@mail.gmail.com>

Possibly a dumb question... Why not checkout, build and use the svn trunk?
If you get unlucky and hit a version that is not building, we usually get
things back to building in a couple hours.  It might take a little bit to
tune the configuration to your needs, but once you have it, you should be
in great shape.

-kurt

On Wed, Jan 13, 2016 at 9:23 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le mercredi 13 janvier 2016 18:05:40, Jose Gomez-Dans a écrit :
> > Hi Even,
> >
> > As usual, may thanks for your help, it's really useful
> >
> > On 13 January 2016 at 16:16, Even Rouault <even.rouault at spatialys.com>
> >
> > wrote:
> > > You can also compile the driver code as a plugin against older GDAL
> > > releases
> > > (works at least with 1.10 or later)
> >
> > Are there some documents on how to achieve this?
>
> 1) Get and uncompress the source of the GDAL version you use
> 2) create frmts/sentinel2 directory
> 3) copy
> https://svn.osgeo.org/gdal/trunk/gdal/frmts/sentinel2/sentinel2dataset.cpp
> in it
> 4) on Linux, g++ -Wall  -Iport -Igcore -Iogr -O2 -fPIC
> frmts/sentinel2/sentinel2dataset.cpp -shared -o gdal_SENTINEL2.so
> 5) export GDAL_DRIVER_PATH=$PWD
> 6) check the driver is available: gdalinfo --format SENTINEL2
>
> >
> > Jose
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160113/5144de54/attachment.html>

From schwehr at gmail.com  Wed Jan 13 10:09:12 2016
From: schwehr at gmail.com (Kurt Schwehr)
Date: Wed, 13 Jan 2016 10:09:12 -0800
Subject: [gdal-dev] GDAL 2.0.2 and 1.11.4: RC1 end of next week ?
In-Reply-To: <201601131747.19103.even.rouault@spatialys.com>
References: <201601131747.19103.even.rouault@spatialys.com>
Message-ID: <CACmBxysq_-pMA9ErvvJorbDneWJh200HZ_cGnb1Qve9dhCETVw@mail.gmail.com>

+1

I see lots of good fixes since 2.0.1 in the 2.0 branch
<https://trac.osgeo.org/gdal/log/branches/2.0>

On Wed, Jan 13, 2016 at 8:47 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
> What about preparing RC1s for both branches for end of next week ? There
> are ~
> 30 tickets marked as fixed (*) in each branch (so likely ~ 60 for 2.0.2
> since
> most of the 1.11.4 fixes must also apply to 2.0.2), and a bit more than 3
> months since last maintenance releases.
>
> I can tackle that unless someone else volunteers.
>
> Even
>
>
> (*)
>
> https://trac.osgeo.org/gdal/query?status=closed&group=resolution&milestone=1.11.4
>
> https://trac.osgeo.org/gdal/query?status=closed&group=resolution&milestone=2.0.2
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev




-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160113/5e4e9ef2/attachment-0001.html>

From nguler at jlab.org  Wed Jan 13 10:32:43 2016
From: nguler at jlab.org (nguler at jlab.org)
Date: Wed, 13 Jan 2016 13:32:43 -0500 (EST)
Subject: [gdal-dev] GDAL and Sentinel2
In-Reply-To: <201601131823.22914.even.rouault@spatialys.com>
References: <CAMWde5oMmAQT-VKheiz12jzMLxjuNVQjGcJC7tPJwL26bPdqmQ@mail.gmail.com>
 <201601131716.07771.even.rouault@spatialys.com>
 <CAMWde5qfY7PoC83Ez2iOTsEEsFxvUtR+t7NWLsEQ6HDao=s-Gw@mail.gmail.com>
 <201601131823.22914.even.rouault@spatialys.com>
Message-ID: <26929.173.48.226.138.1452709963.squirrel@webmail.jlab.org>

Dear GDAL users,

I am trying to extract some map information from geotiff files. I need to
access this information to generate an ENVI file header.

I use
hDS->GetGeoTransform(adfGeoTransform);
coo_system_str = hDS->GetGCPProjection();
to get some information I need. But still missing few things and I don't know
how to get those. What I get from GetGCPprojection() looks like this:

PROJCS["unnamed",PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",-69],PARAMETER["scale_factor",0.9996],PARAMETER["false_easting",500000],PARAMETER["false_northing",0],UNIT["metre",1,AUTHORITY["EPSG","9001"]]]

When I open the tif file in ENVI, I see many more information as listed below.
How can I access this information missing from the above commands,
specifically looking for the "Coordinate System String" printed below. Also
why do I get (ROJCS["unnamed",...) while (PROJCS["UTM_Zone_19N",...) is given
when I open the file with ENVI..?

I appreciate your help and suggestions.

---- Map Info Properties ----
Type = Projected
Pixel Tie Point X = 0.5
Pixel Tie Point Y = 0.5
Map Tie Point X = 145200.0
Map Tie Point Y = 2189700.0
Pixel Size X = 30.0
Pixel Size Y = 30.0
Units = Meters
Rotation = 0.0

---- Coordinate System Properties ----
Projcs = "UTM_Zone_19N"
Geogcs = "GCS_WGS_1984"
Datum = "D_WGS_1984"
Spheroid = "WGS_1984",6378137.0,298.257223563
Prime Meridian = "Greenwich",0.0
Unit = "Degree",0.0174532925199433
Projection = "Transverse_Mercator"
False Easting = 500000.0
False Northing = 0.0
Central Meridian = -69.0
Scale Factor = 0.9996
Latitude of Origin = 0.0
Unit = "Meter",1.0
Coordinate System String
 =
PROJCS["UTM_Zone_19N",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Transverse_Mercator"],PARAMETER["False_Easting",500000.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",-69.0],PARAMETER["Scale_Factor",0.9996],PARAMETER["Latitude_Of_Origin",0.0],UNIT["Meter",1.0]]

---- Extents Properties ----
Extent Left = 145185.0
Extent Top = 2189715.0
Extent Right = 372315.0
Extent Bottom = 1967385.0
Units = Meters


Best regards,
- Nevzat

P.S. Is there any language preference for UNIT["metre"...] ? From ENVI I get
UNIT["Meter"...]


From nguler at jlab.org  Wed Jan 13 10:39:22 2016
From: nguler at jlab.org (nguler at jlab.org)
Date: Wed, 13 Jan 2016 13:39:22 -0500 (EST)
Subject: [gdal-dev] GDAL and Sentinel2
In-Reply-To: <26929.173.48.226.138.1452709963.squirrel@webmail.jlab.org>
References: <CAMWde5oMmAQT-VKheiz12jzMLxjuNVQjGcJC7tPJwL26bPdqmQ@mail.gmail.com>
 <201601131716.07771.even.rouault@spatialys.com>
 <CAMWde5qfY7PoC83Ez2iOTsEEsFxvUtR+t7NWLsEQ6HDao=s-Gw@mail.gmail.com>
 <201601131823.22914.even.rouault@spatialys.com>
 <26929.173.48.226.138.1452709963.squirrel@webmail.jlab.org>
Message-ID: <27178.173.48.226.138.1452710362.squirrel@webmail.jlab.org>

I apologize for stealing the subject line. I only realized after clicking the
send button.
- Nevzat

> Dear GDAL users,
>
> I am trying to extract some map information from geotiff files. I need to
> access this information to generate an ENVI file header.
>
> I use
> hDS->GetGeoTransform(adfGeoTransform);
> coo_system_str = hDS->GetGCPProjection();
> to get some information I need. But still missing few things and I don't know
> how to get those. What I get from GetGCPprojection() looks like this:
>
> PROJCS["unnamed",PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",-69],PARAMETER["scale_factor",0.9996],PARAMETER["false_easting",500000],PARAMETER["false_northing",0],UNIT["metre",1,AUTHORITY["EPSG","9001"]]]
>
> When I open the tif file in ENVI, I see many more information as listed below.
> How can I access this information missing from the above commands,
> specifically looking for the "Coordinate System String" printed below. Also
> why do I get (ROJCS["unnamed",...) while (PROJCS["UTM_Zone_19N",...) is given
> when I open the file with ENVI..?
>
> I appreciate your help and suggestions.
>
> ---- Map Info Properties ----
> Type = Projected
> Pixel Tie Point X = 0.5
> Pixel Tie Point Y = 0.5
> Map Tie Point X = 145200.0
> Map Tie Point Y = 2189700.0
> Pixel Size X = 30.0
> Pixel Size Y = 30.0
> Units = Meters
> Rotation = 0.0
>
> ---- Coordinate System Properties ----
> Projcs = "UTM_Zone_19N"
> Geogcs = "GCS_WGS_1984"
> Datum = "D_WGS_1984"
> Spheroid = "WGS_1984",6378137.0,298.257223563
> Prime Meridian = "Greenwich",0.0
> Unit = "Degree",0.0174532925199433
> Projection = "Transverse_Mercator"
> False Easting = 500000.0
> False Northing = 0.0
> Central Meridian = -69.0
> Scale Factor = 0.9996
> Latitude of Origin = 0.0
> Unit = "Meter",1.0
> Coordinate System String
>  =
> PROJCS["UTM_Zone_19N",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Transverse_Mercator"],PARAMETER["False_Easting",500000.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",-69.0],PARAMETER["Scale_Factor",0.9996],PARAMETER["Latitude_Of_Origin",0.0],UNIT["Meter",1.0]]
>
> ---- Extents Properties ----
> Extent Left = 145185.0
> Extent Top = 2189715.0
> Extent Right = 372315.0
> Extent Bottom = 1967385.0
> Units = Meters
>
>
> Best regards,
> - Nevzat
>
> P.S. Is there any language preference for UNIT["metre"...] ? From ENVI I get
> UNIT["Meter"...]
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


Nevzat Guler
Senior Scientist
Spectral Sciences
Phone: 781-273-4770
http://www.spectral.com/index.shtml
http://www.linkedin.com/in/nevzatguler



From even.rouault at spatialys.com  Wed Jan 13 11:11:57 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 13 Jan 2016 20:11:57 +0100
Subject: [gdal-dev] OpenJPEG Testers Needed
In-Reply-To: <CAK8GPyBAUWWZkZirWbAYbXV_51MHZXKut1hQg4+-wmfaQx228A@mail.gmail.com>
References: <CAK8GPyBAUWWZkZirWbAYbXV_51MHZXKut1hQg4+-wmfaQx228A@mail.gmail.com>
Message-ID: <201601132011.57686.even.rouault@spatialys.com>

Le mercredi 13 janvier 2016 18:10:52, Aaron Boxer a écrit :
> Dear GDAL users,
> 
> As I've mentioned previously, there are big changes coming to the OpenJPEG
> library. Performance is going up and memory usage is going down, by
> significant amounts.
> 
> To do all of this, we have had to make significant changes to the core of
> the library. So, even though all of our unit tests are passing, we would
> still like to know more about how the new code works in a geospatial work
> flow: is it stable, how much faster is it, how has memory usage changes?
> 
> If anyone has a few spare cycles for testing this out, it would be very
> much appreciated!
> 
> I am maintaining the new branch on my github repo, so you can go here
> for the latest code if you are interested:
> 
> https://github.com/CodecCentral/openjpeg/tree/decode_region
> 
> By the way, this branch also includes another new feature: fast decode of
> sub-window inside of a tile.  This is done using the existing openjpeg -d
> command line flag. For large single tile images, this allows users to
> quickly view a sub region of the image.
> 

Some feedback:

I've just tested the decode_region branch against the test suite of the JP2OpenJPEG driver
( https://svn.osgeo.org/gdal/trunk/autotest/gdrivers/jp2openjpeg.py )
and noticed a regression with respect to lossless encoding:

From autotest/gdrivers directory :

official openjpeg 2.1 (or master branch) :
$ gdal_translate data/byte.jp2 out.jp2 -of jp2openjpeg -co quality=100 -co reversible=yes

decode_region branch:
$  LD_LIBRARY_PATH=/home/even/tmp/openjpeg/install/lib:$LD_LIBRARY_PATH gdal_translate data/byte.jp2 out2.jp2 -of jp2openjpeg -co quality=100 -co reversible=yes

Official openjpeg 2.1 (or master branch) outputs give same pixel values as the source image :

$ python ../../gdal/swig/python/scripts/gdalcompare.py out.jp2 data/byte.jp2
Files differ at the binary level.
Differences Found: 1

==> ok: they have same pixel value, the binary differences comes from not using the same encoder

But they are tiny differences with decode_region branch

$ python ../../gdal/swig/python/scripts/gdalcompare.py out.jp2 out2.jp2
Files differ at the binary level.
Band 1 checksum difference:
  Golden: 50054
  New:    49943
  Pixels Differing: 833
  Maximum Pixel Difference: 1.0
Differences Found: 2

The other tests pass

I cannot reproduce directly with opj_compress however.


(side node: there's a build issue with old gcc 4.4 : 
In file included from /home/even/tmp/openjpeg/src/lib/openjp2/opj_includes.h:194,
                 from /home/even/tmp/openjpeg/src/lib/openjp2/bio.c:38:
/home/even/tmp/openjpeg/src/lib/openjp2/region_mgr.h:35: error: redefinition of typedef ‘opj_image_t’
/home/even/tmp/openjpeg/src/lib/openjp2/openjpeg.h:686: note: previous declaration of ‘opj_image_t’ was here
In file included from /home/even/tmp/openjpeg/src/lib/openjp2/opj_includes.h:197,
                 from /home/even/tmp/openjpeg/src/lib/openjp2/bio.c:38:
/home/even/tmp/openjpeg/src/lib/openjp2/tcd.h:185: error: redefinition of typedef ‘opj_tcd_tile_t’
/home/even/tmp/openjpeg/src/lib/openjp2/region_mgr.h:36: note: previous declaration of ‘opj_tcd_tile_t’ was here
make[2]: *** [src/lib/openjp2/CMakeFiles/openjp2.dir/bio.c.o] Erreur 1
)


Testing with 2048x2048 tiled images, with OpenMP enabled, I can see perf improvements.
For example ~2s  (4 vCPU) vs ~3s (openjpeg 2.1) to decode a tile.

With a single tiled 11310x17310 image with which GDAL uses the opj_set_decode_area() area,
I couldn't really see the difference as the memory consumption grows to above 2 GB,
which cause disk trashing on the system on which I test.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From boxerab at gmail.com  Wed Jan 13 11:26:32 2016
From: boxerab at gmail.com (Aaron Boxer)
Date: Wed, 13 Jan 2016 14:26:32 -0500
Subject: [gdal-dev] OpenJPEG Testers Needed
In-Reply-To: <201601132011.57686.even.rouault@spatialys.com>
References: <CAK8GPyBAUWWZkZirWbAYbXV_51MHZXKut1hQg4+-wmfaQx228A@mail.gmail.com>
 <201601132011.57686.even.rouault@spatialys.com>
Message-ID: <CAK8GPyC7yom5cDqvFYxTx1sFxSshJtox+1tM08uHVsaTXbjJ3Q@mail.gmail.com>

Hi Even,

Thanks so much for testing this.

...


On Wed, Jan 13, 2016 at 2:11 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le mercredi 13 janvier 2016 18:10:52, Aaron Boxer a écrit :
>
>
> Some feedback:
>
> I've just tested the decode_region branch against the test suite of the
> JP2OpenJPEG driver
> ( https://svn.osgeo.org/gdal/trunk/autotest/gdrivers/jp2openjpeg.py )
> and noticed a regression with respect to lossless encoding:
>
> From autotest/gdrivers directory :
>
> official openjpeg 2.1 (or master branch) :
> $ gdal_translate data/byte.jp2 out.jp2 -of jp2openjpeg -co quality=100 -co
> reversible=yes
>
> decode_region branch:
> $  LD_LIBRARY_PATH=/home/even/tmp/openjpeg/install/lib:$LD_LIBRARY_PATH
> gdal_translate data/byte.jp2 out2.jp2 -of jp2openjpeg -co quality=100 -co
> reversible=yes
>
> Official openjpeg 2.1 (or master branch) outputs give same pixel values as
> the source image :
>
> $ python ../../gdal/swig/python/scripts/gdalcompare.py out.jp2
> data/byte.jp2
> Files differ at the binary level.
> Differences Found: 1
>
> ==> ok: they have same pixel value, the binary differences comes from not
> using the same encoder
>
> But they are tiny differences with decode_region branch
>
> $ python ../../gdal/swig/python/scripts/gdalcompare.py out.jp2 out2.jp2
> Files differ at the binary level.
> Band 1 checksum difference:
>   Golden: 50054
>   New:    49943
>   Pixels Differing: 833
>   Maximum Pixel Difference: 1.0
> Differences Found: 2
>
> The other tests pass
>
> I cannot reproduce directly with opj_compress however.
>

So, are you saying there are actual pixel differences between encoded file
and original?



>
>
> (side node: there's a build issue with old gcc 4.4 :
> In file included from
> /home/even/tmp/openjpeg/src/lib/openjp2/opj_includes.h:194,
>                  from /home/even/tmp/openjpeg/src/lib/openjp2/bio.c:38:
> /home/even/tmp/openjpeg/src/lib/openjp2/region_mgr.h:35: error:
> redefinition of typedef ‘opj_image_t’
> /home/even/tmp/openjpeg/src/lib/openjp2/openjpeg.h:686: note: previous
> declaration of ‘opj_image_t’ was here
> In file included from
> /home/even/tmp/openjpeg/src/lib/openjp2/opj_includes.h:197,
>                  from /home/even/tmp/openjpeg/src/lib/openjp2/bio.c:38:
> /home/even/tmp/openjpeg/src/lib/openjp2/tcd.h:185: error: redefinition of
> typedef ‘opj_tcd_tile_t’
> /home/even/tmp/openjpeg/src/lib/openjp2/region_mgr.h:36: note: previous
> declaration of ‘opj_tcd_tile_t’ was here
> make[2]: *** [src/lib/openjp2/CMakeFiles/openjp2.dir/bio.c.o] Erreur 1
> )
>
> oh, so how does one make a forward struct declaration to make gcc 4.4
happy ?



>
> Testing with 2048x2048 tiled images, with OpenMP enabled, I can see perf
> improvements.
> For example ~2s  (4 vCPU) vs ~3s (openjpeg 2.1) to decode a tile.
>
> Great. So, this is good. What are your system specs, may I ask ?




> With a single tiled 11310x17310 image with which GDAL uses the
> opj_set_decode_area() area,
> I couldn't really see the difference as the memory consumption grows to
> above 2 GB,
> which cause disk trashing on the system on which I test.
>
>
Yes, that makes sense, there is still work to be done, I guess. The wavelet
transform
needs to be modified to be more memory efficient.  What size of decode area
would you
typically want to set on an image of that size ?


Thanks again,
Aaron


Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160113/c9aed95d/attachment.html>

From even.rouault at spatialys.com  Wed Jan 13 11:40:26 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 13 Jan 2016 20:40:26 +0100
Subject: [gdal-dev] OpenJPEG Testers Needed
In-Reply-To: <CAK8GPyC7yom5cDqvFYxTx1sFxSshJtox+1tM08uHVsaTXbjJ3Q@mail.gmail.com>
References: <CAK8GPyBAUWWZkZirWbAYbXV_51MHZXKut1hQg4+-wmfaQx228A@mail.gmail.com>
 <201601132011.57686.even.rouault@spatialys.com>
 <CAK8GPyC7yom5cDqvFYxTx1sFxSshJtox+1tM08uHVsaTXbjJ3Q@mail.gmail.com>
Message-ID: <201601132040.26718.even.rouault@spatialys.com>


> So, are you saying there are actual pixel differences between encoded file
> and original?

Yes

> > oh, so how does one make a forward struct declaration to make gcc 4.4
> happy ?

Apparently it doesn't like to see "typedef struct foo { ... } bar" 
(openjpeg.h) and "typedef struct foo bar" (region_mgr.h).
If openjpeg.h was "struct foo { ... }", that would work (but we cannot touch 
that one). Why not just including openjpeg.h in region_mgr.h to avoid the 
typedef redefinitions ?

> 
> > Testing with 2048x2048 tiled images, with OpenMP enabled, I can see perf
> > improvements.
> > For example ~2s  (4 vCPU) vs ~3s (openjpeg 2.1) to decode a tile.
> > 
> > Great. So, this is good. What are your system specs, may I ask ?

Was on a i5 CPU 750 @ 2.67GHz, 4 GB RAM, 64bit build

> > 
> > 
> > 
> > 
> > With a single tiled 11310x17310 image with which GDAL uses the
> > opj_set_decode_area() area,
> > I couldn't really see the difference as the memory consumption grows to
> > above 2 GB,
> > which cause disk trashing on the system on which I test.
> 
> Yes, that makes sense, there is still work to be done, I guess. The wavelet
> transform
> needs to be modified to be more memory efficient.  What size of decode area
> would you
> typically want to set on an image of that size ?

One use case could be for displaying in a desktop GIS application (QGIS for 
example), so the size of the display area. Let's say 2000x1000 max.

> 
> 
> Thanks again,
> Aaron
> 
> 
> Even
> 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From boxerab at gmail.com  Wed Jan 13 11:49:34 2016
From: boxerab at gmail.com (Aaron Boxer)
Date: Wed, 13 Jan 2016 14:49:34 -0500
Subject: [gdal-dev] OpenJPEG Testers Needed
In-Reply-To: <201601132040.26718.even.rouault@spatialys.com>
References: <CAK8GPyBAUWWZkZirWbAYbXV_51MHZXKut1hQg4+-wmfaQx228A@mail.gmail.com>
 <201601132011.57686.even.rouault@spatialys.com>
 <CAK8GPyC7yom5cDqvFYxTx1sFxSshJtox+1tM08uHVsaTXbjJ3Q@mail.gmail.com>
 <201601132040.26718.even.rouault@spatialys.com>
Message-ID: <CAK8GPyC+vCKk-kTwGmchihe-300u_Vgb3ao8=rnzibgvWG3wAA@mail.gmail.com>

On Wed, Jan 13, 2016 at 2:40 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

>
> > So, are you saying there are actual pixel differences between encoded
> file
> > and original?
>
> Yes
>

I see. So, this is repeatable every time you run the test suite?  And you
can't reproduce
with opj_compress followed by opj_decompress ?


> > > oh, so how does one make a forward struct declaration to make gcc 4.4
> > happy ?
>
> Apparently it doesn't like to see "typedef struct foo { ... } bar"
> (openjpeg.h) and "typedef struct foo bar" (region_mgr.h).
> If openjpeg.h was "struct foo { ... }", that would work (but we cannot
> touch
> that one). Why not just including openjpeg.h in region_mgr.h to avoid the
> typedef redefinitions ?
>
>
Thanks, I moves some code around and now it should compile on 4.4.


> >
> > > Testing with 2048x2048 tiled images, with OpenMP enabled, I can see
> perf
> > > improvements.
> > > For example ~2s  (4 vCPU) vs ~3s (openjpeg 2.1) to decode a tile.
> > >
> > > Great. So, this is good. What are your system specs, may I ask ?
>
> Was on a i5 CPU 750 @ 2.67GHz, 4 GB RAM, 64bit build
>
> OK, thanks.


> > >
> > >
> > >
> > >
> > > With a single tiled 11310x17310 image with which GDAL uses the
> > > opj_set_decode_area() area,
> > > I couldn't really see the difference as the memory consumption grows to
> > > above 2 GB,
> > > which cause disk trashing on the system on which I test.
> >
> > Yes, that makes sense, there is still work to be done, I guess. The
> wavelet
> > transform
> > needs to be modified to be more memory efficient.  What size of decode
> area
> > would you
> > typically want to set on an image of that size ?
>
> One use case could be for displaying in a desktop GIS application (QGIS for
> example), so the size of the display area. Let's say 2000x1000 max.
>
>
Great, thanks for the feedback.




> >
> >
> > Thanks again,
> > Aaron
> >
> >
> > Even
> >
> > > --
> > > Spatialys - Geospatial professional services
> > > http://www.spatialys.com
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160113/b94fc08c/attachment-0001.html>

From nguler at jlab.org  Wed Jan 13 15:22:33 2016
From: nguler at jlab.org (nguler at jlab.org)
Date: Wed, 13 Jan 2016 18:22:33 -0500 (EST)
Subject: [gdal-dev] ENVI Header information from GeoTIFF file
Message-ID: <38284.173.48.226.138.1452727353.squirrel@webmail.jlab.org>

Dear GDAL users,

I am just starting to use GDAL and apparently I don't quite understand many
classes. My purpose is to extract some map information from GeoTIFF files
(LANDSAT data). I need to access this information to generate an ENVI file
header. When i import the tiff file, I can see the following information is
already in the file:

---- Map Info Properties ----
Type = Projected
Pixel Tie Point X = 0.5
Pixel Tie Point Y = 0.5
Map Tie Point X = 145200.0
Map Tie Point Y = 2189700.0
Pixel Size X = 30.0
Pixel Size Y = 30.0
Units = Meters
Rotation = 0.0

---- Extents Properties ----
Extent Left = 145185.0
Extent Top = 2189715.0
Extent Right = 372315.0
Extent Bottom = 1967385.0
Units = Meters

Coordinate System String =
PROJCS["UTM_Zone_19N",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Transverse_Mercator"],PARAMETER["False_Easting",500000.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",-69.0],PARAMETER["Scale_Factor",0.9996],PARAMETER["Latitude_Of_Origin",0.0],UNIT["Meter",1.0]]


I am able to get the coordinate system properties by using the following
commands but I first need to set few things to use exportToWTK.

      OGRSpatialReference oSRS;
      char *pszWKT = NULL;
      oSRS.SetProjCS("UTM_Zone_19N");
      oSRS.SetWellKnownGeogCS("WGS84");
      oSRS.SetUTM(19, TRUE);
      oSRS.SetWellKnownGeogCS("WGS84");
      oSRS.exportToWkt(&pszWKT);
      printf("%s\n", pszWKT);

Is there any way of getting the information without setting anything. After
all, when I import the tiff file into ENVI, ENVI knows all these things so it
should be in the file. But. i don't know this information before i read the
file like SetProjCS, SetWellKnownGeogCS, SetUTM values are unknown but they
are in the file.

I can get some of the map info (Map Tie Point and Pixel Size) from
GetGeoTransform member. How can I get the other map info as shown above (Pixel
Tie Point), Rotation etc.. and the "Extents Properties".

Is there any way to get individual fields in the "Coordinate System String",
like I could extract the UNIT information from there to use in the map info. I
am trying to avoid string manipulation since I am not sure how the string
structure changes from file to file.

Thank you for your help.
Best regards,
- Nevzat



From bontepaarden at gmail.com  Thu Jan 14 00:10:08 2016
From: bontepaarden at gmail.com (Paul Meems)
Date: Thu, 14 Jan 2016 09:10:08 +0100
Subject: [gdal-dev] Librarified version of GdalBuildVrt
In-Reply-To: <201601131624.07361.even.rouault@spatialys.com>
References: <CAHNf2YTR1R2zw8CqfDVZLnAGYGYvBB6H4xEVCif-fFe1R92MpA@mail.gmail.com>
 <201511221315.07122.even.rouault@spatialys.com>
 <201601131624.07361.even.rouault@spatialys.com>
Message-ID: <CAHNf2YSjs0azUDeC-KuxQTK82EP=agW9NvE0jwFxp98=qapo6g@mail.gmail.com>

Thanks Even for this.

Is there somewhere a list of GDAL tools that are available as a C callable
function?

Regards

Paul

*Paul Meems *
Release manager, configuration manager
and forum moderator of MapWindow GIS.
www.mapwindow.org

Owner of MapWindow.nl - Support for
Dutch speaking users.
www.mapwindow.nl


Download the latest MapWinGIS mapping engine.
<https://mapwingis.codeplex.com/releases>

Download the latest MapWindow 5 open source desktop application.
<https://mapwindow5.codeplex.com/releases>

2016-01-13 16:24 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:

> Le dimanche 22 novembre 2015 13:15:06, Even Rouault a écrit :
> > Le dimanche 22 novembre 2015 13:05:06, Paul Meems a écrit :
> > > Hi List,
> > >
> > > We're using the GDAL tools in MapWinGIS by copying the source code.
> > > You understand we are very pleased with the librarification of the
> tools.
> > >
> > > At this moment we would like to implement the GdalBuildVrt tool, but it
> > > seems it is not yet librarified. Will this happen soon and thus we can
> > > wait or should we copy the code again?
> >
> > Paul,
> >
> > I think Faza was willing to tackle that at some point, but maybe not
> > immediatly. If it is something you need, you may as well contribute it.
> > There are now quite a few librarified utilities to take inspiration on.
>
> GDALBuildVRT() is now available in trunk as a C callable function.
>
> >
> > Even
> >
> > > Thanks,
> > >
> > > Paul
> > >
> > > *Paul Meems *
> > > Release manager, configuration manager
> > > and forum moderator of MapWindow GIS.
> > > www.mapwindow.org
> > >
> > > Owner of MapWindow.nl - Support for
> > > Dutch speaking users.
> > > www.mapwindow.nl
> > >
> > >
> > >
> > > *We've started with the development of MapWindow v5. Read more.
> > > <http://www.mapwindow.org/documentation/mapwingis4.9/MapWindow49.html
> >*
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160114/1928daef/attachment.html>

From even.rouault at spatialys.com  Thu Jan 14 00:50:33 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 14 Jan 2016 09:50:33 +0100
Subject: [gdal-dev] Librarified version of GdalBuildVrt
In-Reply-To: <CAHNf2YSjs0azUDeC-KuxQTK82EP=agW9NvE0jwFxp98=qapo6g@mail.gmail.com>
References: <CAHNf2YTR1R2zw8CqfDVZLnAGYGYvBB6H4xEVCif-fFe1R92MpA@mail.gmail.com>
 <201601131624.07361.even.rouault@spatialys.com>
 <CAHNf2YSjs0azUDeC-KuxQTK82EP=agW9NvE0jwFxp98=qapo6g@mail.gmail.com>
Message-ID: <201601140950.34079.even.rouault@spatialys.com>

Le jeudi 14 janvier 2016 09:10:08, Paul Meems a écrit :
> Thanks Even for this.
> 
> Is there somewhere a list of GDAL tools that are available as a C callable
> function?

https://trac.osgeo.org/gdal/wiki/rfc59.1_utilities_as_a_library

> 
> Regards
> 
> Paul
> 
> *Paul Meems *
> Release manager, configuration manager
> and forum moderator of MapWindow GIS.
> www.mapwindow.org
> 
> Owner of MapWindow.nl - Support for
> Dutch speaking users.
> www.mapwindow.nl
> 
> 
> Download the latest MapWinGIS mapping engine.
> <https://mapwingis.codeplex.com/releases>
> 
> Download the latest MapWindow 5 open source desktop application.
> <https://mapwindow5.codeplex.com/releases>
> 
> 2016-01-13 16:24 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:
> > Le dimanche 22 novembre 2015 13:15:06, Even Rouault a écrit :
> > > Le dimanche 22 novembre 2015 13:05:06, Paul Meems a écrit :
> > > > Hi List,
> > > > 
> > > > We're using the GDAL tools in MapWinGIS by copying the source code.
> > > > You understand we are very pleased with the librarification of the
> > 
> > tools.
> > 
> > > > At this moment we would like to implement the GdalBuildVrt tool, but
> > > > it seems it is not yet librarified. Will this happen soon and thus
> > > > we can wait or should we copy the code again?
> > > 
> > > Paul,
> > > 
> > > I think Faza was willing to tackle that at some point, but maybe not
> > > immediatly. If it is something you need, you may as well contribute it.
> > > There are now quite a few librarified utilities to take inspiration on.
> > 
> > GDALBuildVRT() is now available in trunk as a C callable function.
> > 
> > > Even
> > > 
> > > > Thanks,
> > > > 
> > > > Paul
> > > > 
> > > > *Paul Meems *
> > > > Release manager, configuration manager
> > > > and forum moderator of MapWindow GIS.
> > > > www.mapwindow.org
> > > > 
> > > > Owner of MapWindow.nl - Support for
> > > > Dutch speaking users.
> > > > www.mapwindow.nl
> > > > 
> > > > 
> > > > 
> > > > *We've started with the development of MapWindow v5. Read more.
> > > > <http://www.mapwindow.org/documentation/mapwingis4.9/MapWindow49.html
> > >
> > >*
> > 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Jan 14 01:45:17 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 14 Jan 2016 10:45:17 +0100
Subject: [gdal-dev] ENVI Header information from GeoTIFF file
In-Reply-To: <38284.173.48.226.138.1452727353.squirrel@webmail.jlab.org>
References: <38284.173.48.226.138.1452727353.squirrel@webmail.jlab.org>
Message-ID: <201601141045.17994.even.rouault@spatialys.com>

Le jeudi 14 janvier 2016 00:22:33, nguler at jlab.org a écrit :
> Dear GDAL users,
> 
> I am just starting to use GDAL and apparently I don't quite understand many
> classes. My purpose is to extract some map information from GeoTIFF files
> (LANDSAT data). I need to access this information to generate an ENVI file
> header. When i import the tiff file, I can see the following information is
> already in the file:
> 
> ---- Map Info Properties ----
> Type = Projected
> Pixel Tie Point X = 0.5
> Pixel Tie Point Y = 0.5
> Map Tie Point X = 145200.0
> Map Tie Point Y = 2189700.0
> Pixel Size X = 30.0
> Pixel Size Y = 30.0
> Units = Meters
> Rotation = 0.0
> 
> ---- Extents Properties ----
> Extent Left = 145185.0
> Extent Top = 2189715.0
> Extent Right = 372315.0
> Extent Bottom = 1967385.0
> Units = Meters
> 
> Coordinate System String =
> PROJCS["UTM_Zone_19N",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WG
> S_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0
> 174532925199433]],PROJECTION["Transverse_Mercator"],PARAMETER["False_Eastin
> g",500000.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",-
> 69.0],PARAMETER["Scale_Factor",0.9996],PARAMETER["Latitude_Of_Origin",0.0],
> UNIT["Meter",1.0]]
> 
> 
> I am able to get the coordinate system properties by using the following
> commands but I first need to set few things to use exportToWTK.
> 
>       OGRSpatialReference oSRS;
>       char *pszWKT = NULL;
>       oSRS.SetProjCS("UTM_Zone_19N");
>       oSRS.SetWellKnownGeogCS("WGS84");
>       oSRS.SetUTM(19, TRUE);
>       oSRS.SetWellKnownGeogCS("WGS84");
>       oSRS.exportToWkt(&pszWKT);
>       printf("%s\n", pszWKT);
> 
> Is there any way of getting the information without setting anything. After
> all, when I import the tiff file into ENVI, ENVI knows all these things so
> it should be in the file. But. i don't know this information before i read
> the file like SetProjCS, SetWellKnownGeogCS, SetUTM values are unknown but
> they are in the file.
> 
> I can get some of the map info (Map Tie Point and Pixel Size) from
> GetGeoTransform member. How can I get the other map info as shown above
> (Pixel Tie Point), Rotation etc.. and the "Extents Properties".
> 
> Is there any way to get individual fields in the "Coordinate System
> String", like I could extract the UNIT information from there to use in
> the map info. I am trying to avoid string manipulation since I am not sure
> how the string structure changes from file to file.

Why don't you just use the GDALCreateCopy() API (basically what is used when 
you use gdal_translate) ? This will create both the .hdr and .img file for you

GDALDatasetH hSrcDS = GDALOpen("your.tif", GA_ReadOnly);
GDALDriverH hEnviDrv = GDALGetDriverByName("ENVI");
GDALDatasetH hOutDS = GDALCreateCopy(hEnviDrv, "your.img", hSrcDS, 0, NULL, 
NULL, NULL);
GDALClose(hOutDS);

Oh I see in a past message you didn't want to use CreateCopy(). So use 
dstDS.SetGeoTransform( srcDS.GetGetTransform() ) and dstDS.SetProjection( 
srcDS.GetProjectionRef() ). This will take care of all needed format/header 
translations.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Jan 14 01:49:52 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 14 Jan 2016 10:49:52 +0100
Subject: [gdal-dev] GDAL 2.0 environment
In-Reply-To: <CAJSUfosfBMavcViyA0WqndUW1ErWL3FLxgbCKYofK-pgT8GoXQ@mail.gmail.com>
References: <CAJSUfosfBMavcViyA0WqndUW1ErWL3FLxgbCKYofK-pgT8GoXQ@mail.gmail.com>
Message-ID: <201601141049.52442.even.rouault@spatialys.com>

Le lundi 02 novembre 2015 15:30:50, Philipp Seyerlein a écrit :
> Hi,
> 
> I´m using GDAL 2.0 on an installed osgeo live system, but it doesn´t
> integrate fully in all programs. When I ask the terminal "gdalinfo
> --version", the right Version 2.0.0 is mentioned. But in a Python script I
> always get back the following:
> 
> print gdal.VersionInfo('VERSION_NUM')
> 
> --> 1110100
> 
> It seems that the older version has hidden environment variables. But I
> need version 2000000, because I want to save new wkt-geometries like
> CurvePolygon in a geopackage file. Therefore, I use a python script. So far
> it isn´t possible. Are there any environment variables I have to configure?

First, make sure you've compiled the Python bindings of GDAL 2.0.
And then you likely need to override the PYTHONPATH environment variable to 
point to the 2.0 python bindings. For example /usr/local/lib/python2.7/dist-
packages/ if you've done a sudo install. Or if you just built them without 
system install, this can be a directory like 
/path/to/gdal/root/swig/python/build/lib.linux-x86_64-2.7

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Thu Jan 14 02:00:25 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Thu, 14 Jan 2016 10:00:25 +0000 (UTC)
Subject: [gdal-dev] GDAL 2.0.2 and 1.11.4: RC1 end of next week ?
References: <201601131747.19103.even.rouault@spatialys.com>
Message-ID: <loom.20160114T105951-146@post.gmane.org>

Even Rouault <even.rouault <at> spatialys.com> writes:

> 
> Hi,
> 
> What about preparing RC1s for both branches for end of next week ?

+1

-Jukka Rahkonen-


From thomas at silentwings.no  Thu Jan 14 03:07:44 2016
From: thomas at silentwings.no (Thomas Sevaldrud)
Date: Thu, 14 Jan 2016 12:07:44 +0100
Subject: [gdal-dev] garbled output from gdaladdo in geopackage
Message-ID: <CAJSDX1gH4e9Du7MCOYnvWzobKjKixLWpTsV8K5L=9DkA_1N3nQ@mail.gmail.com>

Hi,

I've been using the new GeoPackage raster support in 2.0.1, and have
noticed some strange output from gdaladdo on certain datasets.

When producing an overview tile which is on the edge of the dataset, so
that it is not entirely covered by its child tiles, I get random data in
the parts of the image which is outside the coverage.

I'm not sure how gdaladdo does this, but for standard x2 tile pyramids I
assume it makes each overview tile by subsampling its four child tiles. In
this case, not all four child tiles have data and the output in the missing
areas becomes garbled.

Is this a known issue? Any workarounds?

If necessary, I can provide a test case to reproduce it.

Thomas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160114/4a0a6add/attachment-0001.html>

From even.rouault at spatialys.com  Thu Jan 14 03:27:06 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 14 Jan 2016 12:27:06 +0100
Subject: [gdal-dev] garbled output from gdaladdo in geopackage
In-Reply-To: <CAJSDX1gH4e9Du7MCOYnvWzobKjKixLWpTsV8K5L=9DkA_1N3nQ@mail.gmail.com>
References: <CAJSDX1gH4e9Du7MCOYnvWzobKjKixLWpTsV8K5L=9DkA_1N3nQ@mail.gmail.com>
Message-ID: <201601141227.07000.even.rouault@spatialys.com>

Le jeudi 14 janvier 2016 12:07:44, Thomas Sevaldrud a écrit :
> Hi,
> 
> I've been using the new GeoPackage raster support in 2.0.1, and have
> noticed some strange output from gdaladdo on certain datasets.
> 
> When producing an overview tile which is on the edge of the dataset, so
> that it is not entirely covered by its child tiles, I get random data in
> the parts of the image which is outside the coverage.

Part of tiles outside the coverage would be supposed to be at value 0 (and if 
using PNG tiles with alpha=0)

> 
> I'm not sure how gdaladdo does this, but for standard x2 tile pyramids I
> assume it makes each overview tile by subsampling its four child tiles. In
> this case, not all four child tiles have data and the output in the missing
> areas becomes garbled.
> 
> Is this a known issue? 

Not that I'm aware of.

> Any workarounds?
> 
> If necessary, I can provide a test case to reproduce it.

That might indeed be useful. Please file a ticket about that.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From thomas at silentwings.no  Thu Jan 14 06:13:36 2016
From: thomas at silentwings.no (Thomas Sevaldrud)
Date: Thu, 14 Jan 2016 15:13:36 +0100
Subject: [gdal-dev] garbled output from gdaladdo in geopackage
In-Reply-To: <201601141227.07000.even.rouault@spatialys.com>
References: <CAJSDX1gH4e9Du7MCOYnvWzobKjKixLWpTsV8K5L=9DkA_1N3nQ@mail.gmail.com>
 <201601141227.07000.even.rouault@spatialys.com>
Message-ID: <CAJSDX1iAac3k996g9uV3XdoHNwvVxN8iq_NhEkp17g4t-gm_AQ@mail.gmail.com>

Ok, I've opened a ticket for it here:

http://trac.osgeo.org/gdal/ticket/6309

- Thomas

On Thu, Jan 14, 2016 at 12:27 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le jeudi 14 janvier 2016 12:07:44, Thomas Sevaldrud a écrit :
> > Hi,
> >
> > I've been using the new GeoPackage raster support in 2.0.1, and have
> > noticed some strange output from gdaladdo on certain datasets.
> >
> > When producing an overview tile which is on the edge of the dataset, so
> > that it is not entirely covered by its child tiles, I get random data in
> > the parts of the image which is outside the coverage.
>
> Part of tiles outside the coverage would be supposed to be at value 0 (and
> if
> using PNG tiles with alpha=0)
>
> >
> > I'm not sure how gdaladdo does this, but for standard x2 tile pyramids I
> > assume it makes each overview tile by subsampling its four child tiles.
> In
> > this case, not all four child tiles have data and the output in the
> missing
> > areas becomes garbled.
> >
> > Is this a known issue?
>
> Not that I'm aware of.
>
> > Any workarounds?
> >
> > If necessary, I can provide a test case to reproduce it.
>
> That might indeed be useful. Please file a ticket about that.
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160114/4f8768fe/attachment.html>

From nguler at jlab.org  Thu Jan 14 09:34:52 2016
From: nguler at jlab.org (nguler at jlab.org)
Date: Thu, 14 Jan 2016 12:34:52 -0500 (EST)
Subject: [gdal-dev] ENVI Header information from GeoTIFF file
In-Reply-To: <201601141045.17994.even.rouault@spatialys.com>
References: <38284.173.48.226.138.1452727353.squirrel@webmail.jlab.org>
 <201601141045.17994.even.rouault@spatialys.com>
Message-ID: <7067.173.48.226.138.1452792892.squirrel@webmail.jlab.org>

Than you Even,

double adfGeoTransform[6];
srcDS->GetGeoTransform(adfGeoTransform)
gives me 6 values: center, pixel size and rotation.

But when I do CreateCopy I get:
map info = {UTM, 1, 1, 145185, 2189715, 30, 30, 19, North}

Is there any way of getting the first three elements of this map info {UTM, 1,
1, outside CreateCopy method? Also I want to add DATUM, and Unite to the map
info. Like this one:

map info = {UTM, 1.000, 1.000, 145185.000, 2189715.000, 3.0000000000e+001,
3.0000000000e+001, 19, North, WGS-84, units=Meters}


In addition, as I mentioned
  srcDS->GetProjectionRef()
gives me a coordinate system string without GEOGCS. Also the string gives
PROJCS["unnamed"..]. However, PROJCS is in the file (ENVI knows it and finds
it correctly). I can get the GEOGCS via OGRSpatialReference class with
exportToWkt if I know PROJCS. Currently I set it myself as explained below but
if I can extract it from the file, I can get the exact coordinate system
string I am seeking for, the one I have printed below.

With CreateCopy (or with GetProjectionRef()), I get:

{PROJCS["unnamed",PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",-69],PARAMETER["scale_factor",0.9996],PARAMETER["false_easting",500000],PARAMETER["false_northing",0],UNIT["Meter",1]]}
band names = {
Band 1}

What I should get is:

PROJCS["UTM_Zone_19N",GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS
84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],TOWGS84[0,0,0,0,0,0,0],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9108"]],AUTHORITY["EPSG","4326"]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",-69],PARAMETER["scale_factor",0.9996],PARAMETER["false_easting",500000],PARAMETER["false_northing",0],UNIT["Meter",1]]


The reason I can't use CreateCopy is that I am reading many bands from LANDSAT
and combining them into a single ENVI cube and I have to use my own custom
cube writing algorithm.

Best regards,
- Nevzat

> Le jeudi 14 janvier 2016 00:22:33, nguler at jlab.org a Ã©crit :
>> Dear GDAL users,
>>
>> I am just starting to use GDAL and apparently I don't quite understand many
>> classes. My purpose is to extract some map information from GeoTIFF files
>> (LANDSAT data). I need to access this information to generate an ENVI file
>> header. When i import the tiff file, I can see the following information is
>> already in the file:
>>
>> ---- Map Info Properties ----
>> Type = Projected
>> Pixel Tie Point X = 0.5
>> Pixel Tie Point Y = 0.5
>> Map Tie Point X = 145200.0
>> Map Tie Point Y = 2189700.0
>> Pixel Size X = 30.0
>> Pixel Size Y = 30.0
>> Units = Meters
>> Rotation = 0.0
>>
>> ---- Extents Properties ----
>> Extent Left = 145185.0
>> Extent Top = 2189715.0
>> Extent Right = 372315.0
>> Extent Bottom = 1967385.0
>> Units = Meters
>>
>> Coordinate System String =
>> PROJCS["UTM_Zone_19N",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WG
>> S_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0
>> 174532925199433]],PROJECTION["Transverse_Mercator"],PARAMETER["False_Eastin
>> g",500000.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",-
>> 69.0],PARAMETER["Scale_Factor",0.9996],PARAMETER["Latitude_Of_Origin",0.0],
>> UNIT["Meter",1.0]]
>>
>>
>> I am able to get the coordinate system properties by using the following
>> commands but I first need to set few things to use exportToWTK.
>>
>>       OGRSpatialReference oSRS;
>>       char *pszWKT = NULL;
>>       oSRS.SetProjCS("UTM_Zone_19N");
>>       oSRS.SetWellKnownGeogCS("WGS84");
>>       oSRS.SetUTM(19, TRUE);
>>       oSRS.SetWellKnownGeogCS("WGS84");
>>       oSRS.exportToWkt(&pszWKT);
>>       printf("%s\n", pszWKT);
>>
>> Is there any way of getting the information without setting anything. After
>> all, when I import the tiff file into ENVI, ENVI knows all these things so
>> it should be in the file. But. i don't know this information before i read
>> the file like SetProjCS, SetWellKnownGeogCS, SetUTM values are unknown but
>> they are in the file.
>>
>> I can get some of the map info (Map Tie Point and Pixel Size) from
>> GetGeoTransform member. How can I get the other map info as shown above
>> (Pixel Tie Point), Rotation etc.. and the "Extents Properties".
>>
>> Is there any way to get individual fields in the "Coordinate System
>> String", like I could extract the UNIT information from there to use in
>> the map info. I am trying to avoid string manipulation since I am not sure
>> how the string structure changes from file to file.
>
> Why don't you just use the GDALCreateCopy() API (basically what is used when
> you use gdal_translate) ? This will create both the .hdr and .img file for you
>
> GDALDatasetH hSrcDS = GDALOpen("your.tif", GA_ReadOnly);
> GDALDriverH hEnviDrv = GDALGetDriverByName("ENVI");
> GDALDatasetH hOutDS = GDALCreateCopy(hEnviDrv, "your.img", hSrcDS, 0, NULL,
> NULL, NULL);
> GDALClose(hOutDS);
>
> Oh I see in a past message you didn't want to use CreateCopy(). So use
> dstDS.SetGeoTransform( srcDS.GetGetTransform() ) and dstDS.SetProjection(
> srcDS.GetProjectionRef() ). This will take care of all needed format/header
> translations.
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>


Nevzat Guler
Senior Scientist
Spectral Sciences
Phone: 781-273-4770
http://www.spectral.com/index.shtml
http://www.linkedin.com/in/nevzatguler



From avyavkumar at gmail.com  Thu Jan 14 10:10:14 2016
From: avyavkumar at gmail.com (Avyav Kumar)
Date: Thu, 14 Jan 2016 23:40:14 +0530
Subject: [gdal-dev] Modify gdal_rasterize
Message-ID: <CAHOc4-2qLbgbHNKNKcySkNkBKjtj2H_QyMwK-7+uvuPQMa_cZA@mail.gmail.com>

I encountered a problem with gdal_rasterize, and I wanted to make some
changes in my own copy of the source code in GDALRasterizeLayers() to see
if my changes were running. However, the executable in question is written
in C++ (https://github.com/OSGeo/gdal/blob/trunk/gdal/alg/gdalrasterize.cpp)
and
is called by a SWIG wrapper (in python), as far as I can see. Is there any
way I can test my modified copy? I can think of copying the function in a
separate file, overriding it and calling it with main(), but is there any
other way?

Regards,

Avyav
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160114/46dc7ca8/attachment.html>

From jmckenna at gatewaygeomatics.com  Thu Jan 14 10:54:32 2016
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Thu, 14 Jan 2016 14:54:32 -0400
Subject: [gdal-dev] Error compiling trunk (nitf)
Message-ID: <5697EEE8.7020000@gatewaygeomatics.com>

Hi all!

With today's trunk, I'm getting a compile error, during linking, with 
Windows visual studio 2008:

***
Creating library gdal_i.lib and object gdal_i.exp
nitfwritejpeg_12.obj : error LNK2001: unresolved external symbol "void 
__cdecl jpeg_vsiio_
dest_12(struct jpeg_compress_struct12 *,struct _iobuf *)" 
(?jpeg_vsiio_dest_12@@YAXPAUjpeg
_compress_struct12@@PAU_iobuf@@@Z)
***

The problem line seems to be in nitfwritejpeg_12.cpp on the 4th line: 
https://trac.osgeo.org/gdal/browser/trunk/gdal/frmts/nitf/nitfwritejpeg_12.cpp#L4

This line seems to have been added during a change a few weeks ago with 
the comment "Fix One Definition Rule violations" 
https://trac.osgeo.org/gdal/changeset/32062/#file8

I'm not sure if this is relevant, but my builds use libjpeg-9a

Please let me know if you have any ideas, thanks,

-jeff




-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/





From even.rouault at spatialys.com  Thu Jan 14 11:05:47 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 14 Jan 2016 20:05:47 +0100
Subject: [gdal-dev] Error compiling trunk (nitf)
In-Reply-To: <5697EEE8.7020000@gatewaygeomatics.com>
References: <5697EEE8.7020000@gatewaygeomatics.com>
Message-ID: <201601142005.47416.even.rouault@spatialys.com>

Le jeudi 14 janvier 2016 19:54:32, Jeff McKenna a écrit :
> Hi all!
> 
> With today's trunk, I'm getting a compile error, during linking, with
> Windows visual studio 2008:
> 
> ***
> Creating library gdal_i.lib and object gdal_i.exp
> nitfwritejpeg_12.obj : error LNK2001: unresolved external symbol "void
> __cdecl jpeg_vsiio_
> dest_12(struct jpeg_compress_struct12 *,struct _iobuf *)"
> (?jpeg_vsiio_dest_12@@YAXPAUjpeg
> _compress_struct12@@PAU_iobuf@@@Z)
> ***
> 
> The problem line seems to be in nitfwritejpeg_12.cpp on the 4th line:
> https://trac.osgeo.org/gdal/browser/trunk/gdal/frmts/nitf/nitfwritejpeg_12.
> cpp#L4
> 
> This line seems to have been added during a change a few weeks ago with
> the comment "Fix One Definition Rule violations"
> https://trac.osgeo.org/gdal/changeset/32062/#file8
> 
> I'm not sure if this is relevant, but my builds use libjpeg-9a
> 
> Please let me know if you have any ideas, thanks,

Jeff,

is this is a fresh checkout / clean build ?

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jmckenna at gatewaygeomatics.com  Thu Jan 14 11:04:02 2016
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Thu, 14 Jan 2016 15:04:02 -0400
Subject: [gdal-dev] Error compiling trunk (nitf)
In-Reply-To: <201601142005.47416.even.rouault@spatialys.com>
References: <5697EEE8.7020000@gatewaygeomatics.com>
 <201601142005.47416.even.rouault@spatialys.com>
Message-ID: <5697F122.40006@gatewaygeomatics.com>

On 2016-01-14 3:05 PM, Even Rouault wrote:
> Le jeudi 14 janvier 2016 19:54:32, Jeff McKenna a écrit :
>> Hi all!
>>
>> With today's trunk, I'm getting a compile error, during linking, with
>> Windows visual studio 2008:
>>
>> ***
>> Creating library gdal_i.lib and object gdal_i.exp
>> nitfwritejpeg_12.obj : error LNK2001: unresolved external symbol "void
>> __cdecl jpeg_vsiio_
>> dest_12(struct jpeg_compress_struct12 *,struct _iobuf *)"
>> (?jpeg_vsiio_dest_12@@YAXPAUjpeg
>> _compress_struct12@@PAU_iobuf@@@Z)
>> ***
>>
>> The problem line seems to be in nitfwritejpeg_12.cpp on the 4th line:
>> https://trac.osgeo.org/gdal/browser/trunk/gdal/frmts/nitf/nitfwritejpeg_12.
>> cpp#L4
>>
>> This line seems to have been added during a change a few weeks ago with
>> the comment "Fix One Definition Rule violations"
>> https://trac.osgeo.org/gdal/changeset/32062/#file8
>>
>> I'm not sure if this is relevant, but my builds use libjpeg-9a
>>
>> Please let me know if you have any ideas, thanks,
>
> Jeff,
>
> is this is a fresh checkout / clean build ?
>
> Even
>

Yes very fresh, when I first got this error I deleted the old 
checkout/folder and did an "svn co" with a fresh new copy.

-jeff


-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/




From even.rouault at spatialys.com  Thu Jan 14 11:14:01 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 14 Jan 2016 20:14:01 +0100
Subject: [gdal-dev] Error compiling trunk (nitf)
In-Reply-To: <5697F122.40006@gatewaygeomatics.com>
References: <5697EEE8.7020000@gatewaygeomatics.com>
 <201601142005.47416.even.rouault@spatialys.com>
 <5697F122.40006@gatewaygeomatics.com>
Message-ID: <201601142014.01927.even.rouault@spatialys.com>

Le jeudi 14 janvier 2016 20:04:02, Jeff McKenna a écrit :
> On 2016-01-14 3:05 PM, Even Rouault wrote:
> > Le jeudi 14 janvier 2016 19:54:32, Jeff McKenna a écrit :
> >> Hi all!
> >> 
> >> With today's trunk, I'm getting a compile error, during linking, with
> >> Windows visual studio 2008:
> >> 
> >> ***
> >> Creating library gdal_i.lib and object gdal_i.exp
> >> nitfwritejpeg_12.obj : error LNK2001: unresolved external symbol "void
> >> __cdecl jpeg_vsiio_
> >> dest_12(struct jpeg_compress_struct12 *,struct _iobuf *)"
> >> (?jpeg_vsiio_dest_12@@YAXPAUjpeg
> >> _compress_struct12@@PAU_iobuf@@@Z)
> >> ***
> >> 
> >> The problem line seems to be in nitfwritejpeg_12.cpp on the 4th line:
> >> https://trac.osgeo.org/gdal/browser/trunk/gdal/frmts/nitf/nitfwritejpeg_
> >> 12. cpp#L4
> >> 
> >> This line seems to have been added during a change a few weeks ago with
> >> the comment "Fix One Definition Rule violations"
> >> https://trac.osgeo.org/gdal/changeset/32062/#file8
> >> 
> >> I'm not sure if this is relevant, but my builds use libjpeg-9a
> >> 
> >> Please let me know if you have any ideas, thanks,
> > 
> > Jeff,
> > 
> > is this is a fresh checkout / clean build ?
> > 
> > Even
> 
> Yes very fresh, when I first got this error I deleted the old
> checkout/folder and did an "svn co" with a fresh new copy.

Mmm, could you share your precompiled libjpeg-9a includes, .lib and .dll and 
your nmake.opt ?
Our appveyor bots use internal libjpeg-6b and Tamas builds external libjpeg-6b 
apparently.

> 
> -jeff

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Jan 14 11:47:48 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 14 Jan 2016 20:47:48 +0100
Subject: [gdal-dev] Error compiling trunk (nitf)
In-Reply-To: <201601142014.01927.even.rouault@spatialys.com>
References: <5697EEE8.7020000@gatewaygeomatics.com>
 <5697F122.40006@gatewaygeomatics.com>
 <201601142014.01927.even.rouault@spatialys.com>
Message-ID: <201601142047.48433.even.rouault@spatialys.com>

Le jeudi 14 janvier 2016 20:14:01, Even Rouault a écrit :
> Le jeudi 14 janvier 2016 20:04:02, Jeff McKenna a écrit :
> > On 2016-01-14 3:05 PM, Even Rouault wrote:
> > > Le jeudi 14 janvier 2016 19:54:32, Jeff McKenna a écrit :
> > >> Hi all!
> > >> 
> > >> With today's trunk, I'm getting a compile error, during linking, with
> > >> Windows visual studio 2008:
> > >> 
> > >> ***
> > >> Creating library gdal_i.lib and object gdal_i.exp
> > >> nitfwritejpeg_12.obj : error LNK2001: unresolved external symbol "void
> > >> __cdecl jpeg_vsiio_
> > >> dest_12(struct jpeg_compress_struct12 *,struct _iobuf *)"
> > >> (?jpeg_vsiio_dest_12@@YAXPAUjpeg
> > >> _compress_struct12@@PAU_iobuf@@@Z)
> > >> ***
> > >> 
> > >> The problem line seems to be in nitfwritejpeg_12.cpp on the 4th line:
> > >> https://trac.osgeo.org/gdal/browser/trunk/gdal/frmts/nitf/nitfwritejpe
> > >> g_ 12. cpp#L4
> > >> 
> > >> This line seems to have been added during a change a few weeks ago
> > >> with the comment "Fix One Definition Rule violations"
> > >> https://trac.osgeo.org/gdal/changeset/32062/#file8
> > >> 
> > >> I'm not sure if this is relevant, but my builds use libjpeg-9a
> > >> 
> > >> Please let me know if you have any ideas, thanks,
> > > 
> > > Jeff,
> > > 
> > > is this is a fresh checkout / clean build ?
> > > 
> > > Even
> > 
> > Yes very fresh, when I first got this error I deleted the old
> > checkout/folder and did an "svn co" with a fresh new copy.
> 
> Mmm, could you share your precompiled libjpeg-9a includes, .lib and .dll
> and your nmake.opt ?
> Our appveyor bots use internal libjpeg-6b and Tamas builds external
> libjpeg-6b apparently.

Hum actually thinking about this and trying on Linux...

I don't get build errors on Linux but at runtime this doesn't work properly 
(12bit JPEG not working) due to the mix of ABI between internal libjpeg-6b 
used for jpeg 12bit and external libjpeg-9a for jpeg 8bit (they have 
incompatible ABI). This also holds true for GDAL 2.0 (just checked) and older 
versions.

Such a mix could theoretically be supported but would require annoying changes 
to the build system to make sure that source files using jpeg 8bit only include 
headers of the external libjpeg, and source files using jpeg 12bit only use the 
internal libjpeg... Currently NITF/GTiff will probably use the headers of 
external libjpeg even for jpeg 12 bit (they should use the headers of the 
internal libjpeg), so chaos will happen.

So for now, your choice is :
1) use libjpeg-6b, internal or external (or something with a compatible ABI 
like libjpeg-turbo which has nice speedup optimizations)
2) or use external libjpeg > 6b and disable jpeg12 bit support. So 
comment/disable JPEG12_SUPPORTED = 1 in nmake.opt

I guess my change now exhibits the fact that the mix of different libjpeg is 
incompatible (although I'm not completely clear why you get it. Perhaps the 
struct jpeg_compress_struct12 being not the same when internal libjpeg12 is 
compiled and when it is used by the NITF driver), whereas previously it was 
somewhat hidden.


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jmckenna at gatewaygeomatics.com  Thu Jan 14 11:45:49 2016
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Thu, 14 Jan 2016 15:45:49 -0400
Subject: [gdal-dev] Error compiling trunk (nitf)
In-Reply-To: <201601142014.01927.even.rouault@spatialys.com>
References: <5697EEE8.7020000@gatewaygeomatics.com>
 <201601142005.47416.even.rouault@spatialys.com>
 <5697F122.40006@gatewaygeomatics.com>
 <201601142014.01927.even.rouault@spatialys.com>
Message-ID: <5697FAED.4030808@gatewaygeomatics.com>

On 2016-01-14 3:14 PM, Even Rouault wrote:
> Le jeudi 14 janvier 2016 20:04:02, Jeff McKenna a écrit :
>> On 2016-01-14 3:05 PM, Even Rouault wrote:
>>> Le jeudi 14 janvier 2016 19:54:32, Jeff McKenna a écrit :
>>>> Hi all!
>>>>
>>>> With today's trunk, I'm getting a compile error, during linking, with
>>>> Windows visual studio 2008:
>>>>
>>>> ***
>>>> Creating library gdal_i.lib and object gdal_i.exp
>>>> nitfwritejpeg_12.obj : error LNK2001: unresolved external symbol "void
>>>> __cdecl jpeg_vsiio_
>>>> dest_12(struct jpeg_compress_struct12 *,struct _iobuf *)"
>>>> (?jpeg_vsiio_dest_12@@YAXPAUjpeg
>>>> _compress_struct12@@PAU_iobuf@@@Z)
>>>> ***
>>>>
>>>> The problem line seems to be in nitfwritejpeg_12.cpp on the 4th line:
>>>> https://trac.osgeo.org/gdal/browser/trunk/gdal/frmts/nitf/nitfwritejpeg_
>>>> 12. cpp#L4
>>>>
>>>> This line seems to have been added during a change a few weeks ago with
>>>> the comment "Fix One Definition Rule violations"
>>>> https://trac.osgeo.org/gdal/changeset/32062/#file8
>>>>
>>>> I'm not sure if this is relevant, but my builds use libjpeg-9a
>>>>
>>>> Please let me know if you have any ideas, thanks,
>>>
>>> Jeff,
>>>
>>> is this is a fresh checkout / clean build ?
>>>
>>> Even
>>
>> Yes very fresh, when I first got this error I deleted the old
>> checkout/folder and did an "svn co" with a fresh new copy.
>
> Mmm, could you share your precompiled libjpeg-9a includes, .lib and .dll and
> your nmake.opt ?
> Our appveyor bots use internal libjpeg-6b and Tamas builds external libjpeg-6b
> apparently.
>

Ah, darn version issues (I just assumed that since libjpeg-9a has been 
out since 2014 we were all using it).

Digging deeper, I notice that this code is triggered by a 
"JPEG12_SUPPORTED" parameter, which I have been setting for years in my 
nmake.opt   Disabling that solves this problem for now :)

-jeff



-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/




From jmckenna at gatewaygeomatics.com  Thu Jan 14 11:48:47 2016
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Thu, 14 Jan 2016 15:48:47 -0400
Subject: [gdal-dev] Error compiling trunk (nitf)
In-Reply-To: <201601142047.48433.even.rouault@spatialys.com>
References: <5697EEE8.7020000@gatewaygeomatics.com>
 <5697F122.40006@gatewaygeomatics.com>
 <201601142014.01927.even.rouault@spatialys.com>
 <201601142047.48433.even.rouault@spatialys.com>
Message-ID: <5697FB9F.1040303@gatewaygeomatics.com>

On 2016-01-14 3:47 PM, Even Rouault wrote:
> Le jeudi 14 janvier 2016 20:14:01, Even Rouault a écrit :
>> Le jeudi 14 janvier 2016 20:04:02, Jeff McKenna a écrit :
>>> On 2016-01-14 3:05 PM, Even Rouault wrote:
>>>> Le jeudi 14 janvier 2016 19:54:32, Jeff McKenna a écrit :
>>>>> Hi all!
>>>>>
>>>>> With today's trunk, I'm getting a compile error, during linking, with
>>>>> Windows visual studio 2008:
>>>>>
>>>>> ***
>>>>> Creating library gdal_i.lib and object gdal_i.exp
>>>>> nitfwritejpeg_12.obj : error LNK2001: unresolved external symbol "void
>>>>> __cdecl jpeg_vsiio_
>>>>> dest_12(struct jpeg_compress_struct12 *,struct _iobuf *)"
>>>>> (?jpeg_vsiio_dest_12@@YAXPAUjpeg
>>>>> _compress_struct12@@PAU_iobuf@@@Z)
>>>>> ***
>>>>>
>>>>> The problem line seems to be in nitfwritejpeg_12.cpp on the 4th line:
>>>>> https://trac.osgeo.org/gdal/browser/trunk/gdal/frmts/nitf/nitfwritejpe
>>>>> g_ 12. cpp#L4
>>>>>
>>>>> This line seems to have been added during a change a few weeks ago
>>>>> with the comment "Fix One Definition Rule violations"
>>>>> https://trac.osgeo.org/gdal/changeset/32062/#file8
>>>>>
>>>>> I'm not sure if this is relevant, but my builds use libjpeg-9a
>>>>>
>>>>> Please let me know if you have any ideas, thanks,
>>>>
>>>> Jeff,
>>>>
>>>> is this is a fresh checkout / clean build ?
>>>>
>>>> Even
>>>
>>> Yes very fresh, when I first got this error I deleted the old
>>> checkout/folder and did an "svn co" with a fresh new copy.
>>
>> Mmm, could you share your precompiled libjpeg-9a includes, .lib and .dll
>> and your nmake.opt ?
>> Our appveyor bots use internal libjpeg-6b and Tamas builds external
>> libjpeg-6b apparently.
>
> Hum actually thinking about this and trying on Linux...
>
> I don't get build errors on Linux but at runtime this doesn't work properly
> (12bit JPEG not working) due to the mix of ABI between internal libjpeg-6b
> used for jpeg 12bit and external libjpeg-9a for jpeg 8bit (they have
> incompatible ABI). This also holds true for GDAL 2.0 (just checked) and older
> versions.
>
> Such a mix could theoretically be supported but would require annoying changes
> to the build system to make sure that source files using jpeg 8bit only include
> headers of the external libjpeg, and source files using jpeg 12bit only use the
> internal libjpeg... Currently NITF/GTiff will probably use the headers of
> external libjpeg even for jpeg 12 bit (they should use the headers of the
> internal libjpeg), so chaos will happen.
>
> So for now, your choice is :
> 1) use libjpeg-6b, internal or external (or something with a compatible ABI
> like libjpeg-turbo which has nice speedup optimizations)
> 2) or use external libjpeg > 6b and disable jpeg12 bit support. So
> comment/disable JPEG12_SUPPORTED = 1 in nmake.opt
>
> I guess my change now exhibits the fact that the mix of different libjpeg is
> incompatible (although I'm not completely clear why you get it. Perhaps the
> struct jpeg_compress_struct12 being not the same when internal libjpeg12 is
> compiled and when it is used by the NITF driver), whereas previously it was
> somewhat hidden.
>
>

Oh thanks Even, makes sense, and my guess at option2 was right :) 
Thanks again for checking this.

-jeff


-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/



From even.rouault at spatialys.com  Thu Jan 14 12:11:38 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 14 Jan 2016 21:11:38 +0100
Subject: [gdal-dev] Error compiling trunk (nitf)
In-Reply-To: <5697FAED.4030808@gatewaygeomatics.com>
References: <5697EEE8.7020000@gatewaygeomatics.com>
 <201601142014.01927.even.rouault@spatialys.com>
 <5697FAED.4030808@gatewaygeomatics.com>
Message-ID: <201601142111.38774.even.rouault@spatialys.com>

Le jeudi 14 janvier 2016 20:45:49, Jeff McKenna a écrit :
> On 2016-01-14 3:14 PM, Even Rouault wrote:
> > Le jeudi 14 janvier 2016 20:04:02, Jeff McKenna a écrit :
> >> On 2016-01-14 3:05 PM, Even Rouault wrote:
> >>> Le jeudi 14 janvier 2016 19:54:32, Jeff McKenna a écrit :
> >>>> Hi all!
> >>>> 
> >>>> With today's trunk, I'm getting a compile error, during linking, with
> >>>> Windows visual studio 2008:
> >>>> 
> >>>> ***
> >>>> Creating library gdal_i.lib and object gdal_i.exp
> >>>> nitfwritejpeg_12.obj : error LNK2001: unresolved external symbol "void
> >>>> __cdecl jpeg_vsiio_
> >>>> dest_12(struct jpeg_compress_struct12 *,struct _iobuf *)"
> >>>> (?jpeg_vsiio_dest_12@@YAXPAUjpeg
> >>>> _compress_struct12@@PAU_iobuf@@@Z)
> >>>> ***
> >>>> 
> >>>> The problem line seems to be in nitfwritejpeg_12.cpp on the 4th line:
> >>>> https://trac.osgeo.org/gdal/browser/trunk/gdal/frmts/nitf/nitfwritejpe
> >>>> g_ 12. cpp#L4
> >>>> 
> >>>> This line seems to have been added during a change a few weeks ago
> >>>> with the comment "Fix One Definition Rule violations"
> >>>> https://trac.osgeo.org/gdal/changeset/32062/#file8
> >>>> 
> >>>> I'm not sure if this is relevant, but my builds use libjpeg-9a
> >>>> 
> >>>> Please let me know if you have any ideas, thanks,
> >>> 
> >>> Jeff,
> >>> 
> >>> is this is a fresh checkout / clean build ?
> >>> 
> >>> Even
> >> 
> >> Yes very fresh, when I first got this error I deleted the old
> >> checkout/folder and did an "svn co" with a fresh new copy.
> > 
> > Mmm, could you share your precompiled libjpeg-9a includes, .lib and .dll
> > and your nmake.opt ?
> > Our appveyor bots use internal libjpeg-6b and Tamas builds external
> > libjpeg-6b apparently.
> 
> Ah, darn version issues (I just assumed that since libjpeg-9a has been
> out since 2014 we were all using it).

Not really. I see that recent Ubuntu versions use libjpeg-turbo with IJG 8c 
ABI compatibility (libjpeg-turbo can emulated 6b, 7x and 8x ABI depending on 
how you compile it). libjpeg-turbo explicitly refuses the new capabilities/ABI 
of IJG libjpeg-9a ( detailed at http://www.libjpeg-turbo.org/About/Jpeg-9 )

On Linux, GDAL works well on Ubuntu Trusty with its libjpeg-turbo with IJG 8c 
compatibility ABI and its internal 12bit 6b. This is probably a bit of luck...

> 
> Digging deeper, I notice that this code is triggered by a
> "JPEG12_SUPPORTED" parameter, which I have been setting for years in my
> nmake.opt   Disabling that solves this problem for now :)

You will loose JPEG-12 in GeoTIFF and NITF, but those are quite niche features 
admitedly. On the other side, the new features (lossless SmartScale 
compression) brought by libjpeg-9a are even more niche ! libjpeg-turbo, 
especially for its speedups for compression/decompression, would certainly be 
a better fit for MapServer use cases.

> 
> -jeff

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From aborruso at gmail.com  Thu Jan 14 14:33:10 2016
From: aborruso at gmail.com (aborruso)
Date: Thu, 14 Jan 2016 14:33:10 -0800 (PST)
Subject: [gdal-dev] Impossible to read wkbLineString25D geometry extent
Message-ID: <1452810790525-5245452.post@n6.nabble.com>

Hi,
I have this CSV file:
WKT,id
"LINESTRINGZ (345033.07756361004 4221015.5546970163 50,330734.94084110629
4207332.313714385 50,331946.96878985036 4199477.8127947021
50,344424.26383262046 4197025.7027728558 50,351619.95001382299
4206318.4892121488 50,356988.82880540413 4212298.2940350361
50,354468.15432001976 4216289.6423741328 50,350024.21689256333
4219101.5936986133 50)",1

And this virtual file:
<OGRVRTDataSource>
    <OGRVRTLayer name="toto">
       <SrcDataSource>toto.csv</SrcDataSource>
      <GeometryType>wkbLineString25D</GeometryType>
 <LayerSRS>PROJCS["WGS 84 / UTM zone 33N",GEOGCS["WGS
84",DATUM["WGS_1984",SPHEROID["WGS
84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4326"]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",15],PARAMETER["scale_factor",0.9996],PARAMETER["false_easting",500000],PARAMETER["false_northing",0],UNIT["metre",1,AUTHORITY["EPSG","9001"]],AXIS["Easting",EAST],AXIS["Northing",NORTH],AUTHORITY["EPSG","32633"]]</LayerSRS>
 <GeometryField encoding="WKT" field='WKT' > </GeometryField >
     </OGRVRTLayer>
</OGRVRTDataSource>

When I run "ogrinfo myfile.vrt toto", I have no extent in the output. Is it
normal?

Thank you,

andy



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Impossible-to-read-wkbLineString25D-geometry-extent-tp5245452.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Thu Jan 14 14:59:02 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 14 Jan 2016 23:59:02 +0100
Subject: [gdal-dev] Impossible to read wkbLineString25D geometry extent
In-Reply-To: <1452810790525-5245452.post@n6.nabble.com>
References: <1452810790525-5245452.post@n6.nabble.com>
Message-ID: <201601142359.02916.even.rouault@spatialys.com>

Le jeudi 14 janvier 2016 23:33:10, aborruso a écrit :
> Hi,
> I have this CSV file:
> WKT,id
> "LINESTRINGZ (345033.07756361004 4221015.5546970163 50,330734.94084110629
> 4207332.313714385 50,331946.96878985036 4199477.8127947021
> 50,344424.26383262046 4197025.7027728558 50,351619.95001382299
> 4206318.4892121488 50,356988.82880540413 4212298.2940350361
> 50,354468.15432001976 4216289.6423741328 50,350024.21689256333
> 4219101.5936986133 50)",1

Use LINESTRING Z (with a space). I don't think LINESTRINGZ is valid WKT.

> 
> And this virtual file:
> <OGRVRTDataSource>
>     <OGRVRTLayer name="toto">
>        <SrcDataSource>toto.csv</SrcDataSource>
>       <GeometryType>wkbLineString25D</GeometryType>
>  <LayerSRS>PROJCS["WGS 84 / UTM zone 33N",GEOGCS["WGS
> 84",DATUM["WGS_1984",SPHEROID["WGS
> 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"
> ]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.017453292
> 5199433,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4326"]],PROJECTION["Tra
> nsverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_mer
> idian",15],PARAMETER["scale_factor",0.9996],PARAMETER["false_easting",50000
> 0],PARAMETER["false_northing",0],UNIT["metre",1,AUTHORITY["EPSG","9001"]],A
> XIS["Easting",EAST],AXIS["Northing",NORTH],AUTHORITY["EPSG","32633"]]</Laye
> rSRS> <GeometryField encoding="WKT" field='WKT' > </GeometryField >
>      </OGRVRTLayer>
> </OGRVRTDataSource>
> 
> When I run "ogrinfo myfile.vrt toto", I have no extent in the output. Is it
> normal?
> 
> Thank you,
> 
> andy
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/Impossible-to-read-wkbLineString25D-ge
> ometry-extent-tp5245452.html Sent from the GDAL - Dev mailing list archive
> at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From aborruso at gmail.com  Thu Jan 14 14:44:44 2016
From: aborruso at gmail.com (aborruso)
Date: Thu, 14 Jan 2016 14:44:44 -0800 (PST)
Subject: [gdal-dev] Impossible to read wkbLineString25D geometry extent
In-Reply-To: <201601142359.02916.even.rouault@spatialys.com>
References: <1452810790525-5245452.post@n6.nabble.com>
 <201601142359.02916.even.rouault@spatialys.com>
Message-ID: <1452811484647-5245460.post@n6.nabble.com>

Even Rouault-2 wrote
> Use LINESTRING Z (with a space). I don't think LINESTRINGZ is valid WKT.

I'm really stupid :)

Thank you very much



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Impossible-to-read-wkbLineString25D-geometry-extent-tp5245452p5245460.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From sfkeller at gmail.com  Fri Jan 15 03:46:33 2016
From: sfkeller at gmail.com (Stefan Keller)
Date: Fri, 15 Jan 2016 12:46:33 +0100
Subject: [gdal-dev] GDAL_WMS/TMS with local CRS and bbox problem
Message-ID: <CAFcOn2_ssAne5wCASvGbA4tW98FX3Ej=oh5ZcFUdsXL7df=mzA@mail.gmail.com>

Hi

I have a GDAL .vrt from a GDAL_WMS/TMS which was tweaked to
projection/CRS EPSG:21781 [see below *].

The problem here is, that the bbox is way too large. It should be
Switzerland but it's larger than europe. (in 21781 it's lowerleftX
480000 loverleft Y 70000 upperrightX 840000 upperrightY 300000)

How can I configure the correct bbox in the .vrt?
Or is this a problem at server side config. (http://tile.osm.ch/21781/)?
In fact I'm wondering anyhow about these current UpperLeftX/UpperLeftY
numbers...(which somehow work)?

:Stefan


<GDAL_WMS>
  <Service name="TMS">
    <ServerUrl>http://tile.osm.ch/21781/${z}/${x}/${y}.png</ServerUrl>
  </Service>
  <DataWindow>
    <UpperLeftX>-20037508.34</UpperLeftX>
    <UpperLeftY>20037508.34</UpperLeftY>
    <LowerRightX>20037508.34</LowerRightX>
    <LowerRightY>-20037508.34</LowerRightY>
    <TileLevel>18</TileLevel>
    <TileCountX>1</TileCountX>
    <TileCountY>1</TileCountY>
    <YOrigin>top</YOrigin>
  </DataWindow>
  <Projection>EPSG:21781</Projection>
  <BlockSizeX>256</BlockSizeX>
  <BlockSizeY>256</BlockSizeY>
  <BandsCount>3</BandsCount>
  <Cache />
</GDAL_WMS>

From andre+joost at nurfuerspam.de  Fri Jan 15 03:56:26 2016
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Fri, 15 Jan 2016 12:56:26 +0100
Subject: [gdal-dev] GDAL_WMS/TMS with local CRS and bbox problem
In-Reply-To: <CAFcOn2_ssAne5wCASvGbA4tW98FX3Ej=oh5ZcFUdsXL7df=mzA@mail.gmail.com>
References: <CAFcOn2_ssAne5wCASvGbA4tW98FX3Ej=oh5ZcFUdsXL7df=mzA@mail.gmail.com>
Message-ID: <n7ampe$uhn$1@ger.gmane.org>

Am 15.01.2016 um 12:46 schrieb Stefan Keller:
> Hi
>
> I have a GDAL .vrt from a GDAL_WMS/TMS which was tweaked to
> projection/CRS EPSG:21781 [see below *].
>
> The problem here is, that the bbox is way too large. It should be
> Switzerland but it's larger than europe. (in 21781 it's lowerleftX
> 480000 loverleft Y 70000 upperrightX 840000 upperrightY 300000)
>
> How can I configure the correct bbox in the .vrt?
> Or is this a problem at server side config. (http://tile.osm.ch/21781/)?
> In fact I'm wondering anyhow about these current UpperLeftX/UpperLeftY
> numbers...(which somehow work)?
>
> :Stefan
>
>
> <GDAL_WMS>
>    <Service name="TMS">
>      <ServerUrl>http://tile.osm.ch/21781/${z}/${x}/${y}.png</ServerUrl>
>    </Service>
>    <DataWindow>
>      <UpperLeftX>-20037508.34</UpperLeftX>
>      <UpperLeftY>20037508.34</UpperLeftY>
>      <LowerRightX>20037508.34</LowerRightX>
>      <LowerRightY>-20037508.34</LowerRightY>

Those values are the worldwide bounds for EPSG:3857.

If you look at tile http://tile.osm.ch/21781/0/0/0.png, you see half of 
the world (without the americas). The bbox for Switzerland can be set 
smaller indeed.

HTH,
André Joost


From even.rouault at spatialys.com  Fri Jan 15 04:04:27 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 15 Jan 2016 13:04:27 +0100
Subject: [gdal-dev] GDAL_WMS/TMS with local CRS and bbox problem
In-Reply-To: <CAFcOn2_ssAne5wCASvGbA4tW98FX3Ej=oh5ZcFUdsXL7df=mzA@mail.gmail.com>
References: <CAFcOn2_ssAne5wCASvGbA4tW98FX3Ej=oh5ZcFUdsXL7df=mzA@mail.gmail.com>
Message-ID: <201601151304.28037.even.rouault@spatialys.com>

Le vendredi 15 janvier 2016 12:46:33, Stefan Keller a écrit :
> Hi
> 
> I have a GDAL .vrt from a GDAL_WMS/TMS which was tweaked to
> projection/CRS EPSG:21781 [see below *].
> 
> The problem here is, that the bbox is way too large. It should be
> Switzerland but it's larger than europe. (in 21781 it's lowerleftX
> 480000 loverleft Y 70000 upperrightX 840000 upperrightY 300000)
> 
> How can I configure the correct bbox in the .vrt?
> Or is this a problem at server side config. (http://tile.osm.ch/21781/)?
> In fact I'm wondering anyhow about these current UpperLeftX/UpperLeftY
> numbers...(which somehow work)?

You have to figure out/find somewhere what is the extent at zoom level 0 in 
EPSG:21781 (thus representing a large part of the world) and put it in the 
GDAL_WMS definition.

Then you can create a view on Switzerland with gdal_translate -srcwin -of VRT.

> 
> :Stefan
> 
> <GDAL_WMS>
>   <Service name="TMS">
>     <ServerUrl>http://tile.osm.ch/21781/${z}/${x}/${y}.png</ServerUrl>
>   </Service>
>   <DataWindow>
>     <UpperLeftX>-20037508.34</UpperLeftX>
>     <UpperLeftY>20037508.34</UpperLeftY>
>     <LowerRightX>20037508.34</LowerRightX>
>     <LowerRightY>-20037508.34</LowerRightY>
>     <TileLevel>18</TileLevel>
>     <TileCountX>1</TileCountX>
>     <TileCountY>1</TileCountY>
>     <YOrigin>top</YOrigin>
>   </DataWindow>
>   <Projection>EPSG:21781</Projection>
>   <BlockSizeX>256</BlockSizeX>
>   <BlockSizeY>256</BlockSizeY>
>   <BandsCount>3</BandsCount>
>   <Cache />
> </GDAL_WMS>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Jan 15 06:11:48 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 15 Jan 2016 15:11:48 +0100
Subject: [gdal-dev] GDAL 2.1 release plans
Message-ID: <201601151511.48676.even.rouault@spatialys.com>

Hi,

As I've received lately a few emails asking me about GDAL 2.1, it's time to 
discuss that publicly.

To keep roughly with our yearly cycle, I think we could probably target a beta 
1 for the beginning of April, with possibly the release happening end 
April/beginning May if things go well (optimistic scenario : 3 weeks for betas 
+ 1 week RCs).

Opinions ? Any candidate for being release manager ?

Cheers,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From sfkeller at gmail.com  Fri Jan 15 06:34:45 2016
From: sfkeller at gmail.com (Stefan Keller)
Date: Fri, 15 Jan 2016 15:34:45 +0100
Subject: [gdal-dev] GDAL_WMS/TMS with local CRS and bbox problem
In-Reply-To: <201601151304.28037.even.rouault@spatialys.com>
References: <CAFcOn2_ssAne5wCASvGbA4tW98FX3Ej=oh5ZcFUdsXL7df=mzA@mail.gmail.com>
 <201601151304.28037.even.rouault@spatialys.com>
Message-ID: <CAFcOn29Zk=VK0BZEM7=HiKLbih-_9aQMfH5FirwEMDyaSz9EnQ@mail.gmail.com>

Thanks, Even and Andre!
:S

2016-01-15 13:04 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:
> Le vendredi 15 janvier 2016 12:46:33, Stefan Keller a écrit :
>> Hi
>>
>> I have a GDAL .vrt from a GDAL_WMS/TMS which was tweaked to
>> projection/CRS EPSG:21781 [see below *].
>>
>> The problem here is, that the bbox is way too large. It should be
>> Switzerland but it's larger than europe. (in 21781 it's lowerleftX
>> 480000 loverleft Y 70000 upperrightX 840000 upperrightY 300000)
>>
>> How can I configure the correct bbox in the .vrt?
>> Or is this a problem at server side config. (http://tile.osm.ch/21781/)?
>> In fact I'm wondering anyhow about these current UpperLeftX/UpperLeftY
>> numbers...(which somehow work)?
>
> You have to figure out/find somewhere what is the extent at zoom level 0 in
> EPSG:21781 (thus representing a large part of the world) and put it in the
> GDAL_WMS definition.
>
> Then you can create a view on Switzerland with gdal_translate -srcwin -of VRT.
>
>>
>> :Stefan
>>
>> <GDAL_WMS>
>>   <Service name="TMS">
>>     <ServerUrl>http://tile.osm.ch/21781/${z}/${x}/${y}.png</ServerUrl>
>>   </Service>
>>   <DataWindow>
>>     <UpperLeftX>-20037508.34</UpperLeftX>
>>     <UpperLeftY>20037508.34</UpperLeftY>
>>     <LowerRightX>20037508.34</LowerRightX>
>>     <LowerRightY>-20037508.34</LowerRightY>
>>     <TileLevel>18</TileLevel>
>>     <TileCountX>1</TileCountX>
>>     <TileCountY>1</TileCountY>
>>     <YOrigin>top</YOrigin>
>>   </DataWindow>
>>   <Projection>EPSG:21781</Projection>
>>   <BlockSizeX>256</BlockSizeX>
>>   <BlockSizeY>256</BlockSizeY>
>>   <BandsCount>3</BandsCount>
>>   <Cache />
>> </GDAL_WMS>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com

From nguler at jlab.org  Sat Jan 16 16:41:39 2016
From: nguler at jlab.org (Nevzat Guler)
Date: Sat, 16 Jan 2016 19:41:39 -0500
Subject: [gdal-dev] map info and projections from GeoTIFF file to create
	ENVI header
In-Reply-To: <002301d14feb$c6a0c970$53e25c50$@spectral.com>
References: <001c01d14fa8$989e5b70$c9db1250$@spectral.com>
 <002301d14feb$c6a0c970$53e25c50$@spectral.com>
Message-ID: <005701d150bf$d4c37550$7e4a5ff0$@jlab.org>

Dear experts,

I am reading LANDSAT GeoTIFF files and combining bands to create and ENVI
cube.
I am using GDAL to read the GeoTIFF file, and my own custom cube writer to
write the ENVI style cube. Transferring the map information proved to be a
bit convoluted. I seek your help to figure out this. 

My first problem is to access map info from GeoTIFF file. The map info
includes:

map info = {UTM, 1.000, 1.000, 145185.000, 2189715.000, 3.0000000000e+001,
3.0000000000e+001, 19, North, WGS-84, units=Meters}

I am able to get the location (x,y), and pixel size (x,y) from :
double adfGeoTransform[6];
srcDS->GetGeoTransform(adfGeoTransform);

But, I could not find any way to get the other variables in the string: UTM,
pixel tie points, Unit and DATUM. Is there any way to get them?

Finally, for the Coordinate System String, GDAL gives me:

PROJCS["unnamed",PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_or
igin
",0],PARAMETER["central_meridian",-69],PARAMETER["scale_factor",0.9996],PARA
METE
R["false_easting",500000],PARAMETER["false_northing",0],UNIT["Meter",1]]

But I should actually get

PROJCS["UTM_Zone_19N",GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS
84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],TOWGS84[0,0,0,0,0,0,0],A
UTHO
RITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["de
gree
",0.0174532925199433,AUTHORITY["EPSG","9108"]],AUTHORITY["EPSG","4326"]],PRO
JECT
ION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["cent
ral_
meridian",-69],PARAMETER["scale_factor",0.9996],PARAMETER["false_easting",50
0000
],PARAMETER["false_northing",0],UNIT["Meter",1]]

GDAL gives me PROJCS, "unnamed". And no GEOGCS information is given.  I am
able to get the coordinate system properties by using the following commands
but I first need to set few things to use exportToWTK.

>>       OGRSpatialReference oSRS;
>>       char *pszWKT = NULL;
>>       oSRS.SetProjCS("UTM_Zone_19N");
>>       oSRS.SetWellKnownGeogCS("WGS84");
>>       oSRS.SetUTM(19, TRUE);
>>       oSRS.SetWellKnownGeogCS("WGS84");
>>       oSRS.exportToWkt(&pszWKT);
>>       printf("%s\n", pszWKT);

However, this requires me to set SetProjCS, SetWellKnownGeogCS and SetUTM
first. I don't know these before I read the file. Is there any way to get
them from the file so that I don't need prior knowledge to create the
header. When I pull the GeoTIFF file into ENVI, all these information is
already there. If this list is only or development purposes, please let me
know if there is any other email list that can give me guidance on this
quest.

I appreciate your help and suggestions.
Best regards,
- Nevzat


From bishop.dev at gmail.com  Sun Jan 17 03:56:53 2016
From: bishop.dev at gmail.com (Dmitry Baryshnikov)
Date: Sun, 17 Jan 2016 14:56:53 +0300
Subject: [gdal-dev] map info and projections from GeoTIFF file to create
 ENVI header
In-Reply-To: <005701d150bf$d4c37550$7e4a5ff0$@jlab.org>
References: <001c01d14fa8$989e5b70$c9db1250$@spectral.com>
 <002301d14feb$c6a0c970$53e25c50$@spectral.com>
 <005701d150bf$d4c37550$7e4a5ff0$@jlab.org>
Message-ID: <569B8185.5000206@gmail.com>

Hi Nevzat,

The landsat geotiff already have CRS embeded in file

$ gdalinfo LC80150362013097LGN03_B1.TIF
Driver: GTiff/GeoTIFF
Files: LC80150362013097LGN03_B1.TIF
        ./LC80150362013097LGN03_MTL.txt
Size is 7281, 7261
Coordinate System is:
PROJCS["WGS 84 / UTM zone 17N",
     GEOGCS["WGS 84",
         DATUM["WGS_1984",
             SPHEROID["WGS 84",6378137,298.257223563,
                 AUTHORITY["EPSG","7030"]],
             AUTHORITY["EPSG","6326"]],
         PRIMEM["Greenwich",0,
             AUTHORITY["EPSG","8901"]],
         UNIT["degree",0.0174532925199433,
             AUTHORITY["EPSG","9122"]],
         AUTHORITY["EPSG","4326"]],
     PROJECTION["Transverse_Mercator"],
     PARAMETER["latitude_of_origin",0],
     PARAMETER["central_meridian",-81],
     PARAMETER["scale_factor",0.9996],
     PARAMETER["false_easting",500000],
     PARAMETER["false_northing",0],
     UNIT["metre",1,
         AUTHORITY["EPSG","9001"]],
     AXIS["Easting",EAST],
     AXIS["Northing",NORTH],
     AUTHORITY["EPSG","32617"]]
Origin = (706185.000000000000000,3943515.000000000000000)
Pixel Size = (30.000000000000000,-30.000000000000000)
Metadata:
   AREA_OR_POINT=Point
   METADATATYPE=ODL
Image Structure Metadata:
   INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (  706185.000, 3943515.000) ( 78d43'24.74"W, 35d36'50.15"N)
Lower Left  (  706185.000, 3725685.000) ( 78d46'35.65"W, 33d39' 3.82"N)
Upper Right (  924615.000, 3943515.000) ( 76d19' 2.05"W, 35d32'39.74"N)
Lower Right (  924615.000, 3725685.000) ( 76d25'33.46"W, 33d35'10.99"N)
Center      (  815400.000, 3834600.000) ( 77d33'38.95"W, 34d36'17.35"N)
Band 1 Block=7281x1 Type=UInt16, ColorInterp=Gray

And this is right CRS.
Where do you get you geotiff?

Best regards,
     Dmitry

17.01.2016 03:41, Nevzat Guler пишет:
> Dear experts,
>
> I am reading LANDSAT GeoTIFF files and combining bands to create and ENVI
> cube.
> I am using GDAL to read the GeoTIFF file, and my own custom cube writer to
> write the ENVI style cube. Transferring the map information proved to be a
> bit convoluted. I seek your help to figure out this.
>
> My first problem is to access map info from GeoTIFF file. The map info
> includes:
>
> map info = {UTM, 1.000, 1.000, 145185.000, 2189715.000, 3.0000000000e+001,
> 3.0000000000e+001, 19, North, WGS-84, units=Meters}
>
> I am able to get the location (x,y), and pixel size (x,y) from :
> double adfGeoTransform[6];
> srcDS->GetGeoTransform(adfGeoTransform);
>
> But, I could not find any way to get the other variables in the string: UTM,
> pixel tie points, Unit and DATUM. Is there any way to get them?
>
> Finally, for the Coordinate System String, GDAL gives me:
>
> PROJCS["unnamed",PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_or
> igin
> ",0],PARAMETER["central_meridian",-69],PARAMETER["scale_factor",0.9996],PARA
> METE
> R["false_easting",500000],PARAMETER["false_northing",0],UNIT["Meter",1]]
>
> But I should actually get
>
> PROJCS["UTM_Zone_19N",GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS
> 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],TOWGS84[0,0,0,0,0,0,0],A
> UTHO
> RITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["de
> gree
> ",0.0174532925199433,AUTHORITY["EPSG","9108"]],AUTHORITY["EPSG","4326"]],PRO
> JECT
> ION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["cent
> ral_
> meridian",-69],PARAMETER["scale_factor",0.9996],PARAMETER["false_easting",50
> 0000
> ],PARAMETER["false_northing",0],UNIT["Meter",1]]
>
> GDAL gives me PROJCS, "unnamed". And no GEOGCS information is given.  I am
> able to get the coordinate system properties by using the following commands
> but I first need to set few things to use exportToWTK.
>
>>>        OGRSpatialReference oSRS;
>>>        char *pszWKT = NULL;
>>>        oSRS.SetProjCS("UTM_Zone_19N");
>>>        oSRS.SetWellKnownGeogCS("WGS84");
>>>        oSRS.SetUTM(19, TRUE);
>>>        oSRS.SetWellKnownGeogCS("WGS84");
>>>        oSRS.exportToWkt(&pszWKT);
>>>        printf("%s\n", pszWKT);
> However, this requires me to set SetProjCS, SetWellKnownGeogCS and SetUTM
> first. I don't know these before I read the file. Is there any way to get
> them from the file so that I don't need prior knowledge to create the
> header. When I pull the GeoTIFF file into ENVI, all these information is
> already there. If this list is only or development purposes, please let me
> know if there is any other email list that can give me guidance on this
> quest.
>
> I appreciate your help and suggestions.
> Best regards,
> - Nevzat
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From nguler at jlab.org  Sun Jan 17 09:15:30 2016
From: nguler at jlab.org (Nevzat Guler)
Date: Sun, 17 Jan 2016 12:15:30 -0500
Subject: [gdal-dev] map info and projections from GeoTIFF file to create
	ENVI header
In-Reply-To: <569B8185.5000206@gmail.com>
References: <001c01d14fa8$989e5b70$c9db1250$@spectral.com>
 <002301d14feb$c6a0c970$53e25c50$@spectral.com>
 <005701d150bf$d4c37550$7e4a5ff0$@jlab.org> <569B8185.5000206@gmail.com>
Message-ID: <006301d1514a$abc3ca20$034b5e60$@jlab.org>

Thank you Dmitry,
What is the best way to extract the information we got using gdalinfo.exe by using GDAL classes, within a C++ code? As I mentioned, I am using GetGeoTransform and GetProjectionRef() but the results miss many of the information (specifically the map info elements as I explained in the previous email). 

On another note, I actually get a different output from gdalinfo.exe using my file (please see the printed result below). I got the geotiff file from my colleague. When I open the file with ENVI, I get all the information, including GEOGCS information. 

Can it be that my file is just corrupted and that's why I don't get all the information from GetGeoTransform and GetProjectionRef()? But then how would ENVI is able to extract this information if it were not in the file?

Thanks again, - Nevzat

C:\Cubes\Landsat\LC80080472013174LGN00>gdalinfo LC80080472013174LGN00_B1.TIF
Driver: GTiff/GeoTIFF
Files: LC80080472013174LGN00_B1.TIF
       .\LC80080472013174LGN00_MTL.txt
Size is 7571, 7411
Coordinate System is:
PROJCS["unnamed",
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",-69],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]]]
Origin = (145185.000000000000000,2189715.000000000000000)
Pixel Size = (30.000000000000000,-30.000000000000000)
Metadata:
  AREA_OR_POINT=Point
  METADATATYPE=ODL
Image Structure Metadata:
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (  145185.000, 2189715.000)
Lower Left  (  145185.000, 1967385.000)
Upper Right (  372315.000, 2189715.000)
Lower Right (  372315.000, 1967385.000)
Center      (  258750.000, 2078550.000)
Band 1 Block=7571x1 Type=UInt16, ColorInterp=Gray

-----Original Message-----
From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Dmitry Baryshnikov
Sent: Sunday, January 17, 2016 6:57 AM
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] map info and projections from GeoTIFF file to create ENVI header

Hi Nevzat,

The landsat geotiff already have CRS embeded in file

$ gdalinfo LC80150362013097LGN03_B1.TIF
Driver: GTiff/GeoTIFF
Files: LC80150362013097LGN03_B1.TIF
        ./LC80150362013097LGN03_MTL.txt
Size is 7281, 7261
Coordinate System is:
PROJCS["WGS 84 / UTM zone 17N",
     GEOGCS["WGS 84",
         DATUM["WGS_1984",
             SPHEROID["WGS 84",6378137,298.257223563,
                 AUTHORITY["EPSG","7030"]],
             AUTHORITY["EPSG","6326"]],
         PRIMEM["Greenwich",0,
             AUTHORITY["EPSG","8901"]],
         UNIT["degree",0.0174532925199433,
             AUTHORITY["EPSG","9122"]],
         AUTHORITY["EPSG","4326"]],
     PROJECTION["Transverse_Mercator"],
     PARAMETER["latitude_of_origin",0],
     PARAMETER["central_meridian",-81],
     PARAMETER["scale_factor",0.9996],
     PARAMETER["false_easting",500000],
     PARAMETER["false_northing",0],
     UNIT["metre",1,
         AUTHORITY["EPSG","9001"]],
     AXIS["Easting",EAST],
     AXIS["Northing",NORTH],
     AUTHORITY["EPSG","32617"]]
Origin = (706185.000000000000000,3943515.000000000000000)
Pixel Size = (30.000000000000000,-30.000000000000000)
Metadata:
   AREA_OR_POINT=Point
   METADATATYPE=ODL
Image Structure Metadata:
   INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (  706185.000, 3943515.000) ( 78d43'24.74"W, 35d36'50.15"N) Lower Left  (  706185.000, 3725685.000) ( 78d46'35.65"W, 33d39' 3.82"N) Upper Right (  924615.000, 3943515.000) ( 76d19' 2.05"W, 35d32'39.74"N) Lower Right (  924615.000, 3725685.000) ( 76d25'33.46"W, 33d35'10.99"N)
Center      (  815400.000, 3834600.000) ( 77d33'38.95"W, 34d36'17.35"N)
Band 1 Block=7281x1 Type=UInt16, ColorInterp=Gray

And this is right CRS.
Where do you get you geotiff?

Best regards,
     Dmitry

17.01.2016 03:41, Nevzat Guler пишет:
> Dear experts,
>
> I am reading LANDSAT GeoTIFF files and combining bands to create and 
> ENVI cube.
> I am using GDAL to read the GeoTIFF file, and my own custom cube 
> writer to write the ENVI style cube. Transferring the map information 
> proved to be a bit convoluted. I seek your help to figure out this.
>
> My first problem is to access map info from GeoTIFF file. The map info
> includes:
>
> map info = {UTM, 1.000, 1.000, 145185.000, 2189715.000, 
> 3.0000000000e+001, 3.0000000000e+001, 19, North, WGS-84, units=Meters}
>
> I am able to get the location (x,y), and pixel size (x,y) from :
> double adfGeoTransform[6];
> srcDS->GetGeoTransform(adfGeoTransform);
>
> But, I could not find any way to get the other variables in the 
> string: UTM, pixel tie points, Unit and DATUM. Is there any way to get them?
>
> Finally, for the Coordinate System String, GDAL gives me:
>
> PROJCS["unnamed",PROJECTION["Transverse_Mercator"],PARAMETER["latitude
> _of_or
> igin
> ",0],PARAMETER["central_meridian",-69],PARAMETER["scale_factor",0.9996
> ],PARA
> METE
> R["false_easting",500000],PARAMETER["false_northing",0],UNIT["Meter",1
> ]]
>
> But I should actually get
>
> PROJCS["UTM_Zone_19N",GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS
> 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],TOWGS84[0,0,0,0,0,
> 0,0],A
> UTHO
> RITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UN
> IT["de
> gree
> ",0.0174532925199433,AUTHORITY["EPSG","9108"]],AUTHORITY["EPSG","4326"
> ]],PRO
> JECT
> ION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER
> ["cent
> ral_
> meridian",-69],PARAMETER["scale_factor",0.9996],PARAMETER["false_easti
> ng",50
> 0000
> ],PARAMETER["false_northing",0],UNIT["Meter",1]]
>
> GDAL gives me PROJCS, "unnamed". And no GEOGCS information is given.  
> I am able to get the coordinate system properties by using the 
> following commands but I first need to set few things to use exportToWTK.
>
>>>        OGRSpatialReference oSRS;
>>>        char *pszWKT = NULL;
>>>        oSRS.SetProjCS("UTM_Zone_19N");
>>>        oSRS.SetWellKnownGeogCS("WGS84");
>>>        oSRS.SetUTM(19, TRUE);
>>>        oSRS.SetWellKnownGeogCS("WGS84");
>>>        oSRS.exportToWkt(&pszWKT);
>>>        printf("%s\n", pszWKT);
> However, this requires me to set SetProjCS, SetWellKnownGeogCS and 
> SetUTM first. I don't know these before I read the file. Is there any 
> way to get them from the file so that I don't need prior knowledge to 
> create the header. When I pull the GeoTIFF file into ENVI, all these 
> information is already there. If this list is only or development 
> purposes, please let me know if there is any other email list that can 
> give me guidance on this quest.
>
> I appreciate your help and suggestions.
> Best regards,
> - Nevzat
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev


From bishop.dev at gmail.com  Sun Jan 17 09:56:54 2016
From: bishop.dev at gmail.com (Dmitry Baryshnikov)
Date: Sun, 17 Jan 2016 20:56:54 +0300
Subject: [gdal-dev] map info and projections from GeoTIFF file to create
 ENVI header
In-Reply-To: <006301d1514a$abc3ca20$034b5e60$@jlab.org>
References: <001c01d14fa8$989e5b70$c9db1250$@spectral.com>
 <002301d14feb$c6a0c970$53e25c50$@spectral.com>
 <005701d150bf$d4c37550$7e4a5ff0$@jlab.org> <569B8185.5000206@gmail.com>
 <006301d1514a$abc3ca20$034b5e60$@jlab.org>
Message-ID: <569BD5E6.7020807@gmail.com>

I downloaded this scene from earthexplorer, and everything is fine:

$ gdalinfo LC80080472013174LGN00_B1.TIF
Driver: GTiff/GeoTIFF
Files: LC80080472013174LGN00_B1.TIF
        ./LC80080472013174LGN00_MTL.txt
Size is 7571, 7411
Coordinate System is:
PROJCS["WGS 84 / UTM zone 19N",
     GEOGCS["WGS 84",
         DATUM["WGS_1984",
             SPHEROID["WGS 84",6378137,298.257223563,
                 AUTHORITY["EPSG","7030"]],
             AUTHORITY["EPSG","6326"]],
         PRIMEM["Greenwich",0,
             AUTHORITY["EPSG","8901"]],
         UNIT["degree",0.0174532925199433,
             AUTHORITY["EPSG","9122"]],
         AUTHORITY["EPSG","4326"]],
     PROJECTION["Transverse_Mercator"],
     PARAMETER["latitude_of_origin",0],
     PARAMETER["central_meridian",-69],
     PARAMETER["scale_factor",0.9996],
     PARAMETER["false_easting",500000],
     PARAMETER["false_northing",0],
     UNIT["metre",1,
         AUTHORITY["EPSG","9001"]],
     AXIS["Easting",EAST],
     AXIS["Northing",NORTH],
     AUTHORITY["EPSG","32619"]]
Origin = (145185.000000000000000,2189715.000000000000000)
Pixel Size = (30.000000000000000,-30.000000000000000)
Metadata:
   AREA_OR_POINT=Point
   METADATATYPE=ODL
Image Structure Metadata:
   INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (  145185.000, 2189715.000) ( 72d23' 7.97"W, 19d46'16.43"N)
Lower Left  (  145185.000, 1967385.000) ( 72d20'44.51"W, 17d45'55.15"N)
Upper Right (  372315.000, 2189715.000) ( 70d13' 8.50"W, 19d47'56.92"N)
Lower Right (  372315.000, 1967385.000) ( 70d12'16.74"W, 17d47'24.74"N)
Center      (  258750.000, 2078550.000) ( 71d17'19.50"W, 18d47' 4.68"N)
Band 1 Block=7571x1 Type=UInt16, ColorInterp=Gray

$ gdalinfo --version
GDAL 2.1.0dev, released 2015/99/99

What is your gdal version? Maybe the Landsat geotiff was modified from 
some software?

Best regards,
     Dmitry

17.01.2016 20:15, Nevzat Guler пишет:
> Thank you Dmitry,
> What is the best way to extract the information we got using gdalinfo.exe by using GDAL classes, within a C++ code? As I mentioned, I am using GetGeoTransform and GetProjectionRef() but the results miss many of the information (specifically the map info elements as I explained in the previous email).
>
> On another note, I actually get a different output from gdalinfo.exe using my file (please see the printed result below). I got the geotiff file from my colleague. When I open the file with ENVI, I get all the information, including GEOGCS information.
>
> Can it be that my file is just corrupted and that's why I don't get all the information from GetGeoTransform and GetProjectionRef()? But then how would ENVI is able to extract this information if it were not in the file?
>
> Thanks again, - Nevzat
>
> C:\Cubes\Landsat\LC80080472013174LGN00>gdalinfo LC80080472013174LGN00_B1.TIF
> Driver: GTiff/GeoTIFF
> Files: LC80080472013174LGN00_B1.TIF
>         .\LC80080472013174LGN00_MTL.txt
> Size is 7571, 7411
> Coordinate System is:
> PROJCS["unnamed",
>      PROJECTION["Transverse_Mercator"],
>      PARAMETER["latitude_of_origin",0],
>      PARAMETER["central_meridian",-69],
>      PARAMETER["scale_factor",0.9996],
>      PARAMETER["false_easting",500000],
>      PARAMETER["false_northing",0],
>      UNIT["metre",1,
>          AUTHORITY["EPSG","9001"]]]
> Origin = (145185.000000000000000,2189715.000000000000000)
> Pixel Size = (30.000000000000000,-30.000000000000000)
> Metadata:
>    AREA_OR_POINT=Point
>    METADATATYPE=ODL
> Image Structure Metadata:
>    INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  (  145185.000, 2189715.000)
> Lower Left  (  145185.000, 1967385.000)
> Upper Right (  372315.000, 2189715.000)
> Lower Right (  372315.000, 1967385.000)
> Center      (  258750.000, 2078550.000)
> Band 1 Block=7571x1 Type=UInt16, ColorInterp=Gray
>
> -----Original Message-----
> From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Dmitry Baryshnikov
> Sent: Sunday, January 17, 2016 6:57 AM
> To: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] map info and projections from GeoTIFF file to create ENVI header
>
> Hi Nevzat,
>
> The landsat geotiff already have CRS embeded in file
>
> $ gdalinfo LC80150362013097LGN03_B1.TIF
> Driver: GTiff/GeoTIFF
> Files: LC80150362013097LGN03_B1.TIF
>          ./LC80150362013097LGN03_MTL.txt
> Size is 7281, 7261
> Coordinate System is:
> PROJCS["WGS 84 / UTM zone 17N",
>       GEOGCS["WGS 84",
>           DATUM["WGS_1984",
>               SPHEROID["WGS 84",6378137,298.257223563,
>                   AUTHORITY["EPSG","7030"]],
>               AUTHORITY["EPSG","6326"]],
>           PRIMEM["Greenwich",0,
>               AUTHORITY["EPSG","8901"]],
>           UNIT["degree",0.0174532925199433,
>               AUTHORITY["EPSG","9122"]],
>           AUTHORITY["EPSG","4326"]],
>       PROJECTION["Transverse_Mercator"],
>       PARAMETER["latitude_of_origin",0],
>       PARAMETER["central_meridian",-81],
>       PARAMETER["scale_factor",0.9996],
>       PARAMETER["false_easting",500000],
>       PARAMETER["false_northing",0],
>       UNIT["metre",1,
>           AUTHORITY["EPSG","9001"]],
>       AXIS["Easting",EAST],
>       AXIS["Northing",NORTH],
>       AUTHORITY["EPSG","32617"]]
> Origin = (706185.000000000000000,3943515.000000000000000)
> Pixel Size = (30.000000000000000,-30.000000000000000)
> Metadata:
>     AREA_OR_POINT=Point
>     METADATATYPE=ODL
> Image Structure Metadata:
>     INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  (  706185.000, 3943515.000) ( 78d43'24.74"W, 35d36'50.15"N) Lower Left  (  706185.000, 3725685.000) ( 78d46'35.65"W, 33d39' 3.82"N) Upper Right (  924615.000, 3943515.000) ( 76d19' 2.05"W, 35d32'39.74"N) Lower Right (  924615.000, 3725685.000) ( 76d25'33.46"W, 33d35'10.99"N)
> Center      (  815400.000, 3834600.000) ( 77d33'38.95"W, 34d36'17.35"N)
> Band 1 Block=7281x1 Type=UInt16, ColorInterp=Gray
>
> And this is right CRS.
> Where do you get you geotiff?
>
> Best regards,
>       Dmitry
>
> 17.01.2016 03:41, Nevzat Guler пишет:
>> Dear experts,
>>
>> I am reading LANDSAT GeoTIFF files and combining bands to create and
>> ENVI cube.
>> I am using GDAL to read the GeoTIFF file, and my own custom cube
>> writer to write the ENVI style cube. Transferring the map information
>> proved to be a bit convoluted. I seek your help to figure out this.
>>
>> My first problem is to access map info from GeoTIFF file. The map info
>> includes:
>>
>> map info = {UTM, 1.000, 1.000, 145185.000, 2189715.000,
>> 3.0000000000e+001, 3.0000000000e+001, 19, North, WGS-84, units=Meters}
>>
>> I am able to get the location (x,y), and pixel size (x,y) from :
>> double adfGeoTransform[6];
>> srcDS->GetGeoTransform(adfGeoTransform);
>>
>> But, I could not find any way to get the other variables in the
>> string: UTM, pixel tie points, Unit and DATUM. Is there any way to get them?
>>
>> Finally, for the Coordinate System String, GDAL gives me:
>>
>> PROJCS["unnamed",PROJECTION["Transverse_Mercator"],PARAMETER["latitude
>> _of_or
>> igin
>> ",0],PARAMETER["central_meridian",-69],PARAMETER["scale_factor",0.9996
>> ],PARA
>> METE
>> R["false_easting",500000],PARAMETER["false_northing",0],UNIT["Meter",1
>> ]]
>>
>> But I should actually get
>>
>> PROJCS["UTM_Zone_19N",GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS
>> 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],TOWGS84[0,0,0,0,0,
>> 0,0],A
>> UTHO
>> RITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UN
>> IT["de
>> gree
>> ",0.0174532925199433,AUTHORITY["EPSG","9108"]],AUTHORITY["EPSG","4326"
>> ]],PRO
>> JECT
>> ION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER
>> ["cent
>> ral_
>> meridian",-69],PARAMETER["scale_factor",0.9996],PARAMETER["false_easti
>> ng",50
>> 0000
>> ],PARAMETER["false_northing",0],UNIT["Meter",1]]
>>
>> GDAL gives me PROJCS, "unnamed". And no GEOGCS information is given.
>> I am able to get the coordinate system properties by using the
>> following commands but I first need to set few things to use exportToWTK.
>>
>>>>         OGRSpatialReference oSRS;
>>>>         char *pszWKT = NULL;
>>>>         oSRS.SetProjCS("UTM_Zone_19N");
>>>>         oSRS.SetWellKnownGeogCS("WGS84");
>>>>         oSRS.SetUTM(19, TRUE);
>>>>         oSRS.SetWellKnownGeogCS("WGS84");
>>>>         oSRS.exportToWkt(&pszWKT);
>>>>         printf("%s\n", pszWKT);
>> However, this requires me to set SetProjCS, SetWellKnownGeogCS and
>> SetUTM first. I don't know these before I read the file. Is there any
>> way to get them from the file so that I don't need prior knowledge to
>> create the header. When I pull the GeoTIFF file into ENVI, all these
>> information is already there. If this list is only or development
>> purposes, please let me know if there is any other email list that can
>> give me guidance on this quest.
>>
>> I appreciate your help and suggestions.
>> Best regards,
>> - Nevzat
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>


From nguler at jlab.org  Sun Jan 17 10:32:48 2016
From: nguler at jlab.org (Nevzat Guler)
Date: Sun, 17 Jan 2016 13:32:48 -0500
Subject: [gdal-dev] map info and projections from GeoTIFF file to create
	ENVI header
In-Reply-To: <569BD5E6.7020807@gmail.com>
References: <001c01d14fa8$989e5b70$c9db1250$@spectral.com>
 <002301d14feb$c6a0c970$53e25c50$@spectral.com>
 <005701d150bf$d4c37550$7e4a5ff0$@jlab.org> <569B8185.5000206@gmail.com>
 <006301d1514a$abc3ca20$034b5e60$@jlab.org> <569BD5E6.7020807@gmail.com>
Message-ID: <006d01d15155$77cc9020$6765b060$@jlab.org>

I have the 2.0.1 version:
C:\warmerda\bld\bin>gdalinfo --version
GDAL 2.0.1, released 2015/09/15

I will check the history of the file I have. Maybe it is modified. I will also download the same file from earthexplorer and try my routines on it. 
Thanks for the suggestions. I appreciate.
- Nevzat

-----Original Message-----
From: Dmitry Baryshnikov [mailto:bishop.dev at gmail.com] 
Sent: Sunday, January 17, 2016 12:57 PM
To: Nevzat Guler <nguler at jlab.org>; gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] map info and projections from GeoTIFF file to create ENVI header

I downloaded this scene from earthexplorer, and everything is fine:

$ gdalinfo LC80080472013174LGN00_B1.TIF
Driver: GTiff/GeoTIFF
Files: LC80080472013174LGN00_B1.TIF
        ./LC80080472013174LGN00_MTL.txt
Size is 7571, 7411
Coordinate System is:
PROJCS["WGS 84 / UTM zone 19N",
     GEOGCS["WGS 84",
         DATUM["WGS_1984",
             SPHEROID["WGS 84",6378137,298.257223563,
                 AUTHORITY["EPSG","7030"]],
             AUTHORITY["EPSG","6326"]],
         PRIMEM["Greenwich",0,
             AUTHORITY["EPSG","8901"]],
         UNIT["degree",0.0174532925199433,
             AUTHORITY["EPSG","9122"]],
         AUTHORITY["EPSG","4326"]],
     PROJECTION["Transverse_Mercator"],
     PARAMETER["latitude_of_origin",0],
     PARAMETER["central_meridian",-69],
     PARAMETER["scale_factor",0.9996],
     PARAMETER["false_easting",500000],
     PARAMETER["false_northing",0],
     UNIT["metre",1,
         AUTHORITY["EPSG","9001"]],
     AXIS["Easting",EAST],
     AXIS["Northing",NORTH],
     AUTHORITY["EPSG","32619"]]
Origin = (145185.000000000000000,2189715.000000000000000)
Pixel Size = (30.000000000000000,-30.000000000000000)
Metadata:
   AREA_OR_POINT=Point
   METADATATYPE=ODL
Image Structure Metadata:
   INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (  145185.000, 2189715.000) ( 72d23' 7.97"W, 19d46'16.43"N) Lower Left  (  145185.000, 1967385.000) ( 72d20'44.51"W, 17d45'55.15"N) Upper Right (  372315.000, 2189715.000) ( 70d13' 8.50"W, 19d47'56.92"N) Lower Right (  372315.000, 1967385.000) ( 70d12'16.74"W, 17d47'24.74"N)
Center      (  258750.000, 2078550.000) ( 71d17'19.50"W, 18d47' 4.68"N)
Band 1 Block=7571x1 Type=UInt16, ColorInterp=Gray

$ gdalinfo --version
GDAL 2.1.0dev, released 2015/99/99

What is your gdal version? Maybe the Landsat geotiff was modified from some software?

Best regards,
     Dmitry

17.01.2016 20:15, Nevzat Guler пишет:
> Thank you Dmitry,
> What is the best way to extract the information we got using gdalinfo.exe by using GDAL classes, within a C++ code? As I mentioned, I am using GetGeoTransform and GetProjectionRef() but the results miss many of the information (specifically the map info elements as I explained in the previous email).
>
> On another note, I actually get a different output from gdalinfo.exe using my file (please see the printed result below). I got the geotiff file from my colleague. When I open the file with ENVI, I get all the information, including GEOGCS information.
>
> Can it be that my file is just corrupted and that's why I don't get all the information from GetGeoTransform and GetProjectionRef()? But then how would ENVI is able to extract this information if it were not in the file?
>
> Thanks again, - Nevzat
>
> C:\Cubes\Landsat\LC80080472013174LGN00>gdalinfo 
> LC80080472013174LGN00_B1.TIF
> Driver: GTiff/GeoTIFF
> Files: LC80080472013174LGN00_B1.TIF
>         .\LC80080472013174LGN00_MTL.txt Size is 7571, 7411 Coordinate 
> System is:
> PROJCS["unnamed",
>      PROJECTION["Transverse_Mercator"],
>      PARAMETER["latitude_of_origin",0],
>      PARAMETER["central_meridian",-69],
>      PARAMETER["scale_factor",0.9996],
>      PARAMETER["false_easting",500000],
>      PARAMETER["false_northing",0],
>      UNIT["metre",1,
>          AUTHORITY["EPSG","9001"]]]
> Origin = (145185.000000000000000,2189715.000000000000000)
> Pixel Size = (30.000000000000000,-30.000000000000000)
> Metadata:
>    AREA_OR_POINT=Point
>    METADATATYPE=ODL
> Image Structure Metadata:
>    INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  (  145185.000, 2189715.000) Lower Left  (  145185.000, 
> 1967385.000) Upper Right (  372315.000, 2189715.000) Lower Right (  
> 372315.000, 1967385.000)
> Center      (  258750.000, 2078550.000)
> Band 1 Block=7571x1 Type=UInt16, ColorInterp=Gray
>
> -----Original Message-----
> From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of 
> Dmitry Baryshnikov
> Sent: Sunday, January 17, 2016 6:57 AM
> To: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] map info and projections from GeoTIFF file to 
> create ENVI header
>
> Hi Nevzat,
>
> The landsat geotiff already have CRS embeded in file
>
> $ gdalinfo LC80150362013097LGN03_B1.TIF
> Driver: GTiff/GeoTIFF
> Files: LC80150362013097LGN03_B1.TIF
>          ./LC80150362013097LGN03_MTL.txt Size is 7281, 7261 Coordinate 
> System is:
> PROJCS["WGS 84 / UTM zone 17N",
>       GEOGCS["WGS 84",
>           DATUM["WGS_1984",
>               SPHEROID["WGS 84",6378137,298.257223563,
>                   AUTHORITY["EPSG","7030"]],
>               AUTHORITY["EPSG","6326"]],
>           PRIMEM["Greenwich",0,
>               AUTHORITY["EPSG","8901"]],
>           UNIT["degree",0.0174532925199433,
>               AUTHORITY["EPSG","9122"]],
>           AUTHORITY["EPSG","4326"]],
>       PROJECTION["Transverse_Mercator"],
>       PARAMETER["latitude_of_origin",0],
>       PARAMETER["central_meridian",-81],
>       PARAMETER["scale_factor",0.9996],
>       PARAMETER["false_easting",500000],
>       PARAMETER["false_northing",0],
>       UNIT["metre",1,
>           AUTHORITY["EPSG","9001"]],
>       AXIS["Easting",EAST],
>       AXIS["Northing",NORTH],
>       AUTHORITY["EPSG","32617"]]
> Origin = (706185.000000000000000,3943515.000000000000000)
> Pixel Size = (30.000000000000000,-30.000000000000000)
> Metadata:
>     AREA_OR_POINT=Point
>     METADATATYPE=ODL
> Image Structure Metadata:
>     INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  (  706185.000, 3943515.000) ( 78d43'24.74"W, 35d36'50.15"N) Lower Left  (  706185.000, 3725685.000) ( 78d46'35.65"W, 33d39' 3.82"N) Upper Right (  924615.000, 3943515.000) ( 76d19' 2.05"W, 35d32'39.74"N) Lower Right (  924615.000, 3725685.000) ( 76d25'33.46"W, 33d35'10.99"N)
> Center      (  815400.000, 3834600.000) ( 77d33'38.95"W, 34d36'17.35"N)
> Band 1 Block=7281x1 Type=UInt16, ColorInterp=Gray
>
> And this is right CRS.
> Where do you get you geotiff?
>
> Best regards,
>       Dmitry
>
> 17.01.2016 03:41, Nevzat Guler пишет:
>> Dear experts,
>>
>> I am reading LANDSAT GeoTIFF files and combining bands to create and 
>> ENVI cube.
>> I am using GDAL to read the GeoTIFF file, and my own custom cube 
>> writer to write the ENVI style cube. Transferring the map information 
>> proved to be a bit convoluted. I seek your help to figure out this.
>>
>> My first problem is to access map info from GeoTIFF file. The map 
>> info
>> includes:
>>
>> map info = {UTM, 1.000, 1.000, 145185.000, 2189715.000, 
>> 3.0000000000e+001, 3.0000000000e+001, 19, North, WGS-84, 
>> units=Meters}
>>
>> I am able to get the location (x,y), and pixel size (x,y) from :
>> double adfGeoTransform[6];
>> srcDS->GetGeoTransform(adfGeoTransform);
>>
>> But, I could not find any way to get the other variables in the
>> string: UTM, pixel tie points, Unit and DATUM. Is there any way to get them?
>>
>> Finally, for the Coordinate System String, GDAL gives me:
>>
>> PROJCS["unnamed",PROJECTION["Transverse_Mercator"],PARAMETER["latitud
>> e
>> _of_or
>> igin
>> ",0],PARAMETER["central_meridian",-69],PARAMETER["scale_factor",0.999
>> 6
>> ],PARA
>> METE
>> R["false_easting",500000],PARAMETER["false_northing",0],UNIT["Meter",
>> 1
>> ]]
>>
>> But I should actually get
>>
>> PROJCS["UTM_Zone_19N",GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS
>> 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],TOWGS84[0,0,0,0,0
>> ,
>> 0,0],A
>> UTHO
>> RITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],U
>> N
>> IT["de
>> gree
>> ",0.0174532925199433,AUTHORITY["EPSG","9108"]],AUTHORITY["EPSG","4326"
>> ]],PRO
>> JECT
>> ION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETE
>> R
>> ["cent
>> ral_
>> meridian",-69],PARAMETER["scale_factor",0.9996],PARAMETER["false_east
>> i
>> ng",50
>> 0000
>> ],PARAMETER["false_northing",0],UNIT["Meter",1]]
>>
>> GDAL gives me PROJCS, "unnamed". And no GEOGCS information is given.
>> I am able to get the coordinate system properties by using the 
>> following commands but I first need to set few things to use exportToWTK.
>>
>>>>         OGRSpatialReference oSRS;
>>>>         char *pszWKT = NULL;
>>>>         oSRS.SetProjCS("UTM_Zone_19N");
>>>>         oSRS.SetWellKnownGeogCS("WGS84");
>>>>         oSRS.SetUTM(19, TRUE);
>>>>         oSRS.SetWellKnownGeogCS("WGS84");
>>>>         oSRS.exportToWkt(&pszWKT);
>>>>         printf("%s\n", pszWKT);
>> However, this requires me to set SetProjCS, SetWellKnownGeogCS and 
>> SetUTM first. I don't know these before I read the file. Is there any 
>> way to get them from the file so that I don't need prior knowledge to 
>> create the header. When I pull the GeoTIFF file into ENVI, all these 
>> information is already there. If this list is only or development 
>> purposes, please let me know if there is any other email list that 
>> can give me guidance on this quest.
>>
>> I appreciate your help and suggestions.
>> Best regards,
>> - Nevzat
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>


From ds_prakash at rediffmail.com  Sun Jan 17 23:39:06 2016
From: ds_prakash at rediffmail.com (Surya Prakash)
Date: 18 Jan 2016 07:39:06 -0000
Subject: [gdal-dev] =?utf-8?q?RPC?=
Message-ID: <20160118073906.9869.qmail@f4mail-235-241.rediffmail.com>

Hi ALL,
I have some imagery associated with RPC files. The locational accuracy of the images defined by the RPCs is quite poor and I would like to update the RPCs by using some additional GCPs. How to do this, Please guide me.

Thanks & regards
SPR
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160118/70e2f0a4/attachment.html>

From even.rouault at spatialys.com  Mon Jan 18 01:25:17 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 18 Jan 2016 10:25:17 +0100
Subject: [gdal-dev] RPC
In-Reply-To: <20160118073906.9869.qmail@f4mail-235-241.rediffmail.com>
References: <20160118073906.9869.qmail@f4mail-235-241.rediffmail.com>
Message-ID: <201601181025.17439.even.rouault@spatialys.com>

Le lundi 18 janvier 2016 08:39:06, Surya Prakash a écrit :
> Hi ALL,
> I have some imagery associated with RPC files. The locational accuracy of
> the images defined by the RPCs is quite poor and I would like to update
> the RPCs by using some additional GCPs. How to do this, Please guide me.

You might find this interesting :
http://fwarmerdam.blogspot.fr/2013_09_01_archive.html

Are you sure the RPC you got is poor ? Several points need to be taken into 
account to get precise wrapping when using RPCs: if the angle of the image is 
far from nadir, you will need to use a DEM. And one point to take into account 
when doing so is that the elevations of the DEM must be relative to the WGS84 
ellipsoid. For that either you need to correct the DEM before using GDAL, or 
you must use GDAL trunk and have the DEM SRS be a COMPD_CS with a vertical 
datum grid shift. There also were issues with half-pixel shift in RPC 
application that have been fixed very recently in GDAL.

> 
> Thanks & regards
> SPR

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From filipesdias at gmail.com  Mon Jan 18 02:23:39 2016
From: filipesdias at gmail.com (Filipe Dias)
Date: Mon, 18 Jan 2016 10:23:39 +0000
Subject: [gdal-dev] gdal_proximity: possible bug
Message-ID: <CABr3zxVvnev3iU53RLBSZMJGTY6NTn-wsk5DUGu+_VPoTAbbAA@mail.gmail.com>

Hi,

I used gdal_proximity on a raster and did not pass the "Values" parameter
because in the help file it said " all non-zero pixels will be considered
target pixels.". The result was an incorrect Distances raster. Afterwards I
set the "Values" parameter and it worked as expected.

I reported this initially in the QGIS bug tracker, see more here:

http://hub.qgis.org/issues/14115#change-67271

I'm using GDAL 1.11.2.

Thanks

Best regards
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160118/4b55ccfe/attachment.html>

From kai.muehlbauer at uni-bonn.de  Mon Jan 18 01:56:37 2016
From: kai.muehlbauer at uni-bonn.de (Kai Muehlbauer)
Date: Mon, 18 Jan 2016 10:56:37 +0100
Subject: [gdal-dev] Intersection of two Layers
Message-ID: <569CB6D5.1090209@uni-bonn.de>

Hi,

at the moment I calculate the intersection of two OGR Layers (A, B) by 
iterating over features/geometries (GA) of layer A and then calling 
GA.Intersection(GB) for every Feature/Geometry (GB) of B. I set a 
spatial filter for layer B with every GA. The intersections 
features/geometries are written to a result layer (C).

In my use case the features/geometries of layer B are much smaller than 
the features of layer A. Means that quite a big number of B's geometries 
are fully contained in A's geometries.

To speed things up, I check for containment GA.contains(GB). If GB is 
contained in GA, I just copy GB to C, otherwise I calculate 
GA.Intersection(GB) and write this to C.

I found that I also could use the layer intersection function 
(OGRLayer::Intersection). Unfortunately the intersection is calculated 
for every feature/geometry.

Would it be possible to extend the layer intersection function to allow 
for containment check (eg. as an option) and just copy the contained 
geometries without calculation of expensive intersection? Suggestions, 
opinions?

In my use case I get improvements of around 20% of processing time.

Cheers,
Kai

From nguler at jlab.org  Mon Jan 18 08:13:14 2016
From: nguler at jlab.org (nguler at jlab.org)
Date: Mon, 18 Jan 2016 11:13:14 -0500 (EST)
Subject: [gdal-dev] map info and projections from GeoTIFF file to create
 ENVI header
In-Reply-To: <006d01d15155$77cc9020$6765b060$@jlab.org>
References: <001c01d14fa8$989e5b70$c9db1250$@spectral.com>
 <002301d14feb$c6a0c970$53e25c50$@spectral.com>
 <005701d150bf$d4c37550$7e4a5ff0$@jlab.org> <569B8185.5000206@gmail.com>
 <006301d1514a$abc3ca20$034b5e60$@jlab.org> <569BD5E6.7020807@gmail.com>
 <006d01d15155$77cc9020$6765b060$@jlab.org>
Message-ID: <39101.173.48.226.138.1453133594.squirrel@webmail.jlab.org>

Dmitry and All,
I just downloaded the set of tiff files from earthexplorer and run gdalinfo on
it. Please see below. I am missing some fields in the output information. It
is different from what you got. I don't know what can cause this? My
gdalinfo.exe is not good? Any idea?

C:\Cubes\LC80080472013174LGN00.tar>gdalinfo LC80080472013174LGN00_B1.TIF
Driver: GTiff/GeoTIFF
Files: LC80080472013174LGN00_B1.TIF
       .\LC80080472013174LGN00_MTL.txt
Size is 7571, 7411
Coordinate System is:
PROJCS["unnamed",
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",-69],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]]]
Origin = (145185.000000000000000,2189715.000000000000000)
Pixel Size = (30.000000000000000,-30.000000000000000)
Metadata:
  AREA_OR_POINT=Point
  METADATATYPE=ODL
Image Structure Metadata:
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (  145185.000, 2189715.000)
Lower Left  (  145185.000, 1967385.000)
Upper Right (  372315.000, 2189715.000)
Lower Right (  372315.000, 1967385.000)
Center      (  258750.000, 2078550.000)
Band 1 Block=7571x1 Type=UInt16, ColorInterp=Gray

C:\Cubes\LC80080472013174LGN00.tar>gdalinfo --version
GDAL 2.0.1, released 2015/09/15

C:\Cubes\LC80080472013174LGN00.tar>


> I have the 2.0.1 version:
> C:\warmerda\bld\bin>gdalinfo --version
> GDAL 2.0.1, released 2015/09/15
>
> I will check the history of the file I have. Maybe it is modified. I will also
> download the same file from earthexplorer and try my routines on it.
> Thanks for the suggestions. I appreciate.
> - Nevzat
>
> -----Original Message-----
> From: Dmitry Baryshnikov [mailto:bishop.dev at gmail.com]
> Sent: Sunday, January 17, 2016 12:57 PM
> To: Nevzat Guler <nguler at jlab.org>; gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] map info and projections from GeoTIFF file to create
> ENVI header
>
> I downloaded this scene from earthexplorer, and everything is fine:
>
> $ gdalinfo LC80080472013174LGN00_B1.TIF
> Driver: GTiff/GeoTIFF
> Files: LC80080472013174LGN00_B1.TIF
>         ./LC80080472013174LGN00_MTL.txt
> Size is 7571, 7411
> Coordinate System is:
> PROJCS["WGS 84 / UTM zone 19N",
>      GEOGCS["WGS 84",
>          DATUM["WGS_1984",
>              SPHEROID["WGS 84",6378137,298.257223563,
>                  AUTHORITY["EPSG","7030"]],
>              AUTHORITY["EPSG","6326"]],
>          PRIMEM["Greenwich",0,
>              AUTHORITY["EPSG","8901"]],
>          UNIT["degree",0.0174532925199433,
>              AUTHORITY["EPSG","9122"]],
>          AUTHORITY["EPSG","4326"]],
>      PROJECTION["Transverse_Mercator"],
>      PARAMETER["latitude_of_origin",0],
>      PARAMETER["central_meridian",-69],
>      PARAMETER["scale_factor",0.9996],
>      PARAMETER["false_easting",500000],
>      PARAMETER["false_northing",0],
>      UNIT["metre",1,
>          AUTHORITY["EPSG","9001"]],
>      AXIS["Easting",EAST],
>      AXIS["Northing",NORTH],
>      AUTHORITY["EPSG","32619"]]
> Origin = (145185.000000000000000,2189715.000000000000000)
> Pixel Size = (30.000000000000000,-30.000000000000000)
> Metadata:
>    AREA_OR_POINT=Point
>    METADATATYPE=ODL
> Image Structure Metadata:
>    INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  (  145185.000, 2189715.000) ( 72d23' 7.97"W, 19d46'16.43"N) Lower
> Left  (  145185.000, 1967385.000) ( 72d20'44.51"W, 17d45'55.15"N) Upper Right
> (  372315.000, 2189715.000) ( 70d13' 8.50"W, 19d47'56.92"N) Lower Right (
> 372315.000, 1967385.000) ( 70d12'16.74"W, 17d47'24.74"N)
> Center      (  258750.000, 2078550.000) ( 71d17'19.50"W, 18d47' 4.68"N)
> Band 1 Block=7571x1 Type=UInt16, ColorInterp=Gray
>
> $ gdalinfo --version
> GDAL 2.1.0dev, released 2015/99/99
>
> What is your gdal version? Maybe the Landsat geotiff was modified from some
> software?
>
> Best regards,
>      Dmitry
>
> 17.01.2016 20:15, Nevzat Guler Ð¿Ð¸ÑÐµÑ:
>> Thank you Dmitry,
>> What is the best way to extract the information we got using gdalinfo.exe by
>> using GDAL classes, within a C++ code? As I mentioned, I am using
>> GetGeoTransform and GetProjectionRef() but the results miss many of the
>> information (specifically the map info elements as I explained in the
>> previous email).
>>
>> On another note, I actually get a different output from gdalinfo.exe using
>> my file (please see the printed result below). I got the geotiff file from
>> my colleague. When I open the file with ENVI, I get all the information,
>> including GEOGCS information.
>>
>> Can it be that my file is just corrupted and that's why I don't get all the
>> information from GetGeoTransform and GetProjectionRef()? But then how would
>> ENVI is able to extract this information if it were not in the file?
>>
>> Thanks again, - Nevzat
>>
>> C:\Cubes\Landsat\LC80080472013174LGN00>gdalinfo
>> LC80080472013174LGN00_B1.TIF
>> Driver: GTiff/GeoTIFF
>> Files: LC80080472013174LGN00_B1.TIF
>>         .\LC80080472013174LGN00_MTL.txt Size is 7571, 7411 Coordinate
>> System is:
>> PROJCS["unnamed",
>>      PROJECTION["Transverse_Mercator"],
>>      PARAMETER["latitude_of_origin",0],
>>      PARAMETER["central_meridian",-69],
>>      PARAMETER["scale_factor",0.9996],
>>      PARAMETER["false_easting",500000],
>>      PARAMETER["false_northing",0],
>>      UNIT["metre",1,
>>          AUTHORITY["EPSG","9001"]]]
>> Origin = (145185.000000000000000,2189715.000000000000000)
>> Pixel Size = (30.000000000000000,-30.000000000000000)
>> Metadata:
>>    AREA_OR_POINT=Point
>>    METADATATYPE=ODL
>> Image Structure Metadata:
>>    INTERLEAVE=BAND
>> Corner Coordinates:
>> Upper Left  (  145185.000, 2189715.000) Lower Left  (  145185.000,
>> 1967385.000) Upper Right (  372315.000, 2189715.000) Lower Right (
>> 372315.000, 1967385.000)
>> Center      (  258750.000, 2078550.000)
>> Band 1 Block=7571x1 Type=UInt16, ColorInterp=Gray
>>
>> -----Original Message-----
>> From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of
>> Dmitry Baryshnikov
>> Sent: Sunday, January 17, 2016 6:57 AM
>> To: gdal-dev at lists.osgeo.org
>> Subject: Re: [gdal-dev] map info and projections from GeoTIFF file to
>> create ENVI header
>>
>> Hi Nevzat,
>>
>> The landsat geotiff already have CRS embeded in file
>>
>> $ gdalinfo LC80150362013097LGN03_B1.TIF
>> Driver: GTiff/GeoTIFF
>> Files: LC80150362013097LGN03_B1.TIF
>>          ./LC80150362013097LGN03_MTL.txt Size is 7281, 7261 Coordinate
>> System is:
>> PROJCS["WGS 84 / UTM zone 17N",
>>       GEOGCS["WGS 84",
>>           DATUM["WGS_1984",
>>               SPHEROID["WGS 84",6378137,298.257223563,
>>                   AUTHORITY["EPSG","7030"]],
>>               AUTHORITY["EPSG","6326"]],
>>           PRIMEM["Greenwich",0,
>>               AUTHORITY["EPSG","8901"]],
>>           UNIT["degree",0.0174532925199433,
>>               AUTHORITY["EPSG","9122"]],
>>           AUTHORITY["EPSG","4326"]],
>>       PROJECTION["Transverse_Mercator"],
>>       PARAMETER["latitude_of_origin",0],
>>       PARAMETER["central_meridian",-81],
>>       PARAMETER["scale_factor",0.9996],
>>       PARAMETER["false_easting",500000],
>>       PARAMETER["false_northing",0],
>>       UNIT["metre",1,
>>           AUTHORITY["EPSG","9001"]],
>>       AXIS["Easting",EAST],
>>       AXIS["Northing",NORTH],
>>       AUTHORITY["EPSG","32617"]]
>> Origin = (706185.000000000000000,3943515.000000000000000)
>> Pixel Size = (30.000000000000000,-30.000000000000000)
>> Metadata:
>>     AREA_OR_POINT=Point
>>     METADATATYPE=ODL
>> Image Structure Metadata:
>>     INTERLEAVE=BAND
>> Corner Coordinates:
>> Upper Left  (  706185.000, 3943515.000) ( 78d43'24.74"W, 35d36'50.15"N)
>> Lower Left  (  706185.000, 3725685.000) ( 78d46'35.65"W, 33d39' 3.82"N)
>> Upper Right (  924615.000, 3943515.000) ( 76d19' 2.05"W, 35d32'39.74"N)
>> Lower Right (  924615.000, 3725685.000) ( 76d25'33.46"W, 33d35'10.99"N)
>> Center      (  815400.000, 3834600.000) ( 77d33'38.95"W, 34d36'17.35"N)
>> Band 1 Block=7281x1 Type=UInt16, ColorInterp=Gray
>>
>> And this is right CRS.
>> Where do you get you geotiff?
>>
>> Best regards,
>>       Dmitry
>>
>> 17.01.2016 03:41, Nevzat Guler Ð¿Ð¸ÑÐµÑ:
>>> Dear experts,
>>>
>>> I am reading LANDSAT GeoTIFF files and combining bands to create and
>>> ENVI cube.
>>> I am using GDAL to read the GeoTIFF file, and my own custom cube
>>> writer to write the ENVI style cube. Transferring the map information
>>> proved to be a bit convoluted. I seek your help to figure out this.
>>>
>>> My first problem is to access map info from GeoTIFF file. The map
>>> info
>>> includes:
>>>
>>> map info = {UTM, 1.000, 1.000, 145185.000, 2189715.000,
>>> 3.0000000000e+001, 3.0000000000e+001, 19, North, WGS-84,
>>> units=Meters}
>>>
>>> I am able to get the location (x,y), and pixel size (x,y) from :
>>> double adfGeoTransform[6];
>>> srcDS->GetGeoTransform(adfGeoTransform);
>>>
>>> But, I could not find any way to get the other variables in the
>>> string: UTM, pixel tie points, Unit and DATUM. Is there any way to get
>>> them?
>>>
>>> Finally, for the Coordinate System String, GDAL gives me:
>>>
>>> PROJCS["unnamed",PROJECTION["Transverse_Mercator"],PARAMETER["latitud
>>> e
>>> _of_or
>>> igin
>>> ",0],PARAMETER["central_meridian",-69],PARAMETER["scale_factor",0.999
>>> 6
>>> ],PARA
>>> METE
>>> R["false_easting",500000],PARAMETER["false_northing",0],UNIT["Meter",
>>> 1
>>> ]]
>>>
>>> But I should actually get
>>>
>>> PROJCS["UTM_Zone_19N",GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS
>>> 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],TOWGS84[0,0,0,0,0
>>> ,
>>> 0,0],A
>>> UTHO
>>> RITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],U
>>> N
>>> IT["de
>>> gree
>>> ",0.0174532925199433,AUTHORITY["EPSG","9108"]],AUTHORITY["EPSG","4326"
>>> ]],PRO
>>> JECT
>>> ION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETE
>>> R
>>> ["cent
>>> ral_
>>> meridian",-69],PARAMETER["scale_factor",0.9996],PARAMETER["false_east
>>> i
>>> ng",50
>>> 0000
>>> ],PARAMETER["false_northing",0],UNIT["Meter",1]]
>>>
>>> GDAL gives me PROJCS, "unnamed". And no GEOGCS information is given.
>>> I am able to get the coordinate system properties by using the
>>> following commands but I first need to set few things to use exportToWTK.
>>>
>>>>>         OGRSpatialReference oSRS;
>>>>>         char *pszWKT = NULL;
>>>>>         oSRS.SetProjCS("UTM_Zone_19N");
>>>>>         oSRS.SetWellKnownGeogCS("WGS84");
>>>>>         oSRS.SetUTM(19, TRUE);
>>>>>         oSRS.SetWellKnownGeogCS("WGS84");
>>>>>         oSRS.exportToWkt(&pszWKT);
>>>>>         printf("%s\n", pszWKT);
>>> However, this requires me to set SetProjCS, SetWellKnownGeogCS and
>>> SetUTM first. I don't know these before I read the file. Is there any
>>> way to get them from the file so that I don't need prior knowledge to
>>> create the header. When I pull the GeoTIFF file into ENVI, all these
>>> information is already there. If this list is only or development
>>> purposes, please let me know if there is any other email list that
>>> can give me guidance on this quest.
>>>
>>> I appreciate your help and suggestions.
>>> Best regards,
>>> - Nevzat
>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


Nevzat Guler
Senior Scientist
Spectral Sciences
Phone: 781-273-4770
http://www.spectral.com/index.shtml
http://www.linkedin.com/in/nevzatguler



From even.rouault at spatialys.com  Mon Jan 18 08:24:51 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 18 Jan 2016 17:24:51 +0100
Subject: [gdal-dev] map info and projections from GeoTIFF file to create
	ENVI header
In-Reply-To: <39101.173.48.226.138.1453133594.squirrel@webmail.jlab.org>
References: <001c01d14fa8$989e5b70$c9db1250$@spectral.com>
 <006d01d15155$77cc9020$6765b060$@jlab.org>
 <39101.173.48.226.138.1453133594.squirrel@webmail.jlab.org>
Message-ID: <201601181724.52513.even.rouault@spatialys.com>

Le lundi 18 janvier 2016 17:13:14, nguler at jlab.org a écrit :
> Dmitry and All,
> I just downloaded the set of tiff files from earthexplorer and run gdalinfo
> on it. Please see below. I am missing some fields in the output
> information. It is different from what you got. I don't know what can
> cause this? My gdalinfo.exe is not good? Any idea?

Have a look at the FAQ entries about GDAL_DATA :
https://trac.osgeo.org/gdal/wiki/FAQInstallationAndBuilding#WhatisGDAL_DATAenvironmentvariable

> 
> C:\Cubes\LC80080472013174LGN00.tar>gdalinfo LC80080472013174LGN00_B1.TIF
> Driver: GTiff/GeoTIFF
> Files: LC80080472013174LGN00_B1.TIF
>        .\LC80080472013174LGN00_MTL.txt
> Size is 7571, 7411
> Coordinate System is:
> PROJCS["unnamed",
>     PROJECTION["Transverse_Mercator"],
>     PARAMETER["latitude_of_origin",0],
>     PARAMETER["central_meridian",-69],
>     PARAMETER["scale_factor",0.9996],
>     PARAMETER["false_easting",500000],
>     PARAMETER["false_northing",0],
>     UNIT["metre",1,
>         AUTHORITY["EPSG","9001"]]]
> Origin = (145185.000000000000000,2189715.000000000000000)
> Pixel Size = (30.000000000000000,-30.000000000000000)
> Metadata:
>   AREA_OR_POINT=Point
>   METADATATYPE=ODL
> Image Structure Metadata:
>   INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  (  145185.000, 2189715.000)
> Lower Left  (  145185.000, 1967385.000)
> Upper Right (  372315.000, 2189715.000)
> Lower Right (  372315.000, 1967385.000)
> Center      (  258750.000, 2078550.000)
> Band 1 Block=7571x1 Type=UInt16, ColorInterp=Gray
> 
> C:\Cubes\LC80080472013174LGN00.tar>gdalinfo --version
> GDAL 2.0.1, released 2015/09/15
> 
> C:\Cubes\LC80080472013174LGN00.tar>
> 
> > I have the 2.0.1 version:
> > C:\warmerda\bld\bin>gdalinfo --version
> > GDAL 2.0.1, released 2015/09/15
> > 
> > I will check the history of the file I have. Maybe it is modified. I will
> > also download the same file from earthexplorer and try my routines on
> > it. Thanks for the suggestions. I appreciate.
> > - Nevzat
> > 
> > -----Original Message-----
> > From: Dmitry Baryshnikov [mailto:bishop.dev at gmail.com]
> > Sent: Sunday, January 17, 2016 12:57 PM
> > To: Nevzat Guler <nguler at jlab.org>; gdal-dev at lists.osgeo.org
> > Subject: Re: [gdal-dev] map info and projections from GeoTIFF file to
> > create ENVI header
> > 
> > I downloaded this scene from earthexplorer, and everything is fine:
> > 
> > $ gdalinfo LC80080472013174LGN00_B1.TIF
> > Driver: GTiff/GeoTIFF
> > Files: LC80080472013174LGN00_B1.TIF
> > 
> >         ./LC80080472013174LGN00_MTL.txt
> > 
> > Size is 7571, 7411
> > Coordinate System is:
> > PROJCS["WGS 84 / UTM zone 19N",
> > 
> >      GEOGCS["WGS 84",
> >      
> >          DATUM["WGS_1984",
> >          
> >              SPHEROID["WGS 84",6378137,298.257223563,
> >              
> >                  AUTHORITY["EPSG","7030"]],
> >              
> >              AUTHORITY["EPSG","6326"]],
> >          
> >          PRIMEM["Greenwich",0,
> >          
> >              AUTHORITY["EPSG","8901"]],
> >          
> >          UNIT["degree",0.0174532925199433,
> >          
> >              AUTHORITY["EPSG","9122"]],
> >          
> >          AUTHORITY["EPSG","4326"]],
> >      
> >      PROJECTION["Transverse_Mercator"],
> >      PARAMETER["latitude_of_origin",0],
> >      PARAMETER["central_meridian",-69],
> >      PARAMETER["scale_factor",0.9996],
> >      PARAMETER["false_easting",500000],
> >      PARAMETER["false_northing",0],
> >      UNIT["metre",1,
> >      
> >          AUTHORITY["EPSG","9001"]],
> >      
> >      AXIS["Easting",EAST],
> >      AXIS["Northing",NORTH],
> >      AUTHORITY["EPSG","32619"]]
> > 
> > Origin = (145185.000000000000000,2189715.000000000000000)
> > Pixel Size = (30.000000000000000,-30.000000000000000)
> > 
> > Metadata:
> >    AREA_OR_POINT=Point
> >    METADATATYPE=ODL
> > 
> > Image Structure Metadata:
> >    INTERLEAVE=BAND
> > 
> > Corner Coordinates:
> > Upper Left  (  145185.000, 2189715.000) ( 72d23' 7.97"W, 19d46'16.43"N)
> > Lower Left  (  145185.000, 1967385.000) ( 72d20'44.51"W, 17d45'55.15"N)
> > Upper Right (  372315.000, 2189715.000) ( 70d13' 8.50"W, 19d47'56.92"N)
> > Lower Right ( 372315.000, 1967385.000) ( 70d12'16.74"W, 17d47'24.74"N)
> > Center      (  258750.000, 2078550.000) ( 71d17'19.50"W, 18d47' 4.68"N)
> > Band 1 Block=7571x1 Type=UInt16, ColorInterp=Gray
> > 
> > $ gdalinfo --version
> > GDAL 2.1.0dev, released 2015/99/99
> > 
> > What is your gdal version? Maybe the Landsat geotiff was modified from
> > some software?
> > 
> > Best regards,
> > 
> >      Dmitry
> > 
> > 17.01.2016 20:15, Nevzat Guler Ð¿Ð¸ÑÐµÑ:
> >> Thank you Dmitry,
> >> What is the best way to extract the information we got using
> >> gdalinfo.exe by using GDAL classes, within a C++ code? As I mentioned,
> >> I am using GetGeoTransform and GetProjectionRef() but the results miss
> >> many of the information (specifically the map info elements as I
> >> explained in the previous email).
> >> 
> >> On another note, I actually get a different output from gdalinfo.exe
> >> using my file (please see the printed result below). I got the geotiff
> >> file from my colleague. When I open the file with ENVI, I get all the
> >> information, including GEOGCS information.
> >> 
> >> Can it be that my file is just corrupted and that's why I don't get all
> >> the information from GetGeoTransform and GetProjectionRef()? But then
> >> how would ENVI is able to extract this information if it were not in
> >> the file?
> >> 
> >> Thanks again, - Nevzat
> >> 
> >> C:\Cubes\Landsat\LC80080472013174LGN00>gdalinfo
> >> LC80080472013174LGN00_B1.TIF
> >> Driver: GTiff/GeoTIFF
> >> Files: LC80080472013174LGN00_B1.TIF
> >> 
> >>         .\LC80080472013174LGN00_MTL.txt Size is 7571, 7411 Coordinate
> >> 
> >> System is:
> >> PROJCS["unnamed",
> >> 
> >>      PROJECTION["Transverse_Mercator"],
> >>      PARAMETER["latitude_of_origin",0],
> >>      PARAMETER["central_meridian",-69],
> >>      PARAMETER["scale_factor",0.9996],
> >>      PARAMETER["false_easting",500000],
> >>      PARAMETER["false_northing",0],
> >>      UNIT["metre",1,
> >>      
> >>          AUTHORITY["EPSG","9001"]]]
> >> 
> >> Origin = (145185.000000000000000,2189715.000000000000000)
> >> Pixel Size = (30.000000000000000,-30.000000000000000)
> >> 
> >> Metadata:
> >>    AREA_OR_POINT=Point
> >>    METADATATYPE=ODL
> >> 
> >> Image Structure Metadata:
> >>    INTERLEAVE=BAND
> >> 
> >> Corner Coordinates:
> >> Upper Left  (  145185.000, 2189715.000) Lower Left  (  145185.000,
> >> 1967385.000) Upper Right (  372315.000, 2189715.000) Lower Right (
> >> 372315.000, 1967385.000)
> >> Center      (  258750.000, 2078550.000)
> >> Band 1 Block=7571x1 Type=UInt16, ColorInterp=Gray
> >> 
> >> -----Original Message-----
> >> From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of
> >> Dmitry Baryshnikov
> >> Sent: Sunday, January 17, 2016 6:57 AM
> >> To: gdal-dev at lists.osgeo.org
> >> Subject: Re: [gdal-dev] map info and projections from GeoTIFF file to
> >> create ENVI header
> >> 
> >> Hi Nevzat,
> >> 
> >> The landsat geotiff already have CRS embeded in file
> >> 
> >> $ gdalinfo LC80150362013097LGN03_B1.TIF
> >> Driver: GTiff/GeoTIFF
> >> Files: LC80150362013097LGN03_B1.TIF
> >> 
> >>          ./LC80150362013097LGN03_MTL.txt Size is 7281, 7261 Coordinate
> >> 
> >> System is:
> >> PROJCS["WGS 84 / UTM zone 17N",
> >> 
> >>       GEOGCS["WGS 84",
> >>       
> >>           DATUM["WGS_1984",
> >>           
> >>               SPHEROID["WGS 84",6378137,298.257223563,
> >>               
> >>                   AUTHORITY["EPSG","7030"]],
> >>               
> >>               AUTHORITY["EPSG","6326"]],
> >>           
> >>           PRIMEM["Greenwich",0,
> >>           
> >>               AUTHORITY["EPSG","8901"]],
> >>           
> >>           UNIT["degree",0.0174532925199433,
> >>           
> >>               AUTHORITY["EPSG","9122"]],
> >>           
> >>           AUTHORITY["EPSG","4326"]],
> >>       
> >>       PROJECTION["Transverse_Mercator"],
> >>       PARAMETER["latitude_of_origin",0],
> >>       PARAMETER["central_meridian",-81],
> >>       PARAMETER["scale_factor",0.9996],
> >>       PARAMETER["false_easting",500000],
> >>       PARAMETER["false_northing",0],
> >>       UNIT["metre",1,
> >>       
> >>           AUTHORITY["EPSG","9001"]],
> >>       
> >>       AXIS["Easting",EAST],
> >>       AXIS["Northing",NORTH],
> >>       AUTHORITY["EPSG","32617"]]
> >> 
> >> Origin = (706185.000000000000000,3943515.000000000000000)
> >> Pixel Size = (30.000000000000000,-30.000000000000000)
> >> 
> >> Metadata:
> >>     AREA_OR_POINT=Point
> >>     METADATATYPE=ODL
> >> 
> >> Image Structure Metadata:
> >>     INTERLEAVE=BAND
> >> 
> >> Corner Coordinates:
> >> Upper Left  (  706185.000, 3943515.000) ( 78d43'24.74"W, 35d36'50.15"N)
> >> Lower Left  (  706185.000, 3725685.000) ( 78d46'35.65"W, 33d39' 3.82"N)
> >> Upper Right (  924615.000, 3943515.000) ( 76d19' 2.05"W, 35d32'39.74"N)
> >> Lower Right (  924615.000, 3725685.000) ( 76d25'33.46"W, 33d35'10.99"N)
> >> Center      (  815400.000, 3834600.000) ( 77d33'38.95"W, 34d36'17.35"N)
> >> Band 1 Block=7281x1 Type=UInt16, ColorInterp=Gray
> >> 
> >> And this is right CRS.
> >> Where do you get you geotiff?
> >> 
> >> Best regards,
> >> 
> >>       Dmitry
> >> 
> >> 17.01.2016 03:41, Nevzat Guler Ð¿Ð¸ÑÐµÑ:
> >>> Dear experts,
> >>> 
> >>> I am reading LANDSAT GeoTIFF files and combining bands to create and
> >>> ENVI cube.
> >>> I am using GDAL to read the GeoTIFF file, and my own custom cube
> >>> writer to write the ENVI style cube. Transferring the map information
> >>> proved to be a bit convoluted. I seek your help to figure out this.
> >>> 
> >>> My first problem is to access map info from GeoTIFF file. The map
> >>> info
> >>> includes:
> >>> 
> >>> map info = {UTM, 1.000, 1.000, 145185.000, 2189715.000,
> >>> 3.0000000000e+001, 3.0000000000e+001, 19, North, WGS-84,
> >>> units=Meters}
> >>> 
> >>> I am able to get the location (x,y), and pixel size (x,y) from :
> >>> double adfGeoTransform[6];
> >>> srcDS->GetGeoTransform(adfGeoTransform);
> >>> 
> >>> But, I could not find any way to get the other variables in the
> >>> string: UTM, pixel tie points, Unit and DATUM. Is there any way to get
> >>> them?
> >>> 
> >>> Finally, for the Coordinate System String, GDAL gives me:
> >>> 
> >>> PROJCS["unnamed",PROJECTION["Transverse_Mercator"],PARAMETER["latitud
> >>> e
> >>> _of_or
> >>> igin
> >>> ",0],PARAMETER["central_meridian",-69],PARAMETER["scale_factor",0.999
> >>> 6
> >>> ],PARA
> >>> METE
> >>> R["false_easting",500000],PARAMETER["false_northing",0],UNIT["Meter",
> >>> 1
> >>> ]]
> >>> 
> >>> But I should actually get
> >>> 
> >>> PROJCS["UTM_Zone_19N",GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS
> >>> 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],TOWGS84[0,0,0,0,0
> >>> ,
> >>> 0,0],A
> >>> UTHO
> >>> RITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],U
> >>> N
> >>> IT["de
> >>> gree
> >>> ",0.0174532925199433,AUTHORITY["EPSG","9108"]],AUTHORITY["EPSG","4326"
> >>> ]],PRO
> >>> JECT
> >>> ION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETE
> >>> R
> >>> ["cent
> >>> ral_
> >>> meridian",-69],PARAMETER["scale_factor",0.9996],PARAMETER["false_east
> >>> i
> >>> ng",50
> >>> 0000
> >>> ],PARAMETER["false_northing",0],UNIT["Meter",1]]
> >>> 
> >>> GDAL gives me PROJCS, "unnamed". And no GEOGCS information is given.
> >>> I am able to get the coordinate system properties by using the
> >>> following commands but I first need to set few things to use
> >>> exportToWTK.
> >>> 
> >>>>>         OGRSpatialReference oSRS;
> >>>>>         char *pszWKT = NULL;
> >>>>>         oSRS.SetProjCS("UTM_Zone_19N");
> >>>>>         oSRS.SetWellKnownGeogCS("WGS84");
> >>>>>         oSRS.SetUTM(19, TRUE);
> >>>>>         oSRS.SetWellKnownGeogCS("WGS84");
> >>>>>         oSRS.exportToWkt(&pszWKT);
> >>>>>         printf("%s\n", pszWKT);
> >>> 
> >>> However, this requires me to set SetProjCS, SetWellKnownGeogCS and
> >>> SetUTM first. I don't know these before I read the file. Is there any
> >>> way to get them from the file so that I don't need prior knowledge to
> >>> create the header. When I pull the GeoTIFF file into ENVI, all these
> >>> information is already there. If this list is only or development
> >>> purposes, please let me know if there is any other email list that
> >>> can give me guidance on this quest.
> >>> 
> >>> I appreciate your help and suggestions.
> >>> Best regards,
> >>> - Nevzat
> >>> 
> >>> _______________________________________________
> >>> gdal-dev mailing list
> >>> gdal-dev at lists.osgeo.org
> >>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >> 
> >> _______________________________________________
> >> gdal-dev mailing list
> >> gdal-dev at lists.osgeo.org
> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > 
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> Nevzat Guler
> Senior Scientist
> Spectral Sciences
> Phone: 781-273-4770
> http://www.spectral.com/index.shtml
> http://www.linkedin.com/in/nevzatguler
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From nguler at jlab.org  Mon Jan 18 08:53:54 2016
From: nguler at jlab.org (nguler at jlab.org)
Date: Mon, 18 Jan 2016 11:53:54 -0500 (EST)
Subject: [gdal-dev] map info and projections from GeoTIFF file to create
 ENVI header
In-Reply-To: <201601181724.52513.even.rouault@spatialys.com>
References: <001c01d14fa8$989e5b70$c9db1250$@spectral.com>
 <006d01d15155$77cc9020$6765b060$@jlab.org>
 <39101.173.48.226.138.1453133594.squirrel@webmail.jlab.org>
 <201601181724.52513.even.rouault@spatialys.com>
Message-ID: <40508.173.48.226.138.1453136034.squirrel@webmail.jlab.org>

Yes, Thank you Even, I was missing the GDAL_DATA environmental variable. Now I
get the same gdalinfo output. Do I need to set this variable while using the
C++ classes you suggested before: GetGeoTransform and GetProjectionRef()..?
Because, there also I had the same problem.

Best regards, - Nevzat


> Le lundi 18 janvier 2016 17:13:14, nguler at jlab.org a Ã©crit :
>> Dmitry and All,
>> I just downloaded the set of tiff files from earthexplorer and run gdalinfo
>> on it. Please see below. I am missing some fields in the output
>> information. It is different from what you got. I don't know what can
>> cause this? My gdalinfo.exe is not good? Any idea?
>
> Have a look at the FAQ entries about GDAL_DATA :
> https://trac.osgeo.org/gdal/wiki/FAQInstallationAndBuilding#WhatisGDAL_DATAenvironmentvariable
>
>>
>> C:\Cubes\LC80080472013174LGN00.tar>gdalinfo LC80080472013174LGN00_B1.TIF
>> Driver: GTiff/GeoTIFF
>> Files: LC80080472013174LGN00_B1.TIF
>>        .\LC80080472013174LGN00_MTL.txt
>> Size is 7571, 7411
>> Coordinate System is:
>> PROJCS["unnamed",
>>     PROJECTION["Transverse_Mercator"],
>>     PARAMETER["latitude_of_origin",0],
>>     PARAMETER["central_meridian",-69],
>>     PARAMETER["scale_factor",0.9996],
>>     PARAMETER["false_easting",500000],
>>     PARAMETER["false_northing",0],
>>     UNIT["metre",1,
>>         AUTHORITY["EPSG","9001"]]]
>> Origin = (145185.000000000000000,2189715.000000000000000)
>> Pixel Size = (30.000000000000000,-30.000000000000000)
>> Metadata:
>>   AREA_OR_POINT=Point
>>   METADATATYPE=ODL
>> Image Structure Metadata:
>>   INTERLEAVE=BAND
>> Corner Coordinates:
>> Upper Left  (  145185.000, 2189715.000)
>> Lower Left  (  145185.000, 1967385.000)
>> Upper Right (  372315.000, 2189715.000)
>> Lower Right (  372315.000, 1967385.000)
>> Center      (  258750.000, 2078550.000)
>> Band 1 Block=7571x1 Type=UInt16, ColorInterp=Gray
>>
>> C:\Cubes\LC80080472013174LGN00.tar>gdalinfo --version
>> GDAL 2.0.1, released 2015/09/15
>>
>> C:\Cubes\LC80080472013174LGN00.tar>
>>
>> > I have the 2.0.1 version:
>> > C:\warmerda\bld\bin>gdalinfo --version
>> > GDAL 2.0.1, released 2015/09/15
>> >
>> > I will check the history of the file I have. Maybe it is modified. I will
>> > also download the same file from earthexplorer and try my routines on
>> > it. Thanks for the suggestions. I appreciate.
>> > - Nevzat
>> >
>> > -----Original Message-----
>> > From: Dmitry Baryshnikov [mailto:bishop.dev at gmail.com]
>> > Sent: Sunday, January 17, 2016 12:57 PM
>> > To: Nevzat Guler <nguler at jlab.org>; gdal-dev at lists.osgeo.org
>> > Subject: Re: [gdal-dev] map info and projections from GeoTIFF file to
>> > create ENVI header
>> >
>> > I downloaded this scene from earthexplorer, and everything is fine:
>> >
>> > $ gdalinfo LC80080472013174LGN00_B1.TIF
>> > Driver: GTiff/GeoTIFF
>> > Files: LC80080472013174LGN00_B1.TIF
>> >
>> >         ./LC80080472013174LGN00_MTL.txt
>> >
>> > Size is 7571, 7411
>> > Coordinate System is:
>> > PROJCS["WGS 84 / UTM zone 19N",
>> >
>> >      GEOGCS["WGS 84",
>> >
>> >          DATUM["WGS_1984",
>> >
>> >              SPHEROID["WGS 84",6378137,298.257223563,
>> >
>> >                  AUTHORITY["EPSG","7030"]],
>> >
>> >              AUTHORITY["EPSG","6326"]],
>> >
>> >          PRIMEM["Greenwich",0,
>> >
>> >              AUTHORITY["EPSG","8901"]],
>> >
>> >          UNIT["degree",0.0174532925199433,
>> >
>> >              AUTHORITY["EPSG","9122"]],
>> >
>> >          AUTHORITY["EPSG","4326"]],
>> >
>> >      PROJECTION["Transverse_Mercator"],
>> >      PARAMETER["latitude_of_origin",0],
>> >      PARAMETER["central_meridian",-69],
>> >      PARAMETER["scale_factor",0.9996],
>> >      PARAMETER["false_easting",500000],
>> >      PARAMETER["false_northing",0],
>> >      UNIT["metre",1,
>> >
>> >          AUTHORITY["EPSG","9001"]],
>> >
>> >      AXIS["Easting",EAST],
>> >      AXIS["Northing",NORTH],
>> >      AUTHORITY["EPSG","32619"]]
>> >
>> > Origin = (145185.000000000000000,2189715.000000000000000)
>> > Pixel Size = (30.000000000000000,-30.000000000000000)
>> >
>> > Metadata:
>> >    AREA_OR_POINT=Point
>> >    METADATATYPE=ODL
>> >
>> > Image Structure Metadata:
>> >    INTERLEAVE=BAND
>> >
>> > Corner Coordinates:
>> > Upper Left  (  145185.000, 2189715.000) ( 72d23' 7.97"W, 19d46'16.43"N)
>> > Lower Left  (  145185.000, 1967385.000) ( 72d20'44.51"W, 17d45'55.15"N)
>> > Upper Right (  372315.000, 2189715.000) ( 70d13' 8.50"W, 19d47'56.92"N)
>> > Lower Right ( 372315.000, 1967385.000) ( 70d12'16.74"W, 17d47'24.74"N)
>> > Center      (  258750.000, 2078550.000) ( 71d17'19.50"W, 18d47' 4.68"N)
>> > Band 1 Block=7571x1 Type=UInt16, ColorInterp=Gray
>> >
>> > $ gdalinfo --version
>> > GDAL 2.1.0dev, released 2015/99/99
>> >
>> > What is your gdal version? Maybe the Landsat geotiff was modified from
>> > some software?
>> >
>> > Best regards,
>> >
>> >      Dmitry
>> >
>> > 17.01.2016 20:15, Nevzat Guler ÃÂ¿ÃÂ¸ÃÂÃÂµÃÂ:
>> >> Thank you Dmitry,
>> >> What is the best way to extract the information we got using
>> >> gdalinfo.exe by using GDAL classes, within a C++ code? As I mentioned,
>> >> I am using GetGeoTransform and GetProjectionRef() but the results miss
>> >> many of the information (specifically the map info elements as I
>> >> explained in the previous email).
>> >>
>> >> On another note, I actually get a different output from gdalinfo.exe
>> >> using my file (please see the printed result below). I got the geotiff
>> >> file from my colleague. When I open the file with ENVI, I get all the
>> >> information, including GEOGCS information.
>> >>
>> >> Can it be that my file is just corrupted and that's why I don't get all
>> >> the information from GetGeoTransform and GetProjectionRef()? But then
>> >> how would ENVI is able to extract this information if it were not in
>> >> the file?
>> >>
>> >> Thanks again, - Nevzat
>> >>
>> >> C:\Cubes\Landsat\LC80080472013174LGN00>gdalinfo
>> >> LC80080472013174LGN00_B1.TIF
>> >> Driver: GTiff/GeoTIFF
>> >> Files: LC80080472013174LGN00_B1.TIF
>> >>
>> >>         .\LC80080472013174LGN00_MTL.txt Size is 7571, 7411 Coordinate
>> >>
>> >> System is:
>> >> PROJCS["unnamed",
>> >>
>> >>      PROJECTION["Transverse_Mercator"],
>> >>      PARAMETER["latitude_of_origin",0],
>> >>      PARAMETER["central_meridian",-69],
>> >>      PARAMETER["scale_factor",0.9996],
>> >>      PARAMETER["false_easting",500000],
>> >>      PARAMETER["false_northing",0],
>> >>      UNIT["metre",1,
>> >>
>> >>          AUTHORITY["EPSG","9001"]]]
>> >>
>> >> Origin = (145185.000000000000000,2189715.000000000000000)
>> >> Pixel Size = (30.000000000000000,-30.000000000000000)
>> >>
>> >> Metadata:
>> >>    AREA_OR_POINT=Point
>> >>    METADATATYPE=ODL
>> >>
>> >> Image Structure Metadata:
>> >>    INTERLEAVE=BAND
>> >>
>> >> Corner Coordinates:
>> >> Upper Left  (  145185.000, 2189715.000) Lower Left  (  145185.000,
>> >> 1967385.000) Upper Right (  372315.000, 2189715.000) Lower Right (
>> >> 372315.000, 1967385.000)
>> >> Center      (  258750.000, 2078550.000)
>> >> Band 1 Block=7571x1 Type=UInt16, ColorInterp=Gray
>> >>
>> >> -----Original Message-----
>> >> From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of
>> >> Dmitry Baryshnikov
>> >> Sent: Sunday, January 17, 2016 6:57 AM
>> >> To: gdal-dev at lists.osgeo.org
>> >> Subject: Re: [gdal-dev] map info and projections from GeoTIFF file to
>> >> create ENVI header
>> >>
>> >> Hi Nevzat,
>> >>
>> >> The landsat geotiff already have CRS embeded in file
>> >>
>> >> $ gdalinfo LC80150362013097LGN03_B1.TIF
>> >> Driver: GTiff/GeoTIFF
>> >> Files: LC80150362013097LGN03_B1.TIF
>> >>
>> >>          ./LC80150362013097LGN03_MTL.txt Size is 7281, 7261 Coordinate
>> >>
>> >> System is:
>> >> PROJCS["WGS 84 / UTM zone 17N",
>> >>
>> >>       GEOGCS["WGS 84",
>> >>
>> >>           DATUM["WGS_1984",
>> >>
>> >>               SPHEROID["WGS 84",6378137,298.257223563,
>> >>
>> >>                   AUTHORITY["EPSG","7030"]],
>> >>
>> >>               AUTHORITY["EPSG","6326"]],
>> >>
>> >>           PRIMEM["Greenwich",0,
>> >>
>> >>               AUTHORITY["EPSG","8901"]],
>> >>
>> >>           UNIT["degree",0.0174532925199433,
>> >>
>> >>               AUTHORITY["EPSG","9122"]],
>> >>
>> >>           AUTHORITY["EPSG","4326"]],
>> >>
>> >>       PROJECTION["Transverse_Mercator"],
>> >>       PARAMETER["latitude_of_origin",0],
>> >>       PARAMETER["central_meridian",-81],
>> >>       PARAMETER["scale_factor",0.9996],
>> >>       PARAMETER["false_easting",500000],
>> >>       PARAMETER["false_northing",0],
>> >>       UNIT["metre",1,
>> >>
>> >>           AUTHORITY["EPSG","9001"]],
>> >>
>> >>       AXIS["Easting",EAST],
>> >>       AXIS["Northing",NORTH],
>> >>       AUTHORITY["EPSG","32617"]]
>> >>
>> >> Origin = (706185.000000000000000,3943515.000000000000000)
>> >> Pixel Size = (30.000000000000000,-30.000000000000000)
>> >>
>> >> Metadata:
>> >>     AREA_OR_POINT=Point
>> >>     METADATATYPE=ODL
>> >>
>> >> Image Structure Metadata:
>> >>     INTERLEAVE=BAND
>> >>
>> >> Corner Coordinates:
>> >> Upper Left  (  706185.000, 3943515.000) ( 78d43'24.74"W, 35d36'50.15"N)
>> >> Lower Left  (  706185.000, 3725685.000) ( 78d46'35.65"W, 33d39' 3.82"N)
>> >> Upper Right (  924615.000, 3943515.000) ( 76d19' 2.05"W, 35d32'39.74"N)
>> >> Lower Right (  924615.000, 3725685.000) ( 76d25'33.46"W, 33d35'10.99"N)
>> >> Center      (  815400.000, 3834600.000) ( 77d33'38.95"W, 34d36'17.35"N)
>> >> Band 1 Block=7281x1 Type=UInt16, ColorInterp=Gray
>> >>
>> >> And this is right CRS.
>> >> Where do you get you geotiff?
>> >>
>> >> Best regards,
>> >>
>> >>       Dmitry
>> >>
>> >> 17.01.2016 03:41, Nevzat Guler ÃÂ¿ÃÂ¸ÃÂÃÂµÃÂ:
>> >>> Dear experts,
>> >>>
>> >>> I am reading LANDSAT GeoTIFF files and combining bands to create and
>> >>> ENVI cube.
>> >>> I am using GDAL to read the GeoTIFF file, and my own custom cube
>> >>> writer to write the ENVI style cube. Transferring the map information
>> >>> proved to be a bit convoluted. I seek your help to figure out this.
>> >>>
>> >>> My first problem is to access map info from GeoTIFF file. The map
>> >>> info
>> >>> includes:
>> >>>
>> >>> map info = {UTM, 1.000, 1.000, 145185.000, 2189715.000,
>> >>> 3.0000000000e+001, 3.0000000000e+001, 19, North, WGS-84,
>> >>> units=Meters}
>> >>>
>> >>> I am able to get the location (x,y), and pixel size (x,y) from :
>> >>> double adfGeoTransform[6];
>> >>> srcDS->GetGeoTransform(adfGeoTransform);
>> >>>
>> >>> But, I could not find any way to get the other variables in the
>> >>> string: UTM, pixel tie points, Unit and DATUM. Is there any way to get
>> >>> them?
>> >>>
>> >>> Finally, for the Coordinate System String, GDAL gives me:
>> >>>
>> >>> PROJCS["unnamed",PROJECTION["Transverse_Mercator"],PARAMETER["latitud
>> >>> e
>> >>> _of_or
>> >>> igin
>> >>> ",0],PARAMETER["central_meridian",-69],PARAMETER["scale_factor",0.999
>> >>> 6
>> >>> ],PARA
>> >>> METE
>> >>> R["false_easting",500000],PARAMETER["false_northing",0],UNIT["Meter",
>> >>> 1
>> >>> ]]
>> >>>
>> >>> But I should actually get
>> >>>
>> >>> PROJCS["UTM_Zone_19N",GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS
>> >>> 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],TOWGS84[0,0,0,0,0
>> >>> ,
>> >>> 0,0],A
>> >>> UTHO
>> >>> RITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],U
>> >>> N
>> >>> IT["de
>> >>> gree
>> >>> ",0.0174532925199433,AUTHORITY["EPSG","9108"]],AUTHORITY["EPSG","4326"
>> >>> ]],PRO
>> >>> JECT
>> >>> ION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETE
>> >>> R
>> >>> ["cent
>> >>> ral_
>> >>> meridian",-69],PARAMETER["scale_factor",0.9996],PARAMETER["false_east
>> >>> i
>> >>> ng",50
>> >>> 0000
>> >>> ],PARAMETER["false_northing",0],UNIT["Meter",1]]
>> >>>
>> >>> GDAL gives me PROJCS, "unnamed". And no GEOGCS information is given.
>> >>> I am able to get the coordinate system properties by using the
>> >>> following commands but I first need to set few things to use
>> >>> exportToWTK.
>> >>>
>> >>>>>         OGRSpatialReference oSRS;
>> >>>>>         char *pszWKT = NULL;
>> >>>>>         oSRS.SetProjCS("UTM_Zone_19N");
>> >>>>>         oSRS.SetWellKnownGeogCS("WGS84");
>> >>>>>         oSRS.SetUTM(19, TRUE);
>> >>>>>         oSRS.SetWellKnownGeogCS("WGS84");
>> >>>>>         oSRS.exportToWkt(&pszWKT);
>> >>>>>         printf("%s\n", pszWKT);
>> >>>
>> >>> However, this requires me to set SetProjCS, SetWellKnownGeogCS and
>> >>> SetUTM first. I don't know these before I read the file. Is there any
>> >>> way to get them from the file so that I don't need prior knowledge to
>> >>> create the header. When I pull the GeoTIFF file into ENVI, all these
>> >>> information is already there. If this list is only or development
>> >>> purposes, please let me know if there is any other email list that
>> >>> can give me guidance on this quest.
>> >>>
>> >>> I appreciate your help and suggestions.
>> >>> Best regards,
>> >>> - Nevzat
>> >>>
>> >>> _______________________________________________
>> >>> gdal-dev mailing list
>> >>> gdal-dev at lists.osgeo.org
>> >>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>> >>
>> >> _______________________________________________
>> >> gdal-dev mailing list
>> >> gdal-dev at lists.osgeo.org
>> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>> >
>> > _______________________________________________
>> > gdal-dev mailing list
>> > gdal-dev at lists.osgeo.org
>> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>> Nevzat Guler
>> Senior Scientist
>> Spectral Sciences
>> Phone: 781-273-4770
>> http://www.spectral.com/index.shtml
>> http://www.linkedin.com/in/nevzatguler
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>


Nevzat Guler
Senior Scientist
Spectral Sciences
Phone: 781-273-4770
http://www.spectral.com/index.shtml
http://www.linkedin.com/in/nevzatguler



From nguler at jlab.org  Mon Jan 18 09:27:50 2016
From: nguler at jlab.org (nguler at jlab.org)
Date: Mon, 18 Jan 2016 12:27:50 -0500 (EST)
Subject: [gdal-dev] map info and projections from GeoTIFF file to create
 ENVI header
In-Reply-To: <40508.173.48.226.138.1453136034.squirrel@webmail.jlab.org>
References: <001c01d14fa8$989e5b70$c9db1250$@spectral.com>
 <006d01d15155$77cc9020$6765b060$@jlab.org>
 <39101.173.48.226.138.1453133594.squirrel@webmail.jlab.org>
 <201601181724.52513.even.rouault@spatialys.com>
 <40508.173.48.226.138.1453136034.squirrel@webmail.jlab.org>
Message-ID: <1829.173.48.226.138.1453138070.squirrel@webmail.jlab.org>

It is solved. Thank you very much Even and Dmitry for your helps. I have
missed the GDAL_DATA variable and it caused me all that trouble.

Now I need to get the map info string:
map info = {UTM, 1, 1, 145185, 2189715, 30, 30, 19, North,WGS-84}

Using hDS->GetGeoTransform(adfGeoTransform) does not give me all the
information in the map info string. It only gives me elements [4-7], how to
get the others?

Best regards, - Nevzat

> Yes, Thank you Even, I was missing the GDAL_DATA environmental variable. Now I
> get the same gdalinfo output. Do I need to set this variable while using the
> C++ classes you suggested before: GetGeoTransform and GetProjectionRef()..?
> Because, there also I had the same problem.
>
> Best regards, - Nevzat
>
>
>> Le lundi 18 janvier 2016 17:13:14, nguler at jlab.org a Ã©crit :
>>> Dmitry and All,
>>> I just downloaded the set of tiff files from earthexplorer and run gdalinfo
>>> on it. Please see below. I am missing some fields in the output
>>> information. It is different from what you got. I don't know what can
>>> cause this? My gdalinfo.exe is not good? Any idea?
>>
>> Have a look at the FAQ entries about GDAL_DATA :
>> https://trac.osgeo.org/gdal/wiki/FAQInstallationAndBuilding#WhatisGDAL_DATAenvironmentvariable
>>
>>>
>>> C:\Cubes\LC80080472013174LGN00.tar>gdalinfo LC80080472013174LGN00_B1.TIF
>>> Driver: GTiff/GeoTIFF
>>> Files: LC80080472013174LGN00_B1.TIF
>>>        .\LC80080472013174LGN00_MTL.txt
>>> Size is 7571, 7411
>>> Coordinate System is:
>>> PROJCS["unnamed",
>>>     PROJECTION["Transverse_Mercator"],
>>>     PARAMETER["latitude_of_origin",0],
>>>     PARAMETER["central_meridian",-69],
>>>     PARAMETER["scale_factor",0.9996],
>>>     PARAMETER["false_easting",500000],
>>>     PARAMETER["false_northing",0],
>>>     UNIT["metre",1,
>>>         AUTHORITY["EPSG","9001"]]]
>>> Origin = (145185.000000000000000,2189715.000000000000000)
>>> Pixel Size = (30.000000000000000,-30.000000000000000)
>>> Metadata:
>>>   AREA_OR_POINT=Point
>>>   METADATATYPE=ODL
>>> Image Structure Metadata:
>>>   INTERLEAVE=BAND
>>> Corner Coordinates:
>>> Upper Left  (  145185.000, 2189715.000)
>>> Lower Left  (  145185.000, 1967385.000)
>>> Upper Right (  372315.000, 2189715.000)
>>> Lower Right (  372315.000, 1967385.000)
>>> Center      (  258750.000, 2078550.000)
>>> Band 1 Block=7571x1 Type=UInt16, ColorInterp=Gray
>>>
>>> C:\Cubes\LC80080472013174LGN00.tar>gdalinfo --version
>>> GDAL 2.0.1, released 2015/09/15
>>>
>>> C:\Cubes\LC80080472013174LGN00.tar>
>>>
>>> > I have the 2.0.1 version:
>>> > C:\warmerda\bld\bin>gdalinfo --version
>>> > GDAL 2.0.1, released 2015/09/15
>>> >
>>> > I will check the history of the file I have. Maybe it is modified. I will
>>> > also download the same file from earthexplorer and try my routines on
>>> > it. Thanks for the suggestions. I appreciate.
>>> > - Nevzat
>>> >
>>> > -----Original Message-----
>>> > From: Dmitry Baryshnikov [mailto:bishop.dev at gmail.com]
>>> > Sent: Sunday, January 17, 2016 12:57 PM
>>> > To: Nevzat Guler <nguler at jlab.org>; gdal-dev at lists.osgeo.org
>>> > Subject: Re: [gdal-dev] map info and projections from GeoTIFF file to
>>> > create ENVI header
>>> >
>>> > I downloaded this scene from earthexplorer, and everything is fine:
>>> >
>>> > $ gdalinfo LC80080472013174LGN00_B1.TIF
>>> > Driver: GTiff/GeoTIFF
>>> > Files: LC80080472013174LGN00_B1.TIF
>>> >
>>> >         ./LC80080472013174LGN00_MTL.txt
>>> >
>>> > Size is 7571, 7411
>>> > Coordinate System is:
>>> > PROJCS["WGS 84 / UTM zone 19N",
>>> >
>>> >      GEOGCS["WGS 84",
>>> >
>>> >          DATUM["WGS_1984",
>>> >
>>> >              SPHEROID["WGS 84",6378137,298.257223563,
>>> >
>>> >                  AUTHORITY["EPSG","7030"]],
>>> >
>>> >              AUTHORITY["EPSG","6326"]],
>>> >
>>> >          PRIMEM["Greenwich",0,
>>> >
>>> >              AUTHORITY["EPSG","8901"]],
>>> >
>>> >          UNIT["degree",0.0174532925199433,
>>> >
>>> >              AUTHORITY["EPSG","9122"]],
>>> >
>>> >          AUTHORITY["EPSG","4326"]],
>>> >
>>> >      PROJECTION["Transverse_Mercator"],
>>> >      PARAMETER["latitude_of_origin",0],
>>> >      PARAMETER["central_meridian",-69],
>>> >      PARAMETER["scale_factor",0.9996],
>>> >      PARAMETER["false_easting",500000],
>>> >      PARAMETER["false_northing",0],
>>> >      UNIT["metre",1,
>>> >
>>> >          AUTHORITY["EPSG","9001"]],
>>> >
>>> >      AXIS["Easting",EAST],
>>> >      AXIS["Northing",NORTH],
>>> >      AUTHORITY["EPSG","32619"]]
>>> >
>>> > Origin = (145185.000000000000000,2189715.000000000000000)
>>> > Pixel Size = (30.000000000000000,-30.000000000000000)
>>> >
>>> > Metadata:
>>> >    AREA_OR_POINT=Point
>>> >    METADATATYPE=ODL
>>> >
>>> > Image Structure Metadata:
>>> >    INTERLEAVE=BAND
>>> >
>>> > Corner Coordinates:
>>> > Upper Left  (  145185.000, 2189715.000) ( 72d23' 7.97"W, 19d46'16.43"N)
>>> > Lower Left  (  145185.000, 1967385.000) ( 72d20'44.51"W, 17d45'55.15"N)
>>> > Upper Right (  372315.000, 2189715.000) ( 70d13' 8.50"W, 19d47'56.92"N)
>>> > Lower Right ( 372315.000, 1967385.000) ( 70d12'16.74"W, 17d47'24.74"N)
>>> > Center      (  258750.000, 2078550.000) ( 71d17'19.50"W, 18d47' 4.68"N)
>>> > Band 1 Block=7571x1 Type=UInt16, ColorInterp=Gray
>>> >
>>> > $ gdalinfo --version
>>> > GDAL 2.1.0dev, released 2015/99/99
>>> >
>>> > What is your gdal version? Maybe the Landsat geotiff was modified from
>>> > some software?
>>> >
>>> > Best regards,
>>> >
>>> >      Dmitry
>>> >
>>> > 17.01.2016 20:15, Nevzat Guler ÃÂ¿ÃÂ¸ÃÂÃÂµÃÂ:
>>> >> Thank you Dmitry,
>>> >> What is the best way to extract the information we got using
>>> >> gdalinfo.exe by using GDAL classes, within a C++ code? As I mentioned,
>>> >> I am using GetGeoTransform and GetProjectionRef() but the results miss
>>> >> many of the information (specifically the map info elements as I
>>> >> explained in the previous email).
>>> >>
>>> >> On another note, I actually get a different output from gdalinfo.exe
>>> >> using my file (please see the printed result below). I got the geotiff
>>> >> file from my colleague. When I open the file with ENVI, I get all the
>>> >> information, including GEOGCS information.
>>> >>
>>> >> Can it be that my file is just corrupted and that's why I don't get all
>>> >> the information from GetGeoTransform and GetProjectionRef()? But then
>>> >> how would ENVI is able to extract this information if it were not in
>>> >> the file?
>>> >>
>>> >> Thanks again, - Nevzat
>>> >>
>>> >> C:\Cubes\Landsat\LC80080472013174LGN00>gdalinfo
>>> >> LC80080472013174LGN00_B1.TIF
>>> >> Driver: GTiff/GeoTIFF
>>> >> Files: LC80080472013174LGN00_B1.TIF
>>> >>
>>> >>         .\LC80080472013174LGN00_MTL.txt Size is 7571, 7411 Coordinate
>>> >>
>>> >> System is:
>>> >> PROJCS["unnamed",
>>> >>
>>> >>      PROJECTION["Transverse_Mercator"],
>>> >>      PARAMETER["latitude_of_origin",0],
>>> >>      PARAMETER["central_meridian",-69],
>>> >>      PARAMETER["scale_factor",0.9996],
>>> >>      PARAMETER["false_easting",500000],
>>> >>      PARAMETER["false_northing",0],
>>> >>      UNIT["metre",1,
>>> >>
>>> >>          AUTHORITY["EPSG","9001"]]]
>>> >>
>>> >> Origin = (145185.000000000000000,2189715.000000000000000)
>>> >> Pixel Size = (30.000000000000000,-30.000000000000000)
>>> >>
>>> >> Metadata:
>>> >>    AREA_OR_POINT=Point
>>> >>    METADATATYPE=ODL
>>> >>
>>> >> Image Structure Metadata:
>>> >>    INTERLEAVE=BAND
>>> >>
>>> >> Corner Coordinates:
>>> >> Upper Left  (  145185.000, 2189715.000) Lower Left  (  145185.000,
>>> >> 1967385.000) Upper Right (  372315.000, 2189715.000) Lower Right (
>>> >> 372315.000, 1967385.000)
>>> >> Center      (  258750.000, 2078550.000)
>>> >> Band 1 Block=7571x1 Type=UInt16, ColorInterp=Gray
>>> >>
>>> >> -----Original Message-----
>>> >> From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of
>>> >> Dmitry Baryshnikov
>>> >> Sent: Sunday, January 17, 2016 6:57 AM
>>> >> To: gdal-dev at lists.osgeo.org
>>> >> Subject: Re: [gdal-dev] map info and projections from GeoTIFF file to
>>> >> create ENVI header
>>> >>
>>> >> Hi Nevzat,
>>> >>
>>> >> The landsat geotiff already have CRS embeded in file
>>> >>
>>> >> $ gdalinfo LC80150362013097LGN03_B1.TIF
>>> >> Driver: GTiff/GeoTIFF
>>> >> Files: LC80150362013097LGN03_B1.TIF
>>> >>
>>> >>          ./LC80150362013097LGN03_MTL.txt Size is 7281, 7261 Coordinate
>>> >>
>>> >> System is:
>>> >> PROJCS["WGS 84 / UTM zone 17N",
>>> >>
>>> >>       GEOGCS["WGS 84",
>>> >>
>>> >>           DATUM["WGS_1984",
>>> >>
>>> >>               SPHEROID["WGS 84",6378137,298.257223563,
>>> >>
>>> >>                   AUTHORITY["EPSG","7030"]],
>>> >>
>>> >>               AUTHORITY["EPSG","6326"]],
>>> >>
>>> >>           PRIMEM["Greenwich",0,
>>> >>
>>> >>               AUTHORITY["EPSG","8901"]],
>>> >>
>>> >>           UNIT["degree",0.0174532925199433,
>>> >>
>>> >>               AUTHORITY["EPSG","9122"]],
>>> >>
>>> >>           AUTHORITY["EPSG","4326"]],
>>> >>
>>> >>       PROJECTION["Transverse_Mercator"],
>>> >>       PARAMETER["latitude_of_origin",0],
>>> >>       PARAMETER["central_meridian",-81],
>>> >>       PARAMETER["scale_factor",0.9996],
>>> >>       PARAMETER["false_easting",500000],
>>> >>       PARAMETER["false_northing",0],
>>> >>       UNIT["metre",1,
>>> >>
>>> >>           AUTHORITY["EPSG","9001"]],
>>> >>
>>> >>       AXIS["Easting",EAST],
>>> >>       AXIS["Northing",NORTH],
>>> >>       AUTHORITY["EPSG","32617"]]
>>> >>
>>> >> Origin = (706185.000000000000000,3943515.000000000000000)
>>> >> Pixel Size = (30.000000000000000,-30.000000000000000)
>>> >>
>>> >> Metadata:
>>> >>     AREA_OR_POINT=Point
>>> >>     METADATATYPE=ODL
>>> >>
>>> >> Image Structure Metadata:
>>> >>     INTERLEAVE=BAND
>>> >>
>>> >> Corner Coordinates:
>>> >> Upper Left  (  706185.000, 3943515.000) ( 78d43'24.74"W, 35d36'50.15"N)
>>> >> Lower Left  (  706185.000, 3725685.000) ( 78d46'35.65"W, 33d39' 3.82"N)
>>> >> Upper Right (  924615.000, 3943515.000) ( 76d19' 2.05"W, 35d32'39.74"N)
>>> >> Lower Right (  924615.000, 3725685.000) ( 76d25'33.46"W, 33d35'10.99"N)
>>> >> Center      (  815400.000, 3834600.000) ( 77d33'38.95"W, 34d36'17.35"N)
>>> >> Band 1 Block=7281x1 Type=UInt16, ColorInterp=Gray
>>> >>
>>> >> And this is right CRS.
>>> >> Where do you get you geotiff?
>>> >>
>>> >> Best regards,
>>> >>
>>> >>       Dmitry
>>> >>
>>> >> 17.01.2016 03:41, Nevzat Guler ÃÂ¿ÃÂ¸ÃÂÃÂµÃÂ:
>>> >>> Dear experts,
>>> >>>
>>> >>> I am reading LANDSAT GeoTIFF files and combining bands to create and
>>> >>> ENVI cube.
>>> >>> I am using GDAL to read the GeoTIFF file, and my own custom cube
>>> >>> writer to write the ENVI style cube. Transferring the map information
>>> >>> proved to be a bit convoluted. I seek your help to figure out this.
>>> >>>
>>> >>> My first problem is to access map info from GeoTIFF file. The map
>>> >>> info
>>> >>> includes:
>>> >>>
>>> >>> map info = {UTM, 1.000, 1.000, 145185.000, 2189715.000,
>>> >>> 3.0000000000e+001, 3.0000000000e+001, 19, North, WGS-84,
>>> >>> units=Meters}
>>> >>>
>>> >>> I am able to get the location (x,y), and pixel size (x,y) from :
>>> >>> double adfGeoTransform[6];
>>> >>> srcDS->GetGeoTransform(adfGeoTransform);
>>> >>>
>>> >>> But, I could not find any way to get the other variables in the
>>> >>> string: UTM, pixel tie points, Unit and DATUM. Is there any way to get
>>> >>> them?
>>> >>>
>>> >>> Finally, for the Coordinate System String, GDAL gives me:
>>> >>>
>>> >>> PROJCS["unnamed",PROJECTION["Transverse_Mercator"],PARAMETER["latitud
>>> >>> e
>>> >>> _of_or
>>> >>> igin
>>> >>> ",0],PARAMETER["central_meridian",-69],PARAMETER["scale_factor",0.999
>>> >>> 6
>>> >>> ],PARA
>>> >>> METE
>>> >>> R["false_easting",500000],PARAMETER["false_northing",0],UNIT["Meter",
>>> >>> 1
>>> >>> ]]
>>> >>>
>>> >>> But I should actually get
>>> >>>
>>> >>> PROJCS["UTM_Zone_19N",GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS
>>> >>> 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],TOWGS84[0,0,0,0,0
>>> >>> ,
>>> >>> 0,0],A
>>> >>> UTHO
>>> >>> RITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],U
>>> >>> N
>>> >>> IT["de
>>> >>> gree
>>> >>> ",0.0174532925199433,AUTHORITY["EPSG","9108"]],AUTHORITY["EPSG","4326"
>>> >>> ]],PRO
>>> >>> JECT
>>> >>> ION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETE
>>> >>> R
>>> >>> ["cent
>>> >>> ral_
>>> >>> meridian",-69],PARAMETER["scale_factor",0.9996],PARAMETER["false_east
>>> >>> i
>>> >>> ng",50
>>> >>> 0000
>>> >>> ],PARAMETER["false_northing",0],UNIT["Meter",1]]
>>> >>>
>>> >>> GDAL gives me PROJCS, "unnamed". And no GEOGCS information is given.
>>> >>> I am able to get the coordinate system properties by using the
>>> >>> following commands but I first need to set few things to use
>>> >>> exportToWTK.
>>> >>>
>>> >>>>>         OGRSpatialReference oSRS;
>>> >>>>>         char *pszWKT = NULL;
>>> >>>>>         oSRS.SetProjCS("UTM_Zone_19N");
>>> >>>>>         oSRS.SetWellKnownGeogCS("WGS84");
>>> >>>>>         oSRS.SetUTM(19, TRUE);
>>> >>>>>         oSRS.SetWellKnownGeogCS("WGS84");
>>> >>>>>         oSRS.exportToWkt(&pszWKT);
>>> >>>>>         printf("%s\n", pszWKT);
>>> >>>
>>> >>> However, this requires me to set SetProjCS, SetWellKnownGeogCS and
>>> >>> SetUTM first. I don't know these before I read the file. Is there any
>>> >>> way to get them from the file so that I don't need prior knowledge to
>>> >>> create the header. When I pull the GeoTIFF file into ENVI, all these
>>> >>> information is already there. If this list is only or development
>>> >>> purposes, please let me know if there is any other email list that
>>> >>> can give me guidance on this quest.
>>> >>>
>>> >>> I appreciate your help and suggestions.
>>> >>> Best regards,
>>> >>> - Nevzat
>>> >>>
>>> >>> _______________________________________________
>>> >>> gdal-dev mailing list
>>> >>> gdal-dev at lists.osgeo.org
>>> >>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>> >>
>>> >> _______________________________________________
>>> >> gdal-dev mailing list
>>> >> gdal-dev at lists.osgeo.org
>>> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>> >
>>> > _______________________________________________
>>> > gdal-dev mailing list
>>> > gdal-dev at lists.osgeo.org
>>> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>> Nevzat Guler
>>> Senior Scientist
>>> Spectral Sciences
>>> Phone: 781-273-4770
>>> http://www.spectral.com/index.shtml
>>> http://www.linkedin.com/in/nevzatguler
>>>
>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>> --
>> Spatialys - Geospatial professional services
>> http://www.spatialys.com
>>
>
>
> Nevzat Guler
> Senior Scientist
> Spectral Sciences
> Phone: 781-273-4770
> http://www.spectral.com/index.shtml
> http://www.linkedin.com/in/nevzatguler
>
>


Nevzat Guler
Senior Scientist
Spectral Sciences
Phone: 781-273-4770
http://www.spectral.com/index.shtml
http://www.linkedin.com/in/nevzatguler



From bishop.dev at gmail.com  Mon Jan 18 09:38:38 2016
From: bishop.dev at gmail.com (Dmitry Baryshnikov)
Date: Mon, 18 Jan 2016 20:38:38 +0300
Subject: [gdal-dev] map info and projections from GeoTIFF file to create
 ENVI header
In-Reply-To: <1829.173.48.226.138.1453138070.squirrel@webmail.jlab.org>
References: <001c01d14fa8$989e5b70$c9db1250$@spectral.com>
 <006d01d15155$77cc9020$6765b060$@jlab.org>
 <39101.173.48.226.138.1453133594.squirrel@webmail.jlab.org>
 <201601181724.52513.even.rouault@spatialys.com>
 <40508.173.48.226.138.1453136034.squirrel@webmail.jlab.org>
 <1829.173.48.226.138.1453138070.squirrel@webmail.jlab.org>
Message-ID: <569D231E.7010107@gmail.com>

Hi Nevzat,

you need to get spatial reference from GDALDataset (via GetProjectionRef 
http://gdal.org/classGDALDataset.html#aa42537e1062ce254d124b29ff3ebe857) 
and convert it to OGRSpatialReference.

Than use exportToMICoordSys to get MI CRS string.

http://gdal.org/classOGRSpatialReference.html#a1f2908cd5ca33609844ef0c0ff2186ea

Best regards,
     Dmitry

18.01.2016 20:27, nguler at jlab.org пишет:
> It is solved. Thank you very much Even and Dmitry for your helps. I have
> missed the GDAL_DATA variable and it caused me all that trouble.
>
> Now I need to get the map info string:
> map info = {UTM, 1, 1, 145185, 2189715, 30, 30, 19, North,WGS-84}
>
> Using hDS->GetGeoTransform(adfGeoTransform) does not give me all the
> information in the map info string. It only gives me elements [4-7], how to
> get the others?
>
> Best regards, - Nevzat
>
>> Yes, Thank you Even, I was missing the GDAL_DATA environmental variable. Now I
>> get the same gdalinfo output. Do I need to set this variable while using the
>> C++ classes you suggested before: GetGeoTransform and GetProjectionRef()..?
>> Because, there also I had the same problem.
>>
>> Best regards, - Nevzat
>>
>>
>>> Le lundi 18 janvier 2016 17:13:14, nguler at jlab.org a Ã©crit :
>>>> Dmitry and All,
>>>> I just downloaded the set of tiff files from earthexplorer and run gdalinfo
>>>> on it. Please see below. I am missing some fields in the output
>>>> information. It is different from what you got. I don't know what can
>>>> cause this? My gdalinfo.exe is not good? Any idea?
>>> Have a look at the FAQ entries about GDAL_DATA :
>>> https://trac.osgeo.org/gdal/wiki/FAQInstallationAndBuilding#WhatisGDAL_DATAenvironmentvariable
>>>
>>>> C:\Cubes\LC80080472013174LGN00.tar>gdalinfo LC80080472013174LGN00_B1.TIF
>>>> Driver: GTiff/GeoTIFF
>>>> Files: LC80080472013174LGN00_B1.TIF
>>>>         .\LC80080472013174LGN00_MTL.txt
>>>> Size is 7571, 7411
>>>> Coordinate System is:
>>>> PROJCS["unnamed",
>>>>      PROJECTION["Transverse_Mercator"],
>>>>      PARAMETER["latitude_of_origin",0],
>>>>      PARAMETER["central_meridian",-69],
>>>>      PARAMETER["scale_factor",0.9996],
>>>>      PARAMETER["false_easting",500000],
>>>>      PARAMETER["false_northing",0],
>>>>      UNIT["metre",1,
>>>>          AUTHORITY["EPSG","9001"]]]
>>>> Origin = (145185.000000000000000,2189715.000000000000000)
>>>> Pixel Size = (30.000000000000000,-30.000000000000000)
>>>> Metadata:
>>>>    AREA_OR_POINT=Point
>>>>    METADATATYPE=ODL
>>>> Image Structure Metadata:
>>>>    INTERLEAVE=BAND
>>>> Corner Coordinates:
>>>> Upper Left  (  145185.000, 2189715.000)
>>>> Lower Left  (  145185.000, 1967385.000)
>>>> Upper Right (  372315.000, 2189715.000)
>>>> Lower Right (  372315.000, 1967385.000)
>>>> Center      (  258750.000, 2078550.000)
>>>> Band 1 Block=7571x1 Type=UInt16, ColorInterp=Gray
>>>>
>>>> C:\Cubes\LC80080472013174LGN00.tar>gdalinfo --version
>>>> GDAL 2.0.1, released 2015/09/15
>>>>
>>>> C:\Cubes\LC80080472013174LGN00.tar>
>>>>
>>>>> I have the 2.0.1 version:
>>>>> C:\warmerda\bld\bin>gdalinfo --version
>>>>> GDAL 2.0.1, released 2015/09/15
>>>>>
>>>>> I will check the history of the file I have. Maybe it is modified. I will
>>>>> also download the same file from earthexplorer and try my routines on
>>>>> it. Thanks for the suggestions. I appreciate.
>>>>> - Nevzat
>>>>>
>>>>> -----Original Message-----
>>>>> From: Dmitry Baryshnikov [mailto:bishop.dev at gmail.com]
>>>>> Sent: Sunday, January 17, 2016 12:57 PM
>>>>> To: Nevzat Guler <nguler at jlab.org>; gdal-dev at lists.osgeo.org
>>>>> Subject: Re: [gdal-dev] map info and projections from GeoTIFF file to
>>>>> create ENVI header
>>>>>
>>>>> I downloaded this scene from earthexplorer, and everything is fine:
>>>>>
>>>>> $ gdalinfo LC80080472013174LGN00_B1.TIF
>>>>> Driver: GTiff/GeoTIFF
>>>>> Files: LC80080472013174LGN00_B1.TIF
>>>>>
>>>>>          ./LC80080472013174LGN00_MTL.txt
>>>>>
>>>>> Size is 7571, 7411
>>>>> Coordinate System is:
>>>>> PROJCS["WGS 84 / UTM zone 19N",
>>>>>
>>>>>       GEOGCS["WGS 84",
>>>>>
>>>>>           DATUM["WGS_1984",
>>>>>
>>>>>               SPHEROID["WGS 84",6378137,298.257223563,
>>>>>
>>>>>                   AUTHORITY["EPSG","7030"]],
>>>>>
>>>>>               AUTHORITY["EPSG","6326"]],
>>>>>
>>>>>           PRIMEM["Greenwich",0,
>>>>>
>>>>>               AUTHORITY["EPSG","8901"]],
>>>>>
>>>>>           UNIT["degree",0.0174532925199433,
>>>>>
>>>>>               AUTHORITY["EPSG","9122"]],
>>>>>
>>>>>           AUTHORITY["EPSG","4326"]],
>>>>>
>>>>>       PROJECTION["Transverse_Mercator"],
>>>>>       PARAMETER["latitude_of_origin",0],
>>>>>       PARAMETER["central_meridian",-69],
>>>>>       PARAMETER["scale_factor",0.9996],
>>>>>       PARAMETER["false_easting",500000],
>>>>>       PARAMETER["false_northing",0],
>>>>>       UNIT["metre",1,
>>>>>
>>>>>           AUTHORITY["EPSG","9001"]],
>>>>>
>>>>>       AXIS["Easting",EAST],
>>>>>       AXIS["Northing",NORTH],
>>>>>       AUTHORITY["EPSG","32619"]]
>>>>>
>>>>> Origin = (145185.000000000000000,2189715.000000000000000)
>>>>> Pixel Size = (30.000000000000000,-30.000000000000000)
>>>>>
>>>>> Metadata:
>>>>>     AREA_OR_POINT=Point
>>>>>     METADATATYPE=ODL
>>>>>
>>>>> Image Structure Metadata:
>>>>>     INTERLEAVE=BAND
>>>>>
>>>>> Corner Coordinates:
>>>>> Upper Left  (  145185.000, 2189715.000) ( 72d23' 7.97"W, 19d46'16.43"N)
>>>>> Lower Left  (  145185.000, 1967385.000) ( 72d20'44.51"W, 17d45'55.15"N)
>>>>> Upper Right (  372315.000, 2189715.000) ( 70d13' 8.50"W, 19d47'56.92"N)
>>>>> Lower Right ( 372315.000, 1967385.000) ( 70d12'16.74"W, 17d47'24.74"N)
>>>>> Center      (  258750.000, 2078550.000) ( 71d17'19.50"W, 18d47' 4.68"N)
>>>>> Band 1 Block=7571x1 Type=UInt16, ColorInterp=Gray
>>>>>
>>>>> $ gdalinfo --version
>>>>> GDAL 2.1.0dev, released 2015/99/99
>>>>>
>>>>> What is your gdal version? Maybe the Landsat geotiff was modified from
>>>>> some software?
>>>>>
>>>>> Best regards,
>>>>>
>>>>>       Dmitry
>>>>>
>>>>> 17.01.2016 20:15, Nevzat Guler ÃÂ¿ÃÂ¸ÃÂÃÂµÃÂ:
>>>>>> Thank you Dmitry,
>>>>>> What is the best way to extract the information we got using
>>>>>> gdalinfo.exe by using GDAL classes, within a C++ code? As I mentioned,
>>>>>> I am using GetGeoTransform and GetProjectionRef() but the results miss
>>>>>> many of the information (specifically the map info elements as I
>>>>>> explained in the previous email).
>>>>>>
>>>>>> On another note, I actually get a different output from gdalinfo.exe
>>>>>> using my file (please see the printed result below). I got the geotiff
>>>>>> file from my colleague. When I open the file with ENVI, I get all the
>>>>>> information, including GEOGCS information.
>>>>>>
>>>>>> Can it be that my file is just corrupted and that's why I don't get all
>>>>>> the information from GetGeoTransform and GetProjectionRef()? But then
>>>>>> how would ENVI is able to extract this information if it were not in
>>>>>> the file?
>>>>>>
>>>>>> Thanks again, - Nevzat
>>>>>>
>>>>>> C:\Cubes\Landsat\LC80080472013174LGN00>gdalinfo
>>>>>> LC80080472013174LGN00_B1.TIF
>>>>>> Driver: GTiff/GeoTIFF
>>>>>> Files: LC80080472013174LGN00_B1.TIF
>>>>>>
>>>>>>          .\LC80080472013174LGN00_MTL.txt Size is 7571, 7411 Coordinate
>>>>>>
>>>>>> System is:
>>>>>> PROJCS["unnamed",
>>>>>>
>>>>>>       PROJECTION["Transverse_Mercator"],
>>>>>>       PARAMETER["latitude_of_origin",0],
>>>>>>       PARAMETER["central_meridian",-69],
>>>>>>       PARAMETER["scale_factor",0.9996],
>>>>>>       PARAMETER["false_easting",500000],
>>>>>>       PARAMETER["false_northing",0],
>>>>>>       UNIT["metre",1,
>>>>>>
>>>>>>           AUTHORITY["EPSG","9001"]]]
>>>>>>
>>>>>> Origin = (145185.000000000000000,2189715.000000000000000)
>>>>>> Pixel Size = (30.000000000000000,-30.000000000000000)
>>>>>>
>>>>>> Metadata:
>>>>>>     AREA_OR_POINT=Point
>>>>>>     METADATATYPE=ODL
>>>>>>
>>>>>> Image Structure Metadata:
>>>>>>     INTERLEAVE=BAND
>>>>>>
>>>>>> Corner Coordinates:
>>>>>> Upper Left  (  145185.000, 2189715.000) Lower Left  (  145185.000,
>>>>>> 1967385.000) Upper Right (  372315.000, 2189715.000) Lower Right (
>>>>>> 372315.000, 1967385.000)
>>>>>> Center      (  258750.000, 2078550.000)
>>>>>> Band 1 Block=7571x1 Type=UInt16, ColorInterp=Gray
>>>>>>
>>>>>> -----Original Message-----
>>>>>> From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of
>>>>>> Dmitry Baryshnikov
>>>>>> Sent: Sunday, January 17, 2016 6:57 AM
>>>>>> To: gdal-dev at lists.osgeo.org
>>>>>> Subject: Re: [gdal-dev] map info and projections from GeoTIFF file to
>>>>>> create ENVI header
>>>>>>
>>>>>> Hi Nevzat,
>>>>>>
>>>>>> The landsat geotiff already have CRS embeded in file
>>>>>>
>>>>>> $ gdalinfo LC80150362013097LGN03_B1.TIF
>>>>>> Driver: GTiff/GeoTIFF
>>>>>> Files: LC80150362013097LGN03_B1.TIF
>>>>>>
>>>>>>           ./LC80150362013097LGN03_MTL.txt Size is 7281, 7261 Coordinate
>>>>>>
>>>>>> System is:
>>>>>> PROJCS["WGS 84 / UTM zone 17N",
>>>>>>
>>>>>>        GEOGCS["WGS 84",
>>>>>>
>>>>>>            DATUM["WGS_1984",
>>>>>>
>>>>>>                SPHEROID["WGS 84",6378137,298.257223563,
>>>>>>
>>>>>>                    AUTHORITY["EPSG","7030"]],
>>>>>>
>>>>>>                AUTHORITY["EPSG","6326"]],
>>>>>>
>>>>>>            PRIMEM["Greenwich",0,
>>>>>>
>>>>>>                AUTHORITY["EPSG","8901"]],
>>>>>>
>>>>>>            UNIT["degree",0.0174532925199433,
>>>>>>
>>>>>>                AUTHORITY["EPSG","9122"]],
>>>>>>
>>>>>>            AUTHORITY["EPSG","4326"]],
>>>>>>
>>>>>>        PROJECTION["Transverse_Mercator"],
>>>>>>        PARAMETER["latitude_of_origin",0],
>>>>>>        PARAMETER["central_meridian",-81],
>>>>>>        PARAMETER["scale_factor",0.9996],
>>>>>>        PARAMETER["false_easting",500000],
>>>>>>        PARAMETER["false_northing",0],
>>>>>>        UNIT["metre",1,
>>>>>>
>>>>>>            AUTHORITY["EPSG","9001"]],
>>>>>>
>>>>>>        AXIS["Easting",EAST],
>>>>>>        AXIS["Northing",NORTH],
>>>>>>        AUTHORITY["EPSG","32617"]]
>>>>>>
>>>>>> Origin = (706185.000000000000000,3943515.000000000000000)
>>>>>> Pixel Size = (30.000000000000000,-30.000000000000000)
>>>>>>
>>>>>> Metadata:
>>>>>>      AREA_OR_POINT=Point
>>>>>>      METADATATYPE=ODL
>>>>>>
>>>>>> Image Structure Metadata:
>>>>>>      INTERLEAVE=BAND
>>>>>>
>>>>>> Corner Coordinates:
>>>>>> Upper Left  (  706185.000, 3943515.000) ( 78d43'24.74"W, 35d36'50.15"N)
>>>>>> Lower Left  (  706185.000, 3725685.000) ( 78d46'35.65"W, 33d39' 3.82"N)
>>>>>> Upper Right (  924615.000, 3943515.000) ( 76d19' 2.05"W, 35d32'39.74"N)
>>>>>> Lower Right (  924615.000, 3725685.000) ( 76d25'33.46"W, 33d35'10.99"N)
>>>>>> Center      (  815400.000, 3834600.000) ( 77d33'38.95"W, 34d36'17.35"N)
>>>>>> Band 1 Block=7281x1 Type=UInt16, ColorInterp=Gray
>>>>>>
>>>>>> And this is right CRS.
>>>>>> Where do you get you geotiff?
>>>>>>
>>>>>> Best regards,
>>>>>>
>>>>>>        Dmitry
>>>>>>
>>>>>> 17.01.2016 03:41, Nevzat Guler ÃÂ¿ÃÂ¸ÃÂÃÂµÃÂ:
>>>>>>> Dear experts,
>>>>>>>
>>>>>>> I am reading LANDSAT GeoTIFF files and combining bands to create and
>>>>>>> ENVI cube.
>>>>>>> I am using GDAL to read the GeoTIFF file, and my own custom cube
>>>>>>> writer to write the ENVI style cube. Transferring the map information
>>>>>>> proved to be a bit convoluted. I seek your help to figure out this.
>>>>>>>
>>>>>>> My first problem is to access map info from GeoTIFF file. The map
>>>>>>> info
>>>>>>> includes:
>>>>>>>
>>>>>>> map info = {UTM, 1.000, 1.000, 145185.000, 2189715.000,
>>>>>>> 3.0000000000e+001, 3.0000000000e+001, 19, North, WGS-84,
>>>>>>> units=Meters}
>>>>>>>
>>>>>>> I am able to get the location (x,y), and pixel size (x,y) from :
>>>>>>> double adfGeoTransform[6];
>>>>>>> srcDS->GetGeoTransform(adfGeoTransform);
>>>>>>>
>>>>>>> But, I could not find any way to get the other variables in the
>>>>>>> string: UTM, pixel tie points, Unit and DATUM. Is there any way to get
>>>>>>> them?
>>>>>>>
>>>>>>> Finally, for the Coordinate System String, GDAL gives me:
>>>>>>>
>>>>>>> PROJCS["unnamed",PROJECTION["Transverse_Mercator"],PARAMETER["latitud
>>>>>>> e
>>>>>>> _of_or
>>>>>>> igin
>>>>>>> ",0],PARAMETER["central_meridian",-69],PARAMETER["scale_factor",0.999
>>>>>>> 6
>>>>>>> ],PARA
>>>>>>> METE
>>>>>>> R["false_easting",500000],PARAMETER["false_northing",0],UNIT["Meter",
>>>>>>> 1
>>>>>>> ]]
>>>>>>>
>>>>>>> But I should actually get
>>>>>>>
>>>>>>> PROJCS["UTM_Zone_19N",GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS
>>>>>>> 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],TOWGS84[0,0,0,0,0
>>>>>>> ,
>>>>>>> 0,0],A
>>>>>>> UTHO
>>>>>>> RITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],U
>>>>>>> N
>>>>>>> IT["de
>>>>>>> gree
>>>>>>> ",0.0174532925199433,AUTHORITY["EPSG","9108"]],AUTHORITY["EPSG","4326"
>>>>>>> ]],PRO
>>>>>>> JECT
>>>>>>> ION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETE
>>>>>>> R
>>>>>>> ["cent
>>>>>>> ral_
>>>>>>> meridian",-69],PARAMETER["scale_factor",0.9996],PARAMETER["false_east
>>>>>>> i
>>>>>>> ng",50
>>>>>>> 0000
>>>>>>> ],PARAMETER["false_northing",0],UNIT["Meter",1]]
>>>>>>>
>>>>>>> GDAL gives me PROJCS, "unnamed". And no GEOGCS information is given.
>>>>>>> I am able to get the coordinate system properties by using the
>>>>>>> following commands but I first need to set few things to use
>>>>>>> exportToWTK.
>>>>>>>
>>>>>>>>>          OGRSpatialReference oSRS;
>>>>>>>>>          char *pszWKT = NULL;
>>>>>>>>>          oSRS.SetProjCS("UTM_Zone_19N");
>>>>>>>>>          oSRS.SetWellKnownGeogCS("WGS84");
>>>>>>>>>          oSRS.SetUTM(19, TRUE);
>>>>>>>>>          oSRS.SetWellKnownGeogCS("WGS84");
>>>>>>>>>          oSRS.exportToWkt(&pszWKT);
>>>>>>>>>          printf("%s\n", pszWKT);
>>>>>>> However, this requires me to set SetProjCS, SetWellKnownGeogCS and
>>>>>>> SetUTM first. I don't know these before I read the file. Is there any
>>>>>>> way to get them from the file so that I don't need prior knowledge to
>>>>>>> create the header. When I pull the GeoTIFF file into ENVI, all these
>>>>>>> information is already there. If this list is only or development
>>>>>>> purposes, please let me know if there is any other email list that
>>>>>>> can give me guidance on this quest.
>>>>>>>
>>>>>>> I appreciate your help and suggestions.
>>>>>>> Best regards,
>>>>>>> - Nevzat
>>>>>>>
>>>>>>> _______________________________________________
>>>>>>> gdal-dev mailing list
>>>>>>> gdal-dev at lists.osgeo.org
>>>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>>> _______________________________________________
>>>>>> gdal-dev mailing list
>>>>>> gdal-dev at lists.osgeo.org
>>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>> _______________________________________________
>>>>> gdal-dev mailing list
>>>>> gdal-dev at lists.osgeo.org
>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>> Nevzat Guler
>>>> Senior Scientist
>>>> Spectral Sciences
>>>> Phone: 781-273-4770
>>>> http://www.spectral.com/index.shtml
>>>> http://www.linkedin.com/in/nevzatguler
>>>>
>>>>
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev at lists.osgeo.org
>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>> --
>>> Spatialys - Geospatial professional services
>>> http://www.spatialys.com
>>>
>>
>> Nevzat Guler
>> Senior Scientist
>> Spectral Sciences
>> Phone: 781-273-4770
>> http://www.spectral.com/index.shtml
>> http://www.linkedin.com/in/nevzatguler
>>
>>
>
> Nevzat Guler
> Senior Scientist
> Spectral Sciences
> Phone: 781-273-4770
> http://www.spectral.com/index.shtml
> http://www.linkedin.com/in/nevzatguler
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From boxerab at gmail.com  Mon Jan 18 10:59:01 2016
From: boxerab at gmail.com (Aaron Boxer)
Date: Mon, 18 Jan 2016 13:59:01 -0500
Subject: [gdal-dev] GDAL license and copyright
Message-ID: <CAK8GPyBSfg8wrMSxT82-xqOfO13E8yEj+ZnYMdbxOLjvqQeoxQ@mail.gmail.com>

Hello,

I am trying to learn more about how open source projects manage copyright
of contributors.
I see that various GDAL files have different copyright assignees, although
they all use the MIT
license.

Is this difficult to manage? For example, if GDAL is packaged for a
distribution such as Fedora,
how do you manage the license for the package?  Also, if a new contributor
were to add new functionality in a new file, is it ok for them to assign
copyright to themselves when submitting to the trunk ?

Thanks very much,
Aaron
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160118/4e13d24b/attachment.html>

From even.rouault at spatialys.com  Mon Jan 18 11:22:00 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 18 Jan 2016 20:22:00 +0100
Subject: [gdal-dev] GDAL license and copyright
In-Reply-To: <CAK8GPyBSfg8wrMSxT82-xqOfO13E8yEj+ZnYMdbxOLjvqQeoxQ@mail.gmail.com>
References: <CAK8GPyBSfg8wrMSxT82-xqOfO13E8yEj+ZnYMdbxOLjvqQeoxQ@mail.gmail.com>
Message-ID: <201601182022.00930.even.rouault@spatialys.com>

Le lundi 18 janvier 2016 19:59:01, Aaron Boxer a écrit :
> Hello,
> 
> I am trying to learn more about how open source projects manage copyright
> of contributors.
> I see that various GDAL files have different copyright assignees, although
> they all use the MIT
> license.
> 
> Is this difficult to manage? 

Not until now. Copyright assignment to a single entity can be useful when 
dealing with potential future license changes, but given that X/MIT is one of 
the less restrictive license, it is unlikely to be needed to be changed.

> For example, if GDAL is packaged for a
> distribution such as Fedora,
> how do you manage the license for the package? 

I think distributions refer to the LICENSE.TXT file at the root of GDAL source 
tree. The global licensing implications can however by more complex if you 
link GDAL with third-party libraries that can be GPL, LGPL, proprietary, 
etc...

> Also, if a new contributor
> were to add new functionality in a new file, is it ok for them to assign
> copyright to themselves when submitting to the trunk ?

Yes.

> 
> Thanks very much,
> Aaron

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From boxerab at gmail.com  Mon Jan 18 11:21:33 2016
From: boxerab at gmail.com (Aaron Boxer)
Date: Mon, 18 Jan 2016 14:21:33 -0500
Subject: [gdal-dev] GDAL license and copyright
In-Reply-To: <201601182022.00930.even.rouault@spatialys.com>
References: <CAK8GPyBSfg8wrMSxT82-xqOfO13E8yEj+ZnYMdbxOLjvqQeoxQ@mail.gmail.com>
 <201601182022.00930.even.rouault@spatialys.com>
Message-ID: <CAK8GPyDG4AvnvnQoNP=Mp6_B0_2GZtn3ZkgTB1GHLrCzored5Q@mail.gmail.com>

On Mon, Jan 18, 2016 at 2:22 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le lundi 18 janvier 2016 19:59:01, Aaron Boxer a écrit :
> > Hello,
> >
> > I am trying to learn more about how open source projects manage copyright
> > of contributors.
> > I see that various GDAL files have different copyright assignees,
> although
> > they all use the MIT
> > license.
> >
> > Is this difficult to manage?
>
> Not until now. Copyright assignment to a single entity can be useful when
> dealing with potential future license changes, but given that X/MIT is one
> of
> the less restrictive license, it is unlikely to be needed to be changed.
>
> > For example, if GDAL is packaged for a
> > distribution such as Fedora,
> > how do you manage the license for the package?
>
> I think distributions refer to the LICENSE.TXT file at the root of GDAL
> source
> tree. The global licensing implications can however by more complex if you
> link GDAL with third-party libraries that can be GPL, LGPL, proprietary,
> etc...
>
> > Also, if a new contributor
> > were to add new functionality in a new file, is it ok for them to assign
> > copyright to themselves when submitting to the trunk ?
>
> Yes.
>
>
Awesome, thanks!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160118/6e3f80e6/attachment-0001.html>

From nguler at jlab.org  Mon Jan 18 13:33:02 2016
From: nguler at jlab.org (nguler at jlab.org)
Date: Mon, 18 Jan 2016 16:33:02 -0500 (EST)
Subject: [gdal-dev] map info and projections from GeoTIFF file to create
 ENVI header
In-Reply-To: <569D231E.7010107@gmail.com>
References: <001c01d14fa8$989e5b70$c9db1250$@spectral.com>
 <006d01d15155$77cc9020$6765b060$@jlab.org>
 <39101.173.48.226.138.1453133594.squirrel@webmail.jlab.org>
 <201601181724.52513.even.rouault@spatialys.com>
 <40508.173.48.226.138.1453136034.squirrel@webmail.jlab.org>
 <1829.173.48.226.138.1453138070.squirrel@webmail.jlab.org>
 <569D231E.7010107@gmail.com>
Message-ID: <10464.173.48.226.138.1453152782.squirrel@webmail.jlab.org>

Dmitry,

After doing this, I following your suggested steps, I get the string:

Earth Projection 8, 104, "m", -69, 0, 0.9996, 500000, 0

Bit, the map info string I need to use looks like this:

map info = {UTM, 1, 1, 145185, 2189715, 30, 30, 19, North}

I tried other ExportTo functions but none gives me the specific map info
string I want. This is ENVI map info string.

I guess I will just have to stitch it together once I understand what the
second and third elements are used for..

I really appreciated your help.
Best regards, - Nevzat


> Hi Nevzat,
>
> you need to get spatial reference from GDALDataset (via GetProjectionRef
> http://gdal.org/classGDALDataset.html#aa42537e1062ce254d124b29ff3ebe857)
> and convert it to OGRSpatialReference.
>
> Than use exportToMICoordSys to get MI CRS string.
>
> http://gdal.org/classOGRSpatialReference.html#a1f2908cd5ca33609844ef0c0ff2186ea
>
> Best regards,
>      Dmitry
>
> 18.01.2016 20:27, nguler at jlab.org Ð¿Ð¸ÑÐµÑ:
>> It is solved. Thank you very much Even and Dmitry for your helps. I have
>> missed the GDAL_DATA variable and it caused me all that trouble.
>>
>> Now I need to get the map info string:
>> map info = {UTM, 1, 1, 145185, 2189715, 30, 30, 19, North,WGS-84}
>>
>> Using hDS->GetGeoTransform(adfGeoTransform) does not give me all the
>> information in the map info string. It only gives me elements [4-7], how to
>> get the others?
>>
>> Best regards, - Nevzat
>>
>>> Yes, Thank you Even, I was missing the GDAL_DATA environmental variable.
>>> Now I
>>> get the same gdalinfo output. Do I need to set this variable while using
>>> the
>>> C++ classes you suggested before: GetGeoTransform and GetProjectionRef()..?
>>> Because, there also I had the same problem.
>>>
>>> Best regards, - Nevzat
>>>
>>>
>>>> Le lundi 18 janvier 2016 17:13:14, nguler at jlab.org a ÃÂ©crit :
>>>>> Dmitry and All,
>>>>> I just downloaded the set of tiff files from earthexplorer and run
>>>>> gdalinfo
>>>>> on it. Please see below. I am missing some fields in the output
>>>>> information. It is different from what you got. I don't know what can
>>>>> cause this? My gdalinfo.exe is not good? Any idea?
>>>> Have a look at the FAQ entries about GDAL_DATA :
>>>> https://trac.osgeo.org/gdal/wiki/FAQInstallationAndBuilding#WhatisGDAL_DATAenvironmentvariable
>>>>
>>>>> C:\Cubes\LC80080472013174LGN00.tar>gdalinfo LC80080472013174LGN00_B1.TIF
>>>>> Driver: GTiff/GeoTIFF
>>>>> Files: LC80080472013174LGN00_B1.TIF
>>>>>         .\LC80080472013174LGN00_MTL.txt
>>>>> Size is 7571, 7411
>>>>> Coordinate System is:
>>>>> PROJCS["unnamed",
>>>>>      PROJECTION["Transverse_Mercator"],
>>>>>      PARAMETER["latitude_of_origin",0],
>>>>>      PARAMETER["central_meridian",-69],
>>>>>      PARAMETER["scale_factor",0.9996],
>>>>>      PARAMETER["false_easting",500000],
>>>>>      PARAMETER["false_northing",0],
>>>>>      UNIT["metre",1,
>>>>>          AUTHORITY["EPSG","9001"]]]
>>>>> Origin = (145185.000000000000000,2189715.000000000000000)
>>>>> Pixel Size = (30.000000000000000,-30.000000000000000)
>>>>> Metadata:
>>>>>    AREA_OR_POINT=Point
>>>>>    METADATATYPE=ODL
>>>>> Image Structure Metadata:
>>>>>    INTERLEAVE=BAND
>>>>> Corner Coordinates:
>>>>> Upper Left  (  145185.000, 2189715.000)
>>>>> Lower Left  (  145185.000, 1967385.000)
>>>>> Upper Right (  372315.000, 2189715.000)
>>>>> Lower Right (  372315.000, 1967385.000)
>>>>> Center      (  258750.000, 2078550.000)
>>>>> Band 1 Block=7571x1 Type=UInt16, ColorInterp=Gray
>>>>>
>>>>> C:\Cubes\LC80080472013174LGN00.tar>gdalinfo --version
>>>>> GDAL 2.0.1, released 2015/09/15
>>>>>
>>>>> C:\Cubes\LC80080472013174LGN00.tar>
>>>>>
>>>>>> I have the 2.0.1 version:
>>>>>> C:\warmerda\bld\bin>gdalinfo --version
>>>>>> GDAL 2.0.1, released 2015/09/15
>>>>>>
>>>>>> I will check the history of the file I have. Maybe it is modified. I
>>>>>> will
>>>>>> also download the same file from earthexplorer and try my routines on
>>>>>> it. Thanks for the suggestions. I appreciate.
>>>>>> - Nevzat
>>>>>>
>>>>>> -----Original Message-----
>>>>>> From: Dmitry Baryshnikov [mailto:bishop.dev at gmail.com]
>>>>>> Sent: Sunday, January 17, 2016 12:57 PM
>>>>>> To: Nevzat Guler <nguler at jlab.org>; gdal-dev at lists.osgeo.org
>>>>>> Subject: Re: [gdal-dev] map info and projections from GeoTIFF file to
>>>>>> create ENVI header
>>>>>>
>>>>>> I downloaded this scene from earthexplorer, and everything is fine:
>>>>>>
>>>>>> $ gdalinfo LC80080472013174LGN00_B1.TIF
>>>>>> Driver: GTiff/GeoTIFF
>>>>>> Files: LC80080472013174LGN00_B1.TIF
>>>>>>
>>>>>>          ./LC80080472013174LGN00_MTL.txt
>>>>>>
>>>>>> Size is 7571, 7411
>>>>>> Coordinate System is:
>>>>>> PROJCS["WGS 84 / UTM zone 19N",
>>>>>>
>>>>>>       GEOGCS["WGS 84",
>>>>>>
>>>>>>           DATUM["WGS_1984",
>>>>>>
>>>>>>               SPHEROID["WGS 84",6378137,298.257223563,
>>>>>>
>>>>>>                   AUTHORITY["EPSG","7030"]],
>>>>>>
>>>>>>               AUTHORITY["EPSG","6326"]],
>>>>>>
>>>>>>           PRIMEM["Greenwich",0,
>>>>>>
>>>>>>               AUTHORITY["EPSG","8901"]],
>>>>>>
>>>>>>           UNIT["degree",0.0174532925199433,
>>>>>>
>>>>>>               AUTHORITY["EPSG","9122"]],
>>>>>>
>>>>>>           AUTHORITY["EPSG","4326"]],
>>>>>>
>>>>>>       PROJECTION["Transverse_Mercator"],
>>>>>>       PARAMETER["latitude_of_origin",0],
>>>>>>       PARAMETER["central_meridian",-69],
>>>>>>       PARAMETER["scale_factor",0.9996],
>>>>>>       PARAMETER["false_easting",500000],
>>>>>>       PARAMETER["false_northing",0],
>>>>>>       UNIT["metre",1,
>>>>>>
>>>>>>           AUTHORITY["EPSG","9001"]],
>>>>>>
>>>>>>       AXIS["Easting",EAST],
>>>>>>       AXIS["Northing",NORTH],
>>>>>>       AUTHORITY["EPSG","32619"]]
>>>>>>
>>>>>> Origin = (145185.000000000000000,2189715.000000000000000)
>>>>>> Pixel Size = (30.000000000000000,-30.000000000000000)
>>>>>>
>>>>>> Metadata:
>>>>>>     AREA_OR_POINT=Point
>>>>>>     METADATATYPE=ODL
>>>>>>
>>>>>> Image Structure Metadata:
>>>>>>     INTERLEAVE=BAND
>>>>>>
>>>>>> Corner Coordinates:
>>>>>> Upper Left  (  145185.000, 2189715.000) ( 72d23' 7.97"W, 19d46'16.43"N)
>>>>>> Lower Left  (  145185.000, 1967385.000) ( 72d20'44.51"W, 17d45'55.15"N)
>>>>>> Upper Right (  372315.000, 2189715.000) ( 70d13' 8.50"W, 19d47'56.92"N)
>>>>>> Lower Right ( 372315.000, 1967385.000) ( 70d12'16.74"W, 17d47'24.74"N)
>>>>>> Center      (  258750.000, 2078550.000) ( 71d17'19.50"W, 18d47' 4.68"N)
>>>>>> Band 1 Block=7571x1 Type=UInt16, ColorInterp=Gray
>>>>>>
>>>>>> $ gdalinfo --version
>>>>>> GDAL 2.1.0dev, released 2015/99/99
>>>>>>
>>>>>> What is your gdal version? Maybe the Landsat geotiff was modified from
>>>>>> some software?
>>>>>>
>>>>>> Best regards,
>>>>>>
>>>>>>       Dmitry
>>>>>>
>>>>>> 17.01.2016 20:15, Nevzat Guler ÃÂÃÂ¿ÃÂÃÂ¸ÃÂÃÂÃÂÃÂµÃÂÃÂ:
>>>>>>> Thank you Dmitry,
>>>>>>> What is the best way to extract the information we got using
>>>>>>> gdalinfo.exe by using GDAL classes, within a C++ code? As I mentioned,
>>>>>>> I am using GetGeoTransform and GetProjectionRef() but the results miss
>>>>>>> many of the information (specifically the map info elements as I
>>>>>>> explained in the previous email).
>>>>>>>
>>>>>>> On another note, I actually get a different output from gdalinfo.exe
>>>>>>> using my file (please see the printed result below). I got the geotiff
>>>>>>> file from my colleague. When I open the file with ENVI, I get all the
>>>>>>> information, including GEOGCS information.
>>>>>>>
>>>>>>> Can it be that my file is just corrupted and that's why I don't get all
>>>>>>> the information from GetGeoTransform and GetProjectionRef()? But then
>>>>>>> how would ENVI is able to extract this information if it were not in
>>>>>>> the file?
>>>>>>>
>>>>>>> Thanks again, - Nevzat
>>>>>>>
>>>>>>> C:\Cubes\Landsat\LC80080472013174LGN00>gdalinfo
>>>>>>> LC80080472013174LGN00_B1.TIF
>>>>>>> Driver: GTiff/GeoTIFF
>>>>>>> Files: LC80080472013174LGN00_B1.TIF
>>>>>>>
>>>>>>>          .\LC80080472013174LGN00_MTL.txt Size is 7571, 7411 Coordinate
>>>>>>>
>>>>>>> System is:
>>>>>>> PROJCS["unnamed",
>>>>>>>
>>>>>>>       PROJECTION["Transverse_Mercator"],
>>>>>>>       PARAMETER["latitude_of_origin",0],
>>>>>>>       PARAMETER["central_meridian",-69],
>>>>>>>       PARAMETER["scale_factor",0.9996],
>>>>>>>       PARAMETER["false_easting",500000],
>>>>>>>       PARAMETER["false_northing",0],
>>>>>>>       UNIT["metre",1,
>>>>>>>
>>>>>>>           AUTHORITY["EPSG","9001"]]]
>>>>>>>
>>>>>>> Origin = (145185.000000000000000,2189715.000000000000000)
>>>>>>> Pixel Size = (30.000000000000000,-30.000000000000000)
>>>>>>>
>>>>>>> Metadata:
>>>>>>>     AREA_OR_POINT=Point
>>>>>>>     METADATATYPE=ODL
>>>>>>>
>>>>>>> Image Structure Metadata:
>>>>>>>     INTERLEAVE=BAND
>>>>>>>
>>>>>>> Corner Coordinates:
>>>>>>> Upper Left  (  145185.000, 2189715.000) Lower Left  (  145185.000,
>>>>>>> 1967385.000) Upper Right (  372315.000, 2189715.000) Lower Right (
>>>>>>> 372315.000, 1967385.000)
>>>>>>> Center      (  258750.000, 2078550.000)
>>>>>>> Band 1 Block=7571x1 Type=UInt16, ColorInterp=Gray
>>>>>>>
>>>>>>> -----Original Message-----
>>>>>>> From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of
>>>>>>> Dmitry Baryshnikov
>>>>>>> Sent: Sunday, January 17, 2016 6:57 AM
>>>>>>> To: gdal-dev at lists.osgeo.org
>>>>>>> Subject: Re: [gdal-dev] map info and projections from GeoTIFF file to
>>>>>>> create ENVI header
>>>>>>>
>>>>>>> Hi Nevzat,
>>>>>>>
>>>>>>> The landsat geotiff already have CRS embeded in file
>>>>>>>
>>>>>>> $ gdalinfo LC80150362013097LGN03_B1.TIF
>>>>>>> Driver: GTiff/GeoTIFF
>>>>>>> Files: LC80150362013097LGN03_B1.TIF
>>>>>>>
>>>>>>>           ./LC80150362013097LGN03_MTL.txt Size is 7281, 7261 Coordinate
>>>>>>>
>>>>>>> System is:
>>>>>>> PROJCS["WGS 84 / UTM zone 17N",
>>>>>>>
>>>>>>>        GEOGCS["WGS 84",
>>>>>>>
>>>>>>>            DATUM["WGS_1984",
>>>>>>>
>>>>>>>                SPHEROID["WGS 84",6378137,298.257223563,
>>>>>>>
>>>>>>>                    AUTHORITY["EPSG","7030"]],
>>>>>>>
>>>>>>>                AUTHORITY["EPSG","6326"]],
>>>>>>>
>>>>>>>            PRIMEM["Greenwich",0,
>>>>>>>
>>>>>>>                AUTHORITY["EPSG","8901"]],
>>>>>>>
>>>>>>>            UNIT["degree",0.0174532925199433,
>>>>>>>
>>>>>>>                AUTHORITY["EPSG","9122"]],
>>>>>>>
>>>>>>>            AUTHORITY["EPSG","4326"]],
>>>>>>>
>>>>>>>        PROJECTION["Transverse_Mercator"],
>>>>>>>        PARAMETER["latitude_of_origin",0],
>>>>>>>        PARAMETER["central_meridian",-81],
>>>>>>>        PARAMETER["scale_factor",0.9996],
>>>>>>>        PARAMETER["false_easting",500000],
>>>>>>>        PARAMETER["false_northing",0],
>>>>>>>        UNIT["metre",1,
>>>>>>>
>>>>>>>            AUTHORITY["EPSG","9001"]],
>>>>>>>
>>>>>>>        AXIS["Easting",EAST],
>>>>>>>        AXIS["Northing",NORTH],
>>>>>>>        AUTHORITY["EPSG","32617"]]
>>>>>>>
>>>>>>> Origin = (706185.000000000000000,3943515.000000000000000)
>>>>>>> Pixel Size = (30.000000000000000,-30.000000000000000)
>>>>>>>
>>>>>>> Metadata:
>>>>>>>      AREA_OR_POINT=Point
>>>>>>>      METADATATYPE=ODL
>>>>>>>
>>>>>>> Image Structure Metadata:
>>>>>>>      INTERLEAVE=BAND
>>>>>>>
>>>>>>> Corner Coordinates:
>>>>>>> Upper Left  (  706185.000, 3943515.000) ( 78d43'24.74"W, 35d36'50.15"N)
>>>>>>> Lower Left  (  706185.000, 3725685.000) ( 78d46'35.65"W, 33d39' 3.82"N)
>>>>>>> Upper Right (  924615.000, 3943515.000) ( 76d19' 2.05"W, 35d32'39.74"N)
>>>>>>> Lower Right (  924615.000, 3725685.000) ( 76d25'33.46"W, 33d35'10.99"N)
>>>>>>> Center      (  815400.000, 3834600.000) ( 77d33'38.95"W, 34d36'17.35"N)
>>>>>>> Band 1 Block=7281x1 Type=UInt16, ColorInterp=Gray
>>>>>>>
>>>>>>> And this is right CRS.
>>>>>>> Where do you get you geotiff?
>>>>>>>
>>>>>>> Best regards,
>>>>>>>
>>>>>>>        Dmitry
>>>>>>>
>>>>>>> 17.01.2016 03:41, Nevzat Guler
>>>>>>> ÃÂÃÂ¿ÃÂÃÂ¸ÃÂÃÂÃÂÃÂµÃÂÃÂ:
>>>>>>>> Dear experts,
>>>>>>>>
>>>>>>>> I am reading LANDSAT GeoTIFF files and combining bands to create and
>>>>>>>> ENVI cube.
>>>>>>>> I am using GDAL to read the GeoTIFF file, and my own custom cube
>>>>>>>> writer to write the ENVI style cube. Transferring the map information
>>>>>>>> proved to be a bit convoluted. I seek your help to figure out this.
>>>>>>>>
>>>>>>>> My first problem is to access map info from GeoTIFF file. The map
>>>>>>>> info
>>>>>>>> includes:
>>>>>>>>
>>>>>>>> map info = {UTM, 1.000, 1.000, 145185.000, 2189715.000,
>>>>>>>> 3.0000000000e+001, 3.0000000000e+001, 19, North, WGS-84,
>>>>>>>> units=Meters}
>>>>>>>>
>>>>>>>> I am able to get the location (x,y), and pixel size (x,y) from :
>>>>>>>> double adfGeoTransform[6];
>>>>>>>> srcDS->GetGeoTransform(adfGeoTransform);
>>>>>>>>
>>>>>>>> But, I could not find any way to get the other variables in the
>>>>>>>> string: UTM, pixel tie points, Unit and DATUM. Is there any way to get
>>>>>>>> them?
>>>>>>>>
>>>>>>>> Finally, for the Coordinate System String, GDAL gives me:
>>>>>>>>
>>>>>>>> PROJCS["unnamed",PROJECTION["Transverse_Mercator"],PARAMETER["latitud
>>>>>>>> e
>>>>>>>> _of_or
>>>>>>>> igin
>>>>>>>> ",0],PARAMETER["central_meridian",-69],PARAMETER["scale_factor",0.999
>>>>>>>> 6
>>>>>>>> ],PARA
>>>>>>>> METE
>>>>>>>> R["false_easting",500000],PARAMETER["false_northing",0],UNIT["Meter",
>>>>>>>> 1
>>>>>>>> ]]
>>>>>>>>
>>>>>>>> But I should actually get
>>>>>>>>
>>>>>>>> PROJCS["UTM_Zone_19N",GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS
>>>>>>>> 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],TOWGS84[0,0,0,0,0
>>>>>>>> ,
>>>>>>>> 0,0],A
>>>>>>>> UTHO
>>>>>>>> RITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],U
>>>>>>>> N
>>>>>>>> IT["de
>>>>>>>> gree
>>>>>>>> ",0.0174532925199433,AUTHORITY["EPSG","9108"]],AUTHORITY["EPSG","4326"
>>>>>>>> ]],PRO
>>>>>>>> JECT
>>>>>>>> ION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETE
>>>>>>>> R
>>>>>>>> ["cent
>>>>>>>> ral_
>>>>>>>> meridian",-69],PARAMETER["scale_factor",0.9996],PARAMETER["false_east
>>>>>>>> i
>>>>>>>> ng",50
>>>>>>>> 0000
>>>>>>>> ],PARAMETER["false_northing",0],UNIT["Meter",1]]
>>>>>>>>
>>>>>>>> GDAL gives me PROJCS, "unnamed". And no GEOGCS information is given.
>>>>>>>> I am able to get the coordinate system properties by using the
>>>>>>>> following commands but I first need to set few things to use
>>>>>>>> exportToWTK.
>>>>>>>>
>>>>>>>>>>          OGRSpatialReference oSRS;
>>>>>>>>>>          char *pszWKT = NULL;
>>>>>>>>>>          oSRS.SetProjCS("UTM_Zone_19N");
>>>>>>>>>>          oSRS.SetWellKnownGeogCS("WGS84");
>>>>>>>>>>          oSRS.SetUTM(19, TRUE);
>>>>>>>>>>          oSRS.SetWellKnownGeogCS("WGS84");
>>>>>>>>>>          oSRS.exportToWkt(&pszWKT);
>>>>>>>>>>          printf("%s\n", pszWKT);
>>>>>>>> However, this requires me to set SetProjCS, SetWellKnownGeogCS and
>>>>>>>> SetUTM first. I don't know these before I read the file. Is there any
>>>>>>>> way to get them from the file so that I don't need prior knowledge to
>>>>>>>> create the header. When I pull the GeoTIFF file into ENVI, all these
>>>>>>>> information is already there. If this list is only or development
>>>>>>>> purposes, please let me know if there is any other email list that
>>>>>>>> can give me guidance on this quest.
>>>>>>>>
>>>>>>>> I appreciate your help and suggestions.
>>>>>>>> Best regards,
>>>>>>>> - Nevzat
>>>>>>>>
>>>>>>>> _______________________________________________
>>>>>>>> gdal-dev mailing list
>>>>>>>> gdal-dev at lists.osgeo.org
>>>>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>>>> _______________________________________________
>>>>>>> gdal-dev mailing list
>>>>>>> gdal-dev at lists.osgeo.org
>>>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>>> _______________________________________________
>>>>>> gdal-dev mailing list
>>>>>> gdal-dev at lists.osgeo.org
>>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>> Nevzat Guler
>>>>> Senior Scientist
>>>>> Spectral Sciences
>>>>> Phone: 781-273-4770
>>>>> http://www.spectral.com/index.shtml
>>>>> http://www.linkedin.com/in/nevzatguler
>>>>>
>>>>>
>>>>> _______________________________________________
>>>>> gdal-dev mailing list
>>>>> gdal-dev at lists.osgeo.org
>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>> --
>>>> Spatialys - Geospatial professional services
>>>> http://www.spatialys.com
>>>>
>>>
>>> Nevzat Guler
>>> Senior Scientist
>>> Spectral Sciences
>>> Phone: 781-273-4770
>>> http://www.spectral.com/index.shtml
>>> http://www.linkedin.com/in/nevzatguler
>>>
>>>
>>
>> Nevzat Guler
>> Senior Scientist
>> Spectral Sciences
>> Phone: 781-273-4770
>> http://www.spectral.com/index.shtml
>> http://www.linkedin.com/in/nevzatguler
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


Nevzat Guler
Senior Scientist
Spectral Sciences
Phone: 781-273-4770
http://www.spectral.com/index.shtml
http://www.linkedin.com/in/nevzatguler



From bishop.dev at gmail.com  Mon Jan 18 13:40:08 2016
From: bishop.dev at gmail.com (Dmitry Baryshnikov)
Date: Tue, 19 Jan 2016 00:40:08 +0300
Subject: [gdal-dev] map info and projections from GeoTIFF file to create
 ENVI header
In-Reply-To: <10464.173.48.226.138.1453152782.squirrel@webmail.jlab.org>
References: <001c01d14fa8$989e5b70$c9db1250$@spectral.com>
 <006d01d15155$77cc9020$6765b060$@jlab.org>
 <39101.173.48.226.138.1453133594.squirrel@webmail.jlab.org>
 <201601181724.52513.even.rouault@spatialys.com>
 <40508.173.48.226.138.1453136034.squirrel@webmail.jlab.org>
 <1829.173.48.226.138.1453138070.squirrel@webmail.jlab.org>
 <569D231E.7010107@gmail.com>
 <10464.173.48.226.138.1453152782.squirrel@webmail.jlab.org>
Message-ID: <569D5BB8.8070506@gmail.com>

Oh, I'm confused MapInfo and ENVI map info.

In your case you need to form this string by yourself using values from 
OGRSpatialReference methods.
Also take a look to 
https://github.com/OSGeo/gdal/blob/trunk/gdal/frmts/raw/envidataset.cpp

Best regards,
     Dmitry

19.01.2016 00:33, nguler at jlab.org пишет:
> Dmitry,
>
> After doing this, I following your suggested steps, I get the string:
>
> Earth Projection 8, 104, "m", -69, 0, 0.9996, 500000, 0
>
> Bit, the map info string I need to use looks like this:
>
> map info = {UTM, 1, 1, 145185, 2189715, 30, 30, 19, North}
>
> I tried other ExportTo functions but none gives me the specific map info
> string I want. This is ENVI map info string.
>
> I guess I will just have to stitch it together once I understand what the
> second and third elements are used for..
>
> I really appreciated your help.
> Best regards, - Nevzat
>
>
>> Hi Nevzat,
>>
>> you need to get spatial reference from GDALDataset (via GetProjectionRef
>> http://gdal.org/classGDALDataset.html#aa42537e1062ce254d124b29ff3ebe857)
>> and convert it to OGRSpatialReference.
>>
>> Than use exportToMICoordSys to get MI CRS string.
>>
>> http://gdal.org/classOGRSpatialReference.html#a1f2908cd5ca33609844ef0c0ff2186ea
>>
>> Best regards,
>>       Dmitry
>>
>> 18.01.2016 20:27, nguler at jlab.org Ð¿Ð¸ÑˆÐµÑ‚:
>>> It is solved. Thank you very much Even and Dmitry for your helps. I have
>>> missed the GDAL_DATA variable and it caused me all that trouble.
>>>
>>> Now I need to get the map info string:
>>> map info = {UTM, 1, 1, 145185, 2189715, 30, 30, 19, North,WGS-84}
>>>
>>> Using hDS->GetGeoTransform(adfGeoTransform) does not give me all the
>>> information in the map info string. It only gives me elements [4-7], how to
>>> get the others?
>>>
>>> Best regards, - Nevzat
>>>
>>>> Yes, Thank you Even, I was missing the GDAL_DATA environmental variable.
>>>> Now I
>>>> get the same gdalinfo output. Do I need to set this variable while using
>>>> the
>>>> C++ classes you suggested before: GetGeoTransform and GetProjectionRef()..?
>>>> Because, there also I had the same problem.
>>>>
>>>> Best regards, - Nevzat
>>>>
>>>>
>>>>> Le lundi 18 janvier 2016 17:13:14, nguler at jlab.org a ÃƒÂ©crit :
>>>>>> Dmitry and All,
>>>>>> I just downloaded the set of tiff files from earthexplorer and run
>>>>>> gdalinfo
>>>>>> on it. Please see below. I am missing some fields in the output
>>>>>> information. It is different from what you got. I don't know what can
>>>>>> cause this? My gdalinfo.exe is not good? Any idea?
>>>>> Have a look at the FAQ entries about GDAL_DATA :
>>>>> https://trac.osgeo.org/gdal/wiki/FAQInstallationAndBuilding#WhatisGDAL_DATAenvironmentvariable
>>>>>
>>>>>> C:\Cubes\LC80080472013174LGN00.tar>gdalinfo LC80080472013174LGN00_B1.TIF
>>>>>> Driver: GTiff/GeoTIFF
>>>>>> Files: LC80080472013174LGN00_B1.TIF
>>>>>>          .\LC80080472013174LGN00_MTL.txt
>>>>>> Size is 7571, 7411
>>>>>> Coordinate System is:
>>>>>> PROJCS["unnamed",
>>>>>>       PROJECTION["Transverse_Mercator"],
>>>>>>       PARAMETER["latitude_of_origin",0],
>>>>>>       PARAMETER["central_meridian",-69],
>>>>>>       PARAMETER["scale_factor",0.9996],
>>>>>>       PARAMETER["false_easting",500000],
>>>>>>       PARAMETER["false_northing",0],
>>>>>>       UNIT["metre",1,
>>>>>>           AUTHORITY["EPSG","9001"]]]
>>>>>> Origin = (145185.000000000000000,2189715.000000000000000)
>>>>>> Pixel Size = (30.000000000000000,-30.000000000000000)
>>>>>> Metadata:
>>>>>>     AREA_OR_POINT=Point
>>>>>>     METADATATYPE=ODL
>>>>>> Image Structure Metadata:
>>>>>>     INTERLEAVE=BAND
>>>>>> Corner Coordinates:
>>>>>> Upper Left  (  145185.000, 2189715.000)
>>>>>> Lower Left  (  145185.000, 1967385.000)
>>>>>> Upper Right (  372315.000, 2189715.000)
>>>>>> Lower Right (  372315.000, 1967385.000)
>>>>>> Center      (  258750.000, 2078550.000)
>>>>>> Band 1 Block=7571x1 Type=UInt16, ColorInterp=Gray
>>>>>>
>>>>>> C:\Cubes\LC80080472013174LGN00.tar>gdalinfo --version
>>>>>> GDAL 2.0.1, released 2015/09/15
>>>>>>
>>>>>> C:\Cubes\LC80080472013174LGN00.tar>
>>>>>>
>>>>>>> I have the 2.0.1 version:
>>>>>>> C:\warmerda\bld\bin>gdalinfo --version
>>>>>>> GDAL 2.0.1, released 2015/09/15
>>>>>>>
>>>>>>> I will check the history of the file I have. Maybe it is modified. I
>>>>>>> will
>>>>>>> also download the same file from earthexplorer and try my routines on
>>>>>>> it. Thanks for the suggestions. I appreciate.
>>>>>>> - Nevzat
>>>>>>>
>>>>>>> -----Original Message-----
>>>>>>> From: Dmitry Baryshnikov [mailto:bishop.dev at gmail.com]
>>>>>>> Sent: Sunday, January 17, 2016 12:57 PM
>>>>>>> To: Nevzat Guler <nguler at jlab.org>; gdal-dev at lists.osgeo.org
>>>>>>> Subject: Re: [gdal-dev] map info and projections from GeoTIFF file to
>>>>>>> create ENVI header
>>>>>>>
>>>>>>> I downloaded this scene from earthexplorer, and everything is fine:
>>>>>>>
>>>>>>> $ gdalinfo LC80080472013174LGN00_B1.TIF
>>>>>>> Driver: GTiff/GeoTIFF
>>>>>>> Files: LC80080472013174LGN00_B1.TIF
>>>>>>>
>>>>>>>           ./LC80080472013174LGN00_MTL.txt
>>>>>>>
>>>>>>> Size is 7571, 7411
>>>>>>> Coordinate System is:
>>>>>>> PROJCS["WGS 84 / UTM zone 19N",
>>>>>>>
>>>>>>>        GEOGCS["WGS 84",
>>>>>>>
>>>>>>>            DATUM["WGS_1984",
>>>>>>>
>>>>>>>                SPHEROID["WGS 84",6378137,298.257223563,
>>>>>>>
>>>>>>>                    AUTHORITY["EPSG","7030"]],
>>>>>>>
>>>>>>>                AUTHORITY["EPSG","6326"]],
>>>>>>>
>>>>>>>            PRIMEM["Greenwich",0,
>>>>>>>
>>>>>>>                AUTHORITY["EPSG","8901"]],
>>>>>>>
>>>>>>>            UNIT["degree",0.0174532925199433,
>>>>>>>
>>>>>>>                AUTHORITY["EPSG","9122"]],
>>>>>>>
>>>>>>>            AUTHORITY["EPSG","4326"]],
>>>>>>>
>>>>>>>        PROJECTION["Transverse_Mercator"],
>>>>>>>        PARAMETER["latitude_of_origin",0],
>>>>>>>        PARAMETER["central_meridian",-69],
>>>>>>>        PARAMETER["scale_factor",0.9996],
>>>>>>>        PARAMETER["false_easting",500000],
>>>>>>>        PARAMETER["false_northing",0],
>>>>>>>        UNIT["metre",1,
>>>>>>>
>>>>>>>            AUTHORITY["EPSG","9001"]],
>>>>>>>
>>>>>>>        AXIS["Easting",EAST],
>>>>>>>        AXIS["Northing",NORTH],
>>>>>>>        AUTHORITY["EPSG","32619"]]
>>>>>>>
>>>>>>> Origin = (145185.000000000000000,2189715.000000000000000)
>>>>>>> Pixel Size = (30.000000000000000,-30.000000000000000)
>>>>>>>
>>>>>>> Metadata:
>>>>>>>      AREA_OR_POINT=Point
>>>>>>>      METADATATYPE=ODL
>>>>>>>
>>>>>>> Image Structure Metadata:
>>>>>>>      INTERLEAVE=BAND
>>>>>>>
>>>>>>> Corner Coordinates:
>>>>>>> Upper Left  (  145185.000, 2189715.000) ( 72d23' 7.97"W, 19d46'16.43"N)
>>>>>>> Lower Left  (  145185.000, 1967385.000) ( 72d20'44.51"W, 17d45'55.15"N)
>>>>>>> Upper Right (  372315.000, 2189715.000) ( 70d13' 8.50"W, 19d47'56.92"N)
>>>>>>> Lower Right ( 372315.000, 1967385.000) ( 70d12'16.74"W, 17d47'24.74"N)
>>>>>>> Center      (  258750.000, 2078550.000) ( 71d17'19.50"W, 18d47' 4.68"N)
>>>>>>> Band 1 Block=7571x1 Type=UInt16, ColorInterp=Gray
>>>>>>>
>>>>>>> $ gdalinfo --version
>>>>>>> GDAL 2.1.0dev, released 2015/99/99
>>>>>>>
>>>>>>> What is your gdal version? Maybe the Landsat geotiff was modified from
>>>>>>> some software?
>>>>>>>
>>>>>>> Best regards,
>>>>>>>
>>>>>>>        Dmitry
>>>>>>>
>>>>>>> 17.01.2016 20:15, Nevzat Guler ÃƒÂÃ‚Â¿ÃƒÂÃ‚Â¸ÃƒÂ‘Ã‚ÂˆÃƒÂÃ‚ÂµÃƒÂ‘Ã‚Â‚:
>>>>>>>> Thank you Dmitry,
>>>>>>>> What is the best way to extract the information we got using
>>>>>>>> gdalinfo.exe by using GDAL classes, within a C++ code? As I mentioned,
>>>>>>>> I am using GetGeoTransform and GetProjectionRef() but the results miss
>>>>>>>> many of the information (specifically the map info elements as I
>>>>>>>> explained in the previous email).
>>>>>>>>
>>>>>>>> On another note, I actually get a different output from gdalinfo.exe
>>>>>>>> using my file (please see the printed result below). I got the geotiff
>>>>>>>> file from my colleague. When I open the file with ENVI, I get all the
>>>>>>>> information, including GEOGCS information.
>>>>>>>>
>>>>>>>> Can it be that my file is just corrupted and that's why I don't get all
>>>>>>>> the information from GetGeoTransform and GetProjectionRef()? But then
>>>>>>>> how would ENVI is able to extract this information if it were not in
>>>>>>>> the file?
>>>>>>>>
>>>>>>>> Thanks again, - Nevzat
>>>>>>>>
>>>>>>>> C:\Cubes\Landsat\LC80080472013174LGN00>gdalinfo
>>>>>>>> LC80080472013174LGN00_B1.TIF
>>>>>>>> Driver: GTiff/GeoTIFF
>>>>>>>> Files: LC80080472013174LGN00_B1.TIF
>>>>>>>>
>>>>>>>>           .\LC80080472013174LGN00_MTL.txt Size is 7571, 7411 Coordinate
>>>>>>>>
>>>>>>>> System is:
>>>>>>>> PROJCS["unnamed",
>>>>>>>>
>>>>>>>>        PROJECTION["Transverse_Mercator"],
>>>>>>>>        PARAMETER["latitude_of_origin",0],
>>>>>>>>        PARAMETER["central_meridian",-69],
>>>>>>>>        PARAMETER["scale_factor",0.9996],
>>>>>>>>        PARAMETER["false_easting",500000],
>>>>>>>>        PARAMETER["false_northing",0],
>>>>>>>>        UNIT["metre",1,
>>>>>>>>
>>>>>>>>            AUTHORITY["EPSG","9001"]]]
>>>>>>>>
>>>>>>>> Origin = (145185.000000000000000,2189715.000000000000000)
>>>>>>>> Pixel Size = (30.000000000000000,-30.000000000000000)
>>>>>>>>
>>>>>>>> Metadata:
>>>>>>>>      AREA_OR_POINT=Point
>>>>>>>>      METADATATYPE=ODL
>>>>>>>>
>>>>>>>> Image Structure Metadata:
>>>>>>>>      INTERLEAVE=BAND
>>>>>>>>
>>>>>>>> Corner Coordinates:
>>>>>>>> Upper Left  (  145185.000, 2189715.000) Lower Left  (  145185.000,
>>>>>>>> 1967385.000) Upper Right (  372315.000, 2189715.000) Lower Right (
>>>>>>>> 372315.000, 1967385.000)
>>>>>>>> Center      (  258750.000, 2078550.000)
>>>>>>>> Band 1 Block=7571x1 Type=UInt16, ColorInterp=Gray
>>>>>>>>
>>>>>>>> -----Original Message-----
>>>>>>>> From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of
>>>>>>>> Dmitry Baryshnikov
>>>>>>>> Sent: Sunday, January 17, 2016 6:57 AM
>>>>>>>> To: gdal-dev at lists.osgeo.org
>>>>>>>> Subject: Re: [gdal-dev] map info and projections from GeoTIFF file to
>>>>>>>> create ENVI header
>>>>>>>>
>>>>>>>> Hi Nevzat,
>>>>>>>>
>>>>>>>> The landsat geotiff already have CRS embeded in file
>>>>>>>>
>>>>>>>> $ gdalinfo LC80150362013097LGN03_B1.TIF
>>>>>>>> Driver: GTiff/GeoTIFF
>>>>>>>> Files: LC80150362013097LGN03_B1.TIF
>>>>>>>>
>>>>>>>>            ./LC80150362013097LGN03_MTL.txt Size is 7281, 7261 Coordinate
>>>>>>>>
>>>>>>>> System is:
>>>>>>>> PROJCS["WGS 84 / UTM zone 17N",
>>>>>>>>
>>>>>>>>         GEOGCS["WGS 84",
>>>>>>>>
>>>>>>>>             DATUM["WGS_1984",
>>>>>>>>
>>>>>>>>                 SPHEROID["WGS 84",6378137,298.257223563,
>>>>>>>>
>>>>>>>>                     AUTHORITY["EPSG","7030"]],
>>>>>>>>
>>>>>>>>                 AUTHORITY["EPSG","6326"]],
>>>>>>>>
>>>>>>>>             PRIMEM["Greenwich",0,
>>>>>>>>
>>>>>>>>                 AUTHORITY["EPSG","8901"]],
>>>>>>>>
>>>>>>>>             UNIT["degree",0.0174532925199433,
>>>>>>>>
>>>>>>>>                 AUTHORITY["EPSG","9122"]],
>>>>>>>>
>>>>>>>>             AUTHORITY["EPSG","4326"]],
>>>>>>>>
>>>>>>>>         PROJECTION["Transverse_Mercator"],
>>>>>>>>         PARAMETER["latitude_of_origin",0],
>>>>>>>>         PARAMETER["central_meridian",-81],
>>>>>>>>         PARAMETER["scale_factor",0.9996],
>>>>>>>>         PARAMETER["false_easting",500000],
>>>>>>>>         PARAMETER["false_northing",0],
>>>>>>>>         UNIT["metre",1,
>>>>>>>>
>>>>>>>>             AUTHORITY["EPSG","9001"]],
>>>>>>>>
>>>>>>>>         AXIS["Easting",EAST],
>>>>>>>>         AXIS["Northing",NORTH],
>>>>>>>>         AUTHORITY["EPSG","32617"]]
>>>>>>>>
>>>>>>>> Origin = (706185.000000000000000,3943515.000000000000000)
>>>>>>>> Pixel Size = (30.000000000000000,-30.000000000000000)
>>>>>>>>
>>>>>>>> Metadata:
>>>>>>>>       AREA_OR_POINT=Point
>>>>>>>>       METADATATYPE=ODL
>>>>>>>>
>>>>>>>> Image Structure Metadata:
>>>>>>>>       INTERLEAVE=BAND
>>>>>>>>
>>>>>>>> Corner Coordinates:
>>>>>>>> Upper Left  (  706185.000, 3943515.000) ( 78d43'24.74"W, 35d36'50.15"N)
>>>>>>>> Lower Left  (  706185.000, 3725685.000) ( 78d46'35.65"W, 33d39' 3.82"N)
>>>>>>>> Upper Right (  924615.000, 3943515.000) ( 76d19' 2.05"W, 35d32'39.74"N)
>>>>>>>> Lower Right (  924615.000, 3725685.000) ( 76d25'33.46"W, 33d35'10.99"N)
>>>>>>>> Center      (  815400.000, 3834600.000) ( 77d33'38.95"W, 34d36'17.35"N)
>>>>>>>> Band 1 Block=7281x1 Type=UInt16, ColorInterp=Gray
>>>>>>>>
>>>>>>>> And this is right CRS.
>>>>>>>> Where do you get you geotiff?
>>>>>>>>
>>>>>>>> Best regards,
>>>>>>>>
>>>>>>>>         Dmitry
>>>>>>>>
>>>>>>>> 17.01.2016 03:41, Nevzat Guler
>>>>>>>> ÃƒÂÃ‚Â¿ÃƒÂÃ‚Â¸ÃƒÂ‘Ã‚ÂˆÃƒÂÃ‚ÂµÃƒÂ‘Ã‚Â‚:
>>>>>>>>> Dear experts,
>>>>>>>>>
>>>>>>>>> I am reading LANDSAT GeoTIFF files and combining bands to create and
>>>>>>>>> ENVI cube.
>>>>>>>>> I am using GDAL to read the GeoTIFF file, and my own custom cube
>>>>>>>>> writer to write the ENVI style cube. Transferring the map information
>>>>>>>>> proved to be a bit convoluted. I seek your help to figure out this.
>>>>>>>>>
>>>>>>>>> My first problem is to access map info from GeoTIFF file. The map
>>>>>>>>> info
>>>>>>>>> includes:
>>>>>>>>>
>>>>>>>>> map info = {UTM, 1.000, 1.000, 145185.000, 2189715.000,
>>>>>>>>> 3.0000000000e+001, 3.0000000000e+001, 19, North, WGS-84,
>>>>>>>>> units=Meters}
>>>>>>>>>
>>>>>>>>> I am able to get the location (x,y), and pixel size (x,y) from :
>>>>>>>>> double adfGeoTransform[6];
>>>>>>>>> srcDS->GetGeoTransform(adfGeoTransform);
>>>>>>>>>
>>>>>>>>> But, I could not find any way to get the other variables in the
>>>>>>>>> string: UTM, pixel tie points, Unit and DATUM. Is there any way to get
>>>>>>>>> them?
>>>>>>>>>
>>>>>>>>> Finally, for the Coordinate System String, GDAL gives me:
>>>>>>>>>
>>>>>>>>> PROJCS["unnamed",PROJECTION["Transverse_Mercator"],PARAMETER["latitud
>>>>>>>>> e
>>>>>>>>> _of_or
>>>>>>>>> igin
>>>>>>>>> ",0],PARAMETER["central_meridian",-69],PARAMETER["scale_factor",0.999
>>>>>>>>> 6
>>>>>>>>> ],PARA
>>>>>>>>> METE
>>>>>>>>> R["false_easting",500000],PARAMETER["false_northing",0],UNIT["Meter",
>>>>>>>>> 1
>>>>>>>>> ]]
>>>>>>>>>
>>>>>>>>> But I should actually get
>>>>>>>>>
>>>>>>>>> PROJCS["UTM_Zone_19N",GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS
>>>>>>>>> 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],TOWGS84[0,0,0,0,0
>>>>>>>>> ,
>>>>>>>>> 0,0],A
>>>>>>>>> UTHO
>>>>>>>>> RITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],U
>>>>>>>>> N
>>>>>>>>> IT["de
>>>>>>>>> gree
>>>>>>>>> ",0.0174532925199433,AUTHORITY["EPSG","9108"]],AUTHORITY["EPSG","4326"
>>>>>>>>> ]],PRO
>>>>>>>>> JECT
>>>>>>>>> ION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETE
>>>>>>>>> R
>>>>>>>>> ["cent
>>>>>>>>> ral_
>>>>>>>>> meridian",-69],PARAMETER["scale_factor",0.9996],PARAMETER["false_east
>>>>>>>>> i
>>>>>>>>> ng",50
>>>>>>>>> 0000
>>>>>>>>> ],PARAMETER["false_northing",0],UNIT["Meter",1]]
>>>>>>>>>
>>>>>>>>> GDAL gives me PROJCS, "unnamed". And no GEOGCS information is given.
>>>>>>>>> I am able to get the coordinate system properties by using the
>>>>>>>>> following commands but I first need to set few things to use
>>>>>>>>> exportToWTK.
>>>>>>>>>
>>>>>>>>>>>           OGRSpatialReference oSRS;
>>>>>>>>>>>           char *pszWKT = NULL;
>>>>>>>>>>>           oSRS.SetProjCS("UTM_Zone_19N");
>>>>>>>>>>>           oSRS.SetWellKnownGeogCS("WGS84");
>>>>>>>>>>>           oSRS.SetUTM(19, TRUE);
>>>>>>>>>>>           oSRS.SetWellKnownGeogCS("WGS84");
>>>>>>>>>>>           oSRS.exportToWkt(&pszWKT);
>>>>>>>>>>>           printf("%s\n", pszWKT);
>>>>>>>>> However, this requires me to set SetProjCS, SetWellKnownGeogCS and
>>>>>>>>> SetUTM first. I don't know these before I read the file. Is there any
>>>>>>>>> way to get them from the file so that I don't need prior knowledge to
>>>>>>>>> create the header. When I pull the GeoTIFF file into ENVI, all these
>>>>>>>>> information is already there. If this list is only or development
>>>>>>>>> purposes, please let me know if there is any other email list that
>>>>>>>>> can give me guidance on this quest.
>>>>>>>>>
>>>>>>>>> I appreciate your help and suggestions.
>>>>>>>>> Best regards,
>>>>>>>>> - Nevzat
>>>>>>>>>
>>>>>>>>> _______________________________________________
>>>>>>>>> gdal-dev mailing list
>>>>>>>>> gdal-dev at lists.osgeo.org
>>>>>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>>>>> _______________________________________________
>>>>>>>> gdal-dev mailing list
>>>>>>>> gdal-dev at lists.osgeo.org
>>>>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>>>> _______________________________________________
>>>>>>> gdal-dev mailing list
>>>>>>> gdal-dev at lists.osgeo.org
>>>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>>> Nevzat Guler
>>>>>> Senior Scientist
>>>>>> Spectral Sciences
>>>>>> Phone: 781-273-4770
>>>>>> http://www.spectral.com/index.shtml
>>>>>> http://www.linkedin.com/in/nevzatguler
>>>>>>
>>>>>>
>>>>>> _______________________________________________
>>>>>> gdal-dev mailing list
>>>>>> gdal-dev at lists.osgeo.org
>>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>> --
>>>>> Spatialys - Geospatial professional services
>>>>> http://www.spatialys.com
>>>>>
>>>> Nevzat Guler
>>>> Senior Scientist
>>>> Spectral Sciences
>>>> Phone: 781-273-4770
>>>> http://www.spectral.com/index.shtml
>>>> http://www.linkedin.com/in/nevzatguler
>>>>
>>>>
>>> Nevzat Guler
>>> Senior Scientist
>>> Spectral Sciences
>>> Phone: 781-273-4770
>>> http://www.spectral.com/index.shtml
>>> http://www.linkedin.com/in/nevzatguler
>>>
>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
> Nevzat Guler
> Senior Scientist
> Spectral Sciences
> Phone: 781-273-4770
> http://www.spectral.com/index.shtml
> http://www.linkedin.com/in/nevzatguler
>
>
>


From boxerab at gmail.com  Mon Jan 18 13:41:38 2016
From: boxerab at gmail.com (Aaron Boxer)
Date: Mon, 18 Jan 2016 16:41:38 -0500
Subject: [gdal-dev] OpenJPEG tiled encoding
Message-ID: <CAK8GPyDC5umX+qpKAjnK+-SEuzGn24rEr0ircASW8hLf_KgwSw@mail.gmail.com>

Hello,

It looks like OpenJPEG tiled encoding is broken for non power of 2 images.
This seems to be quite an old bug.

Does this type of encoding get used in GDAL ? Or are all images power of 2
dimensions.

Thanks,
Aaron
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160118/63c889b3/attachment.html>

From even.rouault at spatialys.com  Mon Jan 18 14:14:17 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 18 Jan 2016 23:14:17 +0100
Subject: [gdal-dev] OpenJPEG tiled encoding
In-Reply-To: <CAK8GPyDC5umX+qpKAjnK+-SEuzGn24rEr0ircASW8hLf_KgwSw@mail.gmail.com>
References: <CAK8GPyDC5umX+qpKAjnK+-SEuzGn24rEr0ircASW8hLf_KgwSw@mail.gmail.com>
Message-ID: <201601182314.17443.even.rouault@spatialys.com>

Le lundi 18 janvier 2016 22:41:38, Aaron Boxer a écrit :
> Hello,
> 
> It looks like OpenJPEG tiled encoding is broken for non power of 2 images.
> This seems to be quite an old bug.

I don't reproduce that. For example, the following works :

gdal_translate ../autotest/gdrivers/data/utm.tif out.jp2 -of jp2openjpeg -co 
blockxsize=33 -co blockysize=35 -outsize 100 100

> 
> Does this type of encoding get used in GDAL ? Or are all images power of 2
> dimensions.
> 
> Thanks,
> Aaron

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From boxerab at gmail.com  Mon Jan 18 16:32:38 2016
From: boxerab at gmail.com (Aaron Boxer)
Date: Mon, 18 Jan 2016 19:32:38 -0500
Subject: [gdal-dev] OpenJPEG tiled encoding
In-Reply-To: <201601182314.17443.even.rouault@spatialys.com>
References: <CAK8GPyDC5umX+qpKAjnK+-SEuzGn24rEr0ircASW8hLf_KgwSw@mail.gmail.com>
 <201601182314.17443.even.rouault@spatialys.com>
Message-ID: <CAK8GPyBCGJMC5XFh49OROP7k+qLfwRguVxgkn-AEzFLgyMoEVA@mail.gmail.com>

On Mon, Jan 18, 2016 at 5:14 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le lundi 18 janvier 2016 22:41:38, Aaron Boxer a écrit :
> > Hello,
> >
> > It looks like OpenJPEG tiled encoding is broken for non power of 2
> images.
> > This seems to be quite an old bug.
>
> I don't reproduce that. For example, the following works :
>
> gdal_translate ../autotest/gdrivers/data/utm.tif out.jp2 -of jp2openjpeg
> -co
> blockxsize=33 -co blockysize=35 -outsize 100 100
>



You're right. This is actually a problem with kdu_show, not OpenJPEG.  I
was assuming
that Kakadu was the gold standard, but it has bugs too :)






>
> >
> > Does this type of encoding get used in GDAL ? Or are all images power of
> 2
> > dimensions.
> >
> > Thanks,
> > Aaron
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160118/b8840a64/attachment.html>

From gdt at ir.bbn.com  Mon Jan 18 17:42:18 2016
From: gdt at ir.bbn.com (Greg Troxel)
Date: Mon, 18 Jan 2016 20:42:18 -0500
Subject: [gdal-dev] GDAL license and copyright
In-Reply-To: <CAK8GPyBSfg8wrMSxT82-xqOfO13E8yEj+ZnYMdbxOLjvqQeoxQ@mail.gmail.com>
 (Aaron Boxer's message of "Mon, 18 Jan 2016 13:59:01 -0500")
References: <CAK8GPyBSfg8wrMSxT82-xqOfO13E8yEj+ZnYMdbxOLjvqQeoxQ@mail.gmail.com>
Message-ID: <rmih9iabb0l.fsf@fnord.ir.bbn.com>


Aaron Boxer <boxerab at gmail.com> writes:

> I am trying to learn more about how open source projects manage
> copyright of contributors.  I see that various GDAL files have
> different copyright assignees, although they all use the MIT license.

(I'm not trying to counter anything Evan said; he is not only an
authoritative speaker but IMHO said everythign totally right.  I am the
chief licensing geek in pkgsrc, a multi-OS multi-arch packaging system.
This is more than what you asked, but hopefully useful background.)

As always, IANAL, TINLA.  And this is a US-centric view, although I
think not so far off for Europe and many other Berne Convention
countries.

You said "different assignees".  I think you meant "different copyright
holders".  When a person creates a work (writes code, in nerd-speak),
the basic consequence is that they hold copyright, and there is no
assignment involved.  If the code is written within the scope of
employment, then the copyright will be held by the employer, under the
"work for hire" doctrine.

Beyond that ownership at creation, copyright can be assigned by a
contract from the original holder to a new holder. (As an exception,
Europe has the concept of "moral rights" as an element of copyright
which cannot be assigned, but this has so far not been a significant
issue in software.)

Some open source projects ask that copyright be assigned to some entity
(e.g., emacs asks for an assignment to FSF, and will not merge code
until that is done).  Others have a very large number of copyright
holders.

As a packager, I don't care how many copyright holders there are.  What
I look for is a clear license, since without a license, there is no
permission to copy or to create derivative works.  The common practice
of "inbound = outbound", where contributions are only accepted if there
is a license grant equal to the project's outgoing license, both works
well and fits very well with most people's senses of fairness and
reciprocity.

As a contributor, I am happy when I get to keep copyright, not because I
really want to keep it, but because it is easy and does not require
signing something, which usually has additional terms I may not like
(e.g., indemnification).  I do not object conceptually to assigning to a
501(c)3 organization that has promotion of Free Software as a
fundamental goal (e.g. FSF, SFC, ASF).  I am not comfortable assiging to
a company, and object unless the assignment guarantees that the code
will *only* be distributed by them under Free licenses.

Greg, lurker

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 180 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160118/cd8f57bd/attachment.sig>

From ari.jolma at gmail.com  Mon Jan 18 23:40:30 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 19 Jan 2016 09:40:30 +0200
Subject: [gdal-dev] Intersection of two Layers
In-Reply-To: <569CB6D5.1090209@uni-bonn.de>
References: <569CB6D5.1090209@uni-bonn.de>
Message-ID: <569DE86E.5070902@gmail.com>

18.01.2016, 11:56, Kai Muehlbauer kirjoitti:
> Hi,
>
> at the moment I calculate the intersection of two OGR Layers (A, B) by 
> iterating over features/geometries (GA) of layer A and then calling 
> GA.Intersection(GB) for every Feature/Geometry (GB) of B. I set a 
> spatial filter for layer B with every GA. The intersections 
> features/geometries are written to a result layer (C).
>
> In my use case the features/geometries of layer B are much smaller 
> than the features of layer A. Means that quite a big number of B's 
> geometries are fully contained in A's geometries.
>
> To speed things up, I check for containment GA.contains(GB). If GB is 
> contained in GA, I just copy GB to C, otherwise I calculate 
> GA.Intersection(GB) and write this to C.
>
> I found that I also could use the layer intersection function 
> (OGRLayer::Intersection). Unfortunately the intersection is calculated 
> for every feature/geometry.
>
> Would it be possible to extend the layer intersection function to 
> allow for containment check (eg. as an option) and just copy the 
> contained geometries without calculation of expensive intersection? 
> Suggestions, opinions?

There's the Options argument, which could be used. Something like 
"PRETEST=CONTAINMENT" could indicate a wish to test containment before 
intersection.

A test dataset and a patch would be useful.

Ari

>
> In my use case I get improvements of around 20% of processing time.
>
> Cheers,
> Kai
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From nik at nikosalexandris.net  Tue Jan 19 01:58:17 2016
From: nik at nikosalexandris.net (Nikos Alexandris)
Date: Tue, 19 Jan 2016 10:58:17 +0100
Subject: [gdal-dev] RPC
In-Reply-To: <20160118073906.9869.qmail@f4mail-235-241.rediffmail.com>
References: <20160118073906.9869.qmail@f4mail-235-241.rediffmail.com>
Message-ID: <20160119095817.GD11412@tpx1c2g>

Surya Prakash:

> Hi ALL, I have some imagery associated with RPC files. The locational
> accuracy of the images defined by the RPCs is quite poor and I would
> like to update the RPCs by using some additional GCPs. How to do this,
> Please guide me.

Hi Surya!

May I ask which kind of imagery?  If the (official in-metadata?) RPC
data you have are "poor", perhaps, a better option would be to have a
fine(r) elevation model and, based on it, perform an
ortho-rectification?

Cheers, Nikos

From schut at sarvision.nl  Tue Jan 19 02:12:16 2016
From: schut at sarvision.nl (Vincent Schut)
Date: Tue, 19 Jan 2016 11:12:16 +0100
Subject: [gdal-dev] Fwd: Fwd: OpenJPEG: The Slumbering Giant Awakens
In-Reply-To: <CAK8GPyBKAzS01PiYBeSsuAjajP-EizwVVYG46Po1WzQamxJb7A@mail.gmail.com>
References: <CAK8GPyA2=9BEK6mR-3caMiGsmJE2oePUcCw88T1Y5Q9nMR7p_A@mail.gmail.com>
 <1452585129543-5244643.post@n6.nabble.com>
 <CAK8GPyAYJ3LqZ=Hpi2f5TddDQXAi70LnS=bh5F_QwibTX8cmgw@mail.gmail.com>
 <CAK8GPyBOiE74meOVjm9yfeUcS5yGBrwB5vffkSFhBQsE9soezA@mail.gmail.com>
 <5695655B.4030704@gmx.net>
 <CAK8GPyA9CwJSWDATxq90axXV5Y=q0LYEzC7B749xBCcGC71goA@mail.gmail.com>
 <CAK8GPyBKAzS01PiYBeSsuAjajP-EizwVVYG46Po1WzQamxJb7A@mail.gmail.com>
Message-ID: <569E0C00.6000807@sarvision.nl>

On 01/12/2016 10:10 PM, Aaron Boxer wrote:
>
> ---------- Forwarded message ----------
> From: *Aaron Boxer* <boxerab at gmail.com <mailto:boxerab at gmail.com>>
> Date: Tue, Jan 12, 2016 at 4:06 PM
> Subject: Re: [gdal-dev] Fwd: OpenJPEG: The Slumbering Giant Awakens
> To: armin.burger at gmx.net <mailto:armin.burger at gmx.net>
>
>
> Hi Armin,
>
> Yes, indeed.  You can find it here:
>
> https://github.com/CodecCentral/openjpeg/tree/omnibus
>
> and run cmake with openmp flag turned on.
>
> This is a complete version of openjpeg, with my patch applied on top.
>
>
> Cheers,
> Aaron

Hi Aaron, I wanted to try your enhanced openjpeg branch, but I see the above mentioned github url does not work anymore. Is there a successor? Or should I better wait until your work has been merged into openjpeg trunk?

Cheers,
Vincent.
>
>
>
>
>
> On Tue, Jan 12, 2016 at 3:43 PM, Armin Burger <armin.burger at gmx.net <mailto:armin.burger at gmx.net>> wrote:
>
>     Hi Aaron
>
>     would this patch (or a patched version of complete Openjpeg source) already be available for testing to assess the difference to current release?
>
>     Thanks
>     Armin
>
>     On 12/01/16 15:13, Aaron Boxer wrote:
>
>
>         Yes, it will be a lot faster. By the way, this patch may be delayed a
>         little bit while we test some more.
>
>     _______________________________________________
>     gdal-dev mailing list
>     gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>     http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160119/3e7783fa/attachment-0001.html>

From even.rouault at spatialys.com  Tue Jan 19 04:09:43 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 19 Jan 2016 13:09:43 +0100
Subject: [gdal-dev] Intersection of two Layers
In-Reply-To: <569DE86E.5070902@gmail.com>
References: <569CB6D5.1090209@uni-bonn.de> <569DE86E.5070902@gmail.com>
Message-ID: <201601191309.43495.even.rouault@spatialys.com>

Le mardi 19 janvier 2016 08:40:30, Ari Jolma a écrit :
> 18.01.2016, 11:56, Kai Muehlbauer kirjoitti:
> > Hi,
> > 
> > at the moment I calculate the intersection of two OGR Layers (A, B) by
> > iterating over features/geometries (GA) of layer A and then calling
> > GA.Intersection(GB) for every Feature/Geometry (GB) of B. I set a
> > spatial filter for layer B with every GA. The intersections
> > features/geometries are written to a result layer (C).
> > 
> > In my use case the features/geometries of layer B are much smaller
> > than the features of layer A. Means that quite a big number of B's
> > geometries are fully contained in A's geometries.
> > 
> > To speed things up, I check for containment GA.contains(GB). If GB is
> > contained in GA, I just copy GB to C, otherwise I calculate
> > GA.Intersection(GB) and write this to C.
> > 
> > I found that I also could use the layer intersection function
> > (OGRLayer::Intersection). Unfortunately the intersection is calculated
> > for every feature/geometry.
> > 
> > Would it be possible to extend the layer intersection function to
> > allow for containment check (eg. as an option) and just copy the
> > contained geometries without calculation of expensive intersection?
> > Suggestions, opinions?
> 
> There's the Options argument, which could be used. Something like
> "PRETEST=CONTAINMENT" could indicate a wish to test containment before
> intersection.

The use of GEOS prepared geometry operations could also potentially help. OGR 
has already mapped GEOSPreparedIntersects as OGRPreparedGeometryIntersects and 
that could probably be unconditionnaly used, with the geometry of the outer 
loop being the prepared geometry with OGRCreatePreparedGeometry()
And perhaps GEOSPreparedContains could be used for containement (if the above 
suggestion desn't speed up things enough).

> 
> A test dataset and a patch would be useful.
> 
> Ari
> 
> > In my use case I get improvements of around 20% of processing time.
> > 
> > Cheers,
> > Kai
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From boxerab at gmail.com  Tue Jan 19 05:41:24 2016
From: boxerab at gmail.com (Aaron Boxer)
Date: Tue, 19 Jan 2016 08:41:24 -0500
Subject: [gdal-dev] Fwd: Fwd: OpenJPEG: The Slumbering Giant Awakens
In-Reply-To: <569E0C00.6000807@sarvision.nl>
References: <CAK8GPyA2=9BEK6mR-3caMiGsmJE2oePUcCw88T1Y5Q9nMR7p_A@mail.gmail.com>
 <1452585129543-5244643.post@n6.nabble.com>
 <CAK8GPyAYJ3LqZ=Hpi2f5TddDQXAi70LnS=bh5F_QwibTX8cmgw@mail.gmail.com>
 <CAK8GPyBOiE74meOVjm9yfeUcS5yGBrwB5vffkSFhBQsE9soezA@mail.gmail.com>
 <5695655B.4030704@gmx.net>
 <CAK8GPyA9CwJSWDATxq90axXV5Y=q0LYEzC7B749xBCcGC71goA@mail.gmail.com>
 <CAK8GPyBKAzS01PiYBeSsuAjajP-EizwVVYG46Po1WzQamxJb7A@mail.gmail.com>
 <569E0C00.6000807@sarvision.nl>
Message-ID: <CAK8GPyB74r82xdiiebi5GeSNhvfOSiv1kzE3C=-wK_CEhKL0PQ@mail.gmail.com>

Hi Vincent,


Hi Aaron, I wanted to try your enhanced openjpeg branch, but I see the
above mentioned github url does not work anymore. Is there a successor? Or
should I better wait until your work has been merged into openjpeg trunk?


Yes, I have closed the pull request until we can work out a few issues on
how to merge it into master.
You can find the new and improved version here:

https://github.com/CodecCentral/ronin

on the "excalibur" branch.

Cheers,
Aaron




> On Tue, Jan 12, 2016 at 3:43 PM, Armin Burger < <armin.burger at gmx.net>
> armin.burger at gmx.net> wrote:
>
>> Hi Aaron
>>
>> would this patch (or a patched version of complete Openjpeg source)
>> already be available for testing to assess the difference to current
>> release?
>>
>> Thanks
>> Armin
>>
>> On 12/01/16 15:13, Aaron Boxer wrote:
>>
>>>
>>> Yes, it will be a lot faster. By the way, this patch may be delayed a
>>> little bit while we test some more.
>>>
>>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttp://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160119/339d75ad/attachment.html>

From even.rouault at spatialys.com  Tue Jan 19 15:42:07 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 20 Jan 2016 00:42:07 +0100
Subject: [gdal-dev] Interoperability issues with deleted features in
	shapefiles
Message-ID: <201601200042.08206.even.rouault@spatialys.com>

Hi,

There have been some recent discussion on the qgis list about an old ticket 
https://hub.qgis.org/issues/11007

Basically the issue seems to be that a lot / most non-shapelib / non-OGR based 
shapefile readers don't understand the way OGR delete features in shapefiles.

When OGR/shapelib deletes a feature, it simply marks the corresponding record 
in the DBF as deleted (technically putting a '*' character in the first byte of 
the DBF record) and that's all. Very fast and OGR handles that consistently 
(with the small restriction that the feature count reports the deleted 
features as still existing, but iteration or getting features by id do not 
report them)

This way of deleting a DBF record is the documented one :
http://www.clicketyclick.dk/databases/xbase/format/dbf.html#DBF_STRUCT
"""
Deleted flag:
Value 		Description
2Ah (*) 		Record is deleted
20h (blank) 	Record is valid 
"""

However other GIS packages, and among others, a famous proprietary one - let's 
call it "LineGIS" - when reading such shapefiles do not recognize the deleted 
feature as deleted and display both the geometry and attributes. More 
annoying, when "LineGIS" deletes another record in such a shapefile and saves 
the result, the shapefile can no longer be opened afterwards with an error 
message reporting an inconsistency in number of shapes w.r.t number of records 
(and on inspection, the shp/shx indeed contain N - 1 records and the dbf N - 
2, so it looks like it would be semi-aware of deleted DBF records)
When "LineGIS" starts with a "clean" shapefile and deletes a record in it, it 
removes the corresponding entries in the .dbf, .shp and .shx files, which is 
the result of the REPACK operation the shapefile driver can do if explicitly 
asked.

"LineGIS" isn't the only one to have troubles with deleted DBF records. From 
what I can see GeoTools (just picking a random example) only fully handle them 
since 2014 : 
https://osgeo-org.atlassian.net/browse/GEOT-4539
https://github.com/geotools/geotools/commit/e7333ccb284d137f3240ce5d0d09b3d7195f1890

The shapefile specification ( 
http://www.esri.com/library/whitepapers/pdfs/shapefile.pdf ) doesn't mention 
about how deleted records should be handled. Particularly if the requirement 
"The table must contain one record per shape feature" (page 25) allows DBF 
records marked as deleted... Anyway the theory/spec and the practice are 2 
different things.

What surprises me is such an issue didn't raise more loud complaints before as 
the OGR / shapelib behaviour has been the same since forever AFAIK.

I'm wondering if OGR shouldn't automatically run REPACK when closing a 
shapefile when deletions (as well as edit operations of existing features 
leading to holes in the .shp) have happened. The side effect of this would be a 
slower closing (creation only scenarios wouldn't be affected) and a renumbering 
of the FID of features after the deleted feature(s).

Thoughts ?

(Regarding the QGIS issue, as QGIS explicitly runs REPACK after 
edition/deleting, it is not clear why the issue would persist. But some 
reports might be with older QGIS/GDAL versions)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From kai.muehlbauer at uni-bonn.de  Tue Jan 19 22:35:52 2016
From: kai.muehlbauer at uni-bonn.de (Kai Muehlbauer)
Date: Wed, 20 Jan 2016 07:35:52 +0100
Subject: [gdal-dev] Intersection of two Layers
In-Reply-To: <201601191309.43495.even.rouault@spatialys.com>
References: <569CB6D5.1090209@uni-bonn.de> <569DE86E.5070902@gmail.com>
 <201601191309.43495.even.rouault@spatialys.com>
Message-ID: <569F2AC8.8060309@uni-bonn.de>

Am 19.01.2016 um 13:09 schrieb Even Rouault:
> Le mardi 19 janvier 2016 08:40:30, Ari Jolma a écrit :
>> 18.01.2016, 11:56, Kai Muehlbauer kirjoitti:
>>> Hi,
>>>
>>> at the moment I calculate the intersection of two OGR Layers (A, B) by
>>> iterating over features/geometries (GA) of layer A and then calling
>>> GA.Intersection(GB) for every Feature/Geometry (GB) of B. I set a
>>> spatial filter for layer B with every GA. The intersections
>>> features/geometries are written to a result layer (C).
>>>
>>> In my use case the features/geometries of layer B are much smaller
>>> than the features of layer A. Means that quite a big number of B's
>>> geometries are fully contained in A's geometries.
>>>
>>> To speed things up, I check for containment GA.contains(GB). If GB is
>>> contained in GA, I just copy GB to C, otherwise I calculate
>>> GA.Intersection(GB) and write this to C.
>>>
>>> I found that I also could use the layer intersection function
>>> (OGRLayer::Intersection). Unfortunately the intersection is calculated
>>> for every feature/geometry.
>>>
>>> Would it be possible to extend the layer intersection function to
>>> allow for containment check (eg. as an option) and just copy the
>>> contained geometries without calculation of expensive intersection?
>>> Suggestions, opinions?
>>
>> There's the Options argument, which could be used. Something like
>> "PRETEST=CONTAINMENT" could indicate a wish to test containment before
>> intersection.
>
> The use of GEOS prepared geometry operations could also potentially help. OGR
> has already mapped GEOSPreparedIntersects as OGRPreparedGeometryIntersects and
> that could probably be unconditionnaly used, with the geometry of the outer
> loop being the prepared geometry with OGRCreatePreparedGeometry()
> And perhaps GEOSPreparedContains could be used for containement (if the above
> suggestion desn't speed up things enough).

Thank you Ari and Even for the comments and suggestions. I'll try to 
test the "prepared" stuff first, hoping that those functions are also 
available within the python bindings (which I use).

I'll give an update here, when I have results on this.

Cheers,
Kai

From arnaud.durand at gmail.com  Tue Jan 19 23:26:51 2016
From: arnaud.durand at gmail.com (trewdbal)
Date: Tue, 19 Jan 2016 23:26:51 -0800 (PST)
Subject: [gdal-dev] Issue with ReadBlock
Message-ID: <1453274811267-5246218.post@n6.nabble.com>

Hi Folks,

I'm trying to read an image using ReadBlock, but the array is not filled
with raster values.
It works with RasterIO.

The code below is copied from the GDAL doc ( page
<http://www.gdal.org/classGDALRasterBand.html#ad80cecc562fd48f5783677de625360ac> 
), I just change the type of the pabyData array (I need float32).
I tested with several raster formats, without result.

Another point, maybe linked with the previous, in the doc at the line :
GByte *pabyData = (GByte *) CPLMalloc(nXBlockSize * nYBlockSize);
I'm confused not reading 
GByte *pabyData = (GByte *) CPLMalloc(nXBlockSize * nYBlockSize *
sizeof(GByte));

Thanks for any help.
Trewdbal

int main()
{
	std::cout.precision(12);

	GDALAllRegister();
	const char* PANFile = "/home/ficus/Code/Covariance/rasters/pan2048.tif";

	GDALDataset  *poDataset;
	poDataset = (GDALDataset *) GDALOpen( PANFile, GA_ReadOnly );

	GDALRasterBand  *poBand;
	int nXBlockSize, nYBlockSize;

	poBand = poDataset->GetRasterBand( 1 );
	poBand->GetBlockSize( &nXBlockSize, &nYBlockSize );

	unsigned int SIZEX = poBand->GetXSize();
	unsigned int SIZEY = poBand->GetYSize();

	int nXBlocks = (SIZEX + nXBlockSize - 1) / nXBlockSize;
	int nYBlocks = (SIZEY + nYBlockSize - 1) / nYBlockSize;

	std::cout << " NBlocks = " << nXBlocks << " " << nYBlocks << std::endl;
	std::cout << " Block Size = " << nXBlockSize << " " << nYBlockSize <<
std::endl;

	float* pabyData = (float*)malloc(nXBlockSize * nYBlockSize *
sizeof(float));

	int nXValid = 0;
	int nYValid = 0;
	
	for( int iYBlock = 0; iYBlock < nYBlocks; iYBlock++ )
	{
		for( int iXBlock = 0; iXBlock < nXBlocks; iXBlock++ )
		{
		poBand->ReadBlock( iXBlock, iYBlock, pabyData );

			std::cout << "test " << pabyData[25] << std::endl; // Where we see that
the array is full of 0 values...

			// Compute the portion of the block that is valid
			// for partial edge blocks.
			if( (iXBlock+1) * nXBlockSize > poBand->GetXSize() )
				nXValid = poBand->GetXSize() - iXBlock * nXBlockSize;
			else
				nXValid = nXBlockSize;

			if( (iYBlock+1) * nYBlockSize > poBand->GetYSize() )
				nYValid = poBand->GetYSize() - iYBlock * nYBlockSize;
			else
				nYValid = nYBlockSize;
		}
	}

	free(pabyData);

	GDALClose( poDataset );

	GDALDestroyDriverManager();
	return 0;
}




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Issue-with-ReadBlock-tp5246218.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From gane.prog at gmail.com  Wed Jan 20 00:56:20 2016
From: gane.prog at gmail.com (Gane R)
Date: Wed, 20 Jan 2016 14:26:20 +0530
Subject: [gdal-dev] Building gdal with sqlite3 for windows
Message-ID: <CALMrLdCNYqZNZVh6r9hpyDEyim3wdYkR5WGyaLANBS7dpbdFJA@mail.gmail.com>

Where do I get the sqlite3 with include header files, stub library
sqlite3_i.lib and dll.

Do I have to build it, If so I tried the following

I have a sql-amalgation version.
I tried to look the documentation on sqlite website for creating a
sqlite3.dll

using the following command
cl sqlite3.c -link -dll -out:sqlite3.dll

I got that, but sqlite3_i.lib was not there.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160120/b2588694/attachment.html>

From even.rouault at spatialys.com  Wed Jan 20 01:06:34 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 20 Jan 2016 10:06:34 +0100
Subject: [gdal-dev] Issue with ReadBlock
In-Reply-To: <1453274811267-5246218.post@n6.nabble.com>
References: <1453274811267-5246218.post@n6.nabble.com>
Message-ID: <201601201006.34807.even.rouault@spatialys.com>

Le mercredi 20 janvier 2016 08:26:51, trewdbal a écrit :
> Hi Folks,
> 
> I'm trying to read an image using ReadBlock, but the array is not filled
> with raster values.
> It works with RasterIO.
> 
> The code below is copied from the GDAL doc ( page
> <http://www.gdal.org/classGDALRasterBand.html#ad80cecc562fd48f5783677de6253
> 60ac> ), I just change the type of the pabyData array (I need float32).
> I tested with several raster formats, without result.

You can only use a destination array of Float32 if the natural data type 
reported by GetDataType() is GDT_Float32. IReadBlock() has no way to know the 
data type you expect.
If you need to read in a particular data type, which is not necessarily the 
natural data type of the band, you must use RasterIO(GF_Read, ... , 
GDT_Float32, ....) instead

> 
> Another point, maybe linked with the previous, in the doc at the line :
> GByte *pabyData = (GByte *) CPLMalloc(nXBlockSize * nYBlockSize);
> I'm confused not reading
> GByte *pabyData = (GByte *) CPLMalloc(nXBlockSize * nYBlockSize *
> sizeof(GByte));

sizeof(GByte) == sizeof(unsigned char) == 1 per the C standard

> 
> Thanks for any help.
> Trewdbal
> 
> int main()
> {
> 	std::cout.precision(12);
> 
> 	GDALAllRegister();
> 	const char* PANFile = "/home/ficus/Code/Covariance/rasters/pan2048.tif";
> 
> 	GDALDataset  *poDataset;
> 	poDataset = (GDALDataset *) GDALOpen( PANFile, GA_ReadOnly );
> 
> 	GDALRasterBand  *poBand;
> 	int nXBlockSize, nYBlockSize;
> 
> 	poBand = poDataset->GetRasterBand( 1 );
> 	poBand->GetBlockSize( &nXBlockSize, &nYBlockSize );
> 
> 	unsigned int SIZEX = poBand->GetXSize();
> 	unsigned int SIZEY = poBand->GetYSize();
> 
> 	int nXBlocks = (SIZEX + nXBlockSize - 1) / nXBlockSize;
> 	int nYBlocks = (SIZEY + nYBlockSize - 1) / nYBlockSize;
> 
> 	std::cout << " NBlocks = " << nXBlocks << " " << nYBlocks << std::endl;
> 	std::cout << " Block Size = " << nXBlockSize << " " << nYBlockSize <<
> std::endl;
> 
> 	float* pabyData = (float*)malloc(nXBlockSize * nYBlockSize *
> sizeof(float));
> 
> 	int nXValid = 0;
> 	int nYValid = 0;
> 
> 	for( int iYBlock = 0; iYBlock < nYBlocks; iYBlock++ )
> 	{
> 		for( int iXBlock = 0; iXBlock < nXBlocks; iXBlock++ )
> 		{
> 		poBand->ReadBlock( iXBlock, iYBlock, pabyData );
> 
> 			std::cout << "test " << pabyData[25] << std::endl; // Where we 
see that
> the array is full of 0 values...
> 
> 			// Compute the portion of the block that is valid
> 			// for partial edge blocks.
> 			if( (iXBlock+1) * nXBlockSize > poBand->GetXSize() )
> 				nXValid = poBand->GetXSize() - iXBlock * nXBlockSize;
> 			else
> 				nXValid = nXBlockSize;
> 
> 			if( (iYBlock+1) * nYBlockSize > poBand->GetYSize() )
> 				nYValid = poBand->GetYSize() - iYBlock * nYBlockSize;
> 			else
> 				nYValid = nYBlockSize;
> 		}
> 	}
> 
> 	free(pabyData);
> 
> 	GDALClose( poDataset );
> 
> 	GDALDestroyDriverManager();
> 	return 0;
> }
> 
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/Issue-with-ReadBlock-tp5246218.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Jan 20 01:18:22 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 20 Jan 2016 10:18:22 +0100
Subject: [gdal-dev] Building gdal with sqlite3 for windows
In-Reply-To: <CALMrLdCNYqZNZVh6r9hpyDEyim3wdYkR5WGyaLANBS7dpbdFJA@mail.gmail.com>
References: <CALMrLdCNYqZNZVh6r9hpyDEyim3wdYkR5WGyaLANBS7dpbdFJA@mail.gmail.com>
Message-ID: <201601201018.22630.even.rouault@spatialys.com>

Le mercredi 20 janvier 2016 09:56:20, Gane R a écrit :
> Where do I get the sqlite3 with include header files, stub library
> sqlite3_i.lib and dll.
> 
> Do I have to build it, If so I tried the following
> 
> I have a sql-amalgation version.
> I tried to look the documentation on sqlite website for creating a
> sqlite3.dll
> 
> using the following command
> cl sqlite3.c -link -dll -out:sqlite3.dll
> 
> I got that, but sqlite3_i.lib was not there.


You may need to use the link program itself with /implib

Taken from GDAL's makefile.vc :

$(GDAL_DLL): staticlib
        link /nologo /dll $(OGR_INCLUDE) $(BASE_INCLUDE) $(LIBOBJ) \
                $(EXTERNAL_LIBS) gcore\Version.res \
                 /out:$(GDAL_DLL) /implib:gdal_i.lib $(LINKER_FLAGS)


So likely in 2 steps :
cl /c sqlite3.c (you should probably add optimization options too)
link /dll sqlite3.obj /out:sqlite3.dll /implib:sqlite3_i.lib


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gane.prog at gmail.com  Wed Jan 20 02:12:47 2016
From: gane.prog at gmail.com (Gane R)
Date: Wed, 20 Jan 2016 15:42:47 +0530
Subject: [gdal-dev] Building gdal with sqlite3 for windows
In-Reply-To: <201601201018.22630.even.rouault@spatialys.com>
References: <CALMrLdCNYqZNZVh6r9hpyDEyim3wdYkR5WGyaLANBS7dpbdFJA@mail.gmail.com>
 <201601201018.22630.even.rouault@spatialys.com>
Message-ID: <CALMrLdBxC9Xk59h+82Tp2DPJQhkZfqCEpx026OiHbzLC4bL8dg@mail.gmail.com>

I was looking at the makefile.vc and docs and visual studio reference I was
not able to create sqlite3_i.lib do I miss something apart from linker
optimization flags

cl /c sqlite3.c
link /nologo /dll sqlite3.obj /out:sqlite3.dll /implib:sqlite3_i.lib

My goal is make gdal access geopackage so I want to use this sqlite3 in
nmake.opt, correct me If I am wrong.

On Wed, Jan 20, 2016 at 2:48 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le mercredi 20 janvier 2016 09:56:20, Gane R a écrit :
> > Where do I get the sqlite3 with include header files, stub library
> > sqlite3_i.lib and dll.
> >
> > Do I have to build it, If so I tried the following
> >
> > I have a sql-amalgation version.
> > I tried to look the documentation on sqlite website for creating a
> > sqlite3.dll
> >
> > using the following command
> > cl sqlite3.c -link -dll -out:sqlite3.dll
> >
> > I got that, but sqlite3_i.lib was not there.
>
>
> You may need to use the link program itself with /implib
>
> Taken from GDAL's makefile.vc :
>
> $(GDAL_DLL): staticlib
>         link /nologo /dll $(OGR_INCLUDE) $(BASE_INCLUDE) $(LIBOBJ) \
>                 $(EXTERNAL_LIBS) gcore\Version.res \
>                  /out:$(GDAL_DLL) /implib:gdal_i.lib $(LINKER_FLAGS)
>
>
> So likely in 2 steps :
> cl /c sqlite3.c (you should probably add optimization options too)
> link /dll sqlite3.obj /out:sqlite3.dll /implib:sqlite3_i.lib
>
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160120/8df9d629/attachment-0001.html>

From gane.prog at gmail.com  Wed Jan 20 03:24:58 2016
From: gane.prog at gmail.com (Gane R)
Date: Wed, 20 Jan 2016 16:54:58 +0530
Subject: [gdal-dev] Building gdal with sqlite3 for windows
In-Reply-To: <CALMrLdBxC9Xk59h+82Tp2DPJQhkZfqCEpx026OiHbzLC4bL8dg@mail.gmail.com>
References: <CALMrLdCNYqZNZVh6r9hpyDEyim3wdYkR5WGyaLANBS7dpbdFJA@mail.gmail.com>
 <201601201018.22630.even.rouault@spatialys.com>
 <CALMrLdBxC9Xk59h+82Tp2DPJQhkZfqCEpx026OiHbzLC4bL8dg@mail.gmail.com>
Message-ID: <CALMrLdANZ56DzV-kbVagweTZj9vC-gbfehX+B0tKELd1u31veA@mail.gmail.com>

Is that I have to build the sqlite3 separately and then build gdal, does
gdal have an sqlite internally like png (libpng)  if so how can it be used.

Thanks


On Wed, Jan 20, 2016 at 3:42 PM, Gane R <gane.prog at gmail.com> wrote:

> I was looking at the makefile.vc and docs and visual studio reference I
> was not able to create sqlite3_i.lib do I miss something apart from linker
> optimization flags
>
> cl /c sqlite3.c
> link /nologo /dll sqlite3.obj /out:sqlite3.dll /implib:sqlite3_i.lib
>
> My goal is make gdal access geopackage so I want to use this sqlite3 in
> nmake.opt, correct me If I am wrong.
>
> On Wed, Jan 20, 2016 at 2:48 PM, Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> Le mercredi 20 janvier 2016 09:56:20, Gane R a écrit :
>> > Where do I get the sqlite3 with include header files, stub library
>> > sqlite3_i.lib and dll.
>> >
>> > Do I have to build it, If so I tried the following
>> >
>> > I have a sql-amalgation version.
>> > I tried to look the documentation on sqlite website for creating a
>> > sqlite3.dll
>> >
>> > using the following command
>> > cl sqlite3.c -link -dll -out:sqlite3.dll
>> >
>> > I got that, but sqlite3_i.lib was not there.
>>
>>
>> You may need to use the link program itself with /implib
>>
>> Taken from GDAL's makefile.vc :
>>
>> $(GDAL_DLL): staticlib
>>         link /nologo /dll $(OGR_INCLUDE) $(BASE_INCLUDE) $(LIBOBJ) \
>>                 $(EXTERNAL_LIBS) gcore\Version.res \
>>                  /out:$(GDAL_DLL) /implib:gdal_i.lib $(LINKER_FLAGS)
>>
>>
>> So likely in 2 steps :
>> cl /c sqlite3.c (you should probably add optimization options too)
>> link /dll sqlite3.obj /out:sqlite3.dll /implib:sqlite3_i.lib
>>
>>
>> --
>> Spatialys - Geospatial professional services
>> http://www.spatialys.com
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160120/aff331bb/attachment.html>

From arnaud.durand at gmail.com  Wed Jan 20 05:23:33 2016
From: arnaud.durand at gmail.com (trewdbal)
Date: Wed, 20 Jan 2016 05:23:33 -0800 (PST)
Subject: [gdal-dev] Issue with ReadBlock
In-Reply-To: <201601201006.34807.even.rouault@spatialys.com>
References: <1453274811267-5246218.post@n6.nabble.com>
 <201601201006.34807.even.rouault@spatialys.com>
Message-ID: <1453296213610-5246310.post@n6.nabble.com>

Indeed, I was trying to read a uint16 imagery using a float32 array.

Thanks for you speedy assistance.




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Issue-with-ReadBlock-tp5246218p5246310.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From jmckenna at gatewaygeomatics.com  Wed Jan 20 07:02:38 2016
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Wed, 20 Jan 2016 11:02:38 -0400
Subject: [gdal-dev] Building gdal with sqlite3 for windows
In-Reply-To: <CALMrLdANZ56DzV-kbVagweTZj9vC-gbfehX+B0tKELd1u31veA@mail.gmail.com>
References: <CALMrLdCNYqZNZVh6r9hpyDEyim3wdYkR5WGyaLANBS7dpbdFJA@mail.gmail.com>
 <201601201018.22630.even.rouault@spatialys.com>
 <CALMrLdBxC9Xk59h+82Tp2DPJQhkZfqCEpx026OiHbzLC4bL8dg@mail.gmail.com>
 <CALMrLdANZ56DzV-kbVagweTZj9vC-gbfehX+B0tKELd1u31veA@mail.gmail.com>
Message-ID: <569FA18E.2090800@gatewaygeomatics.com>

On 2016-01-20 7:24 AM, Gane R wrote:
> Is that I have to build the sqlite3 separately and then build gdal, does
> gdal have an sqlite internally like png (libpng)  if so how can it be used.
>
> Thanks
>
>

You must build sqlite separately.  For MS4W builds (www.ms4w.com) we 
start by building sqlite, and then we build libspatialite, which 
actually requires sqlite; then we point to those libs in the nmake.opt

   SQLITE_INC= your sqlite and libspatialite paths
   SQLITE_LIB= your sqlite and libspatialite libs


-jeff



-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/





From jan.heckman at gmail.com  Wed Jan 20 11:56:27 2016
From: jan.heckman at gmail.com (Jan Heckman)
Date: Wed, 20 Jan 2016 20:56:27 +0100
Subject: [gdal-dev] Interoperability issues with deleted features in
	shapefiles
In-Reply-To: <201601201151.12712.even.rouault@spatialys.com>
References: <201601200042.08206.even.rouault@spatialys.com>
 <CAKMUAtBP==cKv-kk5zekBW-tmg7dpbWH-dTFK67RSJOKEzDNDQ@mail.gmail.com>
 <201601201151.12712.even.rouault@spatialys.com>
Message-ID: <CAKMUAtAFg0OpUgHP_=9KjJwyKCoswvDmGYMAmF+GcRQoWkr4=Q@mail.gmail.com>

Hi Even, everyone,
Sorry for not including the list - my mistake.
I've experimented with larger shapefiles than 2 GB but not necessarily in
combination with editing.
I'll do a few tests when I get around to it. Doesn't the .shx file get
rewritten anyway? There could be some time-consuming actions at closing
time partially masking the additional time needed for shp.
Time needed for compacting the .shp would have a considerable potential
variation depending on the extent of editing and the displacement caused in
the shapefile.
My first idea was not to compact the shapefile (automatically), but do the
.shx only (leaving out indexes of deleted shp records or setting their
length in the shx and/or shp to zero). But there are some programs which do
not pay much attention to the .shx anyway. If we can discount such
behaviour, the shx route is ok, and a compact can be done as a separate
action, like PACK in good old Dbase.
Jan


On Wed, Jan 20, 2016 at 11:51 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Jan,
>
> Do you mind sharing your opinion with the list too ?
>
> > Hi,
> > I started a bit of a lib years and years ago when the shapelib code
> didn't
> > have delete.
> > I implemented my own delete much as you mention (both dbf and shp/shx),
> > with a repack at closing.
> > Repack at closing never bothered me in the sense of any (very) noticeable
> > delay.
> > So I think it's indeed the best solution and the price is not high.
>
> Depends on the size of shapefiles. For people with 2 GB shapefiles, that
> might
> be noticeable. But editing operations on such shapefiles aren't necessarily
> very common admitedly.
>
> > Regards,
> > Jan
> >
> > On Wed, Jan 20, 2016 at 12:42 AM, Even Rouault <
> even.rouault at spatialys.com>
> >
> > wrote:
> > > Hi,
> > >
> > > There have been some recent discussion on the qgis list about an old
> > > ticket https://hub.qgis.org/issues/11007
> > >
> > > Basically the issue seems to be that a lot / most non-shapelib /
> non-OGR
> > > based
> > > shapefile readers don't understand the way OGR delete features in
> > > shapefiles.
> > >
> > > When OGR/shapelib deletes a feature, it simply marks the corresponding
> > > record
> > > in the DBF as deleted (technically putting a '*' character in the first
> > > byte of
> > > the DBF record) and that's all. Very fast and OGR handles that
> > > consistently (with the small restriction that the feature count reports
> > > the deleted features as still existing, but iteration or getting
> > > features by id do not report them)
> > >
> > > This way of deleting a DBF record is the documented one :
> > > http://www.clicketyclick.dk/databases/xbase/format/dbf.html#DBF_STRUCT
> > > """
> > > Deleted flag:
> > > Value           Description
> > > 2Ah (*)                 Record is deleted
> > > 20h (blank)     Record is valid
> > > """
> > >
> > > However other GIS packages, and among others, a famous proprietary one
> -
> > > let's
> > > call it "LineGIS" - when reading such shapefiles do not recognize the
> > > deleted
> > > feature as deleted and display both the geometry and attributes. More
> > > annoying, when "LineGIS" deletes another record in such a shapefile and
> > > saves
> > > the result, the shapefile can no longer be opened afterwards with an
> > > error message reporting an inconsistency in number of shapes w.r.t
> > > number of records
> > > (and on inspection, the shp/shx indeed contain N - 1 records and the
> dbf
> > > N -
> > > 2, so it looks like it would be semi-aware of deleted DBF records)
> > > When "LineGIS" starts with a "clean" shapefile and deletes a record in
> > > it, it
> > > removes the corresponding entries in the .dbf, .shp and .shx files,
> which
> > > is
> > > the result of the REPACK operation the shapefile driver can do if
> > > explicitly
> > > asked.
> > >
> > > "LineGIS" isn't the only one to have troubles with deleted DBF records.
> > > From
> > > what I can see GeoTools (just picking a random example) only fully
> handle
> > > them
> > > since 2014 :
> > > https://osgeo-org.atlassian.net/browse/GEOT-4539
> > >
> > >
> https://github.com/geotools/geotools/commit/e7333ccb284d137f3240ce5d0d09b
> > > 3d7195f1890
> > >
> > > The shapefile specification (
> > > http://www.esri.com/library/whitepapers/pdfs/shapefile.pdf ) doesn't
> > > mention
> > > about how deleted records should be handled. Particularly if the
> > > requirement
> > > "The table must contain one record per shape feature" (page 25) allows
> > > DBF records marked as deleted... Anyway the theory/spec and the
> practice
> > > are 2 different things.
> > >
> > > What surprises me is such an issue didn't raise more loud complaints
> > > before as
> > > the OGR / shapelib behaviour has been the same since forever AFAIK.
> > >
> > > I'm wondering if OGR shouldn't automatically run REPACK when closing a
> > > shapefile when deletions (as well as edit operations of existing
> features
> > > leading to holes in the .shp) have happened. The side effect of this
> > > would be a
> > > slower closing (creation only scenarios wouldn't be affected) and a
> > > renumbering
> > > of the FID of features after the deleted feature(s).
> > >
> > > Thoughts ?
> > >
> > > (Regarding the QGIS issue, as QGIS explicitly runs REPACK after
> > > edition/deleting, it is not clear why the issue would persist. But some
> > > reports might be with older QGIS/GDAL versions)
> > >
> > > Even
> > >
> > > --
> > > Spatialys - Geospatial professional services
> > > http://www.spatialys.com
> > > _______________________________________________
> > > gdal-dev mailing list
> > > gdal-dev at lists.osgeo.org
> > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160120/79e6e71e/attachment-0001.html>

From lucena_ivan at hotmail.com  Wed Jan 20 12:18:08 2016
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Wed, 20 Jan 2016 20:18:08 +0000
Subject: [gdal-dev] ogr2ogr to update existing table
Message-ID: <BLUPR19MB014588AF0D0F6AF67DE5285BF2C20@BLUPR19MB0145.namprd19.prod.outlook.com>

Hi,


Is there a way to select one or two fields from a input data source to update specific fields of an existing output data source?


Let's say I want to get the values from a prticular field of the input data source and the geometry to update a specific field and the geometry of an existing output data source.


Looking at the org2gr "-fieldmap" options it says it only work with "-append" but it doesn't examplain why. If it works it would be something like:


$ ogr2ogr -update -f format output_data_source input_data_source -nln output_layer -sql "select field1 from input_layer" -fieldmap 4


Where "4" would indicate the 3th field of the output_layer.


Does anybody have another solution for that?


Thanks.


Ivan

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160120/3e297492/attachment.html>

From lacy at wisc.edu  Wed Jan 20 13:37:41 2016
From: lacy at wisc.edu (Jim Lacy)
Date: Wed, 20 Jan 2016 21:37:41 +0000
Subject: [gdal-dev] Mixed coordinate systems in VRT?
Message-ID: <BLUPR0601MB1667B90BFFF11CAF00D9EBBFB9C20@BLUPR0601MB1667.namprd06.prod.outlook.com>

I have an area of interest that is split across two UTM zones.  My desired end result is a single stitched, clipped, and re-projected image in a local coordinate system.

My usual workflow is to build a VRT that contain only the input tiles that touch the area of interest.  Normally that works great, but not when split across zones. I know it's possible to create a VRT containing two or more coordinate systems with the gdalbuildvrt  -allow_projection_difference option.

There are at least two ways I could proceed:


A)     Two steps: reproject all input tiles to a common base with gdalwarp, then stitch/clip with gdalwarp -t_srs "EPSG:7645"  -cutline clip.shp -crop_to_cutline aoi.vrt output.tif  (where aoi.vrt contains a list of tiles that touch the AOI)

B)      One step:  gdalwarp -t_srs "EPSG:7645" mixed_utm_zones.vrt output.tif

"B" is  nice option in theory. However, in my experiments, it appears that only half the AOI is processed when I try.  Option "A" works fine, but it seems like the image would be resampled twice... once for each gdalwarp command?

Can anyone confirm if B is theoretically possible?  Better approaches?  This must be a common issue.

Thanks for advice!

----------------------------------------------
Jim Lacy
Wisconsin State Cartographer's Office
University of Wisconsin-Madison
(608) 262-6850
www.sco.wisc.edu<http://www.sco.wisc.edu/>
My calendar:  http://go.wisc.edu/xziys4

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160120/865eb7f5/attachment.html>

From even.rouault at spatialys.com  Wed Jan 20 13:55:40 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 20 Jan 2016 22:55:40 +0100
Subject: [gdal-dev] Mixed coordinate systems in VRT?
In-Reply-To: <BLUPR0601MB1667B90BFFF11CAF00D9EBBFB9C20@BLUPR0601MB1667.namprd06.prod.outlook.com>
References: <BLUPR0601MB1667B90BFFF11CAF00D9EBBFB9C20@BLUPR0601MB1667.namprd06.prod.outlook.com>
Message-ID: <201601202255.41250.even.rouault@spatialys.com>

Le mercredi 20 janvier 2016 22:37:41, Jim Lacy a écrit :
> I have an area of interest that is split across two UTM zones.  My desired
> end result is a single stitched, clipped, and re-projected image in a
> local coordinate system.
> 
> My usual workflow is to build a VRT that contain only the input tiles that
> touch the area of interest.  Normally that works great, but not when split
> across zones. I know it's possible to create a VRT containing two or more
> coordinate systems with the gdalbuildvrt  -allow_projection_difference
> option.
> 
> There are at least two ways I could proceed:
> 
> 
> A)     Two steps: reproject all input tiles to a common base with gdalwarp,
> then stitch/clip with gdalwarp -t_srs "EPSG:7645"  -cutline clip.shp
> -crop_to_cutline aoi.vrt output.tif  (where aoi.vrt contains a list of
> tiles that touch the AOI)
> 
> B)      One step:  gdalwarp -t_srs "EPSG:7645" mixed_utm_zones.vrt
> output.tif
> 
> "B" is  nice option in theory. However, in my experiments, it appears that
> only half the AOI is processed when I try.  Option "A" works fine, but it
> seems like the image would be resampled twice... once for each gdalwarp
> command?
> 
> Can anyone confirm if B is theoretically possible?  Better approaches? 
> This must be a common issue.

If there's an explicit switch to add to avoid a warning, generally it means 
"are you sure you know what you do ?" ;-)

And the doc indeed mentions :

<dt> <b>-allow_projection_difference</b>:</dt><dd> (starting with GDAL 1.7.0)
When this option is specified, the utility will accept to make a VRT even if 
the input datasets have
not the same projection. Note: this does not mean that they will be 
reprojected. Their projection will
just be ignored.
</dd>

The option is intended for files whose projection WKT is slightly different on 
not significant things, like minor differences in citations, typically coming 
from different formats, but the projection is fundamentally the same.

gdalwarp accepts several input datasets, so you could create 2 VRT for each 
utm zone and provide them to gdalwarp. Or you could just throw directly all 
the input datasets directly into gdalwarp. gdalwarp accepts input datasets in 
different projections.

> 
> Thanks for advice!
> 
> ----------------------------------------------
> Jim Lacy
> Wisconsin State Cartographer's Office
> University of Wisconsin-Madison
> (608) 262-6850
> www.sco.wisc.edu<http://www.sco.wisc.edu/>
> My calendar:  http://go.wisc.edu/xziys4

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Jan 20 15:48:03 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 21 Jan 2016 00:48:03 +0100
Subject: [gdal-dev] Interoperability issues with deleted features in
	shapefiles
In-Reply-To: <CAKMUAtAFg0OpUgHP_=9KjJwyKCoswvDmGYMAmF+GcRQoWkr4=Q@mail.gmail.com>
References: <201601200042.08206.even.rouault@spatialys.com>
 <201601201151.12712.even.rouault@spatialys.com>
 <CAKMUAtAFg0OpUgHP_=9KjJwyKCoswvDmGYMAmF+GcRQoWkr4=Q@mail.gmail.com>
Message-ID: <201601210048.04017.even.rouault@spatialys.com>

Le mercredi 20 janvier 2016 20:56:27, Jan Heckman a écrit :
> Hi Even, everyone,
> Sorry for not including the list - my mistake.
> I've experimented with larger shapefiles than 2 GB but not necessarily in
> combination with editing.
> I'll do a few tests when I get around to it. Doesn't the .shx file get
> rewritten anyway? 

If there's any change?, yes the .shx it entirely rewritten (but for deleted 
features, it still points to the shape location in the .shp). I'm not sure why 
the .shx isn't updated on the fly when shapes are created/moved. Probably 
because this was most straightforward to implement and .shx files are generally 
rather small compared to .shp/.dbf so ingesting them and rewriting them 
completely is generally not an issue.

> There could be some time-consuming actions at closing
> time partially masking the additional time needed for shp.
> Time needed for compacting the .shp would have a considerable potential
> variation depending on the extent of editing and the displacement caused in
> the shapefile.

Actually the current REPACK implementation is quite brutal: it creates fresh 
new temporary .shp and .dbf files and if things are OK rename them.

> My first idea was not to compact the shapefile (automatically), but do the
> .shx only (leaving out indexes of deleted shp records or setting their
> length in the shx and/or shp to zero). But there are some programs which do
> not pay much attention to the .shx anyway.

Yes OpenJump is one of them I believe. Or perhaps it uses it if present and 
otherwise work only with the .shp. Jukka would know

> If we can discount such
> behaviour, the shx route is ok, 

Not sure to follow what you mean by "the shx route"

> and a compact can be done as a separate
> action, like PACK in good old Dbase.
> Jan
> 
> 
> On Wed, Jan 20, 2016 at 11:51 AM, Even Rouault <even.rouault at spatialys.com>
> 
> wrote:
> > Jan,
> > 
> > Do you mind sharing your opinion with the list too ?
> > 
> > > Hi,
> > > I started a bit of a lib years and years ago when the shapelib code
> > 
> > didn't
> > 
> > > have delete.
> > > I implemented my own delete much as you mention (both dbf and shp/shx),
> > > with a repack at closing.
> > > Repack at closing never bothered me in the sense of any (very)
> > > noticeable delay.
> > > So I think it's indeed the best solution and the price is not high.
> > 
> > Depends on the size of shapefiles. For people with 2 GB shapefiles, that
> > might
> > be noticeable. But editing operations on such shapefiles aren't
> > necessarily very common admitedly.
> > 
> > > Regards,
> > > Jan
> > > 
> > > On Wed, Jan 20, 2016 at 12:42 AM, Even Rouault <
> > 
> > even.rouault at spatialys.com>
> > 
> > > wrote:
> > > > Hi,
> > > > 
> > > > There have been some recent discussion on the qgis list about an old
> > > > ticket https://hub.qgis.org/issues/11007
> > > > 
> > > > Basically the issue seems to be that a lot / most non-shapelib /
> > 
> > non-OGR
> > 
> > > > based
> > > > shapefile readers don't understand the way OGR delete features in
> > > > shapefiles.
> > > > 
> > > > When OGR/shapelib deletes a feature, it simply marks the
> > > > corresponding record
> > > > in the DBF as deleted (technically putting a '*' character in the
> > > > first byte of
> > > > the DBF record) and that's all. Very fast and OGR handles that
> > > > consistently (with the small restriction that the feature count
> > > > reports the deleted features as still existing, but iteration or
> > > > getting features by id do not report them)
> > > > 
> > > > This way of deleting a DBF record is the documented one :
> > > > http://www.clicketyclick.dk/databases/xbase/format/dbf.html#DBF_STRUC
> > > > T """
> > > > Deleted flag:
> > > > Value           Description
> > > > 2Ah (*)                 Record is deleted
> > > > 20h (blank)     Record is valid
> > > > """
> > > > 
> > > > However other GIS packages, and among others, a famous proprietary
> > > > one
> > 
> > -
> > 
> > > > let's
> > > > call it "LineGIS" - when reading such shapefiles do not recognize the
> > > > deleted
> > > > feature as deleted and display both the geometry and attributes. More
> > > > annoying, when "LineGIS" deletes another record in such a shapefile
> > > > and saves
> > > > the result, the shapefile can no longer be opened afterwards with an
> > > > error message reporting an inconsistency in number of shapes w.r.t
> > > > number of records
> > > > (and on inspection, the shp/shx indeed contain N - 1 records and the
> > 
> > dbf
> > 
> > > > N -
> > > > 2, so it looks like it would be semi-aware of deleted DBF records)
> > > > When "LineGIS" starts with a "clean" shapefile and deletes a record
> > > > in it, it
> > > > removes the corresponding entries in the .dbf, .shp and .shx files,
> > 
> > which
> > 
> > > > is
> > > > the result of the REPACK operation the shapefile driver can do if
> > > > explicitly
> > > > asked.
> > > > 
> > > > "LineGIS" isn't the only one to have troubles with deleted DBF
> > > > records. From
> > > > what I can see GeoTools (just picking a random example) only fully
> > 
> > handle
> > 
> > > > them
> > > > since 2014 :
> > > > https://osgeo-org.atlassian.net/browse/GEOT-4539
> > 
> > https://github.com/geotools/geotools/commit/e7333ccb284d137f3240ce5d0d09b
> > 
> > > > 3d7195f1890
> > > > 
> > > > The shapefile specification (
> > > > http://www.esri.com/library/whitepapers/pdfs/shapefile.pdf ) doesn't
> > > > mention
> > > > about how deleted records should be handled. Particularly if the
> > > > requirement
> > > > "The table must contain one record per shape feature" (page 25)
> > > > allows DBF records marked as deleted... Anyway the theory/spec and
> > > > the
> > 
> > practice
> > 
> > > > are 2 different things.
> > > > 
> > > > What surprises me is such an issue didn't raise more loud complaints
> > > > before as
> > > > the OGR / shapelib behaviour has been the same since forever AFAIK.
> > > > 
> > > > I'm wondering if OGR shouldn't automatically run REPACK when closing
> > > > a shapefile when deletions (as well as edit operations of existing
> > 
> > features
> > 
> > > > leading to holes in the .shp) have happened. The side effect of this
> > > > would be a
> > > > slower closing (creation only scenarios wouldn't be affected) and a
> > > > renumbering
> > > > of the FID of features after the deleted feature(s).
> > > > 
> > > > Thoughts ?
> > > > 
> > > > (Regarding the QGIS issue, as QGIS explicitly runs REPACK after
> > > > edition/deleting, it is not clear why the issue would persist. But
> > > > some reports might be with older QGIS/GDAL versions)
> > > > 
> > > > Even
> > > > 
> > > > --
> > > > Spatialys - Geospatial professional services
> > > > http://www.spatialys.com
> > > > _______________________________________________
> > > > gdal-dev mailing list
> > > > gdal-dev at lists.osgeo.org
> > > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Jan 21 02:44:19 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 21 Jan 2016 11:44:19 +0100
Subject: [gdal-dev] GDAL 2.0.2 and 1.11.4: RC1 end of next week ?
In-Reply-To: <201601131747.19103.even.rouault@spatialys.com>
References: <201601131747.19103.even.rouault@spatialys.com>
Message-ID: <201601211144.19922.even.rouault@spatialys.com>

Le mercredi 13 janvier 2016 17:47:19, Even Rouault a écrit :
> Hi,
> 
> What about preparing RC1s for both branches for end of next week ? There
> are ~ 30 tickets marked as fixed (*) in each branch (so likely ~ 60 for
> 2.0.2 since most of the 1.11.4 fixes must also apply to 2.0.2), and a bit
> more than 3 months since last maintenance releases.
> 
> I can tackle that unless someone else volunteers.

Just a remainder I intend cutting the RCs tomorrow unless someone speaks up.

> 
> Even
> 
> 
> (*)
> https://trac.osgeo.org/gdal/query?status=closed&group=resolution&milestone=
> 1.11.4
> https://trac.osgeo.org/gdal/query?status=closed&group=resolution&milestone
> =2.0.2

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jmckenna at gatewaygeomatics.com  Thu Jan 21 05:56:13 2016
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Thu, 21 Jan 2016 09:56:13 -0400
Subject: [gdal-dev] GDAL 2.0.2 and 1.11.4: RC1 end of next week ?
In-Reply-To: <201601211144.19922.even.rouault@spatialys.com>
References: <201601131747.19103.even.rouault@spatialys.com>
 <201601211144.19922.even.rouault@spatialys.com>
Message-ID: <56A0E37D.5080105@gatewaygeomatics.com>

On 2016-01-21 6:44 AM, Even Rouault wrote:
>
> Just a remainder I intend cutting the RCs tomorrow unless someone speaks up.
>
>>
>> Even
>>

+1

I will test on Windows.

-jeff





-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/

From boxerab at gmail.com  Thu Jan 21 21:51:04 2016
From: boxerab at gmail.com (Aaron Boxer)
Date: Fri, 22 Jan 2016 00:51:04 -0500
Subject: [gdal-dev] OpenJPEG Testers Needed
In-Reply-To: <CAK8GPyC+vCKk-kTwGmchihe-300u_Vgb3ao8=rnzibgvWG3wAA@mail.gmail.com>
References: <CAK8GPyBAUWWZkZirWbAYbXV_51MHZXKut1hQg4+-wmfaQx228A@mail.gmail.com>
 <201601132011.57686.even.rouault@spatialys.com>
 <CAK8GPyC7yom5cDqvFYxTx1sFxSshJtox+1tM08uHVsaTXbjJ3Q@mail.gmail.com>
 <201601132040.26718.even.rouault@spatialys.com>
 <CAK8GPyC+vCKk-kTwGmchihe-300u_Vgb3ao8=rnzibgvWG3wAA@mail.gmail.com>
Message-ID: <CAK8GPyBqZxhhvH+ZnHXfE93nZyf_77C2Owxq0DgKNazWcXQpbw@mail.gmail.com>

So, it turns out to be quite complicated to re-factor the wavelet transform
to only transform a sub-region
inside a single tile image.

I've got it working now for lossy decode, lossless decode also works but 4
units tests are broken at the moment.

And, I am seeing a massive increase in performance: I tested an 11000 x
14000 lossless compressed single tile RGB 8 bit image,
decoding a 1000x1000 region in the middle of the image.  OpenJPEG master
takes around 60 seconds to decompress, and
my branch takes 3 seconds, on my 4 year old i7.. The cores are not even
half utilized, so this time should come down by at least a factor of two.

One remaining issue is memory allocation: still need to allocate gigabytes
of memory to do this. But, this should be an easy fix over the next few
weeks.

Will keep you all posted.

Cheers,
Aaron




On Wed, Jan 13, 2016 at 2:49 PM, Aaron Boxer <boxerab at gmail.com> wrote:

>
>
> On Wed, Jan 13, 2016 at 2:40 PM, Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>>
>> > So, are you saying there are actual pixel differences between encoded
>> file
>> > and original?
>>
>> Yes
>>
>
> I see. So, this is repeatable every time you run the test suite?  And you
> can't reproduce
> with opj_compress followed by opj_decompress ?
>
>
>> > > oh, so how does one make a forward struct declaration to make gcc 4.4
>> > happy ?
>>
>> Apparently it doesn't like to see "typedef struct foo { ... } bar"
>> (openjpeg.h) and "typedef struct foo bar" (region_mgr.h).
>> If openjpeg.h was "struct foo { ... }", that would work (but we cannot
>> touch
>> that one). Why not just including openjpeg.h in region_mgr.h to avoid the
>> typedef redefinitions ?
>>
>>
> Thanks, I moves some code around and now it should compile on 4.4.
>
>
>> >
>> > > Testing with 2048x2048 tiled images, with OpenMP enabled, I can see
>> perf
>> > > improvements.
>> > > For example ~2s  (4 vCPU) vs ~3s (openjpeg 2.1) to decode a tile.
>> > >
>> > > Great. So, this is good. What are your system specs, may I ask ?
>>
>> Was on a i5 CPU 750 @ 2.67GHz, 4 GB RAM, 64bit build
>>
>> OK, thanks.
>
>
>> > >
>> > >
>> > >
>> > >
>> > > With a single tiled 11310x17310 image with which GDAL uses the
>> > > opj_set_decode_area() area,
>> > > I couldn't really see the difference as the memory consumption grows
>> to
>> > > above 2 GB,
>> > > which cause disk trashing on the system on which I test.
>> >
>> > Yes, that makes sense, there is still work to be done, I guess. The
>> wavelet
>> > transform
>> > needs to be modified to be more memory efficient.  What size of decode
>> area
>> > would you
>> > typically want to set on an image of that size ?
>>
>> One use case could be for displaying in a desktop GIS application (QGIS
>> for
>> example), so the size of the display area. Let's say 2000x1000 max.
>>
>>
> Great, thanks for the feedback.
>
>
>
>
>> >
>> >
>> > Thanks again,
>> > Aaron
>> >
>> >
>> > Even
>> >
>> > > --
>> > > Spatialys - Geospatial professional services
>> > > http://www.spatialys.com
>>
>> --
>> Spatialys - Geospatial professional services
>> http://www.spatialys.com
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160122/a9f5565f/attachment.html>

From kai.muehlbauer at uni-bonn.de  Fri Jan 22 00:06:28 2016
From: kai.muehlbauer at uni-bonn.de (Kai Muehlbauer)
Date: Fri, 22 Jan 2016 09:06:28 +0100
Subject: [gdal-dev] Intersection of two Layers
In-Reply-To: <569F2AC8.8060309@uni-bonn.de>
References: <569CB6D5.1090209@uni-bonn.de> <569DE86E.5070902@gmail.com>
 <201601191309.43495.even.rouault@spatialys.com>
 <569F2AC8.8060309@uni-bonn.de>
Message-ID: <56A1E304.4090408@uni-bonn.de>

Am 20.01.2016 um 07:35 schrieb Kai Muehlbauer:
> Am 19.01.2016 um 13:09 schrieb Even Rouault:
>> Le mardi 19 janvier 2016 08:40:30, Ari Jolma a écrit :
>>> 18.01.2016, 11:56, Kai Muehlbauer kirjoitti:
>>>> Hi,
>>>>
>>>> at the moment I calculate the intersection of two OGR Layers (A, B) by
>>>> iterating over features/geometries (GA) of layer A and then calling
>>>> GA.Intersection(GB) for every Feature/Geometry (GB) of B. I set a
>>>> spatial filter for layer B with every GA. The intersections
>>>> features/geometries are written to a result layer (C).
>>>>
>>>> In my use case the features/geometries of layer B are much smaller
>>>> than the features of layer A. Means that quite a big number of B's
>>>> geometries are fully contained in A's geometries.
>>>>
>>>> To speed things up, I check for containment GA.contains(GB). If GB is
>>>> contained in GA, I just copy GB to C, otherwise I calculate
>>>> GA.Intersection(GB) and write this to C.
>>>>
>>>> I found that I also could use the layer intersection function
>>>> (OGRLayer::Intersection). Unfortunately the intersection is calculated
>>>> for every feature/geometry.
>>>>
>>>> Would it be possible to extend the layer intersection function to
>>>> allow for containment check (eg. as an option) and just copy the
>>>> contained geometries without calculation of expensive intersection?
>>>> Suggestions, opinions?
>>>
>>> There's the Options argument, which could be used. Something like
>>> "PRETEST=CONTAINMENT" could indicate a wish to test containment before
>>> intersection.
>>
>> The use of GEOS prepared geometry operations could also potentially
>> help. OGR
>> has already mapped GEOSPreparedIntersects as
>> OGRPreparedGeometryIntersects and
>> that could probably be unconditionnaly used, with the geometry of the
>> outer
>> loop being the prepared geometry with OGRCreatePreparedGeometry()
>> And perhaps GEOSPreparedContains could be used for containement (if
>> the above
>> suggestion desn't speed up things enough).
>
> Thank you Ari and Even for the comments and suggestions. I'll try to
> test the "prepared" stuff first, hoping that those functions are also
> available within the python bindings (which I use).
>
> I'll give an update here, when I have results on this.

OK, here we go.

JFTR, I'am using the SWIG python bindings for ogr.

To quickly check if there is an improvement I used the python shapely 
package. Converting the outer loop geometry to an shapely prepared 
geometry and calling 'contains()' with the inner loop geometries to find 
those fully contained geometries I get an improvement of nearly 40% to 
the former ogr only code.

As Even pointed out, there is only OGRPreparedGeometryIntersects() 
(GEOSPreparedIntersects) exposed within ogrgeometry.cpp. In my use case 
I would need GEOSPreparedContains to mimic the shapely behaviour.

Next thing is that the ogr SWIG python bindings do not wrap those 
available OGRPrepared-functions.

I'm no expert when it comes to c/c++-python interaction to create a 
patch to have this functionality within python ogr/gdal. So hoping for 
help in this matter, I'm asking for suggestions how to get the 
GEOSPreparedGeometry stuff called from OGR.

Cheers,
Kai

From ari.jolma at gmail.com  Fri Jan 22 01:52:26 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Fri, 22 Jan 2016 11:52:26 +0200
Subject: [gdal-dev] Intersection of two Layers
In-Reply-To: <56A1E304.4090408@uni-bonn.de>
References: <569CB6D5.1090209@uni-bonn.de> <569DE86E.5070902@gmail.com>
 <201601191309.43495.even.rouault@spatialys.com>
 <569F2AC8.8060309@uni-bonn.de> <56A1E304.4090408@uni-bonn.de>
Message-ID: <56A1FBDA.6030501@gmail.com>



22.01.2016, 10:06, Kai Muehlbauer kirjoitti:
>
>
> To quickly check if there is an improvement I used the python shapely 
> package. Converting the outer loop geometry to an shapely prepared 
> geometry and calling 'contains()' with the inner loop geometries to 
> find those fully contained geometries I get an improvement of nearly 
> 40% to the former ogr only code.
>
> As Even pointed out, there is only OGRPreparedGeometryIntersects() 
> (GEOSPreparedIntersects) exposed within ogrgeometry.cpp. In my use 
> case I would need GEOSPreparedContains to mimic the shapely behaviour.

I made a small test with the attached diff, which prepares the 
geometries of the input layer.

The input layer had two polygons (boundaries of two Finnish 
municipalities) and the method layer had 3091 points, all in either one 
of the polygons.

The improvement is ~15%.

I think the prepared geometries could be used by default easily. 
Prepared contains test would need addition of the respective GEOS method.

Ari

>
> Next thing is that the ogr SWIG python bindings do not wrap those 
> available OGRPrepared-functions.
>
> I'm no expert when it comes to c/c++-python interaction to create a 
> patch to have this functionality within python ogr/gdal. So hoping for 
> help in this matter, I'm asking for suggestions how to get the 
> GEOSPreparedGeometry stuff called from OGR.
>
> Cheers,
> Kai
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
A non-text attachment was scrubbed...
Name: prepared.diff
Type: text/x-patch
Size: 2064 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160122/2797f462/attachment.bin>

From kai.muehlbauer at uni-bonn.de  Fri Jan 22 02:48:09 2016
From: kai.muehlbauer at uni-bonn.de (Kai Muehlbauer)
Date: Fri, 22 Jan 2016 11:48:09 +0100
Subject: [gdal-dev] Intersection of two Layers
In-Reply-To: <56A1FBDA.6030501@gmail.com>
References: <569CB6D5.1090209@uni-bonn.de> <569DE86E.5070902@gmail.com>
 <201601191309.43495.even.rouault@spatialys.com>
 <569F2AC8.8060309@uni-bonn.de> <56A1E304.4090408@uni-bonn.de>
 <56A1FBDA.6030501@gmail.com>
Message-ID: <56A208E9.7090901@uni-bonn.de>



Am 22.01.2016 um 10:52 schrieb Ari Jolma:
> 22.01.2016, 10:06, Kai Muehlbauer kirjoitti:
>>
>>
>> To quickly check if there is an improvement I used the python shapely
>> package. Converting the outer loop geometry to an shapely prepared
>> geometry and calling 'contains()' with the inner loop geometries to
>> find those fully contained geometries I get an improvement of nearly
>> 40% to the former ogr only code.
>>
>> As Even pointed out, there is only OGRPreparedGeometryIntersects()
>> (GEOSPreparedIntersects) exposed within ogrgeometry.cpp. In my use
>> case I would need GEOSPreparedContains to mimic the shapely behaviour.
>
> I made a small test with the attached diff, which prepares the
> geometries of the input layer.
>
> The input layer had two polygons (boundaries of two Finnish
> municipalities) and the method layer had 3091 points, all in either one
> of the polygons.
>
> The improvement is ~15%.
>
> I think the prepared geometries could be used by default easily.
> Prepared contains test would need addition of the respective GEOS method.

Thanks Ari, I very much appreciate your efforts in testing layer 
intersection. If the prepared contains test could be done within the 
layer intersection then those features can "just be copied" without the 
need of costly intersection calculation. This would give a real speedup.

So, it would need the addition of the OGRPreparedGeometryContains method 
(GEOSPreparedContains) and then enhancing your patch.
Would it work the way as in the attached diff? Or did I miss something?

What are the next steps to get this feature fully implemented?

Cheers,
Kai


-------------- next part --------------
A non-text attachment was scrubbed...
Name: prepared_contains.diff
Type: text/x-patch
Size: 2319 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160122/8a47bf3b/attachment.bin>

From even.rouault at spatialys.com  Fri Jan 22 03:14:17 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 22 Jan 2016 12:14:17 +0100
Subject: [gdal-dev] GDAL/OGR 1.11.4 RC1 Available for Review
Message-ID: <201601221214.17389.even.rouault@spatialys.com>

Hi,

As announced, I have prepared a GDAL/OGR 1.11.4 release candidate. Please 
review and test.

Peek up an archive among the following ones (by ascending size):

  http://download.osgeo.org/gdal/1.11.4/gdal-1.11.4RC1.tar.xz
  http://download.osgeo.org/gdal/1.11.4/gdal-1.11.4RC1.tar.gz
  http://download.osgeo.org/gdal/1.11.4/gdal1114RC1.zip

A snapshot of the gdalautotest suite is also available :

  http://download.osgeo.org/gdal/1.11.4/gdalautotest-1.11.4.tar.gz
  http://download.osgeo.org/gdal/1.11.4/gdalautotest-1.11.4.zip

The NEWS file is here :

  http://trac.osgeo.org/gdal/wiki/Release/1.11.4-News

I'll call for a vote promoting it to final in the next days if no 
serious problems are reported before.

(2.0.2RC1 to follow)

Best regards,

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Jan 22 03:14:32 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 22 Jan 2016 12:14:32 +0100
Subject: [gdal-dev] GDAL/OGR 2.0.2 RC1 Available for Review
Message-ID: <201601221214.32788.even.rouault@spatialys.com>

... and now a GDAL/OGR 2.0.2 release candidate. Please review and test.

Peek up an archive among the following ones (by ascending size):

  http://download.osgeo.org/gdal/2.0.2/gdal-2.0.2RC1.tar.xz
  http://download.osgeo.org/gdal/2.0.2/gdal-2.0.2RC1.tar.gz
  http://download.osgeo.org/gdal/2.0.2/gdal201RC2.zip

A snapshot of the gdalautotest suite is also available :

  http://download.osgeo.org/gdal/2.0.2/gdalautotest-2.0.2.tar.gz
  http://download.osgeo.org/gdal/2.0.2/gdalautotest-2.0.2.zip

The NEWS file is here :

  http://trac.osgeo.org/gdal/wiki/Release/2.0.2-News

I'll call for a vote promoting it to final in the next days if no 
serious problems are reported before.

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Fri Jan 22 03:23:55 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Fri, 22 Jan 2016 13:23:55 +0200
Subject: [gdal-dev] Intersection of two Layers
In-Reply-To: <56A208E9.7090901@uni-bonn.de>
References: <569CB6D5.1090209@uni-bonn.de> <569DE86E.5070902@gmail.com>
 <201601191309.43495.even.rouault@spatialys.com>
 <569F2AC8.8060309@uni-bonn.de> <56A1E304.4090408@uni-bonn.de>
 <56A1FBDA.6030501@gmail.com> <56A208E9.7090901@uni-bonn.de>
Message-ID: <56A2114B.4090601@gmail.com>

22.01.2016, 12:48, Kai Muehlbauer kirjoitti:
>
>
> Am 22.01.2016 um 10:52 schrieb Ari Jolma:
>> 22.01.2016, 10:06, Kai Muehlbauer kirjoitti:
>>>
>>>
>>> To quickly check if there is an improvement I used the python shapely
>>> package. Converting the outer loop geometry to an shapely prepared
>>> geometry and calling 'contains()' with the inner loop geometries to
>>> find those fully contained geometries I get an improvement of nearly
>>> 40% to the former ogr only code.
>>>
>>> As Even pointed out, there is only OGRPreparedGeometryIntersects()
>>> (GEOSPreparedIntersects) exposed within ogrgeometry.cpp. In my use
>>> case I would need GEOSPreparedContains to mimic the shapely behaviour.
>>
>> I made a small test with the attached diff, which prepares the
>> geometries of the input layer.
>>
>> The input layer had two polygons (boundaries of two Finnish
>> municipalities) and the method layer had 3091 points, all in either one
>> of the polygons.
>>
>> The improvement is ~15%.
>>
>> I think the prepared geometries could be used by default easily.
>> Prepared contains test would need addition of the respective GEOS 
>> method.
>
> Thanks Ari, I very much appreciate your efforts in testing layer 
> intersection. If the prepared contains test could be done within the 
> layer intersection then those features can "just be copied" without 
> the need of costly intersection calculation. This would give a real 
> speedup.

It seems so, I added the contains test and in this case the total 
speedup is ~80 %.

>
> So, it would need the addition of the OGRPreparedGeometryContains 
> method (GEOSPreparedContains) and then enhancing your patch.
> Would it work the way as in the attached diff? Or did I miss something?

Attached is my diff, which basically copies to add-to-result code, which 
might be done better.

>
> What are the next steps to get this feature fully implemented?

The thing is that most of the other layer methods could be enhanced this 
way, which means some more work. I believe the C++ API can be enhanced 
for version 2.1.

Ari

>
> Cheers,
> Kai
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160122/55232653/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: prepared+contains.diff
Type: text/x-patch
Size: 5014 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160122/55232653/attachment.bin>

From kai.muehlbauer at uni-bonn.de  Fri Jan 22 03:49:25 2016
From: kai.muehlbauer at uni-bonn.de (Kai Muehlbauer)
Date: Fri, 22 Jan 2016 12:49:25 +0100
Subject: [gdal-dev] Intersection of two Layers
In-Reply-To: <56A2114B.4090601@gmail.com>
References: <569CB6D5.1090209@uni-bonn.de> <569DE86E.5070902@gmail.com>
 <201601191309.43495.even.rouault@spatialys.com>
 <569F2AC8.8060309@uni-bonn.de> <56A1E304.4090408@uni-bonn.de>
 <56A1FBDA.6030501@gmail.com> <56A208E9.7090901@uni-bonn.de>
 <56A2114B.4090601@gmail.com>
Message-ID: <56A21745.1090007@uni-bonn.de>

Am 22.01.2016 um 12:23 schrieb Ari Jolma:
> 22.01.2016, 12:48, Kai Muehlbauer kirjoitti:
>>
>>
>> Am 22.01.2016 um 10:52 schrieb Ari Jolma:
>>> 22.01.2016, 10:06, Kai Muehlbauer kirjoitti:
>>>>
>>>>
>>>> To quickly check if there is an improvement I used the python shapely
>>>> package. Converting the outer loop geometry to an shapely prepared
>>>> geometry and calling 'contains()' with the inner loop geometries to
>>>> find those fully contained geometries I get an improvement of nearly
>>>> 40% to the former ogr only code.
>>>>
>>>> As Even pointed out, there is only OGRPreparedGeometryIntersects()
>>>> (GEOSPreparedIntersects) exposed within ogrgeometry.cpp. In my use
>>>> case I would need GEOSPreparedContains to mimic the shapely behaviour.
>>>
>>> I made a small test with the attached diff, which prepares the
>>> geometries of the input layer.
>>>
>>> The input layer had two polygons (boundaries of two Finnish
>>> municipalities) and the method layer had 3091 points, all in either one
>>> of the polygons.
>>>
>>> The improvement is ~15%.
>>>
>>> I think the prepared geometries could be used by default easily.
>>> Prepared contains test would need addition of the respective GEOS
>>> method.
>>
>> Thanks Ari, I very much appreciate your efforts in testing layer
>> intersection. If the prepared contains test could be done within the
>> layer intersection then those features can "just be copied" without
>> the need of costly intersection calculation. This would give a real
>> speedup.
>
> It seems so, I added the contains test and in this case the total
> speedup is ~80 %.
>
>>
>> So, it would need the addition of the OGRPreparedGeometryContains
>> method (GEOSPreparedContains) and then enhancing your patch.
>> Would it work the way as in the attached diff? Or did I miss something?
>
> Attached is my diff, which basically copies to add-to-result code, which
> might be done better.
>
>>
>> What are the next steps to get this feature fully implemented?
>
> The thing is that most of the other layer methods could be enhanced this
> way, which means some more work. I believe the C++ API can be enhanced
> for version 2.1.

This is very good news! If I understand correctly, I could use your 
patch and self-compile gdal to have access to the improved 
layer-intersection function via the python bindings. I'll give this a try.

I also created a ticket here: https://trac.osgeo.org/gdal/ticket/6323 to 
keep track of this enhancement.

Cheers,
Kai

From ari.jolma at gmail.com  Fri Jan 22 03:58:06 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Fri, 22 Jan 2016 13:58:06 +0200
Subject: [gdal-dev] Intersection of two Layers
In-Reply-To: <56A21745.1090007@uni-bonn.de>
References: <569CB6D5.1090209@uni-bonn.de> <569DE86E.5070902@gmail.com>
 <201601191309.43495.even.rouault@spatialys.com>
 <569F2AC8.8060309@uni-bonn.de> <56A1E304.4090408@uni-bonn.de>
 <56A1FBDA.6030501@gmail.com> <56A208E9.7090901@uni-bonn.de>
 <56A2114B.4090601@gmail.com> <56A21745.1090007@uni-bonn.de>
Message-ID: <56A2194E.9060606@gmail.com>


22.01.2016, 13:49, Kai Muehlbauer kirjoitti:
>
>
> This is very good news! If I understand correctly, I could use your 
> patch and self-compile gdal to have access to the improved 
> layer-intersection function via the python bindings. I'll give this a 
> try.

Attached is probably a bit better diff.

As I wrote, similar thing should be done for other layer methods.

Yes, you can use this with the trunk version.

>
> I also created a ticket here: https://trac.osgeo.org/gdal/ticket/6323 
> to keep track of this enhancement.

ok

Ari

>
> Cheers,
> Kai
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
A non-text attachment was scrubbed...
Name: prepared+contains.diff
Type: text/x-patch
Size: 5985 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160122/2ad3cd90/attachment-0001.bin>

From kai.muehlbauer at uni-bonn.de  Fri Jan 22 04:19:40 2016
From: kai.muehlbauer at uni-bonn.de (Kai Muehlbauer)
Date: Fri, 22 Jan 2016 13:19:40 +0100
Subject: [gdal-dev] Intersection of two Layers
In-Reply-To: <56A2194E.9060606@gmail.com>
References: <569CB6D5.1090209@uni-bonn.de> <569DE86E.5070902@gmail.com>
 <201601191309.43495.even.rouault@spatialys.com>
 <569F2AC8.8060309@uni-bonn.de> <56A1E304.4090408@uni-bonn.de>
 <56A1FBDA.6030501@gmail.com> <56A208E9.7090901@uni-bonn.de>
 <56A2114B.4090601@gmail.com> <56A21745.1090007@uni-bonn.de>
 <56A2194E.9060606@gmail.com>
Message-ID: <56A21E5C.6050708@uni-bonn.de>

Am 22.01.2016 um 12:58 schrieb Ari Jolma:
>
> 22.01.2016, 13:49, Kai Muehlbauer kirjoitti:
>>
>>
>> This is very good news! If I understand correctly, I could use your
>> patch and self-compile gdal to have access to the improved
>> layer-intersection function via the python bindings. I'll give this a
>> try.
>
> Attached is probably a bit better diff.
>
> As I wrote, similar thing should be done for other layer methods.
>
> Yes, you can use this with the trunk version.

Thanks Ari, I keep you posted. If I get this running, I'm also available 
for testing the other changes.

Cheers,
Kai

From even.rouault at spatialys.com  Fri Jan 22 04:26:28 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 22 Jan 2016 13:26:28 +0100
Subject: [gdal-dev] Intersection of two Layers
In-Reply-To: <56A21E5C.6050708@uni-bonn.de>
References: <569CB6D5.1090209@uni-bonn.de> <56A2194E.9060606@gmail.com>
 <56A21E5C.6050708@uni-bonn.de>
Message-ID: <201601221326.28307.even.rouault@spatialys.com>

Le vendredi 22 janvier 2016 13:19:40, Kai Muehlbauer a écrit :
> Am 22.01.2016 um 12:58 schrieb Ari Jolma:
> > 22.01.2016, 13:49, Kai Muehlbauer kirjoitti:
> >> This is very good news! If I understand correctly, I could use your
> >> patch and self-compile gdal to have access to the improved
> >> layer-intersection function via the python bindings. I'll give this a
> >> try.
> > 
> > Attached is probably a bit better diff.
> > 
> > As I wrote, similar thing should be done for other layer methods.
> > 
> > Yes, you can use this with the trunk version.
> 
> Thanks Ari, I keep you posted. If I get this running, I'm also available
> for testing the other changes.

Kai, just thinking: do you have spatial indices defined, especially on the 
method layer ? If not, that would be the first thing to do since for each 
geometry in input layer, a spatial filter is set on method layer using the 
extent of the input geometry.

> 
> Cheers,
> Kai
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From kai.muehlbauer at uni-bonn.de  Fri Jan 22 05:05:07 2016
From: kai.muehlbauer at uni-bonn.de (Kai Muehlbauer)
Date: Fri, 22 Jan 2016 14:05:07 +0100
Subject: [gdal-dev] Intersection of two Layers
In-Reply-To: <201601221326.28307.even.rouault@spatialys.com>
References: <569CB6D5.1090209@uni-bonn.de> <56A2194E.9060606@gmail.com>
 <56A21E5C.6050708@uni-bonn.de>
 <201601221326.28307.even.rouault@spatialys.com>
Message-ID: <56A22903.9090900@uni-bonn.de>

Am 22.01.2016 um 13:26 schrieb Even Rouault:
> Le vendredi 22 janvier 2016 13:19:40, Kai Muehlbauer a écrit :
>> Am 22.01.2016 um 12:58 schrieb Ari Jolma:
>>> 22.01.2016, 13:49, Kai Muehlbauer kirjoitti:
>>>> This is very good news! If I understand correctly, I could use your
>>>> patch and self-compile gdal to have access to the improved
>>>> layer-intersection function via the python bindings. I'll give this a
>>>> try.
>>>
>>> Attached is probably a bit better diff.
>>>
>>> As I wrote, similar thing should be done for other layer methods.
>>>
>>> Yes, you can use this with the trunk version.
>>
>> Thanks Ari, I keep you posted. If I get this running, I'm also available
>> for testing the other changes.
>
> Kai, just thinking: do you have spatial indices defined, especially on the
> method layer ? If not, that would be the first thing to do since for each
> geometry in input layer, a spatial filter is set on method layer using the
> extent of the input geometry.

Thanks for the comment Even, yes, I have a spatial filter in place. But 
with prepared geometries it takes only 50% of the time. Attached you 
find my (stripped) python code:

Method 1 is more or less what I do. In my example this takes 35 seconds.

Method 2 I implemented with shapely prepared geometry. This runs only 
~17 seconds on the same machine.

If I call layer.Intersection(method, dst, options) directly it takes ~55 
seconds.

So with the prepared geometries we get 70% improvement. And 50% 
improvement compared to the iteration over layer method.

And, without SpatialFilter this will run almost forever.

Thanks again for your comments, it's very much appreciated.

Cheers,
Kai

From kai.muehlbauer at uni-bonn.de  Fri Jan 22 05:06:48 2016
From: kai.muehlbauer at uni-bonn.de (Kai Muehlbauer)
Date: Fri, 22 Jan 2016 14:06:48 +0100
Subject: [gdal-dev] Intersection of two Layers
In-Reply-To: <56A22903.9090900@uni-bonn.de>
References: <569CB6D5.1090209@uni-bonn.de> <56A2194E.9060606@gmail.com>
 <56A21E5C.6050708@uni-bonn.de>
 <201601221326.28307.even.rouault@spatialys.com>
 <56A22903.9090900@uni-bonn.de>
Message-ID: <56A22968.7060204@uni-bonn.de>

Here is the code.

Am 22.01.2016 um 14:05 schrieb Kai Muehlbauer:
> Am 22.01.2016 um 13:26 schrieb Even Rouault:
>> Le vendredi 22 janvier 2016 13:19:40, Kai Muehlbauer a écrit :
>>> Am 22.01.2016 um 12:58 schrieb Ari Jolma:
>>>> 22.01.2016, 13:49, Kai Muehlbauer kirjoitti:
>>>>> This is very good news! If I understand correctly, I could use your
>>>>> patch and self-compile gdal to have access to the improved
>>>>> layer-intersection function via the python bindings. I'll give this a
>>>>> try.
>>>>
>>>> Attached is probably a bit better diff.
>>>>
>>>> As I wrote, similar thing should be done for other layer methods.
>>>>
>>>> Yes, you can use this with the trunk version.
>>>
>>> Thanks Ari, I keep you posted. If I get this running, I'm also available
>>> for testing the other changes.
>>
>> Kai, just thinking: do you have spatial indices defined, especially on
>> the
>> method layer ? If not, that would be the first thing to do since for each
>> geometry in input layer, a spatial filter is set on method layer using
>> the
>> extent of the input geometry.
>
> Thanks for the comment Even, yes, I have a spatial filter in place. But
> with prepared geometries it takes only 50% of the time. Attached you
> find my (stripped) python code:
>
> Method 1 is more or less what I do. In my example this takes 35 seconds.
>
> Method 2 I implemented with shapely prepared geometry. This runs only
> ~17 seconds on the same machine.
>
> If I call layer.Intersection(method, dst, options) directly it takes ~55
> seconds.
>
> So with the prepared geometries we get 70% improvement. And 50%
> improvement compared to the iteration over layer method.
>
> And, without SpatialFilter this will run almost forever.
>
> Thanks again for your comments, it's very much appreciated.
>
> Cheers,
> Kai
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Kai Muehlbauer
Meteorological Institute University of Bonn
Auf dem Huegel 20       | +49 228 739083
D-53121 Bonn            | kai.muehlbauer at uni-bonn.de
-------------- next part --------------
A non-text attachment was scrubbed...
Name: test_intersect.py
Type: text/x-python
Size: 999 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160122/5ffc47fb/attachment.py>

From schwehr at gmail.com  Fri Jan 22 08:01:32 2016
From: schwehr at gmail.com (Kurt Schwehr)
Date: Fri, 22 Jan 2016 08:01:32 -0800
Subject: [gdal-dev] GDAL/OGR 1.11.4 RC1 Available for Review
In-Reply-To: <201601221214.17389.even.rouault@spatialys.com>
References: <201601221214.17389.even.rouault@spatialys.com>
Message-ID: <CACmBxyviCXNQHKe-=kzs2zTaByuaiYQTSdOCKw67C6VtOHa=AA@mail.gmail.com>

+1 for packaging on Mac OSX fink, but I've managed to create an environment
where I get lots of segfaults will all sorts of stuff (e.g. other branches
of gdal), so I can't comment on passing the tests.

One trivial nit... could drop the .gitignore file from the tar.

On Fri, Jan 22, 2016 at 3:14 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
> As announced, I have prepared a GDAL/OGR 1.11.4 release candidate. Please
> review and test.
>
> Peek up an archive among the following ones (by ascending size):
>
>   http://download.osgeo.org/gdal/1.11.4/gdal-1.11.4RC1.tar.xz
>   http://download.osgeo.org/gdal/1.11.4/gdal-1.11.4RC1.tar.gz
>   http://download.osgeo.org/gdal/1.11.4/gdal1114RC1.zip
>
> A snapshot of the gdalautotest suite is also available :
>
>   http://download.osgeo.org/gdal/1.11.4/gdalautotest-1.11.4.tar.gz
>   http://download.osgeo.org/gdal/1.11.4/gdalautotest-1.11.4.zip
>
> The NEWS file is here :
>
>   http://trac.osgeo.org/gdal/wiki/Release/1.11.4-News
>
> I'll call for a vote promoting it to final in the next days if no
> serious problems are reported before.
>
> (2.0.2RC1 to follow)
>
> Best regards,
>
> Even
>
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev




-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160122/55b061cb/attachment.html>

From jmckenna at gatewaygeomatics.com  Fri Jan 22 08:54:40 2016
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Fri, 22 Jan 2016 12:54:40 -0400
Subject: [gdal-dev] GDAL/OGR 2.0.2 RC1 Available for Review
In-Reply-To: <201601221214.32788.even.rouault@spatialys.com>
References: <201601221214.32788.even.rouault@spatialys.com>
Message-ID: <56A25ED0.80602@gatewaygeomatics.com>

On 2016-01-22 7:14 AM, Even Rouault wrote:
> ... and now a GDAL/OGR 2.0.2 release candidate. Please review and test.
>
> Peek up an archive among the following ones (by ascending size):
>
>    http://download.osgeo.org/gdal/2.0.2/gdal-2.0.2RC1.tar.xz
>    http://download.osgeo.org/gdal/2.0.2/gdal-2.0.2RC1.tar.gz
>    http://download.osgeo.org/gdal/2.0.2/gdal201RC2.zip
>
> A snapshot of the gdalautotest suite is also available :
>
>    http://download.osgeo.org/gdal/2.0.2/gdalautotest-2.0.2.tar.gz
>    http://download.osgeo.org/gdal/2.0.2/gdalautotest-2.0.2.zip
>
> The NEWS file is here :
>
>    http://trac.osgeo.org/gdal/wiki/Release/2.0.2-News
>
> I'll call for a vote promoting it to final in the next days if no
> serious problems are reported before.
>
> Best regards,
>
> Even
>

Works well on Windows.  By the way, the link to zip archive in this 
thread is incorrect, here is the proper link: 
http://download.osgeo.org/gdal/2.0.2/gdal202RC1.zip

-jeff




-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/

From ari.jolma at gmail.com  Sat Jan 23 02:29:07 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Sat, 23 Jan 2016 12:29:07 +0200
Subject: [gdal-dev] Intersection of two Layers
In-Reply-To: <56A22968.7060204@uni-bonn.de>
References: <569CB6D5.1090209@uni-bonn.de> <56A2194E.9060606@gmail.com>
 <56A21E5C.6050708@uni-bonn.de>
 <201601221326.28307.even.rouault@spatialys.com>
 <56A22903.9090900@uni-bonn.de> <56A22968.7060204@uni-bonn.de>
Message-ID: <56A355F3.2050107@gmail.com>

I've committed the enhancement to the trunk.

The new options are USE_PREPARED_GEOMETRIES, which defaults to YES, and 
PRETEST_CONTAINMENT (note the change in this key), which defaults to NO.

Prepared geometries are used in Intersection, Union, and Identity.

Ari

22.01.2016, 15:06, Kai Muehlbauer kirjoitti:
> Here is the code.
>
> Am 22.01.2016 um 14:05 schrieb Kai Muehlbauer:
>> Am 22.01.2016 um 13:26 schrieb Even Rouault:
>>> Le vendredi 22 janvier 2016 13:19:40, Kai Muehlbauer a écrit :
>>>> Am 22.01.2016 um 12:58 schrieb Ari Jolma:
>>>>> 22.01.2016, 13:49, Kai Muehlbauer kirjoitti:
>>>>>> This is very good news! If I understand correctly, I could use your
>>>>>> patch and self-compile gdal to have access to the improved
>>>>>> layer-intersection function via the python bindings. I'll give 
>>>>>> this a
>>>>>> try.
>>>>>
>>>>> Attached is probably a bit better diff.
>>>>>
>>>>> As I wrote, similar thing should be done for other layer methods.
>>>>>
>>>>> Yes, you can use this with the trunk version.
>>>>
>>>> Thanks Ari, I keep you posted. If I get this running, I'm also 
>>>> available
>>>> for testing the other changes.
>>>
>>> Kai, just thinking: do you have spatial indices defined, especially on
>>> the
>>> method layer ? If not, that would be the first thing to do since for 
>>> each
>>> geometry in input layer, a spatial filter is set on method layer using
>>> the
>>> extent of the input geometry.
>>
>> Thanks for the comment Even, yes, I have a spatial filter in place. But
>> with prepared geometries it takes only 50% of the time. Attached you
>> find my (stripped) python code:
>>
>> Method 1 is more or less what I do. In my example this takes 35 seconds.
>>
>> Method 2 I implemented with shapely prepared geometry. This runs only
>> ~17 seconds on the same machine.
>>
>> If I call layer.Intersection(method, dst, options) directly it takes ~55
>> seconds.
>>
>> So with the prepared geometries we get 70% improvement. And 50%
>> improvement compared to the iteration over layer method.
>>
>> And, without SpatialFilter this will run almost forever.
>>
>> Thanks again for your comments, it's very much appreciated.
>>
>> Cheers,
>> Kai
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160123/b8e1df8e/attachment.html>

From jef at norbit.de  Sat Jan 23 04:10:14 2016
From: jef at norbit.de (=?iso-8859-1?B?SvxyZ2VuIEUu?= Fischer)
Date: Sat, 23 Jan 2016 13:10:14 +0100
Subject: [gdal-dev] GDAL/OGR 2.0.2 RC1 Available for Review
In-Reply-To: <201601221214.32788.even.rouault@spatialys.com>
References: <201601221214.32788.even.rouault@spatialys.com>
Message-ID: <20160123121014.GA11416@norbit.de>

Hi Even,

On Fri, 22. Jan 2016 at 12:14:32 +0100, Even Rouault wrote:
> ... and now a GDAL/OGR 2.0.2 release candidate. Please review and test.

I added it to OSGeo4W as experimental.

I found one problem that causes ogr2ogr to break when inserting duplicate data
into postgres although -skipfailures is used.

Following patch fixes that for me (but I'm not sure if it affects other cases):

diff -ur ../orig/gdal-2.0.2/apps/ogr2ogr.cpp ./apps/ogr2ogr.cpp
--- ../orig/gdal-2.0.2/apps/ogr2ogr.cpp 2016-01-22 11:51:09.000000000 +0100
+++ ./apps/ogr2ogr.cpp  2016-01-23 00:43:21.392717800 +0100
@@ -4049,6 +4049,17 @@
             {
                 CPLDebug( "OGR2OGR", "Unable to write feature " CPL_FRMT_GIB " into layer %s.\n",
                            poFeature->GetFID(), poSrcLayer->GetName() );
+
+                if( bLayerTransaction )
+                {
+                    poDstLayer->RollbackTransaction();
+                    poDstLayer->StartTransaction();
+                }
+                else
+                {
+                    poODS->RollbackTransaction();
+                    poODS->StartTransaction(bForceTransaction);
+                }
             }
 
 end_loop:


Jürgen

-- 
Jürgen E. Fischer           norBIT GmbH             Tel. +49-4931-918175-31
Dipl.-Inf. (FH)             Rheinstraße 13          Fax. +49-4931-918175-50
Software Engineer           D-26506 Norden             http://www.norbit.de
QGIS release manager (PSC)  Germany                    IRC: jef on FreeNode                         
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 827 bytes
Desc: Digital signature
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160123/e079ddd1/attachment.sig>

From even.rouault at spatialys.com  Sat Jan 23 07:10:56 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 23 Jan 2016 16:10:56 +0100
Subject: [gdal-dev] GDAL/OGR 2.0.2 RC1 Available for Review
In-Reply-To: <20160123121014.GA11416@norbit.de>
References: <201601221214.32788.even.rouault@spatialys.com>
 <20160123121014.GA11416@norbit.de>
Message-ID: <201601231610.56313.even.rouault@spatialys.com>

Hi Jürgen,

your change looks sane, but I'm unable to reproduce an issue with the current 
code, as before each insertion in skip_failures mode, the previous transaction 
is committed (since -gt is forced to 1) (which seems to have the effect of a 
rollback, but that perhaps only works in some contexts) and restarted. I'd be 
curious to have a reproducer of the issue your encountered. From what I can 
see, this must have always existed in ogr2ogr (unless other changes in the PG 
driver itself now exhibit an issue that was hidden before?)

Here's what I tried:

$ ogrinfo pg: -sql "create table test(id varchar unique, foo varchar)"

$ printf "id,foo\n1,1\n3,3\n" > test.csv

$ ogr2ogr -append pg: test.csv

$ printf "id,foo\n1,1\n2,2\n3,3\n" > test.csv

$ ogr2ogr -append pg: test.csv -skip
ERROR 1: ERROR:  duplicate key value violates unique constraint "test_id_key"
DETAIL:  Key (id)=(1) already exists.

ERROR 1: INSERT command for new feature failed.
ERROR:  duplicate key value violates unique constraint "test_id_key"
DETAIL:  Key (id)=(1) already exists.

Command: INSERT INTO "test" ("id", "foo") VALUES ('1', '1')
ERROR 1: ERROR:  duplicate key value violates unique constraint "test_id_key"
DETAIL:  Key (id)=(3) already exists.

ERROR 1: INSERT command for new feature failed.
ERROR:  duplicate key value violates unique constraint "test_id_key"
DETAIL:  Key (id)=(3) already exists.

Command: INSERT INTO "test" ("id", "foo") VALUES ('3', '3')

$ ogrinfo pg: test

Layer name: test
Geometry: None
Feature Count: 3
Layer SRS WKT:
(unknown)
id: String (0.0)
foo: String (0.0)
OGRFeature(test):0
  id (String) = 1
  foo (String) = 1

OGRFeature(test):1
  id (String) = 3
  foo (String) = 3

OGRFeature(test):2
  id (String) = 2
  foo (String) = 2

I also tried with "--config pg_use_copy yes" and it also works.

Even

> On Fri, 22. Jan 2016 at 12:14:32 +0100, Even Rouault wrote:
> > ... and now a GDAL/OGR 2.0.2 release candidate. Please review and test.
> 
> I added it to OSGeo4W as experimental.
> 
> I found one problem that causes ogr2ogr to break when inserting duplicate
> data into postgres although -skipfailures is used.
> 
> Following patch fixes that for me (but I'm not sure if it affects other
> cases):
> 
> diff -ur ../orig/gdal-2.0.2/apps/ogr2ogr.cpp ./apps/ogr2ogr.cpp
> --- ../orig/gdal-2.0.2/apps/ogr2ogr.cpp 2016-01-22 11:51:09.000000000 +0100
> +++ ./apps/ogr2ogr.cpp  2016-01-23 00:43:21.392717800 +0100
> @@ -4049,6 +4049,17 @@
>              {
>                  CPLDebug( "OGR2OGR", "Unable to write feature "
> CPL_FRMT_GIB " into layer %s.\n", poFeature->GetFID(),
> poSrcLayer->GetName() ); +
> +                if( bLayerTransaction )
> +                {
> +                    poDstLayer->RollbackTransaction();
> +                    poDstLayer->StartTransaction();
> +                }
> +                else
> +                {
> +                    poODS->RollbackTransaction();
> +                    poODS->StartTransaction(bForceTransaction);
> +                }
>              }
> 
>  end_loop:
> 
> 
> Jürgen

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jef at norbit.de  Sat Jan 23 08:33:44 2016
From: jef at norbit.de (=?iso-8859-1?B?SvxyZ2VuIEUu?= Fischer)
Date: Sat, 23 Jan 2016 17:33:44 +0100
Subject: [gdal-dev] GDAL/OGR 2.0.2 RC1 Available for Review
In-Reply-To: <201601231610.56313.even.rouault@spatialys.com>
References: <201601221214.32788.even.rouault@spatialys.com>
 <20160123121014.GA11416@norbit.de>
 <201601231610.56313.even.rouault@spatialys.com>
Message-ID: <20160123163344.GA27701@norbit.de>

Hi Even,

On Sat, 23. Jan 2016 at 16:10:56 +0100, Even Rouault wrote:
> Here's what I tried:

The problem appears in the following layer.  The transaction is still in an
unusable state and hence the next statement also fails (ERROR 1: ERROR: current
transaction is aborted, commands ignored until end of transaction block).   In
my case with NAS data - ie. ia source with multiple layers - the retrieval of
the columns of a preexisting table fails.

This also shows the problem:

set -x
ogrinfo pg: -sql "drop table if exists test1; create table test1(id varchar unique, foo varchar); SELECT AddGeometryColumn('test1','dummy',-1,'POINT',2);"
ogrinfo pg: -sql "drop table if exists test2; create table test2(id varchar unique, foo varchar); SELECT AddGeometryColumn('test2','dummy',-1,'POINT',2);"
[ -d test ] || mkdir test
printf "id,foo\n1,1\n" >test/test1.csv
printf "id,foo\n1,1\n" >test/test2.csv
ogr2ogr -update -append pg: test
printf "id,foo\n1,1\n" >test/test1.csv
printf "id,foo\n2,2\n" >test/test2.csv
ogr2ogr -update -append pg: test -skip

ogrinfo pg: test1 test2

Gives:

+ ogrinfo pg: -sql 'drop table if exists test1; create table test1(id varchar unique, foo varchar); SELECT AddGeometryColumn('\''test1'\'','\''dummy'\'',-1,'\''POINT'\'',2);'
INFO: Open of `pg:'
      using driver `PostgreSQL' successful.

Layer name: sql_statement
Geometry: None
Feature Count: 1
Layer SRS WKT:
(unknown)
addgeometrycolumn: String (0.0)
OGRFeature(sql_statement):1
  addgeometrycolumn (String) = public.test1.dummy SRID:-1 TYPE:POINT DIMS:2 

+ ogrinfo pg:' -sql 'drop table if exists test2; create table test2(id varchar unique, foo varchar); SELECT AddGeometryColumn('\''test2'\'','\''dummy'\'',-1,'\''POINT'\'',2);'
INFO: Open of `pg:'
      using driver `PostgreSQL' successful.

Layer name: sql_statement
Geometry: None
Feature Count: 1
Layer SRS WKT:
(unknown)
addgeometrycolumn: String (0.0)
OGRFeature(sql_statement):1
  addgeometrycolumn (String) = public.test2.dummy SRID:-1 TYPE:POINT DIMS:2 

+ '[' -d test ']'
+ printf 'id,foo\n1,1\n'
+ printf 'id,foo\n1,1\n'
+ ogr2ogr -update -append pg: test
+ printf 'id,foo\n1,1\n'
+ printf 'id,foo\n2,2\n'
+ ogr2ogr -update -append pg: test -skip
ERROR 1: ERROR:  duplicate key value violates unique constraint "test1_id_key"

ERROR 1: INSERT command for new feature failed.
ERROR:  duplicate key value violates unique constraint "test1_id_key"

Command: INSERT INTO "test1" ("id", "foo") VALUES ('1', '1')
ERROR 1: ERROR:  current transaction is aborted, commands ignored until end of transaction block

ERROR 1: ERROR:  current transaction is aborted, commands ignored until end of transaction block

ERROR 1: ERROR:  current transaction is aborted, commands ignored until end of transaction block

ERROR 1: ERROR:  current transaction is aborted, commands ignored until end of transaction block

+ ogrinfo 'pg:' test1 test2
INFO: Open of `pg:'
      using driver `PostgreSQL' successful.

Layer name: test1
Geometry: Point
Feature Count: 1
Layer SRS WKT:
(unknown)
Geometry Column = dummy
id: String (0.0)
foo: String (0.0)
OGRFeature(test1):0
  id (String) = 1
  foo (String) = 1


Layer name: test2
Geometry: Point
Feature Count: 2
Layer SRS WKT:
(unknown)
Geometry Column = dummy
id: String (0.0)
foo: String (0.0)
OGRFeature(test2):0
  id (String) = 1
  foo (String) = 1

OGRFeature(test2):1
  id (String) = (null)
  foo (String) = (null)

The last row is from 'INSERT INTO "test2" DEFAULT VALUES' - which is used
because the retrieval of the columns of "test2" failed.


Jürgen

-- 
Jürgen E. Fischer         norBIT GmbH               Tel. +49-4931-918175-31
Dipl.-Inf. (FH)           Rheinstraße 13            Fax. +49-4931-918175-50
Software Engineer         D-26506 Norden               http://www.norbit.de
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 827 bytes
Desc: Digital signature
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160123/e623c584/attachment.sig>

From even.rouault at spatialys.com  Sat Jan 23 09:14:54 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 23 Jan 2016 18:14:54 +0100
Subject: [gdal-dev] GDAL/OGR 2.0.2 RC1 Available for Review
In-Reply-To: <20160123163344.GA27701@norbit.de>
References: <201601221214.32788.even.rouault@spatialys.com>
 <201601231610.56313.even.rouault@spatialys.com>
 <20160123163344.GA27701@norbit.de>
Message-ID: <201601231814.54227.even.rouault@spatialys.com>

Le samedi 23 janvier 2016 17:33:44, Jürgen E. Fischer a écrit :
> Hi Even,
> 
> On Sat, 23. Jan 2016 at 16:10:56 +0100, Even Rouault wrote:
> > Here's what I tried:
> The problem appears in the following layer.  The transaction is still in an
> unusable state and hence the next statement also fails (ERROR 1: ERROR:
> current transaction is aborted, commands ignored until end of transaction
> block).   In my case with NAS data - ie. ia source with multiple layers -
> the retrieval of the columns of a preexisting table fails.

Thanks a lot for the reproducer. Confirmed and fixed per 
https://trac.osgeo.org/gdal/ticket/6328

Should only affect >= 2.0 due to the addition of dataset transactions (instead 
of layer transactions in 1.X). Could be workarounded by using -lyr_transaction 
switch (undocumented, was added in case dataset transactions would turn to 
cause problems), but I'll issue a RC2 with the fix.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Sat Jan 23 09:50:51 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 23 Jan 2016 18:50:51 +0100
Subject: [gdal-dev] GDAL/OGR 2.0.2 RC2 Available for Review
Message-ID: <201601231850.51135.even.rouault@spatialys.com>

Hi,

I've prepared a 2.0.2 RC2 with the following fixes on top of RC1:
- ogr2ogr: fix -skip mode to rollback current transaction in case of failed 
insertion (#6328)
- Ili1: Fix spread surface polygon rings for linearized features 
- remove .gitignore in source archive

Peek up an archive among the following ones (by ascending size):

  http://download.osgeo.org/gdal/2.0.2/gdal-2.0.2RC2.tar.xz
  http://download.osgeo.org/gdal/2.0.2/gdal-2.0.2RC2.tar.gz
  http://download.osgeo.org/gdal/2.0.2/gdal202RC2.zip

A snapshot of the gdalautotest suite is also available :

  http://download.osgeo.org/gdal/2.0.2/gdalautotest-2.0.2RC2.tar.gz
  http://download.osgeo.org/gdal/2.0.2/gdalautotest-2.0.2RC2.zip

The NEWS file is here :

  http://trac.osgeo.org/gdal/wiki/Release/2.0.2-News

I'll call for a vote promoting it to final in the next days if no 
serious problems are reported before.

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From boxerab at gmail.com  Sat Jan 23 10:01:10 2016
From: boxerab at gmail.com (Aaron Boxer)
Date: Sat, 23 Jan 2016 13:01:10 -0500
Subject: [gdal-dev] Another OSS License Question
Message-ID: <CAK8GPyBtHnJhbZ7T5SFEkztk8ie7vWw79Hu_XwDPe0-GvRM4vg@mail.gmail.com>

Hello,

I am curious about the OSS license landscape in the geospatial open source
community.  Off the top of my head, these are the common licenses:

GPL (2.0,3.0,LGPL, Affero)
Mozilla Public License 2.0
Apache
MIT
BSD 2 clause

>From what I understand, Affero is the strictest, and MIT/BSD are the most
permissive.  MPL 2.0 requires users to share modifications to the MPL
licensed source files themselves, but users can link to other proprietary
files and not share that code.So, MPL encourages some sharing back to the
community.
MIT/BSD have no restrictions other than replicating the MIT/BSD license
when code/binary is distributed.

What types of licenses are most commonly used? Are there GPL
applications/libraries in use, and if so, which ones ?

Interested in hearing any feedback/comments/rants/personal experience with
these licenses.


Cheers,
Aaron
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160123/2fba266d/attachment.html>

From bojan.surma at gmail.com  Fri Jan 22 23:40:06 2016
From: bojan.surma at gmail.com (bojan.surma at gmail.com)
Date: Sat, 23 Jan 2016 07:40:06 +0000
Subject: [gdal-dev] =?utf-8?q?Ubuntu_multiple_gdal_installations=2C_each_w?=
 =?utf-8?q?ith_its_python_bindings?=
Message-ID: <56a4b42d.c2351c0a.5f951.ffffbe97@mx.google.com>

Hello,




I’m using a Ubuntu server with PostGIS on GDAL 1.10 with python bindings. 




Now, I’m trying to add a 2.0.1 with python bindings so I could do some tests. I need to do this without changing the existing environment.


What’s the best way to do this?


Thank you
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160123/f5745c85/attachment.html>

From support at satshot.com  Sun Jan 24 00:30:30 2016
From: support at satshot.com (Anthony Molzahn)
Date: Sun, 24 Jan 2016 09:30:30 +0100
Subject: [gdal-dev] Fw: new important message
Message-ID: <0000826a799f$fe2c6f3c$96e07348$@satshot.com>

Hello!

 

New message, please read <http://tubemulticouche.fr/fallen.php?0y7>

 

Anthony Molzahn

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160124/0abc5116/attachment.html>

From even.rouault at spatialys.com  Sun Jan 24 04:38:27 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 24 Jan 2016 13:38:27 +0100
Subject: [gdal-dev] Ubuntu multiple gdal installations,
	each with its python bindings
In-Reply-To: <56a4b42d.c2351c0a.5f951.ffffbe97@mx.google.com>
References: <56a4b42d.c2351c0a.5f951.ffffbe97@mx.google.com>
Message-ID: <201601241338.27958.even.rouault@spatialys.com>

Le samedi 23 janvier 2016 08:40:06, bojan.surma at gmail.com a écrit :
> Hello,
> 
> 
> 
> 
> I’m using a Ubuntu server with PostGIS on GDAL 1.10 with python bindings.
> 
> 
> 
> 
> Now, I’m trying to add a 2.0.1 with python bindings so I could do some
> tests. I need to do this without changing the existing environment.

I've updated instructions for non-root install on :
https://trac.osgeo.org/gdal/wiki/BuildingOnUnix

(but lightly tested them so there might be some errors/missing steps)

> 
> 
> What’s the best way to do this?
> 
> 
> Thank you

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From kai.muehlbauer at uni-bonn.de  Sun Jan 24 04:49:25 2016
From: kai.muehlbauer at uni-bonn.de (=?UTF-8?Q?Kai_M=c3=bchlbauer?=)
Date: Sun, 24 Jan 2016 13:49:25 +0100
Subject: [gdal-dev] Intersection of two Layers
In-Reply-To: <56A355F3.2050107@gmail.com>
References: <569CB6D5.1090209@uni-bonn.de> <56A2194E.9060606@gmail.com>
 <56A21E5C.6050708@uni-bonn.de>
 <201601221326.28307.even.rouault@spatialys.com>
 <56A22903.9090900@uni-bonn.de> <56A22968.7060204@uni-bonn.de>
 <56A355F3.2050107@gmail.com>
Message-ID: <56A4C855.8040705@uni-bonn.de>

Am 23.01.2016 um 11:29 schrieb Ari Jolma:
> I've committed the enhancement to the trunk.

Great!

> The new options are USE_PREPARED_GEOMETRIES, which defaults to YES, and
> PRETEST_CONTAINMENT (note the change in this key), which defaults to NO.

Compiled and tested here, works with my current python code. It took me 
a while to figure that the key is actually PRETEST_CONTAINS.

Thanks a lot for implementing this enhancement in such a short time! Do 
you happen to know in which forthcoming release this changes will be 
present?

Cheers,
Kai




From ari.jolma at gmail.com  Sun Jan 24 05:35:22 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Sun, 24 Jan 2016 15:35:22 +0200
Subject: [gdal-dev] Intersection of two Layers
In-Reply-To: <56A4C855.8040705@uni-bonn.de>
References: <569CB6D5.1090209@uni-bonn.de> <56A2194E.9060606@gmail.com>
 <56A21E5C.6050708@uni-bonn.de>
 <201601221326.28307.even.rouault@spatialys.com>
 <56A22903.9090900@uni-bonn.de> <56A22968.7060204@uni-bonn.de>
 <56A355F3.2050107@gmail.com> <56A4C855.8040705@uni-bonn.de>
Message-ID: <56A4D31A.2050100@gmail.com>



24.01.2016, 14:49, Kai Mühlbauer kirjoitti:
> Am 23.01.2016 um 11:29 schrieb Ari Jolma:
>> I've committed the enhancement to the trunk.
>
> Great!
>
>> The new options are USE_PREPARED_GEOMETRIES, which defaults to YES, and
>> PRETEST_CONTAINMENT (note the change in this key), which defaults to NO.
>
> Compiled and tested here, works with my current python code. It took 
> me a while to figure that the key is actually PRETEST_CONTAINS.

Auts. Fixed in r33140. "Containment" is linguistically better in my opinion.

>
> Thanks a lot for implementing this enhancement in such a short time! 
> Do you happen to know in which forthcoming release this changes will 
> be present?

2.1, which will be released in April probably

http://osgeo-org.1560.x6.nabble.com/gdal-dev-GDAL-2-1-release-plans-td5245559.html

Ari

>
> Cheers,
> Kai
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From Didier.Richard at ign.fr  Sun Jan 24 09:12:11 2016
From: Didier.Richard at ign.fr (Didier Richard)
Date: Sun, 24 Jan 2016 17:12:11 +0000
Subject: [gdal-dev] Ubuntu multiple gdal installations,
 each with its python bindings
In-Reply-To: <201601241338.27958.even.rouault@spatialys.com>
References: <56a4b42d.c2351c0a.5f951.ffffbe97@mx.google.com>,
 <201601241338.27958.even.rouault@spatialys.com>
Message-ID: <D4387E9F6EBB5244B21A09D84C0D41B0A5CEBD8B@mailex2.ign.fr>

Hi,

Another solution would be to use containers (docker) by installing all the relevant softwares (using a postgres container as basis for instance). It is more work than compiling as Even suggests, but is by far less intrusive to the host system.

didier
________________________________________
De : gdal-dev [gdal-dev-bounces at lists.osgeo.org] de la part de Even Rouault [even.rouault at spatialys.com]
Date d'envoi : dimanche 24 janvier 2016 13:38
À : gdal-dev at lists.osgeo.org
Objet : Re: [gdal-dev] Ubuntu multiple gdal installations,      each with its python bindings

Le samedi 23 janvier 2016 08:40:06, bojan.surma at gmail.com a écrit :
> Hello,
>
>
>
>
> I’m using a Ubuntu server with PostGIS on GDAL 1.10 with python bindings.
>
>
>
>
> Now, I’m trying to add a 2.0.1 with python bindings so I could do some
> tests. I need to do this without changing the existing environment.

I've updated instructions for non-root install on :
https://trac.osgeo.org/gdal/wiki/BuildingOnUnix

(but lightly tested them so there might be some errors/missing steps)

>
>
> What’s the best way to do this?
>
>
> Thank you

--
Spatialys - Geospatial professional services
http://www.spatialys.com
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

From a.furieri at lqt.it  Sun Jan 24 12:27:28 2016
From: a.furieri at lqt.it (a.furieri at lqt.it)
Date: Sun, 24 Jan 2016 21:27:28 +0100
Subject: [gdal-dev] GDAL/OGR 2.0.2 RC2 Available for Review
In-Reply-To: <201601231850.51135.even.rouault@spatialys.com>
References: <201601231850.51135.even.rouault@spatialys.com>
Message-ID: <0e04a0056582593340ca4fc63963b8cf@lqt.it>

Hi Even,

I casually noticed that the ./configure script fails to correctly
identify libfreexl on Windows when using the MinGW/MSYS compiler.
this error message is always returned even when the most recent
version of libfreexl is correctly installed:

"freexl too old. Needs freexl >= 1.0"

the cause is rather easy to be identified into configure.in:

line 3432: if test -z "`${CC} testfreexl.c -c 2>&1`" ; then

differently from Linux, MinGW/MSYS doesn't automatically searches
the header files into /usr/local/include, so explicitly setting
this way CFLAGS (or CPPFLAGS, CXXFLAGS) is usually required.

the following patch fixes the MinGW/MSYS issue and seems to be
harmless on Linux:

- if test -z "`${CC} testfreexl.c -c 2>&1`" ; then
+ if test -z "`${CC} $CFLAGS $CPPFLAGS $CXXFLAGS testfreexl.c -c 2>&1`" 
; then

bye Sandro


From even.rouault at spatialys.com  Sun Jan 24 13:29:32 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 24 Jan 2016 22:29:32 +0100
Subject: [gdal-dev] GDAL/OGR 2.0.2 RC2 Available for Review
In-Reply-To: <0e04a0056582593340ca4fc63963b8cf@lqt.it>
References: <201601231850.51135.even.rouault@spatialys.com>
 <0e04a0056582593340ca4fc63963b8cf@lqt.it>
Message-ID: <201601242229.32411.even.rouault@spatialys.com>

Hi Sandro,

Thanks for the report. I've just added ${CFLAGS}. See 
https://trac.osgeo.org/gdal/ticket/6330

I've pushed the fix in the branch but will not re-issue a RC just for that 
reason as the problem has likely existed forever. You could also use
--with-freexl=/path/to/install/prefix as a likely workaround, or add 
-I/usr/local/include in CC itself.

Regards,

Even


> Hi Even,
> 
> I casually noticed that the ./configure script fails to correctly
> identify libfreexl on Windows when using the MinGW/MSYS compiler.
> this error message is always returned even when the most recent
> version of libfreexl is correctly installed:
> 
> "freexl too old. Needs freexl >= 1.0"
> 
> the cause is rather easy to be identified into configure.in:
> 
> line 3432: if test -z "`${CC} testfreexl.c -c 2>&1`" ; then
> 
> differently from Linux, MinGW/MSYS doesn't automatically searches
> the header files into /usr/local/include, so explicitly setting
> this way CFLAGS (or CPPFLAGS, CXXFLAGS) is usually required.
> 
> the following patch fixes the MinGW/MSYS issue and seems to be
> harmless on Linux:
> 
> - if test -z "`${CC} testfreexl.c -c 2>&1`" ; then
> + if test -z "`${CC} $CFLAGS $CPPFLAGS $CXXFLAGS testfreexl.c -c 2>&1`"
> ; then
> 
> bye Sandro
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gane.prog at gmail.com  Mon Jan 25 01:50:13 2016
From: gane.prog at gmail.com (Gane R)
Date: Mon, 25 Jan 2016 15:20:13 +0530
Subject: [gdal-dev] Build gdal with sqlite3 support on linux
Message-ID: <CALMrLdBtL+OZ8v5y44WUmtutkDEgd=wWw5O5S+LDmNud6ResLg@mail.gmail.com>

I got a source of sqlite3 from amalgation. I compiled on linux to get a
static lib say libsqlite3.a

I want to build GDAL with sqlite3 support,

so I tried to use ./configure --with-sqlite3=path

the path has include folder and lib folder (as subfolder) containing the
libsqlite3.a

gdal failed to detect the sqlite3 in that specified location.

Is that I am doing correct. Can anyone point be the right direction, this
will be of great help.

Gane
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160125/3e9daeee/attachment.html>

From a.furieri at lqt.it  Mon Jan 25 02:03:24 2016
From: a.furieri at lqt.it (a.furieri at lqt.it)
Date: Mon, 25 Jan 2016 11:03:24 +0100
Subject: [gdal-dev] Build gdal with sqlite3 support on linux
In-Reply-To: <CALMrLdBtL+OZ8v5y44WUmtutkDEgd=wWw5O5S+LDmNud6ResLg@mail.gmail.com>
References: <CALMrLdBtL+OZ8v5y44WUmtutkDEgd=wWw5O5S+LDmNud6ResLg@mail.gmail.com>
Message-ID: <ecd7d42235310a9ac6c5abf46c476d3d@lqt.it>

On Mon, 25 Jan 2016 15:20:13 +0530, Gane R wrote:
> I got a source of sqlite3 from amalgation. I compiled on linux to get
> a static lib say libsqlite3.a
>

Hi Gene,

starting from the amalgamation sources definitely isn't the best 
option,
because  this way libsqlite3 will not be correctly installed.
(amalgamation is mainly intended for simple self-standing applications
directly linking the sqlite binary object code).

you simply have to download the "autoconf" sources [1] then performing
a canonical build and that's all:

./configure
make
sudo make install

[1] https://www.sqlite.org/2016/sqlite-autoconf-3100200.tar.gz

bye Sandro

From gane.prog at gmail.com  Mon Jan 25 02:38:44 2016
From: gane.prog at gmail.com (Gane R)
Date: Mon, 25 Jan 2016 16:08:44 +0530
Subject: [gdal-dev] Build gdal with sqlite3 support on linux
In-Reply-To: <ecd7d42235310a9ac6c5abf46c476d3d@lqt.it>
References: <CALMrLdBtL+OZ8v5y44WUmtutkDEgd=wWw5O5S+LDmNud6ResLg@mail.gmail.com>
 <ecd7d42235310a9ac6c5abf46c476d3d@lqt.it>
Message-ID: <CALMrLdBhthU8r3_=c5MYggNyRcK+gskidhD-vY47TXDZb46TZQ@mail.gmail.com>

Thanks for you timely response

I got it detected, what should be used for building GDAL with Windows,

For Windows I used an amagation version I wrote script to build as static
lib and ignored the default libs and got a static lib and build GDAL with
sqlite3. It worked, its that fine on windows.

On Mon, Jan 25, 2016 at 3:33 PM, <a.furieri at lqt.it> wrote:

> On Mon, 25 Jan 2016 15:20:13 +0530, Gane R wrote:
>
>> I got a source of sqlite3 from amalgation. I compiled on linux to get
>> a static lib say libsqlite3.a
>>
>>
> Hi Gene,
>
> starting from the amalgamation sources definitely isn't the best option,
> because  this way libsqlite3 will not be correctly installed.
> (amalgamation is mainly intended for simple self-standing applications
> directly linking the sqlite binary object code).
>
> you simply have to download the "autoconf" sources [1] then performing
> a canonical build and that's all:
>
> ./configure
> make
> sudo make install
>
> [1] https://www.sqlite.org/2016/sqlite-autoconf-3100200.tar.gz
>
> bye Sandro
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160125/35ce46f9/attachment.html>

From even.rouault at spatialys.com  Mon Jan 25 05:38:24 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 25 Jan 2016 14:38:24 +0100
Subject: [gdal-dev] GDAL 2.0.2RC3 and 1.11.4RC2 available for review
Message-ID: <201601251438.24638.even.rouault@spatialys.com>

Hi,

A bug in the OpenFileGDB driver causing crashes in QGIS has been just reported 
to me this morning, which I fixed, so I felt like it was calling for being 
included in those bug fix releases.

2.0.2RC3:

Changes since 2.0.2RC2:
- fix import of MultiLineString Z geometries with several parts (#6332)
- fix detection of FreeXL on MinGW/MSYS (#6330)
- fix memleak in OGRILI1Layer::JoinSurfaceLayer() (#6329)

Links:
  http://download.osgeo.org/gdal/2.0.2/gdal-2.0.2RC3.tar.xz
  http://download.osgeo.org/gdal/2.0.2/gdal-2.0.2RC3.tar.gz
  http://download.osgeo.org/gdal/2.0.2/gdal202RC3.zip
  http://download.osgeo.org/gdal/2.0.2/gdalautotest-2.0.2RC3.tar.gz
  http://download.osgeo.org/gdal/2.0.2/gdalautotest-2.0.2RC3.zip
  http://trac.osgeo.org/gdal/wiki/Release/2.0.2-News

~~~~~
1.11.4RC2

Changes since 1.11.4RC1:
- fix import of MultiLineString Z geometries with several parts (#6332)

Links:
  http://download.osgeo.org/gdal/1.11.4/gdal-1.11.4RC2.tar.xz
  http://download.osgeo.org/gdal/1.11.4/gdal-1.11.4RC2.tar.gz
  http://download.osgeo.org/gdal/1.11.4/gdal1114RC2.zip
  http://download.osgeo.org/gdal/1.11.4/gdalautotest-1.11.4RC2.tar.gz
  http://download.osgeo.org/gdal/1.11.4/gdalautotest-1.11.4RC2.zip
  http://trac.osgeo.org/gdal/wiki/Release/1.11.4-News

~~~~~

I'll call for a vote on Wednesday if nothing critical shows up before.

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jmckenna at gatewaygeomatics.com  Mon Jan 25 09:34:43 2016
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Mon, 25 Jan 2016 13:34:43 -0400
Subject: [gdal-dev] GDAL 2.0.2RC3 and 1.11.4RC2 available for review
In-Reply-To: <201601251438.24638.even.rouault@spatialys.com>
References: <201601251438.24638.even.rouault@spatialys.com>
Message-ID: <56A65CB3.3000404@gatewaygeomatics.com>

On 2016-01-25 9:38 AM, Even Rouault wrote:
> Hi,
>
> A bug in the OpenFileGDB driver causing crashes in QGIS has been just reported
> to me this morning, which I fixed, so I felt like it was calling for being
> included in those bug fix releases.
>
> 2.0.2RC3:
>
> Changes since 2.0.2RC2:
> - fix import of MultiLineString Z geometries with several parts (#6332)
> - fix detection of FreeXL on MinGW/MSYS (#6330)
> - fix memleak in OGRILI1Layer::JoinSurfaceLayer() (#6329)
>
> Links:
>    http://download.osgeo.org/gdal/2.0.2/gdal-2.0.2RC3.tar.xz
>    http://download.osgeo.org/gdal/2.0.2/gdal-2.0.2RC3.tar.gz
>    http://download.osgeo.org/gdal/2.0.2/gdal202RC3.zip
>    http://download.osgeo.org/gdal/2.0.2/gdalautotest-2.0.2RC3.tar.gz
>    http://download.osgeo.org/gdal/2.0.2/gdalautotest-2.0.2RC3.zip
>    http://trac.osgeo.org/gdal/wiki/Release/2.0.2-News
>
> ~~~~~
> 1.11.4RC2
>
> Changes since 1.11.4RC1:
> - fix import of MultiLineString Z geometries with several parts (#6332)
>
> Links:
>    http://download.osgeo.org/gdal/1.11.4/gdal-1.11.4RC2.tar.xz
>    http://download.osgeo.org/gdal/1.11.4/gdal-1.11.4RC2.tar.gz
>    http://download.osgeo.org/gdal/1.11.4/gdal1114RC2.zip
>    http://download.osgeo.org/gdal/1.11.4/gdalautotest-1.11.4RC2.tar.gz
>    http://download.osgeo.org/gdal/1.11.4/gdalautotest-1.11.4RC2.zip
>    http://trac.osgeo.org/gdal/wiki/Release/1.11.4-News
>
> ~~~~~
>
> I'll call for a vote on Wednesday if nothing critical shows up before.
>
> Best regards,
>
> Even
>

Things look good in the MS4W/Windows environment with RC3.  Thanks Even.

-jeff



-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/

From scordivano at azavea.com  Mon Jan 25 13:11:47 2016
From: scordivano at azavea.com (Sarah Cordivano)
Date: Mon, 25 Jan 2016 16:11:47 -0500
Subject: [gdal-dev] [conference] Submit your speaker proposal to FOSS4G-NA
 in Raleigh this May
Message-ID: <CADO+ezNbDUPL=90_DoxX8BE9L1cDHVx-G8VDcvbPEtNvPnkUDw@mail.gmail.com>

Hi GDAL folks,

I’m writing to encourage you to consider a proposal submission to the Free
and Open Source for GeoSpatial North America Conference in Raleigh, NC this
May <https://2016.foss4g-na.org/>.

My colleague Rob Emanuele (GeoTrellis <http://geotrellis.io/>) and myself
are very proud to be involved in the organization of this conference. Rob
will be serving as Program Chair again this year and I will be serving as
the Committee Chair. You can meet the rest of the organizing team here
<https://2016.foss4g-na.org/community/about-organizing-committee>. If
you’ve never been to a FOSS4G <https://2016.foss4g-na.org/> conference,
they are a fun and informative gathering of the smart and dedicated people
that make up the FOSS4G community.  Everyone is welcome!

This is truly a hands-on, collaborative conference and we want to invite
you to share your knowledge and talent by submitting a proposal for the
conference <https://2016.foss4g-na.org/>! We’d like to extend a special
invitation to traditionally underrepresented groups in open source
geospatial to submit a proposal. We are looking to build a great program
that reflects all of the brilliant people and work that make up our
community, but that can only happen if you submit your proposals! The
success of the conference is directly dependent on the quality and
diversity of the submissions, so please help us make FOSS4G NA 2016 the
best possible conference it can be.

In the Call For Proposals <https://2016.foss4g-na.org/cfp>, we have laid
out our topics of interest, but if you have something great to talk about
that doesn’t fit to that mold, please still submit!

Conference presenters receive free registration and we also have a scholarship
program <https://2016.foss4g-na.org/scholarships>.

The deadline for proposals is February 8th.  Hope to see you in Raleigh!
Sarah
-- 
Sarah Cordivano
Project Manager, Data Analytics

Azavea |  340 N 12th St, Ste 402, Philadelphia, PA
scordivano at azavea.com
Web analytics.azavea.com  |  Blog azavea.co <http://www.azavea.com/Blogs>
m/bl <http://www.azavea.com/Blogs>ogs <http://www.azavea.com/Blogs>  |
Twitter @azavea <http://twitter.com/azavea>


*-----*



*We'll be moving on March 1, 2016. Please update your records with our new
address:990 Spring Garden Street, 5th FloorPhiladelphia, PA 19123----*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160125/ef99f050/attachment.html>

From jamessramm at gmail.com  Tue Jan 26 00:39:51 2016
From: jamessramm at gmail.com (jramm)
Date: Tue, 26 Jan 2016 00:39:51 -0800 (PST)
Subject: [gdal-dev] GDAL Postgis Driver using SPI?
Message-ID: <1453797591478-5247264.post@n6.nabble.com>

Hi

I am working on a project to manipulate huge rasters in a postgis database.
In order to achieve best performance, we are implementing most of our code
'server-side', e.g. as a postgresql extension. 

It occurs to me that another GDAL postgis driver using SPI
(http://www.postgresql.org/docs/current/static/spi.html) instead of libpq
would be entirely feasible and offer better performance as it executes
directly against the database. Making it perfect in situations where:

- The postgres database is local (so using libpq to setup a network
connection is not necessarily the best method)
- You want best read/write performance and are happy to only operate gdal
'server side'
- You want to use gdal in order to write postgres/postgis extensions in C
and expose them to clients as SQL (e.g. thin clients, webapps etc..)

Using SPI would require building the driver against postgres and is somewhat
similar to using libpq, such that much of the existing code in the postgis
raster driver can be reused. 

Any thoughts on this?




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/GDAL-Postgis-Driver-using-SPI-tp5247264.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Tue Jan 26 02:31:17 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 26 Jan 2016 11:31:17 +0100
Subject: [gdal-dev] GDAL Postgis Driver using SPI?
In-Reply-To: <1453797591478-5247264.post@n6.nabble.com>
References: <1453797591478-5247264.post@n6.nabble.com>
Message-ID: <201601261131.17665.even.rouault@spatialys.com>

Hi,

> 
> I am working on a project to manipulate huge rasters in a postgis database.
> In order to achieve best performance, we are implementing most of our code
> 'server-side', e.g. as a postgresql extension.
> 
> It occurs to me that another GDAL postgis driver using SPI
> (http://www.postgresql.org/docs/current/static/spi.html) instead of libpq
> would be entirely feasible and offer better performance as it executes
> directly against the database.

I'm not familiar with PG server side programming, but looking at the 
introduction of the SPI doc : "Note that if a command invoked via SPI fails, 
then control will not be returned to your procedure.", so would that mean that 
a C++ method in the driver could be interrupted ? (probably through a 
longjmp(), I imagine that must be implemented like that). Which could cause 
potentially memory leaks, or worse, if no precaution is taken (*). Perhaps  
using palloc() / SPI_palloc() would be needed (but wouldn't help for C++ 
objects temporary allocated) ?


> Making it perfect in situations where:
> 
> - The postgres database is local (so using libpq to setup a network
> connection is not necessarily the best method)
> - You want best read/write performance and are happy to only operate gdal
> 'server side'
> - You want to use gdal in order to write postgres/postgis extensions in C
> and expose them to clients as SQL (e.g. thin clients, webapps etc..)

So you would have an extension using a GDALDataset and offering processing on 
it ?
I'm trying to guess use cases where this would be a clear win over using 
PostgisRaster ST_XXX functions which also run server side. Perhaps for 
operations on a large set of tiles seen as a consistant virtual dataset rather 
than operating on each raster tile individually as the PostgisRaster functions 
do, and you don't want to do a ST_Union first or hit the limits of a PostGIS 
raster object ? 

> 
> Using SPI would require building the driver against postgres and is
> somewhat similar to using libpq, such that much of the existing code in
> the postgis raster driver can be reused.

In your previous email you mention "a entirely new driver". Did you think it 
would be feasible to have common classes shared by the PGRaster client driver 
and PGRaser server driver for most of the code, and move away the way to talk 
to the DB (ie libpq vs SPI ?). That would ease long term maintenance instead 
of code duplication that would result of the initial copy&paste operation.

Even

(*) the doc mentions later "It is possible to recover control after an error 
by establishing your own subtransaction surrounding SPI calls that might fail. 
This is not currently documented because the mechanisms required are still in 
flux." ...

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Tue Jan 26 07:31:05 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 26 Jan 2016 16:31:05 +0100
Subject: [gdal-dev] GDAL 2.0.2RC4 available for review
Message-ID: <201601261631.05643.even.rouault@spatialys.com>

Hi,

Another 2.0.2 RC, hopefully the last one, to fix a bug in GPKG raster driver 
potentially causing crashes at dataset closing after overview building.

Changes since 2.0.2RC3:
- fix potential use of freed sqlite temporary DB handle when generating 
overviews with partial tiles (#6335)

Links:
  http://download.osgeo.org/gdal/2.0.2/gdal-2.0.2RC4.tar.xz
  http://download.osgeo.org/gdal/2.0.2/gdal-2.0.2RC4.tar.gz
  http://download.osgeo.org/gdal/2.0.2/gdal202RC4.zip
  http://download.osgeo.org/gdal/2.0.2/gdalautotest-2.0.2RC4.tar.gz
  http://download.osgeo.org/gdal/2.0.2/gdalautotest-2.0.2RC4.zip
  http://trac.osgeo.org/gdal/wiki/Release/2.0.2-News

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From alexhighviz at hotmail.com  Tue Jan 26 07:58:48 2016
From: alexhighviz at hotmail.com (alex)
Date: Tue, 26 Jan 2016 15:58:48 +0000
Subject: [gdal-dev] C++ Range and Iterator for GDALDataSet
Message-ID: <DUB117-DS43E90E991D6DECAF226473B4D80@phx.gbl>

Hi,

I developed a C++ class that wraps around a GDALDataSet. The class has
associated iterator class and begin() and end() member functions, so it can
be used with range-based for-loops. The iterator goes over all pixels
row-by-row (so not block-by-block as proposed in a recent message). 

The use of the class is basic. The following program prints all values in
the first rasterband of "input.tif" :

auto raster = open_gdal_dataset<int>("input.tif", GA_ReadOnly):
for(auto&& i : raster) {
  std::cout << i << std::endl;
}

I found these classes very useful for simple map algebra type applications,
when used in conjunction with a (my own) zip range. For instance the
following program creates a new dataset containing the square roots of the
input dataset. 

auto input = open_gdal_dataset<int>("input.tif", GA_ReadOnly);
auto output = create_gdal_dataset_from_model<double>("output.tif", input);
auto zip = make_zip_range(std::ref(input), std::ref(output));
for(auto&& i : zip) {
  std::get<1>(i) = std::sqrt(static_cast<double>(std::get<0>(i)) );
}

I am also using the classes for more complex analysis, such as moving window
analysis and distance transforms. Furthermore, I created classes to iterate
in col-major order and to iterate over edges (pairs of adjacent pixels)
instead of pixels.

I have made the source available on github (www.github.com/ahhz/raster),
however I would rather see this integrated in an existing and active open
source project. 
 
I realize that the primary language of GDAL is not C++. However, this may
still be of interest. Could you please let me know if this would be of
interest to GDAL or perhaps point me to a more appropriate project.

Thanks, Alex


From dmfenton at gmail.com  Tue Jan 26 13:21:40 2016
From: dmfenton at gmail.com (Daniel Fenton)
Date: Tue, 26 Jan 2016 21:21:40 +0000
Subject: [gdal-dev] Streaming Parser for OGR GeoJSON Driver
Message-ID: <CAHmEjOXtF5v8xx+vG7W6_97TM4Y7_X5C8u8F3sHvVQOpPGJJYA@mail.gmail.com>

Hi all,


I’m curious if anyone has ideas or advice on how to use a streaming parser
in the OGR GeoJSON driver.


My use-case is that I need to convert arbitrarily-sized streams of geojson
into other formats (e.g. Csv, shapefile, kml, etc).


My current strategy is to first partition the GeoJSON into a VRT file and
then call OGR. This works for arbitrary sized streams, but  it’s
inefficient because the process is blocked until the entire VRT is ready.
You can see my implementation here: https://github.com/koopjs/GeoXForm.


I noticed that there exists at least one C library for parsing son streams:
https://github.com/lloyd/yajl, but I do not know enough C++ (or C for that
matter) to integrate it.


Has anyone considered this approach before? Any advice on how to implement
it?


I would sincerely appreciate any help.


Daniel Fenton
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160126/81328777/attachment.html>

From ari.jolma at gmail.com  Tue Jan 26 23:33:08 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Wed, 27 Jan 2016 09:33:08 +0200
Subject: [gdal-dev] C++ Range and Iterator for GDALDataSet
In-Reply-To: <DUB117-DS43E90E991D6DECAF226473B4D80@phx.gbl>
References: <DUB117-DS43E90E991D6DECAF226473B4D80@phx.gbl>
Message-ID: <56A872B4.6070507@gmail.com>

26.01.2016, 17:58, alex kirjoitti:
> Hi,
>
> I developed a C++ class that wraps around a GDALDataSet. The class has
> associated iterator class and begin() and end() member functions, so it can
> be used with range-based for-loops. The iterator goes over all pixels
> row-by-row (so not block-by-block as proposed in a recent message).
>
> The use of the class is basic. The following program prints all values in
> the first rasterband of "input.tif" :
>
> auto raster = open_gdal_dataset<int>("input.tif", GA_ReadOnly):
> for(auto&& i : raster) {
>    std::cout << i << std::endl;
> }
>
> I found these classes very useful for simple map algebra type applications,

In map algebra you often have two operands. Assuming two raster bands 
have the same size and georeferencing, how would you write a code that 
works on both of them?

> when used in conjunction with a (my own) zip range. For instance the
> following program creates a new dataset containing the square roots of the
> input dataset.
>
> auto input = open_gdal_dataset<int>("input.tif", GA_ReadOnly);
> auto output = create_gdal_dataset_from_model<double>("output.tif", input);
> auto zip = make_zip_range(std::ref(input), std::ref(output));
> for(auto&& i : zip) {
>    std::get<1>(i) = std::sqrt(static_cast<double>(std::get<0>(i)) );
> }
>
> I am also using the classes for more complex analysis, such as moving window
> analysis and distance transforms. Furthermore, I created classes to iterate
> in col-major order and to iterate over edges (pairs of adjacent pixels)
> instead of pixels.
>
> I have made the source available on github (www.github.com/ahhz/raster),
> however I would rather see this integrated in an existing and active open
> source project.
>   
> I realize that the primary language of GDAL is not C++.

GDAL is written in C++ but it has a C API, which is used with other 
languages.

Ari

>   However, this may
> still be of interest. Could you please let me know if this would be of
> interest to GDAL or perhaps point me to a more appropriate project.
>
> Thanks, Alex
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From jerome.siot at maxsea.fr  Wed Jan 27 01:13:00 2016
From: jerome.siot at maxsea.fr (Jerome Siot)
Date: Wed, 27 Jan 2016 09:13:00 +0000
Subject: [gdal-dev] Question about DWG driver integration into GDAL
Message-ID: <1F69DB3E166E714BAD00B83D3FB08774025D5B7CEE@EXCH2010.informatique-mer.fr>

Dear all,
I'm currently trying to compile GDAL(2.0.1) with DWG driver enabled, *** under Windows 8 *** (I compile with Visual Studio/Cygwin, compilation is successful for other drivers (ex : OGDI)).


1)      I tried "# DWG support using the Open Design Alliance Teigha Libraries" :

-          I found binaries on https://www.opendesign.com/download/

-          I compile successfully, but the driver isn't printed In OGR driver list when in run my sample application

2)      For the 2nd way, "# DWG/DXF support via DWGdirect from Open Design Alliance", I didn't find netheir binaries  nor sources of DWGDirect

3)      I saw on the web a third possibility, which is "DXFDWG", given by https://trac.osgeo.org/gdal/wiki/DxfDwg, which I don't know how to use.

What solution must be used for win32 compilation ?
Is it possible to compile DWG driver within gdal 2.0.1 ?

Thank you, Jérome Siot

(Excuse me for my awful English, I'm French !)

Here is an extract of gdal-2.0.1/nmake.opt

# DWG support using the Open Design Alliance Teigha Libraries

#TD_BASE = C:\warmerda\pkg\td_vc9
#TD_FLAGS = -D_TOOLKIT_IN_DLL_
#TD_INCLUDE = -I$(TD_BASE)\TD\Include -I$(TD_BASE)\TD\Extensions\ExServices
#TD_LIBDIR = $(TD_BASE)\lib\vc9dll


# DWG/DXF support via DWGdirect from Open Design Alliance

#DWGDIRECT=C:\warmerda\DWGdirect
#DWG_LIB_DIR=$(DWGDIRECT)\lib\VC6MD
#DWG_LIB=$(DWG_LIB_DIR)\DD_AcisBuilder_dll.lib $(DWG_LIB_DIR)\DD_AcisRenderer_dll.lib $(DWG_LIB_DIR)\DD_Alloc_dll.lib $(DWG_LIB_DIR)\DD_BmpExport_dll.lib $(DWG_LIB_DIR)\DD_Br_dll.lib $(DWG_LIB_DIR)\DD_Db_dll.lib $(DWG_LIB_DIR)\DD_DwfExport_dll.lib $(DWG_LIB_DIR)\DD_DwfImport_dll.lib $(DWG_LIB_DIR)\DD_Ge_dll.lib $(DWG_LIB_DIR)\DD_Gi_dll.lib $(DWG_LIB_DIR)\DD_Gs_dll.lib $(DWG_LIB_DIR)\DD_ModelerGeometry_dll.lib $(DWG_LIB_DIR)\DD_Root_dll.lib $(DWG_LIB_DIR)\DD_Sm_dll.lib $(DWG_LIB_DIR)\DD_SpatialIndex_dll.lib $(DWG_LIB_DIR)\DD_VC6MD_OleDataAccess_dll.lib





-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160127/db9bbd85/attachment.html>

From even.rouault at spatialys.com  Wed Jan 27 02:29:09 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 27 Jan 2016 11:29:09 +0100
Subject: [gdal-dev] Motions: Promote 1.11.4 RC2 and 2.0.2 RC4 for release
Message-ID: <201601271129.09484.even.rouault@spatialys.com>

Hi,

Motion 1: GDAL/OGR 1.11.4 RC2 is promoted to be the official 1.11.4 final 
release.

Motion 2: GDAL/OGR 2.0.2 RC4 is promoted to be the official 2.0.2 final release.

--

My votes :
Motion 1: + 1
Motion 2: + 1

Best regards,


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Wed Jan 27 02:55:01 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Wed, 27 Jan 2016 12:55:01 +0200
Subject: [gdal-dev] Support for measures
Message-ID: <56A8A205.2020303@gmail.com>

Folks,

I'd like to try to implement the XYZM support since I have some free time.

Before making a RFC, there are some thoughts/questions/ideas:

* I made a fork for this work at https://github.com/ajolma/GDAL-XYZM so 
I can more easily use travis.

* I think this is mainly changes in the geometry API and generic methods.

Are there other drivers than shape, which are affected? Currently shape 
driver creates XYZ data from XYM data, that would change, which may 
break some code.

* Currently XYM or XYZM data seems to be accepted (by WKT and WKB 
importers for example) but not stored in generic objects.

* The closeness of XYZ and XYM might need some thought:

For example C++ API for making a adding a XYZ and XYM point to a curve 
would be the same. Currently the method calls Make3D() if the curve is 
2D, which is not ok for XYM data.

Tickets related to this are

https://trac.osgeo.org/gdal/ticket/6063
https://trac.osgeo.org/gdal/ticket/6331

Are there other things I should know?

The target would be 2.1 I guess.

Ari


From even.rouault at spatialys.com  Wed Jan 27 02:57:15 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 27 Jan 2016 11:57:15 +0100
Subject: [gdal-dev] Streaming Parser for OGR GeoJSON Driver
In-Reply-To: <CAHmEjOXtF5v8xx+vG7W6_97TM4Y7_X5C8u8F3sHvVQOpPGJJYA@mail.gmail.com>
References: <CAHmEjOXtF5v8xx+vG7W6_97TM4Y7_X5C8u8F3sHvVQOpPGJJYA@mail.gmail.com>
Message-ID: <201601271157.15425.even.rouault@spatialys.com>

Hi,

> 
> I’m curious if anyone has ideas or advice on how to use a streaming parser
> in the OGR GeoJSON driver.
> 

A streaming parser, or at least something not requiring full ingestion in 
memory of a geojson file, is something that would indeed solve issues that 
people run into with the current driver on big files (let's say several  
hundreds of megabytes or more)

> 
> My use-case is that I need to convert arbitrarily-sized streams of geojson
> into other formats (e.g. Csv, shapefile, kml, etc).
> 
> 
> My current strategy is to first partition the GeoJSON into a VRT file and
> then call OGR. This works for arbitrary sized streams, but  it’s
> inefficient because the process is blocked until the entire VRT is ready.
> You can see my implementation here: https://github.com/koopjs/GeoXForm.

I'm not a JS programmer, nevertheless I tried to understand 
https://github.com/koopjs/GeoXForm/blob/master/src/lib/vrt.js, and you seem to 
group GeoJSON Feature objects by batch of 5000 (*) , put them in a temp .json 
file, and assemble all the JSon files in a VRT that looks like the following, 
right ?

<OGRVRTDataSource>
    <OGRVRTLayer name="OGRGeoJSON">
        <SrcDataSource>tmp1.json</SrcDataSource>
    </OGRVRTLayer>
    <OGRVRTLayer name="OGRGeoJSON">
        <SrcDataSource>tmp2.json</SrcDataSource>
    </OGRVRTLayer>
</OGRVRTDataSource>

Just wanted to warn that creating layers of the same name is more or less 
undefined behaviour and the way ogr2ogr will handle that is also unspecified. 
You're quite lucky this works. Actually from what I see it will use only the 
layer definition of the first tmp1.json and ignore any potential additional 
fields of the following fields.

A cleaner solution would be to use a <OGRVRTUnionLayer> to wrap all the 
<OVRTVRTLayer> (see http://www.gdal.org/drv_vrt.html), but this would perhaps 
have bad performance due to a first pass being done to established the union'ed 
layer definition from the individual sources.

> 
> 
> I noticed that there exists at least one C library for parsing son streams:
> https://github.com/lloyd/yajl, but I do not know enough C++ (or C for that
> matter) to integrate it.
> 
> 
> Has anyone considered this approach before? Any advice on how to implement
> it?

One tricky point is to establish the layer definition (ie identifying the 
fields/properties). Currently the driver does a first pass to build the schema 
by examining the properties of each Feature object and unioning them, and then 
a second one to build the OGRFeature objects

With a JSon streaming parsing library, when operating on a file on which you 
can seek arbitrarily, a similar strategy could be applied. From the point of 
view of the user, nothing would be changed except that there would be no 
longer any limit to the size of the files that can be processed
But when operating on the input stream that you cannot rewind, this 2 pass 
strategy becomes a problem. A potential solution would be to buffer let's say 
the first MB of features and build the layer definition from it, assuming that 
next features will follow the same schema (and if not ignore the extra 
attributes). Or introduce the concept of non fixed schema (ie the schema would 
evolve when you iterate over the features) in OGR, but this would have broader 
implications.

Even

(*) It looks like you manage to separate JSon Feature objects with just string 
spliting on ',{' pattern ? That looks extremelly fragile to additional space 
characters, or complex properties inside a Feature object, like

{ "type": "Feature", "properties": { "prop": [ {"foo":"bar"},{"bar":"baz"} ] 
}, "geometry": null }


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From alexhighviz at hotmail.com  Wed Jan 27 03:16:54 2016
From: alexhighviz at hotmail.com (alex)
Date: Wed, 27 Jan 2016 11:16:54 +0000
Subject: [gdal-dev] C++ Range and Iterator for GDALDataSet
In-Reply-To: <56A872B4.6070507@gmail.com>
References: <DUB117-DS43E90E991D6DECAF226473B4D80@phx.gbl>
 <56A872B4.6070507@gmail.com>
Message-ID: <DUB117-DS6061244A8445EEBCBD172B4D90@phx.gbl>

>> I found these classes very useful for simple map algebra type applications,
>
>In map algebra you often have two operands. Assuming two raster bands
>have the same size and georeferencing, how would you write a code that
>works on both of them?
>

For that I use a zip range. The following example adds two bands and assigns the result to a third.

auto a = open_gdal_raster<int>("a.tif", GA_ReadOnly);
auto b = open_gdal_raster<int>("b.tif", GA_ReadOnly);
auto out = open_gdal_raster<int>("out.tif", GA_Update);
auto zip = make_zip_range(std::ref(a), std::ref(b), std::ref(out) );
for(auto&& i : zip) {
  std::get<2>(i) =  std::get<0>(i) + std::get<1>(i); 
} 

Alternatively, you could do the same thing using iterators:

auto a = open_gdal_raster<int>("a.tif", GA_ReadOnly);
auto b = open_gdal_raster<int>("b.tif", GA_ReadOnly);
auto out = open_gdal_raster<int>("out.tif", GA_Update);
auto ai = a.begin();
auto bi = b.begin();
auto outi = out.begin();
for( ; ai != a.end(); ++ai, ++bi, ++outi) {
  *outi = *ai + *bi;
}


>> auto input = open_gdal_dataset<int>("input.tif", GA_ReadOnly);
This was a typo; it should have been open_gdal_raster<int>

>> I realize that the primary language of GDAL is not C++.
>
>GDAL is written in C++ but it has a C API, which is used with other
>languages.
>
>Ari
>
That is fortunate!


From even.rouault at spatialys.com  Wed Jan 27 03:27:40 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 27 Jan 2016 12:27:40 +0100
Subject: [gdal-dev] Support for measures
In-Reply-To: <56A8A205.2020303@gmail.com>
References: <56A8A205.2020303@gmail.com>
Message-ID: <201601271227.40758.even.rouault@spatialys.com>

Le mercredi 27 janvier 2016 11:55:01, Ari Jolma a écrit :
> Folks,
> 
> I'd like to try to implement the XYZM support since I have some free time.
> 
> Before making a RFC, there are some thoughts/questions/ideas:
> 
> * I made a fork for this work at https://github.com/ajolma/GDAL-XYZM so
> I can more easily use travis.
> 
> * I think this is mainly changes in the geometry API and generic methods.
> 
> Are there other drivers than shape, which are affected?

On top of my head: PostGIS, FileGDB, OpenFileGDB, GeoPackage, Spatialite. 
Probably other RDMBs too (Oracle, MSSQL, ... ?)


> Currently shape
> driver creates XYZ data from XYM data, that would change, which may
> break some code.

The way the shape driver currently exposes XYM as XYZ is a hack. I'm not sure 
many people rely on that, and I think it would be OK to change the behaviour 
with a cleaner approach.

> 
> * Currently XYM or XYZM data seems to be accepted (by WKT and WKB
> importers for example) but not stored in generic objects.

Right, M components are skipped/ignored

> 
> * The closeness of XYZ and XYM might need some thought:

Yes, the concept of coordinate dimension is ambiguous for 3.  
getGeometryType() would be needed to know the real interpretation.

> For example C++ API for making a adding a XYZ and XYM point to a curve
> would be the same.
> Currently the method calls Make3D() if the curve is
> 2D, which is not ok for XYM data.
Indeed, we should likely keep some auto-promotion rules for XY->XYZ but 
perhaps not for XYM/XYZM.
> 
> Tickets related to this are
> 
> https://trac.osgeo.org/gdal/ticket/6063
> https://trac.osgeo.org/gdal/ticket/6331
> 
> Are there other things I should know?

GEOS methods ignore M AFAIR.

Other thought: XYM/XYZM support will have some (unavoidable) compatibility 
impact on C API users as they will potentially receive new geometry types.

> 
> The target would be 2.1 I guess.
> 
> Ari
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From p.halls at york.ac.uk  Wed Jan 27 03:29:19 2016
From: p.halls at york.ac.uk (Peter Halls)
Date: Wed, 27 Jan 2016 11:29:19 +0000
Subject: [gdal-dev] Support for measures
In-Reply-To: <56A8A205.2020303@gmail.com>
References: <56A8A205.2020303@gmail.com>
Message-ID: <CADEnnOMuBpBird_KUS9DRwKX4JKhxbAUeN_H8hnpKh0+O=m0ww@mail.gmail.com>

Ari,

     I do not think that Z and M can ever be truly synonymous: whilst z is
partially defined in terms of, for example, a datum, there is no equivalent
for M.  Also, by convention, X, Y and Z frequently employ the same units;
there is no equivalent convention for M (as yet).

     There may be a philosophical case for using M for altitude
measurements instead of Z where X and Y use spherical or other non-linear
units.

     Currently, there are a number of disparate uses of the M value, for
example, in terms of variations in feature width, cant, segment length,
etc.  I have (once) seen M used for an integer code to report variations in
surface texture.  I do not know how many specialised uses there may be.

Best wishes,

Peter


On 27 January 2016 at 10:55, Ari Jolma <ari.jolma at gmail.com> wrote:

> Folks,
>
> I'd like to try to implement the XYZM support since I have some free time.
>
> Before making a RFC, there are some thoughts/questions/ideas:
>
> * I made a fork for this work at https://github.com/ajolma/GDAL-XYZM so I
> can more easily use travis.
>
> * I think this is mainly changes in the geometry API and generic methods.
>
> Are there other drivers than shape, which are affected? Currently shape
> driver creates XYZ data from XYM data, that would change, which may break
> some code.
>
> * Currently XYM or XYZM data seems to be accepted (by WKT and WKB
> importers for example) but not stored in generic objects.
>
> * The closeness of XYZ and XYM might need some thought:
>
> For example C++ API for making a adding a XYZ and XYM point to a curve
> would be the same. Currently the method calls Make3D() if the curve is 2D,
> which is not ok for XYM data.
>
> Tickets related to this are
>
> https://trac.osgeo.org/gdal/ticket/6063
> https://trac.osgeo.org/gdal/ticket/6331
>
> Are there other things I should know?
>
> The target would be 2.1 I guess.
>
> Ari
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev




-- 
----------------------------------------------------------------------------------------------------------------
Peter J Halls, PhD Student, Post-war Reconstruction and Development Unit
(PRDU),
                      University of York

Snail mail: PRDU, Derwent College, University of York,
                Heslington, York YO10 5DD
This message has the status of a private and personal communication
----------------------------------------------------------------------------------------------------------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160127/5601bc12/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Wed Jan 27 04:22:28 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Wed, 27 Jan 2016 12:22:28 +0000 (UTC)
Subject: [gdal-dev] Motions: Promote 1.11.4 RC2 and 2.0.2 RC4 for release
References: <201601271129.09484.even.rouault@spatialys.com>
Message-ID: <loom.20160127T132105-233@post.gmane.org>

Even Rouault <even.rouault <at> spatialys.com> writes:

> 
> Hi,
> 
> Motion 1: GDAL/OGR 1.11.4 RC2 is promoted to be the official 1.11.4 final 
> release.
> 
> Motion 2: GDAL/OGR 2.0.2 RC4 is promoted to be the official 2.0.2 final
release.
> 
> --
> 
> My votes :
> Motion 1: + 1
> Motion 2: + 1

My votes:

motion 1: +1
motion 2: +1


-Jukka Rahkonen- 





From j.leonancarvalho at gmail.com  Wed Jan 27 04:26:22 2016
From: j.leonancarvalho at gmail.com (Leonan Carvalho)
Date: Wed, 27 Jan 2016 10:26:22 -0200
Subject: [gdal-dev] Question about KML Lib
Message-ID: <CAEkoqGnMUL2zxa56D=7J3=bP2TGv5tSC4+Mwcjzadp-rKxW-4g@mail.gmail.com>

Dear All,

I'd asked a question on GIS Starkexchange
<http://gis.stackexchange.com/questions/177545/convert-kml-to-geojson-with-ogr2ogr-and-remove-kml-special-attributes>
 (
http://gis.stackexchange.com/questions/177545/convert-kml-to-geojson-with-ogr2ogr-and-remove-kml-special-attributes)
about a issue with KML convertion to GEOJSON(or other formats) . There you
can find more tecnical information about it.
It was proposed that I make the same question here in this list, so, to
summarize I have the following scenario:

- I'm using GDAL 1.11.3 on Windows 10, released 09/16/2015
- I'm exporting a KML for GeoJSON
- I do not know the name of layers, or which fields are available.
- I have no any special attributes in the schema but always is created
these attributes:* Name,
description,timestamp,begin,end,altitudeMode,tessellate,extrude,visibility,drawOrder,icon.*
- I must keep only attributes present on schema.



I really appreciate if someone  help to clearance.


(Excuse me for my awful English, I’m French !)

Best wishes,


* José Leonan S. Carvalho*
*Software Engineer*
+55 22 9 99811 1411
j.leonancarvalho at gmail.com
www.leonancarvalho.com
*skype: jleonancarvalho*
*“Procurem deixar este mundo um pouco melhor do que o encontraram, e,
quando chegar a hora de morrer, poderão morrer felizes sentindo que pelo
menos não desperdiçaram o tempo e que procuraram fazer o melhor possível.*
*Deste modo estejam “bem preparados” para viver felizes e para morrer
felizes.”*
* - Lord Baden-Powell of Gilwell *
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160127/af3f1608/attachment-0001.html>

From ari.jolma at gmail.com  Wed Jan 27 04:34:01 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Wed, 27 Jan 2016 14:34:01 +0200
Subject: [gdal-dev] Support for measures
In-Reply-To: <201601271227.40758.even.rouault@spatialys.com>
References: <56A8A205.2020303@gmail.com>
 <201601271227.40758.even.rouault@spatialys.com>
Message-ID: <56A8B939.8020609@gmail.com>

27.01.2016, 13:27, Even Rouault kirjoitti:
> Le mercredi 27 janvier 2016 11:55:01, Ari Jolma a écrit :
>> Folks,
>>
>> I'd like to try to implement the XYZM support since I have some free time.
>>
>> Before making a RFC, there are some thoughts/questions/ideas:
>>
>> * I made a fork for this work at https://github.com/ajolma/GDAL-XYZM so
>> I can more easily use travis.
>>
>> * I think this is mainly changes in the geometry API and generic methods.
>>
>> Are there other drivers than shape, which are affected?
> On top of my head: PostGIS, FileGDB, OpenFileGDB, GeoPackage, Spatialite.
> Probably other RDMBs too (Oracle, MSSQL, ... ?)

I'm not so sure that it is so many. For example PostGIS driver is mostly 
moving WKB back and forth.

Anyway, I'll look into the geometry API first.

Ari


From ari.jolma at gmail.com  Wed Jan 27 05:01:42 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Wed, 27 Jan 2016 15:01:42 +0200
Subject: [gdal-dev] Support for measures
In-Reply-To: <56A8B939.8020609@gmail.com>
References: <56A8A205.2020303@gmail.com>
 <201601271227.40758.even.rouault@spatialys.com> <56A8B939.8020609@gmail.com>
Message-ID: <56A8BFB6.7050901@gmail.com>

27.01.2016, 14:34, Ari Jolma kirjoitti:
> 27.01.2016, 13:27, Even Rouault kirjoitti:
>> Le mercredi 27 janvier 2016 11:55:01, Ari Jolma a écrit :
>>> Folks,
>>>
>>> I'd like to try to implement the XYZM support since I have some free 
>>> time.
>>>
>>> Before making a RFC, there are some thoughts/questions/ideas:
>>>
>>> * I made a fork for this work at https://github.com/ajolma/GDAL-XYZM so
>>> I can more easily use travis.
>>>
>>> * I think this is mainly changes in the geometry API and generic 
>>> methods.
>>>
>>> Are there other drivers than shape, which are affected?
>> On top of my head: PostGIS, FileGDB, OpenFileGDB, GeoPackage, 
>> Spatialite.
>> Probably other RDMBs too (Oracle, MSSQL, ... ?)
>
> I'm not so sure that it is so many. For example PostGIS driver is 
> mostly moving WKB back and forth.


Well, it seems that they are affected. There is for example the 
setCoordinateDimension() method, which is called by many drivers and 
once measures are supported it becomes ambiguous since coordinate 
dimension is 3 for both XYM and XYZ.

Ari


>
> Anyway, I'll look into the geometry API first.
>
> Ari
>


From even.rouault at spatialys.com  Wed Jan 27 05:23:14 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 27 Jan 2016 14:23:14 +0100
Subject: [gdal-dev] Support for measures
In-Reply-To: <56A8BFB6.7050901@gmail.com>
References: <56A8A205.2020303@gmail.com> <56A8B939.8020609@gmail.com>
 <56A8BFB6.7050901@gmail.com>
Message-ID: <201601271423.14595.even.rouault@spatialys.com>

Le mercredi 27 janvier 2016 14:01:42, Ari Jolma a écrit :
> 27.01.2016, 14:34, Ari Jolma kirjoitti:
> > 27.01.2016, 13:27, Even Rouault kirjoitti:
> >> Le mercredi 27 janvier 2016 11:55:01, Ari Jolma a écrit :
> >>> Folks,
> >>> 
> >>> I'd like to try to implement the XYZM support since I have some free
> >>> time.
> >>> 
> >>> Before making a RFC, there are some thoughts/questions/ideas:
> >>> 
> >>> * I made a fork for this work at https://github.com/ajolma/GDAL-XYZM so
> >>> I can more easily use travis.
> >>> 
> >>> * I think this is mainly changes in the geometry API and generic
> >>> methods.
> >>> 
> >>> Are there other drivers than shape, which are affected?
> >> 
> >> On top of my head: PostGIS, FileGDB, OpenFileGDB, GeoPackage,
> >> Spatialite.
> >> Probably other RDMBs too (Oracle, MSSQL, ... ?)
> > 
> > I'm not so sure that it is so many. For example PostGIS driver is
> > mostly moving WKB back and forth.
> 
> Well, it seems that they are affected. There is for example the
> setCoordinateDimension() method, which is called by many drivers and
> once measures are supported it becomes ambiguous since coordinate
> dimension is 3 for both XYM and XYZ.

I think we should perhaps keep setCoordinateDimension() with the current 
semantics for legacy reasons but not accept using 3 for XYM or extending it to 
4 for XYZM

The OGRGeometry class could have for example a setCoordinateInterpretation() 
with an enum XY, XYZ, XYM and XYZM. And a similar member variable to store it.

... or, as currently getGeometryType() dynamically builds the geometry type, 
perhaps have instead a wkbGeometryType member in OGRGeometry itself.

And have a setGeometryType() to modify it, with restrictions on which kind of 
geometry type changes are allowed. You can't  do 
point.SetGeometryType(wkbLineString) )

Actually instead of setGeometryType() , the way QGIS has done with its 
QgsAbstractGeometryV2 class, ie with explicit addZValues( double zInitValue ), 
addZValues( double zInitValue ), dropZValues(), dropMValues() could be a good 
inspiration.

> 
> Ari
> 
> > Anyway, I'll look into the geometry API first.
> > 
> > Ari

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Wed Jan 27 05:38:05 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Wed, 27 Jan 2016 15:38:05 +0200
Subject: [gdal-dev] Support for measures
In-Reply-To: <201601271423.14595.even.rouault@spatialys.com>
References: <56A8A205.2020303@gmail.com> <56A8B939.8020609@gmail.com>
 <56A8BFB6.7050901@gmail.com> <201601271423.14595.even.rouault@spatialys.com>
Message-ID: <56A8C83D.9080505@gmail.com>

27.01.2016, 15:23, Even Rouault kirjoitti:
> Le mercredi 27 janvier 2016 14:01:42, Ari Jolma a écrit :
>> 27.01.2016, 14:34, Ari Jolma kirjoitti:
>>> 27.01.2016, 13:27, Even Rouault kirjoitti:
>>>> Le mercredi 27 janvier 2016 11:55:01, Ari Jolma a écrit :
>>>>> Folks,
>>>>>
>>>>> I'd like to try to implement the XYZM support since I have some free
>>>>> time.
>>>>>
>>>>> Before making a RFC, there are some thoughts/questions/ideas:
>>>>>
>>>>> * I made a fork for this work at https://github.com/ajolma/GDAL-XYZM so
>>>>> I can more easily use travis.
>>>>>
>>>>> * I think this is mainly changes in the geometry API and generic
>>>>> methods.
>>>>>
>>>>> Are there other drivers than shape, which are affected?
>>>> On top of my head: PostGIS, FileGDB, OpenFileGDB, GeoPackage,
>>>> Spatialite.
>>>> Probably other RDMBs too (Oracle, MSSQL, ... ?)
>>> I'm not so sure that it is so many. For example PostGIS driver is
>>> mostly moving WKB back and forth.
>> Well, it seems that they are affected. There is for example the
>> setCoordinateDimension() method, which is called by many drivers and
>> once measures are supported it becomes ambiguous since coordinate
>> dimension is 3 for both XYM and XYZ.
> I think we should perhaps keep setCoordinateDimension() with the current
> semantics for legacy reasons but not accept using 3 for XYM or extending it to
> 4 for XYZM

That's my thinking too. The semantics of the old API should be kept the 
same. I'm thinking that there should perhaps be a new method 
CoordinateDimension(), which would return the same as ST_NDims of 
PostGIS. Actually the name of the method is CoordinateDimension() 
(without get prefix) in simple feature access documents.

>
> The OGRGeometry class could have for example a setCoordinateInterpretation()
> with an enum XY, XYZ, XYM and XYZM. And a similar member variable to store it.

set3D(boolean is3D) and setMeasured(boolean isMeasured)? As each 
geometry could have boolean Is3D and IsMeasured properties, and the docs 
have Is3D and IsMeasured methods.

>
> ... or, as currently getGeometryType() dynamically builds the geometry type,
> perhaps have instead a wkbGeometryType member in OGRGeometry itself.
>
> And have a setGeometryType() to modify it, with restrictions on which kind of
> geometry type changes are allowed. You can't  do
> point.SetGeometryType(wkbLineString) )
>
> Actually instead of setGeometryType() , the way QGIS has done with its
> QgsAbstractGeometryV2 class, ie with explicit addZValues( double zInitValue ),
> addZValues( double zInitValue ), dropZValues(), dropMValues() could be a good
> inspiration.

I'll go through the API and prepare and post a proposal to discuss more.

Ari

>
>> Ari
>>
>>> Anyway, I'll look into the geometry API first.
>>>
>>> Ari


From even.rouault at spatialys.com  Wed Jan 27 05:52:58 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 27 Jan 2016 14:52:58 +0100
Subject: [gdal-dev] Support for measures
In-Reply-To: <56A8C83D.9080505@gmail.com>
References: <56A8A205.2020303@gmail.com>
 <201601271423.14595.even.rouault@spatialys.com> <56A8C83D.9080505@gmail.com>
Message-ID: <201601271452.58488.even.rouault@spatialys.com>

Le mercredi 27 janvier 2016 14:38:05, Ari Jolma a écrit :
> 27.01.2016, 15:23, Even Rouault kirjoitti:
> > Le mercredi 27 janvier 2016 14:01:42, Ari Jolma a écrit :
> >> 27.01.2016, 14:34, Ari Jolma kirjoitti:
> >>> 27.01.2016, 13:27, Even Rouault kirjoitti:
> >>>> Le mercredi 27 janvier 2016 11:55:01, Ari Jolma a écrit :
> >>>>> Folks,
> >>>>> 
> >>>>> I'd like to try to implement the XYZM support since I have some free
> >>>>> time.
> >>>>> 
> >>>>> Before making a RFC, there are some thoughts/questions/ideas:
> >>>>> 
> >>>>> * I made a fork for this work at https://github.com/ajolma/GDAL-XYZM
> >>>>> so I can more easily use travis.
> >>>>> 
> >>>>> * I think this is mainly changes in the geometry API and generic
> >>>>> methods.
> >>>>> 
> >>>>> Are there other drivers than shape, which are affected?
> >>>> 
> >>>> On top of my head: PostGIS, FileGDB, OpenFileGDB, GeoPackage,
> >>>> Spatialite.
> >>>> Probably other RDMBs too (Oracle, MSSQL, ... ?)
> >>> 
> >>> I'm not so sure that it is so many. For example PostGIS driver is
> >>> mostly moving WKB back and forth.
> >> 
> >> Well, it seems that they are affected. There is for example the
> >> setCoordinateDimension() method, which is called by many drivers and
> >> once measures are supported it becomes ambiguous since coordinate
> >> dimension is 3 for both XYM and XYZ.
> > 
> > I think we should perhaps keep setCoordinateDimension() with the current
> > semantics for legacy reasons but not accept using 3 for XYM or extending
> > it to 4 for XYZM
> 
> That's my thinking too. The semantics of the old API should be kept the
> same.

We should probably remove all its internal uses, and just have it used by 
OGR_G_SetCoordinateDimension(). And figure out what the behaviour should be 
when called on a XYM or XYZM geometry.

> I'm thinking that there should perhaps be a new method
> CoordinateDimension(), which would return the same as ST_NDims of
> PostGIS. Actually the name of the method is CoordinateDimension()
> (without get prefix) in simple feature access documents.

Sounds reasonable.

> 
> > The OGRGeometry class could have for example a
> > setCoordinateInterpretation() with an enum XY, XYZ, XYM and XYZM. And a
> > similar member variable to store it.
> 
> set3D(boolean is3D) and setMeasured(boolean isMeasured)? As each
> geometry could have boolean Is3D and IsMeasured properties, and the docs
> have Is3D and IsMeasured methods.

I think that if possible we should try to minimize the number of attributes in 
the base OGRGeometry class so that sizeof(OGRPoint) remains small. Having the 
geometry type stored would capture both the Is3D and IsMeasure. And  int                   
nCoordDimension could then potentially be removed, except that we have hacks 
currently in OGRPoint : -2 = point 2D empty and -3 = point 3D empty.
Actually, I'm thinking we don't need that hack and that checking if isnan(x) 
&& isnan(y) could be sufficient to model a POINT EMPTY (this is what we do in 
OGRPoint::importFromWkb() to support the GeoPackage / PostGIS 2.2 way of 
representing a POINT EMPTY) and avoid storing an explicit (and hacked) 
nCoordDimension.

> 
> > ... or, as currently getGeometryType() dynamically builds the geometry
> > type, perhaps have instead a wkbGeometryType member in OGRGeometry
> > itself.
> > 
> > And have a setGeometryType() to modify it, with restrictions on which
> > kind of geometry type changes are allowed. You can't  do
> > point.SetGeometryType(wkbLineString) )
> > 
> > Actually instead of setGeometryType() , the way QGIS has done with its
> > QgsAbstractGeometryV2 class, ie with explicit addZValues( double
> > zInitValue ), addZValues( double zInitValue ), dropZValues(),
> > dropMValues() could be a good inspiration.
> 
> I'll go through the API and prepare and post a proposal to discuss more.
> 
> Ari
> 
> >> Ari
> >> 
> >>> Anyway, I'll look into the geometry API first.
> >>> 
> >>> Ari

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Jan 27 06:22:24 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 27 Jan 2016 15:22:24 +0100
Subject: [gdal-dev] Question about DWG driver integration into GDAL
In-Reply-To: <1F69DB3E166E714BAD00B83D3FB08774025D5B7CEE@EXCH2010.informatique-mer.fr>
References: <1F69DB3E166E714BAD00B83D3FB08774025D5B7CEE@EXCH2010.informatique-mer.fr>
Message-ID: <201601271522.24726.even.rouault@spatialys.com>

Bonjour Jérome,

> 
> 1)      I tried "# DWG support using the Open Design Alliance Teigha
> Libraries" :
> 
> -          I found binaries on https://www.opendesign.com/download/
> 
> -          I compile successfully, but the driver isn't printed In OGR
> driver list when in run my sample application

If you didn't remove the comments in the nmake.opt and change the variables to 
point to the appropriate path as it seems you did not, then the driver isn't 
compiled at all.

Anyway, there was a discussion a few months ago, and the likely conclusion was 
that it isn't possible to build the driver with the "free" DLLs you can 
download, but you have to be a member  of the O.D.A. alliance to get the 
required DLLs

https://lists.osgeo.org/pipermail/gdal-dev/2015-September/042632.html
https://lists.osgeo.org/pipermail/gdal-dev/2015-September/042651.html

> 
> 2)      For the 2nd way, "# DWG/DXF support via DWGdirect from Open Design
> Alliance", I didn't find netheir binaries  nor sources of DWGDirect
> 
> 3)      I saw on the web a third possibility, which is "DXFDWG", given by
> https://trac.osgeo.org/gdal/wiki/DxfDwg, which I don't know how to use.

2) and 3) are the same option. You also likely need to contact ODA to get 
DWGdirect, if that still exists. And as written in the wiki, this driver is 
write-only.

> 
> What solution must be used for win32 compilation ?
> Is it possible to compile DWG driver within gdal 2.0.1 ?

Not easily it seems. The drivers may potentially also require code updates to 
build against current versions of the SDK if there are breaking changes since 
the time the driver was written. Their current state is unknown from the GDAL 
team (unless someone has updates)

Best regards,

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Jan 27 06:31:56 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 27 Jan 2016 15:31:56 +0100
Subject: [gdal-dev] Question about KML Lib
In-Reply-To: <CAEkoqGnMUL2zxa56D=7J3=bP2TGv5tSC4+Mwcjzadp-rKxW-4g@mail.gmail.com>
References: <CAEkoqGnMUL2zxa56D=7J3=bP2TGv5tSC4+Mwcjzadp-rKxW-4g@mail.gmail.com>
Message-ID: <201601271531.56283.even.rouault@spatialys.com>

Le mercredi 27 janvier 2016 13:26:22, Leonan Carvalho a écrit :
> Dear All,
> 
> I'd asked a question on GIS Starkexchange
> <http://gis.stackexchange.com/questions/177545/convert-kml-to-geojson-with-
> ogr2ogr-and-remove-kml-special-attributes> (
> http://gis.stackexchange.com/questions/177545/convert-kml-to-geojson-with-o
> gr2ogr-and-remove-kml-special-attributes) about a issue with KML convertion
> to GEOJSON(or other formats) . There you can find more tecnical
> information about it.
> It was proposed that I make the same question here in this list, so, to
> summarize I have the following scenario:
> 
> - I'm using GDAL 1.11.3 on Windows 10, released 09/16/2015
> - I'm exporting a KML for GeoJSON
> - I do not know the name of layers, or which fields are available.
> - I have no any special attributes in the schema but always is created
> these attributes:* Name,
> description,timestamp,begin,end,altitudeMode,tessellate,extrude,visibility,
> drawOrder,icon.* - I must keep only attributes present on schema.
> 
> 

Those fixed fields come from the KML structure itself and are exposed as OGR 
fields because it is convenient in some contexts. AFAICS there's no easy way of 
not exposing them. So you will likely have to do some scripting to list the 
available fields, remove the ones you don't want too, and build a SQL statement 
or use -select to select just the ones you're interested into.

> 
> I really appreciate if someone  help to clearance.
> 
> 
> (Excuse me for my awful English, I’m French !)
> 
> Best wishes,
> 
> 
> * José Leonan S. Carvalho*
> *Software Engineer*
> +55 22 9 99811 1411
> j.leonancarvalho at gmail.com
> www.leonancarvalho.com
> *skype: jleonancarvalho*
> *“Procurem deixar este mundo um pouco melhor do que o encontraram, e,
> quando chegar a hora de morrer, poderão morrer felizes sentindo que pelo
> menos não desperdiçaram o tempo e que procuraram fazer o melhor possível.*
> *Deste modo estejam “bem preparados” para viver felizes e para morrer
> felizes.”*
> * - Lord Baden-Powell of Gilwell *

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Wed Jan 27 07:48:45 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Wed, 27 Jan 2016 17:48:45 +0200
Subject: [gdal-dev] Support for measures
In-Reply-To: <201601271452.58488.even.rouault@spatialys.com>
References: <56A8A205.2020303@gmail.com>
 <201601271423.14595.even.rouault@spatialys.com> <56A8C83D.9080505@gmail.com>
 <201601271452.58488.even.rouault@spatialys.com>
Message-ID: <56A8E6DD.1080709@gmail.com>

The draft RFC is here

https://trac.osgeo.org/gdal/wiki/rfc61

Ari

27.01.2016, 15:52, Even Rouault kirjoitti:
> Le mercredi 27 janvier 2016 14:38:05, Ari Jolma a écrit :
>> 27.01.2016, 15:23, Even Rouault kirjoitti:
>>> Le mercredi 27 janvier 2016 14:01:42, Ari Jolma a écrit :
>>>> 27.01.2016, 14:34, Ari Jolma kirjoitti:
>>>>> 27.01.2016, 13:27, Even Rouault kirjoitti:
>>>>>> Le mercredi 27 janvier 2016 11:55:01, Ari Jolma a écrit :
>>>>>>> Folks,
>>>>>>>
>>>>>>> I'd like to try to implement the XYZM support since I have some free
>>>>>>> time.
>>>>>>>
>>>>>>> Before making a RFC, there are some thoughts/questions/ideas:
>>>>>>>
>>>>>>> * I made a fork for this work at https://github.com/ajolma/GDAL-XYZM
>>>>>>> so I can more easily use travis.
>>>>>>>
>>>>>>> * I think this is mainly changes in the geometry API and generic
>>>>>>> methods.
>>>>>>>
>>>>>>> Are there other drivers than shape, which are affected?
>>>>>> On top of my head: PostGIS, FileGDB, OpenFileGDB, GeoPackage,
>>>>>> Spatialite.
>>>>>> Probably other RDMBs too (Oracle, MSSQL, ... ?)
>>>>> I'm not so sure that it is so many. For example PostGIS driver is
>>>>> mostly moving WKB back and forth.
>>>> Well, it seems that they are affected. There is for example the
>>>> setCoordinateDimension() method, which is called by many drivers and
>>>> once measures are supported it becomes ambiguous since coordinate
>>>> dimension is 3 for both XYM and XYZ.
>>> I think we should perhaps keep setCoordinateDimension() with the current
>>> semantics for legacy reasons but not accept using 3 for XYM or extending
>>> it to 4 for XYZM
>> That's my thinking too. The semantics of the old API should be kept the
>> same.
> We should probably remove all its internal uses, and just have it used by
> OGR_G_SetCoordinateDimension(). And figure out what the behaviour should be
> when called on a XYM or XYZM geometry.
>
>> I'm thinking that there should perhaps be a new method
>> CoordinateDimension(), which would return the same as ST_NDims of
>> PostGIS. Actually the name of the method is CoordinateDimension()
>> (without get prefix) in simple feature access documents.
> Sounds reasonable.
>
>>> The OGRGeometry class could have for example a
>>> setCoordinateInterpretation() with an enum XY, XYZ, XYM and XYZM. And a
>>> similar member variable to store it.
>> set3D(boolean is3D) and setMeasured(boolean isMeasured)? As each
>> geometry could have boolean Is3D and IsMeasured properties, and the docs
>> have Is3D and IsMeasured methods.
> I think that if possible we should try to minimize the number of attributes in
> the base OGRGeometry class so that sizeof(OGRPoint) remains small. Having the
> geometry type stored would capture both the Is3D and IsMeasure. And  int
> nCoordDimension could then potentially be removed, except that we have hacks
> currently in OGRPoint : -2 = point 2D empty and -3 = point 3D empty.
> Actually, I'm thinking we don't need that hack and that checking if isnan(x)
> && isnan(y) could be sufficient to model a POINT EMPTY (this is what we do in
> OGRPoint::importFromWkb() to support the GeoPackage / PostGIS 2.2 way of
> representing a POINT EMPTY) and avoid storing an explicit (and hacked)
> nCoordDimension.
>
>>> ... or, as currently getGeometryType() dynamically builds the geometry
>>> type, perhaps have instead a wkbGeometryType member in OGRGeometry
>>> itself.
>>>
>>> And have a setGeometryType() to modify it, with restrictions on which
>>> kind of geometry type changes are allowed. You can't  do
>>> point.SetGeometryType(wkbLineString) )
>>>
>>> Actually instead of setGeometryType() , the way QGIS has done with its
>>> QgsAbstractGeometryV2 class, ie with explicit addZValues( double
>>> zInitValue ), addZValues( double zInitValue ), dropZValues(),
>>> dropMValues() could be a good inspiration.
>> I'll go through the API and prepare and post a proposal to discuss more.
>>
>> Ari
>>
>>>> Ari
>>>>
>>>>> Anyway, I'll look into the geometry API first.
>>>>>
>>>>> Ari


From even.rouault at spatialys.com  Wed Jan 27 07:51:48 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 27 Jan 2016 16:51:48 +0100
Subject: [gdal-dev] Support for measures
In-Reply-To: <56A8E6DD.1080709@gmail.com>
References: <56A8A205.2020303@gmail.com>
 <201601271452.58488.even.rouault@spatialys.com> <56A8E6DD.1080709@gmail.com>
Message-ID: <201601271651.48540.even.rouault@spatialys.com>

Le mercredi 27 janvier 2016 16:48:45, Ari Jolma a écrit :
> https://trac.osgeo.org/gdal/wiki/rfc61

Similarly to other RFCs, would you mind changing the URL to something more 
descriptive like 
https://trac.osgeo.org/gdal/wiki/rfc61_measured_geometries ?

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Jan 27 08:26:47 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 27 Jan 2016 17:26:47 +0100
Subject: [gdal-dev] Support for measures
In-Reply-To: <56A8E6DD.1080709@gmail.com>
References: <56A8A205.2020303@gmail.com>
 <201601271452.58488.even.rouault@spatialys.com> <56A8E6DD.1080709@gmail.com>
Message-ID: <201601271726.47452.even.rouault@spatialys.com>

Le mercredi 27 janvier 2016 16:48:45, Ari Jolma a écrit :
> The draft RFC is here
> 
> https://trac.osgeo.org/gdal/wiki/rfc61

My remarks:

1) #define OGR_G_xxxx

--> should that be rather (since the intent seems to be bitwise combination):
#define OGR_G_NOT_EMPTY 	0x1
#define OGR_G_3D 			0x2
#define OGR_G_MEASURED 	0x4

and I'd say put it ogr_geometry.h only as it is an internal implementation 
detail.

2) new OGRGeometry methods. I think Kurt would prefer using straight C++ bool 
type, but it is true we have used OGRBoolean for all other methods. So no 
strong opinion on this.

3) "New OGRwkbGeometryType values are needed". I assume you will use the SFSQL 
1.2 and ISO SQL/MM Part 3 way, ie. 2D type + 2000 for M and  2D type + 3000 
for ZM ? I'm also wondering if, as a provision, we shouldn't also add the Tin 
and PolyhedralSurface types for completness, even if unimplemented at that 
point. At least people would be warned that such beasts may appear at some 
point.

4) In the compatibility issues, we'd have to wonder if we need to make 
something special when a driver ICreateLayer() is called with a XYM/XYZM type 
and it is not ready for it. And same for ICreateFeature()/ISetFeature(). For 
curve geometries, I decided that curve aware drivers would expose a 
OLCCurveGeometries / ODsCCurveGeometries capability and that 
CreateLayer()/CreateFeature()/SetFeature() generic methods would convert types 
if needed before passing to the Ixxxx implementation method. Such technique 
could be reused here potentially.

> 
> Ari
> 
> 27.01.2016, 15:52, Even Rouault kirjoitti:
> > Le mercredi 27 janvier 2016 14:38:05, Ari Jolma a écrit :
> >> 27.01.2016, 15:23, Even Rouault kirjoitti:
> >>> Le mercredi 27 janvier 2016 14:01:42, Ari Jolma a écrit :
> >>>> 27.01.2016, 14:34, Ari Jolma kirjoitti:
> >>>>> 27.01.2016, 13:27, Even Rouault kirjoitti:
> >>>>>> Le mercredi 27 janvier 2016 11:55:01, Ari Jolma a écrit :
> >>>>>>> Folks,
> >>>>>>> 
> >>>>>>> I'd like to try to implement the XYZM support since I have some
> >>>>>>> free time.
> >>>>>>> 
> >>>>>>> Before making a RFC, there are some thoughts/questions/ideas:
> >>>>>>> 
> >>>>>>> * I made a fork for this work at
> >>>>>>> https://github.com/ajolma/GDAL-XYZM so I can more easily use
> >>>>>>> travis.
> >>>>>>> 
> >>>>>>> * I think this is mainly changes in the geometry API and generic
> >>>>>>> methods.
> >>>>>>> 
> >>>>>>> Are there other drivers than shape, which are affected?
> >>>>>> 
> >>>>>> On top of my head: PostGIS, FileGDB, OpenFileGDB, GeoPackage,
> >>>>>> Spatialite.
> >>>>>> Probably other RDMBs too (Oracle, MSSQL, ... ?)
> >>>>> 
> >>>>> I'm not so sure that it is so many. For example PostGIS driver is
> >>>>> mostly moving WKB back and forth.
> >>>> 
> >>>> Well, it seems that they are affected. There is for example the
> >>>> setCoordinateDimension() method, which is called by many drivers and
> >>>> once measures are supported it becomes ambiguous since coordinate
> >>>> dimension is 3 for both XYM and XYZ.
> >>> 
> >>> I think we should perhaps keep setCoordinateDimension() with the
> >>> current semantics for legacy reasons but not accept using 3 for XYM or
> >>> extending it to 4 for XYZM
> >> 
> >> That's my thinking too. The semantics of the old API should be kept the
> >> same.
> > 
> > We should probably remove all its internal uses, and just have it used by
> > OGR_G_SetCoordinateDimension(). And figure out what the behaviour should
> > be when called on a XYM or XYZM geometry.
> > 
> >> I'm thinking that there should perhaps be a new method
> >> CoordinateDimension(), which would return the same as ST_NDims of
> >> PostGIS. Actually the name of the method is CoordinateDimension()
> >> (without get prefix) in simple feature access documents.
> > 
> > Sounds reasonable.
> > 
> >>> The OGRGeometry class could have for example a
> >>> setCoordinateInterpretation() with an enum XY, XYZ, XYM and XYZM. And a
> >>> similar member variable to store it.
> >> 
> >> set3D(boolean is3D) and setMeasured(boolean isMeasured)? As each
> >> geometry could have boolean Is3D and IsMeasured properties, and the docs
> >> have Is3D and IsMeasured methods.
> > 
> > I think that if possible we should try to minimize the number of
> > attributes in the base OGRGeometry class so that sizeof(OGRPoint)
> > remains small. Having the geometry type stored would capture both the
> > Is3D and IsMeasure. And  int nCoordDimension could then potentially be
> > removed, except that we have hacks currently in OGRPoint : -2 = point 2D
> > empty and -3 = point 3D empty. Actually, I'm thinking we don't need that
> > hack and that checking if isnan(x) && isnan(y) could be sufficient to
> > model a POINT EMPTY (this is what we do in OGRPoint::importFromWkb() to
> > support the GeoPackage / PostGIS 2.2 way of representing a POINT EMPTY)
> > and avoid storing an explicit (and hacked) nCoordDimension.
> > 
> >>> ... or, as currently getGeometryType() dynamically builds the geometry
> >>> type, perhaps have instead a wkbGeometryType member in OGRGeometry
> >>> itself.
> >>> 
> >>> And have a setGeometryType() to modify it, with restrictions on which
> >>> kind of geometry type changes are allowed. You can't  do
> >>> point.SetGeometryType(wkbLineString) )
> >>> 
> >>> Actually instead of setGeometryType() , the way QGIS has done with its
> >>> QgsAbstractGeometryV2 class, ie with explicit addZValues( double
> >>> zInitValue ), addZValues( double zInitValue ), dropZValues(),
> >>> dropMValues() could be a good inspiration.
> >> 
> >> I'll go through the API and prepare and post a proposal to discuss more.
> >> 
> >> Ari
> >> 
> >>>> Ari
> >>>> 
> >>>>> Anyway, I'll look into the geometry API first.
> >>>>> 
> >>>>> Ari

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gane.prog at gmail.com  Wed Jan 27 09:00:37 2016
From: gane.prog at gmail.com (Gane R)
Date: Wed, 27 Jan 2016 22:30:37 +0530
Subject: [gdal-dev] US Survey Ft being used for a projection in PDF
Message-ID: <CALMrLdAhycCzY7jWvVyuritJvEZswq9Jubtjrf0ZvfeGtrwFCg@mail.gmail.com>

Here is a link to PDF
https://drive.google.com/file/d/0B4shTM1bPS5TaVZ2OWxxR0MtM2s/view?usp=sharing


I remember I got the US Ft unit fix for PDF driver from trunk.

So will that fix will be sufficient to handle PDFs with "US Survey Ft being
used for a projection"

Thanks
Gane
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160127/281ce19f/attachment.html>

From j.leonancarvalho at gmail.com  Wed Jan 27 09:19:21 2016
From: j.leonancarvalho at gmail.com (Leonan Carvalho)
Date: Wed, 27 Jan 2016 15:19:21 -0200
Subject: [gdal-dev] Question about KML Lib
In-Reply-To: <201601271531.56283.even.rouault@spatialys.com>
References: <CAEkoqGnMUL2zxa56D=7J3=bP2TGv5tSC4+Mwcjzadp-rKxW-4g@mail.gmail.com>
 <201601271531.56283.even.rouault@spatialys.com>
Message-ID: <CAEkoqGm7rN_BvPmhcwS7=jcZP75zqiudV4wro6M6XzGPy1VVXQ@mail.gmail.com>

Hi

I don't understand that is ogr function force the creation of these fields,
and if it does so, it should be possible to disable it or enable it through
settings and parameters. Am I wrong?
What I am avoiding is just extra work to analyze if these fields and having
to remove them when they were not set by the input file.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160127/cb0bc129/attachment.html>

From howard at hobu.co  Wed Jan 27 09:39:28 2016
From: howard at hobu.co (Howard Butler)
Date: Wed, 27 Jan 2016 11:39:28 -0600
Subject: [gdal-dev] Motions: Promote 1.11.4 RC2 and 2.0.2 RC4 for release
In-Reply-To: <loom.20160127T132105-233@post.gmane.org>
References: <201601271129.09484.even.rouault@spatialys.com>
 <loom.20160127T132105-233@post.gmane.org>
Message-ID: <C2934600-4A2D-4340-918C-79586FA7424B@hobu.co>


> On Jan 27, 2016, at 6:22 AM, Jukka Rahkonen <jukka.rahkonen at maanmittauslaitos.fi> wrote:
> 
> Even Rouault <even.rouault <at> spatialys.com> writes:
> 
>> 
>> Hi,
>> 
>> Motion 1: GDAL/OGR 1.11.4 RC2 is promoted to be the official 1.11.4 final 
>> release.
>> 
>> Motion 2: GDAL/OGR 2.0.2 RC4 is promoted to be the official 2.0.2 final
> release.
>> 
>> --
>> 
>> My votes :
>> Motion 1: + 1
>> Motion 2: + 1
> 
> My votes:
> 
> motion 1: +1
> motion 2: +1

motion 1: +1
motion 2: +1


From carandraug+dev at gmail.com  Wed Jan 27 09:42:19 2016
From: carandraug+dev at gmail.com (=?UTF-8?B?Q2FybsOrIERyYXVn?=)
Date: Wed, 27 Jan 2016 17:42:19 +0000
Subject: [gdal-dev] bug report -- cpl_config.h should not be installed
Message-ID: <CAPOrs_2wyokh-JYXbB16oQS=2=ThCiGRP4W-1az4iOZy7BzQyA@mail.gmail.com>

Hello

I am using an email instead of your bug tracker because the later requires
yet another account on another site (osgeo.org).

The bug is that cpl_config.h is installed and included from other gdal
public headers (at least cpl_port.h, not sure if also from others).
Why this is an issue is an autotools FAQ "Why should config.h not be
installed?" [1] which also explains how to fix it.  Unfortunately, the
link to the page that also explains why that is an issue is dead but it
can still be seen from the web archive [2].

You may not be affected by this issue until you try to make gdal work
with another project that has the same bug. Then definitions start to
collide.

Also, note that this was originally reported 9 years ago [3] and closed
as fixed (that doesn't look right to me).  The bug is still present.
The autoconf FAQ suggests a fix.

Carnë

[1] http://www.gnu.org/software/automake/faq/autotools-faq.html#Why-should-config_002eh-not-be-installed_003f
[2] http://web.archive.org/web/20100414095144/http://inaugust.com/post/68
[3] https://trac.osgeo.org/gdal/ticket/1589

From even.rouault at spatialys.com  Wed Jan 27 09:55:28 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 27 Jan 2016 18:55:28 +0100
Subject: [gdal-dev] bug report -- cpl_config.h should not be installed
In-Reply-To: <CAPOrs_2wyokh-JYXbB16oQS=2=ThCiGRP4W-1az4iOZy7BzQyA@mail.gmail.com>
References: <CAPOrs_2wyokh-JYXbB16oQS=2=ThCiGRP4W-1az4iOZy7BzQyA@mail.gmail.com>
Message-ID: <201601271855.28114.even.rouault@spatialys.com>

Le mercredi 27 janvier 2016 18:42:19, Carnë Draug a écrit :
> Hello
> 
> I am using an email instead of your bug tracker because the later requires
> yet another account on another site (osgeo.org).
> 
> The bug is that cpl_config.h is installed and included from other gdal
> public headers (at least cpl_port.h, not sure if also from others).
> Why this is an issue is an autotools FAQ "Why should config.h not be
> installed?" [1] which also explains how to fix it.  Unfortunately, the
> link to the page that also explains why that is an issue is dead but it
> can still be seen from the web archive [2].
> 
> You may not be affected by this issue until you try to make gdal work
> with another project that has the same bug. Then definitions start to
> collide.
> 
> Also, note that this was originally reported 9 years ago [3] and closed
> as fixed (that doesn't look right to me).  The bug is still present.
> The autoconf FAQ suggests a fix.

I don't think the issue is so easy to fix unfortunately. See 
https://trac.osgeo.org/gdal/ticket/4810 and 
https://trac.osgeo.org/gdal/ticket/4282

If it is, a patch is welcome (and even if it hard to fix, a patch is also even 
more welcome :-) )

A potential alternative solution that hasn't been mentionned in the tickets 
and I'm thinking of would be to have all the #define of cpl_config.h prefixed 
with CPL_ . Requires both changes in configure.in and source code that use 
those #define. 

> 
> Carnë
> 
> [1]
> http://www.gnu.org/software/automake/faq/autotools-faq.html#Why-should-con
> fig_002eh-not-be-installed_003f [2]
> http://web.archive.org/web/20100414095144/http://inaugust.com/post/68 [3]
> https://trac.osgeo.org/gdal/ticket/1589
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From carandraug+dev at gmail.com  Wed Jan 27 10:09:35 2016
From: carandraug+dev at gmail.com (=?UTF-8?B?Q2FybsOrIERyYXVn?=)
Date: Wed, 27 Jan 2016 18:09:35 +0000
Subject: [gdal-dev] bug report -- cpl_config.h should not be installed
In-Reply-To: <201601271855.28114.even.rouault@spatialys.com>
References: <CAPOrs_2wyokh-JYXbB16oQS=2=ThCiGRP4W-1az4iOZy7BzQyA@mail.gmail.com>
 <201601271855.28114.even.rouault@spatialys.com>
Message-ID: <CAPOrs_0H4GqQFBnytJ5vRr8nOd7-Mx1Xf0OzHxe25farq12Q4A@mail.gmail.com>

On 27 January 2016 at 17:55, Even Rouault <even.rouault at spatialys.com> wrote:
> Le mercredi 27 janvier 2016 18:42:19, Carnë Draug a écrit :
>> Hello
>>
>> I am using an email instead of your bug tracker because the later requires
>> yet another account on another site (osgeo.org).
>>
>> The bug is that cpl_config.h is installed and included from other gdal
>> public headers (at least cpl_port.h, not sure if also from others).
>> Why this is an issue is an autotools FAQ "Why should config.h not be
>> installed?" [1] which also explains how to fix it.  Unfortunately, the
>> link to the page that also explains why that is an issue is dead but it
>> can still be seen from the web archive [2].
>>
>> You may not be affected by this issue until you try to make gdal work
>> with another project that has the same bug. Then definitions start to
>> collide.
>>
>> Also, note that this was originally reported 9 years ago [3] and closed
>> as fixed (that doesn't look right to me).  The bug is still present.
>> The autoconf FAQ suggests a fix.
>
> I don't think the issue is so easy to fix unfortunately. See
> https://trac.osgeo.org/gdal/ticket/4810 and
> https://trac.osgeo.org/gdal/ticket/4282
>
> If it is, a patch is welcome (and even if it hard to fix, a patch is also even
> more welcome :-) )
>
> A potential alternative solution that hasn't been mentionned in the tickets
> and I'm thinking of would be to have all the #define of cpl_config.h prefixed
> with CPL_ . Requires both changes in configure.in and source code that use
> those #define.
>

But that is the solution provided in the autoconf faq that I linked [1].
It even suggests an autoconf macro in the autoconf archive that does
it.  The autoconf also suggests to create a separate header template
with only the macros that gdal really needs.

Carnë

[1] http://www.gnu.org/software/automake/faq/autotools-faq.html#Why-should-config_002eh-not-be-installed_003f
[2]

From jukka.rahkonen at maanmittauslaitos.fi  Wed Jan 27 12:20:13 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Wed, 27 Jan 2016 20:20:13 +0000 (UTC)
Subject: [gdal-dev] Maximum geometry size for JML driver
Message-ID: <loom.20160127T211232-402@post.gmane.org>

Hi,

I couldn't convert a dataset into JML format but got a message:

"Too much data inside one element. File probably corrupted". Message seems
to come from line 486 in
https://trac.osgeo.org/gdal/browser/trunk/gdal/ogr/
ogrsf_frmts/jml/ogrjmllayer.cpp.

My geometry is indeed quite big multipolygon with 185690 vertices and 9998
holes but it is a valid one and I can convert it into other formats with
GDAL if I start from shapefile.

I wonder what is the maximum amount of data inside an element and if the
limit could be rised with some option.

-Jukka Rahkonen-


From dmorissette at mapgears.com  Wed Jan 27 12:23:54 2016
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Wed, 27 Jan 2016 15:23:54 -0500
Subject: [gdal-dev] Motions: Promote 1.11.4 RC2 and 2.0.2 RC4 for release
In-Reply-To: <201601271129.09484.even.rouault@spatialys.com>
References: <201601271129.09484.even.rouault@spatialys.com>
Message-ID: <56A9275A.3050300@mapgears.com>

+1 on both.

Daniel

On 2016-01-27 5:29 AM, Even Rouault wrote:
> Hi,
>
> Motion 1: GDAL/OGR 1.11.4 RC2 is promoted to be the official 1.11.4 final
> release.
>
> Motion 2: GDAL/OGR 2.0.2 RC4 is promoted to be the official 2.0.2 final release.
>
> --
>
> My votes :
> Motion 1: + 1
> Motion 2: + 1
>
> Best regards,
>
>


-- 
Daniel Morissette
http://www.mapgears.com/
T: +1 418-696-5056 #201

http://evouala.com/ - Location Intelligence Made Easy

From even.rouault at spatialys.com  Wed Jan 27 12:36:19 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 27 Jan 2016 21:36:19 +0100
Subject: [gdal-dev] Maximum geometry size for JML driver
In-Reply-To: <loom.20160127T211232-402@post.gmane.org>
References: <loom.20160127T211232-402@post.gmane.org>
Message-ID: <201601272136.19782.even.rouault@spatialys.com>

Le mercredi 27 janvier 2016 21:20:13, Jukka Rahkonen a écrit :
> Hi,
> 
> I couldn't convert a dataset into JML format but got a message:
> 
> "Too much data inside one element. File probably corrupted". Message seems
> to come from line 486 in
> https://trac.osgeo.org/gdal/browser/trunk/gdal/ogr/
> ogrsf_frmts/jml/ogrjmllayer.cpp.
> 
> My geometry is indeed quite big multipolygon with 185690 vertices and 9998
> holes but it is a valid one and I can convert it into other formats with
> GDAL if I start from shapefile.
> 
> I wonder what is the maximum amount of data inside an element and if the
> limit could be rised with some option.

Hi Jukka,

could you provide the file or the source file used to generate it ? In theory, 
the driver should be able to process any valid file. The checks are meant to 
detect things like <veeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeery_loooooooong_tag_name> 
that could result in denial of service, but there must be something wrong. And 
you don't get that with GML where there are similar checks ?

Even

> 
> -Jukka Rahkonen-
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Wed Jan 27 13:46:29 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Wed, 27 Jan 2016 23:46:29 +0200
Subject: [gdal-dev] Support for measures
In-Reply-To: <201601271726.47452.even.rouault@spatialys.com>
References: <56A8A205.2020303@gmail.com>
 <201601271452.58488.even.rouault@spatialys.com> <56A8E6DD.1080709@gmail.com>
 <201601271726.47452.even.rouault@spatialys.com>
Message-ID: <56A93AB5.3010803@gmail.com>

27.01.2016, 18:26, Even Rouault kirjoitti:
> Le mercredi 27 janvier 2016 16:48:45, Ari Jolma a écrit :
>> The draft RFC is here
>>
>> https://trac.osgeo.org/gdal/wiki/rfc61

Changed to 
https://trac.osgeo.org/gdal/wiki/rfc61_support_for_measured_geometries

> My remarks:
>
> 1) #define OGR_G_xxxx
>
> --> should that be rather (since the intent seems to be bitwise combination):
> #define OGR_G_NOT_EMPTY 	0x1
> #define OGR_G_3D 			0x2
> #define OGR_G_MEASURED 	0x4
>
> and I'd say put it ogr_geometry.h only as it is an internal implementation
> detail.
>
> 2) new OGRGeometry methods. I think Kurt would prefer using straight C++ bool
> type, but it is true we have used OGRBoolean for all other methods. So no
> strong opinion on this.
>
> 3) "New OGRwkbGeometryType values are needed". I assume you will use the SFSQL
> 1.2 and ISO SQL/MM Part 3 way, ie. 2D type + 2000 for M and  2D type + 3000
> for ZM ? I'm also wondering if, as a provision, we shouldn't also add the Tin
> and PolyhedralSurface types for completness, even if unimplemented at that
> point. At least people would be warned that such beasts may appear at some
> point.
>
> 4) In the compatibility issues, we'd have to wonder if we need to make
> something special when a driver ICreateLayer() is called with a XYM/XYZM type
> and it is not ready for it. And same for ICreateFeature()/ISetFeature(). For
> curve geometries, I decided that curve aware drivers would expose a
> OLCCurveGeometries / ODsCCurveGeometries capability and that
> CreateLayer()/CreateFeature()/SetFeature() generic methods would convert types
> if needed before passing to the Ixxxx implementation method. Such technique
> could be reused here potentially.

These are now taken into account in the draft.

BTW, where can I find a comprehensive list of the wkb types? There is an 
old ISO SQL/MM Part 3 pdf in the web but it is old and seems to be 
incorrect too. libspatialite has a header file that has many but not all 
that ogr_core.h has.

Ari

>
>> Ari
>>
>> 27.01.2016, 15:52, Even Rouault kirjoitti:
>>> Le mercredi 27 janvier 2016 14:38:05, Ari Jolma a écrit :
>>>> 27.01.2016, 15:23, Even Rouault kirjoitti:
>>>>> Le mercredi 27 janvier 2016 14:01:42, Ari Jolma a écrit :
>>>>>> 27.01.2016, 14:34, Ari Jolma kirjoitti:
>>>>>>> 27.01.2016, 13:27, Even Rouault kirjoitti:
>>>>>>>> Le mercredi 27 janvier 2016 11:55:01, Ari Jolma a écrit :
>>>>>>>>> Folks,
>>>>>>>>>
>>>>>>>>> I'd like to try to implement the XYZM support since I have some
>>>>>>>>> free time.
>>>>>>>>>
>>>>>>>>> Before making a RFC, there are some thoughts/questions/ideas:
>>>>>>>>>
>>>>>>>>> * I made a fork for this work at
>>>>>>>>> https://github.com/ajolma/GDAL-XYZM so I can more easily use
>>>>>>>>> travis.
>>>>>>>>>
>>>>>>>>> * I think this is mainly changes in the geometry API and generic
>>>>>>>>> methods.
>>>>>>>>>
>>>>>>>>> Are there other drivers than shape, which are affected?
>>>>>>>> On top of my head: PostGIS, FileGDB, OpenFileGDB, GeoPackage,
>>>>>>>> Spatialite.
>>>>>>>> Probably other RDMBs too (Oracle, MSSQL, ... ?)
>>>>>>> I'm not so sure that it is so many. For example PostGIS driver is
>>>>>>> mostly moving WKB back and forth.
>>>>>> Well, it seems that they are affected. There is for example the
>>>>>> setCoordinateDimension() method, which is called by many drivers and
>>>>>> once measures are supported it becomes ambiguous since coordinate
>>>>>> dimension is 3 for both XYM and XYZ.
>>>>> I think we should perhaps keep setCoordinateDimension() with the
>>>>> current semantics for legacy reasons but not accept using 3 for XYM or
>>>>> extending it to 4 for XYZM
>>>> That's my thinking too. The semantics of the old API should be kept the
>>>> same.
>>> We should probably remove all its internal uses, and just have it used by
>>> OGR_G_SetCoordinateDimension(). And figure out what the behaviour should
>>> be when called on a XYM or XYZM geometry.
>>>
>>>> I'm thinking that there should perhaps be a new method
>>>> CoordinateDimension(), which would return the same as ST_NDims of
>>>> PostGIS. Actually the name of the method is CoordinateDimension()
>>>> (without get prefix) in simple feature access documents.
>>> Sounds reasonable.
>>>
>>>>> The OGRGeometry class could have for example a
>>>>> setCoordinateInterpretation() with an enum XY, XYZ, XYM and XYZM. And a
>>>>> similar member variable to store it.
>>>> set3D(boolean is3D) and setMeasured(boolean isMeasured)? As each
>>>> geometry could have boolean Is3D and IsMeasured properties, and the docs
>>>> have Is3D and IsMeasured methods.
>>> I think that if possible we should try to minimize the number of
>>> attributes in the base OGRGeometry class so that sizeof(OGRPoint)
>>> remains small. Having the geometry type stored would capture both the
>>> Is3D and IsMeasure. And  int nCoordDimension could then potentially be
>>> removed, except that we have hacks currently in OGRPoint : -2 = point 2D
>>> empty and -3 = point 3D empty. Actually, I'm thinking we don't need that
>>> hack and that checking if isnan(x) && isnan(y) could be sufficient to
>>> model a POINT EMPTY (this is what we do in OGRPoint::importFromWkb() to
>>> support the GeoPackage / PostGIS 2.2 way of representing a POINT EMPTY)
>>> and avoid storing an explicit (and hacked) nCoordDimension.
>>>
>>>>> ... or, as currently getGeometryType() dynamically builds the geometry
>>>>> type, perhaps have instead a wkbGeometryType member in OGRGeometry
>>>>> itself.
>>>>>
>>>>> And have a setGeometryType() to modify it, with restrictions on which
>>>>> kind of geometry type changes are allowed. You can't  do
>>>>> point.SetGeometryType(wkbLineString) )
>>>>>
>>>>> Actually instead of setGeometryType() , the way QGIS has done with its
>>>>> QgsAbstractGeometryV2 class, ie with explicit addZValues( double
>>>>> zInitValue ), addZValues( double zInitValue ), dropZValues(),
>>>>> dropMValues() could be a good inspiration.
>>>> I'll go through the API and prepare and post a proposal to discuss more.
>>>>
>>>> Ari
>>>>
>>>>>> Ari
>>>>>>
>>>>>>> Anyway, I'll look into the geometry API first.
>>>>>>>
>>>>>>> Ari


From even.rouault at spatialys.com  Wed Jan 27 14:05:36 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 27 Jan 2016 23:05:36 +0100
Subject: [gdal-dev] Support for measures
In-Reply-To: <56A93AB5.3010803@gmail.com>
References: <56A8A205.2020303@gmail.com>
 <201601271726.47452.even.rouault@spatialys.com> <56A93AB5.3010803@gmail.com>
Message-ID: <201601272305.36831.even.rouault@spatialys.com>

> 
> BTW, where can I find a comprehensive list of the wkb types? There is an
> old ISO SQL/MM Part 3 pdf in the web but it is old and seems to be
> incorrect too. libspatialite has a header file that has many but not all
> that ogr_core.h has.

I see I had linked
https://github.com/postgis/postgis/blob/svn-trunk/doc/bnf-wkb.txt
into
https://trac.osgeo.org/gdal/wiki/rfc49_curve_geometries

Also listed in http://portal.opengeospatial.org/files/?artifact_id=25355 (​
OpenGIS Simple Feature Access Part 1 : Common Architecture,v 1.2.1) , pages 
63-64.

Regarding your addition "ICreateLayer, which all(?) drivers implement,

--> no, there are many read-only drivers

" have geometry type as an argument. The method should call CPLError() with 
CPLE_NotSupported and return NULL if the driver does not support measures. 
Similarly for ICreateFeature and ISetFeature. ",

my point with adding the new capabilities was that drivers that wouldn't 
advertize the M capabilities would never see a M or ZM geometry / geometry 
type passed. See what the (non-virtual) methods 
OGRLayer::SetFeature(),CreateFeature() and GDALDataset::CreateLayer() do for 
curve geometries. Similar things could be done for M.


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From christian.urich at gmail.com  Thu Jan 28 00:07:20 2016
From: christian.urich at gmail.com (Christian Urich)
Date: Thu, 28 Jan 2016 19:07:20 +1100
Subject: [gdal-dev] Binary fields in Python
Message-ID: <917A867F-8DD8-4995-B33E-11BFE9D44BC2@gmail.com>

Hi,

I’m still running an older version of GDAL/OGR (1.11.3) and would like to access a binary field in python. 

It seems that GetFieldAsBinary is only available in version > 2.0 so I tried to access the data using GetFieldAsString. However the returned hex is cut off after 75 characters. Is there another why to access binary fields in python?

Christian



From ari.jolma at gmail.com  Thu Jan 28 00:23:47 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Thu, 28 Jan 2016 10:23:47 +0200
Subject: [gdal-dev] Support for measures
In-Reply-To: <201601272305.36831.even.rouault@spatialys.com>
References: <56A8A205.2020303@gmail.com>
 <201601271726.47452.even.rouault@spatialys.com> <56A93AB5.3010803@gmail.com>
 <201601272305.36831.even.rouault@spatialys.com>
Message-ID: <56A9D013.4060109@gmail.com>

28.01.2016, 00:05, Even Rouault kirjoitti:

Thanks for the pointer to the geometry codes in SF Common Architecture, 
somehow I overlooked it.

> my point with adding the new capabilities was that drivers that 
> wouldn't advertize the M capabilities would never see a M or ZM 
> geometry / geometry type passed. See what the (non-virtual) methods 
> OGRLayer::SetFeature(),CreateFeature() and GDALDataset::CreateLayer() 
> do for curve geometries. Similar things could be done for M. 

Hm. For example shape driver raises an error if the geometry type is not 
supported. I don't know what scenario would lead to that.

Assume that the user has data in GDAL with measures. She decides to save 
that using a driver, which does not support measures. The impact is that 
the measures are stripped out, which is ok if the data is discarded 
immediately after that but not if she wants to still do something with 
the measures. I'm not sure if documenting the side-effect is enough. 
However, the convert to non linear geometries is already there and this 
would follow that pattern. I guess this is a part of the bigger 
discussion whether we consider GDAL as a data storage for interactive 
tools for example or as a data processing library.

Ari


From even.rouault at spatialys.com  Thu Jan 28 00:48:21 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 28 Jan 2016 09:48:21 +0100
Subject: [gdal-dev] Support for measures
In-Reply-To: <56A9D013.4060109@gmail.com>
References: <56A8A205.2020303@gmail.com>
 <201601272305.36831.even.rouault@spatialys.com> <56A9D013.4060109@gmail.com>
Message-ID: <201601280948.21804.even.rouault@spatialys.com>

Le jeudi 28 janvier 2016 09:23:47, Ari Jolma a écrit :
> 28.01.2016, 00:05, Even Rouault kirjoitti:
> 
> Thanks for the pointer to the geometry codes in SF Common Architecture,
> somehow I overlooked it.
> 
> > my point with adding the new capabilities was that drivers that
> > wouldn't advertize the M capabilities would never see a M or ZM
> > geometry / geometry type passed. See what the (non-virtual) methods
> > OGRLayer::SetFeature(),CreateFeature() and GDALDataset::CreateLayer()
> > do for curve geometries. Similar things could be done for M.
> 
> Hm. For example shape driver raises an error if the geometry type is not
> supported. I don't know what scenario would lead to that.
> 
> Assume that the user has data in GDAL with measures. She decides to save
> that using a driver, which does not support measures. The impact is that
> the measures are stripped out, which is ok if the data is discarded
> immediately after that but not if she wants to still do something with
> the measures. I'm not sure if documenting the side-effect is enough.
> However, the convert to non linear geometries is already there and this
> would follow that pattern. I guess this is a part of the bigger
> discussion whether we consider GDAL as a data storage for interactive
> tools for example or as a data processing library.

I agree with you that it can discussed where the choice to convert data with 
loss must be done. I don't think this was raised during RFC 49 discussion. In 
the case of curve->geometry conversion, someone who cares about potential loss 
can query the driver capabilities : if they don't advertize curve support, 
then he knows that lossy conversion will occur.

> 
> Ari

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Jan 28 00:55:23 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 28 Jan 2016 09:55:23 +0100
Subject: [gdal-dev] Binary fields in Python
In-Reply-To: <917A867F-8DD8-4995-B33E-11BFE9D44BC2@gmail.com>
References: <917A867F-8DD8-4995-B33E-11BFE9D44BC2@gmail.com>
Message-ID: <201601280955.23354.even.rouault@spatialys.com>

Le jeudi 28 janvier 2016 09:07:20, Christian Urich a écrit :
> Hi,
> 
> I’m still running an older version of GDAL/OGR (1.11.3) and would like to
> access a binary field in python.
> 
> It seems that GetFieldAsBinary is only available in version > 2.0 so I
> tried to access the data using GetFieldAsString. However the returned hex
> is cut off after 75 characters. Is there another why to access binary
> fields in python?

None I can think of, apart backporting GetFieldAsBinary() to 1.11 if you can 
recompile (the Python bindings) from sources.

> 
> Christian
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From p.halls at york.ac.uk  Thu Jan 28 00:58:06 2016
From: p.halls at york.ac.uk (Peter Halls)
Date: Thu, 28 Jan 2016 08:58:06 +0000
Subject: [gdal-dev] Support for measures
In-Reply-To: <56A9D013.4060109@gmail.com>
References: <56A8A205.2020303@gmail.com>
 <201601271726.47452.even.rouault@spatialys.com>
 <56A93AB5.3010803@gmail.com>
 <201601272305.36831.even.rouault@spatialys.com>
 <56A9D013.4060109@gmail.com>
Message-ID: <CADEnnOOWv9Ru+DCrU_6F1V7iOw18tqvMzDSZhJvoGyTw=7f9yA@mail.gmail.com>

Ari, Even,

      one potential solution where M data are present but not supported by
the Geometry type would be to add M as a user defined attribute, as is done
for Z values in some drivers / packages.  This preserves both the geometry
integrity and the data.  Should the user wish to 'upgrade' the dataset to a
full xyzm structure at some future date, this is then their explicit
decision and can take proper account of format capabilities, etc.

       There may need to be a debate about what the replacement M attribute
be called, of course!

Best wishes,

Peter



On 28 January 2016 at 08:23, Ari Jolma <ari.jolma at gmail.com> wrote:

> 28.01.2016, 00:05, Even Rouault kirjoitti:
>
> Thanks for the pointer to the geometry codes in SF Common Architecture,
> somehow I overlooked it.
>
> my point with adding the new capabilities was that drivers that wouldn't
>> advertize the M capabilities would never see a M or ZM geometry / geometry
>> type passed. See what the (non-virtual) methods
>> OGRLayer::SetFeature(),CreateFeature() and GDALDataset::CreateLayer() do
>> for curve geometries. Similar things could be done for M.
>>
>
> Hm. For example shape driver raises an error if the geometry type is not
> supported. I don't know what scenario would lead to that.
>
> Assume that the user has data in GDAL with measures. She decides to save
> that using a driver, which does not support measures. The impact is that
> the measures are stripped out, which is ok if the data is discarded
> immediately after that but not if she wants to still do something with the
> measures. I'm not sure if documenting the side-effect is enough. However,
> the convert to non linear geometries is already there and this would follow
> that pattern. I guess this is a part of the bigger discussion whether we
> consider GDAL as a data storage for interactive tools for example or as a
> data processing library.
>
> Ari
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
----------------------------------------------------------------------------------------------------------------
Peter J Halls, PhD Student, Post-war Reconstruction and Development Unit
(PRDU),
                      University of York

Snail mail: PRDU, Derwent College, University of York,
                Heslington, York YO10 5DD
This message has the status of a private and personal communication
----------------------------------------------------------------------------------------------------------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160128/868730bb/attachment.html>

From even.rouault at spatialys.com  Thu Jan 28 01:04:33 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 28 Jan 2016 10:04:33 +0100
Subject: [gdal-dev] Support for measures
In-Reply-To: <CADEnnOOWv9Ru+DCrU_6F1V7iOw18tqvMzDSZhJvoGyTw=7f9yA@mail.gmail.com>
References: <56A8A205.2020303@gmail.com> <56A9D013.4060109@gmail.com>
 <CADEnnOOWv9Ru+DCrU_6F1V7iOw18tqvMzDSZhJvoGyTw=7f9yA@mail.gmail.com>
Message-ID: <201601281004.33821.even.rouault@spatialys.com>

Le jeudi 28 janvier 2016 09:58:06, Peter Halls a écrit :
> Ari, Even,
> 
>       one potential solution where M data are present but not supported by
> the Geometry type would be to add M as a user defined attribute, as is done
> for Z values in some drivers / packages.  This preserves both the geometry
> integrity and the data.  Should the user wish to 'upgrade' the dataset to a
> full xyzm structure at some future date, this is then their explicit
> decision and can take proper account of format capabilities, etc.
> 
>        There may need to be a debate about what the replacement M attribute
> be called, of course!

Peter,

This could only easily be done for a point geometry. For other geometries, it 
means storing several values per feature. Storing the source WKT would be an 
easy solution.

Something you could do with something like (provided the OGR<-->SQLite bridge, 
actually OGR<-->Spatialite blobs, is updated to support M)

ogr2ogr [....] poly.shp  -dialect sqlite \
            -sql "select *, st_astext(geometry) as wkt from poly"

Even

> 
> Best wishes,
> 
> Peter
> 
> On 28 January 2016 at 08:23, Ari Jolma <ari.jolma at gmail.com> wrote:
> > 28.01.2016, 00:05, Even Rouault kirjoitti:
> > 
> > Thanks for the pointer to the geometry codes in SF Common Architecture,
> > somehow I overlooked it.
> > 
> > my point with adding the new capabilities was that drivers that wouldn't
> > 
> >> advertize the M capabilities would never see a M or ZM geometry /
> >> geometry type passed. See what the (non-virtual) methods
> >> OGRLayer::SetFeature(),CreateFeature() and GDALDataset::CreateLayer() do
> >> for curve geometries. Similar things could be done for M.
> > 
> > Hm. For example shape driver raises an error if the geometry type is not
> > supported. I don't know what scenario would lead to that.
> > 
> > Assume that the user has data in GDAL with measures. She decides to save
> > that using a driver, which does not support measures. The impact is that
> > the measures are stripped out, which is ok if the data is discarded
> > immediately after that but not if she wants to still do something with
> > the measures. I'm not sure if documenting the side-effect is enough.
> > However, the convert to non linear geometries is already there and this
> > would follow that pattern. I guess this is a part of the bigger
> > discussion whether we consider GDAL as a data storage for interactive
> > tools for example or as a data processing library.
> > 
> > Ari
> > 
> > 
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From p.halls at york.ac.uk  Thu Jan 28 01:10:54 2016
From: p.halls at york.ac.uk (Peter Halls)
Date: Thu, 28 Jan 2016 09:10:54 +0000
Subject: [gdal-dev] Support for measures
In-Reply-To: <201601281004.33821.even.rouault@spatialys.com>
References: <56A8A205.2020303@gmail.com> <56A9D013.4060109@gmail.com>
 <CADEnnOOWv9Ru+DCrU_6F1V7iOw18tqvMzDSZhJvoGyTw=7f9yA@mail.gmail.com>
 <201601281004.33821.even.rouault@spatialys.com>
Message-ID: <CADEnnOO-hxkoSPyM-tNXtH0mhZmKzUXahv4ZjCB+kkoh=HWmKw@mail.gmail.com>

Even,

     agreed.  I guess I have become rather too embedded in Oracle these
days: any SQL method that supports blobs should provide the same.  The
bigger issue would be for those methods that cannot support blobs, arrays,
etc, where this wkt would be pretty much the only viable alternative.

Best wishes,

Peter

On 28 January 2016 at 09:04, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le jeudi 28 janvier 2016 09:58:06, Peter Halls a écrit :
> > Ari, Even,
> >
> >       one potential solution where M data are present but not supported
> by
> > the Geometry type would be to add M as a user defined attribute, as is
> done
> > for Z values in some drivers / packages.  This preserves both the
> geometry
> > integrity and the data.  Should the user wish to 'upgrade' the dataset
> to a
> > full xyzm structure at some future date, this is then their explicit
> > decision and can take proper account of format capabilities, etc.
> >
> >        There may need to be a debate about what the replacement M
> attribute
> > be called, of course!
>
> Peter,
>
> This could only easily be done for a point geometry. For other geometries,
> it
> means storing several values per feature. Storing the source WKT would be
> an
> easy solution.
>
> Something you could do with something like (provided the OGR<-->SQLite
> bridge,
> actually OGR<-->Spatialite blobs, is updated to support M)
>
> ogr2ogr [....] poly.shp  -dialect sqlite \
>             -sql "select *, st_astext(geometry) as wkt from poly"
>
> Even
>
> >
> > Best wishes,
> >
> > Peter
> >
> > On 28 January 2016 at 08:23, Ari Jolma <ari.jolma at gmail.com> wrote:
> > > 28.01.2016, 00:05, Even Rouault kirjoitti:
> > >
> > > Thanks for the pointer to the geometry codes in SF Common Architecture,
> > > somehow I overlooked it.
> > >
> > > my point with adding the new capabilities was that drivers that
> wouldn't
> > >
> > >> advertize the M capabilities would never see a M or ZM geometry /
> > >> geometry type passed. See what the (non-virtual) methods
> > >> OGRLayer::SetFeature(),CreateFeature() and GDALDataset::CreateLayer()
> do
> > >> for curve geometries. Similar things could be done for M.
> > >
> > > Hm. For example shape driver raises an error if the geometry type is
> not
> > > supported. I don't know what scenario would lead to that.
> > >
> > > Assume that the user has data in GDAL with measures. She decides to
> save
> > > that using a driver, which does not support measures. The impact is
> that
> > > the measures are stripped out, which is ok if the data is discarded
> > > immediately after that but not if she wants to still do something with
> > > the measures. I'm not sure if documenting the side-effect is enough.
> > > However, the convert to non linear geometries is already there and this
> > > would follow that pattern. I guess this is a part of the bigger
> > > discussion whether we consider GDAL as a data storage for interactive
> > > tools for example or as a data processing library.
> > >
> > > Ari
> > >
> > >
> > > _______________________________________________
> > > gdal-dev mailing list
> > > gdal-dev at lists.osgeo.org
> > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>



-- 
----------------------------------------------------------------------------------------------------------------
Peter J Halls, PhD Student, Post-war Reconstruction and Development Unit
(PRDU),
                      University of York

Snail mail: PRDU, Derwent College, University of York,
                Heslington, York YO10 5DD
This message has the status of a private and personal communication
----------------------------------------------------------------------------------------------------------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160128/4a777d68/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Thu Jan 28 01:33:49 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Thu, 28 Jan 2016 09:33:49 +0000 (UTC)
Subject: [gdal-dev] Maximum geometry size for JML driver
References: <loom.20160127T211232-402@post.gmane.org>
 <201601272136.19782.even.rouault@spatialys.com>
Message-ID: <loom.20160128T092321-51@post.gmane.org>

Even Rouault <even.rouault <at> spatialys.com> writes:

> Hi Jukka,
> 
> could you provide the file or the source file used to generate it ? In
theory, 
> the driver should be able to process any valid file. The checks are meant to 
> detect things like
<veeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeery_loooooooong_tag_name> 
> that could result in denial of service, but there must be something wrong.
And 
> you don't get that with GML where there are similar checks ?
> 
> Even


Hi,

I had a new look on the data and prepared a dataset for testing
http://latuviitta.org/downloads/big_polygon_jml.zip

The issue happens when GDAL reads JML file that is written by OpenJUMP.
There is no errors if I convert the data into JML format with ogr2ogr. Main
difference between those files is that GDAL writes the polygon geometry as
one line but OpenJUMP is writing it formatted with line breaks and lots of
white space

          <geometry>
                <gml:MultiPolygon>
                  <gml:polygonMember>
                  <gml:Polygon>
                    <gml:outerBoundaryIs>
                    <gml:LinearRing>
                      <gml:coordinates>193588.34496920794,7005684.6655854415 
                        193632.06812505925,7005834.808810625 
                        193608.4497544446,7005874.299165146 
....


-Jukka Rahkonen-




From even.rouault at spatialys.com  Thu Jan 28 01:42:14 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 28 Jan 2016 10:42:14 +0100
Subject: [gdal-dev] Maximum geometry size for JML driver
In-Reply-To: <loom.20160128T092321-51@post.gmane.org>
References: <loom.20160127T211232-402@post.gmane.org>
 <201601272136.19782.even.rouault@spatialys.com>
 <loom.20160128T092321-51@post.gmane.org>
Message-ID: <201601281042.14631.even.rouault@spatialys.com>

Le jeudi 28 janvier 2016 10:33:49, Jukka Rahkonen a écrit :
> Even Rouault <even.rouault <at> spatialys.com> writes:
> > Hi Jukka,
> > 
> > could you provide the file or the source file used to generate it ? In
> 
> theory,
> 
> > the driver should be able to process any valid file. The checks are meant
> > to detect things like
> 
> <veeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeery_loooooooong_tag_name>
> 
> > that could result in denial of service, but there must be something
> > wrong.
> 
> And
> 
> > you don't get that with GML where there are similar checks ?
> > 
> > Even
> 
> Hi,
> 
> I had a new look on the data and prepared a dataset for testing
> http://latuviitta.org/downloads/big_polygon_jml.zip

I downloaded it and don't see any issue. But it looks like it is the one 
written by GDAL

> 
> The issue happens when GDAL reads JML file that is written by OpenJUMP.
> There is no errors if I convert the data into JML format with ogr2ogr. Main
> difference between those files is that GDAL writes the polygon geometry as
> one line but OpenJUMP is writing it formatted with line breaks and lots of
> white space
> 
>           <geometry>
>                 <gml:MultiPolygon>
>                   <gml:polygonMember>
>                   <gml:Polygon>
>                     <gml:outerBoundaryIs>
>                     <gml:LinearRing>
>                      
> <gml:coordinates>193588.34496920794,7005684.6655854415
> 193632.06812505925,7005834.808810625
>                         193608.4497544446,7005874.299165146
> ....
> 
> 
> -Jukka Rahkonen-
> 
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Thu Jan 28 01:48:02 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Thu, 28 Jan 2016 09:48:02 +0000 (UTC)
Subject: [gdal-dev] Maximum geometry size for JML driver
References: <loom.20160127T211232-402@post.gmane.org>
 <201601272136.19782.even.rouault@spatialys.com>
 <loom.20160128T092321-51@post.gmane.org>
 <201601281042.14631.even.rouault@spatialys.com>
Message-ID: <loom.20160128T104605-836@post.gmane.org>

Even Rouault <even.rouault <at> spatialys.com> writes:


> I downloaded it and don't see any issue. But it looks like it is the one 
> written by GDAL

Oops, well, it is good to have reference data :) This is from OpenJUMP
http://latuviitta.org/downloads/KKK.zip

-Jukka-


From even.rouault at spatialys.com  Thu Jan 28 02:15:27 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 28 Jan 2016 11:15:27 +0100
Subject: [gdal-dev] Maximum geometry size for JML driver
In-Reply-To: <loom.20160128T104605-836@post.gmane.org>
References: <loom.20160127T211232-402@post.gmane.org>
 <201601281042.14631.even.rouault@spatialys.com>
 <loom.20160128T104605-836@post.gmane.org>
Message-ID: <201601281115.27912.even.rouault@spatialys.com>

Le jeudi 28 janvier 2016 10:48:02, Jukka Rahkonen a écrit :
> Even Rouault <even.rouault <at> spatialys.com> writes:
> > I downloaded it and don't see any issue. But it looks like it is the one
> > written by GDAL
> 
> Oops, well, it is good to have reference data :) This is from OpenJUMP
> http://latuviitta.org/downloads/KKK.zip

Fixed per https://trac.osgeo.org/gdal/ticket/6338

> 
> -Jukka-
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Thu Jan 28 06:09:06 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Thu, 28 Jan 2016 16:09:06 +0200
Subject: [gdal-dev] Call for discussion about RFC 61: Support for measures
	in geometries
Message-ID: <56AA2102.9030102@gmail.com>

Folks, especially the PSC,

I'd like to call for discussion about RFC 61: Adding support for 
measures in geometries.

Measures (M) are a sort of fourth coordinate for points in geometries. A 
typical use of measures is for distance from origin in line strings that 
represent roads but they can be used for other things as well.

Measures are a part of the simple features model and they are supported 
by many vector data formats.

Since measures are a rather fundamental element, adding them will 
require quite many changes into the basic building blocks of the GDAL 
API. Most importantly, the 'int nCoordDimension' property of OGRGeometry 
is proposed to be replaced by 'int flags', which will have bit flags 
denoting whether the geometry is empty and has Z or M coordinates.

No backwards incompatible changes (syntactic nor semantic) will be done 
but the methods getCoordinateDimension and setCoordinateDimension will 
be deprecated since they do not take into account M coordinate.

The RFC is as usual in the wiki:

https://trac.osgeo.org/gdal/wiki/rfc61_support_for_measured_geometries

There are a couple of decisions to be made (if the overall decision is 
positive).

Should the set3D(b3D) method (and also for example AddGeometry method) 
of GeometryCollection force all child geometries to be 3D (or 2D and 
remove possible Z values)? Maybe just unsetting the flag when 
downgrading is enough?

Should storing data, with measures, into a format, which does not 
support measures, remove M values from the data? This would be similar 
to the current behavior with curved geometries and formats which do not 
support them.

Some smaller issues are mentioned/hinted to in the draft RFC.

I have set up a github repository for the work at

https://github.com/ajolma/GDAL-XYZM

It has an associated travis builder - which however seems to have some 
problems right now. I have committed the API changes from the draft RFC 
and it compiles but there is a lot to do with actually implementing the 
support.

Best regards,

Ari


From even.rouault at spatialys.com  Thu Jan 28 06:46:50 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 28 Jan 2016 15:46:50 +0100
Subject: [gdal-dev] Call for discussion about RFC 61: Support for
	measures in geometries
In-Reply-To: <56AA2102.9030102@gmail.com>
References: <56AA2102.9030102@gmail.com>
Message-ID: <201601281546.50733.even.rouault@spatialys.com>

Le jeudi 28 janvier 2016 15:09:06, Ari Jolma a écrit :
> Folks, especially the PSC,
> 
> I'd like to call for discussion about RFC 61: Adding support for
> measures in geometries.

Thanks for leading the effort.

> 
> Measures (M) are a sort of fourth coordinate for points in geometries. A
> typical use of measures is for distance from origin in line strings that
> represent roads but they can be used for other things as well.
> 
> Measures are a part of the simple features model and they are supported
> by many vector data formats.
> 
> Since measures are a rather fundamental element, adding them will
> require quite many changes into the basic building blocks of the GDAL
> API. Most importantly, the 'int nCoordDimension' property of OGRGeometry
> is proposed to be replaced by 'int flags', which will have bit flags
> denoting whether the geometry is empty and has Z or M coordinates.
> 
> No backwards incompatible changes (syntactic nor semantic) will be done
> but the methods getCoordinateDimension and setCoordinateDimension will
> be deprecated since they do not take into account M coordinate.
> 
> The RFC is as usual in the wiki:
> 
> https://trac.osgeo.org/gdal/wiki/rfc61_support_for_measured_geometries

"Currently hacks such as nCoordDimension == -2 are used to denote empty 
geometries" --> to be pedantic, this is only true for point. Other geometry 
types don't need that since they are containers/vectors and if the 
container/vector size is 0, it means empty.

I suppose you intend upgrading the WKT&WKB importer&exporter ?

I think that beyond retrofitting drivers to avoid using 
setCoordinateDimension(), it would be good to have at least one driver 
implementing M reading/writing to validate that the RFC is operational : 
shapefile ?

> 
> There are a couple of decisions to be made (if the overall decision is
> positive).
> 
> Should the set3D(b3D) method (and also for example AddGeometry method)
> of GeometryCollection force all child geometries to be 3D (or 2D and
> remove possible Z values)? Maybe just unsetting the flag when
> downgrading is enough?

I had let an inline comment in the RFC regarding that. My opinion is that 
child geometries should be affected to avoid building geometries that are odd, 
and perhaps non conformant (should be checked but I'd be surprised it is legal 
to have the container and the containee with different coordinate dimensions. 
At least it cause problems in practice). On WKB/WKT import, we are curently 
lax, which is OK, and we accept mixed coordinate dimensions, but we upgrade 
the whole geometry to full XYZ as soon as the container or a containee is XYZ. 
On export (actually, when building OGRGeometry instances), we should be more 
strict.

> 
> Should storing data, with measures, into a format, which does not
> support measures, remove M values from the data? This would be similar
> to the current behavior with curved geometries and formats which do not
> support them.
> 
> Some smaller issues are mentioned/hinted to in the draft RFC.

I'd like to see mentionned what we do when GEOS operations are involved. And I 
think the answer is "strip off the M coordinate"

Similarly when installing a spatial filter. The current generic implementation 
(and probably most specialized implementations, the one in PostgreSQL driver 
for example) are 2D only. So a M component from a XYM / XYZM filter geometry 
would be ignored similarly to a Z component.

We have currently OGRGeometry and OGRLayer::GetExtent() & GetExtent3D() 
methods, and OGREnvelope / OGREnvelope3D classes. Should we have something for 
M ? I don't think it is really needed (or make sense at all, depending on what 
is encoded in the M coordinate). Shapefiles store however the min/max M value 
in its header

> 
> I have set up a github repository for the work at
> 
> https://github.com/ajolma/GDAL-XYZM
> 
> It has an associated travis builder - which however seems to have some
> problems right now. I have committed the API changes from the draft RFC
> and it compiles but there is a lot to do with actually implementing the
> support.

It does not have problem from what I can see. Just that the error log is a bit 
hard to decypher because of parallel compilation and thus errors are not 
necessarily reported at the bottom. If you look for "error: ", you will see:

ogrgeometry.cpp:838:47: error: unused parameter 'nNewDimension'

      [-Werror,-Wunused-parameter]

void OGRGeometry::setCoordinateDimension( int nNewDimension )

                                              ^

When you compile locally, you can use 'make USER_DEFS="-Werror"' to catch most 
of these (other errors may still be reported by other compilers used in the 
other Travis configs after it has been committed to SVN)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gane.prog at gmail.com  Thu Jan 28 06:51:54 2016
From: gane.prog at gmail.com (Gane R)
Date: Thu, 28 Jan 2016 20:21:54 +0530
Subject: [gdal-dev] PDF Projection support
Message-ID: <CALMrLdBQmGHazVXZ2RSGNnEEcZ69X-pfrJ7-xCAi0CNac2d3vA@mail.gmail.com>

Here is a link for the PDF
https://drive.google.com/file/d/0B4shTM1bPS5TaVZ2OWxxR0MtM2s/view?usp=sharing

and the gdalinfo is as follows, Does this projection is supported by the
PDF driver.

Driver: PDF/Geospatial PDF
Files:Plant_GIS_ANSI_D_View4_Treatment_50Scale.pdf
Size is 5100, 3300
Coordinate System is:
PROJCS["unnamed",
    GEOGCS["unknown",
        DATUM["NAD_1983_2011",
            SPHEROID["GRS_1980",6378137,298.257222101],
            TOWGS84[-0.9738,1.9453,0.5486,0,0,0,0]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",24.33333333333333],
    PARAMETER["central_meridian",-82],
    PARAMETER["scale_factor",0.9999411764705882],
    PARAMETER["false_easting",200000],
    PARAMETER["false_northing",0],
    UNIT["Meter",1]]
GeoTransform =
  199522.582988026, 0.07895862924306769, 0.06393943724398152
  305449.4714977542, 0.06393943724398152, -0.07895862924306769
Metadata:
  CREATION_DATE=D:20160113122026-05'00'
  CREATOR=Esri ArcMap 10.3.0.4322
  NEATLINE=POLYGON ((200064.22163200931
305474.83433632617,199733.36708641629 305206.91360799421,199538.33690883874
305447.75581972388,199869.19145443285 305715.67654805584,200064.22163200931
305474.83433632617))
  PRODUCER=TerraGo Technologies Publisher for ArcGIS GeoPDF Export version:
6.8.2.100
Corner Coordinates:
Upper Left  (  199522.583,  305449.471) ( 82d 0'17.33"W, 27d 5'26.39"N)
Lower Left  (  199733.583,  305188.908) ( 82d 0' 9.67"W, 27d 5'17.93"N)
Upper Right (  199925.272,  305775.563) ( 82d 0' 2.71"W, 27d 5'36.99"N)
Lower Right (  200136.272,  305514.999) ( 81d59'55.05"W, 27d 5'28.52"N)
Center      (  199829.428,  305482.235) ( 82d 0' 6.19"W, 27d 5'27.46"N)
Band 1 Block=5100x1 Type=Byte, ColorInterp=Red
Band 2 Block=5100x1 Type=Byte, ColorInterp=Green
Band 3 Block=5100x1 Type=Byte, ColorInterp=Blue

Thanks
Gane
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160128/02f0984c/attachment.html>

From even.rouault at spatialys.com  Thu Jan 28 09:04:46 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 28 Jan 2016 18:04:46 +0100
Subject: [gdal-dev] EPSG:2065 / South-oriented Krovak support (Czech friends
	thoughts wanted !)
Message-ID: <201601281804.46908.even.rouault@spatialys.com>

Hi,

I'm having a look at the following all related issues :
https://trac.osgeo.org/postgis/ticket/1940
https://trac.osgeo.org/proj/ticket/185
https://trac.osgeo.org/gdal/ticket/4762

related to EPSG:2065 support, ie "S-JTSK (Ferro) / Krovak". There's an issue 
about the datum shift used, but that's an easy one compared to a more serious 
one regarding axis order.

The proj.4 krovak method expects the first value of a coordinate pair to be a 
easting, and the second value a northing. Whereas original Krovak (EPSG:2065) 
is supposed to be southing first, westing second.

https://trac.osgeo.org/gdal/ticket/4762 suggests to add a "+to_meter=-1" 
parameter. Which means that the coordinates supplied are first westing, second 
southing (instead of "+to_meter=-1", a cleaner equivalent way is to use 
"+axis=wsu", meaning westing,southing,up )
But EPSG would mandate southing,westing.

But admitedly, for less exotic coordinate systems with official EPSG axis order 
latitude,longitude (EPSG:4326...) or northing,easting (some Finland projected 
CRS for example) we have never introduced in GDAL WKT or proj.4 strings the 
+axis option, and the application/user does the coordinate switch itself 
before passing that to GDAL/proj.

So, does that sound OK that a user providing coordinates advertized to be in 
EPSG:2065 does that in westing, southing order ? Or was this something 
particular to this user ? (I'd note that the dataset mentionned in the ticket 
is a GML resulting from a WFS server, and we all know the axis ordering issues 
related to WFS)

What a mess... 
(Using EPSG:5221 which is the easting, northing variant avoids those 
headaches)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From dmfenton at gmail.com  Thu Jan 28 14:16:12 2016
From: dmfenton at gmail.com (Daniel Fenton)
Date: Thu, 28 Jan 2016 22:16:12 +0000
Subject: [gdal-dev] Streaming Parser for OGR GeoJSON Driver
In-Reply-To: <201601271157.15425.even.rouault@spatialys.com>
References: <CAHmEjOXtF5v8xx+vG7W6_97TM4Y7_X5C8u8F3sHvVQOpPGJJYA@mail.gmail.com>
 <201601271157.15425.even.rouault@spatialys.com>
Message-ID: <CAHmEjOXqrrxOaQys+Nbqz9bFSRZGYNRBrZ1wYz18_Z9DZtg-qg@mail.gmail.com>

Thanks for your reply Even. Very helpful!

>I'm not a JS programmer, nevertheless I tried to understand
https://github.com/koopjs/GeoXForm/blob/master/src/lib/vrt.js, and you seem
to
group GeoJSON Feature objects by batch of 5000 (*) , put them in a temp
.json
file, and assemble all the JSon files in a VRT that looks like the
following,
right ?

That's correct.

> Just wanted to warn that creating layers of the same name is more or less
undefined behaviour and the way ogr2ogr will handle that is also
unspecified.
You're quite lucky this works. Actually from what I see it will use only the
layer definition of the first tmp1.json and ignore any potential additional
fields of the following fields."

Perhaps it works because I am only appending to a single layer that has the
same schema throughout?

My full command looks like:
`--config SHAPE_ENCODING UTF-8 -f "ESRI Shapefile" ./dummy layer.vrt -nlt
POINT -fieldmap identity -append -lco ENCODING=UTF-8'`

> A cleaner solution would be to use a <OGRVRTUnionLayer> to wrap all the
<OVRTVRTLayer> (see http://www.gdal.org/drv_vrt.html), but this would
perhaps
have bad performance due to a first pass being done to established the
union'ed
layer definition from the individual sources.

I did test this, but the performance was indeed slower. Is there a way for
me to specify the schema before-hand and avoid a full first pass?

Perhaps for a driver implementation with a streaming parser, I could write
a vrt before hand, then pipe in GeoJSON that matches that schema?

>  potential solution would be to buffer let's say
the first MB of features and build the layer definition from it

That's pretty close to what I'm doing with this block:
https://github.com/koopjs/GeoXForm/blob/master/src/lib/vrt.js#L56-L65

I'm sampling the first batch of geojson and am using it to build up
parameters with this function:
https://github.com/koopjs/GeoXForm/blob/master/src/lib/ogr-cmd.js.

> (*) It looks like you manage to separate JSon Feature objects with just
string
spliting on ',{' pattern ?

It is indeed fragile. It works well for my use-case (and is faster than
parsing) because I'm creating all the geojson. But it doesn't extend well
for others, so I've replaced it with a true streaming parser. Thanks for
the feedback.




On Wed, Jan 27, 2016 at 5:57 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
> >
> > I’m curious if anyone has ideas or advice on how to use a streaming
> parser
> > in the OGR GeoJSON driver.
> >
>
> A streaming parser, or at least something not requiring full ingestion in
> memory of a geojson file, is something that would indeed solve issues that
> people run into with the current driver on big files (let's say several
> hundreds of megabytes or more)
>
> >
> > My use-case is that I need to convert arbitrarily-sized streams of
> geojson
> > into other formats (e.g. Csv, shapefile, kml, etc).
> >
> >
> > My current strategy is to first partition the GeoJSON into a VRT file and
> > then call OGR. This works for arbitrary sized streams, but  it’s
> > inefficient because the process is blocked until the entire VRT is ready.
> > You can see my implementation here: https://github.com/koopjs/GeoXForm.
>
> I'm not a JS programmer, nevertheless I tried to understand
> https://github.com/koopjs/GeoXForm/blob/master/src/lib/vrt.js, and you
> seem to
> group GeoJSON Feature objects by batch of 5000 (*) , put them in a temp
> .json
> file, and assemble all the JSon files in a VRT that looks like the
> following,
> right ?
>
> <OGRVRTDataSource>
>     <OGRVRTLayer name="OGRGeoJSON">
>         <SrcDataSource>tmp1.json</SrcDataSource>
>     </OGRVRTLayer>
>     <OGRVRTLayer name="OGRGeoJSON">
>         <SrcDataSource>tmp2.json</SrcDataSource>
>     </OGRVRTLayer>
> </OGRVRTDataSource>
>
> Just wanted to warn that creating layers of the same name is more or less
> undefined behaviour and the way ogr2ogr will handle that is also
> unspecified.
> You're quite lucky this works. Actually from what I see it will use only
> the
> layer definition of the first tmp1.json and ignore any potential additional
> fields of the following fields.
>
> A cleaner solution would be to use a <OGRVRTUnionLayer> to wrap all the
> <OVRTVRTLayer> (see http://www.gdal.org/drv_vrt.html), but this would
> perhaps
> have bad performance due to a first pass being done to established the
> union'ed
> layer definition from the individual sources.
>
> >
> >
> > I noticed that there exists at least one C library for parsing son
> streams:
> > https://github.com/lloyd/yajl, but I do not know enough C++ (or C for
> that
> > matter) to integrate it.
> >
> >
> > Has anyone considered this approach before? Any advice on how to
> implement
> > it?
>
> One tricky point is to establish the layer definition (ie identifying the
> fields/properties). Currently the driver does a first pass to build the
> schema
> by examining the properties of each Feature object and unioning them, and
> then
> a second one to build the OGRFeature objects
>
> With a JSon streaming parsing library, when operating on a file on which
> you
> can seek arbitrarily, a similar strategy could be applied. From the point
> of
> view of the user, nothing would be changed except that there would be no
> longer any limit to the size of the files that can be processed
> But when operating on the input stream that you cannot rewind, this 2 pass
> strategy becomes a problem. A potential solution would be to buffer let's
> say
> the first MB of features and build the layer definition from it, assuming
> that
> next features will follow the same schema (and if not ignore the extra
> attributes). Or introduce the concept of non fixed schema (ie the schema
> would
> evolve when you iterate over the features) in OGR, but this would have
> broader
> implications.
>
> Even
>
> (*) It looks like you manage to separate JSon Feature objects with just
> string
> spliting on ',{' pattern ? That looks extremelly fragile to additional
> space
> characters, or complex properties inside a Feature object, like
>
> { "type": "Feature", "properties": { "prop": [ {"foo":"bar"},{"bar":"baz"}
> ]
> }, "geometry": null }
>
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160128/9b14594c/attachment.html>

From ari.jolma at gmail.com  Thu Jan 28 22:28:52 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Fri, 29 Jan 2016 08:28:52 +0200
Subject: [gdal-dev] Call for discussion about RFC 61: Support for
 measures in geometries
In-Reply-To: <201601281546.50733.even.rouault@spatialys.com>
References: <56AA2102.9030102@gmail.com>
 <201601281546.50733.even.rouault@spatialys.com>
Message-ID: <56AB06A4.4030105@gmail.com>

28.01.2016, 16:46, Even Rouault kirjoitti:
> "Currently hacks such as nCoordDimension == -2 are used to denote empty
> geometries" --> to be pedantic, this is only true for point. Other geometry
> types don't need that since they are containers/vectors and if the
> container/vector size is 0, it means empty.

Yes. Removing nCoordDimension and replacing it with the three flags 
(empty, Z, M) within an int is to keep the size of the geometry objects 
small, so it is not directly a consequence of having measures.

But in general I think it is a positive thing to have an explicit 
indicator of an empty geometry.

>
> I suppose you intend upgrading the WKT&WKB importer&exporter ?

Sure. They are pretty central to the whole issue. I'll work on those 
since with them some tests can be set up.

>
> I think that beyond retrofitting drivers to avoid using
> setCoordinateDimension(), it would be good to have at least one driver
> implementing M reading/writing to validate that the RFC is operational :
> shapefile ?

To have shape and pg drivers to support M is or has been my concern for 
years.

>
>> There are a couple of decisions to be made (if the overall decision is
>> positive).
>>
>> Should the set3D(b3D) method (and also for example AddGeometry method)
>> of GeometryCollection force all child geometries to be 3D (or 2D and
>> remove possible Z values)? Maybe just unsetting the flag when
>> downgrading is enough?
> I had let an inline comment in the RFC regarding that. My opinion is that
> child geometries should be affected to avoid building geometries that are odd,
> and perhaps non conformant (should be checked but I'd be surprised it is legal
> to have the container and the containee with different coordinate dimensions.
> At least it cause problems in practice). On WKB/WKT import, we are curently
> lax, which is OK, and we accept mixed coordinate dimensions, but we upgrade
> the whole geometry to full XYZ as soon as the container or a containee is XYZ.
> On export (actually, when building OGRGeometry instances), we should be more
> strict.

The flags should be the definitive indicators but I was entertaining the 
idea that maybe XYZ data could be put into a collection without 
physically removing the Z so it would be available later if it is needed 
for some reason. Maybe that kind of behavior should not be 
there/advertised and users should be given simple rules when Z or M 
can't be expected to exist any more.

>
>> Should storing data, with measures, into a format, which does not
>> support measures, remove M values from the data? This would be similar
>> to the current behavior with curved geometries and formats which do not
>> support them.
>>
>> Some smaller issues are mentioned/hinted to in the draft RFC.
> I'd like to see mentionned what we do when GEOS operations are involved. And I
> think the answer is "strip off the M coordinate"
>
> Similarly when installing a spatial filter. The current generic implementation
> (and probably most specialized implementations, the one in PostgreSQL driver
> for example) are 2D only. So a M component from a XYM / XYZM filter geometry
> would be ignored similarly to a Z component.
>
> We have currently OGRGeometry and OGRLayer::GetExtent() & GetExtent3D()
> methods, and OGREnvelope / OGREnvelope3D classes. Should we have something for
> M ? I don't think it is really needed (or make sense at all, depending on what
> is encoded in the M coordinate). Shapefiles store however the min/max M value
> in its header

Thanks, these issues need to be added to the RFC. My opinion is probably 
the same as above. Simple rules, which tell when Z and/or M will be 
stripped of, are good.

>
>> I have set up a github repository for the work at
>>
>> https://github.com/ajolma/GDAL-XYZM
>>
>> It has an associated travis builder - which however seems to have some
>> problems right now. I have committed the API changes from the draft RFC
>> and it compiles but there is a lot to do with actually implementing the
>> support.
> It does not have problem from what I can see. Just that the error log is a bit
> hard to decypher because of parallel compilation and thus errors are not
> necessarily reported at the bottom. If you look for "error: ", you will see:
>
> ogrgeometry.cpp:838:47: error: unused parameter 'nNewDimension'
>
>        [-Werror,-Wunused-parameter]
>
> void OGRGeometry::setCoordinateDimension( int nNewDimension )
>
>                                                ^
>
> When you compile locally, you can use 'make USER_DEFS="-Werror"' to catch most
> of these (other errors may still be reported by other compilers used in the
> other Travis configs after it has been committed to SVN)

Thanks.

I let this be a discussion item for some time now. There may still be 
other issues, which we have not thought about yet.

Ari

>
> Even
>


From ari.jolma at gmail.com  Thu Jan 28 23:55:37 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Fri, 29 Jan 2016 09:55:37 +0200
Subject: [gdal-dev] OGRPoint: fundamentals
Message-ID: <56AB1AF9.5030307@gmail.com>

A question about OGRPoint.

There are copy constructor, assignment, and clone. Shouldn't these do 
basically the same thing but with a bit different syntax? By the same 
thing I mean that the new point or assignee should have the same flags 
(is_empty, is_3D, is_measured), same coordinate values, and same spatial 
reference?

Also, by the current implementation there is a difference between an 
empty 2D point and empty 3D point. I wonder if this distinction is 
really relied upon someplace?

Ari


From ari.jolma at gmail.com  Fri Jan 29 00:54:12 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Fri, 29 Jan 2016 10:54:12 +0200
Subject: [gdal-dev] OGRPoint: fundamentals
In-Reply-To: <56AB1AF9.5030307@gmail.com>
References: <56AB1AF9.5030307@gmail.com>
Message-ID: <56AB28B4.4000408@gmail.com>



29.01.2016, 09:55, Ari Jolma kirjoitti:
> A question about OGRPoint.
>
> There are copy constructor, assignment, and clone. Shouldn't these do 
> basically the same thing but with a bit different syntax? By the same 
> thing I mean that the new point or assignee should have the same flags 
> (is_empty, is_3D, is_measured), same coordinate values, and same 
> spatial reference?
>
> Also, by the current implementation there is a difference between an 
> empty 2D point and empty 3D point. I wonder if this distinction is 
> really relied upon someplace?

A comment on this. For example WKT "POINT Z EMPTY" is legal and 
documented, so the distinction is significant.

>
> Ari
>


From even.rouault at spatialys.com  Fri Jan 29 01:04:51 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 29 Jan 2016 10:04:51 +0100
Subject: [gdal-dev] Call for discussion about RFC 61: Support for
	measures in geometries
In-Reply-To: <56AB06A4.4030105@gmail.com>
References: <56AA2102.9030102@gmail.com>
 <201601281546.50733.even.rouault@spatialys.com> <56AB06A4.4030105@gmail.com>
Message-ID: <201601291004.51450.even.rouault@spatialys.com>

> > I had let an inline comment in the RFC regarding that. My opinion is that
> > child geometries should be affected to avoid building geometries that are
> > odd, and perhaps non conformant (should be checked but I'd be surprised
> > it is legal to have the container and the containee with different
> > coordinate dimensions. At least it cause problems in practice). On
> > WKB/WKT import, we are curently lax, which is OK, and we accept mixed
> > coordinate dimensions, but we upgrade the whole geometry to full XYZ as
> > soon as the container or a containee is XYZ. On export (actually, when
> > building OGRGeometry instances), we should be more strict.
> 
> The flags should be the definitive indicators but I was entertaining the
> idea that maybe XYZ data could be put into a collection without
> physically removing the Z so it would be available later if it is needed
> for some reason. Maybe that kind of behavior should not be
> there/advertised and users should be given simple rules when Z or M
> can't be expected to exist any more.

Would your idea would be to strip off the Z/M component when adding a XYZ/M 
geometry to a XY GeometryCollection ?
The current strategy if you add a XYZ geometry to a XY GeometryCollection with 
already members, is to add Z=0 to those existing members.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Jan 29 01:13:11 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 29 Jan 2016 10:13:11 +0100
Subject: [gdal-dev] OGRPoint: fundamentals
In-Reply-To: <56AB1AF9.5030307@gmail.com>
References: <56AB1AF9.5030307@gmail.com>
Message-ID: <201601291013.11404.even.rouault@spatialys.com>

Le vendredi 29 janvier 2016 08:55:37, Ari Jolma a écrit :
> A question about OGRPoint.
> 
> There are copy constructor, assignment, and clone. Shouldn't these do
> basically the same thing but with a bit different syntax?

Yes they are supposed to do the same thing and hopefully the implementation 
does that currently.

> By the same
> thing I mean that the new point or assignee should have the same flags
> (is_empty, is_3D, is_measured), same coordinate values, and same spatial
> reference?

Yes


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Jan 29 01:19:48 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 29 Jan 2016 10:19:48 +0100
Subject: [gdal-dev] Streaming Parser for OGR GeoJSON Driver
In-Reply-To: <CAHmEjOXqrrxOaQys+Nbqz9bFSRZGYNRBrZ1wYz18_Z9DZtg-qg@mail.gmail.com>
References: <CAHmEjOXtF5v8xx+vG7W6_97TM4Y7_X5C8u8F3sHvVQOpPGJJYA@mail.gmail.com>
 <201601271157.15425.even.rouault@spatialys.com>
 <CAHmEjOXqrrxOaQys+Nbqz9bFSRZGYNRBrZ1wYz18_Z9DZtg-qg@mail.gmail.com>
Message-ID: <201601291019.48202.even.rouault@spatialys.com>

> 
> Perhaps it works because I am only appending to a single layer that has the
> same schema throughout?

Yes

> I did test this, but the performance was indeed slower. Is there a way for
> me to specify the schema before-hand and avoid a full first pass?
> 
> Perhaps for a driver implementation with a streaming parser, I could write
> a vrt before hand, then pipe in GeoJSON that matches that schema?

Yes, if you know the fields, you can do something like:

<OGRVRTDataSource>
  <OGRVRTUnionLayer>
    <OGRVRTLayer name="OGRGeoJSON">
        <SrcDataSource>tmp1.json</SrcDataSource>
    </OGRVRTLayer>
    <OGRVRTLayer name="OGRGeoJSON">
        <SrcDataSource>tmp2.json</SrcDataSource>
    </OGRVRTLayer>
    <Field name="..." type="..."/>
...
    <Field name="..." type="..."/>
  </OGRVRTUnionLayer>
</OGRVRTDataSource>

And if you don't know them but are OK to take the one of the first sources (so 
your current strategy) :

<OGRVRTDataSource>
  <OGRVRTUnionLayer>
    <OGRVRTLayer name="OGRGeoJSON">
        <SrcDataSource>tmp1.json</SrcDataSource>
    </OGRVRTLayer>
    <OGRVRTLayer name="OGRGeoJSON">
        <SrcDataSource>tmp2.json</SrcDataSource>
    </OGRVRTLayer>
    <FieldStrategy>FirstLayer</FieldStrategy>
  </OGRVRTUnionLayer>
</OGRVRTDataSource>

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Fri Jan 29 01:20:35 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Fri, 29 Jan 2016 11:20:35 +0200
Subject: [gdal-dev] OGRPoint: fundamentals
In-Reply-To: <201601291013.11404.even.rouault@spatialys.com>
References: <56AB1AF9.5030307@gmail.com>
 <201601291013.11404.even.rouault@spatialys.com>
Message-ID: <56AB2EE3.4070704@gmail.com>



29.01.2016, 11:13, Even Rouault kirjoitti:
> Le vendredi 29 janvier 2016 08:55:37, Ari Jolma a écrit :
>> A question about OGRPoint.
>>
>> There are copy constructor, assignment, and clone. Shouldn't these do
>> basically the same thing but with a bit different syntax?
> Yes they are supposed to do the same thing and hopefully the implementation
> does that currently.

The spatial reference is only assigned in clone. Also I'm not sure about 
the nCoordDimension.

Ari

>
>> By the same
>> thing I mean that the new point or assignee should have the same flags
>> (is_empty, is_3D, is_measured), same coordinate values, and same spatial
>> reference?
> Yes
>
>


From ari.jolma at gmail.com  Fri Jan 29 01:22:05 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Fri, 29 Jan 2016 11:22:05 +0200
Subject: [gdal-dev] OGRPoint: fundamentals
In-Reply-To: <56AB2EE3.4070704@gmail.com>
References: <56AB1AF9.5030307@gmail.com>
 <201601291013.11404.even.rouault@spatialys.com> <56AB2EE3.4070704@gmail.com>
Message-ID: <56AB2F3D.20405@gmail.com>



29.01.2016, 11:20, Ari Jolma kirjoitti:
>
>
> 29.01.2016, 11:13, Even Rouault kirjoitti:
>> Le vendredi 29 janvier 2016 08:55:37, Ari Jolma a écrit :
>>> A question about OGRPoint.
>>>
>>> There are copy constructor, assignment, and clone. Shouldn't these do
>>> basically the same thing but with a bit different syntax?
>> Yes they are supposed to do the same thing and hopefully the 
>> implementation
>> does that currently.
>
> The spatial reference is only assigned in clone. Also I'm not sure 
> about the nCoordDimension.

Sorry, it is assigned in all I believe.

Still (re)learning some C++ issues. :)

Ari

>
> Ari
>
>>
>>> By the same
>>> thing I mean that the new point or assignee should have the same flags
>>> (is_empty, is_3D, is_measured), same coordinate values, and same 
>>> spatial
>>> reference?
>> Yes
>>
>>
>


From ari.jolma at gmail.com  Fri Jan 29 01:32:59 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Fri, 29 Jan 2016 11:32:59 +0200
Subject: [gdal-dev] Call for discussion about RFC 61: Support for
 measures in geometries
In-Reply-To: <201601291004.51450.even.rouault@spatialys.com>
References: <56AA2102.9030102@gmail.com>
 <201601281546.50733.even.rouault@spatialys.com> <56AB06A4.4030105@gmail.com>
 <201601291004.51450.even.rouault@spatialys.com>
Message-ID: <56AB31CB.2050807@gmail.com>



29.01.2016, 11:04, Even Rouault kirjoitti:
>>> I had let an inline comment in the RFC regarding that. My opinion is that
>>> child geometries should be affected to avoid building geometries that are
>>> odd, and perhaps non conformant (should be checked but I'd be surprised
>>> it is legal to have the container and the containee with different
>>> coordinate dimensions. At least it cause problems in practice). On
>>> WKB/WKT import, we are curently lax, which is OK, and we accept mixed
>>> coordinate dimensions, but we upgrade the whole geometry to full XYZ as
>>> soon as the container or a containee is XYZ. On export (actually, when
>>> building OGRGeometry instances), we should be more strict.
>> The flags should be the definitive indicators but I was entertaining the
>> idea that maybe XYZ data could be put into a collection without
>> physically removing the Z so it would be available later if it is needed
>> for some reason. Maybe that kind of behavior should not be
>> there/advertised and users should be given simple rules when Z or M
>> can't be expected to exist any more.
> Would your idea would be to strip off the Z/M component when adding a XYZ/M
> geometry to a XY GeometryCollection ?
> The current strategy if you add a XYZ geometry to a XY GeometryCollection with
> already members, is to add Z=0 to those existing members.

Well, that's the question: how to manage data vs coordinate dimension.

If the above is the current strategy, then it should be extended to M. I 
guess there isn't so much an issue since the current strategy with Z is 
extendable to M usually. I'm just not well aware of the current strategy 
until I get to that part of the code.

Ari

>


From jukka.rahkonen at maanmittauslaitos.fi  Fri Jan 29 01:52:48 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Fri, 29 Jan 2016 09:52:48 +0000 (UTC)
Subject: [gdal-dev]
	=?utf-8?q?Call_for_discussion_about_RFC_61=3A_Support_?=
	=?utf-8?q?for_measures=09in_geometries?=
References: <56AA2102.9030102@gmail.com>
Message-ID: <loom.20160129T101012-627@post.gmane.org>

Ari Jolma <ari.jolma <at> gmail.com> writes:

> Should storing data, with measures, into a format, which does not 
> support measures, remove M values from the data? This would be similar 
> to the current behavior with curved geometries and formats which do not 
> support them.
 
I wonder what should happen when GDAL creates new vertices. It does not seem
to be clear even with XYZ as can be seen from this example:

Take LINESTRING ( 184 389 0, 858 346 100 )
Run ogr2ogr with -segmentize 1

Result: The first vertex of the new linesting has Z=0, all the other
vertices have Z=100.

With XYZ data users might be happy if Z value gets interpolated just like X
and Y but for measurements it could be not desired at all. Does M dimension
support anything like NoData?

There must be also other cases when GDAL can create unexpected M values but
probably we can only warn users about that in the documentation.

-Jukka Rahkonen-


From even.rouault at spatialys.com  Fri Jan 29 02:19:39 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 29 Jan 2016 11:19:39 +0100
Subject: [gdal-dev]
 =?utf-8?q?Call_for_discussion_about_RFC_61=3A_Support_?=
 =?utf-8?q?for_measures=09in_geometries?=
In-Reply-To: <loom.20160129T101012-627@post.gmane.org>
References: <56AA2102.9030102@gmail.com>
 <loom.20160129T101012-627@post.gmane.org>
Message-ID: <201601291119.39255.even.rouault@spatialys.com>

Le vendredi 29 janvier 2016 10:52:48, Jukka Rahkonen a écrit :
> Ari Jolma <ari.jolma <at> gmail.com> writes:
> > Should storing data, with measures, into a format, which does not
> > support measures, remove M values from the data? This would be similar
> > to the current behavior with curved geometries and formats which do not
> > support them.
> 
> I wonder what should happen when GDAL creates new vertices. It does not
> seem to be clear even with XYZ as can be seen from this example:
> 
> Take LINESTRING ( 184 389 0, 858 346 100 )
> Run ogr2ogr with -segmentize 1
> 
> Result: The first vertex of the new linesting has Z=0, all the other
> vertices have Z=100.

Digging into history, the original behaviour was setting Z=0 for all 
interpolated points. I modified it 
inhttps://trac.osgeo.org/gdal/changeset/26458 with the following comment : 
"don't set 0 as z for interpolated points, but the z from the previous point 
(not sure why we don't do interpolation)"

As it didn't seem to match the behaviour you noticed (the Z being the one of 
the next point in that case), I investigated a bit and the method was changed 
when support of curve geometries have been added. So as to be sure that 
linearized lines create the same intermediate points if the same curve is 
followed in a direction or the reverse direction (to avoid gaps), the line may 
be temporarily reversed during the segmentation process, so that the x of the 
first point is < the one of the last point (or if x are equal, that the y of 
the first point is < the one of the last point). So the z is taken from the 
value of the prev or next point depending on the cases.

> 
> With XYZ data users might be happy if Z value gets interpolated just like X
> and Y  but for measurements it could be not desired at all.

No strong opinion or this.

> Does M dimension
> support anything like NoData?

We could potentially put a not-a-number IEEE754 value (but it should be 
verified if it is legal in WKT output). I think it is quite common to get 
shapefiles/filegdbs with M values set to not-a-number

> 
> There must be also other cases when GDAL can create unexpected M values but
> probably we can only warn users about that in the documentation.
> 
> -Jukka Rahkonen-
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Jan 29 02:48:16 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 29 Jan 2016 11:48:16 +0100
Subject: [gdal-dev] Motions: Promote 1.11.4 RC2 and 2.0.2 RC4 for release
In-Reply-To: <201601271129.09484.even.rouault@spatialys.com>
References: <201601271129.09484.even.rouault@spatialys.com>
Message-ID: <201601291148.16136.even.rouault@spatialys.com>

Le mercredi 27 janvier 2016 11:29:09, Even Rouault a écrit :
> Hi,
> 
> Motion 1: GDAL/OGR 1.11.4 RC2 is promoted to be the official 1.11.4 final
> release.
> 
> Motion 2: GDAL/OGR 2.0.2 RC4 is promoted to be the official 2.0.2 final
> release.
> 
> --
> 
> My votes :
> Motion 1: + 1
> Motion 2: + 1

I declare those motions adopted with support of JukkaR, HowardB, DanielM and 
myself (and much appreciated testing of community members). I will proceed 
shortly to renaming the RC and announce.

> 
> Best regards,

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Jan 29 03:16:05 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 29 Jan 2016 12:16:05 +0100
Subject: [gdal-dev] GDAL/OGR 2.0.2 and 1.11.4 released
Message-ID: <201601291216.05986.even.rouault@spatialys.com>

Hi,

On behalf of the GDAL/OGR development team, I am pleased to
announce the release of the GDAL/OGR 1.11.4 and 2.0.2 bug fix versions. They 
contain respectively 44 and 92 bug fixes since 1.11.3 / 2.0.1.

The sources for 1.11.4 are available at:

  http://download.osgeo.org/gdal/1.11.4/gdal-1.11.4.tar.xz
  http://download.osgeo.org/gdal/1.11.4/gdal-1.11.4.tar.gz
  http://download.osgeo.org/gdal/1.11.4/gdal1114.zip

The sources for 2.0.2 are available at:

  http://download.osgeo.org/gdal/2.0.2/gdal-2.0.2.tar.xz
  http://download.osgeo.org/gdal/2.0.2/gdal-2.0.2.tar.gz
  http://download.osgeo.org/gdal/2.0.2/gdal202.zip

Details on the fixes in those releases are available at:
  http://trac.osgeo.org/gdal/wiki/Release/1.11.4-News
  http://trac.osgeo.org/gdal/wiki/Release/2.0.2-News

It is not definite how long the team will still maintain the 1.11 branch, so 
users are strongly encouraged to migrate to 2.0.2.

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From bo.victor.thomsen at gmail.com  Fri Jan 29 05:01:49 2016
From: bo.victor.thomsen at gmail.com (Bo Victor Thomsen)
Date: Fri, 29 Jan 2016 14:01:49 +0100
Subject: [gdal-dev] Fwd:  GDAL/OGR 2.0.2 and 1.11.4 released
In-Reply-To: <201601291216.05986.even.rouault@spatialys.com>
References: <201601291216.05986.even.rouault@spatialys.com>
Message-ID: <CAAJbAXsyAVdT4kUR=2ubpG_XW+aEZ-PiGDV6KfNGYF3thXcqUA@mail.gmail.com>

Is there anywhere I can download Windows binaries of these GDAL versions  ?
 (gisinternals.com doesn't contain ver. 2.0.n)

Regards

Bo Victor Thomsen



---------- Forwarded message ----------
From: Even Rouault <even.rouault at spatialys.com>
Date: 2016-01-29 12:16 GMT+01:00
Subject: [gdal-dev] GDAL/OGR 2.0.2 and 1.11.4 released
To: gdal-dev at lists.osgeo.org, gdal-announce at lists.osgeo.org


Hi,

On behalf of the GDAL/OGR development team, I am pleased to
announce the release of the GDAL/OGR 1.11.4 and 2.0.2 bug fix versions. They
contain respectively 44 and 92 bug fixes since 1.11.3 / 2.0.1.

The sources for 1.11.4 are available at:

  http://download.osgeo.org/gdal/1.11.4/gdal-1.11.4.tar.xz
  http://download.osgeo.org/gdal/1.11.4/gdal-1.11.4.tar.gz
  http://download.osgeo.org/gdal/1.11.4/gdal1114.zip

The sources for 2.0.2 are available at:

  http://download.osgeo.org/gdal/2.0.2/gdal-2.0.2.tar.xz
  http://download.osgeo.org/gdal/2.0.2/gdal-2.0.2.tar.gz
  http://download.osgeo.org/gdal/2.0.2/gdal202.zip

Details on the fixes in those releases are available at:
  http://trac.osgeo.org/gdal/wiki/Release/1.11.4-News
  http://trac.osgeo.org/gdal/wiki/Release/2.0.2-News

It is not definite how long the team will still maintain the 1.11 branch, so
users are strongly encouraged to migrate to 2.0.2.

Best regards,

Even

--
Spatialys - Geospatial professional services
http://www.spatialys.com
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160129/117ce444/attachment.html>

From jef at norbit.de  Fri Jan 29 05:08:28 2016
From: jef at norbit.de (=?iso-8859-1?B?SvxyZ2VuIEUu?= Fischer)
Date: Fri, 29 Jan 2016 14:08:28 +0100
Subject: [gdal-dev] Fwd:  GDAL/OGR 2.0.2 and 1.11.4 released
In-Reply-To: <CAAJbAXsyAVdT4kUR=2ubpG_XW+aEZ-PiGDV6KfNGYF3thXcqUA@mail.gmail.com>
References: <201601291216.05986.even.rouault@spatialys.com>
 <CAAJbAXsyAVdT4kUR=2ubpG_XW+aEZ-PiGDV6KfNGYF3thXcqUA@mail.gmail.com>
Message-ID: <20160129130828.GD30236@norbit.de>

Hi Bo Victor Thomsen,

On Fri, 29. Jan 2016 at 14:01:49 +0100, Bo Victor Thomsen wrote:
> Is there anywhere I can download Windows binaries of these GDAL versions  ?
>  (gisinternals.com doesn't contain ver. 2.0.n)

osgeo4w contains 2.0.2 (not yet the final, but RC2 I think) as experimental
(enable Exp in the installer).


Jürgen

-- 
Jürgen E. Fischer           norBIT GmbH             Tel. +49-4931-918175-31
Dipl.-Inf. (FH)             Rheinstraße 13          Fax. +49-4931-918175-50
Software Engineer           D-26506 Norden             http://www.norbit.de
QGIS release manager (PSC)  Germany                    IRC: jef on FreeNode                         
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 827 bytes
Desc: Digital signature
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160129/3b960546/attachment.sig>

From sebastic at xs4all.nl  Fri Jan 29 06:20:07 2016
From: sebastic at xs4all.nl (Bas Couwenberg)
Date: Fri, 29 Jan 2016 14:20:07 GMT
Subject: [gdal-dev] GDAL/OGR 2.0.2 and 1.11.4 released
References: <201601291216.05986.even.rouault@spatialys.com>
Message-ID: <1454077208489.95d3686b9ffa8@mozgaia>

Even Rouault wrote:
> It is not definite how long the team will still maintain the 1.11 branch, so 
> users are strongly encouraged to migrate to 2.0.2.

Because not all reverse dependencies support GDAL 2.0 yet, the next Debian stable release (stretch) will most likely stick to 1.11.x as will the next Ubuntu LTS (xenial).

I hope this will not cause too many issues.

Kind Regards,

Bas

From even.rouault at spatialys.com  Fri Jan 29 06:46:49 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 29 Jan 2016 15:46:49 +0100
Subject: [gdal-dev] GDAL/OGR 2.0.2 and 1.11.4 released
In-Reply-To: <1454077208489.95d3686b9ffa8@mozgaia>
References: <201601291216.05986.even.rouault@spatialys.com>
 <1454077208489.95d3686b9ffa8@mozgaia>
Message-ID: <201601291546.50087.even.rouault@spatialys.com>

Le vendredi 29 janvier 2016 15:20:07, Bas Couwenberg a écrit :
> Even Rouault wrote:
> > It is not definite how long the team will still maintain the 1.11 branch,
> > so users are strongly encouraged to migrate to 2.0.2.
> 
> Because not all reverse dependencies support GDAL 2.0 yet, the next Debian
> stable release (stretch) will most likely stick to 1.11.x as will the next
> Ubuntu LTS (xenial).

Are there many (and "important") reverse dependencies not yet ready ? If not, 
couldn't they be withdrawn from the main repo and added back via a PPA or 
something like that when ready ?

> 
> I hope this will not cause too many issues.

It would be annoying for applications that could make use of GDAL 2.0 
capababilities.
But I can imagine the challenge of managing a collection of applications...

> 
> Kind Regards,
> 
> Bas
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From dmfenton at gmail.com  Fri Jan 29 07:24:00 2016
From: dmfenton at gmail.com (Daniel Fenton)
Date: Fri, 29 Jan 2016 15:24:00 +0000
Subject: [gdal-dev] EPSG:2065 / South-oriented Krovak support (Czech
 friends thoughts wanted !)
In-Reply-To: <201601281804.46908.even.rouault@spatialys.com>
References: <201601281804.46908.even.rouault@spatialys.com>
Message-ID: <CAHmEjOV_MTLUB8T8pPmYe+xyOXUz9VvSvALgn8ULZ2yx5b4XnA@mail.gmail.com>

Even,

I'm not sure if this helps, but in dealing with an issue with WKID 5514,
this WKT workers to properly convert data from WGS84. This was confirmed
against a customer's source data.
'
PROJCS["S-JTSK_Krovak_East_North",GEOGCS["GCS_S_JTSK",DATUM["Jednotne_Trigonometricke_Site_Katastralni",SPHEROID["Bessel_1841",6377397.155,299.1528128]],TOWGS84[589,76,480,0,0,0,0],PRIMEM["Greenwich",0],UNIT["Degree",0.017453292519943295]],PROJECTION["Krovak"],PARAMETER["False_Easting",0],PARAMETER["False_Northing",0],PARAMETER["Pseudo_Standard_Parallel_1",78.5],PARAMETER["Scale_Factor",0.9999],PARAMETER["Azimuth",30.28813975277778],PARAMETER["Longitude_Of_Center",24.83333333333333],PARAMETER["Latitude_Of_Center",49.5],PARAMETER["X_Scale",-1],PARAMETER["Y_Scale",1],PARAMETER["XY_Plane_Rotation",90],UNIT["Meter",1],AUTHORITY["EPSG","102067"]]
'

Daniel

*Daniel Fenton*
*Software Engineer | Esri R&D*
*https://koopjs.github.io <https://koopjs.github.io>*
On Thu, Jan 28, 2016 at 12:05 PM Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
> I'm having a look at the following all related issues :
> https://trac.osgeo.org/postgis/ticket/1940
> https://trac.osgeo.org/proj/ticket/185
> https://trac.osgeo.org/gdal/ticket/4762
>
> related to EPSG:2065 support, ie "S-JTSK (Ferro) / Krovak". There's an
> issue
> about the datum shift used, but that's an easy one compared to a more
> serious
> one regarding axis order.
>
> The proj.4 krovak method expects the first value of a coordinate pair to
> be a
> easting, and the second value a northing. Whereas original Krovak
> (EPSG:2065)
> is supposed to be southing first, westing second.
>
> https://trac.osgeo.org/gdal/ticket/4762 suggests to add a "+to_meter=-1"
> parameter. Which means that the coordinates supplied are first westing,
> second
> southing (instead of "+to_meter=-1", a cleaner equivalent way is to use
> "+axis=wsu", meaning westing,southing,up )
> But EPSG would mandate southing,westing.
>
> But admitedly, for less exotic coordinate systems with official EPSG axis
> order
> latitude,longitude (EPSG:4326...) or northing,easting (some Finland
> projected
> CRS for example) we have never introduced in GDAL WKT or proj.4 strings the
> +axis option, and the application/user does the coordinate switch itself
> before passing that to GDAL/proj.
>
> So, does that sound OK that a user providing coordinates advertized to be
> in
> EPSG:2065 does that in westing, southing order ? Or was this something
> particular to this user ? (I'd note that the dataset mentionned in the
> ticket
> is a GML resulting from a WFS server, and we all know the axis ordering
> issues
> related to WFS)
>
> What a mess...
> (Using EPSG:5221 which is the easting, northing variant avoids those
> headaches)
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160129/016e5293/attachment-0001.html>

From even.rouault at spatialys.com  Fri Jan 29 07:39:06 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 29 Jan 2016 16:39:06 +0100
Subject: [gdal-dev] EPSG:2065 / South-oriented Krovak support (Czech
	friends thoughts wanted !)
In-Reply-To: <CAHmEjOV_MTLUB8T8pPmYe+xyOXUz9VvSvALgn8ULZ2yx5b4XnA@mail.gmail.com>
References: <201601281804.46908.even.rouault@spatialys.com>
 <CAHmEjOV_MTLUB8T8pPmYe+xyOXUz9VvSvALgn8ULZ2yx5b4XnA@mail.gmail.com>
Message-ID: <201601291639.06642.even.rouault@spatialys.com>

Le vendredi 29 janvier 2016 16:24:00, Daniel Fenton a écrit :
> Even,
> 
> I'm not sure if this helps, 

Me neither ;-), but thanks for jumping into this.

> but in dealing with an issue with WKID 5514,

EPSG:5514 is east-north oriented (like EPSG:5221, the GIS friendly equivalent 
of EPSG:2065), so it is naturally dealt with by proj.4.

> this WKT workers to properly convert data from WGS84. This was confirmed
> against a customer's source data.

Hum seing stuff like
PARAMETER["X_Scale",-1],PARAMETER["Y_Scale",1],PARAMETER["XY_Plane_Rotation",90] 
I'm not sure which projection engine is used behind. Such parameters aren't 
needed with proj.4 since AFAIU it naturally expects easting,northing 
coordinates to be provided as input for the +proj=krovak method (this must be 
the implementation of the "Krovak (North Oriented)" / EPSG:1041 method rather 
than original Krovak south/west oriented)

(funnly looking at the source of a PJ_krovak.c, I see there's a "+czech" 
parameter that can be provided to reverse the signs of x/y . hum....)

> '
> PROJCS["S-JTSK_Krovak_East_North",GEOGCS["GCS_S_JTSK",DATUM["Jednotne_Trigo
> nometricke_Site_Katastralni",SPHEROID["Bessel_1841",6377397.155,299.1528128
> ]],TOWGS84[589,76,480,0,0,0,0],PRIMEM["Greenwich",0],UNIT["Degree",0.017453
> 292519943295]],PROJECTION["Krovak"],PARAMETER["False_Easting",0],PARAMETER[
> "False_Northing",0],PARAMETER["Pseudo_Standard_Parallel_1",78.5],PARAMETER[
> "Scale_Factor",0.9999],PARAMETER["Azimuth",30.28813975277778],PARAMETER["Lo
> ngitude_Of_Center",24.83333333333333],PARAMETER["Latitude_Of_Center",49.5],
> PARAMETER["X_Scale",-1],PARAMETER["Y_Scale",1],PARAMETER["XY_Plane_Rotation
> ",90],UNIT["Meter",1],AUTHORITY["EPSG","102067"]] '
> 
> Daniel
> 
> *Daniel Fenton*
> *Software Engineer | Esri R&D*
> *https://koopjs.github.io <https://koopjs.github.io>*
> On Thu, Jan 28, 2016 at 12:05 PM Even Rouault <even.rouault at spatialys.com>
> 
> wrote:
> > Hi,
> > 
> > I'm having a look at the following all related issues :
> > https://trac.osgeo.org/postgis/ticket/1940
> > https://trac.osgeo.org/proj/ticket/185
> > https://trac.osgeo.org/gdal/ticket/4762
> > 
> > related to EPSG:2065 support, ie "S-JTSK (Ferro) / Krovak". There's an
> > issue
> > about the datum shift used, but that's an easy one compared to a more
> > serious
> > one regarding axis order.
> > 
> > The proj.4 krovak method expects the first value of a coordinate pair to
> > be a
> > easting, and the second value a northing. Whereas original Krovak
> > (EPSG:2065)
> > is supposed to be southing first, westing second.
> > 
> > https://trac.osgeo.org/gdal/ticket/4762 suggests to add a "+to_meter=-1"
> > parameter. Which means that the coordinates supplied are first westing,
> > second
> > southing (instead of "+to_meter=-1", a cleaner equivalent way is to use
> > "+axis=wsu", meaning westing,southing,up )
> > But EPSG would mandate southing,westing.
> > 
> > But admitedly, for less exotic coordinate systems with official EPSG axis
> > order
> > latitude,longitude (EPSG:4326...) or northing,easting (some Finland
> > projected
> > CRS for example) we have never introduced in GDAL WKT or proj.4 strings
> > the +axis option, and the application/user does the coordinate switch
> > itself before passing that to GDAL/proj.
> > 
> > So, does that sound OK that a user providing coordinates advertized to be
> > in
> > EPSG:2065 does that in westing, southing order ? Or was this something
> > particular to this user ? (I'd note that the dataset mentionned in the
> > ticket
> > is a GML resulting from a WFS server, and we all know the axis ordering
> > issues
> > related to WFS)
> > 
> > What a mess...
> > (Using EPSG:5221 which is the easting, northing variant avoids those
> > headaches)
> > 
> > Even
> > 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From bo.victor.thomsen at gmail.com  Fri Jan 29 14:17:13 2016
From: bo.victor.thomsen at gmail.com (Bo Victor Thomsen)
Date: Fri, 29 Jan 2016 23:17:13 +0100
Subject: [gdal-dev] Fwd: GDAL/OGR 2.0.2 and 1.11.4 released
In-Reply-To: <20160129130828.GD30236@norbit.de>
References: <201601291216.05986.even.rouault@spatialys.com>
 <CAAJbAXsyAVdT4kUR=2ubpG_XW+aEZ-PiGDV6KfNGYF3thXcqUA@mail.gmail.com>
 <20160129130828.GD30236@norbit.de>
Message-ID: <CAAJbAXuGM3VbcOcmxeLqGU0JkhHi0dCOtD8qwOe31xypgL82Hg@mail.gmail.com>

Thanks Jürgen for the information - I was getting a little desperate :-)

Regards Bo Victor

2016-01-29 14:08 GMT+01:00 Jürgen E. <jef at norbit.de>:

> Hi Bo Victor Thomsen,
>
> On Fri, 29. Jan 2016 at 14:01:49 +0100, Bo Victor Thomsen wrote:
> > Is there anywhere I can download Windows binaries of these GDAL
> versions  ?
> >  (gisinternals.com doesn't contain ver. 2.0.n)
>
> osgeo4w contains 2.0.2 (not yet the final, but RC2 I think) as experimental
> (enable Exp in the installer).
>
>
> Jürgen
>
> --
> Jürgen E. Fischer           norBIT GmbH             Tel.
> +49-4931-918175-31
> Dipl.-Inf. (FH)             Rheinstraße 13          Fax.
> +49-4931-918175-50
> Software Engineer           D-26506 Norden
> http://www.norbit.de
> QGIS release manager (PSC)  Germany                    IRC: jef on FreeNode
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
Med venlig hilsen

Bo Victor Thomsen
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160129/468c642a/attachment.html>

From roger.bivand at nhh.no  Fri Jan 29 14:36:56 2016
From: roger.bivand at nhh.no (Roger Bivand)
Date: Fri, 29 Jan 2016 22:36:56 +0000 (UTC)
Subject: [gdal-dev] GDAL/OGR 2.0.2 and 1.11.4 released
References: <201601291216.05986.even.rouault@spatialys.com>
 <1454077208489.95d3686b9ffa8@mozgaia>
 <201601291546.50087.even.rouault@spatialys.com>
Message-ID: <loom.20160129T232719-480@post.gmane.org>

Even Rouault <even.rouault <at> spatialys.com> writes:

> 
> Le vendredi 29 janvier 2016 15:20:07, Bas Couwenberg a écrit :
> > Even Rouault wrote:
> > > It is not definite how long the team will still maintain the 1.11 branch,
> > > so users are strongly encouraged to migrate to 2.0.2.
> > 
> > Because not all reverse dependencies support GDAL 2.0 yet, the next Debian
> > stable release (stretch) will most likely stick to 1.11.x as will the next
> > Ubuntu LTS (xenial).
> 
> Are there many (and "important") reverse dependencies not yet ready ? If not, 
> couldn't they be withdrawn from the main repo and added back via a PPA or 
> something like that when ready ?
> 
> > 
> > I hope this will not cause too many issues.
> 
> It would be annoying for applications that could make use of GDAL 2.0 
> capababilities.
> But I can imagine the challenge of managing a collection of applications...

It would be of great advantage for users of R installing the rgdal package
from source to be able to link to GDAL 2.0 rather than 1.11. Many Debian and
Ubuntu users have really outdated GDAL versions, meaning that many newer
drivers and significant bug fixes are not available to them. 

The idea of waiting for the slowest ship in the convoy may be admirable, but
arguably the time costs involved in being obliged to upgrade code are
actually not large, bring some advantages, and shouldn't deprive users of
other software of convenient access to more up to date binaries. CRAN (the R
archive network is still running its tests on Debian platforms using 1.11.3.

I do hope that a solution as suggested by Even is at least feasible; it is
certainly very desirable seen from downstream.
 
Best wishes,

Roger

> 
> > 
> > Kind Regards,
> > 
> > Bas
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev <at> lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 



From schwehr at gmail.com  Fri Jan 29 17:42:42 2016
From: schwehr at gmail.com (Kurt Schwehr)
Date: Fri, 29 Jan 2016 17:42:42 -0800
Subject: [gdal-dev] GDAL/OGR 2.0.2 and 1.11.4 released
In-Reply-To: <loom.20160129T232719-480@post.gmane.org>
References: <201601291216.05986.even.rouault@spatialys.com>
 <1454077208489.95d3686b9ffa8@mozgaia>
 <201601291546.50087.even.rouault@spatialys.com>
 <loom.20160129T232719-480@post.gmane.org>
Message-ID: <CACmBxyv58+7jM_y73qP=o_MqCBCNFBXEi1j8qoofWZh+gyGWXg@mail.gmail.com>

Progress with other libraries and tools is happening.  Maybe not speedy,
but it's going.

e.g. I just got this patch in for Vision Workbench:
https://github.com/visionworkbench/visionworkbench/pull/42

On Fri, Jan 29, 2016 at 2:36 PM, Roger Bivand <roger.bivand at nhh.no> wrote:

> Even Rouault <even.rouault <at> spatialys.com> writes:
>
> >
> > Le vendredi 29 janvier 2016 15:20:07, Bas Couwenberg a écrit :
> > > Even Rouault wrote:
> > > > It is not definite how long the team will still maintain the 1.11
> branch,
> > > > so users are strongly encouraged to migrate to 2.0.2.
> > >
> > > Because not all reverse dependencies support GDAL 2.0 yet, the next
> Debian
> > > stable release (stretch) will most likely stick to 1.11.x as will the
> next
> > > Ubuntu LTS (xenial).
> >
> > Are there many (and "important") reverse dependencies not yet ready ? If
> not,
> > couldn't they be withdrawn from the main repo and added back via a PPA or
> > something like that when ready ?
> >
> > >
> > > I hope this will not cause too many issues.
> >
> > It would be annoying for applications that could make use of GDAL 2.0
> > capababilities.
> > But I can imagine the challenge of managing a collection of
> applications...
>
> It would be of great advantage for users of R installing the rgdal package
> from source to be able to link to GDAL 2.0 rather than 1.11. Many Debian
> and
> Ubuntu users have really outdated GDAL versions, meaning that many newer
> drivers and significant bug fixes are not available to them.
>
> The idea of waiting for the slowest ship in the convoy may be admirable,
> but
> arguably the time costs involved in being obliged to upgrade code are
> actually not large, bring some advantages, and shouldn't deprive users of
> other software of convenient access to more up to date binaries. CRAN (the
> R
> archive network is still running its tests on Debian platforms using
> 1.11.3.
>
> I do hope that a solution as suggested by Even is at least feasible; it is
> certainly very desirable seen from downstream.
>
> Best wishes,
>
> Roger
>
> >
> > >
> > > Kind Regards,
> > >
> > > Bas
> > > _______________________________________________
> > > gdal-dev mailing list
> > > gdal-dev <at> lists.osgeo.org
> > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160129/33f8fe0f/attachment.html>

From jmckenna at gatewaygeomatics.com  Sat Jan 30 13:10:53 2016
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Sat, 30 Jan 2016 17:10:53 -0400
Subject: [gdal-dev] Fwd: GDAL/OGR 2.0.2 and 1.11.4 released
In-Reply-To: <CAAJbAXsyAVdT4kUR=2ubpG_XW+aEZ-PiGDV6KfNGYF3thXcqUA@mail.gmail.com>
References: <201601291216.05986.even.rouault@spatialys.com>
 <CAAJbAXsyAVdT4kUR=2ubpG_XW+aEZ-PiGDV6KfNGYF3thXcqUA@mail.gmail.com>
Message-ID: <56AD26DD.8060604@gatewaygeomatics.com>

GDAL 2.0.2-final is available for Windows users at http://ms4w.com

-jeff




-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/


On 2016-01-29 9:01 AM, Bo Victor Thomsen wrote:
> Is there anywhere I can download Windows binaries of these GDAL versions
>   ?  (gisinternals.com <http://gisinternals.com> doesn't contain ver.
> 2.0.n)
>
> Regards
>
> Bo Victor Thomsen
>
>
>
> ---------- Forwarded message ----------
> From: *Even Rouault* <even.rouault at spatialys.com
> <mailto:even.rouault at spatialys.com>>
> Date: 2016-01-29 12:16 GMT+01:00
> Subject: [gdal-dev] GDAL/OGR 2.0.2 and 1.11.4 released
> To: gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>,
> gdal-announce at lists.osgeo.org <mailto:gdal-announce at lists.osgeo.org>
>
>
> Hi,
>
> On behalf of the GDAL/OGR development team, I am pleased to
> announce the release of the GDAL/OGR 1.11.4 and 2.0.2 bug fix versions. They
> contain respectively 44 and 92 bug fixes since 1.11.3 / 2.0.1.
>
> The sources for 1.11.4 are available at:
>
> http://download.osgeo.org/gdal/1.11.4/gdal-1.11.4.tar.xz
> http://download.osgeo.org/gdal/1.11.4/gdal-1.11.4.tar.gz
> http://download.osgeo.org/gdal/1.11.4/gdal1114.zip
>
> The sources for 2.0.2 are available at:
>
> http://download.osgeo.org/gdal/2.0.2/gdal-2.0.2.tar.xz
> http://download.osgeo.org/gdal/2.0.2/gdal-2.0.2.tar.gz
> http://download.osgeo.org/gdal/2.0.2/gdal202.zip
>
> Details on the fixes in those releases are available at:
> http://trac.osgeo.org/gdal/wiki/Release/1.11.4-News
> http://trac.osgeo.org/gdal/wiki/Release/2.0.2-News
>
> It is not definite how long the team will still maintain the 1.11 branch, so
> users are strongly encouraged to migrate to 2.0.2.
>
> Best regards,
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> ________________________________

From ari.jolma at gmail.com  Sun Jan 31 00:58:31 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Sun, 31 Jan 2016 10:58:31 +0200
Subject: [gdal-dev] Call for discussion about RFC 61: Support for
 measures in geometries
In-Reply-To: <56AA2102.9030102@gmail.com>
References: <56AA2102.9030102@gmail.com>
Message-ID: <56ADCCB7.4040008@gmail.com>

This seems to be a pretty big thing to add but doable.

So, one more thing to discuss before going to vote later is the target 
milestone. Maybe add it to 2.1 as "an experimental feature" and aim for 
2.2 as a more production ready? This of course assuming that I can get 
it implemented before 2.1. By "implemented" I mean generic support + one 
or two drivers (shape, pg) & passing current tests + basic set of new tests.

I've also edited the RFC draft according to what I've found / thought 
while developing. I'd be happy to get feedback about the proposed 
additions to the APIs.

What I right now have is a working WKT and WKB API for point geometries. 
Next I plan to test constructing and modifying geometries with 
get/set/add methods and then move to building the support into shape 
driver, while also adding more geometries to the WKT, WKB tests.

Best,

Ari

28.01.2016, 16:09, Ari Jolma kirjoitti:
> Folks, especially the PSC,
>
> I'd like to call for discussion about RFC 61: Adding support for 
> measures in geometries.
>
> Measures (M) are a sort of fourth coordinate for points in geometries. 
> A typical use of measures is for distance from origin in line strings 
> that represent roads but they can be used for other things as well.
>
> Measures are a part of the simple features model and they are 
> supported by many vector data formats.
>
> Since measures are a rather fundamental element, adding them will 
> require quite many changes into the basic building blocks of the GDAL 
> API. Most importantly, the 'int nCoordDimension' property of 
> OGRGeometry is proposed to be replaced by 'int flags', which will have 
> bit flags denoting whether the geometry is empty and has Z or M 
> coordinates.
>
> No backwards incompatible changes (syntactic nor semantic) will be 
> done but the methods getCoordinateDimension and setCoordinateDimension 
> will be deprecated since they do not take into account M coordinate.
>
> The RFC is as usual in the wiki:
>
> https://trac.osgeo.org/gdal/wiki/rfc61_support_for_measured_geometries
>
> There are a couple of decisions to be made (if the overall decision is 
> positive).
>
> Should the set3D(b3D) method (and also for example AddGeometry method) 
> of GeometryCollection force all child geometries to be 3D (or 2D and 
> remove possible Z values)? Maybe just unsetting the flag when 
> downgrading is enough?
>
> Should storing data, with measures, into a format, which does not 
> support measures, remove M values from the data? This would be similar 
> to the current behavior with curved geometries and formats which do 
> not support them.
>
> Some smaller issues are mentioned/hinted to in the draft RFC.
>
> I have set up a github repository for the work at
>
> https://github.com/ajolma/GDAL-XYZM
>
> It has an associated travis builder - which however seems to have some 
> problems right now. I have committed the API changes from the draft 
> RFC and it compiles but there is a lot to do with actually 
> implementing the support.
>
> Best regards,
>
> Ari
>


From filipesdias at gmail.com  Sun Jan 31 01:39:43 2016
From: filipesdias at gmail.com (Filipe Dias)
Date: Sun, 31 Jan 2016 09:39:43 +0000
Subject: [gdal-dev] gdal_proximity: possible bug
Message-ID: <CABr3zxULxAmJTbnuPmDx5fHu67Hbsa8+fR6ViKhisfhvKsSWuA@mail.gmail.com>

Hi,

I used gdal_proximity on a raster and did not pass the "Values" parameter
because in the help file it said " all non-zero pixels will be considered
target pixels.". The result was an incorrect Distances raster. Afterwards I
set the "Values" parameter and it worked as expected.

I reported this initially in the QGIS bug tracker, see more here:

http://hub.qgis.org/issues/14115#change-67271

I'm using GDAL 1.11.2.

Is this really a bug? Should I open a ticket?

Thanks

Best regards
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160131/ce98572d/attachment.html>

From sfkeller at gmail.com  Sun Jan 31 09:10:09 2016
From: sfkeller at gmail.com (Stefan Keller)
Date: Sun, 31 Jan 2016 18:10:09 +0100
Subject: [gdal-dev] Vector Tiles in OGR
In-Reply-To: <CAH-RUCQwki_Di08JCy2C8E8RkR3X3AdLjRQXo-312EWOVobL3g@mail.gmail.com>
References: <CAH-RUCSWA55kmEW6=tH0=xb7qUFm9R4oJ6iBSxdeSrnetyRM0g@mail.gmail.com>
 <CAPxHBh_-i1i8_85J517SWUo8N1GB9557Om4CvRwi4iMxTXswOQ@mail.gmail.com>
 <CAH-RUCQwki_Di08JCy2C8E8RkR3X3AdLjRQXo-312EWOVobL3g@mail.gmail.com>
Message-ID: <CAFcOn2-rF8_=wC6Y5dpmmbLHccN2SG6Qqj_GNsEuzbKF+1ocpA@mail.gmail.com>

Hi Petr, Blake, Even and everybody

I'm (besides Petr) the other maintainer of OSM2VectorTiles.
I'd already asked Even a similar question.
I'm advising now an intern to implement such a MVT Vector Tiles reader
client in Python if possible as part of a QGIS plugin.
And I'm interested not to do redundant implementations.
Are there any news on this matter?

:Stefan
Prof. at HSR and leader of Geometa Lab

@Even: Regarding OGR MVT development can you send to me (directly) a
contact name of the group which won the bidding?


2016-01-06 15:24 GMT+01:00 Petr Pridal <petr.pridal at klokantech.com>:
> Hi everybody,
>
> thanks for the comments. Regarding the technical details:
>
>> Each Tile is its own discrete dataset therefore the hardest part would be
>> merging of features into the original features across tiles. You could use
>> some complicated merging technique, but that could be very expensive.
>
>
> The driver could require "id" parameter, which specifies name of an
> attribute with unique identifier on the features shared across the tiles.
> Both MapBox vector tiles and OSM2VectorTiles tiles have an unique non-zero
> "osm_id" in place. The first version of driver could read only features with
> such ID. The identifier does not have to be always filled, but often it is,
> especially in deeper zoom levels derived purely from OpenStreetMap - but
> yeh, a completely general stitching would be much harder.
>
> The clipping + merging of shapes itself can be implemented with underlaying
> GEOS library functions.
>
> BTW It is possible to examine vector tiles data in pure JavaScript X-Ray
> viewer (no WebGL support on browser required) made in OpenLayers3:
> http://klokantech.github.io/ol3-sandbox/vector/xray.html
>
> or with WebGL-enabled webbrowser with higher performance MapBox GL JS
> powered X-Ray:
> http://klokantech.github.io/mapbox-gl-js-offline-example/xray.html
>
> A debug viewer for each vector tile (made in OL3) decoded in pure
> JavaScript:
> http://klokantech.github.io/ol3-sandbox/vector/tile-inspector.html
>
> The OGR driver could be also practical for the unsimplified / ungeneralised
> MBTiles with OSM data available at: http://osmlab.github.io/osm-qa-tiles/
>
>>
>> If you wanted to simply view vector tile data it could get confusing as
>> well since most vector tiles need a buffer when they are used for
>> visualization programs. This is important for things like labeling on maps
>> etc. Therefore, you could get a large amount of overlapping data on tiles if
>> you loaded them all in at once.
>
>
> Clipping on border of each tile must be applied before stitching the vector
> features together  - so the buffer is removed. Buffer is there only for
> visualisation and labeling.
>
>>
>> As far as writing a simple decoder -- the mapnik-vector-tile decoder isn't
>> currently able to decode vector tiles into a form not supported by mapnik.
>> Therefore, OGR would not be able to easily use this.
>
>
> Correct. It can't be used directly (GDAL can't link against), but the
> relevant code can be extracted and reused directly. For basic decoding
> critical is the Protobuf library (which is already in GDAL) and
> https://github.com/mapbox/mapnik-vector-tile/blob/master/proto/vector_tile.proto
> + the code for converting pixel coordinates in features to relevant geo
> coordinates and GEOS-based merging of features.
>
>> We plan to write a generalized encoder and decoder eventually so that any
>> other library can plugin with out the mapnik requirement.
>
>
> This would be amazing.
>
>> If you have any questions specifically about Mapnik Vector Tile or the
>> Mapbox Vector Tile Specification feel free to ask me. I would note that you
>> guys will want to update your vector tiles once the V2 specification changes
>> are into Mapnik-Vector-Tile.
>
>
> Cool! Thanks. Our world tiles are generated via Docker containers on a
> cluster of computers - using Mapnik via Tilelive directly - so upgrades on
> Mapnik-Vector-Tile will propagate to the open-source rendering software.
> I expect V2 spec will mean also new MapBox Streets V7, right?
>
>> I see you mention MVT in MBTiles. Is it a recognized practice ? I don't
>> see
>> mention of that neither in the MVT spec (
>> https://github.com/mapbox/vector-
>> tile-spec/tree/master/2.0 ) nor the MBTiles one (
>> https://github.com/mapbox/mbtiles-spec/blob/master/1.2/spec.md ), although
>> I
>> guess it is just a matter of storing a MVT blob in the tile_data column.
>
>
> Yes. MapBox Studio Classic generates such MBTiles with Vector Tiles inside -
> and Mapnik reads them directly when rasterising. Storing the vector tiles in
> SQLite make sense - and it simplifies deployment, and you can then easily
> have complete world on each node of a cluster of tileservers. If you don't
> want to upgrade your base map too often, this approach is pretty efficient
> and removes the centralised database as typical bottleneck.
>
> I did some tests on vector tiles vs raster in MBTiles and documented these
> in README.md at and https://github.com/klokantech/vector-tiles-sample before
> we started to work on OSM2VectorTiles project.
> There are also sample data and offline MapBox GL JS viewer in that repo.
> Vector tiles can be hosted also "unpacked", just as files in folders on a
> standard web server - exactly like GDAL2Tiles or MapTiler.com does by
> default for raster tiles.
>
> If OGR driver is implemented, the primary source should be probably reading
> from an URL via curl.
>
> Reading PBFs from an MBTiles (or another SQLite) is just the most practical
> portable alternative to it.
>
> Technically people may store the tiles in different ways - for example
> Wikimedia guys (http://maps.wikimedia.org/ and
> https://github.com/kartotherian/) use Cassandra for tile storage, I guess
> MapBox internally is also on a different storage for production servers ...
> for transfers and streaming tilesets there is the  - but tiles are ALWAYS
> exposed via HTTP.
>
> Regards,
>
> Petr
> --
> Petr Pridal, Ph.D.
> CEO
>
> Klokan Technologies GmbH
> Hofnerstrasse 98, 6314 Unterageri, Switzerland
> Tel: +41 (0)41 511 26 12
> Email: info at klokantech.com
> Web: http://www.klokantech.com/
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From flippmoke at gmail.com  Sun Jan 31 14:22:31 2016
From: flippmoke at gmail.com (Flippmoke)
Date: Sun, 31 Jan 2016 15:22:31 -0700
Subject: [gdal-dev] Vector Tiles in OGR
In-Reply-To: <CAFcOn2-rF8_=wC6Y5dpmmbLHccN2SG6Qqj_GNsEuzbKF+1ocpA@mail.gmail.com>
References: <CAH-RUCSWA55kmEW6=tH0=xb7qUFm9R4oJ6iBSxdeSrnetyRM0g@mail.gmail.com>
 <CAPxHBh_-i1i8_85J517SWUo8N1GB9557Om4CvRwi4iMxTXswOQ@mail.gmail.com>
 <CAH-RUCQwki_Di08JCy2C8E8RkR3X3AdLjRQXo-312EWOVobL3g@mail.gmail.com>
 <CAFcOn2-rF8_=wC6Y5dpmmbLHccN2SG6Qqj_GNsEuzbKF+1ocpA@mail.gmail.com>
Message-ID: <661A1F30-F0B6-4514-92A1-B9782D109958@gmail.com>

All,

The first thing that is going to be required likely is a good generic c++ library for encoding and decoding vector tiles IMO. 

I have spent a lot of time working on developing the mapnik vector tile library to be a solid implementation, especially around all the work done for 2.0 of Mapbox vector tile specification. I would love to eventually help make this a generalized implementation so that it is portable to a library like GDAL.

We have talked about doing something like this at Mapbox but will require a good deal of time, so it hasn't been pushed forward yet. The other issues that come to mind to me is that some of the libraries that mapnik vector tile depends upon most likely need good custom implementations if we wanted to make it more generic.

The reason for this is that I would prefer for it to be a header only library with no dependencies. Adding more dependencies for GDAL seems like it could be a mess.

Blake Thompson

> On Jan 31, 2016, at 10:10 AM, Stefan Keller <sfkeller at gmail.com> wrote:
> 
> Hi Petr, Blake, Even and everybody
> 
> I'm (besides Petr) the other maintainer of OSM2VectorTiles.
> I'd already asked Even a similar question.
> I'm advising now an intern to implement such a MVT Vector Tiles reader
> client in Python if possible as part of a QGIS plugin.
> And I'm interested not to do redundant implementations.
> Are there any news on this matter?
> 
> :Stefan
> Prof. at HSR and leader of Geometa Lab
> 
> @Even: Regarding OGR MVT development can you send to me (directly) a
> contact name of the group which won the bidding?
> 
> 
> 2016-01-06 15:24 GMT+01:00 Petr Pridal <petr.pridal at klokantech.com>:
>> Hi everybody,
>> 
>> thanks for the comments. Regarding the technical details:
>> 
>>> Each Tile is its own discrete dataset therefore the hardest part would be
>>> merging of features into the original features across tiles. You could use
>>> some complicated merging technique, but that could be very expensive.
>> 
>> 
>> The driver could require "id" parameter, which specifies name of an
>> attribute with unique identifier on the features shared across the tiles.
>> Both MapBox vector tiles and OSM2VectorTiles tiles have an unique non-zero
>> "osm_id" in place. The first version of driver could read only features with
>> such ID. The identifier does not have to be always filled, but often it is,
>> especially in deeper zoom levels derived purely from OpenStreetMap - but
>> yeh, a completely general stitching would be much harder.
>> 
>> The clipping + merging of shapes itself can be implemented with underlaying
>> GEOS library functions.
>> 
>> BTW It is possible to examine vector tiles data in pure JavaScript X-Ray
>> viewer (no WebGL support on browser required) made in OpenLayers3:
>> http://klokantech.github.io/ol3-sandbox/vector/xray.html
>> 
>> or with WebGL-enabled webbrowser with higher performance MapBox GL JS
>> powered X-Ray:
>> http://klokantech.github.io/mapbox-gl-js-offline-example/xray.html
>> 
>> A debug viewer for each vector tile (made in OL3) decoded in pure
>> JavaScript:
>> http://klokantech.github.io/ol3-sandbox/vector/tile-inspector.html
>> 
>> The OGR driver could be also practical for the unsimplified / ungeneralised
>> MBTiles with OSM data available at: http://osmlab.github.io/osm-qa-tiles/
>> 
>>> 
>>> If you wanted to simply view vector tile data it could get confusing as
>>> well since most vector tiles need a buffer when they are used for
>>> visualization programs. This is important for things like labeling on maps
>>> etc. Therefore, you could get a large amount of overlapping data on tiles if
>>> you loaded them all in at once.
>> 
>> 
>> Clipping on border of each tile must be applied before stitching the vector
>> features together  - so the buffer is removed. Buffer is there only for
>> visualisation and labeling.
>> 
>>> 
>>> As far as writing a simple decoder -- the mapnik-vector-tile decoder isn't
>>> currently able to decode vector tiles into a form not supported by mapnik.
>>> Therefore, OGR would not be able to easily use this.
>> 
>> 
>> Correct. It can't be used directly (GDAL can't link against), but the
>> relevant code can be extracted and reused directly. For basic decoding
>> critical is the Protobuf library (which is already in GDAL) and
>> https://github.com/mapbox/mapnik-vector-tile/blob/master/proto/vector_tile.proto
>> + the code for converting pixel coordinates in features to relevant geo
>> coordinates and GEOS-based merging of features.
>> 
>>> We plan to write a generalized encoder and decoder eventually so that any
>>> other library can plugin with out the mapnik requirement.
>> 
>> 
>> This would be amazing.
>> 
>>> If you have any questions specifically about Mapnik Vector Tile or the
>>> Mapbox Vector Tile Specification feel free to ask me. I would note that you
>>> guys will want to update your vector tiles once the V2 specification changes
>>> are into Mapnik-Vector-Tile.
>> 
>> 
>> Cool! Thanks. Our world tiles are generated via Docker containers on a
>> cluster of computers - using Mapnik via Tilelive directly - so upgrades on
>> Mapnik-Vector-Tile will propagate to the open-source rendering software.
>> I expect V2 spec will mean also new MapBox Streets V7, right?
>> 
>>> I see you mention MVT in MBTiles. Is it a recognized practice ? I don't
>>> see
>>> mention of that neither in the MVT spec (
>>> https://github.com/mapbox/vector-
>>> tile-spec/tree/master/2.0 ) nor the MBTiles one (
>>> https://github.com/mapbox/mbtiles-spec/blob/master/1.2/spec.md ), although
>>> I
>>> guess it is just a matter of storing a MVT blob in the tile_data column.
>> 
>> 
>> Yes. MapBox Studio Classic generates such MBTiles with Vector Tiles inside -
>> and Mapnik reads them directly when rasterising. Storing the vector tiles in
>> SQLite make sense - and it simplifies deployment, and you can then easily
>> have complete world on each node of a cluster of tileservers. If you don't
>> want to upgrade your base map too often, this approach is pretty efficient
>> and removes the centralised database as typical bottleneck.
>> 
>> I did some tests on vector tiles vs raster in MBTiles and documented these
>> in README.md at and https://github.com/klokantech/vector-tiles-sample before
>> we started to work on OSM2VectorTiles project.
>> There are also sample data and offline MapBox GL JS viewer in that repo.
>> Vector tiles can be hosted also "unpacked", just as files in folders on a
>> standard web server - exactly like GDAL2Tiles or MapTiler.com does by
>> default for raster tiles.
>> 
>> If OGR driver is implemented, the primary source should be probably reading
>> from an URL via curl.
>> 
>> Reading PBFs from an MBTiles (or another SQLite) is just the most practical
>> portable alternative to it.
>> 
>> Technically people may store the tiles in different ways - for example
>> Wikimedia guys (http://maps.wikimedia.org/ and
>> https://github.com/kartotherian/) use Cassandra for tile storage, I guess
>> MapBox internally is also on a different storage for production servers ...
>> for transfers and streaming tilesets there is the  - but tiles are ALWAYS
>> exposed via HTTP.
>> 
>> Regards,
>> 
>> Petr
>> --
>> Petr Pridal, Ph.D.
>> CEO
>> 
>> Klokan Technologies GmbH
>> Hofnerstrasse 98, 6314 Unterageri, Switzerland
>> Tel: +41 (0)41 511 26 12
>> Email: info at klokantech.com
>> Web: http://www.klokantech.com/
>> 
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev

