From mdsumner at gmail.com  Sat Apr  1 00:57:50 2023
From: mdsumner at gmail.com (Michael Sumner)
Date: Sat, 1 Apr 2023 18:57:50 +1100
Subject: [gdal-dev] recent change?, issue with OGRGeometryFactory in R
In-Reply-To: <CAAcGz98+3BTib0VK8NAe2c5NTeWMbBR5VA1cXYuMvcA07TRQsg@mail.gmail.com>
References: <CAAcGz98+3BTib0VK8NAe2c5NTeWMbBR5VA1cXYuMvcA07TRQsg@mail.gmail.com>
Message-ID: <CAAcGz9_vkZN11qL0zYfnmCYR8OLpttjwKW1LP8V=qvvUAj=qDw@mail.gmail.com>

Actually... this seems to be a problem on just one machine, I would have
thought they are the same but fwiw this seems not to be a GDAL or R package
problem.

I'll check again carefully so probably ignore this, thanks!

Cheers, Mike

On Sat, 1 Apr 2023, 16:24 Michael Sumner, <mdsumner at gmail.com> wrote:

> Hi,
>
> I'm here to ask for help finding where this issue is. If I use an earlier
> build it still works (these are R packages sf and terra that are well
> tested against previous releases).
>
> Has something changed with the headers structure for OGRGeometryFactory
> perhaps? (I'm out of my depth for how to track this down).   If it's an
> issue on the R side I'll fix it there, but mostly I'm here to ask what has
> changed on the GDAL side to result in this symbol problem (or whatever it
> is I'm doing wrong).
>
> using latest build  24afc75d3c3f2c85621e8b8d83f54a73b1d3ad33
>
> I see
>
> > library(sf)
> Error: package or namespace load failed for ?sf? in dyn.load(file, DLLpath
> = DLLpath, ...):
>  unable to load shared object
> '/usr/local/lib/R/site-library/sf/libs/sf.so':
>   /usr/local/lib/R/site-library/sf/libs/sf.so: undefined symbol:
> _ZN18OGRGeometryFactory13createFromWktEPKcP19OGRSpatialReferencePP11OGRGeometry
> > library(terra)
> Error: package or namespace load failed for ?terra? in dyn.load(file,
> DLLpath = DLLpath, ...):
>  unable to load shared object
> '/usr/local/lib/R/site-library/terra/libs/terra.so':
>   /usr/local/lib/R/site-library/terra/libs/terra.so: undefined symbol:
> _ZN18OGRGeometryFactory13createFromWktEPKcP19OGRSpatialReferencePP11OGRGeometry
>
> Using a prior build eca6f7bf17fe500ef4c0ba9793e93ea305bab1fc it works.
>
> The offending code in terra is this (I think)
>
>
> https://github.com/rspatial/terra/blob/ddcf84ce901a269ac13118d650efac16f89a8602/src/read_ogr.cpp#L694
>
> In sf it is
>
>
> https://github.com/r-spatial/sf/blob/main/src/gdal_read.cpp#L582
> Thank you.
>
> Cheers, Mike
>
>
> --
> Michael Sumner
> Software and Database Engineer
> Australian Antarctic Division
> Hobart, Australia
> e-mail: mdsumner at gmail.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230401/7ef7bbfe/attachment.htm>

From dg0yt at darc.de  Sat Apr  1 01:27:41 2023
From: dg0yt at darc.de (Kai Pastor, DG0YT)
Date: Sat, 1 Apr 2023 10:27:41 +0200
Subject: [gdal-dev] Building GDAL with autoconf for Android on Windows
In-Reply-To: <CAC8biO2hrifYT0M4nxZ1YSD_C2TAFFSsFFUcFNuCtCCTVgB8QQ@mail.gmail.com>
References: <CAC8biO2hrifYT0M4nxZ1YSD_C2TAFFSsFFUcFNuCtCCTVgB8QQ@mail.gmail.com>
Message-ID: <264149ab-c9ab-336d-d6cc-df23d94cb1ed@darc.de>

git bash, quotes, make, this seems to add a lot of complication when you 
could directly run cmake+ninja for fast builds on windows.

I think you shoudn't try to pass escaped quotes, but just quote the 
whole arguments as in

 ?... "-DINST_DATA=/c/prefix_path/shared" 
"-DSYSCONF_DIR=/c/prefix_path/etc" ...

Regards, Kai


Am 31.03.23 um 02:28 schrieb Andrew Patterson:
> Hello!
>
> We've been using a custom CMakeLists.txt for years to build a subset 
> of GDAL for Android but I'm attempting to move us to building it 
> properly. Unfortunately, we can't move to 3.5+ quite yet (I'm hoping 
> soon) so I'm stuck with autoconf. I was happily surprised at how 
> quickly I passed through the configure step (many thanks Google's NDK 
> page with a very helpful autoconf section) but now I'm running into a 
> rather stupid blocker.
>
> I'm building this using git bash on a Windows machine, and I suspect 
> that's the root of my problem. Basically, when I run make on my 
> configured system, it screws up the quoting on INST_DATA & 
> SYSCONF_DIR. The command being executed looks something like:
>
> ... yada yada ... -DINST_DATA=\"/c/prefix_path/shared\" 
> -DSYSCONF_DIR=\"/c/prefix_path/etc\"
>
> If I copy the command being executed and change that part to:
>
> ... yada yada ... -DINST_DATA="\"/c/prefix_path/shared\"" 
> -DSYSCONF_DIR="\"/c/prefix_path/etc\""
>
> It works. It also works if fully remove the defines for INST_DATA & 
> SYSCONF_DIR, which I know is safe because we never defined those in 
> our old CMakeLists.txt and everything worked fine (we were specifying 
> the properly locations ahead of time so it never needed to look in any 
> default places).
>
> Now, obviously manually copying the commands isn't the right fix, but 
> maybe someone knows how to fix the quoting? Or, frankly, is there an 
> option I'm missing (or some other magic trick) to tell it not to 
> include INST_DATA or SYSCONF_DIR at all?
>
> Any help here would be greatly appreciated! This looked like it was 
> going to be a quick job and it turned into a frustrating full-day 
> failure :(
>
> Avenza Systems Logo 
> <https://www.google.com/url?q=https://www.avenza.com/&source=gmail-html&ust=1678977468213000&usg=AOvVaw3ajVwWQPLnJ8kVQuKtUNKi> 
> 	
>
> *Andrew Patterson*
> Desktop Lead Architect
>
> +1 (416) 487-5116 x401
> 84 Merton St., Toronto, ON, M4S 1A1
>
> ///supply.founders.outreach 
> <https://www.google.com/url?q=https://www.avenza.com/about/contact/&source=gmail-html&ust=1678977468213000&usg=AOvVaw0_nt7MnUyk1lGZCRk6wICQ>
>
> AvenzaUC2023 Banner 
> <https://www.google.com/url?q=https://www.avenza.com/user-conference/&source=gmail-html&ust=1678977468213000&usg=AOvVaw2Uj9MQv3vk5IzdDU7m0ycG> 
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230401/cd117f8c/attachment-0001.htm>

From even.rouault at spatialys.com  Sat Apr  1 03:03:03 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 1 Apr 2023 12:03:03 +0200
Subject: [gdal-dev] recent change?, issue with OGRGeometryFactory in R
In-Reply-To: <CAAcGz98+3BTib0VK8NAe2c5NTeWMbBR5VA1cXYuMvcA07TRQsg@mail.gmail.com>
References: <CAAcGz98+3BTib0VK8NAe2c5NTeWMbBR5VA1cXYuMvcA07TRQsg@mail.gmail.com>
Message-ID: <da67cdd0-16aa-bcaa-71aa-6aab783169be@spatialys.com>

Michael,

There have indeed been recent changes in const correctness of a few 
methods returning or accepting a OGRSpatialReference* (cf 
https://github.com/OSGeo/gdal/pull/7381), including 
OGRGeometryFactory::createmFromWkt().

This requires a rebuild of code depending on the GDAL C++ API, as the 
GDAL ABI generally changes between feature versions.

Even

Le 01/04/2023 ? 07:24, Michael Sumner a ?crit?:
> Hi,
>
> I'm here to ask for help finding where this issue is. If I use an 
> earlier build it still works (these are R packages sf and terra that 
> are well tested against previous releases).
>
> Has something changed with the headers structure?for 
> OGRGeometryFactory perhaps? (I'm out of my depth for how to track this 
> down).? ?If it's an issue on the R side I'll fix it there, but mostly 
> I'm here to ask what has changed on the GDAL side to result in this 
> symbol problem (or whatever it is I'm doing wrong).
>
> using latest build??24afc75d3c3f2c85621e8b8d83f54a73b1d3ad33
>
> I see
>
> > library(sf)
> Error: package or namespace load failed for ?sf? in dyn.load(file, 
> DLLpath = DLLpath, ...):
> ?unable to load shared object 
> '/usr/local/lib/R/site-library/sf/libs/sf.so':
> ? /usr/local/lib/R/site-library/sf/libs/sf.so: undefined symbol: 
> _ZN18OGRGeometryFactory13createFromWktEPKcP19OGRSpatialReferencePP11OGRGeometry
> > library(terra)
> Error: package or namespace load failed for ?terra? in dyn.load(file, 
> DLLpath = DLLpath, ...):
> ?unable to load shared object 
> '/usr/local/lib/R/site-library/terra/libs/terra.so':
> ? /usr/local/lib/R/site-library/terra/libs/terra.so: undefined symbol: 
> _ZN18OGRGeometryFactory13createFromWktEPKcP19OGRSpatialReferencePP11OGRGeometry
>
> Using a prior build?eca6f7bf17fe500ef4c0ba9793e93ea305bab1fc it works.
>
> The offending code in terra is this (I think)
>
> https://github.com/rspatial/terra/blob/ddcf84ce901a269ac13118d650efac16f89a8602/src/read_ogr.cpp#L694
>
> In sf it is
>
>
> https://github.com/r-spatial/sf/blob/main/src/gdal_read.cpp#L582
> Thank you.
>
> Cheers, Mike
>
>
> -- 
> Michael Sumner
> Software and Database Engineer
> Australian Antarctic Division
> Hobart, Australia
> e-mail: mdsumner at gmail.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230401/5645c6ca/attachment.htm>

From mdsumner at gmail.com  Sat Apr  1 03:09:23 2023
From: mdsumner at gmail.com (Michael Sumner)
Date: Sat, 1 Apr 2023 21:09:23 +1100
Subject: [gdal-dev] recent change?, issue with OGRGeometryFactory in R
In-Reply-To: <da67cdd0-16aa-bcaa-71aa-6aab783169be@spatialys.com>
References: <CAAcGz98+3BTib0VK8NAe2c5NTeWMbBR5VA1cXYuMvcA07TRQsg@mail.gmail.com>
 <da67cdd0-16aa-bcaa-71aa-6aab783169be@spatialys.com>
Message-ID: <CAAcGz9_JgX7s2qgxciSj8Z6e3hB+Jnjeif4dnSJ9=Ac7ORyTJA@mail.gmail.com>

ah, thanks so much - maybe I'm seeing partial build problems on one
machine, but at any rate this gives me enough to explore and figure it out.

Best, Mike

On Sat, 1 Apr 2023, 21:03 Even Rouault, <even.rouault at spatialys.com> wrote:

> Michael,
>
> There have indeed been recent changes in const correctness of a few
> methods returning or accepting a OGRSpatialReference* (cf
> https://github.com/OSGeo/gdal/pull/7381), including
> OGRGeometryFactory::createmFromWkt().
>
> This requires a rebuild of code depending on the GDAL C++ API, as the GDAL
> ABI generally changes between feature versions.
>
> Even
> Le 01/04/2023 ? 07:24, Michael Sumner a ?crit :
>
> Hi,
>
> I'm here to ask for help finding where this issue is. If I use an earlier
> build it still works (these are R packages sf and terra that are well
> tested against previous releases).
>
> Has something changed with the headers structure for OGRGeometryFactory
> perhaps? (I'm out of my depth for how to track this down).   If it's an
> issue on the R side I'll fix it there, but mostly I'm here to ask what has
> changed on the GDAL side to result in this symbol problem (or whatever it
> is I'm doing wrong).
>
> using latest build  24afc75d3c3f2c85621e8b8d83f54a73b1d3ad33
>
> I see
>
> > library(sf)
> Error: package or namespace load failed for ?sf? in dyn.load(file, DLLpath
> = DLLpath, ...):
>  unable to load shared object
> '/usr/local/lib/R/site-library/sf/libs/sf.so':
>   /usr/local/lib/R/site-library/sf/libs/sf.so: undefined symbol:
> _ZN18OGRGeometryFactory13createFromWktEPKcP19OGRSpatialReferencePP11OGRGeometry
> > library(terra)
> Error: package or namespace load failed for ?terra? in dyn.load(file,
> DLLpath = DLLpath, ...):
>  unable to load shared object
> '/usr/local/lib/R/site-library/terra/libs/terra.so':
>   /usr/local/lib/R/site-library/terra/libs/terra.so: undefined symbol:
> _ZN18OGRGeometryFactory13createFromWktEPKcP19OGRSpatialReferencePP11OGRGeometry
>
> Using a prior build eca6f7bf17fe500ef4c0ba9793e93ea305bab1fc it works.
>
> The offending code in terra is this (I think)
>
>
> https://github.com/rspatial/terra/blob/ddcf84ce901a269ac13118d650efac16f89a8602/src/read_ogr.cpp#L694
>
> In sf it is
>
>
> https://github.com/r-spatial/sf/blob/main/src/gdal_read.cpp#L582
> Thank you.
>
> Cheers, Mike
>
>
> --
> Michael Sumner
> Software and Database Engineer
> Australian Antarctic Division
> Hobart, Australia
> e-mail: mdsumner at gmail.com
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230401/5e8022b2/attachment.htm>

From strk at kbt.io  Sat Apr  1 13:21:44 2023
From: strk at kbt.io (Sandro Santilli)
Date: Sat, 1 Apr 2023 22:21:44 +0200
Subject: [gdal-dev] Report on GEOS maintenance grant
In-Reply-To: <CA+K_q_q67yNR_9aSvD4dX0t1Yj4yiR+auW8T76on7=LDBagEqQ@mail.gmail.com>
References: <CA+K_q_q67yNR_9aSvD4dX0t1Yj4yiR+auW8T76on7=LDBagEqQ@mail.gmail.com>
Message-ID: <20230401202144.3lvf2go47xbwb4fk@c19>

On Mon, Feb 27, 2023 at 09:32:58AM -0500, Daniel Baston wrote:
> 
> For anyone who?s interested, I wanted to share a few of the highlights from
> my perspective.

Great work Daniel, thanks to you and to the GDAL PSC for the opportunity !

--strk; 

  Libre GIS consultant/developer
  https://strk.kbt.io/services.html

From andrew at avenza.com  Sat Apr  1 16:27:11 2023
From: andrew at avenza.com (Andrew Patterson)
Date: Sat, 1 Apr 2023 19:27:11 -0400
Subject: [gdal-dev] Building GDAL with autoconf for Android on Windows
In-Reply-To: <264149ab-c9ab-336d-d6cc-df23d94cb1ed@darc.de>
References: <CAC8biO2hrifYT0M4nxZ1YSD_C2TAFFSsFFUcFNuCtCCTVgB8QQ@mail.gmail.com>
 <264149ab-c9ab-336d-d6cc-df23d94cb1ed@darc.de>
Message-ID: <CAC8biO1=wm0HpUufpU-9y2NrC7eRUwwqZYg=_cifu6cjBhOREw@mail.gmail.com>

My options are rather limited unfortunately. I'd love to bump our GDAL from
3.3.0 to 3.5.0+ to pick up the CMake, but I'm not able to do that right
now. So I'm stuck building it for Android in Git bash with the pre-Cmake
options.

That said, in the end, I've given up on building it this way. I suspect it
works just fine and all my problems are related to Git bash's trouble with
spaces. We were using a custom CMake file I was hoping to avoid using, but
after three solid days of bashing my head against this, I'm throwing in the
towel and I'll just roll my own temporary CMake. Which I guess is what you
were suggesting anyways!

Thanks for the input. It helped tip me over into doing the manual CMake
thing. I can't wait to throw it away and use the 'out-of-the-box' version,
but that may be a few months away :P

On Sat, Apr 1, 2023 at 4:35?AM Kai Pastor, DG0YT <dg0yt at darc.de> wrote:

> git bash, quotes, make, this seems to add a lot of complication when you
> could directly run cmake+ninja for fast builds on windows.
>
> I think you shoudn't try to pass escaped quotes, but just quote the whole
> arguments as in
>
>  ... "-DINST_DATA=/c/prefix_path/shared"
> "-DSYSCONF_DIR=/c/prefix_path/etc" ...
>
> Regards, Kai
>
>
> Am 31.03.23 um 02:28 schrieb Andrew Patterson:
>
> Hello!
>
> We've been using a custom CMakeLists.txt for years to build a subset of
> GDAL for Android but I'm attempting to move us to building it properly.
> Unfortunately, we can't move to 3.5+ quite yet (I'm hoping soon) so I'm
> stuck with autoconf. I was happily surprised at how quickly I passed
> through the configure step (many thanks Google's NDK page with a very
> helpful autoconf section) but now I'm running into a rather stupid blocker.
>
> I'm building this using git bash on a Windows machine, and I suspect
> that's the root of my problem. Basically, when I run make on my configured
> system, it screws up the quoting on INST_DATA & SYSCONF_DIR. The command
> being executed looks something like:
>
> ... yada yada ... -DINST_DATA=\"/c/prefix_path/shared\"
> -DSYSCONF_DIR=\"/c/prefix_path/etc\"
>
> If I copy the command being executed and change that part to:
>
> ... yada yada ... -DINST_DATA="\"/c/prefix_path/shared\""
> -DSYSCONF_DIR="\"/c/prefix_path/etc\""
>
> It works. It also works if fully remove the defines for INST_DATA &
> SYSCONF_DIR, which I know is safe because we never defined those in our old
> CMakeLists.txt and everything worked fine (we were specifying the properly
> locations ahead of time so it never needed to look in any default places).
>
> Now, obviously manually copying the commands isn't the right fix, but
> maybe someone knows how to fix the quoting? Or, frankly, is there an option
> I'm missing (or some other magic trick) to tell it not to include INST_DATA
> or SYSCONF_DIR at all?
>
> Any help here would be greatly appreciated! This looked like it was going
> to be a quick job and it turned into a frustrating full-day failure :(
>
> [image: Avenza Systems Logo]
> <https://www.google.com/url?q=https://www.avenza.com/&source=gmail-html&ust=1678977468213000&usg=AOvVaw3ajVwWQPLnJ8kVQuKtUNKi>
>
> *Andrew Patterson*
> Desktop Lead Architect
>
> +1 (416) 487-5116 x401
> 84 Merton St., Toronto, ON, M4S 1A1
>
> ///supply.founders.outreach
> <https://www.google.com/url?q=https://www.avenza.com/about/contact/&source=gmail-html&ust=1678977468213000&usg=AOvVaw0_nt7MnUyk1lGZCRk6wICQ>
> [image: AvenzaUC2023 Banner]
> <https://www.google.com/url?q=https://www.avenza.com/user-conference/&source=gmail-html&ust=1678977468213000&usg=AOvVaw2Uj9MQv3vk5IzdDU7m0ycG>
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
[image: Avenza Systems Logo]
<https://www.google.com/url?q=https://www.avenza.com/&source=gmail-html&ust=1678977468213000&usg=AOvVaw3ajVwWQPLnJ8kVQuKtUNKi>

*Andrew Patterson*
Desktop Lead Architect

+1 (416) 487-5116 x401
84 Merton St., Toronto, ON, M4S 1A1

///supply.founders.outreach
<https://www.google.com/url?q=https://www.avenza.com/about/contact/&source=gmail-html&ust=1678977468213000&usg=AOvVaw0_nt7MnUyk1lGZCRk6wICQ>
[image: AvenzaUC2023 Banner]
<https://www.google.com/url?q=https://www.avenza.com/user-conference/&source=gmail-html&ust=1678977468213000&usg=AOvVaw2Uj9MQv3vk5IzdDU7m0ycG>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230401/5d4f9940/attachment.htm>

From mdsumner at gmail.com  Sun Apr  2 03:01:03 2023
From: mdsumner at gmail.com (Michael Sumner)
Date: Sun, 2 Apr 2023 20:01:03 +1000
Subject: [gdal-dev] recent change?, issue with OGRGeometryFactory in R
In-Reply-To: <CAAcGz9_JgX7s2qgxciSj8Z6e3hB+Jnjeif4dnSJ9=Ac7ORyTJA@mail.gmail.com>
References: <CAAcGz98+3BTib0VK8NAe2c5NTeWMbBR5VA1cXYuMvcA07TRQsg@mail.gmail.com>
 <da67cdd0-16aa-bcaa-71aa-6aab783169be@spatialys.com>
 <CAAcGz9_JgX7s2qgxciSj8Z6e3hB+Jnjeif4dnSJ9=Ac7ORyTJA@mail.gmail.com>
Message-ID: <CAAcGz99XJtE+EpPPUH0dYne+jmW3YftsayJby070+DYBSuEuyA@mail.gmail.com>

I figured it out, I'd moved to from-source builds to /usr on a machine that
had apt installs to /usr/local so the stale headers were in the way.

A good lesson for me (don't do what I'm doing it's fraught haha) and just a
note to clear the air.

Cheers, Mike



On Sat, 1 Apr 2023, 21:09 Michael Sumner, <mdsumner at gmail.com> wrote:

> ah, thanks so much - maybe I'm seeing partial build problems on one
> machine, but at any rate this gives me enough to explore and figure it out.
>
> Best, Mike
>
> On Sat, 1 Apr 2023, 21:03 Even Rouault, <even.rouault at spatialys.com>
> wrote:
>
>> Michael,
>>
>> There have indeed been recent changes in const correctness of a few
>> methods returning or accepting a OGRSpatialReference* (cf
>> https://github.com/OSGeo/gdal/pull/7381), including
>> OGRGeometryFactory::createmFromWkt().
>>
>> This requires a rebuild of code depending on the GDAL C++ API, as the
>> GDAL ABI generally changes between feature versions.
>>
>> Even
>> Le 01/04/2023 ? 07:24, Michael Sumner a ?crit :
>>
>> Hi,
>>
>> I'm here to ask for help finding where this issue is. If I use an earlier
>> build it still works (these are R packages sf and terra that are well
>> tested against previous releases).
>>
>> Has something changed with the headers structure for OGRGeometryFactory
>> perhaps? (I'm out of my depth for how to track this down).   If it's an
>> issue on the R side I'll fix it there, but mostly I'm here to ask what has
>> changed on the GDAL side to result in this symbol problem (or whatever it
>> is I'm doing wrong).
>>
>> using latest build  24afc75d3c3f2c85621e8b8d83f54a73b1d3ad33
>>
>> I see
>>
>> > library(sf)
>> Error: package or namespace load failed for ?sf? in dyn.load(file,
>> DLLpath = DLLpath, ...):
>>  unable to load shared object
>> '/usr/local/lib/R/site-library/sf/libs/sf.so':
>>   /usr/local/lib/R/site-library/sf/libs/sf.so: undefined symbol:
>> _ZN18OGRGeometryFactory13createFromWktEPKcP19OGRSpatialReferencePP11OGRGeometry
>> > library(terra)
>> Error: package or namespace load failed for ?terra? in dyn.load(file,
>> DLLpath = DLLpath, ...):
>>  unable to load shared object
>> '/usr/local/lib/R/site-library/terra/libs/terra.so':
>>   /usr/local/lib/R/site-library/terra/libs/terra.so: undefined symbol:
>> _ZN18OGRGeometryFactory13createFromWktEPKcP19OGRSpatialReferencePP11OGRGeometry
>>
>> Using a prior build eca6f7bf17fe500ef4c0ba9793e93ea305bab1fc it works.
>>
>> The offending code in terra is this (I think)
>>
>>
>> https://github.com/rspatial/terra/blob/ddcf84ce901a269ac13118d650efac16f89a8602/src/read_ogr.cpp#L694
>>
>> In sf it is
>>
>>
>> https://github.com/r-spatial/sf/blob/main/src/gdal_read.cpp#L582
>> Thank you.
>>
>> Cheers, Mike
>>
>>
>> --
>> Michael Sumner
>> Software and Database Engineer
>> Australian Antarctic Division
>> Hobart, Australia
>> e-mail: mdsumner at gmail.com
>>
>> _______________________________________________
>> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>> -- http://www.spatialys.com
>> My software is free, but my time generally not.
>>
>>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230402/8b3f1efd/attachment-0001.htm>

From a09550 at gmail.com  Mon Apr  3 05:29:04 2023
From: a09550 at gmail.com (Pham Huu Bang)
Date: Mon, 3 Apr 2023 14:29:04 +0200
Subject: [gdal-dev] [Question]Output from gdal_translate projwin is
 different from geoserver WCS GetCoverage request?
Message-ID: <CAJGa3-k8TQFPyX_y3opP=Fg1mpTv0CcEW=FJiYCqZB55E5tJZg@mail.gmail.com>

Hello,

I've a hard time understanding which one should be the correct result by
gdal_translate or GeoServer.

My system (Ubuntu 22.04) has:
- GDAL 3.4.1
- Geoserver 2.22 running on Tomcat on port 9090

I have a small tiff file (link to download at the bottom of this thread) in
EPSG:4326, then I wanted to have a small subset on Lat and Long axes from
it by running:

-  gdal_translate -projwin 137.915315044103 -36.51629558851893
154.64770004642423 -40.081875882617666 test.tif gdal.tif


- curl '
http://localhost:9090/geoserver/wcs?service=WCS&version=2.0.1&request=GetCoverage&format=image/tiff&coverageId=test_raster:output&subset=Lat(-40.081875882617666,-36.51629558851893)&subset=Long(137.915315044103,154.64770004642423)'
-o geoserver.tiff

- Then gdalinfo gdal.tif returns:

Size is 17, 4

and gdalinfo geoserver.tif returns

Size is 17, 3

- Also the geo bbox of gdal.tif and geoserver.tif are different.
First file gives:

Upper Left  ( 136.9750000, -35.9750000)

Second file gives:

Upper Left  ( 137.9750000, -36.9750000)


More importantly, the pixels are shifted from gdal.tif at the top to
geoserver.tif at the bottom which you can see from this image:
https://imgur.com/a/L0vKvYk

Here is the link to download test.tif, gdal.tif and geoserver.tif
https://drive.google.com/file/d/1dawCy38FMwx4J7OQsky-gAHHOXsMuDcy/view?usp=sharing

Please share your opinion which result (gdal.tif or geoserver.tif) should
be correct?

Thanks,
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230403/a314e059/attachment.htm>

From public at postholer.com  Mon Apr  3 06:11:03 2023
From: public at postholer.com (Scott)
Date: Mon, 3 Apr 2023 06:11:03 -0700
Subject: [gdal-dev] [Question]Output from gdal_translate projwin is
 different from geoserver WCS GetCoverage request?
In-Reply-To: <CAJGa3-k8TQFPyX_y3opP=Fg1mpTv0CcEW=FJiYCqZB55E5tJZg@mail.gmail.com>
References: <CAJGa3-k8TQFPyX_y3opP=Fg1mpTv0CcEW=FJiYCqZB55E5tJZg@mail.gmail.com>
Message-ID: <2d52790d-1e20-7f94-8df0-55c948e9330d@postholer.com>

If I run:
gdal_translate -projwin 137.915315044103 -36.51629558851893 
154.64770004642423 -40.081875882617666 geoserver.tif new.tif

It completes with warning:
Warning 1: Computed -srcwin -1 -1 17 4 falls partially outside raster 
extent. Going on however.

Try again with your -projwin values within your geoserver.tif extent and 
see what happens.

On 4/3/23 05:29, Pham Huu Bang wrote:
> Hello,
> 
> I've a hard time understanding which one should be the correct result by 
> gdal_translate or GeoServer.
> 
> My system (Ubuntu 22.04) has:
> -?GDAL 3.4.1
> - Geoserver 2.22 running on Tomcat on port 9090
> 
> I have a small tiff file (link to download at the bottom of this thread) 
> in EPSG:4326, then I wanted to have a small subset on Lat and Long axes 
> from it by running:
> 
> -??gdal_translate -projwin 137.915315044103 -36.51629558851893 
> 154.64770004642423 -40.081875882617666 test.tif gdal.tif
> 
> 
> - curl 
> 'http://localhost:9090/geoserver/wcs?service=WCS&version=2.0.1&request=GetCoverage&format=image/tiff&coverageId=test_raster:output&subset=Lat(-40.081875882617666,-36.51629558851893)&subset=Long(137.915315044103,154.64770004642423) <http://localhost:9090/geoserver/wcs?service=WCS&version=2.0.1&request=GetCoverage&format=image/tiff&coverageId=test_raster:output&subset=Lat(-40.081875882617666,-36.51629558851893)&subset=Long(137.915315044103,154.64770004642423)>' -o geoserver.tiff
> 
> - Then gdalinfo gdal.tif returns:
> 
> Size is 17, 4
> 
> and gdalinfo geoserver.tif returns
> 
> Size is 17, 3
> 
> - Also the geo bbox of gdal.tif and geoserver.tif are different.
> First file gives:
> 
> Upper Left ?( 136.9750000, -35.9750000)
> 
> Second file gives:
> 
> Upper Left ?( 137.9750000, -36.9750000)
> 
> 
> More importantly, the pixels are shifted from gdal.tif at the top to 
> geoserver.tif at the bottom which you can see from this image: 
> https://imgur.com/a/L0vKvYk <https://imgur.com/a/L0vKvYk>
> 
> Here is the link to download test.tif, gdal.tif and geoserver.tif 
> https://drive.google.com/file/d/1dawCy38FMwx4J7OQsky-gAHHOXsMuDcy/view?usp=sharing <https://drive.google.com/file/d/1dawCy38FMwx4J7OQsky-gAHHOXsMuDcy/view?usp=sharing>
> 
> Please share your opinion which result (gdal.tif or geoserver.tif) 
> should be correct?
> 
> Thanks,
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From a09550 at gmail.com  Mon Apr  3 08:01:28 2023
From: a09550 at gmail.com (Pham Huu Bang)
Date: Mon, 3 Apr 2023 17:01:28 +0200
Subject: [gdal-dev] [Question]Output from gdal_translate projwin is
 different from geoserver WCS GetCoverage request?
In-Reply-To: <CAJGa3-k8TQFPyX_y3opP=Fg1mpTv0CcEW=FJiYCqZB55E5tJZg@mail.gmail.com>
References: <CAJGa3-k8TQFPyX_y3opP=Fg1mpTv0CcEW=FJiYCqZB55E5tJZg@mail.gmail.com>
Message-ID: <CAJGa3-nj5y7xQjVi0cnzVr5NZyi7oJvcjpcxscebMTFr-6yXvw@mail.gmail.com>

Hi Scott,

gdal complained about the error because geoserver.tif has less pixels
than gdal.tif.

But that doesn't help answering my question.


>If I run:
>gdal_translate -projwin 137.915315044103 -36.51629558851893 154.64770004642423 -40.081875882617666 geoserver.tif new.tif

> It completes with warning:
> Warning 1: Computed -srcwin -1 -1 17 4 falls partially outside raster extent. Going on however.

> Try again with your -projwin values within your geoserver.tif extent and see what happens.





On Mon, 3 Apr 2023 at 14:29, Pham Huu Bang <a09550 at gmail.com> wrote:

> Hello,
>
> I've a hard time understanding which one should be the correct result by
> gdal_translate or GeoServer.
>
> My system (Ubuntu 22.04) has:
> - GDAL 3.4.1
> - Geoserver 2.22 running on Tomcat on port 9090
>
> I have a small tiff file (link to download at the bottom of this thread)
> in EPSG:4326, then I wanted to have a small subset on Lat and Long axes
> from it by running:
>
> -  gdal_translate -projwin 137.915315044103 -36.51629558851893
> 154.64770004642423 -40.081875882617666 test.tif gdal.tif
>
>
> - curl '
> http://localhost:9090/geoserver/wcs?service=WCS&version=2.0.1&request=GetCoverage&format=image/tiff&coverageId=test_raster:output&subset=Lat(-40.081875882617666,-36.51629558851893)&subset=Long(137.915315044103,154.64770004642423)'
> -o geoserver.tiff
>
> - Then gdalinfo gdal.tif returns:
>
> Size is 17, 4
>
> and gdalinfo geoserver.tif returns
>
> Size is 17, 3
>
> - Also the geo bbox of gdal.tif and geoserver.tif are different.
> First file gives:
>
> Upper Left  ( 136.9750000, -35.9750000)
>
> Second file gives:
>
> Upper Left  ( 137.9750000, -36.9750000)
>
>
> More importantly, the pixels are shifted from gdal.tif at the top to
> geoserver.tif at the bottom which you can see from this image:
> https://imgur.com/a/L0vKvYk
>
> Here is the link to download test.tif, gdal.tif and geoserver.tif
> https://drive.google.com/file/d/1dawCy38FMwx4J7OQsky-gAHHOXsMuDcy/view?usp=sharing
>
> Please share your opinion which result (gdal.tif or geoserver.tif) should
> be correct?
>
> Thanks,
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230403/84fa5749/attachment.htm>

From eruiz at aplitop.com  Tue Apr  4 01:43:10 2023
From: eruiz at aplitop.com (Elena Ruiz)
Date: Tue, 4 Apr 2023 08:43:10 +0000
Subject: [gdal-dev] Cannot find proj.db
In-Reply-To: <002301d9632b$f644d530$e2ce7f90$@aquaveo.com>
References: <3d652b5c-aa92-4a2a-85be-25316f1f7b0b.ba94d704-e79f-4907-b4e6-7c540f2b307c.bb10c360-4efc-4646-b365-772285d0f4c7@emailsignatures365.codetwo.com>
 <AM0P192MB049841D83ECB6689AC3BD764BB8E9@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>
 <002301d9632b$f644d530$e2ce7f90$@aquaveo.com>
Message-ID: <AM0P192MB04987262B452CC47E5CC46EFBB939@AM0P192MB0498.EURP192.PROD.OUTLOOK.COM>

Thank you very much,

I have put the files proj.db, proj.ini and proj.exe together with the dll proj_9_1.dll this solved the problem when I use gdal executables like gdalwarp.exe
and also I have added OSRSetPROJSearchPaths(), when I use the gdal API,
and it works correctly for me in all cases,
so it seems that the path of the proj.db file in an environment variable was not enough.

Thank you very much and regards




________________________________


Elena Ruiz

[https://www.aplitop.com/descargas/logo.png]
Sofware Development & Technical Support
Tel.: +34 952 43 97 71
eruiz at aplitop.com
www.aplitop.com




<http://www.aplitop.com/Product/es/6/5/tcptunnel>


<http://www.aplitop.com/New/es/281/mdt-75-a-la-venta>




De: Chris Smemoe <csmemoe at aquaveo.com>
Enviado el: jueves, 30 de marzo de 2023 19:21
Para: Elena Ruiz <eruiz at aplitop.com>; gdal-dev at lists.osgeo.org
Asunto: RE: [gdal-dev] Cannot find proj.db

Elena,

I have had this same problem.  We have a few methods of setting the location of the proj.db file.  When we call from C++ (or from python), there's a function called OSRSetPROJSearchPaths that's handy.  If you're calling from a command line, you could try setting your environment variable just before calling your function (set "PROJ_LIB=c:\path\to\proj\"). I think there's also a command line option to set your PROJ_LIB.  You could try adding "--config PROJ_LIB "c:\path\to\proj"" to your command line and see what that does.  I haven't personally tried it.

I haven't had to do these things as much with the python/conda distributions of the commandline programs for whatever reason.

HTH,

Chris

From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Elena Ruiz
Sent: Thursday, March 30, 2023 6:02 AM
To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Subject: [gdal-dev] Cannot find proj.db

Hello,
I am using GDAL 3.6.2 on Windows 11 and am having problems with the following error:

ERROR 1: PROJ: proj_create_from_database: Cannot find proj.db

I have set as environment variable PROJ_LIB= "D:\MDT\V9\bin\gdal\gdal_latest\share"  and PROJ_DATA= "D:\MDT\V9\bin\gdal\gdal_latest\share", as user variable and in the system variable, but it still doesn't work and the file proj.db exits in D:\MDT\V9\bin\gdal\gdal_latest\share  .

D:\MDT\V9\bin\gdal\gdal_latest\x64>gdalwarp -s_srs EPSG:4326 -t_srs EPSG:25831 -r near -of GTiff C:\Users\elena\Downloads\D37531385_0101_DTM.asc C:/Users/elena/Downloads/D37531385_0101_DTM_25831_qgis_.tif
ERROR 1: PROJ: proj_create_from_database: Cannot find proj.db
ERROR 1: Translating source or target SRS failed:
EPSG:4326

The funny thing is that I have the same version of GDAL installed on my computer using Anaconda3, to do tests, and from the anaconda directory it works for me, and if I look in the environment variables I don't see any path that refers to where Anaconda has the Proj.db. Is there another way to set the PROJ_LIB path besides adding an environment variable? Is there any way to know where the PROJ_LIB is looking for my version of GDAL?

C:\Users\elena\Anaconda3\envs\mygdal\Library\bin>gdalwarp -s_srs EPSG:4326 -t_srs EPSG:25831 -r near -of GTiff C:\Users\elena\Downloads\D37531385_0101_DTM.asc C:/Users/elena/Downloads/D37531385_0101_DTM_25831_qgis_.tif
Creating output file that is 1003P x 1201L.
Processing C:\Users\elena\Downloads\D37531385_0101_DTM.asc [1/1] : 0Using internal nodata values (e.g. -9999) for image C:\Users\elena\Downloads\D37531385_0101_DTM.asc.
Copying nodata values from source C:\Users\elena\Downloads\D37531385_0101_DTM.asc to destination C:/Users/elena/Downloads/D37531385_0101_DTM_25831_qgis_.tif.
...10...20...30...40...50...60...70...80...90...100 - done.

Thank you and regards
________________________________

[https://www.aplitop.com/descargas/firma1.jpg]

Elena Ruiz
Sofware Development & Technical Support
Tel. +34 952 43 97 71
eruiz at aplitop.com<mailto:eruiz at aplitop.com>
Sumatra, 9 - 29190 M?laga (Spain)
www.aplitop.com<http://www.aplitop.com>

[cid:image001.jpg at 01D966E2.3C7E4310]<https://www.facebook.com/AplitopSL/>   [cid:image002.jpg at 01D966E2.3C7E4310] <https://twitter.com/aplitop>    [cid:image003.jpg at 01D966E2.3C7E4310] <https://www.linkedin.com/company/aplitop>    [cid:image004.png at 01D966E2.3C7E4310] <https://www.youtube.com/user/aplitop>


In accordance with the provisions of the European Regulation of Data Protection 2016/679 (Reglamento Europeo de Protecci?n de Datos 2016/679), we inform you that the data and the information you provide us through this medium will be used by APLITOP, S.L., with C.I.F. B-92543396 and with address at C / Sumatra, 9, Malaga, 29190, in order to answer your questions and inform you about our products. The data provided will be kept as long as it does not request its cessation and will not be transferred to third parties except in cases where there is a legal obligation. You have the right to access your personal data, correct inaccurate data or request its deletion when the data is no longer necessary for the purposes that were collected, as well as any rights recognized in the RGPD 2016/679



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230404/6b9afc81/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.jpg
Type: image/jpeg
Size: 718 bytes
Desc: image001.jpg
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230404/6b9afc81/attachment-0003.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image002.jpg
Type: image/jpeg
Size: 712 bytes
Desc: image002.jpg
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230404/6b9afc81/attachment-0004.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image003.jpg
Type: image/jpeg
Size: 737 bytes
Desc: image003.jpg
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230404/6b9afc81/attachment-0005.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image004.png
Type: image/png
Size: 672 bytes
Desc: image004.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230404/6b9afc81/attachment-0001.png>

From dnewhall at carlsonsw.com  Wed Apr  5 21:40:04 2023
From: dnewhall at carlsonsw.com (Derek Newhall)
Date: Thu, 6 Apr 2023 00:40:04 -0400
Subject: [gdal-dev] Static link all optional libraries into gdal.dll
Message-ID: <CAA1reb2rXe-fphTPjMWt05XKfZF9=Qss-RBOryt5HGkKFDRZAw@mail.gmail.com>

Hi,

We want to produce a version of gdal.dll with all the libraries we link
against statically linked. We had it working with Nmake in 3.5.1 but can't
seem to get it working with CMake in 3.6.2.

We only link against the following libraries: XercesC, ECW, PDFium,
OpenSSL, CURL, Expat, Sqlite3.

All the libraries pointed to in the associated *_LIBRARY CMake variables
are the .lib files and we tried option(BUILD_SHARED_LIBS OFF) but that
didn't work.

Is there some setting to specify static linking? I notice some packages
have *_IS_STATIC or *_USE_STATIC

Thanks,

Derek Newhall

Disclaimer

The information contained in this communication from the sender is confidential. It is intended solely for use by the recipient and others authorized to receive it. If you are not the recipient, you are hereby notified that any disclosure, copying, distribution or taking action in relation of the contents of this information is strictly prohibited and may be unlawful.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230406/f6355881/attachment.htm>

From bontepaarden at gmail.com  Fri Apr  7 02:33:38 2023
From: bontepaarden at gmail.com (Paul Meems)
Date: Fri, 7 Apr 2023 11:33:38 +0200
Subject: [gdal-dev] Convert grid to polygon shapefile
Message-ID: <CAHNf2YS=BW5z0Sww4Dt0Reo9AqD79WiDbgZoihANd2SYVrWPgQ@mail.gmail.com>

Hello List,
I'm working on a C# application that uses Golden Software Surfer to create
maps, but I also need to export the data to a polygon shapefile.
Unfortunately, Surfer creates a shapefile with shapes on top of each other
instead of inside each other, and Golden Software support couldn't help
with this issue.

I have a grid-file in Surfer Bin Grid format that can be converted to other
raster formats, a border shapefile created using ST_Convexhull, and a text
file indicating the values of the polygons.

[image: image.png]

Can anyone recommend a way to use GDAL/OGR to make a polygon shapefile from
these resources, or suggest an alternative approach?

Regards,

Paul
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230407/57c9077f/attachment.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image.png
Type: image/png
Size: 17410 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230407/57c9077f/attachment.png>

From runette at gmail.com  Mon Apr 10 01:57:57 2023
From: runette at gmail.com (Paul Harwood)
Date: Mon, 10 Apr 2023 09:57:57 +0100
Subject: [gdal-dev] Convert grid to polygon shapefile
In-Reply-To: <CAHNf2YS=BW5z0Sww4Dt0Reo9AqD79WiDbgZoihANd2SYVrWPgQ@mail.gmail.com>
References: <CAHNf2YS=BW5z0Sww4Dt0Reo9AqD79WiDbgZoihANd2SYVrWPgQ@mail.gmail.com>
Message-ID: <CAE8nN5P99o+8cdgdXuBE03o_MpAmJVsUaq4d0CMJLbKKKPOmjA@mail.gmail.com>

If you have the raster version, what about this
https://gdal.org/programs/gdal_polygonize.html ?

On Fri, 7 Apr 2023 at 10:34, Paul Meems <bontepaarden at gmail.com> wrote:

> Hello List,
> I'm working on a C# application that uses Golden Software Surfer to create
> maps, but I also need to export the data to a polygon shapefile.
> Unfortunately, Surfer creates a shapefile with shapes on top of each other
> instead of inside each other, and Golden Software support couldn't help
> with this issue.
>
> I have a grid-file in Surfer Bin Grid format that can be converted to
> other raster formats, a border shapefile created using ST_Convexhull, and a
> text file indicating the values of the polygons.
>
> [image: image.png]
>
> Can anyone recommend a way to use GDAL/OGR to make a polygon shapefile
> from these resources, or suggest an alternative approach?
>
> Regards,
>
> Paul
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230410/0f9f0764/attachment.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image.png
Type: image/png
Size: 17410 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230410/0f9f0764/attachment.png>

From pcreso at yahoo.com  Mon Apr 10 14:10:05 2023
From: pcreso at yahoo.com (Brent Wood)
Date: Mon, 10 Apr 2023 21:10:05 +0000 (UTC)
Subject: [gdal-dev] Convert grid to polygon shapefile
In-Reply-To: <CAE8nN5P99o+8cdgdXuBE03o_MpAmJVsUaq4d0CMJLbKKKPOmjA@mail.gmail.com>
References: <CAHNf2YS=BW5z0Sww4Dt0Reo9AqD79WiDbgZoihANd2SYVrWPgQ@mail.gmail.com>
 <CAE8nN5P99o+8cdgdXuBE03o_MpAmJVsUaq4d0CMJLbKKKPOmjA@mail.gmail.com>
Message-ID: <2066540754.1861603.1681161005598@mail.yahoo.com>

 I have done this with QGIS, if you have a grid with categorised values, QGIS can generate a polygon shapefile with the cell boundaries merged by cell value.
QGIS uses gdal_polygonize.py under the hood to do this (via a simple GUI interface), so if you work out the command line parameters you need, you could run it from the command line.

HTH,
Brent Wood


On Fri, 7 Apr 2023 at 10:34, Paul Meems <bontepaarden at gmail.com> wrote:

Hello List,I'm working on a C# application that uses Golden Software Surfer to create maps, but I also need to export the data to a polygon shapefile.?Unfortunately, Surfer creates a shapefile with shapes on top of each other instead of inside each other, and Golden Software support couldn't help with this issue.?
I have a grid-file in Surfer Bin Grid format that can be converted to other raster formats, a border shapefile created using ST_Convexhull, and a text file indicating the values of the polygons.?


Can anyone recommend a way to use GDAL/OGR to make a polygon shapefile from these resources, or suggest an alternative approach?
Regards,
Paul

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev
  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230410/3fe91386/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image.png
Type: image/png
Size: 17410 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230410/3fe91386/attachment-0001.png>

From bontepaarden at gmail.com  Tue Apr 11 03:14:18 2023
From: bontepaarden at gmail.com (Paul Meems)
Date: Tue, 11 Apr 2023 12:14:18 +0200
Subject: [gdal-dev] Convert grid to polygon shapefile
In-Reply-To: <2066540754.1861603.1681161005598@mail.yahoo.com>
References: <CAHNf2YS=BW5z0Sww4Dt0Reo9AqD79WiDbgZoihANd2SYVrWPgQ@mail.gmail.com>
 <CAE8nN5P99o+8cdgdXuBE03o_MpAmJVsUaq4d0CMJLbKKKPOmjA@mail.gmail.com>
 <2066540754.1861603.1681161005598@mail.yahoo.com>
Message-ID: <CAHNf2YQCPjO93eymZfjaicVsR5i8roqBm6dAzuN5uW+oXJ1ezw@mail.gmail.com>

Thanks, Brent and Paul for your suggestions.

I just tried gdal_polygonize.py and the result looks OK, but the lines are
very jagged.

I also tried gdal_contour and it has the option to create polygons. And
that result is looking better.
And gdal_contour is also easier to call from a C# application that a Python
script ;)

I need to investigate further but I'll use gdal_contour.

Thanks,

Paul

Op ma 10 apr 2023 om 23:10 schreef Brent Wood <pcreso at yahoo.com>:

> I have done this with QGIS, if you have a grid with categorised values,
> QGIS can generate a polygon shapefile with the cell boundaries merged by
> cell value.
>
> QGIS uses gdal_polygonize.py under the hood to do this (via a simple GUI
> interface), so if you work out the command line parameters you need, you
> could run it from the command line.
>
>
> HTH,
>
> Brent Wood
>
>
> On Fri, 7 Apr 2023 at 10:34, Paul Meems <bontepaarden at gmail.com> wrote:
>
> Hello List,
> I'm working on a C# application that uses Golden Software Surfer to create
> maps, but I also need to export the data to a polygon shapefile.
> Unfortunately, Surfer creates a shapefile with shapes on top of each other
> instead of inside each other, and Golden Software support couldn't help
> with this issue.
>
> I have a grid-file in Surfer Bin Grid format that can be converted to
> other raster formats, a border shapefile created using ST_Convexhull, and a
> text file indicating the values of the polygons.
>
> [image: image.png]
>
> Can anyone recommend a way to use GDAL/OGR to make a polygon shapefile
> from these resources, or suggest an alternative approach?
>
> Regards,
>
> Paul
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230411/c05a4068/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image.png
Type: image/png
Size: 17410 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230411/c05a4068/attachment-0001.png>

From arb at sat.dundee.ac.uk  Tue Apr 11 12:54:47 2023
From: arb at sat.dundee.ac.uk (Andrew Brooks)
Date: Tue, 11 Apr 2023 20:54:47 +0100
Subject: [gdal-dev] Off topic COG question
In-Reply-To: <CALtm4h0rkqsFic8JHkB6rBBxm1gODREfzaVZG0HDuTMHYdNQvQ@mail.gmail.com>
References: <CALtm4h0rkqsFic8JHkB6rBBxm1gODREfzaVZG0HDuTMHYdNQvQ@mail.gmail.com>
Message-ID: <CAHOfOo1O1z79J6jhHR76JhNdMtUzu2Khgy2MsU4qTQ7HYp8HTQ@mail.gmail.com>

I was trying to build a web app using only OpenLayers and COG files, which
I think would work, but I didn't finish it because the specific COG files I
had used a projection that wasn't supported by geotiff.js That was a couple
of years ago, I'm pretty sure there's plenty of examples out there using
openlayers or leaflet with COG files that need no tile server.

On Fri, 31 Mar 2023 at 16:54, Travis Kirstine <traviskirstine at gmail.com>
wrote:

> Sorry to post this unrelated question to the GDAL group but I was hoping
> someone could provide some recommendations.  Does anybody know of a way to
> efficiently publish a WTMS / TMS from a COG source.  I know I can use
> something like MapServer / Mapcache or GeoServer can use the cog as a
> raster source but this seems like additional overhead as the COG internal
> tiling and overview structure is already optimized.  I know of titiler but
> that is about it.  https://github.com/developmentseed/titiler
>
> Thanks
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230411/a27cee31/attachment.htm>

From jukka.rahkonen at maanmittauslaitos.fi  Tue Apr 11 12:55:41 2023
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Tue, 11 Apr 2023 19:55:41 +0000
Subject: [gdal-dev] CloudSQLite - useless invention or not?
Message-ID: <AM0PR09MB3219F194AA82A099B359F993FD9A9@AM0PR09MB3219.eurprd09.prod.outlook.com>

Hi,

I got a link into https://sqlite.org/cloudsqlite/doc/trunk/www/index.wiki in a GeoPackage meeting today and I wonder if that could be useful for something. Any opinions?

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230411/f12ab9f6/attachment.htm>

From even.rouault at spatialys.com  Tue Apr 11 13:59:33 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 11 Apr 2023 22:59:33 +0200
Subject: [gdal-dev] CloudSQLite - useless invention or not?
In-Reply-To: <AM0PR09MB3219F194AA82A099B359F993FD9A9@AM0PR09MB3219.eurprd09.prod.outlook.com>
References: <AM0PR09MB3219F194AA82A099B359F993FD9A9@AM0PR09MB3219.eurprd09.prod.outlook.com>
Message-ID: <cd5a54be-aa4f-1a49-b034-5a64bb5481e1@spatialys.com>

Hi Jukka,

Thanks for sharing. This seems to be quite a recent addition (end of 
2019 for the start of the public activity), so probably somewhat a bit 
experimental, at least probably not as mature as core SQLite (also 
reading this comment from a likely early user of the project which 
questions some essential design aspects: 
https://sqlite.org/cloudsqlite/forumpost/3856ce738d). It is somewhat an 
hybrid solution between the SQLite we know (mostly for local usage) and 
a traditional server-based SQL database, but actually closer to the 
former than the later. It doesn't fully cover multi-user / concurrent 
scenarios, compared to to a traditional server-based SQL database, so 
I'm a bit skeptical one would want to use that for "enterprise" needs. 
For read-only scenarios, I'm not sure how better if would compare to 
accessing a regular SQLite3 database through /vsicurl/ , /vsis3/ etc. 
Probably not that much (the local deamon? that maintain a cached version 
of downloaded blocks might help in some scenarios though), but of course 
that would need to be tested. The "cloud" term somewhat brings the usual 
expectations of "magic" happening on a server (or many!), but 
CloudSQlite is really just about remote storage of the database, so all 
requests are still processed on the client. If you run a request without 
indices, you might end up downloading the whole database. Or a statement 
like "UPDATE table SET some_column = some_value" will definitely require 
downloading & re-uploading the whole table.

So I wouldn't say this is useless, as if it was designed, it is 
hopefully to serve some particular use cases, but I suspect they are 
quite niche and that existing well-known server-based database solutions 
are probably a better choice in the general case.

Even

Le 11/04/2023 ? 21:55, Rahkonen Jukka a ?crit?:
>
> Hi,
>
> I got a link into 
> https://sqlite.org/cloudsqlite/doc/trunk/www/index.wiki 
> <https://sqlite.org/cloudsqlite/doc/trunk/www/index.wiki>in a 
> GeoPackage meeting today and I wonder if that could be useful for 
> something. Any opinions?
>
> -Jukka Rahkonen-
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230411/ebf4dd0d/attachment.htm>

From michael.smith.erdc at gmail.com  Wed Apr 12 01:36:10 2023
From: michael.smith.erdc at gmail.com (Michael Smith)
Date: Wed, 12 Apr 2023 04:36:10 -0400
Subject: [gdal-dev] Problem with file source projection doing a vertical
 datum reprojection
Message-ID: <AADE155E-B951-4290-9DA1-CE5C41CF37F9@gmail.com>

I have a file with a projection shown, using REPORT_COMPD_CS=TRUE of:

 

COMPOUNDCRS["WGS 84 / UTM zone 17N + unknown",

??? PROJCRS["WGS 84 / UTM zone 17N",

??????? BASEGEOGCRS["WGS 84",

??????????? DATUM["World Geodetic System 1984",

??????????????? ELLIPSOID["WGS 84",6378137,298.257223563,

??????????????????? LENGTHUNIT["metre",1]]],

??????????? PRIMEM["Greenwich",0,

??????????????? ANGLEUNIT["degree",0.0174532925199433]],

??????????? ID["EPSG",4326]],

??????? CONVERSION["UTM zone 17N",

??????????? METHOD["Transverse Mercator",

??????????????? ID["EPSG",9807]],

??????????? PARAMETER["Latitude of natural origin",0,

??????????????? ANGLEUNIT["degree",0.0174532925199433],

??????????????? ID["EPSG",8801]],

??????????? PARAMETER["Longitude of natural origin",-81,

??????????????? ANGLEUNIT["degree",0.0174532925199433],

??????????????? ID["EPSG",8802]],

??????????? PARAMETER["Scale factor at natural origin",0.9996,

??????????????? SCALEUNIT["unity",1],

??????????????? ID["EPSG",8805]],

?????? ?????PARAMETER["False easting",500000,

??????????????? LENGTHUNIT["metre",1],

??????????????? ID["EPSG",8806]],

??????????? PARAMETER["False northing",0,

??????????????? LENGTHUNIT["metre",1],

??????????????? ID["EPSG",8807]]],

??????? CS[Cartesian,2],

?? ?????????AXIS["easting",east,

??????????????? ORDER[1],

??????????????? LENGTHUNIT["metre",1]],

??????????? AXIS["northing",north,

??????????????? ORDER[2],

??????????????? LENGTHUNIT["metre",1]],

??????? ID["EPSG",32617]],

??? VERTCRS["unknown",

??????? VDATUM["unknown"],

??????? CS[vertical,1],

??????????? AXIS["up",up,

??????????????? LENGTHUNIT["metre",1,

??????????????????? ID["EPSG",9001]]]]]

 

When trying to gdalwarp to EGM2008 using gdalwarp -t_srs epsg:32617+3855, vertical datum reprojection does not occur unless I overwride the source srs with -s_srs epsg:32617. Using GDAL 3.6.2 and proj 9.1.1. With proj_debug, I can see that the PROJ_TRACE: vgridshift: is not occurring unless the srs is overridden. I?m fairly sure that this has worked in the past but I can?t say exactly which version. This is an older geotiff that was written about 7 years ago. 

 

 

-- 

Michael Smith

US Army Corps / Remote Sensing GIS Center

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230412/50ac63d5/attachment-0001.htm>

From even.rouault at spatialys.com  Wed Apr 12 02:24:55 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 12 Apr 2023 11:24:55 +0200
Subject: [gdal-dev] Problem with file source projection doing a vertical
 datum reprojection
In-Reply-To: <AADE155E-B951-4290-9DA1-CE5C41CF37F9@gmail.com>
References: <AADE155E-B951-4290-9DA1-CE5C41CF37F9@gmail.com>
Message-ID: <80281958-10e5-45a8-0dd1-f933237d82b0@spatialys.com>

Michael,

it is well possible this might have worked in the past due to slightly 
different behavior of GDAL and/or PROJ, but the current behavior seems 
consistent to me. You're trying to transform between 2 compound CRS, the 
source one with a unknown vertical datum and the target one with EGM2008 
height. There's nothing reasonable that PROJ can do regarding the 
vertical transformation in that situation, in particular it would be 
quite a bold assumption to assume that the source CRS is actually meant 
to be refering to ellipsoidal heights.? If you override with -s_srs 
EPSG:32617 (or drop REPORT_COMPD_CS=TRUE), then GDAL will auto-promote 
the source CRS to a 3D CRS with ellipsoidal heights, which could also be 
questionable from a purist point of view, but is the behaviour we have 
had for long now.

Even

Le 12/04/2023 ? 10:36, Michael Smith a ?crit?:
>
> I have a file with a projection shown, using REPORT_COMPD_CS=TRUE of:
>
> COMPOUNDCRS["WGS 84 / UTM zone 17N + unknown",
>
> ??? PROJCRS["WGS 84 / UTM zone 17N",
>
> ??????? BASEGEOGCRS["WGS 84",
>
> ??????????? DATUM["World Geodetic System 1984",
>
> ??????????????? ELLIPSOID["WGS 84",6378137,298.257223563,
>
> LENGTHUNIT["metre",1]]],
>
> ??????????? PRIMEM["Greenwich",0,
>
> ANGLEUNIT["degree",0.0174532925199433]],
>
> ??????????? ID["EPSG",4326]],
>
> ??????? CONVERSION["UTM zone 17N",
>
> ??????????? METHOD["Transverse Mercator",
>
> ??????????????? ID["EPSG",9807]],
>
> ??????????? PARAMETER["Latitude of natural origin",0,
>
> ANGLEUNIT["degree",0.0174532925199433],
>
> ??????????????? ID["EPSG",8801]],
>
> ??????????? PARAMETER["Longitude of natural origin",-81,
>
> ANGLEUNIT["degree",0.0174532925199433],
>
> ??????????????? ID["EPSG",8802]],
>
> ??????????? PARAMETER["Scale factor at natural origin",0.9996,
>
> ??????????????? SCALEUNIT["unity",1],
>
> ??????????????? ID["EPSG",8805]],
>
> ?????? ?????PARAMETER["False easting",500000,
>
> ??????????????? LENGTHUNIT["metre",1],
>
> ??????????????? ID["EPSG",8806]],
>
> ??????????? PARAMETER["False northing",0,
>
> ??????????????? LENGTHUNIT["metre",1],
>
> ??????????????? ID["EPSG",8807]]],
>
> ??????? CS[Cartesian,2],
>
> ?? ?????????AXIS["easting",east,
>
> ??????????????? ORDER[1],
>
> ??????????????? LENGTHUNIT["metre",1]],
>
> ??????????? AXIS["northing",north,
>
> ??????????????? ORDER[2],
>
> ??????????????? LENGTHUNIT["metre",1]],
>
> ??????? ID["EPSG",32617]],
>
> ??? VERTCRS["unknown",
>
> ??????? VDATUM["unknown"],
>
> ??????? CS[vertical,1],
>
> ??????????? AXIS["up",up,
>
> ??????????????? LENGTHUNIT["metre",1,
>
> ??????????????????? ID["EPSG",9001]]]]]
>
> When trying to gdalwarp to EGM2008 using gdalwarp -t_srs 
> epsg:32617+3855, vertical datum reprojection does not occur unless I 
> overwride the source srs with -s_srs epsg:32617. Using GDAL 3.6.2 and 
> proj 9.1.1. With proj_debug, I can see that the PROJ_TRACE: 
> vgridshift: is not occurring unless the srs is overridden. I?m fairly 
> sure that this has worked in the past but I can?t say exactly which 
> version. This is an older geotiff that was written about 7 years ago.
>
> -- 
>
> Michael Smith
>
> US Army Corps / Remote Sensing GIS Center
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230412/b3ecf260/attachment.htm>

From michael.smith.erdc at gmail.com  Wed Apr 12 02:45:25 2023
From: michael.smith.erdc at gmail.com (Michael Smith)
Date: Wed, 12 Apr 2023 05:45:25 -0400
Subject: [gdal-dev] Problem with file source projection doing a vertical
 datum reprojection
In-Reply-To: <80281958-10e5-45a8-0dd1-f933237d82b0@spatialys.com>
References: <AADE155E-B951-4290-9DA1-CE5C41CF37F9@gmail.com>
 <80281958-10e5-45a8-0dd1-f933237d82b0@spatialys.com>
Message-ID: <CAOTq7m5RDiOj7RO4SKUZSVW1j45yEWutMA_SY0ZqKRLdXWBEyg@mail.gmail.com>

I guess I thought GTIFF_REPORT_COMPD_CS would only change the display
of the output, not change the interpretation of the SRS? I can confirm
that setting GTIFF_REPORT_COMPD_CS=FALSE does indeed allow the
vertical datum reprojection to happen but I guess I have a poor
understanding of just what GTIFF_REPORT_COMPD_CS does.

Mike


On Wed, Apr 12, 2023 at 5:24?AM Even Rouault <even.rouault at spatialys.com> wrote:
>
> Michael,
>
> it is well possible this might have worked in the past due to slightly different behavior of GDAL and/or PROJ, but the current behavior seems consistent to me. You're trying to transform between 2 compound CRS, the source one with a unknown vertical datum and the target one with EGM2008 height. There's nothing reasonable that PROJ can do regarding the vertical transformation in that situation, in particular it would be quite a bold assumption to assume that the source CRS is actually meant to be refering to ellipsoidal heights.  If you override with -s_srs EPSG:32617 (or drop REPORT_COMPD_CS=TRUE), then GDAL will auto-promote the source CRS to a 3D CRS with ellipsoidal heights, which could also be questionable from a purist point of view, but is the behaviour we have had for long now.
>
> Even
>
> Le 12/04/2023 ? 10:36, Michael Smith a ?crit :
>
> I have a file with a projection shown, using REPORT_COMPD_CS=TRUE of:
>
>
>
> COMPOUNDCRS["WGS 84 / UTM zone 17N + unknown",
>
>     PROJCRS["WGS 84 / UTM zone 17N",
>
>         BASEGEOGCRS["WGS 84",
>
>             DATUM["World Geodetic System 1984",
>
>                 ELLIPSOID["WGS 84",6378137,298.257223563,
>
>                     LENGTHUNIT["metre",1]]],
>
>             PRIMEM["Greenwich",0,
>
>                 ANGLEUNIT["degree",0.0174532925199433]],
>
>             ID["EPSG",4326]],
>
>         CONVERSION["UTM zone 17N",
>
>             METHOD["Transverse Mercator",
>
>                 ID["EPSG",9807]],
>
>             PARAMETER["Latitude of natural origin",0,
>
>                 ANGLEUNIT["degree",0.0174532925199433],
>
>                 ID["EPSG",8801]],
>
>             PARAMETER["Longitude of natural origin",-81,
>
>                 ANGLEUNIT["degree",0.0174532925199433],
>
>                 ID["EPSG",8802]],
>
>             PARAMETER["Scale factor at natural origin",0.9996,
>
>                 SCALEUNIT["unity",1],
>
>                 ID["EPSG",8805]],
>
>             PARAMETER["False easting",500000,
>
>                 LENGTHUNIT["metre",1],
>
>                 ID["EPSG",8806]],
>
>             PARAMETER["False northing",0,
>
>                 LENGTHUNIT["metre",1],
>
>                 ID["EPSG",8807]]],
>
>         CS[Cartesian,2],
>
>             AXIS["easting",east,
>
>                 ORDER[1],
>
>                 LENGTHUNIT["metre",1]],
>
>             AXIS["northing",north,
>
>                 ORDER[2],
>
>                 LENGTHUNIT["metre",1]],
>
>         ID["EPSG",32617]],
>
>     VERTCRS["unknown",
>
>         VDATUM["unknown"],
>
>         CS[vertical,1],
>
>             AXIS["up",up,
>
>                 LENGTHUNIT["metre",1,
>
>                     ID["EPSG",9001]]]]]
>
>
>
> When trying to gdalwarp to EGM2008 using gdalwarp -t_srs epsg:32617+3855, vertical datum reprojection does not occur unless I overwride the source srs with -s_srs epsg:32617. Using GDAL 3.6.2 and proj 9.1.1. With proj_debug, I can see that the PROJ_TRACE: vgridshift: is not occurring unless the srs is overridden. I?m fairly sure that this has worked in the past but I can?t say exactly which version. This is an older geotiff that was written about 7 years ago.
>
>
>
>
>
> --
>
> Michael Smith
>
> US Army Corps / Remote Sensing GIS Center
>
>
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.

From even.rouault at spatialys.com  Wed Apr 12 02:59:49 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 12 Apr 2023 11:59:49 +0200
Subject: [gdal-dev] Problem with file source projection doing a vertical
 datum reprojection
In-Reply-To: <CAOTq7m5RDiOj7RO4SKUZSVW1j45yEWutMA_SY0ZqKRLdXWBEyg@mail.gmail.com>
References: <AADE155E-B951-4290-9DA1-CE5C41CF37F9@gmail.com>
 <80281958-10e5-45a8-0dd1-f933237d82b0@spatialys.com>
 <CAOTq7m5RDiOj7RO4SKUZSVW1j45yEWutMA_SY0ZqKRLdXWBEyg@mail.gmail.com>
Message-ID: <cb07c511-fbc2-07e3-d769-2cb0ade889a8@spatialys.com>

Le 12/04/2023 ? 11:45, Michael Smith a ?crit?:
> I guess I thought GTIFF_REPORT_COMPD_CS would only change the display
> of the output, not change the interpretation of the SRS?
It is documented in https://gdal.org/drivers/raster/gtiff.html as:

"""GTIFF_REPORT_COMPD_CS : Can be set to TRUE to avoid stripping the 
vertical CRS of compound CRS when reading the SRS of a file. Does not 
affect the writing side. Default value : FALSE for GeoTIFF 1.0 files, or 
TRUE (starting with GDAL 3.1) for GeoTIFF 1.1 files."""

This seems to be a reasonably concise description of its effect (if 
you've suggestion to make it clearer, that's of course welcome). So this 
is not restricted to tuning display of the CRS in gdalinfo or other 
utilities, but really to what kind of CRS object the GeoTIFF returns to 
calling code.


-- 
http://www.spatialys.com
My software is free, but my time generally not.


From jesse.r.meyer at nasa.gov  Wed Apr 12 11:41:00 2023
From: jesse.r.meyer at nasa.gov (Meyer, Jesse R. (GSFC-618.0)[SCIENCE SYSTEMS AND APPLICATIONS INC])
Date: Wed, 12 Apr 2023 18:41:00 +0000
Subject: [gdal-dev] Seeking functionality inverse of gdal_merge.py
Message-ID: <CDF9BB41-66B7-4388-AFE3-3B31AD00E5BE@nasa.gov>

Hi,

I?d like to take a large raster image and chop it into XY tiles.  I see gdal2tiles.py, but this is specific to web hosting and inherits untenable constraints (like byte only datatype).

Does such a program exist by the GDAL team, or do I need to implement this manually?  If the latter, I suppose I could modify the gdal2tiles program.

Best,
Jesse
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230412/eeb7d297/attachment-0001.htm>

From even.rouault at spatialys.com  Wed Apr 12 11:46:18 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 12 Apr 2023 20:46:18 +0200
Subject: [gdal-dev] Seeking functionality inverse of gdal_merge.py
In-Reply-To: <CDF9BB41-66B7-4388-AFE3-3B31AD00E5BE@nasa.gov>
References: <CDF9BB41-66B7-4388-AFE3-3B31AD00E5BE@nasa.gov>
Message-ID: <e3fccb2d-31e2-fd1f-aaf6-e2b3dd812c08@spatialys.com>

Jesse,

you may want to look at https://gdal.org/programs/gdal_retile.html

Even

Le 12/04/2023 ? 20:41, Meyer, Jesse R. (GSFC-618.0)[SCIENCE SYSTEMS AND 
APPLICATIONS INC] via gdal-dev a ?crit?:
>
> Hi,
>
> I?d like to take a large raster image and chop it into XY tiles.? I 
> see gdal2tiles.py, but this is specific to web hosting and inherits 
> untenable constraints (like byte only datatype).
>
> Does such a program exist by the GDAL team, or do I need to implement 
> this manually?? If the latter, I suppose I could modify the gdal2tiles 
> program.
>
>
> Best,
>
> Jesse
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230412/59d1346b/attachment.htm>

From chaoboma at gmail.com  Wed Apr 12 22:48:00 2023
From: chaoboma at gmail.com (George Ma)
Date: Thu, 13 Apr 2023 13:48:00 +0800
Subject: [gdal-dev] Java-GDAL binding:How to convert gdal dataset to byte
 array
Message-ID: <CAHjX5cQu1aQxCxkN_iyz3FUofB+3Xi2V2dXHyi8EsjaKgNY-WA@mail.gmail.com>

Hello everyone.
I have a trouble about java-gdal when I process raster geotif data.
I want to convert Dataset type object to Byte array in order to return
HttpResponse.
But I dont know how to convert.
If I write file on disk firstly,then I read the file into FileInputStream,I
can convert to byte[],like this:

####code#####
String resTifPath = storageLocation + zoom + "-" + col + "-" + row +
".tif";
Driver tifDriver = gdal.GetDriverByName("GTiff");
Dataset datasetTifNew = tifDriver.CreateCopy(resTifPath, datasetTif);
//write datasetTif to file on disk
Byte[] res =null ;
File file = new File(resTifPath);
FileInputStream in = null;
res = new byte[(int) file.length()];
in = new FileInputStream(file);
in.read(res);
return res; //It can return byte[] to HttpResponse normally.
#####
I found it can use "data_bytes = dataset.ReadAsArray().tobytes()" in
python-gdal.
But who can tell me how to convert Dataset type object to Byte array
directly in Java-gdal?

Best Regurds.

Thank you very much.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230413/9371d1e4/attachment.htm>

From ari.jolma at gmail.com  Thu Apr 13 01:45:36 2023
From: ari.jolma at gmail.com (Ari Jolma)
Date: Thu, 13 Apr 2023 11:45:36 +0300
Subject: [gdal-dev] VRT file: Recursion detected
Message-ID: <9e5a9ad9-537e-3dd5-af99-0f9057b75ca8@gmail.com>

What can cause "Recursion detected" error when opening a VRT-file?

Is there something I can do in gdal.BuildVRT (I'm using gdal python 
bindings) to avoid that?

Ari



From lnicola at dend.ro  Thu Apr 13 02:02:26 2023
From: lnicola at dend.ro (=?UTF-8?Q?Lauren=C8=9Biu_Nicola?=)
Date: Thu, 13 Apr 2023 12:02:26 +0300
Subject: [gdal-dev] VRT file: Recursion detected
In-Reply-To: <9e5a9ad9-537e-3dd5-af99-0f9057b75ca8@gmail.com>
References: <9e5a9ad9-537e-3dd5-af99-0f9057b75ca8@gmail.com>
Message-ID: <1d0d0e59-14d2-4dca-b7c9-80bc7c78ec25@betaapp.fastmail.com>

Hi,

Just a guess, but maybe your VRT is including itself?

Laurentiu

On Thu, Apr 13, 2023, at 11:45, Ari Jolma wrote:
> What can cause "Recursion detected" error when opening a VRT-file?
>
> Is there something I can do in gdal.BuildVRT (I'm using gdal python 
> bindings) to avoid that?
>
> Ari
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at spatialys.com  Thu Apr 13 02:44:34 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 13 Apr 2023 11:44:34 +0200
Subject: [gdal-dev] VRT file: Recursion detected
In-Reply-To: <1d0d0e59-14d2-4dca-b7c9-80bc7c78ec25@betaapp.fastmail.com>
References: <9e5a9ad9-537e-3dd5-af99-0f9057b75ca8@gmail.com>
 <1d0d0e59-14d2-4dca-b7c9-80bc7c78ec25@betaapp.fastmail.com>
Message-ID: <202864d6-60d8-7811-0ddb-c258d3f4653f@spatialys.com>


Le 13/04/2023 ? 11:02, Lauren?iu Nicola via gdal-dev a ?crit?:
> Hi,
>
> Just a guess, but maybe your VRT is including itself?

That's indeed the purpose of this check (or detecting a VRT A including 
a VRT B including a VRT A, etc.). But the check is a bit tricky, and 
that might be just a bug in the particular situation. The best would be 
to open a ticket with a reproducer

Even


-- 
http://www.spatialys.com
My software is free, but my time generally not.


From ari.jolma at gmail.com  Thu Apr 13 03:42:47 2023
From: ari.jolma at gmail.com (Ari Jolma)
Date: Thu, 13 Apr 2023 13:42:47 +0300
Subject: [gdal-dev] VRT file: Recursion detected
In-Reply-To: <202864d6-60d8-7811-0ddb-c258d3f4653f@spatialys.com>
References: <9e5a9ad9-537e-3dd5-af99-0f9057b75ca8@gmail.com>
 <1d0d0e59-14d2-4dca-b7c9-80bc7c78ec25@betaapp.fastmail.com>
 <202864d6-60d8-7811-0ddb-c258d3f4653f@spatialys.com>
Message-ID: <8fd96df2-499a-fa38-bc92-319140635f08@gmail.com>

Even Rouault kirjoitti 13.4.2023 klo 12.44:

>
> Le 13/04/2023 ? 11:02, Lauren?iu Nicola via gdal-dev a ?crit?:
>> Hi,
>>
>> Just a guess, but maybe your VRT is including itself?
>
> That's indeed the purpose of this check (or detecting a VRT A 
> including a VRT B including a VRT A, etc.). But the check is a bit 
> tricky, and that might be just a bug in the particular situation. The 
> best would be to open a ticket with a reproducer

This is a case where client uploads data and an automated process moves 
it to a S3 bucket, which is not cleaned and thus it seems that there may 
be an old index.vrt file. I fixed this by checking that the old 
index.vrt is not included when it is recreated after new data is added. 
So the bug was in my code.

Best,

Ari



From lnicola at dend.ro  Thu Apr 13 04:52:04 2023
From: lnicola at dend.ro (=?UTF-8?Q?Lauren=C8=9Biu_Nicola?=)
Date: Thu, 13 Apr 2023 14:52:04 +0300
Subject: [gdal-dev] Java-GDAL binding:How to convert gdal dataset to
 byte array
In-Reply-To: <CAHjX5cQu1aQxCxkN_iyz3FUofB+3Xi2V2dXHyi8EsjaKgNY-WA@mail.gmail.com>
References: <CAHjX5cQu1aQxCxkN_iyz3FUofB+3Xi2V2dXHyi8EsjaKgNY-WA@mail.gmail.com>
Message-ID: <c0ae421f-9855-4abd-a39e-a9f2e888c952@betaapp.fastmail.com>

Hi,

I don't think ReadAsArray is the API you're looking for. If you do that, you'll end up with a buffer of pixel values, not with a proper TIFF or PNG tile.

Instead, you can either use the MEM driver or the /vsimem/ prefix (like in https://gdal.org/api/cpl.html#_CPPv424VSIInstallMemFileHandlerv), read the in-memory file using VSIGetMemFileBuffer, then finally unlink the file using VSIUnlink. These are C or C++ APIs, but the Java bindings must expose them under similar names.

Regards,
Laurentiu

On Thu, Apr 13, 2023, at 08:48, George Ma wrote:
> Hello everyone.
> I have a trouble about java-gdal when I process raster geotif data.
> I want to convert Dataset type object to Byte array in order to return HttpResponse.
> But I dont know how to convert.
> If I write file on disk firstly,then I read the file into FileInputStream,I can convert to byte[],like this:
> 
> ####code#####
> String resTifPath = storageLocation + zoom + "-" + col + "-" + row + ".tif";  
> Driver tifDriver = gdal.GetDriverByName("GTiff");
> Dataset datasetTifNew = tifDriver.CreateCopy(resTifPath, datasetTif); //write datasetTif to file on disk
> Byte[] res =null ;
> File file = new File(resTifPath);
> FileInputStream in = null;
> res = new byte[(int) file.length()];
> in = new FileInputStream(file);
> in.read(res);
> return res; //It can return byte[] to HttpResponse normally.
> #####
> I found it can use "data_bytes = dataset.ReadAsArray().tobytes()" in python-gdal.
> But who can tell me how to convert Dataset type object to Byte array directly in Java-gdal?
> 
> Best Regurds.
> 
> Thank you very much.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230413/d4cad09c/attachment.htm>

From Jon.Morris at jbarisk.com  Thu Apr 13 06:52:42 2023
From: Jon.Morris at jbarisk.com (Jon Morris)
Date: Thu, 13 Apr 2023 13:52:42 +0000
Subject: [gdal-dev] Intermittent failure with Python mocks
Message-ID: <LO2P123MB4861CA62875CF2B085F682C082989@LO2P123MB4861.GBRP123.PROD.OUTLOOK.COM>

I'm getting intermittent fails with our Python unit tests and I wondered if anyone has seen the same issue. I think it's a race condition where a mock patch is either not applied at all or maybe applied too slowly so the patched function still has its original return value. It might be a pytest issue, but I've now seen it with two different GDAL methods so I'm just curious if anyone has any idea what may be going on.

The first example I reported on Stack Overflow (https://stackoverflow.com/q/75185263/3182496) and looks something like this:

        mock_feat_defn = mocker.patch.object(ogr.FeatureDefn, 'GetFieldCount')
        mock_feat_defn.side_effect = RuntimeError("Some other error message")

        with pytest.raises(RuntimeError, match="Some other error message"):
            get_from_layer_schema(test_lyr, get_names=True, get_types=False)

The second example is this:

        with mock.patch('osgeo.gdal.Driver.Delete', side_effect=None):
            with self.assertRaisesRegex(DatasetError, "Could not delete"):
                delete_path(shp_path)

In both cases we're mocking a GDAL method call to check one of our functions correctly raises an error, but sometimes it works and sometimes it doesn't. If it's not a GDAL issue, no problem, I will keep looking elsewhere for a solution.

Jon

e: Jon.Morris at jbarisk.com
d:+44 (0)1756 587229
t: +44 (0)1756 799919
www.jbarisk.com
All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system. 
JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, England.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230413/6aefdccd/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image978682.png
Type: image/png
Size: 9321 bytes
Desc: image978682.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230413/6aefdccd/attachment-0005.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image945321.png
Type: image/png
Size: 651 bytes
Desc: image945321.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230413/6aefdccd/attachment-0006.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image904217.png
Type: image/png
Size: 715 bytes
Desc: image904217.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230413/6aefdccd/attachment-0007.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image622653.png
Type: image/png
Size: 966 bytes
Desc: image622653.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230413/6aefdccd/attachment-0008.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image221773.png
Type: image/png
Size: 784 bytes
Desc: image221773.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230413/6aefdccd/attachment-0009.png>

From sean.gillies at gmail.com  Thu Apr 13 07:13:33 2023
From: sean.gillies at gmail.com (Sean Gillies)
Date: Thu, 13 Apr 2023 08:13:33 -0600
Subject: [gdal-dev] Intermittent failure with Python mocks
In-Reply-To: <LO2P123MB4861CA62875CF2B085F682C082989@LO2P123MB4861.GBRP123.PROD.OUTLOOK.COM>
References: <LO2P123MB4861CA62875CF2B085F682C082989@LO2P123MB4861.GBRP123.PROD.OUTLOOK.COM>
Message-ID: <CAOodmJqApBREcJd5TV0iNzOzdpgqbdS9ifhA2kc33PskiXEiTQ@mail.gmail.com>

Hi Jon,

The number one gotcha with patching is documented here
https://docs.python.org/3/library/unittest.mock.html#where-to-patch. In a
nutshell, you have to patch your own module. I see you're patching gdal in
your tests. Patching gdal from your test doesn't do anything, it's too
late.

Hope this helps!

On Thu, Apr 13, 2023, 7:53 AM Jon Morris <Jon.Morris at jbarisk.com> wrote:

> I?m getting intermittent fails with our Python unit tests and I wondered
> if anyone has seen the same issue. I think it?s a race condition where a
> mock patch is either not applied at all or maybe applied too slowly so the
> patched function still has its original return value. It might be a pytest
> issue, but I?ve now seen it with two different GDAL methods so I?m just
> curious if anyone has any idea what may be going on.
>
>
>
> The first example I reported on Stack Overflow (
> https://stackoverflow.com/q/75185263/3182496) and looks something like
> this:
>
>
>
>         mock_feat_defn = mocker.patch.object(ogr.FeatureDefn,
> 'GetFieldCount')
>
>         mock_feat_defn.side_effect = RuntimeError("Some other error
> message")
>
>
>
>         with pytest.raises(RuntimeError, match="Some other error message"):
>
>             get_from_layer_schema(test_lyr, get_names=True,
> get_types=False)
>
>
>
> The second example is this:
>
>
>
>         with mock.patch('osgeo.gdal.Driver.Delete', side_effect=None):
>
>             with self.assertRaisesRegex(DatasetError, "Could not delete"):
>
>                 delete_path(shp_path)
>
>
>
> In both cases we?re mocking a GDAL method call to check one of our
> functions correctly raises an error, but sometimes it works and sometimes
> it doesn?t. If it?s not a GDAL issue, no problem, I will keep looking
> elsewhere for a solution.
>
>
>
> Jon
> e: ? *Jon.Morris at jbarisk.com* <Jon.Morris at jbarisk.com>
> d: +44 (0)1756 587229
> t:  *+44 (0)1756 799919* <+44%20(0)1756%20799919>
> *www.jbarisk.com* <http://www.jbarisk.com/>
> [image: Facebook] <https://www.facebook.com/TheFloodPeople>
> [image: LinkedIn] <https://www.linkedin.com/company/jba-risk-management/>
> [image: Twitter] <https://twitter.com/JBARisk>
> [image: YouTube]
> <https://www.youtube.com/channel/UC0iatom2jYbW96voW0rlpCw>
>
>
> All JBA Risk Management's email messages contain confidential information
> and are intended only for the individual(s) named. If you are not the named
> addressee you should not disseminate, distribute or copy this e-mail.
> Please notify the sender immediately by email if you have received this
> email by mistake and delete this email from your system.
> JBA Risk Management Limited is registered in England, company number
> 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North
> Yorkshire, BD23 3FD, England.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230413/5ee7c98c/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image978682.png
Type: image/png
Size: 9321 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230413/5ee7c98c/attachment-0006.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image945321.png
Type: image/png
Size: 651 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230413/5ee7c98c/attachment-0007.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image904217.png
Type: image/png
Size: 715 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230413/5ee7c98c/attachment-0008.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image622653.png
Type: image/png
Size: 966 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230413/5ee7c98c/attachment-0009.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image221773.png
Type: image/png
Size: 784 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230413/5ee7c98c/attachment-0010.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image978682.png
Type: image/png
Size: 9321 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230413/5ee7c98c/attachment-0011.png>

From lnicola at dend.ro  Thu Apr 13 09:50:05 2023
From: lnicola at dend.ro (=?UTF-8?Q?Lauren=C8=9Biu_Nicola?=)
Date: Thu, 13 Apr 2023 19:50:05 +0300
Subject: [gdal-dev] Java-GDAL binding:How to convert gdal dataset to
 byte array
In-Reply-To: <CAHjX5cR4RWO2=+PfDfz4q2TNyYgsbKHhr22x2pLYG4ZMS6-oqw@mail.gmail.com>
References: <CAHjX5cQu1aQxCxkN_iyz3FUofB+3Xi2V2dXHyi8EsjaKgNY-WA@mail.gmail.com>
 <c0ae421f-9855-4abd-a39e-a9f2e888c952@betaapp.fastmail.com>
 <CAHjX5cR4RWO2=+PfDfz4q2TNyYgsbKHhr22x2pLYG4ZMS6-oqw@mail.gmail.com>
Message-ID: <b55ac740-500f-48a9-86c5-fa94340126ab@betaapp.fastmail.com>

Hi,

VSIUnlink is https://gdal.org/java/org/gdal/gdal/gdal.html#Unlink(java.lang.String), but I can't find VSIGetMemFileBuffer or VSIFOpenEx2L and VSIFReadL, which you could use instead. FileFromMemBuffer is there, but it goes in the wrong direction.

So sorry, I have no idea. I've never used the Java bindings.

Laurentiu

On Thu, Apr 13, 2023, at 18:11, George Ma wrote:
> Hi Nicola,
> 
> Thank you very much for your reply.
> 
> I understand your point but I dont know how to expose the two API in Java bindings.
> 
> I previously compiled the related GDAL Java bindings myself,generating file for example "gdal.jar","libgdalalljni.so",etc.
> 
> I dont use the gdal-java Docker image.
> 
> ????_20230413230636.png
> 
> I have checked some file content in swig/java directory.But I am not familiar with swig configuration.So can you tell me how I can expose the two API in Java bindings.
> 
> Best regards.
> 
> Thank you very much.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230413/a2fe28dc/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: ????_20230413230636.png
Type: image/png
Size: 61458 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230413/a2fe28dc/attachment-0001.png>

From cjmhaggstrom at gmail.com  Thu Apr 13 14:15:16 2023
From: cjmhaggstrom at gmail.com (=?UTF-8?B?TWFydGluIEjDpGdnc3Ryw7Zt?=)
Date: Thu, 13 Apr 2023 23:15:16 +0200
Subject: [gdal-dev] Rendering/rasterizing GeoPackage vector to grayscale
Message-ID: <CAOC8wtCGtN2wRqquKk-XLrei-OR5t8wUOH59i8ToZmGzh5TWXg@mail.gmail.com>

Hello all,

I am trying to read vector GeoPackage files in order to render a custom map
suitable to display on a 3bpp e-ink screen (8 grayscales per pixel). I am a
complete noob in anything related to GIS and mapping and all terminology,
but I have managed to use GDALRasterizeLayers to burn (almost) all features
of the vector layers into a raster GTiff. However, I have no idea how or if
I can apply any sort of styling while using this procedure.

Using GDALRasterizeLayers I get an image containing all the different
features on the map as specific pixel values, which I could color
differently as a post process, but I can not change _how_ the features are
renderad in the first place (different brush, stroke width etc). I have
tried using OGRFeature::SetStyleString() on the source layers, but it does
not seem to have any effect.

Using QGIS I can read the GeoPackages together with a .qlr file to get a
map that looks as it originally should, and from there I can "Export map to
image" and generate XYZ tiles (I haven't gotten these to look exactly
correct though), but I would primarily like to find a way to
programmatically render tiles on the fly directly to my custom screen.

Am I using the correct approach for creating a bitmap image from vector, or
is rasterize meant for other use cases? It seems most examples focus on
data processing rather than map rendering. I am unfamiliar with the
terminology so I worry I might be going the wrong direction entirely when
searching for the solution.

Best Regard,
Martin H?ggstr?m
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230413/5a4c0ec3/attachment.htm>

From Jon.Morris at jbarisk.com  Fri Apr 14 00:47:42 2023
From: Jon.Morris at jbarisk.com (Jon Morris)
Date: Fri, 14 Apr 2023 07:47:42 +0000
Subject: [gdal-dev] Intermittent failure with Python mocks
In-Reply-To: <CAOodmJqApBREcJd5TV0iNzOzdpgqbdS9ifhA2kc33PskiXEiTQ@mail.gmail.com>
References: <LO2P123MB4861CA62875CF2B085F682C082989@LO2P123MB4861.GBRP123.PROD.OUTLOOK.COM>
 <CAOodmJqApBREcJd5TV0iNzOzdpgqbdS9ifhA2kc33PskiXEiTQ@mail.gmail.com>
Message-ID: <LO2P123MB486145BE83B2B89A3D18368282999@LO2P123MB4861.GBRP123.PROD.OUTLOOK.COM>

Yes it does help. I?m still getting to grips with patching and see it as a last resort if you can?t set the test up a better way. I?ll skip the failing tests for now and see if I can rewrite them.

Though I guess the question now is why does it actually work most of the time? ?

Thanks


e: Jon.Morris at jbarisk.com
d:+44 (0)1756 587229
t: +44 (0)1756 799919
www.jbarisk.com
All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system. 
JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, England.
From: Sean Gillies <sean.gillies at gmail.com>
Sent: Thursday, April 13, 2023 3:14 PM
To: Jon Morris <Jon.Morris at jbarisk.com>
Cc: gdal dev <gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] Intermittent failure with Python mocks

CAUTION: This email originated from outside of JBA and contains one or more links and one or more attachments. DO NOT click links or open attachments unless you recognise the sender's email address and are absolutely certain that the content is safe.
See the Phishing page on IMS on SP for more information about how to spot and report suspicious messages.
Hi Jon,

The number one gotcha with patching is documented here https://docs.python.org/3/library/unittest.mock.html#where-to-patch. In a nutshell, you have to patch your own module. I see you're patching gdal in your tests. Patching gdal from your test doesn't do anything, it's too late.

Hope this helps!

On Thu, Apr 13, 2023, 7:53 AM Jon Morris <Jon.Morris at jbarisk.com<mailto:Jon.Morris at jbarisk.com>> wrote:
I?m getting intermittent fails with our Python unit tests and I wondered if anyone has seen the same issue. I think it?s a race condition where a mock patch is either not applied at all or maybe applied too slowly so the patched function still has its original return value. It might be a pytest issue, but I?ve now seen it with two different GDAL methods so I?m just curious if anyone has any idea what may be going on.

The first example I reported on Stack Overflow (https://stackoverflow.com/q/75185263/3182496) and looks something like this:

        mock_feat_defn = mocker.patch.object(ogr.FeatureDefn, 'GetFieldCount')
        mock_feat_defn.side_effect = RuntimeError("Some other error message")

        with pytest.raises(RuntimeError, match="Some other error message"):
            get_from_layer_schema(test_lyr, get_names=True, get_types=False)

The second example is this:

        with mock.patch('osgeo.gdal.Driver.Delete', side_effect=None):
            with self.assertRaisesRegex(DatasetError, "Could not delete"):
                delete_path(shp_path)

In both cases we?re mocking a GDAL method call to check one of our functions correctly raises an error, but sometimes it works and sometimes it doesn?t. If it?s not a GDAL issue, no problem, I will keep looking elsewhere for a solution.

Jon
e: ?
Jon.Morris at jbarisk.com<mailto:Jon.Morris at jbarisk.com>
d:
+44 (0)1756 587229
t:
+44 (0)1756 799919<tel:+44%20(0)1756%20799919>
www.jbarisk.com<http://www.jbarisk.com/>
[cid:image978682.png at F0F5C55D.6B2FD5D3]
[Facebook]<https://www.facebook.com/TheFloodPeople>
[LinkedIn]<https://www.linkedin.com/company/jba-risk-management/>
[Twitter]<https://twitter.com/JBARisk>
[YouTube]<https://www.youtube.com/channel/UC0iatom2jYbW96voW0rlpCw>



All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system.
JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, England.
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230414/280f4c14/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image057709.png
Type: image/png
Size: 9321 bytes
Desc: image057709.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230414/280f4c14/attachment-0005.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image904684.png
Type: image/png
Size: 651 bytes
Desc: image904684.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230414/280f4c14/attachment-0006.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image271628.png
Type: image/png
Size: 715 bytes
Desc: image271628.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230414/280f4c14/attachment-0007.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image256656.png
Type: image/png
Size: 966 bytes
Desc: image256656.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230414/280f4c14/attachment-0008.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image951714.png
Type: image/png
Size: 784 bytes
Desc: image951714.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230414/280f4c14/attachment-0009.png>

From cjmhaggstrom at gmail.com  Fri Apr 14 09:15:28 2023
From: cjmhaggstrom at gmail.com (=?UTF-8?B?TWFydGluIEjDpGdnc3Ryw7Zt?=)
Date: Fri, 14 Apr 2023 18:15:28 +0200
Subject: [gdal-dev] Rendering/rasterizing GeoPackage vector to grayscale
In-Reply-To: <CAAvXUUo9sYE7M4azimvhxKubv5zm7qvsK0+UeV_wbLY04cLcLw@mail.gmail.com>
References: <CAOC8wtCGtN2wRqquKk-XLrei-OR5t8wUOH59i8ToZmGzh5TWXg@mail.gmail.com>
 <CAAvXUUo9sYE7M4azimvhxKubv5zm7qvsK0+UeV_wbLY04cLcLw@mail.gmail.com>
Message-ID: <CAOC8wtAh+04m4nP9Mpj1z-U9VpKuXo7U-f8qsSc600eTbFUSAA@mail.gmail.com>

Hi,

Yes, I have ordered an ESP32 board (Inkplate 6plus) which I am planning to
use as a portable selfcontained map-viewer (solar charged). My initial plan
was to try using as close to "raw" data from sources as possible, to
minimize hazzle with updating the maps. This would mean doing all
processing on the device and send the image directly to the screen, but
after playing around with gdal/qgis I have realised that plan might have
been a bit too ambitious.

Thanks for your suggestions, I realise I have focused too much on the
GeoPackage-part (a search that led me to gdal in the first place). I think
the ideal for my usecase is some sort of vector format which I can
dynamically filter on the device during rendering to cram as much info as
possible into the 16 shades available on screen. I will research other
vector formats and what suitable (C/C++) libraries and utilities are
available.

As a last case fallback I guess X/Y/Z raster tiles rendered in a compressed
4bpp form would suffice, if vector processing is too much for the device.


On 14 April 2023 10:35:56 UTC, "Cain? K. Campos" <rupestre.campos at gmail.com>
wrote:
>
> Hi Martin,
>
> there are a few options but using gdal directly may not be so easy,
> I'd love to hear how to do it using gdal only.
> Just to understand better, some information on your setup would help,
> like how do you plan to access those black n white tiles, over network or
> local only?
> Machine and setup specifications, is it a rpi4, 3 0 or ESP32 or what?
> Spare parts to create a server and a client or just a single board?
> I ask it because the process to read a vector and produce a tile may
> require some processing power.
> As you said you are using Qgis, try it on server mode, where you can
> publish the maps you create on the local network. This way you setup styles
> as you create a map in qgis.
> Other options out there for publishing vector data :
> Spin a geoserver and set the style of the map layers, also you may combine
> two or more in order to make a single request, create cache and more.
> Using Postgres/postgis and pg_tileserv you may create vector tiles and
> render it on the client, or on a custom server middleware.
> If you are going offline and your machine has lots of processing power,
> like a rpi4, just self-host those services on the machine and point
> services to localhost:port_number.
>
> On Thu, Apr 13, 2023 at 6:16?PM Martin H?ggstr?m <cjmhaggstrom at gmail.com>
> wrote:
>
>> Hello all,
>>
>> I am trying to read vector GeoPackage files in order to render a custom
>> map suitable to display on a 3bpp e-ink screen (8 grayscales per pixel). I
>> am a complete noob in anything related to GIS and mapping and all
>> terminology, but I have managed to use GDALRasterizeLayers to burn (almost)
>> all features of the vector layers into a raster GTiff. However, I have no
>> idea how or if I can apply any sort of styling while using this procedure.
>>
>> Using GDALRasterizeLayers I get an image containing all the different
>> features on the map as specific pixel values, which I could color
>> differently as a post process, but I can not change _how_ the features are
>> renderad in the first place (different brush, stroke width etc). I have
>> tried using OGRFeature::SetStyleString() on the source layers, but it does
>> not seem to have any effect.
>>
>> Using QGIS I can read the GeoPackages together with a .qlr file to get a
>> map that looks as it originally should, and from there I can "Export map to
>> image" and generate XYZ tiles (I haven't gotten these to look exactly
>> correct though), but I would primarily like to find a way to
>> programmatically render tiles on the fly directly to my custom screen.
>>
>> Am I using the correct approach for creating a bitmap image from vector,
>> or is rasterize meant for other use cases? It seems most examples focus on
>> data processing rather than map rendering. I am unfamiliar with the
>> terminology so I worry I might be going the wrong direction entirely when
>> searching for the solution.
>>
>> Best Regard,
>> Martin H?ggstr?m
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230414/1f126469/attachment.htm>

From jluis at ualg.pt  Sat Apr 15 08:07:47 2023
From: jluis at ualg.pt (=?iso-8859-1?Q?Joaquim_Manuel_Freire_Lu=EDs?=)
Date: Sat, 15 Apr 2023 15:07:47 +0000
Subject: [gdal-dev] Mysterious master build break on Win11
Message-ID: <GVXPR04MB99260035942F55374DC0E55DA69E9@GVXPR04MB9926.eurprd04.prod.outlook.com>

Hi,

I'm hitting a weird building error on Win11.

The error is

[1322/1350] Linking CXX shared library gdal_w64.dll
FAILED: gdal_w64.dll gdal_w64.lib
cmd.exe /C "cd . && C:\programs\CMake\bin\cmake.exe -E vs_link_dll --intdir=CMakeFiles\GDAL.dir --rc=C:\PROGRA~2\WI3CF2~1\10\bin\100220~1.0\x64\rc.exe --mt=C:\PROGRA~2\WI3CF2~1\10\bin\100220~1.0\x64\mt.exe --manifests  -- C:\PROGRA~1\MICROS~4\2022\COMMUN~1\VC\Tools\MSVC\1435~1.322\bin\Hostx64\x64\link.exe /nologo @CMakeFiles\GDAL.rsp  /out:gdal_w64.dll /implib:gdal_w64.lib /pdb:gdal_w64.pdb /dll /version:37.0 /machine:x64 /INCREMENTAL:NO  && cd ."
LINK: command "C:\PROGRA~1\MICROS~4\2022\COMMUN~1\VC\Tools\MSVC\1435~1.322\bin\Hostx64\x64\link.exe /nologo @CMakeFiles\GDAL.rsp /out:gdal_w64.dll /implib:gdal_w64.lib /pdb:gdal_w64.pdb /dll /version:37.0 /machine:x64 /INCREMENTAL:NO /MANIFEST /MANIFESTFILE:gdal_w64.dll.manifest" failed (exit code 1181) with the following output:
LINK : fatal error LNK1181: cannot open input file 'm.lib'
ninja: build stopped: subcommand failed.

And indeed, there is one file "C:\programs\compa_libs\gdal_GIT\build\CMakeFiles\GDAL.rsp" that has this line

       C:\programs\PostgreSQL\15\lib\libpq.lib  C:\programs\compa_libs\hdf5-1.12.2\compileds\VC14_64\lib\hdf5_cpp.lib  psapi.lib  m.lib


Now, the weirdest part is that this happens in a new computer with Win11 but the GDAL repo dir was copied from another computer (that has Win10) and there this error does not show up. Both are built with same version of VS.

If I cheat it and add a valid lib called as m.lib then all runs apparently fine.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230415/0c3e0b46/attachment.htm>

From even.rouault at spatialys.com  Sat Apr 15 08:53:17 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 15 Apr 2023 17:53:17 +0200
Subject: [gdal-dev] Mysterious master build break on Win11
In-Reply-To: <GVXPR04MB99260035942F55374DC0E55DA69E9@GVXPR04MB9926.eurprd04.prod.outlook.com>
References: <GVXPR04MB99260035942F55374DC0E55DA69E9@GVXPR04MB9926.eurprd04.prod.outlook.com>
Message-ID: <d6b1f5fc-5724-e295-72e0-033d187c71a5@spatialys.com>

Joaquim,
>
> Now, the weirdest part is that this happens in a new computer with 
> Win11 but the GDAL repo dir was copied from another computer (that has 
> Win10) and there this error does not show up. Both are built with same 
> version of VS.
>
So you also copied a build directory with existing CMakeCache.txt and 
other generated files? I don't think this is a safe practice, unless 
your source & target computers are exactly the same.

What if you build from a clean build directory ?

Is there a M_LIB line in the CMakeCache.txt of the Win10 and Win11 
computers?

If you update to latest master (or cherry-pick 
https://github.com/OSGeo/gdal/commit/0a062f8ab132e22d1bace91081d606584b8e8d7c), 
run "cmake -DSHOW_DEPS_PER_TARGET=YES [...]", and look in the output 
messages lines starting with "Target [xxx]: links against" and 
containing m.lib . That should hopefully give a clue of which 
third-party library drag this m.lib dependency

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230415/0d36901c/attachment.htm>

From nyall.dawson at gmail.com  Sun Apr 16 19:48:18 2023
From: nyall.dawson at gmail.com (Nyall Dawson)
Date: Mon, 17 Apr 2023 12:48:18 +1000
Subject: [gdal-dev] Any timeframe for 3.7.0?
Message-ID: <CAB28Asj_7FwCpkfGTLbqRp0o7f-kMFhZgdgEYNa6GeC4H7JZWA@mail.gmail.com>

Hi list,

Is there any word on when the GDAL 3.7 release might be finalised?
(There's so much exciting changes in this release and I'm keen for
them to hit users!)


Nyall

From even.rouault at spatialys.com  Mon Apr 17 03:23:21 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 17 Apr 2023 12:23:21 +0200
Subject: [gdal-dev] Any timeframe for 3.7.0?
In-Reply-To: <CAB28Asj_7FwCpkfGTLbqRp0o7f-kMFhZgdgEYNa6GeC4H7JZWA@mail.gmail.com>
References: <CAB28Asj_7FwCpkfGTLbqRp0o7f-kMFhZgdgEYNa6GeC4H7JZWA@mail.gmail.com>
Message-ID: <e95e34f2-9ff6-760d-6f18-bb0631ca6e20@spatialys.com>

Hi Nyall,

the plan is to have a release candidate out for beginning of May

Even

Le 17/04/2023 ? 04:48, Nyall Dawson a ?crit?:
> Hi list,
>
> Is there any word on when the GDAL 3.7 release might be finalised?
> (There's so much exciting changes in this release and I'm keen for
> them to hit users!)
>
>
> Nyall
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From even.rouault at spatialys.com  Mon Apr 17 05:05:53 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 17 Apr 2023 14:05:53 +0200
Subject: [gdal-dev] GDAL 3.6.4 RC1 available
Message-ID: <81fccdc6-37b3-06f5-42e2-7f76c6ed0723@spatialys.com>

Hi,

I have prepared a GDAL/OGR 3.6.4 release candidate.

Pick up an archive among the following ones (by ascending size):

 ? https://download.osgeo.org/gdal/3.6.4/gdal-3.6.4rc1.tar.xz
 ? https://download.osgeo.org/gdal/3.6.4/gdal-3.6.4rc1.tar.gz
 ? https://download.osgeo.org/gdal/3.6.4/gdal364rc1.zip

A snapshot of the gdalautotest suite is also available:

https://download.osgeo.org/gdal/3.6.4/gdalautotest-3.6.4rc1.tar.gz
 ? https://download.osgeo.org/gdal/3.6.4/gdalautotest-3.6.4rc1.zip

The NEWS file is here:

 ? https://github.com/OSGeo/gdal/blob/v3.6.4RC1/NEWS.md

I'll call for a vote promoting it to final before Wednesday if no
serious problems are reported before.

Best regards,

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From felipe at uma.es  Mon Apr 17 22:07:16 2023
From: felipe at uma.es (Luis Felipe Romero)
Date: Tue, 18 Apr 2023 07:07:16 +0200
Subject: [gdal-dev] Total Viewshed and GDAL
Message-ID: <07e4bfb1-0639-3a89-1407-c89f6e5d8d1b@uma.es>

Dear gdal-dev group members,

I hope this email finds you well. I am Luis Felipe Romero, a researcher from the University of Malaga in Spain, and I am excited to introduce myself to this community. My research focuses on algorithms for digital elevation models (DEM), and in particular, the development of algorithms for the 
calculation of the total viewshed.

Recently, my team has developed a highly efficient algorithm that can calculate the total viewshed for a model of 2500x2500 points in just 4 seconds on a GPU or approximately 2 minutes on a 16-core CPU. Our algorithm is written in C++, and we also have a version that utilizes CUDA for GPU acceleration.

I had a conversation with Even Roualt about the possibility of integrating our algorithm into GDAL. However, he informed me of the incompatibilities between GDAL and CUDA, but encouraged me to share my intentions with the group. Therefore, I would like to share our Total Viewshed approach with the 
gdal-dev community.

Unlike Tamas Szekeres' Viewshed algorithm, our approach calculates the viewshed at all model points simultaneously by leveraging in-memory data alignment. While it may not be as efficient for calculating the viewshed of a small set of points, it is incredibly useful for determining the viewshed of 
an entire territory, such as for selecting the location of a cell phone tower or for forest surveillance path planning. Our algorithm can complete these types of calculations in a matter of minutes, as opposed to thousands of hours.

My primary goal in reaching out to this group is to gain feedback and insights on how GDAL can be used to make our algorithms publicly accessible and even improved upon by the community. I believe that GDAL provides the necessary tools and interfaces to make this possible.

I am currently in the process of familiarizing myself with the GDAL code structure, and it will take a few days before I can determine my first steps with it. Nevertheless, I am excited to contribute to this community and give visibility to our work.

Thank you all in advance for your time and consideration.

Best regards,
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230418/ca4f9b4f/attachment.htm>

From szekerest at gmail.com  Tue Apr 18 00:30:14 2023
From: szekerest at gmail.com (Tamas Szekeres)
Date: Tue, 18 Apr 2023 09:30:14 +0200
Subject: [gdal-dev] Total Viewshed and GDAL
In-Reply-To: <07e4bfb1-0639-3a89-1407-c89f6e5d8d1b@uma.es>
References: <07e4bfb1-0639-3a89-1407-c89f6e5d8d1b@uma.es>
Message-ID: <CACALY+SGG-9SrMoR7DmQVzawBtx4+GzH2Q3RgFsT01BAfEyy+A@mail.gmail.com>

Luis,

I'm interested in testing such algorithm, is that code publicly available?

Best regards,

Tamas


Luis Felipe Romero <felipe at uma.es> ezt ?rta (id?pont: 2023. ?pr. 18., K,
7:15):

> Dear gdal-dev group members,
>
> I hope this email finds you well. I am Luis Felipe Romero, a researcher
> from the University of Malaga in Spain, and I am excited to introduce
> myself to this community. My research focuses on algorithms for digital
> elevation models (DEM), and in particular, the development of algorithms
> for the calculation of the total viewshed.
>
> Recently, my team has developed a highly efficient algorithm that can
> calculate the total viewshed for a model of 2500x2500 points in just 4
> seconds on a GPU or approximately 2 minutes on a 16-core CPU. Our algorithm
> is written in C++, and we also have a version that utilizes CUDA for GPU
> acceleration.
>
> I had a conversation with Even Roualt about the possibility of integrating
> our algorithm into GDAL. However, he informed me of the incompatibilities
> between GDAL and CUDA, but encouraged me to share my intentions with the
> group. Therefore, I would like to share our Total Viewshed approach with
> the gdal-dev community.
>
> Unlike Tamas Szekeres' Viewshed algorithm, our approach calculates the
> viewshed at all model points simultaneously by leveraging in-memory data
> alignment. While it may not be as efficient for calculating the viewshed of
> a small set of points, it is incredibly useful for determining the viewshed
> of an entire territory, such as for selecting the location of a cell phone
> tower or for forest surveillance path planning. Our algorithm can complete
> these types of calculations in a matter of minutes, as opposed to thousands
> of hours.
>
> My primary goal in reaching out to this group is to gain feedback and
> insights on how GDAL can be used to make our algorithms publicly accessible
> and even improved upon by the community. I believe that GDAL provides the
> necessary tools and interfaces to make this possible.
>
> I am currently in the process of familiarizing myself with the GDAL code
> structure, and it will take a few days before I can determine my first
> steps with it. Nevertheless, I am excited to contribute to this community
> and give visibility to our work.
>
> Thank you all in advance for your time and consideration.
>
> Best regards,
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230418/54542b2e/attachment-0001.htm>

From andrew at aitchison.me.uk  Tue Apr 18 00:36:52 2023
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Tue, 18 Apr 2023 08:36:52 +0100 (BST)
Subject: [gdal-dev] Total Viewshed and GDAL
In-Reply-To: <07e4bfb1-0639-3a89-1407-c89f6e5d8d1b@uma.es>
References: <07e4bfb1-0639-3a89-1407-c89f6e5d8d1b@uma.es>
Message-ID: <f9141234-13b8-85bb-9ac3-6e66273c75a3@aitchison.me.uk>

On Tue, 18 Apr 2023, Luis Felipe Romero wrote:

> Dear gdal-dev group members,
>
> I hope this email finds you well. I am Luis Felipe Romero, a researcher from 
> the University of Malaga in Spain, and I am excited to introduce myself to 
> this community. My research focuses on algorithms for digital elevation 
> models (DEM), and in particular, the development of algorithms for the 
> calculation of the total viewshed.
>
> Recently, my team has developed a highly efficient algorithm that can 
> calculate the total viewshed for a model of 2500x2500 points in just 4 
> seconds on a GPU or approximately 2 minutes on a 16-core CPU. Our algorithm 
> is written in C++, and we also have a version that utilizes CUDA for GPU 
> acceleration.
>
> I had a conversation with Even Roualt about the possibility of integrating 
> our algorithm into GDAL. However, he informed me of the incompatibilities 
> between GDAL and CUDA, but encouraged me to share my intentions with the 
> group. Therefore, I would like to share our Total Viewshed approach with the 
> gdal-dev community.

I understand that the performance is not as great as CUDA,
but OpenCL support *is* available in GDAL.

-- 
Andrew C. Aitchison                      Kendal, UK
                    andrew at aitchison.me.uk

From felipe at uma.es  Tue Apr 18 01:01:35 2023
From: felipe at uma.es (Luis F. Romero)
Date: Tue, 18 Apr 2023 10:01:35 +0200
Subject: [gdal-dev] Total Viewshed and GDAL
In-Reply-To: <f9141234-13b8-85bb-9ac3-6e66273c75a3@aitchison.me.uk>
References: <07e4bfb1-0639-3a89-1407-c89f6e5d8d1b@uma.es>
 <f9141234-13b8-85bb-9ac3-6e66273c75a3@aitchison.me.uk>
Message-ID: <da2460ea-dfe3-f6db-c1e2-09fb157c840d@uma.es>

Thank you so much for your hint!

I'm going to prepare a version for OpenCL as soon as I can. I had it on 
hold for a few years, but I think it wasn't too difficult. Easier than 
CUDA. Also, now I have the help of ChatGPT :)



El 18-4-23 a las 09:36, Andrew C Aitchison escribi?:
> On Tue, 18 Apr 2023, Luis Felipe Romero wrote:
>
>> Dear gdal-dev group members,
>>
>> I hope this email finds you well. I am Luis Felipe Romero, a 
>> researcher from the University of Malaga in Spain, and I am excited 
>> to introduce myself to this community. My research focuses on 
>> algorithms for digital elevation models (DEM), and in particular, the 
>> development of algorithms for the calculation of the total viewshed.
>>
>> Recently, my team has developed a highly efficient algorithm that can 
>> calculate the total viewshed for a model of 2500x2500 points in just 
>> 4 seconds on a GPU or approximately 2 minutes on a 16-core CPU. Our 
>> algorithm is written in C++, and we also have a version that utilizes 
>> CUDA for GPU acceleration.
>>
>> I had a conversation with Even Roualt about the possibility of 
>> integrating our algorithm into GDAL. However, he informed me of the 
>> incompatibilities between GDAL and CUDA, but encouraged me to share 
>> my intentions with the group. Therefore, I would like to share our 
>> Total Viewshed approach with the gdal-dev community.
>
> I understand that the performance is not as great as CUDA,
> but OpenCL support *is* available in GDAL.
>


From felipe at uma.es  Tue Apr 18 01:58:57 2023
From: felipe at uma.es (Luis F. Romero)
Date: Tue, 18 Apr 2023 10:58:57 +0200
Subject: [gdal-dev] Total Viewshed and GDAL
In-Reply-To: <CACALY+SGG-9SrMoR7DmQVzawBtx4+GzH2Q3RgFsT01BAfEyy+A@mail.gmail.com>
References: <07e4bfb1-0639-3a89-1407-c89f6e5d8d1b@uma.es>
 <CACALY+SGG-9SrMoR7DmQVzawBtx4+GzH2Q3RgFsT01BAfEyy+A@mail.gmail.com>
Message-ID: <5db2069f-4322-f202-80d3-32fc8908601a@uma.es>

Hello Tamas,

Nice to meet you, and congratulations on your tool. It has been very 
motivating for our work.

We have a private repository on Github, and I'll immediately invite you 
to give access. We do not want to make it public yet, because we are 
waiting for a publication, although we hope it will be soon.

El 18-4-23 a las 09:30, Tamas Szekeres escribi?:
> Luis,
>
> I'm interested in testing such algorithm, is that code publicly available?
>
> Best regards,
>
> Tamas
>
>
> Luis Felipe Romero <felipe at uma.es> ezt ?rta (id?pont: 2023. ?pr. 18., 
> K, 7:15):
>
>     Dear gdal-dev group members,
>
>     I hope this email finds you well. I am Luis Felipe Romero, a
>     researcher from the University of Malaga in Spain, and I am
>     excited to introduce myself to this community. My research focuses
>     on algorithms for digital elevation models (DEM), and in
>     particular, the development of algorithms for the calculation of
>     the total viewshed.
>
>     Recently, my team has developed a highly efficient algorithm that
>     can calculate the total viewshed for a model of 2500x2500 points
>     in just 4 seconds on a GPU or approximately 2 minutes on a 16-core
>     CPU. Our algorithm is written in C++, and we also have a version
>     that utilizes CUDA for GPU acceleration.
>
>     I had a conversation with Even Roualt about the possibility of
>     integrating our algorithm into GDAL. However, he informed me of
>     the incompatibilities between GDAL and CUDA, but encouraged me to
>     share my intentions with the group. Therefore, I would like to
>     share our Total Viewshed approach with the gdal-dev community.
>
>     Unlike Tamas Szekeres' Viewshed algorithm, our approach calculates
>     the viewshed at all model points simultaneously by leveraging
>     in-memory data alignment. While it may not be as efficient for
>     calculating the viewshed of a small set of points, it is
>     incredibly useful for determining the viewshed of an entire
>     territory, such as for selecting the location of a cell phone
>     tower or for forest surveillance path planning. Our algorithm can
>     complete these types of calculations in a matter of minutes, as
>     opposed to thousands of hours.
>
>     My primary goal in reaching out to this group is to gain feedback
>     and insights on how GDAL can be used to make our algorithms
>     publicly accessible and even improved upon by the community. I
>     believe that GDAL provides the necessary tools and interfaces to
>     make this possible.
>
>     I am currently in the process of familiarizing myself with the
>     GDAL code structure, and it will take a few days before I can
>     determine my first steps with it. Nevertheless, I am excited to
>     contribute to this community and give visibility to our work.
>
>     Thank you all in advance for your time and consideration.
>
>     Best regards,
>
>     _______________________________________________
>     gdal-dev mailing list
>     gdal-dev at lists.osgeo.org
>     https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230418/a7676d4f/attachment.htm>

From even.rouault at spatialys.com  Wed Apr 19 02:14:27 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 19 Apr 2023 11:14:27 +0200
Subject: [gdal-dev] Motion: Adopt GDAL 3.6.4RC1 as 3.6.4 release
Message-ID: <8e9d7bd9-d314-4df3-4f02-402e08df892d@spatialys.com>

Hi,

Motion:

Adopt GDAL 3.6.4RC1 as 3.6.4 release

Starting with my +1

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From jukka.rahkonen at maanmittauslaitos.fi  Wed Apr 19 02:38:54 2023
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Wed, 19 Apr 2023 09:38:54 +0000
Subject: [gdal-dev] Motion: Adopt GDAL 3.6.4RC1 as 3.6.4 release
In-Reply-To: <8e9d7bd9-d314-4df3-4f02-402e08df892d@spatialys.com>
References: <8e9d7bd9-d314-4df3-4f02-402e08df892d@spatialys.com>
Message-ID: <AM0PR09MB321968B6CE507F83202E6C06FD629@AM0PR09MB3219.eurprd09.prod.outlook.com>

+1

-Jukka Rahkonen-

-----Alkuper?inen viesti-----
L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Even Rouault
L?hetetty: keskiviikko 19. huhtikuuta 2023 12.14
Vastaanottaja: gdal-dev at lists.osgeo.org
Aihe: [gdal-dev] Motion: Adopt GDAL 3.6.4RC1 as 3.6.4 release

Hi,

Motion:

Adopt GDAL 3.6.4RC1 as 3.6.4 release

Starting with my +1

Even


From howard at hobu.co  Wed Apr 19 06:49:30 2023
From: howard at hobu.co (Howard Butler)
Date: Wed, 19 Apr 2023 08:49:30 -0500
Subject: [gdal-dev] Motion: Adopt GDAL 3.6.4RC1 as 3.6.4 release
In-Reply-To: <8e9d7bd9-d314-4df3-4f02-402e08df892d@spatialys.com>
References: <8e9d7bd9-d314-4df3-4f02-402e08df892d@spatialys.com>
Message-ID: <DF939103-ED66-4714-87AC-9794B3D2DCAA@hobu.co>



> On Apr 19, 2023, at 4:14 AM, Even Rouault <even.rouault at spatialys.com> wrote:
> 
> Hi,
> 
> Motion:
> 
> Adopt GDAL 3.6.4RC1 as 3.6.4 release
> 
> Starting with my +1

+1



From felipe at uma.es  Wed Apr 19 07:42:16 2023
From: felipe at uma.es (Luis Felipe Romero)
Date: Wed, 19 Apr 2023 16:42:16 +0200
Subject: [gdal-dev] Building GDAL in WIndows with CLion (CMake)
Message-ID: <5dd6e23e-8803-2208-1a04-79b2343b13c9@uma.es>

Hi all

I'll tell you about my experience installing the GDAL development environment on a fresh Windows 11 computer using CMake with CLION. I'm only sharing this so that in the future, this message may be useful to someone.

Before installing GDAL, prepare three tools (always installed the latest version for all users, as administrator):

 ??? Python for Windows, as admin, adding the PATH to the environment variable. Ver. 3.11
 ??? Git for Windows (Updating PATH)
 ??? CLion for Windows 20231.1 (PATH as well)
 ??? OSGEO4W (I installed it without knowing it was necessary. I needed QGIS, although later I found out that it was necessary for some dependencies)

After opening the GDAL folder with CLion, I found out that I needed some additional tools (Swig and Proj)

Swig for Windows.

 ??? Simply unzip the swigwin-4.1.1.zip folder and set the following variable:

 ??? SWIG_EXECUTABLE=D:\utils\swig\swig.exe

Proj for Windows and some dependencies:

 ??? After reading around, I found out that it was recommended to use OSGEO4W, and later I found out that I needed to install the sources and some dependencies.

 ??? proj
 ??? proj-devel
 ??? libtiff
 ??? libtiff-devel
 ??? libgeotiff
 ??? libgeotiff-devel
 ??? curl
 ??? curl-devel

Previously, I had already installed this with OSGEO4W, so there could be some more dependencies installed:

 ??? gdal
 ??? qgis

Finally, I defined these environment variables:

 ??? PROJ_INCLUDE_DIR=C:\OSGeo4W\include
 ??? PROJ_LIBRARY_RELEASE=C:\OSGeo4W\bin\proj_9_2.dll

And add this line in CMakeLists.txt below project(gdal LANGUAGES C CXX)

 ??? set(PROJ_ROOT "c:\OSGEO4W")

After refreshing CMake, it compiled smoothly, without any problems.

Thank you, Javier Jimenez Shaw, for your tips :)


From dg0yt at darc.de  Wed Apr 19 23:03:46 2023
From: dg0yt at darc.de (Kai Pastor, DG0YT)
Date: Thu, 20 Apr 2023 08:03:46 +0200
Subject: [gdal-dev] Building GDAL in WIndows with CLion (CMake)
In-Reply-To: <5dd6e23e-8803-2208-1a04-79b2343b13c9@uma.es>
References: <5dd6e23e-8803-2208-1a04-79b2343b13c9@uma.es>
Message-ID: <ab1853c0-de02-3f72-91c0-357fe531d540@darc.de>

These instructions seem unaware of the fact that builds are configured 
by passing input variables to cmake. In particular it is not necessary 
to edit CMakeList.txt, and some of the environment variables have no 
effect at all.

I don't know how this is done in CLion. On the command line, you would 
use `-D` parameters, i.e.

cmake ... "-DSWIG_EXECUTABLE=D:\utils\swig\swig.exe" 
"-DPROJ_ROOT=c:\OSGEO4W" ...

These variables are cached in the build directory. So you can easily 
have different configurations in different build directories for the 
same source directory, without having to remember setting environment 
variables.

Kai

Am 19.04.23 um 16:42 schrieb Luis Felipe Romero:
> Hi all
>
> I'll tell you about my experience installing the GDAL development 
> environment on a fresh Windows 11 computer using CMake with CLION. I'm 
> only sharing this so that in the future, this message may be useful to 
> someone.
>
> Before installing GDAL, prepare three tools (always installed the 
> latest version for all users, as administrator):
>
> ??? Python for Windows, as admin, adding the PATH to the environment 
> variable. Ver. 3.11
> ??? Git for Windows (Updating PATH)
> ??? CLion for Windows 20231.1 (PATH as well)
> ??? OSGEO4W (I installed it without knowing it was necessary. I needed 
> QGIS, although later I found out that it was necessary for some 
> dependencies)
>
> After opening the GDAL folder with CLion, I found out that I needed 
> some additional tools (Swig and Proj)
>
> Swig for Windows.
>
> ??? Simply unzip the swigwin-4.1.1.zip folder and set the following 
> variable:
>
> ??? SWIG_EXECUTABLE=D:\utils\swig\swig.exe
>
> Proj for Windows and some dependencies:
>
> ??? After reading around, I found out that it was recommended to use 
> OSGEO4W, and later I found out that I needed to install the sources 
> and some dependencies.
>
> ??? proj
> ??? proj-devel
> ??? libtiff
> ??? libtiff-devel
> ??? libgeotiff
> ??? libgeotiff-devel
> ??? curl
> ??? curl-devel
>
> Previously, I had already installed this with OSGEO4W, so there could 
> be some more dependencies installed:
>
> ??? gdal
> ??? qgis
>
> Finally, I defined these environment variables:
>
> ??? PROJ_INCLUDE_DIR=C:\OSGeo4W\include
> ??? PROJ_LIBRARY_RELEASE=C:\OSGeo4W\bin\proj_9_2.dll
>
> And add this line in CMakeLists.txt below project(gdal LANGUAGES C CXX)
>
> ??? set(PROJ_ROOT "c:\OSGEO4W")
>
> After refreshing CMake, it compiled smoothly, without any problems.
>
> Thank you, Javier Jimenez Shaw, for your tips :)
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230420/8b810719/attachment.htm>

From paul.malm at lfv.se  Fri Apr 21 00:52:26 2023
From: paul.malm at lfv.se (paul.malm at lfv.se)
Date: Fri, 21 Apr 2023 07:52:26 +0000
Subject: [gdal-dev] KML polygons with a label
Message-ID: <ab66350e7ae841d9a3a82f6c8395778b@lfv.se>

I'm trying to export a table from PostgreSQL to a KML file, using:
ogr2ogr -a_srs epsg:4326 -f "LIBKML" C:\Temp\kml\obst.kml PG:"dbname='aaa' host='localhost' port='5434' user='postgres' password='postgres'" "obstaclepolygon1" -progress
The table (Polygons) has a column:
OGR_STYLE=BRUSH(fc:#AABBCCFF);PEN(c:#123456,w:10px);LABEL(c:#00CC00,f:"Arial, Helvetica",s:12pt,t:{count})
and
count = integer.

The result of the STYLE in the KML file:
<Style>
          <LabelStyle>
            <color>ff00cc00</color>
          </LabelStyle>
          <LineStyle>
            <color>ff563412</color>
            <width>10</width>
          </LineStyle>
          <PolyStyle>
            <color>ffccbbaa</color>
          </PolyStyle>
        </Style>
How do I get the LabelStyle correct?


Thanks,
Paul
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230421/db0ca711/attachment.htm>

From even.rouault at spatialys.com  Fri Apr 21 05:53:09 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 21 Apr 2023 14:53:09 +0200
Subject: [gdal-dev] Motion: Adopt GDAL 3.6.4RC1 as 3.6.4 release
In-Reply-To: <8e9d7bd9-d314-4df3-4f02-402e08df892d@spatialys.com>
References: <8e9d7bd9-d314-4df3-4f02-402e08df892d@spatialys.com>
Message-ID: <6ab88f0b-1b35-7c84-c924-6e5e6798e44d@spatialys.com>

Hi,

motion passed with +1 from PSC members JukkaR, HowardB and me.

Even

Le 19/04/2023 ? 11:14, Even Rouault a ?crit?:
> Hi,
>
> Motion:
>
> Adopt GDAL 3.6.4RC1 as 3.6.4 release
>
> Starting with my +1
>
> Even
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.


From even.rouault at spatialys.com  Fri Apr 21 06:15:07 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 21 Apr 2023 15:15:07 +0200
Subject: [gdal-dev] GDAL 3.6.4 is released
Message-ID: <9a78289a-8a2f-6cde-a657-9ecc968ae417@spatialys.com>

Hi,

On behalf of the GDAL/OGR development team, I am pleased to announce the 
release of the GDAL/OGR 3.6.4 bug fix version, the last one in the 3.6 
series

Consult the release notes for the list of issues addressed:

 ??? https://github.com/OSGeo/gdal/blob/v3.6.4/NEWS.md

The sources are available at:

 ??? https://download.osgeo.org/gdal/3.6.4/gdal-3.6.4.tar.xz
 ??? https://download.osgeo.org/gdal/3.6.4/gdal-3.6.4.tar.gz
 ??? https://download.osgeo.org/gdal/3.6.4/gdal364.zip

Best regards,

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From even.rouault at spatialys.com  Fri Apr 21 16:30:58 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 22 Apr 2023 01:30:58 +0200
Subject: [gdal-dev] KML polygons with a label
In-Reply-To: <ab66350e7ae841d9a3a82f6c8395778b@lfv.se>
References: <ab66350e7ae841d9a3a82f6c8395778b@lfv.se>
Message-ID: <44f2e5f3-19e0-d9ca-2080-edda234d423a@spatialys.com>


> How do I get the LabelStyle correct?
>
What do you mean by "correct" ? Are you wishing to see the font, size 
and text attributes translated in LabelStyle ? As far as I can see in 
the KML spec, there is no direct equivalence for them.

There is a <scale> element that could perhaps emulate some sort of 
scale, but this is an amplification factor, with 1 meaning nominal size. 
So how a font size of 12 in Arial or Helvetica translates as scale...

Even

-- 

http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230422/a9a8bc45/attachment.htm>

From mdsumner at gmail.com  Sun Apr 23 20:09:10 2023
From: mdsumner at gmail.com (Michael Sumner)
Date: Mon, 24 Apr 2023 13:09:10 +1000
Subject: [gdal-dev] GDALOpenShared: warning about "filename" vs "description"
Message-ID: <CAAcGz9-eyQ1YOrr_LA4wQsEoaho_UfGrRDQGEZDUQuotLMX-Bg@mail.gmail.com>

When invoking  info on this vrt connection

gdalinfo "vrt://
https://herbariumnsw-pds.s3-ap-southeast-2.amazonaws.com/images/NSW041500.jp2?a_ullr=0,9661,7180,0"


I see this warning

Warning 6: A dataset opened by GDALOpenShared should have the same filename
(
https://herbariumnsw-pds.s3-ap-southeast-2.amazonaws.com/images/NSW041500.jp2)
and description (/vsimem/http_1/NSW041500.jp2)

The warning seems unreasonable given that we are quite far from a
"filename" for a dsn? There's no warning on the bare url or with /vsicurl:

gdalinfo
https://herbariumnsw-pds.s3-ap-southeast-2.amazonaws.com/images/NSW041500.jp2

gdalinfo  /vsicurl/
https://herbariumnsw-pds.s3-ap-southeast-2.amazonaws.com/images/NSW041500.jp2

## GDAL version and provenance

Ubuntu 20.04

GDAL 3.7.0dev-717dcc0eed, released 2023/04/22 (debug build)




-- 
Michael Sumner
Software and Database Engineer
Australian Antarctic Division
Hobart, Australia
e-mail: mdsumner at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230424/12fae463/attachment.htm>

From mcalzado at carto.com  Mon Apr 24 04:34:04 2023
From: mcalzado at carto.com (Moises Calzado)
Date: Mon, 24 Apr 2023 13:34:04 +0200
Subject: [gdal-dev] Ogr2ogr CSV driver not handling correctly line breaks
 inside columns
Message-ID: <CAObRW4Tm7-Kg76344Aoh1Mix24-yT2Szd9ivqvV0eMRP=KTEag@mail.gmail.com>

Hello!

We're trying to convert a Shapefile into a CSV using ogr2ogr and we're
having some issues while dealing with some columns that contain line breaks
inside their values. If we have a line with the following string, ogr2ogr
detects that the line break is a new line and it returns two lines.

"this is my \n value"


That's the command that we're executing:

ogr2ogr -f CSV -skipfailures -makevalid /vsistdout/ /vsizip/shapefile.zip
> -simplify 0.00001 -dim XY -t_srs EPSG:4326 -lco GEOMETRY=AS_WKT -lco
> GEOMETRY_NAME=geom -lco CREATE_CSVT=YES > result.csv
>

Is this an expected behaviour, or is there any way to avoid this?
Sharing an example Shapefile so that you can try to reproduce that
behaviour:
https://drive.google.com/file/d/1gFqfTP02KTFoavJyyO-Ix05YwZB2tS24/view?usp=sharing

Thanks so much in advance,
Regards.

-- 
*Moises Calzado*

Support Engineer

+34671264286 | mcalzado at carto.com | CARTO <https://www.carto.com/>
<https://spatial-data-science-conference.com/2023/london/>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230424/8ff09db5/attachment.htm>

From ivan.lucena at outlook.com  Mon Apr 24 18:47:55 2023
From: ivan.lucena at outlook.com (Ivan Lucena)
Date: Tue, 25 Apr 2023 01:47:55 +0000
Subject: [gdal-dev] GRIB can't get nodata and cmake can't disable FileGDB
Message-ID: <IA1P223MB042509670099B81B90F2721AF2649@IA1P223MB0425.NAMP223.PROD.OUTLOOK.COM>

Hi,

I updated a Linux machine from GDAL 2.3 to 3.4 and after that some python scripts started to crash.

I found out that when band.GetNodataValue() was called for bands > 1 the return was always None.

But I tested the same WMO file with gdalinfo or gdalinfo.py and all the bands return the correct no_data, -9999.

WMO data comes in GRIB format and the driver was custom made for that product/provider. I guess.

By looking at the gdalinfo.py code, I figured out that, if I call GetStatistics() before GetNoDataValue(), the no_data returned was also -9999 for all bands.

That means, there is a bug in the GRIB driver on 3.4 that wasn't there on 2.3

I tested on GDAL 3.4 on Windows with GDAL Anaconda installation and got the same error.

I could just advise my coworkers to add a call to getStatistics(True, False) before calling GetNoDataValue() on their code, or cancel the updated to GDAL 3.4. But there are problem with 2.3 and MSSQL that work just fine with 3.4,

So I decided to build GDAL 3.6 to see if still have that problem. And I should also formally report the issue with GRIB.

But I am getting a compilation error, somewhere on ogrsf_frmts/openfilegdb, and I cannot turn off that driver on cmake. The parameter -DGDAL_USE_FILEGDB=OFF seems to work fine. The output messages says FileGDB is disabled, but the makefile is still going there. And I don't need that driver. What else can I do to disable it?

Have anyone noticed those two problem? Any solution or suggestion?

Thanks,

Ivan



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230425/f6757967/attachment.htm>

From peter.loewe at gmx.de  Mon Apr 24 22:53:51 2023
From: peter.loewe at gmx.de (=?UTF-8?Q?Peter_L=C3=B6we?=)
Date: Tue, 25 Apr 2023 07:53:51 +0200
Subject: [gdal-dev] GDAL / Springer Handbook of Geographic Information
Message-ID: <trinity-2eb8e447-cf3c-4e83-8c09-073d7e705c9c-1682402031158@3c-app-gmx-bs71>

Dear GDAL community,

get your free copy of the Open Source GIS chapter of the Springer Handbook of Geographic Information before the paywall goes up by the end of April: https://link.springer.com/content/pdf/10.1007/978-3-030-53125-6_30.pdf

The chapter covers GDAL/OGR and related tools, such as GeoBlackLight, Geopaparazzi, GeoPython, GeoServer, GeoTools, GMT,
GPlates, GRASS GIS, gvSIG, Java Topolgy Suite, Mapserver, leaflet, NASA WorldWind, OSGeoLive, PostGIS, PORJ, QGIS and rasdaman
? including links to conference videos and the 1987 GRASS GIS video narrated by William Shatner (of Star Trek fame) for additional content !

New: Learn how to cite GDAL by its Digital Object Identifier (DOI) to give scientific credit to the GDAL developer team:
https://doi.org/10.5281/zenodo.5884351

Kind regards,
Peter

<peter.loewe at gmx.de>


From englishchristophera at gmail.com  Wed Apr 26 14:48:14 2023
From: englishchristophera at gmail.com (chris english)
Date: Wed, 26 Apr 2023 17:48:14 -0400
Subject: [gdal-dev] GDALOpenShared: warning about "filename" vs
 "description"
In-Reply-To: <CAAcGz9-eyQ1YOrr_LA4wQsEoaho_UfGrRDQGEZDUQuotLMX-Bg@mail.gmail.com>
References: <CAAcGz9-eyQ1YOrr_LA4wQsEoaho_UfGrRDQGEZDUQuotLMX-Bg@mail.gmail.com>
Message-ID: <CAASFQpRVTkBXOsg5t49xBak=wdcRp+kTTxhZyD_jZXzT02_jSg@mail.gmail.com>

To my eye this looks like a very old 'warning' from Frank W's era,
where he was taming cats (user community) and dsn were, reasonably,
file names of a sort. Would overhead of regex comparing terminating
characters after final '/' meet the file name versus descriptor still
be useful? I imagine he was reacting to some many "I downloaded X and
now can't find it" (because it might have been renamed in process)
kinds of conditions, and the warning might trigger one to check. Just
an inkling on the annoyance.

On Sun, Apr 23, 2023 at 11:09?PM Michael Sumner <mdsumner at gmail.com> wrote:
>
>
> When invoking  info on this vrt connection
>
> gdalinfo "vrt://https://herbariumnsw-pds.s3-ap-southeast-2.amazonaws.com/images/NSW041500.jp2?a_ullr=0,9661,7180,0"
>
> I see this warning
>
> Warning 6: A dataset opened by GDALOpenShared should have the same filename (https://herbariumnsw-pds.s3-ap-southeast-2.amazonaws.com/images/NSW041500.jp2) and description (/vsimem/http_1/NSW041500.jp2)
>
> The warning seems unreasonable given that we are quite far from a "filename" for a dsn? There's no warning on the bare url or with /vsicurl:
>
> gdalinfo  https://herbariumnsw-pds.s3-ap-southeast-2.amazonaws.com/images/NSW041500.jp2
>
> gdalinfo  /vsicurl/https://herbariumnsw-pds.s3-ap-southeast-2.amazonaws.com/images/NSW041500.jp2
>
> ## GDAL version and provenance
>
> Ubuntu 20.04
>
> GDAL 3.7.0dev-717dcc0eed, released 2023/04/22 (debug build)
>
>
>
>
> --
> Michael Sumner
> Software and Database Engineer
> Australian Antarctic Division
> Hobart, Australia
> e-mail: mdsumner at gmail.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From imfeld at parcs.ch  Wed Apr 26 23:36:25 2023
From: imfeld at parcs.ch (Stephan Imfeld)
Date: Thu, 27 Apr 2023 08:36:25 +0200
Subject: [gdal-dev] GDAL client certificates:
 CURLOPT_SSLCERT/curl_easy_setopt missing?
Message-ID: <0db701d978d2$9968d570$cc3a8050$@parcs.ch>

Hi

We are trying to serve some COG-Tiffs using a https server. Some of them require authentication. Accessing the data without or with basic authentication through gdal/qgis using /vsicurl/... works fine, but we have not found a way to use client certificates.

Using curl (7.81.0) directly (with
CURLOPT_SSLCERT/CURLOPT_SSLKEY/CURLOPT_KEYPASSWD/CURLOPT_SSLCERTTYPE)
works fine with client certificates enabled, even when using the options in a .curlrc file.

But it seems to be that libcurl does not honor .curlrc, and consequently we have not been able to get gdal working with the client certificate.

Maybe I overlooked something during the past few days, but I have not been able to get it working through gdal. Is there a way passing CURLOPT_SSLCERT/CURLOPT_SSLKEY/CURLOPT_KEYPASSWD/CURLOPT_SSLCERTTYPE (or using curl_easey_setup in a more general way) from gdal to libcurl? Any other ways to do it?

Regards,
Stephan


From szekerest at gmail.com  Thu Apr 27 12:51:40 2023
From: szekerest at gmail.com (Tamas Szekeres)
Date: Thu, 27 Apr 2023 21:51:40 +0200
Subject: [gdal-dev] Reading ESRI .tpkx files
Message-ID: <CACALY+TbQDnZDn3ggj3mre4kZK_GXRw3eQms06uCj0N_fNgS-w@mail.gmail.com>

Hi,

Is that possible to read ESRI .tpkx files in GDAL? As far as I see the
closest driver for this format is ESRIC which can read "Esri Compact Cache
V2" but it requires a conf.xml file, which is not included in the tpkx
format <https://github.com/Esri/tile-package-spec>.

Thanks,

Tamas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230427/5cbd1ab3/attachment.htm>

From mtobby59 at gmail.com  Thu Apr 27 23:50:51 2023
From: mtobby59 at gmail.com (Tobby Moalem)
Date: Fri, 28 Apr 2023 09:50:51 +0300
Subject: [gdal-dev] JPEG2000 with COG like structure
Message-ID: <CALGHxB0k0q25NViTP7CZbBfUG=sTHkXdJLyesBzeyZREJE68Ew@mail.gmail.com>

I am looking for a way to use my JPEG2000 over object storage (s3)
efficiently. JPEG2000 structure is progressive by resolution, meaning that
in order to get the maximum resolution of a tile, all previous resolutions
have to be decoded. This leads to performing many GET request that cause
slow performance for the user.

I know that JPEG2000 is extremely flexible, so I wonder if there is a way
to store each resolution level by itself (similar to COG structure), so
that with one GET request I will receive the entire resolution level of a
tile.

Thanks in advance,
Tobby
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230428/6271be2c/attachment.htm>

From jluis at ualg.pt  Fri Apr 28 10:08:06 2023
From: jluis at ualg.pt (=?iso-8859-1?Q?Joaquim_Manuel_Freire_Lu=EDs?=)
Date: Fri, 28 Apr 2023 17:08:06 +0000
Subject: [gdal-dev] Failure to read some geojson files
Message-ID: <GVXPR04MB9926AF938B5F515B1644E1B3A66B9@GVXPR04MB9926.eurprd04.prod.outlook.com>

Hi,

In my quest to find a small coastlines file made of closed polygons (well, they all should be closed by definition but ...) I thought in using the file used to create the PROJ examples, but to my surprise GDAL can't read those geojson files.

This is with OSGeo4W GDAL but I get the same with my own build. But I can read some other geojson files. Why?


ogrinfo https://github.com/OSGeo/PROJ/blob/9.1/docs/plot/data/coastline.geojson
ERROR 4: Failed to read TopoJSON data
ERROR 4: Failed to read TopoJSON data
FAILURE:
Unable to open datasource `https://github.com/OSGeo/PROJ/blob/9.1/docs/plot/data/coastline.geojson' with the following drivers.
...

Joaquim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230428/6c706b5e/attachment.htm>

From andreaerdna at libero.it  Fri Apr 28 12:23:00 2023
From: andreaerdna at libero.it (Andrea Giudiceandrea)
Date: Fri, 28 Apr 2023 21:23:00 +0200
Subject: [gdal-dev] Failure to read some geojson files
Message-ID: <912c7597-744b-df41-06b5-05390bbd9186@libero.it>

Il 28/04/2023 19:08, Joaquim Manuel Freire Lu?s via gdal-dev ha scritto:
> This is with OSGeo4W GDAL but I get the same with my own build. But I 
> can read some other geojson files. Why?
> 
> ogrinfo 
> https://github.com/OSGeo/PROJ/blob/9.1/docs/plot/data/coastline.geojson 
> <https://github.com/OSGeo/PROJ/blob/9.1/docs/plot/data/coastline.geojson>
> 
> ERROR 4: Failed to read TopoJSON data

Hi Joaquim,
the URL 
https://github.com/OSGeo/PROJ/blob/9.1/docs/plot/data/coastline.geojson 
does not point to the actual coastline.geojson file. It points to a 
GitHub HTML page.

You need to use the URL 
https://github.com/OSGeo/PROJ/raw/9.1/docs/plot/data/coastline.geojson 
instead.

Best regards.

Andrea Giudiceandrea

From jluis at ualg.pt  Fri Apr 28 15:09:27 2023
From: jluis at ualg.pt (=?utf-8?B?Sm9hcXVpbSBNYW51ZWwgRnJlaXJlIEx1w61z?=)
Date: Fri, 28 Apr 2023 22:09:27 +0000
Subject: [gdal-dev] Failure to read some geojson files
In-Reply-To: <912c7597-744b-df41-06b5-05390bbd9186@libero.it>
References: <912c7597-744b-df41-06b5-05390bbd9186@libero.it>
Message-ID: <GVXPR04MB99264042B6C13459060A69A4A66B9@GVXPR04MB9926.eurprd04.prod.outlook.com>

Thanks Andrea,

I thought that could be the case and downloaded the file with a right-click-save-as and what I got seemed to be a valid json file and clearly not an html file. And that one doesn't work either. It does when I select to download as "raw".

Joaquim

-----Original Message-----
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Andrea Giudiceandrea via gdal-dev
Sent: Friday, April 28, 2023 8:23 PM
To: gdal-dev at lists.osgeo.org
Cc: Andrea Giudiceandrea <andreaerdna at libero.it>
Subject: Re: [gdal-dev] Failure to read some geojson files

Il 28/04/2023 19:08, Joaquim Manuel Freire Lu?s via gdal-dev ha scritto:
> This is with OSGeo4W GDAL but I get the same with my own build. But I 
> can read some other geojson files. Why?
> 
> ogrinfo
> https://github.com/OSGeo/PROJ/blob/9.1/docs/plot/data/coastline.geojso
> n 
> <https://github.com/OSGeo/PROJ/blob/9.1/docs/plot/data/coastline.geojs
> on>
> 
> ERROR 4: Failed to read TopoJSON data

Hi Joaquim,
the URL
https://github.com/OSGeo/PROJ/blob/9.1/docs/plot/data/coastline.geojson
does not point to the actual coastline.geojson file. It points to a GitHub HTML page.

You need to use the URL
https://github.com/OSGeo/PROJ/raw/9.1/docs/plot/data/coastline.geojson
instead.

Best regards.

Andrea Giudiceandrea
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev

From public at postholer.com  Fri Apr 28 15:22:52 2023
From: public at postholer.com (Scott)
Date: Fri, 28 Apr 2023 15:22:52 -0700
Subject: [gdal-dev] Failure to read some geojson files
In-Reply-To: <GVXPR04MB99264042B6C13459060A69A4A66B9@GVXPR04MB9926.eurprd04.prod.outlook.com>
References: <912c7597-744b-df41-06b5-05390bbd9186@libero.it>
 <GVXPR04MB99264042B6C13459060A69A4A66B9@GVXPR04MB9926.eurprd04.prod.outlook.com>
Message-ID: <07b1f569-9626-7a75-f3c9-42c2089884c2@postholer.com>

Yeah, the raw works. It's easiest to grab it with vsi:

ogrinfo 
/vsicurl/https://github.com/OSGeo/PROJ/raw/9.1/docs/plot/data/coastline.geojson

On 4/28/23 15:09, Joaquim Manuel Freire Lu?s via gdal-dev wrote:
> Thanks Andrea,
> 
> I thought that could be the case and downloaded the file with a right-click-save-as and what I got seemed to be a valid json file and clearly not an html file. And that one doesn't work either. It does when I select to download as "raw".
> 
> Joaquim
> 
> -----Original Message-----
> From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Andrea Giudiceandrea via gdal-dev
> Sent: Friday, April 28, 2023 8:23 PM
> To: gdal-dev at lists.osgeo.org
> Cc: Andrea Giudiceandrea <andreaerdna at libero.it>
> Subject: Re: [gdal-dev] Failure to read some geojson files
> 
> Il 28/04/2023 19:08, Joaquim Manuel Freire Lu?s via gdal-dev ha scritto:
>> This is with OSGeo4W GDAL but I get the same with my own build. But I
>> can read some other geojson files. Why?
>>
>> ogrinfo
>> https://github.com/OSGeo/PROJ/blob/9.1/docs/plot/data/coastline.geojso
>> n
>> <https://github.com/OSGeo/PROJ/blob/9.1/docs/plot/data/coastline.geojs
>> on>
>>
>> ERROR 4: Failed to read TopoJSON data
> 
> Hi Joaquim,
> the URL
> https://github.com/OSGeo/PROJ/blob/9.1/docs/plot/data/coastline.geojson
> does not point to the actual coastline.geojson file. It points to a GitHub HTML page.
> 
> You need to use the URL
> https://github.com/OSGeo/PROJ/raw/9.1/docs/plot/data/coastline.geojson
> instead.
> 
> Best regards.
> 
> Andrea Giudiceandrea
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From ujaval at spatialthoughts.com  Fri Apr 28 21:53:54 2023
From: ujaval at spatialthoughts.com (Ujaval Gandhi)
Date: Sat, 29 Apr 2023 04:53:54 +0000
Subject: [gdal-dev] JPEG2000 with COG like structure
In-Reply-To: <CALGHxB0k0q25NViTP7CZbBfUG=sTHkXdJLyesBzeyZREJE68Ew@mail.gmail.com>
References: <CALGHxB0k0q25NViTP7CZbBfUG=sTHkXdJLyesBzeyZREJE68Ew@mail.gmail.com>
Message-ID: <950b98bc-ec8f-0602-059c-35fb94eeb300@spatialthoughts.com>

What about using JPEG compression with GeoTIFF files instead and thus enabling
you to use COGs? In my experience, you can get pretty close to the JPEG2000 file
size with a GeoTIFF with JPEG compression.

---
Ujaval Gandhi
Spatial Thoughts
www.spatialthoughts.com
[https://mailtrack.io/trace/link/f9609ee3ad14467596aab38dba52bda35825bff6?url=http%3A%2F%2Fwww.spatialthoughts.com&userId=8747767&signature=0f058cfed806f1e3]




[data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACwAAAAAAQABAAACAkQBADs=3D]
On Fri, Apr 28, 2023 at 12:21?PM Tobby Moalem <mtobby59 at gmail.com> wrote:


> I am looking for a way to use my JPEG2000 over object storage (s3)
> efficiently. JPEG2000 structure is progressive by resolution, meaning that in
> order to get the maximum resolution of a tile, all previous resolutions have
> to be decoded. This leads to performing many GET request that cause slow
> performance for the user.
> 
> I know that JPEG2000 is extremely flexible, so I wonder if there is a way to
> store each resolution level by itself (similar to COG structure), so that with
> one GET request I will receive the entire resolution level of a tile.
> 
> 
> 
> Thanks in advance,
> Tobby
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org [gdal-dev at lists.osgeo.org]
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> [https://lists.osgeo.org/mailman/listinfo/gdal-dev]
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230429/7d5a91a8/attachment.htm>

From andrew at aitchison.me.uk  Sat Apr 29 04:21:47 2023
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Sat, 29 Apr 2023 12:21:47 +0100 (BST)
Subject: [gdal-dev] GNU g++-13 and [[clang::fallthrough]]
Message-ID: <3e7c212a-0036-ad49-209a-0e56f6875319@aitchison.me.uk>


Ubuntu 23-04 (Lunar) has g++ v13.0.1 (in the universe section,
this is not the default g++ compiler).
At least as curently shipped, this warns about the line
 	[[clang::fallthrough]];
(partly becuase with the default settings
 	[[fallthrough]];
is now needed to silence warnings where a fallthrough *is* intended).

Based on https://gcc.gnu.org/bugzilla/show_bug.cgi?id=109653#c3
I have attached a patch for ports/cpl_port.h

-- 
Andrew C. Aitchison                      Kendal, UK
                    andrew at aitchison.me.uk
-------------- next part --------------
A non-text attachment was scrubbed...
Name: gcc13fallthrough.patch
Type: text/x-diff
Size: 968 bytes
Desc: 
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230429/a52b1550/attachment-0001.patch>

From even.rouault at spatialys.com  Sat Apr 29 06:21:27 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 29 Apr 2023 15:21:27 +0200
Subject: [gdal-dev] GDAL client certificates:
 CURLOPT_SSLCERT/curl_easy_setopt missing?
In-Reply-To: <0db701d978d2$9968d570$cc3a8050$@parcs.ch>
References: <0db701d978d2$9968d570$cc3a8050$@parcs.ch>
Message-ID: <1112f3e9-ca9b-d0f0-39ee-c650ca7d6c2d@spatialys.com>

Stephan,

this should be addressed per https://github.com/OSGeo/gdal/pull/7657. 
I'd appreciate if you could do some runtime testing of this pull 
request, as it was only compile tested on my side.

There's no option to honor .curlrc, and it doesn't look trivial to add 
support for that given this is something specific to the "curl" binary 
itself, not the libcurl library (cf 
https://stackoverflow.com/questions/3698605/can-libcurl-be-configured-to-use-my-curlrc-when-used-from-php). 


You may get a similar functionality by setting the GDAL configuration 
options in the GDAL configuration file: 
https://gdal.org/user/configoptions.html#gdal-configuration-file

Even

Le 27/04/2023 ? 08:36, Stephan Imfeld a ?crit?:
> Hi
>
> We are trying to serve some COG-Tiffs using a https server. Some of them require authentication. Accessing the data without or with basic authentication through gdal/qgis using /vsicurl/... works fine, but we have not found a way to use client certificates.
>
> Using curl (7.81.0) directly (with
> CURLOPT_SSLCERT/CURLOPT_SSLKEY/CURLOPT_KEYPASSWD/CURLOPT_SSLCERTTYPE)
> works fine with client certificates enabled, even when using the options in a .curlrc file.
>
> But it seems to be that libcurl does not honor .curlrc, and consequently we have not been able to get gdal working with the client certificate.
>
> Maybe I overlooked something during the past few days, but I have not been able to get it working through gdal. Is there a way passing CURLOPT_SSLCERT/CURLOPT_SSLKEY/CURLOPT_KEYPASSWD/CURLOPT_SSLCERTTYPE (or using curl_easey_setup in a more general way) from gdal to libcurl? Any other ways to do it?
>
> Regards,
> Stephan
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From even.rouault at spatialys.com  Sat Apr 29 06:34:36 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 29 Apr 2023 15:34:36 +0200
Subject: [gdal-dev] GRIB can't get nodata and cmake can't disable FileGDB
In-Reply-To: <IA1P223MB042509670099B81B90F2721AF2649@IA1P223MB0425.NAMP223.PROD.OUTLOOK.COM>
References: <IA1P223MB042509670099B81B90F2721AF2649@IA1P223MB0425.NAMP223.PROD.OUTLOOK.COM>
Message-ID: <8f7512a8-8a81-20bc-b411-0c038bce93c5@spatialys.com>

Ivan,

(I see you've filed an issue for the GRIB nodata issue since.)


>
> But I am getting a compilation error, somewhere on 
> ogrsf_frmts/openfilegdb, and I cannot turn off that driver on cmake. 
> The parameter -DGDAL_USE_FILEGDB=OFF seems to work fine.

For the OpenFileGDB driver, this should be 
-DOGR_ENABLE_DRIVER_OPENFILEGDB=OFF

-DGDAL_USE_FILEGDB=OFF is to disable the use of the proprietary SDK

I somehow recall someone had mentioned a building issue some time ago 
but can't find it. Anyway, I assume you may perhaps use an older 
compiler, like MSVC 2015 which we no longer test/support and that 
doesn't support some aspects of C++11. You may perhaps try to revert 
https://github.com/OSGeo/gdal/commit/b8076543f0fefb7106351297b845df2f8b4d8514 
alternatively, or better upgrade to something more recent

More generally when you report something, be very specific and post 
exact error messages.

Even

-- 

http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230429/2018150e/attachment.htm>

From even.rouault at spatialys.com  Sat Apr 29 06:44:02 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 29 Apr 2023 15:44:02 +0200
Subject: [gdal-dev] Ogr2ogr CSV driver not handling correctly line
 breaks inside columns
In-Reply-To: <CAObRW4Tm7-Kg76344Aoh1Mix24-yT2Szd9ivqvV0eMRP=KTEag@mail.gmail.com>
References: <CAObRW4Tm7-Kg76344Aoh1Mix24-yT2Szd9ivqvV0eMRP=KTEag@mail.gmail.com>
Message-ID: <cdd2eba6-f6c8-6d64-c1cc-f0fda993f9c5@spatialys.com>

Moises,

as far as I can see with your example, the CSV driver behaves "properly" 
in reading and writing of field values with line breaks.

It follows the "Fields with embedded line breaks must be quoted" rule of 
https://en.wikipedia.org/wiki/Comma-separated_values

$ ogr2ogr out.csv /vsizip/dataframe.zip

$ cat out.csv
id,descriptio
"1",This is my third row
"2","this is
my string
"
"3",This is my third row

$ ogrinfo out.csv -al
INFO: Open of `out.csv'
 ????? using driver `CSV' successful.

Layer name: out
Geometry: None
Feature Count: 3
Layer SRS WKT:
(unknown)
id: String (0.0)
descriptio: String (0.0)
OGRFeature(out):1
 ? id (String) = 1
 ? descriptio (String) = This is my third row

OGRFeature(out):2
 ? id (String) = 2
 ? descriptio (String) = this is
my string


OGRFeature(out):3
 ? id (String) = 3
 ? descriptio (String) = This is my third row

But in your example using /vsistdout/ and -lco CREATE_CSVT=YES is going 
to result in an invalid CSV file which will mix both the .csvt and .csv 
content

Even

Le 24/04/2023 ? 13:34, Moises Calzado via gdal-dev a ?crit?:
> Hello!
>
> We're trying to convert a Shapefile into a CSV using ogr2ogr and we're 
> having some issues while dealing with some columns that contain line 
> breaks inside their values. If we have a line with the following 
> string, ogr2ogr detects that the line break is a new line and it 
> returns two lines.
>
>     "this is my \n value"
>
>
> That's the command that we're executing:
>
>     ogr2ogr -f CSV -skipfailures -makevalid /vsistdout/
>     /vsizip/shapefile.zip -simplify 0.00001 -dim XY -t_srs EPSG:4326
>     -lco GEOMETRY=AS_WKT -lco GEOMETRY_NAME=geom -lco CREATE_CSVT=YES
>     > result.csv
>
>
> Is this an expected behaviour, or is there any way to avoid this?
> Sharing an example Shapefile so that you can try to reproduce that 
> behaviour: 
> https://drive.google.com/file/d/1gFqfTP02KTFoavJyyO-Ix05YwZB2tS24/view?usp=sharing
>
> Thanks so much in advance,
> Regards.
>
> -- 
> *Moises Calzado*
>
> Support Engineer
>
> +34671264286 | mcalzado at carto.com | CARTO <https://www.carto.com/>
>
> <https://spatial-data-science-conference.com/2023/london/>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230429/9059e2c7/attachment.htm>

From andrew at aitchison.me.uk  Sat Apr 29 08:00:20 2023
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Sat, 29 Apr 2023 16:00:20 +0100 (BST)
Subject: [gdal-dev] GNU g++-13 and [[clang::fallthrough]]
In-Reply-To: <3e7c212a-0036-ad49-209a-0e56f6875319@aitchison.me.uk>
References: <3e7c212a-0036-ad49-209a-0e56f6875319@aitchison.me.uk>
Message-ID: <bb893408-c60a-7205-09b8-9f553e86cd81@aitchison.me.uk>

On Sat, 29 Apr 2023, Andrew C Aitchison wrote:


> Ubuntu 23-04 (Lunar) has g++ v13.0.1 (in the universe section,
> this is not the default g++ compiler).
> At least as curently shipped, this warns about the line
> 	[[clang::fallthrough]];
> (partly becuase with the default settings
> 	[[fallthrough]];
> is now needed to silence warnings where a fallthrough *is* intended).
>
> Based on https://gcc.gnu.org/bugzilla/show_bug.cgi?id=109653#c3
> I have attached a patch for ports/cpl_port.h

Sorry, the previous patch did not mauch gdal's usage of CPL_FALLTHROUGH.
Please use this patch instead.

-- 
Andrew C. Aitchison                      Kendal, UK
                    andrew at aitchison.me.uk
-------------- next part --------------
A non-text attachment was scrubbed...
Name: gcc13fallthrough.patch
Type: text/x-diff
Size: 971 bytes
Desc: 
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230429/362a3f84/attachment.patch>

From even.rouault at spatialys.com  Sat Apr 29 08:07:05 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 29 Apr 2023 17:07:05 +0200
Subject: [gdal-dev] GDALOpenShared: warning about "filename" vs
 "description"
In-Reply-To: <CAAcGz9-eyQ1YOrr_LA4wQsEoaho_UfGrRDQGEZDUQuotLMX-Bg@mail.gmail.com>
References: <CAAcGz9-eyQ1YOrr_LA4wQsEoaho_UfGrRDQGEZDUQuotLMX-Bg@mail.gmail.com>
Message-ID: <5d9d4bb1-7fe4-c99a-b0cc-e74ff4960383@spatialys.com>

Hi Michael,

Fixed per https://github.com/OSGeo/gdal/pull/7659

Even

Le 24/04/2023 ? 05:09, Michael Sumner a ?crit?:
>
> When invoking ?info on this vrt connection
>
> gdalinfo 
> "vrt://https://herbariumnsw-pds.s3-ap-southeast-2.amazonaws.com/images/NSW041500.jp2?a_ullr=0,9661,7180,0" 
>
>
> I see this warning
>
> Warning 6: A dataset opened by GDALOpenShared should have the same 
> filename 
> (https://herbariumnsw-pds.s3-ap-southeast-2.amazonaws.com/images/NSW041500.jp2) 
> and description (/vsimem/http_1/NSW041500.jp2)
>
> The warning seems unreasonable given that we are quite far from a 
> "filename" for a dsn? There's no warning on the bare url or with 
> /vsicurl:
>
> gdalinfo 
> https://herbariumnsw-pds.s3-ap-southeast-2.amazonaws.com/images/NSW041500.jp2
>
> gdalinfo 
> ?/vsicurl/https://herbariumnsw-pds.s3-ap-southeast-2.amazonaws.com/images/NSW041500.jp2
>
> ## GDAL version and provenance
>
> Ubuntu 20.04
>
> GDAL 3.7.0dev-717dcc0eed, released 2023/04/22 (debug build)
>
>
>
>
> -- 
> Michael Sumner
> Software and Database Engineer
> Australian Antarctic Division
> Hobart, Australia
> e-mail: mdsumner at gmail.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230429/8209390e/attachment-0001.htm>

From even.rouault at spatialys.com  Sat Apr 29 08:46:02 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 29 Apr 2023 17:46:02 +0200
Subject: [gdal-dev] GNU g++-13 and [[clang::fallthrough]]
In-Reply-To: <bb893408-c60a-7205-09b8-9f553e86cd81@aitchison.me.uk>
References: <3e7c212a-0036-ad49-209a-0e56f6875319@aitchison.me.uk>
 <bb893408-c60a-7205-09b8-9f553e86cd81@aitchison.me.uk>
Message-ID: <825c0fc5-3716-b49a-180f-347b26dd9556@spatialys.com>

Andrew,

fixed per https://github.com/OSGeo/gdal/pull/7660 . Your patch proposal 
didn't work with older gcc versions that don't like the "::" in 
_has_cpp_attribute(clang::fallthrough). I've reworked & simplified it. 
I've verified it silences the warning with 23.04 + gcc 13

Even

Le 29/04/2023 ? 17:00, Andrew C Aitchison a ?crit?:
> On Sat, 29 Apr 2023, Andrew C Aitchison wrote:
>
>
>> Ubuntu 23-04 (Lunar) has g++ v13.0.1 (in the universe section,
>> this is not the default g++ compiler).
>> At least as curently shipped, this warns about the line
>> ????[[clang::fallthrough]];
>> (partly becuase with the default settings
>> ????[[fallthrough]];
>> is now needed to silence warnings where a fallthrough *is* intended).
>>
>> Based on https://gcc.gnu.org/bugzilla/show_bug.cgi?id=109653#c3
>> I have attached a patch for ports/cpl_port.h
>
> Sorry, the previous patch did not mauch gdal's usage of CPL_FALLTHROUGH.
> Please use this patch instead.
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230429/433134b7/attachment.htm>

From mtobby59 at gmail.com  Sat Apr 29 08:54:12 2023
From: mtobby59 at gmail.com (Tobby Moalem)
Date: Sat, 29 Apr 2023 18:54:12 +0300
Subject: [gdal-dev] JPEG2000 with COG like structure
In-Reply-To: <950b98bc-ec8f-0602-059c-35fb94eeb300@spatialthoughts.com>
References: <CALGHxB0k0q25NViTP7CZbBfUG=sTHkXdJLyesBzeyZREJE68Ew@mail.gmail.com>
 <950b98bc-ec8f-0602-059c-35fb94eeb300@spatialthoughts.com>
Message-ID: <CALGHxB069WqwoE_6QsSjsjOkN=Si9y+tUCr=KhQGe6JQ86haRg@mail.gmail.com>

Hi,

Thanks for the responses.

I was checking COG and its different compression, and I found that JPEG2000
has few advantages over COG. One major advantage is its resampling method
for the overview levels, which I found superior to all the other resampling
options available at the COG driver.


On Sat, Apr 29, 2023 at 7:53?AM Ujaval Gandhi <ujaval at spatialthoughts.com>
wrote:

> What about using JPEG compression with GeoTIFF files instead and thus
> enabling you to use COGs? In my experience, you can get pretty close to the
> JPEG2000 file size with a GeoTIFF with JPEG compression.
> ---
> Ujaval Gandhi
> Spatial Thoughts
> www.spatialthoughts.com
> <https://mailtrack.io/trace/link/f9609ee3ad14467596aab38dba52bda35825bff6?w=bXRvYmJ5NTlAZ21haWwuY29t&url=http%3A%2F%2Fwww.spatialthoughts.com&userId=8747767&signature=0f058cfed806f1e3>
>
>
>
> On Fri, Apr 28, 2023 at 12:21?PM Tobby Moalem <mtobby59 at gmail.com> wrote:
>
>> I am looking for a way to use my JPEG2000 over object storage (s3)
>> efficiently. JPEG2000 structure is progressive by resolution, meaning that
>> in order to get the maximum resolution of a tile, all previous resolutions
>> have to be decoded. This leads to performing many GET request that cause
>> slow performance for the user.
>>
>> I know that JPEG2000 is extremely flexible, so I wonder if there is a way
>> to store each resolution level by itself (similar to COG structure), so
>> that with one GET request I will receive the entire resolution level of a
>> tile.
>>
>> Thanks in advance,
>> Tobby
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230429/5ab9e347/attachment.htm>

From mdsumner at gmail.com  Sat Apr 29 16:33:25 2023
From: mdsumner at gmail.com (Michael Sumner)
Date: Sun, 30 Apr 2023 09:33:25 +1000
Subject: [gdal-dev] GDALOpenShared: warning about "filename" vs
 "description"
In-Reply-To: <5d9d4bb1-7fe4-c99a-b0cc-e74ff4960383@spatialys.com>
References: <CAAcGz9-eyQ1YOrr_LA4wQsEoaho_UfGrRDQGEZDUQuotLMX-Bg@mail.gmail.com>
 <5d9d4bb1-7fe4-c99a-b0cc-e74ff4960383@spatialys.com>
Message-ID: <CAAcGz9-jQOscoUY-S+c+exaqE5EJzMxWyWMM0NfqT64Wi6Cf1w@mail.gmail.com>

Thank you.

Cheers, Mike



On Sun, Apr 30, 2023 at 1:07?AM Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi Michael,
>
> Fixed per https://github.com/OSGeo/gdal/pull/7659
>
> Even
> Le 24/04/2023 ? 05:09, Michael Sumner a ?crit :
>
>
> When invoking  info on this vrt connection
>
> gdalinfo "vrt://
> https://herbariumnsw-pds.s3-ap-southeast-2.amazonaws.com/images/NSW041500.jp2?a_ullr=0,9661,7180,0"
>
>
> I see this warning
>
> Warning 6: A dataset opened by GDALOpenShared should have the same
> filename (
> https://herbariumnsw-pds.s3-ap-southeast-2.amazonaws.com/images/NSW041500.jp2)
> and description (/vsimem/http_1/NSW041500.jp2)
>
> The warning seems unreasonable given that we are quite far from a
> "filename" for a dsn? There's no warning on the bare url or with /vsicurl:
>
> gdalinfo
> https://herbariumnsw-pds.s3-ap-southeast-2.amazonaws.com/images/NSW041500.jp2
>
> gdalinfo  /vsicurl/
> https://herbariumnsw-pds.s3-ap-southeast-2.amazonaws.com/images/NSW041500.jp2
>
> ## GDAL version and provenance
>
> Ubuntu 20.04
>
> GDAL 3.7.0dev-717dcc0eed, released 2023/04/22 (debug build)
>
>
>
>
> --
> Michael Sumner
> Software and Database Engineer
> Australian Antarctic Division
> Hobart, Australia
> e-mail: mdsumner at gmail.com
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>

-- 
Michael Sumner
Software and Database Engineer
Australian Antarctic Division
Hobart, Australia
e-mail: mdsumner at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230430/0f46edec/attachment.htm>

From jluis at ualg.pt  Sat Apr 29 18:11:01 2023
From: jluis at ualg.pt (=?iso-8859-1?Q?Joaquim_Manuel_Freire_Lu=EDs?=)
Date: Sun, 30 Apr 2023 01:11:01 +0000
Subject: [gdal-dev] +proj=wintri +over option works weel in gdalwarp but not
 in ogr2ogr
Message-ID: <GVXPR04MB9926EFB97370930CB11EF8DBA6699@GVXPR04MB9926.eurprd04.prod.outlook.com>

Even, this is a kind of continuation of the subject that I brought up in https://github.com/OSGeo/gdal/issues/7644

The file size limitation of attachments doesn't help to make this case easily reproducible, but the story is, I can make that rectangular map using gdalwarp and ogr2ogr that use the +over option and +proj=vandg
(see https://forum.generic-mapping-tools.org/t/best-projection-for-rectangular-world-map/3715/82?u=joaquim)

But when I try the same with +proj=wintry the gdalwarp op works well but the ogr2ogr doesn't.
(see https://forum.generic-mapping-tools.org/t/best-projection-for-rectangular-world-map/3715/85?u=joaquim)

You can more less reproduce this case using this file
http://fct-gmt.ualg.pt/tmp/cl540.gpkg

ogr2ogr  -t_srs "+proj=wintri +over" cl540_wintri.gpkg cl540.gpkg

Why would that be in this case?

Joaquim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230430/8d9ebcb9/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: GMTjl_j.png
Type: image/png
Size: 45805 bytes
Desc: GMTjl_j.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230430/8d9ebcb9/attachment-0001.png>

From even.rouault at spatialys.com  Sun Apr 30 06:42:45 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 30 Apr 2023 15:42:45 +0200
Subject: [gdal-dev] +proj=wintri +over option works weel in gdalwarp but
 not in ogr2ogr
In-Reply-To: <GVXPR04MB9926EFB97370930CB11EF8DBA6699@GVXPR04MB9926.eurprd04.prod.outlook.com>
References: <GVXPR04MB9926EFB97370930CB11EF8DBA6699@GVXPR04MB9926.eurprd04.prod.outlook.com>
Message-ID: <c7739701-9194-c012-15e4-e959f8fa6bf0@spatialys.com>

Joaquim,

I've looked at that. Experimentally, it doesn't seem that the current 
maths for wintri in +over mode give reasonable results for longitudes > 
360deg in absolute value (and I'm not sure if there would be a natural 
extension possible. Far beyond my knowledge of the underlying maths).

gdalwarp does a little better by default because it couples the forward 
and inverse transformer to check the domain of validity and 
experimentally must find this limitation and will thus give up for 
source pixels whose longitude > 360 deg. For ogr2ogr / vector this is 
more complicated as reprojection of a single geometry? (here cl540.gpkg 
is a single polygon with longitudes in [-540,540] range). is a "all 
points succeed to reproject => OK" / "one single point fails to 
reproject => KO" type of situation, at least in the logic followed by 
OGRGeometry::transform() logic.

So while the following patch to PROJ is probably technically correct, it 
wouldn't help in practice

diff --git a/src/projections/aitoff.cpp b/src/projections/aitoff.cpp
index 9d060999f..cce319157 100644
--- a/src/projections/aitoff.cpp
+++ b/src/projections/aitoff.cpp
@@ -59,6 +59,11 @@ static PJ_XY aitoff_s_forward(PJ_LP lp, PJ *P) { /* 
Spheroidal, forward */
 ???? struct pj_opaque *Q = static_cast<struct pj_opaque *>(P->opaque);
 ???? double c, d;

+??? if( fabs(lp.lam) > 2 * M_PI ) {
+??????? proj_errno_set(
+??????????????????? P, PROJ_ERR_COORD_TRANSFM_OUTSIDE_PROJECTION_DOMAIN);
+??????? return xy;
+??? }
 ???? c = 0.5 * lp.lam;
 ???? d = acos(cos(lp.phi) * cos(c));
 ???? if (d != 0.0) { /* basic Aitoff */

The only solution I can offer is that you must explictly clip your 
source geometry to the validity range of wintri with -clipsrc -360 -90 
360 90.

Even


Le 30/04/2023 ? 03:11, Joaquim Manuel Freire Lu?s via gdal-dev a ?crit?:
>
> Even, this is a kind of continuation of the subject that I brought up 
> in https://github.com/OSGeo/gdal/issues/7644
>
> The file size limitation of attachments doesn?t help to make this case 
> easily reproducible, but the story is, I can make that rectangular map 
> using gdalwarp and ogr2ogr that use the +over option and +proj=vandg
>
> (see 
> https://forum.generic-mapping-tools.org/t/best-projection-for-rectangular-world-map/3715/82?u=joaquim)
>
> But when I try the same with +proj=wintry the gdalwarp op works well 
> but the ogr2ogr doesn?t.
>
> (see 
> https://forum.generic-mapping-tools.org/t/best-projection-for-rectangular-world-map/3715/85?u=joaquim)
>
> You can more less reproduce this case using this file
>
> http://fct-gmt.ualg.pt/tmp/cl540.gpkg
>
> ogr2ogr? -t_srs "+proj=wintri +over" cl540_wintri.gpkg cl540.gpkg
>
> Why would that be in this case?
>
> Joaquim
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230430/5942fff7/attachment.htm>

From jluis at ualg.pt  Sun Apr 30 09:51:45 2023
From: jluis at ualg.pt (=?utf-8?B?Sm9hcXVpbSBNYW51ZWwgRnJlaXJlIEx1w61z?=)
Date: Sun, 30 Apr 2023 16:51:45 +0000
Subject: [gdal-dev] +proj=wintri +over option works weel in gdalwarp but
 not in ogr2ogr
In-Reply-To: <c7739701-9194-c012-15e4-e959f8fa6bf0@spatialys.com>
References: <GVXPR04MB9926EFB97370930CB11EF8DBA6699@GVXPR04MB9926.eurprd04.prod.outlook.com>
 <c7739701-9194-c012-15e4-e959f8fa6bf0@spatialys.com>
Message-ID: <GVXPR04MB992664C97132D6999285402AA6699@GVXPR04MB9926.eurprd04.prod.outlook.com>

Eve, thanks for looking to this but I think I?ve not been clear enough in my goals.
I don?t want to clip into the [0 360] interval. Quite on the contrary, I want to make maps that extend that limit but keep ofc the earth periodicity. My initial attempts worked quite well with the Van Der Grinten projection (https://forum.generic-mapping-tools.org/t/best-projection-for-rectangular-world-map/3715/82?u=joaquim).

For the Winkel Triple gdalwarp actually works quite well too

try this with the grid in the issue https://github.com/OSGeo/gdal/issues/7644

gdalwarp -t_srs "+proj=wintri +over" earth15.grd lixo.tiff

It?s the vector step that fails (but the cl540 has 384 segments, not just one).

Anyway, this is not an important matter. It would just be nice if I could to with ?+proj=wintry +over? what I can with ?+proj=vandg +over?

Note, I saw the warning at https://proj.org/usage/projections.html#longitude-wrapping

?Note however that for most projections where the 180 meridian does not project to a straight line, +over will have no effect or will not lead to expected results.?

The Van Der Grinten doesn?t fulfill that condition but things still work for it, so I don?t really know how to interpret that warning.

Joaquim

From: Even Rouault <even.rouault at spatialys.com>
Sent: Sunday, April 30, 2023 2:43 PM
To: Joaquim Manuel Freire Lu?s <jluis at ualg.pt>; gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] +proj=wintri +over option works weel in gdalwarp but not in ogr2ogr


Joaquim,

I've looked at that. Experimentally, it doesn't seem that the current maths for wintri in +over mode give reasonable results for longitudes > 360deg in absolute value (and I'm not sure if there would be a natural extension possible. Far beyond my knowledge of the underlying maths).

gdalwarp does a little better by default because it couples the forward and inverse transformer to check the domain of validity and experimentally must find this limitation and will thus give up for source pixels whose longitude > 360 deg. For ogr2ogr / vector this is more complicated as reprojection of a single geometry  (here cl540.gpkg is a single polygon with longitudes in [-540,540] range). is a "all points succeed to reproject => OK" / "one single point fails to reproject => KO" type of situation, at least in the logic followed by OGRGeometry::transform() logic.

So while the following patch to PROJ is probably technically correct, it wouldn't help in practice

diff --git a/src/projections/aitoff.cpp b/src/projections/aitoff.cpp
index 9d060999f..cce319157 100644
--- a/src/projections/aitoff.cpp
+++ b/src/projections/aitoff.cpp
@@ -59,6 +59,11 @@ static PJ_XY aitoff_s_forward(PJ_LP lp, PJ *P) { /* Spheroidal, forward */
     struct pj_opaque *Q = static_cast<struct pj_opaque *>(P->opaque);
     double c, d;

+    if( fabs(lp.lam) > 2 * M_PI ) {
+        proj_errno_set(
+                    P, PROJ_ERR_COORD_TRANSFM_OUTSIDE_PROJECTION_DOMAIN);
+        return xy;
+    }
     c = 0.5 * lp.lam;
     d = acos(cos(lp.phi) * cos(c));
     if (d != 0.0) { /* basic Aitoff */

The only solution I can offer is that you must explictly clip your source geometry to the validity range of wintri with -clipsrc -360 -90 360 90.

Even


Le 30/04/2023 ? 03:11, Joaquim Manuel Freire Lu?s via gdal-dev a ?crit :
Even, this is a kind of continuation of the subject that I brought up in https://github.com/OSGeo/gdal/issues/7644

The file size limitation of attachments doesn?t help to make this case easily reproducible, but the story is, I can make that rectangular map using gdalwarp and ogr2ogr that use the +over option and +proj=vandg
(see https://forum.generic-mapping-tools.org/t/best-projection-for-rectangular-world-map/3715/82?u=joaquim)

But when I try the same with +proj=wintry the gdalwarp op works well but the ogr2ogr doesn?t.
(see https://forum.generic-mapping-tools.org/t/best-projection-for-rectangular-world-map/3715/85?u=joaquim)

You can more less reproduce this case using this file
http://fct-gmt.ualg.pt/tmp/cl540.gpkg

ogr2ogr  -t_srs "+proj=wintri +over" cl540_wintri.gpkg cl540.gpkg

Why would that be in this case?

Joaquim



_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

https://lists.osgeo.org/mailman/listinfo/gdal-dev

--

http://www.spatialys.com

My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230430/fabd8148/attachment-0001.htm>

